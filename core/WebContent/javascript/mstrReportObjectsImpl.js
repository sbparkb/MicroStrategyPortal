mstrReportObjectsImplScript=true;mstrReportObjectsImpl.prototype=new mstrObjectBrowserImpl();mstrReportObjectsImpl.prototype.selectedTab="";mstrReportObjectsImpl.prototype.isWorkingSetTab=false;mstrReportObjectsImpl.prototype.files=null;mstrReportObjectsImpl.prototype.searchBox=null;mstrReportObjectsImpl.prototype.search=null;mstrReportObjectsImpl.prototype.upFolder=null;mstrReportObjectsImpl.prototype.folderBox=null;mstrReportObjectsImpl.prototype.objCount=null;mstrReportObjectsImpl.prototype.objCountEl=null;mstrReportObjectsImpl.prototype.incFetch=null;mstrReportObjectsImpl.prototype.adjustTopContainer=true;mstrReportObjectsImpl.prototype.onload=function(e){try{mstrObjectBrowserImpl.prototype.onload.call(this,e);this.initMask();this.isTargetingFilter=false;this.selections=new mstrReportObjSelectionsImpl();this.selections.parentBone=this;this.selections.path="microstrategy.bone('"+this.id+"').selections";var tabSet=microstrategy.objectFind(this.elem,"table",microstrategy.OBJTYPE_TAB_SET);if(tabSet){tabSet.onmousedown=new Function("e","return microstrategy.bone('"+this.id+"').ontabclick(e);");this.selectedTab=tabSet.getAttribute("ct");}this.files=microstrategy.subObjectFind(this.elem,"div",microstrategy.SUBOBJTYPE_FILE_LIST);this.folderBox=this.elem.getElementsByTagName("select")[0];this.upFolder=getElementById("upFolder");this.displayFormatIcon=getElementById("changeFormat");this.search=getElementById("search");this.searchBox=document.getElementById("searchArg");var incFetch=microstrategy.objectFind(this.elem,"div",microstrategy.OBJTYPE_INC_FETCH_PANE);this.incFetch=microstrategy.objectFind(this.elem,"div",microstrategy.OBJTYPE_INC_FETCH);this.elem.oncontextmenu=new Function("e","return microstrategy.bone('"+this.id+"').cancelContextMenu(e)");this.objCountEl=microstrategy.subObjectFind(this.elem,"table",microstrategy.OBJTYPE_OBJECT_COUNT)||microstrategy.findChildWithAtt(this.elem,"table","id",this.id+"_oCount");if(this.objCountEl){this.objCount=this.objCountEl.getAttribute("OC");}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.resize=function(){try{if(!this.elem){return ;}var SURROUNDING_PADDING=8;if(this.tabManager&&this.tabManager.getAvailableHeight){if(!this.elem.parentNode||!this.elem.parentNode.style){return ;}var newHeight=Math.max(this.tabManager.getAvailableHeight()-SURROUNDING_PADDING,0)+"px";this.elem.parentNode.style.height=newHeight;this.elem.style.height=newHeight;this.elem.firstChild.style.height=newHeight;this.elem.style.width=Math.max(this.tabManager.getAvailableWidth()-SURROUNDING_PADDING,0)+"px";if(this.adjustTopContainer){this.elem.parentNode.parentNode.style.height=(getObjHeight(this.elem)+12).toString()+"px";}}if(this.moveResizeHandles){window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').moveResizeHandles()",0);}if(this.resizeContents){window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').resizeContents()",0);}if(this.mask&&this.mask.onmaskedobjectresize){this.mask.onmaskedobjectresize();}}catch(err){microstrategy.errors.log(err);}};mstrReportObjectsImpl.prototype.initMask=function(){try{var browserDiv=microstrategy.findChildWithAtt(this.elem,"DIV","sty","fileList");if(browserDiv){this.maskArea=browserDiv.parentNode;this.mask.onload(this);}}catch(err){microstrategy.errors.log(err);}};mstrReportObjectsImpl.prototype.onforcerepaint=function(){try{var parent=microstrategy.findAncestor(this.elem);if(parent&&parent.parentNode){parent=parent.parentNode;var i=document.createElement("img");parent.appendChild(i);i.parentNode.removeChild(i);}}catch(err){microstrategy.errors.log(err);}};mstrReportObjectsImpl.prototype.getTabContainer=function(){return microstrategy.subObjectFind(this.elem,"div",microstrategy.SUBOBJTYPE_TAB_CONTAINER);};mstrReportObjectsImpl.prototype.checkForFormSubmit=function(e){try{if(!e){e=window.event;}if(e.keyCode==13){if(this.onsearch){this.onsearch();}if(bIsIE4){window.event.cancelBubble=true;}return false;}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.updateSelections=function(e,obj){if(obj.tagName.toLowerCase()=="span"||obj.tagName.toLowerCase()=="a"){if(this.selections){var selections=this.selections;if(selections.isSelected(obj)){if(e.ctrlKey){selections.remove(obj);}}else{if(!e.ctrlKey){selections.clear();}selections.add(obj);}if(selections.onmousedown){return selections.onmousedown(e);}}}return false;};mstrReportObjectsImpl.prototype.onmousedown=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);if(obj){if(obj.tagName.toLowerCase()=="li"){obj=obj.firstChild;}if(obj.tagName.toLowerCase()=="span"){if(obj.getAttribute("innerSpan")=="-1"){obj=microstrategy.findAncestorWithTag(obj.parentNode,"SPAN");}if(!obj){return false;}else{return this.updateSelections(e,obj);}}else{if(obj.tagName.toLowerCase()=="a"){if(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_FOLDER){this.openFolder(obj.getAttribute(microstrategy.HTMLATTR_DSS_ID));}else{obj=obj.parentNode;if(obj.tagName.toLowerCase()=="span"&&this.isTypeElementOrAttribute(obj)){return this.updateSelections(e,obj);}}}else{if(obj.tagName.toLowerCase()=="div"&&this.isTypeElementOrAttribute(obj)){var spanObj=microstrategy.findChildWithAtt(obj,"span",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_ATTRIBUTE);if(spanObj==null){spanObj=microstrategy.findChildWithAtt(obj,"span",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_ELEMENT);}if(spanObj!=null){return this.updateSelections(e,spanObj);}}else{if(this.selections){this.selections.clear();}}}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.isTypeElementOrAttribute=function(obj){return obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=null&&(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_ATTRIBUTE||obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_ELEMENT);};mstrReportObjectsImpl.prototype.initTree=function(){try{mstrObjectBrowserImpl.prototype.initTree.call(this);if(this.tree!=null){this.tree.elem.ondblclick=new Function("e","return microstrategy.bone('"+this.id+"').ondblclick(e);");var treeNodes=this.tree.elem.getElementsByTagName("span");if(treeNodes!=null){for(i=0;i<treeNodes.length;i++){var treeNode=treeNodes[i];treeNode.onmouseover=new Function("e","if (this.className.indexOf('mstrTreeStrong') >= 0) this.className = this.className.replace('mstrTreeStrong', 'mstrTreeHover');");treeNode.onmouseout=new Function("e","if (this.className.indexOf('mstrTreeHover') >= 0) this.className = this.className.replace('mstrTreeHover', 'mstrTreeStrong');");if(treeNode.getAttribute("oty")==microstrategy.DSSTYPE_ATTRIBUTE_FORM&&!treeNode.getAttribute(microstrategy.HTMLATTR_FORM_LIST)&&this.formLists){var atid=treeNode.getAttribute("atid")||"",frmList=this.formLists[atid];if(frmList){treeNode.setAttribute(microstrategy.HTMLATTR_FORM_LIST,frmList);}}}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.ondblclick=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);if(!obj){return true;}var type=obj.parentNode.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if((obj.tagName.toLowerCase()=="a")&&type!="pr"){var anc=microstrategy.findAncestorWithTag(obj,"LI");if(anc&&anc.className=="leaf"){obj=obj.parentNode;}}if(obj.tagName.toLowerCase()!="span"||!obj.getAttribute(microstrategy.HTMLATTR_DSS_ID)){return true;}var singleSelection=this.selections.getItems().length;var aclCheck=microstrategy.checkACL(obj,[microstrategy.ACL_USE]);if(!singleSelection||aclCheck){if((obj.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_FILTER&&obj.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE)!=microstrategy.DSSTYPE_CUSTOM_GROUP)||obj.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_PROMPT||obj.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_RPT_DEFINITION){this.selections.processContextMenu("af");}else{var bone=microstrategy.bone("UniqueReportID");if(bone){if(!bone.isFeatureAvailable(microstrategy.FEATURE_WEB_PIVOT)){return false;}if(!bone.commands.queryState("isOnGrid",obj)){this.selections.processContextMenu("ag");}}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.ontabclick=function(e){try{var src=microstrategy.findAncestor(getEventTarget(e));if(src&&src.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_TAB){var name=src.getAttribute("tab");if(this.selectedTab!=name){var um=this.updateManager;um.add([um.createActionObject(src,mstrUpdateManager.SET_CURRENT_TAB,this.beanPath,["49001"],[src.getAttribute("curTab")],[this.selectedTab],null)]);um.flushAndSubmitChanges();}}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.resizeContents=function(){try{var TREE_MARGIN_X=3;var TREE_MARGIN_TOP=10;var TREE_MARGIN_BOTTOM=bIsIE6&&!bIsIE7?10:20;var TREE_BORDER_WIDTH=1;var FILES_MARGIN_BOTTOM=10;var PANEL_BORDER_WIDTH_TOP=1;var PANEL_BORDER_WIDTH_BOTTOM=1;if(!isInDocument(this.elem)){return false;}if(bIsIE6&&!bIsIE7){var hPanel=parseInt(this.elem.style.height)-(PANEL_BORDER_WIDTH_TOP+PANEL_BORDER_WIDTH_BOTTOM);}else{var hPanel=getObjInnerHeight(this.elem)-(PANEL_BORDER_WIDTH_TOP+PANEL_BORDER_WIDTH_BOTTOM);}if(hPanel>0){this.elem.childNodes[0].style.height=hPanel+"px";}var hTree=hPanel-(TREE_MARGIN_TOP+TREE_MARGIN_BOTTOM+TREE_BORDER_WIDTH*2);var wTree=getObjOuterWidth(this.elem)-(TREE_MARGIN_X+TREE_BORDER_WIDTH)*2;if(this.tree&&this.tree.elem&&this.tree.elem.style&&(isInDocument(this.tree.elem))){if(hTree>0&&(this.tree.elem.style.height!=hTree+"px")){this.tree.elem.style.height=hTree+"px";microstrategy.updateBrowserSetting("obCH",hTree);}if(wTree>0){this.tree.elem.style.width=wTree+"px";}}if(this.files&&this.files.style&&(isInDocument(this.files))){var hFiles=(hTree-FILES_MARGIN_BOTTOM);var elSearchDiv=this.files.parentNode.previousSibling;if(elSearchDiv.className=="mstrSearchDiv"){hFiles-=elSearchDiv.currentStyle?parseInt(elSearchDiv.currentStyle.height):getObjOuterHeight(elSearchDiv);}if(this.incFetch){hFiles-=getObjOuterHeight(this.incFetch);}if(this.objCountEl){hFiles-=getObjOuterHeight(this.objCountEl);}if((hTree>FILES_MARGIN_BOTTOM)&&(this.files.childNodes[0].style.height!=hFiles+"px")){this.files.childNodes[0].style.height=Math.max(hFiles,0)+"px";microstrategy.updateBrowserSetting("obCH",Math.max(hFiles,0));}if(this.incFetch){this.incFetch.style.position="absolute";var incFetchWidth=this.incFetch.offsetWidth;this.incFetch.style.position="static";if(incFetchWidth>parseInt(this.elem.style.width)){this.elem.style.width=incFetchWidth+"px";var b=microstrategy.bones.accordion_AccordionTabManagerStyle;b&&(b.elem.style.width=incFetchWidth+"px");}}if(wTree>0){this.files.childNodes[0].style.width=wTree+"px";}}var newWidth=0;if(this.searchBox&&this.search){var findLabel=document.getElementById("name_label");newWidth=getObjWidth(this.elem)-(getObjWidth(this.search)+getObjWidth(findLabel)+15);if(newWidth>0){this.searchBox.style.width=newWidth+"px";}}if(this.folderBox){newWidth=getObjWidth(this.elem)-(getObjWidth(this.upFolder)+getObjWidth(this.displayFormatIcon)+15);if(newWidth>0){this.folderBox.style.width=newWidth+"px";if(mstr.utils.ISIE4){this.folderBox.style.display="none";this.folderBox.style.display="inline-block";}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.onsearch=function(e){try{if(this.searchBox){if(!this.searchBox.value){this.searchBox.value="";}var um=this.updateManager;um.add([um.createActionObject(null,mstrUpdateManager.OB_SEARCH,microstrategy.obBeanPaths[mstrUpdateManager.OB_SEARCH],["51003"],[this.searchBox.value],[],null)]);um.flushAndSubmitChanges();}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.onincfetch=function(e){try{if(!e){e=window.event;}var src=getEventTarget(e);var page=src.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(page){var um=this.updateManager;um.add([um.createActionObject(null,mstrUpdateManager.OB_FETCH,microstrategy.obBeanPaths[mstrUpdateManager.OB_FETCH],["51002"],[page],[],null)]);um.flushAndSubmitChanges();}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.ongridstructurechange=function(gridInfo){try{if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){return ;}if(this.isWorkingSetTab){var attFormsMenuItems=microstrategy.getContextMenuManager("ReportObjB").findMenuItem(microstrategy.descriptors.getDescriptor("2890"));for(var i=0;i<attFormsMenuItems.length;i++){attFormsMenuItems[i][3]="0";}for(var i=0;i<this.tree.elem.firstChild.childNodes.length;i++){var item=this.tree.elem.firstChild.childNodes[i].firstChild.getElementsByTagName("span")[0];var formsCollection=this.getAttributeForms(item);var unit=gridInfo.findUnit(item.getAttribute(microstrategy.HTMLATTR_DSS_ID));var frmList=new mstrAttFormListObj(item.getAttribute(microstrategy.HTMLATTR_FORM_LIST));if(unit==null){item.className="";if(formsCollection.length>0){for(var j=0;j<formsCollection.length;j++){formsCollection[j].className="";frmList.removeForm(formsCollection[j].getAttribute(microstrategy.HTMLATTR_DSS_ID));}}}else{item.className="mstrTreeStrong";if(formsCollection.length>0){for(var j=0;j<formsCollection.length;j++){var form=formsCollection[j];var oLi=findTargetTag(form,"li");if((unit.attForms!=null&&unit.attForms.size()>0&&unit.attForms.findUnit(form.getAttribute(microstrategy.HTMLATTR_DSS_ID))!=null)||(form.getAttribute(microstrategy.HTMLATTR_DSS_ID)==unit.attFormId)){form.className="mstrTreeStrong";if(oLi){oLi.style.display="block";}frmList.addForm(form.getAttribute(microstrategy.HTMLATTR_DSS_ID));}else{if(oLi&&oLi.style.display=="block"){form.className="";frmList.removeForm(form.getAttribute(microstrategy.HTMLATTR_DSS_ID));}}}}}item.setAttribute(microstrategy.HTMLATTR_FORM_LIST,frmList.toString());}}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.onunitsremoved=function(objInfoList){try{var __result=true;if(objInfoList&&objInfoList.length){for(var i=0,cnt=objInfoList.length;i<cnt;++i){var objInfo=objInfoList[i];__result|=this.removeUnit(objInfo);}}return __result;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.removeUnit=function(objInfo){try{var elems=this.getWSItems(objInfo.isMetricTemplateUnit,objInfo.dssId);if(elems){this.hideWSItems(elems);}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.getWSItems=function(allMetrics,dssID,formID){try{if(!this.isWorkingSetTab){return null;}var __result=new Array();for(var i=0;i<this.tree.elem.firstChild.childNodes.length;i++){var item=this.tree.elem.firstChild.childNodes[i].firstChild.getElementsByTagName("span")[0];var isMetric=(item.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_METRIC||item.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_METRIC);if(isMetric&&allMetrics){__result.push(item);}else{if(item.getAttribute(microstrategy.HTMLATTR_DSS_ID)==dssID){if(formID){item=findTargetTag(item,"li");var formElems=item.getElementsByTagName("ul")[0].getElementsByTagName("span");for(var j=0;j<formElems.length;j++){if(formElems[j].getAttribute(microstrategy.HTMLATTR_DSS_ID)==formID){__result.push(formElems[j]);}}}else{__result.push(item);}}}}return __result;}catch(err){microstrategy.errors.log(err);return null;}};mstrReportObjectsImpl.prototype.hideWSItems=function(items){try{if(!items||items.length==0){return ;}for(var i in items){items[i].className="";var oLi=findTargetTag(items[i],"li");if(oLi){oLi.style.display="none";}}}catch(err){microstrategy.errors.log(err);}};mstrReportObjectsImpl.prototype.isWSItemRemovable=function(item,err){try{if(item.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_ATTRIBUTE_FORM){return true;}if(item.getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME)=="ID"){err.desc=microstrategy.descriptors.getDescriptor("6163");return false;}else{var attrElem=this.getWSItems(false,item.getAttribute(microstrategy.HTMLATTR_PARENT_ID))[0];var frmList=new mstrAttFormListObj(attrElem.getAttribute(microstrategy.HTMLATTR_FORM_LIST));var formsOnView=frmList.getFormsOnView();if(formsOnView.length==1&&formsOnView[0][microstrategy.FORM_LIST_ID]==item.getAttribute(microstrategy.HTMLATTR_DSS_ID)){err.desc=microstrategy.descriptors.getDescriptor("3626");return false;}var defaultForms=frmList.getDefaultForms();if(defaultForms.length==1&&defaultForms[0][microstrategy.FORM_LIST_ID]==item.getAttribute(microstrategy.HTMLATTR_DSS_ID)){err.desc=microstrategy.descriptors.getDescriptor("3626");return false;}}return true;}catch(err){microstrategy.errors.log(err);}};mstrReportObjectsImpl.prototype.removeFormFromWS=function(attrID,formID,updateTemplate){try{var attrElem=this.getWSItems(false,attrID)[0];var frmList=new mstrAttFormListObj(attrElem.getAttribute(microstrategy.HTMLATTR_FORM_LIST));frmList.removeFormFromWS(formID);attrElem.setAttribute(microstrategy.HTMLATTR_FORM_LIST,frmList.toString());if(updateTemplate){var bone=microstrategy.bone("UniqueReportID");var unitInfo=bone.gridStructureInfo.findUnit(attrID);if(unitInfo){unitInfo.src.setAttribute(microstrategy.HTMLATTR_FORM_LIST,frmList.toString());if(bone.template&&bone.template.buildAxisContextMenus){bone.template.buildAxisContextMenus([unitInfo.src]);}unitInfo.attFormList=frmList;for(var i=0,cnt=unitInfo.attForms.units.length;i<cnt;i++){unitInfo.attForms.units[i].attFormList=frmList;}}}}catch(err){microstrategy.errors.log(err);}};mstrReportObjectsImpl.prototype.openFolder=function(dssId){try{var um=this.updateManager;um.add([um.createActionObject(null,mstrUpdateManager.OB_NAVIGATE,microstrategy.obBeanPaths[mstrUpdateManager.OB_NAVIGATE],["51001"],[dssId],[],null)]);um.flushAndSubmitChanges();}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjectsImpl.prototype.isReportMdxCube=function(){var bone=microstrategy.bone("UniqueReportID");return bone&&bone.isReportMdxCube();};function mstrReportObjectsImpl(id){this.inherits=mstrObjectBrowserImpl;this.inherits(id);delete this.inherits;return this;}mstrReportObjSelectionsImplScript=true;mstrReportObjSelectionsImpl.prototype=new mstrObjSelectionsImpl();mstrReportObjSelectionsImpl.prototype.onmousedown=function(e){try{var mstrSrc=microstrategy.eventManager.getSource(e);if(mstrSrc&&((mstrSrc.button>1)||(isMac&&e.ctrlKey&&mstrSrc.button==1))){if(this.isMulti()&&!this.isSameType()){return false;}for(var id in this.items){var objInfo=new mstrObjectInfoImpl(this.items[id]);if(!this.items[id].getAttribute("cx")){microstrategy.getContextMenuManager("ReportObjB").getMenu("report_ob_menu").registerTrigger(this.items[id],"['"+objInfo.dssType+"']");}}return false;}if(microstrategy.checkACL(this.clickedSrc,[microstrategy.ACL_USE])){mstrSelectionsImpl.prototype.onmousedown.call(this,e);var verifiedPath=microstrategy.getEventHandlerString(this.path);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","ondragstart");this.parentBone.attachWinListener(this,"mouseup","onmouseup",false);}else{document.onmousemove=new Function("e",verifiedPath+" { return "+this.path+".ondragstart(e); }");if(document.onmouseup==null){document.onmouseup=new Function("e",verifiedPath+" { return "+this.path+".onmouseup(e); }");}}}return false;}catch(err){microstrategy.errors.log(err);}return false;};mstrReportObjSelectionsImpl.prototype.ondrag=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);if(lMouseX>Math.max(document.documentElement.scrollWidth,document.body.scrollWidth)-25){return ;}if(!this.dragDisplay){var span=document.createElement("span");span.className="mstrDnDReportDragItem";span.appendChild(document.createTextNode(""));this.dragDisplay=document.body.appendChild(span);}var desc=(this.length>1)?microstrategy.descriptors.getDescriptor("3625"):this.firstItem().getAttribute("ds");this.dragDisplay.replaceChild(document.createTextNode(desc),this.dragDisplay.firstChild);moveObjTo(this.dragDisplay,lMouseX-getObjWidth(this.dragDisplay)-microstrategy.CURSOR_OFFSET,lMouseY-getObjHeight(this.dragDisplay)-microstrategy.CURSOR_OFFSET);this.parentBone.dndHelper.moveHelperImage(e);microstrategy.scrollPageHorizontally(lMouseX);}catch(err){microstrategy.errors.log(err);}return false;};mstrReportObjSelectionsImpl.prototype.ondragend=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}this.parentBone.dndHelper.parkObject(this.dragDisplay);microstrategy.eventManager.notifyOrphanBones("onnotifydragend");this.onmouseup(e);var src=microstrategy.findAncestor(getEventTarget(e));if(src){var bone=microstrategy.boneForMask(src);if(bone&&bone.ondrop){bone.ondrop(src,this);}}}catch(err){microstrategy.errors.log(err);}return false;};mstrReportObjSelectionsImpl.prototype.getReportFilterBone=function(bTestLimit,bTestPrompt){try{var bone=microstrategy.bone("rfe_pane");if(!bone&&bTestLimit){bone=microstrategy.bone("rle_pane");}if(!bone&&bTestPrompt){bone=microstrategy.bone("fexb_pane");}return bone;}catch(err){microstrategy.errors.log(err);return null;}};mstrReportObjSelectionsImpl.prototype.checkShowContextMenuOption=function(cmdId){try{var selection=this.firstItem();if(!selection){return false;}var type=selection.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);var subType=selection.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);var bone=microstrategy.bone("UniqueReportID");var isGridCustomSQL=bone!=null&&bone.isReportCustomSQL();switch(cmdId){case"ag":if(type==microstrategy.DSSTYPE_TEMPLATE||type==microstrategy.DSSTYPE_RPT_DEFINITION||selection.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_ELEMENT||(type==microstrategy.DSSTYPE_FILTER&&selection.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE)!=microstrategy.DSSTYPE_CUSTOM_GROUP)||type==microstrategy.DSSTYPE_PROMPT&&subType!=microstrategy.DSSSUB_TYPE_PROMPT_OBJECTS){return false;}if(bone){if(bone.commands&&bone.commands.queryState("isOnGrid",selection)){return false;}if(bone.isReportMdxCube()&&!bone.canAddMDXUnit(selection)){return false;}}return microstrategy.checkACL(selection,[microstrategy.ACL_USE]);break;case"af":if(isGridCustomSQL){return false;}if(this.getReportFilterBone(true,true)==null){return false;}return this.getReportFilterBone(true,true).isAddable(selection,this.parentBone);break;case"rn":return type!=microstrategy.DSSTYPE_HIERARCHY&&bone.commands.queryState("isOnGrid",selection);case"edm":return type==microstrategy.DSSTYPE_METRIC&&selection.getAttribute(microstrategy.HTMLATTR_DERIVED_METRIC);case"inm":return type==microstrategy.DSSTYPE_METRIC;case"aup":if(isGridCustomSQL){return false;}if(this.getReportFilterBone(false,true)==null){return false;}if((type==microstrategy.DSSTYPE_METRIC&&!selection.getAttribute(microstrategy.HTMLATTR_DERIVED_METRIC))||type==microstrategy.DSSTYPE_RPT_DEFINITION||(type==microstrategy.DSSTYPE_FILTER&&selection.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE)!=microstrategy.DSSTYPE_CUSTOM_GROUP)||type==microstrategy.DSSTYPE_DIMENSION){return microstrategy.checkACL(selection,[microstrategy.ACL_EXECUTE,microstrategy.ACL_USE]);}else{return false;}break;case"aelp":case"aaqp":if(isGridCustomSQL){return false;}if(this.getReportFilterBone(false,true)==null){return false;}if(type==microstrategy.DSSTYPE_ATTRIBUTE){return microstrategy.checkACL(selection,[microstrategy.ACL_EXECUTE,microstrategy.ACL_USE]);}else{return false;}break;case"lt":case"et":return((microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)&&(microstrategy.checkACL(selection,[microstrategy.ACL_EXECUTE,microstrategy.ACL_USE]))&&(selection.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_TEMPLATE));case"rr":return(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?true:(this.length<this.parentBone.objCount);break;case"rm":if(selection.getAttribute("dr")){return(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?true:(this.length<this.parentBone.objCount);}else{return false;}break;case"deopen":if(isGridCustomSQL||(type!=microstrategy.DSSTYPE_ATTRIBUTE)||(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)){return false;}return(bone&&selection.getAttribute("iot")&&bone.isFeatureAvailable(microstrategy.FEATURE_INSERT_NEW_METRIC)&&!selection.getAttribute("ul")&&(bone.isReportViewReport()||!selection.getAttribute("vf")));case"addsm":return type==microstrategy.DSSTYPE_ATTRIBUTE;}return true;}catch(err){microstrategy.errors.log(err);return null;}};mstrReportObjSelectionsImpl.prototype.checkEnableContextMenuOption=function(cmdId){try{switch(cmdId){case"af":if(!this.isMulti()){return true;}else{if(this.items){for(member in this.items){var item=this.items[member];if(item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_ELEMENT){return false;}}return true;}}break;}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportObjSelectionsImpl.prototype.buildAttFormSubMenu=function(e){try{if(!this.isSameType()){return false;}if(this.firstItem()==null){return false;}if(!(this.firstItem().getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_ATTRIBUTE||this.firstItem().getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_ATTRIBUTE_FORM)){return false;}if(this.isMulti()){return true;}var cmm=microstrategy.getContextMenuManager("ReportObjB");var gridBone=microstrategy.bone("UniqueReportID");var attFormsMenuItems=cmm.findMenuItem(microstrategy.descriptors.getDescriptor("2890"),eval(this.firstItem().getAttribute("cx")));var populateSubmenu=false;for(var i=0;i<attFormsMenuItems.length;i++){populateSubmenu|=(attFormsMenuItems[i][3]=="0");}if(!populateSubmenu){return true;}var formsMenu=cmm.getMenu();var root="var bone = microstrategy.bone('"+this.parentBone.id+"'); bone.selections.processContextMenu";var treeNodes=this.parentBone.tree.elem.firstChild.childNodes;if(treeNodes==null){return false;}for(i=0;i<treeNodes.length;i++){var item=treeNodes[i].firstChild.getElementsByTagName("span")[0];var attID=item.getAttribute(microstrategy.HTMLATTR_DSS_ID);var isOnGrid;var attForms;var unit=(gridBone&&gridBone.gridStructureInfo)?gridBone.gridStructureInfo.findUnit(attID):null;if(unit==null){isOnGrid=false;attForms=item.getAttribute(microstrategy.HTMLATTR_FORM_LIST);}else{isOnGrid=true;attForms=unit.attFormList.toString();}var toShow="(microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_ID) =='"+attID+"') || (microstrategy.activeCXMenu.getAttribute(\"pid\") =='"+attID+"');";if(attForms!=null&&attForms.length>0){var formsList=attForms.split(unescape(UNIT_SEPARATOR));var formsOnViewList=new Array();var formsOnWsList=new Array();var formsNotOnWsList=new Array();for(var j=0;j<formsList.length;j++){form=formsList[j].split(unescape(mstrUpdateManager.ITEM_SEPARATOR));switch(parseInt(form[microstrategy.FORM_LIST_STATUS])){case microstrategy.FORM_NOT_ON_WS:formsNotOnWsList.push(formsList[j]);break;case microstrategy.FORM_ON_VIEW:formsOnViewList.push(formsList[j]);break;case microstrategy.FORM_ON_WS:formsOnWsList.push(formsList[j]);break;}}for(var j=0;j<formsOnViewList.length;j++){form=formsOnViewList[j].split(unescape(mstrUpdateManager.ITEM_SEPARATOR));if(isOnGrid){if(formsOnViewList.length==1){formsMenu.addItem(form[microstrategy.FORM_LIST_NAME],"","",toShow,mstrContextMenuImpl.IMG_CHECK);}else{formsMenu.addItem(form[microstrategy.FORM_LIST_NAME],root+"('atfr', '"+form[microstrategy.FORM_LIST_ID]+"');","",toShow,mstrContextMenuImpl.IMG_CHECK);}}}for(var j=0;j<formsOnWsList.length;j++){form=formsOnWsList[j].split(unescape(mstrUpdateManager.ITEM_SEPARATOR));formsMenu.addItem(form[microstrategy.FORM_LIST_NAME],root+"('atfa', '"+form[microstrategy.FORM_LIST_ID]+"');","",toShow);}var modifyROList=gridBone&&gridBone.isFeatureAvailable(microstrategy.FEATURE_MODIFY_REPORT_LIST);if((formsNotOnWsList!=null)&&(formsNotOnWsList.length>0)&&modifyROList){formsMenu.addSeparator();for(var j=0;j<formsNotOnWsList.length;j++){form=formsNotOnWsList[j].split(unescape(mstrUpdateManager.ITEM_SEPARATOR));formsMenu.addItem(form[microstrategy.FORM_LIST_NAME],root+"('atfa', '"+form[microstrategy.FORM_LIST_ID]+"');","",toShow);}}}}formsMenu.addSeparator();formsMenu.addItem(microstrategy.descriptors.getDescriptor("1005"),root+"('atfm');");for(var i=0;i<attFormsMenuItems.length;i++){attFormsMenuItems[i][3]="1";attFormsMenuItems[i][4]="["+formsMenu.menu_items.toString()+"]";}return true;}catch(err){microstrategy.errors.log(err);}return false;};mstrReportObjSelectionsImpl.prototype.processContextMenu=function(cmdId,cmdVal){try{var ac=new Array();var um=microstrategy.updateManager;switch(cmdId){case"ag":var bone=microstrategy.bone("UniqueReportID");if(bone){var si=this.getItems();var flushChangesInDesignMode=false;for(var i=si.length-1;i>=0;i--){if(si[i].getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_ELEMENT&&microstrategy.checkACL(si[i],[microstrategy.ACL_USE])){var axis=microstrategy.GRIDCELL_AXIS_ROWS;if(si[i].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_METRIC||si[i].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_METRIC){if(bone.gridStructureInfo.hasMetrics){axis=microstrategy.GRIDCELL_AXIS_METRICS;}else{axis=microstrategy.GRIDCELL_AXIS_COLUMNS;}}if(si[i].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_XDA_DATA_ELEMENT&&si[i].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_HIERARCHY){flushChangesInDesignMode=true;}ac=bone.commands.exec("addTemplateUnit",si[i],axis,-1,ac);}}}um.add(ac);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE||flushChangesInDesignMode){um.flushAndSubmitChanges();}break;case"af":var bone=microstrategy.bone("rfe_pane");if(!bone){bone=microstrategy.bone("rle_pane");}if(!bone){bone=microstrategy.bone("fexb_pane");}if(bone){var item=this.firstItem();if(item==null){return ;}if(item&&item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_ELEMENT){var att=item.getAttribute(microstrategy.HTMLATTR_PARENT_ID);if(att){ac=bone.addElements(att,this.getItems(),ac);}}else{if(bone.isAddable(item,this.parentBone)){ac=bone.addUnit(item,ac);}}if(ac.length){um.add(ac);um.flushAndSubmitChanges();}}break;case"rn":var counter=1,absIdx="false";if(cmdId=="rn"){var target=microstrategy.activeCXMenu,type=target.getAttribute(microstrategy.HTMLATTR_DSS_TYPE),idAtt=type==microstrategy.DSSTYPE_ATTRIBUTE_FORM?microstrategy.HTMLATTR_ATTRIBUTE_ID:microstrategy.HTMLATTR_DSS_ID,dssid=target.getAttribute(idAtt),axisStructure=microstrategy.bone("UniqueReportID").gridStructureInfo,objects=axisStructure.rowAxis.units.concat(axisStructure.colAxis.units,axisStructure.metricAxis.units,axisStructure.pageAxis.units);absIdx="true";for(var i=0;i<objects.length;i++){if(!objects[i].dssId||(objects[i].dssType==microstrategy.DSSTYPE_HIERARCHY)){continue;}if(objects[i].dssId==dssid){break;}counter++;}}else{counter=0;}ac.push(um.createActionObject(null,mstrUpdateManager.OPEN_FORMULA_EDITOR,microstrategy.obBeanPaths[mstrUpdateManager.OPEN_FORMULA_EDITOR],["6036","6037"],[counter,absIdx],[],null));um.add(ac);um.flushAndSubmitChanges();break;case"edm":case"inm":var mid=mstrApp.getMsgID(),gridBone=microstrategy.bone("UniqueReportID"),dss=[gridBone.wksInfos],target=microstrategy.activeCXMenu,curId=target.getAttribute(microstrategy.HTMLATTR_DSS_ID),curName=target.getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME),config={datasets:dss,msgID:mid},actions=[];var submitAction=function(actions){um.add(actions);um.flushAndSubmitChanges();};if(cmdId==="inm"){config.metricId="";config.action={cmd:"editNew",refOi:{did:curId,n:curName}};config.onApplyMetricCallback=function(cfg){var argNames=["4031","4032","4259","4029"],argVals=[cfg.alias,cfg.tokenStreamXML,!mstrmojo.string.isEmpty(cfg.tokenStreamXML),1];if(cfg.afb!==undefined){argNames.push("4260");argVals.push(cfg.afb);}if(cfg.sfb!==undefined){argNames.push("4258");argVals.push(cfg.sfb);}actions.push(um.createActionObject(null,mstrUpdateManager.ADD_DERIVED_METRIC,gridBone.beanPath,argNames,argVals));submitAction.call(this,actions);};}else{config.metricId=curId;config.action={cmd:"edit",n:curName};config.onApplyMetricCallback=function(cfg){var argNames=["4248","4031","4032","4259"],argVals=[curId,cfg.alias,cfg.tokenStreamXML,!mstrmojo.string.isEmpty(cfg.tokenStreamXML)];if(cfg.afb!==undefined){argNames.push("4260");argVals.push(cfg.afb);}if(cfg.sfb!==undefined){argNames.push("4258");argVals.push(cfg.sfb);}actions.push(um.createActionObject(null,mstrUpdateManager.CHANGE_METRIC_FORMULA,gridBone.beanPath,argNames,argVals));submitAction.call(this,actions);};}microstrategy.openDerivedMetricEditor(config);break;case"aup":this.addObjectAsPrompt("");break;case"aelp":this.addObjectAsPrompt("el");break;case"aaqp":this.addObjectAsPrompt("aq");break;case"ef":var bone=microstrategy.bone("rfe_pane");if(!bone){bone=microstrategy.bone("fexb_pane");}if(bone){var si=this.getItems();var att=this.firstItem().getAttribute(microstrategy.HTMLATTR_PARENT_ID);if(att){ac=bone.addElements(att,this.getItems(),ac);um.add(ac);um.flushAndSubmitChanges();}}break;case"rr":var si=this.getItems();var updateNow=true;var bone=microstrategy.bone("UniqueReportID");if(!bone){return ;}var lockedFlag=false;var isGraph=bone.commands.queryState("graphMode");var err=new Object();var errFlag=false;for(var i=0;i<si.length;i++){if(!this.parentBone.isWSItemRemovable(si[i],err)){errFlag=true;showMessage({contents:err.desc,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});break;}}if(errFlag){break;}for(var i=0;i<si.length;i++){if(si[i].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_ATTRIBUTE_FORM){ac.push(um.createActionObject(null,mstrUpdateManager.REMOVE_FORM_FROM_WS,microstrategy.obBeanPaths[mstrUpdateManager.REMOVE_FORM_FROM_WS],["4167","4168","4169"],[si[i].getAttribute("pid"),si[i].getAttribute(microstrategy.HTMLATTR_DSS_ID),"1"],[],null));if(bone.useClientSideManipulations){var objInfo=bone.gridStructureInfo.findUnit(si[i].getAttribute(microstrategy.HTMLATTR_PARENT_ID));var formInfo=objInfo&&objInfo.attForms.findUnit(si[i].getAttribute(microstrategy.HTMLATTR_DSS_ID));if(formInfo!=null&&!isGraph){bone.commands.exec("removeTemplateUnit",si[i],si[i].getAttribute(microstrategy.HTMLATTR_PARENT_ID),si[i].getAttribute(microstrategy.HTMLATTR_DSS_ID),new Array());}this.parentBone.hideWSItems([si[i]]);this.parentBone.removeFormFromWS(si[i].getAttribute(microstrategy.HTMLATTR_PARENT_ID),si[i].getAttribute(microstrategy.HTMLATTR_DSS_ID),!isGraph);}}else{if(bone.commands.queryState("isLocked",si[i].getAttribute(microstrategy.HTMLATTR_DSS_ID))){lockedFlag=true;}else{var applyChanges=(i==si.length-1)&&updateNow;ac.push(um.createActionObject(null,mstrUpdateManager.REMOVE_WORKINGSET_OBJECT,microstrategy.obBeanPaths[mstrUpdateManager.REMOVE_WORKINGSET_OBJECT],["4110","4165","4166","4164"],[applyChanges,si[i].getAttribute(microstrategy.HTMLATTR_DSS_ID),si[i].getAttribute(microstrategy.HTMLATTR_DSS_TYPE),""],[],null));if(bone.useClientSideManipulations){var objInfo=bone.gridStructureInfo.findUnit(si[i].getAttribute(microstrategy.HTMLATTR_DSS_ID));if(objInfo!=null){bone.commands.exec("removeTemplateUnit",si[i],si[i].getAttribute(microstrategy.HTMLATTR_DSS_ID),null,new Array());}this.parentBone.hideWSItems([si[i]]);}}}}if(lockedFlag){if(si.length==1){showMessage({contents:microstrategy.descriptors.getDescriptor("3807"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{showMessage({contents:microstrategy.descriptors.getDescriptor("3811"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}}else{um.add(ac);um.flushAndSubmitChanges();}break;case"atfa":var i=0;if(microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_ATTRIBUTE_FORM){var children=this.getChildren(this.getParent(microstrategy.activeCXMenu));}else{var children=this.getChildren(microstrategy.activeCXMenu);}for(i=0;i<children.length;i++){if(children[i].getAttribute(microstrategy.HTMLATTR_DSS_ID)==cmdVal){var bone=microstrategy.bone("UniqueReportID");if(bone){ac=bone.commands.exec("addTemplateUnitAttForm",children[i],1,1,ac);if(ac.length>0){um.add(ac);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){um.flushAndSubmitChanges();}}}break;}}break;case"atfr":var i=0;if(microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_ATTRIBUTE_FORM){var children=this.getChildren(this.getParent(microstrategy.activeCXMenu));}else{var children=this.getChildren(microstrategy.activeCXMenu);}for(i=0;i<children.length;i++){if(children[i].getAttribute(microstrategy.HTMLATTR_DSS_ID)==cmdVal){var bone=microstrategy.bone("UniqueReportID");if(bone){ac=bone.commands.exec("removeTemplateUnit",children[i],children[i].getAttribute(microstrategy.HTMLATTR_PARENT_ID),children[i].getAttribute(microstrategy.HTMLATTR_DSS_ID),ac);if(ac.length>0){um.add(ac);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){um.flushAndSubmitChanges();}}}break;}}break;case"atfm":if(microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_ATTRIBUTE_FORM){var attID=this.getParent(microstrategy.activeCXMenu).getAttribute(microstrategy.HTMLATTR_DSS_ID);}else{var attID=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_ID);}um.add([um.createActionObject(null,mstrUpdateManager.OPEN_ATT_FORMS_EDITOR,microstrategy.obBeanPaths[mstrUpdateManager.OPEN_ATT_FORMS_EDITOR],["6042","6044"],[attID,"false"],[],null)]);um.flushAndSubmitChanges();break;case"lt":case"et":var isLinked=(cmdId=="lt");var bone=microstrategy.bone("UniqueReportID");if(bone){ac=bone.commands.exec("replaceTemplate",this.firstItem(),isLinked,ac);}break;case"deopen":var bone=microstrategy.bone("UniqueReportID");if(bone){ac=bone.processContextMenus("deopen");}break;case"addShortcutMetricCount":case"addShortcutMetricMin":case"addShortcutMetricMax":case"addShortcutMetricAvg":case"addShortcutMetricSum":var func={addShortcutMetricSum:12,addShortcutMetricCount:13,addShortcutMetricAvg:14,addShortcutMetricMin:15,addShortcutMetricMax:16}[cmdId];var attID=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_ID);um.add([um.createActionObject(null,mstrUpdateManager.ADD_SHORTCUT_METRIC,microstrategy.obBeanPaths[mstrUpdateManager.ADD_SHORTCUT_METRIC],["4235","4237"],[func,attID+","+microstrategy.DSSTYPE_ATTRIBUTE],[],null)]);um.flushAndSubmitChanges();break;}}catch(err){microstrategy.errors.log(err);return null;}};mstrReportObjSelectionsImpl.prototype.getParent=function(obj){try{var parentUL=findTargetTag(obj,"UL");if(parentUL){var parentLI=findTargetTag(parentUL,"LI");if(parentLI){if(parentLI.getElementsByTagName("span")[0]){return parentLI.getElementsByTagName("span")[0];}}}return null;}catch(err){microstrategy.errors.log(err);return null;}};function mstrReportObjSelectionsImpl(){this.inherits=mstrObjSelectionsImpl;this.inherits();delete this.inherits;return this;}mstrReportObjSelectionsImpl.prototype.addObjectAsPrompt=function(modifier){try{if(this.isMulti()){return ;}var bone=microstrategy.bone("rfe_pane");if(!bone){bone=microstrategy.bone("fexb_pane");}if(bone){var ac=new Array();var um=microstrategy.updateManager;var item=this.firstItem();if(!item){return ;}ac=bone.addUnitAsPrompt(item,ac,modifier,true);um.add(ac);um.flushAndSubmitChanges();}}catch(err){microstrategy.errors.log(err);return null;}};
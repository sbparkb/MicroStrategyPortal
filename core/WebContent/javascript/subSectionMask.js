mstrSubSectionMaskImpl.prototype=new mstrMaskImpl();mstrSubSectionMaskImpl.prototype.superClass=mstrMaskImpl.prototype;mstrSubSectionMaskImpl.prototype.elem=null;mstrSubSectionMaskImpl.prototype.img=null;mstrSubSectionMaskImpl.prototype.docMask=null;mstrSubSectionMaskImpl.prototype.adjusted=false;mstrSubSectionMaskImpl.prototype.path="";mstrSubSectionMaskImpl.prototype.verifiedPath="";mstrSubSectionMaskImpl.prototype.horizontalBone=null;mstrSubSectionMaskImpl.prototype.sibIndex=null;mstrSubSectionMaskImpl.MASK_HILITE_BORDER=microstrategy.DND_HILITE_WIDTH*2;mstrSubSectionMaskImpl.prototype.onload=function(maskedBone){try{this.maskedBone=maskedBone;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.initElem();}catch(err){microstrategy.errors.log(err);return false;}};mstrSubSectionMaskImpl.prototype.onmaskedobjectresize=function(delta,prop){try{if(delta){if(prop=="height"){this.elem.style.height=Math.max(parseInt(this.elem.style.height)+delta,0)+"px";if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))<parseInt(this.elem.style.height)){this.elem.setAttribute(microstrategy.HTMLATTR_HEIGHT,this.getSectionHeight(document.getElementById(this.subId))+this.topOffset);}}if(prop=="width"){if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=parseInt(this.elem.style.width)+delta+"px";}if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_WIDTH))<parseInt(this.elem.style.width)){this.elem.setAttribute(microstrategy.HTMLATTR_WIDTH,this.getSectionWidth(document.getElementById(this.subId))+this.leftOffset);}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubSectionMaskImpl.prototype.onpanelresize=function(height,width){try{this.elem.style.height=height+"px";this.elem.style.width=width+"px";}catch(err){microstrategy.errors.log(err);}};mstrSubSectionMaskImpl.prototype.toggleMaskHilite=function(hide){try{if(this.maskedBone.isHorizontal){this.elem.style.height=(hide)?this.topOffset+parseInt(this.horizontalBone.elem.style.height)+"px":this.getSectionHeight(document.getElementById(this.subId))+this.topOffset+"px";if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=(hide)?this.leftOffset+"px":this.getSectionWidth(document.getElementById(this.subId))+this.leftOffset+"px";}}else{this.elem.style.height=(hide)?this.topOffset+"px":this.getSectionHeight(document.getElementById(this.subId))+this.topOffset+"px";}if(hide){this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");if(bIsIE6){this.elem.style.cursor="not-allowed";}}else{this.img.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(true); }");this.img.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(false); }");this.elem.style.cursor="default";this.elem.setAttribute("isCollapsed","false");}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubSectionMaskImpl.prototype.onmaskedobjectresizeForSib=function(newValue,sibIndex,prop){try{if(newValue){if(prop=="height"){this.elem.style.height=newValue+"px";if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))<parseInt(this.elem.style.height)){this.elem.setAttribute(microstrategy.HTMLATTR_HEIGHT,this.getSectionHeight(document.getElementsByName(this.subId)[sibIndex])+this.topOffset);}}if(prop=="width"){if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=newValue+"px";}if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_WIDTH))<parseInt(this.elem.style.width)){this.elem.setAttribute(microstrategy.HTMLATTR_WIDTH,this.getSectionWidth(document.getElementsByName(this.subId)[sibIndex])+this.leftOffset);}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubSectionMaskImpl.prototype.toggleMaskHiliteForSib=function(hide,sibIndex){try{if(this.maskedBone.isHorizontal){this.elem.style.height=(hide)?this.topOffset+parseInt(this.horizontalBone.elem.style.height)+"px":this.getSectionHeight(document.getElementsByName(this.subId)[sibIndex])+this.topOffset+"px";if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=(hide)?this.leftOffset+"px":this.getSectionWidth(document.getElementsByName(this.subId)[sibIndex])+this.leftOffset+"px";}}else{this.elem.style.height=(hide)?this.topOffset+"px":this.getSectionHeight(document.getElementsByName(this.subId)[sibIndex])+this.topOffset+"px";}if(hide){this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");if(bIsIE6){this.elem.style.cursor="not-allowed";}}else{this.img.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(true); }");this.img.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(false); }");this.elem.style.cursor="default";this.elem.setAttribute("isCollapsed","false");}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubSectionMaskImpl.prototype.initElem=function(){try{var isPanel=(this.maskedBone.subsectionType==mstrSubSection.TYPE_PANEL);var div=document.createElement("div");div.setAttribute("id",this.maskedBone.id+"_mask");div.setAttribute("name",this.maskedBone.id+"_mask");div.style.position=(isPanel)?"absolute":"relative";div.style.overflow="hidden";var img=document.createElement("img");img.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";img.style.width="100%";img.style.height="100%";img.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK);img.setAttribute("isPanel",isPanel);if(this.maskedBone){img.setAttribute(microstrategy.HTMLATTR_MASKEDOBJECT,this.maskedBone.id);img.setAttribute(microstrategy.HTMLATTR_POINTS_TO,this.secId+"|"+this.subId+"|"+this.subIndex);div.style.height=this.getSectionHeight(this.maskedBone.elem)+"px";if(this.maskedBone.isHorizontal){if(this.getSectionWidth(this.maskedBone.elem)!=0){div.style.width=this.getSectionWidth(this.maskedBone.elem)+"px";}}}div.appendChild(img);this.img=img;this.elem=div;if(parseInt(this.elem.style.height)>0){this.img.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(true); }");this.img.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(false); }");this.elem.setAttribute("isCollapsed","false");}else{this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");this.elem.style.cursor="not-allowed";}}catch(err){microstrategy.errors.log(err);return false;}};mstrSubSectionMaskImpl.prototype.displayMask=function(show){try{var submaskDiv=document.getElementById("maskDiv");if(!submaskDiv){submaskDiv=document.createElement("div");submaskDiv.setAttribute("id","maskDiv");submaskDiv.style.position="absolute";var docMask=document.getElementById("docMask");docMask.insertBefore(submaskDiv,docMask.firstChild);}if(!show){submaskDiv.style.display="none";return false;}var isPanel=(this.maskedBone.subsectionType==mstrSubSection.TYPE_PANEL);if(isPanel){with(submaskDiv.style){border=(this.parentBone.selections.isSameSubSection())?"3px solid #ffff00":"0px solid #ffff00";display="block";visibility="visible";var panelStack=this.maskedBone.parentBone;var h=getObjHeight(panelStack.elem);if(panelStack.isTitleVisible){h-=getObjHeight(panelStack.titleBars[0]);}var w=getObjWidth(panelStack.elem);h=(h<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?h:h-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;w=(w<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?w:w-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;height=h+"px";width=w+"px";left=getObjSumLeft(this.maskedBone.elem)-parseInt(this.maskedBone.doc.left)+"px";top=getObjSumTop(this.maskedBone.elem)-parseInt(this.maskedBone.doc.top)+"px";}}else{var isFirstMask=(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))<parseInt(this.elem.style.height));var dHeight=(isFirstMask)?parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))-this.topOffset:parseInt(this.elem.style.height)-this.topOffset;var subObj=document.getElementById(this.subId);var dWidth=getObjWidth(subObj);dHeight=(dHeight<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?dHeight:dHeight-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;dWidth=(dWidth<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?dWidth:dWidth-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;with(submaskDiv.style){height=dHeight+"px";width=dWidth+"px";border=(this.parentBone.selections.isSameSubSection())?"3px solid #ffff00":"0px solid #ffff00";display="block";visibility="visible";}if(dHeight>0){var offset=(isFirstMask)?0:this.parentBone.mouseoffsetTop;var left=0;if(this.maskedBone.isHorizontal){left=getObjSumLeft(subObj)-getObjSumLeft(this.parentBone.elem);}moveObjTo(submaskDiv,left,getObjSumTop(this.elem)-offset-getObjSumTop(this.parentBone.elem)-parseInt(this.parentBone.docMask.style.top)+this.topOffset);}}}catch(err){microstrategy.errors.log(err);}return false;};mstrSubSectionMaskImpl.prototype.getSectionHeight=function(elem){try{if(elem.style.display!=null&&elem.style.display.toLowerCase()=="none"){return 0;}else{return getObjHeight(elem);}}catch(err){microstrategy.errors.log(err);return 0;}};mstrSubSectionMaskImpl.prototype.getSectionWidth=function(elem){try{if(elem.style.display!=null&&elem.style.display.toLowerCase()=="none"){return 0;}else{return getObjWidth(elem);}}catch(err){microstrategy.errors.log(err);return 0;}};function mstrSubSectionMaskImpl(secId,subId,subIndex){this.secId=secId;this.subId=subId;this.subIndex=subIndex;this.topOffset=0;this.leftOffset=0;return this;}
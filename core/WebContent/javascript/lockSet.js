lockSetScript=true;var MINIMUM_GRID_WIDTH=75;var MINIMUM_GRID_HEIGHT=200;var MARGIN_WIDTH=18;var bIgnoreScroll=false;var oLockSet=null;var iWidth1Array=null;var quadTables=new Array();var rowHeightArray=null;function initLockHeaders(){return ;oLockSet=null;if(getObj("UniqueReportID")&&getObj("divLock4")){oLockSet=new lockSet(getObj("UniqueReportID"),getObj("divLock4"),getObj("divLock2"),getObj("divLock3"),getObj("divLock1"),iStartCol,iEndCol);if(!oLockSet.initialized){return ;}else{oLockSet.resize(null);}oLockSet.toggleLock(true);document.body.onresize=onWinResize;}return ;}lockSet.prototype=new Object();lockSet.prototype.gridBone=null;lockSet.prototype.startY=0;lockSet.prototype.timer=null;lockSet.prototype.quad2ClipHeight=0;lockSet.prototype.quad2ClipWidth=0;lockSet.prototype.quad3ClipHeight=0;lockSet.prototype.quad3ClipWidth=0;lockSet.prototype.onmousedown=function(e){this.startY=this.quadrants[0].scrollLeft;this.timer=window.setTimeout("microstrategy.bone('"+this.gridBone.id+"').lockSet.onmouseup()",1000);};lockSet.prototype.onmouseup=function(e){window.clearTimeout(this.timer);if(this.gridBone.colWidths!=null&&this.startY!=this.quadrants[0].scrollLeft){this.gridBone.onlockscroll();}this.startY=0;};function lockSet(entireGrid,divEntireTable,divColHeaders,divRowHeaders,divTopLeftCorner,colCount,gridBone){if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){MINIMUM_GRID_HEIGHT=36;}this.doResize=true;this.initialized=false;this.quadrants=new Array;this.backgroundMasks={};this.quadrants[0]=divEntireTable;this.quadrants[1]=divTopLeftCorner;this.quadrants[2]=divColHeaders;this.quadrants[3]=divRowHeaders;this.table=entireGrid.getElementsByTagName("table")[0];this.gridBone=gridBone;this.COLTags=new Array;if(this.table){this.rows=this.table.rows.length;this.fixedRows=util_getFixedRows(this.table);this.fixedCols=this.gridBone.commands.queryState("fixedColumns");this.cols=colCount;util_initCOLTags(this.table,this.cols);this.COLTags[0]=this.table.getElementsByTagName("COL");this.tableAutoWidth=(this.table.style.tableLayout!="fixed");}else{this.rows=0;this.cols=0;this.fixedRows=0;this.fixedCols=0;this.COLTags[0]=null;this.tableAutoWidth=false;}if((this.table)&&(this.quadrants[0])&&((this.quadrants[2])||(this.quadrants[3]))){m_initQuadrants(this);this.initialized=true;}if(mstr.utils.ISIE8){this.lastScrollTop=0;this.lastScrollLeft=0;}this.gridBone.elem.style.overflow="hidden";this.toggleLock=m_toggleLock;this.resize=m_resizeLockSet;this.updateColWidth=m_updateColWidth;this.updateRowHeight=m_updateRowHeight;this.updateRowDisplay=m_updateRowDisplay;return this;}function m_initQuadrants(oLockSet){oLockSet.quadrants[0].onmousedown=new Function("e","microstrategy.bone('"+oLockSet.gridBone.id+"').lockSet.onmousedown(e)");for(var i=1;i<4;i++){var oTable=null;var oDiv=oLockSet.quadrants[i];if(oDiv){oTable=oDiv.childNodes[0];oLockSet.backgroundMasks[i]=document.createElement("div");oDiv.insertAdjacentElement("afterEnd",oLockSet.backgroundMasks[i]);oLockSet.backgroundMasks[i].style.backgroundColor="#fff";oLockSet.backgroundMasks[i].style.position="absolute";}if(oTable){util_initCOLTags(oTable,(i!=2)?oLockSet.fixedCols:oLockSet.cols);oLockSet.COLTags[i]=oTable.getElementsByTagName("COL");util_setObjTableLayout(oTable,"fixed");}}return ;}function m_toggleLock(bFlag){if(!this.initialized){return ;}this.locked=bFlag;if(bFlag){trackScrolling();if(this.quadrants[0]){this.quadrants[0].oLockSet=this;this.quadrants[0].onscroll=trackScrolling;}if(this.quadrants[1]){this.quadrants[1].oLockSet=this;this.quadrants[1].onscroll=trackScrollingTopCorner;}if(this.quadrants[2]){this.quadrants[2].oLockSet=this;this.quadrants[2].onscroll=trackScrollingColHeaders;}if(this.quadrants[3]){this.quadrants[3].oLockSet=this;this.quadrants[3].onscroll=trackScrollingRowHeaders;}}else{for(i=0;i<4;i++){if(this.quadrants[i]){this.quadrants[i].onscroll=null;}}}if(bFlag){var sV="visible";}else{var sV="hidden";}for(var i=1;i<4;i++){if(this.quadrants[i]){this.quadrants[i].style.visibility=sV;}}return ;}function m_resizeLockSet(e,width,height){if(!isInDocument(this.table)){return ;}if(!this.doResize){return ;}this.doResize=false;m_resizeGridArea(this,width,height);m_resizeClippingAreas(e,this);if((this.tableAutoWidth)||(!e)){m_alignHeaderCells(this);}this.doResize=true;return ;}function m_resizeGridArea(oLockSet,width,height){var div=oLockSet.quadrants[0];var lWidth;var lHeight;if(width){lWidth=width;}else{lWidth=m_getAvailableGridAreaWidth(div,oLockSet);}if(height){lHeight=height;}else{lHeight=m_getAvailableGridAreaHeight(div,oLockSet)-SCROLLBAR_SIZE;}for(var i=0;i<4;i++){if(i>0&&(mstr.utils.ISANYIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&oLockSet.quadrants[i]){oLockSet.quadrants[i].style.overflow="hidden";}if(oLockSet.quadrants[i]){if(i!=3||(!mstr.utils.ISIE8&&!(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))){if(!((i==1||i==2)&&(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))){lHeight+=i==3?getClipHeightAdjustment(oLockSet.quadrants[0]):0;oLockSet.quadrants[i].style.height=(lHeight)+"px";}}if(i!=2||(!mstr.utils.ISIE8&&!(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))){if(!((i==1||i==3)&&(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))){oLockSet.quadrants[i].style.width=(lWidth)+"px";}}if(i==0&&mstr.utils.ISIE8){oLockSet.quadrants[i].style.width=(lWidth+1)+"px";}}}if(oLockSet.gridBone.commands.queryState("fittowindow")){var w=null;if(oLockSet.quadrants[0]){w=(lWidth-(getObjInnerHeight(oLockSet.quadrants[0])<getObjInnerHeight(oLockSet.table)?SCROLLBAR_SIZE:0))+"px";oLockSet.table.style.width=w;}if(w&&oLockSet.quadrants[2]&&bIsIE6){var tbl=oLockSet.quadrants[2].childNodes[0];if(tbl){tbl.style.width=w;}}}if((!(!window.oColHandlesSet))&&(oColHandlesSet.onGridAreaResize)){oColHandlesSet.onGridAreaResize(lWidth);}return ;}function m_resizeClippingAreas(e,oLockSet){var lDataWidth=m_getScrollAreaWidth(oLockSet.quadrants[0],(!e))-1;var lDataHeight=m_getScrollAreaHeight(oLockSet.quadrants[0],(!e))-1;var lFixedColsWidth=util_getWidthofFixedColumns(oLockSet.table,oLockSet.fixedCols,oLockSet.cols,oLockSet.rows);var lFixedRowsHeight=util_getHeightofFixedRows(oLockSet.table,oLockSet.fixedRows,oLockSet.rows);if(lFixedRowsHeight>lDataHeight){lFixedRowsHeight=lDataHeight;}if(lFixedColsWidth>lDataWidth){lFixedColsWidth=lDataWidth;}if(oLockSet.quadrants[1]){oLockSet.quadrants[1].style.clip="rect(0px "+lFixedColsWidth+"px "+lFixedRowsHeight+"px 0px)";var maskStyle=oLockSet.backgroundMasks[1].style;maskStyle.top="0px";maskStyle.left="0px";maskStyle.width=lFixedColsWidth+"px";maskStyle.height=lFixedRowsHeight+"px";maskStyle.zIndex=5;}if(oLockSet.quadrants[2]){oLockSet.quad2ClipHeight=lFixedRowsHeight;if(oLockSet.gridBone.commands.queryState("fittowindow")){oLockSet.quad2ClipWidth=lDataWidth+2;}else{oLockSet.quad2ClipWidth=Math.min(oLockSet.table.offsetWidth,lDataWidth+(mstr.utils.ISIE8?0:2));}}if(oLockSet.quadrants[3]){oLockSet.quad3ClipHeight=Math.min(oLockSet.table.offsetHeight,lDataHeight+getClipHeightAdjustment(oLockSet.quadrants[0]));oLockSet.quad3ClipWidth=lFixedColsWidth;}window.setTimeout("m_reclip(microstrategy.bone('"+oLockSet.gridBone.id+"').lockSet)",5);if((!(!window.oColHandlesSet))&&(oColHandlesSet.onGridFixedColsResize)){oColHandlesSet.onGridFixedColsResize(lFixedColsWidth);}if(mstr.utils.ISWK){oLockSet.gridBone.forcerepaint(document.getElementById("mstrWebContents"));}return ;}function m_reclip(oLockSet){resetScrolling(oLockSet);var maskStyle=null;if(oLockSet.quadrants[2]){var left=0,right=oLockSet.quad2ClipWidth;if(mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){left+=oLockSet.lastScrollLeft;right+=oLockSet.lastScrollLeft;}oLockSet.quadrants[2].style.clip="rect(0px "+right+"px "+oLockSet.quad2ClipHeight+"px "+left+"px)";maskStyle=oLockSet.backgroundMasks[2].style;maskStyle.top="0px";maskStyle.left=-left+"px";maskStyle.width=right+"px";maskStyle.height=oLockSet.quad2ClipHeight+"px";maskStyle.zIndex=3;}if(oLockSet.quadrants[3]){var top=0,bottom=oLockSet.quad3ClipHeight;if(mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){top+=oLockSet.lastScrollTop;bottom+=oLockSet.lastScrollTop;}oLockSet.quadrants[3].style.clip="rect("+top+"px "+oLockSet.quad3ClipWidth+"px "+bottom+"px 0px)";maskStyle=oLockSet.backgroundMasks[3].style;maskStyle.top=-top+"px";maskStyle.left="0px";maskStyle.width=oLockSet.quad3ClipWidth+"px";maskStyle.height=bottom+"px";maskStyle.zIndex=1;}}function m_getScrollAreaHeight(oDiv,bUseHack){var lHeight=oDiv.clientHeight+1;if(bUseHack){lHeight=Math.min(lHeight,parseInt(oDiv.style.height)-SCROLLBAR_SIZE);}return(lHeight);}function m_getScrollAreaWidth(oDiv,bUseHack){var lWidth=oDiv.clientWidth+1;if(bUseHack&&!(mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10))){lWidth=Math.min(lWidth,parseInt(oDiv.style.width)-SCROLLBAR_SIZE);}return(lWidth);}function m_getAvailableGridAreaWidth(divEntireTable,oLockSet){var lWidth=getClientWidth()-getObjSumLeftScrolled(divEntireTable);if(!bIsIE7){lWidth-=5;}if(oLockSet.quadrants[3]){var lFixedColsWidth;if(mstr.utils.ISIE7){var colTags=oLockSet.table.getElementsByTagName("COL");lFixedColsWidth=mstr.utils.BoxModel.getElementSumOffsetLeft((colTags&&colTags[oLockSet.fixedCols]),document.body)-getObjSumLeft(oLockSet.table);}else{var lFixedColsWidth=util_getWidthofFixedColumns(oLockSet.table,oLockSet.fixedCols,oLockSet.cols,oLockSet.rows,oLockSet.COLTags&&oLockSet.COLTags[0]);}if(lWidth<MINIMUM_GRID_WIDTH+lFixedColsWidth){lWidth=MINIMUM_GRID_WIDTH+lFixedColsWidth;}}if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){lWidth-=6;if(bIsIE4&&!bIsIE7){lWidth-=7;}}return(lWidth);}function m_getAvailableGridAreaHeight(divEntireTable,oLockSet){var bottom_fetch=microstrategy.findChildWithAtt(document.getElementById("reportViewAllModes"),"DIV",(bIsW3C)?"class":"className","report-bottom");var lHeight=getClientHeight()-(getObjSumTop(divEntireTable)-getDocumentScrollTop())-getFooterHeight()-getObjHeight(bottom_fetch);var lFixedRowsHeight=util_getHeightofFixedRows(oLockSet.table,oLockSet.fixedRows,oLockSet.rows);if(lHeight<MINIMUM_GRID_HEIGHT+lFixedRowsHeight){lHeight=MINIMUM_GRID_HEIGHT+lFixedRowsHeight;}if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){lHeight-=3;}return(lHeight);}function m_alignHeaderCells(oLockSet){var oTable=oLockSet.table;if(!oTable){return ;}iWidth1Array=util_getHeaderColumnWidths(oTable);var w=0;if(oLockSet.quadrants[3]){for(var k=0,len=oLockSet.fixedCols;k<len;k++){w+=iWidth1Array[k];}w+=4;var tbl=oLockSet.quadrants[3].childNodes[0];if(tbl){var fn=function(a){var s=0;for(var i=0,iLen=a.length;i<iLen;i++){var b=parseInt(mstr.utils.CSS.getStyleValue(tbl,a[i]));s+=(!isNaN(b)?b:1);}return s+(mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10)?1:0);};w+=fn(["borderRightWidth","borderLeftWidth"]);}}var rows=oTable.rows;rowHeightArray=new Array();for(var k=0;k<rows.length;k++){if(rows[k]){if((mstr.utils.ISIE9||mstr.utils.ISIE10)){rowHeightArray.push(util_getRowHeight(rows[k]));}else{rowHeightArray.push((!mstr.utils.ISIE8)?getObjOuterHeight(rows[k]):getObjInnerHeight(rows[k]));}}}quadTables[oLockSet.gridBone.id]=new Array();for(var i=1;i<4;i++){if(oLockSet.quadrants[i]){quadTables[oLockSet.gridBone.id].push(oLockSet.quadrants[i].childNodes[0]);var v=(i!=2)?w:oTable.offsetWidth;var isOutlineMode=oLockSet.gridBone&&oLockSet.gridBone.isOutlineMode&&oLockSet.gridBone.hasThresholds;window.setTimeout("m_syncOffsets(["+iWidth1Array+"], ["+rowHeightArray+"], quadTables['"+oLockSet.gridBone.id+"']["+(i-1)+"], "+v+", "+isOutlineMode+","+i+")",0);}else{quadTables[oLockSet.gridBone.id].push(null);}}return ;}function m_syncOffsets(oOrigWidth,origHeights,oTableCopy,iTableOuterWidth,isOutlineMode,oTableCopyIndex){var localerr;try{var oCOLs2=oTableCopy.getElementsByTagName("COL");if(oOrigWidth&&oOrigWidth.length){var iCols=oOrigWidth.length;if(mstr.utils.ISFF3&&!mstr.utils.ISFF3_5||(mstr.utils.ISIE9||mstr.utils.ISIE10)||mstr.utils.ISWK){oTableCopy.style.tableLayout="auto";}if(!bIsIE4||mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10)){var totalWidth=iTableOuterWidth||0;if(!totalWidth){for(var i=0;i<iCols;i++){totalWidth+=oOrigWidth[i];}}oTableCopy.style.width=totalWidth+"px";}else{oTableCopy.style.width="";}var hasWidth=false;for(var i=0;i<iCols;i++){if(oOrigWidth[i]!=0){hasWidth=true;break;}}for(var i=0,len=oCOLs2.length;i<len;i++){var oCOL=oCOLs2[i];if(oCOL){util_alignColumnHeaderCell(oCOL,oOrigWidth[i]);}}window.setTimeout(function fn(){if(mstr.utils.ISFF3&&!mstr.utils.ISFF3_5||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)||mstr.utils.ISWK){oTableCopy.style.tableLayout="fixed";if(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE){if(mstr.utils.ISIE10){var colgroup=oTableCopy.getElementsByTagName("colgroup")[0];if(colgroup){colgroup.style.display="table-row";}for(var i=0,len=oCOLs2.length;i<len;i++){var oCOL=oCOLs2[i];if(oCOL){oCOL.style.display="table-cell";}}}window.setTimeout(function(){var len=oCOLs2.length,border=util_getBorderWidth(oTableCopy,"left")+util_getBorderWidth(oTableCopy,"right"),padding=util_getCellPadding(oTableCopy,"left")+util_getCellPadding(oTableCopy,"right"),layoutwidth=parseFloat(mstr.utils.CSS.getStyleValue(oTableCopy,"width"))+border+padding,diff=(parseFloat(oTableCopy.style.width)-(layoutwidth))/len;if(diff>-0.05){if(mstr.utils.ISIE9){if(oTableCopyIndex==3){oTableCopy.style.width=layoutwidth+0.3+"px";}}return ;}if(oTableCopyIndex==2){for(var i=0;i<len;i++){var oCOL=oCOLs2[i];if(oCOL){util_alignColumnHeaderCell(oCOL,parseFloat(oCOL.style.width)+diff);}}}},10);}}m_syncRowOffsets(origHeights,oTableCopy,isOutlineMode);},0);}}catch(localerr){}return ;}function m_syncRowOffsets(origHeights,oTableCopy,isOutlineMode){var localerr;try{var oRows2=oTableCopy.rows;if(origHeights&&origHeights.length){var iRows=origHeights.length;var ol=oRows2.length;for(var i=0;i<iRows&&i<ol;i++){if(oRows2[i]){var iHeight1=origHeights[i];var iHeight2=(!mstr.utils.ISIE8)?getObjOuterHeight(oRows2[i]):getObjInnerHeight(oRows2[i]);iHeight2=(mstr.utils.ISIE9||mstr.utils.ISIE10)?util_getRowHeight(oRows2[i]):iHeight2;if(iHeight1!=iHeight2){var iHeight2Orig=parseInt(oRows2[i].style.height);var newHeight=0;if(!isNaN(iHeight2Orig)&&iHeight2Orig!=iHeight1&&!((mstr.utils.ISIE9||mstr.utils.ISIE10)&&isOutlineMode)){newHeight=(iHeight2Orig+(iHeight1-iHeight2));}else{newHeight=iHeight1;}util_serRowHeight(oRows2[i],newHeight,isOutlineMode);}}}}}catch(localerr){}return ;}function m_updateColWidth(e,iColumnIndex,lColumnWidth,lTableWidth){for(var i=1;i<4;i++){if((this.quadrants[i])&&(this.COLTags[i])){if(iColumnIndex<this.COLTags[i].length){this.COLTags[i][iColumnIndex].style.width=lColumnWidth;}this.quadrants[i].childNodes[0].style.width=lTableWidth+"px";}}return ;}function m_updateRowHeight(lRowHeight,iStartRow,iEndRow){for(var i=1;i<4;i++){if(this.quadrants[i]){util_applySingleRowHeight(this.quadrants[i].childNodes[0],lRowHeight,iStartRow,iEndRow);}}return ;}function m_updateRowDisplay(iRow,sDisplay){if(!this.quadrants){return ;}if(!this.quadrants[3]){return ;}var oTable=this.quadrants[3].childNodes[0];if(!oTable){return ;}if(!oTable.rows){return ;}if(oTable.rows.length<iRow+1){return ;}var oRow=oTable.rows[iRow];if(!oRow){return ;}oRow.style.display=sDisplay;return ;}function resetScrolling(oLockSet){var q0=oLockSet.quadrants[0];var q2=oLockSet.quadrants[2];var q3=oLockSet.quadrants[3];if(q3){if(!(mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))){q3.scrollTop=q0.scrollTop;}else{q3.style.top=(0-q0.scrollTop)+"px";oLockSet.lastScrollTop=q0.scrollTop;}}if(q2){if(!(mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))){q2.scrollLeft=q0.scrollLeft;}else{q2.style.left=(0-q0.scrollLeft)+"px";oLockSet.lastScrollLeft=q0.scrollLeft;}}}function trackScrolling(e){if(bIgnoreScroll){return ;}if(!this.oLockSet){return ;}bIgnoreScroll=true;window.clearTimeout(this.oLockSet.timer);m_reclip(this.oLockSet);this.oLockSet.timer=window.setTimeout("microstrategy.bone('"+this.oLockSet.gridBone.id+"').lockSet.onmouseup()",1000);bIgnoreScroll=false;return ;}function trackScrollingRowHeaders(e){if(bIgnoreScroll){return ;}if(!this.oLockSet){return ;}if(!this.oLockSet.quadrants[3]){return ;}bIgnoreScroll=true;this.oLockSet.quadrants[3].scrollLeft=0;var lScrollTop=this.oLockSet.quadrants[3].scrollTop;this.oLockSet.quadrants[0].scrollTop=lScrollTop;if(this.oLockSet.quadrants[0].scrollTop<lScrollTop){this.oLockSet.quadrants[3].scrollTop=this.oLockSet.quadrants[0].scrollTop;}bIgnoreScroll=false;return ;}function trackScrollingColHeaders(e){if(bIgnoreScroll){return ;}if(!this.oLockSet){return ;}if(!this.oLockSet.quadrants[2]){return ;}bIgnoreScroll=true;this.oLockSet.quadrants[2].scrollTop=0;var lScrollLeft=this.oLockSet.quadrants[2].scrollLeft;if(this.oLockSet.quadrants[0]){this.oLockSet.quadrants[0].scrollLeft=lScrollLeft;}if((!(!window.oColHandlesSet))&&(oColHandlesSet.onGridTableScroll)){oColHandlesSet.onGridTableScroll(lScrollLeft);}bIgnoreScroll=false;return ;}function trackScrollingTopCorner(e){if(!this.oLockSet){return ;}var div=this.oLockSet.quadrants[1];if(!div){return ;}div.scrollLeft=0;div.scrollTop=0;return ;}function getClipHeightAdjustment(quadrant4){return mstr.utils.BoxModel.hasScrollbar(quadrant4,"x")?0:SCROLLBAR_SIZE;}
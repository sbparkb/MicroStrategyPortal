if(typeof (microstrategy)=="undefined"){self.microstrategy=new function(){};}microstrategy.prototype={};microstrategy.OBJTYPE_ATTRIBUTE="ATTR";microstrategy.OBJTYPE_METRIC="MV";microstrategy.OBJTYPE_OBJBROWSER="obbr";microstrategy.OBJTYPE_EDITOR="edt";microstrategy.OBJTYPE_GRAPH_ZONES="gzn";microstrategy.OBJTYPE_RW_PAGE="RWPA";microstrategy.OBJTYPE_RW_TEXTFIELD="TEXT";microstrategy.OBJTYPE_DOC="docu";microstrategy.OBJTYPE_DOC_OBJECT="obj";microstrategy.OBJTYPE_DOC_SUBSECTION_CONTAINER="subscon";microstrategy.OBJTYPE_DOC_SUBSECTION="4";microstrategy.OBJTYPE_DOC_SECTION="dsec";microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER="hcont";microstrategy.OBJTYPE_DOC_PARENT_HORIZONTAL_CONTAINER="parenthcont";microstrategy.OBJTYPE_DOC_SELECTION="dsel";microstrategy.OBJTYPE_RW_HILITES="RWHI";microstrategy.OBJTYPE_RW_HANDLES="RWHA";microstrategy.OBJTYPE_RW_LASSO="RWLA";microstrategy.OBJTYPE_DOCKZONE="dock";microstrategy.OBJTYPE_TOOLBAR="tool";microstrategy.OBJTYPE_FOLDER="f";microstrategy.OBJTYPE_ATTRIBUTE="a";microstrategy.OBJTYPE_ELEMENT="e";microstrategy.OBJTYPE_GRID="g";microstrategy.OBJTYPE_GRAPH="gp";microstrategy.OBJTYPE_BTN_GROUP="btng";microstrategy.OBJTYPE_PAGE_BY="pgby";microstrategy.OBJTYPE_PAGE_BY_ELEM="pbel";microstrategy.OBJTYPE_FAKED_PAGE_BY_ELEM="fkpbel";microstrategy.OBJTYPE_FILTER_EDITOR="filt";microstrategy.OBJTYPE_RULER="rul";microstrategy.OBJTYPE_MASK="mask";microstrategy.OBJTYPE_MASK_MAP="mama";microstrategy.OBJTYPE_MASK_MAP_AREA="mmar";microstrategy.OBJTYPE_ANY="*";microstrategy.OBJTYPE_FORMULA_BAR="fmla";microstrategy.OBJTYPE_TAB="tab";microstrategy.OBJTYPE_TAB_SET="tset";microstrategy.OBJTYPE_INC_FETCH_PANE="incf";microstrategy.OBJTYPE_INC_FETCH="if";microstrategy.OBJTYPE_OBJECT_COUNT="objCount";microstrategy.OBJTYPE_EDITOR="edt";microstrategy.OBJTYPE_CONTEXT_MENU="cxt";microstrategy.OBJTYPE_MESSAGE_BOX="mbx";microstrategy.OBJTYPE_DSEL_MOVE_RECS="mrec";microstrategy.OBJTYPE_FLOATING_TOOLBAR="ftb";microstrategy.OBJTYPE_SECURITY_FILTER="sf";microstrategy.OBJTYPE_FIRST_CLASS_OBJECT="fco";microstrategy.OBJTYPE_XDA_DATA_ELEMENT="xdae";microstrategy.OBJTYPE_PANEL_STACK="pnls";microstrategy.OBJTYPE_SCROLLER_HANDLE="schn";microstrategy.OBJTYPE_SCROLLER_CONTAINER="sctb";microstrategy.OBJTYPE_SCROLLER_CONTAINER_GHOST="sctbgh";microstrategy.OBJTYPE_SCROLLER_TRACK="sctrk";microstrategy.OBJTYPE_RW_CONTROL="RWCTL";microstrategy.ORIENTATION_HORIZONTAL=0;microstrategy.ORIENTATION_VERTICAL=1;microstrategy.GRIDCELL_ORIENTATION_VERTICAL="V";microstrategy.GRIDCELL_ORIENTATION_HORIZONTAL="H";microstrategy.GRIDCELL_AXIS_METRICS=-1;microstrategy.GRIDCELL_AXIS_ATT_FORMS=0;microstrategy.GRIDCELL_AXIS_ROWS=1;microstrategy.GRIDCELL_AXIS_COLUMNS=2;microstrategy.GRIDCELL_AXIS_PAGE_BY=3;microstrategy.GRID_EFFECTIVE_VIEW_GRID=0;microstrategy.GRID_EFFECTIVE_VIEW_GRAPH=1;microstrategy.GRID_EFFECTIVE_VIEW_GRID_GRAPH=2;microstrategy.SUBOBJTYPE_TITLEBAR="titl";microstrategy.SUBOBJTYPE_STATUSBAR="stat";microstrategy.SUBOBJTYPE_TOOLBAR="tool";microstrategy.SUBOBJTYPE_TOOLBAR_HANDLE="toha";microstrategy.SUBOBJTYPE_GRID_TABLE="tabl";microstrategy.SUBOBJTYPE_TREE="tree";microstrategy.SUBOBJTYPE_TREE_VIEW="treeView";microstrategy.SUBOBJTYPE_BODY="body";microstrategy.SUBOBJTYPE_SECTION_HANDLE="shan";microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE="sshan";microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER="107";microstrategy.SUBOBJTYPE_CONTAINER_TITLEBAR="ctitl";microstrategy.SUBOBJTYPE_DOC_TEXT="106";microstrategy.SUBOBJTYPE_DOC_IMAGE="102";microstrategy.SUBOBJTYPE_DOC_LINE="105";microstrategy.SUBOBJTYPE_DOC_SHAPE="101";microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND="112";microstrategy.SUBOBJTYPE_DOC_TEMPLATE="52";microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|R";microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|"+microstrategy.GRID_EFFECTIVE_VIEW_GRID;microstrategy.SUBOBJTYPE_DOC_GRAPH_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|"+microstrategy.GRID_EFFECTIVE_VIEW_GRAPH;microstrategy.SUBOBJTYPE_DOC_GRID_GRAPH_TEMPLATE=microstrategy.SUBOBJTYPE_DOC_TEMPLATE+"|"+microstrategy.GRID_EFFECTIVE_VIEW_GRID_GRAPH;microstrategy.GRAPH_CTL="52G";microstrategy.SUBOBJTYPE_DOC_PANEL_STACK="8";microstrategy.SUBOBJTYPE_DOC_PANEL="9";microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL="111";microstrategy.SUBOBJTYPE_DOC_WIDGET="113";microstrategy.SUBOBJTYPE_SEL_HANDLE="shan";microstrategy.SUBOBJTYPE_FOLDER_LIST="folderList";microstrategy.SUBOBJTYPE_FOLDER_UP="folderUp";microstrategy.SUBOBJTYPE_FILE_SEARCH="fileSearch";microstrategy.SUBOBJTYPE_FILE_LIST="fileList";microstrategy.SUBOBJTYPE_BTN="btn";microstrategy.SUBOBJTYPE_BTN_HANDLE="btnh";microstrategy.SUBOBJTYPE_VRULER="vRul";microstrategy.SUBOBJTYPE_VRULER_SHADE="vRulS";microstrategy.SUBOBJTYPE_HRULER="hRul";microstrategy.SUBOBJTYPE_HRULER_SHADE="hRulS";microstrategy.SUBOBJTYPE_TAB_CONTAINER="tabCont";microstrategy.SUBOBJTYPE_TAB_SAMPLE="sample";microstrategy.SUBOBJTYPE_TAB_SECTION="tabSection";microstrategy.SUBOBJTYPE_FORMULA_BAR_AREA="fmlaArea";microstrategy.SUBOBJTYPE_FORMULA_BAR_TEXT_AREA="fmlaTextArea";microstrategy.SUBOBJTYPE_RESIZE_VLINE="vline";microstrategy.SUBOBJTYPE_RESIZE_HLINE="hline";microstrategy.SUBOBJTYPE_ATTRIBUTE="ATT";microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM="ATTFORM";microstrategy.SUBOBJTYPE_METRIC="MV";microstrategy.SUBOBJTYPE_IMG="cimg";microstrategy.SUBOBJTYPE_PREVIEW_PANE="prv";microstrategy.SUBOBJTYPE_OUTLINE_MODE_IMG="outimg";microstrategy.SUBOBJTYPE_PANEL_CONTAINER="pc";microstrategy.SUBOBJTYPE_WINDOW_BUTTON="wBtn";microstrategy.SUBOBJTYPE_RA_BTN="raBtn";microstrategy.SUBOBJTYPE_SLIDER="slider";microstrategy.SUBOBJTYPE_ESRIMAP="esrimap";microstrategy.SUBOBJTYPE_GMAP="gmap";microstrategy.DSSTYPE_TEMPLATE="2";microstrategy.DSSTYPE_RPT_DEFINITION="3";microstrategy.DSSTYPE_DOC_DEFINITION="55";microstrategy.DSSTYPE_FOLDER="8";microstrategy.DSSTYPE_CONSOLIDATION_ELEMENT="48";microstrategy.DSSTYPE_METRIC="4";microstrategy.DSSTYPE_USER_METRIC="100";microstrategy.DSSTYPE_USER_SUMMARY_METRIC="101";microstrategy.DSSTYPE_ATTRIBUTE="12";microstrategy.DSSTYPE_ATTRIBUTE_FORM="21";microstrategy.DSSTYPE_FILTER="1";microstrategy.DSSTYPE_PROMPT="10";microstrategy.DSSTYPE_CONSOLIDATION="47";microstrategy.DSSTYPE_CUSTOM_GROUP="257";microstrategy.DSSTYPE_DIMENSION="14";microstrategy.DSSTYPE_GRID="768";microstrategy.DSSTYPE_GRAPH="769";microstrategy.DSSTYPE_GRID_AND_GRAPH="774";microstrategy.DSSTYPE_REPORT_CUBE="776";microstrategy.DSSTYPE_HIERARCHY="14";microstrategy.DSSTYPE_SHORTCUT="18";microstrategy.DISPUNITTYPE_ELEMENT="1048576";microstrategy.DSSSUB_TYPE_FILTER="256";microstrategy.DSSSUB_TYPE_RW="14081";microstrategy.DSSSUB_TYPE_PROMPT=2560;microstrategy.DSSSUB_TYPE_PROMPT_BOOLEAN=2561;microstrategy.DSSSUB_TYPE_PROMPT_LONG=2562;microstrategy.DSSSUB_TYPE_PROMPT_STRING=2563;microstrategy.DSSSUB_TYPE_PROMPT_DOUBLE=2564;microstrategy.DSSSUB_TYPE_PROMPT_DATE=2565;microstrategy.DSSSUB_TYPE_PROMPT_BIG_DECIMAL=2571;microstrategy.DSSSUB_TYPE_PROMPT_OBJECTS=2566;microstrategy.DSSSUB_TYPE_PROMPT_ELEMENTS=2567;microstrategy.DSSSUB_TYPE_PROMPT_EXPRESSION=2568;microstrategy.DSSSUB_TYPE_PROMPT_DIMPTY=2570;microstrategy.DSSSUB_TYPE_DERIVED_ATTRIBUTE=3077;microstrategy.HTMLATTR_SCRIPTCLASS="scriptclass";microstrategy.HTMLATTR_ID="id";microstrategy.HTMLATTR_OBJTYPE="ty";microstrategy.HTMLATTR_DSSTYPE="dss_ty";microstrategy.HTMLATTR_DISPLAY_NAME="ds";microstrategy.HTMLATTR_SUBOBJTYPE="sty";microstrategy.HTMLATTR_STYLE="styst";microstrategy.HTMLATTR_OBJINDEX="ind";microstrategy.HTMLATTR_DISPUNITTYPE="dty";microstrategy.HTMLATTR_DISPLAY_NAME="ds";microstrategy.HTMLATTR_ORIENTATION="or";microstrategy.HTMLATTR_ORIENTATIONS_SUPPORTED="ors";microstrategy.HTMLATTR_GRIDCELL_AXIS="ax";microstrategy.HTMLATTR_GRIDCELL_DEPTH="dpt";microstrategy.HTMLATTR_GRIDCELL_ID="i";microstrategy.HTMLATTR_GRIDCELL_ORDINAL="o";microstrategy.HTMLATTR_GRIDROW_ORDINAL="o";microstrategy.HTMLATTR_GRIDROW_MAX_DEPTH="mx";microstrategy.HTMLATTR_GRIDROW_LEVEL="level";microstrategy.HTMLATTR_GRIDCELL_ATTR_COL_TITLE_MISSING="ctm";microstrategy.HTMLATTR_CMD_ID="cmdid";microstrategy.HTMLATTR_CMD_TYPE="cmdtp";microstrategy.HTMLATTR_CMD_VALUE="cmdvl";microstrategy.HTMLATTR_CMD_FORMAT_TYPE="cmdft";microstrategy.HTMLATTR_CMD_PICKER="cmdpk";microstrategy.HTMLATTR_CMD_PROP="cmdprop";microstrategy.HTMLATTR_CMD_LEVEL="cmdlvl";microstrategy.HTMLATTR_DYN_TITLE="dynTT";microstrategy.HTMLATTR_COLOR="color";microstrategy.HTMLATTR_FILTER_VALUE="ftv";microstrategy.HTMLATTR_FILTER_TYPE="ftt";microstrategy.HTMLATTR_FILTER_COMPARISON="ftc";microstrategy.HTMLATTR_FILTER_COMPARISON_DEFAULT="0";microstrategy.HTMLATTR_FILTER_COMPARISON_BINARY="1";microstrategy.HTMLATTR_DSS_ID="oid";microstrategy.HTMLATTR_DSS_FORMULA="frma";microstrategy.HTMLATTR_DSS_TYPE="oty";microstrategy.HTMLATTR_DERIVED_METRIC="dr";microstrategy.HTMLATTR_PASS_THROUGH_METRIC="pthr";microstrategy.HTMLATTR_HAS_DERIVED_ELEMENTS="hde";microstrategy.HTMLATTR_DSS_SUBTYPE="ost";microstrategy.HTMLATTR_DSS_SET="ods";microstrategy.HTMLATTR_DSS_DESCRIPTION="otd";microstrategy.HTMLATTR_POINTS_TO="pt";microstrategy.HTMLATTR_TARGET="tg";microstrategy.HTMLATTR_DND_SOURCE="dg";microstrategy.HTMLATTR_DO_COND_FORMAT="cf";microstrategy.HTMLATTR_HEIGHT_MODE="hm";microstrategy.HTMLATTR_HEIGHT="ht";microstrategy.HTMLATTR_WIDTH_MODE="wm";microstrategy.HTMLATTR_WIDTH="wd";microstrategy.HTMLATTR_VISIBLE="visible";microstrategy.HTMLATTR_OLD_HEIGHT="oldht";microstrategy.HTMLATTR_OLD_WIDTH="oldwd";microstrategy.HTMLATTR_OLD_TOP="oldtop";microstrategy.HTMLATTR_OLD_LEFT="oldleft";microstrategy.HTMLATTR_HAS_CONDITIONAL_FORMATTING="hcf";microstrategy.HTMLATTR_VISIBLE_HTML_VIEW_MODE="shvm";microstrategy.HTMLATTR_CAN_GROW="cg";microstrategy.HTMLATTR_CAN_SHRINK="cs";microstrategy.HTMLATTR_MAX_HEIGHT="mh";microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL="cgh";microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL="csh";microstrategy.HTMLATTR_MAX_WIDTH="mw";microstrategy.HTMLATTR_IS_HORIZONTAL="hz";microstrategy.HTMLATTR_IS_BEGIN_HORIZONTAL="bhz";microstrategy.HTMLATTR_IS_END_HORIZONTAL="ehz";microstrategy.HTMLATTR_HIDE_IF_EMPTY="he";microstrategy.HTMLATTR_REPEAT_SECTION="rpts";microstrategy.HTMLATTR_FIT_EXCEL_ROW_HEIGHT="ferh";microstrategy.HTMLATTR_KEEP_SECTION_TOGETHER="kst";microstrategy.HTMLATTR_REPEAT_HORIZONTALLY="rpth";microstrategy.HTMLATTR_FORCE_NEW_PAGE="fnp";microstrategy.HTMLATTR_AUTO_RESIZE_IN_DESIGNMODE="ard";microstrategy.HTMLATTR_HTML_TYPE="htype";microstrategy.HTMLATTR_HTML_SOURCE="hsrc";microstrategy.HTMLATTR_HTML_TEXT="htxt";microstrategy.HTMLATTR_IS_LINK="isl";microstrategy.HTMLATTR_ROUNDED_CORNERS="rc";microstrategy.HTMLATTR_DROP_SHADOW="dsw";microstrategy.HTMLATTR_DROP_SHADOW_EFFECT="dse";microstrategy.HTMLATTR_RADIUS="rd";microstrategy.HTMLATTR_TOP_CORNERS_ONLY="tco";microstrategy.HTMLATTR_BOTTOMLEFT_CORNER_RADIUS="blcr";microstrategy.HTMLATTR_TOPLEFT_CORNER_RADIUS="tlcr";microstrategy.HTMLATTR_ALPHA="alpo";microstrategy.HTMLATTR_ALPHA_EFFECT="alpe";microstrategy.HTMLATTR_LOCK_ASPECT_RATIO="lar";microstrategy.HTMLATTR_NEW_WINDOW="nw";microstrategy.HTMLATTR_IMAGE_SOURCE="imgsrc";microstrategy.HTMLATTR_LINK_HREF="href";microstrategy.HTMLATTR_LINK_HREFVALUE="hv";microstrategy.HTMLATTR_APPLIES_TO="at";microstrategy.HTMLATTR_GRID_AREA_PCT="gap";microstrategy.HTMLATTR_DISPLAY_MODE="dm";microstrategy.HTMLATTR_GRID_POS="gpos";microstrategy.HTMLATTR_RESIZE="rsz";microstrategy.HTMLATTR_PRIMEDATAID="pDataId";microstrategy.HTMLATTR_DETAILS_SECTION="dt";microstrategy.HTMLATTR_NUMBER_FORMAT_DECIMAL_PLACES="ndp";microstrategy.HTMLATTR_NUMBER_FORMAT_CATEGORY="nct";microstrategy.HTMLATTR_NUMBER_FORMAT_NEGATIVE_NUMBERS="nnn";microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_SYMBOL="ncs";microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_POSITION="ncp";microstrategy.HTMLATTR_NUMBER_FORMAT_THOUSAND_SEPARATOR="nth";microstrategy.HTMLATTR_NUMBER_FORMAT_STRING="nfs";microstrategy.HTMLATTR_FORM_POS="FRMPOS";microstrategy.HTMLATTR_FORM_ID="FRMID";microstrategy.HTMLATTR_FORM_NAME="FRMNAME";microstrategy.HTMLATTR_FORM_LIST="FRMLIST";microstrategy.HTMLATTR_SECTION_ID="sct";microstrategy.HTMLATTR_DTOP="dtp";microstrategy.HTMLATTR_DWIDTH="dwh";microstrategy.HTMLATTR_DHEIGHT="dht";microstrategy.HTMLATTR_DLEFT="dlf";microstrategy.HTMLATTR_ATTRIBUTE_ID="atid";microstrategy.HTMLATTR_PARENT_ID="pid";microstrategy.HTMLATTR_DESCRIPTION="ds";microstrategy.HTMLATTR_NAME="nm";microstrategy.HTMLATTR_ACL="acl";microstrategy.HTMLATTR_BORDER="br";microstrategy.HTMLATTR_PAGE_BREAK="pbs";microstrategy.HTMLATTR_SHOW_REPEAT_SECTION="rps";microstrategy.HTMLATTR_IS_LOCKED="ilk";microstrategy.HTMLATTR_TOOLTIP_FORMULA="tt";microstrategy.HTMLATTR_SHOW_WINDOW_TITLE="swt";microstrategy.HTMLATTR_WIDGET_SHOW_WINDOW_TITLE="swwt";microstrategy.HTMLATTR_WINDOW_STATE="ws";microstrategy.HTMLATTR_WINDOW_LAST_STATE="wls";microstrategy.HTMLATTR_WINDOW_TITLE="wt";microstrategy.HTMLATTR_TITLE_BAR_DISPLAY="tbd";microstrategy.HTMLATTR_SECTION_NAME="sn";microstrategy.HTMLATTR_QUICK_SWITCH="qs";microstrategy.HTMLATTR_USE_AS_INFORMATION_WINDOW="uaiw";microstrategy.HTMLATTR_RESET_TO_FIRST_PANEL_WHEN_TARGETED="rtfp";microstrategy.HTMLATTR_HORIZONTAL_SWIPE_CHANGE="ehstc";microstrategy.HTMLATTR_STYLE_FOR_SWIPE_PANEL="sfwp";microstrategy.HTMLATTR_USE_AS_FILTER_PANEL="uafp";microstrategy.HTMLATTR_USE_AS_MASTER_PANEL="uamp";microstrategy.HTMLATTR_CTL_AUTO_SUBMIT="cas";microstrategy.HTMLATTR_CTL_SEARCH_ON_SERVER="sos";microstrategy.HTMLATTR_CTL_NO_SELECTION_BEHAVIOR="nsb";microstrategy.HTMLATTR_CTL_MAX_SELECTION_COUNT="masc";microstrategy.HTMLATTR_CTL_MIN_SELECTION_COUNT="misc";microstrategy.HTMLATTR_CTL_SHOW_ELEMENT_COUNT="sec";microstrategy.HTMLATTR_LINK_TO="lnk";microstrategy.HTMLATTR_INFO_WIN_PLACEMENT="iwpl";microstrategy.HTMLATTR_EXPORT_OPTION="seo";microstrategy.HTMLATTR_SET_BADGE_TO_VALUE_ON_FIELD="sbtvof";microstrategy.HTMLATTR_INFO_WIN_MODE="iwm";microstrategy.HTMLATTR_INFO_WIN_POSITION="iwp";microstrategy.HTMLATTR_TAB_CLOSE_TO_DISMISS_INFOWIN="tctdiw";microstrategy.HTMLATTR_IOS_COPY_MODE="mcm";microstrategy.HTMLATTR_RA_LEVEL="lvl";microstrategy.HTMLATTR_RA_EXPAND="expd";microstrategy.HTMLATTR_RA_COLLAPSE_TIME="ct";microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL="uatc";microstrategy.HTMLATTR_TABLE_CONTROL_DEFINITION="tcd";microstrategy.FORMAT_TYPE_TABLE_BASE=2;microstrategy.FORMAT_TYPE_TABLE_GROUP=microstrategy.FORMAT_TYPE_TABLE_BASE;microstrategy.FORMAT_TYPE_TABLE_CELL=microstrategy.FORMAT_TYPE_TABLE_BASE+1;microstrategy.BUTTON_CTL="106B";microstrategy.HTMLATTR_DISPLAY_STYLE="dpst";microstrategy.HTMLATTR_NORMAL_URL="nmurl";microstrategy.HTMLATTR_HIGHLIGHT_URL="hlurl";microstrategy.HTMLATTR_FONT_HIGHLIGHT_COLOR="fhlc";microstrategy.HTMLATTR_BACKGROUND_HIGHLIGHT_COLOR="bhlc";microstrategy.HTMLATTR_FILL_EFFECT="fe";microstrategy.BUTTON_STYLE_NOT_BUTTON=0;microstrategy.BUTTON_STYLE_CAPTION_ONLY=1;microstrategy.BUTTON_STYLE_ICON_ONLY=2;microstrategy.BUTTON_STYLE_ICON_LEFT=3;microstrategy.BUTTON_STYLE_ICON_RIGHT=4;microstrategy.BUTTON_STYLE_ICON_TOP=5;microstrategy.BUTTON_STYLE_CUSTOM=6;microstrategy.HTMLATTR_EFFECT_FLAT=0;microstrategy.HTMLATTR_EFFECT_GLOSSY=1;microstrategy.BUTTON_STYLE_CSS_SUFFIXES=[,"captionOnly","iconOnly","iconLeft","iconRight","iconTop","custom"];microstrategy.PROPERTIES_EDITOR_BUTTON_TAB=8;microstrategy.HTMLATTR_USE_AS_NAVIGATION_BAR="uanb";microstrategy.CONTROLSUBTYPE_NAVIGATION_BAR="NB";microstrategy.HTMLATTR_BORDER_3D_STYLE="b3dstyle";microstrategy.HTMLATTR_BORDER_3D_WEIGHT="b3dweight";microstrategy.HTMLATTR_BORDER_3D_TOP_COLOR="b3dtc";microstrategy.HTMLATTR_BORDER_3D_LEFT_COLOR="b3dlc";microstrategy.HTMLATTR_BORDER_3D_RIGHT_COLOR="b3drc";microstrategy.HTMLATTR_BORDER_3D_LEFT_COLOR="b3dlc";microstrategy.HTMLATTR_BORDER_TOP_COLOR="btc";microstrategy.HTMLATTR_BORDER_LEFT_COLOR="blc";microstrategy.HTMLATTR_BORDER_RIGHT_COLOR="brc";microstrategy.HTMLATTR_BORDER_BOTTOM_COLOR="bbc";microstrategy.HTMLATTR_BORDER_TOP_STYLE="bts";microstrategy.HTMLATTR_BORDER_LEFT_STYLE="bls";microstrategy.HTMLATTR_BORDER_RIGHT_STYLE="brs";microstrategy.HTMLATTR_BORDER_BOTTOM_STYLE="bbs";microstrategy.HTMLATTR_LINE_COLOR="lc";microstrategy.HTMLATTR_LINE_STYLE="ls";microstrategy.HTMLATTR_LINE_WEIGHT="lw";microstrategy.HTMLATTR_GRID_CELL_TYPE="cty";microstrategy.HTMLATTR_GRID_UNIT_POS="UPT";microstrategy.HTMLATTR_IS_DATASET_JOIN_PRIMARY="ijp";microstrategy.HTMLATTR_GRID_OVERFLOW="ovf";microstrategy.HTMLATTR_TEXT_OVERFLOW="tovf";microstrategy.HTMLATTR_GRID_EXPORT_OVERFLOW="xovf";microstrategy.HTMLATTR_GRAPH_EXPORT_OVERFLOW="xgovf";microstrategy.HTMLATTR_PS_TRANSPARENCY="trpr";microstrategy.HTMLATTR_PS_BLUR="blur";microstrategy.HTMLATTR_WIDGET_CLASS="twc";microstrategy.HTMLATTR_WIDGET_RSL_PATH="rsl";microstrategy.HTMLATTR_WIDGET_IS_APP="iap";microstrategy.HTMLATTR_NON_FLASH_RENDER="nfr";microstrategy.HTMLATTR_PDF_RENDER="pr";microstrategy.HTMLATTR_EXCEL_RENDER="er";microstrategy.HTMLATTR_DHTML_RENDER="dr";microstrategy.HTMLATTR_SEC_DATA_PROVIDERS="sdp";microstrategy.HTMLATTR_TRANSITION="ttr";microstrategy.HTMLATTR_TRANS_DURATION="tdr";microstrategy.HTMLATTR_LOCKED="lck";microstrategy.HTMLATTR_IS_VIS_GRID_BONE="ivgb";microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR="ssc";microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE="sstyle";microstrategy.HTMLATTR_IPHONE_VIS="iphv";microstrategy.HTMLATTR_IPAD_VIS="ipadv";microstrategy.HTMLATTR_WIDGET_PROPS="wp";microstrategy.HTMLATTR_ANDROID_VIS="aphv";microstrategy.HTMLATTR_ANDROID_TABLET_VIS="atv";microstrategy.HTMLATTR_SHOW_IN_RPT_COPY="sirc";microstrategy.GRIDCELLTYPE_UNIT_HEADER="1";microstrategy.GRIDCELLTYPE_UNIT_VALUE="2";microstrategy.GRIDCELLTYPE_SUBTOTAL_HEADER="3";microstrategy.GRIDCELLTYPE_SUBTOTAL_VALUE="4";microstrategy.GRIDCELLTYPE_LEVEL_ALL="5";microstrategy.GRIDCELLTYPE_LEVEL_NONE="0";microstrategy.GRIDCELLTYPE_LEVEL_MULTIPLE="-1";microstrategy.GRID_TARGET_NONE="0";microstrategy.GRID_TARGET_MULTIPLE="-1";microstrategy.FORMAT_LEVEL_FLAG_VIEWER=0;microstrategy.FORMAT_LEVEL_FLAG_DOC=1;microstrategy.FORMAT_LEVEL_FLAG_DOC_SELECTIONS=2;microstrategy.GRIDCELLTYPE_METRIC_DATA="data";microstrategy.TRUE="-1";microstrategy.FALSE="0";microstrategy.ACL_EXECUTE=128;microstrategy.ACL_USE=64;microstrategy.COPY_ITEM_SEPERATOR=";";microstrategy.OBJ_PREFIX="W";microstrategy.VISIBLE_ELEMS_NAME="visElem";microstrategy.VISIBLE_ELEMS_RULERS=1;microstrategy.VISIBLE_ELEMS_GRID=2;microstrategy.VISIBLE_ELEMS_DIVIDER=4;microstrategy.OK_BUTTON=1;microstrategy.CANCEL_BUTTON=2;microstrategy.APPLY_BUTTON=4;microstrategy.DESIGN_MODE=1;microstrategy.VIEW_MODE=2;microstrategy.RW_VIEW_MODE_STATIC=1;microstrategy.RW_VIEW_MODE_INTERACTIVE=2;microstrategy.RW_VIEW_MODE_EDITABLE=4;microstrategy.RW_VIEW_MODE_FLASH=8;microstrategy.RW_VIEW_MODE_VIEWANALYSIS=2048;microstrategy.IN_OUTLINE_MODE=false;microstrategy.IS_RELOAD=false;microstrategy.ALLOW_EDIT_MODE=1;microstrategy.NOT_ALLOW_EDIT_MODE=2;microstrategy.HTML_CONTAINER_TYPE_IFRAME="0";microstrategy.HTML_CONTAINER_TYPE_HTML="1";microstrategy.WINDOW_TITLE_HEIGHT="20";microstrategy.WINDOW_STATE_NORMAL="0";microstrategy.WINDOW_STATE_MINIMIZED="1";microstrategy.WINDOW_STATE_MAXIMIXED="2";microstrategy.MARQUEE_STYLE=microstrategy.MARQUEE_STYLE_PARTIAL;microstrategy.MARQUEE_STYLE_PARTIAL=0;microstrategy.MARQUEE_STYLE_FULL=1;microstrategy.DPI_CONVERSION=96;microstrategy.BASE_DPI=96;microstrategy.ZOOM_FACTOR=100;microstrategy.ZOOM_STATIC="0";microstrategy.ZOOM_FIT_WIDTH="1";microstrategy.ZOOM_FIT_PAGE="2";microstrategy.GRID_IMAGE="grid96MediumInch.gif";microstrategy.SNAP_SIZE=12;microstrategy.CURSOR_OFFSET=5;microstrategy.DND_HILITE_WIDTH=3;microstrategy.SNAP_OFF=false;microstrategy.SNAP_DIRET_POS=1;microstrategy.SNAP_DIRET_NEG=-1;microstrategy.DISPLAY_MODE_GRID=1;microstrategy.DISPLAY_MODE_GRAPH=2;microstrategy.DISPLAY_MODE_GRID_AND_GRAPH=3;microstrategy.FIRST_VISUALIZATION_VIEW_MODE=50;microstrategy.RWD_EXECUTION_MODE_DATA=1;microstrategy.RWD_EASE_CREATION_ANALYSIS=16;microstrategy.RWD_EASE_CREATION_HTML5_DASHBOARD_WITH_TEMPLATE=32;microstrategy.APP_BEAN_VIEW_EXECUTION=0;microstrategy.REPORT_EXECUTION=1;microstrategy.RWD_EXECUTION=2;microstrategy.FORM_LIST_NAME=0;microstrategy.FORM_LIST_ID=1;microstrategy.FORM_LIST_STATUS=2;microstrategy.FORM_ON_VIEW=1;microstrategy.FORM_ON_WS=2;microstrategy.FORM_NOT_ON_WS=3;microstrategy.DESIGNMODE_NOBORDER_STYLE="#999999 1px dashed";microstrategy.HAS_BORDER=1;microstrategy.NO_BORDER=0;microstrategy.RESIZE_VERTICAL=1;microstrategy.RESIZE_HORIZONTAL=2;microstrategy.WIDTH_UPDATE=1;microstrategy.HEIGHT_UPDATE=2;microstrategy.WIDTH_AND_HEIGHT_UPDATE=3;microstrategy.FIX_MODE=0;microstrategy.HUNDRED_PERCENT_MODE=1;microstrategy.AUTO_MODE=2;microstrategy.IS_RWD_DIRTY=microstrategy.FALSE;microstrategy.IS_OFFICE_EXPORT=microstrategy.FALSE;microstrategy.OPEN_EDITOR_ACTION_ADD=1;microstrategy.OPEN_EDITOR_ACTION_EDIT=0;microstrategy.PAGE_FULL_SCREEN_MODE=2;microstrategy.PAGE_NORMAL_SCREEN_MODE=1;microstrategy.FORMATTING_PROP_THRESHOLD="t";microstrategy.FORMATTING_PROP_TOC_FONT="df";microstrategy.FORMATTING_PROP_DERIVED_ELEMENT="de";microstrategy.TAB_SWITCH_MODE="switchMode";microstrategy.TAB_SWITCH_MODE_CACHED=0;microstrategy.TAB_SWITCH_MODE_FETCH=1;microstrategy.bones={};microstrategy.zones=new Array;microstrategy.observerItems=null;microstrategy.updateManager=null;microstrategy.number=null;microstrategy.descriptors=null;microstrategy.styleObj=null;microstrategy.controlVariables={};microstrategy.formatObj=null;microstrategy.mstrwid="";microstrategy.bonesToRegister=[];microstrategy.zoomType=microstrategy.ZOOM_TYPE_STATIC;microstrategy.viewerBoneId="";microstrategy.displayLocaleID=null;microstrategy.prototype.DISPLAY_MODE=microstrategy.DESIGN_MODE;microstrategy.prototype.EDIT_MODE=microstrategy.ALLOW_EDIT_MODE;microstrategy.prototype.activeCXMenu=null;microstrategy.prototype.activeCXBone=null;microstrategy.prototype.RMCTarget=null;microstrategy.prototype.isCXMenuOpen=false;microstrategy.prototype.isJLSCXMenuOpen=false;microstrategy.primeDataSetId=null;microstrategy.sortDefinedOnDefault=false;microstrategy.waitPageDelay="0";microstrategy.showWaitPopup=true;microstrategy.needToIgnorePop;microstrategy.IGNORE_RESIZE=1;microstrategy.RESIZE_TO_FIRST_SUBSECTION=2;microstrategy.RESIZE_EACH_SUBSECTION=3;microstrategy.REPORT_FMT_TOOLBAR="";microstrategy.FORMAT_TYPE_MAIN="1";microstrategy.FORMAT_TYPE_TITLE="2";microstrategy.FORMAT_TYPE_CONTROL_TITLE="5";microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;microstrategy.RESTORE_LEFT=0;microstrategy.RESTORE_TOP=1;microstrategy.RESTORE_BOTH=2;microstrategy.ACCORDION_REPORT_RP_OBJECT_PANEL="workingSet";microstrategy.ACCORDION_REPORT_ALL_OBJECT_PANEL="objectBrowser";microstrategy.ACCORDION_REPORT_RELATED_RP_PANEL="relatedReports";microstrategy.ACCORDION_REPORT_NOTES_PANEL="notes";microstrategy.ACCORDION_RW_DATASET_PANEL="workingSet";microstrategy.ACCORDION_RW_RELATED_RP_PANEL="relatedReports";microstrategy.ACCORDION_RW_NOTES_PANEL="notes";microstrategy.ACCORDION_RW_OUTLINE_PANEL="outlineView";microstrategy.DHTML_RENDERER_SAME_AS_WIDGET="1";microstrategy.DHTML_RENDERER_SAME_AS_PDF_AND_EXCEL="0";microstrategy.GRID_UNIT_CONTAINER=0;microstrategy.GRID_BORDERS=1;microstrategy.GRID_OTHER=2;microstrategy.HTML_ELEMENT_NODE_TYPE=1;microstrategy.HTML_TEXT_NODE_TYPE=3;microstrategy.gridFormatCache={};microstrategy.graphPropertyCache={};microstrategy.WEB_API_ERROR_CODES={MSI_SERVER_NAME_NOT_INITIALIZED:2147760371,MSI_INVALID_SESSION_ID:2147760372,E_MSI_USERMGR_USER_NOTFOUND:2147758245,E_MSI_CONNECT_FAILED:2147759877};document.onmousedown=new Function("e","return microstrategy.onMouseDownHandler(e)");microstrategy.EXEC_MODE_EXCEL="4";microstrategy.EXEC_MODE_PDF="3";microstrategy.EXEC_MODE_FLASH="7";microstrategy.FILTER_BOX_NAME="drillFilterElementList";microstrategy.DRILL_BOX_NAME="deDrillElementList";microstrategy.VIS_EDITOR_SCOPE_REPORT=1;microstrategy.VIS_EDITOR_SCOPE_RW_GRID=2;microstrategy.VIS_EDITOR_SCOPE_RW=4;microstrategy.VIS_EDITOR_SCOPE_RW_LAYOUT=8;microstrategy.ENCODED_AMPERSAND="%26",microstrategy.ENCODED_EQUALS="%3D",microstrategy.SAVE_AS_SHARE_EDITOR=11;microstrategy.APPLIED_THEME_NONE="0";microstrategy.APPLIED_THEME_DEFAULT="1";microstrategy.APPLIED_THEME_CUSTOM="2";microstrategy.THEME_DARK_ID="F1FED8AC42B57AC1B0E9518FED0F89D6";microstrategy.THEME_LIGHT_ID="21E8ECEA4EACEA161B5828BD79A4B1E2";microstrategy.EXTENDED_TYPE_DATA_IMPORT=256;microstrategy.onMouseDownHandler=function(e){try{if(microstrategy.eventManager){microstrategy.eventManager.notifyOrphanBones("ondocumentclick",e);}microstrategy.hidePopups();return true;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.hidePopups=function(force,e){if(typeof (hidePopupMenus)!="undefined"){hidePopupMenus(force);}if(typeof (hideIncFetchGoToDialog)!="undefined"){hideIncFetchGoToDialog();}if(e){mstr.controllers.EventManager.notifyWindowListeners({name:"closeContextMenu",e:e});}};microstrategy.doLayout=function(forceUpdate){var top=microstrategy.headerHeight,bottom=microstrategy.footerHeight,contentNode=microstrategy.contentNode;if(contentNode){microstrategy.updateContentNodeHeight();contentNode.style.marginTop=top+"px";if(mstr.utils.ISWK||mstr.utils.ISIE8){contentNode.style.paddingBottom=bottom+"px";}else{contentNode.style.marginBottom=bottom+"px";}}document.body.style.height="auto";var headerWidth=(function(){var sn=microstrategy.headerNode,r=sn?sn.scrollWidth:0;if(r>300000){r=0;}return r;}()),browserWidth=mstr.utils.BoxModel.getBrowserWindowWidth(document);document.body.style.minWidth=(headerWidth>=browserWidth)?headerWidth+"px":"";};microstrategy.syncLayout=function(resizing){try{if(!microstrategy.headerNode){return ;}var headerNode=microstrategy.headerNode,headerWidth=headerNode.scrollWidth,browserWidth=mstr.utils.BoxModel.getBrowserWindowWidth(document),browserScrollLeft=document.documentElement.scrollLeft||document.body.scrollLeft||0,left=parseInt(headerNode.style.left)||0;if(resizing!==true){if(browserWidth<headerWidth-left){headerNode.style.left=-Math.min(headerWidth-browserWidth,browserScrollLeft)+"px";}}else{if(resizing===true){var pos=mstr.utils.BoxModel.position(headerNode),visibleWidth=pos.left+pos.width,rightDiff=browserWidth-visibleWidth;if(rightDiff>=0){headerNode.style.left=(left+rightDiff)+"px";}}}}catch(err){microstrategy.errors.log(err);}};microstrategy.initLayoutProps=function(h){try{var contentNode=document.getElementById("mstrWebContents"),toolbarWrapperNode=microstrategy.findChildWithCssClass(document.body,"table","mstrToolbarWrapper"),pos=toolbarWrapperNode?mstr.utils.BoxModel.position(toolbarWrapperNode):{top:0,height:0},top=pos.top+pos.height,footerNode=document.getElementById("mstrWeb_footer"),bottom=footerNode?footerNode.offsetHeight:0;if(mstr.utils.ISIE7&&footerNode&&footerNode.children.length==0){footerNode.style.display="none";bottom=0;}microstrategy.contentNode=contentNode;microstrategy.headerNode=toolbarWrapperNode;microstrategy.footerNode=footerNode;microstrategy.headerHeight=top;microstrategy.footerHeight=bottom;microstrategy.contentHeight=Math.max(0,getClientHeight()-top-bottom);var el=mstr.utils.ISW3C?window:document.body;el.onscroll=mstr.utils.Objects.compositeFunc(el.onscroll,microstrategy.syncLayout);el.onmouseup=mstr.utils.Objects.compositeFunc(el.onmouseup,microstrategy.syncLayout);}catch(err){microstrategy.errors.log(err);}};microstrategy.updateContentNodeHeight=function(h){var contentNode=microstrategy.contentNode;if(contentNode){if(!mstr.utils.ISIE7&&!mstr.utils.ISIE8){contentNode.style.minHeight=microstrategy.getContentHeight()+"px";}}};microstrategy.updateLayoutProps=function(){microstrategy.headerHeight=microstrategy.headerNode&&microstrategy.headerNode.offsetHeight||0;microstrategy.footerHeight=microstrategy.footerNode&&microstrategy.footerNode.offsetHeight||0;microstrategy.contentHeight=microstrategy.getContentHeight();microstrategy.updateContentNodeHeight();};microstrategy.redoLayout=function(){microstrategy.updateLayoutProps();microstrategy.doLayout();microstrategy.syncLayout(true);};microstrategy.getContentHeight=function(){return(microstrategy.eventManager&&microstrategy.eventManager.browserHeight||getClientHeight())-microstrategy.headerHeight-microstrategy.footerHeight;};microstrategy.showAccountSCList=function(){microstrategy.showShortcutsList(null,"AC");};microstrategy.showShortcutsList=function(event,menuType){var mi=microstrategy,data=mi.shortcutsData;accData=mi.shortcutsAccData;if(typeof menuType=="undefined"){menuType="ST";}var event=event||window.event;if(mstr.utils.ISIE8){if(event&&event.srcElement.id=="mstrLogoMenu"){stopEventBubbling(event);}}else{if(event&&event.target&&event.target.id=="mstrLogoMenu"){stopEventBubbling(event);}}var loaderId="mstrSCListLoader",showLoader=function(){var elLoader=document.getElementById(loaderId);if(!elLoader){var loaderClass="open";elLoader=document.createElement("div");elLoader.id=loaderId;if(menuType=="AC"){loaderClass+=" mstrAccountSCListPopup";}elLoader.innerHTML='<div class="mstrSCListLoaderIcon"></div>';document.body.appendChild(elLoader);mi[loaderId]=elLoader;var pathNode=document.getElementById("mstrWeb_path");elLoader.style.top=(pathNode.offsetHeight+pathNode.offsetTop)+"px";}elLoader.className=loaderClass;},hideLoader=function(){var elLoader=mi[loaderId];if(elLoader){elLoader.className="";}};showLoader();function showSCList(){var $M=mstrmojo,popup;if(menuType==="AC"){popup=$M.all.mstrAccountSCList;}else{popup=$M.all.mstrSCList;}if(!popup){var itemSCList,listCss,menuId,linkId;if(menuType==="AC"){itemSCList=mi.shortcutsAccData.sl;listCss="mstrShortcutsListPopup mstrAccountSCListPopup";menuId="mstrAccountSCList";linkId="mstrPathAccount";}else{itemSCList=mi.shortcutsData.sl;listCss="mstrShortcutsListPopup";menuId="mstrSCList";linkId="mstrStarburst";}var popup=$M.insert({id:menuId,scriptClass:"mstrmojo.Popup",autoCloses:true,locksHover:true,markupMethods:{onvisibleChange:function(){if(this.isOpen){mstrmojo.css.toggleClass(this.domNode,"open",this.visible);}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},onOpen:function onOpen(){var $this=this,dn=$this.domNode,pathNode=document.getElementById("mstrWeb_path"),pos=mstr.utils.BoxModel.position(pathNode),offset=pos.top+pos.height;dn.style.top=offset+"px";$this.set("visible",false);$this.isOpen=true;window.setTimeout(function(){$this.set("visible",true);},100);$this.oldCssClassName=document.getElementById(linkId).className;document.getElementById(linkId).className="opened";microstrategy.toggleCurtain(true);},onClose:function onClose(){var $this=this;window.setTimeout(function(){delete $this.isOpen;},500);document.getElementById(linkId).className=$this.oldCssClassName;microstrategy.toggleCurtain();},cssClass:listCss,children:[{scriptClass:"mstrmojo.ListBase",onclick:function(evt){var target=evt.getTarget(),idx=target.getAttribute("idx")||target.parentNode.getAttribute("idx"),item=this.items[idx];if(item&&item.name=="recentObjects"){microstrategy.openRecentObjects(target.nodeName=="DIV"?target:target.parentNode,16,true);}else{mstrmojo.form.sendLink(item.href,item.target);this.parent.close();}},onmouseover:function(evt){var target=evt.getTarget(),idx=target.getAttribute("idx")||target.parentNode.getAttribute("idx"),item=this.items[idx];if(item&&item.name=="recentObjects"){microstrategy.openRecentObjects(target.nodeName=="DIV"?target:target.parentNode,16,true);}else{if($M.all.mstrRecentsGenPopup){$M.all.mstrRecentsGenPopup.close();}}},items:itemSCList,getItemMarkup:function(item){return'<div class="item {@name} {@cls} {@newGroup}" idx="{@idx}"><span class="icon"></span><span>{@n}</span></div>';},getItemProps:function getItemProps(item,idx){var isSelected=!!item.selected,appendState=function(item){var excludeState={"public":true,profile:true}[item.name];return item.appendState&&!excludeState;};return{sel:isSelected,cls:(isSelected)?"selected":"",newGroup:!!item.grp?"grp":"",n:item.n,idx:idx,href:item.href,name:item.name,clsName:item.className||"",onclick:item.onclick||(appendState(item)&&"return submitLink(this, event);")||"return true;",target:item.target||"_self"};},itemRenderer:{render:function(item,idx,widget){item._renderIdx=idx;return mstrmojo.string.apply(widget.getItemMarkup(item),widget.getItemProps(item,idx));},select:function(el,item,idx,widget){delegateSelect("select",el,item,idx,widget);},unselect:function(el,item,idx,widget){delegateSelect("unselect",el,item,idx,widget);}}}]});popup.render();}if(!popup.isOpen){popup.open();}else{if(!microstrategy.menuHover){popup.close();}}hideLoader();}if(!data||!accData){var linkId,listName,requestObject={taskId:"getShortcutsList",pageName:mi.pageName};if(menuType==="AC"){linkId="mstrPathAccount";requestObject.listName="account";}else{linkId="mstrStarburst";}mstr.$XHR.request(mstrConfig.taskURL,requestObject,{success:function(res){if(menuType==="AC"){mi.shortcutsAccData=res;}else{mi.shortcutsData=res;}if(res&&res.sl.length>0){if(typeof mstrmojo=="undefined"){mi.jsLoader.get("mojo-starburst.js",true,showSCList,false);}else{showSCList();}}else{window.location.href=document.getElementById(linkId).getAttribute("_href");}}});}else{showSCList();}return false;};microstrategy.openRecentObjects=function(anchor,open){var $M=mstrmojo,popup=$M.all.mstrRecentsGenPopup;var recentObjectsHelper=$M.mstr._RecentObjectsHelper;if(!recentObjectsHelper){recentObjectsHelper=$M.insert("mstrmojo.mstr._RecentObjectsHelper");}var menuItems=recentObjectsHelper.handleRecentObjects();if(!popup){popup=$M.insert({id:"mstrRecentsGenPopup",scriptClass:"mstrmojo.ui.pathbar.PathPopup",cssClass:"mstrShortcutsListPopup",children:[{scriptClass:"mstrmojo.ui.List",alias:"menuItems",preclick:function preclick(){this.parent.close();},items:menuItems,getItemMarkup:function(item){var imgMarkup="";if(mstrConfig.showPreviews){if(item.recoveryInfo!==undefined){var imgSrc=(item.recoveryInfo.imgData!==undefined)?"data:image/png;base64,"+item.recoveryInfo.imgData:"";if(imgSrc!==""){imgMarkup='<img class="img-preview" src="'+imgSrc+'" height="200" width="250" style="z-index: 100; position: absolute;">';}}}return'<span class="item mstrMenuItem {@itemCls}" style="{@cssText}"><span class="{@iconCls}"></span><a class="mstrLink" href="{@href}">{@n}'+imgMarkup+"</a></span>";},getItemProps:function getItemProps(item,idx){var isSelected=!!item.selected;return{sel:isSelected,iconCls:item.iconClass,itemCls:item.itemClass,cssText:item.cssText||"",cls:isSelected?"selected":"",newGroup:!!item.grp?"grp":"",n:item.recoveryName,idx:idx,href:item.recoveryURL,name:item.recoveryName,target:item.target||"_self"};},onclick:function(evt){cancelEvent(evt);stopEventBubbling(evt);var oAnchor=evt.getTarget();if(oAnchor.getAttribute("href")){submitLinkAsForm(oAnchor);}else{submitLinkAsForm(oAnchor.parentElement);}return false;}}]});}var rect=anchor.getBoundingClientRect();popup.targetNode=anchor;popup.offsetLeft=rect.right-rect.left;popup.offsetTop=rect.top-rect.bottom;if(open===undefined){open=!popup.isOpen;}if(!popup.isOpen&&open){popup.open();}else{if(!microstrategy.menuHover&&!open){popup.close();}}};microstrategy.getCubesInfo=function(cubeIds,callback){mstr.$XHR.request(mstrConfig.taskURL,{taskId:"getUserDICubeInfo",cubeIds:cubeIds.join(",")},{success:function(cubesInfo){callback(cubesInfo);}});};microstrategy.isCubeSupportDDA=function(cubeInfo){return !!(cubeInfo&&(cubeInfo.dda===1||cubeInfo.dda===3));};microstrategy.createIVE=function(html5vi){var isHTML5=!microstrategy.isFeatureAvailable("flashvi")&&html5vi;if(isHTML5&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return ;}microstrategy.showWait();var folder=this,$M=window.mstrmojo,id="mstrIVE",openIVE=function(c){$M=mstrmojo;var cfg={scriptClass:"mstrmojo.IVEDatasetPicker",id:id,cssClass:"mstrmojo-ive-dataset-picker",startingFolder:folder.folderId,onRender:function onRender(){var visible=microstrategy.isFeatureAvailable("web-import-data");this.btnImport.set("visible",visible);this.newLabel.set("visible",visible);},onClose:function(config){if(!config||!(config.item||config.action)){return ;}var updateManager=microstrategy.updateManager,actionCollection=[],editor=this,item=config.item,evt=item?((isHTML5&&bIsW3C&&!bIsIE8)?mstrUpdateManager.CREATE_HTML5_VI:mstrUpdateManager.CONVERT_TO_DOCUMENT):(config.action?mstrUpdateManager.OPEN_IMPORT_ENTRY:null);function shouldDDA(cubeId,callback){microstrategy.getCubesInfo([cubeId],function(cubesInfo){var cubeInfo=cubesInfo[cubeId];callback(cubeInfo&&!cubeInfo.published&&microstrategy.isCubeSupportDDA(cubeInfo));});}function createDashboard(cube,evt){shouldDDA(cube.did,function(dda){var extraCreateFlag=dda?128:0,param_ids=mstrUpdateManager.actions[evt].paramID,param_values;if(isHTML5&&bIsW3C&&!bIsIE8){param_values=[cube.did,1,3,64|extraCreateFlag,true];}else{param_values=[cube.did,"",0,1,3,2048,16|extraCreateFlag];}actionCollection.push(updateManager.createActionObject(null,evt,microstrategy.servletName,param_ids,param_values));updateManager.add(actionCollection);updateManager.useIframe=false;updateManager.flushAndSubmitChanges();});}if(!evt){return true;}if(item){createDashboard(item,evt);}else{microstrategy.openDataImport({AnalysisId:"00000000",callback:function(cubes){evt=(isHTML5&&bIsW3C&&!bIsIE8)?mstrUpdateManager.CREATE_HTML5_VI:mstrUpdateManager.CONVERT_TO_DOCUMENT;createDashboard(cubes[0],evt);}});}}};var d=$M.insert(cfg);d.render();d.open();microstrategy.showWait(false);};var editor=$M&&$M.all&&$M.all[id];if(editor){editor.set("startingFolder",this.folderId);editor.open();microstrategy.showWait(false);}else{microstrategy.mojoLoader.loadWidget({scriptClass:"IVEDatasetPicker",bundle:"mojo-ive-picker.js",callback:openIVE});}};microstrategy.toggleCurtain=function toggleCurtain(show){var mstr=microstrategy;if(!mstr.curtainNode){mstr.curtainNode=document.createElement("div");document.body.appendChild(mstr.curtainNode);}var cn=mstr.curtainNode,cns=cn.style;cns.position="absolute";cns.top="0px";cns.left="0px";cns.height="100%";cns.width="100%";cns.zIndex="100";if(bIsIE4){cns.background="#eee";if(bIsDXIE){cns.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=0))";}else{cns.opacity=0;}}cns.display=show?"block":"none";};microstrategy.updateActiveCXProps=function(oTarget,e){microstrategy.activeCXMenu=oTarget;microstrategy.RMCTarget=getEventTarget(e);microstrategy.activeCXBone=null;};microstrategy.setContextMenuStatus=function(isOpen){microstrategy.isCXMenuOpen=isOpen;};microstrategy.setJLSCXMenuOpen=function(isOpen){microstrategy.isJLSCXMenuOpen=isOpen;};microstrategy.isContextMenuOpen=function(){return microstrategy.isCXMenuOpen||microstrategy.isJLSCXMenuOpen;};microstrategy.getActiveCXBone=function(){try{if(!microstrategy.activeCXBone){microstrategy.activeCXBone=microstrategy.findBone(microstrategy.activeCXMenu);}return microstrategy.activeCXBone;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.updateBone=function(propsObj){try{if(microstrategy.bone(propsObj.id)){microstrategy.bone(propsObj.id).absorbObject(propsObj.properties);}else{microstrategy.bonesToRegister.push({id:propsObj.id,loadCondition:propsObj.loadCondition,properties:propsObj.properties});}}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.registerBone=function(id,loadCondition,propsObj){try{var elem=getElementById(id);if(!elem){return null;}microstrategy.controlVariables[id]=false;var scriptClass=elem.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);var conditionStatus=false;try{conditionStatus=checkJSExists(scriptClass)&&eval(loadCondition);}catch(e){conditionStatus=false;}if(conditionStatus){var bone=this.callConstructor([id],scriptClass);if(bone){if(this.bones[bone.id]&&this.bones[bone.id].unloadBone){this.bones[bone.id].onunload();}this.bones[bone.id]=bone;microstrategy.controlVariables[id]=true;if(bone.viewerBone){this.viewerBoneId=id;}if(propsObj){if(typeof (propsObj)=="string"){microstrategy.errors.log("Unexpected properties object type at microstrategy.registerBone.");eval("propsObj = "+propsObj);}for(var p in propsObj){bone[p]=propsObj[p];}}return bone;}}else{window.setTimeout(function registerBoneTimeout(){microstrategy.registerBone(id,loadCondition,propsObj);},250);}}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.unRegisterBone=function(id){try{if(typeof (this.bones[id])!="undefined"){this.bones[id].onunload();delete this.bones[id];}return true;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.callConstructor=function(aArgs,scriptClass){try{if(!scriptClass){elem=getElementById(aArgs[0]);scriptClass=elem&&elem.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);if(!scriptClass){return null;}}var obj=null;if(aArgs){obj=new window[scriptClass](aArgs[0]);if(aArgs.length>1){window[scriptClass].apply(obj,aArgs);}}else{obj=new window[scriptClass]();}return obj;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.bone=function(id){try{return(typeof (this.bones[id])!="undefined")?this.bones[id]:null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.getViewerBone=function(){try{return this.bone(this.viewerBoneId);}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.findBone=function(elem){try{if(elem==null){return null;}var obj=findTarget(elem,microstrategy.HTMLATTR_SCRIPTCLASS);if(obj==null||obj.getAttribute("id")==null){return null;}var bone=this.bone(obj.getAttribute("id"));if(bone){return bone;}else{if(obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_TREE_VIEW){return microstrategy.findBone(obj.parentNode);}}if(elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){if(elem.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var tab=elem.getElementsByTagName("table");for(var j=0;j<tab.length;j++){var tabParent=tab[j].parentNode;if(tabParent&&tabParent.id.toLowerCase().indexOf("divlock")>0){tabParent=tabParent.parentNode;}if(tabParent&&tabParent.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)&&(tabParent.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_GRID_TABLE||tabParent.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE)){var boneGrid=this.bone(tabParent.getAttribute("id"));if(boneGrid&&(!boneGrid.quickSwitch||boneGrid.quickSwitchCurrent)){return boneGrid;}}}var img=elem.getElementsByTagName("img");for(var j=0;j<img.length;j++){if(img[j].parentNode&&img[j].parentNode.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)){var boneGraph=this.bone(img[j].parentNode.getAttribute("id"));if(boneGraph&&(!boneGraph.quickSwitch||boneGraph.quickSwitchCurrent)){return boneGraph;}}}var obj=elem.getElementsByTagName("object");if(obj==null||obj.length==0){obj=elem.getElementsByTagName("embed");}for(var j=0;j<obj.length;j++){if(obj[j].parentNode&&obj[j].parentNode.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)){var boneFlash=this.bone(obj[j].parentNode.getAttribute("id"));if(boneFlash&&boneFlash.getGridContainerSpan){return boneFlash;}}}var div=elem.getElementsByTagName("div");for(var j=0;j<div.length;j++){if(div[j]&&div[j].getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS)){if(div[j].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_GRAPH_TEMPLATE){var boneFailed=this.bone(div[j].getAttribute("id"));if(boneFailed&&(!boneFailed.quickSwitch||boneFailed.quickSwitchCurrent)){return boneFailed;}}else{if(div[j].getAttribute(microstrategy.HTMLATTR_IS_VIS_GRID_BONE)=="1"){var boneVis=this.bone(div[j].getAttribute("id"));if(boneVis){return boneVis;}}}}}}else{if(elem.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){var div=microstrategy.findChildWithAtt(elem,"DIV","scriptClass","mstrRWControlImpl");if(div){return this.bone(div.getAttribute("id"));}else{return this.findBone(elem.parentNode);}}else{return this.findBone(elem.parentNode);}}}else{switch(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)){case microstrategy.OBJTYPE_DOC_SUBSECTION:if(obj.parentNode.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_PANEL_CONTAINER){var bb=this.findBone(obj.parentNode.parentNode);if(bb!=null&&bb.isLoaded){return bb.getPanel(obj.getAttribute("id"));}else{return null;}}case microstrategy.OBJTYPE_DOC_SECTION:case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:case microstrategy.OBJTYPE_DOC:return(this.bone("rwb_viewer")!=null)?this.bone("rwb_viewer").getChildBone(obj):null;break;}}return null;}catch(err){microstrategy.errors.log(err);return(null);}};microstrategy.objectType=function(elem){try{var obj=this.findAncestor(elem);if(obj){return elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}return null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.subObjectType=function(elem){try{return elem&&elem.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.getRegisteredAncestor=function(elem){if(!elem){return null;}var src=findTarget(elem,microstrategy.HTMLATTR_SCRIPTCLASS);if(src){var bone=microstrategy.bone(src.getAttribute("id"));if(bone){return bone;}return microstrategy.getRegisteredAncestor(src.parentNode);}return null;};microstrategy.findAncestor=function(elem){if(elem){return(findTarget(elem,microstrategy.HTMLATTR_OBJTYPE));}else{return null;}};microstrategy.findAncestorBone=function(bone,scriptClass){try{var obj=microstrategy.findAncestorWithAtt(bone.elem,"scriptclass",scriptClass);if(obj){return microstrategy.bone(obj.id);}else{return null;}}catch(err){return null;}};microstrategy.findAncestorWithAtt=function(oTarget,sAtt,sAttValue){try{var fn=(sAttValue)?function(t,a,v){return !!(t.getAttribute&&t.getAttribute(a)==v);}:function(t,a){return !!(t.getAttribute&&t.getAttribute(a)!=null);};while(oTarget){if(fn(oTarget,sAtt,sAttValue)){return oTarget;}oTarget=oTarget.parentNode;}return null;}catch(err){return null;}};microstrategy.findAncestorWithTag=function(oTarget,tagName){try{while(oTarget){if(oTarget.tagName==tagName){return oTarget;}oTarget=oTarget.parentNode;}return null;}catch(err){return null;}};microstrategy.findChildrenWithAtt=function(elem,tagName,sAtt,sAttValue){try{if(!elem){return null;}if(typeof (tagName)!="object"){tagName=[tagName];}var result=new Array;var resultCount=0;if(sAttValue){for(var j=0;j<tagName.length;j++){if((elem.tagName==tagName[j])&&(elem.getAttribute(sAtt)==sAttValue)){return elem;}var objs=elem.getElementsByTagName(tagName[j]);if(objs&&objs.length){for(var i=0;i<objs.length;i++){if(objs[i].getAttribute(sAtt)==sAttValue){result[resultCount++]=objs[i];}}}}}else{for(var j=0;j<tagName.length;j++){var objs=elem.getElementsByTagName(tagName[j]);if(objs&&objs.length){for(var i=0;i<objs.length;i++){if(objs[i].getAttribute(sAtt)!=null){result[resultCount++]=objs[i];}}}}}return result;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.findRegisteredChildBone=function(elem,tagName,scriptClass){try{if(!elem){return null;}if((elem.tagName.toLowerCase()==tagName)&&(isAttributePresent(elem,"scriptclass",scriptClass))){return microstrategy.bone(elem.id);}var objs=elem.getElementsByTagName(tagName);for(var i=0;objs&&i<objs.length;i++){if(isAttributePresent(objs[i],"scriptclass",scriptClass)){return microstrategy.bone(objs[i].id);}}return null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.findRWObjectBone=function(target,scriptClass){try{if(microstrategy.objectType(target)||target.getAttribute("scriptclass")){var ancestor=microstrategy.findAncestor(target);if(microstrategy.subObjectType(ancestor)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){return microstrategy.findRegisteredChildBone(target,"span");}else{return microstrategy.findRegisteredChildBone(target,"div",scriptClass);}}else{return microstrategy.findBone(target);}}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.findChildWithAtt=function(elem,tagName,sAtt,sAttValue){try{if(!elem||sAttValue===undefined){return null;}if(typeof (tagName)!="object"){tagName=[tagName];}for(var j=0;j<tagName.length;j++){if((elem.tagName!=null&&tagName[j]!=null&&elem.tagName.toLowerCase()==tagName[j].toLowerCase())&&(elem.getAttribute(sAtt)==sAttValue)){return elem;}var objs=elem.getElementsByTagName(tagName[j]);if(objs&&objs.length){for(var i=0;i<objs.length;i++){if(objs[i].getAttribute(sAtt)!=null&&(objs[i].getAttribute(sAtt).toString()).toLowerCase()==sAttValue.toLowerCase()){return objs[i];}}}}return null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.findChildWithCssClass=function(elem,tagName,className){try{if(!elem){return null;}if(typeof (tagName)!="object"){tagName=[tagName];}for(var j=0;j<tagName.length;j++){var pattern=new RegExp("(^|\\s)"+className+"(\\s|$)","i");if((elem.tagName!=null&&tagName[j]!=null&&elem.tagName.toLowerCase()==tagName[j].toLowerCase())&&pattern.test(elem.className)){return elem;}if(elem.getElementsByClassName){var objs=elem.getElementsByClassName(className);for(var obj,i=0;obj=objs[i];i++){if(tagName[j].toLowerCase()==obj.tagName.toLowerCase()){return obj;}}}else{var objs=elem.getElementsByTagName(tagName[j]);for(var obj,i=0;obj=objs[i];i++){if(pattern.test(obj.className)){return obj;}}}}return null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.findParentWithTag=function(elem,tagName){try{var parent=elem.parentNode;while(parent!=null){if(parent.tagName&&parent.tagName.toLowerCase()==tagName){return parent;}parent=parent.parentNode;}}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.objectFind=function(elem,tagName,objtype){try{return microstrategy.findChildWithAtt(elem,tagName,microstrategy.HTMLATTR_OBJTYPE,objtype);}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.objectListFind=function(elem,tagName,objtype){try{return microstrategy.findChildrenWithAtt(elem,tagName,microstrategy.HTMLATTR_OBJTYPE,objtype);}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.subObjectFind=function(elem,tagName,objtype){try{return microstrategy.findChildWithAtt(elem,tagName,microstrategy.HTMLATTR_SUBOBJTYPE,objtype);}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.subObjectListFind=function(elem,tagName,objtype){try{return microstrategy.findChildrenWithAtt(elem,tagName,microstrategy.HTMLATTR_SUBOBJTYPE,objtype);}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.getRect=function(obj){try{if(obj){var oRect=new Object;oRect.left=getObjSumLeft(obj);oRect.top=getObjSumTop(obj);oRect.right=oRect.left+getObjWidth(obj);oRect.bottom=oRect.top+getObjHeight(obj);return oRect;}return null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.doRectsIntersect=function(r1,r2){try{return(r2.left<r1.right&&r2.right>r1.left&&r2.top<r1.bottom&&r2.bottom>r1.top);}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.isRectInRect=function(r1,r2){try{return(r1.left>r2.left&&r1.right<r2.right&&r1.top>r2.top&&r1.bottom<r2.bottom);}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.relativeSnapCoordinate=function(x,parentNode,isVertical,useSnap,direction){try{var offset=(isVertical)?getObjSumTop(parentNode):getObjSumLeft(parentNode);if(!useSnap){return x;}return this.snapCoordinate(x,offset,useSnap,direction);}catch(err){microstrategy.errors.log(err);return x;}};microstrategy.isSnapped=function(x,parentNode,isVertical){try{var offset=0;if(parentNode!=null){offset=(isVertical)?getObjSumTop(parentNode):getObjSumLeft(parentNode);}return(((x-offset)%microstrategy.SNAP_SIZE)==0);}catch(err){microstrategy.errors.log(err);return x;}};microstrategy.snapCoordinate=function(x,offset,useSnap,direction){try{var relative=x-offset;if(useSnap!=null&&useSnap==false){return relative;}var moveDistance=0;var rtn=x;if(relative%microstrategy.SNAP_SIZE!=0){if(direction!=null){moveDistance=(direction==microstrategy.SNAP_DIRET_POS)?(microstrategy.SNAP_SIZE-relative%microstrategy.SNAP_SIZE):(relative%microstrategy.SNAP_SIZE)*microstrategy.SNAP_DIRET_NEG;rtn+=moveDistance;}else{moveDistance=relative%microstrategy.SNAP_SIZE;if(moveDistance>microstrategy.SNAP_SIZE/2){moveDistance=moveDistance-microstrategy.SNAP_SIZE;}rtn-=moveDistance;}}return rtn;}catch(err){microstrategy.errors.log(err);return x;}};microstrategy.createAssociativeArray=function(elem){try{if(elem==null){return null;}var items={};if(!elem.length){items.item=elem;}else{for(var i=0;i<elem.length;i++){items[i]=elem[i];}}return items;}catch(err){microstrategy.errors.log(err);return elem;}};microstrategy.boneForMask=function(src){if(!src){return null;}var type=src.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var bone=null;if(type==microstrategy.OBJTYPE_MASK||type==microstrategy.OBJTYPE_MASK_MAP){bone=microstrategy.bone(src.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT));if(bone==null){bone=microstrategy.findBone(document.getElementById(src.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT)));}}else{if(type==microstrategy.OBJTYPE_MASK_MAP_AREA){bone=microstrategy.bone(src.parentNode.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT));}}return bone;};microstrategy.updatePreference=function(name,value){try{if(typeof (mstrUpdateManager)!="undefined"&&mstrUpdateManager.SET_PREFERENCE){this.updateManager.add([this.updateManager.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,microstrategy.servletName+"."+microstrategy.pageName,["5003","5004"],[name,value],[])],true);}}catch(err){microstrategy.errors.log(err);}};microstrategy.updateBrowserSetting=function(name,value,isSessionSetting){try{var evt=isSessionSetting?mstrUpdateManager.SET_SESSION_BROWSER_SETTING:mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING;if(typeof (mstrUpdateManager)!="undefined"&&evt){this.updateManager.add([this.updateManager.createActionObject(null,evt,microstrategy.servletName+"."+microstrategy.pageName,["5005","5007"],[name,value],[])],true);}}catch(err){microstrategy.errors.log(err);return elem;}};microstrategy.updateCookieSetting=function(name,value){try{var toUpdate=name+microstrategy.ENCODED_EQUALS,existingValue=microstrategy.getCookieSetting(name),oldValue=toUpdate+(existingValue||0),newValue=toUpdate+value;if(existingValue===undefined){var cookieName="bSet=",cookieExists=document.cookie.indexOf(cookieName)!==-1;if(cookieExists){document.cookie=document.cookie.replace(cookieName,cookieName+newValue+microstrategy.ENCODED_AMPERSAND);}else{document.cookie=cookieName+newValue;}}else{document.cookie=document.cookie.replace(oldValue,newValue);}}catch(err){microstrategy.errors.log(err);return elem;}};microstrategy.getCookieSetting=function(name){try{return microstrategy.getCookieList()[name];}catch(err){microstrategy.errors.log(err);return elem;}};microstrategy.getCookieList=function(){try{var cookie=document.cookie,cookieList={},i,pair,n;if(!cookie||!(typeof cookie==="string")||cookie.indexOf("bSet")<0){return cookieList;}cookie=cookie.split(";");for(i=0,n=cookie.length;i<n;i++){if(cookie[i].indexOf("bSet")>=0){cookie=trim(cookie[i]);break;}}cookie=cookie.replace("bSet=","").split(microstrategy.ENCODED_AMPERSAND);for(i=0,n=cookie.length;i<n;i++){pair=cookie[i].split(microstrategy.ENCODED_EQUALS);cookieList[pair[0]]=pair[1];}return cookieList;}catch(err){microstrategy.errors.log(err);return elem;}};microstrategy.isValueInFilter=function(currentValue,filterValue,filterComparison){var toReturn=true;try{if(currentValue!=null&&filterValue!=null){toReturn=false;if(!filterComparison||(filterComparison==microstrategy.HTMLATTR_FILTER_COMPARISON_DEFAULT)){var values=filterValue.split(",");var index=0;while(index<values.length&&!toReturn){toReturn=(values[index]==currentValue);index++;}}else{toReturn=parseInt(currentValue)&parseInt(filterValue);}}}catch(err){microstrategy.errors.log(err);}return toReturn;};microstrategy.adjustUserPalette=function(newColor){try{var updated=false;var colors=this.userPalette;if(colors.length==0){colors=newColor;updated=true;}else{if(colors.indexOf(newColor)<0){var tempColors=colors.split(",");if(tempColors.length==8){colors=colors.substr(8,colors.length);}colors+=","+newColor;updated=true;}}if(updated){this.userPalette=colors;}return(updated)?colors:null;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.getFormatObject=function(){try{if(this.formatObj==null){this.formatObj=mstrFormatObject;}return this.formatObj;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.setSingleFormat=function(formatId,formatValue){try{var toReturn=[];var prop=formatId;var value=formatValue;var formatObj=mstrFormatObject;switch(formatId){case"Bold":prop="fontWeight";value=(formatValue)?"bold":"normal";break;case"Italic":prop="fontStyle";value=(formatValue)?"italic":"normal";break;case"Underline":prop="textDecoration";value=(formatValue)?4:-4;break;case"StrikeOut":prop="textDecoration";value=(formatValue)?8:-8;break;case"fstyle":if(parseInt(formatValue)&1){return microstrategy.setSingleFormat("Bold",formatValue);}else{if(parseInt(formatValue)&2){return microstrategy.setSingleFormat("Italic",formatValue);}else{return microstrategy.setSingleFormat("Underline",formatValue);}}break;case"TextAlign":case"align":prop="textAlign";value=formatObj.decodeValue(prop,formatValue);break;case"Horizontal":prop="textAlign";value=formatObj.decodeValue(prop,formatValue);break;case"GridHorizontal":prop="textAlign2";value=formatObj.decodeValue(prop,formatValue);break;case"Vertical2":prop="verticalAlign2";value=formatObj.decodeValue(prop,formatValue);break;case"Vertical":prop="verticalAlign";value=formatObj.decodeValue(prop,formatValue);break;case"FontFamily":case"font":case"Name":prop="fontFamily";break;case"FontSize":case"fsize":case"Size":prop="fontSize";value=formatObj.decodeValue(prop,formatValue);break;case"bgcolor":case"FillColor":if(formatValue==null||formatValue.length==0){prop="backgroundColor";value="transparent";}else{if(formatValue.indexOf(",")>=0){prop="Gradient";}else{prop="backgroundColor";}}break;case"FillStyle":prop="backgroundStyle";if(formatValue==null||formatValue.length==0){value="transparent";}if(formatValue&&formatValue.indexOf(",")>0){value="Gradient";}break;case"LineSpacing":prop="lineHeight";if(formatValue=="0"){formatValue="normal";}if(formatValue!="normal"){formatValue+="in";}value=formatValue;break;case"selectionColor":prop="selectionColor";value=(formatValue=="automatic")?"#60b1f6":formatValue;break;case"selectionStyle":prop="selectionStyle";value=(formatValue=="automatic")?"0":"1";break;case"LeftPadding":case"TopPadding":case"RightPadding":case"BottomPadding":prop="paddingLeft";if(formatId=="RightPadding"){prop="paddingRight";}if(formatId=="BottomPadding"){prop="paddingBottom";}if(formatId=="TopPadding"){prop="paddingTop";}value=formatValue+"pt";break;case"TextWrap":prop="whiteSpace";value=(formatValue>0)?"normal":"nowrap";break;case"color":case"Color":case"FontColor":prop="color";break;case"TopColor":case"LeftColor":case"RightColor":case"BottomColor":prop="borderTopColor";if(formatId=="LeftColor"){prop="borderLeftColor";}if(formatId=="RightColor"){prop="borderRightColor";}if(formatId=="BottomColor"){prop="borderBottomColor";}break;case"TopStyle":case"LeftStyle":case"RightStyle":case"BottomStyle":prop="borderTopStyle";if(formatId=="LeftStyle"){prop="borderLeftStyle";}if(formatId=="RightStyle"){prop="borderRightStyle";}if(formatId=="BottomStyle"){prop="borderBottomStyle";}switch(formatValue){case"0":case"5":case"1":case"7":value="solid";break;case"3":value="dashed";break;case"4":value="dotted";break;case"6":value="double";break;}break;case"topWidth":case"leftWidth":case"rightWidth":case"bottomWidth":prop="borderTopWidth";if(formatId=="leftWidth"){prop="borderLeftWidth";}if(formatId=="rightWidth"){prop="borderRightWidth";}if(formatId=="bottomWidth"){prop="borderBottomWidth";}switch(formatValue){case"0":value="0pt";break;case"3":case"4":case"1":case"7":value="1pt";break;case"5":value="1.5pt";break;case"6":value="2.5pt";break;}break;case"HasDropShadow":prop="dropShadowEffect";value=(value)?"1":"0";break;case"HasRoundedCorners":prop="hasRoundedCorners";value=(value)?"-1":"0";break;case"DropShadow":prop="dropShadowDepth";break;case"TopCornersOnly":prop="topCornersOnly";break;}toReturn[0]=prop;toReturn[1]=value;return toReturn;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.checkACL=function(elem,aclList){try{if(elem&&aclList){var acl=elem.getAttribute(microstrategy.HTMLATTR_ACL);if(acl&&acl.length>0){var iAcl=parseInt(acl);for(var i=0;i<aclList.length;i++){if((parseInt(aclList[i])&iAcl)==0){return false;}}}}return true;}catch(err){microstrategy.errors.log(err);return null;}};microstrategy.isValidGroupByType=function(dssType){try{if(dssType==microstrategy.DSSTYPE_CONSOLIDATION||dssType==microstrategy.DSSTYPE_FILTER||dssType==microstrategy.DSSTYPE_ATTRIBUTE){return true;}return false;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.toggleEditor=function(boneId,beanName,doNotSubmit){try{var b=this.bone(boneId);if(b){b.closeEditor();}else{var updateManager=this.updateManager;var actionCollection=[];actionCollection.push(updateManager.createActionObject(this,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],[true,beanName],[]));updateManager.add(actionCollection);if(!doNotSubmit){updateManager.flushAndSubmitChanges();}}return true;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.showAccordionWhileWaiting=function(cellId,containerId){try{if(!cellId){cellId="td_mstrWeb_dockLeft";}if(!containerId){containerId="mstrWeb_dockLeft";}var accordion=document.getElementById("accordion_AccordionTabManagerStyle");if(accordion&&accordion.getAttribute(mstrHTMLAttributes.ATTR_HIDDEN)!="true"){var leftCell=document.getElementById(cellId);if(leftCell){leftCell.style.display="block";leftCell.style.width="220px";leftCell.style.border="none";}var leftDiv=document.getElementById(containerId);if(leftDiv){leftDiv.style.display="block";}var closeBtn=microstrategy.findChildWithAtt(accordion,"IMG",(bIsW3C)?"class":"className","mstrIcon-btn mstrIcon-btnClose");if(closeBtn){closeBtn.style.display="none";}accordion.style.width="220px";if(bIsIE6){accordion.style.position="relative";var relatedReportsDiv=document.getElementById("relatedReportsId");if(relatedReportsDiv){relatedReportsDiv.style.width="210px";}}}}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.toggleAccordion=function(curTab,canTurnOff){try{var b=this.bone("accordion_AccordionTabManagerStyle");var cookieName="lTbar";canTurnOff=(typeof (canTurnOff)!="undefined"&&!canTurnOff)?false:true;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){cookieName=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"obDesign":"obView";}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){cookieName="accordionReportView";}}if(b&&(b.currentTabName==curTab||typeof (curTab)=="undefined")&&canTurnOff){if(microstrategy.EXECUTION_SCOPE!=microstrategy.REPORT_EXECUTION||microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){this.updateBrowserSetting(cookieName,"0");b.closeEditor(false);var notesIconModel=mstr.$obj("NotesIconModel_model");if(notesIconModel){if(notesIconModel.get("objectID")&&notesIconModel.get("objectType")){notesIconModel.execCheck();}else{var notesIconView=mstr.$obj("NotesIconView_view");if(notesIconView){notesIconView.set("visible",false);}}}}}else{if(b){b.setCurTab(curTab);}else{this.updateBrowserSetting(cookieName,"1");if(typeof (curTab)!="undefined"){if(mstrApp.rememberLastEditorPanel!=="0"){this.updateBrowserSetting((microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION)?"accordionRWTab":"accordionReportTab",curTab);}}toggleShowBean("accordion",true,(typeof (curTab)!="undefined")?"currentTabName="+curTab:"");var notesPanelName=(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?microstrategy.ACCORDION_REPORT_NOTES_PANEL:microstrategy.ACCORDION_RW_NOTES_PANEL;if(curTab==notesPanelName){var notesIconView=mstr.$obj("NotesIconView_view");if(notesIconView){notesIconView.set("visible",false);}}else{var notesIconModel=mstr.$obj("NotesIconModel_model");if(notesIconModel){if(notesIconModel.get("objectID")&&notesIconModel.get("objectType")){notesIconModel.execCheck();}}}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.needSaveBeforeNotes=function(){try{var bone=((microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?microstrategy.bone("UniqueReportID"):microstrategy.getViewerBone());return(bone&&bone.needSaveBeforeNotes);}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.performSave=function(){try{if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){var rb=microstrategy.bone("UniqueReportID");return(rb&&rb.commands.exec("save"));}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var rwbv=microstrategy.bone("rwb_viewer");return(rwbv&&rwbv.doc.commands.exec("save"));}}}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.toggleRelatedReports=function(){try{var b=this.bones.relatedReports;if(b){this.updateBrowserSetting("lTbar","0");}else{this.updateBrowserSetting("lTbar","1");}this.updateManager.useIframe=false;this.updateManager.flushAndSubmitChanges();return true;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.toggleLeftToolbar=function(){try{var b=this.bone("leftToolbar");if(b){b.close();}else{this.updateBrowserSetting("lTbar","1");this.updateManager.useIframe=false;this.updateManager.flushAndSubmitChanges();}return false;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.disableTextSelection=function(target){try{if(!target){return ;}if(typeof target.onselectstart!="undefined"){target.onselectstart=function(){return false;};}else{if(typeof target.style.MozUserSelect!="undefined"){target.style.MozUserSelect="none";}}}catch(err){microstrategy.errors.log(err);}};mstrAreaObjectImpl.prototype={};function mstrAreaObjectImpl(){this.shape="rect";this.coords="0,0,0,0";this.pointsTo=null;this.onmouseovercoords=null;this.onmouseout=null;this.moveHilite=true;}mstrObjectInfoImpl.prototype={};mstrObjectInfoImpl.prototype.src=null;mstrObjectInfoImpl.prototype.left=0;mstrObjectInfoImpl.prototype.top=0;mstrObjectInfoImpl.prototype.height=0;mstrObjectInfoImpl.prototype.width=0;mstrObjectInfoImpl.prototype.alias="";mstrObjectInfoImpl.prototype.dssId="";mstrObjectInfoImpl.prototype.dssFrmId="";mstrObjectInfoImpl.prototype.dssType=0;mstrObjectInfoImpl.prototype.dssSubType=0;mstrObjectInfoImpl.prototype.dSetId=null;mstrObjectInfoImpl.prototype.dSetName="";mstrObjectInfoImpl.prototype.isUnique=true;function mstrObjectInfoImpl(elem){try{if(elem){this.src=elem;this.alias=elem.getAttribute("ds");var bone=microstrategy.findBone(elem);if(!bone){var subtype=elem.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE||subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM||subtype==microstrategy.SUBOBJTYPE_METRIC){this.dssId=elem.getAttribute(microstrategy.HTMLATTR_DSS_ID);this.dssType=elem.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);}}else{this.dssType=elem.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);this.dssSubType=elem.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);if(this.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){if(bone.type==microstrategy.OBJTYPE_OBJBROWSER){this.dssFrmId=elem.getAttribute(microstrategy.HTMLATTR_DSS_ID);this.dssId=elem.getAttribute(microstrategy.HTMLATTR_ATTRIBUTE_ID);}}else{this.dssId=elem.getAttribute(microstrategy.HTMLATTR_DSS_ID);}switch(bone.type){case microstrategy.OBJTYPE_OBJBROWSER:this.dSetId=microstrategy.primeDataSetId;if(bone.isRWTab){this.dSetId=elem.getAttribute("id").slice(0,32);this.dSetName=bone.getDatasetName(this.dSetId);if(this.dssType==microstrategy.DSSTYPE_METRIC){this.isUnique=bone.isMetricUnique(this.alias);}}break;case microstrategy.OBJTYPE_PAGE_BY_ELEM:this.dSetId=microstrategy.primeDataSetId;break;case microstrategy.OBJTYPE_DOC_SUBSECTION:case microstrategy.OBJTYPE_DOC_OBJECT:this.dSetId=elem.getAttribute(microstrategy.HTMLATTR_DSS_SET);break;}}}return this;}catch(err){microstrategy.errors.log(err);return null;}}microstrategy.isEnabled=function(items,prop){try{var format=this.getFormatObject();if(items&&format[prop]){if(format[prop][mstrFormatObject.APPLIES_TO]=="all"){return true;}for(var item in items){if(this.isEnabledForItem(items[item],prop)){return true;}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.isEnabledForItem=function(item,prop){try{if(prop=="Gradient"){return true;}var f=this.getFormatObject();if(f[prop][mstrFormatObject.APPLIES_TO]=="all"){return true;}var at=f[prop][mstrFormatObject.APPLIES_TO];var type=item.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var subType=item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(at.contains(type,",")||at.contains(subType,",")){if(subType!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||prop!="textAlign"){return true;}else{if(item.lastChild){var ctlBone=microstrategy.bone(item.lastChild.id);if(ctlBone){switch(ctlBone.ctlStyle){case mstrRWControlImpl.CTL_STYLE_POOL_DOWN:case mstrRWControlImpl.CTL_STYLE_SCROLLER:case mstrRWControlImpl.CTL_STYLE_LIST_BOX:return ctlBone.docViewer.commands.queryState("edtValueSelector").value==mstrRWControlImpl.FMT_TYPE_TITLE_BASE;default:return true;break;}}}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.setPrimeDataSetId=function(id){microstrategy.primeDataSetId=id;};microstrategy.getEventHandlerString=function(path){try{if(typeof (path)!="string"||path.length==0){return"if (true)";}var components=path.split(".");for(var i=1;i<components.length;i++){components[i]=components[i-1]+"."+components[i];}var delimiter="";var s="";for(var i=0;i<components.length;i++){s+=delimiter+"(typeof("+components[i]+") != 'undefined' && "+components[i]+" != null)";delimiter=" && ";}return"if ("+s+")";}catch(err){microstrategy.errors.log(err);return"if (true)";}};microstrategy.isObjectBrowserOpen=function(){try{for(var id in this.bones){if(this.bones[id].type==microstrategy.OBJTYPE_OBJBROWSER){return true;}}}catch(err){microstrategy.errors.log(err);}return false;};microstrategy.getObjectBrowser=function(){try{for(var id in this.bones){if(this.bones[id].type==microstrategy.OBJTYPE_OBJBROWSER){return this.bones[id];}}}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.retrievePaddingAndBorders=function(item,styleProp,defFmt){try{var values=[];var props=[];if(item!=null){if(styleProp=="height"){props=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"];}else{props=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"];}var styleObj=this.styleObj;for(var i=0;i<4;i++){var p=props[i],v;if(p.indexOf("border")>-1){var hasStyle=styleObj.getValue(item,p.replace("Width","Style"))!="none";v=hasStyle?styleObj.getValue(item,props[i]):0;}else{v=styleObj.getValue(item,props[i]);}values.push(v);}return values;}var fmtInfo=this.getFormatObject();var obj={ts:"0",bs:"0",tp:"0",bp:"0",ls:"0",rs:"0",lp:"0",rp:"0"};props=[{ps:"FormattingBorder",p:"Style",a:["Top","Bottom","Left","Right"]},{ps:"FormattingPadding",p:"Padding",a:["Top","Bottom","Left","Right"]},{ps:"FormattingLine",p:"LineWeight"}];var pv,ipv;for(var i=0;i<3;i++){var ps=defFmt[props[i].ps];var is=fmtInfo[props[i].ps];if(!ps||!is){continue;}var p=props[i].p;var a=props[i].a;if(a){for(var j=0;j<4;j++){pv=ps[a[j]+p];ipv=is[a[j]+p];if(!pv||!ipv){continue;}var pn=ipv[mstrFormatObject.HTML_PROP_NAME];var dv=fmtInfo.decodeValue(pn,pv.defaultValue||"0");obj[a[j].substr(0,1).toLowerCase()+p.substr(0,1).toLowerCase()]=dv;}}else{pv=ps[p];ipv=is[p];if(!pv||!ipv){continue;}var pn=ipv[mstrFormatObject.HTML_PROP_NAME];var dv=fmtInfo.decodeValue(pn,pv.defaultValue||"0");obj.ts=dv;obj.bs=dv;obj.ls=dv;obj.rs=dv;}}if(styleProp=="height"){values=[obj.ts,obj.bs,obj.tp,obj.bp];}else{values=[obj.ls,obj.rs,obj.lp,obj.rp];}return values;}catch(err){microstrategy.errors.log(err);return[];}};microstrategy.getPaddingAndBorderPixels=function(item,styleProp,defFmt){try{var values=this.retrievePaddingAndBorders(item,styleProp,defFmt);var pxs=0;var pts=0;for(var i=0;i<values.length;i++){if(values[i]!=null&&values[i].length>0&&!isNaN(parseFloat(values[i]))){if(bIsIE6){pxs+=Math.round(this.getFormatObject().getPxFromPt(values[i]));}else{pts+=parseFloat(values[i]);}}}return pxs+this.getFormatObject().getPxFromPt(pts);}catch(err){microstrategy.errors.log(err);return 0;}};microstrategy.getMaxZIndex=function(pos){try{var maxRWZIndex=0;if(this.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var docViewer=this.bone("rwb_viewer");if(docViewer!=null){if(docViewer.commands&&docViewer.commands.exec){maxRWZIndex=docViewer.commands.exec("maxZIndex");}}}var currentCount=(!isNaN(pos)&&pos>-1?pos:currentModalEditor.length)+mstr.controllers.ModalEditors.size();return maxRWZIndex+currentCount*2+100;}catch(err){microstrategy.errors.log(err);return 0;}};microstrategy.setCursorToEnd=function(field){if(field.createTextRange){var range=field.createTextRange();range.moveStart("character",field.value.length);range.collapse();range.select();}else{field.focus();}};microstrategy.openDialog=function(dialogName,url,actionCollection,beanPath,propsObject){try{var passOut=(actionCollection!=null);if(!passOut){var actionCollection=[];}var ids=new Array("5018","5017");var values=new Array(dialogName,true);if(propsObject){var sm=new mstrSerializer();for(var p in propsObject){var pm=new mstrSerializer();pm.addStr(p);pm.addStr(propsObject[p]);sm.addStr(pm.getState());}ids.push("5024");values.push(sm.getState());}actionCollection.push(this.updateManager.createActionObject(this,mstrUpdateManager.SHOW_BEAN,beanPath,ids,values,[]));if(!passOut){this.updateManager.add(actionCollection);}this.updateManager.addURL(url);return(passOut)?actionCollection:null;}catch(err){microstrategy.errors.log(err);return(actionCollection!=null)?actionCollection:false;}};microstrategy.getBonesByType=function(types){try{var __result=[];var parameterType=typeof (types);var typesTestStr=(parameterType.toLowerCase()=="string")?"~"+types+"~":"~"+types.join("~")+"~";for(var b in this.bones){if(typesTestStr.search("~"+this.bones[b].type+"~")>-1){__result.push(this.bones[b]);}}}catch(err){microstrategy.errors.log(err);}return __result;};microstrategy.unregisterGridBones=function(type){try{for(var id in this.bones){var obone=this.bones[id];if(obone&&obone.elem){var obj=obone.elem;var otype=obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(otype==microstrategy.SUBOBJTYPE_GRID_TABLE){microstrategy.unRegisterBone(id);}}}}catch(err){microstrategy.errors.log(err);}};microstrategy.adjustSelectedVisualization=function(bone,newViewMode){try{var currVisViewMode;for(var i=0;i<bone.visualizationList.length;i++){var name=bone.visualizationList[i].name;if(name==bone.selectedVisualization){currVisViewMode=bone.visualizationList[i].vm;break;}}if(currVisViewMode==newViewMode){return ;}var firstVisWithViewMode;for(var j=0;j<bone.visualizationList.length;j++){var vm=bone.visualizationList[j].vm;if(vm==newViewMode){firstVisWithViewMode=bone.visualizationList[j].name;break;}}if(firstVisWithViewMode){var actionCollection=[];if(bone.setVisualizationSettings){bone.setVisualizationSettings(null,firstVisWithViewMode,null,-1,actionCollection);}else{if(bone.doc&&bone.doc.setVisualizationSettings){bone.doc.setVisualizationSettings(null,firstVisWithViewMode,null,-1,actionCollection);}}this.updateManager.add(actionCollection);}}catch(err){microstrategy.errors.log(err);}};microstrategy.updateVisProps=function(enabled,selectedVisualization,visualizationList,viewMode,bone){try{if(enabled){bone.visualizationsEnabled=enabled;}if(selectedVisualization!=null){bone.selectedVisualization=selectedVisualization;}if(visualizationList!=null){var selList=visualizationList.split(",");var allVis=bone.getAllVisList();if(allVis&&selList.length>0){bone.visualizationList=[];for(var i=0;i<selList.length;i++){var curVisName=selList[i];var curVis=allVis[curVisName];if(curVis){bone.visualizationList.push({name:curVisName,desc:curVis.d,vm:curVis.vm});}}}}if(viewMode&&viewMode!=bone.visualizationMode){bone.visualizationMode=viewMode;bone.isVisualization=(viewMode>=50);}}catch(err){microstrategy.errors.log(err);}};microstrategy.repaintContent=function(gridId){try{function repaintCells(table){var rows=table&&table.rows,rows_len=rows&&rows.length||0;for(var i=0;i<rows_len;i++){var cells=rows[i].cells,cells_len=cells.length;for(var j=0;j<cells_len;j++){var s=cells[j].style;s.height="0px";s.height="auto";}}}var gridTable=microstrategy.findAncestorWithAtt(document.getElementById(gridId),(bIsW3C)?"class":"className","repLayout");if(gridTable){repaintCells(gridTable);}var contentTable=document.getElementById("mstrWebContentTable");repaintCells(contentTable);}catch(err){microstrategy.errors.log(err);}};microstrategy.resolveBorderFlags=function(flags,includeSides){var borders=[];try{if(flags==0){borders=[0];}else{if(flags==31){borders=[16];if(includeSides){borders=borders.concat(1,2,4,8);}}else{var test=[1,2,4,8];for(i=0;i<4;i++){if((flags&test[i])>0){borders.push(test[i]);}}}}}catch(err){microstrategy.errors.log(err);}return borders;};microstrategy.overwriteRequestParameters=function(req,modelProps,viewProps){try{var params=req.params||{};mstr.utils.Hash.overwrite(params,modelProps);mstr.utils.Hash.overwrite(params,viewProps);req.params=params;}catch(err){microstrategy.errors.log(err);}};microstrategy.openDataBasedBlockEditor=function(editorId,editorStyle,beanPath,modelProps,viewProps,boneCaller,callbackInfo,parentNode){try{var e=this.getBlockEditorFromCache(editorId,modelProps,viewProps,boneCaller,parentNode);if(e){return ;}var beanPathTokens=beanPath.split(".");var req;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){req=new mstr.http.RwBlockLoaderInput(editorStyle,beanPathTokens[beanPathTokens.length-1]);}else{req=new mstr.http.ReportBlockLoaderInput(editorStyle,beanPathTokens[beanPathTokens.length-2]);}microstrategy.overwriteRequestParameters(req,modelProps,viewProps);this.openBlockEditor(editorId,req,boneCaller,callbackInfo,parentNode);}catch(err){microstrategy.errors.log(err);}};microstrategy.openFolderBasedBlockEditor=function(editorId,editorStyle,folderProps,modelProps,viewProps,boneCaller,callbackInfo,parentNode){try{var e=this.getBlockEditorFromCache(editorId,modelProps,viewProps,boneCaller,parentNode);if(e){return ;}var req=new mstr.http.FolderBlockLoaderInput(editorStyle,folderProps);microstrategy.overwriteRequestParameters(req,modelProps,viewProps);this.openBlockEditor(editorId,req,boneCaller,callbackInfo,parentNode);}catch(err){microstrategy.errors.log(err);}};microstrategy.openBlockLoaderEditor=function(editorId,editorStyle,modelProps,viewProps,boneCaller,callbackInfo,parentNode){try{var e=this.getBlockEditorFromCache(editorId,modelProps,viewProps,boneCaller,parentNode);if(e){return ;}var req=new mstr.http.BlockLoaderInput(editorStyle);microstrategy.overwriteRequestParameters(req,modelProps,viewProps);this.openBlockEditor(editorId,req,boneCaller,callbackInfo,parentNode);}catch(err){microstrategy.errors.log(err);}};microstrategy.getBlockEditorFromCache=function(editorId,modelProps,viewProps,boneCaller,parentNode){try{var editor=mstr.bones.editors.Map[this.id]&&mstr.bones.editors.Map[this.id][editorId];if(editor&&!editor.get("avoidCache")&&editor.get("element").innerHTML){var p;var m=editor.getModel();for(p in modelProps){m.setPropertyByPath(p,modelProps[p]);}if(m&&boneCaller){m.set("opener",boneCaller);}for(p in viewProps){editor.setPropertyByPath(p,viewProps[p]);}if(boneCaller){editor.set("opener",boneCaller);}var el=editor.get("element");if(bIsW3CIE&&el.childElementCount===0){return ;}if(parentNode&&!mstr.utils.Dom.containsElement(parentNode,el,false)){parentNode.appendChild(el);}editor.set("visible",true);return editor;}}catch(err){microstrategy.errors.log(err);}return null;};microstrategy.openBlockEditor=function(editorId,req,boneCaller,callbackInfo,parentNode){try{if(mstr.utils.ISIE4){self.supressWaitPage=true;}var ta=document.createElement("textarea");ta.setAttribute("id",editorId+"_ta");ta.className="mstrJSON";if(parentNode){parentNode.appendChild(ta);}else{document.body.appendChild(ta);}if(!this.taskModel){this.taskModel=new mstr.models.TaskModel({parent:this});mstr.controllers.Factory.add(this.taskModel);var zz=this.taskModel&&this.taskModel.init&&this.taskModel.init();if(!("id" in this)){mstr.controllers.Factory.add(this);}this.taskModel.attachEventListener(this,"set_readyState","handleTaskModelReadyStateChange");}this.taskModel.execFetchBlock(req,ta,{editorId:editorId,opener:boneCaller,callback:callbackInfo});}catch(err){microstrategy.errors.log(err);}};microstrategy.handleTaskModelError=function(evt){if(mstr.utils.ISIE4){self.supressWaitPage=false;}rc=evt.src.get("requestContext");var err=microstrategy.descriptors.getDescriptor(7484);if(rc&&rc.response){if(rc.response.taskErrorCode){switch(rc.response.taskErrorCode){case microstrategy.WEB_API_ERROR_CODES.MSI_SERVER_NAME_NOT_INITIALIZED:case microstrategy.WEB_API_ERROR_CODES.MSI_INVALID_SESSION_ID:case microstrategy.WEB_API_ERROR_CODES.E_MSI_USERMGR_USER_NOTFOUND:case microstrategy.WEB_API_ERROR_CODES.E_MSI_CONNECT_FAILED:this.updateManager.refreshPage();return ;default:err=err+microstrategy.descriptors.getDescriptor(7485)+rc.response.taskErrorCode;break;}}if(rc.response.data){err=err+"\n"+rc.response.data;}else{if(rc.response.status&&rc.response.statusText){err=err+"\n"+rc.response.status+": "+rc.response.statusText;}}}showMessage({contents:err,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});};microstrategy.handleTaskModelReadyStateChange=function(evt){try{var rc=evt.src.get("requestContext");var callbackFn=function(){if(mstr.utils.ISIE4){self.supressWaitPage=false;}var cb=rc&&rc.memo&&rc.memo.callback;if(cb){if(cb.scope){cb.method.apply(cb.scope,[evt]);}else{if(cb.method){cb.method(evt);}}}};switch(evt.memo.value){case mstr.Enum.Widget.READYSTATE.ERROR:microstrategy.handleTaskModelError(evt);callbackFn();return ;case mstr.Enum.Widget.READYSTATE.IDLE:var map=mstr.bones.editors.Map[this.id]||{};var v=evt.src.get("views");var o=rc&&rc.memo&&rc.memo.opener;if(o){var i;for(i=0;v&&i<v.length;i++){v[i].set("opener",o);}var m=evt.src.get("models");for(i=0;m&&i<m.length;i++){m[i].set("opener",o);}}var editor=map[rc.memo.editorId]=v[0];editor.render();callbackFn();mstr.bones.editors.Map[this.id]=map;break;case mstr.Enum.Widget.READYSTATE.CANCELLED:callbackFn();break;}}catch(err){microstrategy.errors.log(err);}};mstrDNDHelperImpl.prototype={};mstrDNDHelperImpl.prototype.helperImg=null;mstrDNDHelperImpl.prototype.parentBone=null;mstrDNDHelperImpl.prototype.onmouseup=function(path){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener(path,"mousemove");this.parentBone.detachWinListener(path,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}this.parkHelperImage();}catch(err){microstrategy.errors.log(err);}};mstrDNDHelperImpl.prototype.parkObject=function(obj){try{obj.style.top="-10000px";obj.style.left="-10000px";}catch(err){microstrategy.errors.log(err);}};mstrDNDHelperImpl.prototype.parkHelperImage=function(){try{if(this.helperImg){this.parkObject(this.helperImg);}}catch(err){microstrategy.errors.log(err);}};mstrDNDHelperImpl.prototype.moveHelperImage=function(e){try{if(!this.helperImg){this.initElement();}getMouse(e);this.helperImg.style.left=(lMouseX+10)+"px";this.helperImg.style.top=(lMouseY-20)+"px";var mask=microstrategy.findAncestor(getEventTarget(e));if(mask!=null){var bone=this.getMaskedBone(mask);if(bone!=null&&bone.getDNDHelperImage){var imageSrc=bone.getDNDHelperImage(this.parentBone,mask.getAttribute(microstrategy.HTMLATTR_POINTS_TO));if(imageSrc!=null&&this.helperImg.src.search(new RegExp(imageSrc))==-1){this.helperImg.src=imageSrc;}return ;}}this.parkHelperImage();}catch(err){microstrategy.errors.log(err);}};mstrDNDHelperImpl.prototype.getMaskedBone=function(mask){try{var bone=microstrategy.boneForMask(mask);return(bone!=null&&bone.ondrop)?bone:null;}catch(err){microstrategy.errors.log(err);return null;}};mstrDNDHelperImpl.prototype.initElement=function(){try{var img=document.createElement("img");img.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";img.style.position="absolute";img.style.top=img.style.left="-10000px";img.style.zIndex=1000;if(bIsIE6){img.style.height="auto";img.style.width="auto";}this.helperImg=document.body.appendChild(img);if(bIsIE6){img.style.height="auto";img.style.width="auto";}this.helperImg=document.body.appendChild(img);}catch(err){microstrategy.errors.log(err);}};function mstrDNDHelperImpl(obj){this.parentBone=obj;return this;}microstrategy.registerNewBones=function(){for(var i=0,len=microstrategy.bonesToRegister.length;i<len;i++){var boneProp=microstrategy.bonesToRegister[i];microstrategy.registerBone(boneProp.id,boneProp.loadCondition,boneProp.properties);}microstrategy.bonesToRegister.length=0;};microstrategy.addXmlAttr=function(name,value){try{return" "+name+'="'+value+'"';}catch(err){microstrategy.errors.log(err);return 0;}};microstrategy.addXmlAttrEncoded=function(name,value){if(!value){return"";}var buf=[];var len=value.length;var ch;for(var i=0;i<len;i++){ch=value.charAt(i);switch(ch){case">":buf.push("&gt;");break;case"<":buf.push("&lt;");break;case"&":buf.push("&amp;");break;case"\u0009":buf.push("&#x09;");break;case"\n":buf.push("&#x0A;");break;case"\r":buf.push("&#x0D;");break;case'"':buf.push("&quot;");break;default:buf.push(ch);break;}}return" "+name+'="'+buf.join("")+'"';};microstrategy.getPopupMask=function(elem){var __result=elem&&elem.popupMask;if(!__result){if(!document.popupMasks){document.popupMasks=[];var popupMasks=document.getElementsByName("popupMask");if(popupMasks){for(var i=0,len=popupMasks.length;i<len;i++){popupMasks[i].setAttribute("free",true);document.popupMasks.push(popupMasks[i]);}}}var availableMasks=document.popupMasks;for(var i=0;i<availableMasks.length;i++){if(availableMasks[i].getAttribute("free")==true){__result=availableMasks[i];break;}}if(!__result){var popupMask=document.getElementById("popupMask1");var newBackground;if(popupMask){newBackground=popupMask.cloneNode(false);}else{newBackground=document.createElement("iframe");}document.body.appendChild(newBackground);newBackground.style.position="absolute";newBackground.style.visibility="hidden";newBackground.style.display="none";newBackground.setAttribute("border","0");newBackground.id="popupMask"+availableMasks.length;availableMasks.push(newBackground);__result=newBackground;}}if(__result){__result.setAttribute("free",false);__result.style.display="block";if(elem){elem.popupMask=__result;__result.elem=elem;elem.insertAdjacentElement("beforeBegin",__result);__result.style.visibility="visible";__result.className="popupmask";}}return __result;};microstrategy.releasePopupMask=function(elem){if(elem){var popupMask=elem.popupMask;if(popupMask){popupMask.style.display="none";popupMask.style.visibility="hidden";popupMask.style.zIndex=0;popupMask.setAttribute("free",true);popupMask.elem=null;}elem.popupMask=null;}else{var availableBackgrounds=document.popupMasks;if(availableBackgrounds){for(var i=0;i<availableBackgrounds.length;i++){availableBackgrounds[i].style.display="none";availableBackgrounds[i].style.visibility="hidden";availableBackgrounds[i].style.zIndex=0;availableBackgrounds[i].setAttribute("free",true);var associatedElem=availableBackgrounds[i].elem;if(associatedElem){associatedElem.popupMask=null;}availableBackgrounds[i].elem=null;}}}};microstrategy.execDynamiclLink=function(linkInfo,xml,onw){try{window.mstrSubmitLink=true;var argNames=null;var argValues=[linkInfo.tid];var event=null;var tvm=null;var um=microstrategy.updateManager;if(linkInfo.tty==microstrategy.DSSTYPE_RPT_DEFINITION){event=mstrUpdateManager.RUN_REPORT;argNames=["1001"];if(xml){argNames.push("4222");argValues.push(xml);}argNames.push("4115");argValues.push(microstrategy.getReportViewMode(linkInfo.tstp));}else{if(linkInfo.tty==microstrategy.DSSTYPE_DOC_DEFINITION){if(linkInfo.tstp==microstrategy.DSSSUB_TYPE_RW){var openInHTMLVI=(linkInfo.tvmd&(8192|2048)&&!((linkInfo.tvmd&2048&&microstrategy.isFeatureAvailable("flashvi"))));if(openInHTMLVI){if(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return ;}event=mstrUpdateManager.RUN_VI_DOCUMENT;}else{event=mstrUpdateManager.RUN_RW_DOCUMENT;}argNames=["2048001"];if(xml){argNames.push("2048140");argValues.push(xml);}if(linkInfo.so>0){argNames.push("2048087");argValues.push(this.bone("rwb_viewer").messageID);if(!xml){argNames.push("2048201");argValues.push("0");}argNames.push("2048261");argValues.push(linkInfo.so);}}else{event=mstrUpdateManager.RUN_DOCUMENT;argNames=["1001"];if(xml){argNames.push("32351");argValues.push(xml);}}}}var oldUseIframeSetting=um.useIframe;var oldNWSetting=um.newWindow;um.useIframe=false;um.newWindow=onw;if(um.hasChangesToSubmit()){um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}um.add([um.createActionObject(this.elem,event,"",argNames,argValues,[])]);um.flushAndSubmitChanges();um.acknowledgeRequest();um.newWindow=oldNWSetting;um.useIframe=oldUseIframeSetting;}catch(err){microstrategy.errors.log(err);}};microstrategy.getReportViewMode=function(subType){switch(subType.toString()){case microstrategy.DSSTYPE_GRAPH:return microstrategy.DISPLAY_MODE_GRAPH;break;case microstrategy.DSSTYPE_GRID_AND_GRAPH:return microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;break;case microstrategy.DSSTYPE_GRID:default:return microstrategy.DISPLAY_MODE_GRID;break;}};microstrategy.isDoubleByte=function(){var localeID=microstrategy.displayLocaleID;if(localeID!=null&&(localeID==1041||localeID==1042||localeID==2052||localeID==1028)){return true;}return false;};microstrategy.loadAdditionalFiles=function(s){microstrategy.delayOnload();var head=document.getElementsByTagName("head")[0];for(var i=0,l=s.length;i<l;++i){var sc="script",tp="text/javascript",filePath=getResourcePathWithVersion(s[i]);if(bIsFirefox){var t=document.createElement(sc),sa="setAttribute";t[sa]("src",filePath);t[sa]("type",tp);if(mstr.utils.ISFF4PLUS){t.async=false;}head.appendChild(t);}else{document.writeln("<"+sc+' type="'+tp+'" src="'+filePath+'" defer></'+sc+">");}}};microstrategy.mstrOnLoadFn=null;microstrategy.delayOnload=function(){if(typeof (window.onload)=="function"){microstrategy.mstrOnLoadFn=window.onload;window.onload=null;if(mstr.utils.ISFF3_0){document.body.removeAttribute("onload");}}};microstrategy.getZoomFactor=function(){return microstrategy.ZOOM_FACTOR;};microstrategy.getPersistParams=function(){return microstrategy.persistParams;};microstrategy.useQuickSearch=function(){try{var qse=(microstrategy.enableQuickSearch=="1");if(microstrategy.IServerVesion){var isv=microstrategy.IServerVesion.split("."),minimum="9.2.400.013".split(".");for(var i=0,len=isv.length;i<len;i++){if(isv[i]>minimum[i]){break;}else{if(isv[i]==minimum[i]){continue;}else{qse==false;break;}}}}qse=qse&&(microstrategy.isQuickSearchEnabled);return qse;}catch(err){microstrategy.errors.log(err);}};microstrategy.dynamicJS=[];microstrategy.insertScriptTag=function(jsfile,e,notify,callback){var script=document.createElement("script");var sa="setAttribute";script[sa]("src",getResourcePathWithVersion(jsfile));script[sa]("type","text/javascript");script[sa]("defer","defer");document.getElementsByTagName("head")[0].appendChild(script);if(bIsIE4){script.onreadystatechange=function(){if(script.readyState=="loaded"||script.readyState=="complete"){script.onreadystatechange=null;microstrategy.loadDynamicJS(e,notify,callback);}};}else{if(mstr.utils.ISSAFARI||mstr.utils.ISCHROME||mstr.utils.ISFF4PLUS||bIsW3CIE){script.onload=function(){script.onload=null;microstrategy.loadDynamicJS(e,notify,callback);};}}};microstrategy.loadDynamicJS=function(e,notify,callback){if((bIsIE4||mstr.utils.ISSAFARI||mstr.utils.ISCHROME||mstr.utils.ISFF4PLUS||bIsW3CIE)&&microstrategy.dynamicJS.length>0){if(!checkJSExists(microstrategy.dynamicJS[0]["key"])){microstrategy.insertScriptTag(microstrategy.dynamicJS[0]["file"],e,notify,callback);microstrategy.dynamicJS.shift();}else{microstrategy.dynamicJS.shift();microstrategy.loadDynamicJS(e,notify,callback);}}else{if(notify){if(callback){callback();}else{microstrategy.eventManager.initializeBones(e);}}}};microstrategy.getVersion=function(){var m=microstrategy;return(m.buildVersion?"v="+m.buildVersion:"")+(m.appVersion?"&apv="+m.appVersion:"");};microstrategy.resourceLoader={LOADING:1,LOADED:2,status:{},TAG_DEF:{css:{n:"link",uri:"href",atts:{rel:"stylesheet",type:"text/css"},node:"styleSheets"},javascript:{n:"script",uri:"src",atts:{type:"text/javascript",defer:"defer"},node:"scripts"},image:{n:"img",uri:"src",atts:{},node:"images"}},checkStaticLoaded:function(fileURI,fileType){if(fileURI&&!this.status[fileURI]){var tag=this.TAG_DEF[fileType],nodes=document[tag.node];if(nodes){var loaded=false,uri=fileURI;mstr.$A.forEach(nodes,function(item,i){var loadedURI=item[tag.uri];if(loadedURI){loaded=new RegExp(encodeURIComponent(uri)+"$","i").test(encodeURIComponent(loadedURI));if(loaded){return false;}}});this.status[fileURI]=loaded;}}},buildURI:function(file,fileType,isMojo,isMojoBundle){var t=(fileType=="javascript"?"js":fileType)+(isMojo?"Mojo":"")+(isMojoBundle?"Bundle":"");var root={css:"../style/mstr",js:"../javascript",cssMojo:"../javascript/mojo/css",jsMojo:"../javascript/mojo/js/source",jsMojoBundle:"../javascript/bundles"}[t];var uri=root+"/"+file;return getResourcePathWithVersion(uri);},insertTag:function(fileURI,fileType){var tag=this.TAG_DEF[fileType||"javascript"];var el=document.createElement(tag.n),sa="setAttribute",that=this;for(var att in tag.atts){el[sa](att,tag.atts[att]);}el[sa](tag.uri,fileURI);el.onload=function(){el.onload=null;if(that){that.onFileLoad(fileURI);that=null;el.onreadystatechange=null;}};el.onreadystatechange=function(){var rs=el.readyState;if(rs==="loaded"||rs==="complete"){el.onreadystatechange=null;if(that){that.onFileLoad(fileURI);that=null;el.onload=null;}}};document.getElementsByTagName("head")[0].appendChild(el);},onFileLoad:function(file){var st=this.status[file]||{},f=st.callback;st.state=this.LOADED;if(f){f();}},get:function(file,fileType,isMojo,isMojoBundle,callback){if(!file){if(callback){callback();}return ;}var fileURI=this.buildURI(file,fileType,isMojo,isMojoBundle);this.checkStaticLoaded(fileURI,fileType);var st=this.status,s=st[fileURI];if(!s){st[fileURI]={state:this.LOADING,callback:callback||function(){}};this.insertTag(fileURI,fileType);}else{if(s.state===this.LOADING){if(callback){var earlierCB=s.callback;s.callback=function(){if(earlierCB){earlierCB();}callback();};}}else{if(s===true||s.state===this.LOADED){if(callback){callback();}}}}}};microstrategy.cssLoader={get:function(file,isMojo,callback){microstrategy.resourceLoader.get(file,"css",isMojo,false,callback);}};microstrategy.jsLoader={get:function(file,isMojoBundle,callback,noBootstrap){if(!file){if(callback){callback();}return ;}if(isMojoBundle){var fnGetBundle=function(){if(mstrConfig.projectName&&mstrmojo.locales&&!mstrmojo.locales.isLoaded){mstrmojo.locales.load(function(){microstrategy.resourceLoader.get(file,"javascript",isMojoBundle,isMojoBundle,callback);});}else{microstrategy.resourceLoader.get(file,"javascript",isMojoBundle,isMojoBundle,callback);}};if(typeof mstrmojo=="undefined"&&!noBootstrap){microstrategy.resourceLoader.get("mojo-bootstrap.js","javascript",true,isMojoBundle,fnGetBundle);return ;}else{if(typeof mstrmojo!="undefined"){fnGetBundle();return ;}}}microstrategy.resourceLoader.get(file,"javascript",isMojoBundle,isMojoBundle,callback);}};microstrategy.descriptorsLoader={loadDescriptors:function(config){loadDescriptorBundle=function(){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(res){if(res){var dlen=res.descriptors.length,di;for(di=0;di<dlen;di++){var d=res.descriptors[di];mstrmojo.descriptors[d.key]=d.v;}}if(config.callback){config.callback();}},failure:function(){if(config.callback){config.callback();}}},{taskId:"getBundleDescriptors",bundle:config.bundle,localeID:microstrategy.displayLocaleID});};if(typeof mstrmojo=="undefined"&&!config.noBootstrap){microstrategy.jsLoader.get("mojo-bootstrap.js",true,function(){loadDescriptorBundle();});}else{loadDescriptorBundle();}}};microstrategy.mojoLoader={loadWidget:function(config){var me=this,loadDebugBundle=function(){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(res){var files=res.files;mstr.$A.forEach(files,function(f){microstrategy.dynamicJS.push({file:f.path,key:f.cls});});microstrategy.loadDynamicJS(null,true,function(){me.onload(config);me=null;});}},{taskId:"getBundles",bundles:config.bundle});},loadWholeBundle=function(){microstrategy.jsLoader.get(config.bundle,true,function(){me.onload(config);me=null;});},loadBundle=microstrategy.jsBundleDebug?loadDebugBundle:loadWholeBundle;if(typeof mstrmojo=="undefined"&&!config.noBootstrap){microstrategy.jsLoader.get("mojo-bootstrap.js",true,function(){mstrmojo.locales.load(function(){loadBundle();});},true);}else{loadBundle();}},onload:function(config){var w=mstrmojo.all[config.id];if(!w&&config.scriptClass){var sc=config.scriptClass,json=mstrmojo[sc];if(!json){mstrmojo.requiresCls("mstrmojo."+sc);json=mstrmojo[sc];if(!json){return ;}}w=mstrmojo.insert(json);if(!w){return ;}var p=config.placeholder;if(p){w.placeholder=p;}}if(config.callback){config.callback();}}};microstrategy.showWait=function(show){var div=microstrategy.waitIcon;if(!div){div=document.createElement("div");div.className="mstrIcon-wait-container";div.style.cssText="position:fixed;left:0; top:0; right:0; bottom:0; z-index:"+microstrategy.getMaxZIndex();div.innerHTML='<div class="mstrIcon-wait" style="position:absolute;top:48%;left:48%;z-index:10;"><div class="mstrIcon-close-wait" onmousedown="microstrategy.showWait(false)" title="Cancel"></div>';'</div><div class="mstrCurtain"></div>';microstrategy.waitIcon=document.body.appendChild(div);}div.style.display=show===false?"none":"block";};microstrategy.openCustomGroupEditor=function(customGroupId){if((bIsIE6&&!bIsIE7)||bIsIEQuirks){showMessage({contents:microstrategy.descriptors.getDescriptor("7914"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_INFO});return ;}microstrategy.showWait();var id="mstrCGE",_openCGE=function(c){c.scriptClass="mstrmojo.Obj";var m=mstrmojo.insert(c),w2=mstrmojo.all[id];if(!w2){return ;}w2.set("model",m);w2.open();microstrategy.showWait(false);},reqModel=function(){var cfg={success:function(res){if(!res){mstrmojo.alert("Error retrieving the Custom Group definition!");return ;}_openCGE(res);},failure:function(res){microstrategy.showWait(false);mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,cfg,{taskId:"getCustomGroup",customGroupId:customGroupId,styleName:"MojoCustomGroupStyle"});},newModel=function(){_openCGE({cgp:{agg:1,flat:false,pf:true,rfi:-1,ce:true,isp:true}});},m=window.mstrmojo,w=m&&m.all[id],getModel=customGroupId?reqModel:newModel;if(!w){microstrategy.mojoLoader.loadWidget({scriptClass:"CustomGroupEditor",id:id,bundle:"mojo-cge.js",callback:getModel});}else{getModel();}};microstrategy.openCustomSortEditor=function(attInfo){if((bIsIE6&&!bIsIE7)||bIsIEQuirks){showMessage({contents:microstrategy.descriptors.getDescriptor("7914"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_INFO});return ;}microstrategy.showWait();var id="mstrCSort",att=attInfo.att,did=att.dssId,dsId=att.dssSetId,mid=attInfo.mid,uKey=attInfo.uKey,openEditor=function(model){var editor=mstrmojo.all[id]||mstrmojo.insert({scriptClass:"mstrmojo.sort.CustomSortEditor",id:id});editor.set("model",model);editor.onSave=attInfo.onSave;editor.open();microstrategy.showWait(false);},getModel=function(){var callback={success:function(res){openEditor(res);},failure:function(res){microstrategy.showWait(false);mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}},params={taskId:"getCustomSort",msgID:mid,dsId:dsId,uKey:uKey,objectID:did};mstrmojo.xhr.request("GET",mstrConfig.taskURL,callback,params);},m=window.mstrmojo,w=m&&m.all[id];if(!w){microstrategy.mojoLoader.loadWidget({id:id,bundle:"mojo-CustomSort.js",callback:getModel});}else{getModel();}};microstrategy.openMetricEditor=function(metricId){microstrategy.showWait();var id="mstrMetricIDE",openMetricIDE=function(){var ide=mstrmojo.all[id];if(!ide){ide=mstrmojo.insert({id:id,metricId:metricId,scriptClass:"mstrmojo.ME.MetricIDE"});}else{ide.set("metricId",metricId);}ide.open(null,{action:{cmd:metricId?"edit":"add"}});microstrategy.showWait(false);};var m=window.mstrmojo,w=m&&m.all[id];if(!w){microstrategy.mojoLoader.loadWidget({bundle:"mojo-metric.js",id:id,callback:openMetricIDE});}else{openMetricIDE();}};microstrategy.openDataImport=function(config){var supportMsg="Data Import is not supported in your browser. We support Chrome 20+, Firefox 21+, Safari 5.1+ and Internet Explorer 8+. Please update your browser to import data.",isIE6,isIE7,isFF=ua.indexOf("Firefox")>-1,isChrome=ua.indexOf("Chrome")>-1,version=parseFloat(ua.replace(/.*?(Firefox|Chrome|MSIE\s|Version)\/?(\d+\.\d).*/,"$2")),docMode=document.documentMode,folderBone=microstrategy.bones.folderAllModes,curFolder=folderBone&&folderBone.folderId,me=this;if(!!document.all){if(window.mstrConfig&&mstrConfig.isEdgeModeEnabled){isIE6=!!ua.match(/MSIE 6/);isIE7=((!!ua.match(/MSIE 7/)&&!docMode)||docMode===7);}else{isIE6=!!ua.match(/MSIE 6/);isIE7=!!ua.match(/MSIE 7/)&&!ua.match(/Trident/);}}if(isIE6||isIE7||(isFF&&version<21)||(isChrome&&version<20)){var dataImportNotice=document.getElementById("dataImportError");if(!dataImportNotice){var elContent=document.getElementById("mstrWeb_content"),elNotice=document.createElement("div");elNotice.id="dataImportError";elNotice.className="session_recovery_msg";elNotice.innerHTML='<div class="message-before-grid warning"><div id="warning_session_timeout_countdownMsg">'+supportMsg+"</div></div>";elContent.parentNode.insertBefore(elNotice,elContent);}return ;}microstrategy.showWait();var openDI=function(){var di;if(me.dataImportId){di=mstrmojo.all[me.dataImportId];}if(!di){di=mstrmojo.insert({scriptClass:"mstrmojo.DI.DIContainer"});di.dataImportCallback=function(datasets){var f=document.getElementById("formRefresh");if(f&&datasets&&datasets.length>0){submitForm(f);}};me.dataImportId=di.id;}if(config){mstrmojo.hash.copy(config,di.dataImportParams);if(config.callback){di.dataImportCallback=function(datasets){config.callback(datasets);};}else{if(config.isCalledByFlex){di.dataImportCallback=function(datasets){if(datasets&&datasets.length>0){var MSTRFlash;if(navigator.appName.indexOf("Microsoft")!=-1){MSTRFlash=window.MstrFlashFlashViewer;}else{MSTRFlash=document.MstrFlashFlashViewer;}if(MSTRFlash){MSTRFlash.onCloseDI(datasets);}}};}}}if(curFolder){mstrmojo.hash.copy({cubeSaveFolderId:curFolder},di.dataImportParams);}di.open();microstrategy.showWait(false);};var checkSession=function(){var callback={success:function(res){if(res){openDI();}else{if(mstrApp.onSessionExpired){mstrApp.onSessionExpired();}}}},params={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,callback,params);};var getCss=function(){microstrategy.cssLoader.get("cge.css",true);if(mstr.utils.ISIE9||mstr.utils.ISIE9Pre){microstrategy.cssLoader.get("data-import-ie.css",true,checkSession);}else{microstrategy.cssLoader.get("data-import.css",true,checkSession);}};var getJSBundle=function(){microstrategy.mojoLoader.loadWidget({bundle:"mojo-di.js",callback:getCss});};if(!this.dataImportId){microstrategy.descriptorsLoader.loadDescriptors({bundle:"mojo-di",callback:getJSBundle});}else{checkSession();}};microstrategy.isDefaultTheme=function(thmid){return thmid===microstrategy.THEME_DARK_ID||thmid===microstrategy.THEME_LIGHT_ID;};microstrategy.hasAppliedTheme=function(elem,isLink){var id,thmlnk,viewerBone=microstrategy.getViewerBone(),elLimit=viewerBone.elem;while(elem&&elem!=elLimit){id=elem.id;thmlnk=id&&viewerBone.formattingAttributes[id]&&viewerBone.formattingAttributes[id]["thmlnk"];if(thmlnk===true||thmlnk===false){if(isLink){return thmlnk;}else{return true;}}else{elem=microstrategy.findAncestor(elem.parentNode);}}return false;};microstrategy.showSaveAsThemeEditor=function(){var $ID="saveAsThemeEditor",DssXmlDocSaveAsDefault=0,DssXmlDocSaveAsOverwrite=1,saveAsThemeEditor=window.mstrmojo&&mstrmojo.all[$ID],onThemeSaveAs=function(params,saveAsCB){microstrategy.showWait();mstrmojo.xhr.request("POST",mstrConfig.taskURL,saveAsCB,params);},initSaveAsThemeEditor=function(){microstrategy.showWait(false);saveAsThemeEditor=mstrmojo.insert({scriptClass:"mstrmojo.SaveAsEditor",id:$ID,title:mstrmojo.desc(14562,"Save Theme As"),searchVisible:false,displaySaveLabel:false,folderLinksContextId:36,showCompletePath:false,browsableTypes:"8,14082",cssClass:"mstrmojo-SaveAsEditor saveAsThemeEditor",saveParams:{taskId:"saveRWTheme"},typeDesc:mstrmojo.desc(12083,"Theme"),saveAs:function(overwrite){var panel=this.contPanel;this.name=panel.name.value;this.desc=panel.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var params=this.saveParams||{};params.msgID=mstrApp.getMsgID();params.folderID=this.ob.currentFolder.did;params.objName=this.name||"";params.objDesc=this.desc||"";params.saveAsFlags=!!overwrite?DssXmlDocSaveAsOverwrite:DssXmlDocSaveAsDefault;var saveAsCB=this.saveAsCallback();saveAsCB.failure=function(res){var ec=res.getResponseHeader("X-MSTR-TaskErrorCode"),p=this.parent;if(ec==="-2147217373"||ec==="-2147216857"){mstrmojo.warn(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",p.typeDesc||"Object").replace("###",p.name),{confirmBtn:{fn:function(){p.saveAs(true);}}},{title:mstrmojo.desc(3179,"Confirm Overwrite")});}else{var message=res.message||res.getResponseHeader("X-MSTR-TaskFailureMsg");if(ec==="-2147214579"){message=mstrmojo.desc(12587,"You do not have write access to this folder. Please select a different folder.");}mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+message);}};saveAsCB.complete=function(){microstrategy.showWait(false);};saveAsCB.parent=this;onThemeSaveAs(params,saveAsCB);}});saveAsThemeEditor.open();};var openEditor=function(){if(saveAsThemeEditor){saveAsThemeEditor.open();}else{microstrategy.showWait();microstrategy.jsLoader.get("mojo-theme.js",true,initSaveAsThemeEditor);}},closeFn=function(){microstrategy.showWait(false);};mstrmojo.confirm(mstrmojo.desc(14565,"Only formatting options set as Control Default will be saved into Document Theme."),null,{id:"confirmation_dialog",title:mstrmojo.desc(11812,"Notification"),allowHTML:true,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),openEditor,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),closeFn)],onPreClose:function(){closeFn();return true;}});};microstrategy.showApplyThemeEditor=function(showApplyAsOptions,applyAsLink,fnThemePicked){var $ID="applyThemeEditor",applyThemeEditor=window.mstrmojo&&mstrmojo.all[$ID],initApplyThemeEditor=function(){microstrategy.showWait(false);applyThemeEditor=mstrmojo.insert({scriptClass:"mstrmojo.CustomThemePicker",id:$ID,cssClass:"applyThemeEditor",zIndex:200,showApplyAsOptions:showApplyAsOptions,applyAsLink:!!applyAsLink,onThemePicked:fnThemePicked});applyThemeEditor.render();applyThemeEditor.open();};if(applyThemeEditor){applyThemeEditor.set("showApplyAsOptions",showApplyAsOptions);if(typeof applyAsLink==="boolean"){applyThemeEditor.set("applyAsLink",applyAsLink);}applyThemeEditor.onThemePicked=fnThemePicked;applyThemeEditor.open();}else{microstrategy.showWait();microstrategy.jsLoader.get("mojo-theme.js",true,initApplyThemeEditor);}};microstrategy.openACLEditor=function(cubeId,objType,config){var id="mstrACL",candidates=[],openACL=function(oi){var ae=mstrmojo.all[id];if(!ae){ae=mstrmojo.insert({scriptClass:"mstrmojo.DI.ui.dialogs.DIPermissionDialog",id:id,oi:oi,cubeid:cubeId,candidates:candidates});}else{ae.set("oi",oi);ae.cubeid=cubeId;ae.candidates=candidates;}ae.formTypes=oi.formTypes;ae.open();},requestData=function(){var cb={success:function(res){var attribute;mstrmojo.array.forEach(res.mapping.datap,function tableHandler(table){mstrmojo.array.forEach(table.maps&&table.maps.amps,function attributeHandler(mapping){attribute=mapping.aimp;if(mstrmojo.array.find(candidates,"did",attribute.atid)===-1){candidates.push({n:attribute.atnm,did:attribute.atid,t:12});}});});if(candidates.length===0){res.canEdit=0;}openACL(mstrmojo.DI.DICubesList.prototype.populateACLItems(res));},failure:function(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){iframe.hideWaitPage();}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,cb,{taskId:"DIGetCubeSecurityFilter",cubeid:cubeId,isNew:true});};iframe.showWaitPage();var ACLEditor=window.mstrmojo&&mstrmojo.all[id];if(ACLEditor){requestData();}else{microstrategy.jsLoader.get("mojo-di.js",true,requestData);}};microstrategy.showSharingEditor=function(href,objInfo,isLinkDirty,cfg){var $ID="sharingEditor",defaultOi=mstrApp.oi,objectID=(objInfo&&objInfo.objId)||defaultOi.objId,objectType=(objInfo&&objInfo.objType)||defaultOi.objType,messageId=(objInfo&&objInfo.mid)||mstrApp.getMsgID&&mstrApp.getMsgID(),showLinkOnOpen=cfg&&cfg.showLinkOnOpen,openSharingEditor=function(oi){var sharingEditor=mstrmojo.all[$ID];if(!sharingEditor){cfg=cfg||{};oi.acls=cfg.acls||oi.acls;sharingEditor=mstrmojo.insert(mstrmojo.hash.copy(cfg,{scriptClass:"mstrmojo.SharingEditor",guestModeEnabled:microstrategy.guestModeEnabled,mid:messageId,id:$ID,oi:oi,href:href,isLinkDirty:isLinkDirty,viewMode:objInfo?objInfo.viewMode:1,lastState:objInfo?objInfo.lastState:0,showWait:function(){iframe.showWaitPage();},hideWait:function hideWait(){iframe.hideWaitPage();}}));}else{sharingEditor.set("oi",oi);sharingEditor.href=href;sharingEditor.mid=messageId;sharingEditor.isLinkDirty=isLinkDirty;sharingEditor.viewMode=objInfo?objInfo.viewMode:1;sharingEditor.lastState=objInfo?objInfo.lastState:0;sharingEditor.showLinkOnOpen=showLinkOnOpen;}sharingEditor.open();},requestSharingEditor=function(){var cb={success:function(res){openSharingEditor(res.objects[0]);},failure:function(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){microstrategy.showWait(false);}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,cb,{taskId:"getObjectInfo",objectIDs:objectID,objectTypes:objectType,includeACL:microstrategy.isFeatureAvailable("web-use-sharing-editor"),sessionState:mstrApp.sessionState});};microstrategy.showWait();var sharingEditor=window.mstrmojo&&mstrmojo.all[$ID];if(sharingEditor){requestSharingEditor();}else{microstrategy.jsLoader.get("mojo-sharing.js",true,requestSharingEditor);}};microstrategy.openAdvSortEditor=function(params){var isDesignMode=params.isReportDesignMode||params.isDocDesignMode,tg=params.targetGrid,editorId="advancedSortEditor",advSortEditor=window.mstrmojo&&mstrmojo.all[editorId],editorController={beanPath:params.beanPath,stp:params.subtotalPosition,onAdvancedSort:function onAdvancedSort(view,sorts,stp,stt,rp){var i,j,sort,clearAll,sortClear,sortOrder,axis,action,stt=window.parseInt(stt,10),actionCollection=[],um=microstrategy.updateManager,isMetricSort=function(sortkey){var s=sortkey.split("!"),result=false;if(s.length>0&&s[0]==microstrategy.DSSTYPE_METRIC){result=true;}return result;};for(i=0;i<2;i++){if(sorts[i]!=null){axis=(i==0)?microstrategy.GRIDCELL_AXIS_ROWS:microstrategy.GRIDCELL_AXIS_COLUMNS;clearAll=true;sortClear="1";for(j=0;sort=sorts[i][j];j++){clearAll=false;sortOrder=sort.isAsc?"1":"0";if(isMetricSort(sort.key)&&!isNaN(stt)&&stt!=-1){action=um.createActionObject(null,mstrUpdateManager.VIEW_EVENT_HIERARCHICAL_METRIC_SORT,this.beanPath,["4011","4012","4013","4138","4262","4015","4123"],[sort.key,sortOrder,sortClear,this.stp[axis],rp,stt,1]);}else{action=um.createActionObject(null,mstrUpdateManager.VIEW_EVENT_SORT,this.beanPath,["4011","4012","4013","4138","4262"],[sort.key,sortOrder,sortClear,this.stp[axis],rp]);}actionCollection.push(action);sortClear="0";}if(clearAll){action=um.createActionObject(null,mstrUpdateManager.CLEAR_SORT,this.beanPath,["4006"],[axis]);actionCollection.push(action);}}}if(actionCollection.length>0&&um){if(params.isDocDesignMode){action=um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.beanPath,[],[],[],null);actionCollection.push(action);}um.add(actionCollection,true);um.flushAndSubmitChanges();}}},openAdvancedSortEditor=function(sortData){var e=mstrmojo.all[editorId]||mstrmojo.insert({scriptClass:"mstrmojo.AdvancedSortEditor",id:editorId,postCreate:function postCreate(){if(mstr.utils.ISIE8){mstrmojo.css.addWidgetCssClass(this,"ie8");}}});if(isDesignMode){sortData=params.sortData;}e.set("sortData",sortData);e.set("controller",editorController);e.set("xtab",null);e.set("sourceAxis",params.sourceAxis||1);e.set("sourceType",params.sourceType||-1);e.set("isDesignMode",isDesignMode);e.open();},callback={success:function(res){openAdvancedSortEditor((res.grids&&res.grids[0])||res);},failure:function(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){microstrategy.showWait(false);}},requestAdvancedSortEditor=function(){if(isDesignMode){openAdvancedSortEditor({});microstrategy.showWait(false);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,callback,params.taskParams);}};if(isDesignMode){var um=microstrategy.updateManager;if(um.newActions){um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,params.beanPath,[],[],[],null)]);um.flushAndSubmitChanges(false,{success:function(){window.setTimeout(function(){if(params.isDocDesignMode){microstrategy.bone("rwb_viewer").commands.exec("edtSortGrid",params.sourceAxis);}else{microstrategy.bone("UniqueReportID").commands.exec("sort",params.sourceAxis);}},1);}});return ;}var sortData={rows:[],cols:[],appliedRows:[],appliedCols:[]},getSortData=function(sortData){var i,j,unit,form,gsi=tg.gridStructureInfo,rowAxis=gsi.rowAxis,colAxis=gsi.colAxis,metricAxis=gsi.metricAxis,fnGetName=function(unit,gsi,form){var i,fm,formSize=unit.attFormList.forms.length;for(i=0;fm=unit.attFormList.forms[i];i++){if(fm[microstrategy.FORM_LIST_STATUS]==microstrategy.FORM_NOT_ON_WS){formSize--;}}if(formSize>1&&!gsi.showAttForms){return unit.alias+" ("+form[microstrategy.FORM_LIST_NAME]+")";}else{if(formSize>1){return unit.alias+" "+form[microstrategy.FORM_LIST_NAME];}}return unit.alias;};for(i=0;unit=rowAxis.units[i];i++){if(!unit.isMetricTemplateUnit&&unit.attFormList.forms){for(j=0;form=unit.attFormList.forms[j];j++){if(form[microstrategy.FORM_LIST_STATUS]!=microstrategy.FORM_NOT_ON_WS){sortData.rows.push({n:fnGetName(unit,gsi,form),v:unit.dssType+"!"+unit.dssId+"!"+form[microstrategy.FORM_LIST_ID]+"!"+microstrategy.DSSTYPE_ATTRIBUTE_FORM});}}}}for(i=0;unit=colAxis.units[i];i++){if(!unit.isMetricTemplateUnit&&unit.attFormList.forms){for(j=0;form=unit.attFormList.forms[j];j++){if(form[microstrategy.FORM_LIST_STATUS]!=microstrategy.FORM_NOT_ON_WS){sortData.cols.push({n:fnGetName(unit,gsi,form),v:unit.dssType+"!"+unit.dssId+"!"+form[microstrategy.FORM_LIST_ID]+"!"+microstrategy.DSSTYPE_ATTRIBUTE_FORM+"!!"+microstrategy.GRIDCELL_AXIS_COLUMNS});}}}}if(gsi.metricsAxis==microstrategy.GRIDCELL_AXIS_COLUMNS&&colAxis.units.length==1){for(i=0;unit=metricAxis.units[i];i++){sortData.rows.push({n:unit.alias,v:unit.dssType+"!"+unit.dssId+"!!!!"+microstrategy.GRIDCELL_AXIS_ROWS});}}sortData.appliedRows=tg.sortRules.appliedRows;sortData.appliedCols=tg.sortRules.appliedCols;sortData.hierarchicalSort=tg.hierarchicalSort;return sortData;};params.sortData=getSortData(sortData);}if(params.isReportDesignMode){if(!params.isReportBlank){params.taskParams.applyChanges="1";}else{showMessage({contents:"You must save this report before you can sort it.",elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"mstr.$obj('"+tg.id+"').commands.exec('dmSaveAs');",buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("118")},type:mstrMsgBoxImpl.MSG_WARNING});return ;}}microstrategy.showWait();if(advSortEditor){requestAdvancedSortEditor();}else{microstrategy.jsLoader.get("mojo-sort.js",true,requestAdvancedSortEditor);}};microstrategy.isFeatureAvailable=function(name){try{var __result=true;return((microstrategy.features!=null)&&typeof (microstrategy.features[name])!="undefined");}catch(err){microstrategy.errors.log(err);return false;}};microstrategy.setupPageMessageDisplay=function(){try{var el=document.getElementById("message-before-grid");if(el){var fnClose=function(){el.style.display="none";microstrategy.eventManager.notifyOrphanBones("onwinresize");};var x=document.createElement("img");x.src="../images/1ptrans.gif";x.title=microstrategy.descriptors.getDescriptor(2102);x.className="mstrIcon-btn mstrIcon-btnClose";x.style.cssText="position:absolute; right:1px; top:0; height:20px;width:20px;";x.onclick=fnClose;el.appendChild(x);var delay=3000,t=el.getAttribute("ty");switch(t){case"err":delay=3600*1000;break;case"sub":case"hl":delay=8000;}window.setTimeout(fnClose,delay);}}catch(err){microstrategy.errors.log(err);}};microstrategy.renderVis=function(data,props,extProps){if(!props||!props.scriptClass){alert("no mojo class defined");return ;}var id=props.id,renderVis=function(){props=mstrmojo.hash.copy(props,extProps);var w=mstrmojo.all[props.id];var setmodel=function f(){if(typeof (mstrmojo.Vis)!=="undefined"&&w instanceof mstrmojo.Vis){w.setModel(data);}else{var m=mstrmojo.insert({scriptClass:"mstrmojo.Obj",data:data});w.setModel(m);}w.render();};if(w&&w.scriptClass===props.scriptClass){mstrmojo.hash.copy(props,w);w.unrender();setmodel();}else{if(w){w.destroy();}mstrmojo.requiresCls(props.scriptClass);w=mstrmojo.insert(props);if(w){setmodel();}else{var tmr=window.setInterval(function(){w=mstrmojo.insert(props);if(w){window.clearInterval(tmr);setmodel();}},1000);}}};var m=window.mstrmojo,w=m&&m.all[id];if(!w){microstrategy.mojoLoader.loadWidget({bundle:props.bundle||"mojo-bootstrap.js",id:id,callback:renderVis});}else{renderVis();}};microstrategy.addCSRFTokenToURL=function(url){if(!url){return"";}var vrn=(window.microstrategy&&microstrategy.validateRandNum)||(window.mstrConfig&&mstrConfig.validateRandNum)||(window.mstrApp&&mstrApp.validateRandNum);if(vrn&&vrn.length>0){if(url.indexOf("validateRandNum")==-1){try{if(!microstrategy.isUrlExternal(url)){if(url.indexOf("?")>=0){url+="&";}else{url+="?";}url+="validateRandNum="+vrn;}}catch(err){}}}return url;};microstrategy.uploadDashboardFile=function(formId){var form=document.getElementById(formId),myFileInput=microstrategy.findChildWithAtt(form,"input","name","myFile"),file=myFileInput.value,resetFileInput=function(){if(mstr.utils.ISIE4){var fm=document.createElement("form");myFileInput.parentNode.insertBefore(fm,myFileInput);fm.appendChild(myFileInput);fm.reset();fm.removeNode(false);}};if(file==""){return ;}else{if(/\.mstr$/.test(file.toLowerCase())){microstrategy.showWait(true);addURLAsHiddenInputsToForm(form,microstrategy.addCSRFTokenToURL(microstrategy.servletName+"="+encodeURIComponent(microstrategy.servletState)));var folderAllModes=microstrategy.bones.folderAllModes;if(folderAllModes){var folderIDInput=document.getElementById("import_folderID");folderIDInput.value=folderAllModes.folderId;}if(!microstrategy.findChildWithAtt(form,"input","name","formId")){var formInput=document.createElement("input");formInput.type="hidden";formInput.name="formId";formInput.value=form.id;form.appendChild(formInput);}form.submit();form.reset();}else{mstr_descs=microstrategy.descriptors;showMessage({title:mstr_descs.getDescriptor(11226),contents:mstr_descs.getDescriptor(11227),type:mstrMsgBoxImpl.MSG_ERROR,elements:microstrategy.OK_BUTTON});}}resetFileInput();};microstrategy.uploadVisualizationFile=function(formId){var form=document.getElementById(formId),myFileInput=microstrategy.findChildWithAtt(form,"input","name","myFile"),file=myFileInput.value,resetFileInput=function(){if(mstr.utils.ISIE4){var fm=document.createElement("form");myFileInput.parentNode.insertBefore(fm,myFileInput);fm.appendChild(myFileInput);fm.reset();fm.removeNode(false);}};if(file==""){return ;}else{if(/\.zip$/.test(file.toLowerCase())){form.submit();form.reset();}else{mstr_descs=microstrategy.descriptors;showMessage({title:"Unrecognized file",contents:"Please select a file with .zip extension.",type:mstrMsgBoxImpl.MSG_ERROR,elements:microstrategy.OK_BUTTON});}}resetFileInput();};microstrategy.getExecuteDashboardUrl=function(documentId){var servletName=microstrategy.servletName,eventId,params;if(microstrategy.isFeatureAvailable("flashvi")){eventId=2048001;params={visMode:0};}else{eventId=3140;params={};}params.documentID=documentId;params.evt=eventId;params.src=servletName+"."+eventId;var paramArray=[];for(var k in params){if(!params.hasOwnProperty(k)){continue;}paramArray.push(encodeURIComponent(k)+"="+encodeURIComponent(params[k]));}return microstrategy.addCSRFTokenToURL(servletName+"?"+paramArray.join("&"));};microstrategy.uploadCallback=function(res){microstrategy.jsLoader.get("import-bundle.js",true,function(){var success=res.status==200,resContent=res.content,sn=microstrategy.servletName,mstr_descs=microstrategy.descriptors,updateAndSubmitForm=function(params){var form=document.getElementById(resContent.formId||"import_form"),newInputsAdded=[],i=0,formInput;mstrmojo.hash.forEach(params,function(value,key){if(key==="folderId"){if(mstr.utils.ISIE8){var folder_id=document.getElementById("import_folderID");if(folder_id){folder_id.value=value;}}}else{formInput=document.createElement("input");formInput.type="hidden";formInput.name=key;formInput.value=value;form.appendChild(formInput);newInputsAdded[i++]=formInput;}});window.setTimeout(function(){form.submit();for(var i=0;i<newInputsAdded.length;i++){form.removeChild(newInputsAdded[i]);}},0);};if(resContent&&resContent.messageID){var folderId=(resContent.fdid?resContent.fdid:"");if(resContent.isConflict){var replaceFn=function(){updateAndSubmitForm({messageID:resContent.messageID,resume:true});},saveAsFn=function(){var renameEditor=mstrmojo.insert({scriptClass:"mstrmojo.ui.editors.RenameEditor",renameText:resContent.n,title:mstrmojo.desc(13052,"Upload"),zIndex:1002,onRename:function(newName){if(mstrmojo.string.isEmpty(newName)){mstrmojo.alert("Please enter a valid name",null,null,1004);return false;}else{updateAndSubmitForm({messageID:resContent.messageID,resume:true,dashboardName:newName});var conflictDialog=mstrmojo.all.ImportNameConflictDialog;if(conflictDialog){conflictDialog.destroy();}}}});renameEditor.open();return false;},closeFn=function(){microstrategy.showWait(false);};mstrmojo.confirm(mstrmojo.desc(8134,"The Dashboard ## already exists. Do you want to replace the existing Dashboard?").replace("##",("<strong>"+resContent.n+"</strong>")),null,{id:"ImportNameConflictDialog",title:mstrmojo.desc(13052,"Upload"),allowHTML:true,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(219,"Yes"),replaceFn,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3167,"Save As"),saveAsFn,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),closeFn)],onPreClose:function(){closeFn();return true;}});}else{updateAndSubmitForm({messageID:resContent.messageID,folderId:folderId});}}else{if(success){var okUrl=microstrategy.addCSRFTokenToURL(sn+"?evt=2001&src="+sn+".2001"+((resContent&&resContent.fdid)?("&folderID="+resContent.fdid):"&systemFolder=20")),dashboarUrl=microstrategy.getExecuteDashboardUrl(resContent.did),closeAndLoadUrl=function(url){if(this.parent===null&&this.close){this.close();}else{this.parent.parent.close();}eval(url);};viewDashboardFn=mstrmojo.emptyFn,shareDashboardFn=function(){microstrategy.showSharingEditor(resContent.servletPath+dashboarUrl,{objectName:resContent.n,objId:resContent.did,objType:"55",mid:-1},false,{showLinkOnOpen:true});};if(!microstrategy.isFeatureAvailable("flashvi")&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){viewDashboardFn=function(){closeAndLoadUrl.call(this);mstrmojo.alert(mstr_descs.getDescriptor(12187));};}else{viewDashboardFn=function(){closeAndLoadUrl.call(this,"location.href = '"+dashboarUrl+"'");};}var folderAllModes=microstrategy.bones.folderAllModes;var uploadResultEditor=mstrmojo.insert({scriptClass:"mstrmojo.onetier.vi.ui.UploadResultEditor",folderName:((folderAllModes&&folderAllModes.folderName)||"My Reports"),dashboardName:resContent.n,okFn:function(){closeAndLoadUrl.call(this,"location.href = '"+okUrl+"'");},viewDashboardFn:viewDashboardFn,shareDashboardFn:shareDashboardFn});uploadResultEditor.open();}else{mstrmojo.error({longDesc:res.errorMsg});}microstrategy.showWait(false);}},false);};microstrategy.addRecentObjectInfo=function(recentObjectInfo){var localStorage=window.localStorage,ss=window.sessionStorage;if(!localStorage||!window.JSON){return ;}var recentObjectsKey="recentObjects"+mstrConfig.lastMsgKey,recentObjects=localStorage.getItem(recentObjectsKey)||[];if(recentObjects.length===0){recentObjects.push(recentObjectInfo);localStorage.setItem(recentObjectsKey,JSON.stringify(recentObjects));}else{var updateRecentObjects=JSON.parse(recentObjects);updateRecentObjects.unshift(recentObjectInfo);var newLength=updateRecentObjects.length;if(newLength>20){updateRecentObjects.splice(-1,(newLength-20));}localStorage.setItem(recentObjectsKey,JSON.stringify(updateRecentObjects));}};microstrategy.clearRecentObjects=function(){var ls=window.localStorage,ss=window.sessionStorage;if(!ls||!window.JSON){return ;}ls.removeItem("recentObjects"+mstrConfig.lastMsgKey);};microstrategy.getRecentObjectsCount=function(){var ls=window.localStorage,ss=window.sessionStorage;if(!ls||!window.JSON){return ;}var recentObjects=JSON.parse(ls.getItem("recentObjects"+mstrConfig.lastMsgKey))||[];return recentObjects.length;};microstrategy.handleRecentObjects=function(){try{var ls=window.localStorage,ss=window.sessionStorage;if(!ls||!window.JSON){return ;}var recoveryObjects=[];var objectAdded=function(newObject){var i,isAdded=false;for(i in recoveryObjects){if(recoveryObjects[i].lastRecovered){continue;}if(recoveryObjects[i].did===newObject.did){isAdded=true;break;}}return isAdded;};var getObjectIDString=function(type){var objectIDString="";switch(type){case 3:objectIDString="reportID=";break;case 55:objectIDString="documentID=";break;default:objectIDString="messageID=";break;}return objectIDString;};var getIconClass=function(recoveryInfo){var type=recoveryInfo.ty;var iconClass="";switch(type){case 55:var vm=recoveryInfo.vm;switch(vm){case 8192:case 2048:iconClass="mstrIcon-lv-rw avm";break;case 1:default:iconClass="mstrIcon-lv-rw";break;}break;case 3:var viewMode=recoveryInfo.viewMode;switch(viewMode){case 1:iconClass="mstrIcon-lv-g";break;case 2:iconClass="mstrIcon-lv-gp";break;case 3:iconClass="mstrIcon-lv-gpgs";break;default:iconClass="";break;}break;}return iconClass;};var recentObjects=JSON.parse(ls.getItem("recentObjects"+mstrConfig.lastMsgKey));try{var msgKey=mstrConfig.lastMsgKey,lastMsgID=(JSON.parse(decodeURIComponent(microstrategy.getCookieSetting("lastMsgID")||"{}")))[msgKey],isValidMsgID=function(msgId){return msgId&&(msgId.length===32)&&/^[A-Z0-9]{32}$/.test(msgId);};}catch(e){}if(isValidMsgID(lastMsgID)){var recoveryObject={};var recoveryInfoKey="lastMsgRecoveryInfo"+msgKey,recoveryInfo=ls.getItem(recoveryInfoKey);if(recoveryInfo){var recoveryInfo=JSON.parse(recoveryInfo);recoveryObject.recoveryInfo=recoveryInfo;recoveryObject.recoveryURL=microstrategy.addCSRFTokenToURL("?"+recoveryInfo.url.replace(/messageID.*/,"messageID="+lastMsgID)),recoveryObject.recoveryName=recoveryInfo.n;recoveryObject.recoveryType=recoveryInfo.ty;recoveryObject.did=recoveryInfo.did;recoveryObject.iconClass=getIconClass(recoveryInfo);recoveryObject.lastRecovered=true;recoveryObjects.push(recoveryObject);}}for(var i in recentObjects){var recentObject=recentObjects[i];if(recentObject===""){continue;}var recoveryObject={};var recoveryInfo=JSON.parse(recentObject);recoveryObject.recoveryInfo=recoveryInfo;recoveryObject.recoveryURL=microstrategy.addCSRFTokenToURL("?"+recoveryInfo.url.replace(/messageID.*/,getObjectIDString(recoveryInfo.ty)+recoveryInfo.did));recoveryObject.recoveryName=recoveryInfo.n;recoveryObject.recoveryType=recoveryInfo.ty;recoveryObject.did=recoveryInfo.did;recoveryObject.iconClass=getIconClass(recoveryInfo);recoveryObject.lastRecovered=false;if(!objectAdded(recoveryObject)){recoveryObjects.push(recoveryObject);}}return recoveryObjects;}catch(err){microstrategy.errors.log(err);}};microstrategy.handleLastMessageRecovery=function(){try{var ls=window.localStorage,ss=window.sessionStorage;if(!ls||!window.JSON){return ;}if(!microstrategy.enableAutomaticSessionRecovery){return ;}if(!microstrategy.showRecoverLink){return ;}try{var msgKey=mstrConfig.lastMsgKey,lastMsgCookie="lastMsgID",lastMsgID=(JSON.parse(decodeURIComponent(microstrategy.getCookieSetting("lastMsgID")||"{}")))[msgKey],isValidMsgID=function(msgId){return msgId&&(msgId.length===32)&&/^[A-Z0-9]{32}$/.test(msgId);};}catch(e){return ;}var browserClosed=ss.getItem("msg_browser_not_closed"+msgKey)===null;var justLoggedIn=ss.getItem("msg_user_login")==1;ss.setItem("msg_user_login",0);var notNotifiedYet=ls.getItem("msg_recovery_notify"+msgKey)==="1";ls.setItem("msg_recovery_notify"+msgKey,"0");if(!isValidMsgID(lastMsgID)){return ;}var SESSION_RESULT_CODES={LIVE_OR_HL:0,PERSISTED:1},resCode=parseInt(microstrategy.getCookieSetting("sessionResCode"),10),browserClosedAndNoLiveSession=browserClosed&&resCode===SESSION_RESULT_CODES.PERSISTED;var recoveryInfoKey="lastMsgRecoveryInfo"+msgKey,recoveryInfo=ls.getItem(recoveryInfoKey);if(!recoveryInfo){return ;}recoveryInfo=JSON.parse(recoveryInfo);var recoveryURL=microstrategy.addCSRFTokenToURL("?"+recoveryInfo.url.replace(/messageID.*/,"messageID="+lastMsgID)),recoveryName=recoveryInfo.n,recoveryTypeDescId=recoveryInfo.typeDescId,updateRecoveryLink=function(){var elLink=document.getElementById("mstr-auto-recovery-link");if(elLink&&recoveryName){var n=microstrategy.descriptors.getDescriptor("11866").replace("#",recoveryName);elLink.href=recoveryURL;elLink.innerHTML=n;elLink.style.display="";elLink.parentNode.title=n;elLink.parentNode.style.display="";}},showNotification=function(){if(!browserClosedAndNoLiveSession&&notNotifiedYet&&recoveryName&&justLoggedIn){var elContent=document.getElementById("mstrWeb_content"),elNotice=document.createElement("div");elNotice.className="session_recovery_msg";elNotice.innerHTML='<div class="message-before-grid warning"><div id="warning_session_timeout_countdownMsg">'+microstrategy.descriptors.getDescriptor(11867).replace("####",'<a href="'+recoveryURL+'">').replace("###","</a>").replace("##","<b>"+recoveryName+"</b>").replace("#",microstrategy.descriptors.getDescriptor(recoveryTypeDescId))+"</div></div>";elContent.parentNode.insertBefore(elNotice,elContent);}ls.setItem("msg_recovery_notify"+msgKey,"0");ss.setItem("msg_user_login",0);},removeRecoveryInfo=function(){var cookie=JSON.parse(decodeURIComponent(microstrategy.getCookieSetting(lastMsgCookie)||"{}"));microstrategy.updateCookieSetting(lastMsgCookie,JSON.stringify(cookie,function(k,v){return k==msgKey?undefined:v;}));ls.removeItem(recoveryInfoKey);};if(!recoveryName){removeRecoveryInfo();return ;}if(resCode===SESSION_RESULT_CODES.PERSISTED){updateRecoveryLink();showNotification();}else{if(resCode===SESSION_RESULT_CODES.LIVE_OR_HL){mstr.$XHR.request(mstrConfig.taskURL,{taskId:"docXMLResults",msgID:lastMsgID,resultFlags:33554432},{success:function(res){updateRecoveryLink();showNotification();},failure:function(res,resCode){if(resCode===2147498310){removeRecoveryInfo();}}});}}}catch(err){microstrategy.errors.log(err);}};microstrategy.newDatasetObjectsBlock=function(ondblclickTN){var dso=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"DAE-RWD-ObjectBrowser-container",visible:false,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2870,"Objects")},{scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",cssClass:"DAE-RWD-ObjectBrowser",bindings:{items:"this.parent.datasets"},item2textCss:function item2textCss(data){var textCss={3:"rpt",4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[data.t]||"";if(data.da||data.um||data.rdm){textCss+=" derived";}return textCss;},itemFunction:function(item,idx,wgt){var i=mstrmojo.WidgetTree.prototype.itemFunction(item,idx,wgt);i.state=!!item.items?1:2;if(i.state===2){i.draggable=true;i.getDragData=function(){return{item:item,html:i.domNode.outerHTML};};}return i;},onnodemousedown:function onnodemousedown(evt){var hWin=evt.hWin,e=evt.e,el=mstrmojo.dom.eventTarget(hWin,e),w=mstrmojo.dom.findWidget(el);if(w){if(dso.selectNode){dso.selectNode.set("selected",false);}dso.selectNode=w;w.set("selected",true);}},ondblclick:function ondblclick(){var w=dso.selectNode;if(w.state===2){ondblclickTN(w.data);}}}]});return dso;};microstrategy.hasCGorCon=function hasCGorCon(dataset){return mstr.$A.filter(dataset.att,{filter:function(unit){var isCGorConsolidation=(unit.t===1||unit.t===47),isOldDE=(unit.t===12&&unit.de),isNDE=(unit.t===47&&unit.st===12033);return(isCGorConsolidation&&!isNDE||isOldDE);}},"filter").length>0;};microstrategy.openDerivedAttrEditor=function(config){config.isDM=false;config.wid="mstrDerivedAttrIDE";config.sc="mstrmojo.ME.DerivedAttributeIDE";config.wrapperClz="mstrmojo-DerivedAttrIDE-rwd";microstrategy._openDADMEditor(config);};microstrategy.openDerivedMetricEditor=function(config){config.isDM=true;config.wid="mstrMetricIDE";config.sc="mstrmojo.ME.DerivedMetricIDE";config.wrapperClz="mstrmojo-DerivedMetricIDE-rwd";microstrategy._openDADMEditor(config);};microstrategy._openDADMEditor=function(config){var id=config.wid,w=window.mstrmojo&&mstrmojo.all[id],viewerBone=microstrategy.getViewerBone(),prepareDssTree=function(datasets){var dsst=[],ds,dsid,dsn;for(dsid in datasets){ds=datasets[dsid];if(!config.isDM&&(ds.isMDX&&ds.isDDA||microstrategy.hasCGorCon(ds))){continue;}var filteredAtts=mstrmojo.array.filter(ds.att,function(item){return item.st!==mstrmojo.expr.STP.CONS&&item.st!==mstrmojo.expr.STP.CUSTOMGROUP&&(item.st!==mstrmojo.expr.STP.NDE||item.st===mstrmojo.expr.STP.NDE&&config.isDM)&&item.did!==config.metricId;}),filteredMxs=mstrmojo.array.filter(ds.mx,function(item){return !item.um&&!item.rdm;});dsn={n:ds.name,did:ds.did,t:3,items:[].concat(filteredAtts).concat(!config.isDM&&ds.isMDX?[]:(config.isDM?ds.mx:filteredMxs))};dsst.push(dsn);}dsst.sort(function(a,b){return mstrmojo.array.stringSorter(a.n,b.n);});return dsst;},openEditor=function(){if(!w){w=mstrmojo.insert({id:id,scriptClass:config.sc,datasetsObjects:microstrategy.newDatasetObjectsBlock(function(item){w.onObjectInsert(item);}),zIndex:4,postCreate:function postCreate(){mstrmojo.css.addWidgetCssClass(this,config.wrapperClz);if(viewerBone){this.attachEventListener("visibleChange",this.id,function(){if(!this.visible){viewerBone.mojoEditor--;}});}}});}w.datasetsObjects.set("datasets",prepareDssTree(config.datasets));if(config.isDM){if(config.dsid){config.disableAFB=config.datasets[config.dsid].isMDX;}w.open(null,config);}else{if(config.onAttribute){var onAttribute=config.onAttribute,dfm=onAttribute.fs&&onAttribute.fs[0];if(dfm){config.funccat=mstrmojo.ME.DerivedAttributeIDE.getDefaultFunctionCategory(onAttribute);config.refOi={n:onAttribute.n+"@"+dfm.fnm,did:onAttribute.did+"@"+dfm.fid};}}config.cmd="editNew";w.action=config;w.open(null,{editorId:w.action.id});}if(viewerBone){viewerBone.mojoEditor=(viewerBone.mojoEditor||0)+1;}microstrategy.showWait(false);};if(!w){microstrategy.showWait();microstrategy.mojoLoader.loadWidget({bundle:"mojo-dae.js",id:id,callback:openEditor});}else{openEditor();}};microstrategy.submitHyperlink=function submitHyperlink(oAnchor){var sURL=oAnchor.getAttribute("hv")||oAnchor.href,sTarget=oAnchor.target;if(microstrategy.isUrlExternal(sURL)){return true;}var oForm=document.createElement("FORM");oForm.name="dynamic_form";oForm.method="POST";var hasParameters=sURL.indexOf("?")>0,formAction=((hasParameters)?sURL.substring(0,sURL.indexOf("?")):sURL);oForm.action=formAction;if(hasParameters){addURLAsHiddenInputsToForm(oForm,sURL);}document.body.insertAdjacentElement("beforeEnd",oForm);if(sTarget){oForm.target=sTarget;}oForm.submit();if(window.event){window.event.cancelBubble=true;}return false;};microstrategy.addJSessionID=function addJSessionID(url){var m=microstrategy;if(!!m.addJSessionIdToURL&&m.httpSessionId&&url.indexOf("jsessionid=")==-1){return url+";jsessionid="+m.httpSessionId;}return url;};microstrategy.allowCreateReport=function(cubeInfo){if(cubeInfo&&cubeInfo.ddam===2){showMessage({contents:microstrategy.descriptors.getDescriptor(13384),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_INFO});return false;}return true;};microstrategy.convertFromCube=function(config){var me=this,type=config.type,dsid=config.dsid,isJsonMode=config.isJsonMode,folderBone=microstrategy.bones.folderAllModes,curFolder=folderBone&&folderBone.folderId;microstrategy.getCubesInfo([dsid],function(cubesInfo){var cubeInfo=cubesInfo[dsid],servlet=microstrategy.servletName,dda=(cubeInfo&&!cubeInfo.published&&microstrategy.isCubeSupportDDA(cubeInfo)),extraCreateFlags=!!dda?128:0,params={};if(cubeInfo&&cubeInfo.ddam!==2&&!cubeInfo.published){showMessage({contents:microstrategy.descriptors.getDescriptor(14111),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,buttonLabels:{Ok:microstrategy.descriptors.getDescriptor(9242)},okEval:function(){if(config.st===779&&(config.et&microstrategy.EXTENDED_TYPE_DATA_IMPORT)>0){me.openDataImport({CubeDesc:"",CubeName:config.executeReport,ReportId:config.dsid,StatusCode:2,isEdit:false,callback:function(){me.convertFromCube(config);}});}else{submitCM(config.executeReport,false);}},type:mstrMsgBoxImpl.MSG_ERROR});return ;}switch(type){case"document":params={evt:"3104",src:servlet+".3104",executionMode:"2",rwDesignMode:"1",objectType:"3",objectID:dsid,rwCreateFlags:0};if(curFolder){params.saveFolderId=curFolder;}break;case"analysis":params={evt:"3104",src:servlet+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:dsid,rwCreateFlags:16,rwViewMode:8192};break;case"HTML5VI":params={evt:"3185",src:servlet+".3185",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:dsid,rwCreateFlags:32};if(isJsonMode===false){params.jsonMode=false;}if(curFolder){params.saveFolderId=curFolder;}break;case"report":if(!microstrategy.allowCreateReport(cubeInfo)){return ;}params={evt:"3005",src:servlet+".3005",srcID:dsid,srcType:2,reportDesignMode:1};break;}if(typeof params.rwCreateFlags==="number"){params.rwCreateFlags|=extraCreateFlags;}var key,array=[],link=microstrategy.servletName+"?";for(key in params){if(params.hasOwnProperty(key)){array.push(key+"="+params[key]);}}link+=array.join("&");submitCM(link,false);});};microstrategy.createReportFromCube=function(config){var dsid=config.dsid,form=config.form;microstrategy.getCubesInfo([dsid],function(cubesInfo){var cubeInfo=cubesInfo[dsid];if(!microstrategy.allowCreateReport(cubeInfo)){return ;}form.submit();});};microstrategy.isUrlExternal=function isUrlExternal(url){var curURL=window.location.href;var isSameWebApp=(url.indexOf("?")===0||url.indexOf(microstrategy.servletName)===0||url.indexOf("./"+microstrategy.servletName)===0||url.indexOf(mstrConfig.taskURL)===0||url.indexOf("./"+mstrConfig.taskURL)===0||url.indexOf(curURL)===0||((curURL.indexOf("?")>0)&&(url.indexOf(curURL.substring(0,curURL.indexOf("?")))===0)));return !isSameWebApp;};microstrategy.scrollPageHorizontally=function(mouseX){try{var threshold=30,diff=lMouseX-getClientWidth(),scrollLeft=document.documentElement.scrollLeft||document.body.scrollLeft,delta=lMouseX-scrollLeft<threshold?-threshold:(diff>-threshold?threshold:0);document.documentElement.scrollLeft+=delta;document.body.scrollLeft+=delta;}catch(err){microstrategy.errors.log(err);}};microstrategy.submitForm=function(oForm,showWait){if(showWait!==false){iframe.showWaitPage();showWait=true;}oForm.submit();if(showWait){iframe.hideWaitPage();}};microstrategy.initFolderNavigationListener=function(){if(!window.onpopstate){window.onpopstate=function(){if(this.needToIgnorePop===undefined){this.needToIgnorePop=mstr.utils.ISSAFARI;}if(this.needToIgnorePop){this.needToIgnorePop=false;return ;}var url=document.URL;if(history.state&&history.state.target){var target=history.state.target;url=history.state.href;url=replaceURLParameter(url,"iframe","true");if(target=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){if(!bIsIE7||document.readyState=="complete"){var oForm=createDynamicForm(url);if(target){oForm.target=target;}}submitForm(oForm);}return false;}else{window.open(url,"_self");}};}};microstrategy.initReportNavigationListener=function(){if(!window.onpopstate&&history.pushState){window.onpopstate=function(){if(this.needToIgnorePop===undefined){this.needToIgnorePop=mstr.utils.ISSAFARI;}if(this.needToIgnorePop){this.needToIgnorePop=false;return ;}if(window.mstrSubmitLink){window.mstrSubmitLink=false;event.stopImmediatePropagation();return ;}var wls=window.localStorage,historyIndex=parseInt((history.state&&history.state.index),10)||0,index=(wls.getItem("nlli"));wls.setItem("nlli",historyIndex);if(microstrategy.bones.pathBean_ReportPathStyle){microstrategy.bones.pathBean_ReportPathStyle.commands.exec("openPage",(historyIndex<=index)?"-1":"1");}};var url=document.URL,simpleURL=url.split(/[?#]/)[0];historyIndex=parseInt((history.state&&history.state.index),10)||0;history.pushState({target:url,href:url,index:historyIndex},simpleURL,simpleURL);}};microstrategy.tryNewHome=function(){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(res){mstrmojo.form.send({evt:"3010",src:mstrApp.name+".3010"});}},{taskId:"setPreference",prefs:"startPage\u001E3194"});};microstrategy.loadIframeIdle=function(){var f=createDynamicForm(microstrategy.addCSRFTokenToURL(microstrategy.servletName+"?pg=iframeIdle"));f.target="frameManager";microstrategy.submitForm(f,false);document.body.removeChild(f);};
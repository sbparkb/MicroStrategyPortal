function util_alignColumnHeaderCell(col,width){col.style.width=width+"px";if(mstr.utils.ISIE4&&!mstr.utils.ISIE8&&!(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){if(width==0){col.style.display="none";}else{col.style.display="";}var fn=function(){var newWidth=col.offsetWidth;if(newWidth!=width){col.style.width=Math.max(parseInt(col.style.width)+width-newWidth,0)+"px";}};window.setTimeout(fn,0);}}function util_convert2Px(dom,v){if(mstr.utils.ISIE8&&!/px$/.test(v)){var img=document.createElement("img"),pl;img.style.zIndex=-1;img.style.left=v;dom.appendChild(img);pl=img.style.pixelLeft;dom.removeChild(img);return pl+"px";}return v;}function util_getBorderWidth(cell,which){var border="border-"+which+"-width",width=mstr.utils.CSS.getStyleValue(cell,border),unit=mstrNumber["UNIT_"+width.substring(width.length-2,width.length).toUpperCase()];if(unit){width=(parseFloat(microstrategy.number.convertUnit(unit,mstrNumber.UNIT_PX,width))||0);}return width;}function util_getCellPadding(cell,which){return parseFloat(mstr.utils.CSS.getStyleValue(cell,"padding-"+which));}function util_getRowHeight(row){if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var cells=row.cells,cell=null;if(row.style.height){return parseFloat(row.style.height);}var h=0;for(var i=0;i<cells.length;i++){cell=cells[i];var border=util_getBorderWidth(cell,"top")+util_getBorderWidth(cell,"bottom");var padding=util_getCellPadding(cell,"top")+util_getCellPadding(cell,"bottom");if(cell.getAttribute("rowspan")==null){h=Math.max(h,parseFloat((mstr.utils.CSS.getStyleValue(cell,"height")))+border+padding);}}if(cell){if(!row.getAttribute("o")){return getObjOuterHeight(row);}return h;}}return mstr.utils.ISIE8?getObjInnerHeight(row):getObjOuterHeight(row);}function util_getCellWidth(cell){if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var w=(parseFloat(mstr.utils.CSS.getStyleValue(cell,"width")));w=w==0?w:(w+(parseFloat(mstr.utils.CSS.getStyleValue(cell,"padding-right"))||0)+(parseFloat(mstr.utils.CSS.getStyleValue(cell,"padding-left"))||0)+util_getBorderWidth(cell,"left")+util_getBorderWidth(cell,"right"));return w+((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&cell.parentNode.getAttribute("o")?0.1:0);}return getObjOuterWidth(cell);}function util_serRowHeight(row,height,isOutlineMode){row.style.height=height+"px";if(mstr.utils.ISSAFARI){var cells=row.cells;for(var j=0;j<cells.length;j++){cells[j].style.height=height+"px";}}if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&isOutlineMode){var cells=row.cells;if(cells&&cells[0]){window.setTimeout(function(){cells[0].style.height=(height-util_getBorderWidth(cells[0],"top")-util_getBorderWidth(cells[0],"bottom"))+"px";},100);}}if(mstr.utils.ISIE4&&(!((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)))){var fn=function(){var newHeight=util_getRowHeight(row);if(newHeight!=height){row.style.height=Math.max(2*height-newHeight,0)+"px";}};window.setTimeout(fn,0);}}function util_getRowHeight(row){if((mstr.utils.ISIE9||mstr.utils.ISIE10)){var cells=row.cells,cell=null;if(row.style.height){return parseFloat(row.style.height);}var h=0;for(var i=0;i<cells.length;i++){cell=cells[i];var border=util_getBorderWidth(cell,"top")+util_getBorderWidth(cell,"bottom");var padding=util_getCellPadding(cell,"top")+util_getCellPadding(cell,"bottom");if(cell.getAttribute("rowspan")==null){h=Math.max(h,parseFloat((mstr.utils.CSS.getStyleValue(cell,"height")))+border+padding);}}if(cell){if(!row.getAttribute("o")){return getObjOuterHeight(row);}return h;}}return mstr.utils.ISIE8?getObjInnerHeight(row):getObjOuterHeight(row);}function util_getBorderWidth(cell,which){var border="border-"+which+"-width",width=mstr.utils.CSS.getStyleValue(cell,border),unit=mstrNumber["UNIT_"+width.substring(width.length-2,width.length).toUpperCase()];if(unit){width=(parseFloat(microstrategy.number.convertUnit(unit,mstrNumber.UNIT_PX,width))||0);}return width;}function util_getCellPadding(cell,which){return parseFloat(mstr.utils.CSS.getStyleValue(cell,"padding-"+which));}function util_getHeaderColumnLeftPosition(oTable){var leftPos=util_getHeaderColumnHelper(oTable,"getObjOffsetLeft");return leftPos;}function util_getHeaderColumnWidths(oTable){if(!mstr.utils.ISWK&&!mstr.utils.ISIE8&&!(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var arr=[];if(!oTable){return arr;}var oCOLs1=oTable.getElementsByTagName("COL");if(oCOLs1&&oCOLs1.length){var iCols=oCOLs1.length;for(var i=0;i<iCols;i++){arr.push(getObjOuterWidth(oCOLs1[i]));}}return arr;}return util_getHeaderColumnHelper(oTable,"util_getCellWidth");}function util_getHeaderColumnHelper(oTable,func){var arr=[];if(!oTable){return arr;}var trs=oTable.rows,idx,tr=trs&&trs[0],colStart=0;for(idx=0;idx<trs.length;idx++){if(trs[idx].cells.length!==0){tr=trs[idx];break;}}var getSpan=function(td,name){var span=td.getAttribute(name);return span==null?1:parseInt(span);};var getFixedColWidth=function(oTable,idx){var w=null;var colgroups=oTable.getElementsByTagName("colgroup");var colgroup=colgroups&&colgroups[0];if(colgroup&&colgroup.childNodes[idx]){w=parseFloat(colgroup.childNodes[idx].style.width);}return w;};var adjustPaddingForTD=function(td){var pr=0;if((mstr.utils.ISIE7||mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))&&!td.parentNode.getAttribute("o")&&!td.getAttribute("p")){td.setAttribute("p",1);pr=((parseFloat(util_convert2Px(td,mstr.utils.CSS.getStyleValue(td,"paddingRight")))||0)+((mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))?1:0));td.style.paddingRight=((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)?pr:Math.ceil(pr))+"px";}};var pushWidths=function(tr,colStart){var tds=tr.cells,colGap=0;for(var k=0,td_size=tds.length;k<td_size;k++){var colSpan=getSpan(tds[k],"colspan");if(colSpan==1){arr[colStart+k+colGap]=((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&func=="util_getCellWidth")?getFixedColWidth(oTable,colStart+k+colGap)||window[func](tds[k]):window[func](tds[k]);}else{var spanWidth=0;for(j=colStart+k+colGap+1;j<colStart+k+colGap+colSpan;j++){spanWidth+=arr[j];}arr[colStart+k+colGap]=window[func](tds[k])-spanWidth;colGap+=colSpan-1;}}};var addToDataRow=function(tr,dr){var c,n,len,tc,rs,drc=dr.cells,cells=tr.cells;for(n=0,len=drc.length;n<len;n++){rs=getSpan(drc[n],"rowspan");if(rs===1){break;}}for(c=0,len=cells.length;c<len;c++){tc=cells[c];if(tc.getAttribute("CTY")=="3"){return false;}else{drc[n++]=tc;}}return true;};if(trs.length>0){var tds=tr.cells;for(var j=0,td_size=tds.length;j<td_size;j++){var colSpan=getSpan(tds[j],"colspan");arr.push(window[func](tds[j]));while(colSpan-->1){arr.push(0);}}}var lastHeader=null,dataRow=null,cells=[],mergedObj={colStart:0,rowSpan:1},lastLevel=0,lastHdrRow=0;for(var i=idx+1,tr_size=trs.length;i<tr_size;i++){var localLevel=trs[i].getAttribute("level");if(!trs[i].getAttribute("o")){var curCell=trs[i].cells[0];if(curCell&&(curCell.getAttribute("oty")=="12"||curCell.getAttribute("MH"))){lastHeader=trs[i];lastHdrRow=i;}else{lastHdrRow=i;}}else{if(!localLevel&&trs[i].getAttribute("o")){if(!dataRow){dataRow={cells:[]};}if(addToDataRow(trs[i],dataRow)){break;}}else{if(localLevel){if(localLevel<=lastLevel&&trs[i].style.display!="none"){dataRow=trs[i-1];break;}else{lastLevel=localLevel;}}}}}if(lastHeader){for(var i=idx,len=lastHdrRow;i<=len;i++){tds=trs[i].cells;for(var j=0,tds_length=tds.length;j<tds_length;j++){var cs=getSpan(tds[j],"rowspan");if(cs>lastHdrRow){colStart+=getSpan(tds[j],"colspan");}else{break;}}}pushWidths(lastHeader,colStart);}var getDataRow=function getDataRow(){var i,j,tds,cs,p,td_size,tr_size=trs.length,drc=dataRow&&dataRow.cells,colc=arr.length,cn=colc,hasTotal=false;if(!drc||drc.length==colc){return ;}for(i=idx+1;i<tr_size;i++){if(trs[i].getAttribute("level")){return ;}if(trs[i].getAttribute("o")){tds=trs[i].cells;td_size=tds.length;for(j=0;j<td_size;j++){if(tds[j].getAttribute("CTY")=="3"){hasTotal=true;break;}}if(hasTotal&&(getSpan(tds[j],"rowspan")>1)){break;}return ;}}for(i=0;i<colc;i++){drc[i]=null;}for(i=0;i<tr_size;i++){if(cn==0){break;}tds=trs[i].cells;p=colc;for(j=tds.length-1;j>=0;j--){cs=getSpan(tds[j],"colspan");if(cs>1){p-=cs;continue;}p-=1;if(!drc[p]){drc[p]=tds[j];cn--;}}}if(cn>0){for(i=0;i<colc;i++){if(!drc[i]){drc[i]={offsetLeft:0,parentNode:{getAttribute:function(){return null;}},getAttribute:function(attr){if(attr=="colspan"||attr=="p"){return 1;}return null;}};}}}};getDataRow();if(dataRow){for(i=0,tr_size=Math.min(tr.cells.length,dataRow.cells.length);i<tr_size;i++){var c=tr.cells[i];if(c&&(c.getAttribute("AX")==="1"||c.getAttribute("AX")==="2"&&c.getAttribute("oty")==="12"||c.getAttribute("MH"))){if(getSpan(tr.cells[i],"colspan")>getSpan(dataRow.cells[i],"colspan")){pushWidths(dataRow,0);break;}}else{break;}}}return arr;}function util_getColumnWidthsArray(oTable,iColumns,iRows,subtractPadding){var aLefts=util_getColumnLeftPositionsArray(oTable,iColumns,iRows);var aWidths=util_getWidthsArrayFromLeftsArray(oTable,iColumns,iRows,aLefts,subtractPadding);return(aWidths);}function util_getWidthsArrayFromLeftsArray(oTable,iColumns,iRows,aLefts,subtractPadding){var padding=(subtractPadding)?1:0;var aWidths=new Array;for(var i=0;i<iColumns;i++){var iNextGoodIndex=i+1;for(iNextGoodIndex=i+1;iNextGoodIndex<=iColumns;iNextGoodIndex++){if(aLefts[iNextGoodIndex]!=null){break;}}if(iNextGoodIndex<=iColumns){aWidths[i]=Math.max(aLefts[iNextGoodIndex]-aLefts[i]-subtractPadding,0);for(var j=i+1;j<iNextGoodIndex;j++){aWidths[j]=0;}i+=iNextGoodIndex-(i+1);}}return(aWidths);}function util_getColumnLeftPosition(oTable,iColIndex,iRows,colTags){var oCOLTags=oTable.getElementsByTagName("COL");var iCOLTags=(oCOLTags)?oCOLTags.length:0;var bFoundVisibleCol=true;if(iColIndex<iCOLTags){bFoundVisibleCol=false;for(var i=iColIndex;i<iCOLTags;i++){if(oCOLTags[i].style.display!="none"){iColIndex=i;bFoundVisibleCol=true;break;}}}if(bFoundVisibleCol){var pxMin=null;if(bIsIE4&&!bIsIE6){var s=util_getLetterForColumnNumber(iColIndex+1);var oCells=oTable.cells(s+"1:"+s+iRows);if(oCells){if(oCells.length){pxMin=getObjSumLeft(oCells[0]);}else{pxMin=getObjSumLeft(oCells);}}}else{if(bIsW3C||bIsIE6){if(mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10)){var leftPos=util_getHeaderColumnLeftPosition(oTable);pxMin=leftPos[iColIndex]+getObjSumLeft(oTable);}else{if(mstr.utils.ISCHROME||mstr.utils.ISSAFARI||mstr.utils.ISW3CIE){leftPos=util_getHeaderColumnHelper(oTable,"getObjSumLeft");pxMin=leftPos[iColIndex];}else{if(!colTags){colTags=oTable.getElementsByTagName("COL");}pxMin=getObjSumLeft(colTags&&colTags[iColIndex]);}}}}return(pxMin);}else{return(getObjSumLeft(oTable)+getObjWidth(oTable));}}function util_getColumnLeftPositionsArray(oTable,iColumns,iRows){var aLefts=new Array;if(!oTable){return(aLefts);}for(var i=0;i<iColumns;i++){aLefts[i]=util_getColumnLeftPosition(oTable,i,iRows);}var oLastCell=null;if(bIsIE4){var s=util_getLetterForColumnNumber(iColumns);oLastCell=oTable.cells.namedItem(s+"1:"+s+iRows);if(oLastCell){if(oLastCell.length){oLastCell=oLastCell[0];}}}if(oLastCell){aLefts[iColumns]=getObjSumLeft(oLastCell)+getObjWidth(oLastCell);}else{aLefts[iColumns]=getObjSumLeft(oTable)+getObjWidth(oTable);}return(aLefts);}function util_setObjTableLayout(oT,sLayout){oT.style.tableLayout="fixed";oT.style.width="";if(oT.width){oT.width="";}return ;}function util_getRowHeightsOfTable(oT,iTotalRows){var aHeights=new Array;for(var i=0;i<iTotalRows;i++){aHeights[i]=getObjHeight(oT.rows[i]);}return(aHeights);}function util_applyRowHeightsToTable(oT,aHeights){if(!oT){return ;}var iMax=oT.rows.length;for(var i=0;i<iMax;i++){if(aHeights[i]!=getObjHeight(oT.rows[i])){oT.rows[i].style.height=aHeights[i];}}return ;}function util_applyColWidthsToTable(oT,oCOLTags,aWidths){if((!oT)||(!oCOLTags)){return ;}var iTags=oCOLTags.length;var iPreviousGoodIndex=-1;var iApplyThisIndex=-1;var iColSpan=1;for(var i=0;i<iTags;i++){if(aWidths[i]!=null){iApplyThisIndex=i;iColSpan=1;}else{iApplyThisIndex=iPreviousGoodIndex;var iNextGoodIndex=-1;for(var j=i+1;j<iTags;j++){if(aWidths[i]!=null){iNextGoodIndex=j;break;}}iColSpan=iNextGoodIndex-iPreviousGoodIndex;if(iColSpan<1){iColSpan=1;}}if(iApplyThisIndex>-1){if(parseInt(aWidths[iApplyThisIndex])>-1){oCOLTags[i].style.width=(parseInt(aWidths[iApplyThisIndex])/iColSpan)+"px";if(aWidths[iApplyThisIndex]>0){oCOLTags[i].style.display="";}else{if(!mstr.utils.ISW3C){oCOLTags[i].style.display="none";}else{oCOLTags[i].style.width="0px";}}iPreviousGoodIndex=iApplyThisIndex;}else{oCOLTags[i].style.display="none";}}}oT.style.width="";return ;}function util_parseRowSpan(oTD,defaultVal){var iSpan=oTD.rowSpan;if((iSpan)&&(!isNaN(parseInt(iSpan)))&&(parseInt(iSpan)>0)){return(parseInt(iSpan));}return(defaultVal);}function util_initCOLTags(oT,iColumns){var iCOLTags=0;var oCOLTags=oT.getElementsByTagName("COL");if(oCOLTags){iCOLTags=oCOLTags.length;}if(iCOLTags<iColumns){var oCOLGROUP=null;var oCOLGROUPS=oT.getElementsByTagName("COLGROUP");if(oCOLGROUPS.length==0){oCOLGROUP=document.createElement("COLGROUP");oCOLGROUP=oT.insertBefore(oCOLGROUP,oT.getElementsByTagName("TBODY")[0]);}else{oCOLGROUP=oCOLGROUPS[0];}var iMissingCOLs=iColumns-iCOLTags;for(var i=0;i<iMissingCOLs;i++){var oNewCOL=document.createElement("COL");oCOLGROUP.appendChild(oNewCOL);}}return ;}function util_getWidthofFixedColumns(oTable,iFixedCols,iCols,iRows,colTags){if((!oTable)||(!iFixedCols)||(!iCols)||(!iRows)){return(0);}if(iFixedCols>=iCols){return(getObjWidth(oTable));}else{return(util_getColumnLeftPosition(oTable,iFixedCols,iRows,colTags)-getObjSumLeft(oTable));}return(0);}function util_getHeightofFixedRows(oTable,iFixedRows,iRows){if((!oTable)||(!iFixedRows)||(!iRows)){return(0);}if(iFixedRows>=iRows){return(getObjHeight(oTable));}else{return(getObjSumTop(oTable.rows[iFixedRows])-getObjSumTop(oTable));}return(0);}function util_getLetterForColumnNumber(iColumn){var CHAR_CODE_A=97;var n1=0;var nTop=0;var nBottom=0;do{n1++;nTop=26*n1;nBottom=26*(n1-1)+1;if((iColumn<=nTop)&&(iColumn>=nBottom)){break;}}while(nTop<=256);var sResult1="";var sResult2="";if(n1>1){sResult1=String.fromCharCode(CHAR_CODE_A+n1-2);}sResult2=String.fromCharCode(CHAR_CODE_A+(iColumn-nBottom));return(sResult1+sResult2);}function util_getFixedRows(oT){if(!oT){return(0);}var oTRs=oT.rows;if(!oTRs){return(0);}var iTotalRows=oTRs.length;var iRepeatRows=0;var sFoundAttr="";if(oTRs[iTotalRows-1].getAttribute("o")){sFoundAttr="o";}else{if(oTRs[iTotalRows-1].getAttribute("level")){sFoundAttr="level";}}if(sFoundAttr==""){iRepeatRows=iTotalRows;}else{for(var i=0;i<iTotalRows;i++){if(oTRs[i].getAttribute(sFoundAttr)){iRepeatRows=i;break;}}}return(iRepeatRows);}function util_getFixedCols(oTable){var iRepeatCols=0;var indexLastRepeatCell=util_lastRepeatColHeaderInRow(oTable,0);iRepeatCols=util_sumColumnCountForCell(oTable,0,indexLastRepeatCell);return(iRepeatCols);}function util_lastRepeatColHeaderInRow(oTable,indexRow){var oTRs=oTable.rows;if(!oTRs){return(0);}var iLastIndex=oTRs[indexRow].childNodes.length-1;var indexLastRepeatCell=-1;for(var i=0;i<=iLastIndex;i++){if(oTRs[indexRow].childNodes[i].getAttribute){var szAX=oTRs[indexRow].childNodes[i].getAttribute("AX");}if(!szAX||(szAX!="1")){break;}else{indexLastRepeatCell=i;}}if(indexLastRepeatCell<iLastIndex){if(oTRs[indexRow].childNodes[indexLastRepeatCell+1].getAttribute){if((oTRs[indexRow].childNodes[indexLastRepeatCell+1].getAttribute("AX")=="2")&&(oTRs[indexRow].childNodes[indexLastRepeatCell+1].getAttribute("OR")=="H")){indexLastRepeatCell+=1;}}}return(indexLastRepeatCell);}function util_sumColumnCountForCell(oTable,indexRow,indexCell){if(!(oTable.rows)){return(0);}var oTR=oTable.rows[indexRow];if(!oTR){return(0);}var colCounter=0;for(var i=0;i<indexCell+1;i++){colCounter+=util_parseSpan(oTR.childNodes[i],1);}return(colCounter);}function util_parseSpan(oTD,defaultVal){var iColspan=oTD.colSpan;if((iColspan)&&(!isNaN(parseInt(iColspan)))&&(parseInt(iColspan)>0)){return(parseInt(iColspan));}return(defaultVal);}function util_copyNode(oOriginal,oDuplicate){oDuplicate.innerHTML=oOriginal.innerHTML;if(oOriginal.attributes){var iCount=oOriginal.attributes.length;for(var i=0;i<iCount;i++){if((oOriginal.attributes[i])&&(oOriginal.attributes[i].specified)){oDuplicate.setAttribute(oOriginal.attributes[i].nodeName,oOriginal.attributes[i].nodeValue,0);}}}if(oOriginal.className){oDuplicate.className=oOriginal.className;}return ;}function util_resolveRepeatedColumnWidths(aWidths,oCOLTags){var aNewWidths=aWidths;var aObjIDs=new Array;var iCounter=0;if(!oCOLTags){return(aNewWidths);}var iCOLTags=oCOLTags.length;for(var i=0;i<iCOLTags;i++){var bFound=false;var objkey=oCOLTags[i].getAttribute("KEY");if(objkey){for(var j=0;j<iCounter;j++){if(aObjIDs[iCounter]==objkey){bFound=true;break;}}}else{bFound=true;}if(!bFound){var aSiblingIndices=new Array;var iSiblingCounter=0;for(var j=i;j<iCOLTags;j++){if(oCOLTags[j].getAttribute("KEY")==objkey){aSiblingIndices[iSiblingCounter]=j;iSiblingCounter++;}}var lMaxWidth=0;for(var j=0;j<aSiblingIndices.length;j++){if(aWidths[aSiblingIndices[j]]>lMaxWidth){lMaxWidth=aWidths[aSiblingIndices[j]];}}for(var j=0;j<aSiblingIndices.length;j++){aNewWidths[aSiblingIndices[j]]=lMaxWidth;}aObjIDs[iCounter]=objkey;iCounter++;}}return(aNewWidths);}function util_getColumnWidthsString(oTable,oCOLTags,iCols,iRows){if(!oTable){return("");}var aWidths=util_getColumnWidthsArray(oTable,iCols,iRows);aWidths=util_resolveRepeatedColumnWidths(aWidths);var aFixedWidths=new Array;var iCounter=0;if(oCOLTags){var iCOLTags=oCOLTags.length;for(var i=0;i<iCOLTags;i++){var objkey=oCOLTags[i].getAttribute("KEY");var bFound=false;for(var j=0;j<iCounter;j=j+2){if(aFixedWidths[j]==objkey){bFound=true;break;}}if(!bFound){aFixedWidths[iCounter]=objkey;iCounter++;aFixedWidths[iCounter]=parseInt(aWidths[i]);iCounter++;}}}var sResult="";var i=0;do{sResult+=aFixedWidths[i]+":"+aFixedWidths[i+1]+"_";i=i+2;}while(i<iCounter);return(sResult);}function util_applySingleRowHeight(oT,lHeight,iStartRow,iEndRow){if((!oT)||(!oT.rows)||(!oT.rows.length)){return ;}var iRows=oT.rows.length;if(iStartRow>iRows-1){return ;}if(iEndRow>iRows-1){iEndRow=iRows-1;}var newHeight=(lHeight.length==0)?"":lHeight+"px";for(var i=iStartRow;i<=iEndRow;i++){oT.rows[i].style.height=newHeight;}return ;}function util_getColIndex(cell,table,colIndexOffsets){try{var currentRowIndex=cell.parentNode.rowIndex;var cellIndex=util_sumColumnCountForCell(table,currentRowIndex,cell.cellIndex)-1;var rows=table.rows;for(var r=currentRowIndex;r>=0;r--){for(var c=0,j=0;c<(cellIndex+colIndexOffsets[currentRowIndex]);){var tCell=rows[r].cells[j++];var rowSpan=util_parseRowSpan(tCell,1);var colSpan=util_parseSpan(tCell,1);if(rowSpan>1){for(var t=r+1;t<(r+rowSpan);t++){colIndexOffsets[t]+=colSpan;}}c+=colSpan;}}return(cellIndex+colIndexOffsets[currentRowIndex]);}catch(err){microstrategy.errors.log(err);return null;}}function util_getAllCellsInColumnFromThisCell(cell,table,endRowIndex){try{var currentRowIndex=cell.parentNode.rowIndex;var rows=table.rows;var colIndexOffsets=new Array();for(var i=0;i<rows.length;i++){colIndexOffsets[i]=0;}var cellColIndex=util_getColIndex(cell,table,colIndexOffsets);var cc=new Array();cc[0]=cell;var j=1;var currentRowSpan=util_parseRowSpan(cell,1);if(endRowIndex==null||typeof (endRowIndex)=="undefined"){endRowIndex=rows.length;}for(var r=currentRowIndex+currentRowSpan;r<endRowIndex;){var allCells=rows[r].cells;for(var c=0,m=0;c<cellColIndex-colIndexOffsets[r]&&m<allCells.length;){var tCell=allCells[m++];var rowSpan=util_parseRowSpan(tCell,1);var colSpan=util_parseSpan(tCell,1);if(rowSpan>1){for(var t=r+1;t<(r+rowSpan);t++){colIndexOffsets[t]+=colSpan;}}if(colSpan>1){colIndexOffsets[r]+=colSpan-1;}c+=colSpan;}var rspan=1;if((cellColIndex-colIndexOffsets[r])>=0){cc[j++]=allCells[cellColIndex-colIndexOffsets[r]];rspan=util_parseRowSpan(allCells[cellColIndex-colIndexOffsets[r]],1);}r+=rspan;}return cc;}catch(err){microstrategy.errors.log(err);return null;}}function util_getAllCellsInRowFromThisCell(cell,table){if(cell.nodeName.toLowerCase()!="td"){return null;}var rowIndex=cell.parentNode.rowIndex;var cc=new Array();cc[0]=cell;var j=1;var rowSpan=util_parseRowSpan(cell,table);for(var i=cell.cellIndex+1;i<cell.parentNode.cells.length;i++){cc[j]=cell.parentNode.cells[i];j++;}for(var i=rowIndex+1;i<rowIndex+rowSpan;i++){var row=table.rows[i];for(var m=0;m<row.cells.length;m++){cc[j]=table.rows[i].cells[m];j++;}}return cc;}function util_findCell(table,rowIndex,cellIndex,attValue,attName){var row=table.rows[rowIndex];if(row!=null){var cell=row.cells[cellIndex];var value=cell&&cell.getAttribute(attName);if(value&&value.toLowerCase()==attValue.toLowerCase()){return cell;}}return null;}
var selectedRow=null;AttFormsScript=true;function AddOptionsToTable(sFromList){var i;var lLength;var oOption;var oFromList=getObj(sFromList);for(i=0;i<oFromList.options.length;i++){if(oFromList.options[i].selected&&oFromList.options[i].value.length>=32){oOption=new Option(oFromList.options[i].text,oFromList.options[i].value,false,false);addRow("attFormTable",oOption);oFromList.options[i]=null;}}}function addRow(id,oOption){var tbody=document.getElementById(id).getElementsByTagName("TBODY")[0];var row=document.createElement("TR");row.setAttribute("id",tbody.childNodes.length);row.onclick=new Function("e","setAsSelected(this)");var td1=document.createElement("TD");var label=document.createElement("LABEL");label.setAttribute("for",oOption.value+"_view");label.appendChild(document.createTextNode(oOption.text));td1.appendChild(label);var input=document.createElement("INPUT");input.setAttribute("type","hidden");input.setAttribute("id",oOption.value);input.setAttribute("name",oOption.value);input.setAttribute("value",tbody.childNodes.length+1);td1.appendChild(input);var td2=document.createElement("TD");var check=document.createElement("INPUT");check.setAttribute("type","checkbox");check.setAttribute("id",oOption.value+"_view");check.setAttribute("name",oOption.value+"_view");check.setAttribute("value","1");check.onclick=new Function("checkLastForm(this); return true;");td2.appendChild(check);var checkHidden=document.createElement("INPUT");checkHidden.setAttribute("type","hidden");checkHidden.setAttribute("id",oOption.value+"_view");checkHidden.setAttribute("name",oOption.value+"_view");checkHidden.setAttribute("value","0");td2.appendChild(checkHidden);row.appendChild(td1);row.appendChild(td2);tbody.appendChild(row);check.checked=true;}function setAsSelected(row){deselectRow();row.className="attributeFormRow-selected";if(row.cells&&row.cells[0]){row.cells[0].className="attributeFormCell-selected";}selectedRow=row;}function deselectRow(){var attTable=document.getElementById("attFormTable");if(attTable==null){return false;}for(var i=0;i<attTable.rows.length;i++){attTable.rows[i].className="attributeFormRow-notselected";if(attTable.rows[i].cells&&attTable.rows[i].cells[0]){attTable.rows[i].cells[0].className="attributeFormCell-notselected";}}selectedRow=null;}function AddOptionsToList(sToList){if(selectedRow==null){return ;}if(selectedRow.getAttribute("IsIDForm")=="1"){showMessage({contents:microstrategy.descriptors.getDescriptor("3484"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}var oToList=document.getElementById(sToList);var sValue=selectedRow.cells[0].getElementsByTagName("input")[0].getAttribute("id");var box=null;var inputs=selectedRow.getElementsByTagName("input");for(var i=0;i<inputs.length;i++){if(inputs[i].type=="checkbox"){box=inputs[i];break;}}if(box!=null){box.checked=false;if(isLastAttForm()){box.checked=true;return false;}}var text=selectedRow.cells[0].firstChild.innerText||selectedRow.cells[0].firstChild.textContent;var oOption=new Option(text,sValue,false,false);if((oToList.options.length==1)&&(oToList.options[0].value.length<32)){oToList.options[0]=oOption;}else{oToList.options[oToList.length]=oOption;}removeSelectedRow("attFormTable");}function removeSelectedRow(id){if(selectedRow!=null){var table=document.getElementById(id);var tbody=table.tBodies[0];var row;var i;var removed=false;var size=tbody.childNodes.length-1;for(i=size;i>=0;i--){row=tbody.rows[i];if(row.getAttribute("id")==selectedRow.getAttribute("id")){tbody.deleteRow(i);selectedRow=null;break;}else{row.setAttribute("id",i-1);row.cells[0].lastChild.value=i;}}}}function MoveRowInTableUp(){if(selectedRow!=null){var table=document.getElementById("attFormTable");var tbody=table.tBodies[0];var current=parseInt(selectedRow.getAttribute("id"));if(current>0){tbody.rows[current].setAttribute("id",current-1);tbody.rows[current-1].setAttribute("id",current);var currentPos=tbody.rows[current].cells[0].lastChild.getAttribute("value");var beforePos=tbody.rows[current-1].cells[0].lastChild.getAttribute("value");tbody.rows[current].cells[0].lastChild.setAttribute("value",beforePos);tbody.rows[current-1].cells[0].lastChild.setAttribute("value",currentPos);var currentCheck=tbody.rows[current].cells[1].firstChild.checked;if(bIsIE4){table.moveRow(current+1,current);}else{if(bIsW3C){var rowCurrent=table.rows[current];var rowAfterCurrent=table.rows[current+1];rowAfterCurrent=rowAfterCurrent.parentNode.removeChild(rowAfterCurrent);rowCurrent.parentNode.insertBefore(rowAfterCurrent,rowCurrent);}}tbody.rows[current-1].cells[1].firstChild.checked=currentCheck;}}}function MoveRowInTableDown(){if(selectedRow!=null){var table=document.getElementById("attFormTable");var tbody=table.tBodies[0];var current=parseInt(selectedRow.getAttribute("id"));if(current<tbody.childNodes.length-1){tbody.rows[current].setAttribute("id",current+1);tbody.rows[current+1].setAttribute("id",current);var currentPos=tbody.rows[current].cells[0].lastChild.getAttribute("value");var afterPos=tbody.rows[current+1].cells[0].lastChild.getAttribute("value");tbody.rows[current].cells[0].lastChild.setAttribute("value",afterPos);tbody.rows[current+1].cells[0].lastChild.setAttribute("value",currentPos);var currentCheck=tbody.rows[current].cells[1].firstChild.checked;if(bIsIE4){table.moveRow(current+1,current+2);}else{if(bIsW3C){var rowAfterCurrent=table.rows[current+1];var rowAfterAfterCurrent=table.rows[current+2];rowAfterAfterCurrent=rowAfterAfterCurrent.parentNode.removeChild(rowAfterAfterCurrent);rowAfterCurrent.parentNode.insertBefore(rowAfterAfterCurrent,rowAfterCurrent);}}tbody.rows[current+1].cells[1].firstChild.checked=currentCheck;}}}function checkLastForm(box){if(!box.checked){box.checked=isLastAttForm(box.id);}}function isLastAttForm(){var attTable=document.getElementById("attFormTable");if(attTable==null){return false;}var boxes=attTable.getElementsByTagName("INPUT");for(var i=0;i<boxes.length;i++){if(boxes[i].type=="checkbox"&&boxes[i].checked){return false;}}showMessage({contents:microstrategy.descriptors.getDescriptor("3626"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return true;}
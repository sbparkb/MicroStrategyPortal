mstrSingleObjectSelectorImplScript=true;mstrSingleObjectSelectorImpl.prototype=new mstrEditorImpl();mstrSingleObjectSelectorImpl.prototype.nameFieldID="_objName";mstrSingleObjectSelectorImpl.prototype.typeFieldID="_objType";mstrSingleObjectSelectorImpl.prototype.typeField=null;mstrSingleObjectSelectorImpl.prototype.nameField=null;mstrSingleObjectSelectorImpl.prototype.UNIT_SEPARATOR="\u001F";mstrSingleObjectSelectorImpl.prototype.ITEM_SEPARATOR="~";mstrSingleObjectSelectorImpl.prototype.currentSelection=null;mstrSingleObjectSelectorImpl.prototype.selectedClass="selected";mstrSingleObjectSelectorImpl.prototype.select=function(obj){try{var objNode=this.findChildWithAtt(obj,"span",microstrategy.HTMLATTR_DSS_TYPE);if(objNode!=null){this.setCurrentSelection(objNode);var name=objNode.getAttribute(microstrategy.HTMLATTR_DESCRIPTION);var type=objNode.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);var subType=objNode.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);var did=objNode.getAttribute(microstrategy.HTMLATTR_DSS_ID);this.getNameField();this.getTypeField();this.nameField.value=name;this.nameField.setAttribute(microstrategy.HTMLATTR_DESCRIPTION,name);this.nameField.setAttribute(microstrategy.HTMLATTR_DSS_TYPE,type);this.nameField.setAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE,subType);this.nameField.setAttribute(microstrategy.HTMLATTR_DSS_ID,did);for(i=0;i<this.typeField.options.length;i++){var option=this.typeField.options[i];if(option.value==type){option.selected=true;}else{option.selected=false;}}}}catch(err){microstrategy.errors.log(err);}};mstrSingleObjectSelectorImpl.prototype.setCurrentSelection=function(obj){try{if(this.currentSelection!=null){this.clearCurrentSelection();}this.currentSelection=obj;var oldClassName=obj.className;if(typeof (oldClassName)=="undefined"){oldClassName="";}obj.className=this.selectedClass+oldClassName;}catch(err){microstrategy.errors.log(err);}};mstrSingleObjectSelectorImpl.prototype.clearCurrentSelection=function(){try{var obj=this.currentSelection;if(obj){var oldClassName=obj.className;if((oldClassName.length>0)&&(oldClassName.indexOf(this.selectedClass)==0)){newClass=oldClassName.substr(this.selectedClass.length);}obj.className=newClass;}}catch(err){microstrategy.errors.log(err);}};mstrSingleObjectSelectorImpl.prototype.getNameField=function(){if(!this.nameField){this.nameField=document.getElementById(this.beanPath+this.nameFieldID);}};mstrSingleObjectSelectorImpl.prototype.getTypeField=function(){if(!this.typeField){this.typeField=document.getElementById(this.beanPath+this.typeFieldID);}};mstrSingleObjectSelectorImpl.prototype.submitChange=function(){this.getNameField();if(this.nameField&&this.nameField.getAttribute(microstrategy.HTMLATTR_DSS_ID)){var selectedObj=this.nameField.getAttribute(microstrategy.HTMLATTR_DSS_ID)+this.ITEM_SEPARATOR+this.nameField.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)+this.ITEM_SEPARATOR+this.nameField.getAttribute(microstrategy.HTMLATTR_DESCRIPTION);var env=microstrategy.updateManager.createActionObject(null,mstrUpdateManager.WebEventUpdateSelections,this.beanPath,["94001","94002"],[selectedObj,"1"]);microstrategy.updateManager.useIframe=false;microstrategy.updateManager.add([env]);}microstrategy.updateManager.flushAndSubmitChanges();};mstrSingleObjectSelectorImpl.prototype.findChildWithAtt=function(elem,tagName,attName){try{if(!elem){return null;}if(typeof (tagName)!="object"){tagName=[tagName];}for(var j=0;j<tagName.length;j++){if((elem.tagName.toLowerCase()==tagName[j].toLowerCase())&&(elem.getAttribute(attName)!=null)){return elem;}var objs=elem.getElementsByTagName(tagName[j]);if(objs&&objs.length){for(var i=0;i<objs.length;i++){if(objs[i].getAttribute(attName)!=null){return objs[i];}}}}return null;}catch(err){microstrategy.errors.log(err);return null;}};function mstrSingleObjectSelectorImpl(id){this.inherits=mstrEditorImpl;this.inherits(id);delete this.inherits;return this;}
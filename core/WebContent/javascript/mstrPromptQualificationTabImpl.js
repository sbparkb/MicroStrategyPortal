mstrPromptQualificationTabImplScript=true;mstrPromptQualificationTabImpl.prototype=new mstrPromptDefTabImpl();mstrPromptQualificationTabImpl.prototype.expMaxElemDiv=null;mstrPromptQualificationTabImpl.prototype.expTypeAllowedDiv=null;mstrPromptQualificationTabImpl.prototype.DefExpTypeDiv=null;mstrPromptQualificationTabImpl.prototype.DefCondOpList=null;mstrPromptQualificationTabImpl.prototype.DefCondOpCopy=null;mstrPromptQualificationTabImpl.prototype.DefOpBetweenList=null;mstrPromptQualificationTabImpl.prototype.allowRootOpChangeList=null;mstrPromptQualificationTabImpl.prototype.allowInterOpChangeList=null;mstrPromptQualificationTabImpl.prototype.DefExpTypesCopy=null;mstrPromptQualificationTabImpl.prototype.allowOpChange=null;mstrPromptQualificationTabImpl.prototype.onload=function(){try{mstrPromptDefTabImpl.prototype.onload.call(this);if(!this.isMQ()){this.expMaxElemDiv=getObj("expMaxElemDiv");this.expTypeAllowedDiv=getObj("expTypeAllowedDiv");this.DefExpTypeDiv=getObj("DefExpTypeDiv");this.DefExpTypesCopy=getObj("p_defaultExpTypeCopy");}this.DefCondOpList=getObj("p_defaultCondOp");this.DefCondOpCopy=getObj("p_defaultCondOpCopy");this.DefOpBetweenList=getObj("p_defaultRootOp");this.allowOpChange=getObj("p_allowOpChange");this.allowRootOpChangeList=getObj("p_allowRootOpChange");this.allowInterOpChangeList=getObj("p_allowInterOpChange");this.adjustExpTypeAllowed();this.updateQualSections(true);var setTab=function(fld){if(typeof (fld)=="string"){fld=getObj(fld);}if(fld){fld.setAttribute("tab","4");}};setTab("p_maxElemPerSub");}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQualificationTabImpl.prototype.initSettings=function(){this.settings=this.getSettings(new Array("p_maxElemPerSubMode","p_maxElemPerSub","p_expTypeAllowed","p_defaultExpType","p_defaultCondOp","p_defaultRootOp","p_allowRootOpChange","p_allowInterOpChange","p_allowElementImport","p_dispOutputLevel","p_allowElementBrowse","p_allowOpChange"));};mstrPromptQualificationTabImpl.prototype.adjustExpTypeAllowed=function(){if(!this.isAQ()){return ;}var list=getObj("p_expTypeAllowed");if(microstrategy.bone("tabPromptStyleId")&&microstrategy.bone("tabPromptStyleId").dispStyle.value==mstrPromptDefCommandsImpl.prototype.DISPLAYSTYLE_TEXTBOX){list.value=mstrPromptDefCommandsImpl.prototype.EXPRESSIONTYPEALLOWED_QUALIFY;list.disabled=true;this.updateExpTypeAllowed(list);}else{list.disabled=false;}};mstrPromptQualificationTabImpl.prototype.updateExpTypeAllowed=function(list,skipCmd){if(this.isMQ()){return ;}if(!skipCmd){this.updateList(list);}var expTypeList=getObj("p_defaultExpType");if(list.value==mstrPromptDefCommandsImpl.prototype.EXPRESSIONTYPEALLOWED_SELECT){expTypeList.options.length=0;for(i=0;i<this.DefExpTypesCopy.options.length;i++){var copyOp=this.DefExpTypesCopy.options[i];if(copyOp.value==mstrPromptDefCommandsImpl.prototype.DEFAULTEXPRESSIONTYPE_SELECT){var newOp=new Option(copyOp.text,copyOp.value,copyOp.defaultSelected,true);expTypeList.options[expTypeList.options.length]=newOp;}}}else{if(list.value==mstrPromptDefCommandsImpl.prototype.EXPRESSIONTYPEALLOWED_QUALIFY){expTypeList.options.length=0;for(i=0;i<this.DefExpTypesCopy.options.length;i++){var copyOp=this.DefExpTypesCopy.options[i];if(copyOp.value==mstrPromptDefCommandsImpl.prototype.DEFAULTEXPRESSIONTYPE_QUALIFY){var newOp=new Option(copyOp.text,copyOp.value,copyOp.defaultSelected,true);expTypeList.options[expTypeList.options.length]=newOp;}}}else{if(expTypeList.options.length<2){var currentValue=expTypeList.value;expTypeList.options.length=0;for(i=0;i<this.DefExpTypesCopy.options.length;i++){var copyOp=this.DefExpTypesCopy.options[i];var newOp=new Option(copyOp.text,copyOp.value,copyOp.defaultSelected,false);expTypeList.options[expTypeList.options.length]=newOp;if(newOp.value==currentValue){newOp.selected=true;}}}}}this.updateDefaultExpType(expTypeList,skipCmd);};mstrPromptQualificationTabImpl.prototype.updateDefaultExpType=function(obj,skipCmd){if(!skipCmd){this.updateList(obj);}this.updateDefaultCondOperator(obj);};mstrPromptQualificationTabImpl.prototype.updateDefaultCondOperator=function(obj){if(!obj||this.isMQ()){return ;}var isQualify=(obj.value==mstrPromptDefCommandsImpl.prototype.EXPRESSIONTYPEALLOWED_QUALIFY);this.DefCondOpList.options.length=0;var selectedIndex=0;for(var i=0;i<this.DefCondOpCopy.options.length;i++){var copyOp=this.DefCondOpCopy.options[i];var ty=copyOp.getAttribute("ty");if(!ty||(ty=="q"&&isQualify)||(ty=="s"&&!isQualify)){if(copyOp.selected){selectedIndex=this.DefCondOpList.options.length;}var newOp=new Option(copyOp.text,copyOp.value,copyOp.defaultSelected,copyOp.selected);this.DefCondOpList.options[this.DefCondOpList.options.length]=newOp;}}this.DefCondOpList.selectedIndex=selectedIndex;};mstrPromptQualificationTabImpl.prototype.updateQualSections=function(skipCmd){var tabDisp=microstrategy.bone("tabPromptDispId");var maxValue=(tabDisp&&tabDisp.maxCheck)?tabDisp.maxValue:-1;if(maxValue==1){this.DefOpBetweenList.disabled=true;this.allowOpChange.disabled=true;this.allowRootOpChangeList.disabled=true;this.allowInterOpChangeList.disabled=true;}else{this.DefOpBetweenList.disabled=false;this.allowOpChange.disabled=false;this.allowRootOpChangeList.disabled=!this.allowOpChange.checked;this.allowInterOpChangeList.disabled=!this.allowOpChange.checked;}this.updateExpTypeAllowed(getObj("p_expTypeAllowed"),skipCmd);this.updateDefaultCondOperator(getObj("p_defaultExpType"));};function mstrPromptQualificationTabImpl(id){this.inherits=mstrPromptDefTabImpl;this.inherits(id);this.inherits=null;return this;}
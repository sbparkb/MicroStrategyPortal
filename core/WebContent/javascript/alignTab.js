mstrAlignTabImplScript=true;mstrAlignTabImpl.prototype=new mstrTabImpl();mstrAlignTabImpl.prototype.initializing=false;mstrAlignTabImpl.prototype.changeGridProperties=false;mstrAlignTabImpl.prototype.onload=function(){try{this.initEditor();this.initSettings();}catch(err){microstrategy.errors.log(err);return false;}};mstrAlignTabImpl.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);var at=this.getAppliesTo();this.changeGridProperties=(at&&at.commands.queryEnabled("onegrid")==true)?true:false;this.initValues();}catch(err){microstrategy.errors.log(err);return false;}};mstrAlignTabImpl.prototype.initSettings=function(){try{this.settings=new Array();var props=new Array("Horizontal","Vertical","TextDirection","LineSpacing","LeftPadding","TopPadding","RightPadding","BottomPadding","TextWrap");for(var i=0;i<props.length;i++){var elem=document.getElementById(this.id+props[i]);if(elem){this.settings.push(elem);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrAlignTabImpl.prototype.initValues=function(){try{var at=this.getAppliesTo();this.initializing=true;this.changeGridProperties=(at&&at.commands.queryEnabled("onegrid")==true)?true:false;if(this.changeGridProperties==false){this.initComboValue(at,"Horizontal",this.id+"Horizontal","true","textAlign");if(at.isCondFormat&&at.commands.queryEnabled("textfieldselected")){var verticalField=document.getElementById(this.id+"Vertical");if(verticalField){verticalField.style.display="none";}var verticalLabel=document.getElementById(this.id+"Vertical_label");if(verticalLabel){verticalLabel.style.display="none";}}else{if(at.commands.queryEnabled("anycontrol")){this.initComboValue(at,"Vertical",this.id+"Vertical","true","verticalAlign");var flashWarning=document.getElementById(this.id+"_flashWarning");if(flashWarning){flashWarning.style.visibility="visible";}}else{var verticalSection=document.getElementById(this.id+"VerticalSection");if(verticalSection){verticalSection.style.display="none";}}}this.initComboValue(at,"TextDirection",this.id+"TextDirection","true","TextDirection");this.initTextValue(at,"LineSpacing",this.id+"LineSpacing","true","lineHeight");this.initTextValue(at,"LeftPadding",this.id+"LeftPadding","true","paddingLeft");this.initTextValue(at,"TopPadding",this.id+"TopPadding","true","paddingTop");this.initTextValue(at,"RightPadding",this.id+"RightPadding","true","paddingRight");this.initTextValue(at,"BottomPadding",this.id+"BottomPadding","true","paddingBottom");this.initCheckValue(at,"TextWrap",this.id+"TextWrap","true","whiteSpace");}this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrAlignTabImpl.prototype.toggleCheck=function(oCheck,useDefault){if(mstrTabImpl.prototype.toggleCheck.apply(this,arguments)){var chkState=parseInt(oCheck.getAttribute("cv"),10);if(oCheck.id==(this.id+"TextDirection")){oCheck.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,(chkState==-1)?-90:0);}}};mstrAlignTabImpl.prototype.updateCheck=function(obj){try{if(obj){var newValue=0;if(obj.checked){newValue=(obj.id==(this.id+"TextDirection"))?-90:1;}if(!this.initializing){obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newValue);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrAlignTabImpl.prototype.updateList=function(obj){try{if(obj){if(!this.initializing){if((obj.id==(this.id+"LeftPadding"))||(obj.id==(this.id+"RightPadding"))||(obj.id==(this.id+"TopPadding"))||(obj.id==(this.id+"BottomPadding"))){var value=microstrategy.number.toString(microstrategy.number.toUSUnits(obj.value))*72;value=microstrategy.number.toLocaleString(value);obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,value);}else{if(bIsW3C&&!(bIsIE6||bIsW3CIE)&&obj.id==this.id+"TextDirection"&&obj.value!="0"){showMessage({contents:microstrategy.descriptors.getDescriptor("5158"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,obj.value);}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrAlignTabImpl.prototype.updateTooltip=function(obj){try{obj.setAttribute("title",(obj&&obj.options&&obj.selectedIndex>=0)?obj.options[obj.selectedIndex].text:"");}catch(err){microstrategy.errors.log(err);}};mstrAlignTabImpl.prototype.checkForFormatChanges=function(){try{var __result=false;var counter;for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(settingValue!=null){return true;}}return __result;}catch(err){microstrategy.errors.log(err);return false;}};mstrAlignTabImpl.prototype.applyPropertyChanges=function(propertiesArray){};mstrAlignTabImpl.prototype.applyFormatChanges=function(at,bulkChanges){try{var formatBulkArray=bulkChanges;this.changeGridProperties=(at&&at.commands.queryEnabled("onegrid")==true)?true:false;for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(settingValue!=null){if(this.changeGridProperties==true){formatBulkArray.push(settingName+"|"+settingValue);}else{switch(settingName){case"LineSpacing":settingValue=aSetting.value;if((settingValue==null)||(settingValue.length==0)){settingValue="normal";}formatBulkArray.push(settingName+"|"+settingValue);break;default:if((settingValue==null)||(settingValue.length==0)){settingValue="0";}formatBulkArray.push(settingName+"|"+settingValue);}}if(!this.enforceSubmit){aSetting.removeAttribute(microstrategy.HTMLATTR_CMD_VALUE);}}}return formatBulkArray;}catch(err){microstrategy.errors.log(err);return bulkChanges;}};function mstrAlignTabImpl(id){this.inherits=mstrTabImpl;this.inherits(id);this.inherits=null;return this;}
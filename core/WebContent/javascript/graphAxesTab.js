mstrGraphAxesTabImplScript=true;mstrGraphAxesTabImpl.prototype=new mstrTabImpl();mstrGraphAxesTabImpl.prototype.major=null;mstrGraphAxesTabImpl.prototype.minor=null;mstrGraphAxesTabImpl.prototype.initializing=false;mstrGraphAxesTabImpl.prototype.y1Cart=null;mstrGraphAxesTabImpl.prototype.y2Cart=null;mstrGraphAxesTabImpl.prototype.addToY2ButtonCell=null;mstrGraphAxesTabImpl.prototype.addToY1ButtonCell=null;mstrGraphAxesTabImpl.prototype.swapButtonCell=null;mstrGraphAxesTabImpl.prototype.dualYOption=true;mstrGraphAxesTabImpl.prototype.isDualAxis=false;mstrGraphAxesTabImpl.prototype.DUAL_Y_OPTION_AUTO=0;mstrGraphAxesTabImpl.prototype.DUAL_Y_OPTION_MANUAL=1;mstrGraphAxesTabImpl.prototype.PROPERTY_DUAL_Y_OPTION="dualYOption";mstrGraphAxesTabImpl.prototype.PERCENT_GRAPH=["1_64","2_64","4_64","8_64","16_64","32_64","2097152_2"];mstrGraphAxesTabImpl.prototype.Y1_ID="128";mstrGraphAxesTabImpl.prototype.onload=function(){try{this.initEditor();}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);this.initSettings();this.enableTab();}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.initSettings=function(){try{this.major=this.getAppliesTo().commands.queryState("major");this.minor=this.getAppliesTo().commands.queryState("minor");this.settings=new Object();this.adjustAvailableAxes();if(getElementById("y1y2AxisDist")){this.isDualAxis=true;this.y1Cart=getElementById("addToY2Axis");this.y2Cart=getElementById("addToY1Axis");this.addToY2ButtonCell=getElementById("addToY2AxisButtonCell");this.addToY1ButtonCell=getElementById("addToY1AxisButtonCell");this.swapButtonCell=getElementById("swapButtonCell");var inputOption=getElementById(this.id+this.PROPERTY_DUAL_Y_OPTION+this.DUAL_Y_OPTION_AUTO);if(inputOption&&inputOption.checked){this.dualYOption=true;}else{this.dualYOption=false;}this.renderButtons();}else{this.isDualAxis=false;}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.getChanges=function(){try{var __result="";for(var axesId in this.settings){var axesSettings=this.settings[axesId];for(var counter=0;counter<axesSettings.length;counter++){var aSettingInput=axesSettings[counter];var settingValue=aSettingInput.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(settingValue!=null&&settingValue.length>0){__result+=this.getJSONProperty(aSettingInput.id,settingValue);}}}if(__result.length>0){__result=__result.substring(0,__result.length-1);}return __result;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.restorePreviousSelections=function(prevSettings){try{for(var settingName in prevSettings){var field=document.getElementById(settingName);if(field!=null&&prevSettings[settingName]!=null){this.restoreEachSelection(field,settingName,prevSettings[settingName]);}}this.adjustAvailableAxes();}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.restoreEachSelection=function(field,cmdId,value){try{if(field.id.indexOf("Scale")>0){this.decomposeScale(field.id,value);}if(field.id.indexOf("Step")>0){this.decomposeStep(field.id,value);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.decomposeScale=function(objId,objValue){try{if(objValue!=null&&objValue.length>0){var axesId=objId.substring(objId.indexOf("Scale")+5,objId.length);var info=objValue.split(",");if(info.length==3){this.updateAxesField(axesId,"Min",(info[0]=="1"||info[0]=="2")?info[2]:"");this.updateAxesField(axesId,"Max",(info[0]=="1"||info[0]=="3")?info[1]:"");}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.updateAxesField=function(axesId,fieldPrefix,value){try{var oObj=document.getElementById(this.id+fieldPrefix+axesId+"_TEXT");if(oObj){oObj.value=value;oObj.onchange();}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.decomposeStep=function(objId,objValue){try{if(objValue!=null&&objValue.length>0){var axesId=objId.substring(objId.indexOf("Step")+4,objId.length);var info=objValue.split(",");if(info.length==2){this.updateAxesField(axesId,"Int",(info[0]=="1")?info[1]:"");}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.isPercentGraph=function(){if(this.major&&this.minor){var type=this.major+"_"+this.minor;for(var i=0;i<this.PERCENT_GRAPH.length;i++){if(type==this.PERCENT_GRAPH[i]){return true;}}}return false;};mstrGraphAxesTabImpl.prototype.adjustAvailableAxes=function(){try{this.initializing=true;var axesSettings=microstrategy.subObjectListFind(this.elem,"tr","axSet");this.settings=new Object();for(var i=0;i<axesSettings.length;i++){var anAxisSetting=axesSettings[i];var filter=anAxisSetting.getAttribute(microstrategy.HTMLATTR_FILTER_VALUE);var visible=true;if(filter){visible=false;var composedFilter=anAxisSetting.getAttribute("cf");var filterValue=(composedFilter)?this.major+"_"+this.minor:this.major;var values=filter.split(",");var index=0;while(index<values.length&&!visible){visible=composedFilter?values[index]==filterValue:(parseInt(values[index])==parseInt(filterValue));index++;}}if(visible){displayObj(anAxisSetting);var showIdAttr=anAxisSetting.getAttribute("showId");if(showIdAttr==this.Y1_ID){var minRow=document.getElementById(this.id+"Min"+showIdAttr);var maxRow=document.getElementById(this.id+"Max"+showIdAttr);if(this.isPercentGraph()){if(maxRow!=null){removeObj(maxRow);}if(minRow!=null){removeObj(minRow);}}else{if(maxRow!=null){maxRow.style.display="";maxRow.style.visibility="";}if(minRow!=null){minRow.style.display="";minRow.style.visibility="";}}}if(showIdAttr){var settingArray=new Array();if(typeof (this.settings[showIdAttr])!="undefined"){settingArray=this.settings[showIdAttr];}var inputFields=anAxisSetting.getElementsByTagName("input");for(var j=0;j<inputFields.length;j++){var anInput=inputFields[j];if(anInput.getAttribute(microstrategy.HTMLATTR_CMD_ID)){settingArray.push(inputFields[j]);}}this.settings[showIdAttr]=settingArray;}}else{removeObj(anAxisSetting);}}this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.handleEnableInput=function(obj,isDisabled){try{if(obj){var className="";obj.disabled=isDisabled;if(isDisabled){switch(obj.type){case"checkbox":obj.checked=false;break;case"text":obj.value="";break;}className="disabledLabel";}var labelCounter=0;var label=document.getElementById(obj.id+"_LABEL"+labelCounter);while(label){label.className=className;labelCounter++;label=document.getElementById(obj.id+"_LABEL"+labelCounter);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.updateStepScaleTextInfo=function(obj,showId){try{if(!obj.checked){var textName=obj.id.substr(0,obj.id.indexOf("_"))+"_TEXT";var textObj=document.getElementById(textName);if(textObj){textObj.value="";textObj.onchange();}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.updateStepScaleCheck=function(obj,showId){try{var checkName=obj.id.substr(0,obj.id.indexOf("_"))+"_CHECK";var checkObj=document.getElementById(checkName);if(obj&&obj.value.length>0){if(checkObj&&!checkObj.checked){checkObj.checked=true;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.updateStepScaleInfo=function(obj,showId){try{var checkName=obj.id.substr(0,obj.id.indexOf("_"))+"_CHECK";var checkObj=document.getElementById(checkName);if(checkObj&&obj.value.length>0){if(!checkObj.checked){checkObj.checked=true;}}else{if(checkObj){checkObj.checked=false;}}var idSuffix=showId+"_TEXT";var newValue="";var updateObj=null;var isMax=false;if(obj.id==this.id+"Min"+idSuffix||(isMax=obj.id==this.id+"Max"+idSuffix)){updateObj=document.getElementById(this.id+"Scale"+showId);var objMin=(isMax)?document.getElementById(this.id+"Min"+idSuffix):obj;var objMax=(isMax)?obj:document.getElementById(this.id+"Max"+idSuffix);var index="0";var min="0";var max="0";if(objMin.value.length>0){index="2";min=objMin.value;}if(objMax.value.length>0){index=(index=="2")?"1":"3";max=objMax.value;}newValue=index+","+microstrategy.number.toString(max)+","+microstrategy.number.toString(min);}else{updateObj=document.getElementById(this.id+"Step"+showId);newValue=obj.value?"1,"+microstrategy.number.toString(obj.value):"0,0";}if(updateObj){updateObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newValue);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.onmajortypechange=function(newValue){try{this.major=newValue;this.enableTab();this.adjustAvailableAxes();}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.onminortypechange=function(newValue){try{this.minor=newValue;this.adjustAvailableAxes();}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.onDualYOptionChange=function(option){if(parseInt(option.getAttribute("value"))==this.DUAL_Y_OPTION_AUTO){this.dualYOption=true;}else{this.dualYOption=false;}this.y1Cart.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,true);this.updateDualYOption(this.dualYOption);if(this.dualYOption){this.redistributeSeriesForAutoMode();this.renderButtons();}};mstrGraphAxesTabImpl.prototype.enableTab=function(){try{var tabHeader=document.getElementById(this.id+"_tab");if(tabHeader){if(this.major=="64"||this.major=="1048576"){tabHeader.className="mstrTabSetTab disabled";}else{tabHeader.className="mstrTabSetTab";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.addToY2Axis=function(){var selItems=new Array();if(this.y1Cart){var options=this.y1Cart.childNodes;if(options){for(var i=0;i<options.length;i++){var option=options[i];if(option.selected){selItems.push(option);}}}if(selItems.length==0){alert("Please select at least one series from Y1 Axis");}else{if(selItems.length==options.length){alert("There must be at least one series on Y1 Axis");}else{for(var j=0;j<selItems.length;j++){this.y2Cart.appendChild(selItems[j]);}this.y1Cart.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,true);this.renderButtons();if(this.dualYOption){this.updateDualYOption(false);}}}}return false;};mstrGraphAxesTabImpl.prototype.addToY1Axis=function(){var selItems=new Array();if(this.y2Cart){var options=this.y2Cart.childNodes;if(options){for(var i=0;i<options.length;i++){var option=options[i];if(option.selected){selItems.push(option);}}}if(selItems.length==0){alert("Please select at least one series from Y2 Axis");}else{if(selItems.length==options.length){alert("There must be at least one series on Y2 Axis");}else{for(var j=0;j<selItems.length;j++){this.y1Cart.appendChild(selItems[j]);}this.y1Cart.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,true);this.renderButtons();if(this.dualYOption){this.updateDualYOption(false);}}}}return false;};mstrGraphAxesTabImpl.prototype.updateDualYOption=function(isAuto){this.dualYOption=isAuto;var inputOptionAuto=getElementById(this.id+this.PROPERTY_DUAL_Y_OPTION+this.DUAL_Y_OPTION_AUTO);var inputOptionManul=getElementById(this.id+this.PROPERTY_DUAL_Y_OPTION+this.DUAL_Y_OPTION_MANUAL);if(isAuto){inputOptionAuto.checked=true;inputOptionManul.checked=false;}else{inputOptionAuto.checked=false;inputOptionManul.checked=true;}};mstrGraphAxesTabImpl.prototype.swapY1Y2Axis=function(){var y2Options,y1Options;if(this.y2Cart){y2Options=this.y2Cart.childNodes;}if(this.y1Cart){y1Options=this.y1Cart.childNodes;}if(this.y1Cart&&y2Options){this.y1Cart.appendChild(y2Options[0]);}if(this.y2Cart&&y1Options){this.y2Cart.appendChild(y1Options[0]);}this.y1Cart.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,true);};mstrGraphAxesTabImpl.prototype.renderButtons=function(){var y2Options,y1Options;if(this.y2Cart){y2Options=this.y2Cart.childNodes;}if(this.y1Cart){y1Options=this.y1Cart.childNodes;}if(y1Options&&y1Options.length==1&&y2Options&&y2Options.length==1){this.addToY1ButtonCell.style.display="none";this.addToY2ButtonCell.style.display="none";this.swapButtonCell.style.display="block";}else{this.addToY1ButtonCell.style.display="block";this.addToY2ButtonCell.style.display="block";this.swapButtonCell.style.display="none";}};mstrGraphAxesTabImpl.prototype.redistributeSeriesForAutoMode=function(){var y2Options,y1Options;var toY2List=new Array();var toY1List=new Array();var option;var val;var index=0;if(this.y1Cart){y1Options=this.y1Cart.childNodes;for(var i=0;i<y1Options.length;i++){option=y1Options[i];val=option.getAttribute("value");if(val){index=parseInt(val.split("_")[1]);if(index%2==1){toY2List.push(option);}}}}if(this.y2Cart){y2Options=this.y2Cart.childNodes;for(var i=0;i<y2Options.length;i++){option=y2Options[i];val=option.getAttribute("value");if(val){index=parseInt(val.split("_")[1]);if(index%2==0){toY1List.push(option);}}}}for(var i=0;i<toY1List.length;i++){this.y1Cart.appendChild(toY1List[i]);}for(var i=0;i<toY2List.length;i++){this.y2Cart.appendChild(toY2List[i]);}};mstrGraphAxesTabImpl.prototype.applyFormatChanges=function(at,bulkChanges){try{var formatBulkArray=bulkChanges;var auxArray=new Array();for(var axesId in this.settings){var aSettingSet=this.settings[axesId];for(var i=0;i<aSettingSet.length;i++){var aSetting=aSettingSet[i];var cmdId=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var cmdVl=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(cmdId&&(cmdVl||typeof (cmdVl)=="boolean")){auxArray.push(new Array(cmdId,cmdVl));}}}if(auxArray.length>0){formatBulkArray.push(new Array("formatGraphAxisBulk",auxArray));}if(this.isDualAxis&&this.y1Cart.getAttribute(microstrategy.HTMLATTR_CMD_VALUE)){formatBulkArray=this.getSeriesAxesDistribution(formatBulkArray);}return formatBulkArray;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphAxesTabImpl.prototype.getSeriesAxesDistribution=function(bulkAxesDist){var dualYOptionArray=new Array();dualYOptionArray.push("9999");dualYOptionArray.push(new Array("titleDualYOption",this.dualYOption));bulkAxesDist.push(new Array("formatGraphDualAxis",dualYOptionArray));if(!this.dualYOption){if(this.y1Cart){var y1Options=this.y1Cart.childNodes;for(var i=0;i<y1Options.length;i++){var seriesAxesInfo=new Array();option=y1Options[i];val=option.getAttribute("value");if(val){seriesAxesInfo.push(val);}seriesAxesInfo.push(new Array("titleSeriesOnAxis","false"));bulkAxesDist.push(new Array("formatGraphDualAxis",seriesAxesInfo));}}if(this.y2Cart){var y2Options=this.y2Cart.childNodes;for(var i=0;i<y2Options.length;i++){var seriesAxesInfo=new Array();option=y2Options[i];val=option.getAttribute("value");if(val){seriesAxesInfo.push(val);}seriesAxesInfo.push(new Array("titleSeriesOnAxis","true"));bulkAxesDist.push(new Array("formatGraphDualAxis",seriesAxesInfo));}}}return bulkAxesDist;};function mstrGraphAxesTabImpl(id){this.inherits=mstrTabImpl;this.inherits(id);this.inherits=null;return this;}
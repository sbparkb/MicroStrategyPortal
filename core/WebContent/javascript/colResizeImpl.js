mstrColResizeImplScript=true;mstrColResizeImpl.prototype=new Object();mstrColResizeImpl.prototype.isLoaded=false;mstrColResizeImpl.prototype.parentBone=null;mstrColResizeImpl.prototype.path=null;mstrColResizeImpl.prototype.verifiedPath=null;mstrColResizeImpl.prototype.gridWidthInfo=null;mstrColResizeImpl.prototype.needBulkUpdate=true;mstrColResizeImpl.prototype.startCol=0;mstrColResizeImpl.prototype.grid=null;mstrColResizeImpl.prototype.handlesBase=null;mstrColResizeImpl.prototype.colTags=null;mstrColResizeImpl.prototype.colCount=0;mstrColResizeImpl.prototype.fixedRows=0;mstrColResizeImpl.prototype.fixedCols=0;mstrColResizeImpl.prototype.widths=null;mstrColResizeImpl.prototype.gridOffsetHeight=0;mstrColResizeImpl.prototype.leftPos=null;mstrColResizeImpl.prototype.colIndex=0;mstrColResizeImpl.prototype.lines=null;mstrColResizeImpl.prototype.leftLine=null;mstrColResizeImpl.prototype.rightLine=null;mstrColResizeImpl.prototype.scrollOffset=0;mstrColResizeImpl.prototype.caption=null;mstrColResizeImpl.prototype.gridTop=0;mstrColResizeImpl.prototype.offsetLeft=0;mstrColResizeImpl.HTMLATTR_COL_MODE="cwm";mstrColResizeImpl.CHAR_WRAPPING=" charWrap";mstrColResizeImpl.prototype.onresizestart=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);this.gridTop=getObjSumTop(this.grid);this.offsetLeft=getObjSumLeft(this.grid);if(mstr.utils.ISIE8){this.scrollOffset=this.grid.parentNode.scrollLeft;if(!this.headerLocked){this.offsetLeft-=this.scrollOffset;}}else{if(this.headerLocked){this.offsetLeft+=this.scrollOffset;}}var src=this.parentBone.activeElement;this.colIndex=parseInt(src.id.substring(5))+this.startCol;if(!this.leftLine||!this.rightLine||!this.caption){this.createIndicators();}var left=this.leftPos[this.colIndex];var right=left+this.widths[this.colIndex];if(this.headerLocked&&(!this.rowsLocked||this.colIndex>=this.fixedCols)){left-=this.scrollOffset;right-=this.scrollOffset;}this.leftLine.style.left=left+"px";this.rightLine.style.left=right+"px";var h=Math.max(getObjHeight(this.handlesBase)-2,0)+"px";this.leftLine.style.height=h;this.rightLine.style.height=h;this.caption.style.display=this.leftLine.style.display=this.rightLine.style.display="block";this.leftLine.style.visibility="visible";this.rightLine.style.visibility="visible";if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","onresize");this.parentBone.attachWinListener(this,"mouseup","onresizeend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return  "+this.path+".onresize(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return  "+this.path+".onresizeend(e); }");}}catch(err){microstrategy.errors.log(err);}return false;};mstrColResizeImpl.prototype.createIndicators=function(){try{var div=document.createElement("div");div.className="mstrColGuideline";var line1=div.appendChild(document.createElement("div"));line1.style.border="1px solid #ffffff";var line2=div.appendChild(document.createElement("div"));line2.style.border="1px dashed #000000";this.leftLine=this.grid.parentNode.appendChild(div.cloneNode(true));this.rightLine=this.grid.parentNode.appendChild(div.cloneNode(true));div=document.createElement("div");div.className="mstrColCaption";this.caption=this.grid.parentNode.appendChild(div);}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.onresize=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);var leftLinePos=parseInt(this.leftLine.style.left,10);var width=lMouseX-this.offsetLeft-leftLinePos;if(width<0){width=0;}var right=leftLinePos+width;if(this.caption){this.caption.style.top=(lMouseY-this.gridTop-20)+"px";this.caption.style.left=right+"px";if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){width=microstrategy.number.toUserUnits(width/96,true);}else{width=parseFloat(width)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100);}this.caption.innerHTML=microstrategy.number.toLocaleString(parseFloat(width).toFixed(2))+" "+microstrategy.number.unitsLabel;this.caption.style.visibility="visible";}this.rightLine.style.left=right+"px";}catch(err){microstrategy.errors.log(err);}return false;};mstrColResizeImpl.prototype.onresizeend=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);var width=Math.max(lMouseX-this.offsetLeft-parseInt(this.leftLine.style.left,10),0);this.parentBone.onmouseup(e,this.path);this.caption.style.visibility=this.leftLine.style.visibility=this.rightLine.style.visibility="hidden";this.caption.style.display=this.leftLine.style.display=this.rightLine.style.display="none";if(parseInt(this.grid.getAttribute(mstrColResizeImpl.HTMLATTR_COL_MODE))!=mstrGridReport.COL_WIDTH_FIXED){this.setColWidthsMode(mstrGridReport.COL_WIDTH_FIXED);}var objkey=this.colTags[this.colIndex].getAttribute("key");this.setColWidthByKey(objkey,width,this.widths[this.colIndex]);if(this.needBulkUpdate){this.saveAllColWidths(null,false);}else{this.saveSingleColWidth(objkey,width,this.widths[this.colIndex]);}this.delayedSyncCols();}catch(err){microstrategy.errors.log(err);}return false;};mstrColResizeImpl.prototype.oncolresize=function(cmdId,cmdVal1,cmdVal2){try{switch(cmdId){case"setColWidthByKey":if(cmdVal1=="*"){this.setColWidths(cmdVal2);}else{this.setColWidthByKey(this.colTags[cmdVal1].getAttribute("key"),cmdVal2,this.widths[cmdVal1]);}break;case"setColWidthsMode":this.setColWidthsMode(cmdVal1);break;case"setRowHeightMode":this.setRowHeightMode(cmdVal1,cmdVal2);break;}this.delayedSyncCols();}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.delayedSyncCols=function(){try{var that=this;window.setTimeout(function(){that.syncCols();},1);}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.syncCols=function(){try{if(!this.grid){return ;}if(!this.calculateColSizeInfo()){return ;}if(this.parentBone.isFeatureAvailable("grid-layout")){this.positionColHandles();}}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.calculateColSizeInfo=function(){try{this.colTags=this.grid.childNodes[0].childNodes;this.colCount=this.colTags.length;if(this.colCount==0){return false;}this.grid.setAttribute(mstrColResizeImpl.HTMLATTR_COL_MODE,this.gridWidthInfo.colScenario);this.fixedRows=this.parentBone.commands.queryState("fixedRows");this.fixedCols=this.parentBone.commands.queryState("fixedColumns");this.headerLocked=this.parentBone.commands.queryState("checkLockRowHeader")||this.parentBone.commands.queryState("checkLockColHeader");this.rowsLocked=this.parentBone.commands.queryState("checkLockRowHeader");this.gridOffset=this.colTags[0].offsetLeft;if(bIsW3C){if(this.handlesBase&&this.handlesBase.style&&this.handlesBase.style.position){var temp=this.handlesBase.style.position;this.handlesBase.style.position="static";this.handlesBase.style.position=temp;}}if(this.needBulkUpdate&&this.gridWidthInfo){this.needBulkUpdate=(this.gridWidthInfo.colScenario!=mstrGridReport.COL_WIDTH_FIXED);}this.widths=this.getColumnWidths();if(!this.handlesBase){this.handlesBase=findTarget(this.grid,"sty");}this.scrollOffset=this.grid.parentNode.scrollLeft;this.gridOffsetHeight=this.grid.offsetHeight;this.leftPos=this.getLeftPositions();return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrColResizeImpl.prototype.positionColHandles=function(){try{var line,fn,ln;var pid=this.parentBone.id;var cl=function(){if(!line){line=document.createElement("div");line.className="mstrColWidthHandle"+(mstrGridReport.isDesignMode()?" dm":"");line.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_RESIZE_VLINE);}return line.cloneNode(true);};var fn=function(){var e=(arguments.length)?arguments[0]:window.event;if(mstrGridReport.isDesignMode()){return ;}e.cancelBubble=!microstrategy.bone(pid).onmousedown(e);return false;};if(!this.lines){this.lines=[];}var handlePosition=0;var lastFixColPosition=0;if(!this.handlesBase){this.handlesBase=findTarget(this.grid,"sty");}var container=this.headerLocked?this.handlesBase.firstChild:this.handlesBase;var lineHeight=(bIsW3C)?getObjInnerHeight(container):getObjHeight(container);lineHeight=Math.max(0,lineHeight-(mstr.utils.BoxModel.hasScrollbar(container,"x")?SCROLLBAR_SIZE:0));if(lineHeight==0){return ;}var cnt=this.colCount;var delta=[];for(var i=0;i<cnt;i++){if(!this.lines[i]){ln=cl();ln.onmousedown=fn;this.lines[i]=ln;delta.push(ln);}else{ln=this.lines[i];}ln.setAttribute("id","vLine"+i);ln.style.height=(lineHeight-1)+"px";ln.style.display="none";ln.setAttribute("disp",true);handlePosition=this.leftPos[i+this.startCol];handlePosition+=this.widths[i+this.startCol];if(this.rowsLocked&&i<this.fixedCols){lastFixColPosition=handlePosition;}else{if(this.headerLocked){handlePosition-=this.scrollOffset;}}if(handlePosition){ln.style.left=(handlePosition-((i==cnt-1)?5:2))+"px";}if(this.rowsLocked){ln.setAttribute("disp",(handlePosition<lastFixColPosition)?null:"true");}if(mstr.utils.ISIE8){ln.style.background="transparent url(images/1ptrans.gif) repeat";}ln=null;}for(var i=cnt,len=this.lines.length;i<len;i++){ln=this.lines[i];if(ln){ln.style.display="none";}}var that=this;window.setTimeout(function(){for(i=0;i<cnt;i++){ln=that.lines[i];if(ln.getAttribute("disp")){ln.style.display="block";ln.removeAttribute("disp");}}},0);if(delta.length>0){window.setTimeout(function delayedColumnPositioning(){var cw=microstrategy.bone(pid).colWidths;for(var j=0,len=delta.length;j<len;j++){cw.handlesBase.appendChild(delta[j]);}},1);}}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.getLeftPositions=function(){try{var offset=getObjSumLeft(this.grid);var result=[];if(mstr.utils.ISIE8||mstr.utils.ISIE9||mstr.utils.ISIE10){var result=util_getHeaderColumnLeftPosition(this.grid);}else{if(mstr.utils.ISSAFARI||mstr.utils.ISCHROME||mstr.utils.ISW3CIE){var wds=util_getHeaderColumnWidths(this.grid);result[0]=0;for(var i=1;i<this.colCount;i++){result[i]=result[i-1]+wds[i-1];}}else{for(var i=0;i<this.colCount;i++){result[i]=getObjSumLeft(this.colTags[i])-offset;}}}return result;}catch(err){microstrategy.errors.log(err);return[];}};mstrColResizeImpl.prototype.saveAllColWidths=function(ac,saveAllColsAsOne){try{var um=this.parentBone.um;var sendUpdate=(!ac);if(sendUpdate){ac=new Array();}var objIds="|";var newWidths=this.harvestColumnWidths();if(saveAllColsAsOne){ac=this.saveSingleColWidth("allcolumns",newWidths[0],this.widths,ac);this.parentBone.raiseColResizeEvent("setColWidthByKey","*",newWidths[0]);}else{for(var i=this.startCol;i<this.colCount;i++){var objkey=this.colTags[i].getAttribute("KEY");if(objIds.indexOf("|"+objkey+"|")==-1){objIds+=objkey+"|";ac=this.saveSingleColWidth(objkey,newWidths[i],this.widths[i],ac);}}}if(sendUpdate&&ac.length>0){um.add(ac);}this.needBulkUpdate=false;return ac;}catch(err){microstrategy.errors.log(err);return false;}};mstrColResizeImpl.prototype.saveSingleColWidth=function(key,newWidth,oldWidth,ac){try{var um=this.parentBone.um;var sendUpdate=(!ac);if(sendUpdate){ac=new Array();}var ca={objId:this.parentBone.objId};if(this.gridWidthInfo.colScenario!=mstrGridReport.COL_WIDTH_FIXED){ac=this.saveColWidthsMode(mstrGridReport.COL_WIDTH_FIXED,ac);}var encodedWidth=(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?newWidth:microstrategy.getFormatObject().encodeValue("colWidth",newWidth);ac.push(um.createActionObject(this.grid,mstrUpdateManager.RESIZE_SINGLE_COLUMN,this.parentBone.beanPath,["4159","4160","4156","4155"],[key,encodedWidth,"100","100"],[key,oldWidth,"100","100"],ca));this.parentBone.raiseColResizeEvent("setColWidthByKey",this.getColWidthIndex(key),newWidth);if(sendUpdate){um.add(ac);}}catch(err){microstrategy.errors.log(err);}return ac;};mstrColResizeImpl.prototype.saveColWidthsMode=function(mode,ac){try{var um=this.parentBone.um;var sendUpdate=(!ac);if(sendUpdate){ac=new Array();}var ca={objId:this.parentBone.objId};ac.push(um.createActionObject(this.grid,mstrUpdateManager.SET_RESIZE_COLUMNS_SCENARIO,this.parentBone.beanPath,["4153","4156","4155"],[mode,"100","100"],[this.gridWidthInfo.colScenario,"100","100"],ca));this.gridWidthInfo.colScenario=mode;this.parentBone.observer.notifyAll("columnswidthchange");this.parentBone.raiseColResizeEvent("setColWidthsMode",mode,null);if(sendUpdate){um.add(ac);}return ac;}catch(err){microstrategy.errors.log(err);return false;}};mstrColResizeImpl.prototype.saveRowHeightMode=function(mode,height,ac){try{var um=this.parentBone.um;var sendUpdate=(!ac);if(sendUpdate){ac=new Array();}var ca={objId:this.parentBone.objId};if(height&&height.length){this.gridWidthInfo.rowHeight=height;}height=parseInt(height);if(mstr.utils.ISIE6||mstr.utils.ISIE7){height=!isNaN(height)?height+1:"";}ac.push(um.createActionObject(this.grid,mstrUpdateManager.SET_RESIZE_ROW_SCENARIO,this.parentBone.beanPath,["4154","4157"],[mode,height],[this.gridWidthInfo.rowScenario,this.gridWidthInfo.rowHeight],ca));this.gridWidthInfo.rowScenario=mode;this.parentBone.raiseColResizeEvent("setRowHeightMode",mode,height);if(sendUpdate){um.add(ac);}return ac;}catch(err){microstrategy.errors.log(err);return false;}};mstrColResizeImpl.prototype.setColWidthsMode=function(mode){try{var i;this.grid.className=this.grid.className.replace(mstrColResizeImpl.CHAR_WRAPPING,"");switch(mode){case mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY:if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION&&microstrategy.getViewerBone().commands.queryState("Wmode")==microstrategy.AUTO_MODE){return this.setColWidthsMode(mstrGridReport.COL_WIDTH_FIT_TO_CONTENT);}if(this.grid.parentNode.clientWidth>0&&(this.parentBone.lockSet||microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION)){this.grid.style.width=(this.grid.parentNode.clientWidth-3)+"px";this.grid.style.tableLayout="auto";}else{this.grid.style.tableLayout="auto";this.grid.style.width="100%";}this.parentBone.resizeLockSet(true);for(i=0;i<this.colTags.length;i++){this.colTags[i].style.width="";this.colTags[i].style[(bIsW3C)?"visibility":"display"]="";}break;case mstrGridReport.COL_WIDTH_FIT_TO_CONTENT:this.grid.style.tableLayout="auto";this.grid.style.width="";if(this.grid.width){this.grid.width="";}for(i=0;i<this.colTags.length;i++){this.colTags[i].style.width="";this.colTags[i].style[(bIsW3C)?"visibility":"display"]="";}this.grid.style.position="relative";var that=this;var x=function(){that.grid.style.position="";};window.setTimeout(x,0);this.parentBone.resizeLockSet(true);break;case mstrGridReport.COL_WIDTH_FIXED:if(microstrategy.wrapCharacterEnabled!="0"){this.grid.className+=mstrColResizeImpl.CHAR_WRAPPING;}var tempWidths=this.getColumnWidths();tempWidths=util_resolveRepeatedColumnWidths(tempWidths,this.colTags);this.grid.style.width="";if(this.grid.width){this.grid.width="";}this.grid.style.tableLayout="fixed";var gridSize=0;for(i=0;i<this.colTags.length;i++){gridSize+=tempWidths[i];this.setSingleColumnWidth(i,tempWidths[i],this.resolveColDisplay(tempWidths[i]));}this.grid.style.width=gridSize+"px";break;}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrColResizeImpl.prototype.resolveColDisplay=function(width){try{var result={p:"width",v:"0px"};if(width>0){result.p=(bIsW3C)?"visibility":"display";result.v="";}else{if(bIsW3C){result.p="visibility";result.v="collapse";}else{if(bIsIE4){result.p="display";result.v="none";}}}return result;}catch(err){microstrategy.errors.log(err);return{};}};mstrColResizeImpl.prototype.ensureFixedColMode=function(){try{if(this.grid.style.tableLayout!="fixed"){this.setColWidthsMode(mstrGridReport.COL_WIDTH_FIXED);}}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.setColWidthByKey=function(key,newWidth,oldWidth){try{this.ensureFixedColMode();var i,cnt;var cols=[];for(i=0;i<this.colCount;i++){if(this.colTags[i].getAttribute("key")==key){cols.push(i);}}this.grid.style.width=Math.max(parseInt(this.grid.style.width)+cols.length*(newWidth-oldWidth),0)+"px";var displayProps=this.resolveColDisplay(newWidth);if(cols&&cols.length){for(i=0,cnt=cols.length;i<cnt;i++){this.setSingleColumnWidth(cols[i],newWidth,displayProps);}}var gridBoneSpan=this.parentBone.gridSpan;if(gridBoneSpan){var container=this.parentBone.getParentSubsection(),containerHeight=parseInt(container.elem.style.height),gridHeight=gridBoneSpan.offsetHeight,cg=parseInt(microstrategy.styleObj.getAttValue(container.elem,microstrategy.HTMLATTR_CAN_GROW));if(gridHeight>containerHeight&&cg){container.simpleResize(gridHeight);}}}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.setColWidths=function(newWidth){try{this.ensureFixedColMode();this.grid.style.width=(this.colTags.length*newWidth)+"px";var displayProps=this.resolveColDisplay(newWidth);for(var i=0;i<this.colTags.length;i++){this.setSingleColumnWidth(i,newWidth,displayProps);}}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.setColWidthByIndex=function(index,newWidth,oldWidth){try{this.ensureFixedColMode();this.grid.style.width=parseInt(this.grid.style.width)+newWidth-oldWidth+"px";this.setSingleColumnWidth(index,newWidth,this.resolveColDisplay(newWidth));}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.setSingleColumnWidth=function(index,width,props){try{var col=this.colTags[index];col.style.width=width+((mstr.utils.ISIE8&&col.style.width=="")?1:0)+"px";if(mstr.utils.ISCHROME&&width<=0){col.style.width="0%";}col.style[props.p]=props.v;this.nowrapHiddenColumn(index,width);}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.nowrapHiddenColumn=function(colIndex,width){var grid=this.grid;this.nowrapHidColOnGrid(colIndex,width,grid);if(this.parentBone.lockSet){var quadrants=this.parentBone.lockSet.quadrants;for(var i=1;i<quadrants.length;i++){var headerGrid=quadrants[i]&&quadrants[i].firstChild;if(headerGrid){this.nowrapHidColOnGrid(colIndex,width,headerGrid);}}}};mstrColResizeImpl.prototype.nowrapHidColOnGrid=function(colIndex,width,grid){var tbody=grid.getElementsByTagName("TBODY")[0];if(!tbody||this.grid.style.tableLayout!="fixed"){return ;}var i,j,row,rowCount,cell,firstIndex,currentIndex,colspan,cellWidth,stop,colCount=this.colCount,showCell=width>0,widths=this.getColumnWidths();for(i=0;i<tbody.rows.length;i++){row=tbody.rows[i];currentIndex=colCount-1;colspan=0;for(j=row.cells.length-1;j>=0;j--){cell=row.cells[j];colspan=cell.getAttribute("colspan")||1;if(colspan>1){cellWidth=0;for(k=0;k<colspan;k++){cellWidth+=widths[currentIndex];currentIndex--;}if(cellWidth<=0&&cell.className.indexOf("nwFixedWidth0")==-1){cell.className=cell.className+" nwFixedWidth0";}else{if(cellWidth>0&&cell.className.indexOf("nwFixedWidth0")>-1){cell.className=cell.className.replace(/nwFixedWidth0/g,"");}}}else{if(widths[currentIndex]<=0&&cell.className.indexOf("nwFixedWidth0")==-1){cell.className=cell.className+" nwFixedWidth0";}else{if(widths[currentIndex]>0&&cell.className.indexOf("nwFixedWidth0")>-1){cell.className=cell.className.replace(/nwFixedWidth0/g,"");}}currentIndex--;}}}};mstrColResizeImpl.prototype.setRowHeightMode=function(mode,height){try{if(mode!=mstrGridReport.COL_WIDTH_FIT_TO_CONTENT&&mode!=mstrGridReport.COL_WIDTH_FIXED){return ;}this.setRowHeight(height);}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.setRowHeight=function(height){try{var startRow=this.fixedRows;var endRow=this.grid.rows.length-1;if(startRow>endRow){startRow=0;}util_applySingleRowHeight(this.grid,height,startRow,endRow);}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.getColWidthByKey=function(key){try{for(var i=0;i<this.colTags.length;i++){if(this.colTags[i].getAttribute("key")==key){return this.widths[i];}}}catch(err){microstrategy.errors.log(err);}return 0;};mstrColResizeImpl.prototype.getColWidthByIndex=function(index){try{return this.widths[index];}catch(err){microstrategy.errors.log(err);}return 0;};mstrColResizeImpl.prototype.getColWidthIndex=function(key){try{for(var i=0;i<this.colTags.length;i++){if(this.colTags[i].getAttribute("key")==key){return i;}}}catch(err){microstrategy.errors.log(err);}return 0;};mstrColResizeImpl.prototype.getRowHeight=function(){try{var rowCount=this.grid.rows.length;var row=(this.fixedRows<rowCount)?this.grid.rows[this.fixedRows]:this.grid.rows[rowCount-1];return(row.style.height.length>0)?parseInt(row.style.height):getObjHeight(row);}catch(err){microstrategy.errors.log(err);}return 0;};mstrColResizeImpl.prototype.getColWidthsObj=function(){try{var __result=new Object();__result.colScenario=this.gridWidthInfo.colScenario;__result.rowScenario=this.gridWidthInfo.rowScenario;__result.rowHeight=this.gridWidthInfo.rowHeight;var widths=new Object();var objIds="|";for(var i=0;i<this.colTags.length;i++){var objkey=this.colTags[i].getAttribute("KEY");if(objIds.indexOf("|"+objkey+"|")==-1){objIds+=objkey+"|";widths[objkey]=this.getColWidthByKey(objkey);}}__result.widths=widths;}catch(err){microstrategy.errors.log(err);}return __result;};mstrColResizeImpl.prototype.cancelAllOperations=function(){try{this.setRowHeightMode(this.gridWidthInfo.rowScenario,this.gridWidthInfo.rowHeight);this.setColWidthsMode(this.gridWidthInfo.colScenario);if(this.gridWidthInfo.colScenario==mstrGridReport.COL_WIDTH_FIXED){this.restoreColumns();}this.delayedSyncCols();}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.restoreColumns=function(){try{var newWidths=this.getColumnWidths();for(var i=0;i<this.colTags.length;i++){this.setColWidthByIndex(i,this.widths[i],newWidths[i]);}}catch(err){microstrategy.errors.log(err);}};mstrColResizeImpl.prototype.getColumnWidths=function(){try{var widths=[];var hcw=this.harvestColumnWidths();var validHarvest=hcw.length>0&&!isNaN(hcw[0]);if(!mstr.utils.ISIE4&&this.gridWidthInfo.colScenario==mstrGridReport.COL_WIDTH_FIXED&&validHarvest){widths=hcw;}else{widths=util_getHeaderColumnWidths(this.grid);}return widths;}catch(err){microstrategy.errors.log(err);return[];}};mstrColResizeImpl.prototype.harvestColumnWidths=function(){try{var __result=new Array();for(var i=0;i<this.colTags.length;i++){__result.push(parseInt(this.colTags[i].style.width));}return __result;}catch(err){microstrategy.errors.log(err);return false;}};function mstrColResizeImpl(target,path,parentBone){this.grid=target;this.path=path;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.parentBone=parentBone;this.gridWidthInfo=parentBone.gridWidthInfo;this.startCol=(this.gridWidthInfo.useExtraColTag)?1:0;this.isLoaded=true;return this;}
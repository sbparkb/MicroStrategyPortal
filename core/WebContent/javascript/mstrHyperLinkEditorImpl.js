mstrHyperLinkEditorImplScript=true;mstrHyperLinkEditorImpl.prototype=new mstrEditorImpl();mstrHyperLinkEditorImpl.prototype.objKey="";mstrHyperLinkEditorImpl.prototype.isNewLink=false;mstrHyperLinkEditorImpl.prototype.linkIndex=0;mstrHyperLinkEditorImpl.prototype.urlType=-1;mstrHyperLinkEditorImpl.prototype.TypeURL="0";mstrHyperLinkEditorImpl.prototype.TypeRunObject="1";mstrHyperLinkEditorImpl.prototype.onload=function(e){mstrEditorImpl.prototype.onload.call(this);this.updateCheck(document.getElementById(this.id+"obUrlType"));if(this.elem){var appliesTo=this.elem.getAttribute("at");if(appliesTo&&appliesTo.length>0){this.setAppliesTo(appliesTo);}}};mstrHyperLinkEditorImpl.prototype.onunload=function(e){try{mstrEditorImpl.prototype.onunload.call(this,e);var bone=this.getAppliesTo();if(bone&&bone.observer){bone.observer.unregister(this.id);}}catch(err){microstrategy.errors.log(err);}return true;};mstrHyperLinkEditorImpl.prototype.updateCheck=function(obj){try{if(obj){switch(obj.getAttribute(microstrategy.HTMLATTR_CMD_ID)){case"URLType":var objs=document.getElementsByName(obj.name);var value=this.TypeURL;for(i=0;i<objs.length;i++){if(objs[i].checked==true){value=objs[i].value;break;}}if(value==this.TypeURL){this.enableOptionAndLabel(document.getElementById(this.id+"obUrl"));this.disableOptionAndLabel(document.getElementById(this.id+"obPromptAns1"));this.disableOptionAndLabel(document.getElementById(this.id+"obPromptAns2"));this.disableOptionAndLabel(document.getElementById(this.id+"obPromptAns3"));this.disableOptionAndLabel(document.getElementById(this.id+"availableUnits"));this.disableOptionAndLabel(document.getElementById(this.id+"selectedUnits"));this.urlType=this.TypeURL;}else{if(value==this.TypeRunObject){this.disableOptionAndLabel(document.getElementById(this.id+"obUrl"));this.enableOptionAndLabel(document.getElementById(this.id+"obPromptAns1"));this.enableOptionAndLabel(document.getElementById(this.id+"obPromptAns2"));this.enableOptionAndLabel(document.getElementById(this.id+"obPromptAns3"));this.enableOptionAndLabel(document.getElementById(this.id+"availableUnits"));this.enableOptionAndLabel(document.getElementById(this.id+"selectedUnits"));this.urlType=this.TypeRunObject;}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrHyperLinkEditorImpl.prototype.exec=function(cmdID,cmdValue){try{switch(cmdID){case"UpdateObjectInfo":var inputID=document.getElementById(this.id+"obObjectID");var inputName=document.getElementById(this.id+"obObjectName");var objType=document.getElementById(this.id+"obObjectType");var objSubType=document.getElementById(this.id+"obObjectSubType");if(inputName&&inputID){var values=cmdValue.split("\u001E");inputID.value=values[0];inputName.value=values[1];objType.value=values[2];objSubType.value=values[3];inputName.setAttribute("title",values[1]);}var docURLType=document.getElementById(this.id+"obURLType2");if(docURLType){docURLType.checked=true;}this.updateCheck(document.getElementById(this.id+"obUrlType"));break;}}catch(err){microstrategy.errors.log(err);return null;}};mstrHyperLinkEditorImpl.prototype.disableOptionAndLabel=function(option){try{if(option){option.disabled=true;option.className="disabled";if(document.getElementById(option.id+"_label")){document.getElementById(option.id+"_label").className="disabledLabel";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrHyperLinkEditorImpl.prototype.enableOptionAndLabel=function(option){try{if(option){option.disabled=false;option.className="";if(document.getElementById(option.id+"_label")){document.getElementById(option.id+"_label").className="";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrHyperLinkEditorImpl.prototype.apply=function(){try{var ac=new Array();var um=microstrategy.updateManager;var linkName=document.getElementById(this.id+"obUrlName").value;var newwindow=document.getElementById(this.id+"obNewWin").checked?"1":"0";var appliesTo=this.getAppliesTo();var doc=appliesTo.doc;var selections=appliesTo.doc.selections;var rwbViewerBeanPath=appliesTo.beanPath;selections.processFormatProperty(selections.setSingleFormat("fstyle",4),ac);doc.formatIsLink(selections.items,"-1",ac);if(this.urlType==this.TypeURL){var url=document.getElementById(this.id+"obUrl").value;doc.formatAttribute(selections.items,"link",url,false,microstrategy.HTMLATTR_LINK_HREFVALUE);doc.formatAttribute(selections.items,"link",url,false,microstrategy.HTMLATTR_LINK_HREF);if(this.isNewLink){ac.push(um.createActionObject(this.elem,mstrUpdateManager.ADD_HYPERLINK_TEXT,rwbViewerBeanPath,["2048012","2048148","2048145","2048147","2048149"],[this.objKey,linkName,url,"1",newwindow],[]));}else{ac.push(um.createActionObject(this.elem,mstrUpdateManager.EDIT_HYPERLINK_TEXT,rwbViewerBeanPath,["2048012","2048148","2048144","2048145","2048147","2048149"],[this.objKey,linkName,this.linkIndex,url,"1",newwindow],[]));}}else{var objID=document.getElementById(this.id+"obObjectID").value;var objName=document.getElementById(this.id+"obObjectName").value;var objType=document.getElementById(this.id+"obObjectType").value;var objSubType=document.getElementById(this.id+"obObjectSubType").value;var attrs="";var selected=document.getElementById(this.id+"selectedUnits");for(var i=0;i<selected.options.length;i++){if(selected.options[i].value!="-none-"){attrs=attrs+selected.options[i].value;if(i<selected.options.length-1){attrs=attrs+",";}}}var ansType="";var ans=document.getElementsByName(this.id+"obPromptAns");for(var i=0;i<ans.length;i++){if(ans[i].checked==true){ansType=ans[i].value;break;}}if(this.isNewLink){ac.push(um.createActionObject(this.elem,mstrUpdateManager.ADD_HYPERLINK_TEXT,rwbViewerBeanPath,["2048012","2048148","2048146","2048147","2048149","2048150","2048151","2048182","2048153"],[this.objKey,linkName,attrs,"1",newwindow,objID,objType,objSubType,ansType],[]));}else{ac.push(um.createActionObject(this.elem,mstrUpdateManager.EDIT_HYPERLINK_TEXT,rwbViewerBeanPath,["2048012","2048148","2048144","2048146","2048147","2048149","2048150","2048151","2048152","2048153"],[this.objKey,linkName,this.linkIndex,attrs,"1",newwindow,objID,objType,objSubType,ansType],[]));}}var delOthers=document.getElementById(this.id+"obDelOthers");if(delOthers&&delOthers.checked){ac.push(um.createActionObject(this.elem,mstrUpdateManager.DELETE_HYPERLINK,rwbViewerBeanPath,["2048012","2048154"],[this.objKey,"1",],[]));}um.add(ac);}catch(err){microstrategy.errors.log(err);return false;}};mstrHyperLinkEditorImpl.prototype.applyChanges=function(){try{this.apply();if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){microstrategy.updateManager.flushAndSubmitChanges();}}catch(err){microstrategy.errors.log(err);return false;}};mstrHyperLinkEditorImpl.prototype.okChanges=function(){try{this.apply();this.closeEditor();if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){microstrategy.updateManager.flushAndSubmitChanges();}}catch(err){microstrategy.errors.log(err);return false;}};mstrHyperLinkEditorImpl.prototype.setAppliesTo=function(bone){try{if(!this.appliesTo){this.appliesTo=(typeof (bone)=="string")?bone:bone.id;}bone=microstrategy.bone(this.appliesTo);if(bone.observer){bone.observer.register(this.id);}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrHyperLinkEditorImpl.prototype.getAppliesTo=function(){try{if(this.appliesTo){var bone=microstrategy.bone(this.appliesTo);return bone;}return null;}catch(err){microstrategy.errors.log(err);return false;}};function mstrHyperLinkEditorImpl(id){this.inherits=mstrEditorImpl;this.inherits(id);delete this.inherits;return this;}
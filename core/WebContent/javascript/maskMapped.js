microstrategy.HTMLATTR_MAPS="MAPS";microstrategy.HTMLATTR_MAPS_DELIM=",";mstrMaskMappedImpl.prototype=new mstrMaskImpl();mstrMaskMappedImpl.prototype.maps=null;mstrMaskMappedImpl.prototype.mask=null;mstrMaskMappedImpl.prototype.hiLite=null;mstrMaskMappedImpl.prototype.surroundHilite=null;mstrMaskMappedImpl.MASK_TYPE=-1;mstrMaskMappedImpl.prototype.onload=function(maskedBone){try{this.maskedBone=maskedBone;this.initElem();var span=document.createElement("span");span.className="mstrMaskedHilite";span.style.visibility="hidden";this.hiLite=span;this.elem.appendChild(this.hiLite);if(this.maskedBone&&this.maskedBone.maskFor){var s=this.maskedBone.maskFor;this.maskfor=microstrategy.HTMLATTR_MASKFOR_DELIM+s+microstrategy.HTMLATTR_MASKFOR_DELIM;var a=s.split(microstrategy.HTMLATTR_MASKFOR_DELIM);this.maps=new Object();var mapSource=document.getElementById("useMap");for(var i=0;i<a.length;i++){var mapId=this.maskedBone.id+"_map"+a[i]+(this.midx?this.midx:"");var map=mapSource.cloneNode(false);map.name=mapId;map.setAttribute("id",mapId);map.setAttribute(microstrategy.HTMLATTR_MASKEDOBJECT,this.maskedBone.id);map.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK_MAP);map.setAttribute(microstrategy.HTMLATTR_MASKFOR,a[i]);this.maps[a[i]]=map;var oldMap=document.getElementById(mapId);if(oldMap){document.body.removeChild(oldMap);}document.body.appendChild(this.maps[a[i]]);}this.maskedBone.maskFor=mstrMaskMappedImpl.MASK_TYPE;this.mask=new mstrMaskImpl();this.mask.onload(this.maskedBone);this.maskedBone.maskFor=s;this.onmaskedobjectresize(true);}this.isLoaded=true;}catch(err){microstrategy.errors.log(err);}};mstrMaskMappedImpl.prototype.onmaskedobjectresize=function(onload){try{if(this.maskedBone){if(onload!=true){var g=this.maskedBone.gridStructureInfo;if(g&&g.colAxis&&g.colAxis.units&&g.colAxis.units[0]){g.colAxis.units[0].needBuildColMetricAreas=true;}}var that=this;window.setTimeout(function(){that.resizeMask();},0);}}catch(err){microstrategy.errors.log(err);}};mstrMaskMappedImpl.prototype.sizeMask=function(h,w){try{if(!this.img){return ;}this.img.style.height=h+"px";this.img.style.width=w+"px";}catch(err){microstrategy.errors.log(err);}};mstrMaskMappedImpl.prototype.resizeMask=function(){try{if(this.maskedBone==null){return ;}var i;var d={height:getObjHeight(this.maskedBone.maskArea),width:this.maskedBone.maskArea.scrollWidth,top:getObjSumTop(this.maskedBone.maskArea),left:getObjSumLeft(this.maskedBone.maskArea)};this.sizeMask(d.height,d.width);this.mask.onmaskedobjectresize(d.height,d.width);this.updateMaskDimensions&&this.updateMaskDimensions(d);for(var id in this.maps){var map=this.maps[id];for(i=map.childNodes.length-1;i>=0;i--){map.removeChild(map.childNodes[i]);}var areas=this.maskedBone.mapper.getAreas(this.maskedBone,map,d);if(areas){for(i=0;i<areas.length;i++){var areaInfo=areas[i];var area=document.createElement("area");area.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK_MAP_AREA);area.shape=(areaInfo.shape)?areaInfo.shape:"rect";area.coords=(areaInfo.coords)?areaInfo.coords:"0,0,0,0";if(areaInfo.pointsTo){area.setAttribute(microstrategy.HTMLATTR_POINTS_TO,areaInfo.pointsTo);}if(areaInfo.onmouseovercoords){if(areaInfo.moveHilite){area.onmouseover=new Function("microstrategy.bone('"+this.maskedBone.id+"').mask.moveHilite('"+areaInfo.onmouseovercoords+"');");var mouseoutFn=new Function("microstrategy.bone('"+this.maskedBone.id+"').mask.hiLite && (microstrategy.bone('"+this.maskedBone.id+"').mask.hiLite.style.visibility = 'hidden');");if(mstrGridReport&&mstrGridReport.isRWD()&&mstr.utils.ISIE7){area.attachEvent("onmouseout",mouseoutFn);}else{area.onmouseout=mouseoutFn;}}else{arnea.onmouseover=new Function("microstrategy.bone('"+this.maskedBone.id+"').mask.moveSurroundHilite('"+areaInfo.onmouseovercoords+"');");area.onmouseout=new Function("microstrategy.bone('"+this.maskedBone.id+"').mask.surroundHilite.style.visibility = 'hidden';");}}map.appendChild(area);}}}}catch(err){microstrategy.errors.log(err);}};mstrMaskMappedImpl.prototype.toggle=function(show,maskFor){try{if(!show||maskFor==mstrMaskMappedImpl.MASK_TYPE){this.mask.toggle(show,maskFor);}if(show&&this.maps[maskFor]){this.img.useMap="#"+this.maskedBone.id+"_map"+maskFor+(this.midx?this.midx:"");this.elem.style.display="block";}else{this.elem.style.display="none";this.hiLite.style.visibility="hidden";if(this.surroundHilite){this.surroundHilite.style.visibility="hidden";}}}catch(err){microstrategy.errors.log(err);}};mstrMaskMappedImpl.prototype.moveHilite=function(s){try{if(!this.hiLite){return ;}var a=s.split(",");with(this.hiLite.style){if(visibility=="hidden"){left=a[0]+"px";top=a[1]+"px";height=a[2]+"px";width=a[3]+"px";visibility="visible";}}}catch(err){microstrategy.errors.log(err);}};mstrMaskMappedImpl.prototype.moveSurroundHilite=function(s){try{if(!this.surroundHilite){var span=document.createElement("span");span.className="mstrMaskedSurroundHilite";this.surroundHilite=span;this.elem.appendChild(this.surroundHilite);}var a=s.split(",");with(this.surroundHilite.style){if(visibility=="hidden"){left=a[0]+"px";top=a[1]+"px";height=a[2]+"px";width=a[3]+"px";visibility="visible";}}}catch(err){microstrategy.errors.log(err);}};function mstrMaskMappedImpl(fnUpdateMaskDimensions){this.updateMaskDimensions=fnUpdateMaskDimensions;return this;}mstrTabStripMask.prototype=new mstrMaskMappedImpl();mstrTabStripMask.prototype.sizeMask=function(h,w){try{this.maskedBone.shiftMaskArea();mstrMaskMappedImpl.prototype.sizeMask.call(this,h,w);this.maskedBone.restoreMaskArea();}catch(err){microstrategy.errors.log(err);}};function mstrTabStripMask(){return this;}
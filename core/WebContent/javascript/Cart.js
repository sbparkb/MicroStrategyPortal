cartScript=true;function AddItemsToList(sFromList,sToList,sToListHidden){MoveItemsToList(sFromList,sToList,sToListHidden);UpdateHiddenSelectedValue(sToList,sToListHidden);}function AddAllItemsToList(sFromList,sToList,sToListHidden){MoveAllItemsToList(sFromList,sToList,sToListHidden);UpdateHiddenSelectedValue(sToList,sToListHidden);}function RemoveItemsFromList(sFromList,sToList,sToListHidden){MoveItemsToList(sToList,sFromList,sToListHidden);UpdateHiddenSelectedValue(sToList,sToListHidden);}function RemoveAllItemsToList(sFromList,sToList,sToListHidden){MoveAllItemsToList(sToList,sFromList,sToListHidden);UpdateHiddenSelectedValue(sToList,sToListHidden);}function AddItemsToListAndBuildPreview(sFromList,sToList,sToListHidden,sGroupPreview){MoveItemsToList(sFromList,sToList,sToListHidden);UpdateHiddenSelectedValue(sToList,sToListHidden);BuildPreviewWindow(sGroupPreview,sFromList,sToList);}function AddAllItemsToListAndBuildPreview(sFromList,sToList,sToListHidden,sGroupPreview){MoveAllItemsToList(sFromList,sToList,sToListHidden);UpdateHiddenSelectedValue(sToList,sToListHidden);BuildPreviewWindow(sGroupPreview,sFromList,sToList);}function RemoveItemsFromListAndBuildPreview(sFromList,sToList,sToListHidden,sGroupPreview){MoveItemsToList(sToList,sFromList,sToListHidden);UpdateHiddenSelectedValue(sToList,sToListHidden);BuildPreviewWindow(sGroupPreview,sFromList,sToList);BuildPreviewWindow(sGroupPreview,sFromList,sToList);}function RemoveAllItemsToListAndBuildPreview(sFromList,sToList,sToListHidden,sGroupPreview){MoveAllItemsToList(sToList,sFromList,sToListHidden);UpdateHiddenSelectedValue(sToList,sToListHidden);BuildPreviewWindow(sGroupPreview,sFromList,sToList);}function MoveItemsToList(sFromList,sToList,sToListHidden){var oFromList=getObj(sFromList);var oToList=getObj(sToList);if((oFromList!=null)&&(oToList!=null)){var i;var lLength;var oOption;var aPreSelected=new Array();var bSomethingSelected;bSomethingSelected=false;bSelectFirstItem=true;var fromListCount=oFromList.options.length;for(i=0;i<fromListCount;i++){if(oFromList.options[i].selected){bSelectFirstItem=false;break;}}if(bSelectFirstItem&&(fromListCount>0)){if(oFromList.options[0].value!="-none-"){oFromList.options[0].selected=true;}}for(i=0;i<oFromList.options.length;i++){if(oFromList.options[i].selected&&oFromList.options[i].value!="-none-"){if(IsItemInList(oToList,oFromList.options[i])==false){bSomethingSelected=true;oOption=new Option(oFromList.options[i].text,oFromList.options[i].value,false,false);aPreSelected[aPreSelected.length]=oOption.text;if((oToList.options.length==1)&&(oToList.options[0].value=="-none-")){oToList.options[0]=oOption;}else{oToList.options[oToList.length]=oOption;}}}}if(bSomethingSelected){ClearSelectedItems(oFromList);CheckPreSelectedItems(oToList,aPreSelected);}}}function MoveAllItemsToList(sFromList,sToList,sToListHidden){var oFromList=getObj(sFromList);var oToList=getObj(sToList);if((oFromList!=null)&&(oToList!=null)){var i;var lLength;var oOption;var aPreSelected=new Array();var bSomethingSelected=false;for(i=0;i<oFromList.options.length;i++){if((oFromList.options[i].value!="-none-")&&(IsItemInList(oToList,oFromList.options[i])==false)){bSomethingSelected=true;oOption=new Option(oFromList.options[i].text,oFromList.options[i].value,false,false);aPreSelected[aPreSelected.length]=oOption.text;if((oToList.options.length==1)&&oToList.options[0].value=="-none-"){oToList.options[0]=oOption;}else{oToList.options[oToList.length]=oOption;}oFromList.options[i].selected=true;}}if(bSomethingSelected){ClearSelectedItems(oFromList);CheckPreSelectedItems(oToList,aPreSelected);}}}function ClearSelectedItems(oList){if(oList!=null){for(var i=0;i<oList.options.length;i++){if(oList.options[i].selected){oList.options[i]=null;i--;}}if(oList.options.length==0){var noneDesc=microstrategy&&microstrategy.descriptors&&microstrategy.descriptors.getDescriptor("512")||"--- none ---";var oOption=new Option(noneDesc,"-none-",false,false);oList.options[0]=oOption;}}return oList;}function MoveItemsInListUpAndBuildPreview(sFromList,sToList,sToListHidden,sGroupPreview){MoveItemsInListUp(sToList,sToListHidden);UpdateHiddenSelectedValue(sToList,sToListHidden);BuildPreviewWindow(sGroupPreview,sFromList,sToList);}function MoveItemsInListUp(sList,sToListHidden){var oTempOptionText;var oTempOptionValue;var i;var aPreSelected=new Array();var bSomethingSelected;var oList=getObj(sList);bSomethingSelected=false;for(i=1;i<oList.options.length;i++){if(oList.options[i].selected){bSomethingSelected=true;aPreSelected[aPreSelected.length]=oList.options[i].text;oTempOptionText=oList.options[i].text;oTempOptionValue=oList.options[i].value;oList.options[i].text=oList.options[i-1].text;oList.options[i].value=oList.options[i-1].value;oList.options[i-1].text=oTempOptionText;oList.options[i-1].value=oTempOptionValue;}}if(bSomethingSelected){CheckPreSelectedItems(oList,aPreSelected);}}function MoveItemsInListDownAndBuildPreview(sFromList,sToList,sToListHidden,sGroupPreview){MoveItemsInListDown(sToList,sToListHidden);UpdateHiddenSelectedValue(sToList,sToListHidden);BuildPreviewWindow(sGroupPreview,sFromList,sToList);}function MoveItemsInListDown(sList,sToListHidden){var oTempOptionText;var oTempOptionValue;var i;var aPreSelected=new Array();var bSomethingSelected;bSomethingSelected=false;var oList=getObj(sList);for(i=oList.options.length-1;i>-1;i--){if(oList.options[i].selected&&i+1<oList.options.length){bSomethingSelected=true;aPreSelected[aPreSelected.length]=oList.options[i].text;oTempOptionText=oList.options[i].text;oTempOptionValue=oList.options[i].value;oList.options[i].text=oList.options[i+1].text;oList.options[i].value=oList.options[i+1].value;oList.options[i+1].text=oTempOptionText;oList.options[i+1].value=oTempOptionValue;}}if(bSomethingSelected){CheckPreSelectedItems(oList,aPreSelected);}}function UncheckSelectionsOnList(oList){var i;for(i=0;i<oList.options.length;i++){oList.options[i].selected=false;}}function CheckPreSelectedItems(oList,aPreSelected){var i;var j;UncheckSelectionsOnList(oList);for(i=0;i<oList.options.length;i++){for(j=0;j<aPreSelected.length;j++){if(aPreSelected[j]==oList.options[i].text){oList.options[i].selected=true;}}}}function IsItemInList(oList,sElement){var i;for(i=0;i<oList.options.length;i++){if(oList.options[i].text==sElement.text){return true;}}return false;}function UpdateHiddenSelectedValue(sList,sToListHidden){var sHidden;var i;sHidden="";var oHiddenList=getObj(sToListHidden);var oList=getObj(sList);if((oHiddenList!=null)&&(oList!=null)){for(i=0;i<oList.options.length;i++){if(oList.options[i].value!="-none-"){if(sHidden==""){sHidden=oList.options[i].value;}else{sHidden=sHidden+unescape(window.CART_UNIT_SEPARATOR||UNIT_SEPARATOR)+oList.options[i].value;}}}oHiddenList.value=sHidden;}}function BuildPreviewWindow(sDivPreview,sFromList,sToList){var divPreview=getObj(sDivPreview);var sel=getObj(sToList);if(sel&&divPreview){ClearPreviewWindow(divPreview);var offset=0;var i=0;for(i=0;i<sel.options.length;i++){if(sel.options[i].value!="-none-"){offset=3*i;var divSection=document.createElement("div");divSection.className="imgSection";divSection.style.left=String(offset)+"px";divSection.style.width=String(100-offset)+"px";divSection.innerHTML=String(sel.options[i].text);divPreview.appendChild(divSection);}}offset+=3;var divDetails=document.createElement("div");divDetails.className="imgDetails";divDetails.style.left=String(offset)+"px";divDetails.style.width=String(100-offset)+"px";var sDetails="";var selFrom=getObj(sFromList);if(selFrom){for(i=0;i<selFrom.options.length;i++){if(selFrom.options[i].value!="-none-"){sDetails+=", "+String(selFrom.options[i].text);}}if(sDetails.length>0){sDetails=sDetails.substr(2);}if(sMetricsList&&sMetricsList.length>0){if(sDetails.length>0){sDetails=sDetails+", ";}var sRegExp=/\|/g;sDetails=sDetails+sMetricsList.replace("|",", ");}}divDetails.innerHTML="<nobr>"+sDetails+"</nobr>";divPreview.appendChild(divDetails);var iHeight=getObjSumTop(divPreview)+getObjHeight(divPreview)-getObjSumTop(divDetails)-10;if(iHeight<10){iHeight=130;}divDetails.style.height=iHeight+"px";}}function ClearPreviewWindow(preview){if(!preview){return false;}var count=preview.childNodes.length-1;for(var i=count;i>-1;i--){if(preview.childNodes[i].getAttribute("class")!="imgCorner"){preview.removeChild(preview.childNodes[i]);}}}function setMetricsList(sList){if(sList){sMetricsList=sList;}}function toggleCartCurtain(idx,visible){var cardIdPrefix="mstrCartCurtain";var elCurtain=document.getElementById(cardIdPrefix+"_"+idx);if(elCurtain){elCurtain.className=elCurtain.className.replace(/on/g,"")+(visible?" on":"");}}function initializeCart(objectNamesList,hiddenAnswerList){setMetricsList(objectNamesList);BuildPreviewWindow("divPreviewPage","availableFields","selectedFields");UpdateHiddenSelectedValue("selectedFields",hiddenAnswerList);}var sMetricsList="";
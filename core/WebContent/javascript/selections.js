mstrSelectionsImpl.prototype={};mstrSelectionsImpl.prototype.length=0;mstrSelectionsImpl.prototype.path="";mstrSelectionsImpl.prototype.dragX=0;mstrSelectionsImpl.prototype.dragY=0;mstrSelectionsImpl.prototype.mousedownX=0;mstrSelectionsImpl.prototype.mousedownY=0;mstrSelectionsImpl.prototype.shiftKey=false;mstrSelectionsImpl.prototype.ctrlKey=false;mstrSelectionsImpl.prototype.clickedSrc=null;mstrSelectionsImpl.prototype.onload=function(e){};mstrSelectionsImpl.prototype.onmousedown=function(e){try{if(!e){e=window.event;}getMouse(e);this.mousedownX=lMouseX;this.mousedownY=lMouseY;}catch(err){microstrategy.errors.log(err);}};mstrSelectionsImpl.prototype.onmouseup=function(e,path){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener((path)?path:this,"mousemove");this.parentBone.detachWinListener((path)?path:this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(err){microstrategy.errors.log(err);}return false;};mstrSelectionsImpl.prototype.ondeselect=function(e){try{if(e.e){e=e.e;}this.onmouseup(e);if(this.clickedSrc!=null){this.remove(this.clickedSrc);}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrSelectionsImpl.prototype.ondragstart=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);if(Math.abs(lMouseX-this.mousedownX)>=3||Math.abs(lMouseY-this.mousedownY)>=3){microstrategy.eventManager.onnotifydrag(this.items,this.parentBone,this.getDssTypes());var verifiedPath=microstrategy.getEventHandlerString(this.path);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","ondrag");this.parentBone.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",verifiedPath+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",verifiedPath+" { return "+this.path+".ondragend(e); }");}this.ondrag(e);}}catch(err){microstrategy.errors.log(err);}return false;};mstrSelectionsImpl.prototype.ondrag=function(e){};mstrSelectionsImpl.prototype.ondragend=function(e){};mstrSelectionsImpl.prototype.add=function(obj){try{this.items[obj.getAttribute("id")]=obj;this.length++;if(this.parentBone&&this.parentBone.onselectionchange){this.parentBone.onselectionchange();}}catch(err){microstrategy.errors.log(err);}return false;};mstrSelectionsImpl.prototype.remove=function(obj){try{delete this.items[obj.getAttribute("id")];this.length--;if(this.parentBone.onselectionchange){this.parentBone.onselectionchange();}}catch(err){microstrategy.errors.log(err);}return false;};mstrSelectionsImpl.prototype.clear=function(notifyParent,e){try{if(notifyParent==null){notifyParent=true;}this.items={};this.length=0;if(notifyParent&&this.parentBone&&this.parentBone.onselectionchange){this.parentBone.onselectionchange(e);}}catch(err){microstrategy.errors.log(err);}return false;};mstrSelectionsImpl.prototype.firstItem=function(){try{for(member in this.items){return this.items[member];break;}}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.isMulti=function(){try{return(this.length>1);}catch(err){microstrategy.errors.log(err);return false;}};mstrSelectionsImpl.prototype.isSelected=function(obj){try{return(typeof (this.items[obj.getAttribute("id")])!="undefined");}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.isActive=function(){try{return(this.length>0);}catch(err){microstrategy.errors.log(err);return false;}};mstrSelectionsImpl.prototype.getTypes=function(){try{var __result=[];var i=0;for(var member in this.items){if(this.items[member].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)){__result[i++]=this.items[member].getAttribute(microstrategy.HTMLATTR_OBJTYPE)+"."+this.items[member].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}else{__result[i++]=this.items[member].getAttribute(microstrategy.HTMLATTR_OBJTYPE);}}return __result;}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.isSameType=function(){try{var types=this.getDssTypes();types.sort(function(a,b){return parseInt(a)-parseInt(b);});return(types[0]==types[types.length-1]);}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.isOnlyMetrics=function(){try{for(var id in this.items){if(this.items[id].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_METRIC&&this.items[id].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_USER_METRIC&&this.items[id].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_USER_SUMMARY_METRIC){return false;}}return true;}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.getDssTypes=function(){try{var __result=[];var i=0;for(var member in this.items){__result[i++]=this.items[member].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);}return __result;}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.getSelectedIds=function(){try{var boneIds="|";for(var id in this.items){boneIds+=id+"|";}return boneIds;}catch(err){microstrategy.errors.log(err);return false;}};mstrSelectionsImpl.prototype.getDataSetIDs=function(){try{var __result=[];var i=0;for(var id in this.items){var objInfo=new mstrObjectInfoImpl(this.items[id]);__result[i++]=objInfo.dSetId;}return __result;}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.getSelectionsKey=function(){try{var __result=[];var i=0;for(var member in this.items){__result[i++]=this.items[member].id;}return __result;}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.getFirstObjSubType=function(){try{var type=null;var item=this.firstItem();if(item){type=item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}return type;}catch(err){microstrategy.errors.log(err);return false;}};mstrSelectionsImpl.prototype.getFirstObjType=function(){try{var type=null;var item=this.firstItem();if(item){type=item.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}return type;}catch(err){microstrategy.errors.log(err);return false;}};mstrSelectionsImpl.prototype.getChildren=function(obj){try{return obj.parentNode.parentNode.lastChild.getElementsByTagName("span");}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.getItems=function(){try{return mstr.utils.Arrays.fromHashValues(this.items);}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.getInnerRect=function(obj){try{var styleObj=microstrategy.styleObj;var rect={};rect.left=getObjSumLeft(obj);rect.top=getObjSumTop(obj);if(bIsIE6){rect.right=rect.left+getObjWidth(obj);rect.bottom=rect.top+getObjHeight(obj);}else{rect.left+=obj.clientLeft;rect.top+=obj.clientTop;rect.right=rect.left+styleObj.getInnerWidth(obj);rect.bottom=rect.top+styleObj.getInnerHeight(obj);}if(rect.right<(rect.left+1)){rect.right=rect.left+1;}if(rect.bottom<(rect.top+1)){rect.bottom=rect.top+1;}return rect;}catch(err){microstrategy.errors.log(err);return null;}};mstrSelectionsImpl.prototype.getOuterRect=function(obj,elLimit){try{var rect={};if(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==null){rect.left=getObjSumLeft(obj);rect.top=getObjSumTop(obj);}else{rect.left=getObjSumLeftScrolled(obj);rect.top=getObjSumTopScrolled(obj,elLimit);}rect.right=Math.max(rect.left+getObjWidth(obj),rect.left+1);rect.bottom=Math.max(rect.top+getObjHeight(obj),rect.top+1);return rect;}catch(err){microstrategy.errors.log(err);return null;}};function mstrSelectionsImpl(bone){this.items={};this.parentBone=bone;return this;}
mstrRoundedRectangleScript=true;mstrRoundedRectangle.prototype=new mstrBoneImpl();mstrRoundedRectangle.prototype.topBlock=null;mstrRoundedRectangle.prototype.content=null;mstrRoundedRectangle.prototype.bottomBlock=null;mstrRoundedRectangle.prototype.sibs=null;mstrRoundedRectangle.prototype.backgroundColor=null;mstrRoundedRectangle.prototype.gradientColor=null;mstrRoundedRectangle.prototype.conditionalBackgroundColor=null;mstrRoundedRectangle.prototype.conditionalGradients=null;mstrRoundedRectangle.TOP_1=0;mstrRoundedRectangle.TOP_2=1;mstrRoundedRectangle.TOP_3=2;mstrRoundedRectangle.TOP_4=3;mstrRoundedRectangle.CONTENT=4;mstrRoundedRectangle.BOTTOM_1=8;mstrRoundedRectangle.BOTTOM_2=7;mstrRoundedRectangle.BOTTOM_3=6;mstrRoundedRectangle.BOTTOM_4=5;mstrRoundedRectangle.margins=[4,2,1,1];mstrRoundedRectangle.prototype.onload=function(){try{var cg=function(gradientC){var gradientSettings=(gradientC)?gradientC.split(","):null;return(gradientSettings)?{startingColor:gradientSettings[gradientUtil.GRADIENT_START_COLOR_INDEX],endingColor:gradientSettings[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientAngle:gradientSettings[gradientUtil.GRADIENT_ANGLE_INDEX],gradientXOffset:gradientSettings[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientYOffset:gradientSettings[gradientUtil.GRADIENT_YOFFSET_INDEX]}:{startingColor:null,endingColor:null,gradientAngle:0,gradientXOffset:0,gradientYOffset:0};};mstrBoneImpl.prototype.onload.call(this);this.sibs=document.getElementsByName(this.id);if(this.sibs.length>0){this.conditionalGradients=[],this.conditionalBackgroundColor=[];this.gradientColor=cg(this.sibs[0].getAttribute("gradientcolor"));for(var i=0;i<this.sibs.length;i++){var bgColor=(this.sibs[i].getAttribute("bgcolor"))||null;if(bgColor!=null&&bgColor.indexOf(",")>0){this.conditionalGradients.push(cg(bgColor));this.conditionalBackgroundColor.push(null);}else{this.conditionalBackgroundColor.push((this.sibs[i].getAttribute("bgcolor"))?(this.sibs[i].getAttribute("bgcolor")):null);this.conditionalGradients.push(null);}}}for(var i=0;i<this.sibs.length;i++){if(mstr.utils.ISIE7){mstr.$D.clearChilds(this.sibs[i]);}else{this.sibs[i].innerHTML="";}this.createCorners(this.sibs[i],i);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRoundedRectangle.prototype.initNewUnit=function(unit){try{bone=microstrategy.registerBone(unit.id,"mstrRWControlImplScript",{backgroundColor:this.backgroundColor});bone.onload();}catch(err){microstrategy.errors.log(err);return false;}};mstrRoundedRectangle.prototype.synchronizeSize=function(){try{for(var i=0;i<this.sibs.length;i++){this.adjustRoundedCornerHeight(this.sibs[i]);}this.applyGradient();}catch(err){microstrategy.errors.log(err);return false;}};mstrRoundedRectangle.prototype.synchronizeFormat=function(){try{var gc=this.gradientColor;this.backgroundColor=null;gc.startingColor=null;gc.endingColor=null;for(var i=0;i<this.sibs.length;i++){this.changeFormattingToRoundedCorner(this.sibs[i],i);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRoundedRectangle.prototype.createCorners=function(elem,index){try{var topDiv=document.createElement("div");this.topBlock=topDiv;var zoom=microstrategy.ZOOM_FACTOR/100;for(var i=0;i<4;i++){var edgeSpan=document.createElement("span");edgeSpan.style.margin="0px "+Math.round(mstrRoundedRectangle.margins[i]*zoom)+"px";edgeSpan.style.height=Math.round(1*zoom)+"px";edgeSpan.style.display="block";edgeSpan.style.overflow="hidden";edgeSpan.setAttribute("minheight",(2*i)+1);topDiv.appendChild(edgeSpan);}var content=document.createElement("span");this.content=content;content.style.display="block";content.style.overflow="hidden";var bottomDiv=document.createElement("div");this.bottomBlock=bottomDiv;for(var i=3;i>=0;i--){var edgeSpan=document.createElement("span");edgeSpan.style.margin="0px "+Math.round(mstrRoundedRectangle.margins[i]*zoom)+"px";edgeSpan.style.height=Math.round(1*zoom)+"px";edgeSpan.style.display="block";edgeSpan.style.overflow="hidden";edgeSpan.setAttribute("minheight",(2*i)+2);bottomDiv.appendChild(edgeSpan);}elem.appendChild(topDiv);elem.appendChild(content);elem.appendChild(bottomDiv);elem.setAttribute(microstrategy.HTMLATTR_STYLE,microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);this.adjustRoundedCornerHeight(elem);this.changeFormattingToRoundedCorner(elem,index);}catch(err){microstrategy.errors.log(err);return false;}};mstrRoundedRectangle.prototype.changeFormattingToRoundedCorner=function(elem,index){try{if(this.conditionalGradients[index]!=null){this.setRoundedCornerGradientColor(elem,this.conditionalGradients[index]);}else{if(this.gradientColor.startingColor!=null&&this.gradientColor.endingColor!=null&&this.conditionalBackgroundColor[index]==null){this.setRoundedCornerGradientColor(elem,this.gradientColor);}else{this.backgroundColor=microstrategy.styleObj.getValue(elem,"backgroundColor");if(this.conditionalBackgroundColor[index]!=null&&this.conditionalBackgroundColor[index].length>0){this.setRoundedCornerBackgroundColor(elem,this.conditionalBackgroundColor[index]);}else{if(this.backgroundColor!=null&&this.backgroundColor.length>0){this.setRoundedCornerBackgroundColor(elem,this.backgroundColor);}}}}elem.style.backgroundColor="transparent";elem.style.border="none";}catch(err){microstrategy.errors.log(err);return false;}};mstrRoundedRectangle.prototype.applyGradient=function(){try{var gc=this.gradientColor;if(!gc||!gc.startingColor||!gc.endingColor){return ;}for(var i=0;i<this.sibs.length;i++){this.sibs[i].setAttribute("gradientcolor",gc.startingColor+","+gc.endingColor+",14,"+gc.gradientAngle+","+gc.gradientXOffset+","+gc.gradientYOffset);if(this.conditionalBackgroundColor[i]==null&&(!this.conditionalGradients[i]||this.conditionalGradients[i].startingColor==null)){this.setRoundedCornerGradientColor(this.sibs[i],gc);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRoundedRectangle.prototype.setRoundedCornerGradientColor=function(elem,gSet){try{var children=elem.getElementsByTagName("SPAN");var topSpan1=children[mstrRoundedRectangle.TOP_1];var topSpan2=children[mstrRoundedRectangle.TOP_2];var topSpan3=children[mstrRoundedRectangle.TOP_3];var topSpan4=children[mstrRoundedRectangle.TOP_4];var bottomSpan1=children[mstrRoundedRectangle.BOTTOM_1];var bottomSpan2=children[mstrRoundedRectangle.BOTTOM_2];var bottomSpan3=children[mstrRoundedRectangle.BOTTOM_3];var bottomSpan4=children[mstrRoundedRectangle.BOTTOM_4];var content=children[mstrRoundedRectangle.CONTENT];if(gSet.gradientAngle==0){var top1_width=getObjInnerWidth(topSpan1);var top2_width=getObjInnerWidth(topSpan2);var top3_width=getObjInnerWidth(topSpan3);var top4_width=getObjInnerWidth(topSpan4);var content_width=getObjInnerWidth(content);if(top1_width==0||top2_width==0||top3_width==0||top4_width==0||content_width==0){return ;}var top1Colors=gradientUtil.createIntervalColors(gSet.startingColor,gSet.endingColor,content_width,top1_width);var top2Colors=gradientUtil.createIntervalColors(gSet.startingColor,gSet.endingColor,content_width,top2_width);var top3Colors=gradientUtil.createIntervalColors(gSet.startingColor,gSet.endingColor,content_width,top3_width);var top4Colors=gradientUtil.createIntervalColors(gSet.startingColor,gSet.endingColor,content_width,top4_width);gradientUtil.applyGradient(topSpan1,top1Colors[0],top1Colors[1],gSet.gradientAngle,gSet.gradientXOffset,gSet.gradientYOffset);gradientUtil.applyGradient(topSpan2,top2Colors[0],top2Colors[1],gSet.gradientAngle,gSet.gradientXOffset,gSet.gradientYOffset);gradientUtil.applyGradient(topSpan3,top3Colors[0],top3Colors[1],gSet.gradientAngle,gSet.gradientXOffset,gSet.gradientYOffset);gradientUtil.applyGradient(topSpan4,top4Colors[0],top4Colors[1],gSet.gradientAngle,gSet.gradientXOffset,gSet.gradientYOffset);gradientUtil.applyGradient(content,gSet.startingColor,gSet.endingColor,gSet.gradientAngle,gSet.gradientXOffset,gSet.gradientYOffset);gradientUtil.applyGradient(bottomSpan1,top1Colors[0],top1Colors[1],gSet.gradientAngle,gSet.gradientXOffset,gSet.gradientYOffset);gradientUtil.applyGradient(bottomSpan2,top2Colors[0],top2Colors[1],gSet.gradientAngle,gSet.gradientXOffset,gSet.gradientYOffset);gradientUtil.applyGradient(bottomSpan3,top3Colors[0],top3Colors[1],gSet.gradientAngle,gSet.gradientXOffset,gSet.gradientYOffset);gradientUtil.applyGradient(bottomSpan4,top4Colors[0],top4Colors[1],gSet.gradientAngle,gSet.gradientXOffset,gSet.gradientYOffset);}else{var top1_height=getObjOuterHeight(topSpan1);var top2_height=getObjOuterHeight(topSpan2);var top3_height=getObjOuterHeight(topSpan3);var top4_height=getObjOuterHeight(topSpan4);var content_height=getObjOuterHeight(content);if(top1_height==0||top2_height==0||top3_height==0||top4_height==0||content_height==0){return ;}var totalHeight=top1_height*2+top2_height*2+top3_height*2+top4_height*2+content_height;var startColor=(gSet.gradientYOffset==0||gSet.gradientYOffset==50)?gSet.startingColor:gSet.endingColor;var endColor=(gSet.gradientYOffset==0||gSet.gradientYOffset==50)?gSet.endingColor:gSet.startingColor;var top1_endColor=gradientUtil.createIntervalColor(startColor,endColor,(totalHeight-top1_height)/totalHeight);var top2_endColor=gradientUtil.createIntervalColor(startColor,endColor,(totalHeight-top1_height-top2_height)/totalHeight);var top3_endColor=gradientUtil.createIntervalColor(startColor,endColor,(totalHeight-top1_height-top2_height-top3_height)/totalHeight);var top4_endColor=gradientUtil.createIntervalColor(startColor,endColor,(totalHeight-top1_height-top2_height-top3_height-top4_height)/totalHeight);var content_endColor=gradientUtil.createIntervalColor(startColor,endColor,(top1_height+top2_height+top3_height+top4_height)/totalHeight);var bottom4_endColor=gradientUtil.createIntervalColor(startColor,endColor,(top3_height+top2_height+top1_height)/totalHeight);var bottom3_endColor=gradientUtil.createIntervalColor(startColor,endColor,(top2_height+top1_height)/totalHeight);var bottom2_endColor=gradientUtil.createIntervalColor(startColor,endColor,top1_height/totalHeight);gradientUtil.applyGradient(topSpan1,startColor,top1_endColor,gSet.gradientAngle,gSet.gradientXOffset,0);gradientUtil.applyGradient(topSpan2,top1_endColor,top2_endColor,gSet.gradientAngle,gSet.gradientXOffset,0);gradientUtil.applyGradient(topSpan3,top2_endColor,top3_endColor,gSet.gradientAngle,gSet.gradientXOffset,0);gradientUtil.applyGradient(topSpan4,top3_endColor,top4_endColor,gSet.gradientAngle,gSet.gradientXOffset,0);gradientUtil.applyGradient(content,top4_endColor,content_endColor,gSet.gradientAngle,gSet.gradientXOffset,0);gradientUtil.applyGradient(bottomSpan4,content_endColor,bottom4_endColor,gSet.gradientAngle,gSet.gradientXOffset,0);gradientUtil.applyGradient(bottomSpan3,bottom4_endColor,bottom3_endColor,gSet.gradientAngle,gSet.gradientXOffset,0);gradientUtil.applyGradient(bottomSpan2,bottom3_endColor,bottom2_endColor,gSet.gradientAngle,gSet.gradientXOffset,0);gradientUtil.applyGradient(bottomSpan1,bottom2_endColor,endColor,gSet.gradientAngle,gSet.gradientXOffset,0);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRoundedRectangle.prototype.setRoundedCornerBackgroundColor=function(elem,color){try{var children=elem.getElementsByTagName("SPAN");for(var i=0;i<children.length;i++){children[i].style.backgroundColor=color;if(bIsDXIE){var gradientFilter=this.getFilter(children[i],"Gradient");if(gradientFilter!=null){gradientFilter.enabled=false;}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRoundedRectangle.prototype.getFilter=function(elem,name){try{var filterText=elem.style.filter;var filter=null;if((filterText==null||filterText.length==0)&&microstrategy.styleObj){filterText=microstrategy.styleObj.getFilter(elem);}if(filterText.length>0){filter=elem.filters["DXImageTransform.Microsoft."+name];}return filter;}catch(err){microstrategy.errors.log(err);return false;}};mstrRoundedRectangle.prototype.adjustRoundedCornerHeight=function(elem){try{var zoom=microstrategy.ZOOM_FACTOR/100;var height=parseInt(microstrategy.styleObj.getValue(elem,"height"));var children=elem.getElementsByTagName("SPAN");var content=children[mstrRoundedRectangle.CONTENT];if(content){content.style.height=height-Math.round(8*zoom)<=0?"0px":height-Math.round(8*zoom)+"px";}var children=elem.getElementsByTagName("SPAN");for(var i=0;i<children.length;i++){if(children[i].getAttribute("minheight")){var minheight=parseInt(children[i].getAttribute("minheight"));if(minheight>height){children[i].style.display="none";}else{children[i].style.display="block";}}}}catch(err){microstrategy.errors.log(err);return false;}};function mstrRoundedRectangle(id){this.inherits=mstrBoneImpl;this.inherits(id);delete this.inherits;return this;}
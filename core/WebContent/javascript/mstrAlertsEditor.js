mstrAlertsEditorScript=true;mstrAlertsEditor.prototype=new mstrAdvancedThresholdEditor();mstrAlertsEditor.prototype.subscriptionForm=null;mstrAlertsEditor.prototype.subbeanPath=null;mstrAlertsEditor.prototype.isDelSettingsOpen=false;function mstrAlertsEditor(id){this.inherits=mstrAdvancedThresholdEditor;this.inherits(id);delete this.inherits;return this;}mstrAlertsEditor.prototype.onload=function(){try{mstrAdvancedThresholdEditor.prototype.onload.call(this);this.resetSelections();this.subscriptionForm=document.getElementById(this.id+"_form");this.um.addURL("deliverySettingsOpen="+this.isDelSettingsOpen);}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.applyChanges=function(noSubmit){try{this.um.add([this.um.createActionObject(this.elem,mstrUpdateManager.APPLY_THRESHOLD_CHANGES,this.beanPath,[],[],[],[])]);this.um.addURL(this.getExtraURL());if(!noSubmit){if(this.subscriptionForm){if(validateInputs(this.subscriptionForm)){var save=this.getSaveEventId();addEvtOrder(this.subscriptionForm,save,true);createHiddenInput(this.subscriptionForm,"src",this.subbeanPath+"."+save);submitForm(this.subscriptionForm);}}else{this.um.flushAndSubmitChanges();}}}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.getSaveEventId=function(){return(parseInt(this.deliveryMode)==1)?mstrUpdateManager.SAVE_SUBSCRIPTION_EMAIL:mstrUpdateManager.SAVE_SUBSCRIPTION_MOBILE;};mstrAlertsEditor.prototype.getSetPropsEventId=function(){return(parseInt(this.deliveryMode)==1)?mstrUpdateManager.SET_SUBSCRIPTION_EMAIL_PROPERTIES:mstrUpdateManager.SET_SUBSCRIPTION_MOBILE_PROPERTIES;};mstrAlertsEditor.prototype.openCloseDelSettings=function(image,advOptionsDivID,imagesFolder){try{var oDiv=document.getElementById(advOptionsDivID);if(oDiv!=null){if(oDiv.style.display=="none"){this.isDelSettingsOpen=true;}else{this.isDelSettingsOpen=false;}advancedOptionImageClicked(image,advOptionsDivID,imagesFolder+"treeExpand.gif",imagesFolder+"treeCollapse.gif");this.um.replaceURL("deliverySettingsOpen",this.isDelSettingsOpen);}}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.cancelSubscriptionChanges=function(){try{this.um.useIframe=false;this.um.add([this.um.createActionObject(this.elem,mstrUpdateManager.SUBSCRIPTION_CANCEL,this.subbeanPath,[],[],[],[])]);this.um.flushAndSubmitChanges();}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.resetSelections=function(){try{mstrAdvancedThresholdEditor.prototype.resetSelections.call(this);for(var k in this.containers){var container=this.containers[k];if(container.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==mstrAdvancedThresholdEditor.SUBOBJTYPE_ATE_METRIC){if(this.currentContainerKey==container.getAttribute(mstrAdvancedThresholdEditor.ATT_KEY)){var firstThreshold=microstrategy.findChildWithAtt(container,"DIV",microstrategy.HTMLATTR_SUBOBJTYPE,mstrAdvancedThresholdEditor.SUBOBJTYPE_ATE_THRESHOLD);if(firstThreshold){this.selections.add(firstThreshold);}}}}}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.hasCondition=function(){try{for(var i in this.containers){var container=this.containers[i];if(container&&container.childNodes){var ths=container.childNodes[0];if(ths&&ths.getAttribute(mstrAdvancedThresholdEditor.EXP_COUNT)>0){var m=ths.getAttribute(mstrAdvancedThresholdEditor.EXP_EDIT_MODE);if(!m||m==mstrAdvancedThresholdEditor.EXP_MODE_VIEW_MODE){return true;}}}}return false;}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.saveAndClose=function(){try{if(this.subscriptionForm&&!validateInputs(this.subscriptionForm)){return false;}this.close();this.applyChanges(false);microstrategy.unRegisterBone(this.id);}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.okChanges=function(){try{if(!this.hasCondition()){showMessage({contents:microstrategy.descriptors.getDescriptor(5858),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').saveAndClose();",type:mstrMsgBoxImpl.MSG_WARNING});}else{this.saveAndClose();}}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.changeMetric=function(key){mstrAdvancedThresholdEditor.prototype.changeMetric.call(this,key);var container=this.containers[key];var link=microstrategy.findChildWithAtt(container,"div",microstrategy.HTMLATTR_ID,"addConditionLink");this.controlCondLink(link,container);};mstrAlertsEditor.prototype.controlCondLink=function(link,container){try{if(link!=null){if(container.childNodes.length>0&&container.childNodes[0].getAttribute(mstrAdvancedThresholdEditor.EXP_COUNT)=="0"&&container.childNodes[0].getAttribute(mstrAdvancedThresholdEditor.EDIT_EXP)!=microstrategy.TRUE){link.style.display="block";}else{link.style.display="none";}}}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.addSusbscriptionProperties=function(){if(this.subscriptionForm){var setEventID=this.getSetPropsEventId();var allIds=mstrUpdateManager.actions[setEventID].paramID;var allFields=mstrUpdateManager.actions[setEventID].paramName;var argIds=new Array();var argValues=new Array();for(var i=0;i<allFields.length;i++){var field=document.getElementById(allFields[i]);if(field&&!field.disabled){if(field.type&&field.type=="checkbox"&&!field.checked){continue;}else{if(field.type&&field.type=="radio"){var radioes=document.getElementsByName(allFields[i]);for(var j=0;j<radioes.length;j++){if(field.checked){argIds.push(allIds[i]);argValues.push(field.value);}}}else{argIds.push(allIds[i]);argValues.push(field.value);}}}}this.um.add([this.um.createActionObject(this.elem,setEventID,this.subbeanPath,argIds,argValues,[],[])]);}};mstrAlertsEditor.prototype.showFormatDialog=function(){this.addSusbscriptionProperties();mstrAdvancedThresholdEditor.prototype.showFormatDialog.call(this);};mstrAlertsEditor.prototype.submitUpdateManager=function(){try{this.addSusbscriptionProperties();mstrAdvancedThresholdEditor.prototype.submitUpdateManager.call(this);}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.saveAndConfirm=function(){try{this.um.useIframe=true;this.um.add([this.um.createActionObject(this.elem,mstrUpdateManager.APPLY_THRESHOLD_CHANGES,this.beanPath,[],[],[],[])]);this.um.addURL(this.getExtraURL());if(this.subscriptionForm&&validateInputs(this.subscriptionForm)){var save=this.getSaveEventId();addEvtOrder(this.subscriptionForm,save,true);createHiddenInput(this.subscriptionForm,"src",this.subbeanPath+"."+save);addEvtOrder(this.subscriptionForm,mstrUpdateManager.NC_SUBS_CONFIRM,true);createHiddenInput(this.subscriptionForm,"src","mstrWeb."+mstrUpdateManager.NC_SUBS_CONFIRM);createHiddenInput(this.subscriptionForm,"evt",mstrUpdateManager.NC_SUBS_CONFIRM);submitForm(this.subscriptionForm);}}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.okAndConfirm=function(){try{if(!this.hasCondition()){showMessage({contents:microstrategy.descriptors.getDescriptor(5858),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').saveAndConfirm();",type:mstrMsgBoxImpl.MSG_WARNING});}else{this.saveAndConfirm();}}catch(err){microstrategy.errors.log(err);}};mstrAlertsEditor.prototype.validateAndShowMsg=function(){try{return true;}catch(err){microstrategy.errors.log(err);return false;}};
mstrAccordionTabManagerImplScript=true;mstrAccordionTabManagerImpl.prototype=new mstrFormatImpl();mstrAccordionTabManagerImpl.prototype.adjustContainer=true;mstrAccordionTabManagerImpl.prototype.bottomAdjustHeight=10;mstrAccordionTabManagerImpl.prototype.currentTabName="";mstrAccordionTabManagerImpl.prototype.bottomSum=0;mstrAccordionTabManagerImpl.prototype.onload=function(){try{mstrFormatImpl.prototype.onload.call(this);this.bottomAdjustHeight=(this.adjustContainer)?2:5;microstrategy.eventManager.notifyOrphanBones("onObjectBrowserTabChange",this.currentTabName);microstrategy.eventManager.ondialogresize();}catch(err){microstrategy.errors.log(err);}};mstrAccordionTabManagerImpl.prototype.closeEditor=function(submit){try{mstrEditorImpl.prototype.closeEditor.call(this,submit);microstrategy.eventManager.notifyOrphanBones("onObjectBrowserTabChange",null);}catch(err){microstrategy.errors.log(err);}};mstrAccordionTabManagerImpl.prototype.onforcerepaint=function(){try{var i=document.createElement("img");if(this.elem){this.elem.parentNode.parentNode.style.width=getObjOuterWidth(this.elem)+"px";this.elem.appendChild(i);this.elem.removeChild(i);}window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').resize()",0);window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').adjustTabTable()",0);var tabTable=microstrategy.findChildWithAtt(this.elem,"DIV","id",this.id+"_tabSet");if(tabTable){tabTable.style.visibility="visible";}this.callOnTabs("onforcerepaint");}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.onreload=function(){try{mstrFormatImpl.prototype.onreload.call(this);window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').resize()",0);window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').adjustTabTable()",0);}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.findTabSectionContainer=function(tabSection){try{return(tabSection.parentNode)?tabSection.parentNode:tabSection;}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.callDelayedResize=function(){try{if(this.resizeTimer){window.clearTimeout(this.resizeTimer);}this.resizeTimer=window.setTimeout("microstrategy.bone('"+this.id+"').ondialogresize()",0);}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.onwinresize=function(){try{if(bIsFirefox||bIsChrome){this.callDelayedResize();}else{this.ondialogresize();}}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.ondialogresize=function(){try{if(mstrFormatImpl.prototype.ondialogresize){mstrFormatImpl.prototype.ondialogresize.call(this);}if(this.elem&&this.elem.parentNode){if(microstrategy.pageScreenMode!=microstrategy.PAGE_FULL_SCREEN_MODE){var titlebarDiv=microstrategy.findChildWithAtt(this.elem,"DIV","sty","titl");if(titlebarDiv){var titleSpan=titlebarDiv.firstChild;if(titleSpan){var titlebarButtonsSpan=titleSpan.nextSibling;var titlebarButtonsSpanWidth=((titlebarButtonsSpan!=null)?getObjWidth(titlebarButtonsSpan):0)+20;titleSpan.style.width=Math.max(0,getObjWidth(this.elem)-titlebarButtonsSpanWidth)+"px";}}}this.elem.parentNode.parentNode.style.width=getObjOuterWidth(this.elem)+"px";this.elem.style.height=Math.max(microstrategy.contentHeight-this.bottomAdjustHeight-this.bottomSum,SCROLLBAR_SIZE)+"px";this.elem.parentNode.style.height=Math.max(getObjOuterHeight(this.elem)-1,0)+"px";if(this.adjustContainer){this.elem.parentNode.parentNode.style.height=microstrategy.contentHeight-1+"px";}}this.callOnTabs("onwinresize");window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').adjustTabTable()",0);}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.adjustTabTable=function(){try{if(!this.elem||microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){return ;}if(this.adjustContainer){if(this.elem.parentNode&&this.elem.parentNode.parentNode){var availHeight=Math.max(microstrategy.contentHeight-this.bottomAdjustHeight-this.bottomSum,SCROLLBAR_SIZE);this.elem.parentNode.parentNode.style.height=availHeight+"px";var iHeight=(availHeight-this.bottomAdjustHeight/2);this.elem.parentNode.style.height=iHeight+"px";this.elem.style.height=Math.max((iHeight-1),0)+"px";}}else{if(this.elem.parentNode){}}var tabTable=microstrategy.findChildWithAtt(this.elem,"DIV","id",this.id+"_tabSet");if(tabTable){tabTable.style.width=Math.max(getObjWidth(this.elem)-2,0)+"px";}this.moveResizeHandles();var RPPanelName=(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?microstrategy.ACCORDION_REPORT_RELATED_RP_PANEL:microstrategy.ACCORDION_RW_RELATED_RP_PANEL;if(this.currentTabName==RPPanelName){var _oRPDiv=document.getElementById(RPPanelName+"Id");var _oRPListDiv=document.getElementById(RPPanelName+"IdList");if(_oRPListDiv!=null){_oRPListDiv.style.height=Math.max(this.getAvailableHeight()-10,0)+"px";_oRPListDiv.style.width=Math.max(this.getAvailableWidth()-6,0)+"px";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.afterresize=function(){try{if(mstrFormatImpl.prototype.afterresize){mstrFormatImpl.prototype.afterresize.call(this);}var newWidth=getObjWidth(this.elem);this.elem.parentNode.parentNode.style.width=newWidth+"px";microstrategy.eventManager.ondialogresize();this.onforcerepaint();microstrategy.updateBrowserSetting("rwltW",newWidth);}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.getAvailableHeight=function(){try{var tabTable=microstrategy.findChildWithAtt(this.elem,"DIV","id",this.id+"_tabSet");var tabTableHeight=(tabTable)?getObjOuterHeight(tabTable):0;var titleBarHeight=(this.getTitleContainer())?getObjOuterHeight(this.titleContainer.parentNode):0;return(Math.max(microstrategy.contentHeight-this.bottomAdjustHeight-this.bottomSum,SCROLLBAR_SIZE)-tabTableHeight-titleBarHeight);}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.getAvailableWidth=function(){try{return getObjInnerWidth(this.elem);}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.resize=function(){try{if(mstrFormatImpl.prototype.resize){mstrFormatImpl.prototype.resize.call(this);}this.callOnTabs("resize");}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.callOnTabs=function(m){for(var counter=0;counter<this.childrenTabs.length;counter++){if(this.childrenTabs[counter]&&this.childrenTabs[counter][m]){this.childrenTabs[counter][m]();}}};mstrAccordionTabManagerImpl.prototype.unregister=function(){try{for(var counter=0;counter<this.childrenTabs.length;counter++){if(this.childrenTabs[counter]&&this.childrenTabs[counter].unregister){var childTab=this.childrenTabs[counter];this.unRegisterChildrenBones(childTab.elem.getElementsByTagName("div"));childTab.unregister();}}this.elem.innerHTML="";microstrategy.unRegisterBone(this.id);}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.unRegisterChildrenBones=function(childrenDiv){try{for(var i=0,len=childrenDiv.length;i<len;i++){var childId=childrenDiv[i].id;if(microstrategy.bones[childId]){microstrategy.unRegisterBone(childId);}}}catch(err){microstrategy.errors.log(err);}};mstrAccordionTabManagerImpl.prototype.close=function(){try{mstrEditorImpl.prototype.close.call(this);if(this.elem&&this.elem.parentNode){this.elem.parentNode.parentNode.style.width="0px";}}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.hideAccordion=function(){try{microstrategy.toggleAccordion();microstrategy.eventManager.notifyOrphanBones("onwinresize");}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.onMouseOverTab=function(elemTab){try{elemTab.className+="Hover";}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.onMouseOutTab=function(elemTab){try{if(elemTab.className.indexOf("Hover")>=0){elemTab.className=elemTab.className.slice(0,elemTab.className.indexOf("Hover"));}}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.setCurTab=function(curTab){try{var keyAttr=(isNaN(curTab))?"curTabName":"curTab";var tabs=microstrategy.findChildrenWithAtt(this.elem,"SPAN","ty","tab");for(var i=0;i<tabs.length;i++){if(tabs[i].getAttribute(keyAttr)==curTab){this.setCurrentTab(tabs[i]);break;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrAccordionTabManagerImpl.prototype.setCurrentTab=function(elemTab){try{this.currentTabName=elemTab.getAttribute("curTabName");if(mstrApp.rememberLastEditorPanel!=="0"){microstrategy.updateBrowserSetting((microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION)?"accordionRWTab":"accordionReportTab",this.currentTabName);}mstrFormatImpl.prototype.setCurrentTab.call(this,elemTab);var notesPanelName=(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?microstrategy.ACCORDION_REPORT_NOTES_PANEL:microstrategy.ACCORDION_RW_NOTES_PANEL;if(this.currentTabName==notesPanelName||microstrategy.needSaveBeforeNotes()){var notesIconView=mstr.$obj("NotesIconView_view");if(notesIconView){notesIconView.set("visible",false);}}else{var notesIconModel=mstr.$obj("NotesIconModel_model");if(notesIconModel){notesIconModel.execCheck();}}microstrategy.eventManager.notifyOrphanBones("onObjectBrowserTabChange",this.currentTabName);return true;}catch(err){microstrategy.errors.log(err);return false;}};function mstrAccordionTabManagerImpl(id){this.inherits=mstrFormatImpl;this.inherits(id);this.inherits=null;return this;}
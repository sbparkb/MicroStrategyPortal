var NODE_STATE_CLOSED=0;var NODE_STATE_OPEN=1;var NODE_STATE_LEAF=2;var CSS_CLASS_OPEN="open";var CSS_CLASS_CLOSED="";var CSS_CLASS_LEAF="leaf";var CSS_TREE_WAIT="mstrTreeWait";var DIV_TREE_WAIT_ID="divTreeWait";var TREE_NAME_PREFIX="tree1";var TREE_TARGET="frameManager";var TREE_ACTION;function tree(div){if((div)&&(div!=null)){this.div=div;div.onclick=onClickTree;div.ondblclick=onDblClickTree;}}function util_findTargetTag(oTarget,sTagName){while(oTarget.parentNode){if(oTarget.tagName==sTagName){return oTarget;}oTarget=oTarget.parentNode;}return null;}function util_getChildNode(oTarget,sTagName){if((oTarget)&&(oTarget.childNodes.length)){for(var i=0;i<oTarget.childNodes.length;i++){var oChildNode=oTarget.childNodes[i];if(oChildNode.tagName==sTagName){return oChildNode;}oChildNode=util_getChildNode(oChildNode,sTagName);if(oChildNode!=null){return oChildNode;}}}return null;}function util_getNodeState(oTarget){switch(oTarget.className){case (CSS_CLASS_OPEN):return(NODE_STATE_OPEN);case (CSS_CLASS_LEAF):return(NODE_STATE_LEAF);}return(NODE_STATE_CLOSED);}function onDblClickTree(e){if(iframe.isTreeProcessing){event.returnValue=false;return ;}var oTarget=getEventTarget(e);var shouldProcessNode=false;if(oTarget.tagName=="A"||oTarget.tagName=="IMG"){oTarget=oTarget.parentNode.parentNode;if(oTarget.getAttribute("did")!="none"){util_unselectNodes(oTarget,this);util_markNodeAsSelected(oTarget);shouldProcessNode=true;}}if(shouldProcessNode){util_processNode(oTarget,this);}event.returnValue=false;return ;}function onClickTree(e){var event=event||e;if(iframe.isTreeProcessing){event.returnValue=false;return ;}var oTarget=getEventTarget(e);if(!oTarget){return ;}var shouldProcessNode=false;hideTreeWaitMessage();if(oTarget.tagName=="LI"){util_unselectNodes(oTarget,this);util_markNodeAsSelected(oTarget);shouldProcessNode=true;}else{if(oTarget.tagName=="A"||oTarget.tagName=="IMG"||oTarget.tagName=="SPAN"){if(oTarget.tagName=="SPAN"){oTarget=oTarget.parentNode.parentNode.parentNode;}else{oTarget=oTarget.parentNode.parentNode;}if(oTarget.getAttribute("did")=="incrementalFetch"){util_unselectNodes(oTarget,this);util_markNodeAsSelected(oTarget);shouldProcessNode=true;}else{if(oTarget.getAttribute("did")!="none"){if(event.ctrlKey){if(oTarget.getAttribute("sel")=="1"){util_markNodeAsUnselected(oTarget);}else{util_checkSelectedNodes(oTarget,this);util_markNodeAsSelected(oTarget);}}else{if(util_getNodeState(oTarget)==NODE_STATE_LEAF||oTarget.getAttribute("sel")=="1"){shouldProcessNode=true;}util_unselectNodes(oTarget,this);util_markNodeAsSelected(oTarget);}}}}}if(shouldProcessNode){event.returnValue=util_processNode(oTarget,this);}else{event.returnValue=false;}return event.returnValue;}function util_shouldSubmitForm(oTarget,oTree){var oDIV=util_findTargetTag(oTarget,"DIV");if(!oDIV){return false;}if(oTarget.getAttribute("did")=="incrementalFetch"){return true;}else{var iState=util_getNodeState(oTarget);if(iState==NODE_STATE_CLOSED){if(!((oDIV.nextSibling)&&(oDIV.nextSibling.tagName=="UL"))){return true;}}}return false;}function util_processNode(oTarget,oTree){var oDIV=util_findTargetTag(oTarget,"DIV");if(!oDIV){return true;}if(oTarget.getAttribute("did")=="incrementalFetch"){var oUL=oDIV.parentNode;var oParentNode=oUL.previousSibling;oTree.scrollTop=oParentNode.offsetTop;oUL.parentNode.removeChild(oUL);showTreeWaitMessage(oParentNode,"afterEnd");var oAnchor=util_getAnchor(oTarget);if(oAnchor){util_submitForm(oAnchor);}}else{var iState=util_getNodeState(oTarget);switch(iState){case (NODE_STATE_LEAF):var oAnchor=util_getAnchor(oTarget);if(oAnchor.getAttribute("dum")){return false;}else{return true;}break;case (NODE_STATE_OPEN):util_setTreeTargetState(oDIV,NODE_STATE_CLOSED);break;case (NODE_STATE_CLOSED):if((oDIV.nextSibling)&&(oDIV.nextSibling.tagName=="UL")){util_setTreeTargetState(oDIV,NODE_STATE_OPEN);}else{showTreeWaitMessage(oDIV,"afterEnd");util_setTreeTargetState(oDIV,NODE_STATE_OPEN);var oAnchor=util_getAnchor(oTarget);if(oAnchor){util_submitForm(oAnchor);}}break;}}return false;}function util_submitForm(oTarget){var oForm=util_getNewTreeForm(oTarget.href);submitForm(oForm,true);}function util_getNewTreeForm(url){url=url+"&isTreeRequest=true";var oForm=createDynamicForm(url);oForm.target=TREE_TARGET;if(TREE_ACTION){oForm.action=TREE_ACTION;}return oForm;}function util_markNodeAsSelected(oTarget){var selected=oTarget.getAttribute("sel");if(selected=="1"){return ;}oTarget.setAttribute("sel","1");var oAnchor=util_getAnchor(oTarget);if(oAnchor){oAnchor.className="marked";}}function util_markNodeAsUnselected(oTarget){var selected=oTarget.getAttribute("sel");if(selected=="0"){return ;}oTarget.setAttribute("sel","0");var oAnchor=util_getAnchor(oTarget);if(oAnchor){oAnchor.className="";}}function util_unselectNodes(oTarget,oTree){var oLIs=oTree.getElementsByTagName("LI");if((oLIs)&&(oLIs.length)){for(var i=0;i<oLIs.length;i++){if(oLIs[i].getAttribute("sel")=="1"){util_markNodeAsUnselected(oLIs[i]);}}}}function util_getAnchor(oTarget){var oAnchor;if(oTarget.tagName=="LI"){oAnchor=util_getChildNode(oTarget.childNodes[0],"A");}else{oAnchor=util_getChildNode(oTarget,"A");}return oAnchor;}function util_checkSelectedNodes(oTarget,oTree){var multi=oTarget.getAttribute("multi");if(!multi){util_unselectNodes(oTarget,oTree);}else{var did=oTarget.getAttribute("did");var oLIs=oTree.getElementsByTagName("LI");if((oLIs)&&(oLIs.length)){for(var i=0;i<oLIs.length;i++){var treeNode=oLIs[i];if((treeNode.getAttribute("did")!=did)&&(treeNode.getAttribute("sel")=="1")){var multi=treeNode.getAttribute("multi");if(!multi){util_markNodeAsUnselected(treeNode);}}}}}}function util_setTreeTargetState(oTarget,iState){if(!oTarget){return ;}oTarget.childNodes[0].className=(iState==NODE_STATE_OPEN)?CSS_CLASS_OPEN:CSS_CLASS_CLOSED;if((oTarget.nextSibling)&&(oTarget.nextSibling.tagName=="UL")){oTarget.nextSibling.style.display=(iState==NODE_STATE_OPEN)?"block":"none";}return ;}function showTreeWaitMessage(oTarget,location){if(!oTarget){return ;}iframe.isTreeProcessing=true;var div=document.createElement("DIV");div.setAttribute("IFRAME","true");div.id=DIV_TREE_WAIT_ID;div.className=CSS_TREE_WAIT;div.noWrap=true;if((typeof (aDescriptor)!="undefined")&&(aDescriptor[38]!=null)){div.innerHTML=aDescriptor[38];}else{div.innerHTML="Loading...";}oTarget.insertAdjacentElement(location,div);return ;}function hideTreeWaitMessage(){var div=getObj(DIV_TREE_WAIT_ID);if(div){if(div.previousSibling){div.previousSibling.insertAdjacentElement("afterEnd",div.childNodes[0]);}else{div.parentNode.appendChild(div.childNodes[0]);}div.parentNode.removeChild(div);}return ;}function removeTreeWaitMessage(){var div=getObj(DIV_TREE_WAIT_ID);if(div){iframe.isTreeProcessing=false;oTarget=div.previousSibling;if((oTarget!=null)&&(oTarget.firstChild!=null)){util_setTreeTargetState(oTarget,NODE_STATE_CLOSED);}div.parentNode.removeChild(div);}}
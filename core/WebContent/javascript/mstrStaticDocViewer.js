mstrStaticDocViewer.prototype=new mstrBoneImpl();mstrStaticDocViewer.prototype.superClass=mstrEditorImpl.prototype;mstrStaticDocViewer.prototype.updateManager=microstrategy.updateManager;mstrStaticDocViewer.prototype.zoom=100;mstrStaticDocViewer.prototype.flags=0;mstrStaticDocViewer.prototype.rulerOn=false;mstrStaticDocViewer.prototype.gridOn=false;mstrStaticDocViewer.prototype.dividerOn=false;mstrStaticDocViewer.prototype.rulerShadeOn=false;mstrStaticDocViewer.prototype.rulers={};mstrStaticDocViewer.prototype.scrollTopPosition=0;mstrStaticDocViewer.prototype.scrollLeftPosition=0;mstrStaticDocViewer.prototype.noDataset=false;mstrStaticDocViewer.prototype.objProps=null;mstrStaticDocViewer.prototype.resizeTimer=null;mstrStaticDocViewer.prototype.totalHeight=0;mstrStaticDocViewer.prototype.gridCellCssPrefix="";mstrStaticDocViewer.prototype.messageID="";mstrStaticDocViewer.prototype.objectID="";mstrStaticDocViewer.prototype.objectType=microstrategy.DSSTYPE_DOC_DEFINITION;mstrStaticDocViewer.prototype.parentFolderID=null;mstrStaticDocViewer.prototype.needSaveBeforeNotes=true;mstrStaticDocViewer.prototype.isMultiLayout=false;mstrStaticDocViewer.prototype.tabCount=0;mstrStaticDocViewer.prototype.sectionSubsections=null;mstrStaticDocViewer.prototype.panelStacks=null;mstrStaticDocViewer.prototype.onLoadCalled=false;mstrStaticDocViewer.prototype.resizedSubsections=null;mstrStaticDocViewer.prototype.documentDataSets=null;mstrStaticDocViewer.prototype.hasHorizontalSections=false;mstrStaticDocViewer.prototype.viewerBone=true;mstrStaticDocViewer.prototype.gradientsOnSS=false;mstrStaticDocViewer.prototype.gridGraphFormatting=true;mstrStaticDocViewer.prototype.dScrollTop=0;mstrStaticDocViewer.prototype.dScrollLeft=0;mstrStaticDocViewer.prototype.needWidthAdjustment=false;mstrStaticDocViewer.prototype.onload=function(){try{this.commands=new mstrViewerCommandsImpl();this.observer=microstrategy.viewerObserver||new mstrObserverImpl();microstrategy.viewerObserver=this.observer;this.initViewer();if(this.layoutHeightMode!=1){this.callDelayedResize();if(this.scrollTopPosition!=0||this.scrollLeftPosition!=0){this.delayedScrollAdjust(this.scrollTopPosition,this.scrollLeftPosition);}}this.onLoadCalled=true;}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.onrepostload=function(e){try{mstrBoneImpl.prototype.onrepostload.call(this);this.observer.notifyAll("onDocReload");}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);this.adjustWidth();this.updateVerticalTextFields();}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.onstatechange=function(){this.observer.notifyAll("onstatechange");};mstrStaticDocViewer.prototype.onObjectBrowserTabChange=function(){this.observer.notifyAll("onObjectBrowserTabChange");};mstrStaticDocViewer.prototype.onselectionchange=function(){this.observer.notifyAll("onselectionchange");};mstrStaticDocViewer.prototype.onreload=function(e){try{this.onLoadCalled=false;this.resizedSubsections={};var docStyleIFrame=document.getElementById("docObjectStyleIFrame");if(docStyleIFrame){var docStyle=document.getElementById("docObjectStyle");if(docStyle&&docStyle.parentNode){docStyle.parentNode.removeChild(docStyle);}}var docGridStyleIFrame=document.getElementById("consolidatedGridStyleSheetIFrame");if(docGridStyleIFrame){var docGridStyle=document.getElementById("consolidatedGridStyleSheet");if(docGridStyle&&docGridStyle.parentNode){docGridStyle.parentNode.removeChild(docGridStyle);}}var boneReloaded=this.superClass.onreload.call(this,e);this.doc.formattingAttributes=this.formattingAttributes;this.doc.styleObj.reloadFormattingAttributes(this.formattingAttributes);if(!boneReloaded&&this.doc.hasMoved()){this.onwinresize();}}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.adjustScrollValues=function(e){try{var i=document.createElement("img");document.body.appendChild(i);i.parentNode.removeChild(i);this.elem.onmousemove=null;this.dScrollTop=this.elem.scrollTop;this.dScrollLeft=this.elem.scrollLeft;return true;}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.onwinresize=function(){try{this.callDelayedResize();}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.getAvailableDatasets=function(){try{var ds=[];if(!this.noDataset){for(var id in this.documentDataSets){ds.push({dssid:id,n:this.documentDataSets[id]});}}return ds;}catch(err){microstrategy.errors.log(err);return ds;}};mstrStaticDocViewer.prototype.delayedScrollAdjust=function(scrollTopPosition,scrollLeftPosition){try{if(this.scrollTimer){window.clearTimeout(this.scrollTimer);}this.scrollTimer=window.setTimeout("microstrategy.bone('"+this.id+"').onscrollAdjust("+scrollTopPosition+","+scrollLeftPosition+")",0);}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.onscrollAdjust=function(scrollTopPosition,scrollLeftPosition){try{if(this.elem&&this.elem.hasChildNodes()){if(this.elem.style){if(scrollTopPosition!=0){this.elem.scrollTop=scrollTopPosition;this.dScrollTop=scrollTopPosition;}if(scrollLeftPosition!=0){this.elem.scrollLeft=scrollLeftPosition;this.dScrollLeft=scrollLeftPosition;}}}}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.callDelayedResize=function(bDoc){try{if(this.resizeTimer){window.clearTimeout(this.resizeTimer);}if(!!bDoc){this.resizeTimer=window.setTimeout("microstrategy.bone('"+this.id+"').doc.onwinresize()",0);}else{this.resizeTimer=window.setTimeout("microstrategy.bone('"+this.id+"').ondialogresize()",0);}}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.ondialogresize=function(){try{if(this.tmr_dr){window.clearTimeout(this.tmr_dr);}iframe.showWaitPage(true);var me=this;this.tmr_dr=window.setTimeout(function(){me.delayedOndialogresize();},300);}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.getAvaiableDocViewerWidth=function getAvaiableDocViewerWidth(){try{var bm=mstr.utils.BoxModel,dim=bm.getBrowserWindowWidth(document);return bm.hasScrollbar(document.documentElement,"y")?dim+SCROLLBAR_SIZE:dim;}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.delayedOndialogresize=function(){var me=this;if(me.elem&&me.elem.hasChildNodes()){if(me.elem.style){var clientHeight=getClientHeight();var clientWidth=me.getAvaiableDocViewerWidth();var topSum=getObjSumTop(me.elem);var leftSum=getObjSumLeft(me.elem);var bottomSum=0;if(true){bottomSum=document.getElementById("mstrWeb_footer").offsetHeight+document.getElementById("mstrWeb_dockBottom").offsetHeight;}me.elem.style.height=Math.max(clientHeight-topSum-4-bottomSum,SCROLLBAR_SIZE)+"px";me.elem.style.width=Math.max(clientWidth-leftSum-4,SCROLLBAR_SIZE)+"px";if(mstr.utils.ISWK){var el=document.getElementById("mstrWebContents");el.style.overflow="hidden";window.setTimeout(function(){el.style.overflow="auto";},0);}}if(me.doc&&me.doc.onwinresize){me.callDelayedResize(true);}}};mstrStaticDocViewer.prototype.onforcerepaint=function(){try{if(!this.doc||!this.doc.elem){return ;}var i=document.createElement("img");this.doc.elem.appendChild(i);i.parentNode.removeChild(i);}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.initViewer=function(){try{this.initBone();var doc=microstrategy.objectFind(this.elem,["DIV"],microstrategy.OBJTYPE_DOC);if(this.commands){this.commands.parentBone=this;}if(doc){var id=doc.getAttribute("id");if(!(microstrategy.bone(id))){var docScript=doc.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);this.doc=new window[docScript](id);this.doc.parentBone=this;this.doc.containsHorizontalSections=this.hasHorizontalSections;if(this.doc.onload){this.doc.onload();}this.needWidthAdjustment=true;}if(this.doc&&this.doc.containsHorizontalSections){this.resize100WMObjects();}}}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.updateVerticalTextFields=function(){if(bIsDXIE){return ;}var $=function(id){return document.getElementById(id);},formats=this.formattingAttributes;if(!formats){return ;}var tdUnits=formats.tdUnits,key;for(key in tdUnits){var node=$(key),rotation=-parseInt(tdUnits[key],10);if(node){microstrategy.styleObj.changeTextFieldRotation(node,rotation);}}};mstrStaticDocViewer.prototype.resize100WMObjects=function(secId,isPanel){try{var ids="";var i=0;var j=0;var objs=null;if(secId&&(this.doc.containsHorizontalSections||isPanel)){var secWidth;if(this[secId+"_100wm"]!=null){ids=String(this[secId+"_100wm"]).split(",");for(i=0;i<ids.length;i++){objs=document.getElementsByName(ids[i]);secWidth=getObjWidth(document.getElementById(secId))+"px";for(j=0;objs!=null&&j<objs.length;j++){if(objs[i]&&microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){secWidth=getObjWidth(objs[i].parentNode)+"px";}objs[j].style.width=this.doc.removePaddingAndBorder(objs[j],secWidth,"width")+"px";}}}}else{var docWidth=getObjWidth(this.doc.elem)+"px";var docSel=this.doc.selections;ids=String(this.viewer100wm).split(",");for(i=0;i<ids.length;i++){objs=document.getElementsByName(ids[i]);var subBone=microstrategy.findBone(objs[0]);if(subBone&&!subBone.isHorizontal){for(j=0;objs!=null&&j<objs.length;j++){objs[j].style.width=this.doc.removePaddingAndBorder(objs[j],docWidth,"width")+"px";}if(docSel!=null){docSel.syncUp(objs[0]);}}}}}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.resize100HMObjects=function(secId,subSection){try{if(this[secId+"_100hm"]!=null){var ids=String(this[secId+"_100hm"]).split(",");for(var i=0;i<ids.length;i++){if(subSection){var obj=microstrategy.findChildWithAtt(subSection,"SPAN","id",ids[i]);if(obj){var szeObj=(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.RESIZE_EACH_SUBSECTION)?document.getElementById(secId):obj.parentNode;obj.style.height=this.doc.removePaddingAndBorder(obj,getObjHeight(szeObj)+"px","height")+"px";}}else{var secHeight;var objs=document.getElementsByName(ids[i]);if(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.RESIZE_EACH_SUBSECTION){secHeight=getObjHeight(document.getElementById(secId))+"px";}for(var j=0;objs!=null&&j<objs.length;j++){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){secHeight=getObjHeight(objs[j].parentNode)+"px";}objs[j].style.height=this.doc.removePaddingAndBorder(objs[j],secHeight,"height")+"px";}}}}}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.syncDocRszHandler=function(){};mstrStaticDocViewer.prototype.setZoom=function(value){this.zoom=value;return false;};mstrStaticDocViewer.prototype.setFlags=function(value){return false;};mstrStaticDocViewer.prototype.getChildBone=function(obj){try{if(this.doc==null||!this.doc.isLoaded){return null;}var type=obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(type){case microstrategy.OBJTYPE_DOC:return this.doc;break;case microstrategy.OBJTYPE_DOC_SUBSECTION:case microstrategy.OBJTYPE_DOC_SECTION:case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:return this.doc.getChildBone(obj);break;}return null;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDocViewer.prototype.handleTaskModelReadyStateChange=function(evt){try{this.doc.handleTaskModelReadyStateChange(evt);}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.findParentSubsection=function(obj){try{var res=microstrategy.findAncestorWithAtt(obj.parentNode,"ty",microstrategy.OBJTYPE_DOC_SUBSECTION);if(res&&res.getAttribute("sty")){res=this.findParentSubsection(res);}return res;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDocViewer.prototype.isInteractiveViewModeEplus=function(e){return false;};mstrStaticDocViewer.prototype.isEditableViewModeEplus=function(){return false;};mstrStaticDocViewer.prototype.adjustWidth=function(){try{if(this.needWidthAdjustment&&this.doc&&this.doc.adjustWidth){this.doc.adjustWidth();}this.needWidthAdjustment=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDocViewer.onUnitReload=function(bone){try{if(!bone.elem){return ;}var docViewer=microstrategy.getViewerBone();if((!docViewer)||docViewer.onLoadCalled){return ;}if(!docViewer.resizedSubsections){docViewer.resizedSubsections={};}var subsection=docViewer.findParentSubsection(bone.elem);if((!subsection)||docViewer.resizedSubsections[subsection.id]){return ;}var subsectionBone=microstrategy.findBone(subsection);if(subsectionBone&&subsectionBone.resizeSubsection){subsectionBone.resizeSubsection();docViewer.resizedSubsections[subsection.id]=true;}docViewer.doc.synchHeightOfHorizontalSections();}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.setNeedWidthAdjustment=function(value){try{this.needWidthAdjustment=this.isLoaded&&value;}catch(err){microstrategy.errors.log(err);}};mstrStaticDocViewer.prototype.getAllVisList=function(){return this.allVisList;};mstrStaticDocViewer.prototype.showWarningMessageForUnsupportFeature=function(okCB,cancelCB){if(this.isFeatureAvailable("rw-support-flash-mode")){showMessage({contents:microstrategy.descriptors.getDescriptor(13964),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:okCB,cancelEval:cancelCB,type:mstrMsgBoxImpl.MSG_WARNING});}else{okCB();}};mstrStaticDocViewer.prototype.checkAndDisableFlashDefaultMode=function(updateManager,ac){if(this.DefaultViewMode===mstr.Enum.VIEWMEDIA.FLASH){var vm=mstr.Enum.VIEWMEDIA,availVM=this.AvailableViewModes,defaultViewMode=(vm.STATIC&availVM)?vm.STATIC:(vm.INTERACTIVE&availVM)?vm.INTERACTIVE:0;ac.push(updateManager.createActionObject(null,mstrUpdateManager.SET_VIEW_MEDIA,this.beanPath,["2048163"],[defaultViewMode],[]));}};function mstrStaticDocViewer(id){this.inherits=mstrEditorImpl;this.inherits(id);this.inherits=null;this.primaryBone=true;return this;}
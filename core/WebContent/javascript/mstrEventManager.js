microstrategy.MOUSE_MOVES_BUFFER=5;microstrategy.HTMLATTR_DRAG="DG";microstrategy.HTMLATTR_DRAG_OFF=0;microstrategy.HTMLATTR_DRAG_DRAGGABLE=1;microstrategy.HTMLATTR_DRAG_DOCKABLE=2;mstrEventsManagerImpl.prototype=new Object;mstrEventsManagerImpl.prototype.source=new Object;mstrEventsManagerImpl.prototype.browserHeight=null;mstrEventsManagerImpl.prototype.browserWidth=null;mstrEventsManagerImpl.prototype.onload=function(e){try{if(window.mstrInterfacePlugin){mstrInterfacePlugin.init();}microstrategy.updateLayoutProps();microstrategy.loadDynamicJS(e,true);return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.initializeBones=function(e){try{microstrategy.registerNewBones();this.notifyOrphanBones("onload",e);this.notifyOrphanBones("onpostload",e);this.onforcerepaint();if(window.mstrApp&&mstrApp.pendingMojoEditor&&mstrApp.pendingMojoEditor!=""){microstrategy["show"+mstrApp.pendingMojoEditor]();delete mstrApp.pendingMojoEditor;}if(iframe){iframe.hideWaitPage(true);}microstrategy.handleLastMessageRecovery();return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.onforcerepaint=function(){try{this.notifyOrphanBones("onforcerepaint");return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.onnotifydrag=function(items,bone,types){try{this.notifyOrphanBones("onnotifydrag",items,bone,types);return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.onreload=function(e){try{microstrategy.IS_RELOAD=true;if(microstrategy.updateManager){microstrategy.updateManager.acknowledgeRequest();}this.notifyOrphanBones("onreload",e);this.notifyOrphanBones("onrepostload",e);if(microstrategy.updateManager){microstrategy.updateManager.acknowledgeReloadEnd();}window.setTimeout("microstrategy.eventManager.onforcerepaint()",0);microstrategy.IS_RELOAD=false;microstrategy.setupPageMessageDisplay();return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.onwinresize=function(){try{if(this.hasWindowResized()){microstrategy.redoLayout();this.notifyOrphanBones("onwinresize");this.notifyOrphanBones("onforcerepaint");if(typeof resizePromptContent!="undefined"){resizePromptContent();}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.ondialogresize=function(e){try{this.getSource(e);this.notifyOrphanBones("ondialogresize",e);this.notifyOrphanBones("onforcerepaint");if(typeof resizePromptContent!="undefined"){resizePromptContent();}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.getSource=function(e,obj){try{this.source=new Object;try{getMouse(e);this.source.mousedownX=lMouseX;this.source.mousedownY=lMouseY;this.source.shiftKey=((bIsIE4)?event.shiftKey:e&&e.shiftKey);this.source.button=getButtonId(e);this.source.elem=(obj)?obj:microstrategy.findAncestor(getEventTarget(e));}catch(localerr){this.source.elem=null;}if(this.source.elem){this.source.id=this.source.elem.getAttribute("id");this.source.type=microstrategy.objectType(this.source.elem);this.source.subType=microstrategy.subObjectType(this.source.elem);this.source.bone=microstrategy.findBone(this.source.elem);this.source.left=getObjSumLeftScrolled(this.source.elem);this.source.top=getObjSumTopScrolled(this.source.elem);this.source.width=this.source.elem.offsetWidth;this.source.height=this.source.elem.offsetHeight;this.source.draggable=(this.source.bone&&this.source.bone.elem)?this.source.bone.elem.getAttribute(microstrategy.HTMLATTR_DRAG):null;this.source.draggable=(!isNaN(parseInt(this.source.draggable)))?parseInt(this.source.draggable):microstrategy.HTMLATTR_DRAG_OFF;}else{this.source.id=null;this.source.type=null;this.source.subType=null;this.source.bone=null;this.source.left=lMouseX;this.source.top=lMouseY;this.source.width=0;this.source.height=0;this.source.draggable=microstrategy.HTMLATTR_DRAG_OFF;}this.source.offsetX=this.source.left-lMouseX;this.source.offsetY=this.source.top-lMouseY;return this.source;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.notifyBone=function(eventName,e){try{if(this.source&&this.source.bone&&eventName in this.source.bone){return this.source.bone[eventName](e,this.source);}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.notifyOrphanBones=function(){try{var i;var evtName=arguments[0];var args=[];for(i=1;i<arguments.length;i++){args[i-1]=arguments[i];}var cnt=0;var pBones=[];var sBones=[];for(var id in microstrategy.bones){var b=microstrategy.bones[id];if(b&&!b.parentBone&&!b.isDormant&&b[evtName]){cnt++;if(b.primaryBone){pBones.push(b);}else{sBones.push(b);}}}pBones.reverse();sBones.reverse();var bones=pBones.concat(sBones);var __result=true;for(i=0;i<cnt;i++){if(bones[i][evtName].apply(bones[i],args)==false){__result=false;}}return __result;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.notifyZones=function(eventName,e){try{var ozones=microstrategy.zones;var izones=ozones.length;for(var i=0;i<izones;i++){if(ozones[i]&&eventName in ozones[i]){ozones[i][eventName](e);}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrEventsManagerImpl.prototype.executeFunction=function(functionToExecute){for(var bone in microstrategy.controlVariables){if(!microstrategy.controlVariables[bone]){window.setTimeout("microstrategy.eventManager.executeFunction('"+functionToExecute+"');",250);return ;}}eval(functionToExecute);microstrategy.controlVariables=new Object();};mstrEventsManagerImpl.prototype.hasWindowResized=function(){try{var __result=false;var h=mstr.utils.BoxModel.getBrowserWindowHeight(document);var w=mstr.utils.BoxModel.getBrowserWindowWidth(document);if(h!=this.browserHeight||w!=this.browserWidth){this.browserHeight=h;this.browserWidth=w;__result=true;}}catch(err){microstrategy.errors.log(err);}return __result;};function mstrEventsManagerImpl(){return this;}if(microstrategy){microstrategy.eventManager=new mstrEventsManagerImpl();}
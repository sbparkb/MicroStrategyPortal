mstrGraphTitlesTabImplScript=true;mstrGraphTitlesTabImpl.prototype=new mstrTabImpl();mstrGraphTitlesTabImpl.prototype.initializing=false;mstrGraphTitlesTabImpl.prototype.isSeriesListValid=false;mstrGraphTitlesTabImpl.prototype.targetPicker=null;mstrGraphTitlesTabImpl.prototype.originalTargetPicker=null;mstrGraphTitlesTabImpl.prototype.categoryPicker=null;mstrGraphTitlesTabImpl.prototype.MAX_ALPHA=255;mstrGraphTitlesTabImpl.prototype.DEFAULT_MAX_UNITS=100;mstrGraphTitlesTabImpl.prototype.useCurvedLines=true;mstrGraphTitlesTabImpl.prototype.circleMarker=null;mstrGraphTitlesTabImpl.prototype.roundedEffect=false;mstrGraphTitlesTabImpl.prototype.targetFillEffectPicker=null;mstrGraphTitlesTabImpl.prototype.originalFillEffectPicker=null;mstrGraphTitlesTabImpl.prototype.Major_Vertical_area=1;mstrGraphTitlesTabImpl.prototype.Major_Horizontal_area=2;mstrGraphTitlesTabImpl.prototype.Major_Vertical_bar=4;mstrGraphTitlesTabImpl.prototype.Major_Horizontal_bar=8;mstrGraphTitlesTabImpl.prototype.Major_Vertical_line=16;mstrGraphTitlesTabImpl.prototype.Major_Horizontal_line=32;mstrGraphTitlesTabImpl.prototype.Major_Pie=64;mstrGraphTitlesTabImpl.prototype.Major_Scatter=128;mstrGraphTitlesTabImpl.prototype.Major_Polar=256;mstrGraphTitlesTabImpl.prototype.Major_Radar=512;mstrGraphTitlesTabImpl.prototype.Major_Bubble=1024;mstrGraphTitlesTabImpl.prototype.Major_HiLo_Stock=2048;mstrGraphTitlesTabImpl.prototype.Major_Histogram=4096;mstrGraphTitlesTabImpl.prototype.Major_Gauge=524288;mstrGraphTitlesTabImpl.prototype.Major_Funnel=1048576;mstrGraphTitlesTabImpl.prototype.Major_Pareto=2097152;mstrGraphTitlesTabImpl.prototype.Major_Box_Plot=4194304;mstrGraphTitlesTabImpl.prototype.Major_Gantt=8388608;mstrGraphTitlesTabImpl.prototype.Major_3D_risers=8192;mstrGraphTitlesTabImpl.prototype.Major_3D_floating=16384;mstrGraphTitlesTabImpl.prototype.Major_3D_connect_group=32768;mstrGraphTitlesTabImpl.prototype.Major_3D_connect_series=65536;mstrGraphTitlesTabImpl.prototype.Major_3D_surface=131072;mstrGraphTitlesTabImpl.prototype.Major_3D_scatter=262144;mstrGraphTitlesTabImpl.prototype.NumberTabId="tbNumId";mstrGraphTitlesTabImpl.OBJECT_ID_RISER="286";mstrGraphTitlesTabImpl.OBJECT_ID_ALLTEXTS="10000";mstrGraphTitlesTabImpl.OBJECT_ID_ALLTITLES="10001";mstrGraphTitlesTabImpl.OBJECT_ID_ALLAXES="10002";mstrGraphTitlesTabImpl.OBJECT_ID_DATATEXT="260";mstrGraphTitlesTabImpl.OBJECT_ID_OPILBLVALUE="418";mstrGraphTitlesTabImpl.OBJECT_ID_PIEFEELERLABEL="338";mstrGraphTitlesTabImpl.GRAPH_OBJECT_ID_3DCOL_TITLE="515";mstrGraphTitlesTabImpl.GRAPH_OBJECT_ID_3DROW_TITLE="555";mstrGraphTitlesTabImpl.prototype.onload=function(){try{this.initializing=true;this.isSeriesListValid=true;this.initEditor();this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);this.initializing=true;this.initSettings();this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.adjustValidSeriesList=function(cmdId,newValue){try{var isValid=this.isSeriesListValid;var originalValue=this.getAppliesTo().commands.queryState(cmdId);this.isSeriesListValid=(newValue==originalValue);if(isValid!=this.isSeriesListValid){this.adjustAvailableTitles();}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.onserieslayoutchange=function(newValue){try{this.adjustValidSeriesList("seriesLayout",newValue);}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.onseriesvaluechange=function(newValue){try{this.adjustValidSeriesList("series",newValue);}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.onmajortypechange=function(newValue){try{this.major=newValue;this.adjustAvailableCategories();this.adjustAvailableTitles();}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.onminortypechange=function(newValue){try{this.minor=newValue;this.adjustAvailableTitles();}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.onusecurvedlineschange=function(newValue){this.useCurvedLines=(newValue=="true"||newValue=="1");this.adjustEffectCombo();};mstrGraphTitlesTabImpl.prototype.onroundedeffectchange=function(newValue){this.roundedEffect=(newValue=="true"||newValue=="1");this.enableFillEffectControl(!this.roundedEffect);this.enableScroller("titleTransparency",!this.roundedEffect);this.showFillColorPkrOptions(!this.roundedEffect||this.categoryPicker.value!=4);};mstrGraphTitlesTabImpl.prototype.initSettings=function(){try{this.major=this.getAppliesTo().commands.queryState("major");this.minor=this.getAppliesTo().commands.queryState("minor");var ucl=this.getAppliesTo().commands.queryState("useCurvedLines");this.useCurvedLines=(ucl=="true"||ucl=="1");this.circleMarker=this.getAppliesTo().commands.queryState("circleMarker");var re=this.getAppliesTo().commands.queryState("roundedEffect");this.roundedEffect=(re=="true"||re=="1");this.targetPicker=document.getElementById(this.id+"titleId");this.categoryPicker=document.getElementById(this.id+"categoryId");this.originalTargetPicker=document.getElementById(this.id+"OriginalTargetList");this.targetFillEffectPicker=document.getElementById(this.id+"titleFillEffect");this.originalFillEffectPicker=document.getElementById(this.id+"OriginalFillEffect");this.sample=microstrategy.subObjectFind(this.body,["DIV","SPAN"],microstrategy.SUBOBJTYPE_TAB_SAMPLE);this.settings=new Object();this.adjustAvailableCategories();this.adjustAvailableTitles();this.fixSettingsForTitle();this.showFillColorPkrOptions(!this.roundedEffect||this.categoryPicker.value!=4);this.synchronizeTitleShow();}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.addFieldSetting=function(colObj,name,targetId){try{var setting=document.getElementById(this.id+name+targetId);if(setting){colObj[name]=setting;}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.getChanges=function(bTargetOnly){try{var __result="";__result+=this.getJSONProperty("categoryId",this.categoryPicker.value);__result+=this.getJSONProperty("titleId",this.targetPicker.value);if((typeof (bTargetOnly)=="undefined")||(bTargetOnly==null)||!bTargetOnly){for(var titleId in this.settings){var titleSettings=this.settings[titleId];var titleJsonValue="{";for(var settingName in titleSettings[1]){var aSettingInput=titleSettings[1][settingName];settingName=settingName+titleId;var settingValue=aSettingInput.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);settingValue=(settingValue!=null&&settingName.indexOf("titleContent")>=0)?escape(settingValue):settingValue;if(settingValue!=null){titleJsonValue+=this.getJSONProperty(settingName,encodeURIComponent(settingValue));}}if(titleJsonValue.length>1){titleJsonValue=titleJsonValue.substring(0,titleJsonValue.length-1);}titleJsonValue+="}";__result+=this.getJSONProperty(titleId,titleJsonValue,true);}}if(__result.length>0){__result=__result.substring(0,__result.length-1);}return __result;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.restoreEachSelection=function(field,cmdId,value){try{field.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,value);}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.restorePreviousSelections=function(prevSettings){try{for(var setting in prevSettings){var value=prevSettings[setting];if(setting=="categoryId"||setting=="titleId"){var field=document.getElementById(this.id+setting);mstrTabImpl.prototype.restoreEachSelection.call(this,field,setting,unescape(value));if(setting=="categoryId"){this.adjustAvailableTitles();}}else{var titleId=setting;for(var setting in value){var field=document.getElementById(this.id+setting);var settingValue=unescape(value[setting]);if(field!=null&&value!=null){this.restoreEachSelection(field,setting,settingValue);}}this.getSettingsForTarget(titleId);}}this.fixSettingsForTitle();}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.getSettingsForTarget=function(targetId){try{var auxObjCollection=null;var alreadyExists=(typeof (this.settings[targetId])!="undefined");if(!alreadyExists){auxObjCollection=new Object();this.addFieldSetting(auxObjCollection,"titleName",targetId);this.addFieldSetting(auxObjCollection,"titleSize",targetId);this.addFieldSetting(auxObjCollection,"titleUnderline",targetId);this.addFieldSetting(auxObjCollection,"titleStrikeout",targetId);this.addFieldSetting(auxObjCollection,"titleBoldItalic",targetId);this.addFieldSetting(auxObjCollection,"titleShow",targetId);this.addFieldSetting(auxObjCollection,"tooltipsShow",targetId);this.addFieldSetting(auxObjCollection,"tooltipsEditor",targetId);this.addFieldSetting(auxObjCollection,"titleColor",targetId);this.addFieldSetting(auxObjCollection,"titleContent",targetId);this.addFieldSetting(auxObjCollection,"titlePosition",targetId);this.addFieldSetting(auxObjCollection,"titleFillColor",targetId);this.addFieldSetting(auxObjCollection,"titleFillEffect",targetId);this.addFieldSetting(auxObjCollection,"titleTransparency",targetId);this.addFieldSetting(auxObjCollection,"titleLineColor",targetId);this.settings[targetId]=new Array(targetId,auxObjCollection);}else{auxObjCollection=this.settings[targetId][1];}return auxObjCollection;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphTitlesTabImpl.prototype.cleanSampleStyle=function(oSample){try{if(oSample!=null){with(oSample.style){textDecoration="";fontWeight="";fontSize="";fontFamily="";color="";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.fixSettingsForTitle=function(){try{var auxObjCollection=this.getSettingsForTarget(this.targetPicker.value);this.targetPicker.setAttribute("title",this.targetPicker.options[this.targetPicker.selectedIndex].text);this.cleanSampleStyle(this.sample);this.initializing=true;this.initTitleComboValue(this.id+"titleName",auxObjCollection.titleName);this.initTitleComboValue(this.id+"titleSize",auxObjCollection.titleSize);this.initTitleCheckValue(this.id+"titleUnderline",auxObjCollection.titleUnderline);this.initTitleCheckValue(this.id+"titleStrikeout",auxObjCollection.titleStrikeout);this.initTitleComboValue(this.id+"titleBoldItalic",auxObjCollection.titleBoldItalic);this.initTitleShowCheckValue(this.id+"titleShow",auxObjCollection.titleShow,this.targetPicker.value);this.initTitleCheckValue(this.id+"tooltipsShow",auxObjCollection.tooltipsShow);this.initTitleTextValue(this.id+"tooltipsEditor",auxObjCollection.tooltipsEditor);this.initTitleColorPickerValue(this.id+"titleColor",auxObjCollection.titleColor,true);this.initTitleColorPickerValue(this.id+"titleLineColor",auxObjCollection.titleLineColor);this.initTitleColorPickerValue(this.id+"titleFillColor",auxObjCollection.titleFillColor);this.initTitleEffectComboValue(this.id+"titleFillEffect",auxObjCollection.titleFillEffect);this.initTitleScrollerValue(this.id+"titleTransparency",auxObjCollection.titleTransparency);this.initTitleTextValue(this.id+"titleContent",auxObjCollection.titleContent);this.initPositionComboValue(this.id+"titlePosition",auxObjCollection.titlePosition);this.enableIndividualControl("titleShow",true);var showObj=document.getElementById(this.id+"titleShow");var showArea=this.getControlArea("titleShow");if(showObj&&(showArea&&showArea.style.display!="none")&&!showObj.checked){this.enableControls(showObj.checked);}else{this.enableControls(true);}this.enableIndividualControl("tooltipsEditor",auxObjCollection.tooltipsShow!=null);this.initializing=false;return auxObjCollection;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.isControlSupported=function(controlName){try{return(this.settings[this.targetPicker.value]!=null&&this.settings[this.targetPicker.value][1][controlName]!=null);}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.enableControls=function(bEnable){try{this.enableIndividualControl("titleName",bEnable);this.enableIndividualControl("titleSize",bEnable);this.enableIndividualControl("titleUnderline",bEnable);this.enableIndividualControl("titleStrikeout",bEnable);this.enableIndividualControl("titleBoldItalic",bEnable);this.enableIndividualControl("titleColor",bEnable);this.enableControlByFontBox("titleFillColor",bEnable);this.enableControlByFontBox("titleFillEffect",bEnable);this.enableControlByFontBox("titleTransparency",bEnable);this.enableControlByFontBox("titleLineColor",bEnable);this.enableIndividualControl("titleContent",bEnable);this.enableIndividualControl("titlePosition",bEnable);}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.enableToolTipsSection=function(){try{var tooltipCheckBoxWrapper=this.getControlArea("tooltipsShow");var tooltipCheckBox=document.getElementById(this.id+"tooltipsShow");var tooltipEditor=document.getElementById(this.id+"tooltipsEditor");if(tooltipCheckBox.checked){this.disableOptionAndLabel(tooltipEditor,false);}else{this.disableOptionAndLabel(tooltipEditor,true);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.disableOptionAndLabel=function(option,bDisable){try{if(option){if(bDisable||option.getAttribute("db")!="true"){option.disabled=bDisable;}if(bDisable){option.className=option.className.replace(/\bmstrPulldown\b/,"mstrPulldowndisabled");}else{option.className=option.className.replace(/\bmstrPulldowndisabled\b/,"mstrPulldown");}if(document.getElementById(option.id+"_label")){document.getElementById(option.id+"_label").className=(bDisable)?"disabledLabel":"";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.getControlArea=function(controlName){try{var obj=document.getElementById(this.id+controlName+"_wrapper");if(!obj){obj=document.getElementById(this.id+controlName);}return obj;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.enableIndividualControl=function(controlName,bEnable){try{var obj=this.getControlArea(controlName);if(obj){var notAppBehavior=obj.getAttribute("na");if(!bEnable||!this.isControlSupported(controlName)){if(notAppBehavior&&notAppBehavior==0){removeObj(obj);}else{this.disableOptionAndLabel(obj,true);}}else{if(notAppBehavior&&notAppBehavior==0){displayObj(obj);}else{this.disableOptionAndLabel(obj,false);}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.enableFillEffectControl=function(bEnable){bEnable=bEnable&&!(this.roundedEffect&&this.categoryPicker.value==4);this.enableIndividualControl("titleFillEffect",bEnable);};mstrGraphTitlesTabImpl.prototype.enableScroller=function(controlName,bEnable){try{var enable=bEnable&&!(this.roundedEffect&&this.categoryPicker.value==4);this.enableIndividualControl(controlName,enable);var scrollerBone=microstrategy.bone(this.id+"titleTransparency");if(scrollerBone){scrollerBone.enableScroller(enable);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.enableControlByFontBox=function(controlName,bEnable){try{var fontBoxInput=document.getElementById(this.id+"titleFontBox"+this.targetPicker.value);var value=this.initTitleValue(this.id+"titleFontBox",fontBoxInput);if(fontBoxInput&&value=="0"){bEnable=false;}switch(controlName){case"titleTransparency":this.enableScroller(controlName,bEnable);break;case"titleFillEffect":this.enableFillEffectControl(bEnable);break;default:this.enableIndividualControl(controlName,bEnable);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.showFillColorPkrOptions=function(bShow){var colorPicker=document.getElementById(this.id+"reportColorPicker");if(colorPicker){var noColorOpt=microstrategy.findChildWithAtt(colorPicker,"SPAN","name","colorPicker0");if(noColorOpt){if(bShow){noColorOpt.style.display="";}else{noColorOpt.style.display="none";}}var gradientColorOpt=microstrategy.findChildWithAtt(colorPicker,"SPAN","name","pkrGradients");if(gradientColorOpt){if(bShow){gradientColorOpt.style.display="";}else{gradientColorOpt.style.display="none";}}}};mstrGraphTitlesTabImpl.prototype.initTitleComboValue=function(controlName,controlInput){try{var value=this.initTitleValue(controlName,controlInput);if(value!=null){var obj=document.getElementById(controlName);this.simpleInitComboValue(obj,value,"true");}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.initTitleCheckValue=function(controlName,controlInput){try{var value=this.initTitleValue(controlName,controlInput);if(value!=null){var obj=document.getElementById(controlName);this.simpleInitCheckValue(obj,value,"true");}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.initTitleShowCheckValue=function(controlName,controlInput,objectId){try{var value=this.initTitleValue(controlName,controlInput);if(value!=null){var obj=document.getElementById(controlName);var index=objectId.indexOf("_");if(index!=-1){var targetObjectId=objectId.substr(0,index);switch(targetObjectId){case mstrGraphTitlesTabImpl.OBJECT_ID_OPILBLVALUE:this.simpleInitCheckValue(obj,(value&1)?"true":"false","true");return ;case mstrGraphTitlesTabImpl.OBJECT_ID_PIEFEELERLABEL:this.simpleInitCheckValue(obj,(value&2)?"true":"false","true");return ;}}this.simpleInitCheckValue(obj,value,"true");}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.initTitleValue=function(controlName,controlInput){try{if(controlInput){var value=controlInput.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(value==null||value.length==0){value=controlInput.value;}return value;}else{return null;}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.initTitleTextValue=function(controlName,controlInput){try{var value=this.initTitleValue(controlName,controlInput);if(value!=null){var obj=document.getElementById(controlName);this.simpleInitTextValue(obj,value,false);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.initPositionComboValue=function(controlName,controlInput){try{var value=this.initTitleValue(controlName,controlInput);if(value!=null){var obj=document.getElementById(controlName);this.simpleInitComboValue(obj,value,false);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.adjustEffectCombo=function(){if(!this.targetFillEffectPicker){return ;}if(bIsIE6){var counter=this.targetFillEffectPicker.options.length;for(var j=0;j<counter;j++){this.targetFillEffectPicker.options.remove(0);}}else{if(bIsW3C){this.targetFillEffectPicker.options.length=0;}}var options=this.originalFillEffectPicker.options;if(this.isShortEffectList()){for(var i=0;i<options.length;i++){var anOption=options.item(i);if(anOption.value!="1"&&anOption.value!="2"){var optionCopy=document.createElement("option");this.targetFillEffectPicker.options.add(optionCopy);optionCopy.text=anOption.text;optionCopy.value=anOption.value;}}}else{for(var i=0;i<options.length;i++){var anOption=options.item(i);var optionCopy=document.createElement("option");this.targetFillEffectPicker.options.add(optionCopy);optionCopy.text=anOption.text;optionCopy.value=anOption.value;}}};mstrGraphTitlesTabImpl.prototype.isShortEffectList=function(){var cat=this.categoryPicker.value;if(this.major==this.Major_Gauge){var seriesID=-1;var objectID=9999;var target=this.getTargetIDs();if(target){objectID=target[0];if(target.length>1){seriesID=target[1];}}if(cat==1&&objectID=="444"){return true;}if(cat==4){if(objectID&&objectID.substring(0,3)==mstrGraphTitlesTabImpl.OBJECT_ID_RISER&&"0"==seriesID){return false;}else{if(this.isCircleMarker()){return true;}else{return false;}}}return false;}else{if(cat==4&&(this.isCircularType(this.major)||this.isCircularWithMarkerType(this.major)&&this.isCircleMarker()||this.isAreaType(this.major)&&this.useCurvedLines||this.isLineType(this.major)&&this.isCircleMarker()||this.major==this.Major_Polar&&this.isCircleMarker())){return true;}else{return false;}}};mstrGraphTitlesTabImpl.prototype.getTargetIDs=function(){if(this.targetPicker.value){objectID=this.targetPicker.value;return target=this.targetPicker.value.split("_");}else{return null;}};mstrGraphTitlesTabImpl.prototype.isCircleMarker=function(){var seriesID=-1;var objectID="9999";var target=this.getTargetIDs();if(target&&target.length>1){objectID=target[0];seriesID=target[1];}var cm="0";if(objectID&&objectID.substring(0,3)==mstrGraphTitlesTabImpl.OBJECT_ID_RISER&&this.circleMarker){cm=this.circleMarker[this.targetPicker.value];}if(cm=="true"||cm=="1"){return true;}else{return false;}};mstrGraphTitlesTabImpl.prototype.isCircularType=function(value){if(value==this.Major_Pie||value==this.Major_Gauge||value==this.Major_Funnel){return true;}else{return false;}};mstrGraphTitlesTabImpl.prototype.isCircularWithMarkerType=function(value){if(value==this.Major_Bubble||value==this.Major_Scatter){return true;}else{return false;}};mstrGraphTitlesTabImpl.prototype.isAreaType=function(value){if(value==this.Major_Vertical_area||value==this.Major_Horizontal_area){return true;}else{return false;}};mstrGraphTitlesTabImpl.prototype.isLineType=function(value){if(value==this.Major_Vertical_line||value==this.Major_Horizontal_line){return true;}else{return false;}};mstrGraphTitlesTabImpl.prototype.initTitleEffectComboValue=function(controlName,controlInput){try{var value=this.initTitleValue(controlName,controlInput);if(value){this.adjustEffectCombo();this.initTitleComboValue(controlName,controlInput);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.initTitleScrollerValue=function(controlName,controlInput){try{var value=this.initTitleValue(controlName,controlInput);if(value!=null&&value!=""){var scrollerBone=microstrategy.bone(this.id+"titleTransparency");if(scrollerBone){var startUnit=100-Math.round(value*100/this.MAX_ALPHA);scrollerBone.positionScroller(startUnit,startUnit);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.initTitleColorPickerValue=function(controlName,controlInput,updateSample){try{var value=this.initTitleValue(controlName,controlInput);if(value!=null&&value!=""){value=(value!="-1"&&value.indexOf("#")<0)?"#"+value:value;this.updateColorPicker(document.getElementById(controlName),value,updateSample);}else{this.updateColorPicker(document.getElementById(controlName),"");}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.adjustAvailableCategories=function(){try{var seriesLabel=document.getElementById(this.id+"category_sLabel");var d="block";if(this.major==mstrGraphTitlesTabImpl.prototype.Major_3D_surface){d="none";if(this.categoryPicker.value==seriesLabel.value){this.categoryPicker.selectedIndex=0;}}seriesLabel.style.display=d;}catch(err){microstrategy.errors.log(err);}};mstrGraphTitlesTabImpl.prototype.adjustAvailableTitles=function(){try{if(bIsIE6){var counter=this.targetPicker.options.length;for(var j=0;j<counter;j++){this.targetPicker.options.remove(0);}}else{if(bIsW3C){this.targetPicker.options.length=0;}}var currentCategory=this.categoryPicker.value;this.categoryPicker.setAttribute("title",this.categoryPicker.options[this.categoryPicker.selectedIndex].text);var titleOptions=this.originalTargetPicker.options;for(var i=0;i<titleOptions.length;i++){var anOption=titleOptions.item(i);if((anOption.getAttribute("cat")==currentCategory)&&this.isOptionAvailable(anOption)){var optionCopy=document.createElement("option");this.targetPicker.options.add(optionCopy);optionCopy.text=anOption.text;optionCopy.value=anOption.value;optionCopy.title=anOption.text;optionCopy.style.color=anOption.style.color;}}this.fixSettingsForTitle();this.showFillColorPkrOptions(!this.roundedEffect||this.categoryPicker.value!=4);}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.synchronizeTitleShow=function(){try{var titleOptions=this.originalTargetPicker.options;for(var i=0;i<titleOptions.length;i++){var anOption=titleOptions.item(i);if((anOption.getAttribute("cat")=="5")){var originalStr=anOption.value;var originalInput=document.getElementById(this.id+"titleShow"+originalStr);var value=this.initTitleValue(this.id+"titleShow",originalInput);this.synchronizeSingleTitleShow(originalStr,value);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.synchronizeSingleTitleShow=function(targetStr,value){try{var index=targetStr.indexOf("_");if(index!=-1){targetStr=mstrGraphTitlesTabImpl.OBJECT_ID_RISER+"_"+targetStr.substr(index+1);}var targetInput=document.getElementById(this.NumberTabId+"titleShow"+targetStr);if(targetInput){targetInput.setAttribute(mstrHTMLAttributes.TITLE_SHOW_VALUE,value);microstrategy.eventManager.notifyOrphanBones("onTitleShowChange",targetStr);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.isOptionAvailable=function(option){try{var filter=option.getAttribute(microstrategy.HTMLATTR_FILTER_VALUE);var xFilter=false;if(xFilter=(typeof (filter)=="undefined"||filter==null)){filter=option.getAttribute("x"+microstrategy.HTMLATTR_FILTER_VALUE);}var seriesCat=option.getAttribute("cat");if((typeof (seriesCat)!=undefined&&(seriesCat=="4"||seriesCat=="5"))&&!this.isSeriesListValid){return xFilter;}if(filter){var composedFilter=option.getAttribute("cf");var filterValue=this.major;if(composedFilter){filterValue=this.major+"_"+this.minor;}return(xFilter)?!microstrategy.isValueInFilter(filterValue,filter):microstrategy.isValueInFilter(filterValue,filter);}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.updateCheck=function(obj){try{if(obj){var newFormat="";var newCommandValue=0;var cmdId=obj.getAttribute(microstrategy.HTMLATTR_CMD_ID);var inputObj=document.getElementById(this.id+cmdId+this.targetPicker.value);switch(cmdId){case"titleUnderline":if(this.sample.style.textDecoration.indexOf("line-through")>=0){newFormat="line-through ";}if(obj.checked){newFormat=newFormat+"underline";newCommandValue=4;}else{newCommandValue=-4;}if(this.sample){this.sample.style.textDecoration=newFormat;}break;case"titleStrikeout":if(this.sample.style.textDecoration.indexOf("underline")>=0){newFormat="underline ";}if(obj.checked){newFormat=newFormat+"line-through";newCommandValue=8;}else{newCommandValue=-8;}if(this.sample){this.sample.style.textDecoration=newFormat;}break;case"titleShow":newCommandValue="false";if(obj.checked){newCommandValue="true";}this.enableControls(obj.checked);var targetStr=this.targetPicker.value;this.synchronizeSingleTitleShow(targetStr,newCommandValue);if(targetStr==mstrGraphTitlesTabImpl.OBJECT_ID_DATATEXT){this.updateTitleShowCheckForAll(newCommandValue,"5");}if(inputObj&&!this.initializing){inputObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newCommandValue);}var index=targetStr.indexOf("_");if(index!=-1&&!this.initializing){var targetID=this.targetPicker.value.substring(0,index);var counterpartID=null;if(targetID==mstrGraphTitlesTabImpl.OBJECT_ID_OPILBLVALUE){counterpartID=mstrGraphTitlesTabImpl.OBJECT_ID_PIEFEELERLABEL;newCommandValue=obj.checked?1:~1;}else{if(targetID==mstrGraphTitlesTabImpl.OBJECT_ID_PIEFEELERLABEL){counterpartID=mstrGraphTitlesTabImpl.OBJECT_ID_OPILBLVALUE;newCommandValue=obj.checked?2:~2;}}if(counterpartID){var counterpartInput=document.getElementById(this.id+cmdId+counterpartID+this.targetPicker.value.substring(index));if(counterpartInput){var value=this.initTitleValue(this.id+cmdId,counterpartInput);}newCommandValue=newCommandValue>0?newCommandValue|value:newCommandValue&value;}}if(inputObj&&!this.initializing){inputObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newCommandValue);}break;case"tooltipsShow":newCommandValue="false";if(obj.checked){newCommandValue="true";}this.enableToolTipsSection(obj.checked);break;}if(cmdId!="titleShow"){if(inputObj&&!this.initializing){inputObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newCommandValue);}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.updateText=function(obj){try{if(obj){var cmdId=obj.getAttribute(microstrategy.HTMLATTR_CMD_ID);var cmdValue=obj.value;var inputObj=document.getElementById(this.id+cmdId+this.targetPicker.value);if(inputObj&&!this.initializing){inputObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,cmdValue);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.updateList=function(obj){try{if(obj&&this.sample){var newFormat="";var cmdId=obj.getAttribute(microstrategy.HTMLATTR_CMD_ID);var cmdValue=obj.value;switch(cmdId){case"titleBoldItalic":if(cmdValue==null||cmdValue.length==0){cmdValue="0";}this.sample.style.fontWeight="normal";this.sample.style.fontStyle="normal";switch(parseInt(cmdValue)){case 3:this.sample.style.fontStyle="italic";case 1:this.sample.style.fontWeight="bold";break;case 2:this.sample.style.fontStyle="italic";break;default:this.sample.style.fontWeight="normal";this.sample.style.fontStyle="normal";}break;case"titleSize":if(cmdValue==null||cmdValue.length==0){cmdValue="8";}if(cmdValue!="-2"){this.sample.style.fontSize=cmdValue+"pt";}break;case"titleName":if(cmdValue==null){cmdValue="";}if(cmdValue!="-2"){this.sample.style.fontFamily=cmdValue;}break;case"titlePosition":break;}var inputObj=document.getElementById(this.id+cmdId+this.targetPicker.value);if(inputObj&&!this.initializing){inputObj.value=cmdValue;inputObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,cmdValue);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.updateColorPicker=function(obj,value,updateSample){try{if(obj&&value!="-2"){var cmdVal=(value=="")?"-1":value;value=(value=="-1")?"":value;var pixels=obj.childNodes;if(pixels.length>0){pixels=obj.childNodes[0].innerHTML="";}if(value.split(",").length>1){this.updateColorPickerGradient(obj.id+"|"+value);}else{mstrTabImpl.prototype.updateColorPicker.call(this,obj,value);}if(value!="More"){var inputObj=document.getElementById(this.id+obj.getAttribute(microstrategy.HTMLATTR_CMD_ID)+this.targetPicker.value);if(inputObj){inputObj.value=value;if(!this.initializing){inputObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,cmdVal);}}}}if(updateSample&&this.sample){this.sample.style.color=value;}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.updateTitleShowCheckForAll=function(value,cat){try{var titleOptions=this.originalTargetPicker.options;for(var i=0;i<titleOptions.length;i++){var anOption=titleOptions.item(i);if((anOption.getAttribute("cat")==cat)&&anOption.value!=mstrGraphTitlesTabImpl.OBJECT_ID_DATATEXT){var originalStr=anOption.value;var originalInput=document.getElementById(this.id+"titleShow"+originalStr);if(originalInput&&!this.initializing){originalInput.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,value);this.synchronizeSingleTitleShow(originalStr,value);}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.exec=function(cmdId,cmdVal){try{switch(cmdId){case"advColorPicker":mstrTabImpl.prototype.exec.call(this,cmdId,cmdVal);var info=cmdVal.split("|");if(info[0]==this.id+"titleColor"){if(this.sample){this.sample.style.color=info[1];}}break;case"edtColorGradient":info=cmdVal.split("|");var dropDown=document.getElementById(info[0]);if(dropDown){var spans=dropDown.getElementsByTagName("span");if(spans.length>0){spans[0].setAttribute(microstrategy.HTMLATTR_CMD_VALUE,info[1]);}else{dropDown.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,info[1]);}var inputObj=document.getElementById(this.id+dropDown.getAttribute(microstrategy.HTMLATTR_CMD_ID)+this.targetPicker.value);if(inputObj){inputObj.value=info[1];if(!this.initializing){inputObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,info[1]);}}}this.updateColorPickerGradient(cmdVal);break;case"edtColorGradient":info=cmdVal.split("|");var dropDown=document.getElementById(info[0]);if(dropDown){var spans=dropDown.getElementsByTagName("span");if(spans.length>0){spans[0].setAttribute(microstrategy.HTMLATTR_CMD_VALUE,info[1]);}else{dropDown.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,info[1]);}var inputObj=document.getElementById(this.id+dropDown.getAttribute(microstrategy.HTMLATTR_CMD_ID)+this.targetPicker.value);if(inputObj){inputObj.value=info[1];if(!this.initializing){inputObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,info[1]);}}}this.updateColorPickerGradient(cmdVal);break;case"titleTransparency_horizontal":info=cmdVal.split("|");var inputObj=document.getElementById(this.id+"titleTransparency"+this.targetPicker.value);var scroller=microstrategy.bone(this.id+"titleTransparency");var maxUnits=scroller?scroller.maxUnits:this.DEFAULT_MAX_UNITS;if(inputObj){inputObj.value=this.MAX_ALPHA-((parseInt(info[0]))*this.MAX_ALPHA/(maxUnits-1));if(!this.initializing){inputObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,inputObj.value);}}break;}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.execPicker=function(picker,obj){try{var cmdId=picker.commandId;var newValue=obj.getAttribute("id").slice(3);switch(cmdId){case"titleColor":case"titleFillColor":case"titleLineColor":var dropDown=document.getElementById(this.id+cmdId);var newValue=obj.getAttribute("id").slice(3);if(newValue=="More"){var color=(dropDown&&dropDown.getElementsByTagName("span").length>0)?dropDown.getElementsByTagName("span")[0].style.backgroundColor:"";this.openAdvancedColorPicker(this.getAppliesTo(),cmdId,color);}else{if(newValue=="Gradients"){var at=this.getAppliesTo();var viewKey=at.id;if(microstrategy.pageName=="rwd"){var selGrid=at.commands.queryState("selectedGrid");if(selGrid){viewKey=selGrid.id;}}var seriesID=-1;var objectID=9999;if(this.targetPicker.value){objectID=this.targetPicker.value;var target=this.targetPicker.value.split("_");if(target.length>1){objectID=target[0];seriesID=target[1];}}var previousSettings;var inputID=this.id+cmdId+objectID;if(seriesID>-1){inputID=inputID+"_"+seriesID;}var inputObject=document.getElementById(inputID);if(inputObject){var inputValue=inputObject.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(inputValue&&inputValue.length>0){var values=inputValue.split(",");if(values.length==1){previousSettings="|"+values[0]+"||-1|-1|-1|-1";}else{previousSettings="|"+values[0]+"|"+values[1]+"|"+values[2]+"|"+values[3]+"|"+values[4]+"|"+values[5];}}}if(!previousSettings){previousSettings="|||-1|-1|-1|-1";}this.openColorGradientEditor(this.getAppliesTo(),this.id+"|"+this.id+cmdId+"|"+viewKey+"|"+objectID+"|"+seriesID+previousSettings,true);}else{this.updateColorPicker(dropDown,newValue,cmdId=="titleColor");}}break;}return true;}catch(err){microstrategy.errors.log(err);}return false;};mstrGraphTitlesTabImpl.prototype.applyFormatChanges=function(at,bulkChanges){try{var formatBulkArray=bulkChanges;var hasChange=false;for(var settingElem in this.settings){var styleProcessed=false;var aSetting=this.settings[settingElem];var formatGraphObjectBulk=null;var titleId=aSetting[0];if(this.findOptionValue(this.targetPicker,titleId)){var titleSettings=aSetting[1];formatGraphObjectBulk=new Array();for(var aKey in titleSettings){aSetting=titleSettings[aKey];var cmdId=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var cmdVl=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);var seriesId=this.getSeriesId(aSetting);var targetObj=titleId;var index=targetObj.indexOf("_");if(index>0){targetObj=targetObj.substr(0,index);}if(seriesId){targetObj=targetObj+"_"+seriesId;}if(cmdVl||typeof (cmdVl)=="boolean"){hasChange=true;switch(cmdId){case"titleUnderline":case"titleStrikeout":case"titleBoldItalic":if(!styleProcessed){styleProcessed=true;var finalValue=0;if(mstrGraphTitlesTabImpl.isTargetForAll(targetObj)){finalValue+=this.processStylePropertyForAllTarget("titleUnderline",titleId);finalValue+=this.processStylePropertyForAllTarget("titleStrikeout",titleId);finalValue+=this.processStylePropertyForAllTarget("titleBoldItalic",titleId);}else{finalValue+=this.processStyleProperty("titleUnderline",titleId,4);finalValue+=this.processStyleProperty("titleStrikeout",titleId,8);var temp=this.processStyleProperty("titleBoldItalic",titleId,1);if(temp==1||temp==0){finalValue+=temp;temp=this.processStyleProperty("titleBoldItalic",titleId,2);}finalValue+=temp;}cmdId="titleStyle";cmdVl=finalValue;}else{continue;}break;case"titleFillEffect":case"titleTransparency":var tempArray=new Array(cmdId,cmdVl);var auxArray=new Array(targetObj,new Array(tempArray));formatBulkArray.push(new Array("saveGraphProperties",auxArray));cmdId=null;break;case"titleSize":cmdVl=parseInt(cmdVl);break;case"titleColor":case"titleLineColor":cmdVl=(cmdVl!="-1"&&(cmdVl.indexOf("#")==0))?cmdVl.substr(1):cmdVl;var tempArray=new Array(cmdId,cmdVl);var auxArray=new Array(targetObj,new Array(tempArray));formatBulkArray.push(new Array("saveGraphProperties",auxArray));cmdId=null;break;case"titleFillColor":cmdVl=(cmdVl!="-1"&&(cmdVl.indexOf("#")==0))?cmdVl.substr(1):cmdVl;if(cmdVl.split(",").length>1){cmdId="titleGradient";var tempArray=new Array(cmdId,cmdVl);var auxArray=new Array(targetObj,new Array(tempArray));formatBulkArray.push(new Array("saveGraphProperties",auxArray));}else{var tempArray=new Array(cmdId,cmdVl);var auxArray=new Array(targetObj,new Array(tempArray));formatBulkArray.push(new Array("saveGraphProperties",auxArray));}cmdId=null;break;case"titlePosition":var positionFormatGraphObjectBulk=new Array();positionFormatGraphObjectBulk.push(new Array(cmdId,cmdVl));var tempArray=new Array("9999",positionFormatGraphObjectBulk);tempArray=new Array("formatGraphObjectBulk",tempArray);formatBulkArray.push(tempArray);cmdId=null;break;case"tooltipsShow":case"tooltipsEditor":var positionFormatGraphObjectBulk=new Array();positionFormatGraphObjectBulk.push(new Array(cmdId,cmdVl));var seriesId=this.getSeriesId(aSetting);if(seriesId){var tempArray=new Array("9999_"+seriesId,positionFormatGraphObjectBulk);}else{var tempArray=new Array("9999",positionFormatGraphObjectBulk);}tempArray=new Array("formatGraphObjectBulk",tempArray);formatBulkArray.push(tempArray);cmdId=null;break;case"titleContent":if(this.major==this.Major_3D_scatter){if(targetObj==mstrGraphTitlesTabImpl.GRAPH_OBJECT_ID_3DCOL_TITLE){targetObj=mstrGraphTitlesTabImpl.GRAPH_OBJECT_ID_3DROW_TITLE;}else{if(targetObj==mstrGraphTitlesTabImpl.GRAPH_OBJECT_ID_3DROW_TITLE){targetObj=mstrGraphTitlesTabImpl.GRAPH_OBJECT_ID_3DCOL_TITLE;}}}var tempArray=new Array(cmdId,cmdVl);var auxArray=new Array(targetObj,new Array(tempArray));formatBulkArray.push(new Array("saveGraphProperties",auxArray));cmdId=null;break;}if(cmdId){formatGraphObjectBulk.push(new Array(cmdId,cmdVl));}}}}var auxArray=null;if(formatGraphObjectBulk!=null&&formatGraphObjectBulk.length>0){auxArray=new Array(titleId,formatGraphObjectBulk);auxArray=new Array("formatGraphObjectBulk",auxArray);formatBulkArray.push(auxArray);}}if(hasChange){this.saveTabSelections();}return formatBulkArray;}catch(err){microstrategy.errors.log(err);return bulkChanges;}};mstrGraphTitlesTabImpl.isTargetForAll=function(targetId){try{return targetId==mstrGraphTitlesTabImpl.OBJECT_ID_ALLTEXTS||targetId==mstrGraphTitlesTabImpl.OBJECT_ID_ALLTITLES||targetId==mstrGraphTitlesTabImpl.OBJECT_ID_ALLAXES||targetId==mstrGraphTitlesTabImpl.OBJECT_ID_DATATEXT||targetId==mstrGraphTitlesTabImpl.OBJECT_ID_OPILBLVALUE;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphTitlesTabImpl.prototype.getSeriesId=function(aSetting){var id=aSetting.id;var index=id.indexOf("_");if(index>0){return id.substr(index+1);}else{return null;}};mstrGraphTitlesTabImpl.prototype.findOptionValue=function(objSelect,value){try{var targetOptions=this.originalTargetPicker.options;for(var i=0;i<targetOptions.length;i++){var anOption=targetOptions.item(i);if(anOption.value==value){return this.isOptionAvailable(anOption);}}}catch(err){microstrategy.errors.log(err);}return false;};mstrGraphTitlesTabImpl.prototype.processStyleProperty=function(id,titleId,settingValue){var finalValue=0;try{var auxObj=document.getElementById(this.id+id+titleId);var tempValue=auxObj.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(tempValue){tempValue=parseInt(tempValue);if((tempValue>0)&&(tempValue&settingValue)){finalValue=tempValue;}}else{if(!tempValue){tempValue=auxObj.value;}tempValue=parseInt(tempValue);if(tempValue&settingValue){finalValue=settingValue;}}}catch(err){microstrategy.errors.log(err);}return finalValue;};mstrGraphTitlesTabImpl.prototype.processStylePropertyForAllTarget=function(id,titleId){var finalValue=0;try{var auxObj=document.getElementById(this.id+id+titleId);var tempValue=auxObj.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!tempValue){return 0;}else{tempValue=parseInt(tempValue);switch(id){case"titleBoldItalic":var boldIndexVal=((tempValue&1)==0)?2:1;var italicIndexVal=((tempValue&2)==0)?2:1;finalValue=boldIndexVal+italicIndexVal*16;break;case"titleUnderline":case"titleStrikeout":var indexVal=(tempValue==(id=="titleUnderline"?-4:-8))?2:1;finalValue=indexVal*Math.pow(16,(id=="titleUnderline"?2:3));break;}}}catch(err){microstrategy.errors.log(err);}return finalValue;};mstrGraphTitlesTabImpl.prototype.updateColorPickerGradient=function(value){try{var info=value.split("|");var container=document.getElementById(info[0]);var childSpans=container.getElementsByTagName("span");if(childSpans.length>0){container=childSpans[0];}else{return false;}container.innerHTML="";var gradientInfo=info[1].split(",");var width=getObjInnerWidth(container);var height=getObjInnerHeight(container);if(width%2==1){width=width-1;}if(height%2==1){height=height-1;}var color1RGB=gradientUtil.getRGBColor(gradientInfo[0]);var color2RGB=gradientUtil.getRGBColor(gradientInfo[1]);var xx;for(var i=0;i<(width/2)*(height/2);i++){var pixel=document.createElement("div");pixel.className="pixel";xx=parseInt(i%(width/2));var comp=xx*2/width;var colorr=parseInt(comp*(color2RGB[0]-color1RGB[0]))+color1RGB[0];var colorg=parseInt(comp*(color2RGB[1]-color1RGB[1]))+color1RGB[1];var colorb=parseInt(comp*(color2RGB[2]-color1RGB[2]))+color1RGB[2];pixel.style.backgroundColor="rgb("+colorr+", "+colorg+", "+colorb+")";container.appendChild(pixel);}}catch(err){microstrategy.errors.log(err);}};function mstrGraphTitlesTabImpl(id){this.inherits=mstrTabImpl;this.inherits(id);this.inherits=null;return this;}
mstrContextMenuImpl.prototype=new Object();contextMenuScript=true;mstrContextMenuImpl.prototype.cmm_id=null;mstrContextMenuImpl.prototype.cmm_items=null;mstrContextMenuImpl.prototype.menu_items=null;mstrContextMenuImpl.prototype.length=0;mstrContextMenuImpl.IMG_EMPTY=0;mstrContextMenuImpl.IMG_CHECK=1;mstrContextMenuImpl.IMG_REMOVE=2;mstrContextMenuImpl.IMG_SUBTOTAL=3;mstrContextMenuImpl.IMG_DRILL_UP=4;mstrContextMenuImpl.IMG_DRILL_DOWN=5;mstrContextMenuImpl.IMG_DRILL_TEMPLATE=6;mstrContextMenuImpl.IMG_DRILL=7;mstrContextMenuImpl.IMG_LOADING=8;mstrContextMenuImpl.prototype.addItem=function(label,toExecute,toEnable,toShow,image){try{var menuDefinition;if(!toEnable){toEnable=1;}if(!toShow){toShow=1;}if(!image){image=mstrContextMenuImpl.IMG_EMPTY;}if(typeof (toExecute)=="string"){menuDefinition=new Array(label,toExecute,image,0,"","",toShow,toEnable);}else{menuDefinition=new Array(label,"",image,1,"["+toExecute.menu_items.toString()+"]","",toShow,toEnable);}return this.addItemDefinition(menuDefinition);}catch(err){microstrategy.errors.log(err);return false;}};mstrContextMenuImpl.prototype.addSeparator=function(){try{var menuDefinition=new Array("-","",0,2,"",1,1);return this.addItemDefinition(menuDefinition);}catch(err){microstrategy.errors.log(err);return false;}};mstrContextMenuImpl.prototype.addItemDefinition=function(menuDefinition){try{this.cmm_items.push(menuDefinition);this.menu_items.push(this.cmm_items.length-1);this.length=this.menu_items.length;return menuDefinition;}catch(err){microstrategy.errors.log(err);return false;}};mstrContextMenuImpl.prototype.registerTrigger=function(object,types){try{if(object){object.setAttribute("cx","["+this.menu_items.toString()+"]");object.setAttribute("cxid",this.cmm_id);if(types){object.setAttribute("cxty",types);}}return true;}catch(err){microstrategy.errors.log(err);return false;}};function mstrContextMenuImpl(cmm_id,cmm_items,menuItemsArray){this.cmm_id=cmm_id;this.cmm_items=cmm_items;this.menu_items=menuItemsArray;return this;}
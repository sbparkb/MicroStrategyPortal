mstr.models.TabManagerModel=(function(){mstr.$O.extendsClass(TMM,mstr.models.ListModel);TMM.prototype.initializing=false;TMM.prototype.getTarget=function TMM_getTarget(){return mstr.controllers.Factory.getPath(this.get("targetPath"),this);};TMM.prototype.execReinitializeModel=function TMM_execReinitializeModel(){this.initializing=true;var itm=this.initializeModel();var items=this.getItems();var cnt=items.length;for(var i=0;i<cnt;i++){if(itm&&items[i].isToInitialize()){items[i].initializeModel();}else{items[i].set("enabled",false);}}if(itm&&!items[this.getSelectedIndex()].isToInitialize()){this.execSingleSelect(0);}this.initializing=false;return true;};TMM.prototype.initializeModel=function TMM_initializeModel(){var target=this.getTarget();target&&target.observer&&target.observer.register(this.get("id"));return true;};TMM.prototype.getPropertyValue=function TMM_getPropertyValue(fieldName,tabId){};TMM.prototype.queryEnabled=function TMM_queryEnabled(fieldName,tabId){return true;};TMM.prototype.queryVisible=function TMM_queryVisible(fieldName,tabId){return true;};TMM.prototype.updateTarget=function TMM_updateTarget(evt){this.getTarget().commands.exec(evt.memo.name,evt.memo.value);};TMM.prototype.execOkChanges=function TMM_execOkChanges(){var changes=this.collectChanges();if(this.get("hasChanges")){this.submitChanges(changes);}this.resetStatus();return true;};TMM.prototype.execApplyChanges=function TMM_execApplyChanges(){this.execOkChanges();if(!mstr.utils.ISSAFARI){this.initializeModel();}else{var me=this;var timer=window.setInterval(function(){if(microstrategy.puStatus==1){window.clearInterval(timer);me.initializeModel();}},100);}};TMM.prototype.execCancelChanges=function TMM_execCancelChanges(){this.resetStatus();};TMM.prototype.resetStatus=function TMM_resetStatus(){this.set("enableOk",false);this.set("CommandEnabledApplyChanges",false);if(this.get("hasChanges")){this.resetChanges();}this.set("hasChanges",false);var target=this.getTarget();target&&target.observer&&target.observer.unregister(this.get("id"));return true;};TMM.prototype.handlePropChanged=function TMM_handlePropChanged(evt){var handlerName="on_"+evt.memo.name+"_changed";if(this[handlerName]){this[handlerName](evt);}var items=this.getItems();for(var i=0,cnt=items.length;i<cnt;i++){if(items[i][handlerName]){items[i][handlerName](evt);}}if(!this.initializing){for(var i=0;i<items.length;i++){if(items[i].isStoreChange(evt.memo.name)){this.set("hasChanges",true);this.set("CommandEnabledApplyChanges",true);}}}};TMM.prototype.resetChanges=function TMM_resetChanges(){var items=this.getItems();for(var i=0,cnt=items.length;i<cnt;i++){items[i].resetChanges();}};TMM.prototype.collectChanges=function TMM_collectChanges(){if(this.get("hasChanges")!=true){return{};}var changes={};var items=this.getItems();for(var i=0,cnt=items.length;i<cnt;i++){items[i].collectChanges(changes);}return changes;};TMM.prototype.submitChanges=function TMM_submitChanges(changes){};TMM.prototype.getTabById=function TMM_getTabById(tabId){return this.get("tabs")[tabId];};TMM.prototype.init=function TMM_init(){mstr.models.ListModel.prototype.init.apply(this);var items=this.getItems();var cnt=items.length;for(var i=0;i<cnt;i++){items[i].attachEventListener(this,"prop_changed","handlePropChanged");}var that=this;var fn=function(){that.execReinitializeModel();};var methods=this.get("listenerMethods").split(",");for(var i=0,cnt=methods.length;i<cnt;i++){this[methods[i]]=fn;}};function TMM(props){mstr.models.ListModel.apply(this,[props]);}return TMM;})();mstr.models.GraphEditorModel=(function(){mstr.$O.extendsClass(GEM,mstr.models.TabManagerModel);GEM.prototype.initializeModel=function GEM_initializeModel(){mstr.models.TabManagerModel.prototype.initializeModel.apply(this,[]);var target=this.getTarget();if(target&&target.commands&&target.commands.queryEnabled("isGraphPropertiesReady")){return true;}return false;};GEM.prototype.submitChanges=function GEM_submitChanges(changes){this.getTarget().commands.exec("FormatGraphUniversal",changes);};GEM.prototype.getPropertyValue=function GEM_getPropertyValue(field,tabId){var v=null;var category=tabId?this.getTabById(tabId).getCurrentCategory():"default";var target=this.getTarget();var commands=target.commands;switch(field){case"gen_visible":case"fmt_visible":v=target.isFeatureAvailable("grid-graph-formatting")||target.isFeatureAvailable("simple-graph-formatting");break;case"adv_visible":var majorType=this.getPropertyValue("majorType",tabId)["value"];v=(majorType!=33554432)&&(target.isFeatureAvailable("grid-graph-formatting")||target.isFeatureAvailable("simple-graph-formatting"));break;case"opt_visible":v=target.isFeatureAvailable("grid-graph-formatting")&&this.getPropertyValue("isGauge",tabId);break;case"axs_visible":var majorType=this.getPropertyValue("majorType",tabId)["value"];v=target.isFeatureAvailable("grid-graph-formatting")&&!this.getPropertyValue("isPie",tabId)&&!this.getPropertyValue("isFunnel",tabId)&&(majorType!=33554432);break;case"num_visible":v=target.isFeatureAvailable("grid-graph-formatting");break;case"isGauge":v=this.getPropertyValue("majorType",tabId)["value"];v=(v==524288);break;case"isPie":v=this.getPropertyValue("majorType",tabId)["value"];v=(v==64);break;case"isFunnel":v=this.getPropertyValue("majorType",tabId)["value"];v=(v==1048576);break;case"is3DGraph":v=this.getPropertyValue("majorType",tabId)["value"];v=!!(v&516096);break;case"majorType":case"minorType":case"mainCat":case"subCat":case"dualOptionItems":v=commands.queryState(field);break;case"titleContent":var tv=commands.queryState("titleOriContent");if(!tv){tv=commands.queryState(field);}v=this.getTabById(tabId).getDeltaChange(field)||tv;break;default:v=this.getTabById(tabId).getDeltaChange(field);if(v==null){v=commands.queryState(field);}}return v;};GEM.prototype.getSubTargets=function GEM_getSubTargets(tabId){var commands=this.getTarget().commands;if(tabId=="Format"){return commands.queryState("fmtSubTargets");}else{if(tabId=="Number"){return commands.queryState("numSubTargets");}else{return null;}}};GEM.prototype.queryEnabled=function GEM_queryEnabled(fieldName,tabId){var commands=this.getTarget().commands;var category=tabId?this.getTabById(tabId).getCurrentCategory():"default";switch(fieldName){case"curvedLines":return(this.getPropertyValue("majorType",tabId)["value"]&51)>0;break;case"dualAxisAuto":return this.getPropertyValue("dualAxisAuto","Axes")=="1";case"gfnCat":var fmtCat=this.getTabById("Format").getCurrentCategory();var numCat=this.getTabById("Number").getCurrentCategory();if(fmtCat!=numCat){this.getTarget().commands.exec("subCat",numCat);this.getTabById("Format").curTargetId=numCat;}var enable=this.getPropertyValue("show","Format")&&!(this.getPropertyValue("dataTextShow","Format")&2);if(numCat=="-2"){enable=true;}if(fmtCat!=numCat){this.getTarget().commands.exec("subCat",fmtCat);this.getTabById("Format").curTargetId=fmtCat;}return enable;default:return commands.queryEnabled(fieldName);}};GEM.prototype.queryVisible=function GEM_queryVisible(fieldName,tabId){var target=this.getTarget();var commands=target.commands;switch(fieldName){default:return commands.queryVisible(fieldName);}};GEM.prototype.execCancelChanges=function GEM_execCancelChanges(){mstr.models.TabManagerModel.prototype.execCancelChanges.apply(this,[]);this.getTarget().commands.exec("ResetGFEStatus",true);};GEM.prototype.on_majorType_changed=function GEM_on_majorType_changed(evt){if(!this.initializing){this.updateTarget(evt);}var tabs=["Options","Axes","Advanced"];for(var i=0,len=tabs.length;i<len;i++){var ot=this.getTabById(tabs[i]);if(ot.isToInitialize()){ot.initializeModel();}}};GEM.prototype.on_minorType_changed=function GEM_on_minorType_changed(evt){if(!this.initializing){this.updateTarget(evt);}};GEM.computeVal=function GEM_computeVal(v,subV){if(subV==null){subV="";}if(v==null){v=subV;}else{v=(v===subV)?subV:"";}return v;};function GEM(props){mstr.models.TabManagerModel.apply(this,[props]);}return GEM;})();mstr.models.TabModel=(function(){mstr.$O.extendsClass(TM,mstr.models.BaseModel);TM.prototype._setModelChangeEventListeners=function TM_setModelEventListeners(model,propertyName){if(model instanceof mstr.models.ListModel){if(model instanceof mstr.models.ColorPicker){model.attachEventListener(this,"set_actualColor","onModelPropertyChange");}else{model.attachEventListener(this,"hashadd_selectedIndices","onModelPropertyChange");model.attachEventListener(this,"hashremove_selectedIndices","onModelPropertyChange");}model.set("mappedPropertyName",propertyName);}else{if(model instanceof mstr.models.ListCart){var s=model.get("selected");s.attachEventListener(this,"listadd_items","onModelPropertyChange");s.attachEventListener(this,"listremove_items","onModelPropertyChange");s.set("mappedPropertyName",propertyName);}}};TM.prototype.onModelPropertyChange=function TM_onModelPropertyChange(evt){var model=evt.src;var v="";var valueWas=null;var propName=model.get("mappedPropertyName");if(evt.name=="set_actualColor"){v=model.get("actualColor");valueWas=evt.memo.valueWas;}else{var items=[];switch(evt.name){case"hashadd_selectedIndices":case"hashremove_selectedIndices":items=model.getSelectedItems();valueWas=evt.memo.at;break;case"listadd_items":case"listremove_items":items=model.getItems();break;default:return ;}var vf=model.get("valueForm");var d="";for(var i=0,cnt=items.length;i<cnt;i++){v+=d+items[i][vf];d=CLIPBOARD_ITEM_SEPARATOR;}}if(v==""){return ;}if(this.isStoreChange(propName)){this.storeDeltaChange(propName,v);}this.raiseEvent("prop_changed",{name:propName,src:evt.name,value:v,valueWas:valueWas});this.raiseEvent("set_"+propName,{name:propName,src:evt.name,value:v,valueWas:valueWas});};TM.prototype.collectChanges=function TM_collectChanges(changes){var deltas=this.deltaProps;for(var p in deltas){if(deltas[p]&&!this.isSetOnAllTarget(deltas[p])){changes[p]=deltas[p];}}};TM.prototype.isSetOnAllTarget=function TM_isSetOnAllTarget(delta){};TM.prototype.resetChanges=function TM_resetChanges(){this.resetDeltas();};TM.prototype.isToInitialize=function TM_isToInitialize(){var f=function(that,field){var cf=that.get(field);if(cf){var v=that.getPropertyValue(cf);that.set(cf,v);return v;}return true;};if(!f(this,"visibleField")||!f(this,"enabledField")){return false;}return true;};TM.prototype.initializeModel=function TM_initializeModel(){this.resetChanges();this.initFields(this.sFields);this.set("enabled",true);};TM.prototype.initFields=function TM_initFields(fields){if(!fields){return ;}for(var i=0;i<fields.length;i++){this.initField(fields[i]);}};TM.prototype.initField=function TM_initField(field){var isInitializing=this.get("parent").initializing;if(!isInitializing){this.get("parent").initializing=true;}var value=this.getPropertyValue(field);this.set(field+"_visible",this.queryVisible(field));this.set(field+"_enabled",this.queryEnabled(field));var prop=this.props[field];var initLM=function(m,v){if(v&&v instanceof Object&&"items" in v){m.setItems(v.items);v=v.value;}if(typeof v!="undefined"){var fn=(mstr.$A.isArray(v))?"execSelectValues":"execSelectValue";var success=m[fn](v);if(!success&&m.execClearSelect){m.execClearSelect();}}};if(prop instanceof mstr.models.ListCart){initLM(prop.get("selected"),value.selected);initLM(prop.get("availableFiltered"),value.availableFiltered);initLM(prop.get("available"),value.available);}else{if(prop instanceof mstr.models.ListModel){if(prop instanceof mstr.models.ColorPicker){var vf=this.getTarget().commands.queryState(field+"_vf");if(vf!=""){prop.set("popup|viewFlags",vf);}}initLM(prop,value);}else{this.set(field,value);}}if(!isInitializing){this.get("parent").initializing=false;}};TM.prototype.getPropertyValue=function TM_getPropertyValue(field){return this.get("parent").getPropertyValue(field,this.get("tabId"));};TM.prototype.queryEnabled=function TM_queryEnabled(field){return this.get("parent").queryEnabled(field,this.get("tabId"));};TM.prototype.queryVisible=function TM_queryVisible(field){return this.get("parent").queryVisible(field,this.get("tabId"));};TM.prototype.getTarget=function TM_getTarget(){return this.get("parent").getTarget();};TM.prototype.updateTarget=function TM_updateTarget(evt){return this.get("parent").updateTarget(evt);};TM.prototype.set=function TM_set(n,v){mstr.models.BaseModel.prototype.set.apply(this,[n,v]);if(this.isStoreChange(n)){this.storeDeltaChange(n,v);}this.raiseEvent("prop_changed",{name:n,value:v});};TM.prototype.getCurrentCategory=function TM_getCategory(){return"default";};TM.prototype.storeDeltaChange=function TM_storeDeltaChange(n,v,c){if(this.deltaProps==null){this.deltaProps={};}var fieldName=n;var cat=(c)?c:this.getCurrentCategory();n=cat+"|"+n;if(this.deltaProps[n]==null){this.deltaProps[n]={};this.deltaProps[n]["name"]=n;this.deltaProps[n]["vWas"]=this.props[fieldName];this.deltaProps[n]["memo"]={};}this.deltaProps[n]["v"]=v;this.deltaProps[n]["memo"]["cat"]=cat;this.deltaProps[n]["memo"]["fieldName"]=fieldName;};TM.prototype.getDeltaChange=function TM_getDeltaChange(n,c){var cat=(c)?c:this.getCurrentCategory();n=cat+"|"+n;if(this.deltaProps[n]){return this.deltaProps[n]["v"];}else{return null;}};TM.prototype.isStoreChange=function TM_isStoreChange(n){return !this.get("parent").initializing&&(mstr.utils.Arrays.find(this.sFields,n)>-1);};TM.prototype.resetSingleDelta=function TM_resetSingleDelta(n){n=this.getCurrentCategory()+"|"+n;this.deltaProps[n]=null;};TM.prototype.resetDeltas=function TM_resetDeltas(){this.deltaProps={};mstr.models.BaseModel.prototype.set.apply(this,["hasChanges",false]);};TM.prototype.getStoreFields=function TM_getStoreFields(){return this.getFields(this.get("storeFields"));};TM.prototype.getActionFields=function TM_getActionFields(){return this.getFields(this.get("actionFields"));};TM.prototype.getFields=function TM_getFields(fieldStr){if(!fieldStr){return[];}var fields=fieldStr.split("|");if(fields[0]==""){fields.shift();}if(fields[fields.length-1]==""){fields.pop();}return fields;};TM.prototype.init=function TM_init(){mstr.models.BaseModel.prototype.init.apply(this);var tabId=this.get("tabId"),parent=this.get("parent"),tabs=parent.get("tabs");if(tabId==null){return ;}if(tabs==null){parent.props.tabs=tabs={};}tabs[tabId]=this;this.sFields=this.getStoreFields();this.aFields=this.getActionFields();var fields=this.sFields.concat(this.aFields);if(!fields){return ;}for(var i=0,cnt=fields.length;i<cnt;i++){if(this.props[fields[i]]){this._setModelChangeEventListeners(this.props[fields[i]],fields[i]);}}};function TM(props){mstr.models.BaseModel.apply(this,[props]);this.resetChanges();}return TM;})();mstr.models.DynamicTabModel=(function(){mstr.$O.extendsClass(DTM,mstr.models.TabModel);DTM.prototype.storeDeltaChange=function DTM_storeDeltaChange(n,v){this.getTarget().commands.exec("gfeField",n);var subTargets=this.get("parent").getSubTargets(this.get("tabId"));if(subTargets&&subTargets.length>0){var c="";for(id in subTargets){var ix=subTargets[id].indexOf("_");if(ix>-1){var sc=subTargets[id].substring(0,ix);if(c!=sc){c=sc;mstr.models.TabModel.prototype.storeDeltaChange.apply(this,[n,v,c]);}}mstr.models.TabModel.prototype.storeDeltaChange.apply(this,[n,v,subTargets[id]]);}}else{mstr.models.TabModel.prototype.storeDeltaChange.apply(this,[n,v]);}};DTM.prototype.getDeltaChange=function DTM_getDeltaChange(n){this.getTarget().commands.exec("gfeField",n);var subTargets=this.get("parent").getSubTargets(this.get("tabId"));var v=null;if(subTargets&&subTargets.length>0){for(id in subTargets){this.getTarget().commands.exec(this.getTargetName(),subTargets[id]);var subV=mstr.models.TabModel.prototype.getDeltaChange.apply(this,[n,subTargets[id]]);if(subV==null){subV=this.getTarget().commands.queryState(n);}v=mstr.models.GraphEditorModel.computeVal(v,subV);}this.getTarget().commands.exec(this.getTargetName(),this.curTargetId);}else{v=mstr.models.TabModel.prototype.getDeltaChange.apply(this,[n]);}return v;};DTM.prototype.getTargetName=function DTM_getTargetName(){return"";};DTM.prototype.isSetOnAllTarget=function DTM_isSetOnAllTarget(delta){var cat=delta&&delta.memo["cat"];var n=cat.substring(0,cat.indexOf("_"))+"|"+delta.memo["fieldName"];if(this.deltaProps[n]&&delta.v==this.deltaProps[n]["v"]){return true;}else{return false;}};function DTM(props){mstr.models.TabModel.apply(this,[props]);}return DTM;})();mstr.models.GraphGeneralTabModel=(function(){mstr.$O.extendsClass(GGTM,mstr.models.TabModel);GGTM.prototype.on_majorType_changed=function GGTM_on_majorType_changed(evt){var mtm=this.get("minorType");var mt=this.getPropertyValue("minorType",this.get("tabId"));mtm.setItems(mt.items);if(!mtm.execSelectValue(mt.value)){mtm.execSingleSelect(0);}this.initField("curvedLines");this.setTooltipsVisible();};GGTM.prototype.setTooltipsVisible=function GFTM_setTooltipsVisible(){this.set("tooltipsShow_visible",this.get("parent").queryVisible("tooltipsShow",this.get("tabId")));this.set("tooltipsEditor_visible",this.get("parent").queryVisible("tooltipsEditor",this.get("tabId")));};GGTM.prototype.on_roundedEffect_changed=function GGTM_on_roundedEffect_changed(evt){this.updateTarget(evt);};function GGTM(props){mstr.models.TabModel.apply(this,[props]);}return GGTM;})();mstr.views.GraphFormatTabView=(function(){mstr.$O.extendsClass(GFTV,mstr.views.BaseView);GFTV.prototype.model=null;GFTV.prototype.init=function GFTV_init(){var modelPath=this.get("modelPath");var modelSubStrs=modelPath.split("/");var index=modelSubStrs[modelSubStrs.length-1];if(index&&index.length>0){index=parseInt(index);this.model=this.get("parent").get("model").get("items")[index];}if(this.model&&this.model.attachEventListener){this.model.attachEventListener(this,"prop_changed","handlePropChanged");}mstr.views.BaseView.prototype.init.apply(this);};GFTV.prototype.handlePropChanged=function GFTV_handlePropChanged(evt){var handlerName="on_"+evt.memo.name+"_changed";if(this[handlerName]){this[handlerName](evt);}};GFTV.prototype.on_roundedEffect_changed=function GFTV_on_roundedEffect_changed(evt){this.setToolTips();};GFTV.prototype.on_mainCat_changed=function GFTV_onMainCatChanged(evt){var mainId=this.model.get("mainCat").getSelectedItemValue();if(mainId==8){this.setToolTips();}this.setSubCatVisible();};GFTV.prototype.setSubCatVisible=function GFTV_setSubCatVisible(mainId){this.set("subCat_visible",this.model.getTarget().commands.queryVisible("subCat",this.get("tabId")));};GFTV.prototype.setToolTips=function GFTV_setToolTips(disabled){var toolTip=this.model.getTarget().commands.queryState("roundEffectTooltip");var markerTransTextBox=document.getElementById("MarkerTransTextBox");if(markerTransTextBox){markerTransTextBox.setAttribute("title",toolTip);}var markerBevelType=document.getElementById("markerBevelType");if(markerBevelType){var blockItem=microstrategy.findChildWithAtt(markerBevelType,"div","class","mstrListBlockItem");if(blockItem){blockItem.setAttribute("title",toolTip);}}};function GFTV(props){mstr.views.BaseView.apply(this,[props]);}return GFTV;})();mstr.models.GraphFormatTabModel=(function(){mstr.$O.extendsClass(GFTM,mstr.models.DynamicTabModel);GFTM.prototype.curTargetId=null;GFTM.prototype.storeDeltaChange=function GFTM_storeDeltaChange(n,v){mstr.models.DynamicTabModel.prototype.storeDeltaChange.apply(this,[n,v]);var subSelectItem=this.get("subCat").getSelectedItem();if(subSelectItem&&subSelectItem.uniqueName=="allDataMarkers"){name="286|"+n;if(this.deltaProps[name]){this.deltaProps[name]["isSplitItems"]=true;}}};GFTM.prototype.initializeModel=function GFTM_initializeModel(){this.resetChanges();var tabId=this.get("tabId"),parent=this.get("parent");this.initField("mainCat");this.resetSubCatItems();this.curTargetId=this.get("subCat").getSelectedItemValue();this.initFields(this.sFields);this.set("enabled",true);this.setFiledsEnable();};GFTM.prototype.on_minorType_changed=function GFTM_onMinorTypeChanged(evt){if(!this.get("parent").initializing){this.initField("mainCat");this.resetSubCatItems();}};GFTM.prototype.on_roundedEffect_changed=function GFTM_on_roundedEffect_changed(evt){this.initFields(["fillColor","bevelType","areaAlpha"]);};GFTM.prototype.on_mainCat_changed=function GFTM_onMainCatChanged(evt){if(!this.get("mainCat").getSelectedItem()){return ;}this.updateTarget(evt);this.resetSubCatItems();};GFTM.prototype.setFiledsEnable=function GFTM_setFiledsEnable(){if(!this.get("mainCat")||!this.get("subCat")){return ;}if(!this.get("mainCat").getSelectedItemValue()){this.get("mainCat").execSingleSelect(0);this.get("subCat").execSingleSelect(0);}if(!this.get("subCat").getSelectedItem()){this.get("subCat").execSingleSelect(0);}var mainId=this.get("mainCat").getSelectedItemValue();var subGsid=this.get("subCat").getSelectedItem().gsid;var isSeriesArea=this.getTarget().commands.queryState("seriesAreaFormatField_visible",subGsid);var increDecreColorVisible=this.getTarget().commands.queryVisible("increDecreColorField");this.set("textFormatField_visible",(mainId!=4&&mainId!=8));this.set("seriesLineFormatField_visible",(mainId==4&&!increDecreColorVisible));this.set("seriesAreaFormatField_visible",(mainId==4&&isSeriesArea));this.set("AFTransparencyField_visible",(mainId==4&&!increDecreColorVisible));this.set("markerFormatField_visible",(mainId==8));this.set("markerShowFormatField_visible",(mainId==8)&&this.getTarget().commands.queryVisible("markerShow"));this.set("oldFillField_visible",(mainId==1||mainId==2||mainId==3));this.set("oldLineField_visible",(mainId==1||mainId==2||mainId==3));if(!(mainId==4&&subGsid<2)){this.set("seriesLineThickness_visible",true);}else{this.set("seriesLineThickness_visible",this.getTarget().commands.queryVisible("seriesLineThickness"));}this.set("increDecreColorField_visible",increDecreColorVisible);};GFTM.prototype.on_subCat_changed=function GFTM_onSubCatChanged(evt){var curTarget=this.get("subCat").getSelectedItem();if(!curTarget){return ;}this.updateTarget(evt);this.getTarget().commands.exec("isIncreDecreItem",curTarget.increDecreItem);this.curTargetId=this.get("subCat").getSelectedItemValue();this.initFields(this.sFields);this.set("titleContent_visible",this.queryVisible("titleContent"));this.setTooltipsInfoIconVisible();this.setFiledsEnable();};GFTM.prototype.setTooltipsInfoIconVisible=function GFTM_setTooltipsInfoIconVisible(){if(!bIsIE4){this.set("tooltipsEditor_visible_ff",this.queryVisible("tooltipsEditor"));}else{this.set("tooltipsEditor_visible_ie",this.queryVisible("tooltipsEditor_ie"));this.set("tooltipsEditor_visible_ie_ScatterBubble",this.queryVisible("tooltipsEditor_ie_ScatterBubble"));}};GFTM.prototype.on_tooltipsShow_changed=function GFTM_onTooltipsShowChanged(evt){if(this.get("parent").initializing){return ;}this.set("tooltipsEditor_visible",this.queryVisible("tooltipsEditor"));this.setTooltipsInfoIconVisible();};GFTM.prototype.on_show_changed=function GFTM_onShowChanged(evt){if(this.get("parent").initializing){return ;}for(var i=0;i<this.sFields.length;i++){this.set(this.sFields[i]+"_enabled",this.queryEnabled(this.sFields[i]));}this.set("titleContent_visible",this.queryVisible("titleContent"));};GFTM.prototype.on_lineAlpha_changed=function GFTM_onAreaAlphaChanged(evt){this.updateAlphaText("lineAlpha","seriesLineAlphaText");};GFTM.prototype.on_seriesLineAlphaText_changed=function GFTM_onSLATChanged(evt){this.updateAlpha("lineAlpha","seriesLineAlphaText");};GFTM.prototype.on_areaAlpha_changed=function GFTM_onMarkerAlphaChanged(evt){this.updateAlphaText("areaAlpha","markerAlphaText");};GFTM.prototype.on_markerAlphaText_changed=function GFTM_onMATChanged(evt){this.updateAlpha("areaAlpha","markerAlphaText");};GFTM.prototype.on_markerBorderAlpha_changed=function GFTM_onMarkerBorderAlphaChanged(evt){this.updateAlphaText("markerBorderAlpha","markerBorderAlphaText");};GFTM.prototype.on_markerBorderAlphaText_changed=function GFTM_onMBATChanged(evt){this.updateAlpha("markerBorderAlpha","markerBorderAlphaText");};GFTM.prototype.updateAlphaText=function GFTM_transAlphaChangeToText(alphaName,textName){var alphaValue=this.get(alphaName);var alphaTextValue=this.get(textName);if(alphaValue!=null){var alphaTextValueNew=((1-alphaValue/255)*100).toFixed(0);if(alphaTextValue!=alphaTextValueNew){this.set(textName,alphaTextValueNew);}}};GFTM.prototype.updateAlpha=function GFTM_transTextChangeToAlpha(alphaName,textName){var alphaValue=this.get(alphaName);var alphaTextValue=this.get(textName);if(alphaTextValue){var alphaValueNew=(1-parseInt(alphaTextValue)/100)*255;if(alphaValue!=alphaValueNew){this.set(alphaName,alphaValueNew);}}};GFTM.prototype.resetSubCatItems=function GFTM_resetSubCatItems(){this.initField("subCat");var sc=this.get("subCat").getSelectedItemValue();if(sc==null){this.get("subCat").execSingleSelect(0);sc=this.get("subCat").getSelectedItemValue();}this.getTarget().commands.exec("subCat",sc);this.curTargetId=sc;};GFTM.prototype.getStoreFields=function GFTM_getStoreFields(){var fields=mstr.models.TabModel.prototype.getStoreFields.apply(this,[]);fields.unshift("show");return fields;};GFTM.prototype.getCurrentCategory=function GFTM_getCurrentCategory(){return this.curTargetId;};GFTM.prototype.getTargetName=function GFTM_getTargetName(){return"subCat";};GFTM.prototype.queryEnabled=function GFTM_queryEnabled(field){switch(field){case"fontName":case"fontSize":case"textBoldItalic":case"textBold":case"textItalic":case"textUnderline":case"textStrikeout":case"fontColor":case"fillColor":case"lineColor":case"bevelType":case"areaAlpha":case"titlePosition":case"titleContent":var showVis=this.get("parent").queryVisible("show",this.get("tabId"));if(showVis){return this.get("show")&&this.get("parent").queryEnabled(field,this.get("tabId"));}else{return this.get("parent").queryEnabled(field,this.get("tabId"));}default:return this.get("parent").queryEnabled(field,this.get("tabId"));}};GFTM.prototype.queryVisible=function GFTM_queryVisible(field){switch(field){case"tooltipsShow":return this.get("parent").queryVisible(field,this.get("tabId"));case"tooltipsEditor":case"tooltipsEditor_ie":case"tooltipsEditor_ie_ScatterBubble":return this.get("tooltipsShow")&&this.get("parent").queryVisible(field,this.get("tabId"));case"titleContent":return this.get("show")&&this.get("parent").queryVisible(field,this.get("tabId"));default:return this.get("parent").queryVisible(field,this.get("tabId"));}};function GFTM(props){mstr.models.DynamicTabModel.apply(this,[props]);}return GFTM;})();mstr.models.GraphAxesTabModel=(function(){mstr.$O.extendsClass(GATM,mstr.models.TabModel);GATM.prototype.on_dualAxisAuto_changed=function GATM_onDualAxisAutoChanged(evt){var field=evt.memo.name;var enabled=this.queryEnabled(field);this.set(field+"_enabled",enabled);if(!enabled){this.initField("dualOptionItems");this.resetSingleDelta("dualOptionItems");}};GATM.prototype.on_minorType_changed=function GATM_onMinorTypeChanged(evt){if(!this.get("parent").initializing){this.initFields(this.sFields);}};GATM.prototype.on_maxScaleCKX_changed=function GATM_onMaxScaleCKXChanged(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_minScaleCKX_changed=function GATM_onMinScaleCKXChanged(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_gridIntervalCKX_changed=function GATM_onGridIntervalCKXChanged(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_maxScaleCKY1_changed=function GATM_onMaxScaleCKY1Changed(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_minScaleCKY1_changed=function GATM_onMinScaleCKY1Changed(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_gridIntervalCKY1_changed=function GATM_onGridIntervalCKY1Changed(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_maxScaleCKY2_changed=function GATM_onMaxScaleCKY2Changed(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_minScaleCKY2_changed=function GATM_onMinScaleCKY2Changed(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_gridIntervalCKY2_changed=function GATM_onGridIntervalCKY2Changed(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_maxScaleCKZ_changed=function GATM_onMaxScaleCKZChanged(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_minScaleCKZ_changed=function GATM_onMinScaleCKZChanged(evt){this.onCheckBoxChanged(evt);};GATM.prototype.on_gridIntervalCKZ_changed=function GATM_onGridIntervalCKZChanged(evt){this.onCheckBoxChanged(evt);};GATM.prototype.onCheckBoxChanged=function GATM_onCheckBoxChanged(evt){if(this.get("parent").initializing){return ;}var fd=evt.memo.name;var as=fd.substr(fd.length-2);if(as.charAt(0)!="Y"){as=as.substr(1);}var fs=fd.substr(0,fd.length-as.length-2);if(!this.get(fd)){this.set(fs+as,null);this.resetSingleDelta(fs+as);}};GATM.prototype.on_maxScaleX_changed=function GATM_onMaxScaleXChanged(evt){this.onInputTextChanged(evt);};GATM.prototype.on_minScaleX_changed=function GATM_onMinScaleXChanged(evt){this.onInputTextChanged(evt);};GATM.prototype.on_gridIntervalX_changed=function GATM_onGridIntervalXChanged(evt){this.onInputTextChanged(evt);};GATM.prototype.on_maxScaleY1_changed=function GATM_onMaxScaleY1Changed(evt){this.onInputTextChanged(evt);};GATM.prototype.on_minScaleY1_changed=function GATM_onMinScaleY1Changed(evt){this.onInputTextChanged(evt);};GATM.prototype.on_gridIntervalY1_changed=function GATM_onGridIntervalY1Changed(evt){this.onInputTextChanged(evt);};GATM.prototype.on_maxScaleY2_changed=function GATM_onMaxScaleY2Changed(evt){this.onInputTextChanged(evt);};GATM.prototype.on_minScaleY2_changed=function GATM_onMinScaleY2Changed(evt){this.onInputTextChanged(evt);};GATM.prototype.on_gridIntervalY2_changed=function GATM_onGridIntervalY2Changed(evt){this.onInputTextChanged(evt);};GATM.prototype.on_maxScaleZ_changed=function GATM_onMaxScaleZChanged(evt){this.onInputTextChanged(evt);};GATM.prototype.on_minScaleZ_changed=function GATM_onMinScaleZChanged(evt){this.onInputTextChanged(evt);};GATM.prototype.on_gridIntervalZ_changed=function GATM_onGridIntervalZChanged(evt){this.onInputTextChanged(evt);};GATM.prototype.onInputTextChanged=function GATM_onInputTextChanged(evt){if(this.get("parent").initializing){return ;}var fd=evt.memo.name;var as=fd.substr(fd.length-2);if(as.charAt(0)!="Y"){as=as.substr(1);}var fs=fd.substr(0,fd.length-as.length);if(this.get(fd)){this.set(fs+"CK"+as,true);}};function GATM(props){mstr.models.TabModel.apply(this,[props]);}return GATM;})();mstr.models.GraphNumberTabModel=(function(){mstr.$O.extendsClass(GNTM,mstr.models.DynamicTabModel);GNTM.prototype.initializeModel=function GNTM_initializeModel(){this.resetChanges();this.adjustDateField();this.resetSereiesLabels();this.initFields(this.sFields);this.set("enabled",true);};GNTM.prototype.on_minorType_changed=function GNTM_onMinorTypeChanged(evt){if(!this.get("parent").initializing){this.resetSereiesLabels();}};GNTM.prototype.on_seriesLabels_changed=function GNTM_onSeriesLabelsChanged(evt){if(!this.get("seriesLabels").getSelectedItem()){return ;}this.updateTarget(evt);this.curTargetId=this.get("seriesLabels").getSelectedItemValue();if(!this.sFields){return ;}for(var i=0;i<this.sFields.length;i++){this.initField(this.sFields[i]);}};GNTM.prototype.on_gfnCat_changed=function GNTM_onCatChanged(evt){if(!this.get("parent").initializing){var cat=this.get("gfnCat").getSelectedItemValue();if(cat=="2"||cat=="3"){var n={2:"gfnDate",3:"gfnTime"}[cat];if(!this.getDeltaChange(n)){var m=this.get(n);m.execClearSelect();m.execSingleSelect(0);}}this.rebuildNegativeNumberField(this.buildDecimalString(true));}};GNTM.prototype.on_gfnDecimalPlaces_changed=function GNTM_onDecimalPlacesChanged(evt){this.rebuildNegativeNumberField(this.buildDecimalString(true));};GNTM.prototype.on_gfnThousandSeparator_changed=function GNTM_onThousandSeparatorChanged(evt){this.rebuildNegativeNumberField(this.buildDecimalString(true));};GNTM.prototype.on_gfnCurrencySymbol_changed=function GNTM_onCurrencySymbolChanged(evt){this.rebuildNegativeNumberField(this.buildDecimalString(true));};GNTM.prototype.on_gfnCurrencyPosition_changed=function GNTM_onCurrencyPositionChanged(evt){this.rebuildNegativeNumberField(this.buildDecimalString(true));};GNTM.prototype.on_show_changed=function GNTM_onShowChanged(evt){this.set("gfnCat_enabled",this.queryEnabled("gfnCat"));};GNTM.prototype.resetSereiesLabels=function GNTM_resetSereiesLabels(){this.initField("seriesLabels");this.getTarget().commands.exec("seriesLabels",this.get("seriesLabels").getSelectedItemValue());this.curTargetId=this.get("seriesLabels").getSelectedItemValue();};GNTM.prototype.getCurrentCategory=function GNTM_getCurrentCategory(){return this.curTargetId;};GNTM.prototype.getTargetName=function GNTM_getTargetName(){return"seriesLabels";};GNTM.prototype.rebuildNegativeNumberField=function GNTM_rebuildNegativeNumberField(decimalStr){var n=this.get("gfnNegativeNumbers");var items=mstr.utils.Hash.deepClone(n.getItems());var value=n.getSelectedItem()&&n.getSelectedItem()["dssid"];var red=this.get("Red");var tSep=mstr.Settings.Locale.THOUSANDSEP;if(this.get("gfnCat").getSelectedItem()){var cat=parseInt(this.get("gfnCat").getSelectedItem()["dssid"]);switch(cat){case 0:tSep=(this.get("gfnThousandSeparator"))?tSep:"";items[0]["n"]="-1"+tSep+"234"+decimalStr;items[1]["n"]="1"+tSep+"234"+decimalStr+" ["+red+"]";items[2]["n"]="(1"+tSep+"234"+decimalStr+")";items[3]["n"]="(1"+tSep+"234"+decimalStr+") ["+red+"]";break;case 1:var prefix="";var suffix="";var symbol=this.get("gfnCurrencySymbol");switch(this.get("gfnCurrencyPosition").getSelectedIndex()){case 2:prefix+=" ";case 0:prefix=symbol+prefix;break;case 3:suffix+=" ";case 1:suffix+=symbol;break;}items[0]["n"]=prefix+"-1"+tSep+"234"+decimalStr+suffix;items[1]["n"]=prefix+"1"+tSep+"234"+decimalStr+suffix+" ["+red+"]";items[2]["n"]="("+prefix+"1"+tSep+"234"+decimalStr+suffix+")";items[3]["n"]="("+prefix+"1"+tSep+"234"+decimalStr+suffix+") ["+red+"]";break;case 4:items[0]["n"]="-123"+decimalStr+"%";items[1]["n"]="123"+decimalStr+"% ["+red+"]";items[2]["n"]="(123"+decimalStr+"%)";items[3]["n"]="(123"+decimalStr+"%) ["+red+"]";break;}n.setItems(items);if(value){n.execSelectValue(value);}}};GNTM.prototype.buildDecimalString=function GNTM__buildDecimalString(useLocale){var decimal="";var cnt=parseInt(this.get("gfnDecimalPlaces"));for(var i=0;i<cnt;i++){decimal+="0";}var decimalSep=".";if(useLocale){decimalSep=mstr.$obj("mstrPageInfo").get("userInfo").get("decimalSeparator");}return(decimal.length>0)?decimalSep+decimal:"";};GNTM.prototype.adjustDateField=function GNTM_adjustDateField(){var n=this.get("gfnDate");var items=n.getItems();var vf=n.props.valueForm;var value=n.getSelectedItem()&&n.getSelectedItem()[vf];var index=n.indexOfValue("MMM 'yy");if(index!=-1){var item=items[index];n.removeItems([item],index);item.n="Apr 98";item[vf]="MMM yy";n.insertItemsAt([item],index);}};function GNTM(props){mstr.models.DynamicTabModel.apply(this,[props]);}return GNTM;})();mstr.models.GraphOptionsTabModel=(function(){mstr.$O.extendsClass(GOTM,mstr.models.TabModel);GOTM.prototype.on_gaugeStyle_changed=function GOTM_onGaugeStyleChanged(evt){if(!this.get("parent").initializing){this.initField("gaugeRangeThick");}};GOTM.prototype.queryEnabled=function GOTM_queryEnabled(field){switch(field){case"gaugeRangeThick":return(this.get("gaugeStyle").getSelectedIndex()==0)||this.getTarget().commands.queryState("gaugeQBShow");default:return this.get("parent").queryEnabled(field,this.get("tabId"));}};function GOTM(props){mstr.models.TabModel.apply(this,[props]);}return GOTM;})();mstr.models.ListCartWithSwap=(function(){mstr.$O.extendsClass(LCS,mstr.models.ListCart);LCS.prototype.execAdd=function LCS_execAdd(){var avfModel=this.props.availableFiltered;if(!avfModel){return ;}var avfIndices=avfModel.getSelectedIndices();var avfCount=mstr.$H.len(avfIndices);if(!avfCount){return ;}var swap=(avfModel.getItems().length==avfCount);if(swap){return this._swapSelectedOrLastItem();}mstr.models.ListCart.prototype.execAdd.apply(this,[]);};LCS.prototype.execRemove=function LCS_execRemove(){var selModel=this.props.selected;if(!selModel){return ;}var selIndices=selModel.getSelectedIndices();var selCount=mstr.$H.len(selIndices);if(!selCount){return ;}var swap=(selModel.getItems().length==selCount);if(swap){return this._swapSelectedOrLastItem();}mstr.models.ListCart.prototype.execRemove.apply(this,[]);};LCS.prototype._swapSelectedOrLastItem=function LCS_swapSelectedOrLastItem(){var selModel=this.props.selected;var avfModel=this.props.availableFiltered;var f=function(lm){var selItems=lm.getSelectedItems();if(selItems.length==0){var items=lm.getItems();return[items[items.length-1]];}else{return selItems;}};var m=function(s,t,i){s.removeItems(i);t.insertItemsAt(i);t.setSelectedItems(i);};var selItem=f(selModel);var avfItem=f(avfModel);m(selModel,avfModel,selItem);m(avfModel,selModel,avfItem);return true;};function LCS(props){mstr.models.ListCart.apply(this,[props]);}return LCS;})();
var useXHR=true;var javaScriptPath="";var mstrLogImplScript=false;var mstrToolbarImplScript=false;var mstrRwToolbarImplScript=false;var mstrGraphToolbarImplScript=false;var mstrPageSetupTabImplScript=false;var mstrTreeImplScript=false;var mstrAllObjectBrowserTreeImplScript=false;var mstrRWObjSelectionsImplScript=false;var mstrReportObjSelectionsImplScript=false;var mstrObjectBrowserImplScript=false;var mstrRWObjectsImplScript=false;var mstrReportObjectsImplScript=false;var mstrReportWSObjectsImplScript=false;var mstrFormulaBarImplScript=false;var mstrResizeEditorImplScript=false;var mstrFormatImplScript=false;var mstrAccordionTabManagerImplScript=false;var mstrDocPropTabManagerImplScript=false;var mstrPageLayoutTabImplScript=false;var mstrPageMarginsTabImplScript=false;var mstrGeneralPropTabImplScript=false;var mstrGridPropTabImplScript=false;var mstrPicturePropTabImplScript=false;var mstrWatermarkPropTabImplScript=false;var mstrLayoutPropTabImplScript=false;var mstrLinePropTabImplScript=false;var GradientUtilScript=false;var mstrTabImplScript=false;var mstrNumberTabImplScript=false;var mstrNumberFormatTabImplScript=false;var mstrColorTabImplScript=false;var mstrAlignTabImplScript=false;var mstrFontTabImplScript=false;var mstrEffectsTabImplScript=false;var mstrGraphAxesTabImplScript=false;var mstrGraphTitlesTabImplScript=false;var mstrGraphGeneralTabImplScript=false;var mstrGraphAdvancedTabImplScript=false;var mstrNotesTabImplScript=false;var mstrGraphOptionTabImplScript=false;var mstrEditorImplScript=false;var mstrContactsEditorImplScript=false;var mstrSortEditorImplScript=false;var mstrGroupbyPropsImplScript=false;var mstrTreeAttributeFormsQualificaionImplScript=false;var mstrMetricQualLevelEditorImplScript=false;var mstrMsgBoxImplScript=false;var AttFormsScript=false;var cartScript=false;var mstrCartImplScript=false;var ncScript=false;var mstrSubscriptionsFolderImplScript=false;var objectBrowserScript=false;var CalendarScript=false;var incrementalFetchScript=false;var advancedDrillScript=false;var adminOptionsScript=false;var columnWidthsGGScript=false;var colHandlesSetScript=false;var outlineModeGGScript=false;var lockSetScript=false;var formatEditorScript=false;var Filter2Script=false;var promptFunctionsScript=false;var menuScript=false;var contextMenuManagerScript=false;var contextMenuScript=false;var incrementalFetchCheckBoxesScript=false;var mstrColResizeImplScript=false;var mstrColorPickerEditorImplScript=false;var mstrColorGradientEditorImplScript=false;var mstrRWColorGradientEditorImplScript=false;var mstrPageByReportImplScript=false;var mstrPageByMapperImplScript=false;var mstrPageByImplScript=false;var mstrFilterEditorImplScript=false;var mstrOutlineModeImplScript=false;var mstrExportOptionsImplScript=false;var mstrAdvancedPropTabImplScript=false;var mstrDeliveryTabImplScript=false;var mstrOtherPropTabImplScript=false;var mstrDocPropsExportTabImplScript=false;var mstrTocPropTabImplScript=false;var mstrObjSelectionsImplScript=false;var mstrAttFormsImplScript=false;var ObjectManipulationScript=false;var mstrProjectBrowserImplScript=false;var mstrReportAllObjectsImplScript=false;var mstrDataExplorerImplScript=false;var mstrProjectBrowserSelectionsImplScript=false;var mstrElementPickerImplScript=false;var mstrFilterObjectsImplScript=false;var mstrUserEntityEditorImplScript=false;var mstrAdminGenericTabImplScript=false;var mstrTreeControlScript=false;var mstrTreeViewImplScript=false;var mstrOutlineViewImplScript=false;var mstrFolderActionsScript=false;var mstrFolderTreeViewImplScript=false;var mstrFolderFrameTreeViewImplScript=false;var mstrTreeCartImplScript=false;var mstrUserEntitiesTreeCartImplScript=false;var mstrEntitySelectorImplScript=false;var mstrSingleObjectSelectorImplScript=false;var mstrObjSelProjectBrowserImplScript=false;var mstrPromptDefTabImplScript=false;var mstrPromptQuestionsTabImplScript=false;var mstrPromptDisplayTabImplScript=false;var mstrPromptAdvancedTabImplScript=false;var mstrPromptQualificationTabImplScript=false;var mstrPromptDefImplScript=false;var mstrTabStripImplScript=false;var mstrTabStripMapperImplScript=false;var mstrLayoutTabImplScript=false;var mstrSectionsTabImplScript=false;var mstrPortalImplScript=false;var mstrPromptDefTabManImplScript=false;var mstrUnselectableObjectExplorerImplScript=false;var mstrSaveAsEditorImplScript=false;var mstrSaveAsReportImplScript=false;var mstrSaveAsObjectImplScript=false;var mstrCreateFolderImplScript=false;var mstrAdvancedOptionsImplScript=false;var mstrHyperLinkEditorImplScript=false;var mstrHyperLinkObjectExplorerImplScript=false;var mstrAlertsObjectExplorerImplScript=false;var mstrFilterDetailsFormattingEditorImplScript=false;var mstrSubtotalSimpleTabScript=false;var mstrSubtotalAdvancedTabScript=false;var mstrSubtotalDisplayTabScript=false;var mstrSubtotalsObjImplScript=false;var mstrAdminBrowserImplScript=false;var mstrSecurityFilterFrameImplScript=false;var mstrFunctionWizardEditorImplScript=false;var mstrSecurityRoleEditorImplScript=false;var mstrThresholdFormatEditorImplScript=false;var mstrSortRowTabImplScript=false;var mstrSortColTabImplScript=false;var mstrObjectListImplScript=false;var mstrUserEntitiesImplScript=false;var mstrContactsBrowserImplScript=false;var mstrUserAddressListImplScript=false;var mstrReportFrameImplScript=false;var mstrDerivedElementsBrowserImplScript=false;var mstrDerivedElementsEditorImplScript=false;var mstrDerivedElmtToolbarImplScript=false;var mstrDECalculationImplScript=false;var mstrPathImplScript=false;var mstrPickerImplScript=false;var mstrEditorToolbarScript=false;var mstrDMToolbarImplScript=false;var mstrThresholdEditorScript=false;var mstrThresholdSliderImplScript=false;var mstrSimpleThresholdEditorImplScript=false;var mstrAdvancedThresholdEditorScript=false;var mstrAlertsEditorScript=false;var mstrThresholdExpressionEditorScript=false;var mstrDivBasedCartImplScript=false;var mstrFolderImplScript=false;var mstrInlineRenameImplScript=false;var mstrGraphDropZonesEditorScript=false;var mstrInboxImplScript=false;var mstrDerivedElementFormatEditorImplScript=false;var mstrDerivedElementToolbarScript=false;var mstrFormatHelper=false;var importDerivedElementsEditorImplScript=false;var mstrRelatedReportsImplScript=false;var mstrTreeTabManagerImplScript=false;var mstrTabManagerTreeViewImplScript=false;var mstrFormatTreeTabManagerImplScript=false;var mstrObjectExplorerImplScript=false;var mstrReportXdaObjectsImplScript=false;var mstrXDAObjectExplorerImplScript=false;var mstrXDAEditorImplScript=false;var mstrVisualizationsEditorImplScript=false;var mstrRWControlImplScript=false;var mstrHTMLContainerImplScript=false;var mstrReportGraphImplScript=false;var mstrReportGraphCMImplScript=false;var mstrDatasetExplorerEditorImplScript=false;var mstrPanelStackScript=false;var mstrTableControlScript=false;var mstrRWActionControlImplScript=false;var mstrScrollerImplScript=false;var mstrMetricScrollerImplScript=false;var mstrSelectorPropTabImplScript=false;var mstrFlashPropTabImplScript=false;var mstrRoundedRectangleScript=false;var mstrRWUnitBoneImplScript=false;var mstrFlashViewerImplScript=false;var mstrFlashDashboardImplScript=false;var mstrSecondaryDataSourcesImplScript=false;var mstrWebHyperLinkEditorImplScript=false;var mstrOtherGridPropTabImplScript=false;var mstrAlertsExpressionEditorScript=false;var mstrFilterToolbarScript=false;var mstrGridStaticScript=false;var mstrGridReportScript=false;var mstrGridRWScript=false;var mstrIPhoneGridVisPropsEditorImplScript=false;var mstrIPhoneMarkerMashupVisPropsEditorImplScript=false;var mstrESRIVisPropsEditorImplScript=false;var mstrUsherConfigScript=false;var bFirstMetric=false;var sURL="";var bDesignMode=false;var lIndex=0;var sMsgID="";var sView="";var bAdvancedEdit=false;var flg_RTitle=1;var flg_QLinks=2;var flg_FTBar=4;var flg_Filt=8;var flg_PAxis=16;var flg_RTBar=32;var flg_SRTEditor=64;var flg_DRLEditor=128;var flg_FSELEditor=256;var flg_FRMEditor=512;var flg_FMATEditor=1024;var flg_SUBEditor=2058;var flg_Email=4096;var flg_Send=8192;var flg_ObjBr=16384;var flg_Grid=32768;var flg_IncFetch=65536;var SCROLLBAR_SIZE=17;var aEditorButton=new Array();aEditorButton[1]="";aEditorButton[2]=0;var aTemplateElements=new Array();var lPropertyAlias=0;var lPropertyKey=0;var lPropertyType=0;var lPropertyDerivedMetricType=3;var lPropertyDerivedMetric=0;var lPropertyIsDefinedOnDataset=0;var lPropertyFormula=0;var lPropertyPosition=0;var sNewMetric="";var DssXmlTemplateMetrics="";var logClientStopTimer=false;var logClient=false;var sTreeName="tree1";var lPropertyDynamicAlias=0;var recentObjectsAnchor;var currentPin="-1";var initializeCalls="";var bIsIE4=(document.all)?true:false,bIsIE6=false,bIsIE7=false,bIsIE8=false,bIsIE9=false,bIsIE10=false,ISIE7=false,bIsIEQuirks=false,bIsDXIE=false;var ua=navigator.userAgent;if(bIsIE4){var ie=parseFloat(ua.substring(ua.indexOf("MSIE")+4,ua.indexOf("MSIE")+8)),dm=document.documentMode;bIsIE6=(ie>=6)?true:false;if(window.isEdgeModeEnabled){bIsIE7=(((ua.indexOf("Trident")===-1)&&(ie===7))||dm>=7);ISIE7=(bIsIE7&&dm===7);bIsIE7C=(ua.indexOf("Trident")>-1&&dm===7);bIsIE8=(dm===8);bIsIE9=(dm===9);bIsIE10=(dm===10);bIsDXIE=(dm<=9);}else{bIsIE7=(ie>=7)?true:false;ISIE7=(ie==7)?true:false;bIsIE8=(ie>=8&&document.documentMode==8);bIsIE9=(ie>=9&&document.documentMode==9);bIsIE10=(ie>=10&&document.documentMode==10);bIsDXIE=!bIsIE10;}bIsIEQuirks=(dm===5||document.compatMode==="BackCompat");}var bIsW3CIE=function(){var rv=-1,re=new RegExp("rv:([0-9]{1,}[.0-9]{0,})"),ua=navigator.userAgent;if(ua.indexOf("Trident")>=0&&re.exec(ua)!=null){rv=parseFloat(RegExp.$1);}return rv>=11;}();var bIsW3C=(document.getElementById&&(!bIsIE4||bIsIE8||bIsIE9||bIsIE10||bIsW3CIE));var bIsFirefox=(bIsW3C&&ua.indexOf("Firefox")>-1);var bIsWK=(ua.indexOf("AppleWebKit")>-1);var bIsChrome=bIsWK&&(ua.indexOf("Chrome")>-1);var bIsSafari=bIsWK&&(ua.indexOf("Safari")>-1)&&!bIsChrome;var isMac=ua.indexOf("Macintosh")>-1;var lMouseX=0;var lMouseY=0;var bIsDHTML=(bIsIE4||bIsW3C)?true:false;var bIsInPortal=window.top!=window;var ENABLE="MSTRCSSANALYSER_Enable";if(typeof HTMLElement!="undefined"&&!HTMLElement.prototype.insertAdjacentElement){HTMLElement.prototype.insertAdjacentElement=function(where,parsedNode){switch(where){case"beforeBegin":this.parentNode.insertBefore(parsedNode,this);break;case"afterBegin":this.insertBefore(parsedNode,this.firstChild);break;case"beforeEnd":this.appendChild(parsedNode);break;case"afterEnd":if(this.nextSibling){this.parentNode.insertBefore(parsedNode,this.nextSibling);}else{this.parentNode.appendChild(parsedNode);}break;}};HTMLElement.prototype.insertAdjacentHTML=function(where,htmlStr){var r=this.ownerDocument.createRange();r.setStartBefore(this);var parsedHTML=r.createContextualFragment(htmlStr);this.insertAdjacentElement(where,parsedHTML);};HTMLElement.prototype.insertAdjacentText=function(where,txtStr){var parsedText=document.createTextNode(txtStr);this.insertAdjacentElement(where,parsedText);};}String.prototype.contains=function(element,delimiter){try{if(!element){return false;}if(!delimiter){return(this.indexOf(element)>-1);}var testString=delimiter+this+delimiter;return(testString.indexOf(delimiter+element+delimiter)>-1);}catch(err){alert(err);return false;}};function keyDownHandler(e){if(typeof (microstrategy)=="undefined"||microstrategy.eventManager==null||(iframe&&iframe.onWaitState!=false)){return true;}if(!e){e=window.event;}var src=getEventTarget(e);try{if(src){if(mstrmojo&&mstrmojo.dom&&mstrmojo.dom.contains(document.getElementById("DIContainer"),src,false)){return true;}if(src.tagName){var name=src.tagName.toLowerCase();if(name=="input"||name=="select"||name=="textarea"){return true;}}if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){switch(e.keyCode){case 89:if(e.ctrlKey){microstrategy.eventManager.notifyOrphanBones("processRedo");return false;}break;case 90:if(e.ctrlKey){microstrategy.eventManager.notifyOrphanBones("processUndo");return false;}break;case 123:if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){toggleScreenMode();return false;}break;default:return true;break;}}else{var bone=microstrategy.bone("rwb_viewer");if(bone!=null&&bone.doc!=null&&currentModalEditor.length==0&&!bone.isDragging&&!bone.mojoEditor){return bone.doc.onkeydown(e);}}}return true;}catch(err){}}function keyPressHandler(e){switch((e||window.event).keyCode){case 27:if(iframe&&iframe.onWaitState){iframe.hideWaitPage();}return true;}if(typeof (microstrategy)=="undefined"||microstrategy.eventManager==null||(iframe&&iframe.onWaitState!=false)){return true;}var src=getEventTarget(e);if(src){if(src.tagName){var name=src.tagName.toLowerCase();if(name=="input"||name=="select"||name=="textarea"){return true;}}if(microstrategy.EXECUTION_SCOPE!=microstrategy.REPORT_EXECUTION){var bone=microstrategy.bone("rwb_viewer");if(bone!=null&&bone.doc!=null&&currentModalEditor.length==0){return bone.doc.onkeypress(e);}}}return true;}function rightClick(e){var clickedElement=getEventTarget(e);if(bIsSafari){tagName=clickedElement.tagName;var s=window.getSelection&&window.getSelection();if(!(tagName=="INPUT"||tagName=="TEXTAREA")&&s&&s.removeAllRanges){s.removeAllRanges();}}var oTarget=clickedElement;oTarget=findTarget(oTarget,"CX");if(oTarget){oTarget.clickedElement=clickedElement;return displayContextMenu(oTarget,e);}return true;}function checkForFormSubmit(obj,targetButton){var e=window.event;if(e!=null&&e.keyCode==13){var objTargetButton=targetButton;if(typeof (objTargetButton)=="string"){objTargetButton=document.getElementById(targetButton);}if(objTargetButton!=null&&objTargetButton.focus){objTargetButton.focus();}}}function Init(){document.oncontextmenu=rightClick;document.onkeydown=keyDownHandler;document.onkeypress=keyPressHandler;if(logClientStopTimer){stopTimer(logClientName);}if(logClient){logClientTimes(currentUrlObjectID,currentFullURL);}var recentObjectsCount=microstrategy.getRecentObjectsCount();var recentsObjectsMenuItem=document.getElementById("mstrRecentObjects");if(recentsObjectsMenuItem){}var recentsPopup=document.createElement("div");recentsPopup.setAttribute("id","mstrRecentsPopup");recentsPopup.style.zIndex="101";document.body.appendChild(recentsPopup);var recentsPopup=document.getElementById("mstrRecentsPopup");if(recentsPopup){recentsPopup.onmousedown=function(e){if(window.event){window.event.cancelBubble=true;}else{e.cancelBubble=true;}};recentsPopup.onclick=function(e){toggleRecentsPopup(true,recentsPopup);};}var createRecentsImg=document.getElementById("mscld-recents-menu");if(createRecentsImg){createRecentsImg.onclick=function(){microstrategy.openRecentObjects(recentsObjectsMenuItem);};}}function onDocumentClick(e){}function consolidateStyleSheets(elem,cssTextArr,styleId){var inlineStyles=elem.getElementsByTagName("STYLE"),res=[],consolidatedStyle,realId=styleId,count=0,allStyles=[],getConsolidatedStyle=function(styleId){var consolidatedStyle=document.getElementById(styleId+"IFrame");if(!consolidatedStyle){consolidatedStyle=document.getElementById(styleId);}if(consolidatedStyle){return consolidatedStyle;}},findCompOnCss=function(componentId,css){var marker="."+componentId+" {";if(componentId&&componentId.length>0){return css.indexOf(marker)>-1;}};if(inlineStyles.length===0){return cssTextArr;}consolidatedStyle=getConsolidatedStyle(realId);while(consolidatedStyle){allStyles.push([realId,consolidatedStyle]);realId=styleId+"_"+(++count);consolidatedStyle=getConsolidatedStyle(realId);}for(var inlineIdx=0;inlineIdx<inlineStyles.length;inlineIdx++){for(var styleCount=0;styleCount<allStyles.length;styleCount++){var cssText,title,compId;cssText=cssTextArr[styleCount]||"";if(cssText.length===0){consolidatedStyle=allStyles[styleCount][1];cssText=consolidatedStyle.innerHTML;}title=inlineStyles[inlineIdx].getAttribute("title");compId=inlineStyles[inlineIdx].getAttribute("componentid");if(findCompOnCss(compId,cssText)||styleCount===allStyles.length-1){if((!title||title.length===0)&&(compId&&compId.length>0)){cssText=replaceStyle(inlineStyles[inlineIdx],cssText,styleId!=="docObjectStyle");}res.push(cssText);break;}else{res.push(cssText);}}}return res;}function updateStyleContainer(cssTextArr,styleId){if(cssTextArr.length==0){return ;}stylesContainer=document.getElementById(styleId+"Container");if(stylesContainer!=null){var styleObjs=stylesContainer.getElementsByTagName("STYLE");if(styleObjs==null||styleObjs.length==0){var consolidatedStyle=document.getElementById(styleId);if(consolidatedStyle){consolidatedStyle.parentNode.removeChild(consolidatedStyle);}}}else{stylesContainer=document.createElement("div");stylesContainer.setAttribute("id",styleId+"Container");document.body.appendChild(stylesContainer);}var consolidatedStyleIFrame=document.getElementById(styleId+"IFrame");if(consolidatedStyleIFrame){consolidatedStyleIFrame.parentNode.removeChild(consolidatedStyleIFrame);}var style="";if(Object.prototype.toString.call(cssTextArr)!=="[object Array]"){cssTextArr=[cssTextArr];}for(var i=0;i<cssTextArr.length;i++){style+='<style id="'+styleId+(i>0?"_"+i:"")+'">'+cssTextArr[i]+"</style>\n";}stylesContainer.innerHTML="<div>&nbsp;</div>"+style;}function replaceStyle(currentStyle,cssText,addMarker){var componentId=currentStyle.getAttribute("componentid");if(componentId&&componentId.length>0){var marker="."+componentId+" {";if(cssText.indexOf(marker)>-1){cssText=cssText.substring(0,cssText.indexOf(marker))+marker+"}"+currentStyle.innerHTML+cssText.substring(cssText.lastIndexOf(marker));}else{if(addMarker){cssText+=marker+"}"+currentStyle.innerHTML+marker+"}";}else{cssText+=currentStyle.innerHTML;}}}else{cssText+=currentStyle.innerHTML;}return cssText;}function Unload(){window.isUnloading=true;if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.log)!="undefined"){microstrategy.log.show();}if(this.bIsIE6){this.DisconnectElement("object");}}function DisconnectElement(tagName){if(!document.getElementsByTagName){return ;}var elements=document.getElementsByTagName(tagName);var len=(elements!=null)?elements.length:0;for(var i=0;i<len;i++){for(var x in elements[i]){if(typeof elements[i][x]=="function"){elements[i][x]=function(){};}}}}function returnFormField(oForm,sField){var col=oForm.elements;for(var i=0,cnt=col.length;i<cnt;i++){var elem=col[i];if((elem.id==sField)||(elem.name==sField)){return elem;}}return null;}function createDynamicForm(sAction){var oNewForm;var hasParameters=sAction.indexOf("?")>0;var hasRelativeLink=sAction.indexOf("#")>0;oNewForm=document.createElement("FORM");oNewForm.name="dynamic_form";oNewForm.method="POST";var formAction=((hasParameters)?sAction.substring(0,sAction.indexOf("?")):sAction);if(hasRelativeLink){var relativeLink="";sAction=moveAnchor(sAction);relativeLink=sAction.substring(sAction.indexOf("#"));formAction=formAction.replace(relativeLink,"")+relativeLink;sAction=sAction.substring(0,sAction.indexOf("#"));}formAction=microstrategy.addJSessionID(formAction);oNewForm.action=formAction;if(hasParameters){addURLAsHiddenInputsToForm(oNewForm,sAction);}document.body.insertAdjacentElement("beforeEnd",oNewForm);return oNewForm;}function createHiddenInput(oForm,name,value,fromPageState){var oNewItem=document.createElement("INPUT");oNewItem.type="HIDDEN";oNewItem.name=name;oNewItem.value=value;oNewItem.ps=(fromPageState===true);oForm.insertAdjacentElement("beforeEnd",oNewItem);return oNewItem;}function updateDynamicInput(oForm,name,value,oInputs,fromPageState){var found=false;var i;if(!oInputs){oInputs=oForm.getElementsByTagName("input");}for(i=0;i<oInputs.length;i++){found=(oInputs[i].name==name);if(found){break;}}if(found){oInputs[i].value=value;oInputs[i].ps=(fromPageState===true);}else{createHiddenInput(oForm,name,value,fromPageState);}return true;}function submitFormSpecial(sFormName,aFields,aFieldValues){var oField=null;var bFailed=false;var oForm=getObj(sFormName);for(i=0;i<aFields.length;i++){oField=returnFormField(oForm,aFields[i]);if(oField){oField.value=aFieldValues[i];}else{bFailed=true;}}if(!bFailed){submitForm(oForm);}}function submitFormValues(sFormName,aFields,aFieldValues){var oField=null;var bFailed=false;var oForm=getObj(sFormName);synchForm(oForm);for(i=0,cnt=aFields.length;i<cnt;i++){oField=getObj(aFields[i]);if(oField){oField.value=aFieldValues[i];}else{bFailed=true;}}if(!bFailed){submitForm(oForm);}}function updatefbAvailableList(){var oAvailable=getObj("fbAvailable");var oDslist=getObj("fbDataset");if(oAvailable&&!oAvailable.disabled&&oDslist&&oDslist.selectedIndex>=0){for(var i=0;i<oAvailable.children.length;i++){var op=oAvailable.children[i];op.style.display=op.getAttribute("dsidx")==oDslist.selectedIndex?"block":"none";}}}function updatefbAvailableListSelected(idx){var toggleSelect=function(el){var c=el.className;if(/mstrListBlockItemSelected/.test(c)){c=c.replace(/mstrListBlockItemSelected/,"");}else{c+=" mstrListBlockItemSelected";}el.className=c;};var oAvailable=getObj("fbAvailable");var items=oAvailable.children;var curSel=oAvailable.selectedIndex;if(oAvailable){if(idx!=curSel){if(!isNaN(curSel)&&curSel>=0){toggleSelect(items[curSel]);}if(idx>=0){toggleSelect(items[idx]);}}oAvailable.selectedIndex=idx;}}function fbAvailableItemOnClick(item){var oAvailable=getObj("fbAvailable");var items=oAvailable.children;if(oAvailable&&!oAvailable.disabled){for(var i=0;i<items.length;i++){if(items[i]===item){updatefbAvailableListSelected(i);break;}}}}function fbdisableAvailableList(disabled){var oAvailable=getObj("fbAvailable");if(oAvailable&&disabled!=oAvailable.disabled){var c=oAvailable.className;if(!disabled){c=c.replace(/disabled/,"");}else{c+=" disabled";}oAvailable.className=c;oAvailable.disabled=disabled;}}function updatefbFormulaCaret(item){if(item.selectionEnd||item.selectionEnd==0){item.caret=item.selectionEnd;}else{if(document.selection&&document.selection.createRange){var sel=document.selection.createRange();sel.moveStart("character",-item.value.length);var cap=sel.htmlText.match(/<TEXTAREA(.*)>(.*)<\/TEXTAREA>/);if(cap!=null&&cap[2]){item.caret=cap[2].length;}else{item.caret=sel.text.length;}}}}function toggleCheck(oCheck,useDefault){var chkState=oCheck.getAttribute("CV");var oHidden=getObj(oCheck.getAttribute("CL"));chkState--;if(chkState<-2){chkState=0;}switch(chkState){case -1:oCheck.src=microstrategy.FOLDER_IMAGES+"check_on.gif";break;case 0:oCheck.src=microstrategy.FOLDER_IMAGES+"check_off.gif";break;case -2:if(useDefault){oCheck.src=microstrategy.FOLDER_IMAGES+"Check_conflict.gif";}else{chkState=0;oCheck.src=microstrategy.FOLDER_IMAGES+"check_off.gif";}break;}oCheck.setAttribute("CV",chkState);oHidden.value=chkState;}function synchForm(oForm){var sField="";var ocHidden=oForm.getElementsByTagName("INPUT");for(i=0,cnt=ocHidden.length;i<cnt;i++){sField=ocHidden[i].name;sField=sField.toUpperCase();switch(sField){case"INDEX":ocHidden[i].value=lStateID;break;case"MSGID":ocHidden[i].value=sMsgID;break;case"VIEW":ocHidden[i].value=sView;break;}}return true;}function getObj(vObject){return(typeof vObject=="string")?document.getElementById(vObject):vObject;}function getElementById(id){var obj=document.getElementById(id);if(mstr.utils.ISW3C||obj==null){return obj;}if(!obj.length||typeof (obj.tagName)!="undefined"){obj=[obj];}for(var i=0,cnt=obj.length;i<cnt;i++){if(obj[i].id.length>0){return obj[i];}}return null;}function getClientWidth(){var dim=mstr.utils.BoxModel.getBrowserWindowWidth(document);return(bIsIE7)?(dim-SCROLLBAR_SIZE+5):dim;}function getClientHeight(){return mstr.utils.BoxModel.getBrowserWindowHeight(document);}function getDocumentScrollTop(){var de=document.documentElement;return(de&&de.scrollTop)?de.scrollTop:document.body.scrollTop;}function getDocumentScrollLeft(){var de=document.documentElement;return(de&&de.scrollLeft)?de.scrollLeft:document.body.scrollLeft;}function getObjInnerWidth(vObject){return mstr.utils.BoxModel.getElementInnerWidth(getObj(vObject));}function getObjOuterWidth(vObject){return mstr.utils.BoxModel.getElementOuterWidth(getObj(vObject));}function getObjWidth(vObject){return mstr.utils.BoxModel.getElementOuterWidth(getObj(vObject));}function getObjInnerHeight(vObject){return mstr.utils.BoxModel.getElementInnerHeight(getObj(vObject));}function getObjOuterHeight(vObject){return mstr.utils.BoxModel.getElementOuterHeight(getObj(vObject));}function getObjHeight(vObject){return mstr.utils.BoxModel.getElementOuterHeight(getObj(vObject));}function getObjTop(vObject){return mstr.utils.BoxModel.getElementTop(getObj(vObject));}function getObjSumTop(vObject,elLimit){return mstr.utils.BoxModel.getElementSumOffsetTop(getObj(vObject),elLimit||document.body);}function getObjSumTopScrolled(vObject,elLimit){try{var obj=getObj(vObject);var lTop=0;for(var i=0;(obj&&obj!=elLimit);i++){lTop+=obj.offsetTop;if(obj.offsetParent&&obj.offsetParent.scrollTop&&obj.offsetParent.tagName.toLowerCase()!="html"&&obj.offsetParent.tagName.toLowerCase()!="body"){lTop-=obj.offsetParent.scrollTop;}obj=obj.offsetParent;}return parseInt(lTop);}catch(err){return 0;}}function getObjLeft(vObject){return mstr.utils.BoxModel.getElementLeft(getObj(vObject));}function getObjOffsetLeft(vObject){var obj=getObj(vObject);if(obj){return(bIsIE4)?obj.offsetLeft:mstr.utils.BoxModel.getElementLeft(obj);}}function getObjSumLeft(vObject){var obj=getObj(vObject);var lLeft=0;if(obj&&(obj.getClientRects||obj.getBoundingClientRect)&&(!mstr.utils.ISIE8&&!mstr.utils.ISIE9)){lLeft=obj.getBoundingClientRect?obj.getBoundingClientRect().left:obj.getClientRects()[0].left;lLeft=lLeft-2+getDocumentScrollLeft();return Math.round(lLeft);}return mstr.utils.BoxModel.getElementSumOffsetLeft(getObj(vObject),document.body);}function getObjSumLeftScrolled(vObject){try{var obj=getObj(vObject);var lLeft=0;for(var i=0;(obj);i++){lLeft+=obj.offsetLeft;if(obj.offsetParent&&obj.offsetParent.scrollLeft&&obj.offsetParent.tagName.toLowerCase()!="html"&&obj.offsetParent.tagName.toLowerCase()!="body"){lLeft-=obj.offsetParent.scrollLeft;}obj=obj.offsetParent;}return parseInt(lLeft);}catch(err){return 0;}}function getButtonId(e){if(bIsIE4&&!bIsIE9&&!bIsIE10&&e){return e.button;}if(bIsW3C&&e){return(e.button<2)?1:2;}else{return 1;}}function moveObjTo(vObject,iX,iY){var obj=getObj(vObject);if(obj!=null){var x=parseInt(iX);var y=parseInt(iY);if(!isNaN(x)&&!isNaN(y)){obj.style.left=x+"px";obj.style.top=y+"px";}}}function displayObj(vObject){var obj=getObj(vObject);if(obj){obj.style.display=(bIsFirefox&&obj.tagName.toLowerCase()=="table")?"table":"block";obj.style.visibility="visible";}}function removeObj(vObject){var obj=getObj(vObject);if(obj){obj.style.display="none";obj.style.visibility="hidden";}}function isInDocument(vObject){if(!vObject){return false;}var obj=getObj(vObject);if(!obj){return false;}if(!obj.offsetParent){return false;}if(bIsW3C){return(obj.ownerDocument==window.document);}return(obj.document==window.document);}function getMouse(e){if(bIsIE4){lMouseX=event.clientX+getDocumentScrollLeft();lMouseY=event.clientY+getDocumentScrollTop();}else{if(bIsW3C&&e!=null){lMouseX=e.pageX;lMouseY=e.pageY;}}}function writeToDiv(sMessage,sDivID){var oDiv=getObj(sDivID);if(oDiv){oDiv.innerHTML=sMessage;}}function getEventTarget(e){try{if(bIsW3C&&!bIsIE8&&!bIsIE9&&!bIsIE10&&e){if(!e){return null;}var target=e.target;if(typeof (e.target)=="function"){target=e.target();}if(bIsW3C&&target.tagName=="scrollbar"){target=target.parentNode;}if(target.nodeType==3){target=target.parentNode;}return target;}else{if(bIsIE4){return event.srcElement;}}}catch(err){}return null;}function stopEventBubbling(e){if(e){e.cancelBubble=true;if(e.stopPropagation){e.stopPropagation();}}}function cancelEvent(e){if(bIsW3C&&!bIsIE8&&!bIsIE9){e.preventDefault();}else{if(bIsIE4){event.returnValue=false;}}}function isAttributePresent(oTarget,sFind,sValue){var att=oTarget.attributes&&oTarget.attributes.getNamedItem(sFind);if(!att||!att.specified){return false;}if(sValue){return(att.nodeValue==sValue);}return true;}function findTarget(oTarget,sFind,sValue){while(oTarget){if(isAttributePresent(oTarget,sFind,sValue)){return oTarget;}oTarget=oTarget.parentNode;}return null;}function findTargetTag(oTarget,sTagName){while(oTarget.parentNode){if(oTarget.nodeName.toLowerCase()==sTagName.toLowerCase()){return oTarget;}oTarget=oTarget.parentNode;}return null;}function toggleElement(vObject,cssClass,enabled){var obj=getObj(vObject);if(obj){obj.disabled=!enabled;if(cssClass.length>0){obj.className=cssClass;}}}function addURLAsHiddenInputsToForm(oForm,URL,replaceInputs,fromPageState){if(oForm.nodeName!="FORM"){oForm=findTargetTag(oForm,"FORM");}URL=URL.substring(URL.indexOf("?")+1,URL.length);var URLParameters=URL.split("&");var temp="";var parameterName="";var parameterValue="";var myRegExp=/\+/g;for(var i=0,cnt=URLParameters.length;i<cnt;i++){temp=URLParameters[i].split("=");parameterName=temp[0];parameterValue=temp[1];if(parameterValue){parameterValue=decodeURIComponent(parameterValue.replace(myRegExp," "));}if(replaceInputs){updateDynamicInput(oForm,parameterName,parameterValue,fromPageState);}else{createHiddenInput(oForm,parameterName,parameterValue,fromPageState);}}return false;}function openExport(href,target){if(typeof (microstrategy)!="undefined"&&microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION&&microstrategy.bones.rwb_viewer&&microstrategy.bones.rwb_viewer.isFeatureAvailable(microstrategy.FEATURE_USE_OFFICE)&&(microstrategy.IS_RWD_DIRTY==microstrategy.TRUE||hasRWDChanged())){showMessage({contents:microstrategy.descriptors.getDescriptor("3809"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"submitExportForm('"+href+"','"+target+"');",type:mstrMsgBoxImpl.MSG_WARNING});}else{submitExportForm(href,target);}}function hasRWDChanged(){if(typeof (microstrategy)!="undefined"&&microstrategy.updateManager){var um=microstrategy.updateManager;for(var i=0,cnt=um.undoActions.length;i<cnt;i++){var actionCol=um.undoActions[i];if(actionCol==mstrUpdateManager.STATIC_ACTION){continue;}for(var a=0,cnt2=actionCol.length;a<cnt2;a++){if(actionCol[a].id!=mstrUpdateManager.FIX_STATE){return true;}}}}return false;}function submitExportForm(href,target,useGet,dontShowEmptyForm){if(!href){return ;}if(!dontShowEmptyForm&&(bIsIE6&&target!="_blank")){if(target=="_blank"){target=Date.parse(new Date());}submitEmptyForm(target);window.setTimeout("submitExportForm('"+href+"','"+target+"', "+useGet+", true);",500);return ;}var oNewForm=createDynamicForm(href);if(target!=""){oNewForm.target=target;}if(useGet){oNewForm.method="POST";}oNewForm.action=oNewForm.action+"?name="+Date.parse(new Date());if(typeof (microstrategy)!="undefined"&&(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)&&microstrategy.IN_OUTLINE_MODE){var rb=microstrategy.bone("UniqueReportID");if(rb!=null&&rb.outlineMode!=null){var state=rb.outlineMode.getExpansionState("UniqueReportID");if(state.length>0){createHiddenInput(oNewForm,"PDFOutlineModeState",state);}}}if(target=="_new"){iframe.hideWaitPage();}submitForm(oNewForm);return false;}function exportRW(execMode,target,dontShowMsg,dontShowOptions,dontShowEmptyForm){var docViewer=microstrategy.getViewerBone();if(!docViewer){return ;}if(!dontShowMsg){if(execMode==microstrategy.EXEC_MODE_EXCEL){if(docViewer.isFeatureAvailable(microstrategy.FEATURE_USE_OFFICE)&&(microstrategy.IS_RWD_DIRTY==microstrategy.TRUE||hasRWDChanged())){showMessage({contents:microstrategy.descriptors.getDescriptor("3809"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"exportRW("+execMode+",'"+target+"',true,"+dontShowOptions+","+dontShowEmptyForm+");",type:mstrMsgBoxImpl.MSG_WARNING});return ;}}else{if(execMode==microstrategy.EXEC_MODE_FLASH&&bIsIE6&&isFlashMHTFormat()){showMessage({contents:microstrategy.descriptors.getDescriptor("5873"),elements:microstrategy.OK_BUTTON,okEval:"exportRW("+execMode+",'"+target+"',true,"+dontShowOptions+","+dontShowEmptyForm+");",type:mstrMsgBoxImpl.MSG_WARNING});return ;}}}if(execMode==microstrategy.EXEC_MODE_EXCEL||execMode==microstrategy.EXEC_MODE_PDF){if(!dontShowOptions&&docViewer.isFeatureAvailable("show-rw-export-options")&&(docViewer.isFeatureAvailable("is-multi-layout-doc")||(!docViewer.containsGroupByDifferentThanAll&&docViewer.isFeatureAvailable("show-groupby-for-export")||(docViewer.containsGroupByDifferentThanAll&&docViewer.containsGroupByDifferentThanAll())))){var p=(execMode==microstrategy.EXEC_MODE_PDF)?"&isPDF=true":"";toggleShowBean("exportOptionsEditor",true,"executionMode="+execMode+p);return ;}}if(!dontShowEmptyForm&&(bIsIE6&&target!="_blank")){submitEmptyForm(target);window.setTimeout("exportRW("+execMode+",'"+target+"',"+dontShowMsg+","+dontShowOptions+",true);",500);return ;}var newWindowOldValue=microstrategy.updateManager.newWindow;var windowNameOldValue=microstrategy.updateManager.newWindowName;var actionFormOldValue=microstrategy.updateManager.getFormAction();var fixStateActions=microstrategy.updateManager.getFixStateActions();microstrategy.updateManager.newWindow=true;microstrategy.updateManager.newWindowName=target;microstrategy.updateManager.setFormAction(microstrategy.servletName+"?name="+Date.parse(new Date()));microstrategy.updateManager.add(getRWExportActionObject(execMode),true);microstrategy.updateManager.flushAndSubmitChanges();microstrategy.updateManager.newWindow=newWindowOldValue;microstrategy.updateManager.newWindowName=windowNameOldValue;microstrategy.updateManager.setFormAction(actionFormOldValue);microstrategy.updateManager.acknowledgeRequest();microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.FIX_STATE,microstrategy.getViewerBone().beanPath,[],[],[],[])],true);microstrategy.updateManager.add(fixStateActions,true);}function getRWExportActionObject(execMode){if(execMode=="-1"){return[microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.RW_HTML_EXPORT,microstrategy.servletName,[],[],[],[])];}else{return[microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.RW_FAST_EXPORT,microstrategy.servletName,["3115"],[execMode],[],[])];}}function submitEmptyForm(target){var oNewForm=createDynamicForm("../html/Empty.html");oNewForm.target=target;oNewForm.method="GET";oNewForm.submit();}function submitForm(oForm,noXHR){var stateForm=getObj("pageStateForm");var aInputs=null;var aOriginalInputs=null;var i;var j;var oNewItem;var found;appendPageState(oForm);if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){var docViewer=microstrategy.bones.rwb_viewer;updateDynamicInput(oForm,"docSelections",docViewer.commands.queryState("selectionsKey"));docViewer.adjustScrollValues();updateDynamicInput(oForm,"viewerScroll",docViewer.dScrollTop+","+docViewer.dScrollLeft);var ctrlToolbar=microstrategy.bones.rwControlsToolbar;if(ctrlToolbar!=null){updateDynamicInput(oForm,"isLocked",(ctrlToolbar.locked)?1:0);if(ctrlToolbar.selected&&ctrlToolbar.selected.id){updateDynamicInput(oForm,"currentControl",ctrlToolbar.selected.id);}}}if(typeof (microstrategy)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){for(var id in microstrategy.bones){if(microstrategy.bones[id]!=null&&microstrategy.bones[id].type==microstrategy.OBJTYPE_GRID){var gridBone=microstrategy.bones[id];if(gridBone&&gridBone.gridStructureInfo&&!gridBone.gridStructureInfo.emptyCase&&!gridBone.gridStructureInfo.isEmptyTemplate){if(gridBone.isGrid){var value=gridBone.commands.queryState("selections");if(value){updateDynamicInput(oForm,gridBone.id,value);}}if(gridBone.isGraph&&id.indexOf("_graph")==-1){updateDynamicInput(oForm,gridBone.id+"_gs",gridBone.commands.queryState("graphSelections"));}}}}}if(false){var aInputs=oForm.getElementsByTagName("INPUT");var s="";for(i=0;i<aInputs.length;i++){s+=aInputs[i].name+": "+aInputs[i].value+"\n";}var start=0;while(start<s.length){alert(s.substr(start,5000));start+=5000;}}if(oForm.target=="frameManager"&&useXHR&&!noXHR){if(microstrategy.updateManager){microstrategy.updateManager.submitPartialUpdate(UpdateHelper.createParamsFromForm(oForm));}}else{try{microstrategy.submitForm(oForm);}catch(err){if(oForm.target!=""&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){showMessage({contents:microstrategy.descriptors.getDescriptor("5877"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.errors.log(err);}}}return false;}function appendPageState(oForm){for(var len=oForm.elements.length,i=len-1,oInput;i>=0;i--){oInput=oForm.elements[i];if(oInput.ps===true){var p=oInput.parentNode;p=p&&p.removeChild&&p.removeChild(oInput);}}var stateForm=getObj("pageStateForm");var aInputs=null;var aOriginalInputs=null;var i;if(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit()){microstrategy.updateManager.flushChanges(oForm);addEvtOrder(oForm,mstrUpdateManager.multipleEventID);}if(stateForm){if(oForm.method=="get"||oForm.method=="GET"){addURLAsHiddenInputsToForm(oForm,pageState,true,true);}else{aInputs=stateForm.getElementsByTagName("INPUT");aOriginalInputs=oForm.getElementsByTagName("INPUT");for(i=0,cnt=aInputs.length;i<cnt;i++){updateDynamicInput(oForm,aInputs[i].name,aInputs[i].value,aOriginalInputs,true);}}}}function updateAndSubmitLink(oAnchor){microstrategy.updateManager.flushAndSubmitChanges();submitLink(oAnchor);return ;}function openLink(oAnchor){submitLink(oAnchor);window.open(oAnchor.href,oAnchor.target);return false;}function updateAndOpenLink(sUrl,sTarget){var newUrl=updateLink(sUrl);window.open(newUrl,sTarget);iframe.hideWaitPage();return false;}function updateLink(oldUrl){var sResultURL=oldUrl;var sURL=pageState;var endPos,nextPos,currParam,currValue;if(sURL){while((endPos=sURL.indexOf("="))>=0){currParam=sURL.substr(0,endPos);currValue=((nextPos=sURL.indexOf("&"))>=0)?sURL.substr(endPos+1,nextPos-endPos-1):sURL.substr(endPos+1);sResultURL=replaceURLParameter(sResultURL,currParam,currValue);sURL=(nextPos>=0)?sURL.substr(nextPos+1):"";}}return sResultURL;}function toggleShowBean(beanName,show,args,noXHR){if(typeof (microstrategy)!="undefined"&&microstrategy.updateManager){var actionCollection=new Array();actionCollection.push(microstrategy.updateManager.createActionObject(null,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],[show,beanName],[]));microstrategy.updateManager.add(actionCollection);microstrategy.updateManager.addURL(args);microstrategy.updateManager.flushAndSubmitChanges(noXHR);}return false;}function addArgument(fieldName,oAnchor){if(fieldName){var oField=getObj(fieldName);var argumentValue,argumentName;if(oField){argumentName=oField.id;argumentValue=oField.value;if((typeof (argumentName)!="undefined")&&(argumentName.length>0)&&(typeof (argumentValue)!="undefined")){oAnchor.href=oAnchor.href+"&"+argumentName+"="+escape(argumentValue);}}}}function addArgumentAndSubmitLink(fieldName,oAnchor){addArgument(fieldName,oAnchor);submitLink(oAnchor);}function submitLinkAsForm(oAnchor){var sURL=oAnchor.href,sTarget=oAnchor.target,oForm=createDynamicForm(sURL);if(microstrategy.servletState&&window.microstrategy){var mstrWebInput=microstrategy.findChildWithAtt(oForm,"input","name",microstrategy.servletName);if(!mstrWebInput&&microstrategy.servletState){createHiddenInput(oForm,microstrategy.servletName,microstrategy.servletState);}}if(sTarget){oForm.target=sTarget;}submitForm(oForm);return false;}function getCookie(cookieName){var cookieStart=cookieEnd=-1;if(document.cookie.length>0){cookieStart=document.cookie.indexOf(cookieName+"=");if(cookieStart!=-1){cookieStart=cookieStart+cookieName.length+1;cookieEnd=document.cookie.indexOf(";",cookieStart);if(cookieEnd==-1){cookieEnd=document.cookie.length;}return unescape(document.cookie.substring(cookieStart,cookieEnd));}}return null;}function submitLink(oAnchor,e){if(!e){e=window.event;}if(e&&e.ctrlKey){return false;}var sTarget=oAnchor.target;if(iframe&&sTarget.indexOf("_blank")===-1){iframe.showWaitPage(true);}window.mstrSubmitLink=true;if(oAnchor.getAttribute("useIframe")){if(history.pushState){var simpleURL=oAnchor.href.split(/[?#]/)[0];history.pushState({target:oAnchor.target,href:oAnchor.href},oAnchor.title,simpleURL);}oAnchor.href=replaceURLParameter(oAnchor.href,"iframe","true");}var sURL=oAnchor.href;var cssAnalyzerToolbar=document.getElementById("cssAnalyzerToolbar");var isCSSAnalyzerEnabled=(getCookie(ENABLE)=="true")&&(cssAnalyzerToolbar!=null)&&e.altKey;if(isCSSAnalyzerEnabled){return false;}if(sTarget=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){if(!bIsIE7||document.readyState=="complete"){var oForm=createDynamicForm(sURL);if(sTarget){oForm.target=sTarget;}if(oAnchor.getAttribute("runAsExpress")=="1"){createHiddenInput(oForm,"innerWidth",getClientWidth());createHiddenInput(oForm,"innerHeight",getClientHeight());}submitForm(oForm);}return false;}if(typeof (pageState)!="undefined"){var sNewLink=updateLink(sURL);sNewLink=moveAnchor(sNewLink);var anchorText=null;if(bIsIE6&&oAnchor.childNodes&&(oAnchor.childNodes.length==1)&&oAnchor.childNodes[0].nodeType==3){anchorText=oAnchor.innerHTML;}var oForm=createDynamicForm(sNewLink);if(sTarget){oForm.target=sTarget;}submitForm(oForm);return false;}else{return true;}}function submitCreateAnalysis(oAnchor,e){var ret=submitLink(oAnchor,e);if(ret){oAnchor.href=replaceURLParameter(oAnchor.href,"fromPh","0");}return ret;}function moveAnchor(sURL){var iInitialPos=-1,iFinalPos=-1,sAnchor="";iInitialPos=sURL.indexOf("#");if(iInitialPos>-1){iFinalPos=sURL.indexOf("?",iInitialPos);if(iFinalPos==-1){iFinalPos=sURL.indexOf("&",iInitialPos);}if(iFinalPos>-1){sAnchor=sURL.substr(iInitialPos,iFinalPos-iInitialPos);sURL=sURL.replace(sAnchor,"")+sAnchor;}}return sURL;}function addEvtOrder(oForm,eventID,isLastEvent){var aOriginalInputs=oForm.getElementsByTagName("input"),found=false,multipleEvents=0;for(j=0,cnt=aOriginalInputs.length;j<cnt;j++){found=aOriginalInputs[j].name=="evtorder";if(found){break;}}if(found){if(aOriginalInputs[j].value.indexOf(eventID)<0){aOriginalInputs[j].value=(isLastEvent)?(aOriginalInputs[j].value+","+eventID):(eventID+","+aOriginalInputs[j].value);updateDynamicInput(oForm,eventID,"1",aOriginalInputs);}}else{updateDynamicInput(oForm,"evtorder",eventID);for(j=0,cnt=aOriginalInputs.length;j<cnt;j++){if(aOriginalInputs[j].name=="evt"){multipleEvents++;}}if(multipleEvents<3){for(j=0,cnt=aOriginalInputs.length;j<cnt;j++){if(aOriginalInputs[j].name=="evt"){updateDynamicInput(oForm,aOriginalInputs[j].value,"1");}}}}}function replaceURLParameter(sURL,sFieldToChange,sValueToChange){var jumpLink="";if(sURL.indexOf("#")>-1){jumpLink=sURL.substr(sURL.indexOf("#"));sURL=sURL.substr(0,sURL.indexOf("#"));}var iInitialPos=iFinalPos=-1,sUrlUpper=sURL.toUpperCase(),sSearch=sFieldToChange.toUpperCase()+"=",sLeadChar="";iInitialPos=sUrlUpper.indexOf(sSearch);if(iInitialPos>-1){sLeadChar=sUrlUpper.substr(iInitialPos-1,1);if((sLeadChar!="&")&&(sLeadChar!="?")){iInitialPos=sUrlUpper.indexOf(sSearch,iInitialPos+1);}if(iInitialPos>-1){iFinalPos=sURL.indexOf("&",iInitialPos);if(iFinalPos==-1){sLeadChar=sURL.substr(iInitialPos-1,1);if(sLeadChar=="&"){sURL=sURL.substr(0,iInitialPos-1);}}else{sURL=(sLeadChar=="?")?sURL.substr(0,iInitialPos)+sURL.substr(iFinalPos+1):sURL.substr(0,iInitialPos-1)+sURL.substr(iFinalPos);}}}if(sURL.length>0){sURL+=(sURL.substr(-1)=="?")?(sFieldToChange+"="+sValueToChange):("&"+sFieldToChange+"="+sValueToChange);}else{sURL+=sFieldToChange+"="+sValueToChange;}return sURL+jumpLink;}function getURLParameter(sURL,sParameter){var r=new RegExp(sParameter+"=(.*?)&|$");var m=r.exec(sURL,"i");return m[1]||"";}function insertDynamicScript(key,filePath){if(bIsIE4||mstr.utils.ISSAFARI||mstr.utils.ISCHROME||mstr.utils.ISFF4PLUS||bIsW3CIE){microstrategy.dynamicJS.push({key:key,file:filePath});}else{if(!checkJSExists(key)){var scriptNode=document.getElementById(key+"_js");if(scriptNode){if(scriptNode.src!=filePath){scriptNode.src=filePath;}}else{scriptNode=document.createElement("script");scriptNode.id=key+"_js";scriptNode.setAttribute("language","javascript");document.body.appendChild(scriptNode);scriptNode.src=getResourcePathWithVersion(filePath);}}}}function checkJSExists(key){if(key.indexOf(".")<0){return window[key];}var keyStr=key.split("."),obj=window,v=n=null;for(var i=0,len=keyStr.length;i<len;i++){n=keyStr[i];v=obj[n];if(v==undefined){return false;}obj=v;if(obj==null){return false;}}return true;}function loadInit(key,methodToExecute){if(eval(key)){eval(methodToExecute);}else{key=key.replace(/"/g,'\\"');methodToExecute=methodToExecute.replace(/"/g,'\\"');window.setTimeout('loadInit("'+key+'", "'+methodToExecute+'");',500);}}function togglePulldowns(elem,bShow){if(bIsW3C){return ;}if(!bShow){if(elem){var w=getObjWidth(elem)||getObjInnerWidth(elem);var h=getObjHeight(elem)||getObjInnerHeight(elem);var popupMask=microstrategy.getPopupMask(elem);popupMask.style.left=elem.style.left;popupMask.style.top=elem.style.top;popupMask.style.width=w+"px";popupMask.style.height=h+"px";if(elem.style.zIndex>0){popupMask.style.zIndex=elem.style.zIndex-1;}else{if(typeof (microstrategy)!="undefined"&&microstrategy.styleObj){var styleZIndex=microstrategy.styleObj.getValue(elem,"zIndex");if(styleZIndex&&!isNaN(parseInt(styleZIndex))){popupMask.style.zIndex=styleZIndex;}}}}}else{microstrategy.releasePopupMask(elem);}return ;}function closeDialog(sDialogName,sFrameName){if(getObj(sDialogName+"_pane")){removeObj(sDialogName+"_pane");}if(getObj("colHandlesPane")){removeObj("colHandlesPane");}var newState=getURLParameter(pageState,sFrameName);newState=newState.replace(sDialogName,"*0");pageState=replaceURLParameter(pageState,sFrameName,newState);var oForm=getObj("pageStateForm"),oInput;for(var i=0,len=oForm.elements.length;i<len;i++){oInput=oForm.elements[i];if(oInput.name==sFrameName){oInput.value=newState;break;}}if(microstrategy.observer){microstrategy.observer.notifyAll("onstatechange");}microstrategy.eventManager.ondialogresize();return false;}function closeEditor(sEditorName){if(getObj(sEditorName+"_pane")){removeObj(sEditorName+"_pane");}var reEvent=new RegExp("6012","g");if(microstrategy){var updateManager=microstrategy.updateManager;if(updateManager){var actionCollection=new Array();actionCollection.push(updateManager.createActionObject(this,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],["false",sEditorName],[]));updateManager.add(actionCollection,true);}}return false;}function showMessage(messageInfo){var bone=null;if(messageInfo.messageBoxID==null){messageInfo.messageBoxID="msgBox";}if(messageInfo.positionInMiddle==null||typeof (messageInfo.positionInMiddle)=="undefined"){messageInfo.positionInMiddle=true;}bone=microstrategy.bones[messageInfo.messageBoxID];if(bone){bone.cleanBeforeInit();if(messageInfo.messageBoxID=="msgBox"){bone.setCssClass(messageInfo.boneCssClass);}if(messageInfo.href!=null){bone.setHelpHref(messageInfo.href,messageInfo.appendHelpTopic);}if(messageInfo.type!=mstrMsgBoxImpl.MSG_EXPORT_LINK){bone.setMessage(messageInfo.contents,messageInfo.type);}if(messageInfo.type==mstrMsgBoxImpl.MSG_TEXT_ONLY){bone.setTextOnlyContentWidth();}bone.setButtons(messageInfo.elements,messageInfo.okEval,messageInfo.cancelEval,messageInfo.applyEval,messageInfo.buttonLabels);bone.setTitle(messageInfo.title);bone.setPreference(messageInfo.type==mstrMsgBoxImpl.MSG_PREF_WARNING);bone.show(messageInfo.positionInMiddle,messageInfo.zIndex);bone.setButtonFocus(messageInfo.focusButton);}}function enablePulldowns(obj,bShow){if(mstr.utils.ISIE6){var pulldowns=obj.getElementsByTagName("select");if(pulldowns){if(bShow){for(var i=0;i<pulldowns.length;i++){if(pulldowns[i].getAttribute("db")=="true"){pulldowns[i].disabled=false;pulldowns[i].removeAttribute("db");}}}else{for(var i=0;i<pulldowns.length;i++){if(!pulldowns[i].disabled){pulldowns[i].disabled=true;pulldowns[i].setAttribute("db","true");}}}}}}function encode(oldStr,toServer){var sb=oldStr;if(toServer==null){toServer=false;}if((oldStr!=null)&&(oldStr.length>0)){sb="";for(var i=0,len=oldStr.length;i<len;i++){switch(oldStr.charAt(i)){case"&":if((oldStr.length!=(i+1))&&(oldStr.charAt(i+1)=="#")){sb+="&";}else{sb+="&amp;";}break;case"<":sb+="&lt;";break;case">":sb+="&gt;";break;case"'":sb+="&#039;";break;case"\n":if(!toServer){sb+="<br />";}else{sb+=oldStr.charAt(i);}break;case'"':sb+="&quot;";break;case" ":if(i==0||(i<oldStr.length-1&&oldStr.charAt(i+1)==" ")){sb+="&nbsp;";}else{sb+=oldStr.charAt(i);}break;default:sb+=oldStr.charAt(i);break;}}}return sb;}function decode(oldStr,toServer){var newString=oldStr;if(oldStr!=null){newString=newString.replace(/&amp;/g,"&");newString=newString.replace(/&lt;/g,"<");newString=newString.replace(/&gt;/g,">");newString=newString.replace(/&#039;/g,"'");newString=newString.replace(/&nbsp;/g," ");if(!toServer){newString=newString.replace(/<BR>/ig,"\n");}newString=newString.replace(/&quot;/g,'"');}return newString;}function trim(str){if(!str){return"";}return str.replace(/^\s\s*/,"").replace(/\s\s*$/,"");}function gotoPromptAnchor(){if(promptFunctionsScript==true){resizePromptContent();gotoAnchor(currentPin);}}SimpleRect.prototype=new Object();function SimpleRect(obj){this.left=getObjSumLeftScrolled(obj);this.top=getObjSumTopScrolled(obj);this.right=this.left+getObjWidth(obj);this.bottom=this.top+getObjHeight(obj);return this;}function setFilter(elem,name,props){if(bIsIE4&&!(name=="Alpha"&&bIsIE9)&&!bIsIE10){var filter=getFilter(elem,name);var prop;if(filter){filter.enabled=true;for(prop in props){filter[prop]=props[prop];}if(name=="Alpha"&&props.opacity==100){filter.enabled=false;}}else{if(name=="Alpha"&&props.opacity==100){return ;}var filterDefinition=" progid:DXImageTransform.Microsoft."+name+"(";for(prop in props){filterDefinition+=prop+"="+props[prop]+",";}filterDefinition=filterDefinition.substr(0,filterDefinition.length-1)+")";var filterText=elem.style.filter;if(!filterText){filterText=getFilter(elem);if(filterText){elem.style.filter+=filterText+filterDefinition;}else{elem.style.filter+=filterDefinition;}}else{elem.style.filter+=filterDefinition;}}}else{if(mstr.utils.ISFF||mstr.utils.ISWK||mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE){if(name=="Alpha"){elem.style.opacity=props.opacity/100;}}}}function getFilter(elem,name){try{if(microstrategy&&microstrategy.styleObj){return microstrategy.styleObj.getFilter(elem,name);}var filter=null;if(bIsIE4&&!bIsIE10){var filterText=elem.currentStyle.filter;if(!name){return filterText;}if(filterText.length>0){filter=elem.filters["DXImageTransform.Microsoft."+name];}}return filter;}catch(err){microstrategy.errors.log(err);return false;}}function removeFilter(elem,name){try{if(microstrategy&&microstrategy.styleObj){return microstrategy.styleObj.getFilter(elem,name);}var filter=null;if(bIsIE4&&!bIsIE10){var filterText=elem.currentStyle.filter;if(!name){return filterText;}if(filterText.length>0){filter=elem.filters["DXImageTransform.Microsoft."+name];}}return filter;}catch(err){microstrategy.errors.log(err);return false;}}function CheckTextAreaMaxLength(oTextArea,lMaxLength){var oStr=(typeof (oTextArea.innerText)!="undefined")?oTextArea.innerText:oTextArea.value;if(oStr.length>lMaxLength){LimitTextAreaMaxLength(oTextArea,lMaxLength);}return true;}function LimitTextAreaMaxLength(oTextArea,lMaxLength){if(oTextArea.value.length>lMaxLength){oTextArea.value=oTextArea.value.substring(0,lMaxLength);}}function toggleScreenMode(){var updateManager;if(typeof (microstrategy)!="undefined"&&microstrategy.updateManager){updateManager=microstrategy.updateManager;}if(!updateManager){return true;}var featureResolver,homeToolbar,actionCollection;if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){featureResolver=mstr.$obj("UniqueReportID");homeToolbar=mstr.$obj("rptRibbonToolbarModel");}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){featureResolver=microstrategy.getViewerBone();homeToolbar=mstr.$obj("rwRibbonToolbarModel");}}if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){actionCollection=new Array();actionCollection.push(updateManager.createActionObject(this.elem,mstrUpdateManager.SWITCH_FULL_SCREEN_MODE,microstrategy.servletName+"."+microstrategy.pageName,["5028"],["1"],[]));microstrategy.updateManager.add(actionCollection,true);var shortcut=document.getElementById("mstrWeb_shortcutsBar");if((featureResolver.currentRWViewMode!=microstrategy.RW_VIEW_MODE_FLASH)||(shortcut)){document.body.className=document.body.className.replace(" mstrFullScreen","");}else{updateManager.useIframe=false;updateManager.flushAndSubmitChanges();}if(mstr.utils.ISIE4){var cc=document.getElementById("td_mstrWeb_dockLeft");if(cc){cc.parentNode.insertBefore(cc,cc.nextSibling);}}featureResolver.features["page-full-screen-mode"]=false;microstrategy.pageScreenMode=microstrategy.PAGE_NORMAL_SCREEN_MODE;if(featureResolver.observer){featureResolver.observer.notifyAll("onScreenModeChange");}}else{actionCollection=new Array();actionCollection.push(updateManager.createActionObject(this.elem,mstrUpdateManager.SWITCH_FULL_SCREEN_MODE,microstrategy.servletName+"."+microstrategy.pageName,["5028"],["2"],[]));microstrategy.updateManager.add(actionCollection,true);microstrategy.pageScreenMode=microstrategy.PAGE_FULL_SCREEN_MODE;if(!homeToolbar){updateManager.useIframe=false;updateManager.flushAndSubmitChanges();return false;}else{homeToolbar.execSelectValue(0);featureResolver.features["page-full-screen-mode"]=true;if(featureResolver.observer){featureResolver.observer.notifyAll("onScreenModeChange");}}document.body.className+=" mstrFullScreen";}window.setTimeout(function(){microstrategy.redoLayout(true);microstrategy.eventManager.notifyOrphanBones("onwinresize");},1);return false;}function submitSaveVisualization(href,target){var oNewForm=createDynamicForm(href);if(target){oNewForm.target=target;}oNewForm.method="POST";var bone=microstrategy.bone("UniqueReportID");if(!bone){bone=microstrategy.bone("rwb_viewer");}if(bone&&bone.selectedVisualization){createHiddenInput(oNewForm,"styleName",bone.selectedVisualization);}submitForm(oNewForm);}var graphUnitTooltipCache=null;function onMainGraphMouseMove(e){if(!e){e=window.event;}var src=e.currentTarget;if(src){var tooltip=src.getAttribute("tooltip");if(tooltip&&!graphUnitTooltipCache&&graphTooltipCache.length==0){src.onmouseout=new Function("e","onMainGraphMouseExit(e);");graphUnitTooltipCache=document.createElement("span");graphUnitTooltipCache.className="graph-tooltip";graphUnitTooltipCache.id="mainTooltip";getMouse(e);moveObjTo(graphUnitTooltipCache,lMouseX,lMouseY);document.body.appendChild(graphUnitTooltipCache);graphUnitTooltipCache.innerHTML=tooltip;togglePulldowns(graphUnitTooltipCache,false);}}}function onMainGraphMouseExit(e){if(!e){e=window.event;}if(graphUnitTooltipCache){graphUnitTooltipCache.parentNode.removeChild(graphUnitTooltipCache);togglePulldowns(graphUnitTooltipCache,true);graphUnitTooltipCache=null;}}var graphTooltipCache=[];function onGraphMouseMove(e,boneName){if(!e){e=window.event;}var src=getEventTarget(e);if(src){src.onmouseout=new Function("e","onGraphExit(e);");graphShowTooltip(src,e,boneName);}}function onGraphExit(e){if(!e){e=window.event;}if(graphTooltipCache){for(var i=0;i<graphTooltipCache.length;++i){graphTooltipCache[i].parentNode.removeChild(graphTooltipCache[i]);togglePulldowns(graphTooltipCache[i],true);}graphTooltipCache=[];}}function getOverlappedItems(areas,coords){var items=[];for(var i=areas.length-1;i>=0;--i){var c=areas[i].getAttribute("coords");if(c&&c==coords){items.push(areas[i]);}}return items;}function graphShowTooltip(src,e,boneName){if(!e){e=window.event;}var image=null;if(graphTooltipCache.length>0){return ;}if(boneName){var bone=microstrategy.bone(boneName);if(bone){image=bone.image;}}else{if(microstrategy){var imageParent=microstrategy.findAncestorWithAtt(src,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_GRAPH_TEMPLATE);if(imageParent){image=microstrategy.objectFind(imageParent,"img",microstrategy.OBJTYPE_GRAPH);}}}if(!image){var imageParent=src.parentNode.parentNode;if(imageParent){image=microstrategy.objectFind(imageParent,"img",microstrategy.OBJTYPE_GRAPH);}}if(e&&src&&image){var tooltipText=src.getAttribute("tooltip"),x=y=99999;if(!tooltipText){if(graphTooltipCache){for(var i=0;i<graphTooltipCache.length;++i){graphTooltipCache[i].parentNode.removeChild(graphTooltipCache[i]);togglePulldowns(graphTooltipCache[i],true);}graphTooltipCache=[];}return ;}var coords=src.getAttribute("coords"),imgLeft=getObjSumLeftScrolled(image),imgTop=getObjSumTopScrolled(image),imgWidth=getObjWidth(image),imgHeight=getObjHeight(image),zoom=100;var items=getOverlappedItems(src.parentNode.children,coords),w=5;if(coords&&coords.length>0){coords=coords.split(",");if(coords.length>=4){w=coords[2]-coords[0];}x=99999;y=99999;var i=0;while(i+1<coords.length){x=Math.min(x,parseInt(coords[i++]));y=Math.min(y,parseInt(coords[i++]));}x+=imgLeft;y+=imgTop;}else{getMouse(e);x=lMouseX;y=lMouseY;}if(microstrategy.ZOOM_FACTOR){zoom=microstrategy.ZOOM_FACTOR;}var maxw=0,maxh=0,margin=5,line=Math.ceil(items.length/2),cache;for(var i=0;i<items.length;++i){cache=document.createElement("span");cache.className="graph-tooltip";cache.id="tooltip"+i;if(bIsIE8){cache.style.left="1px";cache.style.top="1px";}else{cache.style.left="-10000px";}document.body.appendChild(cache);cache.innerHTML=items[i].getAttribute("tooltip");cache.style.fontSize=(zoom/100)+"em";maxw=Math.max(maxw,getObjWidth(cache));maxh=Math.max(maxh,getObjHeight(cache));graphTooltipCache.push(cache);}var originalX=function(x,tpWid){if(x+w+maxw+margin>imgLeft+imgWidth){return imgLeft+imgWidth-w-maxw-margin;}else{if(items.length>1&&x-maxw-margin<0){return maxw+margin;}}return x;},originalY=function(y,tpHeight,line){var toph=line==1?maxh:(line*maxh+(line-1)*margin)/2;if(toph>y){return 0;}else{if(toph+y>imgTop+imgHeight){return imgTop+imgHeight-toph*2;}else{return y-toph;}}};x=originalX(x,maxw);y=originalY(y,maxh,line);for(var i=0;i<graphTooltipCache.length;i++){if(i%2==0){moveObjTo(graphTooltipCache[i],x+w+margin,y);}else{moveObjTo(graphTooltipCache[i],x-getObjWidth(graphTooltipCache[i])-margin,y);y+=maxh+margin;}togglePulldowns(graphTooltipCache[i],false);}}}var templateTooltipCache=null;function onTemplateMouseMove(e){if(!e){e=window.event;}var src=getEventTarget(e);if(src){mstr.$D.attachEvent(src,"mouseout",onTemplateExit,false);tempShowTooltip(src,e);}}function onTemplateExit(e){if(!e){e=window.event;}if(templateTooltipCache){templateTooltipCache.style.left="-15000px";togglePulldowns(templateTooltipCache,true);}}function tempShowTooltip(src,e){if(!e){e=window.event;}if(e&&src){var template=microstrategy.findAncestorWithAtt(src,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_TEMPLATE);var x=y=99999,zoom=100,tooltipText=null;if(template){tooltipText=template.getAttribute("tooltip");}if(!tooltipText){if(templateTooltipCache){templateTooltipCache.style.left="-15000px";togglePulldowns(templateTooltipCache,true);}return ;}getMouse(e);x=lMouseX;y=lMouseY;if(!templateTooltipCache){templateTooltipCache=document.createElement("span");templateTooltipCache.className="graph-tooltip";if(templateTooltipCache){templateTooltipCache.style.left="-15000px";}document.body.appendChild(templateTooltipCache);}templateTooltipCache.innerHTML=tooltipText;if(microstrategy.ZOOM_FACTOR){zoom=microstrategy.ZOOM_FACTOR;}templateTooltipCache.style.fontSize=(zoom/100)+"em";y-=getObjHeight(templateTooltipCache)-40;moveObjTo(templateTooltipCache,x,y);togglePulldowns(templateTooltipCache,false);}}function getFooterHeight(){var f=document.getElementById("mstrWeb_footer");f=microstrategy.findChildWithAtt(f,"div",(mstr.utils.ISW3C?"class":"className"),"mstrFooter")||f;var mt=parseInt(mstr.utils.CSS.getStyleValue(f,"marginTop"));return(f)?mstr.utils.BoxModel.getElementOuterHeight(f)+(isNaN(mt)?0:mt):0;}function exportReport(defaultRunMode,target,type,viewMode,dontShowEmptyForm,dontShowMsg){if(!dontShowMsg&&type=="buttonFlash"&&bIsIE6&&isFlashMHTFormat()){showMessage({contents:microstrategy.descriptors.getDescriptor("5873"),elements:microstrategy.OK_BUTTON,okEval:"exportReport('"+defaultRunMode+"','"+target+"','"+type+"',"+viewMode+","+dontShowEmptyForm+",true);",type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(!dontShowEmptyForm&&(bIsIE6&&target!="_blank")){submitEmptyForm(target);if(defaultRunMode==null){defaultRunMode="";}window.setTimeout("exportReport('"+defaultRunMode+"','"+target+"','"+type+"',"+viewMode+",true,"+dontShowMsg+");",500);return ;}var newWindowOldValue=microstrategy.updateManager.newWindow;var windowNameOldValue=microstrategy.updateManager.newWindowName;var actionFormOldValue=microstrategy.updateManager.getFormAction();var fixStateActions=microstrategy.updateManager.getFixStateActions();microstrategy.updateManager.newWindow=true;microstrategy.updateManager.newWindowName=target;microstrategy.updateManager.setFormAction(microstrategy.servletName+"?name="+Date.parse(new Date()));function getOutlineState(){if(typeof (microstrategy)!="undefined"&&(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)&&microstrategy.IN_OUTLINE_MODE){var rb=microstrategy.bone("UniqueReportID");if(rb!=null&&rb.outlineMode!=null){return rb.outlineMode.getExpansionState("UniqueReportID");}}return"";}switch(type){case"export":var ids=["3033","3005","3114"],values=["export",viewMode,getOutlineState()];if(defaultRunMode){ids.splice(2,0,"3157");values.splice(2,0,defaultRunMode);}microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.EXPORT_REPORT,microstrategy.servletName,ids,values,[],[])],true);break;case"printPDF":microstrategy.updateManager.addURL("pdfPrint=1");case"buttonPDF":microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.EXPORT_PDF_REPORT,microstrategy.servletName,["3033","3114"],["pdf",getOutlineState()],[],[])],true);break;case"print":microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.PRINT_REPORT,microstrategy.servletName,["3033"],["print"],[],[])],true);break;case"buttonFlash":microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.EXPORT_REDIRECT,microstrategy.servletName,["3153"],[mstrUpdateManager.EXPORT_FLASH_REPORT],[],[])],true);break;}microstrategy.updateManager.flushAndSubmitChanges();microstrategy.updateManager.newWindow=newWindowOldValue;microstrategy.updateManager.newWindowName=windowNameOldValue;microstrategy.updateManager.setFormAction(actionFormOldValue);microstrategy.updateManager.acknowledgeRequest();microstrategy.updateManager.add(fixStateActions,true);}function isFlashMHTFormat(){return microstrategy.FlashExportFileFormat=="0";}function panelHandler(sObjName,openToolTip,openImg,closeToolTip,closeImg){var oTitleArray;var oContentArray;var oImageArray;var i;var j;var displayed;oContentArray=document.getElementsByName(sObjName+"_Content");function isDisplayed(vObject){var obj=getObj(vObject);if(bIsIE4||bIsW3C){return((obj.style.visibility=="visible")||(obj.style.visibility.length==0));}else{return((document.layers[obj.id].visibility=="show")||(document.layers[obj.id].visibility.length==0));}}if(oContentArray.length>0){displayed=(isDisplayed(oContentArray.item(0)));}for(i=0;i<oContentArray.length;i++){if(displayed){if(bIsIE4||bIsW3C){oContentArray.item(i).style.display="none";oContentArray.item(i).style.visibility="hidden";}else{document.layers[oContentArray.item(i).id].visibility="hide";}oTitleArray=document.getElementsByName(sObjName);for(j=0;j<oTitleArray.length;j++){oTitleArray.item(j).title=openToolTip;}oImageArray=document.getElementsByName(sObjName+"_Image");for(j=0;j<oImageArray.length;j++){oImageArray.item(j).src=openImg;oImageArray.item(j).alt=openToolTip;oImageArray.item(j).title=openToolTip;}}else{if(bIsIE4||bIsW3C){oContentArray.item(i).style.display="block";oContentArray.item(i).style.visibility="visible";}else{document.layers[oContentArray.item(i).id].visibility="show";}oTitleArray=document.getElementsByName(sObjName);for(j=0;j<oTitleArray.length;j++){oTitleArray.item(j).title=closeToolTip;}oImageArray=document.getElementsByName(sObjName+"_Image");for(j=0;j<oImageArray.length;j++){oImageArray.item(j).src=closeImg;oImageArray.item(j).alt=closeToolTip;oImageArray.item(j).title=closeToolTip;}}}var isUpdateManagerAvailable=false;try{isUpdateManagerAvailable=(mstrUpdateManager!=null);}catch(localerr){}if(oContentArray.length>0&&isUpdateManagerAvailable){if(microstrategy){microstrategy.updateBrowserSetting(sObjName,(displayed)?"0":"1");}}}function getRecentObjectsMenu(recentsPopup){if(recentsPopup){recentsPopup.innerHTML=(function(){var recentsHTML="<div class='mstrMenuContent' ty='content'>";var recentObjects=microstrategy.handleRecentObjects(),i;var numRecentObjects=Math.min(recentObjects.length,10);for(i=0;i<numRecentObjects;i++){var imgSrc="";if(mstrConfig.showPreviews){imgSrc=(recentObjects[i].recoveryInfo.imgData!==undefined)?"data:image/png;base64,"+recentObjects[i].recoveryInfo.imgData:"";}if(recentObjects[i].lastRecovered!==undefined&&recentObjects[i].lastRecovered===true){recentsHTML+="<span class='mstrMenuItem' style = 'border-bottom: 1px solid #D6D6D6;'><span class='mstrIcon-lv mstrIcon-recover'></span><a class='mstrLink' href="+recentObjects[i].recoveryURL+">"+microstrategy.descriptors.getDescriptor("11866").replace("#",recentObjects[i].recoveryName)+"</a></span>";}else{recentsHTML+='<span class="mstrMenuItem mstr-recent-item"><span class="mstrIcon-lv '+recentObjects[i].iconClass+'"></span><a class="mstrLink" href="'+recentObjects[i].recoveryURL+'">'+recentObjects[i].recoveryName+"</a>";if(imgSrc!==""){recentsHTML+='<img class = "img-preview" src = "'+imgSrc+'" height="200" width="250" style="zindex: 100; position: absolute;">';}recentsHTML+="</span>";}}if(numRecentObjects==0){recentsHTML+="<span class='mstrMenuItem'><a>"+microstrategy.descriptors.getDescriptor("14356")+"</a></span>";}recentsHTML+="</div>";return recentsHTML;})();}return recentsPopup;}function toggleRecentsPopup(forceHide,recentsPopup,width,top){if(recentsPopup){itemNodes=recentsPopup.getElementsByTagName("span");if(itemNodes.length===0){return false;}itemHeight=itemNodes[0].offsetHeight,itemCount=itemNodes.length,makeVisible=isNaN(parseInt(recentsPopup.style.left,10));if(makeVisible&&!forceHide){recentsPopup.style.visibility="visible";recentsPopup.style.left=width+"px";recentsPopup.style.top=top+"px";}else{recentsPopup.style.visibility="hidden";recentsPopup.style.left="";}}}function submitCreateIVELink(Anchor,event){var isHTML5=!microstrategy.isFeatureAvailable("flashvi"),folderBone=microstrategy.bones.folderAllModes;if(isHTML5&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}if(isHTML5&&folderBone&&folderBone.folderId){Anchor.href=replaceURLParameter(Anchor.href,"parentFolderId",folderBone.folderId);}return submitLink(Anchor,event);}function submitCreateRptAndRWDLink(Anchor,event){var folderBone=microstrategy.bones.folderAllModes;if(folderBone&&folderBone.folderId){Anchor.href=replaceURLParameter(Anchor.href,"parentFolderId",folderBone.folderId);}return submitLink(Anchor,event);}function encodeBrowsePathElement(elem){if(elem){elem+="";return elem.replace(/~|,|%/g,function tokenRep(token){switch(token){case"~":return"%7E";case",":return"%2C";case"%":return"%25";default:return token;}});}return"";}function updateSalesForceLogoutIframe(src){var ifmID="logoutSalesForce";var ifm=document.getElementById(ifmID);if(!ifm){ifm=document.createElement("IFRAME");ifm.id=ifmID;document.body.appendChild(ifm);ifm.style.display="none";}ifm.src=src;}function rrISIE7(){return mstr.utils.ISIE7;}function removeCssClass(el,s){if(!el){return ;}if(s.constructor!==Array){s=[s];}var cls=" "+(el.className||"")+" ";for(var i=0,len=s.length;i<len;i++){cls=cls.replace(new RegExp("\\s"+s[i]+"\\s","g")," ");}el.className=trimString(cls);}function addCssClass(el,s){if(!el){return ;}if(s.constructor!==Array){s=[s];}var cls=el.className||"",start=" "+cls+" ",bAdded=false;for(var i=0,len=s.length;i<len;i++){var c=s[i];if(!start.match(new RegExp("\\s"+c+"\\s"))){cls+=" "+c;bAdded=true;}}if(bAdded){el.className=trimString(cls);}}function trimString(s){return(s&&s.replace)?s.replace(/^\s+/,"").replace(/\s+$/,""):s;}function getResourcePathWithVersion(resourcePath){return resourcePath+((window.mstrConfig&&mstrConfig.webVersion)?"?v="+mstrConfig.webVersion:"");}var mstrInterfacePlugin={init:function(){var logo=document.getElementById("mstrStarburst"),servletName=microstrategy.servletName,href;if(logo){logo.title="";var logoSmall=document.getElementById("mstrLogo");logoMenu=document.getElementById("mstrLogoMenu");if(logoSmall){logoSmall.title="";}if(microstrategy.hasSession&&!mstrApp.isAdminPage&&logo.getAttribute("_isstatic")!="true"){href=logo.href;logo.setAttribute("_href",href);var event=microstrategy.menuHover?"mouseover":"click";if(logoMenu){logoMenu["on"+event]=microstrategy.showShortcutsList;}}}}};
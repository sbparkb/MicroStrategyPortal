mstrDocSectionImpl.prototype=new mstrBoneImpl();mstrDocSectionImpl.prototype.path="";mstrDocSectionImpl.prototype.verifiedPath="";mstrDocSectionImpl.prototype.sibs=null;mstrDocSectionImpl.prototype.prevSec=null;mstrDocSectionImpl.prototype.currentSec=null;mstrDocSectionImpl.prototype.isCollapsed=false;mstrDocSectionImpl.prototype.isDetails=false;mstrDocSectionImpl.prototype.isHorizontal=false;mstrDocSectionImpl.prototype.isBeginHorizontal=false;mstrDocSectionImpl.prototype.prevRuler=null;mstrDocSectionImpl.prototype.groupID=null;mstrDocSectionImpl.prototype.onload=function(e){try{this.initBone();this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.sibs=document.getElementsByName(this.id);this.initSection();return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocSectionImpl.prototype.syncPosition=function(){try{for(var id in this.subsections){if(this.subsections[id].syncPosition){this.subsections[id].syncPosition();}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocSectionImpl.prototype.onmousedown=function(e){try{if(!e){e=window.event;}var src=getEventTarget(e);var docviewer=this.parentBone.parentBone;var updateManager=docviewer.updateManager;var format=mstrFormatObject;var actionCollection=[];this.currentSec=microstrategy.findAncestorWithAtt(src,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION);var mstrSrc=microstrategy.eventManager.getSource(e);if(!docviewer.isEditableViewModeEplus()){return ;}if(this.isHorizontal){if(!this.isBeginHorizontal){this.prevSec=this.currentSec.parentNode.previousSibling.firstChild;}}else{var i=0;if(this.currentSec){var doc=this.parentBone.elem;for(i=0;i<doc.childNodes.length;i++){if(this.currentSec==doc.childNodes[i]){break;}}}if(i>0){this.prevSec=this.parentBone.elem.childNodes[i-1];}if(microstrategy.styleObj.getAttValue(this.prevSec,microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_DOC_SECTION&&microstrategy.styleObj.getAttValue(this.prevSec,microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_PARENT_HORIZONTAL_CONTAINER){var hContainer=microstrategy.findChildWithAtt(this.prevSec,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(hContainer){var hContainerBone=microstrategy.findBone(hContainer);this.prevSec=hContainerBone.getLastNonCollapsedSection();}}}var firstSubElem=microstrategy.findChildWithAtt(this.currentSec,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);if(src.tagName=="IMG"){var name=src.src.substr(src.src.lastIndexOf("/")+1);var collapse=(name=="treeCollapse.gif")?"0":"-1";this.toggleSections(collapse,src);var oldValue,newValue;if(collapse=="-1"){newValue="-1";oldValue="0";}else{newValue="0";oldValue="-1";}if(updateManager){var cachedArray={};cachedArray.source=src;var obj=document.getElementById(this.id);var data=obj.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.expanded[mstrFormatObject.PROP_SET]+mstrUpdateManager.UNIT_SEPARATOR+format.expanded[mstrFormatObject.PROP_NAME]+mstrUpdateManager.UNIT_SEPARATOR;actionCollection.push(updateManager.createActionObject(obj,mstrUpdateManager.EDIT_PROPS,docviewer.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data+newValue+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,data+oldValue+mstrUpdateManager.ITEM_SEPARATOR],cachedArray));for(var section in this.subsections){obj=this.subsections[section].elem;data=this.subsections[section].id+mstrUpdateManager.UNIT_SEPARATOR+format.expanded[mstrFormatObject.PROP_SET]+mstrUpdateManager.UNIT_SEPARATOR+format.expanded[mstrFormatObject.PROP_NAME]+mstrUpdateManager.UNIT_SEPARATOR;actionCollection.push(updateManager.createActionObject(obj,mstrUpdateManager.EDIT_PROPS,docviewer.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data+newValue+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,data+oldValue+mstrUpdateManager.ITEM_SEPARATOR],cachedArray));}updateManager.add(actionCollection,true);}if(firstSubElem){this.parentBone.selections.addSubSection(firstSubElem);}}else{if(mstrSrc&&mstrSrc.button==2){if(firstSubElem){var firstSubBone=microstrategy.findBone(firstSubElem);if(firstSubBone){firstSubBone.onmousedown(e);}}}else{var validDrag=false;if(this.isHorizontal){if(!this.isBeginHorizontal){validDrag=true;}}else{if(this.currentSec.previousSibling!=this.currentSec.parentNode.firstChild){validDrag=true;}}if(validDrag){var newSrc=microstrategy.findAncestorWithAtt(src,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);if(newSrc){if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondragstart");this.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondragstart(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}}}if(firstSubElem){this.parentBone.selections.addSubSection(firstSubElem);}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocSectionImpl.prototype.ondragstart=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);if(this.currentSec){var doc=this.parentBone.elem;var conList=microstrategy.objectListFind(this.prevSec,["DIV"],microstrategy.OBJTYPE_DOC_SUBSECTION_CONTAINER);if(conList==null||conList.length==0){return true;}var con=conList[conList.length-1];this.prevSubElem=con.lastChild;this.prevRuler=con.firstChild;this.prevSubBone=microstrategy.findBone(this.prevSubElem);if(this.prevSubBone){if(this.isHorizontal){this.prevSubBone.oldwidth=getObjWidth(this.prevSubElem);this.prevSubBone.oldCanGrowHorizontal=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);this.prevSubBone.oldCanShrinkHorizontal=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);}else{this.prevSubBone.oldHeight=getObjHeight(this.prevSubElem);this.prevSubBone.oldCanGrow=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_GROW);this.prevSubBone.oldCanShrink=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_SHRINK);}this.prevSubBone.oldHideIfEmpty=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);}if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondrag");this.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondragend(e); }");}this.ondrag(e);}}catch(err){microstrategy.errors.log(err);}return false;};mstrDocSectionImpl.prototype.ondrag=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);if(this.isHorizontal){var scrollLeft=0;if(this.prevSubElem){var posX=lMouseX+scrollLeft-getObjSumLeft(this.currentSec);var n=getObjWidth(this.prevSubElem)+posX;if(n>=0){this.prevSubElem.style.width=n+"px";}}}else{var scrollTop=this.parentBone.parentBone.elem.scrollTop;if(this.prevSubElem){var posY=lMouseY+scrollTop-getObjSumTop(this.currentSec);var n=getObjHeight(this.prevSubElem)+posY;if(n>=0){if(this.prevRuler){this.prevRuler.style.height=n+"px";}if(!this.prevSubBone.isHorizontal){this.prevSubElem.style.height=n+"px";}else{var hcCont=microstrategy.findAncestorWithAtt(this.prevSubElem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);hcCont.style.height=n+"px";var subSections=microstrategy.findChildrenWithAtt(hcCont,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);if(subSections){for(var i=0;i<subSections.length;i++){subSections[i].style.height=n+"px";}}}}}}}catch(err){microstrategy.errors.log(err);}return false;};mstrDocSectionImpl.prototype.ondragend=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}if(this.isHorizontal){this.prevSubBone.resizeWidth(getObjWidth(this.prevSubElem),true,null);}else{if(this.prevSubBone.isHorizontal){this.parentBone.resetHeightOfHorizontalSections(this.prevSubBone);}this.prevSubBone.resize(getObjHeight(this.prevSubElem),true,null);if(this.prevSubBone.isHorizontal){this.parentBone.synchHeightOfHorizontalSections(this.prevSubBone);}}var fa=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.parentBone.parentBone.formattingAttributes;var doHorizontal=this.isHorizontal&&this.prevSubBone.isHorizontal;var id=this.prevSubBone.id;if(fa&&id){if(doHorizontal){fa[id][microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL]=microstrategy.FALSE;fa[id][microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL]=microstrategy.FALSE;}else{if(this.prevSubBone.isHorizontal){var c=microstrategy.findAncestorWithAtt(this.prevSubBone.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(c){c.setAttribute(microstrategy.HTMLATTR_CAN_GROW,microstrategy.FALSE);c.setAttribute(microstrategy.HTMLATTR_CAN_SHRINK,microstrategy.FALSE);fa[id][microstrategy.HTMLATTR_HIDE_IF_EMPTY]=microstrategy.FALSE;}}else{fa[id][microstrategy.HTMLATTR_CAN_SHRINK]=microstrategy.FALSE;fa[id][microstrategy.HTMLATTR_CAN_GROW]=microstrategy.FALSE;fa[id][microstrategy.HTMLATTR_HIDE_IF_EMPTY]=microstrategy.FALSE;}}}this.onmouseup(e);}catch(err){microstrategy.errors.log(err);}return false;};mstrDocSectionImpl.prototype.onmouseup=function(e){try{if(typeof (mstr)!="undefined"){this.detachWinListener(this,"mousemove");this.detachWinListener(this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(err){microstrategy.errors.log(err);}return false;};mstrDocSectionImpl.prototype.toggleSections=function(collapse){try{var source=microstrategy.subObjectFind(this.elem,["IMG"],"cimg");if(collapse=="0"){for(var section in this.subsections){this.subsections[section].hide();}source.src=microstrategy.FOLDER_IMAGES+"treeExpand.gif";this.isCollapsed=true;}else{for(var section in this.subsections){this.subsections[section].show();}source.src=microstrategy.FOLDER_IMAGES+"treeCollapse.gif";this.isCollapsed=false;}if(this.parentBone.selections){this.parentBone.selections.clear();}}catch(err){microstrategy.errors.log(err);return false;}};mstrDocSectionImpl.prototype.initSection=function(){try{var treeImg=null;var docViewer=microstrategy.getViewerBone();if(docViewer.isEditableViewModeEplus()){treeImg=microstrategy.subObjectFind(this.elem,["IMG"],"cimg");}var hide=(treeImg!=null&&treeImg.src.indexOf("treeExpand.gif")>-1);this.isCollapsed=hide;var previousID="";this.subsectionLength=0;var subSections=this.parentBone.subSectionsInSection[this.id].split(",");this.groupID=microstrategy.styleObj.getAttValue(this.elem,"group");if(this.elem&&this.elem.childNodes){this.isBeginHorizontal=(microstrategy.styleObj.getAttValue(this.elem,microstrategy.HTMLATTR_IS_BEGIN_HORIZONTAL)=="-1");for(var i=0;i<subSections.length;i++){var id=subSections[i];if(id&&id!=""&&typeof (this.subsections[id])=="undefined"){var bone=new mstrFixedPanel(id);bone.parentBone=this;bone.path=this.path+".subsections['"+id+"']";if(bone.onload){bone.onload();}this.isDetails=bone.isDetails;this.isHorizontal=bone.isHorizontal;this.subsections[id]=bone;if(previousID!=""){this.subsections[previousID].nextSibling=id;}previousID=id;this.subsectionLength++;}}if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){if(hide){for(var section in this.subsections){this.subsections[section].hide();}}else{for(var section in this.subsections){this.subsections[section].show();}}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocSectionImpl.prototype.getRightMostPos=function(){try{var rightX=0;for(var sub in this.subsections){rightX=Math.max(this.subsections[sub].getRightMostPos(),rightX);}return rightX;}catch(err){microstrategy.errors.log(err);return -1;}};mstrDocSectionImpl.prototype.getSubsectionCount=function(){try{return this.subsectionLength;}catch(err){microstrategy.errors.log(err);return null;}};mstrDocSectionImpl.prototype.setCursor=function(newCursor){try{for(var i=0;i<this.sibs.length;i++){this.sibs[i].style.cursor=newCursor;}}catch(err){microstrategy.errors.log(err);}};mstrDocSectionImpl.prototype.getChildBone=function(obj){try{if(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){if(obj.getAttribute("id") in this.subsections&&this.subsections[obj.getAttribute("id")].isLoaded){return this.subsections[obj.getAttribute("id")];}}return null;}catch(err){microstrategy.errors.log(err);return null;}};function mstrDocSectionImpl(id){this.inherits=mstrBoneImpl;this.inherits(id);this.inherits=null;this.subsections={};return this;}
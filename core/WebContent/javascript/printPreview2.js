function splitRepeatCol(indexRow,indexCol,iRepeatRows,iRepeatCols,iTotalCols,px,bCheckForResize){var indexCell=indexCol;var splitCounter=0;var splitCellRows=new Array;var iColumnsBeforeCol=sumColumnCountForCell(oTable,indexRow,indexCol-1);var iCounter=0;var iCounterPrevious=0;for(var i=0;i<iColumnsBeforeCol;i++){iCounterPrevious=iCounter;iCounter+=util_parseSpan(oTRs[0].childNodes[i],1);if(iCounter>=iColumnsBeforeCol){break;}}var colHeaderBreaks=new Array;colHeaderBreaks[0]=i+1;for(i=1;i<iRepeatRows;i++){colHeaderBreaks[i]=null;}if(iCounter>iColumnsBeforeCol){splitCounter++;splitCellRows[splitCounter]=0;splitCell(0,colHeaderBreaks[0]-1,iColumnsBeforeCol-iCounterPrevious);if(bCheckForResize){if(getObjSumLeft(oTRs[0].childNodes[colHeaderBreaks[0]])>px){mergeCells(0,colHeaderBreaks[0]-1);indexCell-=iColumnsBeforeCol-iCounterPrevious;return(Array(indexCell,colHeaderBreaks));}}}var iTotalRows=oTRs.length;for(var row=iRepeatRows;row<iTotalRows;row++){iCounter=iRepeatCols;for(var col=oTRs[row].childNodes.length-(iTotalCols-iRepeatCols)-1;col>-1;col--){iCounter-=util_parseSpan(oTRs[row].childNodes[col],1);if(iCounter<=iColumnsBeforeCol){break;}}if(col<0){colHeaderBreaks[row]=iColumnsBeforeCol-iCounter;}else{colHeaderBreaks[row]=col;if(iCounter<iColumnsBeforeCol){splitCounter++;splitCellRows[splitCounter]=row;splitCell(row,col,iColumnsBeforeCol-iCounter);colHeaderBreaks[row]++;if(bCheckForResize){if(getObjSumLeft(oTRs[row].childNodes[col+1])>px){for(var x=1;x<=splitCounter;x++){mergeCells(splitCellRows[x],colHeaderBreaks[splitCellRows[x]]-1);}indexCell-=iColumnsBeforeCol-iCounter;break;}}}}}return(Array(indexCell,colHeaderBreaks));}function renderCOLTags(iRepeatRows,iRepeatCols,iTotalRows,iTotalCols,iHorizontalPageNum){var oCOLTags=oTable.getElementsByTagName("COL");if(!oCOLTags){return ;}if((!oCOLTags.length)||(oCOLTags.length==0)){return ;}if((iRepeatCols>0)&&(REPEAT_ROWHEADERS)){for(var i=0;i<iRepeatCols;i++){if(oCOLTags[i]){document.write('<COL STYLE="width: '+oCOLTags[i].style.width+';" >');}}}var indexRow=rowIndexForColumnBreaks;var indexFirstCell=0;if(iRepeatCols>0){if(indexRow>=iRepeatRows){indexFirstCell=firstNonRepeatCellInRow(indexRow,iRepeatCols,iTotalCols);}else{indexFirstCell=lastRepeatColHeaderInRow(oTable,indexRow)+1;}}var iStartIndex=-1;if(iHorizontalPageNum>1){iStartIndex=colPageBreaks[iHorizontalPageNum]+indexFirstCell;iStartIndex=getColumnNumberForCell(oTable,indexRow,iStartIndex)-1;}else{if((iRepeatCols>0)&&(REPEAT_ROWHEADERS)){iStartIndex=iRepeatCols;}else{iStartIndex=0;}}var iEndIndex=-1;if(colPageBreaks.length>iHorizontalPageNum+1){iEndIndex=colPageBreaks[iHorizontalPageNum+1]+indexFirstCell;iEndIndex=getColumnNumberForCell(oTable,indexRow,iEndIndex)-1;}else{iEndIndex=oCOLTags.length;}for(var i=iStartIndex;i<iEndIndex;i++){if(oCOLTags[i]){document.write('<COL STYLE="width: '+oCOLTags[i].style.width+';" >');}}return ;}function getColumnNumberForCell(oT,iRow,iCell){var iColumnNumber=0;if(!oT){return(0);}if(!oT.rows){return(0);}if(oT.rows.length<iRow+1){return(0);}var iColumnCount=0;var oCells=oT.rows[iRow].cells;var iLastIndex=oCells.length-1;for(var i=iCell;i<=iLastIndex;i++){iColumnCount+=util_parseSpan(oCells[i],1);}var iTotalColumns=0;oCells=oT.rows[0].cells;iLastIndex=oCells.length-1;for(var i=0;i<=iLastIndex;i++){iTotalColumns+=util_parseSpan(oCells[i],1);}iColumnNumber=iTotalColumns-iColumnCount+1;return(iColumnNumber);}function renderRows(iHorizontalPageNum,iVerticalPageNum,iRepeatRows,iRepeatCols,iTotalRows,iTotalCols){var indexLastCol;var indexLastRow;var oTDs=null;renderCOLTags(iRepeatRows,iRepeatCols,iTotalRows,iTotalCols,iHorizontalPageNum);for(var row=0;row<iRepeatRows;row++){oTDs=oTRs[row].childNodes;document.write('<TR STYLE="height: '+oTRs[row].style.height+'">');indexLastCol=colHeaderPageBreaks[1][row]-1;if(indexLastCol>-1){for(var col=0;col<=indexLastCol;col++){document.write(outerHTML(oTDs[col]));}}if(colHeaderPageBreaks[iHorizontalPageNum+1]){indexLastCol=colHeaderPageBreaks[iHorizontalPageNum+1][row]-1;}else{indexLastCol=oTDs.length-1;}if(indexLastCol>-1){for(var col=colHeaderPageBreaks[iHorizontalPageNum][row];col<=indexLastCol;col++){document.write(outerHTML(oTDs[col]));}}document.write("</TR>");}if(rowPageBreaks[iVerticalPageNum+1]){indexLastRow=rowPageBreaks[iVerticalPageNum+1]-1;}else{indexLastRow=iTotalRows-1;}var indexFirstRow=rowPageBreaks[iVerticalPageNum];if(indexFirstRow<iRepeatRows){indexFirstRow=iRepeatRows;}for(var row=indexFirstRow;row<=indexLastRow;row++){oTDs=oTRs[row].childNodes;document.write('<TR STYLE="height:'+oTRs[row].style.height+'">');var col=0;indexLastCol=firstNonRepeatCellInRow(row,iRepeatCols,iTotalCols);for(col=0;col<indexLastCol;col++){if(isNonRepeatCell(oTDs[col])){break;}document.write(outerHTML(oTDs[col]));}if(colPageBreaks.length>iHorizontalPageNum+1){indexLastCol=colPageBreaks[iHorizontalPageNum+1]-1+col;}else{indexLastCol=oTDs.length-1;}for(var dataCol=colPageBreaks[iHorizontalPageNum]+col;dataCol<=indexLastCol;dataCol++){document.write(outerHTML(oTDs[dataCol]));}document.write("</TR>");}return ;}function renderRows2(iHorizontalPageNum,iVerticalPageNum,iRepeatRows,iRepeatCols,iTotalRows,iTotalCols){var iStartRow1=0;var iEndRow1=-1;var iStartRow2=0;var iEndRow2=-1;renderCOLTags(iRepeatRows,iRepeatCols,iTotalRows,iTotalCols,iHorizontalPageNum);var iRowPageBreaksLength=rowPageBreaks.length;var iColPageBreaksLength=colPageBreaks.length;var iColHeaderPageBreaksLength=colHeaderPageBreaks.length;iStartRow1=rowPageBreaks[iVerticalPageNum];if(iRowPageBreaksLength>iVerticalPageNum+1){iEndRow1=rowPageBreaks[iVerticalPageNum+1]-1;}else{iEndRow1=iTotalRows-1;}if(iEndRow1>iRepeatRows-1){iEndRow2=iEndRow1;iEndRow1=iRepeatRows-1;iStartRow2=iRepeatRows;}if(iStartRow1>iRepeatRows-1){iStartRow2=iStartRow1;iStartRow1=0;iEndRow1=-1;}if(REPEAT_COLUMNHEADERS||(iVerticalPageNum==1)){iStartRow1=0;iEndRow1=iRepeatRows-1;}var oTDs=null;for(var row=iStartRow1;row<=iEndRow1;row++){oTDs=oTRs[row].childNodes;document.write('<TR STYLE="height: '+oTRs[row].style.height+'" >');var iStartCol=colHeaderPageBreaks[iHorizontalPageNum][row];var iEndCol=null;if(iColHeaderPageBreaksLength>iHorizontalPageNum+1){iEndCol=colHeaderPageBreaks[iHorizontalPageNum+1][row];if((iEndCol!=null)&&(iEndCol>-1)){iEndCol--;}}else{iEndCol=oTDs.length-1;}if((iEndCol!=null)&&((iStartCol==null)||(iStartCol<0))){iStartCol=0;}if((iStartCol!=null)&&(iStartCol>-1)&&(iEndCol>-1)){for(var col=iStartCol;col<=iEndCol;col++){document.write(outerHTML(oTDs[col]));}}document.write("</TR>");}for(var row=iStartRow2;row<=iEndRow2;row++){oTDs=oTRs[row].childNodes;document.write('<TR STYLE="height: '+oTRs[row].style.height+'" >');var iStartCol=colPageBreaks[iHorizontalPageNum];if(iStartCol<0){iStartCol=colHeaderPageBreaks[iHorizontalPageNum][row];}else{iStartCol+=firstNonRepeatCellInRow(row,iRepeatCols,iTotalCols);}var iEndCol=null;if(iColPageBreaksLength>iHorizontalPageNum+1){if(colPageBreaks[iHorizontalPageNum+1]<0){iEndCol=colHeaderPageBreaks[iHorizontalPageNum+1][row];if((iEndCol!=null)&&(iEndCol>-1)){iEndCol--;}}else{iEndCol=colPageBreaks[iHorizontalPageNum+1]-1+firstNonRepeatCellInRow(row,iRepeatCols,iTotalCols);}}else{iEndCol=oTDs.length-1;}if((iEndCol!=null)&&((iStartCol==null)||(iStartCol<0))){iStartCol=0;}if((iStartCol!=null)&&(iStartCol>-1)&&(iEndCol>-1)){for(var col=iStartCol;col<=iEndCol;col++){document.write(outerHTML(oTDs[col]));}}document.write("</TR>");}return ;}function renderGridCopy(){var szTableAttributes=' CELLSPACING="0" CLASS="'+oTable.className+'" WIDTH="'+getObjWidth(oTable)+'" HEIGHT="'+getObjHeight(oTable)+'" ';if((oTable.getAttribute)&&(oTable.getAttribute("BORDER"))){szTableAttributes+=' BORDER="'+oTable.getAttribute("BORDER")+'" ';}szTableAttributes+='STYLE="font-size: '+iZoomFactorFTP+'em;"';document.write("<TABLE "+szTableAttributes+">");document.write(oTable.innerHTML);document.write("</TABLE>");return ;}function renderGridPage(iTotalPageNum,iRepeatRows,iRepeatCols,iTotalRows,iTotalCols,lTableID,pxLeft,pxTop,pxTableHeight,pxTableWidth){var iVerticalPageNum=1;var iHorizontalPageNum=1;if(PAGE_ORDER_VERTICAL){iHorizontalPageNum=Math.ceil(iTotalPageNum/(rowPageBreaks.length-1));iVerticalPageNum=parseInt(iTotalPageNum%(rowPageBreaks.length-1));if(iVerticalPageNum==0){iVerticalPageNum=(rowPageBreaks.length-1);}}else{iVerticalPageNum=Math.ceil(iTotalPageNum/(colPageBreaks.length-1));iHorizontalPageNum=parseInt(iTotalPageNum%(colPageBreaks.length-1));if(iHorizontalPageNum==0){iHorizontalPageNum=(colPageBreaks.length-1);}}var indexLastRow,indexLastCol;if(colPageBreaksLeft[iHorizontalPageNum+1]){var pxWidth=colPageBreaksLeft[iHorizontalPageNum+1]-colPageBreaksLeft[iHorizontalPageNum];}else{var pxWidth=colPageBreaksLeft[0]+pxTableWidth-colPageBreaksLeft[iHorizontalPageNum];}if(REPEAT_ROWHEADERS){pxWidth+=colPageBreaksLeft[1]-colPageBreaksLeft[0];}if(rowPageBreaksTop[iVerticalPageNum+1]){var pxHeight=rowPageBreaksTop[iVerticalPageNum+1]-rowPageBreaksTop[iVerticalPageNum];}else{var pxHeight=rowPageBreaksTop[0]+pxTableHeight-rowPageBreaksTop[iVerticalPageNum];}if(REPEAT_COLUMNHEADERS){pxHeight+=rowPageBreaksTop[1]-rowPageBreaksTop[0];}var szTableAttributes='WIDTH="'+pxWidth+'" HEIGHT="'+pxHeight+'" CELLSPACING="0" CLASS="'+oTable.className+'" ';if(FIT_TO_PAGE_VERTICAL||FIT_TO_PAGE_HORIZONTAL){szTableAttributes+='STYLE="font-size: '+iZoomFactorFTP+'em;"';}else{if(ZOOM_FONTS!=DEFAULT_FONT_SIZE_EM*100){szTableAttributes+='STYLE="font-size: '+(ZOOM_FONTS/100)+'em;"';}}if((oTable.getAttribute)&&(oTable.getAttribute("BORDER"))){szTableAttributes+=' BORDER="'+oTable.getAttribute("BORDER")+'" ';}if((oTable.style.tableLayout)&&(oTable.style.tableLayout=="fixed")){szTableAttributes+=' STYLE="table-layout: fixed" ';}document.write('<TABLE ID="table'+lTableID+'" '+szTableAttributes+">");if(REPEAT_ROWHEADERS){renderRows(iHorizontalPageNum,iVerticalPageNum,iRepeatRows,iRepeatCols,iTotalRows,iTotalCols);}else{renderRows2(iHorizontalPageNum,iVerticalPageNum,iRepeatRows,iRepeatCols,iTotalRows,iTotalCols);}document.write("</TABLE>");return ;}function getRepeatRows(){var iTotalRows=oTRs.length;var iRepeatRows=0;var pxRepeatRowsHeight=0;var sFoundAttr="";if(oTRs[iTotalRows-1].getAttribute("o")){sFoundAttr="o";}if(sFoundAttr==""){if(oTRs[iTotalRows-1].getAttribute("level")){sFoundAttr="level";}}if(sFoundAttr!=""){for(var i=0;i<iTotalRows;i++){if(oTRs[i].getAttribute(sFoundAttr)){iRepeatRows=i;pxRepeatRowsHeight=getObjSumTop(oTRs[i])-getObjSumTop(oTable);break;}}}else{iRepeatRows=iTotalRows;pxRepeatRowsHeight=getObjHeight(oTable);}return(Array(iRepeatRows,iTotalRows,pxRepeatRowsHeight));}function getRepeatCols(iRepeatRows){var iRepeatCols=0;var pxRepeatColsWidth=0;var indexLastRepeatCell=lastRepeatColHeaderInRow(oTable,0);iRepeatCols=sumColumnCountForCell(oTable,0,indexLastRepeatCell);var iTotalCols=oTRs[0].childNodes.length;if(indexLastRepeatCell<iTotalCols-1){pxRepeatColsWidth=getObjSumLeft(oTRs[0].childNodes[indexLastRepeatCell+1]);}else{pxRepeatColsWidth=getObjWidth(oTable);}iTotalCols=sumColumnCountForCell(oTable,0,iTotalCols-1);return(Array(iRepeatCols,iTotalCols,pxRepeatColsWidth));}function firstNonRepeatCellInRow(indexRow,iRepeatCols,iTotalCols){var iResult=oTRs[indexRow].childNodes.length-(iTotalCols-iRepeatCols);if(iResult>-1){return(iResult);}else{return(0);}}function isNonRepeatCell(oCell){var szClass=oCell.className;if(!szClass){szClass=oCell.getAttribute("CLASS");}if((szClass=="zMV")||(szClass=="zRowValueTotals")){return(true);}return(false);}function columnHeaderIndexForCell(indexRow,indexCell,indexSearchRow,iTotalCols,bSupportRowSpans){var lHeaderColumnNumber;var lCellColumnNumber=iTotalCols-((oTRs[indexRow].childNodes.length-1)-indexCell);var col=-1;var oTR=oTRs[indexSearchRow];var lColumnCounter=iTotalCols;for(var i=oTR.childNodes.length-1;i>-1;i--){lColumnCounter-=(util_parseSpan(oTR.childNodes[i],1)-1);if(lColumnCounter<=lCellColumnNumber){lHeaderColumnNumber=lColumnCounter;col=i;break;}lColumnCounter--;}return(Array(col,lHeaderColumnNumber,lCellColumnNumber));}function firstCellBeyond(px,indexRow,indexStartCell,indexLastCell,bDirection){if(bDirection){for(var i=indexStartCell;i<=indexLastCell;i++){if(getObjSumLeft(oTRs[indexRow].childNodes[i])>px){return(i-1);}}var lLeft=0;if(oTRs[indexRow].length-1>indexLastCell){lLeft=getObjSumLeft(oTRs[indexRow].childNodes[indexLastCell+1]);}else{lLeft=getObjWidth(oTable);}if(lLeft>px){return(indexLastCell);}return(indexLastCell+1);}else{for(var i=indexStartCell;i>=indexLastCell;i--){if(getObjSumLeft(oTRs[indexRow].childNodes[i])<px){return(i);}}return(indexLastCell-1);}}function firstRowBeyond(px,indexStartRow,indexLastRow,bDirection){if(bDirection){for(var i=indexStartRow;i<=indexLastRow;i++){if(getObjSumTop(oTRs[i])>px){return(i-1);}}if(getObjSumTop(oTRs[indexLastRow])+getObjHeight(oTRs[indexLastRow])>px){return(indexLastRow);}return(indexLastRow+1);}else{for(var i=indexStartRow;i>=indexLastRow;i--){if(getObjSumTop(oTRs[i])<px){return(i);}}return(indexLastRow-1);}}function firstLongerRowAbove(indexStartRow,indexLastRow,iRowHeaderCount,iRepeatCols,iTotalCols){for(var i=indexStartRow;i>=indexLastRow;i--){var indexLastHeaderCell=firstNonRepeatCellInRow(i,iRepeatCols,iTotalCols)-1;if(indexLastHeaderCell>-1){var iCounter=sumColumnCountForCell(oTable,i,indexLastHeaderCell);if(iCounter>iRowHeaderCount){return(i);break;}}}return(-1);}function breakRowHeaders(indexRow,iRepeatRows,iRepeatCols,iTotalCols,px,bCheckForResize){var indexRowAbove=0;var breakCounter=-1;var splitCounter=0;var splitCells=new Array;var newCells=new Array;var oFirstTD=oTRs[indexRow].childNodes[0];var numTDs=oTRs[indexRow].childNodes.length;var indexLastHeaderCell=firstNonRepeatCellInRow(indexRow,iRepeatCols,iTotalCols)-1;var iRowHeaderCounter=sumColumnCountForCell(oTable,indexRow,indexLastHeaderCell);if(iRowHeaderCounter<iRepeatCols){do{var indexHeaderRow=firstLongerRowAbove(indexRow,iRepeatRows,iRowHeaderCounter,iRepeatCols,iTotalCols);if(indexHeaderRow<0){break;}indexLastHeaderCell=firstNonRepeatCellInRow(indexHeaderRow,iRepeatCols,iTotalCols)-1;var iTempRowHeaderCounter=0;do{iTempRowHeaderCounter+=util_parseSpan(oTRs[indexHeaderRow].childNodes[indexLastHeaderCell],1);if(iTempRowHeaderCounter>iRowHeaderCounter){break;}indexLastHeaderCell--;}while(indexLastHeaderCell>-1);if(indexLastHeaderCell>-1){for(var indexCell=indexLastHeaderCell;indexCell>-1;indexCell--){splitCounter++;splitCells[splitCounter]=oTRs[indexHeaderRow].childNodes[indexCell];splitCellVertical(indexHeaderRow,indexCell,indexRow-indexHeaderRow,indexRow,0);newCells[splitCounter]=oTRs[indexRow].childNodes[0];if(bCheckForResize){if(getObjSumTop(oTRs[indexRow])>px){for(var j=1;j<=splitCounter;j++){mergeCellsVertical(splitCells[j]);oTRs[newCells[j].parentNode.rowIndex].deleteCell(newCells[j].cellIndex);}splitCounter=0;indexRow=indexHeaderRow;oFirstTD=null;newCells=null;return(Array(indexRow,splitCounter,newCells));break;}}}iRowHeaderCounter+=sumColumnCountForCell(oTable,indexRow,indexLastHeaderCell);}}while(iRowHeaderCounter<iRepeatCols);}oFirstTD=null;return(Array(indexRow,splitCounter,newCells));}function copyNode(oOriginal,oDuplicate){oDuplicate.innerHTML=oOriginal.innerHTML;var iCount=oOriginal.attributes.length;for(var i=0;i<iCount;i++){oDuplicate.setAttribute(oOriginal.attributes[i].name,oOriginal.attributes[i].nodeValue,0);}if(oOriginal.className){oDuplicate.className=oOriginal.className;}return ;}function getFirstNonRepeatColumnHeaders(iRepeatRows,iRepeatCols,bRepeatColHeaders){var resultArray=new Array;var iRowSpannedColumns=0;if(bRepeatColHeaders){for(var row=0;row<iRepeatRows;row++){resultArray[row]=lastRepeatColHeaderInRow(oTable,row)+1;}}else{resultArray[0]=0;for(var row=1;row<iRepeatRows;row++){resultArray[row]=null;}}return(resultArray);}function adjustColBreaksInHeaders(iPage,iCountCells,newCells){for(var iHPage=1;iHPage<=colPageBreaks.length;iHPage++){if(colPageBreaks[iHPage]<0){for(var i=1;i<=iCountCells;i++){var row=newCells[i].parentNode.rowIndex;if(colHeaderPageBreaks[iHPage][row]!=null){colHeaderPageBreaks[iHPage][row]++;}}}}}function getRowBreaks(iRepeatRows,iRepeatCols,iTotalRows,iTotalCols,pxHeightLimit){var indexRow=iRepeatRows;if(iRepeatRows==iTotalRows){indexRow=0;}var iPage=1;var px=0;rowPageBreaks=new Array;rowPageBreaks[1]=indexRow;rowPageBreaksTop=new Array;rowPageBreaksTop[0]=getObjSumTop(oTable);rowPageBreaksTop[1]=getObjSumTop(oTRs[indexRow]);rowHeaderPageBreaks=new Array;do{px=getObjSumTop(oTRs[indexRow])+pxHeightLimit;indexRow=firstRowBeyond(px,indexRow+1,iTotalRows-1,true);if(indexRow>iTotalRows-1){break;}iPage++;rowPageBreaks[iPage]=indexRow;rowPageBreaksTop[iPage]=getObjSumTop(oTRs[indexRow]);var rowHeaderIndices;var bContinue=false;do{bContinue=false;var resultArray=breakRowHeaders(indexRow,iRepeatRows,iRepeatCols,iTotalCols,px,true);indexRow=resultArray[0];if(indexRow<rowPageBreaks[iPage]){if(indexRow<=rowPageBreaks[iPage-1]){indexRow=rowPageBreaks[iPage-1]+1;rowPageBreaks[iPage]=indexRow;rowPageBreaksTop[iPage]=getObjSumTop(oTRs[indexRow]);resultArray=breakRowHeaders(indexRow,iRepeatRows,iRepeatCols,iTotalCols,0,false);indexRow=resultArray[0];if(resultArray[1]>0){adjustColBreaksInHeaders(iPage,resultArray[1],resultArray[2]);}}else{rowPageBreaks[iPage]=indexRow;rowPageBreaksTop[iPage]=getObjSumTop(oTRs[indexRow]);bContinue=true;}}else{if(resultArray[1]>0){adjustColBreaksInHeaders(iPage,resultArray[1],resultArray[2]);}}}while(bContinue);rowHeaderPageBreaks[iPage]=rowHeaderIndices;}while((indexRow<iTotalRows)&&(indexRow>-1));return ;}function splitCell(rowIndex,cellIndex,firstColSpan){var iColspan=util_parseSpan(oTRs[rowIndex].cells[cellIndex],1);if(iColspan<2){return(false);}var oCell=oTRs[rowIndex].insertCell(cellIndex+1);if(oCell){copyNode(oTRs[rowIndex].cells[cellIndex],oCell);oCell.setAttribute("COLSPAN",iColspan-firstColSpan,0);oTRs[rowIndex].cells[cellIndex].setAttribute("COLSPAN",firstColSpan,0);var iRowSpan=util_parseRowSpan(oTRs[rowIndex].cells[cellIndex],1);if(iRowSpan>1){oCell.setAttribute("ROWSPAN",iRowSpan,0);}return(true);}return(false);}function mergeCells(rowIndex,cellIndex){var iColspan1=util_parseSpan(oTRs[rowIndex].cells[cellIndex],1);var iColspan2=util_parseSpan(oTRs[rowIndex].cells[cellIndex+1],1);oTRs[rowIndex].deleteCell(cellIndex+1);oTRs[rowIndex].cells[cellIndex].setAttribute("COLSPAN",iColspan1+iColspan2,0);return(true);}function splitCellVertical(rowIndex,cellIndex,firstRowSpan,indexRow2,indexCell2){var ispan=util_parseRowSpan(oTRs[rowIndex].cells[cellIndex],1);oTRs[rowIndex].cells[cellIndex].setAttribute("OLDROWSPAN",ispan,0);oTRs[rowIndex].cells[cellIndex].setAttribute("ROWSPAN",firstRowSpan,0);var oNewCell=oTRs[indexRow2].insertCell(indexCell2);copyNode(oTRs[rowIndex].cells[cellIndex],oNewCell);oNewCell.setAttribute("ROWSPAN",ispan-firstRowSpan,0);var iColSpan=util_parseSpan(oTRs[rowIndex].cells[cellIndex],1);if(iColSpan>1){oNewCell.setAttribute("COLSPAN",iColSpan,0);}return(ispan-firstRowSpan);}function mergeCellsVertical(oCell){var iOldRowSpan=oCell.getAttribute("OLDROWSPAN");if(!iOldRowSpan){iOldRowSpan=1;}oCell.setAttribute("ROWSPAN",iOldRowSpan,0);return(true);}function util_parseSpan(oTD,defaultVal){var iColspan=oTD.getAttribute("COLSPAN");if((iColspan)&&(!isNaN(parseInt(iColspan)))){return(parseInt(iColspan));}return(defaultVal);}function util_parseRowSpan(oTD,defaultVal){var iSpan=oTD.getAttribute("ROWSPAN");if((iSpan)&&(!isNaN(parseInt(iSpan)))){return(parseInt(iSpan));}return(defaultVal);}
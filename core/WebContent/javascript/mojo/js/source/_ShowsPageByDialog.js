(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Button","mstrmojo.android._HasMobileSelectBoxDialog");mstrmojo.requiresDescs(221,1442,5136);var $ARR=mstrmojo.array,$BTN=mstrmojo.Button.newAndroidButton,$HASH=mstrmojo.hash;mstrmojo._ShowsPageByDialog=mstrmojo.provide("mstrmojo._ShowsPageByDialog",$HASH.copy(mstrmojo.android._HasMobileSelectBoxDialog,{showPageByDialog:function showPageByDialog(){var pageByData=$HASH.clone(this.pageByData),pageElements=pageByData.es,dialogCfg={title:mstrmojo.desc(5136,"Page By"),cssClass:"paging-editor"},base=this,pageCnt=0,depth,pageBys,selections,selectedIndices,fnClearPageBy,fnPageHeader,fnGetPages,fnIterateSelections,fnSubmit;fnClearPageBy=function(node){var idx=selectedIndices.shift(),item=node.ph.h[idx];delete item.cet;if(item.ph){fnClearPageBy(item);}};fnPageHeader=function(node){var page=node.ph;if(!page){return ;}var items=[],selectedPageHeader;$ARR.forEach(page.h,function(v,idx){var ix=v.ix,cet=v.cet||0;var el=pageElements[ix];items[idx]={n:el.en,v:ix,on:cet};if(cet){selections[depth]=items[idx];selectedIndices[depth]=idx;selectedPageHeader=v.ph;}});var selected=selections[depth];pageBys.push({n:page.n,items:items,v:selected.n});depth++;fnPageHeader($HASH.copy(selected,{ph:selectedPageHeader}));};fnGetPages=function(){depth=0;pageBys=[];selections=[];selectedIndices=[];fnPageHeader(pageByData);pageCnt=pageBys.length;};fnIterateSelections=function(fnModifier){var pageHeader=pageByData.ph;$ARR.forEach(selections,function(v){var headers=pageHeader.h,selectedHeader=headers[Math.max($ARR.find(headers,"ix",v.v),0)];fnModifier(selectedHeader,pageHeader);pageHeader=selectedHeader.ph;});};fnSubmit=function(){var pageByKeys=[];fnIterateSelections(function(selectedHeader,pageHeader){pageByKeys.push({id:pageHeader.id||"m",tp:pageHeader.tp,v:pageElements[selectedHeader.ix].ei});});base.pageByData=pageByData;base.controller.onPageBy(base,pageByKeys);};fnGetPages();if(pageCnt>1){dialogCfg.buttons=[$BTN(mstrmojo.desc(1442,"OK"),function(){fnSubmit();}),$BTN(mstrmojo.desc(221,"Cancel"))];}this.showMobileSelectBoxDialog(pageBys,function(idx,item){fnClearPageBy(pageByData);selections[idx]=item;fnIterateSelections(function(selectedHeader){selectedHeader.cet=1;});fnGetPages();if(pageCnt>1){this.set("items",pageBys);}else{fnSubmit();}return(pageCnt>1);},dialogCfg);}}));}());
(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ColorPicker","mstrmojo.List","mstrmojo.Label","mstrmojo.css");var tooltips={"0":[mstrmojo.desc(4883,"Transition Type:")+mstrmojo.desc(4888,"Linear")+";"+mstrmojo.desc(4884,"Angle:")+"0;"+mstrmojo.desc(4885,"X Offset:")+"0;"+mstrmojo.desc(4886,"Y Offset:")+"0",mstrmojo.desc(4883,"Transition Type:")+mstrmojo.desc(4888,"Linear")+";"+mstrmojo.desc(4884,"Angle:")+"0;"+mstrmojo.desc(4885,"X Offset:")+"0;"+mstrmojo.desc(4886,"Y Offset:")+"100",mstrmojo.desc(4883,"Transition Type:")+mstrmojo.desc(4888,"Linear")+";"+mstrmojo.desc(4884,"Angle:")+"0;"+mstrmojo.desc(4885,"X Offset:")+"50;"+mstrmojo.desc(4886,"Y Offset:")+"50;"+mstrmojo.desc(4875,"(Flash Only)")],"90":[mstrmojo.desc(4883,"Transition Type:")+mstrmojo.desc(4888,"Linear")+";"+mstrmojo.desc(4884,"Angle:")+"90;"+mstrmojo.desc(4885,"X Offset:")+"0;"+mstrmojo.desc(4886,"Y Offset:")+"0",mstrmojo.desc(4883,"Transition Type:")+mstrmojo.desc(4888,"Linear")+";"+mstrmojo.desc(4884,"Angle:")+"90;"+mstrmojo.desc(4885,"X Offset:")+"100;"+mstrmojo.desc(4886,"Y Offset:")+"0",mstrmojo.desc(4883,"Transition Type:")+mstrmojo.desc(4888,"Linear")+";"+mstrmojo.desc(4884,"Angle:")+"90;"+mstrmojo.desc(4885,"X Offset:")+"50;"+mstrmojo.desc(4886,"Y Offset:")+"50;"+mstrmojo.desc(4875,"(Flash Only)")]};var offsets={"0":[{x:0,y:0},{x:100,y:0},{x:50,y:0}],"90":[{x:0,y:0},{x:0,y:100},{x:0,y:50}]};function createColorDropDown(ps,which){return mstrmojo.ColorPicker.createDropDown(mstrmojo.hash.copy(ps,{onfillColorChange:function(){if(this.boxNode){this.boxNode.style.backgroundColor=this.fillColor;}this.parent.parent.parent.geModel.set((which===0?"FillColor":"GradientColor"),this.fillColor);},bindings:{fillColor:function(){return this.parent.parent.parent.geModel[["FillColor","GradientColor"][which]];}}}));}function createPreview(index,ps){var cssClsses={"20":" half t","21":" half l","30":" half b","31":" half r"};var variantIndex=index==3?index-1:index;return mstrmojo.hash.copy(ps,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-GradientEditor-preview p"+index,alias:"p"+index,bindings:{cssText:function(){var gemodel=this.parent.parent.parent.geModel;if(gemodel){var color1=this.parent.parent.parent.geModel.FillColor,color2=this.parent.parent.parent.geModel.GradientColor,angle=this.parent.parent.parent.geModel.GradientAngle,type=angle==90?0:1,gradient=(index==1||index==2)?mstrmojo.css.buildGradient(type,color2,color1):mstrmojo.css.buildGradient(type,color1,color2);if(index>=2){this.domNode.className=this.cssClass+cssClsses[index+""+type];}this.domNode.title=tooltips[angle][variantIndex];gemodel.css=gradient.n+":"+gradient.v;return gemodel.css;}}},onclick:function(){var geModel=this.parent.parent.parent.geModel,offset=offsets[geModel.GradientAngle][variantIndex];geModel.set("GradientXOffset",offset.x);geModel.set("GradientYOffset",offset.y);}});}var saveModel=function(widget){var vi=widget.shade.preview.preview_bg.variantIndex;var pr=["FillStyle","FillColor","GradientColor","GradientXOffset","GradientYOffset","GradientAngle"],gm=widget.geModel,gradient={};for(var p in pr){if(typeof (gm[pr[p]])!="undefined"){gradient[pr[p]]=gm[pr[p]];}}gradient.css=widget.shade.preview["p"+(vi==2?0:vi)].cssText;widget.set("gradient",gradient);};var _defaultGradientInfo={GradientXOffset:0,GradientYOffset:0,GradientAngle:0,FillColor:"#FFFFFF",GradientColor:"#000000"};mstrmojo.GradientEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.GradientEditor",useShadow:true,title:mstrmojo.desc(7971,"Gradient Editor"),model:null,onOK:null,onCancel:null,onmodelChange:function(){this.set("geModel",mstrmojo.hash.make(this.model||_defaultGradientInfo,mstrmojo.Obj));},init:function(props){this._super(props);this.shadowCssClass=this.useShadow?"shadow":"";this.cssClass="mstrmojo-GradientEditor "+this.cssClass;},postBuildRendering:function(){if(this._super){this._super();}this.set("geModel",mstrmojo.hash.make(_defaultGradientInfo,mstrmojo.Obj));},children:[{scriptClass:"mstrmojo.FieldSet",alias:"color",cssClass:"color",legend:mstrmojo.desc(4880,"Colors"),children:[{scriptClass:"mstrmojo.Table",rows:2,cols:2,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4881,"Color 1"),slot:"0,0"},createColorDropDown({slot:"0,1"},0),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4882,"Color 2"),slot:"1,0"},createColorDropDown({slot:"1,1"},1)]}]},{scriptClass:"mstrmojo.FieldSet",alias:"shade",cssClass:"shade",legend:mstrmojo.desc(4948,"Shading Styles"),children:[{scriptClass:"mstrmojo.List",cssClass:"orientation mstrmojo-radio-list",alias:"angle",items:[{n:mstrmojo.desc(4957,"Horizontal"),v:0},{n:mstrmojo.desc(4949,"Vertical"),v:90}],onchange:function(evt){var geModel=this.parent.parent.geModel,variantIndex=this.parent.preview.preview_bg.variantIndex;if(geModel&&typeof (variantIndex)!="undefined"&&variantIndex!=-1){var angle=this.selectedItem.v,offset=offsets[angle][variantIndex];geModel.set("GradientAngle",angle);geModel.set("GradientXOffset",offset.x);geModel.set("GradientYOffset",offset.y);}},bindings:{variantIndex:function(){return this.parent.preview.preview_bg.variantIndex;},selectedIndex:function(){var geModel=this.parent.parent.geModel;if(geModel){var angle=geModel&&geModel.GradientAngle||0;return angle==90?1:0;}return -1;}}},{scriptClass:"mstrmojo.Container",alias:"preview",cssClass:"mstrmojo-GradientEditor-previewbox",markupString:'<div class="{@cssClass}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},children:[createPreview(0),createPreview(1),createPreview(2),createPreview(3),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4875,"(Flash Only)"),cssClass:"mstrmojo-GradientEditor-preview p2 label"},{scriptClass:"mstrmojo.Label",alias:"preview_bg",cssClass:"mstrmojo-GradientEditor-preview bg",onvariantIndexChange:function(){var phNode=this.domNode;if(phNode){phNode.className=this.cssClass+" show p"+this.variantIndex;}},bindings:{variantIndex:function(){var geModel=this.parent.parent.parent.geModel;if(geModel){var offset=this.parent.parent.parent.geModel.GradientAngle==90?this.parent.parent.parent.geModel.GradientYOffset:this.parent.parent.parent.geModel.GradientXOffset;return{"0":0,"100":1,"50":2}[offset];}return -1;}}}]}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",children:[new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442,"OK"),function(){var editor=this.parent.parent;editor.close();saveModel(editor);if(editor.onOK){editor.onOK();}},"#999",{alias:"ok",cssClass:"mstrmojo-Editor-button"}),new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(2140,"Cancel"),function(){var editor=this.parent.parent;editor.close();if(editor.onCancel){editor.onCancel();}},"#999",{alias:"cancel",cssClass:"mstrmojo-Editor-button"})]}]});})();
(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._FillsBrowser","mstrmojo.Button","mstrmojo.vi.ui.tutorial.InstructionTip","mstrmojo.dom","mstrmojo.css");var $DOM=mstrmojo.dom;var PX="px";function addInstructionalTip(targetEl,text,css,children){if(targetEl){children.push({scriptClass:"mstrmojo.vi.ui.tutorial.InstructionTip",targetEl:targetEl,textHTML:text.replace("##","<strong>").replace("###","</strong>"),cssClass:css});}}function getElement(className,container){return container&&container.getElementsByClassName(className)[0];}function toggleNativeMenus(enabled){var formWrapper=window.FormWrapper;if(formWrapper){formWrapper.toggleNetMenu(enabled?"enable":"disable");}}function positionLabel(label){var dn=label.domNode;if(dn){dn.style.left=computeLeftOffset.call(this,label);}}function computeLeftOffset(label){return(($DOM.windowDim().w-label.domNode.offsetWidth)/2)+PX;}mstrmojo.vi.ui.tutorial.TutorialView=mstrmojo.declare(mstrmojo.Box,[mstrmojo._FillsBrowser],{scriptClass:"mstrmojo.vi.ui.tutorial.TutorialView",isFirstTime:false,dismissLbl:undefined,accessLaterLbl:undefined,controller:null,init:function init(props){this._super(props);var ctrl=this.controller;ctrl.setPanelDisplay("datasetsPanel",true);ctrl.setPanelDisplay("galleryPanel",true);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-TutorialView");this.placeholder=document.body.appendChild(document.createElement("div"));var toolbar=getElement("mstrmojo-RootView-toolbar",document),viGallery=getElement("mstrmojo-VIGalleryList",document),allObjBrowser=getElement("mstrmojo-object-browser-content",document),children=[];addInstructionalTip(getElement("addDS",toolbar),mstrmojo.desc(12289,"##Add data### to your dashboard."),"data-source",children);addInstructionalTip(getElement("insertVI",toolbar),mstrmojo.desc(12290,"##Add a visualization### to analyze your data."),"insert-viz",children);addInstructionalTip(getElement("close",toolbar),mstrmojo.desc(12291,"##Close dashboard editor### and browse."),"close-btn",children);var vizCount=viGallery.firstChild.children.length,viGalleryElement=viGallery&&viGallery.firstChild,vizPos=0;if(vizCount){vizPos=Math.min(~~(vizCount/2),10);viGalleryElement=viGallery.firstChild.children[vizPos];}addInstructionalTip(viGalleryElement,mstrmojo.desc(12293,"##Use this gallery### to change visualization type."),"vi-gallery",children);if(allObjBrowser&&allObjBrowser.className.indexOf("opened")===-1){addInstructionalTip(getElement("icn",getElement("vi-allObjects-tb",allObjBrowser)),mstrmojo.desc(12292,"##Expand All Objects### to access your project schema."),"all-obj-btn",children);}this.dismissLbl=new mstrmojo.Label({id:"dismissLbl",text:mstrmojo.desc(14428,"Click anywhere to dismiss"),cssClass:"dismissLbl"});this.accessLaterLbl=new mstrmojo.Label({id:"accessLaterLbl",text:mstrmojo.desc(14472,"Quick tips can be accessed from the help menu"),cssClass:"accessLaterLbl"});children.push(this.dismissLbl,this.accessLaterLbl);this.addChildren(children);toggleNativeMenus(false);},postBuildRendering:function postBuildRendering(){this._super();var me=this,des=function(){me.destroy();};this.domNode.addEventListener("click",des,false);this.browserResized();return true;},browserResized:function browserResized(){this.children.forEach(function(child){if(child.updatePosition){child.updatePosition();}});return false;},destroy:function destroy(skipCleanup){if(this.destroyed){return ;}if(this.isFirstTime){var isSingleTier=mstrApp.isSingleTier;if(isSingleTier){window.FormWrapper.setShowVITutorial(false);}else{mstrApp.serverRequest({taskId:"setPreference",prefs:"showVITutorial\u001E0"},{failure:function failure(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}mstrApp.showHelpMenuNotification();}toggleNativeMenus(true);this._super(skipCleanup);}});}());
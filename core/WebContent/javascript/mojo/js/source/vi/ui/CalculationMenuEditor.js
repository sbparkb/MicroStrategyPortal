(function(){mstrmojo.requiresClsP("mstrmojo","Button","Box","vi.ui.CalculationWidget","mstr.EnumFunction");mstrmojo.requiresDescs(221,358,1422,2122,6017,5868,5869);var $DESC=mstrmojo.desc,$FUNC=mstrmojo.mstr.EnumFunction,IDX_A_MINUS_B=4,IDX_B_MINUS_A=5,IDX_A_DIV_B=6,IDX_B_DIV_A=7;var ITEMS={SINGLE:[{n:$DESC(358,"Absolute"),v:$FUNC.FunctionAbs}],PAIR:[{n:$DESC(6017,"Add"),v:$FUNC.FunctionAdd},{n:$DESC(2122,"Average"),v:$FUNC.FunctionAverage},{n:$DESC(5868,"Least"),v:$FUNC.FunctionLeast},{n:$DESC(5869,"Greatest"),v:$FUNC.FunctionGreatest},{n:"A-B",v:$FUNC.FunctionMinus+";0"},{n:"B-A",v:$FUNC.FunctionMinus+";1"},{n:"A/B",v:$FUNC.FunctionDivide+";0"},{n:"B/A",v:$FUNC.FunctionDivide+";1"}],MORE:[{n:$DESC(6017,"Add"),v:$FUNC.FunctionAdd},{n:$DESC(2122,"Average"),v:$FUNC.FunctionAverage},{n:$DESC(5868,"Least"),v:$FUNC.FunctionLeast},{n:$DESC(5869,"Greatest"),v:$FUNC.FunctionGreatest}]};mstrmojo.vi.ui.CalculationMenuEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.CalculationMenuEditor",onSubmenuOpen:function onSubmenuOpen(){var w=this.parent,de=w.de,es=de&&de.es,n=(es&&es.length)||w.cellsNum,cellsNum=(n===1)?"SINGLE":((n===2)?"PAIR":"MORE"),items=ITEMS[cellsNum],func=(de&&de.func)||w.func,i,selCells;if(cellsNum==="PAIR"){if(de){items[IDX_A_MINUS_B].n=es[0].n+" - "+es[1].n;items[IDX_B_MINUS_A].n=es[1].n+" - "+es[0].n;items[IDX_A_DIV_B].n=es[0].n+" / "+es[1].n;items[IDX_B_DIV_A].n=es[1].n+" / "+es[0].n;}else{selCells=this.xtab.selCells;items[IDX_A_MINUS_B].n=selCells[0].innerText+" - "+selCells[1].innerText;items[IDX_B_MINUS_A].n=selCells[1].innerText+" - "+selCells[0].innerText;items[IDX_A_DIV_B].n=selCells[0].innerText+" / "+selCells[1].innerText;items[IDX_B_DIV_A].n=selCells[1].innerText+" / "+selCells[0].innerText;}}this.checkList.set("items",items);for(i in items){if(typeof items[i].v==="string"&&items[i].v.indexOf(func)===0&&items[i].v.indexOf(";0")>0){this.checkList.set("selectedItem",items[i]);break;}if(items[i].v===func){this.checkList.set("selectedItem",items[i]);break;}}},applyCalculation:function applyCalculation(funcType){var xtab=this.xtab,w=this.parent;if((w.de&&w.de.func===funcType)||(typeof funcType==="string"&&funcType.indexOf(w.de.func)===0&&funcType.indexOf(";0")>0)){return ;}if(this.parent.isEdit===true){xtab.editDECalculation(w.node,funcType);}else{xtab.derivedElementCalculation(w.node,funcType);}this.onSubmenuClosed();},children:[{scriptClass:"mstrmojo.vi.ui.CalculationWidget",alias:"checkList"}]});}());
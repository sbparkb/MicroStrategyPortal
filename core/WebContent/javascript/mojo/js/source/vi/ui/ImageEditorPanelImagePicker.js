(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.vi.ui.rw.selectors._HasWarningMessage","mstrmojo.vi.ui.rw._ValidInputLocalImage","mstrmojo.imageUtils");var widget;$IMGUTIL=mstrmojo.imageUtils;mstrmojo.vi.ui.ImageEditorPanelImagePicker=mstrmojo.declare(mstrmojo.Container,[mstrmojo.vi.ui.rw.selectors._HasWarningMessage,mstrmojo.vi.ui.rw._ValidInputLocalImage],{scriptClass:"mstrmojo.vi.ui.ImageEditorPanelImagePicker",cssClass:"",markupString:'<div class=\'mstrmojo-ImageEditorModel-ImagePicker {@cssClass}\'><label><input style="position: absolute; left: -10000px" type="file" accept=".png, .jpg, .jpeg, .gif, .bmp" onchange="mstrmojo.all.{@id}.syncFile();"/><div class="browseBtnLabel"></div></label></div>',markupSlots:{containerNode:function(){return this.domNode;},fileNode:function(){return this.domNode.children[0].firstChild;},browseBtnNode:function(){return this.domNode.children[0].lastChild;}},children:[mstrmojo.Button.newActionButton(mstrmojo.desc(1825,"Browse"),function(){if(mstrApp.isSingleTier){widget=this.parent;var formWrapper=window.FormWrapper;formWrapper.openImageFileDialog("mstrmojo.vi.ui.ImageEditorPanelImagePicker.onOneTierFileSelected");}},{alias:"browseBtn",slot:"browseBtnNode",enabled:true})],init:function init(props){this._super(props);this.bindWarningHandler(this);},validationFailed:function(){this._super();this.set("validation",this.getValidationObj());},syncFile:function(){if(this.fileNode.files.length===1){var file=this.fileNode.files[0];this.fileSelected.call(this,file);}}});mstrmojo.vi.ui.ImageEditorPanelImagePicker.onOneTierFileSelected=function(res){if(res&&res.data&&res.filename){var BASE64_MARKER=";base64,";if(res.data.indexOf(BASE64_MARKER)===-1){res.data="data:image/jpeg;base64,"+res.data;}var blob=$IMGUTIL.dataURLToBlob(res.data);var mFile={fileBlob:blob,name:res.filename};widget.fileSelected.call(widget,mFile);}};}());
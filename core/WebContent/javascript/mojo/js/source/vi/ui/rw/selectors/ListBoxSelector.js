(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo.css");var $COLOR=mstrmojo.color,$FORMAT_MODEL=mstrmojo.models.FormatModel,$ENUM_FORMAT_PROPERTIES=$FORMAT_MODEL.ENUM_PROPERTY_NAMES,DEFAULT_BG="transparent",DEFAULT_TEXT="#000000",DEFAULT_BG_SELECTED="#2f9ad3",DEFAULT_TEXT_SELECTED="#ffffff";function isListBox(){return this.docSelector.style===mstrmojo.DocSelector.STYLES.LIST&&!this.docSelector.isInFilterPanel();}function setElementStyle(el,stateName){if(isListBox.call(this)){var elStyle=el.style,styles=this.stateCssText[stateName];elStyle.background=styles.bg;elStyle.color=styles.text;}}mstrmojo.vi.ui.rw.selectors.ListBoxSelector=mstrmojo.declare(mstrmojo.ui.ScrollableList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.ListBoxSelector",init:function init(props){this._super(props);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-sel-ListBox");},getItemMarkup:function getItemMarkup(item,idx){if(mstrmojo.string.isEmpty(item.n)){return this._super(item,idx).replace("{@en@n}","&nbsp;");}return this._super(item,idx);},listHooks:{select:function(el){setElementStyle.call(this,el,"selected");},unselect:function(el){setElementStyle.call(this,el,"base");}},getItemProps:function getItemProps(item,idx){var props=this._super(item,idx);if(isListBox.call(this)){var stateCssText=this.stateCssText,styles=props.sel?stateCssText.selected:stateCssText.base;props.addStyle("background:"+styles.bg+";color:"+styles.text);}return props;},preBuildRendering:function preBuildRendering(){if(isListBox.call(this)){var docSelector=this.docSelector,fmts=docSelector.getFormats(),defaultBg=this.getPropertyDefaultValue($ENUM_FORMAT_PROPERTIES.SELECTOR_SELECTION_COLOR)||DEFAULT_BG_SELECTED,defaultColor=this.getPropertyDefaultValue($ENUM_FORMAT_PROPERTIES.COLOR)||DEFAULT_TEXT_SELECTED,selectedBg=docSelector.defn.ssc!==undefined?$FORMAT_MODEL.decodeValue($ENUM_FORMAT_PROPERTIES.SELECTOR_SELECTION_COLOR,docSelector.defn.ssc):defaultBg;this.stateCssText={base:{bg:fmts["background-color"]||DEFAULT_BG,text:fmts.color||DEFAULT_TEXT},selected:{bg:selectedBg,text:$COLOR.encodeColor(selectedBg)===$COLOR.encodeColor(defaultBg)?defaultColor:$COLOR.getContrastingColor(selectedBg,"#ffffff","#000000")}};}return this._super();},getPropertyDefaultValue:function(propName){var theme=mstrApp.getThemeClassName(),v=null;switch(propName){case $ENUM_FORMAT_PROPERTIES.SELECTOR_SELECTION_COLOR:v=theme==="mojo-theme-light"?"#34ABEB":"#34ABEB";break;case $ENUM_FORMAT_PROPERTIES.COLOR:v=theme==="mojo-theme-light"?"#444649":"#ffffff";break;}return v;},premousedown:function premousedown(evt){if(mstrmojo.dom.shiftKey(evt.hWin,evt.e)){mstrmojo.dom.preventDefault(evt.hWin,evt.e);}},onclick:function onclick(evt){var target=evt.getTarget();var item=this.getItemFromTarget(target);if(item){var idx=item._renderIdx;if(this.multiSelect&&evt.metaKey){var changeSelection=this.rangeSelected||this.selectedIndex===-1;this.toggleSelect(idx);if(changeSelection&&idx<this.items.length&&this.selectedIndices[idx+1]){idx++;}this.selectedIndex=idx;this.rangeSelected=false;}else{if(this.multiSelect&&evt.shiftKey){this.rangeSelected=true;this.rangeSelect(idx);}else{this.singleSelect(idx);this.rangeSelected=false;}}}},updateScrollbars:function updateScrollbars(){if(this.hasRendered&&this.orientation==="v"){this.scrollboxNode.style.height=this.height;}this._super();}});}());
(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Label","mstrmojo.ui.Checkbox","mstrmojo.RadioButton","mstrmojo.Table","mstrmojo.TextBox","mstrmojo.HBox","mstrmojo.Button","mstrmojo.vi.ui.rw.selectors._HasWarningMessage","mstrmojo.num","mstrmojo.hash","mstrmojo.models.FormatModel");mstrmojo.requiresDescs(9077,14390,14391,14427,14674,14675,14676);var $P=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition,$NM=mstrmojo.num,$HASH=mstrmojo.hash,$FORMAT_MODEL=mstrmojo.models.FormatModel,$ENUM_XML_REFRESH=$FORMAT_MODEL.ENUM_PROPERTY_NAMES.REFRESH,$ENUM_XML_TAG_JOIN_ACROSS_DATASET=$FORMAT_MODEL.ENUM_PROPERTY_NAMES.JOIN_ACROSS_DATASET,$ENUM_XML_TAG_JOIN_DATA_COMBINATION=$FORMAT_MODEL.ENUM_PROPERTY_NAMES.MCE_JOIN_TO_GET_DATA_COMBINATION,CLASS_MULTILINE="multiLine ",CLASS_RADIOGROUP="radioGroup ",CLASS_TOPSPACE="topSpace ";var label=function(label,props){return mstrmojo.hash.copy(props,{scriptClass:"mstrmojo.Label",text:label,cssDisplay:"inline-block",onclick:function(){if(this.series){this.parent[this.series].onclick();}}});},buttonBar=function(label,props){return mstrmojo.hash.copy(props,{scriptClass:"mstrmojo.Button",text:label,cssClass:"mstrmojo-WebButton",bindings:{editor:"this.parent.parent"},postclick:function(){this.editor.close();}});},checkbox=function(props){return mstrmojo.hash.copy(props,{scriptClass:"mstrmojo.ui.Checkbox",cssDisplay:"inline-block"});},radiobutton=function(props){return mstrmojo.hash.copy(props,{scriptClass:"mstrmojo.RadioButton",cssDisplay:"inline-block"});};mstrmojo.vi.ui.editors.DocPropsEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.vi.ui.rw.selectors._HasWarningMessage],{scriptClass:"mstrmojo.vi.ui.editors.DocPropsEditor",cssClass:"mstrmojo-DocProps-Editor",title:mstrmojo.desc(14427,"Dashboard Properties"),postBuildRendering:function postBuildRendering(){this._super();this.bindWarningHandler(this);},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{},{},{}]},{cells:[{},{colSpan:2}]},{cells:[{},{},{}],cssClass:CLASS_TOPSPACE+CLASS_MULTILINE},{cells:[{colSpan:3}]},{cells:[{},{},{}],cssClass:CLASS_TOPSPACE+CLASS_MULTILINE+CLASS_RADIOGROUP},{cells:[{},{},{}],cssClass:CLASS_TOPSPACE+CLASS_MULTILINE+CLASS_RADIOGROUP}],children:[label(mstrmojo.desc(773,"Refresh"),{slot:"0,0",series:"enableAuto"}),checkbox({slot:"0,1",alias:"enableAuto",bindings:{checked:"this.parent.parent.propsModel.rf>0"}}),label(mstrmojo.desc(9077,"Automatically refresh every"),{slot:"0,2",series:"enableAuto"}),{scriptClass:"mstrmojo.TextBox",alias:"frequency",slot:"0,2",cssDisplay:"inline-block",validate:function(){var v=this.value,invalidInput=!$NM.isInt(v)||parseInt(v,10)<=0||!(/\S/.test(v));if(this.editor){this.editor.warn({refNode:this.domNode,invalid:this.enabled&&invalidInput});}return !invalidInput;},_set_value:function(n,v){var _changed=this.value!==v;this.value=v;if(this.editor&&this.editor.propsModel){if(this.enabled){if(this.validate()){this.editor.propsModel[$ENUM_XML_REFRESH]=v;}}else{this.editor.propsModel[$ENUM_XML_REFRESH]=0;}}return _changed;},onenabledChange:function(){var val=this.editor&&this.editor.propsModel&&this.editor.propsModel[$ENUM_XML_REFRESH];this.set("value",val||30);},bindings:{enabled:"this.parent.enableAuto.checked",editor:"this.parent.parent",value:"this.parent.parent.propsModel.rf"}},label(mstrmojo.desc(98,"seconds"),{slot:"0,2",series:"enableAuto"}),label(mstrmojo.desc(14391,"Access auto refresh function in Presentation mode"),{slot:"1,1",cssClass:"greyline"}),label(mstrmojo.desc(4571,"Join Behavior"),{slot:"2,0",series:"allowJoin"}),checkbox({slot:"2,1",alias:"allowJoin",bindings:{checked:"this.parent.parent.propsModel.jad>0"},oncheckedChange:function(){var dm=this.parent.parent.propsModel;if(dm){dm[$ENUM_XML_TAG_JOIN_ACROSS_DATASET]=this.checked?1:0;}}}),label(mstrmojo.desc(14390,"Allow joins across datasets based on unrelated common attributes"),{slot:"2,2",series:"allowJoin",cssClass:"wrap"}),radiobutton({slot:"4,1",alias:"maxRelations",name:"relations",bindings:{checked:"!this.parent.parent.propsModel.jdc"},oncheckedChange:function(){var dm=this.parent.parent.propsModel;if(dm){dm[$ENUM_XML_TAG_JOIN_DATA_COMBINATION]=this.checked?0:1;}},onclick:function(){this.set("checked",true);}}),label(mstrmojo.desc(14675,"Use maximum relations to join attributes and get complete data combinations (higher memory usage)"),{slot:"4,2",series:"maxRelations",cssClass:"wrap"}),radiobutton({slot:"5,1",alias:"minRelations",name:"relations",bindings:{checked:"this.parent.parent.propsModel.jdc"},oncheckedChange:function(){var dm=this.parent.parent.propsModel;if(dm){dm[$ENUM_XML_TAG_JOIN_DATA_COMBINATION]=this.checked?1:0;}},onclick:function(){this.set("checked",true);}}),label(mstrmojo.desc(14676,"Use minimum relations to join attributes using mostly binary relations (faster, less memory usage)"),{slot:"5,2",series:"minRelations",cssClass:"wrap"})]},{scriptClass:"mstrmojo.HBox",alias:"btnHBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[buttonBar(mstrmojo.desc(8708,"OK"),{alias:"okBtn",cssClass:"mstrmojo-WebButton hot",onclick:function(){this.editor.onOK();}}),buttonBar(mstrmojo.desc(221,"Cancel"))]}],warn:function warn(error){this.set("validation",mstrmojo.hash.copy(error,{refNode:this.domNode,position:$P.TOP,invalid:true,errorCode:"invalidValueVIWarning"}));var btnHBox=this.btnHbox;if(btnHBox){btnHBox.okBtn.set("enabled",!this.validation.invalid);}},onOpen:function onOpen(){var docModel=this.docModel;this.set("propsModel",{rf:docModel[$ENUM_XML_REFRESH],jad:docModel[$ENUM_XML_TAG_JOIN_ACROSS_DATASET],jdc:docModel[$ENUM_XML_TAG_JOIN_DATA_COMBINATION]});},onOK:function(){var dm=this.docModel,docCtrl=dm.controller,m=this.propsModel,rf=m[$ENUM_XML_REFRESH],jad=m[$ENUM_XML_TAG_JOIN_ACROSS_DATASET],jdc=m[$ENUM_XML_TAG_JOIN_DATA_COMBINATION],formatObject,requestData;if(dm[$ENUM_XML_REFRESH]!==rf){dm[$ENUM_XML_REFRESH]=rf;formatObject=$HASH.copy($FORMAT_MODEL.getFormatUpdate($ENUM_XML_REFRESH,rf,formatObject),formatObject||{});}if(dm[$ENUM_XML_TAG_JOIN_ACROSS_DATASET]!==jad){dm[$ENUM_XML_TAG_JOIN_ACROSS_DATASET]=jad;formatObject=$HASH.copy($FORMAT_MODEL.getFormatUpdate($ENUM_XML_TAG_JOIN_ACROSS_DATASET,jad,formatObject),formatObject||{});requestData=true;}if(dm[$ENUM_XML_TAG_JOIN_DATA_COMBINATION]!==jdc){dm[$ENUM_XML_TAG_JOIN_DATA_COMBINATION]=jdc;formatObject=$HASH.copy($FORMAT_MODEL.getFormatUpdate($ENUM_XML_TAG_JOIN_DATA_COMBINATION,jdc,formatObject),formatObject||{});requestData=true;}if(formatObject){dm.saveDocProps(formatObject,null,requestData,docCtrl.getRefreshCallback());}}});}());
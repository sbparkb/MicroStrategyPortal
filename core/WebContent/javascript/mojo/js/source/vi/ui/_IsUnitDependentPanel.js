(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.TitleBar","mstrmojo.vi.ui.PanelContents");function titleEdited(titleText,textChanged,oldText){if(textChanged){this.targetUnit.updateDisplayName(titleText,oldText);}}function updateTitle(evt){this.set("title",evt.value);}function viUnitSelected(evt){if(this.layoutKey!==this.model.currlaykey){return ;}if(this._vizTitleSub){this._vizTitleSub.clear();delete this._vizTitleSub;}this.set("title","");var contents=this.contents,children=(contents.children||[]).slice();contents.removeChildren();children.forEach(function(child){child.destroy();});var selectedUnit=mstrmojo.all[evt.id];if(selectedUnit){this.targetUnit=selectedUnit;this.set("title",selectedUnit.getDisplayName());this._vizTitleSub=selectedUnit.attachEventListener("titleChange",this.id,updateTitle);this.onVIUnitSelected(selectedUnit);}}mstrmojo.vi.ui._IsUnitDependentPanel=mstrmojo.provide("mstrmojo.vi.ui._IsUnitDependentPanel",{_mixinName:"mstrmojo.vi.ui._IsUnitDependentPanel",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,ontitleChange:function(){var toolbar=this.toolbar;if(toolbar){toolbar.set("title",this.title||"");}}},targetUnit:null,init:function init(props){this._super(props);this.model.attachEventListener("viUnitSelected",this.id,viUnitSelected);this.toolbar.set("editTitleOnDoubleClick",mstrApp.allowWebDashboardDesign());},children:[{scriptClass:"mstrmojo.vi.ui.TitleBar",slot:"controlNode",alias:"toolbar",useRichTooltip:true,titleEdited:function(titleText,textChanged,oldText){titleEdited.call(this.parent,titleText,textChanged,oldText);},layoutConfig:{w:{textNode:"100%",rightToolNode:"23px"},h:{textNode:"all",rightToolNode:"all"},xt:true}},{scriptClass:"mstrmojo.vi.ui.PanelContents",slot:"containerNode",alias:"contents"}],onRender:function onRender(){var unit=this.model.getSelectedViUnit();if(unit){viUnitSelected.call(this,{id:unit.id});}if(this._super){this._super();}},onVIUnitSelected:function(unit){}});}());
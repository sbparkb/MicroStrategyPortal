(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo.color","mstrmojo.css","mstrmojo.array");var $CSS=mstrmojo.css,$COLOR=mstrmojo.color,$FORMAT_MODEL=mstrmojo.models.FormatModel,$ENUM_FORMAT_PROPERTIES=$FORMAT_MODEL.ENUM_PROPERTY_NAMES,DEFAULT_BG="transparent",DEFAULT_TEXT="#000000",DEFAULT_BG_SELECTED="#2f9ad3",DEFAULT_TEXT_SELECTED="#ffffff",itemMarkup;function isLinkBar(){return this.docSelector.style===mstrmojo.DocSelector.STYLES.LINK;}function setElementStyle(el,stateName){if(isLinkBar.call(this)){var elStyle=el.style,styles=this.stateCssText[stateName];elStyle.background=styles.bg;elStyle.color=styles.text;}}function assignNodeWidths(){if(this.itemWidthMode===1){var itemNodes=Array.prototype.slice.call(this.itemsContainerNode.childNodes);if(itemNodes.length>0&&itemNodes.length<100){var fnUpdateStyle=mstrmojo.emptyFn;if(this.isHoriz){var widths=itemNodes.map(function(node){return node.offsetWidth;}),total=widths.reduce(mstrmojo.array.fnReduceNumber);if(total>0){fnUpdateStyle=function(nodeStyle,idx){var nodeWidth=widths[idx];nodeStyle.minWidth=nodeWidth+"px";nodeStyle.width=((nodeWidth/total)*100)+"%";};}}else{fnUpdateStyle=function(nodeStyle){nodeStyle.minWidth=nodeStyle.width="auto";};}itemNodes.forEach(function(node,idx){fnUpdateStyle(node.style,idx);});}}}mstrmojo.vi.ui.rw.selectors.LinkList=mstrmojo.declare(mstrmojo.ui.ScrollableList,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.LinkList",renderOnScroll:true,init:function init(props){this._super(props);$CSS.addWidgetCssClass(this,"mstrmojo-vi-sel-LinkList");},listHooks:{select:function(el){setElementStyle.call(this,el,"selected");},unselect:function(el){setElementStyle.call(this,el,"base");}},getItemMarkup:function getItemMarkup(item,idx){if(mstrmojo.string.isEmpty(item.n)){return this._super(item,idx).replace("{@en@n}","<div>&nbsp;</div>");}if(!itemMarkup){itemMarkup=this._super(item,idx).replace("{@en@n}","<div>{@en@n}</div>");}return itemMarkup;},getItemProps:function getItemProps(item,idx){var props=this._super(item,idx);if(isLinkBar.call(this)){var stateCssText=this.stateCssText,styles=props.sel?stateCssText.selected:stateCssText.base;props.addStyle("background:"+styles.bg+";color:"+styles.text);}if(((this.isHoriz&&(this.orientation!=="v"))||(!this.isHoriz&&this.orientation==="h"))&&this.itemWidthMode===0){var itemCnt=this.items.length,width=100/itemCnt;if(idx===itemCnt-1){width=100-((itemCnt-1)*width);}props.addStyle("width:"+width+"%");}return props;},preBuildRendering:function preBuildRendering(){if(isLinkBar.call(this)){var docSelector=this.docSelector,fmts=docSelector.getFormats(),defaultBg=this.getPropertyDefaultValue($ENUM_FORMAT_PROPERTIES.SELECTOR_SELECTION_COLOR)||DEFAULT_BG_SELECTED,defaultColor=this.getPropertyDefaultValue($ENUM_FORMAT_PROPERTIES.COLOR)||DEFAULT_TEXT_SELECTED,selectedBg=docSelector.defn.ssc!==undefined?$FORMAT_MODEL.decodeValue($ENUM_FORMAT_PROPERTIES.SELECTOR_SELECTION_COLOR,docSelector.defn.ssc):defaultBg;this.stateCssText={base:{bg:fmts["background-color"]||DEFAULT_BG,text:fmts.color||DEFAULT_TEXT},selected:{bg:selectedBg,text:$COLOR.encodeColor(selectedBg)===$COLOR.encodeColor(defaultBg)?defaultColor:$COLOR.getContrastingColor(selectedBg,"#ffffff","#000000")}};}return this._super();},postBuildRendering:function postBuildRendering(){if(!isLinkBar.call(this)){$CSS.addClass(this.domNode,"buttons");}assignNodeWidths.call(this);return this._super();},onclick:function(evt){var item=this.getItemFromTarget(evt.getTarget());if(item){this.doItemSelect(item,evt||{});}},getPropertyDefaultValue:function(propName){var theme=mstrApp.getThemeClassName(),v=null;switch(propName){case $ENUM_FORMAT_PROPERTIES.SELECTOR_SELECTION_COLOR:v=theme==="mojo-theme-light"?"#34ABEB":"#34ABEB";break;case $ENUM_FORMAT_PROPERTIES.COLOR:v=theme==="mojo-theme-light"?"#444649":"#ffffff";break;}return v;},updateScrollbars:function updateScrollbars(){if(this.hasRendered&&this.orientation==="v"){this.scrollboxNode.style.height=this.height;}this._super();}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.vi.ui.rw.selectors.LinkList,{onorientationChange:function(){assignNodeWidths.call(this);}});}());
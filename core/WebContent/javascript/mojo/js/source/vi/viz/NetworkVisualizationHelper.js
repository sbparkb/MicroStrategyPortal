(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.vi.viz.DropZoneHelper","mstrmojo.XMLBuilder");var $HASH=mstrmojo.hash,$ARR=mstrmojo.array,FROM_ITEM="fromitem",TO_ITEM="toitem",EDGE_COLOR="edgecolorby",EDGE_SIZE="edgesizeby",NODE_SIZE="nodesizeby";mstrmojo.vi.viz.NetworkVisualizationHelper=mstrmojo.declare(mstrmojo.vi.viz.DropZoneHelper,null,{scriptClass:"mstrmojo.vi.viz.NetworkVisualizationHelper",fromItemAttribute:null,toItemAttribute:null,edgeColorMetric:null,edgeSizeMetric:null,nodeSizeMetric:null,getNetworkMetrics:function(){return[this.nodeSizeMetric,this.edgeSizeMetric,this.edgeColorMetric].filter(function(o){return o!==null;});},getXml:function getXml(){var xml=new mstrmojo.XMLBuilder(),fnAddChildIfExists=function(nodeName,attrName,attrValue){if(attrValue){xml.addChild(nodeName);xml.addAttribute(attrName,attrValue.did);xml.closeElement();}},valueAttr="value";xml.addChild("props");xml.addChild("widgetProps");xml.addChild("fmt");var fromItemAttribute=this.fromItemAttribute,toItemAttribute=this.toItemAttribute;fnAddChildIfExists(FROM_ITEM,valueAttr,this.fromItemAttribute);fnAddChildIfExists(TO_ITEM,valueAttr,this.toItemAttribute);fnAddChildIfExists(EDGE_COLOR,valueAttr,this.edgeColorMetric);fnAddChildIfExists(EDGE_SIZE,valueAttr,this.edgeSizeMetric);fnAddChildIfExists(NODE_SIZE,valueAttr,this.nodeSizeMetric);xml.closeElement();xml.closeElement();xml.closeElement();return xml.toString();},setData:function setData(p){if(!p){return ;}var ths=this,fn=function(dz,dest){if(dz){var dst=ths[dest];arr=dz.TemplateUnit||dz.TemplateMetric;if(arr){arr.forEach(function(x){var item=$HASH.copy(x);if(!item.did){item.did=item.id;}if(dst instanceof Array){dst.push(item);}else{ths[dest]=item;}});}}};fn(p[$NWRK.PROP_FROMITEM],"fromItemAttribute");fn(p[$NWRK.PROP_TOITEM],"toItemAttribute");fn(p[$NWRK.PROP_COLORBY],"edgeColorMetric");fn(p[$NWRK.PROP_SIZEBY],"edgeSizeMetric");fn(p[$NWRK.PROP_ITEMSIZE],"nodeSizeMetric");},getAddDropZonesAction:function(){var h=this,r={act:"updateTemplate",keyContext:this.node.k,actions:[]};[{n:"fromItemAttribute",zone:"FromItem"},{n:"toItemAttribute",zone:"ToItem"},{n:"edgeColorMetric",zone:"ColorBy",t:4},{n:"nodeSizeMetric",zone:"ItemSize",t:4},{n:"edgeSizeMetric",zone:"SizeBy",t:4}].forEach(function(item){var objs=[].concat(h[item.n]||[]),id=mstrmojo.vi.viz.EnumDSSDropZones[item.zone];if(objs&&objs.length){objs.forEach(function(obj){r.actions.push({act:"addDropZoneUnit",zoneId:id,unitId:obj.did,unitType:obj.t});});}});return r;}});var $NWRK=mstrmojo.vi.viz.NetworkVisualizationHelper;$NWRK.PROP_FROMITEM="from";$NWRK.PROP_TOITEM="to";$NWRK.PROP_COLORBY="ColorBy";$NWRK.PROP_SIZEBY="SizeBy";$NWRK.PROP_ITEMSIZE="itemsz";}());
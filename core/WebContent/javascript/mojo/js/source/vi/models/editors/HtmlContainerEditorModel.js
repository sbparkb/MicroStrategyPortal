(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.Button","mstrmojo.vi.models.editors.EditorModel","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.models.FormatModel","mstrmojo.ui.ScrollableTextArea");var $STR=mstrmojo.string,$FORMAT_MODEL=mstrmojo.models.FormatModel;var STR_IFRAME="url",STR_HTML_TEXT="htmlText";var TYPE_BUTTON_ITEMS=[{n:mstrmojo.desc(4555,"iFrame"),v:0,id:0},{n:mstrmojo.desc(4554,"Html Text"),v:1,id:1}];function changeUnitFormats(formats,propertyName,newValue,oldValue){var host=this.getHost(),htmlBox=host.parent,fnChangeFmtValue=function(value){$FORMAT_MODEL.updateFormatBlock(formats,propertyName,value);if(!htmlBox.parent){htmlBox=this.getHost().parent;}htmlBox.clearSlotBackgroundCSS("domNode");htmlBox.applyCSSFormatToNode("domNode",formats);htmlBox.selectVIUnit(true);};this.docModel.saveUnitFormatProperty(htmlBox,[{formatType:undefined,propertyName:propertyName,newValue:newValue,oldValue:oldValue}],{success:fnChangeFmtValue.bind(this,newValue,oldValue)},mstrmojo.DocDataService.SUPPRESS_DATA,{silent:true,undo:fnChangeFmtValue.bind(this,oldValue,newValue),redo:fnChangeFmtValue.bind(this,newValue,oldValue)});}mstrmojo.vi.models.editors.HtmlContainerEditorModel=mstrmojo.declare(mstrmojo.vi.models.editors.EditorModel,null,{scriptClass:"mstrmojo.vi.models.HtmlContainerEditorModel",help:"dashboard_editor_html_container_properties.htm",getEditorContents:function getEditorContents(){if(!mstrApp.allowWebDashboardDesign()||(!mstrApp.isSingleTier&&!this.docModel.controller.rootCtrl.resolveFeature("create-html-container"))){return[];}var id=this.id,host=this.getHost(),data=host.node.data,htmlBox=host.parent,HINT_STR=htmlBox.getHintText(),hostFormats=host.getFormats(),containerGroup=new mstrmojo.ui.editors.controls.ContainerGroup({showBackgroundNoFill:false,showBorderNoFill:false,onGroupValueChange:function(propertyName,newValue,oldValue){changeUnitFormats.call(mstrmojo.all[id],hostFormats,propertyName,newValue,oldValue);}}),htmlType=htmlBox.htmlType;containerGroup.setFormatSource(hostFormats);return[this.getEditorGroup([this.getButtonBar(TYPE_BUTTON_ITEMS,htmlType,function(newItem){var newHTMLType=newItem.v,textArea=this.parent.textArea;textArea.set("emptyText",HINT_STR[newHTMLType]);textArea.value=htmlBox.defn[newHTMLType?STR_HTML_TEXT:STR_IFRAME];textArea.refresh();},{alias:"typeBtn",showIcon:false,cssClass:"htmlTypeBtn"}),{scriptClass:"mstrmojo.ui.ScrollableTextArea",alias:"textArea",cssClass:"htmlText",value:$STR.decodeHtmlString(data.rv||data.v),emptyText:HINT_STR[htmlType],maxLength:undefined,keepEmpty:true,onfocus:function onfocus(){htmlBox.setDefaultTextCaretPosition(this.inputNode,this.emptyText);if(this.inputNode.value===this.emptyText){this.scrollNode.scrollTop=35;}}},mstrmojo.Button.newWebButton(mstrmojo.desc(8708,"OK"),function(){var parent=this.parent;htmlBox.updateHtmlBox(parent.typeBtn.selectedItem.v,parent.textArea.value);htmlBox.hideControlOverlay();},true)]),this.getEditorGroup([containerGroup])];}});}());
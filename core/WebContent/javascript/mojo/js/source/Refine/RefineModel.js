(function(){mstrmojo.requiresDescs(12575,12316,12317,12319,12331,14244,14245,14246,14247,14248,14249,14250,14251,14252,14253,14254,14255,14256,14257,14258,14259,14260,14261,14262,14263,14264,14265,14266,14267,12339,12341,12342,13957,13958,12344,12345,14268,14269,14270,14271,14272,14273,14274,14275,14276,14277,14278,14279,14280,14288,14289);mstrmojo.requiresCls("mstrmojo.hash");var $HASH=mstrmojo.hash;mstrmojo.Refine.RefineModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.Refine.RefineModel",data:{},start:0,limit:50,columns:{},history:{},operations:{entries:[]},engine:JSON.stringify({facets:[],mode:"row-based"}),hasUploadData:false,sampleStatus:null,transformations:{Delete:{Colomn:{op:"core/column-removal",description:mstrmojo.desc(12575,"Delete Column")+" [[column name]]",columnName:"[column name]"},RowsContains:{op:"core/row-removal",description:mstrmojo.desc(14244,"Delete Row(s) Where Cell Contains ####")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[{query:"[text]",name:"[column name]",caseSensitive:true,columnName:"[column name]",type:"text",mode:"regex"}],mode:"row-based"}},RowsBegins:{op:"core/row-removal",description:mstrmojo.desc(14245,"Delete Row(s) Where Cell Begins With ####")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[{query:"[text]",name:"[column name]",caseSensitive:true,columnName:"[column name]",type:"text",mode:"regex"}],mode:"row-based"}},RowsEnds:{op:"core/row-removal",description:mstrmojo.desc(14263,"Delete Row(s) Where Cell Ends With ####")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[{query:"[text]",name:"[column name]",caseSensitive:true,columnName:"[column name]",type:"text",mode:"regex"}],mode:"row-based"}},RowsBlank:{op:"core/row-removal",description:mstrmojo.desc(14246,"Remove Row(s) Where Cell Is Empty")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[{expression:"value",invert:false,selectError:false,omitError:false,name:"[column name]",selectBlank:true,columnName:"[column name]",omitBlank:false,type:"list",selection:[]}],mode:"row-based"}},RowsEquals:{op:"core/row-removal",description:mstrmojo.desc(14288,"Delete Row(s) Where Cell Equals To ####")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[{invert:false,expression:"value",selectError:false,omitError:false,selectBlank:false,name:"[column name]",omitBlank:false,columnName:"[column name]",type:"list",selection:[{v:{v:"[value]",l:"[value]"}}]}],mode:"row-based"}},RowsNotEquals:{op:"core/row-removal",description:mstrmojo.desc(14289,"Delete Row(s) Where Cell Not Equals To ####")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[{invert:true,expression:"value",selectError:false,omitError:false,selectBlank:false,name:"[column name]",omitBlank:false,columnName:"[column name]",type:"list",selection:[{v:{v:"[value]",l:"[value]"}}]}],mode:"row-based"}},RemoveDuplicateCells:{op:"core/row-deduplicate",description:mstrmojo.desc(12316,"Remove Duplicate Cells")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",columnName:"[column name]",engineConfig:{facets:[],mode:"row-based"},mode:"column-based"},RemoveDuplicateRows:{op:"core/row-deduplicate",description:mstrmojo.desc(12317,"Remove Duplicate Rows")+" (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},mode:"row-based"},DeleteRowsInTheView:{op:"core/row-removal",description:mstrmojo.desc(null,"Deleted rows meeting the requirement")+": [Requirement] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"}},DeleteRowsNotInTheView:{op:"core/row-removal",description:mstrmojo.desc(null,"Deleted rows not meeting the requirement")+": [Requirement] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},invert:true}},Extract:{on:{op:"core/column-addition",description:mstrmojo.desc(14247,"Extract On ####")+" {[new column name]} [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},newColumnName:"[column name]",columnInsertIndex:1,baseColumnName:"[column name]",expression:"grel:trim(partition(value, [separator])[1])",onError:"set-to-blank"},fromTo:{op:"core/column-addition",description:mstrmojo.desc(12319,"Extract By Fixed Length")+" {[new column name]} [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},newColumnName:"[column name]",columnInsertIndex:1,baseColumnName:"[column name]",expression:"grel:substring(value, [from], [to])",onError:"set-to-blank"},beforeFirst:{op:"core/column-addition",description:mstrmojo.desc(14248,"Extract Before First ####")+" {[new column name]} [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},newColumnName:"[column name]",columnInsertIndex:1,baseColumnName:"[column name]",expression:"grel:trim(partition(value, [separator])[0])",onError:"set-to-blank"},afterFirst:{op:"core/column-addition",description:mstrmojo.desc(14249,"Extract After First ####")+" {[new column name]} [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},newColumnName:"[column name]",columnInsertIndex:1,baseColumnName:"[column name]",expression:"grel:trim(partition(value, [separator])[2])",onError:"set-to-blank"},beforeLast:{op:"core/column-addition",description:mstrmojo.desc(14264,"Extract Before Last ####")+" {[new column name]} [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},newColumnName:"[column name]",columnInsertIndex:1,baseColumnName:"[column name]",expression:"grel:trim(rpartition(value, [separator])[0])",onError:"set-to-blank"},afterLast:{op:"core/column-addition",description:mstrmojo.desc(14265,"Extract After Last ####")+" {[new column name]} [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},newColumnName:"[column name]",columnInsertIndex:1,baseColumnName:"[column name]",expression:"grel:trim(rpartition(value, [separator])[2])",onError:"set-to-blank"}},FindAndReplace:{CharInCell:{op:"core/text-transform",description:mstrmojo.desc(14250,"Find And Replace Characters In Cell From #### To @@@@")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"grel:replace (value, [from], [to])",onError:"keep-original",repeat:false,repeatCount:10},CellContains:{op:"core/text-transform",description:mstrmojo.desc(14251,"Find And Replace Cell Where Cell Contains #### To @@@@")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"grel:if(contains(value, [from]), replace(value, value, [to]), value)",onError:"keep-original",repeat:false,repeatCount:10},CellBeginsWith:{op:"core/text-transform",description:mstrmojo.desc(14252,"Find And Replace Cell Where Cell Begins With #### To @@@@")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"grel:if(startsWith(value, [from]), replace(value, value, [to]), value)",onError:"keep-original",repeat:false,repeatCount:10},CellEndsWith:{op:"core/text-transform",description:mstrmojo.desc(14253,"Find And Replace Cell Where Cell Ends With #### To @@@@")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"grel:if(endsWith(value, [from]), replace(value, value, [to]), value)",onError:"keep-original",repeat:false,repeatCount:10},CutOn:{op:"core/text-transform",description:mstrmojo.desc(14514,"Remove Characters")+" #### [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"grel:replace (value, [separator], '')",onError:"keep-original",repeat:false,repeatCount:10},CutBefore:{op:"core/text-transform",description:mstrmojo.desc(14515,"Remove Characters Before")+" #### [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"grel:trim(if(isBlank(partition(value, [separator])[1]), value, partition(value, [separator])[1] + partition(value, [separator])[2]))",onError:"keep-original",repeat:false,repeatCount:10},CutAfter:{op:"core/text-transform",description:mstrmojo.desc(14516,"Remove Characters After")+" #### [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"grel:trim(partition(value, [separator])[0] + partition(value, [separator])[1])",onError:"keep-original",repeat:false,repeatCount:10}},split:{bySeparator:{op:"core/column-split",description:mstrmojo.desc(14260,"Split On ####")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},separatorSolutionInt:0,columnName:"[column name]",guessCellType:true,removeOriginalColumn:true,mode:"separator",separator:",",regex:false,maxColumns:0},byFieldLengths:{op:"core/column-split",description:mstrmojo.desc(12331,"Split By Fixed Length")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},fieldForward:true,keepRest:true,columnName:"[column name]",guessCellType:true,removeOriginalColumn:true,mode:"lengths",fieldLengths:[]},beforeFirst:{op:"core/column-split",description:mstrmojo.desc(14257,"Split Before First ####")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},separatorSolutionInt:1,columnName:"[column name]",guessCellType:true,removeOriginalColumn:true,mode:"separator",separator:",",regex:false,maxColumns:2},afterFirst:{op:"core/column-split",description:mstrmojo.desc(14258,"Split After First ####")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},separatorSolutionInt:3,columnName:"[column name]",guessCellType:true,removeOriginalColumn:true,mode:"separator",separator:",",regex:false,maxColumns:2},afterLast:{op:"core/column-split",description:mstrmojo.desc(14259,"Split After Last ####")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},separatorSolutionInt:4,columnName:"[column name]",guessCellType:true,removeOriginalColumn:true,mode:"separator",separator:",",regex:false,maxColumns:2},cellIntoRow:{op:"core/multivalued-cell-split",description:mstrmojo.desc(13884,"Split Cell Into Rows On Separator")+" [column name]",columnName:"[column name]",keyColumnName:"[key column name]",separator:",",mode:"plain"}},TransformCell:{titlecase:{op:"core/text-transform",description:mstrmojo.desc(14268,"To Title Case")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[[column name]]",expression:"value.toTitlecase()",onError:"keep-original",repeat:false,repeatCount:10},uppercase:{op:"core/text-transform",description:mstrmojo.desc(14269,"To Uppercase")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"value.toUppercase()",onError:"keep-original",repeat:false,repeatCount:10},lowercase:{op:"core/text-transform",description:mstrmojo.desc(14270,"To Lowercase")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"value.toLowercase()",onError:"keep-original",repeat:false,repeatCount:10},unescape:{op:"core/text-transform",description:mstrmojo.desc(12339,"Unescape HTML")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"value.unescape('html')",onError:"keep-original",repeat:false,repeatCount:10},number:{op:"core/text-transform",description:mstrmojo.desc(14271,"To Number")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"value.toNumber()",onError:"set-to-blank",repeat:false,repeatCount:10},text:{op:"core/text-transform",description:mstrmojo.desc(14272,"To Text")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"toString(value)",onError:"set-to-blank",repeat:false,repeatCount:10},date:{op:"core/text-transform",description:mstrmojo.desc(14273,"To Date")+" [format] [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"grel:toDate(value, [format])",onError:"set-to-blank",repeat:false,repeatCount:10},fillDown:{op:"core/fill-down",description:mstrmojo.desc(12341,"Fill Down")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]"},blankDown:{op:"core/blank-down",description:mstrmojo.desc(12342,"Blank Down")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]"},padBefore:{op:"core/text-transform",description:mstrmojo.desc(13957,"Pad Before")+" [string] [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"record-based"},columnName:"[column name]",expression:'grel:[string] + if(isNull(value), "", value)',onError:"keep-original",repeat:false,repeatCount:10},padAfter:{op:"core/text-transform",description:mstrmojo.desc(13958,"Pad After")+" [string] [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"record-based"},columnName:"[column name]",expression:'grel:if(isNull(value), "", value) + [string]',onError:"keep-original",repeat:false,repeatCount:10}},Whitespace:{trim:{op:"core/text-transform",description:mstrmojo.desc(12344,"Trim Leading And Trailing Whitespace")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"value.trim()",onError:"keep-original",repeat:false,repeatCount:10},collapse:{op:"core/text-transform",description:mstrmojo.desc(12345,"Collapse Consecutive Whitespace")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"value.replace(/\\s+/,' ')",onError:"keep-original",repeat:false,repeatCount:10}},Other:{duplicate:{op:"core/column-addition",description:mstrmojo.desc(14274,"Duplicate Column")+" {[new column name]} [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},newColumnName:"[column name]",columnInsertIndex:1,baseColumnName:"[column name]",expression:"grel:value",onError:"set-to-blank"},Rename:{op:"core/column-rename",description:mstrmojo.desc(14275,"Rename Column [####] To {@@@@}"),oldColumnName:"[column name]",newColumnName:"[column name]"},ConcatenateColumns:{op:"core/column-addition",description:mstrmojo.desc(14276,"Concatenate Column [####] And Column [@@@@] To Column {@@@@}")+" (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},newColumnName:"[column name]",columnInsertIndex:"[index]",baseColumnName:"[column name 1]",expression:'grel:if(isNull(cells["[column name 1]"]),"",cells["[column name 1]"].value) + "" + if(isNull(cells["[column name 2]"]), "", cells["[column name 2]"].value)',onError:"set-to-blank"},TransposeColumnsIntoRows:{op:"core/transpose-columns-into-rows",description:mstrmojo.desc(14278,"Transpose cells in #### column(s) starting with [@@@@] into rows in two new columns named [@@@@] and [@@@@]"),startColumnName:"[start column]",columnCount:7,ignoreBlankCells:true,fillDown:true,keyColumnName:"[new column 1]",valueColumnName:"[new column 2]"}},URL:{newColumnName:"[column name]",columnInsertIndex:"[index]",baseColumnName:"[column name]",urlExpression:"[ex]",onError:"set-to-blank",delay:5000},EditCell:{applyToAll:{op:"core/mass-edit",description:mstrmojo.desc(14279,"Edit Cell")+" [[column name]] (#### "+mstrmojo.desc(2968,"Rows")+")",engineConfig:{facets:[],mode:"row-based"},columnName:"[column name]",expression:"value",edits:[{fromBlank:false,fromError:false,from:["[from]"],to:"[to]",type:"text"}]},singleEdit:{op:"core/single-edit",description:mstrmojo.desc(14280,"Edit cell in row #### at cell #### value is: ####"),engineConfig:{facets:[],mode:"row-based"},row:0,col:0,to:"[to]"}}},suggestions:{partialCell:{split:[{description:mstrmojo.desc(12331,"Split By Fixed Length"),suggestion_type:1,suggestion_subtype:0,operations:[{}]},{description:mstrmojo.desc(14266,"Split Before ####"),suggestion_type:1,suggestion_subtype:3,operations:[{}]},{description:mstrmojo.desc(14267,"Split After ####"),suggestion_type:1,suggestion_subtype:2,operations:[{}]},{description:mstrmojo.desc(14260,"Split On ####"),suggestion_type:1,suggestion_subtype:1,operations:[{}]}],extract:[{description:mstrmojo.desc(14261,"Extract Before ####"),suggestion_type:1,suggestion_subtype:6,operations:[{}]},{description:mstrmojo.desc(14262,"Extract After ####"),suggestion_type:1,suggestion_subtype:5,operations:[{}]},{description:mstrmojo.desc(14247,"Extract On ####"),suggestion_type:1,suggestion_subtype:4,operations:[{}]}],cut:[{description:mstrmojo.desc(14515,"Remove Characters Before")+" ####",suggestion_type:1,suggestion_subtype:9,operations:[{}]},{description:mstrmojo.desc(14516,"Remove Characters After")+" ####",suggestion_type:1,suggestion_subtype:8,operations:[{}]},{description:mstrmojo.desc(14514,"Remove Characters")+" ####",suggestion_type:1,suggestion_subtype:7,operations:[{}]}],deleteRows:[{description:mstrmojo.desc(14244,"Delete Row(s) Where Cell Contains ####"),operations:[{}]},{description:mstrmojo.desc(null,"Delete Row Included In Selectors"),suggestion_type:2,operations:[{}]},{description:mstrmojo.desc(null,"Delete Row Not-included In Selectors"),suggestion_type:2,operations:[{}]}]},cell:[{}],row:[{}],column:[{description:mstrmojo.desc(12575,"Delete Column"),operations:[{}]},{description:mstrmojo.desc(12341,"Fill Down"),operations:[{}]},{description:mstrmojo.desc(12342,"Blank Down"),operations:[{}]},{description:mstrmojo.desc(14268,"To Title Case"),operations:[{}]},{description:mstrmojo.desc(14269,"To Uppercase"),operations:[{}]},{description:mstrmojo.desc(14270,"To Lowercase"),operations:[{}]},{description:mstrmojo.desc(14246,"Remove Row(s) Where Cell Is Empty")+" [[column name]]",operations:[{}]},{description:mstrmojo.desc(12345,"Collapse Consecutive Whitespace"),operations:[{}]},{description:mstrmojo.desc(14277,"Transpose Columns to Row from [####] to [@@@@]"),operations:[{}]}]},populateData:function populateData(result){this.set("data",result);},populateColumns:function populateColumns(result){this.set("columns",result);},populateHistory:function populateHistory(result){this.set("history",result);},populateOperations:function populateOperations(result){this.set("operations",result);},getCurrentOperations:function(){var operations=$HASH.clone(this.operations),len,entries,entry,i;for(i=0;i<operations.entries.length;i++){entry=operations.entries[i];entry.selected=true;}entries=operations&&operations.entries;if(entries&&entries.length>0){len=entries.length;entry=entries[len-1];if(!("op" in entry.operation)||("estimatedRow" in entry.operation)){entries.pop();}}return operations;},populateSampleStatus:function populateSampleStatus(result){this.set("sampleStatus",result);},hasAddSample:function hasAddSample(){var ret=!!this.sampleStatus;if(ret){if(this.sampleStatus.total<=1000||this.sampleStatus.current<=0){ret=false;}}return ret;}});}());
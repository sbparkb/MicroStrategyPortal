(function(){mstrmojo.requiresCls("mstrmojo.array");var DEFAULT_COLOR="#000000",$ROUND=Math.round;function num2Hex(n){return("0"+parseInt(n,10).toString(16)).slice(-2);}mstrmojo.color=mstrmojo.provide("mstrmojo.color",{rgbStr2rgb:function rgbStr2rgb(color){return color.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i).slice(1);},rgbStr2hex:function rgbStr2hex(color){if(color.indexOf("rgb")>=0){var rgb=this.rgbStr2rgb(color);return"#"+this.rgb2hex(rgb[0],rgb[1],rgb[2]);}return color;},rgb2hex:function rgb2hex(r,g,b){return num2Hex(r)+num2Hex(g)+num2Hex(b);},rgb2hsv:function rgb2hsv(r,g,b){var min=Math.min(r,g,b),max=Math.max(r,g,b),h=0,s,v;v=max/255;s=(max!==0)?(parseFloat(max)-parseFloat(min))/parseFloat(max):0;if(s===0){h=0;}else{var d=max-min,red=(max-r)/d,green=(max-g)/d,blue=(max-b)/d;if(r===max){h=blue-green;}else{if(g===max){h=2+red-blue;}else{h=4+green-red;}}h=h/6;if(h<0){h=h+1;}}return[$ROUND(h*360),$ROUND(s*100),$ROUND(v*100)];},rgb2hsl:function rgb2hsl(r,g,b){r/=255;g/=255;b/=255;var max=Math.max(r,g,b),min=Math.min(r,g,b),l=(max+min)/2,h,s;if(max===min){h=s=0;}else{var delta=max-min;s=l>0.5?delta/(2-max-min):delta/(max+min);switch(max){case r:h=(g-b)/delta+(g<b?6:0);break;case g:h=(b-r)/delta+2;break;case b:h=(r-g)/delta+4;break;}h/=6;}return[h,s,l];},hsl2rgb:function hsl2rgb(h,s,l){var fnHue2Rgb=function fnHue2Rgb(p,q,t){if(t<0){t+=1;}if(t>1){t-=1;}if(t<1/6){return p+(q-p)*6*t;}if(t<1/2){return q;}if(t<2/3){return p+(q-p)*(2/3-t)*6;}return p;},r,g,b;if(s===0){r=g=b=l;}else{var q=l<0.5?l*(1+s):l+s-l*s,p=2*l-q;r=fnHue2Rgb(p,q,h+1/3);g=fnHue2Rgb(p,q,h);b=fnHue2Rgb(p,q,h-1/3);}return[$ROUND(r*255),$ROUND(g*255),$ROUND(b*255)];},hsl2hex:function hsl2hex(h,s,l){return"#"+mstrmojo.array.map(this.hsl2rgb(h,s,l),function(n){return num2Hex(n);}).join("");},hex2rgb:function hex2rgb(s){var color=this.fixFullHexValue("#"+s.replace("#","")),rgb=[],i;color=color.replace("#","");for(i=0;i<3;i++){rgb.push(parseInt(color.substr(i*2,2),16));}return rgb;},hex2bgr:function hex2bgr(s){return this.hex2rgb(s).reverse();},hex2hsv:function hex2hsv(s){var rgb=this.hex2rgb(s);return this.rgb2hsv(rgb[0],rgb[1],rgb[2]);},hex2hsl:function hex2hsl(color){return this.rgb2hsl.apply(this,this.hex2rgb(color));},hsv2rgb:function hsv2rgb(h,s,v){h=h/360;s=s/100;v=v/100;var r,g,b;if(s===0){r=v*255;g=v*255;b=v*255;}else{var th=h*6;if(th===6){th=0;}var i=Math.floor(th);var p=v*(1-s);var q=v*(1-s*(th-i));var t=v*(1-s*(1-(th-i)));var tr,tg,tb;switch(i){case 0:tr=v;tg=t;tb=p;break;case 1:tr=q;tg=v;tb=p;break;case 2:tr=p;tg=v;tb=t;break;case 3:tr=p;tg=q;tb=v;break;case 4:tr=t;tg=p;tb=v;break;default:tr=v;tg=p;tb=q;break;}r=tr*255;g=tg*255;b=tb*255;}return[$ROUND(r),$ROUND(g),$ROUND(b)];},hsv2hex:function hsv2hex(h,s,v){var rgb=this.hsv2rgb(h,s,v);return this.rgb2hex(rgb[0],rgb[1],rgb[2]);},getContrastingColor:function getContrastingColor(hex,lightColor,darkColor){var rgb=this.hex2rgb(hex);return(((rgb[0]*299)+(rgb[1]*587)+(rgb[2]*114))/1000<125)?lightColor:darkColor;},getHighlightColor:function getHighlightColor(rgb,moreDim){var r,g,b,luminosity,refRGB=this.hex2rgb(!moreDim?"#FFCE7F":"#EFE6D8"),R1=parseInt(rgb[0],10),G1=parseInt(rgb[1],10),B1=parseInt(rgb[2],10),R2=parseInt(refRGB[0],10),G2=parseInt(refRGB[1],10),B2=parseInt(refRGB[2],10);r=(R1*R2)/255;g=(G1*G2)/255;b=(B1*B2)/255;luminosity=R1*0.3+G1*0.59+B1*0.11;if(luminosity<85){r=r+(63*(85-luminosity)/85);r=r>255?255:r;g=g+(63*(85-luminosity)/85);g=g>255?255:g;b=b+(63*(85-luminosity)/85);b=b>255?255:b;}return"#"+this.rgb2hex($ROUND(r),$ROUND(g),$ROUND(b));},get3DBorderColor:function get3DBorderColor(bgRGB,stroke){var lum=parseInt(bgRGB[0],10)*0.3+parseInt(bgRGB[1],10)*0.59+parseInt(bgRGB[2],10)*0.11;var r=parseInt(bgRGB[0],10);var g=parseInt(bgRGB[1],10);var b=parseInt(bgRGB[2],10);switch(stroke){case"light":if(lum>150){r=r*0.9;g=g*0.9;b=b*0.9;}else{r=r*0.6+102;g=g*0.6+102;b=b*0.6+102;}break;case"dark":if(lum>10){r=r*0.4;g=g*0.4;b=b*0.4;}else{r=r*0.8+30;g=g*0.8+30;b=b*0.8+30;}break;}return"#"+this.rgb2hex($ROUND(r),$ROUND(g),$ROUND(b));},encodeColor:function encodeColor(v,d){if(d!==undefined&&(v===null||v.length===0||v==="undefined")){v=d;}if(v==="transparent"){return -1;}if(parseInt(v,10)===-2){return -2;}if(v.substring(0,1)==="#"){v=v.substring(1);}return parseInt(v.substring(4)+v.substring(2,4)+v.substring(0,2),16);},decodeColor:function decodeColor(color){color=parseInt(color,10);if(color===0){return DEFAULT_COLOR;}var rgb=16777216+(color&255)*65536+(color&65280)+(color&16711680)/65536;return"#"+rgb.toString(16).substring(1).toUpperCase();},fixFullHexValue:function fixFullHexValue(color){if(color&&color.length===4){return color.replace(/([0-9a-f])/ig,"$1$1");}return color;},findMidColorHex:function findMidColorHex(hexColorStart,hexColorEnd){var start=this.hex2rgb(hexColorStart),end=this.hex2rgb(hexColorEnd),mid=[];start.forEach(function(startValue,i){mid.push(parseInt((startValue+end[i])/2,10));});return("#"+this.rgb2hex(mid[0],mid[1],mid[2]));}});}());
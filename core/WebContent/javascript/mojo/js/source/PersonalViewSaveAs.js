(function(){mstrmojo.requiresCls("mstrmojo.dnd","mstrmojo.Editor");var _V=mstrmojo.validation;function savePV(me){var okbtn=me.btns.ok,calbtn=me.btns.cancel,params={taskId:"savePersonalView",messageID:me.msgID,objectType:me.objectType,objectSubType:me.objectSubType,subName:me.getName()},cb={success:function(res){okbtn.set("enabled",true);calbtn.set("enabled",true);me.close();var msg=me.succMsg;if(!msg){var appName=mstrApp.name,pre='<a href="'+appName+"?evt=3031&src="+appName+'.3031"  onclick="return submitLink(this, event)"  class="mstrLink" style="color:#0C84C4;text-decoration:none">';msg=mstrmojo.desc("14123").replace("###","</A>").replace("##",pre);}mstrmojo.alert(msg,null,me.confirmTitle,null,null,{allowHTML:true});},failure:function(res){okbtn.set("enabled",true);calbtn.set("enabled",true);me.close();mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}};okbtn.set("enabled",false);calbtn.set("enabled",false);mstrmojo.xhr.request("POST",mstrConfig.taskURL,cb,params);}mstrmojo.PersonalViewSaveAs=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.PersonalViewSaveAs",title:mstrmojo.desc(9173,"Create Personal View"),name:"New Personal View",cssText:"width: 300px;",msgID:null,objectType:null,objectSubType:null,succMsg:null,confirmTitle:null,children:[{scriptClass:"mstrmojo.HBox",alias:"contPanel",cssText:"margin: 11px 0",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.ValidationTextBox",alias:"name",cssText:"width: 225px; margin-left: 8px;",required:true,dtp:mstrmojo.expr.DTP.CHAR,constraints:{trigger:_V.TRIGGER.ALL,validator:function(v){var sc=_V.STATUSCODE,r={id:this.id,code:sc.VALID,msg:""};if(v.length>250){r.code=sc.INVALID_VALIDATOR;r.msg="Please enter a name no more than 250 characters";}return r;}},bindings:{value:function(){return mstrmojo.string.decodeHtmlString(this.parent.parent.name);}}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btns",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",onclick:function(){savePV(this.parent.parent);},bindings:{enabled:function(){var v=this.parent.parent.contPanel.name.validationStatus;return(v&&v.code==_V.STATUSCODE.VALID);}}},{scriptClass:"mstrmojo.Button",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",onclick:function(){this.parent.parent.close();}}]}],getName:function(){return this.contPanel.name.value;}});})();
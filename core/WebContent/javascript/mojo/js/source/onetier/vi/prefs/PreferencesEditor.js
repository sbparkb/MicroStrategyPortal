(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.onetier.vi.prefs.PreferencesEditorPanel","mstrmojo.onetier.vi.prefs.ServerConnectionsPanel","mstrmojo.onetier.vi.prefs.GeneralPreferencesPanel","mstrmojo.onetier.vi.prefs.model.PreferencesModel","mstrmojo.ui.List","mstrmojo.hash");var $HASH=mstrmojo.hash,$NWB=mstrmojo.Button.newWebButton,PREFERENCE_GROUP=mstrmojo.onetier.vi.prefs.model.PreferencesModel.PREFERENCES_GROUP;var PREFERENCES_PANEL_CFG=[{n:mstrmojo.desc(2378,"General"),scriptClass:"mstrmojo.onetier.vi.prefs.GeneralPreferencesPanel",prefGroup:PREFERENCE_GROUP.GENERAL},{n:mstrmojo.desc(13810,"Server Connections"),scriptClass:"mstrmojo.onetier.vi.prefs.ServerConnectionsPanel",prefGroup:PREFERENCE_GROUP.SERVER}];function switchPrefereneContainer(tabCfg){var prefsPanel=this.prefsPanel;if(prefsPanel){this.removeChildren(prefsPanel);prefsPanel.destroy();}this.addChildren([$HASH.copy(tabCfg,{scriptClass:"mstrmojo.onetier.vi.prefs.PreferencesEditorPanel",model:this.model,alias:"prefsPanel",height:"373px",width:"660px"})]);}function toggleNativeMenus(enable){var formWrapper=window.FormWrapper;if(formWrapper){formWrapper.toggleNetMenu(enable?"enable":"disable");}}function closeAndDestroyEditor(onlyServerChanges){this.model.savePreferences(onlyServerChanges);this.close();this.destroy();}mstrmojo.onetier.vi.prefs.PreferencesEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.onetier.vi.prefs.PreferencesEditor",cssClass:"onetier-preferences",title:mstrmojo.desc(862,"Preferences"),data:null,connectivityProxy:undefined,prefsPanel:undefined,init:function init(props){this._super(props);var model=this.model=new mstrmojo.onetier.vi.prefs.model.PreferencesModel({data:this.data||{},connectivityProxy:this.connectivityProxy});model.attachEventListener("preferencesEdited",this.id,function(){this.btnHbox.children[0].set("enabled",true);});this.addDisposable(model);this.tabs.select(0);toggleNativeMenus(false);},close:function close(config){this._super(config);toggleNativeMenus(true);},children:[{scriptClass:"mstrmojo.ui.List",alias:"tabs",cssClass:"preferences-tabs cf",items:PREFERENCES_PANEL_CFG,selectionAdded:function selectionAdded(evt){switchPrefereneContainer.call(this.parent,this.items[evt.added[0]]);}}],buttons:[$NWB(mstrmojo.desc(1442,"OK"),function(){var editor=this.parent.parent;editor.prefsPanel.preCloseEditor(closeAndDestroyEditor.bind(editor));},true,{enabled:false}),$NWB(mstrmojo.desc(221,"Cancel"),function(){var editor=this.parent.parent;if(editor.prefsPanel.prefGroup===PREFERENCE_GROUP.SERVER){editor.prefsPanel.clearCache();}closeAndDestroyEditor.call(editor,true);})]});}());
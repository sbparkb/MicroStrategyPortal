(function(){mstrmojo.requiresCls("mstrmojo.onetier.vi.prefs.PreferencesEditorPanel","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.LayoutBox","mstrmojo.ui.CheckList","mstrmojo.hash");var $HASH=mstrmojo.hash,COL_CONFIG={col1Width:"65px",dividerWidth:"8px",col2Width:"170px"};var PROXY_CONFIG_TYPE=[{n:mstrmojo.desc(13697,"Use computer's proxy configuration"),v:"default"},{n:mstrmojo.desc(13698,"Use proxy configuration file"),v:"file"},{n:mstrmojo.desc(13699,"Manual proxy configuration"),v:"manual"}];function getPanelChildLayoutOffsets(){return{h:18,w:38};}function savePreferenceDelta(newPrefs){this.model.addPreferenceToDelta(this.prefGroup,newPrefs);}function getDefaultTwoColCtrParams(params){return $HASH.copy(params,$HASH.copy(COL_CONFIG));}function createAndAddAdvancedProxyBox(savedNetworkPreferences){var viewFactory=this.viewFactory,id=this.id,proxyConfig=savedNetworkPreferences.proxycfg,updateAdvancedProxyConfig=function updateAdvancedProxyConfig(propName,propValue){proxyConfig[propName]=propValue;savePreferenceDelta.call(mstrmojo.all[id],savedNetworkPreferences);};this.removeAndDestroyChild(this.advancedProxyBox);this.addChildren([{scriptClass:"mstrmojo.ui.LayoutBox",alias:"advancedProxyBox",proxyLoginBox:undefined,getLayoutOffsets:getPanelChildLayoutOffsets}]);var advancedProxyBox=this.advancedProxyBox,advancedProxyBoxChildren=[];if(savedNetworkPreferences.proxytp==="file"){advancedProxyBoxChildren.push(this.getLabelAndTextBox(mstrmojo.desc(2761,"URL:"),function onvalueChange(){updateAdvancedProxyConfig("url",this.value);},proxyConfig.url,{col1Width:"auto",dividerWidth:"8px",col2Width:"512px"}));}else{if(savedNetworkPreferences.proxytp==="manual"){advancedProxyBoxChildren=[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",col1Width:"253px",col2Width:"253px",children:[this.getLabelAndTextBox(mstrmojo.desc(13700,"HTTP Proxy"),function onvalueChange(){updateAdvancedProxyConfig("n",this.value);},proxyConfig.n,getDefaultTwoColCtrParams({slot:"col1Node"})),this.getLabelAndTextBox(mstrmojo.desc(16,"Port"),function onvalueChange(){updateAdvancedProxyConfig("port",this.value);},proxyConfig.port,getDefaultTwoColCtrParams({slot:"col2Node",col1Width:"auto",col2Width:"85px"}))]},viewFactory.getCheckboxAndLabel(proxyConfig.auth,mstrmojo.desc(13701,"Proxy server requires password"),function(newValue){updateAdvancedProxyConfig("auth",newValue);advancedProxyBox.proxyLoginBox.children.forEach(function(childWidget){childWidget.set("enabled",newValue);});advancedProxyBox.doLayout();}),{scriptClass:"mstrmojo.ui.LayoutBox",alias:"proxyLoginBox",children:[this.getLabelAndTextBox(mstrmojo.desc(1161,"User name:"),function onvalueChange(){updateAdvancedProxyConfig("un",this.value);},proxyConfig.un,$HASH.copy(COL_CONFIG,{enabled:proxyConfig.auth})),this.getLabelAndTextBox(mstrmojo.desc(1162,"Password:"),function onvalueChange(){updateAdvancedProxyConfig("pwd",this.value);},proxyConfig.pwd,$HASH.copy(COL_CONFIG,{enabled:proxyConfig.auth}),{type:"password"})]}];}}advancedProxyBox.addChildren(advancedProxyBoxChildren);this.doLayout();}mstrmojo.onetier.vi.prefs.NetworkPreferencesPanel=mstrmojo.declare(mstrmojo.onetier.vi.prefs.PreferencesEditorPanel,null,{scriptClass:"mstrmojo.onetier.vi.prefs.NetworkPreferencesPanel",cssClass:"ot-network-prefs",layoutConfig:{w:{containerNode:"100%"},xt:true},proxyTpList:undefined,advancedProxyBox:undefined,init:function init(props){this._super(props);var model=this.model,prefGroup=this.prefGroup,savedNetworkPreferences=model.getPreferences(prefGroup),proxyConfigTypeIdx=Math.max(PROXY_CONFIG_TYPE.map(function(item){return item.v;}).indexOf(savedNetworkPreferences.proxytp),0);this.addChildren([{scriptClass:"mstrmojo.ui.CheckList",alias:"proxyTpList",items:PROXY_CONFIG_TYPE,multiSelect:false,orientation:"h",getLayoutOffsets:getPanelChildLayoutOffsets,selectionAdded:function selectionAdded(evt){var panel=this.parent;savedNetworkPreferences.proxytp=this.items[evt.added[0]].v;savePreferenceDelta.call(panel,savedNetworkPreferences);createAndAddAdvancedProxyBox.call(panel,savedNetworkPreferences);}}]);this.proxyTpList.select(proxyConfigTypeIdx);createAndAddAdvancedProxyBox.call(this,savedNetworkPreferences);}});}());
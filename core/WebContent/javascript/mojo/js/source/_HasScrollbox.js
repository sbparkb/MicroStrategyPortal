(function(){mstrmojo.requiresCls("mstrmojo.dom");function validateListener(l){return(l&&l.id);}mstrmojo._HasScrollbox=mstrmojo.provide("mstrmojo._HasScrollbox",{_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,scrollInterval:50,scrollboxNode:undefined,scrollTo:function scrollTo(pos,notifyListeners){var scrollboxNode=this.scrollboxNode;scrollboxNode.scrollLeft=pos.x;scrollboxNode.scrollTop=pos.y;if(notifyListeners){this.notifyScrollListeners(pos);}},connectScrollbox:function cnnScll(listener){if(!validateListener(listener)){return ;}var hash=this.scrollListeners,lid=listener.id;if(!hash){hash={};this.scrollListeners=hash;}if(!hash[lid]){hash[lid]=listener;this.scrollListenerCount++;if(this.scrollListenerCount===1){this._attachScrollDom();}}},disconnectScrollbox:function discnnScll(listener){if(!validateListener(listener)){return ;}var hash=this.scrollListeners,lid=listener.id;if(hash&&hash.hasOwnProperty(lid)){delete this.scrollListeners[lid];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function ntfSclls(evt){var p=evt||this.getScrollPos(),top=p.y,left=p.x;this.scrollboxTop=top;this.scrollboxLeft=left;this.scrollboxRight=left+this.scrollboxWidth;this.scrollboxBottom=top+this.scrollboxHeight;var ls=this.scrollListeners,id;for(id in ls){ls[id].onscroll(this);}},getScrollPos:function getScrollPos(){var node=this.scrollboxNode;return{x:node.scrollLeft,y:node.scrollTop};},_attachScrollDom:function attSbxDom(){var sbn=this.scrollboxNode;if(sbn){var useTouch=this.usesTouches;if(!useTouch){if(!this.scrollCallback){var id=this.id;this.scrollCallback=function(){mstrmojo.all[id].notifyScrollListeners();};}mstrmojo.dom.attachBufferedEvent(sbn,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=useTouch?0:sbn.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=useTouch?0:sbn.scrollLeft;}var fnD=function(d){var css=d.toLowerCase();var x=sbn.style[css];return(!isNaN(x)&&x.charAt(x.length-1)!=="%")?parseInt(x,10):sbn["client"+d];};if(this.scrollboxHeight===null){this.scrollboxHeight=fnD("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=fnD("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=sbn;}},_detachScrollDom:function dtchSbxDm(){var as=this._attachedScrollbox;if(as&&this.scrollCallback){mstrmojo.dom.detachBufferedEvent(as,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function bldRndr(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}});}());
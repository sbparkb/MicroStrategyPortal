(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.ME.Enum");mstrmojo.requiresDescs();var DOM=mstrmojo.dom,STR=mstrmojo.string,WIDGET=mstrmojo.Widget;var delimiterRegExp=/\r?\n?----\r?\n?/;function getDescAndExample(foi){var parts=STR.decodeHtmlString((foi||{}).desc||"",true).split(delimiterRegExp);return{desc:parts[0],example:parts.length===2?parts[1]:""};}mstrmojo.ME.FunctionInfo=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.FunctionInfo",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="mstrmojo-FunctionInfo-container"><div class="mstrmojo-FunctionInfo-syntax"></div><div class="mstrmojo-FunctionInfo-desc"></div><div class="mstrmojo-FunctionInfo-eg"><span class="icon" t="icon"></span><span class="text"></span></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},syntaxNode:function(){return this.domNode.firstChild.firstChild;},descNode:function(){return this.domNode.firstChild.childNodes[1];},egNode:function(){return this.domNode.firstChild.lastChild;},egTextNode:function(){return this.domNode.firstChild.lastChild.lastChild;}},markupMethods:{onvisibleChange:WIDGET.visibleMarkupMethod,onfoiChange:function(){this.syntaxNode.innerHTML=STR.htmlAngles(this.syntax)||"";this.descNode.innerHTML=this.desc;this.egTextNode.innerHTML=this.example;this.egNode.style.display=this.example?"block":"none";this.updateScrollbars();}},foi:{},syntax:"",desc:"",example:"",init:function init(props){this._super(props);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-FunctionInfo");},setupScrollNodes:function setupScrollNodes(){if(!mstrmojo.dom.ISIE8){this.scrollNode=this.containerNode;}},onfoiChange:function onfoiChange(){this.set("syntax",this.getFunctionSyntax());this.set("desc",this.getDesc()+" "+this.getHelpTopic());this.set("example",this.getExample());},getFunctionSyntax:function getFunctionSyntax(foi){var f=foi||this.foi;if(!f){return"";}if(f.did<0){return f.n;}var pars=f.pars,pros=f.pros,sa=[],i,len;sa.push(f.n);pros=mstrmojo.hash.clone(pros)||[];if(f.ios){pros.push({n:"SortBy"});}if(f.sqt===5){pros.push({n:"BreakBy"});}if(this.showFullSyntax){if(pros.length>0){sa.push("<");for(i=0,len=pros.length;i<len;i++){if(mstrmojo.array.indexOf(mstrmojo.ME.Enum.NonExposableParams,pros[i].n)===-1){sa.push(pros[i].n);sa.push(", ");}}sa.pop();sa.push(">");}}sa.push("(");for(i=0,len=pars.length;i<len;i++){sa.push(pars[i].n);if(i!==(len-1)){sa.push(", ");}}sa.push(")");return sa.join("");},getDesc:function getDesc(){return getDescAndExample(this.foi).desc;},getExample:function getExample(){return getDescAndExample(this.foi).example;},getHelpTopic:function getHelpTopic(foi){var f=foi||this.foi;if(!f||f.did===mstrmojo.ME.Enum.SHORTCUT_FUNCTIONS.Row_Count){return"";}return mstrmojo.ME.MetricDataService.getFunctionHelpTopic(f.h);},useRichTooltip:true,showTooltip:function showTooltip(evt,win){var target=DOM.eventTarget(win,evt),item=this.foi;if(target&&target.getAttribute("t")==="icon"){this.richTooltip=this.getTooltip(item,target);if(this.richTooltip){this._super(evt,win);}}},getTooltip:function(item,itemNode){var position=DOM.position(itemNode),content=itemNode.egTip||"";var richTooltip={areaId:item._renderIdx+"text",cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:content,top:position.y-75,left:position.x+position.w-30,enableHover:false};return richTooltip;}});mstrmojo.ME.FunctionInfo.getDescAndExample=getDescAndExample;}());
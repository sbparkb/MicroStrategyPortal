(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.Enum_Keys","mstrmojo.SimpleObjectInputBox");var $ARR=mstrmojo.array,$DOM=mstrmojo.dom,$KEYS=mstrmojo.Enum_Keys,thousandsSeperator=mstrConfig.thousandsSep;var STATES={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};if(thousandsSeperator===undefined){thousandsSeperator=",";}var markup;mstrmojo.TextBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{cssClass:"mstrmojo-TextBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",preBuildRendering:function preBuildRendering(){this.set("maxItemWidth",parseInt(this.parent.contentNode.style.width,10));this._super();},prekeydown:function prekeydown(evt){var e=evt.e;switch(parseInt(e.keyCode||e.charCode,10)){case $KEYS.TAB:case $KEYS.ENTER:$DOM.preventDefault(evt.hWin,e);var text=this.inputBox.value;if(text){if($ARR.find(this.items,"v",text)===-1){this.onSuggestionItemSelect({n:text,v:text});}else{this.setDefaultState();}}break;case $KEYS.ESCAPE:this.setDefaultState();break;case $KEYS.BACKSPACE:if(!this.getSearchPattern()){$DOM.preventDefault(evt.hWin,e);var items=this.items&&this.items.concat();if(items&&items.length){items.splice(items.length-1,1);this.set("items",items);var id=this.id;window.setTimeout(function(){mstrmojo.all[id].set("state",STATES.ADDING);},0);}}break;}},prekeyup:function prekeyup(evt){}});}());
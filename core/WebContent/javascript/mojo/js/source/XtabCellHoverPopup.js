(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo.dom");var $D=mstrmojo.dom;var OPEN_CELL_MENU="openXtabCellMenu";mstrmojo.XtabCellHoverPopup={cssClass:"mstrXtabCellHoverPopup",scriptClass:"mstrmojo.Popup",slot:"overlayNode",autoCloses:true,children:[{scriptClass:"mstrmojo.Button",alias:"btn",onmousedown:function(evt){this.openPopup(true,evt);$D.stopPropogation(evt.hWin,evt.e);$D.preventDefault(evt.hWin,evt.e);return false;},openPopup:function(singleCellClick,evt){var dl=this.xtab[OPEN_CELL_MENU]?this.xtab:mstrmojo.findAncestor(this.xtab,OPEN_CELL_MENU);if(dl){dl.openXtabCellMenu({xtab:this.xtab,td:this.td,btn:this,cmPos:this.cmPos,lockIW:this.xtab,singleCellClick:singleCellClick===true,evt:evt});}this.domNode.oncontextmenu=function(e){$D.stopPropogation(window,e);$D.preventDefault(window,e);return false;};},closePopup:function(){var dl=mstrmojo.findAncestor(this.xtab,OPEN_CELL_MENU);if(dl){dl.closePopup();}}}],updatePopupConfig:function updatePopupConfig(config){var td=config&&config.td,xtab=config&&config.xtab,btn=this.btn;var lastTd=this._lastTd;if(lastTd!==td){btn.closePopup();this._lastTd=td;}btn.xtab=xtab;btn.td=td;btn.cmPos=config&&config.cmPos;if(!td||!xtab){return ;}var tbl=$D.findAncestorByName(td.parentNode,"table",false,xtab.viewport),zs=xtab.zones,slot="",n;if(tbl){for(n in zs){var z=zs[n];if(z&&z.tableNode===tbl){slot=z.slot;break;}}}var diff=mstrmojo.boxmodel.offset(td,xtab.overlayNode);this.set("location",{left:0,top:diff.top,width:Math.min(td.offsetWidth+diff.left,xtab._pl),height:td.offsetHeight});},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onlocationChange:function(){var l=this.location;if(!l){return ;}var ds=this.domNode.style;ds.left=(l.left+Math.max(l.width-18,0))+"px";ds.top=l.top+(l.height?Math.round(l.height/2)-7:0)+"px";}}};}());
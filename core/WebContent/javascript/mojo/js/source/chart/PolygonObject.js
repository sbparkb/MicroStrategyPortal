(function(){mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumLineJoinType","EnumLineStyle");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphObject","EnumDSSGraphFillBevelEffect");mstrmojo.requiresClsP("mstrmojo.chart","Polygon2D","ShapeObject","FormatLine");var $C=mstrmojo.chart,$CHART_ENUMS=$C.enums,$LJT=$CHART_ENUMS.EnumLineJoinType,$LSL=$CHART_ENUMS.EnumLineStyle,$M=mstrmojo.chart.model,$MODEL_ENUMS=$M.enums,$GO=$MODEL_ENUMS.EnumDSSGraphObject,$BE=$MODEL_ENUMS.EnumDSSGraphFillBevelEffect;function hSetBorderStyle(){var chartCtx=this.mChartContextPtr,formatLinePtr=this.mFormatLinePtr,devicePolygon=this.mDevicePolygon,len=devicePolygon.length,previousIndex,temp=[],i;if(formatLinePtr.mLineStyle!==$LSL.LS_SOLID&&formatLinePtr.mLineStyle!==$LSL.LS_GRADIENT&&!chartCtx.mUseAnimation){chartCtx.NewPath();chartCtx.MoveTo(devicePolygon[len-1].x,devicePolygon[len-1].y);previousIndex=len-1;for(i=0;i<len;++i){temp=formatLinePtr.getLinePattern(formatLinePtr.mLineStyle);chartCtx.DrawDashedLine(devicePolygon[previousIndex],devicePolygon[i],temp);previousIndex=i;}chartCtx.ClosePath();}}mstrmojo.chart.PolygonObject=mstrmojo.declare(mstrmojo.chart.ShapeObject,null,{scriptClass:"mstrmojo.chart.PolygonObject",mDevicePolygon:[],mHasHole:false,mPointsStyle:0,init:function init(props){var lSize,i;this._super(props);this.mDevicePolygon=[];if(props){if(props.Polygon!==undefined){lSize=props.Polygon.length;for(i=0;i<lSize;++i){this.mDevicePolygon.push(props.Polygon[i]);}}else{if(props.Points!==undefined){lSize=props.Points.length;for(i=0;i<lSize;++i){this.mDevicePolygon.push(props.Points[i]);}}}if(props.HasHole!==undefined){this.mHasHole=props.HasHole;}}},Draw:function Draw(){var chartCtx=this.mChartContextPtr,devicePolygon=this.mDevicePolygon,backupLineJoinType=chartCtx.GetLineJoin(),halfPolygon=[],halfIndex,topBorder=[],numOfPoints=0,i;chartCtx.SetLineJoin($LJT.LJT_ROUND);this.SetLineWidth();chartCtx.DrawPolygon(devicePolygon,false);this.ApplyFillFormat();if(this.mHasHole){halfIndex=Math.floor(devicePolygon.length/2);halfPolygon=halfPolygon.concat(devicePolygon.slice(0,halfIndex-1));chartCtx.DrawPolygon(halfPolygon,true);if(this.mFormatLinePtr||this.mFormatLinePtr.mLineStyle===$LSL.LS_SOLID){this.ApplyLineFormat();}halfPolygon.splice(0,halfPolygon.length);halfPolygon=halfPolygon.concat(devicePolygon.slice(halfIndex+1,devicePolygon.length));chartCtx.DrawPolygon(halfPolygon,true);hSetBorderStyle.call(this);this.ApplyLineFormat();}else{if(chartCtx.mIsTimeSeriesChart&&this.mTripleId.mObjectId===$GO.DssGraphRiser){numOfPoints=Math.floor(devicePolygon.length/2);for(i=0;i<numOfPoints;++i){topBorder.push(devicePolygon[i]);}chartCtx.DrawPolyLine(topBorder,true);}else{if(chartCtx.NeedAdjustedLinePath()){chartCtx.DrawPolygon(devicePolygon,true);}}hSetBorderStyle.call(this);this.ApplyLineFormat();}chartCtx.SetLineJoin(backupLineJoinType);chartCtx.FinishDrawPolygon(devicePolygon,this.mPointsStyle,this.mTripleId);},PointInObject:function PointInObject(iPoint){var devicePolygon=this.mDevicePolygon;if(!this.mIsDetectable){return false;}if(devicePolygon.length<3){return false;}return iPoint.IsInPolygon(devicePolygon);},DrawOutLine:function DrawOutLine(){var chartCtx=this.mChartContextPtr,devicePolygon=this.mDevicePolygon,halfPolygon=[],halfIndex;if(devicePolygon.length<3){return ;}this.SetOutlineWidth();if(this.mHasHole){halfIndex=Math.floor(devicePolygon.length/2);halfPolygon=halfPolygon.concat(devicePolygon.slice(0,halfIndex-1));chartCtx.DrawPolygon(halfPolygon,true);this.ApplyOutlineFormat();halfPolygon.splice(0,halfPolygon.length);halfPolygon=halfPolygon.concat(devicePolygon.slice(halfIndex+1,devicePolygon.length));chartCtx.DrawPolygon(halfPolygon,true);this.ApplyOutlineFormat();}else{chartCtx.DrawPolygon(devicePolygon,true);this.ApplyOutlineFormat();}},ObjectInRectangle:function ObjectInRectangle(iRect){var devicePolygon=this.mDevicePolygon,lPolygonSize=devicePolygon.length,i;if(!this.mIsDetectable){return false;}if(lPolygonSize<3){return false;}for(i=0;i<lPolygonSize;++i){if(!iRect.PointInRectangle(devicePolygon[i])){return false;}}return true;},GetBoundingRect:function GetBoundingRect(){return this.GetBoundingRectFromPolygon(this.mDevicePolygon);},GetClockwisePolygon:function GetClockwisePolygon(){var p=$C.Polygon2D.clone(this.mDevicePolygon);this.MakePolygonClockwise(p);return p;},FillBevel:function FillBevel(){var formatFill=this.mFormatFillPtr;if(formatFill.supportAdvancedFill(0)===false){return ;}var devicePolygon=this.mDevicePolygon,bevelType=formatFill.mFillBevel.type,backupPolygon=[],len,i;if(devicePolygon.length<3){return ;}if(this.mHasHole&&(bevelType===$BE.DssGraphFillBevelChiselEdge||bevelType===$BE.DssGraphFillBevelSmoothEdge)){backupPolygon=backupPolygon.concat(devicePolygon);len=backupPolygon.length;devicePolygon.splice(0,len);for(i=0;(i+1)*2<len;++i){devicePolygon[0]=backupPolygon[i];devicePolygon[1]=backupPolygon[i+1];devicePolygon[2]=backupPolygon[len-2-i];devicePolygon[3]=backupPolygon[len-1-i];this._super();}devicePolygon.splice(0,devicePolygon.length);this.mDevicePolygon=devicePolygon.concat(backupPolygon);}else{this._super();}}});}());
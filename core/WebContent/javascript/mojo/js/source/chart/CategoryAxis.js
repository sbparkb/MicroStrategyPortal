(function(){mstrmojo.requiresCls("mstrmojo.chart.common.MapStructure");mstrmojo.requiresClsP("mstrmojo.chart","Axis","TripleId","Rect2D","CategoryAxisInfo","ChartConstants","StraightLineObject","Point2D");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumGraphMajorType","EnumAnchorPoint","EnumAxisLabelsLocation","EnumAxisDirection","EnumGraphObjectType","EnumCategoryAxisOidItem","EnumCategoryLabelStyle","EnumRectCompare","EnumChartStyle","EnumImageUsage","EnumRectExpandDirection","EnumGraphMatrixMajorGraphType","EnumLabelLevelOption");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphProperty","EnumDSSGraphObject","EnumDSSGraphFontRotation","EnumDSSGraphGridLineType");var $C=mstrmojo.chart,$K=$C.ChartConstants,$CHART_ENUMS=$C.enums,$AP=$CHART_ENUMS.EnumAnchorPoint,$GMT=$CHART_ENUMS.EnumGraphMajorType,$AXIS_LABEL_LOC=$CHART_ENUMS.EnumAxisLabelsLocation,$AXIS_DIRECTION=$CHART_ENUMS.EnumAxisDirection,$GRAPH_OBJ_TYPE=$CHART_ENUMS.EnumGraphObjectType,$OID=$CHART_ENUMS.EnumCategoryAxisOidItem,$CLS=$CHART_ENUMS.EnumCategoryLabelStyle,$IMG_USAGE=$CHART_ENUMS.EnumImageUsage,$LLO=$CHART_ENUMS.EnumLabelLevelOption,$CS=$CHART_ENUMS.EnumChartStyle,$REC_CMP=$CHART_ENUMS.EnumRectCompare,$NULL_GROUP_ID=$C.gNullGroupId,$NULL_SERIES=$C.gNullSeriesId;var $M=mstrmojo.chart.model,$MODEL_ENUMS=$M.enums,$GT=$MODEL_ENUMS.EnumDSSGraphType,$GP=$MODEL_ENUMS.EnumDSSGraphProperty,$GO=$MODEL_ENUMS.EnumDSSGraphObject,$FR=$MODEL_ENUMS.EnumDSSGraphFontRotation,$GRID_LINE_TYPE=$MODEL_ENUMS.EnumDSSGraphGridLineType,CLS_AUTOMATIC=0,CLS_NORMAL=1,CLS_STAGGER=2,CLS_MANUAL=3;var perfUnitOffset=new $C.Point2D(),perfAnchor=new $C.Point2D(),perfInitRect=new $C.Rect2D(),perfPreviousRect=new $C.Rect2D(),perfBackupDeviceArea=new $C.Rect2D(),perfLabelFirstRect=new $C.Rect2D(),perfLabelLastRect=new $C.Rect2D();function hGetAxisLabelTripleId(groupIndex,seriesIndex){if(seriesIndex===undefined){seriesIndex=-3;}switch(this.mTripleId.mObjectId){case $GO.DssGraphO1Body:return new $C.TripleId({ObjectId:$GO.DssGraph2DO1Label,GroupId:groupIndex,SeriesId:seriesIndex});case $GO.DssGraphO2Body:return new $C.TripleId({ObjectId:$GO.DssGraph2DO2Label,GroupId:groupIndex,SeriesId:seriesIndex});default:return new $C.TripleId({ObjectId:$GO.DssGraph2DO1Label,GroupId:groupIndex,SeriesId:seriesIndex});}}function hTrimPaddingFromRect(iHighPadding,iLowPadding,iorRect){var low=iLowPadding||0,high=iHighPadding||0,length=(this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_X)?iorRect.width:iorRect.height;if(low<0){low=0;}if(high<0){high=0;}if(length<=0||length<low+high){return ;}length-=low+high;this.mLowTrim=low;this.mHighTrim=high;if(this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_X){iorRect.x+=low;iorRect.width=length;}if(this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_Y){iorRect.y+=high;iorRect.height=length;}}function restoreLabelsInList(lineCount){var i,list=this.mLabelList,len=list.length;for(i=0;i<len;i++){if(list[i]){list[i].Restore({LineCount:lineCount});}}}function hIsYLabelFitWithPadding(yLabel,iPadding){var chartCtx=this.mChartContextPtr,gmCtx=chartCtx.GetGraphMatrixContext(),iPadding=iPadding||gmCtx.getPadding($K.kLabelToChart),rect=yLabel.GetBoundingRect(true);return(rect.y>=iPadding&&rect.y+rect.height+iPadding<=chartCtx.mGraphHeight);}function hGuardFringe(){var chartCtx=this.mChartContextPtr,gmCtx=chartCtx.GetGraphMatrixContext(),enforced=chartCtx.RenderClusterShapes(),dataset=this.mDatasetPtr,comboBar=false,hasGeneralBarStyle=enforced;if(enforced===false){if(gmCtx.isCombinationChart()){var uaCaCtx=chartCtx.mUniformAxisContext.CategoryAxis,key=this.IsVerticalAxis()?"Y":"X";enforced=uaCaCtx[key].EnforceFringe;if(enforced){return true;}var barShapes=dataset.GetSeriesByShape().Bar;hasGeneralBarStyle=comboBar=barShapes&&barShapes.length>0;hasGeneralBarStyle=hasGeneralBarStyle||enforced;}else{hasGeneralBarStyle=chartCtx.IsBarChart()&&chartCtx.IsAdvancedBarChart($CS._bullet)===false;}}return hasGeneralBarStyle;}function hGuardCluster(){if(hGuardFringe.call(this)){var chartCtx=this.mChartContextPtr,gmCtx=chartCtx.GetGraphMatrixContext(),enforced=false,comboBar=false;if(gmCtx.isCombinationChart()){var uaCaCtx=chartCtx.mUniformAxisContext.CategoryAxis,key=this.IsVerticalAxis()?"Y":"X";enforced=uaCaCtx[key].EnforceCluster;if(enforced){return true;}var barShapes=this.mDatasetPtr.GetSeriesByShape().Bar;comboBar=barShapes&&barShapes.length>0;return(chartCtx.IsBarChart($CS._cluster)||(comboBar&&!chartCtx.IsPercentChart()&&!chartCtx.IsStackedChart()));}return chartCtx.IsBarChart($CS._cluster);}return false;}function hUpdateScreenWindow(){var chartCtx=this.mChartContextPtr;if(chartCtx.mPartialRendering&&chartCtx.mRenderingWindow){var min,max,filter=chartCtx.mRenderingWindow;if(this.IsVerticalAxis()){min=filter.y;max=min+filter.height;}else{min=filter.x;max=min+filter.width;}this.screenWindow={Min:this.getGroupSlotAt(min)-1,Max:this.getGroupSlotAt(max)+1};}}function hCalculateSpace(maxSpace1,maxSpace2){if(maxSpace1===0&&maxSpace2===0){return 0;}var allSpace=0,rotation,chartCtx=this.mChartContextPtr,isGM=chartCtx.mIsGraphMatrix,gmCtx=chartCtx.GetGraphMatrixContext(),style=this.mCategoryOption.mLabelStyle,addUp=isGM?gmCtx.getPadding($K.kLabelToChart):0,levelSizeVector=this.mLevelSize,paddingLabelToTick=isGM?gmCtx.getPadding($K.kCategoricalLabelToTick):this.mLevelSpace,i,groupCount=this.mGroupCount;switch(style){case $CLS.CLS_NORMAL:case $CLS.CLS_MANUAL:case $CLS.CLS_AUTOMATIC:levelSizeVector.push(Math.max(maxSpace1,maxSpace2));allSpace=Math.max(maxSpace1,maxSpace2)+paddingLabelToTick;break;default:rotation=this.mpAxisLabelSet.GetFormatFont().mFontRotation;if(rotation===$FR.Rotate45||rotation===$FR.Rotate315){maxSpace1=0;var groupSize=this.getGroupSize(),currentRect,levelSize;for(i=0;i<(groupCount+1)/2;++i){currentRect=this.mLabelList[i].GetBoundingRectNoRotation(true);levelSize=Math.max(currentRect.width,currentRect.height)*Math.SQRT1_2;if(levelSize>groupSize){levelSize+=(levelSize-groupSize);}maxSpace1=Math.max(maxSpace1,(levelSize+0.5));}}levelSizeVector.push(maxSpace1);levelSizeVector.push(maxSpace2);allSpace=maxSpace1+paddingLabelToTick+maxSpace2+this.mLevelSpace;break;}return allSpace+addUp;}function hInsideHorizontalRange(horizontal){var deviceDataArea=this.mDeviceDataArea;return(horizontal>deviceDataArea.x&&horizontal<deviceDataArea.x+deviceDataArea.width);}function hInsideVerticalRange(vertical){var area=this.mDeviceDataArea;return(vertical>area.y&&vertical<area.y+area.height);}function hIsSeriesAxis(){return this.mTripleId.mObjectId===$GO.DssGraphO2Body;}function hGetGroupIdByIndex(groupIndex){return this.mGroupOrder.length===0?groupIndex:this.mGroupOrder[groupIndex];}function hGenerateGridLinesOnMiddleWall(gridPoints,gridLineSet){var i,oneGridLine,len;len=gridPoints.length;for(i=0;i<len;++i){oneGridLine=new $C.StraightLineObject({TripleId:gridLineSet.mTripleId,GraphObjectManager:this,StartPoint:gridPoints[i],EndPoint:gridPoints[i].Shifted(this.mDepthOffset),ParentObject:gridLineSet});gridLineSet.AddGraphObject(oneGridLine);this.mManagerGraphObjectList.push(oneGridLine);}}function hGetMajorPoints(vecStart,vecEnd){var i,idx,point,len,deviceArea=this.mDeviceDataArea,groupCount;if(this.mChartContextPtr.mIsTimeSeriesChart){len=this.mShownLabelList.length;for(i=0;i<len;++i){idx=this.mShownLabelList[i].mTripleId.mGroupId;if(!this.IsVerticalAxis()){point=new $C.Point2D({x:this.getGroupMiddlePos(idx),y:deviceArea.GetBottomMiddle().y});vecStart.push(point);point=new $C.Point2D({x:this.getGroupMiddlePos(idx),y:deviceArea.GetTopMiddle().y});vecEnd.push(point);}else{point=new $C.Point2D({x:deviceArea.GetLeftMiddle().x,y:this.getGroupMiddlePos(idx)});vecStart.push(point);point=new $C.Point2D({x:deviceArea.GetRightMiddle().x,y:this.getGroupMiddlePos(idx)});vecEnd.push(point);}}}else{groupCount=this.mGroupCount;for(i=0;i<groupCount;++i){if(this.mAxisCross&&i===0){continue;}if(!this.IsVerticalAxis()){point=new $C.Point2D({x:this.getGroupMiddlePos(i),y:deviceArea.y+deviceArea.height});vecStart.push(point);point=new $C.Point2D({x:this.getGroupMiddlePos(i),y:deviceArea.y});vecEnd.push(point);}else{point=new $C.Point2D({x:deviceArea.x,y:this.getGroupMiddlePos(i)});vecStart.push(point);point=new $C.Point2D({x:deviceArea.x+deviceArea.width,y:this.getGroupMiddlePos(i)});vecEnd.push(point);}}}}function hGenerateMajorGridsOnMiddleWall(){var majorGrid=this.mMajorGrid;if(!majorGrid.mShowGridLines||(majorGrid.mGridStyle!==$GRID_LINE_TYPE.DssGraphGridRegular&&majorGrid.mGridStyle!==$GRID_LINE_TYPE.DssGraphGridBoth)){return ;}var majorId=$C.gAxisObjects[this.getIndex()].mMajorId;this.InitObjectSet(majorId,$GRAPH_OBJ_TYPE.GOT_MAJOR_GRID);var vecStart=[],vecEnd=[];hGetMajorPoints.call(this,vecStart,vecEnd);hGenerateGridLinesOnMiddleWall.call(this,vecEnd,this.mpMajorGridSet);}function hGetMinorPoints(vecStart,vecEnd){var minorGrid=this.mMinorGrid,deviceArea=this.mDeviceDataArea,number=1,halfNumber,step,upperLimit,groupCount=this.mGroupCount,i,j,offset,xCoordinate,yCoordinate;if(minorGrid.mUseManualGrid){number=(minorGrid.mGridInterval);}halfNumber=Math.floor(number/2);step=this.getGroupSize()/(number+1);upperLimit=((number%2)===0)?halfNumber:(halfNumber+1);for(i=0;i<groupCount;++i){for(j=-halfNumber;j<=upperLimit;++j){if((j!==0)){if(i===this.mGroupCount-1){if((number%2)!==0&&j===upperLimit){continue;}}offset=(step*j+(j>=0?0.5:-0.5));if(!this.IsVerticalAxis()){xCoordinate=this.getGroupMiddlePos(i)+offset;if(hInsideHorizontalRange.call(this,xCoordinate)){vecStart.push(new $C.Point2D({x:xCoordinate,y:deviceArea.y+deviceArea.height}));vecEnd.push(new $C.Point2D({x:xCoordinate,y:deviceArea.y}));}}else{yCoordinate=this.getGroupMiddlePos(i)+offset;if(hInsideVerticalRange.call(this,yCoordinate)){vecStart.push(new $C.Point2D({x:deviceArea.x,y:yCoordinate}));vecEnd.push(new $C.Point2D({x:deviceArea.x+deviceArea.width,y:yCoordinate}));}}}}}}function hGenerateMinorGridsOnMiddleWall(){var minorGrid=this.mMinorGrid;if(!minorGrid.mShowGridLines||(minorGrid.mGridStyle!==$GRID_LINE_TYPE.DssGraphGridRegular&&minorGrid.mGridStyle!==$GRID_LINE_TYPE.DssGraphGridBoth)){return ;}var minorId=$C.gAxisObjects[this.getIndex()].mMinorId;this.InitObjectSet(minorId,$GRAPH_OBJ_TYPE.GOT_MINOR_GRID);var vecStart=[],vecEnd=[];hGetMinorPoints.call(this,vecStart,vecEnd);hGenerateGridLinesOnMiddleWall.call(this,vecEnd,this.mpMinorGridSet);}function hGenerateInterlacedGridsOnMiddleWall(){}function hGetCorrectGroupIndex(index,forLabel){return index;}function hRetrievalOptionForLabels(isGrp,idx){var option=$LLO.LLO_NORMAL;if(this.mChartContextPtr.mIsGraphMatrix){return{Option:option,Index:idx};}return{Option:option,Index:idx};}function associateTextSectionsWithIdentities(isSeriesLabel,index,sections){if(sections){var dataset=this.mDatasetPtr,numberOfSections=sections.length,identities=isSeriesLabel?dataset.GetSeriesLabelIdentities(index):dataset.GetGroupLabelIdentities(index),identityCount=identities.length,wordCount=1,map=[],acc=0,i,j;for(i=0;i<numberOfSections;++i){var oneSection=sections[i],blanks=oneSection.match(/ /g);if(blanks){wordCount=blanks.length+1;}for(j=0;j<wordCount;++j){if(i<identityCount){map[acc]=identities[i];}else{map[acc]=null;}acc++;}}return map;}return null;}function attachInformationToLabels(){var chartCtx=this.mChartContextPtr,list=this.mLabelList,len=list.length,label,isSeriesLabel=hIsSeriesAxis.call(this),index,map,i;if(chartCtx.mImageUsage===$IMG_USAGE.GENERAL){for(i=0;i<len;i++){label=list[i];if(label&&label.texts){if(label.mIsShown===false){delete label.texts;continue;}index=label.mTripleId.mGroupId;map=associateTextSectionsWithIdentities.call(this,isSeriesLabel,index,label.texts);if(map&&map.length){label.IdentityMap=map;delete label.texts;}}}}}function hGetGroupLabelContentByGroupIndex(groupIdx,sectional){sectional=sectional||false;var chartCtx=this.mChartContextPtr,isXAxis=!this.IsVerticalAxis(),text,textParts,dataset=this.mDatasetPtr,option=$LLO.LLO_NORMAL,returnVal;if(isXAxis&&this.mIsUniformAxis){var uaCtx=chartCtx.getUniformAxisContext(),uaXTruncateInfo=uaCtx.CategoryAxis.X.Truncation;if(uaXTruncateInfo){var idx=-1,indices=uaXTruncateInfo.Indices,texts=uaXTruncateInfo.Texts;if(indices&&indices.length){idx=indices.indexOf(groupIdx);if(idx!==-1){text=texts[idx];if(text){return text;}}}}}if(hIsSeriesAxis.call(this)){returnVal=hRetrievalOptionForLabels.call(this,false,groupIdx);groupIdx=returnVal.Index;option=returnVal.Option;textParts=dataset.GetSeriesLabel(groupIdx,0,option,sectional);text=dataset.GetMergedLabel(textParts,option);if(chartCtx.mImageUsage===$IMG_USAGE.GENERAL&&sectional){return{Text:text,Texts:textParts};}return{Text:text};}returnVal=hRetrievalOptionForLabels.call(this,true,groupIdx);groupIdx=hGetGroupIdByIndex.call(this,returnVal.Index);option=returnVal.Option;textParts=dataset.GetGroupLabel(groupIdx,0,option,sectional);text=dataset.GetMergedLabel(textParts,option);if(chartCtx.mImageUsage===$IMG_USAGE.GENERAL&&sectional){return{Text:text,Texts:textParts};}return{Text:text};}function hIsLabelOnScreen(label){var chartCtx=this.mChartContextPtr;if(chartCtx.mPartialRendering){var groupIndex=label.mTripleId.mGroupId,window=this.screenWindow;return groupIndex>=window.Min&&groupIndex<=window.Max;}return true;}function hGetSingleLabelLocation(index){switch(this.mAxisInfo.mAxisLabelsLocation){case $AXIS_LABEL_LOC.ALL_BOTTOM:case $AXIS_LABEL_LOC.ALL_TOP:case $AXIS_LABEL_LOC.ALL_LEFT:case $AXIS_LABEL_LOC.ALL_RIGHT:return this.mAxisInfo.mAxisLabelsLocation;}if(this.mAxisInfo.mAxisLabelsLocation===$AXIS_LABEL_LOC.ALL_BOTTOM_TOP){if(index<this.mLabelSubIndex){return $AXIS_LABEL_LOC.ALL_BOTTOM;}return $AXIS_LABEL_LOC.ALL_TOP;}if(index<this.mLabelSubIndex){return $AXIS_LABEL_LOC.ALL_LEFT;}return $AXIS_LABEL_LOC.ALL_RIGHT;}function hNeedTickLength(location){var need=this.HasOuterTicks(this.mMajorGrid.mGridStyle)||this.HasOuterTicks(this.mMinorGrid.mGridStyle);if(this.mAxisInfo.mAxisLabelsLocation===$AXIS_LABEL_LOC.ALL_BOTTOM_TOP||this.mAxisInfo.mAxisLabelsLocation===$AXIS_LABEL_LOC.ALL_LEFT_RIGHT){return need;}return need&&(location===this.mAxisInfo.mAxisLabelsLocation);}function hGetLabelOffset(location,offset,unitOffsetDirection){var deviceArea=this.mDeviceDataArea;switch(location){case $AXIS_LABEL_LOC.ALL_BOTTOM:unitOffsetDirection.Reset(0,1);return deviceArea.y+deviceArea.height+offset;case $AXIS_LABEL_LOC.ALL_TOP:unitOffsetDirection.Reset(0,-1);return deviceArea.y-offset;case $AXIS_LABEL_LOC.ALL_LEFT:unitOffsetDirection.Reset(-1,0);return deviceArea.x-offset;case $AXIS_LABEL_LOC.ALL_RIGHT:unitOffsetDirection.Reset(1,0);return deviceArea.x+deviceArea.width+offset;default:return 0;}}function isRestricted(){if(this.mIsUniformAxis===false){return false;}return this.restrictWidth>=0&&this.restrictHeight>=0;}function figureOutWidthLimitOnGMXLabel(label,suggestWidth){var w=suggestWidth,fontRotation=this.getLabelRotation(),isRotated=(fontRotation===$FR.Rotate90),stringent=isRestricted.call(this)&&isRotated,axisCtx=this.mChartContextPtr.getUniformAxisContext();if(isRestricted.call(this)){if(isRotated){if(this.maxLabelLength===-1){var isXAxis=this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_X;if(isXAxis&&isRotated&&(this.resizeAction===$REC_CMP.ShrinkX||this.resizeAction===$REC_CMP.ExpandX)){w=1000;}else{w=this.calculateMaxAxisSpace(this.restrictHeight);}}else{w=this.maxLabelLength;}}else{w=this.calculateMaxAxisSpace(this.restrictWidth);label.rect.width=label.rect.height=0;label.mIsRectCalculated=false;}}else{var shouldXAxisLabelRotate=false,xAxis=axisCtx.CategoryAxis.X;if(xAxis.Layout===CLS_MANUAL){shouldXAxisLabelRotate=true;}if(!this.IsVerticalAxis()){if(isRotated||shouldXAxisLabelRotate){var v=axisCtx.CategoryAxis.X.LabelWidthLimit;if(v){w=v;stringent=true;}if((isRotated||shouldXAxisLabelRotate)&&!isRestricted.call(this)){stringent=true;w=1000;}}else{if(!this.mWordWrap){w=1000;}}}}return{Stringent:stringent,WidthLimit:w};}function hGetPaddingOnSide(){if(this.mPaddingOnSide===-1){var dataset=this.mDatasetPtr,chartCtx=this.mChartContextPtr;if(!chartCtx.mIsGraphMatrix){this.mPaddingOnSide=0;}else{if(hGuardFringe.call(this)){var numberOfColumns=1,groupCount=this.mGroupCount;if(hGuardCluster.call(this)===false){numberOfColumns=(groupCount+0.5);}else{numberOfColumns=groupCount*dataset.GetClusterSeriesCount()+0.5;}var axisLength=0,deviceArea=this.mDeviceDataArea;switch(this.mAxisInfo.mAxisDirection){case $AXIS_DIRECTION.AD_X:axisLength=deviceArea.width;break;case $AXIS_DIRECTION.AD_Y:axisLength=deviceArea.height;break;case $AXIS_DIRECTION.AD_Z:break;}this.mPaddingOnSide=axisLength/numberOfColumns/4;}else{this.mPaddingOnSide=0;}this.mPaddingOnSide=Math.round(this.mPaddingOnSide);}}return this.mPaddingOnSide;}function hGetAxisLength(){var length=0;switch(this.mAxisInfo.mAxisDirection){case $AXIS_DIRECTION.AD_X:length=this.mDeviceDataArea.width;break;case $AXIS_DIRECTION.AD_Y:length=this.mDeviceDataArea.height;break;case $AXIS_DIRECTION.AD_Z:break;}return length-2*hGetPaddingOnSide.call(this);}function hSetLabelWidthLimit(label,groupInterval,maxLimit){var width,intervalSize,chartCtx=this.mChartContextPtr,isXLabls=!this.IsVerticalAxis(),stringent=false;if(isXLabls){width=0;if(chartCtx.mManualLayoutMode){width=(groupInterval*this.getGroupSize(true)+0.5);}else{width=intervalSize=groupInterval*this.getGroupSize(true);if(chartCtx.mIsGraphMatrix===false){width=Math.floor((intervalSize*Math.max(1,((hGetAxisLength.call(this)/10)/intervalSize))-$C.Axis.gLabelMargin+0.5));if(this.mAxisCross||chartCtx.mIsTimeSeriesChart){width=Math.min(width,maxLimit);}}width=Math.max(1,width);}if(this.mIsUniformAxis){var returnVal=figureOutWidthLimitOnGMXLabel.call(this,label,width);width=returnVal.WidthLimit;stringent=stringent||returnVal.Stringent;}label.mSubTextHolder.SetLineCount(1);label.SetTextWidthLimit(width,stringent);}else{width=this.mDeviceDataArea.width;if(!this.mIsUniformAxis){width=width/2;}else{var axisCtx=chartCtx.getUniformAxisContext(),uaYInfo=axisCtx.CategoryAxis.Y;width=uaYInfo.LabelWidthLimit||width;}if(this.mIsUniformAxis){if(isRestricted.call(this)){label.rect.width=label.rect.height=0;label.mIsRectCalculated=false;}}label.SetTextWidthLimit(width);}}function hMoveLabel(tripleId,label,forLabel){forLabel=(forLabel!==undefined)?forLabel:false;var deviceDataArea=this.mDeviceDataArea,x,y;if(this.IsVerticalAxis()){x=deviceDataArea.x+deviceDataArea.width/2;y=this.getGroupMiddlePos(tripleId.mGroupId,forLabel);}else{x=this.getGroupMiddlePos(tripleId.mGroupId,forLabel);y=deviceDataArea.y+deviceDataArea.height;}label.MoveTo(x,y,$AP.CENTER);}function hCreateGroupLabel(tripleId,groupInterval,needMove,maxLimit){var textObj,labelContent,currentTripleId;if(maxLimit===undefined){if(this.maxLabelLength>0){maxLimit=this.maxLabelLength;}else{maxLimit=1000;}}var index=tripleId.mGroupId;textObj=this.mLabelList[index];if(textObj===undefined){currentTripleId=tripleId;textObj=new $C.TextObject({TripleId:currentTripleId,GraphObjectManager:this,GraphCollectionObject:this.mpAxisLabelSet,hasFill:false,hasLine:false});labelContent=hGetGroupLabelContentByGroupIndex.call(this,currentTripleId.mGroupId,true);textObj.SetText(labelContent.Text);delete labelContent.Text;if(labelContent.Texts){textObj.texts=labelContent.Texts;delete labelContent.Texts;}this.mLabelList[index]=textObj;}hSetLabelWidthLimit.call(this,textObj,groupInterval,maxLimit);if(needMove){hMoveLabel.call(this,tripleId,textObj);}return textObj;}function hCalculateLabelMargins(lowMargin,highMargin,lowLabelMargin,highLabelMargin){var currentLowMargin=lowLabelMargin,currentHighMargin=highLabelMargin,depthMargin;if(this.mUseDepth){depthMargin=this.getDepthMargin(0,0);currentLowMargin=currentLowMargin-depthMargin.lowMargin;currentHighMargin=currentHighMargin-depthMargin.highMargin;}currentLowMargin=(currentLowMargin<0)?0:currentLowMargin;currentHighMargin=(currentHighMargin<0)?0:currentHighMargin;return{LowMargin:currentLowMargin>lowMargin?currentLowMargin-lowMargin:0,HighMargin:currentHighMargin>highMargin?currentHighMargin-highMargin:0};}function hGetExtraMarginDemand(lowMargin,highMargin,dataArea,firstRect,lastRect){var labelLowMargin,labelHighMargin;perfLabelFirstRect.ResetRect(firstRect);perfLabelLastRect.ResetRect(lastRect);if(this.mChartContextPtr.mIsGraphMatrix){var paddingToChart=this.mChartContextPtr.GetGraphMatrixContext().getPadding($K.kLabelToChart);var extraPadding=0;if(this.IsVerticalAxis()){perfLabelFirstRect.y-=paddingToChart;perfLabelFirstRect.height+=paddingToChart;perfLabelLastRect.height+=paddingToChart;}else{perfLabelFirstRect.x-=(paddingToChart+extraPadding);perfLabelFirstRect.width+=paddingToChart+extraPadding;perfLabelLastRect.width+=paddingToChart;}}labelLowMargin=this.IsVerticalAxis()?perfLabelLastRect.y+perfLabelLastRect.height-(dataArea.y+dataArea.height):dataArea.x-perfLabelFirstRect.x;labelHighMargin=this.IsVerticalAxis()?dataArea.y-perfLabelFirstRect.y:perfLabelLastRect.x+perfLabelLastRect.width-(dataArea.x+dataArea.width);return hCalculateLabelMargins.call(this,lowMargin,highMargin,labelLowMargin,labelHighMargin);}function overlapAgainstBorder(thisRect,isX,padding){padding=padding||0;var start,end,lowBound,highBound,chartCtx=this.mChartContextPtr,bounds={x:0,y:0,width:chartCtx.mGraphWidth,height:chartCtx.mGraphHeight};if(isX){start=thisRect.x-padding;end=thisRect.x+thisRect.width+padding;lowBound=bounds.x;highBound=bounds.x+bounds.width;}else{start=thisRect.y-padding;end=thisRect.y+thisRect.height+padding;lowBound=bounds.y;highBound=bounds.y+bounds.height;}return !(start>=lowBound&&end<=highBound);}function hCheckOverlapWithPaddings(isX,isRotated,labelStyle,previousRect,currentRect){var chartCtx=this.mChartContextPtr,checkCenter=0,checkBorder=1,overlapped=false,gmCtx=chartCtx.GetGraphMatrixContext();if(isX){switch(labelStyle){case CLS_AUTOMATIC:case CLS_MANUAL:case CLS_NORMAL:if(isRotated){overlapped=gmCtx.checkPaddingBetweenLabels(previousRect,currentRect,checkCenter,true);}else{overlapped=gmCtx.checkPaddingBetweenLabels(previousRect,currentRect,checkBorder,true);}break;default:overlapped=gmCtx.checkPaddingBetweenLabels(previousRect,currentRect,checkBorder,true);break;}}else{overlapped=gmCtx.checkPaddingBetweenLabels(previousRect,currentRect,checkBorder,false);}return overlapped;}function hGetLabelAtIndex(index,interval){var currentLabel;var labelId=hGetAxisLabelTripleId.call(this,index,-3);currentLabel=currentLabel||hCreateGroupLabel.call(this,labelId,interval,true);return currentLabel;}function hDoOverlapCheckForOneLabelWithInterval(firstLoop,currentRect,perfPreviousRect,isX,isLabelRotated,labelStyle,paddingToBorder){var overlapped=false,chartCtx=this.mChartContextPtr;if(!firstLoop){overlapped=currentRect.HasIntersection(perfPreviousRect);overlapped=overlapped||(chartCtx.mIsGraphMatrix&&hCheckOverlapWithPaddings.call(this,isX,isLabelRotated,labelStyle,perfPreviousRect,currentRect));}if(isX&&!isLabelRotated){overlapped=overlapped||(chartCtx.mIsGraphMatrix&&overlapAgainstBorder.call(this,currentRect,isX,paddingToBorder));}return overlapped;}function hDoOverlapCheckForOneLabelWithInterval(firstLoop,currentRect,perfPreviousRect,isX,isLabelRotated,labelStyle,paddingToBorder){var overlapped=false,chartCtx=this.mChartContextPtr;if(!firstLoop){overlapped=currentRect.HasIntersection(perfPreviousRect);overlapped=overlapped||(chartCtx.mIsGraphMatrix&&hCheckOverlapWithPaddings.call(this,isX,isLabelRotated,labelStyle,perfPreviousRect,currentRect));}if(isX&&!isLabelRotated){overlapped=overlapped||(chartCtx.mIsGraphMatrix&&overlapAgainstBorder.call(this,currentRect,isX,paddingToBorder));}return overlapped;}function hOverlapWithInterval(interval,refStartIndex,maxSpace,labels){var i,currentRect=new $C.Rect2D(),currentLabel,firstLoop=true,isX=!this.IsVerticalAxis(),chartCtx=this.mChartContextPtr,paddingToBorder=0,plotGroupCount=this.mPlotGroupCount,labelStyle=this.mCategoryOption.mLabelStyle,isLabelRotated=this.getLabelRotation()===$FR.Rotate90||this.getLabelRotation()===$FR.Rotate270,result={Overlapped:false,MaxSpace:maxSpace};if(chartCtx.mIsGraphMatrix){paddingToBorder=chartCtx.GetGraphMatrixContext().getPadding($K.kLabelToChart);}perfPreviousRect.Reset(0,0,0,0);for(i=refStartIndex;i<plotGroupCount;i+=interval){currentLabel=hGetLabelAtIndex.call(this,i,interval);labels.push(currentLabel);currentLabel.GetTransformedRectEx(currentRect);result.Overlapped=hDoOverlapCheckForOneLabelWithInterval.call(this,firstLoop,currentRect,perfPreviousRect,isX,isLabelRotated,labelStyle,paddingToBorder);if(result.Overlapped){result.MaxSpace=maxSpace;return result;}if(firstLoop===true){firstLoop=false;perfPreviousRect.ResetRect(currentRect);}else{perfPreviousRect.ResetRect(currentRect);maxSpace=Math.max(maxSpace,this.IsVerticalAxis()?currentRect.width:currentRect.height);result.MaxSpace=maxSpace;}}if(refStartIndex>=interval){firstLoop=true;perfPreviousRect.Reset(0,0,0,0);for(i=refStartIndex;i>=0;i-=interval){currentLabel=hGetLabelAtIndex.call(this,i,interval);if(i!==refStartIndex){labels.unshift(currentLabel);}currentRect=currentLabel.GetTransformedRect(true);result.Overlapped=hDoOverlapCheckForOneLabelWithInterval.call(this,firstLoop,currentRect,perfPreviousRect,isX,isLabelRotated,labelStyle,paddingToBorder);if(result.Overlapped){result.MaxSpace=maxSpace;return result;}if(firstLoop===true){firstLoop=false;perfPreviousRect.ResetRect(currentRect);}else{perfPreviousRect.ResetRect(currentRect);maxSpace=Math.max(maxSpace,this.IsVerticalAxis()?currentRect.width:currentRect.height);result.MaxSpace=maxSpace;}}}result.Overlapped=false;return result;}function hApplyMarginsOnDataArea(lowMargin,highMargin){if(this.IsVerticalAxis()){this.mDeviceDataArea.y+=highMargin;this.mDeviceDataArea.height-=highMargin+lowMargin;}else{this.mDeviceDataArea.x+=lowMargin;this.mDeviceDataArea.width-=lowMargin+highMargin;}}function hHideLabelsForFixedMargin(areFixedMargins,lowMargin,highMargin,firstLabel,lastLabel){if(!areFixedMargins){return ;}if(this.IsVerticalAxis()){if(highMargin>0){firstLabel.mIsShown=false;}if(lowMargin>0){lastLabel.mIsShown=false;}}else{if(lowMargin>0){firstLabel.mIsShown=false;}if(highMargin>0){lastLabel.mIsShown=false;}}}function hIsXStaggerAllowed(){var chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext();if(chartCtx.mIsGraphMatrix){var xInfo=uaCtx.CategoryAxis.X;return !!xInfo.ForbideStagger===false;}return true;}function hHasOverlapWithStagger(lowMargin,highMargin,areFixedMargins,backupDataArea,vecLabels,maxSpace1,maxSpace2,firstRect,lowLabelMargin,highLabelMargin){var tripleId,i,result,lastIndex,lastRect,labelPtr,returnVal,space,staggerLowMargin,staggerHighMargin,staggerLabels=[],len;result={MaxSpace1:maxSpace1,MaxSpace2:maxSpace2,Overlapped:true};lastIndex=this.mPlotGroupCount-((this.mPlotGroupCount&1)===0?1:2);tripleId=hGetAxisLabelTripleId.call(this,lastIndex);labelPtr=hCreateGroupLabel.call(this,tripleId,2,true,highMargin*2);lastRect=labelPtr.GetBoundingRect();returnVal=hGetExtraMarginDemand.call(this,lowMargin,highMargin,backupDataArea,firstRect,lastRect);staggerLowMargin=returnVal.LowMargin;staggerHighMargin=returnVal.HighMargin;if(staggerLowMargin>lowLabelMargin||staggerHighMargin>highLabelMargin){this.mDeviceDataArea=backupDataArea;staggerLowMargin=Math.max(lowLabelMargin,staggerLowMargin);staggerHighMargin=Math.max(highLabelMargin,staggerHighMargin);if(!areFixedMargins){hApplyMarginsOnDataArea.call(this,staggerLowMargin,staggerHighMargin);}result.MaxSpace1=0;returnVal=hOverlapWithInterval.call(this,2,0,maxSpace1,staggerLabels);result.MaxSpace1=returnVal.MaxSpace;if(returnVal.Overlapped){return result;}}else{staggerLabels=staggerLabels.concat(vecLabels);}returnVal=hOverlapWithInterval.call(this,2,1,maxSpace2,staggerLabels);result.MaxSpace2=maxSpace2=returnVal.MaxSpace;if(returnVal.Overlapped){return result;}space=maxSpace1+this.mLevelSpace+maxSpace2+this.mLevelSpace;if(this.HasLabelsOnBothSides()){space+=space;}if(space*2>(this.IsVerticalAxis()?this.mDeviceDataArea.width:this.mDeviceDataArea.height)){return result;}labelPtr=(this.mPlotGroupCount&1)===0?staggerLabels[staggerLabels.length-1]:staggerLabels[Math.floor(this.mPlotGroupCount/2)];hHideLabelsForFixedMargin.call(this,areFixedMargins,staggerLowMargin,staggerHighMargin,staggerLabels[0],labelPtr);vecLabels.splice(0,vecLabels.length);len=staggerLabels.length;for(i=0;i<len;++i){vecLabels.push(staggerLabels[i]);}result.Overlapped=false;return result;}function hHasOverlapWithStaggerProxy(props){return hHasOverlapWithStagger.call(this,props.LowMargin,props.HighMargin,props.FixedMargin,props.BackupRect2D,props.LabelArray,props.MaxSpace_1,props.MaxSpace_2,props.FirstRect,props.LowLabelMargin,props.HighLabelMargin);}function hGetEstimatedInterval(firstRect,startIndex,initInterval){startIndex=startIndex||0;var high=this.mPlotGroupCount-1,low=startIndex,current,hasOverlap=false,rect,tripleId,style=this.mCategoryOption.mLabelStyle,isXAxis=!this.IsVerticalAxis(),textObj;if(this.mPlotGroupCount<2){return 1;}if(isXAxis&&this.mIsUniformAxis){if(style===CLS_NORMAL){if(initInterval===1){return style;}}if(style===CLS_STAGGER){if(initInterval===2){return style;}}}while(high>low){current=Math.floor((high+low+1)/2);tripleId=hGetAxisLabelTripleId.call(this,current);textObj=hCreateGroupLabel.call(this,tripleId,initInterval,true);rect=textObj.GetTransformedRect(true);if(firstRect.HasIntersection(rect)){low=current;hasOverlap=true;}else{hasOverlap=false;if(high===current){break;}high=current;}}return hasOverlap?this.mGroupCount:Math.max(high-startIndex,initInterval);}function hAdjustSpace(location,deviceDataArea,space){switch(location){case $AXIS_LABEL_LOC.ALL_BOTTOM:deviceDataArea.height-=space;break;case $AXIS_LABEL_LOC.ALL_TOP:deviceDataArea.y+=space;deviceDataArea.height-=space;break;case $AXIS_LABEL_LOC.ALL_LEFT:deviceDataArea.x+=space;deviceDataArea.width-=space;break;case $AXIS_LABEL_LOC.ALL_RIGHT:deviceDataArea.width-=space;break;}}function hGetLabelLocation(labelLocation){var labelsLoc=this.mAxisInfo.mAxisLabelsLocation;switch(labelsLoc){case $AXIS_LABEL_LOC.ALL_BOTTOM:case $AXIS_LABEL_LOC.ALL_TOP:case $AXIS_LABEL_LOC.ALL_LEFT:case $AXIS_LABEL_LOC.ALL_RIGHT:labelLocation.push(labelsLoc);break;}if(labelsLoc===$AXIS_LABEL_LOC.ALL_BOTTOM_TOP){labelLocation.push($AXIS_LABEL_LOC.ALL_BOTTOM);labelLocation.push($AXIS_LABEL_LOC.ALL_TOP);}else{if(labelsLoc===$AXIS_LABEL_LOC.ALL_LEFT_RIGHT){labelLocation.push($AXIS_LABEL_LOC.ALL_LEFT);labelLocation.push($AXIS_LABEL_LOC.ALL_RIGHT);}}}function hUpdateLabelStyleWithInterval(props){var isRotated,fontRotation,allowStagger,overlapRet,firstLabel=props.FirstLabel,chartCtx=this.mChartContextPtr,isGM=chartCtx.mIsGraphMatrix,skip=this.mCategoryOption.mManualSkip,dataArea=this.mDeviceDataArea,isY=this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_Y,style=this.mCategoryOption.mLabelStyle,nonStaggerArea=new $C.Rect2D({Rect2D:dataArea});switch(props.Interval){case 1:if(!this.IsVerticalAxis()&&props.FirstLabel.possibleTruncate()){style=CLS_MANUAL;}else{style=CLS_NORMAL;}break;case 2:fontRotation=this.getLabelRotation();isRotated=(fontRotation===$FR.Rotate90)||(fontRotation===$FR.Rotate270);allowStagger=true;if(isGM){allowStagger=allowStagger&&!isY&&!isRotated;if(allowStagger){allowStagger=hIsXStaggerAllowed.call(this)&&(firstLabel.mTripleId.mGroupId===0);}}else{}if(allowStagger){overlapRet=hHasOverlapWithStaggerProxy.call(this,props);props.MaxSpace_1=overlapRet.MaxSpace1;props.MaxSpace_2=overlapRet.MaxSpace2;allowStagger=overlapRet.Overlapped===false;}if(allowStagger){if(isGM&&this.mPlotGroupCount===2){dataArea.ResetRect(nonStaggerArea);style=CLS_MANUAL;skip=2;}else{style=CLS_STAGGER;}}else{dataArea.ResetRect(nonStaggerArea);style=$CLS.CLS_MANUAL;skip=2;}break;default:style=$CLS.CLS_MANUAL;skip=props.Interval;break;}this.mCategoryOption.mManualSkip=skip;this.mCategoryOption.mLabelStyle=style;}function hInitializeIntervalWithFirstLabel(tripleId){var labelSet=this.mpAxisLabelSet;if(labelSet){var formatFont=labelSet.GetFormatFont();if(!!formatFont===false){return 1;}var groupSize=this.getGroupSize(true),lableIndex=tripleId.mGroupId,dataset=this.mDatasetPtr,labelString;if(hIsSeriesAxis.call(this)){labelString=dataset.GetSeriesLabel(lableIndex);}else{labelString=dataset.GetGroupLabel(lableIndex);}var fontRotation=formatFont.mFontRotation,chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext(),caCtx=uaCtx.CategoryAxis,size=formatFont.GetStringExtent(labelString);if(fontRotation===$FR.Rotate180||fontRotation===$FR.Normal){var leastRequired=2;if(this.IsVerticalAxis()){if(size.Height>=groupSize){leastRequired=Math.ceil(size.Height/groupSize);return Math.min(leastRequired,this.mGroupCount);}}else{if(size.Width>=groupSize){leastRequired=Math.ceil(size.Width/groupSize);return Math.min(leastRequired,this.mGroupCount);}}if(this.IsVerticalAxis()===false){var axisInfo=caCtx.X;if(axisInfo&&axisInfo.Layout===CLS_STAGGER){return Math.min(2,this.mGroupCount);}}}else{if(fontRotation===$FR.Rotate90||fontRotation===$FR.Rotate270){if(size.Height>=groupSize){return Math.min(2,this.mGroupCount);}}}}return 1;}function hGetOneSideLabelSize(lowMargin,highMargin,areFixedMargins,startIndex){startIndex=(startIndex!==undefined)?startIndex:0;var allSpace,maxSpace1,maxSpace2,chartCtx=this.mChartContextPtr,firstIndex,lastIndex,tripleId,firstLabel,firstRect,firstTransformedRect,interval,groupCount=this.mGroupCount,shownLabels=this.mShownLabelList,labelList=this.mLabelList,currentLowMargin=0,currentHighMargin=0,lastLabelIndex,lastLabel,lastRect,i,isAutomaticXLabelRotation,fontRotation,alreadyRotated,args,result;this.mLevelSize.splice(0,this.mLevelSize.length);maxSpace1=maxSpace2=0;if(groupCount<1){return 0;}var xRotateMode=chartCtx.getUniformAxisLabelRotateMode("x"),axisTag=this.IsVerticalAxis()?"Y":"X";isAutomaticXLabelRotation=xRotateMode===-1;firstIndex=chartCtx.mIsGraphMatrix?startIndex:0;lastIndex=groupCount-1;firstIndex=hGetFirstShownGroupIdEx.call(this,axisTag,firstIndex,lastIndex);if(!chartCtx.mManualLayoutMode||chartCtx.mRecalculateFrame){tripleId=hGetAxisLabelTripleId.call(this,firstIndex);interval=hInitializeIntervalWithFirstLabel.call(this,tripleId);firstLabel=hCreateGroupLabel.call(this,tripleId,interval,true);firstRect=firstLabel.GetBoundingRect(true);firstTransformedRect=firstLabel.GetTransformedRect(true);interval=hGetEstimatedInterval.call(this,firstTransformedRect,firstIndex,interval);perfBackupDeviceArea.ResetRect(this.mDeviceDataArea);var deviceDataArea=this.mDeviceDataArea;while(interval<=groupCount){deviceDataArea.ResetRect(perfBackupDeviceArea);maxSpace1=0;maxSpace2=0;if(true){tripleId=hGetAxisLabelTripleId.call(this,firstIndex);hSetLabelWidthLimit.call(this,firstLabel,interval,lowMargin*2);hMoveLabel.call(this,tripleId,firstLabel);firstRect=firstLabel.GetBoundingRect(true);}maxSpace1=this.IsVerticalAxis()?firstRect.width:firstRect.height;lastLabelIndex=parseInt(lastIndex/interval)*interval;tripleId=hGetAxisLabelTripleId.call(this,lastLabelIndex);if(this.mIsUniformAxis){lastLabel=hCreateGroupLabel.call(this,tripleId,interval,true);}else{lastLabel=hCreateGroupLabel.call(this,tripleId,interval,true,2*highMargin);}lastRect=lastLabel.GetBoundingRect(true);if(this.mChartContextPtr.GetGraphType()===$GT.DssGraphTypeGridChart&&axisTag==="X"){currentLowMargin=0;currentHighMargin=0;this.mLowTrim=0;this.mHighTrim=0;}else{result=hGetExtraMarginDemand.call(this,lowMargin,highMargin,deviceDataArea,firstRect,lastRect);currentLowMargin=result.LowMargin;currentHighMargin=result.HighMargin;this.mLowTrim=currentLowMargin;this.mHighTrim=currentHighMargin;}if(!areFixedMargins){hApplyMarginsOnDataArea.call(this,currentLowMargin,currentHighMargin);}if(!this.IsVerticalAxis()){fontRotation=this.getLabelRotation();alreadyRotated=(fontRotation===$FR.Rotate90);if(alreadyRotated===false){tripleId=hGetAxisLabelTripleId.call(this,firstIndex);hSetLabelWidthLimit.call(this,firstLabel,interval,lowMargin*2);hMoveLabel.call(this,tripleId,firstLabel);firstRect=firstLabel.GetBoundingRect(true);if(overlapAgainstBorder.call(this,firstRect,true,5)){if(isAutomaticXLabelRotation){this.mpAxisLabelSet.GetFormatFont().mFontRotation=$FR.Rotate90;this.mLabelInterval=-1;this.mCategoryOption.mLabelStyle=CLS_MANUAL;return 0;}else{firstLabel.mIsShown=false;firstIndex++;}}}}shownLabels.splice(0,shownLabels.length);if(this.mGroupCount===1&&!this.IsVerticalAxis()){if(deviceDataArea.width<firstRect.width){fontRotation=this.getLabelRotation();alreadyRotated=(fontRotation===$FR.Rotate90)||(fontRotation===$FR.Rotate270);if(alreadyRotated){firstLabel.mIsShown=false;maxSpace1=maxSpace2=0;break;}interval=2;this.mpAxisLabelSet.GetFormatFont().mFontRotation=$FR.Rotate90;this.mCategoryOption.mLabelStyle=CLS_MANUAL;labelList.splice(0,labelList.length);this.mLabelList.push(firstLabel);shownLabels.push(firstLabel);firstRect=firstLabel.GetBoundingRect();return firstRect.height+5;}}result=hOverlapWithInterval.call(this,interval,firstIndex,maxSpace1,shownLabels);maxSpace1=result.MaxSpace;if(result.Overlapped){++interval;}else{this.mLabelInterval=interval;if(shownLabels.length>=1){hHideLabelsForFixedMargin.call(this,areFixedMargins,currentLowMargin,currentHighMargin,shownLabels[0],shownLabels[shownLabels.length-1]);if(this.mChartContextPtr.GetGraphType()===$GT.DssGraphTypeGridChart&&axisTag==="X"){lastRect=shownLabels[shownLabels.length-1].GetBoundingRect(true);if(overlapAgainstBorder.call(this,lastRect,true,0)){shownLabels.splice(shownLabels.length-1,1);}}}break;}}args={Interval:interval,FirstLabel:firstLabel,LowMargin:lowMargin,HighMargin:highMargin,BackupRect2D:perfBackupDeviceArea,FirstRect:firstRect,FixedMargin:areFixedMargins,MaxSpace_1:maxSpace1,MaxSpace_2:maxSpace2,LabelArray:shownLabels,LowLabelMargin:currentLowMargin,HighLabelMargin:currentHighMargin};hUpdateLabelStyleWithInterval.call(this,args);maxSpace1=args.MaxSpace_1;maxSpace2=args.MaxSpace_2;if(chartCtx.mIsGraphMatrix){var showIndices=[],graphObjectList=this.mGraphObjectList,objectListSize=graphObjectList.length,size=shownLabels.length;for(i=0;i<size;++i){shownLabels[i].mIsShown=true;showIndices.push(shownLabels[i].mTripleId.mGroupId);}var index,len;len=labelList.length;for(i=0;i<len;i++){if(labelList[i]){labelList[i].mIsShown=false;}}len=shownLabels.length;for(i=0;i<len;i++){index=shownLabels[i].mTripleId.mGroupId;if(labelList[index]){labelList[index].mIsShown=true;}else{labelList[index]=shownLabels[i];}}}else{labelList=labelList.concat(shownLabels);}}this.hasLabelCreated=true;allSpace=hCalculateSpace.call(this,maxSpace1,maxSpace2);return allSpace;}function hClearAndMeasureLabel(props){this.mDeviceDataArea.ResetRect(props.Rect2D);this.mLevelSize.splice(0,this.mLevelSize.length);this.mShownLabelList.splice(0,this.mShownLabelList.length);return hGetOneSideLabelSize.call(this,props.LowMargin,props.HighMargin,props.FixedMargin,props.StartIndex);}function hGetFirstShownGroupIdEx(axisTag,startIndex,lastIndex){var tripleId,interval,firstLabel,firstRect,paddingToChart=this.mChartContextPtr.GetGraphMatrixContext().getPadding($K.kLabelToChart);var findReasonableStartIndex=function(){tripleId=hGetAxisLabelTripleId.call(this,startIndex);interval=hInitializeIntervalWithFirstLabel.call(this,tripleId);firstLabel=hCreateGroupLabel.call(this,tripleId,interval,true);firstRect=firstLabel.GetBoundingRect(true);while(startIndex<=lastIndex){if((axisTag==="Y"&&firstRect.y>=paddingToChart)||(axisTag==="X"&&firstRect.x>0)){break;}startIndex++;tripleId=hGetAxisLabelTripleId.call(this,startIndex);interval=hInitializeIntervalWithFirstLabel.call(this,tripleId);firstLabel=hCreateGroupLabel.call(this,tripleId,interval,true);firstRect=firstLabel.GetBoundingRect(true);}};if(axisTag==="Y"){findReasonableStartIndex.call(this);}else{if(this.mChartContextPtr.GetGraphType()===$GT.DssGraphTypeGridChart&&axisTag==="X"){findReasonableStartIndex.call(this);}}return startIndex;}function hGetFirstShownGroupId(){if(this.mLabelInterval<=1){return 0;}var a=this.mGroupCount%this.mLabelInterval;if(a<=0){a=this.mLabelInterval;}return Math.ceil((a+1)/2)-1;}function hGetObjectIdForLabelorTicks(itemType){var objectIdBuckets=[[$GO.DssGraph2DO1Label,$GO.DssGraph2DO2Label],[$GO.DssGraphO1Major,$GO.DssGraphO2Major],[$GO.DssGraphO1Minor,$GO.DssGraphO2Minor]],associateIndex=1;if(this.mTripleId.mObjectId===$GO.DssGraphO1Body){associateIndex=0;}return objectIdBuckets[itemType][associateIndex];}function canWordWrap(limit){if(limit<0){return true;}var tripleId=new $C.TripleId({ObjectId:hGetObjectIdForLabelorTicks.call(this,$OID.OID_LABEL)});this.InitObjectSet(tripleId,$GRAPH_OBJ_TYPE.GOT_AXIS_LABEL);var formatFont=this.mpAxisLabelSet.mFormatFontPtr,wrappedUnit=4+2*formatFont.GetStringHeight("H"),gmCtx=this.mChartContextPtr.GetGraphMatrixContext(),groupCount=this.mGroupCount,l1=gmCtx.getPadding($K.kEndLabelToChart)*2+wrappedUnit*groupCount+gmCtx.getPadding($K.kBetweenLabels)*(groupCount-1);return l1<limit;}function canSkip(isX){var chartCtx=this.mChartContextPtr,result={Skip:false,Space:-1};if(!chartCtx.mIsGraphMatrix){return result;}if(!isX){if(this.resizeAction===-1||this.maxLabelLength===-1){return result;}this.mWordWrap=canWordWrap.call(this,this.mDeviceDataArea.height);if(this.resizeAction===$REC_CMP.ShrinkX||this.resizeAction===$REC_CMP.ExpandX){result.Skip=!this.mWordWrap;result.Space=hCalculateSpace.call(this,this.maxLabelLength,0);}}else{if(this.resizeAction===-1||this.maxLabelLength===-1){return result;}if(this.resizeAction===$REC_CMP.ExpandY||this.resizeAction===$REC_CMP.ShrinkY){if(this.getStatus()===2){this.mWordWrap=canWordWrap.call(this,this.mDeviceDataArea.height);result.Skip=!this.mWordWrap;this.mLevelSize.splice(0,this.mLevelSize.length);result.Space=hCalculateSpace.call(this,this.maxLabelLength,0);}}}return result;}function canAccommodateAllLabels(style){var chartCtx=this.mChartContextPtr;if(!chartCtx.mIsGraphMatrix){return false;}var gmCtx=chartCtx.GetGraphMatrixContext(),tripleId,label,l,plotGroupCount=this.mPlotGroupCount,normal=0,stagger=1,isRotated=this.getLabelRotation()===$FR.Rotate90,interval=1,i,w1=0,w2=0,result;for(i=0;i<plotGroupCount;i+=interval){tripleId=hGetAxisLabelTripleId.call(this,i,-3);label=hCreateGroupLabel.call(this,tripleId,interval,false);if(this.maxLabelLength===-1){label.Restore({Stringent:false,Restroke:true});}result=label.GetBoundingRect(true);l=isRotated?result.height:result.width;if(i%2===0){w1+=l;}else{w2+=l;}}if(style===stagger){l=Math.max(w1,w2)+Math.ceil(plotGroupCount/2)*gmCtx.getPadding($K.kBetweenLabels);}else{if(style===normal){l=w1+w2+(plotGroupCount-1)*gmCtx.getPadding($K.kBetweenLabels);}else{l=w1+w2+(plotGroupCount-1)*gmCtx.getPadding($K.kBetweenLabels);}}l+=2*gmCtx.getPadding($K.kLabelToChart);return l<=this.mDeviceDataArea.width;}function prepareLabelRotation(){var hasRestrict=isRestricted.call(this),chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext(),isX=this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_X,xAxis=uaCtx.CategoryAxis.X,formatFont=this.mpAxisLabelSet.GetFormatFont(),init=false;if(this.mIsUniformAxis&&isX&&xAxis){var xRotateMode=chartCtx.getUniformAxisLabelRotateMode("x");if(xRotateMode===$FR.Automatic){if(xAxis.Layout){var myOptions=this.mCategoryOption;myOptions.mLabelStyle=xAxis.Layout;if(hasRestrict){this.restoreLabels();}if(myOptions.mLabelStyle===1||myOptions.mLabelStyle===2){formatFont.mFontRotation=$FR.Normal;}else{formatFont.mFontRotation=$FR.Rotate90;}init=true;}}else{init=true;formatFont.mFontRotation=xRotateMode;}}if(!init){if(hasRestrict){this.restoreLabels();if(hasRestrict&&this.maxLabelLength===-1){formatFont.mFontRotation=$FR.Normal;}}if(this.mIsUniformAxis&&isX&&formatFont.mFontRotation===$FR.Normal){if(canAccommodateAllLabels.call(this,1)===false){formatFont.mFontRotation=$FR.Rotate90;}}}}function manipulateLabelsForAxisSpace(isX,initRect,lowMargin,highMargin,areFixedMargins){var chartCtx=this.mChartContextPtr,props={Rect2D:initRect,LowMargin:lowMargin,HighMargin:highMargin,FixedMargin:areFixedMargins,StartIndex:0},oneSideSize;oneSideSize=hClearAndMeasureLabel.call(this,props);if(chartCtx.mIsGraphMatrix===false){return oneSideSize;}props={Rect2D:initRect,LowMargin:lowMargin,HighMargin:highMargin,FixedMargin:areFixedMargins,StartIndex:0};var xRotateMode,style=this.mCategoryOption.mLabelStyle,enoughXLabels=600,enoughYLabels=800,interval=this.mLabelInterval;if(isX){xRotateMode=chartCtx.getUniformAxisLabelRotateMode("x");if(style!==CLS_STAGGER&&interval!==1&&this.mPlotGroupCount<=enoughXLabels){if(xRotateMode===$FR.Automatic||xRotateMode===$FR.Rotate90){this.mpAxisLabelSet.GetFormatFont().mFontRotation=$FR.Rotate90;this.mCategoryOption.mLabelStyle=CLS_MANUAL;}restoreLabelsInList.call(this,1);props.StartIndex=(interval>=3)?hGetFirstShownGroupId.call(this):0;oneSideSize=hClearAndMeasureLabel.call(this,props);if(style===CLS_MANUAL&&interval>=3&&chartCtx.GetGraphType()===$GRAPH_OBJ_TYPE.DssGraphTypeGridChart){props.StartIndex=hGetFirstShownGroupId.call(this);oneSideSize=hClearAndMeasureLabel.call(this,props);}}}else{if(interval>1&&this.mGroupCount>1){var shownCount=this.checkShownLabelCount();if(shownCount>=2){}else{if(shownCount===1){var reLayout=true,startIndex=hGetFirstShownGroupId.call(this),labelToBeShown=this.mLabelList[startIndex],currentShownLabel=this.mShownLabelList[0],validInstances=currentShownLabel&&labelToBeShown;if(validInstances){reLayout=currentShownLabel.mTripleId.mGroupId!==labelToBeShown.mTripleId.mGroupId;}if(validInstances&&reLayout){if(hIsYLabelFitWithPadding.call(this,labelToBeShown)){currentShownLabel.mIsShown=false;labelToBeShown.mIsShown=true;this.mShownLabelList=[];this.mShownLabelList.push(labelToBeShown);reLayout=false;}}if(reLayout){props.StartIndex=hGetFirstShownGroupId.call(this);oneSideSize=hClearAndMeasureLabel.call(this,props);}}}}}return oneSideSize;}function hReserveLabelSpace(lowMargin,highMargin,areFixedMargins){var labelList=this.mLabelList,labelLocation=[],oneSideSize,i,result,space,hasRestrict=isRestricted.call(this),isX=this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_X,len;perfInitRect.ResetRect(this.mDeviceDataArea);hGetLabelLocation.call(this,labelLocation);result=canSkip.call(this,isX);if(result.Skip&&hasRestrict){if(hasRestrict){this.restoreLabels();if(this.mLowTrim!==undefined&&this.mHighTrim!==undefined){if(this.mLowTrim>=0&&this.mHighTrim>=0){hApplyMarginsOnDataArea.call(this,this.mLowTrim,this.mHighTrim);}}}return result.Space;}prepareLabelRotation.call(this);oneSideSize=manipulateLabelsForAxisSpace.call(this,isX,perfInitRect,lowMargin,highMargin,areFixedMargins);len=labelLocation.length;for(i=0;i<len;++i){space=oneSideSize;if(hNeedTickLength.call(this,labelLocation[i])){space+=this.mTickLength;}hAdjustSpace.call(this,labelLocation[i],this.mDeviceDataArea,space);}if(this.HasLabelsOnBothSides()){len=labelList.length;for(i=0;i<len;++i){labelList.push(labelList[i]);}}this.mLabelSubIndex=this.mLabelList.length/(this.HasLabelsOnBothSides()?2:1);if(this.hasLabelCreated){attachInformationToLabels.call(this);}}function hOnFirstPlane(location){switch(this.mAxisInfo.mAxisDirection){case $AXIS_DIRECTION.AD_X:switch(location){case $AXIS_LABEL_LOC.ALL_BOTTOM:if(this.mDepthDirection>0&&this.mDepthDirection<180){return true;}break;case $AXIS_LABEL_LOC.ALL_TOP:if(this.mDepthDirection>=180&&this.mDepthDirection<360){return true;}break;}break;case $AXIS_DIRECTION.AD_Y:switch(location){case $AXIS_LABEL_LOC.ALL_LEFT:if(!(this.mDepthDirection>=90&&this.mDepthDirection<270)){return true;}break;case $AXIS_LABEL_LOC.ALL_RIGHT:if(this.mDepthDirection>=90&&this.mDepthDirection<270){return true;}break;}break;}return false;}function hGetOffShoreSpace(labelLocation,labelLevel){var j,gmCtx=this.mChartContextPtr.GetGraphMatrixContext(),offsetSpace=hNeedTickLength.call(this,labelLocation)?this.mTickLength:0;if(this.mIsGraphMatrix){offsetSpace+=gmCtx.getPadding($K.kCategoricalLabelToTick);}else{offsetSpace+=this.mLevelSpace*labelLevel;}for(j=0;j+1<labelLevel;++j){offsetSpace+=this.mLevelSize[j];}return offsetSpace;}function hAdjustTextPosition(){var i,labelLocation,oneLabel,grpOffset,offsetSpace,level,evenOdd,upper=1,down=2,shownLabels=this.mShownLabelList,labelCount=shownLabels.length,chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext(),isUniformAxis=this.mIsUniformAxis,categoryOption=this.mCategoryOption,xAxis=uaCtx.CategoryAxis.X;perfUnitOffset.Reset(0,0);perfAnchor.Reset(0,0);for(i=0;i<labelCount;++i){labelLocation=hGetSingleLabelLocation.call(this,i);oneLabel=shownLabels[i];if(!(oneLabel.mIsShown)){continue;}oneLabel.mIsOnScreen=hIsLabelOnScreen.call(this,oneLabel);if(!oneLabel.mIsOnScreen){continue;}grpOffset=this.getGroupMiddlePos(oneLabel.mTripleId.mGroupId,true);level=upper;if(categoryOption.mLabelStyle===$CLS.CLS_STAGGER&&!(chartCtx.mIsTimeSeriesChart)){evenOdd=(i>=this.mLabelSubIndex)?(i-this.mLabelSubIndex):i;if(evenOdd>=Math.floor((this.mLabelSubIndex+1)/2)){level=down;}if(isUniformAxis){if(xAxis.StartRow&&xAxis.StartRow===down){level=down+upper-level;}}}offsetSpace=hGetOffShoreSpace.call(this,labelLocation,level);perfUnitOffset.x=0;perfUnitOffset.y=1;perfAnchor.x=grpOffset;perfAnchor.y=hGetLabelOffset.call(this,labelLocation,offsetSpace,perfUnitOffset);if(this.IsVerticalAxis()){perfAnchor.swap();}if(this.mUseDepth){if(!hOnFirstPlane.call(this,labelLocation)){perfAnchor.x+=this.mDepthOffset.x;perfAnchor.y+=this.mDepthOffset.y;}}this.MoveLabel(oneLabel,perfAnchor,perfUnitOffset,0);}}function hGetInterlacedSectionPoints(groupId,start,end){var currentPos=this.mAxisCross?this.getGroupMiddlePos(groupId):(this.getGroupStartPos(groupId)+0.5),nextPos=this.mAxisCross?this.getGroupMiddlePos(groupId+1):(this.getGroupStartPos(groupId)+this.getGroupSize()+0.5);start.y=this.mDeviceDataArea.y;end.y=this.mDeviceDataArea.y;if(this.IsVerticalAxis()){start.x=this.mDeviceDataArea.x+this.mDeviceDataArea.width;end.x=start.x;start.y=currentPos;end.y=nextPos;}else{start.y=this.mDeviceDataArea.y;end.y=start.y;start.x=currentPos;end.x=nextPos;}}function hGenerateGridLine(objectID,groupIndex,gridStyle,first,second,collection){var utility_id=this.mChartContextPtr.getUtiliy().tripleId,tripleId,polyLine=[];tripleId=utility_id.create(objectID,this.mTripleId.mSeriesId,hGetCorrectGroupIndex());this.GetOneGridLine(this.mAxisInfo.mAxisLabelsLocation,gridStyle,this.mTickLength,first,second,polyLine);this.GenerateOneLineObject(tripleId,polyLine,collection);if(this.HasTwoGridLineParts(gridStyle)){polyLine.splice(0,polyLine.length);this.GetOneGridLine(this.IsVerticalAxis()?$AXIS_LABEL_LOC.ALL_RIGHT:$AXIS_LABEL_LOC.ALL_TOP,gridStyle,this.mTickLength,first,second,polyLine);this.GenerateOneLineObject(tripleId,polyLine,collection);}}function hGenerateMajorGrid(){var tripleId=$C.gAxisObjects[this.getIndex()].mMajorId,vecStart=[],vecEnd=[],i,len;hGetMajorPoints.call(this,vecStart,vecEnd);this.InitObjectSet(tripleId,$GRAPH_OBJ_TYPE.GOT_MAJOR_GRID);len=vecStart.length;for(i=0;i<len;++i){hGenerateGridLine.call(this,$GO.DssGraphO1Major,i,this.mMajorGrid.mGridStyle,vecStart[i],vecEnd[i],this.mpMajorGridSet);}}function hGenerateMinorGrid(){var vecFrom=[],vecTo=[],tripleId=$C.gAxisObjects[this.getIndex()].mMinorId,i,len;hGetMinorPoints.call(this,vecFrom,vecTo);this.InitObjectSet(tripleId,$GRAPH_OBJ_TYPE.GOT_MINOR_GRID);len=vecFrom.length;for(i=0;i<len;++i){hGenerateGridLine.call(this,$GO.DssGraphO1Minor,i,this.mMinorGrid.mGridStyle,vecFrom[i],vecTo[i],this.mpMinorGridSet);}}function hGetGroupCount(forLabel){return forLabel?this.mPlotGroupCount:this.mGroupCount;}function hGetGroupSize(forLabel){return forLabel?this.mPlotGroupSize:this.mGroupSize;}mstrmojo.chart.CategoryAxis=mstrmojo.declare(mstrmojo.chart.Axis,null,{scriptClass:"mstrmojo.chart.CategoryAxis",mLevelSpace:4,mLevelSize:null,mShownLabelList:null,mGroupOrder:null,mLabelSubIndex:0,mCategoryOption:null,mAxisCross:false,mGroupSize:-1,mPlotGroupSize:-1,mPlotGroupCount:0,mGroupCount:1,mDatasetPtr:null,mPaddingOnSide:-1,mWordWrap:true,screenWindow:null,init:function init(props){this._super(props);if(this.mChartContextPtr.mIsGraphMatrix){this.mLevelSpace=this.mChartContextPtr.GetGraphMatrixContext().getPadding($K.kBetweenLabelLines);}this.mLevelSize=[];this.mShownLabelList=[];this.mGroupOrder=[];this.mCategoryOption={mLabelStyle:$CLS.CLS_AUTOMATIC,mManualSkip:0};if(this.mChartContextPtr.mIsUniformAxisMode){this.mIsShown=this.mIsUniformAxis;}if(props.AxisDirection===$AXIS_DIRECTION.AD_X){this.mAxisInfo.mAxisLabelsLocation=$AXIS_LABEL_LOC.ALL_BOTTOM;}if(props.AxisDirection===$AXIS_DIRECTION.AD_Y){this.mAxisInfo.mAxisLabelsLocation=$AXIS_LABEL_LOC.ALL_LEFT;}this.mDatasetPtr=null;this.mWordWrap=false;this.LoadProperties();},SetDataset:function SetDataset(inputDataset){this.mGroupSize=-1;var dataset=this.mDatasetPtr=inputDataset;if(dataset!==null){if(hIsSeriesAxis.call(this)){this.mGroupCount=dataset.GetSeriesCount();}else{this.mGroupCount=dataset.GetGroupCount();}this.mPlotGroupCount=this.mGroupCount;}},getSubGroupMiddlePos:function getSubGroupMiddlePos(groupIndex,subIndex,sectionCount,forLabel){if(sectionCount<=0){return 0;}forLabel=forLabel||false;if(sectionCount===1){return this.getGroupMiddlePos(groupIndex);}var groupSize=this.getGroupSize(forLabel),groupStart=this.getGroupStartPos(groupIndex,forLabel);groupStart+=groupSize/(2*sectionCount);return groupStart+subIndex*(groupSize/sectionCount);},getGroupMiddlePos:function getGroupMiddlePos(groupIndex,forLabel){forLabel=(forLabel!==undefined)?forLabel:false;return Math.round(this.getGroupStartPos(groupIndex,forLabel)+this.getGroupSize()/2);},getFloatGroupMiddlePos:function getFloatGroupMiddlePos(groupIndex,forLabel){forLabel=(forLabel!==undefined)?forLabel:false;return this.getGroupStartPos(groupIndex,forLabel)+this.getGroupSize()/2;},getGroupStartPos:function getGroupStartPos(groupIndex,forLabel){forLabel=(forLabel!==undefined)?forLabel:false;var base=0;switch(this.mAxisInfo.mAxisDirection){case $AXIS_DIRECTION.AD_X:base=this.mDeviceDataArea.x+hGetPaddingOnSide.call(this);break;case $AXIS_DIRECTION.AD_Y:base=this.mDeviceDataArea.y+hGetPaddingOnSide.call(this);break;}if(this.mChartContextPtr.mIsGraphMatrix){if(this.mAxisCross){base-=this.getGroupSize(forLabel)*0.5;}}else{if(this.mAxisCross){base-=this.getGroupSize(forLabel)*0.5;}}return base+this.getGroupSize(forLabel)*groupIndex;},getGroupSize:function getGroupSize(forLabel){forLabel=(forLabel!==undefined)?forLabel:false;var grpSize=hGetGroupSize.call(this,forLabel);if(grpSize!==-1){return grpSize;}grpSize=0;var grpCount=hGetGroupCount.call(this,forLabel);if(this.mDatasetPtr!==null){if(!this.mAxisCross){if(grpCount===0){grpCount=1;}grpSize=hGetAxisLength.call(this)/grpCount;}else{if(grpCount>1){grpSize=hGetAxisLength.call(this)/(grpCount-1);}else{grpSize=hGetAxisLength.call(this)*2;}}}return grpSize;},GenerateMapAndList:function GenerateMapAndList(){var i,titleArea,objectList=this.mGraphObjectList,labelCollection=this.mpAxisLabelSet,labelList=this.mLabelList,len;if(this.mIsShown===false){return ;}hUpdateScreenWindow.call(this);if(labelList.length!==0){hAdjustTextPosition.call(this);if(this.mChartContextPtr.mIsGraphMatrix){var noneLabelList=[],labelId=$C.gAxisObjects[this.getIndex()].mLabelId;for(i=0;i<objectList.length;i++){if(objectList[i]&&objectList[i].mTripleId.mObjectId!==labelId.mObjectId){noneLabelList.push(objectList[i]);}}objectList=this.mGraphObjectList=[];labelCollection.ClearCollection();len=labelList.length;for(i=0;i<len;++i){if(labelList[i]){objectList.push(labelList[i]);labelCollection.AddGraphObject(labelList[i]);}}for(i=0;i<noneLabelList.length;i++){objectList.push(noneLabelList[i]);}}else{len=labelList.length;for(i=0;i<len;++i){if(labelList[i]){objectList.push(labelList[i]);labelCollection.AddGraphObject(labelList[i]);}}}}if(this.mAxisInfo.mShowAxisTitle){titleArea=this.getAdjustedTitleArea();this.UpdateTitleLocation(titleArea);}},getAdjustedTitleArea:function getAdjustedTitleArea(){var area=new $C.Rect2D({Rect2D:this.mDeviceDataArea}),i,location,len=this.mLevelSize.length;if(this.IsVerticalAxis()){location=$AXIS_LABEL_LOC.ALL_LEFT;if(location===this.mAxisInfo.mAxisLabelsLocation||this.mAxisInfo.mAxisLabelsLocation===$AXIS_LABEL_LOC.ALL_LEFT_RIGHT){area.x-=hNeedTickLength.call(this,location)?this.mTickLength:0;for(i=0;i<len;++i){area.x-=this.mLevelSpace;area.x-=this.mLevelSize[i];}if(!hOnFirstPlane.call(this,location)){area.x+=this.mDepthOffset.x;}}}else{location=$AXIS_LABEL_LOC.ALL_BOTTOM;if(location===this.mAxisInfo.mAxisLabelsLocation||this.mAxisInfo.mAxisLabelsLocation===$AXIS_LABEL_LOC.ALL_BOTTOM_TOP){area.height+=hNeedTickLength.call(this,location)?this.mTickLength:0;for(i=0;i<len;++i){area.height+=this.mLevelSpace;area.height+=this.mLevelSize[i];}if(!hOnFirstPlane.call(this,location)){area.height+=this.mDepthOffset.y;}}}return area;},generateInterlacedSection:function generateInterlacedSection(){var tripleId=new $C.TripleId({ObjectId:this.GetInterlacedGridId(),SeriesId:$NULL_SERIES,GroupId:$NULL_GROUP_ID}),i,polygon=[],oneSection,groupCount=this.mGroupCount;this.InitObjectSet(tripleId,$GRAPH_OBJ_TYPE.GOT_INTERLACED_GRID);for(i=0;i<groupCount;i+=2){if(this.mAxisCross&&i===groupCount-1){continue;}polygon.splice(0,polygon.length);this.getInterlacedSectionPolygon(i,polygon);oneSection=new $C.PolygonObject({TripleId:tripleId,GraphObjectManager:this,Polygon:polygon,GraphCollectionObject:this.mpInterlacedGridSet});this.mpInterlacedGridSet.AddGraphObject(oneSection);this.mManagerGraphObjectList.push(oneSection);}},getInterlacedSectionPolygon:function getInterlacedSectionPolygon(groupId,polygon){var useDepth=this.mUseDepth,deviceDataArea=this.mDeviceDataArea,depthDirection=this.mDepthDirection,depthOffset=this.mDepthOffset,end1=new $C.Point2D(),end2=new $C.Point2D(),start1,start2;hGetInterlacedSectionPoints.call(this,groupId,end1,end2);start1=new $C.Point2D({Point2D:end1});start2=new $C.Point2D({Point2D:end2});if(!this.IsVerticalAxis()){start1.y=deviceDataArea.GetBottomLeft().y;start2.y=start1.y;if(useDepth&&depthDirection>=180&&depthDirection<360){start1.swapPoints(end1);start2.swapPoints(end2);}}else{start1.x=deviceDataArea.x;start2.x=start1.x;if(useDepth&&depthDirection>=90&&depthDirection<270){start1.swapPoints(end1);start2.swapPoints(end2);}}if(useDepth){polygon.push(start1);polygon.push(start2);polygon.push(start2.Shifted(depthOffset));polygon.push(end2.Shifted(depthOffset));polygon.push(end1.Shifted(depthOffset));polygon.push(start1.Shifted(depthOffset));}else{polygon.push(start1);polygon.push(start2);polygon.push(end2);polygon.push(end1);}},AdjustTitleArea:function AdjustTitleArea(deviceDataArea){if(this.mAxisInfo.mShowAxisTitle){this.ReserveTitleArea(deviceDataArea);}},AdjustDataArea:function AdjustDataArea(dataArea,lowMargin,highMargin,areFixedMargins){var tripleId;if(!this.mIsShown){return ;}if(lowMargin===undefined){lowMargin=1000;}if(highMargin===undefined){highMargin=1000;}if(areFixedMargins===undefined){areFixedMargins=false;}if(this.mUseDepth){this.ReserveDepthAxisLine(dataArea);}if(this.mDatasetPtr!==null&&this.mAxisInfo.mShowAxisLabels){if(this.mUseDepth){var returnVal=this.TrimMarginsForDepthAxis(lowMargin,highMargin);lowMargin=returnVal.LowMargin;highMargin=returnVal.HighMargin;highMargin=returnVal.HighMargin;}tripleId=$C.gAxisObjects[this.getIndex()].mLabelId;this.InitObjectSet(tripleId,$GRAPH_OBJ_TYPE.GOT_AXIS_LABEL);if(this.mChartContextPtr.mIsGraphMatrix&&this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_Y){this.mpAxisLabelSet.GetFormatFont().mFontRotation=$FR.Normal;}this.SetDeviceDataArea(dataArea);hReserveLabelSpace.call(this,lowMargin,highMargin,areFixedMargins);var deviceArea=this.mDeviceDataArea;deviceArea.width=Math.max(deviceArea.width,0);deviceArea.height=Math.max(deviceArea.height,0);dataArea.ResetRect(deviceArea);}},generateGridsByArea:function generateGridsByArea(isGridLine){if(isGridLine){if(this.mMajorGrid.mShowGridLines){hGenerateMajorGrid.call(this);}if(this.mMinorGrid.mShowGridLines){hGenerateMinorGrid.call(this);}}else{if(this.mAxisInfo.mUseInterlacedGrids){this.generateInterlacedSection();}}},getMinMaxLogicalCoord:function getMinMaxLogicalCoord(){if(this.mAxisCross){return{min:1,max:(this.mGroupCount>1)?this.mGroupCount:2};}return{min:0.5,max:this.mGroupCount+0.5};},GenerateGridsOnMiddleWall:function GenerateGridsOnMiddleWall(y2DataArea,graphObjectList){var backupDataArea=this.mDeviceDataArea;this.mDeviceDataArea=y2DataArea;hGenerateInterlacedGridsOnMiddleWall.call(this);hGenerateMajorGridsOnMiddleWall.call(this);hGenerateMinorGridsOnMiddleWall.call(this);if(!this.mManagerGraphObjectList.empty()){this.MoveGraphObjectList(graphObjectList);}this.mDeviceDataArea=backupDataArea;},getTotalGroupCount:function getTotalGroupCount(){var isSliceEnabled=this.mDatasetPtr.GetSliceFlag(),totalGroupCount;this.mDatasetPtr.EnableSlices(false);totalGroupCount=this.mDatasetPtr.GetGroupCount();this.mDatasetPtr.EnableSlices(isSliceEnabled);return totalGroupCount;},LoadProperties:function LoadProperties(){var tripleId,value;this._super();if(!this.mIsShown){return ;}var chartCtx=this.mChartContextPtr,categoryOption=this.mCategoryOption;if(!chartCtx.mIsGraphMatrix){tripleId=new $C.TripleId({ObjectId:this.mTripleId.mObjectId});value=chartCtx.GetProperty($GP.DssGraphAxisAutoFit,tripleId);if(value!==null&&value!==undefined){if(value!==false){categoryOption.mLabelStyle=$CLS.CLS_NORMAL;}else{value=chartCtx.GetProperty($GP.DssGraphAxisStagger,tripleId);if(value!==null&&value!==undefined){if(value!==false){categoryOption.mLabelStyle=$CLS.CLS_STAGGER;}else{categoryOption.mLabelStyle=$CLS.CLS_MANUAL;value=chartCtx.GetProperty($GP.DssGraphAxisScaleFreq,tripleId);if(value){categoryOption.mManualSkip=value;if(categoryOption.mManualSkip<1){categoryOption.mManualSkip=1;}}}}}}switch(chartCtx.GetGraphMajorType()){case $GMT.GMT_RADAR:case $GMT.GMT_3D_CATEGORY:return ;case $GMT.GMT_CATEGORY:if(chartCtx.isParetoChart()){return ;}break;default:break;}}},TrimAxisPadding:function TrimAxisPadding(dataArea){var chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext(),caCtx=uaCtx.CategoryAxis;if(chartCtx.mIsGraphMatrix===false){return ;}var axisInfo,axisKey="X";if(this.IsVerticalAxis()){axisKey="Y";}if(this.mIsUniformAxis===false){axisInfo=caCtx[axisKey];this.mHighTrim=axisInfo.Trims[1]||0;this.mLowTrim=axisInfo.Trims[0]||0;}hTrimPaddingFromRect.call(this,this.mHighTrim,this.mLowTrim,dataArea);},ResetAxisPadding:function ResetAxisPadding(){this.mPaddingOnSide=-1;},getStatus:function getStatus(){var NORMAL=0,STAGGER=1,ROTATED=2,rotate=this.getLabelRotation(),interval=this.mLabelInterval;if(rotate===$FR.Rotate90){return ROTATED;}if(interval===1){return NORMAL;}if(interval===2&&this.mCategoryOption.mLabelStyle===$CLS.CLS_STAGGER){return STAGGER;}return ROTATED;},getGroupSlotAt:function getGroupSlotAt(position){var startPos=this.getGroupStartPos(0),groupSize=this.getGroupSize();return Math.ceil((position-startPos)/groupSize)-1;},getGridLinePosition:function getGridLinePosition(){return[];},getBandings:function getBandings(){var array=[],start=0,size=0,element,groupCount=this.mGroupCount,chartCtx=this.mChartContextPtr,i;if(groupCount===1){if(this.IsVerticalAxis()){size=chartCtx.mGraphHeight;}else{size=chartCtx.mGraphWidth;}array.push({Start:start,Size:size});}else{var groupSize=this.getGroupSize(true);for(i=0;i<groupCount;++i){if(i===0){start=0;size=this.getGroupStartPos(1,true);}else{if(i===groupCount-1){if(this.IsVerticalAxis()){size=chartCtx.mGraphHeight;}else{size=chartCtx.mGraphWidth;}element=array[i-1];start=element.Start+element.Size;size=size-start;}else{element=array[i-1];start=element.Start+element.Size;size=groupSize;}}array.push({Start:start,Size:size});}}return array;}});}());
(function(){mstrmojo.requiresClsP("mstrmojo.chart","ChartCanvas","FormatLine","FormatFont","FormatFill");mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.VisUtility","mstrmojo.chart.common.Utility","mstrmojo.chart.enums.EnumInstructionName");var $M=mstrmojo.chart.model,$MODEL_ENUMS=$M.enums,$VISUTIL=mstrmojo.VisUtility,$GT=$MODEL_ENUMS.EnumDSSGraphGradientType,kPI=3.141592653589793,SHAPE_CLASS_TABLE={area:["gm-shape-scircle","",""],line:["gm-shape-scircle","",""],"line-sizeby":["gm-shape-sbar","",""],bar:["gm-shape-bar","","gm-shape-grid-bar"],circle:["gm-shape-circle","gm-shape-circle","gm-shape-grid-circle"],square:["gm-shape-square","gm-shape-square","gm-shape-grid-square"],ticker:["gm-shape-ticker","gm-shape-ticker","gm-shape-grid-ticker"],pie:["gm-shape-pie","gm-shape-pie","gm-shape-pie"],ring:["gm-shape-ring","gm-shape-ring","gm-shape-ring"],markerRect:["gm-shape-bar","gm-shape-bar","gm-shape-bar"],markerCircle:["gm-shape-circle","gm-shape-circle","gm-shape-circle"]},SHAPE_SUBTYPE_TABLE={area:["scircle","",""],line:["scircle","",""],"line-sizeby":["sbar","",""],bar:["bar","","gbar"],circle:["circle","circle","circle"],square:["square","square","square"],ticker:["ticker","ticker","ticker"],pie:["pie","pie","pie"],ring:["ring","ring","ring"],markerRect:["gmMarker","gmMarker","gmMarker"],markerCircle:["gmMarker","gmMarker","gmMarker"]};var $Utility=mstrmojo.chart.common.Utility;var kCssColorResult={mR:0,mG:0,mB:0},kLineTrapezoidStyle={"stroke-width":0};function applyStrokePattern(strokePattern,lineWidth){var kLineStyleDash=1,kLineStyleDashDot=2,myStyle=this.mStyle;if(strokePattern===kLineStyleDash){myStyle["stroke-dasharray"]=hGetStrokeDashArray.call(this,true,lineWidth);}else{if(strokePattern===kLineStyleDashDot){myStyle["stroke-dasharray"]=hGetStrokeDashArray.call(this,false,lineWidth);}}}function hCreateGenericPolygon(iPoints){var i,polygon=document.createElementNS(this.mXMLNS,"polygon"),numOfPoints=iPoints.length,pointsStr="";for(i=0;i<numOfPoints;++i){pointsStr+=(iPoints[i].x+","+iPoints[i].y+" ");}polygon.setAttribute("points",pointsStr);return polygon;}function hAddOnePolygon(seriesID,iPoints){var polygon,svgGroup,zIndex=this.getDrawOrder(seriesID);this.mStyle["stroke-width"]="0";this.mAttributes["class"]="gm-set-line-polygon";this.mAttributes.type="set-shape";this.mAttributes.seriesID=seriesID;polygon=this.hCreateSVGPolygon(iPoints);this.hExtendGroups(zIndex);svgGroup=this.mSvg.childNodes[zIndex+1];svgGroup.appendChild(polygon);return{Polygon:polygon,Group:svgGroup};}function hGetStrokeDashArray(isDash,lineWidth){var lineThickness=lineWidth||1;return[isDash?lineThickness*3:lineThickness,lineThickness].join(" ");}function isUndefined(){var args=[].slice.call(arguments);return args.some(function(arg){return typeof arg==="undefined";});}function hDrawOuterBorder(curveStartP,curveEndP,largeArc,radius,zIndex,isWhiteStroke,ix,iy){var styleStr="stroke-width:3;stroke-opacity:1;fill:none;",lDStr="",border=document.createElementNS(this.mXMLNS,"path");if(isUndefined(curveStartP,curveEndP)){lDStr+=(" "+this.hMoveTo(ix,iy));lDStr+=(" "+this.hRelMoveTo(-radius,0));lDStr+=(" "+this.hRelArcTo(radius,largeArc,true,radius*2,0));lDStr+=(" "+this.hRelArcTo(radius,largeArc,true,-radius*2,0));}else{lDStr=this.hMoveTo(curveStartP.x,curveStartP.y),lDStr+=" "+this.hArcTo(radius,largeArc,true,curveEndP.x,curveEndP.y);}if(isWhiteStroke){styleStr+="stroke:rgb(255,255,255)";}else{styleStr+="stroke:rgb(0,0,0)";}border.sX=ix;border.sY=iy;border.sR=radius;border.sD=lDStr;border.setAttribute("d",lDStr);border.setAttribute("style",styleStr);this.mSvg.childNodes[zIndex+1].appendChild(border);}mstrmojo.chart.SVGCanvas=mstrmojo.declare(mstrmojo.chart.ChartCanvas,null,{scriptClass:"mstrmojo.chart.SVGCanvas",mSvg:null,mG:null,mDefs:null,mXMLNS:"http://www.w3.org/2000/svg",mStyle:null,mAttributes:null,mMarkerAttributes:null,mGradientCount:0,mElements:null,seriesDrawOrder:null,init:function init(props){var svg;this._super(props);svg=document.createElementNS(this.mXMLNS,"svg");svg.style.height="100%";svg.style.width="100%";svg.style.padding=0;this.mG=document.createElementNS(this.mXMLNS,"g");this.mDefs=document.createElementNS(this.mXMLNS,"defs");this.mG.appendChild(this.mDefs);svg.appendChild(this.mG);this.mStyle={};this.mSvg=svg;this.mAttributes={};this.mMarkerAttributes={};this.mElements=[];if(props.seriesDrawOrder&&props.seriesDrawOrder.length){this.seriesDrawOrder=props.seriesDrawOrder.concat();var myOrder=this.seriesDrawOrder,inputOrder=props.seriesDrawOrder,seriesId,drawingOrder;for(drawingOrder=0;drawingOrder<myOrder.length;drawingOrder++){seriesId=inputOrder[drawingOrder];myOrder[seriesId]=drawingOrder;}}},reset:function reset(){this.mStyle={};this.mAttributes={};this.mMarkerAttributes={};this.mElements=[];this.seriesDrawOrder=null;var element=this.mG;while(element.firstChild){element.removeChild(element.firstChild);}element=this.mSvg;while(element.firstChild){element.removeChild(element.firstChild);}element.appendChild(this.mG);this.mG.appendChild(this.mDefs);},setDrawOrder:function setDrawOrder(prop){if(prop){this.seriesDrawOrder=prop;}},getDrawOrder:function getDrawOrder(seriesIdx){if(seriesIdx===-3){seriesIdx=0;}var order=this.seriesDrawOrder;if(order&&order.length){if(seriesIdx>=order.length){$VISUTIL.visPrint("Drawing order,Max index exceeded");}return order[seriesIdx];}return seriesIdx;},SaveToObject:function SaveToObject(orGraphDesc){orGraphDesc.svg=this.mSvg;return true;},saveState:function saveState(){},RestoreState:function RestoreState(){},Clip:function Clip(){},Scale:function Scale(iX,iY){},Rotate:function Rotate(irAnchor,iRadian){this.SetAttribute("transform","rotate("+iRadian*180/kPI+" "+irAnchor.x+" "+irAnchor.y+")");},NewPath:function NewPath(){},ClosePath:function ClosePath(){},MoveTo:function MoveTo(iX,iY,iIsCurveAnimation,iBasePoint){},LineTo:function LineTo(iX,iY,iIsCurveAnimation,iBasePoint){},BezierCurveTo:function BezierCurveTo(iCP1X,iCP1Y,iCP2X,iCP2Y,iX,iY){},SetRGBAFillColor:function SetRGBAFillColor(iRed,iGreen,iBlue,iAlpha){},BoundedValue:function BoundedValue(iValue,iMin,iMax){if(iValue<iMin){return iMin;}if(iValue>iMax){return iMax;}return iValue;},SetRGBAStrokeColor:function SetRGBAStrokeColor(iRed,iGreen,iBlue,iAlpha){},FillPath:function FillPath(){},StrokePath:function StrokePath(){},SetLineDash:function SetLineDash(ipLinePattern,iDashNumber){},SetLineWidth:function SetLineWidth(iLineWidth){this.mStyle["stroke-width"]=iLineWidth;},SetLineJoin:function SetLineJoin(iLineJoinType){},SetFontSize:function SetFontSize(iFontSize){},AddRect:function AddRect(iX,iY,iW,iH){},SetAttribute:function SetAttribute(iKey,iValue){this.mAttributes[iKey]=iValue;},SetMarkerAttribute:function SetMarkerAttribute(iKey,iValue){this.mMarkerAttributes[iKey]=iValue;},CreateSVGCircle:function CreateSVGCircle(iX,iY,iR,iIdentity,drawBorder,isWhiteStroke){var seriesID=iIdentity.isPie?iIdentity.sPieDP.graphCell.sID:iIdentity.gc.sID,zIndex=this.getDrawOrder(seriesID),circle=document.createElementNS(this.mXMLNS,"circle"),styleStr=this.hToCSSStyleStr();if(iR<=10){circle.setAttribute("size","small");}circle.sX=iX;circle.sY=iY;circle.sR=iR;circle.identity=iIdentity;circle.setAttribute("cx",iX);circle.setAttribute("cy",iY);circle.setAttribute("r",iR);circle.setAttribute("style",styleStr);this.hExtendGroups(zIndex);this.hCopyAttribute(this.mAttributes,circle);var chartInfo=iIdentity.getChartInfo();if(iIdentity.objType===17179869184){chartInfo.currentMarkerShape=-1;}this.hSetExtraAttributes(circle,chartInfo,"circle");this.mSvg.childNodes[zIndex+1].appendChild(circle);if(drawBorder){hDrawOuterBorder.call(this,undefined,undefined,true,iR,zIndex,isWhiteStroke,iX,iY);}this.hResetStyleAndAttribute();},CreateSVGTextBoundingBox:function CreateSVGTextBoundingBox(polygon,color,forDataLabel,seriesCount){var onePolygon=this.hCreateSimpleSVGPolygon(polygon,color,true,forDataLabel);if(forDataLabel){if(this.mSvg.childNodes.length<=(seriesCount+2)){this.hExtendGroups(seriesCount+1);}this.mSvg.childNodes[seriesCount+2].appendChild(onePolygon);}else{this.mElements.push({Type:"BBox",Node:onePolygon});}},hCreateSimpleSVGPolygon:function hCreateSimpleSVGPolygon(iPoints,color,isBorderOnly,forDataLabel){var polygon=document.createElementNS(this.mXMLNS,"polygon"),len=iPoints.length,pointsStr="",i,colorStr=this.hToCSSColorStr(color),styleStr;if(forDataLabel){styleStr="stroke-width:2;stroke:rgb(0,0,0);stroke-opacity:1";}else{styleStr="stroke-width:1;stroke:rgb(0,0,0);stroke-opacity:1";}styleStr+=";stroke:"+colorStr;isBorderOnly=isBorderOnly||false;if(isBorderOnly){styleStr+=";fill-opacity:0";}for(i=0;i<len;++i){pointsStr+=(iPoints[i].x+","+iPoints[i].y+" ");}polygon.setAttribute("points",pointsStr);polygon.setAttribute("style",styleStr);this.hCopyAttribute(this.mAttributes,polygon);return polygon;},CreateSVGRect:function CreateSVGRect(iX,iY,iW,iH,iIdentity){var seriesID=iIdentity.isPie?iIdentity.sPieDP.graphCell.sID:iIdentity.gc.sID,zIndex=this.getDrawOrder(seriesID),rect=document.createElementNS(this.mXMLNS,"rect"),styleStr=this.hToCSSStyleStr();if(iW<=5||iH<=5){rect.setAttribute("size","small");}rect.identity=iIdentity;rect.setAttribute("x",iX);rect.setAttribute("y",iY);rect.setAttribute("width",iW);rect.setAttribute("height",iH);rect.setAttribute("style",styleStr);this.hExtendGroups(zIndex);this.hCopyAttribute(this.mAttributes,rect);var chartInfo=iIdentity.getChartInfo();if(iIdentity.objType===17179869184){chartInfo.currentMarkerShape=-2;}this.hSetExtraAttributes(rect,chartInfo);this.mSvg.childNodes[zIndex+1].appendChild(rect);this.hResetStyleAndAttribute();},CreateSVGSector:function CreateSVGSector(iX,iY,iR,iStartRadian,iEndRadian,iIdentity,drawBorder,isWhiteStroke){var gc=iIdentity.gc||iIdentity.sPieDP.graphCell,seriesID=gc.sID,zIndex=this.getDrawOrder(seriesID),sector=document.createElementNS(this.mXMLNS,"path"),lDStr=this.hMoveTo(iX,iY),curveStartP=this.hCalPoint(iX,iY,iR,iStartRadian),curveEndP=this.hCalPoint(iX,iY,iR,iEndRadian),largeArc=iEndRadian-iStartRadian>Math.PI,styleStr=this.hToCSSStyleStr(),geoCenter=this.hCalPoint(iX,iY,iR/2,(iStartRadian+iEndRadian)/2);lDStr+=(" "+this.hLineTo(curveStartP.x,curveStartP.y));lDStr+=(" "+this.hArcTo(iR,largeArc,true,curveEndP.x,curveEndP.y));lDStr+=(" "+this.hClosePath());sector.sX=iX;sector.sY=iY;sector.sR=iR;sector.sRadStart=iStartRadian;sector.sRadEnd=iEndRadian;sector.sD=lDStr;sector.sGeoCenterX=geoCenter.x;sector.sGeoCenterY=geoCenter.y;if(iR<=10){sector.setAttribute("size","small");}sector.setAttribute("d",lDStr);sector.setAttribute("style",styleStr);sector.identity=iIdentity;this.hExtendGroups(zIndex);this.hCopyAttribute(this.mAttributes,sector);this.hSetExtraAttributes(sector,iIdentity.getChartInfo());this.mSvg.childNodes[zIndex+1].appendChild(sector);if(drawBorder){hDrawOuterBorder.call(this,curveStartP,curveEndP,largeArc,iR,zIndex,isWhiteStroke,iX,iY);}this.hResetStyleAndAttribute();},CreateSVGRingSector:function CreateSVGRingSector(iX,iY,iOutR,iInR,iStartRadian,iEndRadian,iIdentity){var seriesID=iIdentity.isPie?iIdentity.sPieDP.graphCell.sID:iIdentity.gc.sID,zIndex=this.getDrawOrder(seriesID),sector=document.createElementNS(this.mXMLNS,"path"),outCurveStartP=this.hCalPoint(iX,iY,iOutR,iStartRadian),outCurveEndP=this.hCalPoint(iX,iY,iOutR,iEndRadian),inCurveStartP=this.hCalPoint(iX,iY,iInR,iStartRadian),inCurveEndP=this.hCalPoint(iX,iY,iInR,iEndRadian),largeArc=iEndRadian-iStartRadian>Math.PI,lDStr=this.hMoveTo(inCurveStartP.x,inCurveStartP.y),styleStr=this.hToCSSStyleStr(),geoCenter=this.hCalPoint(iX,iY,(iOutR+iInR)>>1,(iStartRadian+iEndRadian)/2);lDStr+=(" "+this.hArcTo(iInR,largeArc,true,inCurveEndP.x,inCurveEndP.y));lDStr+=(" "+this.hLineTo(outCurveEndP.x,outCurveEndP.y));lDStr+=(" "+this.hArcTo(iOutR,largeArc,false,outCurveStartP.x,outCurveStartP.y));lDStr+=(" "+this.hClosePath());sector.sX=iX;sector.sY=iY;sector.sOutR=iOutR;sector.sInR=iInR;sector.sRadStart=iStartRadian;sector.sRadEnd=iEndRadian;sector.sD=lDStr;sector.sGeoCenterX=geoCenter.x;sector.sGeoCenterY=geoCenter.y;if(iOutR<=10){sector.setAttribute("size","small");}sector.setAttribute("d",lDStr);sector.setAttribute("style",styleStr);sector.identity=iIdentity;this.hExtendGroups(zIndex);this.hCopyAttribute(this.mAttributes,sector);this.hSetExtraAttributes(sector,iIdentity.getChartInfo());this.mSvg.childNodes[zIndex+1].appendChild(sector);this.hResetStyleAndAttribute();sector.setAttribute("class","gm-shape-ring");sector.setAttribute("subtype","ring");},CreateSVGRing:function CreateSVGRing(iX,iY,iOutR,iInR,iIdentity){var seriesID=iIdentity.isPie?iIdentity.sPieDP.graphCell.sID:iIdentity.gc.sID,zIndex=this.getDrawOrder(seriesID),ring=document.createElementNS(this.mXMLNS,"path"),outCurveLeftP=this.hCalPoint(iX,iY,iOutR,Math.PI),outCurveRightP=this.hCalPoint(iX,iY,iOutR,0),inCurveLeftP=this.hCalPoint(iX,iY,iInR,Math.PI),inCurveRightP=this.hCalPoint(iX,iY,iInR,0),lDStr=this.hMoveTo(outCurveLeftP.x,outCurveLeftP.y),styleStr=this.hToCSSStyleStr();lDStr+=(" "+this.hArcTo(iOutR,true,true,outCurveRightP.x,outCurveRightP.y));lDStr+=(" "+this.hMoveTo(inCurveRightP.x,inCurveRightP.y));lDStr+=(" "+this.hArcTo(iInR,true,false,inCurveLeftP.x,inCurveLeftP.y));lDStr+=(" "+this.hArcTo(iInR,true,false,inCurveRightP.x,inCurveRightP.y));lDStr+=(" "+this.hMoveTo(outCurveRightP.x,outCurveRightP.y));lDStr+=(" "+this.hArcTo(iOutR,true,true,outCurveLeftP.x,outCurveLeftP.y));ring.sX=iX;ring.sY=iY;ring.sGeoCenterX=iX;ring.sGeoCenterY=iY;ring.sOutR=iOutR;ring.sInR=iInR;ring.setAttribute("d",lDStr);ring.setAttribute("style",styleStr);ring.identity=iIdentity;this.hExtendGroups(zIndex);this.hCopyAttribute(this.mAttributes,ring);this.hSetExtraAttributes(ring,iIdentity.getChartInfo());this.mSvg.childNodes[zIndex+1].appendChild(ring);this.hResetStyleAndAttribute();},CreateSVGCurves:function CreateSVGCurves(points,seriesCount,series,identity,isTrendLine,start,mid,end){var style,i,size=points.length,path=document.createElementNS(this.mXMLNS,"path"),hoverPath,dString="",numOfFourPointsSet=Math.floor(size/4),highlightPoints="",hoverStyleStr,originalWidth,originalOpacity,originalStrokeDashArray,useHoverPath=(isTrendLine&&(this.mStyle["stroke-width"]<3));this.mStyle.fill="none";if(useHoverPath){originalOpacity=this.mStyle["stroke-opacity"];originalWidth=this.mStyle["stroke-width"];if(this.mStyle["stroke-dasharray"]!==undefined){originalStrokeDashArray=this.mStyle["stroke-dasharray"];delete this.mStyle["stroke-dasharray"];}this.mStyle["stroke-width"]=3;this.mStyle["stroke-opacity"]=0;hoverStyleStr=this.hToCSSStyleStr();this.mStyle["stroke-opacity"]=originalOpacity;this.mStyle["stroke-width"]=originalWidth;if(originalStrokeDashArray){this.mStyle["stroke-dasharray"]=originalStrokeDashArray;}hoverPath=document.createElementNS(this.mXMLNS,"path");}style=this.hToCSSStyleStr();this.hCopyAttribute(this.mAttributes,path);for(i=0;i<numOfFourPointsSet;++i){if(i===0){dString="M "+points[i].x+","+points[i].y+" ";}dString+=("C "+points[i*4+1].x+","+points[i*4+1].y+" ");dString+=(points[i*4+2].x+","+points[i*4+2].y+" ");dString+=(points[i*4+3].x+","+points[i*4+3].y+" ");}path.identity=identity;path.setAttribute("style",style);path.setAttribute("d",dString);if(useHoverPath){this.hCopyAttribute(this.mAttributes,hoverPath);hoverPath.identity=identity;hoverPath.setAttribute("style",hoverStyleStr);hoverPath.setAttribute("d",dString);}if(isTrendLine){path.setAttribute("type","trendLine");path.setAttribute("class","gm-set-trendline");highlightPoints="startpoint:"+start.x+","+start.y+";";highlightPoints+="midpoint:"+mid.x+","+mid.y+";";highlightPoints+="endpoint:"+end.x+","+end.y;path.setAttribute("highlightPoints",highlightPoints);path.setAttribute("hover-catcher","0");if(this.mSvg.childNodes.length<=(seriesCount+2)){this.hExtendGroups(seriesCount+1);}this.mSvg.childNodes[seriesCount+2].appendChild(path);if(useHoverPath){hoverPath.setAttribute("type","trendLine");hoverPath.setAttribute("class","gm-set-trendline");hoverPath.setAttribute("highlightPoints",highlightPoints);hoverPath.setAttribute("hover-catcher","1");this.mSvg.childNodes[seriesCount+2].appendChild(hoverPath);}}else{if(series!==-1){if(this.mSvg.childNodes.length<=(series+1)){this.hExtendGroups(series);}this.mSvg.childNodes[series+1].appendChild(path);this.hSetExtraAttributes(path,identity.getChartInfo());}}this.hReset();},CreateSVGPolyLineForTRLine:function CreateSVGPolyLineForTRLine(points,seriesCount,identity,isTrendLine,start,mid,end){var i,line=document.createElementNS(this.mXMLNS,"polyline"),hoverLine,numOfPoints=points.length,pointsStr="",styleStr,hoverStyleStr,originalWidth,originalOpacity,originalStrokeDashArray,useHoverLine=(this.mStyle["stroke-width"]<3),highlightPoints;this.mStyle.fill="none";if(useHoverLine){originalOpacity=this.mStyle["stroke-opacity"];originalWidth=this.mStyle["stroke-width"];if(this.mStyle["stroke-dasharray"]!==undefined){originalStrokeDashArray=this.mStyle["stroke-dasharray"];delete this.mStyle["stroke-dasharray"];}this.mStyle["stroke-width"]=3;this.mStyle["stroke-opacity"]=0;hoverStyleStr=this.hToCSSStyleStr();this.mStyle["stroke-opacity"]=originalOpacity;this.mStyle["stroke-width"]=originalWidth;if(originalStrokeDashArray){this.mStyle["stroke-dasharray"]=originalStrokeDashArray;}hoverLine=document.createElementNS(this.mXMLNS,"polyline");}styleStr=this.hToCSSStyleStr();for(i=0;i<numOfPoints;++i){pointsStr+=(points[i].x+","+points[i].y+" ");}line.identity=identity;line.setAttribute("points",pointsStr);line.setAttribute("style",styleStr);if(isTrendLine){line.setAttribute("type","trendLine");line.setAttribute("class","gm-set-trendline");}else{line.setAttribute("type","referenceLine");line.setAttribute("class","gm-set-referenceline");}highlightPoints="startpoint:"+start.x+","+start.y+";";highlightPoints+="midpoint:"+mid.x+","+mid.y+";";highlightPoints+="endpoint:"+end.x+","+end.y;line.setAttribute("highlightPoints",highlightPoints);line.setAttribute("hover-catcher","0");this.hCopyAttribute(this.mAttributes,line);if(this.mSvg.childNodes.length<=(seriesCount+2)){this.hExtendGroups(seriesCount+1);}this.mSvg.childNodes[seriesCount+2].appendChild(line);if(useHoverLine){hoverLine.identity=identity;hoverLine.setAttribute("points",pointsStr);hoverLine.setAttribute("style",hoverStyleStr);if(isTrendLine){hoverLine.setAttribute("type","trendLine");hoverLine.setAttribute("class","gm-set-trendline");}else{hoverLine.setAttribute("type","referenceLine");hoverLine.setAttribute("class","gm-set-referenceline");}hoverLine.setAttribute("hover-catcher","1");this.hCopyAttribute(this.mAttributes,hoverLine);this.mSvg.childNodes[seriesCount+2].appendChild(hoverLine);}this.hReset();},hCalPoint:function hCalPoint(iX,iY,iR,iRadian){var lX=iX+iR*Math.cos(iRadian),lY=iY+iR*Math.sin(iRadian);return{x:lX,y:lY};},hMoveTo:function hMoveTo(iX,iY){return"M "+iX+" "+iY;},hLineTo:function hLineTo(iX,iY){return"L "+iX+" "+iY;},hArcTo:function hArcTo(iR,iLargeArc,iClockwise,iX,iY){return"A "+iR+","+iR+" 0 "+(iLargeArc?"1":"0")+","+(iClockwise?"1 ":"0 ")+iX+","+iY;},hClosePath:function hClosePath(){return"Z";},hRelMoveTo:function hRelMoveTo(iX,iY,iR,iRadian){return"m "+iX+" "+iY;},hRelArcTo:function hArcTo(iR,iLargeArc,iClockwise,iX,iY){return"a "+iR+","+iR+" 0 "+(iLargeArc?"1":"0")+","+(iClockwise?"1 ":"0 ")+iX+","+iY;},hExtendGroups:function(drawingOrder){var g,svg=this.mSvg,groups=svg.childNodes,n=groups.length-1;while(n<=drawingOrder){g=document.createElementNS(this.mXMLNS,"g");svg.appendChild(g);n++;}},CreateSVGPolyLine:function CreateSVGPolyLine(seriesID,iPoints,iIdentities,type){var svgGroup,zIndex=this.getDrawOrder(seriesID);var kPolylineTypeGeneric=0,kPolylineTypeBulletTarget=1,kPolylineTypeAxisTicks=2,kPolylineTypeAxisBody=3,kPolylineTypeAxisOrigin=4,kPolylineTypeTickerShape=5;type=type||kPolylineTypeGeneric;this.mAttributes["class"]="gm-set-polyline";this.mAttributes.type="set-shape";this.mAttributes.seriesID=seriesID;switch(type){case kPolylineTypeGeneric:break;case kPolylineTypeBulletTarget:break;case kPolylineTypeAxisTicks:break;case kPolylineTypeAxisBody:break;case kPolylineTypeAxisOrigin:this.mAttributes["class"]="gm-set-originline";this.mAttributes.type="originLine";if(iPoints[0].x===iPoints[1].x){this.mAttributes.subtype="v";}else{this.mAttributes.subtype="h";}break;case kPolylineTypeTickerShape:this.mAttributes.subtype="ticker";this.mAttributes.type="shape";this.mAttributes["class"]="gm-shape-ticker";break;default:break;}this.hExtendGroups(zIndex);svgGroup=this.mSvg.childNodes[zIndex+1];var line=this.hCreateSVGPolyline(iPoints,svgGroup);if(type===kPolylineTypeTickerShape||type===kPolylineTypeAxisOrigin){if(iIdentities.length){line.identity=iIdentities[0];}if(type===kPolylineTypeTickerShape){if(iPoints.length>=2){var p1=iPoints[0],p2=iPoints[1];line.tickerCenter={x:Math.round(0.5*(p1.x+p2.x)),y:Math.round(0.5*(p1.y+p2.y))};}}}this.hResetStyleAndAttribute();},CreateSVGPolylineWithCircles:function CreateSVGPolylineWithCircles(seriesID,iPoints,iIdentities){var i,circle,identity,svgGroup,zIndex=this.getDrawOrder(seriesID);this.mAttributes["class"]="gm-set-polyline";this.mAttributes.type="set-shape";this.mAttributes.seriesID=seriesID;this.hExtendGroups(zIndex);svgGroup=this.mSvg.childNodes[zIndex+1];this.hCreateSVGPolyline(iPoints,svgGroup);for(i=0;i<iPoints.length;++i){circle=document.createElementNS(this.mXMLNS,"circle");identity=iIdentities[i];circle.identity=identity;circle.setAttribute("cx",iPoints[i].x);circle.setAttribute("cy",iPoints[i].y);circle.setAttribute("r","5.5");circle.style.fill=this.mStyle.stroke;this.hCopyAttribute(this.mMarkerAttributes,circle);circle.setAttribute("class","gm-shape-scircle");circle.setAttribute("type","shape");circle.setAttribute("subtype","scircle");svgGroup.appendChild(circle);}this.hResetStyleAndAttribute();},hCreateSVGPolyline:function hCreateSVGPolyline(iPoints,svgGroup){this.mStyle.fill="none";var i,line=document.createElementNS(this.mXMLNS,"polyline"),len=iPoints.length,pointsStr="",styleStr=this.hToCSSStyleStr();line.pointList=iPoints;for(i=0;i<len;++i){pointsStr+=(iPoints[i].x+","+iPoints[i].y+" ");}line.setAttribute("points",pointsStr);line.setAttribute("style",styleStr);this.hCopyAttribute(this.mAttributes,line);svgGroup.appendChild(line);return line;},CreateSVGPolygonWithCircles:function CreateSVGPolygonWithCircles(seriesID,iPoints,iIdentities){var i,polygon,circle,identity,svgGroup,result;result=hAddOnePolygon.call(this,seriesID,iPoints);polygon=result.Polygon;svgGroup=result.Group;var len=iPoints.length;if((len&1)!==0){return ;}for(i=0;i<len/2;++i){circle=document.createElementNS(this.mXMLNS,"circle");identity=iIdentities[i];circle.identity=identity;circle.setAttribute("cx",iPoints[i].x);circle.setAttribute("cy",iPoints[i].y);circle.setAttribute("r","5.5");circle.style.fill=this.mStyle.fill;this.hCopyAttribute(this.mMarkerAttributes,circle);circle.setAttribute("class","gm-shape-scircle");circle.setAttribute("type","shape");circle.setAttribute("subtype","scircle");svgGroup.appendChild(circle);}polygon.chartInfo=identity.getChartInfo();this.hResetStyleAndAttribute();},CreateSVGPolygonWithTrapezoid:function CreateSVGPolygonWithTrapezoid(seriesID,iPoints,iIdentities){var i,polygon,chtInfo,rect,identity,svgGroup,result,span,trapezoidPoints;result=hAddOnePolygon.call(this,seriesID,iPoints);polygon=result.Polygon;svgGroup=result.Group;var len=iPoints.length;if((len&1)!==0||len<4){return ;}span=len/2;var a,b,a1,b1,a2,b2,array,k,trapezoid;for(i=0;i<span;++i){a1=b1=a2=b2=null;trapezoidPoints=[];a=iPoints[i];b=iPoints[len-1-i];if(i!==0){a1=iPoints[i-1];b1=iPoints[len-i];}if(i!==span-1){a2=iPoints[i+1];b2=iPoints[len-2-i];}if(a1){a1={x:0.5*(a1.x+a.x),y:0.5*(a1.y+a.y)};}if(b1){b1={x:0.5*(b1.x+b.x),y:0.5*(b1.y+b.y)};}if(a2){a2={x:0.5*(a2.x+a.x),y:0.5*(a2.y+a.y)};}if(b2){b2={x:0.5*(b2.x+b.x),y:0.5*(b2.y+b.y)};}array=[a1,a,a2,b2,b,b1];for(k=0;k<array.length;k++){if(array[k]){trapezoidPoints.push(array[k]);}}trapezoid=hCreateGenericPolygon.call(this,trapezoidPoints);if(trapezoid&&iIdentities[i]){trapezoid.identity=iIdentities[i];}trapezoid.setAttribute("class","gm-shape-sbar");trapezoid.setAttribute("type","shape");trapezoid.setAttribute("subtype","sbar");this.hCopyAttribute(kLineTrapezoidStyle,trapezoid);svgGroup.appendChild(trapezoid);}polygon.chartInfo=chtInfo;this.hResetStyleAndAttribute();},CreateSVGPolygonWithRects:function CreateSVGPolygonWithRects(seriesID,iPoints,iIdentities){var i,polygon,chtInfo,rect,identity,svgGroup,result;result=hAddOnePolygon.call(this,seriesID,iPoints);polygon=result.Polygon;svgGroup=result.Group;var len=iPoints.length;if((len&1)!==0){return ;}for(i=0;i<len/2;++i){rect=document.createElementNS(this.mXMLNS,"rect");identity=iIdentities[i];chtInfo=identity.getChartInfo();rect.identity=identity;if(chtInfo.dirc===1){rect.setAttribute("x",(iPoints[i].x).toString());rect.setAttribute("y",String(iPoints[i].y-3));rect.setAttribute("width",(iPoints[len-i-1].x-iPoints[i].x).toString());rect.setAttribute("height","6");}else{rect.setAttribute("x",(iPoints[i].x-3).toString());rect.setAttribute("y",iPoints[i].y);rect.setAttribute("width","6");rect.setAttribute("height",(iPoints[len-i-1].y-iPoints[i].y).toString());}this.hCopyAttribute(this.mMarkerAttributes,rect);rect.setAttribute("class","gm-shape-sbar");rect.setAttribute("type","shape");rect.setAttribute("subtype","sbar");svgGroup.appendChild(rect);}polygon.chartInfo=chtInfo;this.hResetStyleAndAttribute();},hManipulateTextElements:function hManipulateTextElements(props){if(props.Tooltip){var i=0,element,elements=this.mElements,length=elements.length;while(i<length){element=elements[i];if(element.Tag&&element.Tag==="tspan"){element.Tooltip=props.Tooltip;}i++;}}},CreateSVGAxisText:function CreateSVGAxisText(seriesID,fullText,identities){var style=this.hToCSSStyleStr(),text=document.createElementNS(this.mXMLNS,"text");this.hCopyAttribute(this.mAttributes,text);text.setAttribute("style",style);text.setAttribute("type","axis-text");if(identities){text.identity=identities;}this.hManipulateTextElements({Tooltip:fullText});this.hCopyTextElements(text,"axis-word");var zIndex=this.getDrawOrder(seriesID);this.hExtendGroups(zIndex);this.mSvg.childNodes[zIndex+1].appendChild(text);this.hReset();},CreateSVGBannerText:function CreateSVGBannerText(seriesID,identities){var style=this.hToCSSStyleStr(),text=document.createElementNS(this.mXMLNS,"text");this.hCopyAttribute(this.mAttributes,text);text.setAttribute("style",style);text.setAttribute("type","banner-text");if(identities){text.identity=identities;}this.hCopyTextElements(text,"banner-text");var zIndex=this.getDrawOrder(seriesID);this.hExtendGroups(zIndex);this.mSvg.childNodes[zIndex+1].appendChild(text);this.hReset();},CreateSVGGenericText:function CreateSVGGenericText(seriesCount,identity,type){var style=this.hToCSSStyleStr(),text=document.createElementNS(this.mXMLNS,"text");type=type||"data-label";if(!!identity){text.identity=identity;}this.hCopyAttribute(this.mAttributes,text);text.setAttribute("style",style);this.hCopyTextElements(text,type);if(seriesCount){if(this.mSvg.childNodes.length<=(seriesCount+2)){this.hExtendGroups(seriesCount+1);}this.mSvg.childNodes[seriesCount+2].appendChild(text);}else{this.mG.appendChild(text);}this.hReset();},hCopyTextElements:function hCopyTextElements(parent,type){type=type||"axis-word";var i,p,tspanIndex=0;for(i=0;i<this.mElements.length;i++){var oneElement=this.mElements[i];if(oneElement){if(oneElement.Type==="text"){var tspan=document.createElementNS(this.mXMLNS,oneElement.Tag),attributes=oneElement.Attributes;for(p in attributes){tspan.setAttribute(p,attributes[p]);}tspan.setAttribute("type",type);if(type==="axis-word"){tspan.setAttribute("Index",tspanIndex);tspanIndex++;}tspan.setAttribute("class","gm-tspan");tspan.textContent=oneElement.Content;if(oneElement.Tooltip){var title=document.createElementNS(this.mXMLNS,"title");title.textContent=oneElement.Tooltip;tspan.appendChild(title);}if(oneElement.Style){tspan.setAttribute("style",oneElement.Style);}parent.appendChild(tspan);}else{if(oneElement.Type==="BBox"){if(oneElement.Node){this.mG.appendChild(oneElement.Node);}}}}}},CreateSVGPolygon:function CreateSVGPolygon(seriesIndex,iPoints,iIdentity){var svgGroup,zIndex=this.getDrawOrder(seriesIndex);var polygon=this.hCreateSVGPolygon(iPoints,iIdentity);this.hExtendGroups(zIndex);svgGroup=this.mSvg.childNodes[zIndex+1];svgGroup.appendChild(polygon);this.mG.appendChild(polygon);this.hResetStyleAndAttribute();},hCreateSVGPolygon:function hCreateSVGPolygon(iPoints,iIdentity){var i,styleStr=this.hToCSSStyleStr(),numOfPoints=iPoints.length,polygon=hCreateGenericPolygon.call(this,iPoints);polygon.points=iPoints;if(iIdentity!==undefined){polygon.identity=iIdentity;}polygon.setAttribute("style",styleStr);this.hCopyAttribute(this.mAttributes,polygon);return polygon;},AddArc:function AddArc(iX,iY,iRadius,iStartAngle,iEndAngle,bAntiClockwise){},AddNeedle:function AddNeedle(iNeedleStyle,iBasePoint,iAngle,iSize){},AddString:function AddString(irPoint,ipText){},FillSimple:function FillSimple(ipFill,iDarkerFactor,iColor,iHasExtraPara){this.mStyle.fill=this.hToCSSColorStr(iColor);this.mStyle["fill-opacity"]=ipFill.mAlpha/255;},FillPattern:function FillPattern(ipFill){},FillGradient:function FillGradient(ipFill,infoObject,iDarkerFactor){var i,linearGradient,radialGradient,colorsStop,fillGradient=ipFill.getGradient();switch(fillGradient.gradientType){case $GT.DssGraphGradientLinear:if(infoObject.width===0||infoObject.height===0){return ;}linearGradient=document.createElementNS(this.mXMLNS,"linearGradient");linearGradient.setAttribute("id",String(this.gradPrefix+(this.mGradientCount)));linearGradient.setAttribute("x1","0%");linearGradient.setAttribute("y1","0%");if(fillGradient.angle===0){linearGradient.setAttribute("x2","100%");linearGradient.setAttribute("y2","0%");}else{linearGradient.setAttribute("x2","0%");linearGradient.setAttribute("y2","100%");}colorsStop=this.hCreateLinearGradientStop(0,fillGradient.startGraphColor,ipFill.mAlpha/255);linearGradient.appendChild(colorsStop);for(i=0;i<fillGradient.intermediateColors.length;++i){var interColor=fillGradient.intermediateColors[i];colorsStop=this.hCreateLinearGradientStop(interColor.Step,interColor.Color,ipFill.mAlpha/255);linearGradient.appendChild(colorsStop);}colorsStop=this.hCreateLinearGradientStop(1,fillGradient.endGraphColor,ipFill.mAlpha/255);linearGradient.appendChild(colorsStop);this.mDefs.appendChild(linearGradient);this.mStyle.fill="url(#"+this.gradPrefix+(this.mGradientCount++)+")";break;case $GT.DssGraphGradientCircular:radialGradient=document.createElementNS(this.mXMLNS,"radialGradient");radialGradient.setAttribute("id",String(this.gradPrefix+(this.mGradientCount)));radialGradient.setAttribute("cx",String(infoObject.cx));radialGradient.setAttribute("cy",String(infoObject.cy));radialGradient.setAttribute("r",String(infoObject.r));radialGradient.setAttribute("gradientUnits","userSpaceOnUse");radialGradient.setAttribute("fx",String(infoObject.fx));radialGradient.setAttribute("fy",String(infoObject.fy));var startStopRatio=infoObject.startStop||0;colorsStop=this.hCreateLinearGradientStop(startStopRatio,fillGradient.startGraphColor,ipFill.mAlpha/255);radialGradient.appendChild(colorsStop);colorsStop=this.hCreateLinearGradientStop(1,fillGradient.endGraphColor,ipFill.mAlpha/255);radialGradient.appendChild(colorsStop);this.mDefs.appendChild(radialGradient);this.mStyle.fill="url(#"+this.gradPrefix+(this.mGradientCount++)+")";break;case $GT.DssGraphGradientRectangular:break;}},hCreateLinearGradientStop:function hCreateLinearGradientStop(iOffset,iColor,iOpacity){var stop=document.createElementNS(this.mXMLNS,"stop"),lStyleStr="stop-color:"+this.hToCSSColorStr(iColor)+";stop-opacity:"+iOpacity;stop.setAttribute("offset",iOffset*100+"%");stop.setAttribute("style",lStyleStr);return stop;},FillEdgeType:function FillEdgeType(ipFill,irPolygon){},FillRadientGradient:function FillRadientGradient(ipFill,iRGUsage,iCPX,iCPY,iInnerRadius,iOuterRadius,iHasExtraPara,iExtraDepth,iExtraIntensity){},FillBorderMetallic:function FillBorderMetallic(ipFill,iBorderUse,iCPX,iCPY,iRadius,iThickness){},FillDonutOrSphere:function FillDonutOrSphere(ipFill,irBoundingRect,iIsCircularShape){},MakeDarker:function MakeDarker(ipFill,iFactor){},RestoreColor:function RestoreColor(ipFill){},ApplyLineFormat:function ApplyLineFormat(ipLine){var gradient=ipLine.getGradient();if(gradient&&gradient.valid&&gradient.style===1){this.StrokeGradient(gradient);applyStrokePattern.call(this,gradient.strokePatten,ipLine.mLineThickness);}else{var myStyle=this.mStyle;myStyle.stroke=this.hToCSSColorStr(ipLine.mLineColor);applyStrokePattern.call(this,ipLine.mLineStyle,ipLine.mLineThickness);}this.mStyle["stroke-opacity"]=ipLine.mAlpha/255;},StrokeGradient:function StrokeGradient(gradient){var linearGradient=document.createElementNS(this.mXMLNS,"linearGradient");linearGradient.setAttribute("id",String(this.gradPrefix+(this.mGradientCount)));linearGradient.setAttribute("x1","0%");linearGradient.setAttribute("y1","0%");if(gradient.angle===0){linearGradient.setAttribute("x2","100%");linearGradient.setAttribute("y2","0%");}else{linearGradient.setAttribute("x2","0%");linearGradient.setAttribute("y2","100%");}var i,firstColor=gradient.colors[0].Color,endColor=gradient.colors[gradient.colors.length-1].Color,colorStop=this.hCreateLinearGradientStop(0,firstColor,gradient.endAlpha/255);linearGradient.appendChild(colorStop);for(i=1;i<gradient.colors.length-1;++i){var interColor=gradient.colors[i];colorStop=this.hCreateLinearGradientStop(interColor.Step,interColor.Color,gradient.endAlpha/255);linearGradient.appendChild(colorStop);}colorStop=this.hCreateLinearGradientStop(1,endColor,gradient.endAlpha/255);linearGradient.appendChild(colorStop);this.mDefs.appendChild(linearGradient);this.mStyle.stroke="url(#"+this.gradPrefix+(this.mGradientCount++)+")";},AddFormatedText:function AddFormatedText(ipFont,irStartPoint,irText,props){var oneElement={Type:"text",Tag:"tspan",Attributes:{x:irStartPoint.x,y:irStartPoint.y},Content:irText};if(props&&props.BaselineOffset){oneElement.Attributes.y-=props.BaselineOffset-0.5;oneElement.Style="dominant-baseline:central";}this.mElements.push(oneElement);},ApplyBeveledFrameToRectangle:function ApplyBeveledFrameToRectangle(irRect,iRotationAngle,iBevelDepth,irLTColor,iLTAlpha,irRBColor,iRBAlpha){},DrawGaugeMarker:function DrawGaugeMarker(iBasePoint,iMarkerSize,iMarkerShape,iAngle,iNeedSize){},ApplyDonutToRect:function ApplyDonutToRect(irStartPoint,irEndPoint,ipFill){},BeginFirstFrame:function BeginFirstFrame(){},BeginLastFrame:function BeginLastFrame(){},EndFrame:function EndFrame(){},EndUnit:function EndUnit(){},hToCSSColorStr:function hToCSSColorStr(iColor){var reverseRGB=true;if(typeof iColor==="number"){if(reverseRGB){kCssColorResult.mR=iColor&255;kCssColorResult.mG=(iColor&65280)>>8;kCssColorResult.mB=(iColor&16711680)>>16;}else{kCssColorResult.mB=iColor&255;kCssColorResult.mG=(iColor&65280)>>8;kCssColorResult.mR=(iColor&16711680)>>16;}}else{return"rgb("+iColor.mR+","+iColor.mG+","+iColor.mB+")";}return"rgb("+kCssColorResult.mR+","+kCssColorResult.mG+","+kCssColorResult.mB+")";},hToCSSStyleStr:function hToCSSStyleStr(){var p,style=this.mStyle,lStyleStr="";for(p in style){if(style.hasOwnProperty(p)){lStyleStr=lStyleStr+p+":"+style[p]+";";}}return lStyleStr.substr(0,lStyleStr.length-1);},hCopyAttribute:function hCopyAttribute(iSrc,iDest){var p;for(p in iSrc){if(iSrc.hasOwnProperty(p)){iDest.setAttribute(p,iSrc[p]);}}},hResetStyle:function hResetStyle(){this.mStyle={};},hResetElements:function hResetElements(){this.mElements=[];},hResetAttribute:function hResetAttribute(){this.mAttributes={};this.mMarkerAttributes={};},hResetStyleAndAttribute:function hResetStyleAndAttribute(){this.hResetStyle();this.hResetAttribute();},hReset:function hReset(){this.hResetStyle();this.hResetAttribute();this.hResetElements();},hTranslateMarkerShape:function(markerType,chartType){var rtn="";markerType=markerType||0;switch(markerType){case -2:rtn="markerRect";break;case -1:rtn="markerCircle";break;case 0:if(chartType===1){rtn="area";}else{if(chartType===2){rtn="bar";}else{if(chartType===3){rtn="line";}}}break;case 4:rtn="circle";break;case 24:rtn="square";break;case 200:rtn="ticker";break;case 201:rtn="pie";break;case 202:rtn="ring";break;case 204:rtn="line";break;case 205:rtn="bar";break;case 206:rtn="area";break;default:break;}return rtn;},hSetExtraAttributes:function(shape,chartInfo,shapeName){var className="",shapeType="shape",shapeSubType="",chartType=chartInfo.tp,index=0,ceMarkerShape=chartInfo.currentMarkerShape,key=shapeName||(this.hTranslateMarkerShape(ceMarkerShape,chartType)||"bar"),hasSizeBy=chartInfo.hasSizeBy;if(key==="line"&&hasSizeBy){key+="-sizeby";}if(chartType===4||chartType===5){index=1;}else{if(chartType===7){index=2;}}if(SHAPE_CLASS_TABLE.hasOwnProperty(key)){className=SHAPE_CLASS_TABLE[key][index];}if(SHAPE_SUBTYPE_TABLE.hasOwnProperty(key)){shapeSubType=SHAPE_SUBTYPE_TABLE[key][index];}shape.setAttribute("class",className);shape.setAttribute("type",shapeType);shape.setAttribute("subtype",shapeSubType);},ApplyFontFormat:function ApplyFontFormat(formatFont){var myStyle=this.mStyle,fontStyle=formatFont.mFontStyle;if(fontStyle!==undefined){var FS_NORMAL=0,FS_BOLD=1,FS_ITALIC=2,FS_BOTH=3,FS_UNDERLINE=4,FS_STRIKETHROUGH=8;myStyle["text-decoration"]="none";myStyle["font-weight"]="normal";if(!!(fontStyle&FS_BOLD)){myStyle["font-weight"]="bold";}if(!!(fontStyle&FS_ITALIC)){myStyle["font-style"]="italic";}if(!!(fontStyle&FS_UNDERLINE)&&!!(fontStyle&FS_STRIKETHROUGH)){myStyle["text-decoration"]="underline line-through";}else{if(!!(fontStyle&FS_UNDERLINE)){myStyle["text-decoration"]="underline";}if(!!(fontStyle&FS_STRIKETHROUGH)){myStyle["text-decoration"]="line-through";}}}if(formatFont.mFontAlignment){var FA_LEFT=0,FA_CENTER=1,FA_RIGHT=2;switch(formatFont.mFontAlignment){case FA_LEFT:myStyle["text-anchor"]="start";break;case FA_CENTER:myStyle["text-anchor"]="middle";break;case FA_RIGHT:myStyle["text-anchor"]="right";break;}}myStyle["text-anchor"]="start";if(formatFont.mFontColor){myStyle.fill=this.hToCSSColorStr(formatFont.mFontColor);}if($Utility.isValidNumber(formatFont.mStrokeColor)){myStyle.stroke=this.hToCSSColorStr(formatFont.mStrokeColor);}if(formatFont.mStrokeWidth){myStyle["stroke-width"]=formatFont.mStrokeWidth;}if(formatFont.mFontAlpha){myStyle["fill-opacity"]=formatFont.mFontAlpha;}if(formatFont.mFontName){myStyle["font-family"]=formatFont.mFontName;}if(formatFont.mFontSize){myStyle["font-size"]=formatFont.mFontSize+"pt";}}});}());
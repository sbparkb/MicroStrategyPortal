(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");mstrmojo.requiresClsP("mstrmojo.chart","TripleId","Rect2D","GenericContext","GraphObjectManager","ChartManager","Point2D","NumberObject","ChartAdvFormat");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumGraphMajorType","EnumNumberCategory","EnumLabelLevelOption","EnumImageUsage","EnumAxisDirection","EnumGraphMatrixMajorGraphType","EnumAxisLabelsLocation","EnumGraphMatrixMarkerTypeInChart","EnumFontRotation","EnumRectCompare");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphType","EnumDSSGraphProperty","EnumDSSGraphObject","EnumVariantBool","EnumDSSExtraGraphProperty","EnumDSSGraphFillEffect","EnumDSSGraphStockLayout");mstrmojo.requiresCls("mstrmojo.chart.common.Utility");var $C=mstrmojo.chart,$CHART_ENUMS=$C.enums,$GMT=$CHART_ENUMS.EnumGraphMajorType,$GM_MGT=$CHART_ENUMS.EnumGraphMatrixMajorGraphType,$AXIS_DIRECTION=$CHART_ENUMS.EnumAxisDirection,$AXIS_LABEL_LOC=$CHART_ENUMS.EnumAxisLabelsLocation,$GM_MT=$CHART_ENUMS.EnumGraphMatrixMajorGraphType,$FR=$CHART_ENUMS.EnumFontRotation,$GM_MarkerStyle=$CHART_ENUMS.EnumGraphMatrixMarkerTypeInChart,$REC_CMP=$CHART_ENUMS.EnumRectCompare,$IMG_USAGE=$CHART_ENUMS.EnumImageUsage,$HASH=mstrmojo.hash,$NULL_ID=$C.gNullTripleId,$M=mstrmojo.chart.model,$MODEL_ENUMS=$M.enums,$GT=$MODEL_ENUMS.EnumDSSGraphType,$GP=$MODEL_ENUMS.EnumDSSGraphProperty,$GO=$MODEL_ENUMS.EnumDSSGraphObject,$VB=$MODEL_ENUMS.EnumVariantBool,$VF=$VB.VARIANT_FALSE,$EGP=$MODEL_ENUMS.EnumDSSExtraGraphProperty,$UTILITY=mstrmojo.chart.common.Utility,$Utility_Id=$UTILITY.tripleId;var GOU_NORMAL_HIGHLIGHT=0,INT_MAX=2147483647,kVisualHidden=0,kVisualFullyDisplayed=2,kDefaultUniformAxisMargin=0;var perfPlotArea=new $C.Rect2D();var axisTripleId=new $C.TripleId();var axisNumberFormat=new $C.ChartAdvFormat();var perfMinSpaceNumericAxis=20;function getAxisIntegrity(axisKey){var kIntegrityAxisBody=1,kIntegrityAxisMajorTick=2,kIntegrityAxisLabel=4,kIntegrityAxisMinorTick=8;var showHide=this.mDatasetPtr.showHideItemsOnAxis(axisKey),integrity=0;if(showHide.axisLabels){integrity=integrity|kIntegrityAxisLabel;}if(showHide.majorGrids){integrity=integrity|kIntegrityAxisMajorTick;}if(showHide.minorGrids){integrity=integrity|kIntegrityAxisMinorTick;}if(showHide.axisBody){integrity=integrity|kIntegrityAxisBody;}return integrity;}function getCategoricalAxisTrims(isX){var trims={HighTrim:0,LowTrim:0,isCaTrim:true};if(this.mUniformAxisPtr){var axisInfo,chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext(),uaCA=uaCtx.CategoryAxis;axisInfo=isX?uaCA.X:uaCA.Y;trims.HighTrim=axisInfo.Trims[1];trims.LowTrim=axisInfo.Trims[0];}return trims;}function getNumericalAxisTrims(){var trims={PrimaryHighTrim:0,PrimaryLowTrim:0,SecondaryHighTrim:0,SecondaryLowTrim:0};if(this.mUniformAxisPtr){var axisInfo,axis=this.mUniformAxisPtr,chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext(),uaVA=uaCtx.ValueAxis;switch(axis.Key){case"x2":case"X2":axisInfo=uaVA.X2;trims.SecondaryLowTrim=axisInfo.Trims[0];trims.SecondaryHighTrim=axisInfo.Trims[1];break;case"y2":case"Y2":axisInfo=uaVA.Y2;trims.SecondaryLowTrim=axisInfo.Trims[0];trims.SecondaryHighTrim=axisInfo.Trims[1];break;case"x":case"x1":case"X":case"X1":axisInfo=uaVA.X1;trims.PrimaryLowTrim=axisInfo.Trims[0];trims.PrimaryHighTrim=axisInfo.Trims[1];break;default:axisInfo=uaVA.Y1;trims.PrimaryLowTrim=axisInfo.Trims[0];trims.PrimaryHighTrim=axisInfo.Trims[1];break;}}return trims;}function configureGraphMatrixContext(props){var gmCtx=this.mChartContextPtr.GetGraphMatrixContext(),markerShape=props.ShapeType||gmCtx.mMarkerShape;gmCtx.mGraphType=this.mGraphType;gmCtx.updateGMGraphTypeWithMarkerShape(markerShape);if(props.DataAreaPaddings){gmCtx.UpdateValueAxisPadding(props.DataAreaPaddings);}if(props.ColorBy){var colorByInfo=props.ColorBy;gmCtx.mHasColorBy=colorByInfo.HasColorBy||false;}if(props.SizeBy){var sizeByInfo=props.SizeBy;gmCtx.mHasSizeBy=sizeByInfo.HasSizeBy||gmCtx.mHasSizeBy;gmCtx.mMaxSizeVal=sizeByInfo.Max||gmCtx.mMaxSizeVal;gmCtx.mMinSizeVal=sizeByInfo.Min||gmCtx.mMinSizeVal;gmCtx.mCustomScaleForSizeBy=sizeByInfo.mCustomScaleForSizeBy||sizeByInfo.CustomScaleForSizeBy;}var chartCtx=this.mChartContextPtr,graphMajorType=chartCtx.GetGraphMajorType();gmCtx.mHasSizeBy=(graphMajorType===$GMT.GMT_BUBBLE)||gmCtx.mHasSizeBy;var x1=1,y1=2,y2=4,x2=8;gmCtx.AxisLayout=props.AxisLayout||(x1|y1);if(props.ElementInfo){var thisMax=gmCtx.mElementsInfo.Max,thisMin=gmCtx.mElementsInfo.Min,elementInfo=props.ElementInfo;if(elementInfo.Max){var max=elementInfo.Max;thisMax.Mode=max.Mode||thisMax.Mode;thisMax.Size=max.Size||thisMax.Size;}if(elementInfo.Min){var min=elementInfo.Min;thisMin.Mode=min.Mode||thisMin.Mode;thisMin.Size=min.Size||thisMin.Size;}}}function configureUniformAxisContext(props){var chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext();if(props.UniformAxisPaddings){var axisPaddings=props.UniformAxisPaddings;this.UpdateUniformAxisMargins(axisPaddings);if(chartCtx.IsGridChart()===false){var uaVA=uaCtx.ValueAxis,x1=uaVA.X1,x2=uaVA.X2,y1=uaVA.Y1,y2=uaVA.Y2;y2.Trims[1]=axisPaddings.ySecondaryHighTrim;x2.Trims[1]=axisPaddings.xSecondaryHighTrim;y2.Trims[0]=axisPaddings.ySecondaryLowTrim;x2.Trims[0]=axisPaddings.xSecondaryLowTrim;y1.Trims[1]=axisPaddings.yPrimaryHighTrim;x1.Trims[1]=axisPaddings.xPrimaryHighTrim;y1.Trims[0]=axisPaddings.yPrimaryLowTrim;x1.Trims[0]=axisPaddings.xPrimaryLowTrim;x2.perCell=axisPaddings.x2PerCell;y2.PerCell=axisPaddings.y2PerCell;y1.PerCell=axisPaddings.yPerCell;x1.PerCell=axisPaddings.xPerCell;}if(chartCtx.IsBubbleChart()===false&&chartCtx.IsScatterChart()===false){var caVA=uaCtx.CategoryAxis,xAxis=caVA.X,yAxis=caVA.Y;xAxis.Trims[0]=axisPaddings.xCaLowTrim;xAxis.Trims[1]=axisPaddings.xCaHighTrim;yAxis.Trims[0]=axisPaddings.yCaLowTrim;yAxis.Trims[1]=axisPaddings.yCaHighTrim;}}uaCtx.mIsAxisTitleAndLabelRequired=false;}function hIsValueAxisByObjectId(objectId){switch(objectId){case $GO.DssGraphY1Body:case $GO.DssGraphY2Body:case $GO.DssGraphY3Body:case $GO.DssGraphY4Body:case $GO.DssGraphX1Body:case $GO.DssGraphX2Body:return true;}return false;}function hIsXAxisValueAxis(){var graphType=this.mChartContextPtr.mGraphType;switch(graphType){case $GT.DssGraphTypeX_Y_Scatter:case $GT.DssGraphTypeDualAxis_X_Y_Scatter:case $GT.DssGraphTypeX_Y_Scatter_with_Labels:case $GT.DssGraphTypeDualAxis_X_Y_Scatter_with_Labels:case $GT.DssGraphTypeBubble:case $GT.DssGraphTypeBubble_DualAxis:case $GT.DssGraphTypeBubble_With_Labels:case $GT.DssGraphTypeBubble_DualAxis_With_Labels:case $GT.DssGraphTypeHorizontal_Line_Absolute:case $GT.DssGraphTypeHorizontal_Line_Stacked:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Line_Percent:case $GT.DssGraphTypeHorizontal_Bar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_Percent:case $GT.DssGraphTypeHorizontal_Bar_Absolute:case $GT.DssGraphTypeHorizontal_Area_Absolute:case $GT.DssGraphTypeHorizontal_Area_Stacked:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Area_Percent:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent:return true;default:return false;}}function hIsYAxisCategoryAxis(){switch(this.mChartContextPtr.mGraphType){case $GT.DssGraphTypeHorizontal_Line_Absolute:case $GT.DssGraphTypeHorizontal_Line_Stacked:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Line_Percent:case $GT.DssGraphTypeHorizontal_Bar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_Percent:case $GT.DssGraphTypeHorizontal_Bar_Absolute:case $GT.DssGraphTypeHorizontal_Area_Absolute:case $GT.DssGraphTypeHorizontal_Area_Stacked:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Area_Percent:case $GT.DssGraphTypeGridChart:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent:return true;default:return false;}}function getAxisType(isX,isPrimary){if(isX){return hIsXAxisValueAxis.call(this)?1:0;}return hIsYAxisCategoryAxis.call(this)?0:1;}function hUpdateMargins(uaCtx,plotArea,axisLength,maxLabelLength,isX,isPrimary){uaCtx.mDataAreaBottomMargin=uaCtx.mDataAreaTopMargin=uaCtx.mDataAreaRightMargin=uaCtx.mDataAreaLeftMargin=0;return ;var low,high;if(isX){if(maxLabelLength>=0){uaCtx.mDataAreaLeftMargin=plotArea.x;}else{if(uaCtx.mDataAreaLeftMargin<plotArea.x){uaCtx.mDataAreaLeftMargin=plotArea.x;}}uaCtx.mDataAreaRightMargin=axisLength-(plotArea.x+plotArea.width);uaCtx.mDataAreaLeftMargin=Math.max(0,uaCtx.mDataAreaLeftMargin);uaCtx.mDataAreaRightMargin=Math.max(0,uaCtx.mDataAreaRightMargin);low=uaCtx.mDataAreaLeftMargin;high=uaCtx.mDataAreaRightMargin;}else{uaCtx.mDataAreaTopMargin=plotArea.y;uaCtx.mDataAreaBottomMargin=axisLength-(plotArea.y+plotArea.height);if(uaCtx.mDataAreaBottomMargin<0){uaCtx.mDataAreaBottomMargin=0;}uaCtx.mDataAreaTopMargin=Math.max(0,uaCtx.mDataAreaTopMargin);uaCtx.mDataAreaBottomMargin=Math.max(0,uaCtx.mDataAreaBottomMargin);low=uaCtx.mDataAreaBottomMargin;high=uaCtx.mDataAreaTopMargin;}}function hCheckSecondaryAxis(){var axis,chartCtx=this.mChartContextPtr;if(chartCtx.mIsGraphMatrix){var uaCtx=chartCtx.getUniformAxisContext();axis=uaCtx.ValueAxis.Y2;return axis.Metrics.length>0;}return chartCtx.IsDualAxis();}function isAxisValid(isX,isPrimary){if(getAxisType.call(this,isX,isPrimary)===0){return true;}var chartCtx=this.mChartContextPtr,axisKey=chartCtx.getValueAxisKeyFromLayout(isX,isPrimary),uaVaCtx=chartCtx.getUniformAxisContext().ValueAxis;return uaVaCtx[axisKey].Metrics.length>0;}function hLoadProperties(){var chartCtx=this.mChartContextPtr,value;if(chartCtx.mIsGraphMatrix){chartCtx.mAbsoluteFontLineSize=true;chartCtx.mManualLayoutMode=false;this.mFontAntiAlias=true;chartCtx.mIsFontAntiAlias=this.mFontAntiAlias;return ;}if(!chartCtx.mIsTimeSeriesChart){value=chartCtx.GetProperty($GP.DssGraphLockFontSize,$NULL_ID);if(value){chartCtx.mAbsoluteFontLineSize=(value!==$VF);}else{chartCtx.mAbsoluteFontLineSize=true;}value=chartCtx.GetProperty($GP.DssGraphSeriesByColumn,$NULL_ID);if(value){this.mDatasetPtr.mSeriesByColumn=(value!==$VF);}else{this.mDatasetPtr.mSeriesByColumn=true;}}value=chartCtx.GetProperty($GP.DssGraphAutoArrange,$NULL_ID);if(value){chartCtx.mManualLayoutMode=(value===$VF);if(value===$VF){value=chartCtx.GetProperty($EGP.DssGraphInfoRecalculateChartFrame,$NULL_ID);if(value){chartCtx.mRecalculateFrame=(value!==$VF);}else{chartCtx.mRecalculateFrame=false;}}}else{chartCtx.mManualLayoutMode=false;}value=chartCtx.GetProperty($GP.DssGraphFontAntiAlias,$NULL_ID);if(value){this.mFontAntiAlias=value;}else{this.mFontAntiAlias=true;}chartCtx.SetFontAntiAlias(this.mFontAntiAlias);}function hPrepareToLayoutUniformAxis(isX,maxLabelLength,isPrimary,props){maxLabelLength=(maxLabelLength!==undefined)?maxLabelLength:-1;isPrimary=(isPrimary!==undefined)?isPrimary:true;this.mAxisLayoutHighPadding=0;this.mAxisLayoutLowPadding=0;if(isAxisValid.call(this,isX,isPrimary)===false){props.CanSkip=true;return ;}var chartCtx=this.mChartContextPtr;props.IsPrimary=isPrimary;props.MaxLabelLength=maxLabelLength;var uaCtx=chartCtx.getUniformAxisContext();uaCtx.mIsAxisTitleAndLabelRequired=true;chartCtx.mIsEntireChart=false;hLoadProperties.call(this);if(isAxisValid.call(this,isX,isPrimary)===false){props.CanSkip=true;}}function hUpdateAxisLayoutPadding(){this.mAxisLayoutHighPadding=this.mUniformAxisPtr.mHighTrim||0;this.mAxisLayoutLowPadding=this.mUniformAxisPtr.mLowTrim||0;}function hPrepareToDrawUniformAxis(isX,width,height,isPrimary,props){if(this.mVisualMode===kVisualHidden){props.CanSkip=true;return ;}if(isX){if(width<=perfMinSpaceNumericAxis&&hIsXAxisValueAxis.call(this)){props.CanSkip=true;return ;}}else{if(height<=perfMinSpaceNumericAxis&&hIsYAxisCategoryAxis.call(this)===false){props.CanSkip=true;return ;}}var chartCtx=this.mChartContextPtr;chartCtx.SetGraphSize(width,height);chartCtx.mIsEntireChart=false;var uaCtx=chartCtx.getUniformAxisContext();uaCtx.mIsAxisTitleAndLabelRequired=true;if(isPrimary===undefined){isPrimary=true;}props.IsPrimary=isPrimary;if(props===undefined){props={SkipLayout:false};}else{if(props&&props.SkipLayout){props.SkipLayout=props.SkipLayout&&(this.mUniformAxisPtr!==null);}else{props.SkipLayout=false;}}chartCtx.populateCanvas();}function hMapChartType(graphType,shapeType){var tickShape=200,pieShape=201,ringPieShape=202,circleShape=4,rectangleShape=1,squareShape=24,chartCtx=this.mChartContextPtr,gmCtx=chartCtx.GetGraphMatrixContext(),oldGraphType=chartCtx.mGraphType;chartCtx.mGraphType=graphType;var majorType=chartCtx.GetGraphMajorType(),isComboChart=gmCtx.isCombinationChart()||shapeType===203;if(shapeType===tickShape){if(majorType===$GMT.GMT_CATEGORY){if(chartCtx.IsBarChart()){switch(graphType){case $GT.DssGraphTypeVertical_Bar_Absolute:case $GT.DssGraphTypeVertical_Bar_Side_by_Side:graphType=$GT.DssGraphTypeVertical_Line_Absolute;break;case $GT.DssGraphTypeVertical_Bar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_Stacked;break;case $GT.DssGraphTypeVertical_Bar_BiPolar_Absolute:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeVertical_Bar_BiPolar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Absolute:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeVertical_Bar_Percent:graphType=$GT.DssGraphTypeVertical_Line_Percent;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Percent:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Percent;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Percent;break;case $GT.DssGraphTypeHorizontal_Bar_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_Percent;break;case $GT.DssGraphTypeHorizontal_Line_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_Percent;break;case $GT.DssGraphTypeHorizontal_Bar_Absolute:case $GT.DssGraphTypeHorizontal_Bar_Side_by_Side:graphType=$GT.DssGraphTypeHorizontal_Line_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_Stacked;break;case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked;break;}}else{if(chartCtx.IsAreaChart()){switch(graphType){case $GT.DssGraphTypeVertical_Area_Absolute:graphType=$GT.DssGraphTypeVertical_Line_Absolute;break;case $GT.DssGraphTypeVertical_Area_Stacked:graphType=$GT.DssGraphTypeVertical_Line_Stacked;break;case $GT.DssGraphTypeVertical_Area_BiPolar_Absolute:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Absolute:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeVertical_Area_Percent:graphType=$GT.DssGraphTypeVertical_Line_Percent;break;case $GT.DssGraphTypeHorizontal_Area_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_Percent;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Percent:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Percent;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Percent;break;}}}}}else{if(shapeType===pieShape||shapeType===ringPieShape){if(chartCtx.IsAreaChart()){switch(graphType){case $GT.DssGraphTypeVertical_Area_Absolute:graphType=$GT.DssGraphTypeVertical_Line_Absolute;break;case $GT.DssGraphTypeVertical_Area_Stacked:graphType=$GT.DssGraphTypeVertical_Line_Stacked;break;case $GT.DssGraphTypeVertical_Area_BiPolar_Absolute:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Absolute:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeVertical_Area_Percent:graphType=$GT.DssGraphTypeVertical_Line_Percent;break;case $GT.DssGraphTypeHorizontal_Area_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_Percent;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Percent:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Percent;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Percent;break;}}else{if(chartCtx.IsBarChart()){switch(graphType){case $GT.DssGraphTypeVertical_Bar_Absolute:case $GT.DssGraphTypeVertical_Bar_Side_by_Side:graphType=$GT.DssGraphTypeVertical_Line_Absolute;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeVertical_Bar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_Stacked;break;case $GT.DssGraphTypeVertical_Bar_BiPolar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeHorizontal_Bar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_Stacked;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeVertical_Bar_Percent:graphType=$GT.DssGraphTypeVertical_Line_Percent;break;case $GT.DssGraphTypeHorizontal_Bar_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_Percent;break;case $GT.DssGraphTypeVertical_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_BiPolar_Absolute:graphType=$GT.DssGraphTypeVertical_Bar_BiPolar_Absolute;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_DualAxis_Absolute:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_Absolute;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Percent:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Percent;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Percent;break;}}}}else{if(shapeType===circleShape||shapeType===rectangleShape||shapeType===squareShape){if(chartCtx.IsAreaChart()){switch(graphType){case $GT.DssGraphTypeVertical_Area_Absolute:graphType=$GT.DssGraphTypeVertical_Line_Absolute;break;case $GT.DssGraphTypeVertical_Area_Stacked:graphType=$GT.DssGraphTypeVertical_Line_Stacked;break;case $GT.DssGraphTypeVertical_Area_BiPolar_Absolute:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Absolute:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeVertical_Area_Percent:graphType=$GT.DssGraphTypeVertical_Line_Percent;break;case $GT.DssGraphTypeHorizontal_Area_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_Percent;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Percent:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Percent;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Percent;break;}}else{if(chartCtx.IsBarChart()){switch(graphType){case $GT.DssGraphTypeVertical_Bar_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_Absolute:graphType=$GT.DssGraphTypeVertical_Line_Absolute;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Bar_DualAxis_Side_by_Side:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeVertical_Bar_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Bar_BiPolar_Side_by_Side:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Side_by_Side:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Side_by_Side:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeVertical_Bar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_Stacked;break;case $GT.DssGraphTypeVertical_Bar_BiPolar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeHorizontal_Bar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_Stacked;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeVertical_Bar_Percent:graphType=$GT.DssGraphTypeVertical_Line_Percent;break;case $GT.DssGraphTypeHorizontal_Bar_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_Percent;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Percent:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Percent;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Percent;break;}}}}else{if(isComboChart){if(chartCtx.IsBarChart()){switch(graphType){case $GT.DssGraphTypeVertical_Bar_Absolute:case $GT.DssGraphTypeVertical_Bar_Side_by_Side:graphType=$GT.DssGraphTypeVertical_Line_Absolute;break;case $GT.DssGraphTypeVertical_Bar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_Stacked;break;case $GT.DssGraphTypeVertical_Bar_BiPolar_Absolute:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeVertical_Bar_BiPolar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_DualAxis_Absolute:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeVertical_Bar_Percent:graphType=$GT.DssGraphTypeVertical_Line_Percent;break;case $GT.DssGraphTypeHorizontal_Bar_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_Percent;break;case $GT.DssGraphTypeHorizontal_Bar_Absolute:case $GT.DssGraphTypeHorizontal_Bar_Side_by_Side:graphType=$GT.DssGraphTypeHorizontal_Line_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_Stacked;break;case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeHorizontal_Line_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_Percent;break;case $GT.DssGraphTypeVertical_Bar_DualAxis_Percent:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Percent;break;case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Percent;break;}}else{if(chartCtx.IsAreaChart()){switch(graphType){case $GT.DssGraphTypeVertical_Area_Absolute:graphType=$GT.DssGraphTypeVertical_Line_Absolute;break;case $GT.DssGraphTypeVertical_Area_Stacked:graphType=$GT.DssGraphTypeVertical_Line_Stacked;break;case $GT.DssGraphTypeVertical_Area_BiPolar_Absolute:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:graphType=$GT.DssGraphTypeVertical_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Absolute:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeVertical_Area_Percent:graphType=$GT.DssGraphTypeVertical_Line_Percent;break;case $GT.DssGraphTypeHorizontal_Area_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked;break;case $GT.DssGraphTypeHorizontal_Area_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_Percent;break;case $GT.DssGraphTypeVertical_Area_DualAxis_Percent:graphType=$GT.DssGraphTypeVertical_Line_DualAxis_Percent;break;case $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent:graphType=$GT.DssGraphTypeHorizontal_Line_DualAxis_Percent;break;}}}}}}}chartCtx.mGraphType=oldGraphType;return graphType;}function hIsSelected(seriesId,groupId,selectedSeriesAndColumns){var len=selectedSeriesAndColumns.length,i;for(i=0;i<len;++i){if(selectedSeriesAndColumns[i].si===seriesId&&selectedSeriesAndColumns[i].gi===groupId){return true;}}return false;}function hSaveImagetoObejct(width,height,rowsHaveControls,columnsHaveControls,hasMetricSelector,selectedSeriesAndColumns){var graphDesc={},chartCtx=this.mChartContextPtr,i,len;if(chartCtx.mCanvas===null){chartCtx.populateCanvas();}width=width||1014;height=height||694;graphDesc.GW=width;graphDesc.GH=height;chartCtx.SaveSurfaceToObject(graphDesc);var value=this.mChartContextPtr.GetProperty($GP.DssGraphSeriesByColumn,$NULL_ID),seriesHaveControls,groupsHaveControls;if(value&&value!==$VF){seriesHaveControls=columnsHaveControls;groupsHaveControls=rowsHaveControls;}else{seriesHaveControls=rowsHaveControls;groupsHaveControls=columnsHaveControls;}var map=[];len=map.length;if(len>0){graphDesc.Areas=[];for(i=0;i<len;++i){var area={};var tripleId=new $C.TripleId({ObjectId:map[i].GetObjectID(),SeriesId:map[i].GetSeriesID(),GroupId:map[i].GetGroupID()});if(tripleId.mObjectId!==$GO.DssGraphRiser&&tripleId.mObjectId!==$GO.DssGraphDataMarker&&tripleId.mObjectId!==$GO.DssGraphPieSlice&&tripleId.mObjectId!==$GO.DssGraphLegendMarker&&tripleId.mObjectId!==$GO.DssGraphLegendText&&tripleId.mObjectId!==$GO.DssGraph2DO1Label){continue;}if(!hIsSelected.call(this,tripleId.mSeriesId,tripleId.mGroupId,selectedSeriesAndColumns)){continue;}area.OID=tripleId.mObjectId;area.SID=tripleId.mSeriesId;area.GID=tripleId.mGroupId;area.Shape=map[i].GetShape();area.Coords=map[i].GetCoordinates();graphDesc.Areas.push(area);}}if(selectedSeriesAndColumns.length>0){len=selectedSeriesAndColumns.length;graphDesc.Selected=[];for(i=0;i!==len;++i){graphDesc.Selected.push(selectedSeriesAndColumns[i].sid);graphDesc.Selected.push(selectedSeriesAndColumns[i].gid);}}return graphDesc;}function appendAffinityInformation(graphDesc){if(graphDesc){var chartCtx=this.mChartContextPtr,chartManager=this.mChartManagerPtr;if(!(chartCtx&&chartManager&&chartCtx.mIsGraphMatrix)){return ;}if(chartCtx.mPartialRendering&&(chartCtx.IsBubbleChart()||chartCtx.IsScatterChart())){var plot=chartManager.GetGraphObjectManager($C.PlotId0),list,copy=false;if(plot&&plot.waitingList){list=plot.waitingList;if(copy){graphDesc.hiddenItems=graphDesc.hiddenItems||[];list.forEach(function(e){graphDesc.hiddenItems.push({x:e.Position.x,y:e.Position.y,shp:e.Shape,sz:e.Size,id:null});});}else{graphDesc.hiddenItems=plot.waitingList;delete plot.waitingList;}}}}}function hDrawImage(){this.mDatasetPtr.finalize();var chartMgr=this.mChartManagerPtr;chartMgr.Draw();}function hGetMarginCount(){var chartCtx=this.mChartContextPtr;if(chartCtx.GetGraphMatrixGraphMajorType()===$GM_MT._AREA&&chartCtx.IsVertical()){return 1;}return 2;}function hLayoutUniformAxis(dataArea,isCategoryAxis,axis,willReserve){if(axis===null||axis===undefined){return ;}if(willReserve){if(isCategoryAxis){axis.ResetAxisPadding();axis.SetDataset(this.mDatasetPtr);axis.AdjustTitleArea(dataArea);axis.AdjustDataArea(dataArea,kDefaultUniformAxisMargin,kDefaultUniformAxisMargin,false);}else{axis.TrimAxisPadding(dataArea);axis.ReserveTitleAndLabels(dataArea,kDefaultUniformAxisMargin,kDefaultUniformAxisMargin);axis.AdjustDeviceDataArea(dataArea,false);}}else{if(isCategoryAxis){axis.TrimAxisPadding(dataArea,false);axis.SetDeviceDataArea(dataArea);axis.ResetAxisPadding();axis.GenerateMapAndList();}else{axis.TrimAxisPadding(dataArea,false);axis.SetDeviceDataArea(dataArea);axis.AdjustDeviceDataArea(dataArea,true);axis.UpdateTitleAndLabelArea(dataArea);axis.GenerateGridLinesEx();}}}function hGetAxis(isXAxis,isUniformAxis,isPrimary){var chartCtx=this.mChartContextPtr;if(!chartCtx.mIsGraphMatrix){return null;}var axis=null;if(isUniformAxis){axis=this.mUniformAxisPtr;}else{var axisIdSet=[$GO.DssGraphO1Body,$GO.DssGraphX1Body,$GO.DssGraphY1Body,$GO.DssGraphY2Body];if(!isPrimary&&!chartCtx.IsDualAxis()){isPrimary=true;}if(chartCtx.GetGraphType()===$GT.DssGraphTypeGridChart){var axisInfo=new $C.CategoryAxisInfo(),isSeriesByCol=this.mDatasetPtr.mSeriesByColumn;if(!isXAxis){axisInfo.ToY(!isSeriesByCol);}else{axisInfo.ToX(isSeriesByCol);}$Utility_Id.reset(axisTripleId,axisInfo.mId.mObjectId,axisInfo.mId.mSeriesId,axisInfo.mId.mGroupId);}else{var lIndex;if(chartCtx.IsVertical()){lIndex=isXAxis?0:2;}else{lIndex=isXAxis?2:0;}if(!isPrimary){lIndex++;}$Utility_Id.reset(axisTripleId,axisIdSet[lIndex],0,-3);}axis=this.mChartManagerPtr.GetGraphObjectManager(axisTripleId,true);}return axis;}function hUpdateGraphMatrixCategoryAxisCross(axis){var chartCtx=this.mChartContextPtr,axisCross=false;if(chartCtx.mIsTimeSeriesChart){axisCross=true;}else{var value=chartCtx.GetProperty($GP.DssGraph2DOrdSpaceMode,$C.gNullTripleId);if(value){axisCross=value;}}var isLine,graphType=chartCtx.GetGraphType();if(graphType>=$GT.DssGraphTypeVertical_Line_Absolute&&graphType<=$GT.DssGraphTypeHorizontal_Line_Percent){isLine=true;}var groupCount=this.mDatasetPtr.GetGroupCount(),isGMLineDot=(groupCount<=1&&isLine);axis.mAxisCross=(axisCross&&isLine&&!isGMLineDot);}function hDoCondenseCheck(axisKey,valueAxisGroup,uniformAxis){var valueAxisInfo=valueAxisGroup[axisKey.toUpperCase()],condenseInfoMap=valueAxisInfo.CondenseLabel,metricInfo=uniformAxis.PrimaryMetricIndex,metricIdx=metricInfo.length>=1?metricInfo[0]:-1,condenseInfo=condenseInfoMap[metricIdx],currentStatus=uniformAxis.getCondenseStatus();if(condenseInfo!==null&&condenseInfo!==undefined){if(currentStatus!==undefined){if(currentStatus!==condenseInfo){uniformAxis.checkCondense(condenseInfo);}}}}function getUniformAxis(isX,isPrimary){isPrimary=(isPrimary!==undefined)?isPrimary:true;var key="X1",idKey="X1",uniformAxis=hGetAxis.call(this,isX,true,isPrimary),categoryAxisType=0,direction=isX?$AXIS_DIRECTION.AD_X:$AXIS_DIRECTION.AD_Y,chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext(),valueAxisGroup=uaCtx.ValueAxis;var isCategoryAxisType=getAxisType.call(this,isX,isPrimary)===categoryAxisType,axisKey,integrity,metricInfo,valueAxisInfo,currentStatus;if(uniformAxis){if(isCategoryAxisType===false){currentStatus=uniformAxis.getCondenseStatus();if(currentStatus===null){axisKey=key;hDoCondenseCheck.call(this,axisKey,valueAxisGroup,uniformAxis);}}return uniformAxis;}var kIntegrityAxisBody=1;if(isCategoryAxisType){var graphType=chartCtx.GetGraphType();if(graphType===$GT.DssGraphTypeGridChart){var isSeriesByCol=this.mDatasetPtr.mSeriesByColumn;if(isX){idKey=!isSeriesByCol?"O1":"O2";}else{idKey=isSeriesByCol?"O1":"O2";key="Y1";}}else{idKey="O1";if(!isX){key="Y1";}}if(idKey==="O1"){chartCtx.caKeyMap.c1=key;}else{chartCtx.caKeyMap.c2=key;}uniformAxis=this.mUniformAxisPtr=new $C.CategoryAxis({TripleId:chartCtx.getAxisTripleId(idKey),mChartContextPtr:this.mChartContextPtr,GraphObjectManager:this.mChartManagerPtr,AxisLabelsLocation:$AXIS_LABEL_LOC.ALL_BOTTOM,AxisDirection:direction,IsUA:true});hUpdateGraphMatrixCategoryAxisCross.call(this,uniformAxis);integrity=getAxisIntegrity.call(this,key);uniformAxis.SetIntegrity(integrity);}else{if(!isX){key="Y1";idKey="Y1";}var axisInfo=isX?valueAxisGroup.X1:valueAxisGroup.Y1;if(isPrimary===false){key=isX?"X2":"Y2";axisInfo=valueAxisGroup[key];idKey=isX?"X2":"Y2";}metricInfo=axisInfo.Metrics;uniformAxis=this.mUniformAxisPtr=new $C.ValueAxis({mChartContextPtr:this.mChartContextPtr,TripleId:chartCtx.getAxisTripleId(idKey),GraphObjectManager:this.mChartManagerPtr,Min:axisInfo.Min,Max:axisInfo.Max,LargerGridInterval:false,IsPercent:chartCtx.IsPercentChart(),AxisDirection:direction,IsShown:true,PrimaryMetricIndex:metricInfo,IsUA:true});axisKey=key;hDoCondenseCheck.call(this,axisKey,valueAxisGroup,uniformAxis);valueAxisInfo=valueAxisGroup[axisKey.toUpperCase()];if(valueAxisInfo.Valid===false){uniformAxis.SetIntegrity(kIntegrityAxisBody);}else{axisKey=key;if(axisKey==="x"){axisKey="X1";}integrity=getAxisIntegrity.call(this,axisKey);uniformAxis.SetIntegrity(integrity);}}uniformAxis.mIsUniformAxis=true;uniformAxis.Key=key;return uniformAxis;}function hUpdateTrims(isPrimary,isCategoryAxis,isXAxis,axis){var axisKey,vaAxis,caAxis,chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext();if(isCategoryAxis===false){if(isPrimary){axisKey=isXAxis?"X1":"Y1";}else{axisKey=isXAxis?"X2":"Y2";}vaAxis=uaCtx.ValueAxis[axisKey];vaAxis.Trims[0]=axis.mLowTrim||0;vaAxis.Trims[1]=axis.mHighTrim||0;}else{axisKey=isXAxis?"X":"Y";caAxis=uaCtx.CategoryAxis[axisKey];caAxis.Trims[0]=axis.mLowTrim||0;caAxis.Trims[1]=axis.mHighTrim||0;}}function hDrawUniformAxis(dataArea,isXAxis,isCategoryAxis,isPrimary){if(isPrimary===undefined){isPrimary=true;}this.mChartContextPtr.resetCanvas();this.mDatasetPtr.finalize();var axis=getUniformAxis.call(this,isXAxis,isPrimary);axis.SetDeviceDataArea(dataArea);hLayoutUniformAxis.call(this,dataArea,isCategoryAxis,axis,false);axis.resetRestrictSpace();hUpdateTrims.call(this,isPrimary,isCategoryAxis,isXAxis,axis);var isValueAxis=getAxisType.call(this,isXAxis,isPrimary)===1;if(isValueAxis){this.mDatasetPtr.saveShownLabels(axis);}axis.Draw();}function hCreateExtremeDataLabel(metrixIndexSet,isForXAxis,isPrimary){var chartCtx=this.mChartContextPtr,dataset=chartCtx.mDataset,dataLabel,uaCtx=chartCtx.getUniformAxisContext(),valueAxisInfo=uaCtx.ValueAxis,axisKey=isForXAxis?"X":"Y",max;axisKey+=isPrimary?"1":"2";max=valueAxisInfo[axisKey].Max;var showValue=true;var isDataLabelEnabled=dataset.showDatalabels();if(isDataLabelEnabled){showValue=(dataset.dataLabelStyle===2);}var dataValue=max,finalStr,textCollection=null;if(showValue){axisNumberFormat.restore();this.mDatasetPtr.getValueAxisNumberFormat(axisNumberFormat,metrixIndexSet);var numberObjectPtr=new $C.NumberObject({TripleId:new $C.TripleId({ObjectId:$GO.DssGraphDataText}),GraphObjectManager:this.mUniformAxisPtr,Number:dataValue,NumberFormat:axisNumberFormat,GraphCollectionObject:textCollection,Locale:0,clientDrag:false,DataSet:null,IsFinal:false,ColumnOffset:0});if(numberObjectPtr){finalStr=numberObjectPtr.mText;}dataLabel=numberObjectPtr;}else{finalStr=dataset.GetTextLabel(0,0);dataLabel=new $C.TextObject({TripleId:new $C.TripleId({ObjectId:$GO.DssGraphDataText}),GraphObjectManager:this.mUniformAxisPtr,GraphCollectionObject:textCollection});}if(dataLabel){dataLabel.SetText(finalStr);}return dataLabel;}function hAdjustAxisPadding(rect,metricIndexSet,axisLength,isX,isPrimary){var chartCtx=this.mChartContextPtr,dataset=this.mDatasetPtr,value,uaCtx=chartCtx.getUniformAxisContext(),uniformAxis=this.mUniformAxisPtr,plotArea=new $C.Rect2D(),hasAdjusted=false,max,textRect,padding,maxTick,minTick,highestPos,lowestPos,highPos,highPosAfter,ratio,extraPadding,dataLabel,isMeaningfulAdjust;plotArea.ResetRect(rect);value=chartCtx.GetProperty($EGP.DSSGraphMatrixDataLabelRotated,$C.gNullTripleId);var isDataLabelEnabled=dataset.showDatalabels();if(isDataLabelEnabled&&chartCtx.IsBarChart()&&value!==null){var shouldRotatedDataLabel=value,valueAxisInfo=uaCtx.ValueAxis,axisKey=isX?"X":"Y";axisKey+=isPrimary?"1":"2";max=valueAxisInfo[axisKey].Max;dataLabel=hCreateExtremeDataLabel.call(this,metricIndexSet,isX,isPrimary);if(isX){dataLabel.GetFormatFont().mFontRotation=$FR.FR_NORMAL;}else{if(shouldRotatedDataLabel){dataLabel.GetFormatFont().mFontRotation=$FR.FR_90;}else{dataLabel.GetFormatFont().mFontRotation=$FR.FR_NORMAL;}}textRect=dataLabel.GetBoundingRect();padding=5;maxTick=uniformAxis.GetMaxTick();minTick=uniformAxis.GetMinTick();highestPos=uniformAxis.GetPositionByValue(maxTick);lowestPos=uniformAxis.GetPositionByValue(minTick);highPos=uniformAxis.GetPositionByValue(max);if(isX){if(axisLength-highPos<padding*2+textRect.width){highPosAfter=axisLength-(padding*2+textRect.width);ratio=(maxTick-minTick)/(max-minTick);extraPadding=highestPos-lowestPos-ratio*(highPosAfter-lowestPos);extraPadding+=2;var isMeaningFulAdjust=(highPosAfter>lowestPos);if(isMeaningFulAdjust&&extraPadding/(highestPos-lowestPos)<0.2){plotArea.width-=extraPadding;hasAdjusted=true;rect.ResetRect(plotArea);uniformAxis.dataLabelPadding=extraPadding;}}}else{if(max>0&&highPos<padding*2+textRect.height){highPosAfter=padding*2+textRect.height;ratio=(maxTick-minTick)/(max-minTick);extraPadding=lowestPos-highestPos-ratio*(lowestPos-highPosAfter);extraPadding+=2;isMeaningfulAdjust=(highPosAfter>highPos);if(isMeaningfulAdjust&&extraPadding/(lowestPos-highestPos)<0.2){plotArea.y+=extraPadding;plotArea.height-=extraPadding;hasAdjusted=true;rect.ResetRect(plotArea);uniformAxis.dataLabelPadding=extraPadding;}}}}return hasAdjusted;}function hAdjustingXAxisPadding(rect,metricIndexSet,xAxisLength,isPrimary){return hAdjustAxisPadding.call(this,rect,metricIndexSet,xAxisLength,true,isPrimary);var value,extraPadding=0,chartCtx=this.mChartContextPtr,dataset=chartCtx.mDataset,uaCtx=chartCtx.getUniformAxisContext(),uniformXAxis=this.mUniformAxisPtr,plotArea=new $C.Rect2D(),hasAdjusted=false;plotArea.ResetRect(rect);value=chartCtx.GetProperty($EGP.DSSGraphMatrixDataLabelRotated,$C.gNullTripleId);var isDataLabelEnabled=dataset.showDatalabels();if(isDataLabelEnabled&&chartCtx.IsBarChart()&&value!==null){var max=uaCtx.ValueAxis.X1.Max,dataLabel=hCreateExtremeDataLabel.call(this,metricIndexSet,true);if(!!dataLabel===false){return hasAdjusted;}dataLabel.GetFormatFont().mFontRotation=$FR.FR_NORMAL;var textRect=dataLabel.GetBoundingRect(),padding=5,maxTick=uniformXAxis.GetMaxTick(),minTick=uniformXAxis.GetMinTick();var highestPos,lowestPos,highPos;highestPos=uniformXAxis.GetPositionByValue(maxTick);lowestPos=uniformXAxis.GetPositionByValue(minTick);highPos=uniformXAxis.GetPositionByValue(max);if(xAxisLength-highPos<padding*2+textRect.width){var highPosAfter=xAxisLength-(padding*2+textRect.width),ratio=(maxTick-minTick)/(max-minTick);extraPadding=highestPos-lowestPos-ratio*(highPosAfter-lowestPos);extraPadding+=2;var isMeaningFulAdjust=(highPosAfter>lowestPos);if(isMeaningFulAdjust&&extraPadding/(highestPos-lowestPos)<0.2){plotArea.width-=extraPadding;hasAdjusted=true;rect.ResetRect(plotArea);uniformXAxis.dataLabelPadding=extraPadding;}}}return hasAdjusted;}function hAdjustingYAxisPadding(rect,metricIndexSet,yAxisLength,isPrimary){return hAdjustAxisPadding.call(this,rect,metricIndexSet,yAxisLength,false,isPrimary);var chartCtx=this.mChartContextPtr,dataset=this.mDatasetPtr,value,uaCtx=chartCtx.getUniformAxisContext(),uniformYAxis=this.mUniformAxisPtr,plotArea=new $C.Rect2D(),hasAdjusted=false,max,min,textRect,padding,maxTick,minTick,highestPos,lowestPos,highPos,highPosAfter,ratio,extraPadding,dataLabel,isMeaningfulAdjust;plotArea.ResetRect(rect);value=chartCtx.GetProperty($EGP.DSSGraphMatrixDataLabelRotated,$C.gNullTripleId);var isDataLabelEnabled=dataset.showDatalabels();if(isDataLabelEnabled&&chartCtx.IsBarChart()&&value!==null){var shouldRotatedDataLabel=value;max=uaCtx.ValueAxis.Y1.Max;min=uaCtx.ValueAxis.Y1.Min;dataLabel=hCreateExtremeDataLabel.call(this,metricIndexSet,false);if(shouldRotatedDataLabel){dataLabel.GetFormatFont().mFontRotation=$FR.FR_90;}else{dataLabel.GetFormatFont().mFontRotation=$FR.FR_NORMAL;}textRect=dataLabel.GetBoundingRect();padding=5;maxTick=uniformYAxis.GetMaxTick();minTick=uniformYAxis.GetMinTick();highestPos=uniformYAxis.GetPositionByValue(maxTick);lowestPos=uniformYAxis.GetPositionByValue(minTick);highPos=uniformYAxis.GetPositionByValue(max);if(max>0&&highPos<padding*2+textRect.height){highPosAfter=padding*2+textRect.height;ratio=(maxTick-minTick)/(max-minTick);extraPadding=lowestPos-highestPos-ratio*(lowestPos-highPosAfter);extraPadding+=2;isMeaningfulAdjust=(highPosAfter>highPos);if(isMeaningfulAdjust&&extraPadding/(lowestPos-highestPos)<0.2){plotArea.y+=extraPadding;plotArea.height-=extraPadding;hasAdjusted=true;rect.ResetRect(plotArea);uniformYAxis.dataLabelPadding=extraPadding;}}}return hasAdjusted;}function determineAxisResizeAction(isX,newX,newY){var keepX=false,keepY=false,result=$REC_CMP.NONE,uaCtx=this.mChartContextPtr.getUniformAxisContext(),uaSpace=this.mUniformAxisSpace;if(newX<0||newY<0){uaSpace.width=newX;uaSpace.height=newY;return result;}keepX=newX===uaSpace.width;keepY=newY===uaSpace.height;if(keepX&&keepY){result=$REC_CMP.KeepBoth;}else{if(keepX){result=newY>uaSpace.height?$REC_CMP.ExpandY:$REC_CMP.ShrinkY;}else{if(keepY){result=newX>uaSpace.width?$REC_CMP.ExpandX:$REC_CMP.ShrinkX;}else{result=$REC_CMP.NONE;if(isX){result=newX>uaSpace.width?$REC_CMP.ExpandX:$REC_CMP.ShrinkX;}else{result=newY>uaSpace.height?$REC_CMP.ExpandY:$REC_CMP.ShrinkY;}}}}uaSpace.width=newX;uaSpace.height=newY;return result;}function hPlainDraw(width,height){var chartCtx=this.mChartContextPtr;if(this.mInitialized){return false;}if(chartCtx.GetGraphMajorType()===$GMT.GMT_HISTOGRAM){this.mDatasetPtr.mIsForHistogram=true;}chartCtx.SetGraphSize(width,height);hLoadProperties.call(this);this.mChartManagerPtr=new $C.ChartManager({mTripleId:$C.ManagerId,mDatasetPtr:this.mDatasetPtr,mChartContextPtr:chartCtx});this.mChartManagerPtr.GenerateMapAndList();this.mInitialized=true;return true;}function hMinGroupCountByGraphType(graphType){switch(graphType){case $GT.DssGraphTypeVertical_Area_Absolute:case $GT.DssGraphTypeVertical_Area_Stacked:case $GT.DssGraphTypeVertical_Area_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Area_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Area_Percent:case $GT.DssGraphTypeHorizontal_Area_Absolute:case $GT.DssGraphTypeHorizontal_Area_Stacked:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Area_Percent:case $GT.DssGraphTypeD3_Connect_Group_Areas:case $GT.DssGraphTypeD3_Connect_Group_Ribbons:case $GT.DssGraphTypeD3_Connect_Series_Areas:case $GT.DssGraphTypeD3_Connect_Series_Ribbons:case $GT.DssGraphTypeD3_Surface:case $GT.DssGraphTypeD3_Surface_with_Sides:case $GT.DssGraphTypeD3_Honeycomb_Surface:return 2;default:return 1;}}function hPrepareUniformAxis(isX,isPrimary,maxLabelLength,axisLength){var xL=isX?axisLength:maxLabelLength,yL=isX?maxLabelLength:axisLength,lL=maxLabelLength,trim=true,rotated,action,axis=getUniformAxis.call(this,isX,isPrimary);action=axis.resizeAction=determineAxisResizeAction.call(this,isX,xL,yL);if(action===$REC_CMP.KeepBoth){return axis;}if(maxLabelLength>=0){axis.resetRestrictSpace(this.mUniformAxisSpace);}if(isX){rotated=this.isAxisLabelRotated(isX,isPrimary);if(rotated){if(!(action===$REC_CMP.ShrinkX||action===$REC_CMP.ShrinkY||action===$REC_CMP.ExpandY)){lL=-1;trim=false;}}else{if(axis.getLabelRotation()===$FR.FR_NORMAL&&axis.resizeAction===$REC_CMP.ExpandX){lL=axisLength;trim=false;}else{lL=-1;trim=false;}}}axis.updateMaxLabelLength(lL,trim);return axis;}function hPopulateUniformAxisSpace(){if(this.mUniformAxisSpace===null){this.mUniformAxisSpace={width:0,height:0,x:0,y:0};this.mUniformAxisSpace.width=-1;}}mstrmojo.chart.ChartImpl=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.chart.ChartImpl",mFontAntiAlias:true,mDatasetPtr:null,mFormatManager:null,mChartManagerPtr:null,mOldChartManager:null,mChartContextPtr:null,mInitialized:false,mUniformAxisSpace:null,mUniformAxisPtr:null,mVisualMode:null,init:function init(props){this._super(props);this.mDatasetPtr=this.mDatasetPtr||props.DataSet||null;this.mChartContextPtr=this.addDisposable(new $C.GenericContext(props));this.mFormatManager=this.mFormatManager||props.FormatManager||null;this.mVisualMode=kVisualFullyDisplayed;},SetData:function SetData(dataset){var dataSet=this.mDatasetPtr=dataset;this.mChartContextPtr.mDataset=dataset;dataSet.SetFormatManager(this.mFormatManager);},GetOptions:function GetOptions(objectId,seriesId,groupId,propertyId){var value,tripleId=$Utility_Id.create(objectId,seriesId,groupId);value=this.mChartContextPtr.GetProperty(propertyId,tripleId);if(value){return value;}switch(propertyId){case $GP.DssGraphAutoArrange:return{Value:this.mChartContextPtr.mManualLayoutMode,IsValid:true};case $GP.DssGraphType:case $GP.DssGraphEnhancedSeriesEffect:case $GP.DssGraphCurvedLines:case $GP.DssGraphFontAntiAlias:case $GP.DssGraphInfoSuppressLastLevel:case $GP.DssGraphInfoIncludeSubtotal:case $GP.DssGraphInfoNestedLabel:case $GP.DssGraphInfoNestedLabelBracket:case $GP.DssGraph2DSplitYAutomatic:case $GP.DssGraphAxisNumberFormat:return{Value:this.mChartContextPtr.GetProperty(propertyId,tripleId),IsValid:true};case $GP.DssGraph2ScaleDirection:if(objectId===$GP.DssGraphO1Body){return{Value:this.mDatasetPtr.mReverseGroup,IsValid:true};}break;case $GP.DssGraphSeriesByColumn:return{Value:this.mDatasetPtr.mSeriesByColumn,IsValid:true};}return{IsValid:false};},OnRectangleSelection:function OnRectangleSelection(iWindow,props){var selectedObjects=[],selectionList=[],plot,chartManager=this.mChartManagerPtr,rect=new $C.Rect2D({x:iWindow.x,y:iWindow.y,width:iWindow.w,height:iWindow.h});plot=chartManager.GetGraphObjectManager($C.PlotId0);if(!!plot===false){return selectionList;}plot.OnRectangleSelection(rect,selectionList,props.outPut);return selectionList;},SaveImageToObject:function SaveImageToObject(width,height,rowsHaveControls,columnsHaveControls,hasMetricSelector,selectedSeriesAndColumns){width=width||1014;height=height||694;hPlainDraw.call(this,width,height);hDrawImage.call(this);return hSaveImagetoObejct.call(this,width,height,rowsHaveControls,columnsHaveControls,hasMetricSelector,selectedSeriesAndColumns);},PlainDraw:function PlainDraw(iWidth,iHeight){var chartCtx=this.mChartContextPtr;iWidth=iWidth||chartCtx.mGraphWidth;iHeight=iHeight||chartCtx.mGraphHeight;return hPlainDraw.call(this,iWidth,iHeight);},GetDataGroup:function GetDataGroup(){if(this.mChartContextPtr.mIsGraphMatrix){return this.mDatasetPtr.GetDataGroup();}return 1;},setCanvasProps:function setCanvasProps(canvasProps){if(this.mChartContextPtr){this.mChartContextPtr.mCanvasInfo=$HASH.copy(canvasProps,this.mChartContextPtr.mCanvasInfo);}},SetFormatManager:function SetFormatManager(formatManager){this.mFormatManager=formatManager;this.mChartContextPtr.SetFormatManager(formatManager);this.mDatasetPtr.SetFormatManager(formatManager);},IsDataEnough:function IsDataEnough(){if(this.mChartContextPtr.mIsGraphMatrix){return true;}var groupCount,minGroupCount;groupCount=this.mDatasetPtr.GetGroupCount();minGroupCount=hMinGroupCountByGraphType.call(this,this.mChartContextPtr.mGraphType);return groupCount>=minGroupCount;},DrawUniformYAxis:function DrawUniformYAxis(width,height,isPrimary,props){var chartCtx=this.mChartContextPtr;chartCtx.startTimer({functionName:"DrawUniformYAxis",purpose:"render uniform Y axis",caller:arguments.caller||"unknown"});props=props||{};hPrepareToDrawUniformAxis.call(this,false,width,height,isPrimary,props);if(props.CanSkip){chartCtx.endTimer();return hSaveImagetoObejct.call(this,width,height,false,false,false,[]);}isPrimary=props.IsPrimary;var uaCtx=chartCtx.getUniformAxisContext();if(props.SkipLayout){this.mUniformAxisPtr.Draw();}else{if(isAxisValid.call(this,false,isPrimary)===false){chartCtx.endTimer();return hSaveImagetoObejct.call(this,width,height,false,false,false,[]);}var isCategoryAxis=hIsYAxisCategoryAxis.call(this),dataLabelPadding=Math.round(props.dataLabelPadding||0),dataAreaTop=uaCtx.mDataAreaTopMargin,dataAreaHeight=height-dataAreaTop-uaCtx.mDataAreaBottomMargin,dataArea=new $C.Rect2D({x:(isPrimary?width:0),y:dataAreaTop,width:0,height:dataAreaHeight});if(dataLabelPadding){dataArea.y=dataLabelPadding;dataArea.height-=dataLabelPadding;}hDrawUniformAxis.call(this,dataArea,false,isCategoryAxis,isPrimary);}chartCtx.endTimer();return hSaveImagetoObejct.call(this,width,height,false,false,false,[]);},DrawUniformXAxis:function DrawUniformXAxis(width,height,isPrimary,props){var chartCtx=this.mChartContextPtr;this.mChartContextPtr.startTimer({functionName:"DrawUniformXAxis",purpose:"render uniform X axis",caller:arguments.caller||"unknown"});props=props||{};hPrepareToDrawUniformAxis.call(this,true,width,height,isPrimary,props);if(props.CanSkip){chartCtx.endTimer();return hSaveImagetoObejct.call(this,width,height,false,false,false,[]);}isPrimary=props.IsPrimary;var uaCtx=chartCtx.getUniformAxisContext();if(props.SkipLayout){this.mUniformAxisPtr.Draw();}else{if(isAxisValid.call(this,true,isPrimary)===false){chartCtx.endTimer();return hSaveImagetoObejct.call(this,width,height,false,false,false,[]);}var isCategoryAxis=!hIsXAxisValueAxis.call(this),dataLabelPadding=Math.round(props.dataLabelPadding||0),dataAreaLeft=uaCtx.mDataAreaLeftMargin,dataAreaTop=0,dataAreaWidth=width-dataAreaLeft-uaCtx.mDataAreaRightMargin,dataArea=new $C.Rect2D({x:dataAreaLeft,y:(isPrimary?dataAreaTop:height),width:dataAreaWidth,height:0});if(dataLabelPadding){dataArea.width-=dataLabelPadding;}hDrawUniformAxis.call(this,dataArea,true,isCategoryAxis,isPrimary);}chartCtx.endTimer();return hSaveImagetoObejct.call(this,width,height,false,false,false,[]);},DrawDataAreaForUniformAxis:function DrawDataAreaForUniformAxis(width,height,props){this.mChartContextPtr.startTimer({functionName:"DrawDataAreaForUniformAxis",purpose:"render data area for the mini chart",caller:arguments.caller||"unknown"});if(this.mVisualMode===kVisualHidden){return hSaveImagetoObejct.call(this,width,height,false,false,false,[]);}var chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext();uaCtx.xDataLabelPadding=props.xDataLabelPadding||0;uaCtx.yDataLabelPadding=props.yDataLabelPadding||0;uaCtx.mIsAxisTitleAndLabelRequired=false;this.mInitialized=false;chartCtx.mIsEntireChart=false;this.mChartContextPtr.populateCanvas();hPlainDraw.call(this,width,height);hDrawImage.call(this);uaCtx.xDataLabelPadding=0;uaCtx.yDataLabelPadding=0;chartCtx.endTimer();var graphDesc=hSaveImagetoObejct.call(this,width,height,false,false,false,[]);appendAffinityInformation.call(this,graphDesc);return graphDesc;},GetUniformAxisMargins:function GetUniformAxisMargins(){var chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext(),result={LEFT:uaCtx.mDataAreaLeftMargin,RIGHT:uaCtx.mDataAreaRightMargin,TOP:uaCtx.mDataAreaTopMargin,BOTTOM:uaCtx.mDataAreaBottomMargin};return result;},UpdateUniformAxisMargins:function UpdateUniformAxisMargins(axisMargins){var chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext();if(axisMargins.LEFT){uaCtx.mDataAreaLeftMargin=axisMargins.LEFT;}if(axisMargins.RIGHT){uaCtx.mDataAreaRightMargin=axisMargins.RIGHT;}if(axisMargins.TOP){uaCtx.mDataAreaTopMargin=axisMargins.TOP;}if(axisMargins.BOTTOM){uaCtx.mDataAreaBottomMargin=axisMargins.BOTTOM;}},GetUniformAxisLabelsInfo:function GetUniformAxisLabelsInfo(isX,isPrimary,props){var axis=getUniformAxis.call(this,isX);if(axis){return axis.getUniformAxisLabelsInfo(props);}return[];},GetPositionAtTick:function GetPositionAtTick(tickValue,isXAxis,graphDimension){var chartCtx=this.mChartContextPtr,dataAreaLeft,dataAreaTop,dataAreaWidth,dataAreaHeight;if(!chartCtx.mIsGraphMatrix){return 0;}var uaCtx=chartCtx.getUniformAxisContext();if(!uaCtx){return 0;}var axis=this.mUniformAxisPtr;if(axis){var axisObjectId=axis.mTripleId.mObjectId;if(hIsValueAxisByObjectId.call(this,axisObjectId)){var backUpRect=axis.mDeviceDataArea;if(!axis.GetTrimWithPadding()){var rect=new $C.Rect2D();if(isXAxis){dataAreaLeft=uaCtx.mDataAreaLeftMargin;dataAreaTop=0;dataAreaWidth=graphDimension-dataAreaLeft-uaCtx.mDataAreaRightMargin;rect.Reset(dataAreaLeft,dataAreaTop,dataAreaWidth,0);}else{dataAreaLeft=0;dataAreaTop=uaCtx.mDataAreaTopMargin;dataAreaHeight=graphDimension-dataAreaTop-uaCtx.mDataAreaBottomMargin;rect.Reset(dataAreaLeft,dataAreaTop,0,dataAreaHeight);}axis.TrimAxisPadding(rect,false);axis.SetDeviceDataArea(rect);axis.SetTrimWithPadding(false);}var position=axis.GetPositionAtTick(tickValue);axis.SetDeviceDataArea(backUpRect);return position;}}return 0;},getZeroLineInfo:function getZeroLineInfo(isXAxis,isPrimary,graphDimensionSize){var info={};info.Qualified=this.IsZeroBaseLineQualified(isXAxis,isPrimary);if(info.Qualified){var axis=this.mUniformAxisPtr;if(axis===null||axis===undefined){this.mUniformAxisPtr=getUniformAxis.call(this,isXAxis,isPrimary);}info.Position=this.GetPositionAtTick(0,isXAxis,graphDimensionSize);info.Shapes=this.mDatasetPtr.GetShapesDistributionByValueAxis();}else{info.Position=-1;info.Shapes={};}return info;},IsZeroBaseLineQualified:function IsZeroBaseLineQualified(isX,isPrimary){isX=isX||false;if(isPrimary===undefined){isPrimary=true;}this.useOriginFormatForZeroLine=false;var chartCtx=this.mChartContextPtr;if(!chartCtx.mIsGraphMatrix){return false;}if(chartCtx.IsBarChart()===false&&chartCtx.IsLineChart()===false&&chartCtx.IsAreaChart()===false){return false;}var axis=this.mUniformAxisPtr;if(axis){var axisObjectId=axis.mTripleId.mObjectId;if(hIsValueAxisByObjectId.call(this,axisObjectId)){if(axis.isBaseLineQualified()){return true;}else{if(chartCtx.isCombinationChart()===false){return false;}if(axis.liftedFromZero()){var shapesDistributions=this.mDatasetPtr.GetShapesDistributionByValueAxis();var distribution=shapesDistributions.Primary;if(isPrimary&&distribution&&(distribution.BAR&&distribution.BAR.length||distribution.AREA&&distribution.AREA.length)){this.useOriginFormatForZeroLine=true;return true;}distribution=shapesDistributions.Secondary;if(!isPrimary&&distribution&&(distribution.BAR&&distribution.BAR.length||distribution.AREA&&distribution.AREA.length)){this.useOriginFormatForZeroLine=true;return true;}}}}}else{var axisKey,uaCtx=chartCtx.getUniformAxisContext();if(uaCtx.ValueAxis){if(isPrimary){axisKey=isX?"X1":"Y1";}else{axisKey=isX?"X2":"Y2";}var axisInfo=uaCtx.ValueAxis[axisKey];if(axisInfo){return axisInfo.Min<0&&axisInfo.Max>0;}}}return false;},GetAxisLabelRotation:function GetAxisLabelRotation(){if(!this.mChartContextPtr.mIsGraphMatrix){return false;}var axis=this.mUniformAxisPtr;if(axis===null){return false;}return axis.getLabelRotation();},GetShownNumericTicks:function GetShownNumericTicks(iIsForXAxis){var chartCtx=this.mChartContextPtr;if(chartCtx.mIsGraphMatrix){var gmCtx=chartCtx.GetGraphMatrixContext();return iIsForXAxis?gmCtx.mShownValueTickSet[0]:gmCtx.mShownValueTickSet[1];}},SetShowNumericTicks:function SetShowNumericTicks(irTicksSet,iIsForXAxis){var chartCtx=this.mChartContextPtr;if(chartCtx.mIsGraphMatrix){var gmCtx=chartCtx.GetGraphMatrixContext();if(iIsForXAxis){gmCtx.mShownValueTickSet[0]=irTicksSet;}else{gmCtx.mShownValueTickSet[1]=irTicksSet;}}},refreshChartComponents:function refreshChartComponents(props){var chartCtx=this.mChartContextPtr,isVertical=chartCtx.IsVertical(),isGridChart=chartCtx.IsGridChart(),isABL=chartCtx.IsBarChart()||chartCtx.IsAreaChart()||chartCtx.IsLineChart(),isScatterBubble=chartCtx.IsBubbleChart()||chartCtx.IsScatterChart();var size=props.size;if(size){chartCtx.SetGraphSize(size.w,size.h);}var dataProvider=props.dataProvider;if(dataProvider){this.mDatasetPtr.refresh(dataProvider);}var axisKey="Y1",axisId,chartManager=this.mChartManagerPtr,axis;var plotInfo=props.plot;if(plotInfo){var plotTripleId={mObjectId:20002,mSeriesId:0,mGroupId:-3};var plot=chartManager.GetGraphObjectManager(plotTripleId);if(plot){plot.refresh(props.purpose,plotInfo);}}var primaryValueAxis=props.primaryValueAxis;if(primaryValueAxis){if(isABL&&!isVertical){axisKey="X1";}axisId=chartCtx.getAxisTripleId(axisKey);axis=chartManager.GetGraphObjectManager(axisId);if(axis){axis.refresh(props.purpose,primaryValueAxis);}}axisKey="X1";var secondaryValueAxis=props.secondaryValueAxis;if(secondaryValueAxis){if(isScatterBubble){axisKey="X1";}axisId=chartCtx.getAxisTripleId(axisKey);axis=chartManager.GetGraphObjectManager(axisId);if(axis){axis.refresh(props.purpose,secondaryValueAxis);}}axisKey="O1";var primaryCategoryAxis=props.primaryCategoryAxis;if(primaryCategoryAxis){axisId=chartCtx.getAxisTripleId(axisKey);axis=chartManager.GetGraphObjectManager(axisId);if(axis){axis.refresh(props.purpose,primaryCategoryAxis);}}var secondaryCategoryAxis=props.secondaryCategoryAxis;if(secondaryCategoryAxis){}},GetDataAreaPadding:function GetDataAreaPadding(){var chartCtx=this.mChartContextPtr,gmCtx=chartCtx.GetGraphMatrixContext(),result={X1:{LowOffset:0,HighOffset:0},X2:{LowOffset:0,HighOffset:0},Y1:{LowOffset:0,HighOffset:0},Y2:{LowOffset:0,HighOffset:0}},i,j;if(!chartCtx.mIsGraphMatrix){return result;}var sumArr=function(Arr){var s=0;Arr.forEach(function(e){s+=e;});return s;};var dataset;var discreteSeries;if(gmCtx.isCombinationChart()){var allShapes=this.mDatasetPtr.GetSeriesByShape(),barCount=0,circleCount=0,squareCount=0,areaCount=0,lineCount=0;if(allShapes.Circle){circleCount=allShapes.Circle.length;}if(allShapes.Square){squareCount=allShapes.Square.length;}if(allShapes.Line){lineCount=allShapes.Line.length;}if(allShapes.Area){areaCount=allShapes.Area.length;}if(allShapes.Bar){barCount=allShapes.Bar.length;}dataset=this.mDatasetPtr;discreteSeries=dataset.GetDiscreteSeries();if(!(circleCount>0||squareCount>0||(gmCtx.mHasSizeBy&&lineCount>0)||(!gmCtx.mHasSizeBy&&(lineCount>0||areaCount>0)&&discreteSeries.length>0&&($UTILITY.HasArrayIntersection(discreteSeries,allShapes.Line)||$UTILITY.HasArrayIntersection(discreteSeries,allShapes.Area))))){return result;}if(barCount===dataset.GetSeriesCount()){return result;}}else{if(chartCtx.IsBarChart()||chartCtx.mGraphType===$GT.DssGraphTypeGridChart||(gmCtx.mMarkerShape===200&&chartCtx.IsBubbleChart()===false&&chartCtx.IsScatterChart()===false)){return result;}}var isAreaLine=chartCtx.IsAreaChart()||chartCtx.IsLineChart(),noCombination=gmCtx.isCombinationChart()===false;if(noCombination===false){noCombination=sumArr([barCount,areaCount,lineCount,squareCount,circleCount])<=1;}if(noCombination&&chartCtx.GetGraphMajorType()===$GMT.GMT_CATEGORY){var extrapadding=2;dataset=this.mDatasetPtr;discreteSeries=dataset.GetDiscreteSeries();if(gmCtx.mHasSizeBy===false&&(!(isAreaLine&&discreteSeries.length>0)||(isAreaLine&&dataset.GetGroupCount()<=1&&dataset.GetSeriesCount<=1))){var maxRadius=this.GetMaxElementRadius(chartCtx.mGraphWidth,chartCtx.mGraphHeight);if(chartCtx.IsLineChart()){maxRadius=Math.max(maxRadius,extrapadding);}result.Y1.LowOffset=result.Y1.HighOffset=result.Y2.LowOffset=result.Y2.HighOffset=maxRadius;result.X2.LowOffset=result.X2.HighOffset=maxRadius;result.X1.LowOffset=result.X1.HighOffset=maxRadius;return result;}}var uniformRadiusForScatter=true;if(uniformRadiusForScatter){if(chartCtx.IsScatterChart()){maxRadius=this.GetMaxElementRadius(chartCtx.mGraphWidth,chartCtx.mGraphHeight);result.Y1.LowOffset=result.Y1.HighOffset=result.Y2.LowOffset=result.Y2.HighOffset=maxRadius;result.X2.LowOffset=result.X2.HighOffset=maxRadius;result.X1.LowOffset=result.X1.HighOffset=maxRadius;return result;}}var uaCtx=chartCtx.getUniformAxisContext();uaCtx.mIsAxisTitleAndLabelRequired=false;chartCtx.mImageUsage=$IMG_USAGE.OBJECT_CLIP_COMPUTATION;hPlainDraw.call(this,chartCtx.mGraphWidth,chartCtx.mGraphHeight);chartCtx.mImageUsage=$IMG_USAGE.GENERAL;var tripleId=$C.PlotId0,graphObjectManager=this.mChartManagerPtr.GetGraphObjectManager(tripleId);if(!graphObjectManager){return result;}var offsetVal;for(i=0;i<2;++i){for(j=0;j<2;++j){var isX=i===0,isPrimary=j===0,clippedMarkerKey=isX?(isPrimary?"X1":"X2"):(isPrimary?"Y1":"Y2");offsetVal=graphObjectManager.GetMaxElementOffsetClippedByBoundary(isX,isPrimary);result[clippedMarkerKey].LowOffset=offsetVal.LowOffset;result[clippedMarkerKey].HighOffset=offsetVal.HighOffset;}}return result;},GetUniformYAxisWidth:function GetUniformYAxisWidth(yAxisLength,maxLabelLength,isPrimary){this.mChartContextPtr.startTimer({functionName:"GetUniformYAxisWidth",purpose:"Create uniform Y axis instance and do axis layout",caller:arguments.caller||"unknown"});hPopulateUniformAxisSpace.call(this);var props={};hPrepareToLayoutUniformAxis.call(this,false,maxLabelLength,isPrimary,props);if(props.CanSkip){return 0;}maxLabelLength=props.MaxLabelLength;isPrimary=props.IsPrimary;var chartCtx=this.mChartContextPtr,dataset=chartCtx.mDataset,uaCtx=chartCtx.getUniformAxisContext(),isCategoryAxis=hIsYAxisCategoryAxis.call(this),add,axis,result,maxAllowedLabelLength=900,initialWidth;perfPlotArea.Reset(kDefaultUniformAxisMargin,kDefaultUniformAxisMargin,yAxisLength,yAxisLength-hGetMarginCount.call(this)*kDefaultUniformAxisMargin);chartCtx.SetGraphSize(yAxisLength,yAxisLength-hGetMarginCount.call(this)*kDefaultUniformAxisMargin);axis=hPrepareUniformAxis.call(this,false,isPrimary,maxLabelLength,yAxisLength);if(axis.resizeAction===$REC_CMP.KeepBoth){return this.mUniformAxisSpace.width;}perfPlotArea.width=Math.max(perfPlotArea.width,0);perfPlotArea.height=Math.max(perfPlotArea.height,0);if(axis.restrictWidth===-1){perfPlotArea.width=Math.max(perfPlotArea.width,maxAllowedLabelLength);}else{perfPlotArea.width=Math.min(axis.restrictWidth,maxAllowedLabelLength);}initialWidth=perfPlotArea.width;hLayoutUniformAxis.call(this,perfPlotArea,isCategoryAxis,axis,true);var isDataLabelEnabled=dataset.showDatalabels();if(!isCategoryAxis&&isDataLabelEnabled){this.AdjustingAxisPaddingForDataLabel(perfPlotArea,false,yAxisLength,yAxisLength);}hUpdateMargins.call(this,uaCtx,perfPlotArea,yAxisLength,maxLabelLength,false,isPrimary);add=0;this.mUniformAxisPtr=axis;if(isPrimary){result=perfPlotArea.x+add;}else{result=initialWidth-(perfPlotArea.x+perfPlotArea.width)-kDefaultUniformAxisMargin+add;}if(this.mUniformAxisSpace.width===-1){axis.restrictWidth=this.mUniformAxisSpace.width=result;}hUpdateAxisLayoutPadding.call(this);chartCtx.endTimer();return Math.max(result,0);},GetUniformXAxisHeight:function GetUniformXAxisHeight(xAxisLength,maxLabelLength,isPrimary){this.mChartContextPtr.startTimer({functionName:"GetUniformXAxisHeight",purpose:"Create uniform X axis instance and do axis layout",caller:arguments.caller||"unknown"});hPopulateUniformAxisSpace.call(this);var props={};hPrepareToLayoutUniformAxis.call(this,true,maxLabelLength,isPrimary,props);if(props.CanSkip){return 0;}maxLabelLength=props.MaxLabelLength;isPrimary=props.IsPrimary;var chartCtx=this.mChartContextPtr,dataset=chartCtx.mDataset,uaCtx=chartCtx.getUniformAxisContext(),isCategoryAxis=!hIsXAxisValueAxis.call(this),initialHeight=400,isDataLabelEnabled,add,axis,result;perfPlotArea.Reset(0,0,xAxisLength,initialHeight);chartCtx.SetGraphSize(xAxisLength,initialHeight);axis=hPrepareUniformAxis.call(this,true,isPrimary,maxLabelLength,xAxisLength);if(axis.resizeAction===$REC_CMP.KeepBoth){return this.mUniformAxisSpace.height;}hLayoutUniformAxis.call(this,perfPlotArea,isCategoryAxis,axis,true);isDataLabelEnabled=dataset.showDatalabels();if(!isCategoryAxis&&isDataLabelEnabled){this.AdjustingAxisPaddingForDataLabel(perfPlotArea,true,xAxisLength,isPrimary);}hUpdateMargins.call(this,uaCtx,perfPlotArea,xAxisLength,maxLabelLength,true,isPrimary);add=0;this.mUniformAxisPtr=axis;if(isPrimary){result=initialHeight-(perfPlotArea.y+perfPlotArea.height)-kDefaultUniformAxisMargin+add;}else{result=perfPlotArea.y;}if(this.mUniformAxisSpace.height===-1){axis.restrictHeight=this.mUniformAxisSpace.height=result;}hUpdateAxisLayoutPadding.call(this);chartCtx.endTimer();return Math.max(result,0);},UpdatePartialRenderingWindow:function UpdatePartialRenderingWindow(enablePartial,window,flag){enablePartial=enablePartial||false;var chartCtx=this.mChartContextPtr;if(chartCtx.IsScatterChart()||chartCtx.IsBubbleChart()){chartCtx.mPartialRendering=enablePartial;}else{chartCtx.mPartialRendering=enablePartial&&(window!==undefined);if(chartCtx.mPartialRendering){chartCtx.mPartialRendering=chartCtx.mPartialRendering&&(window.x!==undefined&&window.y!==undefined&&window.width!==undefined&&window.height!==undefined);}}if(chartCtx.mPartialRendering){if(chartCtx.mRenderingWindow===null){chartCtx.mRenderingWindow={};}if(window){$HASH.copy(window,chartCtx.mRenderingWindow);}}else{chartCtx.mRenderingWindow=null;}if(flag!==undefined){if(chartCtx.mPartialRendering){this.mVisualMode=flag;}else{this.mVisualMode=kVisualFullyDisplayed;}}},updateUniformXAxisLayout:function updateUniformXAxisLayout(props){var inputXCa=props,uaCtx=this.mChartContextPtr.getUniformAxisContext(),uaXCA=uaCtx.CategoryAxis.X,CLS_NORMAL=1,CLS_STAGGER=2,CLS_SKIP=3,HORI_DROP=4;uaXCA.Layout=inputXCa.Layout;if(inputXCa.Layout===HORI_DROP){uaXCA.Layout=CLS_NORMAL;uaXCA.ForbideStagger=true;}else{if(inputXCa.Layout===CLS_SKIP){uaXCA.ForbideStagger=true;}else{uaXCA.ForbideStagger=false;}}uaXCA.StartRow=0;if(uaXCA.Layout===CLS_STAGGER){uaXCA.StartRow=inputXCa.StartRow;}if(inputXCa.LabelWidthLimit!==undefined){uaXCA.LabelWidthLimit=inputXCa.LabelWidthLimit;}uaXCA.EnforceCluster=(!!inputXCa.EnforceCluster)||uaXCA.EnforceCluster;uaXCA.EnforceFringe=(!!inputXCa.EnforceFringe)||uaXCA.EnforceFringe;},updateUniformAxisLabelRotation:function updateUniformAxisLabelRotation(autoRotation,rotateMode){if(rotateMode===undefined){rotateMode=-1;}var xLabelOptions={NORMAL:1,STAGGER:2,ROTATE:3,HORI_DROP:4};var chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext();if(rotateMode===-1){if(autoRotation===undefined){return ;}switch(autoRotation){case xLabelOptions.NORMAL:case xLabelOptions.STAGGER:uaCtx.mLabelRotation.X1=$FR.FR_AUTOMATIC;break;default:uaCtx.mLabelRotation.X1=$FR.FR_90;break;}}else{if(rotateMode===2){uaCtx.mLabelRotation.X1=$FR.FR_90;}else{uaCtx.mLabelRotation.X1=$FR.FR_NORMAL;}}},EnableUniformAxis:function EnableUniformAxis(props,extremesOnly){extremesOnly=extremesOnly||false;var chartCtx=this.mChartContextPtr,uaCtx=chartCtx.getUniformAxisContext(),uaVA=uaCtx.ValueAxis,isMinValid,isMaxValid,x1=uaVA.X1,x2=uaVA.X2,z=uaVA.Z,y1=uaVA.Y1,y2=uaVA.Y2;isMinValid=$UTILITY.isValidNumber(props.YMinValue);isMaxValid=$UTILITY.isValidNumber(props.YMaxValue);y1.Valid=isMinValid&&isMaxValid;y1.Min=parseFloat(isMinValid?props.YMinValue:0);y1.Max=parseFloat(isMaxValid?props.YMaxValue:0);y1.CustomScale=(props.YCustomScale!==undefined)?props.YCustomScale:false;y1.CondenseLabel=(props.YCondenseLabel!==undefined)?props.YCondenseLabel:{};y1.CondenseEnforced=props.YCondenseEnfored||false;y1.AutoMin=props.YAutoMin;y1.AutoMax=props.YAutoMax;isMinValid=$UTILITY.isValidNumber(props.Y2MinValue)||$UTILITY.isValidNumber(props.X2MinValue);isMaxValid=$UTILITY.isValidNumber(props.Y2MaxValue)||$UTILITY.isValidNumber(props.X2MaxValue);y2.Valid=isMinValid&&isMaxValid;y2.Min=parseFloat($UTILITY.isValidNumber(props.Y2MinValue)?props.Y2MinValue:($UTILITY.isValidNumber(props.X2MinValue)?props.X2MinValue:0));y2.Max=parseFloat($UTILITY.isValidNumber(props.Y2MaxValue)?props.Y2MaxValue:($UTILITY.isValidNumber(props.X2MaxValue)?props.X2MaxValue:0));y2.CustomScale=(props.Y2CustomScale!==undefined)?props.Y2CustomScale:((props.X2CustomScale!==undefined)?props.X2CustomScale:false);y2.CondenseLabel=(props.Y2CondenseLabel!==undefined)?props.Y2CondenseLabel:(props.X2CondenseLabel!==undefined?props.X2CondenseLabel:{});y2.CondenseEnforced=props.Y2CondenseEnfored||props.X2CondenseEnfored||false;y2.AutoMin=props.Y2AutoMin;y2.AutoMax=props.Y2AutoMax;isMinValid=$UTILITY.isValidNumber(props.XMinValue);isMaxValid=$UTILITY.isValidNumber(props.XMaxValue);x1.Valid=isMinValid&&isMaxValid;x1.Min=parseFloat(isMinValid?props.XMinValue:0);x1.Max=parseFloat(isMaxValid?props.XMaxValue:0);x1.CustomScale=(props.XCustomScale!==undefined)?props.XCustomScale:false;x1.CondenseLabel=(props.XCondenseLabel!==undefined)?props.XCondenseLabel:{};x1.CondenseEnforced=props.XCondenseEnfored||false;x1.AutoMin=props.XAutoMin;x1.AutoMax=props.XAutoMax;isMinValid=$UTILITY.isValidNumber(props.X2MinValue);isMaxValid=$UTILITY.isValidNumber(props.X2MaxValue);x2.Valid=isMinValid&&isMaxValid;x2.Min=parseFloat(isMinValid?props.X2MinValue:0);x2.Max=parseFloat(isMaxValid?props.X2MaxValue:0);x2.CustomScale=(props.X2CustomScale!==undefined)?props.X2CustomScale:false;x2.CondenseLabel=(props.X2CondenseLabel!==undefined)?props.X2CondenseLabel:{};x2.CondenseEnforced=props.X2CondenseEnfored||false;x2.AutoMin=props.X2AutoMin;x2.AutoMax=props.X2AutoMax;z.Min=parseFloat($UTILITY.isValidNumber(props.ZMinValue)?props.ZMinValue:0);z.Max=parseFloat($UTILITY.isValidNumber(props.ZMaxValue)?props.ZMaxValue:0);z.CustomScale=(props.ZCustomScale!==undefined)?props.ZCustomScale:false;z.AutoMin=props.ZAutoMin;z.AutoMax=props.ZAutoMax;uaCtx.mGraphHeight=(props.GraphHeight!==undefined)?props.GraphHeight:0;if(extremesOnly){return ;}chartCtx.mIsUniformAxisMode=true;chartCtx.mIsGraphMatrix=true;if(props.XMetrics){x1.Metrics.splice(0,x1.Metrics.length);x1.Metrics=x1.Metrics.concat(props.XMetrics);}if(props.YMetrics){y1.Metrics.splice(0,uaVA.Y1.Metrics.length);y1.Metrics=uaVA.Y1.Metrics.concat(props.YMetrics);}if(props.Y2Metrics){y2.Metrics.splice(0,y2.Metrics.length);y2.Metrics=y2.Metrics.concat(props.Y2Metrics);}if(props.X2Metrics){x2.Metrics.splice(0,x2.Metrics.length);x2.Metrics=x2.Metrics.concat(props.X2Metrics);}if(props.ZMetrics){z.Metrics.splice(0,z.Metrics.length);z.Metrics=z.Metrics.concat(props.ZMetrics);}if(props.LabelPlacement!==undefined){this.updateUniformAxisLabelRotation(props.LabelPlacement,props.xAxisRotateMode);}if(props.XCategoryAxis){var inputXCa=props.XCategoryAxis,uaXCA=uaCtx.CategoryAxis.X,CLS_SKIP=3;uaXCA.Truncation={Idices:[],Texts:[]};if(uaXCA.Layout!==CLS_SKIP){uaXCA.Truncation.Idices=props.TruncatedIdices;uaXCA.Truncation.Texts=props.TruncatedTexts;}this.updateUniformXAxisLayout(inputXCa);}if(props.YCategoryAxis){var inputYCa=props.YCategoryAxis;var uaYCA=uaCtx.CategoryAxis.Y;if(inputYCa.LabelWidthLimit!==undefined){uaYCA.LabelWidthLimit=inputYCa.LabelWidthLimit;}uaYCA.EnforceCluster=(!!inputYCa.EnforceCluster)||uaYCA.EnforceCluster;uaYCA.EnforceFringe=(!!inputYCa.EnforceFringe)||uaYCA.EnforceFringe;}if(chartCtx.IsScatterChart()||chartCtx.IsBubbleChart()){var gmCtx=chartCtx.GetGraphMatrixContext(),axisLayout=gmCtx.AxisLayout;if(axisLayout===null||axisLayout===undefined){return ;}var kX1=1,kY1=2,kY2=4,kX2=8;if(!!(axisLayout&kY2)){y1.Min=parseFloat((props.Y2MinValue!==undefined)?props.Y2MinValue:0);y1.Max=parseFloat((props.Y2MaxValue!==undefined)?props.Y2MaxValue:0);y1.CustomScale=(props.Y2CustomScale!==undefined)?props.Y2CustomScale:false;y1.CondenseLabel=(props.Y2CondenseLabel!==undefined)?props.Y2CondenseLabel:{};y1.Metrics.splice(0,y1.Metrics.length);y1.Valid=y2.Valid;if(props.Y2Metrics){y1.Metrics=y1.Metrics.concat(props.Y2Metrics);}y2.Metrics.splice(0,y2.Metrics.length);}if(!!(axisLayout&kX2)){x1.Min=parseFloat((props.X2MinValue!==undefined)?props.X2MinValue:0);x1.Max=parseFloat((props.X2MaxValue!==undefined)?props.X2MaxValue:0);x1.CustomScale=(props.X2CustomScale!==undefined)?props.X2CustomScale:false;x1.CondenseLabel=(props.X2CondenseLabel!==undefined)?props.X2CondenseLabel:{};x1.Metrics.splice(0,x1.Metrics.length);x1.Valid=y2.Valid;if(props.X2Metrics){x1.Metrics=uaVA.Y1.Metrics.concat(props.X2Metrics);}y2.Metrics.splice(0,y2.Metrics.length);}}},AdjustingAxisPaddingForDataLabel:function AdjustingAxisPaddingForDataLabel(rect,isForXAxis,axisLength,isPrimary){var chartCtx=this.mChartContextPtr,axisKey=chartCtx.getValueAxisKeyFromLayout(isForXAxis,isPrimary),axisInfo;var tripleId=chartCtx.getAxisTripleId(axisKey);axisInfo=chartCtx.getUniformAxisInformation(tripleId.mObjectId);var metricIndexList=axisInfo.Metrics||[];var value=chartCtx.GetProperty($EGP.DSSGraphMatrixUseCustomMinMax,tripleId),isCustomMinMax;if(value){isCustomMinMax=value;if(isCustomMinMax){return false;}}if(isForXAxis){return hAdjustingXAxisPadding.call(this,rect,metricIndexList,axisLength,isPrimary);}return hAdjustingYAxisPadding.call(this,rect,metricIndexList,axisLength,isPrimary);},ShouldRotateDataLabel:function ShouldRotateDataLabel(width,height){var chartCtx=this.mChartContextPtr,dataset=this.mDatasetPtr,showDataLabels=dataset.showDatalabels(),gmCtx=chartCtx.GetGraphMatrixContext();var needBuildChart=false;if(showDataLabels){needBuildChart=chartCtx.IsBarChart();if(!needBuildChart&&chartCtx.isCombinationChart()){var barShapes=dataset.GetSeriesByShape().Bar,seriesCount=dataset.GetSeriesCount();needBuildChart=(barShapes.length===seriesCount);if(!needBuildChart&&barShapes.length){needBuildChart=true;for(var i=0;i<seriesCount;i++){if(barShapes.indexOf(i)===-1&&dataset.showSeriesDatalabel(i)){needBuildChart=false;break;}}}}}if(needBuildChart){this.mInitialized=false;var uaCtx=chartCtx.getUniformAxisContext();uaCtx.mIsAxisTitleAndLabelRequired=false;chartCtx.mIsEntireChart=false;hPlainDraw.call(this,width,height);}return{Rotation:gmCtx.mIsNeedRotateDataLabel,Adjust:needBuildChart};},ShouldAdjustValueAxis:function ShouldAdjustValueAxis(width,height,adjustedValue,perfectPadding){return false;},GetMaxElementRadius:function GetMaxElementRadius(width,height,perfectPadding){var chartCtx=this.mChartContextPtr,gmCtx=chartCtx.GetGraphMatrixContext(),graphType=chartCtx.GetGraphType(),gmMajorType=chartCtx.GetGraphMatrixGraphMajorType(),groupCount=this.mDatasetPtr.GetGroupCount(),isVertical;perfectPadding=perfectPadding||false;switch(gmMajorType){case $GM_MGT._GRID:case $GM_MGT._SCATTER:case $GM_MGT._BUBBLE:return gmCtx.GetMaxMarkerSize($GM_MarkerStyle._SHAPES_IN_BUBBLESCATTER,false,groupCount,gmCtx.mHasSizeBy);case $GM_MGT._AREA:isVertical=((graphType>=$GT.DssGraphTypeVertical_Area_Absolute&&graphType<=$GT.DssGraphTypeVertical_Area_Percent));return gmCtx.GetMaxElementSizeInAreaChart(isVertical,groupCount);case $GM_MGT._LINE:isVertical=((graphType>=$GT.DssGraphTypeVertical_Line_Absolute&&graphType<=$GT.DssGraphTypeVertical_Line_Percent));if(gmCtx.isCombinationChart()){var size1=0,size2=0,DssGraphMarkerShapeNone=0,DssGraphMarkerShapeCircle=4,allShapes=this.mDatasetPtr.GetSeriesByShape();if(allShapes.Line&&allShapes.Line.length>0){size1=gmCtx.GetMaxElementSizeInLineChart(isVertical,groupCount,false,DssGraphMarkerShapeNone);}if((allShapes.Circle&&allShapes.Circle.length>0)||(allShapes.Square&&allShapes.Square.length>0)){size2=gmCtx.GetMaxElementSizeInLineChart(isVertical,groupCount,true,DssGraphMarkerShapeCircle);}return Math.max(size1,size2);}return gmCtx.GetMaxElementSizeInLineChart(isVertical,groupCount);case $GM_MGT._PIE:if(this.mDatasetPtr){groupCount*=this.mDatasetPtr.GetPieCountAtOneDataPoint(0,0);}isVertical=this.mChartContextPtr.IsVertical();return gmCtx.GetMaxMarkerSize($GM_MarkerStyle._PIE,isVertical,groupCount,gmCtx.mHasSizeBy);case $GM_MGT._BAR:return 0;default:break;}return 0;},setGraphType:function setGraphType(T){this.mGraphType=this.mChartContextPtr.mGraphType=T;},setThemeType:function setThemeType(themeType){this.mChartContextPtr.mThemeType=themeType;},getCondenseStatus:function getCondenseStatus(){var condensed,uniformAxis=this.mUniformAxisPtr;if(uniformAxis){condensed=uniformAxis.mCondenseLabels;}return condensed;},enableCondense:function enableCondense(enable,enforced){var uniformAxis=this.mUniformAxisPtr;if(uniformAxis){uniformAxis.checkCondense(enable,enforced);}},isAxisLabelRotated:function isAxisLabelRotated(isX,isPrimary){var axis=this.mUniformAxisPtr;if(axis===null){return false;}var rt=axis.getLabelRotation();return rt===$FR.FR_90;},liftedFromZero:function liftedFromZero(){if(this.mUniformAxisPtr){if(this.mMinTick!==undefined){return this.mMinTick===0&&this.mLowTrim>0;}}return false;},configureChart:function configureChart(props){var chartCtx=this.mChartContextPtr;chartCtx.mIsUniformAxisMode=true;chartCtx.mIsGraphMatrix=true;if(props.ThemeType){this.setThemeType(props.ThemeType);}if(props.Usage){chartCtx.mImageUsage=props.Usage;}if(props.Timer!==undefined){chartCtx.mUseTimer=props.Timer||false;}if(chartCtx.mImageUsage===$IMG_USAGE.BANNER){return ;}var dualAxisLayout;dualAxisLayout=props.isABL&&props.Extremes&&((props.Extremes.X2Metrics&&props.Extremes.X2Metrics.length)||(props.Extremes.Y2Metrics&&props.Extremes.Y2Metrics.length));if(props.GraphType){if(dualAxisLayout){props.GraphType=chartCtx.mapGraphTypeToDualAxis(props.GraphType);}if(props.ShapeType){this.setGraphType(hMapChartType.call(this,props.GraphType,props.ShapeType));}else{this.setGraphType(props.GraphType);}}if(props.GraphSize){chartCtx.SetGraphSize(props.GraphSize.W,props.GraphSize.H);}if(props.Extremes){this.EnableUniformAxis(props.Extremes,false);}if(props.OutputType){chartCtx.mImageFormat=props.OutputType;}configureUniformAxisContext.call(this,props);configureGraphMatrixContext.call(this,props);},resetCanvas:function resetCanvas(){var chartCtx=this.mChartContextPtr;chartCtx.resetCanvas();},updateUniformAxis:function updateUniformAxis(props){var axis=this.mUniformAxisPtr,width=axis.mDeviceDataArea.width,height=axis.mDeviceDataArea.height;if(!axis){return hSaveImagetoObejct.call(this,width,height,false,false,false,[]);}if(props.Redraw){axis.Draw();}return hSaveImagetoObejct.call(this,width,height,false,false,false,[]);},getUniformAxisBanding:function getUniformAxisBanding(){var showBandings=true,axis=this.mUniformAxisPtr;if(showBandings&&axis){return axis.getBandings();}return[];},getUniformAxisGridLinePosition:function getUniformAxisGridLinePosition(isMajorGridLine){var showBandings=true,axis=this.mUniformAxisPtr;if(showBandings&&axis){return axis.getGridLinePosition(isMajorGridLine);}return[];},echoCondenseStatus:function echoCondenseStatus(condenseStatus,index){var axis=this.mUniformAxisPtr;if(axis===null){return ;}var status=axis.getCondenseStatus();if(status!==undefined){condenseStatus[index]=status;}},echoLayoutPaddings:function echoLayoutPaddings(layoutPadding,index){var axis=this.mUniformAxisPtr;if(axis===null){return ;}layoutPadding[index]=layoutPadding[index]||{};layoutPadding[index].HighOffset=this.mAxisLayoutHighPadding||0;layoutPadding[index].LowOffset=this.mAxisLayoutLowPadding||0;},UpdateValueAxisPadding:function UpdateValueAxisPadding(paddings){var gmCtx=this.mChartContextPtr.GetGraphMatrixContext();gmCtx.UpdateValueAxisPadding(paddings);},getUniformAxisTrims:function getUniformAxisTrims(isX,isPrimary){var isCategoryAxis=(isX&&hIsXAxisValueAxis.call(this)===false)||(!isX&&hIsYAxisCategoryAxis.call(this));if(isCategoryAxis){return getCategoricalAxisTrims.call(this,isX);}else{return getNumericalAxisTrims.call(this);}},getUniformAxisFormat:function getUniformAxisFormat(){var axis=this.mUniformAxisPtr;if(!!axis){if(axis.mCondenseLabels){return"Condensed";}if(axis.mNumberFormat){return axis.mNumberFormat.mCustomFormat;}}return undefined;},formatAsUniformAxisLabel:function formatAsUniformAxisLabel(number){if(!!this.mUniformAxisPtr===false){return undefined;}return this.mUniformAxisPtr.formatAsLabel(number);},getAxisPadding:function getAxisPadding(style){var dataLabelInChart=0,axisEndTickLabels=1,others=2;if(style===dataLabelInChart){return{L:0,H:(this.mUniformAxisPtr&&this.mUniformAxisPtr.dataLabelPadding||0)};}else{if(style===axisEndTickLabels){var low=this.mAxisLayoutLowPadding||0;var high=this.mAxisLayoutHighPadding||0;return{L:low,H:high};}else{return{L:0,H:0};}}},getStatistics:function getStatistics(props){var result={},plotId,plot,list,length,kPartialRendering=0,i,j;plotId=$C.PlotId0;switch(props.Type){case kPartialRendering:var done=0,chartCtx=this.mChartContextPtr,dataset=this.mDatasetPtr;var seriesCount=dataset.GetSeriesCount(),groupCount=dataset.GetGroupCount();result.Total=seriesCount*groupCount;if(chartCtx.IsScatterChart()||chartCtx.IsBubbleChart()){plot=this.mChartManagerPtr.GetGraphObjectManager(plotId);if(plot){list=plot.mGraphObjectList;length=list.length;for(i=0;i<length;++i){if(list[i].mTripleId.mObjectId===$GO.DssGraphRiser){done++;}}result.Displayed=done;}}else{if(chartCtx.IsBarChart()||chartCtx.IsAreaChart()||chartCtx.IsLineChart()||chartCtx.IsGridChart()){if(dataset.endSeries!==-1||dataset.endGroup!==-1){var startSeries=Math.max(dataset.startSeries,0),startGroup=Math.max(dataset.startGroup,0),endSeries=dataset.endSeries===-1?seriesCount:dataset.endSeries,endGroup=dataset.endGroup===-1?groupCount:dataset.endGroup;result.Displayed=(endGroup-startGroup)*(endSeries-startSeries);}else{plot=this.mChartManagerPtr.GetGraphObjectManager(plotId);if(plot){var renderers=[plot.AreaSeriesRenderer,plot.mBarSeriesRendererPtr,plot.mLineSeriesRendererPtr];for(j=0;j<renderers.length;++j){if(renderers[j]){list=renderers[j].mGraphObjectList;length=list.length;for(i=0;i<length;++i){if(list[i].mTripleId.mObjectId===$GO.DssGraphRiser){done++;}}}}result.Displayed=done;}}}}break;default:break;}return result;}});}());
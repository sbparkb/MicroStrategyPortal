(function(){mstrmojo.requiresClsP("mstrmojo.chart","TripleId","GraphObjectManager","ShapeObject","TextObject","StraightLineObject","GraphCollectionObject","PolygonObject","PolyLineObject","GraphAxisGeneral","AxisObject","ChartConstants","Point2D");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumCollectionType","EnumGraphMajorType","EnumDSSExtraGraphObject","EnumAnchorPoint","EnumAxisLabelsLocation","EnumAxisDirection","EnumGraphObjectType");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphProperty","EnumDSSGraphObject","EnumDSSGraphTitleName","EnumDSSExtraGraphProperty","EnumDSSGraphFontRotation","EnumDSSGraphGridLineType","EnumDSSGraphAxisLabelLocation");var $C=mstrmojo.chart,$K=$C.ChartConstants,$CHART_ENUMS=$C.enums,$CT=$CHART_ENUMS.EnumCollectionType,$GMT=$CHART_ENUMS.EnumGraphMajorType,$EGO=$CHART_ENUMS.EnumDSSExtraGraphObject,$AP=$CHART_ENUMS.EnumAnchorPoint,$AXIS_LABEL_LOC=$CHART_ENUMS.EnumAxisLabelsLocation,$AXIS_DIRECTION=$CHART_ENUMS.EnumAxisDirection,$GRAPH_OBJ_TYPE=$CHART_ENUMS.EnumGraphObjectType,$NULL_GROUP_ID=$C.gNullGroupId,$NTID=$C.gNullTripleId,$NOID=$C.gNullObjectId,kAxisIndex_AI_O1=0,kAxisIndex_AI_O2=1,kAxisIndex_AI_X1=2,kAxisIndex_AI_Y1=3,kAxisIndex_AI_Y2=4,kAxisIndex_AI_Y3=5,kAxisIndex_AI_Y4=6,kAxisIndex_AI_Z=7,kAxisIndex_AI_X2=8,kTickFactor=100,kTitleMargin=2;var $M=mstrmojo.chart.model,$MODEL_ENUMS=$M.enums,$GP=$MODEL_ENUMS.EnumDSSGraphProperty,$GO=$MODEL_ENUMS.EnumDSSGraphObject,$GTN=$MODEL_ENUMS.EnumDSSGraphTitleName,$EGP=$MODEL_ENUMS.EnumDSSExtraGraphProperty,$FR=$MODEL_ENUMS.EnumDSSGraphFontRotation,$GLT=$MODEL_ENUMS.EnumDSSGraphGridLineType,$LL=$MODEL_ENUMS.EnumDSSGraphAxisLabelLocation;var kIntegrityAxisBody=1,kIntegrityAxisMajorTick=2,kIntegrityAxisLabel=4,kIntegrityAxisMinorTick=8;var perfHalfSize=null,perfGridLinePoint1=null,perfGridLinePoint2=null,firstOuterTickOffset=null,secondOuterTickOffset=null;function hUseInnerDataArea(){if(!this.mUseDepth){return ;}var deviceDataArea=this.mDeviceDataArea,depthOffset=this.mDepthOffset;deviceDataArea.x+=depthOffset.x;deviceDataArea.y+=depthOffset.y;this.mUseDepth=false;}function hMapGridOptions(grid){switch(grid.mGridStyle){case $GLT.DssGraphGridRegular:case $GLT.DssGraphGridBoth:grid.mGridStyle=$GLT.DssGraphGridRegular;break;case $GLT.DssGraphGridInnerTicks:case $GLT.DssGraphGridOuterTicks:case $GLT.DssGraphGridSpanningTicks:grid.mShowGridLines=false;break;default:grid.mGridStyle=$GLT.DssGraphGridRegular;}}function hGenerateGrids(dataArea,graphObjectList,isGridLine){var backupDepth,backupDataArea,backupShowMajor,backupShowMinor,backupMajorStyle,backupMinorStyle,backupLabelLocation,deviceDataArea=this.mDeviceDataArea,isLowArea=true,isHighArea=true;if(this.IsVerticalAxis()){isLowArea=(dataArea.x===deviceDataArea.x);isHighArea=(dataArea.x+dataArea.width===deviceDataArea.x+deviceDataArea.width);}else{isLowArea=(dataArea.y+dataArea.height===deviceDataArea.y+deviceDataArea.height);isHighArea=(dataArea.y===deviceDataArea.y);}if(isLowArea&&isHighArea){this.generateGridsByArea(isGridLine);this.MoveGraphObjectList(graphObjectList);return ;}backupDepth=this.mUseDepth;backupDataArea=deviceDataArea;backupShowMajor=this.mMajorGrid.mShowGridLines;backupShowMinor=this.mMinorGrid.mShowGridLines;backupMajorStyle=this.mMajorGrid.mGridStyle;backupMinorStyle=this.mMinorGrid.mGridStyle;backupLabelLocation=this.mAxisInfo.mAxisLabelsLocation;this.mDeviceDataArea=dataArea;if(isLowArea||isHighArea){if(isLowArea){this.mAxisInfo.mAxisLabelsLocation=this.IsVerticalAxis()?$AXIS_LABEL_LOC.ALL_LEFT:$AXIS_LABEL_LOC.ALL_BOTTOM;}else{this.mAxisInfo.mAxisLabelsLocation=this.IsVerticalAxis()?$AXIS_LABEL_LOC.ALL_RIGHT:$AXIS_LABEL_LOC.ALL_TOP;}if(!this.hasDepthAxisLine(this.mAxisInfo.mAxisLabelsLocation)){hUseInnerDataArea.call(this);}}else{hUseInnerDataArea.call(this);hMapGridOptions.call(this,this.mMajorGrid);hMapGridOptions.call(this,this.mMinorGrid);}this.generateGridsByArea(isGridLine);this.MoveGraphObjectList(graphObjectList);this.mUseDepth=backupDepth;this.mDeviceDataArea.ResetRect(backupDataArea);this.mMajorGrid.mShowGridLines=backupShowMajor;this.mMinorGrid.mShowGridLines=backupShowMinor;this.mMajorGrid.mGridStyle=backupMajorStyle;this.mMinorGrid.mGridStyle=backupMinorStyle;this.mAxisInfo.mAxisLabelsLocation=backupLabelLocation;}function hGetAxisLine(labelLocation){var deviceDataArea=this.mDeviceDataArea,start,end;switch(labelLocation){case $AXIS_LABEL_LOC.ALL_BOTTOM:start=deviceDataArea.GetBottomLeft();end=deviceDataArea.GetBottomRight();if(this.mChartContextPtr.mIsTimeSeriesChart){start.x=0;}break;case $AXIS_LABEL_LOC.ALL_TOP:start=deviceDataArea.GetTopLeft();end=deviceDataArea.GetTopRight();break;case $AXIS_LABEL_LOC.ALL_LEFT:start=deviceDataArea.GetTopLeft();end=deviceDataArea.GetBottomLeft();break;case $AXIS_LABEL_LOC.ALL_RIGHT:start=deviceDataArea.GetTopRight();end=deviceDataArea.GetBottomRight();break;default:start=null;end=null;break;}return{Start:start,End:end};}function hGenerateOneAxisLine(labelLocation){var start,end,axisLine,returnVal;if(this.mUseDepth){return ;}returnVal=hGetAxisLine.call(this,labelLocation);start=returnVal.Start;end=returnVal.End;axisLine=new $C.StraightLineObject({TripleId:this.mTripleId,GraphObjectManager:this,StartPoint:start,EndPoint:end,GraphCollectionObject:this.mpAxisLineSet});this.mManagerGraphObjectList.push(axisLine);this.mpAxisLineSet.AddGraphObject(axisLine);}function hGenerateDepthAxisLine(){var start,end,lowLocation,highLocation,polygon=[],depthAxisLine,formatFill,returnVal,tripleId;lowLocation=this.IsVerticalAxis()?$AXIS_LABEL_LOC.ALL_LEFT:$AXIS_LABEL_LOC.ALL_BOTTOM;highLocation=this.IsVerticalAxis()?$AXIS_LABEL_LOC.ALL_RIGHT:$AXIS_LABEL_LOC.ALL_TOP;if(this.hasDepthAxisLine(lowLocation)){returnVal=hGetAxisLine.call(this,lowLocation);}else{if(this.hasDepthAxisLine(highLocation)){returnVal=hGetAxisLine.call(this,highLocation);}else{return ;}}start=returnVal.Start;end=returnVal.End;polygon.push(start);polygon.push(end);polygon.push(end.Shifted(this.mDepthOffset));polygon.push(start.Shifted(this.mDepthOffset));tripleId=new $C.TripleId({ObjectId:$GO.DssGraphFrame});depthAxisLine=new $C.PolygonObject({TripleId:tripleId,GraphObjectManager:this,Polygon:polygon});depthAxisLine.mIsDetectable=false;formatFill=depthAxisLine.GetFormatFill();formatFill.MakeDarker(this.IsVerticalAxis()?0.8:0.6);this.mManagerGraphObjectList.push(depthAxisLine);}function hGetOneDepthGridLine(location,gridStyle,tickLength,feftOrBottom,rightOrTop,polyLine){var depthTickOffset,returnVal,first,second,outerTickOffset;returnVal=this.mChartContextPtr.CalculateDepthOffset(tickLength,this.mDepthDirection,true);depthTickOffset=new $C.Point2D({x:returnVal.OffsetX,y:returnVal.OffsetY});polyLine.splice(0,polyLine.length);first=new $C.Point2D();second=new $C.Point2D();first.init({Point2D:feftOrBottom});second.init({Point2D:rightOrTop});if((this.IsVerticalAxis()&&this.IsLeftDirection())||(!this.IsVerticalAxis()&&this.IsDownDirection())){first.init({Point2D:rightOrTop});second.init({Point2D:feftOrBottom});}second=second.Shifted(this.mDepthOffset);outerTickOffset=new $C.Point2D();outerTickOffset.Reset(0,0);if(this.IsVerticalAxis()){outerTickOffset.x=this.IsLeftDirection()?tickLength:-tickLength;}else{outerTickOffset.y=this.IsDownDirection()?-tickLength:tickLength;}switch(gridStyle){case $GLT.DssGraphGridRegular:polyLine.push(first);polyLine.push(first.Shifted(this.mDepthOffset));polyLine.push(second);break;case $GLT.DssGraphGridBoth:if(this.hasDepthAxisLine(location)||this.HasLabelsOnBothSides()){polyLine.push(first.Shifted(outerTickOffset));}polyLine.push(first);polyLine.push(first.Shifted(this.mDepthOffset));polyLine.push(second);if(!this.hasDepthAxisLine(location)||this.HasLabelsOnBothSides()){polyLine.push(second.Shifted(-outerTickOffset));}break;case $GLT.DssGraphGridInnerTicks:if(this.hasDepthAxisLine(location)){polyLine.push(first);polyLine.push(first.Shifted(depthTickOffset));}else{polyLine.push(second);polyLine.push(second.Shifted(outerTickOffset));}break;case $GLT.DssGraphGridOuterTicks:if(this.hasDepthAxisLine(location)){polyLine.push(first.Shifted(outerTickOffset));polyLine.push(first);}else{polyLine.push(second);polyLine.push(second.Shifted(-outerTickOffset));}break;case $GLT.DssGraphGridSpanningTicks:if(this.hasDepthAxisLine(location)){polyLine.push(first.Shifted(outerTickOffset));polyLine.push(first);polyLine.push(first.Shifted(depthTickOffset));}else{polyLine.push(second.Shifted(outerTickOffset));polyLine.push(second.Shifted(-outerTickOffset));}break;}}mstrmojo.chart.Axis=mstrmojo.declare(mstrmojo.chart.GraphObjectManager,null,{scriptClass:"mstrmojo.chart.Axis",mDeviceDataArea:null,mTickLength:-1,mUseDepth:false,mDepth:0,mDepthDirection:0,mDepthOffset:null,mManagerGraphObjectList:null,mpMajorGridSet:null,mpMinorGridSet:null,mpAxisLabelSet:null,mpAxisLineSet:null,mIsUniformAxis:false,maxLabelLength:-1,hasLabelCreated:false,hasMajorTickCreated:false,hasMinorTickCreated:false,mLabelInterval:0,resizeAction:-1,mLabelList:null,restrictWidth:null,restrictHeight:null,mIsShown:true,mIntegrity:15,init:function init(props){this._super(props);var chartCtx=this.mChartContextPtr;this.mLabelList=[];if(this.mUseDepth){this.mDepthOffset=new $C.Point2D();}this.mManagerGraphObjectList=[];if(!!props.IsUA){this.mIsUniformAxis=true;}if(this.mIsUniformAxis){this.restrictHeight=this.restrictWidth=-1;}this.mAxisInfo=new $C.GraphAxisGeneral(props);this.mMajorGrid={mShowGridLines:true,mGridStyle:$GLT.DssGraphGridRegular,mUseManualGrid:false,mGridInterval:0};this.mMinorGrid={mShowGridLines:false,mGridStyle:$GLT.DssGraphGridNone,mUseManualGrid:false,mGridInterval:0};switch(props.AxisDirection){case $AXIS_DIRECTION.AD_X:this.mTickLength=chartCtx.mGraphHeight/kTickFactor+1;break;case $AXIS_DIRECTION.AD_Y:this.mTickLength=chartCtx.mGraphWidth/kTickFactor+1;break;case $AXIS_DIRECTION.AD_Z:this.mTickLength=2;break;}this.mTickLength=Math.max(4,this.mTickLength);},SetDeviceDataArea:function SetDeviceDataArea(deviceDataArea){if(this.mDeviceDataArea===null){this.mDeviceDataArea=new $C.Rect2D({Rect2D:deviceDataArea});}else{this.mDeviceDataArea.ResetRect(deviceDataArea);}},IsReverseOrder:function IsReverseOrder(){return this.mAxisInfo.mAxisDrawInReverse;},SetIntegrity:function SetIntegrity(integrity){this.mIntegrity=integrity;if((integrity&kIntegrityAxisBody)===0){this.mAxisInfo.mShowAxisLine=false;this.mMajorGrid.mGridStyle=$GLT.DssGraphGridNone;}if((integrity&kIntegrityAxisMajorTick)===0){this.mMajorGrid.mShowGridLines=false;this.mMajorGrid.mGridStyle=$GLT.DssGraphGridNone;}if((integrity&kIntegrityAxisMinorTick)===0){this.mMinorGrid.mShowGridLines=false;this.mMinorGrid.mGridStyle=$GLT.DssGraphGridNone;}if((integrity&kIntegrityAxisLabel)===0){this.mAxisInfo.mShowAxisLabels=false;}},HasLabelsOnBothSides:function HasLabelsOnBothSides(){return(this.mAxisInfo.mAxisLabelsLocation===$AXIS_LABEL_LOC.ALL_BOTTOM_TOP||this.mAxisInfo.mAxisLabelsLocation===$AXIS_LABEL_LOC.ALL_LEFT_RIGHT)&&!(this.mChartContextPtr.mIsTimeSeriesChart);},IsVerticalAxis:function IsVerticalAxis(){return this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_Y;},IsLeftDirection:function IsLeftDirection(){return this.mDepthDirection>90&&this.mDepthDirection<270;},IsDownDirection:function IsDownDirection(){return this.mDepthDirection>180;},HasOuterTicks:function HasOuterTicks(gridStyle){return gridStyle===$GLT.DssGraphGridOuterTicks||gridStyle===$GLT.DssGraphGridBoth||gridStyle===$GLT.DssGraphGridSpanningTicks;},HasTwoGridLineParts:function HasTwoGridLineParts(gridStyle){return this.HasLabelsOnBothSides()&&(gridStyle===$GLT.DssGraphGridInnerTicks||gridStyle===$GLT.DssGraphGridOuterTicks||gridStyle===$GLT.DssGraphGridSpanningTicks);},IsLogarithmic:function IsLogarithmic(){return false;},getIndex:function getIndex(){switch(this.mTripleId.mObjectId){case $GO.DssGraphO1Body:return kAxisIndex_AI_O1;case $GO.DssGraphO2Body:return kAxisIndex_AI_O2;case $GO.DssGraphX1Body:return kAxisIndex_AI_X1;case $GO.DssGraphY1Body:return kAxisIndex_AI_Y1;case $GO.DssGraphY2Body:return kAxisIndex_AI_Y2;case $GO.DssGraphY3Body:return kAxisIndex_AI_Y3;case $GO.DssGraphY4Body:return kAxisIndex_AI_Y4;case $GO.DssGraphZBody:return kAxisIndex_AI_Z;case $GO.DssGraphX2Body:return kAxisIndex_AI_X2;default:return 0;}},GetInterlacedGridId:function GetInterlacedGridId(){return $EGO.DssGraphO1Interlaced+this.getIndex();},ReserveTitleArea:function ReserveTitleArea(titleArea){var index,titleObjectId,tripleId,rect,axisTitle;if(!this.mAxisInfo.mShowAxisTitle){return ;}index=this.getIndex();titleObjectId=$C.gAxisObjects[index].mTitleId;if(titleObjectId.mObjectId===$C.gNullObjectId){return ;}tripleId=new $C.TripleId({ObjectId:titleObjectId.mObjectId,SeriesId:$C.gNullSeriesId,GroupId:$NULL_GROUP_ID});rect=new $C.Rect2D();this.InitObjectSet(tripleId,$GRAPH_OBJ_TYPE.GOT_AXIS_TITLE);axisTitle=new $C.TextObject({TripleId:tripleId,GraphObjectManager:this,rect:rect,ParentObject:this.mpAxisTitleSet});this.mpAxisTitleSet.AddGraphObject(axisTitle);axisTitle.SetText(this.mAxisTitle);this.mGraphObjectList.push(axisTitle);this.ReserveTitle(titleArea,false);},ReserveTitle:function ReserveTitle(titleArea,isReversed){var title,rect,sign,offset;if(!this.mAxisInfo.mShowAxisTitle){return ;}title=this.mGraphObjectList[0];rect=title.GetBoundingRect();sign=isReversed?-1:1;offset=((this.IsVerticalAxis()?rect.width:rect.height)+kTitleMargin)*sign;switch(this.mAxisInfo.mAxisLabelsLocation){case $AXIS_LABEL_LOC.ALL_BOTTOM:case $AXIS_LABEL_LOC.ALL_BOTTOM_TOP:titleArea.height-=offset;break;case $AXIS_LABEL_LOC.ALL_TOP:if(this.mTripleId.mObjectId===$GO.DssGraphO1Body){titleArea.height-=offset;}else{titleArea.y+=offset;titleArea.height-=offset;}break;case $AXIS_LABEL_LOC.ALL_LEFT:case $AXIS_LABEL_LOC.ALL_LEFT_RIGHT:titleArea.x+=offset;titleArea.width-=offset;break;case $AXIS_LABEL_LOC.ALL_RIGHT:if(this.mTripleId.mObjectId===$GO.DssGraphO1Body){titleArea.x+=offset;titleArea.width-=offset;}else{titleArea.width-=offset;}break;}},UpdateTitleLocation:function UpdateTitleLocation(titleArea){var title,rect,depthOffset,center,offset,tripleId;if(!this.mAxisInfo.mShowAxisTitle){return ;}title=this.mGraphObjectList[0];if(this.mChartContextPtr.mManualLayoutMode&&!this.mChartContextPtr.mRecalculateFrame){this.MoveTitleForManual(title);return ;}rect=title.GetBoundingRect();depthOffset=this.GetLabelOffset(this.mAxisInfo.mAxisLabelsLocation);if(this.IsVerticalAxis()){center=titleArea.y+titleArea.height/2+depthOffset.y;}else{center=titleArea.x+titleArea.width/2+depthOffset.x;}offset=(this.IsVerticalAxis()?rect.width:rect.height)/2+kTitleMargin;switch(this.mAxisInfo.mAxisLabelsLocation){case $AXIS_LABEL_LOC.ALL_BOTTOM:case $AXIS_LABEL_LOC.ALL_BOTTOM_TOP:title.MoveTo(center,titleArea.y+titleArea.height+offset,$AP.CENTER);break;case $AXIS_LABEL_LOC.ALL_TOP:if(this.mTripleId.mObjectId===$GO.DssGraphO1Body){title.MoveTo(center,titleArea.y+titleArea.height+offset,$AP.CENTER);}else{title.MoveTo(center,titleArea.y-offset,$AP.CENTER);}break;case $AXIS_LABEL_LOC.ALL_LEFT:case $AXIS_LABEL_LOC.ALL_LEFT_RIGHT:title.MoveTo(titleArea.x-offset,center,$AP.CENTER);break;case $AXIS_LABEL_LOC.ALL_RIGHT:if(this.mTripleId.mObjectId===$GO.DssGraphO1Body){title.MoveTo(titleArea.x-offset,center,$AP.CENTER);}else{title.MoveTo(titleArea.x+titleArea.width+offset,center,$AP.CENTER);}break;}tripleId=title.mTripleId;rect=title.GetBoundingRectNoRotation();this.mChartContextPtr.PutLocation(this.getAxisTitleLocationId(tripleId.mObjectId),rect);},generateAxisLine:function generateAxisLine(graphObjectList){this.CreateAxisLine();return this.MoveGraphObjectList(graphObjectList);},CreateAxisLine:function CreateAxisLine(){var tripleId;if(this.mUseDepth){hGenerateDepthAxisLine.call(this);return ;}if(!this.mAxisInfo.mShowAxisLine){return ;}tripleId=new $C.TripleId({ObjectId:this.mTripleId.mObjectId});this.InitObjectSet(tripleId,$GRAPH_OBJ_TYPE.GOT_AXIS_LINE);switch(this.mAxisInfo.mAxisLabelsLocation){case $AXIS_LABEL_LOC.ALL_BOTTOM_TOP:hGenerateOneAxisLine.call(this,$AXIS_LABEL_LOC.ALL_BOTTOM);hGenerateOneAxisLine.call(this,$AXIS_LABEL_LOC.ALL_TOP);break;case $AXIS_LABEL_LOC.ALL_LEFT_RIGHT:hGenerateOneAxisLine.call(this,$AXIS_LABEL_LOC.ALL_LEFT);hGenerateOneAxisLine.call(this,$AXIS_LABEL_LOC.ALL_RIGHT);break;default:hGenerateOneAxisLine.call(this,this.mAxisInfo.mAxisLabelsLocation);break;}},ReserveDepthAxisLine:function ReserveDepthAxisLine(deviceDataArea,isReversed,bothDirections){var offset;if(!this.mUseDepth){return ;}offset=new $C.Point2D({Point2D:this.mDepthOffset});offset.x=Math.abs(offset.x);offset.y=Math.abs(offset.y);if(isReversed){offset.x=-offset.x;offset.y=-offset.y;}if(this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_X||bothDirections){if(this.mDepthDirection<180){deviceDataArea.y+=offset.y;deviceDataArea.height-=offset.y;}else{deviceDataArea.height-=offset.y;}}else{if(this.mAxisInfo.mAxisDirection===$AXIS_DIRECTION.AD_Y||bothDirections){if(this.mDepthDirection<90||this.mDepthDirection>270){deviceDataArea.width-=offset.x;}else{deviceDataArea.x+=offset.x;deviceDataArea.width-=offset.x;}}}},TrimMarginsForDepthAxis:function TrimMarginsForDepthAxis(lowMargin,highMargin){var currentLowMargin,currentHighMargin,returnVal;currentLowMargin=lowMargin;currentHighMargin=highMargin;if(!this.mUseDepth){returnVal={HighMargin:currentHighMargin,LowMargin:currentLowMargin};return returnVal;}if(this.IsVerticalAxis()){if(this.mDepthDirection<180){currentHighMargin+=this.mDepthOffset.y;}else{currentLowMargin-=this.mDepthOffset.y;}}else{if(this.mDepthDirection<90||this.mDepthDirection>270){currentHighMargin-=this.mDepthOffset.x;}else{currentLowMargin+=this.mDepthOffset.x;}}currentHighMargin=(currentHighMargin>=0)?currentHighMargin:0;currentLowMargin=(currentLowMargin>=0)?currentLowMargin:0;returnVal={HighMargin:currentHighMargin,LowMargin:currentLowMargin};return returnVal;},getDepthMargin:function getDepthMargin(lowMargin,highMargin){if(!this.mUseDepth){return null;}var depthOffset=this.mDepthOffset,currentLowMargin=lowMargin,currentHighMargin=highMargin;switch(this.mAxisInfo.mAxisLabelsLocation){case $AXIS_LABEL_LOC.ALL_LEFT:case $AXIS_LABEL_LOC.ALL_RIGHT:if(this.hasDepthAxisLine(this.mAxisInfo.mAxisLabelsLocation)){if(depthOffset.y>0){currentLowMargin=depthOffset.y;}else{currentHighMargin=-depthOffset.y;}}else{if(depthOffset.y>0){currentHighMargin=depthOffset.y;}else{currentLowMargin=-depthOffset.y;}}break;case $AXIS_LABEL_LOC.ALL_BOTTOM:case $AXIS_LABEL_LOC.ALL_TOP:if(this.hasDepthAxisLine(this.mAxisInfo.mAxisLabelsLocation)){if(depthOffset.x>0){currentHighMargin=depthOffset.x;}else{currentLowMargin=-depthOffset.x;}}else{if(depthOffset.x>0){currentLowMargin=depthOffset.x;}else{currentHighMargin=-depthOffset.x;}}break;case $AXIS_LABEL_LOC.ALL_LEFT_RIGHT:case $AXIS_LABEL_LOC.ALL_BOTTOM_TOP:break;default:return null;}return{highMargin:currentHighMargin,lowMargin:currentLowMargin};},GetLabelOffset:function GetLabelOffset(labelLocation,offset){if(!offset){offset=new $C.Point2D();}offset.Reset(0,0);if((!this.mUseDepth)||this.hasDepthAxisLine(labelLocation)){return offset;}offset.ResetPoint(this.mDepthOffset);return offset;},GenerateGridLinesEx:function GenerateGridLinesEx(){this.GenerateGridLines(this.mDeviceDataArea,0,this.mGraphObjectList);},GenerateGridLines:function GenerateGridLines(dataArea,areaId,graphObjectList){if((this.mMajorGrid.mShowGridLines&&this.mMajorGrid.mGridStyle!==$GLT.DssGraphGridNone)||(this.mMinorGrid.mShowGridLines&&this.mMinorGrid.mGridStyle!==$GLT.DssGraphGridNone)){hGenerateGrids.call(this,dataArea,graphObjectList,true);}},GenerateInterlacedGrids:function GenerateInterlacedGrids(dataArea,areaId,graphObjectList){if(this.mAxisInfo.mUseInterlacedGrids){hGenerateGrids.call(this,dataArea,graphObjectList,false);}},MoveGraphObjectList:function MoveGraphObjectList(graphObjectList){var len,i;len=this.mManagerGraphObjectList.length;for(i=0;i<len;++i){graphObjectList.push(this.mManagerGraphObjectList[i]);}this.mManagerGraphObjectList.splice(0,this.mManagerGraphObjectList.length);},GenerateOneLineObject:function GenerateOneLineObject(tripleId,polyLine,gridLineSet){var gridLine;gridLine=new $C.PolyLineObject({TripleId:tripleId,GraphObjectManager:this,PolyLine:polyLine,GraphCollectionObject:gridLineSet});gridLineSet.AddGraphObject(gridLine);this.mManagerGraphObjectList.push(gridLine);},SetDepthAndDirection:function SetDepthAndDirection(depth,depthDirection){var returnVal;this.mUseDepth=true;this.mDepth=depth;this.mDepthDirection=depthDirection;returnVal=this.mChartContextPtr.CalculateDepthOffset(this.mDepth,this.mDepthDirection);this.mDepthOffset.x=returnVal.OffsetX;this.mDepthOffset.y=returnVal.OffsetY;},getAxisTitleLocationId:function getAxisTitleLocationId(titleId){switch(titleId){case $GTN.DssGraphTitleCategory:return $GP.DssGraphTitleXLocation;case $GTN.DssGraphTitleY1:return $GP.DssGraphTitleY1Location;case $GTN.DssGraphTitleY2:return $GP.DssGraphTitleY2Location;case $GTN.DssGraph3DRowTitle:return $GP.DssGraph3DRowTitleLocationNEW;case $GTN.DssGraph3DColTitle:return $GP.DssGraph3DColTitleLocationNEW;case $GTN.DssGraph3DLYTitle:return $GP.DssGraph3DLYTitleLocation;case $GTN.DssGraph3DRYTitle:return $GP.DssGraph3DRYTitleLocation;default:return 0;}},MoveLabel:function MoveLabel(label,gridPoint,unitOffsetDirection,labelMargin){var rect,factor,rotation,tolerance,offset;if(labelMargin===undefined){labelMargin=$C.Axis.gLabelMargin;}rect=label.GetTransformedRect(true);rotation=label.mFormatFontPtr.mFontRotation;if(perfHalfSize===null){perfHalfSize=new $C.Point2D();}else{perfHalfSize.Reset(0,0);}switch(rotation){case $FR.Rotate45:case $FR.Rotate315:case $FR.Normal:if(rotation===$FR.Rotate45||rotation===$FR.Rotate315){factor=(rotation===$FR.Rotate45)?1:-1;unitOffsetDirection.Reset((unitOffsetDirection.x-factor*unitOffsetDirection.y)*Math.SQRT1_2,(factor*unitOffsetDirection.x+unitOffsetDirection.y)*Math.SQRT1_2);gridPoint.Reset((gridPoint.x-factor*gridPoint.y)*Math.SQRT1_2,(factor*gridPoint.x+gridPoint.y)*Math.SQRT1_2);}perfHalfSize.Reset(rect.width/2,rect.height/2);break;case $FR.Rotate90:perfHalfSize.Reset(rect.width/2,(rect.height+1)/2);break;case $FR.Rotate180:perfHalfSize.Reset((rect.width+1)/2,(rect.height+1)/2);break;case $FR.Rotate270:perfHalfSize.Reset((rect.width+1)/2,rect.height/2);break;case $FR.Custom:break;default:}tolerance=0.1;var labelCenterX=0,labelCenterY=0;if(Math.abs(unitOffsetDirection.x)<tolerance||Math.abs(unitOffsetDirection.y)<tolerance){if(Math.abs(unitOffsetDirection.x)<tolerance&&unitOffsetDirection.y<0){perfHalfSize.y=rect.height-perfHalfSize.y;}else{if(unitOffsetDirection.x<0&&Math.abs(unitOffsetDirection.y)<tolerance){perfHalfSize.x=rect.width-perfHalfSize.x;}}offset=perfHalfSize.x*Math.abs(unitOffsetDirection.x)+perfHalfSize.y*Math.abs(unitOffsetDirection.y)+labelMargin;labelCenterX=gridPoint.x+offset*unitOffsetDirection.x;labelCenterY=gridPoint.y+offset*unitOffsetDirection.y;}else{if(unitOffsetDirection.x>0&&unitOffsetDirection.y<0){perfHalfSize.y=-(rect.height-perfHalfSize.y);}else{if(unitOffsetDirection.x<0&&unitOffsetDirection.x>0){perfHalfSize.x=-(rect.width-perfHalfSize.x);}else{if(unitOffsetDirection.x<0&&unitOffsetDirection.y<0){perfHalfSize.Reset(-(rect.width-perfHalfSize.x),-(rect.height-perfHalfSize.y));}}}labelCenterX=gridPoint.x+labelMargin*unitOffsetDirection.x+perfHalfSize.x;labelCenterY=gridPoint.y+labelMargin*unitOffsetDirection.y+perfHalfSize.y;}if(rotation===$FR.Rotate45||rotation===$FR.Rotate315){factor=(rotation===$FR.Rotate45)?-1:1;labelCenterX=(labelCenterX-factor*labelCenterY)*Math.SQRT1_2;labelCenterY=(factor*labelCenterX+labelCenterY)*Math.SQRT1_2;}label.MoveTo(Math.floor(labelCenterX+(labelCenterX<0?-0.5:0.5)),Math.floor(labelCenterY+(labelCenterY<0?-0.5:0.5)),$AP.CENTER);},MoveTitleForManual:function MoveTitleForManual(axisTitle){if(!this.mChartContextPtr.mManualLayoutMode){return ;}var titleId=axisTitle.mTripleId,axisTitleRect=this.mChartContextPtr.GetLocationRect(this.getAxisTitleLocationId(titleId.mObjectId));if(axisTitleRect){axisTitle.SetRect(axisTitleRect);axisTitle.CalculateDeviceRect();}else{axisTitle.mIsShown=false;}},InitObjectSet:function InitObjectSet(tripleId,graphObjectType){var objectSet,collectionType=$CT.CT_LINE;switch(graphObjectType){case $GRAPH_OBJ_TYPE.GOT_AXIS_TITLE:objectSet=this.mpAxisTitleSet;collectionType=$CT.CT_TEXT;break;case $GRAPH_OBJ_TYPE.GOT_AXIS_LABEL:objectSet=this.mpAxisLabelSet;collectionType=$CT.CT_TEXT;break;case $GRAPH_OBJ_TYPE.GOT_AXIS_LINE:objectSet=this.mpAxisLineSet;break;case $GRAPH_OBJ_TYPE.GOT_MAJOR_GRID:objectSet=this.mpMajorGridSet;break;case $GRAPH_OBJ_TYPE.GOT_MINOR_GRID:objectSet=this.mpMinorGridSet;break;case $GRAPH_OBJ_TYPE.GOT_INTERLACED_GRID:objectSet=this.mpInterlacedGridSet;collectionType=$CT.CT_GENERAL_SHAPE;break;default:}if(objectSet!==null&&objectSet!==undefined){return ;}if(this.mTripleId.mSeriesId>0){objectSet=this.GetGraphObject(tripleId,false);}if(!objectSet){objectSet=new $C.GraphCollectionObject({TripleId:tripleId,GraphObjectManager:this,CollectionType:collectionType});this.AddToMap(objectSet);}switch(graphObjectType){case $GRAPH_OBJ_TYPE.GOT_AXIS_TITLE:this.mpAxisTitleSet=objectSet;break;case $GRAPH_OBJ_TYPE.GOT_AXIS_LABEL:this.mpAxisLabelSet=objectSet;break;case $GRAPH_OBJ_TYPE.GOT_AXIS_LINE:this.mpAxisLineSet=objectSet;break;case $GRAPH_OBJ_TYPE.GOT_MAJOR_GRID:this.mpMajorGridSet=objectSet;break;case $GRAPH_OBJ_TYPE.GOT_MINOR_GRID:this.mpMinorGridSet=objectSet;break;case $GRAPH_OBJ_TYPE.GOT_INTERLACED_GRID:this.mpInterlacedGridSet=objectSet;break;default:}},LoadProperties:function LoadProperties(){var value,tripleId,chartCtx=this.mChartContextPtr,showTitleProperty,showAxisTitle,titleObjectId,titleTripleId;if(chartCtx.mIsGraphMatrix){tripleId=this.mTripleId;if(this.hasOwnProperty("mTicks")){this.mMajorGrid.mShowGridLines=true;}else{this.mMajorGrid.mShowGridLines=false;this.mMajorGrid.mGridStyle=$GLT.DssGraphGridNone;}if(this.mMajorGrid.mShowGridLines){value=chartCtx.GetProperty($GP.DssGraphStyleMajor,tripleId);if(this.mMajorGrid.mShowGridLines&&value){this.mMajorGrid.mGridStyle=value;}}return ;}tripleId=new $C.TripleId({ObjectId:this.mTripleId.mObjectId});value=chartCtx.GetProperty($GP.DssGraphShow2DAxisLabels,tripleId);if(value){this.mAxisInfo.mShowAxisLabels=value!==false;}if(chartCtx.GetGraphMajorType()===$GMT.GMT_GAUGE){return ;}showTitleProperty=0;switch(this.mTripleId.mObjectId){case $GO.DssGraphO1Body:showTitleProperty=$GP.DssGraphShow2DXTitle;break;case $GO.DssGraphO2Body:showTitleProperty=$GP.DssGraphShowTitleSeries;break;case $GO.DssGraphX1Body:showTitleProperty=$GP.DssGraphShow2DXTitle;break;case $GO.DssGraphY1Body:showTitleProperty=$GP.DssGraphShow2DY1Title;break;case $GO.DssGraphY2Body:case $GO.DssGraphX2Body:showTitleProperty=$GP.DssGraphShow2DY2Title;break;case $GO.DssGraphY3Body:case $GO.DssGraphY4Body:break;case $GO.DssGraphZBody:showTitleProperty=$GP.DssGraphShow3DColTitle;break;default:}value=chartCtx.GetProperty(showTitleProperty,$NTID);if(showTitleProperty!==0&&value){this.mAxisInfo.mShowAxisTitle=value!==false;}if(chartCtx.isUADataAreaOutput()){this.mAxisInfo.mShowAxisLabels=false;this.mAxisInfo.mShowAxisTitle=false;}showAxisTitle=this.mAxisInfo.mShowAxisTitle;if(showAxisTitle){titleTripleId=$C.gAxisObjects[this.getIndex()].mTitleId;value=chartCtx.GetProperty($GP.DssGraphTextContent,titleTripleId);if(titleTripleId.mObjectId!==$NOID&&value){this.mAxisTitle=value;}}value=chartCtx.GetProperty($EGP.DssGraphUseInterlacedGrid,tripleId);if(value){this.mAxisInfo.mUseInterlacedGrids=value!==false;}value=chartCtx.GetProperty($GP.DssGraphShow2DAxisMajor,tripleId);if(value){this.mMajorGrid.mShowGridLines=value!==false;}value=chartCtx.GetProperty($GP.DssGraphStyleMajor,tripleId);if(this.mMajorGrid.mShowGridLines&&value){this.mMajorGrid.mGridStyle=value;}value=chartCtx.GetProperty($GP.DssGraphShow2DAxisMinor,tripleId);if(value){this.mMinorGrid.mShowGridLines=value!==false;}value=chartCtx.GetProperty($GP.DssGraphStyleMinor,tripleId);if(this.mMinorGrid.mShowGridLines&&value){this.mMinorGrid.mGridStyle=value;}value=chartCtx.GetProperty($GP.DssGraphManualMinor,tripleId);if(value){this.mMinorGrid.mUseManualGrid=value!==false;}value=chartCtx.GetProperty($GP.DssGraphCountMinor,tripleId);if(value){this.mMinorGrid.mGridInterval=value;}value=chartCtx.GetProperty($GP.DssGraphShow2DAxisLine,tripleId);if(value){this.mAxisInfo.mShowAxisLine=value;}switch(chartCtx.GetGraphMajorType()){case $GMT.GMT_POLAR:case $GMT.GMT_RADAR:return ;default:break;}value=chartCtx.GetProperty($GP.DssGraph2DSide,tripleId);if(value){if(value===$LL.DssGraphAxisLabelLowSide){this.mAxisInfo.mAxisLabelsLocation=this.IsVerticalAxis()?$AXIS_LABEL_LOC.ALL_LEFT:$AXIS_LABEL_LOC.ALL_BOTTOM;}else{if(value===$LL.DssGraphAxisLabelHighSide){this.mAxisInfo.mAxisLabelsLocation=this.IsVerticalAxis()?$AXIS_LABEL_LOC.ALL_RIGHT:$AXIS_LABEL_LOC.ALL_TOP;}else{if(value===$LL.DssGraphAxisLabelBothSides){this.mAxisInfo.mAxisLabelsLocation=this.IsVerticalAxis()?$AXIS_LABEL_LOC.ALL_LEFT_RIGHT:$AXIS_LABEL_LOC.ALL_BOTTOM_TOP;}}}}},generateGridsByArea:function generateGridsByArea(){},GetOneGridLine:function GetOneGridLine(location,gridStyle,tickLength,leftOrBottom,rightOrTop,polyLine){if(this.mUseDepth){hGetOneDepthGridLine.call(this,location,gridStyle,tickLength,leftOrBottom,rightOrTop,polyLine);return ;}polyLine.splice(0,polyLine.length);perfGridLinePoint1=new $C.Point2D({Point2D:leftOrBottom});perfGridLinePoint2=new $C.Point2D({Point2D:rightOrTop});polyLine.push(perfGridLinePoint1);polyLine.push(perfGridLinePoint2);if(firstOuterTickOffset===null){firstOuterTickOffset=new $C.Point2D();}else{firstOuterTickOffset.Reset(0,0);}if(secondOuterTickOffset===null){secondOuterTickOffset=new $C.Point2D();}else{secondOuterTickOffset.Reset(0,0);}if(this.IsVerticalAxis()){if(location===$AXIS_LABEL_LOC.ALL_RIGHT){secondOuterTickOffset.x=tickLength;}else{firstOuterTickOffset.x=-tickLength;}}else{if(location===$AXIS_LABEL_LOC.ALL_TOP){secondOuterTickOffset.y=-tickLength;}else{firstOuterTickOffset.y=tickLength;}}switch(gridStyle){case $GLT.DssGraphGridRegular:break;case $GLT.DssGraphGridBoth:polyLine[0].x+=firstOuterTickOffset.x;polyLine[0].y+=firstOuterTickOffset.y;if(this.HasLabelsOnBothSides()){polyLine[1].x-=firstOuterTickOffset.x;polyLine[1].y-=firstOuterTickOffset.y;}else{polyLine[1].x+=secondOuterTickOffset.x;polyLine[1].y+=secondOuterTickOffset.y;}break;case $GLT.DssGraphGridInnerTicks:if(location!==$AXIS_LABEL_LOC.ALL_RIGHT&&location!==$AXIS_LABEL_LOC.ALL_TOP){polyLine[1].x=polyLine[0].x-firstOuterTickOffset.x;polyLine[1].y=polyLine[0].y-firstOuterTickOffset.y;}else{polyLine[0].x=polyLine[1].x-secondOuterTickOffset.x;polyLine[0].y=polyLine[1].y-secondOuterTickOffset.y;}break;case $GLT.DssGraphGridOuterTicks:if(location!==$AXIS_LABEL_LOC.ALL_RIGHT&&location!==$AXIS_LABEL_LOC.ALL_TOP){polyLine[1].x=polyLine[0].x+firstOuterTickOffset.x;polyLine[1].y=polyLine[0].y+firstOuterTickOffset.y;}else{polyLine[0].x=polyLine[1].x+secondOuterTickOffset.x;polyLine[0].y=polyLine[1].y+secondOuterTickOffset.y;}break;case $GLT.DssGraphGridSpanningTicks:if(location!==$AXIS_LABEL_LOC.ALL_RIGHT&&location!==$AXIS_LABEL_LOC.ALL_TOP){polyLine[1].x=polyLine[0].x-firstOuterTickOffset.x;polyLine[1].y=polyLine[0].y-firstOuterTickOffset.y;polyLine[0].x+=firstOuterTickOffset.x;polyLine[0].y+=firstOuterTickOffset.y;}else{polyLine[0].x=polyLine[1].x-secondOuterTickOffset.x;polyLine[0].y=polyLine[1].y-secondOuterTickOffset.y;polyLine[1].x+=secondOuterTickOffset.x;polyLine[1].y+=secondOuterTickOffset.y;}break;default:}},hasDepthAxisLine:function hasDepthAxisLine(labelLocation){if(!this.mUseDepth){return false;}switch(labelLocation){case $AXIS_LABEL_LOC.ALL_LEFT:case $AXIS_LABEL_LOC.ALL_LEFT_RIGHT:return(this.mDepthDirection<90||this.mDepthDirection>270);case $AXIS_LABEL_LOC.ALL_RIGHT:return(this.mDepthDirection>90&&this.mDepthDirection<270);case $AXIS_LABEL_LOC.ALL_BOTTOM:case $AXIS_LABEL_LOC.ALL_BOTTOM_TOP:return(this.mDepthDirection<180);case $AXIS_LABEL_LOC.ALL_TOP:return(this.mDepthDirection>180);default:return false;}},TrimAxisPadding:function TrimAxisPadding(){},resetRestrictSpace:function resetRestrictSpace(rect){if(rect!==undefined){this.restrictWidth=rect.width;this.restrictHeight=rect.height;}else{this.restrictWidth=this.restrictHeight=-1;}},GetAxisLabelRotation:function GetAxisLabelRotation(){},isBaseLineQualified:function isBaseLineQualified(baseValue){return false;},liftedFromZero:function liftedFromZero(){return false;},SetTrimWithPadding:function SetTrimWithPadding(){},GetPositionAtTick:function GetPositionAtTick(){},getLabelRotation:function getLabelRotation(){if(this.mpAxisLabelSet){var formatFont=this.mpAxisLabelSet.GetFormatFont();return formatFont.mFontRotation;}return -1;},GetOuterTickLength:function GetOuterTickLength(){if(this.HasOuterTicks(this.mMajorGrid.mGridStyle)){return this.mTickLength;}if(this.HasOuterTicks(this.mMinorGrid.mGridStyle)){return this.mTickLength;}return 0;},updateMaxLabelLength:function updateMaxLabelLength(maxLabelLength,needTrim){if(maxLabelLength>0){if(needTrim===undefined){needTrim=false;}if(needTrim){maxLabelLength=this.calculateMaxAxisSpace(maxLabelLength);}}this.maxLabelLength=maxLabelLength;},calculateMaxAxisSpace:function calculateMaxAxisSpace(maxAxisSpace){var gmCtx=this.mChartContextPtr.GetGraphMatrixContext();maxAxisSpace-=(this.GetOuterTickLength()+gmCtx.getPadding($K.kLabelToChart));if(this instanceof mstrmojo.chart.CategoryAxis){maxAxisSpace-=gmCtx.getPadding($K.kCategoricalLabelToTick);}else{maxAxisSpace-=gmCtx.getPadding($K.kNumericLabelToTick);}return Math.max(maxAxisSpace,0);},getNextStatus:function getNextStatus(action){var k_TDB=-1,k_STAGGER=1,isX=!this.IsVerticalAxis(),expandX=0,expandY=1,shrinkX=2,status=this.getStatus(),interval=this.mLabelInterval;if(isX){if(action===expandX){if(interval>1){status=k_TDB;}}else{if(action===shrinkX){if(interval>=2&&status!==k_STAGGER){status=k_TDB;}}}}else{if(action===expandY){if(interval!==1){status=k_TDB;}}else{if(interval<2){status=k_TDB;}}}return status;},clearTickObjects:function clearTickObjects(id,isMajor){var i,idUtility=this.mChartContextPtr.getUtiliy().tripleId,objectList=this.mGraphObjectList,len=objectList.length,collection=isMajor?this.mpMajorGridSet:this.mpMinorGridSet;if(collection){collection.ClearCollection();}for(i=len-1;i>=0;i--){if(idUtility.equal(objectList[i].mTripleId,id)){objectList.splice(i,1);}}},restoreLabels:function restoreLabels(show){var i;if(this.hasLabelCreated){var oneLabel,labelCount=this.mpAxisLabelSet.GetCollectionSize(),fromList=labelCount<=0,props;if(labelCount===0){labelCount=this.mLabelList.length;}for(i=0;i<labelCount;++i){if(fromList){oneLabel=this.mLabelList[i];}else{oneLabel=this.mpAxisLabelSet.GetObjectByIndex(i);}if(!!oneLabel===false){continue;}props={Stringent:true,Restroke:true,TextWidthLimit:this.maxLabelLength,DivideByWord:true};if(this instanceof mstrmojo.chart.CategoryAxis&&this.mChartContextPtr.mIsGraphMatrix){if(this.mWordWrap===false){props.LineCount=1;}else{props.LineCount=2;}}oneLabel.Restore(props);if(show){oneLabel.mIsShown=true;}}}},checkShownLabelCount:function checkShownLabelCount(upperLimit){var list=this.mLabelList,len=list.length,shownCount=0,moreOrEqual=-2,less=-1;for(var i=0;i<len;i++){if(list[i]&&list[i].mIsShown){shownCount++;}if(upperLimit!==undefined&&shownCount>=upperLimit){return moreOrEqual;}}if(upperLimit!==undefined){return less;}return shownCount;},checkCondense:function checkCondense(){return false;},getCondenseStatus:function getCondenseStatus(){return undefined;},getUniformAxisLabelsInfo:function getUniformAxisLabelsInfo(props){var i=0,infoList=[],len=this.mLabelList.length;while(i<len){var oneLabel=this.mLabelList[i];if(oneLabel.mIsShown){if(props){if(props.CheckTruncated){if(oneLabel.mIsTruncated===false){continue;}}}infoList.push({Text:oneLabel.mText,Rect:oneLabel.GetBoundingRect()});}++i;}return infoList;}});$C.Axis.gLabelMargin=4;}());
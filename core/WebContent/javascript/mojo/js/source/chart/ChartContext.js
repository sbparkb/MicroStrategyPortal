(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.hash");mstrmojo.requiresCls("mstrmojo.VisEnum");mstrmojo.requiresClsP("mstrmojo.chart.common","MapStructure","Utility");mstrmojo.requiresClsP("mstrmojo.chart","Rect2D","Vector2D","Point2D","CEModuleMain","TripleId","FormatLine","JSONCanvas","SVGCanvas","GraphMatrixContext");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumPictureFormatType","EnumGraphMajorType","EnumLineJoinType","EnumLineStyle","EnumImageUsage","EnumDSSExtraGraphObject","EnumChartStyle","EnumGraphMatrixMajorGraphType","EnumGraphMatrixThemeType","EnumDssGraphGridChartUniformColorMode","EnumAttachedPointsStyle");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphType","EnumDSSGraphProperty","EnumDSSGraphObject","EnumDSSGraphFillBevelEffect","EnumVariantBool","EnumDSSGraphFillEffect");var $C=mstrmojo.chart,$CHART_ENUMS=$C.enums,$PFT=$CHART_ENUMS.EnumPictureFormatType,$GMT=$CHART_ENUMS.EnumGraphMajorType,$LINE_JOIN_TYPE=$CHART_ENUMS.EnumLineJoinType,$IMG_USAGE=$CHART_ENUMS.EnumImageUsage,$Utility=$C.common.Utility,$GMM=$C.gModuleMain,$NTID=$C.gNullTripleId,$NSID=$C.gNullSeriesId,$NULL_GROUP_ID=$C.gNullGroupId,$LINE_STYLE=$CHART_ENUMS.EnumLineStyle,$EGO=$CHART_ENUMS.EnumDSSExtraGraphObject,$CS=$CHART_ENUMS.EnumChartStyle,$GM_MT=$CHART_ENUMS.EnumGraphMatrixMajorGraphType,$GM_TT=$CHART_ENUMS.EnumGraphMatrixThemeType,$APS=$CHART_ENUMS.EnumAttachedPointsStyle,$CtrlType=mstrmojo.VisEnum.ControlType,$HASH=mstrmojo.hash;var sVirtualCoordinateWidth=700,sVirtualCoordinateHeight=400,sTDGVirtualXMIN=-16383,sTDGVirtualXMAX=16383,sTDGVirtualYMIN=-16383,sTDGVirtualYMAX=16383,sMaxDepthValue=500,sDepthRatio=0.1667,sDPI=96,sPOINTSOFONEINCH=72;var $M=mstrmojo.chart.model,$MODEL_ENUMS=$M.enums,$GT=$MODEL_ENUMS.EnumDSSGraphType,$GP=$MODEL_ENUMS.EnumDSSGraphProperty,$GO=$MODEL_ENUMS.EnumDSSGraphObject,$BE=$MODEL_ENUMS.EnumDSSGraphFillBevelEffect,$FE=$MODEL_ENUMS.EnumDSSGraphFillEffect;var perfTransPoly=[],perfQueryTripleId=new $C.TripleId();var $CTX=mstrmojo.chart.ChartContext=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.ChartContext",mBaseLayerObject:null,mPropertyMap:null,mGraphWidth:$GMM.mDefaultGraphWidth,mGraphHeight:$GMM.mDefaultGraphHeight,mGraphType:$GT.DssGraphTypeReserved,mDataset:null,mFormatManager:null,mCanvas:null,mCanvasInfo:null,caKeyMap:null,mLineJoinType:$LINE_JOIN_TYPE.LJT_MITER,mIsLineWidthOdd:false,mAbsoluteFontLineSize:true,mIsFontAntiAlias:true,mFontScaleRatio:1,mAxisAutoNumberFormat:null,mSelectedAxisAutoNumberFormat:null,mThresholdColorCache:{},globalFormats:null,mManualLayoutMode:false,mRecalculateFrame:true,mIsValueAxisShown:true,mUseAnimation:false,mIsTimeSeriesChart:false,mIsUniformAxisMode:false,mIsEntireChart:true,mIsGraphMatrix:false,mThemeType:$GM_TT._black,mUniformAxisContext:null,mpGraphMatrixContext:null,mPartialRendering:false,mRenderingWindow:null,mImageUsage:$IMG_USAGE.GENERAL,mImageFormat:$PFT.SVG,mDebugUseNewProperties:true,mTimers:[],mUseTimer:false,init:function init(props){this._super(props);this.caKeyMap={c1:"x1",c2:"x1"};this.mUseTimer=props.UseTimer||false;this.mGraphWidth=$GMM.mDefaultGraphWidth;this.mGraphHeight=$GMM.mDefaultGraphHeight;this.mDataset=props.DataSet||props.mDatasetPtr||null;this.mThemeType=$GM_TT._black;this.mSelectedAxisAutoNumberFormat={Array:[],Format:null};},getUtiliy:function getUtiliy(){return mstrmojo.chart.common.Utility;},populateCanvas:function popualteCanvas(reset){reset=reset||false;if(reset){this.mCanvas=null;}if(!!this.mCanvas){return ;}var type="SVG";if(this.mCanvasInfo){type=this.mCanvasInfo.type||"SVG";delete this.mCanvasInfo.type;}else{this.mCanvasInfo={type:"SVG",gradPrefix:"gmGrad",mGradientCount:0,seriesDrawOrder:this.mDataset.GetSeriesIndexByPriority()};}switch(type){case"JSON":this.mCanvas=new $C.JSONCanvas({});break;default:this.mCanvas=new $C.SVGCanvas(this.mCanvasInfo);break;}this.mCanvasInfo=null;},startTimer:function startTimer(desc){if(this.mUseTimer){var timerName=desc.functionName+": "+desc.purpose;console.time(timerName);this.mTimers.push(timerName);}},endTimer:function endTimer(){if(this.mUseTimer){var curTimerName=this.mTimers.pop();if(curTimerName){console.timeEnd(curTimerName);}}},vdWidth:function vdWidth(virtualWidth){return Math.floor(virtualWidth*this.mGraphWidth/sVirtualCoordinateWidth+0.5);},vdHeight:function vdHeight(virtualHeight){var graphHeight=this.mGraphHeight;if(this.mIsUniformAxisMode&&!this.mIsEntireChart){graphHeight=this.mUniformAxisContext.mGraphHeight;}return Math.floor(virtualHeight*graphHeight/sVirtualCoordinateHeight+0.5);},NeedAdjustedLinePath:function NeedAdjustedLinePath(){var imgFormat=this.mImageFormat;return this.mIsLineWidthOdd&&(imgFormat!==$PFT.PDF);},SetGraphSize:function SetGraphSize(graphWidth,graphHeight){if(graphWidth>0&&graphHeight>0){this.mGraphWidth=graphWidth;this.mGraphHeight=graphHeight;if(this.mpGraphMatrixContext){this.mpGraphMatrixContext.mEstGraphHeight=this.mGraphHeight;this.mpGraphMatrixContext.mEstGraphWidth=this.mGraphWidth;}}},GetGraphType:function GetGraphType(){return this.mGraphType;},dialogSizeToPixelSize:function dialogSizeToPixelSize(dialogSize){return dialogSize*Math.min(this.mGraphWidth,this.mGraphHeight)/2000;},DrawPolygon:function DrawPolygon(points,isLinePath,isCurveAnimation,basePoint,lineStyle){if(this.mImageFormat===$PFT.SVG){return ;}if((isLinePath===undefined)||(isLinePath===null)){isLinePath=true;}isCurveAnimation=isCurveAnimation||false;basePoint=basePoint||null;lineStyle=lineStyle||$LINE_STYLE.LS_SOLID;if(points.length<3){return ;}this.NewPath();if(isLinePath&&this.NeedAdjustedLinePath()){var lAdjustedPoints=this.hAdjustLinePath(points);this.DrawPolyLine(lAdjustedPoints,false,isCurveAnimation,basePoint,lineStyle);}else{this.DrawPolyLine(points,false,isCurveAnimation,basePoint,lineStyle);}this.ClosePath();},DrawStraightLine:function DrawStraightLine(startPoint,endPoint){if(this.mImageFormat===$PFT.SVG){return ;}this.NewPath();if(this.NeedAdjustedLinePath()){var xOffset=0,yOffset=0;if(startPoint.x===endPoint.x){xOffset=0.5;}if(startPoint.y===endPoint.y){yOffset=0.5;}this.hMoveTo(startPoint.x+xOffset,startPoint.y+yOffset,true);this.hLineTo(endPoint.x+xOffset,endPoint.y+yOffset,true);}else{this.hMoveTo(startPoint.x,startPoint.y,true);this.hLineTo(endPoint.x,endPoint.y,true);}},DrawPolyLine:function DrawPolyLine(points,isLinePath,isCurveAnimation,basePoint,lineStyle){if(this.mImageFormat===$PFT.SVG){return ;}if((isLinePath===undefined)||(isLinePath===null)){isLinePath=true;}isCurveAnimation=isCurveAnimation||false;basePoint=basePoint||null;lineStyle=lineStyle||$LINE_STYLE.LS_SOLID;if(lineStyle===$LINE_STYLE.LS_GRADIENT){lineStyle=$LINE_STYLE.LS_SOLID;}var numberOfPoints=points.length,i,previousIndex,temp;if(numberOfPoints<=0){return ;}var adjustedPoints;if(this.NeedAdjustedLinePath()){adjustedPoints=this.hAdjustLinePath(points);}numberOfPoints=adjustedPoints.length;this.NewPath();this.hMoveTo(adjustedPoints[0].x,adjustedPoints[0].y,isLinePath,isCurveAnimation,basePoint);previousIndex=0;for(i=1;i<numberOfPoints;++i){if(lineStyle===$LINE_STYLE.LS_SOLID){this.hLineTo(adjustedPoints[i].x,adjustedPoints[i].y,isLinePath,isCurveAnimation,basePoint);}else{temp=$C.gLinePatterns[lineStyle];this.DrawDashedLine(adjustedPoints[previousIndex],adjustedPoints[i],temp);}previousIndex=i;}},DrawDashedLine:function DrawDashedLine(startPoint,endPoint,linePattern){if(this.mImageFormat===$PFT.SVG){return ;}var length,x,y,x0,y0,distance=0,i=0,len,dashLength;length=Math.sqrt((startPoint.x-endPoint.x)*(startPoint.x-endPoint.x)+(startPoint.y-endPoint.y)*(startPoint.y-endPoint.y));x=(endPoint.x-startPoint.x)/length;y=(endPoint.y-startPoint.y)/length;len=linePattern.length;x0=startPoint.x;y0=startPoint.y;while(distance<length){dashLength=Math.min(linePattern[i%len],length-distance);++i;distance+=dashLength;if(i%2===1){this.MoveTo(x0,y0);}x0+=dashLength*x;y0+=dashLength*y;if(i%2===1){this.LineTo(x0,y0);}}},isParetoChart:function isParetoChart(){return this.mGraphType===$GT.DssGraphTypePareto||this.mGraphType===$GT.DssGraphTypePareto_Percent;},isCombinationChart:function isCombinationChart(){var gmCtx=this.GetGraphMatrixContext();return this.mIsGraphMatrix&&gmCtx.isCombinationChart();},hasBarAreaInComb:function hasBarAreaInComb(){if(this.isCombinationChart()===false){return false;}var allShapes=this.mDatasetPtr.GetSeriesByShape();return allShapes.Bar.length>0||allShapes.Area.length>0;},getFontScale:function getFontScale(){if(this.mAbsoluteFontLineSize){return this.mFontScaleRatio;}return 1;},vdRect:function vdRect(virtualRect){return(new $C.Rect2D({x:this.vdWidth(virtualRect.x),y:this.vdHeight(virtualRect.y),width:this.vdWidth(virtualRect.width),height:this.vdHeight(virtualRect.height)}));},vdPoint:function vdPoint(virtualPoint){return(new $C.Point2D({x:this.vdWidth(virtualPoint.x),y:this.vdHeight(virtualPoint.y)}));},vdFontSize:function vdFontSize(originalSize){var fontSize=originalSize;if(this.mIsGraphMatrix){return fontSize;}if(!this.mAbsoluteFontLineSize){fontSize=this.vdHeight(fontSize);}if(!this.mIsTimeSeriesChart){fontSize=this.PtSizeToPixelSize(fontSize);fontSize*=this.getFontScale();if(this.mIsGraphMatrix){var ratio=this.mDataset.GetZoomScale();fontSize=fontSize*ratio+0.5;}if(fontSize===0){fontSize=1;}}return fontSize;},vdLineWidth:function vdLineWidth(originalSize){var size=originalSize;if(!this.mAbsoluteFontLineSize){size=this.vdHeight(size);}size=this.PtSizeToPixelSize(size);size=Math.floor(size/100+0.5);return size;},TDGToMSTRPoint:function TDGToMSTRPoint(inputX,inputY){var x,y;x=Math.floor((inputX-sTDGVirtualXMIN)*this.mGraphWidth/(sTDGVirtualXMAX-sTDGVirtualXMIN)+0.5);y=Math.floor((sTDGVirtualYMAX-inputY)*this.mGraphHeight/(sTDGVirtualYMAX-sTDGVirtualYMIN)+0.5);return(new $C.Point2D({x:x,y:y}));},setCanvas:function SetCanvas(canvas){this.mCanvas=canvas;},saveState:function saveState(){this.mCanvas.saveState();},Rotate:function Rotate(anchor,radian){this.mCanvas.Rotate(anchor,radian);},Scale:function Scale(x,y){this.mCanvas.Scale(x,y);},RestoreState:function RestoreState(){this.mCanvas.RestoreState();},Clip:function Clip(){this.mCanvas.Clip();},DrawRectangle:function DrawRectangle(rect,isLinePath){if(this.mImageFormat===$PFT.SVG){return ;}this.NewPath();if(isLinePath&&this.NeedAdjustedLinePath()){this.mCanvas.AddRect(rect.x+0.5,rect.y+0.5,rect.width,rect.height);}else{this.mCanvas.AddRect(rect.x,rect.y,rect.width,rect.height);}},FinishTextBoundingBox:function FinishTextBoundingBox(polygon,color,forDataLabel){var seriesCount=this.mDataset.GetSeriesCount();if(this.mCanvas instanceof mstrmojo.chart.SVGCanvas){this.mCanvas.CreateSVGTextBoundingBox(polygon,color,forDataLabel,seriesCount);}},FinishDrawCircle:function FinishDrawCircle(circle,tripleId){if(this.mCanvas instanceof mstrmojo.chart.SVGCanvas){var identity=this.hGetIdentity(tripleId.mSeriesId,tripleId.mGroupId);this.mCanvas.CreateSVGCircle(circle.x,circle.y,circle.r,identity);}},FinishDrawRect:function FinishDrawRect(rect,tripleId){if(this.mCanvas instanceof mstrmojo.chart.SVGCanvas){var identity;if(tripleId.mObjectId===$GO.DssGraphDataMarker){identity=this.hGetIdentityEx(tripleId.mSeriesId,tripleId.mGroupId,"marker");}else{identity=this.hGetIdentity(tripleId.mSeriesId,tripleId.mGroupId);}if(this.NeedAdjustedLinePath()){rect.x=parseInt(rect.x)===rect.x?rect.x+0.5:rect.x;rect.y=parseInt(rect.y)===rect.y?rect.y+0.5:rect.y;}this.mCanvas.CreateSVGRect(rect.x,rect.y,rect.width,rect.height,identity);}},FinishDrawPieSlice:function FinishDrawPieSlice(center,radix,startRadian,endRadian,tripleId,oneSlice,whiteBorder){var identity;if(oneSlice===undefined){oneSlice=false;}if(this.mCanvas instanceof mstrmojo.chart.SVGCanvas){if(tripleId.angleByIndex!==undefined){identity=this.hGetPieIdentity(tripleId.mSeriesId,tripleId.mGroupId,tripleId.angleByIndex,tripleId.sliceById);}else{identity=this.hGetIdentity(tripleId.mSeriesId,tripleId.mGroupId);}if(oneSlice){this.mCanvas.CreateSVGCircle(center.x,center.y,radix,identity,whiteBorder,this.mThemeType===$GM_TT._white);}else{this.mCanvas.CreateSVGSector(center.x,center.y,radix,startRadian,endRadian,identity,whiteBorder,this.mThemeType===$GM_TT._white);}}},FinishDrawRingPieSlice:function FinishDrawRingPieSlice(center,outR,inR,startRadian,endRadian,tripleId){var identity;if(this.mCanvas instanceof mstrmojo.chart.SVGCanvas){if(tripleId.angleByIndex!==undefined){identity=this.hGetPieIdentity(tripleId.mSeriesId,tripleId.mGroupId,tripleId.angleByIndex,tripleId.sliceById);}else{identity=this.hGetIdentity(tripleId.mSeriesId,tripleId.mGroupId);}this.mCanvas.CreateSVGRingSector(center.x,center.y,outR,inR,startRadian,endRadian,identity);}},FinishDrawRing:function FinishDrawRing(iCenter,iOutR,iInR,iIds,isPie){isPie=isPie||false;var lIdentity;if(this.mCanvas instanceof mstrmojo.chart.SVGCanvas){if(isPie){lIdentity=this.hGetPieIdentity(iIds.mSeriesId,iIds.mGroupId,iIds.angleByIndex,iIds.sliceById);}else{lIdentity=this.hGetIdentity(iIds.mSeriesId,iIds.mGroupId);}this.mCanvas.CreateSVGRing(iCenter.x,iCenter.y,iOutR,iInR,lIdentity);}},FinishDrawPolyline:function FinishDrawPolyline(points,iId,isMute,identity,start,mid,end){var seriesCount=this.mDataset.GetSeriesCount();if(this.mCanvas instanceof mstrmojo.chart.SVGCanvas){isMute=isMute||false;var kPolylineTypeGeneric=0,kPolylineTypeBulletTarget=1,kPolylineTypeAxisTicks=2,kPolylineTypeAxisBody=3,kPolylineTypeAxisOrigin=4,identities,objectId=iId.mObjectId,canvas=this.mCanvas;var adjustedPoints=points;if(this.NeedAdjustedLinePath()){adjustedPoints=this.hAdjustLinePath(points);}switch(objectId){case $GO.DssGraphUserLine1:case $GO.DssGraphUserLine2:case $GO.DssGraphUserLine3:case $GO.DssGraphUserLine4:identity=this.hGetIdentityEx(objectId-$GO.DssGraphUserLine1,0,"originLine");if(identity){identities=[identity];}else{identities=[];}canvas.CreateSVGPolyLine(iId.mSeriesId,adjustedPoints,identities,kPolylineTypeAxisOrigin);break;case $GO.DssGraphO1Major:case $GO.DssGraphO2Major:case $GO.DssGraphY1Major:case $GO.DssGraphY2Major:case $GO.DssGraphX1Major:case $GO.DssGraphX2Major:case $GO.DssGraphO1Minor:case $GO.DssGraphO2Minor:case $GO.DssGraphY1Minor:case $GO.DssGraphY2Minor:case $GO.DssGraphX1Minor:case $GO.DssGraphX2Minor:identities=[];canvas.CreateSVGPolyLine(iId.mSeriesId,adjustedPoints,identities,kPolylineTypeAxisTicks);break;case $GO.DssGraphO1Body:case $GO.DssGraphO2Body:case $GO.DssGraphX1Body:case $GO.DssGraphX2Body:case $GO.DssGraphY1Body:case $GO.DssGraphY2Body:identities=[];canvas.CreateSVGPolyLine(iId.mSeriesId,adjustedPoints,identities,kPolylineTypeAxisBody);break;case $GO.DssGraphTrendLine:canvas.CreateSVGPolyLineForTRLine(points,seriesCount,identity,true,start,mid,end);break;default:if(isMute){identities=[];canvas.CreateSVGPolyLine(iId.mSeriesId,adjustedPoints,identities,kPolylineTypeGeneric);}else{identities=this.hGetIdentities(iId.mSeriesId,iId.mGroupId,points.length);canvas.CreateSVGPolylineWithCircles(iId.mSeriesId,adjustedPoints,identities);}break;}}},FinishDrawTickerShape:function FinishDrawTickerShape(startPoint,endPoint,iId){var points=[startPoint,endPoint],canvas=this.mCanvas;if(canvas instanceof mstrmojo.chart.SVGCanvas){var identities=this.hGetIdentities(iId.mSeriesId,iId.mGroupId,1);canvas.CreateSVGPolyLine(iId.mSeriesId,points,identities,5);}},FinishDrawStraightLine:function FinishDrawStraightLine(startPoint,endPoint,iId,identity,midPoint){var seriesCount=this.mDataset.GetSeriesCount(),points=[startPoint],canvas=this.mCanvas;points.push(endPoint);if(this.NeedAdjustedLinePath()){points=this.hAdjustLinePath(points);}if(canvas instanceof mstrmojo.chart.SVGCanvas){if(identity){if(iId.mObjectId===$GO.DssGraphTrendLine){canvas.CreateSVGPolyLineForTRLine(points,seriesCount,identity,true,startPoint,midPoint,endPoint);}else{if(iId.mObjectId===$GO.DssGraphReferenceLine){canvas.CreateSVGPolyLineForTRLine(points,seriesCount,identity,false,startPoint,midPoint,endPoint);}}}else{switch(iId.mObjectId){case $GO.DssGraphO1Body:case $GO.DssGraphO2Body:case $GO.DssGraphX1Body:case $GO.DssGraphX2Body:case $GO.DssGraphY1Body:case $GO.DssGraphY2Body:var identities=[];canvas.CreateSVGPolyLine(iId.mSeriesId,points,identities);return ;}identities=this.hGetIdentities(iId.mSeriesId,iId.mGroupId,1);identities.push(identities[0]);canvas.CreateSVGPolylineWithCircles(iId.mSeriesId,points,identities);}}},FinishDrawPolygon:function FinishDrawPolygon(points,highlightPos,iIds){var identity,canvas=this.mCanvas,pointsCount=points.length;if(pointsCount<3){return ;}if(canvas instanceof mstrmojo.chart.SVGCanvas){var adjustedPoints=points;if(this.NeedAdjustedLinePath()){adjustedPoints=this.hAdjustLinePath(points);}switch(highlightPos){case $APS.NORMAL:identity=this.hGetIdentity(iIds.mSeriesId,iIds.mGroupId);canvas.CreateSVGPolygon(iIds.mSeriesId,adjustedPoints,identity);break;case $APS.TOOLTIP_UPPER:if((pointsCount&1)!==0){return ;}identity=this.hGetIdentities(iIds.mSeriesId,iIds.mGroupId,pointsCount/2);canvas.CreateSVGPolygonWithCircles(iIds.mSeriesId,adjustedPoints,identity);break;case $APS.TOOLTIP_U2L:if((pointsCount&1)!==0){return ;}identity=this.hGetIdentities(iIds.mSeriesId,iIds.mGroupId,pointsCount/2);canvas.CreateSVGPolygonWithRects(iIds.mSeriesId,adjustedPoints,identity);break;case $APS.TOOLTIP_TRAPEZOID:if((pointsCount&1)!==0){return ;}identity=this.hGetIdentities(iIds.mSeriesId,iIds.mGroupId,pointsCount/2);canvas.CreateSVGPolygonWithTrapezoid(iIds.mSeriesId,adjustedPoints,identity);break;default:canvas.CreateSVGPolygon(iIds.mSeriesId,adjustedPoints);break;}}},allowOverlapBetweenDatalabels:function(){var dataset=this.mDataset;return dataset&&dataset.allowDatalabelOverlap();},hGetLabelIdentity:function hGetLabelIdentity(tripleId){var result={identity:null,type:"data-label"};switch(tripleId.mObjectId){case $GO.DssGraph2DO1Label:case $GO.DssGraph2DO2Label:case $GO.DssGraphY1Label:case $GO.DssGraphY2Label:case $GO.DssGraphX2Label:case $GO.DssGraphX1Label:result.type="axis-text";break;case $GO.DssGraphUserLabel1:case $GO.DssGraphUserLabel2:case $GO.DssGraphUserLabel3:case $GO.DssGraphUserLabel4:var index=tripleId.mObjectId-$GO.DssGraphUserLabel1;result.identity=this.hGetIdentityEx(index,0,"origin-label");result.type=index<=1?$CtrlType.GM_ORIGIN_LABEL_H:$CtrlType.GM_ORIGIN_LABEL_V;break;case $GO.DssGraphRefLineText:result.type="ref-label";break;case $GO.DssGraphTrendLineText:result.type="trend-label";break;default:var identity=null;if(tripleId.mSeriesId>=0&&tripleId.mGroupId>=0){if(tripleId.angleByIndex!==undefined){identity=this.hGetPieIdentityEx(tripleId.mSeriesId,tripleId.mGroupId,tripleId.angleByIndex,tripleId.sliceById,"data-label");}else{identity=this.hGetIdentityEx(tripleId.mSeriesId,tripleId.mGroupId,"data-label");}}result.identity=identity;break;}return result;},FinishDrawText:function FinishDrawText(tripleId,props){var canvas=this.mCanvas;if(canvas instanceof mstrmojo.chart.SVGCanvas){switch(tripleId.mObjectId){case $GO.DssGraph2DO1Label:case $GO.DssGraph2DO2Label:case $GO.DssGraphY1Label:case $GO.DssGraphY2Label:case $GO.DssGraphX2Label:case $GO.DssGraphX1Label:canvas.CreateSVGAxisText(tripleId.mSeriesId,props.Tooltip,props.Identities);break;case $EGO.DssGraphBanner:if(!props.Identities){props.Identities=this.hGetIdentities(tripleId.mSeriesId,tripleId.mGroupId,1);}canvas.CreateSVGBannerText(tripleId.mSeriesId,props.Identities);break;default:var result=this.hGetLabelIdentity(tripleId);var seriesCount=this.mDataset.GetSeriesCount();if(result.type==="ref-label"){result.identity=props.Identity;}canvas.CreateSVGGenericText(seriesCount,result.identity,result.type);break;}}},FinishDrawCurves:function FinishDrawCurves(points,iIds,identity,start,mid,end){var seriesCount=this.mDataset.GetSeriesCount(),seriesId=iIds.mSeriesId,canvas=this.mCanvas,i;if(canvas instanceof mstrmojo.chart.SVGCanvas){canvas.CreateSVGCurves(points,seriesCount,seriesId,identity,iIds.mObjectId===$GO.DssGraphTrendLine,start,mid,end);}},hGetIdentities:function hGetIdentities(iSeriesId,iGroupId,iCount){var identities=[],i;for(i=0;i<iCount;++i){var identity=this.hGetIdentity(iSeriesId,iGroupId+i);identities.push(identity);}return identities;},hGetPieIdentity:function hGetPieIdentity(seriesId,groupId,angleId,sliceId){if(seriesId<0){seriesId=0;}if(groupId<0){groupId=0;}if(angleId===undefined||angleId<0){angleId=0;}if(sliceId===undefined||sliceId<0){sliceId=0;}return this.mDataset.dataProvider.getGraphCell(seriesId,groupId).getSliceIdentity(angleId,sliceId);},hGetIdentity:function hGetIdentity(iSeriesId,iGroupId){if(iSeriesId<0){iSeriesId=0;}if(iGroupId<0){iGroupId=0;}return this.mDataset.dataProvider.getGraphCell(iSeriesId,iGroupId).getIdentity();},hGetIdentityEx:function hGetIdentityEx(iSeriesId,iGroupId,type){type=type||"generic";if(iSeriesId<0){iSeriesId=0;}if(iGroupId<0){iGroupId=0;}var dataProvider=this.mDataset.dataProvider;switch(type){case"data-label":return dataProvider.getGraphCell(iSeriesId,iGroupId).getDataLabelIdentity();case"marker":return dataProvider.getGraphCell(iSeriesId,iGroupId).getMarkerIdentity();case"originLine":case"origin-label":var keys=["y1","y2","x1","x2"],key=keys[iSeriesId]||"y1";if(type==="originLine"){return dataProvider.getAxisOriginLineIdentity(key);}return dataProvider.getAxisOriginLabelIdentity(key);default:return this.hGetIdentity(iSeriesId,iGroupId);}},hGetPieIdentityEx:function hGetPieIdentityEx(seriesId,groupId,angleId,sliceId,type){if(seriesId<0){seriesId=0;}if(groupId<0){groupId=0;}if(angleId===undefined||angleId<0){angleId=0;}if(sliceId===undefined||sliceId<0){sliceId=0;}var dataset=this.mDataset;switch(type){case"data-label":var gc=dataset.dataProvider.getGraphCell(seriesId,groupId);if(!!gc){if(gc.isFaked){gc=dataset.dataProvider.innerGetGraphCell(seriesId,groupId);}var PieDPS=gc.getSinglePieDPs();if(!!PieDPS){return PieDPS[angleId].getDataLabelIdentity(sliceId,true);}}break;default:return this.hGetPieIdentity(seriesId,groupId,angleId,sliceId);}},getIdentity:function getIdentity(Id,shapeType,identityType){identityType=identityType||"shape";var results=[],oneIdentity;if(shapeType==="pie"){var dataset=this.mDataset,pieCount=0,sliceCount=0,i,j;if(dataset){pieCount=dataset.GetPieCountAtOneDataPoint(Id.mSeriesId,Id.mGroupId);sliceCount=dataset.GetPieSliceCount(Id.mSeriesId,Id.mGroupId);}for(i=0;i<pieCount;i++){for(j=0;j<sliceCount;j++){oneIdentity=this.hGetPieIdentityEx(Id.mSeriesId,Id.mGroupId,i,j,identityType);results.push(oneIdentity);}}}else{oneIdentity=this.hGetIdentityEx(Id.mSeriesId,Id.mGroupId,identityType);results.push(oneIdentity);}return results;},hAdjustLinePath:function hAdjustLinePath(iPoints){var pointsCount=iPoints.length,previousIndex,nextIndex,i;var adjustedPoints=$HASH.cloneArray(iPoints);previousIndex=pointsCount-1;for(i=0;i<pointsCount;++i){nextIndex=(i+1===pointsCount)?0:i+1;if(iPoints[i].x===iPoints[previousIndex].x||iPoints[i].x===iPoints[nextIndex].x){adjustedPoints[i].x+=0.5;}if(iPoints[i].y===iPoints[previousIndex].y||iPoints[i].y===iPoints[nextIndex].y){adjustedPoints[i].y+=0.5;}previousIndex=i;}return adjustedPoints;},NewPath:function NewPath(){this.mCanvas.NewPath();},ClosePath:function ClosePath(){this.mCanvas.ClosePath();},SetFontAntiAlias:function SetFontAntiAlias(iFontAntiAlias){this.mIsFontAntiAlias=iFontAntiAlias;},SaveSurfaceToObject:function SaveSurfaceToObject(iGraphDesc){return this.mCanvas.SaveToObject(iGraphDesc);},CalculateDepthOffset:function CalculateDepthOffset(iDepth,iAngle,iAbsoluteDepth){var lDepthRatio=0,lCosA=Math.cos($GMM.DegreeToRadian(iAngle)),lSinA=Math.sin($GMM.DegreeToRadian(iAngle)),lOffsetX,lOffsetY,lMajorAxis,lMinorAxis;if(iAbsoluteDepth===undefined){iAbsoluteDepth=false;}if(iAbsoluteDepth){lDepthRatio=1/Math.sqrt(Math.pow(this.mGraphWidth*lCosA,2)+Math.pow(this.mGraphHeight*lSinA,2));}else{lDepthRatio=sDepthRatio/sMaxDepthValue;}lMajorAxis=this.mGraphWidth*lDepthRatio*iDepth;lMinorAxis=this.mGraphHeight*lDepthRatio*iDepth;lOffsetX=Math.floor(lMajorAxis*lCosA+0.5);lOffsetY=-Math.floor(lMinorAxis*lSinA+0.5);return{OffsetX:lOffsetX,OffsetY:lOffsetY};},hApplyEnhancedSeriesEffect:function hApplyEnhancedSeriesEffect(ioFormatFill,iCollectionType){if(this.mIsGraphMatrix){return ;}var enhancedSeriesEffect=ioFormatFill.EnhancedSeriesEffect,lValue,lAlpha;switch(this.mGraphType){case $GT.DssGraphTypePies:case $GT.DssGraphTypeMultiple_Pies:case $GT.DssGraphTypeMultiple_Proportional:case $GT.DssGraphTypeX_Y_Scatter:case $GT.DssGraphTypeDualAxis_X_Y_Scatter:case $GT.DssGraphTypeX_Y_Scatter_with_Labels:case $GT.DssGraphTypeDualAxis_X_Y_Scatter_with_Labels:case $GT.DssGraphTypeBubble:case $GT.DssGraphTypeBubble_DualAxis:case $GT.DssGraphTypeBubble_With_Labels:case $GT.DssGraphTypeBubble_DualAxis_With_Labels:enhancedSeriesEffect.call(ioFormatFill,204,$BE.DssGraphFillBevelSphere,0,270,10);break;case $GT.DssGraphTypeRing_Pie:case $GT.DssGraphTypeMultiple_Ring_Pies:case $GT.DssGraphTypeMultiple_Proportional_Ring_Pies:enhancedSeriesEffect.call(ioFormatFill,204,$BE.DssGraphFillBevelDonut,50,0,30);break;default:var colType=$CHART_ENUMS.EnumCollectionType;switch(iCollectionType){case colType.CT_VERTICAL_AREA:enhancedSeriesEffect.call(ioFormatFill,204,$BE.DssGraphFillBevelSphere,0,270,20);break;case colType.CT_VERTICAL_BAR:lAlpha=204;lValue=this.GetProperty($GP.DssGraphDepthMode,$NTID);if(this.isVerticalBar()&&lValue){lAlpha=255;}enhancedSeriesEffect.call(ioFormatFill,lAlpha,$BE.DssGraphFillBevelDonut,50,0,30);break;case colType.CT_HORIZONTAL_AREA:enhancedSeriesEffect.call(ioFormatFill,204,$BE.DssGraphFillBevelSphere,0,180,20);break;case colType.CT_HORIZONTAL_BAR:enhancedSeriesEffect.call(ioFormatFill,204,$BE.DssGraphFillBevelSphere,0,270,30);break;case colType.CT_DEPTH_LINE_OR_LINE_MARKER:enhancedSeriesEffect.call(ioFormatFill,204,$BE.DssGraphFillBevelSphere,0,270,10);break;default:break;}break;}},GetLocation:function GetLocation(iPropertyId){var lValue,lTopLeft,lBottomRight;lValue=this.GetProperty(iPropertyId,$NTID);if(lValue===null||lValue===undefined){return ;}lTopLeft=this.TDGToMSTRPoint(lValue.Left,lValue.Top);lBottomRight=this.TDGToMSTRPoint(lValue.Right,lValue.Bottom);return new $C.Rect2D({x:lTopLeft.x,y:lTopLeft.y,width:lBottomRight.x-lTopLeft.x,height:lBottomRight.y-lTopLeft.y});},GetLocationRect:function GetLocationRect(iPropertyId){var locRect,lRetValue;locRect=this.GetLocation(iPropertyId);if(locRect){lRetValue=new $C.Rect2D({x:locRect.Left,y:locRect.Top,width:locRect.Right-locRect.Left,height:locRect.Bottom-locRect.Top});}return lRetValue;},PutLocation:function PutLocation(iPropertyId,iRect){},GetProperty:function GetProperty(iPropertyId,iTripleId){if(this.mPropertyMap===null){return null;}return this.mPropertyMap.find([iPropertyId,this.MapObject(iTripleId.mObjectId),iTripleId.mSeriesId]);},GetLocalProperty:function GetLocalProperty(iPropertyId,iTripleId){if(this.mPropertyMap===null){return null;}return this.mPropertyMap.find([iPropertyId,this.MapObject(iTripleId.mObjectId),iTripleId.mSeriesId]);},PutProperty:function PutProperty(iPropertyId,iTripleId,iValue){if(this.mPropertyMap===null){this.mPropertyMap=new $C.common.MapStructure();}this.mPropertyMap.push([iPropertyId,this.MapObject(iTripleId.mObjectId),iTripleId.mSeriesId],iValue);if(iPropertyId===$GP.DssGraphType){this.mGraphType=iValue;}},normalDirection:function normalDirection(iSideDirection,iDepthDirection){var lValue=this.CalculateDepthOffset(1000,iDepthDirection),lOffsetX=lValue.OffsetX,lOffsetY=lValue.OffsetY,lDepthDirection=new $C.Vector2D({x:lOffsetX,y:lOffsetY}),lCrossProduct=lDepthDirection.CrossProduct(iSideDirection);if(lCrossProduct===0){return 0;}return lCrossProduct>0?1:-1;},IsVertical:function IsVertical(){switch(this.mGraphType){case $GT.DssGraphTypeVertical_Area_Absolute:case $GT.DssGraphTypeVertical_Area_Stacked:case $GT.DssGraphTypeVertical_Area_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Area_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Area_Percent:case $GT.DssGraphTypeVertical_Bar_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_Stacked:case $GT.DssGraphTypeVertical_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Bar_Percent:case $GT.DssGraphTypeVertical_Line_Absolute:case $GT.DssGraphTypeVertical_Line_Stacked:case $GT.DssGraphTypeVertical_Line_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Line_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Line_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Line_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Line_Percent:case $GT.DssGraphTypeVertical_Bar_Absolute:case $GT.DssGraphTypeVertical_Bar_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Bar_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Bar_DualAxis_Percent:case $GT.DssGraphTypeVertical_Line_DualAxis_Percent:case $GT.DssGraphTypeVertical_Area_DualAxis_Percent:case $GT.DssGraphTypeVertical_Bullet:case $GT.DssGraphTypeVertical_CategoryPies_Absolute:case $GT.DssGraphTypeVertical_CategoryPies_Percent:case $GT.DssGraphTypeVertical_CategoryPies_Stacked:case $GT.DssGraphTypeGrid_Pies:case $GT.DssGraphTypeScatter_Pies:case $GT.DssGraphTypeBubble_Pies:return true;}switch(this.GetGraphMajorType()){case $GMT.GMT_BUBBLE:case $GMT.GMT_SCATTER:case $GMT.GMT_STOCK:return true;}return false;},IsDualAxis:function IsDualAxis(){switch(this.mGraphType){case $GT.DssGraphTypeVertical_Area_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Line_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Line_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked:case $GT.DssGraphTypeDualAxis_X_Y_Scatter:case $GT.DssGraphTypeDualAxis_X_Y_Scatter_with_Labels:case $GT.DssGraphTypeDualAxis_Polar_Coordinate_Chart:case $GT.DssGraphTypeDualAxis_Radar_Line:case $GT.DssGraphTypeDualAxis_Radar_Stacked_Area:case $GT.DssGraphTypeBubble_DualAxis:case $GT.DssGraphTypeHiLo_DualAxis_Stock_Chart:case $GT.DssGraphTypeHiLoOpen_DualAxis_Stock_Chart:case $GT.DssGraphTypeHiLoOpenClose_DualAxis_Stock_Chart:case $GT.DssGraphTypeBubble_DualAxis_With_Labels:case $GT.DssGraphTypeVertical_Bar_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Absolute:case $GP.DssGraphRadar_DualAxis_Radar_Stacked_Line:case $GP.DssGraphRadar_DualAxis_Radar_Area:case $GT.DssGraphTypeVertical_Area_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Line_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Line_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Bar_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Bar_DualAxis_Percent:case $GT.DssGraphTypeVertical_Line_DualAxis_Percent:case $GT.DssGraphTypeVertical_Area_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent:return true;default:return false;}},IsStackedChart:function IsStackedChart(){switch(this.mGraphType){case $GT.DssGraphTypeVertical_Area_Stacked:case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Area_Stacked:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Bar_Stacked:case $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Bar_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Line_Stacked:case $GT.DssGraphTypeVertical_Line_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Line_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Line_Stacked:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked:case $GT.DssGraphTypeRadar_Stacked_Area:case $GT.DssGraphTypeDualAxis_Radar_Stacked_Area:case $GT.DssGraphTypeRadar_Area_Stacked:case $GP.DssGraphRadar_Line_Stacked:case $GP.DssGraphRadar_DualAxis_Radar_Stacked_Line:return true;default:return false;}},IsPieChart:function IsPieChart(){if(this.mIsGraphMatrix){switch(this.GetGraphMatrixContext().mGraphType){case $GT.DssGraphTypeVertical_CategoryPies_Absolute:case $GT.DssGraphTypeVertical_CategoryPies_Percent:case $GT.DssGraphTypeVertical_CategoryPies_Stacked:case $GT.DssGraphTypeHorizontal_CategoryPies_Absolute:case $GT.DssGraphTypeHorizontal_CategoryPies_Percent:case $GT.DssGraphTypeHorizontal_CategoryPies_Stacked:case $GT.DssGraphTypeGrid_Pies:case $GT.DssGraphTypeScatter_Pies:case $GT.DssGraphTypeBubble_Pies:return true;default:return false;}}else{return this.GetGraphMajorType()===$GMT.GMT_PIE;}},MapObject:function MapObject(iObjectId){if(iObjectId===$GP.DssGraphPieSlice){return $GP.DssGraphRiser;}return iObjectId;},SplitRect:function SplitRect(iRect,iIsVertical,iPercentage,oRectTopRight,oRectBottomLeft){var lHeight,lWidth;if(iIsVertical){lHeight=iRect.height*iPercentage/100;oRectTopRight.Reset(iRect.x,iRect.y,iRect.width,iRect.height-lHeight);oRectBottomLeft.Reset(iRect.x,iRect.y+oRectTopRight.height,iRect.width,lHeight);}else{lWidth=iRect.width*iPercentage/100;oRectTopRight.Reset(iRect.x+lWidth,iRect.y,iRect.width-lWidth,iRect.height);oRectBottomLeft.Reset(iRect.x,iRect.y,lWidth,iRect.height);}},getAxisAutoNumberFormat:function getAxisAutoNumberFormat(orFormat,list,resolved){resolved=resolved||false;var dataset=this.mDataset,i;if(list&&list.length){var cachedNumberFormat=this.mSelectedAxisAutoNumberFormat;if(cachedNumberFormat.Format!==null){var equal=true,keyList=cachedNumberFormat.Array;if(keyList&&keyList.length===list.length){for(i=0;i<keyList.length;keyList++){if(keyList[i]!==list[i]){equal=false;break;}}}if(equal){orFormat.reset(cachedNumberFormat.Format);return ;}}dataset.getValueAxisNumberFormat(orFormat,list,resolved);cachedNumberFormat.Array=list.slice(0);cachedNumberFormat.Format=new $C.ChartAdvFormat({ChartAdvFormat:orFormat});}else{var cachedFormat=this.mAxisAutoNumberFormat;if(cachedFormat!==null){orFormat.reset(cachedFormat);}else{dataset.getValueAxisNumberFormat(orFormat);this.mAxisAutoNumberFormat=new $C.ChartAdvFormat({ChartAdvFormat:orFormat});}}},GetGraphMajorType:function GetGraphMajorType(){switch(this.mGraphType){case $GT.DssGraphTypeVertical_Area_Absolute:case $GT.DssGraphTypeVertical_Area_Stacked:case $GT.DssGraphTypeVertical_Area_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Area_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Area_Percent:case $GT.DssGraphTypeHorizontal_Area_Absolute:case $GT.DssGraphTypeHorizontal_Area_Stacked:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Area_Percent:case $GT.DssGraphTypeVertical_Bar_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_Stacked:case $GT.DssGraphTypeVertical_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Bar_Percent:case $GT.DssGraphTypeHorizontal_Bar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_Percent:case $GT.DssGraphTypeVertical_Line_Absolute:case $GT.DssGraphTypeVertical_Line_Stacked:case $GT.DssGraphTypeVertical_Line_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Line_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Line_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Line_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Line_Percent:case $GT.DssGraphTypeHorizontal_Line_Absolute:case $GT.DssGraphTypeHorizontal_Line_Stacked:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Line_Percent:case $GT.DssGraphTypeVertical_Bar_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Bar_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Bullet:case $GT.DssGraphTypeHorizontal_Bullet:case $GT.DssGraphTypeVertical_Bar_DualAxis_Percent:case $GT.DssGraphTypeVertical_Line_DualAxis_Percent:case $GT.DssGraphTypeVertical_Area_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_CategoryPies_Absolute:case $GT.DssGraphTypeHorizontal_CategoryPies_Stacked:case $GT.DssGraphTypeHorizontal_CategoryPies_Percent:case $GT.DssGraphTypeVertical_CategoryPies_Absolute:case $GT.DssGraphTypeVertical_CategoryPies_Stacked:case $GT.DssGraphTypeVertical_CategoryPies_Percent:return $GMT.GMT_CATEGORY;case $GT.DssGraphTypePies:case $GT.DssGraphTypeRing_Pie:case $GT.DssGraphTypeMultiple_Pies:case $GT.DssGraphTypeMultiple_Ring_Pies:case $GT.DssGraphTypeMultiple_Proportional:case $GT.DssGraphTypeMultiple_Proportional_Ring_Pies:case $GT.DssGraphTypePie_Bar:case $GT.DssGraphTypeRing_Pie_Bar:return $GMT.GMT_PIE;case $GT.DssGraphTypeScatter_Pies:case $GT.DssGraphTypeX_Y_Scatter:case $GT.DssGraphTypeDualAxis_X_Y_Scatter:case $GT.DssGraphTypeX_Y_Scatter_with_Labels:case $GT.DssGraphTypeDualAxis_X_Y_Scatter_with_Labels:return $GMT.GMT_SCATTER;case $GT.DssGraphTypeBubble_Pies:case $GT.DssGraphTypeBubble:case $GT.DssGraphTypeBubble_DualAxis:case $GT.DssGraphTypeBubble_With_Labels:case $GT.DssGraphTypeBubble_DualAxis_With_Labels:return $GMT.GMT_BUBBLE;case $GT.DssGraphTypeVertical_Bar_Absolute:case $GT.DssGraphTypeHorizontal_Bar_Absolute:return $GMT.GMT_CATEGORY;case $GT.DssGraphTypeGrid_Pies:case $GT.DssGraphTypeGridChart:return $GMT.GMT_GRID;case $GT.DssGraphTypeMaxDeskTopGraphTypes:return $GMT.GMT_INVALID;default:return $GMT.GMT_INVALID;}},isLegendByGroup:function isLegendByGroup(){return false;},isVerticalBar:function isVerticalBar(){switch(this.mGraphType){case $GT.DssGraphTypeVertical_Bar_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_Stacked:case $GT.DssGraphTypeVertical_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Bar_Percent:case $GT.DssGraphTypeVertical_Bar_DualAxis_Percent:case $GT.DssGraphTypeVertical_Bullet:return true;default:return false;}},MoveTo:function MoveTo(iX,iY,iIsCurveAnimation,iBasePoint){this.mCanvas.MoveTo(iX,iY,iIsCurveAnimation,iBasePoint);},BezierCurveTo:function BezierCurveTo(iCP1X,iCP1Y,iCP2X,iCP2Y,iX,iY){this.mCanvas.BezierCurveTo(iCP1X,iCP1Y,iCP2X,iCP2Y,iX,iY);},LineTo:function LineTo(iX,iY,iIsCurveAnimation,iBasePoint){this.mCanvas.LineTo(iX,iY,iIsCurveAnimation,iBasePoint);},hMoveTo:function hMoveTo(iX,iY,iIsLinePath,iIsCurveAnimation,iBasePoint){var lOffset;lOffset=(iIsLinePath&&this.NeedAdjustedLinePath())?0.5:0;this.MoveTo(iX+lOffset,iY+lOffset,iIsCurveAnimation,iBasePoint);},hLineTo:function hLineTo(iX,iY,iIsLinePath,iIsCurveAnimation,iBasePoint){var lOffset;lOffset=(iIsLinePath&&this.NeedAdjustedLinePath())?0.5:0;this.LineTo(iX+lOffset,iY+lOffset,iIsCurveAnimation,iBasePoint);},SetRGBAFill:function SetRGBAFill(iRed,iGreen,iBlue,iAlpha){this.mCanvas.SetRGBAFillColor(iRed,iGreen,iBlue,iAlpha);},SetRGBAStroke:function SetRGBAStroke(iRed,iGreen,iBlue,iAlpha){this.mCanvas.SetRGBAStrokeColor(iRed,iGreen,iBlue,iAlpha);},FillPath:function FillPath(){this.mCanvas.FillPath();},StrokePath:function StrokePath(){this.mCanvas.StrokePath();},SetLineDash:function SetLineDash(ipLinePattern,iDashNumber){this.mCanvas.SetLineDash(ipLinePattern,iDashNumber);},SetLineWidth:function SetLineWidth(iLineWidth){this.mCanvas.SetLineWidth(iLineWidth);},SetFormatManager:function SetFormatManager(iFormatManager){var lType;this.mFormatManager=iFormatManager;lType=this.mFormatManager.GetFormat($GP.DssGraphType);this.mGraphType=lType+1;this.mFormatManager.SetGraphType(this.mGraphType);this.mIsFontAntiAlias=true;},SetFontSize:function SetFontSize(iFontSize){this.mCanvas.SetFontSize(iFontSize);},PtSizeToPixelSize:function PtSizeToPixelSize(iPtSize){return Math.floor(iPtSize*sDPI/sPOINTSOFONEINCH+0.5);},IsReverseSeriesOrder:function IsReverseSeriesOrder(iValueAxis,iIsVertical,iDepthDirection){var lResult;if(iValueAxis===null){return false;}lResult=iValueAxis.IsReverseOrder();if((iIsVertical&&iDepthDirection>=180&&iDepthDirection<360)||(!iIsVertical&&iDepthDirection>=90&&iDepthDirection<270)){lResult=!lResult;}return lResult;},IsReverseGroupOrder:function IsReverseGroupOrder(iIsVertical,iDepthDirection){return((iIsVertical&&iDepthDirection>=90&&iDepthDirection<270)||(!iIsVertical&&iDepthDirection>=0&&iDepthDirection<180));},GetPointByAngleRadiusCenter:function GetPointByAngleRadiusCenter(iAngle,iRadius,iCenter){return new $C.Point2D({x:Math.floor(iCenter.x+iRadius*Math.cos(iAngle)+0.5),y:Math.floor(iCenter.y-iRadius*Math.sin(iAngle)+0.5)});},RectangleIntersection:function RectangleIntersection(iRectA,iRectB,orRect){var lX,lY,lWidth,lHeight;if((iRectA.x>(iRectB.x+iRectB.width))||(iRectB.x>(iRectA.x+iRectA.width))||(iRectA.y>(iRectB.y+iRectB.height))||(iRectB.y>(iRectA.y+iRectA.height))){return false;}lX=Math.max(iRectA.x,iRectB.x);lY=Math.max(iRectA.y,iRectB.y);lWidth=Math.min(iRectA.x+iRectA.width,iRectB.x+iRectB.width)-lX;lHeight=Math.min(iRectA.y+iRectA.height,iRectB.y+iRectB.height)-lY;orRect.Reset(lX,lY,lWidth,lHeight);return true;},RectangleUnion:function RectangleUnion(iRectA,iRectB,orRect){var lX,lY,lWidth,lHeight;lX=Math.min(iRectA.x,iRectB.x);lY=Math.min(iRectA.y,iRectB.y);lWidth=Math.max(iRectA.x+iRectA.width,iRectB.x+iRectB.width)-lX;lHeight=Math.max(iRectA.y+iRectA.height,iRectB.y+iRectB.height)-lY;orRect.Reset(lX,lY,lWidth,lHeight);},getUniformAxisLabelRotateMode:function(axisTag){var key=axisTag,uaCtx=this.getUniformAxisContext();switch(axisTag){case"x":case"X":key="X1";break;case"y":case"Y":key="Y1";break;default:break;}return uaCtx.mLabelRotation[key];},getUniformAxisContext:function getUniformAxisContext(){if(this.mUniformAxisContext===null){this.mUniformAxisContext={mDataAreaLeftMargin:0,mDataAreaRightMargin:0,mDataAreaTopMargin:0,mDataAreaBottomMargin:0,mGraphHeight:400,mIsAxisTitleAndLabelRequired:true,mLabelRotation:{X1:-1,Y1:-1,X2:-1,Y2:-1},xDataLabelPadding:0,yDataLabelPadding:0,ValueAxis:{X1:{Valid:true,Min:0,Max:0,Metrics:[],Trims:[0,0],PerCell:false,CustomScale:false,AutoMin:false,AutoMax:false},X2:{Valid:true,Min:0,Max:0,Metrics:[],Trims:[0,0],PerCell:false,CustomScale:false,AutoMin:false,AutoMax:false},Y1:{Valid:true,Min:0,Max:0,Metrics:[],Trims:[0,0],PerCell:false,CustomScale:false,AutoMin:false,AutoMax:false},Y2:{Valid:true,Min:0,Max:0,Metrics:[],Trims:[0,0],PerCell:false,CustomScale:false,AutoMin:false,AutoMax:false},Z:{Valid:true,Min:0,Max:0,Metrics:[],Trims:[0,0],PerCell:false,CustomScale:false,AutoMin:false,AutoMax:false}},CategoryAxis:{X:{EnforceFringe:false,EnforceCluster:false,Trims:[0,0]},Y:{EnforceFringe:false,EnforceCluster:false,Trims:[0,0]}}};}return this.mUniformAxisContext;},isUADataAreaOutput:function isUADataAreaOutput(){if(this.mIsUniformAxisMode){var lUAContext=this.getUniformAxisContext();if(!lUAContext.mIsAxisTitleAndLabelRequired){return true;}}return false;},IsBackgroundBright:function IsBackgroundBright(){var frameAlpha,backgroundAlpha,combinedAlpha,frameColorR,frameColorG,frameColorB,backgroundColorR,backgroundColorG,backgroundColorB,combinedColorR,combinedColorG,combinedColorB,tripleId,value,brightness;tripleId=new $C.TripleId({ObjectId:$GP.DssGraphFrame,SeriesId:$NSID,GroupId:$NULL_GROUP_ID});value=this.hGetColorById(tripleId);frameAlpha=value.Alpha;frameColorR=value.R;frameColorG=value.G;frameColorB=value.B;tripleId.reset($GP.DssGraphBackground,$NSID,$NULL_GROUP_ID);value=this.hGetColorById(tripleId);backgroundAlpha=value.Alpha;backgroundColorR=value.R;backgroundColorG=value.G;backgroundColorB=value.B;combinedAlpha=1-(1-frameAlpha)*(1-backgroundAlpha);if(combinedAlpha>0.5){combinedColorR=backgroundColorR*backgroundAlpha*(1-frameAlpha)+frameColorR*frameAlpha;combinedColorG=backgroundColorG*backgroundAlpha*(1-frameAlpha)+frameColorG*frameAlpha;combinedColorB=backgroundColorB*backgroundAlpha*(1-frameAlpha)+frameColorB*frameAlpha;}brightness=(combinedColorR*299+combinedColorG*587+combinedColorB*114)/1000;return brightness>150;},hGetColorById:function hGetColorById(iTripleId){var startGraphColor,endGraphColor,alpha=1,r=255,g=255,b=255,value;value=this.GetProperty($GP.DssGraphAreaAlpha,iTripleId);if(value){alpha=value/255;}value=this.GetProperty($GP.DssGraphFillEffect,iTripleId);if(value){switch(value){case $FE.DssGraphFillSimple:value=this.GetProperty($GP.DssGraphAreaColor,iTripleId);if(value){var kColorParser=$GMM.GetColorParser();kColorParser.ResetFromColorValue(value,true);r=kColorParser.mR;g=kColorParser.mG;b=kColorParser.mB;}break;case $FE.DssGraphFillAdvancedWash:value=this.GetProperty($GP.DssGraphGradient,iTripleId);if(value){startGraphColor=value.StartColor;endGraphColor=value.EndColor;r=(startGraphColor.mR+endGraphColor.mR)/2;g=(startGraphColor.mG+endGraphColor.mG)/2;b=(startGraphColor.mB+endGraphColor.mB)/2;}break;default:break;}}return{R:r,G:g,B:b,Alpha:alpha};},FillSimple:function FillSimple(iFill,iDarkerFactor,iColor,iHasExtraPara){this.mCanvas.FillSimple(iFill,iDarkerFactor,iColor,iHasExtraPara);},FillPattern:function FillPattern(iFill){this.mCanvas.FillPattern(iFill);},FillGradient:function FillGradient(iFill,iBoundingRect,iDarkerFactor){this.mCanvas.FillGradient(iFill,iBoundingRect,iDarkerFactor);},FillEdgeType:function FillEdgeType(iFill,iPolygon){this.mCanvas.FillEdgeType(iFill,iPolygon);},FillDonutOrSphere:function FillDonutOrSphere(iFill,iBoundingRect,iIsCircularShape){this.mCanvas.FillDonutOrSphere(iFill,iBoundingRect,iIsCircularShape);},FillBorderMetallic:function FillBorderMetallic(ipFill,iBorderUse,iCPX,iCPY,iRadius,iThickness){this.mCanvas.FillBorderMetallic(ipFill,iBorderUse,iCPX,iCPY,iRadius,iThickness);},FillRadientGradient:function FillRadientGradient(iFill,iRGUsage,iCPX,iCPY,iInnerRadius,iOuterRadius,iHasExtraPara,iExtraDepth,iExtraIntensity){this.mCanvas.FillRadientGradient(iFill,iRGUsage,iCPX,iCPY,iInnerRadius,iOuterRadius,iHasExtraPara,iExtraDepth,iExtraIntensity);},MakeDarker:function MakeDarker(iFill,iFactor){this.mCanvas.MakeDarker(iFill,iFactor);},RestoreColor:function RestoreColor(iFill){this.mCanvas.RestoreColor(iFill);},ApplyLineFormat:function ApplyLineFormat(iLine){this.mCanvas.ApplyLineFormat(iLine);},AddFormatedText:function AddFormatedText(iFont,iStartPoint,iString,props){this.mCanvas.AddFormatedText(iFont,iStartPoint,iString,props);},BeginFirstFrame:function BeginFirstFrame(){this.mCanvas.BeginFirstFrame();},BeginLastFrame:function BeginLastFrame(){this.mCanvas.BeginLastFrame();},EndFrame:function EndFrame(){this.mCanvas.EndFrame();},EndUnit:function EndUnit(){this.mCanvas.EndUnit();},SetLineJoin:function SetLineJoin(iLineJoinType){this.mLineJoinType=iLineJoinType;this.mCanvas.SetLineJoin(this.mLineJoinType);},GetLineJoin:function GetLineJoin(){return this.mLineJoinType;},UpdateFormatLine:function UpdateFormatLine(irTripleId,iopFormatLine,useResolvedFormat){useResolvedFormat=useResolvedFormat||false;if(this.mIsGraphMatrix){return ;}var value;$Utility.tripleId.reset(perfQueryTripleId,irTripleId.mObjectId,irTripleId.mSeriesId,irTripleId.mGroupId);if(this.mIsGraphMatrix&&perfQueryTripleId.mObjectId===$GP.DssGraphX1Major){perfQueryTripleId.mObjectId=$GP.DssGraphY1Major;}if(iopFormatLine.mLineColor===null||!useResolvedFormat){value=this.GetProperty($GP.DssGraphLineColor,perfQueryTripleId);if(value){var kColorParser=$GMM.GetColorParser();kColorParser.ResetFromColorValue(value,true);iopFormatLine.mLineColor=kColorParser.ToInteger();}}if(iopFormatLine.mLineStyle===null||!useResolvedFormat){value=this.GetProperty($GP.DssGraphLinePattern,perfQueryTripleId);if(value){iopFormatLine.mLineStyle=value;}}if(iopFormatLine.mAlpha===null||!useResolvedFormat){value=this.GetProperty($GP.DssGraphLineAlpha,perfQueryTripleId);if(value){iopFormatLine.mAlpha=value;}}if(iopFormatLine.mLineThicknessPt===null||!useResolvedFormat){value=this.GetProperty($GP.DssGraphLineWidth,perfQueryTripleId);if(value){iopFormatLine.mLineThicknessPt=value;}}},UpdateFormatFill:function UpdateFormatFill(irTripleId,irFormatFill,collectionType,useResolvedFormat){useResolvedFormat=useResolvedFormat||false;if(this.mIsGraphMatrix){return ;}var value;$Utility.tripleId.reset(perfQueryTripleId,irTripleId.mObjectId,irTripleId.mSeriesId,irTripleId.mGroupId);perfQueryTripleId.mObjectId=this.MapObject(irTripleId.mObjectId);if(irFormatFill.mAlpha===null||!useResolvedFormat){value=this.GetProperty($GP.DssGraphAreaAlpha,perfQueryTripleId);if(value!==null&&value!==undefined){irFormatFill.mAlpha=value;}}var kColorParser;if(irFormatFill.mFillType===null||!useResolvedFormat){value=this.GetProperty($GP.DssGraphFillEffect,perfQueryTripleId);if(value!==null&&value!==undefined){irFormatFill.mFillType=value;}var fillEffect=irFormatFill.mFillType;switch(fillEffect){case $FE.DssGraphFillSimple:value=this.GetProperty($GP.DssGraphAreaColor,perfQueryTripleId);if(value!==null&&value!==undefined){if(irFormatFill.mSimpleColor===null||!useResolvedFormat){kColorParser=$GMM.GetColorParser();kColorParser.ResetFromColorValue(value,true);irFormatFill.mSimpleColor=kColorParser.ToInteger();}}break;case $FE.DssGraphFillAdvancedWash:var fillGradient=irFormatFill.mFillGradient;value=this.GetProperty($GP.DssGraphGradient,perfQueryTripleId);if(value!==null&&value!==undefined){if(fillGradient===null||!useResolvedFormat){if(fillGradient===null){irFormatFill.mFillGradient={};}fillGradient=irFormatFill.mFillGradient;$HASH.copyProps(["gradientType","angle","horizontalOffset","verticalOffset"],value,fillGradient);kColorParser=$GMM.GetColorParser();kColorParser.ResetFromColorValue(value.StartColor,true);fillGradient.startGraphColor=kColorParser.ToInteger();kColorParser.ResetFromColorValue(value.EndColor,true);fillGradient.endGraphColor=kColorParser.ToInteger();}}value=this.GetProperty($GP.DssGraphGradientEndAlpha,perfQueryTripleId);if(value!==null&&value!==undefined){if(fillGradient.endAlpha===null||!useResolvedFormat){fillGradient.endAlpha=value;}}else{fillGradient.endAlpha=irFormatFill.mAlpha;}break;case $FE.DssGraphFillPattern:break;default:break;}}},UpdateFormatFont:function UpdateFormatFont(irTripleId,iopFormatFont){var value;if(this.mIsGraphMatrix){return ;}value=this.GetProperty($GP.DssGraphFontColor,irTripleId);if(value){var kColorParser=$GMM.GetColorParser();kColorParser.ResetFromColorValue(value,true);iopFormatFont.mFontColor=kColorParser.ToInteger();}value=this.GetProperty($GP.DssGraphFontName,irTripleId);if(value){iopFormatFont.mFontName=value;}value=this.GetProperty($GP.DssGraphFontSize100,irTripleId);if(value){iopFormatFont.mFontSize=Math.floor(value/100+0.5);}value=this.GetProperty($GP.DssGraphFontStyle,irTripleId);if(value){iopFormatFont.mFontStyle=value;}value=this.GetProperty($GP.DssGraphFontAlpha,irTripleId);if(value){iopFormatFont.mFontAlpha=value;}value=this.GetProperty($GP.DssGraphFontAlign,irTripleId);if(value){iopFormatFont.mFontAlignment=value;}value=this.GetProperty($GP.DssGraphFontRotation,irTripleId);if(value){iopFormatFont.mFontRotation=value;}value=this.GetProperty($GP.DssGraphFontBox,irTripleId);if(value){iopFormatFont.mFontBox=value;}},ParseValueToFormat:function ParseValueToFormat(irValue,orFormat){var strings=[],i,start,end,radix=10;start=0;for(i=0;i<6;++i){end=irValue.indexOf(",",start);strings[i]=irValue.substring(start,end);start=end+1;}strings[i]=irValue.substring(start);if(strings[0].length){orFormat.mFormatType=parseInt(strings[0],radix);}if(strings[1].length){orFormat.mDigits=parseInt(strings[1],radix);}if(strings[2].length){orFormat.mGrouping=parseInt(strings[2],radix);}if(strings[3].length){orFormat.mPosCurr=parseInt(strings[3],radix);}if(strings[4].length){orFormat.mNegFormat=parseInt(strings[4],radix);}if(strings[5].length){orFormat.mCurrency=strings[5];}if(strings[6].length){orFormat.mCustomFormat=strings[6];}},DrawSector:function DrawSector(irCenter,iRadius,iStartAngle,iEndAngle){this.NewPath();this.mCanvas.AddArc(irCenter.x,irCenter.y,iRadius,iStartAngle,iEndAngle,false);this.LineTo(irCenter.x,irCenter.y);this.ClosePath();},DrawRingSector:function DrawRingSector(irCenter,iOutRadius,iInRadius,iStartAngle,iEndAngle){this.NewPath();this.mCanvas.AddArc(irCenter.x,irCenter.y,iOutRadius,iStartAngle,iEndAngle,false);this.LineTo(irCenter.x+iInRadius*Math.cos(iEndAngle),irCenter.y+iInRadius*Math.sin(iEndAngle));this.mCanvas.AddArc(irCenter.x,irCenter.y,iInRadius,iEndAngle,iStartAngle,true);this.ClosePath();},DrawCylinder:function DrawCylinder(irCenter,iRadius,iStartAngle,iEndAngle,iDepth){console.alert("to be impl");},ApplyBeveledFrameToRectangle:function ApplyBeveledFrameToRectangle(irRect,iRotationAngle,iBevelDepth,irLTColor,iLTAlpha,irRBColor,iRBAlpha){this.mCanvas.ApplyBeveledFrameToRectangle(irRect,iRotationAngle,iBevelDepth,irLTColor,iLTAlpha,irRBColor,iRBAlpha);},drawArc:function drawArc(irCenter,iRadius,iStartAngle,iEndAngle,iNewPath){if(iNewPath===undefined){iNewPath=true;}if(iNewPath){this.NewPath();}this.mCanvas.AddArc(irCenter.x,irCenter.y,iRadius,iStartAngle,iEndAngle,false);},GetGraphMatrixContext:function GetGraphMatrixContext(){if(this.mpGraphMatrixContext===null){this.mpGraphMatrixContext=new $C.GraphMatrixContext({GraphType:this.mGraphType});if(this.mpGraphMatrixContext){this.mpGraphMatrixContext.mEstGraphHeight=this.mGraphHeight;this.mpGraphMatrixContext.mEstGraphWidth=this.mGraphWidth;}this.mpGraphMatrixContext.parentContext=this;}return this.mpGraphMatrixContext;},HideAxisElements:function HideAxisElements(iHide){this.mShouldHideAxisElements=iHide;},IsHidingAxisElements:function IsHidingAxisElements(){return this.mShouldHideAxisElements;},IsPercentChart:function IsPercentChart(){switch(this.mGraphType){case $GT.DssGraphTypeVertical_Bar_Percent:case $GT.DssGraphTypeHorizontal_Bar_Percent:case $GT.DssGraphTypeVertical_Area_Percent:case $GT.DssGraphTypeHorizontal_Area_Percent:case $GT.DssGraphTypeVertical_Line_Percent:case $GT.DssGraphTypeHorizontal_Line_Percent:case $GT.DssGraphTypeVertical_Bar_DualAxis_Percent:case $GT.DssGraphTypeVertical_Line_DualAxis_Percent:case $GT.DssGraphTypeVertical_Area_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent:return true;}return false;},IsGridChart:function IsGridChart(){return this.mGraphType===$GT.DssGraphTypeGridChart;},IsScatterChart:function IsScatterChart(){switch(this.mGraphType){case $GT.DssGraphTypeX_Y_Scatter:case $GT.DssGraphTypeDualAxis_X_Y_Scatter:case $GT.DssGraphTypeX_Y_Scatter_with_Labels:case $GT.DssGraphTypeDualAxis_X_Y_Scatter_with_Labels:return true;}return false;},IsBubbleChart:function IsBubbleChart(){switch(this.mGraphType){case $GT.DssGraphTypeBubble:case $GT.DssGraphTypeBubble_DualAxis:case $GT.DssGraphTypeBubble_With_Labels:case $GT.DssGraphTypeBubble_DualAxis_With_Labels:return true;}return false;},IsBulletChart:function IsBulletChart(){switch(this.mGraphType){case $GT.DssGraphTypeVertical_Bullet:case $GT.DssGraphTypeHorizontal_Bullet:return true;}return false;},IsBarChart:function IsBarChart(a){a=(a===undefined)?$CS._general:a;a=(a>=$CS._ring)?$CS._general:a;switch(this.mGraphType){case $GT.DssGraphTypeVertical_Bar_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeVertical_Bar_BiPolar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Side_by_Side:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Side_by_Side:return(a===$CS._general||a===$CS._cluster);case $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Bar_Stacked:case $GT.DssGraphTypeVertical_Bar_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_Stacked:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Stacked:return(a===$CS._general||a===$CS._stacked);case $GT.DssGraphTypeVertical_Bar_Percent:case $GT.DssGraphTypeHorizontal_Bar_Percent:case $GT.DssGraphTypeVertical_Bar_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent:return(a===$CS._general||a===$CS._percent);case $GT.DssGraphTypeVertical_Bar_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Bar_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Bar_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Bar_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Bar_Absolute:case $GT.DssGraphTypeHorizontal_Bar_Absolute:case $GT.DssGraphTypeVertical_Bullet:case $GT.DssGraphTypeHorizontal_Bullet:return(a===$CS._general||a===$CS._absolute);}return false;},IsAdvancedBarChart:function IsAdvancedBarChart(a){a=(a===undefined)?$CS._general:a;switch(this.mGraphType){case $GT.DssGraphTypeVertical_Bullet:case $GT.DssGraphTypeHorizontal_Bullet:return a===$CS._general||a===$CS._bullet;default:return false;}},IsLineChart:function IsLineChart(a){a=(a===undefined)?$CS._general:a;a=(a>=$CS._ring)?$CS._general:a;if(a===$CS._cluster){return false;}switch(this.mGraphType){case $GT.DssGraphTypeVertical_Line_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Line_Stacked:case $GT.DssGraphTypeVertical_Line_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Line_Stacked:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked:return(a===$CS._general||a===$CS._stacked);case $GT.DssGraphTypeVertical_Line_Percent:case $GT.DssGraphTypeHorizontal_Line_Percent:case $GT.DssGraphTypeVertical_Line_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Percent:return(a===$CS._general||a===$CS._percent);case $GT.DssGraphTypeVertical_Line_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Line_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Line_Absolute:case $GT.DssGraphTypeHorizontal_Line_Absolute:return(a===$CS._general||a===$CS._absolute);}return false;},IsAreaChart:function IsAreaChart(a){a=(a===undefined)?$CS._general:a;a=(a>=$CS._ring)?$CS._general:a;if(a===$CS._cluster){return false;}switch(this.mGraphType){case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Area_Stacked:case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Area_Stacked:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:return(a===$CS._general||a===$CS._stacked);case $GT.DssGraphTypeVertical_Area_Percent:case $GT.DssGraphTypeHorizontal_Area_Percent:case $GT.DssGraphTypeVertical_Area_DualAxis_Percent:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent:return(a===$CS._general||a===$CS._percent);case $GT.DssGraphTypeVertical_Area_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Area_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Area_Absolute:case $GT.DssGraphTypeHorizontal_Area_Absolute:return(a===$CS._general||a===$CS._absolute);}return false;},GetGraphMatrixGraphMajorType:function GetGraphMatrixGraphMajorType(){var markerShape=this.mpGraphMatrixContext.mMarkerShape,DssGraphMarkerShape2DPie=201,DssGraphMarkerShape2DRingPie=202;if(markerShape===DssGraphMarkerShape2DPie||markerShape===DssGraphMarkerShape2DRingPie){return $GM_MT._PIE;}if(this.IsBarChart()){return $GM_MT._BAR;}if(this.IsLineChart()){return $GM_MT._LINE;}if(this.IsAreaChart()){return $GM_MT._AREA;}var graphType=this.GetGraphType();switch(graphType){case $GT.DssGraphTypeGridChart:return $GM_MT._GRID;case $GT.DssGraphTypeX_Y_Scatter:case $GT.DssGraphTypeDualAxis_X_Y_Scatter:case $GT.DssGraphTypeX_Y_Scatter_with_Labels:case $GT.DssGraphTypeDualAxis_X_Y_Scatter_with_Labels:return $GM_MT._SCATTER;case $GT.DssGraphTypeBubble:case $GT.DssGraphTypeBubble_DualAxis:case $GT.DssGraphTypeBubble_With_Labels:case $GT.DssGraphTypeBubble_DualAxis_With_Labels:return $GM_MT._BUBBLE;case $GT.DssGraphTypeVertical_Area_Absolute:case $GT.DssGraphTypeVertical_Area_Stacked:case $GT.DssGraphTypeVertical_Area_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Area_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Area_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Area_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Area_Percent:case $GT.DssGraphTypeHorizontal_Area_Absolute:case $GT.DssGraphTypeHorizontal_Area_Stacked:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Area_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Area_Percent:return $GM_MT._AREA;case $GT.DssGraphTypeVertical_Line_Absolute:case $GT.DssGraphTypeVertical_Line_Stacked:case $GT.DssGraphTypeVertical_Line_BiPolar_Absolute:case $GT.DssGraphTypeVertical_Line_BiPolar_Stacked:case $GT.DssGraphTypeVertical_Line_DualAxis_Absolute:case $GT.DssGraphTypeVertical_Line_DualAxis_Stacked:case $GT.DssGraphTypeVertical_Line_Percent:case $GT.DssGraphTypeHorizontal_Line_Absolute:case $GT.DssGraphTypeHorizontal_Line_Stacked:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Absolute:case $GT.DssGraphTypeHorizontal_Line_BiPolar_Stacked:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute:case $GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked:case $GT.DssGraphTypeHorizontal_Line_Percent:return $GM_MT._LINE;}return $GM_MT._UNDEFINED;},GetThresholdFillColor:function GetThresholdFillColor(iSeriesId,iGroupId){var lUseMetricThresholds=true;if(lUseMetricThresholds){if(iSeriesId===this.mThresholdColorCache.mSeriesId&&iGroupId===this.mThresholdColorCache.mGroupId){if(this.mThresholdColorCache.mUseThreshold){return this.mThresholdColorCache.mThresholdColor;}}else{var color=this.mDatasetPtr.GetThresholdFillColor(iSeriesId,iGroupId,0);this.mThresholdColorCache.mSeriesId=iSeriesId;this.mThresholdColorCache.mGroupId=iGroupId;this.mThresholdColorCache.mUseThreshold=color!==null;if(this.mThresholdColorCache.mUseThreshold){this.mThresholdColorCache.mThresholdColor=color;return color;}}}return null;},GetColorFromPalette:function GetColorFromPalette(idx){var palette,color;if(this.mIsGraphMatrix){if(this.mThemeType===$GM_TT._white){palette=$C.gLightColorPalette;}else{palette=$C.gDarkColorPalette;}}else{palette=$C.gColorPalette;}idx%=palette.length;color=palette[idx];return color.ToInteger();},getInt:function getInt(a){if(a>=0){return Math.floor(a);}return Math.ceil(a);},transformRectToTicker:function transformRectToTicker(rect,isVerticalChart){var points=[],p1,p2;if(isVerticalChart){p1={x:Math.round(rect.x),y:Math.round(rect.y+0.5*rect.height)};p2={x:Math.round(rect.x+rect.width),y:Math.round(rect.y+0.5*rect.height)};}else{p1={x:Math.round(rect.x+0.5*rect.width),y:Math.round(rect.y)};p2={x:Math.round(rect.x+0.5*rect.width),y:Math.round(rect.y+rect.height)};}points.push(p1);points.push(p2);return points;},transformToRect:function transformToRect(center,size,isIsometric,orRect){var kLocalMarkerSize=100,numberOfPoints=4,points=[4,-100,-100,100,-100,100,100,-100,100],i,x,y;perfTransPoly=[];if(isIsometric){for(i=0;i<numberOfPoints;++i){x=points[2*i+1]*size/kLocalMarkerSize+center.x;y=points[2*i+2]*size/kLocalMarkerSize+center.y;perfTransPoly.push({x:x,y:y});}}else{for(i=0;i<numberOfPoints;++i){x=points[2*i+1]*size/kLocalMarkerSize+center.x;y=points[2*i+2]*size/kLocalMarkerSize+center.y;var point={x:x,y:y};point=this.vdPoint(point);perfTransPoly.push(point);}}var w=Math.abs(perfTransPoly[3].x-perfTransPoly[2].x),h=Math.abs(perfTransPoly[3].y-perfTransPoly[0].y);if(orRect){orRect.Reset(perfTransPoly[0].x,perfTransPoly[0].y,w,h);return orRect;}else{var rect=new $C.Rect2D();rect.x=perfTransPoly[0].x;rect.y=perfTransPoly[0].y;rect.width=Math.abs(perfTransPoly[3].x-perfTransPoly[2].x);rect.height=Math.abs(perfTransPoly[3].y-perfTransPoly[0].y);return rect;}},resetCanvas:function resetCanvas(){this.mCanvas.reset();},applyFontFormat:function applyFontFormat(fontFormat){if(this.mImageFormat===$PFT.SVG){this.mCanvas.ApplyFontFormat(fontFormat);}},setDrawingOrderToCanvas:function setDrawingOrderToCanvas(prop){if(this.mImageFormat===$PFT.SVG){this.mCanvas.setDrawOrder(prop);}},getDefaultThemeColor:function getDefaultThemeColor(){switch(this.mThemeType){case $GM_TT._black:return 0;case $GM_TT._white:return 16777215;default:return 16777215;}},getDefaultContrastColor:function getDefaultContrastColor(colorUsage){colorUsage=colorUsage||-1;var kAxisTicks=0,kBanner=1;switch(colorUsage){case kAxisTicks:return(this.mThemeType===$GM_TT._black?5855577:10066329);case kBanner:return(this.mThemeType===$GM_TT._black?16777215:3355443);default:return(this.mThemeType===$GM_TT._black?16777215:0);}},mapGraphTypeToDualAxis:function mapGraphTypeToDualAxis(type){var $GT=mstrmojo.chart.model.enums.EnumDSSGraphType;switch(type){case $GT.DssGraphTypeVertical_Bar_Side_by_Side:return $GT.DssGraphTypeVertical_Bar_DualAxis_Side_by_Side;case $GT.DssGraphTypeHorizontal_Bar_Side_by_Side:return $GT.DssGraphTypeHorizontal_Bar_DualAxis_Side_by_Side;case $GT.DssGraphTypeVertical_Bar_Stacked:return $GT.DssGraphTypeVertical_Bar_DualAxis_Stacked;case $GT.DssGraphTypeHorizontal_Bar_Stacked:return $GT.DssGraphTypeHorizontal_Bar_DualAxis_Stacked;case $GT.DssGraphTypeVertical_Bar_Percent:return $GT.DssGraphTypeVertical_Bar_DualAxis_Percent;case $GT.DssGraphTypeHorizontal_Bar_Percent:return $GT.DssGraphTypeHorizontal_Bar_DualAxis_Percent;case $GT.DssGraphTypeVertical_Bar_Absolute:return $GT.DssGraphTypeVertical_Bar_DualAxis_Absolute;case $GT.DssGraphTypeHorizontal_Bar_Absolute:return $GT.DssGraphTypeHorizontal_Bar_DualAxis_Absolute;case $GT.DssGraphTypeVertical_Line_Stacked:return $GT.DssGraphTypeVertical_Line_DualAxis_Stacked;case $GT.DssGraphTypeHorizontal_Line_Stacked:return $GT.DssGraphTypeHorizontal_Line_DualAxis_Stacked;case $GT.DssGraphTypeVertical_Line_Percent:return $GT.DssGraphTypeVertical_Line_DualAxis_Percent;case $GT.DssGraphTypeHorizontal_Line_Percent:return $GT.DssGraphTypeHorizontal_Line_DualAxis_Percent;case $GT.DssGraphTypeVertical_Line_Absolute:return $GT.DssGraphTypeVertical_Line_DualAxis_Absolute;case $GT.DssGraphTypeHorizontal_Line_Absolute:return $GT.DssGraphTypeHorizontal_Line_DualAxis_Absolute;case $GT.DssGraphTypeVertical_Area_Stacked:return $GT.DssGraphTypeVertical_Area_DualAxis_Stacked;case $GT.DssGraphTypeHorizontal_Area_Stacked:return $GT.DssGraphTypeHorizontal_Area_DualAxis_Stacked;case $GT.DssGraphTypeVertical_Area_Percent:return $GT.DssGraphTypeVertical_Area_DualAxis_Percent;case $GT.DssGraphTypeHorizontal_Area_Percent:return $GT.DssGraphTypeHorizontal_Area_DualAxis_Percent;case $GT.DssGraphTypeVertical_Area_Absolute:return $GT.DssGraphTypeVertical_Area_DualAxis_Absolute;case $GT.DssGraphTypeHorizontal_Area_Absolute:return $GT.DssGraphTypeHorizontal_Area_DualAxis_Absolute;default:return type;}},getAxisTripleId:function getAxisTripleId(axisKey){return $C.gAxisTripleIds[axisKey];},RenderClusterShapes:function RenderClusterShapes(){var chartCtx=this,caCtx=chartCtx.mUniformAxisContext.CategoryAxis,xCa=caCtx.X,yCa=caCtx.Y;if(chartCtx.isCombinationChart()||chartCtx.IsDualAxis()){return(xCa.EnforceCluster&&xCa.EnforceFringe)||(yCa.EnforceCluster&&yCa.EnforceFringe);}return false;},checkColorByAndSizeByValue:function checkColorByAndSizeByValue(tripleId,dataSet,checkColorBy,checkSizeBy){dataSet=dataSet||this.mDataset;checkColorBy=checkColorBy||false;checkSizeBy=checkSizeBy||false;if(!this.mIsGraphMatrix){return true;}var isPieShape=tripleId.angleByIndex!==undefined,value;if(checkColorBy){if(isPieShape===false){value=dataSet.GetColorByData(tripleId.mSeriesId,tripleId.mGroupId);}else{value=dataSet.GetPieSliceColorByData(tripleId.mSeriesId,tripleId.mGroupId,tripleId.angleByIndex,tripleId.sliceById);}if($Utility.isValidNumber(value)===false){return false;}}if(checkSizeBy){value=dataSet.GetSizeByData(tripleId.mSeriesId,tripleId.mGroupId);if($Utility.isValidNumber(value)===false){return false;}}return true;},getValueAxisKeyFromLayout:function getValueAxisKeyFromLayout(isX,isPrimary){if(isPrimary){return isX?"X1":"Y1";}else{return isX?"X2":"Y2";}},getAxisKeyFromObjectId:function getAxisKeyFromObjectId(objectId,doMapCA,lowerCase){lowerCase=lowerCase||false;doMapCA=doMapCA||false;var key;switch(objectId){case $GO.DssGraphX1Body:case $GO.DssGraphX1Label:case $GO.DssGraphX1Major:case $GO.DssGraphX1Minor:case $GO.DssGraphXTitle:case $GO.DssGraphUserLabel3:case $GO.DssGraphUserLine3:key="X1";break;case $GO.DssGraphX2Body:case $GO.DssGraphX2Label:case $GO.DssGraphX2Major:case $GO.DssGraphX2Minor:case $GO.DssGraphX2Title:case $GO.DssGraphUserLabel4:case $GO.DssGraphUserLine4:key="X2";break;case $GO.DssGraphY1Body:case $GO.DssGraphY1Label:case $GO.DssGraphY1Major:case $GO.DssGraphY1Minor:case $GO.DssGraphY1Title:case $GO.DssGraphUserLabel1:case $GO.DssGraphUserLine1:key="Y1";break;case $GO.DssGraphY2Body:case $GO.DssGraphY2Label:case $GO.DssGraphY2Major:case $GO.DssGraphY2Minor:case $GO.DssGraphY2Title:case $GO.DssGraphUserLabel2:case $GO.DssGraphUserLine2:key="Y2";break;case $GO.DssGraphZBody:key="Z";break;case $GO.DssGraphO1Body:case $GO.DssGraph2DO1Label:case $GO.DssGraphO1Major:case $GO.DssGraphO1Minor:case $GO.DssGraphO1Title:if(doMapCA){key=this.caKeyMap.c1||this.IsVertical()?"X1":"Y1";}else{key="O1";}break;case $GO.DssGraphO2Body:case $GO.DssGraph2DO2Label:case $GO.DssGraphO2Major:case $GO.DssGraphO2Minor:case $GO.DssGraphO2Title:if(doMapCA){key=this.caKeyMap.c1||this.IsVertical()?"X2":"Y2";}else{key="O2";}break;default:key="";break;}if(lowerCase){key=key.toLowerCase();}return key;},getUniformAxisInformationFromKey:function getUniformAxisInformationFromKey(axisKey,isVerticalAxis){isVerticalAxis=isVerticalAxis||false;var uaCtx=this.getUniformAxisContext(),container=uaCtx.ValueAxis;switch(axisKey){case"X1":case"X2":case"Y1":case"Y2":case"Z":return container[axisKey];case"O1":case"O2":container=uaCtx.CategoryAxis;return isVerticalAxis?container.Y:container.X;default:return container.Y1;}},getUniformAxisInformation:function getUnfiormAxisInformation(axisObjectId,isVerticalAxis){var uaCtx=this.getUniformAxisContext(),uaVA=uaCtx.ValueAxis,uaCA=uaCtx.CategoryAxis,selfInfo;switch(axisObjectId){case $GO.DssGraphO1Body:case $GO.DssGraphO2Body:isVerticalAxis=isVerticalAxis||false;return isVerticalAxis?uaCA.Y:uaCA.X;case $GO.DssGraphX1Body:selfInfo=uaVA.X1;break;case $GO.DssGraphY1Body:selfInfo=uaVA.Y1;break;case $GO.DssGraphX2Body:selfInfo=uaVA.X2;break;case $GO.DssGraphY2Body:selfInfo=uaVA.Y2;break;case $GO.DssGraphZBody:selfInfo=uaVA.Z;break;}return selfInfo;},mirrorPrimaryInBubbleScatter:function mirrorPrimaryInBubbleScatter(isX){var chartCtx=this,gmCtx=chartCtx.GetGraphMatrixContext(),axisLayout=gmCtx.AxisLayout;if(chartCtx.mIsGraphMatrix===false){return false;}if(axisLayout===null||axisLayout===undefined){return false;}var x1=1,y1=2,y2=4,x2=8;if(isX){return !!(axisLayout&x2);}return !!(axisLayout&y2);},isCompactMode:function isCompactMode(){return this.mDataset.dataProvider.isCompactMode();}});$CTX.sDefaultMargin=10;$CTX.sDefaultMarginForTimeSeries=3;$CTX.sDefaultUniformAxisMargin=0;}());
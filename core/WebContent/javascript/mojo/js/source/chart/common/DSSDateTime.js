(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.chart.common.DSSTimeUtil");var DAY_IN_MILLISECONDS=24*60*60*1000;var HOUR_IN_MILLISECONDS=60*60*1000;var MINUTE_IN_MILLISECONDS=60*1000;var SECOND_IN_MILLISECONDS=1000;var DAY_IN_HOURS=24;var DAY_IN_MINUTES=24*60;var DAY_IN_SECONDS=24*60*60;var $TIMEUTIL=new mstrmojo.chart.common.DSSTimeUtil();mstrmojo.chart.common.DSSDateTime=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.common.DSSDateTime",mnYear:1899,mnMonth:12,mnDay:30,mnHour:0,mnMinute:0,mnSecond:0,mnMillisecond:0,mnWeek:-1,mnDayOfWeek:-1,init:function init(props){if(!props||!props.ifTime){this.mnYear=1899;this.mnMonth=12;this.mnDay=30;this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;this.mnWeek=-1;this.mnDayOfWeek=-1;return ;}var lfFraction=0;var cMax=23242571;var cMin=-693593;if(props.ifTime>cMax){this.mnYear=65535;this.mnMonth=12;this.mnDay=30;lfFraction=props.ifTime-Math.floor(props.ifTime);}else{if(props.ifTime<cMin){this.mnYear=1;this.mnMonth=1;this.mnDay=1;lfFraction=Math.abs(props.ifTime)+Math.ceil(props.ifTime);}else{if(props.ifTime>0){var lYMD=this.DAYSToYMD(Math.floor(props.ifTime));this.mnYear=lYMD.year;this.mnMonth=lYMD.month;this.mnDay=lYMD.day;lfFraction=props.ifTime-Math.floor(props.ifTime);}else{if(props.ifTime<0){var lYMD=this.DAYSToYMD(Math.ceil(props.ifTime));this.mnYear=lYMD.year;this.mnMonth=lYMD.month;this.mnDay=lYMD.day;lfFraction=Math.abs(props.ifTime)+Math.ceil(props.ifTime);}}}}lfFraction*=DAY_IN_MILLISECONDS;var lnFraction=lfFraction+0.5;if(lnFraction==DAY_IN_MILLISECONDS){lnFraction--;}if(lnFraction>0){this.mnHour=Math.floor(lnFraction/HOUR_IN_MILLISECONDS);lnFraction-=this.mnHour*HOUR_IN_MILLISECONDS;this.mnMinute=Math.floor(lnFraction/MINUTE_IN_MILLISECONDS);lnFraction-=this.mnMinute*MINUTE_IN_MILLISECONDS;this.mnSecond=Math.floor(lnFraction/SECOND_IN_MILLISECONDS);lnFraction-=this.mnSecond*SECOND_IN_MILLISECONDS;this.mnMillisecond=Math.floor(lnFraction);}else{this.mnHour=0;this.mnMinute=0;this.mnSecond=0;this.mnMillisecond=0;}this.mnWeek=-1;this.mnDayOfWeek=-1;this.Sanitize();},Sanitize:function Sanitize(){var lAdjust=false;if(this.mnHour==24&&this.mnMinute==0&&this.mnSecond==0){lAdjust=true;this.mnHour=0;}if(this.mnMonth<1){this.mnMonth=1;}else{if(this.mnMonth>12){this.mnMonth=12;}}if(this.mnDay<1){this.mnDay=1;}else{if(this.mnDay>$TIMEUTIL.DaysInMonth[this.mnMonth-1]){this.mnDay=$TIMEUTIL.DaysInMonth[this.mnMonth-1];if(this.mnMonth==2&&this.IsLeapYear(this.mnYear)){this.mnDay++;}}}if(this.mnHour<0){this.mnHour=0;}else{if(this.mnHour>23){this.mnHour=23;}}if(this.mnMinute<0){this.mnMinute=0;}else{if(this.mnMinute>59){this.mnMinute=59;}}if(this.mnSecond<0){this.mnSecond=0;}else{if(this.mnSecond>59){this.mnSecond=59;}}if(this.mnMillisecond<0){this.mnMillisecond=0;}else{if(this.mnMillisecond>999){this.mnMillisecond=999;}}if(lAdjust){var lnMilliseconds=this.ToMilliseconds();lnMilliseconds=lnMilliseconds+DAY_IN_MILLISECONDS;this.init({ifTime:this.MillisecondsToDATE(lnMilliseconds)});}},IsLeapYear:function IsLeapYear(inYear){return((inYear&3)==0)&&((inYear%100)!=0||(inYear%400)==0);},ToMilliseconds:function ToMilliseconds(){var lnDays=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var lnMilliseconds=lnDays*DAY_IN_MILLISECONDS;lnMilliseconds+=this.mnHour*HOUR_IN_MILLISECONDS+this.mnMinute*MINUTE_IN_MILLISECONDS+this.mnSecond*SECOND_IN_MILLISECONDS+this.mnMillisecond;return lnMilliseconds;},MillisecondsToDATE:function MillisecondsToDATE(inMilliseconds){var lnDays=Math.floor(inMilliseconds/DAY_IN_MILLISECONDS);var fraction=(inMilliseconds-lnDays*DAY_IN_MILLISECONDS)/DAY_IN_MILLISECONDS;if(fraction<0){lnDays--;fraction+=1;}return lnDays>=0?lnDays+fraction:lnDays-fraction;},DAYSToYMD:function DAYSToYMD(inDays){var ornYear=0;var ornMonth=0;var ornDay=0;inDays+=693959;var lnYear=Math.floor(inDays/365);var lnRemain=inDays-lnYear*365;var lnLeapDays=Math.floor(lnYear/4)-Math.floor(lnYear/100)+Math.floor(lnYear/400);lnRemain=lnRemain-lnLeapDays;if(lnRemain<0){lnYear--;lnRemain+=365;while(lnRemain<=0){lnYear--;lnRemain+=365;}}var lnDays=inDays-(lnYear*365+Math.floor(lnYear/4)+(lnYear%4?1:0)-Math.floor((lnYear-1)/100)+Math.floor((lnYear-1)/400));if(lnDays==365&&!this.IsLeapYear(lnYear)){ornYear=lnYear+1;ornMonth=1;ornDay=1;return{year:ornYear,month:ornMonth,day:ornDay};}if(lnDays==-1){ornYear=lnYear-1;ornMonth=12;ornDay=31;return{year:ornYear,month:ornMonth,day:ornDay};}ornYear=lnYear;ornMonth=12;while(lnDays<$TIMEUTIL.DaysBeforeMonth[ornMonth-1]){ornMonth--;}ornDay=lnDays-$TIMEUTIL.DaysBeforeMonth[ornMonth-1]+1;if(ornMonth>2&&this.IsLeapYear(ornYear)){ornDay--;if(ornDay==0){ornMonth--;ornDay=$TIMEUTIL.DaysInMonth[ornMonth-1];if(ornMonth==2){ornDay++;}}}return{year:ornYear,month:ornMonth,day:ornDay};},YMDToDAYS:function YMDToDAYS(inYear,inMonth,inDay){if(inMonth<1||inMonth>12){return 0;}var lnDays=inYear*365+Math.floor(inYear/4)+(inYear%4?1:0)-Math.floor((inYear-1)/100)+Math.floor((inYear-1)/400);lnDays+=$TIMEUTIL.DaysBeforeMonth[inMonth-1];if(inMonth>2&&this.IsLeapYear(inYear)){lnDays++;}lnDays+=inDay-1;lnDays-=693959;return lnDays;},ToDATE:function ToDATE(){var lDays=this.YMDToDAYS(this.mnYear,this.mnMonth,this.mnDay);var lfFraction=this.mnHour/DAY_IN_HOURS+this.mnMinute/DAY_IN_MINUTES+this.mnSecond/DAY_IN_SECONDS+this.mnMillisecond/DAY_IN_MILLISECONDS;if(lDays>=0){return lDays+lfFraction;}else{return lDays-lfFraction;}},DateTimeOrder:function DateTimeOrder(b){if(this.mnYear>b.mnYear){return 1;}else{if(this.mnYear<b.mnYear){return -1;}}if(this.mnMonth>b.mnMonth){return 1;}else{if(this.mnMonth<b.mnMonth){return -1;}}if(this.mnDay>b.mnDay){return 1;}else{if(this.mnDay<b.mnDay){return -1;}}if(this.mnHour>b.mnHour){return 1;}else{if(this.mnHour<b.mnHour){return -1;}}if(this.mnMinute>b.mnMinute){return 1;}else{if(this.mnMinute<b.mnMinute){return -1;}}if(this.mnSecond>b.mnSecond){return 1;}else{if(this.mnSecond<b.mnSecond){return -1;}}if(this.mnMillisecond>b.mnMillisecond){return 1;}else{if(this.mnMillisecond<b.mnMillisecond){return -1;}}return 0;}});}());
(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.warehouse.ui.DBConnectionsList");mstrmojo.requiresDescs(13531,13532,13533,14034,14035);var DssXmlPrivilegesUseDatabaseInstanceManager=57,REPRORT_DEF_LOADED_EVENT="reportDefLoaded",$ENUM_DATA_CHANGE_EVENTS=mstrmojo.warehouse.EnumDataChangeEvents;mstrmojo.qb.thirdParty.BISourceSelector=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.qb.thirdParty.BISourceSelector",cssClass:"mstrmojo-qb-thirdParty-BISourceSelector",title:mstrmojo.desc(4381,"data sources"),newDBBtn:undefined,dbConnections:undefined,onheightChange:function onheightChange(e){if(!this.heightOffset){this.heightOffset=37;}this.dbConnections.set("height",parseInt(e.value,10)-this.heightOffset+"px");},children:[{scriptClass:"mstrmojo.Box",cssClass:"selector-panel-header cf",children:[{scriptClass:"mstrmojo.Label",cssClass:"title-label",text:mstrmojo.desc(14034,"Select a source connection")+":"},{scriptClass:"mstrmojo.Button",cssClass:"add-connection-button",text:mstrmojo.desc(14035,"Add a new connection")+"...",onclick:function onClick(){if(mstrApp.rootController.hasPrivilege(DssXmlPrivilegesUseDatabaseInstanceManager)){mstrApp.getRootController().editDBRole();}else{mstrmojo.alert(mstrmojo.desc(12933,"You don't have enough privileges to perform this operation"));}}}]},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"source-type-selector",visible:false,items:[{id:0,n:"All"},{id:1,n:"SAP Business Objects"},{id:2,n:"OBIEE"},{id:3,n:"Cognos"}],selectedIndex:0,onitemSelected:function(item){this.parent.dbConnections.filterBySource(item.n);}},{scriptClass:"mstrmojo.warehouse.ui.DBConnectionsList",alias:"dbConnections",postCreate:function(){var evtConfig={},listConfig=evtConfig[this.id]={};listConfig[$ENUM_DATA_CHANGE_EVENTS.DBROLES_LOADED]=this.onDBRolesLoaded;listConfig[REPRORT_DEF_LOADED_EVENT]=this.onReportDefLoaded;mstrApp.getRootController().attachDataChangeListeners(evtConfig);},onDBRolesLoaded:function(evt){this.allDBRoles=evt.items;},onReportDefLoaded:function(){var model=mstrApp.getRootController().model;this.singleSelectByField(model.SelDBRoleID,"did");},onchange:function(){var dbrole=this.selectedItem,model=mstrApp.getRootController().model;if(dbrole){model.SelDBRoleID=dbrole.did;model.set("SelDBRoleName",dbrole.n);}else{if(model.SelDBRoleID){this.singleSelectByField(model.SelDBRoleID,"did");}else{model.set("SelDBRoleName","");}}},filterBySource:function filterBySource(sourceName){}}]});}());
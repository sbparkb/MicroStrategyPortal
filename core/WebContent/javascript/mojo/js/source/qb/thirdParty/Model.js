(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.warehouse.EnumDataChangeEvents");var _S=mstrmojo.string;var ENUM_LOAD_REPORT_BROWSE_TYPE_DATAPREVIEW=4,ENUM_LOAD_REPORT_BINDING_FLAG_ALL=15,ENUM_LOAD_REPORT_PREVIEW_FLAG_SourceInfo=8;function decodeString(input){return input.replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;apos;/g,'"').replace(/&apos;/g,"'").replace(/^\n+|\n+$/g,"").replace(/\t/g," ").replace(/&amp;/g,"&");}function loadFFSQLDefinition(data){var dataPreview=data.datap,sourceInfo=dataPreview.srce,sql=sourceInfo.csl;this.set("SelDBRoleID",sourceInfo.dbrid);sql=decodeString(sql);this.SQLstmt=sql;this.raiseEvent({name:"reportDefLoaded"});}function makeKey(src){return src.dbRoleID+src.url;}mstrmojo.qb.thirdParty.Model=mstrmojo.declare(mstrmojo.qb.EmmaModel,null,{scriptClass:"mstrmojo.qb.thirdParty.Model",dbRolesVersionFilter:[223],dbRolesVersionExcludeFilter:[],dbObjectsDisplayOptions:8,xdaType:304,connectorType:131076,dbRoleEditorCfg:{hideDSNOption:true,hideDriverCheck:true,dbIdFilter:[41],singleType:true},urlSrc:null,init:function init(props){this.dbRoleEditorCfg.showAddDriver=false;props.dbIds=null;props.dbVersions=null;this._super(props);this.urlSrc=[];this.dbRoleEditorCfg.dbIdExcludeFilter=[];this.dbRoleEditorCfg.cfgDbmsTypeExcludeFilter=[];},createReportInstance:function createReportInstance(){var model=this,isFFSQL=mstrApp.isFFSQL,isNew=model.isNew=!mstrApp.tableID,dataService=mstrApp.getRootController().getDataService();model.supportTimeGeo=true;model.analysisID=mstrApp.analysisID;model.tableID=mstrApp.tableID;mstrApp.msgid=mstrApp.msgID;if(isNew){if(mstrApp.msgid){model.originalMsgID=mstrApp.msgid;dataService.removeOrDuplicateRI({success:function(res){mstrApp.msgid=res.msgid;}},{messageID:mstrApp.msgid});}else{dataService.createEmmaInstance({success:function success(res){mstrApp.msgid=res.msgid;}});}}else{model.originalMsgID=mstrApp.msgid;dataService.removeOrDuplicateRI({success:function(res){mstrApp.msgid=res.msgid;var loadFlag=ENUM_LOAD_REPORT_BROWSE_TYPE_DATAPREVIEW;model.loadReport(loadFlag,ENUM_LOAD_REPORT_BINDING_FLAG_ALL,ENUM_LOAD_REPORT_PREVIEW_FLAG_SourceInfo,null,{success:function success(res){if(isFFSQL){loadFFSQLDefinition.call(model,res);}if(mstrApp.isCloud){mstrApp.getRootController().getDataService().autoClosePrompt({success:function success(res){mstrApp.msgid=res.msgid;}});}}});}},{messageID:mstrApp.msgid});}if(mstrApp.isFFSQL){model.set("isFFSQL",true);model.set("FFSQLMode",true);mstrApp.isFFSQLMode=true;}},getAllowSave:function getAllowSave(statement){if(statement&&statement!==""){return true;}return false;},getHelpTopic:function getHelpTopic(){return"importing_data_from_a_BI_source.htm";},getNameSpaces:mstrmojo.emptyFn,autoMapFFSQL:function autoMapFFSQL(statement,callback){var model=this;mstrApp.getRootController().getDataService().editFFSQL({success:function success(){model.isDirty=true;model.SQLstmt=statement;if(statement){model.autoMap(callback);}}},{exp:_S.encodeXMLAttribute(statement),tbid:model.tableID||""});}});}());
(function(){mstrmojo.requiresCls("mstrmojo.qb.Mappings","mstrmojo._HasPopup","mstrmojo.SaveAsEditor");mstrmojo.requiresDescs(172,1088,3118,3389,8114,12640,12974,12975,12976);mstrmojo.DI.DIMapping=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DI.DIMapping",cssClass:"mstrmojo-di-map",model:null,saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:"Metric",browsableTypes:"776",saveAs:function(overwrite){var panel=this.contPanel;this.name=panel.name.value;this.desc=panel.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(8114));return ;}var params=this.saveParams||{};params.folderID=this.ob.currentFolder.did;params.objDesc=this.desc||"";params.objName=this.name||"";params.saveAsOverwrite=!!overwrite;var cb=this.saveAsCallback();cb.parent=this;mstrmojo.xhr.request("POST",mstrmojo.App.taskURL,cb,params);}},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-di-sub-tb",text:mstrmojo.desc(12975,"Column Mapping")},{scriptClass:"mstrmojo.Box",alias:"content",cssClass:"content",children:[{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Label",cssText:"margin: 20px 0 40px 0",text:mstrmojo.desc(12976,"MicroStrategy automatically maps all columns from the data source to attributes and metrics")}]},{scriptClass:"mstrmojo.qb.Mappings",alias:"map",cssClass:"",bindings:{model:"this.parent.model"}},{scriptClass:"mstrmojo.Table",cssClass:"edit-panel",alias:"editPanel",layout:[{cssText:"height:30px",cells:[{cssText:"width:15%"},{},{}]},{cssText:"height:30px",cells:[{cssText:"width:15%"},{},{}]},{cssText:"height:30px",cells:[{cssText:"width:15%"},{},{}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.Label",cssText:"padding-left: 10px",text:mstrmojo.desc(3118)},{slot:"1,0",scriptClass:"mstrmojo.Label",cssText:"padding-left: 10px",text:mstrmojo.desc(12640,"Sheet Name")},{slot:"2,0",scriptClass:"mstrmojo.Label",cssText:"padding-left: 10px",text:mstrmojo.desc(3389)},{slot:"0,1",scriptClass:"mstrmojo.Label",bindings:{text:function(){return this.parent.parent.model.srce.tbn;}}},{slot:"1,1",scriptClass:"mstrmojo.Label",bindings:{text:function(){var curIx=this.parent.parent.model.curIx,shts=this.parent.parent.model.shts;return shts[curIx];}}},{slot:"0,2",scriptClass:"mstrmojo.Button",cssClass:"button",text:mstrmojo.desc(1088),onclick:function(){var m=this.parent.parent.model;m.set("curPg",1);}},{slot:"2,2",scriptClass:"mstrmojo.Button",cssClass:"button",text:mstrmojo.desc(1088),onclick:function(){var m=this.parent.parent.model;m.set("curPg",2);}}]},{scriptClass:"mstrmojo.Box",cssText:"width: 100%",children:[{scriptClass:"mstrmojo.Button",cssClass:"button",cssText:"float: right",alias:"pub",text:mstrmojo.desc(172),onclick:function(){var p=this.parent.parent.parent,m=p.model,coi=m.coi;var params={taskId:"saveAndPublishCube",msgID:p.model.msgid},callback={success:function(res){m.set("curPg",4);m.set("cid",res.objectId);this.parent.close();},failure:function(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}};p.openPopup("saveasRef",{zIndex:10,folderLinksContextId:1,saveParams:params,saveAsCallback:function(){return callback;}});}}]}],bindings:{model:"this.parent.model"}}],onvisibleChange:function(evt){if(evt.value){this.content.map.populate();}}});})();
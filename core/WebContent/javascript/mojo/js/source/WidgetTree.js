(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var _loaded=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function ifn(item,idx,w){if(!_loaded){mstrmojo.requiresCls("mstrmojo.TreeNode");_loaded=true;}var tree=w.tree||w,iw=new mstrmojo.TreeNode({data:item,state:0,parent:w,tree:tree,multiSelect:w.multiSelect,text:item[w.itemDisplayField],textCssClass:tree.item2textCss(item),items:item[w.itemChildrenField],itemIdField:w.itemIdField,itemDisplayField:w.itemDisplayField,itemIconField:w.itemIconField,itemChildrenField:w.itemChildrenField,itemFunction:w.itemFunction,listSelector:w.listSelector});return iw;},item2textCss:function item2textCss(item){return item[this.itemIconField];},selectionParentNode:null,init:function init(props){this._super(props);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function clearTreeSelect(){(this.selectionParentNode||this).clearSelect();},prechange:function pchg(evt){var ret=this._super(evt);this.onnodechange(evt);return ret;},onnodechange:function ndchg(evt){if(!evt){return ;}var H=mstrmojo.hash,nodeWas=this.selectionParentNode,node=evt.src;if(node===nodeWas){if(H.isEmpty(node.selectedIndices)){node=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:node,parentNodeWas:nodeWas,added:evt.added,removed:evt.removed});}else{if(evt.added&&evt.added.length){var rmv=[];if(!H.isEmpty(nodeWas.selectedIndices)){rmv=mstrmojo.hash.keyarray(nodeWas.selectedIndices,true);nodeWas.clearSelect();}this.selectionParentNode=node;this.raiseEvent({name:"selectionChange",parentNode:node,parentNodeWas:nodeWas,added:evt.added,removed:rmv});}else{}}}});})();
(function(){mstrmojo.requiresCls("mstrmojo.prompt.WebPrompt","mstrmojo.array");var $ARR=mstrmojo.array;mstrmojo.prompt.WebGeoConstantPrompt=mstrmojo.declare(mstrmojo.prompt.WebPrompt,null,{scriptClass:"mstrmojo.prompt.WebGeoConstantPrompt",promptType:1.5,geos:null,getStyle:function getStyle(){return mstrmojo.prompt.WebPrompt.STYLES.GEO;},getDisplayValue:function getDisplayValue(){var err=this._isErr;if(err){return"Error while updating location: "+err;}var me=this,rtn="";$ARR.forEach(this.geos,function(prompt){var ans=prompt.answer;if(ans===""){rtn="&lt;Update Current Location&gt;";return false;}else{var geoCoord=prompt.prs.GeographicCoordinate;if(typeof (geoCoord)=="undefined"||geoCoord!="1"){me.la=ans;}else{me.lo=ans;}}});if(me.displayLoc){rtn=me.displayLoc;}else{me.mn="Searching...";if(typeof (me.la)=="undefined"){me.la="";}if(typeof (me.lo)=="undefined"){me.lo="";}if(!(me.la==""&&me.lo=="")){rtn="("+me.la+","+me.lo+")";}}return rtn;},getDisplayLocation:function(list){var me=this,la=this.la,lo=this.lo;if(la!=""&&lo!=""){mstrmojo.GeoLocation.findAddress({lat:la,lng:lo},{success:function(results){me.mn="";me.displayLoc=results[0].formatted_address;list.updateItem(me._renderIdx);},failure:function(results,status){me.mn="";}});}},validate:function validate(latitude,longitude){return true;},buildShortPa:function buildShortPa(builder){$ARR.forEach(this.geos,function(g){g.buildShortPa(builder);});},add:function add(p){var g=this.geos=this.geos||[];g.push(p);},setAnswerValue:function setAnswerValue(latitude,longitude){try{delete this.displayLoc;this.validate(latitude,longitude);this.setLocation(latitude,longitude);}catch(ex){this.setError(ex);return false;}return true;},setError:function setError(v){this._isErr=v;},setLocation:function setLocation(latitude,longitude){$ARR.forEach(this.geos,function(prompt){switch((prompt.prs&&prompt.prs.GeographicCoordinate)||"0"){case"0":prompt.set("answer",String(latitude));break;case"1":prompt.set("answer",String(longitude));break;}});}});}());
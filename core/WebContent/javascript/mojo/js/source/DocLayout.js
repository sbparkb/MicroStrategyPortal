(function(){mstrmojo.requiresCls("mstrmojo.rw.DocLayout","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo.dom");mstrmojo.DocLayout=mstrmojo.declare(mstrmojo.rw.DocLayout,[mstrmojo._Formattable,mstrmojo._HasWaitIcon],{scriptClass:"mstrmojo.DocLayout",formatHandlers:{domNode:["B","background-color","D","min-height","width"]},markupMethods:{onminHeightChange:function(){var mh=this.minHeight;if(!mh){var fmts=this.getFormats();mh=fmts&&fmts["min-height"];}if(mh){this.containerNode.style[mstrmojo.css.MINHEIGHT]=mh;}}},getHeight:function getHeight(){var h=0;mstrmojo.array.forEach(this.children,function(child){h+=child.getHeight();});return h||this.containerNode.offsetHeight;},getWidth:function getWidth(){var children=this.children;return(children&&children.length)?children[0].getWidth():this.containerNode.offsetWidth;},preBuildRendering:function preBuildRendering(){var f=this.getFormats();if(f&&f["min-width"]!==undefined){f.width=f["min-width"];}this._super();},renderChildren:function renderChildren(){this._super();this.resizeOrReposition();},resizeOrReposition:function resizeOrReposition(){var containerNode=this.containerNode;if(!!this.defn.aw){var aws=this.model.getAutoWidthIDs(),len=(aws&&aws.length)||0,mx=0,all=mstrmojo.all,i;if(!len){return ;}for(i=0;i<len;i++){mx=Math.max(this._getWidgetRightMostPosition(all[aws[i]]),mx);}mx=Math.max(this.getLayoutMinWidth(),mx);if(mx>parseInt(this.getFormats().width,10)){containerNode.style.width=mx+"px";}}var zoomToFit=this.model.zt;if(mstrApp.isMobile&&zoomToFit){var viewerNode=this.parent.domNode;if(viewerNode){var controller=this.model.controller,isPortrait=!!controller.orientation,verticalMargin=0,parent=this.parent,parentHeight=parent.getHeight()-parent.fixedHeaderNode.clientHeight-parent.fixedFooterNode.clientHeight;if(zoomToFit===2){if(!controller.toolBarDelegated){parentHeight-=controller.getBottomToolBarHeight();}verticalMargin=Math.round(isPortrait?Math.max((parentHeight-this.getHeight()),0)/2:0)+"px";}containerNode.style.margin=verticalMargin+" auto";var me=this;window.setTimeout(function(){controller.nudgeWidget(me.id,{left:containerNode.offsetLeft,top:containerNode.offsetTop});},0);}}},getLayoutMinWidth:function getLayoutMinWidth(){return 0;},_getWidgetRightMostPosition:function getLayoutMinWidth(w){return parseInt(w.getFormats().left,10)+((w.getDim&&w.getDim().w)||w.domNode.offsetWidth);},renderCtrlsInViewport:function renderCtrlsInViewport(){this._super();this.resizeOrReposition();},adjustAutoWidth:function adjustAutoWidth(w){if(!this.defn.aw||!w){return ;}var cs=this.containerNode.style,wd=parseInt(cs.width,10)||0;var me=this;window.setTimeout(function(){var mx=me._getWidgetRightMostPosition(w);if(mx>wd){cs.width=mx+"px";}},1);},_getModelChildNodes:function _getModelChildNodes(node,isPartial,start,count,includeTotal){var nds=this.model.getNonFixedSections(node,isPartial);var len=nds.length;count=isNaN(count)?len:count;start=start||0;if(start>0||count<len){nds=nds.slice(start,start+count);}return includeTotal?{nodes:nds,total:len}:nds;},getChildren:function getChildren(node,isPartial,start,count,includeTotal){return this._getModelChildNodes(node||this.node,isPartial||false,start,count,includeTotal);},getCaptureDimensions:function getCaptureDimensions(){var domNode=this.domNode,position;if(!this.domNode){return null;}position=mstrmojo.dom.position(domNode);position.w=Math.min(domNode.offsetWidth,position.w);position.h=Math.min(domNode.offsetHeight,position.h);return position;},preserveChildDomOrder:false,postBuildRendering:function postBuildRendering(){if(window.mstrMobileApp!==undefined){this.defn.lastOrientation=mstrMobileApp.getOrientation();}this._super();}});}());
(function(){mstrmojo.requiresCls("mstrmojo.mstr.EnumFunction","mstrmojo.mstr.EnumWebFunctionType","mstrmojo.mstr.EnumExpressionType","mstrmojo.mstr.EnumNodeType","mstrmojo.mstr.EnumDataType","mstrmojo.mstr.WebOperatorNode","mstrmojo.mstr.WebFormShortcutNode","mstrmojo.mstr.WebConstantNode","mstrmojo.mstr.WebTimeNode");var $FUNCTIONS=mstrmojo.mstr.EnumFunction,$FUNCTIONTYPE=mstrmojo.mstr.EnumWebFunctionType,$EXPRESSIONTYPE=mstrmojo.mstr.EnumExpressionType,$NODETYPE=mstrmojo.mstr.EnumNodeType,$DATATYPE=mstrmojo.mstr.EnumDataType;mstrmojo.mstr.WebExpression=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.mstr.WebExpression",rootNode:null,init:function(props){props=props||{};if(!props.rootNode){props.rootNode=new mstrmojo.mstr.WebOperatorNode({exprType:$EXPRESSIONTYPE.FilterBranchQual,funcType:$FUNCTIONTYPE.WebFunctionTypeGeneric,func:$FUNCTIONS.FunctionAnd});}this._super(props);},createOperatorNode:function createOperatorNode(expressionType,func,parent){if(!parent){parent=this.rootNode;}var node=new mstrmojo.mstr.WebOperatorNode({exprType:expressionType});node.set("func",func);parent.appendChild(node);return node;},createFormShortcutNode:function createFormShortcutNode(attr,form,parent){if(!parent){parent=this.rootNode;}var node=new mstrmojo.mstr.WebFormShortcutNode({attribute:attr,form:form});parent.appendChild(node);return node;},createValueNode:function createValueNode(value,dataType,parent){switch(dataType){case $DATATYPE.DataTypeDate:case $DATATYPE.DataTypeTime:case $DATATYPE.DataTypeTimeStamp:return this.createTimeNode(value,parent);default:return this.createConstantNode(value,dataType,parent);}},createConstantNode:function createConstantNode(value,dataType,parent){if(!parent){parent=this.rootNode;}var node=new mstrmojo.mstr.WebConstantNode({value:value,type:dataType});parent.appendChild(node);return node;},createTimeNode:function(time,parent){var node=new mstrmojo.mstr.WebTimeNode({value:time});if(!parent){parent=this.rootNode;}parent.appendChild(node);return node;},newAQSubExpression:function(attr,form,func,dt,value){if(func<0){func=$FUNCTIONS.FunctionEquals;}var subExpr=this.createOperatorNode($EXPRESSIONTYPE.FilterSingleBaseFormQual,func),fmNode=this.createFormShortcutNode(attr,form,subExpr),valNode=this.createValueNode(value,dt,subExpr);return subExpr;},buildShortXML:function buildShortXML(builder){builder.addChild("exp");var rt=this.rootNode;if(rt){if(parseInt(rt.exprType,10)===$EXPRESSIONTYPE.FilterBranchQual&&parseInt(rt.nodeType,10)===$NODETYPE.NodeOperator){if(rt.childNodes&&rt.childNodes.length===1){var funcType=parseInt(rt.func,10);if(funcType===$FUNCTIONS.FunctionAnd||funcType===$FUNCTIONS.FunctionOr){rt.childNodes[0].buildShortXML(builder);}else{rt.buildShortXML(builder);}}else{rt.buildShortXML(builder);}}else{rt.buildShortXML(builder);}}builder.closeElement();}});}());
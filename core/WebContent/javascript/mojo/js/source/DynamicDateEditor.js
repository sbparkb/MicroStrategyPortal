(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.locales","mstrmojo.array","mstrmojo.hash","mstrmojo.date","mstrmojo.Label","mstrmojo.Box","mstrmojo.HBox","mstrmojo.CheckBox","mstrmojo.SelectBox","mstrmojo.Table","mstrmojo.ValidationTextBox","mstrmojo.RadioList","mstrmojo.RadioListHoriz","mstrmojo.HTMLButton","mstrmojo.FieldSet");var $A=mstrmojo.array,$H=mstrmojo.hash,$D=mstrmojo.date,$LDT=mstrmojo.locales.datetime,$ABS=Math.abs,OFFSETS=[mstrmojo.desc(4046,"First"),mstrmojo.desc(9431,"Second"),mstrmojo.desc(9432,"Third"),mstrmojo.desc(9433,"Fourth"),mstrmojo.desc(9434,"Fifth")],DIRECTIONS=[mstrmojo.desc(9424,"plus"),mstrmojo.desc(9425,"minus")],ADDITIONAL_ADJSTMENT_TYPE_ARR=[mstrmojo.desc(872,"Day"),mstrmojo.desc(9437,"The"),mstrmojo.desc(9435,"Reverse count")],ENUMDSSXMLDATATYPES={DATE:14,TIME:15,DATETIME:16,BUSINESSDAYSAWARE:17},DDE_TYPE={},DYT_ADJUSTEMENTS={NONE:0,WEEKLY:1,MONTHLY:2,QUARTERLY:11,YEARLY:3},MONTH_AND_QUARTER_ADJ_TYPE={DAY:0,THE:1,REVERSE:2},YEAR_ADJ_TYPE={ON:0,THE:1},OPD={ADD:1,MINUS:-1};DDE_TYPE[ENUMDSSXMLDATATYPES.DATE]=3;DDE_TYPE[ENUMDSSXMLDATATYPES.TIME]=194;DDE_TYPE[ENUMDSSXMLDATATYPES.DATETIME]=195;DDE_TYPE[ENUMDSSXMLDATATYPES.BUSINESSDAYSAWARE]=256;function createValidationTextBoxWithLabel(props,label,position){return $H.copy({markupString:'<div class="mstrmojo-TextBoxWithLabel {@cssClass}" style="{@cssText}">'+(position?'<span class="mstrmojo-TextBox-label">'+label+"</span>":"")+'<input id="{@id}" class="mstrmojo-TextBox {@inputNodeCssClass}"  style="{@inputNodeCssText}" title="{@tooltip}" type="{@type}" value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur  tstid="{@tstid}"/>'+(!position?'<span class="mstrmojo-TextBox-label-right">'+label+"</span>":"")+"</div>",markupSlots:{inputNode:function inputNode(){return position?this.domNode.lastChild:this.domNode.firstChild;}}},props);}function getListControlValue(widget){return widget.items[widget.selectedIndex].v;}function getNthDayOfMonth(year,month,n,day){var temp=new Date(year,month,1),tempDay=temp.getDay();return 1+(day-tempDay)+(day>=tempDay?0:7)+(7*n);}function handleInvalidState(errorText,valid){var dde=mstrmojo.all.mstrDDE;dde.errorText.set("text",errorText);dde.errorText.set("visible",!valid);dde.buttonHBox.okButton.set("enabled",valid);}function validateInputs(){var dde=mstrmojo.all.mstrDDE,controls=dde.controls,validationControls=["ddo","dmo","mdd","mrdd","mrdm","yodd","dh","dmi","st","qdd","qrdd"],valid=true,txt="";$A.forEach(validationControls,function(c){var validations=controls[c].validationStatus;if(validations&&validations.code!==0){txt=validations.msg;valid=false;}});handleInvalidState(txt,valid);}function convertToLocaleDate(dateString){var arr=[],day,localeDay,DAYS_US=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],MONTHS_US=["January","February","March","April","May","June","July","August","September","October","November","December"];if(dateString.indexOf(",")>-1){arr=dateString.split(",");if(arr.length>2){day=arr.shift();localeDay=$LDT.dayNames[$A.indexOf(DAYS_US,day)];}var date=arr[0],year=arr[1],temp=date.replace(/^\s+|\s+$/gm,"").split(" ");var month=temp[0],dayCount=temp[1],localeMonth=$LDT.MONTHNAME_FULL[$A.indexOf(MONTHS_US,month)];return(localeDay?localeDay+", ":"")+localeMonth+" "+dayCount+", "+year;}return dateString;}function resolveDate(){var dde=mstrmojo.all.mstrDDE,t=dde.controls,curr=t.curr.val,res=t.res,result=new Date(curr.getFullYear(),curr.getMonth(),curr.getDate(),curr.getHours(),curr.getMinutes(),curr.getSeconds()),tp=dde.type,data=dde.data={"do":0,dyt:DDE_TYPE[tp],dmo:0,dm:0,dd:0,dw:0,dow:0,dh:0,dmi:0,dr:""},dytAdjustments=getListControlValue(t.dyt),checked=t.adj.checked;var offsetProps={d:(checked?"do":"dd"),m:(checked?"dmo":"dm")},ddo_dir=t.ddo_dir.selectedIndex===0?1:-1,ddo=parseInt(t.ddo.value,10)||0,dmo_dir=t.dmo_dir.selectedIndex===0?1:-1,dynamicMonthOffset=parseInt(t.dmo.value,10)||0,weekDayOfWeek=getListControlValue(t.wdow),monthDynamicDay=parseInt(t.mdd.value,10)||0,monthTheNthDay=getListControlValue(t.mtoff),monthTheDayOfWeek=getListControlValue(t.mtdow),monthReverseMonths=parseInt(t.mrdm.value,10)||0,monthReverseDynamicDay=parseInt(t.mrdd.value,10)||0,quarterDynamicDay=parseInt(t.qdd.value,10)||0,quarterTheNthDay=getListControlValue(t.qtoff),quarterTheDayOfWeek=getListControlValue(t.qtdow),quarterNthMonth=getListControlValue(t.qtoffm),quarterReverseDynamicDay=parseInt(t.qrdd.value,10)||0,yearOnDynamicMonth=getListControlValue(t.yodm),yearOnDynamicDay=parseInt(t.yodd.value,10)||0,yearTheNthDay=getListControlValue(t.ytoff),yearTheDynamicMonth=getListControlValue(t.ytdm),yearTheDayOfWeek=getListControlValue(t.ytdow);result.setDate(result.getDate()+(ddo_dir*ddo));result.setMonth(result.getMonth()+(dmo_dir*dynamicMonthOffset));data[offsetProps.d]=(ddo_dir*ddo);data[offsetProps.m]=(dmo_dir*dynamicMonthOffset);data.dyt+=(checked?dytAdjustments:DYT_ADJUSTEMENTS.NONE);var isExcludeWeekendChecked=t.excl.checked;if(isExcludeWeekendChecked){var numOfWeek=parseInt(ddo/5);var days=ddo%5;result=new Date(curr.getFullYear(),curr.getMonth(),curr.getDate(),curr.getHours(),curr.getMinutes(),curr.getSeconds());result.setMonth(result.getMonth()+(dmo_dir*dynamicMonthOffset));switch(ddo_dir){case OPD.ADD:if(result.getDay()===6){result.setDate(result.getDate()+2);}else{if(result.getDay()===0){result.setDate(result.getDate()+1);}}if(result.getDay()+days>5){days=days+2;}result.setDate(result.getDate()+numOfWeek*7+days);if(result.getDay()===6||result.getDay()===0){result.setDate(result.getDate()+2);}break;case OPD.MINUS:if(result.getDay()===6){result.setDate(result.getDate()-1);}else{if(result.getDay()===0){result.setDate(result.getDate()-2);}}if(result.getDay()<days){days=days+2;}result.setDate(result.getDate()-numOfWeek*7-days);if(result.getDay()===6||result.getDay()===0){result.setDate(result.getDate()-2);}break;}}if(t.adj.checked){var dayNamesWithoutWeekends=$H.clone($LDT.dayNames).slice(1,6);switch(dytAdjustments){case DYT_ADJUSTEMENTS.WEEKLY:t.wdow.items=createNameValueObject(isExcludeWeekendChecked?dayNamesWithoutWeekends:$LDT.dayNames,isExcludeWeekendChecked?1:0);t.wdow.singleSelectByField(isExcludeWeekendChecked?Math.max(1,Math.min(weekDayOfWeek,5)):weekDayOfWeek,"v",true);t.wdow.refresh();weekDayOfWeek=getListControlValue(t.wdow);result.setDate(result.getDate()+weekDayOfWeek-result.getDay());data.dow=weekDayOfWeek;break;case DYT_ADJUSTEMENTS.MONTHLY:t.mtdow.items=createNameValueObject(isExcludeWeekendChecked?dayNamesWithoutWeekends:$LDT.dayNames,isExcludeWeekendChecked?1:0);t.mtdow.singleSelectByField(isExcludeWeekendChecked?Math.max(1,Math.min(monthTheDayOfWeek,5)):monthTheDayOfWeek,"v",true);monthTheDayOfWeek=getListControlValue(t.mtdow);t.mtdow.refresh();switch(getListControlValue(t.mtp)){case MONTH_AND_QUARTER_ADJ_TYPE.DAY:result.setDate(Math.min(monthDynamicDay,$D.getDaysOfMonth(result.getFullYear(),result.getMonth()+1)));data.dd=monthDynamicDay;break;case MONTH_AND_QUARTER_ADJ_TYPE.THE:result.setDate(getNthDayOfMonth(result.getFullYear(),result.getMonth(),monthTheNthDay,monthTheDayOfWeek));data.dw=monthTheNthDay+1;data.dow=monthTheDayOfWeek;break;case MONTH_AND_QUARTER_ADJ_TYPE.REVERSE:result.setMonth(result.getMonth()-monthReverseMonths+1);if(isExcludeWeekendChecked){monthReverseDynamicDay=parseInt(monthReverseDynamicDay/5)*7+(monthReverseDynamicDay%5);}result.setDate(1-monthReverseDynamicDay);if(isExcludeWeekendChecked){if(result.getDay()===0){result.setDate(result.getDate()-2);}else{if(result.getDay()===6){result.setDate(result.getDate()-1);}}}data.dd=-monthReverseDynamicDay;data.dm=-monthReverseMonths;break;}break;case DYT_ADJUSTEMENTS.QUARTERLY:t.qtdow.items=createNameValueObject(isExcludeWeekendChecked?dayNamesWithoutWeekends:$LDT.dayNames,isExcludeWeekendChecked?1:0);t.qtdow.singleSelectByField(isExcludeWeekendChecked?Math.max(1,Math.min(quarterTheDayOfWeek,5)):quarterTheDayOfWeek,"v",true);quarterTheDayOfWeek=getListControlValue(t.qtdow);t.qtdow.refresh();var quarter=parseInt(result.getMonth()/3)+1;switch(getListControlValue(t.qtp)){case MONTH_AND_QUARTER_ADJ_TYPE.DAY:result.setMonth((quarter-1)*3,1);result.setDate(quarterDynamicDay);data.dd=quarterDynamicDay;break;case MONTH_AND_QUARTER_ADJ_TYPE.THE:var month=(quarter-1)*3+quarterNthMonth-1;result.setMonth(month);result.setDate(getNthDayOfMonth(result.getFullYear(),month,quarterTheNthDay,quarterTheDayOfWeek));data.dw=quarterTheNthDay+1;data.dow=quarterTheDayOfWeek;data.dm=quarterNthMonth;break;case MONTH_AND_QUARTER_ADJ_TYPE.REVERSE:result.setMonth(quarter*3,1);result.setDate(1-quarterReverseDynamicDay);if(isExcludeWeekendChecked){if(result.getDay()===0){result.setDate(result.getDate()-2);}else{if(result.getDay()===6){result.setDate(result.getDate()-1);}}}data.dd=-quarterReverseDynamicDay;break;}break;case DYT_ADJUSTEMENTS.YEARLY:t.ytdow.items=createNameValueObject(isExcludeWeekendChecked?dayNamesWithoutWeekends:$LDT.dayNames,isExcludeWeekendChecked?1:0);t.ytdow.singleSelectByField(isExcludeWeekendChecked?Math.max(1,Math.min(yearTheDayOfWeek,5)):yearTheDayOfWeek,"v",true);yearTheDayOfWeek=getListControlValue(t.ytdow);t.ytdow.refresh();switch(getListControlValue(t.ytp)){case YEAR_ADJ_TYPE.ON:result.setMonth(yearOnDynamicMonth);result.setDate(yearOnDynamicDay);data.dd=yearOnDynamicDay;data.dm=yearOnDynamicMonth+1;break;case YEAR_ADJ_TYPE.THE:result.setMonth(yearTheDynamicMonth);result.setDate(getNthDayOfMonth(result.getFullYear(),result.getMonth(),yearTheNthDay,yearTheDayOfWeek));data.dw=yearTheNthDay+1;data.dow=yearTheDayOfWeek;data.dm=yearTheDynamicMonth+1;break;}break;}}var time=t.st.value;if(t.isDynTime.checked){var resultTime=result,dh_dir=t.dh_dir.selectedIndex===0?1:-1,dh=parseInt(t.dh.value,10)||0,dmi_dir=t.dmi_dir.selectedIndex===0?1:-1,dmi=parseInt(t.dmi.value,10)||0;resultTime.setHours(resultTime.getHours()+(dh*dh_dir));resultTime.setMinutes(resultTime.getMinutes()+(dmi*dmi_dir));data.dh=(dh*dh_dir);data.dmi=(dmi*dmi_dir);time=$D.formatTimeInfo($D.getDateJson(resultTime),$LDT.TIMEINPUTFORMATS[0]);}else{data.dyt=DDE_TYPE[ENUMDSSXMLDATATYPES.DATE]+(checked?dytAdjustments:DYT_ADJUSTEMENTS.NONE);var resTime=$D.parseTime(time);data.dh=resTime.hour;data.dmi=resTime.min;}if(isExcludeWeekendChecked){var dayOffset=0,monthBeforeOffset=result.getMonth();switch(ddo_dir){case OPD.ADD:if(result.getDay()===6){dayOffset=2;}else{if(result.getDay()===0){dayOffset=1;}}break;case OPD.MINUS:if(result.getDay()===6){dayOffset=-1;}else{if(result.getDay()===0){dayOffset=-2;}}break;}if(dayOffset!==0){result.setDate(result.getDate()+dayOffset);}if(t.adj.checked){if(dytAdjustments===DYT_ADJUSTEMENTS.MONTHLY&&monthBeforeOffset!==result.getMonth()){if(getListControlValue(t.mtp)===MONTH_AND_QUARTER_ADJ_TYPE.DAY){var dayloopSign=monthBeforeOffset>result.getMonth()?1:-1;do{result.setDate(result.getDate()+dayloopSign);}while(monthBeforeOffset!==result.getMonth()||result.getDay()===6||result.getDay()===0);}}}}res.set("text",convertToLocaleDate(result.toLocaleDateString()));res.val=result;data.dr=$D.formatDateInfo($D.getDateJson(result),$LDT.DATEOUTPUTFORMAT);t.resTime.set("text",time);data.dr+=" "+time;if(result.getTime&&isNaN(result.getTime())){handleInvalidState(mstrmojo.desc(9009,"Your input is invalid."),false);}else{validateInputs();}}function setPlusMinusControls(controls,propName,value){controls[propName+"_dir"].set("selectedIndex",value>=0?0:1);controls[propName].set("value",$ABS(value));}function setChildrenVisibility(children,show){$A.forEach(children,function(c){c.set("visible",show);});}function setupEditor(){var ddeData=this.ddeData,tp=this.type=ddeData.tp,display=tp===ENUMDSSXMLDATATYPES.DATETIME,show=[],hide=[this.layoutsContainer];setChildrenVisibility(this.children.concat(this.preview.children[0].children),display);if(!display){switch(tp){case ENUMDSSXMLDATATYPES.DATE:show=show.concat(this.children[0],this.mainOffsets,this.excl,this.adj,this.preview,this.staticPicker,this.buttonHBox,$A.get(this.preview.children[0].children,[0,1,2,3]));if(this.adj.checked){show.push(this.layoutsContainer);hide.shift();}break;case ENUMDSSXMLDATATYPES.TIME:show=show.concat(this.timeLayoutsContainer,this.timeLayoutsContainer.dynamicTimeLayout,this.preview,this.staticPicker,this.buttonHBox,$A.get(this.preview.children[0].children,[4,5,6,7]));hide=hide.concat(this.timeLayoutsContainer.useDynamicTime,this.timeLayoutsContainer.staticTimeLayout);break;}setChildrenVisibility(show,true);setChildrenVisibility(hide,false);}else{setChildrenVisibility(hide,false);}}function initControls(){setupEditor.call(this);var ddeData=this.ddeData,tp=this.type=ddeData.tp,dyt=ddeData.dyt,ddeType=((tp===ENUMDSSXMLDATATYPES.DATETIME)&&(dyt<DDE_TYPE[tp]))?DDE_TYPE[ENUMDSSXMLDATATYPES.DATE]:DDE_TYPE[tp],controls=this.controls;controls.excl.set("checked",((dyt&DDE_TYPE[ENUMDSSXMLDATATYPES.BUSINESSDAYSAWARE])>0));dyt=dyt&~DDE_TYPE[ENUMDSSXMLDATATYPES.BUSINESSDAYSAWARE];if(tp!==ENUMDSSXMLDATATYPES.TIME){var dytAdjustments=(dyt-ddeType)||DYT_ADJUSTEMENTS.NONE,dow=ddeData.dow||0,dd=ddeData.dd||0,dm=ddeData.dm||0,dw=ddeData.dw||0,dateOffset=(dytAdjustments===DYT_ADJUSTEMENTS.NONE?dd:ddeData["do"])||0,monthOffset=(dytAdjustments===DYT_ADJUSTEMENTS.NONE?dm:ddeData.dmo)||0;switch(dytAdjustments){case DYT_ADJUSTEMENTS.WEEKLY:controls.wdow.set("selectedIndex",dow);break;case DYT_ADJUSTEMENTS.MONTHLY:var mtp=(dw>0)?MONTH_AND_QUARTER_ADJ_TYPE.THE:(dd>0?MONTH_AND_QUARTER_ADJ_TYPE.DAY:MONTH_AND_QUARTER_ADJ_TYPE.REVERSE);controls.mtp.set("selectedIndex",mtp);switch(mtp){case MONTH_AND_QUARTER_ADJ_TYPE.DAY:controls.mdd.set("value",dd);break;case MONTH_AND_QUARTER_ADJ_TYPE.THE:controls.mtoff.set("selectedIndex",dw-1);controls.mtdow.set("selectedIndex",dow);break;case MONTH_AND_QUARTER_ADJ_TYPE.REVERSE:controls.mrdd.set("value",$ABS(dd));controls.mrdm.set("value",$ABS(dm));break;}break;case DYT_ADJUSTEMENTS.QUARTERLY:var qtp=(dw>0)?MONTH_AND_QUARTER_ADJ_TYPE.THE:(dd>0?MONTH_AND_QUARTER_ADJ_TYPE.DAY:MONTH_AND_QUARTER_ADJ_TYPE.REVERSE);controls.qtp.set("selectedIndex",qtp);switch(qtp){case MONTH_AND_QUARTER_ADJ_TYPE.DAY:controls.qdd.set("value",dd);break;case MONTH_AND_QUARTER_ADJ_TYPE.THE:controls.qtoff.set("selectedIndex",dw-1);controls.qtdow.set("selectedIndex",dow);controls.qtoffm.set("selectedIndex",dm-1);break;case MONTH_AND_QUARTER_ADJ_TYPE.REVERSE:controls.qrdd.set("value",$ABS(dd));break;}break;case DYT_ADJUSTEMENTS.YEARLY:var ytp=dd===0?1:0;controls.ytp.set("selectedIndex",ytp);switch(ytp){case YEAR_ADJ_TYPE.ON:controls.yodm.set("selectedIndex",dm-1);controls.yodd.set("value",dd);break;case YEAR_ADJ_TYPE.THE:controls.ytdm.set("selectedIndex",dm-1);controls.ytoff.set("selectedIndex",dw-1);controls.ytdow.set("selectedIndex",dow);break;}break;}setPlusMinusControls(controls,"ddo",dateOffset);setPlusMinusControls(controls,"dmo",monthOffset);controls.adj.set("checked",dytAdjustments!==DYT_ADJUSTEMENTS.NONE);if(dytAdjustments>0){controls.dyt.singleSelectByField(dytAdjustments,"v");}}if(tp!==ENUMDSSXMLDATATYPES.DATE){var isStaticTime=(tp===ENUMDSSXMLDATATYPES.DATETIME&&ddeData.dyt<DDE_TYPE[tp]),dh=ddeData.dh||0,dmi=ddeData.dmi||0;controls.isDynTime.set("checked",!isStaticTime);if(isStaticTime){var resultTime=new Date();resultTime.setHours(dh);resultTime.setMinutes(dmi);controls.st.set("value",$D.formatTimeInfo($D.getDateJson(resultTime),$LDT.TIMEINPUTFORMATS[0]));}else{setPlusMinusControls(controls,"dh",dh);setPlusMinusControls(controls,"dmi",dmi);}}resolveDate();}function createNameValueObject(values,startIndex){var arr=[];$A.forEach(values,function(value){arr.push({n:value,v:startIndex++});});return arr;}mstrmojo.DynamicDateEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.DynamicDateEditor",cssClass:"mstrmojo-DynamicDateEditor",title:mstrmojo.desc(13844,"Dynamic Date"),type:ENUMDSSXMLDATATYPES.DATE,draggable:true,help:"Dynamic_Date_Editor.htm",ddeData:undefined,init:function(props){this._super(props);var mainOffsets=this.mainOffsets,do_ctr=mainOffsets.do_ctr,dmo_ctr=mainOffsets.dmo_ctr,layoutsContainer=this.layoutsContainer,layouts=layoutsContainer.layouts,monthlyCtrls=layouts.monthly.monthlyCtrls,quarterlyCtrls=layouts.quarterly.quarterlyCtrls,yearlyCtrls=layouts.yearly.yearlyCtrls,timeLayoutsContainer=this.timeLayoutsContainer,time=timeLayoutsContainer.dynamicTimeLayout.children[0],preview=this.preview.children[0];this.controls={ddo_dir:do_ctr.ddo_dir,ddo:do_ctr.ddo,dmo_dir:dmo_ctr.dmo_dir,dmo:dmo_ctr.dmo,excl:this.excl,adj:this.adj,dyt:layoutsContainer.dyt,wdow:layouts.weekly.wdow,mtp:layouts.monthly.mtp,mdd:monthlyCtrls.mdd,mtoff:monthlyCtrls.mtoff,mtdow:monthlyCtrls.mtdow,mrdd:monthlyCtrls.mrdd,mrdm:monthlyCtrls.mrdm,qtp:layouts.quarterly.qtp,qdd:quarterlyCtrls.qdd,qtoff:quarterlyCtrls.qtoff,qtdow:quarterlyCtrls.qtdow,qtoffm:quarterlyCtrls.qtoffm,qrdd:quarterlyCtrls.qrdd,ytp:layouts.yearly.ytp,yodm:yearlyCtrls.yodm,yodd:yearlyCtrls.yodd,ytoff:yearlyCtrls.ytoff,ytdow:yearlyCtrls.ytdow,ytdm:yearlyCtrls.ytdm,dh_dir:time.dh_dir,dh:time.dh,dmi_dir:time.dmi_dir,dmi:time.dmi,isDynTime:timeLayoutsContainer.useDynamicTime,st:timeLayoutsContainer.staticTimeLayout.staticTime,curr:preview.currDate,res:preview.resolvedDate,currTime:preview.currTime,resTime:preview.resolvedTime};},postBuildRendering:function postBuildRendering(){this._super();initControls.call(this);},onddeDataChange:function onddeDataChange(){initControls.call(this);},getResolvedDate:function getResolvedDate(){var data=this.data;var dyt=this.excl.checked?data.dyt+DDE_TYPE[ENUMDSSXMLDATATYPES.BUSINESSDAYSAWARE]:data.dyt;return $H.copy(data,{str:["isDyn",dyt,data["do"],data.dmo,data.dm,data.dd,data.dw,data.dow,data.dr,data.dh,data.dmi].join("::")});},switchToStaticDatePicker:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9422,"Define a dynamic date"),cssText:"margin:3px"},{scriptClass:"mstrmojo.HBox",cssClass:"mainOffsets",alias:"mainOffsets",cellPadding:5,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9423,"Today")},{scriptClass:"mstrmojo.HBox",alias:"do_ctr",cellPadding:2,children:[{scriptClass:"mstrmojo.SelectBox",selectedIndex:0,alias:"ddo_dir",size:1,items:createNameValueObject(DIRECTIONS,1),onchange:resolveDate,tstid:"dDir"},createValidationTextBoxWithLabel({scriptClass:"mstrmojo.ValidationTextBox",alias:"ddo",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:0},onValid:resolveDate,onInvalid:validateInputs,size:1,value:"0",tstid:"dayOffset"},mstrmojo.desc(13837,"days"))]},{scriptClass:"mstrmojo.HBox",alias:"dmo_ctr",cellPadding:2,children:[{scriptClass:"mstrmojo.SelectBox",selectedIndex:0,alias:"dmo_dir",size:1,items:createNameValueObject(DIRECTIONS,1),onchange:resolveDate,tstid:"mDir"},createValidationTextBoxWithLabel({scriptClass:"mstrmojo.ValidationTextBox",alias:"dmo",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:0},onValid:resolveDate,onInvalid:validateInputs,size:1,value:"0",tstid:"monthOffset"},mstrmojo.desc(13838,"months"))]}]},{scriptClass:"mstrmojo.CheckBox",alias:"excl",visible:true,cssDisplay:"block",cssClass:"dayadj",label:mstrmojo.desc(11723,"Exclude weekends"),oncheckedChange:function(){resolveDate();},tstid:"exclWknd"},{scriptClass:"mstrmojo.CheckBox",alias:"adj",cssClass:"dayadj  adadj",label:mstrmojo.desc(9426,"Apply additional adjustments"),oncheckedChange:function(){resolveDate();this.parent.layoutsContainer.set("visible",this.checked);},tstid:"adAdj"},{scriptClass:"mstrmojo.Box",alias:"layoutsContainer",visible:false,cssClass:"mstrmojo-DynamicDateEditor-layoutsContainer",children:[{scriptClass:"mstrmojo.SelectBox",alias:"dyt",cssClass:"dyt",size:1,selectedIndex:0,items:[{n:mstrmojo.desc(9705,"Weekly"),v:1},{n:mstrmojo.desc(9704,"Monthly"),v:2},{n:mstrmojo.desc(14339,"Quarterly"),v:11},{n:mstrmojo.desc(9430,"Yearly"),v:3}],onchange:function(){resolveDate();var idx=this.selectedIndex,l=this.parent.layouts,layouts=l.children;l.legendNode.innerHTML=this.items[idx].n;$A.forEach(layouts,function(layout){layout.set("visible",false);});layouts[idx].set("visible",true);},tstid:"adjTyp"},{scriptClass:"mstrmojo.FieldSet",legend:mstrmojo.desc(9705,"Weekly"),alias:"layouts",cssClass:"mstrmojo-DynamicDateEditor-layouts",children:[{scriptClass:"mstrmojo.Box",cssClass:"weekly",alias:"weekly",children:[{scriptClass:"mstrmojo.Label",cssText:"margin:0px 6px;",text:mstrmojo.desc(870,"Select a day:")},{scriptClass:"mstrmojo.SelectBox",size:1,selectedIndex:0,alias:"wdow",items:createNameValueObject($LDT.dayNames,0),onchange:resolveDate,tstid:"wDow"}]},{scriptClass:"mstrmojo.HBox",visible:false,cssClass:"monthly",alias:"monthly",children:[{scriptClass:"mstrmojo.RadioList",alias:"mtp",selectedIndex:0,items:createNameValueObject(ADDITIONAL_ADJSTMENT_TYPE_ARR,0),onchange:resolveDate,tstid:"mTyp"},{scriptClass:"mstrmojo.Table",alias:"monthlyCtrls",cellSpacing:5,rows:3,cols:2,children:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"mdd",constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:1,max:31},onValid:resolveDate,onInvalid:validateInputs,size:1,value:"1",slot:"0,0",tstid:"mDay"},{scriptClass:"mstrmojo.Label",text:"",slot:"0,1"},{scriptClass:"mstrmojo.SelectBox",selectedIndex:0,alias:"mtoff",size:1,onchange:resolveDate,items:createNameValueObject(OFFSETS,0),slot:"1,0",tstid:"mDayOff"},{scriptClass:"mstrmojo.SelectBox",selectedIndex:0,alias:"mtdow",size:1,onchange:resolveDate,items:createNameValueObject($LDT.dayNames,0),slot:"1,0",tstid:"mDow"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9436,"of the month"),slot:"1,1"},createValidationTextBoxWithLabel({scriptClass:"mstrmojo.ValidationTextBox",alias:"mrdd",constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:0,max:31},onValid:resolveDate,onInvalid:validateInputs,size:1,value:"1",slot:"2,0",tstid:"mReDay"},mstrmojo.desc(13837,"days")),createValidationTextBoxWithLabel({scriptClass:"mstrmojo.ValidationTextBox",alias:"mrdm",constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:0},onValid:resolveDate,onInvalid:validateInputs,size:1,value:"0",slot:"2,1",tstid:"mReMo"},mstrmojo.desc(13838,"months"))]}]},{scriptClass:"mstrmojo.HBox",visible:false,cssClass:"quarterly",alias:"quarterly",children:[{scriptClass:"mstrmojo.RadioList",alias:"qtp",selectedIndex:0,items:createNameValueObject(ADDITIONAL_ADJSTMENT_TYPE_ARR,0),onchange:resolveDate,tstid:"qTyp"},{scriptClass:"mstrmojo.Table",alias:"quarterlyCtrls",cellSpacing:5,rows:3,cols:1,children:[{scriptClass:"mstrmojo.ValidationTextBox",alias:"qdd",constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:1,max:90},onValid:resolveDate,onInvalid:validateInputs,size:1,value:"1",slot:"0,0",tstid:"qDay"},{scriptClass:"mstrmojo.SelectBox",selectedIndex:0,alias:"qtoff",size:1,onchange:resolveDate,items:createNameValueObject(OFFSETS,0),slot:"1,0",tstid:"qDayOff"},{scriptClass:"mstrmojo.SelectBox",selectedIndex:0,alias:"qtdow",size:1,onchange:resolveDate,items:createNameValueObject($LDT.dayNames,0),slot:"1,0",tstid:"aDow"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14338,"of the"),slot:"1,0"},{scriptClass:"mstrmojo.SelectBox",selectedIndex:0,alias:"qtoffm",size:1,onchange:resolveDate,items:createNameValueObject(OFFSETS.slice(0,3),1),slot:"1,0",tstid:"qMonOff"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(871,"Month"),slot:"1,0"},createValidationTextBoxWithLabel({scriptClass:"mstrmojo.ValidationTextBox",alias:"qrdd",constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:1,max:90},onValid:resolveDate,onInvalid:validateInputs,size:1,value:"1",slot:"2,0",tstid:"qReDay"},mstrmojo.desc(13837,"days"))]}]},{scriptClass:"mstrmojo.HBox",visible:false,cssClass:"yearly",alias:"yearly",children:[{scriptClass:"mstrmojo.RadioList",alias:"ytp",selectedIndex:0,items:createNameValueObject([mstrmojo.desc(6030,"On"),mstrmojo.desc(9437,"The")],0),onchange:resolveDate,tstid:"yTyp"},{scriptClass:"mstrmojo.Table",alias:"yearlyCtrls",rows:3,cols:1,cellSpacing:5,children:[{scriptClass:"mstrmojo.SelectBox",slot:"0,0",selectedIndex:0,alias:"yodm",size:1,items:createNameValueObject($LDT.MONTHNAME_FULL,0),onchange:function(){var dde=mstrmojo.all.mstrDDE,controls=dde.controls,yodd=controls.yodd,res=controls.res.val;yodd.constraints.max=$D.getDaysOfMonth(res.getFullYear(),parseInt(this.selectedIndex,10)+1);yodd.validate();validateInputs();},tstid:"yOnMon"},{scriptClass:"mstrmojo.ValidationTextBox",constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:1,max:31},slot:"0,0",alias:"yodd",size:1,value:"1",onValid:resolveDate,onInvalid:validateInputs,tstid:"yDay"},{scriptClass:"mstrmojo.SelectBox",slot:"1,0",selectedIndex:0,alias:"ytoff",size:1,items:createNameValueObject(OFFSETS,0),onchange:resolveDate,tstid:"yDayOff"},{scriptClass:"mstrmojo.SelectBox",slot:"1,0",selectedIndex:0,alias:"ytdow",size:1,items:createNameValueObject($LDT.dayNames,0),onchange:resolveDate,tstid:"yDow"},{scriptClass:"mstrmojo.Label",slot:"1,0",cssText:"margin: 4px;vertical-align: middle",text:mstrmojo.desc(12853,"of")},{scriptClass:"mstrmojo.SelectBox",slot:"1,0",selectedIndex:0,alias:"ytdm",size:1,items:createNameValueObject($LDT.MONTHNAME_FULL,0),onchange:resolveDate,tstid:"yMon"}]}]}]}]},{scriptClass:"mstrmojo.Box",alias:"timeLayoutsContainer",visible:false,children:[{scriptClass:"mstrmojo.CheckBox",alias:"useDynamicTime",label:mstrmojo.desc(13839,"Use dynamic time"),oncheckedChange:function(){resolveDate();this.parent.staticTimeLayout.set("visible",!this.checked);this.parent.dynamicTimeLayout.set("visible",this.checked);}},{scriptClass:"mstrmojo.FieldSet",legend:"Static Time",alias:"staticTimeLayout",children:[createValidationTextBoxWithLabel({scriptClass:"mstrmojo.ValidationTextBox",alias:"staticTime",dtp:15,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP},onValid:resolveDate,onInvalid:validateInputs,size:8,value:$D.formatTimeInfo({hour:0,min:0,sec:0},$LDT.TIMEINPUTFORMATS[0])},"Time: ",true)]},{scriptClass:"mstrmojo.FieldSet",visible:false,legend:"Dynamic Time",alias:"dynamicTimeLayout",children:[{scriptClass:"mstrmojo.Table",rows:2,cols:4,alias:"dh_ctr",cellPadding:2,children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(13840,"This hour")},{scriptClass:"mstrmojo.SelectBox",slot:"0,1",selectedIndex:0,alias:"dh_dir",size:1,items:createNameValueObject(DIRECTIONS,1),onchange:resolveDate},createValidationTextBoxWithLabel({scriptClass:"mstrmojo.ValidationTextBox",slot:"0,2",alias:"dh",constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:0,max:23},onValid:resolveDate,onInvalid:validateInputs,size:1,value:"0"},"hours"),{scriptClass:"mstrmojo.Label",slot:"1,0",text:mstrmojo.desc(13841,"This minute")},{scriptClass:"mstrmojo.SelectBox",slot:"1,1",selectedIndex:0,alias:"dmi_dir",size:1,items:createNameValueObject(DIRECTIONS,1),onchange:resolveDate},createValidationTextBoxWithLabel({scriptClass:"mstrmojo.ValidationTextBox",slot:"1,2",alias:"dmi",constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:0,max:59},onValid:resolveDate,onInvalid:validateInputs,size:1,value:"0"},"minutes")]}]}]},{scriptClass:"mstrmojo.FieldSet",legend:mstrmojo.desc(3389,"Preview"),alias:"preview",children:[{scriptClass:"mstrmojo.Table",rows:4,cols:2,cellSpacing:5,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9427,"If today's date is:"),slot:"0,0"},{scriptClass:"mstrmojo.Label",alias:"currDate",cssClass:"resultLabel",postBuildRendering:function postBuildRendering(){this.val=new Date();this.set("text",convertToLocaleDate(this.val.toLocaleDateString()));},slot:"0,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9428,"The date would be resolved to:"),slot:"1,0"},{scriptClass:"mstrmojo.Label",alias:"resolvedDate",cssClass:"resultLabel",text:"",slot:"1,1"},{scriptClass:"mstrmojo.Label",visible:false,text:mstrmojo.desc(13842,"If the current time is:"),slot:"2,0"},{scriptClass:"mstrmojo.Label",visible:false,alias:"currTime",enabled:false,cssClass:"resultLabel",postBuildRendering:function postBuildRendering(){this.val=new Date();this.set("text",$D.formatTimeInfo($D.getDateJson(this.val),$LDT.TIMEINPUTFORMATS[0]));},slot:"2,1"},{scriptClass:"mstrmojo.Label",visible:false,text:mstrmojo.desc(13843,"The time would be resolved to:"),slot:"3,0"},{scriptClass:"mstrmojo.Label",visible:false,alias:"resolvedTime",cssClass:"resultLabel",text:"",slot:"3,1"}]}]},{scriptClass:"mstrmojo.Label",alias:"errorText",cssClass:"errorText",visible:false,text:""},{scriptClass:"mstrmojo.HBox",alias:"buttonHBox",cssClass:"buttonHBox",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"okButton",cssClass:"mstrmojo-Editor-button dde",cssText:"right: 46px;",text:mstrmojo.desc(1442,"OK"),onclick:function onclick(){var dde=this.parent.parent;dde.okCallback(dde.getResolvedDate());dde.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button dde",text:mstrmojo.desc(221,"Cancel"),onclick:function onclick(){this.parent.parent.close();}}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9429,"Swtich to static date"),alias:"staticPicker",cssClass:"staticPicker",onclick:function onclick(){this.parent.switchToStaticDatePicker();}}]});}());
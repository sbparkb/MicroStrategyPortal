(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.all={};var $REGISTRY=mstrmojo.all,$HASH=mstrmojo.hash;var freeIdCounter=0;function getFreeID(){var id;while(!id){var testId="mstr"+(freeIdCounter++);if(!$REGISTRY[testId]){id=testId;}}return id;}mstrmojo.registry=mstrmojo.provide("mstrmojo.registry",{add:function add(obj){if(!obj){return ;}var id=obj.id;if(!id){obj.id=id=getFreeID();}else{if($REGISTRY[id]){throw new Error("Tried to register 2 objects with same id: "+id);}}$REGISTRY[id]=obj;},remove:function rmv(obj){if(obj&&obj.id){delete $REGISTRY[obj.id];}},dumpAll:function(){var o;for(o in $REGISTRY){var id=$REGISTRY[o].id;if(id){mstrmojo.dbg(id+"("+($REGISTRY[o].scriptClass||"[unknown class]")+")");}}},ref:function ref(config,flags){flags=flags||{};if(config){var C=config;while(C){switch(typeof C){case"string":if(flags.skipLoadChecks!==true){mstrmojo.requiresCls(C);}C=$HASH.walk(C,window);break;case"function":return(flags.dontInst!==true)?new C():C;case"object":if(C.constructor===Object){var sc=C.scriptClass;if(sc){if(flags.skipLoadChecks!==true){mstrmojo.requiresCls(sc);}var Cls=$HASH.walk(sc,window);if(Cls){return new Cls((flags.clone===true)?$HASH.clone(C):C);}return null;}return C;}return C;default:return null;}}}return null;}});mstrmojo.insert=mstrmojo.registry.ref;}());
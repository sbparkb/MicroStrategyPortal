(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.Editor","mstrmojo.HBox","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.warehouse.EnumObjectTypes");var $A=mstrmojo.array,$S=mstrmojo.string,$ENUM_OT=mstrmojo.warehouse.EnumObjectTypes,ENUM_OT_PROJECT=$ENUM_OT.PROJECT,KEY_ENTER=13;function submitInfo(){var info=this.info,name=$S.trim(this.namebox.txtname.value),desc=$S.trim(this.descbox.txtdesc.value),projects={};if(!info.isNew){if(name===info.pname){if(info.onCancel){info.onCancel();}this.close();return ;}}$A.forEach(info.projects,function(project){projects[project.projectinfo.id]=project.projectinfo;});if(mstrApp.getRootController().validateName(ENUM_OT_PROJECT,name,((info.isNew?undefined:info.pname)),projects)){info.onOK({name:name,desc:desc});this.close();}}mstrmojo.architect.projectmanagement.ProjectNameInput=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.architect.projectmanagement.ProjectNameInput",cssClass:"mstrmojo-ProjectNameInput",pName:"",info:undefined,txtname:undefined,namebox:undefined,txtdesc:undefined,descbox:undefined,projects:{},onOpen:function onOpen(){this.set("title",this.info.title);var txt=this.namebox.txtname,descbox=this.descbox,name=this.info.pname||"";txt.set("value",name);txt.domNode.focus();descbox.txtdesc.set("value","");descbox.set("visible",(name===""));},children:[{scriptClass:"mstrmojo.Box",alias:"namebox",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-ProjectNameInput-PNameLBL",text:mstrmojo.desc(4245,"project name")},{scriptClass:"mstrmojo.TextBox",cssClass:"mstrmojo-ProjectNameInput-PNameTXT",alias:"txtname",onEnter:function onEnter(){submitInfo.call(this.parent.parent);}}]},{scriptClass:"mstrmojo.Box",alias:"descbox",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-ProjectNameInput-PNameLBL",text:mstrmojo.desc(5235,"description")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-ProjectNameInput-PDescTXT",alias:"txtdesc",onkeydown:function onkeydown(event){var evt=window.event||event.e;if(evt.keyCode===KEY_ENTER){submitInfo.call(this.parent.parent);event.cancel();}}}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button mstrmojo-ProjectNameInput-OKBtn",text:mstrmojo.desc(1442,"OK"),onclick:function onclick(){submitInfo.call(this.parent.parent);}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function onclick(){var e=this.parent.parent;if(e.info&&e.info.onCancel){e.info.onCancel();}e.close();}}]}]});}());
(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.warehouse.EnumObjectTypes");var $ENUM_OT=mstrmojo.warehouse.EnumObjectTypes,STR_RENAME=mstrmojo.desc(12218,"Rename Object"),STR_ENTER_NAME=mstrmojo.desc(11457,"Please enter name:"),STR_LOOKUP=mstrmojo.desc(11440,"(lookup)"),STR_ATT=mstrmojo.desc(518,"Attribute"),STR_DBCONN=mstrmojo.desc(1821,"db conn"),STR_FACT=mstrmojo.desc(11458,"Fact"),STR_TABLE=mstrmojo.desc(7755,"Table");function submitInfo(){var name=mstrmojo.string.trim(this.txtbox.value);if(!this.isNew){if(name===this.originalName){if(this.onCancel){this.onCancel();}this.close();return ;}}if(mstrApp.getRootController().validateName(this.tp||this.data.tp,name,((this.isNew?undefined:this.originalName)))){this.onOK(name);this.close();}}mstrmojo.architect.ui.editors.NameEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.architect.ui.editors.NameEditor",cssClass:"mstrmojo-ar-ne",isNew:false,originalName:"",tp:undefined,txtbox:undefined,error:undefined,onOpen:function onOpen(){var tableData=this.data,name=tableData.n||tableData.name,textBoxWidget=this.txtbox,tbDomNode=textBoxWidget.domNode;name=(name.indexOf(STR_LOOKUP,0)>0)?name.substr(0,name.indexOf(STR_LOOKUP)):name;this.originalName=name;textBoxWidget.set("value",name);tbDomNode.focus();tbDomNode.select();switch(tableData.tp){case $ENUM_OT.ATTRIBUTE:this.set("title",STR_ATT+" - "+tableData.n);break;case $ENUM_OT.FACT:this.set("title",STR_FACT+" - "+tableData.n);break;case $ENUM_OT.TABLE:this.set("title",STR_TABLE+" - "+tableData.n);this.warningBox.set("visible",true);break;case $ENUM_OT.DBROLE:this.set("title",STR_DBCONN);break;default:this.set("title",STR_RENAME);break;}},children:[{scriptClass:"mstrmojo.Label",text:STR_ENTER_NAME},{scriptClass:"mstrmojo.TextBox",alias:"txtbox",onkeyup:function onkeyup(evt){switch(evt.e.keyCode){case 13:submitInfo.call(this.parent);break;case 27:this.parent.close();break;default:break;}}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Warning-Box",alias:"warningBox",visible:false,children:[{scriptClass:"mstrmojo.Box",cssClass:"icon"},{scriptClass:"mstrmojo.Label",text:"This operation requries a schema update and can take a while",cssClass:"message"}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button rightfloat mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function onclick(){submitInfo.call(this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function onclick(){var editor=this.parent.parent;if(editor.onCancel){editor.onCancel();}editor.close();}}]}]});}());
(function(){mstrmojo.requiresCls("mstrmojo.architect.EnumDataChangeEvents","mstrmojo.architect.ui.UnitList","mstrmojo.architect.ui.panels.BaseListPanel");var $A=mstrmojo.array,STR_ADD_LAYER=mstrmojo.desc(11386,"Add Layer"),$ENUM_DATA_CHANGE_EVENTS=mstrmojo.architect.EnumDataChangeEvents,STR_HIDE_LAYERS=mstrmojo.desc(12225,"Hide layers"),STR_DELETE_LAYER_CONFIRM=mstrmojo.desc(12250,"Are you sure you want to delete layer '##'?"),STR_LAYERS=mstrmojo.desc(11142,"Layers");function updateLayerItems(evt){this.contentWidget.set("items",evt.layers);this.layerId=evt.value;}function renameLayerItems(evt){var index=$A.find(this.contentWidget.items,"did",evt.itemID),cw=this.contentWidget;if(index>=0){cw.items[index].n=evt.itemName;cw.refresh();}}mstrmojo.architect.ui.panels.LayerListPanel=mstrmojo.declare(mstrmojo.architect.ui.panels.BaseListPanel,null,{scriptClass:"mstrmojo.architect.ui.panels.LayerListPanel",title:STR_LAYERS,addTitle:STR_ADD_LAYER,init:function init(props){props.showListBtnTitle=STR_HIDE_LAYERS;this._super(props);var evtConfig={},panelConfig=evtConfig[this.id]={};panelConfig[$ENUM_DATA_CHANGE_EVENTS.LAYER_CHANGE]=updateLayerItems;panelConfig[$ENUM_DATA_CHANGE_EVENTS.VIEW_ITEM_RENAMED]=renameLayerItems;mstrApp.getRootController().attachDataChangeListeners(evtConfig);},getContentWidget:function getContentWidget(){var $this=this,rootController=mstrApp.getRootController();return{scriptClass:"mstrmojo.architect.ui.UnitList",singleSelect:function singleSelect(idx){var id=this.items[idx].did;if($this.layerId!==id){rootController.switchLayer(id);}},onItemDeleted:function onItemDeleted(listItem){mstrmojo.confirm(STR_DELETE_LAYER_CONFIRM.replace("##",listItem.n),{confirmBtn:{fn:function(){if(rootController.model.currentlayerID===listItem.did){rootController.closeViewObject();}rootController.deleteLayer(listItem.did);}}});},onItemRenamed:function onItemRenamed(listItem,newName){var id=listItem.did,isValid=rootController.renameLayer(id,newName);if(isValid===true){rootController.updateViewListItem(id,newName);}}};},layerId:"",onItemAdd:function onItemAdd(){mstrApp.getRootController().addLayer(null,true,"");}});}());
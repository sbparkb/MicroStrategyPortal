(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Box","mstrmojo.DataGrid");var $A=mstrmojo.array,STR_SAMPLE_XOFY_ROWS=mstrmojo.desc(12257,"Sample data for table ##  -- (Displaying ** of !! rows)"),STR_SAMPLE_X_ROWS=mstrmojo.desc(12258,"Sample data for table ##  -- (Displaying ** rows)");function nFormatter(num){if(num>=1000000000){return(num/1000000000).toFixed(1)+"G";}if(num>=1000000){return(num/1000000).toFixed(1)+"M";}if(num>=1000){return(num/1000).toFixed(1)+"K";}return num;}mstrmojo.architect.ui.editors.TablePreview=mstrmojo.declare(mstrmojo.Editor,[mstrmojo._FillsBrowser],{scriptClass:"mstrmojo.architect.ui.editors.TablePreview",cssClass:"mstrmojo-Architect-TablePreview",id:"TablePreview",help:null,zIndex:100,dbtn:"",cols:[],dbTableInfo:undefined,onOpen:function onOpen(){var $this=this;var dataGridWidget=$this.gridbox.dataview,dataGridWidth,table=[];dataGridWidget.columns=[];$A.forEach($this.cols,function(col,colIndex){dataGridWidget.columns[colIndex]={dataField:colIndex+1,headerText:col.data[0].v};$A.forEach(col.data,function(data,rowIndex){if(!table[rowIndex]){table[rowIndex]=[];}table[rowIndex][colIndex+1]=data.v;});});table.shift();dataGridWidget.items=table;dataGridWidget.render();if(this.dbTableInfo.sz>=0){$this.set("title",STR_SAMPLE_XOFY_ROWS.replace("##",this.dbtn).replace("**",table.length.toString()).replace("!!",nFormatter(this.dbTableInfo.sz)));}else{$this.set("title",STR_SAMPLE_X_ROWS.replace("##",this.dbtn).replace("**",table.length.toString()));}dataGridWidth=(dataGridWidget.columns.length*120)+"px";dataGridWidget.domNode.style.width=dataGridWidth;$this.titleNode.style.width=$this.editorNode.clientWidth-50+"px";$this.titleNode.title=$this.title;$this.titleNode.innerHTML=$this.title;},onClose:function onClose(){this.gridbox.dataview.unrender();},dataview:undefined,ondragmove:function ondragmove(c){var size=this.getBrowserDimensions(),tarPosition=c.tgt.pos,srcPosition=c.src.pos,deltaX=tarPosition.x-srcPosition.x,deltaY=tarPosition.y-srcPosition.y,left=this._leftPos+deltaX,top=this._topPos+deltaY,targetStyle=this.getMovingTarget().style,maxLeft,maxTop;if(size){maxLeft=parseInt(size.w,10)-this.editorNode.clientWidth;maxTop=parseInt(size.h,10)-this.editorNode.clientHeight;left=Math.min(left,maxLeft);top=Math.min(top,maxTop);}if(left<0){left=0;}if(top<0){top=0;}targetStyle.left=this.left=left+"px";targetStyle.top=this.top=top+"px";},children:[{scriptClass:"mstrmojo.Box",alias:"gridbox",cssClass:"mstrmojo-Architect-TablePreviewGridBox",children:[{scriptClass:"mstrmojo.DataGrid",alias:"dataview",cssClass:"mstrmojo-Architect-TablePreviewGrid",itemDisplayField:20,minColWidth:50,columns:[]}]}]});}());
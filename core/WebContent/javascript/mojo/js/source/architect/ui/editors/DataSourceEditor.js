(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.array","mstrmojo.Editor","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.Button","mstrmojo.Label","mstrmojo.DynamicClassFactory","mstrmojo.ui.Pulldown");var $A=mstrmojo.array,$CFC=mstrmojo.DynamicClassFactory.newComponent;mstrmojo.architect.ui.SimpleList=$CFC(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.architect.ui.SimpleList"});function submitData(){var secondaryList=this.secondaryList,primaryDBRole=this.primaryDBRole;this.close();this.onSubmit({did:this.dataSources.did,primaryId:primaryDBRole.id,primaryName:primaryDBRole.n,secondary:secondaryList.getSelectedItems()});}mstrmojo.architect.ui.editors.DataSourceEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.architect.ui.editors.DataSourceEditor",cssClass:"mstrmojo-ar-DataSourceEditor",title:mstrmojo.desc(4381,"Data Sources"),help:null,primaryPulldown:undefined,secondaryList:undefined,onSubmit:mstrmojo.emptyFn,onOpen:function onOpen(){var v=this.dataSources.dbRoles;this.primaryPulldown.set("items",v);this.primaryPulldown.set("selectedIndex",$A.find(v,"id",this.dataSources.primaryId));},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11387,"Primary Data Source")+":"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"primaryPulldown",onitemSelected:function onitemSelected(item,index){var newItems=this.items.concat(),parent=this.parent,secondaryList=parent.secondaryList;newItems.splice(index,1);secondaryList.clearSelect(true);secondaryList.set("visible",newItems.length!==0);secondaryList.set("items",newItems);var selectedIndices={};$A.forEach(newItems,function buildSelectedIndices(item,idx){selectedIndices[idx]=true;});secondaryList.set("selectedIndices",selectedIndices);parent.primaryDBRole=item;}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11389,"Secondary Data Source(s):")},{scriptClass:"mstrmojo.architect.ui.SimpleList",cssClass:"mstrmojo-ar-SecondaryDBRoles",multiSelect:true,selectionPolicty:"reselect",alias:"secondaryList"},{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(1442,"OK"),slot:"buttonNode",onclick:function(){submitData.call(this.parent);}}]});}());
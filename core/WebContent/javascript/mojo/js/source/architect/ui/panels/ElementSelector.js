(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Label","mstrmojo.array","mstrmojo.architect.ui.panels.ElementsPanel");var $C=mstrmojo.css,STR_ADD=mstrmojo.desc(2218,"Add >"),STR_REMOVE=mstrmojo.desc(12244,"< Remove");mstrmojo.architect.ui.ElementSelector=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.architect.ui.ElementSelector",title:{},left:"",top:"",minWidth:80,maxWidth:25000,maxHeight:30000,minHeight:20,model:null,prevPos:{},container:null,selectedIndex:[],draggable:true,noCheckBox:true,modal:true,zIndex:7,availableList:[],selectedList:[],availableTitle:"Available",selectedTitle:"Selected",callback:null,titleMarkupString:'<div style="position:absolute;width:100%;"><table cellspacing="0" cellpadding="0" class="mstrmojo-Editor-titlebar"><tr><td class="mstrmojo-Editor-titleCell"><div class="mstrmojo-Editor-title mstrmojo-architect-elementSelector-title"><span></span><span></span></div></td><td><a href="#" target="_new" class="mstrmojo-Editor-help"><img class="mstrmojo-Editor-help" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1143,"help")+'"></img></a></td><td><div class="mstrmojo-Editor-close mstrmojo-architect-elementSelector-close" title="'+mstrmojo.desc(2102,"Close")+'"></div></td></tr></table></div><div class="mstrmojo-Editor-titleSpacer"></div>',init:function init(props){this._super(props);this.markupSlots.titleTextNode=function titleTextNode(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild.childNodes[1]:null;};this.markupSlots.titleIconNode=function titleIconNode(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild.rows[0].cells[0].firstChild.childNodes[0]:null;};this.markupMethods.ontitleChange=function(){if(this.showTitle&&this.title){if(this.titleTextNode){this.titleTextNode.innerHTML=this.title.text;$C.addClass(this.titleIconNode,this.title.icon);}}};},setLists:function setLists(){var elementSelector=this,availablePanel=elementSelector.children[0].children[0],selectedPanel=elementSelector.children[0].children[2];availablePanel.setElementsList(elementSelector.availableList);selectedPanel.setElementsList(elementSelector.selectedList);},onOpen:function onOpen(){var elementSelector=this,availablePanel=elementSelector.children[0].children[0],selectedPanel=elementSelector.children[0].children[2];availablePanel.set("title",elementSelector.availableTitle);selectedPanel.set("title",elementSelector.selectedTitle);elementSelector.setLists();},moveItem:function(srcPanel,desPanel,srcList,desList){var srcPanelSearchBox=srcPanel.children[0],desPanelSearchBox=desPanel.children[0],selector=this,selectedElementIndex,selectedElementIndexArr,selectedItem,selectedElementArr,si;selectedElementArr=srcPanel.selectedElementItem();if(selectedElementArr.length>0){selectedElementIndexArr=[];for(si=0;si<selectedElementArr.length;si++){selectedItem=selectedElementArr[si];selectedElementIndex=(isNaN(selectedItem._renderIdx)?0:selectedItem._renderIdx);if(selectedItem.did!==srcList[selectedElementIndex].did){selectedElementIndex=0;while((selectedItem.did!==srcList[selectedElementIndex].did)&&selectedElementIndex<srcList.length){selectedElementIndex++;}}if(selectedElementIndex<srcList.length){selectedElementIndexArr.push(selectedElementIndex);}}selectedElementIndexArr.sort();for(si=selectedElementIndexArr.length-1;si>=0;si--){selectedElementIndex=selectedElementIndexArr[si];desList.push(srcList[selectedElementIndex]);srcList.splice(selectedElementIndex,1);}selector.setLists();}srcPanelSearchBox.triggerSearch();desPanelSearchBox.triggerSearch();},children:[{scriptClass:"mstrmojo.HBox",cssText:"top:0px; height:300px; width:400px;",children:[{scriptClass:"mstrmojo.architect.ui.panels.ElementsPanel",alias:"AvailablePanel",title:"Available",cssText:"width:150px;",width:"200px"},{scriptClass:"mstrmojo.Box",cssText:"top:0px; height:160px; width:100px;",alias:"buttonBox",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",alias:"Add",cssText:"width:20px;height:30px;margin-left:10px;margin-top:10px;",text:STR_ADD,onclick:function(){var availablePanel=this.parent.parent.children[0],selectedPanel=this.parent.parent.children[2],selector=this.parent.parent.parent;selector.moveItem(availablePanel,selectedPanel,selector.availableList,selector.selectedList);}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:20px;height:30px;margin-left:10px;margin-top:10px;",text:STR_REMOVE,alias:"Remove",onclick:function(){var availablePanel=this.parent.parent.children[0],selectedPanel=this.parent.parent.children[2],selector=this.parent.parent.parent;selector.moveItem(selectedPanel,availablePanel,selector.selectedList,selector.availableList);}}]},{scriptClass:"mstrmojo.architect.ui.panels.ElementsPanel",title:"Selected",alias:"SelectedPanel",cssText:"height:160px; width:150px;",width:"200px"}]},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-architect-selector-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var selector=this.parent.parent;if(selector.callback&&selector.callback.success){selector.callback.success(selector.availableList,selector.selectedList);}selector.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button rightfloat",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var selector=this.parent.parent;selector.close();}}]}]});}());
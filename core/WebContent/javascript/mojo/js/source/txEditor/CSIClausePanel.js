(function(){mstrmojo.requiresCls("mstrmojo.FieldSet","mstrmojo.dom","mstrmojo.hash","mstrmojo.Label","mstrmojo.TextArea","mstrmojo.txEditor.CSIStatementTokenInput","mstrmojo.txEditor.CommonComponent");var $H=mstrmojo.hash,_TC=mstrmojo.txEditor.CommonComponent,LabelHeight=25;function createEmptyArray(){return[];}mstrmojo.txEditor.CSIClausePanel=mstrmojo.declare(mstrmojo.FieldSet,null,{scriptClass:"mstrmojo.txEditor.CSIClausePanel",cssClass:"mstrmojo-TransactionEditor-CSIClausePanel",clauseIdx:0,clearInputs:function clearInputs(){this.clInput.clearTokens();},postBuildRendering:function postBuildRendering(){this._super();if(!this._clauseModifyListener){this._clauseModifyListener=this.clInput.attachEventListener("clauseModify",this.id,"onclauseChange");}},isActive:function isActive(){var offTxs=mstrmojo.all.offModel.offTxs,tknstrm=offTxs&&offTxs.tknstrm,csType=tknstrm&&tknstrm.csType;return csType===this.st;},onclauseChange:function onclauseChange(evt){if(this.isActive()&&evt.name==="clauseModify"){var clauses=mstrmojo.all.offModel.offTxs.tknstrm.clauses,prefixItems=this.getPrefixItems(),postItems=this.getPostItems();if(clauses){clauses[this.clauseIdx]=prefixItems.concat(this.clInput.items).concat(postItems);}}},getPrefixItems:createEmptyArray,getPostItems:createEmptyArray,_preprocessTokenStream:mstrmojo.emptyFn,markupMethods:$H.copy({onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";this.clInput.set("height",this.height-this.clLabel.getHeight()-2);}}},$H.copy(mstrmojo.FieldSet.prototype.markupMethods)),children:[_TC.createLabel({cssClass:"mstrmojo-TransactionEditor-CSIClauseLabel",alias:"clLabel",height:LabelHeight,cssText:"height:"+LabelHeight+"px;line-height:"+LabelHeight+"px;margin:0px",bindings:{text:function(){var prefix=this.parent.labelPrefix,name=this.parent.dsName,suffix=this.parent.labelSuffix,t=prefix;if(name){t+=(" "+name);t+=(suffix?(" "+suffix):"");}return t;}},getHeight:function(){return this.height;}}),{scriptClass:"mstrmojo.txEditor.CSIStatementTokenInput",isActive:function(){return this.active&&this.parent.isActive();},alias:"clInput"}],destroy:function destroy(ignoreDOM){if(this._clauseModifyListener){this.clInput.detachEventListener(this._clauseModifyListener);}this._super(ignoreDOM);}});}());
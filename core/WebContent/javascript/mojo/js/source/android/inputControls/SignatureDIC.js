(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.Button","mstrmojo.url");mstrmojo.requiresDescs(1442,2140);var $NIB=mstrmojo.Button.newInteractiveButton;mstrmojo.android.inputControls.SignatureDIC=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton],{scriptClass:"mstrmojo.android.inputControls.SignatureDIC",markupString:"<div></div>",hasSignature:false,showInPopup:function showInPopup(){var ownerObj=this.ownerCell||this.owner;if(ownerObj.mdf){var me=this;mstrmojo.confirm("Continuing will erase the existing signature. Do you want to proceed?",[$NIB(mstrmojo.desc(2140,"Cancel"),null,null),$NIB(mstrmojo.desc(1442,"Ok"),function(){me.captureSignature();},null)]);}else{this.captureSignature();}},captureSignature:function captureSignature(){mstrMobileApp.captureSignature(JSON.stringify({serverURL:mstrApp.getConfiguration().getTaskUrlByProject(mstrApp.getCurrentProjectId()),sessionState:mstrApp.getSessionState(),showGuideLine:this.dic.sgl}),'mstrmojo.all["'+this.id+'"].signatureCaptured');},signatureCaptured:function signatureCaptured(imagePath){this.value=mstrmojo.url.getAbsoluteURL(imagePath,mstrApp.getConfiguration().getCurrentProjectWebServerUrl());this.applyChanges();},renderPreview:function renderPreview(){var previewValue="",ownerObj=this.ownerCell||this.owner,openerNode=this.openerNode,sigValue=this.value;if(ownerObj.mdf&&/^(http|https).+(png|jpg)$/.test(sigValue)){previewValue='<img src="'+this.value+'" style="max-height:'+openerNode.clientHeight+"px;max-width:"+(openerNode.clientWidth-30)+'px;"></img>\u00a0';}this.renderPreviewButton(openerNode,previewValue);}});}());
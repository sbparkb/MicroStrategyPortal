(function(){mstrmojo.requiresCls("mstrmojo.android.controllers.ViewController","mstrmojo.android.controllers._HasFolderView","mstrmojo.android.EnumMenuOptions");mstrmojo.requiresDescs(1089);var REFRESH=mstrmojo.android.EnumMenuOptions.REFRESH;function loadSubscriptions(refresh){var me=this,callback=function(res){var view=me.view,rootCtrl=me.rootCtrl;view.set("items",res.items);rootCtrl.contentUpdated(2048);me.updatePropertiesMsg();};mstrApp.modelFactory.newDataService("Subscriptions").getSubscriptions({success:callback,failure:function(details){if(mstrApp.isHosted()){callback({items:[{n:"Subscriptions Unavailable"}]});}else{me.viewFailed(details);}}},refresh);}mstrmojo.android.controllers.SubscriptionsController=mstrmojo.declare(mstrmojo.android.controllers.ViewController,[mstrmojo.android.controllers._HasFolderView],{scriptClass:"mstrmojo.android.controllers.SubscriptionsController",init:function init(params){this._super(params);var publisher=mstrmojo.publisher;publisher.subscribe(publisher.NO_SRC,publisher.RECONCILE_END_EVENT,function(){loadSubscriptions.call(this,true);},this.id);},start:function start(params){this._super(params);this.csp=params.csp;var id=this.id,view=this.initFolderView(function(item){var controller=mstrmojo.all[id],subtype=item.st;if(subtype){controller.spawn(mstrApp.controllerFactory.newController(controller.getViewKey(subtype),item),item);}else{this.clearSelect();}});this.rootCtrl.updateFolder(view);loadSubscriptions.call(this,false);},getDefaultMessage:function getDefaultMessage(){return"Select a subscription to view its content.";},makeCurrent:function makeCurrent(isBack){this._super(isBack);var rootCtrl=this.rootCtrl;rootCtrl.updateFolder(this.view);rootCtrl.restoreNavigation();this.updatePropertiesMsg();},goUp:function goUp(){if(!this._super()){this.rootCtrl.goBack();}return true;},updateActionToolbar:function updateActionToolbar(tbCfg){tbCfg.addMenuItem(REFRESH,mstrmojo.desc(773,"Refresh"),REFRESH,true,5);return this._super(tbCfg);},handleMenuItem:function handleMenuItem(group,command){if(group===REFRESH){mstrMobileApp.restartReconciler();return ;}this._super(group,command);}});}());
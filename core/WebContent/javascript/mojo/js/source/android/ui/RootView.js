(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo._TouchGestures","mstrmojo.Box","mstrmojo.Label","mstrmojo.dom","mstrmojo.css","mstrmojo.android.ui.ActionBarNative");var $CSS=mstrmojo.css;mstrmojo.requiresDescs(2901,8445);function updateRootOrientationClass(){var add="rootPortrait",remove="rootLandscape",node=this.domNode;if(mstrApp.isLandscape()){var x=add;add=remove;remove=x;}$CSS.removeClass(node,remove);$CSS.addClass(node,add);}mstrmojo.android.ui.RootView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser,mstrmojo._HasLayout,mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.ui.RootView",markupString:'<div id="{@id}" class="mstrmojo-RootView {@cssClass}" style="{@cssText}" ><div class="mstrmojo-RootView-title"></div><div class="mstrmojo-RootView-content"></div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},layoutConfig:{h:{titleNode:"auto",containerNode:"100%"},w:{titleNode:"100%",containerNode:"100%"}},actionBar:null,preBuildRendering:function preBuildRendering(){$CSS.addClass(document.body,"dpi"+mstrMobileApp.getDeviceDPI());if(!this.msgBox){var msgBox=this.msgBox=new mstrmojo.Box({placeholder:"mainAppMsg",cssClass:"mstrmojo-RootViewMessage",cssText:"left:-10000px;",children:[{scriptClass:"mstrmojo.Label",alias:"lbl",text:mstrmojo.desc(2901,"Loading...")}]});msgBox.render();}var viewFactory=mstrApp.viewFactory,children=[viewFactory.newView("Switcher",{slot:"containerNode",alias:"switcher"})];if(mstrApp.isActionBarNative()){this.actionBar=new mstrmojo.android.ui.ActionBarNative();}else{children.push(viewFactory.newView("ActionBar",{slot:"titleNode",alias:"actionBar",controller:mstrmojo.all[this.controllerId]}));}this.addChildren(children);return this._super();},postBuildRendering:function postBuildRendering(){updateRootOrientationClass.call(this);var titleNode=this.titleNode;if(!this._tchHandler){this._tchHandler=mstrmojo.touchManager.attachEventListener("actionBarMenuStateChange",this.id,function(evt){if(evt.value){$CSS.addClass(titleNode,"top");}else{$CSS.removeClass(titleNode,"top");}});}return this._super();},unrender:function unrender(ignoreDom){if(this._tchHandler){mstrmojo.touchManager.detachEventListener(this._tchHandler);delete this._tchHandler;}this._super(ignoreDom);},setNavigation:function setNavigation(navItems,idx){this.actionBar.setNavigation(navItems,idx);},getTitleHeight:function getTitleHeight(){return this.titleNode.offsetHeight;},clearNavigation:function clearNavigation(){this.actionBar.clearNavigation();},restoreNavigation:function restoreNavigation(){this.actionBar.restoreNavigation();},selectNavigationItem:function selectNavigationItem(navItem){return this.actionBar.selectNavigationItem(navItem);},hasNavigationItems:function hasNavigationItems(){return this.actionBar.hasNavigationItems();},reset:function reset(){this.actionBar.reset();},setContent:function setContent(view,isBack){this.reset();this.switcher.switchView(view,isBack);},contentUpdated:function contentUpdated(){this.reset();},setTitle:function setTitle(text){this.actionBar.updateTitle(text);},setActionToolbar:function setActionToolbar(id,tbCfg){this.actionBar.updateToolbar(id,tbCfg);},setActionToolbarStatus:function setActionToolbarStatus(isActive){this.actionBar.setActionToolbarStatus(isActive);},setUpStatus:function setUpStatus(isActive){this.actionBar.setUpStatus(isActive);},updateLastOpened:function updateLastOpened(items){this.actionBar.setLastOpened(items);},monitorWindow:function monitorWindow(){var dimensions=mstrApp.getScreenDimensions();this._super({currentTarget:{innerWidth:dimensions.w,innerHeight:dimensions.h}});updateRootOrientationClass.call(this);mstrmojo.all[this.controllerId].set("orientation",(mstrMobileApp.getOrientation()===mstrmojo.android.EnumOrientationTypes.PORTRAIT)?1:0);window.setTimeout(function(){mstrMobileApp.setWaitScreenVisibility(false);},0);},setDimensions:function setDimensions(h,w){this._super(h,w);var msgBox=this.msgBox;msgBox.set("height",this.height);msgBox.set("width",this.width);},getBrowserDimensions:function(){var dimensions=mstrApp.getScreenDimensions(),px="px";return{h:dimensions.h+px,w:dimensions.w+px};},getContentDimensions:function getContentDimensions(){var containerNode=this.containerNode;return{h:containerNode.clientHeight,w:containerNode.clientWidth};},showMessage:function showMessage(text){mstrMobileApp.showProgress([text||mstrmojo.desc(8445,"Loading")],false);},showHTMLProgress:function showHTMLProgress(text){var loadingCurtain=this.msgBox,loadingCurtainStyle=loadingCurtain.domNode.style,loadingLabel=loadingCurtain.lbl,lblNode=loadingLabel.domNode,lblNodeStyle=lblNode.style;loadingLabel.set("text",text||mstrmojo.desc(2901,"Loading..."));lblNodeStyle.left=Math.round(parseInt(this.width,10)/2-lblNode.offsetWidth/2)+"px";lblNodeStyle.top=Math.round(parseInt(this.height,10)/2-lblNode.offsetHeight/2)+"px";loadingCurtainStyle.left=0;loadingCurtainStyle.top=0;$CSS.addClass(loadingCurtain.domNode,"active");loadingCurtainStyle.opacity=1;},hideMessage:function hideMessage(){mstrMobileApp.hideProgress();},hideHTMLProgress:function hideHTMLProgress(){var loadingCurtain=this.msgBox.domNode,loadingCurtainStyle=loadingCurtain.style;loadingCurtainStyle.opacity=0;loadingCurtainStyle.left="-10000px";$CSS.removeClass(loadingCurtain,"active");},enterFullScreen:function enterFullScreen(){this.actionBar.enterFullScreen();},flashFullScreen:function flashFullScreen(){this.actionBar.flashFullScreen();},exitFullScreen:function exitFullScreen(animate){this.actionBar.exitFullScreen(animate);},cancelFlashFullScreen:function cancelFlashFullScreen(){return this.actionBar.cancelFlashFullScreen();},propogateMenuVisibleChange:function propogateMenuVisibleChange(isVisible){this.actionBar.propogateMenuVisibleChange(isVisible);}});}());
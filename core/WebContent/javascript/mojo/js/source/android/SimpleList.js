(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.android._IsList","mstrmojo.css","mstrmojo.dom","mstrmojo.array");var $DOM=mstrmojo.dom,$CSS=mstrmojo.css;function selectNode(touch,mthName){var item=$DOM.findAncestorByAttr(touch.target,"idx",true,this.domNode);if(item){var v=item.value,ir=this.itemRenderer;ir[mthName](item.node,this.items[v],v,this);}}mstrmojo.android.SimpleList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo.android._IsList,mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.android.SimpleList",scrollerConfig:{bounces:false,showScrollbars:false},highlightOnSelect:false,hasEvenRows:false,rowHeight:-1,itemsFloat:false,init:function init(props){this._super(props);if(!mstrApp.isTouchApp()){$CSS.addWidgetCssClass(this,["hosted"]);}},updateItem:function updateItem(idx){var div=document.createElement("div"),item=this.items[idx],me=this;div.innerHTML=this.itemRenderer.render(this.items[idx],idx,this);var newEl=div.firstChild;this.itemsContainerNode.replaceChild(newEl,this._getItemNode(idx));mstrmojo.array.forEach(item.dependents,function(d){me.updateItem(d._renderIdx);});return newEl;},setDimensions:function setDimensions(h,w){if(this.height!==h||this.width!==w){this.height=h;this.width=w;var dn=this.domNode;if(dn){dn.style.height=h;dn.style.width=w;this.updateScroller();}}},buildRendering:function buildRendering(){var rtn=this._super();if(this.itemsFloat){var clearDiv=document.createElement("div");clearDiv.className="clear-me";this.itemsContainerNode.appendChild(clearDiv);}return rtn;},updateScrollerConfig:function updateScrollerConfig(){var cfg=this._super(),icn=this.itemsContainerNode,h=parseInt(this.height,10);if(isNaN(h)){h=this.domNode.clientHeight;}cfg.scrollEl=icn;cfg.noHScroll=true;cfg.origin=cfg.origin||{x:0,y:0};var offsetIdx=cfg.offsetIdx;if(offsetIdx){delete cfg.offsetIdx;cfg.origin.y=this.getItemOffset(offsetIdx);}var offsetEnd=Math.max(this.getItemsContainerHeight()-h,0);var enableScroll=cfg.vScroll=(offsetEnd!==0&&cfg.noVScroll!==true);if(enableScroll){cfg.offset={y:{start:0,end:offsetEnd}};}else{cfg.offset=null;}return cfg;},getItemOffset:function getItemOffset(idx){var node=this._getItemNode(idx);return Math.max(node.offsetTop-parseInt($CSS.getStyleValue(node,"marginTop"),10),0);},getOffsetIndex:function getOffsetIndex(){var cfg=this.scrollerConfig,origin=cfg&&cfg.origin,y=origin&&origin.y;if(y){var rowHeight=this.rowHeight;if(this.hasEvenRows&&rowHeight!==-1){return Math.round(y/rowHeight);}var nodes=this.itemsContainerNode.childNodes,min=0,max=nodes.length-1;while(max>=min){var mid=min+max>>1,testNode=nodes[mid],nodeY=testNode.offsetTop,nodeH=testNode.offsetHeight;if(y<nodeY-nodeH){max=mid-1;}else{if(y>nodeY+(nodeH*2)){min=mid+1;}else{return mid;}}}}return 0;},scrollToItem:function scrollToItem(idx,duration){var scroller=this._scroller;if(scroller){scroller.scrollTo(0,this.getItemOffset(idx),duration||0);}},getItemsContainerHeight:function getItemsContainerHeight(){var hasEvenRows=this.hasEvenRows,rtn;if(!hasEvenRows||this.rowHeight===-1){if(hasEvenRows){var firstItem=this._getItemNode(0);if(firstItem){this.rowHeight=firstItem.offsetHeight;}}else{this.rowHeight=-1;}rtn=this.itemsContainerNode.offsetHeight;}else{var items=this.items;rtn=(this.rowHeight*((items&&items.length)||0));}return rtn;},touchSelectBegin:function touchSelectBegin(touch){if(this.highlightOnSelect){selectNode.call(this,touch,"select");}this._super(touch);},touchSelectMove:function touchSelectMove(touch){this._selectMove=true;this._super(touch);},touchSelectEnd:function touchSelectEnd(touch){var wasMoved=this._selectMove;delete this._selectMove;if(!wasMoved){this.touchTap(touch);}else{if(this.highlightOnSelect){selectNode.call(this,touch,"unselect");}}},touchend:mstrmojo.emptyFn});}());
(function(){mstrmojo.requiresCls("mstrmojo.android.Popup","mstrmojo.array","mstrmojo.android.TextArea","mstrmojo._TouchGestures","mstrmojo.android.ui.Button","mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.android.nativedialog.AlertDialog");mstrmojo.requiresDescs(1442);var $CSS=mstrmojo.css,$DOM=mstrmojo.dom,$ARR=mstrmojo.array,$HASH=mstrmojo.hash;var $DIALOG=mstrmojo.android.Dialog=mstrmojo.declare(mstrmojo.android.Popup,[mstrmojo._TouchGestures],{scriptClass:"mstrmojo.android.Dialog",autoClose:false,btnVisible:true,init:function init(props){this._super(props);var css=["dialog"];if(this.title){css.push("has-ttl");}if(props.anchor){this.curtainPosition=mstrApp.getContentPosition();}$CSS.addWidgetCssClass(this,css);},preBuildRendering:function preBuildRendering(){var buttons=this.buttons;if(buttons&&!this.btnHbox){var ths=this,id=this.id,fn=function(){if(!ths.manualClose){window.setTimeout(function(){var dialog=mstrmojo.all[id];if(dialog){dialog.close();}},50);}};$ARR.forEach(buttons,function(btn){btn.origFn=btn.onclick;btn.onclick=function(event){if(this.origFn){if(this.origFn()===false){return ;}}fn();event.e.stopPropagation();event.e.cancelBubble=true;};});}this._super();},postBuildRendering:function postBuildRendering(){if(this.onTitleClick){var id=this.id;$DOM.attachEvent(this.titleNode,"click",function(evt){mstrmojo.all[id].onTitleClick(evt);});}return this._super();},getResizeHandler:function getResizeHandler(){var id=this.id,fn=function(){var dialog=mstrmojo.all[id];if(dialog.dialogRefresh){dialog.dialogRefresh();}else{dialog.resizeDialog();dialog.positionDialog();}};return fn;},resizeDialog:function resizeDialog(){this._super();var buttonCnt=this.buttons&&this.buttons.length;if(buttonCnt){var buttonNode=this.buttonNode,btnVisible=this.btnVisible;if(!btnVisible){this.set("btnVisible",true);}var btns=this.btnHbox.children,$CS=$CSS.getComputedStyle,slotStyle=$CS(buttonNode),btnStyle=$CS(btns[0].domNode);var availWidth=buttonNode.clientWidth-parseInt(slotStyle.paddingLeft,10)-parseInt(slotStyle.paddingRight,10),btnOffset=parseInt(btnStyle.paddingLeft,10)+parseInt(btnStyle.paddingRight,10)+parseInt(btnStyle.borderLeftWidth,10)+parseInt(btnStyle.borderRightWidth,10),btnSpace=availWidth-(buttonCnt*btnOffset);var buttonWidth=Math.floor(btnSpace/buttonCnt);$ARR.forEach(btns,function(btn){btn.set("width",buttonWidth+"px");});this.set("btnVisible",btnVisible);}},resizeCurtain:function resizeCurtain(){var curtainNode=this.curtainNode,body=document.body,cs=curtainNode.style,curtainPosition=this.curtainPosition;cs.width=body.scrollWidth+"px";if(curtainPosition&&curtainPosition.h){cs.height=curtainPosition.h+"px";}else{cs.height=body.scrollHeight+"px";}if(curtainPosition&&curtainPosition.y){cs.top=curtainPosition.y+"px";}this.raiseEvent({name:"resizeCurtain"});},setButtonVisibility:function setButtonVisibility(isVisible){this.buttonNode.style.display=isVisible?"block":"none";},createTitleBarButton:function createTitleBarButton(className,fn,title){var bl=document.createElement("div");bl.className=className;bl.setAttribute("title",title||"");bl[(mstrApp.isTouchApp())?"ontouchend":"onclick"]=fn;this.titleNode.appendChild(bl);}});var markupMethods=$HASH.copy($DIALOG.prototype.markupMethods);markupMethods.onbtnVisibleChange=function(){this.buttonNode.style.display=(this.btnVisible)?"block":"none";};$DIALOG.prototype.markupMethods=markupMethods;if(window.mstrConfig&&!window.mstrConfig.simpleDialog){var fnGetLabelChild=function(msg){return[{scriptClass:"mstrmojo.android.TextArea",text:msg,cssClass:"mstrmojo-androidAlert",isElastic:true}];};mstrmojo.alert=function alrt(msg,fn,title){var config={title:title||"MicroStrategy Mobile",buttons:[mstrmojo.android.ui.Button.newButton(mstrmojo.desc(1442,"OK"),function(){if(fn){fn();}})],children:fnGetLabelChild(msg)};if(mstrApp.useBinaryFormat){$HASH.copy({isNative:true,scriptClass:"mstrmojo.android.nativedialog.AlertDialog"},config);}mstrApp.showDialog(config);};mstrmojo.confirm=function confirm(msg,buttons,title){var config={title:title||"MicroStrategy Mobile",buttons:buttons,children:fnGetLabelChild(msg)};if(mstrApp.useBinaryFormat){$HASH.copy({isNative:true,scriptClass:"mstrmojo.android.nativedialog.AlertDialog"},config);}mstrApp.showDialog(config);};mstrmojo.toast=function toast(msg,duration,callback){mstrApp.showToastNotification(msg,duration||3500);if(callback){window.setTimeout(function(){callback();},duration);}};mstrmojo.mask={show:function show(msg){mstrMobileApp.showProgress([msg||""],false);},hide:function hide(){mstrMobileApp.hideProgress();}};}}());
(function(){mstrmojo.requiresCls("mstrmojo.android.nativedialog.EditTextDialog","mstrmojo.android.nativedialog.ListDialog","mstrmojo.android.nativedialog.SliderDialog","mstrmojo.android.nativedialog.TimePickerDialog","mstrmojo.android.nativedialog.DatePickerDialog","mstrmojo.android.nativedialog.DateTimePickerDialog","mstrmojo.array","mstrmojo.num","mstrmojo.string");var TEXTFIELD=1,LIST=3,SLIDER=4,CALENDAR=5,TIMEPICKER=6,TEXTAREA=8,$ARR=mstrmojo.array;function getTextValidator(dic){var validator={type:dic.vm};$ARR.forEach(["emin","emax","ml","mnl","rgx","dt"],function(prop){if(!!dic[prop]){if(prop=="emin"||prop=="emax"){prop=(prop=="emin")?"min":"max";}validator[prop]=dic[prop];}});if(dic.req||dic.emin){validator.req=true;}return validator;}function setListOnSelectionChange(config){var dicWidget=config.widget;config.onSelectionChange=function(index){dicWidget.set("value",dicWidget.items[index].v);dicWidget.applyChanges();this.close();};delete config.buttons;}function setPositiveButtonOnClick(config,preApplyChanges){var dicWidget=config.widget;getPositiveButton(config).onclick=function(value){preApplyChanges(value);dicWidget.applyChanges();};}function getCalendarPreApplyChanges(dicWidget){var preApplyChanges=function(value){var newDate=eval("("+value+")");if(dicWidget.dic.ict){dicWidget.updateDateAndTime(newDate);}else{dicWidget.updateDate(newDate.date);}};return preApplyChanges;}function getPositiveButton(config){return config.buttons[1];}function getNegativeButton(config){return config.buttons[0];}mstrmojo.android.nativedialog.DICDialogFactory=mstrmojo.provide("mstrmojo.android.nativedialog.DICDialogFactory",{createDICDialog:function createDICDialog(config){var clazz,dicWidget=config.widget,dic=dicWidget.dic,preApplyChanges=function(value){dicWidget.set("value",value);};config.children=[dicWidget];delete getNegativeButton(config).onclick;switch(dic.t){case TEXTFIELD:case TEXTAREA:preApplyChanges=function(value){dicWidget.set("value",mstrmojo.string.decodeHtmlString(value));};config.validator=getTextValidator(dic);clazz=mstrmojo.android.nativedialog.EditTextDialog;break;case LIST:setListOnSelectionChange(config);dicWidget.items=dicWidget._items;dicWidget.selectedIndex=$ARR.find(dicWidget.items,"v",dicWidget.value);clazz=mstrmojo.android.nativedialog.ListDialog;break;case SLIDER:clazz=mstrmojo.android.nativedialog.SliderDialog;break;case CALENDAR:preApplyChanges=getCalendarPreApplyChanges(dicWidget);clazz=dicWidget.dic.ict?mstrmojo.android.nativedialog.DateTimePickerDialog:mstrmojo.android.nativedialog.DatePickerDialog;break;case TIMEPICKER:preApplyChanges=function(newTime){dicWidget.updateTime(eval("("+newTime+")").time);};clazz=mstrmojo.android.nativedialog.TimePickerDialog;break;}if(dic.t!==LIST){setPositiveButtonOnClick(config,preApplyChanges);}return new clazz(config);},showDialog:function showDialog(config){this.createDICDialog(config).show();}});}());
(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasOwnAvatar","mstrmojo.array","mstrmojo.dom","mstrmojo.hash");var $H=mstrmojo.hash,$D=mstrmojo.dom,HEIGHT_PROP="h",WIDTH_PROP="w",HNDRDPCT="100%",STYLE_DISPLAY_NONE="none",ENUM_OR={HORIZONTAL:0,VERTICAL:1},OR_HORIZONTAL=ENUM_OR.HORIZONTAL,CSS_CLASS_HORIZONTAL="horizontal",CSS_CLASS_VERTICAL="vertical",DEFAULT_VALUES={firstSplitNode:"300px",resizeHandleNode:"5px",secondSplitNode:HNDRDPCT};function getLayoutConfig(){var config=this.config,orientation=this.orientation,splitterDim=(orientation===OR_HORIZONTAL)?WIDTH_PROP:HEIGHT_PROP,otherDim=(orientation===OR_HORIZONTAL)?HEIGHT_PROP:WIDTH_PROP,NODE_NAME="Node",newLC=this.layoutConfig||{};newLC.xt=true;newLC[splitterDim]=newLC[splitterDim]||$H.copy(DEFAULT_VALUES);newLC[otherDim]=newLC[otherDim]||{firstSplitNode:HNDRDPCT,resizeHandleNode:HNDRDPCT,secondSplitNode:HNDRDPCT};var splitValues=newLC[splitterDim];$H.forEach(config,function(value,key){splitValues[key+NODE_NAME]=value.v;});return newLC;}function applyDimensions(pos){var widgetPos=this._wPos,prop=(this.orientation===OR_HORIZONTAL)?"x":"y",value=pos[prop]-widgetPos[prop],config=this.config,firstSplitCfg=config.firstSplit,secondSplitCfg=config.secondSplit,firstMin=parseInt(firstSplitCfg.min,10),secondMin=parseInt(secondSplitCfg.min,10),isValuePX=(firstSplitCfg.v.indexOf("px")>-1),totalValue=parseInt((this.orientation===OR_HORIZONTAL)?this.width:this.height,10);if(!isValuePX){if(value===totalValue){value=totalValue*(parseInt(firstSplitCfg.v,10)/100);}}var maxValue=totalValue-secondMin,firstPanelPixelValue=Math.floor(Math.min(Math.max(value,firstMin),maxValue));if(this.applyPercentage){var firstPanelPercentValue=Math.round((firstPanelPixelValue/totalValue)*100),secondPanelPixelValue=(totalValue-parseInt(config.resizeHandle.v,10)-firstPanelPixelValue),secondPanelPercentValue=Math.round((secondPanelPixelValue/totalValue)*100);if((firstPanelPercentValue+secondPanelPercentValue)<100){secondPanelPercentValue+=(100-(firstPanelPercentValue+secondPanelPercentValue));}firstSplitCfg.v=firstPanelPercentValue+"%";secondSplitCfg.v=secondPanelPercentValue+"%";}else{firstSplitCfg.v=firstPanelPixelValue+"px";secondSplitCfg.v="100%";}this.layoutConfig=getLayoutConfig.call(this,config);this.doLayout();}mstrmojo.ui.Splitter=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.ui.Splitter",markupString:'<div id="{@id}" class="mstrmojo-Splitter {@orientationCss} {@cssClass}"><div class="mstrmojo-SplitterPanel"></div><div class="mstrmojo-SplitterHandle"></div><div class="mstrmojo-SplitterPanel"></div><div class="mstrmojo-clearingDiv"></div></div>',markupSlots:{firstSplitNode:function firstSplitPane(){return this.domNode.firstChild;},resizeHandleNode:function resizeHandleNode(){return this.domNode.children[1];},secondSplitNode:function secondSplitPane(){return this.domNode.children[2];}},orientation:OR_HORIZONTAL,orientationCss:"",applyPercentage:false,onRender:function onRender(){if(this.applyPercentage){var prop=(this.orientation===OR_HORIZONTAL)?"x":"y",values={};this._wPos={};values[prop]=parseInt((this.orientation===OR_HORIZONTAL)?this.width:this.height,10);this._wPos[prop]=0;applyDimensions.call(this,values);}},config:{firstSplit:{v:"50%",min:"100px",max:undefined},secondSplit:{v:"50%",min:"100px",max:undefined},resizeHandle:{v:"5px"}},init:function init(props){this._super(props);var isHorizontal=(this.orientation===OR_HORIZONTAL);this.orientationCss=isHorizontal?CSS_CLASS_HORIZONTAL:CSS_CLASS_VERTICAL;this.restrictedToAxis=isHorizontal?"x":"y";this.config=$H.clone(this.config);this.layoutConfig=getLayoutConfig.call(this);},toggleFirstItemVisibility:function toggleFirstItemVisibility(show){if(show){this.layoutConfig=getLayoutConfig.call(this);}else{this.layoutConfig[(this.orientation===OR_HORIZONTAL)?WIDTH_PROP:HEIGHT_PROP]={firstSplitNode:"0px",resizeHandleNode:"0px",secondSplitNode:HNDRDPCT};}this.doLayout();},toggleSecondItemVisibility:function toggleSecondItemVisibility(show){if(show){this.layoutConfig=getLayoutConfig.call(this);}else{this.layoutConfig[(this.orientation===OR_HORIZONTAL)?WIDTH_PROP:HEIGHT_PROP]={firstSplitNode:HNDRDPCT,resizeHandleNode:"0px",secondSplitNode:"0px"};}this.doLayout();},draggable:true,dropZone:false,avatarCssClass:"mstrmojo-Splitter-av",delayResizing:false,createAvatar:function createAvatar(){var div=document.createElement("div"),isHorizontal=(this.orientation===OR_HORIZONTAL),widgetPosition=this._wPos=$D.position(this.domNode),avatarThickness="2px",divNodeStyle=div.style;divNodeStyle.top=(isHorizontal?widgetPosition.y:0)+"px";divNodeStyle.left=(isHorizontal?0:widgetPosition.x)+"px";divNodeStyle.height=isHorizontal?this.height:avatarThickness;divNodeStyle.width=isHorizontal?avatarThickness:this.width;divNodeStyle.display=this.delayResizing?"block":STYLE_DISPLAY_NONE;return div;},isDragValid:function isDragValid(context){return context.src.node===this.resizeHandleNode||this._super(context);},ondragmove:function ondragmove(evt){if(!this.delayResizing){applyDimensions.call(this,evt.tgt.pos);}if(this._super){this._super(evt);}},ondragend:function ondragend(evt){if(this.delayResizing){applyDimensions.call(this,evt.tgt.pos);}delete this._wPos;if(this._super){this._super(evt);}}});mstrmojo.ui.Splitter.ENUM_OR=ENUM_OR;}());
(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Button","mstrmojo.ui.Pulldown","mstrmojo.ui.CheckList");var $H=mstrmojo.hash,$NWB=mstrmojo.Button.newWebButton;function handleChecklistButtons(isOk){var pulldown=this.parent,listWidget=this.list;if(isOk){pulldown.set("selectedIndices",$H.copy(listWidget.selectedIndices));pulldown.submitSelections();}else{listWidget.selectedIndices=$H.copy(pulldown.selectedIndices);}this.close();}mstrmojo.ui.PulldownCheckList=mstrmojo.declare(mstrmojo.ui.PopupWidget,null,{scriptClass:"mstrmojo.ui.PulldownCheckList",visible:false,onOpen:function onOpen(){var listWidget=this.list;listWidget.updateScrollbars();},onClose:function onClose(){this.list.refresh();},children:[{scriptClass:"mstrmojo.ui.CheckList",alias:"list",postselectionChange:function postselectionChange(evt){var items=this.items,added=evt.added||[],removed=evt.removed||[],selectedIndices=this.selectedIndices,allIdx=this.parent.parent.allIdx,hasChanged=false;if(allIdx===added[0]){items.forEach(function(item,index){if(!selectedIndices[index]){hasChanged=selectedIndices[index]=true;}});}else{if(allIdx===removed[0]){selectedIndices={};hasChanged=true;}else{if(selectedIndices[allIdx]){delete selectedIndices[allIdx];hasChanged=true;}}}if(hasChanged){this.set("selectedIndices",$H.copy(selectedIndices));this.refresh();}}},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Buttons",children:[$NWB(mstrmojo.desc(1442,"Ok"),function(){handleChecklistButtons.call(this.parent.parent,true);},true,{cssDisplay:"inline-block"}),$NWB(mstrmojo.desc(2140,"Cancel"),function(){handleChecklistButtons.call(this.parent.parent,false);},false,{cssDisplay:"inline-block"})]}]});}());
(function(){mstrmojo.requiresCls("mstrmojo.ui.pathbar.PathPopup","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.pathbar._PreAppExit");function createBreadCrumbs(){this.addDisposable(this.breadCrumbs=new mstrmojo.ui.pathbar.PathPopup({id:"mojoPathBreadCrumbs",cssClass:"mojoPathPicker",offsetLeft:0,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"breadCrumbsItems",preclick:function preclick(){this.parent.close();},items:null,getItemMarkup:function(){return'<a href="#" idx="{@idx}"><span>{@en@n}</span></a>';},getItemProps:function getItemProps(item,idx){return{n:mstrmojo.string.decodeHtmlString(item.n),idx:idx,href:item.href};}}]}));}var $CSS=mstrmojo.css,$DOM=mstrmojo.dom;mstrmojo.ui.pathbar.PathAncestors=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.pathbar._PreAppExit],{scriptClass:"mstrmojo.ui.pathbar.PathAncestors",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout><div class="pathText"><div class="pathBreadCrumbs"><span class="pathBreadCrumbsParent"><a href="{@pathParentLink}">{@pathParentName}</a></span><span class="pathBreadCrumbsPullArrow"></span><span class="pathDelim">{@delimiter}</span></div><div class="pathAncestor hidden">{@itemsHtml}</div><div class="pathCurrent"><span>{@pathCurrent}</span></div></div></div>',markupSlots:{breadCrumbsNode:function(){return this.domNode.firstChild.children[0];},breadCrumbsParentNode:function(){return this.domNode.firstChild.children[0].firstChild;},breadCrumbsArrowNode:function(){return this.domNode.firstChild.children[0].children[1];},ancestorNode:function(){return this.domNode.firstChild.children[1];},currentNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.firstChild.children[1];}},markupMethods:{onwidthChange:function(){var $this=this,ancestorNode=$this.ancestorNode,breadCrumbsNode=$this.breadCrumbsNode;if($this.getNeededWidth()>$this.getAvailWidth()){$CSS.toggleClass(breadCrumbsNode,"hidden",false);$CSS.toggleClass(ancestorNode,"hidden",true);$this.resizeBreadCrumbs();}else{$this.resizePathBar();}}},delimiter:">",pathCurrent:null,pathFirst:null,pathParent:null,breadCrumbs:null,reversedItems:null,init:function init(props){this._super(props);var mItems=this.items;this.pathCurrent=mItems[mItems.length-1].n;this.pathFirstLink=mItems[0].href;this.pathFirstName=mItems[0].n;if(mItems.length>1){this.pathParentLink=mItems[mItems.length-2].en!=true?"#":mItems[mItems.length-2].href;this.pathParentName=mItems[mItems.length-2].n;}mItems.splice(mItems.length-1,1);this.reversedItems=[].concat(mItems).reverse();createBreadCrumbs.call(this);},resizePathBar:function(){var $this=this,ancestorNode=$this.ancestorNode,currentNode=$this.currentNode,breadCrumbsNode=$this.breadCrumbsNode,ancestorStyle=ancestorNode.style,currentStyle=currentNode.style,maxWidth=$DOM.position($this.domNode).w-23-20,curWidth,ancWidth,extra;curWidth=Math.min(maxWidth/2,$DOM.position(currentNode).w);ancWidth=maxWidth-curWidth;extra=ancWidth>ancestorNode.scrollWidth?ancWidth-ancestorNode.scrollWidth:0;ancWidth-=extra;ancestorStyle.maxWidth=Math.max(0,ancWidth)+"px";currentStyle.maxWidth=Math.max(0,maxWidth-ancWidth)+"px";},resizeBreadCrumbs:function(){var $this=this,currentNode=$this.currentNode,breadCrumbsParentNode=$this.breadCrumbsParentNode,currentStyle=currentNode.style,breadCrumbsParentStyle=breadCrumbsParentNode.style,maxWidth=$DOM.position($this.domNode).w-60,curWidth,parentWidth,extra;breadCrumbsParentStyle.maxWidth=Math.max(0,maxWidth)+"px";currentStyle.maxWidth=Math.max(0,maxWidth)+"px";curWidth=Math.min(maxWidth/2,$DOM.position(currentNode,true).w);parentWidth=maxWidth-curWidth;extra=parentWidth>breadCrumbsParentNode.scrollWidth?parentWidth-breadCrumbsParentNode.scrollWidth:0;parentWidth-=extra;breadCrumbsParentStyle.maxWidth=Math.max(0,parentWidth)+"px";currentStyle.maxWidth=Math.max(0,maxWidth-parentWidth)+"px";},onclick:function onclick(evt){var mBreadCrumbs=this.breadCrumbs;if(!this._super(evt)){return false;}var target=evt.getTarget();if(target==this.breadCrumbsArrowNode){mBreadCrumbs.set("targetNode",this.breadCrumbsNode);mBreadCrumbs.breadCrumbsItems.set("items",this.reversedItems.slice(1));if(!mBreadCrumbs.isOpen){mBreadCrumbs.open();}}},getItemMarkup:function(){return'<span idx="{@idx}"><a href="#">{@n}</a></span><span class="pathDelim">{@dl}</span>';},getItemProps:function getItemProps(item,idx){return{n:item.n,href:item.href,dl:this.delimiter,idx:idx};},getNeededWidth:function getNeededWidth(){var breadCrumbsNode=this.breadCrumbsNode,ancestorNode=this.ancestorNode,currentNode=this.currentNode,mBreadCrumbs=this.breadCrumbs;$CSS.toggleClass(breadCrumbsNode,"hidden",true);$CSS.toggleClass(ancestorNode,"hidden",false);if(mBreadCrumbs.isOpen){mBreadCrumbs.close();}return ancestorNode.scrollWidth+currentNode.scrollWidth+30;},getAvailWidth:function getAvailWidth(){var $this=this;return $DOM.position($this.domNode).w-23-20;}});}());
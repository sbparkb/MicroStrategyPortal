(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.array","mstrmojo.threshold.ThresholdModel");var $ARR=mstrmojo.array;var REPLACE_TYPE_ITEMS=[{n:mstrmojo.desc(5999,"Replace Text"),v:3},{n:mstrmojo.desc(6000,"Quick Symbol"),v:10},{n:mstrmojo.desc(11898,"Replace With Image"),v:4}];var REPLACE_SYMBOL=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL;function updateThreshold(propName,newValue,oldValue){this.parent.raiseFormatValueChange(propName,newValue,oldValue);}function onReplaceChecked(isChecked){var model=this.parent.model,threshold=model.threshold;this.replaceType.set("enabled",isChecked);this.replaceText.set("enabled",isChecked);this.replaceSymbol.set("enabled",isChecked);if(!isChecked){delete threshold[model.getReplaceTypeName()];delete threshold[model.getReplaceTextName()];}}mstrmojo.threshold.TextGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.threshold.TextGroup",nameRow:undefined,replaceRow:undefined,replaceType:undefined,replaceText:undefined,replaceSymbol:undefined,preBuildRendering:function preBuildRendering(){this._sync=true;if(this._super){this._super();}},postBuildRendering:function postBuildRendering(){if(this._super){this._super();}this._sync=false;},children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"replaceRow",col1Width:"10%",col2Width:"90%",replaceChk:undefined,children:[{scriptClass:"mstrmojo.ui.Checkbox",slot:"col1Node",alias:"replaceChk",oncheckedChange:function oncheckedChange(){onReplaceChecked.call(this.parent.parent,this.checked);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:mstrmojo.desc(11888,"Enable Data Replace")}]},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceType",selectedIndex:0,enabled:false,items:REPLACE_TYPE_ITEMS,onenabledChange:function onenabledChange(){if(this.enabled){updateThreshold.call(this,"rtp",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(evt){var newValue=evt.value,oldValue=evt.valueWas,textGroup=this.parent,replaceText=textGroup.replaceText,replaceSymbol=textGroup.replaceSymbol;if(newValue!==oldValue){var showSymbol=newValue===1;replaceText.set("visible",!showSymbol);replaceText.set("hint",newValue===2?mstrmojo.desc(11889,"Image URL"):"");replaceSymbol.set("visible",showSymbol);updateThreshold.call(this,"rtp",this.items[newValue].v);}}},{scriptClass:"mstrmojo.TextBox",alias:"replaceText",enabled:false,onenabledChange:function onenabledChange(){if(this.enabled){updateThreshold.call(this,"rtxt",this.value);}},onvalueChange:function onvalueChange(){updateThreshold.call(this,"rtxt",this.value);var textGroup=this.parent,replaceType=textGroup.replaceType;if(!textGroup.parent.model.threshold.rtp){updateThreshold.call(this,"rtp",replaceType.items[replaceType.selectedIndex]);}}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceSymbol",selectedIndex:0,isHostedWithin:false,enabled:false,visible:false,items:REPLACE_SYMBOL,getPopupListConfig:function getpopupListConfig(){var config=mstrmojo.ui.Pulldown.prototype.getPopupListConfig();config.getItemMarkup=function getItemMarkup(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@n}</{@tag}>';};return config;},onenabledChange:function onenabledChange(){if(this.enabled){updateThreshold.call(this,"rtxt",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(evt){var newValue=evt.value,oldValue=evt.valueWas;if(newValue!==oldValue){updateThreshold.call(this,"rtxt",this.items[newValue].v);}}}],setFormatSource:function setFormatSource(threshold){var textGroup=this,model=textGroup.parent.model;this.syncControls(function(){var replaceText=threshold[model.getReplaceTextName()],replaceType=threshold[model.getReplaceTypeName()];textGroup.replaceRow.replaceChk.set("checked",!!replaceText);var typeIdx=$ARR.find(REPLACE_TYPE_ITEMS,"v",replaceType);textGroup.replaceType.set("selectedIndex",typeIdx===-1?0:typeIdx);if(replaceType!==10){textGroup.replaceText.set("value",replaceText||"");textGroup.replaceSymbol.set("selectedIndex",0);}else{var symbolIdx=Math.max($ARR.find(REPLACE_SYMBOL,"v",replaceText),0);textGroup.replaceSymbol.set("selectedIndex",symbolIdx);textGroup.replaceText.set("value","");}});}});}());
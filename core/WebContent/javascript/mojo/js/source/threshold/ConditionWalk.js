(function(){mstrmojo.requiresCls("mstrmojo.rw.ConditionWalk","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.mstr.EnumNodeDimty","mstrmojo.mstr.DocElementDataHelper","mstrmojo.ui._IsIncFetchList");var $ARR=mstrmojo.array,$CSS=mstrmojo.css,DMT=mstrmojo.mstr.EnumNodeDimty,VALID_DIMTY_TYPES=$ARR.hash([DMT.NodeDimtyUnspecified,DMT.NodeDimtyNone]);function onClose(){var thresholdRow=this.thresholdRow,editor=this.editor;if(thresholdRow){this.removeChildren(thresholdRow);}$CSS.toggleClass(editor.content.domNode,"no-overflow",false);this.set("visible",false);editor.setRowPanelVisibility(true);}mstrmojo.threshold.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,[mstrmojo.ui._IsIncFetchList],{objectBrowsingEnabled:false,dimtyTypes:VALID_DIMTY_TYPES,targets:null,targetsLastMod:null,ets:null,condition:null,onOK:function onOK(){var editor=this.editor;editor.model.setConditionData(this.condition,this.model.get());onClose.call(this);editor.toggleButtonStatus(true);},close:function close(){var editor=this.editor;var condition=this.condition,thresholdRow=condition.tree.parent,tree=thresholdRow.exprTree;if(condition.isEmpty()){condition.del();}var items=tree&&tree.items,length=items&&items.length;if(!length||length===0){editor.model.deleteThreshold(thresholdRow.threshold);}onClose.call(this);editor.toggleButtonStatus(true);},browse:function browse(childWidget){this._super(childWidget);if(childWidget.alias==="es"){$CSS.toggleClass(this.eb.domNode,"adv-threshold",true);}},getAttributeForms:function getAttributeForms(did){return mstrmojo.rw.ConditionWalk.getAttForms(did,this.editor.controller.datasets);},getElements:function getElements(attribute,callback){var params={},fn=callback.complete,me=this;this.scrollNode=this.columnWalk.es.scrollNode;if(!this.ifDataHelper){this.ifDataHelper=new mstrmojo.mstr.DocElementDataHelper({source:this.editor.controller.dataService});}else{this.ifDataHelper.set("items",null);}this.columnWalk.es.es.allowUnlistedValues=false;this.updateBrowseElementsParams(params,attribute);this.ifDataHelper.browseConfig=params;callback=mstrmojo.func.wrapMethods(callback,{complete:function(res){me.initScroll();}});this.ifDataHelper.getItems(1,callback);},postNext:function postNext(){this.columnWalk.es.updateList(this.ifDataHelper.items);}});}());
(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.color","mstrmojo.hash","mstrmojo.array");var $COLOR=mstrmojo.color,$HASH=mstrmojo.hash,$ARRAY=mstrmojo.array,$CSS=mstrmojo.css,$NUM=mstrmojo.num;var TYPE_STRING=1,TYPE_COLOR=2,TYPE_BOOLEAN=3,TYPE_INT=4,TYPE_JSON=5,TYPE_BORDER_STYLE=6;var PS_FONT="FormattingFont",PS_APPEARANCE="FormattingAppearance",PS_ALIGNMENT="FormattingAlignment",PS_SIZE="FormattingSize",PS_PATTERNS="FormattingPatterns",PS_BORDER="FormattingBorder",PS_ORDER="FormattingOrder",PS_VIEW="FormattingView",PS_SELECTOR="FormattingSelector",PS_TEMPLATE="Template Formatting",PS_PADDING="FormattingPadding",PS_ANALYTIC="AnalyticalEngineProperties",PS_DOCUMENT="RWDocumentProperties",PS_PAGE="FormattingPage",PS_MOBILE="Mobile",PS_VLDB_SELECT="VLDB Select";var EXCEPTIONS_BG_COLOR=1;var FMT_NAME="n",FMT_HEIGHT="h",FMT_WIDTH="w",FMT_WIDTH_MODE="wm",FMT_PAGE_WIDTH="pw",FMT_MARGIN_LEFT="ml",FMT_MARGIN_RIGHT="mr",FMT_PAGE_WIDTH_LAYOUT="upwalw",FMT_FONT_FAMILY="ff",FMT_FONT_SIZE="fsz",FMT_FONT_WEIGHT="fw",FMT_FONT_STYLE="fit",FMT_UNDERLINE="fun",FMT_LINE_THROUGH="fst",FMT_COLOR="fc",FMT_TEXT_ALIGN="alh",FMT_VERTICAL_ALIGN="alv",FMT_TEXT_WRAP="atw",FMT_TEXT_DIRECTION="atd",FMT_TEXT_OVERFLOW="textOverflow",FMT_BACKGROUND_COLOR="bc",FMT_FILL_STYLE="bgs",FMT_BORDER_TOP_COLOR="btc",FMT_BORDER_RIGHT_COLOR="brc",FMT_BORDER_BOTTOM_COLOR="bbc",FMT_BORDER_LEFT_COLOR="blc",FMT_BORDER_TOP_STYLE="bts",FMT_BORDER_RIGHT_STYLE="brs",FMT_BORDER_BOTTOM_STYLE="bbs",FMT_BORDER_LEFT_STYLE="bls",FMT_BORDER_COLOR="borderColor",FMT_BORDER_STYLE="borderStyle",FMT_Z_INDEX="zIndex",FMT_SHOW_TITLE_BAR="showTitleBar",FMT_TITLE="title",FMT_CONTROL_STYLE="ctrlStyle",FMT_CONTROL_ORIENTATION="ctrlOrientation",FMT_CONTROL_ORIENTATION_BEHAVIOR="ctrlOrientationBehavior",FMT_CONTROL_MULTI_SELECT="ctrlMultiselect",FMT_CONTROL_ITEM_WIDTH_MODE="ciwm",FMT_CONTROL_CONDITION_TYPE="cmcy",FMT_CONTROL_SHOW_ELEMENT_COUNT="sec",FMT_CONTROL_EXPORT_AS_SHOWN_ON_WEB="easow",FMT_LAYOUT_XML="layoutXml",FMT_LOCK_ASPECT_RATIO="lockAspectRatio",FMT_IMAGE_SIZE_MODE="ism",FMT_SHOW_HEADER="shw",FMT_MERGE_HEADER="mg",FMT_LOCK_HEADER="lhv",FMT_GRID_V_PADDING="gridVPadding",FMT_GRID_H_PADDING="gridHPadding",FMT_LONG_NAME="ln",FMT_SHOW_ALL_ROWS="sar",FMT_HIDE_NULL="hnv",FMT_IMAGE_WIDTH="iw",FMT_IMAGE_HEIGHT="ih",FMT_LAYOUT_TAB_POSITION="tsp",FMT_VISIBLE="visible",FMT_REFRESH="rf",FMT_JOIN_ACROSS_DATASET="jad",FMT_MCE_JOIN_TO_GET_DATA_COMBINATION="jdc",FMT_FULL_SCREEN_MODE="fs",FMT_SELECTOR_SELECTION_COLOR="ssc",FMT_SELECTOR_SELECTION_FILL_STYLE="sstyle",FMT_HIGHLIGHT_EFFECT="hgl";function defaultHandler(value){return value;}function defaultIntHandler(value){return parseInt(value,10);}var encodeHandlers={name:"encode",_def:defaultHandler};encodeHandlers[TYPE_BOOLEAN]=function(value){return value?1:0;};encodeHandlers[TYPE_COLOR]=function(value){if(value==="transparent"){return -1;}if(value.length===4){value=value.replace(/([0-9a-f])/ig,"$1$1");}value=$COLOR.rgbStr2hex(value);return parseInt(value.substring(5)+value.substring(3,5)+value.substring(1,3),16);};encodeHandlers[TYPE_INT]=defaultIntHandler;encodeHandlers[TYPE_STRING]=function(value){if(typeof value==="number"){return $NUM.toLocaleString(value);}return defaultHandler(value);};encodeHandlers[TYPE_BORDER_STYLE]=function(value){if(value==="none"){return 0;}var borderWidth=value.match(/([0-9]+[,\.]?[0-9]*pt)/)[0],borderStyle=value.match(/pt ([\w\W]*)/)[1];if(borderWidth==="2pt"){return 5;}switch(borderStyle){case"solid":return 1;case"dashed":return 3;case"dotted":return 4;default:throw new Error("Invalid border style value in FormatModel::encodeValue.");}};var decodeHandlers={name:"decode",_def:defaultHandler};decodeHandlers[TYPE_BOOLEAN]=function(value){return parseInt(value,10)===1;};decodeHandlers[TYPE_COLOR]=function(value){if(value===-1){return"transparent";}if(typeof value==="number"){return $COLOR.decodeColor(value);}if(value.length===4){return value.replace(/([0-9a-f])/ig,"$1$1");}return $COLOR.rgbStr2hex(value);};decodeHandlers[TYPE_INT]=defaultIntHandler;decodeHandlers[TYPE_BORDER_STYLE]=function(value){if(value===undefined||value===0){return"none";}var borderWidth="1pt",borderStyle="solid";if(value===5){borderWidth="2pt";}if(value===3){borderStyle="dashed";}else{if(value===4){borderStyle="dotted";}}return borderWidth+" "+borderStyle;};function getPropertyName(){return this.pn.toLowerCase();}function getCSSHostElement(formats,fmtName,cssName){var el=document.createElement("div");el.style[cssName||fmtName]=formats[fmtName];return el;}function getColorConverterFn(activeFn){return function(){return $COLOR.rgbStr2hex(activeFn.apply(this,arguments));};}function getTextDecorationValue(){var pn=getPropertyName.call(this);return pn==="underline"?pn:"line-through";}var extractHandlers={name:"extract"},fnDefaultExtractValue=extractHandlers._def=function(formats,fmtName,cssName){var el=getCSSHostElement(formats,fmtName||this.getFormatBlockName(),cssName);return el.style[this.getCssName()];};extractHandlers[TYPE_COLOR]=getColorConverterFn(fnDefaultExtractValue);function extractFontStyle(formats){return fnDefaultExtractValue.call(this,formats,this.getFormatBlockName())===getPropertyName.call(this);}function extractTextDecoration(formats){var value=fnDefaultExtractValue.call(this,formats,this.getFormatBlockName(),this.getCssName());return value.indexOf(getTextDecorationValue.call(this))>-1;}function extractBorder(formats){var fmtName=this.getFormatBlockName();return $COLOR.rgbStr2hex(fnDefaultExtractValue.call(this,formats,fmtName,fmtName+this.pn));}var resolveHandlers={name:"resolve"},fnDefaultResolveValue=resolveHandlers._def=function(formats,newValue,fmtName,cssName){fmtName=fmtName||this.getFormatBlockName();var el=getCSSHostElement(formats,fmtName);el.style[cssName||this.getCssName()]=newValue;return el.style[$CSS.convertCssToCamelCase(fmtName)];};resolveHandlers[TYPE_COLOR]=function(formats,newValue,fmtName,cssName){if(newValue.or!==undefined){return newValue;}return $COLOR.rgbStr2hex(fnDefaultResolveValue.call(this,formats,newValue,fmtName,cssName));};function resolveFontStyle(formats,newValue){return fnDefaultResolveValue.call(this,formats,newValue?getPropertyName.call(this):"normal");}function resolveTextDecoration(formats,newValue){var compositeValues=(formats[this.getFormatBlockName()]||"").split(" "),formatValue=getTextDecorationValue.call(this);if(newValue){if(compositeValues.indexOf(formatValue)===-1){compositeValues.push(formatValue);}}else{compositeValues=compositeValues.filter(function(v){return v!==formatValue;});}return fnDefaultResolveValue.call(this,formats,compositeValues.join(" "));}var updateHandlers={name:"update"},fnDefaultUpdateValue=updateHandlers._def=function(formats,newValue){formats[this.getFormatBlockName()]=this.resolve(formats,newValue);return formats;};var PROPERTY_INFO={};PROPERTY_INFO[FMT_NAME]={ps:PS_APPEARANCE,pn:"Name",pt:TYPE_STRING};PROPERTY_INFO[FMT_HEIGHT]={ps:PS_SIZE,pn:"Height",pt:TYPE_STRING};PROPERTY_INFO[FMT_WIDTH]={ps:PS_SIZE,pn:"Width",pt:TYPE_STRING};PROPERTY_INFO[FMT_WIDTH_MODE]={ps:PS_SIZE,pn:"WidthMode",pt:TYPE_INT};PROPERTY_INFO[FMT_PAGE_WIDTH]={ps:PS_PAGE,pn:"PageWidth",pt:TYPE_STRING};PROPERTY_INFO[FMT_MARGIN_LEFT]={ps:PS_PAGE,pn:"MarginLeft",pt:TYPE_STRING,fn:"margin-left"};PROPERTY_INFO[FMT_MARGIN_RIGHT]={ps:PS_PAGE,pn:"MarginRight",pt:TYPE_STRING,fn:"margin-right"};PROPERTY_INFO[FMT_PAGE_WIDTH_LAYOUT]={ps:PS_PAGE,pn:"UsePageWidthAsLayoutWidth",pt:TYPE_BOOLEAN};PROPERTY_INFO[FMT_FONT_FAMILY]={ps:PS_FONT,pn:"Name",pt:TYPE_STRING,fn:"font",cn:"fontFamily",extract:function(){return fnDefaultExtractValue.apply(this,arguments).replace(/['"]/g,"");}};PROPERTY_INFO[FMT_FONT_SIZE]={ps:PS_FONT,pn:"Size",pt:TYPE_INT,fn:"font",cn:"fontSize"};PROPERTY_INFO[FMT_FONT_WEIGHT]={ps:PS_FONT,pn:"Bold",pt:TYPE_BOOLEAN,fn:"font",cn:"fontWeight",extract:extractFontStyle,resolve:resolveFontStyle};PROPERTY_INFO[FMT_FONT_STYLE]={ps:PS_FONT,pn:"Italic",pt:TYPE_BOOLEAN,fn:"font",cn:"fontStyle",extract:extractFontStyle,resolve:resolveFontStyle};PROPERTY_INFO[FMT_UNDERLINE]={ps:PS_FONT,pn:"Underline",pt:TYPE_BOOLEAN,fn:"text-decoration",extract:extractTextDecoration,resolve:resolveTextDecoration};PROPERTY_INFO[FMT_LINE_THROUGH]={ps:PS_FONT,pn:"Strikeout",pt:TYPE_BOOLEAN,fn:"text-decoration",extract:extractTextDecoration,resolve:resolveTextDecoration};PROPERTY_INFO[FMT_COLOR]={ps:PS_FONT,pn:"Color",pt:TYPE_COLOR};PROPERTY_INFO[FMT_TEXT_ALIGN]={ps:PS_ALIGNMENT,pn:"Horizontal",pt:TYPE_INT,fn:"text-align"};PROPERTY_INFO[FMT_TEXT_WRAP]={ps:PS_ALIGNMENT,pn:"TextWrap",pt:TYPE_BOOLEAN,fn:"white-space"};PROPERTY_INFO[FMT_TEXT_DIRECTION]={ps:PS_ALIGNMENT,pn:"TextDirection",pt:TYPE_INT};PROPERTY_INFO[FMT_VERTICAL_ALIGN]={ps:PS_ALIGNMENT,pn:"Vertical",pt:TYPE_INT};PROPERTY_INFO[FMT_TEXT_OVERFLOW]={ps:PS_SIZE,pn:"TextOverflow",pt:TYPE_BOOLEAN};PROPERTY_INFO[FMT_BACKGROUND_COLOR]={ps:PS_PATTERNS,pn:"FillColor",pt:TYPE_COLOR,x:EXCEPTIONS_BG_COLOR,fn:"background-color",update:function(formats,newValue){var fx=formats.fx;if(newValue.or!==undefined){if(!fx){fx=formats.fx={};}var gradientProperties=fx.gd=fx.gd||{};gradientProperties.ec=newValue.c2;gradientProperties.sc=newValue.c1;gradientProperties.t=newValue.or;delete formats[this.getFormatBlockName()];formats.fx=fx;}else{if(fx){delete fx.gd;}fnDefaultUpdateValue.call(this,formats,newValue);}return formats;}};PROPERTY_INFO[FMT_FILL_STYLE]={ps:PS_PATTERNS,pn:"FillStyle",pt:TYPE_INT};PROPERTY_INFO[FMT_SELECTOR_SELECTION_COLOR]={ps:PS_PATTERNS,pn:"SelectorSelectionColor",pt:TYPE_COLOR};PROPERTY_INFO[FMT_SELECTOR_SELECTION_FILL_STYLE]={ps:PS_PATTERNS,pn:"SelectorSelectionFillStyle",pt:TYPE_INT};PROPERTY_INFO[FMT_BORDER_TOP_COLOR]={ps:PS_BORDER,pn:"TopColor",pt:TYPE_COLOR,fn:"border",extract:extractBorder};PROPERTY_INFO[FMT_BORDER_RIGHT_COLOR]={ps:PS_BORDER,pn:"RightColor",pt:TYPE_COLOR,fn:"border",extract:extractBorder};PROPERTY_INFO[FMT_BORDER_BOTTOM_COLOR]={ps:PS_BORDER,pn:"BottomColor",pt:TYPE_COLOR,fn:"border",extract:extractBorder};PROPERTY_INFO[FMT_BORDER_LEFT_COLOR]={ps:PS_BORDER,pn:"LeftColor",pt:TYPE_COLOR,fn:"border",extract:extractBorder};PROPERTY_INFO[FMT_BORDER_COLOR]={ps:PS_BORDER,pn:["TopColor","RightColor","BottomColor","LeftColor"],pt:TYPE_COLOR,fn:"border",extract:extractBorder,resolve:getColorConverterFn(function(formats,value){var fmtName=this.getFormatBlockName(),borderValue=fnDefaultResolveValue.call(this,formats,value,fmtName,fmtName+"Color"),rgbIdx=borderValue.indexOf("rgb");if(rgbIdx>-1){borderValue=borderValue.slice(0,rgbIdx)+$COLOR.rgbStr2hex(borderValue.slice(rgbIdx));}return borderValue;})};PROPERTY_INFO[FMT_BORDER_STYLE]={ps:PS_BORDER,pn:["TopStyle","RightStyle","BottomStyle","LeftStyle"],pt:TYPE_BORDER_STYLE,fn:"border",extract:extractBorder,resolve:function(formats,value){var values=value.split(" "),fmtName=this.getFormatBlockName();formats[fmtName]=fnDefaultResolveValue.call(this,formats,values[0],fmtName,fmtName+"Width");var borderValue=fnDefaultResolveValue.call(this,formats,values[1]||"none",fmtName,fmtName+"Style"),rgbIdx=borderValue.indexOf("rgb");if(rgbIdx>-1){borderValue=borderValue.slice(0,rgbIdx)+$COLOR.rgbStr2hex(borderValue.slice(rgbIdx));}if(borderValue.indexOf("#")===-1&&borderValue.indexOf("transparent")===-1){borderValue+=" transparent";}return borderValue;}};PROPERTY_INFO[FMT_BORDER_TOP_STYLE]={ps:PS_BORDER,pn:"TopStyle",pt:TYPE_BORDER_STYLE,fn:"border",extract:extractBorder};PROPERTY_INFO[FMT_BORDER_RIGHT_STYLE]={ps:PS_BORDER,pn:"RightStyle",pt:TYPE_BORDER_STYLE,fn:"border"};PROPERTY_INFO[FMT_BORDER_BOTTOM_STYLE]={ps:PS_BORDER,pn:"BottomStyle",pt:TYPE_BORDER_STYLE,fn:"border",extract:extractBorder};PROPERTY_INFO[FMT_BORDER_LEFT_STYLE]={ps:PS_BORDER,pn:"LeftStyle",pt:TYPE_BORDER_STYLE,fn:"border",extract:extractBorder};PROPERTY_INFO[FMT_Z_INDEX]={ps:PS_ORDER,pn:"ZIndex",pt:TYPE_INT,fn:"z-index"};PROPERTY_INFO[FMT_SHOW_TITLE_BAR]={ps:PS_VIEW,pn:"ShowTitleBar",pt:TYPE_BOOLEAN};PROPERTY_INFO[FMT_TITLE]={ps:PS_VIEW,pn:"Title",pt:TYPE_STRING};PROPERTY_INFO[FMT_CONTROL_STYLE]={ps:PS_SELECTOR,pn:"Style",pt:TYPE_INT};PROPERTY_INFO[FMT_CONTROL_ORIENTATION]={ps:PS_SELECTOR,pn:"Orientation",pt:TYPE_INT};PROPERTY_INFO[FMT_CONTROL_ORIENTATION_BEHAVIOR]={ps:PS_SELECTOR,pn:"OrientationBehavior",pt:TYPE_INT};PROPERTY_INFO[FMT_CONTROL_MULTI_SELECT]={ps:PS_SELECTOR,pn:"Multiselect",pt:TYPE_BOOLEAN};PROPERTY_INFO[FMT_CONTROL_ITEM_WIDTH_MODE]={ps:PS_SELECTOR,pn:"ItemWidthMode",pt:TYPE_INT};PROPERTY_INFO[FMT_CONTROL_CONDITION_TYPE]={ps:PS_SELECTOR,pn:"MetricConditionType",pt:TYPE_INT};PROPERTY_INFO[FMT_CONTROL_SHOW_ELEMENT_COUNT]={ps:PS_SELECTOR,pn:"ShowElementCount",pt:TYPE_INT};PROPERTY_INFO[FMT_CONTROL_EXPORT_AS_SHOWN_ON_WEB]={ps:PS_SELECTOR,pn:"ExportAsShownOnWeb",pt:TYPE_INT};PROPERTY_INFO[FMT_LAYOUT_XML]={ps:PS_SIZE,pn:"LayoutXML",pt:TYPE_JSON};PROPERTY_INFO[FMT_LOCK_ASPECT_RATIO]={ps:PS_SIZE,pn:"LockAspectRatio",pt:TYPE_BOOLEAN};PROPERTY_INFO[FMT_IMAGE_SIZE_MODE]={ps:PS_SIZE,pn:"ImageSizeMode",pt:TYPE_INT};PROPERTY_INFO[FMT_IMAGE_HEIGHT]={ps:PS_SIZE,pn:"ImageHeight",pt:TYPE_STRING};PROPERTY_INFO[FMT_IMAGE_WIDTH]={ps:PS_SIZE,pn:"ImageWidth",pt:TYPE_STRING};PROPERTY_INFO[FMT_LAYOUT_TAB_POSITION]={ps:PS_DOCUMENT,pn:"layoutBarPosition",pt:TYPE_BOOLEAN};PROPERTY_INFO[FMT_FULL_SCREEN_MODE]={ps:PS_DOCUMENT,pn:"ExecutionFullScreenMode",pt:TYPE_BOOLEAN};PROPERTY_INFO[FMT_VISIBLE]={ps:PS_APPEARANCE,pn:"Visible",pt:TYPE_BOOLEAN};PROPERTY_INFO[FMT_LONG_NAME]={ps:PS_TEMPLATE,pn:"LongNames",pt:TYPE_STRING};PROPERTY_INFO[FMT_SHOW_ALL_ROWS]={ps:PS_ANALYTIC,pn:"ShowAllRows",pt:TYPE_STRING};PROPERTY_INFO[FMT_HIDE_NULL]={ps:PS_ANALYTIC,pn:"HideNullZeroValues",pt:TYPE_STRING};PROPERTY_INFO[FMT_GRID_H_PADDING]={ps:PS_PADDING,pn:["LeftPadding","RightPadding"],pt:TYPE_STRING};PROPERTY_INFO[FMT_GRID_V_PADDING]={ps:PS_PADDING,pn:["TopPadding","BottomPadding"],pt:TYPE_STRING};PROPERTY_INFO.rowsshw={ps:PS_TEMPLATE,pn:"ShowRowHeaders",pt:TYPE_STRING};PROPERTY_INFO.rowsmg={ps:PS_TEMPLATE,pn:"MergeCells",pt:TYPE_STRING};PROPERTY_INFO.rowslhv={ps:PS_TEMPLATE,pn:"LockRowHeaders",pt:TYPE_STRING};PROPERTY_INFO.colsshw={ps:PS_TEMPLATE,pn:"ShowColumnHeaders",pt:TYPE_STRING};PROPERTY_INFO.colsmg={ps:PS_TEMPLATE,pn:"MergeColumnCells",pt:TYPE_STRING};PROPERTY_INFO.colslhv={ps:PS_TEMPLATE,pn:"LockColumnHeaders",pt:TYPE_STRING};PROPERTY_INFO[FMT_REFRESH]={ps:PS_MOBILE,pn:"RefreshFrequency",pt:TYPE_INT};PROPERTY_INFO[FMT_JOIN_ACROSS_DATASET]={ps:PS_VLDB_SELECT,pn:"Join Across Datasets",pt:TYPE_INT};PROPERTY_INFO[FMT_MCE_JOIN_TO_GET_DATA_COMBINATION]={ps:PS_VLDB_SELECT,pn:"MCE Join To Get Data Combination",pt:TYPE_INT};PROPERTY_INFO[FMT_HIGHLIGHT_EFFECT]={ps:PS_APPEARANCE,pn:"Highlight",pt:TYPE_INT};$ARRAY.forEach($HASH.keyarray(PROPERTY_INFO),function(propertyKey){var info=PROPERTY_INFO[propertyKey];info.getFormatBlockName=function(){var fmtName=this.fn;if(!fmtName){var pName=this.pn;fmtName=pName.charAt(0).toLowerCase()+pName.substr(1);}return fmtName;};info.getCssName=function(){var fmtName=this.getFormatBlockName.call(this),cssName=this.cn;if(!cssName){cssName=$CSS.convertCssToCamelCase(fmtName);}return cssName;};$ARRAY.forEach([encodeHandlers,decodeHandlers,extractHandlers,resolveHandlers,updateHandlers],function(handlers){var name=handlers.name;info[name]=info[name]||handlers[info.pt]||handlers._def;});});function updateFormatObject(info,newValue,formatObject){var propertySet=formatObject[info.ps]=formatObject[info.ps]||{};newValue=info.encode(newValue);$ARRAY.forEach([].concat(info.pn),function(name){propertySet[name]=newValue;});return formatObject;}function getCompositeFormatUpdate(info,newValue,formatObject){var propExceptions=info.x;if(propExceptions){if((propExceptions&EXCEPTIONS_BG_COLOR)>0){var isGradient=!!newValue.c1,fillStyle=0;if(isGradient){updateFormatObject(info,newValue.c1,formatObject);var propertySet=formatObject[PS_PATTERNS];propertySet.GradientColor=info.encode(newValue.c2);propertySet.GradientAngle=newValue.or?0:90;propertySet.GradientXOffset=0;propertySet.GradientYOffset=0;fillStyle=2;}else{if(info.encode(newValue)===-1){fillStyle=1;}else{updateFormatObject(info,newValue,formatObject);}}return updateFormatObject(PROPERTY_INFO[FMT_FILL_STYLE],fillStyle,formatObject);}}return null;}mstrmojo.models.FormatModel={getFormatUpdate:function getFormatUpdate(propertyName,newValue,formatObject){var info=PROPERTY_INFO[propertyName];if(!info){throw new Error("Invalid property "+propertyName+" in FormatModel::getFormatUpdate.");}formatObject=formatObject||{};var compositeFormat=getCompositeFormatUpdate.call(this,info,newValue,formatObject);if(compositeFormat){return compositeFormat;}return updateFormatObject(info,newValue,formatObject);},getFormatPropertyInfo:function getFormatPropertyInfo(propertyName){return PROPERTY_INFO[propertyName];},getValueFromUpdate:function getFormatValue(propertyName,formatUpdate){var info=PROPERTY_INFO[propertyName],result=null;try{result=formatUpdate[info.ps][info.pn];}catch(e){}return result;},getGradientValues:function getGradientValues(formats){var cssGradient=formats.fx&&formats.fx.gd;if(cssGradient){var g1={c1:cssGradient.sc,c2:cssGradient.ec,or:cssGradient.t};return g1;}if(formats[FMT_FILL_STYLE]===2){var g2={c1:formats.bc,c2:formats.gdc,or:formats.gda===90?0:1};return g2;}return null;},decodeValue:function decodeValue(propertyName,value){return PROPERTY_INFO[propertyName].decode(value);},updateFormatBlock:function updateFormatBlock(formats,propertyName,newValue){return PROPERTY_INFO[propertyName].update(formats,newValue);},getFormatBlockValue:function getFormatBlockValue(formats,propertyName){return PROPERTY_INFO[propertyName].extract(formats);},GradientType:null,FormatObjectType:null,PROPERTY_INFO_TYPE:null,ENUM_PROPERTY_NAMES:{NAME:FMT_NAME,HEIGHT:FMT_HEIGHT,WIDTH:FMT_WIDTH,WIDTH_MODE:FMT_WIDTH_MODE,PAGE_WIDTH:FMT_PAGE_WIDTH,MARGIN_LEFT:FMT_MARGIN_LEFT,MARGIN_RIGHT:FMT_MARGIN_RIGHT,USE_PAGE_WIDTH_AS_LAYOUT_WIDTH:FMT_PAGE_WIDTH_LAYOUT,FONT_FAMILY:FMT_FONT_FAMILY,FONT_SIZE:FMT_FONT_SIZE,FONT_WEIGHT:FMT_FONT_WEIGHT,FONT_STYLE:FMT_FONT_STYLE,UNDERLINE:FMT_UNDERLINE,LINE_THROUGH:FMT_LINE_THROUGH,COLOR:FMT_COLOR,TEXT_ALIGN:FMT_TEXT_ALIGN,VERTICAL_ALIGN:FMT_VERTICAL_ALIGN,TEXT_WRAP:FMT_TEXT_WRAP,TEXT_DIRECTION:FMT_TEXT_DIRECTION,TEXT_OVERFLOW:FMT_TEXT_OVERFLOW,BACKGROUND_COLOR:FMT_BACKGROUND_COLOR,FILL_STYLE:FMT_FILL_STYLE,BORDER_TOP_COLOR:FMT_BORDER_TOP_COLOR,BORDER_RIGHT_COLOR:FMT_BORDER_RIGHT_COLOR,BORDER_BOTTOM_COLOR:FMT_BORDER_BOTTOM_COLOR,BORDER_LEFT_COLOR:FMT_BORDER_LEFT_COLOR,BORDER_TOP_STYLE:FMT_BORDER_TOP_STYLE,BORDER_RIGHT_STYLE:FMT_BORDER_RIGHT_STYLE,BORDER_BOTTOM_STYLE:FMT_BORDER_BOTTOM_STYLE,BORDER_LEFT_STYLE:FMT_BORDER_LEFT_STYLE,BORDER_COLOR:FMT_BORDER_COLOR,BORDER_STYLE:FMT_BORDER_STYLE,Z_INDEX:FMT_Z_INDEX,SHOW_TITLE_BAR:FMT_SHOW_TITLE_BAR,TITLE:FMT_TITLE,CONTROL_STYLE:FMT_CONTROL_STYLE,CONTROL_ORIENTATION:FMT_CONTROL_ORIENTATION,CONTROL_ORIENTATION_BEHAVIOR:FMT_CONTROL_ORIENTATION_BEHAVIOR,CONTROL_MULTISELECT:FMT_CONTROL_MULTI_SELECT,CONTROL_ITEM_WIDTH_MODE:FMT_CONTROL_ITEM_WIDTH_MODE,CONTROL_METRIC_CONDITION_TYPE:FMT_CONTROL_CONDITION_TYPE,CONTROL_SHOW_ELEMENT_COUNT:FMT_CONTROL_SHOW_ELEMENT_COUNT,CONTROL_EXPORT_AS_SHOWN_ON_WEB:FMT_CONTROL_EXPORT_AS_SHOWN_ON_WEB,LAYOUT_XML:FMT_LAYOUT_XML,LOCK_ASPECT_RATIO:FMT_LOCK_ASPECT_RATIO,IMAGE_SIZE_MODE:FMT_IMAGE_SIZE_MODE,SHOW_HEADER:FMT_SHOW_HEADER,MERGE_HEADER:FMT_MERGE_HEADER,LOCK_HEADER:FMT_LOCK_HEADER,LONG_NAME:FMT_LONG_NAME,SHOW_ALL_ROWS:FMT_SHOW_ALL_ROWS,HIDE_NULL:FMT_HIDE_NULL,IMAGE_WIDTH:FMT_IMAGE_WIDTH,IMAGE_HEIGHT:FMT_IMAGE_HEIGHT,VISIBLE:FMT_VISIBLE,LAYOUT_TAB_POSITION:FMT_LAYOUT_TAB_POSITION,GRID_VERTICAL_PADDING:FMT_GRID_V_PADDING,GRID_HORIZONTAL_PADDING:FMT_GRID_H_PADDING,REFRESH:FMT_REFRESH,JOIN_ACROSS_DATASET:FMT_JOIN_ACROSS_DATASET,MCE_JOIN_TO_GET_DATA_COMBINATION:FMT_MCE_JOIN_TO_GET_DATA_COMBINATION,FULL_SCREEN_MODE:FMT_FULL_SCREEN_MODE,SELECTOR_SELECTION_COLOR:FMT_SELECTOR_SELECTION_COLOR,SELECTOR_SELECTION_FILL_STYLE:FMT_SELECTOR_SELECTION_FILL_STYLE,VIZ_HIGHLIGHTING:FMT_HIGHLIGHT_EFFECT}};}());
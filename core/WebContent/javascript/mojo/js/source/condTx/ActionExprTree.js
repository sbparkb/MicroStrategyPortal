(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.expr","mstrmojo.array","mstrmojo.ConditionNode","mstrmojo.threshold.ThresholdExprTree","mstrmojo.condTx.CommonComponent");var $H=mstrmojo.hash,$EXPR=mstrmojo.expr,_S=mstrmojo.string.htmlAngles,_ET=$EXPR.ET,_FN=$EXPR.FN,_GFN=mstrmojo.ConditionNode.getFunctionNode,$CC=mstrmojo.condTx.CommonComponent,ENT=$CC.EXPR_NODE_TYPE,setSubExpressionType=$CC.setSubExpressionType;function getScaleFunctionNode(me){var d=me.data,h=[];if(d.tx){h.push('<span class="mstrmojo-text mstrmojo-tx">'+_S(d.tx.dn||d.tx.n||"")+"</span>");}else{if(d.exp){h.push('<span class="mstrmojo-text mstrmojo-tx">Advanced&nbsp;Expression</span>');}}if(d.fn){h.push('<span class="mstrmojo-text mstrmojo-fn">'+_S($EXPR.fnName(10,d.fn,d.fnt||1))+"</span>");}if(d.tx2){h.push('<span class="mstrmojo-text mstrmojo-tx2">'+_S(d.tx2.dn||d.tx2.n||"")+"</span>");}else{if(d.exp2){h.push('<span class="mstrmojo-text mstrmojo-tx">Advanced&nbsp;Expression</span>');}}if(d.cs){var cs=d.cs||[],len=cs.length;if(cs[0]){var c0=cs[0];h.push('<span class="mstrmojo-text mstrmojo-c0">'+_S(c0.n||c0.v||"")+"</span>");}if(len>1){h.push('<span class="mstrmojo-text mstrmojo-btwn">'+me.betweenText+"</span>");}if(cs[1]){var c1=cs[1];h.push('<span class="mstrmojo-text mstrmojo-c1">'+_S(c1.n||c1.v||"")+"</span>");}}return h.join("");}function fullExpr(data){return data.fn&&(data.tx||data.exp)&&(data.tx2||data.exp2||data.cs);}mstrmojo.condTx.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,null,{markupMethods:$H.copy({ondataChange:function(){var d=this.data;this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=(d.et!==_ET.XML)?_GFN(this):getScaleFunctionNode(this);this.textPostfixNode.innerHTML=this.getConditionTextPostfix();setSubExpressionType(d);}},$H.copy(mstrmojo.ConditionNode.prototype.markupMethods)),isEmpty:function(){var v=this._super(),d=this.data;return v&&!fullExpr(d);}});mstrmojo.condTx.ActionExprTree=mstrmojo.declare(mstrmojo.threshold.ThresholdExprTree,null,{scriptClass:"mstrmojo.condTx.ActionExprTree",itemFunction:function(item,idx,widget){if(_ET.ANDOR!==item.et){var cfg=widget.tree.getItemConfig(item,idx,widget),Sc=mstrmojo.condTx.ConditionNode;return new Sc(cfg);}else{return this._super(item,idx,widget);}},isEditable:function isEditable(item){return this.editable;}});}());
(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var $HASH=mstrmojo.hash,$REGISTRY=mstrmojo.registry,RENDERED=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function bc(w){var fn=w.itemFunction;if(!fn){var cfg=w.itemConfig;fn=cfg?function(item,index,widget){var c=$HASH.clone(cfg);c.data=item;c.parent=widget;return $REGISTRY.ref(c);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:fn};},build:function b(w,ctxt,item,idx){var iw=ctxt.itemFunc(item,idx,w);if(iw){ctxt.itemStatus[idx]=RENDERED;ctxt.itemWidgets[idx]=iw;if(iw.set){var s=w.selectedIndices;if(s&&s[idx]){iw.set("selected",true);}}}return iw;},onadd:function oa(w,ctxt,evt){if(ctxt){mstrmojo.array.insert(ctxt.itemWidgets,evt.index,new Array(evt.value.length));}this._super(w,ctxt,evt);},onremove:function orm(w,ctxt,evt){if(ctxt){var ids=ctxt.itemWidgets.splice(evt.index,evt.value.length),i,len;for(i=0,len=ids.length;i<len;i++){var iw=ids[i];if(iw&&iw.destroy){delete iw.parent;iw.destroy();}}}this._super(w,ctxt,evt);},onchange:function ocg(w,p,ctxt,evt){if(evt){var iws=ctxt.itemWidgets,iw,i,r,rlen;for(i=0,r=evt.removed,rlen=r&&r.length;i<rlen;i++){iw=iws[r[i]];if(iw&&iw.set){iw.set("selected",false);}}var j,a,alen;for(j=0,a=evt.added,alen=a&&a.length;j<alen;j++){iw=iws[a[j]];if(iw&&iw.set){iw.set("selected",true);}}}}},$HASH.copy(mstrmojo.ListBuilder)));}());
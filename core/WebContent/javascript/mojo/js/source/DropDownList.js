(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.string");function buildOptionsMarkup($this,start,end){var markup=[];var ir=$this.optionRenderer,fn=ir&&ir.render;if(fn&&typeof fn==="function"){var options=$this.options,stop=Math.min(end,((options&&options.length)||0)),i;for(i=start;i<stop;i++){markup.push(fn(options[i],i,$this));}}return markup.join("");}mstrmojo.DropDownList=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DropDownList",title:"",selectCssClass:"",tooltip:"",cssDisplay:"inline",value:"",unset:false,options:null,optionValueField:"v",optionNameField:"n",idx:-1,renderedOptions:"",markupString:'<span id="{@id}"  class="mstrmojo-DropDownList {@cssClass}">{@title}<select id="{@id}_select" class="mstrmojo-DropDownList-select {@selectCssClass}"  style="{@cssText}" title="{@tooltip}"onchange="mstrmojo.all[\'{@id}\'].set(\'selected\', this.options[this.selectedIndex].value);">{@renderedOptions}</select><div class = "strikeoutContainer"></div></span>',markupSlots:{selectNode:function(){return this.domNode.getElementsByTagName("select")[0];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onidxChange:function(){var s=this.domNode.getElementsByTagName("select");if(s&&s.length){s[0].selectedIndex=this.idx;}},onvalueChange:function(){var sn=this.selectNode,ops=sn.options,v=this.value,idx,o;for(o=0;o<ops.length;o++){var b=ops[o].value.toString()===v;if(b){idx=o;if(v!==""){mstrmojo.css.toggleClass(ops[o],"selected",b);}break;}}if(sn.length>0&&idx>0&&this.unset){if(this.options[0].v==="-1"){sn.remove(0);idx--;}this.unset=false;}this.set("idx",idx);},onwidthChange:function(){var width=this.width;if(width>=0){this.selectNode.style.width=width+"px";}}},_set_selected:function(n,v){var sn=this.selectNode,bChange=this[n]!==v;this[n]=v;if(sn){this.set("value",v);}return bChange;},preBuildRendering:function preBuildRendering(){var $this=this;if($this.unset){$this.idx=0;}var elements=$this.options,cnt=(elements&&elements.length)||0;if(cnt){$this.renderedOptions=buildOptionsMarkup($this,0,cnt);}return this._super();},optionRenderer:{render:function(option,idx,widget){return mstrmojo.string.apply(widget.getOptionMarkup(option),widget.getOptionProps(option,idx));}},getOptionMarkup:function(option){return'<option value="{@en@v}" class="{@cls}" style="{@style}" {@sel}>{@en@n}</option>';},getOptionProps:function getItemProps(option,idx){var $this=this,optionValue=option[$this.optionValueField],isSelected=idx===parseInt($this.idx,10);$this.selected=$this.value=isSelected?optionValue.toString():$this.value;return{cls:isSelected?"selected":"",v:optionValue===undefined?"":optionValue,n:option[$this.optionNameField]||"",style:"",sel:isSelected?"selected":""};}});}());
mstrSearchCommandsScript=true;mstrSearchCommands.prototype={};mstrSearchCommands.prototype.appName=microstrategy.servletName;mstrSearchCommands.FEATURES={ExecuteCubeReport:"web-execute-cube-report",CreateAnalysis:"create-analysis"};mstrSearchCommands.prototype.exec=function(cmdId,itm){switch(cmd){case"openFolder":case"run":this.execute(itm);break;case"edit":this.designMode=1;this.execute();break;case"del":case"rename":default:break;}};mstrSearchCommands.prototype.execute=function(itm){var _TP={FILTER:1,ATTR:12,FORM:21,DIM:14,METRIC:4,PROMPT:10,REPORT:3,FOLDER:8},_STP={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776},_ACG={Browse:1,UseExecute:2,Read:4,Write:8,Delete:16,Control:32,Use:64,Execute:128,FullControl:255,Inheritable:536870912};this.appName=microstrategy.servletName;var item=itm||this.selectedItem,t=parseInt(item.tp||item.t),st=parseInt(item.stp||item.st),did=item.dssid||item.did,vm=item.viewMedia||item.dvm,vis=item.visMode||0;var params={};switch(t){case 1:switch(st){case 256:params={evt:3113,filterID:did,src:this.appName+".3113"};break;case 257:openCustomGroupEditor(did);return ;break;}break;case 3:if(this.designMode){params={reportID:did,evt:3005,src:this.appName+".3005",reportDesignMode:this.designMode};break;}var rvm=1;switch(st){case _STP.REPORT_CUBE:if(!this.parentBone.isFeatureAvailable(mstrSearchCommands.FEATURES.CreateAnalysis)){return ;}params={evt:3104,src:this.appName+".3104",executionMode:1,rwDesignMode:0,objectType:3,objectID:did,rwCreateFlags:16,rwViewMode:2048,fromPh:0};this.sendForm(params);return ;case _STP.REPORT_GRID:rvm=1;break;case _STP.REPORT_GRAPH:rvm=2;break;case _STP.REPORT_GRIDGRAPH:rvm=3;break;}params={reportID:did,evt:4001,src:this.appName+".4001",visMode:vis,reportViewMode:rvm};break;case 8:params={evt:2001,folderID:did,src:this.appName+".2001"};break;case 55:var VIEW_M={Reserved:0,ViewStatic:1,ViewInteractive:2,ViewEditable:4,ViewFlash:8,ExportExcel:16,ExportPDF:32,ExportHTML:64,ExportFlash:128,ExportExcelPlainText:256,ExportCSV:512,ExportPlainText:1024,ViewAnalysis:2048,HTML5Dashboard:8192,All:134217727};var EXEC_M={DATA:1,DESIGN:2,PDF:3,EXCEL:4,SAVE:5,DETAILS:6,FLASH_EXPORT:7,FLASH_VIEW:8,FLASH_BINARY_VIEW:9};var emm={};emm[VIEW_M.ExportPDF]=EXEC_M.PDF;emm[VIEW_M.ExportExcel]=EXEC_M.EXCEL;emm[VIEW_M.ExportFlash]=EXEC_M.FLASH_EXPORT;var evts={};evts[VIEW_M.ViewStatic]=2048001;evts[VIEW_M.ViewInteractive]=2048001;evts[VIEW_M.ViewEditable]=2048001;evts[VIEW_M.ExportHTML]=3130;evts[VIEW_M.ExportExcel]=3069;evts[VIEW_M.ExportFlash]=3069;evts[VIEW_M.ExportPDF]=3069;evts[VIEW_M.ViewAnalysis]=2048001;evts[VIEW_M.HTML5Dashboard]=3140;var evt=2048001;if(st==14081){if(this.designMode){evt=3104;params={evt:evt,objectID:did,src:this.appName+"."+evt,rwDesignMode:this.designMode,executionMode:2};}else{if(vm>8){evt=evts[vm];params={evt:evt,documentID:did,src:this.appName+"."+evt};if(vm===VIEW_M.HTML5Dashboard){if(mstr.utils.ISIE9Pre){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}}else{params.executionMode=emm[vm]||0;}}else{evt=2048001;params={evt:evt,documentID:did,src:this.appName+"."+evt,visMode:vis||0,currentViewMedia:vm||2};}}}else{if(st==14080){var params={evt:32001,documentID:did,src:this.appName+".32001"};}}break;case 10:params={evt:3119,objectID:did,src:this.appName+".2048001"};break;case 2:break;case 34:var params={};switch(st){case 8704:params={evt:3114,src:this.appName+".3114",userId:did};break;case 8705:params={evt:3115,src:this.appName+".3115",groupId:did};break;}break;case 44:var params={evt:3121,sRoleId:did,src:this.appName+".3121"};break;default:return false;}this.sendForm(params);};mstrSearchCommands.prototype.sendForm=function(params){var temp=[];for(var n in params){temp.push(n+"="+params[n]);}var form=createDynamicForm(microstrategy.servletName+"?"+temp.join("&"));form.method="POST";submitForm(form);delete form;};function mstrSearchCommands(parentBone){this.parentBone=parentBone;return this;}
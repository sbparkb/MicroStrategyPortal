mstrGridPropTabImplScript=true;mstrGridPropTabImpl.prototype=new mstrTabImpl();mstrGridPropTabImpl.prototype.colorPicker=null;mstrGridPropTabImpl.prototype.propsArray=new Array("obRHS","obRHM","obRHL","obCHS","obCHM","obCHL","obOutline","obBanding","obThresh","obAttForms","obShowThreshold","obTitleOverlap","obDrillOptions","obExecutionFullScreenMode","obHideNullsOrZeros","obHideNullZeroValues","obIfRowMode","obIfMaxRows","obIfColMode","obIfMaxCols");mstrGridPropTabImpl.prototype.isLinkedGrid=false;mstrGridPropTabImpl.prototype.IF_MODE_DEFAULT="0";mstrGridPropTabImpl.prototype.IF_MODE_ROWS="1";mstrGridPropTabImpl.prototype.IF_MODE_COLS="1";mstrGridPropTabImpl.prototype.IF_MODE_BLOCKS="2";mstrGridPropTabImpl.prototype.onload=function(){try{this.initEditor();}catch(err){microstrategy.errors.log(err);return false;}};mstrGridPropTabImpl.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);this.initSettings();}catch(err){microstrategy.errors.log(err);return false;}};mstrGridPropTabImpl.prototype.initSettings=function(){try{this.settings=new Array();for(var i=0;i<this.propsArray.length;i++){var elem=document.getElementById(this.id+this.propsArray[i]);if(elem){this.settings.push(elem);}}this.ifCurRowMode=document.getElementById(this.id+"obIfRowMode").value;}catch(err){microstrategy.errors.log(err);return false;}};mstrGridPropTabImpl.prototype.isCmdIdValid=function(cmdId){try{return(cmdId!=null&&((","+this.propsArray.toString()+",").indexOf(",ob"+cmdId+",")!=-1)&&!this.isLinkedGrid);}catch(err){microstrategy.errors.log(err);return false;}};mstrGridPropTabImpl.prototype.changeTemplateToShortcut=function(value){try{for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];if(value=="-1"){this.isLinkedGrid=true;this.disableOptionAndLabel(aSetting);}else{this.isLinkedGrid=false;this.enableOptionAndLabel(aSetting);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGridPropTabImpl.prototype.updateList=function(obj){try{if(obj){obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,obj.value);if(obj.id==this.id+"obIfRowMode"){var oldMode=this.ifCurRowMode,newMode=obj.value,maxRowsLbl=document.getElementById(this.id+"obIfMaxRows_label"),maxRowsField=document.getElementById(this.id+"obIfMaxRows"),lblText=newMode===this.IF_MODE_BLOCKS?obj.getAttribute("blocksLbl"):obj.getAttribute("rowsLbl"),totalRows=obj.getAttribute("totalRows"),totalBlocks=obj.getAttribute("totalBlocks"),prefMaxRows=obj.getAttribute("prefMaxRows"),isDisabled=newMode===this.IF_MODE_DEFAULT,oldMaxRows=maxRowsField.value,newMaxRows=oldMaxRows;if(newMode===this.IF_MODE_DEFAULT){newMaxRows=prefMaxRows;}else{if(oldMode===this.IF_MODE_BLOCKS){if(totalRows&&totalBlocks){newMaxRows=Math.round(oldMaxRows*totalRows/totalBlocks)||1;}else{newMaxRows=1;}}else{if(newMode===this.IF_MODE_BLOCKS){if(totalRows&&totalBlocks){if(oldMode===this.IF_MODE_DEFAULT){newMaxRows=Math.round(totalBlocks*prefMaxRows/totalRows)||1;}else{newMaxRows=Math.round(totalBlocks*oldMaxRows/totalRows)||1;}}else{newMaxRows=1;}}}}this.ifCurRowMode=newMode;maxRowsLbl.innerHTML=lblText;maxRowsField.value=newMaxRows;maxRowsField.disabled=isDisabled;maxRowsField.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newMaxRows);}else{if(obj.id==this.id+"obIfColMode"){var newMode=obj.value;maxColField=document.getElementById(this.id+"obIfMaxCols");if(newMode===this.IF_MODE_DEFAULT){maxColField.value=obj.getAttribute("prefMaxCols");}else{maxColField.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,maxColField.value);}maxColField.disabled=newMode===this.IF_MODE_DEFAULT;}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrGridPropTabImpl.prototype.updateValue=function(obj){try{if(obj){obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,obj.value);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGridPropTabImpl.prototype.updateCheck=function(obj){try{if(obj==null){return ;}var cmdId=obj.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!this.isCmdIdValid(cmdId)){return ;}var newValue="0";switch(cmdId){case"ShowThreshold":if(obj.checked){newValue="1";}break;case"HideNullsOrZeros":if(!obj.checked){newValue="-1";}var hideValsElem=document.getElementById(this.id+"obHideNullZeroValues");if(hideValsElem){hideValsElem.disabled=(newValue==="0")?false:true;}break;default:if(obj.checked){newValue="-1";}break;}obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newValue);}catch(err){microstrategy.errors.log(err);return false;}};mstrGridPropTabImpl.prototype.applyFormatChanges=function(bulkChanges){};mstrGridPropTabImpl.prototype.applyPropertyChanges=function(propertiesArray){try{for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(settingValue==null||!this.isCmdIdValid(settingName)){continue;}var propChange=new this.propChangeObject(aSetting,settingName,settingValue,false,microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);propertiesArray.push(propChange);}return true;}catch(err){microstrategy.errors.log(err);return false;}};function mstrGridPropTabImpl(id){this.inherits=mstrTabImpl;this.inherits(id);delete this.inherits;return this;}
var mstrStats=(function(){function mousePos(e){var pos;if(window.getMouse){getMouse(e);pos={x:lMouseX,y:lMouseY};}else{pos=mstrmojo&&mstrmojo.dom&&mstrmojo.dom.getMousePosition(e);}return pos;}function mouseButton(e){if(window.getButtonId){return getButtonId(e);}else{return mstrmojo&&mstrmojo.dom&&mstrmojo.dom.getButton(window,e);}}function eventTarget(e){if(window.getEventTarget){return getEventTarget(e);}else{return mstrmojo&&mstrmojo.dom&&mstrmojo.dom.eventTarget(window,e);}}function attachEvent(el,eventName,f){if(window.mstr&&mstr.$D&&mstr.$D.attachEvent){mstr.$D.attachEvent(el,eventName,f);}else{mstrmojo&&mstrmojo.dom&&mstrmojo.dom.attachEvent(el,eventName,f);}}function detachEvent(el,eventName,f){if(window.mstr&&mstr.$D&&mstr.$D.detachEvent){mstr.$D.detachEvent(el,eventName,f);}else{mstrmojo&&mstrmojo.dom&&mstrmojo.dom.detachEvent(el,eventName,f);}}var CSS_MIN=" minimized",CSS_RESTORING=" restoring",CSS_CLOSED=" closed";return{bottom:0,right:0,init:function init(elCurtain){if(this.initialized){return ;}var me=this;this.elStats=(elCurtain&&elCurtain.parentNode)||document.getElementById("dhtml_statistics");this.elDrag=document.getElementById("stats_drag");if(this.elDrag){attachEvent(this.elDrag,"mousedown",function(e){me.onmousedown(e);});}this.elMin=document.getElementById("stats_min");if(this.elMin){attachEvent(this.elMin,"click",function(e){me.onmin(e);});}this.elMax=document.getElementById("stats_max");if(this.elMax){attachEvent(this.elMax,"click",function(e){me.onmax(e);});}this.elClose=document.getElementById("stats_close");if(this.elClose){attachEvent(this.elClose,"click",function(e){me.onclose();});}this.initialized=true;},onmousedown:function onmousedown(e){e=e||window.event;if(this.handlerMove){detachEvent(document.body,"mousemove",this.handlerMove);detachEvent(document.body,"mouseup",this.handlerUp);}if(this.initialized&&mouseButton(e)==1){this.elStats=this.elStats||eventTarget(e).parentNode;this.elStats.firstChild.onselectionstart=function(){return false;};var me=this;this.handlerMove=function(e){me.onmousemove(e);};this.handlerUp=function(e){me.onmouseup(e);};attachEvent(document.body,"mousemove",this.handlerMove);attachEvent(document.body,"mouseup",this.handlerUp);var pos=mousePos(e);this.mx=pos.x;this.my=pos.y;return false;}},onmouseup:function onmouseup(){detachEvent(document.body,"mousemove",this.handlerMove);detachEvent(document.body,"mouseup",this.handlerUp);this.bottom=this._bottom;this.right=this._right;},onmousemove:function onmousemove(e){var el=this.elStats;if(el){var pos=mousePos(e);this.deltaX=pos.x-this.mx;this.deltaY=pos.y-this.my;this._bottom=this.bottom-this.deltaY;this._right=this.right-this.deltaX;el.style.right=this._right+"px";el.style.bottom=this._bottom+"px";}return false;},onmin:function min(){var el=this.elStats;el.className+=CSS_MIN;el.style.cssText="right: 0; bottom: -"+(el.offsetHeight-13)+"px";return false;},onmax:function onmax(){this.bottom=0;this.right=0;var el=this.elStats;el.className+=CSS_RESTORING;window.setTimeout(function(){el.className=el.className.replace(CSS_RESTORING,"");},300);el.className=el.className.replace(CSS_MIN,"");el.style.cssText+="right:0; bottom:0;";return false;},onclose:function close(){this.elStats.className+=CSS_CLOSED;}};}());
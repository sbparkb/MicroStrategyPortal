mstrESRIVisPropsEditorImplScript=true;mstrESRIVisPropsEditorImpl.prototype=new mstrIPhoneMapVisPropsEditorImpl();mstrESRIVisPropsEditorImpl.prototype.onload=function(){try{if(!this.isValidGrid){return ;}this.TRDisplay=mstr.utils.ISDXIE?"block":"table-row";for(var e in this.keys){this.initBone();this.updateAttrForms("af",e);this.updateRadio(e);this.updateIcon("dms",e);this.updateMarker(e);this.updateArea(e);}var spanTab=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab1");if(spanTab&&spanTab.length>0){for(var i=0;i<spanTab.length;i++){if(spanTab[i].className=="mstrTabSetTabSelected"){this.setCurrentTab(spanTab[i]);break;}}}else{this.setCurrentTab();}}catch(err){microstrategy.errors.log(err);}};mstrESRIVisPropsEditorImpl.prototype.updateBubbleText=function(key){var parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key),maxBubbleText=microstrategy.findChildWithAtt(parentDiv,"input","id","mbs"),bubbleWarningText=microstrategy.findChildWithAtt(parentDiv,"span","id","bubbleWarning");if(parseInt(maxBubbleText.value)<7||parseInt(maxBubbleText.value)>100){bubbleWarningText.style.display="inline";}else{bubbleWarningText.style.display="none";}};mstrESRIVisPropsEditorImpl.prototype.updateMarker=function(key){var parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key),showMarker=microstrategy.findChildWithAtt(parentDiv,"input","id","sm");var markerFieldsInput=new Array("mbs","at","mc");for(var i=0;i<markerFieldsInput.length;i++){microstrategy.findChildWithAtt(parentDiv,"input","id",markerFieldsInput[i]).disabled=showMarker.checked?false:true;}var markerFieldsSelect=new Array("mss","af","ma","lat","lng","satf","atf");for(var i=0;i<markerFieldsSelect.length;i++){microstrategy.findChildWithAtt(parentDiv,"select","id",markerFieldsSelect[i]).disabled=showMarker.checked?false:true;}var radioOptions=microstrategy.findChildrenWithAtt(parentDiv,"input","id","mtp"+key);for(var j=0;j<radioOptions.length;j++){radioOptions[j].disabled=!showMarker.checked;}var hasChecked=false;for(var k=0;k<radioOptions.length;k++){hasChecked|=radioOptions[k].checked;}if(!hasChecked){radioOptions[0].checked=true;}};mstrESRIVisPropsEditorImpl.prototype.updateArea=function(key){var parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key);var showArea=microstrategy.findChildWithAtt(parentDiv,"input","id","sa");var aa=microstrategy.findChildWithAtt(parentDiv,"select","id","aa");aa.disabled=showArea.checked?false:true;if(this.isOnPremise===false){var lid=microstrategy.findChildWithAtt(parentDiv,"select","id","lid");lid.disabled=showArea.checked?false:true;}};mstrESRIVisPropsEditorImpl.prototype.validateMarkerAtt=function(formName,key,propName1,propName2){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),showMarker=microstrategy.findChildWithAtt(parentDiv,"input","id","sm");if(showMarker!=null&&showMarker.checked==false){return true;}return this.validateLatLong(parentDiv,key,propName1,propName2);};mstrESRIVisPropsEditorImpl.prototype.updateRadio=function(key){var parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key);if(!parentDiv){return ;}var radioOptions=microstrategy.findChildrenWithAtt(parentDiv,"input","id","mtp"+key);if(!radioOptions){return ;}var hideBubble=radioOptions[0].checked;var checkedOpt=radioOptions[2].checked?radioOptions[2]:radioOptions[1].checked?radioOptions[1]:radioOptions[0],densityPD=microstrategy.findChildWithAtt(parentDiv,"div","id","densityPulldown").style,maxBSTB=microstrategy.findChildWithAtt(parentDiv,"tr","id","maxBubbleSizeTextbox").style,dms=document.getElementById("dms").style,mSizeStyle=microstrategy.findChildWithAtt(parentDiv,"tr","id","mapSizingStyle").style;atCB=microstrategy.findChildWithAtt(parentDiv,"tr","id","applyThreadCheckBox").style;mcCB=microstrategy.findChildWithAtt(parentDiv,"tr","id","applyMarkerClustering").style;if(checkedOpt.value=="1"){mSizeStyle.display="none";maxBSTB.display="none";atCB.display=this.TRDisplay;mcCB.display=this.TRDisplay;densityPD.visibility="hidden";if(mstr.utils.ISIE4){dms.visibility="hidden";}}else{if(checkedOpt.value=="2"){maxBSTB.display=this.TRDisplay;mSizeStyle.display=this.TRDisplay;atCB.display=this.TRDisplay;mcCB.display=this.TRDisplay;densityPD.visibility="hidden";if(mstr.utils.ISIE4){dms.visibility="hidden";}}else{if(checkedOpt.value=="4"){mSizeStyle.display="none";maxBSTB.display="none";densityPD.visibility="visible";if(mstr.utils.ISIE4){dms.visibility="visible";}atCB.display="none";mcCB.display="none";}}}this.updateAttrForms("af",key);};mstrESRIVisPropsEditorImpl.prototype.updateAttrForms=function(propName,key){var parentDiv=(microstrategy.findChildWithAtt(this.elem,"div","key",key)),attForm=microstrategy.findChildWithAtt(parentDiv,"select","id","af"),visProps;if(this.visProps){if(this.visProps.pgk==key||key==-1){visProps=this.visProps;}else{if(this.visProps.sgProps){visProps=this.visProps.sgProps[key];}}}var isSel=function(curElem,propName,defaultVal){return(!visProps||!visProps[propName])?index==defaultVal:visProps[propName]==curElem;};if(!attForm){return ;}var attformTR=microstrategy.findChildWithAtt(parentDiv,"tr","id","attform").style,attrTR=microstrategy.findChildWithAtt(parentDiv,"tr","id","attr").style,attTR=microstrategy.findChildWithAtt(parentDiv,"tr","id","att").style;var lat=microstrategy.findChildWithAtt(parentDiv,"select","id","lat"),lng=microstrategy.findChildWithAtt(parentDiv,"select","id","lng");if(attForm.value=="1"){var attPulldown=microstrategy.findChildWithAtt(parentDiv,"select","id","ma");if(!attPulldown){return ;}var attForms=this.attForms[key][attPulldown[attPulldown.selectedIndex].value];if(attForms){var satf=microstrategy.findChildWithAtt(parentDiv,"select","id","satf");var index=0;for(var i=lat.options.length-1;i>=0;i--){lat.options[i]=null;lng.options[i]=null;satf.options[i]=null;}for(var e in attForms){lat.options[index]=new Option(attForms[e],e,null,isSel(e,"lat",0));lng.options[index]=new Option(attForms[e],e,null,isSel(e,"lng",1));satf.options[index]=new Option(attForms[e],e,null,isSel(e,"satf",0));index++;}}attformTR.display="";attrTR.display="";attTR.display="none";}else{var atts=this.att[key];if(atts){var index=0;for(var i=lat.options.length-1;i>=0;i--){lat.options[i]=null;lng.options[i]=null;}for(var e in atts){lat.options[index]=new Option(atts[e],e,null,isSel(e,"lat",0));lng.options[index]=new Option(atts[e],e,null,isSel(e,"lng",1));index++;}}attTR.display="";attformTR.display="none";attrTR.display="none";}};mstrESRIVisPropsEditorImpl.prototype.updateIcon=function(selectedStyle,key){var parentDiv=microstrategy.findChildWithAtt(this.elem,"div","key",key),sty=microstrategy.findChildWithAtt(parentDiv,"select","id",selectedStyle);var icon=microstrategy.findChildWithAtt(parentDiv,"img","id","density-icon");if(sty&&icon){icon.src=this.densityMap[sty.value];}};function mstrESRIVisPropsEditorImpl(id){this.inherits=mstrIPhoneMapVisPropsEditorImpl;this.inherits(id);this.id=id;this.inherits=null;this.path="microstrategy.bone('"+id+"')";return this;}
mstrObjectBrowserImplScript=true;mstrObjectBrowserImpl.prototype=new mstrEditorImpl();mstrObjectBrowserImpl.prototype.updateManager=microstrategy.updateManager;mstrObjectBrowserImpl.prototype.tree=null;mstrObjectBrowserImpl.prototype.selections=null;mstrObjectBrowserImpl.prototype.mask=null;mstrObjectBrowserImpl.prototype.dragSource=null;mstrObjectBrowserImpl.prototype.dndHelper=null;mstrObjectBrowserImpl.prototype.type=microstrategy.OBJTYPE_OBJBROWSER;mstrObjectBrowserImpl.prototype.isRWTab=false;mstrObjectBrowserImpl.prototype.onload=function(){try{this.dragSource=null;this.initEditor();this.initTree();if(typeof (mstrMaskImpl)!="undefined"){this.mask=new mstrMaskImpl();}this.maskFor=microstrategy.OBJTYPE_ANY;this.updateManager=microstrategy.updateManager;this.dndHelper=new mstrDNDHelperImpl(this);var accordionTabManager=microstrategy.findAncestorWithAtt(this.elem,"scriptClass","mstrAccordionTabManagerImpl");if(accordionTabManager){this.tabManager=microstrategy.findBone(accordionTabManager);}if(bIsIE4){this.elem.onselectstart=new Function("return microstrategy.bone('"+this.id+"').onselectstart();");}}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.onpostload=function(){try{if((microstrategy.IS_RELOAD||(bIsW3C&&!bIsIE4))&&!this.isRWTab){microstrategy.eventManager.ondialogresize();}}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.cancelContextMenu=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);if(obj!=null){if((obj.nodeName.toLowerCase()=="input"&&(obj.getAttribute("type")=="text"||obj.getAttribute("type")=="password"))||(obj.nodeName.toLowerCase()=="textarea")){return true;}}if(this.selections!=null&&!this.selections.isSameType()){if(bIsIE4){e.cancelBubble=true;}return false;}return true;}catch(err){microstrategy.errors.log(err);return true;}};mstrObjectBrowserImpl.prototype.resize=function(){try{if(!this.elem){return ;}var MIN_HEIGHT=250;var hElem=Math.max(getClientHeight()-getObjSumTop(this.elem)-getFooterHeight(),MIN_HEIGHT);if(hElem!=parseInt(this.elem.style.height)){if(bIsIE7){hElem=hElem-SCROLLBAR_SIZE;}this.elem.style.height=hElem+"px";microstrategy.updateBrowserSetting("obH",getObjHeight(this.elem));}if(this.moveResizeHandles){this.moveResizeHandles();}if(this.resizeContents){this.resizeContents();}if(this.mask&&this.mask.onmaskedobjectresize){this.mask.onmaskedobjectresize();}}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.onwinresize=function(){try{var resizeFn=function(){var bone=microstrategy.bone(this.id);if(bone&&bone.resizeObjectBrowser){bone.resizeObjectBrowser();}};window.setTimeout(resizeFn,0);}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.resizeObjectBrowser=function(){try{if((!(this.elem))||(!(this.elem.style))||!(isInDocument(this.elem))){return false;}this.resize();}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.hasMetrics=function(){try{}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.afterresize=function(){try{if(this.resizeContents){this.resizeContents();}microstrategy.updateBrowserSetting("obW",getObjWidth(this.elem));microstrategy.updateBrowserSetting("obH",getObjHeight(this.elem));}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.onnotifydrag=function(items,bone,types){try{if((microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION)&&(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE)&&!this.isFeatureAvailable(microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS)){return ;}if(bone!=this&&bone.deleteItems){var drag=false;if(microstrategy.EXECUTION_SCOPE!=microstrategy.RWD_EXECUTION){if(microstrategy.getViewerBone()){if(!microstrategy.getViewerBone().isFeatureAvailable(microstrategy.FEATURE_MODIFY_REPORT_LIST)){return ;}}drag=this.isFeatureAvailable(microstrategy.FEATURE_WEB_PIVOT);}else{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.isFeatureAvailable(microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS)){drag=true;}}if(drag){this.mask.toggle(true,microstrategy.OBJTYPE_ANY);this.dragSource=bone;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.ondrop=function(area,selections){try{if(this.dragSource){this.dragSource.deleteItems(selections.getItems());}}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.onselectstart=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);if(obj){if((obj.nodeName.toLowerCase()=="input"&&(obj.getAttribute("type")=="text"||obj.getAttribute("type")=="password"))||(obj.nodeName.toLowerCase()=="textarea")){return true;}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.onselectionchange=function(e){try{}catch(err){microstrategy.errors.log(err);}};mstrObjectBrowserImpl.prototype.ondocumentclick=function(e){try{if(this.selections&&this.selections.ondocumentclick){this.selections.ondocumentclick(e);}}catch(err){microstrategy.errors.log(err);}};mstrObjectBrowserImpl.prototype.close=function(){try{mstrEditorImpl.prototype.close.call(this);if(bIsW3C&&!bIsIE4&&!this.isRWTab){microstrategy.eventManager.ondialogresize();}}catch(err){microstrategy.errors.log(err);}};mstrObjectBrowserImpl.prototype.initTree=function(){try{var tree=microstrategy.subObjectFind(this.elem,["DIV"],microstrategy.SUBOBJTYPE_TREE);if(tree!=null){this.tree=new mstrTreeImpl(tree.getAttribute("id"));this.tree.parentBone=this;this.tree.path="microstrategy.bone('"+this.id+"').tree";if(this.tree.onload){this.tree.onload();}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.getAttributeForms=function(attribute){try{var __result=[];var parent=findTargetTag(attribute,"LI");var ul=parent.lastChild;if(ul!=null&&ul.tagName.toLowerCase()=="ul"){__result=ul.getElementsByTagName("span");}return __result;}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectBrowserImpl.prototype.getDNDHelperImage=function(bone,pointsTo){try{return(bone.id==this.id)?null:microstrategy.FOLDER_IMAGES+"XDelete.gif";}catch(err){microstrategy.errors.log(err);}return null;};function mstrObjectBrowserImpl(id){this.inherits=mstrEditorImpl;this.inherits(id);delete this.inherits;return this;}mstrObjSelectionsImplScript=true;mstrObjSelectionsImpl.prototype=new mstrSelectionsImpl();mstrObjSelectionsImpl.prototype.updateManager=microstrategy.updateManager;mstrObjSelectionsImpl.prototype.selectedClass="selected";mstrObjSelectionsImpl.prototype.onmouseup=function(e){try{this.parentBone.dndHelper.onmouseup(this.path);}catch(err){microstrategy.errors.log(err);}};mstrObjSelectionsImpl.prototype.ondocumentclick=function(e){try{if(!this.isActive()){return ;}if(!e){e=window.event;}if(e.e){e=e.e;}var obj=microstrategy.findAncestor(getEventTarget(e));if(obj==null){this.clear();return ;}var objType=obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(objType==microstrategy.OBJTYPE_CONTEXT_MENU||objType==microstrategy.OBJTYPE_MESSAGE_BOX){return ;}if(this.needToClear(obj)){this.clear();}}catch(err){microstrategy.errors.log(err);}};mstrObjSelectionsImpl.prototype.needToClear=function(obj){var bone=findTarget(obj,microstrategy.HTMLATTR_SCRIPTCLASS);return(bone==null||bone.getAttribute("id")!=this.parentBone.id);};mstrObjSelectionsImpl.prototype.add=function(obj,objToAdd){try{obj=(obj.tagName.toLowerCase()=="span"&&obj.parentNode.tagName.toLowerCase()=="span"&&obj.parentNode.className.indexOf("mstrIcon-lv")>-1)?obj.parentNode.nextSibling:obj;if(objToAdd){if(objToAdd.length==0){objToAdd.push(obj);}else{objToAdd[0]=obj;}}mstrSelectionsImpl.prototype.add.call(this,obj);var oldClassName=obj.className;obj.className=(typeof (oldClassName)=="undefined")?this.selectedClass:this.selectedClass+" "+oldClassName;}catch(err){microstrategy.errors.log(err);}return false;};mstrObjSelectionsImpl.prototype.resetClassName=function(obj){try{var newClass="";if(obj){var oldClassName=obj.className;if((oldClassName.length>0)&&(oldClassName.indexOf(this.selectedClass)==0)){newClass=oldClassName.substr(this.selectedClass.length);}else{newClass=oldClassName;}obj.className=newClass;}}catch(err){microstrategy.errors.log(err);}return true;};mstrObjSelectionsImpl.prototype.remove=function(obj){try{mstrSelectionsImpl.prototype.remove.call(this,obj);this.resetClassName(obj);}catch(err){microstrategy.errors.log(err);}return false;};mstrObjSelectionsImpl.prototype.clear=function(){try{for(var id in this.items){this.resetClassName(this.items[id]);}mstrSelectionsImpl.prototype.clear.call(this);}catch(err){microstrategy.errors.log(err);}return false;};mstrObjSelectionsImpl.prototype.getItems=function(){try{var __result=mstrSelectionsImpl.prototype.getItems.call(this);if(__result!=null&&__result.length>0){if(__result[0].getAttribute(microstrategy.HTMLATTR_ID)!=__result[0].getAttribute(microstrategy.HTMLATTR_DSS_ID)){__result.sort(function(a,b){return parseInt(a.getAttribute("id").substr(32))-parseInt(b.getAttribute("id").substr(32));});}}return __result;}catch(err){microstrategy.errors.log(err);return null;}};function mstrObjSelectionsImpl(){this.inherits=mstrSelectionsImpl;this.inherits();delete this.inherits;return this;}
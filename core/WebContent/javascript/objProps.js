mstrObjectPropsImpl.prototype=new Object();mstrObjectPropsImpl.prototype.parentBone=null;mstrObjectPropsImpl.prototype.defaultFormats=null;mstrObjectPropsImpl.DEFAULT_COPYABLE_ON_SINGLE_CLICK=1;mstrObjectPropsImpl.DEFAULT_COPYABLE_ALWAYS=0;mstrObjectPropsImpl.DEFAULT_COPYABLE_NOT="false";mstrObjectPropsImpl.prototype.onredo=function(action){try{this.pasteFormat(action.elem,action.cachedArray,false);this.parentBone.doc.selections.syncUp();}catch(err){microstrategy.errors.log(err);}return false;};mstrObjectPropsImpl.prototype.onundo=function(action){try{var ca=action.cachedArray;var isGradient=false;var gradientSettings;for(var id in ca){var txt=microstrategy.styleObj.getCssText(ca[id]);var objs=document.getElementsByName(id);if(ca[id].getAttribute("gradientcolor")!=null){gradientSettings=(ca[id].getAttribute("gradientcolor"))?ca[id].getAttribute("gradientcolor").split(","):null;isGradient=(gradientSettings!=null);}for(var i=0;i<objs.length;i++){objs[i].style.cssText+=("; "+txt);if(isGradient){objs[i].setAttribute("gradientcolor",ca[id].getAttribute("gradientcolor"));gradientUtil.applyGradient(objs[i],gradientSettings[gradientUtil.GRADIENT_START_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_ANGLE_INDEX],gradientSettings[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientSettings[gradientUtil.GRADIENT_YOFFSET_INDEX]);}else{if(objs[i].getAttribute("gradientcolor")){objs[i].removeAttribute("gradientcolor");}if(bIsDXIE){var gradientFilter=microstrategy.styleObj.getFilter(objs[i],"Gradient");if(gradientFilter!=null){gradientFilter.enabled=false;}}}}}this.parentBone.doc.selections.syncUp();}catch(err){microstrategy.errors.log(err);}return false;};mstrObjectPropsImpl.prototype.applyCtrlDft=function(targets,sendUpdate){try{var id,hasTemplate=false;var fmtInfo=microstrategy.getFormatObject();if(sendUpdate){var ca={orgObjs:{}};var rtn="";for(id in targets){ca.orgObjs[id]=targets[id].cloneNode(true);rtn+=id+mstrUpdateManager.ITEM_SEPARATOR;}}var subsection=null;for(id in targets){var objs=document.getElementsByName(id);var tType=targets[id].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)||targets[id].getAttribute(microstrategy.HTMLATTR_OBJTYPE);for(var i=0;i<objs.length;i++){this.initObjectFormat(objs[i],false);if(tType==microstrategy.SUBOBJTYPE_DOC_LINE){this.parentBone.doc.fixLineItem(objs[i],microstrategy.SUBOBJTYPE_DOC_LINE);}}var tBone=mstrStaticDoc.getBone(targets[id]);if(tBone&&tBone.onApplyDefaultFormat){tBone.onApplyDefaultFormat();}if(targets[id].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){subsection=(objs.length&&objs.length>0)?objs[0]:targets[id];}if(tType==microstrategy.SUBOBJTYPE_DOC_SHAPE&&targets[id].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){if(tBone){tBone.synchronizeFormat();}}if(tType==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){hasTemplate=true;}}if(subsection!=null){var subsectionBone=microstrategy.findBone(subsection);if(subsectionBone!=null){subsectionBone.resizeRuler(getObjHeight(subsection));}}if(sendUpdate){var um=this.parentBone.updateManager;if(rtn.indexOf(mstrUpdateManager.ITEM_SEPARATOR)!=-1){um.add([um.createActionObject(targets,mstrUpdateManager.APPLY_CONTROL_DEFAULT,this.parentBone.beanPath,["2048018","2048076"],[mstrUpdateManager.UPDATE_LATER,rtn],[],ca)]);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&hasTemplate){um.flushAndSubmitChanges();}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrObjectPropsImpl.prototype.pasteFormat=function(source,targets,sendUpdate){try{var type=source.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);var defFormats=this.defaultFormats[type];var srcDefFmt;var formatType;var titleFormat=(type==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL?microstrategy.FORMAT_TYPE_CONTROL_TITLE:microstrategy.FORMAT_TYPE_TITLE);var fmtTypes=[microstrategy.FORMAT_TYPE_MAIN,titleFormat];var formatType;var psBone=null;var sourceElem=null;var getTitleBar=function(elem,stp){var bone=mstrStaticDoc.getBone(elem),tb=null;if(bone){if(stp==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&bone.isTitleVisible){tb=bone.titleBar;}else{if(stp==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&bone.isTitleVisible){tb=bone.titleBars[0];}else{if(stp==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&bone.titleBarObj){tb=bone.titleBarObj;}}}}return tb;};if(!defFormats){return true;}var index;for(index=0;index<fmtTypes.length;index++){formatType=fmtTypes[index];srcDefFmt=defFormats[formatType];if(!srcDefFmt){continue;}if(formatType!=microstrategy.FORMAT_TYPE_MAIN){var tbObj=getTitleBar(source,type);if(!tbObj){continue;}}var id;var fmtInfo=microstrategy.getFormatObject();var rtn=new Object();if(sendUpdate){var ca=new Object();for(id in targets){ca[id]=targets[id].cloneNode(true);}}for(id in targets){var trgType=targets[id].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);var trgFmtType=(formatType==microstrategy.FORMAT_TYPE_MAIN?microstrategy.FORMAT_TYPE_MAIN:(trgType==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL?microstrategy.FORMAT_TYPE_CONTROL_TITLE:microstrategy.FORMAT_TYPE_TITLE));var trgDefFmt=this.defaultFormats[trgType][trgFmtType];var objs=document.getElementsByName(id);if(!trgDefFmt){continue;}for(var iSet in srcDefFmt){var srcSet=srcDefFmt[iSet];var trgSet=trgDefFmt[iSet];if(!trgSet){continue;}var fmtInfoSet=fmtInfo[iSet];for(var iProp in srcSet){var srcProp=srcSet[iProp];if(!srcProp.isCopyable){continue;}var trgProp=trgSet[iProp];if(!trgProp){continue;}var name;if(iSet=="FormattingBorder"&&iProp.indexOf("Style")!=-1){name="border"+iProp.substr(0,iProp.indexOf("Style"));}else{name=fmtInfoSet[iProp][mstrFormatObject.HTML_PROP_NAME];}rtn[id]=id;var isGradient=false;var gradientSettings;if(name=="backgroundColor"){sourceElem=source;if(formatType!=microstrategy.FORMAT_TYPE_MAIN){sourceElem=getTitleBar(source,type);}else{if(type==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){psBone=microstrategy.findBone(source);if(psBone){sourceElem=psBone.getCurrentPanel().elem;}}}if(sourceElem&&sourceElem.getAttribute("gradientcolor")!=null){gradientSettings=(sourceElem.getAttribute("gradientcolor"))?sourceElem.getAttribute("gradientcolor").split(","):null;isGradient=(gradientSettings!=null);}else{isGradient=false;}}for(var i=0;i<objs.length;i++){var cpObj=objs[i];if(formatType!=microstrategy.FORMAT_TYPE_MAIN){var tbObj=getTitleBar(cpObj,trgType);if(!tbObj){continue;}}if(trgType==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&iSet=="FormattingPatterns"&&formatType==microstrategy.FORMAT_TYPE_MAIN){psBone=microstrategy.findBone(objs[i]);if(psBone){cpObj=psBone.getCurrentPanel().elem;}}if(trgType==microstrategy.SUBOBJTYPE_DOC_SHAPE&&iSet=="FormattingLine"&&iProp=="LineColor"){var value=microstrategy.styleObj.getValue(source,name);this.parentBone.doc.formatLineSetting([cpObj],"lineColor",value,false,[]);}else{microstrategy.styleObj.setValue(cpObj,name,microstrategy.styleObj.getValue(source,name,formatType),trgFmtType);}if(name=="backgroundColor"){if(formatType!=microstrategy.FORMAT_TYPE_MAIN){cpObj=getTitleBar(cpObj,trgType);if(!cpObj){continue;}}if(isGradient){cpObj.setAttribute("gradientcolor",sourceElem.getAttribute("gradientcolor"));gradientUtil.applyGradient(cpObj,gradientSettings[gradientUtil.GRADIENT_START_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_ANGLE_INDEX],gradientSettings[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientSettings[gradientUtil.GRADIENT_YOFFSET_INDEX]);}else{if(cpObj.getAttribute("gradientcolor")){cpObj.removeAttribute("gradientcolor");}if(bIsDXIE){var gradientFilter=microstrategy.styleObj.getFilter(cpObj,"Gradient");if(gradientFilter!=null){gradientFilter.enabled=false;}}}}}}}if(type==trgType){this.pasteItemFormats(source,targets[id]);}if(trgType==microstrategy.SUBOBJTYPE_DOC_SHAPE){for(var i=0;i<objs.length;i++){if(objs[i].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var rrBone=microstrategy.findBone(objs[i]);if(rrBone){rrBone.synchronizeFormat();}}}}}}if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}if(sendUpdate){rtn=mstr.utils.Arrays.fromHashValues(rtn);if(rtn.length>0){var um=this.parentBone.updateManager;um.add([um.createActionObject(source,mstrUpdateManager.PASTE_FORMATTING,this.parentBone.beanPath,["2048018","2048066"],[mstrUpdateManager.UPDATE_LATER,rtn.toString()],[],ca)]);}}return true;}catch(err){microstrategy.errors.log(err);}return false;};mstrObjectPropsImpl.prototype.pasteItemFormats=function(src,target){try{var srcBone=mstrStaticDoc.getBone(src);if((!srcBone)||(!srcBone.getItemFormats)){return false;}var srcFormats=srcBone.getItemFormats();if(!srcFormats){return false;}var targetBone=mstrStaticDoc.getBone(target);for(var i in srcFormats){for(var j in srcFormats[i]){targetBone.setFormatValue(i,srcFormats[i][j]);}}}catch(err){microstrategy.errors.log(err);}return false;};mstrObjectPropsImpl.prototype.initObjectFormat=function(span,forNewObj,subObjType,formatType){try{var objType=span.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)||span.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var type=(subObjType!=null)?subObjType:objType;var defFormats=this.defaultFormats[type];if(!defFormats){return span;}if(!formatType){formatType=microstrategy.FORMAT_TYPE_MAIN;}var defFmt=defFormats[formatType];if(!defFmt){return span;}var fmtInfo=microstrategy.getFormatObject();this.clearAllFormat(span);var is3D=false;var propColors3D=new Array();var colors3D=new Array();var weight3D=0;var isGradient=false;var isShadow=false;var isAlpha=false;var shadowDepth=null;var alphaOpacity=null;var startColor=null;var endColor=null;var gradientAngle=null;var gradientXOffset=null;var gradientYOffset=null;var isRotated=null;var rotation;for(var iSet in defFmt){if(type==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&formatType==microstrategy.FORMAT_TYPE_MAIN){if(objType==type){if(iSet=="FormattingPatterns"){continue;}}else{if(iSet!="FormattingPatterns"){continue;}}}var set=defFmt[iSet];var fmtInfoSet=fmtInfo[iSet];for(var iProp in set){var prop=set[iProp];if((!forNewObj)&&(!prop.isCopyable)){continue;}var value=prop.defaultValue;if((!value&&value!=0)||String(value).length==0){continue;}var fmtInfoProp=fmtInfoSet[iProp];if(!fmtInfoProp){continue;}var propName=fmtInfoProp[mstrFormatObject.HTML_PROP_NAME];var decodedvalue=fmtInfo.decodeValue(propName,value);if(decodedvalue==null){continue;}if(iSet=="FormattingPatterns"&&iProp=="SelectorSelectionColor"){microstrategy.styleObj.setAttValue(span,fmtInfo.getAttrNameFromStyle(propName),decodedvalue);continue;}if(iSet=="FormattingPatterns"&&iProp=="FillColor"){if(set.FillStyle.defaultValue=="1"){decodedvalue="transparent";span.style.backgroundColor=decodedvalue;}else{if(set.FillStyle.defaultValue=="2"){isGradient=true;startColor=decodedvalue.slice(1);endColor=fmtInfo.decodeValue("gradientColor",set.GradientColor.defaultValue).slice(1);gradientAngle=set.GradientAngle.defaultValue;gradientXOffset=set.GradientXOffset.defaultValue;gradientYOffset=set.GradientYOffset.defaultValue;decodedvalue="transparent";}}}if(iProp=="HighlightColor"){if(iSet=="FormattingPatterns"||iSet=="FormattingFont"){microstrategy.styleObj.setAttValue(span,fmtInfo.getAttrNameFromStyle(propName),value);}}if(iSet=="FormattingAppearance"){if(iProp=="DropShadowEffect"&&parseInt(decodedvalue)!=0){isShadow=true;shadowDepth=set.DropShadowDepth.defaultValue;}else{if(iProp=="AlphaEffect"&&parseInt(decodedvalue)!=0){isAlpha=true;alphaOpacity=set.AlphaOpacity.defaultValue;}}}if(iSet=="FormattingAlignment"){if(iProp=="TextDirection"&&parseInt(decodedvalue)!=0&&bIsW3C){isRotated=true;rotation=decodedvalue;}}if(iSet=="FormattingSize"&&(iProp=="Height"||iProp=="Width")&&type!=microstrategy.SUBOBJTYPE_DOC_LINE&&!(type==microstrategy.SUBOBJTYPE_DOC_SHAPE&&microstrategy.styleObj.getAttValue(span,microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){var adjustedValue=microstrategy.styleObj.adjustSizes(propName,decodedvalue,defFmt);span.style[propName]=adjustedValue+"px";microstrategy.styleObj.setAttValue(span,fmtInfo.getAttrNameFromStyle(propName),value);}else{if(fmtInfoProp[mstrFormatObject.ATTR_NAME]&&fmtInfoProp[mstrFormatObject.ATTR_NAME].length>0){if(fmtInfoProp[mstrFormatObject.TARGET]&&(parseInt(fmtInfoProp[mstrFormatObject.TARGET])&(parseInt(mstrFormatObject.TARGET_VALUE_STYLE)+parseInt(mstrFormatObject.TARGET_VALUE_ATTR)))>0){span.setAttribute(fmtInfoProp[mstrFormatObject.ATTR_NAME],value);if(iSet=="FormattingBorder"&&iProp.indexOf("Style")!=-1&&iProp.indexOf("3D")==-1){propName=propName.substr(0,propName.length-"Style".length);span.style[propName]=decodedvalue+" "+microstrategy.styleObj.getValue(span,propName+"Color");}else{if(iSet=="FormattingLine"&&iProp.indexOf("Line")!=-1){if(iProp.indexOf("Weight")!=-1){iProp="LineWidth";}var subname=iProp.substr("Line".length,iProp.length-1);var names=null;if(microstrategy.subObjectType(span)==microstrategy.SUBOBJTYPE_DOC_LINE){names=new Array("borderTop","borderLeft");}else{if(microstrategy.subObjectType(span)==microstrategy.SUBOBJTYPE_DOC_SHAPE){names=new Array("borderTop","borderLeft","borderRight","borderBottom");}}for(var i=0;names&&i<names.length;i++){microstrategy.styleObj.setValue(span,names[i]+subname,decodedvalue);}}else{if(iSet=="FormattingBorder"){microstrategy.styleObj.setValue(span,propName,decodedvalue);if(iProp=="Border3DStyle"&&value!=0){is3D=true;}else{if(iProp=="Border3DWeight"){weight3D=value;}else{if(iProp.indexOf("Border3D")>-1){propColors3D.push(propName.substr(0,propName.length-1));colors3D.push(decodedvalue);}}}}else{if(iSet=="FormattingAppearance"&&iProp.indexOf("DropShadow")!=-1){microstrategy.styleObj.setValue(span,propName,decodedvalue);}span.style[propName]=decodedvalue;}}}}else{microstrategy.styleObj.setValue(span,propName,decodedvalue);}}else{microstrategy.styleObj.setValue(span,propName,decodedvalue);}}}}if(is3D){span.style.borderWidth=weight3D+"pt";span.style.borderStyle="solid";for(var x=0;x<colors3D.length;x++){span.style[propColors3D[x]]=colors3D[x];}}if(isGradient){if((span.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&span.getAttribute("scriptclass")!="mstrPanel")||(span.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SHAPE&&span.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){var selectedBone=(span.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION)?this.parentBone&&this.parentBone.getChildBone(span):microstrategy.bone(span.id);if(selectedBone){if(objType==microstrategy.OBJTYPE_DOC_SUBSECTION){selectedBone.setSibsWithGradients([span]);var gradientSettings=new Array();gradientSettings[gradientUtil.GRADIENT_START_COLOR_INDEX]=startColor;gradientSettings[gradientUtil.GRADIENT_END_COLOR_INDEX]=endColor;gradientSettings[gradientUtil.GRADIENT_ANGLE_INDEX]=gradientAngle;gradientSettings[gradientUtil.GRADIENT_TRANSITION_TYPE_INDEX]=14;gradientSettings[gradientUtil.GRADIENT_XOFFSET_INDEX]=gradientXOffset;gradientSettings[gradientUtil.GRADIENT_YOFFSET_INDEX]=gradientYOffset;selectedBone.setGradientInfo([span],gradientSettings);}selectedBone.applyGradient();}}else{span.style.backgroundColor="transparent";span.setAttribute("gradientcolor",startColor+","+endColor+",14,"+gradientAngle+","+gradientXOffset+","+gradientYOffset);span.setAttribute("bgstyle","2");gradientUtil.applyGradient(span,startColor,endColor,gradientAngle,gradientXOffset,gradientYOffset,microstrategy.styleObj);}}else{var bgstyleV=(span.style.backgroundColor=="transparent")?1:0;span.setAttribute("bgstyle",bgstyleV);if(span.getAttribute("gradientcolor")){span.removeAttribute("gradientcolor");}if(bIsDXIE){var gradientFilter=this.parentBone.doc.styleObj.getFilter(span,"Gradient");if(gradientFilter!=null){gradientFilter.enabled=false;}}}if(isShadow){span.setAttribute("dropShadowDepth",shadowDepth);span.setAttribute("dropShadowEffect","1");microstrategy.styleObj.applyShadow(span,"dropShadowEffect","1");}if(isAlpha){span.setAttribute("alphaOpacity",alphaOpacity);span.setAttribute("alphaEffect","1");microstrategy.styleObj.applyAlpha(span,"alphaEffect","1");}if(isRotated){this.parentBone.doc.styleObj.applyTextDirection(span,null,rotation);}if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}}catch(err){microstrategy.errors.log(err);}return span;};mstrObjectPropsImpl.prototype.createFormatObject=function(objType,formatType){try{var res=new Object();var defFormats=this.defaultFormats[objType];if(!defFormats){return res;}var defFmt=defFormats[formatType];if(!defFmt){return res;}var fmtInfo=microstrategy.getFormatObject();for(var iSet in defFmt){var set=defFmt[iSet];var fmtInfoSet=fmtInfo[iSet];for(var iProp in set){var prop=set[iProp];var value=prop.defaultValue;if((!value)||String(value).length==0){continue;}var fmtInfoProp=fmtInfoSet[iProp];if(!fmtInfoProp){continue;}var name=fmtInfoProp[mstrFormatObject.HTML_PROP_NAME];var decodedvalue=fmtInfo.decodeValue(name,value);if(decodedvalue==null){continue;}if(iSet=="FormattingPatterns"){if(iProp=="FillStyle"){continue;}if(iProp=="FillColor"){if(set.FillStyle.defaultValue=="1"){decodedvalue="transparent";}}}res[name]=decodedvalue;}}if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}}catch(err){microstrategy.errors.log(err);}return res;};mstrObjectPropsImpl.prototype.cloneFormats=function(srcFormats){try{var newFormats=null;if(srcFormats){newFormats=new Object();for(var i in srcFormats){newFormats[i]=new Object();for(var j in srcFormats[i]){newFormats[i][j]=srcFormats[i][j];}}}return newFormats;}catch(err){microstrategy.errors.log(err);}return res;};mstrObjectPropsImpl.prototype.setDefaultFormat=function(obj){var sevedFmtType=microstrategy.formatType;try{var fmtInfo=microstrategy.getFormatObject();var type=obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)||obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var defFormats=this.defaultFormats[type];if(!defFormats){return true;}for(var fmtType in defFormats){var defFmt=defFormats[fmtType];microstrategy.formatType=fmtType;var gradient=null;var gradientInfo=null;if((type==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||type==microstrategy.SUBOBJTYPE_DOC_TEMPLATE)&&fmtType==mstrPanelStack.FMT_TYPE_TITLE){gradientInfo=microstrategy.styleObj.getValue(obj,"gradientcolor",fmtType);}else{gradientInfo=obj.getAttribute("gradientcolor");}if(gradientInfo&&gradientInfo.length>0){gradient=gradientInfo.split(",");}for(var iSet in defFmt){if(type==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&fmtType==microstrategy.FORMAT_TYPE_MAIN){if(iSet=="FormattingPatterns"){continue;}}var set=defFmt[iSet];var fmtInfoSet=fmtInfo[iSet];for(var iProp in set){var prop=set[iProp];var fmtInfoProp=fmtInfoSet[iProp];if(prop.isDefaultCopyable==mstrObjectPropsImpl.DEFAULT_COPYABLE_NOT||!fmtInfoProp){continue;}var propName=fmtInfoProp[mstrFormatObject.HTML_PROP_NAME];var attName=fmtInfoProp[mstrFormatObject.ATTR_NAME];if(iSet=="FormattingPatterns"&&gradient!=null){if(iProp=="FillStyle"){prop.defaultValue=2;}else{switch(iProp){case"FillColor":prop.defaultValue=fmtInfo.encodeValue(propName,"#"+gradient[gradientUtil.GRADIENT_START_COLOR_INDEX]);break;case"GradientColor":prop.defaultValue=fmtInfo.encodeValue("backgroundColor","#"+gradient[gradientUtil.GRADIENT_END_COLOR_INDEX]);break;case"GradientAngle":prop.defaultValue=gradient[gradientUtil.GRADIENT_ANGLE_INDEX];break;case"GradientXOffset":prop.defaultValue=gradient[gradientUtil.GRADIENT_XOFFSET_INDEX];break;case"GradientYOffset":prop.defaultValue=gradient[gradientUtil.GRADIENT_YOFFSET_INDEX];break;default:break;}}}else{if(type==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&iSet=="FormattingSize"&&iProp=="Height"&&microstrategy.styleObj.getAttValue(obj,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE&&microstrategy.styleObj.getAttValue(obj,microstrategy.HTMLATTR_WINDOW_STATE)!=microstrategy.WINDOW_STATE_NORMAL){prop.defaultValue=microstrategy.styleObj.getAttValue(obj,microstrategy.HTMLATTR_OLD_HEIGHT,fmtType);}else{if(attName&&attName.length>0){if(attName==microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR){prop.defaultValue=fmtInfo.encodeValue(propName,microstrategy.styleObj.getAttValue(obj,attName,fmtType));}else{prop.defaultValue=microstrategy.styleObj.getAttValue(obj,attName,fmtType);}}else{var value=microstrategy.styleObj.getValue(obj,propName,fmtType);if(iSet=="FormattingBorder"&&iProp.indexOf("Style")!=-1){var border=propName.substr(0,propName.length-"Style".length);prop.defaultValue=fmtInfo.encodeValue(propName,microstrategy.styleObj.getValue(obj,border+"Width")+" "+value);}else{prop.defaultValue=fmtInfo.encodeValue(propName,value);}}}}}}}var tBone=mstrStaticDoc.getBone(obj);if(tBone&&tBone.onSetDefaultFormat){tBone.onSetDefaultFormat();}var um=this.parentBone.updateManager;um.add([um.createActionObject(obj,mstrUpdateManager.SET_CTRL_DEFAULT,this.parentBone.beanPath,["2048018","2048012"],[mstrUpdateManager.UPDATE_LATER,obj.getAttribute("id")],[],null)],true);}catch(err){microstrategy.errors.log(err);}finally{microstrategy.formatType=sevedFmtType;}return false;};mstrObjectPropsImpl.prototype.clearAllFormat=function(obj){try{if(obj){var style=obj.style;if(style&&style.textDecoration){style.textDecoration="none";}if(microstrategy.styleObj.objSheet&&microstrategy.styleObj.objSheet.styleRules&&microstrategy.styleObj.objSheet.styleRules[microstrategy.styleObj.getId(obj)]){style=microstrategy.styleObj.objSheet.styleRules[microstrategy.styleObj.getId(obj)].style;}if(style&&style.textDecoration){style.textDecoration="none";}}}catch(err){microstrategy.errors.log(err);}return false;};mstrObjectPropsImpl.prototype.isCtrlDftObj=function(obj){try{if(obj){var type=obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(type==microstrategy.SUBOBJTYPE_DOC_TEXT||type==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||type==microstrategy.SUBOBJTYPE_DOC_IMAGE||type==microstrategy.SUBOBJTYPE_DOC_LINE||type==microstrategy.SUBOBJTYPE_DOC_SHAPE||type==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||type==microstrategy.SUBOBJTYPE_DOC_SUBSECTION||type==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||type==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||type==microstrategy.SUBOBJTYPE_DOC_PANEL){return true;}}return false;}catch(err){microstrategy.errors.log(err);}return false;};function mstrObjectPropsImpl(parentBone){this.parentBone=parentBone;this.defaultFormats=this.parentBone.defaultFormats;return this;}
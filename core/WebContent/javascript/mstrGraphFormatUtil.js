mstrGraphFormatUtilScript=true;mstrGraphFormatUtil.prototype={};mstrGraphFormatUtil.prototype.gProps=null;mstrGraphFormatUtil.prototype.formatInfo=graphFormatInfo;mstrGraphFormatUtil.prototype.target=null;mstrGraphFormatUtil.prototype.objNames=[];mstrGraphFormatUtil.prototype.objMajorShowMap=[];mstrGraphFormatUtil.TYPE_UNKNOWN="0";mstrGraphFormatUtil.TYPE_STRING="1";mstrGraphFormatUtil.TYPE_INTEGER="2";mstrGraphFormatUtil.TYPE_FLOAT="3";mstrGraphFormatUtil.TYPE_BOOLEAN="4";mstrGraphFormatUtil.MAJOR_GRAPHTYPE_3DSCATTER=262144;function mstrGraphFormatUtil(gProps,target){this.gProps=gProps;this.target=target;this.objNames[0]=[];this.objNames[1]=["allText","background","frame","legend","legendArea","gauge"];this.objNames[2]=["allTitles","title","subTitle","footNote","2DO1Title","2DXTitle","2DYTitle","2DY1Title","2DY2Title","3DColTitle","3DRowTitle","3DXTitle","3DZTitle","3DLYTitle","3DRYTitle"];this.objNames[3]=["allAxes","2DO1Label","2DX1Label","2DYLabel","2DY1Label","2DY2Label","2DZLabel","3DColHeader","3DRowHeader","3DXHeader","3DZHeader","3DLYHeader","3DRYHeader","pieGroupLabel","funnelGroupLabel","gaugeTitle"];this.objNames[4]=["areaRiser","barRiser","3DRiser","histograms","funnelSlice","radarRiser","gaugeNeedle","pieSlice","line","box","radarLine","paretoLine","bubbleLine"];this.objNames[5]=["allDataValues","allOPILBLValues","dataValue","pieValue","funnelValue","3DDataValue","spDataValue","3DScatterDataValue","paretoDataValue"];this.objNames[6]=["allOPILBLLabels","pieLabel","funnelLabel"];this.objNames[7]=["allAxes","2DX1Label","2DYLabel","2DY1Label","2DY2Label","2DZLabel","3DLYHeader","3DRYHeader"];this.objNames[8]=["allDataMarkers","dataMarker","radarDataMarker","gaugeMarker","paretoDM","boxDataMarker"];this.objNames[9]=["HichertDataValue"];this.objMajorShowMap[0]=[0,2,2,2,-1,0];this.objMajorShowMap[1]=[2,0,1,0,0,-1];this.objMajorShowMap[2]=[1,1,0,-1,1,1];this.objMajorShowMap[3]=[1,1,0,-1,1,1];return this;}mstrGraphFormatUtil.getMappedAttrType=function(fn){if(fn&&fn.indexOf("Field")>0){return false;}if(fn){if(fn.substr(0,4)=="text"){return"text";}else{if(fn.indexOf("Scale")>-1){return"Scale";}else{if(fn.indexOf("Interval")>-1){return"gridStepOn";}else{if(fn=="dualOptionItems"){return"seriesOnY2";}else{if(fn=="gfnCat"||fn=="gfnDecimalPlaces"||fn=="gfnThousandSeparator"||fn=="gfnCurrencyPosition"||fn=="gfnNegativeNumbers"||fn=="gfnCurrencySymbol"||fn=="gfnFormat"||fn=="gfnDate"||fn=="gfnTime"||fn=="gfnFraction"){return"numberFormat";}else{if(fn=="CMfillColor"||fn=="CMlineColor"||fn=="CMfontColor"){return{CMfillColor:"fillColor",CMfontColor:"fontColor",CMlineColor:"lineColor"}[fn];}}}}}}}return false;};mstrGraphFormatUtil.getMappedAttrName=function(fn){var t=mstrGraphFormatUtil.getMappedAttrType(fn);if(!t){return fn;}if(t=="text"){return"fontStyle";}else{if(t=="Scale"||t=="gridStepOn"){var s=fn.substr(fn.length-2);if(s.charAt(1)=="X"){t+="X";}else{if(s.charAt(0)=="Y"){t+=s;}else{t+="Z";}}}}return t;};mstrGraphFormatUtil.getMappedMinorType=function(mj,mn){if(mj==mstrGraphFormatUtil.MAJOR_GRAPHTYPE_3DSCATTER&&mn==2){return 1;}else{return mn;}};mstrGraphFormatUtil.isSubField=function(field){switch(field){case"textBoldItalic":case"textBold":case"textItalic":case"textUnderline":case"textStrikeout":case"maxScaleX":case"minScaleX":case"maxScaleY1":case"minScaleY1":case"maxScaleY2":case"minScaleY2":case"maxScaleZ":case"minScaleZ":case"gridIntervalX":case"gridIntervalY1":case"gridIntervalY2":case"gridIntervalZ":case"maxScaleCKX":case"minScaleCKX":case"maxScaleCKY1":case"minScaleCKY1":case"maxScaleCKY2":case"minScaleCKY2":case"maxScaleCKZ":case"minScaleCKZ":case"gridIntervalCKX":case"gridIntervalCKY1":case"gridIntervalCKY2":case"gridIntervalCKZ":case"gfnCat":case"gfnTime":case"gfnFraction":case"gfnDate":case"gfnDecimalPlaces":case"gfnCurrencySymbol":case"gfnCurrencyPosition":case"gfnNegativeNumbers":case"gfnThousandSeparator":case"gfnFormat":return true;default:return false;}};mstrGraphFormatUtil.getSubFieldValue=function(field,value){var t=mstrGraphFormatUtil.getMappedAttrType(field);if(!t){return value;}if(t=="text"){var f=field.charAt(4);if(f=="B"){if(field.length>8){return(value<0)?value:(value&3);}else{return(value>=0)&&((value&1)==1);}}else{if(f=="I"){return(value>=0)&&((value&2)==2);}else{if(f=="U"){return(value>=0)&&((value&4)==4);}else{if(f=="S"){return(value>=0)&&((value&8)==8);}}}}}else{if(t=="Scale"){if(!value){return null;}value=value.split(",");if(field.indexOf("max")>-1){if(field.indexOf("CK")>-1){return(value[0]=="1"||value[0]=="3")?true:false;}else{return(value[0]=="1"||value[0]=="3")?value[1]:null;}}else{if(field.indexOf("CK")>-1){return(value[0]=="1"||value[0]=="2")?true:false;}else{return(value[0]=="1"||value[0]=="2")?value[2]:null;}}}else{if(t=="gridStepOn"){if(!value){return null;}value=value.split(",");if(field.indexOf("CK")>-1){return(value[0]=="1")?true:false;}else{return(value[0]=="1")?value[1]:null;}}else{if(t=="numberFormat"){if(value){value=value.split(",");}var fnPos={gfnCat:0,gfnDecimalPlaces:1,gfnFraction:1,gfnThousandSeparator:2,gfnCurrencyPosition:3,gfnNegativeNumbers:4,gfnCurrencySymbol:5,gfnFormat:6,gfnDate:6,gfnTime:6};var dVals={gfnCat:"-2",gfnDecimalPlaces:"2",gfnFraction:"1",gfnThousandSeparator:"0",gfnCurrencyPosition:"0",gfnNegativeNumbers:"0",gfnCurrencySymbol:"$",gfnFormat:"",gfnDate:"M/d",gfnTime:"h:mm"};var sv;if(field=="gfnDate"||field=="gfnTime"){var fmtMap={2:"gfnDate",3:"gfnTime"};if(field!=fmtMap[value[0]]){sv=dVals[field];}else{sv=value[fnPos[field]]?value[fnPos[field]]:dVals[field];}}else{if(field=="gfnFraction"&&value[0]!=5){sv=dVals[field];}else{if(field=="gfnDecimalPlaces"&&value[0]==5){sv=dVals[field];}else{sv=value[fnPos[field]]?value[fnPos[field]]:dVals[field];}}}if(field=="gfnThousandSeparator"){sv=(sv=="3")?true:false;}return sv;}}}}return value;};mstrGraphFormatUtil.getAxisName=function(fn){var s=fn.substr(fn.length-2);if(s.charAt(0)!="Y"){s=s.substr(1);}return s;};mstrGraphFormatUtil.isPieLbl=function(targetId){var index=targetId.indexOf("_");var goid=(index==-1)?targetId:targetId.substring(0,index);return(goid=="418"||goid=="338");};mstrGraphFormatUtil.isAxesLbl=function(targetId){if(!targetId){return false;}var index=targetId.indexOf("_");var goid=(index==-1)?targetId:targetId.substring(0,index);return(goid=="272"||goid=="290"||goid=="296"||goid=="302");};mstrGraphFormatUtil.buildNFStr=function(vs){var v="";if(vs&&vs.length>0){for(var i in vs){v+=vs[i]+",";}}return v.substr(0,v.length-1);};mstrGraphFormatUtil.prototype.getMajorType=function(){return this.gProps&&this.gProps.majorType;};mstrGraphFormatUtil.prototype.getMinorType=function(){return this.gProps&&this.gProps.minorType;};mstrGraphFormatUtil.prototype.getCategories=function(){return this.gProps&&this.gProps.maxCategories;};mstrGraphFormatUtil.prototype.getSeries=function(){return this.gProps&&this.gProps.maxSeries;};mstrGraphFormatUtil.prototype.isSeriesByColumns=function(){return this.gProps&&this.gProps.seriesByCol;};mstrGraphFormatUtil.prototype.isTotalsEnabled=function(){return this.gProps&&this.gProps.showSubtotals;};mstrGraphFormatUtil.prototype.findGraphProperty=function(goid,gaid){return this.findGraphProperty(goid,gaid,-1);};mstrGraphFormatUtil.prototype.findGraphProperty=function(goid,gaid,gsid){try{return this.gProps.gPropsSet[goid+"_"+gaid+"_"+gsid];}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getMajorTypes=function(availTypes){try{var ma=this.formatInfo.graph_major_types;var items=[];for(var i=0,len=ma.length;i<len;i++){if(parseInt(ma[i]["t"])&parseInt(availTypes)){items.push({dssid:ma[i]["t"],n:microstrategy.descriptors.getDescriptor(ma[i]["did"]),uniqueName:name,icon:"pkr"+ma[i]["t"]});}}return items;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getMinorTypes=function(major){try{var ma=this.formatInfo.graph_minor_types;var items=[];for(var i=0,len=ma.length;i<len;i++){var gmnt=ma[i];if(parseInt(gmnt.mjs,10)&major){items.push({dssid:gmnt.t,n:microstrategy.descriptors.getDescriptor(gmnt.did),uniqueName:name,icon:"graphpkr"+major+"_subtype graphpkr"+major+"_pkr"+gmnt.t});}}return items;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getGraphObjectsByName=function(objName,majorType,minorType){try{var graphObjects=this.formatInfo.graph_objects;var obj=graphObjects[objName];var mth="get"+((obj.seriesRelated)?"SeriesGraphObjects":"SingleGraphObject");if(this.hasMultipleShowTypes(majorType)&&(objName=="areaRiser"||objName=="barRiser"||objName=="line"||objName=="dataMarker")){return this.getMultiMajorSeriesGraphObjects(objName,majorType,minorType);}return this[mth](objName,majorType,minorType);}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getSingleGraphObject=function(objName,majorType,minorType){try{var graphObjects=this.formatInfo.graph_objects;var obj=graphObjects[objName];if(obj){return{dssid:obj.goid,n:microstrategy.descriptors.getDescriptor(obj.did),uniqueName:obj.n,goid:obj.goid,gsid:"-1"};}}catch(err){microstrategy.errors.log(err);}return null;};mstrGraphFormatUtil.prototype.getGraphObjectId=function(objName){try{var graphObjects=this.formatInfo.graph_objects;if(graphObjects[objName]){return parseInt(graphObjects[objName]["goid"]);}}catch(err){microstrategy.errors.log(err);}return null;};mstrGraphFormatUtil.prototype.isLineAvaliableForBubble=function(gsid){return(this.findGraphProperty("9999","98",gsid));};mstrGraphFormatUtil.prototype.getSeriesInfo=function(){return this.gProps&&this.gProps.seriesInfo;};mstrGraphFormatUtil.prototype.getSeriesGraphObjects=function(objName,majorType,minorType){try{var seriesInfo=this.gProps.seriesInfo;var graphObjects=this.formatInfo.graph_objects;var obj=graphObjects[objName];if(obj&&obj.seriesRelated){var seriesRelated=obj.seriesRelated.split(",");var begin=parseInt(seriesRelated[0]);if(begin<0){begin=seriesInfo.length+1+begin;}var end=parseInt(seriesRelated[1]);if(end<0){end=seriesInfo.length+1+end;}var items=[];for(var i=begin;i<end;i++){if(i>=seriesInfo.length){break;}var serName=(objName!="spDataValue"&&objName!="3DScatterDataValue")?" "+seriesInfo[i]["n"]:"";var gsid=seriesInfo[i]["dssid"];if(objName.indexOf("pareto")>=0){gsid=seriesInfo.length.toString();}majorType+="";minorType+="";if(objName=="bubbleLine"&&majorType=="1024"&&this.isLineAvaliableForBubble(gsid)=="false"){continue;}if(objName=="dataValue"){if(majorType=="33554432"&&(minorType=="1"||minorType=="2")){if(i>0){continue;}}else{if(majorType=="33554432"&&(minorType=="4"||minorType=="8")){if(i>1){continue;}}}}items.push({dssid:obj.goid+"_"+gsid,n:microstrategy.descriptors.getDescriptor(obj.did)+serName,uniqueName:objName,goid:obj.goid,gsid:gsid});}return items;}}catch(err){microstrategy.errors.log(err);}return null;};mstrGraphFormatUtil.prototype.isObjNameApplicable=function(objName,majorType,minorType,showType){var firstIx=-1,secondIx=-1;switch(objName){case"areaRiser":case"allAreaRisers":firstIx=0;break;case"barRiser":case"allBarRisers":firstIx=1;break;case"line":case"allDataLines":firstIx=2;break;case"dataMarker":case"allDataMarkers":firstIx=3;break;default:firstIx=-1;}majorType=majorType+"";switch(majorType){case"1":case"2":secondIx=0;break;case"4":case"8":secondIx=1;break;case"16":case"32":case"33554432":secondIx=2;break;case"16777216":if(minorType==1||minorType==8){secondIx=3;}else{if(minorType==2||minorType==16){secondIx=4;}else{if(minorType==4||minorType==32){secondIx=5;}}}break;default:secondIx=-1;}if(firstIx<0||secondIx<0){return false;}if(this.objMajorShowMap[firstIx][secondIx]==showType){return true;}else{return false;}};mstrGraphFormatUtil.prototype.getMultiMajorSeriesGraphObjects=function(objName,majorType,minorType){try{var seriesInfo=this.gProps.seriesInfo;var graphObjects=this.formatInfo.graph_objects;var obj=graphObjects[objName];if(obj&&obj.seriesRelated){var seriesRelated=obj.seriesRelated.split(",");var begin=parseInt(seriesRelated[0]);if(begin<0){begin=seriesInfo.length+1+begin;}var end=parseInt(seriesRelated[1]);if(end<0){end=seriesInfo.length+1+end;}var items=[];for(var i=begin;i<end;i++){if(i>=seriesInfo.length){break;}var serName=" "+seriesInfo[i]["n"];var gsid=seriesInfo[i]["dssid"];var showType=this.findGraphProperty("286","97",gsid);majorType=majorType+"";minorType=minorType+"";if(!this.isObjNameApplicable(objName,majorType,minorType,showType)){continue;}if(majorType=="33554432"&&(minorType=="1"||minorType=="2")){if(i==1){var serNameSpec=serName+" - "+seriesInfo[i-1]["n"];items.push({dssid:"28600_0",n:microstrategy.descriptors.getDescriptor(obj.did)+serNameSpec,uniqueName:objName,increDecreItem:true,goid:"28600",gsid:"0"});}}items.push({dssid:obj.goid+"_"+gsid,n:microstrategy.descriptors.getDescriptor(obj.did)+serName,uniqueName:objName,goid:obj.goid,gsid:gsid});}return items;}}catch(err){microstrategy.errors.log(err);}return null;};mstrGraphFormatUtil.prototype.getSubGraphObjectsForAllPlaceHolder=function(objName){try{var graphObjects=this.formatInfo.graph_objects;var obj=graphObjects[objName];var items=[];if(obj&&obj.relatedItems){var relatedItems=obj.relatedItems.split("|");for(var objName in relatedItems){var subItem=mstrGraphFormatUtil.getSingleGraphObject(objName);if(subItem){items.push(subItem);}}}return items;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.isTypeSupported=function(objName,majorType,minorType){try{var graphObjects=this.formatInfo.graph_objects;var obj=graphObjects[objName];var majorTypeNum=majorType;majorType=majorType+"";minorType=minorType+"";if(obj&&obj.incTps){if(obj.incTps[majorType]){var incTypes=obj.incTps[majorType];var minTypes=incTypes.mn.split(",");if(mstr.$A.find(minTypes,minorType)!=-1){return true;}}}if(this.hasMultipleShowTypes(majorTypeNum)&&obj&&obj.spTpMult){return((parseInt(obj.spTpMult)&majorType)>0);}if(obj&&obj.spTp){return((parseInt(obj.spTp)&majorType)>0);}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphFormatUtil.prototype.isPropSupported=function(targetId,attrName){try{attrName=mstrGraphFormatUtil.getMappedAttrName(attrName);var spCat=this.getSupportedCatById(targetId);var graphAttrs=this.formatInfo.graph_attributes;var attr=graphAttrs[attrName];if(spCat&&attr&&attr.catId){return !!(spCat&parseInt(attr.catId));}}catch(err){microstrategy.errors.log(err);}return false;};mstrGraphFormatUtil.prototype.isAxesSupported=function(attrName,majorType,minorType){try{attrName=mstrGraphFormatUtil.getMappedAttrName(attrName);var objName=null;if(attrName.substr(0,5)=="Scale"||attrName.substr(0,10)=="gridStepOn"){var s=mstrGraphFormatUtil.getAxisName(attrName);objName=s+"Axis";}return this.isTypeSupported(objName,majorType,minorType);}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphFormatUtil.prototype.isPercentGraph=function(maj,min){return(maj==1&&min==64)||(maj==2&&min==64)||(maj==4&&min==64)||(maj==8&&min==64)||(maj==16&&min==64)||(maj==32&&min==64)||(maj==2097152&&min==2);};mstrGraphFormatUtil.prototype.getSupportedCatById=function(targetId){try{var index=targetId.indexOf("_");var goid=(index==-1)?targetId:targetId.substring(0,index);var graphObjects=this.formatInfo.graph_objects;for(var id in graphObjects){if(graphObjects[id]["goid"]==goid){return graphObjects[id]["spCat"];}}}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getGraphAttributeId=function(attrName){try{var graphAttrs=this.formatInfo.graph_attributes;return graphAttrs[attrName]&&graphAttrs[attrName]["gaid"];}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.isUseNullObjId=function(attrName){var graphAttrs=this.formatInfo.graph_attributes;return(graphAttrs[attrName]&&graphAttrs[attrName]["nullObj"]=="true");};mstrGraphFormatUtil.prototype.getGraphIdExpInfo=function(attrName,goid){try{goid=goid+"";var graphAttrs=this.formatInfo.graph_attributes;if(graphAttrs[attrName]&&graphAttrs[attrName]["expts"]&&graphAttrs[attrName]["expts"][goid]){var spCase=graphAttrs[attrName]["expts"][goid];return{goid:typeof (spCase.new_goid)!="undefined"?parseInt(spCase.new_goid):parseInt(goid),gaid:typeof (spCase.new_gaid)!="undefined"?parseInt(spCase.new_gaid):parseInt(graphAttrs[attrName]["gaid"])};}else{return null;}}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getDefaultValue=function(attrName){try{var graphAttrs=this.formatInfo.graph_attributes;if(graphAttrs[attrName]&&graphAttrs[attrName]["dv"]){return graphAttrs[attrName]["dv"];}}catch(err){microstrategy.errors.log(err);}return null;};mstrGraphFormatUtil.prototype.correctDataType=function(attrName,v){try{var graphAttrs=this.formatInfo.graph_attributes;if(graphAttrs[attrName]){switch(graphAttrs[attrName]["dt"]){case mstrGraphFormatUtil.TYPE_INTEGER:v=v+"";if(isNaN(v)){v=(v=="true")?1:0;}else{v=parseInt(v);}break;case mstrGraphFormatUtil.TYPE_FLOAT:v=parseFloat(v);break;case mstrGraphFormatUtil.TYPE_BOOLEAN:if(typeof (s)!="boolean"){v=(v=="true"||v=="1"||v=="-1");}break;default:}}return v;}catch(err){microstrategy.errors.log(err);return v;}};mstrGraphFormatUtil.prototype.getGraphPropertyValue=function(fieldName,targetId){try{switch(fieldName){case"maxCategories":return this.getCategories();break;case"maxSeries":return this.getSeries();break;case"seriesLayout":return this.isSeriesByColumns()?1:0;break;case"showSubtotals":return this.isTotalsEnabled();break;case"majorType":return this.getMajorType();break;case"minorType":return this.getMinorType();break;case"gaugeQBShow":var gId=this.getGraphIdInfo("gaugeQBShow",targetId);return this.findGraphProperty(gId.goid,gId.gaid,0)=="1"||this.findGraphProperty(gId.goid,gId.gaid,1)=="1"||this.findGraphProperty(gId.goid,gId.gaid,2)=="1"||this.findGraphProperty(gId.goid,gId.gaid,3)=="1"||this.findGraphProperty(gId.goid,gId.gaid,4)=="1";case"show":if(mstrGraphFormatUtil.isAxesLbl(targetId)){var gId=this.getGraphIdInfo(fieldName,targetId);return(this.findGraphProperty(gId.goid,gId.gaid,gId.gsid)&2)>0;}}var v=null;var attrName=mstrGraphFormatUtil.getMappedAttrName(fieldName);var gId=this.getGraphIdInfo(attrName,targetId);if(gId){if(this.isAllTarget(targetId)){v=this.getGraphPropertyValueForAllTarget(attrName,targetId);}else{v=this.findGraphProperty(gId.goid,gId.gaid,gId.gsid);}if(!v){v=this.getDefaultValue(attrName);}v=this.correctDataType(attrName,v);if(mstrGraphFormatUtil.isSubField(fieldName)){v=mstrGraphFormatUtil.getSubFieldValue(fieldName,v);}switch(fieldName){case"seriesLineThickness":case"markerBorderThickness":var rangeStart=[0,67,108,154,198,241,287,331,374,419,442,526];var rangeEnd=[66,107,153,197,240,286,330,374,418,441,504,600];for(var i=0;i<12;i++){if(v>=rangeStart[i]&&v<=rangeEnd[i]){v=i;break;}}break;case"fontColor":case"fillColor":case"lineColor":case"seriesLineColor":case"markerColor":case"markerBorderColor":case"increfillColor":case"decreFillColor":if(fieldName=="fillColor"||fieldName=="markerColor"||fieldName=="increfillColor"||fieldName=="decreFillColor"){var feId=this.getGraphIdInfo("fillEffect",targetId);if(this.findGraphProperty(feId.goid,feId.gaid,feId.gsid)==14){v=this.findGraphProperty(feId.goid,567,feId.gsid);}}if(fieldName!="fontColor"&&this.isTransparent(fieldName,targetId)){v="transparent";}var colorCheck=new RegExp("^([a-f]|[A-F]|\\d){6}$");if(colorCheck.test(v)){v="#"+v;}break;case"lineAlpha":if(this.isTransparent("lineColor",targetId)){v=0;}break;case"areaAlpha":if(this.isTransparent("fillColor",targetId)){v=0;}break;case"markerBorderAlpha":if(this.isTransparent("markerBorderColor",targetId)){v=0;}break;case"seriesLineAlphaText":var alphaValue=this.getGraphPropertyValue("lineAlpha",targetId);v=((1-v/255)*100).toFixed(0);break;case"markerAlphaText":var alphaValue=this.getGraphPropertyValue("areaAlpha",targetId);v=((1-v/255)*100).toFixed(0);break;case"markerBorderAlphaText":var alphaValue=this.getGraphPropertyValue("markerBorderAlpha",targetId);v=((1-v/255)*100).toFixed(0);break;case"markerShow":if(v&1){v=true;}else{v=false;}break;case"lineShow":if(v&2){v=true;}else{v=false;}break;case"show":if(!this.isAllTarget(targetId)&&mstrGraphFormatUtil.isPieLbl(targetId)){var ov=v;v=this.findGraphProperty(gId.goid,gId.gaid,gId.gsid);if(v){v=parseInt(v);var index=targetId.indexOf("_");var goid=(index==-1)?targetId:targetId.substring(0,index);if(goid=="418"){v=!!(v&1);}else{if(goid=="338"){v=!!(v&2);}}}else{v=ov;}}break;case"dualAxisAuto":v=v?"0":"1";break;case"maxScaleX":case"minScaleX":case"maxScaleY1":case"minScaleY1":case"maxScaleY2":case"minScaleY2":case"maxScaleZ":case"minScaleZ":case"gridIntervalX":case"gridIntervalY1":case"gridIntervalY2":case"gridIntervalZ":if(v){v=microstrategy.number.toLocaleString(v);}break;}}return v;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.isTransparent=function(fieldName,targetId){try{switch(fieldName){case"fillColor":case"markerColor":case"increfillColor":case"decreFillColor":fieldName="areaTransparent";break;case"lineColor":case"markerBorderColor":fieldName="lineTransparent";break;}var attrName=mstrGraphFormatUtil.getMappedAttrName(fieldName);var gId=this.getGraphIdInfo(attrName,targetId);var v=this.findGraphProperty(gId.goid,gId.gaid,gId.gsid);if(v&&v=="true"){return true;}else{if(fieldName=="lineTransparent"){gId=this.getGraphIdInfo("lineAlpha",targetId);v=this.findGraphProperty(gId.goid,gId.gaid,gId.gsid);if(v&&v=="0"){return true;}}gId=this.getGraphIdInfo("fontBoxStyle",targetId);v=this.findGraphProperty(gId.goid,gId.gaid,gId.gsid);return v=="0";}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphFormatUtil.prototype.getDefaultFieldValue=function(fieldName){try{var attrName=mstrGraphFormatUtil.getMappedAttrName(fieldName);var v=this.getDefaultValue(attrName);v=this.correctDataType(attrName,v);if(mstrGraphFormatUtil.isSubField(fieldName)){v=mstrGraphFormatUtil.getSubFieldValue(fieldName,v);}switch(fieldName){case"fontColor":case"fillColor":case"lineColor":case"seriesLineColor":case"markerColor":case"markerBorderColor":case"increfillColor":case"decreFillColor":var colorCheck=new RegExp("^([a-f]|[A-F]|\\d){6}$");if(colorCheck.test(v)){v="#"+v;}break;}return v;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getGraphPropertyValueForAllTarget=function(attrName,targetId){try{var subItems=this.getRelatedItems(targetId);var val=null;var checkVal=function(v,sv){if(sv==null){sv="";}if(v==null){v=sv;}else{v=(v===sv)?sv:"";}return v;};var checkFSVal=function(v,sv){if(sv==null){sv=0;}sv=parseInt(sv);if(v==null){v=sv;}else{v=v&sv;}return v;};var checkNFVal=function(v,sv){if(sv){if(v){var svs=sv.split(",");var vs=v.split(",");for(var i in vs){vs[i]=(vs[i]==svs[i])?vs[i]:"";}v=mstrGraphFormatUtil.buildNFStr(vs);}else{v=sv;}}else{v="";}return v;};if(subItems&&subItems.length>0){for(var i=0;i<subItems.length;i++){var item=subItems[i];if(this.isPropSupported(item.dssid,attrName)){var gId=this.getGraphIdInfo(attrName,item.goid+"_"+item.gsid);var subVal=this.findGraphProperty(gId.goid,gId.gaid,gId.gsid);if(attrName=="fontStyle"||(attrName=="show"&&mstrGraphFormatUtil.isPieLbl(targetId))){val=checkFSVal(val,subVal);}else{if(attrName=="numberFormat"){val=checkNFVal(val,subVal);}else{val=checkVal(val,subVal);}}}}if(attrName=="show"&&mstrGraphFormatUtil.isPieLbl(targetId)){val=parseInt(val);var index=targetId.indexOf("_");var goid=(index==-1)?targetId:targetId.substring(0,index);if(goid=="418"){val=!!(val&1);}else{if(goid=="338"){val=!!(val&2);}}}}else{var gId=this.getGraphIdInfo(attrName,targetId);val=this.findGraphProperty(gId.goid,gId.gaid,gId.gsid);}return val;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getGsidFromTargetId=function(targetId){var gsid=-1;if(targetId){var index=targetId.indexOf("_");if(index!=-1){goid=parseInt(targetId.substring(0,index),10);gsid=parseInt(targetId.substring(index+1,targetId.length),10);}}return gsid;};mstrGraphFormatUtil.prototype.getGraphIdInfo=function(attrName,targetId){try{if(!attrName||!targetId){return null;}var goid=9999;var gaid=this.getGraphAttributeId(attrName);var gsid=-1;var index=targetId.indexOf("_");if(index!=-1){goid=parseInt(targetId.substring(0,index),10);gsid=parseInt(targetId.substring(index+1,targetId.length),10);}else{var id=parseInt(targetId,10);if(!isNaN(id)){goid=id;if(this.isAllSeriesTarget(goid)){gsid=-3;}}}if(this.isUseNullObjId(attrName)){goid=9999;}var mapInfo=this.getGraphIdExpInfo(attrName,goid);if(gsid!=-1&&this.getGraphIdExpInfo(attrName,goid+"_x")){mapInfo=this.getGraphIdExpInfo(attrName,goid+"_x");}if(mapInfo){goid=mapInfo.goid;gaid=mapInfo.gaid;}if(attrName=="dataTextShow"){gsid=-1;}if(this.gProps&&this.gProps.majorType==mstrGraphFormatUtil.MAJOR_GRAPHTYPE_3DSCATTER&&attrName=="tooltipsShow"){gsid=-1;gaid=10041;}if(this.gProps&&this.gProps.majorType==mstrGraphFormatUtil.MAJOR_GRAPHTYPE_3DSCATTER&&attrName=="tooltipsEditor"){gsid=-1;gaid=10042;}if(goid&&gaid&&gsid!=null){return{goid:goid,gaid:gaid,gsid:gsid};}}catch(err){microstrategy.errors.log(err);}return null;};mstrGraphFormatUtil.prototype.isAllTarget=function(targetId){return(this.isAllTitleTarget(targetId)||this.isAllSeriesTarget(targetId));};mstrGraphFormatUtil.prototype.isAllTitleTarget=function(targetId){return(targetId=="10000"||targetId=="10001"||targetId=="10002");};mstrGraphFormatUtil.prototype.isAllSeriesTarget=function(targetId){return(targetId=="260"||targetId=="418"||targetId=="338"||targetId=="518"||targetId=="286");};mstrGraphFormatUtil.prototype.getRelatedItems=function(targetId,major,minor){try{var arr=[];switch(targetId){case"10000":arr=this.objNames[1].slice(1);arr=arr.concat(this.objNames[2].slice(1));arr=arr.concat(this.objNames[3].slice(1));arr=arr.concat(this.objNames[5].slice(2));arr=arr.concat(this.objNames[6].slice(1));break;case"10001":arr=this.objNames[2].slice(1);break;case"10002":arr=this.objNames[3].slice(1);break;case"286":arr=this.objNames[8].slice(1);break;case"260":case"418":arr=this.objNames[5].slice(2);break;case"338":arr=this.objNames[6].slice(1);break;}if(arr){major=(major)?major:this.getMajorType();minor=(minor)?minor:this.getMinorType();return this.getItems(arr,major,minor);}}catch(err){microstrategy.errors.log(err);}return null;};mstrGraphFormatUtil.prototype.getSubCatItems=function(mainIndex,majorType,minorType){try{return this.getItems(this.objNames[mainIndex],majorType,minorType);}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getNumCatItems=function(majorType,minorType){try{if((majorType&1048640)>0){var arr=this.objNames[5];}else{if((majorType&1152)>0){var arr=this.objNames[7];}else{var arr=this.objNames[5].concat(this.objNames[7]);}}return this.getItems(arr,majorType,minorType);}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.hasMultipleShowTypes=function(majorType){majorType=majorType+"";if(majorType!="1"&&majorType!="2"&&majorType!="4"&&majorType!="8"&&majorType!="16"&&majorType!="32"&&majorType!="16777216"&&majorType!="33554432"){return false;}var seriesInfo=this.gProps.seriesInfo;for(var i=0;i<seriesInfo.length;i++){var showType=this.findGraphProperty("286","97",seriesInfo[i].dssid);if(showType!=0){return true;}}return false;};mstrGraphFormatUtil.prototype.isSeriesTypeAreaInMulType=function(majorType,minorType,subGsid){if(!subGsid||subGsid<0){return false;}var showType=this.findGraphProperty("286","97",subGsid.toString());majorType=majorType+"";switch(majorType){case"1":case"2":case"4":case"8":if(showType==0||showType==2){return true;}else{return false;}case"16":case"32":if(showType==1||showType==2){return true;}else{return false;}case"16777216":if(minorType==1||minorType==8){return true;}else{if((minorType==2||minorType==4||minorType==16||minorType==32)){if(showType==0){return true;}else{return false;}}}default:return false;}};mstrGraphFormatUtil.prototype.getItems=function(names,majorType,minorType){try{var items=[];for(var i=0;i<names.length;i++){if(this.isTypeSupported(names[i],majorType,minorType)&&this.hasPrivilegeForItem(names[i])){var item=this.getGraphObjectsByName(names[i],majorType,minorType);if(mstr.$A.isArray(item)){if(names[i]=="3DRiser"&&this.shouldHideFirstSeries(majorType,minorType)){item=item.slice(1);}for(var j=0;j<item.length;j++){items.push(item[j]);}}else{if(item){items.push(item);}}}}return items;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getSubTargets=function(targetId,field,major,minor){try{if(!this.isAllTarget(targetId)){return null;}var subItems=this.getRelatedItems(targetId,major,minor);var attrName=mstrGraphFormatUtil.getMappedAttrName(field);var tIds=[];for(var i=0;i<subItems.length;i++){if(this.isPropSupported(subItems[i]["dssid"],attrName)){tIds.push(subItems[i]["dssid"]);}}return tIds;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.getMainItems=function(mj,mn,bGFE,bHasMetric){try{var items=[];items.push({dssid:1,n:mstrGridReport.desp("3899")});var isBudgetGraph=bHasMetric&&mj==33554432&&(bGFE||this.isSeriesValueAvailable(mj));var isLipstick=isBudgetGraph&&(mn==1||mn==2);if(this.target.isFeatureAvailable("grid-graph-formatting")){items.push({dssid:2,n:mstrGridReport.desp("3900")});if(isBudgetGraph){items.push({dssid:3,n:mstrGridReport.desp("3636")});}else{items.push({dssid:3,n:mstrGridReport.desp("3901")});}var markerItems=this.getItems(this.objNames[8].slice(1),mj,mn);if(bHasMetric&&markerItems&&markerItems.length>0){items.push({dssid:8,n:mstrGridReport.desp("9829")});}if(bHasMetric&&this.isSeriesShapeAvailable(mj,mn)){items.push({dssid:4,n:mstrGridReport.desp("9830")});}}var is3DSur=(mj==131072);if(bHasMetric&&!(mj==33554432&&(mn==1||mn==2))&&(bGFE||(!is3DSur&&this.isSeriesValueAvailable(mj)))){items.push({dssid:5,n:mstrGridReport.desp("6118")});}if(isLipstick){var si=this.getSeriesInfo();if(si.length>=2){items.push({dssid:9,n:mstrGridReport.desp("10624").replace("##",si[1].n).replace("#",si[0].n)});}}var isPieOrFunnel=(mj==64||mj==1048576);if(bHasMetric&&isPieOrFunnel&&(bGFE||(!is3DSur&&this.isSeriesLabelAvailable(mj)))){items.push({dssid:6,n:mstrGridReport.desp("3903")});}return items;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.prototype.hasPrivilegeForItem=function(name){try{var goid=this.getGraphObjectId(name);var hp=this.target.isFeatureAvailable("simple-graph-formatting")&&(goid=="9"||goid=="260"||goid=="418"||goid=="338"||goid=="518");return hp||this.target.isFeatureAvailable("grid-graph-formatting");}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphFormatUtil.prototype.isSeriesValueAvailable=function(mj){try{var targetId=(mj==64||mj==1048576)?"418":"260";return this.getGraphPropertyValue("show",targetId);}catch(err){microstrategy.errors.log(err);return true;}};mstrGraphFormatUtil.prototype.isSeriesLabelAvailable=function(mj){try{var targetId="338";return(mj==64||mj==1048576)&&this.getGraphPropertyValue("show",targetId);}catch(err){microstrategy.errors.log(err);return true;}};mstrGraphFormatUtil.prototype.isSeriesShapeAvailable=function(mj,mn){try{if(!this.gProps){return true;}var colMode=this.findGraphProperty(9999,549,-1);if(!colMode){return true;}if(mj==262144){return false;}if(mj==1024){var bubbleLineItems=this.getItems(["bubbleLine"],mj,mn);return(bubbleLineItems&&bubbleLineItems.length>0);}colMode=parseInt(colMode);return !(mj==131072&&colMode==4);}catch(err){microstrategy.errors.log(err);return true;}};mstrGraphFormatUtil.prototype.shouldHideFirstSeries=function(mj,mn){try{if(!this.gProps){return false;}var colMode=this.findGraphProperty(9999,549,-1);if(!colMode){return false;}colMode=parseInt(colMode);return(mj==32768&&colMode==1)||(mj==65536&&colMode==2)||(mj==131072&&(mn==1||(mn==2&&colMode==1)));}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphFormatUtil.prototype.getDualAxisOptions=function(){try{var dualAxisAuto=this.findGraphProperty(9999,10054,-1);dualAxisAuto=dualAxisAuto?dualAxisAuto:"true";var seriesInfo=this.gProps.seriesInfo;var y1Items=[];var y2Items=[];if(dualAxisAuto=="true"){for(var i in seriesInfo){if(i%2==0){y1Items.push({dssid:seriesInfo[i]["dssid"],n:seriesInfo[i]["n"]});}else{y2Items.push({dssid:seriesInfo[i]["dssid"],n:seriesInfo[i]["n"]});}}}else{for(var i in seriesInfo){var seriesOnY2=this.findGraphProperty(9999,140,i);if(seriesOnY2=="false"){y1Items.push({dssid:seriesInfo[i]["dssid"],n:seriesInfo[i]["n"]});}else{y2Items.push({dssid:seriesInfo[i]["dssid"],n:seriesInfo[i]["n"]});}}}return{y1Axis:y1Items,y2Axis:y2Items};}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphFormatUtil.createChangeObject=function(name,value,category){return{v:value,memo:{fieldName:name,cat:category||"default"}};};mstrGraphFormatUtil.addChangeObject=function(change,changes){if(!change){return changes;}changes=changes||{};changes[change.memo["cat"]+"|"+change.memo["fieldName"]]=change;return changes;};mstrGraphFormatUtil.prototype.submitChanges=function(changes,notsubmit,statesURL){var um=microstrategy.updateManager;var ac=this.getChangeActions(changes);if(ac.length>0){um.add(ac);if(statesURL){um.addURL(statesURL);}if(!notsubmit){microstrategy.graphPropertyCache[this.target.objId]=null;um.flushAndSubmitChanges();}}return true;};mstrGraphFormatUtil.prototype.getChangeActions=function(changes){var bp=this.target.beanPath;var um=microstrategy.updateManager;var ac=[];var all={};var that=this;var pfs=function(n){n="text"+n;var v=(changes[cat+"|"+n])?changes[cat+"|"+n]["v"]:that.getGraphPropertyValue(n,cat);changes[cat+"|"+n]=null;switch(n){case"textBoldItalic":v=v&3;break;case"textBold":v=v?1:0;break;case"textItalic":v=v?2:0;break;case"textUnderline":v=v?4:0;break;case"textStrikeout":v=v?8:0;break;}return v;};var pafs=function(n){n="text"+n;var nv=0;if(changes[cat+"|"+n]!=null){var v=changes[cat+"|"+n]["v"];switch(n){case"textBoldItalic":switch(v){case"0":nv=34;break;case"1":nv=33;break;case"2":nv=18;break;case"3":nv=17;break;}break;case"textBold":nv=v?1:2;break;case"textItalic":nv=v?16:32;break;case"textUnderline":nv=v?256:512;break;case"textStrikeout":nv=v?4096:8192;break;}}changes[cat+"|"+n]=null;return nv;};var ps=function(o,s){var c=o+(s?"_"+s:"");var n=c+"|"+fieldName;var v;if(s){v=(changes[n])?changes[n]["v"]:that.getGraphPropertyValue(fieldName,c);}else{if(changes[n]){v=changes[n]["v"];}else{var si=that.gProps.seriesInfo;for(var i in si){v=that.getGraphPropertyValue(fieldName,c+"_"+si[i]["dssid"]);if(v){break;}}}}changes[n]=null;switch(o){case"418":v=v?1:0;break;case"338":v=v?2:0;break;}return v;};for(var i in changes){var change=changes[i];if(!change){continue;}var fieldName=change.memo["fieldName"];var attrName=mstrGraphFormatUtil.getMappedAttrName(fieldName);var cat=change.memo["cat"];var fieldValue=change.v;var actionProcessed=false;var majorGraphType=this.getGraphPropertyValue("majorType",cat);var minorGraphType=this.getGraphPropertyValue("minorType",cat);switch(fieldName){case"seriesLineThickness":case"markerBorderThickness":var valueMap=[44,102,132,175,219,263,308,352,396,439,482,526];fieldValue=valueMap[fieldValue];break;case"seriesLineAlphaText":case"markerAlphaText":case"markerBorderAlphaText":actionProcessed=true;break;case"markerShow":var lineShow=this.getGraphPropertyValue("lineShow",cat);var markerShow=fieldValue;fieldValue=0;if(markerShow){fieldValue+=1;}if(lineShow){fieldValue+=2;}break;case"textBoldItalic":case"textUnderline":case"textStrikeout":if(this.isAllSeriesTarget(cat)){fieldValue=pafs("BoldItalic")+pafs("Underline")+pafs("Strikeout");}else{fieldValue=pfs("BoldItalic")+pfs("Underline")+pfs("Strikeout");}break;case"textBold":case"textItalic":if(this.isAllSeriesTarget(cat)){fieldValue=pafs("Bold")+pafs("Italic")+pafs("Underline")+pafs("Strikeout");}else{fieldValue=pfs("Bold")+pfs("Italic")+pfs("Underline")+pfs("Strikeout");}break;case"CMfillColor":case"CMfontColor":case"CMlineColor":case"fontColor":case"fillColor":case"lineColor":case"lineColor":case"markerColor":case"markerBorderColor":case"increfillColor":case"decreFillColor":var isCM=(fieldName.substr(0,2)=="CM");var alphaN={fontColor:"fontAlpha",fillColor:"areaAlpha",lineColor:"lineAlpha",markerColor:"areaAlpha",markerBorderColor:"markerBorderAlpha"}[attrName];var c=changes[cat+"|"+alphaN];var alphaV=(c&&c.v)||(isCM?255:this.getGraphPropertyValue(alphaN,cat));if((attrName=="fillColor"||attrName=="markerColor"||attrName=="increfillColor"||attrName=="decreFillColor")&&fieldValue.split(",").length>1){attrName="gradientColor";alphaV=255;}else{if(fieldValue=="transparent"||fieldValue==""){alphaV=0;actionProcessed=true;}else{if(fieldValue.replace){fieldValue=fieldValue.replace("#","");}}}if(!isCM&&!c&&this.isTransparent(attrName,cat)){if(fieldValue!="transparent"&&fieldValue!=""){alphaV=255;}}var gId=this.getGraphIdInfo(alphaN,cat);if(gId&&gId.goid==28600){gId.goid=286;}if(gId){ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_GRAPH_PROPS,bp,["4085","4202","4209","4203"],[gId.goid,gId.gaid,gId.gsid,alphaV],[],[]));if(c){changes[cat+"|"+alphaN]=null;}}break;case"show":if(mstrGraphFormatUtil.isPieLbl(cat)){var index=cat.indexOf("_");var goid=(index==-1)?cat:cat.substring(0,index);var gsid=(index==-1)?"":cat.substring(index+1,cat.length);var rgoid=(goid=="418")?"338":"418";fieldValue=ps(goid,gsid)+ps(rgoid,gsid);var gId=this.getGraphIdInfo(attrName,cat);if(gId){ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_GRAPH_PROPS,bp,["4085","4202","4209","4203"],[gId.goid,gId.gaid,gId.gsid,fieldValue],[],[]));}actionProcessed=true;}if(mstrGraphFormatUtil.isAxesLbl(cat)){var gId=this.getGraphIdInfo(attrName,cat);var axesShow=this.findGraphProperty(gId.goid,gId.gaid,gId.gsid);fieldValue=fieldValue?(axesShow|2):(axesShow&29);var gId=this.getGraphIdInfo(attrName,cat);if(gId){ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_GRAPH_PROPS,bp,["4085","4202","4209","4203"],[gId.goid,gId.gaid,gId.gsid,fieldValue],[],[]));}actionProcessed=true;}break;case"maxScaleX":case"minScaleX":case"maxScaleY1":case"minScaleY1":case"maxScaleY2":case"minScaleY2":case"maxScaleZ":case"minScaleZ":case"maxScaleCKX":case"minScaleCKX":case"maxScaleCKY1":case"minScaleCKY1":case"maxScaleCKY2":case"minScaleCKY2":case"maxScaleCKZ":case"minScaleCKZ":var s=mstrGraphFormatUtil.getAxisName(fieldName);var ul=microstrategy.number.toString;var mxCK=changes[cat+"|maxScaleCK"+s];var mnCK=changes[cat+"|minScaleCK"+s];var mx=changes[cat+"|maxScale"+s];var mn=changes[cat+"|minScale"+s];if(mx&&mx.v){mx.v=ul(mx.v);}if(mn&&mn.v){mn.v=ul(mn.v);}var oriMn=this.getGraphPropertyValue("minScale"+s,cat);var oriMx=this.getGraphPropertyValue("maxScale"+s,cat);oriMn=oriMn?ul(oriMn):oriMn;oriMx=oriMx?ul(oriMx):oriMx;if(mxCK&&mxCK.v&&!(mx&&mx.v)){mxCK.v=false;}if(mnCK&&mnCK.v&&!(mn&&mn.v)){mnCK.v=false;}if(mx&&(mx.v=="")&&!mxCK){mxCK={};mxCK.v=false;}if(mn&&(mn.v=="")&&!mnCK){mnCK={};mnCK.v=false;}if(mxCK&&mxCK.v&&mnCK&&mnCK.v){fieldValue="1,"+mx.v+","+mn.v;}else{if(mxCK&&!mxCK.v&&mnCK&&!mnCK.v){if(oriMn||oriMx){fieldValue="0,0,0";}else{actionProcessed=true;}}else{if(mnCK&&mnCK.v){if(!mxCK&&oriMx){fieldValue="1,"+oriMx+","+mn.v;}else{fieldValue="2,0,"+mn.v;}}else{if(mxCK&&mxCK.v){if(!mnCK&&oriMn){fieldValue="1,"+mx.v+","+oriMn;}else{fieldValue="3,"+mx.v+",0";}}else{if(mnCK&&!mnCK.v){if(!oriMn){actionProcessed=true;}fieldValue=oriMx?"3,"+oriMx+",0":"0,0,0";}else{if(mxCK&&!mxCK.v){if(!oriMx){actionProcessed=true;}fieldValue=oriMn?"2,0,"+oriMn:"0,0,0";}}}}}}changes[cat+"|maxScale"+s]=null;changes[cat+"|minScale"+s]=null;changes[cat+"|maxScaleCK"+s]=null;changes[cat+"|minScaleCK"+s]=null;break;case"gridIntervalX":case"gridIntervalY1":case"gridIntervalY2":case"gridIntervalZ":case"gridIntervalCKX":case"gridIntervalCKY1":case"gridIntervalCKY2":case"gridIntervalCKZ":var ul=microstrategy.number.toString;var s=mstrGraphFormatUtil.getAxisName(fieldName);var giCK=changes[cat+"|gridIntervalCK"+s];var gi=changes[cat+"|gridInterval"+s];var oriGi=this.getGraphPropertyValue("gridInterval"+s,cat);if(giCK&&giCK.v&&!(gi&&gi.v)){giCK.v=false;}if(gi&&(gi.v=="")&&!giCK){giCK={};giCK.v=false;}if(giCK&&!giCK.v&&!oriGi){actionProcessed=true;}fieldValue=(giCK&&giCK.v)?"1,"+ul(gi.v):"0,0";changes[cat+"|gridIntervalCK"+s]=null;changes[cat+"|gridInterval"+s]=null;break;case"dualAxisAuto":fieldValue=(fieldValue=="0"||fieldValue==0)?true:false;break;case"dualOptionItems":fieldValue=fieldValue.split(CLIPBOARD_ITEM_SEPARATOR);var gId=this.getGraphIdInfo(attrName,cat);var seriesInfo=this.gProps.seriesInfo;for(var j in seriesInfo){var sid=seriesInfo[j]["dssid"];if(mstr.$A.find(fieldValue,sid)!=-1){ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_GRAPH_PROPS,bp,["4085","4202","4209","4203"],[gId.goid,gId.gaid,sid,true],[],[]));}else{ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_GRAPH_PROPS,bp,["4085","4202","4209","4203"],[gId.goid,gId.gaid,sid,false],[],[]));}}actionProcessed=true;break;case"maxCategories":case"maxSeries":var id={maxCategories:4025,maxSeries:4024}[fieldName];ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_GRAPH_WINDOW_SIZE,bp,[id,"4227"],[fieldValue,this.target.seriesLayout],[],[]));actionProcessed=true;break;break;case"gfnCat":case"gfnTime":case"gfnFraction":case"gfnDate":case"gfnDecimalPlaces":case"gfnCurrencySymbol":case"gfnCurrencyPosition":case"gfnNegativeNumbers":case"gfnThousandSeparator":case"gfnFormat":var fnPos=["gfnCat","gfnDecimalPlaces","gfnThousandSeparator","gfnCurrencyPosition","gfnNegativeNumbers","gfnCurrencySymbol","gfnDate","gfnTime","gfnFraction"];var va=["","","","","","",""];for(var ix=0;ix<6;ix++){var c=changes[cat+"|"+fnPos[ix]];var af=null;if(this.isAllSeriesTarget(cat)){all[cat+"|"+fnPos[ix]]=c;}else{af=cat.substring(0,cat.indexOf("_"))+"|"+fnPos[ix];}var v=(c)?c.v:((af&&all[af])?all[af]["v"]:this.getGraphPropertyValue(fnPos[ix],cat));if(fnPos[ix]=="gfnThousandSeparator"){v=v?"3":"0";}va[ix]=v;if(c){changes[cat+"|"+fnPos[ix]]=null;}}var nc=va[0];if(nc=="2"||nc=="3"){var fmtMap={2:"gfnDate",3:"gfnTime"};var c=changes[cat+"|"+fmtMap[nc]];va[6]=(c)?c.v:this.getGraphPropertyValue(fmtMap[nc],cat);if(changes[cat+"|gfnDate"]){changes[cat+"|gfnDate"]=null;}if(changes[cat+"|gfnTime"]){changes[cat+"|gfnTime"]=null;}}else{if(nc=="5"){var c=changes[cat+"|gfnFraction"];va[1]=(c)?c.v:this.getGraphPropertyValue("gfnFraction",cat);if(changes[cat+"|gfnFraction"]){changes[cat+"|gfnFraction"]=null;}}}if(!va[6]){va[6]="";}fieldValue=mstrGraphFormatUtil.buildNFStr(va);break;case"minorType":ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_GRAPH_PROPS,bp,["4082","4083"],[this.target.GFEMajor?this.target.GFEMajor:this.target.major,fieldValue],[],[]));actionProcessed=true;break;case"majorType":case"minorType":case"enableTotals":case"width":case"height":case"seriesLayout":case"showSubtotals":var id={majorType:4082,showSubtotals:4176,width:4081,height:4080,seriesLayout:4175}[fieldName];var v=fieldValue;if(fieldName=="showSubtotals"){v=(v)?1:0;}var argN=[id],argV=[v];if(fieldName=="seriesLayout"&&v==this.target.seriesLayout){argN.push(4228);argV.push("0");}ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_GRAPH_PROPS,bp,argN,argV,[],[]));actionProcessed=true;break;}if(actionProcessed){continue;}fieldValue=this.correctDataType(attrName,fieldValue);if(attrName=="fontSize"){fieldValue+=","+this.target.graphWidth+","+this.target.graphHeight;}var gId=this.getGraphIdInfo(attrName,cat);if(gId&&gId.goid==28600){gId.goid=286;}var isSplitItems=change.isSplitItems;if(this.hasMultipleShowTypes(majorGraphType)&&isSplitItems){if(gId){var items=null;if(cat=="286"){items=this.getRelatedItems(cat,majorGraphType,minorGraphType);}if(items){for(var ix in items){ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_GRAPH_PROPS,bp,["4085","4202","4209","4203"],[gId.goid,gId.gaid,items[ix]["gsid"],fieldValue],[],[]));}}}}else{if(gId){ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_GRAPH_PROPS,bp,["4085","4202","4209","4203"],[gId.goid,gId.gaid,gId.gsid,fieldValue],[],[]));}}}return ac;};
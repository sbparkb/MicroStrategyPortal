mstrFilterObjectsImplScript=true;mstrFilterObjectsImpl.prototype=new mstrReportAllObjectsImpl();mstrFilterObjectsImpl.prototype.superClass=mstrReportAllObjectsImpl.prototype;mstrFilterObjectsImpl.prototype.files=null;mstrFilterObjectsImpl.MIN_HEIGHT=100;mstrFilterObjectsImpl.prototype.onload=function(e){try{mstrReportAllObjectsImpl.prototype.onload.call(this,e);if(!(this.body)){microstrategy.unRegisterBone(this.id);return ;}microstrategy.DISPLAY_MODE=microstrategy.DESIGN_MODE;this.isTargetingFilter=true;this.maskArea=this.body.firstChild;this.mask.onload(this);this.selections=new mstrFilterObjSelectionsImpl();this.selections.parentBone=this;this.selections.path="microstrategy.bone('"+this.id+"').selections";this.files=microstrategy.subObjectFind(this.elem,"div",microstrategy.SUBOBJTYPE_FILE_LIST);if(this.files){this.files.onmousedown=new Function("e","return microstrategy.bone('"+this.id+"').onmousedown(e);");this.files.ondblclick=new Function("e","return microstrategy.bone('"+this.id+"').ondblclick(e);");}}catch(err){microstrategy.errors.log(err);return false;}};mstrFilterObjectsImpl.prototype.onpostload=function(){try{this.ondialogresize();this.initResize();}catch(err){microstrategy.errors.log(err);}};mstrFilterObjectsImpl.prototype.onwinresize=function(){try{window.setTimeout("microstrategy.bone('"+this.id+"').ondialogresize()",0);}catch(err){microstrategy.errors.log(err);}};mstrFilterObjectsImpl.prototype.ondialogresize=function(){try{this.resizeContents();this.moveResizeHandles();window.setTimeout("microstrategy.bone('fexb_pane').ondialogresize()",0);window.setTimeout("microstrategy.bone('"+this.id+"').forcerepaint()",0);}catch(err){microstrategy.errors.log(err);}};mstrFilterObjectsImpl.prototype.forcerepaint=function(){try{var i=document.createElement("img");document.body.appendChild(i);i.parentNode.removeChild(i);}catch(err){microstrategy.errors.log(err);}};mstrFilterObjectsImpl.prototype.onmousedown=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);if(obj){if(obj.tagName.toLowerCase()=="li"){obj=obj.firstChild;}if(obj.tagName.toLowerCase()=="span"&&obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)){if(this.selections){var selections=this.selections;selections.clear();selections.add(obj);if(selections.onmousedown){return selections.onmousedown(e);}}}else{if(obj.tagName.toLowerCase()=="a"){if(this.treeView){obj=obj.parentNode;if(obj.tagName.toLowerCase()=="span"&&obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)&&obj.getAttribute("id")){if(this.selections){var selections=this.selections;selections.clear();selections.add(obj);if(selections.onmousedown){return selections.onmousedown(e);}}}}else{if(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)=="hi"){mstrReportAllObjectsImpl.prototype.onmousedown.call(this,e);}else{obj.setAttribute("cx","");}if(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_FOLDER){this.openFolder(obj.getAttribute(microstrategy.HTMLATTR_DSS_ID));}}}else{if(obj.tagName.toLowerCase()=="span"){var itemLI=microstrategy.findParentWithTag(obj,"li");if(itemLI){var objType=itemLI.firstChild.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(objType=="hi"||objType=="a"||objType=="e"){mstrReportAllObjectsImpl.prototype.updateSelections.call(this,e,itemLI.firstChild);}}}else{if(this.selections){this.selections.clear();}}}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrFilterObjectsImpl.prototype.ondblclick=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);if(obj){if(obj.tagName.toLowerCase()=="img"||obj.tagName.toLowerCase()=="a"){obj=obj.parentNode;}if(obj.tagName.toLowerCase()!="span"){return ;}var type=obj.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(type==microstrategy.DSSTYPE_HIERARCHY){return false;}var singleSelection=this.selections.getItems().length;var aclCheck=microstrategy.checkACL(obj,[microstrategy.ACL_EXECUTE,microstrategy.ACL_USE]);if(!singleSelection||aclCheck){this.selections.processContextMenu("af");}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrFilterObjectsImpl.prototype.resizeContents=function(){try{if(!isInDocument(this.elem)){return false;}var FILES_MARGIN_X=9;var FILES_MARGIN_BOTTOM=15;var hPanel=Math.max(mstr.utils.BoxModel.getBrowserWindowHeight(document)-getObjSumTop(this.elem)-getFooterHeight(),mstrFilterObjectsImpl.MIN_HEIGHT);if(hPanel>0){this.elem.style.height=hPanel+"px";var b=microstrategy.bone("fexb_pane");if(b&&b.elem){b.elem.style.height=hPanel+"px";}}var wPanel=getObjOuterWidth(this.elem);if(wPanel>0){this.elem.parentNode.style.width=wPanel+"px";this.elem.parentNode.parentNode.style.width=wPanel+"px";}if(this.files&&this.files.style&&(isInDocument(this.files))){var hFiles=(hPanel-this.files.parentNode.offsetTop-FILES_MARGIN_BOTTOM);var wFiles=wPanel-FILES_MARGIN_X*2;var elCount=microstrategy.findChildWithAtt(this.elem,"table","id",this.id+"_oCount");if(elCount){hFiles-=getObjOuterHeight(elCount);}var elIncFetch=microstrategy.findChildWithAtt(this.elem,"div","ty","if");if(elIncFetch){hFiles-=mstr.utils.BoxModel.getElementOuterHeight(elIncFetch);}if((hFiles>0)){this.files.childNodes[0].style.height=hFiles+"px";}if(wFiles>0){this.files.childNodes[0].style.width=wFiles+"px";}}var newWidth=0;if(this.searchBox&&this.search){newWidth=wFiles-getObjWidth(this.search)-getObjWidth(document.getElementById("name_label"));if(newWidth>0){this.searchBox.style.width=newWidth+"px";}}if(this.folderBox){newWidth=wFiles-getObjWidth(this.upFolder)-getObjWidth(this.displayFormatIcon);if(newWidth>0){this.folderBox.style.width=newWidth+"px";}}}catch(err){microstrategy.errors.log(err);}};function mstrFilterObjectsImpl(id){this.inherits=mstrObjectBrowserImpl;this.inherits(id);delete this.inherits;return this;}mstrFilterObjSelectionsImplScript=true;mstrFilterObjSelectionsImpl.prototype=new mstrObjSelectionsImpl();mstrFilterObjSelectionsImpl.prototype.onmousedown=function(e){try{var mstrSrc=microstrategy.eventManager.getSource(e);if(microstrategy.checkACL(this.clickedSrc,[microstrategy.ACL_EXECUTE,microstrategy.ACL_USE])){mstrSelectionsImpl.prototype.onmousedown.call(this,e);var verifiedPath=microstrategy.getEventHandlerString(this.path);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","ondragstart");this.parentBone.attachWinListener(this,"mouseup","onmouseup",false);}else{document.onmousemove=new Function("e",verifiedPath+" { return "+this.path+".ondragstart(e); }");if(document.onmouseup==null){document.onmouseup=new Function("e",verifiedPath+" { return "+this.path+".onmouseup(e); }");}}}return false;}catch(err){microstrategy.errors.log(err);}return false;};mstrFilterObjSelectionsImpl.prototype.ondocumentclick=function(e){try{if(!this.isActive()){return ;}if(!e){e=window.event;}var obj=microstrategy.findAncestor(getEventTarget(e));if(obj==null){this.clear();return ;}var objType=obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(objType==microstrategy.OBJTYPE_CONTEXT_MENU||objType==microstrategy.OBJTYPE_MESSAGE_BOX){return ;}var bone=findTarget(obj,microstrategy.HTMLATTR_SCRIPTCLASS);if(bone==null||(bone.getAttribute("id")!=this.parentBone.id&&!this.parentBone.canToggleDisplay)){this.clear();}}catch(err){microstrategy.errors.log(err);}};mstrFilterObjSelectionsImpl.prototype.ondrag=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);if(!this.dragDisplay){var span=document.createElement("span");span.className="mstrDnDReportDragItem";span.appendChild(document.createTextNode(""));this.dragDisplay=document.body.appendChild(span);}var desc=(this.length>1)?microstrategy.descriptors.getDescriptor("3625"):this.firstItem().getAttribute("ds");this.dragDisplay.replaceChild(document.createTextNode(desc),this.dragDisplay.firstChild);moveObjTo(this.dragDisplay,lMouseX-getObjWidth(this.dragDisplay)-microstrategy.CURSOR_OFFSET,lMouseY-getObjHeight(this.dragDisplay)-microstrategy.CURSOR_OFFSET);this.parentBone.dndHelper.moveHelperImage(e);}catch(err){microstrategy.errors.log(err);}return false;};mstrFilterObjSelectionsImpl.prototype.ondragend=function(e){try{if(!e){e=window.event;}this.parentBone.dndHelper.parkObject(this.dragDisplay);microstrategy.eventManager.notifyOrphanBones("onnotifydragend");this.onmouseup(e);var src=microstrategy.findAncestor(getEventTarget(e));if(src){var bone=microstrategy.boneForMask(src);if(bone&&bone.ondrop){bone.ondrop(src,this);}}}catch(err){microstrategy.errors.log(err);}return false;};mstrFilterObjSelectionsImpl.prototype.getReportFilterBone=function(bTestLimit,bTestPrompt){try{var bone=microstrategy.bone("rfe_pane");if(!bone&&bTestLimit){bone=microstrategy.bone("rle_pane");}if(!bone&&bTestPrompt){bone=microstrategy.bone("fexb_pane");}return bone;}catch(err){microstrategy.errors.log(err);return null;}};mstrFilterObjSelectionsImpl.prototype.checkShowContextMenuOption=function(cmdId){try{var item=this.firstItem();if(item){var type=item.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);switch(cmdId){case"af":if(type==microstrategy.DSSTYPE_HIERARCHY){return false;}if(type==microstrategy.DSSTYPE_PROMPT){var subtype=item.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);if(subtype==microstrategy.DSSSUB_TYPE_PROMPT_DIMPTY||subtype==microstrategy.DSSSUB_TYPE_PROMPT){return false;}}if(!microstrategy.checkACL(this.firstItem(),[microstrategy.ACL_EXECUTE,microstrategy.ACL_USE])){return false;}if(this.getReportFilterBone(true,true)==null){return false;}return this.getReportFilterBone(true,true).isAddable(item,this.parentBone);break;case"aup":if(type==microstrategy.DSSTYPE_METRIC||type==microstrategy.DSSTYPE_RPT_DEFINITION||type==microstrategy.DSSTYPE_FILTER||type==microstrategy.DSSTYPE_DIMENSION){return microstrategy.checkACL(item,[microstrategy.ACL_EXECUTE,microstrategy.ACL_USE]);}else{return false;}break;case"aelp":case"aaqp":if(type==microstrategy.DSSTYPE_ATTRIBUTE){return microstrategy.checkACL(item,[microstrategy.ACL_EXECUTE,microstrategy.ACL_USE]);}else{return false;}break;}}else{return false;}return true;}catch(err){microstrategy.errors.log(err);return null;}};mstrFilterObjSelectionsImpl.prototype.checkEnableContextMenuOption=function(cmdId){try{switch(cmdId){case"af":if(!this.isMulti()){return true;}else{if(this.items){for(member in this.items){var item=this.items[member];if(item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_ELEMENT){return false;}}return true;}}break;}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrFilterObjSelectionsImpl.prototype.processContextMenu=function(cmdId,cmdVal){try{switch(cmdId){case"af":var ac=new Array();var um=microstrategy.updateManager;var bone=microstrategy.bone("fexb_pane");if(!bone){break;}var item=this.firstItem();if(!item){break;}if(item&&item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_ELEMENT){var att=item.getAttribute(microstrategy.HTMLATTR_PARENT_ID);if(att){ac=bone.addElements(att,this.getItems(),ac);}}else{if(!bone.isAddable||bone.isAddable(item,this.parentBone)){ac=bone.addUnit(item,ac);}}if(ac.length){um.add(ac);um.flushAndSubmitChanges();}break;case"aup":this.addObjectAsPrompt("");break;case"aelp":this.addObjectAsPrompt("el");break;case"aaqp":this.addObjectAsPrompt("aq");break;}}catch(err){microstrategy.errors.log(err);return null;}};mstrFilterObjSelectionsImpl.prototype.addObjectAsPrompt=function(modifier){try{if(this.isMulti()){return ;}var ac=new Array();var um=microstrategy.updateManager;var bone=microstrategy.bone("fexb_pane");if(!bone){return ;}var item=this.firstItem();if(!item){return ;}ac=bone.addUnitAsPrompt(item,ac,modifier,false);um.add(ac);um.flushAndSubmitChanges();}catch(err){microstrategy.errors.log(err);return null;}};mstrFilterObjSelectionsImpl.prototype.getParent=function(obj){try{var parentUL=findTargetTag(obj,"UL");if(parentUL){var parentLI=findTargetTag(parentUL,"LI");if(parentLI){if(parentLI.getElementsByTagName("a")[0]){return parentLI.getElementsByTagName("a")[0];}}}return null;}catch(err){microstrategy.errors.log(err);return null;}};function mstrFilterObjSelectionsImpl(){this.inherits=mstrObjSelectionsImpl;this.inherits();delete this.inherits;return this;}
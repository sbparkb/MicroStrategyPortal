mstrSerializer.prototype=new Object;mstrSerializer.prototype.buffer="";mstrSerializer.prototype.needDelim=false;mstrSerializer.CH_ESCAPE="*";mstrSerializer.CH_DELIM=".";mstrSerializer.CH_BRA="-";mstrSerializer.CH_KET="_";mstrSerializer.CH_LESS="<";mstrSerializer.STR_NULL="*0";mstrSerializer.prototype.getState=function(){try{return this.buffer;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addStr=function(B){try{if(this.needDelim){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(B);this.needDelim=true;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addInt=function(B){try{this.addStr(B+"");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addBoolean=function(B){try{this.addStr(B?"1":"0");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addValues=function(A){try{this.buffer+=mstrSerializer.CH_BRA;for(var B=0;B<A.length;B++){if(B>0){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(A[B]);}this.buffer+=mstrSerializer.CH_KET;this.needDelim=false;}catch(C){microstrategy.errors.log(C);return false;}};mstrSerializer.prototype.appendValue=function(C){try{var A=new RegExp("[\\"+mstrSerializer.CH_ESCAPE+"\\"+mstrSerializer.CH_BRA+"\\"+mstrSerializer.CH_KET+"\\"+mstrSerializer.CH_DELIM+"\\"+mstrSerializer.CH_LESS+"]","g");var D=mstrSerializer.CH_ESCAPE+"$&";C=String(C).replace(A,D);this.buffer+=C;}catch(B){microstrategy.errors.log(B);return false;}};function mstrSerializer(){return this;}mstrFolderActionsScript=true;mstrFolderActions=new Object();mstrFolderActions.checkACL=function(C,F,H,A,B){try{var G=false;if(C&&C.getAttribute("ty")=="sub"){iframe.showWaitPage();mstr.$XHR.request(mstrApp.taskURL||mstrConfig.taskURL,{taskId:"getSubscriptionAssociatedInformation",loadInfo:"checkACL",objectID:H,objectType:A},{success:function(I){G=I.user.allow;}},false);iframe.hideWaitPage();}if(!G){var E=microstrategy.descriptors.getDescriptor("9181");showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});F=F||window.event;stopEventBubbling(F);cancelEvent(F);}return G;}catch(D){microstrategy.errors.log(D);}};mstrFolderActions.submitShowBeanEvent=function(D,A,B){try{var E="&actionType="+D+"&objectId="+A+"&objectType="+B;microstrategy.updateManager.useIframe=true;toggleShowBean("OMD",true,E);}catch(C){microstrategy.errors.log(C);return false;}};mstrFolderActions.actionConfirmDelete=function(A,B,G,C,D){try{var F=D?microstrategy.descriptors.getDescriptor("3833"):microstrategy.descriptors.getDescriptor("3829");F=F.replace("##",G);showMessage({contents:F,elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:'mstrFolderActions.actionNewMenuItemClick("delete", "'+A+'", ["'+B+'", "'+C+'"])',type:mstrMsgBoxImpl.MSG_WARNING});}catch(E){microstrategy.errors.log(E);return false;}};mstrFolderActions.actionNewMenuItemClick=function(E,A,C){try{var D=microstrategy.updateManager;var B=new Array();switch(E){case"newFilter":B.push(D.createActionObject(null,mstrUpdateManager.CREATE_NEW_FILTER,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CREATE_NEW_FILTER].paramID,["",true,A]));break;case"newPrompt":if(C.length==2){B.push(D.createActionObject(null,mstrUpdateManager.CREATE_NEW_PROMPT,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CREATE_NEW_PROMPT].paramID,[C[0],A,C[1]]));}else{if(C.length==1){B.push(D.createActionObject(null,mstrUpdateManager.CREATE_NEW_PROMPT,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CREATE_NEW_PROMPT].paramID,[C[0],A]));}}break;case"createDocument":B.push(D.createActionObject(null,mstrUpdateManager.CONVERT_TO_DOCUMENT,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CONVERT_TO_DOCUMENT].paramID,[A,"",1,2,microstrategy.DSSTYPE_RPT_DEFINITION]));break;case"delete":B.push(D.createActionObject(null,mstrUpdateManager.DELETE_OBJECT,C[1],mstrUpdateManager.actions[mstrUpdateManager.DELETE_OBJECT].paramID,[A,parseInt(C[0])]));break;case"newDocument":B.push(D.createActionObject(null,mstrUpdateManager.CREATE_NEW_DOCUMENT,microstrategy.servletName,["3185"],[A]));break;case"newReport":B.push(D.createActionObject(null,mstrUpdateManager.REPORT_NEW,microstrategy.servletName,["3185"],[A]));break;}D.add(B);D.useIframe=false;D.flushAndSubmitChanges();}catch(F){microstrategy.errors.log(F);return false;}};mstrContextMenuImpl.prototype=new Object();contextMenuScript=true;mstrContextMenuImpl.prototype.cmm_id=null;mstrContextMenuImpl.prototype.cmm_items=null;mstrContextMenuImpl.prototype.menu_items=null;mstrContextMenuImpl.prototype.length=0;mstrContextMenuImpl.IMG_EMPTY=0;mstrContextMenuImpl.IMG_CHECK=1;mstrContextMenuImpl.IMG_REMOVE=2;mstrContextMenuImpl.IMG_SUBTOTAL=3;mstrContextMenuImpl.IMG_DRILL_UP=4;mstrContextMenuImpl.IMG_DRILL_DOWN=5;mstrContextMenuImpl.IMG_DRILL_TEMPLATE=6;mstrContextMenuImpl.IMG_DRILL=7;mstrContextMenuImpl.IMG_LOADING=8;mstrContextMenuImpl.prototype.addItem=function(B,C,E,A,G){try{var F;if(!E){E=1;}if(!A){A=1;}if(!G){G=mstrContextMenuImpl.IMG_EMPTY;}if(typeof (C)=="string"){F=new Array(B,C,G,0,"","",A,E);}else{F=new Array(B,"",G,1,"["+C.menu_items.toString()+"]","",A,E);}return this.addItemDefinition(F);}catch(D){microstrategy.errors.log(D);return false;}};mstrContextMenuImpl.prototype.addSeparator=function(){try{var B=new Array("-","",0,2,"",1,1);return this.addItemDefinition(B);}catch(A){microstrategy.errors.log(A);return false;}};mstrContextMenuImpl.prototype.addItemDefinition=function(B){try{this.cmm_items.push(B);this.menu_items.push(this.cmm_items.length-1);this.length=this.menu_items.length;return B;}catch(A){microstrategy.errors.log(A);return false;}};mstrContextMenuImpl.prototype.registerTrigger=function(A,B){try{if(A){A.setAttribute("cx","["+this.menu_items.toString()+"]");A.setAttribute("cxid",this.cmm_id);if(B){A.setAttribute("cxty",B);}}return true;}catch(C){microstrategy.errors.log(C);return false;}};function mstrContextMenuImpl(A,C,B){this.cmm_id=A;this.cmm_items=C;this.menu_items=B;return this;}ObjectManipulationScript=true;var omd=new function(){};omd.prototype=new Object();omd.anchorToForm=function(B){try{var D=findTargetTag(B,"form");var C=createDynamicForm(B.href);C.target=B.target;omd.AddHiddenInputs(D,C);submitForm(C);return false;}catch(A){microstrategy.errors.log(A);return false;}};omd.addHiddenInputs=function(C,A){try{if(C&&A){if(C.objectName){createHiddenInput(A,"objectName",C.objectName.value);}if(C.objectDescription){createHiddenInput(A,"objectDescription",C.objectDescription.value);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrObserverImpl.prototype=new Object();mstrObserverImpl.prototype.items=null;mstrObserverImpl.prototype.onload=function(){if(microstrategy.observerItems){this.items=microstrategy.observerItems;microstrategy.observerItems=null;}};mstrObserverImpl.prototype.onunload=function(){microstrategy.observerItems=this.items;};mstrObserverImpl.prototype.register=function(A){if(typeof (this.items[A])=="undefined"){this.items[A]=A;}return true;};mstrObserverImpl.prototype.unregister=function(A){if(typeof (this.items[A])!="undefined"){delete this.items[A];}return true;};mstrObserverImpl.prototype.notifyAll=function(A,D){try{for(var E in this.items){var C=mstr.$obj(E);if(C&&A in C){C[A](D);}}return true;}catch(B){microstrategy.errors.log(B);return false;}};function mstrObserverImpl(A){this.items=new Object();return this;}menuScript=true;var oSubCTimer=null;var oSubPkrTimer=null;var bIsOverContext=false;var bDisplayLeft=false;var sQuote="\\'";var sQuoteSimple="'";var sQuoteDouble='"';var aOndemandMenuItems=null;var aMenuItems=null;var aMenuItemsName;var sDrillContextMenuExtraArg1;var currentPicker=null;var specialMenuLayers=null;mstrMenuObj.prototype=new Object();function mstrMenuObj(A){}mstrMenuObj.adjustMenuPositionForClient=function(I,H,B,D){if(B.getAttribute("origHeight")){B.style.height=B.getAttribute("origHeight")+"px";}if(B.getAttribute("origWidth")){B.style.width=B.getAttribute("origWidth")+"px";}var F=B.getAttribute("ty")=="cxt";var J=getObjWidth(F?B.firstChild:B);if(J+I<getClientWidth()+getDocumentScrollLeft()){if(bDisplayLeft&&D){I=D-J+2;}else{bDisplayLeft=false;}}else{bDisplayLeft=true;if(D){I=D-J+2;}else{I=I-J+10;}}var A=getClientHeight();var C=getObjHeight(F?B.firstChild:B);var G=getDocumentScrollTop();var E=(H+C)-(G+A);if(C>A){H=G+1;if(E>0){if(!B.getAttribute("origHeight")){B.setAttribute("origHeight",C);}if(!B.getAttribute("origWidth")){B.setAttribute("origWidth",J);}if(!F){B.style.height=Math.min(C,A)+"px";B.style.width=Math.min(J,J+B.offsetWidth-B.clientWidth)+"px";B.style.overflowY="auto";}}}else{if(E>0){H=G+A-C-2;}}if(F){B.style.height=Math.min(C,A)+"px";B.style.width=Math.min(J,J+B.offsetWidth-B.clientWidth)+"px";if(B.offsetHeight<C){if(bIsIE7){B.style.overflow="auto";}else{B.style.overflowY="auto";}}}moveObjTo(B,I,H);};function displayContextMenu(oTarget,e,moveMenu){var sMenu=oTarget.getAttribute("CX");if(sMenu.length==0){return true;}var menuDefTarget=findTarget(oTarget,"CXID");var aMenuElementsName=menuDefTarget.getAttribute("CXID");var aMenuElements=microstrategy.getContextMenuManager(aMenuElementsName).menu_items;if(!aMenuElements||aMenuElements.length==0){return false;}var sDrillExtraArgument1=oTarget.getAttribute("D1");var types=oTarget.getAttribute("cxty");if(typeof (microstrategy)!="undefined"){microstrategy.updateActiveCXProps(oTarget,e);}hideContextMenus();getMouse(e);aMenuItems=aMenuElements;aMenuItemsName=aMenuElementsName;sDrillContextMenuExtraArg1=sDrillExtraArgument1;var avMenu=eval(sMenu);buildContextMenu(avMenu,1,eval(types),oTarget,false,null);if(hasMenuItem(avMenu,eval(types))){var menuX,menuY;if(moveMenu){var tID=oTarget.id;var menuX=getObjSumLeftScrolled(tID)+3;var menuY=getObjSumTopScrolled(tID)+getObjHeight(tID)+4;oTarget.onmouseout=function(){OutContext();};}else{menuX=lMouseX-microstrategy.CURSOR_OFFSET;menuY=lMouseY-microstrategy.CURSOR_OFFSET;}positionContextMenu(menuX,menuY,aMenuItemsName+"1");if(bIsIE4){togglePulldowns(getObj(aMenuItemsName+"1"),false);}document.getElementById(aMenuItemsName+"1").style.visibility="visible";microstrategy.setContextMenuStatus(true);}return false;}function isMenuShown(menuItem,selectedTypes){var supportedTypes=menuItem[5];var showJS=menuItem[6];var displayMenuItem=true;var __result=true;if(supportedTypes&&supportedTypes.length>0&&selectedTypes&&selectedTypes.length>0){var supportedTypesArray=eval(supportedTypes);__result=false;for(var j=0;j<selectedTypes.length;j++){for(var i=0;i<supportedTypesArray.length;i++){if(selectedTypes[j]==supportedTypesArray[i]){__result=true;break;}}if(__result){break;}}}if(showJS&&showJS.length>0&&__result==true){if(showJS=="$check-subMenu-existence$"){var subs=eval(menuItem[4]);var n=subs.length;if(n>0){for(var i=0;i<n;i++){var sub=aMenuItems[subs[i]];if(sub){__result=isMenuShown(sub,selectedTypes);if(__result){break;}}}}else{__result=false;}}else{__result=eval(showJS)?true:false;}}return __result;}function getPicker(D){var E=document.getElementsByName(D);var A=null;var C=document.body.childNodes;for(var B=0;B<C.length;B++){if(C[B].id==D){A=C[B];break;}}if(E){if(!A){while(E.length>1){E[0].parentNode.removeChild(E[0]);}A=document.body.appendChild(E[0]);}}return A;}function showPicker(A,E,H,G,F){var C=getPicker(E);if(C){if(A){currentPicker=C;var B=aMenuItemsName+F;var D=getElementById(B);if(D){C.style.zIndex=D.style.zIndex+100;}C.style.visibility="hidden";C.style.display="block";mstrMenuObj.adjustMenuPositionForClient(H,G,C);if(bDisplayLeft){C.style.left=parseInt(C.style.left,10)-getObjWidth(D)+"px";}C.style.visibility="visible";}else{C.style.display="none";currentPicker=null;}}}function buildContextMenuRows(avItems,iMenu,types,oTarget,loadOndemandMenuItems,modelID){var sContent="";var lRowCount=0;var sRowID="";var sSubCommand="";var sOnClickLink="";var hasMenuItem=false;var enabled=true;if(!oTarget){oTarget=microstrategy.activeCXMenu;}var aMenuItemsLocal=null;if(loadOndemandMenuItems){aMenuItemsLocal=aOndemandMenuItems;lRowCount=getNumTagsInDiv(aMenuItemsName+iMenu,"tr");}else{aMenuItemsLocal=aMenuItems;}for(var iIndex=0;iIndex<avItems.length;iIndex++){if(aMenuItemsLocal[avItems[iIndex]][3]!=2){if(isMenuShown(aMenuItemsLocal[avItems[iIndex]],types)){hasMenuItem=true;var menuClass="menu-item";var menuClassWithSeparator="menu-item-with-separator";var separatorClass="menu-item-separator";enabled=true;var enableJS=aMenuItemsLocal[avItems[iIndex]][7];if(enableJS&&enableJS.length>0){enabled=eval(enableJS);}if(!enabled||aMenuItemsLocal[avItems[iIndex]][8]==1){menuClass="menu-item-disabled";menuClassWithSeparator="menu-item-disabled-with-separator";}sRowID="cm"+iMenu+"r"+lRowCount;sContent+='<TR ID="'+sRowID+'" HEIGHT="18" AC="true" ';var cmd=aMenuItemsLocal[avItems[iIndex]][1];if(menuClass=="menu-item"){cmd=replacePlaceholders(cmd,oTarget);if(aMenuItemsLocal[avItems[iIndex]][3]==1){var typesString=convertArrayToString(types);if(aMenuItemsLocal[avItems[iIndex]][10]!=null){var ondemandModelId=aMenuItemsLocal[avItems[iIndex]][10];var ondemandDynamicMenuKey=aMenuItemsLocal[avItems[iIndex]][11];var ondemandViewId=aMenuItemsLocal[avItems[iIndex]][12];sSubCommand="buildSubMenu("+aMenuItemsLocal[avItems[iIndex]][4]+", "+(iMenu+1)+", getObjSumTop("+sQuote+sRowID+sQuote+"), ["+typesString+"], "+loadOndemandMenuItems+", "+sQuote+ondemandModelId+sQuote+", "+sQuote+ondemandDynamicMenuKey+sQuote+", "+sQuote+ondemandViewId+sQuote+" );";}else{sSubCommand="buildSubMenu("+aMenuItemsLocal[avItems[iIndex]][4]+", "+(iMenu+1)+", getObjSumTopScrolled("+sQuote+sRowID+sQuote+"), ["+typesString+"], "+loadOndemandMenuItems+");";}sContent+="onMouseOver=\"clearTimeout(oSubCTimer); delaySubCMenus('"+sSubCommand+"'); menuOn(this);\" ";sContent+='onMouseOut="menuOff(this);" LI="sub" ';}else{if(aMenuItemsLocal[avItems[iIndex]][3]==3){sSubCommand="hideContextSubMenus("+iMenu+"); showPicker(true,"+sQuote+aMenuItemsLocal[avItems[iIndex]][4]+sQuote+",getObjWidth("+sQuote+sRowID+sQuote+") + getObjSumLeft("+sQuote+sRowID+sQuote+"), getObjSumTop("+sQuote+sRowID+sQuote+"),"+iMenu+");";sContent+="onMouseOver=\"clearTimeout(oSubCTimer); delaySubCMenus('"+sSubCommand+"'); menuOn(this);\"";sContent+='onMouseOut="menuOff(this);"';var pkr=getPicker(aMenuItemsLocal[avItems[iIndex]][4]);if(pkr){pkr.onmouseover=new Function("clearTimeout(oSubPkrTimer);");pkr.onmouseout=new Function("OutContext();");pkr.onmousedown=new Function("e","if (!e) {e=window.event;} eval("+cmd+");OutContext();");}}else{sContent+='onMouseOver="clearTimeout(oSubCTimer); menuOn(this);';sContent+=" hideContextSubMenus("+iMenu+");";sContent+='" onMouseOut="menuOff(this);" ';sOnClickLink=cmd;if(sOnClickLink.indexOf("DCM")!=-1){if(sDrillContextMenuExtraArg1==null){sOnClickLink=sOnClickLink.substr(0,sOnClickLink.indexOf(")"))+",'')";}else{sOnClickLink=sOnClickLink.substr(0,sOnClickLink.indexOf(")"))+",'"+sDrillContextMenuExtraArg1+"')";}}sContent+="onClick=\"menuClick(this, '"+aMenuItemsName+iMenu+'\');" LI="'+sOnClickLink+';" ';}}if(bIsW3C){sContent+='STYLE="cursor: pointer;"';}else{sContent+='STYLE="cursor: hand;"';}}var isNextMenuOptionASeparator=isNextMenuSeparator(aMenuItemsLocal,avItems,iIndex,types);sContent+=">\n";sContent+='<TD WIDTH="12" ALIGN="MIDDLE" CLASS="mstrContextMenuLeft"';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+=">";switch(aMenuItemsLocal[avItems[iIndex]][2]){case 0:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 1:var showCheck=true;var checkJS=aMenuItemsLocal[avItems[iIndex]][9];if(checkJS&&checkJS.length>0){showCheck=eval(checkJS);}if(showCheck){sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuCheck.gif" WIDTH="12" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';}break;case 2:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'CMenuRemove.gif" WIDTH="11" HEIGHT="11" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" /><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="1" HEIGHT="1" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 3:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'CMenuSubtotal.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 4:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillUp.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 5:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillDown.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 6:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillTemplate.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 7:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'drill.png" WIDTH="16" HEIGHT="16" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 8:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'treeLoading.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;}sContent+="</TD>";sContent+='<TD WIDTH="1"';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+='><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"></TD>';sContent+='<TD ALIGN="LEFT" NOWRAP="1" ';if(isNextMenuOptionASeparator){sContent+=" class="+menuClassWithSeparator+" ";}else{sContent+=" class="+menuClass+" ";}sContent+=">"+aMenuItemsLocal[avItems[iIndex]][0]+"&nbsp;&nbsp;<BR/></TD>";sContent+='<TD WIDTH="12" ALIGN="RIGHT" NOWRAP="1" ';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+=">";if(aMenuItemsLocal[avItems[iIndex]][3]==1||aMenuItemsLocal[avItems[iIndex]][3]==3){var expandImage=enabled?"MenuExpand.gif":"MenuExpand_off.gif";sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+expandImage+'" WIDTH="8" HEIGHT="9" ALT="" BORDER="0" /><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="2" HEIGHT="1" ALT="0" BORDER="0" />';}else{sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" ALT="0" BORDER="0" />';}sContent+="</TD></TR>\n";lRowCount++;}}}return sContent;}function replacePlaceholders(str,oTarget){var matched=false;var tempStr=str;if(tempStr.indexOf("%40")>-1){tempStr=unescape(tempStr);}if(tempStr.indexOf("@")>-1){tempStr=tempStr.replace(/@[^@]+@/g,function(token){matched=true;var attName=token.substring(1,token.length-1);if(attName.indexOf("__bone__")>-1){attName=attName.replace("__bone__","microstrategy.findBone(microstrategy.activeCXMenu)");return eval(attName);}else{return oTarget.getAttribute(attName)||"";}});}if(matched){return tempStr;}else{return str;}}function isNextMenuSeparator(E,A,D,C){for(var B=D+1;B<A.length;B++){if(isMenuShown(E[A[B]],C)){return(E[A[B]][3]==2);}}return false;}function getMenuDiv(B){var A=getObj(B);if(!A){A=document.createElement("DIV");A.setAttribute("id",B);A.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_CONTEXT_MENU);A.onmouseover=OverContext;A.onmouseout=OutContext;A.style.visibility="hidden";A.style.position="absolute";A.style.backgroundColor="#FFFFFF";A.style.border="1px #ddd solid";A.style.top="-999px";document.body.appendChild(A);}return A;}function buildContextMenu(B,H,E,C,F,G){var D="";D='<TABLE BORDER="0" CELLSPACING="0" CLASS="mstrContextMenuRight">\n';D+=buildContextMenuRows(B,H,E,C,F,G);D+="</TABLE>";var A=getMenuDiv(aMenuItemsName+H);A.innerHTML=D;}function hasMenuItem(A,B){for(var C=0;C<A.length;C++){if(aMenuItems[A[C]][3]!=2){if(isMenuShown(aMenuItems[A[C]],B)){return true;}}}return false;}function upClick(C){if(bIsW3C&&!C){return false;}var B=(bIsIE4)?(event.button==2||event.button==3):(C.button==3);if(B){var A=getEventTarget(C);A=findTarget(A,"CX");if(A){document.onmouseup=null;return false;}}}function OverContext(){bIsOverContext=true;}function OutContext(){clearTimeout(oSubCTimer);bIsOverContext=false;}function hideContextMenus(){if(typeof (aMenuItemsName)=="undefined"){return ;}if(!bIsOverContext){hideContextSubMenus(1);var A=getObj(aMenuItemsName+"1");if(A){A.style.visibility="hidden";A.style.top="-999px";microstrategy.setContextMenuStatus(false);A.innerHTML="";}if(bIsIE4){togglePulldowns(A,true);}}}function hideContextSubMenus(C){var B=1;for(var B=4;B>C;B--){var A=getObj(aMenuItemsName+B);if(A){A.style.visibility="hidden";A.innerHTML="";if(bIsIE4){togglePulldowns(A,true);}}}if(currentPicker!=null){currentPicker.style.display="none";currentPicker=null;}}function buildSubMenu(C,D,K,H,F,B,L,A){var G=aMenuItemsName+D;var I=getMenuDiv(G);I.modelID=B;if(bIsIE4){I.style.height="auto";I.style.width="auto";I.style.overflowY="visible";}I.style.zIndex=1000;buildContextMenu(C,D,H,null,F,B);addOndemandSubMenuItems(B,L,A,D);if(I.childNodes.length==0){return ;}var E=getObjLeft(aMenuItemsName+(D-1));var J=getObjWidth(aMenuItemsName+(D-1));positionContextMenu(E+J-2,K,G,E);if(bIsIE4){togglePulldowns(getObj(aMenuItemsName+D),false);}hideContextSubMenus(D);document.getElementById(aMenuItemsName+D).style.visibility="visible";}function delaySubCMenus(sExecuteText){clearTimeout(oSubCTimer);if(sExecuteText.length>0){if(bIsInPortal&&mstr.utils.ISFF3){eval(sExecuteText);}else{oSubCTimer=window.setTimeout(sExecuteText,250);}}}function positionContextMenu(E,C,D,B){if(bIsIE4){var A=D;if(typeof (A)=="string"){A=document.getElementById(D);}if(A){A.style.height="auto";A.style.width="auto";A.style.overflowY="visible";}}var A=getObj(D);A.style.zIndex=1000;mstrMenuObj.adjustMenuPositionForClient(E,C,A,B);}function generateLink(A){A+="&innerWidth="+getClientWidth()+"&innerHeight="+getClientHeight();return A;}function submitCM(D,B,E){if(B){D=D+"&iframe=true";}var A=true;if(microstrategy&&microstrategy.eventManager){A=microstrategy.eventManager.notifyOrphanBones("onmenusubmitform");}if(A){var C=createDynamicForm(D);if(B){C.target="frameManager";}if(E!=null){C.target=E;}}submitForm(C);}dropDownMenusScript=true;var oTimer=null;var bIsOver=false;var oSubTimer=null;var bMenuOpen=false;var bCompleted=false;var asBranch=new Array();var nBranchElements=0;var bClickStyle=false;function activateHeader(F,E,D){for(var B=0;B<iMainMenus;B++){var A=getObj("menuHeader"+B);if(A){var C=A.getAttribute("E")=="0";if(!C){if(B==F){A.className=E;}else{A.className=D;}}}}}function fixMenus(A){var B;for(i=0;i<A.length;i++){B=getObj(A[i][1]);if(B){B.setAttribute(A[i][2],A[i][3]);}}B=B=getObj("mb"+A[0][0]);if(B){B.setAttribute("C","0");}}function updateCheckedAndEnabledOptions(menuName){var menu=getObj(menuName);var TABLEs=menu.getElementsByTagName("TABLE");TABLEs[0].className="menu-block";var TRs=TABLEs[0].getElementsByTagName("TR");var menuUpdated=false;var newValue;var wasChecked;var wasEnabled;var wasShown;var baseBone;for(i=0;i<TRs.length;i++){baseBone=TRs[i].getAttribute("BB");wasChecked=TRs[i].getAttribute("H");wasEnabled=TRs[i].getAttribute("E");wasShown=(TRs[i].style.display!="none");if(baseBone&&baseBone.length>0&&!(microstrategy&&microstrategy.bone(baseBone))){continue;}var auxStr=TRs[i].getAttribute("DS");if(auxStr&&auxStr.length>0){newValue=eval(auxStr);if(newValue!=wasShown){menuUpdated=true;if(newValue){TRs[i].style.display="";}else{TRs[i].style.display="none";continue;}}}var auxStr=TRs[i].getAttribute("DC");if(auxStr&&auxStr.length>0){newValue=eval(auxStr)?"1":"0";if(newValue!=wasChecked){TRs[i].setAttribute("H",newValue);menuUpdated=true;}}auxStr=TRs[i].getAttribute("DE");if(auxStr&&auxStr.length>0){newValue=eval(auxStr)?"1":"0";if(newValue!=wasEnabled){TRs[i].setAttribute("E",newValue);menuUpdated=true;}}}if(menuUpdated){menu.setAttribute("C","0");}}function completeMenu(A){var E;var C;var F=getObj(A);var D=F.getElementsByTagName("TABLE");D[0].className="menu-block";var B=D[0].getElementsByTagName("TD");for(i=0;i<B.length;i++){if(B[i].id=="blank"){B[i].width="1";B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="1" HEIGTH="1">';}else{if(B[i].id=="mnI"){B[i].align="middle";if(B[i].parentNode.getAttribute("E")=="1"){B[i].className="menu-item-image";}else{B[i].className="menu-item-image-disabled";}if(B[i].parentNode.getAttribute("H")=="1"){B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuCheck.gif" style="width:12px;height:9px;">';}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif">';}}else{if(B[i].id=="mnT"||B[i].id=="mnS"){B[i].noWrap=true;C=(B[i].parentNode.getAttribute("E")=="1");if(C){B[i].className="menu-item";}else{B[i].className="menu-item-disabled";}if(B[i].parentNode.getAttribute("AS")=="1"){if(C){B[i].className="menu-top-separator";}else{B[i].className="menu-top-separator-disabled";}}}else{if(B[i].id=="mnE"){B[i].width="12";B[i].align="right";C=(B[i].parentNode.getAttribute("E")=="1");if(B[i].parentNode.getAttribute("AS")=="1"){if(C){B[i].className="menu-top-separator";}else{B[i].className="menu-top-separator-disabled";}}if(B[i].parentNode.getAttribute("SB")=="1"){if(C){B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuExpand.gif" WIDTH="8" HEIGTH="9">';}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuExpand_off.gif" WIDTH="8" HEIGTH="9">';}}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGTH="10">';}}}}}}F.setAttribute("C","1");bCompleted=true;}function ShowLayer(G,E){if(oTimer){clearTimeout(oTimer);}HideAllLayers();if(isNaN(G)){if(specialMenuLayers==null){specialMenuLayers=[];}specialMenuLayers.push(G);}var F=getObj("mb"+G);if(F.getAttribute("C")!="1"){completeMenu("mb"+G);}var B=(E)?E:("menuHeader"+G);var C=getObjSumTop(B)+getObjHeight(B);var D=getObjSumLeftScrolled(B);var A=getObj("mb"+G);A.style.zIndex=1000;positionContextMenu(D,C,A);if(bIsIE4){togglePulldowns(A,false);}asBranch[0]="mb"+G;nBranchElements=1;A.style.visibility="visible";bMenuOpen=true;}function hidePopupMenus(A){hideContextMenus();if(A||(bClickStyle&&bMenuOpen)){UnselectAllLayers();}}function UnselectAllLayers(){if(!bIsOver&&typeof (iMainMenus)!="undefined"){HideAllLayers();var B;for(var A=0;A<iMainMenus;A++){B=getObj("menuHeader"+A);if(B){if(B.getAttribute("E")=="0"){B.className=mstrMenuDisabledClass;}else{B.className=mstrMenuEnabledClass;}}}bMenuOpen=false;}}function HideAllLayers(){nBranchElements=0;if(!bIsOver&&typeof (iSubMenus)!="undefined"){for(var A=0;A<iSubMenus;A++){var B=document.getElementById("mb"+A);if(B){B.style.visibility="hidden";}}if(specialMenuLayers!=null){for(var A=0;A<=specialMenuLayers.length;A++){document.getElementById("mb"+specialMenuLayers[A]).style.visibility="hidden";}specialMenuLayers=null;}if(bIsIE4){togglePulldowns(null,true);}}bMenuOpen=false;}function OverLayer(){if(oTimer){clearTimeout(oTimer);}bIsOver=true;}function OutLayer(){if(oTimer){clearTimeout(oTimer);}bIsOver=false;if(!bClickStyle){oTimer=setTimeout("UnselectAllLayers()",300);}}function hideSubMenu(F,C,B){var E=false;var A=0;for(i=0;i<nBranchElements;i++){if(E){var D=document.getElementById(asBranch[i]);if(D){if(bIsIE4){togglePulldowns(D,true);}D.style.visibility="hidden";}asBranch[i]=0;}if(asBranch[i]==C){E=true;A=i+1;}}nBranchElements=A+1;asBranch[nBranchElements-1]=F;}function menuOn(A){if(A.className!="menuDisabled"){A.className="menu-row-selected";}}function menuOff(A){if(A.className!="menuDisabled"){A.className="menu-row";}}function menuClick(oMenuItem,sMenu){var oMenu=typeof (sMenu)=="string"?document.getElementById(sMenu):sMenu;if(oMenu.modelID){var model=mstr.$obj(oMenu.modelID);if(model){var state=model.get("readyState");if(state&&state===mstr.Enum.Widget.READYSTATE.WAITING){return ;}}}if(oMenuItem.className!="menuDisabled"){if(oMenuItem.getAttribute("AC")=="true"){var sLink=oMenuItem.getAttribute("LI");if(sLink.length>0){bIsOverContext=false;oMenu.style.visibility="hidden";hideContextMenus();window.mstrSubmitLink=true;eval(sLink);}}else{bIsOverContext=false;oMenu.style.visibility="hidden";HideAllLayers();hideContextMenus();}}}function onCl(A){onMv(A);ShowLayer(A.getAttribute("ndx"));}function onMv(C){var B=C.getAttribute("E")=="0";var A=C.getAttribute("ndx");updateCheckedAndEnabledOptions("mb"+A);if(getObj("mb"+A).getAttribute("C")!="1"){completeMenu("mb"+A);}if(!B){if(bMenuOpen){activateHeader(A,"menu-header-selected","menu-header");ShowLayer(A);}else{activateHeader(A,"menu-header-selected","menu-header");}}}function onMo(B){var A=B.getAttribute("E")=="0";if(!A){if(!bMenuOpen){B.className="menu-header";}else{OutLayer("menu-header","menu-header-disabled");}}}function convertArrayToString(A){var C="";if(A){for(var B=0;B<A.length;B++){if(A[B]){C=C+sQuote+A[B]+sQuote+", ";}else{C=C+"null, ";}}C=C.substr(0,C.length-2);}return C;}function buildWidgetSubMenu(C,J,Q,D){completeMenu(C);if(!D){D="currentControl";}var P=getObj(C);var L=P.getElementsByTagName("tbody")[0];var I=L.firstChild;var M=I.getAttribute("id");M=M.substr(0,M.length-1);var K=microstrategy.getViewerBone().widgets;var G=false;if(K){if(L.hasChildNodes()){for(var F=L.childNodes.length-1;F>=0;F--){if(J||L.childNodes[F].getAttribute("dyn_menu")){L.removeChild(L.childNodes[F]);}}}G=!J&&L.hasChildNodes();var E=false;for(var F=0;F<K.length;F++){var O=K[F];if(!Q||Q==O.scope){var B=I.getAttribute("id");var H=I.cloneNode(true);H.setAttribute("id",M+F);H.setAttribute("dyn_menu",true);H.className="ctrl"+O.tbClass;if(!E&&G){H.setAttribute("AS",1);E=true;}var N=microstrategy.SUBOBJTYPE_DOC_WIDGET+"|"+O.fqcn+";"+O.rslPath+";"+O.title+";"+O.previewImage+";"+O.isApp+";"+O.scope+";"+O.defaultDHTMLStyle;var A="microstrategy.bone('rwb_viewer').commands.exec('"+D+"', '"+N+"');";if(D=="currentControl"){A+="microstrategy.eventManager.notifyOrphanBones('requestCurrentControlChange', '"+N+"');";}H.setAttribute("JS",A);H.childNodes[2].innerHTML=O.title;L.appendChild(H);}}completeMenu(C);}}function addOndemandSubMenuItems(G,C,E,H){if(G){var B=mstr.$obj(G);if(!B){return ;}var A=mstr.$obj(E);if(C){B.setCurrentDynamicMenuKey(C);}var D="";if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){D="Report";}else{var F=microstrategy.findBone(microstrategy.activeCXMenu);D=F.objId;}B.setGridKey(D);A.setMenuLevel(H);A.setModel(B);B.execPopulate();}}function addDynamicMenus(E,D,B){setOndemandMenuItems(D);var C=buildContextMenuRows(B,E,null,null,true,null);var A=getMenuDiv(aMenuItemsName+E);if(C==""){if(A.childNodes[0].rows&&A.childNodes[0].rows.length==0){hideContextSubMenus(E-1);}}else{addToExistingDivTable(A,C);mstrMenuObj.adjustMenuPositionForClient(parseInt(A.style.left,10),parseInt(A.style.top,10),A);}}function addToExistingDivTable(E,C){var B=document.createElement("div");B.innerHTML="<TABLE>"+C+"</TABLE>\n";var D=B.childNodes[0];var A=E.childNodes[0];if(A!=null&&(A.tBodies==null||A.tBodies.length==0)){A.appendChild(document.createElement("tbody"));}while(D.rows.length>0&&(A!=undefined)){A.tBodies[0].appendChild(D.rows[0]);}}function getNumTagsInDiv(C,B){var D=getObj(C);var A=D.getElementsByTagName(B);if(A!=null){return A.length;}else{return 0;}}function setOndemandMenuItems(A){aOndemandMenuItems=A;}function removeProcessingMenuItem(D){var A=getMenuDiv(aMenuItemsName+D);var C=A.getElementsByTagName("tr");if(C!=null){var B=0;while(B<C.length){if(C[B]!=null&&"processing"==C[B].getAttribute("id")){C[B].parentNode.removeChild(C[B]);}B++;}}}function addProcessingMenuItem(E){var B=microstrategy.descriptors.getDescriptor("2901");var C="";var D="menu-item";C+='<TR ID="processing" name="processing" HEIGHT="18" AC="true" ';C+='onMouseOver="clearTimeout(oSubCTimer); menuOn(this);';C+=" hideContextSubMenus("+E+");";C+='" onMouseOut="menuOff(this);" ';if(bIsW3C){C+='STYLE="cursor: pointer;"';}else{C+='STYLE="cursor: hand;"';}C+=">\n";C+='<TD WIDTH="12" ALIGN="MIDDLE" CLASS="mstrContextMenuLeft">';C+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'treeLoading.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';C+="</TD>";C+='<TD WIDTH="1"><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"></TD>';C+='<TD ALIGN="LEFT" NOWRAP="1" ';C+=" class="+D+" ";C+=">"+B+"&nbsp;&nbsp;<BR/></TD>";C+='<TD WIDTH="12" ALIGN="RIGHT" NOWRAP="1" ';C+=">";C+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" ALT="0" BORDER="0" />';C+="</TD>";C+="</TR>";var A=getMenuDiv(aMenuItemsName+E);addToExistingDivTable(A,C);}var dropDown=new function(){};dropDown.prototype=new Object();dropDown.togglePicker=function(show,id,dropdown,bone){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.togglePicker",0);}var oldPicker=null;if(bone.currentPicker){oldPicker=bone.currentPicker;if(bone.currentPicker.selected){var item=bone.currentPicker.selected;if(item){item.className="";}bone.currentPicker.selected=null;bone.currentPicker.commandId=null;bone.currentPicker.toolId=null;}bone.currentPicker.style.display="none";bone.currentPicker=null;}if(show){bone.currentPicker=document.getElementById(id);if(!bone.currentPicker){microstrategy.errors.log(microstrategy.descriptors.getDescriptor("3623"));return false;}bone.currentPicker.style.zIndex=1000;var cmdId=dropdown.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!cmdId){cmdId=dropdown.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_ID);}bone.currentPicker.commandId=cmdId;var subtypeStyle=bone.currentPicker.getAttribute(microstrategy.HTMLATTR_STYLE);if(subtypeStyle!=null){this.adjustPickerElements(bone.currentPicker);}if(bone.selectPickerElement){bone.selectPickerElement(bone.currentPicker);}for(var i=0;i<bone.currentPicker.childNodes.length;i++){var oChild=bone.currentPicker.childNodes[i];auxStr=oChild.getAttribute("de");if(auxStr&&auxStr.length>0){oChild.className=(eval(auxStr))?" ":"disabled";}}var leftElem=mstr.utils.BoxModel.getElementSumOffsetLeftAccurately(dropdown,document.body);var bottomElem=mstr.utils.BoxModel.getElementSumOffsetTopAccurately(dropdown,document.body)+getObjHeight(dropdown);if(bone.dialogDiv&&bone.dialogDiv.getAttribute(mstrHTMLAttributes.ATTR_DIALOG)=="true"){leftElem-=getObjSumLeft(bone.dialogDiv);bottomElem-=getObjSumTop(bone.dialogDiv);}bone.currentPicker.style.visibility="hidden";bone.currentPicker.style.display="block";var lClientWidth=getClientWidth();var lPickerWidth=getObjWidth(bone.currentPicker);if(lPickerWidth+leftElem>lClientWidth+((bone.dialogDiv&&!mstr.utils.ISIE6)?bone.dialogDiv.scrollLeft:0)){leftElem=Math.max(leftElem-lPickerWidth+getObjWidth(dropdown),0);}moveObjTo(bone.currentPicker,leftElem,bottomElem);if(bIsIE6&&!bIsIE7&&bone.maxHeight){bone.currentPicker.style.height="auto";bone.currentPicker.style.height=(bone.currentPicker.clientHeight<parseInt(bone.maxHeight))?bone.currentPicker.clientHeight+"px":bone.maxHeight;}bone.currentPicker.style.visibility="visible";togglePulldowns(bone.currentPicker,false);}else{if(oldPicker){togglePulldowns(oldPicker,true);}}}catch(err){microstrategy.errors.log(err);}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.togglePicker",0);}}return false;};dropDown.closePicker=function(F,D){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.closePicker",0);}if(!F){F=window.event;}var E=getEventTarget(F);var C=true;if(E){if(!E.getAttribute("id")&&E.parentNode.nodeType==1){E=E.parentNode;}var B=false;if(D.currentPicker){B=(findTarget(E,"ty")==D.currentPicker)&&(E!=D.currentPicker)&&(E.className.indexOf("disabled")<0);C=(E.className.indexOf("disabled")<0)&&(E!=D.currentPicker);}if(B){if(D.execPicker){C=D.execPicker(D.currentPicker,E);}else{alert("Option '"+E.getAttribute("id")+"' was selected from picker '"+D.currentPicker.id+"'. Please make sure the bone '"+D.id+"' implements execPicker.");}}}if(C&&D.currentPicker){dropDown.togglePicker(false,D.currentPicker.id,null,D);}return true;}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.closePicker",0);}}};dropDown.adjustPickerElements=function(I){try{var E=I.getAttribute(microstrategy.HTMLATTR_STYLE);switch(E){case"color":var H=microstrategy.userPalette;if(H){var B=microstrategy.findChildWithAtt(I,"span","name","pkrCustom");if(!B){return ;}if(B.getElementsByTagName("img").length==0){var J=document.createElement("img");J.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";B.appendChild(J);}displayObj(B);if(!ISIE7){var F=microstrategy.findChildWithAtt(I,"span","name","pkrMore");if(F){F.style.marginTop="25px";}}H=H.split(",");var A=microstrategy.findChildrenWithAtt(I,"span","custom","1");if(A.length==H.length&&A.length==8){if(A[0].id=="pkr"+H[0]){return ;}}else{if(A.length==H.length){return ;}}for(var D=0;D<A.length;D++){I.removeChild(A[D]);}for(var D=(H.length-1);D>=0;D--){var G=document.createElement("span");G.setAttribute("custom","1");G.id="pkr"+H[D];G.setAttribute("name","pkr"+H[D]);G.setAttribute("title",H[D]);G.style.backgroundColor=H[D];B.insertAdjacentElement("afterEnd",G);}}break;}}catch(C){microstrategy.errors.log(C);return false;}};mstrPathImplScript=true;mstrPathImpl.prototype=new mstrBoneImpl();mstrPathImpl.prototype.commands=null;mstrPathImpl.prototype.openHistoryPageEvent="";mstrPathImpl.prototype.openHistoryPageEventID="";mstrPathImpl.prototype.openHistoryPageEventArgumentID="";mstrPathImpl.prototype.openHistoryPageEventArgumentName="";mstrPathImpl.prototype.pathSize=0;mstrPathImpl.PINNED_CLASS="pinned";mstrPathImpl.PADDING=23;mstrPathImpl.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.updateAccountButton();this.commands=new mstrPathCommandsImpl(this);this.onwinresize();}catch(A){microstrategy.errors.log(A);}};mstrPathImpl.prototype.updateAccountButton=function(){var D=document.getElementById("mstrPathAccount"),B=microstrategy.servletName,A;if(D){if(microstrategy.hasSession&&!mstrApp.isAdminPage&&D.getAttribute("_isstatic")!="true"){D.href="#";var C=microstrategy.menuHover?"mouseover":"click";D["on"+C]=microstrategy.showAccountSCList;}}};mstrPathImpl.prototype.onwinresize=function(){try{if(window.mstrInterfacePlugin){if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){return ;}var A=this.id;this.pathBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_path");this.footerBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_footer");if(!this.pathBar&&!this.footerBar){return ;}if(mstr.utils.ISIE8&&this.pathBar){this.pathBar.className=this.pathBar.className.replace(/ ie8/,"")+" ie8";}this.pathText=this.findChildByCssClass(this.elem,"mstrPathText");if(this.pathText){if(!this.pathBar){this.pathText.onclick=function(D){microstrategy.bone(A).pinPath(D);};}this.pathAncestor=this.findChildByCssClass(this.pathText,"mstrPathTextAncestors");this.pathCurrent=this.findChildByCssClass(this.pathText,"mstrPathTextCurrent");this.pathAncestors=this.findChildByCssClass(this.pathText,"mstrPathAncestors");this.pathBreadCrumbs=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbs");this.pathBreadCrumbsParent=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsParent","span");this.pathBreadCrumbsAncestors=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");}this.closeIcon=this.findChildByCssClass(this.footerBar,"mstrFooterPathClose","div");if(this.closeIcon){this.closeIcon.onclick=function(D){microstrategy.bone(A).toggleFooterPath(D);};}var C=this;if(this.pathBar&&this.pathText&&this.pathAncestors&&this.pathBreadCrumbs){this.neededWidth=C.getNeededWidth(),this.availableWidth=C.getAvailWidth();if(this.neededWidth<this.availableWidth){C.hideBreadCrumbs();}else{C.showBreadCrumbs();}}else{window.setTimeout(function(){C.resizePathBar();},10);}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getNeededWidth=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,B=this.pathAncestor,C=this.pathCurrent;if(A&&E&&B&&C){A.className=A.className.replace(" hidden","");if(!this.hasClass(E,"hidden")){E.className=E.className+" hidden";}return B.scrollWidth+C.scrollWidth+40;}else{return 0;}}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.hideBreadCrumbs=function(){try{var A=this.pathAncestors,D=this.pathBreadCrumbs,B=this.pathBreadCrumbsAncestors;A.className=A.className.replace(" hidden","");if(!this.hasClass(D,"hidden")){D.className=D.className+" hidden";}if(!this.hasClass(B,"hidden")){B.className=B.className+" hidden";}if(A&&D){this.resizePathBar();}}catch(C){microstrategy.errors.log(C);}};mstrPathImpl.prototype.showBreadCrumbs=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,C=this.pathBreadCrumbsAncestors;if(!this.hasClass(A,"hidden")){A.className=A.className+" hidden";}E.className=E.className.replace(" hidden","");if(!this.hasClass(C,"hidden")){C.className=C.className+" hidden";}this.resizeBreadCrumbs();C.style.left=mstr.$BM.position(E,true).left+"px";var B=this.id;E.onclick=function(F){microstrategy.bone(B).toggleBreadCrumbsSelector(F);};}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.toggleBreadCrumbsSelector=function(){try{var A=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");if(A){if(this.hasClass(A,"hidden")){A.className=A.className.replace(" hidden","");}else{A.className=A.className+" hidden";}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getAvailWidth=function(){try{this.pathText.style.maxWidth="0px";if(mstr.utils.ISIE8){this.pathText.style.display="none";}var K=mstr.utils.BoxModel,C=document.body.clientWidth,F=this.pathBar||this.footerBar,M=microstrategy.findChildWithAtt(F,"div","id","mstrSearchSuggest"),D=microstrategy.findChildWithAtt(F,"div","id","mstrPathAccount"),E=this.findChildByCssClass(F,"mstrFooterPathClose","div"),L=M||D||E,J=Math.min(L?K.position(L).left:C,C),I=this.findChildByCssClass(F,"mstrPathIcons"),B=0;if(I){var A=K.position(I),H=A.left+A.width,B=J-H-20;}if(mstr.utils.ISIE8){this.pathText.style.display="block";}return Math.max(B,0);}catch(G){microstrategy.errors.log(G);return 0;}};mstrPathImpl.prototype.resizePathBar=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,J=this.pathAncestor,H=this.getAvailWidth();if(D){D.style.maxWidth=H+"px";}if(J){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-15;this.curWidth=Math.min(this.pathSize/2,C.offsetWidth);var G=this.pathSize-this.curWidth;var I=parseInt(mstr.utils.CSS.getStyleValue(J,"padding-right")),F=J.scrollWidth+I,B=G>F?G-F:0;G-=B;this.curWidth+=B;J.style.maxWidth=Math.max(0,G)+"px";if((bIsDXIE)&&this.pathBar){J.style.marginLeft=-G-20+"px";}if(this.pathBar){C.style.maxWidth=Math.max(0,this.pathSize-(this.isPinned(D)?G:0))+"px";}else{C.style.maxWidth=Math.max(0,this.pathSize-G)+"px";}}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.resizeBreadCrumbs=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,G=this.pathBreadCrumbsParent,F=this.pathAncestor,H=this.availableWidth;if(D){D.style.maxWidth=H+"px";G.style.maxWidth=H+"px";C.style.maxWidth=H+"px";F.style.maxWidth=H+"px";}if(G){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-50;this.curWidth=Math.min(this.pathSize/2,C.scrollWidth);var I=this.pathSize-this.curWidth;var B=I>G.scrollWidth?I-G.scrollWidth:0;I-=B;G.style.maxWidth=Math.max(0,I)+"px";C.style.maxWidth=Math.max(0,this.pathSize-I)+"px";F.style.maxWidth=Math.max(0,I+31)+"px";}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.pinPath=function(){try{var E=" "+mstrPathImpl.PINNED_CLASS,B=this.pathText,D=this.pathAncestor,H=this.pathCurrent;if(D&&B&&this.pathBar){var C=this.isPinned(B),G=this.pathSize;if(C){B.className=B.className.replace(E,"");var A=microstrategy.bones;if(A.leftToolbar){A.leftToolbar.resize();}window.setTimeout(function(){H.style.maxWidth=G+"px";},(bIsDXIE?0:300));}else{B.className+=E;H.style.maxWidth=Math.max(0,this.curWidth)+"px";}}}catch(F){microstrategy.errors.log(F);}};mstrPathImpl.prototype.findChildByCssClass=function(F,A,D){try{if(!F){return null;}if(F.getElementsByClassName){return F.getElementsByClassName(A)[0];}else{var D=D||"div",G=new RegExp("(^|\\s)"+A+"(\\s|$)","i");if(F.tagName!=null&&F.tagName.toLowerCase()==D.toLowerCase()&&G.test(F.className)){return F;}var H=F.getElementsByTagName(D),C=H&&H.length;if(C){for(var B=0;B<C;B++){if(G.test(H[B].className)){return H[B];}}}return null;}}catch(E){microstrategy.errors.log(E);return null;}};mstrPathImpl.prototype.hasClass=function(B,A){try{return(" "+B.className+" ").indexOf(" "+A+" ")>-1;}catch(C){microstrategy.errors.log(C);return null;}};mstrPathImpl.prototype.isPinned=function(A){try{return this.hasClass(A,mstrPathImpl.PINNED_CLASS);}catch(B){microstrategy.errors.log(B);return null;}};mstrPathImpl.prototype.toggleFooterPath=function(){var C=document.getElementById("mstrWeb_footer");if(C){C.style.bottom="-41px";var B=this.id;window.setTimeout(function(){C.innerHTML="";microstrategy.unRegisterBone(B);microstrategy.eventManager.ondialogresize();},500);}var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,microstrategy.servletName+"."+microstrategy.pageName,mstrUpdateManager.actions[mstrUpdateManager.SET_PREFERENCE].paramID,["showFooterPath",0])]);};function mstrPathImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrPathCommandsImpl.prototype=new Object();mstrPathCommandsImpl.prototype.item=null;mstrPathCommandsImpl.prototype.queryEnabled=function(A){try{return true;}catch(B){microstrategy.errors.log(B);}};mstrPathCommandsImpl.prototype.queryState=function(A){try{switch(A){case"openPage":return this.item;default:microstrategy.errors.log(A+" command id not implemented.");break;}}catch(B){microstrategy.errors.log(B);}return null;};mstrPathCommandsImpl.prototype.exec=function(A,F){try{switch(A){case"openPage":var C=microstrategy.updateManager;if(C){mstrUpdateManager.addEvent({OPEN_HISTORY_PAGE:{p:[this.parentBone.openHistoryPageEventArgumentID],n:[this.parentBone.openHistoryPageEventArgumentName],i:this.parentBone.openHistoryPageEventID}});C.useIframe=false;var B=new Array();B.push(C.createActionObject(this.elem,mstrUpdateManager.OPEN_HISTORY_PAGE,microstrategy.servletName+"."+microstrategy.pageName,[this.parentBone.openHistoryPageEventArgumentID],[F]));C.add(B,true);C.flushAndSubmitChanges();}else{var D=createDynamicForm(this.parentBone.openHistoryPageEvent+F);D.method="POST";D.submit();}break;default:microstrategy.errors.log(values[0]+" command id not implemented.");break;}return true;}catch(E){microstrategy.errors.log(E);}};function mstrPathCommandsImpl(A){this.parentBone=A;return this;}mstrInlineRenameImplScript=true;mstrInlineRenameImpl.prototype=new mstrBoneImpl();mstrInlineRenameImpl.prototype.previousOnMouseDown=null;mstrInlineRenameImpl.prototype.currentRenameField=null;mstrInlineRenameImpl.prototype.originalName=null;mstrInlineRenameImpl.prototype.onload=function(){try{this.initBone();}catch(A){microstrategy.errors.log(A);return false;}};mstrInlineRenameImpl.prototype.onkeydown=function(B){try{if(!B){B=window.event;}if(B.keyCode==13){microstrategy.bone(this.parentBone.id).processRename();if(bIsIE4){window.event.cancelBubble=true;}return false;}}catch(A){microstrategy.errors.log(A);return false;}};mstrInlineRenameImpl.prototype.createRenameFields=function(H,B,A){try{var D=document.createElement("span");D.className="rename";var G=document.createElement("input");G.className="mstrInputTextRename";G.value=H;this.originalName=H;G.setAttribute("oTy",B);G.setAttribute("oId",A);G.setAttribute("cx","");G.setAttribute("type","text");G.onkeydown=new Function("e","return microstrategy.bone('"+this.parentBone.id+"').inlineRenameObject.onkeydown(e);");D.appendChild(G);this.currentRenameField=G;var C=document.createElement("img");D.appendChild(C);C.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";C.className="mstrIcon-ls mstrIconApply";C.onclick=new Function("e","return microstrategy.bone('"+this.parentBone.id+"').processRename();");C.setAttribute("rmApply","1");C.setAttribute("title",microstrategy.descriptors.getDescriptor("134"));var F=document.createElement("img");D.appendChild(F);F.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";F.className="mstrIcon-ls mstrIconCancel";F.onclick=new Function("e","return microstrategy.bone('"+this.parentBone.id+"').cancelRename();");F.setAttribute("title",microstrategy.descriptors.getDescriptor("221"));return D;}catch(E){microstrategy.errors.log(E);return null;}};mstrInlineRenameImpl.prototype.handleMouseDown=function(C){try{if(!C){C=window.event;}var A=getEventTarget(C);if(A==this.currentRenameField||A.getAttribute("rmApply")=="1"){return true;}else{this.parentBone.cancelRename();}}catch(B){microstrategy.errors.log(B);return false;}};mstrInlineRenameImpl.prototype.processRename=function(F){try{var I=this.currentRenameField;var C=I.getAttribute("oId");var D=I.getAttribute("oTy");var H=trim(I.value);if((D!=microstrategy.DSSTYPE_SHORTCUT&&H.length==0)||H==this.originalName){this.cancelRename();return ;}var E=this.parentBone.getNameTag();var G=E.lastChild;var J=new Array();J.push(microstrategy.updateManager.createActionObject(this.parentBone,mstrUpdateManager.RENAME_OBJECT,F,["1001","1002","1004"],[C,D,H]));microstrategy.updateManager.add(J);this.cancelRename();var A=this.parentBone.getNameTag();var E=(A.lastChild!=null)?A.lastChild:A;if(typeof (E.innerText)!="undefined"){E.innerText=H;}else{E.textContent=H;}microstrategy.updateManager.flushAndSubmitChanges();}catch(B){microstrategy.errors.log(B);return false;}};mstrInlineRenameImpl.prototype.cancelRename=function(){try{document.onmousedown=this.previousOnMouseDown;var A=this.parentBone.getNameTag();A.removeChild(A.lastChild);displayObj(A.lastChild);if(A.lastChild.style.display){A.lastChild.style.display="";}}catch(B){microstrategy.errors.log(B);return false;}};mstrInlineRenameImpl.prototype.enableRenameField=function(C,A){try{var B=this.parentBone.getNameTag();var G=null;if(typeof (B.innerText)!="undefined"){G=B.innerText;}else{G=B.textContent;}var F=this.createRenameFields(G,C,A);if(F!=null){removeObj(B.lastChild);B.appendChild(F);var D=this.currentRenameField;if(D){D.focus();}this.previousOnMouseDown=document.onmousedown;document.onmousedown=new Function("e","return microstrategy.bone('"+this.parentBone.id+"').inlineRenameObject.handleMouseDown(e);");}}catch(E){microstrategy.errors.log(E);return false;}};function mstrInlineRenameImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrPickerImplScript=true;mstrPickerImpl.prototype=new mstrBoneImpl();mstrPickerImpl.prototype.pulldownName="";mstrPickerImpl.prototype.targetCombodown="";mstrPickerImpl.prototype.onload=function(){try{this.currentPicker=null;this.initPulldown();}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.initPulldown=function(){var C=new Function("e","return microstrategy.bone('"+this.id+"').togglePicker(e);");var B=document.getElementById(this.pulldownName);if(!B){return ;}for(var A=0;A<B.childNodes.length;A++){if(B.childNodes[A].tagName&&B.childNodes[A].tagName.toLowerCase()=="span"){B.childNodes[A].onclick=C;}}};mstrPickerImpl.prototype.execPicker=function(C,F){try{var E=true;var B=this.getAppliesTo();var G=F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!G){G=C.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);}var A=F.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!A){A=C.getAttribute(microstrategy.HTMLATTR_CMD_ID);}if(B&&A&&B.commands.queryEnabled(A)){E=B.commands.exec(A,G);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrPickerImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.togglePicker=function(E){try{if(!E){E=window.event;}var D=getEventTarget(E);var B="";if(D.getAttribute(microstrategy.HTMLATTR_CMD_ID)==null){this.targetCombodown=findTarget(D,microstrategy.HTMLATTR_CMD_ID);B=findTarget(D,microstrategy.HTMLATTR_CMD_ID).className;}else{B=D.className;}if(D&&B.indexOf("disabled")==-1){var F=D.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);if(!F){F=D.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);}var A=document.getElementById(F);if(D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){if(B.indexOf("Selected")==-1){this.targetCombodown.className="mstrCombodownSelected";}dropDown.togglePicker(true,F,D.parentNode,this);}else{this.execPicker(A,D);}}}catch(C){microstrategy.errors.log(C);}return false;};mstrPickerImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);this.targetCombodown.className="mstrCombodown";return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);alert(A);}};mstrPickerImpl.setPickerValues=function(D,F,G){try{if(D){D="pkr"+D;}var J=F.getElementsByTagName("span");for(var E=0,B=J.length;E<B;E++){var H=J[E];var I=true;if(G){I=microstrategy.isValueInFilter(G,H.getAttribute(microstrategy.HTMLATTR_FILTER_VALUE),H.getAttribute(microstrategy.HTMLATTR_FILTER_COMPARISON));var A=H.getAttribute(microstrategy.HTMLATTR_FILTER_TYPE);if(!A||A==0){H.style.display=(I)?"block":"none";}else{H.className=(I)?"":"disabled";}}if(I&&H.getAttribute("id")==D){H.className="selected";F.selected=H;}}}catch(C){microstrategy.errors.log(C);}};function mstrPickerImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrTreeViewImplScript=true;mstrTreeViewImpl.prototype=new mstrBoneImpl();mstrTreeViewImpl.prototype.NODE_STATE_CLOSED=0;mstrTreeViewImpl.prototype.NODE_STATE_OPEN=1;mstrTreeViewImpl.prototype.NODE_STATE_LEAF=2;mstrTreeViewImpl.prototype.CSS_CLASS_OPEN="open";mstrTreeViewImpl.prototype.CSS_CLASS_CLOSED="";mstrTreeViewImpl.prototype.CSS_CLASS_LEAF="leaf";mstrTreeViewImpl.prototype.CSS_TREE_WAIT="mstrTreeWait";mstrTreeViewImpl.prototype.DIV_TREE_WAIT_ID="divTreeWait";mstrTreeViewImpl.prototype.treeName;mstrTreeViewImpl.prototype.TREE_TARGET="frameManager";mstrTreeViewImpl.prototype.TREE_ACTION;mstrTreeViewImpl.prototype.treeProcessing=false;mstrTreeViewImpl.prototype.currentlySelectedNode;mstrTreeViewImpl.prototype.lastSelectedNodeImgStyle;mstrTreeViewImpl.prototype.anchorTarget;mstrTreeViewImpl.prototype.currentContextMenuNode=null;mstrTreeViewImpl.prototype.defaultShouldProcessNode=false;mstrTreeViewImpl.prototype.onload=function(){try{this.initTree();}catch(A){microstrategy.errors.log(A);return false;}};mstrTreeViewImpl.prototype.initTree=function(){try{this.initBone();this.treeDiv=document.getElementById(this.treeName);if(this.treeDiv){this.treeDiv.onclick=new Function("e","microstrategy.bone('"+this.id+"').onClickTree(e); return false;");this.treeDiv.ondblclick=new Function("e","microstrategy.bone('"+this.id+"').onDblClickTree(e); return false;");this.treeDiv.oncontextmenu=new Function("e","microstrategy.bone('"+this.id+"').onContextMenu(e); return false;");}}catch(A){microstrategy.errors.log(A);return false;}};mstrTreeViewImpl.prototype.onreload=function(){try{mstrBoneImpl.prototype.onreload.call(this);var A=getObj(this.DIV_TREE_WAIT_ID);if(A&&!A.hasChildNodes()){this.removeTreeWaitMessage();}this.treeProcessing=false;}catch(B){microstrategy.errors.log(B);return false;}};mstrTreeViewImpl.prototype.util_findTargetTag=function(B,A){try{while(B.parentNode){if(B.tagName==A){return B;}B=B.parentNode;}return null;}catch(C){microstrategy.errors.log(C);return false;}};mstrTreeViewImpl.prototype.util_getChildNode=function(B,A){try{if((B)&&(B.childNodes.length)){for(var C=0;C<B.childNodes.length;C++){var E=B.childNodes[C];if(E.tagName==A){return E;}E=this.util_getChildNode(E,A);if(E!=null){return E;}}}return null;}catch(D){microstrategy.errors.log(D);return false;}};mstrTreeViewImpl.prototype.util_getNodeState=function(A){try{switch(A.className){case (this.CSS_CLASS_OPEN):return(this.NODE_STATE_OPEN);case (this.CSS_CLASS_LEAF):return(this.NODE_STATE_LEAF);}return(this.NODE_STATE_CLOSED);}catch(B){microstrategy.errors.log(B);return false;}};mstrTreeViewImpl.prototype.allowDisabledNodeClick=function(A){return true;};mstrTreeViewImpl.prototype.noAction=function(A){return false;};mstrTreeViewImpl.prototype.onDblClickTree=function(E){try{if(!E){E=window.event;}if(this.treeProcessing){E.returnValue=false;return ;}var C=getEventTarget(E);var B=false;if(!this.allowDisabledNodeClick(E)){return false;}if(C.tagName=="A"||C.tagName=="SPAN"){C=this.util_findTreeNode(C);if(C.getAttribute("did")!="none"){this.util_unselectNodes(C,this.elem);this.util_markNodeAsSelected(C);B=!this.noAction(E);}}if(B){this.util_processNode(C,this);}var A=microstrategy.findBone(this.elem.parentNode);if(A&&A.onDblClickTree){A.onDblClickTree(E);}E.returnValue=false;return ;}catch(D){microstrategy.errors.log(D);return false;}};mstrTreeViewImpl.prototype.onClickTree=function(D){try{if(!D){D=window.event;}if(this.treeProcessing){D.returnValue=false;return ;}var B=getEventTarget(D);if(!B){return ;}if(!this.allowDisabledNodeClick(D)){return false;}var A=this.defaultShouldProcessNode;this.hideTreeWaitMessage();if(B.tagName=="LI"){A=!this.noAction(D);}else{if(bIsIE6&&B.parentNode&&B.parentNode.tagName=="LI"){B=B.parentNode;A=!this.noAction(D);}else{if(B.tagName=="A"||B.tagName=="SPAN"){B=this.util_findTreeNode(B);if(B.getAttribute("did")=="incrementalFetch"){A=true;}else{if(B.getAttribute("did")!="none"){if(this.needDetectCtrlKey()&&D.ctrlKey){if(B.getAttribute("sel")=="1"){if(D.button==0){this.util_markNodeAsUnselected(B);}}else{if(D.button==0){this.util_checkSelectedNodes(B,this.elem);this.util_markNodeAsSelected(B,true);}}}else{if(this.util_getNodeState(B)==this.NODE_STATE_LEAF||B.getAttribute("sel")=="1"||D.shouldExpand){A=!this.noAction(D);}if(D.button==0||(D.button==2&&B.getAttribute("sel")!="1")){this.util_unselectNodes(B,this.elem);this.util_markNodeAsSelected(B);}}}}}}}if(A){D.returnValue=this.util_processNode(B,this.elem);}else{D.returnValue=false;}return ;}catch(C){microstrategy.errors.log(C);return false;}};mstrTreeViewImpl.prototype.onContextMenu=function(C){try{if(!C){C=window.event;}var A=getEventTarget(C);if(A.tagName.toLowerCase()=="a"||A.tagName.toLowerCase()=="span"){A=findTargetTag(A,"li");}if(!A){return ;}if(A.tagName.toLowerCase()=="li"){this.currentContextMenuNode=A;}else{this.currentContextMenuNode=null;}}catch(B){microstrategy.errors.log(B);return false;}};mstrTreeViewImpl.prototype.needDetectCtrlKey=function(){return true;};mstrTreeViewImpl.prototype.util_processNode=function(B,I){try{var H=this.util_findTargetTag(B,"DIV");if(!H){return true;}if(B.getAttribute("did")=="incrementalFetch"){var D=H.parentNode;var C;var G=this.util_getAnchor(B);this.util_preProcessAnchor(B,G);if(D.parentNode==I){C=D;while(D.childNodes.length){D.removeChild(D.firstChild);}}else{C=D.previousSibling;I.scrollTop=C.offsetTop;D.parentNode.removeChild(D);}var E=G.href;G.href=E;this.showTreeWaitMessage(C,"afterEnd");if(G){this.util_submitForm(G);}}else{var A=this.util_getNodeState(B);switch(A){case (this.NODE_STATE_LEAF):var G=this.util_getAnchor(B);this.util_preProcessAnchor(B,G);if(B.getAttribute("isLink")){this.util_submitForm(G);}if(G.getAttribute("dum")){return false;}else{return true;}break;case (this.NODE_STATE_OPEN):this.util_setTreeTargetState(H,this.NODE_STATE_CLOSED);break;case (this.NODE_STATE_CLOSED):if(this.util_firstNextULSibling(H)){this.util_setTreeTargetState(H,this.NODE_STATE_OPEN);}else{this.showTreeWaitMessage(H,"afterEnd");this.util_setTreeTargetState(H,this.NODE_STATE_OPEN);var G=this.util_getAnchor(B);if(G){this.util_preProcessAnchor(B,G);this.util_submitForm(G);}}break;}}return false;}catch(F){microstrategy.errors.log(F);return false;}};mstrTreeViewImpl.prototype.util_preProcessAnchor=function(A,B){if(A.getAttribute("isLink")){var C=B.getAttribute("href");B.setAttribute("href",C+"&isLink=true");if(this.anchorTarget&&this.anchorTarget!=""){B.target=this.anchorTarget;}}};mstrTreeViewImpl.prototype.util_submitForm=function(A){try{var D=A.getAttribute("href");var E=this.util_getNewTreeForm(D);var C=E.target;if(A.target){E.target=A.target;}submitForm(E);E.target=C;}catch(B){microstrategy.errors.log(B);return false;}};mstrTreeViewImpl.prototype.util_getNewTreeForm=function(A){try{A=A+"&isTreeRequest=true";var C=createDynamicForm(A);if(A.contains("iframe=true")){C.target=this.TREE_TARGET;}if(this.TREE_ACTION){C.action=this.TREE_ACTION;}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrTreeViewImpl.prototype.util_markNodeAsSelected=function(A,B){try{if(this.currentlySelectedNode&&!B){this.util_markNodeAsUnselected(this.currentlySelectedNode);}this.currentlySelectedNode=A;var D=A.getAttribute("sel");if(D=="1"){return ;}A.setAttribute("sel","1");var F=this.util_getAnchor(A);if(F){F.className="marked";var C=F.previousSibling;if(C&&C.tagName.toLowerCase()=="span"){this.lastSelectedNodeImgStyle=C.className;if(this.lastSelectedNodeImgStyle.toLowerCase()=="f"){C.className=this.lastSelectedNodeImgStyle+"_open";}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrTreeViewImpl.prototype.util_markNodeAsUnselected=function(A){try{var C=A.getAttribute("sel");if(C=="0"){return ;}A.setAttribute("sel","0");var E=this.util_getAnchor(A);if(E){E.className="";var B=E.previousSibling;if(B&&B.tagName.toLowerCase()=="span"&&this.lastSelectedNodeImgStyle){if(this.lastSelectedNodeImgStyle.toLowerCase()=="f"){B.className=this.lastSelectedNodeImgStyle;}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTreeViewImpl.prototype.util_unselectNodes=function(A,B){try{var E=B.getElementsByTagName("LI");if((E)&&(E.length)){for(var C=0;C<E.length;C++){if(E[C].getAttribute("sel")=="1"){this.util_markNodeAsUnselected(E[C]);}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTreeViewImpl.prototype.util_getAnchor=function(A){try{var C;if(A.tagName.toLowerCase()=="a"){return A;}if(A.tagName=="LI"){C=this.util_getChildNode(A.childNodes[0],"A");}else{C=this.util_getChildNode(A,"A");}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrTreeViewImpl.prototype.util_checkSelectedNodes=function(A,B){try{var G=A.getAttribute("multi");if(!G){this.util_unselectNodes(A,B);}else{var E=A.getAttribute("did");var H=B.getElementsByTagName("LI");if((H)&&(H.length)){for(var C=0;C<H.length;C++){var F=H[C];if((F.getAttribute("did")!=E)&&(F.getAttribute("sel")=="1")){var G=F.getAttribute("multi");if(!G){this.util_markNodeAsUnselected(F);}}}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTreeViewImpl.prototype.util_setTreeTargetState=function(A,C){try{if(!A){return ;}if(C==this.NODE_STATE_LEAF){if(A.childNodes[0].tagName){A.childNodes[0].className=this.CSS_CLASS_LEAF;}return ;}if(this.util_firstLIChild(A)&&this.util_firstLIChild(A).className!=this.CSS_CLASS_LEAF){this.util_firstLIChild(A).className=(C==this.NODE_STATE_OPEN)?this.CSS_CLASS_OPEN:this.CSS_CLASS_CLOSED;if(this.util_firstNextULSibling(A)){if(C!=this.NODE_STATE_OPEN){this.util_firstNextULSibling(A).style.display="none";}else{this.util_firstNextULSibling(A).style.display="block";}}}return ;}catch(B){microstrategy.errors.log(B);return null;}};mstrTreeViewImpl.prototype.util_firstNextULSibling=function(A){try{var B=A;while(B.nextSibling){if(B.nextSibling.tagName=="UL"){return B.nextSibling;}if(B.nextSibling.tagName=="DIV"){return null;}B=B.nextSibling;}return null;}catch(C){microstrategy.errors.log(C);return null;}};mstrTreeViewImpl.prototype.util_firstLIChild=function(A){try{var B;if(A.childNodes[0]){B=A.childNodes[0];}while(B){if(B.tagName=="LI"){return B;}B=B.nextSibling;}return null;}catch(C){microstrategy.errors.log(C);return null;}};mstrTreeViewImpl.prototype.util_findTreeNode=function(A){try{if(!A){return null;}if(A.tagName=="LI"){return A;}else{if(A.tagName=="A"||A.tagName=="SPAN"){return this.util_findTreeNode(A.parentNode);}}return null;}catch(B){microstrategy.errors.log(B);return null;}};mstrTreeViewImpl.prototype.showTreeWaitMessage=function(B,A){try{if(!B){return ;}this.treeProcessing=true;div=document.createElement("DIV");div.setAttribute("IFRAME","true");div.id=this.DIV_TREE_WAIT_ID;div.className=this.CSS_TREE_WAIT;div.noWrap=true;if((typeof (aDescriptor)!="undefined")&&(aDescriptor[38]!=null)){div.innerHTML=aDescriptor[38];}else{div.innerHTML=microstrategy.descriptors.getDescriptor("5674");}B.insertAdjacentElement(A,div);if(microstrategy.eventManager){microstrategy.eventManager.ondialogresize();microstrategy.eventManager.onforcerepaint();}return ;}catch(C){microstrategy.errors.log(C);return false;}};mstrTreeViewImpl.prototype.onforcerepaint=function(){try{var B=microstrategy.findAncestor(this.elem);if(B&&B.parentNode){var A=document.createElement("img");B.appendChild(A);A.parentNode.removeChild(A);}}catch(C){microstrategy.errors.log(C);}};mstrTreeViewImpl.prototype.hideTreeWaitMessage=function(){try{var B=getObj(this.DIV_TREE_WAIT_ID);if(B){if(B.previousSibling){B.previousSibling.insertAdjacentElement("afterEnd",B.childNodes[0]);}else{B.parentNode.appendChild(B.childNodes[0]);}B.parentNode.removeChild(B);}return ;}catch(A){microstrategy.errors.log(A);return false;}};mstrTreeViewImpl.prototype.removeTreeWaitMessage=function(){try{var B=getObj(this.DIV_TREE_WAIT_ID);if(B){this.treeProcessing=false;oTarget=B.previousSibling;if((oTarget!=null)&&(oTarget.firstChild!=null)){this.util_setTreeTargetState(oTarget,this.NODE_STATE_LEAF);}B.parentNode.removeChild(B);}}catch(A){microstrategy.errors.log(A);return false;}};mstrTreeViewImpl.prototype.isNodeAncestorOfCurrentlySelected=function(A){try{if(this.currentlySelectedNode){var E=this.currentlySelectedNode;var B=this.util_getChildNode(A,E.tagName);if(B==E){return false;}while(E&&E.innerHTML&&E!=A){if(E.tagName.toLowerCase()=="a"||E.tagName.toLowerCase()=="span"){E=E.parentNode.parentNode;}else{if(E.tagName.toLowerCase()=="li"){E=E.parentNode;}}if(E.tagName.toLowerCase()=="div"){if(E==A){return true;}else{E=E.parentNode;}}if(E.tagName.toLowerCase()=="ul"){var C=E.previousSibling;if(C==A){return true;}}E=E.parentNode;}}else{return false;}}catch(D){microstrategy.errors.log(D);return false;}};mstrTreeViewImpl.prototype.findParentTreeNode=function(D){try{if(!D){return ;}var E=D.parentNode;var B=E.parentNode;var A=B.previousSibling;while(A&&A.nodeType==microstrategy.HTML_TEXT_NODE_TYPE){A=A.previousSibling;}if(A&&A.tagName=="DIV"){var C=A.firstChild;if(C&&C.tagName=="LI"){return C;}else{return null;}}else{return null;}}catch(F){microstrategy.errors.log(F);return false;}};function mstrTreeViewImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrUpdateManager.prototype=new Object;mstrUpdateManager.prototype.id="bonesUpdateManager";mstrUpdateManager.prototype.observer=null;mstrUpdateManager.prototype.actions={};mstrUpdateManager.prototype.redoActions=[];mstrUpdateManager.prototype.undoActions=[];mstrUpdateManager.prototype.staticActions=[];mstrUpdateManager.prototype.useIframe=false;mstrUpdateManager.prototype.newWindow=false;mstrUpdateManager.prototype.newWindowName="_blank";mstrUpdateManager.prototype.extraURL="";mstrUpdateManager.prototype.iframeTarget="frameManager";mstrUpdateManager.prototype.formAction="";mstrUpdateManager.prototype.OPTIMIZE_EVENTS=true;mstrUpdateManager.prototype.ADD_EVENT_IDS=null;mstrUpdateManager.prototype.optActions=[];mstrUpdateManager.prototype.lastPosArray=[];mstrUpdateManager.prototype.copyActions={};mstrUpdateManager.prototype.cachedActionCollection=null;mstrUpdateManager.prototype.queueActions=false;mstrUpdateManager.prototype.forceSubmitAfterQueue=false;mstrUpdateManager.prototype.ctlCurElementsPosition=null;mstrUpdateManager.prototype.currentPanelPosition=null;mstrUpdateManager.prototype.hiddenInputs=null;mstrUpdateManager.prototype.submittedForm=null;mstrUpdateManager.prototype.submittedXhr=false;mstrUpdateManager.prototype.newActions=false;mstrUpdateManager.prototype.sTimeOutID=null;mstrUpdateManager.prototype.callback=null;mstrUpdateManager.UNIT_SEPARATOR=",";mstrUpdateManager.ITEM_SEPARATOR=";";mstrUpdateManager.UPDATE_LATER="0";mstrUpdateManager.UPDATE_NOW="1";mstrUpdateManager.STATIC_ACTION=-1;mstrUpdateManager.ARG_KEY_SEPARATOR="_";mstrUpdateManager.addEvent=function(A){if(!mstrUpdateManager.actions){mstrUpdateManager.actions={};}for(var B in A){var C=A[B].i;mstrUpdateManager[B]=C;mstrUpdateManager.actions[C]={eventID:C,paramName:A[B].n,paramID:A[B].p};}mstrUpdateManager.newActions=true;};mstrUpdateManager.prototype.addSingleAction=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection.push(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getUseIFrame=function(){try{return this.useIframe;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setUseIFrame=function(B){try{this.useIframe=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getNewWindowSetting=function(){try{return this.newWindow;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setNewWindowSetting=function(B){try{this.newWindow=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.addActionCollection=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection=this.cachedActionCollection.concat(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.hasCachedActions=function(){try{return(this.cachedActionCollection&&this.cachedActionCollection.length>0);}catch(A){microstrategy.errors.log(A);}return false;};mstrUpdateManager.prototype.addCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.add(this.cachedActionCollection,false);this.cachedActionCollection=null;if(this.forceSubmitAfterQueue){this.flushAndSubmitChanges();}}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.killCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.cachedActionCollection=null;}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.add=function(C,A){try{if(this.queueActions){if(C.length){this.addActionCollection(C);}else{this.addSingleAction(C);}}else{if(A){this.staticActions.push(C);this.redoActions.unshift(mstrUpdateManager.STATIC_ACTION);this.newActions=true;}else{this.clearRedoActions();this.undoActions.push(C);this.newActions=true;}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","add",C);if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.addURL=function(A){try{if(A){if(this.extraURL.length>0){this.extraURL+="&"+A;}else{this.extraURL=A;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.replaceURL=function(A,D){try{if(this.extraURL.length>0){if(this.extraURL.indexOf(A)>-1){var E=this.extraURL.substring(0,this.extraURL.indexOf(A)-2);var C=this.extraURL.indexOf("&",this.extraURL.indexOf(A));if(E==null||E.length==0){E="";}else{E+="&";}if(C>this.extraURL.indexOf(A)){this.extraURL=E+this.extraURL.substring(C+1,this.extraURL.length)+"&"+A+"="+D;}else{this.extraURL=A+"="+D;}}else{this.extraURL+="&"+A+"="+D;}}else{this.extraURL=A+"="+D;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.processUndoRedo=function(C,D){try{while(C.length>0){var B=C.pop();D.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;}}}catch(A){microstrategy.errors.log(A);}return null;};mstrUpdateManager.prototype.broadcastUpdate=function(){try{while(source.length>0){var B=source.pop();target.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;break;}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.undo=function(C){try{var D=false;C=C||1;for(var A=0;A<C;A++){var F=this.processUndoRedo(this.undoActions,this.redoActions);if(F){for(var B=0;B<F.length;B++){microstrategy.eventManager.notifyOrphanBones("onundo",new mstrUndoObj(F[B]));}D=true;}}if(D){microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","undo");}if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.redo=function(){try{var C=this.processUndoRedo(this.redoActions,this.undoActions);if(C){for(var A=0;A<C.length;A++){microstrategy.eventManager.notifyOrphanBones("onredo",new mstrRedoObj(C[A]));}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","redo");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.getPendingEventsForTask=function(A){var E;var J;var B=0;var N=[];var D=A.split(".");var C=D[D.length-1];var F=this.optActions;this.optActions=[];if(this.OPTIMIZE_EVENTS){for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;this.createOptimizedArray(H);G.splice(M,1);M=M-1;}}}for(var I=0;I<this.optActions.length;I++){if(this.optActions[I].id!=null){N.push(this.createEventForAction(this.optActions[I]));}}this.postOptimizationCleanup();}else{for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;N.push(this.createEventForAction(H));G.splice(M,1);M=M-1;}}}}this.optActions=F;if(N.length>0){var L=new mstrSerializer();L.addValues(N);return L.getState();}else{return"";}};mstrUpdateManager.prototype.flushChanges=function(I){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){addURLAsHiddenInputsToForm(I,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){this.createOptimizedArray(D[H]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){J.push(this.createEventForAction(D[H]));}}}var G=new mstrSerializer();G.addValues(J);if(I.getAttribute("hasUpdateChanges")=="true"){updateDynamicInput(I,mstrUpdateManager.multipleEventArgName,G.getState());}else{this.submittedForm=I;this.hiddenInputs=[];this.createHiddenInput(I,mstrUpdateManager.multipleEventArgName,G.getState());this.createHiddenInput(I,"evt",mstrUpdateManager.multipleEventID);this.createHiddenInput(I,"src",mstrUpdateManager.multipleEventSrc);this.createHiddenInput(I,mstrUpdateManager.multipleEventID,"1");I.setAttribute("hasUpdateChanges","true");}if(this.newWindow){I.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.flushChangesAsParams=function(G){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){UpdateHelper.addURLToParams(G,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){this.createOptimizedArray(D[I]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){J.push(this.createEventForAction(D[I]));}}}var H=new mstrSerializer();H.addValues(J);if(G.hasUpdateChanges=="true"){G[mstrUpdateManager.multipleEventArgName]=H.getState();}else{this.submittedXhr=true;UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventArgName,H.getState());UpdateHelper.addAdditionalParam(G,"evt",mstrUpdateManager.multipleEventID);UpdateHelper.addAdditionalParam(G,"src",mstrUpdateManager.multipleEventSrc);UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventID,"1");G.hasUpdateChanges=="true";}if(this.newWindow){G.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.createHiddenInput=function(D,B,C){var A=createHiddenInput(D,B,C);this.hiddenInputs.push(A);};mstrUpdateManager.prototype.postOptimizationCleanup=function(A){if(this.fullScreenModePosition){delete this.fullScreenModePosition;}if(this.lTbarBrowserSettingPosition){delete this.lTbarBrowserSettingPosition;}if(this.ctlCurElementsPosition){delete this.ctlCurElementsPosition;}if(this.currentPanelPosition){delete this.currentPanelPosition;}if(this.widgetPropEdits){delete this.widgetPropEdits;}this.optActions=[];this.lastPosArray=[];};mstrUpdateManager.prototype.createEventForAction=function(G){try{var A=mstrUpdateManager.actions[G.id];var E=new mstrSerializer();E.addStr(A.eventID);E.addStr(G.beanPath+"."+A.eventID);var D="";for(var C=0;C<G.newArgs.length;C++){actionID=G.argID[C];for(var B=0;B<A.paramID.length;B++){if(A.paramID[B]==actionID){if(false){D+="<arg name='"+A.paramName[B]+"' v='"+G.newArgs[C]+"' />";}if(G.argKey==null){E.addStr(A.paramName[B]);}else{E.addStr(A.paramName[B]+mstrUpdateManager.ARG_KEY_SEPARATOR+G.argKey);}E.addStr(G.newArgs[C]);break;}}}if(false){alert(D);}return E.getState();}catch(F){microstrategy.errors.log(F);return false;}};mstrUpdateManager.prototype.flushAndSubmitChanges=function(C,H){this.callback=H||{};var B=this,G=this.callback.success,F=this.callback.noRefresh;this.callback.success=function(I){if(G){G(I);}if(!F&&I&&I.status=="6"){B.refreshPage();}};try{if(useXHR&&!C){mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var A=UpdateHelper.createParamsFromURL(this.getFormAction(),this.useIframe&&!this.newWindow);this.flushing=true;UpdateHelper.submitRequest(A);}else{mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var D=createDynamicForm(this.getFormAction());if(this.useIframe&&!this.newWindow){addURLAsHiddenInputsToForm(D,"iframe=true");D.target=this.iframeTarget;}this.flushing=true;submitForm(D,C);}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.acknowledgeRequest=function(){try{this.undoActions=[];this.redoActions=[];this.staticActions=[];this.optActions=[];this.lastPosArray=[];this.copyActions={};this.newWindow=false;microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}var B;if(this.submittedForm!=null){for(var A=0;A<this.hiddenInputs.length;A++){B=this.hiddenInputs[A];try{this.submittedForm.removeChild(B);}catch(C){if((C&&C.code!=8)&&(C.number&&C.number!=-2147024809)){throw (C);}}}this.submittedForm.setAttribute("hasUpdateChanges","false");this.submittedForm=null;this.hiddenInputs=null;this.flushing=false;}if(this.submittedXhr){this.submittedXhr=false;this.flushing=false;}}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.isFlushing=function(){return !!this.flushing;};mstrUpdateManager.prototype.acknowledgeReloadEnd=function(){if(this.observer){this.observer.notifyAll("acknowledgeReloadEnd");}};mstrUpdateManager.prototype.getFixStateActions=function(){try{var E=[];for(var B=0;B<this.staticActions.length;B++){var D=this.staticActions[B];for(var A=0;A<D.length;A++){E.push(D[A]);}}return E;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.hasChangesToSubmit=function(){try{return(this.undoActions.length>0||this.isRedoStatic()||(this.extraURL!=null&&this.extraURL.length>0));}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.hasNewChanges=function(){try{var A=this.newActions;this.newActions=false;return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.clearRedoActions=function(){try{while(this.redoActions.length>0){var B=this.redoActions.pop();if(B==mstrUpdateManager.STATIC_ACTION){this.undoActions.push(B);}}}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.getLastAction=function(){try{return this.undoActions.pop();}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.isRedoStatic=function(){try{var C=false;for(var A=0;A<this.redoActions.length;A++){if(this.redoActions[A]==mstrUpdateManager.STATIC_ACTION){C=true;break;}}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.anyNonStatic=function(B){try{var A=(B)?this.redoActions:this.undoActions;var E=false;for(var C=0;C<A.length;C++){if(A[C]!=mstrUpdateManager.STATIC_ACTION){E=true;break;}}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createActionObject=function(C,A,G,H,B,F,J,I){try{var E={};E.elem=C;E.id=A;E.beanPath=G;E.argID=H;E.newArgs=B;E.oldArgs=F;E.cachedArray=J;E.argKey=I;if(A==mstrUpdateManager.EDIT_PROPS){E.formatType=microstrategy.formatType;E.argID.push("2048131");E.newArgs.push(microstrategy.formatType);E.oldArgs.push(microstrategy.formatType);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createOptimizedArray=function(G){try{var I=G.id;if(!this.ADD_EVENT_IDS){this.ADD_EVENT_IDS=mstrUpdateManager.ADD_TEXT+"|"+mstrUpdateManager.ADD_LINE+"|"+mstrUpdateManager.ADD_SHAPE+"|"+mstrUpdateManager.ADD_TEMPLATE+"|"+mstrUpdateManager.ADD_DATASET_TEMPLATE+"|"+mstrUpdateManager.ADD_IMAGE+"|"+mstrUpdateManager.ADD_HTML_CONTAINER+"|"+mstrUpdateManager.ADD_PANEL_STACK+"|"+mstrUpdateManager.CTRL_ADD+"|";}var N=(G.elem)?G.elem.id:null;var B=N;if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="4146"){B=N+G.newArgs[K].split("!")[0]+G.newArgs[K].split("!")[1]+G.newArgs[K].split("!")[2];break;}}}var P;if(I==mstrUpdateManager.EDIT_PROPS){for(var K=0,D=G.argID.length;K<D;K++){if(G.argID[K]=="2048035"){var J=G.newArgs[K].split(mstrUpdateManager.UNIT_SEPARATOR);if(J[1]=="FormattingWidget"&&J[2]=="WidgetProps"){var C=this.widgetPropEdits||{};if(J[0] in C){this.optActions[C[J[0]]].id=null;}C[J[0]]=this.optActions.length;this.widgetPropEdits=C;}break;}}this.optActions.push(G);}else{if(I==mstrUpdateManager.COPY_TO_CLIPBOARD||I==mstrUpdateManager.CUT_TO_CLIPBOARD){P=G.newArgs[0].split(CLIPBOARD_ITEM_SEPARATOR);for(var K=0;K<P.length;K++){this.copyActions[P[K]]={};this.copyActions[P[K]].position=this.optActions.length;this.copyActions[P[K]].applied=false;}this.optActions.push(G);}else{if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES||I==mstrUpdateManager.EDIT_TEXT||I==mstrUpdateManager.SET_TOPLEFT_POSITION||I==mstrUpdateManager.CHANGE_BONE_PROPERTY){if(!this.lastPosArray[I]){this.lastPosArray[I]={};}if(this.copyActions[N]&&this.copyActions[N].applied==false){this.copyActions[N].applied=true;for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}else{if(this.lastPosArray[I][B]){var L=this.lastPosArray[I][B].position;var F=this.optActions[L];var H=mstr.$A.find(F.argID,"2048007");if(H==-1){H=null;}var M=mstr.$A.find(F.argID,"2048007");if(M==-1){H=null;}if(M==H){F.newArgs=G.newArgs;}else{this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}else{this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}}else{if(I==mstrUpdateManager.REMOVE_OBJECT){if(this.copyActions[N]){for(var K=this.copyActions[N].position;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N){this.optActions[K].id=null;}}delete this.copyActions[N];for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}}else{for(var K=0;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N&&!this.ADD_EVENT_IDS.contains(this.optActions[K].id,"|")){this.optActions[K].id=null;}}}this.optActions.push(G);}else{if(I==mstrUpdateManager.SWITCH_FULL_SCREEN_MODE){if(typeof (this.fullScreenModePosition)!="undefined"&&this.optActions[this.fullScreenModePosition]&&this.optActions[this.fullScreenModePosition].newArgs&&this.optActions[this.fullScreenModePosition].id==I){this.optActions[this.fullScreenModePosition].newArgs=G.newArgs;}else{this.fullScreenModePosition=this.optActions.length;this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING){if(G.argID[0]=="5005"&&G.newArgs[0]=="lTbar"){if(typeof (this.lTbarBrowserSettingPosition)!="undefined"&&this.optActions[this.lTbarBrowserSettingPosition]&&this.optActions[this.lTbarBrowserSettingPosition].newArgs){this.optActions[this.lTbarBrowserSettingPosition].newArgs=G.newArgs;}else{this.lTbarBrowserSettingPosition=this.optActions.length;this.optActions.push(G);}}else{this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_CUR_CTL_ELEMENTS){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="2048130"){this.ctlCurElementsPosition=this.ctlCurElementsPosition||{};var A=G.newArgs[K];if(A in this.ctlCurElementsPosition){this.optActions[this.ctlCurElementsPosition[A]].id=null;}this.ctlCurElementsPosition[A]=this.optActions.length;this.optActions.push(G);break;}}}else{if(I==mstrUpdateManager.SET_CURRENT_PANEL){var O=G.newArgs[0];if(!this.currentPanelPosition){this.currentPanelPosition={};}if(typeof (this.currentPanelPosition[O])!="undefined"){this.optActions.splice(this.currentPanelPosition[O],1);}this.currentPanelPosition[O]=this.optActions.length;this.optActions.push(G);}else{this.optActions.push(G);}}}}}}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.getFormAction=function(){if(!this.formAction){this.formAction=microstrategy.servletName;}return this.formAction;};mstrUpdateManager.prototype.setFormAction=function(A){this.formAction=A;};mstrUpdateManager.createPropertyEditString=function(C,B,G,A,H){try{var F=mstrFormatObject;if(!F){return"";}if(!A){G=F.encodeValue(B,G);}var D=C||"";if(D){D+=mstrUpdateManager.UNIT_SEPARATOR;}return D+(H||F.getPropertySetName(B))+mstrUpdateManager.UNIT_SEPARATOR+F.getPropertyName(B)+mstrUpdateManager.UNIT_SEPARATOR+G+mstrUpdateManager.ITEM_SEPARATOR;}catch(E){microstrategy.errors.log(E);return"";}};mstrUpdateManager.prototype.createEditPropsAction=function(F,J,S,I,Q,D,A,L,K,R){try{var E=(A)?mstrUpdateManager.UPDATE_NOW:mstrUpdateManager.UPDATE_LATER;var M=mstrUpdateManager.createPropertyEditString;var O=K?"1":"0";var H="",C="";for(var N=0;N<I.length;N++){H+=M(J,I[N],Q[N],R);if(D&&(N in D)){C+=M(J,I[N],D[N]);}}var B=K?["2048018","2048035","2048241"]:["2048018","2048035"],G=K?[E,H,O]:[E,H];return this.createActionObject(F,mstrUpdateManager.EDIT_PROPS,S,B,G,(C&&[E,C])||[],L);}catch(P){microstrategy.errors.log(err);return null;}};mstrUpdateManager.prototype.findRwbInputOnPageStateForm=function(){var C=getObj("pageStateForm");var B=C.getElementsByTagName("INPUT");for(i=0,cnt=B.length;i<cnt;i++){var A=B[i];if(A.name==="rwb"){return A;}}return null;};mstrUpdateManager.prototype.getRWBState=function(A){if(A){var B=this.findRwbInputOnPageStateForm();if(B){return B.value;}}else{if(pageState){var C=(pageState+"&").match(/rwb=(.*?)\&/);if(C!=-1){return C[1];}}}return"";};mstrUpdateManager.prototype.setRWStateInForm=function(A){var B=this.findRwbInputOnPageStateForm();if(B){B.value=A;}};mstrUpdateManager.prototype.refreshPage=function(){try{this.useIframe=false;var B=this.createActionObject(null,mstrUpdateManager.PAGE_REFRESH,microstrategy.servletName+"."+microstrategy.pageName,[],[],[],null);this.add([B],true);this.flushAndSubmitChanges();}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.submitPartialUpdate=function(C){try{microstrategy.puStatus=0;iframe.notifyParent(true);if(!this.partialUpdateModel){this.partialUpdateModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.partialUpdateModel);var A=this.partialUpdateModel&&this.partialUpdateModel&&this.partialUpdateModel.init();if(!("id" in this)||!mstr.$obj(this.id)){mstr.controllers.Factory.add(this);}this.partialUpdateModel.attachEventListener(this,"set_readyState","handleStateChange");}C.processorClass=mstr.http.PUProcessor;this.partialUpdateModel.execSubmit({params:C,callback:this.callback});}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.handleStateChange=function(evt){try{switch(evt.memo.value){case mstr.Enum.Widget.READYSTATE.TIMEOUT:case mstr.Enum.Widget.READYSTATE.ERROR:break;case mstr.Enum.Widget.READYSTATE.SUCCESS:var updateResult=evt.src.get("requestContext").response.data;if(updateResult){if(updateResult.status=="2"){iframe.showWaitPage();}else{iframe.hideWaitPage();}UpdateHelper.replaceComponents(updateResult.components);document.title=updateResult.title;if(updateResult.status=="2"){this.doRedirect(updateResult.redirectURL,updateResult.waitSeconds);}microstrategy.eventManager.executeFunction("microstrategy.eventManager.onreload()");if(updateResult.script){eval(updateResult.script);}microstrategy.puStatus=1;}else{if(window.document.readyState=="complete"){var sMarkup=evt.src.get("requestContext").response.text;if(bIsIE6&&!bIsIE7){document.write(sMarkup);}else{var oNewDoc=window.document.open("text/html");if(sMarkup.indexOf("<!DOCTYPE")==-1){oNewDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd " >');}oNewDoc.write(sMarkup);oNewDoc.close();}}}delete this.callback;break;}}catch(err){microstrategy.errors.log(err);}};mstrUpdateManager.prototype.doRedirect=function(C,A){try{this.sTimeOutID=window.setTimeout('microstrategy.updateManager.timedRedirect("'+C+'")',A*1000);}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.timedRedirect=function(C){try{window.clearTimeout(this.sTimeOutID);var A=UpdateHelper.createParamsFromURL(C);UpdateHelper.submitRequest(A);}catch(B){microstrategy.errors.log(B);}};function mstrUpdateManager(){this.commands=new UpdateManagerCommands(this);if(typeof (mstrObserverImpl)!="undefined"){this.observer=new mstrObserverImpl();}return this;}if(typeof (microstrategy)!="undefined"){microstrategy.updateManager=new mstrUpdateManager();}mstrUndoObj.prototype={};function mstrUndoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.oldArgs;this.cachedArray=A.cachedArray;return this;}mstrRedoObj.prototype={};function mstrRedoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.newArgs;this.cachedArray=A.cachedArray;return this;}function UpdateManagerCommands(A){this.queryVisible=function(B){return true;};this.queryEnabled=function(B){switch(B){case"redo":return A.anyNonStatic(true);case"undo":return A.anyNonStatic(false);case"apply":return A.hasChangesToSubmit();default:return false;}};this.queryState=function(B){return false;};this.exec=function(B,C){switch(B){case"redo":return A.redo();case"undo":return A.undo();case"apply":A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return A.flushAndSubmitChanges();default:return false;}};return this;}var UpdateHelper=new function(){};UpdateHelper.prototype=new Object();UpdateHelper.createParamsFromURL=function(B,G){var C={method:"post"};var H=B.indexOf("?")>0;var F=B.indexOf("#")>0;var E=(B.indexOf("iframe=true")>0||G);var D=((H)?B.substring(0,B.indexOf("?")):B);if(F){var A="";B=moveAnchor(B);A=B.substring(B.indexOf("#"));D=D.replace(A,"")+A;B=B.substring(0,B.indexOf("#"));}D=microstrategy.addJSessionID(D);if(H){UpdateHelper.addURLToParams(C,B);}C.iframe=(E)?"true":"false";C.action=D;return C;};UpdateHelper.createParamsFromForm=function(I,J,F,H){var G=getObj(I);var C=microstrategy.findChildrenWithAtt(G,["INPUT","SELECT","TEXTAREA"],"name");var B={action:G.action,method:G.method};if(typeof G.target!=undefined){B.target=G.target;}for(var D=0;D<C.length;D++){var A=C[D];if(H===true&&A.ps===true){continue;}if(A.type=="select-multiple"&&A.options&&A.options.length>0&&A.disabled!=true){for(var E=0;E<A.options.length;E++){if(UpdateHelper.shouldSubmit(A.options[E])){UpdateHelper.addAdditionalParam(B,A.name,A.options[E].value);}}}else{if(UpdateHelper.shouldSubmit(A)){UpdateHelper.addAdditionalParam(B,A.name,A.value);}}}if(J){B[J]=F;}return B;};UpdateHelper.shouldSubmit=function(A){if(A.disabled==true){return false;}if(A.type=="submit"||A.type=="button"||A.type=="image"||A.value=="undefined"){return false;}if(A.type=="radio"||A.type=="checkbox"){if(!A.getAttribute("agg")){return A.checked;}else{A.value=A.checked?"true":"false";return true;}}if(A.tagName.toLowerCase()=="option"){return A.selected;}return true;};UpdateHelper.addURLToParams=function(D,F,C){F=F.substring(F.indexOf("?")+1,F.length);var G=F.split("&");var I="";var E="";var A="";var H=/\+/g;for(var B=0;B<G.length;B++){I=G[B].split("=");E=I[0];A=I[1];if(A){A=decodeURIComponent(A.replace(H," "));}if(C){D[E]=A;}else{UpdateHelper.addAdditionalParam(D,E,A);}}return false;};UpdateHelper.addAdditionalParam=function(A,B,C){if(A[B]&&typeof A[B]!="object"){A[B]=[A[B],C];}else{if(A[B]&&A[B].push){A[B].push(C);}else{A[B]=C;}}};UpdateHelper.submitRequest=function(H){var N=getObj("pageStateForm");var E=null;var I=null;var G;var F;var C;var O;UpdateHelper.appendPageStateToParams(H);if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){var L=microstrategy.bones.rwb_viewer;H.docSelections=L.commands.queryState("selectionsKey");L.adjustScrollValues();H.viewerScroll=L.dScrollTop+","+L.dScrollLeft;H.isLocked=(L.insertionControlLocked)?1:0;var M=L.doc.currentControlSubtype?"|"+L.doc.currentControlSubtype:"";H.currentControl=L.doc.currentControl+M;}if(typeof (microstrategy)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){for(var A in microstrategy.bones){if(microstrategy.bones[A]!=null&&microstrategy.bones[A].type==microstrategy.OBJTYPE_GRID){var B=microstrategy.bones[A];if(B&&B.gridStructureInfo&&!B.gridStructureInfo.emptyCase&&!B.gridStructureInfo.isEmptyTemplate){if(B.isGrid){var K=B.commands.queryState("selections");if(K){H[B.id]=K;}}if(B.isGraph&&A.indexOf("_graph")==-1){H[B.id+"_gs"]=B.commands.queryState("graphSelections");}}}}}if(H.iframe=="true"){microstrategy.updateManager.submitPartialUpdate(H);}else{var J=UpdateHelper.createFormFromParams(H);UpdateHelper.appendPageSizeToParams(J);if(mstr.utils.ISSAFARI&&J.target=="_blank"){J.action+=(J.action.indexOf("?")==-1?"?":"&");J.action+="t="+new Date().getTime();}try{microstrategy.submitForm(J);}catch(D){if(J.target!=""&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){showMessage({contents:microstrategy.descriptors.getDescriptor("5877"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.errors.log(D);}}}return false;};UpdateHelper.createFormFromParams=function(A){var C=document.createElement("FORM");C.name="dynamic_form";C.method=A.method;delete A.method;C.action=A.action;delete A.action;if(typeof A.target!="undefined"){C.target=A.target;delete A.target;}C.setAttribute("hasUpdateChanges",A.hasUpdateChanges=="true");for(var D in A){if(A[D]){if(typeof A[D]=="object"){for(var B=0;B<A[D].length;B++){if(A[D][B]){createHiddenInput(C,D,A[D][B]);}}}else{createHiddenInput(C,D,A[D]);}}}document.body.insertAdjacentElement("beforeEnd",C);return C;};UpdateHelper.submitFormThroughXHR=function(B,D){if(D){if(!B){B=window.event;}var B=getEventTarget(B);if(!B){return false;}}var F=microstrategy.findAncestorWithTag(B,"FORM");var C=B.name;var A=B.value;if(typeof F=="undefined"||typeof C=="undefined"||typeof A=="undefined"){return false;}var E=UpdateHelper.createParamsFromForm(F,C,A,true);UpdateHelper.appendPageStateToParams(E);microstrategy.updateManager.submitPartialUpdate(E);return false;};UpdateHelper.appendPageStateToParams=function(A){var E=getObj("pageStateForm");var D=null;var B=(typeof (microstrategy)!="undefined")?microstrategy.updateManager:null;var C;if(B&&B.hasChangesToSubmit()){B.flushChangesAsParams(A);UpdateHelper.addEvtOrderToParams(A,mstrUpdateManager.multipleEventID);}if(E){if(A.method=="get"||A.method=="GET"){UpdateHelper.addURLToParams(A,pageState,true);}else{D=E.getElementsByTagName("INPUT");for(C=0;C<D.length;C++){A[D[C].name]=D[C].value;}}}};UpdateHelper.appendPageSizeToParams=function(A){createHiddenInput(A,"innerWidth",getClientWidth());createHiddenInput(A,"innerHeight",getClientHeight());};UpdateHelper.submitLink=function(F){var H;H=F.href;var C;C=F.target;var G=document.getElementById("cssAnalyzerToolbar");var A=(getCookie(ENABLE)=="true")&&(G!=null);if(A){return false;}window.mstrSubmitLink=true;if(C=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){var B=UpdateHelper.createParamsFromURL(H);if(C){B.target=C;}UpdateHelper.submitRequest(B);return false;}if(typeof (pageState)!="undefined"){var D=updateLink(H);D=moveAnchor(D);var E=null;if(bIsIE6&&F.childNodes&&(F.childNodes.length==1)&&F.childNodes[0].nodeType==3){E=F.innerHTML;}F.href=D;if(bIsIE6&&E!=null){F.innerHTML=E;}return true;}else{return true;}};UpdateHelper.addEvtOrderToParams=function(A,B,C){if(A.evtorder){if(A.evtorder.indexOf(B)<0){if(C){A.evtorder=A.evtorder+","+B;}else{A.evtorder=B+","+A.evtorder;}A[B]="1";}}else{A.evtorder=B;if(A.evt&&A.evt.length<3){for(j=0;j<A.evt.length;j++){A[A.evt[j]]="1";}}}};UpdateHelper.replaceComponents=function(A,G){try{if(!G){iframe.consolidatedStyles={};iframe.isProcessing=true;if(!bIsW3C){iframe.togglePulldownChildren(document.body,false);}}var C;for(C=0;C<A.length;C++){var F=A[C];if(F&&F.ISEMPTY!="true"){if(F.errBox!="true"||currentModalEditor.length==0){UpdateHelper.updateComponent(F,G);}else{var E=F.content;if(E.length>0){showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}}}}if(!G){for(var B in iframe.consolidatedStyles){updateStyleContainer(iframe.consolidatedStyles[B],B);}if(!bIsW3C){iframe.togglePulldownChildren(document.body,true);}iframe.targets=null;microstrategy.loadDynamicJS();microstrategy.registerNewBones();}}catch(D){microstrategy.errors.log(D);}};UpdateHelper.updateComponent=function(cB,parentId){try{var sReplaceHTML;var aScripts=null;var j;var oParentDiv;if(!cB.id){return ;}if(cB.components&&cB.components.length>1){UpdateHelper.replaceComponents(cB.components,cB.id);return ;}else{if(cB.components&&cB.components.length==1){return ;}}if(cB.slid){var slices=document.getElementsByName(cB.id);if(slices&&slices.length>0){for(var i=0,len=slices.length;i<len;i++){if(slices[i].getAttribute("slid")==cB.slid){oParentDiv=slices[i];break;}}}}if(!oParentDiv){var oParentDivs=document.getElementById(cB.id);if(!oParentDivs&&(cB.dialog||cB.css=="1")){iframe.createPlaceHolder(cB.id);oParentDivs=document.getElementById(cB.id);}if(oParentDivs){if(oParentDivs.length>1){for(var i=0;i<oParentDivs.length;i++){if(oParentDivs[i].tagName=="DIV"){oParentDiv=oParentDivs[i];break;}}}else{oParentDiv=oParentDivs;}}}if(oParentDiv){var sReplaceHTML=cB.content.replace(/'/g,"'");if(cB.message=="true"){showMessage({contents:sReplaceHTML,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}var scriptArray=[],chartArray=[];var oDivNode=iframe.createElementFromHTML(sReplaceHTML);if(!oDivNode){return ;}iframe.extractScript(oDivNode,scriptArray);iframe.extractImage(oDivNode,chartArray);if(cB.errorInfo){var errorHolder=document.getElementById("errorInfo");if(errorHolder){errorHolder.innerHTML+=cB.errorInfo;}}if(cB.css=="1"){var styleId=oDivNode.getAttribute("styleid");if(!iframe.consolidatedStyles[styleId]){iframe.consolidatedStyles[styleId]=[];}iframe.consolidatedStyles[styleId]=consolidateStyleSheets(oDivNode,iframe.consolidatedStyles[styleId],styleId);}else{if(oParentDiv.getAttribute(mstrHTMLAttributes.ATTR_MODAL)=="true"||(oParentDiv.popupMask)){togglePulldowns(oParentDiv,true);}if(cB.partialUpdate=="true"&&oParentDiv.childNodes.length>1){oParentDiv.innerHTML=oDivNode.innerHTML;}else{if(bIsW3C&&!bIsIE8&&!bIsIE9&&!bIsIE10&&!bIsSafari){iframe.setOuterHTML(oParentDiv,oDivNode);}else{if(oParentDiv&&oDivNode){if(cB.isFlashVis&&bIsIE8){var o=oParentDiv.getElementsByTagName("object");if(o&&o.length>0){for(var i=0;i<o.length;i++){o[i].parentNode.removeChild(o[i]);}}}oParentDiv.parentNode.replaceChild(oDivNode,oParentDiv);}if(chartArray.length>0){for(var j=0,cnt=chartArray.length;j<cnt;j++){chartArray[j].src=chartArray[j].getAttribute("dsrc");}}}}for(var i=0,len=scriptArray.length;i<len;i++){eval(scriptArray[i].toString());}}}}catch(err){microstrategy.errors.log(err);}};mstrContextMenuManagerImpl.prototype=new Object();contextMenuManagerScript=true;mstrContextMenuManagerImpl.prototype.id=null;mstrContextMenuManagerImpl.prototype.dynamic_menus=new Array;mstrContextMenuManagerImpl.prototype.menu_items=new Array;microstrategy.contextMenuManagers=new Array;microstrategy.unloadContextMenuManager=function(B){for(var A=0;A<microstrategy.contextMenuManagers.length;A++){if(microstrategy.contextMenuManagers[A].id==B){microstrategy.contextMenuManagers.splice(A,1);}}};microstrategy.getContextMenuManager=function(B){for(var A=0;A<microstrategy.contextMenuManagers.length;A++){if(microstrategy.contextMenuManagers[A].id==B){return microstrategy.contextMenuManagers[A];}}var C=new mstrContextMenuManagerImpl(B);microstrategy.contextMenuManagers.push(C);return C;};mstrContextMenuManagerImpl.prototype.getMenu=function(D){var C,A;try{if(D){for(C=0;C<this.dynamic_menus.length;C++){if(this.dynamic_menus[C]!=null){if(this.dynamic_menus[C][0]==D){return new mstrContextMenuImpl(this.id,this.menu_items,this.dynamic_menus[C][1]);}}}}var B=this.dynamic_menus.length;this.dynamic_menus[B]=new Array;this.dynamic_menus[B][0]=D;this.dynamic_menus[B][1]=new Array;return new mstrContextMenuImpl(this.id,this.menu_items,this.dynamic_menus[B][1]);}catch(E){microstrategy.errors.log(E);return false;}};mstrContextMenuManagerImpl.prototype.findMenuItem=function(C,B){try{var A=new Array();if(B!=null){for(i=0;i<B.length;i++){if(this.menu_items[B[i]][0]==C){A.push(this.menu_items[B[i]]);}}}else{for(i=0;i<this.menu_items.length;i++){if(this.menu_items[i][0]==C){A.push(this.menu_items[i]);}}}return A;}catch(D){microstrategy.errors.log(D);return false;}};function mstrContextMenuManagerImpl(key){try{if(key){if(eval("(typeof("+key+") != 'undefined')")){this.menu_items=eval(key);}if(eval("(typeof("+key+"_dyn) != 'undefined')")){this.dynamic_menus=eval(key+"_dyn");}this.id=key;}return this;}catch(err){microstrategy.errors.log(err);return false;}}mstrFolderTreeViewImplScript=true;mstrFolderTreeViewImpl.prototype=new mstrTreeViewImpl();mstrFolderTreeViewImpl.prototype.folderBeanPath;mstrFolderTreeViewImpl.prototype.inlineRenameObject=null;mstrFolderTreeViewImpl.prototype.folderHref=null;mstrFolderTreeViewImpl.prototype.serverName=null;mstrFolderTreeViewImpl.prototype.projectName=null;mstrFolderTreeViewImpl.prototype.portNum=null;mstrFolderTreeViewImpl.prototype.processRename=function(){try{if(this.inlineRenameObject){this.inlineRenameObject.processRename(this.folderBeanPath);this.inlineRenameObject=null;}this.currentContextMenuNode.parentNode.className="";}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderTreeViewImpl.prototype.cancelRename=function(){try{if(this.inlineRenameObject){this.inlineRenameObject.cancelRename();this.inlineRenameObject=null;}this.currentContextMenuNode.parentNode.className="";}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderTreeViewImpl.prototype.getNameTag=function(){try{var A=this.currentContextMenuNode.firstChild;return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrFolderTreeViewImpl.prototype.enableRenameField=function(){try{if(this.currentContextMenuNode){this.inlineRenameObject=new mstrInlineRenameImpl();this.inlineRenameObject.parentBone=this;var A=this.currentContextMenuNode.getAttribute("did");var B=this.currentContextMenuNode.getAttribute("type");this.inlineRenameObject.enableRenameField(B,A);this.currentContextMenuNode.parentNode.className="edit";}}catch(C){microstrategy.errors.log(C);return false;}};mstrFolderTreeViewImpl.prototype.onActionItemClick=function(D){try{if(!this.currentContextMenuNode){return ;}var A="";var B="";if(this.currentContextMenuNode.getAttribute("isSC")=="true"){A=this.currentContextMenuNode.getAttribute("sc_id");B="18";}else{A=this.currentContextMenuNode.getAttribute("did");B=this.currentContextMenuNode.getAttribute("type");}mstrFolderActions.submitShowBeanEvent(D,A,B);}catch(C){microstrategy.errors.log(C);return false;}};mstrFolderTreeViewImpl.prototype.isCreateDocumentMenuItemAvailable=function(){try{if(this.currentContextMenuNode==null){return false;}var B=this.currentContextMenuNode.getAttribute("type");if(B==microstrategy.DSSTYPE_RPT_DEFINITION){var A=this.currentContextMenuNode.getAttribute("subtype");return(A!=772&&A!=776);}return false;}catch(C){microstrategy.errors.log(C);return false;}};mstrFolderTreeViewImpl.prototype.findParentFolder=function(B){try{var C=this.findParentTreeNode(B);while(C&&C.getAttribute("type")!=8){C=findParentTreeNode(C);}return C;}catch(A){microstrategy.errors.log(A);return null;}};mstrFolderTreeViewImpl.prototype.isMenuItemAvailable=function(A){try{if(this.currentContextMenuNode==null){return false;}var C;var D=this.findParentFolder(this.currentContextMenuNode);switch(A){case"delete":return(this.currentContextMenuNode.getAttribute(mstrHTMLAttributes.ATTR_CAN_DELETE)=="true");case"move":C=mstrHTMLAttributes.ATTR_CAN_MOVE;return(this.currentContextMenuNode.getAttribute(C)=="true"&&D&&D.getAttribute(mstrHTMLAttributes.ATTR_CAN_REMOVE_CHILD)=="true");case"rename":return(this.currentContextMenuNode.getAttribute(mstrHTMLAttributes.ATTR_CAN_RENAME)=="true");case"create-shortcut":return(this.currentContextMenuNode.getAttribute(mstrHTMLAttributes.ATTR_CAN_CREATE_SHORTCUT)=="true");case"copy":return(this.currentContextMenuNode!=null&&this.currentContextMenuNode.getAttribute(mstrHTMLAttributes.ATTR_CAN_COPY)=="true");default:return true;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFolderTreeViewImpl.prototype.onDeleteMenuItemClick=function(){try{if(!this.currentContextMenuNode){return ;}var A="";var B="";var D=false;if(this.currentContextMenuNode.getAttribute("isSC")=="true"){A=this.currentContextMenuNode.getAttribute("sc_id");B="18";D=true;}else{A=this.currentContextMenuNode.getAttribute("did");B=this.currentContextMenuNode.getAttribute("type");}var C=this.util_getChildNode(this.currentContextMenuNode,"A");var F;if(C){F=C.innerHTML;}mstrFolderActions.actionConfirmDelete(A,B,F,this.folderBeanPath,D);}catch(E){microstrategy.errors.log(E);return false;}};mstrFolderTreeViewImpl.prototype.onNewCreateObjectMenuClick=function(C,B){try{var A=this.currentContextMenuNode.getAttribute("did");mstrFolderActions.actionNewMenuItemClick(C,A,B);}catch(D){microstrategy.errors.log(D);return false;}};mstrFolderTreeViewImpl.prototype.onClickTree=function(B){if(!B){B=window.event;}if(this.treeProcessing){B.returnValue=false;return ;}var A=getEventTarget(B);if(A==null){return false;}if(A.tagName!=null&&(A.tagName=="DIV"||A.tagName=="UL")){return false;}mstrTreeViewImpl.prototype.onClickTree.call(this,B);};mstrFolderTreeViewImpl.prototype.showShareLink=function(C){var E=this.util_getChildNode(this.currentContextMenuNode,"A"),B=this.currentContextMenuNode.getAttribute("did"),D=this.currentContextMenuNode.getAttribute("type"),F=this.currentContextMenuNode.textContent;if(!F){F=this.currentContextMenuNode.innerText;}var A=E.href;if(C){A+=C;}microstrategy.showSharingEditor(A,{objectName:F,objId:B,objType:D,mid:-1});};function mstrFolderTreeViewImpl(A){this.inherits=mstrTreeViewImpl;this.inherits(A);delete this.inherits;return this;}mstrFolderImplScript=true;mstrFolderImpl.prototype=new mstrBoneImpl();mstrFolderImpl.prototype.currentContextMenuNode=null;mstrFolderImpl.prototype.inlineRenameObject=null;mstrFolderImpl.prototype.folderId=null;mstrFolderImpl.prototype.serverName=null;mstrFolderImpl.prototype.projectName=null;mstrFolderImpl.prototype.portNum=null;mstrFolderImpl.prototype.minColWidth=[32,100,100,100,100,130];mstrFolderImpl.prototype.colCount=6;mstrFolderImpl.prototype.ascCss="mstrSortIconAsc";mstrFolderImpl.prototype.descCss="mstrSortIconDesc";mstrFolderImpl.prototype.onload=function(){try{this.initBone();this.initFolderBone();this.updateQuickSearchBone();scroll(0,0);}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderImpl.prototype.initFolderBone=function(){try{this.elem.oncontextmenu=new Function("e","microstrategy.bone('"+this.id+"').onContextMenu(e); return true;");this.commands=this.setCommands();if(!mstr.utils.ISIE7){this.table=this.findTable();if(this.table){this.elem.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e); return true;");this.colGroups=[this.table.children[0]];if(this.colGroups&&this.colGroups[0]){this.colCount=this.colGroups[0].childNodes.length;}this.headersNode=this.table.tHead;this.elem.onclick=new Function("e","microstrategy.bone('"+this.id+"').onclick(e); return true;");this._buildColGroup();}this.lockHeader();if(this.table){this.initSort(true);}else{this.initSort(false);}}}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderImpl.prototype.setCommands=function(){return new mstrFolderCommands(this);};mstrFolderImpl.prototype.findTable=function(){return microstrategy.findChildWithAtt(this.elem,"table","id","FolderList");};mstrFolderImpl.prototype.lockHeader=function(){try{var B=this;B.divLock=B.cloneListHeader4Lock();if(!B.divLock){return ;}B.tableLocked=B.divLock.firstChild;B.headersNode_locked=B.tableLocked.tHead;B.colGroups.push(B.tableLocked.children[0]);}catch(A){microstrategy.errors.log(A);}};mstrFolderImpl.prototype.cloneListHeader4Lock=function(){try{var F=this.table||document.getElementById("FolderList");if(!F){return null;}var C=this.table.cloneNode(false);var G=F.getElementsByTagName("colgroup");if(G){for(var B=0,A=G.length;B<A;B++){C.appendChild(G[B].cloneNode(true));}}C.appendChild(F.tHead.cloneNode(true));var H=document.createElement("div");H.className="mstrListView-locked";var D=document.getElementById("mstrWeb_error");if(D){this.elem.style.marginTop=this.elem.offsetTop+"px";D.style.cssText="position: fixed; background: white; z-index: 1; width:"+D.offsetWidth+"px";}H.style.marginLeft=-(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";mstr.$D.attachEvent(window,"scroll",function(I){H.style.marginLeft=-(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";});H.appendChild(C);F.parentNode.insertBefore(H,F);return H;}catch(E){microstrategy.errors.log(E);}};mstrFolderImpl.prototype._buildColWidths=function(){if(this.headersNode===undefined){return ;}this.colWidths=this.colWidths||[];var B=this.colWidths;if(B.length===0){for(var D=this.colCount-1;D>-1;D--){B[D]=this.headersNode.rows[0].cells[D].offsetWidth;}}var A=0;for(var C=B.length-1;C>-1;C--){A+=B[C];}var E=document.getElementById("mstrWeb_content").clientWidth;this.table.style.width=this.headersNode.style.width=E+"px";if(this.tableLocked){this.tableLocked.style.width=this.headersNode_locked.style.width=this.table.offsetWidth+"px";}};mstrFolderImpl.prototype._buildColGroup=function _buildColGroup(){this._buildColWidths();var K=this.resizingIndex,B=this.colWidths,I=this.colGroups;if(I&&I[0].childNodes.length==this.colCount){if((K!==null&&K>=0)){for(var F=I.length-1;F>-1;F--){for(var E=I[F].childNodes.length-1;E>-1;E--){I[F].childNodes[E].style.width=B[E]+"px";}}}}else{var A=document.createElement("colgroup");for(var G=0,D=this.colCount;G<D;G++){var C=document.createElement("col");C.style.width=B[G]+"px";A.appendChild(C);}var J=function(L,M){L[(L.firstChild.tagName.toLowerCase()!="colgroup")?"insertBefore":"replaceChild"](M,L.firstChild);};J(this.headersNode,A);var H=A.cloneNode(true);J(this.itemsNode,H);this.colGroups=[A,H];}};mstrFolderImpl.prototype.initSort=function(B){if(!microstrategy.bones.folderAllModes){return ;}this.folderId=microstrategy.bones.folderAllModes.folderId;if(!this.folderId){return ;}var A=this.loadSorting(this.folderId);if(!A){return ;}if(B){this.sortListViewObjectBrowser(A.SortColID,A.isAscSort);}else{this.sortFolderViewObjectBrowser(A.SortColID,A.isAscSort);}};mstrFolderImpl.prototype.loadSorting=function(){if(!this.folderId){return ;}var C="ObjectBrowserSorting_"+mstrConfig.lastMsgKey;if(typeof (Storage)!="undefined"&&window.JSON){var B=null;if(localStorage.getItem(C)){B=JSON.parse(localStorage.getItem(C));}if(B){for(var A=0;A<B.length;A++){if(B[A].folderID==this.folderId){return B[A];}}}}return null;};mstrFolderImpl.prototype.saveSorting=function(A,B){if(typeof (Storage)=="undefined"||!window.JSON){return ;}if(!this.folderId){return ;}var E="ObjectBrowserSorting_"+mstrConfig.lastMsgKey;var D=null;if(localStorage.getItem(E)!=null){D=JSON.parse(localStorage.getItem(E));}if(D){var F=false;for(var C=0;C<D.length;C++){if(D[C].folderID==this.folderId){D[C].SortColID=A;D[C].isAscSort=B;F=true;break;}}if(!F){D[length]={folderID:this.folderId,SortColID:A,isAscSort:B};}}else{D=[];D[0]={folderID:this.folderId,SortColID:A,isAscSort:B};}localStorage.setItem(E,JSON.stringify(D));};mstrFolderImpl.prototype.onclick=function(E){this.onselectstartFn=document.onselectstart;var A=window,E=E||window.event;var G=mstr.$E.target(E,A);var D=G.parentNode.parentNode.parentNode.parentNode.parentNode;if(!G||!D||D.getAttribute("class")!="mstrListView-locked"||!G.parentNode.previousSibling||!G.parentNode.nextSibling){return ;}var C=G.parentNode.cellIndex;var B=true;var F=null;F=microstrategy.findChildWithAtt(this.elem,"span","id",this.descCss);if(!F){F=microstrategy.findChildWithAtt(this.elem,"span","id",this.ascCss);}if(!F){return ;}if(F.parentNode.parentNode.cellIndex==C){B=F.id==this.ascCss?false:true;}else{if(C==3){B=false;}}this.sortListViewObjectBrowser(C,B);this.saveSorting(C,B);};mstrFolderImpl.prototype.sortFolderViewObjectBrowser=function(L,K){var C=[],H=[];var D=microstrategy.findChildWithAtt(this.elem,"table","id","FolderIcons");var E=D.getElementsByTagName("tbody")[0];var Q=E.childNodes;microstrategy.showWait(true);for(var G=0;G<Q.length;G++){var J=Q[G].childNodes;for(var F=0;F<J.length;F++){if(N(J[F])){C.push(J[F]);}else{H.push(J[F]);}}}switch(L){case 1:C.sort(I);H.sort(I);break;case 2:C.sort(B);H.sort(B);break;case 3:C.sort(M);H.sort(M);break;case 4:C.sort(O);H.sort(O);break;}while(E.hasChildNodes()){E.removeChild(E.firstChild);}var A=[];if(K){A=C.concat(H);}else{A=H.reverse().concat(C.reverse());}for(var G=0;G<=A.length/2-1;G++){var P=document.createElement("tr");P.appendChild(A[2*G]);P.appendChild(A[2*G+1]);E.appendChild(P);}if(E.childNodes.length<A.length/2){var P=document.createElement("tr");P.appendChild(A[A.length-1]);E.appendChild(P);}microstrategy.showWait(false);function I(T,R){var V=microstrategy.findChildWithCssClass(T,"div","mstrLargeIconViewItemName");var S=microstrategy.findChildWithCssClass(R,"div","mstrLargeIconViewItemName");var W=V.innerText||V.textContent||"";var U=S.innerText||S.textContent||"";return W.localeCompare(U);}function B(T,S){var V=microstrategy.findChildWithCssClass(T,"div","mstrLargeIconViewItemOwner");var U=microstrategy.findChildWithCssClass(S,"div","mstrLargeIconViewItemOwner");var R=V.innerText||V.textContent||"";var X=U.innerText||U.textContent||"";var W=R.localeCompare(X);if(!W){return I(T,S);}return W;}function M(T,R){var U=microstrategy.findChildWithCssClass(T,"div","mstrLargeIconViewItemModified");var S=microstrategy.findChildWithCssClass(R,"div","mstrLargeIconViewItemModified");var W=Number(U.getElementsByTagName("div")[0].getAttribute("timestamp"));var V=Number(S.getElementsByTagName("div")[0].getAttribute("timestamp"));if(W>V){return 1;}else{if(W==V){return 0;}else{if(W<V){return -1;}}}}function O(T,S){var R=microstrategy.findChildWithCssClass(T,"div","mstrLargeIconViewItemDescription");var X=microstrategy.findChildWithCssClass(S,"div","mstrLargeIconViewItemDescription");var W=R.innerText||R.textContent||"";var V=X.innerText||X.textContent||"";var U=W.localeCompare(V);if(!U){return I(T,S);}return U;}function N(R){if(microstrategy.findChildWithAtt(R,"span","class","mstrIcon-lg mstrIcon-lg-f")){return true;}return false;}};mstrFolderImpl.prototype.sortListViewObjectBrowser=function(K,B){var Q=[],N=[];var H=0;var S=microstrategy.findChildWithAtt(document,"div","scriptclass","mstrFolderImpl");var E=microstrategy.findChildWithAtt(S,"div","class","mstrListView-locked");var O=microstrategy.findChildWithAtt(E,"span","id",this.ascCss);if(!O){O=microstrategy.findChildWithAtt(E,"span","id",this.descCss);}if(!O){return ;}microstrategy.showWait(true);if(B&&O.id==this.descCss){O.id=this.ascCss;}else{if(!B&&O.id==this.ascCss){O.id=this.descCss;}}var J=E.getElementsByTagName("tr")[0];J.childNodes[K].getElementsByTagName("div")[0].appendChild(O);var R=E.nextSibling;var C=R.getElementsByTagName("tbody")[0];var M=C.childNodes;for(var P=0;P<M.length;P++){if(microstrategy.findChildWithCssClass(M[P].childNodes[0],"span","mstrIcon-lv mstrIcon-lv-f")){Q.push(M[P]);}else{N.push(M[P]);}}switch(K){case 1:Q.sort(I);N.sort(I);break;case 2:Q.sort(L);N.sort(L);break;case 3:Q.sort(F);N.sort(F);break;case 4:Q.sort(A);N.sort(A);break;}while(C.hasChildNodes()){C.removeChild(C.firstChild);}var G=[];if(B){G=Q.concat(N);}else{G=N.reverse().concat(Q.reverse());}for(var P=0;P<G.length;P++){H++;D(G[P],H);C.appendChild(G[P]);}microstrategy.showWait(false);function I(V,T){var X=1;var Z=V.childNodes[X];var Y=T.childNodes[X];var W=Z.innerText||Z.textContent||"";var U=Y.innerText||Y.textContent||"";return W.localeCompare(U);}function L(V,T){var X=2;var c=V.childNodes[X];var Z=T.childNodes[X];var W=c.innerText||c.textContent||"";var U=Z.innerText||Z.textContent||"";var Y=W.localeCompare(U);if(!Y){return I(V,T);}else{return Y;}}function F(U,T){var V=3;var X=Number(U.childNodes[V].childNodes[0].getAttribute("timestamp"));var W=Number(T.childNodes[V].childNodes[0].getAttribute("timestamp"));if(X>W){return 1;}else{if(X==W){return 0;}else{if(X<W){return -1;}}}}function A(V,T){var X=4;var c=V.childNodes[X];var Z=T.childNodes[X];var W=c.innerText||c.textContent||"";var U=Z.innerText||Z.textContent||"";var Y=W.localeCompare(U);if(!Y){return I(V,T);}else{return Y;}}function D(U,T){if(T%2==0&&!U.hasAttribute("class")){U.setAttribute("class","mstrBandOn");}else{if(T%2!=0&&U.hasAttribute("class")){U.removeAttribute("class");}}}};mstrFolderImpl.prototype.onmousedown=function(E){this.onselectstartFn=document.onselectstart;var C=window,E=E||window.event;var A=mstr.$E.target(E,C);if(A&&A.tagName.toLowerCase()=="td"&&A.parentNode.parentNode.tagName.toLowerCase()=="thead"){document.onselectstart=function(){return false;};var H=A.offsetLeft+A.offsetWidth-getDocumentScrollLeft();this.resizingIndex=A.cellIndex;this.startx=mstr.$E.getMousePosition(E,C).x;var J=function(K){var L=document.createElement("div");L.className="mstrListView-rzHandle";L.style.left=K+"px";return L;};var I=this.resizeHandle||J(H);if(!this.resizeHandle||!mstr.$D.containsElement(this.elem,I)){this.resizeHandle=I;this.elem.appendChild(I);}else{I.style.left=H+"px";}I.style.display="block";this.elem.className+=" resizing";var G=this;var D=function(K){I.style.left=Math.max(0,H+mstr.$E.getMousePosition(K,C).x-G.startx)+"px";};var B=function(L){if(I){I.style.display="none";mstr.$D.detachEvent(document,"mousemove",D);mstr.$D.detachEvent(document,"mouseup",B);}G.elem.className=G.elem.className.replace(/ resizing/,"");document.onselectstart=G.onselectstartFn;var K=G.resizingIndex;if(K>=0&&K!=G.colWidths.length-1){F(G,L);G._buildColGroup();G.resizingIndex=null;}};var F=function(N,P){var O=N.colWidths,M=N.minColWidth,L=N.resizingIndex,K=O.length-1,R=O[L],Q;O[L]=Math.max(M[L],O[L]+mstr.$E.getMousePosition(P,C).x-N.startx);Q=O[L]-R;while(Q!=0&&K>=L){if(O[K]-Q>=M[K]){O[K]-=Q;Q=0;}else{Q-=O[K]-M[K];O[K]=M[K];K--;}}};mstr.$D.attachEvent(document,"mousemove",D);mstr.$D.attachEvent(document,"mouseup",B);}};mstrFolderImpl.prototype.onContextMenu=function(C){try{if(!C){C=window.event;}var A=getEventTarget(C);if(A.tagName.toLowerCase()!="tr"){A=findTargetTag(A,"tr");}if(A.tagName.toLowerCase()=="tr"){this.currentContextMenuNode=A;}else{this.currentContextMenuNode=null;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFolderImpl.prototype.processRename=function(){try{if(this.inlineRenameObject){this.inlineRenameObject.processRename(this.beanPath);this.inlineRenameObject=null;}}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderImpl.prototype.cancelRename=function(){try{if(this.inlineRenameObject){this.inlineRenameObject.cancelRename();this.inlineRenameObject=null;}}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderImpl.prototype.getNameTag=function(){try{return microstrategy.findChildWithAtt(this.currentContextMenuNode,"span","sty","nm");}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderImpl.prototype.getCurrentContextId=function(){return microstrategy.findChildWithAtt(this.currentContextMenuNode,"td","oty","1").getAttribute("oid");};mstrFolderImpl.prototype.getObjInfo=function(){var E=this.currentContextMenuNode;if(E){var D=E.getElementsByTagName("td"),G;for(var C=0,A=D.length;C<A;C++){G=D[C];if(G.getAttribute("oid")){var F=microstrategy.findChildWithAtt(E,"span",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.HTMLATTR_NAME),B="";if(F){B=F.firstChild.getAttribute("title");}return{id:G.getAttribute("oid"),ty:G.getAttribute("oty"),n:B};}}}return null;};mstrFolderImpl.prototype.enableRenameField=function(B,A){try{if(this.currentContextMenuNode){this.inlineRenameObject=new mstrInlineRenameImpl();this.inlineRenameObject.parentBone=this;this.inlineRenameObject.enableRenameField(B,A);}}catch(C){microstrategy.errors.log(C);return false;}};mstrFolderImpl.prototype.openCustomGroupEditor=function(A){microstrategy.openCustomGroupEditor(A);};mstrFolderImpl.prototype.openMetricEditor=function(B,A){microstrategy.openMetricEditor(B,A);};mstrFolderImpl.prototype.openDataImport=function(A,B){microstrategy.openDataImprot(A,B);};mstrFolderImpl.prototype.openACLEditor=function(A,B){microstrategy.openACLEditor(A,B);};mstrFolderImpl.prototype.updateQuickSearchBone=function(){var A=microstrategy.bone("mstrSearchSuggest");if(A&&A.isMiniSearchBox){if(this.folderName){A.rootFolderName=mstr.utils.String.escape4HTMLText(this.folderName);}if(this.sysFolder!=undefined){A.rootFolderType=this.sysFolder;}if(this.folderId){A.rootFolderID=this.folderId;}A.updateTipText();}};mstrFolderImpl.prototype.showExportLink=function(C,A,B){mstrFolderActions.exportLink(C,this.serverName,this.projectName,this.portNum,A,B);};mstrFolderImpl.prototype.onwinresize=function(){this._buildColWidths();};function mstrFolderImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrFolderCommands.prototype={};mstrFolderCommands.prototype.exec=function(K,B){switch(K){case"edit":this.parentBone.openCustomGroupEditor(this.parentBone.getCurrentContextId());break;case"newCGE":this.parentBone.openCustomGroupEditor();break;case"newIVE":microstrategy.createIVE.call(this.parentBone);break;case"newIVEHTML5VI":microstrategy.createIVE.call(this.parentBone,true);break;case"newBlankVI":var I=!microstrategy.isFeatureAvailable("flashvi");if(I&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}else{var C=microstrategy.updateManager,J=[];J.push(C.createActionObject(null,mstrUpdateManager.CREATE_BLANK_VI,microstrategy.servletName,[],[]));C.add(J);C.useIframe=false;C.flushAndSubmitChanges();}break;case"ACLEditor":var F=this.parentBone.getObjInfo();if(F){this.parentBone.openACLEditor(F.id,F.ty);}break;case"shareEditor":var F=this.parentBone.getObjInfo();microstrategy.showSharingEditor(B.url,{objectName:B.name,objId:F.id,objType:F.ty,mid:-1});break;case"newME":this.parentBone.openMetricEditor(null,"mstrME");break;case"newSME":this.parentBone.openMetricEditor(null,"mstrSME");break;case"newFSE":this.parentBone.openMetricEditor(null,"mstrFSE");break;case"openME":var F=this.parentBone.getObjInfo();if(F){this.parentBone.openMetricEditor(F.id);}break;case"openDataImport":microstrategy.openDataImport.call(this.parentBone,B);break;case"republishCube":var G=B.ReportId,D=this;microstrategy.getCubesInfo([G],function(M){var L=function(){D.exec("openDataImport",B);};if(M[G]&&M[G].ddam===2){showMessage({contents:microstrategy.descriptors.getDescriptor(13885),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,type:mstrMsgBoxImpl.MSG_INFO_WARNING,okEval:L,focusButton:microstrategy.CANCEL_BUTTON});return ;}L();});break;case"findDependents":var H=this.parentBone.getObjInfo();var E=mstrmojo.insert({scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-Search-editor",zIndex:102,title:microstrategy.descriptors.getDescriptor(14532)+" "+H.n,children:[{scriptClass:"mstrmojo.mstr.search.Search",id:"search",searchProps:mstrmojo.hash.copy({uses:H.id+":"+H.ty,objectType:[3,18,14081],dereferenceshortcut:0,rootFolderID:"",rootFolderType:39,searchPattern:"*"},mstrmojo.hash.copy(mstrConfig.searchProps)),allowEmptyInput:true,resultsOnly:true,getNotFoundMsg:function A(){var L=function(N){return"<b>"+mstrmojo.string.escape4HTMLText(N)+"</b>";};var M=mstrmojo.desc(14557,"Your search for dependents of ## in ### returned no results").replace("###",L(mstrConfig.projectName)).replace("##",L(H.n));return M;}}],onOpen:function(){var L=45;this.set("top",mstrmojo.dom.getVerticalScroll()+L+"px");},onClose:function(){this.destroy();}});E.render();E.open();mstrmojo.all.search.forceSearch();break;}};mstrFolderCommands.prototype.queryVisible=function(A,E){try{var C=this.parentBone.getObjInfo();if(!C){return false;}switch(A){case"canFindDependents":var D=[8,18];return mstr.$A.find(D,parseInt(C.ty,10))==-1;}}catch(B){microstrategy.errors.log(B);}};function mstrFolderCommands(A){this.parentBone=A;return this;}mstrToolbarImplScript=true;mstrToolbarImpl.prototype=new mstrEditorImpl();mstrToolbarImpl.CMD_TYPE_SIMPLE=0;mstrToolbarImpl.CMD_TYPE_RADIO=1;mstrToolbarImpl.CMD_TYPE_CHECK=2;mstrToolbarImpl.CMD_TYPE_PULLDOWN=3;mstrToolbarImpl.CMD_TYPE_COMBO=4;mstrToolbarImpl.CMD_TYPE_CAPTION=5;mstrToolbarImpl.CMD_TYPE_TEXT=6;mstrToolbarImpl.PULLDOWN_DISABLED="mstrPulldowndisabled";mstrToolbarImpl.COMBODOWN_DISABLED="mstrCombodowndisabled";mstrToolbarImpl.DISABLED="mstrIcon-tb disabled";mstrToolbarImpl.PULLDOWN_ENABLED="mstrPulldown";mstrToolbarImpl.COMBODOWN_ENABLED="mstrCombodown";mstrToolbarImpl.ENABLED="mstrIcon-tb selected";mstrToolbarImpl.ICON="mstrIcon-tb";mstrToolbarImpl.RADIO_DISABLED="mstrIcon-tb disabled";mstrToolbarImpl.prototype.onload=function(){try{this.initToolbar();}catch(A){microstrategy.errors.log(A);return false;}};mstrToolbarImpl.prototype.onunload=function(C){try{mstrEditorImpl.prototype.onunload.call(this,C);var B=this.getAppliesTo();if(B&&B.observer){B.observer.unregister(this.id);}}catch(A){microstrategy.errors.log(A);}return true;};mstrToolbarImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.ondblclick=function(B){try{return false;}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.onclick=function(J){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrToolbarImpl.onclick",mstrLogImpl.CLICK_TOOLBAR);}if(!J){J=window.event;}if(this.getAppliesTo()==null){return ;}var H=getEventTarget(J);if(H==null){return ;}var D=H;if(D.getAttribute(microstrategy.HTMLATTR_CMD_ID)==null){D=findTarget(H,microstrategy.HTMLATTR_CMD_ID);}if(D==null){return ;}var K=D.className;if(K.indexOf("disabled")!=-1){return ;}var L=D.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(L==null){return ;}var A=D.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);var C=D.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);var I=this.getCmdType(D);switch(I){case mstrToolbarImpl.CMD_TYPE_RADIO:if(H.className!=mstrToolbarImpl.ENABLED){var F=H.parentNode.childNodes;for(var G=0;G<F.length;G++){if(F[G].nodeType==1){F[G].className=(F[G]==H)?mstrToolbarImpl.ENABLED:mstrToolbarImpl.ICON;}}this.exec(L,A);}break;case mstrToolbarImpl.CMD_TYPE_CHECK:var B=(H.className.indexOf("selected")>=0);if(typeof (A)=="number"||Number(A)!=NaN){A=(B)?-A:A;}H.className=(B)?mstrToolbarImpl.ICON:mstrToolbarImpl.ENABLED;this.exec(L,A);break;case mstrToolbarImpl.CMD_TYPE_PULLDOWN:this.togglePicker(true,C,H);break;case mstrToolbarImpl.CMD_TYPE_COMBO:if(H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){this.togglePicker(true,C,D);}else{this.exec(L,A);}break;default:this.exec(L,A);break;}}catch(E){microstrategy.errors.log(E);}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrToolbarImpl.onclick",mstrLogImpl.CLICK_TOOLBAR);}}return false;};mstrToolbarImpl.prototype.onselectionchange=function(A){return this.update(A);};mstrToolbarImpl.prototype.getQueryState=function(A,C){try{return A.commands.queryState(C.getAttribute(microstrategy.HTMLATTR_CMD_ID));}catch(B){microstrategy.errors.log(B);}return"";};mstrToolbarImpl.prototype.update=function(G){try{var B=this.getAppliesTo();if(B&&B.commands){for(var C in this.controls){var F=this.controls[C];var A=F.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(A){var D=B.commands.queryEnabled(A);if(D){F.className=mstrToolbarImpl.ICON;F.disabled=false;this.enable(F,this.getQueryState(B,F),B,A);}else{F.disabled=true;this.disableCtrl(F);}if(B.commands.customUpdate){B.commands.customUpdate(F);}}if(F.getAttribute(microstrategy.HTMLATTR_DYN_TITLE)!=null){F.setAttribute("title",B.commands.queryState(F.getAttribute(microstrategy.HTMLATTR_DYN_TITLE)));}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrToolbarImpl.prototype.getBeanName=function(){try{var A=this.elem.parentNode.id;if(A.indexOf("_")>0){A=A.substr(0,A.indexOf("_"));}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrToolbarImpl.prototype.onmouseover=function(C){try{var A=this.getButton(C);if(A==null){return ;}var D=A.className.toLowerCase();if(D.indexOf("disabled")>-1){return ;}if(A.className.indexOf(" highlighted")==-1){A.className+=" highlighted";}}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.onmouseout=function(C){try{var A=this.getButton(C);if(A==null){return ;}A.className=A.className.replace(" highlighted","");}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.togglePicker=function(A,D,B){try{dropDown.togglePicker(A,D,B,this);}catch(C){microstrategy.errors.log(C);}return false;};mstrToolbarImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrToolbarImpl.prototype.selectPickerElement=function(C){try{var B=C.commandId;var A=this.getAppliesTo();if(A){var D=A.commands.queryState(B);if(D!=null){var F=document.getElementById("pkr"+D);if(F){F.className=mstrToolbarImpl.ENABLED;C.selected=F;}}}}catch(E){microstrategy.errors.log(E);}};mstrToolbarImpl.prototype.exec=function(B,D){try{if(!B){return ;}var A=this.getAppliesTo();if(!A){return ;}if(!A.commands.queryEnabled(B)){return ;}A.commands.exec(B,D);return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrToolbarImpl.prototype.execPicker=function(C,G){try{var F=true;var B=C.commandId;var A=this.getAppliesTo();if(A&&B&&A.commands.queryEnabled(B)){F=A.commands.exec(B,G.getAttribute("id").slice(3));if(F){var E=this.getControlFromCmdId(B);if(this.getCmdType(E)==mstrToolbarImpl.CMD_TYPE_PULLDOWN){this.enable(E,this.getQueryState(A,E),A,B);}}}return F;}catch(D){microstrategy.errors.log(D);return false;}};mstrToolbarImpl.prototype.initToolbar=function(){try{this.initEditor();this.controls=new Object();this.currentPicker=null;if(this.elem){var D=this.appliesTo||this.elem.getAttribute("at");this.setAppliesTo(D);var J=this.elem.getAttribute("beanPath");if(J&&J.length>0){this.beanPath=J;}var K=new Function("e","return microstrategy.bone('"+this.id+"').onclick(e);");var H=new Function("e","return microstrategy.bone('"+this.id+"').ondblclick(e);");this.elem.onmouseover=new Function("e","if (typeof(microstrategy) != 'undefined' && microstrategy.bone('"+this.id+"') != null) { return microstrategy.bone('"+this.id+"').onmouseover(e); }");this.elem.onmouseout=new Function("e","if (typeof(microstrategy) != 'undefined' && microstrategy.bone('"+this.id+"') != null) { return microstrategy.bone('"+this.id+"').onmouseout(e); }");if(!this.body){return ;}function I(L){var M=getObj(L);if(typeof (M.innerText)!="undefined"){return M.innerText;}if(bIsW3C&&M.childNodes&&M.childNodes[0]&&(M.childNodes[0].nodeValue!=null)){if(M.childNodes[0].nodeValue!=M.innerHTML){microstrategy.err.log("Please forward the reproduction scenario to reproduce this error to either Mark or Yong.  Do not log a TQMS issue.");}return M.childNodes[0].nodeValue;}}var B=this.body.getElementsByTagName("div");for(var F=0;F<B.length;F++){if(B[F].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_BTN_GROUP){for(var E=0;E<B[F].childNodes.length;E++){if(B[F].childNodes[E].nodeType==1){var G=B[F].childNodes[E];var A=G.getAttribute("id");if(G.getAttribute(microstrategy.HTMLATTR_CMD_ID)&&G.getAttribute(microstrategy.HTMLATTR_CMD_TYPE)!=mstrToolbarImpl.CMD_TYPE_TEXT&&G.tagName.toLowerCase()!="label"){G.onclick=K;G.ondblclick=H;}this.controls[A]=G;if(G.firstChild&&G.firstChild.tagName=="SPAN"){this.controls[A].origName=G.firstChild.innerHTML;}else{this.controls[A].origName=I(G);}}}}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrToolbarImpl.prototype.setAppliesTo=function(B){try{if(B==null){B=microstrategy.getViewerBone();}if(typeof (B)=="string"){B=microstrategy.bone(B);}if(B){this.appliesTo=B.id;if(B.observer){B.observer.register(this.id);}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrToolbarImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo&&this.appliesTo.length>0){return microstrategy.bone(this.appliesTo);}return null;}catch(A){microstrategy.errors.log(A);return null;}};mstrToolbarImpl.prototype.getControlFromCmdId=function(A){try{for(var C in this.controls){if((this.controls[C])&&(this.controls[C].getAttribute(microstrategy.HTMLATTR_CMD_ID)==A)){return this.controls[C];break;}}return null;}catch(B){microstrategy.errors.log(B);return null;}};mstrToolbarImpl.prototype.getCmdType=function(A){try{if(A.getAttribute(microstrategy.HTMLATTR_CMD_TYPE)==null){return mstrToolbarImpl.CMD_TYPE_SIMPLE;}else{return parseInt(A.getAttribute(microstrategy.HTMLATTR_CMD_TYPE));}}catch(B){microstrategy.errors.log(B);return null;}};mstrToolbarImpl.prototype.getButton=function(C){try{if(!C){C=window.event;}var A=findTarget(getEventTarget(C),microstrategy.HTMLATTR_SUBOBJTYPE);if(A==null){return null;}if(A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){A=A.parentNode;}if(A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_BTN){return null;}return A;}catch(B){microstrategy.errors.log(B);return null;}};mstrToolbarImpl.prototype.updatePulldownDisplayValue=function(B,A,C){try{if(B.firstChild&&B.firstChild.tagName=="SPAN"){B.firstChild.innerHTML=(A.name)?A.name:A;if(C){B.firstChild.className=C;}}else{B.innerHTML=(A.name)?A.name:A;if(C){B.className=C;}}B.setAttribute("title",A);}catch(D){microstrategy.errors.log(D);return null;}};mstrToolbarImpl.prototype.addPickerOption=function(E,K,J,F,G,C){var H=null;try{if(typeof (K)!="undefined"&&E){H=document.createElement("span");H.setAttribute("name","pkr"+J);H.setAttribute("id","pkr"+J);H.displayName=K;var I=document.createElement("span");I.className="mstrIcon-tb";if(C===12){I.className+=" attr";}H.appendChild(I);H.appendChild(document.createTextNode(K));if(F){for(var A in F){var D=F[A];H.setAttribute(A,D);}}if(G){H.className=G;}E.appendChild(H);}}catch(B){microstrategy.errors.log(B);}return H;};mstrToolbarImpl.prototype.displayVisModeButton=function(B){try{var A=this.getAppliesTo();if(A){var C=A.commands.queryEnabled(B);for(var E in this.controls){if(this.controls[E]&&this.controls[E].getAttribute(microstrategy.HTMLATTR_CMD_ID)==B){if(C&&this.visAvailable(this.controls[E].getAttribute(microstrategy.HTMLATTR_CMD_VALUE))){displayObj(this.controls[E]);}else{removeObj(this.controls[E]);}}}}}catch(D){microstrategy.errors.log(D);}};mstrToolbarImpl.prototype.visAvailable=function(D){try{var A=this.getAppliesTo();if(A){var B;if(A.doc&&A.doc.selections&&A.doc.selections.getSelectedGrid()){var F=A.doc.selections.getSelectedGrid();if(F){targetGrid=microstrategy.findBone(F);if(targetGrid){B=targetGrid.visualizationList;}}}else{B=A.visualizationList;}if(B){for(var C=0;C<B.length;C++){if(B[C].vm==D){return true;}}}}}catch(E){microstrategy.errors.log(E);}return false;};mstrToolbarImpl.prototype.removePickerOption=function(A,D){try{if(A){for(var B=0;A.childNodes&&B<A.childNodes.length;B++){if(A.childNodes[B].getAttribute("id")=="pkr"+D){A.removeChild(A.childNodes[B]);}}}}catch(C){microstrategy.errors.log(C);}};mstrToolbarImpl.prototype.disablePulldownCtrl=function(C,A){try{C.className=mstrToolbarImpl.PULLDOWN_DISABLED;var D=true;if(A!=null&&A==false){D=false;}if(D){this.updatePulldownDisplayValue(C,C.origName);}}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.enablePulldownCtrl=function(C,B){try{C.className=mstrToolbarImpl.PULLDOWN_ENABLED;if(B==null){B=C.origName;}this.updatePulldownDisplayValue(C,B);}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.enableCtrl=function(B){try{B.className=mstrToolbarImpl.PULLDOWN_ENABLED;}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.populatePulldownCtrl=function(E,B){try{var A=document.getElementById(E.getAttribute(microstrategy.HTMLATTR_CMD_PICKER));if(!A){return ;}while(A.hasChildNodes()){A.removeChild(A.firstChild);}for(var C=0;C<B.length;C++){var F=B.get(C);this.addPickerOption(A,F.text,F.value,null,undefined,F.oty);}}catch(D){microstrategy.errors.log(D);}};mstrToolbarImpl.prototype.disableCtrl=function(C,A){try{switch(this.getCmdType(C)){case mstrToolbarImpl.CMD_TYPE_PULLDOWN:this.disablePulldownCtrl(C,A);break;case mstrToolbarImpl.CMD_TYPE_COMBO:C.className=mstrToolbarImpl.COMBODOWN_DISABLED;if("true"==C.childNodes[0].getAttribute("fillColorContent")){C.childNodes[0].childNodes[0].className=mstrToolbarImpl.DISABLED;}else{C.childNodes[0].className=mstrToolbarImpl.DISABLED;}break;case mstrToolbarImpl.CMD_TYPE_CAPTION:break;case mstrToolbarImpl.CMD_TYPE_RADIO:case mstrToolbarImpl.CMD_TYPE_CHECK:if(!C.className.match(mstrToolbarImpl.RADIO_DISABLED)){C.className=C.className+"  "+mstrToolbarImpl.RADIO_DISABLED;}break;default:if(C.tagName!="A"){C.className=C.className.replace(mstrToolbarImpl.DISABLED,"")+" "+mstrToolbarImpl.DISABLED;}}if(C.getAttribute("title")){C.setAttribute("dtitle",C.getAttribute("title"));C.setAttribute("title","");}}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.deselectAllCtrls=function(){try{for(var C in this.controls){var B=this.controls[C];switch(this.getCmdType(B)){case mstrToolbarImpl.CMD_TYPE_CHECK:case mstrToolbarImpl.CMD_TYPE_RADIO:if(!B.className.match(mstrToolbarImpl.DISABLED)){B.className=mstrToolbarImpl.ICON;}break;case mstrToolbarImpl.CMD_TYPE_PULLDOWN:if(microstrategy.EXECUTION_SCOPE!=microstrategy.REPORT_EXECUTION){this.disablePulldownCtrl(B);}break;}}}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.enable=function(F,E,B,A){try{switch(this.getCmdType(F)){case mstrToolbarImpl.CMD_TYPE_CHECK:F.className=(E)?mstrToolbarImpl.ENABLED:mstrToolbarImpl.ICON;return ;case mstrToolbarImpl.CMD_TYPE_SIMPLE:case mstrToolbarImpl.CMD_TYPE_RADIO:F.className=(E==parseInt(F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE)))?mstrToolbarImpl.ENABLED:mstrToolbarImpl.ICON;break;case mstrToolbarImpl.CMD_TYPE_PULLDOWN:if(B.commands.queryEnabled(A)){if(E&&E.currentOptionValue){this.enablePulldownCtrl(F,E.currentOptionValue);this.populatePulldownCtrl(F,E);}else{this.enablePulldownCtrl(F,E);}}else{this.disablePulldownCtrl(F);}break;case mstrToolbarImpl.CMD_TYPE_COMBO:var C=B.commands.queryEnabled(A);F.className=C?mstrToolbarImpl.COMBODOWN_ENABLED:mstrToolbarImpl.COMBODOWN_DISABLED;if("true"==F.childNodes[0].getAttribute("fillColorContent")){F.childNodes[0].childNodes[0].className=C?mstrToolbarImpl.ICON:mstrToolbarImpl.DISABLED;}else{F.childNodes[0].className=C?mstrToolbarImpl.ICON:mstrToolbarImpl.DISABLED;}break;}if(F.getAttribute("dtitle")){F.setAttribute("title",F.getAttribute("dtitle"));F.setAttribute("dtitle","");}}catch(D){microstrategy.errors.log(D);}};mstrToolbarImpl.prototype.disableToolbar=function(){try{for(var C in this.controls){var B=this.controls[C];this.disableCtrl(B);}}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.adjustVisualization=function(B,D,I){try{if(B){if(D){var H=document.getElementById(B.getAttribute(microstrategy.HTMLATTR_CMD_PICKER));if(H){if(D.visualizationList&&D.visualizationList.length>1&&D.isVisualization){while(H.hasChildNodes()){H.removeChild(H.firstChild);}for(var F=0;F<D.visualizationList.length;F++){var A=D.visualizationList[F].name;var J=D.visualizationList[F].desc;var C=D.visualizationList[F].vm;if(D.filterVisPulldown&&C!=D.visualizationMode){continue;}var G=document.createElement("span");G.setAttribute("id",A+"|"+C);G.setAttribute("name",A);G.setAttribute("value",A);G.innerHTML=J;if(A==D.selectedVisualization){I.updatePulldownDisplayValue(B,J);B.setAttribute("value",D.selectedVisualization);}H.appendChild(G);}displayObj(B);}else{removeObj(B);return ;}}}else{removeObj(B);return ;}}}catch(E){microstrategy.errors.log(E);}};function mstrToolbarImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);delete this.inherits;return this;}mstrPulldownOptions.prototype=new Object();mstrPulldownOptions.prototype.length=0;mstrPulldownOptions.prototype.currentOptionValue="";mstrPulldownOptions.prototype.options=null;mstrPulldownOptions.prototype.add=function(C,D,A,B){this.options[this.length++]={value:C,text:D,oty:B};if(A){this.currentOptionValue=D;}};mstrPulldownOptions.prototype.get=function(A){if(A in this.options){return this.options[A];}return{value:"null",text:"Index "+A+" not found."};};mstrPulldownOptions.prototype.setSelectedOption=function(B){for(var A=0;A<this.length;A++){var C=this.get(A);if(C.value==B){this.currentOptionValue=C.text;break;}}};function mstrPulldownOptions(){this.options=new Object();return this;}mstrFolderFrameTreeViewImplScript=true;mstrFolderFrameTreeViewImpl.prototype=new mstrFolderTreeViewImpl();mstrFolderFrameTreeViewImpl.prototype.differentiateExpandSelect=false;mstrFolderFrameTreeViewImpl.prototype.cacheOnSelect=false;mstrFolderFrameTreeViewImpl.prototype.beanPath;mstrFolderFrameTreeViewImpl.prototype.anchorTarget;mstrFolderFrameTreeViewImpl.prototype.onload=function(){try{this.initFolderTree();}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderFrameTreeViewImpl.prototype.onpostload=function(){try{var B=getObj(this.DIV_TREE_WAIT_ID);if(B){this.emptyDivTreeWaitNode(B);}this.resize();}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderFrameTreeViewImpl.prototype.initFolderTree=function(){try{this.initTree();if(this.treeDiv){this.treeDiv.ondblclick=null;this.treeDiv.oncontextmenu=new Function("e","microstrategy.bone('"+this.id+"').onContextMenu(e); return false;");microstrategy.disableTextSelection(this.treeDiv);}}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderFrameTreeViewImpl.prototype.onreload=function(){try{mstrTreeViewImpl.prototype.onreload.call(this);var A=this.createDummyDivTreeWaitNode();if(A){this.elem.insertAdjacentElement("afterEnd",A);}}catch(B){microstrategy.errors.log(B);return false;}};mstrFolderFrameTreeViewImpl.prototype.onContextMenu=function(C){mstrTreeViewImpl.prototype.onContextMenu.apply(this,[C]);var A=microstrategy.findAncestorWithTag(this.currentContextMenuNode,"LI"),B=microstrategy.findAncestorWithTag(this.currentlySelectedNode,"LI");if(A!==B){this.onClickTree(C);}};mstrFolderFrameTreeViewImpl.prototype.onClickTree=function(F){try{if(!F){F=window.event;}if(this.treeProcessing){F.returnValue=false;return ;}var B=getEventTarget(F);if(!B){return ;}var E=false;var A=false;this.hideTreeWaitMessage();if((B.tagName=="SPAN"&&B.getAttribute("type"))){B=B.parentNode;}if(B.tagName=="LI"){A=true;if(!this.differentiateExpandSelect){this.util_unselectNodes(B,this.elem);this.util_markNodeAsSelected(B);}}else{if(B.tagName=="A"||B.tagName=="SPAN"){E=true;B=B.parentNode.parentNode;this.util_markNodeAsSelected(B);var D=B.getAttribute("did")?B.getAttribute("did"):B.parentNode.getAttribute("did");if(B.getAttribute("did")=="incrementalFetch"){this.util_unselectNodes(B,this.elem);this.util_markNodeAsSelected(B);A=true;}else{if(D!="none"){if(F.ctrlKey){if(B.getAttribute("sel")=="1"){this.util_markNodeAsUnselected(B);}else{this.util_checkSelectedNodes(B,this.elem);this.util_markNodeAsSelected(B);}}else{if(this.util_getNodeState(B)==this.NODE_STATE_LEAF||B.getAttribute("sel")=="1"){A=true;}this.util_unselectNodes(B,this.elem);this.util_markNodeAsSelected(B);}}}}}if(A){F.returnValue=this.util_processNode(B,this,E);}else{F.returnValue=false;}return ;}catch(C){microstrategy.errors.log(C);return false;}};mstrFolderFrameTreeViewImpl.prototype.getPreviousSibling=function(B){var A=B.previousSibling;while(A&&A.nodeType!=1){A=A.previousSibling;}return A;};mstrFolderFrameTreeViewImpl.prototype.getNextSibling=function(A){var B=A.nextSibling;while(B&&B.nodeType!=1){B=B.nextSibling;}return B;};mstrFolderFrameTreeViewImpl.prototype.util_processNode=function(B,I,F){try{var H=this.util_findTargetTag(B,"DIV");if(!H){return true;}if(B.getAttribute("did")=="none"){var A=this.util_getNodeState(B);switch(A){case (this.NODE_STATE_OPEN):this.util_setTreeTargetState(H,this.NODE_STATE_CLOSED);break;case (this.NODE_STATE_CLOSED):this.util_setTreeTargetState(H,this.NODE_STATE_OPEN);break;}return false;}if(this.differentiateExpandSelect&&F){var J=this.getNextSibling(H);if((this.util_getNodeState(H)==this.NODE_STATE_LEAF)||(J&&J.tagName.toLowerCase()=="ul")){this.cacheOnSelect=false;}else{this.cacheOnSelect=true;}var G=this.util_getAnchor(B);if(G){this.util_preProcessAnchor(B,G);if(B.getAttribute("isLink")){this.util_submitForm(G);}else{this.util_submitFormWithSelectEvent(G);}}return false;}if(B.getAttribute("did")=="incrementalFetch"){var D=H.parentNode;var C=this.getPreviousSibling(D);I.scrollTop=C.offsetTop;D.parentNode.removeChild(D);this.showTreeWaitMessage(C,"afterEnd");var G=util_getAnchor(B);if(G){this.util_preProcessAnchor(B,G);if(B.getAttribute("isLink")){this.util_submitForm(G);}else{this.util_submitFormWithSelectEvent(G);}}}else{var A=this.util_getNodeState(B);switch(A){case (this.NODE_STATE_LEAF):var G=this.util_getAnchor(B);this.util_preProcessAnchor(B,G);if(B.getAttribute("isLink")){this.util_submitForm(G);}if(G.getAttribute("dum")){return false;}else{return true;}break;case (this.NODE_STATE_OPEN):this.util_setTreeTargetState(H,this.NODE_STATE_CLOSED);if(this.isNodeAncestorOfCurrentlySelected(H)){this.util_markNodeAsSelected(B);var G=this.util_getAnchor(B);if(G){this.cacheOnSelect=false;this.util_submitFormWithSelectEvent(G);return false;}}break;case (this.NODE_STATE_CLOSED):var J=this.getNextSibling(H);if(J&&J.tagName=="UL"){this.util_setTreeTargetState(H,this.NODE_STATE_OPEN);}else{microstrategy.showWaitPopup=false;if(this.differentiateExpandSelect){this.showTreeWaitMessage(H,"afterEnd");this.cacheOnSelect=false;this.util_submitFormWithExpandEvent(B);}else{this.showTreeWaitMessage(H,"afterEnd");this.util_setTreeTargetState(H,this.NODE_STATE_OPEN);var G=this.util_getAnchor(B);if(G){this.cacheOnSelect=true;this.util_submitFormWithSelectEvent(G);}}}break;}}return false;}catch(E){microstrategy.errors.log(E);return false;}};mstrFolderFrameTreeViewImpl.prototype.util_submitFormWithExpandEvent=function(C){try{var D=microstrategy.updateManager;var B=new Array();var A=C.getAttribute("did");B.push(D.createActionObject(C,mstrUpdateManager.EXPAND_NODE,this.beanPath,mstrUpdateManager.actions[mstrUpdateManager.EXPAND_NODE].paramID,[A]));D.add(B);D.useIframe=true;D.flushAndSubmitChanges();D.acknowledgeRequest();}catch(E){microstrategy.errors.log(E);return false;}};mstrFolderFrameTreeViewImpl.prototype.util_submitFormWithSelectEvent=function(D){try{var E=microstrategy.updateManager;var B=new Array();var G=this.util_getAnchor(D);var A=D.parentNode.parentNode.getAttribute("did");B.push(E.createActionObject(D,mstrUpdateManager.SELECT_NODE,this.beanPath,mstrUpdateManager.actions[mstrUpdateManager.SELECT_NODE].paramID,[A,this.cacheOnSelect]));E.add(B);var C=null;if(G){C=G.getAttribute("href");}if(C&&C.indexOf("iframe=true")>=0){E.useIframe=true;}else{E.useIframe=false;}E.flushAndSubmitChanges();E.acknowledgeRequest();}catch(F){microstrategy.errors.log(F);return false;}};mstrFolderFrameTreeViewImpl.prototype.showTreeWaitMessage=function(B,A){try{if(!B){return ;}this.treeProcessing=true;var D=getObj(this.DIV_TREE_WAIT_ID);if(D){D.parentNode.removeChild(D);}D=document.createElement("DIV");D.setAttribute("IFRAME","true");D.id=this.DIV_TREE_WAIT_ID;D.className=this.CSS_TREE_WAIT;D.noWrap=true;if((typeof (aDescriptor)!="undefined")&&(aDescriptor[38]!=null)){D.innerHTML=aDescriptor[38];}else{D.innerHTML=microstrategy.descriptors.getDescriptor("5674");}B.insertAdjacentElement(A,D);return ;}catch(C){microstrategy.errors.log(C);return false;}};mstrFolderFrameTreeViewImpl.prototype.createDummyDivTreeWaitNode=function(){try{var A=getObj(this.DIV_TREE_WAIT_ID);if(!A){var C=document.createElement("DIV");C.setAttribute("IFRAME","true");C.id=this.DIV_TREE_WAIT_ID;C.noWrap=true;return C;}return null;}catch(B){microstrategy.errors.log(B);return false;}};mstrFolderFrameTreeViewImpl.prototype.hideTreeWaitMessage=function(){try{var B=getObj(this.DIV_TREE_WAIT_ID);if(B){if(this.getPreviousSibling(B)){if(!this.differentiateExpandSelect&&B.className&&B.className=="mstrTransform"){this.getPreviousSibling(B).insertAdjacentElement("afterEnd",B.childNodes[0]);}}else{B.parentNode.appendChild(B.childNodes[0]);}if(!this.differentiateExpandSelect&&B.className&&B.className=="mstrTransform"){B.parentNode.removeChild(B);}}return ;}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderFrameTreeViewImpl.prototype.expandTreeNode=function(F,D){try{var G=getObj(this.DIV_TREE_WAIT_ID);if(G){var B=document.getElementsByTagName("LI");for(i=0;i<B.length;i++){if(B[i].getAttribute("did")==F){if(D){this.util_markNodeAsSelected(B[i]);mstr.utils.BoxModel.scrollToElement(this.elem,B[i]);}var C=this.util_getNodeState(B[i]);if(C==this.NODE_STATE_CLOSED){var A=this.util_getChildNode(G,"UL");if(!A){this.util_setTreeTargetState(B[i].parentNode,this.NODE_STATE_LEAF);}else{B[i].parentNode.insertAdjacentElement("afterEnd",A);if(!this.cacheOnSelect){this.util_setTreeTargetState(B[i].parentNode,this.NODE_STATE_OPEN);}else{this.util_setTreeTargetState(B[i].parentNode,this.NODE_STATE_CLOSED);}}if(!this.cacheOnSelect){this.cascadeOpenFolderUp(B[i].parentNode);}}this.cacheOnSelect=false;return ;}}}this.cacheOnSelect=false;return ;}catch(E){microstrategy.errors.log(E);this.cacheOnSelect=false;return false;}};mstrFolderFrameTreeViewImpl.prototype.emptyDivTreeWaitNode=function(B){try{if(B.childNodes){while(B.childNodes.length){B.removeChild(B.firstChild);}B.style.display="none";}}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderFrameTreeViewImpl.prototype.cascadeOpenFolderUp=function(A){var C=A.parentNode;var B=function(H){var G=H.childNodes;for(var F=0,E=G.length;F<E;F++){if(G[F].nodeType==1){return G[F];}}return null;};prevSib=this.getPreviousSibling(C);while(prevSib&&prevSib.tagName.toLowerCase()=="div"){var D=B(prevSib);if(D&&D.tagName.toLowerCase()=="li"){D.className=this.CSS_CLASS_OPEN;C.style.display="block";}C=C.parentNode;prevSib=this.getPreviousSibling(C);}};mstrFolderFrameTreeViewImpl.prototype.resize=function(){if(this.elem&&this.elem.style){var A=microstrategy.contentHeight-31;if(A>=0){this.elem.style.height=A+"px";microstrategy.updateBrowserSetting("ltH",A);}else{this.elem.style.height=0+"px";}var B=getObjWidth(this.elem.parentNode);if(B>=0){this.elem.style.width=B+"px";microstrategy.updateBrowserSetting("ltW",B);}else{this.elem.style.width=0+"px";}}};mstrFolderFrameTreeViewImpl.prototype.ondialogresize=function(){this.onwinresize();};mstrFolderFrameTreeViewImpl.prototype.onwinresize=function(){try{if(this.elem&&getObjWidth(this.elem.parentNode)&&getObjHeight(this.elem.parentNode)){this.resize();}}catch(A){microstrategy.errors.log(A);return false;}};function mstrFolderFrameTreeViewImpl(A){this.inherits=mstrFolderTreeViewImpl;this.inherits(A);delete this.inherits;return this;}
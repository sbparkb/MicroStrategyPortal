mstrPathImplScript=true;mstrPathImpl.prototype=new mstrBoneImpl();mstrPathImpl.prototype.commands=null;mstrPathImpl.prototype.openHistoryPageEvent="";mstrPathImpl.prototype.openHistoryPageEventID="";mstrPathImpl.prototype.openHistoryPageEventArgumentID="";mstrPathImpl.prototype.openHistoryPageEventArgumentName="";mstrPathImpl.prototype.pathSize=0;mstrPathImpl.PINNED_CLASS="pinned";mstrPathImpl.PADDING=23;mstrPathImpl.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.updateAccountButton();this.commands=new mstrPathCommandsImpl(this);this.onwinresize();}catch(A){microstrategy.errors.log(A);}};mstrPathImpl.prototype.updateAccountButton=function(){var D=document.getElementById("mstrPathAccount"),B=microstrategy.servletName,A;if(D){if(microstrategy.hasSession&&!mstrApp.isAdminPage&&D.getAttribute("_isstatic")!="true"){D.href="#";var C=microstrategy.menuHover?"mouseover":"click";D["on"+C]=microstrategy.showAccountSCList;}}};mstrPathImpl.prototype.onwinresize=function(){try{if(window.mstrInterfacePlugin){if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){return ;}var A=this.id;this.pathBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_path");this.footerBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_footer");if(!this.pathBar&&!this.footerBar){return ;}if(mstr.utils.ISIE8&&this.pathBar){this.pathBar.className=this.pathBar.className.replace(/ ie8/,"")+" ie8";}this.pathText=this.findChildByCssClass(this.elem,"mstrPathText");if(this.pathText){if(!this.pathBar){this.pathText.onclick=function(D){microstrategy.bone(A).pinPath(D);};}this.pathAncestor=this.findChildByCssClass(this.pathText,"mstrPathTextAncestors");this.pathCurrent=this.findChildByCssClass(this.pathText,"mstrPathTextCurrent");this.pathAncestors=this.findChildByCssClass(this.pathText,"mstrPathAncestors");this.pathBreadCrumbs=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbs");this.pathBreadCrumbsParent=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsParent","span");this.pathBreadCrumbsAncestors=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");}this.closeIcon=this.findChildByCssClass(this.footerBar,"mstrFooterPathClose","div");if(this.closeIcon){this.closeIcon.onclick=function(D){microstrategy.bone(A).toggleFooterPath(D);};}var C=this;if(this.pathBar&&this.pathText&&this.pathAncestors&&this.pathBreadCrumbs){this.neededWidth=C.getNeededWidth(),this.availableWidth=C.getAvailWidth();if(this.neededWidth<this.availableWidth){C.hideBreadCrumbs();}else{C.showBreadCrumbs();}}else{window.setTimeout(function(){C.resizePathBar();},10);}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getNeededWidth=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,B=this.pathAncestor,C=this.pathCurrent;if(A&&E&&B&&C){A.className=A.className.replace(" hidden","");if(!this.hasClass(E,"hidden")){E.className=E.className+" hidden";}return B.scrollWidth+C.scrollWidth+40;}else{return 0;}}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.hideBreadCrumbs=function(){try{var A=this.pathAncestors,D=this.pathBreadCrumbs,B=this.pathBreadCrumbsAncestors;A.className=A.className.replace(" hidden","");if(!this.hasClass(D,"hidden")){D.className=D.className+" hidden";}if(!this.hasClass(B,"hidden")){B.className=B.className+" hidden";}if(A&&D){this.resizePathBar();}}catch(C){microstrategy.errors.log(C);}};mstrPathImpl.prototype.showBreadCrumbs=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,C=this.pathBreadCrumbsAncestors;if(!this.hasClass(A,"hidden")){A.className=A.className+" hidden";}E.className=E.className.replace(" hidden","");if(!this.hasClass(C,"hidden")){C.className=C.className+" hidden";}this.resizeBreadCrumbs();C.style.left=mstr.$BM.position(E,true).left+"px";var B=this.id;E.onclick=function(F){microstrategy.bone(B).toggleBreadCrumbsSelector(F);};}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.toggleBreadCrumbsSelector=function(){try{var A=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");if(A){if(this.hasClass(A,"hidden")){A.className=A.className.replace(" hidden","");}else{A.className=A.className+" hidden";}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getAvailWidth=function(){try{this.pathText.style.maxWidth="0px";if(mstr.utils.ISIE8){this.pathText.style.display="none";}var K=mstr.utils.BoxModel,C=document.body.clientWidth,F=this.pathBar||this.footerBar,M=microstrategy.findChildWithAtt(F,"div","id","mstrSearchSuggest"),D=microstrategy.findChildWithAtt(F,"div","id","mstrPathAccount"),E=this.findChildByCssClass(F,"mstrFooterPathClose","div"),L=M||D||E,J=Math.min(L?K.position(L).left:C,C),I=this.findChildByCssClass(F,"mstrPathIcons"),B=0;if(I){var A=K.position(I),H=A.left+A.width,B=J-H-20;}if(mstr.utils.ISIE8){this.pathText.style.display="block";}return Math.max(B,0);}catch(G){microstrategy.errors.log(G);return 0;}};mstrPathImpl.prototype.resizePathBar=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,J=this.pathAncestor,H=this.getAvailWidth();if(D){D.style.maxWidth=H+"px";}if(J){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-15;this.curWidth=Math.min(this.pathSize/2,C.offsetWidth);var G=this.pathSize-this.curWidth;var I=parseInt(mstr.utils.CSS.getStyleValue(J,"padding-right")),F=J.scrollWidth+I,B=G>F?G-F:0;G-=B;this.curWidth+=B;J.style.maxWidth=Math.max(0,G)+"px";if((bIsDXIE)&&this.pathBar){J.style.marginLeft=-G-20+"px";}if(this.pathBar){C.style.maxWidth=Math.max(0,this.pathSize-(this.isPinned(D)?G:0))+"px";}else{C.style.maxWidth=Math.max(0,this.pathSize-G)+"px";}}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.resizeBreadCrumbs=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,G=this.pathBreadCrumbsParent,F=this.pathAncestor,H=this.availableWidth;if(D){D.style.maxWidth=H+"px";G.style.maxWidth=H+"px";C.style.maxWidth=H+"px";F.style.maxWidth=H+"px";}if(G){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-50;this.curWidth=Math.min(this.pathSize/2,C.scrollWidth);var I=this.pathSize-this.curWidth;var B=I>G.scrollWidth?I-G.scrollWidth:0;I-=B;G.style.maxWidth=Math.max(0,I)+"px";C.style.maxWidth=Math.max(0,this.pathSize-I)+"px";F.style.maxWidth=Math.max(0,I+31)+"px";}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.pinPath=function(){try{var E=" "+mstrPathImpl.PINNED_CLASS,B=this.pathText,D=this.pathAncestor,H=this.pathCurrent;if(D&&B&&this.pathBar){var C=this.isPinned(B),G=this.pathSize;if(C){B.className=B.className.replace(E,"");var A=microstrategy.bones;if(A.leftToolbar){A.leftToolbar.resize();}window.setTimeout(function(){H.style.maxWidth=G+"px";},(bIsDXIE?0:300));}else{B.className+=E;H.style.maxWidth=Math.max(0,this.curWidth)+"px";}}}catch(F){microstrategy.errors.log(F);}};mstrPathImpl.prototype.findChildByCssClass=function(F,A,D){try{if(!F){return null;}if(F.getElementsByClassName){return F.getElementsByClassName(A)[0];}else{var D=D||"div",G=new RegExp("(^|\\s)"+A+"(\\s|$)","i");if(F.tagName!=null&&F.tagName.toLowerCase()==D.toLowerCase()&&G.test(F.className)){return F;}var H=F.getElementsByTagName(D),C=H&&H.length;if(C){for(var B=0;B<C;B++){if(G.test(H[B].className)){return H[B];}}}return null;}}catch(E){microstrategy.errors.log(E);return null;}};mstrPathImpl.prototype.hasClass=function(B,A){try{return(" "+B.className+" ").indexOf(" "+A+" ")>-1;}catch(C){microstrategy.errors.log(C);return null;}};mstrPathImpl.prototype.isPinned=function(A){try{return this.hasClass(A,mstrPathImpl.PINNED_CLASS);}catch(B){microstrategy.errors.log(B);return null;}};mstrPathImpl.prototype.toggleFooterPath=function(){var C=document.getElementById("mstrWeb_footer");if(C){C.style.bottom="-41px";var B=this.id;window.setTimeout(function(){C.innerHTML="";microstrategy.unRegisterBone(B);microstrategy.eventManager.ondialogresize();},500);}var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,microstrategy.servletName+"."+microstrategy.pageName,mstrUpdateManager.actions[mstrUpdateManager.SET_PREFERENCE].paramID,["showFooterPath",0])]);};function mstrPathImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrPathCommandsImpl.prototype=new Object();mstrPathCommandsImpl.prototype.item=null;mstrPathCommandsImpl.prototype.queryEnabled=function(A){try{return true;}catch(B){microstrategy.errors.log(B);}};mstrPathCommandsImpl.prototype.queryState=function(A){try{switch(A){case"openPage":return this.item;default:microstrategy.errors.log(A+" command id not implemented.");break;}}catch(B){microstrategy.errors.log(B);}return null;};mstrPathCommandsImpl.prototype.exec=function(A,F){try{switch(A){case"openPage":var C=microstrategy.updateManager;if(C){mstrUpdateManager.addEvent({OPEN_HISTORY_PAGE:{p:[this.parentBone.openHistoryPageEventArgumentID],n:[this.parentBone.openHistoryPageEventArgumentName],i:this.parentBone.openHistoryPageEventID}});C.useIframe=false;var B=new Array();B.push(C.createActionObject(this.elem,mstrUpdateManager.OPEN_HISTORY_PAGE,microstrategy.servletName+"."+microstrategy.pageName,[this.parentBone.openHistoryPageEventArgumentID],[F]));C.add(B,true);C.flushAndSubmitChanges();}else{var D=createDynamicForm(this.parentBone.openHistoryPageEvent+F);D.method="POST";D.submit();}break;default:microstrategy.errors.log(values[0]+" command id not implemented.");break;}return true;}catch(E){microstrategy.errors.log(E);}};function mstrPathCommandsImpl(A){this.parentBone=A;return this;}var dropDown=new function(){};dropDown.prototype=new Object();dropDown.togglePicker=function(show,id,dropdown,bone){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.togglePicker",0);}var oldPicker=null;if(bone.currentPicker){oldPicker=bone.currentPicker;if(bone.currentPicker.selected){var item=bone.currentPicker.selected;if(item){item.className="";}bone.currentPicker.selected=null;bone.currentPicker.commandId=null;bone.currentPicker.toolId=null;}bone.currentPicker.style.display="none";bone.currentPicker=null;}if(show){bone.currentPicker=document.getElementById(id);if(!bone.currentPicker){microstrategy.errors.log(microstrategy.descriptors.getDescriptor("3623"));return false;}bone.currentPicker.style.zIndex=1000;var cmdId=dropdown.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!cmdId){cmdId=dropdown.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_ID);}bone.currentPicker.commandId=cmdId;var subtypeStyle=bone.currentPicker.getAttribute(microstrategy.HTMLATTR_STYLE);if(subtypeStyle!=null){this.adjustPickerElements(bone.currentPicker);}if(bone.selectPickerElement){bone.selectPickerElement(bone.currentPicker);}for(var i=0;i<bone.currentPicker.childNodes.length;i++){var oChild=bone.currentPicker.childNodes[i];auxStr=oChild.getAttribute("de");if(auxStr&&auxStr.length>0){oChild.className=(eval(auxStr))?" ":"disabled";}}var leftElem=mstr.utils.BoxModel.getElementSumOffsetLeftAccurately(dropdown,document.body);var bottomElem=mstr.utils.BoxModel.getElementSumOffsetTopAccurately(dropdown,document.body)+getObjHeight(dropdown);if(bone.dialogDiv&&bone.dialogDiv.getAttribute(mstrHTMLAttributes.ATTR_DIALOG)=="true"){leftElem-=getObjSumLeft(bone.dialogDiv);bottomElem-=getObjSumTop(bone.dialogDiv);}bone.currentPicker.style.visibility="hidden";bone.currentPicker.style.display="block";var lClientWidth=getClientWidth();var lPickerWidth=getObjWidth(bone.currentPicker);if(lPickerWidth+leftElem>lClientWidth+((bone.dialogDiv&&!mstr.utils.ISIE6)?bone.dialogDiv.scrollLeft:0)){leftElem=Math.max(leftElem-lPickerWidth+getObjWidth(dropdown),0);}moveObjTo(bone.currentPicker,leftElem,bottomElem);if(bIsIE6&&!bIsIE7&&bone.maxHeight){bone.currentPicker.style.height="auto";bone.currentPicker.style.height=(bone.currentPicker.clientHeight<parseInt(bone.maxHeight))?bone.currentPicker.clientHeight+"px":bone.maxHeight;}bone.currentPicker.style.visibility="visible";togglePulldowns(bone.currentPicker,false);}else{if(oldPicker){togglePulldowns(oldPicker,true);}}}catch(err){microstrategy.errors.log(err);}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.togglePicker",0);}}return false;};dropDown.closePicker=function(F,D){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.closePicker",0);}if(!F){F=window.event;}var E=getEventTarget(F);var C=true;if(E){if(!E.getAttribute("id")&&E.parentNode.nodeType==1){E=E.parentNode;}var B=false;if(D.currentPicker){B=(findTarget(E,"ty")==D.currentPicker)&&(E!=D.currentPicker)&&(E.className.indexOf("disabled")<0);C=(E.className.indexOf("disabled")<0)&&(E!=D.currentPicker);}if(B){if(D.execPicker){C=D.execPicker(D.currentPicker,E);}else{alert("Option '"+E.getAttribute("id")+"' was selected from picker '"+D.currentPicker.id+"'. Please make sure the bone '"+D.id+"' implements execPicker.");}}}if(C&&D.currentPicker){dropDown.togglePicker(false,D.currentPicker.id,null,D);}return true;}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.closePicker",0);}}};dropDown.adjustPickerElements=function(I){try{var E=I.getAttribute(microstrategy.HTMLATTR_STYLE);switch(E){case"color":var H=microstrategy.userPalette;if(H){var B=microstrategy.findChildWithAtt(I,"span","name","pkrCustom");if(!B){return ;}if(B.getElementsByTagName("img").length==0){var J=document.createElement("img");J.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";B.appendChild(J);}displayObj(B);if(!ISIE7){var F=microstrategy.findChildWithAtt(I,"span","name","pkrMore");if(F){F.style.marginTop="25px";}}H=H.split(",");var A=microstrategy.findChildrenWithAtt(I,"span","custom","1");if(A.length==H.length&&A.length==8){if(A[0].id=="pkr"+H[0]){return ;}}else{if(A.length==H.length){return ;}}for(var D=0;D<A.length;D++){I.removeChild(A[D]);}for(var D=(H.length-1);D>=0;D--){var G=document.createElement("span");G.setAttribute("custom","1");G.id="pkr"+H[D];G.setAttribute("name","pkr"+H[D]);G.setAttribute("title",H[D]);G.style.backgroundColor=H[D];B.insertAdjacentElement("afterEnd",G);}}break;}}catch(C){microstrategy.errors.log(C);return false;}};mstrPickerImplScript=true;mstrPickerImpl.prototype=new mstrBoneImpl();mstrPickerImpl.prototype.pulldownName="";mstrPickerImpl.prototype.targetCombodown="";mstrPickerImpl.prototype.onload=function(){try{this.currentPicker=null;this.initPulldown();}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.initPulldown=function(){var C=new Function("e","return microstrategy.bone('"+this.id+"').togglePicker(e);");var B=document.getElementById(this.pulldownName);if(!B){return ;}for(var A=0;A<B.childNodes.length;A++){if(B.childNodes[A].tagName&&B.childNodes[A].tagName.toLowerCase()=="span"){B.childNodes[A].onclick=C;}}};mstrPickerImpl.prototype.execPicker=function(C,F){try{var E=true;var B=this.getAppliesTo();var G=F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!G){G=C.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);}var A=F.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!A){A=C.getAttribute(microstrategy.HTMLATTR_CMD_ID);}if(B&&A&&B.commands.queryEnabled(A)){E=B.commands.exec(A,G);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrPickerImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.togglePicker=function(E){try{if(!E){E=window.event;}var D=getEventTarget(E);var B="";if(D.getAttribute(microstrategy.HTMLATTR_CMD_ID)==null){this.targetCombodown=findTarget(D,microstrategy.HTMLATTR_CMD_ID);B=findTarget(D,microstrategy.HTMLATTR_CMD_ID).className;}else{B=D.className;}if(D&&B.indexOf("disabled")==-1){var F=D.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);if(!F){F=D.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);}var A=document.getElementById(F);if(D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){if(B.indexOf("Selected")==-1){this.targetCombodown.className="mstrCombodownSelected";}dropDown.togglePicker(true,F,D.parentNode,this);}else{this.execPicker(A,D);}}}catch(C){microstrategy.errors.log(C);}return false;};mstrPickerImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);this.targetCombodown.className="mstrCombodown";return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);alert(A);}};mstrPickerImpl.setPickerValues=function(D,F,G){try{if(D){D="pkr"+D;}var J=F.getElementsByTagName("span");for(var E=0,B=J.length;E<B;E++){var H=J[E];var I=true;if(G){I=microstrategy.isValueInFilter(G,H.getAttribute(microstrategy.HTMLATTR_FILTER_VALUE),H.getAttribute(microstrategy.HTMLATTR_FILTER_COMPARISON));var A=H.getAttribute(microstrategy.HTMLATTR_FILTER_TYPE);if(!A||A==0){H.style.display=(I)?"block":"none";}else{H.className=(I)?"":"disabled";}}if(I&&H.getAttribute("id")==D){H.className="selected";F.selected=H;}}}catch(C){microstrategy.errors.log(C);}};function mstrPickerImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrCreateImpl.prototype=new Object();mstrCreateImpl.prototype.IDBLANKREPORT=null;mstrCreateImpl.prototype.IDCHECKDESIGN="reportDesignMode";mstrCreateImpl.prototype.IDBLANKCHECKDESIGN="blank_reportDesignMode";mstrCreateImpl.prototype.rdoBlank=null;mstrCreateImpl.prototype.chkDesign=null;mstrCreateImpl.prototype.blank_chkDesign=null;mstrCreateImpl.prototype.bLastCheck=null;mstrCreateImpl.prototype.onClick=function(){if(this.chkDesign&&this.rdoBlank){if(this.rdoBlank.checked){this.bLastCheck=this.chkDesign.checked;this.chkDesign.checked=true;this.chkDesign.disabled=true;this.blank_chkDesign.name=createReport.IDCHECKDESIGN;}else{if(this.chkDesign.disabled){this.chkDesign.disabled=false;this.chkDesign.checked=this.bLastCheck;this.blank_chkDesign.name=createReport.IDBLANKCHECKDESIGN;}}}return true;};function mstrCreateImpl(){return this;}var createReport=new mstrCreateImpl();function selectOption(B){var A=getObj(B);if(A){A.click();}return ;}function selectOptionAndSubmit(C){var A=getObj(C);if(A){A.click();var B=findTargetTag(A,"FORM");if(B){B.submit();}}return ;}function initCreateReport(B,A){if(!createReport){return false;}createReport.IDBLANKREPORT=B;if(typeof (A)!="undefined"){createReport.IDCHECKDESIGN=A;createReport.IDBLANKCHECKDESIGN="blank_"+A;}createReport.rdoBlank=getObj(createReport.IDBLANKREPORT);createReport.chkDesign=getObj(createReport.IDCHECKDESIGN);createReport.blank_chkDesign=getObj(createReport.IDBLANKCHECKDESIGN);return true;}function onClickRadio(){if(createReport&&createReport.onClick){return createReport.onClick();}return true;}function selectBlankDocument(A,D){var C=findTargetTag(A,"form");if(C){updateDynamicInput(C,"objectID",D);if(A){var B=A.getAttribute("rwViewMode");if(B){updateDynamicInput(C,"rwViewMode",B);}}C.submit();}}mstrSubscriptionsFolderImplScript=true;mstrSubscriptionsFolderImpl.prototype=new mstrBoneImpl();mstrSubscriptionsFolderImpl.DMODES={INBOX:16,MOBILE:128,EMAIL:1,FILE:2,PRINT:4,FTP:8192,PERSONAL_VIEW:4096,CACHE:64};mstrSubscriptionsFolderImpl.VMODES={GRID:0,GRAPH:1,GRIDGRAPH:2,DOC:3,RW:4,BULK:5,DATAMART:6,ICUBE:7,DASHBOARD:9};mstrSubscriptionsFolderImpl.prototype.um=null;mstrSubscriptionsFolderImpl.prototype.onload=function(){try{this.initBone();var B=mstrSubscriptionsFolderImpl.DMODES;for(var E in B){var A=B[E];var F=document.getElementsByName("ncsList"+A);if(F&&F.length>=0){for(var C=0;C<F.length;C++){F[C].tBodies[0].onclick=new Function("e","var b = microstrategy.bone('"+this.id+"'); return b && b.onClick(e);");if(F[C].tHead){F[C].tHead.onclick=new Function("e","var b = microstrategy.bone('"+this.id+"'); return b && b.sortSubs(e);");}F[C].onmouseover=new Function("e","var b = microstrategy.bone('"+this.id+"'); return b && b.onMouseOver(e);");}}}this.um=microstrategy.updateManager;}catch(D){microstrategy.errors.log(D);return false;}};mstrSubscriptionsFolderImpl.prototype.onClick=function(G){var C=getEventTarget(G),J=microstrategy.findAncestorWithTag(C,"TR"),O=J?J.getAttribute("idx"):null,L=O?O.split("_"):null;if(L&&L.length>=2){var K=parseInt(L[0]),A=parseInt(L[1]),H=this._getItems(C),N=H?H[A]:null,B=C.getAttribute("cmd")||(window.mstrInterfacePlugin?C.parentNode.getAttribute("cmd"):null);if(N&&B){var P=N.vm==8192,F=N.vm==2048;if(P||F){var E=microstrategy.isFeatureAvailable("flashvi"),I="";if(P&&E){I=13649;}else{if((P||F&&!E)&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){I=12187;}}if(I){showMessage({contents:microstrategy.descriptors.getDescriptor(I),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}}switch(B){case"tgt":case"tgti":this.viewTarget(N.sID,N.tTp,N.tID);break;case"edit":this.editSubs(K,N.sID);break;case"psn":this.editPersonalization(K,N.sID);break;case"rmv":this.rmvSubs(N.sID);break;case"chk":this.updateChkbox(C,N.sID);break;case"mult":var D=microstrategy.findAncestorWithTag(C,"TABLE");var M=N.cNO;if(D&&M){this.onClickMulti(D,C,A+1,M);}break;}}}};mstrSubscriptionsFolderImpl.prototype.onMouseOver=function(E){var C=getEventTarget(E);if(!C.getAttribute("title")){var D=C?C.getAttribute("cmd"):null;var B=C?C.getAttribute("fld"):null;var F=null;if(D=="tgti"){this.showTgtName(C);}else{if(D){F={mult:"3296",edit:"1088",psn:"6073",chk:"1087",rmv:"1087"}[D];}else{if(B){var A=this._getSortInfo(C);F=(A&&B==A.field&&A.asc==0)?"192":"191";}}if(F){C.setAttribute("title",microstrategy.descriptors.getDescriptor(F));}}}};mstrSubscriptionsFolderImpl.prototype.onClickMulti=function(E,D,B,I){if(E&&D){var F=E.tBodies[0];var J=F?F.rows:null;if(J&&B<J.length){for(i=B;i<B+I;i++){var A=J[i];var C=A.style.display=="none"?"":"none";var G=(C=="none")?"ncsExpand":"ncsCollapse";var H=microstrategy.descriptors.getDescriptor(((C=="none")?"3296":"1995"));A.style.display=C;D.className=G;D.setAttribute("title",H);}}}};mstrSubscriptionsFolderImpl.prototype.viewTarget=function(B,E,I){var G=this.um;var D=mstrUpdateManager;if(G&&D){var C=mstrSubscriptionsFolderImpl.VMODES;var J=new Array();var F=null;var H=null;var A=this.save2HL?"1":"0";if(E==C.RW&&this.PDF){if(this.newWin){F=G.getNewWindowSetting();H=G.newWindowName;G.setNewWindowSetting(true);G.newWindowName=this.newWin;}}else{if(this.newWinExec){F=G.getNewWindowSetting();H=G.newWindowName;G.setNewWindowSetting(true);G.newWindowName=this.newWinExec;}}switch(E){case C.GRID:case C.GRAPH:case C.GRIDGRAPH:J.push(G.createActionObject(null,D.REPORT_INIT_FROM_SUBSCRIPTION,null,["4163","4115","4172"],[B,E+1,A],[],null));break;case C.DOC:J.push(G.createActionObject(null,D.DOCUMENT_INIT_FROM_SUBSCRIPTION,null,["32316","32317"],[B,A],[],null));break;case C.RW:J.push(G.createActionObject(null,D.RW_INIT_FROM_SUBSCRIPTION,null,["2048058"],[B],[],null));if(this.PDF){J.push(G.createActionObject(null,D.RW_EXPORT,null,["3115"],[3],[],null));}break;case C.DASHBOARD:J.push(G.createActionObject(null,D.HTML5_VI_INIT_FROM_SUBSCRIPTION,null,["2048058"],[B],[],null));break;case C.BULK:return ;case C.DATAMART:case C.ICUBE:J.push(G.createActionObject(null,D.REPORT_INIT_FROM_SUBSCRIPTION,null,["4163","4172"],[B,A],[],null));G.addURL("SubscriptionReportID="+I);break;}if(J.length>0){G.add(J);G.useIframe=false;G.flushAndSubmitChanges();if(F!=null){G.setNewWindowSetting(F);}if(H!=null){G.newWindowName=H;}}}};mstrSubscriptionsFolderImpl.prototype.showTgtName=function(D){var E=microstrategy.findAncestorWithTag(D,"TR"),H=E?E.getAttribute("idx"):null,A=H?H.split("_"):null;if(A&&A.length>=2){var F=parseInt(A[0]),G=parseInt(A[1]),B=this._getItems(D),C=B?B[G]:null;if(C&&C.tl){D.setAttribute("title",C.tl);}}};mstrSubscriptionsFolderImpl.prototype.editSubs=function(B,A){this._edit(B,A,2);};mstrSubscriptionsFolderImpl.prototype.editPersonalization=function(B,A){this._edit(B,A,1);};mstrSubscriptionsFolderImpl.prototype.updateChkbox=function(B,A){if(B&&A){B.value=A;B.id=B.name="objectIDs";}};mstrSubscriptionsFolderImpl.prototype.rmvSubs=function(A){var B=this.um;if(B&&A){B.add([B.createActionObject(null,mstrUpdateManager.DELETE_SUBSCRIPTION,this.beanPath,["128001"],[A],[],null)]);B.useIframe=false;B.flushAndSubmitChanges();}};mstrSubscriptionsFolderImpl.prototype.sortSubs=function(F){var D=getEventTarget(F);var G=this._getMode(D);var B=this._getSortInfo(D);var E=D?D.getAttribute("fld"):null;if(B&&E){var C=(E==B.field)?B.asc:1;var A=this.um;if(A){A.add([A.createActionObject(null,mstrUpdateManager.SORT_SUBSCRIPTIONS,this.beanPath,["128009","128003","128004"],[G,E,C],[],null)]);A.useIframe=false;A.flushAndSubmitChanges();}}};mstrSubscriptionsFolderImpl.prototype._getMode=function(A){var B=A?microstrategy.findAncestorWithTag(A,"TABLE"):null;return(B&&B.id&&B.id.substring(0,7)=="ncsList")?B.id.substring(7):null;};mstrSubscriptionsFolderImpl.prototype._getSortInfo=function(B){var A=this._getItems(B);return(A?A.sortInfo:null);};mstrSubscriptionsFolderImpl.prototype._getItems=function(A){if(!this.items){return null;}var E=A?microstrategy.findAncestorWithTag(A,"TR"):null,G,F,C;if(!E||E.getAttribute("idx")==null){var H=A?microstrategy.findAncestorWithTag(A,"TABLE"):null,I=H&&H.rows,D=I.length||0,B;for(B=0;B<D;B++){E=I[B];if(E.getAttribute("idx")!=null){break;}}}G=E?E.getAttribute("idx"):null;F=G?G.split("_"):null;if(F&&F.length>=2){C=F[0];if(this.items[C]){return this.items[C];}if(C==mstrSubscriptionsFolderImpl.DMODES.PERSONAL_VIEW&&F.length==3){return this.items[C+"_"+F[2]];}}return null;};mstrSubscriptionsFolderImpl.prototype._edit=function(B,A,E){var C=this._getEditEvt(B);var D=this.um;if(D&&C){D.add([D.createActionObject(null,C,null,["3001","256012"],[A,E],[],null)]);D.useIframe=false;D.flushAndSubmitChanges();}};mstrSubscriptionsFolderImpl.prototype._getEditEvt=function(C){var A=mstrSubscriptionsFolderImpl.DMODES;var B=mstrUpdateManager;switch(C){case A.INBOX:return B.EDIT_INBOX_SUBSCRIPTION;case A.CACHE:return B.EDIT_CACHE_SUBSCRIPTION;case A.MOBILE:return B.EDIT_MOBILE_SUBSCRIPTION;case A.EMAIL:return B.EDIT_EMAIL_SUBSCRIPTION;case A.FILE:return B.EDIT_FILE_SUBSCRIPTION;case A.PRINT:return B.EDIT_PRINT_SUBSCRIPTION;case A.FTP:return B.EDIT_FTP_SUBSCRIPTION;case A.PERSONAL_VIEW:return B.EDIT_PERSONAL_VIEW_SUBSCRIPTION;case A.PERSONAL_VIEW:return B.EDIT_PERSONAL_VIEW_SUBSCRIPTION;default:return null;}};function mstrSubscriptionsFolderImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrFolderImplScript=true;mstrFolderImpl.prototype=new mstrBoneImpl();mstrFolderImpl.prototype.currentContextMenuNode=null;mstrFolderImpl.prototype.inlineRenameObject=null;mstrFolderImpl.prototype.folderId=null;mstrFolderImpl.prototype.serverName=null;mstrFolderImpl.prototype.projectName=null;mstrFolderImpl.prototype.portNum=null;mstrFolderImpl.prototype.minColWidth=[32,100,100,100,100,130];mstrFolderImpl.prototype.colCount=6;mstrFolderImpl.prototype.ascCss="mstrSortIconAsc";mstrFolderImpl.prototype.descCss="mstrSortIconDesc";mstrFolderImpl.prototype.onload=function(){try{this.initBone();this.initFolderBone();this.updateQuickSearchBone();scroll(0,0);}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderImpl.prototype.initFolderBone=function(){try{this.elem.oncontextmenu=new Function("e","microstrategy.bone('"+this.id+"').onContextMenu(e); return true;");this.commands=this.setCommands();if(!mstr.utils.ISIE7){this.table=this.findTable();if(this.table){this.elem.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e); return true;");this.colGroups=[this.table.children[0]];if(this.colGroups&&this.colGroups[0]){this.colCount=this.colGroups[0].childNodes.length;}this.headersNode=this.table.tHead;this.elem.onclick=new Function("e","microstrategy.bone('"+this.id+"').onclick(e); return true;");this._buildColGroup();}this.lockHeader();if(this.table){this.initSort(true);}else{this.initSort(false);}}}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderImpl.prototype.setCommands=function(){return new mstrFolderCommands(this);};mstrFolderImpl.prototype.findTable=function(){return microstrategy.findChildWithAtt(this.elem,"table","id","FolderList");};mstrFolderImpl.prototype.lockHeader=function(){try{var B=this;B.divLock=B.cloneListHeader4Lock();if(!B.divLock){return ;}B.tableLocked=B.divLock.firstChild;B.headersNode_locked=B.tableLocked.tHead;B.colGroups.push(B.tableLocked.children[0]);}catch(A){microstrategy.errors.log(A);}};mstrFolderImpl.prototype.cloneListHeader4Lock=function(){try{var F=this.table||document.getElementById("FolderList");if(!F){return null;}var C=this.table.cloneNode(false);var G=F.getElementsByTagName("colgroup");if(G){for(var B=0,A=G.length;B<A;B++){C.appendChild(G[B].cloneNode(true));}}C.appendChild(F.tHead.cloneNode(true));var H=document.createElement("div");H.className="mstrListView-locked";var D=document.getElementById("mstrWeb_error");if(D){this.elem.style.marginTop=this.elem.offsetTop+"px";D.style.cssText="position: fixed; background: white; z-index: 1; width:"+D.offsetWidth+"px";}H.style.marginLeft=-(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";mstr.$D.attachEvent(window,"scroll",function(I){H.style.marginLeft=-(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";});H.appendChild(C);F.parentNode.insertBefore(H,F);return H;}catch(E){microstrategy.errors.log(E);}};mstrFolderImpl.prototype._buildColWidths=function(){if(this.headersNode===undefined){return ;}this.colWidths=this.colWidths||[];var B=this.colWidths;if(B.length===0){for(var D=this.colCount-1;D>-1;D--){B[D]=this.headersNode.rows[0].cells[D].offsetWidth;}}var A=0;for(var C=B.length-1;C>-1;C--){A+=B[C];}var E=document.getElementById("mstrWeb_content").clientWidth;this.table.style.width=this.headersNode.style.width=E+"px";if(this.tableLocked){this.tableLocked.style.width=this.headersNode_locked.style.width=this.table.offsetWidth+"px";}};mstrFolderImpl.prototype._buildColGroup=function _buildColGroup(){this._buildColWidths();var K=this.resizingIndex,B=this.colWidths,I=this.colGroups;if(I&&I[0].childNodes.length==this.colCount){if((K!==null&&K>=0)){for(var F=I.length-1;F>-1;F--){for(var E=I[F].childNodes.length-1;E>-1;E--){I[F].childNodes[E].style.width=B[E]+"px";}}}}else{var A=document.createElement("colgroup");for(var G=0,D=this.colCount;G<D;G++){var C=document.createElement("col");C.style.width=B[G]+"px";A.appendChild(C);}var J=function(L,M){L[(L.firstChild.tagName.toLowerCase()!="colgroup")?"insertBefore":"replaceChild"](M,L.firstChild);};J(this.headersNode,A);var H=A.cloneNode(true);J(this.itemsNode,H);this.colGroups=[A,H];}};mstrFolderImpl.prototype.initSort=function(B){if(!microstrategy.bones.folderAllModes){return ;}this.folderId=microstrategy.bones.folderAllModes.folderId;if(!this.folderId){return ;}var A=this.loadSorting(this.folderId);if(!A){return ;}if(B){this.sortListViewObjectBrowser(A.SortColID,A.isAscSort);}else{this.sortFolderViewObjectBrowser(A.SortColID,A.isAscSort);}};mstrFolderImpl.prototype.loadSorting=function(){if(!this.folderId){return ;}var C="ObjectBrowserSorting_"+mstrConfig.lastMsgKey;if(typeof (Storage)!="undefined"&&window.JSON){var B=null;if(localStorage.getItem(C)){B=JSON.parse(localStorage.getItem(C));}if(B){for(var A=0;A<B.length;A++){if(B[A].folderID==this.folderId){return B[A];}}}}return null;};mstrFolderImpl.prototype.saveSorting=function(A,B){if(typeof (Storage)=="undefined"||!window.JSON){return ;}if(!this.folderId){return ;}var E="ObjectBrowserSorting_"+mstrConfig.lastMsgKey;var D=null;if(localStorage.getItem(E)!=null){D=JSON.parse(localStorage.getItem(E));}if(D){var F=false;for(var C=0;C<D.length;C++){if(D[C].folderID==this.folderId){D[C].SortColID=A;D[C].isAscSort=B;F=true;break;}}if(!F){D[length]={folderID:this.folderId,SortColID:A,isAscSort:B};}}else{D=[];D[0]={folderID:this.folderId,SortColID:A,isAscSort:B};}localStorage.setItem(E,JSON.stringify(D));};mstrFolderImpl.prototype.onclick=function(E){this.onselectstartFn=document.onselectstart;var A=window,E=E||window.event;var G=mstr.$E.target(E,A);var D=G.parentNode.parentNode.parentNode.parentNode.parentNode;if(!G||!D||D.getAttribute("class")!="mstrListView-locked"||!G.parentNode.previousSibling||!G.parentNode.nextSibling){return ;}var C=G.parentNode.cellIndex;var B=true;var F=null;F=microstrategy.findChildWithAtt(this.elem,"span","id",this.descCss);if(!F){F=microstrategy.findChildWithAtt(this.elem,"span","id",this.ascCss);}if(!F){return ;}if(F.parentNode.parentNode.cellIndex==C){B=F.id==this.ascCss?false:true;}else{if(C==3){B=false;}}this.sortListViewObjectBrowser(C,B);this.saveSorting(C,B);};mstrFolderImpl.prototype.sortFolderViewObjectBrowser=function(L,K){var C=[],H=[];var D=microstrategy.findChildWithAtt(this.elem,"table","id","FolderIcons");var E=D.getElementsByTagName("tbody")[0];var Q=E.childNodes;microstrategy.showWait(true);for(var G=0;G<Q.length;G++){var J=Q[G].childNodes;for(var F=0;F<J.length;F++){if(N(J[F])){C.push(J[F]);}else{H.push(J[F]);}}}switch(L){case 1:C.sort(I);H.sort(I);break;case 2:C.sort(B);H.sort(B);break;case 3:C.sort(M);H.sort(M);break;case 4:C.sort(O);H.sort(O);break;}while(E.hasChildNodes()){E.removeChild(E.firstChild);}var A=[];if(K){A=C.concat(H);}else{A=H.reverse().concat(C.reverse());}for(var G=0;G<=A.length/2-1;G++){var P=document.createElement("tr");P.appendChild(A[2*G]);P.appendChild(A[2*G+1]);E.appendChild(P);}if(E.childNodes.length<A.length/2){var P=document.createElement("tr");P.appendChild(A[A.length-1]);E.appendChild(P);}microstrategy.showWait(false);function I(T,R){var V=microstrategy.findChildWithCssClass(T,"div","mstrLargeIconViewItemName");var S=microstrategy.findChildWithCssClass(R,"div","mstrLargeIconViewItemName");var W=V.innerText||V.textContent||"";var U=S.innerText||S.textContent||"";return W.localeCompare(U);}function B(T,S){var V=microstrategy.findChildWithCssClass(T,"div","mstrLargeIconViewItemOwner");var U=microstrategy.findChildWithCssClass(S,"div","mstrLargeIconViewItemOwner");var R=V.innerText||V.textContent||"";var X=U.innerText||U.textContent||"";var W=R.localeCompare(X);if(!W){return I(T,S);}return W;}function M(T,R){var U=microstrategy.findChildWithCssClass(T,"div","mstrLargeIconViewItemModified");var S=microstrategy.findChildWithCssClass(R,"div","mstrLargeIconViewItemModified");var W=Number(U.getElementsByTagName("div")[0].getAttribute("timestamp"));var V=Number(S.getElementsByTagName("div")[0].getAttribute("timestamp"));if(W>V){return 1;}else{if(W==V){return 0;}else{if(W<V){return -1;}}}}function O(T,S){var R=microstrategy.findChildWithCssClass(T,"div","mstrLargeIconViewItemDescription");var X=microstrategy.findChildWithCssClass(S,"div","mstrLargeIconViewItemDescription");var W=R.innerText||R.textContent||"";var V=X.innerText||X.textContent||"";var U=W.localeCompare(V);if(!U){return I(T,S);}return U;}function N(R){if(microstrategy.findChildWithAtt(R,"span","class","mstrIcon-lg mstrIcon-lg-f")){return true;}return false;}};mstrFolderImpl.prototype.sortListViewObjectBrowser=function(K,B){var Q=[],N=[];var H=0;var S=microstrategy.findChildWithAtt(document,"div","scriptclass","mstrFolderImpl");var E=microstrategy.findChildWithAtt(S,"div","class","mstrListView-locked");var O=microstrategy.findChildWithAtt(E,"span","id",this.ascCss);if(!O){O=microstrategy.findChildWithAtt(E,"span","id",this.descCss);}if(!O){return ;}microstrategy.showWait(true);if(B&&O.id==this.descCss){O.id=this.ascCss;}else{if(!B&&O.id==this.ascCss){O.id=this.descCss;}}var J=E.getElementsByTagName("tr")[0];J.childNodes[K].getElementsByTagName("div")[0].appendChild(O);var R=E.nextSibling;var C=R.getElementsByTagName("tbody")[0];var M=C.childNodes;for(var P=0;P<M.length;P++){if(microstrategy.findChildWithCssClass(M[P].childNodes[0],"span","mstrIcon-lv mstrIcon-lv-f")){Q.push(M[P]);}else{N.push(M[P]);}}switch(K){case 1:Q.sort(I);N.sort(I);break;case 2:Q.sort(L);N.sort(L);break;case 3:Q.sort(F);N.sort(F);break;case 4:Q.sort(A);N.sort(A);break;}while(C.hasChildNodes()){C.removeChild(C.firstChild);}var G=[];if(B){G=Q.concat(N);}else{G=N.reverse().concat(Q.reverse());}for(var P=0;P<G.length;P++){H++;D(G[P],H);C.appendChild(G[P]);}microstrategy.showWait(false);function I(V,T){var X=1;var Z=V.childNodes[X];var Y=T.childNodes[X];var W=Z.innerText||Z.textContent||"";var U=Y.innerText||Y.textContent||"";return W.localeCompare(U);}function L(V,T){var X=2;var c=V.childNodes[X];var Z=T.childNodes[X];var W=c.innerText||c.textContent||"";var U=Z.innerText||Z.textContent||"";var Y=W.localeCompare(U);if(!Y){return I(V,T);}else{return Y;}}function F(U,T){var V=3;var X=Number(U.childNodes[V].childNodes[0].getAttribute("timestamp"));var W=Number(T.childNodes[V].childNodes[0].getAttribute("timestamp"));if(X>W){return 1;}else{if(X==W){return 0;}else{if(X<W){return -1;}}}}function A(V,T){var X=4;var c=V.childNodes[X];var Z=T.childNodes[X];var W=c.innerText||c.textContent||"";var U=Z.innerText||Z.textContent||"";var Y=W.localeCompare(U);if(!Y){return I(V,T);}else{return Y;}}function D(U,T){if(T%2==0&&!U.hasAttribute("class")){U.setAttribute("class","mstrBandOn");}else{if(T%2!=0&&U.hasAttribute("class")){U.removeAttribute("class");}}}};mstrFolderImpl.prototype.onmousedown=function(E){this.onselectstartFn=document.onselectstart;var C=window,E=E||window.event;var A=mstr.$E.target(E,C);if(A&&A.tagName.toLowerCase()=="td"&&A.parentNode.parentNode.tagName.toLowerCase()=="thead"){document.onselectstart=function(){return false;};var H=A.offsetLeft+A.offsetWidth-getDocumentScrollLeft();this.resizingIndex=A.cellIndex;this.startx=mstr.$E.getMousePosition(E,C).x;var J=function(K){var L=document.createElement("div");L.className="mstrListView-rzHandle";L.style.left=K+"px";return L;};var I=this.resizeHandle||J(H);if(!this.resizeHandle||!mstr.$D.containsElement(this.elem,I)){this.resizeHandle=I;this.elem.appendChild(I);}else{I.style.left=H+"px";}I.style.display="block";this.elem.className+=" resizing";var G=this;var D=function(K){I.style.left=Math.max(0,H+mstr.$E.getMousePosition(K,C).x-G.startx)+"px";};var B=function(L){if(I){I.style.display="none";mstr.$D.detachEvent(document,"mousemove",D);mstr.$D.detachEvent(document,"mouseup",B);}G.elem.className=G.elem.className.replace(/ resizing/,"");document.onselectstart=G.onselectstartFn;var K=G.resizingIndex;if(K>=0&&K!=G.colWidths.length-1){F(G,L);G._buildColGroup();G.resizingIndex=null;}};var F=function(N,P){var O=N.colWidths,M=N.minColWidth,L=N.resizingIndex,K=O.length-1,R=O[L],Q;O[L]=Math.max(M[L],O[L]+mstr.$E.getMousePosition(P,C).x-N.startx);Q=O[L]-R;while(Q!=0&&K>=L){if(O[K]-Q>=M[K]){O[K]-=Q;Q=0;}else{Q-=O[K]-M[K];O[K]=M[K];K--;}}};mstr.$D.attachEvent(document,"mousemove",D);mstr.$D.attachEvent(document,"mouseup",B);}};mstrFolderImpl.prototype.onContextMenu=function(C){try{if(!C){C=window.event;}var A=getEventTarget(C);if(A.tagName.toLowerCase()!="tr"){A=findTargetTag(A,"tr");}if(A.tagName.toLowerCase()=="tr"){this.currentContextMenuNode=A;}else{this.currentContextMenuNode=null;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFolderImpl.prototype.processRename=function(){try{if(this.inlineRenameObject){this.inlineRenameObject.processRename(this.beanPath);this.inlineRenameObject=null;}}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderImpl.prototype.cancelRename=function(){try{if(this.inlineRenameObject){this.inlineRenameObject.cancelRename();this.inlineRenameObject=null;}}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderImpl.prototype.getNameTag=function(){try{return microstrategy.findChildWithAtt(this.currentContextMenuNode,"span","sty","nm");}catch(A){microstrategy.errors.log(A);return false;}};mstrFolderImpl.prototype.getCurrentContextId=function(){return microstrategy.findChildWithAtt(this.currentContextMenuNode,"td","oty","1").getAttribute("oid");};mstrFolderImpl.prototype.getObjInfo=function(){var E=this.currentContextMenuNode;if(E){var D=E.getElementsByTagName("td"),G;for(var C=0,A=D.length;C<A;C++){G=D[C];if(G.getAttribute("oid")){var F=microstrategy.findChildWithAtt(E,"span",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.HTMLATTR_NAME),B="";if(F){B=F.firstChild.getAttribute("title");}return{id:G.getAttribute("oid"),ty:G.getAttribute("oty"),n:B};}}}return null;};mstrFolderImpl.prototype.enableRenameField=function(B,A){try{if(this.currentContextMenuNode){this.inlineRenameObject=new mstrInlineRenameImpl();this.inlineRenameObject.parentBone=this;this.inlineRenameObject.enableRenameField(B,A);}}catch(C){microstrategy.errors.log(C);return false;}};mstrFolderImpl.prototype.openCustomGroupEditor=function(A){microstrategy.openCustomGroupEditor(A);};mstrFolderImpl.prototype.openMetricEditor=function(B,A){microstrategy.openMetricEditor(B,A);};mstrFolderImpl.prototype.openDataImport=function(A,B){microstrategy.openDataImprot(A,B);};mstrFolderImpl.prototype.openACLEditor=function(A,B){microstrategy.openACLEditor(A,B);};mstrFolderImpl.prototype.updateQuickSearchBone=function(){var A=microstrategy.bone("mstrSearchSuggest");if(A&&A.isMiniSearchBox){if(this.folderName){A.rootFolderName=mstr.utils.String.escape4HTMLText(this.folderName);}if(this.sysFolder!=undefined){A.rootFolderType=this.sysFolder;}if(this.folderId){A.rootFolderID=this.folderId;}A.updateTipText();}};mstrFolderImpl.prototype.showExportLink=function(C,A,B){mstrFolderActions.exportLink(C,this.serverName,this.projectName,this.portNum,A,B);};mstrFolderImpl.prototype.onwinresize=function(){this._buildColWidths();};function mstrFolderImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrFolderCommands.prototype={};mstrFolderCommands.prototype.exec=function(K,B){switch(K){case"edit":this.parentBone.openCustomGroupEditor(this.parentBone.getCurrentContextId());break;case"newCGE":this.parentBone.openCustomGroupEditor();break;case"newIVE":microstrategy.createIVE.call(this.parentBone);break;case"newIVEHTML5VI":microstrategy.createIVE.call(this.parentBone,true);break;case"newBlankVI":var I=!microstrategy.isFeatureAvailable("flashvi");if(I&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}else{var C=microstrategy.updateManager,J=[];J.push(C.createActionObject(null,mstrUpdateManager.CREATE_BLANK_VI,microstrategy.servletName,[],[]));C.add(J);C.useIframe=false;C.flushAndSubmitChanges();}break;case"ACLEditor":var F=this.parentBone.getObjInfo();if(F){this.parentBone.openACLEditor(F.id,F.ty);}break;case"shareEditor":var F=this.parentBone.getObjInfo();microstrategy.showSharingEditor(B.url,{objectName:B.name,objId:F.id,objType:F.ty,mid:-1});break;case"newME":this.parentBone.openMetricEditor(null,"mstrME");break;case"newSME":this.parentBone.openMetricEditor(null,"mstrSME");break;case"newFSE":this.parentBone.openMetricEditor(null,"mstrFSE");break;case"openME":var F=this.parentBone.getObjInfo();if(F){this.parentBone.openMetricEditor(F.id);}break;case"openDataImport":microstrategy.openDataImport.call(this.parentBone,B);break;case"republishCube":var G=B.ReportId,D=this;microstrategy.getCubesInfo([G],function(M){var L=function(){D.exec("openDataImport",B);};if(M[G]&&M[G].ddam===2){showMessage({contents:microstrategy.descriptors.getDescriptor(13885),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,type:mstrMsgBoxImpl.MSG_INFO_WARNING,okEval:L,focusButton:microstrategy.CANCEL_BUTTON});return ;}L();});break;case"findDependents":var H=this.parentBone.getObjInfo();var E=mstrmojo.insert({scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-Search-editor",zIndex:102,title:microstrategy.descriptors.getDescriptor(14532)+" "+H.n,children:[{scriptClass:"mstrmojo.mstr.search.Search",id:"search",searchProps:mstrmojo.hash.copy({uses:H.id+":"+H.ty,objectType:[3,18,14081],dereferenceshortcut:0,rootFolderID:"",rootFolderType:39,searchPattern:"*"},mstrmojo.hash.copy(mstrConfig.searchProps)),allowEmptyInput:true,resultsOnly:true,getNotFoundMsg:function A(){var L=function(N){return"<b>"+mstrmojo.string.escape4HTMLText(N)+"</b>";};var M=mstrmojo.desc(14557,"Your search for dependents of ## in ### returned no results").replace("###",L(mstrConfig.projectName)).replace("##",L(H.n));return M;}}],onOpen:function(){var L=45;this.set("top",mstrmojo.dom.getVerticalScroll()+L+"px");},onClose:function(){this.destroy();}});E.render();E.open();mstrmojo.all.search.forceSearch();break;}};mstrFolderCommands.prototype.queryVisible=function(A,E){try{var C=this.parentBone.getObjInfo();if(!C){return false;}switch(A){case"canFindDependents":var D=[8,18];return mstr.$A.find(D,parseInt(C.ty,10))==-1;}}catch(B){microstrategy.errors.log(B);}};function mstrFolderCommands(A){this.parentBone=A;return this;}mstrFolderActionsScript=true;mstrFolderActions=new Object();mstrFolderActions.checkACL=function(C,F,H,A,B){try{var G=false;if(C&&C.getAttribute("ty")=="sub"){iframe.showWaitPage();mstr.$XHR.request(mstrApp.taskURL||mstrConfig.taskURL,{taskId:"getSubscriptionAssociatedInformation",loadInfo:"checkACL",objectID:H,objectType:A},{success:function(I){G=I.user.allow;}},false);iframe.hideWaitPage();}if(!G){var E=microstrategy.descriptors.getDescriptor("9181");showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});F=F||window.event;stopEventBubbling(F);cancelEvent(F);}return G;}catch(D){microstrategy.errors.log(D);}};mstrFolderActions.submitShowBeanEvent=function(D,A,B){try{var E="&actionType="+D+"&objectId="+A+"&objectType="+B;microstrategy.updateManager.useIframe=true;toggleShowBean("OMD",true,E);}catch(C){microstrategy.errors.log(C);return false;}};mstrFolderActions.actionConfirmDelete=function(A,B,G,C,D){try{var F=D?microstrategy.descriptors.getDescriptor("3833"):microstrategy.descriptors.getDescriptor("3829");F=F.replace("##",G);showMessage({contents:F,elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:'mstrFolderActions.actionNewMenuItemClick("delete", "'+A+'", ["'+B+'", "'+C+'"])',type:mstrMsgBoxImpl.MSG_WARNING});}catch(E){microstrategy.errors.log(E);return false;}};mstrFolderActions.actionNewMenuItemClick=function(E,A,C){try{var D=microstrategy.updateManager;var B=new Array();switch(E){case"newFilter":B.push(D.createActionObject(null,mstrUpdateManager.CREATE_NEW_FILTER,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CREATE_NEW_FILTER].paramID,["",true,A]));break;case"newPrompt":if(C.length==2){B.push(D.createActionObject(null,mstrUpdateManager.CREATE_NEW_PROMPT,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CREATE_NEW_PROMPT].paramID,[C[0],A,C[1]]));}else{if(C.length==1){B.push(D.createActionObject(null,mstrUpdateManager.CREATE_NEW_PROMPT,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CREATE_NEW_PROMPT].paramID,[C[0],A]));}}break;case"createDocument":B.push(D.createActionObject(null,mstrUpdateManager.CONVERT_TO_DOCUMENT,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CONVERT_TO_DOCUMENT].paramID,[A,"",1,2,microstrategy.DSSTYPE_RPT_DEFINITION]));break;case"delete":B.push(D.createActionObject(null,mstrUpdateManager.DELETE_OBJECT,C[1],mstrUpdateManager.actions[mstrUpdateManager.DELETE_OBJECT].paramID,[A,parseInt(C[0])]));break;case"newDocument":B.push(D.createActionObject(null,mstrUpdateManager.CREATE_NEW_DOCUMENT,microstrategy.servletName,["3185"],[A]));break;case"newReport":B.push(D.createActionObject(null,mstrUpdateManager.REPORT_NEW,microstrategy.servletName,["3185"],[A]));break;}D.add(B);D.useIframe=false;D.flushAndSubmitChanges();}catch(F){microstrategy.errors.log(F);return false;}};mstrSelectionsImpl.prototype={};mstrSelectionsImpl.prototype.length=0;mstrSelectionsImpl.prototype.path="";mstrSelectionsImpl.prototype.dragX=0;mstrSelectionsImpl.prototype.dragY=0;mstrSelectionsImpl.prototype.mousedownX=0;mstrSelectionsImpl.prototype.mousedownY=0;mstrSelectionsImpl.prototype.shiftKey=false;mstrSelectionsImpl.prototype.ctrlKey=false;mstrSelectionsImpl.prototype.clickedSrc=null;mstrSelectionsImpl.prototype.onload=function(A){};mstrSelectionsImpl.prototype.onmousedown=function(B){try{if(!B){B=window.event;}getMouse(B);this.mousedownX=lMouseX;this.mousedownY=lMouseY;}catch(A){microstrategy.errors.log(A);}};mstrSelectionsImpl.prototype.onmouseup=function(C,B){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener((B)?B:this,"mousemove");this.parentBone.detachWinListener((B)?B:this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.ondeselect=function(B){try{if(B.e){B=B.e;}this.onmouseup(B);if(this.clickedSrc!=null){this.remove(this.clickedSrc);}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.ondragstart=function(C){try{if(!C){C=window.event;}if(C.e){C=C.e;}getMouse(C);if(Math.abs(lMouseX-this.mousedownX)>=3||Math.abs(lMouseY-this.mousedownY)>=3){microstrategy.eventManager.onnotifydrag(this.items,this.parentBone,this.getDssTypes());var A=microstrategy.getEventHandlerString(this.path);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","ondrag");this.parentBone.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",A+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",A+" { return "+this.path+".ondragend(e); }");}this.ondrag(C);}}catch(B){microstrategy.errors.log(B);}return false;};mstrSelectionsImpl.prototype.ondrag=function(A){};mstrSelectionsImpl.prototype.ondragend=function(A){};mstrSelectionsImpl.prototype.add=function(B){try{this.items[B.getAttribute("id")]=B;this.length++;if(this.parentBone&&this.parentBone.onselectionchange){this.parentBone.onselectionchange();}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.remove=function(B){try{delete this.items[B.getAttribute("id")];this.length--;if(this.parentBone.onselectionchange){this.parentBone.onselectionchange();}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.clear=function(C,B){try{if(C==null){C=true;}this.items={};this.length=0;if(C&&this.parentBone&&this.parentBone.onselectionchange){this.parentBone.onselectionchange(B);}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.firstItem=function(){try{for(member in this.items){return this.items[member];break;}}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.isMulti=function(){try{return(this.length>1);}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.isSelected=function(B){try{return(typeof (this.items[B.getAttribute("id")])!="undefined");}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.isActive=function(){try{return(this.length>0);}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.getTypes=function(){try{var A=[];var B=0;for(var D in this.items){if(this.items[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)){A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_OBJTYPE)+"."+this.items[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}else{A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_OBJTYPE);}}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.isSameType=function(){try{var A=this.getDssTypes();A.sort(function(D,C){return parseInt(D)-parseInt(C);});return(A[0]==A[A.length-1]);}catch(B){microstrategy.errors.log(B);return null;}};mstrSelectionsImpl.prototype.isOnlyMetrics=function(){try{for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_METRIC&&this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_USER_METRIC&&this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_USER_SUMMARY_METRIC){return false;}}return true;}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getDssTypes=function(){try{var A=[];var B=0;for(var D in this.items){A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.getSelectedIds=function(){try{var C="|";for(var B in this.items){C+=B+"|";}return C;}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.getDataSetIDs=function(){try{var B=[];var C=0;for(var E in this.items){var A=new mstrObjectInfoImpl(this.items[E]);B[C++]=A.dSetId;}return B;}catch(D){microstrategy.errors.log(D);return null;}};mstrSelectionsImpl.prototype.getSelectionsKey=function(){try{var A=[];var B=0;for(var D in this.items){A[B++]=this.items[D].id;}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.getFirstObjSubType=function(){try{var A=null;var C=this.firstItem();if(C){A=C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrSelectionsImpl.prototype.getFirstObjType=function(){try{var A=null;var C=this.firstItem();if(C){A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrSelectionsImpl.prototype.getChildren=function(B){try{return B.parentNode.parentNode.lastChild.getElementsByTagName("span");}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getItems=function(){try{return mstr.utils.Arrays.fromHashValues(this.items);}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getInnerRect=function(D){try{var C=microstrategy.styleObj;var B={};B.left=getObjSumLeft(D);B.top=getObjSumTop(D);if(bIsIE6){B.right=B.left+getObjWidth(D);B.bottom=B.top+getObjHeight(D);}else{B.left+=D.clientLeft;B.top+=D.clientTop;B.right=B.left+C.getInnerWidth(D);B.bottom=B.top+C.getInnerHeight(D);}if(B.right<(B.left+1)){B.right=B.left+1;}if(B.bottom<(B.top+1)){B.bottom=B.top+1;}return B;}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getOuterRect=function(D,A){try{var C={};if(D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==null){C.left=getObjSumLeft(D);C.top=getObjSumTop(D);}else{C.left=getObjSumLeftScrolled(D);C.top=getObjSumTopScrolled(D,A);}C.right=Math.max(C.left+getObjWidth(D),C.left+1);C.bottom=Math.max(C.top+getObjHeight(D),C.top+1);return C;}catch(B){microstrategy.errors.log(B);return null;}};function mstrSelectionsImpl(A){this.items={};this.parentBone=A;return this;}mstrObjectBrowserImplScript=true;mstrObjectBrowserImpl.prototype=new mstrEditorImpl();mstrObjectBrowserImpl.prototype.updateManager=microstrategy.updateManager;mstrObjectBrowserImpl.prototype.tree=null;mstrObjectBrowserImpl.prototype.selections=null;mstrObjectBrowserImpl.prototype.mask=null;mstrObjectBrowserImpl.prototype.dragSource=null;mstrObjectBrowserImpl.prototype.dndHelper=null;mstrObjectBrowserImpl.prototype.type=microstrategy.OBJTYPE_OBJBROWSER;mstrObjectBrowserImpl.prototype.isRWTab=false;mstrObjectBrowserImpl.prototype.onload=function(){try{this.dragSource=null;this.initEditor();this.initTree();if(typeof (mstrMaskImpl)!="undefined"){this.mask=new mstrMaskImpl();}this.maskFor=microstrategy.OBJTYPE_ANY;this.updateManager=microstrategy.updateManager;this.dndHelper=new mstrDNDHelperImpl(this);var B=microstrategy.findAncestorWithAtt(this.elem,"scriptClass","mstrAccordionTabManagerImpl");if(B){this.tabManager=microstrategy.findBone(B);}if(bIsIE4){this.elem.onselectstart=new Function("return microstrategy.bone('"+this.id+"').onselectstart();");}}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.onpostload=function(){try{if((microstrategy.IS_RELOAD||(bIsW3C&&!bIsIE4))&&!this.isRWTab){microstrategy.eventManager.ondialogresize();}}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.cancelContextMenu=function(C){try{if(!C){C=window.event;}var B=getEventTarget(C);if(B!=null){if((B.nodeName.toLowerCase()=="input"&&(B.getAttribute("type")=="text"||B.getAttribute("type")=="password"))||(B.nodeName.toLowerCase()=="textarea")){return true;}}if(this.selections!=null&&!this.selections.isSameType()){if(bIsIE4){C.cancelBubble=true;}return false;}return true;}catch(A){microstrategy.errors.log(A);return true;}};mstrObjectBrowserImpl.prototype.resize=function(){try{if(!this.elem){return ;}var C=250;var A=Math.max(getClientHeight()-getObjSumTop(this.elem)-getFooterHeight(),C);if(A!=parseInt(this.elem.style.height)){if(bIsIE7){A=A-SCROLLBAR_SIZE;}this.elem.style.height=A+"px";microstrategy.updateBrowserSetting("obH",getObjHeight(this.elem));}if(this.moveResizeHandles){this.moveResizeHandles();}if(this.resizeContents){this.resizeContents();}if(this.mask&&this.mask.onmaskedobjectresize){this.mask.onmaskedobjectresize();}}catch(B){microstrategy.errors.log(B);return false;}};mstrObjectBrowserImpl.prototype.onwinresize=function(){try{var B=function(){var C=microstrategy.bone(this.id);if(C&&C.resizeObjectBrowser){C.resizeObjectBrowser();}};window.setTimeout(B,0);}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.resizeObjectBrowser=function(){try{if((!(this.elem))||(!(this.elem.style))||!(isInDocument(this.elem))){return false;}this.resize();}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.hasMetrics=function(){try{}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.afterresize=function(){try{if(this.resizeContents){this.resizeContents();}microstrategy.updateBrowserSetting("obW",getObjWidth(this.elem));microstrategy.updateBrowserSetting("obH",getObjHeight(this.elem));}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.onnotifydrag=function(A,E,B){try{if((microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION)&&(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE)&&!this.isFeatureAvailable(microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS)){return ;}if(E!=this&&E.deleteItems){var C=false;if(microstrategy.EXECUTION_SCOPE!=microstrategy.RWD_EXECUTION){if(microstrategy.getViewerBone()){if(!microstrategy.getViewerBone().isFeatureAvailable(microstrategy.FEATURE_MODIFY_REPORT_LIST)){return ;}}C=this.isFeatureAvailable(microstrategy.FEATURE_WEB_PIVOT);}else{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.isFeatureAvailable(microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS)){C=true;}}if(C){this.mask.toggle(true,microstrategy.OBJTYPE_ANY);this.dragSource=E;}}}catch(D){microstrategy.errors.log(D);return false;}};mstrObjectBrowserImpl.prototype.ondrop=function(C,A){try{if(this.dragSource){this.dragSource.deleteItems(A.getItems());}}catch(B){microstrategy.errors.log(B);return false;}};mstrObjectBrowserImpl.prototype.onselectstart=function(C){try{if(!C){C=window.event;}var B=getEventTarget(C);if(B){if((B.nodeName.toLowerCase()=="input"&&(B.getAttribute("type")=="text"||B.getAttribute("type")=="password"))||(B.nodeName.toLowerCase()=="textarea")){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.onselectionchange=function(B){try{}catch(A){microstrategy.errors.log(A);}};mstrObjectBrowserImpl.prototype.ondocumentclick=function(B){try{if(this.selections&&this.selections.ondocumentclick){this.selections.ondocumentclick(B);}}catch(A){microstrategy.errors.log(A);}};mstrObjectBrowserImpl.prototype.close=function(){try{mstrEditorImpl.prototype.close.call(this);if(bIsW3C&&!bIsIE4&&!this.isRWTab){microstrategy.eventManager.ondialogresize();}}catch(A){microstrategy.errors.log(A);}};mstrObjectBrowserImpl.prototype.initTree=function(){try{var A=microstrategy.subObjectFind(this.elem,["DIV"],microstrategy.SUBOBJTYPE_TREE);if(A!=null){this.tree=new mstrTreeImpl(A.getAttribute("id"));this.tree.parentBone=this;this.tree.path="microstrategy.bone('"+this.id+"').tree";if(this.tree.onload){this.tree.onload();}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrObjectBrowserImpl.prototype.getAttributeForms=function(E){try{var A=[];var C=findTargetTag(E,"LI");var B=C.lastChild;if(B!=null&&B.tagName.toLowerCase()=="ul"){A=B.getElementsByTagName("span");}return A;}catch(D){microstrategy.errors.log(D);return false;}};mstrObjectBrowserImpl.prototype.getDNDHelperImage=function(C,A){try{return(C.id==this.id)?null:microstrategy.FOLDER_IMAGES+"XDelete.gif";}catch(B){microstrategy.errors.log(B);}return null;};function mstrObjectBrowserImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);delete this.inherits;return this;}mstrObjSelectionsImplScript=true;mstrObjSelectionsImpl.prototype=new mstrSelectionsImpl();mstrObjSelectionsImpl.prototype.updateManager=microstrategy.updateManager;mstrObjSelectionsImpl.prototype.selectedClass="selected";mstrObjSelectionsImpl.prototype.onmouseup=function(B){try{this.parentBone.dndHelper.onmouseup(this.path);}catch(A){microstrategy.errors.log(A);}};mstrObjSelectionsImpl.prototype.ondocumentclick=function(C){try{if(!this.isActive()){return ;}if(!C){C=window.event;}if(C.e){C=C.e;}var B=microstrategy.findAncestor(getEventTarget(C));if(B==null){this.clear();return ;}var D=B.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(D==microstrategy.OBJTYPE_CONTEXT_MENU||D==microstrategy.OBJTYPE_MESSAGE_BOX){return ;}if(this.needToClear(B)){this.clear();}}catch(A){microstrategy.errors.log(A);}};mstrObjSelectionsImpl.prototype.needToClear=function(B){var A=findTarget(B,microstrategy.HTMLATTR_SCRIPTCLASS);return(A==null||A.getAttribute("id")!=this.parentBone.id);};mstrObjSelectionsImpl.prototype.add=function(C,D){try{C=(C.tagName.toLowerCase()=="span"&&C.parentNode.tagName.toLowerCase()=="span"&&C.parentNode.className.indexOf("mstrIcon-lv")>-1)?C.parentNode.nextSibling:C;if(D){if(D.length==0){D.push(C);}else{D[0]=C;}}mstrSelectionsImpl.prototype.add.call(this,C);var A=C.className;C.className=(typeof (A)=="undefined")?this.selectedClass:this.selectedClass+" "+A;}catch(B){microstrategy.errors.log(B);}return false;};mstrObjSelectionsImpl.prototype.resetClassName=function(D){try{var C="";if(D){var A=D.className;if((A.length>0)&&(A.indexOf(this.selectedClass)==0)){C=A.substr(this.selectedClass.length);}else{C=A;}D.className=C;}}catch(B){microstrategy.errors.log(B);}return true;};mstrObjSelectionsImpl.prototype.remove=function(B){try{mstrSelectionsImpl.prototype.remove.call(this,B);this.resetClassName(B);}catch(A){microstrategy.errors.log(A);}return false;};mstrObjSelectionsImpl.prototype.clear=function(){try{for(var B in this.items){this.resetClassName(this.items[B]);}mstrSelectionsImpl.prototype.clear.call(this);}catch(A){microstrategy.errors.log(A);}return false;};mstrObjSelectionsImpl.prototype.getItems=function(){try{var A=mstrSelectionsImpl.prototype.getItems.call(this);if(A!=null&&A.length>0){if(A[0].getAttribute(microstrategy.HTMLATTR_ID)!=A[0].getAttribute(microstrategy.HTMLATTR_DSS_ID)){A.sort(function(D,C){return parseInt(D.getAttribute("id").substr(32))-parseInt(C.getAttribute("id").substr(32));});}}return A;}catch(B){microstrategy.errors.log(B);return null;}};function mstrObjSelectionsImpl(){this.inherits=mstrSelectionsImpl;this.inherits();delete this.inherits;return this;}mstrObjectExplorerImplScript=true;mstrObjectExplorerImpl.prototype=new mstrObjectBrowserImpl();mstrObjectExplorerImpl.prototype.contents=null;mstrObjectExplorerImpl.prototype.browseEventID=null;mstrObjectExplorerImpl.prototype.okEventID=null;mstrObjectExplorerImpl.prototype.changeFormatEventID=null;mstrObjectExplorerImpl.prototype.ancestorsID=null;mstrObjectExplorerImpl.prototype.ancestorsList=null;mstrObjectExplorerImpl.prototype.selectedObjectInputName=null;mstrObjectExplorerImpl.prototype.supportsMultiSelect=true;mstrObjectExplorerImpl.prototype.treeView=null;mstrObjectExplorerImpl.prototype.submitButton=null;mstrObjectExplorerImpl.prototype.okButton=null;mstrObjectExplorerImpl.prototype.onload=function(D){try{mstrObjectBrowserImpl.prototype.onload.call(this,D);this.selections=new mstrObjSelectionsImpl();this.selections.parentBone=this;if(this.ancestorsID){this.ancestorsList=microstrategy.findChildWithAtt(this.elem,"select","name",this.ancestorsID);if(this.ancestorsList){this.ancestorsList.onchange=new Function("e","return microstrategy.bone('"+this.id+"').openAncestor(e);");}}this.initTreeView();this.displayPickerDiv=microstrategy.findChildWithAtt(this.elem,"div","id","displayFormatPicker");if(this.displayPickerDiv){for(var A=0;A<this.displayPickerDiv.childNodes.length;A++){var C=this.displayPickerDiv.childNodes[A];C.onmousedown=new Function("e","return microstrategy.bone('"+this.id+"').changeFormat(e);");}}this.contents=microstrategy.subObjectFind(this.elem,"div",microstrategy.SUBOBJTYPE_FILE_LIST);if(this.contents){this.contents.onmousedown=new Function("e","return microstrategy.bone('"+this.id+"').onmousedown(e);");}this.submitButton=microstrategy.findChildWithAtt(this.elem,"input","type","submit");if(this.submitButton){this.submitButton.onclick=new Function("e","return microstrategy.bone('"+this.id+"').onsubmit(e);");}this.okButton=microstrategy.findChildWithAtt(this.elem,"input","id","ok");}catch(B){microstrategy.errors.log(B);return false;}};mstrObjectExplorerImpl.prototype.resize=function(){return true;};mstrObjectExplorerImpl.prototype.initTreeView=function(){try{var B=microstrategy.subObjectFind(this.elem,["DIV"],microstrategy.SUBOBJTYPE_TREE_VIEW);if(B!=null){this.treeView=new mstrTreeViewImpl(B.getAttribute("id"));this.treeView.parentBone=this;this.treeView.path="microstrategy.bone('"+this.id+"').treeView";B.onclick=new Function("e","microstrategy.bone('"+this.id+"').onClickTree(); return false;");if(this.treeView.onload){this.treeView.onload();}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectExplorerImpl.prototype.onClickTree=function(C){try{this.treeView.onClickTree();if(this.treeView.currentlySelectedNode){var B=this.treeView.currentlySelectedNode;if(B.tagName.toLowerCase()=="li"){if(this.selections){if(this.selections.isSelected(B)){}else{if(!this.supportsMultiSelect){this.selections.clear();}var D=[B];this.selections.add(B,D);if(D[0].getAttribute("did")){this.addSelectedObject(D[0].getAttribute("did"));}}}}else{if(this.selections){this.selections.clear();}}}}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectExplorerImpl.prototype.onmousedown=function(C){try{if(!C){C=window.event;}if(this.currentPicker){this.closePicker(C);}var B=getEventTarget(C);B=this.getObjSpan(B);if(B){if(B.tagName.toLowerCase()=="span"){if(this.selections){if(this.selections.isSelected(B)){if(C.ctrlKey){this.selections.remove(B);}}else{if(!this.supportsMultiSelect||!C.ctrlKey){this.selections.clear();}var D=[B];this.selections.add(B,D);if(D[0].getAttribute("oid")){this.addSelectedObject(D[0].getAttribute("oid"));}}}}else{if(this.selections){this.selections.clear();}}}if(bIsIE9){return C.target.tagName.toLowerCase()=="a"?false:true;}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectExplorerImpl.prototype.getObjSpan=function(D){var A=D.parentNode;if(A){A=findTarget(A,microstrategy.HTMLATTR_DSSTYPE);}if(A){var C=A.getAttribute(microstrategy.HTMLATTR_DSSTYPE);switch(C){case microstrategy.DSSTYPE_RPT_DEFINITION:case microstrategy.DSSTYPE_DOC_DEFINITION:case microstrategy.DSSTYPE_CONSOLIDATION_ELEMENT:case"18":return microstrategy.findChildWithAtt(A,"span",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_FIRST_CLASS_OBJECT);break;case microstrategy.DSSTYPE_FILTER:return microstrategy.findChildWithAtt(A,"span",microstrategy.HTMLATTR_OBJTYPE,"fi");break;case microstrategy.DSSTYPE_PROMPT:return microstrategy.findChildWithAtt(A,"span",microstrategy.HTMLATTR_OBJTYPE,"pr");break;case microstrategy.DSSTYPE_FOLDER:var B=A.getElementsByTagName("a");if(B.length>0){return B[0];}break;default:return D;}}else{return D;}};mstrObjectExplorerImpl.prototype.addSelectedObject=function(B){var A=document.getElementById(this.selectedObjectInputName);if(!A){A=this.createInput(this.selectedObjectInputName,"");}if(A){if(this.supportsMultiSelect&&A.value.length>0){A.value=A.value+","+B;}else{A.value=B;}}if(this.submitButton){this.submitButton.disabled=false;this.submitButton.className=this.submitButton.className.replace("mstrButtonDisabled","");}};mstrObjectExplorerImpl.prototype.openAncestor=function(A){submitForm(findTargetTag(this.createInput(this.browseEventID,"true"),"form"));};mstrObjectExplorerImpl.prototype.createInput=function(A,D){var C=this.ancestorsList.parentNode;var B=document.createElement("input");B.setAttribute("id",A);B.setAttribute("name",A);B.setAttribute("value",D);B.setAttribute("type","hidden");C.appendChild(B);return B;};function findTargetTag(B,A){while(B.parentNode){if(B.nodeName.toLowerCase()==A.toLowerCase()){return B;}B=B.parentNode;}return null;}function mstrObjectExplorerImpl(A){this.inherits=mstrObjectBrowserImpl;this.inherits(A);delete this.inherits;return this;}mstrObjectExplorerImpl.prototype.togglePicker=function(A,D,B){if(typeof (this.dialogDiv)=="undefined"){this.dialogDiv=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,"dialog");}try{if(B&&(!B.disabled)){dropDown.togglePicker(A,D,B,this);}}catch(C){microstrategy.errors.log(C);}return false;};mstrObjectExplorerImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectExplorerImpl.prototype.ondocumentclick=function(B){try{if(this.selections&&this.selections.ondocumentclick){this.selections.ondocumentclick(B);}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);}};mstrObjectExplorerImpl.prototype.changeFormat=function(C){if(!C){C=window.event;}var B=getEventTarget(C);var A=new Array();A.push(this.updateManager.createActionObject(this.elem,mstrUpdateManager.CHANGE_DISPLAY_FORMAT,this.beanPath,["98006"],[B.getAttribute("name")]));this.updateManager.add(A);this.updateManager.flushAndSubmitChanges();};mstrObjectExplorerImpl.prototype.onreload=function(){try{mstrBoneImpl.prototype.onreload.call(this);if(this.treeView&&this.treeView.onreload){this.treeView.onreload();}}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectExplorerImpl.prototype.disableOkButton=function(A){if(this.okButton){this.okButton.disabled=true;this.okButton.className="mstrButtonDisabled";}};mstrObjectExplorerImpl.prototype.enableOkButton=function(A){if(this.okButton){this.okButton.disabled=false;this.okButton.className="mstrButton";}};mstrXDAObjectExplorerImplScript=true;mstrXDAObjectExplorerImpl.prototype=new mstrObjectExplorerImpl();mstrXDAObjectExplorerImpl.prototype.browseAncestor=function(A){try{var B=A.options[A.selectedIndex].value.split("|");var D=findTargetTag(A,"form");createHiddenInput(D,"evt",this.browseEventID);createHiddenInput(D,"src",this.beanPath);createHiddenInput(D,this.browseEventID,"1");this.updateUnitId(D,B[0]);createHiddenInput(D,this.level,B[1]);submitForm(D);}catch(C){microstrategy.errors.log(C);return false;}};mstrXDAObjectExplorerImpl.prototype.addSelectedObject=function(C){try{var D=C.getAttribute("oid");var B=findTargetTag(C,"form");this.updateUnitId(B,D);this.enableOkButton();}catch(A){microstrategy.errors.log(A);return false;}};mstrXDAObjectExplorerImpl.prototype.updateUnitId=function(A,B){updateDynamicInput(A,this.unitId,B);if(this.filterObjType){this.filterObjID=B;}};mstrXDAObjectExplorerImpl.prototype.enableOkButton=function(){var A=document.getElementById(this.okEventID);if(!A){A=microstrategy.findChildWithAtt(this.elem,"INPUT","ID","ok");}if(A){A.disabled=false;A.className="mstrButton";}};mstrXDAObjectExplorerImpl.prototype.onwinresize=function(){try{return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrXDAObjectExplorerImpl.prototype.onmousedown=function(C){try{if(!C){C=window.event;}var B=getEventTarget(C);if(B){if(B.tagName.toLowerCase()=="span"){if(!this.filterObjType||this.filterObjType&&(B.getAttribute("oty")==this.filterObjType)){if(this.selections){if(this.selections.isSelected(B)){if(C.ctrlKey){this.selections.remove(B);}}else{if(!this.supportsMultiSelect||!C.ctrlKey){this.selections.clear();}this.selections.add(B);this.addSelectedObject(B);}}}}else{if(this.selections){this.selections.clear();}}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrXDAObjectExplorerImpl.prototype.submitFilteredRHS=function(){if(this.filterObjType){var B=new Array();var A=microstrategy.updateManager;B.push(A.createActionObject(this,mstrUpdateManager.ADD_UNIT_TO_RHS,this.expBeanPath,["1001","1002",],[this.filterObjID,this.filterObjType]));if(this.toggleEM){B.push(A.createActionObject(this,mstrUpdateManager.TOGGLE_QUAL_EXPR_MODE,this.expBeanPath,[],[]));}if(this.beanName){B.push(A.createActionObject(null,mstrUpdateManager.SHOW_BEAN,this.beanPath,["5017","5018"],[false,this.beanName]));}A.add(B);A.flushAndSubmitChanges();}};function mstrXDAObjectExplorerImpl(A){this.inherits=mstrObjectExplorerImpl;this.inherits(A);delete this.inherits;return this;}mstrSerializer.prototype=new Object;mstrSerializer.prototype.buffer="";mstrSerializer.prototype.needDelim=false;mstrSerializer.CH_ESCAPE="*";mstrSerializer.CH_DELIM=".";mstrSerializer.CH_BRA="-";mstrSerializer.CH_KET="_";mstrSerializer.CH_LESS="<";mstrSerializer.STR_NULL="*0";mstrSerializer.prototype.getState=function(){try{return this.buffer;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addStr=function(B){try{if(this.needDelim){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(B);this.needDelim=true;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addInt=function(B){try{this.addStr(B+"");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addBoolean=function(B){try{this.addStr(B?"1":"0");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addValues=function(A){try{this.buffer+=mstrSerializer.CH_BRA;for(var B=0;B<A.length;B++){if(B>0){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(A[B]);}this.buffer+=mstrSerializer.CH_KET;this.needDelim=false;}catch(C){microstrategy.errors.log(C);return false;}};mstrSerializer.prototype.appendValue=function(C){try{var A=new RegExp("[\\"+mstrSerializer.CH_ESCAPE+"\\"+mstrSerializer.CH_BRA+"\\"+mstrSerializer.CH_KET+"\\"+mstrSerializer.CH_DELIM+"\\"+mstrSerializer.CH_LESS+"]","g");var D=mstrSerializer.CH_ESCAPE+"$&";C=String(C).replace(A,D);this.buffer+=C;}catch(B){microstrategy.errors.log(B);return false;}};function mstrSerializer(){return this;}mstrUpdateManager.prototype=new Object;mstrUpdateManager.prototype.id="bonesUpdateManager";mstrUpdateManager.prototype.observer=null;mstrUpdateManager.prototype.actions={};mstrUpdateManager.prototype.redoActions=[];mstrUpdateManager.prototype.undoActions=[];mstrUpdateManager.prototype.staticActions=[];mstrUpdateManager.prototype.useIframe=false;mstrUpdateManager.prototype.newWindow=false;mstrUpdateManager.prototype.newWindowName="_blank";mstrUpdateManager.prototype.extraURL="";mstrUpdateManager.prototype.iframeTarget="frameManager";mstrUpdateManager.prototype.formAction="";mstrUpdateManager.prototype.OPTIMIZE_EVENTS=true;mstrUpdateManager.prototype.ADD_EVENT_IDS=null;mstrUpdateManager.prototype.optActions=[];mstrUpdateManager.prototype.lastPosArray=[];mstrUpdateManager.prototype.copyActions={};mstrUpdateManager.prototype.cachedActionCollection=null;mstrUpdateManager.prototype.queueActions=false;mstrUpdateManager.prototype.forceSubmitAfterQueue=false;mstrUpdateManager.prototype.ctlCurElementsPosition=null;mstrUpdateManager.prototype.currentPanelPosition=null;mstrUpdateManager.prototype.hiddenInputs=null;mstrUpdateManager.prototype.submittedForm=null;mstrUpdateManager.prototype.submittedXhr=false;mstrUpdateManager.prototype.newActions=false;mstrUpdateManager.prototype.sTimeOutID=null;mstrUpdateManager.prototype.callback=null;mstrUpdateManager.UNIT_SEPARATOR=",";mstrUpdateManager.ITEM_SEPARATOR=";";mstrUpdateManager.UPDATE_LATER="0";mstrUpdateManager.UPDATE_NOW="1";mstrUpdateManager.STATIC_ACTION=-1;mstrUpdateManager.ARG_KEY_SEPARATOR="_";mstrUpdateManager.addEvent=function(A){if(!mstrUpdateManager.actions){mstrUpdateManager.actions={};}for(var B in A){var C=A[B].i;mstrUpdateManager[B]=C;mstrUpdateManager.actions[C]={eventID:C,paramName:A[B].n,paramID:A[B].p};}mstrUpdateManager.newActions=true;};mstrUpdateManager.prototype.addSingleAction=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection.push(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getUseIFrame=function(){try{return this.useIframe;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setUseIFrame=function(B){try{this.useIframe=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getNewWindowSetting=function(){try{return this.newWindow;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setNewWindowSetting=function(B){try{this.newWindow=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.addActionCollection=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection=this.cachedActionCollection.concat(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.hasCachedActions=function(){try{return(this.cachedActionCollection&&this.cachedActionCollection.length>0);}catch(A){microstrategy.errors.log(A);}return false;};mstrUpdateManager.prototype.addCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.add(this.cachedActionCollection,false);this.cachedActionCollection=null;if(this.forceSubmitAfterQueue){this.flushAndSubmitChanges();}}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.killCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.cachedActionCollection=null;}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.add=function(C,A){try{if(this.queueActions){if(C.length){this.addActionCollection(C);}else{this.addSingleAction(C);}}else{if(A){this.staticActions.push(C);this.redoActions.unshift(mstrUpdateManager.STATIC_ACTION);this.newActions=true;}else{this.clearRedoActions();this.undoActions.push(C);this.newActions=true;}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","add",C);if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.addURL=function(A){try{if(A){if(this.extraURL.length>0){this.extraURL+="&"+A;}else{this.extraURL=A;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.replaceURL=function(A,D){try{if(this.extraURL.length>0){if(this.extraURL.indexOf(A)>-1){var E=this.extraURL.substring(0,this.extraURL.indexOf(A)-2);var C=this.extraURL.indexOf("&",this.extraURL.indexOf(A));if(E==null||E.length==0){E="";}else{E+="&";}if(C>this.extraURL.indexOf(A)){this.extraURL=E+this.extraURL.substring(C+1,this.extraURL.length)+"&"+A+"="+D;}else{this.extraURL=A+"="+D;}}else{this.extraURL+="&"+A+"="+D;}}else{this.extraURL=A+"="+D;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.processUndoRedo=function(C,D){try{while(C.length>0){var B=C.pop();D.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;}}}catch(A){microstrategy.errors.log(A);}return null;};mstrUpdateManager.prototype.broadcastUpdate=function(){try{while(source.length>0){var B=source.pop();target.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;break;}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.undo=function(C){try{var D=false;C=C||1;for(var A=0;A<C;A++){var F=this.processUndoRedo(this.undoActions,this.redoActions);if(F){for(var B=0;B<F.length;B++){microstrategy.eventManager.notifyOrphanBones("onundo",new mstrUndoObj(F[B]));}D=true;}}if(D){microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","undo");}if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.redo=function(){try{var C=this.processUndoRedo(this.redoActions,this.undoActions);if(C){for(var A=0;A<C.length;A++){microstrategy.eventManager.notifyOrphanBones("onredo",new mstrRedoObj(C[A]));}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","redo");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.getPendingEventsForTask=function(A){var E;var J;var B=0;var N=[];var D=A.split(".");var C=D[D.length-1];var F=this.optActions;this.optActions=[];if(this.OPTIMIZE_EVENTS){for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;this.createOptimizedArray(H);G.splice(M,1);M=M-1;}}}for(var I=0;I<this.optActions.length;I++){if(this.optActions[I].id!=null){N.push(this.createEventForAction(this.optActions[I]));}}this.postOptimizationCleanup();}else{for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;N.push(this.createEventForAction(H));G.splice(M,1);M=M-1;}}}}this.optActions=F;if(N.length>0){var L=new mstrSerializer();L.addValues(N);return L.getState();}else{return"";}};mstrUpdateManager.prototype.flushChanges=function(I){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){addURLAsHiddenInputsToForm(I,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){this.createOptimizedArray(D[H]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){J.push(this.createEventForAction(D[H]));}}}var G=new mstrSerializer();G.addValues(J);if(I.getAttribute("hasUpdateChanges")=="true"){updateDynamicInput(I,mstrUpdateManager.multipleEventArgName,G.getState());}else{this.submittedForm=I;this.hiddenInputs=[];this.createHiddenInput(I,mstrUpdateManager.multipleEventArgName,G.getState());this.createHiddenInput(I,"evt",mstrUpdateManager.multipleEventID);this.createHiddenInput(I,"src",mstrUpdateManager.multipleEventSrc);this.createHiddenInput(I,mstrUpdateManager.multipleEventID,"1");I.setAttribute("hasUpdateChanges","true");}if(this.newWindow){I.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.flushChangesAsParams=function(G){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){UpdateHelper.addURLToParams(G,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){this.createOptimizedArray(D[I]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){J.push(this.createEventForAction(D[I]));}}}var H=new mstrSerializer();H.addValues(J);if(G.hasUpdateChanges=="true"){G[mstrUpdateManager.multipleEventArgName]=H.getState();}else{this.submittedXhr=true;UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventArgName,H.getState());UpdateHelper.addAdditionalParam(G,"evt",mstrUpdateManager.multipleEventID);UpdateHelper.addAdditionalParam(G,"src",mstrUpdateManager.multipleEventSrc);UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventID,"1");G.hasUpdateChanges=="true";}if(this.newWindow){G.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.createHiddenInput=function(D,B,C){var A=createHiddenInput(D,B,C);this.hiddenInputs.push(A);};mstrUpdateManager.prototype.postOptimizationCleanup=function(A){if(this.fullScreenModePosition){delete this.fullScreenModePosition;}if(this.lTbarBrowserSettingPosition){delete this.lTbarBrowserSettingPosition;}if(this.ctlCurElementsPosition){delete this.ctlCurElementsPosition;}if(this.currentPanelPosition){delete this.currentPanelPosition;}if(this.widgetPropEdits){delete this.widgetPropEdits;}this.optActions=[];this.lastPosArray=[];};mstrUpdateManager.prototype.createEventForAction=function(G){try{var A=mstrUpdateManager.actions[G.id];var E=new mstrSerializer();E.addStr(A.eventID);E.addStr(G.beanPath+"."+A.eventID);var D="";for(var C=0;C<G.newArgs.length;C++){actionID=G.argID[C];for(var B=0;B<A.paramID.length;B++){if(A.paramID[B]==actionID){if(false){D+="<arg name='"+A.paramName[B]+"' v='"+G.newArgs[C]+"' />";}if(G.argKey==null){E.addStr(A.paramName[B]);}else{E.addStr(A.paramName[B]+mstrUpdateManager.ARG_KEY_SEPARATOR+G.argKey);}E.addStr(G.newArgs[C]);break;}}}if(false){alert(D);}return E.getState();}catch(F){microstrategy.errors.log(F);return false;}};mstrUpdateManager.prototype.flushAndSubmitChanges=function(C,H){this.callback=H||{};var B=this,G=this.callback.success,F=this.callback.noRefresh;this.callback.success=function(I){if(G){G(I);}if(!F&&I&&I.status=="6"){B.refreshPage();}};try{if(useXHR&&!C){mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var A=UpdateHelper.createParamsFromURL(this.getFormAction(),this.useIframe&&!this.newWindow);this.flushing=true;UpdateHelper.submitRequest(A);}else{mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var D=createDynamicForm(this.getFormAction());if(this.useIframe&&!this.newWindow){addURLAsHiddenInputsToForm(D,"iframe=true");D.target=this.iframeTarget;}this.flushing=true;submitForm(D,C);}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.acknowledgeRequest=function(){try{this.undoActions=[];this.redoActions=[];this.staticActions=[];this.optActions=[];this.lastPosArray=[];this.copyActions={};this.newWindow=false;microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}var B;if(this.submittedForm!=null){for(var A=0;A<this.hiddenInputs.length;A++){B=this.hiddenInputs[A];try{this.submittedForm.removeChild(B);}catch(C){if((C&&C.code!=8)&&(C.number&&C.number!=-2147024809)){throw (C);}}}this.submittedForm.setAttribute("hasUpdateChanges","false");this.submittedForm=null;this.hiddenInputs=null;this.flushing=false;}if(this.submittedXhr){this.submittedXhr=false;this.flushing=false;}}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.isFlushing=function(){return !!this.flushing;};mstrUpdateManager.prototype.acknowledgeReloadEnd=function(){if(this.observer){this.observer.notifyAll("acknowledgeReloadEnd");}};mstrUpdateManager.prototype.getFixStateActions=function(){try{var E=[];for(var B=0;B<this.staticActions.length;B++){var D=this.staticActions[B];for(var A=0;A<D.length;A++){E.push(D[A]);}}return E;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.hasChangesToSubmit=function(){try{return(this.undoActions.length>0||this.isRedoStatic()||(this.extraURL!=null&&this.extraURL.length>0));}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.hasNewChanges=function(){try{var A=this.newActions;this.newActions=false;return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.clearRedoActions=function(){try{while(this.redoActions.length>0){var B=this.redoActions.pop();if(B==mstrUpdateManager.STATIC_ACTION){this.undoActions.push(B);}}}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.getLastAction=function(){try{return this.undoActions.pop();}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.isRedoStatic=function(){try{var C=false;for(var A=0;A<this.redoActions.length;A++){if(this.redoActions[A]==mstrUpdateManager.STATIC_ACTION){C=true;break;}}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.anyNonStatic=function(B){try{var A=(B)?this.redoActions:this.undoActions;var E=false;for(var C=0;C<A.length;C++){if(A[C]!=mstrUpdateManager.STATIC_ACTION){E=true;break;}}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createActionObject=function(C,A,G,H,B,F,J,I){try{var E={};E.elem=C;E.id=A;E.beanPath=G;E.argID=H;E.newArgs=B;E.oldArgs=F;E.cachedArray=J;E.argKey=I;if(A==mstrUpdateManager.EDIT_PROPS){E.formatType=microstrategy.formatType;E.argID.push("2048131");E.newArgs.push(microstrategy.formatType);E.oldArgs.push(microstrategy.formatType);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createOptimizedArray=function(G){try{var I=G.id;if(!this.ADD_EVENT_IDS){this.ADD_EVENT_IDS=mstrUpdateManager.ADD_TEXT+"|"+mstrUpdateManager.ADD_LINE+"|"+mstrUpdateManager.ADD_SHAPE+"|"+mstrUpdateManager.ADD_TEMPLATE+"|"+mstrUpdateManager.ADD_DATASET_TEMPLATE+"|"+mstrUpdateManager.ADD_IMAGE+"|"+mstrUpdateManager.ADD_HTML_CONTAINER+"|"+mstrUpdateManager.ADD_PANEL_STACK+"|"+mstrUpdateManager.CTRL_ADD+"|";}var N=(G.elem)?G.elem.id:null;var B=N;if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="4146"){B=N+G.newArgs[K].split("!")[0]+G.newArgs[K].split("!")[1]+G.newArgs[K].split("!")[2];break;}}}var P;if(I==mstrUpdateManager.EDIT_PROPS){for(var K=0,D=G.argID.length;K<D;K++){if(G.argID[K]=="2048035"){var J=G.newArgs[K].split(mstrUpdateManager.UNIT_SEPARATOR);if(J[1]=="FormattingWidget"&&J[2]=="WidgetProps"){var C=this.widgetPropEdits||{};if(J[0] in C){this.optActions[C[J[0]]].id=null;}C[J[0]]=this.optActions.length;this.widgetPropEdits=C;}break;}}this.optActions.push(G);}else{if(I==mstrUpdateManager.COPY_TO_CLIPBOARD||I==mstrUpdateManager.CUT_TO_CLIPBOARD){P=G.newArgs[0].split(CLIPBOARD_ITEM_SEPARATOR);for(var K=0;K<P.length;K++){this.copyActions[P[K]]={};this.copyActions[P[K]].position=this.optActions.length;this.copyActions[P[K]].applied=false;}this.optActions.push(G);}else{if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES||I==mstrUpdateManager.EDIT_TEXT||I==mstrUpdateManager.SET_TOPLEFT_POSITION||I==mstrUpdateManager.CHANGE_BONE_PROPERTY){if(!this.lastPosArray[I]){this.lastPosArray[I]={};}if(this.copyActions[N]&&this.copyActions[N].applied==false){this.copyActions[N].applied=true;for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}else{if(this.lastPosArray[I][B]){var L=this.lastPosArray[I][B].position;var F=this.optActions[L];var H=mstr.$A.find(F.argID,"2048007");if(H==-1){H=null;}var M=mstr.$A.find(F.argID,"2048007");if(M==-1){H=null;}if(M==H){F.newArgs=G.newArgs;}else{this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}else{this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}}else{if(I==mstrUpdateManager.REMOVE_OBJECT){if(this.copyActions[N]){for(var K=this.copyActions[N].position;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N){this.optActions[K].id=null;}}delete this.copyActions[N];for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}}else{for(var K=0;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N&&!this.ADD_EVENT_IDS.contains(this.optActions[K].id,"|")){this.optActions[K].id=null;}}}this.optActions.push(G);}else{if(I==mstrUpdateManager.SWITCH_FULL_SCREEN_MODE){if(typeof (this.fullScreenModePosition)!="undefined"&&this.optActions[this.fullScreenModePosition]&&this.optActions[this.fullScreenModePosition].newArgs&&this.optActions[this.fullScreenModePosition].id==I){this.optActions[this.fullScreenModePosition].newArgs=G.newArgs;}else{this.fullScreenModePosition=this.optActions.length;this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING){if(G.argID[0]=="5005"&&G.newArgs[0]=="lTbar"){if(typeof (this.lTbarBrowserSettingPosition)!="undefined"&&this.optActions[this.lTbarBrowserSettingPosition]&&this.optActions[this.lTbarBrowserSettingPosition].newArgs){this.optActions[this.lTbarBrowserSettingPosition].newArgs=G.newArgs;}else{this.lTbarBrowserSettingPosition=this.optActions.length;this.optActions.push(G);}}else{this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_CUR_CTL_ELEMENTS){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="2048130"){this.ctlCurElementsPosition=this.ctlCurElementsPosition||{};var A=G.newArgs[K];if(A in this.ctlCurElementsPosition){this.optActions[this.ctlCurElementsPosition[A]].id=null;}this.ctlCurElementsPosition[A]=this.optActions.length;this.optActions.push(G);break;}}}else{if(I==mstrUpdateManager.SET_CURRENT_PANEL){var O=G.newArgs[0];if(!this.currentPanelPosition){this.currentPanelPosition={};}if(typeof (this.currentPanelPosition[O])!="undefined"){this.optActions.splice(this.currentPanelPosition[O],1);}this.currentPanelPosition[O]=this.optActions.length;this.optActions.push(G);}else{this.optActions.push(G);}}}}}}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.getFormAction=function(){if(!this.formAction){this.formAction=microstrategy.servletName;}return this.formAction;};mstrUpdateManager.prototype.setFormAction=function(A){this.formAction=A;};mstrUpdateManager.createPropertyEditString=function(C,B,G,A,H){try{var F=mstrFormatObject;if(!F){return"";}if(!A){G=F.encodeValue(B,G);}var D=C||"";if(D){D+=mstrUpdateManager.UNIT_SEPARATOR;}return D+(H||F.getPropertySetName(B))+mstrUpdateManager.UNIT_SEPARATOR+F.getPropertyName(B)+mstrUpdateManager.UNIT_SEPARATOR+G+mstrUpdateManager.ITEM_SEPARATOR;}catch(E){microstrategy.errors.log(E);return"";}};mstrUpdateManager.prototype.createEditPropsAction=function(F,J,S,I,Q,D,A,L,K,R){try{var E=(A)?mstrUpdateManager.UPDATE_NOW:mstrUpdateManager.UPDATE_LATER;var M=mstrUpdateManager.createPropertyEditString;var O=K?"1":"0";var H="",C="";for(var N=0;N<I.length;N++){H+=M(J,I[N],Q[N],R);if(D&&(N in D)){C+=M(J,I[N],D[N]);}}var B=K?["2048018","2048035","2048241"]:["2048018","2048035"],G=K?[E,H,O]:[E,H];return this.createActionObject(F,mstrUpdateManager.EDIT_PROPS,S,B,G,(C&&[E,C])||[],L);}catch(P){microstrategy.errors.log(err);return null;}};mstrUpdateManager.prototype.findRwbInputOnPageStateForm=function(){var C=getObj("pageStateForm");var B=C.getElementsByTagName("INPUT");for(i=0,cnt=B.length;i<cnt;i++){var A=B[i];if(A.name==="rwb"){return A;}}return null;};mstrUpdateManager.prototype.getRWBState=function(A){if(A){var B=this.findRwbInputOnPageStateForm();if(B){return B.value;}}else{if(pageState){var C=(pageState+"&").match(/rwb=(.*?)\&/);if(C!=-1){return C[1];}}}return"";};mstrUpdateManager.prototype.setRWStateInForm=function(A){var B=this.findRwbInputOnPageStateForm();if(B){B.value=A;}};mstrUpdateManager.prototype.refreshPage=function(){try{this.useIframe=false;var B=this.createActionObject(null,mstrUpdateManager.PAGE_REFRESH,microstrategy.servletName+"."+microstrategy.pageName,[],[],[],null);this.add([B],true);this.flushAndSubmitChanges();}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.submitPartialUpdate=function(C){try{microstrategy.puStatus=0;iframe.notifyParent(true);if(!this.partialUpdateModel){this.partialUpdateModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.partialUpdateModel);var A=this.partialUpdateModel&&this.partialUpdateModel&&this.partialUpdateModel.init();if(!("id" in this)||!mstr.$obj(this.id)){mstr.controllers.Factory.add(this);}this.partialUpdateModel.attachEventListener(this,"set_readyState","handleStateChange");}C.processorClass=mstr.http.PUProcessor;this.partialUpdateModel.execSubmit({params:C,callback:this.callback});}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.handleStateChange=function(evt){try{switch(evt.memo.value){case mstr.Enum.Widget.READYSTATE.TIMEOUT:case mstr.Enum.Widget.READYSTATE.ERROR:break;case mstr.Enum.Widget.READYSTATE.SUCCESS:var updateResult=evt.src.get("requestContext").response.data;if(updateResult){if(updateResult.status=="2"){iframe.showWaitPage();}else{iframe.hideWaitPage();}UpdateHelper.replaceComponents(updateResult.components);document.title=updateResult.title;if(updateResult.status=="2"){this.doRedirect(updateResult.redirectURL,updateResult.waitSeconds);}microstrategy.eventManager.executeFunction("microstrategy.eventManager.onreload()");if(updateResult.script){eval(updateResult.script);}microstrategy.puStatus=1;}else{if(window.document.readyState=="complete"){var sMarkup=evt.src.get("requestContext").response.text;if(bIsIE6&&!bIsIE7){document.write(sMarkup);}else{var oNewDoc=window.document.open("text/html");if(sMarkup.indexOf("<!DOCTYPE")==-1){oNewDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd " >');}oNewDoc.write(sMarkup);oNewDoc.close();}}}delete this.callback;break;}}catch(err){microstrategy.errors.log(err);}};mstrUpdateManager.prototype.doRedirect=function(C,A){try{this.sTimeOutID=window.setTimeout('microstrategy.updateManager.timedRedirect("'+C+'")',A*1000);}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.timedRedirect=function(C){try{window.clearTimeout(this.sTimeOutID);var A=UpdateHelper.createParamsFromURL(C);UpdateHelper.submitRequest(A);}catch(B){microstrategy.errors.log(B);}};function mstrUpdateManager(){this.commands=new UpdateManagerCommands(this);if(typeof (mstrObserverImpl)!="undefined"){this.observer=new mstrObserverImpl();}return this;}if(typeof (microstrategy)!="undefined"){microstrategy.updateManager=new mstrUpdateManager();}mstrUndoObj.prototype={};function mstrUndoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.oldArgs;this.cachedArray=A.cachedArray;return this;}mstrRedoObj.prototype={};function mstrRedoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.newArgs;this.cachedArray=A.cachedArray;return this;}function UpdateManagerCommands(A){this.queryVisible=function(B){return true;};this.queryEnabled=function(B){switch(B){case"redo":return A.anyNonStatic(true);case"undo":return A.anyNonStatic(false);case"apply":return A.hasChangesToSubmit();default:return false;}};this.queryState=function(B){return false;};this.exec=function(B,C){switch(B){case"redo":return A.redo();case"undo":return A.undo();case"apply":A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return A.flushAndSubmitChanges();default:return false;}};return this;}var UpdateHelper=new function(){};UpdateHelper.prototype=new Object();UpdateHelper.createParamsFromURL=function(B,G){var C={method:"post"};var H=B.indexOf("?")>0;var F=B.indexOf("#")>0;var E=(B.indexOf("iframe=true")>0||G);var D=((H)?B.substring(0,B.indexOf("?")):B);if(F){var A="";B=moveAnchor(B);A=B.substring(B.indexOf("#"));D=D.replace(A,"")+A;B=B.substring(0,B.indexOf("#"));}D=microstrategy.addJSessionID(D);if(H){UpdateHelper.addURLToParams(C,B);}C.iframe=(E)?"true":"false";C.action=D;return C;};UpdateHelper.createParamsFromForm=function(I,J,F,H){var G=getObj(I);var C=microstrategy.findChildrenWithAtt(G,["INPUT","SELECT","TEXTAREA"],"name");var B={action:G.action,method:G.method};if(typeof G.target!=undefined){B.target=G.target;}for(var D=0;D<C.length;D++){var A=C[D];if(H===true&&A.ps===true){continue;}if(A.type=="select-multiple"&&A.options&&A.options.length>0&&A.disabled!=true){for(var E=0;E<A.options.length;E++){if(UpdateHelper.shouldSubmit(A.options[E])){UpdateHelper.addAdditionalParam(B,A.name,A.options[E].value);}}}else{if(UpdateHelper.shouldSubmit(A)){UpdateHelper.addAdditionalParam(B,A.name,A.value);}}}if(J){B[J]=F;}return B;};UpdateHelper.shouldSubmit=function(A){if(A.disabled==true){return false;}if(A.type=="submit"||A.type=="button"||A.type=="image"||A.value=="undefined"){return false;}if(A.type=="radio"||A.type=="checkbox"){if(!A.getAttribute("agg")){return A.checked;}else{A.value=A.checked?"true":"false";return true;}}if(A.tagName.toLowerCase()=="option"){return A.selected;}return true;};UpdateHelper.addURLToParams=function(D,F,C){F=F.substring(F.indexOf("?")+1,F.length);var G=F.split("&");var I="";var E="";var A="";var H=/\+/g;for(var B=0;B<G.length;B++){I=G[B].split("=");E=I[0];A=I[1];if(A){A=decodeURIComponent(A.replace(H," "));}if(C){D[E]=A;}else{UpdateHelper.addAdditionalParam(D,E,A);}}return false;};UpdateHelper.addAdditionalParam=function(A,B,C){if(A[B]&&typeof A[B]!="object"){A[B]=[A[B],C];}else{if(A[B]&&A[B].push){A[B].push(C);}else{A[B]=C;}}};UpdateHelper.submitRequest=function(H){var N=getObj("pageStateForm");var E=null;var I=null;var G;var F;var C;var O;UpdateHelper.appendPageStateToParams(H);if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){var L=microstrategy.bones.rwb_viewer;H.docSelections=L.commands.queryState("selectionsKey");L.adjustScrollValues();H.viewerScroll=L.dScrollTop+","+L.dScrollLeft;H.isLocked=(L.insertionControlLocked)?1:0;var M=L.doc.currentControlSubtype?"|"+L.doc.currentControlSubtype:"";H.currentControl=L.doc.currentControl+M;}if(typeof (microstrategy)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){for(var A in microstrategy.bones){if(microstrategy.bones[A]!=null&&microstrategy.bones[A].type==microstrategy.OBJTYPE_GRID){var B=microstrategy.bones[A];if(B&&B.gridStructureInfo&&!B.gridStructureInfo.emptyCase&&!B.gridStructureInfo.isEmptyTemplate){if(B.isGrid){var K=B.commands.queryState("selections");if(K){H[B.id]=K;}}if(B.isGraph&&A.indexOf("_graph")==-1){H[B.id+"_gs"]=B.commands.queryState("graphSelections");}}}}}if(H.iframe=="true"){microstrategy.updateManager.submitPartialUpdate(H);}else{var J=UpdateHelper.createFormFromParams(H);UpdateHelper.appendPageSizeToParams(J);if(mstr.utils.ISSAFARI&&J.target=="_blank"){J.action+=(J.action.indexOf("?")==-1?"?":"&");J.action+="t="+new Date().getTime();}try{microstrategy.submitForm(J);}catch(D){if(J.target!=""&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){showMessage({contents:microstrategy.descriptors.getDescriptor("5877"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.errors.log(D);}}}return false;};UpdateHelper.createFormFromParams=function(A){var C=document.createElement("FORM");C.name="dynamic_form";C.method=A.method;delete A.method;C.action=A.action;delete A.action;if(typeof A.target!="undefined"){C.target=A.target;delete A.target;}C.setAttribute("hasUpdateChanges",A.hasUpdateChanges=="true");for(var D in A){if(A[D]){if(typeof A[D]=="object"){for(var B=0;B<A[D].length;B++){if(A[D][B]){createHiddenInput(C,D,A[D][B]);}}}else{createHiddenInput(C,D,A[D]);}}}document.body.insertAdjacentElement("beforeEnd",C);return C;};UpdateHelper.submitFormThroughXHR=function(B,D){if(D){if(!B){B=window.event;}var B=getEventTarget(B);if(!B){return false;}}var F=microstrategy.findAncestorWithTag(B,"FORM");var C=B.name;var A=B.value;if(typeof F=="undefined"||typeof C=="undefined"||typeof A=="undefined"){return false;}var E=UpdateHelper.createParamsFromForm(F,C,A,true);UpdateHelper.appendPageStateToParams(E);microstrategy.updateManager.submitPartialUpdate(E);return false;};UpdateHelper.appendPageStateToParams=function(A){var E=getObj("pageStateForm");var D=null;var B=(typeof (microstrategy)!="undefined")?microstrategy.updateManager:null;var C;if(B&&B.hasChangesToSubmit()){B.flushChangesAsParams(A);UpdateHelper.addEvtOrderToParams(A,mstrUpdateManager.multipleEventID);}if(E){if(A.method=="get"||A.method=="GET"){UpdateHelper.addURLToParams(A,pageState,true);}else{D=E.getElementsByTagName("INPUT");for(C=0;C<D.length;C++){A[D[C].name]=D[C].value;}}}};UpdateHelper.appendPageSizeToParams=function(A){createHiddenInput(A,"innerWidth",getClientWidth());createHiddenInput(A,"innerHeight",getClientHeight());};UpdateHelper.submitLink=function(F){var H;H=F.href;var C;C=F.target;var G=document.getElementById("cssAnalyzerToolbar");var A=(getCookie(ENABLE)=="true")&&(G!=null);if(A){return false;}window.mstrSubmitLink=true;if(C=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){var B=UpdateHelper.createParamsFromURL(H);if(C){B.target=C;}UpdateHelper.submitRequest(B);return false;}if(typeof (pageState)!="undefined"){var D=updateLink(H);D=moveAnchor(D);var E=null;if(bIsIE6&&F.childNodes&&(F.childNodes.length==1)&&F.childNodes[0].nodeType==3){E=F.innerHTML;}F.href=D;if(bIsIE6&&E!=null){F.innerHTML=E;}return true;}else{return true;}};UpdateHelper.addEvtOrderToParams=function(A,B,C){if(A.evtorder){if(A.evtorder.indexOf(B)<0){if(C){A.evtorder=A.evtorder+","+B;}else{A.evtorder=B+","+A.evtorder;}A[B]="1";}}else{A.evtorder=B;if(A.evt&&A.evt.length<3){for(j=0;j<A.evt.length;j++){A[A.evt[j]]="1";}}}};UpdateHelper.replaceComponents=function(A,G){try{if(!G){iframe.consolidatedStyles={};iframe.isProcessing=true;if(!bIsW3C){iframe.togglePulldownChildren(document.body,false);}}var C;for(C=0;C<A.length;C++){var F=A[C];if(F&&F.ISEMPTY!="true"){if(F.errBox!="true"||currentModalEditor.length==0){UpdateHelper.updateComponent(F,G);}else{var E=F.content;if(E.length>0){showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}}}}if(!G){for(var B in iframe.consolidatedStyles){updateStyleContainer(iframe.consolidatedStyles[B],B);}if(!bIsW3C){iframe.togglePulldownChildren(document.body,true);}iframe.targets=null;microstrategy.loadDynamicJS();microstrategy.registerNewBones();}}catch(D){microstrategy.errors.log(D);}};UpdateHelper.updateComponent=function(cB,parentId){try{var sReplaceHTML;var aScripts=null;var j;var oParentDiv;if(!cB.id){return ;}if(cB.components&&cB.components.length>1){UpdateHelper.replaceComponents(cB.components,cB.id);return ;}else{if(cB.components&&cB.components.length==1){return ;}}if(cB.slid){var slices=document.getElementsByName(cB.id);if(slices&&slices.length>0){for(var i=0,len=slices.length;i<len;i++){if(slices[i].getAttribute("slid")==cB.slid){oParentDiv=slices[i];break;}}}}if(!oParentDiv){var oParentDivs=document.getElementById(cB.id);if(!oParentDivs&&(cB.dialog||cB.css=="1")){iframe.createPlaceHolder(cB.id);oParentDivs=document.getElementById(cB.id);}if(oParentDivs){if(oParentDivs.length>1){for(var i=0;i<oParentDivs.length;i++){if(oParentDivs[i].tagName=="DIV"){oParentDiv=oParentDivs[i];break;}}}else{oParentDiv=oParentDivs;}}}if(oParentDiv){var sReplaceHTML=cB.content.replace(/'/g,"'");if(cB.message=="true"){showMessage({contents:sReplaceHTML,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}var scriptArray=[],chartArray=[];var oDivNode=iframe.createElementFromHTML(sReplaceHTML);if(!oDivNode){return ;}iframe.extractScript(oDivNode,scriptArray);iframe.extractImage(oDivNode,chartArray);if(cB.errorInfo){var errorHolder=document.getElementById("errorInfo");if(errorHolder){errorHolder.innerHTML+=cB.errorInfo;}}if(cB.css=="1"){var styleId=oDivNode.getAttribute("styleid");if(!iframe.consolidatedStyles[styleId]){iframe.consolidatedStyles[styleId]=[];}iframe.consolidatedStyles[styleId]=consolidateStyleSheets(oDivNode,iframe.consolidatedStyles[styleId],styleId);}else{if(oParentDiv.getAttribute(mstrHTMLAttributes.ATTR_MODAL)=="true"||(oParentDiv.popupMask)){togglePulldowns(oParentDiv,true);}if(cB.partialUpdate=="true"&&oParentDiv.childNodes.length>1){oParentDiv.innerHTML=oDivNode.innerHTML;}else{if(bIsW3C&&!bIsIE8&&!bIsIE9&&!bIsIE10&&!bIsSafari){iframe.setOuterHTML(oParentDiv,oDivNode);}else{if(oParentDiv&&oDivNode){if(cB.isFlashVis&&bIsIE8){var o=oParentDiv.getElementsByTagName("object");if(o&&o.length>0){for(var i=0;i<o.length;i++){o[i].parentNode.removeChild(o[i]);}}}oParentDiv.parentNode.replaceChild(oDivNode,oParentDiv);}if(chartArray.length>0){for(var j=0,cnt=chartArray.length;j<cnt;j++){chartArray[j].src=chartArray[j].getAttribute("dsrc");}}}}for(var i=0,len=scriptArray.length;i<len;i++){eval(scriptArray[i].toString());}}}}catch(err){microstrategy.errors.log(err);}};
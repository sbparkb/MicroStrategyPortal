mstrSerializer.prototype=new Object;mstrSerializer.prototype.buffer="";mstrSerializer.prototype.needDelim=false;mstrSerializer.CH_ESCAPE="*";mstrSerializer.CH_DELIM=".";mstrSerializer.CH_BRA="-";mstrSerializer.CH_KET="_";mstrSerializer.CH_LESS="<";mstrSerializer.STR_NULL="*0";mstrSerializer.prototype.getState=function(){try{return this.buffer;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addStr=function(B){try{if(this.needDelim){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(B);this.needDelim=true;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addInt=function(B){try{this.addStr(B+"");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addBoolean=function(B){try{this.addStr(B?"1":"0");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addValues=function(A){try{this.buffer+=mstrSerializer.CH_BRA;for(var B=0;B<A.length;B++){if(B>0){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(A[B]);}this.buffer+=mstrSerializer.CH_KET;this.needDelim=false;}catch(C){microstrategy.errors.log(C);return false;}};mstrSerializer.prototype.appendValue=function(C){try{var A=new RegExp("[\\"+mstrSerializer.CH_ESCAPE+"\\"+mstrSerializer.CH_BRA+"\\"+mstrSerializer.CH_KET+"\\"+mstrSerializer.CH_DELIM+"\\"+mstrSerializer.CH_LESS+"]","g");var D=mstrSerializer.CH_ESCAPE+"$&";C=String(C).replace(A,D);this.buffer+=C;}catch(B){microstrategy.errors.log(B);return false;}};function mstrSerializer(){return this;}mstrViewerCommandsImpl.prototype=new Object();mstrViewerCommandsImpl.prototype.itemSep="~";mstrViewerCommandsImpl.prototype.unitSep="\u001F";mstrViewerCommandsImpl.prototype.clipboardItemSep="\u001E";mstrViewerCommandsImpl.prototype.valueField="dssid";mstrViewerCommandsImpl.prototype.nameField="n";mstrViewerCommandsImpl.prototype.typeField="t";mstrViewerCommandsImpl.prototype.exec=function(K,H,k){try{var d=microstrategy.updateManager;switch(K){case"ping":return this.execPingServer();case"undo":return d.undo();case"redo":return d.redo();case"doFlush":d.add([d.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return d.flushAndSubmitChanges();case"IVEMode":if(microstrategy.pageScreenMode!=microstrategy.PAGE_FULL_SCREEN_MODE){toggleScreenMode();}case"interactiveViewMode":case"editableMode":case"flashViewMode":var e={interactiveViewMode:microstrategy.RW_VIEW_MODE_INTERACTIVE,editableMode:microstrategy.RW_VIEW_MODE_EDITABLE,flashViewMode:microstrategy.RW_VIEW_MODE_FLASH,IVEMode:microstrategy.RW_VIEW_MODE_VIEWANALYSIS};H=e[K];case"rwCurrentViewMode":d.add([d.createActionObject(null,mstrUpdateManager.SET_CURRENT_VIEW_MODE,this.parentBone.beanPath,["55004"],[H],[])],true);d.useIframe=false;d.flushAndSubmitChanges();return true;case"staticViewMode":case"publishViewMode":var I=this.parentBone.visualizationMode;var Q=this.parentBone.currentRWViewMode;if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){var Y=microstrategy.RW_VIEW_MODE_STATIC|microstrategy.RW_VIEW_MODE_INTERACTIVE|microstrategy.RW_VIEW_MODE_FLASH;if(Q&Y){I="0";}}if(this.parentBone.isLayoutLevelVis){I="0";}d.add([d.createActionObject(null,mstrUpdateManager.RUN_RW_DOCUMENT,microstrategy.servletName,["2048174","2048002","2048109"],["1",this.parentBone.messageID,I],[])],true);if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){Q=0;}d.replaceURL("prevViewMedia",Q);d.useIframe=false;d.flushAndSubmitChanges();return true;case"designViewMode":case"convertToDoc":H=1;if(K=="convertToDoc"){this.showMessageForIVE("rwChangeDesignMode",H,k);return true;}case"rwChangeDesignMode":d.add([d.createActionObject(null,mstrUpdateManager.CHANGE_DESIGN_MODE,this.parentBone.beanPath,["3017"],[H],[])],true);d.useIframe=false;d.flushAndSubmitChanges();return true;case"docVisualizationModeAJAX":return this.exec("docVisualizationMode",51);case"docVisualizationModeFlash":return this.exec("docVisualizationMode",50);case"docVisualizationMode":d.useIframe=false;microstrategy.adjustSelectedVisualization(this.parentBone,H);var Q=(this.parentBone.visualizationMode==H)?"0":H;d.add([d.createActionObject(this.elem,mstrUpdateManager.SET_VISUALIZATION_MODE,this.parentBone.beanPath,["2048109","2048212"],[Q,this.parentBone.isLayoutLevelVis?"-1":""],[],[])]);d.add([d.createActionObject(this.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[])]);d.flushAndSubmitChanges();this.parentBone.isVisualization=(Q>=microstrategy.FIRST_VISUALIZATION_VIEW_MODE);this.parentBone.visualizationMode=Q;return true;case"ZoomType":var X=mstrFormatObject;var u=X.getPropertySetName(K)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(K)+mstrUpdateManager.UNIT_SEPARATOR+H+mstrUpdateManager.ITEM_SEPARATOR;d.add([d.createActionObject(null,mstrUpdateManager.SET_DOCUMENT_ZOOM,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,u],[])]);return true;case"zoom":var J=H,O,m=this.queryState("rwCurrentViewMode"),V=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&(m==microstrategy.RW_VIEW_MODE_FLASH||m==microstrategy.RW_VIEW_MODE_VIEWANALYSIS)),Q=this.parentBone.isVisualization;if(J=="Width"){if(!V||Q){J=this.queryState("widthZoomFactor");}O=microstrategy.ZOOM_FIT_WIDTH;}else{if(J=="Page"){if(!V||Q){J=Math.min(this.queryState("heightZoomFactor"),this.queryState("widthZoomFactor"));}O=microstrategy.ZOOM_FIT_PAGE;}else{O=microstrategy.ZOOM_STATIC;}}if(J!=microstrategy.ZOOM_FACTOR||O!=microstrategy.zoomType){microstrategy.ZOOM_FACTOR=J;microstrategy.zoomType=O;this.exec("ZoomType",O);var a=false;if(V&&!Q){microstrategy.getViewerBone().callFlashPlayerFn("changeZoomType",[J,O]);if(O==microstrategy.ZOOM_STATIC){a=true;}}else{a=true;}if(a){J=J/100;var X=mstrFormatObject;var u=X.getPropertySetName(K)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(K)+mstrUpdateManager.UNIT_SEPARATOR+X.encodeValue(K,J)+mstrUpdateManager.ITEM_SEPARATOR;if(!V||Q){d.add([d.createActionObject(null,mstrUpdateManager.RW_GRAPH_DZ_SET_ZOOMFACTOR,this.parentBone.gdzBeanPath,["121002"],[microstrategy.ZOOM_FACTOR],[])]);}d.add([d.createActionObject(null,mstrUpdateManager.SET_DOCUMENT_ZOOM,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,u],[])]);if(Q){d.useIframe=false;}if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.queryState("rwCurrentViewMode")!=microstrategy.RW_VIEW_MODE_FLASH||Q){d.flushAndSubmitChanges();}}}if(!V){this.parentBone.onselectionchange();}return true;case"showBean":this.showBean(d,H);return true;case"sendNow":this.exec("showBean","ncSendNow",k);return true;case"scheduleHL":this.exec("showBean","subs",k);return true;case"mobileSubs":case"ncSubs":case"ncFileSubs":case"ncFtpSubs":case"ncPrintSubs":case"ncCacheSubs":this.exec("showBean",K,k);return true;case"save":var y=document.getElementById("askBeforeSaveCheckbox");if(y&&y.checked&&this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES)){this.exec("forceSaveAs");}var L=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"true":"false";var C=(this.parentBone.saveFolderId)?this.parentBone.saveFolderId:this.parentBone.parentFolderID;var l=["3013","3014","3017"];var z=["false",C,L];if(H&&H.origin){l.push("3031");z.push(H.origin);}var D=d.createActionObject(null,mstrUpdateManager.RW_SAVE_AS,microstrategy.servletName,l,z,[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"dSave":var r=this.parentBone.saveFolderId,U=this.parentBone.parentFolderID;if(r||this.isNew(U)||this.parentBone.isRWReadonly){return this.exec("save",K,k);}else{if(this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES)){this.askBeforeSaveOverwrite();}else{this.submitSave();}return true;}case"dontAskAgain":var F=0;this.parentBone.setFeature("ask-before-save-changes",0);var D=d.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.beanPath,["5003","5004"],["askBeforeSaveChanges",F],[],null);d.add([D],true);d.flushAndSubmitChanges();return true;case"forceSaveAs":var F=2;this.parentBone.setFeature(microstrategy.FEATURE_FORCE_SAVE_AS,0);var D=d.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.beanPath,["5003","5004"],["askBeforeSaveChanges",F],[],null);d.add([D],true);d.flushAndSubmitChanges();return true;case"reprompt":this.refreshViewer(d,true,false,false);return true;case"refresh":this.refreshViewer(d,false,false,false);return true;case"rerun":this.refreshViewer(d,false,true,false);return true;case"regenerate":this.refreshViewer(d,false,false,true);return true;case"browseParent":var T=this.parentBone,n=["1001"],l=[T.parentFolderID];if(T.goBackOverride){this.exec("openPage","-1");return true;}else{if(!T.parentFolderID||T.isParentFolderHidden){return this.exec("openHome");}}if(T.sysFolderId){n.push("2023");l.push(T.sysFolderId);}var D=d.createActionObject(null,mstrUpdateManager.BROWSE_FOLDER,microstrategy.servletName,n,l,[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"openDefaultHome":case"openHome":var h={openHome:mstrUpdateManager.OPEN_DESKTOP,openDefaultHome:mstrUpdateManager.OPEN_DEFAULT_DESKTOP}[K];var D=d.createActionObject(null,h,microstrategy.servletName,[],[],[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"restoreScreenMode":var D=d.createActionObject(null,mstrUpdateManager.SWITCH_FULL_SCREEN_MODE,this.parentBone.beanPath,["5028"],[H],[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"saveToInbox":this.parentBone.sentToInbox=true;var D=d.createActionObject(null,mstrUpdateManager.RW_SAVE_TO_INBOX,this.parentBone.beanPath,[],[],[],null);d.add([D],true);d.flushAndSubmitChanges();return true;case"docDetails":d.add([d.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);var D=d.createActionObject(null,mstrUpdateManager.RW_DOC_DETAILS,microstrategy.servletName,["3010","3016"],[this.parentBone.messageID,"0"],[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"setPreference":var D=d.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.beanPath,["5003","5004"],[H.prefName,H.prefValue],[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"toggleConditionalFormatting":var D=d.createActionObject(this.elem,mstrUpdateManager.TOGGLE_DOC_THRESHOLDS,this.parentBone.beanPath,[],[],[],[]);d.add([D],true);d.flushAndSubmitChanges();return true;case"datasetObjPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_DATASET_PANEL);return true;case"relatedReportsPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_RELATED_RP_PANEL);return true;case"notesPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_NOTES_PANEL);return true;case"outlinePanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_OUTLINE_PANEL);return true;case"newRW":var D=d.createActionObject(this.elem,mstrUpdateManager.CREATE_NEW_DOCUMENT,microstrategy.servletName,[],[],[],[]);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"browseParent":case"openHome":return true;case"toggleScreenMode":toggleScreenMode();return true;case"exportExcel":return this.exec("export",4);case"exportHtml":return this.exec("export",-1);case"exportFlash":return this.exec("export",7);case"printPDF":return this.exec("export",3);case"export":if(H==7&&this.parentBone.hasUCSelectors){showMessage({contents:microstrategy.descriptors.getDescriptor("7482"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"mstr.$obj('"+this.parentBone.id+"').commands.exec('trueExport',"+H+");",type:mstrMsgBoxImpl.MSG_WARNING});}else{return this.exec("trueExport",H);}return true;case"trueExport":var A=this.parentBone.isFeatureAvailable("export-new-window")?"_blank":"mstrExportWindow";exportRW(H,A);case"proxyForGridObservers":if(this.parentBone.observer){this.parentBone.observer.notifyAll(H);}return true;case"toggleFlashGrouping":this.parentBone.toggleGrouping();return true;case"IVEHelp":window.open(this.parentBone.helpPath+"#about_interactive_visual_data_exploration.htm","_blank");return true;case"close":if(mstrApp.pathInfo.nb[1].href==="#"||mstrApp.isHomePage){return this.exec(mstrApp.preferences.startPage=="3187"?"openDefaultHome":"openHome");}H="-1";case"openPage":d.useIframe=false;var o=new Array();o.push(d.createActionObject(this.elem,mstrUpdateManager.OPEN_HISTORY_PAGE,microstrategy.servletName+"."+microstrategy.pageName,["3140"],[H]));d.add(o,true);d.flushAndSubmitChanges();return true;case"setUnsetFalse":H;var x=this.parentBone.formattingAttributes[H];if(x){x.isUs=false;}return true;case"createPersonalView":this.exec("showBean","pvsubs",k);return true;case"ShowSharingEditor":var T=this.parentBone,Z=microstrategy.getViewerBone().isDocBlank||microstrategy.getViewerBone().isBlankAnalysis,g={success:function(){var AB=T.stateID,AC="sharingEditor",c=window.mstrmojo&&mstrmojo.all[AC];microstrategy.showSharingEditor(null,{lastState:AB},true);},failure:function(){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){}},R=microstrategy.updateManager;if(Z){showMessage({contents:microstrategy.descriptors.getDescriptor("14121"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"mstr.$obj('"+this.parentBone.id+"').commands.exec('save', {origin:"+microstrategy.SAVE_AS_SHARE_EDITOR+"});",buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("118")},type:mstrMsgBoxImpl.MSG_WARNING});}else{if(R.newActions){R.add([R.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[],null)]);R.flushAndSubmitChanges(false,g);}else{g.success();}}return true;}if(!this.parentBone.doc){return ;}switch(K){case"rulers":return this.parentBone.toggleRuler();break;case"grid":return this.parentBone.toggleGrid();break;case"divider":return this.parentBone.toggleDivider();break;case"unloadDocViewer":if(this.parentBone.doc.selections){this.parentBone.doc.selections.clear();}microstrategy.unregisterGridBones();window.setTimeout("microstrategy.unRegisterBone('"+this.parentBone.id+"')",0);break;case"activeTab":if(H!=this.parentBone.currentLayout){var d=this.parentBone.updateManager;d.add([d.createActionObject(null,mstrUpdateManager.SET_CURRENT_LAYOUT,this.parentBone.beanPath,["2048007"],[H],[])]);this.exec("unloadDocViewer");d.flushAndSubmitChanges();}break;case"moveTab":var d=this.parentBone.updateManager;var AA=["2048007"];var z=[H[0]];if(H[1]){AA.push("2048036");z.push(H[1]);}d.add([d.createActionObject(null,mstrUpdateManager.MOVE_LAYOUT,this.parentBone.beanPath,AA,z,[])],true);break;case"addTab":case"addNewLayout":case"addExistingLayout":var B={};if(K=="addNewLayout"||K=="addTab"){B["tabList/selectedIndicesList"]=0;}else{if(K=="addExistingLayout"){B["tabList/selectedIndicesList"]=2;}}microstrategy.openFolderBasedBlockEditor("insertLayoutEditor","InsertLayoutEditorBlockLoader",{folderID:"FCA4BAFE4AF0D00088028989D7497A4F",typeRestriction:"14081"},B);break;case"removeTab":showMessage({contents:microstrategy.descriptors.getDescriptor("4360"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.parentBone.id+"').commands.exec('confirmRemoveTab', "+((H)?"'"+H+"'":"null")+");",type:mstrMsgBoxImpl.MSG_WARNING,title:microstrategy.descriptors.getDescriptor("5678")+": "+this.parentBone.currentLayoutName});break;case"confirmRemoveTab":var d=this.parentBone.updateManager;var N=(H)?H:this.parentBone.currentLayout;var E=this.parentBone.BeforeLayoutItems;var q=this.parentBone.BeforeLayout;for(var s=0;s<E.length;s++){var W=E[s];if(W.key==N){if(W.dssid==q&&E[s+1]){this.parentBone.BeforeLayout=E[s+1]["dssid"];}E.splice(s,1);break;}}var G=N==this.parentBone.currentLayout;d.add([d.createActionObject(null,mstrUpdateManager.REMOVE_LAYOUT,this.parentBone.beanPath,["2048007","2048176"],[N,G],[])],true);if(G){d.flushAndSubmitChanges();}else{this.parentBone.observer.notifyAll("onDeleteLayoutTab");}break;case"TabName":var X=mstrFormatObject;var S="name";var d=this.parentBone.updateManager;var u=this.parentBone.currentLayout+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertySetName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.encodeValue(S,H.value)+mstrUpdateManager.ITEM_SEPARATOR;d.add(d.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,u],[]));break;case"tabMPHF":var X=mstrFormatObject;var S="TabMPHF";var d=this.parentBone.updateManager;d.add(d.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,this.parentBone.currentLayout+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertySetName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.encodeValue(S,H.value)+mstrUpdateManager.ITEM_SEPARATOR],[]));break;case"VisibleSections":var X=mstrFormatObject;var S="visibility";var d=this.parentBone.updateManager;var u=H.obj.id+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertySetName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(S)+mstrUpdateManager.UNIT_SEPARATOR+H.value+mstrUpdateManager.ITEM_SEPARATOR;d.add(d.createActionObject(H.obj,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,u],[]));break;case"formatMultiLevelBulk":for(var s=H.length-1;s>=0;s--){var P=H[s].split("|");if(P[0]==microstrategy.FORMAT_LEVEL_FLAG_VIEWER){var w=H.splice(s,1)[0];this.exec(P[1],P[2]);}}if(H.length>0){this.parentBone.doc.commands.exec(K,H);}break;case"MultiLevelPropertyChanges":for(var s=H.length-1;s>=0;s--){if(H[s].level==microstrategy.FORMAT_LEVEL_FLAG_VIEWER){var M=H.splice(s,1)[0];this.exec(M.cmdId,M);}}if(H.length>0){this.parentBone.doc.commands.exec(K,H);}break;default:return this.parentBone.doc.commands.exec(K,H,k);break;}return true;}catch(t){microstrategy.errors.log(t);return false;}};mstrViewerCommandsImpl.prototype.askBeforeSaveOverwrite=function(){try{var C=microstrategy.descriptors.getDescriptor("11165").replace(/##/,"<b>"+encode(this.parentBone.objectName)+"</b>");var A="<label for='askBeforeSaveCheckbox' id='glabel'> "+microstrategy.descriptors.getDescriptor("211")+" </label>";var D="<input name='askBeforeSave' id='askBeforeSaveCheckbox' type='checkbox'/> ";showMessage({contents:"<div style='overflow:auto'>"+C+"</div><br/><br/><div style='overflow:auto' text-align:center>"+D+A+"</div>",elements:microstrategy.OK_BUTTON+microstrategy.APPLY_BUTTON+microstrategy.CANCEL_BUTTON,applyEval:"microstrategy.bones['"+this.parentBone.id+"'].commands.submitSave()",okEval:"microstrategy.bones['"+this.parentBone.id+"'].commands.exec('save')",buttonLabels:{Apply:microstrategy.descriptors.getDescriptor("219"),Ok:microstrategy.descriptors.getDescriptor("218")},title:microstrategy.descriptors.getDescriptor("5728"),type:mstrMsgBoxImpl.MSG_TEXT_ONLY});}catch(B){microstrategy.errors.log(B);}};mstrViewerCommandsImpl.prototype.submitSave=function(){try{var C=document.getElementById("askBeforeSaveCheckbox");if(C&&C.checked&&this.parentBone.isFeatureAvailable("ask-before-save-changes")){this.exec("dontAskAgain");}var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[],null)]);A.add([A.createActionObject(null,mstrUpdateManager.SAVE_OBJECT,this.parentBone.beanPath,["89001"],["0"],[],null)]);A.flushAndSubmitChanges();}catch(B){microstrategy.errors.log(B);}};mstrViewerCommandsImpl.prototype.isNew=function(A){return(A=="6C87013036D94E65B9FD227CF919327E"||A=="FCA4BAFE4AF0D00088028989D7497A4F"||A=="C1EDA6CB4A7933A0C0B3AF92EEBBFC2E");};mstrViewerCommandsImpl.prototype.showMessageForIVE=function(A,F,B){var E=typeof (A)=="string"?"'"+A+"'":A,D=typeof (F)=="string"?"'"+F+"'":F,C=typeof (B)=="string"?"'"+B+"'":B;showMessage({contents:microstrategy.descriptors.getDescriptor("8127"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bones['"+this.parentBone.id+"'].commands.askedForIVE = true; microstrategy.bones['"+this.parentBone.id+"'].commands.exec("+E+","+D+","+C+");",type:mstrMsgBoxImpl.MSG_WARNING});if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}};mstrViewerCommandsImpl.prototype.refreshViewer=function(B,A,D,C){var E=B.createActionObject(null,mstrUpdateManager.RW_REFRESH,this.parentBone.beanPath,["2048059","2048060","2048143"],[A,D,C],[],null);B.useIframe=false;B.add([E],true);B.flushAndSubmitChanges();};mstrViewerCommandsImpl.prototype.showBean=function(A,C){var B=A.createActionObject(null,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],[true,C],[],null);A.add([B],true);A.flushAndSubmitChanges();return true;};mstrViewerCommandsImpl.prototype.queryEnabled=function(P,J){try{var K=microstrategy.updateManager;switch(P){case"redoq":return K.anyNonStatic(true);break;case"undoq":return K.anyNonStatic(false);break;case"doFlush":return K.hasChangesToSubmit();break;case"IVEMode":case"designViewMode":case"convertToDoc":case"staticViewMode":case"publishViewMode":case"interactiveViewMode":case"editableMode":case"flashViewMode":case"export":case"printPDF":case"exportExcel":case"exportHtml":case"exportFlash":case"exportPDF":case"save":case"dSave":case"newRW":case"datasetObjPanel":case"relatedReportsPanel":case"outlinePanel":case"notesPanel":case"groupBy":case"zoom":case"grid":case"rwCurrentViewMode":case"rwChangeDesignMode":case"activeTab":case"moveTab":case"addTab":case"TabName":case"tabMPHF":case"addNewLayout":case"addExistingLayout":case"toggleScreenMode":case"openHome":case"sendNow":case"scheduleHL":case"mobileSubs":case"ncSubs":case"ncFileSubs":case"ncCacheSubs":case"ncFtpSubs":case"ncPrintSubs":case"createPersonalView":case"ShowSharingEditor":case"docVisualizationModeFlash":case"docVisualizationModeAJAX":case"toggleFlashGrouping":case"docDetails":case"hasMultipleLayouts":case"close":case"IVEHelp":case"canBeScheduled":case"canBeSubscribed":case"selectedUsers":case"userSubscribeRights":return true;break;case"browseParent":return !this.parentBone.isBlankAnalysis;case"removeTab":return this.queryState("hasMultipleLayouts");break;case"docVisualizationMode":return this.parentBone.visualizationsEnabled;case"refresh":return true;case"reprompt":return this.parentBone.isFeatureAvailable("enable-reprompt");case"rerun":case"regenerate":return this.parentBone.isFeatureAvailable("enable-reexecute");case"toggleConditionalFormatting":return this.parentBone.isFeatureAvailable("rw-document-has-thresholds");case"saveToInbox":var L=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE||!this.parentBone.sentToInbox;return mstr.behaviors.featureResolver.featAvailable("enable-add-history-list")&&L;case"createCalculationCM":case"customGroupCM":var A=this.parentBone.doc.selections.getSelectedGrid();var I=microstrategy.findBone(A);if(!(I&&I.selections&&I.selections.singleAttributeElementsAreSelected()&&I.selections.getSelectedGridTarget)){return false;}var G="";var C="";var N=null;var H="";var E="";var D=I.selections.getSelectedGridTarget();if(D&&D.length>0){var O=D.split(",");if(O!=null&&O.length>=2){E=O[0];G=O[1];C=O[2];N=I.gridStructureInfo.getUnit(E,G,C);if(N!=null){if(N.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){N=I.gridStructureInfo.findUnit(N.parentDssId);}H=N.dssId;}}}if(!H){return false;}var Q=(I&&I.commands)?I.commands.queryState("getControlGroupByList"):false;if(Q){all:for(var B in Q){if(Q[B].dfm!="1"){continue;}var M=Q[B].oid;if(H==M){return false;}}}return true;default:return(this.parentBone&&this.parentBone.doc&&this.parentBone.doc.commands)?this.parentBone.doc.commands.queryEnabled(P,J):false;break;}}catch(F){microstrategy.errors.log(F);return false;}};mstrViewerCommandsImpl.prototype.queryState=function(F,c){try{var K=this;var P=this.parentBone;var h=function(AA){var z=[];if(mstr.utils.String.trim(AA).length>0){var t=AA.split(K.clipboardItemSep);for(var u=0,g=t.length;u<g;u++){var w=t[u],y=w.split(K.itemSep);var x={};x[K.valueField]=w;x[K.typeField]=y[1];x[K.nameField]=y[2];z.push(x);}}return z;};var m=function(){try{if(!!P.asLoaded){return ;}iframe.showWaitPage();var t=function(w){var z="";for(var x=0,u=w.length;x<u;x++){var y=w[x];z+=y[K.valueField];if(x<u-1){z+=K.clipboardItemSep;}}return z;};mstr.$XHR.request(mstrApp.taskURL||mstrConfig.taskURL,{taskId:"getSubscriptionAssociatedInformation",objectID:P.objectID,objectType:P.objectType,msgID:P.messageID},{success:function(u){P.asLoaded=true;P.canBeScheduled=!u.o.nc;P.scheduleType=u.o.st;P.selectedSchedules=t(u.o.items);P.availableSchedules=u.p.items;P.canBeSubscribed=!u.user.nc;P.userType=u.user.ut;P.selectedUsers=u.user.items||[];P.userSubscribeRights=u.user.rgts;}},false);iframe.hideWaitPage();}catch(g){microstrategy.errors.log(g);}};switch(F){case"canBeScheduled":m();return P[F];case"scheduleType":P[F+"Was"]=P[F];return P[F];case"availableSchedules":return P[F];case"selectedSchedules":P[F+"Was"]=P[F];return h(P[F]||"");case"canBeSubscribed":m();return P[F];case"userType":P[F+"Was"]=P[F];return P[F];case"selectedUsers":return P[F];case"userSubscribeRights":return P[F];case"rwCurrentViewMode":return P.currentRWViewMode;case"rulers":return P.rulerOn;case"grid":return P.gridOn;case"divider":return P.dividerOn;case"groupByDssIds":return(typeof (P.groupByDssIds!="undefined"))?P.groupByDssIds:null;case"TabName":return P.currentLayoutName;case"tabMPHF":return P.currentLayoutMPHF;case"zoom":var D=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_FLASH);return mstr.controllers.ZoomFactors.getZoomFactors(microstrategy.zoomType,microstrategy.ZOOM_FACTOR,D);case"docVisualizationModeFlash":return P.visualizationMode==50;case"docVisualizationModeAJAX":return P.visualizationMode==51;case"docVisualizationMode":return P.visualizationMode;case"documentDataSets":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAvailableDatasets());case"datasetObjPanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_DATASET_PANEL);case"relatedReportsPanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_RELATED_RP_PANEL);case"notesPanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_NOTES_PANEL);case"outlinePanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_OUTLINE_PANEL);case"documentAttributes":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAvailableAttributes());case"documentPureAttributes":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getPureAttributes());case"documentAttributesWithDateForm":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAttributesWithDateForms());case"documentMetrics":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAvailableMetrics());case"documentAttributesType":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAttributesType());case"widthZoomFactor":var q=document.getElementById("page");var U=document.getElementById("rwb_viewer");if(q&&U){var A=0;var W=0;if(q.style.borderLeftWidth&&(q.style.borderLeftWidth.indexOf("pt")>-1)){A+=parseInt(microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,parseInt(q.style.borderLeftWidth)));}if(q.style.borderRightWidth&&(q.style.borderRightWidth.indexOf("pt")>-1)){A+=parseInt(microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,parseInt(q.style.borderRightWidth)));}A+=getObjWidth(document.getElementById("docRszHandler"));if(document.getElementById("vRulerCol")){W=getObjWidth(document.getElementById("vRulerCol"));}var V=mstr.utils.BoxModel.hasScrollbar(U,"y")?SCROLLBAR_SIZE:0;var H=mstr.utils.BoxModel.hasScrollbar(document.documentElement,"y")?SCROLLBAR_SIZE:0;var r=((getObjWidth(U)-A-V-H)/(getObjWidth(q)+W-A)*microstrategy.ZOOM_FACTOR-0.5).toFixed(0);if(r<0){return 1;}return r;}return 0;case"heightZoomFactor":var q=document.getElementById("page");var U=document.getElementById("rwb_viewer");var G=document.getElementById("rwb_ruler_table");if(q&&U){var Z=0;var e=0;if(q.style.borderTopWidth&&(q.style.borderTopWidth.indexOf("pt")>-1)){Z+=parseInt(microstrategy.number.toLocalUnits(mstrNumber.UNIT_PX,microstrategy.number.convertToUSUnits(mstrNumber.UNIT_PT,parseInt(q.style.borderTopWidth),true),true));}if(q.style.borderBottomWidth&&(q.style.borderBottomWidth.indexOf("pt")>-1)){Z+=parseInt(microstrategy.number.toLocalUnits(mstrNumber.UNIT_PX,microstrategy.number.convertToUSUnits(mstrNumber.UNIT_PT,parseInt(q.style.borderBottomWidth),true),true));}if(document.getElementById("hRulerRow")){e=getObjHeight(document.getElementById("hRulerRow"));}var E=0;var B=microstrategy.objectListFind(q,"div","dsec");for(var k=0;k<B.length;k++){var S=B[k].firstChild;var X=(S.style.display=="block"||S.style.display=="");if(S.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_TITLEBAR&&X){E+=getObjHeight(S);}}var r=((getObjHeight(U)-Z-2*SCROLLBAR_SIZE-E)/(getObjHeight(q)+e-E-Z)*microstrategy.ZOOM_FACTOR-0.5).toFixed(0);if(r<0){return 1;}return r;}return 0;case"IVEMode":return microstrategy.DISPLAY_MODE===microstrategy.VIEW_MODE&&P.currentRWViewMode===microstrategy.RW_VIEW_MODE_VIEWANALYSIS;case"designViewMode":case"convertToDoc":return microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;case"publishViewMode":case"staticViewMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_STATIC;case"interactiveViewMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_INTERACTIVE;case"editableMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_EDITABLE;case"flashViewMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_FLASH;case"export":return mstr.controllers.ExportTypes.getExportModes();case"docSelectedVisualization":var d=[];var Q=-1;var I=P.visualizationList;if(P.isVisualization&&I&&I.length>0){for(var k=0;k<I.length;k++){if(I[k].vm==P.visualizationMode){if(P.selectedVisualization==I[k].name){Q=k;}d.push({dssid:I[k].name+"|"+I[k].vm,n:I[k].desc});}}return{items:d,value:I[Q].name+"|"+I[Q].vm};}return{items:[]};case"toggleFlashGrouping":return P.groupingChecked&&P.groupingChecked();case"toggleConditionalFormatting":return P.isFeatureAvailable("rw-check-document-thresholds");case"hasMultipleLayouts":return P.isMultiLayout&&P.BeforeLayoutItems&&P.BeforeLayoutItems.length>1;case"showJoinBehavior":var o=microstrategy.findBone(P.doc.selections.getSelectedGrid());return o&&o.isGrid;case"gridJoinType":var O=microstrategy.findBone(P.doc.selections.getSelectedGrid()),N=[];if(O){var C=O.editorProperties,J=C&&C.outerJoinType,R={alias:microstrategy.descriptors.getDescriptor("13185"),dssId:"allAttrs",jt:J||"dft",n:"allAttrs",ic:"jt-allattrs"},a=O.gridStructureInfo.metricAxis.units,s=C&&C.tmsProps,Y=C&&C.dmsProps;N.push(R);a=a&&mstr.$A.filter(a,{filter:function(g){var u=g.dssId,t;if(s&&s[u]){t=s[u];if(t.isDerived&&!t.afb&&t.isSmart&&!t.isSmartCalInBase){return false;}}return true;}},"filter");var M,T,n={};for(M in a){T=a[M].dssId;N.push({dssId:T,alias:a[M].alias,jt:(s&&s[T]&&s[T].outerJoinType)||"dft",n:"metric",ic:"jt-metric"});n[T]=true;}for(T in Y){var L=Y[T];if(!n[T]&&(!L.isDerived||L.afb||!L.isSmart||L.isSmartCalInBase)){N.push({dssId:T,alias:L.alias,jt:L.outerJoinType||"dft",n:"metric",ic:"jt-metric"});}}}return N;case"candidateAttributes":return P.getPureAttributes();default:return(P&&P.doc&&P.doc.commands)?P.doc.commands.queryState(F,c):null;break;}}catch(l){microstrategy.errors.log(l);return false;}};mstrViewerCommandsImpl.prototype.queryVisible=function(A){try{var C=this.parentBone;switch(A){case"docSelectedVisualization":var B=C.visualizationList;return C.isVisualization&&B&&B.length>1&&C.getAllVisList()&&C.getAllVisList()[C.selectedVisualization].sw!="0";case"docVisualizationModeFlash":return C.visualizationsEnabled&&this.isVisModeEnabled(50);case"docVisualizationModeAJAX":return C.visualizationsEnabled&&this.isVisModeEnabled(51);case"tbLoading":return false;case"openPage":return microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE;}return(C.doc&&C.doc.commands)?C.doc.commands.queryVisible(A):true;}catch(D){microstrategy.errors.log(D);return true;}};mstrViewerCommandsImpl.prototype.isVisModeEnabled=function(B){for(var A in this.parentBone.visualizationList){if(this.parentBone.visualizationList[A].vm==B){return true;}}return false;};mstrViewerCommandsImpl.prototype.execPingServer=function(){if(this.pingServer&&mstr.http.PingServer&&mstr.models.BooleanTaskModel){var A=microstrategy.updateManager;if(A.hasNewChanges()){var B=new mstr.http.PingServer();if(!this.booleanTaskModel){this.booleanTaskModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.booleanTaskModel);this.booleanTaskModel&&this.booleanTaskModel.init&&this.booleanTaskModel.init();this.booleanTaskModel.attachEventListener(this,"set_readyState","pingCallback");}this.booleanTaskModel.execSubmit(B);}if(this.parentBone.keepAlive){window.setTimeout("microstrategy.getViewerBone().commands.exec('ping');",this.parentBone.keepAlive);}return true;}return false;};mstrViewerCommandsImpl.prototype.pingCallback=function(A){try{switch(A.name){case"set_readyState":switch(A.memo.value){case mstr.Enum.Widget.READYSTATE.ERROR:this.pingServer=false;return ;}break;}}catch(B){microstrategy.errors.log(B);}};function mstrViewerCommandsImpl(){this.pingServer=true;return this;}mstrNumber.UNIT_CM="1";mstrNumber.UNIT_IN="2";mstrNumber.UNIT_MM="3";mstrNumber.UNIT_PT="4";mstrNumber.UNIT_PC="5";mstrNumber.UNIT_PX="6";mstrNumber.UNIT_EM="7";mstrNumber.prototype=new Object;mstrNumber.prototype.locale="1033";mstrNumber.prototype.units=mstrNumber.UNIT_IN;mstrNumber.prototype.unitsLabel="";mstrNumber.prototype.thousandSeparatorRegex=null;mstrNumber.prototype.toLocaleString=function(B){try{return(B+"").replace(".",mstr.Settings.Locale.DECIMALSEP);}catch(A){microstrategy.errors.log(A);return B;}};mstrNumber.prototype.toString=function(D,A){try{if(A==true){var C=this.getThousandSepRegex();if(C){D=String(D).replace(C,"");}}D=String(D).replace(mstr.Settings.Locale.DECIMALSEP,".");return D;}catch(B){microstrategy.errors.log(B);return D;}};mstrNumber.prototype.toUserUnits=function(C,B){try{return this.toLocalUnits(this.units,C,B);}catch(A){microstrategy.errors.log(A);}};mstrNumber.prototype.toLocalUnits=function(D,E,C){try{var A;switch(D){case mstrNumber.UNIT_CM:A=(parseFloat(this.toString(E))*2.54).toFixed(4)+"";break;case mstrNumber.UNIT_MM:A=(parseFloat(this.toString(E))*25.4).toFixed(4)+"";break;case mstrNumber.UNIT_PT:A=(parseFloat(this.toString(E))*72).toFixed(4)+"";break;case mstrNumber.UNIT_PC:A=(parseFloat(this.toString(E))*6).toFixed(4)+"";break;case mstrNumber.UNIT_PX:A=(parseFloat(this.toString(E))*microstrategy.DPI_CONVERSION)+"";break;case mstrNumber.UNIT_EM:A=(parseFloat(this.toString(E))*10.6666).toFixed(4)+"";break;default:A=parseFloat(this.toString(E)).toFixed(4)+"";}if(C){return A;}else{return this.toLocaleString(A);}}catch(B){microstrategy.errors.log(B);}};mstrNumber.prototype.toUSUnits=function(C,B){try{return this.convertToUSUnits(this.units,C,B);}catch(A){microstrategy.errors.log(A);}};mstrNumber.prototype.convertToUSUnits=function(D,E,C){try{var A=E;switch(D){case mstrNumber.UNIT_CM:A=parseFloat(this.toString(E))/2.54+"";break;case mstrNumber.UNIT_MM:A=parseFloat(this.toString(E))/25.4+"";break;case mstrNumber.UNIT_PT:A=parseFloat(this.toString(E))/72+"";break;case mstrNumber.UNIT_PC:A=parseFloat(this.toString(E))/6+"";break;case mstrNumber.UNIT_PX:A=parseFloat(this.toString(E))/microstrategy.DPI_CONVERSION+"";break;case mstrNumber.UNIT_EM:A=(parseFloat(this.toString(E))/10.6666)+"";break;}if(C){return A;}else{return this.toLocaleString(A);}}catch(B){microstrategy.errors.log(B);}};mstrNumber.prototype.convertUnit=function(B,C,A){return this.toLocalUnits(C,this.convertToUSUnits(B,A,true),true);};mstrNumber.prototype.getThousandSepRegex=function(){if(this.thousandSeparatorRegex==null){var A=mstr.Settings.Locale.THOUSANDSEP;A=A.replace(/(\W){1}/g,"\\$1");this.thousandSeparatorRegex=new RegExp(A,"g");}return this.thousandSeparatorRegex;};function mstrNumber(){return this;}microstrategy.number=new mstrNumber();mstr.behaviors.Generic=(function(){var J={};J.returnFalse=function(){return false;};J.returnTrue=function(){return true;};J.set_enabled=function B(K,G){K&&(K.disabled=!G);};J.set_tooltip=function I(K,G){K&&(K.title=(G!=null)?G:"");};J.clearBrowserHighlights=function D(G){mstr.utils.Dom.clearBrowserHighlights(G);return true;};J.set_css_display=function A(M,N,K,L){if(M&&M.style){var G=!!L?N:K;if(!mstr.utils.ISW3C){if(G=="table"){G="block";}}M.style.display=G;}};J.toggleCellElement=function F(S,Q,P,M,N,L,O){var G=(Q>-1)&&S&&S.rows&&S.rows[Q];var R=G&&G.cells&&G.cells[P];var K=R&&R.childNodes&&R.childNodes[M];this.set_css_display(K,N,L,O);};J.renderState=function E(G,L){if(!G){return ;}var M=null;if(L&mstr.Enum.Widget.STATE.SELECTED){M=mstr.Settings.Scheme.SELECTED_BORDERCOLOR;}else{if(L&mstr.Enum.Widget.STATE.HOVER){M=mstr.Settings.Scheme.HOVER_BORDERCOLOR;}else{M=mstr.Settings.Scheme.DEFAULT_BORDERCOLOR;}}if(M!=null){G.style.border="1px "+M+" solid";G.style.margin="0px";}else{G.style.border="0px";G.style.margin="1px";}var K=null;if(!G.disabled&&(L&mstr.Enum.Widget.STATE.SELECTED)&&(L&mstr.Enum.Widget.STATE.HOVER)){K=mstr.Settings.Scheme.SELECTED_HOVER_BGCOLOR;}else{if(L&mstr.Enum.Widget.STATE.SELECTED){K=mstr.Settings.Scheme.SELECTED_BGCOLOR;}else{if(!G.disabled&&(L&mstr.Enum.Widget.STATE.HOVER)){K=mstr.Settings.Scheme.HOVER_BGCOLOR;}else{K=mstr.Settings.Scheme.DEFAULT_BGCOLOR;}}}G.style.backgroundColor=(K!=null)?K:"transparent";};J.oncontextmenu=function C(O,K,G){var M=mstr.$obj(G);var L=new mstr.lang.Event(O,K);if(!M||!M.fireCommands){return true;}var N=M.getModel().getRMCModel();if(M.props.enabled&&N){M.execCommand("OpenPopup",{popup:mstr.$obj("RMCPopup1"),x:L.x+3,y:L.y+3});cancelEvent(O);return false;}return true;};J.on_model_set_validationStatus=function H(K,L,O){if(K.props.visible&&K.props.enabled){var G=L&&L.get("validationStatus"),N=G&&G.statusCode;if(N&&N!=mstr.Enum.Validation.STATUSCODE.VALID){var M=L&&L.get("message");if(M){alert(M);}}}};return J;})();mstr.behaviors.MojoWidget=(function(){var MW={};MW.on_set_visible=function MW_on_set_visible(view,model,rootTag){var bShow=view.props.visible;mstr.behaviors.Generic.set_css_display(rootTag,"block","none",bShow);if(bShow){this.renderMojoWidget(view,model,rootTag);}};MW.renderMojoWidget=function MW_renderMojoWidget(view,model,rootTag){var props=view.props,id=props.id,cfg=props.cfg,uiCfg=cfg.ui,dataCfg=cfg.data,dataProp=cfg.dataProp,mojoConfig={};if(!mstr.utils.String.isEmpty(cfg)){try{uiCfg=eval("("+uiCfg+")")||{};}catch(ex){}mojoConfig=uiCfg;var data=dataProp&&model.props[dataProp]||{};if(dataProp===undefined){try{dataCfg=eval("("+dataCfg+")")||{};}catch(ex){}data=dataCfg;}}mojoConfig.placeholder=rootTag.lastChild;mojoConfig.id=id.replace("id_","");var fnHandlePropChanges=function(newV){var m=model.getAncestorByProperty(dataProp,true);if(m){m.set(dataProp,newV);}};switch(props.name){case"ACLEditor":mstr.$H.overwrite(mojoConfig,{acls:data});mojoConfig.onhasChangedChange=function(){var newV=this.getACLItems();fnHandlePropChanges(newV);};mojoConfig.getAvailableRightsForSelection=function(){return model.props.userSubscribeRights.items;};microstrategy.showSharingEditor(null,null,null,mojoConfig);break;}};return MW;})();mstr.behaviors.FloatingEditor=(function(){var B={};B.on_set_visible=function A(C,E,F){var D=C.props.visible;if(C.get("isModal")){mstr.controllers.ModalEditors[D?"add":"remove"](C);}if(D){F.style.zIndex=microstrategy.getMaxZIndex();}mstr.behaviors.Generic.set_css_display(F,"block","none",D);};return B;})();mstr.behaviors.TextBox=(function(){var D={};D.on_set_visible=function B(P,S,V){mstr.behaviors.Generic.set_css_display(V,"block","none",P.props.visible);if(mstr.utils.ISIE4&&!V.mstrInitialized){V.mstrInitialized=true;var T=V.getElementsByTagName("input")[0];if(T){var O=T.onfocus,U=function(){P.textBoxInitialized=true;return true;};if(O){T.onfocus=function(){return O.apply(this,arguments)&&U.apply(null,arguments);};}else{T.onfocus=U;}var R=T.onblur,Q=function(){P.textBoxInitialized=false;return true;};if(R){T.onblur=function(){return Q.apply(null,arguments)&&R.apply(this,arguments);};}else{T.onblur=Q;}}self.setTimeout('mstr.behaviors.TextBox.initValue("'+P.getId()+'")',100);}};D.initValue=function K(O){var P=mstr.$obj(O);if(P){this.on_model_set_value(P,P.props.model,P.props.element);}};D.on_set_enabled=function H(P,R,S){mstr.behaviors.Generic.set_enabled(S,P.props.enabled);var O=S.childNodes[1].childNodes[0];var Q=P.props.enabled;mstr.behaviors.Generic.set_enabled(O,Q);O.style.backgroundColor=Q?"#ffffff":"#d4d0c8";};D.on_set_caption=function N(P,Q,S){var R=S.childNodes[0];var O=P.props.caption;R.childNodes[0].innerHTML=(O!=null)?O:"";mstr.behaviors.Generic.set_css_display(R,"block","none",(O!=null)&&(O!=""));};D.on_set_size=function M(O,P,R){var Q=parseInt(O.props.size);if(!isNaN(Q)){R.childNodes[1].childNodes[0].size=Q;}};D.on_set_maxlength=function I(P,Q,R){var O=parseInt(P.props.maxlength);if(!isNaN(O)){R.childNodes[1].childNodes[0].maxlength=O;}};D.on_model_set_dataType=function A(O,P,R){var Q=mstr.utils.Math.isDataTypeNumeric(P&&P.get("dataType"));R.childNodes[1].childNodes[0].style.textAlign=Q?"right":"left";};D.on_model_set_value=function F(O,Q,S){var P=Q&&Q.get(O.get("valueField"));if(P==null){P="";}P+="";O.props.rendering=true;var R=O.get("selectionRange");if(R){window.setTimeout(function(){O.set("selectionRange",null);},0);}if(mstr.utils.ISIE4){if(!O.textBoxInitialized||!this._containDBCharacter(P)){S.value=P;}}else{if(S.value!=P){S.value=P;}}if(R){mstr.utils.Controls.setSelectionRange(S,R.start,R.end);}O.props.rendering=false;O.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});};D._containDBCharacter=function J(O){for(var P=0;P<O.length;P++){var Q=O.charCodeAt(P);if(Q>256&&!this._isDBCurSymbol(Q)){return true;}}return false;};D._isDBCurSymbol=function J(O){return(O==8364)||(O==8361)||(O==65509)||(O==65510);};D.on_value_change=function L(X,T,U){var V=mstr.$obj(X);if(!V){return true;}if(V.props.rendering){return true;}var S=V.getModel();if(S){var Y=mstr.utils.Math.convertStringToDataType(T&&T.value,S.get("dataType"));var O=document.getElementsByClassName("mstrImagePreview")[0];if(O){var Q=microstrategy.getViewerBone().doc.prevSelectedId,W=document.getElementById(Q);if(U){var P=mstr.utils.Math.convertStringToDataType(window.URL.createObjectURL(U),S.get("dataType"));U.url=P;W.setAttribute("ut",mstr.Enum.IMAGE_URL_TYPE.IMAGE_NAME);O.blobURL=P;O.imgName=T.value;}else{O.blobURL=undefined;W.setAttribute("ut",mstr.Enum.IMAGE_URL_TYPE.HTTP_URL);}}var Z=(!V.get("validator")||V.get("validator").validate(Y));if(Z){V.set("selectionRange",mstr.utils.Controls.getSelectionRange(T));if(O){S._storeDeltaProp("imgFile",U);}S.set(V.props.valueField,Y);S.set("isComplex",false);}}var R=V.fireCommands&&V.fireCommands();return true;};D.on_file_selected=function G(O,S){if(S.type!=="file"||!S.files[0]){return false;}var V=document.getElementById("imgUrl_txt"),R=S.files[0];S.value="";if(S.value!=""){var U=S.cloneNode(true);S.parentNode.appendChild(U);if(S.removeNode){S.removeNode(true);}}var P=R.name,Q=["image/jpeg","image/bmp","image/gif","image/png"],T=true;me=this,ONE_MB=1<<20,IMG_MAX_SIZE=3,ORI_MAX_SIZE=10;if(R.size>ORI_MAX_SIZE*ONE_MB||(R.size>IMG_MAX_SIZE*ONE_MB&&R.type==="image/gif")){mstrmojo.alert(mstrmojo.desc(14665,"Cannot embed an image larger than ##MB. Enter a URL to the image instead.").replace("##",IMG_MAX_SIZE));return false;}mstr.$A.forEach(Q,function(X){if(T&&R.type===X){var Y=new Image(),W=new FileReader();W.onload=function(Z){Y.src=Z.target.result;Y.onload=function(){var a=R;if(R.size>IMG_MAX_SIZE*ONE_MB){var d=mstrmojo.imageUtils,c=Y.naturalWidth>=1920&&Y.naturalHeight>=1080?45:75,e=R.type==="image/png"?"png":"jpg";compressImg=d.compress(Y,c,e);a=d.dataURLToBlob(compressImg.src);if(a.size>IMG_MAX_SIZE*ONE_MB){mstrmojo.alert(mstrmojo.desc(14633,"Cannot embed an image larger than ##MB. Your image is still ###MB after compression. Enter a URL to the image instead.").replace("##",IMG_MAX_SIZE).replace("###",(a.size/ONE_MB).toFixed(1)));return false;}}V.value=P;me.on_value_change("imgUrl",V,a);};Y.onerror=function(){mstrmojo.alert(mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."));return false;};};W.onerror=function(){mstrmojo.alert(mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."));return false;};W.readAsDataURL(R);T=false;return false;}});if(T){mstrmojo.alert(mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."));return false;}};D.on_keyPress=function E(R,O){R=R||hWin.event;if(R.keyCode==13){var P=mstr.$obj(O);if(!P){return true;}var Q=P.getModel();if(!Q){return true;}if(!Q.get("submitQueueOnEnter")){return true;}if(Q.submitParentQueue){Q.submitParentQueue();}return false;}return true;};D.on_set_validationStatus=function C(O,P,Q){mstr.behaviors.Controls.on_set_validationStatus(O,P,Q);if(!mstr.behaviors.Controls.needsValidation(O)){return true;}if(mstr.behaviors.Controls.validate(O)){Q.style.backgroundImage="none";}else{Q.style.background="#ffffff url(../style/mstr/images/errorLine.gif) bottom left repeat-x";}return true;};return D;})();mstr.behaviors.TextBoxWithIcon=(function(){var B={};B.on_set_enabled=function H(K,N,O){var M=!!K.props.enabled;mstr.behaviors.Generic.set_enabled(O,M);var L=O.childNodes[1].rows[0].cells;var J=L[0].childNodes[0].firstChild;mstr.behaviors.Generic.set_enabled(J,M);J.style.backgroundColor=M?"#ffffff":"#d4d0c8";var I=L[1].childNodes[0];mstr.behaviors.ToolButtonRounded.markAsEnabled(I,M);};B.on_set_caption=function E(J,K,M){var L=M.childNodes[0];var I=J.props.caption;L.childNodes[0].innerHTML=(I!=null)?I:"";mstr.behaviors.Generic.set_css_display(L,"block","none",(I!=null)&&(I!=""));};B.on_set_size=function C(I,J,L){var K=parseInt(I.props.size);if(!isNaN(K)){L.childNodes[1].rows[0].cells[0].childNodes[0].size=K;}};B.on_set_maxlength=function D(J,K,L){var I=parseInt(J.props.maxlength);if(!isNaN(I)){L.childNodes[1].rows[0].cells[0].childNodes[0].maxlength=I;}};B.on_model_set_valueString=function A(I,K,L){var J=K&&K.get("valueString");if(J==null){J="";}L.childNodes[1].rows[0].cells[0].childNodes[0].value=J;};B.onkeypress=function G(L,J,I,K){L=L||J.event;if(L.keyCode==13){this.fire(I,K);stopEventBubbling(L);return false;}return true;};B.fire=function F(I,K){var J=mstr.$obj(I);if(J&&J.fireCommands&&!!J.props.enabled){J.fireCommands(null,K);}return true;};return B;})();mstr.behaviors.ToolButtonRounded=(function(){var E={};E.hover=function C(F){F&&!F.disabled&&(F.style.backgroundPosition="center right");};E.unhover=function B(F){F&&!F.disabled&&(F.style.backgroundPosition="center left");};E.on_set_enabled=function D(F,G,H){this.markAsEnabled(H,!!F.props.enabled);};E.markAsEnabled=function A(G,F){if(!F){this.unhover(G);}mstr.behaviors.Generic.set_enabled(G,F);G.childNodes[0].style.backgroundPosition=F?"left center":"right center";G.childNodes[0].style.cursor=F?"pointer":"default";};return E;})();mstr.behaviors.ToolButton=(function(){var B={};B.hover=function A(F){F&&!F.disabled&&mstr.behaviors.Generic.renderState(F,mstr.Enum.Widget.STATE.HOVER);};B.unhover=function D(F){F&&mstr.behaviors.Generic.renderState(F,0);};B.on_set_enabled=function E(F,G,H){this.markAsEnabled(H,!!F.props.enabled);};B.markAsEnabled=function C(G,F){if(!F){this.unhover(G);}mstr.behaviors.Generic.set_enabled(G,F);G.style.backgroundPosition=F?"left center":"right center";};return B;})();mstr.behaviors.TextLink=(function(){var A={};A.on_set_enabled=function B(D,F,G){var C=G&&G.childNodes[0];if(!C){return ;}var E=D.props.enabled;C.disabled=!E;if(E){C.className=C.className.replace("Disabled","");}else{C.className+="Disabled";}};return A;})();mstr.behaviors.TextFieldLabel=(function(){var A={};A.on_model_set_value=function B(C,F,E){var D=F&&F.get(C.get("valueField"));if(D==null){D="";}D+="";E.innerHTML=D;};return A;})();mstr.behaviors.TextDiv=(function(){var A={};A.on_set_caption=function B(E,F,H){var G=H.childNodes[0];var D=E.props.caption;G.innerHTML=(D!=null)?D:"";mstr.behaviors.Generic.set_css_display(G,"block","none",(D!=null)&&(D!=""));};A.on_model_set_value=function C(D,F,G){var E=(F&&F.get&&F.get("value"))||F;if(E==null||E==undefined||typeof (E)!="string"){E="";}G.childNodes[1].innerHTML=E;};return A;})();mstr.behaviors.ListTextDiv=(function(){var A={};A.on_model_set_items=function B(D,E,F){F.childNodes[1].innerHTML=this.buildObjectListString(E);};A.buildObjectListString=function C(E){var G=[];for(var F=0,D=mstr.$A.len(E);F<D;F++){G[F]=E[F]["n"];}return G.join(", ");};return A;})();mstr.behaviors.Pulldown=(function(){var E={};E.onmousedown=function G(K){var L=mstr.$obj(K);var M=L.getModel&&L.getModel();if(L.props.enabled&&!this._showAsLabel(L,M)){if(L.get("opened")){L.execCommand("ClosePopup");}else{L.execCommand("OpenPopup");if(L.get("popup")&&L.get("popup").focus){L.get("popup").focus();}}}return true;};E.on_set_enabled=function C(K,M,Q){var L=!!K.props.enabled;Q.disabled=!L;var P=Q.childNodes[0];P.style.color=L?"#000000":"#808080";var O=Q.childNodes[1].rows[0].cells[1];O.style.color=L?"#000000":"#808080";O.style.backgroundColor=(this._showAsLabel(K,M))?"transparent":(L?"#ffffff":"#d4d0c8");O.style.cursor=(L&&!this._showAsLabel(K,M))?"pointer":"default";if(O.childNodes[1].firstChild){O.childNodes[1].firstChild.ignoreMouseEvents=!(L&&!this._showAsLabel(K,M));}var N=K.get("disabledModelValue");if(!L&&N!=undefined){M.execSingleSelect(N);}};E.on_set_opened=function J(K,L,N){var M=N.childNodes[1].rows[0].cells[2].childNodes[0];if(K.props.opened){M.className+="Pushed";}else{M.className=M.className.replace(/Pushed/,"");}};E.on_set_width=function A(M,N,O){var L=M.props.width;if(L&&L!="auto"&&!L.match(/\%$/)){O.style.width=L;O.childNodes[1].style.width=L;O.childNodes[1].style.tableLayout="fixed";var K=M.props.popup;if(K){K.width=L;}}};E.on_set_enabled_colorPicker=function I(K,M,P){var L=!!K.props.enabled;P.disabled=!L;var O=P.childNodes[1].rows[0].cells[1].childNodes[1];var N=M.get("actualColor");if(N&&N.indexOf(",")>0){N="#"+N.split(",")[0];}O.style.backgroundColor=L?N:"#a3a19d";};E.clickColorButton=function D(P){var M=mstr.$obj(P);var L=M?M.get("model"):null;var N=L?L.get("parent"):null;var O=M.props.modelPath;var K=O.substring(O.lastIndexOf(mstr.controllers.Factory.PATHDELIM)+1,O.length);if(N&&N.exec){N.exec(K,L.get("actualColor"));}};E.showPulldownOrLabel=function B(K,M,P){var O=P.childNodes[1].rows[0].cells[2];O.style.display=(!this._showAsLabel(K,M))?((mstr.utils.ISW3C)?"table-cell":"block"):"none";var L=P.childNodes[1].rows[0].cells[1];var N=L.className;if(this._showAsLabel(K,M)){if(!/AsLabel$/.test(N)){N+="AsLabel";}}else{N=N.replace(/AsLabel$/,"");}L.className=N;};E._showAsLabel=function H(K,M){var L=M&&M.props&&M.props.items;return(K.props.showSingleItemListAsLabel&&(L&&mstr.$A.len(L)==1));};E.on_model_set_readyState=function F(T,Q,V){var O=Q&&Q.get("readyState");T.set("message",null);var U=V.childNodes[1].rows[0].cells[1];var N=U.childNodes[1];var M=U.childNodes[2];var L=false;if((O!=mstr.Enum.Widget.READYSTATE.IDLE)&&mstr.utils.Hash.isEmpty(Q&&Q.get("selectedIndices"))){L=true;}if(!L){M.style.display="none";N.style.display="block";this.showPulldownOrLabel(T,Q,V);}else{N.style.display="none";M.style.display="block";var S='<span class="'+(T.props.cssPrefix||"")+(T.props.cssClass||"")+'ReadyState">';var K="</span>";var P="";var R=T.props.descriptors;switch(O){case mstr.Enum.Widget.READYSTATE.SUCCESS:P=R&&R.loadingText;break;case mstr.Enum.Widget.READYSTATE.CANCELLED:P=R&&R.requestCancelledText;break;case mstr.Enum.Widget.READYSTATE.WAITING:P=R&&R.waitingText;break;case mstr.Enum.Widget.READYSTATE.TIMEOUT:P="Request timed out.";break;case mstr.Enum.Widget.READYSTATE.ERROR:default:P=R&&R.requestTimeOutText;break;}M.innerHTML=S+P+K;}};return E;})();mstr.behaviors.ListView=(function(){var K={};K.on_set_height=function I(L,N,R){var Q=L&&L.props,P=Q&&Q.scrollArea,M=P&&P.style,O=Q.height;if(M&&O){M.height=O;}};K.on_set_width=function G(M,O,R){var Q=M&&M.props,P=Q&&Q.scrollArea,N=P&&P.style,L=Q.width;if(!N){return ;}if(L==""||L=="auto"){R.style.width=N.width=L;}else{if(L&&L.match(/\%$/)){R.style.width=L;if(!mstr.utils.ISIE6){N.width="auto";}}else{N.width=(L!=null)?L:"";R.style.width="auto";}}};K.on_set_caption=function A(M,N,P){var L=M.props.caption!=null?M.props.caption:"";var O=P.rows[0].cells[0].firstChild.firstChild;mstr.behaviors.Generic.set_css_display(O,"block","none",L!="");O.innerHTML=L;};K.on_set_message=function F(L,M,R){var Q=L&&L.props,O=Q&&Q.message,N=Q&&Q.scrollArea,P=N&&N.childNodes;if(!P){return ;}if(O){P[0].style.display="none";P[1].style.display="none";P[2].style.display="block";P[2].firstChild.innerHTML=O;}else{P[0].style.display="block";P[1].style.display="none";P[2].style.display="none";}};K.on_model_set_leadIndex=function C(M,N,O){var L=mstr.utils.ListViewHelper.getItemRenderer(M);if(!L||!L.on_set_leadIndex){return false;}return L.on_set_leadIndex(M,N,O);};K.on_model_set_readyState=function J(X,S,Y){var Q=S&&S.get("readyState");X.set("message",null);var P=X.props.scrollArea,W=P.childNodes,O=W[1],R=W[0];if(Q==mstr.Enum.Widget.READYSTATE.IDLE){O.style.display="none";R.style.display="block";X._updateEmptyMessage();}else{var N=!X.props.showItemsDuringRequest;if(N){R.style.display="none";}O.style.display="block";var T=X.props.descriptors;switch(Q){case mstr.Enum.Widget.READYSTATE.SUCCESS:O.innerHTML=microstrategy.descriptors.getDescriptor("5674");break;case mstr.Enum.Widget.READYSTATE.CANCELLED:O.innerHTML="Request cancelled.";break;case mstr.Enum.Widget.READYSTATE.WAITING:O.innerHTML=microstrategy.descriptors.getDescriptor("5674");break;case mstr.Enum.Widget.READYSTATE.TIMEOUT:O.innerHTML="Request timed out.";break;case mstr.Enum.Widget.READYSTATE.ERROR:default:var M=T&&T.errorText,U=S&&S.props.requestContext,V=U&&U.response,L=V&&V.errorMessage&&V.errorMessage.replace(/[\r\n]/g,"");if(L){M=M+' <a href="javascript:void(0)" onclick="alert(\''+L.replace(/'/g,"\\'")+"');return false;\">"+T.errorDetailsText+"</a>";}O.innerHTML=M;break;}}};K.ondblclick=function D(P,N,M){var O=mstr.$obj(M);if(!O||!O.fireCommands||!O.props.enabled){return true;}var L=O.props.cmdsDblClick;if(!L){return true;}O.fireCommands(L,null);return true;};K.onmousedown=function B(Q,N,T){var R=mstr.$obj(T);if(!R||!R.fireCommands||!R.props.enabled){return true;}var U=new mstr.lang.Event(Q,N);var M=U.ctrl(),W=U.shift();if(M||W){mstr.utils.Dom.clearBrowserHighlights(N);}var P={valueForm:null,ctrl:M,shift:W,browseType:null,rmc:U.rightClick()};var L=U.target();if(L){L.mstrViewId=T;}var V=mstr.utils.Dom.findAncestor(L,"mstrListItemInfo",null,R.props[mstr.$W.ELEMENT],true);if(V){var O=V.mstrListItemInfo.split("/");var T=O.shift();var S=O.pop();P.valueForm=O.join("/");if(!M&&!W&&!U.rightClick()&&String(L.nodeName).toLowerCase()=="a"){P.browseCommand=S;}}window.setTimeout(function(){R.fireCommands(null,P);},0);return true;};K.on_set_visible=function E(M,N,R){if(M.props.showDescriptions){var L=M.props.scrollArea,P=L.childNodes,O=P[0];O.className+=" mstrListWithDescriptions";}mstr.behaviors.Generic.set_css_display(R,"table","none",M.props.visible);var Q=M.props.id;if(mstr.utils.ISIE4&&!M.keysInited){var Q=M.props.id;R.attachEvent("onkeypress",function(S){mstr.$obj(Q).onkeypress(S,window);});R.attachEvent("onkeydown",function(S){mstr.$obj(Q).onkeydown(S,window);});M.keysInited=true;}};K.on_set_validationStatus=function H(L,O,P){mstr.behaviors.Controls.on_set_validationStatus(L,O,P);if(!mstr.behaviors.Controls.needsValidation(L)){return true;}var N=L&&L.get("validator");var M=N.get("cache");if(mstr.behaviors.Controls.validate(L)){if(M){P.style.color=M.c;P.style.textDecoration=M.td;}}else{if(M){M.c=P.style.color;M.td=P.style.textDecoration;}P.style.color="#ff0000";P.style.textDecoration="underline";}return true;};return K;})();mstr.itemrenderers={};mstr.itemrenderers.FastListView=(function(){var A={};A.listItemHeightMin=function E(J){return 20;};A.listItemHeight=function D(J){return(J&&J.props.showDescriptions)?40:20;};A.listItemHeightMax=function H(J){return(J&&J.props.showDescriptions)?40:20;};A.renderListItem=function C(V,P,Z,K){var Y=K.item;var X=V.props[mstr.$W.DOCUMENT];var Q=(V.props.cssPrefix||"")+(V.props.itemCSSPrefix||"");if("enabled" in Y&&!Y.enabled){Q+="Disabled";}var M=Q;if(Y.cssClass){M=V.props.cssPrefix+Y.cssClass+" "+Q;}var L=X.createElement("div");L.className=M;if(Y.cssText){L.style.cssText=Y.cssText;}if(V&&V.props.showDescriptions){L.style.height=this.listItemHeight(V)+"px";}L.onmouseover=this.hover;L.onmouseout=this.unhover;if(Y.n!=null&&Y.n!=""&&Y.desc!=null&&Y.desc!=""){L.title=Y.n+". "+Y.desc;}else{if(Y.n!=null&&Y.n!=""&&Y.dsn!=null&&Y.dsn!=""){L.title=Y.n+" ("+Y.dsn+")";}else{if(Y.n!=null&&Y.n!=""){L.title=Y.n;}else{if(Y.desc!=null&&Y.desc!=""){L.title=Y.desc;}}}}var R=X.createElement("div");L.appendChild(R);R.className=Q+"Name";if(V.props.showDescriptions&&Y.desc){var J=X.createElement("div");L.appendChild(J);J.className=Q+"Desc";J.appendChild(X.createTextNode(Y.desc));}else{var J=null;}var T=null;if(V.props.shouldReplaceSpace){var S=Y.n.replace(/ /g,"\u00a0");T=X.createTextNode(S||"");}else{T=X.createTextNode(Y.n||"");}var W=K.browseCommand;if(W&&!Y.locked){var O=X.createElement("a");R.appendChild(O);O.appendChild(T);O.href="javascript:void(0)";var N=function(a){cancelEvent(a||window.event);return false;};O.onclick=N;O.tabIndex=-1;O.oncontextmenu=N;W=null;}else{R.appendChild(T);}if(V.props.showIcons){var U=Y.icon;if(Y.locked){U+="_locked";}if(U){mstr.utils.Dom.setBGIconClass(R,U);R.style.backgroundPosition="2px 50%";R.style.paddingLeft="23px";if(J){J.style.paddingLeft="23px";}}}return L;};A.hover=function(J){if(!this.ignoreMouseEvents&&!/Hover$/.test(this.className)){this.className+="Hover";}};A.unhover=function(J){if(!this.ignoreMouseEvents){this.className=this.className.replace(/Hover/,"");}};A.markListItemAsSelected=function B(J,K,O,L){if(J.get("ignoreSelection")){return ;}var M=L.elItem;if(!M){return ;}var N=M.className;if(/Hover/.test(N)){N=N.replace(/Hover/,"SelectedHover");}else{if(!/Selected/.test(N)){N+="Selected";}}M.className=N;};A.markListItemAsUnselected=function G(J,K,N,L){var M=L.elItem;if(!M){return ;}M.className=M.className.replace(/Selected/,"");};A.fireBrowse=function I(){var L=this.mstrListItemInfo||this.parentNode.mstrListItemInfo||this.parentNode.parentNode.mstrListItemInfo;L=L&&L.split("/");if(L&&(L[0]!=null)&&(L[1]!=null)&&(L[2]!=null)){var J=mstr.controllers.Factory.obj(L[0]);var K=J&&J.getModel();if(K){K.execCommand(L[2],L[1]);}}return true;};A.on_set_leadIndex=function F(K,L,O){var N=L&&L.get("leadIndex");if(N==null||N<0){return false;}var M=K&&K._getOrMakeElementForItemAt(N);if(!M){return false;}var J=K.get("scrollArea")||O.rows[0].cells[0].firstChild.childNodes[2];if(!J){return false;}mstr.utils.BoxModel.scrollToElement(J,M);};return A;})();mstr.itemrenderers.ListPulldownView=(function(){var A={};A.renderListItem=function(B,D,I,E){var C=mstr.itemrenderers.FastListView.renderListItem(B,D,I,E);var H=this._getContentContainer(I);mstr.utils.Dom.clearChild(H,0);H.appendChild(C);C.ignoreMouseEvents=!B.props.enabled||E.showAsLabel;H.title=C.title||"";if(mstr.utils.ISIE4){var F=H.style,G=F.width;if(G==null){G="";}F.width="1px";F.width=G;}};A.renderMultipleItems=function(H,E,I,B){var G=B.items;var F=mstr.$A.len(G);var J=new Array(F);for(var D=0;D<F;D++){J[D]=G[D]["n"];}J=J.join(", ");var C=this._getContentContainer(I);C.innerHTML=J;C.title=J;};A.renderEmpty=function(B,C,F,E){var D=(B.props.cssPrefix||"")+(B.props.cssClass||"");this._getContentContainer(F).innerHTML='<span class="'+D+'EmptyText">'+B.props.descriptors.emptyText+"</span>";};A._getContentContainer=function(B){return B.childNodes[1].rows[0].cells[1].childNodes[1];};return A;})();mstr.itemrenderers.CheckList=(function(){var H={};H.renderListItem=function G(M,J,Q,I){if(I.at==0){var L=(M.props.cssPrefix||"")+(M.props.cssClass||"");var O=L+(M.props.multiSelect?"Checks":"Radios");var K=['<table class="'+L+'Table" cellspacing="0" cellpadding="0">','<tbody class="'+O+'" >'];if(M.props.horizontal){K=K.concat(this._buildHorizontalTableHTML(M,J,Q));}else{K=K.concat(this._buildVerticalTableHTML(M,J,Q));}K.push("</tbody></table>");var P=this._getListContainer(Q);if(P){P.innerHTML=K.join("");}}var N=this._findCellForIndex(M,Q,parseInt(I.at),!M.props.horizontal);return N&&N.childNodes[0];};H._buildHorizontalTableHTML=function F(Q,M,S){var O=M&&M.getItems(),N=mstr.$A.len(O),J=Q&&parseInt(Q.props.arrangementSize),P=(!J||(J<1))?N:J,T=mstr.utils.Math.roundUpDiv(N,P);var L=[];if(T&&P){var I=0;for(var R=1;R<=T;R++){L.push("<tr>");for(var K=1;K<=P;K++){L.push(this._buildItemCell(Q,M,S,O[I++]));if(I>=N){break;}}L.push("</tr>");}}return L;};H._buildVerticalTableHTML=function C(Q,M,S){var O=M&&M.getItems(),N=mstr.$A.len(O),J=Q&&parseInt(Q.props.arrangementSize),T=(!J||(J<1))?N:J,P=mstr.utils.Math.roundUpDiv(N,T);var L=[];if(T&&P){var I;for(var R=1;R<=T;R++){L.push("<tr>");for(var K=1;K<=P;K++){I=(R-1)+(K-1)*T;if(I>=N){break;}L.push(this._buildItemCell(Q,M,S,O[I++]));}L.push("</tr>");}}return L;};H._buildItemCell=function A(Q,M,U,S){var J=(S.cssText&&S.cssText!="")?'" style="'+S.cssText:"";var N=(Q.props.cssPrefix||"")+(Q.props.itemCSSPrefix||"");if("enabled" in S&&!S.enabled){N+="Disabled";}var L=!!Q.props.multiSelect;var I=S.n;var O=S.desc;var T=['<td><div onmouseover="return mstr.itemrenderers.CheckList.hover(this)" onmouseout="return mstr.itemrenderers.CheckList.unhover(this)" class="'+N+'" title="'+((O!=null&&O!="")?I+". "+O:I)+J+'">'];var R=N+"Name";var K="";if(Q.props.showIcons){var P=S.icon;if(S.locked){P+="_locked";}if(P){R=mstr.utils.Dom.getBGIconClass(P)+" "+R;K=' style="padding-left: 23px" ';}}T.push('<div class="'+R+'" '+K+" >"+S.n+"</div>");if(Q.props.showDescriptions){if((O!=null)&&(O!="")){T.push('<div class="'+N+'Desc" '+K+" >"+O+"</div>");}}return T.join("");};H.hover=function E(I){I.className+="Hover";};H.unhover=function B(I){I.className=I.className.replace(/Hover/,"");};H._getListContainer=function D(I){return I.rows[0].cells[0].firstChild.childNodes[2].firstChild;};H.markListItemAsSelected=function(I,J,L,K){this._toggleCheckBox(I,J,L,K,true);};H.markListItemAsUnselected=function(I,J,L,K){this._toggleCheckBox(I,J,L,K,false);};H._toggleCheckBox=function(I,K,P,L,O){I.props.rendering=true;var M=this._findCellForIndex(I,P,parseInt(L.at),!I.props.horizontal);var J=M&&M.childNodes[0];if(J){if(O){var N=J.className;if(!(/Selected/.test(N))){var N=J.className;if(/Hover/.test(N)){N=N.replace(/Hover/,"SelectedHover");}else{N+="Selected";}J.className=N;}}else{J.className=J.className.replace(/Selected/,"");}}I.props.rendering=false;};H._findCheckboxForIndex=function(I,L,J,K){return this._findCellForIndex(I,L,J,K);};H._findCellForIndex=function(J,M,K,L){var I=this._computeRowColumnForIndex(J,K,L);if(I){return this._getListContainer(M).firstChild.rows[I.row].cells[I.col];}};H._computeRowColumnForIndex=function(I,K,N){var L=parseInt(I.props.arrangementSize);var M=(L&&L>0)?K%L:K;var J=(L&&L>0)?parseInt(K/L):0;if(N){return{row:M,col:J};}else{return{row:J,col:M};}};return H;})();mstr.behaviors.Popup=(function(){var B={};B.on_set_visible=function C(F,G,K,H){var E=F.props.id;var D=new Function("mstr.$obj('"+E+"').props['timeoutID'] = self.setTimeout(\"mstr.$obj('"+E+"').execCommand('Unpop');\", 500)");if((H&&H.init)||!F.props.animate){if(F.props.autoHide){K.onmouseover=new Function("self.clearTimeout(mstr.$obj('"+E+"').props['timeoutID']);");K.onmouseout=D;}return mstr.behaviors.Generic.set_css_display(K,"table","none",F.props.visible);}var I=!!F.props.visible;if(F.props.autoHide&&I){D();}if(I){mstr.behaviors.Generic.set_css_display(K,"table","none",F.props.visible);}var J=new Function("","mstr.behaviors.Popup.on_after_set_visible('"+F.props.id+"')");mstr.utils.Animations.alpha(K,I?0:100,I?100:0,I?5:15,J);};B.on_after_set_visible=function A(D){var E=mstr.$obj(D);if(!E){return ;}var F=!!E.props.visible;var G=E.props.element;if(!F){mstr.behaviors.Generic.set_css_display(G,"table","none",F);}};B.origon_set_visible=function C(D,E,F){mstr.behaviors.Generic.set_css_display(F,"table","none",D.props.visible);};return B;})();mstr.behaviors.Controls=(function(){var B={};B.on_model_set_value=function(C,G,H){if(H==null){return ;}var F=(G&&G.get&&G.get(C.props.valueField));C.props.rendering=true;if(H.tagName.toLowerCase()=="input"){switch(H.getAttribute("type").toLowerCase()){case"checkbox":H.checked=F||false;break;default:H.value=(F!=null&&F!=undefined)?F:"";C.fireCommands(null,G&&G.get&&G.get(C.props.valueField));break;}}else{H.innerHTML=F;}C.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});C.props.rendering=false;};B.on_set_validationStatus=function E(C,H,I){if(!mstr.behaviors.Controls.needsValidation(C)){return true;}var G=C&&C.get("validator");var F=G.get("cache");var J=C.get("validationStatus");if(mstr.behaviors.Controls.validate(C)){if(F){I.style.borderColor=F.b;I.setAttribute("title",F.t);}}else{if(!F){G.set("cache",{b:I.style.borderColor,t:I.getAttribute("title")});}I.style.borderColor="#ff0000";I.setAttribute("title",J.message);}return true;};B.needsValidation=function A(C){var F=C&&C.get("validator");if(!F){return false;}var G=C.get("validationStatus");if(!G){return false;}return true;};B.validate=function D(C){var F=C.get("validationStatus");return(F.statusCode==mstr.Enum.Validation.STATUSCODE.VALID);};return B;})();mstr.behaviors.ListToolButton=(function(){var B={};B.onmousedown=function A(C){var D=mstr.$obj(C);if(D.props.enabled){D.execCommand("OpenPopup");}return true;};return B;})();mstr.models.PromptAnswer=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.validate=function D(F,G){var E=this._validateInternally(F,G);this.set("message",this._getMsgForStatus(E.statusCode));this.set("validationStatus",E);return E.statusCode;};B.prototype.format=function A(E){return this.validate(E,true);};B.prototype.execValidate=function C(E){return(this.validate(E)==mstr.Enum.Validation.STATUSCODE.VALID);};function B(E){mstr.models.BaseModel.apply(this,[E]);}return B;})();mstr.models.ConstantPromptAnswer=(function(){mstr.$O.extendsClass(H,mstr.models.PromptAnswer);H.prototype.getValueString=H.prototype.getSelected=function D(){return this.props.isComplex?null:this.props.valueString;};H.prototype.isEmpty=function G(){var K=this.props,J=K.isComplex?K.complexString:K.valueString;return this._isEmptyAnswerString(J);};H.prototype._isEmptyAnswerString=function E(K){var P=false;var O=this.props;if(O&&O.dataType){var N=String(O.dataType).split(",");var L=mstr.Enum.Nodes.DATATYPE;var J=false;for(var M=0;M<N.length;M++){if(mstr.utils.Math.isDataTypeString(N[M])){J=true;break;}}if(J){if(!K){P=true;}}else{P=mstr.utils.String.isEmpty(K);}}else{P=mstr.utils.String.isEmpty(K);}return P;};H.prototype.format=function F(K){var J=this._validateInternally(K,true);if(J.valueStringFormatted){this.set("valueString",J.valueStringFormatted);}this.set("message",this._getMsgForStatus(J.statusCode));this.set("validationStatus",J);return J;};H.prototype._validateInternally=function C(L,P){var K=mstr.Enum.Validation.STATUSCODE,J={statusCode:K.VALID,context:L&&L.stage};var O=this.get("parent")&&this.get("parent").get("savingAnswer");var M=this.props;if(!M.isComplex){var N=this._validateString(M.valueString,P);J.statusCode=N.statusCode;J.valueStringFormatted=N.valueStringFormatted;}if(J.statusCode==K.VALID&&O){J.statusCode=this.validateSavedAnswer();}return J;};H.prototype._validateString=function A(R,M){var U=mstr.Enum.Validation.STATUSCODE,S={statusCode:U.VALID},K=this.props;if(this._isEmptyAnswerString(R)){if(K.required){S.statusCode=U.NO_INPUT;}}else{if(K.dataType){var V=String(K.dataType).split(",");var J=(mstr.utils.QualNode)?mstr.utils.QualNode.constValue2Array(R,!!K.multiSelect):[R],Z=M?J.concat():[];var T=K.min,W=K.max,Q=mstr.utils.Math,L=mstr.utils.LocaleParser;for(var X=0,Y=J.length;X<Y;X++){var a=J[X],O=L.whichDataType(a,V,M),N=M?O&&O.dataType:O,P;if(N==null){S.statusCode=U.INVALID_DATATYPE;break;}else{if(M){Z[X]=O.formatted;}if(Q.isDataTypeNumeric(N)){P=L.inNumericRange(a,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_VALUE:U.EXCEEDS_MIN_VALUE;break;}}else{if(Q.isDataTypeDateTime(N)){P=L.inDateTimeRange(a,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_VALUE:U.EXCEEDS_MIN_VALUE;break;}}else{if(Q.isDataTypeString(N)){P=L.inNumericRange(a.length,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_LENGTH:U.EXCEEDS_MIN_LENGTH;break;}}else{if(Q.isDataTypeBigDecimal(N)){P=L.inBigDecimalRange(a,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_VALUE:U.EXCEEDS_MIN_VALUE;break;}}}}}}}if(M){S.valueStringFormatted=(mstr.utils.QualNode)?mstr.utils.QualNode.constArray2Value(Z):(Z&&Z.length>0)?Z[0]:null;}}}return S;};H.prototype.loadRequestResponse=function B(){var J=this.props.requestContext;var L=J&&J.response;if(!L||!L.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}this.set("valueString",L.data.get("valueString"));var K=L.data.get("validationStatus");if(K&&K.statusCode!=mstr.Enum.Validation.STATUSCODE.VALID){this.set("message",this._getMsgForStatus(K.statusCode).replace("##",L.data.get("max")));this.set("validationStatus",K);}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};H.prototype.init=function I(){mstr.models.PromptAnswer.prototype.init.apply(this);if(!("CommandEnabledValidate" in this.props)){this.set("CommandEnabledValidate",true);}};function H(J){mstr.models.PromptAnswer.apply(this,[J]);}return H;})();mstr.models.ListModel=(function(){mstr.$O.extendsClass(V,mstr.models.BaseModel);V.RESERVED_LISTS={items:true};V.RESERVED_HASHS={selectedIndices:true};V.prototype.DEFAULTS={readyState:mstr.Enum.Widget.READYSTATE.IDLE};V.prototype.sethash=function o(Ao,Am){var An=this.hashclear(Ao);if(Am&&Am.length){return this.hashadd(Ao,Am);}else{return An;}};V.prototype.setlist=function J(Ao,Am){var An=this.listclear(Ao);if(Am&&Am.length){return this.listadd(Ao,Am);}else{return An;}};V.prototype.execToggleSelect=function AC(Am){if(this.props.selectedIndices[Am]){this.execRemoveSelect(Am);}else{this.execAddSelect(Am);}this.set("leadIndex",Am);return true;};V.prototype.execAddSelect=function AL(Am){if(!mstr.utils.ListModelHelper.canAdd(this,this.getItems()[Am])){return false;}var An={};An[Am]=true;this.hashadd("selectedIndices",An);this.props.anchorIndex=Am;return true;};V.prototype.execRemoveSelect=function AQ(Am){var An={};An[Am]=true;this.hashremove("selectedIndices",An);if(this.props.anchorIndex==Am){this.props.anchorIndex=-1;}return true;};V.prototype.execRangeSelect=function z(An){var Am=this.props.anchorIndex;if(Am<0){if(mstr.utils.ListModelHelper.canAdd(this,this.getItems()[An])){var Aq={};Aq[An]=true;this.hashadd("selectedIndices",Aq);}}else{var Aq={};var Ar=Math.min(An,Am);var Ap=Math.max(An,Am);for(var Ao=Ar;Ao<=Ap;Ao++){Aq[Ao]=true;}if(this.execSelect(Aq)){this.props.anchorIndex=Am;}}this.set("leadIndex",An);return true;};V.prototype.execSingleSelect=function AD(Am){if(!this.props.enableReselect){var Ao=this.props.selectedIndices;if(Ao&&Ao[Am]){if(!mstr.utils.Hash.lenGreaterThan(Ao,1)){return false;}}}var An={};An[Am]=true;if(this.execSelect(An)){this.props.anchorIndex=Am;this.set("leadIndex",Am);}return true;};V.prototype.execRMCSelect=function AR(Am){var Ao=this.props.selectedIndices;if(Ao&&Ao[Am]){return false;}var An={};An[Am]=true;this.execSelect(An);this.props.anchorIndex=Am;return true;};V.prototype.execSelect=function Ab(Am){Am=mstr.utils.ListModelHelper.verifySelectionKeys(this,Am);if(!Am){return false;}this.execClearSelect();this.hashadd("selectedIndices",Am);return true;};V.prototype.execDeleteSelected=function s(){var Am=this.props.selectedIndices;var An=mstr.$H.len(Am);if(!An){return ;}var Ao=mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(Am,true));this.removeItemsAt(Ao,true);};V.prototype.execRenameSelectedItem=function Al(Am){if(Am){var An=this.getSelectedIndex();if(An==null){return ;}var Ao=this.props.items&&this.props.items[An];if(Ao){this.removeItemsAt([An],true);Ao.n=Am;this.insertItemsAt([Ao],An);this.execSingleSelect(An);}}};V.prototype.execEnableIndices=function Ak(An){var Ap=mstr.utils.Hash.clone(this.getSelectedIndices());var Ar=false;for(var Am in An){var Ao=this.indexOfValue(Am);if(Ao==-1){continue;}var Aq=this.props.items&&this.props.items[Ao];if(!Aq||Aq.enabled==An[Am]){continue;}if(Ap[Ao]){Ar=true;}this.removeItemsAt([Ao],true);Aq.enabled=An[Am];this.insertItemsAt([Aq],Ao);}if(Ar){this.execSelect(Ap);}};V.prototype.verifySelectionKeys=function AB(Ao){var Am=this.getItems();for(var An in Ao){if(!mstr.utils.ListModelHelper.canAdd(this,Am[An])){delete Ao[An];}}return(mstr.utils.Hash.isEmpty(Ao))?null:Ao;};V.prototype.execSelectPrevious=function y(Ap){var Ar=this.props.selectedIndices;var As=this.getSelectedItems();var Aq=parseInt(this.props.leadIndex);var Am=parseInt(this.props.anchorIndex);if(Ap){var Ao=mstr.utils.Hash.maxNumber(Ar);if((Am==Aq)&&As.length>1){var An={};An[Aq]=true;if((Aq-1)>=0){An[Aq-1]=true;}this.execSelect(An);}else{if(Aq<=Ao){if((Aq-1)>=0){this.execRangeSelect(Aq-1);}}else{this.execRemoveSelect(Aq);this.set("leadIndex",Aq-1);}}}else{if((Aq-1)>=0){this.execClearSelect();this.execSingleSelect(Aq-1);}}return true;};V.prototype.execSelectNext=function Ai(Ap){var Ar=this.props.selectedIndices;var As=this.getSelectedItems();var An=this.props.items;var Aq=parseInt(this.props.leadIndex);var Am=parseInt(this.props.anchorIndex);if(Ap){if((Am==Aq)&&As.length>1){var Ao={};Ao[Aq]=true;if((Aq+1)<An.length){Ao[Aq+1]=true;}this.execSelect(Ao);}else{if(Aq>=Am){if((Aq+1)<An.length){this.execRangeSelect(Aq+1);}}else{this.execRemoveSelect(Aq);this.set("leadIndex",Aq+1);}}}else{if((Aq+1)<An.length){this.execClearSelect();this.execSingleSelect(Aq+1);}}return true;};V.prototype.execSingleSelectNextAndLoop=function Aa(){var An=this.props.selectedIndicesList;if(isNaN(An)){return false;}var Am=parseInt(An);var Ao=this.props.items.length;var Ap;if(Am+1<Ao){Ap=Am+1;}else{Ap=0;}this.execSingleSelect(Ap);return true;};V.prototype.execSelectString=function Ae(Ao,Aq,Ap){if(!Ao){return false;}if(!Aq){Aq="n";}var An=new RegExp("^"+Ao,"i"),Am=mstr.$A.matchByForm(this.getItems(),An,Aq,this.props.leadIndex+((Ap===undefined)?1:Ap));return(Am>-1)&&this.execSingleSelect(Am);};V.prototype.execSelectValue=function c(Am){var An=this.indexOfValue(Am);if(An==-1){return false;}this.execSingleSelect(An);return true;};V.prototype.execSelectValues=function AW(Am){if(!Am){return false;}if(typeof (Am)=="string"){Am=[Am];}var Ap={};for(var Ao=0;Ao<Am.length;Ao++){var An=this.indexOfValue(Am[Ao]);if(An!=-1){Ap[An]=true;}}if(mstr.utils.Hash.isEmpty(Ap)){return false;}return this.execSelect(Ap);};V.prototype.getSelectedIndices=function AY(){return this.props.selectedIndices;};V.prototype.getSelectedIndex=function AZ(){var Am=parseInt(mstr.$H.firstKey(this.props.selectedIndices));if(Am!=null&&!isNaN(Am)){return Am;}return -1;};V.prototype.getSelectedItems=function AJ(Aq){var An=this.props.items;if((!An||!An.length)&&this.props.keptSelections){return[].concat(this.props.keptSelections);}else{var Am=this.props.selectedIndices;var As=(Aq)?mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(Am,true)):Am;if(As){var Ar=[];for(var Ao in As){var Ap=(Aq)?An[As[Ao]]:An[parseInt(Ao)];if(Ap){Ar.push(Ap);}}return Ar;}}return null;};V.prototype.getSelectedItem=function m(){var Ao=this.props.selectedIndices;if(Ao){var Am=this.props.items;for(var An in Ao){return Am[parseInt(An)];}}return null;};V.prototype.getSelectedItemValue=function AG(){var An=this.getSelectedItem();var Am=An&&An[this.get("valueForm")];return Am||null;};V.prototype.setSelectedItems=function AN(Am){var An=this.indexOfMultiple(Am,false);if(An&&An.foundCount){this.execSelect(mstr.$A.toHash(An.indices));}else{this.execClearSelect();}};V.prototype.execClearSelect=function B(){var Am=mstr.$H.clone(this.props.selectedIndices);this.hashremove("selectedIndices",Am);this.props.anchorIndex=-1;this.props.leadIndex=-1;};V.prototype.execSelectAll=function e(){var Ao=[];var Am=this.getItems();for(var An=0;An<Am.length;An++){Ao.push(true);}this.execSelect(Ao);};V.prototype.queryEnabledSelectAll=function N(){return(this.getSelectedIndices().length!=this.getItems().length);};V.prototype.getItems=function S(){return this.props.items;};V.prototype.setItems=function AS(An){this.execClearSelect();var Ao=mstr.$A.len(this.props.items);if(Ao){var Am={min:0,max:Ao-1};this.removeItemsAtRanges([Am],true);}this.insertItemsAt(An,0);if(this.props.autoSelectFirstItem&&!this.props.defaultSelection&&this.getSelectedIndex()==-1){this.execSelect({0:true});}};V.prototype.insertItemsAt=function H(Ap,Aq){if(Aq==null||Aq<0){Aq=mstr.$A.len(this.props.items);}var Ar=mstr.$A.len(Ap);if(!Ar){return -1;}var Ao=this.props.selectedIndices;if(Ao){var Am={};for(var An in Ao){if(parseInt(An)>=Aq){An=parseInt(An)+Ar;}Am[An]=true;}this.props.selectedIndices=Am;}this.listadd("items",Ap,Aq);this._updateCommandEnabledUpDown();return Aq;};V.prototype.removeItems=function Ah(Am){var An=this.indexOfMultiple(Am,false);if(An&&An.foundCount){this.removeItemsAt(An&&An.indices);}};V.prototype.removeItemsAt=function n(Ao,An){if(!mstr.$A.len(Ao)){return ;}var Am=mstr.utils.Math.convertIndicesToRanges(Ao,An);this.removeItemsAtRanges(Am,true);};V.prototype.removeItemsAtRanges=function AO(An,Au){if(!mstr.utils.Hash.isEmpty(this.props.selectedIndices)){var Ax=Au?An:An.concat().sort(mstr.$A.rangeSorter);mstr.$H.remove(this.props.selectedIndices,mstr.utils.Hash.fromRanges(Ax));}var Ao=this.listremove("items",An,Au);if(!mstr.utils.Hash.isEmpty(this.props.selectedIndices)){var Av=mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(this.props.selectedIndices,true));var Az=mstr.$A.len(Av);for(var Ar=0,As=mstr.$A.len(Ao);Ar<As;Ar++){var Aq=Ao[Ar].min;var Aw=Ao[Ar].max;for(var Ay=Aw;Ay>=Aq;Ay--){for(var Ap=Az-1;Ap>-1;Ap--){if(Av[Ap]<Ay){break;}Av[Ap]--;}}}this.props.selectedIndices=mstr.$A.toHash(Av);}else{var Am=Math.max(Ao[0].min,0);var At=mstr.$A.len(this.props.items);if(At){this.execSingleSelect(Math.min(At-1,Am));}else{this._updateCommandEnabledUpDown();}}};V.prototype.execUp=function Ac(){var Ar=this.props.selectedIndices,An=mstr.utils.Math.convertIndicesToRanges(mstr.$A.fromHashKeys(Ar,true),false);var Ao,Aq;for(var Ap=0,Am=mstr.$A.len(An);Ap<Am;Ap++){Ao=An[Ap];if(Ao&&Ao.min&&(Ao.max>=Ao.min)){Aq=this.props.items[Ao.min-1];this.removeItemsAtRanges([{min:Ao.min-1,max:Ao.min-1}],true);this.insertItemsAt([Aq],Ao.max);Ar[Ao.min-1]=true;Ar[Ao.max]=false;}}this._updateCommandEnabledUpDown();return true;};V.prototype.execDown=function q(){var Ar=this.props.selectedIndices,An=mstr.utils.Math.convertIndicesToRanges(mstr.$A.fromHashKeys(Ar,true),false);var Ao,As=mstr.$A.len(this.props.items)-1,Aq;for(var Ap=0,Am=mstr.$A.len(An);Ap<Am;Ap++){Ao=An[Ap];if(Ao&&(Ao.max>-1)&&(Ao.max<As)){Aq=this.props.items[Ao.max+1];this.removeItemsAtRanges([{min:Ao.max+1,max:Ao.max+1}],true);this.insertItemsAt([Aq],Ao.min);Ar[Ao.min]=false;Ar[Ao.max+1]=true;}}this._updateCommandEnabledUpDown();return true;};V.prototype.on_hashadd_selectedIndices=V.prototype.on_hashremove_selectedIndices=function AX(Am){if(Am&&Am.src==this){this._updateCommandEnabledUpDown();}var Ao=mstr.utils.Arrays.fromHashKeys(Am.memo.at);this.props.selectedIndicesList=Ao.join(",");var An=this.props.selectedIndices;this.set("selectedCount",mstr.utils.Hash.len(An));};V.prototype.on_set_selectedIndicesList=function Ag(Am){this.execSelect(mstr.utils.Arrays.toHash(String(Am.memo.value).split(",")));};V.prototype._updateCommandEnabledUpDown=function a(){var Aq=this.props.selectedIndices,Ar=mstr.$A.len(this.props.items)-1,Ao;var Am=false,An=false;for(var Ap in Aq){Ao=parseInt(Ap);if(!Am){Am=Ao&&!Aq[Ao-1];}if(!An){An=(Ao<Ar)&&!Aq[Ao+1];}if(Am&&An){break;}}this.set("CommandEnabledUp",Am);this.set("CommandEnabledDown",An);};V.prototype.indexOfItem=function AV(An){var Am=this.props.valueForm;if(Am!=null&&!An.get){return mstr.$A.findByForm(this.props.items,An&&An[Am],Am);}else{return mstr.$A.find(this.props.items,An);}};V.prototype.indexOfValue=function AA(Ap){var Am=false,An,Ar,Aq;if(Ap instanceof Object){An=Ap.form||this.props.valueForm;Ar=Ap.value;Am=Ap.ignoreCase?true:false;}else{An=this.props.valueForm;Ar=Ap;}if(An!=null){var Ao=this.props.items;if(Ao&&Ao[0]&&Ao[0].get){return mstr.$A.findByGetter(this.props.items,"get",Ar,An);}else{return mstr.$A.findByForm(this.props.items,Ar,An,Am);}}return -1;};V.prototype.indexOfMultiple=function AH(An,Ao){var Am=this.props.valueForm;if(Am!=null){return mstr.$A.findByFormMultiple(this.props.items,An,Am,Ao);}else{return mstr.$A.findMultiple(this.props.items,An,Ao);}};V.prototype.getContainerTree=function E(){var Am=this.props.containerTree;if(!Am){Am=this.setContainerTree(this.props.container);}return Am;};V.prototype.setContainerTree=function F(Am){var An=new mstr.models.TreeModel({parent:this,valueForm:this.props.valueForm,scriptClass:"mstr.models.TreeModel"});mstr.controllers.Factory.add(An);if(Am){var Ao={value:Am};An.setRootNode(Ao);An.execCommand("SingleSelect",Ao);}this.props.containerTree=An;return An;};V.prototype.getContainer=function Aj(){var Am=this.getContainerTree();if(Am){return Am.getSelectedNode&&Am.getSelectedNode();}return null;};V.prototype.execBrowseListItem=function O(Am){if(Am&&Am.browseCommand&&Am.valueForm!=null){return this.execCommand(Am.browseCommand,Am.valueForm);}return false;};V.prototype.execBrowseFolder=function t(Ao){var Am,An;if(Ao&&Ao.dssid!=null){Am=Ao.dssid;An=Ao;}else{if(typeof (Ao)=="string"){Am=Ao;}}if(Am){return this.browseFolderBlock(Am,1,null,An);}return false;};V.prototype.browseFolderBlock=function AM(Ao,Ar,As,An,Ap){if(!Ar||Ar<0){return false;}if(!Ao&&!this.props.searchXML){return false;}var Am;if(!Ap){Ap={};}if(As!=null&&As!=""){Am=new mstr.http.MetadataSearchRequestInputs(Ao||"",Ar,(this.props.blockCount&&!this.props.blockCountAuto)?this.props.blockCount:mstr.utils.ListViewHelper.getFetchBlockForTask("searchMetadata"),this.props.totalSize||0,this.props.objectType,this.props.searchXML||"",As,this.props.dataSourcesXML);if(!Ap.commandId){Ap.commandId="Search";}Ap.searchPattern=As;Ap.item=An;var Aq=this.props.searchFlags;if(Aq&&(Aq&256)==0&&(Aq&1024)==0){Am.params.recursive=0;}}else{Am=new mstr.http.BrowseFolderRequestInputs(Ao||"",Ar,(this.props.blockCount&&!this.props.blockCountAuto)?this.props.blockCount:mstr.utils.ListViewHelper.getFetchBlockForTask("searchMetadata"),this.props.totalSize||0,this.props.hierarchical,this.props.objectType,this.props.searchXML||"",this.props.dataSourcesXML);if(!Ap.commandId){Ap.commandId="BrowseFolder";}if(this.props.styleName){Am.params.styleName=this.props.styleName;}Ap.item=An;}this.submitRequest(Am,Ap);return true;};V.prototype.canBrowseFolder=function Z(Am){if(Am){switch(parseInt(Am.tp)){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:return true;}}return false;};V.prototype.canBrowseHierarchy=function d(Am){return false;};V.prototype._loadResults=function X(Am){this.set("readyState",mstr.Enum.Widget.READYSTATE.SUCCESS);this.set("searchPattern",(Am&&Am.searchPattern)||"");this.set("totalSize",(Am&&Am.totalSize)||0);this.set("blockBegin",(Am&&Am.blockBegin)||1);this.set("blockCount",(Am&&Am.blockCount)||this.props.blockCount||1);this.set("leafElements",!!(Am&&Am.leafElements));this._appendBrowsedItemsToContainerTree((Am&&Am.browsedItems)||[],(Am&&Am.browsedItemsSiblings)||[]);this.set("rmc",(Am&&Am.rmc)||null);if(this.props.headerModel){this.updateHeaderModel();}var An=(Am&&Am.listItems)||[];if(this.props.prefixItems){An=An.concat(this.props.prefixItems);}this.setItems(An);this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};V.prototype.execBrowseContainerTreeNode=function AF(Ap){var Ao=Ap&&Ap.value;if(!Ao){return false;}switch(parseInt(Ao.tp)){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:return this.browseFolderBlock(Ao[this.props.valueForm],1,null,Ao,{commandId:"BrowseContainerTreeNode",node:Ap});default:if(mstr.utils.ListViewHelper.isWithinHierarchy(Ap)){if(this.isElementSearchRequired(Ap)){var Am=this.getContainerTree();if(Am){Am.removeAllChildNodes(Ap);Am.execSelect([Ap]);}this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:[],totalSize:0,blockBegin:1});return true;}else{var Aq=this.canAutoExpandOnDrill(),At=Ap;var An=At&&At.value;if(Aq&&An&&An.filters&&An.filters.length==1){if(!At.children||At.children.length==0){this._loadResults({browsedItems:[An.filters[0]],browsedItemsSiblings:[[An.filters[0]]],listItems:[],totalSize:0,blockBegin:1});}At=At.children[0];}return this.browseHierarchyBlock(this._buildHierarchyPathForNode(At),1,"",{commandId:"BrowseContainerTreeNode",node:At});}}else{if(this._isDummyNode(Ap)){var Ar=[];if(Ap.children){for(var As in Ap.children){if(Ap.children[As].value){Ar.push(Ap.children[As].value);}}}var Am=this.getContainerTree();if(Am){Am.removeAllChildNodes(Ap);Am.execSelect([Ap]);}this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:Ar,totalSize:0,blockBegin:1});return true;}}}return false;};V.prototype.execBrowseContainerParent=function x(){var Ao=this.getContainer();if(Ao&&Ao.parent){var An=this.canAutoExpandOnDrill&&this.canAutoExpandOnDrill(),Ap=Ao.parent;if(An&&mstr.utils.ListViewHelper.isWithinHierarchy(Ap)){var Am=Ap&&Ap.value;if(Am&&Am.filters&&Am.filters.length==1){Ap=Ap.parent||Ap;}}return this.execBrowseContainerTreeNode(Ap);}return false;};V.HIERARCHY_PATHDELIM="~";V.ELE_FILTER_ATT_DELIM=",";V.prototype._getNodeFromBrowsePath=function Ad(Am,An){while(Am){browsePathItem=Am.value;if(!browsePathItem){break;}tp=parseInt(browsePathItem.tp);if(tp==mstr.Enum.MSTRFolderItem.TYPE.PROJECT||tp==mstr.Enum.MSTRFolderItem.TYPE.FOLDER||tp==mstr.Enum.MSTRFolderItem.TYPE.DIMENSION){break;}if(browsePathItem[this.props.valueForm]==An){return Am;}Am=Am.parent;}return null;};V.prototype.execFetchBlock=function P(Am){if(!Am){return ;}return this.fetchBlock(Am,this.props.searchPattern);};V.prototype.execFetchData=function L(){if(this.shouldFetchData()){var Am=this.props.readyState;if(Am==null||Am==mstr.Enum.Widget.READYSTATE.IDLE){return this.execCommand("FetchFirst");}}return false;};V.prototype.shouldFetchData=function C(){if(this.props.totalSize==null){if(this.props.prefixItems){return(mstr.$A.len(this.props.items)-mstr.$A.len(this.props.prefixItems))<=0;}else{return !mstr.$A.len(this.props.items);}}return false;};V.prototype.fetchBlock=function AI(Am,An){var Ao=this.getContainer();if(!Ao){return false;}switch(Ao.value&&parseInt(Ao.value.tp)){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:return this.browseFolderBlock(Ao.value.dssid,Am,An,Ao.value);break;default:if(mstr.utils.ListViewHelper.isWithinHierarchy(Ao)){if(!An&&this.isElementSearchRequired(Ao)){this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:[],totalSize:0,blockBegin:1,searchPattern:An});return true;}else{return this.browseHierarchyBlock(this._buildHierarchyPathForNode(Ao),Am,An,{commandId:"BrowseContainerTreeNode",node:Ao,searchPattern:An});}}else{if(parseInt(Ao.value.tp)==mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE){if(!An&&this.isElementSearchRequired(Ao)){this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:[],totalSize:0,blockBegin:1,searchPattern:An});return true;}else{return this.browseAttributeBlock(Ao.value.dssid,Am,An);}}}break;}};V.prototype.execFetchFirst=function AE(){return this.execFetchBlock(1);};V.prototype.execFetchPrevious=function k(){return this.execFetchBlock(this._computePreviousBlockBegin());};V.prototype.execFetchNext=function w(){return this.execFetchBlock(this._computeNextBlockBegin());};V.prototype.execFetchLast=function l(){return this.execFetchBlock(this._computeLastBlockBegin());};V.prototype.queryEnabledFetchFirst=function G(){var Am=this.props.totalSize;var An=this.props.blockCount;return(Am>0)&&(An>0)&&(this.props.blockBegin>1);};V.prototype.queryEnabledFetchPrevious=function AP(){var Am=this.props.blockBegin;return(Am>1)&&(this._computePreviousBlockBegin()<Am);};V.prototype.queryEnabledFetchNext=function U(){return this._computeNextBlockBegin()>0;};V.prototype.queryEnabledFetchLast=function Q(){var Am=this.props.blockBegin;return Am>0&&(this._computeLastBlockBegin()>=Am+this.props.blockCount);};V.prototype._computePreviousBlockBegin=function r(){var Am=this.props.totalSize;var An=this.props.blockCount;if(Am>0&&An>0){return Math.max(1,this.props.blockBegin-An);}return -1;};V.prototype._computeNextBlockBegin=function R(){var Am=this.props.totalSize;var An=this.props.blockCount;if(Am>0&&An>0){if(this.props.blockBegin+An<=Am){return this.props.blockBegin+An;}}return -1;};V.prototype._computeLastBlockBegin=function u(){var Am=this.props.totalSize;var An=this.props.blockCount;if(Am>0&&An>0){var Ao=Am%An;if(Ao==0){Ao=An;}return Am-Ao+1;}return -1;};V.prototype.getFetchBlockModel=function Y(){var Ap=false;var Am=this.props.fetchBlockModel;if(Am){Ap=(Am.get("blockBegin")==this.props.blockBegin)&&(Am.get("totalSize")==this.props.totalSize);}if(!Ap){var Ao=parseInt(this.props.totalSize)||0;var An={min:Math.min(1,Ao),max:Ao,dataType:mstr.Enum.Nodes.DATATYPE.INTEGER,valueString:parseInt(this.props.blockBegin)||""};Am=new mstr.models.ConstantPromptAnswer(An);if(Am){mstr.controllers.Factory.add(Am);Am.init&&Am.init();this.props.fetchBlockModel=Am;}}return Am;};V.prototype.execSearch=function AU(Am){this.fetchBlock(1,Am);};V.prototype.on_set_readyState=function g(Am){if(Am&&Am.src==this){this._updateCommandEnabledSearch();this._updateCommandEnabledFetchBlock();this._updateCommandEnabledBrowseFolder();}};V.prototype._updateCommandEnabledSearch=function D(){var An=false;var Au=false;if(this.props.readyState==mstr.Enum.Widget.READYSTATE.IDLE){var At=this.getContainer(),Ap=At&&At.value,As=Ap&&parseInt(Ap.tp);switch(As){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:An=true;break;case mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE:var Aq=this.props.items,Am=this.props.prefixItems,Ar=Aq&&Aq[(Am?Am.length:0)];An=(!this.props.elementSearchDisabled)&&(!Ar||(parseInt(Ar.tp)==mstr.Enum.MSTRFolderItem.TYPE.ELEMENT));Au=An&&!this.props.matchCaseDisabled;break;case mstr.Enum.MSTRFolderItem.TYPE.FILTER:An=(At.readyState==null)||(At.readyState==mstr.Enum.Widget.READYSTATE.IDLE);An=An&&(!this.props.elementSearchDisabled);An=An&&mstr.utils.ListViewHelper.isWithinHierarchy(At);Au=An&&!this.props.matchCaseDisabled;break;}}else{if(this.props.readyState==mstr.Enum.Widget.READYSTATE.ERROR){var Ao=this.props.requestContext&&this.props.requestContext.memo&&this.props.requestContext.memo.searchPattern;if(Ao){An=true;}}}this.set("CommandEnabledSearch",An);this.set("searchMatchCaseAvailable",Au);};V.prototype._updateCommandEnabledBrowseFolder=function A(){var An=this.props.readyState,Ao=(An==mstr.Enum.Widget.READYSTATE.IDLE),Am=Ao||(An==mstr.Enum.Widget.READYSTATE.ERROR);this.set("CommandEnabledBrowseFolder",Ao);this.set("CommandEnabledBrowseContainerTreeNode",Am);var Ap=(Am&&this.getContainer())||null;this.set("CommandEnabledBrowseContainerParent",!!(Ap&&Ap.parent&&!(Ap.parent.parent==null&&this._isDummyNode(Ap.parent))));};V.prototype._updateCommandEnabledFetchBlock=function W(){var An=this.props.blockCount;var Am=this.props.totalSize;this.set("CommandEnabledFetchBlock",(this.props.readyState==mstr.Enum.Widget.READYSTATE.IDLE)&&(An>0)&&(Am>0)&&(An<Am));};V.prototype.loadRequestResponse=function I(){var Ar=this.props.requestContext;var A2=Ar&&Ar.response;if(!A2||!A2.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var A0=A2.data;this.set("searchPattern",Ar.memo&&Ar.memo.searchPattern);var Am;if(this.props.keepSelectionsAfterRequest){Am=this.getSelectedItems();if(!Am||!Am.length){Am=this.props.keptSelections;}this.props.keptSelections=null;}var As;switch(Ar.memo&&Ar.memo.commandId){case"BrowseForms":var Au=A0.getContainer();As=Au&&Au.value&&Au.value.dssforms;if(this.props.prefixItems){As=As?this.props.prefixItems.concat(As):this.props.prefixItems.concat();}var Az=mstr.$A.len(As);this.set("totalSize",Az);this.set("blockCount",0);this.set("blockBegin",Az?0:1);this.set("leafElements",false);this.setContainerTree(Au&&Au.value);this.setItems(As||[]);break;default:var A1=["totalSize","blockCount","blockBegin","leafElements"];for(var Ay=0;Ay<A1.length;Ay++){this.set(A1[Ay],A0.get(A1[Ay]));}switch(Ar.memo&&Ar.memo.commandId){case"BrowseHierarchyItem":this._appendBrowsedItemsToContainerTree(Ar.memo.items,Ar.memo.itemsSiblings);break;case"BrowseContainerTreeNode":var Ax=Ar.memo.node;if(Ax){var Aq=this.getContainerTree();if(Aq){Aq.execCommand("SingleSelect",Ax);var At=Ax.parent;var Ap=At&&At.children||[Ax];for(var Ay=0,Az=mstr.$A.len(Ap);Ay<Az;Ay++){Aq.removeAllChildNodes(Ap[Ay]);}}}break;default:if(this.props.keepFolders||(Ar.memo&&Ar.memo.commandId=="BrowseAttribute")){var An=Ar.memo.item;if(!An){var Aw=A0.getContainer();An=Aw&&Aw.value;}this._appendBrowsedItemsToContainerTree([An],[this.getItems()]);}else{var A3=A0.getContainerTree();var Av=this.getContainerTree();if(Av){var Ao=A3&&A3.getRootNode();if(Ao){Ao=mstr.utils.Trees.cloneSubTree(Ao);}Av.setRootNode(Ao);Av.setSelectedPaths(A3&&A3.getSelectedPaths());}}}As=A0.getItems()||[];this.setRMCModel(A0.props.rmc);if(this.props.headerModel){this.updateHeaderModel();}if(this.props.prefixItems){As=As?this.props.prefixItems.concat(As):this.props.prefixItems.concat();}this.setItems(As);}if(mstr.$A.len(Am)){this.setSelectedItems(Am);}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);this.raiseEvent("loadRequestResponse",null);};V.prototype._shouldKeepBrowsedItemSiblings=function AT(An,Am){if(!An||!Am){return null;}if(this.props.keepEntryPoints&&An.value&&(An.value.tp==mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY)){return mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE;}else{if(this.props.keepHierarchies&&(Am.tp==mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY)){return mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY;}else{if(this.props.keepFolders&&!An.parent&&(Am.tp==mstr.Enum.MSTRFolderItem.TYPE.FOLDER)){return mstr.Enum.MSTRFolderItem.TYPE.FOLDER;}}}return null;};V.prototype._isSingleFilterNode=function K(An){var Am=An&&An.value;if(Am&&(Am.stp==256||Am.tp==1)){var Ao=An.parent&&An.parent.value;if(Ao&&Ao.filters&&Ao.filters.length==1){return true;}}return false;};V.prototype._isDummyNode=function h(Am){return !(Am&&Am.value&&Am.value.tp&&(Am.value.tp>0));};V.prototype._appendBrowsedItemsToContainerTree=function AK(Au,Av){var Az=this.getContainerTree();if(!Az||!mstr.$A.len(Au)){return ;}var Ay=this.getContainer(),At=this.props.valueForm,A0,Aw,An,Ap,Ax,Ao;for(var Aq in Au){A0=Au[Aq];Aw=Av&&Av[Aq];if(!A0||!Ay){break;}if(Ay&&Ay.value&&Ay.value[At]==A0[At]){if(Ay.value.dssforms&&A0.dssforms){Ay.value.dssforms=A0.dssforms;}break;}Ap=[];Ax=null;var As=this._isDummyNode(Ay);if(As||(Ao=this._shouldKeepBrowsedItemSiblings(Ay,A0))){for(var Ar=0,Am=mstr.$A.len(Aw);Ar<Am;Ar++){if(As||(Aw[Ar]&&Aw[Ar]["tp"]==Ao)){Ap.push({value:Aw[Ar]});if(Aw[Ar][At]==A0[At]){Ax=Ap[Ap.length-1];}}}if(!Ax){Ax={value:A0};Ap.push(Ax);}}else{Ax={value:A0};Ap.push(Ax);}An=Az.getNodePath(Ay)+mstr.models.AbstractTreeBase.PATHDELIM+mstr.$A.len(Ay.children);Az.insertNodesAt(Ap,An);Az.execCommand("SingleSelect",Ax);Ay=Ax;}};V.prototype.getPropertyNameForForm=function M(Ao){if(Ao!=null){var An=this.getContainer();if(An&&An.value&&An.value.dssforms){var Am=mstr.$A.findByForm(An.value.dssforms,Ao,"dssid");if(Am>-1){return"form"+Am;}}}return null;};V.prototype.clone=function Af(){var An=mstr.$H.clone(this.props);An.items=[].concat(An.items);An.selectedIndices=mstr.$H.clone(An.selectedIndices);if(this.getContainer()){An.containerTree=this.getContainerTree()&&this.getContainerTree().clone();}else{An.containerTree=null;}An.container=null;An.id=mstr.controllers.Factory.nextFreeId();var Am=new V(An,false);if(this.props.headerModel){Am._initHeaderModel();}if(!Am){return ;}mstr.controllers.Factory.add(Am);Am.init&&Am.init();return Am;};V.prototype.init=function T(){mstr.models.BaseModel.prototype.init.apply(this);if(this.props.container||this.props.blockBegin){this._updateCommandEnabledBrowseFolder();this._updateCommandEnabledSearch();}if(this.props.autoSelectFirstItem&&!this.props.defaultSelection&&this.getSelectedIndex()==-1){this.execSelect({0:true});}};function V(Am,An){mstr.models.BaseModel.apply(this,[Am]);this.props.items=this.props.items||[];if(this.props.prefixItems&&(An!==false)){this.props.items=this.props.prefixItems.concat(this.props.items);}this.props.selectedIndices=this.props.selectedIndices||{};if(this.props.selectedIndicesList){var Ao=mstr.$A.toHash(this.props.selectedIndicesList.split(","));this.execSelect(Ao);}if(this.props.anchorIndex==null){this.props.anchorIndex=-1;}if(this.props.leadIndex==null){this.props.leadIndex=-1;}this._updateCommandEnabledFetchBlock();}return V;})();mstr.models.dnd={};mstr.models.dnd.DragZone=(function(){mstr.$O.extendsClass(G,mstr.models.BaseModel);G.prototype.init=function E(){mstr.controllers.EventManager.attachWindowEventListener(this,"mousedown","onmousedown");mstr.controllers.EventManager.attachWindowEventListener(this,"mouseup","onmouseup");mstr.utils.Hash.applydefault(this.props,{delay:200});};G.prototype.findTarget=function H(M,N){return null;};G.prototype.getDragData=function L(M,N){return{ddel:this.get("src").cloneNode(true)};};G.prototype.startDrag=function A(M){};G.prototype.drag=function K(N,M,O){};G.prototype.endDrag=function J(N,M,O){};G.prototype.onmousedown=function C(O){if(this.get("view").get("renderStatus")<3){return null;}var M=this.findTarget(this.get("view"),O);if(!M){return ;}var N=this;this.delayHandle=window.setTimeout(function(){N.initDrag(O,M);},this.get("delay"));};G.prototype.initDrag=function D(T,V){delete this.delayHandle;mstr.controllers.EventManager.attachWindowEventListener(this,"mousemove","onmousemove");this.set("dragging",true);this.set("src",V);var S=mstr.utils.BoxModel.getBox(V);this.set("xOffset",T.x-S.left);this.set("yOffset",T.y-S.top);var U=this.getDragData(this.get("view"),T);this.set("data",U);U.ddel.style.left="0";U.ddel.style.top="0";var N=this.get("el");if(!N){N=document.createElement("div");N.style.position="absolute";N.style.zIndex=10001;document.body.appendChild(N);this.set("el",N);}else{N.removeChild(N.firstChild);}N.appendChild(U.ddel);var P={};var Q=["x","y"];var M,O;for(var R=0;R<2;R++){M=Q[R];O=this.get(M+"Min");if(O||!isNaN(O)){P[M+"Min"]=(typeof (O)=="function")?O():O;}O=this.get(M+"Max");if(O||!isNaN(O)){P[M+"Max"]=(typeof (O)=="function")?O():O;}P[M]=(("xMin" in P)||("xMax" in P));}this.set("constraints",P);this.startDrag(this.get("view"));this.onmousemove(T);};G.prototype.onmousemove=function I(O){if(!this.get("dragging")){return ;}var M=O.x-this.get("xOffset");var Q=O.y-this.get("yOffset");var P=this.constrainXY(M,Q);var N=this.get("el");N.style.left=P.x+"px";N.style.top=P.y+"px";this.drag(this.get("view"),P.x,P.y);};G.prototype.onmouseup=function F(N){if(!this.get("dragging")){if(this.delayHandle){window.clearTimeout(this.delayHandle);delete this.delayHandle;}return ;}this.set("dragging",false);mstr.controllers.EventManager.detachWindowEventListener(this,"mousemove");var O=this.constrainXY(N.x-this.get("xOffset"),N.y-this.get("yOffset"));this.endDrag(this.get("view"),O.x,O.y);var M=this.get("el");M.style.top="-10000px";};G.prototype.constrainXY=function B(N,M){var O=this.get("constraints");if(O.x){if(!isNaN(O.xMin)){N=Math.max(N,O.xMin);}if(!isNaN(O.xMax)){N=Math.min(N,O.xMax);}}if(O.y){if(!isNaN(O.yMin)){M=Math.max(M,O.yMin);}if(!isNaN(O.yMax)){M=Math.min(M,O.yMax);}}return{x:N,y:M};};function G(N,M){mstr.models.BaseModel.apply(this,[N]);mstr.utils.Hash.overwrite(this,M);mstr.controllers.Factory.add(this);this.init();}return G;})();mstr.http.FrameProcessor=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.isHTTPProcessor=true;B.prototype.setInputs=function C(J){this.props.inputs=J;this.props.readyState=mstr.Enum.Widget.READYSTATE.IDLE;this.props.response=null;};B.prototype.submit=function A(){var K=this.props.inputs;if(!K){return ;}var O=K.htmlForm?K.htmlForm.ownerDocument:this.props.document;if(!O){return ;}var M=K.htmlForm;if(!M){M=O.createElement("form");O.body.appendChild(M);M.method="POST";}var J=this.props.taskURL;J=microstrategy.addJSessionID(J);M.action=J;M.target=this.props.frameName;M.appendChild(this._getHiddenInput(O,"taskEnv","juil_iframe",Q));var N;var Q=(K.htmlForm)?[]:null;for(var P in K.params){M.appendChild(this._getHiddenInput(O,P,K.params[P],Q));}M.appendChild(this._getHiddenInput(O,"_xts_",new Date().getTime(),Q));for(var L in microstrategy.persistParams){M.appendChild(this._getHiddenInput(O,L,microstrategy.persistParams[L],Q));}this.props.cancelled=false;this.props.readyState=mstr.Enum.Widget.READYSTATE.WAITING;this.props.lastSubmit=new Date();if(parseInt(this.props.timeout)){this.props.timeoutId=self.setTimeout('mstr.$obj("'+this.getId()+'").timeout()',parseInt(this.props.timeout));}M.submit();if(Q){while(N=Q.pop()){M.removeChild(N);}}};B.prototype._getHiddenInput=function G(L,N,J,M){var K=L.createElement("input");K.type="hidden";K.name=N;K.value=J;if(M){M.push(K);}return K;};B.prototype.timeout=function H(){this._clearTimeout();if(this.props.readyState==mstr.Enum.Widget.READYSTATE.WAITING){this.set("readyState",mstr.Enum.Widget.READYSTATE.TIMEOUT);}};B.prototype.cancel=function D(){this._clearTimeout();if(this.props.readyState==mstr.Enum.Widget.READYSTATE.WAITING){this.props.cancelled=true;this.set("readyState",mstr.Enum.Widget.READYSTATE.CANCELLED);}};B.prototype.update=function F(J){this._clearTimeout();var K=this.props.response=J&&J.mstrResponse;if(J){J.mstrResponse=null;}if(parseInt(K&&K.statusCode)==200){this.props.lastSuccess=new Date();this.set("readyState",mstr.Enum.Widget.READYSTATE.SUCCESS);}else{this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);}};B.prototype.getResponse=function I(){return this.props.response;};B.prototype._clearTimeout=function E(){var J=this.props.timeoutId;if(J){self.clearTimeout(J);this.props.timeoutId=null;}};function B(J){mstr.models.BaseModel.apply(this,[J]);}return B;})();mstr.http.BrowseFolderRequestInputs=(function(){function A(D,E,G,C,B,H,F,I){this.url="../servlet/taskProc";this.params={taskId:"searchMetadata",rootFolderID:D,blockBegin:E,blockCount:G,recursive:B?0:(F?"":1),folderBrowserStyle:B?1:0,includeAncestorInfo:String(!!B),searchXML:F,dataSourcesXML:I||"",objectType:H};}return A;})();mstr.http.MetadataSearchRequestInputs=(function(){function A(C,D,G,B,H,F,E,I){this.params={taskId:"searchMetadata",rootFolderID:C,searchPattern:E,nameWildcards:1,blockBegin:D,blockCount:G,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",searchXML:F,dataSourcesXML:I||"",objectType:H};}return A;})();mstr.views={};mstr.views.IView={get:null,set:null,getModel:null,setModel:null,render:null,update:null};mstr.views.BaseView=(function(){mstr.$O.extendsClass(BV,mstr.models.BaseModel);BV.prototype.DEFAULTS={visible:true,enabled:true,renderStatus:mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED,validationStatus:{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:false}};BV.prototype.getModel=function BV_getModel(){return this.props.model;};BV.prototype.setModel=function BV_setModel(m){if(m==this.props.model){return false;}if(this.props.model){this._detachLayoutHandlers();}this.props.model=m;this._modelDirty=true;var names=this.props.modelPushedProps;var arr=names&&names.split&&names.split(",");for(var i=0,len=arr&&arr.length||0;i<len;i++){var p=arr[i];var overwrite=(p.indexOf("!")==0);if(overwrite){p=p.substr(1);}if(!(p in m.props)){continue;}this["set_"+p]=function(evt){var p1=evt.name.substring(4,evt.name.length);var m1=evt.originalSrc;this.setPropertyByPath(p1.replace("|","/"),m1&&m1.props[p1],false);};m.attachEventListener(this,"set_"+p,"set_"+p);if(overwrite||mstr.controllers.Factory.getPath(p.replace("|","/"),this)==null){this.setPropertyByPath(p.replace("|","/"),m&&m.props[p],true);if(m.props[p] instanceof mstr.models.BaseModel){m.props[p].set("parent",this);}}}if(this.props.cmds){this._refreshCommandHandlers();}this._refreshChildViewModels();if(this._shouldAutoRender()){this.render();}return true;};BV.prototype.initModel=function BV_initModel(){var p=this.props.modelPath;if(p!=null){this.setModel(mstr.controllers.Factory.getPath(p,this));}};BV.prototype.initValidator=function BV_initValidator(){var p=this.props.validator;if(p!=null){var obj=p[mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(p,this.props[mstr.$W.DOCUMENT]);if(obj){this.props.validator=obj;var zz=obj.props&&(obj.props[mstr.$W.PARENT]=this);zz=obj.init&&obj.init();}}};BV.prototype.execResetValidationStatus=function BV_execResetValidationStatus(){var vs=this.get("validationStatus");if(vs.statusCode!=mstr.Enum.Validation.STATUSCODE.VALID){this.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});this.updateAllProps();}};BV.prototype.execCheckValidationStatus=function FE_execCheckValidationStatus(){return !(this.get("validationStatus").statusCode>mstr.Enum.Validation.STATUSCODE.VALID);};BV.prototype.after_set_validationStatus=function BV_after_set_validationStatus(){var vs=this.get("validationStatus");if(vs.bubble){this.raiseEvent("set_childValidationStatus",{id:this.getId(),code:vs.statusCode},true);}};BV.prototype._refreshChildViewModels=function BV_refCVM(cascade){for(var i=0,len=mstr.$A.len(this._childViewsInstantiated);i<len;i++){var child=this._childViewsInstantiated[i];var p=child&&child.props&&child.props.modelPath;if(p&&(p.substring(0,7)=="parent/")){child.initModel&&child.initModel();}var cmds=child.props.cmdArray;for(var j=0,lenCmds=mstr.$A.len(cmds);j<lenCmds;j++){if(cmds[j]&&cmds[j].targetPath&&(cmds[j].targetPath.substring(0,7)=="parent/")){child._refreshCommandHandlers();break;}}if(cascade){child._refreshChildViewModels(cascade);}}};BV.prototype.getLayoutXML=function BV_getLayoutXML(){return this._layoutXML;};BV.prototype.setLayoutXML=function BV_setLayoutXML(sXML){if(sXML==this._layoutXML){return false;}if(this._layoutXML){this._detachLayoutHandlers();}this._layoutXML=sXML;this._layoutDirty=true;if(this._shouldAutoRender()){this.render();}};BV.prototype.initLayoutXML=function BV_initLayoutXML(){var c=this.props[mstr.$W.LAYOUTCLASS];if(c){c=c.replace(/\@[^:]*:/g,"");this.props[mstr.$W.LAYOUTCLASS]=c;}c&&this.setLayoutXML(eval(c));};BV.prototype.render=function BV_render(){if(!mstr.timers.renderStart){mstr.timers.renderStart=new Date();}var LR=mstr.utils.LayoutRenderer;var result=LR.render(this.props,this._layoutXML);var elNew=result&&result.el&&result.el.childNodes&&result.el.childNodes[0];if(!elNew){return ;}elNew.style.display="none";var curElement=this.props[mstr.$W.ELEMENT];if(this.get("preserveDOMNode")&&this.get("parent")==null){mstr.$D.insertNode(elNew,curElement.parentNode,curElement);}else{mstr.$D.replaceNode(curElement,elNew);}this.props[mstr.$W.ELEMENT]=elNew;this.props[mstr.$W.RENDERSTATUS]=result.renderStatus;this._layoutHandlers=LR.getLayoutHandlers(this.props[mstr.$W.LAYOUTCLASS],this._layoutXML);this._layoutHandlers=LR.replaceLayoutHandlerTokens(this._layoutHandlers,this);this._attachLayoutHandlers();if(this.props.cmds){this._refreshCommandHandlers();}this._layoutDirty=false;this.updateAllProps();this._modelDirty=false;this.props.childViewPaths=result.childPaths;this.props.childViewRenderCounter=0;if(mstr.$A.len(result.childPaths)){var p=parseInt(this.props.pauseBeforeRenderingChildren);if(p>0){window.setTimeout('mstr.$obj("'+this.getId()+'").renderNextChildView()',p);}else{this.renderNextChildView();}}else{this.props[mstr.$W.RENDERSTATUS]=mstr.Enum.Widget.RENDERSTATUS.RENDEREDCHILDREN;mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;}};BV.prototype._shouldAutoRender=function BV_shouldAutoRender(){var rs=this.props[mstr.$W.RENDERSTATUS];return(rs!=null&&rs!=mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED);};BV.prototype.renderNextChildView=function BV_renderNextChildView(){var paths=this.props.childViewPaths,unrenderedPaths={};if(paths){var childInfo;while(childInfo=paths.shift()){if(this.renderChildAt(childInfo.name,childInfo.id)){this.props.childViewRenderCounter++;if(this.props.childViewRenderCounter%mstr.views.BaseView.REPAINT_EVERY_CHILDCOUNT==0){window.setTimeout('mstr.$obj("'+this.getId()+'").renderNextChildView()',1);break;}}else{unrenderedPaths[childInfo.name]=childInfo;}}this.props.unrenderedChildViewPaths=unrenderedPaths;}if(!mstr.$A.len(paths)){this.props[mstr.$W.RENDERSTATUS]=mstr.Enum.Widget.RENDERSTATUS.RENDEREDCHILDREN;mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;this.execLayoutHandler("on_win_resize");}};BV.prototype.renderChildAt=function BV_renderChildAt(path,placeholderId){var child=mstr.controllers.Factory.getPath(path,this);if(!child){return false;}var doc=this.props[mstr.$W.DOCUMENT];var el=doc&&doc.getElementById(placeholderId);mstr.controllers.Factory.safeset(child,"document",doc);mstr.controllers.Factory.safeset(child,"element",el);mstr.controllers.Factory.safeset(child,"renderStatus",mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED);if((child.props&&child.props.visible==false)||child.visible==false){return false;}if(!child.getId){child[mstr.$W.PARENT]=this;child=mstr.controllers.Factory.registerElement(el,null,child);if(child){mstr.controllers.Factory.setPath(path,this,child,true);}this._childViewsInstantiated.push(child);}if(child&&child.render){child.render();return true;}return false;};BV.prototype._attachLayoutHandlers=function BV_attachLayoutHandlers(){var model=this.props.model;var handlers=this._layoutHandlers&&this._layoutHandlers.info;if(handlers&&model&&model.attachEventListener){for(var n in handlers){switch(handlers[n].src){case"model":model.attachEventListener(this,handlers[n].eventName,"update");break;case"win":mstr.controllers.EventManager.attachWindowEventListener(this,handlers[n].eventName,"update");break;default:if(handlers[n]&&handlers[n].src&&handlers[n].src.substr(0,5)=="model"){var paths=handlers[n].src.split(".");var temp=model;for(var i=1;i<paths.length;i++){temp=temp.get(paths[i]);}temp.attachEventListener(this,handlers[n].eventName,"update");break;}}}}this._attachPropertiesHandlers(["enabled","visible"]);};BV.prototype._attachPropertiesHandlers=function BV_attachPropertiesHandlers(ps){var path,pathParts,obj,field,callbackName;for(var i=0,len=ps.length;i<len;i++){path=this.props[ps[i]+"Field"];if(path==null||path==""){continue;}callbackName="on"+ps[i]+"FieldValueChange";if(!this[callbackName]){continue;}if(path.charAt(0)=="!"){path=path.substring(1);}pathParts=path.split(mstr.controllers.Factory.PATHDELIM);field=pathParts.pop();var valueIndex=field.indexOf(":");if(valueIndex>-1){var valueParts=field.split(":");field=valueParts[0];this.props[ps[i]+"SourceFieldValues"]=valueParts[1].split(",");}this.props[ps[i]+"SourceField"]=field;path=pathParts.join(mstr.controllers.Factory.PATHDELIM);this.props[ps[i]+"Source"]=obj=path.length?mstr.$path(path,this):this;if(obj instanceof mstr.models.ListModel&&field=="selectedIndices"){obj&&obj.attachEventListener&&obj.attachEventListener(this,"hashadd_"+field,callbackName);}else{obj&&obj.attachEventListener&&obj.attachEventListener(this,"set_"+field,callbackName);}if(obj){this[callbackName]({memo:{value:obj.get(field)}});}}};BV.prototype._detachLayoutHandlers=function BV_detachLayoutHandlers(){var model=this.props.model;var handlers=this._layoutHandlers&&this._layoutHandlers.info;if(handlers&&model&&model.detachEventListener){for(var n in handlers){switch(handlers[n].src){case"model":model.detachEventListener(this,handlers[n].eventName);break;case"win":mstr.controllers.EventManager.detachWindowEventListener(this,handlers[n].eventName);}}}this._detachPropertiesHandlers(["enabled","visible"]);};BV.prototype._detachPropertiesHandlers=function BV_detachPropertiesHandlers(ps){var obj,field;for(var i=0,len=ps.length;i<len;i++){obj=this.props[ps[i]+"Source"];field=this.props[ps[i]+"SourceField"];obj&&obj.detachEventListener&&obj.detachEventListener(this,"set_"+field);}};BV.prototype.onenabledFieldValueChange=function BV_onEnabledFieldValueChange(evt){var fieldValue=this.extractEventSourceFieldValue("enabled",evt);var fieldPath=this.props.enabledField;if(fieldPath&&fieldPath.charAt(0)=="!"){fieldValue=!fieldValue;}this.set("enabled",fieldValue);};BV.prototype.onvisibleFieldValueChange=function BV_onVisibleFieldValueChange(evt){var fieldValue=this.extractEventSourceFieldValue("visible",evt);fieldPath=this.props.visibleField;if(fieldPath&&fieldPath.charAt(0)=="!"){fieldValue=!fieldValue;}this.set("visible",fieldValue);};BV.prototype.extractEventSourceFieldValue=function BV_extractEventSourceFieldValue(name,evt){if(!this.props[name+"SourceFieldValues"]){return !!evt&&evt.memo&&evt.memo.value;}else{var src=this.props[name+"Source"];if(src instanceof mstr.models.ListModel){var hash=src&&src.get(this.props[name+"SourceField"]);if(hash){var testValues=this.props[name+"SourceFieldValues"];if(typeof (hash)=="object"){for(var i=0,cnt=testValues.length;i<cnt;i++){if(testValues[i] in hash){return true;}}}else{for(var i=0,cnt=testValues.length;i<cnt;i++){if(testValues[i]==hash){return true;}}}}}else{return !evt&&evt.memo&&evt.memo.value&&evt.memo.value==this.props[name+"SourceFieldValues"];}}return false;};BV.prototype._refreshCommandHandlers=function BV_refreshCommandHandlers(){var cmds=this.props.cmdArray;if(!cmds){cmds=this.props.cmdArray=this._initCommands(this.props.cmds);}if(this.props.enabledField!=undefined){return ;}if(!cmds||!cmds.length){return ;}var bAnyCommandEnabled=false;var bRequiredCommandsEnabled=true;for(var i=0,len=cmds.length;i<len;i++){if(!cmds[i].id){continue;}var cmdId=cmds[i].id;var attachedTarget=cmds[i].target;var target=cmds[i].targetPath?mstr.$path(cmds[i].targetPath,this):this;if(target!=attachedTarget){attachedTarget&&attachedTarget.detachEventListener&&attachedTarget.detachEventListener(this,"set_CommandEnabled"+cmdId);target&&target.attachEventListener&&target.attachEventListener(this,"set_CommandEnabled"+cmdId,"updateCommandEnabled");cmds[i].target=attachedTarget=(target&&target.execCommand)?target:null;}var v=cmds[i].valuePath;v=(v&&!/^prompt\(/.test(v))?mstr.controllers.Factory.resolveArgsString(v,this):null;cmds[i].enabled=((attachedTarget&&attachedTarget.queryCommandEnabled&&attachedTarget.queryCommandEnabled(cmdId,v))||cmdId.substr(0,4)=="Set_"||false);if(!bAnyCommandEnabled){bAnyCommandEnabled=cmds[i].enabled;}if(bRequiredCommandsEnabled&&cmds[i].required&&!cmds[i].enabled){bRequiredCommandsEnabled=false;}}this.set("enabled",bRequiredCommandsEnabled&&bAnyCommandEnabled);};BV.prototype.updateCommandEnabled=function BV_updateCmdEnabled(evt){var id=String(evt&&evt.name).substr(18);if(!id){return ;}var cmds=this.props.cmdArray;var index=mstr.$A.findByForm(cmds,id,"id");if(index>-1){var v=cmds[index].valuePath;v=v?mstr.controllers.Factory.resolveArgsString(v,this):null;var en=!!(evt.src&&evt.src.queryCommandEnabled&&evt.src.queryCommandEnabled(id,v));var bChanged=(!!cmds[index].enabled!=!!en);if(bChanged){cmds[index].enabled=!!en;var bViewEnabled=!!en;if(!bViewEnabled){var i=mstr.$A.findByForm(cmds,"enabled",true);if(i>-1){bViewEnabled=true;}}this.set("enabled",bViewEnabled);}}};BV.prototype.execFireCommands=function BV_execFireCmds(defaultCmdValue){return this.fireCommands(null,defaultCmdValue);};BV.prototype.fireCommands=function CV_fireCommands(cmdsString,defaultCmdValue){var cmds;if(cmdsString){cmds=this._initCommands(cmdsString);}else{cmds=this.props.cmdArray;}for(var i=0,len=mstr.$A.len(cmds);i<len;i++){var cmdReturnValue=false;var t=cmds[i].target;if(!t){t=cmds[i].targetPath?mstr.$path(cmds[i].targetPath,this):this;}if(t&&t.execCommand){var v=cmds[i].valuePath;v=v?mstr.controllers.Factory.resolveArgsString(v,this):null;if(v==null){v=[defaultCmdValue];}cmdReturnValue=t.execCommand.apply(t,[cmds[i].id].concat(v));}if(!cmdReturnValue&&cmds[i].required){break;}}return true;};BV.prototype._initCommands=function BV_initCommands(s){if(!s){return ;}s=(s&&s.split)?s.split(";"):[s];var len=s.length;if(len){var arr=[];for(var i=0;i<len;i++){var parts=(s[i]&&s[i].split)?s[i].split("|"):[s[i]];if(parts[0]){var bRequired=(String(parts[0]).charAt(0)=="!");if(bRequired){parts[0]=String(parts[0]).substr(1);}arr.push({id:parts[0],valuePath:parts[1],targetPath:parts[2],required:bRequired});}}return arr;}return null;};BV.prototype.computeHandlerNameForEvent=function BV_compHNforEvent(evt){if(evt.src==this.props.model){return"on_model_"+evt.name;}else{if(evt.src==this.props.document){return"on_win_"+evt.name;}else{return"on_"+evt.name;}}};BV.prototype.searchHandlerByEventName=function BV_searchHandlerByEventName(evt){if(this._layoutHandlers&&this._layoutHandlers.info){for(var n in this._layoutHandlers.info){if(this._layoutHandlers.info[n].eventName==evt.name){return this._layoutHandlers.info[n];}}}return null;};BV.prototype.update=function BV_update(evt){if(evt){var hName=this.computeHandlerNameForEvent(evt);var hInfo=this._layoutHandlers&&this._layoutHandlers.info&&this._layoutHandlers.info[hName];if(!hInfo){hInfo=this.searchHandlerByEventName(evt);if(hInfo){hName=hInfo.name;}}switch(hInfo&&hInfo.method){case"listadd":var range={min:evt.memo.start,max:evt.memo.start+evt.memo.count-1};this._updateListPropIteratively(hName,hInfo,[range]);break;case"listremove":this._updateListPropIteratively(hName,hInfo,evt.memo.ranges);break;case"hashadd":case"hashremove":this._updateHashPropIteratively(hName,hInfo,evt.memo.at);break;default:return this.execLayoutHandler(hName);}}};BV.prototype.updateAllProps=function BV_updateAllProps(){if(!this._layoutHandlers){return ;}var names=this._layoutHandlers.sequence;var infos=this._layoutHandlers.info;var v=this,m=this.props.model,el=this.props.element;for(var i=0,len=mstr.$A.len(names);i<len;i++){var hName=names[i];var hInfo=infos[hName];switch(hInfo&&hInfo.method){case"set":case"win":case null:case undefined:var h=this._validateLayoutHandlerFunction(hInfo);if(h){var retVal=h(v,m,el,{init:true});if(hName&&!hName.match(/^on\_/)){this.props[hName]=retVal;}}break;case"listadd":var src=(hInfo.src=="model")?m:v;if(src){var vals=(src==v)?src.props[hInfo.prop]:src.get&&src.get(hInfo.prop);var len=mstr.$A.len(vals);if(len){var range={min:0,max:len-1};this._updateListPropIteratively(hName,hInfo,[range]);}}break;case"hashadd":var src=(hInfo.src=="model")?m:v;if(src){var keys=(src==v)?src.props[hInfo.prop]:src.get&&src.get(hInfo.prop);this._updateHashPropIteratively(hName,hInfo,keys);}break;}}};BV.prototype.execLayoutHandler=function BV_execLH(hName,index){var hInfo=this._layoutHandlers&&this._layoutHandlers.info&&this._layoutHandlers.info[hName];var h=this._validateLayoutHandlerFunction(hInfo);return h&&h(this,this.props.model,this.props[mstr.$W.ELEMENT],index);};BV.prototype._updateHashPropIteratively=function BV_updateHashPropIteratively(hName,hInfo,keys){var h=this._validateLayoutHandlerFunction(hInfo);if(!h){return ;}var v=this;var m=this.props.model;var el=this.props[mstr.$W.ELEMENT];for(var key in keys){h(v,m,el,key);}};BV.prototype._updateListPropIteratively=function BV_updateListPropIteratively(hName,hInfo,ranges){var h=this._validateLayoutHandlerFunction(hInfo);if(!h){return ;}var v=this;var m=this.props.model;var el=this.props[mstr.$W.ELEMENT];for(var i=0,len=mstr.$A.len(ranges);i<len;i++){var min=ranges[i].min;var max=ranges[i].max;for(var index=min;index<=max;index++){h(v,m,el,index);}}};BV.prototype.raiseEvent=function BV_raiseEvent(name,memo,bubble){if(name){var evt=new mstr.lang.CustomEvent(this,name,memo);if(this["before_"+name]){this["before_"+name](evt);}this.update(evt);if(this["after_"+name]){this["after_"+name](evt);}this.notifyListeners(evt);if(bubble){var zz=this.get("parent")&&this.get("parent").raiseEvent&&this.get("parent").raiseEvent(name,memo,bubble);}}};BV.prototype._validateLayoutHandlerFunction=function BV_validLHF(hInfo){if(hInfo){if(!hInfo.func&&hInfo.str){hInfo.func=new Function("view, model, rootTag, context",hInfo.str);hInfo.str=null;}return hInfo.func;}return null;};BV.prototype.execHide=function BV_execHide(){this.set("visible",false);return true;};BV.prototype.execShow=function BV_execShow(){this.set("visible",true);return true;};BV.prototype.execHideChild=function BV_execHideChild(path){if(path){mstr.controllers.Factory.setPath(path+"/visible",this,false,false);}};BV.prototype.execShowChild=function BV_execShowChild(path){return this._showChildViewAtPath(path);};BV.prototype._showChildViewAtPath=function BV_showChildViewAtPath(childPath){var childView=mstr.controllers.Factory.getPath(childPath,this);if(childView){mstr.controllers.Factory.safeset(childView,"visible",true);if((this.props.renderStatus==mstr.Enum.Widget.RENDERSTATUS.RENDEREDCHILDREN)&&(!childView.getId||(childView.props.renderStatus==mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED))){var childInfo=this.props.unrenderedChildViewPaths&&this.props.unrenderedChildViewPaths[childPath];if(childInfo&&childInfo.id!=null){this.renderChildAt(childPath,childInfo.id);childView=mstr.controllers.Factory.getPath(childPath,this);var m=childView&&childView.props.model;if(m){m.execCommand&&m.execCommand("FetchData");}}}}};BV.prototype.execOpenPopup=function BV_execOpenPopup(popupInfo){self.supressWaitPage=true;try{if(popupInfo){if(typeof (popupInfo)=="string"){popupInfo={popup:mstr.$obj(popupInfo)};}else{if(popupInfo.popup==null){popupInfo={popup:popupInfo};}}}var popup=popupInfo&&popupInfo.popup;if(!popup&&this.props.popupId){popup=mstr.$obj(this.props.popupId);}var useDefault=!popup||!popup.getId;if(useDefault){popup=this.props.popup;}if(!popup){return ;}var p=this.props.currentPopUp;if(p){this.execClosePopup();}if(!popup.getId){if(useDefault){popup[mstr.$W.PARENT]=this;}popup=mstr.controllers.Factory.registerJSON(popup,this.props.document);popup&&popup.init&&popup.init();if(useDefault){this.props.popup=popup;popup&&this._childViewsInstantiated.push(popup);}}this.props.currentPopUp=popup;if(!popup){return ;}popup.attachEventListener(this,"Pop","onPop");if(popupInfo&&popupInfo.x!=null){popup.set("x",popupInfo.x);}if(popupInfo&&popupInfo.y!=null){popup.set("y",popupInfo.y);}popup.execCommand("Pop",this);}finally{window.setTimeout("self.supressWaitPage = false;",10);}};BV.prototype.onPop=function BV_onPop(evt){var p=this.props.currentPopUp;if(p!=(evt&&evt.src)){return ;}this.set("opened",true);p.detachEventListener(this,"Pop");p.attachEventListener(this,"Unpop","onUnpop");self.setTimeout("mstr.controllers.EventManager.attachWindowEventListener(mstr.$obj('"+this.props.id+"'),'mousedown','onMouseEvent')",1);var sc=this.getAncestorByProperty("isScrollProvider");if(sc){if(p.props.element.offsetParent!=sc.props.element){sc.attachEventListener(this,"sync_scroll","onSyncScroll");sc.props._initialScrollTop=sc.props.element.scrollTop;p.props._scrollProvider=sc;if(mstr.utils.ISWK){var docEl=document.documentElement,ov=docEl.style.overflow;docEl.style.overflow="hidden";window.setTimeout(function(){docEl.style.overflow=ov;},0);}}}};BV.prototype.onSyncScroll=function BV_onSyncScroll(evt){var popup=this.props.currentPopUp;if(popup){if(this._scTimer){window.clearTimeout(this._scTimer);}var opener=this.props.element;this._scTimer=window.setTimeout(function(){var popupProps=popup.props,sc=popupProps&&popupProps._scrollProvider;if(sc){var scProps=sc.props,scEl=scProps.element,scST=scEl.scrollTop,delta=scST-scProps._initialScrollTop;var el=popupProps.element;if(el){el.style.top=parseInt(el.style.top)-delta+"px";scProps._initialScrollTop=scEl.scrollTop;var scPos=mstr.utils.BoxModel.position(scEl),scBottom=scPos.top+scPos.height,openerPos=mstr.utils.BoxModel.position(opener),openerBottom=openerPos.top+openerPos.height;el.style.display=openerBottom>=scBottom?"none":"";if(mstr.utils.ISWK){var docEl=document.documentElement,ov=mstr.utils.CSS.getStyleValue(docEl,"overflow");docEl.style.overflow="hidden";window.setTimeout(function(){docEl.style.overflow=ov;},100);}}}},100);}};BV.prototype.onUnpop=function BV_onUnpop(evt){var p=this.props.currentPopUp;if(p!=(evt&&evt.src)){return ;}this.set("opened",false);p.detachEventListener(this,"Unpop");mstr.controllers.EventManager.detachWindowEventListener(this,"mousedown");mstr.controllers.EventManager.detachWindowEventListener(this,"mouseup");this.props.currentPopUp=null;};BV.prototype.onMouseEvent=function BV_onMouseEvent(evt){var p=this.props.currentPopUp;if(!p){return ;}var elTarget=evt&&evt.target();if(!mstr.utils.Dom.containsElement(p.props.element,elTarget,true)&&(!mstr.utils.Dom.containsElement(this.props.element,elTarget,true)||this.props.popupPolicy=="toggle")){var viewId=elTarget&&elTarget.mstrViewId,view=viewId&&mstr.$obj(viewId);if(!p.isAncestorOf(view)){this.execClosePopup();}}};BV.prototype.isAncestorOf=function(view){var p=view;while(p){p=p&&p.props&&p.props.parent;if(p==this){return true;}}return false;};BV.prototype.execClosePopup=function BV_execClosePopup(){var p=this.props.currentPopUp;if(p){p.execCommand("Unpop");}};BV.prototype.execPop=function BV_execPop(opener){if(!opener){return ;}this.props.opener=opener;this.set("visible",false);if(!this.props.element){var doc=opener.props.document||document;this.props.element=doc.createElement("span");}var el=this.props.element;var elOpener=opener.props.element;if(elOpener&&elOpener.parentNode){if(el.parentNode){el.parentNode.removeChild(el);}var elNextSibling=elOpener.nextSibling;if(elNextSibling){elOpener.parentNode.insertBefore(el,elNextSibling);}else{elOpener.parentNode.appendChild(el);}}var m=mstr.$path(this.props.modelPath,this);if(m!=this.getModel()){this.setModel(m);}this.render();this._positionPop();this.set("visible",true);this.raiseEvent("Pop");};BV.prototype._positionPop=function BV_positionPop(){this._prePositionPop();var coords=this._computeNewClientCoords();var BM=mstr.utils.BoxModel,mySize=this._getMySize(),bAllowNudge=(this.props.popOrientation!=mstr.Enum.Widget.POPORIENTATION.VERTICAL);if(bAllowNudge||this.props.nudge){coords.width=mySize.width;coords.height=mySize.height;coords=BM.fitRectWithinRect(coords,BM.getBrowserWindowRect(this.props.element.ownerDocument));}var elOffsetParent=this.props.element.offsetParent,offsetScrollLeft=0,offsetScrollTop=0;if(elOffsetParent){offsetScrollLeft=+elOffsetParent.scrollLeft;offsetScrollTop=+elOffsetParent.scrollTop;}BM.setClientCoords(this.props.element,coords.left+offsetScrollLeft,coords.top+offsetScrollTop);this._postPositionPop(mySize.width,mySize.height);};BV.prototype._prePositionPop=function BV_prePositionPop(){var el=this.props.element,s=el&&el.style;if(!s){return ;}el.className=el.className.replace(/ mstrAsPopup/,"")+" mstrAsPopup";s.visibility="hidden";s.position="absolute";s.zIndex=999;s.display=(el.tagName&&el.tagName.toLowerCase()=="table"&&mstr.utils.ISW3C)?"table":"block";};BV.prototype._postPositionPop=function BV_postPositionPop(width,height){var el=this.props.element,s=el&&el.style;if(!s){return ;}s.display="none";s.visibility="visible";if(mstr.utils.ISIE6){var popupMask=microstrategy.getPopupMask(el),pms=popupMask&&popupMask.style;if(pms){popupMask.className="popupMask_"+el.id;pms.left=s.left;pms.top=s.top;pms.width=width+"px";pms.height=height+"px";pms.zIndex=s.zIndex-1;}}};BV.prototype._getMySize=function BV_getMySize(){var ps=this.props,w=ps.width,h=ps.height,el=ps.element,BM=mstr.utils.BoxModel;if(w&&w.match(/px$/)){w=parseInt(w);}else{w=BM.getElementOuterWidth(el)||BM.getElementOuterWidth(el.firstChild);}if(h&&h.match(/px$/)){h=parseInt(h);}else{h=BM.getElementOuterHeight(el)||BM.getElementOuterHeight(el.firstChild);}return{width:w,height:h};};BV.prototype._computeNewClientCoords=function BV_ccc(){return(this.props.popOrientation==mstr.Enum.Widget.POPORIENTATION.VERTICAL)?this._computeNewClientCoordsAsDropdown():this._computeNewClientCoordsAsCtxtMenu();};BV.prototype._computeNewClientCoordsAsDropdown=function BV_cmpClientAsDD(){var elOpener=this._getOpenerArea();var coords=mstr.utils.BoxModel.getClientCoords(elOpener);coords.top+=elOpener.offsetHeight;return coords;};BV.prototype._computeNewClientCoordsAsCtxtMenu=function BV_cmpClientAsCM(){if(!isNaN(parseInt(this.props.x))&&!isNaN(parseInt(this.props.y))){var el=this.props.element,doc=el&&el.ownerDocument,de=doc&&doc.documentElement;return{left:parseInt(this.props.x)-(de&&de.scrollLeft||0),top:parseInt(this.props.y)-(de&&de.scrollTop||0)};}else{return mstr.utils.BoxModel.getClientCoords(this._getOpenerArea());}};BV.prototype._getOpenerArea=function BV_getOpenerArea(){var opener=this.get("opener"),elOpener=opener&&(opener.execLayoutHandler("openerArea")||opener.get("element"));return elOpener;};BV.prototype.execUnpop=function BV_execUnpop(){if(mstr.utils.ISIE4){microstrategy.releasePopupMask(this.props.element);}this.set("visible",false);this.props.opener=null;this.raiseEvent("Unpop");};BV.prototype.execConfirm=function BV_execConfirm(msg){if(!msg){return false;}return window.confirm(msg);};BV.prototype.prompt=function BV_prompt(msg,defV){if(!msg){return null;}return window.prompt(msg,(defV?defV:""));};BV.prototype.init=function BV_init(){this.initLayoutXML();this.initModel();this.initValidator();};function BV(props){this.props=mstr.utils.Hash.applydefault(props,this.DEFAULTS);this._childViewsInstantiated=[];}return BV;})();mstr.views.Editor=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.execApply=function A(E){this.raiseEvent("apply",{value:E});};B.prototype.execSave=function D(E){this.raiseEvent("save",{value:E});};B.prototype.queryEnabledApply=function C(){return true;};B.prototype.queryEnabledApply=function C(){return false;};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.TextInput=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.shouldWriteBack=function A(F){F=String(F).toLowerCase();var E=mstr.Enum.Widget.AUTOWRITEBACK;switch(parseInt(this.props.autoWriteBack)){case E.ONKEYPRESS:return !!F.match(/keypress|keydown|blur/i);case E.ONBLUR:return !!F.match(/blur/i);case E.OFF:return false;}return !!F.match(/keypress|keydown|blur/i);};B.prototype.getAutoValidate=function C(){var G=mstr.Enum.Widget.AUTOVALIDATE,F=parseInt(this.props.autoValidate);if(isNaN(F)){F=G.USEDEFAULT;}if(F==G.USEDEFAULT){var E=mstr.Enum.Prompts.VALIDATIONLEVEL;switch(mstr.Settings.Prompts.VALIDATIONLEVEL){case E.AFTERANSWEREACH:F=G.ONBLUR;break;case E.INMIDANSWEREACH:F=G.ONKEYPRESS;break;case E.OFF:case E.ATRUNREPORT:default:F=G.OFF;break;}}return F;};B.prototype.getAutoFormat=function D(){var G=mstr.Enum.Widget.AUTOFORMAT,F=parseInt(this.props.autoFormat);if(isNaN(F)){F=G.USEDEFAULT;}if(F==G.USEDEFAULT){var E=mstr.Enum.Prompts.AUTOFORMATLEVEL;switch(mstr.Settings.Prompts.AUTOFORMATLEVEL){case E.AFTERANSWEREACH:F=G.ONBLUR;break;case E.INMIDANSWEREACH:F=G.ONKEYPRESS;break;case E.OFF:case E.BEFORERUNREPORT:case E.AFTERRUNREPORT:default:F=G.OFF;break;}}return F;};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.ViewListBase=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype._attachLayoutHandlers=function C(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);var F=this.props.model;if(F&&F.attachEventListener){F.attachEventListener(this,"hashadd_selectedIndices","onAddSelections");F.attachEventListener(this,"hashremove_selectedIndices","onRemoveSelections");}};B.prototype._detachLayoutHandlers=function D(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);var F=this.props.model;if(F&&F.attachEventListener){F.detachEventListener(this,"hashadd_selectedIndices");F.detachEventListener(this,"hashremove_selectedIndices");}};B.prototype.initChildModelPaths=function E(){var G=this.props.views;var J="parent/model/items/";for(var H=0,F=mstr.$A.len(G);H<F;H++){var I=G[H];if(!I||((I.props&&I.props.modelPath)||(I.modelPath))){continue;}if(I.props){I.props.modelPath=J+H;}else{I.modelPath=J+H;}}};B.prototype.init=function A(){this.initChildModelPaths();mstr.views.BaseView.prototype.init.apply(this);};function B(F){mstr.views.BaseView.apply(this,[F]);}return B;})();mstr.views.ViewBook=(function(){mstr.$O.extendsClass(D,mstr.views.ViewListBase);D.prototype.init=function E(){mstr.views.ViewListBase.prototype.init.apply(this);var F=this.getModel();F.attachEventListener(this,"listadd_items","reRender");F.attachEventListener(this,"listremove_items","reRender");};D.prototype.reRender=function C(){if(this.props.renderStatus!=mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED){this.render();}};D.prototype.render=function B(){this._initChildViewList();mstr.views.ViewListBase.prototype.render.apply(this);};D.prototype._initChildViewList=function A(){var H="parent/model/items/";var N=this.props.views=[];var J=this.props.childViewTypes||this.props.parent.props.childViewTypes;var M=this.props.document,F=this.props.model,K=F&&F.getItems(),Q,L,O;for(var G=0,I=mstr.$A.len(K);G<I;G++){Q=K[G];L=(Q&&Q.get&&Q.get("type"))||"default";O=J&&(J[L]||J["default"]);if(!O){continue;}O=mstr.utils.Hash.deepClone(O);O.parent=this;O.modelPath=H+G;N[G]=mstr.controllers.Factory.registerJSON(O,M);if(N[G]&&N[G].init){N[G].init();}}};function D(F){mstr.views.ViewListBase.apply(this,[F]);}return D;})();mstr.views.ViewStack=(function(){mstr.$O.extendsClass(F,mstr.views.ViewListBase);F.prototype.setModel=function I(L){mstr.views.ViewListBase.prototype.setModel.apply(this,[L]);if(L){L.set("stack",true);}};F.prototype.onAddSelections=function K(L){var N=L&&L.memo&&L.memo.at;var M=parseInt(mstr.$H.firstKey(N));this._showChildViewAtIndex(M);this._updateNavCommands();};F.prototype._updateNavCommands=function E(){var M;var L=this.props.model;if(L){M=L.getSelectedIndex();}if(M==null){M=-1;}this.set("CommandEnabledPreviousView",M>0);this.set("CommandEnabledNextView",M<(mstr.$A.len(this.props.views)-1));};F.prototype.onRemoveSelections=function A(L){var N=L&&L.memo&&L.memo.at;var M=parseInt(mstr.$H.firstKey(N));if(M>-1){var O=this.props.views&&this.props.views[M];mstr.controllers.Factory.safeset(O,"visible",false);}};F.prototype.render=function J(){var N=this.props.views,M=mstr.$A.len(N),Q;for(var P=0;P<M;P++){mstr.controllers.Factory.safeset(N[P],"visible",false);mstr.controllers.Factory.safeset(N[P],"renderStatus",mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED);}mstr.views.BaseView.prototype.render.apply(this);var L=this.getModel();var O=L&&L.getSelectedIndex();this._showChildViewAtIndex(O);mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;};F.prototype.renderNextChildViewOld=function B(){var O=this.props.childViewPaths;if(O){var N=this.props.stackInfo={};var M;for(var L=O.length-1;L>-1;L--){M=O[L];if(M.name&&M.name.substring(0,6)=="views/"){N[M.name]=M;O.splice(L,1);}}}this.renderNextChildView=mstr.views.BaseView.prototype.renderNextChildView;this.renderNextChildView();};F.prototype.execPreviousView=function D(){var L=this.props.model;if(L){var M=L.getSelectedIndex();if(M>0){return this.execGotoView(M-1);}}return false;};F.prototype.execNextView=function G(){var L=this.props.model;if(L){var M=L.getSelectedIndex();if(M>-1){return this.execGotoView(M+1);}}return false;};F.prototype.execGotoView=function H(M){var L=this.props.model;if(L){if((M>-1)&&(M<mstr.$A.len(this.props.views))){return L.execCommand("SingleSelect",M);}}return false;};F.prototype._showChildViewAtIndex=function C(L){L=parseInt(L);if(L!=null&&L>-1){this._showChildViewAtPath("views/"+L);}};function F(L){mstr.views.ViewListBase.apply(this,[L]);this._updateNavCommands();}return F;})();mstr.views.Pulldown=(function(){mstr.$O.extendsClass(C,mstr.views.BaseView);C.prototype.render=function H(){mstr.views.BaseView.prototype.render.apply(this);if(!this.get("horizontalCaption")){var I=this.get("element");var J=I.getElementsByTagName("td");if(J.length>0){J[0].style.display="none";}}this.renderSelections();};C.prototype._attachLayoutHandlers=function G(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);var I=this.props.model;if(I&&I.attachEventListener){I.attachEventListener(this,"set_icon","set_buttonClass");I.attachEventListener(this,"set_showPressed","set_pressed");var J=this._getPropNameForSelections();if(J){I.attachEventListener(this,"hashadd_"+J,"renderSelections");I.attachEventListener(this,"hashremove_"+J,"renderSelections");}}};C.prototype.set_buttonClass=function A(I){this.set("buttonClass",I.memo.value);};C.prototype.set_pressed=function D(I){this.set("pressed",I.memo.value);};C.prototype._detachLayoutHandlers=function B(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);var I=this.props.model;if(I&&I.attachEventListener){var J=this._getPropNameForSelections();if(J){I.detachEventListener(this,"hashadd_"+J);I.detachEventListener(this,"hashremove_"+J);}}};C.prototype._getPropNameForSelections=function E(){var I=this.props.modelClass;if(/TreeModel/.test(I)){return"selections";}else{if(/ListModel/.test(I)){return"selectedIndices";}}return null;};C.prototype.renderSelections=function F(){var L=mstr.utils.ListViewHelper.getItemRenderer(this);if(!L){return ;}var I=this.props.model;var K=(this.props.popup&&(this.props.popup.singleFilterCssClass||this.props.popup.props&&this.props.popup.props.singleFilterCssClass))?(I&&I.getViewableSelectedItems&&I.getViewableSelectedItems()):(I&&I.getSelectedItems());var M=(this.props.showSingleItemListAsLabel&&(K&&mstr.$A.len(K)==1));var J;switch(mstr.$A.len(K)){case 1:J="renderListItem";break;case 0:J="renderEmpty";break;default:J="renderMultipleItems";break;}if(L[J]){L[J](this,I,this.props.element,{item:K&&K[0],items:K,showAsLabel:M});}};function C(I){mstr.views.BaseView.apply(this,[I]);}return C;})();mstr.views.FieldSet=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.onlegendFieldValueChange=function C(F){var G=this.get("element"),E=G.firstChild;if(F.memo.value){E.innerHTML=F.memo.value;}};B.prototype._attachLayoutHandlers=function D(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);mstr.views.BaseView.prototype._attachPropertiesHandlers.call(this,["legend"]);};B.prototype._detachLayoutHandlers=function A(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);mstr.views.BaseView.prototype._detachPropertiesHandlers.call(this,["legend"]);};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.ListView=(function(){mstr.$O.extendsClass(N,mstr.views.BaseView);N.prototype.render=function B(){mstr.views.BaseView.prototype.render.apply(this);var S=this.getModel();var R=mstr.$A.len(S&&S.getItems&&S.getItems());if(R){this.renderItemsAt(0,R);}this._updateEmptyMessage();mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;};N.prototype._updateEmptyMessage=function J(){var S=this.props.model,R=mstr.$A.len(S&&S.getItems&&S.getItems()),U=mstr.$A.len(S&&S.props&&S.props.prefixItems),W=this.props.descriptors,V=W&&W.searchRequiredText,T=W&&W.emptyText,X=S&&S.isElementSearchRequired&&S.isElementSearchRequired()&&!S.get("searchPattern");if(R>U||(!X&&R)){this._clearEmptyMessage();}else{msg=(X)?V:T;this.set("message",msg);}};N.prototype._clearEmptyMessage=function G(){var U=this.get("message"),T=this.props.descriptors,R=T&&T.emptyText,S=T&&T.searchRequiredText;switch(U){case R:case S:this.set("message",null);break;}};N.prototype.renderItemsAt=function P(R,Y){var e=mstr.utils.ListViewHelper.getItemRenderer(this);if(!e||!e.renderListItem){return null;}var h=this,S=this.getId(),V=this.props.model;var Z=V&&V.getItems();var T=(V&&V.getSelectedIndices())||{};var a=Math.min(R+Y,mstr.$A.len(Z));var W=this.props[mstr.$W.ELEMENT];var c=V&&V.get("valueForm"),g;for(var X=R;X<a;X++){var k=Z[X];var d=mstr.utils.ListViewHelper.getItemBrowseCommand(this,k)||"";var U=e.renderListItem(h,V,W,{at:X,item:k,browseCommand:d});if(U){if(T[X]){e.markListItemAsSelected(h,V,W,{at:X,item:k,elItem:U});}if(!("enabled" in k)||k.enabled){g=k[c];if(g==null&&k.get){g=k.get(c);}U.mstrListItemInfo=S+"/"+(g||"")+"/"+d;}}}};N.prototype._attachLayoutHandlers=function Q(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);var R=this.props.model;if(R&&R.attachEventListener){R.attachEventListener(this,"listadd_items","onAddListItems");R.attachEventListener(this,"listremove_items","onRemoveListItems");R.attachEventListener(this,"hashadd_selectedIndices","onAddSelectedIndices");R.attachEventListener(this,"hashremove_selectedIndices","onRemoveSelectedIndices");}};N.prototype._detachLayoutHandlers=function L(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);var R=this.props.model;if(R&&R.attachEventListener){R.detachEventListener(this,"listadd_items");R.detachEventListener(this,"listremove_items");R.detachEventListener(this,"hashadd_selectedIndices");R.detachEventListener(this,"hashremove_selectedIndices");}};N.prototype.onAddListItems=function K(R){var T=R.memo.start;var S=R.memo.count;if(!S||(T==null)){return ;}this._updateEmptyMessage();this.renderItemsAt(T,S);};N.prototype.onRemoveListItems=function I(Z){var X=mstr.utils.ListViewHelper.getItemRenderer(this);if(!X||!X.removeListItem){return ;}var R=Z.memo.ranges;var Y=this,S=this.props.model,W=this.props[mstr.$W.ELEMENT];for(var U=mstr.$A.len(R)-1;U>-1;U--){var V=R[U];for(var T=V.max;T>=V.min;T--){X.removeListItem(Y,S,W,{at:T});}}this._updateEmptyMessage();};N.prototype.onAddSelectedIndices=function F(R){this._toggleSelectedIndices(R.memo.at,"markListItemAsSelected");};N.prototype.onRemoveSelectedIndices=function A(R){this._toggleSelectedIndices(R.memo.at,"markListItemAsUnselected");};N.prototype._toggleSelectedIndices=function O(Y,V){if(!Y){return ;}var S=mstr.utils.ListViewHelper.getItemRenderer(this);if(!S||!S[V]){return ;}var U=this,R=this.props.model,X=this.props[mstr.$W.ELEMENT];var T=R&&R.getItems();for(var W in Y){W=parseInt(W);S[V](U,R,X,{at:W,item:T[W]});}};N.prototype.execClickListItem=function E(V){var S=this.props.model;if(!S){return false;}var U=!!this.props.multiSelect;var T=S.indexOfValue(V.valueForm);if(T>-1){var R=null;if(this.props.isCheckList){if(U){R="ToggleSelect";}else{R="SingleSelect";}}else{if(V.ctrl&&U){R="ToggleSelect";}else{if(V.shift&&U){R="RangeSelect";}else{if(V.rmc&&U){R="RMCSelect";}else{R="SingleSelect";}}}}if(this.get("validator")){this.get("validator").validate(R,T);}S.execCommand(R,T);return true;}else{if(U&&!this.props.isCheckList){S.execCommand("ClearSelect");}return false;}};N.prototype.onkeypress=function D(X,T){if(this.get("ignoreKeyStrokes")){return false;}var W=1;if(this._timerID){window.clearTimeout(this._timerID);this._timerID=null;W=0;}var S=this.getModel();if(!S){return true;}var U=mstr.utils.Events.keyChar(X,T),R=(U==String.fromCharCode(9));if(mstr.Enum.REGEXP_RESERVED_CHARS[U]){U="\\"+U;}this._selKeys+=U;S.execCommand("SelectString",this._selKeys,"n",W);var V=this;this._timerID=window.setTimeout(function(){V._selKeys="";V._timerID=null;},this._keyDelay);if(!R){mstr.utils.Events.cancel(X,T);}return R;};N.prototype.onkeydown=function H(V,S){if(this.get("ignoreKeyStrokes")){return true;}var R=this.getModel();if(!R){return true;}var U=mstr.utils.Events.keyCode(V,S),T=mstr.utils.Events.shiftKey(V,S);switch(U){case 38:this.getModel().execCommand("SelectPrevious",T);mstr.utils.Events.cancel(V,S);return false;case 40:this.getModel().execCommand("SelectNext",T);mstr.utils.Events.cancel(V,S);return false;default:return true;}};N.prototype.focus=function C(){if(!mstr.utils.ISIE4){document.getElementById(this.get("id")+"TabStop").focus();}};N.prototype.restoreFocus=function M(){if(!mstr.utils.ISIE4){document.getElementById(this.get("id")+"TabStop").focus();}else{this.props.scrollArea.focus();}};function N(R){mstr.views.BaseView.apply(this,[R]);this._selKeys="";this._timerID=null;this._keyDelay=1000;}return N;})();mstr.itemrenderers.ListView=(function(){var G={};G.renderListItem=function(H,J,L,K){var I=mstr.itemrenderers.FastListView.renderListItem(H,J,L,K);this._insertElementForIndex(H,L,K.at,I);return I;};G.markListItemAsSelected=function A(H,I,K,J){J.elItem=this._findElementForIndex(H,K,J.at);mstr.itemrenderers.FastListView.markListItemAsSelected(H,I,K,J);};G.markListItemAsUnselected=function E(H,I,K,J){J.elItem=this._findElementForIndex(H,K,J.at);mstr.itemrenderers.FastListView.markListItemAsUnselected(H,I,K,J);};G.removeListItem=function F(H,J,M,K){var I=this._findElementForIndex(H,M,K.at);var L=I&&I.parentNode;if(L){L.removeChild(I);}};G._insertElementForIndex=function B(H,M,J,K){var L=H.props.scrollArea.firstChild;var I=L.childNodes[J];if(I){L.insertBefore(K,I);}else{L.appendChild(K);}};G.on_set_leadIndex=function D(I,J,M){var L=J&&J.get("leadIndex");if(L==null||L<0){return false;}var K=this._findElementForIndex(I,M,L);if(!K){return false;}var H=I.get("scrollArea")||M.rows[0].cells[0].firstChild.childNodes[2];if(!H){return false;}mstr.utils.BoxModel.scrollToElement(H,K);};G._findElementForIndex=function C(H,J,I){return H.props.scrollArea.firstChild.childNodes[I];};return G;})();mstr.views.TextBox=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.execClearSearch=function B(){var C=this.props.element.getElementsByTagName("input");if(C&&C[0].value!=""){C[0].value="";}this.fireCommands(null,"");};function A(C){mstr.views.BaseView.apply(this,[C]);}return A;})();mstr.views.FastListView=(function(){mstr.$O.extendsClass(Q,mstr.views.ListView);Q.DEFAULT_LIST_ITEM_HEIGHT=20;Q.prototype.init=function U(){mstr.views.ListView.prototype.init.apply(this,arguments);this.set("baseHeight",this.get("height"));};Q.prototype._positionPop=function T(){var k=this.props.element;var g=k&&k.style;if(!g){return ;}g.position=mstr.utils.ISFF?"fixed":"absolute";g.display="block";var e=this.props.scrollArea;e.style.height="auto";var d=mstr.utils.BoxModel.getElementOuterHeight(k);if(mstr.utils.ISIE4&&mstr.utils.BoxModel.hasScrollbar(e,"x")){d+=SCROLLBAR_SIZE;}var c=this.get("baseHeight");if(c!="auto"){d=Math.min(d,parseInt(c))+"px";}else{d=c;}e.style.height=d;this.props.height=d;mstr.views.BaseView.prototype._positionPop.apply(this);};Q.prototype.render=function I(){mstr.views.BaseView.prototype.render.apply(this);var c=this.execLayoutHandler("scrollArea");this.props.scrollArea=c;if(c&&this.props.renderListItemsOnScroll){c.onscroll=new Function("e","return mstr.controllers.Factory.obj('"+this.getId()+"').onScroll()");}this.props.listItemsContainer=c&&c.childNodes[0];this._updateItemsContainerDimensions();this.initItems();mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;};Q.prototype.initItems=function H(){var e=this.getModel();var d=mstr.$A.len(e&&e.getItems&&e.getItems());var g=e&&e.props&&e.props.prefixItems&&e.props.prefixItems.length||0;this._updateEmptyMessage();this.props.isListItemRendered=[];if(!d){return ;}var k=this.props.renderListItemsOnScroll&&this.props.scrollArea;if(!k){this.renderItemsAt(0,d);}else{this._addIndicesToRender(0,h);var h=parseInt(this.props.initialListItemRenderCount)||0;h&&this.renderItemsAt(0,h);}var c=mstr.utils.ListViewHelper.getItemRenderer(this);if(c&&c.on_set_leadIndex){c.on_set_leadIndex(this,this.getModel(),this.props.element);}if(k){this.onScroll();}};Q.prototype.renderItemsAt=function W(e,g){var d=mstr.utils.ListViewHelper.getItemRenderer(this);if(!d){return null;}var w=this.props.listItemsContainer;if(!w){return null;}var u=this._countIndicesRenderedBefore(e);var k=w.childNodes[u];var q=this.props.model;var o=q&&q.getItems();var r=Math.min(e+g,mstr.$A.len(o));var l={};var s=this.props.isListItemRendered;var h=(q&&q.getSelectedIndices())||{};var n=this;var AA=this.getId();var q=this.props.model;var c=this.props[mstr.$W.ELEMENT];var t=q&&q.get("valueForm");for(var x=e;x<r;x++){var y=o[x];var z=mstr.utils.ListViewHelper.getItemBrowseCommand(this,y)||"";var c=d.renderListItem(n,q,c,{at:x,item:y,browseCommand:z});if(k){w.insertBefore(c,k);}else{w.appendChild(c);}if(h[x]){d.markListItemAsSelected(n,q,c,{at:x,item:y,elItem:c,notFocus:true});}if(!("enabled" in y)||y.enabled){c.mstrListItemInfo=AA+"/"+(y[t]||"")+"/"+z;}s[x]=true;if(x==e){l.first=c;}if(x==r-1){l.last=c;}}return l;};Q.prototype.onAddListItems=function F(c){var g=c.memo.start;var e=c.memo.count;if(!e||(g==null)){return ;}this._updateEmptyMessage();this._updateItemsContainerDimensions();this._addIndicesToRender(g,e);var d=this.findNextRenderedIndex(g+e,false);if(d>-1){this._adjustWhiteSpaceAboveItem(d,this._getElementForItemAt(d));}this.updateScrollArea();};Q.prototype.onRemoveListItems=function D(n){this._updateItemsContainerDimensions();var k=[];mstr.$A.forEach(n.memo.ranges,function(q){k.push(mstr.$H.clone(q));});var c=this._splitRangesByRenderStatus(k);var o=this.props.isListItemRendered;var e=this.props.listItemsContainer;for(var h=mstr.$A.len(c)-1;h>-1;h--){var l=c[h];if(o[l.min]){var d=this._getElementForItemAt(l.min);for(var g=0;g<l.max-l.min;g++){e.removeChild(d.nextSibling);}e.removeChild(d);}this._removeIndicesToRender(l.min,l.max-l.min+1);var m=this.findNextRenderedIndex(l.max+1,false);if(m>-1){this._adjustWhiteSpaceAboveItem(m,this._getElementForItemAt(m));}}this.updateScrollArea();this._updateEmptyMessage();};Q.prototype._toggleSelectedIndices=function G(o,k){if(!o){return ;}var l=mstr.utils.ListViewHelper.getItemRenderer(this);if(!l){return ;}var n=this,d=this.props.model,e=this.props[mstr.$W.ELEMENT];var h=d&&d.getItems();for(var g in o){g=parseInt(g);var c=this._getElementForItemAt(g);if(c){l[k](n,d,e,{at:g,item:h[g],elItem:c});}}};Q.prototype._updateItemsContainerDimensions=function K(){this._updateItemsContainerHeight();};Q.prototype._updateItemsContainerHeight=function N(){var g=this.props.listItemsContainer;if(!g){return ;}var d=this.props.height;if(!d||d=="auto"){return ;}var k=mstr.utils.ListViewHelper.getItemRenderer(this);var e=k&&((k.listItemHeight&&k.listItemHeight(this))||(k.listItemHeightMin&&k.listItemHeightMin(this)));if(!e){e=Q.DEFAULT_LIST_ITEM_HEIGHT;}if(e){var c=this.getModel();e=e*mstr.$A.len(c&&c.getItems&&c.getItems());}if(e){g.style.height=e+"px";}else{g.style.height=mstr.utils.ISIE4?"1px":"auto";}if(mstr.utils.ISIE4){g.style.overflow=e?"visible":"hidden";}};Q.prototype._addIndicesToRender=function A(d,c){this.props.isListItemRendered=mstr.$A.insert(this.props.isListItemRendered,new Array(c),d);};Q.prototype._removeIndicesToRender=function E(d,c){this.props.isListItemRendered=mstr.$A.removeRange(this.props.isListItemRendered,d,c);};Q.prototype._countIndicesRenderedBefore=function P(c){var e=0;var g=this.props.isListItemRendered;for(var d=0;d<c;d++){if(g[d]){e++;}}return e;};Q.prototype._getElementForItemAt=function S(c){if(this.props.isListItemRendered[c]){var d=this._countIndicesRenderedBefore(c);return this.props.listItemsContainer.childNodes[d];}return null;};Q.prototype._getOrMakeElementForItemAt=function M(e){var h=this._getElementForItemAt(e);if(!h){var c=this.getModel(),d=c&&c.getItems(),k=d[e];if(k){var g=this.renderItemsAt(e,1);h=g&&g.first;if(h){this._adjustWhiteSpaceAboveItem(e,h);this._adjustWhiteSpaceBelowItem(e,h);}}}return h;};Q.prototype.onScroll=function R(){if(this.props.scrollTimeoutId){return true;}this.props.scrollTimeoutId=self.setTimeout('mstr.controllers.Factory.obj("'+this.getId()+'").updateScrollArea()',200);return true;};Q.prototype.after_set_visible=function V(c){if(this.props.visible){this.updateScrollArea();}};Q.prototype.on_win_resize=function Y(c){this._updateListContainerWidth();};Q.prototype.updateScrollArea=function C(){if(this.props.scrollTimeoutId){self.clearTimeout(this.props.scrollTimeoutId);this.props.scrollTimeoutId=null;}var k=this._computeVisibleItemsRange();if(!k){return ;}var d=this._splitRangesByRenderStatus([k]);var l=this.props.isListItemRendered;for(var g=0,c=mstr.$A.len(d);g<c;g++){var e=d[g];if(!l[e.min]){var h=this.renderItemsAt(e.min,e.max-e.min+1);if(!h||!h.first){continue;}this._adjustWhiteSpaceAboveItem(e.min,h.first);this._adjustWhiteSpaceBelowItem(e.max,h.last);}}this._updateListContainerWidth();};Q.prototype._updateListContainerWidth=function B(){if(mstr.utils.ISIE6){return ;}var c=this.props.scrollArea,d=c&&c.firstChild;if(d.style.width!=(c.scrollWidth+"px")&&mstr.utils.BoxModel.hasScrollbar(c,"x")){window.setTimeout(function(){d.style.width=c.scrollWidth+"px";},0);}};Q.prototype.execResetScrollArea=function O(){var c=this.props.scrollArea;if(mstr.utils.ISFF){c.scrollTop=0;}};Q.prototype._adjustWhiteSpaceAboveItem=function X(d,k){if(!k){return ;}var l=mstr.utils.ListViewHelper.getItemRenderer(this);var g=l&&((l.listItemHeight&&l.listItemHeight(this))||(l.listItemHeightMin&&l.listItemHeightMin(this)));if(!g){g=Q.DEFAULT_LIST_ITEM_HEIGHT;}if(!g){return ;}var e=this.findNextRenderedIndex(d-1,true);var c=d-e-1;k.style.marginTop=(c*g)+"px";};Q.prototype._adjustWhiteSpaceBelowItem=function L(d,g){var k=mstr.utils.ListViewHelper.getItemRenderer(this);var e=k&&((k.listItemHeight&&k.listItemHeight(this))||(k.listItemHeightMin&&k.listItemHeightMin(this)));if(!e){e=Q.DEFAULT_LIST_ITEM_HEIGHT;}if(!e){return ;}var m=this.findNextRenderedIndex(d+1,false);if(m>-1){var l=m-d-1;var c=g.nextSibling;if(c){c.style.marginTop=(l*e)+"px";if(mstr.utils.ISIE8){c.style.display="none";window.setTimeout(function(){c.style.display="block";},0);}}}};Q.prototype._computeVisibleItemsRange=function a(){var c=this.props,e=c.scrollArea,n=c.height;if(n&&n.match(/px$/)||(n==String(parseInt(n)))){n=parseInt(n);}else{if(n&&(n!="auto")&&!n.match(/\%$/)){n=e&&e.clientHeight;if(!n&&e&&e.style){n=e.style.height;n=(n.match(/px$/)||(n==String(parseInt(n))))?parseInt(n):"auto";}}else{n="auto";}}if(!n||isNaN(n)){var g=this.props.model,o=g&&g.props&&g.props.items;return{min:0,max:o&&o.length||0};}var k,s;var d=mstr.utils.ListViewHelper.getItemRenderer(this);if(d&&d.listItemHeight){k=s=d.listItemHeight(this);}else{k=(d&&d.listItemHeightMin&&d.listItemHeightMin(this))||Q.DEFAULT_LIST_ITEM_HEIGHT;s=(d&&d.listItemHeightMax&&d.listItemHeightMax(this))||Q.DEFAULT_LIST_ITEM_HEIGHT;}if(k){var q=e.scrollTop;var l={min:parseInt(q/s),max:parseInt((q+n)/k)+1};return l;}return null;};Q.prototype._splitRangesByRenderStatus=function J(e){var m=this.props.isListItemRendered;var d=mstr.$A.len(e);var l=0;while(l<d){var g=e[l];var c=m[g.min];for(var k=g.min+1;k<=g.max;k++){if(m[k]!=c){var h={min:k,max:g.max};g.max=k-1;e=mstr.$A.insert(e,h,l+1);d++;break;}}l++;}return e;};Q.prototype.findNextRenderedIndex=function Z(h,e){var g=this.props.isListItemRendered;if(e){for(var d=h;d>-1;d--){if(g[d]){return d;}}}else{var c=mstr.$A.len(g);for(var d=h;d<c;d++){if(g[d]){return d;}}}return -1;};function Q(c){mstr.views.ListView.apply(this,[c]);this.props.isListItemRendered=[];}return Q;})();mstr.views.FloatingEditor=(function(){mstr.$O.extendsClass(G,mstr.views.BaseView);G.prototype.before_set_visible=function C(L){if(L.memo.value&&this.get("reloadCmds")){this.fireCommands(this.get("reloadCmds"),"");}};G.prototype.execResetValidationStatus=function E(){mstr.views.BaseView.prototype.execResetValidationStatus.apply(this,arguments);if(!this.childValidationStatus){return ;}for(var L in this.childValidationStatus){mstr.$obj(L).execResetValidationStatus();}};G.prototype.after_set_childValidationStatus=function J(M){var L=M.memo;this.childValidationStatus=this.childValidationStatus||{};if(L.code==mstr.Enum.Validation.STATUSCODE.VALID){if(L.id in this.childValidationStatus){delete this.childValidationStatus[L.id];if(mstr.utils.Hash.isEmpty(this.childValidationStatus)){this.set("validationStatus",mstr.Enum.Validation.STATUSCODE.VALID);this.set("message","");this.set("CommandEnabledCheckValidationStatus",true);var N=this.getModel()&&this.getModel().disableModelFromView&&this.getModel().disableModelFromView(false);}}}else{if(mstr.utils.Hash.isEmpty(this.childValidationStatus)){this.set("validationStatus",mstr.Enum.Validation.STATUSCODE.INVALID_ANSWERS);this.set("message",this.props.descriptors.ALERT);this.set("CommandEnabledCheckValidationStatus",false);var O=this.getModel()&&this.getModel().disableModelFromView&&this.getModel().disableModelFromView(true);}this.childValidationStatus[L.id]=L.code;}};G.prototype.after_set_message=function I(N){var P=this.get("element").firstChild.rows[1].cells[0].firstChild;var O=P.firstChild;var M=N.memo.value;if(M){P.style.visibility="hidden";P.style.position="absolute";O.innerHTML=M;P.style.height="auto";var L=function(){var Q=mstr.utils.BoxModel.getElementInnerHeight(P);P.style.height=0;P.style.position="static";P.style.visibility="visible";mstr.utils.Animations.resize(P,null,Q,3,null);};window.setTimeout(L,0);}else{mstr.utils.Animations.resize(P,null,0,3,function(){O.innerHTML="";});}};G.prototype.after_set_opener=function A(M){var Q=this.get("cmdButtons")||[];for(var O=0,N=Q.length;O<N;O++){var L=Q[O]&&Q[O]._refreshCommandHandlers&&Q[O]._refreshCommandHandlers();}var P=this.get("modelPath");if(P&&P.substr(0,6)=="opener"){this.initModel();this._refreshChildViewModels(true);}};G.prototype.render=function F(){mstr.views.BaseView.prototype.render.apply(this);var M=this.props[mstr.$W.ELEMENT];if(this.get("moveToBody")&&mstr.utils.ISIE9&&M.parentNode!=document.body){this.props[mstr.$W.ELEMENT]=document.body.appendChild(M);}var O=M.firstChild;var Q=null;this.set("titleBar",this.execLayoutHandler("titleBar"));if(this.get("isModal")){var L=mstr.utils.Dom.findPositionedAncestor(M);var P=mstr.utils.BoxModel.computeDistanceFromAncestor(L);var N=mstr.utils.BoxModel.getBrowserWindowRect(M.ownerDocument);M.style.top=(N.top-P.offsetY)+"px";M.style.left=(N.left-P.offsetX)+"px";M.style.width=N.width+"px";M.style.height=N.height+"px";M.style.backgroundRepeat="repeat";mstr.utils.Dom.setBGIconClass(M,"1ptrans");Q=O;if(this.left){Q.style.left=this.left;Q.style.top=this.top;}else{mstr.utils.BoxModel.centerElementOnObject(M,Q);this.left=Q.style.left;this.top=Q.style.top;}}else{M.style.height="auto";M.style.width="auto";M.style.background="transparent";Q=M;mstr.utils.BoxModel.centerElementOnObject(document.body,Q);}O.style.visibility="visible";mstr.utils.Dom.insertPopupMask(Q,M,Q.style.left,Q.style.top);if(this.get("loadCmds")){this.fireCommands(this.get("loadCmds"),"");}};G.prototype.getHelpLink=function B(){if(this.get("helpTopic")&&this.get("helpTopic")&&this.get("helpPath")){var L=this.get("helpPath");return L+(L.lastIndexOf("#")===L.length-1?"":"#")+this.get("helpTopic");}return this.get("helpPath");};G.prototype.execShowHelp=function K(L){window.open(L);};G.prototype.execSetModel=function H(L){this.setModel(L);};G.prototype.execCheckValidationStatus=function D(){return !(this.get("validationStatus")>mstr.Enum.Validation.STATUSCODE.VALID);};function G(L){mstr.views.BaseView.apply(this,[L]);if(!this.get("isDraggable")){return ;}this.set("dz",new mstr.models.dnd.DragZone({view:this},{findTarget:function(M,O){var N=M.get("element");var P=mstr.utils.Dom.findAncestor(O.target(),"className","mstrFloatingEditorTitle");return(P&&P==M.get("titleBar"))?P:null;},getDragData:function(M,O){var P=document.createElement("div");P.style.border="2px solid #9e9e9e";var N=M.get("element").firstChild;P.style.height=mstr.utils.BoxModel.getElementOuterHeight(N)+"px";P.style.width=mstr.utils.BoxModel.getElementOuterWidth(N)+"px";return{ddel:P};},endDrag:function(N,M,P){M=Math.max(0,M);P=Math.max(0,P);var O=N.get("element");if(N.get("isModal")){P-=mstr.utils.BoxModel.getElementSumOffsetTop(O);O.firstChild.style.left=M+"px";O.firstChild.style.top=P+"px";if(O.firstChild!=O.lastChild&&O.lastChild.className!=="mstrCurtain"){O.lastChild.style.left=M+"px";O.lastChild.style.top=P+"px";}}else{O.style.left=M+"px";O.style.top=P+"px";}}}));}return G;})();mstr.views.JoinBehaviorTable=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.init=function E(){mstr.views.BaseView.prototype.init.apply(this);};A.prototype.render=function C(){var I="mstrDG",G=this,F=G.getModel(),H=function(){var J=G.buildDGItems(G.getModel().get(G.get("valueField"))),K=false;G.dgWidget=mstrmojo.insert({scriptClass:"mstrmojo.DataGrid",placeholder:G.props.element,cssClass:"jointype",columns:[{headerText:mstrmojo.desc(5467,"Objects"),dataField:"mn",headerCss:"jointype-hd",tooltip:true,itemTooltipField:"tf",itemCSSField:"itemCss",colWidth:160},{headerText:mstrmojo.desc(13176,"Join Type"),headerCss:"jointype-hd",dataWidget:{scriptClass:"mstrmojo.Pulldown",popupToBody:true,itemIdField:"v",itemTitleField:"title",popupZIndex:999,items:[{n:mstrmojo.desc(959,"Default"),v:"dft",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(13177,"Inner Join"),v:"0",title:mstrmojo.desc(13178,"Results displaying only those attribute elements that have metric value")},{n:mstrmojo.desc(13179,"Outer Join - Ignore Filter"),v:"2",title:mstrmojo.desc(13180,"Outer join to attribute's look up table without considering the filter on template")},{n:mstrmojo.desc(13181,"Outer Join - Preserve Filter"),v:"3",title:mstrmojo.desc(13182,"Outer join to attribute's look up table after considering the filter on template")}],onvalueChange:function(){if(!F.translating&&K){F.joinTypeChange(this.data.id,this.value);}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var L=this.data;this.set("value",L[this.itemIdField]);}},mstrmojo.hash.copy(this.markupMethods));if(this.data&&this.data.id!=="allAttrs"){this.items=[{n:mstrmojo.desc(959,"Default"),v:"dft",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(13177,"Inner Join"),v:"0",title:mstrmojo.desc(13178,"Results displaying only those attribute elements that have metric value")},{n:mstrmojo.desc(13183,"Outer Join"),v:"1",title:mstrmojo.desc(13184,"Outer join to attributes look up table")}];}}}}],items:J});G.dgWidget.render();K=true;};G.initModel();F.attachEventListener(this,"set_"+G.get("valueField"),"onUpdateDataGrid");if(!window.mstrmojo){microstrategy.mojoLoader.loadWidget({scriptClass:"DataGrid",id:I,bundle:"mojo-sle.js",callback:function(){microstrategy.mojoLoader.loadWidget({scriptClass:"Pulldown",id:I,bundle:"mojo-coreui.js",callback:H});}});}else{H();}};A.prototype.onUpdateDataGrid=function B(F){if(this.dgWidget){this.dgWidget.set("items",this.buildDGItems(F.memo.value));}};A.prototype.buildDGItems=function D(G){var F=[];mstr.$A.forEach(G,function(H){F.push({mn:H.alias,id:H.dssId,v:H.jt,n:H.n,tf:H.alias,itemCss:H.ic});});return F;};function A(F){mstr.views.BaseView.apply(this,[F]);}return A;})();mstrObserverImpl.prototype=new Object();mstrObserverImpl.prototype.items=null;mstrObserverImpl.prototype.onload=function(){if(microstrategy.observerItems){this.items=microstrategy.observerItems;microstrategy.observerItems=null;}};mstrObserverImpl.prototype.onunload=function(){microstrategy.observerItems=this.items;};mstrObserverImpl.prototype.register=function(A){if(typeof (this.items[A])=="undefined"){this.items[A]=A;}return true;};mstrObserverImpl.prototype.unregister=function(A){if(typeof (this.items[A])!="undefined"){delete this.items[A];}return true;};mstrObserverImpl.prototype.notifyAll=function(A,D){try{for(var E in this.items){var C=mstr.$obj(E);if(C&&A in C){C[A](D);}}return true;}catch(B){microstrategy.errors.log(B);return false;}};function mstrObserverImpl(A){this.items=new Object();return this;}var mstrFormatObject={visibility:["FormattingAppearance","Visible",false,"101,102,105,106,107,52,53,4,8,111"],DisplayStyle:["FormattingAppearance","DisplayStyle",true,"106"],zoom:["RWDocumentProperties","ZoomFactor",false,"all"],borderBottomColor2:["FormattingBorder","Border3DBottomColor",false,"102,106,107,52,53,111,101,8,t,de"],GraphFormat:["FormattingPage","GraphFormat",true,"all"],FormattingNavigation:{Hyperlink:["link",true,"102,106","href"],OpenInNewWindow:["newWin",true,"102,106","nw"],IsHyperlink:["isLink",true,"102,106","isl"]},Autowire:["FormattingLayout","Autowire",true,"all"],textDecoration:["FormattingFont","Underline",false,"52,106,107,111,8,208,t,de,df"],SetBadgeToValueOnField:["FormattingTransactions","SetBadgeToValueOnField",true,"106"],MobileDataView:["Mobile","View",true,"all"],EnableHorizontalSwipeToChange:["FormattingView","EnableHorizontalSwipeToChange",true,"8"],topRightCornerRadius:["FormattingAppearance","TopRightCornerRadius",true,"101,8"],BlackAndWhite:["FormattingPage","BlackAndWhite",true,"all"],EmbedFonts:["FormattingPage","EmbedFonts",true,"all"],InitialSlidingInHeight:["FormattingView","InitialSlidingInHeight",true,"8"],AvailableViewModes:["FormattingPage","AvailableViewModes",true,"all"],FormattingPadding:{TopPadding:["paddingTop",false,"52,106,t,de"],LeftPadding:["paddingLeft",false,"52,106,t,de"],LineSpacing:["lineHeight",false,"106,t"],RightPadding:["paddingRight",false,"52,106,t,de"],BottomPadding:["paddingBottom",false,"52,106,t,de"]},PDFExportDocumentURL:["RWDocumentProperties","PDFExportDocumentURL",true,"all"],fontWeight:["FormattingFont","Bold",false,"52,106,107,111,8,t,de,df"],CalculateDocWidth:["RWDocumentProperties","CalculateDocWidth",true,"all"],titleBarDisplay:["FormattingView","TitleBarDisplay",true,"52,8"],LayoutWidth:["FormattingPage","Width",true,"all"],IPhoneVisualization:["Visualization","IPhoneVisualization",true,"52"],gridExportOverFlow:["FormattingCrosstab","ExportOverflowMode",true,"52"],SelectedVisualization:["Visualization","SelectedVisualization",true,"52"],gradientYOffset:["FormattingPatterns","GradientYOffset",true,"101,106,107,52,53,4,8,9,111,208"],TOCTitleFontItalic:["TableOfContents","TitleFontItalic",true,"all"],PaperType:["FormattingPage","PaperType",false,"all"],InfoWindowPosition:["FormattingView","InfoWindowPosition",true,"8"],SecondaryDataProviders:["FormattingWidget","SecondaryDataProviders",true,"52,111"],FilterDetailsFormat:["FilterDetailsFormatProperties","FilterDetailsFormat",true,"all"],left:["FormattingPosition","Left",false,"101,102,105,106,107,52,53,8,111"],showOnlyInRepeatingCopies:["FormattingAppearance","ShowOnlyInRepeatingCopies",true,"101,102,105,106,107,52,53,8,111"],paddingBottom:["FormattingPadding","BottomPadding",false,"52,106,t,de"],Blur:["FormattingAppearance","Blur",true,"8"],Orientation:["FormattingPage","Orientation",true,"all"],borderTopColor2:["FormattingBorder","Border3DTopColor",false,"102,106,107,52,53,111,101,8,t,de"],isLink:["FormattingNavigation","IsHyperlink",true,"102,106"],FilterDetailsFormatProperties:{FilterDetailsFormat:["FilterDetailsFormat",true,"all"]},gridOverFlow:["FormattingCrosstab","OverflowMode",true,"52"],DisplaySelectorDocked:["FormattingSelector","DisplaySelectorDocked",true,"111"],RSLPath:["FormattingWidget","RSLPath",true,"52,111"],listSeparators:{"2055":";","2064":";","2060":";","2052":",","3082":",","1046":";","1028":",","1036":";","1045":";","1049":";","4108":";","1033":",","1030":";","1031":";","1040":";","1041":",","1042":",","1043":";","1053":";","2057":","},canGrowHorizontal:["FormattingSize","CanGrowHorizontal",true,"4"],fontStyle:["FormattingFont","Italic",false,"52,106,107,111,8,t,de,df"],lockAspectRatio:["FormattingSize","LockAspectRatio",true,"102,106"],FormattingIncrementalFetch:{PreLoadAllPanels:["PSPreLoadAllPanels",true,"8","plp"],MaxRows:["gridIfMaxRows",true,"52","gmr"],RowIFMode:["gridIfRowMode",true,"52","gifmd"],EnableIFOnGrid:["gridIfEnabled",true,"52","gif"]},SupportedOrientations:["FormattingLayout","SupportedOrientations",true,"all"],APhoneVisualization:["Visualization","APhoneVisualization",true,"52"],textAlign2:["FormattingAlignment","Horizontal2",false,"52"],FormattingHTML:{HTMLType:["htmlType",true,"107","htype"],URL:["url",true,"107","hsrc"],HTMLText:["htmlText",true,"107","htxt"]},formatVersion:["FormattingAppearance","FormatVersion",true,"52"],OfflineSubmission:["FormattingSelector","OfflineSubmission",true,"111"],Enable:["FormattingWidget","Enable",true,"52,111"],ViewModeInteractivityLevel:["RWDocumentProperties","ViewModeInteractivityLevel",true,"all"],IPadVisualization:["Visualization","IPadVisualization",true,"52"],topCornersOnly:["FormattingAppearance","TopCornersOnly",true,"101,8"],backgroundColor:["FormattingPatterns","FillColor",false,"101,106,107,52,53,4,8,9,111,208,t,de"],borderLeftStyle:["FormattingBorder","LeftStyle",false,"102,106,107,52,53,111,8,t,de"],UseAsNavBar:["FormattingLayout","UseAsNavBar",true,"8"],ActionForDirectTargetSelectors:["FormattingSelector","ActionForDirectTargetSelectors",true,"111"],ShowFloatingToolbars:["RWDocumentProperties","ShowFloatingToolbars",true,"all"],MarginLeft:["FormattingPage","MarginLeft",true,"all"],TOCTitleFontBold:["TableOfContents","TitleFontBold",true,"all"],height:["FormattingSize","Height",false,"101,102,105,106,107,52,53,4,8,111,4"],PSPreLoadAllPanels:["FormattingIncrementalFetch","PreLoadAllPanels",true,"8"],borderRightColor2:["FormattingBorder","Border3DRightColor",false,"102,106,107,52,53,111,101,8,t,de"],decodeValue:function(A,H){try{if((A in mstrFormatObject)&&mstrFormatObject[A][mstrFormatObject.USE_VALUE]){return H;}var B=function(J,K){if(K!=undefined&&(J==null||J.length==0)){return K+"px";}else{if(J=="auto"||J=="100%"){return J;}else{return(parseFloat(microstrategy.number.toString(J))*microstrategy.DPI_CONVERSION*(microstrategy.ZOOM_FACTOR/100))+"px";}}};var E=function(J,K){if(K!=undefined&&(J==null||J.length==0)){J=K;}return parseFloat(J)*(microstrategy.ZOOM_FACTOR/100)+"pt";};var C=function(K,N){if(K==null||K.length==0){return(N!=undefined)?N:null;}if(K=="-1"){return"transparent";}else{if(K=="-2"){return -2;}else{var J=parseInt(K).toString(16);for(var M=0,L=J.length;M<6-L;M++){J="0"+J;}return"#"+J.substring(4)+J.substring(2,4)+J.substring(0,2);}}};var F={0:"0pt solid",8:"0pt none",3:"1pt dashed",4:"1pt dotted",5:"1.5pt solid",6:"2.5pt double",1:"1pt solid",7:"0.5pt solid"};var G=function(K){K=F[K]||"";if(K==null||K==""){return"";}var J=K.indexOf("pt");return(K.substring(0,J)*(microstrategy.ZOOM_FACTOR/100))+K.substring(J);};H=String(H);var I=H.toLowerCase();switch(A){case"top":return B(I);case"left":return B(I);case"width":return B(I);case"height":return B(I);case"oldWidth":case"oldHeight":case"heightMode":return I;case"widthMode":return I;case"maxHeight":return B(I);case"maxWidth":return B(I);case"TextOverflow":switch(I){case"-1":return"auto";case"0":return"hidden";}case"visibility":switch(I){case"-1":return"visible";case"0":return"hidden";}case"textAlign":switch(I){case"1":return"right";case"2":return"center";case"6":return"justify";default:return"left";}case"textAlign2":switch(I){case"4":return"right";case"3":return"center";case"6":return"justify";default:return"left";}case"verticalAlign":switch(I){case"1":return"middle";case"2":return"bottom";default:return"top";}case"verticalAlign2":switch(I){case"2":return"middle";case"3":return"bottom";default:return"top";}case"whiteSpace":switch(I){case"0":return"nowrap";default:return"normal";}case"fontSize":return E(I);case"color":return C(I,"");case"fontWeight":switch(I){case"-1":return"bold";default:return"normal";}case"fontStyle":switch(I){case"-1":return"italic";default:return"normal";}case"textDecoration":return(I==null||I.length==0||I=="0")?null:"underline";case"textDecoration2":return(I==null||I.length==0||I=="0")?null:"line-through";case"FontHighlightColor":return C(I);case"backgroundColor":return C(I,"");case"backgroundStyle":if(I==null||I.length==0){return null;}else{return(I=="1")?"transparent":"0";}case"gradientColor":return C(I);case"selectionColor":return C(I);case"BackgroundHighlightColor":return C(I);case"borderTopColor2":return C(I);case"borderRightColor2":return C(I);case"borderBottomColor2":return C(I);case"borderLeftColor2":return C(I);case"borderTopColor":return C(I);case"borderRightColor":return C(I);case"borderBottomColor":return C(I);case"borderLeftColor":return C(I);case"borderTopStyle":return G(I);case"borderRightStyle":return G(I);case"borderBottomStyle":return G(I);case"borderLeftStyle":return G(I);case"paddingLeft":return E(I);case"paddingRight":return E(I);case"paddingTop":return E(I);case"paddingBottom":return E(I);case"lineHeight":return(I==null||I.length==0||I=="0"||I=="")?"normal":parseFloat(I)+"in";case"lineStyle":switch(I){case"2":return"dashed";case"3":return"dotted";case"4":return"double";case"0":return"none";default:return"solid";}case"lineColor":return C(I,"");case"lineWeight":return E(I);case"orientation":switch(I){case"1":return"border-left";default:return"border-top";}case"PaperType":switch(I){case"1":return"2A,46.81,66.18";case"2":return"A0,33.11,46.81";case"3":return"A1,23.39,33.11";case"4":return"A2,16.54,23.39";case"5":return"A3,11.69,16.54";case"6":return"A4,8.27,11.69";case"7":return"A5,5.83,8.27";case"8":return"A6,4.13,5.83";case"9":return"A7,2.91,4.13";case"10":return"A8,2.09,2.91";case"11":return"C,17,22";case"12":return"D,22,34";case"13":return"E,34,44";case"14":return"Executive,7.25,10.5";case"15":return"F,28,40";case"16":return"Ledger,11,17";case"17":return"Legal,8.5,14";case"18":return"Letter,8.5,11";case"19":return"Super A3/B,13,19";case"20":return"Folio,8.5,13";default:return"Custom";}case"zoom":return parseFloat(microstrategy.number.toString(I));case"TabColor":return C(I,"");}}catch(D){microstrategy.errors.log(D);return H;}},mct:["FormattingSelector","MetricConditionType",true,"111"],maxWidth:["FormattingSize","MaxWidth",false,"4"],lengthMode:["FormattingSize","LengthMode",true,"105"],PromptUserForPagebyExport:["RWDocumentProperties","PromptUserForPagebyExport",true,"all"],whiteSpace:["FormattingAlignment","TextWrap",false,"52,106,107,t,de"],RemoveMissingUnits:["AnalyticalEngineProperties","RemoveMissingUnits",true,"all"],OfflineOnCube:["RWDocumentProperties","OfflineOnCube",true,"all"],TOCLeftIndent:["TableOfContents","LeftIndent",true,"all"],borderLeftColor:["FormattingBorder","LeftColor",false,"102,106,107,52,53,111,8,t,de"],SmartClientDoc:["RWDocumentProperties","SmartClientDoc",true,"all"],Transition:["FormattingTransitions","Transition",true,"8,52"],Scaling:["FormattingPage","Scaling",true,"all"],borderRightColor:["FormattingBorder","RightColor",false,"102,106,107,52,53,111,8,t,de"],zIndex:["FormattingOrder","ZIndex",true,"101,102,105,106,107,52,53,8,111"],ExpandAllPanels:["FormattingAppearance","ExpandAllPanels",true,"8"],FormattingOrder:{ZIndex:["zIndex",true,"101,102,105,106,107,52,53,8,111"]},FormattingSelector:{IndependentNodeSelector:["IndependentNodeSelector",true,"52"],Orientation:["ctlOrientation",true,"111"],MouseOverAction:["mouseOverAction",true,"111"],TXNSubmitInOrder:["TXNSubmitInOrder",true,"111"],DisplaySelectorDocked:["DisplaySelectorDocked",true,"111"],NoSelectionBehavior:["NoSelectionBehavior",true,"111","nsb"],MinSelectionCount:["MinSelectionCount",true,"111","misc"],Style:["Style",true,"111"],ActionForDirectTargetSelectors:["ActionForDirectTargetSelectors",true,"111","adts"],Multiselect:["Multiselect",true,"52,111"],InformationWindowTarget:["InformationWindowTarget",true,"102,106,111","ifw"],ShowElementCount:["showElementCount",true,"111","sec"],ItemWidthMode:["ItemWidthMode",true,"111"],ExportAsShownOnWeb:["ExportAsShownOnWeb",true,"111","aow"],MaxSelectionCount:["MaxSelectionCount",true,"111","masc"],ShowSummary:["ShowSummary",true,"111"],MetricConditionType:["mct",true,"111"],OfflineSubmission:["OfflineSubmission",true,"111"],SubmitMessage:["SubmitMessage",true,"111"],DisplayText:["DisplayText",true,"111"],SearchOnServer:["SearchOnServer",true,"111","sos"],Include:["Include",true,"111"],DisplayConfirmation:["DisplayConfirmation",true,"111"]},gridShowRH:["FormattingCrosstab","ShowRowHeaders",true,"52"],MaxSelectionCount:["FormattingSelector","MaxSelectionCount",true,"111"],TARGET:4,name:["FormattingAppearance","Name",true,"101,102,105,106,107,52,53,4,8,111"],textAlign:["FormattingAlignment","Horizontal",false,"106,111,107,t,de"],borderLeftColor2:["FormattingBorder","Border3DLeftColor",false,"102,106,107,52,53,111,101,8,t,de"],DisplayConfirmation:["FormattingSelector","DisplayConfirmation",true,"111"],TOCBorderColor:["TableOfContents","BorderColor",true,"all"],TXNSubmitInOrder:["FormattingSelector","TXNSubmitInOrder",true,"111"],NonFlashRender:["FormattingWidget","NonFlashRender",true,"52"],VisualizationList:["Visualization","VisualizationList",true,"52"],TOCFontName:["TableOfContents","FontName",true,"all"],TOCTitleFillColor:["TableOfContents","TitleFillColor",true,"all"],UseAsFilterPanel:["FormattingLayout","UseAsFilterPanel",true,"8"],forceNewPage:["FormattingSection","ForceNewPage",true,"4"],color:["FormattingFont","Color",false,"52,106,107,111,8,t,de,df"],RefreshFrequency:["Mobile","RefreshFrequency",true,"all"],windowState:["FormattingView","WindowState",true,"52,111"],TOCTitleFontColor:["TableOfContents","TitleFontColor",true,"all"],gridArea:["FormattingCrosstab","GridAreaPercent",true,"52"],lineHeight:["FormattingPadding","LineSpacing",false,"106,t"],PROP_SET:0,borderRightStyle:["FormattingBorder","RightStyle",false,"102,106,107,52,53,111,8,t,de"],exportOptions:["FormattingCrosstab","ShowExportOptions",true,"52"],CustomProps:["Visualization","CustomProps",true,"52"],FontHighlightColor:["FormattingFont","HighlightColor",false,"106"],ShowTabLeader:["TableOfContents","ShowTabLeader",true,"all"],autoResizeInDesign:["FormattingSize","AutoResizeInDesign",true,"106"],EnableExport:["Mobile","EnableExport",true,"all"],bottomRightCornerRadius:["FormattingAppearance","BottomRightCornerRadius",true,"101,8"],BeforeLayout:["TableOfContents","BeforeLayout",true,"all"],InformationWindowPlacement:["FormattingView","InformationWindowPlacement",true,"8"],orientation:["FormattingLine","LineOrientation",false,"105"],paddingTop:["FormattingPadding","TopPadding",false,"52,106,t,de"],FormattingFont:{Name:["fontFamily",true,"52,106,107,111,8,t,de,df"],Bold:["fontWeight",false,"52,106,107,111,8,t,de,df"],HighlightColor:["FontHighlightColor",false,"106","fhlc"],Underline:["textDecoration",false,"52,106,107,111,8,208,t,de,df"],Strikeout:["textDecoration2",false,"52,106,107,111,8,208,t,de,df"],Italic:["fontStyle",false,"52,106,107,111,8,t,de,df"],Color:["color",false,"52,106,107,111,8,t,de,df"],Size:["fontSize",false,"52,106,107,111,8,t,de,df"]},Visualization:{APhoneVisualization:["APhoneVisualization",true,"52","aphv"],IncludeMDProperties:["IncludeMDProperties",true,"52"],ATabletVisualization:["ATabletVisualization",true,"52","atv"],IPadVisualization:["IPadVisualization",true,"52","ipadv"],ViewMode:["ViewMode",true,"52"],IPhoneVisualization:["IPhoneVisualization",true,"52","iphv"],FileName:["FileName",true,"52"],VisualizationsEnabled:["VisualizationsEnabled",true,"52"],VisualizationList:["VisualizationList",true,"52"],SelectedVisualization:["SelectedVisualization",true,"52"],VisProps:["VisProps",true,"52"],CustomProps:["CustomProps",true,"52"]},fontSize:["FormattingFont","Size",false,"52,106,107,111,8,t,de,df"],paddingLeft:["FormattingPadding","LeftPadding",false,"52,106,t,de"],showTitleBar:["FormattingView","ShowTitleBar",true,"52,8,111"],BackgroundHighlightColor:["FormattingPatterns","HighlightColor",false,"8,106"],IgnoreInExport:["FormattingAppearance","IgnoreInExport",true,"8"],xTabView:["FormattingUnassigned","xTabView",true,"52"],oldWidth:["FormattingSize","OldWidth",false,"52"],SectionHorizontalOverflow:["FormattingPage","SectionHorizontalOverflow",true,"all"],EnableCopyForGridCell:["Mobile","EnableCopyForGridCell",true,"all"],SelectorBehavior:["RWDocumentProperties","SelectorBehavior",true,"all"],Multiselect:["FormattingSelector","Multiselect",true,"52,111"],ScalePagesTall:["FormattingPage","ScalePagesTall",true,"all"],ShowBookmarks:["FormattingPage","ShowBookmarks",true,"all"],ExportAsShownOnWeb:["FormattingSelector","ExportAsShownOnWeb",true,"111"],ExcelExportDocumentURL:["RWDocumentProperties","ExcelExportDocumentURL",true,"all"],WatermarkFontItalic:["WatermarkProperties","FontItalic",true,"all"],hideIfEmpty:["FormattingSection","HideIfEmpty",true,"4"],src:["FormattingUnassigned","src",true,"102"],FormattingPicture:{PictureAlignment:["pictureAlignment",true,"102"],NormalURL:["NormalURL",true,"106","nmurl"],HighlightURL:["HighlightURL",true,"106","hlurl"],PictureMode:["pictureMode",true,"102"]},ZoomType:["RWDocumentProperties","ZoomType",true,"all"],AnalysisSection:["FormattingAnalysis","AnalysisSection",true,"8,52"],NormalURL:["FormattingPicture","NormalURL",true,"106"],UseAsMasterPanel:["FormattingLayout","UseAsMasterPanel",true,"8"],"VLDB Select":{"MCE Join To Get Data Combination":["RWLevelMCEJoin",true,"all"]},FormattingLayout:{UseAsMasterPanel:["UseAsMasterPanel",true,"8","uamp"],UseAsTableControl:["UseAsTableControl",true,"8","uatc"],UseAsNavBar:["UseAsNavBar",true,"8","uanb"],UseMasterPageHeaderFooter:["TabMPHF",true,"all"],SupportedOrientations:["SupportedOrientations",true,"all"],UseAsFilterPanel:["UseAsFilterPanel",true,"8","uafp"],FitPDFContentHeight:["FitPDFContentHeight",true,"all"],ResetToFirstPanelWhenTargeted:["ResetToFirstPanelWhenTargeted",true,"all","rtfp"],Autowire:["Autowire",true,"all"],NavBarLayout:["NavBarLayout",true,"8","nbl"],UseSegments:["UseSegments",true,"all"],CtlAutoSubmit:["CtlAutoSubmit",true,"8","cas"],TabColor:["TabColor",false,"all"],DisplayPageByBar:["DisplayPageByBar",true,"all"],UseAsInfoWindow:["UseAsInfoWindow",true,"all"],DisplayRePromptIcon:["DisplayRePromptIcon",true,"all"],TableControlDefinition:["TableControlDefinition",true,"8","tcd"]},TARGET_VALUE_STYLE:1,TOCTitleFontStrikeout:["TableOfContents","TitleFontStrikeout",true,"all"],WatermarkFontStrikeout:["WatermarkProperties","FontStrikeout",true,"all"],TableControlDefinition:["FormattingLayout","TableControlDefinition",true,"8"],docked:["FormattingSection","DockSection",true,"dsec"],EditableViewMode:["FormattingPage","EditableViewMode",true,"all"],FormattingSection:{HideIfEmpty:["hideIfEmpty",true,"4","he"],FitExcelRowHeight:["fitExcelRowHeight",true,"4","ferh"],ForceNewPage:["forceNewPage",true,"4","fnp"],RepeatHorizontally:["repeatHorizontally",true,"4","rpth"],KeepSectionTogether:["keepSectionTogether",true,"4","kst"],RepeatSection:["repeatSection",true,"4","rpts"],ShowInHTMLViewMode:["showInHTMLViewMode",true,"4","shvm"],Expanded:["expanded",true,"none"],DockSection:["docked",true,"dsec","docked"]},TOCFontUnderline:["TableOfContents","FontUnderline",true,"all"],DocumentThemeColor:["Mobile","DocumentThemeColor",true,"all"],lineColor:["FormattingLine","LineColor",false,"101,105"],FormattingPage:{PageWidth:["PageWidth",true,"all"],PaperType:["PaperType",false,"all"],EditableViewMode:["EditableViewMode",true,"all"],GraphQualityDPI:["GraphQualityDPI",true,"all"],MarginTop:["MarginTop",true,"all"],DefaultGridStyle:["DefaultGridStyle",true,"all"],GraphFormat:["GraphFormat",true,"all"],ScalePagesTall:["ScalePagesTall",true,"all"],MarginLeft:["MarginLeft",true,"all"],ShowBookmarks:["ShowBookmarks",true,"all"],UsePageWidthAsLayoutWidth:["UsePageWidthAsLayoutWidth",true,"all"],ScalePageHeaderFooter:["ScalePageHeaderFooter",true,"all"],MarginBottom:["MarginBottom",true,"all"],PageHeight:["PageHeight",true,"all"],Width:["LayoutWidth",true,"all"],IncludeBookmarks:["IncludeBookmarks",true,"all"],BlackAndWhite:["BlackAndWhite",true,"all"],Orientation:["Orientation",true,"all"],EmbedFonts:["EmbedFonts",true,"all"],AvailableViewModes:["AvailableViewModes",true,"all"],MarginRight:["MarginRight",true,"all"],PrintHeaderOn:["PrintHeaderOn",true,"all"],UseOneSheetPerLayout:["UseOneSheetPerLayout",true,"all"],UseOneSheetPerGroupElement:["UseOneSheetPerGroupElement",true,"all"],ExpandToFit:["ExpandToFit",true,"all"],ScalePagesWide:["ScalePagesWide",true,"all"],PrintFooterOn:["PrintFooterOn",true,"all"],DefaultViewMode:["DefaultViewMode",true,"all"],ScalePercentage:["ScalePercentage",true,"all"],Scaling:["Scaling",true,"all"],SectionHorizontalOverflow:["SectionHorizontalOverflow",true,"all"]},DisplayText:["FormattingSelector","DisplayText",true,"111"],ShowTabsForSingleLayout:["RWDocumentProperties","ShowTabsForSingleLayout",true,"all"],CopyMode:["FormattingView","CopyMode",true,"106,52"],pictureAlignment:["FormattingPicture","PictureAlignment",true,"102"],DisplayInPartialScreen:["FormattingView","DisplayInPartialScreen",true,"8"],TOCTitleAlignment:["TableOfContents","TitleAlignment",true,"all"],pictureMode:["FormattingPicture","PictureMode",true,"102"],decimalSeparators:{"2055":".","2064":".","2060":",","2052":".","3082":",","1046":",","1028":".","1036":",","1045":",","1049":",","4108":".","1033":".","1030":",","1031":",","1040":",","1041":".","1042":".","1043":",","1053":",","2057":"."},AnalyticalEngineProperties:{TrimEmptySections:["TrimNoSectionData",true,"all"],RemoveNullGroups:["RemoveNullGroups",true,"all"],SingleSourceGrid:["SingleSourceGrid",true,"all"],KeepControlTargetsConsistent:["KeepControlTargetsConsistent",true,"all"],RemoveMissingUnits:["RemoveMissingUnits",true,"all"]},InformationWindowTarget:["FormattingSelector","InformationWindowTarget",true,"102,106,111"],backgroundStyle:["FormattingPatterns","FillStyle",false,"101,106,107,52,53,4,8,9,111,208"],lineWeight:["FormattingLine","LineWeight",false,"101,105"],ExpandToFit:["FormattingPage","ExpandToFit",true,"all"],TOCBorderStyle:["TableOfContents","BorderStyle",true,"all"],maxHeight:["FormattingSize","MaxHeight",false,"4"],IsNavigationDocument:["RWDocumentProperties","IsNavigationDocument",true,"all"],PROP_NAME:1,DatasetObjectsVisible:["FormattingAnalysis","DatasetObjectsVisible",true,"4"],CurrencySymbol:["FormattingNumber","CurrencySymbol",true,"100,106,52,t,de"],borderBottomColor:["FormattingBorder","BottomColor",false,"102,106,107,52,53,111,8,t,de"],ATTR_NAME:3,layoutBarStyle:["RWDocumentProperties","layoutBarStyle",true,"all"],AutoFontSize:["WatermarkProperties","AutoFontSize",true,"all"],ImageScale:["WatermarkProperties","ImageScale",true,"all"],heightMode:["FormattingSize","HeightMode",false,"101,102,105,106,107,52,53,111,8"],MarginTop:["FormattingPage","MarginTop",true,"all"],ExecutionFullScreenMode:["RWDocumentProperties","ExecutionFullScreenMode",true,"all"],FormattingCrosstab:{ShowExportOptions:["exportOptions",true,"52","seo"],ExportOverflowMode:["gridExportOverFlow",true,"52","xovf","2"],ShowRowHeaders:["gridShowRH",true,"52"],GridAreaPercent:["gridArea",true,"52"],ShowColHeaders:["gridShowCH",true,"52"],OverflowMode:["gridOverFlow",true,"52","ovf","2"],Prefetch:["quickSwitch",true,"52"],GridPosition:["gridPosition",true,"52"]},PageHeight:["FormattingPage","PageHeight",true,"all"],Include:["FormattingSelector","Include",true,"111"],CurrencyPosition:["FormattingNumber","CurrencyPosition",true,"100,106,52,t,de"],getAttrNameFromStyle:function(D){try{if(mstrFormatObject[D]){var C=mstrFormatObject[D][mstrFormatObject.PROP_SET];var A=mstrFormatObject[D][mstrFormatObject.PROP_NAME];if(C&&A){return mstrFormatObject[C][A][mstrFormatObject.ATTR_NAME];}}}catch(B){microstrategy.errors.log(err);}return null;},EnableTransition:["FormattingTransitions","Enable",true,"8,52"],NoSelectionBehavior:["FormattingSelector","NoSelectionBehavior",true,"111"],FormattingView:{DisplayInPartialScreen:["DisplayInPartialScreen",true,"8","dips"],TitleBarDisplay:["titleBarDisplay",true,"52,8","tbd"],ShowTitleBar:["showTitleBar",true,"52,8,111","swt"],InitialSlidingInHeight:["InitialSlidingInHeight",true,"8","isih"],InfoWindowPosition:["InfoWindowPosition",true,"8","iwp"],Title:["windowTitle",true,"52,8,9,111","wt"],WindowState:["windowState",true,"52,111","ws"],StyleForSwitchingPanel:["StyleForSwitchingPanel",true,"8","sfwp"],InitialSlidingInWidth:["InitialSlidingInWidth",true,"8","isiw"],InfoWindowMode:["InfoWindowMode",true,"8","iwm"],TabCloseToDismissInfoWindow:["TabCloseToDismissInfoWindow",true,"8","tctdiw"],UseAsInformationWindow:["UseAsInformationWindow",true,"8","uaiw"],EnableHorizontalSwipeToChange:["EnableHorizontalSwipeToChange",true,"8","ehstc"],ShowWidgetTitleBar:["ShowWidgetTitleBar",true,"52","swwt"],ShowAsCollapsiblePanel:["ShowAsCollapsiblePanel",true,"8","sacp"],CopyMode:["CopyMode",true,"106,52","mcm"],InformationWindowPlacement:["InformationWindowPlacement",true,"8","iwpl"]},FormattingUnassigned:{xTabView:["xTabView",true,"52","xTabView"],src:["src",true,"102","src"]},ShowChangeIndication:["FormattingTransactions","",true,"51,52"],enableGraphTooltips:["RWDocumentProperties","enableGraphTooltips",true,"all"],WatermarkFontSize:["WatermarkProperties","FontSize",true,"all"],UseAsInformationWindow:["FormattingView","UseAsInformationWindow",true,"8"],keepSectionTogether:["FormattingSection","KeepSectionTogether",true,"4"],Format:["FormattingNumber","Format",true,"100,106,52,t,de"],FormattingWidget:{WidgetProps:["WidgetProps",true,"52,111","wp"],SecondaryDataProviders:["SecondaryDataProviders",true,"52,111"],Enable:["Enable",true,"52,111"],RSLPath:["RSLPath",true,"52,111"],NonFlashRender:["NonFlashRender",true,"52","nfr","2"],ClassName:["ClassName",true,"52,111","twc","2"],IsApp:["IsApp",true,"52,111"],DhtmlRenderer:["DhtmlRenderer",true,"52","dr","2"]},DefaultGridStyle:["FormattingPage","DefaultGridStyle",true,"all"],getDecimalSeparator:function(B){try{return mstrFormatObject.decimalSeparators[B];}catch(A){microstrategy.errors.log(A);return".";}},TOCTitleFontUnderline:["TableOfContents","TitleFontUnderline",true,"all"],RepeatPanelSpacing:["FormattingAppearance","RepeatPanelSpacing",true,"8"],MarginBottom:["FormattingPage","MarginBottom",true,"all"],getPropertySetName:function(A){return mstrFormatObject[A][mstrFormatObject.PROP_SET];},DropZonesVisible:["FormattingAnalysis","DropZonesVisible",true,"8"],FormattingAlignment:{TextDirection:["TextDirection",true,"52,106,107,t,de","td","3"],Vertical2:["verticalAlign2",false,"52","vta2","3"],Vertical:["verticalAlign",false,"52,106,107,111,t,de","vta","3"],Horizontal2:["textAlign2",false,"52"],Horizontal:["textAlign",false,"106,111,107,t,de"],TextWrap:["whiteSpace",false,"52,106,107,t,de"]},TrimNoSectionData:["AnalyticalEngineProperties","TrimEmptySections",true,"all"],expanded:["FormattingSection","Expanded",true,"none"],ResetToFirstPanelWhenTargeted:["FormattingLayout","ResetToFirstPanelWhenTargeted",true,"all"],Collapsed:["FormattingAnalysis","Collapsed",true,"111"],DefaultPageByExportMode:["RWDocumentProperties","DefaultPageByExportMode",true,"all"],ExportRange:["RWDocumentProperties","ExportRange",true,"all"],topLeftCornerRadius:["FormattingAppearance","TopLeftCornerRadius",true,"101,8"],FormattingAppearance:{Transparency:["Transparency",true,"8","trpr"],Blur:["Blur",true,"8","blur"],TopCornersOnly:["topCornersOnly",true,"101,8","tco"],ExpandAllPanels:["ExpandAllPanels",true,"8","ep"],Visible:["visibility",false,"101,102,105,106,107,52,53,4,8,111","visible"],FormatVersion:["formatVersion",true,"52","fmtv"],DisplayStyle:["DisplayStyle",true,"106","dpst"],BottomRightCornerRadius:["bottomRightCornerRadius",true,"101,8","brcr"],ShowOnlyInRepeatingCopies:["showOnlyInRepeatingCopies",true,"101,102,105,106,107,52,53,8,111","sirc"],Name:["name",true,"101,102,105,106,107,52,53,4,8,111","nm"],IgnoreInExport:["IgnoreInExport",true,"8","cone"],DropShadowDepth:["dropShadowDepth",true,"101,102,105,106,107,53,8,111,52","dsw","3"],HasRoundedCorners:["hasRoundedCorners",true,"101,8","rc"],RepeatPanelSpacing:["RepeatPanelSpacing",true,"8","povfs"],Radius:["radius",true,"101,8","rd"],TooltipText:["title",true,"101,102,105,106,107,52,53,8,111","title"],TopRightCornerRadius:["topRightCornerRadius",true,"101,8","trcr"],BottomLeftCornerRadius:["bottomLeftCornerRadius",true,"101,8","blcr"],TopLeftCornerRadius:["topLeftCornerRadius",true,"101,8","tlcr"],DropShadowEffect:["dropShadowEffect",true,"101,102,105,106,107,53,8,111,52","dse","3"],SplitPanelAcrossPages:["SplitPanelAcrossPages",true,"8","spcp"]},ATabletVisualization:["Visualization","ATabletVisualization",true,"52"],FormattingSize:{MaxWidth:["maxWidth",false,"4","mw"],TextOverflow:["TextOverflow",false,"106,8","tovf"],AutoResizeInDesign:["autoResizeInDesign",true,"106","ard"],CanShrinkHorizontal:["canShrinkHorizontal",true,"4","csh"],CanShrink:["canShrink",true,"4","cs"],CanGrowHorizontal:["canGrowHorizontal",true,"4","cgh"],OldHeight:["oldHeight",false,"52","oldht","3"],Height:["height",false,"101,102,105,106,107,52,53,4,8,111,4","ht","3"],LockAspectRatio:["lockAspectRatio",true,"102,106"],LengthMode:["lengthMode",true,"105"],HeightMode:["heightMode",false,"101,102,105,106,107,52,53,111,8","hm"],MaxHeight:["maxHeight",false,"4","mh"],Length:["length",true,"105","cs"],Width:["width",false,"101,102,105,106,107,52,53,8,111,4","wd","3"],OldWidth:["oldWidth",false,"52","oldwd","3"],WidthMode:["widthMode",false,"101,102,105,106,107,52,53,8,111","wm"],CanGrow:["canGrow",true,"4","cg"]},lineStyle:["FormattingLine","LineStyle",false,"101,105"],getThousandsSeparator:function(B){try{return mstrFormatObject.thousandsSeparators[B];}catch(A){microstrategy.errors.log(A);return",";}},selectionStyle:["FormattingPatterns","SelectorSelectionFillStyle",true,"52,111"],FormattingGroup:{UseOneSheetPerPage:["UseOneSheetPerPage",true,"all"]},verticalAlign:["FormattingAlignment","Vertical",false,"52,106,107,111,t,de"],UsePageWidthAsLayoutWidth:["FormattingPage","UsePageWidthAsLayoutWidth",true,"all"],RWLevelMCEJoin:["VLDB Select","MCE Join To Get Data Combination",true,"all"],EnableSwipingToSwitchLayout:["Mobile","EnableSwipingToSwitchLayout",true,"all"],CtlAutoSubmit:["FormattingLayout","CtlAutoSubmit",true,"8"],fontFamily:["FormattingFont","Name",true,"52,106,107,111,8,t,de,df"],DisplayPageByBar:["FormattingLayout","DisplayPageByBar",true,"all"],PreLoadAllPanels:["RWDocumentProperties","PreLoadAllPanels",true,"all"],WatermarkFontBold:["WatermarkProperties","FontBold",true,"all"],layoutBarPosition:["RWDocumentProperties","layoutBarPosition",true,"all"],gridIfMaxRows:["FormattingIncrementalFetch","MaxRows",true,"52"],selectionColor:["FormattingPatterns","SelectorSelectionColor",false,"52,111"],Title:["TableOfContents","Title",true,"all"],paddingRight:["FormattingPadding","RightPadding",false,"52,106,t,de"],DropZonesWidth:["FormattingAnalysis","DropZonesWidth",true,"8"],FilterMode:["FormattingAnalysis","FilterMode",true,"8"],dropShadowDepth:["FormattingAppearance","DropShadowDepth",true,"101,102,105,106,107,53,8,111,52"],gridIfRowMode:["FormattingIncrementalFetch","RowIFMode",true,"52"],APPLIES_TO:3,borderBottomStyle:["FormattingBorder","BottomStyle",false,"102,106,107,52,53,111,8,t,de"],TextOverflow:["FormattingSize","TextOverflow",false,"106,8"],htmlType:["FormattingHTML","HTMLType",true,"107"],verticalAlign2:["FormattingAlignment","Vertical2",false,"52"],GraphQualityDPI:["FormattingPage","GraphQualityDPI",true,"all"],MinSelectionCount:["FormattingSelector","MinSelectionCount",true,"111"],FormattingPatterns:{SelectorSelectionColor:["selectionColor",false,"52,111","ssc"],GradientColor:["gradientColor",false,"101,106,107,52,53,4,8,9,111,208"],GradientXOffset:["gradientXOffset",true,"101,106,107,52,53,4,8,9,111,208"],FillColor:["backgroundColor",false,"101,106,107,52,53,4,8,9,111,208,t,de"],HighlightColor:["BackgroundHighlightColor",false,"8,106","bhlc"],SelectorSelectionFillStyle:["selectionStyle",true,"52,111","sstyle"],GradientYOffset:["gradientYOffset",true,"101,106,107,52,53,4,8,9,111,208"],GradientAngle:["gradientAngle",true,"101,106,107,52,53,4,8,9,111,208"],FillStyle:["backgroundStyle",false,"101,106,107,52,53,4,8,9,111,208","bgstyle","3"],FillEffect:["FillEffect",true,"106","fe"]},canShrink:["FormattingSize","CanShrink",true,"4"],gridIfEnabled:["FormattingIncrementalFetch","EnableIFOnGrid",true,"52"],WatermarkFontUnderline:["WatermarkProperties","FontUnderline",true,"all"],bottomLeftCornerRadius:["FormattingAppearance","BottomLeftCornerRadius",true,"101,8"],gridPosition:["FormattingCrosstab","GridPosition",true,"52"],EnableBookStylePagebyNavigation:["Mobile","EnableBookStylePagebyNavigation",true,"all"],ShowAsCollapsiblePanel:["FormattingView","ShowAsCollapsiblePanel",true,"8"],VisProps:["Visualization","VisProps",true,"52"],NegativeNumbers:["FormattingNumber","NegativeNumbers",true,"100,106,52,t,de"],TOCTitleFontName:["TableOfContents","TitleFontName",true,"all"],quickSwitch:["FormattingCrosstab","Prefetch",true,"52"],ViewMode:["Visualization","ViewMode",true,"52"],width:["FormattingSize","Width",false,"101,102,105,106,107,52,53,8,111,4"],showInHTMLViewMode:["FormattingSection","ShowInHTMLViewMode",true,"4"],MarginRight:["FormattingPage","MarginRight",true,"all"],TARGET_VALUE_ATTR:2,USE_VALUE:2,url:["FormattingHTML","URL",true,"107"],FitPDFContentHeight:["FormattingLayout","FitPDFContentHeight",true,"all"],ExcelGraphFormat:["RWDocumentProperties","ExcelGraphFormat",true,"all"],WatermarkProperties:{FontColor:["WatermarkFontColor",true,"all"],FontName:["WatermarkFontName",true,"all"],AutoFontSize:["AutoFontSize",true,"all"],ImageScale:["ImageScale",true,"all"],FontScript:["WatermarkFontScript",true,"all"],FontBold:["WatermarkFontBold",true,"all"],FontSize:["WatermarkFontSize",true,"all"],TextOrientation:["TextOrientation",true,"all"],ImageSource:["ImageSource",true,"all"],FontItalic:["WatermarkFontItalic",true,"all"],Text:["Text",true,"all"],WatermarkType:["WatermarkType",true,"all"],FontStrikeout:["WatermarkFontStrikeout",true,"all"],FontUnderline:["WatermarkFontUnderline",true,"all"],TextWashout:["TextWashout",true,"all"]},b3dstyle:["FormattingBorder","Border3DStyle",true,"102,106,107,52,53,111,112,101,8,t,de"],TabCloseToDismissInfoWindow:["FormattingView","TabCloseToDismissInfoWindow",true,"8"],PrintFooterOn:["FormattingPage","PrintFooterOn",true,"all"],ScalePercentage:["FormattingPage","ScalePercentage",true,"all"],Enabled:["TableOfContents","Enabled",true,"all"],thousandsSeparators:{"2055":"'","2064":"'","2060":".","2052":",","3082":".","1046":".","1028":",","1036":" ","1045":" ","1049":" ","4108":"'","1033":",","1030":".","1031":".","1040":".","1041":",","1042":",","1043":".","1053":" ","2057":","},ShowHiddenObjects:["RWDocumentProperties","ShowHiddenObjects",true,"all"],canGrow:["FormattingSize","CanGrow",true,"4"],RemoveNullGroups:["AnalyticalEngineProperties","RemoveNullGroups",true,"all"],RWDocumentProperties:{ShowHiddenObjects:["ShowHiddenObjects",true,"all"],layoutBarStyle:["layoutBarStyle",true,"all"],EmbeddedFonts:["EmbeddedFonts",true,"all"],ZoomFactor:["zoom",false,"all"],SelectorBehavior:["SelectorBehavior",true,"all"],ShowFloatingToolbars:["ShowFloatingToolbars",true,"all"],ApplyGBToAllLayouts:["ApplyGBToAllLayouts",true,"all"],ShowingBarsTemporarily:["ShowingBarsTemporarily",true,"all"],ExcelExportDocumentURL:["ExcelExportDocumentURL",true,"all"],ExecutionFullScreenMode:["ExecutionFullScreenMode",true,"all"],CtlAutoSubmit:["CtlAutoSubmit",true,"all"],ShowTabsForSingleLayout:["ShowTabsForSingleLayout",true,"all"],ZoomType:["ZoomType",true,"all"],PromptUserForPagebyExport:["PromptUserForPagebyExport",true,"all"],PreLoadAllPanels:["PreLoadAllPanels",true,"all"],ExcelEmbedImages:["ExcelEmbedImages",true,"all"],PreserveTranslations:["PreserveTranslations",true,"all"],OfflineOnCube:["OfflineOnCube",true,"all"],layoutBarPosition:["layoutBarPosition",true,"all"],DocumentVersion:["DocumentVersion",true,"all"],PDFExportDocumentURL:["PDFExportDocumentURL",true,"all"],CalculateDocWidth:["CalculateDocWidth",true,"all"],ExcelGraphFormat:["ExcelGraphFormat",true,"all"],enableGraphTooltips:["enableGraphTooltips",true,"all"],SmartClientDoc:["SmartClientDoc",true,"all"],ViewModeInteractivityLevel:["ViewModeInteractivityLevel",true,"all"],IsNavigationDocument:["IsNavigationDocument",true,"all"],DefaultPageByExportMode:["DefaultPageByExportMode",true,"all"],ExportRange:["ExportRange",true,"all"]},TOCFontBold:["TableOfContents","FontBold",true,"all"],TextDirection:["FormattingAlignment","TextDirection",true,"52,106,107,t,de"],WatermarkFontName:["WatermarkProperties","FontName",true,"all"],getPropertyName:function(A){return mstrFormatObject[A][mstrFormatObject.PROP_NAME];},windowTitle:["FormattingView","Title",true,"52,8,9,111"],Duration:["FormattingTransitions","Duration",true,"8,52"],top:["FormattingPosition","Top",false,"101,102,105,106,107,52,53,8,111"],EnableCopyForText:["Mobile","EnableCopyForText",true,"all"],WidgetProps:["FormattingWidget","WidgetProps",true,"52,111"],HTML_PROP_NAME:0,TOCFontSize:["TableOfContents","FontSize",true,"all"],Category:["FormattingNumber","Category",true,"100,106,52,t,de"],ShowSummary:["FormattingSelector","ShowSummary",true,"111"],SubmitMessage:["FormattingSelector","SubmitMessage",true,"111"],TOCFontStrikeout:["TableOfContents","FontStrikeout",true,"all"],InfoWindowMode:["FormattingView","InfoWindowMode",true,"8"],showElementCount:["FormattingSelector","ShowElementCount",true,"111"],FileName:["Visualization","FileName",true,"52"],ScalePagesWide:["FormattingPage","ScalePagesWide",true,"all"],getPxFromPt:function(A){return parseFloat(A)*(microstrategy.DPI_CONVERSION/72);},UseAsInfoWindow:["FormattingLayout","UseAsInfoWindow",true,"all"],WatermarkFontColor:["WatermarkProperties","FontColor",true,"all"],oldHeight:["FormattingSize","OldHeight",false,"52"],DisplayRePromptIcon:["FormattingLayout","DisplayRePromptIcon",true,"all"],WatermarkFontScript:["WatermarkProperties","FontScript",true,"all"],gradientColor:["FormattingPatterns","GradientColor",false,"101,106,107,52,53,4,8,9,111,208"],mouseOverAction:["FormattingSelector","MouseOverAction",true,"111"],canShrinkHorizontal:["FormattingSize","CanShrinkHorizontal",true,"4"],htmlText:["FormattingHTML","HTMLText",true,"107"],ClassName:["FormattingWidget","ClassName",true,"52,111"],gradientAngle:["FormattingPatterns","GradientAngle",true,"101,106,107,52,53,4,8,9,111,208"],IndependentNodeSelector:["FormattingSelector","IndependentNodeSelector",true,"52"],HTML_USE_VALUE:1,IsApp:["FormattingWidget","IsApp",true,"52,111"],DhtmlRenderer:["FormattingWidget","DhtmlRenderer",true,"52"],encodeValue:function(A,H){try{if((A in mstrFormatObject)&&mstrFormatObject[A][mstrFormatObject.USE_VALUE]){return H;}var B=function(J,K){if(K!=undefined&&(J==null||J.length==0)){return parseInt(K,10);}else{if(J=="auto"||J=="100%"){return J;}else{return microstrategy.number.toLocaleString(parseFloat(I)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100));}}};var F=function(J,K){if(K!=undefined&&(J==null||J.length==0)){J=K;}return parseFloat(microstrategy.number.toString(J,false))/(microstrategy.ZOOM_FACTOR/100);};var C=function(J,K){if(K!=undefined&&(J==null||J.length==0||J=="undefined")){J=K;}if(J=="transparent"){return -1;}else{if(J==-2){return -2;}else{return parseInt(J.substring(5)+J.substring(3,5)+J.substring(1,3),16);}}};var D=function(J,K){return(J!=null&&J.indexOf(K)>-1)?"-1":"0";};var G=function(K){K=K||"";if(K!=""){var J=K.indexOf("pt");K=((K.substring(0,J)/(microstrategy.ZOOM_FACTOR/100))+"").substring(0,Math.min(J,3))+K.substring(J);}switch(K){case"0pt solid":return"0";case"0pt none":return"8";case"1pt dashed":return"3";case"1pt dotted":return"4";case"1.5pt solid":return"5";case"2.5pt double":return"6";case"1pt solid":return"1";case"0.5pt solid":return"7";default:return"-1";}};H=String(H);var I=H.toLowerCase();switch(A){case"top":return B(I);case"left":return B(I);case"width":return B(I);case"height":return B(I);case"oldWidth":case"oldHeight":case"heightMode":return I;case"widthMode":return I;case"maxHeight":return B(I);case"maxWidth":return B(I);case"TextOverflow":switch(I){case"auto":return"-1";case"hidden":return"0";}case"visibility":switch(I){case"visible":return"-1";case"hidden":return"0";}case"textAlign":switch(I){case"right":return"1";case"center":return"2";case"justify":return"6";default:return"0";}case"textAlign2":switch(I){case"right":return"4";case"center":return"3";case"justify":return"6";default:return"2";}case"verticalAlign":switch(I){case"middle":return"1";case"bottom":return"2";default:return"0";}case"verticalAlign2":switch(I){case"middle":return"2";case"bottom":return"3";default:return"1";}case"whiteSpace":switch(I){case"nowrap":return"0";default:return"-1";}case"fontSize":return F(I);case"color":return C(I,"#000000");case"fontWeight":switch(I){case"bold":return"-1";default:return"0";}case"fontStyle":switch(I){case"italic":return"-1";default:return"0";}case"textDecoration":return D(I,"underline");case"textDecoration2":return D(I,"line-through");case"FontHighlightColor":return C(I,"#000000");case"backgroundColor":if(I&&I.indexOf(",")>0){I="#"+I.split(",")[0];}return C(I,"#FFFFFF");case"backgroundStyle":if(I&&I.indexOf(",")>0){return"2";}if(I=="gradient"){return"2";}if(I=="transparent"){return"1";}else{return"0";}case"gradientColor":if(I&&I.indexOf(",")>0){I="#"+I.split(",")[1];}return C(I,"#000000");case"selectionColor":return C(I,"#000000");case"BackgroundHighlightColor":return C(I,"#000000");case"borderTopColor2":return C(I,"#000000");case"borderRightColor2":return C(I,"#000000");case"borderBottomColor2":return C(I,"#000000");case"borderLeftColor2":return C(I,"#000000");case"borderTopColor":return C(I,"#000000");case"borderRightColor":return C(I,"#000000");case"borderBottomColor":return C(I,"#000000");case"borderLeftColor":return C(I,"#000000");case"borderTopStyle":return G(I);case"borderRightStyle":return G(I);case"borderBottomStyle":return G(I);case"borderLeftStyle":return G(I);case"paddingLeft":return F(I);case"paddingRight":return F(I);case"paddingTop":return F(I);case"paddingBottom":return F(I);case"lineHeight":return(I==null||I=="0"||I=="normal"||I=="")?"":parseFloat(I);case"lineStyle":switch(I){case"dashed":return"2";case"dotted":return"3";case"double":return"4";case"none":return"0";default:return"1";}case"lineColor":return C(I,"#000000");case"lineWeight":return F(I);case"orientation":switch(I){case"border-left":return"1";default:return"0";}case"PaperType":switch(I){case"2a,46.81,66.18":return"1";case"a0,33.11,46.81":return"2";case"a1,23.39,33.11":return"3";case"a2,16.54,23.39":return"4";case"a3,11.69,16.54":return"5";case"a4,8.27,11.69":return"6";case"a5,5.83,8.27":return"7";case"a6,4.13,5.83":return"8";case"a7,2.91,4.13":return"9";case"a8,2.09,2.91":return"10";case"c,17,22":return"11";case"d,22,34":return"12";case"e,34,44":return"13";case"executive,7.25,10.5":return"14";case"f,28,40":return"15";case"ledger,11,17":return"16";case"legal,8.5,14":return"17";case"letter,8.5,11":return"18";case"super a3/b,13,19":return"19";case"folio,8.5,13":return"20";default:return"0";}case"zoom":return microstrategy.number.toLocaleString(parseFloat(I));case"TabColor":return C(I,"#ffffff");case"colWidth":return Math.round(parseInt(I)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100)*microstrategy.BASE_DPI);}}catch(E){microstrategy.errors.log(E);return H;}},TableOfContents:{TitleFontItalic:["TOCTitleFontItalic",true,"all"],Enabled:["Enabled",true,"all"],FontColor:["TOCFontColor",true,"all"],TitleAlignment:["TOCTitleAlignment",true,"all"],TitleFontBold:["TOCTitleFontBold",true,"all"],BorderWeight:["TOCBorderWeight",true,"all"],TitleFontStrikeout:["TOCTitleFontStrikeout",true,"all"],UserSeparateStyleForTitle:["TOCTitleEnableInherit",true,"all"],FontSize:["TOCFontSize",true,"all"],RightIndent:["TOCRightIndent",true,"all"],FontItalic:["TOCFontItalic",true,"all"],TitleFontUnderline:["TOCTitleFontUnderline",true,"all"],ShowTabLeader:["ShowTabLeader",true,"all"],FillColor:["TOCFillColor",true,"all"],BeforeLayout:["BeforeLayout",true,"all"],LeftIndent:["TOCLeftIndent",true,"all"],TitleFontSize:["TOCTitleFontSize",true,"all"],FontName:["TOCFontName",true,"all"],TitleFontColor:["TOCTitleFontColor",true,"all"],BorderStyle:["TOCBorderStyle",true,"all"],TitleFillStyle:["TOCTitleFillStyle",true,"all"],FontBold:["TOCFontBold",true,"all"],FillStyle:["TOCFillStyle",true,"all"],Title:["Title",true,"all"],IncludePageHeaderFooter:["IncludePageHeaderFooter",true,"all"],BorderColor:["TOCBorderColor",true,"all"],TitleFillColor:["TOCTitleFillColor",true,"all"],FontUnderline:["TOCFontUnderline",true,"all"],FontStrikeout:["TOCFontStrikeout",true,"all"],TitleFontName:["TOCTitleFontName",true,"all"]},UseOneSheetPerGroupElement:["FormattingPage","UseOneSheetPerGroupElement",true,"all"],DecimalPlaces:["FormattingNumber","DecimalPlaces",true,"100,106,52,t,de"],radius:["FormattingAppearance","Radius",true,"101,8"],locked:["FormattingPosition","Locked",true,"101,102,105,106,107,52,53,8,111"],SplitPanelAcrossPages:["FormattingAppearance","SplitPanelAcrossPages",true,"8"],ctlOrientation:["FormattingSelector","Orientation",true,"111"],link:["FormattingNavigation","Hyperlink",true,"102,106"],FormattingNumber:{ThousandSeparator:["ThousandSeparator",true,"100,106,52,t,de","nth","2"],Category:["Category",true,"100,106,52,t,de","nct","2"],Format:["Format",true,"100,106,52,t,de","nfs","2"],DecimalPlaces:["DecimalPlaces",true,"100,106,52,t,de","ndp","2"],CurrencyPosition:["CurrencyPosition",true,"100,106,52,t,de","ncp","2"],CurrencySymbol:["CurrencySymbol",true,"100,106,52,t,de","ncs","2"],NegativeNumbers:["NegativeNumbers",true,"100,106,52,t,de","nnn","2"]},UseOneSheetPerPage:["FormattingGroup","UseOneSheetPerPage",true,"all"],repeatHorizontally:["FormattingSection","RepeatHorizontally",true,"4"],title:["FormattingAppearance","TooltipText",true,"101,102,105,106,107,52,53,8,111"],UseSegments:["FormattingLayout","UseSegments",true,"all"],ScalePageHeaderFooter:["FormattingPage","ScalePageHeaderFooter",true,"all"],length:["FormattingSize","Length",true,"105"],EnableZoom:["Mobile","EnableZoom",true,"all"],DatasetsSettings:["FormattingAnalysis","DatasetsSettings",true,"4"],Transparency:["FormattingAppearance","Transparency",true,"8"],TOCRightIndent:["TableOfContents","RightIndent",true,"all"],FormattingPosition:{Top:["top",false,"101,102,105,106,107,52,53,8,111"],Locked:["locked",true,"101,102,105,106,107,52,53,8,111","lck"],Left:["left",false,"101,102,105,106,107,52,53,8,111"]},ExcelEmbedImages:["RWDocumentProperties","ExcelEmbedImages",true,"all"],PreserveTranslations:["RWDocumentProperties","PreserveTranslations",true,"all"],gridShowCH:["FormattingCrosstab","ShowColHeaders",true,"52"],UseAsTableControl:["FormattingLayout","UseAsTableControl",true,"8"],DocumentVersion:["RWDocumentProperties","DocumentVersion",true,"all"],TOCBorderWeight:["TableOfContents","BorderWeight",true,"all"],SearchOnServer:["FormattingSelector","SearchOnServer",true,"111"],DefaultViewMode:["FormattingPage","DefaultViewMode",true,"all"],PageWidth:["FormattingPage","PageWidth",true,"all"],TabMPHF:["FormattingLayout","UseMasterPageHeaderFooter",true,"all"],DatasetObjectsWidth:["FormattingAnalysis","DatasetObjectsWidth",true,"4"],borderTopStyle:["FormattingBorder","TopStyle",false,"102,106,107,52,53,111,8,t,de"],FormattingTransactions:{"":["ShowChangeIndication",true,"51,52"],SetBadgeToValueOnField:["SetBadgeToValueOnField",true,"106"]},EmbeddedFonts:["RWDocumentProperties","EmbeddedFonts",true,"all"],Style:["FormattingSelector","Style",true,"111"],b3dweight:["FormattingBorder","Border3DWeight",true,"102,106,107,52,53,111,112,101,8,t,de"],ApplyGBToAllLayouts:["RWDocumentProperties","ApplyGBToAllLayouts",true,"all"],ItemWidthMode:["FormattingSelector","ItemWidthMode",true,"111"],ShowingBarsTemporarily:["RWDocumentProperties","ShowingBarsTemporarily",true,"all"],NavBarLayout:["FormattingLayout","NavBarLayout",true,"8"],TOCFillColor:["TableOfContents","FillColor",true,"all"],VisualizationsEnabled:["Visualization","VisualizationsEnabled",true,"52"],repeatSection:["FormattingSection","RepeatSection",true,"4"],Mobile:{EnableCopyForGridCell:["EnableCopyForGridCell",true,"all"],EnableCopyForText:["EnableCopyForText",true,"all"],View:["MobileDataView",true,"all"],EnableSwipingToSwitchLayout:["EnableSwipingToSwitchLayout",true,"all"],DocumentThemeColor:["DocumentThemeColor",true,"all"],EnableExport:["EnableExport",true,"all"],RefreshFrequency:["RefreshFrequency",true,"all"],EnableZoom:["EnableZoom",true,"all"],EnableBookStylePagebyNavigation:["EnableBookStylePagebyNavigation",true,"all"]},TabColor:["FormattingLayout","TabColor",false,"all"],FormattingAnalysis:{FilterMode:["FilterMode",true,"8"],DropZonesWidth:["DropZonesWidth",true,"8"],AnalysisSection:["AnalysisSection",true,"8,52"],FilterDisplay:["FilterDisplay",true,"8"],DatasetObjectsWidth:["DatasetObjectsWidth",true,"4"],Collapsed:["Collapsed",true,"111"],DropZonesVisible:["DropZonesVisible",true,"8"],DatasetsSettings:["DatasetsSettings",true,"4"],DatasetObjectsVisible:["DatasetObjectsVisible",true,"4"]},IncludeBookmarks:["FormattingPage","IncludeBookmarks",true,"all"],FillEffect:["FormattingPatterns","FillEffect",true,"106"],IncludeMDProperties:["Visualization","IncludeMDProperties",true,"52"],FilterDisplay:["FormattingAnalysis","FilterDisplay",true,"8"],textDecoration2:["FormattingFont","Strikeout",false,"52,106,107,111,8,208,t,de,df"],dropShadowEffect:["FormattingAppearance","DropShadowEffect",true,"101,102,105,106,107,53,8,111,52"],ImageSource:["WatermarkProperties","ImageSource",true,"all"],IncludePageHeaderFooter:["TableOfContents","IncludePageHeaderFooter",true,"all"],TOCTitleFontSize:["TableOfContents","TitleFontSize",true,"all"],TOCTitleEnableInherit:["TableOfContents","UserSeparateStyleForTitle",true,"all"],fitExcelRowHeight:["FormattingSection","FitExcelRowHeight",true,"4"],ShowWidgetTitleBar:["FormattingView","ShowWidgetTitleBar",true,"52"],FormattingTransitions:{Enable:["EnableTransition",true,"8,52"],Duration:["Duration",true,"8,52","tdr","2"],Transition:["Transition",true,"8,52","ttr","2"]},ThousandSeparator:["FormattingNumber","ThousandSeparator",true,"100,106,52,t,de"],FormattingBorder:{TopColor:["borderTopColor",false,"102,106,107,52,53,111,8,t,de","btc","3"],BottomStyle:["borderBottomStyle",false,"102,106,107,52,53,111,8,t,de","bbs","3"],Border3DWeight:["b3dweight",true,"102,106,107,52,53,111,112,101,8,t,de","b3dweight","3"],TopStyle:["borderTopStyle",false,"102,106,107,52,53,111,8,t,de","bts","3"],LeftColor:["borderLeftColor",false,"102,106,107,52,53,111,8,t,de","blc","3"],BottomColor:["borderBottomColor",false,"102,106,107,52,53,111,8,t,de","bbc","3"],Border3DRightColor:["borderRightColor2",false,"102,106,107,52,53,111,101,8,t,de","b3drc","3"],RightStyle:["borderRightStyle",false,"102,106,107,52,53,111,8,t,de","brs","3"],Border3DLeftColor:["borderLeftColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dlc","3"],Border3DBottomColor:["borderBottomColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dbc","3"],RightColor:["borderRightColor",false,"102,106,107,52,53,111,8,t,de","brc","3"],Border3DTopColor:["borderTopColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dtc","3"],Border3DStyle:["b3dstyle",true,"102,106,107,52,53,111,112,101,8,t,de","b3dstyle","3"],LeftStyle:["borderLeftStyle",false,"102,106,107,52,53,111,8,t,de","bls","3"]},TOCFontColor:["TableOfContents","FontColor",true,"all"],StyleForSwitchingPanel:["FormattingView","StyleForSwitchingPanel",true,"8"],TOCTitleFillStyle:["TableOfContents","TitleFillStyle",true,"all"],newWin:["FormattingNavigation","OpenInNewWindow",true,"102,106"],TOCFillStyle:["TableOfContents","FillStyle",true,"all"],SingleSourceGrid:["AnalyticalEngineProperties","SingleSourceGrid",true,"all"],getListSeparator:function(B){try{return mstrFormatObject.listSeparators[B];}catch(A){microstrategy.errors.log(A);return",";}},gradientXOffset:["FormattingPatterns","GradientXOffset",true,"101,106,107,52,53,4,8,9,111,208"],isTargetStyleOrAttr:function(E){try{var B=mstrFormatObject.TARGET_VALUE_STYLE;if(!mstrFormatObject[E]){return B;}var D=mstrFormatObject.getPropertySetName(E);var A=mstrFormatObject.getPropertyName(E);if(mstrFormatObject.getAttrNameFromStyle(E)==null||mstrFormatObject.getAttrNameFromStyle(E).length==0){return B;}B=mstrFormatObject.TARGET_VALUE_ATTR;if(mstrFormatObject[D][A][mstrFormatObject.TARGET]&&(parseInt(mstrFormatObject[D][A][mstrFormatObject.TARGET])&(parseInt(mstrFormatObject.TARGET_VALUE_STYLE)+parseInt(mstrFormatObject.TARGET_VALUE_ATTR)))>0){B+=mstrFormatObject.TARGET_VALUE_STYLE;}return B;}catch(C){microstrategy.errors.log(err);}return null;},TextWashout:["WatermarkProperties","TextWashout",true,"all"],widthMode:["FormattingSize","WidthMode",false,"101,102,105,106,107,52,53,8,111"],borderTopColor:["FormattingBorder","TopColor",false,"102,106,107,52,53,111,8,t,de"],FormattingLine:{LineStyle:["lineStyle",false,"101,105","ls","3"],LineWeight:["lineWeight",false,"101,105","lw","3"],LineOrientation:["orientation",false,"105","or"],LineColor:["lineColor",false,"101,105","lc","3"]},TextOrientation:["WatermarkProperties","TextOrientation",true,"all"],PrintHeaderOn:["FormattingPage","PrintHeaderOn",true,"all"],KeepControlTargetsConsistent:["AnalyticalEngineProperties","KeepControlTargetsConsistent",true,"all"],UseOneSheetPerLayout:["FormattingPage","UseOneSheetPerLayout",true,"all"],Text:["WatermarkProperties","Text",true,"all"],InitialSlidingInWidth:["FormattingView","InitialSlidingInWidth",true,"8"],WatermarkType:["WatermarkProperties","WatermarkType",true,"all"],TOCFontItalic:["TableOfContents","FontItalic",true,"all"],hasRoundedCorners:["FormattingAppearance","HasRoundedCorners",true,"101,8"],HighlightURL:["FormattingPicture","HighlightURL",true,"106"]};var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var A;var B;var C;try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");A=B.GetVariable("$version");}catch(C){}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");A="WIN 6,0,21,0";B.AllowScriptAccess="always";A=B.GetVariable("$version");}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A=B.GetVariable("$version");}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A="WIN 3,0,18,0";}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");A="WIN 2,0,0,11";}catch(C){A=-1;}}return A;}function GetSwfVer(){var G=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var F=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var A=navigator.plugins["Shockwave Flash"+F].description;var E=A.split(" ");var C=E[2].split(".");var H=C[0];var B=C[1];if(E[3]!=""){tempArrayMinor=E[3].split("r");}else{tempArrayMinor=E[4].split("r");}var D=tempArrayMinor[1]>0?tempArrayMinor[1]:0;var G=H+"."+B+"."+D;}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){G=4;}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){G=3;}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){G=2;}else{if(isIE&&isWin&&!isOpera){G=ControlVersion();}}}}}return G;}function DetectFlashVer(F,D,C){versionStr=GetSwfVer();if(versionStr==-1){return false;}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera&&(versionStr.indexOf(" ")!=-1)){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",");}else{versionArray=versionStr.split(".");}var E=versionArray[0];var A=versionArray[1];var B=versionArray[2];if(E>parseFloat(F)){return true;}else{if(E==parseFloat(F)){if(A>parseFloat(D)){return true;}else{if(A==parseFloat(D)){if(B>=parseFloat(C)){return true;}}}}}return false;}}}function AC_AddExtension(B,A){if(B.indexOf("?")!=-1){return B.replace(/\?/,A+"?");}else{return B+A;}}function AC_Generateobj(F,E,A,D){var C="";if(isIE&&isWin&&!isOpera){C+="<object ";for(var B in F){C+=B+'="'+F[B]+'" ';}for(var B in E){C+='><param name="'+B+'" value="'+E[B]+'" /> ';}C+="></object>";}else{C+="<embed ";for(var B in A){C+=B+'="'+A[B]+'" ';}C+="> </embed>";}if(typeof (D)!="undefined"){var G=(typeof D=="string")?document.getElementById(D):D;G.innerHTML=C;}else{document.write(C);}}function AC_FL_RunContent(){var B=".swf";if(typeof (microstrategy)!="undefined"){B+="?"+microstrategy.getVersion();}else{if(typeof (mstrmojo)!="undefined"&&mstrmojo.App){B+="?"+mstrmojo.App.getVersion();}}var A=AC_GetArgs(arguments,B,"movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(A.objAttrs,A.params,A.embedAttrs,A.parentDiv);}function AC_GetArgs(B,E,G,D,H){var A=new Object();A.embedAttrs=new Object();A.params=new Object();A.objAttrs=new Object();for(var C=0;C<B.length;C=C+2){var F=B[C].toLowerCase();switch(F){case"classid":break;case"parentdiv":A.parentDiv=B[C+1];case"pluginspage":A.embedAttrs[B[C]]=B[C+1];break;case"src":case"movie":B[C+1]=AC_AddExtension(B[C+1],E);A.embedAttrs.src=B[C+1];A.params[G]=B[C+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":case"id":A.objAttrs[B[C]]=B[C+1];break;case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":A.embedAttrs[B[C]]=A.objAttrs[B[C]]=B[C+1];break;default:A.embedAttrs[B[C]]=A.params[B[C]]=B[C+1];}}A.objAttrs.classid=D;if(H){A.embedAttrs.type=H;}return A;}AC_OETagsObj.prototype=new Object();function AC_OETagsObj(){}microstrategy.FEATURE_CHECK_SHOW_SUBTOTALS="check-show-subtotals";microstrategy.FEATURE_CHECK_MERGE_COL_HEADER="check-merge-col-header";microstrategy.FEATURE_CHECK_MERGE_ROW_HEADER="check-merge-row-header";microstrategy.FEATURE_CHECK_OUTLINE_MODE="check-outline-mode";microstrategy.FEATURE_WEB_REMOVE_FROM_GRID="web-remove-from-grid";microstrategy.FEATURE_INSERT_NEW_METRIC="insert-new-metric";microstrategy.FEATURE_INSERT_TRANSFORMATION_METRICS="insert-transformation-metrics";microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS="modify-grid-level-in-documents";microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE="documents-design-mode";microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY="set-attributeform-display";microstrategy.FEATURE_RW_INTERACTIVE_VIEW_MODE_EPLUS="rw-interactive-view-mode-eplus";microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS="rw-editable-view-mode-eplus";microstrategy.FEATURE_DATASET_OBJECTS_LIST="dataset-objects-list";microstrategy.FEATURE_WEB_PIVOT="web-pivot";microstrategy.FEATURE_CHECK_SHOW_PIVOT_BUTTONS="check-show-pivot-buttons";microstrategy.FEATURE_CHECK_SHOW_SORT_BUTTONS="check-show-sort-buttons";microstrategy.FEATURE_USE_OFFICE="useOffice";microstrategy.FEATURE_MODIFY_REPORT_LIST="modify-report-list";microstrategy.FEATURE_REPORT_FROM_REPORT="web-remove-from-report";microstrategy.FEATURE_USE_REPORT_OBJECT_WINDOW="report-objects-window";microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE="embedded-template-node";microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE="rw-editable-view-mode";microstrategy.FEATURE_ENABLE_REEXECUTE="enable-reexecute";microstrategy.FEATURE_CHECK_SHOW_BANDING="check-show-banding";microstrategy.FEATURE_ENABLE_SCHEDULING="enable-scheduling";microstrategy.FEATURE_IS_NON_VIEWABLE_REPORT="is-non-viewable-report";microstrategy.FEATURE_REPORT_FILTER="report-filter";microstrategy.FEATURE_CREATE_HTML_CONTAINER="create-html-container";microstrategy.FEATURE_CHECK_SHOW_GRAPH_ZONES="check-show-graph-zones";microstrategy.FEATURE_INSERT_INTO_PANEL="insert-into-panel";microstrategy.FEATURE_CHECK_DESIGN_MODE="check-design-mode";microstrategy.FEATURE_ENABLE_SHOW_SUBTOTALS="enable-show-subtotals";microstrategy.FEATURE_IS_VIEW_REPORT="is-view-report";microstrategy.FEATURE_CHECK_LOCK_COLUMN_HEADERS="check-lock-column-headers";microstrategy.FEATURE_CHECK_LOCK_ROW_HEADERS="check-lock-row-headers";microstrategy.FEATURE_CONFIGURE_TRANSACTIONS="configure-transactions";microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES="ask-before-save-changes";microstrategy.FEATURE_FORCE_SAVE_AS="force-save-as";microstrategy.FEATURE_REPORT_TEMPLATE_SEARCH="report-template-search";microstrategy.FEATURE_SINGLE_SOURCE_GRID="single-source-grid";microstrategy.FEATURE_RW_LEVEL_MCE_JOIN="rw-MCE-join";microstrategy.FEATURE_PROJECT_LEVEL_MCE_JOIN="project-MCE-join";microstrategy.FEATURE_MANAGE_DATASETS="manage-datasets";mstrFlashViewerCommands.prototype=new mstrViewerCommandsImpl();mstrFlashViewerCommands.prototype.exec=function(A,C,B){switch(A){case"gridMode":case"graphMode":case"gridGraphMode":case"visFlashMode":case"visAjaxMode":case"visualizationMode":return mstrStaticDoc.getBone(this.parentBone.gridSpan).commands.exec(A,C,B);default:return mstrViewerCommandsImpl.prototype.exec.apply(this,[A,C,B]);}};mstrFlashViewerCommands.prototype.queryState=function(A,B){switch(A){case"gridMode":case"graphMode":case"gridGraphMode":case"visFlashMode":case"visAjaxMode":case"visualizationMode":return mstrStaticDoc.getBone(this.parentBone.gridSpan).commands.queryState(A,B);case"gridType":return"flash";default:return mstrViewerCommandsImpl.prototype.queryState.apply(this,[A,B]);}};mstrFlashViewerCommands.prototype.queryEnabled=function(A,B){switch(A){case"gridMode":case"graphMode":case"gridGraphMode":case"visFlashMode":case"visAjaxMode":case"visualizationMode":return mstrStaticDoc.getBone(this.parentBone.gridSpan).commands.queryEnabled(A,B);default:return mstrViewerCommandsImpl.prototype.queryEnabled.apply(this,[A,B]);}};mstrFlashViewerCommands.prototype.queryVisible=function(A){switch(A){case"gridMode":case"graphMode":case"gridGraphMode":case"visFlashMode":case"visAjaxMode":case"visualizationMode":return mstrStaticDoc.getBone(this.parentBone.gridSpan).commands.queryVisible(A);default:return mstrViewerCommandsImpl.prototype.queryVisible.apply(this,[A]);}};function mstrFlashViewerCommands(A){this.parentBone=A;return this;}mstrFlashViewerImplScript=true;mstrFlashViewerImpl.prototype=new mstrBoneImpl();mstrFlashViewerImpl.prototype.resizeHeight=false;mstrFlashViewerImpl.prototype.titleBarObj=null;mstrFlashViewerImpl.prototype.flashID="MstrFlash";mstrFlashViewerImpl.prototype.onload=function(){try{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){this.commands=new mstrFlashViewerCommands(this);this.observer=microstrategy.viewerObserver||new mstrObserverImpl();microstrategy.viewerObserver=this.observer;}mstrBoneImpl.prototype.onload.call(this);}catch(A){microstrategy.errors.log(A);}};mstrFlashViewerImpl.prototype.onpostload=function(){try{this.onwinresize();var A=this.getGridContainerSpan();if(A){this.titleBarObj=this.titleBarObj||microstrategy.findChildWithAtt(A,"DIV",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_CONTAINER_TITLEBAR);}}catch(B){microstrategy.errors.log(B);return false;}};mstrFlashViewerImpl.prototype.getGridContainerSpan=function(){try{if(!this.gridSpan){this.gridSpan=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_TEMPLATE);}return this.gridSpan;}catch(A){microstrategy.errors.log(A);return false;}};mstrFlashViewerImpl.prototype.onwinresize=function(){try{if(this.resizeHeight){var B=this.id;var C=this.flashID;var G=document.getElementsByName(C)[0];if(!G||!microstrategy.bone(B)){window.setTimeout(function(){microstrategy.bone(B).onwinresize();},10);return ;}var H=function(){var L=getElementById("mstrWeb_dockBottom");var K=getElementById("mstrWeb_footer");G.height=Math.max(getClientHeight()-getObjSumTop(microstrategy.bone(B).elem)-getObjHeight(L)-getObjHeight(K)-2,300);if(bIsChrome){G.width="100%";G.width=mstr.utils.BoxModel.position(getElementById(B)).width;}else{if(mstr&&mstr.utils&&mstr.utils.ISIE7){var J=getElementById("mstrWebContentTable");if(J){J.style.width="100%";}}}};if(bIsChrome){var I=microstrategy.bone("rwb_RWAnalysisSWFStyle");if(I){var F=I.commands,E="chrome_ive";if(F&&F.queryState("rwCurrentViewMode")==microstrategy.RW_VIEW_MODE_VIEWANALYSIS&&!document.getElementById(E)){var A=document.createElement("style");A.id=E;A.type="text/css";A.textContent="html {overflow:hidden;}";document.getElementsByTagName("head")[0].appendChild(A);}}if(this.tmr){window.clearTimeout(this.tmr);}this.tmr=window.setTimeout(function(){H();},500);}else{H();}}}catch(D){microstrategy.errors.log(D);return false;}};mstrFlashViewerImpl.prototype.exec=function(){return false;};function mstrFlashViewerImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;this.primaryBone=true;return this;}mstrFlashDashboardImplScript=true;mstrFlashDashboardImpl.prototype=new mstrBoneImpl();mstrFlashDashboardImpl.prototype.commands=null;mstrFlashDashboardImpl.prototype.currentRWViewMode=8;mstrFlashDashboardImpl.prototype.viewerBone=true;mstrFlashDashboardImpl.prototype.groupBys=null;mstrFlashDashboardImpl.prototype.objectID="";mstrFlashDashboardImpl.prototype.objectType=microstrategy.DSSTYPE_DOC_DEFINITION;mstrFlashDashboardImpl.prototype.needSaveBeforeNotes=true;mstrFlashDashboardImpl.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.observer=new mstrObserverImpl();this.commands=new mstrViewerCommandsImpl(this);this.commands.parentBone=this;if(this.keepAlive){window.setTimeout("microstrategy.getViewerBone().commands.exec('ping');",this.keepAlive);}this.initNotesIcon();mstr.controllers.Factory.add(microstrategy.updateManager);}catch(A){microstrategy.errors.log(A);}};mstrFlashDashboardImpl.prototype.onupdatemanagerchange=function(C,D){var F=[];if(D!=null&&D.length){for(var A=0;A<D.length;A++){var E=D[0];var B={};B.id=E.id;B.beanPath=E.beanPath;B.argID=E.argID;B.newArgs=E.newArgs;F.push(B);}}this.callFlashPlayerFn(this.CALLBACK_FN_UPDATE_MGR_CHANGE,[C,F]);};mstrFlashDashboardImpl.prototype.toggleGrouping=function(){this.showGrouping=!this.showGrouping;this.observer.notifyAll("onFlashGroupByChange");this.callFlashPlayerFn(this.CALLBACK_FN_SHOW_GROUPBY,[this.showGrouping]);};mstrFlashDashboardImpl.prototype.groupingChecked=function(){return this.showGrouping;};mstrFlashDashboardImpl.prototype.callFlashPlayerFn=function(fnName,fnArgs){var fo;var flashDiv=microstrategy.findChildWithAtt(this.elem,"DIV","scriptclass","mstrFlashViewerImpl");if(flashDiv){fo=(mstr.utils.ISIE4)?flashDiv.getElementsByTagName("object")[0]:flashDiv.getElementsByTagName("embed")[0];}if(!fo){return ;}var fnPtr=fo[fnName];if(!fnPtr||typeof (fnPtr)!="function"){return ;}var len=(fnArgs)?fnArgs.length:0;var sArgs="";for(var i=0;i<len;i++){if(i==0){sArgs="fnArgs[0]";}else{sArgs=sArgs+", fnArgs["+i+"]";}}var fnExpr="fo."+fnName+"("+sArgs+")";try{eval(fnExpr);}catch(err){microstrategy.errors.log(err);}};mstrFlashDashboardImpl.prototype.setCurrentGroupByElement=function(C,B){try{microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(null,mstrUpdateManager.SET_CURRENT_GROUP_BY_ELEMENT,this.beanPath,["2048018","2048006","2048078"],["false",C,B],[])],true);if(this.groupBys&&this.groupBys[C]){this.groupBys[C]=B;}}catch(A){microstrategy.errors.log(A);}};mstrFlashDashboardImpl.prototype.containsGroupByDifferentThanAll=function(){try{if(this.groupBys){for(id in this.groupBys){if(this.groupBys[id]!="OA:(All)"){return true;}}return false;}}catch(A){microstrategy.errors.log(A);return false;}};mstrFlashDashboardImpl.prototype.initNotesIcon=function(){try{var B=mstr.$obj("NotesIconModel_model");if(B&&!this.needSaveBeforeNotes){B.set("objectID",this.objectID);B.set("objectType",this.objectType);}if(this.needSaveBeforeNotes||(microstrategy.bone("accordion_AccordionTabManagerStyle")&&microstrategy.bone("accordion_AccordionTabManagerStyle").currentTabName==microstrategy.ACCORDION_RW_NOTES_PANEL)){var A=mstr.$obj("NotesIconView_view");if(A){A.set("visible",false);}}else{if(B){B.execCheck();}}}catch(C){microstrategy.errors.log(C);}};mstrFlashDashboardImpl.prototype.onObjectBrowserTabChange=function(){this.observer.notifyAll("onObjectBrowserTabChange");};function mstrFlashDashboardImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;this.primaryBone=true;return this;}mstrUpdateManager.prototype=new Object;mstrUpdateManager.prototype.id="bonesUpdateManager";mstrUpdateManager.prototype.observer=null;mstrUpdateManager.prototype.actions={};mstrUpdateManager.prototype.redoActions=[];mstrUpdateManager.prototype.undoActions=[];mstrUpdateManager.prototype.staticActions=[];mstrUpdateManager.prototype.useIframe=false;mstrUpdateManager.prototype.newWindow=false;mstrUpdateManager.prototype.newWindowName="_blank";mstrUpdateManager.prototype.extraURL="";mstrUpdateManager.prototype.iframeTarget="frameManager";mstrUpdateManager.prototype.formAction="";mstrUpdateManager.prototype.OPTIMIZE_EVENTS=true;mstrUpdateManager.prototype.ADD_EVENT_IDS=null;mstrUpdateManager.prototype.optActions=[];mstrUpdateManager.prototype.lastPosArray=[];mstrUpdateManager.prototype.copyActions={};mstrUpdateManager.prototype.cachedActionCollection=null;mstrUpdateManager.prototype.queueActions=false;mstrUpdateManager.prototype.forceSubmitAfterQueue=false;mstrUpdateManager.prototype.ctlCurElementsPosition=null;mstrUpdateManager.prototype.currentPanelPosition=null;mstrUpdateManager.prototype.hiddenInputs=null;mstrUpdateManager.prototype.submittedForm=null;mstrUpdateManager.prototype.submittedXhr=false;mstrUpdateManager.prototype.newActions=false;mstrUpdateManager.prototype.sTimeOutID=null;mstrUpdateManager.prototype.callback=null;mstrUpdateManager.UNIT_SEPARATOR=",";mstrUpdateManager.ITEM_SEPARATOR=";";mstrUpdateManager.UPDATE_LATER="0";mstrUpdateManager.UPDATE_NOW="1";mstrUpdateManager.STATIC_ACTION=-1;mstrUpdateManager.ARG_KEY_SEPARATOR="_";mstrUpdateManager.addEvent=function(A){if(!mstrUpdateManager.actions){mstrUpdateManager.actions={};}for(var B in A){var C=A[B].i;mstrUpdateManager[B]=C;mstrUpdateManager.actions[C]={eventID:C,paramName:A[B].n,paramID:A[B].p};}mstrUpdateManager.newActions=true;};mstrUpdateManager.prototype.addSingleAction=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection.push(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getUseIFrame=function(){try{return this.useIframe;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setUseIFrame=function(B){try{this.useIframe=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getNewWindowSetting=function(){try{return this.newWindow;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setNewWindowSetting=function(B){try{this.newWindow=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.addActionCollection=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection=this.cachedActionCollection.concat(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.hasCachedActions=function(){try{return(this.cachedActionCollection&&this.cachedActionCollection.length>0);}catch(A){microstrategy.errors.log(A);}return false;};mstrUpdateManager.prototype.addCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.add(this.cachedActionCollection,false);this.cachedActionCollection=null;if(this.forceSubmitAfterQueue){this.flushAndSubmitChanges();}}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.killCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.cachedActionCollection=null;}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.add=function(C,A){try{if(this.queueActions){if(C.length){this.addActionCollection(C);}else{this.addSingleAction(C);}}else{if(A){this.staticActions.push(C);this.redoActions.unshift(mstrUpdateManager.STATIC_ACTION);this.newActions=true;}else{this.clearRedoActions();this.undoActions.push(C);this.newActions=true;}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","add",C);if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.addURL=function(A){try{if(A){if(this.extraURL.length>0){this.extraURL+="&"+A;}else{this.extraURL=A;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.replaceURL=function(A,D){try{if(this.extraURL.length>0){if(this.extraURL.indexOf(A)>-1){var E=this.extraURL.substring(0,this.extraURL.indexOf(A)-2);var C=this.extraURL.indexOf("&",this.extraURL.indexOf(A));if(E==null||E.length==0){E="";}else{E+="&";}if(C>this.extraURL.indexOf(A)){this.extraURL=E+this.extraURL.substring(C+1,this.extraURL.length)+"&"+A+"="+D;}else{this.extraURL=A+"="+D;}}else{this.extraURL+="&"+A+"="+D;}}else{this.extraURL=A+"="+D;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.processUndoRedo=function(C,D){try{while(C.length>0){var B=C.pop();D.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;}}}catch(A){microstrategy.errors.log(A);}return null;};mstrUpdateManager.prototype.broadcastUpdate=function(){try{while(source.length>0){var B=source.pop();target.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;break;}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.undo=function(C){try{var D=false;C=C||1;for(var A=0;A<C;A++){var F=this.processUndoRedo(this.undoActions,this.redoActions);if(F){for(var B=0;B<F.length;B++){microstrategy.eventManager.notifyOrphanBones("onundo",new mstrUndoObj(F[B]));}D=true;}}if(D){microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","undo");}if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.redo=function(){try{var C=this.processUndoRedo(this.redoActions,this.undoActions);if(C){for(var A=0;A<C.length;A++){microstrategy.eventManager.notifyOrphanBones("onredo",new mstrRedoObj(C[A]));}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","redo");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.getPendingEventsForTask=function(A){var E;var J;var B=0;var N=[];var D=A.split(".");var C=D[D.length-1];var F=this.optActions;this.optActions=[];if(this.OPTIMIZE_EVENTS){for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;this.createOptimizedArray(H);G.splice(M,1);M=M-1;}}}for(var I=0;I<this.optActions.length;I++){if(this.optActions[I].id!=null){N.push(this.createEventForAction(this.optActions[I]));}}this.postOptimizationCleanup();}else{for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;N.push(this.createEventForAction(H));G.splice(M,1);M=M-1;}}}}this.optActions=F;if(N.length>0){var L=new mstrSerializer();L.addValues(N);return L.getState();}else{return"";}};mstrUpdateManager.prototype.flushChanges=function(I){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){addURLAsHiddenInputsToForm(I,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){this.createOptimizedArray(D[H]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){J.push(this.createEventForAction(D[H]));}}}var G=new mstrSerializer();G.addValues(J);if(I.getAttribute("hasUpdateChanges")=="true"){updateDynamicInput(I,mstrUpdateManager.multipleEventArgName,G.getState());}else{this.submittedForm=I;this.hiddenInputs=[];this.createHiddenInput(I,mstrUpdateManager.multipleEventArgName,G.getState());this.createHiddenInput(I,"evt",mstrUpdateManager.multipleEventID);this.createHiddenInput(I,"src",mstrUpdateManager.multipleEventSrc);this.createHiddenInput(I,mstrUpdateManager.multipleEventID,"1");I.setAttribute("hasUpdateChanges","true");}if(this.newWindow){I.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.flushChangesAsParams=function(G){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){UpdateHelper.addURLToParams(G,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){this.createOptimizedArray(D[I]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){J.push(this.createEventForAction(D[I]));}}}var H=new mstrSerializer();H.addValues(J);if(G.hasUpdateChanges=="true"){G[mstrUpdateManager.multipleEventArgName]=H.getState();}else{this.submittedXhr=true;UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventArgName,H.getState());UpdateHelper.addAdditionalParam(G,"evt",mstrUpdateManager.multipleEventID);UpdateHelper.addAdditionalParam(G,"src",mstrUpdateManager.multipleEventSrc);UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventID,"1");G.hasUpdateChanges=="true";}if(this.newWindow){G.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.createHiddenInput=function(D,B,C){var A=createHiddenInput(D,B,C);this.hiddenInputs.push(A);};mstrUpdateManager.prototype.postOptimizationCleanup=function(A){if(this.fullScreenModePosition){delete this.fullScreenModePosition;}if(this.lTbarBrowserSettingPosition){delete this.lTbarBrowserSettingPosition;}if(this.ctlCurElementsPosition){delete this.ctlCurElementsPosition;}if(this.currentPanelPosition){delete this.currentPanelPosition;}if(this.widgetPropEdits){delete this.widgetPropEdits;}this.optActions=[];this.lastPosArray=[];};mstrUpdateManager.prototype.createEventForAction=function(G){try{var A=mstrUpdateManager.actions[G.id];var E=new mstrSerializer();E.addStr(A.eventID);E.addStr(G.beanPath+"."+A.eventID);var D="";for(var C=0;C<G.newArgs.length;C++){actionID=G.argID[C];for(var B=0;B<A.paramID.length;B++){if(A.paramID[B]==actionID){if(false){D+="<arg name='"+A.paramName[B]+"' v='"+G.newArgs[C]+"' />";}if(G.argKey==null){E.addStr(A.paramName[B]);}else{E.addStr(A.paramName[B]+mstrUpdateManager.ARG_KEY_SEPARATOR+G.argKey);}E.addStr(G.newArgs[C]);break;}}}if(false){alert(D);}return E.getState();}catch(F){microstrategy.errors.log(F);return false;}};mstrUpdateManager.prototype.flushAndSubmitChanges=function(C,H){this.callback=H||{};var B=this,G=this.callback.success,F=this.callback.noRefresh;this.callback.success=function(I){if(G){G(I);}if(!F&&I&&I.status=="6"){B.refreshPage();}};try{if(useXHR&&!C){mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var A=UpdateHelper.createParamsFromURL(this.getFormAction(),this.useIframe&&!this.newWindow);this.flushing=true;UpdateHelper.submitRequest(A);}else{mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var D=createDynamicForm(this.getFormAction());if(this.useIframe&&!this.newWindow){addURLAsHiddenInputsToForm(D,"iframe=true");D.target=this.iframeTarget;}this.flushing=true;submitForm(D,C);}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.acknowledgeRequest=function(){try{this.undoActions=[];this.redoActions=[];this.staticActions=[];this.optActions=[];this.lastPosArray=[];this.copyActions={};this.newWindow=false;microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}var B;if(this.submittedForm!=null){for(var A=0;A<this.hiddenInputs.length;A++){B=this.hiddenInputs[A];try{this.submittedForm.removeChild(B);}catch(C){if((C&&C.code!=8)&&(C.number&&C.number!=-2147024809)){throw (C);}}}this.submittedForm.setAttribute("hasUpdateChanges","false");this.submittedForm=null;this.hiddenInputs=null;this.flushing=false;}if(this.submittedXhr){this.submittedXhr=false;this.flushing=false;}}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.isFlushing=function(){return !!this.flushing;};mstrUpdateManager.prototype.acknowledgeReloadEnd=function(){if(this.observer){this.observer.notifyAll("acknowledgeReloadEnd");}};mstrUpdateManager.prototype.getFixStateActions=function(){try{var E=[];for(var B=0;B<this.staticActions.length;B++){var D=this.staticActions[B];for(var A=0;A<D.length;A++){E.push(D[A]);}}return E;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.hasChangesToSubmit=function(){try{return(this.undoActions.length>0||this.isRedoStatic()||(this.extraURL!=null&&this.extraURL.length>0));}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.hasNewChanges=function(){try{var A=this.newActions;this.newActions=false;return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.clearRedoActions=function(){try{while(this.redoActions.length>0){var B=this.redoActions.pop();if(B==mstrUpdateManager.STATIC_ACTION){this.undoActions.push(B);}}}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.getLastAction=function(){try{return this.undoActions.pop();}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.isRedoStatic=function(){try{var C=false;for(var A=0;A<this.redoActions.length;A++){if(this.redoActions[A]==mstrUpdateManager.STATIC_ACTION){C=true;break;}}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.anyNonStatic=function(B){try{var A=(B)?this.redoActions:this.undoActions;var E=false;for(var C=0;C<A.length;C++){if(A[C]!=mstrUpdateManager.STATIC_ACTION){E=true;break;}}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createActionObject=function(C,A,G,H,B,F,J,I){try{var E={};E.elem=C;E.id=A;E.beanPath=G;E.argID=H;E.newArgs=B;E.oldArgs=F;E.cachedArray=J;E.argKey=I;if(A==mstrUpdateManager.EDIT_PROPS){E.formatType=microstrategy.formatType;E.argID.push("2048131");E.newArgs.push(microstrategy.formatType);E.oldArgs.push(microstrategy.formatType);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createOptimizedArray=function(G){try{var I=G.id;if(!this.ADD_EVENT_IDS){this.ADD_EVENT_IDS=mstrUpdateManager.ADD_TEXT+"|"+mstrUpdateManager.ADD_LINE+"|"+mstrUpdateManager.ADD_SHAPE+"|"+mstrUpdateManager.ADD_TEMPLATE+"|"+mstrUpdateManager.ADD_DATASET_TEMPLATE+"|"+mstrUpdateManager.ADD_IMAGE+"|"+mstrUpdateManager.ADD_HTML_CONTAINER+"|"+mstrUpdateManager.ADD_PANEL_STACK+"|"+mstrUpdateManager.CTRL_ADD+"|";}var N=(G.elem)?G.elem.id:null;var B=N;if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="4146"){B=N+G.newArgs[K].split("!")[0]+G.newArgs[K].split("!")[1]+G.newArgs[K].split("!")[2];break;}}}var P;if(I==mstrUpdateManager.EDIT_PROPS){for(var K=0,D=G.argID.length;K<D;K++){if(G.argID[K]=="2048035"){var J=G.newArgs[K].split(mstrUpdateManager.UNIT_SEPARATOR);if(J[1]=="FormattingWidget"&&J[2]=="WidgetProps"){var C=this.widgetPropEdits||{};if(J[0] in C){this.optActions[C[J[0]]].id=null;}C[J[0]]=this.optActions.length;this.widgetPropEdits=C;}break;}}this.optActions.push(G);}else{if(I==mstrUpdateManager.COPY_TO_CLIPBOARD||I==mstrUpdateManager.CUT_TO_CLIPBOARD){P=G.newArgs[0].split(CLIPBOARD_ITEM_SEPARATOR);for(var K=0;K<P.length;K++){this.copyActions[P[K]]={};this.copyActions[P[K]].position=this.optActions.length;this.copyActions[P[K]].applied=false;}this.optActions.push(G);}else{if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES||I==mstrUpdateManager.EDIT_TEXT||I==mstrUpdateManager.SET_TOPLEFT_POSITION||I==mstrUpdateManager.CHANGE_BONE_PROPERTY){if(!this.lastPosArray[I]){this.lastPosArray[I]={};}if(this.copyActions[N]&&this.copyActions[N].applied==false){this.copyActions[N].applied=true;for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}else{if(this.lastPosArray[I][B]){var L=this.lastPosArray[I][B].position;var F=this.optActions[L];var H=mstr.$A.find(F.argID,"2048007");if(H==-1){H=null;}var M=mstr.$A.find(F.argID,"2048007");if(M==-1){H=null;}if(M==H){F.newArgs=G.newArgs;}else{this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}else{this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}}else{if(I==mstrUpdateManager.REMOVE_OBJECT){if(this.copyActions[N]){for(var K=this.copyActions[N].position;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N){this.optActions[K].id=null;}}delete this.copyActions[N];for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}}else{for(var K=0;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N&&!this.ADD_EVENT_IDS.contains(this.optActions[K].id,"|")){this.optActions[K].id=null;}}}this.optActions.push(G);}else{if(I==mstrUpdateManager.SWITCH_FULL_SCREEN_MODE){if(typeof (this.fullScreenModePosition)!="undefined"&&this.optActions[this.fullScreenModePosition]&&this.optActions[this.fullScreenModePosition].newArgs&&this.optActions[this.fullScreenModePosition].id==I){this.optActions[this.fullScreenModePosition].newArgs=G.newArgs;}else{this.fullScreenModePosition=this.optActions.length;this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING){if(G.argID[0]=="5005"&&G.newArgs[0]=="lTbar"){if(typeof (this.lTbarBrowserSettingPosition)!="undefined"&&this.optActions[this.lTbarBrowserSettingPosition]&&this.optActions[this.lTbarBrowserSettingPosition].newArgs){this.optActions[this.lTbarBrowserSettingPosition].newArgs=G.newArgs;}else{this.lTbarBrowserSettingPosition=this.optActions.length;this.optActions.push(G);}}else{this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_CUR_CTL_ELEMENTS){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="2048130"){this.ctlCurElementsPosition=this.ctlCurElementsPosition||{};var A=G.newArgs[K];if(A in this.ctlCurElementsPosition){this.optActions[this.ctlCurElementsPosition[A]].id=null;}this.ctlCurElementsPosition[A]=this.optActions.length;this.optActions.push(G);break;}}}else{if(I==mstrUpdateManager.SET_CURRENT_PANEL){var O=G.newArgs[0];if(!this.currentPanelPosition){this.currentPanelPosition={};}if(typeof (this.currentPanelPosition[O])!="undefined"){this.optActions.splice(this.currentPanelPosition[O],1);}this.currentPanelPosition[O]=this.optActions.length;this.optActions.push(G);}else{this.optActions.push(G);}}}}}}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.getFormAction=function(){if(!this.formAction){this.formAction=microstrategy.servletName;}return this.formAction;};mstrUpdateManager.prototype.setFormAction=function(A){this.formAction=A;};mstrUpdateManager.createPropertyEditString=function(C,B,G,A,H){try{var F=mstrFormatObject;if(!F){return"";}if(!A){G=F.encodeValue(B,G);}var D=C||"";if(D){D+=mstrUpdateManager.UNIT_SEPARATOR;}return D+(H||F.getPropertySetName(B))+mstrUpdateManager.UNIT_SEPARATOR+F.getPropertyName(B)+mstrUpdateManager.UNIT_SEPARATOR+G+mstrUpdateManager.ITEM_SEPARATOR;}catch(E){microstrategy.errors.log(E);return"";}};mstrUpdateManager.prototype.createEditPropsAction=function(F,J,S,I,Q,D,A,L,K,R){try{var E=(A)?mstrUpdateManager.UPDATE_NOW:mstrUpdateManager.UPDATE_LATER;var M=mstrUpdateManager.createPropertyEditString;var O=K?"1":"0";var H="",C="";for(var N=0;N<I.length;N++){H+=M(J,I[N],Q[N],R);if(D&&(N in D)){C+=M(J,I[N],D[N]);}}var B=K?["2048018","2048035","2048241"]:["2048018","2048035"],G=K?[E,H,O]:[E,H];return this.createActionObject(F,mstrUpdateManager.EDIT_PROPS,S,B,G,(C&&[E,C])||[],L);}catch(P){microstrategy.errors.log(err);return null;}};mstrUpdateManager.prototype.findRwbInputOnPageStateForm=function(){var C=getObj("pageStateForm");var B=C.getElementsByTagName("INPUT");for(i=0,cnt=B.length;i<cnt;i++){var A=B[i];if(A.name==="rwb"){return A;}}return null;};mstrUpdateManager.prototype.getRWBState=function(A){if(A){var B=this.findRwbInputOnPageStateForm();if(B){return B.value;}}else{if(pageState){var C=(pageState+"&").match(/rwb=(.*?)\&/);if(C!=-1){return C[1];}}}return"";};mstrUpdateManager.prototype.setRWStateInForm=function(A){var B=this.findRwbInputOnPageStateForm();if(B){B.value=A;}};mstrUpdateManager.prototype.refreshPage=function(){try{this.useIframe=false;var B=this.createActionObject(null,mstrUpdateManager.PAGE_REFRESH,microstrategy.servletName+"."+microstrategy.pageName,[],[],[],null);this.add([B],true);this.flushAndSubmitChanges();}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.submitPartialUpdate=function(C){try{microstrategy.puStatus=0;iframe.notifyParent(true);if(!this.partialUpdateModel){this.partialUpdateModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.partialUpdateModel);var A=this.partialUpdateModel&&this.partialUpdateModel&&this.partialUpdateModel.init();if(!("id" in this)||!mstr.$obj(this.id)){mstr.controllers.Factory.add(this);}this.partialUpdateModel.attachEventListener(this,"set_readyState","handleStateChange");}C.processorClass=mstr.http.PUProcessor;this.partialUpdateModel.execSubmit({params:C,callback:this.callback});}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.handleStateChange=function(evt){try{switch(evt.memo.value){case mstr.Enum.Widget.READYSTATE.TIMEOUT:case mstr.Enum.Widget.READYSTATE.ERROR:break;case mstr.Enum.Widget.READYSTATE.SUCCESS:var updateResult=evt.src.get("requestContext").response.data;if(updateResult){if(updateResult.status=="2"){iframe.showWaitPage();}else{iframe.hideWaitPage();}UpdateHelper.replaceComponents(updateResult.components);document.title=updateResult.title;if(updateResult.status=="2"){this.doRedirect(updateResult.redirectURL,updateResult.waitSeconds);}microstrategy.eventManager.executeFunction("microstrategy.eventManager.onreload()");if(updateResult.script){eval(updateResult.script);}microstrategy.puStatus=1;}else{if(window.document.readyState=="complete"){var sMarkup=evt.src.get("requestContext").response.text;if(bIsIE6&&!bIsIE7){document.write(sMarkup);}else{var oNewDoc=window.document.open("text/html");if(sMarkup.indexOf("<!DOCTYPE")==-1){oNewDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd " >');}oNewDoc.write(sMarkup);oNewDoc.close();}}}delete this.callback;break;}}catch(err){microstrategy.errors.log(err);}};mstrUpdateManager.prototype.doRedirect=function(C,A){try{this.sTimeOutID=window.setTimeout('microstrategy.updateManager.timedRedirect("'+C+'")',A*1000);}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.timedRedirect=function(C){try{window.clearTimeout(this.sTimeOutID);var A=UpdateHelper.createParamsFromURL(C);UpdateHelper.submitRequest(A);}catch(B){microstrategy.errors.log(B);}};function mstrUpdateManager(){this.commands=new UpdateManagerCommands(this);if(typeof (mstrObserverImpl)!="undefined"){this.observer=new mstrObserverImpl();}return this;}if(typeof (microstrategy)!="undefined"){microstrategy.updateManager=new mstrUpdateManager();}mstrUndoObj.prototype={};function mstrUndoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.oldArgs;this.cachedArray=A.cachedArray;return this;}mstrRedoObj.prototype={};function mstrRedoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.newArgs;this.cachedArray=A.cachedArray;return this;}function UpdateManagerCommands(A){this.queryVisible=function(B){return true;};this.queryEnabled=function(B){switch(B){case"redo":return A.anyNonStatic(true);case"undo":return A.anyNonStatic(false);case"apply":return A.hasChangesToSubmit();default:return false;}};this.queryState=function(B){return false;};this.exec=function(B,C){switch(B){case"redo":return A.redo();case"undo":return A.undo();case"apply":A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return A.flushAndSubmitChanges();default:return false;}};return this;}var UpdateHelper=new function(){};UpdateHelper.prototype=new Object();UpdateHelper.createParamsFromURL=function(B,G){var C={method:"post"};var H=B.indexOf("?")>0;var F=B.indexOf("#")>0;var E=(B.indexOf("iframe=true")>0||G);var D=((H)?B.substring(0,B.indexOf("?")):B);if(F){var A="";B=moveAnchor(B);A=B.substring(B.indexOf("#"));D=D.replace(A,"")+A;B=B.substring(0,B.indexOf("#"));}D=microstrategy.addJSessionID(D);if(H){UpdateHelper.addURLToParams(C,B);}C.iframe=(E)?"true":"false";C.action=D;return C;};UpdateHelper.createParamsFromForm=function(I,J,F,H){var G=getObj(I);var C=microstrategy.findChildrenWithAtt(G,["INPUT","SELECT","TEXTAREA"],"name");var B={action:G.action,method:G.method};if(typeof G.target!=undefined){B.target=G.target;}for(var D=0;D<C.length;D++){var A=C[D];if(H===true&&A.ps===true){continue;}if(A.type=="select-multiple"&&A.options&&A.options.length>0&&A.disabled!=true){for(var E=0;E<A.options.length;E++){if(UpdateHelper.shouldSubmit(A.options[E])){UpdateHelper.addAdditionalParam(B,A.name,A.options[E].value);}}}else{if(UpdateHelper.shouldSubmit(A)){UpdateHelper.addAdditionalParam(B,A.name,A.value);}}}if(J){B[J]=F;}return B;};UpdateHelper.shouldSubmit=function(A){if(A.disabled==true){return false;}if(A.type=="submit"||A.type=="button"||A.type=="image"||A.value=="undefined"){return false;}if(A.type=="radio"||A.type=="checkbox"){if(!A.getAttribute("agg")){return A.checked;}else{A.value=A.checked?"true":"false";return true;}}if(A.tagName.toLowerCase()=="option"){return A.selected;}return true;};UpdateHelper.addURLToParams=function(D,F,C){F=F.substring(F.indexOf("?")+1,F.length);var G=F.split("&");var I="";var E="";var A="";var H=/\+/g;for(var B=0;B<G.length;B++){I=G[B].split("=");E=I[0];A=I[1];if(A){A=decodeURIComponent(A.replace(H," "));}if(C){D[E]=A;}else{UpdateHelper.addAdditionalParam(D,E,A);}}return false;};UpdateHelper.addAdditionalParam=function(A,B,C){if(A[B]&&typeof A[B]!="object"){A[B]=[A[B],C];}else{if(A[B]&&A[B].push){A[B].push(C);}else{A[B]=C;}}};UpdateHelper.submitRequest=function(H){var N=getObj("pageStateForm");var E=null;var I=null;var G;var F;var C;var O;UpdateHelper.appendPageStateToParams(H);if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){var L=microstrategy.bones.rwb_viewer;H.docSelections=L.commands.queryState("selectionsKey");L.adjustScrollValues();H.viewerScroll=L.dScrollTop+","+L.dScrollLeft;H.isLocked=(L.insertionControlLocked)?1:0;var M=L.doc.currentControlSubtype?"|"+L.doc.currentControlSubtype:"";H.currentControl=L.doc.currentControl+M;}if(typeof (microstrategy)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){for(var A in microstrategy.bones){if(microstrategy.bones[A]!=null&&microstrategy.bones[A].type==microstrategy.OBJTYPE_GRID){var B=microstrategy.bones[A];if(B&&B.gridStructureInfo&&!B.gridStructureInfo.emptyCase&&!B.gridStructureInfo.isEmptyTemplate){if(B.isGrid){var K=B.commands.queryState("selections");if(K){H[B.id]=K;}}if(B.isGraph&&A.indexOf("_graph")==-1){H[B.id+"_gs"]=B.commands.queryState("graphSelections");}}}}}if(H.iframe=="true"){microstrategy.updateManager.submitPartialUpdate(H);}else{var J=UpdateHelper.createFormFromParams(H);UpdateHelper.appendPageSizeToParams(J);if(mstr.utils.ISSAFARI&&J.target=="_blank"){J.action+=(J.action.indexOf("?")==-1?"?":"&");J.action+="t="+new Date().getTime();}try{microstrategy.submitForm(J);}catch(D){if(J.target!=""&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){showMessage({contents:microstrategy.descriptors.getDescriptor("5877"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.errors.log(D);}}}return false;};UpdateHelper.createFormFromParams=function(A){var C=document.createElement("FORM");C.name="dynamic_form";C.method=A.method;delete A.method;C.action=A.action;delete A.action;if(typeof A.target!="undefined"){C.target=A.target;delete A.target;}C.setAttribute("hasUpdateChanges",A.hasUpdateChanges=="true");for(var D in A){if(A[D]){if(typeof A[D]=="object"){for(var B=0;B<A[D].length;B++){if(A[D][B]){createHiddenInput(C,D,A[D][B]);}}}else{createHiddenInput(C,D,A[D]);}}}document.body.insertAdjacentElement("beforeEnd",C);return C;};UpdateHelper.submitFormThroughXHR=function(B,D){if(D){if(!B){B=window.event;}var B=getEventTarget(B);if(!B){return false;}}var F=microstrategy.findAncestorWithTag(B,"FORM");var C=B.name;var A=B.value;if(typeof F=="undefined"||typeof C=="undefined"||typeof A=="undefined"){return false;}var E=UpdateHelper.createParamsFromForm(F,C,A,true);UpdateHelper.appendPageStateToParams(E);microstrategy.updateManager.submitPartialUpdate(E);return false;};UpdateHelper.appendPageStateToParams=function(A){var E=getObj("pageStateForm");var D=null;var B=(typeof (microstrategy)!="undefined")?microstrategy.updateManager:null;var C;if(B&&B.hasChangesToSubmit()){B.flushChangesAsParams(A);UpdateHelper.addEvtOrderToParams(A,mstrUpdateManager.multipleEventID);}if(E){if(A.method=="get"||A.method=="GET"){UpdateHelper.addURLToParams(A,pageState,true);}else{D=E.getElementsByTagName("INPUT");for(C=0;C<D.length;C++){A[D[C].name]=D[C].value;}}}};UpdateHelper.appendPageSizeToParams=function(A){createHiddenInput(A,"innerWidth",getClientWidth());createHiddenInput(A,"innerHeight",getClientHeight());};UpdateHelper.submitLink=function(F){var H;H=F.href;var C;C=F.target;var G=document.getElementById("cssAnalyzerToolbar");var A=(getCookie(ENABLE)=="true")&&(G!=null);if(A){return false;}window.mstrSubmitLink=true;if(C=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){var B=UpdateHelper.createParamsFromURL(H);if(C){B.target=C;}UpdateHelper.submitRequest(B);return false;}if(typeof (pageState)!="undefined"){var D=updateLink(H);D=moveAnchor(D);var E=null;if(bIsIE6&&F.childNodes&&(F.childNodes.length==1)&&F.childNodes[0].nodeType==3){E=F.innerHTML;}F.href=D;if(bIsIE6&&E!=null){F.innerHTML=E;}return true;}else{return true;}};UpdateHelper.addEvtOrderToParams=function(A,B,C){if(A.evtorder){if(A.evtorder.indexOf(B)<0){if(C){A.evtorder=A.evtorder+","+B;}else{A.evtorder=B+","+A.evtorder;}A[B]="1";}}else{A.evtorder=B;if(A.evt&&A.evt.length<3){for(j=0;j<A.evt.length;j++){A[A.evt[j]]="1";}}}};UpdateHelper.replaceComponents=function(A,G){try{if(!G){iframe.consolidatedStyles={};iframe.isProcessing=true;if(!bIsW3C){iframe.togglePulldownChildren(document.body,false);}}var C;for(C=0;C<A.length;C++){var F=A[C];if(F&&F.ISEMPTY!="true"){if(F.errBox!="true"||currentModalEditor.length==0){UpdateHelper.updateComponent(F,G);}else{var E=F.content;if(E.length>0){showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}}}}if(!G){for(var B in iframe.consolidatedStyles){updateStyleContainer(iframe.consolidatedStyles[B],B);}if(!bIsW3C){iframe.togglePulldownChildren(document.body,true);}iframe.targets=null;microstrategy.loadDynamicJS();microstrategy.registerNewBones();}}catch(D){microstrategy.errors.log(D);}};UpdateHelper.updateComponent=function(cB,parentId){try{var sReplaceHTML;var aScripts=null;var j;var oParentDiv;if(!cB.id){return ;}if(cB.components&&cB.components.length>1){UpdateHelper.replaceComponents(cB.components,cB.id);return ;}else{if(cB.components&&cB.components.length==1){return ;}}if(cB.slid){var slices=document.getElementsByName(cB.id);if(slices&&slices.length>0){for(var i=0,len=slices.length;i<len;i++){if(slices[i].getAttribute("slid")==cB.slid){oParentDiv=slices[i];break;}}}}if(!oParentDiv){var oParentDivs=document.getElementById(cB.id);if(!oParentDivs&&(cB.dialog||cB.css=="1")){iframe.createPlaceHolder(cB.id);oParentDivs=document.getElementById(cB.id);}if(oParentDivs){if(oParentDivs.length>1){for(var i=0;i<oParentDivs.length;i++){if(oParentDivs[i].tagName=="DIV"){oParentDiv=oParentDivs[i];break;}}}else{oParentDiv=oParentDivs;}}}if(oParentDiv){var sReplaceHTML=cB.content.replace(/'/g,"'");if(cB.message=="true"){showMessage({contents:sReplaceHTML,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}var scriptArray=[],chartArray=[];var oDivNode=iframe.createElementFromHTML(sReplaceHTML);if(!oDivNode){return ;}iframe.extractScript(oDivNode,scriptArray);iframe.extractImage(oDivNode,chartArray);if(cB.errorInfo){var errorHolder=document.getElementById("errorInfo");if(errorHolder){errorHolder.innerHTML+=cB.errorInfo;}}if(cB.css=="1"){var styleId=oDivNode.getAttribute("styleid");if(!iframe.consolidatedStyles[styleId]){iframe.consolidatedStyles[styleId]=[];}iframe.consolidatedStyles[styleId]=consolidateStyleSheets(oDivNode,iframe.consolidatedStyles[styleId],styleId);}else{if(oParentDiv.getAttribute(mstrHTMLAttributes.ATTR_MODAL)=="true"||(oParentDiv.popupMask)){togglePulldowns(oParentDiv,true);}if(cB.partialUpdate=="true"&&oParentDiv.childNodes.length>1){oParentDiv.innerHTML=oDivNode.innerHTML;}else{if(bIsW3C&&!bIsIE8&&!bIsIE9&&!bIsIE10&&!bIsSafari){iframe.setOuterHTML(oParentDiv,oDivNode);}else{if(oParentDiv&&oDivNode){if(cB.isFlashVis&&bIsIE8){var o=oParentDiv.getElementsByTagName("object");if(o&&o.length>0){for(var i=0;i<o.length;i++){o[i].parentNode.removeChild(o[i]);}}}oParentDiv.parentNode.replaceChild(oDivNode,oParentDiv);}if(chartArray.length>0){for(var j=0,cnt=chartArray.length;j<cnt;j++){chartArray[j].src=chartArray[j].getAttribute("dsrc");}}}}for(var i=0,len=scriptArray.length;i<len;i++){eval(scriptArray[i].toString());}}}}catch(err){microstrategy.errors.log(err);}};mstr.Enum.ColorPickerFlags={NO_COLOR:1,MORE_COLORS:2,GRADIENT_COLORS:4,USER_COLORS:8,GRAPH_GRADIENTS:16,AUTOMATIC:32};mstr.Enum.AttrFormSelector={AUTOMATIC:1,CUSTOM:4,DEFAULT_SORT:1};mstr.bones={};mstr.bones.editors={};mstr.bones.editors.Map={};mstr.controllers.ExportTypes=(function(){var B={};B.exportSet=[{c:"Excel",d:"4",n:"3958",f:"web-export-to-excel;enable-export"},{c:"PDF",d:"3",n:"1877",f:"web-export-to-pdf;enable-pdf;document-html-view-mode"},{c:"HTML",d:"-1",n:"3957",f:"web-export-to-html;enable-html-export;document-html-view-mode"},{c:"Flash",d:"7",n:"14513",f:"rw-flash-view-mode-enabled;web-export-to-flash;enable-flash"}];B.getExportModes=function A(){var C={items:[],value:""};for(var E in this.exportSet){var D=this.exportSet[E];if(mstr.behaviors.featureResolver.resolveFeatSet(D.f)){C.items.push({dssid:D.d,n:microstrategy.descriptors.getDescriptor(D.n),cssClass:"ToolbarList x"+D.c});}}C.value=C.items[0]?C.items[0].dssid:"";return C;};return B;})();mstr.controllers.ZoomFactors=(function(){var C={};var A;C.getZoomFactors=function B(E,J,K){if(!A){A={items:[{n:"400%",dssid:"400"},{n:"300%",dssid:"300"},{n:"200%",dssid:"200"},{n:"150%",dssid:"150"},{n:"125%",dssid:"125"},{n:"100%",dssid:"100"},{n:"75%",dssid:"75"},{n:"50%",dssid:"50"},{n:"25%",dssid:"25"},{n:microstrategy.descriptors.getDescriptor("4809"),dssid:"Width"},{n:microstrategy.descriptors.getDescriptor("4808"),dssid:"Page"}]};}if(typeof (J)=="undefined"){return A;}if(K&&E!=microstrategy.ZOOM_STATIC){A.value=(E==microstrategy.ZOOM_FIT_WIDTH)?"Width":"Page";return A;}var H=[{n:J+"%",dssid:J}];var F=A.items;var D=0,I;for(;D<F.length-2;D++){I=parseInt(F[D].dssid);if(I==J){A.value=J;return A;}if(I<J){break;}}var G={};G.items=mstr.$A.insert(A.items,H,D);G.value=J;return G;};return C;})();mstr.models.ChangeTrackingModel=(function(){mstr.$O.extendsClass(G,mstr.models.BaseModel);G.prototype.init=function B(){mstr.models.BaseModel.prototype.init.apply(this);for(var I in this.props){var H=this.props[I];if(H instanceof mstr.models.ListModel){H.attachEventListener(this,"hashadd_selectedIndices","onHashAdd");H.attachEventListener(this,"hashremove_selectedIndices","onHashRemove");H.set("propName",I);}}};G.prototype.set=function F(J,I){var H=mstr.models.BaseModel.prototype.set.apply(this,[J,I]);if(H){this.changedProps[J]=I;}return H;};G.prototype.onHashAdd=function E(H){var I=H.src.get("propName");this._updateChangedProp(I);};G.prototype.onHashRemove=function A(H){var I=H.src.get("propName");this._updateChangedProp(I);};G.prototype._updateChangedProp=function C(K){var J=this.get(K);var M=J.get("valueForm");var L=J.getSelectedItems();var H="";for(var I=0;I<L.length;I++){H+=L[I][M]+"|";}if(H.charAt(H.length-1)=="|"){H=H.substring(0,H.length-1);}this.changedProps[K]=H;};G.prototype.getChanges=function D(){return this.changedProps;};function G(H){mstr.models.BaseModel.apply(this,[H]);this.changedProps={};}return G;})();mstr.models.ChangeTrackingModelManager=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.getChangesAsString=function C(G){var O="";var L;var N;var H;if(!G){G=UNIT_SEPARATOR;}for(var F in this.props){var E=this.props[F];N="";if(E instanceof mstr.models.ChangeTrackingModel){L=M.getChanges();for(var K in L){H=L[K];if(isNaN(H)){H='"'+H+'"';}N+=K+"="+L[K]+G;}N=N.substring(0,N.length-1);O+=N+G;}else{if(E instanceof mstr.models.ListModel){var J=E.props.items;for(var I=0;I<J.length;I++){var M=J[I];N="";if(M instanceof mstr.models.ChangeTrackingModel){L=M.getChanges();for(var K in L){H=L[K];if(isNaN(H)){H='"'+H+'"';}N+=K+"="+H+G;}if(N.charAt(N.length-1)==G){N=N.substring(0,N.length-1);}if(N.length>0){O+=N+G;}}}}}}if(O.charAt(O.length-1)==G){O=O.substring(0,O.length-1);}return O;};A.prototype.execSubmitChanges=function B(E){};A.prototype.execCancelChanges=function D(){};function A(E){mstr.models.BaseModel.apply(this,[E]);}return A;})();mstr.models.FilterDetailsEditor=(function(){mstr.$O.extendsClass(E,mstr.models.ChangeTrackingModelManager);E.prototype.PROPERTY_SET_NAME="FilterDetailsFormatProperties";E.prototype.PROPERTY_NAME="FilterDetailsFormat";E.prototype.getChangesAsString=function D(G){var J=mstr.models.ChangeTrackingModelManager.prototype.getChangesAsString.apply(this,[G]);J=this.updateRelatedProperties(J);if(!J||J.length==0){return J;}if(!G){G=UNIT_SEPARATOR;}var I=this.props.oldValue||"";var F;var H;var M;var N;var P;var O='\\s*\\b[A-Za-z]+\\b\\s*=\\s*([0-9]+|"[^"]*")\\s*';var L=J.split(G);for(var K=0;K<L.length;K++){M=L[K].indexOf("=");if(M==-1){continue;}F=L[K].substring(0,M);H=L[K].substring(M+1);if(F=="isComplex"){continue;}if(isNaN(H)){H=H.substring(1,H.length-1);if(H.indexOf("\\")>=0){H=H.replace("\\","\\\\");}if(H.indexOf('"')>=0){H=H.replace('"','\\",');}H='"'+H+'"';}N=I.indexOf(F);if(N>=0){P=I.substring(N);P=P.match(O);if(P){if(H!="-1"&&H!=""){I=I.replace(P[0],L[K]);}else{I=I.replace(P[0],"");}}}else{if(H!="-1"){I+=","+L[K];}}}if(I.charAt(0)==","){I=I.substring(1);}if(I.charAt(I.length-1)==","){I=I.substring(0,I.length-1);}return I;};E.prototype.execSubmitChanges=function B(H){var J=this.getChangesAsString(H);var G=microstrategy.updateManager;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var L=microstrategy.getViewerBone().doc;var F=[];if(L){if(!this.props.objId){L.processRWDocProperty(this.PROPERTY_NAME,J);}else{var K=mstrUpdateManager.createPropertyEditString(this.props.objId,this.PROPERTY_NAME,J);F.push(G.createActionObject(null,mstrUpdateManager.EDIT_PROPS,L.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,K],[]));F.push(G.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,L.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,K],[]));G.add(F);G.flushAndSubmitChanges();}}}else{var I=microstrategy.bone("UniqueReportID");var F=new Array();I.setReportProp(this.PROPERTY_SET_NAME,this.PROPERTY_NAME,J,F);G.add(F);G.flushAndSubmitChanges();}return true;};E.prototype.updateRelatedProperties=function C(F){var G=F.replace(" ","");if(G.indexOf("SBLT=-1")>=0){F+=UNIT_SEPARATOR+"CDLT=";}return F;};E.prototype.execCancelChanges=function A(){return true;};function E(F){mstr.models.ChangeTrackingModelManager.apply(this,[F]);}return E;})();mstr.models.TaskModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.execFetchBlock=function C(G,F,E){var D=this.props.requestContext;if(D&&D.id){this.cancelRequest(D.id);this.set("readyState",mstr.Enum.Widget.READYSTATE.CANCELLED);}this.waitingElement=F;this.submitRequest(G,E);};A.prototype.loadRequestResponse=function B(){var D=this.props.requestContext;var F=D&&D.response;if(!F||!F.data){if(this.get("readyState")!=mstr.Enum.Widget.READYSTATE.WAITING){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);}return ;}var G=F.data;this.set("models",G.get("models"));this.set("views",G.get("views"));var E=G.get("views")[0];E.set("element",this.waitingElement);E.set("document",this.waitingElement.ownerDocument);this.set("renderableView",E);this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);this.props.requestContext={};};function A(D){mstr.models.BaseModel.apply(this,[D]);}return A;})();mstr.models.SelectDataSetModel=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.setItems=function B(I){for(var J=0;J<I.length;J++){if(I[J].tp===microstrategy.DSSTYPE_FOLDER){I[J].did=I[J].dssid;}else{I[J].did=I[J].did||I[J].dssid;}}mstr.models.ListModel.prototype.setItems.apply(this,[I]);};C.prototype.execSelectDataset=function H(){var I=this.getSelectedItems();if(I==null){return false;}var K=this.get("oldDSID");var L=this.get("ReplaceAllDS");var J=(K&&(K.length>0))||L;this.get("opener").handleDatasetExplorer({items:I,formatting:this.get("addWithFormatting"),oldDSID:K,oldDSType:this.get("oldDSType"),ReplaceAllDS:L});return true;};C.prototype._showWarningMessage=function G(I){showMessage({contents:microstrategy.descriptors.getDescriptor(I),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});document.getElementById(currentModalEditor[0]).style.zIndex=9999;};C.prototype._updateCommandEnabledSelectDataset=function F(){this.set("CommandEnabledSelectDataset",(this.getSelectedItem()!=null));};C.prototype.on_hashadd_selectedIndices=function A(I){mstr.models.ListModel.prototype.on_hashadd_selectedIndices.apply(this,[I]);if(I&&I.src==this){this._updateCommandEnabledSelectDataset();}};C.prototype.on_hashremove_selectedIndices=function D(I){mstr.models.ListModel.prototype.on_hashremove_selectedIndices.apply(this,[I]);if(I&&I.src==this){this._updateCommandEnabledSelectDataset();}};C.prototype.execOpenImportData=function E(){var I=this,J=function J(K){if(!K||!K.length){return false;}I.get("opener").handleDatasetExplorer({items:K,oldDSID:I.get("oldDSID"),oldDSType:I.get("oldDSType"),ReplaceAllDS:I.get("ReplaceAllDS")});return true;};microstrategy.openDataImport({AnalysisId:microstrategy.bone("rwb_viewer").messageID,callback:J});};function C(I){mstr.models.ListModel.apply(this,[I]);this._updateCommandEnabledSelectDataset();}return C;})();mstr.models.AnnotationModel=(function(){mstr.$O.extendsClass(F,mstr.models.BaseModel);F.ADDITION_MAX_LENGTH=32000;F.NOTES_MAX_LENGTH=65535;F.prototype.execSetMode=function H(I){this.set("mode",I);};F.prototype.loadRequestResponse=function B(){var I=this.props.requestContext;var J=I&&I.response;if(!J||!J.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var K=J.data;if(I.memo.command=="fetch"||I.memo.command=="add"||I.memo.command=="save"){this.set("value",decode(K.annotation));}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};F.prototype.execSave=function C(){var I=new mstr.http.SaveAnnotationsInputs(this.get("objectID"),this.get("objectType"),this.get("value").substring(0,F.NOTES_MAX_LENGTH-this.get("postfixLen")),0);this.submitRequest(I,{command:"save"});return true;};F.prototype.execAdd=function E(I){var J=new mstr.http.SaveAnnotationsInputs(this.get("objectID"),this.get("objectType"),I.substring(0,F.ADDITION_MAX_LENGTH-this.get("addition").get("prefixLen")-this.get("addition").get("postfixLen")),1);this.submitRequest(J,{command:"add"});return true;};F.prototype.execFetch=function D(){var I=new mstr.http.GetAnnotationsInput(this.get("objectID"),this.get("objectType"),"GetAnnotationsStyle");this.submitRequest(I,{command:"fetch"});return true;};F.prototype.updateValue=function A(I){if(I!=this.get("value")){this.set("CommandEnabledValidateEdit",true);}};F.prototype.execValidateEdit=function G(I){return true;};function F(I){if(I.value){I.value=decode(I.value);}mstr.models.BaseModel.apply(this,[I]);this.set("CommandEnabledValidateEdit",false);}return F;})();mstr.models.AnnotationAddArea=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.execClear=function A(){this.set("value","");return true;};B.prototype.execValidateAdd=function C(E,F){return true;};B.prototype.updateValue=function D(E){this.set("CommandEnabledValidateAdd",true);};function B(E){mstr.models.BaseModel.apply(this,[E]);this.set("CommandEnabledValidateAdd",false);}return B;})();mstr.models.NotesIconModel=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.loadRequestResponse=function A(){var D=this.props.requestContext;var E=D&&D.response;if(!E||!E.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var F=E.data;this.set("hasAnnotation",F.hasAnnotation);this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};B.prototype.execCheck=function C(){this.set("hasAnnotation",false);var D=new mstr.http.GetAnnotationsInput(this.get("objectID"),this.get("objectType"),"CheckAnnotationsStyle");this.submitRequest(D,{});return true;};function B(D){mstr.models.BaseModel.apply(this,[D]);}return B;})();mstr.models.ColorPicker=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.init=function B(){mstr.models.ListModel.prototype.init.apply(this);var G=this.getItems()&&this.getItems()[0];if(G){this.set("hasColor",G[this.get("valueForm")]!="transparent");}};C.prototype.on_hashadd_selectedIndices=function E(G){mstr.models.ListModel.prototype.on_hashadd_selectedIndices.apply(this,[G]);var I=this.getSelectedItem();if(I){var H=this.set("actualColor",I[this.get("valueForm")]);}};C.prototype.execSelectValue=function D(G){if(G==null||G==""){G="#000000";}if(G!="transparent"&&G!="automatic"){G=G.toUpperCase();}if(mstr.models.ListModel.prototype.execSelectValue.apply(this,[G])){return true;}this.set("actualColor",G);this.execClearSelect();this.raiseEvent("hashremove_selectedIndices",{name:"selectedIndices",at:{}});return true;};C.prototype.set=function A(H,G){if(H=="actualColor"&&this.props.enableReselect&&this.props[H]==G){this.raiseEvent("set_"+H,{name:H,value:G,valueWas:G});return true;}else{return mstr.models.ListModel.prototype.set.apply(this,arguments);}};C.prototype.execInsertCustomColor=function F(Q){if(!Q||!this.getItems()||!this.getItems()[0]){return ;}var K=this.get("valueForm");var J=mstr.$H.clone(this.getItems()[0]);J[K]=Q;if(K!="n"){J.n=microstrategy.descriptors.getDescriptor("2133")+" "+Q;}var L=-1;var R=mstr.$A.len(this.props.items);var P=this.get("maxSize");if(P>-1&&P<=R){L=0;var I={min:P-1,max:R-1};this.removeItemsAtRanges([I],true);}this.execSingleSelect(this.insertItemsAt([J],L));this.set("hasColor",true);var M=microstrategy&&microstrategy.updateManager;if(M){var G="";var O="";var N=this.getItems();for(var H=0;H<8;H++){if(N[H][K]=="transparent"){break;}G+=O+N[H][K];O=",";}M.add([M.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,mstr.$obj("mstrPageInfo").get("beanPath"),["5003","5004"],["userPalette",G],[],null)],true);}};function C(G){mstr.models.ListModel.apply(this,[G]);}return C;})();mstr.models.AdvancedColorPicker=(function(){mstr.$O.extendsClass(C,mstr.models.BaseModel);C.monitoredFields=["color","rootColor","hex","r","g","b","h","s","v"];C.prototype.init=function I(){mstr.models.BaseModel.prototype.init.apply(this);for(var J=0;J<9;J++){this["on_set_"+C.monitoredFields[J]]=this.synchFields;}this.get("basicColors").attachEventListener(this,"set_actualColor","synchFields");this.getTarget()&&this.initFromTarget();};C.prototype.getTarget=function A(){return this.get("targetPath")?mstr.controllers.Factory.getPath(this.get("targetPath"),this):null;};C.prototype.initFromTarget=function B(){if(!this.getTarget()){return ;}this.set("color",this.getTarget().getCurrentColor());this.set("activeControlId",this.getTarget().getActiveControlId());};C.prototype.execUpdateTarget=function E(){if(!this.getTarget()){return ;}this.getTarget().exec("advColorPicker",this.get("activeControlId")+"|"+this.get("color"));};C.prototype.set=function H(M,K){mstr.models.BaseModel.prototype.set.apply(this,[M,K]);if(M=="opener"){var J=K&&K.getModel&&K.getModel();if(!J){return ;}var L=J.get("actualColor");if(L){L=L.split(",")[0];if(L=="transparent"){L="#ffffff";}else{if(L.charAt(0)!="#"){L="#"+L;}}this.set("color",L);}mstr.$obj("mstrPageInfo").get("userPalette").attachEventListener(this,"set_actualColor","synchFields");}if(M=="targetPath"){this.getTarget()&&this.initFromTarget();mstr.$obj("mstrPageInfo").get("userPalette").attachEventListener(this,"set_actualColor","synchFields");}};C.prototype.synchFields=function F(J){if(this.synchronizing){return ;}switch(J.name){case"set_color":this.synchronizing=true;var M=J.memo.value;this.set("hex",M.substr(1));var L=mstr.utils.Color.hex2rgb(M);this.set("r",L[0]);this.set("g",L[1]);this.set("b",L[2]);var K=mstr.utils.Color.rgb2hsv(L[0],L[1],L[2]);this.set("h",K[0]);this.set("s",K[1]);this.set("v",K[2]);this.set("rootColor","#"+mstr.utils.Color.hsv2hex(K[0],100,100));this.synchronizing=false;break;case"set_hex":this.set("color","#"+(this.get("hex")||"000000"));break;case"set_r":case"set_g":case"set_b":this.set("color","#"+mstr.utils.Color.rgb2hex(this.get("r"),this.get("g"),this.get("b")));break;case"set_h":case"set_s":case"set_v":this.set("color","#"+mstr.utils.Color.hsv2hex(this.get("h"),this.get("s"),this.get("v")));break;case"set_actualColor":var M=J.src.get("actualColor");if(M!="transparent"){this.set("color",M);}break;}};C.prototype.execDetachUserPalette=function G(J){mstr.$obj("mstrPageInfo").get("userPalette").detachEventListener(this,"set_actualColor");};C.prototype.execAddUserColor=function D(J){var L=this.get("color");if(this.get("basicColors").indexOfValue(L)!=-1){return ;}var K=mstr&&mstr.$obj("mstrPageInfo")&&mstr.$obj("mstrPageInfo").get("userPalette");if(!K||K.indexOfValue(L)!=-1){return ;}K.execInsertCustomColor(L);};function C(J){mstr.models.BaseModel.apply(this,[J]);}return C;})();mstr.models.GradientEditor=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.init=function D(){mstr.models.BaseModel.prototype.init.apply(this);this["on_set_gradient"]=this.gradientChange;this.get("color1").attachEventListener(this,"set_actualColor","gradientChange");this.get("color2").attachEventListener(this,"set_actualColor","gradientChange");this.get("gradientType").attachEventListener(this,"hashadd_selectedIndices","gradientChange");this.get("variants").attachEventListener(this,"hashadd_selectedIndices","gradientChange");};B.prototype.set=function A(I,G){mstr.models.BaseModel.prototype.set.apply(this,[I,G]);if(I=="opener"){var F=G&&G.getModel&&G.getModel();if(!F){return ;}var H=F.get("actualColor");if(H&&H.indexOf(",")>-1){this.set("gradient",H);}else{H=(H&&H!="transparent")?H.substr(1):"000000";this.set("gradient",H+",ffffff,14,0,0,0");}}};B.prototype.gradientChange=function C(Q){if(this.changingGradient){return ;}switch(Q.name){case"set_gradient":this.changingGradient=true;var I=Q.memo.value.split(",");this.get("color1").execSelectValue("#"+I[0]);this.get("color2").execSelectValue("#"+I[1]);var K,J,G;var L=I.slice(2).join(",");var F=this.get("variantsCache");var P=F.length+1;for(J=0,G=F.length;J<G;J++){var H=F[J];var S=H.indexOfValue(L);if(S!=-1){P=J+1;K=H;break;}}this.get("gradientType").execSelectValue(P);if(P==gradientUtil.GRADIENTSHADING_STYLE_CUSTOM){this.customGradientInit(L);}if(K){var R=mstr.utils.Hash.deepClone(K.getItems());for(J=0,G=R.length;J<G;J++){R[J].dssid=I[0]+","+I[1]+","+R[J].dssid;}var N=this.get("variants");N.setItems(R);N.execSelectValue(Q.memo.value);}this.changingGradient=false;break;case"set_actualColor":case"hashadd_selectedIndices":if(Q.src==this.get("variants")){this.changingGradient=true;this.set("gradient",this.get("variants").getSelectedItemValue());this.changingGradient=false;}else{var L=this.get("color1").get("actualColor").substr(1)+",";L+=this.get("color2").get("actualColor").substr(1)+",";var M=this.get("gradientType").getSelectedIndex();var O=this.get("variantsCache");if(!O[M]){return ;}L+=O[M].getSelectedItemValue();this.set("gradient",L);}break;}};B.prototype.customGradientInit=function E(F){};function B(F){mstr.models.BaseModel.apply(this,[F]);}return B;})();mstr.models.GraphGradientEditor=(function(){mstr.$O.extendsClass(E,mstr.models.GradientEditor);E.prototype.init=function B(){mstr.models.GradientEditor.prototype.init.apply(this);this.get("transitionType").attachEventListener(this,"hashadd_selectedIndices","customGradientChange");this.attachEventListener(this,"set_angle","customGradientChange");this.attachEventListener(this,"set_xOffset","customGradientChange");this.attachEventListener(this,"set_yOffset","customGradientChange");};E.prototype.customGradientChange=function D(F){var G=this.get("color1").get("actualColor").substr(1)+",";G+=this.get("color2").get("actualColor").substr(1)+",";G+=this.get("transitionType").getSelectedItemValue()+",";G+=this.get("angle")+","+this.get("xOffset")+","+this.get("yOffset");this.changingGradient=true;this.set("gradient",G);this.changingGradient=false;};E.prototype.customGradientInit=function A(F){var G=F.split(",");if(G.length==4){this.get("transitionType").execSelectValue(G[0]);this.set("angle",G[1]);this.set("xOffset",G[2]);this.set("yOffset",G[3]);}};E.prototype.gradientChange=function C(F){if(this.changingGradient){return ;}if(this.get("gradientType").getSelectedItemValue()==gradientUtil.GRADIENTSHADING_STYLE_CUSTOM){this.customGradientChange(null);return ;}mstr.models.GradientEditor.prototype.gradientChange.apply(this,arguments);};function E(F){mstr.models.GradientEditor.apply(this,[F]);}return E;})();mstr.models.Validator=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.setValidationStatus=function B(E){var D=this.get("parent");if(!D){return true;}if(E.length==0){D.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});return true;}var C=this.get("errMessage")||E;D.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.INVALID_ANSWERS,message:C,bubble:true});return false;};function A(C){mstr.models.BaseModel.apply(this,[C]);}return A;})();mstr.models.FieldValidator=(function(){mstr.$O.extendsClass(C,mstr.models.Validator);C.EXCEPTION_DELIMITER=";";C.prototype.intRegExp=/(^-?\d\d*$)/;C.prototype.validate=function B(M){var E="",J=this.props.descriptors;var K=false,F;if(this.get("exceptions")){F=mstr.utils.String.trimDelimited(C.EXCEPTION_DELIMITER+this.get("exceptions")+C.EXCEPTION_DELIMITER,C.EXCEPTION_DELIMITER);if(F.indexOf(mstr.utils.String.trimDelimited(C.EXCEPTION_DELIMITER+M+C.EXCEPTION_DELIMITER,C.EXCEPTION_DELIMITER))!=-1){K=true;}if(K){return this.setValidationStatus(E);}}var I=(M==null||(typeof (M)=="string"&&M.length==0));if(this.get("required")&&I){E=J.errRequired;}if(E.length==0&&!I){var G=rangeErr=regErr=0;var Q="";var L=this.get("max");var H=this.get("min");if(L=="x"){L=null;}if(H=="x"){H=null;}var P=this._resolveComparisonFields("lessThan");var O=this._resolveComparisonFields("greaterThan");var N=this.get("regEx");var D=this.get("type");if(H&&L||H&&P||L&&O||P&&O){Q=J.errMinMax;}else{if(H||O){Q=J.errMinOrGreater;}else{if(L||P){Q=J.errMaxOrLess;}else{if(N){Q=J.errRegEx;}else{if(D){Q=J.errType;}}}}}switch(D){case mstr.Enum.Nodes.DATATYPE.INTEGER:if((!this.intRegExp.test(M)&&!this.snRegExp.test(M))||parseInt(M,10)!=parseFloat(M)){Q=Q.replace("#",J.errTypeInt);G=1;}break;case mstr.Enum.Nodes.DATATYPE.FLOAT:if(!this.floatRegExp.test(M)&&!this.snRegExp.test(M)){Q=Q.replace("#",J.errTypeNum);G=1;}break;}if(!G){Q=Q.replace("# ","");}if((L||H)&&mstr.utils.Math.inNumericRange(M,H,L)){rangeErr=1;}if(H){Q=Q.replace("##",H);}if(L){Q=Q.replace("###",L);}if(!isNaN(P)){if(M>P||G){rangeErr=1;}Q=Q.replace("###",P);}if(!isNaN(O)){if(M<O||G){rangeErr=1;}Q=Q.replace("##",O);}if(N&&!(new RegExp(N,"g").test(M))){regErr=1;}if(G||rangeErr||regErr){E=Q;}}return this.setValidationStatus(E);};C.prototype._resolveComparisonFields=function A(K){var G=this.get(K);if(!G){return NaN;}var J=0;var D,F,E;var I=G.split("|");if(I[0]){var H=I[0].split(";");for(F=0,E=H.length;F<E;F++){D=mstr.$path(H[F],this.get("parent"));J+=parseFloat(D,10);}}if(I[1]){var L=I[1].split(";");for(F=0,E=L.length;F<E;F++){D=mstr.$path(L[F],this.get("parent"));J-=parseFloat(D,10);}}return J;};function C(D){mstr.models.Validator.apply(this,[D]);var E=mstr.controllers.Factory.getPath("userInfo/decimalSeparator",mstr.$obj("mstrPageInfo"));this.floatRegExp=new RegExp("(^-?\\d\\d*\\"+E+"\\d*$)|(^-?\\d\\d*\\"+E+"?\\d*e(\\+|-)\\d+$)|(^-?\\d\\d*$)|(^-?\\"+E+"\\d\\d*$)");this.snRegExp=new RegExp("^-?[1-9](\\"+E+"\\d+)?[Ee]([+-]?\\d+)$");}return C;})();mstr.models.ListValidator=(function(){mstr.$O.extendsClass(B,mstr.models.Validator);B.prototype.validate=function A(D,E){var C=this.get("parent").getModel();if(this.get("required")&&D=="ToggleSelect"){var F=[];if(C.getSelectedIndices()[E]&&C.getSelectedItems().length==1){F=[microstrategy.descriptors.getDescriptor("6076")];}return this.setValidationStatus(F);}return true;};function B(C){mstr.models.Validator.apply(this,[C]);}return B;})();mstr.models.RibbonToolbarModel=(function(){mstr.$O.extendsClass(D,mstr.models.ListModel);D.prototype.init=function B(){microstrategy.bones[this.getId()]=this;mstr.models.ListModel.prototype.init.apply(this,[]);if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){this.set("selectedToolbar",0);}this.selectToolbar();};D.prototype.onreload=function A(){var R=this.getSelectedItem();var P=this.getItems();for(var N=0,K=P.length;N<K;N++){var L=P[N];var M=L.visibleFeatures;var J=L.enabledFeatures;var Q=mstr.behaviors.featureResolver.resolveFeatSet(M,true);var O=mstr.behaviors.featureResolver.resolveFeatSet(J,true);if(Q&&!L.visible){this.get("toolbarModels").getItems()[N].execSynchronizeControls();}L.visible=Q;}if(!R.visible||!O){this.execSelectValue(0);}this.raiseEvent("featuresChanged");};D.prototype.onload=function C(){this.onreload();};D.prototype.selectToolbar=function H(){this.set("initializing",true);if(!this.execSelectValue(this.get("selectedToolbar"))){var J=0;while(!this.execSelectValue(J)){J++;}}this.set("initializing",false);};D.prototype.execSingleSelect=function G(L){mstr.controllers.EventManager.notifyWindowListeners({name:"closeMenus"});if(this.props.items[L].enabledFeatures){if(!mstr.behaviors.featureResolver.resolveFeatSet(this.props.items[L].enabledFeatures)){return false;}}mstr.models.ListModel.prototype.execSingleSelect.call(this,L);if((mstrUpdateManager.SET_REPORT_SELECTED_RIBBON||mstrUpdateManager.SET_RW_SELECTED_RIBBON)&&!this.get("initializing")){var K=microstrategy.updateManager;if(!this.action){this.action=K.createActionObject(null,mstrUpdateManager.SET_REPORT_SELECTED_RIBBON||mstrUpdateManager.SET_RW_SELECTED_RIBBON,this.get("beanPath").replace("mstrWeb",microstrategy.servletName),["120005"],[],[],null);K.add([this.action],true);}this.action.newArgs=[this.getSelectedItemValue()];}var J=this.get("toolbarModels");J.execSingleSelect(L);if(J.getSelectedItem().get("requestToolbar")){this.requestToolbar(L);}return true;};D.prototype.requestToolbar=function I(K){var J=this.props.requestContext;if(J&&J.id){this.cancelRequest(J.id);}var L=new mstr.http.LoadToolbarInput();L.params.viewer=this.get("targetPath");L.params.toolbarName=this.getItems()[K]["toolbarName"];L.params.ribbonListName=this.get("ribbonListName");this.submitRequest(L,{index:K});};D.prototype.on_set_readyState=function F(J){if(J.memo.value==mstr.Enum.Widget.READYSTATE.ERROR){microstrategy.handleTaskModelError(J);}mstr.models.ListModel.prototype.on_set_readyState.apply(J);};D.prototype.loadRequestResponse=function E(){var M=this.props.requestContext;var N=M&&M.response;if(!N||!N.data){return ;}var K=N.data.props.n;var R=this.get("toolbarModels");var O=R.getItems();var Q=M.memo.index;var S=K.getItems();for(var L=0,J=S.length;L<J;L++){if(S[L].set){S[L].set("parent",O[Q]);}}var P=K.get("targetPath");if(P){O[Q].set("targetPath",P);}O[Q].setItems(S);O[Q].set("requestToolbar",false);this.props.requestContext={};};function D(J){mstr.models.ListModel.apply(this,[J]);}return D;})();mstr.models.Toolbar=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.queueStatus={};C.prototype.init=function G(J){if(!this.props.targetPath){var N=this.getAncestorByProperty("targetPath",true);if(N){this.props.targetPath=N.get("targetPath");}}if(this.props.targetPath){var K=this.get("items");for(var M=0,L=K.length;M<L;M++){if(!K[M].targetPath){mstr.controllers.Factory.safeset(K[M],"targetPath",this.props.targetPath);}}}mstr.models.ListModel.prototype.init.apply(this,arguments);};C.prototype.clearQueuedValues=function B(K,J){if(!this.queue){return ;}var L=this.queue[K];if(!L){return ;}if(J){delete L[J];if(mstr.utils.Hash.isEmpty(L)){delete this.queue[K];}}else{delete this.queue[K];}this.set("CommandEnabledSubmitQueue",!this.get("CommandEnabledSubmitQueue"));};C.prototype.queueValue=function E(M,K,L){var J=this.queue||{};var N=J[M]||{};N[K]=L;J[M]=N;this.queue=J;this.set("CommandEnabledSubmitQueue",!this.get("CommandEnabledSubmitQueue"));};C.prototype.execSubmitQueue=function F(K){if(!this.isQueueStatusValid(K)){return ;}var L=mstr.controllers.Factory.getPath(this.get("targetPath"),this);var J=L&&L.commands&&L.commands.exec(K,this.queue[K]);this.clearQueuedValues(K);};C.prototype.queryCommandEnabled=function A(K,J){if(K=="SubmitQueue"&&J&&J[0]){return this.isQueueStatusValid(J[0]);}else{return mstr.models.BaseModel.prototype.queryCommandEnabled.apply(this,arguments);}};C.prototype.setQueueValidationStatus=function D(K,J){this.queueStatus[K]=J;this.set("CommandEnabledSubmitQueue",!this.get("CommandEnabledSubmitQueue"));};C.prototype.isQueueStatusValid=function I(J){return this.queue&&this.queue[J]&&!(this.queueStatus[J]>mstr.Enum.Validation.STATUSCODE.VALID);};C.prototype.execSynchronizeControls=function H(){var J=this.getItems();for(var L=0,K=J.length;L<K;L++){var M=J[L].get&&J[L].get("toolbarHelper");if(M){M.synchronizeControl();}}};function C(J){mstr.models.ListModel.apply(this,[J]);}return C;})();mstr.models.TextBoxModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.submitParentQueue=function B(){var C=this.props&&this.props.parent&&this.props.parent.execSubmitQueue;if(C&&this.props.queueGroup){this.props.parent.execSubmitQueue(this.props.queueGroup);}};function A(C){mstr.models.BaseModel.apply(this,[C]);}return A;})();mstr.models.ToolbarControlHelper=(function(){mstr.$O.extendsClass(TCH,mstr.models.BaseModel);TCH.prototype.init=function TCH_init(excludedProps){mstr.models.BaseModel.prototype.init.apply(this,arguments);var path=this.get("parent").get("targetPath");if(!path){return ;}this.set("targetPath",path);var that=this;var fn=function(){that.synchronizeControl();};var methods=this.get("parent").get("listenerMethods").split(",");for(var i=0,cnt=methods.length;i<cnt;i++){this[methods[i]]=fn;}if(this.get("targetPath")&&!this.getTarget()){this.synchronizeControl();var h=window.setInterval(function(){if(that.attachToTarget()){window.clearInterval(h);}},100);return ;}this.attachToTarget();};TCH.prototype.attachToTarget=function TCH_attachToTarget(){var target=this.getTarget();if(!target){return false;}this.synchronizeControl();var zz=target.observer&&target.observer.register(this.get("id"));return true;};TCH.prototype.getCmdId=function(){var parent=this.get("parent");return parent&&parent.get("cmdid");};TCH.prototype.getTarget=function(){return mstr.controllers.Factory.getPath(this.get("targetPath"),this);};TCH.prototype.synchronizeControl=function TCH_synchronizeControl(){var target=this.getTarget();var cmdId=this.getCmdId();var b=this.get("visible");var parent=this.get("parent");var vFeatures=parent.get("visibleFeatures");if(vFeatures){b=mstr.behaviors.featureResolver.resolveFeatSet(vFeatures);}if((cmdId&&target)&&(!vFeatures||b)){b=target.commands.queryVisible(cmdId);}this.set("visible",b);if(!b){return false;}b=this.get("enabled");var eFeatures=parent.get("enabledFeatures");if(eFeatures){b=mstr.behaviors.featureResolver.resolveFeatSet(eFeatures);}else{if(cmdId&&target){b=target.commands.queryEnabled(cmdId);}}this.set("enabled",b);return b;};TCH.prototype._getCustomizationInfo=function TCH__getCustomizationInfo(n){return this.get("parent").get(n);};TCH.prototype.processCustomizations=function TCH_processCustomizations(){var ext=this._getCustomizationInfo("extra-url");if(ext){microstrategy.updateManager.addURL(ext);}var js=this._getCustomizationInfo("on-click");if(js){eval(js);}this.execHyperlink(this._getCustomizationInfo("link"),ext);this.execEvent(this._getCustomizationInfo("event"),ext);};TCH.prototype.execHyperlink=function TCH_execHyperlink(link,extraUrl){if(!link){return ;}var h=link.href;if(!h){return ;}var p=link.params;if(link["append-state"]||p){if(!(/\?$/.test(h))){h+="?";}if(link["append-state"]){h=updateLink(h);}h=this._parameterizeUrl(h,p);}if(extraUrl){h+="&"+extraUrl;}var t=this._resolveTarget(link);window.open(h,t);};TCH.prototype.execEvent=function TCH_execEvent(evt,extraUrl){if(!evt){return ;}var p=this.getAncestorByProperty("evtInfo");if(!p){p=this.getAncestorByProperty("ribbonId");p=mstr.$obj(p.get("ribbonId")).getAncestorByProperty("evtInfo",true);}var h=p&&p.get("evtInfo").get(evt["action-id"]);if(!h){return ;}if(evt.iframe){h+="&iframe=true";}var t=this._resolveTarget(evt);if(evt["append-state"]){submitLink({href:h,target:t});}else{if(extraUrl){h+="&"+extraUrl;}window.open(h,t);}};TCH.prototype._parameterizeUrl=function TCH__parameterizeUrl(h,p){if(!p){return h;}var delim=(/\?$/.test(h))?"":"&";var parent=this.get("parent");for(var i=0,cnt=p.length;i<cnt;i++){var v=mstr.controllers.Factory.getPath(p[i].value,parent);v=(v!=undefined)?v:p[i].value;h+=delim+escape(p[i].n)+"="+escape(v);delim="&";}return h;};TCH.prototype._resolveTarget=function TCH__resolveTarget(info){var t="_self";if(info.target){t=info.target;}else{if(info.iframe){t="frameManager";}else{if(info["use-window-open"]){t="_blank";}}}return t;};function TCH(props){mstr.models.BaseModel.apply(this,[props]);}return TCH;})();mstr.models.ToolbarButtonHelper=(function(){mstr.$O.extendsClass(B,mstr.models.ToolbarControlHelper);B.prototype.execPressed=function A(){var D=this.getCmdId();if(D){var E=this.getTarget();var C=E&&E.commands&&E.commands.exec(D);}this.processCustomizations();};function B(C){mstr.models.ToolbarControlHelper.apply(this,[C]);}return B;})();mstr.models.ToolbarDualStateButtonHelper=(function(){mstr.$O.extendsClass(C,mstr.models.ToolbarButtonHelper);C.prototype.synchronizeControl=function A(){if(!mstr.models.ToolbarButtonHelper.prototype.synchronizeControl.apply(this,arguments)){return false;}var D=this.getTarget();this.get("parent").set("state",D&&D.commands.queryState(this.getCmdId()));};C.prototype.execPressed=function B(){var F=this.get("parent");var H=!F.get("state");F.set("state",H);var E=this.getCmdId();if(E){var G=this.getTarget();var D=G&&G.commands&&G.commands.exec(E,H);}this.processCustomizations();};function C(D){mstr.models.ToolbarButtonHelper.apply(this,[D]);}return C;})();mstr.models.ToolbarListHelper=(function(){mstr.$O.extendsClass(B,mstr.models.ToolbarControlHelper);B.prototype.init=function F(H){mstr.models.ToolbarControlHelper.prototype.init.apply(this,arguments);var I=this.get("parent");I.attachEventListener(this,"hashadd_selectedIndices","updateTarget");};B.prototype._getCustomizationInfo=function A(J){var I=this.get("parent");var H=I&&I.getSelectedItem();return(H&&mstr.controllers.Factory.safeget(H,J))||I.get(J);};B.prototype.updateTarget=function C(J){if(this.get("synchronizing")){return ;}var M=this.get("parent");var K=M.getSelectedItem();if(!K){return ;}var I=this.getCmdId();if(I){var L=this.getTarget();var H=L.commands&&L.commands.exec(I,K[M.get("valueForm")]);}this.processCustomizations();};B.prototype.synchronizeControl=function G(){if(!mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){return false;}var J=this.getTarget();var I=J&&J.commands.queryState(this.getCmdId());if(!I){return true;}this.set("synchronizing",true);this.checkItemFeatures();var H=(mstr.$A.isArray(I))?"execSelectValues":"execSelectValue";var K=this.get("parent")[H](I);if(!K){this.get("parent").execClearSelect();}this.set("synchronizing",false);return true;};B.prototype.checkItemFeatures=function E(){if(this.get("noFeatures")){return ;}var K,J;var M=this.get("parent");var N=this.get("cachedItems");if(!N){var I=M.getItems();var H=false;for(K=0,J=I.length;K<J;K++){if(I[K]["visibleFeatures"]){H=true;break;}}if(H){N=mstr.utils.Hash.deepClone(M.getItems());this.set("cachedItems",N);}else{this.set("noFeatures",true);return ;}}N=mstr.utils.Hash.deepClone(N);for(K=N.length-1;K>=0;K--){var L=N[K]["visibleFeatures"];if(!L){continue;}if(!mstr.behaviors.featureResolver.resolveFeatSet(L)){N.splice(K,1);}}M.setItems(N);};B.prototype.pickerButtonPushed=function D(){if(this.get("parent").get("updateOnClick")){this.updateTarget();this.synchronizeControl();return true;}else{return false;}};function B(H){mstr.models.ToolbarControlHelper.apply(this,[H]);}return B;})();mstr.models.ToolbarCheckListHelper=(function(){mstr.$O.extendsClass(G,mstr.models.ToolbarListHelper);G.prototype.init=function D(H){mstr.models.ToolbarListHelper.prototype.init.apply(this,arguments);var I=this.get("parent");I.attachEventListener(this,"hashremove_selectedIndices","cacheAction");I.attachEventListener(this,"hashadd_selectedIndices","cacheAction");};G.prototype.cacheAction=function B(H){if(this.get("synchronizing")){return ;}var I=this._killUpdateTimeout();I.push(this._packageValue(mstr.utils.Arrays.fromHashKeys(H.memo.at,true),(H.name=="hashadd_selectedIndices")));this._setUpdateTimeout(I);};G.prototype.updateTarget=function F(){if(this.get("synchronizing")){return ;}var J=this.get("parent").get("lastSelection");var K=this.get("updateCache")||[this._packageValue(J?[J]:[],true)];this.set("updateCache",null);var I=this.getCmdId();if(I){var L=this.getTarget();var H=L.commands&&L.commands.exec(I,K);}};G.prototype._packageValue=function C(O,H){H=!!H;var N=this.get("parent");var K=N.getItems();var I=N.get("valueForm");var J=[];for(var M=0,L=O.length;M<L;M++){J.push(K[O[M]][I]);}return{cl:H,v:J};};G.prototype._killUpdateTimeout=function A(){if(this.get("updateHandle")){window.clearTimeout(this.get("updateHandle"));this.set("updateHandle",null);if(!!!this.get("discardQueue")){return this.get("updateCache");}}return[];};G.prototype._setUpdateTimeout=function E(H){this.set("updateCache",H);this.set("updateHandle",window.setTimeout('mstr.$obj("'+this.getId()+'").updateTarget();',0));};function G(H){mstr.models.ToolbarListHelper.apply(this,[H]);}return G;})();mstr.models.ToolbarDynamicListHelper=(function(){mstr.$O.extendsClass(A,mstr.models.ToolbarListHelper);A.prototype.synchronizeControl=function B(){if(!mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){return false;}var D=this.getTarget();var C=D.commands.queryState(this.getCmdId());this.set("synchronizing",true);this.get("parent").setItems(C.items);var E=this.get("parent").execSelectValue(C.value);if(!E){this.get("parent").execClearSelect();}this.set("synchronizing",false);return true;};function A(C){mstr.models.ToolbarListHelper.apply(this,[C]);}return A;})();mstr.models.ToolbarColorPickerHelper=(function(){mstr.$O.extendsClass(D,mstr.models.ToolbarControlHelper);D.prototype.init=function C(F){mstr.models.ToolbarControlHelper.prototype.init.apply(this,arguments);var G=this.get("parent");G.attachEventListener(this,"set_actualColor","updateTarget");};D.prototype.updateTarget=function B(F){if(this.get("synchronizing")){return ;}var G=F.memo.value;this.get("parent").set("lastColor",G);this.getTarget().commands.exec(this.getCmdId(),G);};D.prototype.synchronizeControl=function A(){if(!mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){return ;}var G=this.getTarget();var F=G.commands.queryState(this.getCmdId());this.set("synchronizing",true);this.get("parent").execSelectValue(F);this.set("synchronizing",false);F=G.commands.queryState(this.getCmdId()+"_vf");if(F!=""){this.get("parent").set("popup|viewFlags",F);}};D.prototype.pickerButtonPushed=function E(){var G=this.get("parent");var F=G.get("lastColor");if(F){G.set("actualColor",F);this.synchronizeControl();}return true;};function D(F){mstr.models.ToolbarControlHelper.apply(this,[F]);}return D;})();mstr.models.ToolbarTextBoxHelper=(function(){mstr.$O.extendsClass(D,mstr.models.ToolbarControlHelper);D.prototype.init=function A(){mstr.models.ToolbarControlHelper.prototype.init.apply(this,arguments);var E=this.get("parent");E.attachEventListener(this,"set_value","queueValue");};D.prototype.queueValue=function C(E){if(this.get("synchronizing")){return ;}var F=E.memo.value;var G=this.get("parent");var H=G.get("parent");H.queueValue(G.get("queueGroup"),this.getCmdId(),F);};D.prototype.synchronizeControl=function B(){var E=this.get("parent");E.get("parent").clearQueuedValues(E.get("queueGroup"),this.getCmdId());var F="";if(mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){var G=this.getTarget();F=G.commands.queryState(this.getCmdId())||"";}this.set("synchronizing",true);this.get("parent").set("value",F);this.set("synchronizing",false);};function D(E){mstr.models.ToolbarControlHelper.apply(this,[E]);}return D;})();mstr.models.ToolbarButtonModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.DEFAULTS={tooltip:"",enabled:true,visible:true};function A(B){mstr.models.BaseModel.apply(this,[B]);}return A;})();mstr.models.BlockContainer=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.init=function A(){mstr.models.BaseModel.prototype.init.call(this,["models","views"]);var D,G,F,C;var E=this.props[mstr.$W.DOCUMENT];G=this.props.models;for(D=0;G&&G.length&&D<G.length;D++){F=G[D][mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(G[D],E);if(F){G[D]=F;C=F.props&&(F.props[mstr.$W.PARENT]=this);C=F.init&&F.init();}}G=this.props.views;for(D=0;G&&G.length&&D<G.length;D++){F=G[D][mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(G[D],E);if(F){G[D]=F;C=F.props&&(F.props[mstr.$W.PARENT]=this);C=F.init&&F.init();}}};function B(C){mstr.models.BaseModel.apply(this,[C]);}return B;})();mstr.models.InsertLayoutEditor=(function(){mstr.$O.extendsClass(D,mstr.models.BaseModel);D.prototype.init=function C(){this.props.existingLayouts.styleName="WidgetFolderStyle";mstr.models.BaseModel.prototype.init.call(this,["models","views"]);var H=["tabList","newDashboardLayouts","newDocumentLayouts","existingLayouts"];for(var G=0;G<4;G++){var F=this.get(H[G]);F.attachEventListener(this,"hashadd_selectedIndices","updateCommandEnabledSubmitModel");F.attachEventListener(this,"hashremove_selectedIndices","updateCommandEnabledSubmitModel");}};D.prototype.updateCommandEnabledSubmitModel=function A(){this.set("CommandEnabledSubmitModel",(this._getSelectedItem()!=null));};D.prototype.execSubmitModel=function B(){var H=this._getSelectedItem();if(!H){return false;}var I=mstr.$obj(this.props.boneId);if(I){I.commands.exec("unloadDocViewer");}var G=this.get("tabList").getSelectedIndex()!=2?"1":"0";var F=microstrategy.updateManager;F.add([F.createActionObject(null,mstrUpdateManager.RW_IMPORT_DOC,mstr.$obj("mstrPageInfo").get("beanPath"),["2048001","2048175"],[H.dssid,G])]);F.flushAndSubmitChanges();return true;};D.prototype._getSelectedItem=function E(){var F=this.get("tabList").getSelectedIndex();if(F==NaN||F==-1){return null;}if(F==0){p="newDashboardLayouts";}else{if(F==1){p="newDocumentLayouts";}else{if(F==2){p="existingLayouts";}}}return this.get(p).getSelectedItem();};function D(F){mstr.models.BaseModel.apply(this,[F]);}return D;})();mstr.models.ContextMenuModel=(function(){mstr.$O.extendsClass(CMM,mstr.models.BaseModel);CMM.prototype.execPopulate=function CMM_execPopulate(){if(this.gridMenuItemsMap[this.getGridKey()]==null){var ondemandMenusRequestInputs=null;ondemandMenusRequestInputs=new mstr.http.OndemandContextMenuInputs(this.getGridKey());this.submitRequest(ondemandMenusRequestInputs,{});}else{this.raiseEvent("set_menu_ready",null);}};CMM.prototype.clearMenuItems=function CMM_clearMenuItems(gridKey){this.gridMenuItemsMap[gridKey]=null;this.submittedGridKeys[gridKey]=null;};CMM.prototype.submitRequest=function CMM_submitRequest(reqInputs,memo){this.raiseEvent("set_menu_processing",null);if(this.submittedGridKeys[this.getGridKey()]==null){var id=mstr.models.BaseModel.prototype.submitRequest.apply(this,[reqInputs,memo]);this.submittedGridKeys[this.getGridKey()]=id;}};CMM.prototype.setGridKey=function CMM_setGridKey(key){this.gridKey=key;};CMM.prototype.getGridKey=function CMM_getGridKey(){return this.gridKey;};CMM.prototype.setCurrentDynamicMenuKey=function CMM_setCurrentDynamicMenuKey(key){this.currentDynamicMenuKey=key;};CMM.prototype.getCurrentDynamicMenuKey=function CMM_getCurrentDynamicMenuKey(){return this.currentDynamicMenuKey;};CMM.prototype.onRequestCallback=function CMM_onRequestCallback(req){mstr.models.BaseModel.prototype.onRequestCallback.apply(this,[req]);switch(this.props.readyState){case mstr.Enum.Widget.READYSTATE.ERROR:this.raiseEvent("set_hide_menu_processing",null);this.submittedGridKeys[this.getGridKey()]=null;break;}};CMM.prototype.loadRequestResponse=function CMM_loadRequestResponse(){var ctxt=this.props.requestContext;var data=ctxt&&ctxt.response&&ctxt.response.data;if(!data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);this.submittedGridKeys[this.getGridKey()]=null;return ;}if(data.dynamicMenus&&data.menuItems){var dyn_avItems=eval(data.dynamicMenus);var gridKey=this.getGridKey();for(var i=0;i<dyn_avItems.length;i++){var dynamicMenuKey=dyn_avItems[i][0];this.dynamicMenusMap[gridKey+dynamicMenuKey]=dyn_avItems[i][1];}this.gridMenuItemsMap[gridKey]=eval(data.menuItems);}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);this.raiseEvent("set_hide_menu_processing",null);this.raiseEvent("set_menu_ready",null);};CMM.prototype.getMenuItems=function CMM_getMenuItems(){return this.gridMenuItemsMap[this.getGridKey()];};CMM.prototype.getCurrentMenuItemIndices=function(){var hashKey=this.getGridKey()+this.getCurrentDynamicMenuKey();return this.dynamicMenusMap[hashKey]||null;};function CMM(props){mstr.models.BaseModel.apply(this,[props]);this.gridMenuItemsMap=[];this.dynamicMenusMap=[];this.currentDynamicMenuKey=null;this.gridKey=null;this.submittedGridKeys=[];}return CMM;})();mstr.models.ToolbarPickerListModel=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.on_hashadd_selectedIndices=function B(E){this._storeLastSelection(E);mstr.models.ListModel.prototype.on_hashadd_selectedIndices.apply(this,arguments);};C.prototype.on_hashremove_selectedIndices=function A(E){this._storeLastSelection(E);mstr.models.ListModel.prototype.on_hashremove_selectedIndices.apply(this,arguments);};C.prototype._storeLastSelection=function D(E){var F=this.get("toolbarHelper");if(!F||!F.get||F.get("synchronizing")){return ;}this.set("lastSelection",mstr.utils.Hash.firstKey(E.memo.at));};function C(E){mstr.models.ListModel.apply(this,[E]);}return C;})();mstr.models.ToolbarBorderListModel=(function(){mstr.$O.extendsClass(B,mstr.models.ToolbarPickerListModel);B.prototype.execToggleSelect=function A(C){var F=this.props.selectedIndices;if(F[C]){if(C<2){return false;}else{if(F[0]){this.execRemoveSelect(0);}}this.execRemoveSelect(C);if(!F[2]&&!F[3]&&!F[4]&&!F[5]){C=1;this.execAddSelect(C);}}else{if(C==1){this.execClearSelect();}else{if(F[1]){this.execRemoveSelect(1);}if(C==0){for(var D=2;D<6;D++){if(!F[D]){this.execAddSelect(D);}}}else{var E=mstr.utils.Hash.clone(F);E[C]=true;if(E[2]&&E[3]&&E[4]&&E[5]){this.execAddSelect(0);}}}this.execAddSelect(C);}this.set("leadIndex",C);return true;};function B(C){mstr.models.ToolbarPickerListModel.apply(this,[C]);}return B;})();mstr.behaviors.TriStateCheckBox=(function(){var B={};B._DISABLED="Disabled";B._INTERMEDIATE="Intermediate";B._ON="On";B._OFF="Off";B.on_set_enabled=function D(F,G,J){var H=J.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0];var E=J.childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0];var I=F.props.cssPrefix+F.props.cssClass;if(F.props.enabled==false){H.className=I+this._DISABLED;E.className=I+"Caption"+this._DISABLED;return ;}else{this.setTriState(F,G,J);}};B.on_model_hashadd_selectedIndices=function C(E,F,G){if(E.get("enabled")){this.setTriState(E,F,G);}};B.setTriState=function A(H,I,L){var J=L.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0];var G=L.childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0];var K=H.props.cssPrefix+H.props.cssClass;var E=I.getSelectedIndex();var F=I.props.items[E].cssClass;switch(E){case 0:J.className=K+(F||this._INTERMEDIATE);break;case 1:J.className=K+(F||this._ON);G.className=K+"Caption"+(F||this._ON);break;case 2:J.className=K+(F||this._OFF);G.className=K+"Caption"+(F||this._OFF);break;}};return B;})();mstr.behaviors.ToolbarPickerButton=(function(){var C=mstr.$H.clone(mstr.behaviors.Pulldown);C.on_set_enabled=function B(F,H,J){var G=!!F.props.enabled;J.disabled=!G;var I="0px",E="0px";if(!G){I="20px";E="22px";}var D=J.childNodes[1].rows[0].cells[1].firstChild.childNodes[3];D.style.height=I;D.style.width=E;};C.pickerButtonPushed=function A(E){var F=mstr.$obj(E);if(!F.get("enabled")){return ;}var D=F.getModel();var G=D.get("toolbarHelper");if(G&&G.pickerButtonPushed&&!G.pickerButtonPushed()){mstr.behaviors.ToolbarPickerButton.onmousedown(E);}};return C;})();mstr.behaviors.ColorPickerPopup=(function(){var A={elements:{0:mstr.Enum.ColorPickerFlags.NO_COLOR,1:mstr.Enum.ColorPickerFlags.AUTOMATIC,3:mstr.Enum.ColorPickerFlags.USER_COLORS,4:mstr.Enum.ColorPickerFlags.MORE_COLORS,5:mstr.Enum.ColorPickerFlags.GRADIENT_COLORS,6:mstr.Enum.ColorPickerFlags.GRAPH_GRADIENTS}};A.resolveViewFlags=function B(D){var C=D.props.viewFlags;for(var E in A.elements){if(!!(C&A.elements[E])){D._showChildViewAtPath("children/"+E);}else{mstr.controllers.Factory.safeset(D.props.children[E],"visible",false);}}};return A;})();mstr.itemrenderers.FastTileView=(function(){var B=mstr.$H.clone(mstr.itemrenderers.FastListView);B.renderListItem=function A(L,F,P,D,C){var R=D.item;var U=L.props[mstr.$W.DOCUMENT];var J=(L.props.cssPrefix||"")+(L.props.itemCSSPrefix||"");if("enabled" in R&&!R.enabled){J+="Disabled";}var G=U.createElement("div");if(R.cssClass){G.className=R.cssClass+" "+J;}else{G.className=J;}if(R.cssText){G.style.cssText=R.cssText;}if(R.desc!=null&&R.desc!=""){G.title=R.n+". "+R.desc;}else{G.title=R.n||"";}var V=U.createElement("div");G.appendChild(V);V.className=J+"Name";if(L.props.showDescriptions&&R.desc){var O=U.createElement("div");G.appendChild(O);O.className=J+"Desc";O.appendChild(U.createTextNode(R.desc));}else{var O=null;}if(L.props.itemCSSPrefix!="TileViewItem"){var T=U.createTextNode(R.n||"");var S=D.browseCommand;if(S&&!R.locked){var K=U.createElement("a");V.appendChild(K);K.appendChild(T);K.href="javascript:void(0)";S=null;}else{V.appendChild(T);}}if(L.props.showIcons&&!C){var Q=R.icon;if(R.locked){Q+="_locked";}var H=U.createElement("div");H.className="mstrTileViewImgContainer";V.appendChild(H);var I;if(!Q){var N=microstrategy.bones.ribbon_graphToolbar.block.get("major").getSelectedItems();if(N){var E=mstr.Settings.Scheme.LARGEPREVIEWS[N[0].icon];I=E+"_"+R.dssid;H.className+=" "+E+"_subtype";}}else{I=mstr.Settings.Scheme.LARGEPREVIEWS[Q];}if(I){if(I.substr(0,5)=="graph"&&Q){H.className+=" graphBgImg";}H.className+=" "+I;if(L.props.itemCSSPrefix!="TileViewItem"){V.style.paddingLeft="23px";if(O){O.style.paddingLeft="23px";}}}else{if(Q){H.className+=" "+Q;if(L.props.itemCSSPrefix!="TileViewItem"){V.style.paddingLeft="23px";if(O){O.style.paddingLeft="23px";}}}}var M=U.createElement("div");M.className=J+"NameImg";H.appendChild(M);M.onmouseover=this.hover;M.onmouseout=this.unhover;}return G;};return B;})();mstr.itemrenderers.PreviewPickerView=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListPulldownView);A.renderListItem=function(B,D,I,E){var C=mstr.itemrenderers.FastTileView.renderListItem(B,D,I,E,true);var H=this._getContentContainer(I);mstr.utils.Dom.clearChild(H,0);H.appendChild(C);H.title=C.title||"";if(mstr.utils.ISIE4){var F=H.style,G=F.width;if(G==null){G="";}F.width="1px";F.width=G;}};return A;})();mstr.itemrenderers.ColorPickerView=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListPulldownView);A.renderListItem=function(B,C,E,D){this._renderItem(B,C,E,D.item);};A.renderEmpty=function(C,D,H,E){var G=D&&D.get("actualColor");if(G){var B=D.get("valueForm");var F={};F[B]=G;if(B!="n"){F.n=microstrategy.descriptors.getDescriptor("2133")+" "+G;}this._renderItem(C,D,H,F);}else{mstr.itemrenderers.ListPulldownView.renderEmpty(C,D,H,E);}};A._renderItem=function(E,C,J,I){var F=E.props[mstr.$W.DOCUMENT];var D=(E.props.cssPrefix||"")+(E.props.itemCSSPrefix||"");var B=F.createElement("div");B.className=D+"ColorItem";var G=I[C.get("valueForm")];if(G!=null&&G.indexOf(",")>-1){mstr.itemrenderers.GradientItem.renderGradientItem(B,G,80,12);}else{if(G!="#"&&(!(bIsIE6||bIsIE7||bIsIE8||bIsIE9)||G!="0")){B.style.backgroundColor=(G!="automatic")?G:"transparent";}if(I.n){B.setAttribute("title",I.n);}if(G.toLowerCase()=="transparent"||G.toLowerCase()=="automatic"){B.style.border="1px dashed #999999";}}var H=this._getContentContainer(J);mstr.utils.Dom.clearChild(H,0);H.appendChild(B);};return A;})();mstr.itemrenderers.ColorPickerListView=(function(){var C=mstr.$H.clone(mstr.itemrenderers.ListView);C.renderListItem=function(I,E,M,D){var L=D.item;var K=I.props[mstr.$W.DOCUMENT];var G=(I.props.cssPrefix||"")+(I.props.itemCSSPrefix||"");var H=(L.dssid=="transparent");if(!I.props.renderTransparent&&H){return null;}var F=(L.dssid=="automatic");if(!I.props.renderAutomatic&&F){return null;}if(L.dssid.indexOf(",")>-1){return null;}var J=K.createElement("span");J.className=G+I.props.itemCssClass;J.style.backgroundColor=L.dssid;J.setAttribute("title",L.n);J.onmouseover=this.hover;J.onmouseout=this.unhover;if(H){J.style.cursor="default";}this._insertElementForIndex(I,M,D.at,J);return J;};C.on_set_visible=function B(D,G,I){var H=D.props.visible;if(H){var F=mstr.$obj("mstrPageInfo")&&mstr.$obj("mstrPageInfo").get("userPalette");if(F){if(G&&G.getSelectedItem()){F.execClearSelect();}else{var E=G&&G.get("actualColor");if(E){F.execSelectValue(E.toUpperCase());}}}}mstr.behaviors.Generic.set_css_display(I,"block","none",D.props.visible);};C.hover=function A(){this.className+="Hover";};C.unhover=function A(){this.className=this.className.replace(/Hover/,"");};return C;})();mstr.itemrenderers.GradientItem=(function(){var A={};A.renderGradientItem=function(B,O,G,N){var L=O.split(",");var K=mstr.utils.Color.hex2rgb(L[0]);var J=mstr.utils.Color.hex2rgb(L[1]);var T=gradientUtil.GRADIENTSHADING_STYLE_CUSTOM;var F=1;var C=L[2];var Q=parseInt(L[3],10);var E=parseInt(L[4],10);var D=parseInt(L[5],10);if(C=="9"){T=gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER;F=3;}else{if(C=="10"){if(E==50){T=gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER;if(Q==45){F=2;}}else{T=gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER;if(E+D==200){F=3;}else{if(E+D==100){F=(E==100)?2:4;}}}}else{if(Q==0||Q==90){T=(Q==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;}else{T=(Q==135)?gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP:gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN;}var P=(Q==0)?E:D;if(P==100){F=2;}else{if(P==50){F=3;}}}}var R=(G/gradientUtil.PIXEL_WIDTH)*(N/gradientUtil.PIXEL_WIDTH);for(var M=0;M<R;M++){var I=document.createElement("div");I.className="pixel";var S=gradientUtil.getColorPercent(gradientUtil.getXCoordinate(M,G),gradientUtil.getYCoordinate(M,N),F,G,T);var H=parseInt(S*(J[0]-K[0]))+K[0];var O=parseInt(S*(J[1]-K[1]))+K[1];var U=parseInt(S*(J[2]-K[2]))+K[2];I.style.backgroundColor="rgb("+H+", "+O+", "+U+")";B.appendChild(I);}};return A;})();mstr.itemrenderers.GradientListView=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListView);A.renderListItem=function(I,F,M,D){var L=D.item;var K=I.props[mstr.$W.DOCUMENT];var G=(I.props.cssPrefix||"")+(I.props.itemCSSPrefix||"");var J=K.createElement("span");J.className=G;J.setAttribute("title",mstr.itemrenderers.GradientListView._buildTooltip(L.dssid,L.flashOnly));mstr.itemrenderers.GradientItem.renderGradientItem(J,L.dssid,50,50);var H=document.createElement("span");var C=I.props;H.className=C.cssPrefix+C.cssClass+"ItemContainer";var E=document.createElement("span");E.innerHTML=L.flashOnly?microstrategy.descriptors.getDescriptor("4875"):"&nbsp;";E.style.paddingLeft="5px";H.appendChild(E);H.appendChild(J);J=H;this._insertElementForIndex(I,M,D.at,J);return J;};A._buildTooltip=function B(E,D){var F=E.split(",");var C=microstrategy.descriptors.getDescriptor("4883")+" ";if(F[2]=="9"){C+=microstrategy.descriptors.getDescriptor("4889");}else{if(F[2]=="10"){C+=microstrategy.descriptors.getDescriptor("4862");}else{C+=microstrategy.descriptors.getDescriptor("4888");}}C+="; "+microstrategy.descriptors.getDescriptor("4884")+" "+F[3]+"; "+microstrategy.descriptors.getDescriptor("4885")+" "+F[5]+"; "+microstrategy.descriptors.getDescriptor("4886")+" "+F[4];if(D){C+="; "+microstrategy.descriptors.getDescriptor("4875");}return C;};return A;})();mstr.itemrenderers.ToolbarRadioButtons=(function(){var B=mstr.$H.clone(mstr.itemrenderers.ListView);B.renderListItem=function(G,E,L,D){var J=D.item;var I=G.props[mstr.$W.DOCUMENT];var F=(G.props.cssPrefix||"")+(G.props.itemCSSPrefix||"");var H=I.createElement("a");H.className=F;H.setAttribute("title",J.n);var K=I.createElement("span");if(J.id){K.setAttribute("id",J.id);}K.setAttribute("align","absmiddle");K.onmouseover=function(){mstr.itemrenderers.ToolbarRadioButtons.markListItemAsSelected(G,E,L,D);};K.onmouseout=function(){mstr.itemrenderers.ToolbarRadioButtons.markListItemAsUnselected(G,E,L,D);};H.appendChild(K);this._insertElementForIndex(G,L,D.at,H);return H;};B.markListItemAsSelected=function C(D,E,H,F){var G=this._findElementForIndex(D,H,F.at);if(G){G.className+=" on";}};B.markListItemAsUnselected=function A(D,E,H,F){var G=this._findElementForIndex(D,H,F.at);if(G){G.className=G.className.replace(" on","");}};return B;})();mstr.itemrenderers.ToolbarPickerButton=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListPulldownView);A.renderListItem=function(C,D,F,E){if(C.get("showLastSelection")){var B=D.get("lastSelection");if(!isNaN(B)){E.item=D.getItems()[D.get("lastSelection")];}else{return ;}}mstr.itemrenderers.ListPulldownView.renderListItem.apply(this,[C,D,F,E]);this._updatePickerButton(C,F);};A.renderMultipleItems=function(B,C,E,D){this.renderListItem(B,C,E,D);};A._updatePickerButton=function(B,H){var F=B.getModel().get("tooltip");var E=this._getContentContainer(H);var G=[E];if(B.get("useDynamicBtnImg")){if(E.firstChild.nodeType==3){E.innerHTML="";}else{E.replaceChild(E.firstChild.cloneNode(false),E.firstChild);G.push(E.firstChild);}}else{E.removeChild(E.firstChild);}if(F){for(var D=0,C=G.length;D<C;D++){G[D].setAttribute("title",F);}}};A.renderEmpty=function(B,C,E,D){};A._getContentContainer=function(B){return B.childNodes[1].rows[0].cells[1].firstChild.childNodes[1];};return A;})();mstr.itemrenderers.VerticalTileList=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListView);A.renderListItem=function(F,D,K,B){var H=B.item;var G=F.props[mstr.$W.DOCUMENT];var E=(F.props.cssPrefix||"")+(F.props.itemCSSPrefix||"");var C=G.createElement("div");C.className=E;C.setAttribute("id","vt_"+H.dssid);if(F.props.showDescriptions&&H.desc){C.setAttribute("title",H.desc);}if(F.props.showIcons){var J=G.createElement("div");J.className=E+"Img";C.appendChild(J);}var I=G.createElement("div");I.className=E+"Txt";I.innerHTML=H.n;C.appendChild(I);this._insertElementForIndex(F,K,B.at,C);return C;};return A;})();mstr.itemrenderers.FontList=(function(){var E={};E.renderListItem=function A(F,G,J,H){var I=mstr.itemrenderers.FastListView.renderListItem.apply(this,[F,G,J,H]);I.style.fontFamily=H.item[G.get("valueForm")];return I;};E.hover=function(F){this.className+="Hover";};E.unhover=function(F){this.className=this.className.replace(/Hover/,"");};E.markListItemAsSelected=function C(F,G,I,H){mstr.itemrenderers.FastListView.markListItemAsSelected.apply(this,[F,G,I,H]);};E.markListItemAsUnselected=function B(F,G,I,H){mstr.itemrenderers.FastListView.markListItemAsUnselected.apply(this,[F,G,I,H]);};E.on_set_leadIndex=function D(F,G,H){mstr.itemrenderers.FastListView.on_set_leadIndex.apply(this,[F,G,H]);};return E;})();mstr.itemrenderers.TabTreeList=(function(){var G={};var E=function(K){var J=mstr.utils.ListViewHelper.getItemRenderer(this);J&&J.on_target_object_change(this,this.getModel(),this.get("element"),{item:K.src,at:this.getModel().indexOfItem(K.src)});};G.on_target_object_change=function F(P,M,S,K){var Q=K.item;var L=mstr.itemrenderers.TabTreeList.findElementFromIndex(P,M,S,K);var O=Q.get(Q.get("visibleField"));L.style.display=(O)?"block":"none";var J=Q.get("categoryText");var N=P.props.categoryElems;if(N&&N[J]){var R=N[J]["visibleElems"];R+=Q.get(Q.get("visibleField"))?1:-1;N[J]["visibleElems"]=R;N[J]["elem"].style.display=(R==0)?"none":"block";}};G.renderListItem=function I(Q,N,W,L){var a=Q.props.document;var P=(Q.props.cssPrefix||"")+(Q.props.cssClass||"");var V=Q.get("scrollArea").childNodes[0];var R=N.getItems();var X=L.item;var T=X.get("categoryText");var O=null;var U=N.get("valueForm");var Z=Q.props.categoryElems;if(!Z){Z=[];Q.props.categoryElems=Z;}if(L.at==0||T!=R[L.at-1].get("categoryText")){O=a.createElement("div");O.className=P+"TabTreeItemCategory";O.appendChild(a.createTextNode(T));V.appendChild(O);var S=X[U];if(S==null&&X.get){S=X.get(U);}O.mstrListItemInfo=Q.getId()+"/"+(S||"")+"/"+L.browseCommand;Z[T]={elem:O,visibleElems:0};O.style.display="none";}var J=X.get("titleField"),c=X.get("titleText"),Y=a.createElement("div");if(J!=null){c=X.get(J);Q._notifyTitleChanged=function(){c=X.get(J);Y.innerHTML="";Y.appendChild(a.createTextNode(c));};X.attachEventListener(Q,"set_"+J,"_notifyTitleChanged");}Y.className=P+"TabTreeItem";V.appendChild(Y);Y.onmouseover=this.hover;Y.onmouseout=this.unhover;Y.appendChild(a.createTextNode(c));var K=X.get("visibleField");var M=false;if(K!=null){M=X.get(K);if(!Q._notifyItemRenderer){Q._notifyItemRenderer=E;}X.attachEventListener(Q,"set_"+K,"_notifyItemRenderer");}else{M=X.get("visible");}Y.style.display=M?"block":"none";if(M){Z[T]["elem"].style.display="block";Z[T]["visibleElems"]++;}return Y;};G.markListItemAsSelected=function H(J,K,O,L){var M=mstr.itemrenderers.TabTreeList.findElementFromIndex(J,K,O,L);if(!M){return ;}var N=M.className;if(/Hover/.test(N)){N=N.replace(/Hover/,"SelectedHover");}else{N+="Selected";}M.className=N;};G.markListItemAsUnselected=function B(J,K,N,L){var M=mstr.itemrenderers.TabTreeList.findElementFromIndex(J,K,N,L);if(M){M.className=M.className.replace(/Selected/,"");}};G.hover=function C(){this.className+="Hover";};G.unhover=function D(J){this.className=this.className.replace(/Hover/,"");};G.findElementFromIndex=function A(Q,N,S,K){var O=parseInt(K.at);if(isNaN(O)||O<0){return null;}var P=N.getItems();var R=0;var M="";for(var L=0;L<=O;L++){var J=P[L].get("categoryText");if(J!=M){R++;}M=J;}return Q.get("scrollArea").childNodes[0].childNodes[O+R];};return G;})();mstr.behaviors.FontPreview=(function(){var A={};A.on_set_enabled=function(C,B){if(B){C.className=C.className.replace("Disabled","");}else{if(C.className.indexOf("Disabled")==-1){C.className+="Disabled";}}};A.on_model_set_prop=function(K,B,H,E){var I=E&&E.get(H.get(B));if(I instanceof mstr.models.ColorPicker){I=I.get("actualColor");}else{if(I instanceof mstr.models.ListModel){var J=I.getSelectedItem();var F=I.get("valueForm");I=(J&&J[F])||(B=="fontFamily"&&"Arial")||(B=="fontSize"&&"10")||I.getItems()[0][F];}}if(isNaN(I)&&!I){return ;}var D=K.childNodes[1];if(B=="boldItalic"){D.style.fontWeight=(I==1||I==3)?"bold":"normal";D.style.fontStyle=(I==2||I==3)?"italic":"normal";}else{switch(B){case"fontSize":I+="pt";break;case"textUnderline":case"textStrikeout":B="textDecoration";var C=E.get(H.get("textUnderline"));var G=E.get(H.get("textStrikeout"));if(!C&&!G){I="none";}else{I=(C)?"underline":"";I+=(G)?" line-through":"";}break;case"fontColor":B="color";D.style.backgroundColor=mstr.utils.Color.getContrastingColor(I,["#ffffff","#000000"]);break;}D.style[B]=I;}};return A;})();mstr.behaviors.ImagePreview=(function(){var B={};B.on_set_src=function(Q,J,E){if(Q.intervalHandle){window.clearInterval(Q.intervalHandle);}mstr.$D.clearChilds(Q);var G=E.get(J.get("valueField"));if(!G||G.length==0){return ;}if(G!==""){var S=document.getElementById("imgUrl_txt");if(S){var I=microstrategy.getViewerBone().doc.prevSelectedId,D=document.getElementById(I),K=Number(D.getAttribute("ut")),M=mstrmojo.string;switch(K){case mstr.Enum.IMAGE_URL_TYPE.DUMMY_URL:S.value="";return ;case mstr.Enum.IMAGE_URL_TYPE.TASK_URL:S.value=decodeURIComponent(D.getAttribute("n"));break;case mstr.Enum.IMAGE_URL_TYPE.BLOB_URL:case mstr.Enum.IMAGE_URL_TYPE.IMAGE_NAME:G=Q.blobURL;S.value=Q.imgName;break;}}}if(mstr.utils.ISFF){var L=G.split("?");if(L.length>1){L[0]=L[0].replace(/\\/g,"/");G=L.join("?");}else{G=L[0].replace(/\\/g,"/");}}var T=J.get("document").createElement("img");T.style.visibility="hidden";T.src=G;var C=J.get(mstr.Props.Widget.ELEMENT);var N=mstr.utils.BoxModel.getElementInnerWidth(C),R=mstr.utils.BoxModel.getElementInnerHeight(C);if(!N||!R){N=parseInt(mstr.utils.CSS.getStyleValue(C,"width"));R=parseInt(mstr.utils.CSS.getStyleValue(C,"height"));}N=Math.max(N-6,0);R=Math.max(R-6,0);var H=N/R;var F=new Date();var O=false;Q.intervalHandle=window.setInterval(function(){var X=(T.readyState=="complete"||T.complete);var W=(new Date()-F>=5000);var V=mstr.utils.BoxModel.getElementOuterWidth(T);var Y=mstr.utils.BoxModel.getElementOuterHeight(T);var U=mstr.utils.ISIE4?(T.readyState=="loading"):(V&&Y);if(X||W||O||U){window.clearInterval(Q.intervalHandle);(U||X)&&P();}T.style.visibility="visible";},100);var P=function(){var U=mstr.utils.BoxModel.getElementOuterWidth(T);var V=mstr.utils.BoxModel.getElementOuterHeight(T);var W=U/V;if(V>R||U>N){if(W>H){U=N;V=(N/W);}else{V=R;U=V*W;}T.style.width=U+"px";T.style.height=V+"px";}T.style.marginTop=Math.abs(((R-V)/2))+3+"px";};T.onload=P;T.onerror=function(){O=true;P();};Q.appendChild(T);};B.on_set_visible=function A(E,G,C,D){mstr.behaviors.Generic.set_css_display(E,G,C,D);if(!mstr.utils.ISIE4){return ;}var F=E.getElementsByTagName("img");if(F[0]){F[0].style.visibility=(!!D)?"visible":"hidden";}};return B;})();mstr.behaviors.Tab=(function(){var A={};A.on_set_visible=function(H,B,C){var F=!!B.props.visible;var D=H.style;D.display=F?"block":"none";D.visibility=F?"inherit":"hidden";var E=(B.get("helpTopic")==null?"":B.get("helpTopic"));var G=B.props[mstr.$W.PARENT];while(G&&!(G instanceof mstr.views.FloatingEditor)){G=G.props[mstr.$W.PARENT];}if(G&&(G instanceof mstr.views.FloatingEditor)){G.set("helpTopic",E);}};return A;})();mstr.itemrenderers.TabbedToolbarView=(function(){var C=mstr.$H.clone(mstr.itemrenderers.ListView);C.markListItemAsUnselected=function B(D,E,H,F){var G=this._findElementForIndex(D,H,F.at);if(!G){return ;}G.className=G.className.replace(/SelectedHover/,"");G.className=G.className.replace(/Selected/,"");G.className=G.className.replace(/pinned/,"");};C.markListItemAsSelected=function A(D,E,I,F){var G=this._findElementForIndex(D,I,F.at);if(!G){return ;}var H=G.className;if(/Selected/.test(H)){H=H.replace(/Selected/,"");}if(/Hover/.test(H)){H=H.replace(/Hover/,"SelectedHover");}else{H+="Selected";}if(E.get("items")[F.at]["pinned"]){H="pinned "+H;}else{if(/pinned/.test(H)){H=H.replace(/pinned/,"");}}G.className=H;};C.renderListItem=function(N,J,Q,D){var F=mstr.itemrenderers.FastListView.renderListItem(N,J,Q,D);F.title="";var P=document.createElement("table");var R=P.insertRow(0);var H=R.insertCell(0);H.className="left";var G=R.insertCell(1);var M=R.insertCell(2);var E=F.childNodes[0];G.appendChild(E);G.className=E.className;E.className="";G.onmousedown=function(S){mstr.behaviors.ListView.onmousedown(S||window.event,self,N.get("id"));};var I=false;var O,K;if((O=J.get("items")[D.at])&&(feats=O.enabledFeatures)){I=!mstr.behaviors.featureResolver.resolveFeatSet(feats);}if(D.item.menuModel){M.className="right menu";var L=function(S){S=S||window.event;mstr.behaviors.ToolbarListView.displayMenu(S,N,J,D,P);};M.onmouseover=L;M.onmousedown=L;if(I){G.onmousedown=L;}M=null;}else{M.className="right";if(I){F.onmouseover=null;F.onmouseout=null;}}G=null;F.appendChild(P);P.cellSpacing=0;this._insertElementForIndex(N,Q,D.at,F);F.style.display=(D.item.visible)?"block":"none";return F;};C.hover=function(D){mstr.itemrenderers.FastListView.hover.apply(this,arguments);};C.unhover=function(D){mstr.itemrenderers.FastListView.unhover.apply(this,arguments);};return C;})();mstr.behaviors.ToolbarListView=(function(){var C={};C.displayMenu=function B(Q,N,K,G,R){if(!mstr.controllers.Factory.getPath(N.getModel().get("targetPath"),N)||!mstr.behaviors.ToolbarListView.shouldProcessEvt(Q,K)){return ;}if(G&&G.item){var D=G.item.menuStyle?G.item.menuStyle:K.props.menuStyle;var L=G.item.menuModel;var P=G.item.layouts;}if(!D){return ;}var H=mstr.$obj(mstr.behaviors.FloatingMenu.getMenuId({modelName:L,layouts:P}));if(H&&H.get("visible")){if(Q.type==="mousedown"){H.execCloseMenu();}return ;}var J=N.get("menus")||{};for(var F in J){if(F!==D){var I=mstr.$obj(F);if(I&&I.get&&I.get("visible")){I.execCloseMenu();}}}J[mstr.behaviors.FloatingMenu.getMenuId({modelName:L,layouts:P})]=true;N.set("menus",J);var E=R.parentNode;N.set("openerEl",E);mstr.behaviors.FloatingMenu.toggleOpenerHoverEffect(N,true);var O=mstr.utils.BoxModel.getElementSumOffsetLeft(R);var M=mstr.utils.BoxModel.getElementSumOffsetTop(R)+mstr.utils.BoxModel.getElementOuterHeight(R);O+=getDocumentScrollLeft();M+=getDocumentScrollTop();mstr.behaviors.FloatingMenu.displayMenu(N,O,M,D,L,P,document.body);};C.shouldProcessEvt=function A(D,E){return(!mstr.behaviors.featureResolver.featAvailable(E.get("featurePopMenus"))||D.type!=="mouseover");};return C;})();mstr.behaviors.ToolbarButton=(function(){var A={};A.setButtonClassName=function(C,F){var E=C.get("cssPrefix")+C.get("cssClass");var B=C.get("extraCssClass");if(B){E+=" "+B;}var D=C.get("enabled");if(!D){E+=" disabled";}if(C.getModel().get("state")||(F&&D)){E+=" on";}C.get("element").className=E;};return A;})();mstr.behaviors.FloatingMenu=(function(){var C={};C.displayMenu=function(J,K,I,E,H,L,F){if(J.get("requestingMenu")){return ;}microstrategy.setJLSCXMenuOpen(true);var D={cssText:"top:"+I+"px;left:"+K+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",showing:J.get("mOverOpen")?false:true,viewer:J.getModel().get("targetPath"),modelName:H,ribbonId:J.getModel().get("id")};if(L){D.layouts=L;}var G=microstrategy.getBlockEditorFromCache(this.getMenuId(D),null,D,J,F);if(G){return ;}mstr.behaviors.FloatingMenu.showProgressIndicator(J,K,I,F);J.set("requestingMenu",true);microstrategy.openBlockLoaderEditor(this.getMenuId(D),E,null,D,J,{scope:this,method:this.menuDisplayed},F);};C.getMenuId=function(D){var E=D.layouts?D.layouts.replace(/[.,\/]/g,""):"";return D.modelName+"_"+E;};C.menuDisplayed=function(D){var F=D.src.get("requestContext");var E=F&&F.memo&&F.memo.opener;if(E){this.killProgressIndicator(E);}var G=D&&D.memo&&D.memo.name;if(G=="readyState"){if(D.memo.value==mstr.Enum.Widget.READYSTATE.ERROR||D.memo.value==mstr.Enum.Widget.READYSTATE.CANCELLED){mstr.behaviors.FloatingMenu.toggleOpenerHoverEffect(E,false);}}};C.showProgressIndicator=function(F,E,H,D){var G={pn:D,handle:window.setTimeout(function(){var K=F.get("element").ownerDocument;var J=K.createElement("table");J.className="select-free mstrFloatingMenu mstrFloatingMenuProgress";J.style.top=H+"px";J.style.left=E+"px";var L=J.insertRow(-1).insertCell(-1);L.appendChild(K.createTextNode(microstrategy.descriptors.getDescriptor("2901")));var I=G.pn||K.body;I.appendChild(J);G.indicator=J;},3000)};F.set("progressIndicator",G);D=null;};C.killProgressIndicator=function(D){var E=D&&D.get("progressIndicator");if(!E){return ;}var F=E.indicator;if(!F){window.clearTimeout(E.handle);}else{if(F.parentNode){F.parentNode.removeChild(F);}}D.set("progressIndicator",null);D.set("requestingMenu",false);};C.toggleOpenerHoverEffect=function A(D,G){var F=D&&D.get&&D.get("openerEl");if(!F){return ;}var E=mstr.utils.ListViewHelper.getItemRenderer(D);if(G){if(E&&E.hover){E.hover.call(F);}F.ignoreMouseEvents=true;}else{F.ignoreMouseEvents=false;if(E&&E.unhover){E.unhover.call(F);}}};C.adjustMenuPosition=function B(K){if(K.get("useFixedPosition")){return ;}var G=K.get("element");var E=G.parentNode;var N=K.get("document");var L=parseInt(G.style.left,10);var J=parseInt(G.style.top,10);var O=mstr.utils.BoxModel.getElementOuterWidth(G);var I=mstr.utils.BoxModel.getElementOuterHeight(G);var H=0;var F=0;var P=0;var M=0;if(E==N.body){P=getDocumentScrollLeft();M=getDocumentScrollTop();H=mstr.utils.BoxModel.getBrowserWindowWidth(N)+P;F=mstr.utils.BoxModel.getBrowserWindowHeight(N)+M;}else{P=E.scrollLeft;M=E.scrollTop;H=mstr.utils.BoxModel.getElementInnerWidth(E)+P;F=mstr.utils.BoxModel.getElementInnerHeight(E)+M;}if(L+O>H){var D=L;if(K.get("opener").get){D-=O;D-=mstr.utils.BoxModel.getElementOuterWidth(K.get("opener").get("element"));}else{D=H-O;}G.style.left=Math.max(D,P)+"px";}if(J+I>F){G.style.top=Math.max(F-I,M)+"px";}};C.onmouseout=function(E){var D=mstr.$obj(E);if(D.get&&D.get("hasToClose")){if(D.timeout){clearTimeout(D.timeout);}D.timeout=setTimeout("mstr.$obj('"+D.get("id")+"').set('visible',false);",2000);}};C.onmouseover=function(E){var D=mstr.$obj(E);if(D.timeout){clearTimeout(D.timeout);}};return C;})();mstr.behaviors.MenuOption=(function(){var A={};A.onmouseover=function D(F){var G=F.get("parent");G=G&&G.get("opener");if(G&&G.get){G=G.get("menuCloserTO");clearTimeout(G);}if(F.get("cmds")=="OpenSubMenu"){var H=F.get("menuCloserTO");if(H){clearTimeout(H);}H=window.setTimeout(function(){F.set("mOverOpen",true);mstr.behaviors.MenuOption.fireCommands(F,null);},250);F.set("menuOpenerTO",H);}};A.onmouseout=function E(F){if(F.get("cmds")!="OpenSubMenu"){return ;}var G=F.get("menuOpenerTO");if(G){clearTimeout(G);}G=window.setTimeout(function(){F.execCloseSubMenu();},350);F.set("menuCloserTO",G);};A.fireCommands=function C(G,F){if(!G.get("enabled")){return ;}G.fireCommands();if(!G.getModel().get("menuModel")){G.get("parent").execCloseMenu();}};A.updateCSS=function B(G,H){var J=G.get("cssPrefix");var F=G.get("cssClass");F+=G.get("extraCssClass")?" "+G.get("extraCssClass"):"";var I="";if(!G.get("enabled")){I=" disabled";}if(G.props.pressed||(G.props.model&&G.props.model.props.state)){I+=" pressed";}if(H&&G.get("enabled")){I+=" hover";}G.get("element").className=J+F+I;};return A;})();mstr.behaviors.FieldSet=(function(){var A={};A.set_fieldSet_enabled=function B(H,E){if(!E){var G=H.childNodes[1];var C=G&&G.lastChild;if(C&&C.id&&C.id.substring(0,12)=="fieldSetMask"){C.style.display="block";}else{H.style.position="relative";G.style.position="relative";var C=document.createElement("div");C.setAttribute("id","fieldSetMask_"+H.getAttribute("id"));var D=C.style;D.top="0px";D.left="0px";D.width="100%";D.height="100%";D.position="absolute";D.background="transparent url(images/1ptrans.gif) repeat";G.appendChild(C);}if(mstr.utils.ISFF||mstr.utils.ISWK||mstr.utils.ISIE10||mstr.utils.ISW3CIE){C.style.opacity="0.8";C.style.backgroundColor="#fafafa";}else{G.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=30)";if(mstr.utils.ISIE6){window.setTimeout(function F(){C.style.height=G.offsetHeight;},0);}}}else{var G=H.childNodes[1];var C=G&&G.lastChild;if(C&&C.id&&C.id.substring(0,12)=="fieldSetMask"){C.style.display="none";if(mstr.utils.ISFF||mstr.utils.ISWK||mstr.utils.ISIE10||mstr.utils.ISW3CIE){G.style.opacity="1";}else{G.style.filter="";}}}};return A;})();mstr.http.SaveAnnotationsInputs=(function(){function A(E,C,B,D){this.params={taskId:"setAnnotations",objectID:E,objectType:C,annotation:B,isAppend:(typeof (D)!="undefined")?D:0,locale:mstr.Settings.Locale.ID};}return A;})();mstr.http.GetAnnotationsInput=(function(){function B(F,C,D,E){this.params={taskId:"getAnnotations",objectID:F,objectType:C,locale:mstr.Settings.Locale.ID,counter:A++};if(D){this.params.styleName=D;}else{this.params.styleName="AnnotationsStyle";}if(typeof (E)!="undefined"){this.params.juil=E;}}var A=0;return B;})();mstr.http.PingServer=(function(){function A(){this.params={taskId:"keepSessionAlive"};}return A;})();mstr.http.BlockLoaderInput=(function(){function A(B){this.params={taskId:"loadBlocks",styleName:B,juil:true};}return A;})();mstr.http.LoadToolbarInput=(function(){function A(){this.params={taskId:"loadToolbar",juil:true};}return A;})();mstr.http.FolderBlockLoaderInput=(function(){function A(B,C){this.params={taskId:"folderBrowse",styleName:B,juil:true};mstr.utils.Hash.overwrite(this.params,C);}return A;})();mstr.http.RwBlockLoaderInput=(function(){function A(C,E,B){this.params={taskId:"loadDocBlocks",styleName:C,juil:true};if(pageState){var D=(pageState+"&").match(/rwb=(.*?)\&/);if(D!=-1){this.params[E]=D[1];}}}return A;})();mstr.http.ReportBlockLoaderInput=(function(){function A(C,E,B){this.params={taskId:"loadReportBlocks",styleName:C,juil:true};if(pageState){var D=pageState.match(/rb=[^\&]*/);D=D[0].replace("rb=","");if(D!=-1){this.params[E]=D;}}}return A;})();mstr.http.GetGridFormats=(function(){function A(B,C){this.params={taskId:"getDocGridFormat",juil:true,docGridKey:B,msgID:C};}return A;})();mstr.http.GetRWGraphProperties=(function(){function A(B,C){this.params={taskId:"getRWGraphProperties",juil:true,docGridKey:B,msgID:C};}return A;})();mstr.http.GetReportGraphProperties=(function(){function A(B,C){this.params={taskId:"getReportGraphProperties",juil:true,stateID:C,msgID:B};}return A;})();mstr.http.OndemandContextMenuInputs=(function(){A.prototype.setDrillParams=function B(C){var D=microstrategy.findBone(microstrategy.activeCXMenu);var F=false;if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){F=true;}if(F){this.params={taskId:"ReportOndemandDrill",juil:true,styleName:"OndemandContextMenusStyle",ondemandDrillMinimalXML:true};if(pageState){var E=pageState.match(/rb=(.*?)(\&|$)/);if(E!=-1){this.params.rb=E[1];}}}else{this.params={taskId:"RWOnDemandDrill",juil:true,styleName:"OndemandContextMenusStyle",viewMode:D&&D.effectiveView||1,usePartDisplay:1,docGridKey:C,isQuickSwitchEnabled:D&&D.quickSwitchCurrent||false};if(pageState){var E=pageState.match(/rwb=(.*?)(\&|$)/);if(E!=-1){this.params.rwb=E[1];}}}};function A(C){this.setDrillParams(C);}return A;})();mstr.views.BaseView.prototype.taskModelCallback=function BV_taskModelCallback(B){switch(B.name){case"set_readyState":this.set("readyState",B.memo.value);if(B.memo.value==mstr.Enum.Widget.READYSTATE.IDLE){var A=this.taskModel.get("models")&&this.taskModel.get("models")[0];if(A){A.set("opener",this);}var C=this.taskModel.get("views")[0];if(C){C.set("opener",this);C.render();}}break;}};mstr.views.BaseView.prototype.execOpenModalPopup=function BV_execOpenModalPopup(B,A,D){self.supressWaitPage=true;A=A||{};D=D||{};var C,G;var I=mstr.$obj(B);if(I){var F=I.getModel();if(F){for(C in D){mstr.controllers.Factory.setPath(C,F,D[C],false);}F.set("opener",this);}for(C in A){mstr.controllers.Factory.setPath(C,I,A[C],false);}I.set("opener",this);I.set("visible",true);}else{var H=document.createElement("textarea");H.setAttribute("id",B);H.className="mstrJSON";this.get(mstr.$W.DOCUMENT).body.appendChild(H);var J=new mstr.http.BlockLoaderInput(B);for(C in D){J.params[C]=D[C];}for(C in A){J.params[C]=A[C];}if(!this.taskModel){this.taskModel=new mstr.models.TaskModel({parent:this});mstr.controllers.Factory.add(this.taskModel);var E=this.taskModel&&this.taskModel.init&&this.taskModel.init();this.taskModel.attachEventListener(this,"set_readyState","taskModelCallback");}this.set("readyState",mstr.Enum.Widget.READYSTATE.WAITING);this.taskModel.execFetchBlock(J,H);}window.setTimeout("self.supressWaitPage = false;",10);};mstr.views.FastTileView=(function(){mstr.$O.extendsClass(F,mstr.views.FastListView);F.DEFAULT_LIST_ITEM_HEIGHT=75;F.DEFAULT_LIST_ITEM_WIDTH=76;F.prototype._computeVisibleItemsRange=function E(){var H=mstr.views.FastListView.prototype._computeVisibleItemsRange.apply(this);if(H){var I=Math.max(parseInt(this.props.itemsPerRow)||1,1);H.min=H.min*I;H.max=(H.max+1)*I-1;}return H;};F.prototype._updateItemsContainerDimensions=function D(){mstr.views.FastListView.prototype._updateItemsContainerDimensions.apply(this);this._updateItemsContainerWidth();};F.prototype._updateItemsContainerHeight=function C(){var K=this.props.listItemsContainer;if(!K){return ;}var L=mstr.utils.ListViewHelper.getItemRenderer(this);var J=F.DEFAULT_LIST_ITEM_HEIGHT;if(J){var I=this.getModel();var H=mstr.$A.len(I&&I.getItems&&I.getItems()),N=Math.max(parseInt(this.props.itemsPerRow)||1,1),M=parseInt(H/N);if(H%N){M++;}J=J*M;}if(J){K.style.height=J+"px";}else{K.style.height=mstr.utils.ISIE4?"1px":"auto";}if(mstr.utils.ISIE4){K.style.overflow=J?"visible":"hidden";}};F.prototype._updateItemsContainerWidth=function G(){var J=this.props.listItemsContainer;if(!J){return ;}var I=this.getModel();var H=mstr.$A.len(I&&I.getItems&&I.getItems()),L=Math.max(parseInt(this.props.itemsPerRow)||1,1);J.style.width=(F.DEFAULT_LIST_ITEM_WIDTH*Math.min(H,L))+"px";var K=parseInt(H/L);if(mstr.utils.ISW3C&&(K*F.DEFAULT_LIST_ITEM_WIDTH>parseInt(this.props.height))){J.style.width=(parseInt(J.style.width)+SCROLLBAR_SIZE)+"px";}};F.prototype._adjustWhiteSpaceAboveItem=function B(H,I){return ;};F.prototype._adjustWhiteSpaceBelowItem=function A(H,I){return ;};function F(H){mstr.views.FastListView.apply(this,[H]);}return F;})();mstr.views.TabTreeListView=(function(){mstr.$O.extendsClass(A,mstr.views.ListView);A.prototype.execClickListItem=function B(J){var C=this.props.model;var F=C.indexOfValue(J.valueForm);if(F!=-1){var E=C.getItems();var I=E[F];var D=I&&I.get&&I.get("visibleField");if(D){if(!I.get(D)){for(var H=F,G=E.length;H<G;H++){D=E[H].get("visibleField");if(!D||E[H].get(D)){J.valueForm=E[H].getId();break;}}}}}return mstr.views.ListView.prototype.execClickListItem.apply(this,[J]);};function A(C){mstr.views.ListView.apply(this,[C]);}return A;})();mstr.views.AnnotationView=(function(){mstr.$O.extendsClass(G,mstr.views.BaseView);G.prototype.execResize=function F(){this.resize();return true;};G.prototype.resize=function D(I,H){if(H==null){H=mstr.utils.BoxModel.getElementOuterHeight(this.props[mstr.$W.ELEMENT]);}else{this.props[mstr.$W.ELEMENT].style.height=Math.max(H-26,0)+"px";}if(I==null){I=mstr.utils.BoxModel.getElementOuterWidth(this.props[mstr.$W.ELEMENT]);}else{this.props[mstr.$W.ELEMENT].style.width=Math.max(I-26,0)+"px";}this.nonEditableArea=this.nonEditableArea||document.getElementById("nonEditableArea");this.editableArea=this.editableArea||document.getElementById("editableArea");this.addArea=this.addArea||document.getElementById("addArea");this.editButtons=this.editButtons||document.getElementById("editButtons");this.scratchPad=this.scratchPad||document.getElementById("scratchPad");if(this.editableArea&&this.nonEditableArea){if(this.scratchPad){this.scratchPad.style.width=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.width),0)+"px";}this.editableArea.style.height=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.height)-mstr.utils.BoxModel.getElementOuterHeight(this.addArea)-mstr.utils.BoxModel.getElementOuterHeight(this.editButtons)-10,0)+"px";this.editableArea.style.width=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.width),0)+"px";this.nonEditableArea.style.height=this.editableArea.style.height;this.nonEditableArea.style.width=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.width),0)+"px";}};G.prototype.execUpdate=function B(H){if(H=="true"){this.addArea=this.addArea||document.getElementById("addArea");this.getModel().get("addition").set("value",this.addArea.firstChild.value);}else{this.editableArea=this.editableArea||document.getElementById("editableArea");this.getModel().set("value",this.editableArea.value);}};G.prototype.execValidateAdd=function E(H,I){if(!H||H.length==0){this.execConfirm(microstrategy.descriptors.getDescriptor("6156"));return false;}else{if((H.length+this.getModel().get("addition").get("prefixLen")+this.getModel().get("addition").get("postfixLen"))>mstr.models.AnnotationModel.ADDITION_MAX_LENGTH){return this.execConfirm("*Additional notes cannot be longer than ## characters. The note you are adding will be truncated if you proceed.*".replace(/##/,mstr.models.AnnotationModel.ADDITION_MAX_LENGTH));}else{if(this.getModel().get("value")&&((this.getModel().get("value").length+H.length)>mstr.models.AnnotationModel.NOTES_MAX_LENGTH)){return this.execConfirm("*Notes cannot be longer than ## characters. The note you are editing will be truncated if you proceed.*".replace(/##/,mstr.models.AnnotationModel.NOTES_MAX_LENGTH));}}}return true;};G.prototype.execValidateEdit=function C(H){if((H.length+this.getModel().get("postfixLen"))>mstr.models.AnnotationModel.NOTES_MAX_LENGTH){return this.execConfirm("*Notes cannot be longer than ## characters. The note you are editing will be truncated if you proceed.*".replace(/##/,mstr.models.AnnotationModel.NOTES_MAX_LENGTH));}return true;};G.prototype.setEditCursor=function A(){if(this.editableArea){this.editableArea.focus();if(mstr.utils.ISW3C){this.editableArea.scrollTop=this.editableArea.scrollHeight;}else{var H=this.editableArea.createTextRange();H.collapse(false);H.select();}}};function G(H){mstr.views.BaseView.apply(this,[H]);}return G;})();mstr.views.Slider=(function(){mstr.$O.extendsClass(S,mstr.views.BaseView);S.prototype._getThumb=function S__getThumb(){var el=this.get(mstr.Props.Widget.ELEMENT);return el&&el.lastChild.firstChild;};S.prototype._getTooltip=function S__getTooltip(){var el=this.get(mstr.Props.Widget.ELEMENT);return el&&el.lastChild.lastChild;};S.prototype.init=function S_init(){mstr.views.BaseView.prototype.init.apply(this,arguments);var m=this.getModel();if(m&&m.attachEventListener){m.attachEventListener(this,"set_"+this.get("xField"),"schedule_thumb_move");m.attachEventListener(this,"set_"+this.get("yField"),"schedule_thumb_move");}};S.prototype.render=function S_render(){mstr.views.BaseView.prototype.render.apply(this,arguments);this.schedule_thumb_move(null,true);if(!this.get("dnd")){return null;}var el=this.get("element").lastChild;var thumb=this._getThumb();var props={view:this};var f1,f2;var o=this.get("orientation");if(o=="h"||o=="b"){f1=function(){return Math.round(mstr.utils.BoxModel.getElementSumOffsetLeft(el)-(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2));};props.xMin=f1;props.xMax=function(){return f1()+mstr.utils.BoxModel.getElementInnerWidth(el);};}else{f1=function(){return mstr.utils.BoxModel.getElementSumOffsetLeft(el);};props.xMin=f1;props.xMax=f1;}if(o=="v"||o=="b"){f2=function(){return Math.round(mstr.utils.BoxModel.getElementSumOffsetTop(el)-(mstr.utils.BoxModel.getElementOuterHeight(thumb)/2));};props.yMin=f2;props.yMax=function(){return f2()+mstr.utils.BoxModel.getElementInnerHeight(el);};}else{f2=function(){return mstr.utils.BoxModel.getElementSumOffsetTop(el);};props.yMin=f2;props.yMax=f2;}this.set("dz",new mstr.models.dnd.DragZone(props,{findTarget:function(view,e){var t=mstr.utils.Dom.findAncestor(e.target(),"className",thumb.className);return(t&&t==thumb)?t:null;},startDrag:function(view){if(!view.get("dndGhost")){thumb.style.visibility="hidden";}var origClickJump=!!view.get("enableClickJumps");if(!origClickJump){view.set("enableClickJumps",true);}},drag:function(view,l,t){l=l+Math.round(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2);t=t+Math.round(mstr.utils.BoxModel.getElementOuterHeight(thumb)/2);view.repositionThumb({x:l,y:t},1);},endDrag:function(view,l,t){var origClickJump=!!view.get("enableClickJumps");if(!origClickJump){view.set("enableClickJumps",true);}var origAnimation=!!view.get("animate");if(origAnimation){view.set("animate",false);}l=l+Math.round(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2);t=t+Math.round(mstr.utils.BoxModel.getElementOuterHeight(thumb)/2);view.repositionThumb({x:l,y:t},1);if(!origClickJump){view.set("enableClickJumps",false);}if(origAnimation){view.set("animate",true);}if(!view.get("dndGhost")){thumb.style.visibility="visible";}}}));return null;};S.prototype.on_click=function S_on_click(e,hWin){if(!this.get("enabled")||(!this.get("xField")&&!this.get("yField"))){return ;}e=e||window.event;if((e.target||e.srcElement).tagName!="DIV"){return ;}var evt=new mstr.lang.Event(e,hWin,this);var el=this.get(mstr.Props.Widget.ELEMENT).lastChild;var h=parseInt(this.get("height"),10);var offset=(mstr.utils.ISW3C)?(mstr.utils.BoxModel.getElementOuterHeight(el)-h)/2:4;this.repositionThumb(evt,offset);};S.prototype.repositionThumb=function S_repositionThumb(evt,offset){var x,y;var h=parseInt(this.get("height"),10);var w=parseInt(this.get("width"),10);var el=this.get(mstr.Props.Widget.ELEMENT).lastChild;var or=this.get("orientation");var og=this.get("origin");if(or=="h"||or=="b"){x=evt.x-mstr.utils.BoxModel.getElementSumOffsetLeft(el)-offset;if(og==2||og==6){x=NaN;}else{if(og==3||og==4||og==5){x=w-x;}}}if(or=="v"||or=="b"){y=evt.y-mstr.utils.BoxModel.getElementSumOffsetTop(el)-offset;if(og==4||og==8){y=NaN;}else{if(og==5||og==6||og==7){y=h-y;}}}var info={x:{n:x,d:w},y:{n:y,d:h}};var m=this.getModel();for(var id in info){if(!isNaN(info[id]["n"])){var f=this.get(id+"Field");if(!f){continue;}var min=this.get(id+"Min");var max=this.get(id+"Max");var v=Math.round(((info[id]["n"]/info[id]["d"])*(max-min))+min);if(this.get("enableClickJumps")){m.set(f,v);}else{var ov=m.get(f);v=(ov<v)?ov++:ov--;m.set(f,ov);}}}if(!isNaN(x)){var thumb=this._getThumb();thumb.style.left=(x-Math.round(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2)-(mstr.utils.ISIE6||mstr.utils.ISIE7?1:0))+"px";}this.showTooltip(true);};S.prototype._buildTooltipText=function S__buildTooltipText(){var tf=this.get("tooltipFunction");if(tf){eval("var f ="+tf);}var s="";var m=this.getModel();var or=this.get("orientation");if(this.get("xField")&&(or=="h"||or=="b")){s+=(tf)?f(m.get(this.get("xField"))):microstrategy.descriptors.getDescriptor("4891").replace("##",m.get(this.get("xField"))).replace("###",this.get("xMax"));}if(this.get("yField")&&(or=="v"||or=="b")){if(s.length>0){s+="<br />";}s+=(tf)?f(m.get(this.get("yField"))):microstrategy.descriptors.getDescriptor("4891").replace("##",m.get(this.get("yField"))).replace("###",this.get("yMax"));}return s;};S.prototype._moveTooltip=function S__moveTooltip(){if(!this.get("showTooltip")){return ;}var el=this.get(mstr.Props.Widget.ELEMENT);var tooltip=this._getTooltip();if(!tooltip){return ;}var or=this.get("orientation");tooltip.lastChild.innerHTML=this._buildTooltipText();var x,y;var h=mstr.utils.BoxModel.getElementOuterHeight(tooltip);var w=mstr.utils.BoxModel.getElementOuterWidth(tooltip);var thumb=this._getThumb();var tt=mstr.utils.BoxModel.getElementSumOffsetTop(thumb)-mstr.utils.BoxModel.getElementSumOffsetTop(el.lastChild);var tl=mstr.utils.BoxModel.getElementSumOffsetLeft(thumb)-mstr.utils.BoxModel.getElementSumOffsetLeft(el.lastChild);var th=mstr.utils.BoxModel.getElementOuterHeight(thumb);var tw=mstr.utils.BoxModel.getElementOuterWidth(thumb);switch(or){case"h":x=Math.round(tl+(tw/2)-(w/2));y=Math.round(tt-h-1);break;case"v":x=Math.round(tl+tw+1);y=Math.round(tt+(th/2)-(h/2));break;case"b":x=Math.round(tl+tw+1);y=Math.round(tt-h-1);break;}tooltip.style.left=x+"px";tooltip.style.top=y+"px";};S.prototype.showTooltip=function S_showTooltip(show){if(!this.get("showTooltip")){return ;}var tooltip=this._getTooltip();if(!tooltip){return ;}if(this.get("enabled")&&show){tooltip.style.display="inline";tooltip.style.visibility="visible";this._moveTooltip();}else{tooltip.style.visibility="hidden";}};S.prototype.schedule_thumb_move=function S_schedule_thumb_move(evt,noAnimation){if(!isNaN(this.get("animationTimeout"))){self.clearTimeout(this.get("animationTimeout"));this.set("animationTimeout",null);}var thumb=this._getThumb();var og="|"+this.get("origin")+"|";var tempT=thumb.cloneNode(true);tempT.style.display="block";tempT.style.position="absolute";tempT.style.left="3000px";tempT.style.top="2000px";tempT=document.body.appendChild(tempT);var info={x:{d:parseInt(this.get("width"),10),i:"|2|6|",o:"|3|4|5|",t:mstr.utils.BoxModel.getElementOuterWidth(tempT)/2,v:NaN},y:{d:parseInt(this.get("height"),10),i:"|4|8|",o:"|5|6|7|",t:mstr.utils.BoxModel.getElementOuterHeight(tempT)/2,v:NaN}};document.body.removeChild(tempT);var model=this.getModel();for(var id in info){var f=this.get(id+"Field");if(!f){continue;}var min=this.get(id+"Min");var n=(model.get(f)-min)/(this.get(id+"Max")-min);if(info[id]["i"].indexOf(og)>-1){n=NaN;}else{if(info[id]["o"].indexOf(og)>-1){n=1-n;}}info[id]["v"]=Math.round(n*info[id]["d"]-info[id]["t"]);}var x=info.x["v"]||null;var y=info.y["v"]||null;if(noAnimation||!this.get("animate")||this.get("animationStep")<=1){if(x&&!isNaN(x)){thumb.style.left=x+"px";}if(y&&!isNaN(y)){thumb.style.top=y+"px";}}else{this.props.animationTimeout=self.setTimeout("mstr.$obj('"+this.get("id")+"').move_thumb("+x+", "+y+")",10);}this._moveTooltip();};S.prototype.move_thumb=function S_move_thumb(x,y){var thumb=this._getThumb();if(thumb){mstr.utils.Animations.move(thumb,x,y,this.get("animationStep"));this.set("animationTimeout",null);}};S.prototype.after_set_enabled=function S_after_set_enabled(evt){var thumb=this._getThumb();if(thumb){thumb.style.display=(this.get("enabled"))?"inline":"none";}};function S(props){mstr.views.BaseView.apply(this,[props]);}return S;})();mstr.views.FontFormatter=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.pathMap={nameModelPath:{p:"children/0/children/0",f:"fontFamily",vp:"parent/parent/model/"},styleModelPath:{p:"children/1/children/0/children/0",f:"boldItalic",vp:"parent/model/"},sizeModelPath:{p:"children/1/children/0/children/1",f:"fontSize",vp:"parent/model/"},underlineField:{p:"children/0/children/1/children/0",f:"textUnderline",vp:"parent/model/"},strikeoutField:{p:"children/0/children/1/children/1",f:"textStrikeout",vp:"parent/model/"},colorModelPath:{p:"children/1/children/1",f:"fontColor",vp:"parent/model/"}};A.prototype.init=function B(){var E=this;var D=function(G){var H=G.name.split("_").pop();E._updateViewProperties(H);};for(var F in mstr.views.FontFormatter.pathMap){this._updateViewProperties(F);this["after_set_"+F]=D;}mstr.views.BaseView.prototype.init.apply(this);};A.prototype._updateViewProperties=function C(J){var E=mstr.$path(mstr.views.FontFormatter.pathMap[J].p,this);var H=this.get(J);if(J.indexOf("Field")>-1){mstr.controllers.Factory.safeset(E,"valueField",H);}else{var G=mstr.views.FontFormatter.pathMap[J].vp+H;mstr.controllers.Factory.safeset(E,"modelPath",G);}var D=this.get("enabledField");if(D){var F=mstr.views.FontFormatter.pathMap[J].vp+D;mstr.controllers.Factory.safeset(E,"enabledField",F);}var I=mstr.$path("children/1/children/2",this);mstr.controllers.Factory.safeset(I,mstr.views.FontFormatter.pathMap[J].f,H);};function A(D){mstr.views.BaseView.apply(this,[D]);}return A;})();mstr.views.ToolbarListView=(function(){mstr.$O.extendsClass(A,mstr.views.ListView);A.prototype.init=function C(){mstr.views.ListView.prototype.init.apply(this);this.getModel().attachEventListener(this,"featuresChanged","render");};A.prototype.render=function B(){if(!this.props.model.get("items")[1]&&!this.props.model.get("items")[0]["menuModel"]&&mstr.utils.Hash.isEmpty(this.props.rightIcons)){var E=" mstrNoTabs";if(document.body.className.indexOf(E)==-1){document.body.className+=E;}return ;}mstr.views.ListView.prototype.render.call(this,[]);var I=this.get("rightIcons"),D=this.props.scrollArea,J=D&&D.firstChild;if(!J||!I){return ;}for(var G=0,F=I.length;G<F;G++){var H=I[G];if(H.get){J.appendChild(H.get(mstr.$W.ELEMENT));}else{H=mstr.controllers.Factory.registerJSON(I[G],this.props[mstr.$W.DOCUMENT]);H.set("parent",this);H.init();H.set(mstr.$W.ELEMENT,J.appendChild(document.createElement("div")));}H.render();I[G]=H;}};function A(D){mstr.views.ListView.apply(this,[D]);}return A;})();mstr.views.FloatingMenuOption=(function(){mstr.$O.extendsClass(C,mstr.views.BaseView);C.prototype.execOpenSubMenu=function B(){var G=this.getModel().get("style");var E=this.getModel().get("menuModel");var I=this.getModel().get("layouts");if(!G){G=this.props.parent.props.model.props.styleName;}if(!G||!E){return ;}this.get("parent").execCloseSubMenus();var F=this.get("element");var H=this.get("parent").get("element");var D=parseInt(H.style.left,10)+mstr.utils.BoxModel.getElementOuterWidth(H)-12;var J=parseInt(H.style.top,10)+mstr.utils.BoxModel.getElementSumOffsetTop(F)-mstr.utils.BoxModel.getElementSumOffsetTop(H);mstr.behaviors.FloatingMenu.displayMenu(this,D,J,G,E,I,H.parentNode);};C.prototype.execCloseSubMenu=function A(){if(!this.getModel().get("menuModel")){return ;}var E=mstr.$obj(mstr.behaviors.FloatingMenu.getMenuId({layouts:this.getModel().get("layouts"),modelName:this.getModel().get("menuModel")}));var D=E&&E.execCloseMenu();};function C(D){mstr.views.BaseView.apply(this,[D]);}return C;})();mstr.views.ToolbarButton=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype._attachLayoutHandlers=function C(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this,[]);var D=this.props.model;if(!D){return ;}D.attachEventListener(this,"set_showPressed","set_pressed");};B.prototype.set_pressed=function A(D){this.set("pressed",D.memo.value);};function B(D){mstr.views.BaseView.apply(this,[D]);}return B;})();mstr.views.LastUpdateView=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.render=function A(){var D=mstr.$path(mstr.$path("parent/model/targetPath",this),this);if(!D){return ;}mstr.views.BaseView.prototype.render.apply(this,arguments);var C=this.get(mstr.$W.ELEMENT);if(D.lastUpdate){C.innerHTML=D.lastUpdate;}C.className=this.get("cssPrefix")+this.get("cssClass");};function B(C){mstr.views.BaseView.apply(this,[C]);}return B;})();mstr.views.Toolbar=(function(){mstr.$O.extendsClass(C,mstr.views.ViewBook);C.prototype.render=function E(){mstr.views.ViewBook.prototype.render.apply(this);this.checkAllSeparators();var G=this.get("views");for(var I=0,H=G.length;I<H;I++){var J=G[I];if(!(J.get("ge"))){var F=J.attachEventListener&&J.attachEventListener(this,"set_visible","checkSeparators");}}};C.prototype.checkAllSeparators=function B(){var F=this.get("views");var J=false;var I;for(var H=0,G=F.length;H<G;H++){I=F[H].get("ge");if(!this.renderFirstSeparator&&F[H].get("visible")&&!J){J=true;if(I){F[H].set("visible",false);continue;}}if(I&&H+1<G){this.checkSeparators({src:F[H+1]});}}};C.prototype.checkSeparators=function D(G){var F=this.get("views");var H=mstr.$A.find(F,G.src);var K=G.src.get("visible");var J,M,I;var L;for(M=H-1;M>=0;M--){J=F[M];if(J.get("ge")){L=M;break;}}for(M=L+1,I=F.length;M<I;M++){J=F[M];if(J.get("ge")){F[L].set("visible",false);break;}if(J.get("visible")){F[L].set("visible",true);break;}}if(M==F.length&&!this.renderLastSeparator){F[L].set("visible",false);}};C.prototype.after_set_childValidationStatus=function A(H){var F=H.memo;var I=mstr.$obj(F.id).getModel().get("queueGroup");this.childValidationStatus=this.childValidationStatus||{};var J=this.childValidationStatus[I]=this.childValidationStatus[I]||{};var G=this.get("model");if(F.code==mstr.Enum.Validation.STATUSCODE.VALID){if(F.id in J){delete J[F.id];if(mstr.utils.Hash.isEmpty(J)){G.setQueueValidationStatus(I,mstr.Enum.Validation.STATUSCODE.VALID);}}}else{if(mstr.utils.Hash.isEmpty(J)){G.setQueueValidationStatus(I,mstr.Enum.Validation.STATUSCODE.INVALID_ANSWERS);}J[F.id]=F.code;}};function C(F){this.renderFirstSeparator=true;this.renderLastSeparator=true;mstr.views.ViewBook.apply(this,[F]);}return C;})();mstr.views.ClickableMessage=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.showMessage=function D(){showMessage({contents:this.get("dlgText"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,zIndex:1001,okEval:'mstr.$obj("'+this.get("id")+'").handleOK()',type:mstrMsgBoxImpl.MSG_WARNING});};B.prototype.handleOK=function C(){};B.prototype.render=function A(){mstr.views.BaseView.prototype.render.apply(this,arguments);var H=this.get("element");var F=this.get("msgText");var G=F.match(/##(.*)##/);if(G&&G.length>0){var E="<span style='text-decoration:underline;cursor:pointer' onclick='mstr.$obj(\""+this.get("id")+"\").showMessage();'>"+G[1]+"</span>";F=F.replace(/##.*##/,E);H.innerHTML=F;}};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.TooltipText=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.render=function B(){mstr.views.BaseView.prototype.render.apply(this,arguments);var C=this.get("element");model=this.getModel();currAttr=model.getSelectedItemValue();attrName=currAttr.split("|")[2];abbr=attrName;if(attrName.length>20){abbr=attrName.substring(0,17)+"...";}C.innerHTML="<div style='margin-top:6px;' title='"+attrName+"'>"+abbr+":</div>";};function A(C){mstr.views.BaseView.apply(this,[C]);}return A;})();mstr.views.DisableAutowireMessage=(function(){mstr.$O.extendsClass(B,mstr.views.ClickableMessage);B.prototype.handleOK=function A(){microstrategy.getViewerBone().commands.exec("disableAutowire");this.get("parent").getModel().set("Autowire",false);};function B(C){mstr.views.BaseView.apply(this,[C]);}return B;})();mstr.views.FloatingMenuBook=(function(){mstr.$O.extendsClass(D,mstr.views.Toolbar);D.prototype.zIndex=1000;D.prototype.getZIndex=function I(){return this.zIndex++;};D.prototype.init=function A(){mstr.views.Toolbar.prototype.init.apply(this);mstr.controllers.EventManager.attachWindowEventListener(this,"mousedown","documentClick");mstr.controllers.EventManager.attachWindowEventListener(this,"closeMenus","documentClick");};D.prototype.after_set_visible=function G(J){if(this.props.visible){mstr.behaviors.FloatingMenu.adjustMenuPosition(this);}else{mstr.behaviors.FloatingMenu.toggleOpenerHoverEffect(this.props.opener,false);}};D.prototype.render=function B(){mstr.views.Toolbar.prototype.render.apply(this);mstr.utils.Dom.insertPopupMask(this.get("element"),this.execLayoutHandler("maskContainer"));var J=this.get("opener");if(J&&J.get&&J.get("visible")===false){this.execCloseMenu();}else{mstr.behaviors.FloatingMenu.adjustMenuPosition(this);}};D.prototype.documentClick=function F(J){if(this.props.visible===false){return ;}if(this.props.showing){this.set("showing",false);return ;}var K=J&&J.target&&J.target();if(K&&K.tagName&&K.tagName.toLowerCase()=="html"){return ;}if(((!K&&J.name=="closeMenus")||!mstr.utils.Dom.containsElement(this.props.element,K,true))&&!(this.props.opener.props&&mstr.utils.Dom.containsElement(this.props.opener.props.element,K,true))&&!this.isSubMenu(K)){this.execCloseMenu();}};D.prototype.isSubMenu=function E(N){var K=N,J,L,M,O;while(K){O=(K.getAttribute&&K.getAttribute("blockId"))||K.id;if(O){J=mstr.$obj(O);if(J&&J.props){M=M||(J.props.cmds);L=J.props.opener;L=L&&L.props.element;if(L){return M=="OpenSubMenu"&&mstr.utils.Dom.containsElement(this.props.element,L,true);}}}K=K.parentNode;}return false;};D.prototype.isSubMenu=function E(N){var K=N,J,L,M,O;while(K){O=(K.getAttribute&&K.getAttribute("blockId"))||K.id;if(O){J=mstr.$obj(O);if(J&&J.props){M=M||(J.props.cmds);L=J.props.opener;L=L&&L.props.element;if(L){return M=="OpenSubMenu"&&mstr.utils.Dom.containsElement(this.props.element,L,true);}}}K=K.parentNode;}return false;};D.prototype.execCloseMenu=function H(){if(this.props.visible===false){return ;}if(!(this.props.opener instanceof mstr.views.FloatingMenuOption)){microstrategy.setJLSCXMenuOpen(false);}this.set("visible",false);this.set("cssText","left:-2000px;top:-2000px");};D.prototype.execCloseSubMenus=function C(){if(!this.props.views){return ;}for(var L=0,K=this.props.views.length;L<K;L++){var M=this.props.views[L];var J=M.execCloseSubMenu&&M.execCloseSubMenu();}};function D(J){mstr.views.Toolbar.apply(this,[J]);this.renderLastSeparator=false;this.renderFirstSeparator=false;}return D;})();mstr.views.ContextMenuProcessingView=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.setModel=function(B){mstr.views.BaseView.prototype.setModel.apply(this,[B]);B.attachEventListener(this,"set_menu_ready","on_menu_ready");B.attachEventListener(this,"set_menu_processing","on_menu_processing");B.attachEventListener(this,"set_hide_menu_processing","on_hide_menu_processing");};A.prototype.on_menu_processing=function(){addProcessingMenuItem(this.getMenuLevel());};A.prototype.on_hide_menu_processing=function(){removeProcessingMenuItem(this.getMenuLevel());};A.prototype.on_menu_ready=function(){var C=this.getModel().getMenuItems();var B=this.getModel().getCurrentMenuItemIndices();if(C!=null&&B!=null){addDynamicMenus(this.getMenuLevel(),C,B);}};A.prototype.setMenuLevel=function(B){this.iMenu=B;};A.prototype.getMenuLevel=function(){return this.iMenu;};function A(B){mstr.views.BaseView.apply(this,[B]);}return A;})();mstr.views.ToolbarColorPickerButton=(function(){mstr.$O.extendsClass(A,mstr.views.Pulldown);A.prototype._attachLayoutHandlers=function D(){mstr.views.Pulldown.prototype._attachLayoutHandlers.apply(this);var E=this.props.model;if(E&&E.attachEventListener){E.attachEventListener(this,"set_lastColor","lastColorChanged");}this.lastColorChanged();};A.prototype._detachLayoutHandlers=function B(){mstr.views.Pulldown.prototype._detachLayoutHandlers.apply(this);var E=this.props.model;if(E&&E.detachEventListener){E.detachEventListener(this,"set_lastColor");}};A.prototype.lastColorChanged=function C(){var F=this.getModel();var H=F.get("lastColor");H=(H.indexOf(",")>-1)?H.split(",")[0]:H;var E=mstr.utils.ListViewHelper.getItemRenderer(this);var G=E._getContentContainer(this.props[mstr.$W.ELEMENT]);if(/^#[0-9a-f]{6}$/i.test(H)){G.style.backgroundColor=H;}};function A(E){mstr.views.Pulldown.apply(this,[E]);}return A;})();mstr.bones.editors.BoneTranslator=(function(){mstr.$O.extendsClass(P,mstr.models.BaseModel);P.prototype.translating=false;P.prototype._createNewModel=function H(Y){var X=Y.scriptClass;if(!X||!mstr.models[X]){return null;}var W=new mstr.models[X](Y);if(!W){return null;}mstr.controllers.Factory.add(W);var V=W.init&&W.init();return W;};P.prototype._initializeDynamicModel=function Q(V,W,Y){this._setDynamicModelValues(V,W,Y);this.props[V]=W;this._setModelChangeEventListeners(W,V);this.dynamicModels=this.dynamicModels||[];this.dynamicModels.push({dm:W,p:V,s:Y});if(V==="EditSelectorTargets"&&Y==="availableTemplates"){var a=this.get("EditSelectorSource"),Z=a&&a.getSelectedItem()&&a.getSelectedItem().olap,X=a&&a.getSelectedItem(),c=X&&X.de&&X.sty!=12033;if(Z){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",W,"availableTemplatesNoPlaceholder");}if(c){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",W,"availableTemplatesNoPlaceholder");}}};P.prototype._setModelChangeEventListeners=function M(W,V){if(W instanceof mstr.models.ListModel){if(W instanceof mstr.models.ColorPicker){W.attachEventListener(this,"set_actualColor","onModelPropertyChange");}else{W.attachEventListener(this,"hashadd_selectedIndices","onModelPropertyChange");W.attachEventListener(this,"hashremove_selectedIndices","onModelPropertyChange");}W.set("mappedPropertyName",V);}else{if(mstr.models.ListCart&&W instanceof mstr.models.ListCart){var X=W.get("selected");X.attachEventListener(this,"listadd_items","onModelPropertyChange");X.attachEventListener(this,"listremove_items","onModelPropertyChange");X.set("mappedPropertyName",V);}}};P.prototype._setDynamicModelValues=function G(W,X,Y){var V=(typeof (Y)=="string")?this.getBone().commands.queryState(Y):Y;if(X instanceof mstr.models.ListModel){this._setDynamicListModelValues(X,V,W);}else{if(mstr.models.ListCart&&X instanceof mstr.models.ListCart){this._setDynamicCartModelValues(X,V,W);}}};P.prototype._setDynamicListModelValues=function J(X,W,V){X.setItems(W);var Z=this.getBone().commands.queryState(V);var Y=(mstr.$A.isArray(Z))?"execSelectValues":"execSelectValue";X[Y](Z);};P.prototype._setDynamicCartModelValues=function S(X,W,V){X.get("available").setItems(W);var Y=this.getBone().commands.queryState(V);X.get("selected").setItems(Y);X._updateAvailableFilteredItems();};P.prototype._resolveDynamicModelSource=function D(V){return(V in this.props&&"getItems" in this.props[V])?this.get(V).getItems():V;};P.prototype._getPropertyCategory=function E(){return"default";};P.prototype._storeDeltaProp=function C(X,V){if(this.get("previewDisabledFields")&&this.get("previewDisabledFields")[X]){this.props.parent.set("disablePreview",true);this.props.parent.set("enablePreview",false);}var W=this._getPropertyCategory();this.deltaProps[W]=this.deltaProps[W]||{};this.deltaProps[W][X]=V;this.raiseEvent("store_deltaProp",{category:W,name:X,value:V});mstr.models.BaseModel.prototype.set.apply(this,["hasChanges",true]);};P.prototype._getDeltaProp=function O(W){var V=this._getPropertyCategory();if(!(V in this.deltaProps)||!(W in this.deltaProps[V])){return null;}return this.deltaProps[V][W];};P.prototype.getBone=function N(){return mstr.$obj(this.props.boneId);};P.prototype.reinitializeModel=function F(){var W=("dynamicModels" in this);this.translateBone();if(!this.get("enabled")){return ;}if(!W){return ;}var Z=this.translating;this.translating=true;for(var a=0,Y=this.dynamicModels.length;a<Y;a++){var c=this.dynamicModels[a];if(c.p==="EditSelectorTargets"&&c.s==="availableTemplates"){var V=this.get("EditSelectorSource"),g=V&&V.getSelectedItem()&&V.getSelectedItem().olap,X=V&&V.getSelectedItem(),e=X&&X.de&&X.sty!=12033;if(g){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",c.dm,"availableTemplatesNoPlaceholder");continue;}if(e){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",c.dm,"availableTemplatesNoPlaceholder");continue;}}this._setDynamicModelValues(c.p,c.dm,c.s);}this.translating=Z;};P.prototype.getDynamicListModel=function R(X,W){var Y=this._resolveDynamicModelSource(X);var V=this._createNewModel({scriptClass:"ListModel",parent:this,valueForm:"dssid"});if(V){this._initializeDynamicModel(W,V,Y);}return V;};P.prototype.getDynamicCartModel=function K(X,W){var Y=this._resolveDynamicModelSource(X);var V=this._createNewModel({scriptClass:"ListCart",parent:this,available:{scriptClass:"mstr.models.ListModel",valueForm:"dssid"},selected:{scriptClass:"mstr.models.ListModel",valueForm:"dssid"}});if(V){this._initializeDynamicModel(W,V,Y);}return V;};P.prototype.set=function U(Y,V){var X=mstr.models.BaseModel.prototype.set.apply(this,[Y,V]);if(!X){return ;}if(!this.translating&&this._isTranslatedProperty(Y)){this._storeDeltaProp(Y,V);}var W=this.get("broadcastProperties");if(W&&W[Y]){this.get("parent").notifyPropertyChange(Y,{memo:{value:V}});}};P.prototype.translateBone=function I(){var Z=this.getBone();var W=this.props.visibleField;if(W!=null&&W.length>0){this.set(W,Z.commands.queryEnabled(W));if(!this.props[W]){return ;}}if(!this.get("enabled")||!Z){return ;}var c=this.get("fields");if(!c){return ;}c=c.split("|");if(c[0]==""){c.shift();}if(c[c.length-1]==""){c.pop();}if(!c){return ;}this.translating=true;for(var a=0,Y=c.length;a<Y;a++){var X=c[a];if(!Z.commands.queryEnabled(X)){continue;}var e=this._getDeltaProp(X);if(e==null){e=Z.commands.queryState(X);}if(e&&typeof e=="string"){e=e.replace(/'+/g,"");}var V=this.props[X];if(mstr.models.ListCart&&V instanceof mstr.models.ListCart){V.get("selected").setItems(e);this._setModelChangeEventListeners(V,X);}else{if(V instanceof mstr.models.ListModel){var d=(mstr.$A.isArray(e))?"execSelectValues":"execSelectValue";var g=V[d](e);if(!g&&V.execClearSelect){V.execClearSelect();}this._setModelChangeEventListeners(V,X);}else{this.set(X,e);}}}this.translating=false;};P.prototype.onModelPropertyChange=function L(h){var Z=h.src;var g="";var W=null;if(h.name=="set_actualColor"){g=Z.get("actualColor");W=h.memo.valueWas;}else{var e=[];switch(h.name){case"hashadd_selectedIndices":case"hashremove_selectedIndices":e=Z.getSelectedItems();W=h.memo.at;break;case"listadd_items":case"listremove_items":e=Z.getItems();break;default:return ;}var a=Z.get("valueForm");var c="";for(var X=0,V=e.length;X<V;X++){g+=c+e[X][a];c=CLIPBOARD_ITEM_SEPARATOR;}}var Y=Z.get("mappedPropertyName");this.raiseEvent("set_"+Y,{name:Y,src:h.name,value:g,valueWas:W});if(this.translating){return ;}this._storeDeltaProp(Y,g);};P.prototype.resetDeltas=function B(){this.deltaProps={};mstr.models.BaseModel.prototype.set.apply(this,["hasChanges",false]);};P.prototype.collectChanges=function A(X){for(var W in this.deltaProps){var V=(W.indexOf("|")==-1)?{}:mstr.utils.Arrays.toHashProperties(W.split("|"),["category","unit","format"]);for(var Y in this.deltaProps[W]){X.push({obj:null,cmdId:Y,value:this.deltaProps[W][Y],memo:V,performFormatChange:true,submitUpdateManager:false});}}};P.prototype._isTranslatedProperty=function T(X){var V=this.props.fields;if(!V){return false;}var W=new RegExp("\\|"+X+"\\||^"+X+"\\||\\|"+X+"$|^"+X+"$");return W.test(V);};function P(V){mstr.models.BaseModel.apply(this,[V]);this.resetDeltas();}return P;})();mstr.bones.editors.BoneTranslatorManager=(function(){mstr.$O.extendsClass(P,mstr.models.ListModel);P.prototype.init=function A(){mstr.models.BaseModel.prototype.init.apply(this);this.attachEventListener(this,"set_lockedTab","_lockTabs");this._lockTabs();var R=this.getItems();var T=R.length;for(var S=0;S<T;S++){R[S].attachEventListener(this,"set_hasChanges","handleChanges");}this._startBoneTranslation();this._fixSelection();};P.prototype.on_set_viewDisabled=function N(R){this.set("CommandEnabledOkChanges",(!R.memo.value&&this.get("enableOk")));this.set("CommandEnabledPreviewChanges",(!R.memo.value&&this.get("enablePreview")));};P.prototype.on_set_enableOk=function J(R){this.set("CommandEnabledOkChanges",(R.memo.value&&!this.get("viewDisabled")));};P.prototype.on_set_enablePreview=function O(R){this.set("CommandEnabledPreviewChanges",(R.memo.value&&!this.get("viewDisabled")&&!this.get("disablePreview")));};P.prototype._startBoneTranslation=function K(){var R=this.getItems();var T=R.length;for(var S=0;S<T;S++){R[S].translateBone();}};P.prototype._lockTabs=function I(){var R=this.get("lockedTab");if(R!=-1){this.execSingleSelect(R);this.set("disableList",true);}else{this.set("disableList",false);}};P.prototype.execReinitializeModel=function E(){this.set("hasChanges",false);this.set("previewCount",0);this.props.enableOk=false;this.props.enablePreview=false;this.set("viewDisabled",false);this.set("disablePreview",false);this._reinitializeChildModels();this._fixSelection();};P.prototype._reinitializeChildModels=function G(){var R=this.getItems();for(var T=0,S=R.length;T<S;T++){R[T].reinitializeModel();}};P.prototype.handleChanges=function Q(R){this.set("hasChanges",R.memo.value);if(!R.memo.value){return ;}this.set("enableOk",true);this.set("enablePreview",true);if(this.get("lockedTab")!=-1&&!this.get("viewDisabled")){this.set("lockedTab",-1);}};P.prototype.disableModelFromView=function F(R){this.set("viewDisabled",R);};P.prototype.execOkChanges=function D(){this.saveModelChanges();this.set("enableOk",false);this.set("enablePreview",false);return true;};P.prototype.execPreviewChanges=function H(){var R=microstrategy.updateManager;if(R){R.observer.register(this.props.id);}this.saveModelChanges();this.set("enablePreview",false);this.props.previewCount++;if(R&&!R.isFlushing()){var S=mstr.$obj(this.get("boneId"));if(S&&S.commands.queryEnabled("oneTable")){this._initializeSelectors();}this._reinitializeChildModels();R.observer.unregister(this.props.id);}return true;};P.prototype.saveModelChanges=function C(){var S=new Array();var R=this.getItems();for(var U=0,T=R.length;U<T;U++){R[U].collectChanges(S);}if(S.length>0){var V=mstr.$obj(this.props.boneId);if(V){if(!(V.commands.exec(this.props.boneCmdId,S))){return false;}}}this.execClearChanges();return true;};P.prototype.execClearChanges=function L(){var R=this.getItems();for(var T=0,S=R.length;T<S;T++){R[T].resetDeltas();}};P.prototype.execCancelChanges=function M(){this.execClearChanges();var R=mstr.$obj(this.props.boneId);if(R){R.commands.exec("cancelEdit",this.get("previewCount"));}this.set("lockedTab",-1);this.set("enablePreview",false);this.set("enableOk",false);};P.prototype._fixSelection=function B(){var U=this.getSelectedItem();if(!U.get(U.get("visibleField"))){var R=this.getItems();for(var T=0,S=R.length;T<S;T++){if(R[T].get(R[T].get("visibleField"))){this.execSingleSelect(T);return ;}}}};function P(R){mstr.models.ListModel.apply(this,[R]);}return P;})();mstr.bones.editors.PropertiesBoneTranslatorManager=(function(){mstr.$O.extendsClass(I,mstr.bones.editors.BoneTranslatorManager);I.prototype._initializeSelectors=function N(){var X=mstr.$obj(this.get("boneId"));this.set("showGridSelectors",X.commands.queryEnabled("showGridSelectors"));this.set("showPanelSelector",X.commands.queryEnabled("showPanelSelector"));var V=["edtUnitSelector","edtValueSelector"];for(var W=0;W<2;W++){this._initializeSingleSelector(V[W]);}};I.prototype._initializeSingleSelector=function O(W){var X=mstr.$obj(this.get("boneId"));var V=this.get(W);V.detachEventListener(this,"hashadd_selectedIndices");V.set("cmdId",W);var Y=X.commands.queryState(W,this._getTabName());if(Y.isFetching&&(!this.pollInterval)){this._setGridModelEnablement(false);this.pollInterval=self.setInterval("mstr.$obj('"+this.get("id")+"').pollForGridFormat();",100);}V.set("visible",Y.visible);V.set("enabled",Y.enabled);if(Y.items){V.setItems(Y.items);if("value" in Y){V.execSelectValue(Y.value);}}V.attachEventListener(this,"hashadd_selectedIndices","updateTargetFromUnitSelectors");};I.prototype._getTabName=function B(){return mstr.controllers.Factory.safeget(this.getSelectedItem(),"tabName");};I.prototype._setGridModelEnablement=function C(W){var V=this.getItems();for(var Y=0,X=V.length;Y<X;Y++){var Z=mstr.controllers.Factory.safeget(V[Y],"unitSelectorChange");if(Z&&(Z.indexOf("Grid")>-1)){mstr.controllers.Factory.safeset(V[Y],"enabled",W);if(W&&V[Y].reinitializeModel){V[Y].reinitializeModel();}}}};I.prototype.on_set_enablePreview=function T(V){if(!V.memo.value||this.get("viewDisabled")){mstr.bones.editors.BoneTranslatorManager.prototype.on_set_enablePreview.apply(this,[V]);return ;}this.set("CommandEnabledPreviewChanges",!this.get("isGridFormatted"));};I.prototype.pollForGridFormat=function F(){var V=mstr.$obj(this.get("boneId"));if(V.commands.queryState("areGridFormatsReady")){this._clearGridFormatPoll();this._setGridModelEnablement(true);}};I.prototype._clearGridFormatPoll=function D(){if(this.pollInterval){self.clearInterval(this.pollInterval);delete this.pollInterval;}};I.prototype._cancelGridFormatPoll=function Q(){if(!this.pollInterval){return ;}this._clearGridFormatPoll();var Y=mstr.$obj(this.get("boneId"));Y.commands.exec("cancelGridFormatRequest");var V=this.getItems();for(var X=0,W=V.length;X<W;X++){mstr.controllers.Factory.safeset(V[X],"enabled",true);}};I.prototype._startBoneTranslation=function M(){this._initializeSelectors();mstr.bones.editors.BoneTranslatorManager.prototype._startBoneTranslation.apply(this);};I.prototype._handleDeltaPropStorage=function P(V){return ;var W=V.memo.category.split("|");if(W.length==3){if(W[0]=="Grid"||(W[0]=="AllGrid"&&W[1]!="0")){this.set("isGridFormatted",true);this.set("enablePreview",false);}}};I.prototype.init=function E(){mstr.bones.editors.BoneTranslatorManager.prototype.init.apply(this);this.set("isGridFormatted",false);var V=this.getItems();for(var X=0,W=V.length;X<W;X++){V[X].attachEventListener(this,"store_deltaProp","_handleDeltaPropStorage");}};I.prototype.acknowledgeReloadEnd=function U(){this.execReinitializeModel();var V=microstrategy.updateManager;if(V){V.observer.unregister(this.props.id);}};I.prototype.execReinitializeModel=function H(){this._initializeSelectors();this.set("isGridFormatted",false);this.set("showCancelButton",true);mstr.bones.editors.BoneTranslatorManager.prototype.execReinitializeModel.apply(this);var V=this.getSelectedItem();if(!V.get(V.get("visibleField"))){this.execSingleSelect(0);}};I.prototype.updateTargetFromUnitSelectors=function A(X){var W=X.src.get("cmdId");var V=this.get(W);var Y={src:W,v:V.getSelectedItem()[V.get("valueForm")],t:this._getTabName()};mstr.$obj(this.get("boneId")).commands.exec("setUnitFormatLevels",Y);if(W=="edtUnitSelector"){this._initializeSingleSelector("edtValueSelector");}this._reinitializeSelectorBasedModels();};I.prototype._reinitializeSelectorBasedModels=function S(){if(this.pollInterval){return ;}var V=this.getItems();for(var X=0,W=V.length;X<W;X++){var Y=V[X].get("unitSelectorChange");if(Y){V[X].reinitializeModel();}}};I.prototype.execClearChanges=function R(){mstr.bones.editors.BoneTranslatorManager.prototype.execClearChanges.apply(this);this._cancelGridFormatPoll();};I.prototype.execOpenWebHyperLinkEditor=function L(){mstr.$obj("rwb_viewer").doc.commands.exec("WebHyperLinkEditor");this.set("showCancelButton",false);};I.prototype.handleChanges=function G(V){mstr.bones.editors.BoneTranslatorManager.prototype.handleChanges.apply(this,[V]);V.memo.value&&this.set("showCancelButton",true);};I.prototype.on_hashadd_selectedIndices=function K(V){mstr.bones.editors.BoneTranslatorManager.prototype.on_hashadd_selectedIndices.call(this,V);var X=this._getTabName();if(X){mstr.$obj(this.get("boneId")).commands.exec("edtTabChange",X);}var W=this.getItems();if(W.length>0&&W[0].get){this._initializeSelectors();this._reinitializeSelectorBasedModels();}};I.prototype.notifyPropertyChange=function J(X,V){var W=this.getItems();for(var Z=0,Y=W.length;Z<Y;Z++){if(W[Z]["on_set_ext_prop_"+X]){W[Z]["on_set_ext_prop_"+X](V);}}};function I(V){mstr.bones.editors.BoneTranslatorManager.apply(this,[V]);}return I;})();mstr.bones.editors.FormatEditingBoneTranslator=(function(){mstr.$O.extendsClass(C,mstr.bones.editors.BoneTranslator);C.prototype._getPropertyCategory=function A(){var F=mstr.bones.editors.BoneTranslator.prototype._getPropertyCategory.apply(this);var J=this.get("parent");var H=J.get("edtUnitSelector");var I=J.get("edtValueSelector");var E=((J.get("showGridSelectors"))?"Grid":"default")+"|";var G=H.getSelectedItem();if(!G){return F;}E+=H.getSelectedItem()[H.get("valueForm")]+"|";G=I.getSelectedItem();if(!G){return F;}E+=I.getSelectedItem()[I.get("valueForm")];return E;};C.prototype.refreshForSearchBox=function B(G,E){if(E){var F=G.get("visibleField");if(F=="alignmentTabEnabled"||F=="effectsTabEnabled"){G.set(F,false);}}};C.prototype.translateBone=function D(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;var E=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);this.refreshForSearchBox(this,E);this.translating=false;};function C(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return C;})();mstr.bones.editors.EffectsPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.FormatEditingBoneTranslator);A.prototype.on_set_ext_prop_showTranslucent=function B(C){var D=C.InfoWindowMode;this.set("showTranslucent",(C.UseAsInformationWindow&&(D==="2"||D==="3"||D==="4")));};function A(C){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[C]);}return A;})();mstr.bones.editors.FontPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.FormatEditingBoneTranslator);A.prototype._getPropertyCategory=function C(){return mstr.bones.editors.FormatEditingBoneTranslator.prototype._getPropertyCategory.apply(this);};A.prototype.on_set_ext_prop_ButtonDisplayStyle=function B(D){var E=Number(D.memo.value);var F=this.get("visibleField");switch(E){case microstrategy.BUTTON_STYLE_CAPTION_ONLY:case microstrategy.BUTTON_STYLE_ICON_LEFT:case microstrategy.BUTTON_STYLE_ICON_RIGHT:case microstrategy.BUTTON_STYLE_ICON_TOP:this.set(F,true);break;case microstrategy.BUTTON_STYLE_ICON_ONLY:case microstrategy.BUTTON_STYLE_CUSTOM:this.set(F,false);break;}};function A(D){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[D]);}return A;})();mstr.bones.editors.LayoutPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(R,mstr.bones.editors.BoneTranslator);var E=null;var D={};R.prototype.init=function S(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);E=this.get("XTabView").getItems()[this.get("XTabView").indexOfValue("50")];};R.prototype.translateBone=function B(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);var Y=this.get("XTabView").getSelectedItemValue();this.set("ExportOverflowVisible",!this.get("IsPortal")&&(Y==1||Y==3));this.on_set_DataSource();D={};};R.prototype.getDynamicListModel=function I(a,Z){var Y=mstr.bones.editors.BoneTranslator.prototype.getDynamicListModel.apply(this,[a,Z]);if(Z=="DataSource"){this.on_set_DataSource();}else{if(Z=="EditSelectorStyle"){this.on_set_EditSelectorStyle();}}return Y;};R.prototype._setDynamicModelValues=function G(Z,a,c){if(Z=="EditSelectorStyle"){this.isNde=this._isNde();var Y=this._getApplicableStyles(this.isNde);this._setDynamicListModelValues(a,Y,Z);}else{mstr.bones.editors.BoneTranslator.prototype._setDynamicModelValues.apply(this,[Z,a,c]);}};R.prototype._isNde=function Q(){var c=mstr.controllers.Factory.getPath("parent/items/6/EditSelectorSource",this);var Y=c&&c.get("selectedIndicesList"),Z,a;if(Y!=undefined){a=c.get("items")[Y];Z=a.sty==12033;}else{a=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorSource");if(a){Z=a.split("|")[1]==47;}}return Z;};R.prototype._getApplicableStyles=function V(a){var d=[],Y=this.get("SelectorStyles").get("items"),Z,c;for(Z=0;Z<Y.length;Z++){c=Y[Z];if(a&&c.dssid==9){continue;}d.push(c);}this.isNde=a;return d;};R.prototype.on_set_ext_prop_EditSelectorSource=function M(Y){var d=this._isNde();if(d!=this.isNde){this.isNde=d;var a=this.get("EditSelectorStyle");if(a){var Z=this._getApplicableStyles(d),c=a.getSelectedItemValue();a.setItems(Z);if(c){a.execSelectValue(c);}}}};R.prototype.on_set_ext_prop_IsPortal=function P(Y){var Z=Y.memo.value;var a=this.translating;this.translating=true;this.set("IsPortal",Z);this.translating=a;if(!this.get("isOneGrid")){return ;}this.set("showFixedHeightOnly",Z);this.set("showFixedFitHeight",!Z);this.set("showFixedWidthOnly",Z);this.set("showFixedFitWidth",!Z);this.set("ExportOverflowVisible",!Z&&this.props.XTabView.getSelectedIndex()!=1);};R.prototype.on_set_DataSource=function F(Y){this.set("enableShortcut",this.props.DataSource&&this.props.DataSource.props.selectedCount>0&&!this.props.isCubeReportDataset);};R.prototype.on_set_XTabView=function J(Y){if(!this.translating){this.get("parent").notifyPropertyChange("XTabView",Y);this.set("ExportOverflowVisible",!this.get("IsPortal")&&(Y.memo.value==1||Y.memo.value==3));}};R.prototype.on_set_Height=function A(Y){if(this._shouldLockRatio()){this._lockRatio(Y,"Width");}};R.prototype.on_set_Width=function U(Y){if(this._shouldLockRatio()){this._lockRatio(Y,"Height");}};R.prototype.on_set_ext_prop_EditSelectorType=function H(Y){this.on_set_EditSelectorStyle(Y);};R.prototype.on_set_EnableSelCount=function H(Y){if(!this.get("EnableSelCount")){this.set("MaxSel","");this.set("MinSel","");}};R.prototype.on_set_ext_prop_isDSAsTarget=function X(Y){this._checkSearchBoxProps(Y);};R.prototype.on_set_ext_prop_EditSelectorStyle=function T(Y){this._checkSearchBoxProps(Y);};R.prototype._checkSearchBoxProps=function L(Y){var Z=this.isSearchBox(this);this.set("visibleSearchOnServ",Z);this.set("ItemWidthModeEnabled",!Z);if(Z){this.get("EditSelectorOrientation").set("selectedIndicesList",0);var a=this.get("setWidget");if(a){a.set("selectedIndicesList",0);}}mstr.bones.editors.ColorLinesPropertiesBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[8],Z);mstr.bones.editors.FormatEditingBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[11],Z);mstr.bones.editors.FormatEditingBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[12],Z);mstr.bones.editors.SelectorPageBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[6],Z);};R.prototype.on_set_EditSelectorStyle=function N(a){var d=mstr.controllers.Factory.getPath("parent/items/6/EditSelectorType",this);var Z,e,g;this._checkSearchBoxProps(a);if(d.props&&d.props.selectedIndicesList!=undefined){Z=d.props.selectedIndicesList=="2";e=d.props.selectedIndicesList=="4";g=d.props.selectedIndicesList=="5";}else{Z=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorType")=="3";e=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorType")=="5";g=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorType")=="8";}if(Z||g){this.set("EditSelectorMultiSelectEnabled",false);return ;}if(e){this.set("EditSelectorMultiSelectEnabled",true);return ;}var c=this.get("EditSelectorStyle"),Y=c&&c.props.selectedIndicesList;switch(Y){case"1":case"2":case"3":case"5":case"6":case"7":this.set("EditSelectorMultiSelectEnabled",true);break;default:this.set("EditSelectorMultiSelectEnabled",false);}this.set("ChangeSelectionOnMouseOverEnabled",(this.props.isSlicingSelector&&Y!=7));};R.prototype._shouldLockRatio=function W(){return(!this.translating&&!this.adjustingRatio&&this.get("LockAspectRatio"));};R.prototype._lockRatio=function K(Y,h){var a=Y.memo,Z=a.value,e=a.name,c=h;if(!(D[e]&&D[e].hasOwnProperty(c))){if(!D[e]){D[e]={};}var g=this.get(c)/a.valueWas;g=isNaN(g)||!isFinite(g)?0:g;D[e][c]=g;if(!D[c]){D[c]={};}D[c][e]=1/g;}this.adjustingRatio=true;this.set(h,Z*D[e][c]);this.adjustingRatio=false;};R.prototype.on_set_LockAspectRatio=function C(Y){if(!Y.memo.value){D={};}};R.prototype.isSearchBox=function O(a){var Y=mstr.controllers.Factory.getPath("parent/items/6/EditSelectorType",a);var d=mstr.controllers.Factory.getPath("parent/items/1/EditSelectorStyle",a);if(Y&&d){var Z=Y.getSelectedItemValue()!=null?Y.getSelectedItemValue():microstrategy.getViewerBone().commands.queryState("EditSelectorType");var c=d.getSelectedItemValue()!=null?d.getSelectedItemValue():microstrategy.getViewerBone().commands.queryState("EditSelectorStyle");return(Z=="1"&&c=="9");}return false;};function R(Y){mstr.bones.editors.BoneTranslator.apply(this,[Y]);}return R;})();mstr.bones.editors.GridPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.BoneTranslator);D.prototype.translateBone=function B(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;this.on_set_DrillOptions();this.translating=false;};D.prototype.on_set_DrillOptions=function C(E){var F=(E&&E.memo&&E.memo.value);if(F==null){F=this.get("DrillOptions").getSelectedItemValue();}if(F==""){return ;}this.set("showSyncDrillingOpt",(F==2)&&mstr.behaviors.featureResolver.featAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS));};D.prototype.IF_MODE_ROWS="1";D.prototype.IF_MODE_BLOCKS="2";D.prototype.on_set_gridIfRowMode=function A(K){var E=(K&&K.memo&&K.memo.value);if(E==null){E=this.get("gridIfRowMode").getSelectedItemValue();}if(E==""){return ;}var G=this.getBone(),H=G.doc.selections.getSelectedGrid(),F=microstrategy.findBone(H),J=F.ifTotalRows,I=F.ifTotalBlocks,L=this.get("gridIfMaxRows"),M=L;if(J&&I){if(E===this.IF_MODE_ROWS){M=Math.round(L*J/I)||1;}else{M=Math.round(L*I/J)||1;}}else{M=1;}this.set("gridIfMaxRows",M);};function D(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return D;})();mstr.bones.editors.NumberPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.FormatEditingBoneTranslator);D.prototype.init=function F(){mstr.bones.editors.FormatEditingBoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"set_Category","_buildFormatString");this.attachEventListener(this,"set_DecimalPlaces","_buildFormatString");this.attachEventListener(this,"set_ThousandSeparator","_buildFormatString");this.attachEventListener(this,"set_CurrencySymbol","_buildFormatString");this.attachEventListener(this,"set_CurrencyPosition","_buildFormatString");this.get("NegativeNumbers").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");this.get("Date").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");this.get("Time").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");this.get("Fraction").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");};D.prototype.translateBone=function E(){mstr.bones.editors.FormatEditingBoneTranslator.prototype.translateBone.apply(this);var J=this.get("Format");var L=this.get("Category").getSelectedItem();L=L?parseInt(L.dssid):-2;switch(L){case -2:case 9:if(this.get("Format")=="General"){var K=this.translating;this.translating=true;this.set("Format","");this.translating=K;}break;case 0:case 1:case 4:this._rebuildNegativeNumberField(this._buildDecimalString(true));break;case 2:this.get("Date").execSelectValue(J);break;case 3:this.get("Time").execSelectValue(J);break;case 5:this.get("Fraction").execSelectValue(J);break;}};D.prototype.onModelPropertyChange=function H(J){mstr.bones.editors.FormatEditingBoneTranslator.prototype.onModelPropertyChange.apply(this,[J]);this._buildFormatString(J);};D.prototype._buildDecimalString=function I(N){var J="";var L=parseInt(this.get("DecimalPlaces"));for(var K=0;K<L;K++){J+="0";}var M=".";if(N){M=mstr.$obj("mstrPageInfo").get("userInfo").get("decimalSeparator");}return(J.length>0)?M+J:"";};D.prototype._addNegativeFormatString=function A(J){switch(this.get("NegativeNumbers").getSelectedIndex()){case 1:return J+";[RED]-"+J;case 2:return J+";[RED]"+J;case 3:return J+";("+J+")";case 4:return J+";[RED]("+J+")";default:return J;}};D.prototype._addCurrencySymbolFormatString=function C(J){var K="";var L=this.get("CurrencySymbol");switch(this.get("CurrencyPosition").getSelectedIndex()){case 1:K=J+'"'+L+'"';break;case 2:K='"'+L+' "'+J;break;case 3:K=J+'" '+L+'"';break;default:K='"'+L+'"'+J;}return this._addNegativeFormatString(K);};D.prototype._buildFormatString=function B(M){var O=this.get("Category").getSelectedItem();if(!O){return ;}var K=parseInt(O.dssid);if(K==7){return ;}var J=this._buildDecimalString();if(K==0||K==1||K==4){this._rebuildNegativeNumberField(this._buildDecimalString(true));}var N=(this.get("ThousandSeparator"))?",":"";var L="";switch(K){case 0:L=this._addNegativeFormatString("#"+N+"##0"+J);break;case 1:L=this._addCurrencySymbolFormatString("#,##0"+J);break;case 2:L=this.get("Date").getSelectedItem()["dssid"];break;case 3:L=this.get("Time").getSelectedItem()["dssid"];break;case 4:L=this._addNegativeFormatString("0"+J+"%");break;case 5:L=this.get("Fraction").getSelectedItem()["dssid"];break;case 6:L="0"+J+"E+00";}this.set("Format",L);};D.prototype._rebuildNegativeNumberField=function G(Q){var L=this.translating;this.translating=true;var J=this.get("NegativeNumbers");var P=mstr.utils.Hash.deepClone(J.getItems());var T=J.getSelectedItem()&&J.getSelectedItem()["dssid"];J.detachEventListener(this,"hashadd_selectedIndices");J.detachEventListener(this,"hashremove_selectedIndices");var N=this.get("Red");var K=this.getBone().commands.queryState("textfieldSelected")?"color:red;display:block;":"color:red;display:none;";var S=mstr.Settings.Locale.THOUSANDSEP;var R=parseInt(this.get("Category").getSelectedItem()["dssid"]);switch(R){case 0:S=(this.get("ThousandSeparator"))?S:"";P[0]["n"]="-1"+S+"234"+Q;P[1]["n"]="-1"+S+"234"+Q+" ["+N+"]";P[1]["cssText"]=K;P[2]["n"]="1"+S+"234"+Q+" ["+N+"]";P[2]["cssText"]=K;P[3]["n"]="(1"+S+"234"+Q+")";P[4]["n"]="(1"+S+"234"+Q+") ["+N+"]";P[4]["cssText"]=K;break;case 1:var O="";var U="";var M=this.get("CurrencySymbol");switch(this.get("CurrencyPosition").getSelectedIndex()){case 2:O+=" ";case 0:O=M+O;break;case 3:U+=" ";case 1:U+=M;break;}P[0]["n"]=O+"-1"+S+"234"+Q+U;P[1]["n"]=O+"-1"+S+"234"+Q+U+" ["+N+"]";P[1]["cssText"]=K;P[2]["n"]=O+"1"+S+"234"+Q+U+" ["+N+"]";P[2]["cssText"]=K;P[3]["n"]="("+O+"1"+S+"234"+Q+U+")";P[4]["n"]="("+O+"1"+S+"234"+Q+U+") ["+N+"]";P[4]["cssText"]=K;break;case 4:P[0]["n"]="-123"+Q+"%";P[1]["n"]="-123"+Q+"% ["+N+"]";P[1]["cssText"]=K;P[2]["n"]="123"+Q+"% ["+N+"]";P[2]["cssText"]=K;P[3]["n"]="(123"+Q+"%)";P[4]["n"]="(123"+Q+"%) ["+N+"]";P[4]["cssText"]=K;break;}J.setItems(P);if(T){J.execSelectValue(T);}J.attachEventListener(this,"hashadd_selectedIndices","onModelPropertyChange");J.attachEventListener(this,"hashremove_selectedIndices","onModelPropertyChange");this.translating=L;};function D(J){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[J]);}return D;})();mstr.bones.editors.ColorLinesPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(C,mstr.bones.editors.FormatEditingBoneTranslator);C.prototype.on_set_enableBorders=function G(H){var I=mstr.controllers.Factory.safeget;this.resolveBorderEnablement(H.memo.value,I(this.get("parent").get("items")[12],"enabled3d"));};C.prototype.on_set_ext_prop_enabled3d=function D(H){this.resolveBorderEnablement(this.get("enableBorders"),H.memo.value);};C.prototype.resolveBorderEnablement=function B(I,H){this.set("enableBordersNot3d",I&&!H);};C.prototype.translateBone=function F(){mstr.bones.editors.FormatEditingBoneTranslator.prototype.translateBone.apply(this);this.translating=true;var H=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);this.refreshForSearchBox(this,H);this.translating=false;};C.prototype.refreshForSearchBox=function A(L,J){var M=microstrategy.formatType;var I=L.get("parent").get("edtValueSelector");var K=I.get("items");var H=mstr.$A.findByForm(K,4,"dssid",false);if(J&&H>=0){I.set("selectedIndicesList",H);}I.set("formatEnabled",!J);microstrategy.formatType=M;};C.prototype.on_set_ext_prop_ButtonDisplayStyle=function E(H){var I=Number(H.memo.value);var J=this.get("visibleField");switch(I){case microstrategy.BUTTON_STYLE_CAPTION_ONLY:case microstrategy.BUTTON_STYLE_ICON_LEFT:case microstrategy.BUTTON_STYLE_ICON_RIGHT:case microstrategy.BUTTON_STYLE_ICON_TOP:case microstrategy.BUTTON_STYLE_ICON_ONLY:this.set(J,true);break;case microstrategy.BUTTON_STYLE_CUSTOM:this.set(J,false);break;}};function C(H){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[H]);}return C;})();mstr.bones.editors.ThemePropertiesBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.FormatEditingBoneTranslator);function D(I){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[I]);}D.prototype._resolveAppliedThemeTypeSelected=function H(){var J=this.get("appliedThemeID"),I=this.get("appliedThemeType"),K=this.get("appliedThemeTypes");if(!K){return ;}switch(I){case microstrategy.APPLIED_THEME_NONE:case microstrategy.APPLIED_THEME_CUSTOM:K.execSelectValue(I);break;case microstrategy.APPLIED_THEME_DEFAULT:K.execSelectValue(J);break;}};D.prototype._resolveAppliedThemeAsLink=function G(){var I=this.get("appliedThemeAsLink"),J=this.get("appliedThemeAsTypes");if(!J){return ;}J.execSelectValue(I?"1":"0");};D.prototype.translateBone=function F(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;this._resolveAppliedThemeTypeSelected();this._resolveAppliedThemeAsLink();this.translating=false;};D.prototype._handleAppliedThemeTypeChange=function E(I){if(this.translating){return ;}var K=this.get("appliedThemeTypes"),J=K.getSelectedItemValue();if(J===microstrategy.APPLIED_THEME_CUSTOM){this.set("appliedThemeType",J);this.set("appliedThemeID",null);this.set("showAppliedThemeAsType",true);this.set("showCustomThemePicker",true);}else{if(J===microstrategy.APPLIED_THEME_NONE){this.set("appliedThemeType",J);this.set("appliedThemeID",null);this.set("showAppliedThemeAsType",false);this.set("showCustomThemePicker",false);}else{this.set("appliedThemeType",microstrategy.APPLIED_THEME_DEFAULT);this.set("appliedThemeID",J);this.set("showAppliedThemeAsType",true);this.set("showCustomThemePicker",false);}}};D.prototype._handleAppliedThemeAsTypeChange=function A(I){if(this.translating){return ;}var K=this.get("appliedThemeAsTypes"),J=K.getSelectedItemValue();this.set("appliedThemeAsLink",J==="0"?false:true);};D.prototype.onModelPropertyChange=function C(I){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[I]);if(this.get("appliedThemeTypes")==I.src&&I.name=="hashadd_selectedIndices"){this._handleAppliedThemeTypeChange(I);}else{if(this.get("appliedThemeAsTypes")==I.src&&I.name=="hashadd_selectedIndices"){this._handleAppliedThemeAsTypeChange(I);}}};D.prototype.execBrowseTheme=function B(J){var L=microstrategy.getViewerBone(),I=L.saveFolderId?L.saveFolderId:L.parentFolderID,K=this;microstrategy.showApplyThemeEditor(false,null,function(O,N,M){K.set("appliedThemeID",O);K.set("appliedThemePath",encode(M));});};return D;})();mstr.bones.editors.DocAdvancedBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype._storeDeltaProp=function B(E,C){mstr.bones.editors.BoneTranslator.prototype._storeDeltaProp.apply(this,arguments);if(E=="RefreshDocument"&&C){var D="RefreshFrequency";this._storeDeltaProp(D,this.get(D));}};function A(C){mstr.bones.editors.BoneTranslator.apply(this,[C]);}return A;})();mstr.bones.editors.DocMobileBoneTranslator=(function(){mstr.$O.extendsClass(B,mstr.bones.editors.BoneTranslator);B.prototype.set=function A(D,C){mstr.bones.editors.BoneTranslator.prototype.set.apply(this,[D,C]);};function B(C){mstr.bones.editors.BoneTranslator.apply(this,[C]);}return B;})();mstr.bones.editors.PageSetupPageBoneTranslator=(function(){mstr.$O.extendsClass(E,mstr.bones.editors.BoneTranslator);E.prototype.init=function C(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"set_PageWidth","_handlePaperSizeChange");this.attachEventListener(this,"set_PageHeight","_handlePaperSizeChange");this.attachEventListener(this,"set_ScalePercentage","_handleScalingChange");this.attachEventListener(this,"set_ScalePagesWide","_handleScalingChange");this.attachEventListener(this,"set_ScalePagesTall","_handleScalingChange");};E.prototype._handlePaperSizeChange=function D(O){if(this.translating||this.changingPaperSize){return ;}if(O.name=="hashremove_selectedIndices"){return ;}this.changingPaperSize=true;var J,M,N,H,L;var P=this.get("PaperType");var G=this.get("PaperOrientation");var F=O.src;if(F==this){J=parseFloat(microstrategy.number.toUSUnits(this.get("PageHeight"),true),10);M=parseFloat(microstrategy.number.toUSUnits(this.get("PageWidth"),true),10);N=G.getSelectedIndex();if(N==0&&M>J){G.execSingleSelect(1);}else{if(N==1&&J>M){G.execSingleSelect(0);}}H=Math.min(J,M);L=Math.max(J,M);if(!P.execSelectString(".*,"+H+","+L,P.get("valueForm"))){P.execClearSelect();}}else{if(F==P){var N=P.getSelectedItemValue().split(",").slice(1);var K=["PageWidth","PageHeight"];if(G.getSelectedIndex()!=0){K.reverse();}for(var I=0;I<N.length;I++){this.set(K[I],microstrategy.number.toUserUnits(N[I]));}}else{J=parseFloat(microstrategy.number.toUSUnits(this.get("PageHeight")),10);M=parseFloat(microstrategy.number.toUSUnits(this.get("PageWidth")),10);H=Math.min(J,M);L=Math.max(J,M);H=microstrategy.number.toUserUnits(H);L=microstrategy.number.toUserUnits(L);N=G.getSelectedIndex();if(N==0){if(J!=L){this.set("PageHeight",L);this.set("PageWidth",H);}}else{if(J!=H){this.set("PageHeight",H);this.set("PageWidth",L);}}}}this.changingPaperSize=false;};E.prototype.onModelPropertyChange=function A(F){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[F]);if(F.src==this.get("PaperType")||F.src==this.get("PaperOrientation")){this._handlePaperSizeChange(F);}};E.prototype._handleScalingChange=function B(F){if(this.translating||this.changingScale){return ;}this.changingScale=true;var H=this.get("Scaling");var G=H.getSelectedIndex();if(F.name=="set_ScalePercentage"){if(G!=0){H.execSingleSelect(0);}}else{if(G!=1){H.execSingleSelect(1);}}this.changingScale=false;};function E(F){mstr.bones.editors.BoneTranslator.apply(this,[F]);}return E;})();mstr.bones.editors.ButtonPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype.on_set_DisplayStyle=function D(E){var F=E.memo.value;this._onSetDisplayStyle(F);this.get("parent").notifyPropertyChange("ButtonDisplayStyle",E);};A.prototype._onSetDisplayStyle=function B(F){F=Number(F);var E=this;function G(H){E.set("normalURLEnable",H);E.set("highlightURLEnable",H);}switch(F){case microstrategy.BUTTON_STYLE_CAPTION_ONLY:G(false);break;case microstrategy.BUTTON_STYLE_ICON_ONLY:case microstrategy.BUTTON_STYLE_ICON_LEFT:case microstrategy.BUTTON_STYLE_ICON_RIGHT:case microstrategy.BUTTON_STYLE_ICON_TOP:case microstrategy.BUTTON_STYLE_CUSTOM:G(true);break;}if(this.get("isInsideNavBar")){this.set("highlightURLEnable",false);}};A.prototype.translateBone=function C(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;displayStyleValue=this.get("DisplayStyle").getSelectedItemValue();this._onSetDisplayStyle(displayStyleValue);this.translating=false;};function A(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return A;})();mstr.bones.editors.DocumentTabBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype.on_set_ExecutionFullScreenMode=function B(F){if(F.memo.value){this.set("ShowingBarsTemporarily",true);}};A.prototype.on_set_DefaultViewMode=function E(N){var G=this.get("DefaultViewMode");var L=mstr.utils.Hash.firstKey(N.memo.valueWas);var M=G.getItems()[L][G.get("valueForm")];switch(N.memo.src){case"hashremove_selectedIndices":this.cache={};this.cache[M]=true;break;case"hashadd_selectedIndices":this.cache[M]=false;this.changingRunMode=true;var I=this.get("AvailableViewModes");var F=this.get("AvailableExportModes");var H=I.getSelectedItems();var K=F.getSelectedItems();I.execEnableIndices(this.cache);F.execEnableIndices(this.cache);var J=function(O,S,Q){var P=O.getSelectedItems();outer:for(f1 in P){if(Q[P[f1].dssid]!=undefined){continue;}for(f2 in S){if(S[f2].dssid==P[f1].dssid){continue outer;}}var R=O.indexOfItem(P[f1]);O.execRemoveSelect(R);}};J(F,K,this.cache);J(I,H,this.cache);this.changingRunMode=false;if(!this._selectDefaultRunMode(I,M)){this._selectDefaultRunMode(F,M);}break;}};A.prototype._selectDefaultRunMode=function C(F,G){var H=F.indexOfValue(G);if(H==-1){return false;}var I=F.getSelectedIndices();if(!(H in I)){F.execAddSelect(H);}return true;};A.prototype.onModelPropertyChange=function D(F){if(this.changingRunMode){return ;}mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[F]);};function A(F){mstr.bones.editors.BoneTranslator.apply(this,[F]);}return A;})();mstr.bones.editors.WidgetBoneTranslator=(function(){mstr.$O.extendsClass(W,mstr.bones.editors.BoneTranslator);W.prototype.execOpenWidgets=function M(l){var h=getObjSumLeft(l),m=getObjSumTop(l)+getObjHeight(l),k;microstrategy.openBlockLoaderEditor("addWidgetMenu","InsertMenuBlockLoader",null,{cssText:"position:absolute;top:"+m+"px;left:"+h+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",useFixedPosition:"false",contextMenuName:"insertWidgetEditor",viewer:"#widgetBoneTranslator"},this,null,k);};W.prototype.execOpenVisPropsEditor=function F(o){var l=microstrategy.getViewerBone();if(l){var n=l.gridWidgets.lst;var u=n[this.props.widgetId];if(u&&u.edt){var s=l.doc.selections.getSelectedGrid();if(s){var k=microstrategy.findBone(s);if(k){if(this.isMojoVis(u.edt)){if(this.props.hasChanges){var t=this.props.parent.props.parent.props.models[0];t.execPreviewChanges();}return k.docViewer.commands.exec("mojoVisPropsEditor",u.edt);}var r=microstrategy.VIS_EDITOR_SCOPE_RW_GRID;var q=[r,u.edt,""];q.push(this.props.WidgetProps||"");var h=this.deltaProps["default"];var m=(h&&h.SecondaryDataProviders)?h.SecondaryDataProviders:this.props.SecondaryDataProvidersValue;q.push(m||"");k.commands.exec("visPropsEditor",q);}}}}};W.prototype.commands={getTranslator:function(){if(!this.t){this.t=mstr.$obj("widgetBoneTranslator");}return this.t;},queryEnabled:function(){return true;},queryVisible:function(){return true;},queryState:function(){return true;},exec:function(h){var l=this.getTranslator();var k=h.split(";")[1];l.set("widgetId",k);}};W.prototype.on_set_widgetId=function I(h){var k=h.memo.value;this.set("ADisplayEnabled",k!="");this.updateWidgetInfo(k);};W.prototype.updateWidgetInfo=function a(l){var z=this.getWidgetObj(l);if(z){var m=microstrategy.getViewerBone();this.setupSecondaryDataProviders(z);this.set("widgetName",z.t);this.set("FlashDisplayEnabled",!!z.wgt);this.set("DHTMLDisplayEnabled",!!z.vis);this.set("iPhoneDisplayEnabled",!!z.iphVis);this.set("iPadDisplayEnabled",!!z.ipadVis);this.updateIPhoneFullscreen();this.set("AndroidDisplayEnabled",!!z.aVis);this.set("AndroidTabletDisplayEnabled",!!z.atVis);this.set("AndroidDisplayFullScreenEnabled",!!this.props.AndroidDisplayEnabled&&m.isMultiLayout);if(!this.translating){this.sureBoolSet("FlashDisplay",!!this.props.FlashDisplayEnabled);this.sureBoolSet("DHTMLDisplay",!!this.props.DHTMLDisplayEnabled&&z.vis.vm!=50);this.sureBoolSet("iPhoneDisplay",!!this.props.iPhoneDisplayEnabled);this.sureBoolSet("iPhoneDisplayFullScreen",!!this.props.iPhoneDisplayEnabled);this.sureBoolSet("iPadDisplay",!!this.props.iPadDisplayEnabled);this.sureBoolSet("AndroidDisplay",!!this.props.AndroidDisplayEnabled);this.sureBoolSet("AndroidTabletDisplay",!!this.props.AndroidTabletDisplayEnabled);this.sureBoolSet("AndroidDisplayFullScreen",!!this.props.AndroidDisplayEnabled);this.set("WidgetProps","");}else{var y=m.commands.queryState("setWidget");if(y&&y!="None"){var m=microstrategy.getViewerBone(),q=!!m&&m.gridWidgets&&m.gridWidgets.lst;for(var o in q){var x=q[o];if(x.wgt&&(x.wgt.rsl==y||x.wgt.cn==y)){this.set("FlashDisplay",l==o);break;}}}var u=m.doc.selections.getSelectedGrid();if(u){var k=microstrategy.findBone(u);if(k){this.set("DHTMLDisplay",z.vis&&z.vis.s==k.selectedVisualization&&k.isVisualization);this.set("iPadDisplay",z.ipadVis&&z.ipadVis.s==k.iPadVis);}}var n=z.iphVis&&z.iphVis.s==m.iPhoneVis;var h=z.iphVis&&z.iphVis.s==k.iPhoneVis;this.set("iPhoneDisplay",n||h);this.set("iPhoneDisplayFullScreen",n);var s=z.aVis&&z.aVis.s==m.aVis;var r=z.aVis&&z.aVis.s==k.aVis;this.set("AndroidDisplay",s||r);if(m.aVis){this._storeDeltaProp("AndroidDisplay",true);}var t=z.atVis&&z.atVis.s==k.atVis;this.set("AndroidTabletDisplay",t);}this.set("OpenVisPropsEditor",z.edt);}else{this.props.NonFlashRender.execSelectValue(0);this.set("widgetName",microstrategy.descriptors.getDescriptor(181));this.sureBoolSet("FlashDisplayEnabled",false);this.sureBoolSet("DHTMLDisplayEnabled",false);this.sureBoolSet("iPhoneDisplayEnabled",false);this.sureBoolSet("iPadDisplayEnabled",false);this.sureBoolSet("AndroidDisplayEnabled",false);this.sureBoolSet("AndroidTabletDisplayEnabled",false);this.sureBoolSet("FlashDisplay",false);this.sureBoolSet("DHTMLDisplay",false);this.sureBoolSet("iPadDisplay",false);this.sureBoolSet("AndroidDisplay",false);this.sureBoolSet("AndroidTabletDisplay",false);this.sureBoolSet("iPhoneDisplay",false);this.sureBoolSet("iPhoneDisplayFullScreen",false);this.sureBoolSet("AndroidDisplayFullScreen",false);}this.updateLabelsForAltDisplay();this.updateFlashDisplayLabel();this.updateIPhoneDisplayLabel();this.updateIPadDisplayLabel();this.updateAndroidDisplayLabel();this.updateAndroidTabletDisplayLabel();};W.prototype.sureBoolSet=function L(k,h){if(h==this.props[k]){this.props[k]=!h;}this.set(k,h);};W.prototype.setupSecondaryDataProviders=function J(h){if(!h){h=this.getWidgetObj(this.props.widgetId);}if(!h){this.set("showSecondaryDataProviders",false);return ;}if((!!this.props.FlashDisplay||!!this.props.DHTMLDisplay||!!this.props.iPadDisplay||!!this.props.AndroidDisplay||!!this.props.AndroidTabletDisplay||!!this.props.iPhoneDisplay)&&(h.smn>0||h.smx>0)){this.set("showSecondaryDataProviders",true);this.validateSecondaryDataProviders();}else{this.set("showSecondaryDataProviders",false);if(!this.translating){this.get("parent").set("enableOk",true);this.get("parent").set("enablePreview",true);}}};W.prototype.validateSecondaryDataProviders=function e(h){var k=this.get("SecondaryDataProviders"),m=k&&k.get("selected").get("items").length,l=this.getWidgetObj(this.get("widgetId"));if(!l){return ;}if(m<l.smn||m>l.smx){this.get("parent").set("enableOk",false);this.get("parent").set("enablePreview",false);}else{this.get("parent").set("enableOk",true);this.get("parent").set("enablePreview",true);}};W.prototype.on_set_SecondaryDataProviders=function c(h){this.validateSecondaryDataProviders();};W.prototype.on_set_FlashDisplay=function N(h){this.setupSecondaryDataProviders();this.updateFlashDisplayLabel();};W.prototype.updateFlashDisplayLabel=function R(){this.set("FlashDisplayLabel",!!this.props.FlashDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.on_set_DHTMLDisplay=function d(h){this.setupSecondaryDataProviders();this.set("DHTMLDisplayLabel",h.memo.value?this.props.widgetName:this.props.PDFExcelDisplayLabel);};W.prototype.on_set_iPhoneDisplay=function Q(h){this.setupSecondaryDataProviders();this.updateIPhoneDisplayLabel();};W.prototype.on_set_iPhoneDisplayFullScreen=function E(h){this.sureBoolSet("iPhoneDisplay",!!this.props.iPhoneDisplay);};W.prototype.updateIPhoneDisplayLabel=function H(){this.set("iPhoneDisplayLabel",!!this.props.iPhoneDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.updateIPhoneFullscreen=function U(){this.set("iPhoneDisplayFullScreenEnabled",!!this.props.iPhoneDisplay&&!!this.props.iPhoneDisplayEnabled&&microstrategy.getViewerBone().isMultiLayout);};W.prototype.on_set_iPadDisplay=function g(h){this.setupSecondaryDataProviders();this.updateIPadDisplayLabel();};W.prototype.updateIPadDisplayLabel=function C(){this.set("iPadDisplayLabel",!!this.props.iPadDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.on_set_AndroidDisplay=function T(h){this.setupSecondaryDataProviders();this.updateAndroidDisplayLabel();};W.prototype.on_set_AndroidTabletDisplay=function K(h){this.setupSecondaryDataProviders();this.updateAndroidTabletDisplayLabel();};W.prototype.on_set_AndroidDisplayFullScreen=function Y(h){this.sureBoolSet("AndroidDisplay",!!this.props.AndroidDisplay);};W.prototype.on_set_mojoVisPropsChanged=function D(h){if(h.memo.value){this.setupSecondaryDataProviders();}};W.prototype.updateAndroidDisplayLabel=function A(){this.set("AndroidDisplayLabel",!!this.props.AndroidDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.updateAndroidTabletDisplayLabel=function G(){this.set("AndroidTabletDisplayLabel",!!this.props.AndroidTabletDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.on_set_NonFlashRender=function Z(h){this.updateLabelsForAltDisplay();};W.prototype.updateLabelsForAltDisplay=function P(){this.set("PDFExcelDisplayLabel",this.getAltDisplayLabel(this.props.NonFlashRender.props.selectedIndicesList));this.set("DHTMLDisplayLabel",!!this.props.DHTMLDisplay?this.props.widgetName:this.props.PDFExcelDisplayLabel);};W.prototype.getAltDisplayLabel=function S(h){var k=7759;if(h=="1"){k=7760;}else{if(h=="2"){k=7761;}}return microstrategy.descriptors.getDescriptor(k);};W.prototype.getWidgetObj=function V(l){var k=microstrategy.getViewerBone(),h=!!k&&k.gridWidgets&&k.gridWidgets.lst;return !!h&&h[l];};W.prototype.isMojoVis=function B(h){return["GraphMatrixVisualizationStyle","VIHeatMapVisualizationStyle","NetworkVisualizationStyle"].indexOf(h)>-1;};W.prototype.onModelPropertyChange=function X(h){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[h]);this.validateSecondaryDataProviders(h);};W.prototype.translateBone=function O(){this.props.widgetId="-1";mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);};function W(h){mstr.bones.editors.BoneTranslator.apply(this,[h]);}return W;})();mstr.bones.editors.OnlineBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.BoneTranslator);D.prototype.init=function C(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);if(!this.get("boneModel")){return ;}var G=this.props.parent;if(G){var H=mstr.$obj(G.props.boneId);if(H&&H.observer){H.observer.register(this.get("id"));}}};D.prototype.onselectionchange=function(){this.translateBone();};D.prototype.translateBone=function E(){var H=this.get("boneModel");var I=this.props.enabledField;if(I!=null&&I.length>0){var G=H.commands.queryEnabled(I);if(G!=this.props[I]){this.set(I,G);}if(!this.props[I]){return ;}}mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);};D.prototype.on_set_fontTabEnabled=function B(H){var G=this.props.fields;var K=G&&G.length>0?G.split("|"):[];var J;for(var I=0;I<K.length;I++){J=K[I];if(!J||!J.length>0){continue;}this.props[J]&&this.props[J].set&&this.props[J].set(H.memo.name,H.memo.value);}};D.prototype._storeDeltaProp=function A(H,G){this.exec(H,G);};D.prototype.exec=function F(K,G){var I=this.props.parent;if(I){var J=mstr.$obj(I.props.boneId);if(J){var H=[{obj:null,cmdId:K,value:G,memo:{},performFormatChange:true,submitUpdateManager:false}];if(!(J.commands.exec(I.props.boneCmdId,H))){return false;}}}};function D(G){mstr.bones.editors.BoneTranslator.apply(this,[G]);}return D;})();mstr.bones.editors.TOCPageBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype._resolveTOCTitleSet=function C(E){if(E&&E.props&&E.props.selectedCount&&E.props.selectedCount==1&&E.props.selectedIndicesList){if(E.props.selectedIndicesList=="0"||E.props.selectedIndicesList==""){this.set("TOCBorderStyleEnable",false);}else{this.set("TOCBorderStyleEnable",true);}}};A.prototype.onModelPropertyChange=function B(E){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[E]);if(E.src==this.get("TOCBorderStyle")){this._resolveTOCTitleSet(E.src);}};A.prototype.set=function D(H,F){mstr.bones.editors.BoneTranslator.prototype.set.apply(this,[H,F]);if(H=="EnableToc"||H=="TOCTitleEnableInherit"){var E=this.get("EnableToc");var G=this.get("TOCTitleEnableInherit");if(E&&!G){this.set("TOCTitleSetEnable",true);}else{this.set("TOCTitleSetEnable",false);}}if(H=="EnableToc"){this._resolveTOCTitleSet(this.get("TOCBorderStyle"));}};function A(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return A;})();mstr.bones.editors.SelectorPageBoneTranslator=(function(){mstr.$O.extendsClass(B,mstr.bones.editors.BoneTranslator);B.prototype.init=function K(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"openPopup","_handleOpenPopup");};B.prototype.reinitializeModel=function S(){mstr.bones.editors.BoneTranslator.prototype.reinitializeModel.apply(this);if(this.get(this.props.visibleField)){this._resolveUCLogic();}this._resolveStateEnabled();var AD=null;var AC=null;var AE=this.translating;this.translating=true;this._resolveDelimiterSelected();this._resolveAttrFormSelected();this._resolveAttrFormEnabled();this.translating=AE;};B.prototype._resolveDelimiterSelected=function AA(){if(!this.get("EditSelectorSource")){return ;}var AD=this.get("showFormDelimiters");if(this.get("EditSelectorSource").getSelectedIndex()==0){AD.execSingleSelect(0);}else{var AC=this.get("EditFormDelimiter");if(AC==" "){AC="SPACE";}AD.execSelectValue(AC)||AD.execSingleSelect(4);}};B.prototype._resolveAttrFormSelected=function R(){if(!this.get("EditSelectorSource")){return ;}var AD=this.get("displayForms");if(this.get("EditSelectorSource").getSelectedIndex()==0){this.updateDisplayFormList(null);AD.execSingleSelect(0);this.attrFormSelectedIndex=0;this.attrFormSelectedItems=null;}else{var AE=this.get("EditDisplayForm");if(AE==mstr.Enum.AttrFormSelector.CUSTOM){var AC=this.get("selectedAttrForms");this.updateDisplayFormList(AC);this.checkAvailabilityAndSelect(AC);this.attrFormSelectedIndex=1;this.attrFormSelectedItems=AC;}else{this.updateDisplayFormList(null);AD.execSingleSelect(0);this.attrFormSelectedIndex=0;this.attrFormSelectedItems=null;}}};B.prototype._resolveAttrFormEnabled=function g(){if(!this.get("EditSelectorSource")){return ;}this.set("displayFormsEnable",true);var AC=this.get("EditSelectorSource").getSelectedIndex();if(AC<0){return ;}if(AC==0){this.set("displayFormsEnable",false);}else{var AF=this.getBone().commands.queryState("documentAttributesType")[AC];if(!AF){return ;}var AE=AF.type.split("|")[0];var AD=AF.type.split("|")[1];if(AE&&(AE==microstrategy.DSSTYPE_CONSOLIDATION||(AE==microstrategy.DSSTYPE_FILTER&&AD==microstrategy.DSSTYPE_CUSTOM_GROUP))){this.set("displayFormsEnable",false);}else{this.set("displayFormsEnable",true);}}};B.prototype._initializeDynamicModel=function m(AC,AD,AG){if(AC=="selectedAttrForms"){this._setDynamicModelValues(AC,AD,AG);this.set("afCartModel",AD);var AF=AD.get("selected");AF.attachEventListener(this,"listadd_items","onOkEnabledChange");AF.attachEventListener(this,"listremove_items","onOkEnabledChange");this.set("okBtnEnable",!!(AD&&AD.props&&AD.props.selected&&AD.props.selected.getItems().length>0));}else{if(AC=="sortAttrForm"){this._setDynamicModelValues(AC,AD,AG);this.set("afListModel",AD);AD.attachEventListener(this,"hashadd_selectedIndices","onModelPropertyChange");this._resolveSortType();}else{mstr.bones.editors.BoneTranslator.prototype._initializeDynamicModel.apply(this,[AC,AD,AG]);if(AC=="EditSelectorTargets"){var AE=this.translating;this.translating=true;this._resolveUCLogic();this.translating=AE;}if(AC=="selectorCurrentState"){var AE=this.translating;this.translating=true;this._resolveCountEnabled();this._resolveStateEnabled();this._resolveAllEnabled();this.translating=AE;}if(AC=="EditSelectorSource"){var AE=this.translating;this.translating=true;this._resolveDelimiterSelected();this._resolveAttrFormSelected();this._resolveAttrFormEnabled();this.translating=AE;}}}};B.prototype.checkAvailabilityAndSelect=function q(AH){if(this.availAttrForms==null){this.availAttrForms={};}var AD=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue();if(AD){var AF=AD.split("|")[0];if(this.availAttrForms[AF]==null){var AE=this;var AC={success:function(AN){var AI=[];var AM={};for(var AL in AN.objects){var AP=AN.objects[AL];var AJ=AP.did+"|"+AP.t+"|"+AP.n;AI.push({dssid:AJ,n:AP.n});AM[AJ]=true;}AE.availAttrForms[AF]=AI;var AO=[];for(var AL in AH){if(AM[AH[AL].dssid]){AO.push(AH[AL]);}}var AK=AE.translating;AE.translating=true;AE.updateDisplayFormList(AO);AE.translating=AK;},failure:function(AI){AE.updateDisplayFormList([]);}},AG={taskId:"getWSAttributeForms",attributeID:AF,objectType:55,msgID:this.getBone().messageID};mstr.$XHR.request(mstrConfig.taskURL,AG,AC);}}};B.prototype._getAvailableSortForm=function x(AG,AE){if(!AG||!AE){return undefined;}var AD=AG.split("|")[0],AC=AE.length,AH;for(var AF=0;AF<AC;AF++){AH=AE[AF].dssid;if(AD==AH.split("|")[0]){return AH;}}return undefined;};B.prototype._setDynamicModelValues=function I(AC,AD,AG){if(AG=="availAttrFormsList"||AG=="availAttrFormsCart"){if(this.availAttrForms==null){this.availAttrForms={};}var AE=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue();if(AE){var AF=AE.split("|")[0];if(this.availAttrForms[AF]==null){return ;}else{if(AG=="availAttrFormsList"){this._setDynamicListModelValues(AD,this.availAttrForms[AF],AC);}else{this._setDynamicCartModelValues(AD,this.availAttrForms[AF],AC);}}}}else{mstr.bones.editors.BoneTranslator.prototype._setDynamicModelValues.apply(this,[AC,AD,AG]);}};B.prototype._setDynamicListModelValues=function Z(AE,AI,AG){if(AG=="sortAttrForm"){var AF=microstrategy.descriptors.getDescriptor("959"),AD=this.get(AG)||this.getBone().commands.queryState(AG),AL=AD.dssid,AI,AC=mstr.Enum.AttrFormSelector.DEFAULT_SORT;if(AL){AL=this._getAvailableSortForm(AL,AI)||AC;}else{AL=AC;}AI=AI&&[{dssid:AC,n:AF}].concat(AI);}else{var AL=this.getBone().commands.queryState(AG);}if(AG=="EditSelectorSource"){var AM=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);if(AM){AI=this.getBone().commands.queryState("documentPureAttributes");}}var AH=this.getBone().commands.queryState("isAQSelector");if(AH){AI=this.getBone().commands.queryState("documentAttributesWithDateForm");}AE.setItems(AI);var AK=(mstr.$A.isArray(AL))?"execSelectValues":"execSelectValue";var AJ=AE[AK](AL);if(AG=="EditSelectorSource"&&!AJ){AE.execSingleSelect(0);}};B.prototype._setDynamicCartModelValues=function Y(AE,AD,AC){AE.get("available").setItems(AD);if(AC=="selectedAttrForms"){var AF=this.get(AC)||this.getBone().commands.queryState(AC);}else{var AF=this.getBone().commands.queryState(AC);}AE.get("selected").setItems(AF);AE._updateAvailableFilteredItems();};B.prototype._resolveSelecotrSourceForUConDS=function y(AJ){if(AJ&&AJ.selectedCount==1){if(isNaN(AJ.selectedIndicesList)){return false;}var AG=parseInt(AJ.selectedIndicesList);if(AJ.items[AG]){var AE=AJ.items[AG],AI=-1,AF=AE.sty;var AC=AE.dssid.split("|");if(AC.length>2&&!isNaN(AC[1])){AI=parseInt(AC[1]);}var AK=this.get("dsAsTgtChkVisible"),AD=this.get("isDSAsTarget"),AH=this.get("EditSelectorType"),AL=AH.getSelectedItemValue();if(AI===parseInt(microstrategy.DSSTYPE_ATTRIBUTE)&&AF!==microstrategy.DSSSUB_TYPE_DERIVED_ATTRIBUTE&&AL!==mstrRWControlImpl.CTL_TYPE_ATTR_QUAL&&AL!==mstrRWControlImpl.CTL_TYPE_ATTR_LIST){if(!AK){this.set("dsAsTgtChkVisible",true);}}else{if(AD){this.set("isDSAsTarget",false);}if(AK){this.set("dsAsTgtChkVisible",false);}}}}};B.prototype._resolveEditSelectorTargetsCartList=function w(AC){var AF=this.get("EditSelectorSource");if(!AF||!AF.getSelectedItem()){return ;}var AE=AF.getSelectedItem().olap,AD=AF&&AF.getSelectedItem(),AG=AD&&AD.de&&AD.sty!=12033;lastSelectedItem=AF.getItems()[this.lastSelectedSourceIdx],lastde=lastSelectedItem&&lastSelectedItem.de&&lastSelectedItem.sty!=12003,lastOlap=lastSelectedItem&&lastSelectedItem.olap;if(AE&&!lastOlap||AG&&!lastde){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",this.get("EditSelectorTargets"),"availableTemplatesNoPlaceholder");}else{if(!AE&&lastOlap||!AG&&lastde){this._setDynamicModelValues("EditSelectorTargets",this.get("EditSelectorTargets"),"availableTemplates");}}};B.prototype._storeLastSelectedSourceIdx=function J(AC){if(AC&&AC.memo){this.lastSelectedSourceIdx=mstr.utils.Hash.firstKey(AC.memo.at);}};B.prototype.onModelPropertyChange=function C(AC){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[AC]);if(AC.src==this.get("EditSelectorType")){this._handleSelectorTypeChange();this.get("parent").notifyPropertyChange("EditSelectorType",AC);this._resolveUCLogic();this._resolveStateUCVisible();this._resolveCountEnabled();this._resolveStateEnabled();this._resolveAllEnabled();this._resolveGUIComponentsVisible();this._resolveCartListVisible();}else{if(AC.src==this.get("DataFilterMode")){this._resolveTotalAndAutoSynchEnabled();this._resolveCountEnabled();this._resolveStateUCVisible();this._resolveUpdateFilterTargetEnabled();}else{if(this.get("EditSelectorTargets")&&(AC.src==this.get("EditSelectorTargets").get("selected")||this.get("EditSelectorSource")==AC.src)){this._resolveUCLogic();if(this.get("EditSelectorSource")==AC.src){this._resolveAttrFormEnabled();this._resolveEditSelectorTargetsCartList(AC);this._storeLastSelectedSourceIdx(AC);}if(AC.name!="listremove_items"&&!this.translating){this._resolveDataFilterMode();}}else{if(this.get("EditSelectorTargets")&&(AC.src==this.get("EditSelectorTargets").get("selected")||this.get("EditSelectorSourceDDIC")==AC.src)){this._resolveUCLogic();if(AC.name!="listremove_items"&&!this.translating){this._resolveDataFilterMode();}}else{if(this.get("selectorCurrentState")==AC.src){this._resolveCountEnabled();}else{if(this.get("EditSelectorSelectionType")==AC.src){this._resolveAllEnabled();}else{if(this.get("showFormDelimiters")==AC.src&&AC.name=="hashadd_selectedIndices"){this._resolveDelimiter();}else{if(this.get("displayForms")==AC.src&&AC.name=="hashadd_selectedIndices"){this._resolveDisplayForm();}else{if(this.get("afListModel")==AC.src&&AC.name=="hashadd_selectedIndices"){this._resolveSortType();}}}}}}}}}if(this.get("EditSelectorSource")==AC.src&&AC.name=="hashadd_selectedIndices"){this._clearAttrFormSelector();this.get("parent").notifyPropertyChange("EditSelectorSource",AC);this._resolveSelecotrSourceForUConDS(AC.src.props);}};B.prototype.set=function P(AF,AD){mstr.bones.editors.BoneTranslator.prototype.set.apply(this,[AF,AD]);if(AF=="isDSAsTarget"){var AE=this.get("EditSelectorType");if(AD){this.set("DataFilterVisible",false);this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",true);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);this.set("selectorAutoSyncVisible",false);this.set("showTotalVisible",false);this.set("countVisible",false);this.set("selectionTypeVisible",false);this._moveSelectedBack("EditSelectorTargets");}else{if(AE.getSelectedItemValue()==1){if(!this.getBone().commands.queryState("isMetricQualifier")){this.set("DataFilterVisible",true);}this.set("attrLCVisible",true);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);this.set("selectorAutoSyncVisible",true);var AC=this.getBone().commands.queryState("isDDIC");this.set("showTotalVisible",!AC);this.set("countVisible",!AC);this.set("selectionTypeVisible",!AC);this._moveSelectedBack("EditSelectorTargetsDataset");}}this._resolveStateUCVisible();}else{if(AF=="Autowire"){this.set("showAutoWireMessage",AD);}}};B.prototype._moveSelectedBack=function u(AD){var AC=this.get(AD);if(AC){AC.execRemoveAll();}};B.prototype._resolveStateUCVisible=function V(){var AD=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();var AE=this.get("DataFilterMode");var AF=AE&&AE.getSelectedItemValue();var AC=this.get("isDSAsTarget");if(AF==null||AF==undefined){AF=this.getBone().commands.queryState("DataFilterMode");}if(AF=="1"||(AD=="1"&&AC)){this.set("stateUCVisible",true);}else{this.set("stateUCVisible",false);}};B.prototype._resolveGUIComponentsVisible=function O(){var AD=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();this.set("DataFilterVisible",true);this.set("selectionTypeVisible",false);this.set("showAdvanced",true);if(AD==1){this.set("dsAsTgtChkVisible",true);var AC=this.get("isDSAsTarget");if(AC){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",true);this.set("attrReplaceLCVisible",false);this.set("DataFilterVisible",false);this.set("submissionLCVisible",false);}else{this.set("attrLCVisible",true);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("selectionTypeVisible",true);this.set("submissionLCVisible",false);}}else{if(AD==2){this.set("dsAsTgtChkVisible",false);this.set("isDSAsTarget",false);this.set("attrLCVisible",false);this.set("metricLCVisible",true);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AD==3){this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AD==4){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("DataFilterVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",true);}else{if(AD==8){this.set("dsAsTgtChkVisible",false);this.set("isDSAsTarget",false);this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",true);this.set("DataFilterVisible",false);this.set("showAdvanced",false);this.set("submissionLCVisible",false);this.set("EditSelectorShowAll",false);this.set("EditSelectorMultiSelect",false);}}}}}this._resolveStateUCVisible();};B.prototype._clearAttrFormSelector=function E(){if(!this.translating){this._clearPopupDelta();this.get("displayForms").execSingleSelect(0);this.get("showFormDelimiters").execSingleSelect(0);if(this.get("stRadioList")){this.get("stRadioList").execClearSelect();}}};B.prototype._resolveSortType=function X(){if(this.translating){return ;}if(!this.get("stRadioList")){this.getSortTypeModel();}if(this.get("afListModel").getSelectedItemValue()==mstr.Enum.AttrFormSelector.DEFAULT_SORT){this.get("stRadioList").execClearSelect();this.set("SortTypeEnabled",false);}else{var AC=this.get("sortType");this.get("stRadioList").execSelectValue(AC);this.set("SortTypeEnabled",true);}};B.prototype._resolveDisplayForm=function n(){if(!this.translating){displayFormList=this.get("displayForms");if(!displayFormList){return ;}var AC=displayFormList.getSelectedItemValue();if(AC==mstr.Enum.AttrFormSelector.AUTOMATIC){if(displayFormList.props.items.length>2){this._removeCustom(displayFormList);}this.set("EditDisplayForm",AC);this.attrFormSelectedIndex=0;this.attrFormSelectedItems=null;}else{if(AC=="custom"){this.execTryOpenPopup("AttrFormsEditor","AttrFormsCartBlock","selectedAttrForms","availAttrFormsCart");this.set("EditDisplayForm",mstr.Enum.AttrFormSelector.CUSTOM);}}}};B.prototype._clearPopupDelta=function o(){this.set("selectedAttrForms",[]);this.set("sortAttrForm",mstr.Enum.AttrFormSelector.DEFAULT_SORT);};B.prototype.execTryOpenPopup=function G(AE,AG,AJ,AC){if(this.availAttrForms==null){this.availAttrForms={};}var AL=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue(),AD=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItem().n;if(AL){var AI=AL.split("|")[0],AM=arguments;AM.title=microstrategy.descriptors.getDescriptor("2890")+(AD?" - "+AD:"");if(this.availAttrForms[AI]==null){var AK=this;var AF={success:function(AP){var AN=[];for(var AO in AP.objects){var AQ=AP.objects[AO];AN.push({dssid:AQ.did+"|"+AQ.t+"|"+AQ.n,n:AQ.n});}AK.availAttrForms[AI]=AN;AK.raiseEvent("openPopup",{args:AM});},failure:function(AN){showMessage({contents:AN.getResponseHeader("X-MSTR-TaskFailureMsg"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}},AH={taskId:"getWSAttributeForms",attributeID:AI,objectType:55,msgID:this.getBone().messageID};mstr.$XHR.request(mstrConfig.taskURL,AH,AF);}else{this.raiseEvent("openPopup",{args:AM});}}};B.prototype._handleOpenPopup=function a(AC){args=AC&&AC.memo&&AC.memo.args;editorId=args[0],editorStyle=args[1],propertyName=args[2],source=args[3];microstrategy.openBlockLoaderEditor(editorId,editorStyle,{},{title:(args&&args.title)||""},this,null,null);if(propertyName=="selectedAttrForms"&&this.get("afCartModel")){this._setDynamicModelValues(propertyName,this.get("afCartModel"),source);}else{if(propertyName=="sortAttrForm"&&this.get("afListModel")){this._setDynamicModelValues(propertyName,this.get("afListModel"),source);mstr.$obj("tt").render();}}};B.prototype.onOkEnabledChange=function F(AC){model=AC&&AC.src;this.set("okBtnEnable",!!(model&&model.getItems().length>0));};B.prototype.execSelectAttrForms=function k(AE){if(AE&&AE.get("selected")){var AD=AE.get("selected"),AC=AD.getItems();if(this.translating){return ;}this.updateDisplayFormList(AC);AC=AC&&[].concat(AC);this.set("selectedAttrForms",AC);this.attrFormSelectedIndex=1;this.attrFormSelectedItems=AC;}};B.prototype.updateDisplayFormList=function Q(AD){displayFormList=this.get("displayForms");if(displayFormList.get("items").length>2){this._removeCustom(displayFormList);}if(!AD||AD.length==0){displayFormList.execSingleSelect(0);return ;}this.set("selectedAttrForms",AD);itemValue=AD[0].n;for(i=1;i<AD.length;i++){itemValue+=","+AD[i].n;}var AC=mstr.Enum.AttrFormSelector.CUSTOM;displayFormList.insertItemsAt([{dssid:AC,n:itemValue}],2);displayFormList.execSingleSelect(2);};B.prototype._removeCustom=function T(AC){this.set("selectedAttrForms",[]);AC.removeItemsAt([2]);var AD=mstr.$obj("formLPD");if(AD&&AD.props.currentPopUp){AD.props.currentPopUp.props.scrollArea.children[0].style.width="200px";}};B.prototype.execCancelSelectAttrForms=function t(){if(this.attrFormSelectedIndex==0){this.get("displayForms").execSingleSelect(0);return ;}else{if(this.attrFormSelectedIndex==1&&this.attrFormSelectedItems){this.updateDisplayFormList(this.attrFormSelectedItems);return ;}}this.get("displayForms").execSingleSelect(0);};B.prototype.execSelectSortAttrForm=function r(){if(this.translating){return ;}var AD=this.get("afListModel").getSelectedItem();var AC=mstr.$H.clone(AD);AC.attr=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue();this.set("sortAttrForm",AC);this.set("sortType","-1");this.set("sortType",this.get("stRadioList").getSelectedItemValue());};B.prototype._resolveDelimiter=function e(){var AD=this.get("showFormDelimiters");var AE=AD.getSelectedItemValue()||"";if(AE=="OTHER"){var AC=this.get("EditFormDelimiter");if(AC==":"||AC==";"||AC==","||AC==" "){AC=":";}this.set("EditFormDelimiter",AC);}else{if(AE=="SPACE"){AE=" ";}this.set("EditFormDelimiter",AE);}};B.prototype.getSortTypeModel=function d(){var AC=this._createNewModel({scriptClass:"ListModel",parent:this,valueForm:"dssid"});var AD=microstrategy.descriptors.getDescriptor("1885"),AE=microstrategy.descriptors.getDescriptor("1886");AC.setItems([{dssid:"1",n:AD},{dssid:"0",n:AE}]);this.set("stRadioList",AC);return AC;};B.prototype._moveSelectedBack=function u(AD){var AC=this.get(AD);if(AC){AC.execRemoveAll();}};B.prototype._resolveCartListVisible=function z(){var AD=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();this.set("DataFilterVisible",true);this.set("showAdvanced",true);if(AD==1){var AC=this.get("isDSAsTarget");if(AC){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",true);this.set("attrReplaceLCVisible",false);this.set("DataFilterVisible",false);this.set("submissionLCVisible",false);}else{this.set("attrLCVisible",true);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}}else{if(AD==2){this.set("attrLCVisible",false);this.set("metricLCVisible",true);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AD==3){this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AD==4){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("DataFilterVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",true);}else{if(AD==8){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",true);this.set("DataFilterVisible",false);this.set("showAdvanced",false);this.set("submissionLCVisible",false);this.set("EditSelectorShowAll",false);this.set("EditSelectorMultiSelect",false);}}}}}};B.prototype._resolveCountEnabled=function h(){var AD=this.get("EditSelectorType").getSelectedItemValue(),AF=this.get("DataFilterMode"),AC=AF&&AF.getSelectedItemValue(),AE=this.get("selectorCurrentState"),AE=AE&&AE.getSelectedItemValue(),AG=(AE&&AE!="-1");this.set("countEnabled",AD=="1"&&AG);this.set("nonMixed",(AC!="-1"));};B.prototype._resolveStateEnabled=function l(){var AC=this.get("EditSelectorType").getSelectedItemValue();this.set("stateEnabled",AC=="1");};B.prototype._resolveAllEnabled=function H(){this._handleSelectorTypeChange();var AD=this.get("EditSelectorType"),AC=AD.getSelectedItemValue(),AE=AC!=="3";if(AE){AD=this.get("EditSelectorSelectionType");AC=AD.getSelectedItemValue();AE=AC!=="0";}if(!AE){this.set("EditSelectorShowAll",false);}this.set("OptionAllEnabled",AE);};B.prototype._handleSelectorTypeChange=function W(){if(this.translating){return ;}var AD=this.get("EditSelectorType"),AC=AD.getSelectedItemValue();switch(AC){case"3":this.set("EditSelectorShowAll",false);case"2":this.set("EditSelectorShowTotal",false);break;}this._clearAttrFormSelector();};B.prototype._resolveUCLogic=function M(){this._resolveDataFilterModeEnabled();this._resolveTotalAndAutoSynchEnabled();this._resolveUpdateFilterTargetEnabled();};B.prototype._resolveDataFilterModeEnabled=function AB(){var AE=this.get("EditSelectorType");var AJ=this.props["EditSelectorSource"+(this.get("isMetricQualifier")?"Metrics":this.get("isDDIC")?"DDIC":"")];if(!AJ){return ;}var AI=AJ&&AJ.getSelectedItem()&&AJ.getSelectedItem().olap,AD=AJ&&AJ.getSelectedItem()&&AJ.getSelectedItem().sty;AJ=AJ&&AJ.getSelectedItemValue();AJ=AJ&&AJ.split("|");AJ=AJ&&AJ.length>2&&(AJ[1]==microstrategy.DSSTYPE_ATTRIBUTE||(AJ[1]==microstrategy.DSSTYPE_CONSOLIDATION&&AD=="12033"));var AC=this.get("EditSelectorTargets").get("selected").props.items;var AG=false;for(var AF=0;AC&&AF<AC.length;AF++){var AH=AC[AF];if(AH.dssid.indexOf("_")>-1){AG=true;break;}}this.set("DataFilterModeEnabled",(AC&&AC.length>0)&&(AE.getSelectedItemValue()==1)&&!!AJ&&!AI&&!AG);};B.prototype._resolveDataFilterMode=function L(){var AH=this.get("EditSelectorSource"),AD=AH&&AH.getSelectedItem(),AG=AH&&AH.getSelectedItemValue(),AJ=AG&&AG.split("|"),AE=AD&&AD.sty===257,AF=AJ&&AJ.length>2&&AJ[1]==microstrategy.DSSTYPE_CONSOLIDATION&&AD.sty===12032;var AK=this.get("DataFilterMode"),AC=AK.getItems(),AI=AK.get("valueForm");AK.setItems(AC.map(function(AL){if(AL[AI]==="-1"){if(AE||AF){AL.cssClass="Disabled";}else{delete AL.cssClass;}}return AL;}));this.get("DataFilterMode").execSelectValue((AE||AF)?"-1":"1");};B.prototype._resolveTotalAndAutoSynchEnabled=function N(){var AF=this.get("DataFilterMode");var AC=AF&&AF.getSelectedItemValue();var AG=this.get("DataFilterModeEnabled");var AE=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();var AD=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);this.set("showTotalEnabled",(AC=="0"||!AG)&&AE==1&&!AD);this.set("selectorAutoSyncEnabled",AC=="0"||!AG);if(!((AC=="0"||!AG)&&AE==1)){this.set("EditSelectorShowTotal",false);}if(AC!="0"&&AG){this.set("EditSelectorAutoSync",false);}};B.prototype._resolveUpdateFilterTargetEnabled=function c(){var AE=this.get("DataFilterMode");var AC=AE&&AE.getSelectedItemValue();var AF=this.get("DataFilterModeEnabled");var AD=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();this.set("updateFilterTargetEnabled",(AC!="0"&&AF)&&AD==1);};B.prototype.execSelectObject=function s(AC){this.set("runReportDocName",AC[0].n);this.set("runReportDocId",AC[0].dssid);this.set("runObjectType",AC[0].tp);};B.prototype.refreshForSearchBox=function A(AC,AK){AC.set("showTotalEnabled",!AK);var AH=AC.get("EditSelectorSource"),AD=AH&&AH.getSelectedItemValue();if(AH){var AI=AC.getBone().commands.queryState(AK?"documentPureAttributes":"documentAttributes"),AG=AH.getItems()||[];if(AG.length!=AI.length){AH.setItems(AI);var AJ=AH.execSelectValue(AD);if(!AJ){AH.execSingleSelect(0);}}}if(AK){AC.get("EditSelectorType").set("selectedIndicesList",0);if(!AH){var AF=AC.getBone().commands.queryState("EditSelectorSource")||"",AE=AF.split("|")[1];if(AE&&AE!=microstrategy.DSSTYPE_ATTRIBUTE){AC._storeDeltaProp("EditSelectorSource","");}}}};B.prototype.on_set_ext_prop_UseAsInformationWindow=function U(AC){if(this.get("showTableDisplayMode")){var AD=microstrategy.descriptors;this.set("TableCancelType",AC.memo.value?AD.getDescriptor("11174"):AD.getDescriptor("11175"));this.set("TableCancelText",AC.memo.value?AD.getDescriptor("221"):AD.getDescriptor("2827"));}};B.prototype.translateBone=function D(){this.translating=true;var AD=this.props.EditSelectorType,AE=AD&&AD.getItems().concat(),AG=(AE&&mstr.$A.findByForm(AE,3,"dssid",false))||-1,AF=this.getBone().commands.queryState("isInFilterPanel"),AC=!!AD.iifp;isAQ=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorStyle")=="11";mstr.$A.forEach(AE,function(AI){var AH=AI.dssid;if(AH!=4){if(isAQ){AI.cssText=(AH==7)?"":"display: none;";}else{AI.cssText=(AH==7)?"display: none;":"";}}});if(AF!=AC){AE[AG].cssText=AF?"display: none;":"";AD.iifp=AF;}AD.setItems(AE);this.translating=false;mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);};function B(AC){mstr.bones.editors.BoneTranslator.apply(this,[AC]);}return B;})();mstr.bones.editors.GeneralTabBoneTranslator=(function(){mstr.$O.extendsClass(K,mstr.bones.editors.BoneTranslator);K.prototype.init=function H(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"set_Visible","_handleVisiblilityChange");};K.prototype._handleVisiblilityChange=function B(P){if(this.translating){return ;}if(!P.memo.value){this.set("VisibleHTML",false);}};K.prototype.on_set_IsPortal=function J(P){if(this.translating){return ;}this.get("parent").notifyPropertyChange("IsPortal",P);this.updatePanelCustomTitle();};K.prototype.on_set_TitleBarDisplay=function D(P){if(this.translating){return ;}this.updatePanelCustomTitle();};K.prototype.updateShowTranslucent=function L(R,Q){var P={};P.UseAsInformationWindow=R;P.InfoWindowMode=Q;this.get("parent").notifyPropertyChange("showTranslucent",P);};K.prototype.updateInitialSlidingInWidthAndHeightEnabled=function C(T){var S=T.usiw!==undefined?T.usiw:this.get("UseAsInformationWindow"),Q=T.dips!==undefined?T.dips:this.get("DisplayInPartialScreen"),R=T.iwm!==undefined?T.iwm:this.get("InfoWindowMode").getSelectedItemValue(),P=T.iwp!==undefined?T.iwp:this.get("InfoWindowPosition").getSelectedItemValue();this.set("InitialSlidingInHeightEnabled",S&&Q&&R==="4"&&(P==="1"||P==="2"));this.set("InitialSlidingInWidthEnabled",S&&Q&&R==="4"&&(P==="3"||P==="4"));};K.prototype.on_set_InfoWindowMode=function O(P){if(this.translating){return ;}this.updateShowTranslucent(this.get("UseAsInformationWindow"),P.memo.value);this.updateInfoWinPosition();this.updateInitialSlidingInWidthAndHeightEnabled({iwm:P.memo.value});};K.prototype.on_set_UseAsInformationWindow=function N(P){if(this.translating){return ;}this.updateShowTranslucent(P.memo.value,this.get("InfoWindowMode").getSelectedItemValue());if(this.get("showTableDisplayMode")){!P.memo.value&&this.set("IsPortal",P.memo.value);this.get("parent").notifyPropertyChange("UseAsInformationWindow",P);}if(P.memo.value){this.set("ShowAsCollapsiblePanel",false);}this.updateInfoWinPosition();this.updateInitialSlidingInWidthAndHeightEnabled({usiw:P.memo.value});};K.prototype.on_set_DisplayInPartialScreen=function A(P){this.updateInitialSlidingInWidthAndHeightEnabled({dips:P.memo.value});};K.prototype.on_set_InfoWindowPosition=function M(P){this.updateInitialSlidingInWidthAndHeightEnabled({iwp:P.memo.value});};K.prototype.updateInfoWinPosition=function F(){var P=this.get("InfoWindowMode").getSelectedItemValue(),Q=this.get("UseAsInformationWindow");this.set("InfoWindowPositionEnabled",Q&&(P==4));};K.prototype.updatePanelCustomTitle=function E(){var P=this.get("TitleBarDisplay").getSelectedItemValue();this.set("panelCustomTitle",P&&P=="1"&&this.get("IsPortal"));};K.prototype.onModelPropertyChange=function I(P){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[P]);if(P.src==this.get("titleTriState")){if(this.translating){return ;}var Q=(this.get("titleTriState").getSelectedItemValue()=="1");this.set("ShowWidgetTitleBar",Q);this.set("IsPortal",Q);}};K.prototype.translateBone=function G(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;var P=!this.get("IsPortal")?"0":(this.get("ShowWidgetTitleBar")?"1":"-1");this.get("titleTriState").execSelectValue(P);this.translating=false;};function K(P){mstr.bones.editors.BoneTranslator.apply(this,[P]);}return K;})();mstr.bones.editors.ActionsBoneTranslator=(function(){mstr.$O.extendsClass(E,mstr.bones.editors.BoneTranslator);E.prototype.getDynamicListModel=function B(I,H){var G=mstr.bones.editors.BoneTranslator.prototype.getDynamicListModel.apply(this,arguments);if(H=="ControlGroupByList"){G.detachEventListener(this,"hashadd_selectedIndices");G.detachEventListener(this,"hashremove_selectedIndices");G.attachEventListener(this,"listadd_items","onControlGroupByChange");}return G;};E.prototype.onControlGroupByChange=function F(H){var K=H.src;var J="";var G=null;var I=[];J=K.getItems();var L=K.get("mappedPropertyName");this.raiseEvent("set_"+L,{name:L,src:H.name,value:J,valueWas:G});if(this.translating){return ;}this._storeDeltaProp(L,J);};E.prototype.on_set_ext_prop_XTabView=function D(G){var H=G.memo.value;var I=this.translating;this.translating=true;this.set("showGridIf",H==1||H==3);this.translating=I;};E.prototype.on_set_expandPanels=function A(H){var G=H.memo.value;var I=this.translating;this.translating=true;this.set("allowPanelsToSplitAcrossPages",G==0);this.set("panelOverflowSpacingEnabled",this.get("ClipOnExport")&&G!=0);this.translating=I;};E.prototype.on_set_ClipOnExport=function F(H){var J=this.translating;if(J){return ;}this.translating=true;var I=H.memo.value;var G=this.get("expandPanels");this.set("panelOverflowSpacingEnabled",I&&G.getSelectedIndex()!=0);this.translating=J;};E.prototype.joinTypeChange=function C(G,I){var H=this._getDeltaProp("joinTypes");if(!H){H={};}H[G]=I;this._storeDeltaProp("joinTypes",H);};function E(G){mstr.bones.editors.BoneTranslator.apply(this,[G]);}return E;})();mstr.models.TriStateListModel=(function(){mstr.$O.extendsClass(A,mstr.models.ListModel);A.prototype.execSingleSelectNextAndLoop=function B(){mstr.models.ListModel.prototype.execSingleSelectNextAndLoop.apply(this);var D=this.props.selectedIndicesList;if(isNaN(D)){return false;}var C=parseInt(D);var E=this.get("ExcludedItemsOnLoop");E=E&&E.split(",");if(E&&C in E){this.execSingleSelectNextAndLoop();}return true;};function A(C){mstr.models.ListModel.apply(this,[C]);}return A;})();mstr.models.IPhoneTimeSeriesEditorModel=(function(){mstr.$O.extendsClass(N,mstr.models.BaseModel);N.prototype.init=function J(){mstr.models.BaseModel.prototype.init.apply(this);this.set("granularity","");if(this.props.isReport){this.selectItemFromId(this.props.dataSets,"r");}this.aeh();this.changeSelectedNode();this.ROOT_NODE="rl";this.ITEM_NODE="it";this.TEMPLATE_NODE="nk";this.NAME_NODE="lbl";this.LEVEL_NODE="lvl";this.RANGE_NODE="rng";this.RANGE_ATT_NODE="ut";this.RANGE_SIZE_NODE="v";};N.prototype.aeh=function L(){this.props.nodes.attachEventListener(this,"hashadd_selectedIndices","changeSelectedNode");this.props.rangeList.attachEventListener(this,"hashadd_selectedIndices","changeRangeList");this.props.dataSets.attachEventListener(this,"hashadd_selectedIndices","changeDataSet");};N.prototype.changeSelectedNode=function C(S){var X=this.props.nodes,U=X.getSelectedItem();if(U){if(U.dssid=="-1"){if(!this.props.justRemoved){this.execAdd();}return ;}this.set("empty",false);this.set("downEnabled",!S.memo.at[mstr.$A.len(X.props.items)-2]);this.set("upEnabled",!X.props.selectedIndices[0]);var W=this.changingN;this.changingN=true;var T=mstr.$obj("selectedNameIphoneEditorField");if(T){T.textBoxInitialized=false;}this.set("selectedName",U.n);this.set("selectedRangeSize",U.rs);var V=this.selectItemFromId(this.props.dataSets,U.ds);this.selectItemFromId(this.props.rangeList,U.sr);if(!V){this.set("attEnabled",false);}this.changingN=W;}else{this.set("empty",true);}this.updatePreview();};N.prototype.updatePreview=function K(){var W=microstrategy.descriptors.getDescriptor("7678"),U=this.props.nodes.getSelectedItem(),V=this.props.dataSets.getSelectedItem(),S=this.props.rangeList.getSelectedItem(),T=this.props.granularity;v=V&&T&&S&&U;W=W.replace("######",V?V.n:"").replace("#####",T?T:"").replace("####",S?S.n:"").replace("###",U?U.rs:"").replace("##",U?U.n:"");this.props.preview.set("value",v?W:"");};N.prototype.selectItemFromId=function E(U,V){var S=U.getItems();for(var T in S){if(S[T][U.props.valueForm]==V){U.setSelectedItems([S[T]]);return true;}}U.execClearSelect();return false;};N.prototype.on_set_selectedRangeSize=function F(){this.props.nodes.getSelectedItem().rs=this.props.selectedRangeSize;this.updatePreview();};N.prototype.on_set_selectedName=function G(){if(this.changingN){return ;}var S=this.changingN;this.changingN=true;this.props.justRemoved=true;this.props.nodes.execRenameSelectedItem(this.props.selectedName);this.props.justRemoved=false;this.changingN=S;this.updatePreview();};N.prototype.changeRangeList=function B(){this.props.nodes.getSelectedItem().sr=this.props.rangeList.getSelectedItem()[this.props.rangeList.props.valueForm];this.updatePreview();};N.prototype.changeDataSet=function O(){this.set("attEnabled",true);this.props.rangeList.execClearSelect();this.props.rangeList.removeItems(this.props.rangeList.getItems());var T=this.props.dataSets.getSelectedItem();var U=this.props.__atts[T.dssid];this.set("granularity",U[U.length-1].n);this.props.rangeList.insertItemsAt(U);var S=this.props.nodes.getSelectedItem();S.ds=this.props.dataSets.getSelectedItem()[this.props.dataSets.props.valueForm];S.sl=U[U.length-1].dssid;if(!this.changingN){S.sr=null;}this.updatePreview();};N.prototype.execAdd=function Q(){this.set("empty",false);this.set("downEnabled",false);this.set("attEnabled",false);this.set("upEnabled",false);var T={dssid:Math.random(),n:microstrategy.descriptors.getDescriptor(945),sl:null,sr:null,rs:"1",ds:null},U=this.props.nodes,S=U.props.items.length;U.insertItemsAt([T],S-1);U.execSingleSelect(S-1);this.props.rangeList.execClearSelect();this.set("granularity","");if(this.props.isReport){this.selectItemFromId(this.props.dataSets,"r");}else{this.props.dataSets.execClearSelect();}};N.prototype.execRemove=function R(){this.props.justRemoved=true;};N.prototype.execPostRemove=function H(){var T=this.props.nodes,S=mstr.$A.len(T.props.items);this.props.justRemoved=false;this.set("empty",S==1);this.set("attEnabled",S>1);if(S==1){T.execClearSelect();}else{if(parseInt(T.props.selectedIndicesList)==(S-1)){T.execSingleSelect(S-2);}}};N.prototype.execCheckDown=function A(){var T=this.props.nodes,S=mstr.$A.len(T.props.items);this.set("downEnabled",!T.props.selectedIndices[S-2]);this.set("upEnabled",!T.props.selectedIndices[0]);};N.prototype.getXMLValue=function P(){var S=this.props.nodes.getItems();var U="<"+this.ROOT_NODE+">";for(var T in S){if(T==S.length-1){continue;}U+=this.appendItemXML(S[T]);}U+="</"+this.ROOT_NODE+">";return U;};N.prototype.appendItemXML=function M(T){var S="<"+this.ITEM_NODE+"><"+this.TEMPLATE_NODE+">"+T.ds+"</"+this.TEMPLATE_NODE+"><"+this.NAME_NODE+">"+T.n+"</"+this.NAME_NODE+"><"+this.LEVEL_NODE+">"+T.sl+"</"+this.LEVEL_NODE+"><"+this.RANGE_NODE+"><"+this.RANGE_SIZE_NODE+">"+T.rs+"</"+this.RANGE_SIZE_NODE+"><"+this.RANGE_ATT_NODE+">"+T.sr+"</"+this.RANGE_ATT_NODE+"></"+this.RANGE_NODE+"></"+this.ITEM_NODE+">";return S;};N.prototype.validate=function I(){var T=this.props.nodes.getItems(),U,V="";for(var S in T){if(S==T.length-1){continue;}U=T[S];if(!U.n||!U.sl||!U.sr||!U.ds||!/^\d+$/.test(U.rs)){V+=" "+U.n+",";}}if(V){V=V.substring(0,V.length-1);return microstrategy.descriptors.getDescriptor(7565)+" "+V;}return true;};N.prototype.checkValidationStatus=function D(){var V=this.props.nodes.props.items,U=microstrategy.bone("visPropsEditor_VisualizationPropertiesEditorStyle").elem,S=microstrategy.findChildWithAtt(U,"input","id","ok");for(var T in V){if(V[T].invalidRS){S.disabled=true;return ;}}S.disabled=false;};function N(S){mstr.models.BaseModel.apply(this,[S]);}return N;})();mstr.models.IphoneTSFieldValidator=(function(){mstr.$O.extendsClass(C,mstr.models.FieldValidator);C.prototype.validate=function A(D){this.props.theValue=D;var E=mstr.models.FieldValidator.prototype.validate.apply(this,[D]);};C.prototype.setValidationStatus=function B(H){var G=mstr.models.FieldValidator.prototype.setValidationStatus.apply(this,[H]);var D=this.props.parent;D=D&&D.props.model;var F=D&&D.props.nodes,E=this.props.theValue;F=F&&F.getSelectedItem();if(F){F.rs=E;F.invalidRS=!G;D.set("selectedRangeSize",E);D.checkValidationStatus();}return G;};function C(D){mstr.models.FieldValidator.apply(this,[D]);}return C;})();mstr.behaviors.ToolbarContextMenuOpener=(function(){var B={};B.openMenu=function C(E){var G=E.props.element,D=getObjSumLeft(G),H=getObjSumTop(G)+getObjHeight(G),F=E.getModel();microstrategy.openBlockLoaderEditor("addWidgetToolbarMenu","InsertMenuBlockLoader",null,{cssText:"position:absolute;top:"+H+"px;left:"+D+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",useFixedPosition:"false",contextMenuName:F.get("contextMenuName"),viewer:"#"+F.props.id},E,null,document.body);};B.changeIcon=function A(D,E,G){var F=E.props.cmdid.split(";");F=F.length>1?F[1]:F.join();G.className=D.props.cssBaseIcon+F;};return B;})();mstr.models.ToolbarContextMenuOpenerModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.init=function B(){mstr.models.BaseModel.prototype.init.apply(this);this.commands.p=this;this.commands.h=this.props.toolbarHelper;};A.prototype.commands={queryEnabled:function(){return true;},queryVisible:function(){return true;},queryState:function(){return true;},exec:function(C){this.p.set("cmdid",C);this.h.execPressed();}};function A(C){mstr.models.BaseModel.apply(this,[C]);}return A;})();mstr.itemrenderers.IPhoneTimeSeriesItemRenderer=(function(){LV=mstr.$H.clone(mstr.itemrenderers.ListView);LV.renderListItem=function(A,C,F,D){var B=mstr.itemrenderers.FastListView.renderListItem(A,C,F,D);this._insertElementForIndex(A,F,D.at,B);if(D&&D.item&&D.item.dssid==-1){var E=B.style;E.fontStyle="italic";E.textDecoration="underline";E.cursor="pointer";B.className="";B.title="";}return B;};return LV;})();
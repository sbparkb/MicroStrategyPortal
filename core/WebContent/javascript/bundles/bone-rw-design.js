mstrContextMenuImpl.prototype=new Object();contextMenuScript=true;mstrContextMenuImpl.prototype.cmm_id=null;mstrContextMenuImpl.prototype.cmm_items=null;mstrContextMenuImpl.prototype.menu_items=null;mstrContextMenuImpl.prototype.length=0;mstrContextMenuImpl.IMG_EMPTY=0;mstrContextMenuImpl.IMG_CHECK=1;mstrContextMenuImpl.IMG_REMOVE=2;mstrContextMenuImpl.IMG_SUBTOTAL=3;mstrContextMenuImpl.IMG_DRILL_UP=4;mstrContextMenuImpl.IMG_DRILL_DOWN=5;mstrContextMenuImpl.IMG_DRILL_TEMPLATE=6;mstrContextMenuImpl.IMG_DRILL=7;mstrContextMenuImpl.IMG_LOADING=8;mstrContextMenuImpl.prototype.addItem=function(B,C,E,A,G){try{var F;if(!E){E=1;}if(!A){A=1;}if(!G){G=mstrContextMenuImpl.IMG_EMPTY;}if(typeof (C)=="string"){F=new Array(B,C,G,0,"","",A,E);}else{F=new Array(B,"",G,1,"["+C.menu_items.toString()+"]","",A,E);}return this.addItemDefinition(F);}catch(D){microstrategy.errors.log(D);return false;}};mstrContextMenuImpl.prototype.addSeparator=function(){try{var B=new Array("-","",0,2,"",1,1);return this.addItemDefinition(B);}catch(A){microstrategy.errors.log(A);return false;}};mstrContextMenuImpl.prototype.addItemDefinition=function(B){try{this.cmm_items.push(B);this.menu_items.push(this.cmm_items.length-1);this.length=this.menu_items.length;return B;}catch(A){microstrategy.errors.log(A);return false;}};mstrContextMenuImpl.prototype.registerTrigger=function(A,B){try{if(A){A.setAttribute("cx","["+this.menu_items.toString()+"]");A.setAttribute("cxid",this.cmm_id);if(B){A.setAttribute("cxty",B);}}return true;}catch(C){microstrategy.errors.log(C);return false;}};function mstrContextMenuImpl(A,C,B){this.cmm_id=A;this.cmm_items=C;this.menu_items=B;return this;}function util_alignColumnHeaderCell(A,C){A.style.width=C+"px";if(mstr.utils.ISIE4&&!mstr.utils.ISIE8&&!(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){if(C==0){A.style.display="none";}else{A.style.display="";}var B=function(){var D=A.offsetWidth;if(D!=C){A.style.width=Math.max(parseInt(A.style.width)+C-D,0)+"px";}};window.setTimeout(B,0);}}function util_convert2Px(D,B){if(mstr.utils.ISIE8&&!/px$/.test(B)){var A=document.createElement("img"),C;A.style.zIndex=-1;A.style.left=B;D.appendChild(A);C=A.style.pixelLeft;D.removeChild(A);return C+"px";}return B;}function util_getBorderWidth(A,E){var B="border-"+E+"-width",C=mstr.utils.CSS.getStyleValue(A,B),D=mstrNumber["UNIT_"+C.substring(C.length-2,C.length).toUpperCase()];if(D){C=(parseFloat(microstrategy.number.convertUnit(D,mstrNumber.UNIT_PX,C))||0);}return C;}function util_getCellPadding(A,B){return parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-"+B));}function util_getRowHeight(G){if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var C=G.cells,A=null;if(G.style.height){return parseFloat(G.style.height);}var E=0;for(var D=0;D<C.length;D++){A=C[D];var B=util_getBorderWidth(A,"top")+util_getBorderWidth(A,"bottom");var F=util_getCellPadding(A,"top")+util_getCellPadding(A,"bottom");if(A.getAttribute("rowspan")==null){E=Math.max(E,parseFloat((mstr.utils.CSS.getStyleValue(A,"height")))+B+F);}}if(A){if(!G.getAttribute("o")){return getObjOuterHeight(G);}return E;}}return mstr.utils.ISIE8?getObjInnerHeight(G):getObjOuterHeight(G);}function util_getCellWidth(A){if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var B=(parseFloat(mstr.utils.CSS.getStyleValue(A,"width")));B=B==0?B:(B+(parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-right"))||0)+(parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-left"))||0)+util_getBorderWidth(A,"left")+util_getBorderWidth(A,"right"));return B+((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&A.parentNode.getAttribute("o")?0.1:0);}return getObjOuterWidth(A);}function util_serRowHeight(F,A,E){F.style.height=A+"px";if(mstr.utils.ISSAFARI){var C=F.cells;for(var B=0;B<C.length;B++){C[B].style.height=A+"px";}}if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&E){var C=F.cells;if(C&&C[0]){window.setTimeout(function(){C[0].style.height=(A-util_getBorderWidth(C[0],"top")-util_getBorderWidth(C[0],"bottom"))+"px";},100);}}if(mstr.utils.ISIE4&&(!((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)))){var D=function(){var G=util_getRowHeight(F);if(G!=A){F.style.height=Math.max(2*A-G,0)+"px";}};window.setTimeout(D,0);}}function util_getRowHeight(G){if((mstr.utils.ISIE9||mstr.utils.ISIE10)){var C=G.cells,A=null;if(G.style.height){return parseFloat(G.style.height);}var E=0;for(var D=0;D<C.length;D++){A=C[D];var B=util_getBorderWidth(A,"top")+util_getBorderWidth(A,"bottom");var F=util_getCellPadding(A,"top")+util_getCellPadding(A,"bottom");if(A.getAttribute("rowspan")==null){E=Math.max(E,parseFloat((mstr.utils.CSS.getStyleValue(A,"height")))+B+F);}}if(A){if(!G.getAttribute("o")){return getObjOuterHeight(G);}return E;}}return mstr.utils.ISIE8?getObjInnerHeight(G):getObjOuterHeight(G);}function util_getBorderWidth(A,E){var B="border-"+E+"-width",C=mstr.utils.CSS.getStyleValue(A,B),D=mstrNumber["UNIT_"+C.substring(C.length-2,C.length).toUpperCase()];if(D){C=(parseFloat(microstrategy.number.convertUnit(D,mstrNumber.UNIT_PX,C))||0);}return C;}function util_getCellPadding(A,B){return parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-"+B));}function util_getHeaderColumnLeftPosition(A){var B=util_getHeaderColumnHelper(A,"getObjOffsetLeft");return B;}function util_getHeaderColumnWidths(B){if(!mstr.utils.ISWK&&!mstr.utils.ISIE8&&!(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var A=[];if(!B){return A;}var E=B.getElementsByTagName("COL");if(E&&E.length){var D=E.length;for(var C=0;C<D;C++){A.push(getObjOuterWidth(E[C]));}}return A;}return util_getHeaderColumnHelper(B,"util_getCellWidth");}function util_getHeaderColumnHelper(U,I){var A=[];if(!U){return A;}var P=U.rows,Q,B=P&&P[0],L=0;for(Q=0;Q<P.length;Q++){if(P[Q].cells.length!==0){B=P[Q];break;}}var J=function(o,c){var n=o.getAttribute(c);return n==null?1:parseInt(n);};var e=function(q,c){var n=null;var u=q.getElementsByTagName("colgroup");var o=u&&u[0];if(o&&o.childNodes[c]){n=parseFloat(o.childNodes[c].style.width);}return n;};var D=function(n){var c=0;if((mstr.utils.ISIE7||mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))&&!n.parentNode.getAttribute("o")&&!n.getAttribute("p")){n.setAttribute("p",1);c=((parseFloat(util_convert2Px(n,mstr.utils.CSS.getStyleValue(n,"paddingRight")))||0)+((mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))?1:0));n.style.paddingRight=((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)?c:Math.ceil(c))+"px";}};var S=function(x,z){var q=x.cells,y=0;for(var o=0,n=q.length;o<n;o++){var u=J(q[o],"colspan");if(u==1){A[z+o+y]=((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&I=="util_getCellWidth")?e(U,z+o+y)||window[I](q[o]):window[I](q[o]);}else{var c=0;for(V=z+o+y+1;V<z+o+y+u;V++){c+=A[V];}A[z+o+y]=window[I](q[o])-c;y+=u-1;}}};var a=function(AA,q){var z,o,y,x,u,AB=q.cells,AC=AA.cells;for(o=0,y=AB.length;o<y;o++){u=J(AB[o],"rowspan");if(u===1){break;}}for(z=0,y=AC.length;z<y;z++){x=AC[z];if(x.getAttribute("CTY")=="3"){return false;}else{AB[o++]=x;}}return true;};if(P.length>0){var X=B.cells;for(var V=0,h=X.length;V<h;V++){var K=J(X[V],"colspan");A.push(window[I](X[V]));while(K-->1){A.push(0);}}}var m=null,O=null,E=[],R={colStart:0,rowSpan:1},N=0,H=0;for(var W=Q+1,T=P.length;W<T;W++){var Z=P[W].getAttribute("level");if(!P[W].getAttribute("o")){var C=P[W].cells[0];if(C&&(C.getAttribute("oty")=="12"||C.getAttribute("MH"))){m=P[W];H=W;}else{H=W;}}else{if(!Z&&P[W].getAttribute("o")){if(!O){O={cells:[]};}if(a(P[W],O)){break;}}else{if(Z){if(Z<=N&&P[W].style.display!="none"){O=P[W-1];break;}else{N=Z;}}}}}if(m){for(var W=Q,Y=H;W<=Y;W++){X=P[W].cells;for(var V=0,M=X.length;V<M;V++){var G=J(X[V],"rowspan");if(G>H){L+=J(X[V],"colspan");}else{break;}}}S(m,L);}var F=function F(){var x,n,u,y,c,o,z=P.length,AB=O&&O.cells,q=A.length,AA=q,AC=false;if(!AB||AB.length==q){return ;}for(x=Q+1;x<z;x++){if(P[x].getAttribute("level")){return ;}if(P[x].getAttribute("o")){u=P[x].cells;o=u.length;for(n=0;n<o;n++){if(u[n].getAttribute("CTY")=="3"){AC=true;break;}}if(AC&&(J(u[n],"rowspan")>1)){break;}return ;}}for(x=0;x<q;x++){AB[x]=null;}for(x=0;x<z;x++){if(AA==0){break;}u=P[x].cells;c=q;for(n=u.length-1;n>=0;n--){y=J(u[n],"colspan");if(y>1){c-=y;continue;}c-=1;if(!AB[c]){AB[c]=u[n];AA--;}}}if(AA>0){for(x=0;x<q;x++){if(!AB[x]){AB[x]={offsetLeft:0,parentNode:{getAttribute:function(){return null;}},getAttribute:function(AD){if(AD=="colspan"||AD=="p"){return 1;}return null;}};}}}};F();if(O){for(W=0,T=Math.min(B.cells.length,O.cells.length);W<T;W++){var g=B.cells[W];if(g&&(g.getAttribute("AX")==="1"||g.getAttribute("AX")==="2"&&g.getAttribute("oty")==="12"||g.getAttribute("MH"))){if(J(B.cells[W],"colspan")>J(O.cells[W],"colspan")){S(O,0);break;}}else{break;}}}return A;}function util_getColumnWidthsArray(A,C,D,F){var E=util_getColumnLeftPositionsArray(A,C,D);var B=util_getWidthsArrayFromLeftsArray(A,C,D,E,F);return(B);}function util_getWidthsArrayFromLeftsArray(H,A,C,F,I){var G=(I)?1:0;var B=new Array;for(var E=0;E<A;E++){var J=E+1;for(J=E+1;J<=A;J++){if(F[J]!=null){break;}}if(J<=A){B[E]=Math.max(F[J]-F[E]-I,0);for(var D=E+1;D<J;D++){B[D]=0;}E+=J-(E+1);}}return(B);}function util_getColumnLeftPosition(K,A,B,I){var C=K.getElementsByTagName("COL");var D=(C)?C.length:0;var G=true;if(A<D){G=false;for(var H=A;H<D;H++){if(C[H].style.display!="none"){A=H;G=true;break;}}}if(G){var F=null;if(bIsIE4&&!bIsIE6){var L=util_getLetterForColumnNumber(A+1);var J=K.cells(L+"1:"+L+B);if(J){if(J.length){F=getObjSumLeft(J[0]);}else{F=getObjSumLeft(J);}}}else{if(bIsW3C||bIsIE6){if(mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10)){var E=util_getHeaderColumnLeftPosition(K);F=E[A]+getObjSumLeft(K);}else{if(mstr.utils.ISCHROME||mstr.utils.ISSAFARI||mstr.utils.ISW3CIE){E=util_getHeaderColumnHelper(K,"getObjSumLeft");F=E[A];}else{if(!I){I=K.getElementsByTagName("COL");}F=getObjSumLeft(I&&I[A]);}}}}return(F);}else{return(getObjSumLeft(K)+getObjWidth(K));}}function util_getColumnLeftPositionsArray(B,E,F){var G=new Array;if(!B){return(G);}for(var C=0;C<E;C++){G[C]=util_getColumnLeftPosition(B,C,F);}var A=null;if(bIsIE4){var D=util_getLetterForColumnNumber(E);A=B.cells.namedItem(D+"1:"+D+F);if(A){if(A.length){A=A[0];}}}if(A){G[E]=getObjSumLeft(A)+getObjWidth(A);}else{G[E]=getObjSumLeft(B)+getObjWidth(B);}return(G);}function util_setObjTableLayout(A,B){A.style.tableLayout="fixed";A.style.width="";if(A.width){A.width="";}return ;}function util_getRowHeightsOfTable(D,B){var A=new Array;for(var C=0;C<B;C++){A[C]=getObjHeight(D.rows[C]);}return(A);}function util_applyRowHeightsToTable(D,B){if(!D){return ;}var A=D.rows.length;for(var C=0;C<A;C++){if(B[C]!=getObjHeight(D.rows[C])){D.rows[C].style.height=B[C];}}return ;}function util_applyColWidthsToTable(H,C,A){if((!H)||(!C)){return ;}var B=C.length;var G=-1;var I=-1;var D=1;for(var F=0;F<B;F++){if(A[F]!=null){I=F;D=1;}else{I=G;var J=-1;for(var E=F+1;E<B;E++){if(A[F]!=null){J=E;break;}}D=J-G;if(D<1){D=1;}}if(I>-1){if(parseInt(A[I])>-1){C[F].style.width=(parseInt(A[I])/D)+"px";if(A[I]>0){C[F].style.display="";}else{if(!mstr.utils.ISW3C){C[F].style.display="none";}else{C[F].style.width="0px";}}G=I;}else{C[F].style.display="none";}}}H.style.width="";return ;}function util_parseRowSpan(B,C){var A=B.rowSpan;if((A)&&(!isNaN(parseInt(A)))&&(parseInt(A)>0)){return(parseInt(A));}return(C);}function util_initCOLTags(G,A){var C=0;var B=G.getElementsByTagName("COL");if(B){C=B.length;}if(C<A){var F=null;var E=G.getElementsByTagName("COLGROUP");if(E.length==0){F=document.createElement("COLGROUP");F=G.insertBefore(F,G.getElementsByTagName("TBODY")[0]);}else{F=E[0];}var I=A-C;for(var D=0;D<I;D++){var H=document.createElement("COL");F.appendChild(H);}}return ;}function util_getWidthofFixedColumns(A,D,E,C,B){if((!A)||(!D)||(!E)||(!C)){return(0);}if(D>=E){return(getObjWidth(A));}else{return(util_getColumnLeftPosition(A,D,C,B)-getObjSumLeft(A));}return(0);}function util_getHeightofFixedRows(A,B,C){if((!A)||(!B)||(!C)){return(0);}if(B>=C){return(getObjHeight(A));}else{return(getObjSumTop(A.rows[B])-getObjSumTop(A));}return(0);}function util_getLetterForColumnNumber(D){var G=97;var F=0;var E=0;var C=0;do{F++;E=26*F;C=26*(F-1)+1;if((D<=E)&&(D>=C)){break;}}while(E<=256);var B="";var A="";if(F>1){B=String.fromCharCode(G+F-2);}A=String.fromCharCode(G+(D-C));return(B+A);}function util_getFixedRows(C){if(!C){return(0);}var D=C.rows;if(!D){return(0);}var A=D.length;var E=0;var F="";if(D[A-1].getAttribute("o")){F="o";}else{if(D[A-1].getAttribute("level")){F="level";}}if(F==""){E=A;}else{for(var B=0;B<A;B++){if(D[B].getAttribute(F)){E=B;break;}}}return(E);}function util_getFixedCols(A){var C=0;var B=util_lastRepeatColHeaderInRow(A,0);C=util_sumColumnCountForCell(A,0,B);return(C);}function util_lastRepeatColHeaderInRow(B,E){var D=B.rows;if(!D){return(0);}var G=D[E].childNodes.length-1;var F=-1;for(var C=0;C<=G;C++){if(D[E].childNodes[C].getAttribute){var A=D[E].childNodes[C].getAttribute("AX");}if(!A||(A!="1")){break;}else{F=C;}}if(F<G){if(D[E].childNodes[F+1].getAttribute){if((D[E].childNodes[F+1].getAttribute("AX")=="2")&&(D[E].childNodes[F+1].getAttribute("OR")=="H")){F+=1;}}}return(F);}function util_sumColumnCountForCell(A,F,D){if(!(A.rows)){return(0);}var C=A.rows[F];if(!C){return(0);}var E=0;for(var B=0;B<D+1;B++){E+=util_parseSpan(C.childNodes[B],1);}return(E);}function util_parseSpan(B,C){var A=B.colSpan;if((A)&&(!isNaN(parseInt(A)))&&(parseInt(A)>0)){return(parseInt(A));}return(C);}function util_copyNode(C,A){A.innerHTML=C.innerHTML;if(C.attributes){var D=C.attributes.length;for(var B=0;B<D;B++){if((C.attributes[B])&&(C.attributes[B].specified)){A.setAttribute(C.attributes[B].nodeName,C.attributes[B].nodeValue,0);}}}if(C.className){A.className=C.className;}return ;}function util_resolveRepeatedColumnWidths(B,D){var H=B;var M=new Array;var K=0;if(!D){return(H);}var F=D.length;for(var I=0;I<F;I++){var L=false;var J=D[I].getAttribute("KEY");if(J){for(var G=0;G<K;G++){if(M[K]==J){L=true;break;}}}else{L=true;}if(!L){var C=new Array;var A=0;for(var G=I;G<F;G++){if(D[G].getAttribute("KEY")==J){C[A]=G;A++;}}var E=0;for(var G=0;G<C.length;G++){if(B[C[G]]>E){E=B[C[G]];}}for(var G=0;G<C.length;G++){H[C[G]]=E;}M[K]=J;K++;}}return(H);}function util_getColumnWidthsString(J,C,M,B){if(!J){return("");}var A=util_getColumnWidthsArray(J,M,B);A=util_resolveRepeatedColumnWidths(A);var E=new Array;var K=0;if(C){var D=C.length;for(var G=0;G<D;G++){var I=C[G].getAttribute("KEY");var L=false;for(var F=0;F<K;F=F+2){if(E[F]==I){L=true;break;}}if(!L){E[K]=I;K++;E[K]=parseInt(A[G]);K++;}}}var H="";var G=0;do{H+=E[G]+":"+E[G+1]+"_";G=G+2;}while(G<K);return(H);}function util_applySingleRowHeight(D,E,G,A){if((!D)||(!D.rows)||(!D.rows.length)){return ;}var F=D.rows.length;if(G>F-1){return ;}if(A>F-1){A=F-1;}var B=(E.length==0)?"":E+"px";for(var C=G;C<=A;C++){D.rows[C].style.height=B;}return ;}function util_getColIndex(K,M,C){try{var F=K.parentNode.rowIndex;var J=util_sumColumnCountForCell(M,F,K.cellIndex)-1;var N=M.rows;for(var A=F;A>=0;A--){for(var I=0,E=0;I<(J+C[F]);){var B=N[A].cells[E++];var H=util_parseRowSpan(B,1);var G=util_parseSpan(B,1);if(H>1){for(var L=A+1;L<(A+H);L++){C[L]+=G;}}I+=G;}}return(J+C[F]);}catch(D){microstrategy.errors.log(D);return null;}}function util_getAllCellsInColumnFromThisCell(B,R,A){try{var U=B.parentNode.rowIndex;var J=R.rows;var F=new Array();for(var Q=0;Q<J.length;Q++){F[Q]=0;}var O=util_getColIndex(B,R,F);var M=new Array();M[0]=B;var P=1;var H=util_parseRowSpan(B,1);if(A==null||typeof (A)=="undefined"){A=J.length;}for(var L=U+H;L<A;){var D=J[L].cells;for(var S=0,N=0;S<O-F[L]&&N<D.length;){var T=D[N++];var E=util_parseRowSpan(T,1);var I=util_parseSpan(T,1);if(E>1){for(var K=L+1;K<(L+E);K++){F[K]+=I;}}if(I>1){F[L]+=I-1;}S+=I;}var C=1;if((O-F[L])>=0){M[P++]=D[O-F[L]];C=util_parseRowSpan(D[O-F[L]],1);}L+=C;}return M;}catch(G){microstrategy.errors.log(G);return null;}}function util_getAllCellsInRowFromThisCell(G,H){if(G.nodeName.toLowerCase()!="td"){return null;}var F=G.parentNode.rowIndex;var B=new Array();B[0]=G;var C=1;var E=util_parseRowSpan(G,H);for(var D=G.cellIndex+1;D<G.parentNode.cells.length;D++){B[C]=G.parentNode.cells[D];C++;}for(var D=F+1;D<F+E;D++){var I=H.rows[D];for(var A=0;A<I.cells.length;A++){B[C]=H.rows[D].cells[A];C++;}}return B;}function util_findCell(D,H,B,C,G){var F=D.rows[H];if(F!=null){var A=F.cells[B];var E=A&&A.getAttribute(G);if(E&&E.toLowerCase()==C.toLowerCase()){return A;}}return null;}var dropDown=new function(){};dropDown.prototype=new Object();dropDown.togglePicker=function(show,id,dropdown,bone){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.togglePicker",0);}var oldPicker=null;if(bone.currentPicker){oldPicker=bone.currentPicker;if(bone.currentPicker.selected){var item=bone.currentPicker.selected;if(item){item.className="";}bone.currentPicker.selected=null;bone.currentPicker.commandId=null;bone.currentPicker.toolId=null;}bone.currentPicker.style.display="none";bone.currentPicker=null;}if(show){bone.currentPicker=document.getElementById(id);if(!bone.currentPicker){microstrategy.errors.log(microstrategy.descriptors.getDescriptor("3623"));return false;}bone.currentPicker.style.zIndex=1000;var cmdId=dropdown.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!cmdId){cmdId=dropdown.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_ID);}bone.currentPicker.commandId=cmdId;var subtypeStyle=bone.currentPicker.getAttribute(microstrategy.HTMLATTR_STYLE);if(subtypeStyle!=null){this.adjustPickerElements(bone.currentPicker);}if(bone.selectPickerElement){bone.selectPickerElement(bone.currentPicker);}for(var i=0;i<bone.currentPicker.childNodes.length;i++){var oChild=bone.currentPicker.childNodes[i];auxStr=oChild.getAttribute("de");if(auxStr&&auxStr.length>0){oChild.className=(eval(auxStr))?" ":"disabled";}}var leftElem=mstr.utils.BoxModel.getElementSumOffsetLeftAccurately(dropdown,document.body);var bottomElem=mstr.utils.BoxModel.getElementSumOffsetTopAccurately(dropdown,document.body)+getObjHeight(dropdown);if(bone.dialogDiv&&bone.dialogDiv.getAttribute(mstrHTMLAttributes.ATTR_DIALOG)=="true"){leftElem-=getObjSumLeft(bone.dialogDiv);bottomElem-=getObjSumTop(bone.dialogDiv);}bone.currentPicker.style.visibility="hidden";bone.currentPicker.style.display="block";var lClientWidth=getClientWidth();var lPickerWidth=getObjWidth(bone.currentPicker);if(lPickerWidth+leftElem>lClientWidth+((bone.dialogDiv&&!mstr.utils.ISIE6)?bone.dialogDiv.scrollLeft:0)){leftElem=Math.max(leftElem-lPickerWidth+getObjWidth(dropdown),0);}moveObjTo(bone.currentPicker,leftElem,bottomElem);if(bIsIE6&&!bIsIE7&&bone.maxHeight){bone.currentPicker.style.height="auto";bone.currentPicker.style.height=(bone.currentPicker.clientHeight<parseInt(bone.maxHeight))?bone.currentPicker.clientHeight+"px":bone.maxHeight;}bone.currentPicker.style.visibility="visible";togglePulldowns(bone.currentPicker,false);}else{if(oldPicker){togglePulldowns(oldPicker,true);}}}catch(err){microstrategy.errors.log(err);}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.togglePicker",0);}}return false;};dropDown.closePicker=function(F,D){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.closePicker",0);}if(!F){F=window.event;}var E=getEventTarget(F);var C=true;if(E){if(!E.getAttribute("id")&&E.parentNode.nodeType==1){E=E.parentNode;}var B=false;if(D.currentPicker){B=(findTarget(E,"ty")==D.currentPicker)&&(E!=D.currentPicker)&&(E.className.indexOf("disabled")<0);C=(E.className.indexOf("disabled")<0)&&(E!=D.currentPicker);}if(B){if(D.execPicker){C=D.execPicker(D.currentPicker,E);}else{alert("Option '"+E.getAttribute("id")+"' was selected from picker '"+D.currentPicker.id+"'. Please make sure the bone '"+D.id+"' implements execPicker.");}}}if(C&&D.currentPicker){dropDown.togglePicker(false,D.currentPicker.id,null,D);}return true;}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.closePicker",0);}}};dropDown.adjustPickerElements=function(I){try{var E=I.getAttribute(microstrategy.HTMLATTR_STYLE);switch(E){case"color":var H=microstrategy.userPalette;if(H){var B=microstrategy.findChildWithAtt(I,"span","name","pkrCustom");if(!B){return ;}if(B.getElementsByTagName("img").length==0){var J=document.createElement("img");J.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";B.appendChild(J);}displayObj(B);if(!ISIE7){var F=microstrategy.findChildWithAtt(I,"span","name","pkrMore");if(F){F.style.marginTop="25px";}}H=H.split(",");var A=microstrategy.findChildrenWithAtt(I,"span","custom","1");if(A.length==H.length&&A.length==8){if(A[0].id=="pkr"+H[0]){return ;}}else{if(A.length==H.length){return ;}}for(var D=0;D<A.length;D++){I.removeChild(A[D]);}for(var D=(H.length-1);D>=0;D--){var G=document.createElement("span");G.setAttribute("custom","1");G.id="pkr"+H[D];G.setAttribute("name","pkr"+H[D]);G.setAttribute("title",H[D]);G.style.backgroundColor=H[D];B.insertAdjacentElement("afterEnd",G);}}break;}}catch(C){microstrategy.errors.log(C);return false;}};mstrSerializer.prototype=new Object;mstrSerializer.prototype.buffer="";mstrSerializer.prototype.needDelim=false;mstrSerializer.CH_ESCAPE="*";mstrSerializer.CH_DELIM=".";mstrSerializer.CH_BRA="-";mstrSerializer.CH_KET="_";mstrSerializer.CH_LESS="<";mstrSerializer.STR_NULL="*0";mstrSerializer.prototype.getState=function(){try{return this.buffer;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addStr=function(B){try{if(this.needDelim){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(B);this.needDelim=true;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addInt=function(B){try{this.addStr(B+"");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addBoolean=function(B){try{this.addStr(B?"1":"0");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addValues=function(A){try{this.buffer+=mstrSerializer.CH_BRA;for(var B=0;B<A.length;B++){if(B>0){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(A[B]);}this.buffer+=mstrSerializer.CH_KET;this.needDelim=false;}catch(C){microstrategy.errors.log(C);return false;}};mstrSerializer.prototype.appendValue=function(C){try{var A=new RegExp("[\\"+mstrSerializer.CH_ESCAPE+"\\"+mstrSerializer.CH_BRA+"\\"+mstrSerializer.CH_KET+"\\"+mstrSerializer.CH_DELIM+"\\"+mstrSerializer.CH_LESS+"]","g");var D=mstrSerializer.CH_ESCAPE+"$&";C=String(C).replace(A,D);this.buffer+=C;}catch(B){microstrategy.errors.log(B);return false;}};function mstrSerializer(){return this;}mstrNumber.UNIT_CM="1";mstrNumber.UNIT_IN="2";mstrNumber.UNIT_MM="3";mstrNumber.UNIT_PT="4";mstrNumber.UNIT_PC="5";mstrNumber.UNIT_PX="6";mstrNumber.UNIT_EM="7";mstrNumber.prototype=new Object;mstrNumber.prototype.locale="1033";mstrNumber.prototype.units=mstrNumber.UNIT_IN;mstrNumber.prototype.unitsLabel="";mstrNumber.prototype.thousandSeparatorRegex=null;mstrNumber.prototype.toLocaleString=function(B){try{return(B+"").replace(".",mstr.Settings.Locale.DECIMALSEP);}catch(A){microstrategy.errors.log(A);return B;}};mstrNumber.prototype.toString=function(D,A){try{if(A==true){var C=this.getThousandSepRegex();if(C){D=String(D).replace(C,"");}}D=String(D).replace(mstr.Settings.Locale.DECIMALSEP,".");return D;}catch(B){microstrategy.errors.log(B);return D;}};mstrNumber.prototype.toUserUnits=function(C,B){try{return this.toLocalUnits(this.units,C,B);}catch(A){microstrategy.errors.log(A);}};mstrNumber.prototype.toLocalUnits=function(D,E,C){try{var A;switch(D){case mstrNumber.UNIT_CM:A=(parseFloat(this.toString(E))*2.54).toFixed(4)+"";break;case mstrNumber.UNIT_MM:A=(parseFloat(this.toString(E))*25.4).toFixed(4)+"";break;case mstrNumber.UNIT_PT:A=(parseFloat(this.toString(E))*72).toFixed(4)+"";break;case mstrNumber.UNIT_PC:A=(parseFloat(this.toString(E))*6).toFixed(4)+"";break;case mstrNumber.UNIT_PX:A=(parseFloat(this.toString(E))*microstrategy.DPI_CONVERSION)+"";break;case mstrNumber.UNIT_EM:A=(parseFloat(this.toString(E))*10.6666).toFixed(4)+"";break;default:A=parseFloat(this.toString(E)).toFixed(4)+"";}if(C){return A;}else{return this.toLocaleString(A);}}catch(B){microstrategy.errors.log(B);}};mstrNumber.prototype.toUSUnits=function(C,B){try{return this.convertToUSUnits(this.units,C,B);}catch(A){microstrategy.errors.log(A);}};mstrNumber.prototype.convertToUSUnits=function(D,E,C){try{var A=E;switch(D){case mstrNumber.UNIT_CM:A=parseFloat(this.toString(E))/2.54+"";break;case mstrNumber.UNIT_MM:A=parseFloat(this.toString(E))/25.4+"";break;case mstrNumber.UNIT_PT:A=parseFloat(this.toString(E))/72+"";break;case mstrNumber.UNIT_PC:A=parseFloat(this.toString(E))/6+"";break;case mstrNumber.UNIT_PX:A=parseFloat(this.toString(E))/microstrategy.DPI_CONVERSION+"";break;case mstrNumber.UNIT_EM:A=(parseFloat(this.toString(E))/10.6666)+"";break;}if(C){return A;}else{return this.toLocaleString(A);}}catch(B){microstrategy.errors.log(B);}};mstrNumber.prototype.convertUnit=function(B,C,A){return this.toLocalUnits(C,this.convertToUSUnits(B,A,true),true);};mstrNumber.prototype.getThousandSepRegex=function(){if(this.thousandSeparatorRegex==null){var A=mstr.Settings.Locale.THOUSANDSEP;A=A.replace(/(\W){1}/g,"\\$1");this.thousandSeparatorRegex=new RegExp(A,"g");}return this.thousandSeparatorRegex;};function mstrNumber(){return this;}microstrategy.number=new mstrNumber();mstr.behaviors.Generic=(function(){var J={};J.returnFalse=function(){return false;};J.returnTrue=function(){return true;};J.set_enabled=function B(K,G){K&&(K.disabled=!G);};J.set_tooltip=function I(K,G){K&&(K.title=(G!=null)?G:"");};J.clearBrowserHighlights=function D(G){mstr.utils.Dom.clearBrowserHighlights(G);return true;};J.set_css_display=function A(M,N,K,L){if(M&&M.style){var G=!!L?N:K;if(!mstr.utils.ISW3C){if(G=="table"){G="block";}}M.style.display=G;}};J.toggleCellElement=function F(S,Q,P,M,N,L,O){var G=(Q>-1)&&S&&S.rows&&S.rows[Q];var R=G&&G.cells&&G.cells[P];var K=R&&R.childNodes&&R.childNodes[M];this.set_css_display(K,N,L,O);};J.renderState=function E(G,L){if(!G){return ;}var M=null;if(L&mstr.Enum.Widget.STATE.SELECTED){M=mstr.Settings.Scheme.SELECTED_BORDERCOLOR;}else{if(L&mstr.Enum.Widget.STATE.HOVER){M=mstr.Settings.Scheme.HOVER_BORDERCOLOR;}else{M=mstr.Settings.Scheme.DEFAULT_BORDERCOLOR;}}if(M!=null){G.style.border="1px "+M+" solid";G.style.margin="0px";}else{G.style.border="0px";G.style.margin="1px";}var K=null;if(!G.disabled&&(L&mstr.Enum.Widget.STATE.SELECTED)&&(L&mstr.Enum.Widget.STATE.HOVER)){K=mstr.Settings.Scheme.SELECTED_HOVER_BGCOLOR;}else{if(L&mstr.Enum.Widget.STATE.SELECTED){K=mstr.Settings.Scheme.SELECTED_BGCOLOR;}else{if(!G.disabled&&(L&mstr.Enum.Widget.STATE.HOVER)){K=mstr.Settings.Scheme.HOVER_BGCOLOR;}else{K=mstr.Settings.Scheme.DEFAULT_BGCOLOR;}}}G.style.backgroundColor=(K!=null)?K:"transparent";};J.oncontextmenu=function C(O,K,G){var M=mstr.$obj(G);var L=new mstr.lang.Event(O,K);if(!M||!M.fireCommands){return true;}var N=M.getModel().getRMCModel();if(M.props.enabled&&N){M.execCommand("OpenPopup",{popup:mstr.$obj("RMCPopup1"),x:L.x+3,y:L.y+3});cancelEvent(O);return false;}return true;};J.on_model_set_validationStatus=function H(K,L,O){if(K.props.visible&&K.props.enabled){var G=L&&L.get("validationStatus"),N=G&&G.statusCode;if(N&&N!=mstr.Enum.Validation.STATUSCODE.VALID){var M=L&&L.get("message");if(M){alert(M);}}}};return J;})();mstr.behaviors.MojoWidget=(function(){var MW={};MW.on_set_visible=function MW_on_set_visible(view,model,rootTag){var bShow=view.props.visible;mstr.behaviors.Generic.set_css_display(rootTag,"block","none",bShow);if(bShow){this.renderMojoWidget(view,model,rootTag);}};MW.renderMojoWidget=function MW_renderMojoWidget(view,model,rootTag){var props=view.props,id=props.id,cfg=props.cfg,uiCfg=cfg.ui,dataCfg=cfg.data,dataProp=cfg.dataProp,mojoConfig={};if(!mstr.utils.String.isEmpty(cfg)){try{uiCfg=eval("("+uiCfg+")")||{};}catch(ex){}mojoConfig=uiCfg;var data=dataProp&&model.props[dataProp]||{};if(dataProp===undefined){try{dataCfg=eval("("+dataCfg+")")||{};}catch(ex){}data=dataCfg;}}mojoConfig.placeholder=rootTag.lastChild;mojoConfig.id=id.replace("id_","");var fnHandlePropChanges=function(newV){var m=model.getAncestorByProperty(dataProp,true);if(m){m.set(dataProp,newV);}};switch(props.name){case"ACLEditor":mstr.$H.overwrite(mojoConfig,{acls:data});mojoConfig.onhasChangedChange=function(){var newV=this.getACLItems();fnHandlePropChanges(newV);};mojoConfig.getAvailableRightsForSelection=function(){return model.props.userSubscribeRights.items;};microstrategy.showSharingEditor(null,null,null,mojoConfig);break;}};return MW;})();mstr.behaviors.FloatingEditor=(function(){var B={};B.on_set_visible=function A(C,E,F){var D=C.props.visible;if(C.get("isModal")){mstr.controllers.ModalEditors[D?"add":"remove"](C);}if(D){F.style.zIndex=microstrategy.getMaxZIndex();}mstr.behaviors.Generic.set_css_display(F,"block","none",D);};return B;})();mstr.behaviors.TextBox=(function(){var D={};D.on_set_visible=function B(P,S,V){mstr.behaviors.Generic.set_css_display(V,"block","none",P.props.visible);if(mstr.utils.ISIE4&&!V.mstrInitialized){V.mstrInitialized=true;var T=V.getElementsByTagName("input")[0];if(T){var O=T.onfocus,U=function(){P.textBoxInitialized=true;return true;};if(O){T.onfocus=function(){return O.apply(this,arguments)&&U.apply(null,arguments);};}else{T.onfocus=U;}var R=T.onblur,Q=function(){P.textBoxInitialized=false;return true;};if(R){T.onblur=function(){return Q.apply(null,arguments)&&R.apply(this,arguments);};}else{T.onblur=Q;}}self.setTimeout('mstr.behaviors.TextBox.initValue("'+P.getId()+'")',100);}};D.initValue=function K(O){var P=mstr.$obj(O);if(P){this.on_model_set_value(P,P.props.model,P.props.element);}};D.on_set_enabled=function H(P,R,S){mstr.behaviors.Generic.set_enabled(S,P.props.enabled);var O=S.childNodes[1].childNodes[0];var Q=P.props.enabled;mstr.behaviors.Generic.set_enabled(O,Q);O.style.backgroundColor=Q?"#ffffff":"#d4d0c8";};D.on_set_caption=function N(P,Q,S){var R=S.childNodes[0];var O=P.props.caption;R.childNodes[0].innerHTML=(O!=null)?O:"";mstr.behaviors.Generic.set_css_display(R,"block","none",(O!=null)&&(O!=""));};D.on_set_size=function M(O,P,R){var Q=parseInt(O.props.size);if(!isNaN(Q)){R.childNodes[1].childNodes[0].size=Q;}};D.on_set_maxlength=function I(P,Q,R){var O=parseInt(P.props.maxlength);if(!isNaN(O)){R.childNodes[1].childNodes[0].maxlength=O;}};D.on_model_set_dataType=function A(O,P,R){var Q=mstr.utils.Math.isDataTypeNumeric(P&&P.get("dataType"));R.childNodes[1].childNodes[0].style.textAlign=Q?"right":"left";};D.on_model_set_value=function F(O,Q,S){var P=Q&&Q.get(O.get("valueField"));if(P==null){P="";}P+="";O.props.rendering=true;var R=O.get("selectionRange");if(R){window.setTimeout(function(){O.set("selectionRange",null);},0);}if(mstr.utils.ISIE4){if(!O.textBoxInitialized||!this._containDBCharacter(P)){S.value=P;}}else{if(S.value!=P){S.value=P;}}if(R){mstr.utils.Controls.setSelectionRange(S,R.start,R.end);}O.props.rendering=false;O.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});};D._containDBCharacter=function J(O){for(var P=0;P<O.length;P++){var Q=O.charCodeAt(P);if(Q>256&&!this._isDBCurSymbol(Q)){return true;}}return false;};D._isDBCurSymbol=function J(O){return(O==8364)||(O==8361)||(O==65509)||(O==65510);};D.on_value_change=function L(X,T,U){var V=mstr.$obj(X);if(!V){return true;}if(V.props.rendering){return true;}var S=V.getModel();if(S){var Y=mstr.utils.Math.convertStringToDataType(T&&T.value,S.get("dataType"));var O=document.getElementsByClassName("mstrImagePreview")[0];if(O){var Q=microstrategy.getViewerBone().doc.prevSelectedId,W=document.getElementById(Q);if(U){var P=mstr.utils.Math.convertStringToDataType(window.URL.createObjectURL(U),S.get("dataType"));U.url=P;W.setAttribute("ut",mstr.Enum.IMAGE_URL_TYPE.IMAGE_NAME);O.blobURL=P;O.imgName=T.value;}else{O.blobURL=undefined;W.setAttribute("ut",mstr.Enum.IMAGE_URL_TYPE.HTTP_URL);}}var Z=(!V.get("validator")||V.get("validator").validate(Y));if(Z){V.set("selectionRange",mstr.utils.Controls.getSelectionRange(T));if(O){S._storeDeltaProp("imgFile",U);}S.set(V.props.valueField,Y);S.set("isComplex",false);}}var R=V.fireCommands&&V.fireCommands();return true;};D.on_file_selected=function G(O,S){if(S.type!=="file"||!S.files[0]){return false;}var V=document.getElementById("imgUrl_txt"),R=S.files[0];S.value="";if(S.value!=""){var U=S.cloneNode(true);S.parentNode.appendChild(U);if(S.removeNode){S.removeNode(true);}}var P=R.name,Q=["image/jpeg","image/bmp","image/gif","image/png"],T=true;me=this,ONE_MB=1<<20,IMG_MAX_SIZE=3,ORI_MAX_SIZE=10;if(R.size>ORI_MAX_SIZE*ONE_MB||(R.size>IMG_MAX_SIZE*ONE_MB&&R.type==="image/gif")){mstrmojo.alert(mstrmojo.desc(14665,"Cannot embed an image larger than ##MB. Enter a URL to the image instead.").replace("##",IMG_MAX_SIZE));return false;}mstr.$A.forEach(Q,function(X){if(T&&R.type===X){var Y=new Image(),W=new FileReader();W.onload=function(Z){Y.src=Z.target.result;Y.onload=function(){var a=R;if(R.size>IMG_MAX_SIZE*ONE_MB){var e=mstrmojo.imageUtils,c=Y.naturalWidth>=1920&&Y.naturalHeight>=1080?45:75,g=R.type==="image/png"?"png":"jpg";compressImg=e.compress(Y,c,g);a=e.dataURLToBlob(compressImg.src);if(a.size>IMG_MAX_SIZE*ONE_MB){mstrmojo.alert(mstrmojo.desc(14633,"Cannot embed an image larger than ##MB. Your image is still ###MB after compression. Enter a URL to the image instead.").replace("##",IMG_MAX_SIZE).replace("###",(a.size/ONE_MB).toFixed(1)));return false;}}V.value=P;me.on_value_change("imgUrl",V,a);};Y.onerror=function(){mstrmojo.alert(mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."));return false;};};W.onerror=function(){mstrmojo.alert(mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."));return false;};W.readAsDataURL(R);T=false;return false;}});if(T){mstrmojo.alert(mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."));return false;}};D.on_keyPress=function E(R,O){R=R||hWin.event;if(R.keyCode==13){var P=mstr.$obj(O);if(!P){return true;}var Q=P.getModel();if(!Q){return true;}if(!Q.get("submitQueueOnEnter")){return true;}if(Q.submitParentQueue){Q.submitParentQueue();}return false;}return true;};D.on_set_validationStatus=function C(O,P,Q){mstr.behaviors.Controls.on_set_validationStatus(O,P,Q);if(!mstr.behaviors.Controls.needsValidation(O)){return true;}if(mstr.behaviors.Controls.validate(O)){Q.style.backgroundImage="none";}else{Q.style.background="#ffffff url(../style/mstr/images/errorLine.gif) bottom left repeat-x";}return true;};return D;})();mstr.behaviors.TextBoxWithIcon=(function(){var B={};B.on_set_enabled=function H(K,N,O){var M=!!K.props.enabled;mstr.behaviors.Generic.set_enabled(O,M);var L=O.childNodes[1].rows[0].cells;var J=L[0].childNodes[0].firstChild;mstr.behaviors.Generic.set_enabled(J,M);J.style.backgroundColor=M?"#ffffff":"#d4d0c8";var I=L[1].childNodes[0];mstr.behaviors.ToolButtonRounded.markAsEnabled(I,M);};B.on_set_caption=function E(J,K,M){var L=M.childNodes[0];var I=J.props.caption;L.childNodes[0].innerHTML=(I!=null)?I:"";mstr.behaviors.Generic.set_css_display(L,"block","none",(I!=null)&&(I!=""));};B.on_set_size=function C(I,J,L){var K=parseInt(I.props.size);if(!isNaN(K)){L.childNodes[1].rows[0].cells[0].childNodes[0].size=K;}};B.on_set_maxlength=function D(J,K,L){var I=parseInt(J.props.maxlength);if(!isNaN(I)){L.childNodes[1].rows[0].cells[0].childNodes[0].maxlength=I;}};B.on_model_set_valueString=function A(I,K,L){var J=K&&K.get("valueString");if(J==null){J="";}L.childNodes[1].rows[0].cells[0].childNodes[0].value=J;};B.onkeypress=function G(L,J,I,K){L=L||J.event;if(L.keyCode==13){this.fire(I,K);stopEventBubbling(L);return false;}return true;};B.fire=function F(I,K){var J=mstr.$obj(I);if(J&&J.fireCommands&&!!J.props.enabled){J.fireCommands(null,K);}return true;};return B;})();mstr.behaviors.ToolButtonRounded=(function(){var E={};E.hover=function C(F){F&&!F.disabled&&(F.style.backgroundPosition="center right");};E.unhover=function B(F){F&&!F.disabled&&(F.style.backgroundPosition="center left");};E.on_set_enabled=function D(F,G,H){this.markAsEnabled(H,!!F.props.enabled);};E.markAsEnabled=function A(G,F){if(!F){this.unhover(G);}mstr.behaviors.Generic.set_enabled(G,F);G.childNodes[0].style.backgroundPosition=F?"left center":"right center";G.childNodes[0].style.cursor=F?"pointer":"default";};return E;})();mstr.behaviors.ToolButton=(function(){var B={};B.hover=function A(F){F&&!F.disabled&&mstr.behaviors.Generic.renderState(F,mstr.Enum.Widget.STATE.HOVER);};B.unhover=function D(F){F&&mstr.behaviors.Generic.renderState(F,0);};B.on_set_enabled=function E(F,G,H){this.markAsEnabled(H,!!F.props.enabled);};B.markAsEnabled=function C(G,F){if(!F){this.unhover(G);}mstr.behaviors.Generic.set_enabled(G,F);G.style.backgroundPosition=F?"left center":"right center";};return B;})();mstr.behaviors.TextLink=(function(){var A={};A.on_set_enabled=function B(D,F,G){var C=G&&G.childNodes[0];if(!C){return ;}var E=D.props.enabled;C.disabled=!E;if(E){C.className=C.className.replace("Disabled","");}else{C.className+="Disabled";}};return A;})();mstr.behaviors.TextFieldLabel=(function(){var A={};A.on_model_set_value=function B(C,F,E){var D=F&&F.get(C.get("valueField"));if(D==null){D="";}D+="";E.innerHTML=D;};return A;})();mstr.behaviors.TextDiv=(function(){var A={};A.on_set_caption=function B(E,F,H){var G=H.childNodes[0];var D=E.props.caption;G.innerHTML=(D!=null)?D:"";mstr.behaviors.Generic.set_css_display(G,"block","none",(D!=null)&&(D!=""));};A.on_model_set_value=function C(D,F,G){var E=(F&&F.get&&F.get("value"))||F;if(E==null||E==undefined||typeof (E)!="string"){E="";}G.childNodes[1].innerHTML=E;};return A;})();mstr.behaviors.ListTextDiv=(function(){var A={};A.on_model_set_items=function B(D,E,F){F.childNodes[1].innerHTML=this.buildObjectListString(E);};A.buildObjectListString=function C(E){var G=[];for(var F=0,D=mstr.$A.len(E);F<D;F++){G[F]=E[F]["n"];}return G.join(", ");};return A;})();mstr.behaviors.Pulldown=(function(){var E={};E.onmousedown=function G(K){var L=mstr.$obj(K);var M=L.getModel&&L.getModel();if(L.props.enabled&&!this._showAsLabel(L,M)){if(L.get("opened")){L.execCommand("ClosePopup");}else{L.execCommand("OpenPopup");if(L.get("popup")&&L.get("popup").focus){L.get("popup").focus();}}}return true;};E.on_set_enabled=function C(K,M,Q){var L=!!K.props.enabled;Q.disabled=!L;var P=Q.childNodes[0];P.style.color=L?"#000000":"#808080";var O=Q.childNodes[1].rows[0].cells[1];O.style.color=L?"#000000":"#808080";O.style.backgroundColor=(this._showAsLabel(K,M))?"transparent":(L?"#ffffff":"#d4d0c8");O.style.cursor=(L&&!this._showAsLabel(K,M))?"pointer":"default";if(O.childNodes[1].firstChild){O.childNodes[1].firstChild.ignoreMouseEvents=!(L&&!this._showAsLabel(K,M));}var N=K.get("disabledModelValue");if(!L&&N!=undefined){M.execSingleSelect(N);}};E.on_set_opened=function J(K,L,N){var M=N.childNodes[1].rows[0].cells[2].childNodes[0];if(K.props.opened){M.className+="Pushed";}else{M.className=M.className.replace(/Pushed/,"");}};E.on_set_width=function A(M,N,O){var L=M.props.width;if(L&&L!="auto"&&!L.match(/\%$/)){O.style.width=L;O.childNodes[1].style.width=L;O.childNodes[1].style.tableLayout="fixed";var K=M.props.popup;if(K){K.width=L;}}};E.on_set_enabled_colorPicker=function I(K,M,P){var L=!!K.props.enabled;P.disabled=!L;var O=P.childNodes[1].rows[0].cells[1].childNodes[1];var N=M.get("actualColor");if(N&&N.indexOf(",")>0){N="#"+N.split(",")[0];}O.style.backgroundColor=L?N:"#a3a19d";};E.clickColorButton=function D(P){var M=mstr.$obj(P);var L=M?M.get("model"):null;var N=L?L.get("parent"):null;var O=M.props.modelPath;var K=O.substring(O.lastIndexOf(mstr.controllers.Factory.PATHDELIM)+1,O.length);if(N&&N.exec){N.exec(K,L.get("actualColor"));}};E.showPulldownOrLabel=function B(K,M,P){var O=P.childNodes[1].rows[0].cells[2];O.style.display=(!this._showAsLabel(K,M))?((mstr.utils.ISW3C)?"table-cell":"block"):"none";var L=P.childNodes[1].rows[0].cells[1];var N=L.className;if(this._showAsLabel(K,M)){if(!/AsLabel$/.test(N)){N+="AsLabel";}}else{N=N.replace(/AsLabel$/,"");}L.className=N;};E._showAsLabel=function H(K,M){var L=M&&M.props&&M.props.items;return(K.props.showSingleItemListAsLabel&&(L&&mstr.$A.len(L)==1));};E.on_model_set_readyState=function F(T,Q,V){var O=Q&&Q.get("readyState");T.set("message",null);var U=V.childNodes[1].rows[0].cells[1];var N=U.childNodes[1];var M=U.childNodes[2];var L=false;if((O!=mstr.Enum.Widget.READYSTATE.IDLE)&&mstr.utils.Hash.isEmpty(Q&&Q.get("selectedIndices"))){L=true;}if(!L){M.style.display="none";N.style.display="block";this.showPulldownOrLabel(T,Q,V);}else{N.style.display="none";M.style.display="block";var S='<span class="'+(T.props.cssPrefix||"")+(T.props.cssClass||"")+'ReadyState">';var K="</span>";var P="";var R=T.props.descriptors;switch(O){case mstr.Enum.Widget.READYSTATE.SUCCESS:P=R&&R.loadingText;break;case mstr.Enum.Widget.READYSTATE.CANCELLED:P=R&&R.requestCancelledText;break;case mstr.Enum.Widget.READYSTATE.WAITING:P=R&&R.waitingText;break;case mstr.Enum.Widget.READYSTATE.TIMEOUT:P="Request timed out.";break;case mstr.Enum.Widget.READYSTATE.ERROR:default:P=R&&R.requestTimeOutText;break;}M.innerHTML=S+P+K;}};return E;})();mstr.behaviors.ListView=(function(){var K={};K.on_set_height=function I(L,N,R){var Q=L&&L.props,P=Q&&Q.scrollArea,M=P&&P.style,O=Q.height;if(M&&O){M.height=O;}};K.on_set_width=function G(M,O,R){var Q=M&&M.props,P=Q&&Q.scrollArea,N=P&&P.style,L=Q.width;if(!N){return ;}if(L==""||L=="auto"){R.style.width=N.width=L;}else{if(L&&L.match(/\%$/)){R.style.width=L;if(!mstr.utils.ISIE6){N.width="auto";}}else{N.width=(L!=null)?L:"";R.style.width="auto";}}};K.on_set_caption=function A(M,N,P){var L=M.props.caption!=null?M.props.caption:"";var O=P.rows[0].cells[0].firstChild.firstChild;mstr.behaviors.Generic.set_css_display(O,"block","none",L!="");O.innerHTML=L;};K.on_set_message=function F(L,M,R){var Q=L&&L.props,O=Q&&Q.message,N=Q&&Q.scrollArea,P=N&&N.childNodes;if(!P){return ;}if(O){P[0].style.display="none";P[1].style.display="none";P[2].style.display="block";P[2].firstChild.innerHTML=O;}else{P[0].style.display="block";P[1].style.display="none";P[2].style.display="none";}};K.on_model_set_leadIndex=function C(M,N,O){var L=mstr.utils.ListViewHelper.getItemRenderer(M);if(!L||!L.on_set_leadIndex){return false;}return L.on_set_leadIndex(M,N,O);};K.on_model_set_readyState=function J(X,S,Y){var Q=S&&S.get("readyState");X.set("message",null);var P=X.props.scrollArea,W=P.childNodes,O=W[1],R=W[0];if(Q==mstr.Enum.Widget.READYSTATE.IDLE){O.style.display="none";R.style.display="block";X._updateEmptyMessage();}else{var N=!X.props.showItemsDuringRequest;if(N){R.style.display="none";}O.style.display="block";var T=X.props.descriptors;switch(Q){case mstr.Enum.Widget.READYSTATE.SUCCESS:O.innerHTML=microstrategy.descriptors.getDescriptor("5674");break;case mstr.Enum.Widget.READYSTATE.CANCELLED:O.innerHTML="Request cancelled.";break;case mstr.Enum.Widget.READYSTATE.WAITING:O.innerHTML=microstrategy.descriptors.getDescriptor("5674");break;case mstr.Enum.Widget.READYSTATE.TIMEOUT:O.innerHTML="Request timed out.";break;case mstr.Enum.Widget.READYSTATE.ERROR:default:var M=T&&T.errorText,U=S&&S.props.requestContext,V=U&&U.response,L=V&&V.errorMessage&&V.errorMessage.replace(/[\r\n]/g,"");if(L){M=M+' <a href="javascript:void(0)" onclick="alert(\''+L.replace(/'/g,"\\'")+"');return false;\">"+T.errorDetailsText+"</a>";}O.innerHTML=M;break;}}};K.ondblclick=function D(P,N,M){var O=mstr.$obj(M);if(!O||!O.fireCommands||!O.props.enabled){return true;}var L=O.props.cmdsDblClick;if(!L){return true;}O.fireCommands(L,null);return true;};K.onmousedown=function B(Q,N,T){var R=mstr.$obj(T);if(!R||!R.fireCommands||!R.props.enabled){return true;}var U=new mstr.lang.Event(Q,N);var M=U.ctrl(),W=U.shift();if(M||W){mstr.utils.Dom.clearBrowserHighlights(N);}var P={valueForm:null,ctrl:M,shift:W,browseType:null,rmc:U.rightClick()};var L=U.target();if(L){L.mstrViewId=T;}var V=mstr.utils.Dom.findAncestor(L,"mstrListItemInfo",null,R.props[mstr.$W.ELEMENT],true);if(V){var O=V.mstrListItemInfo.split("/");var T=O.shift();var S=O.pop();P.valueForm=O.join("/");if(!M&&!W&&!U.rightClick()&&String(L.nodeName).toLowerCase()=="a"){P.browseCommand=S;}}window.setTimeout(function(){R.fireCommands(null,P);},0);return true;};K.on_set_visible=function E(M,N,R){if(M.props.showDescriptions){var L=M.props.scrollArea,P=L.childNodes,O=P[0];O.className+=" mstrListWithDescriptions";}mstr.behaviors.Generic.set_css_display(R,"table","none",M.props.visible);var Q=M.props.id;if(mstr.utils.ISIE4&&!M.keysInited){var Q=M.props.id;R.attachEvent("onkeypress",function(S){mstr.$obj(Q).onkeypress(S,window);});R.attachEvent("onkeydown",function(S){mstr.$obj(Q).onkeydown(S,window);});M.keysInited=true;}};K.on_set_validationStatus=function H(L,O,P){mstr.behaviors.Controls.on_set_validationStatus(L,O,P);if(!mstr.behaviors.Controls.needsValidation(L)){return true;}var N=L&&L.get("validator");var M=N.get("cache");if(mstr.behaviors.Controls.validate(L)){if(M){P.style.color=M.c;P.style.textDecoration=M.td;}}else{if(M){M.c=P.style.color;M.td=P.style.textDecoration;}P.style.color="#ff0000";P.style.textDecoration="underline";}return true;};return K;})();mstr.itemrenderers={};mstr.itemrenderers.FastListView=(function(){var A={};A.listItemHeightMin=function E(J){return 20;};A.listItemHeight=function D(J){return(J&&J.props.showDescriptions)?40:20;};A.listItemHeightMax=function H(J){return(J&&J.props.showDescriptions)?40:20;};A.renderListItem=function C(V,P,Z,K){var Y=K.item;var X=V.props[mstr.$W.DOCUMENT];var Q=(V.props.cssPrefix||"")+(V.props.itemCSSPrefix||"");if("enabled" in Y&&!Y.enabled){Q+="Disabled";}var M=Q;if(Y.cssClass){M=V.props.cssPrefix+Y.cssClass+" "+Q;}var L=X.createElement("div");L.className=M;if(Y.cssText){L.style.cssText=Y.cssText;}if(V&&V.props.showDescriptions){L.style.height=this.listItemHeight(V)+"px";}L.onmouseover=this.hover;L.onmouseout=this.unhover;if(Y.n!=null&&Y.n!=""&&Y.desc!=null&&Y.desc!=""){L.title=Y.n+". "+Y.desc;}else{if(Y.n!=null&&Y.n!=""&&Y.dsn!=null&&Y.dsn!=""){L.title=Y.n+" ("+Y.dsn+")";}else{if(Y.n!=null&&Y.n!=""){L.title=Y.n;}else{if(Y.desc!=null&&Y.desc!=""){L.title=Y.desc;}}}}var R=X.createElement("div");L.appendChild(R);R.className=Q+"Name";if(V.props.showDescriptions&&Y.desc){var J=X.createElement("div");L.appendChild(J);J.className=Q+"Desc";J.appendChild(X.createTextNode(Y.desc));}else{var J=null;}var T=null;if(V.props.shouldReplaceSpace){var S=Y.n.replace(/ /g,"\u00a0");T=X.createTextNode(S||"");}else{T=X.createTextNode(Y.n||"");}var W=K.browseCommand;if(W&&!Y.locked){var O=X.createElement("a");R.appendChild(O);O.appendChild(T);O.href="javascript:void(0)";var N=function(a){cancelEvent(a||window.event);return false;};O.onclick=N;O.tabIndex=-1;O.oncontextmenu=N;W=null;}else{R.appendChild(T);}if(V.props.showIcons){var U=Y.icon;if(Y.locked){U+="_locked";}if(U){mstr.utils.Dom.setBGIconClass(R,U);R.style.backgroundPosition="2px 50%";R.style.paddingLeft="23px";if(J){J.style.paddingLeft="23px";}}}return L;};A.hover=function(J){if(!this.ignoreMouseEvents&&!/Hover$/.test(this.className)){this.className+="Hover";}};A.unhover=function(J){if(!this.ignoreMouseEvents){this.className=this.className.replace(/Hover/,"");}};A.markListItemAsSelected=function B(J,K,O,L){if(J.get("ignoreSelection")){return ;}var M=L.elItem;if(!M){return ;}var N=M.className;if(/Hover/.test(N)){N=N.replace(/Hover/,"SelectedHover");}else{if(!/Selected/.test(N)){N+="Selected";}}M.className=N;};A.markListItemAsUnselected=function G(J,K,N,L){var M=L.elItem;if(!M){return ;}M.className=M.className.replace(/Selected/,"");};A.fireBrowse=function I(){var L=this.mstrListItemInfo||this.parentNode.mstrListItemInfo||this.parentNode.parentNode.mstrListItemInfo;L=L&&L.split("/");if(L&&(L[0]!=null)&&(L[1]!=null)&&(L[2]!=null)){var J=mstr.controllers.Factory.obj(L[0]);var K=J&&J.getModel();if(K){K.execCommand(L[2],L[1]);}}return true;};A.on_set_leadIndex=function F(K,L,O){var N=L&&L.get("leadIndex");if(N==null||N<0){return false;}var M=K&&K._getOrMakeElementForItemAt(N);if(!M){return false;}var J=K.get("scrollArea")||O.rows[0].cells[0].firstChild.childNodes[2];if(!J){return false;}mstr.utils.BoxModel.scrollToElement(J,M);};return A;})();mstr.itemrenderers.ListPulldownView=(function(){var A={};A.renderListItem=function(B,D,I,E){var C=mstr.itemrenderers.FastListView.renderListItem(B,D,I,E);var H=this._getContentContainer(I);mstr.utils.Dom.clearChild(H,0);H.appendChild(C);C.ignoreMouseEvents=!B.props.enabled||E.showAsLabel;H.title=C.title||"";if(mstr.utils.ISIE4){var F=H.style,G=F.width;if(G==null){G="";}F.width="1px";F.width=G;}};A.renderMultipleItems=function(H,E,I,B){var G=B.items;var F=mstr.$A.len(G);var J=new Array(F);for(var D=0;D<F;D++){J[D]=G[D]["n"];}J=J.join(", ");var C=this._getContentContainer(I);C.innerHTML=J;C.title=J;};A.renderEmpty=function(B,C,F,E){var D=(B.props.cssPrefix||"")+(B.props.cssClass||"");this._getContentContainer(F).innerHTML='<span class="'+D+'EmptyText">'+B.props.descriptors.emptyText+"</span>";};A._getContentContainer=function(B){return B.childNodes[1].rows[0].cells[1].childNodes[1];};return A;})();mstr.itemrenderers.CheckList=(function(){var H={};H.renderListItem=function G(M,J,Q,I){if(I.at==0){var L=(M.props.cssPrefix||"")+(M.props.cssClass||"");var O=L+(M.props.multiSelect?"Checks":"Radios");var K=['<table class="'+L+'Table" cellspacing="0" cellpadding="0">','<tbody class="'+O+'" >'];if(M.props.horizontal){K=K.concat(this._buildHorizontalTableHTML(M,J,Q));}else{K=K.concat(this._buildVerticalTableHTML(M,J,Q));}K.push("</tbody></table>");var P=this._getListContainer(Q);if(P){P.innerHTML=K.join("");}}var N=this._findCellForIndex(M,Q,parseInt(I.at),!M.props.horizontal);return N&&N.childNodes[0];};H._buildHorizontalTableHTML=function F(Q,M,S){var O=M&&M.getItems(),N=mstr.$A.len(O),J=Q&&parseInt(Q.props.arrangementSize),P=(!J||(J<1))?N:J,T=mstr.utils.Math.roundUpDiv(N,P);var L=[];if(T&&P){var I=0;for(var R=1;R<=T;R++){L.push("<tr>");for(var K=1;K<=P;K++){L.push(this._buildItemCell(Q,M,S,O[I++]));if(I>=N){break;}}L.push("</tr>");}}return L;};H._buildVerticalTableHTML=function C(Q,M,S){var O=M&&M.getItems(),N=mstr.$A.len(O),J=Q&&parseInt(Q.props.arrangementSize),T=(!J||(J<1))?N:J,P=mstr.utils.Math.roundUpDiv(N,T);var L=[];if(T&&P){var I;for(var R=1;R<=T;R++){L.push("<tr>");for(var K=1;K<=P;K++){I=(R-1)+(K-1)*T;if(I>=N){break;}L.push(this._buildItemCell(Q,M,S,O[I++]));}L.push("</tr>");}}return L;};H._buildItemCell=function A(Q,M,U,S){var J=(S.cssText&&S.cssText!="")?'" style="'+S.cssText:"";var N=(Q.props.cssPrefix||"")+(Q.props.itemCSSPrefix||"");if("enabled" in S&&!S.enabled){N+="Disabled";}var L=!!Q.props.multiSelect;var I=S.n;var O=S.desc;var T=['<td><div onmouseover="return mstr.itemrenderers.CheckList.hover(this)" onmouseout="return mstr.itemrenderers.CheckList.unhover(this)" class="'+N+'" title="'+((O!=null&&O!="")?I+". "+O:I)+J+'">'];var R=N+"Name";var K="";if(Q.props.showIcons){var P=S.icon;if(S.locked){P+="_locked";}if(P){R=mstr.utils.Dom.getBGIconClass(P)+" "+R;K=' style="padding-left: 23px" ';}}T.push('<div class="'+R+'" '+K+" >"+S.n+"</div>");if(Q.props.showDescriptions){if((O!=null)&&(O!="")){T.push('<div class="'+N+'Desc" '+K+" >"+O+"</div>");}}return T.join("");};H.hover=function E(I){I.className+="Hover";};H.unhover=function B(I){I.className=I.className.replace(/Hover/,"");};H._getListContainer=function D(I){return I.rows[0].cells[0].firstChild.childNodes[2].firstChild;};H.markListItemAsSelected=function(I,J,L,K){this._toggleCheckBox(I,J,L,K,true);};H.markListItemAsUnselected=function(I,J,L,K){this._toggleCheckBox(I,J,L,K,false);};H._toggleCheckBox=function(I,K,P,L,O){I.props.rendering=true;var M=this._findCellForIndex(I,P,parseInt(L.at),!I.props.horizontal);var J=M&&M.childNodes[0];if(J){if(O){var N=J.className;if(!(/Selected/.test(N))){var N=J.className;if(/Hover/.test(N)){N=N.replace(/Hover/,"SelectedHover");}else{N+="Selected";}J.className=N;}}else{J.className=J.className.replace(/Selected/,"");}}I.props.rendering=false;};H._findCheckboxForIndex=function(I,L,J,K){return this._findCellForIndex(I,L,J,K);};H._findCellForIndex=function(J,M,K,L){var I=this._computeRowColumnForIndex(J,K,L);if(I){return this._getListContainer(M).firstChild.rows[I.row].cells[I.col];}};H._computeRowColumnForIndex=function(I,K,N){var L=parseInt(I.props.arrangementSize);var M=(L&&L>0)?K%L:K;var J=(L&&L>0)?parseInt(K/L):0;if(N){return{row:M,col:J};}else{return{row:J,col:M};}};return H;})();mstr.behaviors.Popup=(function(){var B={};B.on_set_visible=function C(F,G,K,H){var E=F.props.id;var D=new Function("mstr.$obj('"+E+"').props['timeoutID'] = self.setTimeout(\"mstr.$obj('"+E+"').execCommand('Unpop');\", 500)");if((H&&H.init)||!F.props.animate){if(F.props.autoHide){K.onmouseover=new Function("self.clearTimeout(mstr.$obj('"+E+"').props['timeoutID']);");K.onmouseout=D;}return mstr.behaviors.Generic.set_css_display(K,"table","none",F.props.visible);}var I=!!F.props.visible;if(F.props.autoHide&&I){D();}if(I){mstr.behaviors.Generic.set_css_display(K,"table","none",F.props.visible);}var J=new Function("","mstr.behaviors.Popup.on_after_set_visible('"+F.props.id+"')");mstr.utils.Animations.alpha(K,I?0:100,I?100:0,I?5:15,J);};B.on_after_set_visible=function A(D){var E=mstr.$obj(D);if(!E){return ;}var F=!!E.props.visible;var G=E.props.element;if(!F){mstr.behaviors.Generic.set_css_display(G,"table","none",F);}};B.origon_set_visible=function C(D,E,F){mstr.behaviors.Generic.set_css_display(F,"table","none",D.props.visible);};return B;})();mstr.behaviors.Controls=(function(){var B={};B.on_model_set_value=function(C,G,H){if(H==null){return ;}var F=(G&&G.get&&G.get(C.props.valueField));C.props.rendering=true;if(H.tagName.toLowerCase()=="input"){switch(H.getAttribute("type").toLowerCase()){case"checkbox":H.checked=F||false;break;default:H.value=(F!=null&&F!=undefined)?F:"";C.fireCommands(null,G&&G.get&&G.get(C.props.valueField));break;}}else{H.innerHTML=F;}C.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});C.props.rendering=false;};B.on_set_validationStatus=function E(C,H,I){if(!mstr.behaviors.Controls.needsValidation(C)){return true;}var G=C&&C.get("validator");var F=G.get("cache");var J=C.get("validationStatus");if(mstr.behaviors.Controls.validate(C)){if(F){I.style.borderColor=F.b;I.setAttribute("title",F.t);}}else{if(!F){G.set("cache",{b:I.style.borderColor,t:I.getAttribute("title")});}I.style.borderColor="#ff0000";I.setAttribute("title",J.message);}return true;};B.needsValidation=function A(C){var F=C&&C.get("validator");if(!F){return false;}var G=C.get("validationStatus");if(!G){return false;}return true;};B.validate=function D(C){var F=C.get("validationStatus");return(F.statusCode==mstr.Enum.Validation.STATUSCODE.VALID);};return B;})();mstr.behaviors.ListToolButton=(function(){var B={};B.onmousedown=function A(C){var D=mstr.$obj(C);if(D.props.enabled){D.execCommand("OpenPopup");}return true;};return B;})();mstr.models.PromptAnswer=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.validate=function D(F,G){var E=this._validateInternally(F,G);this.set("message",this._getMsgForStatus(E.statusCode));this.set("validationStatus",E);return E.statusCode;};B.prototype.format=function A(E){return this.validate(E,true);};B.prototype.execValidate=function C(E){return(this.validate(E)==mstr.Enum.Validation.STATUSCODE.VALID);};function B(E){mstr.models.BaseModel.apply(this,[E]);}return B;})();mstr.models.ConstantPromptAnswer=(function(){mstr.$O.extendsClass(H,mstr.models.PromptAnswer);H.prototype.getValueString=H.prototype.getSelected=function D(){return this.props.isComplex?null:this.props.valueString;};H.prototype.isEmpty=function G(){var K=this.props,J=K.isComplex?K.complexString:K.valueString;return this._isEmptyAnswerString(J);};H.prototype._isEmptyAnswerString=function E(K){var P=false;var O=this.props;if(O&&O.dataType){var N=String(O.dataType).split(",");var L=mstr.Enum.Nodes.DATATYPE;var J=false;for(var M=0;M<N.length;M++){if(mstr.utils.Math.isDataTypeString(N[M])){J=true;break;}}if(J){if(!K){P=true;}}else{P=mstr.utils.String.isEmpty(K);}}else{P=mstr.utils.String.isEmpty(K);}return P;};H.prototype.format=function F(K){var J=this._validateInternally(K,true);if(J.valueStringFormatted){this.set("valueString",J.valueStringFormatted);}this.set("message",this._getMsgForStatus(J.statusCode));this.set("validationStatus",J);return J;};H.prototype._validateInternally=function C(L,P){var K=mstr.Enum.Validation.STATUSCODE,J={statusCode:K.VALID,context:L&&L.stage};var O=this.get("parent")&&this.get("parent").get("savingAnswer");var M=this.props;if(!M.isComplex){var N=this._validateString(M.valueString,P);J.statusCode=N.statusCode;J.valueStringFormatted=N.valueStringFormatted;}if(J.statusCode==K.VALID&&O){J.statusCode=this.validateSavedAnswer();}return J;};H.prototype._validateString=function A(R,M){var U=mstr.Enum.Validation.STATUSCODE,S={statusCode:U.VALID},K=this.props;if(this._isEmptyAnswerString(R)){if(K.required){S.statusCode=U.NO_INPUT;}}else{if(K.dataType){var V=String(K.dataType).split(",");var J=(mstr.utils.QualNode)?mstr.utils.QualNode.constValue2Array(R,!!K.multiSelect):[R],Z=M?J.concat():[];var T=K.min,W=K.max,Q=mstr.utils.Math,L=mstr.utils.LocaleParser;for(var X=0,Y=J.length;X<Y;X++){var a=J[X],O=L.whichDataType(a,V,M),N=M?O&&O.dataType:O,P;if(N==null){S.statusCode=U.INVALID_DATATYPE;break;}else{if(M){Z[X]=O.formatted;}if(Q.isDataTypeNumeric(N)){P=L.inNumericRange(a,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_VALUE:U.EXCEEDS_MIN_VALUE;break;}}else{if(Q.isDataTypeDateTime(N)){P=L.inDateTimeRange(a,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_VALUE:U.EXCEEDS_MIN_VALUE;break;}}else{if(Q.isDataTypeString(N)){P=L.inNumericRange(a.length,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_LENGTH:U.EXCEEDS_MIN_LENGTH;break;}}else{if(Q.isDataTypeBigDecimal(N)){P=L.inBigDecimalRange(a,T,W);if(P){S.statusCode=(P>0)?U.EXCEEDS_MAX_VALUE:U.EXCEEDS_MIN_VALUE;break;}}}}}}}if(M){S.valueStringFormatted=(mstr.utils.QualNode)?mstr.utils.QualNode.constArray2Value(Z):(Z&&Z.length>0)?Z[0]:null;}}}return S;};H.prototype.loadRequestResponse=function B(){var J=this.props.requestContext;var L=J&&J.response;if(!L||!L.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}this.set("valueString",L.data.get("valueString"));var K=L.data.get("validationStatus");if(K&&K.statusCode!=mstr.Enum.Validation.STATUSCODE.VALID){this.set("message",this._getMsgForStatus(K.statusCode).replace("##",L.data.get("max")));this.set("validationStatus",K);}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};H.prototype.init=function I(){mstr.models.PromptAnswer.prototype.init.apply(this);if(!("CommandEnabledValidate" in this.props)){this.set("CommandEnabledValidate",true);}};function H(J){mstr.models.PromptAnswer.apply(this,[J]);}return H;})();mstr.models.ListModel=(function(){mstr.$O.extendsClass(V,mstr.models.BaseModel);V.RESERVED_LISTS={items:true};V.RESERVED_HASHS={selectedIndices:true};V.prototype.DEFAULTS={readyState:mstr.Enum.Widget.READYSTATE.IDLE};V.prototype.sethash=function x(Av,At){var Au=this.hashclear(Av);if(At&&At.length){return this.hashadd(Av,At);}else{return Au;}};V.prototype.setlist=function J(Av,At){var Au=this.listclear(Av);if(At&&At.length){return this.listadd(Av,At);}else{return Au;}};V.prototype.execToggleSelect=function AJ(At){if(this.props.selectedIndices[At]){this.execRemoveSelect(At);}else{this.execAddSelect(At);}this.set("leadIndex",At);return true;};V.prototype.execAddSelect=function AS(At){if(!mstr.utils.ListModelHelper.canAdd(this,this.getItems()[At])){return false;}var Au={};Au[At]=true;this.hashadd("selectedIndices",Au);this.props.anchorIndex=At;return true;};V.prototype.execRemoveSelect=function AX(At){var Au={};Au[At]=true;this.hashremove("selectedIndices",Au);if(this.props.anchorIndex==At){this.props.anchorIndex=-1;}return true;};V.prototype.execRangeSelect=function AG(Au){var At=this.props.anchorIndex;if(At<0){if(mstr.utils.ListModelHelper.canAdd(this,this.getItems()[Au])){var Ax={};Ax[Au]=true;this.hashadd("selectedIndices",Ax);}}else{var Ax={};var Ay=Math.min(Au,At);var Aw=Math.max(Au,At);for(var Av=Ay;Av<=Aw;Av++){Ax[Av]=true;}if(this.execSelect(Ax)){this.props.anchorIndex=At;}}this.set("leadIndex",Au);return true;};V.prototype.execSingleSelect=function AK(At){if(!this.props.enableReselect){var Av=this.props.selectedIndices;if(Av&&Av[At]){if(!mstr.utils.Hash.lenGreaterThan(Av,1)){return false;}}}var Au={};Au[At]=true;if(this.execSelect(Au)){this.props.anchorIndex=At;this.set("leadIndex",At);}return true;};V.prototype.execRMCSelect=function AY(At){var Av=this.props.selectedIndices;if(Av&&Av[At]){return false;}var Au={};Au[At]=true;this.execSelect(Au);this.props.anchorIndex=At;return true;};V.prototype.execSelect=function Ai(At){At=mstr.utils.ListModelHelper.verifySelectionKeys(this,At);if(!At){return false;}this.execClearSelect();this.hashadd("selectedIndices",At);return true;};V.prototype.execDeleteSelected=function AA(){var At=this.props.selectedIndices;var Au=mstr.$H.len(At);if(!Au){return ;}var Av=mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(At,true));this.removeItemsAt(Av,true);};V.prototype.execRenameSelectedItem=function As(At){if(At){var Au=this.getSelectedIndex();if(Au==null){return ;}var Av=this.props.items&&this.props.items[Au];if(Av){this.removeItemsAt([Au],true);Av.n=At;this.insertItemsAt([Av],Au);this.execSingleSelect(Au);}}};V.prototype.execEnableIndices=function Ar(Au){var Aw=mstr.utils.Hash.clone(this.getSelectedIndices());var Ay=false;for(var At in Au){var Av=this.indexOfValue(At);if(Av==-1){continue;}var Ax=this.props.items&&this.props.items[Av];if(!Ax||Ax.enabled==Au[At]){continue;}if(Aw[Av]){Ay=true;}this.removeItemsAt([Av],true);Ax.enabled=Au[At];this.insertItemsAt([Ax],Av);}if(Ay){this.execSelect(Aw);}};V.prototype.verifySelectionKeys=function AI(Av){var At=this.getItems();for(var Au in Av){if(!mstr.utils.ListModelHelper.canAdd(this,At[Au])){delete Av[Au];}}return(mstr.utils.Hash.isEmpty(Av))?null:Av;};V.prototype.execSelectPrevious=function AF(Aw){var Ay=this.props.selectedIndices;var Az=this.getSelectedItems();var Ax=parseInt(this.props.leadIndex);var At=parseInt(this.props.anchorIndex);if(Aw){var Av=mstr.utils.Hash.maxNumber(Ay);if((At==Ax)&&Az.length>1){var Au={};Au[Ax]=true;if((Ax-1)>=0){Au[Ax-1]=true;}this.execSelect(Au);}else{if(Ax<=Av){if((Ax-1)>=0){this.execRangeSelect(Ax-1);}}else{this.execRemoveSelect(Ax);this.set("leadIndex",Ax-1);}}}else{if((Ax-1)>=0){this.execClearSelect();this.execSingleSelect(Ax-1);}}return true;};V.prototype.execSelectNext=function Ap(Aw){var Ay=this.props.selectedIndices;var Az=this.getSelectedItems();var Au=this.props.items;var Ax=parseInt(this.props.leadIndex);var At=parseInt(this.props.anchorIndex);if(Aw){if((At==Ax)&&Az.length>1){var Av={};Av[Ax]=true;if((Ax+1)<Au.length){Av[Ax+1]=true;}this.execSelect(Av);}else{if(Ax>=At){if((Ax+1)<Au.length){this.execRangeSelect(Ax+1);}}else{this.execRemoveSelect(Ax);this.set("leadIndex",Ax+1);}}}else{if((Ax+1)<Au.length){this.execClearSelect();this.execSingleSelect(Ax+1);}}return true;};V.prototype.execSingleSelectNextAndLoop=function Ah(){var Au=this.props.selectedIndicesList;if(isNaN(Au)){return false;}var At=parseInt(Au);var Av=this.props.items.length;var Aw;if(At+1<Av){Aw=At+1;}else{Aw=0;}this.execSingleSelect(Aw);return true;};V.prototype.execSelectString=function Al(Av,Ax,Aw){if(!Av){return false;}if(!Ax){Ax="n";}var Au=new RegExp("^"+Av,"i"),At=mstr.$A.matchByForm(this.getItems(),Au,Ax,this.props.leadIndex+((Aw===undefined)?1:Aw));return(At>-1)&&this.execSingleSelect(At);};V.prototype.execSelectValue=function c(At){var Au=this.indexOfValue(At);if(Au==-1){return false;}this.execSingleSelect(Au);return true;};V.prototype.execSelectValues=function Ad(At){if(!At){return false;}if(typeof (At)=="string"){At=[At];}var Aw={};for(var Av=0;Av<At.length;Av++){var Au=this.indexOfValue(At[Av]);if(Au!=-1){Aw[Au]=true;}}if(mstr.utils.Hash.isEmpty(Aw)){return false;}return this.execSelect(Aw);};V.prototype.getSelectedIndices=function Af(){return this.props.selectedIndices;};V.prototype.getSelectedIndex=function Ag(){var At=parseInt(mstr.$H.firstKey(this.props.selectedIndices));if(At!=null&&!isNaN(At)){return At;}return -1;};V.prototype.getSelectedItems=function AQ(Ax){var Au=this.props.items;if((!Au||!Au.length)&&this.props.keptSelections){return[].concat(this.props.keptSelections);}else{var At=this.props.selectedIndices;var Az=(Ax)?mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(At,true)):At;if(Az){var Ay=[];for(var Av in Az){var Aw=(Ax)?Au[Az[Av]]:Au[parseInt(Av)];if(Aw){Ay.push(Aw);}}return Ay;}}return null;};V.prototype.getSelectedItem=function q(){var Av=this.props.selectedIndices;if(Av){var At=this.props.items;for(var Au in Av){return At[parseInt(Au)];}}return null;};V.prototype.getSelectedItemValue=function AN(){var Au=this.getSelectedItem();var At=Au&&Au[this.get("valueForm")];return At||null;};V.prototype.setSelectedItems=function AU(At){var Au=this.indexOfMultiple(At,false);if(Au&&Au.foundCount){this.execSelect(mstr.$A.toHash(Au.indices));}else{this.execClearSelect();}};V.prototype.execClearSelect=function B(){var At=mstr.$H.clone(this.props.selectedIndices);this.hashremove("selectedIndices",At);this.props.anchorIndex=-1;this.props.leadIndex=-1;};V.prototype.execSelectAll=function g(){var Av=[];var At=this.getItems();for(var Au=0;Au<At.length;Au++){Av.push(true);}this.execSelect(Av);};V.prototype.queryEnabledSelectAll=function N(){return(this.getSelectedIndices().length!=this.getItems().length);};V.prototype.getItems=function S(){return this.props.items;};V.prototype.setItems=function AZ(Au){this.execClearSelect();var Av=mstr.$A.len(this.props.items);if(Av){var At={min:0,max:Av-1};this.removeItemsAtRanges([At],true);}this.insertItemsAt(Au,0);if(this.props.autoSelectFirstItem&&!this.props.defaultSelection&&this.getSelectedIndex()==-1){this.execSelect({0:true});}};V.prototype.insertItemsAt=function H(Aw,Ax){if(Ax==null||Ax<0){Ax=mstr.$A.len(this.props.items);}var Ay=mstr.$A.len(Aw);if(!Ay){return -1;}var Av=this.props.selectedIndices;if(Av){var At={};for(var Au in Av){if(parseInt(Au)>=Ax){Au=parseInt(Au)+Ay;}At[Au]=true;}this.props.selectedIndices=At;}this.listadd("items",Aw,Ax);this._updateCommandEnabledUpDown();return Ax;};V.prototype.removeItems=function Ao(At){var Au=this.indexOfMultiple(At,false);if(Au&&Au.foundCount){this.removeItemsAt(Au&&Au.indices);}};V.prototype.removeItemsAt=function u(Av,Au){if(!mstr.$A.len(Av)){return ;}var At=mstr.utils.Math.convertIndicesToRanges(Av,Au);this.removeItemsAtRanges(At,true);};V.prototype.removeItemsAtRanges=function AV(Au,A1){if(!mstr.utils.Hash.isEmpty(this.props.selectedIndices)){var A4=A1?Au:Au.concat().sort(mstr.$A.rangeSorter);mstr.$H.remove(this.props.selectedIndices,mstr.utils.Hash.fromRanges(A4));}var Av=this.listremove("items",Au,A1);if(!mstr.utils.Hash.isEmpty(this.props.selectedIndices)){var A2=mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(this.props.selectedIndices,true));var A6=mstr.$A.len(A2);for(var Ay=0,Az=mstr.$A.len(Av);Ay<Az;Ay++){var Ax=Av[Ay].min;var A3=Av[Ay].max;for(var A5=A3;A5>=Ax;A5--){for(var Aw=A6-1;Aw>-1;Aw--){if(A2[Aw]<A5){break;}A2[Aw]--;}}}this.props.selectedIndices=mstr.$A.toHash(A2);}else{var At=Math.max(Av[0].min,0);var A0=mstr.$A.len(this.props.items);if(A0){this.execSingleSelect(Math.min(A0-1,At));}else{this._updateCommandEnabledUpDown();}}};V.prototype.execUp=function Aj(){var Ay=this.props.selectedIndices,Au=mstr.utils.Math.convertIndicesToRanges(mstr.$A.fromHashKeys(Ay,true),false);var Av,Ax;for(var Aw=0,At=mstr.$A.len(Au);Aw<At;Aw++){Av=Au[Aw];if(Av&&Av.min&&(Av.max>=Av.min)){Ax=this.props.items[Av.min-1];this.removeItemsAtRanges([{min:Av.min-1,max:Av.min-1}],true);this.insertItemsAt([Ax],Av.max);Ay[Av.min-1]=true;Ay[Av.max]=false;}}this._updateCommandEnabledUpDown();return true;};V.prototype.execDown=function y(){var Ay=this.props.selectedIndices,Au=mstr.utils.Math.convertIndicesToRanges(mstr.$A.fromHashKeys(Ay,true),false);var Av,Az=mstr.$A.len(this.props.items)-1,Ax;for(var Aw=0,At=mstr.$A.len(Au);Aw<At;Aw++){Av=Au[Aw];if(Av&&(Av.max>-1)&&(Av.max<Az)){Ax=this.props.items[Av.max+1];this.removeItemsAtRanges([{min:Av.max+1,max:Av.max+1}],true);this.insertItemsAt([Ax],Av.min);Ay[Av.min]=false;Ay[Av.max+1]=true;}}this._updateCommandEnabledUpDown();return true;};V.prototype.on_hashadd_selectedIndices=V.prototype.on_hashremove_selectedIndices=function Ae(At){if(At&&At.src==this){this._updateCommandEnabledUpDown();}var Av=mstr.utils.Arrays.fromHashKeys(At.memo.at);this.props.selectedIndicesList=Av.join(",");var Au=this.props.selectedIndices;this.set("selectedCount",mstr.utils.Hash.len(Au));};V.prototype.on_set_selectedIndicesList=function An(At){this.execSelect(mstr.utils.Arrays.toHash(String(At.memo.value).split(",")));};V.prototype._updateCommandEnabledUpDown=function a(){var Ax=this.props.selectedIndices,Ay=mstr.$A.len(this.props.items)-1,Av;var At=false,Au=false;for(var Aw in Ax){Av=parseInt(Aw);if(!At){At=Av&&!Ax[Av-1];}if(!Au){Au=(Av<Ay)&&!Ax[Av+1];}if(At&&Au){break;}}this.set("CommandEnabledUp",At);this.set("CommandEnabledDown",Au);};V.prototype.indexOfItem=function Ac(Au){var At=this.props.valueForm;if(At!=null&&!Au.get){return mstr.$A.findByForm(this.props.items,Au&&Au[At],At);}else{return mstr.$A.find(this.props.items,Au);}};V.prototype.indexOfValue=function AH(Aw){var At=false,Au,Ay,Ax;if(Aw instanceof Object){Au=Aw.form||this.props.valueForm;Ay=Aw.value;At=Aw.ignoreCase?true:false;}else{Au=this.props.valueForm;Ay=Aw;}if(Au!=null){var Av=this.props.items;if(Av&&Av[0]&&Av[0].get){return mstr.$A.findByGetter(this.props.items,"get",Ay,Au);}else{return mstr.$A.findByForm(this.props.items,Ay,Au,At);}}return -1;};V.prototype.indexOfMultiple=function AO(Au,Av){var At=this.props.valueForm;if(At!=null){return mstr.$A.findByFormMultiple(this.props.items,Au,At,Av);}else{return mstr.$A.findMultiple(this.props.items,Au,Av);}};V.prototype.getContainerTree=function E(){var At=this.props.containerTree;if(!At){At=this.setContainerTree(this.props.container);}return At;};V.prototype.setContainerTree=function F(At){var Au=new mstr.models.TreeModel({parent:this,valueForm:this.props.valueForm,scriptClass:"mstr.models.TreeModel"});mstr.controllers.Factory.add(Au);if(At){var Av={value:At};Au.setRootNode(Av);Au.execCommand("SingleSelect",Av);}this.props.containerTree=Au;return Au;};V.prototype.getContainer=function Aq(){var At=this.getContainerTree();if(At){return At.getSelectedNode&&At.getSelectedNode();}return null;};V.prototype.execBrowseListItem=function O(At){if(At&&At.browseCommand&&At.valueForm!=null){return this.execCommand(At.browseCommand,At.valueForm);}return false;};V.prototype.execBrowseFolder=function AB(Av){var At,Au;if(Av&&Av.dssid!=null){At=Av.dssid;Au=Av;}else{if(typeof (Av)=="string"){At=Av;}}if(At){return this.browseFolderBlock(At,1,null,Au);}return false;};V.prototype.browseFolderBlock=function AT(Av,Ay,Az,Au,Aw){if(!Ay||Ay<0){return false;}if(!Av&&!this.props.searchXML){return false;}var At;if(!Aw){Aw={};}if(Az!=null&&Az!=""){At=new mstr.http.MetadataSearchRequestInputs(Av||"",Ay,(this.props.blockCount&&!this.props.blockCountAuto)?this.props.blockCount:mstr.utils.ListViewHelper.getFetchBlockForTask("searchMetadata"),this.props.totalSize||0,this.props.objectType,this.props.searchXML||"",Az,this.props.dataSourcesXML);if(!Aw.commandId){Aw.commandId="Search";}Aw.searchPattern=Az;Aw.item=Au;var Ax=this.props.searchFlags;if(Ax&&(Ax&256)==0&&(Ax&1024)==0){At.params.recursive=0;}}else{At=new mstr.http.BrowseFolderRequestInputs(Av||"",Ay,(this.props.blockCount&&!this.props.blockCountAuto)?this.props.blockCount:mstr.utils.ListViewHelper.getFetchBlockForTask("searchMetadata"),this.props.totalSize||0,this.props.hierarchical,this.props.objectType,this.props.searchXML||"",this.props.dataSourcesXML);if(!Aw.commandId){Aw.commandId="BrowseFolder";}if(this.props.styleName){At.params.styleName=this.props.styleName;}Aw.item=Au;}this.submitRequest(At,Aw);return true;};V.prototype.canBrowseFolder=function Z(At){if(At){switch(parseInt(At.tp)){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:return true;}}return false;};V.prototype.canBrowseHierarchy=function e(At){return false;};V.prototype._loadResults=function X(At){this.set("readyState",mstr.Enum.Widget.READYSTATE.SUCCESS);this.set("searchPattern",(At&&At.searchPattern)||"");this.set("totalSize",(At&&At.totalSize)||0);this.set("blockBegin",(At&&At.blockBegin)||1);this.set("blockCount",(At&&At.blockCount)||this.props.blockCount||1);this.set("leafElements",!!(At&&At.leafElements));this._appendBrowsedItemsToContainerTree((At&&At.browsedItems)||[],(At&&At.browsedItemsSiblings)||[]);this.set("rmc",(At&&At.rmc)||null);if(this.props.headerModel){this.updateHeaderModel();}var Au=(At&&At.listItems)||[];if(this.props.prefixItems){Au=Au.concat(this.props.prefixItems);}this.setItems(Au);this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};V.prototype.execBrowseContainerTreeNode=function AM(Aw){var Av=Aw&&Aw.value;if(!Av){return false;}switch(parseInt(Av.tp)){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:return this.browseFolderBlock(Av[this.props.valueForm],1,null,Av,{commandId:"BrowseContainerTreeNode",node:Aw});default:if(mstr.utils.ListViewHelper.isWithinHierarchy(Aw)){if(this.isElementSearchRequired(Aw)){var At=this.getContainerTree();if(At){At.removeAllChildNodes(Aw);At.execSelect([Aw]);}this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:[],totalSize:0,blockBegin:1});return true;}else{var Ax=this.canAutoExpandOnDrill(),A0=Aw;var Au=A0&&A0.value;if(Ax&&Au&&Au.filters&&Au.filters.length==1){if(!A0.children||A0.children.length==0){this._loadResults({browsedItems:[Au.filters[0]],browsedItemsSiblings:[[Au.filters[0]]],listItems:[],totalSize:0,blockBegin:1});}A0=A0.children[0];}return this.browseHierarchyBlock(this._buildHierarchyPathForNode(A0),1,"",{commandId:"BrowseContainerTreeNode",node:A0});}}else{if(this._isDummyNode(Aw)){var Ay=[];if(Aw.children){for(var Az in Aw.children){if(Aw.children[Az].value){Ay.push(Aw.children[Az].value);}}}var At=this.getContainerTree();if(At){At.removeAllChildNodes(Aw);At.execSelect([Aw]);}this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:Ay,totalSize:0,blockBegin:1});return true;}}}return false;};V.prototype.execBrowseContainerParent=function AE(){var Av=this.getContainer();if(Av&&Av.parent){var Au=this.canAutoExpandOnDrill&&this.canAutoExpandOnDrill(),Aw=Av.parent;if(Au&&mstr.utils.ListViewHelper.isWithinHierarchy(Aw)){var At=Aw&&Aw.value;if(At&&At.filters&&At.filters.length==1){Aw=Aw.parent||Aw;}}return this.execBrowseContainerTreeNode(Aw);}return false;};V.HIERARCHY_PATHDELIM="~";V.ELE_FILTER_ATT_DELIM=",";V.prototype._getNodeFromBrowsePath=function Ak(At,Au){while(At){browsePathItem=At.value;if(!browsePathItem){break;}tp=parseInt(browsePathItem.tp);if(tp==mstr.Enum.MSTRFolderItem.TYPE.PROJECT||tp==mstr.Enum.MSTRFolderItem.TYPE.FOLDER||tp==mstr.Enum.MSTRFolderItem.TYPE.DIMENSION){break;}if(browsePathItem[this.props.valueForm]==Au){return At;}At=At.parent;}return null;};V.prototype.execFetchBlock=function P(At){if(!At){return ;}return this.fetchBlock(At,this.props.searchPattern);};V.prototype.execFetchData=function L(){if(this.shouldFetchData()){var At=this.props.readyState;if(At==null||At==mstr.Enum.Widget.READYSTATE.IDLE){return this.execCommand("FetchFirst");}}return false;};V.prototype.shouldFetchData=function C(){if(this.props.totalSize==null){if(this.props.prefixItems){return(mstr.$A.len(this.props.items)-mstr.$A.len(this.props.prefixItems))<=0;}else{return !mstr.$A.len(this.props.items);}}return false;};V.prototype.fetchBlock=function AP(At,Au){var Av=this.getContainer();if(!Av){return false;}switch(Av.value&&parseInt(Av.value.tp)){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:return this.browseFolderBlock(Av.value.dssid,At,Au,Av.value);break;default:if(mstr.utils.ListViewHelper.isWithinHierarchy(Av)){if(!Au&&this.isElementSearchRequired(Av)){this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:[],totalSize:0,blockBegin:1,searchPattern:Au});return true;}else{return this.browseHierarchyBlock(this._buildHierarchyPathForNode(Av),At,Au,{commandId:"BrowseContainerTreeNode",node:Av,searchPattern:Au});}}else{if(parseInt(Av.value.tp)==mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE){if(!Au&&this.isElementSearchRequired(Av)){this._loadResults({browsedItems:null,browsedItemsSiblings:null,listItems:[],totalSize:0,blockBegin:1,searchPattern:Au});return true;}else{return this.browseAttributeBlock(Av.value.dssid,At,Au);}}}break;}};V.prototype.execFetchFirst=function AL(){return this.execFetchBlock(1);};V.prototype.execFetchPrevious=function n(){return this.execFetchBlock(this._computePreviousBlockBegin());};V.prototype.execFetchNext=function AD(){return this.execFetchBlock(this._computeNextBlockBegin());};V.prototype.execFetchLast=function o(){return this.execFetchBlock(this._computeLastBlockBegin());};V.prototype.queryEnabledFetchFirst=function G(){var At=this.props.totalSize;var Au=this.props.blockCount;return(At>0)&&(Au>0)&&(this.props.blockBegin>1);};V.prototype.queryEnabledFetchPrevious=function AW(){var At=this.props.blockBegin;return(At>1)&&(this._computePreviousBlockBegin()<At);};V.prototype.queryEnabledFetchNext=function U(){return this._computeNextBlockBegin()>0;};V.prototype.queryEnabledFetchLast=function Q(){var At=this.props.blockBegin;return At>0&&(this._computeLastBlockBegin()>=At+this.props.blockCount);};V.prototype._computePreviousBlockBegin=function z(){var At=this.props.totalSize;var Au=this.props.blockCount;if(At>0&&Au>0){return Math.max(1,this.props.blockBegin-Au);}return -1;};V.prototype._computeNextBlockBegin=function R(){var At=this.props.totalSize;var Au=this.props.blockCount;if(At>0&&Au>0){if(this.props.blockBegin+Au<=At){return this.props.blockBegin+Au;}}return -1;};V.prototype._computeLastBlockBegin=function AC(){var At=this.props.totalSize;var Au=this.props.blockCount;if(At>0&&Au>0){var Av=At%Au;if(Av==0){Av=Au;}return At-Av+1;}return -1;};V.prototype.getFetchBlockModel=function Y(){var Aw=false;var At=this.props.fetchBlockModel;if(At){Aw=(At.get("blockBegin")==this.props.blockBegin)&&(At.get("totalSize")==this.props.totalSize);}if(!Aw){var Av=parseInt(this.props.totalSize)||0;var Au={min:Math.min(1,Av),max:Av,dataType:mstr.Enum.Nodes.DATATYPE.INTEGER,valueString:parseInt(this.props.blockBegin)||""};At=new mstr.models.ConstantPromptAnswer(Au);if(At){mstr.controllers.Factory.add(At);At.init&&At.init();this.props.fetchBlockModel=At;}}return At;};V.prototype.execSearch=function Ab(At){this.fetchBlock(1,At);};V.prototype.on_set_readyState=function h(At){if(At&&At.src==this){this._updateCommandEnabledSearch();this._updateCommandEnabledFetchBlock();this._updateCommandEnabledBrowseFolder();}};V.prototype._updateCommandEnabledSearch=function D(){var Au=false;var A1=false;if(this.props.readyState==mstr.Enum.Widget.READYSTATE.IDLE){var A0=this.getContainer(),Aw=A0&&A0.value,Az=Aw&&parseInt(Aw.tp);switch(Az){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:Au=true;break;case mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE:var Ax=this.props.items,At=this.props.prefixItems,Ay=Ax&&Ax[(At?At.length:0)];Au=(!this.props.elementSearchDisabled)&&(!Ay||(parseInt(Ay.tp)==mstr.Enum.MSTRFolderItem.TYPE.ELEMENT));A1=Au&&!this.props.matchCaseDisabled;break;case mstr.Enum.MSTRFolderItem.TYPE.FILTER:Au=(A0.readyState==null)||(A0.readyState==mstr.Enum.Widget.READYSTATE.IDLE);Au=Au&&(!this.props.elementSearchDisabled);Au=Au&&mstr.utils.ListViewHelper.isWithinHierarchy(A0);A1=Au&&!this.props.matchCaseDisabled;break;}}else{if(this.props.readyState==mstr.Enum.Widget.READYSTATE.ERROR){var Av=this.props.requestContext&&this.props.requestContext.memo&&this.props.requestContext.memo.searchPattern;if(Av){Au=true;}}}this.set("CommandEnabledSearch",Au);this.set("searchMatchCaseAvailable",A1);};V.prototype._updateCommandEnabledBrowseFolder=function A(){var Au=this.props.readyState,Av=(Au==mstr.Enum.Widget.READYSTATE.IDLE),At=Av||(Au==mstr.Enum.Widget.READYSTATE.ERROR);this.set("CommandEnabledBrowseFolder",Av);this.set("CommandEnabledBrowseContainerTreeNode",At);var Aw=(At&&this.getContainer())||null;this.set("CommandEnabledBrowseContainerParent",!!(Aw&&Aw.parent&&!(Aw.parent.parent==null&&this._isDummyNode(Aw.parent))));};V.prototype._updateCommandEnabledFetchBlock=function W(){var Au=this.props.blockCount;var At=this.props.totalSize;this.set("CommandEnabledFetchBlock",(this.props.readyState==mstr.Enum.Widget.READYSTATE.IDLE)&&(Au>0)&&(At>0)&&(Au<At));};V.prototype.loadRequestResponse=function I(){var Ay=this.props.requestContext;var A9=Ay&&Ay.response;if(!A9||!A9.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var A7=A9.data;this.set("searchPattern",Ay.memo&&Ay.memo.searchPattern);var At;if(this.props.keepSelectionsAfterRequest){At=this.getSelectedItems();if(!At||!At.length){At=this.props.keptSelections;}this.props.keptSelections=null;}var Az;switch(Ay.memo&&Ay.memo.commandId){case"BrowseForms":var A1=A7.getContainer();Az=A1&&A1.value&&A1.value.dssforms;if(this.props.prefixItems){Az=Az?this.props.prefixItems.concat(Az):this.props.prefixItems.concat();}var A6=mstr.$A.len(Az);this.set("totalSize",A6);this.set("blockCount",0);this.set("blockBegin",A6?0:1);this.set("leafElements",false);this.setContainerTree(A1&&A1.value);this.setItems(Az||[]);break;default:var A8=["totalSize","blockCount","blockBegin","leafElements"];for(var A5=0;A5<A8.length;A5++){this.set(A8[A5],A7.get(A8[A5]));}switch(Ay.memo&&Ay.memo.commandId){case"BrowseHierarchyItem":this._appendBrowsedItemsToContainerTree(Ay.memo.items,Ay.memo.itemsSiblings);break;case"BrowseContainerTreeNode":var A4=Ay.memo.node;if(A4){var Ax=this.getContainerTree();if(Ax){Ax.execCommand("SingleSelect",A4);var A0=A4.parent;var Aw=A0&&A0.children||[A4];for(var A5=0,A6=mstr.$A.len(Aw);A5<A6;A5++){Ax.removeAllChildNodes(Aw[A5]);}}}break;default:if(this.props.keepFolders||(Ay.memo&&Ay.memo.commandId=="BrowseAttribute")){var Au=Ay.memo.item;if(!Au){var A3=A7.getContainer();Au=A3&&A3.value;}this._appendBrowsedItemsToContainerTree([Au],[this.getItems()]);}else{var BA=A7.getContainerTree();var A2=this.getContainerTree();if(A2){var Av=BA&&BA.getRootNode();if(Av){Av=mstr.utils.Trees.cloneSubTree(Av);}A2.setRootNode(Av);A2.setSelectedPaths(BA&&BA.getSelectedPaths());}}}Az=A7.getItems()||[];this.setRMCModel(A7.props.rmc);if(this.props.headerModel){this.updateHeaderModel();}if(this.props.prefixItems){Az=Az?this.props.prefixItems.concat(Az):this.props.prefixItems.concat();}this.setItems(Az);}if(mstr.$A.len(At)){this.setSelectedItems(At);}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);this.raiseEvent("loadRequestResponse",null);};V.prototype._shouldKeepBrowsedItemSiblings=function Aa(Au,At){if(!Au||!At){return null;}if(this.props.keepEntryPoints&&Au.value&&(Au.value.tp==mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY)){return mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE;}else{if(this.props.keepHierarchies&&(At.tp==mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY)){return mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY;}else{if(this.props.keepFolders&&!Au.parent&&(At.tp==mstr.Enum.MSTRFolderItem.TYPE.FOLDER)){return mstr.Enum.MSTRFolderItem.TYPE.FOLDER;}}}return null;};V.prototype._isSingleFilterNode=function K(Au){var At=Au&&Au.value;if(At&&(At.stp==256||At.tp==1)){var Av=Au.parent&&Au.parent.value;if(Av&&Av.filters&&Av.filters.length==1){return true;}}return false;};V.prototype._isDummyNode=function m(At){return !(At&&At.value&&At.value.tp&&(At.value.tp>0));};V.prototype._appendBrowsedItemsToContainerTree=function AR(A1,A2){var A6=this.getContainerTree();if(!A6||!mstr.$A.len(A1)){return ;}var A5=this.getContainer(),A0=this.props.valueForm,A7,A3,Au,Aw,A4,Av;for(var Ax in A1){A7=A1[Ax];A3=A2&&A2[Ax];if(!A7||!A5){break;}if(A5&&A5.value&&A5.value[A0]==A7[A0]){if(A5.value.dssforms&&A7.dssforms){A5.value.dssforms=A7.dssforms;}break;}Aw=[];A4=null;var Az=this._isDummyNode(A5);if(Az||(Av=this._shouldKeepBrowsedItemSiblings(A5,A7))){for(var Ay=0,At=mstr.$A.len(A3);Ay<At;Ay++){if(Az||(A3[Ay]&&A3[Ay]["tp"]==Av)){Aw.push({value:A3[Ay]});if(A3[Ay][A0]==A7[A0]){A4=Aw[Aw.length-1];}}}if(!A4){A4={value:A7};Aw.push(A4);}}else{A4={value:A7};Aw.push(A4);}Au=A6.getNodePath(A5)+mstr.models.AbstractTreeBase.PATHDELIM+mstr.$A.len(A5.children);A6.insertNodesAt(Aw,Au);A6.execCommand("SingleSelect",A4);A5=A4;}};V.prototype.getPropertyNameForForm=function M(Av){if(Av!=null){var Au=this.getContainer();if(Au&&Au.value&&Au.value.dssforms){var At=mstr.$A.findByForm(Au.value.dssforms,Av,"dssid");if(At>-1){return"form"+At;}}}return null;};V.prototype.clone=function Am(){var Au=mstr.$H.clone(this.props);Au.items=[].concat(Au.items);Au.selectedIndices=mstr.$H.clone(Au.selectedIndices);if(this.getContainer()){Au.containerTree=this.getContainerTree()&&this.getContainerTree().clone();}else{Au.containerTree=null;}Au.container=null;Au.id=mstr.controllers.Factory.nextFreeId();var At=new V(Au,false);if(this.props.headerModel){At._initHeaderModel();}if(!At){return ;}mstr.controllers.Factory.add(At);At.init&&At.init();return At;};V.prototype.init=function T(){mstr.models.BaseModel.prototype.init.apply(this);if(this.props.container||this.props.blockBegin){this._updateCommandEnabledBrowseFolder();this._updateCommandEnabledSearch();}if(this.props.autoSelectFirstItem&&!this.props.defaultSelection&&this.getSelectedIndex()==-1){this.execSelect({0:true});}};function V(At,Au){mstr.models.BaseModel.apply(this,[At]);this.props.items=this.props.items||[];if(this.props.prefixItems&&(Au!==false)){this.props.items=this.props.prefixItems.concat(this.props.items);}this.props.selectedIndices=this.props.selectedIndices||{};if(this.props.selectedIndicesList){var Av=mstr.$A.toHash(this.props.selectedIndicesList.split(","));this.execSelect(Av);}if(this.props.anchorIndex==null){this.props.anchorIndex=-1;}if(this.props.leadIndex==null){this.props.leadIndex=-1;}this._updateCommandEnabledFetchBlock();}return V;})();mstr.models.dnd={};mstr.models.dnd.DragZone=(function(){mstr.$O.extendsClass(G,mstr.models.BaseModel);G.prototype.init=function E(){mstr.controllers.EventManager.attachWindowEventListener(this,"mousedown","onmousedown");mstr.controllers.EventManager.attachWindowEventListener(this,"mouseup","onmouseup");mstr.utils.Hash.applydefault(this.props,{delay:200});};G.prototype.findTarget=function H(M,N){return null;};G.prototype.getDragData=function L(M,N){return{ddel:this.get("src").cloneNode(true)};};G.prototype.startDrag=function A(M){};G.prototype.drag=function K(N,M,O){};G.prototype.endDrag=function J(N,M,O){};G.prototype.onmousedown=function C(O){if(this.get("view").get("renderStatus")<3){return null;}var M=this.findTarget(this.get("view"),O);if(!M){return ;}var N=this;this.delayHandle=window.setTimeout(function(){N.initDrag(O,M);},this.get("delay"));};G.prototype.initDrag=function D(T,V){delete this.delayHandle;mstr.controllers.EventManager.attachWindowEventListener(this,"mousemove","onmousemove");this.set("dragging",true);this.set("src",V);var S=mstr.utils.BoxModel.getBox(V);this.set("xOffset",T.x-S.left);this.set("yOffset",T.y-S.top);var U=this.getDragData(this.get("view"),T);this.set("data",U);U.ddel.style.left="0";U.ddel.style.top="0";var N=this.get("el");if(!N){N=document.createElement("div");N.style.position="absolute";N.style.zIndex=10001;document.body.appendChild(N);this.set("el",N);}else{N.removeChild(N.firstChild);}N.appendChild(U.ddel);var P={};var Q=["x","y"];var M,O;for(var R=0;R<2;R++){M=Q[R];O=this.get(M+"Min");if(O||!isNaN(O)){P[M+"Min"]=(typeof (O)=="function")?O():O;}O=this.get(M+"Max");if(O||!isNaN(O)){P[M+"Max"]=(typeof (O)=="function")?O():O;}P[M]=(("xMin" in P)||("xMax" in P));}this.set("constraints",P);this.startDrag(this.get("view"));this.onmousemove(T);};G.prototype.onmousemove=function I(O){if(!this.get("dragging")){return ;}var M=O.x-this.get("xOffset");var Q=O.y-this.get("yOffset");var P=this.constrainXY(M,Q);var N=this.get("el");N.style.left=P.x+"px";N.style.top=P.y+"px";this.drag(this.get("view"),P.x,P.y);};G.prototype.onmouseup=function F(N){if(!this.get("dragging")){if(this.delayHandle){window.clearTimeout(this.delayHandle);delete this.delayHandle;}return ;}this.set("dragging",false);mstr.controllers.EventManager.detachWindowEventListener(this,"mousemove");var O=this.constrainXY(N.x-this.get("xOffset"),N.y-this.get("yOffset"));this.endDrag(this.get("view"),O.x,O.y);var M=this.get("el");M.style.top="-10000px";};G.prototype.constrainXY=function B(N,M){var O=this.get("constraints");if(O.x){if(!isNaN(O.xMin)){N=Math.max(N,O.xMin);}if(!isNaN(O.xMax)){N=Math.min(N,O.xMax);}}if(O.y){if(!isNaN(O.yMin)){M=Math.max(M,O.yMin);}if(!isNaN(O.yMax)){M=Math.min(M,O.yMax);}}return{x:N,y:M};};function G(N,M){mstr.models.BaseModel.apply(this,[N]);mstr.utils.Hash.overwrite(this,M);mstr.controllers.Factory.add(this);this.init();}return G;})();mstr.http.FrameProcessor=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.isHTTPProcessor=true;B.prototype.setInputs=function C(J){this.props.inputs=J;this.props.readyState=mstr.Enum.Widget.READYSTATE.IDLE;this.props.response=null;};B.prototype.submit=function A(){var K=this.props.inputs;if(!K){return ;}var O=K.htmlForm?K.htmlForm.ownerDocument:this.props.document;if(!O){return ;}var M=K.htmlForm;if(!M){M=O.createElement("form");O.body.appendChild(M);M.method="POST";}var J=this.props.taskURL;J=microstrategy.addJSessionID(J);M.action=J;M.target=this.props.frameName;M.appendChild(this._getHiddenInput(O,"taskEnv","juil_iframe",Q));var N;var Q=(K.htmlForm)?[]:null;for(var P in K.params){M.appendChild(this._getHiddenInput(O,P,K.params[P],Q));}M.appendChild(this._getHiddenInput(O,"_xts_",new Date().getTime(),Q));for(var L in microstrategy.persistParams){M.appendChild(this._getHiddenInput(O,L,microstrategy.persistParams[L],Q));}this.props.cancelled=false;this.props.readyState=mstr.Enum.Widget.READYSTATE.WAITING;this.props.lastSubmit=new Date();if(parseInt(this.props.timeout)){this.props.timeoutId=self.setTimeout('mstr.$obj("'+this.getId()+'").timeout()',parseInt(this.props.timeout));}M.submit();if(Q){while(N=Q.pop()){M.removeChild(N);}}};B.prototype._getHiddenInput=function G(L,N,J,M){var K=L.createElement("input");K.type="hidden";K.name=N;K.value=J;if(M){M.push(K);}return K;};B.prototype.timeout=function H(){this._clearTimeout();if(this.props.readyState==mstr.Enum.Widget.READYSTATE.WAITING){this.set("readyState",mstr.Enum.Widget.READYSTATE.TIMEOUT);}};B.prototype.cancel=function D(){this._clearTimeout();if(this.props.readyState==mstr.Enum.Widget.READYSTATE.WAITING){this.props.cancelled=true;this.set("readyState",mstr.Enum.Widget.READYSTATE.CANCELLED);}};B.prototype.update=function F(J){this._clearTimeout();var K=this.props.response=J&&J.mstrResponse;if(J){J.mstrResponse=null;}if(parseInt(K&&K.statusCode)==200){this.props.lastSuccess=new Date();this.set("readyState",mstr.Enum.Widget.READYSTATE.SUCCESS);}else{this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);}};B.prototype.getResponse=function I(){return this.props.response;};B.prototype._clearTimeout=function E(){var J=this.props.timeoutId;if(J){self.clearTimeout(J);this.props.timeoutId=null;}};function B(J){mstr.models.BaseModel.apply(this,[J]);}return B;})();mstr.http.BrowseFolderRequestInputs=(function(){function A(D,E,G,C,B,H,F,I){this.url="../servlet/taskProc";this.params={taskId:"searchMetadata",rootFolderID:D,blockBegin:E,blockCount:G,recursive:B?0:(F?"":1),folderBrowserStyle:B?1:0,includeAncestorInfo:String(!!B),searchXML:F,dataSourcesXML:I||"",objectType:H};}return A;})();mstr.http.MetadataSearchRequestInputs=(function(){function A(C,D,G,B,H,F,E,I){this.params={taskId:"searchMetadata",rootFolderID:C,searchPattern:E,nameWildcards:1,blockBegin:D,blockCount:G,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",searchXML:F,dataSourcesXML:I||"",objectType:H};}return A;})();mstr.views={};mstr.views.IView={get:null,set:null,getModel:null,setModel:null,render:null,update:null};mstr.views.BaseView=(function(){mstr.$O.extendsClass(BV,mstr.models.BaseModel);BV.prototype.DEFAULTS={visible:true,enabled:true,renderStatus:mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED,validationStatus:{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:false}};BV.prototype.getModel=function BV_getModel(){return this.props.model;};BV.prototype.setModel=function BV_setModel(m){if(m==this.props.model){return false;}if(this.props.model){this._detachLayoutHandlers();}this.props.model=m;this._modelDirty=true;var names=this.props.modelPushedProps;var arr=names&&names.split&&names.split(",");for(var i=0,len=arr&&arr.length||0;i<len;i++){var p=arr[i];var overwrite=(p.indexOf("!")==0);if(overwrite){p=p.substr(1);}if(!(p in m.props)){continue;}this["set_"+p]=function(evt){var p1=evt.name.substring(4,evt.name.length);var m1=evt.originalSrc;this.setPropertyByPath(p1.replace("|","/"),m1&&m1.props[p1],false);};m.attachEventListener(this,"set_"+p,"set_"+p);if(overwrite||mstr.controllers.Factory.getPath(p.replace("|","/"),this)==null){this.setPropertyByPath(p.replace("|","/"),m&&m.props[p],true);if(m.props[p] instanceof mstr.models.BaseModel){m.props[p].set("parent",this);}}}if(this.props.cmds){this._refreshCommandHandlers();}this._refreshChildViewModels();if(this._shouldAutoRender()){this.render();}return true;};BV.prototype.initModel=function BV_initModel(){var p=this.props.modelPath;if(p!=null){this.setModel(mstr.controllers.Factory.getPath(p,this));}};BV.prototype.initValidator=function BV_initValidator(){var p=this.props.validator;if(p!=null){var obj=p[mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(p,this.props[mstr.$W.DOCUMENT]);if(obj){this.props.validator=obj;var zz=obj.props&&(obj.props[mstr.$W.PARENT]=this);zz=obj.init&&obj.init();}}};BV.prototype.execResetValidationStatus=function BV_execResetValidationStatus(){var vs=this.get("validationStatus");if(vs.statusCode!=mstr.Enum.Validation.STATUSCODE.VALID){this.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});this.updateAllProps();}};BV.prototype.execCheckValidationStatus=function FE_execCheckValidationStatus(){return !(this.get("validationStatus").statusCode>mstr.Enum.Validation.STATUSCODE.VALID);};BV.prototype.after_set_validationStatus=function BV_after_set_validationStatus(){var vs=this.get("validationStatus");if(vs.bubble){this.raiseEvent("set_childValidationStatus",{id:this.getId(),code:vs.statusCode},true);}};BV.prototype._refreshChildViewModels=function BV_refCVM(cascade){for(var i=0,len=mstr.$A.len(this._childViewsInstantiated);i<len;i++){var child=this._childViewsInstantiated[i];var p=child&&child.props&&child.props.modelPath;if(p&&(p.substring(0,7)=="parent/")){child.initModel&&child.initModel();}var cmds=child.props.cmdArray;for(var j=0,lenCmds=mstr.$A.len(cmds);j<lenCmds;j++){if(cmds[j]&&cmds[j].targetPath&&(cmds[j].targetPath.substring(0,7)=="parent/")){child._refreshCommandHandlers();break;}}if(cascade){child._refreshChildViewModels(cascade);}}};BV.prototype.getLayoutXML=function BV_getLayoutXML(){return this._layoutXML;};BV.prototype.setLayoutXML=function BV_setLayoutXML(sXML){if(sXML==this._layoutXML){return false;}if(this._layoutXML){this._detachLayoutHandlers();}this._layoutXML=sXML;this._layoutDirty=true;if(this._shouldAutoRender()){this.render();}};BV.prototype.initLayoutXML=function BV_initLayoutXML(){var c=this.props[mstr.$W.LAYOUTCLASS];if(c){c=c.replace(/\@[^:]*:/g,"");this.props[mstr.$W.LAYOUTCLASS]=c;}c&&this.setLayoutXML(eval(c));};BV.prototype.render=function BV_render(){if(!mstr.timers.renderStart){mstr.timers.renderStart=new Date();}var LR=mstr.utils.LayoutRenderer;var result=LR.render(this.props,this._layoutXML);var elNew=result&&result.el&&result.el.childNodes&&result.el.childNodes[0];if(!elNew){return ;}elNew.style.display="none";var curElement=this.props[mstr.$W.ELEMENT];if(this.get("preserveDOMNode")&&this.get("parent")==null){mstr.$D.insertNode(elNew,curElement.parentNode,curElement);}else{mstr.$D.replaceNode(curElement,elNew);}this.props[mstr.$W.ELEMENT]=elNew;this.props[mstr.$W.RENDERSTATUS]=result.renderStatus;this._layoutHandlers=LR.getLayoutHandlers(this.props[mstr.$W.LAYOUTCLASS],this._layoutXML);this._layoutHandlers=LR.replaceLayoutHandlerTokens(this._layoutHandlers,this);this._attachLayoutHandlers();if(this.props.cmds){this._refreshCommandHandlers();}this._layoutDirty=false;this.updateAllProps();this._modelDirty=false;this.props.childViewPaths=result.childPaths;this.props.childViewRenderCounter=0;if(mstr.$A.len(result.childPaths)){var p=parseInt(this.props.pauseBeforeRenderingChildren);if(p>0){window.setTimeout('mstr.$obj("'+this.getId()+'").renderNextChildView()',p);}else{this.renderNextChildView();}}else{this.props[mstr.$W.RENDERSTATUS]=mstr.Enum.Widget.RENDERSTATUS.RENDEREDCHILDREN;mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;}};BV.prototype._shouldAutoRender=function BV_shouldAutoRender(){var rs=this.props[mstr.$W.RENDERSTATUS];return(rs!=null&&rs!=mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED);};BV.prototype.renderNextChildView=function BV_renderNextChildView(){var paths=this.props.childViewPaths,unrenderedPaths={};if(paths){var childInfo;while(childInfo=paths.shift()){if(this.renderChildAt(childInfo.name,childInfo.id)){this.props.childViewRenderCounter++;if(this.props.childViewRenderCounter%mstr.views.BaseView.REPAINT_EVERY_CHILDCOUNT==0){window.setTimeout('mstr.$obj("'+this.getId()+'").renderNextChildView()',1);break;}}else{unrenderedPaths[childInfo.name]=childInfo;}}this.props.unrenderedChildViewPaths=unrenderedPaths;}if(!mstr.$A.len(paths)){this.props[mstr.$W.RENDERSTATUS]=mstr.Enum.Widget.RENDERSTATUS.RENDEREDCHILDREN;mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;this.execLayoutHandler("on_win_resize");}};BV.prototype.renderChildAt=function BV_renderChildAt(path,placeholderId){var child=mstr.controllers.Factory.getPath(path,this);if(!child){return false;}var doc=this.props[mstr.$W.DOCUMENT];var el=doc&&doc.getElementById(placeholderId);mstr.controllers.Factory.safeset(child,"document",doc);mstr.controllers.Factory.safeset(child,"element",el);mstr.controllers.Factory.safeset(child,"renderStatus",mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED);if((child.props&&child.props.visible==false)||child.visible==false){return false;}if(!child.getId){child[mstr.$W.PARENT]=this;child=mstr.controllers.Factory.registerElement(el,null,child);if(child){mstr.controllers.Factory.setPath(path,this,child,true);}this._childViewsInstantiated.push(child);}if(child&&child.render){child.render();return true;}return false;};BV.prototype._attachLayoutHandlers=function BV_attachLayoutHandlers(){var model=this.props.model;var handlers=this._layoutHandlers&&this._layoutHandlers.info;if(handlers&&model&&model.attachEventListener){for(var n in handlers){switch(handlers[n].src){case"model":model.attachEventListener(this,handlers[n].eventName,"update");break;case"win":mstr.controllers.EventManager.attachWindowEventListener(this,handlers[n].eventName,"update");break;default:if(handlers[n]&&handlers[n].src&&handlers[n].src.substr(0,5)=="model"){var paths=handlers[n].src.split(".");var temp=model;for(var i=1;i<paths.length;i++){temp=temp.get(paths[i]);}temp.attachEventListener(this,handlers[n].eventName,"update");break;}}}}this._attachPropertiesHandlers(["enabled","visible"]);};BV.prototype._attachPropertiesHandlers=function BV_attachPropertiesHandlers(ps){var path,pathParts,obj,field,callbackName;for(var i=0,len=ps.length;i<len;i++){path=this.props[ps[i]+"Field"];if(path==null||path==""){continue;}callbackName="on"+ps[i]+"FieldValueChange";if(!this[callbackName]){continue;}if(path.charAt(0)=="!"){path=path.substring(1);}pathParts=path.split(mstr.controllers.Factory.PATHDELIM);field=pathParts.pop();var valueIndex=field.indexOf(":");if(valueIndex>-1){var valueParts=field.split(":");field=valueParts[0];this.props[ps[i]+"SourceFieldValues"]=valueParts[1].split(",");}this.props[ps[i]+"SourceField"]=field;path=pathParts.join(mstr.controllers.Factory.PATHDELIM);this.props[ps[i]+"Source"]=obj=path.length?mstr.$path(path,this):this;if(obj instanceof mstr.models.ListModel&&field=="selectedIndices"){obj&&obj.attachEventListener&&obj.attachEventListener(this,"hashadd_"+field,callbackName);}else{obj&&obj.attachEventListener&&obj.attachEventListener(this,"set_"+field,callbackName);}if(obj){this[callbackName]({memo:{value:obj.get(field)}});}}};BV.prototype._detachLayoutHandlers=function BV_detachLayoutHandlers(){var model=this.props.model;var handlers=this._layoutHandlers&&this._layoutHandlers.info;if(handlers&&model&&model.detachEventListener){for(var n in handlers){switch(handlers[n].src){case"model":model.detachEventListener(this,handlers[n].eventName);break;case"win":mstr.controllers.EventManager.detachWindowEventListener(this,handlers[n].eventName);}}}this._detachPropertiesHandlers(["enabled","visible"]);};BV.prototype._detachPropertiesHandlers=function BV_detachPropertiesHandlers(ps){var obj,field;for(var i=0,len=ps.length;i<len;i++){obj=this.props[ps[i]+"Source"];field=this.props[ps[i]+"SourceField"];obj&&obj.detachEventListener&&obj.detachEventListener(this,"set_"+field);}};BV.prototype.onenabledFieldValueChange=function BV_onEnabledFieldValueChange(evt){var fieldValue=this.extractEventSourceFieldValue("enabled",evt);var fieldPath=this.props.enabledField;if(fieldPath&&fieldPath.charAt(0)=="!"){fieldValue=!fieldValue;}this.set("enabled",fieldValue);};BV.prototype.onvisibleFieldValueChange=function BV_onVisibleFieldValueChange(evt){var fieldValue=this.extractEventSourceFieldValue("visible",evt);fieldPath=this.props.visibleField;if(fieldPath&&fieldPath.charAt(0)=="!"){fieldValue=!fieldValue;}this.set("visible",fieldValue);};BV.prototype.extractEventSourceFieldValue=function BV_extractEventSourceFieldValue(name,evt){if(!this.props[name+"SourceFieldValues"]){return !!evt&&evt.memo&&evt.memo.value;}else{var src=this.props[name+"Source"];if(src instanceof mstr.models.ListModel){var hash=src&&src.get(this.props[name+"SourceField"]);if(hash){var testValues=this.props[name+"SourceFieldValues"];if(typeof (hash)=="object"){for(var i=0,cnt=testValues.length;i<cnt;i++){if(testValues[i] in hash){return true;}}}else{for(var i=0,cnt=testValues.length;i<cnt;i++){if(testValues[i]==hash){return true;}}}}}else{return !evt&&evt.memo&&evt.memo.value&&evt.memo.value==this.props[name+"SourceFieldValues"];}}return false;};BV.prototype._refreshCommandHandlers=function BV_refreshCommandHandlers(){var cmds=this.props.cmdArray;if(!cmds){cmds=this.props.cmdArray=this._initCommands(this.props.cmds);}if(this.props.enabledField!=undefined){return ;}if(!cmds||!cmds.length){return ;}var bAnyCommandEnabled=false;var bRequiredCommandsEnabled=true;for(var i=0,len=cmds.length;i<len;i++){if(!cmds[i].id){continue;}var cmdId=cmds[i].id;var attachedTarget=cmds[i].target;var target=cmds[i].targetPath?mstr.$path(cmds[i].targetPath,this):this;if(target!=attachedTarget){attachedTarget&&attachedTarget.detachEventListener&&attachedTarget.detachEventListener(this,"set_CommandEnabled"+cmdId);target&&target.attachEventListener&&target.attachEventListener(this,"set_CommandEnabled"+cmdId,"updateCommandEnabled");cmds[i].target=attachedTarget=(target&&target.execCommand)?target:null;}var v=cmds[i].valuePath;v=(v&&!/^prompt\(/.test(v))?mstr.controllers.Factory.resolveArgsString(v,this):null;cmds[i].enabled=((attachedTarget&&attachedTarget.queryCommandEnabled&&attachedTarget.queryCommandEnabled(cmdId,v))||cmdId.substr(0,4)=="Set_"||false);if(!bAnyCommandEnabled){bAnyCommandEnabled=cmds[i].enabled;}if(bRequiredCommandsEnabled&&cmds[i].required&&!cmds[i].enabled){bRequiredCommandsEnabled=false;}}this.set("enabled",bRequiredCommandsEnabled&&bAnyCommandEnabled);};BV.prototype.updateCommandEnabled=function BV_updateCmdEnabled(evt){var id=String(evt&&evt.name).substr(18);if(!id){return ;}var cmds=this.props.cmdArray;var index=mstr.$A.findByForm(cmds,id,"id");if(index>-1){var v=cmds[index].valuePath;v=v?mstr.controllers.Factory.resolveArgsString(v,this):null;var en=!!(evt.src&&evt.src.queryCommandEnabled&&evt.src.queryCommandEnabled(id,v));var bChanged=(!!cmds[index].enabled!=!!en);if(bChanged){cmds[index].enabled=!!en;var bViewEnabled=!!en;if(!bViewEnabled){var i=mstr.$A.findByForm(cmds,"enabled",true);if(i>-1){bViewEnabled=true;}}this.set("enabled",bViewEnabled);}}};BV.prototype.execFireCommands=function BV_execFireCmds(defaultCmdValue){return this.fireCommands(null,defaultCmdValue);};BV.prototype.fireCommands=function CV_fireCommands(cmdsString,defaultCmdValue){var cmds;if(cmdsString){cmds=this._initCommands(cmdsString);}else{cmds=this.props.cmdArray;}for(var i=0,len=mstr.$A.len(cmds);i<len;i++){var cmdReturnValue=false;var t=cmds[i].target;if(!t){t=cmds[i].targetPath?mstr.$path(cmds[i].targetPath,this):this;}if(t&&t.execCommand){var v=cmds[i].valuePath;v=v?mstr.controllers.Factory.resolveArgsString(v,this):null;if(v==null){v=[defaultCmdValue];}cmdReturnValue=t.execCommand.apply(t,[cmds[i].id].concat(v));}if(!cmdReturnValue&&cmds[i].required){break;}}return true;};BV.prototype._initCommands=function BV_initCommands(s){if(!s){return ;}s=(s&&s.split)?s.split(";"):[s];var len=s.length;if(len){var arr=[];for(var i=0;i<len;i++){var parts=(s[i]&&s[i].split)?s[i].split("|"):[s[i]];if(parts[0]){var bRequired=(String(parts[0]).charAt(0)=="!");if(bRequired){parts[0]=String(parts[0]).substr(1);}arr.push({id:parts[0],valuePath:parts[1],targetPath:parts[2],required:bRequired});}}return arr;}return null;};BV.prototype.computeHandlerNameForEvent=function BV_compHNforEvent(evt){if(evt.src==this.props.model){return"on_model_"+evt.name;}else{if(evt.src==this.props.document){return"on_win_"+evt.name;}else{return"on_"+evt.name;}}};BV.prototype.searchHandlerByEventName=function BV_searchHandlerByEventName(evt){if(this._layoutHandlers&&this._layoutHandlers.info){for(var n in this._layoutHandlers.info){if(this._layoutHandlers.info[n].eventName==evt.name){return this._layoutHandlers.info[n];}}}return null;};BV.prototype.update=function BV_update(evt){if(evt){var hName=this.computeHandlerNameForEvent(evt);var hInfo=this._layoutHandlers&&this._layoutHandlers.info&&this._layoutHandlers.info[hName];if(!hInfo){hInfo=this.searchHandlerByEventName(evt);if(hInfo){hName=hInfo.name;}}switch(hInfo&&hInfo.method){case"listadd":var range={min:evt.memo.start,max:evt.memo.start+evt.memo.count-1};this._updateListPropIteratively(hName,hInfo,[range]);break;case"listremove":this._updateListPropIteratively(hName,hInfo,evt.memo.ranges);break;case"hashadd":case"hashremove":this._updateHashPropIteratively(hName,hInfo,evt.memo.at);break;default:return this.execLayoutHandler(hName);}}};BV.prototype.updateAllProps=function BV_updateAllProps(){if(!this._layoutHandlers){return ;}var names=this._layoutHandlers.sequence;var infos=this._layoutHandlers.info;var v=this,m=this.props.model,el=this.props.element;for(var i=0,len=mstr.$A.len(names);i<len;i++){var hName=names[i];var hInfo=infos[hName];switch(hInfo&&hInfo.method){case"set":case"win":case null:case undefined:var h=this._validateLayoutHandlerFunction(hInfo);if(h){var retVal=h(v,m,el,{init:true});if(hName&&!hName.match(/^on\_/)){this.props[hName]=retVal;}}break;case"listadd":var src=(hInfo.src=="model")?m:v;if(src){var vals=(src==v)?src.props[hInfo.prop]:src.get&&src.get(hInfo.prop);var len=mstr.$A.len(vals);if(len){var range={min:0,max:len-1};this._updateListPropIteratively(hName,hInfo,[range]);}}break;case"hashadd":var src=(hInfo.src=="model")?m:v;if(src){var keys=(src==v)?src.props[hInfo.prop]:src.get&&src.get(hInfo.prop);this._updateHashPropIteratively(hName,hInfo,keys);}break;}}};BV.prototype.execLayoutHandler=function BV_execLH(hName,index){var hInfo=this._layoutHandlers&&this._layoutHandlers.info&&this._layoutHandlers.info[hName];var h=this._validateLayoutHandlerFunction(hInfo);return h&&h(this,this.props.model,this.props[mstr.$W.ELEMENT],index);};BV.prototype._updateHashPropIteratively=function BV_updateHashPropIteratively(hName,hInfo,keys){var h=this._validateLayoutHandlerFunction(hInfo);if(!h){return ;}var v=this;var m=this.props.model;var el=this.props[mstr.$W.ELEMENT];for(var key in keys){h(v,m,el,key);}};BV.prototype._updateListPropIteratively=function BV_updateListPropIteratively(hName,hInfo,ranges){var h=this._validateLayoutHandlerFunction(hInfo);if(!h){return ;}var v=this;var m=this.props.model;var el=this.props[mstr.$W.ELEMENT];for(var i=0,len=mstr.$A.len(ranges);i<len;i++){var min=ranges[i].min;var max=ranges[i].max;for(var index=min;index<=max;index++){h(v,m,el,index);}}};BV.prototype.raiseEvent=function BV_raiseEvent(name,memo,bubble){if(name){var evt=new mstr.lang.CustomEvent(this,name,memo);if(this["before_"+name]){this["before_"+name](evt);}this.update(evt);if(this["after_"+name]){this["after_"+name](evt);}this.notifyListeners(evt);if(bubble){var zz=this.get("parent")&&this.get("parent").raiseEvent&&this.get("parent").raiseEvent(name,memo,bubble);}}};BV.prototype._validateLayoutHandlerFunction=function BV_validLHF(hInfo){if(hInfo){if(!hInfo.func&&hInfo.str){hInfo.func=new Function("view, model, rootTag, context",hInfo.str);hInfo.str=null;}return hInfo.func;}return null;};BV.prototype.execHide=function BV_execHide(){this.set("visible",false);return true;};BV.prototype.execShow=function BV_execShow(){this.set("visible",true);return true;};BV.prototype.execHideChild=function BV_execHideChild(path){if(path){mstr.controllers.Factory.setPath(path+"/visible",this,false,false);}};BV.prototype.execShowChild=function BV_execShowChild(path){return this._showChildViewAtPath(path);};BV.prototype._showChildViewAtPath=function BV_showChildViewAtPath(childPath){var childView=mstr.controllers.Factory.getPath(childPath,this);if(childView){mstr.controllers.Factory.safeset(childView,"visible",true);if((this.props.renderStatus==mstr.Enum.Widget.RENDERSTATUS.RENDEREDCHILDREN)&&(!childView.getId||(childView.props.renderStatus==mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED))){var childInfo=this.props.unrenderedChildViewPaths&&this.props.unrenderedChildViewPaths[childPath];if(childInfo&&childInfo.id!=null){this.renderChildAt(childPath,childInfo.id);childView=mstr.controllers.Factory.getPath(childPath,this);var m=childView&&childView.props.model;if(m){m.execCommand&&m.execCommand("FetchData");}}}}};BV.prototype.execOpenPopup=function BV_execOpenPopup(popupInfo){self.supressWaitPage=true;try{if(popupInfo){if(typeof (popupInfo)=="string"){popupInfo={popup:mstr.$obj(popupInfo)};}else{if(popupInfo.popup==null){popupInfo={popup:popupInfo};}}}var popup=popupInfo&&popupInfo.popup;if(!popup&&this.props.popupId){popup=mstr.$obj(this.props.popupId);}var useDefault=!popup||!popup.getId;if(useDefault){popup=this.props.popup;}if(!popup){return ;}var p=this.props.currentPopUp;if(p){this.execClosePopup();}if(!popup.getId){if(useDefault){popup[mstr.$W.PARENT]=this;}popup=mstr.controllers.Factory.registerJSON(popup,this.props.document);popup&&popup.init&&popup.init();if(useDefault){this.props.popup=popup;popup&&this._childViewsInstantiated.push(popup);}}this.props.currentPopUp=popup;if(!popup){return ;}popup.attachEventListener(this,"Pop","onPop");if(popupInfo&&popupInfo.x!=null){popup.set("x",popupInfo.x);}if(popupInfo&&popupInfo.y!=null){popup.set("y",popupInfo.y);}popup.execCommand("Pop",this);}finally{window.setTimeout("self.supressWaitPage = false;",10);}};BV.prototype.onPop=function BV_onPop(evt){var p=this.props.currentPopUp;if(p!=(evt&&evt.src)){return ;}this.set("opened",true);p.detachEventListener(this,"Pop");p.attachEventListener(this,"Unpop","onUnpop");self.setTimeout("mstr.controllers.EventManager.attachWindowEventListener(mstr.$obj('"+this.props.id+"'),'mousedown','onMouseEvent')",1);var sc=this.getAncestorByProperty("isScrollProvider");if(sc){if(p.props.element.offsetParent!=sc.props.element){sc.attachEventListener(this,"sync_scroll","onSyncScroll");sc.props._initialScrollTop=sc.props.element.scrollTop;p.props._scrollProvider=sc;if(mstr.utils.ISWK){var docEl=document.documentElement,ov=docEl.style.overflow;docEl.style.overflow="hidden";window.setTimeout(function(){docEl.style.overflow=ov;},0);}}}};BV.prototype.onSyncScroll=function BV_onSyncScroll(evt){var popup=this.props.currentPopUp;if(popup){if(this._scTimer){window.clearTimeout(this._scTimer);}var opener=this.props.element;this._scTimer=window.setTimeout(function(){var popupProps=popup.props,sc=popupProps&&popupProps._scrollProvider;if(sc){var scProps=sc.props,scEl=scProps.element,scST=scEl.scrollTop,delta=scST-scProps._initialScrollTop;var el=popupProps.element;if(el){el.style.top=parseInt(el.style.top)-delta+"px";scProps._initialScrollTop=scEl.scrollTop;var scPos=mstr.utils.BoxModel.position(scEl),scBottom=scPos.top+scPos.height,openerPos=mstr.utils.BoxModel.position(opener),openerBottom=openerPos.top+openerPos.height;el.style.display=openerBottom>=scBottom?"none":"";if(mstr.utils.ISWK){var docEl=document.documentElement,ov=mstr.utils.CSS.getStyleValue(docEl,"overflow");docEl.style.overflow="hidden";window.setTimeout(function(){docEl.style.overflow=ov;},100);}}}},100);}};BV.prototype.onUnpop=function BV_onUnpop(evt){var p=this.props.currentPopUp;if(p!=(evt&&evt.src)){return ;}this.set("opened",false);p.detachEventListener(this,"Unpop");mstr.controllers.EventManager.detachWindowEventListener(this,"mousedown");mstr.controllers.EventManager.detachWindowEventListener(this,"mouseup");this.props.currentPopUp=null;};BV.prototype.onMouseEvent=function BV_onMouseEvent(evt){var p=this.props.currentPopUp;if(!p){return ;}var elTarget=evt&&evt.target();if(!mstr.utils.Dom.containsElement(p.props.element,elTarget,true)&&(!mstr.utils.Dom.containsElement(this.props.element,elTarget,true)||this.props.popupPolicy=="toggle")){var viewId=elTarget&&elTarget.mstrViewId,view=viewId&&mstr.$obj(viewId);if(!p.isAncestorOf(view)){this.execClosePopup();}}};BV.prototype.isAncestorOf=function(view){var p=view;while(p){p=p&&p.props&&p.props.parent;if(p==this){return true;}}return false;};BV.prototype.execClosePopup=function BV_execClosePopup(){var p=this.props.currentPopUp;if(p){p.execCommand("Unpop");}};BV.prototype.execPop=function BV_execPop(opener){if(!opener){return ;}this.props.opener=opener;this.set("visible",false);if(!this.props.element){var doc=opener.props.document||document;this.props.element=doc.createElement("span");}var el=this.props.element;var elOpener=opener.props.element;if(elOpener&&elOpener.parentNode){if(el.parentNode){el.parentNode.removeChild(el);}var elNextSibling=elOpener.nextSibling;if(elNextSibling){elOpener.parentNode.insertBefore(el,elNextSibling);}else{elOpener.parentNode.appendChild(el);}}var m=mstr.$path(this.props.modelPath,this);if(m!=this.getModel()){this.setModel(m);}this.render();this._positionPop();this.set("visible",true);this.raiseEvent("Pop");};BV.prototype._positionPop=function BV_positionPop(){this._prePositionPop();var coords=this._computeNewClientCoords();var BM=mstr.utils.BoxModel,mySize=this._getMySize(),bAllowNudge=(this.props.popOrientation!=mstr.Enum.Widget.POPORIENTATION.VERTICAL);if(bAllowNudge||this.props.nudge){coords.width=mySize.width;coords.height=mySize.height;coords=BM.fitRectWithinRect(coords,BM.getBrowserWindowRect(this.props.element.ownerDocument));}var elOffsetParent=this.props.element.offsetParent,offsetScrollLeft=0,offsetScrollTop=0;if(elOffsetParent){offsetScrollLeft=+elOffsetParent.scrollLeft;offsetScrollTop=+elOffsetParent.scrollTop;}BM.setClientCoords(this.props.element,coords.left+offsetScrollLeft,coords.top+offsetScrollTop);this._postPositionPop(mySize.width,mySize.height);};BV.prototype._prePositionPop=function BV_prePositionPop(){var el=this.props.element,s=el&&el.style;if(!s){return ;}el.className=el.className.replace(/ mstrAsPopup/,"")+" mstrAsPopup";s.visibility="hidden";s.position="absolute";s.zIndex=999;s.display=(el.tagName&&el.tagName.toLowerCase()=="table"&&mstr.utils.ISW3C)?"table":"block";};BV.prototype._postPositionPop=function BV_postPositionPop(width,height){var el=this.props.element,s=el&&el.style;if(!s){return ;}s.display="none";s.visibility="visible";if(mstr.utils.ISIE6){var popupMask=microstrategy.getPopupMask(el),pms=popupMask&&popupMask.style;if(pms){popupMask.className="popupMask_"+el.id;pms.left=s.left;pms.top=s.top;pms.width=width+"px";pms.height=height+"px";pms.zIndex=s.zIndex-1;}}};BV.prototype._getMySize=function BV_getMySize(){var ps=this.props,w=ps.width,h=ps.height,el=ps.element,BM=mstr.utils.BoxModel;if(w&&w.match(/px$/)){w=parseInt(w);}else{w=BM.getElementOuterWidth(el)||BM.getElementOuterWidth(el.firstChild);}if(h&&h.match(/px$/)){h=parseInt(h);}else{h=BM.getElementOuterHeight(el)||BM.getElementOuterHeight(el.firstChild);}return{width:w,height:h};};BV.prototype._computeNewClientCoords=function BV_ccc(){return(this.props.popOrientation==mstr.Enum.Widget.POPORIENTATION.VERTICAL)?this._computeNewClientCoordsAsDropdown():this._computeNewClientCoordsAsCtxtMenu();};BV.prototype._computeNewClientCoordsAsDropdown=function BV_cmpClientAsDD(){var elOpener=this._getOpenerArea();var coords=mstr.utils.BoxModel.getClientCoords(elOpener);coords.top+=elOpener.offsetHeight;return coords;};BV.prototype._computeNewClientCoordsAsCtxtMenu=function BV_cmpClientAsCM(){if(!isNaN(parseInt(this.props.x))&&!isNaN(parseInt(this.props.y))){var el=this.props.element,doc=el&&el.ownerDocument,de=doc&&doc.documentElement;return{left:parseInt(this.props.x)-(de&&de.scrollLeft||0),top:parseInt(this.props.y)-(de&&de.scrollTop||0)};}else{return mstr.utils.BoxModel.getClientCoords(this._getOpenerArea());}};BV.prototype._getOpenerArea=function BV_getOpenerArea(){var opener=this.get("opener"),elOpener=opener&&(opener.execLayoutHandler("openerArea")||opener.get("element"));return elOpener;};BV.prototype.execUnpop=function BV_execUnpop(){if(mstr.utils.ISIE4){microstrategy.releasePopupMask(this.props.element);}this.set("visible",false);this.props.opener=null;this.raiseEvent("Unpop");};BV.prototype.execConfirm=function BV_execConfirm(msg){if(!msg){return false;}return window.confirm(msg);};BV.prototype.prompt=function BV_prompt(msg,defV){if(!msg){return null;}return window.prompt(msg,(defV?defV:""));};BV.prototype.init=function BV_init(){this.initLayoutXML();this.initModel();this.initValidator();};function BV(props){this.props=mstr.utils.Hash.applydefault(props,this.DEFAULTS);this._childViewsInstantiated=[];}return BV;})();mstr.views.Editor=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.execApply=function A(E){this.raiseEvent("apply",{value:E});};B.prototype.execSave=function D(E){this.raiseEvent("save",{value:E});};B.prototype.queryEnabledApply=function C(){return true;};B.prototype.queryEnabledApply=function C(){return false;};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.TextInput=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.shouldWriteBack=function A(F){F=String(F).toLowerCase();var E=mstr.Enum.Widget.AUTOWRITEBACK;switch(parseInt(this.props.autoWriteBack)){case E.ONKEYPRESS:return !!F.match(/keypress|keydown|blur/i);case E.ONBLUR:return !!F.match(/blur/i);case E.OFF:return false;}return !!F.match(/keypress|keydown|blur/i);};B.prototype.getAutoValidate=function C(){var G=mstr.Enum.Widget.AUTOVALIDATE,F=parseInt(this.props.autoValidate);if(isNaN(F)){F=G.USEDEFAULT;}if(F==G.USEDEFAULT){var E=mstr.Enum.Prompts.VALIDATIONLEVEL;switch(mstr.Settings.Prompts.VALIDATIONLEVEL){case E.AFTERANSWEREACH:F=G.ONBLUR;break;case E.INMIDANSWEREACH:F=G.ONKEYPRESS;break;case E.OFF:case E.ATRUNREPORT:default:F=G.OFF;break;}}return F;};B.prototype.getAutoFormat=function D(){var G=mstr.Enum.Widget.AUTOFORMAT,F=parseInt(this.props.autoFormat);if(isNaN(F)){F=G.USEDEFAULT;}if(F==G.USEDEFAULT){var E=mstr.Enum.Prompts.AUTOFORMATLEVEL;switch(mstr.Settings.Prompts.AUTOFORMATLEVEL){case E.AFTERANSWEREACH:F=G.ONBLUR;break;case E.INMIDANSWEREACH:F=G.ONKEYPRESS;break;case E.OFF:case E.BEFORERUNREPORT:case E.AFTERRUNREPORT:default:F=G.OFF;break;}}return F;};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.ViewListBase=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype._attachLayoutHandlers=function C(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);var F=this.props.model;if(F&&F.attachEventListener){F.attachEventListener(this,"hashadd_selectedIndices","onAddSelections");F.attachEventListener(this,"hashremove_selectedIndices","onRemoveSelections");}};B.prototype._detachLayoutHandlers=function D(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);var F=this.props.model;if(F&&F.attachEventListener){F.detachEventListener(this,"hashadd_selectedIndices");F.detachEventListener(this,"hashremove_selectedIndices");}};B.prototype.initChildModelPaths=function E(){var G=this.props.views;var J="parent/model/items/";for(var H=0,F=mstr.$A.len(G);H<F;H++){var I=G[H];if(!I||((I.props&&I.props.modelPath)||(I.modelPath))){continue;}if(I.props){I.props.modelPath=J+H;}else{I.modelPath=J+H;}}};B.prototype.init=function A(){this.initChildModelPaths();mstr.views.BaseView.prototype.init.apply(this);};function B(F){mstr.views.BaseView.apply(this,[F]);}return B;})();mstr.views.ViewBook=(function(){mstr.$O.extendsClass(D,mstr.views.ViewListBase);D.prototype.init=function E(){mstr.views.ViewListBase.prototype.init.apply(this);var F=this.getModel();F.attachEventListener(this,"listadd_items","reRender");F.attachEventListener(this,"listremove_items","reRender");};D.prototype.reRender=function C(){if(this.props.renderStatus!=mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED){this.render();}};D.prototype.render=function B(){this._initChildViewList();mstr.views.ViewListBase.prototype.render.apply(this);};D.prototype._initChildViewList=function A(){var H="parent/model/items/";var N=this.props.views=[];var J=this.props.childViewTypes||this.props.parent.props.childViewTypes;var M=this.props.document,F=this.props.model,K=F&&F.getItems(),Q,L,O;for(var G=0,I=mstr.$A.len(K);G<I;G++){Q=K[G];L=(Q&&Q.get&&Q.get("type"))||"default";O=J&&(J[L]||J["default"]);if(!O){continue;}O=mstr.utils.Hash.deepClone(O);O.parent=this;O.modelPath=H+G;N[G]=mstr.controllers.Factory.registerJSON(O,M);if(N[G]&&N[G].init){N[G].init();}}};function D(F){mstr.views.ViewListBase.apply(this,[F]);}return D;})();mstr.views.ViewStack=(function(){mstr.$O.extendsClass(F,mstr.views.ViewListBase);F.prototype.setModel=function I(L){mstr.views.ViewListBase.prototype.setModel.apply(this,[L]);if(L){L.set("stack",true);}};F.prototype.onAddSelections=function K(L){var N=L&&L.memo&&L.memo.at;var M=parseInt(mstr.$H.firstKey(N));this._showChildViewAtIndex(M);this._updateNavCommands();};F.prototype._updateNavCommands=function E(){var M;var L=this.props.model;if(L){M=L.getSelectedIndex();}if(M==null){M=-1;}this.set("CommandEnabledPreviousView",M>0);this.set("CommandEnabledNextView",M<(mstr.$A.len(this.props.views)-1));};F.prototype.onRemoveSelections=function A(L){var N=L&&L.memo&&L.memo.at;var M=parseInt(mstr.$H.firstKey(N));if(M>-1){var O=this.props.views&&this.props.views[M];mstr.controllers.Factory.safeset(O,"visible",false);}};F.prototype.render=function J(){var N=this.props.views,M=mstr.$A.len(N),Q;for(var P=0;P<M;P++){mstr.controllers.Factory.safeset(N[P],"visible",false);mstr.controllers.Factory.safeset(N[P],"renderStatus",mstr.Enum.Widget.RENDERSTATUS.NOT_STARTED);}mstr.views.BaseView.prototype.render.apply(this);var L=this.getModel();var O=L&&L.getSelectedIndex();this._showChildViewAtIndex(O);mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;};F.prototype.renderNextChildViewOld=function B(){var O=this.props.childViewPaths;if(O){var N=this.props.stackInfo={};var M;for(var L=O.length-1;L>-1;L--){M=O[L];if(M.name&&M.name.substring(0,6)=="views/"){N[M.name]=M;O.splice(L,1);}}}this.renderNextChildView=mstr.views.BaseView.prototype.renderNextChildView;this.renderNextChildView();};F.prototype.execPreviousView=function D(){var L=this.props.model;if(L){var M=L.getSelectedIndex();if(M>0){return this.execGotoView(M-1);}}return false;};F.prototype.execNextView=function G(){var L=this.props.model;if(L){var M=L.getSelectedIndex();if(M>-1){return this.execGotoView(M+1);}}return false;};F.prototype.execGotoView=function H(M){var L=this.props.model;if(L){if((M>-1)&&(M<mstr.$A.len(this.props.views))){return L.execCommand("SingleSelect",M);}}return false;};F.prototype._showChildViewAtIndex=function C(L){L=parseInt(L);if(L!=null&&L>-1){this._showChildViewAtPath("views/"+L);}};function F(L){mstr.views.ViewListBase.apply(this,[L]);this._updateNavCommands();}return F;})();mstr.views.Pulldown=(function(){mstr.$O.extendsClass(C,mstr.views.BaseView);C.prototype.render=function H(){mstr.views.BaseView.prototype.render.apply(this);if(!this.get("horizontalCaption")){var I=this.get("element");var J=I.getElementsByTagName("td");if(J.length>0){J[0].style.display="none";}}this.renderSelections();};C.prototype._attachLayoutHandlers=function G(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);var I=this.props.model;if(I&&I.attachEventListener){I.attachEventListener(this,"set_icon","set_buttonClass");I.attachEventListener(this,"set_showPressed","set_pressed");var J=this._getPropNameForSelections();if(J){I.attachEventListener(this,"hashadd_"+J,"renderSelections");I.attachEventListener(this,"hashremove_"+J,"renderSelections");}}};C.prototype.set_buttonClass=function A(I){this.set("buttonClass",I.memo.value);};C.prototype.set_pressed=function D(I){this.set("pressed",I.memo.value);};C.prototype._detachLayoutHandlers=function B(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);var I=this.props.model;if(I&&I.attachEventListener){var J=this._getPropNameForSelections();if(J){I.detachEventListener(this,"hashadd_"+J);I.detachEventListener(this,"hashremove_"+J);}}};C.prototype._getPropNameForSelections=function E(){var I=this.props.modelClass;if(/TreeModel/.test(I)){return"selections";}else{if(/ListModel/.test(I)){return"selectedIndices";}}return null;};C.prototype.renderSelections=function F(){var L=mstr.utils.ListViewHelper.getItemRenderer(this);if(!L){return ;}var I=this.props.model;var K=(this.props.popup&&(this.props.popup.singleFilterCssClass||this.props.popup.props&&this.props.popup.props.singleFilterCssClass))?(I&&I.getViewableSelectedItems&&I.getViewableSelectedItems()):(I&&I.getSelectedItems());var M=(this.props.showSingleItemListAsLabel&&(K&&mstr.$A.len(K)==1));var J;switch(mstr.$A.len(K)){case 1:J="renderListItem";break;case 0:J="renderEmpty";break;default:J="renderMultipleItems";break;}if(L[J]){L[J](this,I,this.props.element,{item:K&&K[0],items:K,showAsLabel:M});}};function C(I){mstr.views.BaseView.apply(this,[I]);}return C;})();mstr.views.FieldSet=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.onlegendFieldValueChange=function C(F){var G=this.get("element"),E=G.firstChild;if(F.memo.value){E.innerHTML=F.memo.value;}};B.prototype._attachLayoutHandlers=function D(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);mstr.views.BaseView.prototype._attachPropertiesHandlers.call(this,["legend"]);};B.prototype._detachLayoutHandlers=function A(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);mstr.views.BaseView.prototype._detachPropertiesHandlers.call(this,["legend"]);};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.ListView=(function(){mstr.$O.extendsClass(N,mstr.views.BaseView);N.prototype.render=function B(){mstr.views.BaseView.prototype.render.apply(this);var S=this.getModel();var R=mstr.$A.len(S&&S.getItems&&S.getItems());if(R){this.renderItemsAt(0,R);}this._updateEmptyMessage();mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;};N.prototype._updateEmptyMessage=function J(){var S=this.props.model,R=mstr.$A.len(S&&S.getItems&&S.getItems()),U=mstr.$A.len(S&&S.props&&S.props.prefixItems),W=this.props.descriptors,V=W&&W.searchRequiredText,T=W&&W.emptyText,X=S&&S.isElementSearchRequired&&S.isElementSearchRequired()&&!S.get("searchPattern");if(R>U||(!X&&R)){this._clearEmptyMessage();}else{msg=(X)?V:T;this.set("message",msg);}};N.prototype._clearEmptyMessage=function G(){var U=this.get("message"),T=this.props.descriptors,R=T&&T.emptyText,S=T&&T.searchRequiredText;switch(U){case R:case S:this.set("message",null);break;}};N.prototype.renderItemsAt=function P(R,Y){var g=mstr.utils.ListViewHelper.getItemRenderer(this);if(!g||!g.renderListItem){return null;}var n=this,S=this.getId(),V=this.props.model;var Z=V&&V.getItems();var T=(V&&V.getSelectedIndices())||{};var a=Math.min(R+Y,mstr.$A.len(Z));var W=this.props[mstr.$W.ELEMENT];var c=V&&V.get("valueForm"),h;for(var X=R;X<a;X++){var o=Z[X];var e=mstr.utils.ListViewHelper.getItemBrowseCommand(this,o)||"";var U=g.renderListItem(n,V,W,{at:X,item:o,browseCommand:e});if(U){if(T[X]){g.markListItemAsSelected(n,V,W,{at:X,item:o,elItem:U});}if(!("enabled" in o)||o.enabled){h=o[c];if(h==null&&o.get){h=o.get(c);}U.mstrListItemInfo=S+"/"+(h||"")+"/"+e;}}}};N.prototype._attachLayoutHandlers=function Q(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);var R=this.props.model;if(R&&R.attachEventListener){R.attachEventListener(this,"listadd_items","onAddListItems");R.attachEventListener(this,"listremove_items","onRemoveListItems");R.attachEventListener(this,"hashadd_selectedIndices","onAddSelectedIndices");R.attachEventListener(this,"hashremove_selectedIndices","onRemoveSelectedIndices");}};N.prototype._detachLayoutHandlers=function L(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);var R=this.props.model;if(R&&R.attachEventListener){R.detachEventListener(this,"listadd_items");R.detachEventListener(this,"listremove_items");R.detachEventListener(this,"hashadd_selectedIndices");R.detachEventListener(this,"hashremove_selectedIndices");}};N.prototype.onAddListItems=function K(R){var T=R.memo.start;var S=R.memo.count;if(!S||(T==null)){return ;}this._updateEmptyMessage();this.renderItemsAt(T,S);};N.prototype.onRemoveListItems=function I(Z){var X=mstr.utils.ListViewHelper.getItemRenderer(this);if(!X||!X.removeListItem){return ;}var R=Z.memo.ranges;var Y=this,S=this.props.model,W=this.props[mstr.$W.ELEMENT];for(var U=mstr.$A.len(R)-1;U>-1;U--){var V=R[U];for(var T=V.max;T>=V.min;T--){X.removeListItem(Y,S,W,{at:T});}}this._updateEmptyMessage();};N.prototype.onAddSelectedIndices=function F(R){this._toggleSelectedIndices(R.memo.at,"markListItemAsSelected");};N.prototype.onRemoveSelectedIndices=function A(R){this._toggleSelectedIndices(R.memo.at,"markListItemAsUnselected");};N.prototype._toggleSelectedIndices=function O(Y,V){if(!Y){return ;}var S=mstr.utils.ListViewHelper.getItemRenderer(this);if(!S||!S[V]){return ;}var U=this,R=this.props.model,X=this.props[mstr.$W.ELEMENT];var T=R&&R.getItems();for(var W in Y){W=parseInt(W);S[V](U,R,X,{at:W,item:T[W]});}};N.prototype.execClickListItem=function E(V){var S=this.props.model;if(!S){return false;}var U=!!this.props.multiSelect;var T=S.indexOfValue(V.valueForm);if(T>-1){var R=null;if(this.props.isCheckList){if(U){R="ToggleSelect";}else{R="SingleSelect";}}else{if(V.ctrl&&U){R="ToggleSelect";}else{if(V.shift&&U){R="RangeSelect";}else{if(V.rmc&&U){R="RMCSelect";}else{R="SingleSelect";}}}}if(this.get("validator")){this.get("validator").validate(R,T);}S.execCommand(R,T);return true;}else{if(U&&!this.props.isCheckList){S.execCommand("ClearSelect");}return false;}};N.prototype.onkeypress=function D(X,T){if(this.get("ignoreKeyStrokes")){return false;}var W=1;if(this._timerID){window.clearTimeout(this._timerID);this._timerID=null;W=0;}var S=this.getModel();if(!S){return true;}var U=mstr.utils.Events.keyChar(X,T),R=(U==String.fromCharCode(9));if(mstr.Enum.REGEXP_RESERVED_CHARS[U]){U="\\"+U;}this._selKeys+=U;S.execCommand("SelectString",this._selKeys,"n",W);var V=this;this._timerID=window.setTimeout(function(){V._selKeys="";V._timerID=null;},this._keyDelay);if(!R){mstr.utils.Events.cancel(X,T);}return R;};N.prototype.onkeydown=function H(V,S){if(this.get("ignoreKeyStrokes")){return true;}var R=this.getModel();if(!R){return true;}var U=mstr.utils.Events.keyCode(V,S),T=mstr.utils.Events.shiftKey(V,S);switch(U){case 38:this.getModel().execCommand("SelectPrevious",T);mstr.utils.Events.cancel(V,S);return false;case 40:this.getModel().execCommand("SelectNext",T);mstr.utils.Events.cancel(V,S);return false;default:return true;}};N.prototype.focus=function C(){if(!mstr.utils.ISIE4){document.getElementById(this.get("id")+"TabStop").focus();}};N.prototype.restoreFocus=function M(){if(!mstr.utils.ISIE4){document.getElementById(this.get("id")+"TabStop").focus();}else{this.props.scrollArea.focus();}};function N(R){mstr.views.BaseView.apply(this,[R]);this._selKeys="";this._timerID=null;this._keyDelay=1000;}return N;})();mstr.itemrenderers.ListView=(function(){var G={};G.renderListItem=function(H,J,L,K){var I=mstr.itemrenderers.FastListView.renderListItem(H,J,L,K);this._insertElementForIndex(H,L,K.at,I);return I;};G.markListItemAsSelected=function A(H,I,K,J){J.elItem=this._findElementForIndex(H,K,J.at);mstr.itemrenderers.FastListView.markListItemAsSelected(H,I,K,J);};G.markListItemAsUnselected=function E(H,I,K,J){J.elItem=this._findElementForIndex(H,K,J.at);mstr.itemrenderers.FastListView.markListItemAsUnselected(H,I,K,J);};G.removeListItem=function F(H,J,M,K){var I=this._findElementForIndex(H,M,K.at);var L=I&&I.parentNode;if(L){L.removeChild(I);}};G._insertElementForIndex=function B(H,M,J,K){var L=H.props.scrollArea.firstChild;var I=L.childNodes[J];if(I){L.insertBefore(K,I);}else{L.appendChild(K);}};G.on_set_leadIndex=function D(I,J,M){var L=J&&J.get("leadIndex");if(L==null||L<0){return false;}var K=this._findElementForIndex(I,M,L);if(!K){return false;}var H=I.get("scrollArea")||M.rows[0].cells[0].firstChild.childNodes[2];if(!H){return false;}mstr.utils.BoxModel.scrollToElement(H,K);};G._findElementForIndex=function C(H,J,I){return H.props.scrollArea.firstChild.childNodes[I];};return G;})();mstr.views.TextBox=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.execClearSearch=function B(){var C=this.props.element.getElementsByTagName("input");if(C&&C[0].value!=""){C[0].value="";}this.fireCommands(null,"");};function A(C){mstr.views.BaseView.apply(this,[C]);}return A;})();mstr.views.FastListView=(function(){mstr.$O.extendsClass(Q,mstr.views.ListView);Q.DEFAULT_LIST_ITEM_HEIGHT=20;Q.prototype.init=function U(){mstr.views.ListView.prototype.init.apply(this,arguments);this.set("baseHeight",this.get("height"));};Q.prototype._positionPop=function T(){var n=this.props.element;var m=n&&n.style;if(!m){return ;}m.position=mstr.utils.ISFF?"fixed":"absolute";m.display="block";var g=this.props.scrollArea;g.style.height="auto";var e=mstr.utils.BoxModel.getElementOuterHeight(n);if(mstr.utils.ISIE4&&mstr.utils.BoxModel.hasScrollbar(g,"x")){e+=SCROLLBAR_SIZE;}var c=this.get("baseHeight");if(c!="auto"){e=Math.min(e,parseInt(c))+"px";}else{e=c;}g.style.height=e;this.props.height=e;mstr.views.BaseView.prototype._positionPop.apply(this);};Q.prototype.render=function I(){mstr.views.BaseView.prototype.render.apply(this);var c=this.execLayoutHandler("scrollArea");this.props.scrollArea=c;if(c&&this.props.renderListItemsOnScroll){c.onscroll=new Function("e","return mstr.controllers.Factory.obj('"+this.getId()+"').onScroll()");}this.props.listItemsContainer=c&&c.childNodes[0];this._updateItemsContainerDimensions();this.initItems();mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;};Q.prototype.initItems=function H(){var g=this.getModel();var e=mstr.$A.len(g&&g.getItems&&g.getItems());var h=g&&g.props&&g.props.prefixItems&&g.props.prefixItems.length||0;this._updateEmptyMessage();this.props.isListItemRendered=[];if(!e){return ;}var o=this.props.renderListItemsOnScroll&&this.props.scrollArea;if(!o){this.renderItemsAt(0,e);}else{this._addIndicesToRender(0,n);var n=parseInt(this.props.initialListItemRenderCount)||0;n&&this.renderItemsAt(0,n);}var c=mstr.utils.ListViewHelper.getItemRenderer(this);if(c&&c.on_set_leadIndex){c.on_set_leadIndex(this,this.getModel(),this.props.element);}if(o){this.onScroll();}};Q.prototype.renderItemsAt=function W(g,h){var e=mstr.utils.ListViewHelper.getItemRenderer(this);if(!e){return null;}var AD=this.props.listItemsContainer;if(!AD){return null;}var AC=this._countIndicesRenderedBefore(g);var o=AD.childNodes[AC];var y=this.props.model;var x=y&&y.getItems();var z=Math.min(g+h,mstr.$A.len(x));var q={};var AA=this.props.isListItemRendered;var n=(y&&y.getSelectedIndices())||{};var u=this;var AH=this.getId();var y=this.props.model;var c=this.props[mstr.$W.ELEMENT];var AB=y&&y.get("valueForm");for(var AE=g;AE<z;AE++){var AF=x[AE];var AG=mstr.utils.ListViewHelper.getItemBrowseCommand(this,AF)||"";var c=e.renderListItem(u,y,c,{at:AE,item:AF,browseCommand:AG});if(o){AD.insertBefore(c,o);}else{AD.appendChild(c);}if(n[AE]){e.markListItemAsSelected(u,y,c,{at:AE,item:AF,elItem:c,notFocus:true});}if(!("enabled" in AF)||AF.enabled){c.mstrListItemInfo=AH+"/"+(AF[AB]||"")+"/"+AG;}AA[AE]=true;if(AE==g){q.first=c;}if(AE==z-1){q.last=c;}}return q;};Q.prototype.onAddListItems=function F(c){var h=c.memo.start;var g=c.memo.count;if(!g||(h==null)){return ;}this._updateEmptyMessage();this._updateItemsContainerDimensions();this._addIndicesToRender(h,g);var e=this.findNextRenderedIndex(h+g,false);if(e>-1){this._adjustWhiteSpaceAboveItem(e,this._getElementForItemAt(e));}this.updateScrollArea();};Q.prototype.onRemoveListItems=function D(u){this._updateItemsContainerDimensions();var n=[];mstr.$A.forEach(u.memo.ranges,function(y){n.push(mstr.$H.clone(y));});var c=this._splitRangesByRenderStatus(n);var x=this.props.isListItemRendered;var g=this.props.listItemsContainer;for(var m=mstr.$A.len(c)-1;m>-1;m--){var o=c[m];if(x[o.min]){var e=this._getElementForItemAt(o.min);for(var h=0;h<o.max-o.min;h++){g.removeChild(e.nextSibling);}g.removeChild(e);}this._removeIndicesToRender(o.min,o.max-o.min+1);var q=this.findNextRenderedIndex(o.max+1,false);if(q>-1){this._adjustWhiteSpaceAboveItem(q,this._getElementForItemAt(q));}}this.updateScrollArea();this._updateEmptyMessage();};Q.prototype._toggleSelectedIndices=function G(x,o){if(!x){return ;}var q=mstr.utils.ListViewHelper.getItemRenderer(this);if(!q){return ;}var u=this,e=this.props.model,g=this.props[mstr.$W.ELEMENT];var n=e&&e.getItems();for(var h in x){h=parseInt(h);var c=this._getElementForItemAt(h);if(c){q[o](u,e,g,{at:h,item:n[h],elItem:c});}}};Q.prototype._updateItemsContainerDimensions=function K(){this._updateItemsContainerHeight();};Q.prototype._updateItemsContainerHeight=function N(){var n=this.props.listItemsContainer;if(!n){return ;}var e=this.props.height;if(!e||e=="auto"){return ;}var o=mstr.utils.ListViewHelper.getItemRenderer(this);var g=o&&((o.listItemHeight&&o.listItemHeight(this))||(o.listItemHeightMin&&o.listItemHeightMin(this)));if(!g){g=Q.DEFAULT_LIST_ITEM_HEIGHT;}if(g){var c=this.getModel();g=g*mstr.$A.len(c&&c.getItems&&c.getItems());}if(g){n.style.height=g+"px";}else{n.style.height=mstr.utils.ISIE4?"1px":"auto";}if(mstr.utils.ISIE4){n.style.overflow=g?"visible":"hidden";}};Q.prototype._addIndicesToRender=function A(e,c){this.props.isListItemRendered=mstr.$A.insert(this.props.isListItemRendered,new Array(c),e);};Q.prototype._removeIndicesToRender=function E(e,c){this.props.isListItemRendered=mstr.$A.removeRange(this.props.isListItemRendered,e,c);};Q.prototype._countIndicesRenderedBefore=function P(c){var g=0;var h=this.props.isListItemRendered;for(var e=0;e<c;e++){if(h[e]){g++;}}return g;};Q.prototype._getElementForItemAt=function S(c){if(this.props.isListItemRendered[c]){var e=this._countIndicesRenderedBefore(c);return this.props.listItemsContainer.childNodes[e];}return null;};Q.prototype._getOrMakeElementForItemAt=function M(g){var n=this._getElementForItemAt(g);if(!n){var c=this.getModel(),e=c&&c.getItems(),o=e[g];if(o){var h=this.renderItemsAt(g,1);n=h&&h.first;if(n){this._adjustWhiteSpaceAboveItem(g,n);this._adjustWhiteSpaceBelowItem(g,n);}}}return n;};Q.prototype.onScroll=function R(){if(this.props.scrollTimeoutId){return true;}this.props.scrollTimeoutId=self.setTimeout('mstr.controllers.Factory.obj("'+this.getId()+'").updateScrollArea()',200);return true;};Q.prototype.after_set_visible=function V(c){if(this.props.visible){this.updateScrollArea();}};Q.prototype.on_win_resize=function Y(c){this._updateListContainerWidth();};Q.prototype.updateScrollArea=function C(){if(this.props.scrollTimeoutId){self.clearTimeout(this.props.scrollTimeoutId);this.props.scrollTimeoutId=null;}var n=this._computeVisibleItemsRange();if(!n){return ;}var e=this._splitRangesByRenderStatus([n]);var o=this.props.isListItemRendered;for(var h=0,c=mstr.$A.len(e);h<c;h++){var g=e[h];if(!o[g.min]){var m=this.renderItemsAt(g.min,g.max-g.min+1);if(!m||!m.first){continue;}this._adjustWhiteSpaceAboveItem(g.min,m.first);this._adjustWhiteSpaceBelowItem(g.max,m.last);}}this._updateListContainerWidth();};Q.prototype._updateListContainerWidth=function B(){if(mstr.utils.ISIE6){return ;}var c=this.props.scrollArea,e=c&&c.firstChild;if(e.style.width!=(c.scrollWidth+"px")&&mstr.utils.BoxModel.hasScrollbar(c,"x")){window.setTimeout(function(){e.style.width=c.scrollWidth+"px";},0);}};Q.prototype.execResetScrollArea=function O(){var c=this.props.scrollArea;if(mstr.utils.ISFF){c.scrollTop=0;}};Q.prototype._adjustWhiteSpaceAboveItem=function X(e,n){if(!n){return ;}var o=mstr.utils.ListViewHelper.getItemRenderer(this);var m=o&&((o.listItemHeight&&o.listItemHeight(this))||(o.listItemHeightMin&&o.listItemHeightMin(this)));if(!m){m=Q.DEFAULT_LIST_ITEM_HEIGHT;}if(!m){return ;}var g=this.findNextRenderedIndex(e-1,true);var c=e-g-1;n.style.marginTop=(c*m)+"px";};Q.prototype._adjustWhiteSpaceBelowItem=function L(e,m){var n=mstr.utils.ListViewHelper.getItemRenderer(this);var g=n&&((n.listItemHeight&&n.listItemHeight(this))||(n.listItemHeightMin&&n.listItemHeightMin(this)));if(!g){g=Q.DEFAULT_LIST_ITEM_HEIGHT;}if(!g){return ;}var q=this.findNextRenderedIndex(e+1,false);if(q>-1){var o=q-e-1;var c=m.nextSibling;if(c){c.style.marginTop=(o*g)+"px";if(mstr.utils.ISIE8){c.style.display="none";window.setTimeout(function(){c.style.display="block";},0);}}}};Q.prototype._computeVisibleItemsRange=function a(){var c=this.props,g=c.scrollArea,u=c.height;if(u&&u.match(/px$/)||(u==String(parseInt(u)))){u=parseInt(u);}else{if(u&&(u!="auto")&&!u.match(/\%$/)){u=g&&g.clientHeight;if(!u&&g&&g.style){u=g.style.height;u=(u.match(/px$/)||(u==String(parseInt(u))))?parseInt(u):"auto";}}else{u="auto";}}if(!u||isNaN(u)){var n=this.props.model,x=n&&n.props&&n.props.items;return{min:0,max:x&&x.length||0};}var o,z;var e=mstr.utils.ListViewHelper.getItemRenderer(this);if(e&&e.listItemHeight){o=z=e.listItemHeight(this);}else{o=(e&&e.listItemHeightMin&&e.listItemHeightMin(this))||Q.DEFAULT_LIST_ITEM_HEIGHT;z=(e&&e.listItemHeightMax&&e.listItemHeightMax(this))||Q.DEFAULT_LIST_ITEM_HEIGHT;}if(o){var y=g.scrollTop;var q={min:parseInt(y/z),max:parseInt((y+u)/o)+1};return q;}return null;};Q.prototype._splitRangesByRenderStatus=function J(g){var q=this.props.isListItemRendered;var e=mstr.$A.len(g);var o=0;while(o<e){var h=g[o];var c=q[h.min];for(var n=h.min+1;n<=h.max;n++){if(q[n]!=c){var m={min:n,max:h.max};h.max=n-1;g=mstr.$A.insert(g,m,o+1);e++;break;}}o++;}return g;};Q.prototype.findNextRenderedIndex=function Z(m,g){var h=this.props.isListItemRendered;if(g){for(var e=m;e>-1;e--){if(h[e]){return e;}}}else{var c=mstr.$A.len(h);for(var e=m;e<c;e++){if(h[e]){return e;}}}return -1;};function Q(c){mstr.views.ListView.apply(this,[c]);this.props.isListItemRendered=[];}return Q;})();mstr.views.FloatingEditor=(function(){mstr.$O.extendsClass(G,mstr.views.BaseView);G.prototype.before_set_visible=function C(L){if(L.memo.value&&this.get("reloadCmds")){this.fireCommands(this.get("reloadCmds"),"");}};G.prototype.execResetValidationStatus=function E(){mstr.views.BaseView.prototype.execResetValidationStatus.apply(this,arguments);if(!this.childValidationStatus){return ;}for(var L in this.childValidationStatus){mstr.$obj(L).execResetValidationStatus();}};G.prototype.after_set_childValidationStatus=function J(M){var L=M.memo;this.childValidationStatus=this.childValidationStatus||{};if(L.code==mstr.Enum.Validation.STATUSCODE.VALID){if(L.id in this.childValidationStatus){delete this.childValidationStatus[L.id];if(mstr.utils.Hash.isEmpty(this.childValidationStatus)){this.set("validationStatus",mstr.Enum.Validation.STATUSCODE.VALID);this.set("message","");this.set("CommandEnabledCheckValidationStatus",true);var N=this.getModel()&&this.getModel().disableModelFromView&&this.getModel().disableModelFromView(false);}}}else{if(mstr.utils.Hash.isEmpty(this.childValidationStatus)){this.set("validationStatus",mstr.Enum.Validation.STATUSCODE.INVALID_ANSWERS);this.set("message",this.props.descriptors.ALERT);this.set("CommandEnabledCheckValidationStatus",false);var O=this.getModel()&&this.getModel().disableModelFromView&&this.getModel().disableModelFromView(true);}this.childValidationStatus[L.id]=L.code;}};G.prototype.after_set_message=function I(N){var P=this.get("element").firstChild.rows[1].cells[0].firstChild;var O=P.firstChild;var M=N.memo.value;if(M){P.style.visibility="hidden";P.style.position="absolute";O.innerHTML=M;P.style.height="auto";var L=function(){var Q=mstr.utils.BoxModel.getElementInnerHeight(P);P.style.height=0;P.style.position="static";P.style.visibility="visible";mstr.utils.Animations.resize(P,null,Q,3,null);};window.setTimeout(L,0);}else{mstr.utils.Animations.resize(P,null,0,3,function(){O.innerHTML="";});}};G.prototype.after_set_opener=function A(M){var Q=this.get("cmdButtons")||[];for(var O=0,N=Q.length;O<N;O++){var L=Q[O]&&Q[O]._refreshCommandHandlers&&Q[O]._refreshCommandHandlers();}var P=this.get("modelPath");if(P&&P.substr(0,6)=="opener"){this.initModel();this._refreshChildViewModels(true);}};G.prototype.render=function F(){mstr.views.BaseView.prototype.render.apply(this);var M=this.props[mstr.$W.ELEMENT];if(this.get("moveToBody")&&mstr.utils.ISIE9&&M.parentNode!=document.body){this.props[mstr.$W.ELEMENT]=document.body.appendChild(M);}var O=M.firstChild;var Q=null;this.set("titleBar",this.execLayoutHandler("titleBar"));if(this.get("isModal")){var L=mstr.utils.Dom.findPositionedAncestor(M);var P=mstr.utils.BoxModel.computeDistanceFromAncestor(L);var N=mstr.utils.BoxModel.getBrowserWindowRect(M.ownerDocument);M.style.top=(N.top-P.offsetY)+"px";M.style.left=(N.left-P.offsetX)+"px";M.style.width=N.width+"px";M.style.height=N.height+"px";M.style.backgroundRepeat="repeat";mstr.utils.Dom.setBGIconClass(M,"1ptrans");Q=O;if(this.left){Q.style.left=this.left;Q.style.top=this.top;}else{mstr.utils.BoxModel.centerElementOnObject(M,Q);this.left=Q.style.left;this.top=Q.style.top;}}else{M.style.height="auto";M.style.width="auto";M.style.background="transparent";Q=M;mstr.utils.BoxModel.centerElementOnObject(document.body,Q);}O.style.visibility="visible";mstr.utils.Dom.insertPopupMask(Q,M,Q.style.left,Q.style.top);if(this.get("loadCmds")){this.fireCommands(this.get("loadCmds"),"");}};G.prototype.getHelpLink=function B(){if(this.get("helpTopic")&&this.get("helpTopic")&&this.get("helpPath")){var L=this.get("helpPath");return L+(L.lastIndexOf("#")===L.length-1?"":"#")+this.get("helpTopic");}return this.get("helpPath");};G.prototype.execShowHelp=function K(L){window.open(L);};G.prototype.execSetModel=function H(L){this.setModel(L);};G.prototype.execCheckValidationStatus=function D(){return !(this.get("validationStatus")>mstr.Enum.Validation.STATUSCODE.VALID);};function G(L){mstr.views.BaseView.apply(this,[L]);if(!this.get("isDraggable")){return ;}this.set("dz",new mstr.models.dnd.DragZone({view:this},{findTarget:function(M,O){var N=M.get("element");var P=mstr.utils.Dom.findAncestor(O.target(),"className","mstrFloatingEditorTitle");return(P&&P==M.get("titleBar"))?P:null;},getDragData:function(M,O){var P=document.createElement("div");P.style.border="2px solid #9e9e9e";var N=M.get("element").firstChild;P.style.height=mstr.utils.BoxModel.getElementOuterHeight(N)+"px";P.style.width=mstr.utils.BoxModel.getElementOuterWidth(N)+"px";return{ddel:P};},endDrag:function(N,M,P){M=Math.max(0,M);P=Math.max(0,P);var O=N.get("element");if(N.get("isModal")){P-=mstr.utils.BoxModel.getElementSumOffsetTop(O);O.firstChild.style.left=M+"px";O.firstChild.style.top=P+"px";if(O.firstChild!=O.lastChild&&O.lastChild.className!=="mstrCurtain"){O.lastChild.style.left=M+"px";O.lastChild.style.top=P+"px";}}else{O.style.left=M+"px";O.style.top=P+"px";}}}));}return G;})();mstr.views.JoinBehaviorTable=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.init=function E(){mstr.views.BaseView.prototype.init.apply(this);};A.prototype.render=function C(){var I="mstrDG",G=this,F=G.getModel(),H=function(){var J=G.buildDGItems(G.getModel().get(G.get("valueField"))),K=false;G.dgWidget=mstrmojo.insert({scriptClass:"mstrmojo.DataGrid",placeholder:G.props.element,cssClass:"jointype",columns:[{headerText:mstrmojo.desc(5467,"Objects"),dataField:"mn",headerCss:"jointype-hd",tooltip:true,itemTooltipField:"tf",itemCSSField:"itemCss",colWidth:160},{headerText:mstrmojo.desc(13176,"Join Type"),headerCss:"jointype-hd",dataWidget:{scriptClass:"mstrmojo.Pulldown",popupToBody:true,itemIdField:"v",itemTitleField:"title",popupZIndex:999,items:[{n:mstrmojo.desc(959,"Default"),v:"dft",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(13177,"Inner Join"),v:"0",title:mstrmojo.desc(13178,"Results displaying only those attribute elements that have metric value")},{n:mstrmojo.desc(13179,"Outer Join - Ignore Filter"),v:"2",title:mstrmojo.desc(13180,"Outer join to attribute's look up table without considering the filter on template")},{n:mstrmojo.desc(13181,"Outer Join - Preserve Filter"),v:"3",title:mstrmojo.desc(13182,"Outer join to attribute's look up table after considering the filter on template")}],onvalueChange:function(){if(!F.translating&&K){F.joinTypeChange(this.data.id,this.value);}},postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var L=this.data;this.set("value",L[this.itemIdField]);}},mstrmojo.hash.copy(this.markupMethods));if(this.data&&this.data.id!=="allAttrs"){this.items=[{n:mstrmojo.desc(959,"Default"),v:"dft",title:mstrmojo.desc(959,"Default")},{n:mstrmojo.desc(13177,"Inner Join"),v:"0",title:mstrmojo.desc(13178,"Results displaying only those attribute elements that have metric value")},{n:mstrmojo.desc(13183,"Outer Join"),v:"1",title:mstrmojo.desc(13184,"Outer join to attributes look up table")}];}}}}],items:J});G.dgWidget.render();K=true;};G.initModel();F.attachEventListener(this,"set_"+G.get("valueField"),"onUpdateDataGrid");if(!window.mstrmojo){microstrategy.mojoLoader.loadWidget({scriptClass:"DataGrid",id:I,bundle:"mojo-sle.js",callback:function(){microstrategy.mojoLoader.loadWidget({scriptClass:"Pulldown",id:I,bundle:"mojo-coreui.js",callback:H});}});}else{H();}};A.prototype.onUpdateDataGrid=function B(F){if(this.dgWidget){this.dgWidget.set("items",this.buildDGItems(F.memo.value));}};A.prototype.buildDGItems=function D(G){var F=[];mstr.$A.forEach(G,function(H){F.push({mn:H.alias,id:H.dssId,v:H.jt,n:H.n,tf:H.alias,itemCss:H.ic});});return F;};function A(F){mstr.views.BaseView.apply(this,[F]);}return A;})();mstrObserverImpl.prototype=new Object();mstrObserverImpl.prototype.items=null;mstrObserverImpl.prototype.onload=function(){if(microstrategy.observerItems){this.items=microstrategy.observerItems;microstrategy.observerItems=null;}};mstrObserverImpl.prototype.onunload=function(){microstrategy.observerItems=this.items;};mstrObserverImpl.prototype.register=function(A){if(typeof (this.items[A])=="undefined"){this.items[A]=A;}return true;};mstrObserverImpl.prototype.unregister=function(A){if(typeof (this.items[A])!="undefined"){delete this.items[A];}return true;};mstrObserverImpl.prototype.notifyAll=function(A,D){try{for(var E in this.items){var C=mstr.$obj(E);if(C&&A in C){C[A](D);}}return true;}catch(B){microstrategy.errors.log(B);return false;}};function mstrObserverImpl(A){this.items=new Object();return this;}mstrViewerCommandsImpl.prototype=new Object();mstrViewerCommandsImpl.prototype.itemSep="~";mstrViewerCommandsImpl.prototype.unitSep="\u001F";mstrViewerCommandsImpl.prototype.clipboardItemSep="\u001E";mstrViewerCommandsImpl.prototype.valueField="dssid";mstrViewerCommandsImpl.prototype.nameField="n";mstrViewerCommandsImpl.prototype.typeField="t";mstrViewerCommandsImpl.prototype.exec=function(K,H,n){try{var e=microstrategy.updateManager;switch(K){case"ping":return this.execPingServer();case"undo":return e.undo();case"redo":return e.redo();case"doFlush":e.add([e.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return e.flushAndSubmitChanges();case"IVEMode":if(microstrategy.pageScreenMode!=microstrategy.PAGE_FULL_SCREEN_MODE){toggleScreenMode();}case"interactiveViewMode":case"editableMode":case"flashViewMode":var g={interactiveViewMode:microstrategy.RW_VIEW_MODE_INTERACTIVE,editableMode:microstrategy.RW_VIEW_MODE_EDITABLE,flashViewMode:microstrategy.RW_VIEW_MODE_FLASH,IVEMode:microstrategy.RW_VIEW_MODE_VIEWANALYSIS};H=g[K];case"rwCurrentViewMode":e.add([e.createActionObject(null,mstrUpdateManager.SET_CURRENT_VIEW_MODE,this.parentBone.beanPath,["55004"],[H],[])],true);e.useIframe=false;e.flushAndSubmitChanges();return true;case"staticViewMode":case"publishViewMode":var I=this.parentBone.visualizationMode;var Q=this.parentBone.currentRWViewMode;if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){var Y=microstrategy.RW_VIEW_MODE_STATIC|microstrategy.RW_VIEW_MODE_INTERACTIVE|microstrategy.RW_VIEW_MODE_FLASH;if(Q&Y){I="0";}}if(this.parentBone.isLayoutLevelVis){I="0";}e.add([e.createActionObject(null,mstrUpdateManager.RUN_RW_DOCUMENT,microstrategy.servletName,["2048174","2048002","2048109"],["1",this.parentBone.messageID,I],[])],true);if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){Q=0;}e.replaceURL("prevViewMedia",Q);e.useIframe=false;e.flushAndSubmitChanges();return true;case"designViewMode":case"convertToDoc":H=1;if(K=="convertToDoc"){this.showMessageForIVE("rwChangeDesignMode",H,n);return true;}case"rwChangeDesignMode":e.add([e.createActionObject(null,mstrUpdateManager.CHANGE_DESIGN_MODE,this.parentBone.beanPath,["3017"],[H],[])],true);e.useIframe=false;e.flushAndSubmitChanges();return true;case"docVisualizationModeAJAX":return this.exec("docVisualizationMode",51);case"docVisualizationModeFlash":return this.exec("docVisualizationMode",50);case"docVisualizationMode":e.useIframe=false;microstrategy.adjustSelectedVisualization(this.parentBone,H);var Q=(this.parentBone.visualizationMode==H)?"0":H;e.add([e.createActionObject(this.elem,mstrUpdateManager.SET_VISUALIZATION_MODE,this.parentBone.beanPath,["2048109","2048212"],[Q,this.parentBone.isLayoutLevelVis?"-1":""],[],[])]);e.add([e.createActionObject(this.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[])]);e.flushAndSubmitChanges();this.parentBone.isVisualization=(Q>=microstrategy.FIRST_VISUALIZATION_VIEW_MODE);this.parentBone.visualizationMode=Q;return true;case"ZoomType":var X=mstrFormatObject;var AC=X.getPropertySetName(K)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(K)+mstrUpdateManager.UNIT_SEPARATOR+H+mstrUpdateManager.ITEM_SEPARATOR;e.add([e.createActionObject(null,mstrUpdateManager.SET_DOCUMENT_ZOOM,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,AC],[])]);return true;case"zoom":var J=H,O,q=this.queryState("rwCurrentViewMode"),V=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&(q==microstrategy.RW_VIEW_MODE_FLASH||q==microstrategy.RW_VIEW_MODE_VIEWANALYSIS)),Q=this.parentBone.isVisualization;if(J=="Width"){if(!V||Q){J=this.queryState("widthZoomFactor");}O=microstrategy.ZOOM_FIT_WIDTH;}else{if(J=="Page"){if(!V||Q){J=Math.min(this.queryState("heightZoomFactor"),this.queryState("widthZoomFactor"));}O=microstrategy.ZOOM_FIT_PAGE;}else{O=microstrategy.ZOOM_STATIC;}}if(J!=microstrategy.ZOOM_FACTOR||O!=microstrategy.zoomType){microstrategy.ZOOM_FACTOR=J;microstrategy.zoomType=O;this.exec("ZoomType",O);var a=false;if(V&&!Q){microstrategy.getViewerBone().callFlashPlayerFn("changeZoomType",[J,O]);if(O==microstrategy.ZOOM_STATIC){a=true;}}else{a=true;}if(a){J=J/100;var X=mstrFormatObject;var AC=X.getPropertySetName(K)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(K)+mstrUpdateManager.UNIT_SEPARATOR+X.encodeValue(K,J)+mstrUpdateManager.ITEM_SEPARATOR;if(!V||Q){e.add([e.createActionObject(null,mstrUpdateManager.RW_GRAPH_DZ_SET_ZOOMFACTOR,this.parentBone.gdzBeanPath,["121002"],[microstrategy.ZOOM_FACTOR],[])]);}e.add([e.createActionObject(null,mstrUpdateManager.SET_DOCUMENT_ZOOM,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,AC],[])]);if(Q){e.useIframe=false;}if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.queryState("rwCurrentViewMode")!=microstrategy.RW_VIEW_MODE_FLASH||Q){e.flushAndSubmitChanges();}}}if(!V){this.parentBone.onselectionchange();}return true;case"showBean":this.showBean(e,H);return true;case"sendNow":this.exec("showBean","ncSendNow",n);return true;case"scheduleHL":this.exec("showBean","subs",n);return true;case"mobileSubs":case"ncSubs":case"ncFileSubs":case"ncFtpSubs":case"ncPrintSubs":case"ncCacheSubs":this.exec("showBean",K,n);return true;case"save":var AF=document.getElementById("askBeforeSaveCheckbox");if(AF&&AF.checked&&this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES)){this.exec("forceSaveAs");}var L=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"true":"false";var C=(this.parentBone.saveFolderId)?this.parentBone.saveFolderId:this.parentBone.parentFolderID;var o=["3013","3014","3017"];var AG=["false",C,L];if(H&&H.origin){o.push("3031");AG.push(H.origin);}var D=e.createActionObject(null,mstrUpdateManager.RW_SAVE_AS,microstrategy.servletName,o,AG,[],null);e.useIframe=false;e.add([D],true);e.flushAndSubmitChanges();return true;case"dSave":var z=this.parentBone.saveFolderId,U=this.parentBone.parentFolderID;if(z||this.isNew(U)||this.parentBone.isRWReadonly){return this.exec("save",K,n);}else{if(this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES)){this.askBeforeSaveOverwrite();}else{this.submitSave();}return true;}case"dontAskAgain":var F=0;this.parentBone.setFeature("ask-before-save-changes",0);var D=e.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.beanPath,["5003","5004"],["askBeforeSaveChanges",F],[],null);e.add([D],true);e.flushAndSubmitChanges();return true;case"forceSaveAs":var F=2;this.parentBone.setFeature(microstrategy.FEATURE_FORCE_SAVE_AS,0);var D=e.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.beanPath,["5003","5004"],["askBeforeSaveChanges",F],[],null);e.add([D],true);e.flushAndSubmitChanges();return true;case"reprompt":this.refreshViewer(e,true,false,false);return true;case"refresh":this.refreshViewer(e,false,false,false);return true;case"rerun":this.refreshViewer(e,false,true,false);return true;case"regenerate":this.refreshViewer(e,false,false,true);return true;case"browseParent":var T=this.parentBone,u=["1001"],o=[T.parentFolderID];if(T.goBackOverride){this.exec("openPage","-1");return true;}else{if(!T.parentFolderID||T.isParentFolderHidden){return this.exec("openHome");}}if(T.sysFolderId){u.push("2023");o.push(T.sysFolderId);}var D=e.createActionObject(null,mstrUpdateManager.BROWSE_FOLDER,microstrategy.servletName,u,o,[],null);e.useIframe=false;e.add([D],true);e.flushAndSubmitChanges();return true;case"openDefaultHome":case"openHome":var m={openHome:mstrUpdateManager.OPEN_DESKTOP,openDefaultHome:mstrUpdateManager.OPEN_DEFAULT_DESKTOP}[K];var D=e.createActionObject(null,m,microstrategy.servletName,[],[],[],null);e.useIframe=false;e.add([D],true);e.flushAndSubmitChanges();return true;case"restoreScreenMode":var D=e.createActionObject(null,mstrUpdateManager.SWITCH_FULL_SCREEN_MODE,this.parentBone.beanPath,["5028"],[H],[],null);e.useIframe=false;e.add([D],true);e.flushAndSubmitChanges();return true;case"saveToInbox":this.parentBone.sentToInbox=true;var D=e.createActionObject(null,mstrUpdateManager.RW_SAVE_TO_INBOX,this.parentBone.beanPath,[],[],[],null);e.add([D],true);e.flushAndSubmitChanges();return true;case"docDetails":e.add([e.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);var D=e.createActionObject(null,mstrUpdateManager.RW_DOC_DETAILS,microstrategy.servletName,["3010","3016"],[this.parentBone.messageID,"0"],[],null);e.useIframe=false;e.add([D],true);e.flushAndSubmitChanges();return true;case"setPreference":var D=e.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.beanPath,["5003","5004"],[H.prefName,H.prefValue],[],null);e.useIframe=false;e.add([D],true);e.flushAndSubmitChanges();return true;case"toggleConditionalFormatting":var D=e.createActionObject(this.elem,mstrUpdateManager.TOGGLE_DOC_THRESHOLDS,this.parentBone.beanPath,[],[],[],[]);e.add([D],true);e.flushAndSubmitChanges();return true;case"datasetObjPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_DATASET_PANEL);return true;case"relatedReportsPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_RELATED_RP_PANEL);return true;case"notesPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_NOTES_PANEL);return true;case"outlinePanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_OUTLINE_PANEL);return true;case"newRW":var D=e.createActionObject(this.elem,mstrUpdateManager.CREATE_NEW_DOCUMENT,microstrategy.servletName,[],[],[],[]);e.useIframe=false;e.add([D],true);e.flushAndSubmitChanges();return true;case"browseParent":case"openHome":return true;case"toggleScreenMode":toggleScreenMode();return true;case"exportExcel":return this.exec("export",4);case"exportHtml":return this.exec("export",-1);case"exportFlash":return this.exec("export",7);case"printPDF":return this.exec("export",3);case"export":if(H==7&&this.parentBone.hasUCSelectors){showMessage({contents:microstrategy.descriptors.getDescriptor("7482"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"mstr.$obj('"+this.parentBone.id+"').commands.exec('trueExport',"+H+");",type:mstrMsgBoxImpl.MSG_WARNING});}else{return this.exec("trueExport",H);}return true;case"trueExport":var A=this.parentBone.isFeatureAvailable("export-new-window")?"_blank":"mstrExportWindow";exportRW(H,A);case"proxyForGridObservers":if(this.parentBone.observer){this.parentBone.observer.notifyAll(H);}return true;case"toggleFlashGrouping":this.parentBone.toggleGrouping();return true;case"IVEHelp":window.open(this.parentBone.helpPath+"#about_interactive_visual_data_exploration.htm","_blank");return true;case"close":if(mstrApp.pathInfo.nb[1].href==="#"||mstrApp.isHomePage){return this.exec(mstrApp.preferences.startPage=="3187"?"openDefaultHome":"openHome");}H="-1";case"openPage":e.useIframe=false;var x=new Array();x.push(e.createActionObject(this.elem,mstrUpdateManager.OPEN_HISTORY_PAGE,microstrategy.servletName+"."+microstrategy.pageName,["3140"],[H]));e.add(x,true);e.flushAndSubmitChanges();return true;case"setUnsetFalse":H;var AE=this.parentBone.formattingAttributes[H];if(AE){AE.isUs=false;}return true;case"createPersonalView":this.exec("showBean","pvsubs",n);return true;case"ShowSharingEditor":var T=this.parentBone,Z=microstrategy.getViewerBone().isDocBlank||microstrategy.getViewerBone().isBlankAnalysis,h={success:function(){var AI=T.stateID,AJ="sharingEditor",c=window.mstrmojo&&mstrmojo.all[AJ];microstrategy.showSharingEditor(null,{lastState:AI},true);},failure:function(){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){}},R=microstrategy.updateManager;if(Z){showMessage({contents:microstrategy.descriptors.getDescriptor("14121"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"mstr.$obj('"+this.parentBone.id+"').commands.exec('save', {origin:"+microstrategy.SAVE_AS_SHARE_EDITOR+"});",buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("118")},type:mstrMsgBoxImpl.MSG_WARNING});}else{if(R.newActions){R.add([R.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[],null)]);R.flushAndSubmitChanges(false,h);}else{h.success();}}return true;}if(!this.parentBone.doc){return ;}switch(K){case"rulers":return this.parentBone.toggleRuler();break;case"grid":return this.parentBone.toggleGrid();break;case"divider":return this.parentBone.toggleDivider();break;case"unloadDocViewer":if(this.parentBone.doc.selections){this.parentBone.doc.selections.clear();}microstrategy.unregisterGridBones();window.setTimeout("microstrategy.unRegisterBone('"+this.parentBone.id+"')",0);break;case"activeTab":if(H!=this.parentBone.currentLayout){var e=this.parentBone.updateManager;e.add([e.createActionObject(null,mstrUpdateManager.SET_CURRENT_LAYOUT,this.parentBone.beanPath,["2048007"],[H],[])]);this.exec("unloadDocViewer");e.flushAndSubmitChanges();}break;case"moveTab":var e=this.parentBone.updateManager;var AH=["2048007"];var AG=[H[0]];if(H[1]){AH.push("2048036");AG.push(H[1]);}e.add([e.createActionObject(null,mstrUpdateManager.MOVE_LAYOUT,this.parentBone.beanPath,AH,AG,[])],true);break;case"addTab":case"addNewLayout":case"addExistingLayout":var B={};if(K=="addNewLayout"||K=="addTab"){B["tabList/selectedIndicesList"]=0;}else{if(K=="addExistingLayout"){B["tabList/selectedIndicesList"]=2;}}microstrategy.openFolderBasedBlockEditor("insertLayoutEditor","InsertLayoutEditorBlockLoader",{folderID:"FCA4BAFE4AF0D00088028989D7497A4F",typeRestriction:"14081"},B);break;case"removeTab":showMessage({contents:microstrategy.descriptors.getDescriptor("4360"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.parentBone.id+"').commands.exec('confirmRemoveTab', "+((H)?"'"+H+"'":"null")+");",type:mstrMsgBoxImpl.MSG_WARNING,title:microstrategy.descriptors.getDescriptor("5678")+": "+this.parentBone.currentLayoutName});break;case"confirmRemoveTab":var e=this.parentBone.updateManager;var N=(H)?H:this.parentBone.currentLayout;var E=this.parentBone.BeforeLayoutItems;var y=this.parentBone.BeforeLayout;for(var AA=0;AA<E.length;AA++){var W=E[AA];if(W.key==N){if(W.dssid==y&&E[AA+1]){this.parentBone.BeforeLayout=E[AA+1]["dssid"];}E.splice(AA,1);break;}}var G=N==this.parentBone.currentLayout;e.add([e.createActionObject(null,mstrUpdateManager.REMOVE_LAYOUT,this.parentBone.beanPath,["2048007","2048176"],[N,G],[])],true);if(G){e.flushAndSubmitChanges();}else{this.parentBone.observer.notifyAll("onDeleteLayoutTab");}break;case"TabName":var X=mstrFormatObject;var S="name";var e=this.parentBone.updateManager;var AC=this.parentBone.currentLayout+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertySetName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.encodeValue(S,H.value)+mstrUpdateManager.ITEM_SEPARATOR;e.add(e.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,AC],[]));break;case"tabMPHF":var X=mstrFormatObject;var S="TabMPHF";var e=this.parentBone.updateManager;e.add(e.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,this.parentBone.currentLayout+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertySetName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.encodeValue(S,H.value)+mstrUpdateManager.ITEM_SEPARATOR],[]));break;case"VisibleSections":var X=mstrFormatObject;var S="visibility";var e=this.parentBone.updateManager;var AC=H.obj.id+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertySetName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(S)+mstrUpdateManager.UNIT_SEPARATOR+H.value+mstrUpdateManager.ITEM_SEPARATOR;e.add(e.createActionObject(H.obj,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,AC],[]));break;case"formatMultiLevelBulk":for(var AA=H.length-1;AA>=0;AA--){var P=H[AA].split("|");if(P[0]==microstrategy.FORMAT_LEVEL_FLAG_VIEWER){var AD=H.splice(AA,1)[0];this.exec(P[1],P[2]);}}if(H.length>0){this.parentBone.doc.commands.exec(K,H);}break;case"MultiLevelPropertyChanges":for(var AA=H.length-1;AA>=0;AA--){if(H[AA].level==microstrategy.FORMAT_LEVEL_FLAG_VIEWER){var M=H.splice(AA,1)[0];this.exec(M.cmdId,M);}}if(H.length>0){this.parentBone.doc.commands.exec(K,H);}break;default:return this.parentBone.doc.commands.exec(K,H,n);break;}return true;}catch(AB){microstrategy.errors.log(AB);return false;}};mstrViewerCommandsImpl.prototype.askBeforeSaveOverwrite=function(){try{var C=microstrategy.descriptors.getDescriptor("11165").replace(/##/,"<b>"+encode(this.parentBone.objectName)+"</b>");var A="<label for='askBeforeSaveCheckbox' id='glabel'> "+microstrategy.descriptors.getDescriptor("211")+" </label>";var D="<input name='askBeforeSave' id='askBeforeSaveCheckbox' type='checkbox'/> ";showMessage({contents:"<div style='overflow:auto'>"+C+"</div><br/><br/><div style='overflow:auto' text-align:center>"+D+A+"</div>",elements:microstrategy.OK_BUTTON+microstrategy.APPLY_BUTTON+microstrategy.CANCEL_BUTTON,applyEval:"microstrategy.bones['"+this.parentBone.id+"'].commands.submitSave()",okEval:"microstrategy.bones['"+this.parentBone.id+"'].commands.exec('save')",buttonLabels:{Apply:microstrategy.descriptors.getDescriptor("219"),Ok:microstrategy.descriptors.getDescriptor("218")},title:microstrategy.descriptors.getDescriptor("5728"),type:mstrMsgBoxImpl.MSG_TEXT_ONLY});}catch(B){microstrategy.errors.log(B);}};mstrViewerCommandsImpl.prototype.submitSave=function(){try{var C=document.getElementById("askBeforeSaveCheckbox");if(C&&C.checked&&this.parentBone.isFeatureAvailable("ask-before-save-changes")){this.exec("dontAskAgain");}var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[],null)]);A.add([A.createActionObject(null,mstrUpdateManager.SAVE_OBJECT,this.parentBone.beanPath,["89001"],["0"],[],null)]);A.flushAndSubmitChanges();}catch(B){microstrategy.errors.log(B);}};mstrViewerCommandsImpl.prototype.isNew=function(A){return(A=="6C87013036D94E65B9FD227CF919327E"||A=="FCA4BAFE4AF0D00088028989D7497A4F"||A=="C1EDA6CB4A7933A0C0B3AF92EEBBFC2E");};mstrViewerCommandsImpl.prototype.showMessageForIVE=function(A,F,B){var E=typeof (A)=="string"?"'"+A+"'":A,D=typeof (F)=="string"?"'"+F+"'":F,C=typeof (B)=="string"?"'"+B+"'":B;showMessage({contents:microstrategy.descriptors.getDescriptor("8127"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bones['"+this.parentBone.id+"'].commands.askedForIVE = true; microstrategy.bones['"+this.parentBone.id+"'].commands.exec("+E+","+D+","+C+");",type:mstrMsgBoxImpl.MSG_WARNING});if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}};mstrViewerCommandsImpl.prototype.refreshViewer=function(B,A,D,C){var E=B.createActionObject(null,mstrUpdateManager.RW_REFRESH,this.parentBone.beanPath,["2048059","2048060","2048143"],[A,D,C],[],null);B.useIframe=false;B.add([E],true);B.flushAndSubmitChanges();};mstrViewerCommandsImpl.prototype.showBean=function(A,C){var B=A.createActionObject(null,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],[true,C],[],null);A.add([B],true);A.flushAndSubmitChanges();return true;};mstrViewerCommandsImpl.prototype.queryEnabled=function(P,J){try{var K=microstrategy.updateManager;switch(P){case"redoq":return K.anyNonStatic(true);break;case"undoq":return K.anyNonStatic(false);break;case"doFlush":return K.hasChangesToSubmit();break;case"IVEMode":case"designViewMode":case"convertToDoc":case"staticViewMode":case"publishViewMode":case"interactiveViewMode":case"editableMode":case"flashViewMode":case"export":case"printPDF":case"exportExcel":case"exportHtml":case"exportFlash":case"exportPDF":case"save":case"dSave":case"newRW":case"datasetObjPanel":case"relatedReportsPanel":case"outlinePanel":case"notesPanel":case"groupBy":case"zoom":case"grid":case"rwCurrentViewMode":case"rwChangeDesignMode":case"activeTab":case"moveTab":case"addTab":case"TabName":case"tabMPHF":case"addNewLayout":case"addExistingLayout":case"toggleScreenMode":case"openHome":case"sendNow":case"scheduleHL":case"mobileSubs":case"ncSubs":case"ncFileSubs":case"ncCacheSubs":case"ncFtpSubs":case"ncPrintSubs":case"createPersonalView":case"ShowSharingEditor":case"docVisualizationModeFlash":case"docVisualizationModeAJAX":case"toggleFlashGrouping":case"docDetails":case"hasMultipleLayouts":case"close":case"IVEHelp":case"canBeScheduled":case"canBeSubscribed":case"selectedUsers":case"userSubscribeRights":return true;break;case"browseParent":return !this.parentBone.isBlankAnalysis;case"removeTab":return this.queryState("hasMultipleLayouts");break;case"docVisualizationMode":return this.parentBone.visualizationsEnabled;case"refresh":return true;case"reprompt":return this.parentBone.isFeatureAvailable("enable-reprompt");case"rerun":case"regenerate":return this.parentBone.isFeatureAvailable("enable-reexecute");case"toggleConditionalFormatting":return this.parentBone.isFeatureAvailable("rw-document-has-thresholds");case"saveToInbox":var L=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE||!this.parentBone.sentToInbox;return mstr.behaviors.featureResolver.featAvailable("enable-add-history-list")&&L;case"createCalculationCM":case"customGroupCM":var A=this.parentBone.doc.selections.getSelectedGrid();var I=microstrategy.findBone(A);if(!(I&&I.selections&&I.selections.singleAttributeElementsAreSelected()&&I.selections.getSelectedGridTarget)){return false;}var G="";var C="";var N=null;var H="";var E="";var D=I.selections.getSelectedGridTarget();if(D&&D.length>0){var O=D.split(",");if(O!=null&&O.length>=2){E=O[0];G=O[1];C=O[2];N=I.gridStructureInfo.getUnit(E,G,C);if(N!=null){if(N.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){N=I.gridStructureInfo.findUnit(N.parentDssId);}H=N.dssId;}}}if(!H){return false;}var Q=(I&&I.commands)?I.commands.queryState("getControlGroupByList"):false;if(Q){all:for(var B in Q){if(Q[B].dfm!="1"){continue;}var M=Q[B].oid;if(H==M){return false;}}}return true;default:return(this.parentBone&&this.parentBone.doc&&this.parentBone.doc.commands)?this.parentBone.doc.commands.queryEnabled(P,J):false;break;}}catch(F){microstrategy.errors.log(F);return false;}};mstrViewerCommandsImpl.prototype.queryState=function(F,c){try{var K=this;var P=this.parentBone;var m=function(AH){var AG=[];if(mstr.utils.String.trim(AH).length>0){var AB=AH.split(K.clipboardItemSep);for(var AC=0,g=AB.length;AC<g;AC++){var AD=AB[AC],AF=AD.split(K.itemSep);var AE={};AE[K.valueField]=AD;AE[K.typeField]=AF[1];AE[K.nameField]=AF[2];AG.push(AE);}}return AG;};var q=function(){try{if(!!P.asLoaded){return ;}iframe.showWaitPage();var AB=function(AD){var AG="";for(var AE=0,AC=AD.length;AE<AC;AE++){var AF=AD[AE];AG+=AF[K.valueField];if(AE<AC-1){AG+=K.clipboardItemSep;}}return AG;};mstr.$XHR.request(mstrApp.taskURL||mstrConfig.taskURL,{taskId:"getSubscriptionAssociatedInformation",objectID:P.objectID,objectType:P.objectType,msgID:P.messageID},{success:function(AC){P.asLoaded=true;P.canBeScheduled=!AC.o.nc;P.scheduleType=AC.o.st;P.selectedSchedules=AB(AC.o.items);P.availableSchedules=AC.p.items;P.canBeSubscribed=!AC.user.nc;P.userType=AC.user.ut;P.selectedUsers=AC.user.items||[];P.userSubscribeRights=AC.user.rgts;}},false);iframe.hideWaitPage();}catch(g){microstrategy.errors.log(g);}};switch(F){case"canBeScheduled":q();return P[F];case"scheduleType":P[F+"Was"]=P[F];return P[F];case"availableSchedules":return P[F];case"selectedSchedules":P[F+"Was"]=P[F];return m(P[F]||"");case"canBeSubscribed":q();return P[F];case"userType":P[F+"Was"]=P[F];return P[F];case"selectedUsers":return P[F];case"userSubscribeRights":return P[F];case"rwCurrentViewMode":return P.currentRWViewMode;case"rulers":return P.rulerOn;case"grid":return P.gridOn;case"divider":return P.dividerOn;case"groupByDssIds":return(typeof (P.groupByDssIds!="undefined"))?P.groupByDssIds:null;case"TabName":return P.currentLayoutName;case"tabMPHF":return P.currentLayoutMPHF;case"zoom":var D=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_FLASH);return mstr.controllers.ZoomFactors.getZoomFactors(microstrategy.zoomType,microstrategy.ZOOM_FACTOR,D);case"docVisualizationModeFlash":return P.visualizationMode==50;case"docVisualizationModeAJAX":return P.visualizationMode==51;case"docVisualizationMode":return P.visualizationMode;case"documentDataSets":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAvailableDatasets());case"datasetObjPanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_DATASET_PANEL);case"relatedReportsPanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_RELATED_RP_PANEL);case"notesPanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_NOTES_PANEL);case"outlinePanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_OUTLINE_PANEL);case"documentAttributes":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAvailableAttributes());case"documentPureAttributes":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getPureAttributes());case"documentAttributesWithDateForm":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAttributesWithDateForms());case"documentMetrics":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAvailableMetrics());case"documentAttributesType":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAttributesType());case"widthZoomFactor":var y=document.getElementById("page");var U=document.getElementById("rwb_viewer");if(y&&U){var A=0;var W=0;if(y.style.borderLeftWidth&&(y.style.borderLeftWidth.indexOf("pt")>-1)){A+=parseInt(microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,parseInt(y.style.borderLeftWidth)));}if(y.style.borderRightWidth&&(y.style.borderRightWidth.indexOf("pt")>-1)){A+=parseInt(microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,parseInt(y.style.borderRightWidth)));}A+=getObjWidth(document.getElementById("docRszHandler"));if(document.getElementById("vRulerCol")){W=getObjWidth(document.getElementById("vRulerCol"));}var V=mstr.utils.BoxModel.hasScrollbar(U,"y")?SCROLLBAR_SIZE:0;var H=mstr.utils.BoxModel.hasScrollbar(document.documentElement,"y")?SCROLLBAR_SIZE:0;var z=((getObjWidth(U)-A-V-H)/(getObjWidth(y)+W-A)*microstrategy.ZOOM_FACTOR-0.5).toFixed(0);if(z<0){return 1;}return z;}return 0;case"heightZoomFactor":var y=document.getElementById("page");var U=document.getElementById("rwb_viewer");var G=document.getElementById("rwb_ruler_table");if(y&&U){var Z=0;var h=0;if(y.style.borderTopWidth&&(y.style.borderTopWidth.indexOf("pt")>-1)){Z+=parseInt(microstrategy.number.toLocalUnits(mstrNumber.UNIT_PX,microstrategy.number.convertToUSUnits(mstrNumber.UNIT_PT,parseInt(y.style.borderTopWidth),true),true));}if(y.style.borderBottomWidth&&(y.style.borderBottomWidth.indexOf("pt")>-1)){Z+=parseInt(microstrategy.number.toLocalUnits(mstrNumber.UNIT_PX,microstrategy.number.convertToUSUnits(mstrNumber.UNIT_PT,parseInt(y.style.borderBottomWidth),true),true));}if(document.getElementById("hRulerRow")){h=getObjHeight(document.getElementById("hRulerRow"));}var E=0;var B=microstrategy.objectListFind(y,"div","dsec");for(var n=0;n<B.length;n++){var S=B[n].firstChild;var X=(S.style.display=="block"||S.style.display=="");if(S.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_TITLEBAR&&X){E+=getObjHeight(S);}}var z=((getObjHeight(U)-Z-2*SCROLLBAR_SIZE-E)/(getObjHeight(y)+h-E-Z)*microstrategy.ZOOM_FACTOR-0.5).toFixed(0);if(z<0){return 1;}return z;}return 0;case"IVEMode":return microstrategy.DISPLAY_MODE===microstrategy.VIEW_MODE&&P.currentRWViewMode===microstrategy.RW_VIEW_MODE_VIEWANALYSIS;case"designViewMode":case"convertToDoc":return microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;case"publishViewMode":case"staticViewMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_STATIC;case"interactiveViewMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_INTERACTIVE;case"editableMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_EDITABLE;case"flashViewMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_FLASH;case"export":return mstr.controllers.ExportTypes.getExportModes();case"docSelectedVisualization":var e=[];var Q=-1;var I=P.visualizationList;if(P.isVisualization&&I&&I.length>0){for(var n=0;n<I.length;n++){if(I[n].vm==P.visualizationMode){if(P.selectedVisualization==I[n].name){Q=n;}e.push({dssid:I[n].name+"|"+I[n].vm,n:I[n].desc});}}return{items:e,value:I[Q].name+"|"+I[Q].vm};}return{items:[]};case"toggleFlashGrouping":return P.groupingChecked&&P.groupingChecked();case"toggleConditionalFormatting":return P.isFeatureAvailable("rw-check-document-thresholds");case"hasMultipleLayouts":return P.isMultiLayout&&P.BeforeLayoutItems&&P.BeforeLayoutItems.length>1;case"showJoinBehavior":var x=microstrategy.findBone(P.doc.selections.getSelectedGrid());return x&&x.isGrid;case"gridJoinType":var O=microstrategy.findBone(P.doc.selections.getSelectedGrid()),N=[];if(O){var C=O.editorProperties,J=C&&C.outerJoinType,R={alias:microstrategy.descriptors.getDescriptor("13185"),dssId:"allAttrs",jt:J||"dft",n:"allAttrs",ic:"jt-allattrs"},a=O.gridStructureInfo.metricAxis.units,AA=C&&C.tmsProps,Y=C&&C.dmsProps;N.push(R);a=a&&mstr.$A.filter(a,{filter:function(g){var AC=g.dssId,AB;if(AA&&AA[AC]){AB=AA[AC];if(AB.isDerived&&!AB.afb&&AB.isSmart&&!AB.isSmartCalInBase){return false;}}return true;}},"filter");var M,T,u={};for(M in a){T=a[M].dssId;N.push({dssId:T,alias:a[M].alias,jt:(AA&&AA[T]&&AA[T].outerJoinType)||"dft",n:"metric",ic:"jt-metric"});u[T]=true;}for(T in Y){var L=Y[T];if(!u[T]&&(!L.isDerived||L.afb||!L.isSmart||L.isSmartCalInBase)){N.push({dssId:T,alias:L.alias,jt:L.outerJoinType||"dft",n:"metric",ic:"jt-metric"});}}}return N;case"candidateAttributes":return P.getPureAttributes();default:return(P&&P.doc&&P.doc.commands)?P.doc.commands.queryState(F,c):null;break;}}catch(o){microstrategy.errors.log(o);return false;}};mstrViewerCommandsImpl.prototype.queryVisible=function(A){try{var C=this.parentBone;switch(A){case"docSelectedVisualization":var B=C.visualizationList;return C.isVisualization&&B&&B.length>1&&C.getAllVisList()&&C.getAllVisList()[C.selectedVisualization].sw!="0";case"docVisualizationModeFlash":return C.visualizationsEnabled&&this.isVisModeEnabled(50);case"docVisualizationModeAJAX":return C.visualizationsEnabled&&this.isVisModeEnabled(51);case"tbLoading":return false;case"openPage":return microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE;}return(C.doc&&C.doc.commands)?C.doc.commands.queryVisible(A):true;}catch(D){microstrategy.errors.log(D);return true;}};mstrViewerCommandsImpl.prototype.isVisModeEnabled=function(B){for(var A in this.parentBone.visualizationList){if(this.parentBone.visualizationList[A].vm==B){return true;}}return false;};mstrViewerCommandsImpl.prototype.execPingServer=function(){if(this.pingServer&&mstr.http.PingServer&&mstr.models.BooleanTaskModel){var A=microstrategy.updateManager;if(A.hasNewChanges()){var B=new mstr.http.PingServer();if(!this.booleanTaskModel){this.booleanTaskModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.booleanTaskModel);this.booleanTaskModel&&this.booleanTaskModel.init&&this.booleanTaskModel.init();this.booleanTaskModel.attachEventListener(this,"set_readyState","pingCallback");}this.booleanTaskModel.execSubmit(B);}if(this.parentBone.keepAlive){window.setTimeout("microstrategy.getViewerBone().commands.exec('ping');",this.parentBone.keepAlive);}return true;}return false;};mstrViewerCommandsImpl.prototype.pingCallback=function(A){try{switch(A.name){case"set_readyState":switch(A.memo.value){case mstr.Enum.Widget.READYSTATE.ERROR:this.pingServer=false;return ;}break;}}catch(B){microstrategy.errors.log(B);}};function mstrViewerCommandsImpl(){this.pingServer=true;return this;}var mstrQuickThresholds=new Array();THRESHOLD_TYPE_LOWEST_PERCENT=1;THRESHOLD_TYPE_HIGHEST_PERCENT=2;THRESHOLD_TYPE_BETWEEN_PERCENT=3;THRESHOLD_TYPE_LOWEST=4;THRESHOLD_TYPE_HIGHEST=5;THRESHOLD_TYPE_BETWEEN=6;THRESHOLD_TYPE_VALUE=7;REPLACE_TYPE_TEXT=3;REPLACE_TYPE_IMAGE=4;REPLACE_TYPE_QUICK_SYMBOL=10;IMAGE_DIR="images/quickThresholdImgs/";function defineQuickThreshold(H,I,D,A,C,F,E,G,B){if(!mstrQuickThresholds[H]){mstrQuickThresholds[H]=new Array();}mstrQuickThresholds[H][I]=new Object();mstrQuickThresholds[H][I].formatProps=D;mstrQuickThresholds[H][I].replaceType=A;mstrQuickThresholds[H][I].replaceValue=C;mstrQuickThresholds[H][I].floor=F;mstrQuickThresholds[H][I].ceiling=E;mstrQuickThresholds[H][I].thresholdType=G;mstrQuickThresholds[H][I].thresholdName=B;}defineQuickThreshold(0,0,"FormattingPatterns!FillColor!255;","","","","20",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(0,1,"FormattingPatterns!FillColor!32768;","","","80","",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(1,0,"FormattingFont!Color!255;","","","","20",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(1,1,"FormattingFont!Color!32768;","","","80","",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(2,0,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"stoplight_indi_red_M.gif","","20",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(2,1,"",REPLACE_TYPE_TEXT," ","20","80",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(2,2,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"stoplight_indi_grn_M.gif","80","",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(3,0,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"stoplight_indi_red_M.gif","","20",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(3,1,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"stoplight_indi_yellow_M.gif","20","80",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(3,2,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"stoplight_indi_grn_M.gif","80","",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(4,0,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"arrow3_reddown_small.gif","","20",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(4,1,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"arrow2_orange_large.gif","20","80",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(4,2,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"arrow3_greenup_small.gif","80","",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(5,0,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"flag2_red.gif","","20",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(5,1,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"flag2_sunshine.gif","20","80",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(5,2,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"flag2_green.gif","80","",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(6,0,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"rating_poor.gif","","20",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(6,1,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"rating_fair.gif","20","40",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(6,2,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"rating_good.gif","40","60",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(6,3,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"rating_verygood.gif","60","80",THRESHOLD_TYPE_LOWEST_PERCENT,"name");defineQuickThreshold(6,4,"",REPLACE_TYPE_IMAGE,IMAGE_DIR+"rating_excellent.gif","80","",THRESHOLD_TYPE_LOWEST_PERCENT,"name");mstrDocCommandsImpl.prototype=new Object();mstrDocCommandsImpl.prototype.qeMap={Name:"name",ToolTip:"title",Link:"link",IsLink:"isLink",NewWin:"newWin",Visible:"visibility",VisibleHTML:"showInHTMLViewMode",LineOrientation:"orientation",Source:"src",Locked:"locked",Left:"left",Top:"top",Wmode:"widthMode",Hmode:"heightMode",Width:"width",Height:"height",LockAspectRatio:"lockAspectRatio",Length:"length",Lmode:"lengthMode",borderStyle:"borderTopStyle",IsPortal:"showTitleBar",PortalState:"windowState",PortalTitle:"windowTitle",TitleBarDisplay:"titleBarDisplay",ExportOptions:"exportOptions",HasDropShadow:"dropShadowEffect",DropShadow:"dropShadowDepth",HasRoundedCorners:"hasRoundedCorners",TopCornersOnly:"topCornersOnly",HasAlpha:"alphaEffect",HTMLType:"htmlType",IFrameSource:"url",ShowElementCount:"showElementCount",InformationWindowTarget:"InformationWindowTarget"};mstrDocCommandsImpl.prototype.rwObjNameMap={"106":"3575","102":"3576","105":"3577","101":"3196","52":"3702","111":"4728","8":"4780","107":"4538"};mstrDocCommandsImpl.prototype.exec=function(Au,S,AF){try{var Bn=null;var BZ=null;var AC=null;var BN=null;if(this.parentBone.selections&&this.parentBone.selections.isOnlyOneGridSelected()){AC=this.parentBone.selections.getSelectedGrid();Bn=microstrategy.findBone(AC);if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(Au)){var AO=(Bn instanceof mstrReportGraphImpl)?Bn:microstrategy.bone(Bn.id+"_graph");return AO&&AO.commands.exec(Au,S);}}if(this.parentBone.selections&&this.parentBone.selections.isOnlyOnePanelStackSelected()){BN=this.parentBone.selections.getSelectedPanelStack();BZ=microstrategy.findBone(BN);}var Bi=Au&&Au.match(/currentControl;|widget;|autotext;|addToPanel;|waddToPanel;/);if(Bi&&Bi.index==0){var BJ=new RegExp(Bi[0],"g"),E=Au.replace(BJ,"");E=(Bi[0]=="widget;"||Bi[0]=="waddToPanel;")?"113|"+E:E;var Z=Bi[0].replace(";","").replace("waddToPanel","addToPanel");Z=Bi[0]=="widget;"?"currentControl":Z;return this.exec(Z,E);}var W=function(x,y){showMessage({contents:microstrategy.descriptors.getDescriptor("8498"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:x,buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("219"),Cancel:microstrategy.descriptors.getDescriptor("218")},cancelEval:y,type:mstrMsgBoxImpl.MSG_PREF_WARNING});};switch(Au){case"setControlQualType":var Be=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());Be.setQualType(S);break;case"controlInclude":var Be=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());Be.setInclude(S);break;case"sct":this.parentBone.startControlSelectionMode();return false;case"rnp":var AS=microstrategy.findBone(this.queryState("selectedPanelStack"));var Ak=microstrategy.bones.msgBox;if(Ak){var Y=microstrategy.descriptors.getDescriptor("2211");var T=this.parentBone.styleObj.getAttValue(AS.getCurrentPanel().elem,microstrategy.HTMLATTR_WINDOW_TITLE);var Bt=T;if(mstr&&mstr.utils&&mstr.utils.String){Bt=mstr.utils.String.escape4HTMLText(Bt);}Ak.initInput(Y,T,59,256);Ak.setButtons(microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,"microstrategy.bone('rwb_viewer').doc.renamePanel()","");Ak.setTitle(microstrategy.descriptors.getDescriptor("4815")+" "+Bt);Ak.show();}return false;case"cps":var A7=this.queryState("selectedSection");var AS=this.parentBone.selections.firstItem();var Bg="";if(A7!=null&&AS){Bg=AS.getAttribute("id");var A4=getObjSumLeftScrolled(A7)+5;var A1=getObjSumTopScrolled(A7)+5;A4=getObjSumLeftScrolled(AS)+5;var F=getObjSumTopScrolled(AS);if(A1<(F-20)){A1=F-20;}var BW=new Array();var Ac=new Array();var P={ctlType:mstrRWControlImpl.CTL_TYPE_PANEL_STACK,ctlSrcId:"",ctlSrcType:"",ctlSrcName:microstrategy.descriptors.getDescriptor("4780"),ctlTargetStr:Bg,ctlStyle:"0",ctlOrientation:"1"};BW=this.parentBone.addCtrl(new Rect(A1,null,null,A4),A7,BW,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null,P,microstrategy.SNAP_OFF);A4=A4+getObjWidth(A7.lastChild)+10;Ac.push(A7.lastChild);this.parentBone.selections.finishAddAllObjs(Ac,BW,false);var K=this.parentBone.parentBone;K.updateManager.add(BW);if(K.isEditableViewModeEplus()&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){K.updateManager.flushAndSubmitChanges();}}break;case"csc":case"addAsSelector":var BB=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_ID),AJ=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_TYPE),Bf=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE),O="0";if(AJ==microstrategy.DSSTYPE_ATTRIBUTE_FORM){AJ=microstrategy.DSSTYPE_ATTRIBUTE;}if(AJ==microstrategy.DSSTYPE_METRIC||AJ==microstrategy.DSSTYPE_USER_METRIC||AJ==microstrategy.DSSTYPE_USER_SUMMARY_METRIC){O="7";}var Ah=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DESCRIPTION);var Bg="";if(Bn){Bg=this.parentBone.selections.getSelectedGrid().getAttribute("id");}var A7=this.queryState("selectedSection");if(A7!=null){var A4=getObjSumLeftScrolled(A7)+5;var A1=getObjSumTopScrolled(A7)+5;if(Bg!=null){A4=getObjSumLeftScrolled(this.parentBone.selections.firstItem())+5;var F=getObjSumTopScrolled(this.parentBone.selections.firstItem());if(A1<(F-20)){A1=F-20;}}var BW=new Array();var Ac=new Array();var P={ctlType:(AJ=="12"||AJ=="1"||AJ=="47"||AJ=="4"||AJ=="101"||AJ=="100")?"1":"2",ctlSrcId:BB,ctlSrcType:AJ,ctlSrcSubtype:Bf,ctlSrcName:Ah,ctlTargetStr:Bg,ctlStyle:O,ctlOrientation:"1"};BW=this.parentBone.addCtrl(new Rect(A1,null,null,A4),A7,BW,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null,P,microstrategy.SNAP_OFF);if(BW==null){return false;}A4=A4+getObjWidth(A7.lastChild)+10;Ac.push(A7.lastChild);this.parentBone.selections.finishAddAllObjs(Ac,BW,false);var K=this.parentBone.parentBone;K.updateManager.add(BW);if(K.isEditableViewModeEplus()&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){K.updateManager.flushAndSubmitChanges();}}break;case"setSelectorSource":var Ap=microstrategy.bone(S[3].getAttribute("id")+"_Ctl");if(Ap){var BW=new Array();BW=Ap.setSource(S[0],S[1],S[2],BW);if(microstrategy.getViewerBone().autoWire&&S[1]==microstrategy.DSSTYPE_ATTRIBUTE){var Ba=this.parentBone.selections.getSelectedSubsection();if(Ba){Ba.wireTargets(BW,this.parentBone.parentBone.beanPath,false);}}if(BW&&BW.length>0){microstrategy.updateManager.add(BW);}if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&Ap.isDefinitionComplete()){microstrategy.updateManager.flushAndSubmitChanges();}}break;case"tocFtMgr":case"watermarkFtMgr":var A6=S.split("|");this.parentBone.openDialog(Au,"",null,microstrategy.servletName+"."+microstrategy.pageName);this.parentBone.parentBone.updateManager.replaceURL("selectedTabOptions",A6[2]);this.parentBone.parentBone.updateManager.flushAndSubmitChanges();break;case"copy":return this.parentBone.selections.copy();case"cut":return this.parentBone.selections.cut();case"paste":return this.parentBone.selections.paste();case"delete":return this.exec("deleteSelections");case"selectAll":return this.parentBone.selections.selectAll();case"RwdUnits":this.parentBone.selections.clear();var AA=document.getElementById(S);if(AA.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.addSubSection(AA);}else{this.parentBone.selections.add(AA);}break;case"select":this.parentBone.selections.clear();var Ai=S.split("|");if(Ai[1]==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.addSubSection(document.getElementById(Ai[0]));}else{this.parentBone.selections.add(document.getElementById(Ai[0]));}break;case"select_multiple":var Ai=S.split("|");if(Ai[1]==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.addSubSection(document.getElementById(Ai[0]));}else{if(this.parentBone.selections.firstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.clear();}if(this.parentBone.selections.items[Ai[0]]){this.parentBone.selections.remove(document.getElementById(Ai[0]));}else{this.parentBone.selections.add(document.getElementById(Ai[0]));}}break;case"grid":return this.parentBone.toggleGrid();case"rulers":return this.parentBone.toggleRuler();case"duplicate":return this.parentBone.selections.duplicate();case"currentControl":if(S.indexOf("|")>-1){var AR=S.split("|");this.parentBone.currentControl=AR[0];this.parentBone.currentControlSubtype=AR[1];this.parentBone.currentControl_SelectorControlType=(AR.length>2)?AR[2]:null;}else{this.parentBone.currentControl=S;this.parentBone.currentControlSubtype=null;}this.parentBone.isInsertMode=(S!="cursor");this.parentBone.elem.style.cursor=this.parentBone.isInsertMode?"crosshair":"default";this.parentBone.selections.elem.className=this.parentBone.isInsertMode?"":"enabled";if(this.parentBone.parentBone.docViewsSize>1&&!this.parentBone.parentBone.defaultInsertMode){if(this.parentBone.isInsertMode){var Aa="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('"+mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID+"'), checked = p && p.checked;";var BI=Aa+"rwb.visibleCurOnly=false; if(checked) rwb.updateInsertMode(true);";var BO=Aa+"rwb.visibleCurOnly=true; if(checked) rwb.updateInsertMode(false);";W(BI,BO);}}break;case"addToPanel":if(this.parentBone.parentBone.docViewsSize>1&&!this.parentBone.parentBone.defaultInsertMode){var Aa="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('"+mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID+"'), checked = p && p.checked;";var BV="rwb.commands.exec('doAddToPanel','"+S+"',"+AF+");";var BI=Aa+"rwb.visibleCurOnly=false;"+BV+"if(checked)rwb.updateInsertMode(true);";var BO=Aa+"rwb.visibleCurOnly=true;"+BV+"if(checked) rwb.updateInsertMode(false);";W(BI,BO);}else{this.exec("doAddToPanel",S,AF);}break;case"doAddToPanel":var AR=(S.indexOf("|")>-1)?S.split("|"):[S,null];this.parentBone.currentControl=AR[0];this.parentBone.currentControlSubtype=AR[1];var Bp=this.queryState("selectedContainer");var BW=new Array();var n=microstrategy.updateManager;var AL=this.parentBone.currentControl;this.parentBone.addCtrl(null,Bp,BW,null,null,null,true);this.parentBone.selections.finishAddAllObjs(microstrategy.createAssociativeArray(Bp.lastChild),BW);this.exec("currentControl","cursor");if(BW.length>0){n.add(BW);if(AL==microstrategy.GRAPH_CTL){n.add([n.createActionObject(this.parentBone.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.parentBone.beanPath,[],[],[])]);var g=Bp.lastChild.id;var h=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"":"_0";this.exec("openGraphDropZones",{viewId:g,boneId:"grid_"+g+h,h:getObjHeight(Bp.lastChild),w:getObjWidth(Bp.lastChild),sliceIndex:null});}else{if(this.queryState("appliedTheme")||AL==microstrategy.SUBOBJTYPE_DOC_IMAGE){n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);n.flushAndSubmitChanges();}}}break;case"openGraphDropZones":var n=microstrategy.updateManager;n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);var A6="activeViewID="+S.viewId+"&boneID="+S.boneId+"&zoomFactor="+microstrategy.ZOOM_FACTOR;if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){A6+="&graphHeight="+S.h+"&graphWidth="+S.w;if(S.sliceIndex!=null){A6+="&sliceIndex="+S.sliceIndex;}}toggleShowBean("edtGraphDropZones",true,A6);break;case"setDocCursor":this.parentBone.elem.style.cursor=S;break;case"sizeToGrid":return this.parentBone.selections.sizeToGrid();case"AlignLeft":case"AlignCenter":case"AlignRight":case"AlignTop":case"AlignMiddle":case"AlignBottom":if(this.parentBone.selections.alignObjs(Au)){this.parentBone.selections.syncUp();}else{return false;}break;case"objalign":if(this.parentBone.selections&&this.parentBone.selections.length>0){var AB=this.parentBone.selections.alignObjs(S);if(!AB){return AB;}this.parentBone.selections.syncUp();}break;case"objsize":if(this.parentBone.selections&&this.parentBone.selections.length>0){var AB=this.parentBone.selections.resizeObjs(S);if(!AB){return AB;}this.parentBone.selections.syncUp();}break;case"openFormatGrid":microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",S||{});break;case"openFormatGraph":case"openFormatControl":var Av=(Au=="openFormatControl")?"ftMgr":"ghftMgr";var Bl=microstrategy.activeCXMenu;var C=false;if(Bl&&Bl.clickedElement){if(Bl.clickedElement.className&&Bl.clickedElement.className.indexOf("title_")>=0){C=true;}var AA=findTarget(Bl.clickedElement,microstrategy.HTMLATTR_SUBOBJTYPE);if(AA&&AA.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_CONTAINER_TITLEBAR){C=true;}Bl.clickedElement=null;}if(AC){if(Au=="openFormatControl"){var Ar=new Array();var Bj=this.parentBone.parentBone.updateManager;Ar.push(Bj.createActionObject(AC,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.parentBone.parentBone.gridBP["72001"],["72001","72002"],["0,-9",(C)?"9":"8"]));Bj.add(Ar,true);}var g=AC.getAttribute("id");toggleShowBean(Av,true,"activeViewID="+g+"&selectedTypes="+this.parentBone.selections.getTypes());}else{if(BN){var Ar=new Array();var Bj=this.parentBone.parentBone.updateManager;Ar.push(Bj.createActionObject(BN,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.parentBone.parentBone.gridBP["72001"],["72003","72002"],["0",(C)?"1":"0"]));Bj.add(Ar,true);var g=BN.getAttribute("id");toggleShowBean(Av,true,"activeViewID="+g+"&selectedTypes="+this.parentBone.selections.getTypes());}else{toggleShowBean("ftMgr",true,"selectedTypes="+this.parentBone.selections.getTypes());}}break;case"openBasicConditionalFormatting":case"openSimpleThresholdEditor":case"openAdvConditionalFormatting":case"openAdvThresholdEditor":case"openBasicCondtFmtForHiddenSec":case"openAdvCondtFmtForHiddenSec":var Br=null;var Bb=null;if(Au=="openBasicConditionalFormatting"||Au=="openSimpleThresholdEditor"||Au=="openBasicCondtFmtForHiddenSec"){Br="edtSimpleThresholds";}else{if(Au=="openAdvConditionalFormatting"||Au=="openAdvThresholdEditor"||Au=="openAdvCondtFmtForHiddenSec"){Br="edtAdvancedThresholds";}}if(Au=="openBasicCondtFmtForHiddenSec"||Au=="openAdvCondtFmtForHiddenSec"){Bb=microstrategy.getViewerBone().documentStructureTreeBone.selectedHiddenSection;}else{Bb=this.parentBone.selections.firstItem().getAttribute("id");}var AG="";if(AC){AG+="activeViewID="+AC.getAttribute("id");AG+="&container="+AC.getAttribute("id");}else{AG+="container="+Bb;AG+="&activeViewID=";}toggleShowBean(Br,true,AG);break;case"openFormatDMetric":var BG=S[0].getAttribute("key");var Ad=S[0].getAttribute("dsId");toggleShowBean("ftMgr",true,"selectedTypes=obj."+microstrategy.DSSTYPE_USER_METRIC+"&dataSetID="+Ad+"&userMetricKey="+BG);break;case"openSelectDatasetEditor":microstrategy.openFolderBasedBlockEditor("addDatasetEditor","AddDatasetBlockLoader",null,null,null,this.parentBone);break;case"openReplaceDataSetEditor":modelProps=(S)?{oldDSID:S,oldDSType:microstrategy.DSSTYPE_RPT_DEFINITION}:{oldDSID:"",ReplaceAllDS:true};viewProps={multiSelect:false};microstrategy.openFolderBasedBlockEditor("replaceDatasetEditor","AddDatasetBlockLoader",null,modelProps,viewProps,this.parentBone);break;case"formatUserMetric":this.parentBone.applyUserMetricFormat(S);break;case"edtRename":var A3=1;var BD=1;var D="";var BX=null;var Ax=null;if(Bn&&Bn.dSetId&&Bn.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE)){D=Bn.dSetId;if(AC){BX=AC.getAttribute("id");BD=0;}}else{BD=1;var Ao=microstrategy.bone("reportObjs_RWWorkingSetStyle");if(Ao){var AI=Ao.selections;if(AI.length>0){var g=AI.getDataSetId();D=(g==null)?microstrategy.primeDataSetId:g;var A5=AI.getActiveUserMetricIndxKey();if(A5){Ax=A5[0];A3=A5[1];}}else{D=microstrategy.primeDataSetId;}}else{D=microstrategy.primeDataSetId;}}var M="";M+=(BD!=null)?"&formulaMode="+BD:"";M+=(A3!=null)?"&activeElemIndx="+A3:"";M+=(BX!=null)?"&activeViewID="+BX:"";M+=(Ax!=null)?"&activeUserMetricId="+Ax:"";M+=(D!=null)?"&activeDatasetID="+D:"";toggleShowBean("formula",true,M);break;case"edtDMetric":var n=this.parentBone.parentBone.updateManager,BM=microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE,Bd=this;if(BM&&n.newActions){n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[],null)]);n.flushAndSubmitChanges(false,{success:function(){Bd.exec("doEdtDMetric",S);}});}else{this.exec("doEdtDMetric",S);}break;case"doEdtDMetric":var n=this.parentBone.parentBone.updateManager,BA=mstrApp.getMsgID();var Af={success:function(x){n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);n.flushAndSubmitChanges();}};var BS=microstrategy.findBone(this.parentBone.selections.getSelectedGrid());if(BS){var AX=microstrategy.bone("rwb_viewer")["datasetInfos"],Bl=microstrategy.activeCXMenu,Ab=BS.dSetId,Bo=BS.gridStructureInfo,AH={datasets:AX,dsid:Ab,msgID:BA},Ay=[],a,X,AJ,q;if(Bl&&Bl.getAttribute(microstrategy.HTMLATTR_DSS_ID)!==null){a=Bl.getAttribute(microstrategy.HTMLATTR_DSS_ID);X=Bl.getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME);AJ=Bl.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);q=Bl.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH);}else{var BT=Bo&&Bo.metricAxis&&Bo.metricAxis.units&&Bo.metricAxis.units[0];if(BT){a=BT.dssId;X=BT.alias;AJ=BT.dssType;q=BT.depth;}else{AJ=4;q=0;}}var R=function(x){mstrmojo.xhr.request("POST",mstrConfig.taskURL,Af,{taskId:"mojoRWManipulation",rwb:n.getRWBState(),messageID:BA,suppressData:true,params:JSON.stringify({actions:x,style:{params:{treesToRender:0},name:"RWIVEMojoStyle"}})});};if(Au==="doEdtDMetric"){AH.metricId="";AH.action={cmd:"editNew",refOi:{did:a,n:X}};AH.onApplyMetricCallback=function(x){Ay.push({act:"addDerivedMetricToDataset",dsid:Ab,formula:x.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(x.tokenStreamXML),name:x.alias,afb:x.afb,sfb:x.sfb,newObjectIds:["$GUID_135"]});Ay.push({act:"updateTemplate",keyContext:BS.RWUnitId,actions:[{act:"addUnit",unitId:"$GUID_135",unitType:AJ,unitPos:++q,dsId:Ab,isFirst:!Bo||Bo.isEmptyTemplate}]});R.call(this,Ay);};}microstrategy.openDerivedMetricEditor(AH);}break;case"edtResize":if(AC){var g=AC.getAttribute("id");toggleShowBean("resizeRW",true,"activeViewID="+g);}break;case"edtPageSetup":case"openPageSetupSectionsTab":case"edtDocProps":var BK=0;if(Au=="openPageSetupSectionsTab"){BK=4;}else{if(Au=="edtDocProps"){BK=7;}}var AQ=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?0:this.parentBone.parentBone.currentRWViewMode;microstrategy.openBlockLoaderEditor("rwDocPropsEditor","RWDocPropertiesEditor",{selectedIndicesList:BK},{currentRWViewMode:AQ,featureMode:this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE)});break;case"visualizationsEditor":if(AC){var g=AC.getAttribute("id");if(this.parentBone.parentBone){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}toggleShowBean("visualizationsEditor",true,"activeViewID="+g);}break;case"visualizationsEditorRW":toggleShowBean("visualizationsEditor",true,"activeViewID=");break;case"visualizationsEditorRWLayout":toggleShowBean("visualizationsEditor",true,"activeViewID=&activeTabID=-1");break;case"edtSubtotals":if(AC){var g=AC.getAttribute("id");toggleShowBean("subtotalsDHTMLRW",true,"activeViewID="+g);}break;case"edtSubtotalsOldIServer":if(AC){var g=AC.getAttribute("id");toggleShowBean("subtotalsDHTMLRWOldIServer",true,"activeViewID="+g);}break;case"edtSort":if(AC&&Bn&&Bn.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE)){this.exec("edtSortGrid",S);}else{this.exec("edtSortRW",S);}break;case"edtSortGrid":if(AC){var BX=AC.getAttribute("id");microstrategy.openAdvSortEditor({beanPath:this.parentBone.parentBone.beanPath+"."+BX,subtotalPosition:Bn&&Bn.subtotalPosition,isDocDesignMode:microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE,sourceAxis:S&&S[0],sourceType:S&&S[1],targetGrid:Bn,taskParams:{taskId:"RWExecute",messageID:mstrApp.getMsgID(),gridStyle:"AdvSortDataStyle",partialDisplayKeys:BX,styleName:"RWGridStyle",sessionState:mstrApp.sessionState}});}break;case"graphZones":if(Bn&&Bn.toggleZonesEditor){var A0=Bn.zonesEditor?false:true;Bn.toggleZonesEditor(null,A0);}break;case"edtSortRW":toggleShowBean("sortEditorRWDoc",true,"");break;case"vfeRWGrid":if(AC){var U=AC.getAttribute("id"),BQ=this.parentBone,K=BQ.parentBone,n=K.updateManager,g="mfe",A2={};var Aq=function(){if(!window.mstrmojo||!mstrmojo.fe||!mstrmojo.fe.FilterEditor){microstrategy.mojoLoader.loadWidget({bundle:"mojo-fe.js",callback:Bk});}else{mstrmojo.locales.load(Bk);}},Bk=function(){var y={taskId:"getRWGridViewFilter",nodeKey:U,rwb:n.getRWBState(),msgID:K.messageID};var x={success:function(Bv){Bv.scriptClass="mstrmojo.Obj";var Bu=mstrmojo.insert(Bv);BH(Bu);},failure:function(Bu){mstrmojo.err("Failed to load filter data. ");}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,x,y);},c=function(y,Bv){var x,Bu=y.nds;if(y.ph){Bv[y.ph.idx]=true;}else{if(Bu){for(x=0;x<Bu.length;x++){c(Bu[x],Bv);}}}return Bv;},BH=function(x){w=g&&window.mstrmojo&&mstrmojo.all[g];var y=microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;if(!w){w=mstrmojo.insert({id:g,scriptClass:"mstrmojo.fe.FilterEditor",onUpdateBrowseElementsParams:function(Bv,Bu){Bv.datasetID=this.model.dsid;Bv.messageID=this.model.messageID;Bv.templateNodeKey=U;},disableElementsBrowsing:function(Bu){return y&&Bu.da;}});w.walk.getAttributeForms=function(Bu){return mstrmojo.rw.ConditionWalk.getAttForms(Bu,microstrategy.bone("rwb_viewer")["datasetInfos"]);};}x.targets=mstr.$A.filter(x.targets,{filter:function(Bu){return !Bu.olap;}},"filter");x.targets=mstr.$A.filter(x.targets,{filter:function(Bu){switch(Bu.t){case 1:return(Bu.st!==257);case 47:return Bu.st==12033;}return true;}},"filter");w.set("onSave",As);w.set("model",x);if(w.mainExpr.items.length>0){A2=c(w.mainExpr.items[0],A2);}w.open();},As=function(Bw){var Bx=mstrmojo.fe.FilterUtils.getExprXml(Bw.expr),x=mstrmojo.fe.FilterUtils.getExprXml(Bw.limitExpr),B1=microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;var Bu=[n.createActionObject(null,mstrUpdateManager.SET_GRID_VIEW_FILTER,K.beanPath,["2048012","2048207","2048138","2048274"],[U,Bx,"1","1"],[]),n.createActionObject(null,mstrUpdateManager.SET_GRID_VIEW_LIMIT,K.beanPath,["2048012","2048207","2048018"],[U,x,B1],[])];var Bz={};if(w.mainExpr.items.length>0){Bz=c(this.mainExpr.items[0],Bz);}var B2=[];for(key in A2){if(!Bz[key]){B2.push(key);}}if(B2.length>0){var By=U+"_"+B2.join("_");Bu.push(n.createActionObject(null,mstrUpdateManager.REMOVE_TARGETED_PLACEHOLDERS,K.beanPath,["2048285"],[By],[]));}var y=JSON.stringify(Bz)!="{}";if(y){Bu.push(n.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,K.beanPath,["2048065","2048018"],[mstrUpdateManager.createPropertyEditString(null,"DocumentVersion",10,true,"RWDocumentProperties"),B1],[]));}var B0=function(){K.checkAndDisableFlashDefaultMode(n,Bu);n.add(Bu);n.flushAndSubmitChanges();},Bv=function(){w.open();};if(y){K.showWarningMessageForUnsupportFeature(B0,Bv);return ;}B0();};if(n.hasChangesToSubmit()||K.isModified){K.callbackOnReload=Aq;n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);n.flushAndSubmitChanges();}else{Aq();}}break;case"pasteFormat":var Bs=this.parentBone.selections;var e=mstr.utils.Arrays.fromHashValues(Bs.objCache.copyBuffer.items);var Q=(e)?this.parentBone.parentBone.objProps.pasteFormat(e[0],Bs.items,true):null;if(Q){Bs.syncUp();}break;case"setCtrlDft":case"setDefaults":this.parentBone.parentBone.objProps.setDefaultFormat(this.parentBone.selections.firstItem());break;case"applyCtrlDft":case"applyDefaults":var Bs=this.parentBone.selections.items;this.parentBone.parentBone.objProps.applyCtrlDft(Bs,true);this.parentBone.selections.resizeSubSection();this.parentBone.selections.resizeUnitsInFP();break;case"edtProps":microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",{});break;case"fmtGridCells":this.exec("edtPropsTabSelected",10);break;case"edtPropsTabSelected":microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",{selectedIndicesList:S});break;case"addImg":this.parentBone.openAddImagePropertiesEditor();break;case"cancelImg":this.parentBone.deleteItems(this.parentBone.selections.items,bIsFirefox);this.adjustImageSizeFlag=false;break;case"deleteStubImg":if(this.parentBone.stubImage!=null){this.parentBone.deleteItems(microstrategy.createAssociativeArray(this.parentBone.stubImage),true);this.parentBone.setStubImage(null);}break;case"setStubImage":this.parentBone.setStubImage(this.parentBone.selections.firstItem());break;case"deleteSelections":this.parentBone.promptDeleteItems(this.parentBone.selections.items,true);break;case"cancelSelectorCreation":this.parentBone.deleteItems(this.parentBone.selections.items,false);break;case"deleteFromPortal":var Bq=document.getElementById(S);if(Bq){this.parentBone.promptDeleteItems(microstrategy.createAssociativeArray(Bq),true);}break;case"minimizePortal":var Bq=document.getElementById(S);if(Bq){var AM=this.parentBone.styleObj.getAttValue(Bq,microstrategy.HTMLATTR_WINDOW_STATE);this.parentBone.styleObj.setAttValue(Bq,microstrategy.HTMLATTR_WINDOW_LAST_STATE,AM);this.parentBone.minimizePortal(microstrategy.createAssociativeArray(Bq),"windowState",microstrategy.WINDOW_STATE_MINIMIZED,true);}break;case"maximizePortal":var Bq=document.getElementById(S);if(Bq){var AN=this.parentBone.styleObj.getAttValue(Bq,microstrategy.HTMLATTR_WINDOW_LAST_STATE);this.parentBone.styleObj.setAttValue(Bq,microstrategy.HTMLATTR_WINDOW_LAST_STATE,"");this.parentBone.maximizePortal(microstrategy.createAssociativeArray(Bq),"windowState",microstrategy.WINDOW_STATE_MAXIMIXED,true);if(AN!=microstrategy.WINDOW_STATE_MAXIMIXED){if(this.refreshOnWindowChange(Bq,microstrategy.findBone(Bq))){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}}mstrDocCommandsImpl.syncGridWidth(Bn);}break;case"restorePortal":var Bq=document.getElementById(S);if(Bq){var AN=this.parentBone.styleObj.getAttValue(Bq,microstrategy.HTMLATTR_WINDOW_LAST_STATE);this.parentBone.styleObj.setAttValue(Bq,microstrategy.HTMLATTR_WINDOW_LAST_STATE,"");this.parentBone.restorePortal(microstrategy.createAssociativeArray(Bq),"windowState",microstrategy.WINDOW_STATE_NORMAL,true);if(AN!=microstrategy.WINDOW_STATE_NORMAL){if(this.refreshOnWindowChange(Bq,microstrategy.findBone(Bq))){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}}mstrDocCommandsImpl.syncGridWidth(Bn);}break;case"back":case"front":case"oneBack":case"oneFront":this.parentBone.selections.sendTo(Au);break;case"sendTo":this.parentBone.selections.sendTo(S);break;case"autoSizeImg":var Ar=new Array();this.parentBone.autoSizeImages(0,false,this.parentBone.selections.items,Ar);this.parentBone.parentBone.updateManager.add(Ar);break;case"groupProp":var Ae=this.parentBone.selections.getSelectedSubsection();if(Ae){toggleShowBean("gbeb",true,"activeGroupby="+Ae.parentBone.groupID);}break;case"WebHyperLinkEditor":var Bl=this.parentBone.selections.firstItem();var I=Bl?Bl.id:null;if(Bl.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var BS=microstrategy.findBone(Bl);if(BS&&BS.selections){Bl=BS.selections.getItems()[0];}}var A6="activeObjKey="+I;if(Bl){var N=Bl.getAttribute(microstrategy.HTMLATTR_DSS_ID);var Ag=Bl.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(N&&Ag){A6+="&activeUnitID="+N;A6+="&activeUnitType="+Ag;}A6+="&renderPromptsOnly=false";toggleShowBean("webHyperLinkEditor",true,A6);}break;case"FilterDetailsProperties":var AU=this.parentBone.selections.length==0;var m={};if(this.parentBone.selections.isActive()&&!this.parentBone.selections.isMulti()&&this.parentBone.selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)){m.objId=this.parentBone.selections.firstItem().getAttribute(microstrategy.HTMLATTR_ID);AU=true;}if(AU){microstrategy.openDataBasedBlockEditor(null,"FilterDetailsEditorBlockLoader",this.parentBone.parentBone.beanPath,m);}break;case"unlinkTheme":console.log("TODO unlink the theme and apply copy as theme action");var n=microstrategy.updateManager,o=this.queryState("appliedThemeID"),K=this.parentBone.parentBone,Bs=this.parentBone.selections.items,BE=[];for(var g in Bs){BE.push(g);}n.add([n.createActionObject(null,mstrUpdateManager.APPLY_THEME,K.beanPath,["2048292","2048076","2048293"],[o,BE.join(mstrUpdateManager.ITEM_SEPARATOR),false])]);n.flushAndSubmitChanges();break;case"applyTheme":var K=this.parentBone.parentBone;microstrategy.showApplyThemeEditor(false,false,function(y,Bu){var x=microstrategy.updateManager;x.add([x.createActionObject(null,mstrUpdateManager.APPLY_THEME,K.beanPath,["2048292","2048076","2048293"],[y,"",Bu])]);x.flushAndSubmitChanges();});break;case"applyThemeOnNode":var K=this.parentBone.parentBone,Bs=this.parentBone.selections.items,BE=[];microstrategy.showApplyThemeEditor(true,this.queryState("appliedThemeAsLink"),function(y,Bu){var x=microstrategy.updateManager;for(var Bv in Bs){BE.push(Bv);}x.add([x.createActionObject(null,mstrUpdateManager.APPLY_THEME,K.beanPath,["2048292","2048076","2048293"],[y,BE.join(mstrUpdateManager.ITEM_SEPARATOR),Bu])]);x.flushAndSubmitChanges();});break;case"saveAsTheme":var K=this.parentBone.parentBone,n=K.updateManager;if(n.hasChangesToSubmit()||!!K.isModified){K.callbackOnReload=function(){microstrategy.showSaveAsThemeEditor();};n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);n.flushAndSubmitChanges();}else{microstrategy.showSaveAsThemeEditor();}break;case"insertSectionAbove":case"insertSectionBelow":this.exec("mngSections",Au=="insertSectionAbove"?"above":"below");break;case"mngSections":switch(S){case"above":case"left":var Ae=this.parentBone.selections.getSelectedSubsection();if(Ae){Ae.insertSubSectionAbove();}break;case"below":case"right":var Ae=this.parentBone.selections.getSelectedSubsection();if(Ae){Ae.insertSubSectionBelow();}break;case"delete":showMessage({contents:microstrategy.descriptors.getDescriptor("3316"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.parentBone.parentBone.id+"').doc.sections['"+this.parentBone.currentSection.id+"'].subsections['"+this.parentBone.currentSection.currentSubSection.id+"'].deleteSubSection();",type:mstrMsgBoxImpl.MSG_WARNING});break;}break;case"number":case"deltaDecimal":this.parentBone.selections.setNumberFormat(Au,S);this.parentBone.selections.syncUp();break;case"DocPropertyChanges":this.parentBone.processDocPropertyChanges(S);break;case"SyncSelections":if(this.parentBone.selections&&this.parentBone.selections.isActive()){this.parentBone.selections.syncUp();}break;case"addObj":this.parentBone.addObj("5","5",microstrategy.findBone(this.parentBone.selections.firstItem()),S,null,microstrategy.SNAP_OFF);break;case"addObjs":var Bh=microstrategy.findBone(this.queryState("selectedSection"));Bh.ondrop(Bh.elem,S);break;case"addObjsWithFormat":var Bh=microstrategy.findBone(this.queryState("selectedSection"));Bh.addObjsWithFormat(5,5-this.parentBone.parentBone.elem.scrollTop,S[0],Bh.elem,S[1],microstrategy.SNAP_OFF,null,false);break;case"addObjsAsLinked":var Bh=microstrategy.findBone(this.queryState("selectedSection"));Bh.addObjsWithFormat(5,5-this.parentBone.parentBone.elem.scrollTop,S[0],Bh.elem,S[1],microstrategy.SNAP_OFF,null,true);break;case"addasText":var A7=this.queryState("selectedSection");if(A7!=null){var A4=getObjSumLeftScrolled(A7)+5;var A1=getObjSumTopScrolled(A7)+5;var BW=new Array();var Ac=new Array();for(var A9 in S){BW=this.parentBone.addCtrl(new Rect(A1,null,null,A4),A7,BW,microstrategy.SUBOBJTYPE_DOC_TEXT,S[A9].getAttribute("ds"),null,microstrategy.SNAP_OFF);A4=A4+getObjWidth(A7.lastChild)+10;Ac.push(A7.lastChild);}this.parentBone.selections.finishAddAllObjs(Ac,BW,false);this.parentBone.parentBone.updateManager.add(BW);}break;case"autotext":if(this.parentBone.parentBone.docViewsSize>1&&!this.parentBone.parentBone.defaultInsertMode){var Aa="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('"+mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID+"'), checked = p && p.checked;";var BV="rwb.commands.exec('doAutotext','"+S+"');";var BI=Aa+"rwb.visibleCurOnly=false;"+BV+"if(checked)rwb.updateInsertMode(true);";var BO=Aa+"rwb.visibleCurOnly=true;"+BV+"if(checked) rwb.updateInsertMode(false);";W(BI,BO);}else{this.exec("doAutotext",S);}break;case"doAutotext":if(this.parentBone.selections&&!this.parentBone.selections.isMulti()&&this.parentBone.selections.isActive()){var Bc=this.parentBone.selections.firstItem();if(Bc!=null){var A8=Bc.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);var L=Bc.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(A8==microstrategy.SUBOBJTYPE_DOC_TEXT){this.parentBone.appendToTextField(this.parentBone.getAutoTextMacroCode(S),Bc);this.parentBone.editText(null,Bc);}else{if(L==microstrategy.OBJTYPE_DOC_OBJECT&&A8==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var J=microstrategy.findBone(Bc);Bc=J.getCurrentPanel().elem;}else{if(L!=microstrategy.OBJTYPE_DOC_SUBSECTION){Bc=microstrategy.findAncestor(Bc.parentNode);}}var Bm=new Rect(getObjSumTopScrolled(Bc)+1,null,null,getObjSumLeftScrolled(Bc)+1);this.parentBone.addCtrl(Bm,Bc,null,microstrategy.SUBOBJTYPE_DOC_TEXT,this.parentBone.getAutoTextMacroCode(S));}}}break;case"addToTextField":this.parentBone.appendToTextField(S[0],S[1],S[2]);break;case"addToGrouping":var Bj=this.parentBone.parentBone.updateManager;var BW=new Array();var Bq=S.getItems();for(var A9=0;A9<Bq.length;A9++){var G=false;var u=Bq[A9].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);var BU=Bq[A9].getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);var A=Bq[A9].getAttribute(microstrategy.HTMLATTR_DSS_ID);if(microstrategy.isValidGroupByType(u)){var BR=this.parentBone.parentBone.commands.queryState("groupByDssIds");G=(BR.indexOf("|"+A+"|")==-1);}if(G){BW.push(Bj.createActionObject(this,mstrUpdateManager.ADD_GROUP,this.parentBone.parentBone.beanPath,["2048004","2048005","2048106","2048031"],[A,u,BU,S.getDataSetId()],[]));}}Bj.add(BW);Bj.flushAndSubmitChanges();break;case"editTextField":this.parentBone.editText(null,S);break;case"maxZIndex":return this.parentBone.getMaxZIndex();break;case"edtColorPicker":var A6=S.split("|");this.parentBone.openDialog("edtColorPicker",null,null,microstrategy.servletName+"."+microstrategy.pageName,{activeBoneID:A6[0],activeControlID:A6[1],currentColor:A6[2]});this.parentBone.parentBone.updateManager.replaceURL("selectedTabOptions",A6[3]);this.parentBone.parentBone.updateManager.flushAndSubmitChanges();break;case"graphEdtColorGradient":case"edtColorGradient":var A6=S.split("|");var Aw="parentBoneID="+A6[0]+"&controlID="+A6[1]+"&activeViewKey="+A6[2]+"&graphObjectID="+A6[3]+"&graphSeriesID="+parseInt(A6[4],10);if(A6.length>6){Aw+="&color1="+A6[5]+"&color2="+A6[6]+"&transitionType="+A6[7]+"&angle="+A6[8]+"&xOffset="+A6[9]+"&yOffset="+A6[10];microstrategy.updateManager.replaceURL("selectedTabOptions",A6[11]);}this.parentBone.openDialog("edtColorGradient",Aw,null,microstrategy.servletName+"."+microstrategy.pageName);microstrategy.updateManager.flushAndSubmitChanges();break;case"toggleSnap":microstrategy.SNAP_OFF=!microstrategy.SNAP_OFF;microstrategy.updateBrowserSetting("snapOff",microstrategy.SNAP_OFF);break;case"objBrowser":case"toggleAccordion":return microstrategy.toggleAccordion();case"groupBy":case"toggleGroupBy":return microstrategy.toggleEditor("pbb_GroupByStyle","pbb");case"docSelectedVisualization":var Ar=new Array();var A6=S.split("|");this.parentBone.setVisualizationSettings(null,A6[0],null,A6[1],Ar,null,(this.parentBone.parentBone.isLayoutLevelVis)?"-1":null);this.parentBone.parentBone.updateManager.add(Ar);if(!this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS)){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}return true;case"setVisProps":var A6=S.split("|");var BW=new Array();this.parentBone.setVisualizationSettings(null,null,null,null,BW,A6[0],A6[1],true);this.parentBone.parentBone.updateManager.add(BW,true);return true;case"createPanel":return this.parentBone.createPanel();case"secondaryDataSourcesEditor":if(AC){var g=AC.getAttribute("id");toggleShowBean("secondaryDataSourcesEditor",true,"activeViewID="+g+"&secondaryKeys="+S[0]+"&visEditorId="+S[1]);}break;case"visPropsEditor":var AG="scope="+S[0]+"&selVis="+S[1];toggleShowBean("visPropsEditor",true,AG);break;case"gridMode":case"graphMode":case"gridGraphMode":case"visualizationMode":case"tbanding":case"tOutline":case"toggleattforms":case"fittocontent":case"fittowindow":case"comboToggleButton":case"tsubtotals":case"checkMergeRowHeader":case"checkMergeColHeader":case"checkLockRowHeader":case"checkLockColHeader":case"ShowThreshold":case"quickThresholds":case"swapAxes":case"formatGridBulk":case"formatGraphBulk":case"autostyle":case"subtotalChanges":case"addQuickTotals":case"cancelGridFormatRequest":case"toggleHideNullsOrZeros":if(Bn&&Bn.commands){return Bn.commands.exec(Au,S);}return false;case"gridGraphMode":if(Bn&&Bn.commands){var BW=[];this.parentBone.formatSizeMode(microstrategy.createAssociativeArray(AC),"heightMode","0",BW);this.parentBone.formatSizeMode(microstrategy.createAssociativeArray(AC),"widthMode","0",BW);microstrategy.updateManager.add(BW);return Bn.commands.exec(Au,S);}case"gridSelectedVisualization":if(Bn&&Bn.commands){var AZ=Bn.commands.exec("selectedVisualization",S);this.parentBone.parentBone.observer.notifyAll("onselectionchange");return AZ;}return false;case"synchronizeGridSelections":if(this.parentBone.selections){this.parentBone.selections.fetchObjectFormatLevelFromGrid();}break;case"tbUnitSelector":if(this.queryEnabled("onepanelstack")){var V=null;if(S==1){V=0;}this.parentBone.selections.setObjectFormatLevel("Panels",this.parentBone.selections.resolvePanelsFormat(S,V));}else{if(S.indexOf("**grid")>-1){Bn.graphSelected=false;this.exec("tbGridUnitSelector",S.replace("**grid",""));}else{if(S.indexOf("**graph")>-1){Bn.commands.exec(Au,S);}else{this.exec("tbGridUnitSelector",S);}}}break;case"tbValueSelector":if(this.queryEnabled("onepanelstack")){this.parentBone.selections.setObjectFormatLevel("Panels",this.parentBone.selections.resolvePanelsFormat(null,S));}else{if(this.queryEnabled("onecontrol")){this.parentBone.selections.setObjectFormatLevel("Control",this.parentBone.selections.resolveControlFormat(null,S));}else{if(Bn.graphSelected){Bn.commands.exec(Au,S);}else{this.exec("tbGridValueSelector",S);}}}break;case"tbGridUnitSelector":case"tbGridValueSelector":var Aj,BY;if(Au=="tbGridUnitSelector"){Aj=S;if(Aj<microstrategy.GRID_OTHER){this.parentBone.selections.addToSelection(false,findTarget(Bn.elem,microstrategy.HTMLATTR_OBJTYPE));if(Aj==microstrategy.GRID_UNIT_CONTAINER){BY=1;}}}else{BY=S;}this.parentBone.selections.setObjectFormatLevel(Au,this.parentBone.selections.resolveGridFormat(Aj,BY));return false;case"setUnitFormatLevels":var Al=(Bn)?"Grid":(BZ?"Panels":"Control");var Aj,BY;if(S.src=="edtUnitSelector"){Aj=S.v;if(Bn){if(Aj<microstrategy.GRID_OTHER){this.parentBone.selections.addToSelection(false,findTarget(Bn.elem,microstrategy.HTMLATTR_OBJTYPE));if(Aj==microstrategy.GRID_UNIT_CONTAINER){BY=1;}}}}else{BY=S.v;}var BF=this.parentBone.selections["resolve"+Al+"Format"](Aj,BY);this.parentBone.selections.setObjectFormatLevel(Al,BF);this.parentBone.selections.verifyFormatLevels(S.t);break;case"resetObjectFormatLevel":if(this.parentBone&&this.parentBone.selections){this.parentBone.selections.resetObjectFormatLevel();}break;case"edtTabChange":this.parentBone.selections.verifyFormatLevels(S);break;case"formatMultiLevelBulk":for(var A9=S.length-1;A9>=0;A9--){var BC=S[A9].split("|");if(BC[0]==microstrategy.FORMAT_LEVEL_FLAG_DOC){var AY=S.splice(A9,1)[0];this.exec(BC[1],BC[2]);}}break;case"MultiLevelPropertyChanges":for(var A9=S.length-1;A9>=0;A9--){if(S[A9].level==microstrategy.FORMAT_LEVEL_FLAG_DOC){var AV=S.splice(A9,1)[0];this.exec(AV.cmdId,AV);}}break;case"showFunctionBuilder":toggleShowBean("functionWizard",true,"formulaMode=2");break;case"drill":case"drillNW":this.parentBone.selections.performDrill(S,(Au=="drillNW"));break;case"execLink":this.execLink(S);break;case"cancelEdit":if(S){this.parentBone.parentBone.updateManager.undo(S);}if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.cancelPropertyEdit(S);}break;case"save":var n=this.parentBone.parentBone.updateManager;var BW=new Array();var AD=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"true":"false";var AT=(this.parentBone.parentBone.saveFolderId)?this.parentBone.parentBone.saveFolderId:this.parentBone.parentBone.parentFolderID;BW.push(n.createActionObject(this.elem,mstrUpdateManager.RW_SAVE_AS,microstrategy.servletName,["3013","3014","3017"],["false",AT,AD],[]));n.add(BW);n.useIframe=false;n.flushAndSubmitChanges();break;case"ctrlJustAdded":if(!this.queryState("lock")){this.exec("cursor");}break;case"cursor":this.parentBone.parentBone.insertionControlLocked=false;this.exec("currentControl",Au);this.parentBone.parentBone.observer.notifyAll("insertionControlModified");break;case"lock":if(!this.queryState("cursor")){this.parentBone.parentBone.insertionControlLocked=!this.parentBone.parentBone.insertionControlLocked;}this.parentBone.parentBone.observer.notifyAll("insertionControlModified");break;case microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:Au=Au+"|false";case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|0":case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|1":S=Au.split("|")[1];Au=Au.split("|")[0];case microstrategy.GRAPH_CTL:case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|FP":case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|TC":case microstrategy.SUBOBJTYPE_DOC_TEXT:case microstrategy.BUTTON_CTL:this.parentBone[Au]=S;if((this.parentBone.currentControl==Au&&!this.isSubtypedCmd(Au))||(this.isSubtypedCmd(Au)&&S==this.parentBone.currentControlSubtype)){if(this.queryState("lock")){this.exec("cursor");break;}else{this.parentBone.parentBone.insertionControlLocked=true;}}else{if(this.queryState("lock")){this.parentBone.parentBone.insertionControlLocked=false;}}if(Au==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&S.indexOf(";")>=0){Au=microstrategy.SUBOBJTYPE_DOC_WIDGET;}this.exec("currentControl",this.isSubtypedCmd(Au)?Au+"|"+S:Au);this.parentBone.parentBone.observer.notifyAll("insertionControlModified");break;case"visFlashMode":case"visAjaxMode":case"autoArrange":if(Bn){Bn.commands.exec(Au,"0");}break;case"FontFamily":case"FontSize":case"Bold":case"Italic":case"Underline":case"FillColor":case"FontColor":if(Bn){if(this.parentBone.selections.gridUnitFormatX!=microstrategy.GRID_UNIT_CONTAINER||Bn.graphSelected){if(this.passToGrid(Bn,Au,S)){return true;}}else{microstrategy.formatType=this.parentBone.selections.gridValueFormatX;}}if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.setFormat(Au,S,AF);this.parentBone.selections.syncUp();}break;case"GridHorizontal":this.passToGrid(Bn,Au,S);break;case"IncreaseDecimal":case"DecreaseDecimal":if(!this.passToGrid(Bn,Au,S)){this.exec("deltaDecimal",(Au=="IncreaseDecimal")?"1":"-1");}break;case"Currency":case"IntlCurrency":if(!this.passToGrid(Bn,Au,S)){this.exec("number","1");}break;case"Percent":if(!this.passToGrid(Bn,Au,S)){this.exec("number","2");}break;case"Comma":if(!this.passToGrid(Bn,Au,S)){this.exec("number","3");}break;case"lnstyle":case"lncolor":case"LineColor":if(this.parentBone.selections.isGridContainerSelected()||!this.passToGrid(Bn,Au,S)){if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.setBorderFormat(Au,S);this.parentBone.selections.syncUp();}}break;case"borders":if(this.parentBone.selections.isGridContainerSelected()||!this.passToGrid(Bn,Au,S)){if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.enableBorders(S);this.parentBone.selections.syncUp();}}break;case"pivotButtons":var BL=this.parentBone.parentBone.isFeatureAvailable("check-show-pivot-buttons")?0:1;n=this.parentBone.parentBone.updateManager;var AW=n.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.parentBone.beanPath,["5003","5004"],["showPivot",BL],[],null);n.add([AW],true);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}n.flushAndSubmitChanges();break;case"sortButtons":BL=this.parentBone.parentBone.isFeatureAvailable("check-show-sort-buttons")?0:1;n=this.parentBone.parentBone.updateManager;AW=n.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.parentBone.beanPath,["5003","5004"],["sSrt",BL],[],null);n.add([AW],true);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}n.flushAndSubmitChanges();break;case"createAutowireSelector":case"removeTargets":n=this.parentBone.parentBone.updateManager;var Az=microstrategy.activeCXMenu;var AE=Az.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)||microstrategy.DSSTYPE_METRIC;var g=Az.getAttribute(microstrategy.HTMLATTR_DSS_ID)||"";var AK=this.parentBone.selections.getSelectedGrid().getAttribute("id");if(Au=="createAutowireSelector"){var A7=this.parentBone.selections.getSelectedSubsection();var An=A7.getTargets({excludeTargets:[AK]}).keys;var AW=n.createActionObject(null,mstrUpdateManager.ADD_CONTROL_TO_GRID,this.parentBone.parentBone.beanPath,["2048007","2048012","2048001","2048009","2048129","2048116"],[AK,"",g,AE,"",An.join(CLIPBOARD_ITEM_SEPARATOR)],[]);}else{var AW=n.createActionObject(null,mstrUpdateManager.REMOVE_CONTROL_FROM_GRID,this.parentBone.parentBone.beanPath,["2048007","2048130","2048001","2048009"],[AK,"",g,AE],[],null);}n.add([AW],true);n.flushAndSubmitChanges();break;case"disableAutowire":this.parentBone.processDocPropertyChanges([{cmdId:"Autowire",memo:{},value:false}]);break;case"mojoVisPropsEditor":if(mstr.utils.ISIE8){return showMessage({contents:"This page is not supported in your browser",elements:microstrategy.OK_BUTTON,buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("219")},type:mstrMsgBoxImpl.MSG_WARNING});}var Bd=this,K=this.parentBone.parentBone;n=K.updateManager,g="mstrVisPropsEditor",openVPE=function(){microstrategy.showWait(false);mstr.$obj("widgetBoneTranslator").set("mojoVisPropsChanged",false);var x=mstrmojo.insert({scriptClass:"mstrmojo.mstr.VisPropsEditor",id:g,nodeKey:Bd.parentBone.selections.getSelectionsKey()[0],messageID:K.messageID,rwb:K.updateManager.getRWBState(),executionMode:Bd.isDesignMode()?1:null,zIndex:microstrategy.getMaxZIndex()+1,visible:true,onClose:function(){this.destroy();},onOK:function(){mstr.$obj("widgetBoneTranslator").set("mojoVisPropsChanged",true);}});x.start();},AP=function(){if(!window.mstrmojo||!mstrmojo.mstr.VisPropsEditor){microstrategy.showWait(true);microstrategy.mojoLoader.loadWidget({bundle:microstrategy.jsBundleDebug?"mojo-vis-props-debug.js":"mojo-vis-props.js",callback:openVPE});}else{openVPE();}};if(n.hasChangesToSubmit()||!!K.isModified){K.callbackOnReload=AP;n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);n.flushAndSubmitChanges();}else{AP();}break;case"transactionEdit":var K=this.parentBone.parentBone,Bd=this;n=K.updateManager,g="mstrTE",openTE=function(){if(!mstrmojo.all[g]){mstrmojo.insert(mstrmojo.txEditor.TransactionEditor);}var B0=mstrmojo.all[g],x=K.messageID,Bv=Bd.parentBone.selections,B1=Bv.isOnlyOneTableSelected()&&Bv.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK),By=B1?B1.getTransactionUnitKey():Bv.getTransactionUnitKey(),Bu=B1&&B1.queryState("TRXObjs"),y=function(B4){var CA=microstrategy.findBone(document.getElementById(Bd.parentBone.prevSelectedId)),B6=B4.rwTxs.tscObjs,B3=microstrategy.bone("rwb_viewer"),B5=[].concat(B3.getAvailableAttributes()).concat(B3.getAvailableMetrics()),B9=B3.ddic={},B7=CA.tscObjs||[],B8=[].concat(B6);if(CA){var B2={};mstr.$A.forEach(B7,function(CB){if(CB.ctl&&CB.ctl.ddic){B2[CB.ctl.ctlKey]=mstr.$H.deepClone(CB.ctl);}});mstr.$A.forEach(B8,function(CG){if(CG.ctl&&CG.ctl.ddic){var CE=B2[CG.ctl.ctlKey],CB=CG.ctl.ddic,CH={trxsid:true,ctlSrc:true,autoSync:true,targetKeys:true},CD;if(CE){CD=CE.ddic;CD.trxsid=CB.csid;}else{var CC=CG.ctl.ddic.csid,CF=mstr.$A.filter(B5,{filter:function(CJ){return CJ.dssid.indexOf(CC)>=0;}},"filter");CD={trxsid:CB.trxsid,ctlSrc:CF.length>0?CF[0].dssid:"",autoSync:false,targetKeys:""};}for(var CI in CH){if(CH[CI]){CB[CI]=CD[CI];}}B9[CG.ctl.ctlKey]=CG.ctl;}});mstr.$A.forEach(B8,function(CC){var CB=mstr.$A.findByForm(B7,CC.key,"key");if(CC.edt&&(CB<0||!B7[CB].edt)){var CD=document.getElementById(CC.key);if(CD){mstrmojo.css.addClass(CD,"txttrx");}}});mstr.$A.forEach(B7,function(CC){var CB=mstr.$A.findByForm(B8,CC.key,"key");if(CB<0||!B8[CB].edt){var CD=document.getElementById(CC.key);if(CD){mstrmojo.css.removeClass(CD,"txttrx");}}});CA.tscObjs=B8;}B3.ddic=B9;},Bz=function(B4,B3){n.setRWStateInForm(B3.rwb);if(B1){var B2=B1.model;B2.set("trxInfo",B4.rwTxs);B2.raiseEvent({name:"trxInfoChange"});}y(B4,B3);},Bw={success:function(B4){if(!B4){mstrmojo.alert(B4.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{B0.mappingTxModel.messageID=x;B0.mappingTxModel.getNewCtlKey=function(){return microstrategy.OBJ_PREFIX+K.getNextObjId();};B0.mappingTxModel.onsave=Bz;if(Bu){var B2=B4.tscObjs,B6=(B2&&B2.length)||0,B3=B6-1;for(;B3>=0;B3--){var B7=B2[B3],B5=Bu[B7.key];if(!B5){B2.splice(B3,1);}else{B7.n=B5;}}}B0.mappingTxModel.set("rwTxs",B4);B0.mappingTxModel.nodeKey=By;B0.localTxModel.nodeKey=By.k;B0.localTxModel.messageID=x;B0.localTxModel.set("offTxs",B4);B0.localTxModel.onsave=function(B8,B9){n.setRWStateInForm(B9.rwb);};B0.open();}},failure:function(B2){mstrmojo.alert(B2.getResponseHeader("X-MSTR-TaskFailureMsg"));}},Bx={taskId:"getRWTransactions",nodeKey:By.k,messageID:x};if(By.sk){Bx.sectionKey=By.sk;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,Bw,Bx);},AP=function(){if(!window.mstrmojo||!mstrmojo.all[g]){microstrategy.mojoLoader.loadWidget({bundle:"mojo-txe.js",callback:openTE});}else{openTE();}};if(n.hasChangesToSubmit()||!!K.isModified){K.callbackOnReload=AP;n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);n.flushAndSubmitChanges();}else{AP();}break;case"transactionCondition":var K=this.parentBone.parentBone,Bd=this,n=K.updateManager,g="mstrCTE",Am=1,B=2,z=4,BP=function(x){n.setRWStateInForm(x.rwb);},At=function(){if(!mstrmojo.all[g]){mstrmojo.insert(mstrmojo.condTx.ConditionTransactionEditor);}var B6={ACTION_SELECTOR:0,TEXT_FIELD:1,TEMPLATE_UNIT_CONTROL:2},B0=mstrmojo.all[g],y=K.messageID,Bv=Bd.parentBone.selections,CC={taskId:"getRWTransactionSources",msgID:y},CD={nodeKey:true,ctlKey:true,fieldKey:true,bit:true,taskId:true,msgID:true},CF={};if(Bv.isOnlyOneGridSelected()){var B1=microstrategy.activeCXMenu,x=B1&&B1.getAttribute(microstrategy.HTMLATTR_DSS_ID),CA=microstrategy.findBone(Bv.getSelectedGrid()),B2=CA&&CA.tscObjs||[],B9=B2.length,B7,Bx=[];for(B7=0;B7<B9;++B7){var B8=B2[B7];if(B8.edt){B8.ctlKey=B8.ctl&&B8.ctl.ctlKey;Bx.push(B8);}}CF.nodeKey=Bv.getSelectionsKey()[0];CF.nodeType=B6.TEMPLATE_UNIT_CONTROL;CF.txnObjs=Bx;CF.bit=Am;}else{if(Bd.queryState("isActionSelector")){var By=Bv.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);CF.ctlKey=By.ctlKey;CF.nodeKey=By.nodeKey;CF.nodeType=B6.ACTION_SELECTOR;CF.bit=Am|z;}else{var CB=Bv.firstItem(),Bw=microstrategy.findBone(CB),Bx=(Bw&&Bw.tscObjs)||[],Bz=Bv.getSelectionsKey()[0],B3=mstr.$A.findByForm(Bx,Bz,"key"),CE=B3>-1&&Bx[B3].ctl,Bu=CE&&CE.ctlKey;CF.fieldKey=Bz;CF.nodeType=B6.TEXT_FIELD;CF.nodeKey=Bv.getTransactionUnitKey().k;CF.bit=B;if(Bu){CF.ctlKey=Bu;CF.bit|=z;}}}var B5={success:function(CG){if(!CG){mstrmojo.alert(CG.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{var CH={fieldGroups:CG.fieldGroups||[],templates:CG.templates||[],bwElements:CG.bwElements||{}};B0.onsave=BP;B0.set("messageID",y);B0.set("source",CH);B0.set("target",CF);B0.set("model",{actions:CG.exps,originNodeActionCount:CG.ntc,originCtlActionCount:CG.ctc,originFieldActionCount:CG.ftc});B0.open();}},failure:function(CG){mstrmojo.alert(CG.getResponseHeader("X-MSTR-TaskFailureMsg"));}};for(var B4 in CF){if(CD[B4]){CC[B4]=CF[B4];}}if(CF.nodeType===B6.ACTION_SELECTOR){CC.nodeKey=CC.ctlKey;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,B5,CC);},AP=function(){if(!window.mstrmojo||!mstrmojo.all[g]){microstrategy.mojoLoader.loadWidget({bundle:"mojo-ctxe.js",callback:At});}else{At();}};if(n.hasChangesToSubmit()||!!K.isModified){K.callbackOnReload=AP;n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);n.flushAndSubmitChanges();}else{AP();}break;case"docViewsEdit":var K=this.parentBone.parentBone,Bd=this,n=K.updateManager,g="mstrDVE";openDVE=function(){var y=mstrmojo.all[g],Bu=K.messageID,x={success:function(Bw){if(!Bw){mstrmojo.alert(Bw.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{y.initModel(Bw);y.model.msgID=Bu;y.open();}},failure:function(Bw){mstrmojo.alert(Bw.getResponseHeader("X-MSTR-TaskFailureMsg"));}},Bv={taskId:"getRWDocumentViews",msgID:Bu,includePreDefined:true};mstrmojo.xhr.request("POST",mstrConfig.taskURL,x,Bv);};AP=function(){if(!window.mstrmojo||!mstrmojo.all[g]){microstrategy.mojoLoader.loadWidget({scriptClass:"DocViewsEditor",id:g,bundle:"mojo-dve.js",callback:openDVE});}else{openDVE();}};if(n.hasChangesToSubmit()||!!K.isModified){K.callbackOnReload=AP;n.add([n.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);n.flushAndSubmitChanges();}else{AP();}break;default:if(Bn&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN&&Bn.exec(Au,S)){}else{if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.setFormat(Au,S,AF);this.parentBone.selections.syncUp();}}break;}return true;}catch(H){microstrategy.errors.log(H);return false;}};mstrDocCommandsImpl.syncGridWidth=function(B){if(B&&B.commands){var A=B.commands;if(A.queryState("gridMode")==microstrategy.DISPLAY_MODE_GRID&&!B.isTemplateEmpty()&&A.queryState("fittowindow")){A.exec("setColWidthsMode",mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY);if(B.colWidths){B.colWidths.syncCols();}}}};mstrDocCommandsImpl.prototype.execLink=function(G){var D;var E;var B;if(this.parentBone&&this.parentBone.selections){B=this.parentBone.selections.getItems();}if(G.ind!=null){E=G.ind-1;}else{if(B&&B[0]){E=B[0].getAttribute("ind");if(E){E=E-1;}}}if(G.id!=null){D=G.id;}else{if(B&&B[0]){D=B[0].id;}}if(D&&E!=null){var A=microstrategy.bone("rwb_viewer");var F=A.webHyperLinks[D];if(F!=null){var C=F[G.index];if(C!=null){if(C.url!=null){this.execUrlLink(C);}else{this.execDynamiclLink(C,E);}}}}};mstrDocCommandsImpl.prototype.refreshOnWindowChange=function(A,C){var B=this.parentBone.parentBone;return(C&&typeof (C.visualizationMode)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&this.parentBone.styleObj.getAttValue(A,microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&(this.parentBone.styleObj.getAttValue(A,microstrategy.HTMLATTR_DISPLAY_MODE)!=microstrategy.DISPLAY_MODE_GRID||this.parentBone.styleObj.getAttValue(A,microstrategy.HTMLATTR_QUICK_SWITCH)==microstrategy.TRUE)&&!(C.visualizationMode==50&&!B.isEditableViewModeEplus()));};mstrDocCommandsImpl.prototype.execUrlLink=function(A){try{if(A.url&&A.url.indexOf("mailto:")===0){window.open(A.url);return ;}var C=createDynamicForm(microstrategy.addCSRFTokenToURL(A.url));if(A.onw){C.target="_blank";}microstrategy.submitForm(C);return ;}catch(B){}};mstrDocCommandsImpl.prototype.execDynamiclLink=function(B,D){try{var A=B.linkXml[D];microstrategy.execDynamiclLink(B,A,B.onw);}catch(C){microstrategy.errors.log(C);}};mstrDocCommandsImpl.prototype.passToGrid=function(B,A,D){try{if(!B){return false;}B.commands.exec(A,D);return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocCommandsImpl.prototype.isSubtypedCmd=function(A){switch(A){case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.GRAPH_CTL:case microstrategy.BUTTON_CTL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:return true;default:return false;}};mstrDocCommandsImpl.prototype.queryEnabled=function(K,H){try{var E=this.parentBone.selections;var F=this.parentBone.parentBone;if(K&&K.match(/currentControl;|widget;/)){return true;}if(K&&(K.indexOf("autotext;")!=-1)){return this.queryEnabled("autotext");}switch(K){case"panelOverflowSpacingEnabled":return this.queryState("expandPanels")!=0&&this.queryState("ClipOnExport");case"enableGridFormat":return this.parentBone.parentBone.enableGridFormat;case"isUserMetricSelected":return this.isTypeSelectedInOB(microstrategy.DSSTYPE_USER_METRIC);case"isSummaryMetricSelected":return this.isTypeSelectedInOB(microstrategy.DSSTYPE_USER_SUMMARY_METRIC);case"editableViewMode":return(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE);case"edtSortRW":return !this.parentBone.parentBone.noDataset;case"docSelectedVisualization":return this.parentBone.parentBone.isVisualization;case"SupportedOrientations":case"ShowWidgetTitleBar":case"edtDocProps":case"edtPageSetup":case"selectAll":case"unit":case"visualizationsEditorRW":case"openPageSetupSectionsTab":case"openReplaceDataSetEditor":case"openSelectDatasetEditor":case"objBrowser":case"groupBy":case"grid":case"relatedReports":case"rulers":case"save":case"toggleSnap":case"shapesSubmenu":case"widgetsSubMenu":case"selectorSubMenu":case"graphSubMenu":case"buttonSubMenu":case"fontprops":case"numberprops":case"alignprops":case"colorprops":case"layoutColorTabEnabled":case"PaperType":case"PageWidth":case"PageHeight":case"PaperOrientation":case"Scaling":case"ScalePercentage":case"ScalePagesWide":case"ScalePagesTall":case"ScalePageHeaderFooter":case"SectionHorizontalOverflow":case"MarginLeft":case"MarginTop":case"MarginRight":case"MarginBottom":case"minimumPrintArea":case"LayoutFillColor":case"LayoutBorderStyle":case"LayoutAllStyle":case"LayoutAllColor":case"LayoutLeftStyle":case"LayoutLeftColor":case"LayoutTopStyle":case"LayoutTopColor":case"LayoutRightStyle":case"LayoutRightColor":case"LayoutBottomStyle":case"LayoutBottomColor":case"VisibleSections":case"EnableIncFetch":case"IncFetchLevel":case"IncFetchBlockSize":case"allowRemoveExtraColumn":case"showDisplayModes":case"DefaultGridStyle":case"AvailableViewModes":case"AvailableExportModes":case"DefaultViewMode":case"ExecutionFullScreenMode":case"ShowingBarsTemporarily":case"DefaultSelectorsAsFilter":case"PreserveTranslations":case"ShowFloatingToolbars":case"CtlAutoSubmit":case"Autowire":case"AppliedAutowire":case"CalculateDocWidth":case"ShowConditionalFormatting":case"DefaultPageByExportMode":case"ExportRange":case"ExcelGraphFormat":case"EmbeddedFonts":case"MobileDataView":case"UseOneSheetPerLayout":case"UseOneSheetPerGroupElement":case"PromptUserForPagebyExport":case"ExcelEmbedImages":case"IncludeBookmarks":case"ShowBookmarks":case"EmbedFonts":case"GraphFormat":case"GraphQualityDPI":case"isMultiLayout":case"multiLayoutMode":case"EnableToc":case"TOCTitle":case"TOCFontName":case"TOCFontBoldItalic":case"TOCFontSize":case"TOCFontStrikeout":case"TOCFontUnderline":case"TOCFontColor":case"TabLeader":case"WatermarkType":case"WatermarkText":case"WatermarkFontName":case"WatermarkFontBoldItalic":case"WatermarkFontSize":case"WatermarkFontStrikeout":case"WatermarkFontUnderline":case"WatermarkFontColor":case"AutoFontSize":case"TextWashout":case"TextOrientation":case"ImageSource":case"ImageScale":case"ShowTabsForSingleLayout":case"RemoveNullGroups":case"RemoveMissingUnits":case"SingleSourceGrid":case"RWLevelMCEJoin":case"TrimNoSectionData":case"incrFetchEnabled":case"FitPDFContentHeight":case"DisplayPageByBar":case"DisplayRePromptIcon":case"UseAsInfoWindow":case"incrFetchBlockCount":case"incrFetchLevels":case"PreLoadAllPanels":case"PSPreLoadAllPanels":case"gridIfEnabled":case"gridIfMaxRows":case"gridIfRowMode":case"layoutBarStyle":case"layoutBarPosition":case"enableGraphTooltips":case"UseAsInformationWindow":case"InformationWindowPlacement":case"InfoWindowMode":case"TabCloseToDismissInfoWindow":case"TextCopyMode":case"GridCellCopyMode":case"EnableHorizontalSwipeToChange":case"SwipePanelStyle":case"fpAutoSubmit":case"isFilterPanel":case"EnableExport":case"ExcelExportDocumentURL":case"PDFExportDocumentURL":case"TOCFillColor":case"TOCTitleAlignment":case"TOCTitleFontName":case"TOCTitleFontBoldItalic":case"TOCTitleFontSize":case"TOCTitleFontUnderline":case"TOCTitleFontStrikeout":case"TOCTitleFontColor":case"TOCTitleFillColor":case"TOCTitleEnableInherit":case"TOCLeftIndent":case"TOCRightIndent":case"TOCBorderStyle":case"TOCBorderColor":case"TOCBorderWeight":case"TOCTitleSetEnable":case"TOCBorderStyleEnable":case"cursor":case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|0":case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|1":case microstrategy.GRAPH_CTL:case microstrategy.BUTTON_CTL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|FP":case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|TC":case microstrategy.SUBOBJTYPE_DOC_TEXT:case"IncludePageHeaderFooter":case"docViewsEdit":case"EnableZoom":case"ApplyGBToAllLayouts":case"RefreshDocument":case"RefreshFrequency":case"EnableCopyForText":case"EnableCopyForGridCell":case"DocumentThemeColor":case"EnableSwipingToSwitchLayout":case"SetBadgeToValueOnField":case"isNavigationDocument":case"SmartClientDoc":case"OfflineOnCube":case"ShowOfflineUCOnCubeConfig":case"MakePrivate":case"KeepControlTargetsConsistent":return true;case"pageTabEnabled":case"marginTabEnabled":case"layoutMobileTabEnabled":case"incrFetchTabEnabled":case"documentTabEnabled":case"exportTabEnabled":case"tocTabEnabled":case"docMobileTabEnabled":case"docAdvTabEnabled":case"deliveryTabEnabled":return !F.IsNavigationDocument;case"InfoWindowPositionEnabled":return this.queryState("UseAsInformationWindow")&&(this.queryState("InfoWindowMode")==4);case"ViewModeInteractivityLevel":return this.queryState("ShowFloatingToolbars");case"lock":return this.parentBone.currentControl!="cursor";case"DataFilterModeEnabled":var Q=this.queryState("EditSelectorSource"+(this.queryState("isMetricQualifier")?"Metrics":(this.queryState("isDDIC")?"DDIC":"")));Q=Q&&Q.split("|");return(Q&&Q.length>2&&Q[1]==microstrategy.DSSTYPE_ATTRIBUTE)||this.queryState("IsSelectorSourceNDE");case"watermarkTabEnabled":return F.AllowWatermark&&!F.IsNavigationDocument;case"layoutLayoutTabEnabled":return(this.parentBone.parentBone.isMultiLayout||this.queryState("ShowTabsForSingleLayout"))&&!F.IsNavigationDocument;case"layoutIncTabEnabled":return false;case"selectorTabTitle":return true;case"BeforeLayout":case"visualizationsEditorRWLayout":return this.parentBone.parentBone.isMultiLayout;}if(!E){return false;}if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(K)){if(!E||!E.isOnlyOneGridSelected()){return false;}var y=microstrategy.findBone(E.getSelectedGrid());y=(y instanceof mstrReportGraphImpl)?y:microstrategy.bone(y.id+"_graph");return(y&&y.commands)?y.commands.queryEnabled(K):false;}switch(K){case"editSelector":if(E.isActive()&&!E.isMulti()&&E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEMPLATE)){var R=microstrategy.findBone(E.firstItem());return(R&&R.commands&&R.commands.queryEnabled(K));}return false;case"isNotLinkedGrid":case"isNotLinkedGridOrNoGrid":case"isNotLinkedGraph":if(!this.queryEnabled(K.indexOf("Grid")!=-1?"onegrid":"onegraph")){return true;}var y=microstrategy.findBone(E.getSelectedGrid());return(y&&y.commands&&!y.commands.queryState("isLinkedTemplate"));case"gradientcolor":return true;case"isSelectionsPresent":return true;case"deleteq":if(F.IsNavigationDocument){var P=E.length&&microstrategy.findBone(mstr.$H.firstItem(E.items));if(P&&P.isNavigationBar){return false;}}case"copyq":case"copy":case"cutq":case"cut":case"delete":case"duplicate":case"objalign":case"alignGrid":case"objsize":case"sizeToGrid":case"controlIsSelected":return(E.isActive()&&E.isVisible&&E.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_DOC_SUBSECTION);case"setCtrlDft":return(E.isOnlyOneCtrlDftObjSelected())&&!this.queryState("isButton")&&!E.atLeastOneTableSelected();case"applyCtrlDft":return(E.atLeastOneCtrlDftObjSelected())&&!this.queryState("isButton")&&!E.atLeastOneTableSelected();case"advformatmenu":return(E.isActive()&&E.isVisible);case"imgready":return(E.isActive())?E.isImageReady():false;case"oneNonLinkedGrid":return this.queryEnabled("onegrid")&&!this.queryEnabled("isLinkedGrid");case"graphMode":case"gridGraphMode":case"gridMode":case"graphMode":case"gridGraphMode":case"onegrid":return(E.isActive())?E.isOnlyOneGridSelected():false;case"oneTable":return(E.isActive())?E.isOnlyOneTableSelected():false;case"onepanelstack":return(E.isActive())?E.isOnlyOnePanelStackSelected():false;case"allpanelstack":return(E.isActive())?E.areAllSelectedPanelStacks():false;case"panelstackselected":return(E.isActive())?E.isPanelStackSelected():false;case"emptytemplate":return(E.isActive())?E.isEmptyTemplateSelected():false;case"onepanel":var I=this.queryEnabled("onepanelstack");var Q=microstrategy.activeCXMenu;if(Q&&Q.clickedElement){if(Q.clickedElement.className&&Q.clickedElement.className.indexOf("title_")>=0){I=false;}}return I;case"onegraph":return(E.isActive())?E.isOnlyOneGraphSelected():false;case"oneggrid":return(E.isActive())?E.isOnlyOneGGridSelected():false;case"roundShapesOnly":return(E.isActive())?E.isOnlyRoundedRectanglesSelected():false;case"shapesOnly":return(E.isActive())?E.isOnlyRectanglesSelected():false;case"squareShapesOnly":return(E.isActive())?E.isOnlySquareRectanglesSelected():false;case"anyrectangle":return(E.isActive())?E.atLeastOneRectangleSelected():false;case"anyRoundedRectangle":return(E.isActive())?E.atLeastOneRoundedRectangleSelected():false;case"anycontrol":return(E.isActive())?E.atLeastOneControlSelected():false;case"onecontrol":return(E.isActive())?E.atLeastOneControlSelected()&&!E.isMulti():false;case"fmtGridCells":case"oneggridfmt":return microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.queryEnabled("oneggrid")&&!this.queryEnabled("isLinkedGrid")&&!this.queryEnabled("emptytemplate");case"openFormatGraph":case"onegraphfmt":return microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.queryEnabled("onegraph")&&!this.queryEnabled("isLinkedGrid")&&!this.queryEnabled("emptytemplate");case"multiselect":return(E.isMulti());case"objalign2":case"objsize2":return(E.isActive());case"toTallest":case"toShortest":return(E.length-E.nubmerOfLinesSelected(microstrategy.ORIENTATION_HORIZONTAL)>1);case"toWidest":case"toNarrowest":return(E.length-E.nubmerOfLinesSelected(microstrategy.ORIENTATION_VERTICAL)>1);case"Name":case"ToolTip":case"Link":case"IsLink":case"NewWin":case"Visible":case"VisibleHTML":case"LineOrientation":case"Source":case"Left":case"Locked":case"Top":case"Wmode":case"Width":case"LockAspectRatio":case"Length":case"Lmode":case"borderStyle":case"IsPortal":case"PortalState":case"PortalTitle":case"TitleBarDisplay":case"TopCornersOnly":case"HasDropShadow":case"DropShadow":case"HasRoundedCorners":case"HasAlpha":case"HTMLType":case"IFrameSource":case"ShowElementCount":case"ExportOptions":return microstrategy.isEnabled(E.isVisible&&E.items,this.qeMap[K]);case"Wmode11":case"Wmode12":case"Wmode13":return this.queryEnabled("Wmode");case"Hmode11":case"Hmode12":case"Hmode13":return this.queryEnabled("Hmode");case"Wmode0":case"Hmode0":return this.queryEnabled(K.substr(0,5));case"Wmode1":case"Hmode1":var J=this.queryEnabled(K.substr(0,5));if(J){return E.atLeastOneSubtypeSelected([101]);}return false;case"Wmode2":var J=this.queryEnabled(K.substr(0,5));if(J){var A=this.parentBone.selections.getSelectedGrid();if(A){var P=microstrategy.findBone(A);return(P&&!P.isGraph);}}return false;case"Hmode2":var J=this.queryEnabled(K.substr(0,5));if(J){return E.atLeastOneSubtypeSelected([106,111])||this.queryEnabled("Wmode2");}return false;case"Hmode":case"Height":if(microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){return microstrategy.isEnabled(E.isVisible&&E.items,this.qeMap[K]);}else{var A;if(!(A=this.parentBone.selections.getSelectedGrid())){A=this.parentBone.selections.getSelectedPanelStack();}if(A){var P=microstrategy.findBone(A);return P.commands.queryEnabled(K);}return true;}case"backgroundColor":if(E.isOnlyOneGridSelected()){oGrid=this.parentBone.selections.getSelectedGrid();W=microstrategy.findBone(oGrid);if(W.gridUnitFormat==microstrategy.GRID_BORDERS){return false;}}case"fontWeight":case"fontStyle":case"textDecoration":case"TextDirection":case"fontFamily":case"fontSize":case"textAlign":case"Format":return microstrategy.isEnabled(E.isVisible&&E.items,K);case"TextDirectionGrid":return microstrategy.isEnabled(E.isVisible&&E.items,"TextDirection");case"borderLeftColor":var z=this.queryState("enabled3d");var D=(z>0);return !D&&microstrategy.isEnabled(E.isVisible&&E.items,K);case"color":return microstrategy.isEnabled(E.isVisible&&E.items,K);case"lineColor":case"borderLeftStyle":case"lineStyle":var z=this.queryState("enabled3d");var D=(z>0);if(this.queryEnabled("onepanelstack")){return !D&&microstrategy.findBone(this.queryState("selectedPanelStack")).commands.queryEnabled(K);}else{if(this.queryEnabled("onegrid")){return !D&&microstrategy.findBone(this.queryState("selectedGrid")).commands.queryEnabled(K);}else{return !D&&microstrategy.isEnabled(E.isVisible&&E.items,K)&&!this.queryEnabled("roundShapesOnly");}}case"AutoResize":case"SubWidth":case"ShrinkHorizontal":case"GrowHorizontal":case"MaxHeightWidth":case"SubHeight":case"Shrink":case"Grow":case"HideIfEmpty":case"MaxHeight":case"FitExcelRowHeight":case"Keep":case"Repeat":case"RepeatHoriz":case"NewPage":case"autotext":return(E.isActive()&&!E.isMulti());case"borders":if(!E.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(E.isOnlyOneGridSelected()){W=microstrategy.findBone(E.getSelectedGrid());if(W&&W.graphSelected){return false;}if(!E.isGridContainerSelected()||E.gridValueFormatX==1){return W&&W.commands.queryEnabled(K);}}if(E.isOnlyOnePanelStackSelected()){return(E.panelValueFormat!=1);}return(this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_IMAGE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER]));case"setSectionDefaults":return(E.isActive()&&!E.isMulti()&&(E.getFirstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION));case"setCtrlDefaults":return(E.isActive()&&!E.isMulti()&&(E.getFirstObjType()==microstrategy.OBJTYPE_DOC_OBJECT)||(E.getFirstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION));case"links":if(E.isActive()&&!E.isMulti()&&(E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_IMAGE)||E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT))){var a=null;var O=this.parentBone.selections.getItems();if(O&&O[0]){a=O[0].id;}if(a){var c=microstrategy.bone("rwb_viewer");var S=c.webHyperLinks[a];return(S!=null);}}return false;case"WebHyperLinkEditor":case"showWebHyperLinkEditor":if(E.isActive()&&!E.isMulti()){if(E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_IMAGE)||(E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)&&!this.queryState("isButton"))){return true;}else{if(E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEMPLATE)){var R=microstrategy.findBone(E.firstItem());return(R&&R.commands&&R.commands.queryEnabled(K));}}}return false;case"FilterDetailsProperties":return((E.length==0)||(E.isActive()&&!E.isMulti()&&E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)))&&!this.queryState("isButton");case"ShowFilterDetailsProperties":return !this.queryState("isButton");case"SubType":return true;case"saveAsTheme":case"applyTheme":return true;case"pasteFormat":if(E.isActive()&&E.objCache.copyBuffer!=null&&E.objCache.copyBuffer.length==1){var U=E.firstItem();return(U.getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_DOC_SUBSECTION&&U.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_TEMPLATE)&&!this.queryState("isButton");}return false;case"paste":return(E.objCache.copyBuffer!=null&&E.objCache.copyBuffer.length>0);case"edtProps":return E.enablePropertiesEditor();case"subSectionIsSelected":return(E.isActive()&&(E.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION)||(E.length>0&&E.isSameSubSection()));case"ssRuler":if(!this.queryEnabled("subSectionIsSelected")){return false;}var AA=microstrategy.findBone(E.firstItem());return(AA&&AA.subsectionType==mstrSubSection.TYPE_FIXED);case"insertSectionAbove":case"insertSectionBelow":case"mngSections":if(this.queryEnabled("subSectionIsSelected")){var V=microstrategy.findBone(E.firstItem());return(V&&V.subsectionType==mstrSubSection.TYPE_FIXED&&V.parentBone&&!V.parentBone.isDetails&&!V.isHorizontal);}return false;case"mngHorizontalSections":if(this.queryEnabled("subSectionIsSelected")){var V=microstrategy.findBone(this.parentBone.selections.firstItem()).parentBone;if(V!=null){return !V.isDetails&&V.isHorizontal;}}return false;case"edtDMetric":var W=microstrategy.findBone(E.getSelectedGrid());if(W&&!W.isFeatureAvailable(microstrategy.FEATURE_INSERT_NEW_METRIC)){return false;}case"edtRename":var e=microstrategy.bone("reportObjs_RWWorkingSetStyle");y=microstrategy.findBone(E.getSelectedGrid());var B=y&&y.commands.queryState("gridType")!="flash";return(B&&E.isGridSelected()&&(!E.isEmptyTemplateSelected())&&!this.queryEnabled("isLinkedGrid"))||(e&&e.selections&&e.selections.isActive());case"vfeRWGrid":return E.isActive()&&E.isOnlyOneGridSelected()&&(!F.noDataset)&&!this.queryEnabled("isLinkedGrid");case"vfeRWView":if(this.queryEnabled("vfeRWGrid")&&E&&E.isOnlyOneGridSelected()){var W=microstrategy.findBone(E.getSelectedGrid());return(W&&W.commands)?W.commands.queryEnabled(K):false;}else{return false;}case"edtSort":var W=microstrategy.findBone(E.getSelectedGrid());return(this.queryEnabled("vfeRWGrid")&&W&&W.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE))||this.queryEnabled("edtSortRW");case"deleteSubsection":if(this.queryEnabled("subSectionIsSelected")){var m=microstrategy.findAncestorWithAtt(E.firstItem(),microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION);var AA=microstrategy.findBone(m);return(AA&&AA.getSubsectionCount()>1);}return false;case"groupProp":var G=this.parentBone.selections.getSelectedSubsection();if(G){return G.parentBone.groupID!=null;}return false;break;case"isSubsectionHorizontal":var G=this.parentBone.selections.getSelectedSubsection();if(G){return G.isHorizontal;}return false;break;case"showOrderCtxMenu":if(E.isActive()&&!E.isMulti()){var U=E.firstItem();if(U.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return false;}var m=microstrategy.findAncestorWithAtt(U,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);return(m&&m.childNodes.length>1);}return false;case"hasmetrics":case"comboToggleButton":case"tsubtotals":case"visualizationsEditor":case"visualizationMode":case"quickThresholds":case"openAdvThresholdEditor":case"edtSubtotalsOldIServer":case"addQuickTotals":case"edtSortGridMenu":case"edtSortGrid":case"graphZones":case"gridMode":case"isLinkedGrid":case"visFlashMode":case"visAjaxMode":case"toggleHideNullsOrZeros":if(E&&E.isOnlyOneGridSelected()){var W=microstrategy.findBone(E.getSelectedGrid());return(W&&W.commands)?W.commands.queryEnabled(K):false;}else{return false;}case"showInsertFunction":return(!this.parentBone.parentBone.noDataset&&!E.isMulti());case"insertFunctionVisible":return !this.queryState("isButton");case"openConditionalFormattingForHiddenSections":if(!E||E.isActive()){return false;}if(!F.isEditableViewModeEplus()){return false;}return(F.documentHasMetrics)?F.documentHasMetrics:false;case"openBasicConditionalFormatting":case"openAdvConditionalFormatting":if(!E||!F.isEditableViewModeEplus()){return false;}if(!E.isActive()||E.isMulti()){return false;}var U=E.firstItem();var AB=U.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(AB==null){AB=U.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}switch(AB){case microstrategy.SUBOBJTYPE_DOC_TEXT:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:return !F.noDataset;case microstrategy.OBJTYPE_DOC_SUBSECTION:if(U.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)==microstrategy.TRUE){return false;}return !F.noDataset;default:return false;}case"showDrillSubmenu":var U=E.firstItem();return(U&&microstrategy.styleObj.getAttValue(E.firstItem(),microstrategy.HTMLATTR_OBJINDEX)!=null);case"showDrillPaths":var U=E.firstItem();return(U&&v.indexOf(U.getAttribute("id")+"|"+U.getAttribute(microstrategy.HTMLATTR_OBJINDEX))>-1);case"showLinkPaths":return !!(E.items[H]);case"edtSubtotals":case"edtResize":case"swapAxes":case"autostyle":case"tbanding":case"tOutline":case"ShowThreshold":case"toggleattforms":case"checkMergeColHeader":case"checkMergeRowHeader":case"checkLockColHeader":case"checkLockRowHeader":case"fittocontent":case"fittowindow":case"graphEditor":case"gridEditor":if(!E.isOnlyOneGridSelected()){return false;}var h=microstrategy.findBone(E.firstItem());return(h&&h.commands&&h.commands.queryEnabled(K));case"openSimpleThresholdEditor":case"openAdvThresholdEditor":if(!E.isOnlyOneGridSelected()){return false;}var h=microstrategy.findBone(E.firstItem());return(h&&h.commands&&h.commands.queryEnabled(K)&&!this.queryEnabled("isLinkedGrid"));case"autoArrange":if(this.parentBone.selections&&this.parentBone.selections.isOnlyOneGridSelected()){var W=microstrategy.findBone(this.parentBone.selections.getSelectedGrid());if(W&&W.isGraph){var Y=microstrategy.bone(W.id+"_gb");return(Y)?!Y.autoArrange:true;}else{return false;}}else{return false;}break;case"generalTabEnabled":case"layoutSectionsTabEnabled":return F.isEditableViewModeEplus()&&!F.IsNavigationDocument;case"layoutTabEnabled":return F.isEditableViewModeEplus()&&!this.queryState("isNavBar")&&!E.isItemInsideNavBar();case"buttonTabEnabled":return this.queryState("onlyButtons");case"themeTabEnabled":return !E.isMulti();case"colorTabEnabled":if(this.queryState("appliedLinkedTheme")){return false;}if(this.queryState("isButton")){var T=E.getSelectedButtons();for(var AA in T){if(microstrategy.styleObj.getAttValue(T[AA],microstrategy.HTMLATTR_DISPLAY_STYLE)==microstrategy.BUTTON_STYLE_CUSTOM){return false;}}}return this.parentBone.parentBone.gridGraphFormatting&&!E.isItemInsideNavBar();case"fontTabEnabled":if(this.queryState("appliedLinkedTheme")){return false;}if(E.isOnlyOnePanelStackSelected()){return E.isOnlyOneTableSelected()?true:this.queryState("IsPortal");}else{if(this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE])){return this.queryState("IsPortal")||this.queryEnabled("fontAndAlignmentEnabled");}else{if(this.queryState("isButton")){var T=E.getSelectedButtons();for(var AA in T){var M=microstrategy.styleObj.getAttValue(T[AA],microstrategy.HTMLATTR_DISPLAY_STYLE);if(M==microstrategy.BUTTON_STYLE_ICON_ONLY||M==microstrategy.BUTTON_STYLE_CUSTOM){return false;}}}if(E.isItemInsideNavBar()){return false;}return((this.parentBone.parentBone.gridGraphFormatting&&this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]))||this.queryEnabled("fontAndAlignmentEnabled"));}}case"fontAndAlignmentEnabled":var C=this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER]);return(C||this.queryEnabled("showGridFormatTabs"))&&this.parentBone.parentBone.gridGraphFormatting;case"alignmentTabEnabled":return !this.queryState("appliedLinkedTheme")&&this.queryEnabled("fontAndAlignmentEnabled")&&!this.queryState("isButton");case"numberTabEnabled":return(!this.queryState("appliedLinkedTheme")&&(this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT])||this.queryEnabled("showGridFormatTabs"))&&mstr.behaviors.featureResolver.featAvailable("number-formatting")&&!this.queryState("isButton"));case"imageTabEnabled":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_IMAGE]);case"lineTabEnabled":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"gridTabEnabled":return E.isOnlyOneGridSelected();case"advancedTabEnabled":return F.isEditableViewModeEplus()&&(E.isOnlyOneGridSelected()||E.isOnlyOnePanelStackSelected()||E.isOnlyOneSelectorCtrlSelected())&&!this.queryState("isNavBar")&&!E.atLeastOneTableSelected();case"flashTabEnabled":return F.isEditableViewModeEplus()&&(this.queryEnabled("gridTabEnabled")||this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]));case"widgetTabEnabled":return F.isEditableViewModeEplus()&&(this.queryEnabled("gridTabEnabled"));case"selectorTabEnabled":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL])||E.isOnlyOneTableSelected()||this.queryState("isDDIC");case"effectsTabEnabled":return !this.queryState("appliedLinkedTheme")&&F.isEditableViewModeEplus()&&!this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_SUBSECTION])&&this.parentBone.parentBone.gridGraphFormatting&&!this.queryState("isButton")&&!this.queryState("isNavBar")&&!E.atLeastOneTableSelected();case"showGridFormatTabs":return(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE])&&this.queryEnabled("enableGridFormat")&&this.queryState("isOneGrid")&&E.getSelectedGrid()&&microstrategy.findBone(E.getSelectedGrid()).isGrid&&!this.queryEnabled("isLinkedGrid"));case"showGridSelectors":return(this.queryEnabled("showGridFormatTabs")&&this.queryState("isOneGrid"));case"showPanelSelector":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK])&&!this.queryState("isNavBar");case"Autostyle":if(!E.isOnlyOneGridSelected()){return false;}var h=microstrategy.findBone(E.firstItem());return(h&&h.commands&&h.commands.queryEnabled("autostyle"));case"AllStyle":case"AllColor":case"LeftStyle":case"LeftColor":case"RightStyle":case"RightColor":case"TopStyle":case"TopColor":case"BottomStyle":case"BottomColor":return !this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_SUBSECTION]);case"RwdUnits":return this.queryEnabled("isNotLinkedGraph");case"tbValueSelector":if(this.queryEnabled("onepanelstack")){return(this.queryState("IsPortal")&&E.panelUnitFormat!=1);}case"tbGridValueSelector":if(E.getSelectedGridProperty("isGraph")){return true;}switch(parseInt(E.gridUnitFormatX,10)){case microstrategy.GRID_UNIT_CONTAINER:return this.queryState("IsPortal");case microstrategy.GRID_BORDERS:return false;default:return true;}case"Bold":case"Italic":case"Underline":case"FontFamily":case"FontSize":case"TextAlign":case"GridHorizontal":case"FontColor":case"Currency":case"IntlCurrency":case"Percent":case"Comma":case"IncreaseDecimal":case"DecreaseDecimal":if(!E.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(!this.parentBone.selections.getSelectedGridProperty("graphSelected")){var q=("|FontFamily|FontSize|Bold|Italic|Underline|TextAlign|GridHorizontal|FontColor|".indexOf("|"+K+"|")>-1);var L=[microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT];if(q){L.push(microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER);if(K!="TextAlign"&&K!="GridHorizontal"){L.push(microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);}}if(this.ensureSelectedObjectTypes(L)){return true;}var o="|FontFamily|FontSize|Bold|Italic|Underline|FontColor|";if(E.isOnlyOnePanelStackSelected()){if(E.panelValueFormat==0){return false;}return(o.indexOf("|"+K+"|")>-1);}if(E.isOnlyOneGridSelected()){if(E.gridUnitFormatX==microstrategy.GRID_BORDERS){return false;}if(E.isGridContainerSelected()){if(E.gridValueFormatX==1){return false;}return((o+"TextAlign|").indexOf("|"+K+"|")>-1);}else{if(q&&!this.queryState("areGridFormatsReady")){return false;}}}else{if(E.isMulti()&&!!E.getSelectedGrid()){return((o+"TextAlign|Currency|IntlCurrency|Percent|Comma|IncreaseDecimal|DecreaseDecimal|").indexOf("|"+K+"|")==-1);}}}W=microstrategy.findBone(E.getSelectedGrid());if(!W){return false;}return W.commands.queryEnabled(K,H);case"FillColor":if(!E.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(E.isOnlyOneGridSelected()){if(E.isGridContainerSelected()){return true;}W=microstrategy.findBone(E.getSelectedGrid());if(!W){return false;}return W.commands.queryEnabled(K,H);}return(!this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]));case"showFlashOnlyForSelector":case"showFlashOnlyForFillColorSelector":return true;case"Borders":return(E.isActive()&&!this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_SUBSECTION]));case"lnstyle":case"lncolor":if(!E.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_SUBSECTION])||this.queryState("enabled3d")){return false;}if(E.isOnlyOneGridSelected()){W=microstrategy.findBone(E.getSelectedGrid());if(W&&W.graphSelected&&W.isGraph){return W.commands.queryEnabled(K,H);}switch(parseInt(E.gridUnitFormatX,10)){case microstrategy.GRID_UNIT_CONTAINER:return(E.gridValueFormatX!=2);case microstrategy.GRID_BORDERS:return true;default:if(!W){return false;}return W.commands.queryEnabled(K,H);}}if(E.isOnlyOnePanelStackSelected()){return(E.panelValueFormat!=1);}return true;case"AlignLeft":case"AlignCenter":case"AlignRight":return E.isMulti()&&(E.isSameSubSection()||!E.hasHorizSections());case"AlignTop":case"AlignMiddle":case"AlignBottom":return E.isMulti()&&(E.isSameSubSection()||E.hasHorizSections(true));case"DistHoriz":return E.length>2&&(E.isSameSubSection()||!E.hasHorizSections());case"DistVert":return E.length>2&&(E.isSameSubSection()||E.hasHorizSections(true));case"back":case"front":case"oneBack":case"oneFront":var Z=this.queryState("selectedSection");return(E.isActive()&&!E.isMulti()&&E.getFirstObjType()!=microstrategy.OBJTYPE_DOC_SUBSECTION&&Z&&Z.childNodes&&Z.childNodes.length>1);case"b3dstyle":case"b3dweight":case"enabled3d":var X=E.nubmerOfLinesSelected(microstrategy.ORIENTATION_HORIZONTAL)+E.nubmerOfLinesSelected(microstrategy.ORIENTATION_VERTICAL);if(E.length==X){return false;}return E.isActive();case"Transparency":case"Blur":return microstrategy.isEnabled(E.isVisible&&E.items,"Transparency");case"gridSelectedVisualization":if(!E||!E.isOnlyOneGridSelected()){return false;}var y=microstrategy.findBone(E.getSelectedGrid());return(y&&y.commands)?y.commands.queryEnabled("selectedVisualization"):false;case"transactionEdit":return(E.getTransactionUnitKey()!=null&&!this.queryState("isButton"))||E.isOnlyOneTableSelected();case"transactionCondition":if(E&&E.isOnlyOneGridSelected()){var y=microstrategy.findBone(E.getSelectedGrid()),n=y&&y.tscObjs||[],N=n.length,u;for(u=0;u<N;++u){if(n[u].edt){return true;}}return false;}return(E.getTransactionUnitKey()!=null&&!this.queryState("isButton")&&!E.isOnlyOneGridSelected())||this.queryState("isActionSelector");case"DisplayInPartialScreen":case"InitialSlidingInWidth":case"InitialSlidingInHeight":case"ShowAsCollapsiblePanel":return microstrategy.isEnabled(E.isVisible&&E.items,K);case"activeSelections":default:return E.isActive();}}catch(x){microstrategy.errors.log(x);return false;}};mstrDocCommandsImpl.prototype.queryState=function(BI,AO){try{var Bo=null;var AB=null;var AW=null;var BB=this.parentBone.parentBone;var Af,CD;var At=BI.split(";");if(At.length==2&&At[0]=="tc"){var Aw=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());return Aw&&Aw.queryState&&Aw.queryState(At[1]);}var u=function(CN,CM){var CO=parseInt(CN.panelUnitFormat),g=parseInt(CN.panelValueFormat);if(CM=="font"){if(CO<2||CO>3){CN.panelUnitFormat=2;}if(CO==2){CN.panelValueFormat=1;}if(CO==3&&(g<1||g>3)){CN.panelValueFormat=1;}}else{if(CM=="color"){CN.panelUnitFormat=0;CN.panelValueFormat=0;}}};switch(BI){case"showEditorSelector":return !this.queryState("isNavBar");case"controlInclude":var B8=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());return B8.include;case"allowRemoveExtraColumn":return this.parentBone.parentBone.isFeatureAvailable("grid-layout");case"objBrowser":Bo=microstrategy.bone("reportObjs_RWWorkingSetStyle");return(Bo&&isInDocument(Bo.elem));case"groupBy":Bo=microstrategy.bone("pbb_GroupByStyle");return(Bo&&isInDocument(Bo.elem));case"relatedReports":Bo=microstrategy.bone("relatedReports");return(Bo&&isInDocument(Bo.elem));case"grid":return this.parentBone.gridOn;case"rulers":return this.parentBone.rulerOn;case"panelTb":return(this.parentBone.currentControl=="cursor");case"PageWidth":case"PageHeight":case"MarginLeft":case"MarginTop":case"MarginRight":case"MarginBottom":case"minimumPrintArea":CD=(this.parentBone.docPropsMap[BI]&&this.parentBone.docPropsMap[BI].l)||BI;return microstrategy.number.toUserUnits(BB[CD]);case"Autowire":case"CtlAutoSubmit":CD=(this.parentBone.docPropsMap[BI]&&this.parentBone.docPropsMap[BI].l)||BI;return BB[CD];case"ScalePagesWide":case"ScalePagesTall":var BY=BB[BI];if(BY==0||BY=="0"){BY="";}return BY;case"PaperType":case"PaperOrientation":case"Scaling":case"ScalePercentage":case"ScalePageHeaderFooter":case"SectionHorizontalOverflow":case"LayoutFillColor":case"LayoutLeftStyle":case"LayoutLeftColor":case"LayoutTopStyle":case"LayoutTopColor":case"LayoutRightStyle":case"LayoutRightColor":case"LayoutBottomStyle":case"LayoutBottomColor":case"RenderConditionalFormatting":case"DefaultGridStyle":case"showDisplayModes":case"ExecutionFullScreenMode":case"ShowingBarsTemporarily":case"DefaultSelectorsAsFilter":case"PreserveTranslations":case"ShowFloatingToolbars":case"ViewModeInteractivityLevel":case"CalculateDocWidth":case"DefaultViewMode":case"DefaultPageByExportMode":case"ExportRange":case"ExcelGraphFormat":case"EmbeddedFonts":case"MobileDataView":case"UseOneSheetPerLayout":case"UseOneSheetPerGroupElement":case"PromptUserForPagebyExport":case"ExcelEmbedImages":case"IncludeBookmarks":case"ShowBookmarks":case"EmbedFonts":case"GraphFormat":case"GraphQualityDPI":case"isMultiLayout":case"multiLayoutMode":case"EnableToc":case"BeforeLayout":case"BeforeLayoutItems":case"TOCTitle":case"TabLeader":case"TOCFontName":case"TOCFontSize":case"TOCFontStrikeout":case"TOCFontUnderline":case"TOCFontColor":case"WatermarkType":case"WatermarkText":case"WatermarkFontName":case"WatermarkFontSize":case"WatermarkFontStrikeout":case"WatermarkFontUnderline":case"WatermarkFontColor":case"AutoFontSize":case"TextWashout":case"TextOrientation":case"ImageSource":case"ImageScale":case"ShowTabsForSingleLayout":case"RemoveNullGroups":case"RemoveMissingUnits":case"SingleSourceGrid":case"RWLevelMCEJoin":case"TrimNoSectionData":case"PreLoadAllPanels":case"SupportedOrientations":case"FitPDFContentHeight":case"DisplayPageByBar":case"DisplayRePromptIcon":case"UseAsInfoWindow":case"layoutBarStyle":case"layoutBarPosition":case"enableGraphTooltips":case"IncludePageHeaderFooter":case"EnableExport":case"ExcelExportDocumentURL":case"PDFExportDocumentURL":case"EnableZoom":case"DocumentThemeColor":case"EnableSwipingToSwitchLayout":case"EnableInherit":case"TOCFillColor":case"TOCTitleAlignment":case"TOCTitleFontName":case"TOCTitleFontSize":case"TOCTitleFontUnderline":case"TOCTitleFontStrikeout":case"TOCTitleFontColor":case"TOCTitleFillColor":case"TOCTitleEnableInherit":case"TOCLeftIndent":case"TOCRightIndent":case"TOCBorderStyle":case"TOCBorderColor":case"TOCBorderWeight":case"EnableCopyForText":case"EnableCopyForGridCell":case"SmartClientDoc":case"OfflineOnCube":case"ShowOfflineUCOnCubeConfig":case"KeepControlTargetsConsistent":return BB[BI];case"isNavigationDocument":return !!BB.IsNavigationDocument;case"RefreshDocument":return BB[BI]!=undefined?BB[BI]:BB.RefreshFrequency>=1;case"RefreshFrequency":var As=BB[BI];return As>1?As:(As==-1?30:As);case"ApplyGBToAllLayouts":return BB[BI]==2;case"WatermarkFontBoldItalic":var Bv=0;if(BB.WatermarkFontBold){Bv+=1;}if(BB.WatermarkFontItalic){Bv+=2;}return Bv;case"TOCFontBoldItalic":var Bv=0;if(BB.TOCFontBold){Bv+=1;}if(BB.TOCFontItalic){Bv+=2;}return Bv;case"TOCTitleFontBoldItalic":var Bv=0;if(BB.TOCTitleFontBold){Bv+=1;}if(BB.TOCTitleFontItalic){Bv+=2;}return Bv;case"TOCTitleSetEnable":return this.queryState("EnableToc")&&(!(this.queryState("TOCTitleEnableInherit")));case"TOCBorderStyleEnable":return this.queryState("EnableToc")&&(BB.TOCBorderStyle!="0");case"AvailableViewModeItems":case"AvailableDefaultRunModesItems":case"AvailableExportModeItems":return BB[BI];case"AvailableViewModes":case"AvailableExportModes":var CA=(BI=="AvailableViewModes")?[mstr.Enum.VIEWMEDIA.STATIC,mstr.Enum.VIEWMEDIA.INTERACTIVE,mstr.Enum.VIEWMEDIA.EDITABLE,mstr.Enum.VIEWMEDIA.FLASH]:[mstr.Enum.VIEWMEDIA.EXPORT_EXCEL,mstr.Enum.VIEWMEDIA.EXPORT_PDF,mstr.Enum.VIEWMEDIA.EXPORT_HTML,mstr.Enum.VIEWMEDIA.EXPORT_FLASH];var BU=[];var BO=BB.AvailableViewModes;for(var Bi=0;Bi<CA.length;Bi++){if((CA[Bi]&BO)>0){BU.push(CA[Bi]);}}return BU;case"MakePrivate":return(BB.AvailableViewModes&mstr.Enum.VIEWMEDIA.PRIVATE)>0;case"LayoutBorderStyle":var An={viewer:BB,getValue:function(g,CM){return this.viewer[CM];}};return this.parentBone.checkBorderProperties(null,An,"Layout","Style","Color");case"LayoutAllStyle":return this.queryState("LayoutLeftStyle");case"LayoutAllColor":return this.queryState("LayoutLeftColor");case"sectionsList":var Z=BB[BI];var BU=new Array(Z.length);for(var Bi=0;Bi<Z.length;Bi++){BU[Bi]={dssid:Z[Bi].d,n:Z[Bi].n,v:Z[Bi].v};}return BU;case"dockableSectionsList":var Z=BB.sectionsList;var BU=[];for(var Bi=0;Bi<Z.length;Bi++){if(Z[Bi].t==6||Z[Bi].t==7){BU.push({dssid:Z[Bi].d,n:Z[Bi].n,v:Z[Bi].v});}}return BU;case"VisibleSections":var Z=BB.sectionsList;var BU=[];for(var Bi=0;Bi<Z.length;Bi++){if(Z[Bi].v){BU.push(Z[Bi].d);}}return BU;case"DockedSections":var Z=BB.sectionsList;var BU=[];for(var Bi=0;Bi<Z.length;Bi++){if(Z[Bi].dc&&(Z[Bi].t==6||Z[Bi].t==7)){BU.push(Z[Bi].d);}}return BU;case"showDisplayModes":return BB.isFeatureAvailable(microstrategy.FEATURE_CHECK_DESIGN_MODE)||BB.isFeatureAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE);case"incrFetchEnabled":return BB.ifSettings.enabled;case"incrFetchBlockCount":return BB.ifSettings.blockCount;case"incrFetchLevels":return BB.ifSettings.levels;case"incrFetchCurLevel":return BB.ifSettings.curLevel;case"cursor":return !this.parentBone.currentControl||this.parentBone.currentControl==BI;case"lock":return this.parentBone.parentBone.insertionControlLocked;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.GRAPH_CTL:case microstrategy.BUTTON_CTL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_SHAPE:return this.parentBone[BI];case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:case microstrategy.SUBOBJTYPE_DOC_TEXT:return this.parentBone.currentControl==BI;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:return this.parentBone.currentControl==BI&&!this.parentBone.currentControlSubtype;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|FP":return this.parentBone.currentControl==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&this.parentBone.currentControlSubtype=="FP";case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|TC":return this.parentBone.currentControl==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&this.parentBone.currentControlSubtype=="TC";case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:return this.parentBone.currentControl==BI.split("|")[0]&&this.parentBone.currentControlSubtype!="R";case microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE:return this.parentBone.currentControl==BI.split("|")[0]&&this.parentBone.currentControlSubtype==BI.split("|")[1];}if(!this.parentBone.selections){return null;}var AR=this.parentBone.selections;var T=AR.items;var Au=null;var BP=(AR.useGridFormat(false))?AR.getGridFormatInfo(false):microstrategy.formatType;if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(BI)){if(!AR||!AR.isOnlyOneGridSelected()){return false;}var Bj=microstrategy.findBone(AR.getSelectedGrid());Bj=(Bj instanceof mstrReportGraphImpl)?Bj:microstrategy.bone(Bj.id+"_graph");if(BI=="seriesAreaFormatField_visible"){return(Bj&&Bj.commands)?Bj.commands.queryState(BI,AO):false;}return(Bj&&Bj.commands)?Bj.commands.queryState(BI):false;}switch(BI){case"showSelectionColor":for(var Bi in T){var AB=T[Bi];var a=AB.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(a==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(AB.lastChild){var B1=microstrategy.bone(AB.lastChild.id);if(B1&&B1.ctlStyle!=mstrRWControlImpl.CTL_STYLE_POOL_DOWN&&B1.ctlStyle!=mstrRWControlImpl.CTL_STYLE_LIST_BOX&&B1.ctlStyle!=mstrRWControlImpl.CTL_STYLE_LINK_ARRAY||B1&&B1.ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION||this.queryState("edtValueSelector").value==mstrRWControlImpl.FMT_TYPE_TITLE_BASE){return false;}}}else{if(a==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){var Bj=microstrategy.findBone(AR.getSelectedGrid());if(!Bj||!Bj.isGrid||Bj.gridUnitFormat!=microstrategy.GRID_UNIT_CONTAINER){return false;}}else{return false;}}}return true;case"showFlashOnlyForSelector":case"showFlashOnlyForFillColorSelector":for(var Bi in T){var AB=T[Bi];var a=AB.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(a!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||this.queryState("edtValueSelector").value==mstrRWControlImpl.FMT_TYPE_TITLE_BASE){return false;}if(AB.lastChild){var B1=microstrategy.bone(AB.lastChild.id);if(B1&&B1.ctlStyle!=mstrRWControlImpl.CTL_STYLE_POOL_DOWN&&(B1.ctlStyle!=mstrRWControlImpl.CTL_STYLE_LIST_BOX||BI=="showFlashOnlyForFillColorSelector")){return false;}}}return true;case"selectedItems":return this.parentBone.selections.items;case"selectedTextField":if(this.parentBone.selections.isMulti()){return null;}AB=this.parentBone.selections.firstItem();if(AB.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT){return AB;}else{return null;}break;case"RwdUnits":var O={items:[],value:""};if(!AR.isActive()||!AR.isVisible){O.items.push({dssid:"",n:microstrategy.descriptors.getDescriptor("3520")});}else{if(AR.isMulti()){O.items.push({dssid:"",n:microstrategy.descriptors.getDescriptor("3574")});}else{O.value=AR.firstItem().getAttribute("id");}}var Ai=[];var BV=this.parentBone;for(var AE in BV.formattingAttributes){var AB=BV.formattingAttributes[AE];if(AB.nm==undefined||AB.clip||AB.deleted){continue;}var Bl=false;if(AB.ty==microstrategy.OBJTYPE_DOC_SUBSECTION){Bl=true;for(var C in BV.sections){var Ag=BV.sections[C].subsections;if(Ag&&AE in Ag){Bl=false;break;}}}if(Bl){continue;}Ai.push({dssid:AE,n:BV.formattingAttributes[AE].nm,cssClass:"ToolbarList T"+AB.ty});}Ai=Ai.sort(function(CM,g){if(CM.n<g.n){return -1;}if(CM.n>g.n){return 1;}return 0;});O.items=O.items.concat(Ai);return O;case"units":var Bb=new Object();for(var Bi in this.parentBone.formattingAttributes){if(document.getElementById(Bi)){Bb[Bi]=this.parentBone.formattingAttributes[Bi];}}return Bb;case"unit":var AE=-1;var Bn=null;var Ar=null;if(!AR.isActive()||!AR.isVisible){AW=microstrategy.descriptors.getDescriptor("3520");}else{if(AR.isMulti()){AW=microstrategy.descriptors.getDescriptor("3574");}else{AB=AR.firstItem();AW=microstrategy.styleObj.getAttValue(AB,microstrategy.HTMLATTR_NAME);AE=AB.id;if(AB.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){Bn=microstrategy.OBJTYPE_DOC_SUBSECTION;}else{Bn=AB.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}}}switch(Bn){case microstrategy.SUBOBJTYPE_DOC_SHAPE:if(AB.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){Ar=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND;}break;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:Ar=microstrategy.styleObj.getAttValue(AB,"styst");break;}return{name:AW,id:AE,sty:Bn,styst:Ar};case"selected":case"SubType":if(!AR.isActive()||!AR.isVisible){return microstrategy.descriptors.getDescriptor("3520");}if(AR.isMulti()){return microstrategy.descriptors.getDescriptor("3574");}AB=AR.firstItem();if(AB.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return microstrategy.descriptors.getDescriptor("3580");}var a=AB.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);switch(a){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:var A0=microstrategy.findBone(AB);if(A0&&A0.commands){return A0.commands.queryState("selected");}case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:var CJ=this.getCommonBoneProperty(T,"isFilterPanel",microstrategy.SUBOBJTYPE_DOC_PANEL_STACK),Ac=this.getCommonBoneProperty(T,"isNavigationBar",microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(CJ){return microstrategy.descriptors.getDescriptor("8966");}else{if(Ac){return microstrategy.descriptors.getDescriptor("8145");}else{return microstrategy.descriptors.getDescriptor(this.rwObjNameMap[microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]);}}case microstrategy.SUBOBJTYPE_DOC_TEXT:if(this.queryState("isButton")){return microstrategy.descriptors.getDescriptor("6457");}default:return microstrategy.descriptors.getDescriptor(this.rwObjNameMap[a]);}case"Link":var M=this.getCommonAttValue(T,microstrategy.HTMLATTR_LINK_HREF,"link");if(M==null||M==""||M.length==0){M="http://";}return M;case"EditFieldTargetInfoWin":return this.getCommonAttValue(T,"ifw","InformationWindowTarget");case"IFrameSource":var BD=this.getCommonAttValue(T,microstrategy.HTMLATTR_HTML_SOURCE,"url");if(BD==null||BD==""||BD.length==0){BD="http://";}return BD;case"ToolTip":var AM=this.getCommonAttValue(T,microstrategy.HTMLATTR_TOOLTIP_FORMULA,"title");return(AM!=null)?AM:"";case"HTMLType":return this.getCommonAttValue(T,microstrategy.HTMLATTR_HTML_TYPE,"htmlType");case"IsPortal":var AB=AR.firstItem();var AN=AB.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var Bs=AB.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(AN==microstrategy.OBJTYPE_DOC_OBJECT&&Bs==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){return false;}return(this.getCommonAttValue(T,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,"showTitleBar")=="-1");case"ShowWidgetTitleBar":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_WIDGET_SHOW_WINDOW_TITLE,"ShowWidgetTitleBar")=="-1");case"UseAsInformationWindow":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_USE_AS_INFORMATION_WINDOW,"UseAsInformationWindow")=="-1");case"InformationWindowPlacement":return this.getCommonAttValue(T,microstrategy.HTMLATTR_INFO_WIN_PLACEMENT,"InformationWindowPlacement");case"InfoWindowMode":return this.getCommonAttValue(T,microstrategy.HTMLATTR_INFO_WIN_MODE,"InfoWindowMode");case"TabCloseToDismissInfoWindow":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_TAB_CLOSE_TO_DISMISS_INFOWIN,"TabCloseToDismissInfoWindow")=="-1");case"InfoWindowPosition":return this.getCommonAttValue(T,microstrategy.HTMLATTR_INFO_WIN_POSITION,"InfoWindowPosition");case"InfoWindowPositionEnabled":return this.queryState("UseAsInformationWindow")&&(this.queryState("InfoWindowMode")==4);case"TextCopyMode":case"GridCellCopyMode":return this.getCommonAttValue(T,microstrategy.HTMLATTR_IOS_COPY_MODE,"CopyMode");case"UseAsTableControl":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL,"UseAsTableControl")=="-1");case"ResetToFirstPanelWhenTargeted":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_RESET_TO_FIRST_PANEL_WHEN_TARGETED,"ResetToFirstPanelWhenTargeted")=="-1");case"EnableHorizontalSwipeToChange":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_HORIZONTAL_SWIPE_CHANGE,"EnableHorizontalSwipeToChange")=="-1");case"SwipePanelStyle":return this.getCommonAttValue(T,microstrategy.HTMLATTR_STYLE_FOR_SWIPE_PANEL,"StyleForSwitchingPanel");case"TitleBarDisplay":return this.getCommonAttValue(T,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY,"titleBarDisplay");case"panelCustomTitle":return this.queryState("IsPortal")&&this.queryState("TitleBarDisplay")=="1";case"PortalTitle":return this.getCommonAttValue(T,microstrategy.HTMLATTR_WINDOW_TITLE,"windowTitle");case"ShowElementCount":return this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_SHOW_ELEMENT_COUNT,"showElementCount")!="0";case"SetBadgeToValueOnField":return this.getCommonAttValue(T,microstrategy.HTMLATTR_SET_BADGE_TO_VALUE_ON_FIELD,"SetBadgeToValueOnField")=="-1";case"PortalState":return this.getCommonAttValue(T,microstrategy.HTMLATTR_WINDOW_STATE,"windowState");case"ExportOptions":return this.getCommonAttValue(T,microstrategy.HTMLATTR_EXPORT_OPTION,"exportOptions");case"IsLink":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_IS_LINK,"isLink")=="-1");case"HasDropShadow":return this.getCommonAttValue(T,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT,"dropShadowEffect")!="0";case"DropShadow":return this.getCommonAttValue(T,microstrategy.HTMLATTR_DROP_SHADOW,"dropShadowDepth");case"HasRoundedCorners":return this.getCommonAttValue(T,microstrategy.HTMLATTR_ROUNDED_CORNERS,"hasRoundedCorners")!="0";case"Radius":return this.getCommonAttValue(T,microstrategy.HTMLATTR_TOPLEFT_CORNER_RADIUS,"topLeftCornerRadius");case"TopCornersOnly":return this.getCommonAttValue(T,microstrategy.HTMLATTR_BOTTOMLEFT_CORNER_RADIUS,"bottomLeftCornerRadius")=="0";case"Alpha":return this.getCommonAttValue(T,microstrategy.HTMLATTR_ALPHA,"alphaOpacity");case"HasAlpha":return this.getCommonAttValue(T,microstrategy.HTMLATTR_ALPHA_EFFECT,"alphaEffect")!="0";case"Name":AW=this.getCommonAttValue(T,microstrategy.HTMLATTR_NAME,"name");return(AW!=null&&AW.length>0)?AW:microstrategy.descriptors.getDescriptor("3574");case"NewWin":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_NEW_WINDOW,"newWin")=="-1");case"Visible":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_VISIBLE,"visibility")=="-1");case"VisibleHTML":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_VISIBLE_HTML_VIEW_MODE,"showInHTMLViewMode")=="-1");case"LockAspectRatio":return this.getCommonAttValue(T,microstrategy.HTMLATTR_LOCK_ASPECT_RATIO,"lockAspectRatio")==microstrategy.TRUE;case"Category":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_CATEGORY,BI,null,BP);case"DecimalPlaces":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_DECIMAL_PLACES,BI,null,BP);case"ThousandSeparator":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_THOUSAND_SEPARATOR,BI,null,BP);case"CurrencySymbol":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_SYMBOL,BI,null,BP);case"CurrencyPosition":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_POSITION,BI,null,BP);case"NegativeNumbers":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_NEGATIVE_NUMBERS,"NegativeNumbers",null,BP);case"enableRed":return !AR.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT);case"textfieldSelected":return !AR.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT);case"Format":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_STRING,BI,null,BP);case"Source":return this.getCommonAttValue(T,microstrategy.HTMLATTR_IMAGE_SOURCE,"src");case"Overflow":return this.getCommonAttValue(T,microstrategy.HTMLATTR_GRID_OVERFLOW,0);case"TextOverflow":return this.getCommonAttValue(T,microstrategy.HTMLATTR_TEXT_OVERFLOW,0);case"ExportOverflow":return this.getCommonAttValue(T,microstrategy.HTMLATTR_GRID_EXPORT_OVERFLOW,0);case"QuickSwitch":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE])&&this.getCommonAttValue(T,microstrategy.HTMLATTR_QUICK_SWITCH)==microstrategy.TRUE;case"SizeMode":return this.getCommonAttValue(T,"sm");case"LineOrientation":return this.getCommonAttValue(T,microstrategy.HTMLATTR_ORIENTATION,"orientation");case"selectionsKey":return AR&&AR.getSelectionsKey();case"selectedGrid":return AR&&AR.getSelectedGrid();case"selectedPanelStack":return AR&&AR.getSelectedPanelStack();case"userMetricSelected":var Br=microstrategy.bone("reportObjs_RWWorkingSetStyle");if(Br){var Bc=Br.selections;if(Bc.isActive()){var G=Bc.firstItem();if(G){return G;}}}break;case"selectedContainer":if(AR.length==1){AB=AR.firstItem();var AN=AB.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var Bs=AB.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(AN==microstrategy.OBJTYPE_DOC_OBJECT&&Bs==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var N=microstrategy.findBone(AB);var CG=N.getCurrentPanel();return CG.elem;}}case"selectedSection":if(this.queryEnabled("subSectionIsSelected")){AB=AR.firstItem();if(AB.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return AB;}else{if(AR.isSameSubSection()){return AB.parentNode;}}}break;case"isOnGrid":case"getRowHeight":case"getGridWidthsObj":case"selectedGrid":case"tbanding":case"gridMode":case"graphMode":case"gridGraphMode":case"checkLockRowHeader":case"checkLockColHeader":case"checkMergeRowHeader":case"checkMergeColHeader":case"comboToggleButton":case"tsubtotals":case"checkSubtotals":case"tOutline":case"checkBanding":case"enableLegends":case"enableLabels":case"allowedGraphTypes":case"styleName":case"target":case"level":case"autostyle":case"ShowThreshold":case"toggleattforms":case"fittocontent":case"fittowindow":case"objBrowser":case"pageBy":case"reportFilter":case"viewFilter":case"formatToolbar":case"promptDetails":case"visualizationMode":case"RHS":case"RHM":case"RHL":case"CHS":case"CHM":case"CHL":case"Outline":case"Banding":case"AttForms":case"ShowThreshold":case"TitleOverlap":case"ShowDrillingOptions":case"DrillOptions":case"enableAttForms":case"enableThresholds":case"isShowHeadersAvailable":case"isMergeHeadersAvailable":case"isLockHeadersAvailable":case"isNonLinkedTemplate":case"isGridFormattingEnabled":case"XTabView":case"XTabViewDHTML":case"Shortcut":case"GraphExportOverflow":case"GraphExportOverflowSpacing":case"visFlashMode":case"visAjaxMode":case"HideNullsOrZeros":case"HideNullZeroValues":case"toggleHideNullsOrZeros":if(!AR||!AR.isOnlyOneGridSelected()){return false;}var Bj=microstrategy.findBone(AR.getSelectedGrid());return(Bj&&Bj.commands)?Bj.commands.queryState(BI):false;case"assoNodesDrill":if(!AR||!AR.isOnlyOneGridSelected()){return false;}var Bj=microstrategy.findBone(AR.getSelectedGrid()),A6=(Bj&&Bj.commands)?Bj.commands.queryState(BI):false,R=[];var Aa=this.queryState("availAssoNodes");if(A6){for(var Bi=0;Bi<A6.length;Bi++){var W=mstr.utils.Arrays.findByForm(Aa,A6[Bi],"dssid",false);if(W>-1){R.push(Aa[W]);}}}return R;case"DataSource":if(!AR||!AR.isOnlyOneGridSelected()){return false;}var Bj=microstrategy.findBone(AR.getSelectedGrid()),AC=(Bj&&Bj.commands)?Bj.commands.queryState(BI):false;return AC;case"FillColor_vf":case"lncolor_vf":var Bm=(BI=="FillColor_vf")?15:10;if(!AR||!AR.isOnlyOneGridSelected()){return Bm;}Bj=microstrategy.findBone(AR.getSelectedGrid());return(Bj&&Bj.commands)?Bj.commands.queryState(BI):Bm;case"hasNoTargets":if(!AR||!AR.isOnlyOneGridSelected()){return false;}Bj=microstrategy.findBone(AR.getSelectedGrid());var A9=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_ID)||"Metrics";return(Bj&&Bj.controlLinks&&(Bj.controlLinks[A9]))?false:true;case"isOLAP":var n,V,A,Ay,Al,Bu=microstrategy.activeCXMenu.getAttribute("d1"),B9=microstrategy.activeCXMenu.getAttribute("olap"),Au=microstrategy.findBone(this.parentBone.selections.getSelectedGrid());if(B9=="1"){return true;}if(Au&&Bu){Al=Bu.split("A");if(Al&&Al.length>=2){V=Al[0];A=Al[1];n=Al[2];Ay=Au.gridStructureInfo.getUnit(V,A,n);return Ay&&Ay.olap;}}return false;case"gridSelectedVisualization":if(!AR||!AR.isOnlyOneGridSelected()){return false;}var Bj=microstrategy.findBone(AR.getSelectedGrid());return(Bj&&Bj.commands)?Bj.commands.queryState("selectedVisualization"):false;case"Autostyle":if(!AR||!AR.isOnlyOneGridSelected()){return false;}var Bj=microstrategy.findBone(AR.getSelectedGrid());return(Bj&&Bj.commands)?Bj.commands.queryState(BI):false;case"getControlGroupByList":if(!AR||!(AR.isOnlyOneGridSelected()||AR.isOnlyOnePanelStackSelected()||AR.isOnlyOneSelectorCtrlSelected())){return false;}var A1=AR.getSelectedGrid()||AR.getSelectedPanelStack()||AR.getSelectedSelectorControl();var Bj=microstrategy.findBone(A1);return(Bj&&Bj.ControlGroupByList)?Bj.ControlGroupByList:false;case"visibleShortcut":return(BB.getAvailableDatasets().length>0);case"isCubeReportDataset":return BB.isCubeReportDataset;case"autoArrange":if(!AR||!AR.isOnlyOneGridSelected()){return false;}var CE=microstrategy.findBone(AR.getSelectedGrid());if(!CE){return false;}var Bz=microstrategy.bone(CE.id+"_gb");return(Bz)?Bz.autoArrange:false;break;case"controlSubtype":AB=AR.firstItem();if(AB.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&AB.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){Bo=microstrategy.bone(AB.id+"_Ctl");if(Bo&&Bo.ctlStyle){return Bo.ctlStyle;}}return -1;case"controlOrientation":AB=AR.firstItem();if(AB.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&AB.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){Bo=microstrategy.bone(AB.id+"_Ctl");if(Bo&&Bo.ctlOrientation){return Bo.ctlOrientation;}}return -1;case"ItemWidthMode":return(this.getCommonBoneProperty(T,"itemWidthMode",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0")=="0");case"DisplaySelectorDocked":return(this.getCommonBoneProperty(T,"DisplaySelectorDocked",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0")=="-1");case"ExportAsShownOnWeb":return this.getCommonBoneProperty(T,"aow",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"exportSelectorTriState":return this.queryState("ExportAsShownOnWeb");case"availableWidgets":if(AR.isOnlyOneGridSelected()){return[{dssid:"None",n:microstrategy.descriptors.getDescriptor("2057")}].concat(BB.getAvailableWidgets(microstrategy.SUBOBJTYPE_DOC_TEMPLATE));}else{if(this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL])){return[{dssid:"None",n:microstrategy.descriptors.getDescriptor("5028")}].concat(BB.getAvailableWidgets(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL));}}return[{dssid:"None",n:microstrategy.descriptors.getDescriptor("2057")}];case"XTabViewModes":var e=[{dssid:"1",n:microstrategy.descriptors.getDescriptor("2975")},{dssid:"2",n:microstrategy.descriptors.getDescriptor("115")},{dssid:"3",n:microstrategy.descriptors.getDescriptor("2972")}];if(this.queryVisible("visFlashMode")){e=e.concat({dssid:"50",n:microstrategy.descriptors.getDescriptor("4921")});}return e;case"EditSelectorMetricQualType":return"4";case"EditSelectorType":if(AR.isOnlyOneTableSelected()){return -1;}else{var X=this.queryState("EditSelectorStyle");if(X==="11"){return mstrRWControlImpl.CTL_TYPE_ATTR_QUAL;}return this.getCommonBoneProperty(T,"ctlType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");}case"UpdateFilterTarget":var Aq;if(this.queryState("isDDIC")){var Bq=AR.firstItem()&&AR.firstItem().id;Aq=BB.formattingAttributes[Bq]&&BB.formattingAttributes[Bq]["adts"];}else{Aq=this.getCommonAttValue(T,"adts","ActionForDirectTargetSelectors")||"0";}return Aq;case"controlQualType":var B8=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());return B8.mct;case"showControlIncludeMenu":var Ap=this.queryState("EditSelectorType");var X=this.queryState("EditSelectorStyle");return(this.queryState("EditSelectorType")==mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST&&"01234567".indexOf(X)>-1)?true:false;case"showMetricConditionType":return this.queryState("isMetricQualifier");case"isMetricQualifier":var Ae=this.queryState("EditSelectorStyle");return Ae=="7"||Ae=="8";case"isMetricQualifierStyle":return this.queryState("EditSelectorStyle")=="8";case"isNormalSelector":return !this.queryState("isMetricQualifier")&&!this.queryState("isActionSelector")&&!this.queryState("showTableButtons")&&!this.queryState("isDDIC");case"DataFilterVisible":return this.queryState("isNormalSelector")&&!this.queryState("isDSAsTarget")&&!this.queryState("attrReplaceLCVisible")||this.queryState("isDDIC");case"selectorAutoSyncVisible":case"showTotalVisible":case"countVisible":return !this.queryState("isMetricQualifier")&&!this.queryState("isDSAsTarget")&&(BI==="selectorAutoSyncVisible"||!this.queryState("isDDIC"))&&!this.queryState("isAQSelector");case"selectionTypeVisible":return(this.queryState("EditSelectorType")==1||this.queryState("EditSelectorType")==7)&&!this.queryState("isDSAsTarget")&&!this.queryState("isDDIC");case"attrLCVisible":var Ae=this.queryState("EditSelectorType");return !(Ae==2||Ae==4||Ae==8)&&!this.queryState("isDSAsTarget");case"metricLCVisible":return(this.queryState("EditSelectorType")==2)&&!this.queryState("isDSAsTarget");case"datasetLCVisible":return !(this.queryState("EditSelectorType")==2)&&this.queryState("isDSAsTarget");case"attrReplaceLCVisible":return(this.queryState("EditSelectorType")==8)&&!this.queryState("isDSAsTarget");case"submissionLCVisible":return this.queryState("EditSelectorType")==4&&!this.queryState("isDSAsTarget");case"transactionEnabled":return this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_CONFIGURE_TRANSACTIONS);case"isActionSelector":return this.queryState("EditSelectorType")=="4";case"isPanelStackSelector":return this.queryState("EditSelectorType")=="3";case"isAQSelector":return this.queryState("EditSelectorType")=="7";case"isDDIC":var Bi=0,Ao=this.parentBone.selections,CH=this.parentBone.selections.items,CL=Ao.getTypes();for(Bi=0,Af=CL.length;Bi<Af;Bi++){if(CL[Bi]!==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT){return false;}}for(Bi in CH){var AB=CH[Bi];if(!this.getDDICBoneProperty(T,"ddic",microstrategy.SUBOBJTYPE_DOC_TEXT,null)){return false;}}return true;case"runReportDocName":return this.getCommonBoneProperty(T,"execName",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"actionSelectorType":return this.getCommonBoneProperty(T,"ast",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"postSubmitOption":var AZ=this.getCommonBoneProperty(T,"pso",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");return(AZ==null)?"8":AZ;case"DisplayText":return this.getCommonBoneProperty(T,"dpTxt",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"ShowSubmitMessage":return this.getCommonBoneProperty(T,"shSubMsg",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"SubmitMessage":return this.getCommonBoneProperty(T,"subMsg",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"OfflineSubmission":var A8=this.getCommonBoneProperty(T,"os",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);return A8===undefined?true:A8;case"TXNSubmitInOrder":return this.getCommonBoneProperty(T,"sio",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"DisplayConfirmation":return this.getCommonBoneProperty(T,"dpCfm",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"InvalidateCache":case"ForceLiveExecution":case"AutoAnswerPrompt":case"TableSubmitText":var Bf={runReportDocName:"execName",actionSelectorType:"ast",postSubmitOption:"pso",DisplayText:"dpTxt",ShowSubmitMessage:"shSubMsg",SubmitMessage:"subMsg",OfflineSubmission:"os",DisplayConfirmation:"dpCfm",InvalidateCache:"invCache",ForceLiveExecution:"fcLvExec",AutoAnswerPrompt:"aapm",TableSubmitText:"dpTxt",TXNSubmitInOrder:"sio"},h;if(AR.isOnlyOneTableSelected()){var Bo=AR.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(Bo&&Bo.isTable){h=Bo.querySelectorState(Bf[BI],"submitBtn");}}else{h=this.getCommonBoneProperty(T,Bf[BI],microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);}if(BI=="postSubmitOption"){h=(h==null)?"8":h;}return h;case"TableCancelText":case"TableCancelConfirmation":var Bh={TableCancelConfirmation:"dpCfm",TableCancelText:"dpTxt"},h;if(AR.isOnlyOneTableSelected()){var Bo=AR.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(Bo&&Bo.isTable){h=Bo.querySelectorState(Bh[BI],"cancelBtn");}}return h;case"TableCancelType":var Bg=microstrategy.descriptors;return this.queryState("UseAsInformationWindow")?Bg.getDescriptor("11174"):Bg.getDescriptor("11175");case"showSelectorStyle":return this.queryState("isSelector")&&!this.queryState("isActionSelector")&&!this.queryState("isAQSelector");case"hasSelectorTitle":return this.queryState("isSelector")&&!this.queryState("isActionSelector");case"hasElemCount":return this.queryState("isSelector")&&!this.queryState("isAQSelector");case"EditSelectorStyleMetricQual":case"EditSelectorStyle":case"EditSelectorStyleSingleSelect":case"EditSelectorStyleAction":return this.getCommonBoneProperty(T,"ctlStyle",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"EditSelectorOrientation":return this.getCommonBoneProperty(T,"ctlOrientation",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"EditSelectorMouseOverAction":return this.getCommonBoneProperty(T,"mouseOverAction",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorShowAll":return this.getCommonBoneProperty(T,"showAll",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorAllAlias":return this.getCommonBoneProperty(T,"allAlias",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"EditSelectorShowTotal":return this.getCommonBoneProperty(T,"showTotal",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorTotalPosition":return this.getCommonBoneProperty(T,"totalPosition",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorMultiSelect":return this.getCommonBoneProperty(T,"multiSelect",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorSearchOnServ":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_SEARCH_ON_SERVER,"SearchOnServer")=="-1");case"EditSelectorNoSelectionBehavior":return this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_NO_SELECTION_BEHAVIOR,"NoSelectionBehavior");case"MinSel":var Bd=this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_MIN_SELECTION_COUNT,"MinSelectionCount");return(Bd>=0?Bd:"");case"MaxSel":var AQ=this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_MAX_SELECTION_COUNT,"MaxSelectionCount");return(AQ>=0?AQ:"");case"EnableSelCount":var Bd=this.queryState("MinSel"),AQ=this.queryState("MaxSel");return(Bd!==""||AQ!=="");case"EditSelectorAutoSync":var AX=false;if(this.queryState("isDDIC")){AX=this.getDDICBoneProperty(T,"autoSync",microstrategy.SUBOBJTYPE_DOC_TEXT,false);}else{AX=this.getCommonBoneProperty(T,"autoSync",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);}return AX;case"EditSelectorSource":case"EditSelectorSourceMetrics":var Bp=this.getCommonBoneProperty(T,"ctlSrcId",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),CK=this.getCommonBoneProperty(T,"ctlSrcType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),Y=this.getCommonBoneProperty(T,"ctlSrcName",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);if(CK==100||CK==101){CK=4;}if(Y!=null){Y=((Y.indexOf("]")==Y.length-1)?Y.substring(0,Y.length-1):Y);Y=((Y.indexOf("[")==0)?Y.substring(1,Y.length):Y);}return(Bp!=null&&CK!=null&&Y)?Bp+"|"+CK+"|"+Y:"";case"EditSelectorSourceAttributes":var B6=this.getCommonBoneProperty(T,"replaceAttId",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),B3=this.getCommonBoneProperty(T,"replaceAttType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),D=this.getCommonBoneProperty(T,"replaceAttName",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);if(B3==100||B3==101){B3=4;}if(D!=null){D=((D.indexOf("]")==D.length-1)?D.substring(0,D.length-1):D);D=((D.indexOf("[")==0)?D.substring(1,D.length):D);}return(B6!=null&&B3!=null&&D)?B6+"|"+B3+"|"+D:"";case"IsSelectorSourceNDE":var CK=this.getCommonBoneProperty(T,"ctlSrcType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),Av=this.getCommonBoneProperty(T,"ctlSrcSubtype",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);return CK==microstrategy.DSSTYPE_CONSOLIDATION&&Av=="12033";case"EditSelectorSourceDDIC":return this.getDDICBoneProperty(T,"ctlSrc",microstrategy.SUBOBJTYPE_DOC_TEXT,null)||"";case"EditFormDelimiter":return this.getCommonBoneProperty(T,"formDelimiter",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"EditDisplayForm":return this.getCommonBoneProperty(T,"displayFormType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"selectedAttrForms":return this.getCommonBoneProperty(T,"attrForms",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"sortAttrForm":return this.getCommonBoneProperty(T,"sortAttrForm",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"sortType":return this.getCommonBoneProperty(T,"sortType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"EditSelectorSelectionType":return this.getCommonBoneProperty(T,"include",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");case"EditSelectorMetricConditionType":return this.getCommonBoneProperty(T,"mct",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0")||0;case"availableTemplates":case"availableTemplatesNoSelectors":case"availableTemplatesNoPlaceholder":Bo=microstrategy.getBonesByType([microstrategy.OBJTYPE_GRID,microstrategy.OBJTYPE_GRAPH]);var B5=this.queryState("isActionSelector"),AL=this.queryState("isMetricQualifier"),BZ=this.queryState("isAQSelector"),AY=!B5&&!AL&&(BI=="availableTemplates"||BI==="availableTemplatesNoPlaceholder"),BH=(BI=="availableTemplates"),K={},BN=[];for(Bi=0;Bi<Bo.length;Bi++){AE=Bo[Bi].objId;if(!document.getElementById(AE)){continue;}var By=this.parentBone.styleObj.getAttValue(document.getElementById(AE),microstrategy.HTMLATTR_NAME);if(!(AE in K)){BN.push({dssid:AE,n:By});K[AE]=true;}if(AY){var A7={},CF=Bo[Bi].gridStructureInfo,Am=Bo[Bi].tscObjs;mstr.$A.forEach(CF.allAxes,function(g){mstr.$A.forEach(g.units,function(CM){if(CM.dssId){A7[CM.dssId]=true;}});});if(Am){mstr.$A.forEach(Am,function(g){if(g.ctl&&g.ctl.ddic&&A7[g.did]){BN.push({dssid:g.ctl.ctlKey,n:By+":"+g.n});}});}}if(BH){var AI=Bo[Bi].phs,BT,BR,A2;for(BR=0;AI&&AI.length&&BR<AI.length;BR++){BT=AI[BR];A2=AE+"_"+BT.idx;if(!(A2 in K)){BN.push({dssid:A2,n:By+":"+BT.n});K[A2]=true;}}}}var Aq=BN.concat(this.queryState("panelStackTargets"));if(AY){Aq=Aq.concat(this.queryState("panelStackTargetsDDIC"));}if(B5||BZ||BI=="availableTemplatesNoSelectors"){return Aq;}else{return Aq.concat(this.queryState("availableSelectors"));}case"availAssoNodes":if(!AR||!AR.isOnlyOneGridSelected()){return false;}var K={};var Bj=microstrategy.findBone(AR.getSelectedGrid());K[Bj.RWUnitId]=true;Bo=microstrategy.getBonesByType([microstrategy.OBJTYPE_GRID,microstrategy.OBJTYPE_GRAPH]);var Aa=[];for(Bi=0;Bi<Bo.length;Bi++){AE=Bo[Bi].RWUnitId;if(!document.getElementById(AE)||Bo[Bi].isOnClipBoard||(AE in K)||(Bo[Bi].commands&&Bo[Bi].commands.queryState("Shortcut"))){continue;}Aa.push({dssid:AE,n:this.parentBone.styleObj.getAttValue(document.getElementById(AE),microstrategy.HTMLATTR_NAME)});K[AE]=true;}return Aa;case"availableTemplatesDataset":var m=microstrategy.getViewerBone();var AK=[];for(var AE in m.documentDataSets){var Ab=m.documentDataSetsIsCube[AE],Bw=m.datasetInfos[AE].auct;if(Ab==false&&Bw){AK.push({dssid:AE,n:m.documentDataSets[AE]});}}return AK;case"availablePanelStacks":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(this.queryState("panelStackTargets"));case"availableSelectors":Bo=microstrategy.getBonesByType([microstrategy.OBJTYPE_RW_CONTROL]);var BA=[],CI=this.queryState("isDDIC")||this.queryState("isMetricQualifier")||this.queryState("EditSelectorType")==1;for(Bi=0;Bi<Bo.length;Bi++){AE=Bo[Bi].RWUnitId;if(!document.getElementById(AE)||Bo[Bi].boneSelected||Bo[Bi].isOnClipBoard||Bo[Bi].ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION||(Bo[Bi].ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK&&CI)||Bo[Bi].ctlStyle==mstrRWControlImpl.CTL_STYLE_ATTR_QUALIFICATION){continue;}BA.push({dssid:AE,n:this.parentBone.styleObj.getAttValue(document.getElementById(AE),microstrategy.HTMLATTR_NAME)});}return BA;case"selectorCurrentStateOptsUC":case"selectorCurrentStateOpts":var Ax=BI=="selectorCurrentStateOptsUC",Aq=[],Be,Aj=!this.queryState("isSelectorUnset"),c=microstrategy.descriptors;if(Aj){Aq[Aq.length]={dssid:"-1",n:c.getDescriptor("7625")};}Be=Aq.length;if(Ax){Aq[Be]={dssid:"1",n:c.getDescriptor("7622")};}else{if(Aj){Aq[Aq.length]={dssid:"-1",n:c.getDescriptor("7625")};}Be=Aq.length;Aq[Be]={dssid:"2",n:c.getDescriptor("7623")};Aq[Be+1]={dssid:"4",n:c.getDescriptor("7624")};}return Aq;case"isSelectorUnset":var Bq=AR.firstItem()&&AR.firstItem().id,F=BB.formattingAttributes[Bq]&&BB.formattingAttributes[Bq]["isUs"];return F==undefined?true:F;case"selectorCurrentStateUC":return this.queryState("isSelectorUnset")?"1":"-1";case"selectorCurrentState":if(!this.queryState("isSelectorUnset")){return"-1";}else{var Bq=AR.firstItem()&&AR.firstItem().id,B0=BB.formattingAttributes[Bq]&&BB.formattingAttributes[Bq]["ust"];if(B0==1){B0=2;}return B0||2;}case"selectorTabTitle":return AR.isOnlyOneTableSelected()?microstrategy.descriptors.getDescriptor("7821"):microstrategy.descriptors.getDescriptor("4728");case"UnsetCount":var Bq=AR.firstItem()&&AR.firstItem().id;return BB.formattingAttributes[Bq]&&BB.formattingAttributes[Bq]["usc"];case"panelStackTargets":var B4=[],Bo=microstrategy.getBonesByType(microstrategy.OBJTYPE_PANEL_STACK);for(Bi=0;Bi<Bo.length;Bi++){AE=Bo[Bi].id;if(!document.getElementById(AE)||Bo[Bi].isOnClipBoard){continue;}B4.push({dssid:AE,n:this.parentBone.styleObj.getAttValue(Bo[Bi].elem,microstrategy.HTMLATTR_NAME)});}return B4;case"panelStackTargetsDDIC":var J=this,Aq=[],B2=AR.firstItem()&&AR.firstItem().getAttribute("trxctlkey"),Bo=microstrategy.getBonesByType(microstrategy.OBJTYPE_PANEL_STACK),BQ=this.queryState("isDDIC");for(Bi=0;Bi<Bo.length;Bi++){AE=Bo[Bi].id;if(!document.getElementById(AE)||Bo[Bi].isOnClipBoard){continue;}var B4=Bo[Bi].panels||[];mstr.$A.forEach(B4,function(CM){var g=CM.tscObjs;if(g){mstr.$A.forEach(g,function(CN){if(CN.ctl&&CN.ctl.ddic&&CN.ctl.ctlKey!=B2&&document.getElementById(CN.key)){Aq.push({dssid:CN.ctl.ctlKey,n:J.parentBone.styleObj.formattingAttributes[CN.key]["nm"]});}});}});}return Aq;case"EditSelectorTargetsSingleSelect":var o=this.getCommonBoneProperty(T,"ctlType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");if(this.parentBone.parentBone.autoWire){if(o==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){var Ba=this.getCommonBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);return Ba;}else{var Ag=microstrategy.findBone(this.queryState("selectedSection")),BL=Ag&&Ag.findObjects&&Ag.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(BL&&BL.length==1){return BL[0].getAttribute("id");}else{return"";}}}else{if(o!=mstrRWControlImpl.CTL_TYPE_PANEL_STACK){return"";}else{var Ba=this.getCommonBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);return(Ba.length>0)?Ba[0]:"";}}case"EditSelectorTargetsMetrics":case"EditSelectorTargets":case"EditSelectorTargetsNoPlaceholder":case"EditSelectorTargetsAttributes":var o=this.getCommonBoneProperty(T,"ctlType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");var J=this;var I=[];var An=function(CQ,CN,CM){var CS,CR,CP,g,CO;for(Bi=0;Bi<CQ.length;Bi++){if(document.getElementById(CQ[Bi])){if(!CM||!(J.parentBone.styleObj.getAttValue(document.getElementById(CQ[Bi]),microstrategy.HTMLATTR_OBJTYPE) in CM)){I.push({dssid:CQ[Bi],n:J.parentBone.styleObj.getAttValue(document.getElementById(CQ[Bi]),microstrategy.HTMLATTR_NAME)});}}else{if(CQ[Bi]&&CQ[Bi].split("_").length===2){CS=CQ[Bi].split("_");g=document.getElementById(CS[0]);CR=microstrategy.findBone(g);if(CR&&CR.phs&&BI!=="EditSelectorTargetsNoPlaceholder"){var CT=mstr.utils.Arrays.findByForm(CR.phs,CS[1],"idx",false);if(CT>=0){CP=CR.phs[CT];CO=J.parentBone.styleObj.getAttValue(g,microstrategy.HTMLATTR_NAME);I.push({dssid:CQ[Bi],n:CO+":"+CP.n});}}}else{if(CN&&CN[CQ[Bi]]){I.push({dssid:CQ[Bi],n:CN[CQ[Bi]]});}}}}return I;};if(this.parentBone.parentBone.autoWire){if(o==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){var BM=microstrategy.findBone(this.queryState("selectedSection"));var Ak=BM.findObjects(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);Ak=Ak.concat(BM.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK));var A4=[];var AV={};for(var Bi=0,Az=Ak.length;Bi<Az;Bi++){var AT=microstrategy.findBone(Ak[Bi]);var Bx=AT.objId||AT.id;if(AV[Bx]!=true){A4.push(Bx);AV[Bx]=true;}}return An(A4);}else{var Ak=J.getCommonBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);var AS=J.getCommonBoneProperty(T,"targetNames",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);return An(Ak,AS);}}else{if(o==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){return[];}else{var Ak=J.getCommonBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);var AS=J.getCommonBoneProperty(T,"targetNames",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,{});if(this.queryState("isDDIC")){Ak=Ak.concat(J.getDDICBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"").split(CLIPBOARD_ITEM_SEPARATOR));}var Ba=this.queryState("availableTemplates");AS=AS||{};for(var H in Ba){AS[Ba[H].dssid]=Ba[H].n;}return An(Ak,AS,(BI=="EditSelectorTargetsMetrics"||BI=="EditSelectorTargetsAttributes")?{111:true}:null);}}case"EditSelectorCandidateAttributes":return this.getCommonBoneProperty(T,"candidateAtts",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);case"EditSelectorTargetsDataset":var I=[],U=this.getCommonBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]),m=microstrategy.getViewerBone(),AP=m.documentDataSets||[];for(var Bi=0,Az=U.length;Bi<Az;Bi++){var AE=U[Bi];if(AP[AE]&&m.datasetInfos[AE].auct){I.push({dssid:AE,n:AP[AE]});}}return I;case"isDSAsTarget":return(this.getCommonBoneProperty(T,"ctlTargetType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[])==mstrRWControlImpl.CTL_TARGET_TYPE_DATASET);case"dsAsTgtChkVisible":var Av=parseInt(this.getCommonBoneProperty(T,"ctlSrcSubtype",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null)),CK=this.getCommonBoneProperty(T,"ctlSrcType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);if(isNaN((Av))){Av=-1;}return(this.queryState("EditSelectorType")==1)&&CK===microstrategy.DSSTYPE_ATTRIBUTE&&Av!==microstrategy.DSSSUB_TYPE_DERIVED_ATTRIBUTE;case"showTooltip":return this.queryEnabled("ToolTip");case"showNavigationProps":return this.queryEnabled("IsLink")&&!this.queryState("isButton");case"showVisibleInHTMLViewMode":var Ad=this.queryEnabled("VisibleHTML");if(Ad){for(AE in T){var BC=T[AE].getAttribute("dt");if(BC==-1||BC==-2){return false;}}}return Ad;case"docked":if(this.queryState("isSection")){var CB=this.getCurrentSectionDef();return CB&&CB.dc;}return false;case"showHTMLContainer":return this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE)&&this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_CREATE_HTML_CONTAINER)&&this.queryEnabled("HTMLType");case"showPortal":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE]);case"showPanelStackTitle":if(this.queryState("isNavBar")){return false;}if(AR.atLeastOneTableSelected()){return false;}case"isPanelStack":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]);case"showAdvanced":return !this.queryState("isActionSelector")&&!AR.isOnlyOneTableSelected()&&!this.queryState("attrReplaceLCVisible");case"showTableDisplayMode":case"showTableButtons":return AR.isOnlyOneTableSelected();case"showAutoWireMessage":return this.queryState("Autowire")&&!AR.isOnlyOneTableSelected()&&!this.queryState("isDSAsTarget");case"fpAutoSubmit":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_AUTO_SUBMIT,"CtlAutoSubmit")=="-1");case"isFilterPanel":return this.getCommonBoneProperty(T,"isFilterPanel",microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);case"showGridIf":var q=this.queryState("XTabView");return q==1||q==3;case"showTransition":return !this.queryState("isSelector");case"showFlushMsg":var AF=microstrategy.updateManager;return AF.commands.queryEnabled("apply");case"isSection":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_SUBSECTION]);case"showSize":return !this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_SUBSECTION,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"showPageBreak":return(this.queryState("isSection")&&AR.firstItem().getAttribute("dt")!="-3");case"isSelector":case"showItem":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL]);case"showFixedWidthOnly":return !this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])||this.queryState("IsPortal");case"showFixedHeightOnly":return !this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])||this.queryState("IsPortal")||this.queryState("isButton");case"showFixed100Width":case"showFixed100Height":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND]);case"showFixedFitWidth":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])&&!this.queryState("IsPortal");case"showFixedFitHeight":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])&&!this.queryState("IsPortal")&&!this.queryState("isButton");case"isOneGrid":return AR.isOnlyOneGridSelected();case"wasFullScreen":return this.parentBone.parentBone.curWgtId||false;case"isHorizontalSubsection":return this.queryEnabled("isSubsectionHorizontal");case"isImage":return this.queryEnabled("Source");case"isLine":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"showLockAspectRatio":if(this.queryState("onlyButtons")){return true;}return this.queryState("isImage");case"showTitleHeight":return(this.queryState("showPortal")||this.queryState("showPanelStackTitle")||this.queryState("isSelector"));case"setWidget":var AJ=this.getCommonAttValue(T,"twc","ClassName");switch(AJ){case"com.microstrategy.flex.viewer.HeatMapViewer":AJ="../swf/HeatMapWidget.swf";break;case"com.microstrategy.flex.viewer.GaugeContainer":AJ="../swf/GaugeWidget.swf";break;case"com.microstrategy.flex.viewer.InteractiveBubblePlotComponent":AJ="../swf/InteractiveBubbleWidget.swf";break;}return this.getCommonAttValue(T,"rsl","RSLPath")||AJ||"None";case"NonFlashRender":return this.getCommonAttValue(T,"nfr","NonFlashRender");case"setTransition":var AM=this.getCommonAttValue(T,"ttr","Transition");return AM!=""?AM:"None";case"setTransDuration":return this.getCommonAttValue(T,"tdr","Duration");case"PSPreLoadAllPanels":return this.getCommonAttValue(T,"plp","PSPreLoadAllPanels");case"ClipOnExport":return this.getCommonAttValue(T,"cone","IgnoreInExport")==microstrategy.FALSE;case"allowPanelsToSplitAcrossPages":return this.getCommonAttValue(T,"spcp","SplitPanelAcrossPages")==microstrategy.TRUE||this.queryState("expandPanels")==0;case"panelOverflowSpacing":return this.getCommonAttValue(T,"povfs","RepeatPanelSpacing");case"expandPanels":return this.getCommonAttValue(T,"ep","ExpandAllPanels");case"panelOverflowSpacingEnabled":return this.queryState("expandPanels")!=0&&this.queryState("ClipOnExport");case"gridIfEnabled":return this.getCommonAttValue(T,"gif","gridIfEnabled")!="0";case"gridIfMaxRows":return this.getCommonAttValue(T,"gmr","gridIfMaxRows");case"gridIfRowMode":return this.getCommonAttValue(T,"gifmd","gridIfRowMode");case"XTabPos":return this.getCommonAttValue(T,microstrategy.HTMLATTR_GRID_POS,"gridPosition");case"XTabPer":return this.getCommonAttValue(T,microstrategy.HTMLATTR_GRID_AREA_PCT,"gridArea");case"TitleHeight":if(!AR.isActive()){return"";}var BP=2;if(AR.isSelectorControlSelected()){BP=mstrRWControlImpl.FMT_TYPE_TITLE;}var x=this.getCommonAttValue(T,microstrategy.HTMLATTR_HEIGHT,"height",false,BP);return(x&&x.length>0)?microstrategy.number.toUserUnits(x):"";case"showFillColor":return this.queryEnabled("backgroundColor")&&!this.queryState("onlyButtons");case"enableFillColor":return(!AR.isOnlyOneGridSelected()||AR.gridUnitFormatX!=microstrategy.GRID_BORDERS);case"showBorders":return AR.isOnlyOneTableSelected()?(AR.panelUnitFormat==0):(this.queryEnabled("AllColor")&&!this.queryState("isNavBar"));case"enableBorders":if(AR.isOnlyOneGridSelected()){return(!AR.isGridContainerSelected()||AR.gridValueFormatX==1);}else{if(AR.isOnlyOneTableSelected()){return true;}else{if(AR.isOnlyOnePanelStackSelected()){return(AR.panelValueFormat!=1);}else{if(AR.isSelectorControlSelected()){return(AR.controlValueFormat!=mstrRWControlImpl.FMT_TYPE_TITLE_BASE);}}}}return true;case"showLineColor":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE])||(AR.isOnlyOneTableSelected()&&AR.panelUnitFormat>0);case"isText":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT]);case"iOSOnlyCopyVisible":return this.queryState("isText")&&!this.queryState("isButton");case"isButton":for(var AB in AR.items){if(microstrategy.styleObj.getAttValue(AR.items[AB],microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT&&microstrategy.styleObj.getAttValue(AR.items[AB],microstrategy.HTMLATTR_DISPLAY_STYLE)>0){return true;}}return false;case"ShowInfoWindowTargets":return this.queryState("isButton")||microstrategy.isEnabled(AR.isVisible&&AR.items,this.qeMap.InformationWindowTarget);case"ShowMobile":return this.queryState("isText")&&!this.queryState("isButton");case"onlyButtons":for(var AB in AR.items){if(microstrategy.styleObj.getAttValue(AR.items[AB],microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_TEXT||microstrategy.styleObj.getAttValue(AR.items[AB],microstrategy.HTMLATTR_DISPLAY_STYLE)<1){return false;}}return true;case"multiButtons":return this.queryState("onlyButtons")&&AR.length>1;case"isNavBar":return AR.isOnlyOneNavBarSelected();case"showTextControl":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT])||this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER])||this.queryEnabled("showGridSelectors");case"showPadding":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT])||this.queryEnabled("showGridSelectors");case"showCorners":var AD=this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK])&&!AR.isOnlyOneTableSelected();var AG=this.queryState("isRoundShape");return((AD&&!AG)||(!AD&&AG));case"isRoundShape":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_STYLE,"hasRoundedCorners")==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);case"show3dBorders":return !this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"showTextOverflow":return this.queryState("isText")&&!this.queryState("isButton");case"showContentOverflow":return this.queryState("isPanelStack")&&!this.queryState("isNavBar")&&!AR.atLeastOneTableSelected();case"getCachedObjectFormatLevels":return this.parentBone.selections.getCachedObjectFormatLevels();case"areGridFormatsReady":return AR.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE).commands.queryState(BI);case"tbEmptySelector":return{items:[],value:""};case"tbPanelUnitSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4727")},{dssid:1,n:microstrategy.descriptors.getDescriptor("4758")}],value:AR.panelUnitFormat};case"tbTableUnitSelector":var Bg=microstrategy.descriptors;var A3=AO=="font";tus=A3?[]:[{dssid:0,n:Bg.getDescriptor("7755")}];A3&&tus.push({dssid:2,n:Bg.getDescriptor("4024")});if(A3){tus.push({dssid:3,n:Bg.getDescriptor("11176")});}return{items:tus,value:AR.panelUnitFormat};case"tbTableValueSelector":var Bg=microstrategy.descriptors;var Ay=parseInt(this.parentBone.selections.panelUnitFormat),P=AO=="font";if(P){if(Ay==2){return{items:[{dssid:1,n:Bg.getDescriptor("4756")}],enabled:false,value:AR.panelValueFormat};}else{if(Ay==3){return{items:[{dssid:1,n:Bg.getDescriptor("4756")},{dssid:3,n:Bg.getDescriptor("527")}],value:AR.panelValueFormat};}}}else{if(Ay==2){return{items:[{dssid:4,n:Bg.getDescriptor("11177")}],formatEnabled:false,value:AR.panelValueFormat};}else{if(Ay==0){return{items:[{dssid:0,n:Bg.getDescriptor("4579")}],value:AR.panelValueFormat};}}}case"tbPanelValueSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4579")},{dssid:1,n:microstrategy.descriptors.getDescriptor("3297")}],value:AR.panelValueFormat};case"tbSelectorControlUnitSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4728")}],value:AR.controlUnitFormat};case"tbSelectorControlValueSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4579")},{dssid:mstrRWControlImpl.FMT_TYPE_TITLE_BASE,n:microstrategy.descriptors.getDescriptor("3297")}],value:AR.controlValueFormat};case"tbGridContainerValueSelector":return{items:[{dssid:1,n:microstrategy.descriptors.getDescriptor("4579")},{dssid:2,n:microstrategy.descriptors.getDescriptor("3297")}],value:AR.gridValueFormatX};case"tbUnitSelector":if(this.queryEnabled("onepanelstack")){return this.queryState("tbPanelUnitSelector");}case"tbGridUnitSelector":case"AllGridUnitSelector":Au=microstrategy.findBone(AR.getSelectedGrid());if(!Au){return this.queryState("tbEmptySelector");}var AH=Au.commands.queryState(BI)||{items:[],value:""};if(Au.isGrid){var CH=[];if(AH.items.length&&AH.items[0].dssid==-1){CH=[AH.items.shift()];}var B=(BI!="AllGridUnitSelector")?"**grid":"";CH=CH.concat([{dssid:microstrategy.GRID_UNIT_CONTAINER+B,n:microstrategy.descriptors.getDescriptor("4753"),cssClass:"ToolbarList UGC"},{dssid:microstrategy.GRID_BORDERS+B,n:microstrategy.descriptors.getDescriptor("3798"),cssClass:"ToolbarList UGB"}]).concat(AH.items);AH.items=CH;}return AH;case"showEditorSelector":return !this.queryState("isNavBar");case"edtUnitSelector":var Bt={visible:false,enabled:true,items:[]};this.parentBone.selections.verifyFormatLevels(AO);if(AR.isOnlyOneGridSelected()&&AO){Au=AR.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(!Au){return this.queryState("tbEmptySelector");}var Q=Au.commands.queryState("graphMode");if(Q||microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){Bt.value=microstrategy.GRID_UNIT_CONTAINER;}else{Bt=this.queryState(AO=="color"?"AllGridUnitSelector":"GridUnitSelector");}var z=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&AO=="color");if(AO=="font"||z||Q){if(this.queryState("IsPortal")){Bt.items=[{dssid:microstrategy.GRID_UNIT_CONTAINER,n:microstrategy.descriptors.getDescriptor("4753"),cssClass:"ToolbarList UGC"}].concat(Bt.items);Bt.visible=true;}else{if(z){Bt.visible=false;}else{Bt.visible=!Q;}}}else{Bt.visible=true;}Bt.enabled=true;}else{if(AR.isOnlyOneTableSelected()){u(AR,AO);Bt=this.queryState("tbTableUnitSelector",AO);Bt.enabled=true;Bt.visible=(AO&&(AO=="color"||AO=="font"));}else{if(AR.isOnlyOnePanelStackSelected()){Bt=this.queryState("tbPanelUnitSelector");Bt.enabled=true;Bt.visible=(AO&&AO=="color");}else{if(AR.isSelectorControlSelected()){Bt=this.queryState("tbSelectorControlUnitSelector");Bt.enabled=true;Bt.visible=(AO&&(AO=="color"||AO=="font")&&this.queryState("IsPortal"));}}}}return Bt;case"edtValueSelector":var CC={visible:false,enabled:true};if(AR.isOnlyOneGridSelected()){if(AR.isGridContainerSelected()){if(AO&&(AO=="color"||AO=="font")){CC=this.queryState("tbGridContainerValueSelector");CC.visible=this.queryState("IsPortal");CC.enabled=(AO!="font");}}else{CC=this.queryState("AllGridUnitValueSelector");CC.visible=this.queryState("edtUnitSelector",AO).value>microstrategy.GRID_BORDERS;CC.enabled=true;}}else{if(AR.isOnlyOneTableSelected()){u(AR,AO);CC=this.queryState("tbTableValueSelector",AO);CC.visible=(AO&&(AO=="color"||AO=="font"));}else{if(AR.isOnlyOnePanelStackSelected()){CC=this.queryState("tbPanelValueSelector");CC.visible=(AO&&AO=="color"&&this.parentBone.commands.queryState("IsPortal"));CC.enabled=(AR.panelUnitFormat==0);}else{if(AR.isSelectorControlSelected()){CC=this.queryState("tbSelectorControlValueSelector");CC.visible=this.parentBone.selections.areAllSameSubtypeSelected(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)&&(AO&&(AO=="color"||AO=="font")&&this.parentBone.commands.queryState("IsPortal"));CC.enabled=(AR.controlUnitFormat==0);}}}}return CC;case"tbValueSelector":case"tbGridValueSelector":if(this.queryEnabled("onepanelstack")){return this.queryState("tbPanelValueSelector");}if(this.queryEnabled("onecontrol")){return this.queryState("tbSelectorControlValueSelector");}if(AR.isGridContainerSelected()&&!AR.getSelectedGridProperty("graphSelected")){AR.gridValueFormatX=Math.min(AR.gridValueFormatX,2);var AU=this.queryState("tbGridContainerValueSelector");AU.isFetching=false;return AU;}case"GridUnitSelector":case"AllGridUnitValueSelector":case"GridUnitValueSelector":Au=microstrategy.findBone(AR.getSelectedGrid());return(Au&&Au.commands.queryState(BI))||{items:[],value:""};case"PanelUnitSelector":return AR.panelUnitFormat;case"PanelUnitValueSelector":return AR.panelValueFormat;case"appliedThemeID":var Bq=AR.firstItem()&&AR.firstItem().id,A5=Bq&&BB.formattingAttributes[Bq]&&BB.formattingAttributes[Bq]["thmid"];return A5;case"appliedThemeAsLink":var Bq=AR.firstItem()&&AR.firstItem().id,E=Bq&&BB.formattingAttributes[Bq]&&BB.formattingAttributes[Bq]["thmlnk"];return !!E;case"appliedLinkedTheme":return microstrategy.hasAppliedTheme(AR.firstItem(),true);case"appliedTheme":return microstrategy.hasAppliedTheme(AR.firstItem());case"appliedThemePath":var Bq=AR.firstItem()&&AR.firstItem().id,BS=Bq&&BB.formattingAttributes[Bq]&&BB.formattingAttributes[Bq]["thmpath"];return microstrategy.isDefaultTheme(A5)?null:BS;case"appliedThemeType":var A5=this.queryState("appliedThemeID");if(!A5){return microstrategy.APPLIED_THEME_NONE;}else{if(microstrategy.isDefaultTheme(A5)){return microstrategy.APPLIED_THEME_DEFAULT;}else{return microstrategy.APPLIED_THEME_CUSTOM;}}case"showAppliedThemeAsType":return this.queryState("appliedThemeType")!==microstrategy.APPLIED_THEME_NONE;case"showCustomThemePicker":return this.queryState("appliedThemeType")===microstrategy.APPLIED_THEME_CUSTOM;case"Bold":case"Italic":case"Underline":case"FontFamily":case"FontSize":case"FontColor":case"FillColor":case"lncolor":Au=AR.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(AR.isOnlyOneGridSelected()&&Au&&Au.graphSelected){return Au.commands.queryState(BI);}else{return AR.checkFormat(BI,AO);}case"showRepeatSection":return(this.queryState("isSection")&&AR.styleObj.getAttValue(AR.firstItem(),"rps")!="0");case"visibleShowInRptCp":if(this.queryState("isSection")||!AR.items){return false;}for(var Bi in AR.items){var Bc=microstrategy.findAncestorWithAtt(AR.items[Bi],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);if(Bc){if(microstrategy.styleObj.getAttValue(Bc,microstrategy.HTMLATTR_REPEAT_SECTION)!="-1"){return false;}var BC=Bc.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION);if(BC=="-1"||BC=="-3"){return false;}}}return true;case"enableHorizontal":return microstrategy.isEnabled(AR.items,"textAlign");case"showSecondaryDataProviders":var Ah=this.parentBone.parentBone.getAvailableWidgets(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);var y=this.queryState("setWidget");for(var BX in Ah){var AA=Ah[BX];if(AA.dssid==y){return AA.mnsp>0||AA.mxsp>0;}}return false;case"availableSecondaryDataProviders":var CH=[];if(!this.queryState("isOneGrid")){return CH;}var Bk=this.parentBone.parentBone.dataProviderNames;var B7=null;for(var AE in Bk){if(AE==AR.getSelectedGrid().id){B7=Bk[AE][1];break;}}for(var AE in Bk){if(AE==AR.getSelectedGrid().id||Bk[AE][1]>B7){continue;}CH.push({dssid:AE,n:Bk[AE][0]});}CH=CH.sort(function(CM,g){if(CM.n<g.n){return -1;}if(CM.n>g.n){return 1;}return 0;});return CH;case"SecondaryDataProviders":var CH=[];var BK=this.getCommonAttValue(T,microstrategy.HTMLATTR_SEC_DATA_PROVIDERS,"SecondaryDataProviders");BK=BK?BK.split(","):[];var BF=this.queryState("availableSecondaryDataProviders");for(var BE in BK){for(var Bi in BF){if(BK[BE]==BF[Bi].dssid){CH.push(BF[Bi]);}}}return CH;case"pivotButtons":return mstr.behaviors.featureResolver.featAvailable("check-show-pivot-buttons");case"sortButtons":return mstr.behaviors.featureResolver.featAvailable("check-show-sort-buttons");case"toggleSnap":return !microstrategy.SNAP_OFF;case"graphZones":var Bz=microstrategy.findBone(AR.getSelectedGrid());return(Bz.zonesEditor)?true:false;case"DataFilterMode":if(this.queryState("isMetricQualifier")){return 1;}if(!this.queryEnabled("DataFilterModeEnabled")){return 1;}var BW=AR.firstItem();var Ax=BB.formattingAttributes[BW.id]&&BB.formattingAttributes[BW.id]["dfm"];return Ax==undefined?1:Ax;case"stateUCVisible":return this.queryState("DataFilterMode")==1||(this.queryState("isNormalSelector")&&this.queryState("isDSAsTarget"));case"isSlicingSelector":return this.queryState("DataFilterMode")==0||this.queryState("isPanelStackSelector");case"SelectionColor":return(microstrategy.styleObj.getAttValue(AR.firstItem(),microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE)=="1")?microstrategy.styleObj.getAttValue(AR.firstItem(),microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR):"automatic";case"widgetId":var S=this.parentBone.parentBone.curWgtId;if(S){return S;}if(AR&&AR.isOnlyOneGridSelected()){var Bj=microstrategy.findBone(AR.getSelectedGrid());if(Bj){if(Bj.curWgtId){return Bj.curWgtId;}}}return"";case"isPageHeaderSection":return this.queryState("isSection")&&this.belongsToSectionOfTypes([6]);case"isPageFooterSection":return this.queryState("isSection")&&this.belongsToSectionOfTypes([7]);case"isInFilterPanel":var Bc=microstrategy.findAncestorWithAtt(AR.firstItem(),microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(Bc&&Bc.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var Bo=microstrategy.findBone(Bc);return Bo&&Bo.isFilterPanel;}return false;case"isInsideNavBar":return AR.isItemInsideNavBar();case"showTranslucent":if(!this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK])){return false;}var BJ=this.queryState("InfoWindowMode");return this.queryState("UseAsInformationWindow")&&(BJ==="2"||BJ==="3"||BJ==="4");case"Transparency":return this.getCommonAttValue(T,microstrategy.HTMLATTR_PS_TRANSPARENCY,"Transparency");case"Blur":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_PS_BLUR,"Blur")==="-1");case"optionAllVisible":case"allAliasVisible":return !this.queryState("isMetricQualifier")&&!this.queryState("isDDIC")&&!this.queryState("isAQSelector");case"DisplayInPartialScreen":return(this.getCommonAttValue(T,"dips","DisplayInPartialScreen")==="-1");case"InitialSlidingInWidthEnabled":var BG=this.queryState("InfoWindowPosition");return this.queryState("UseAsInformationWindow")&&this.queryState("DisplayInPartialScreen")&&this.queryState("InfoWindowMode")==="4"&&(BG==="3"||BG==="4");case"InitialSlidingInHeightEnabled":var BG=this.queryState("InfoWindowPosition");return this.queryState("UseAsInformationWindow")&&this.queryState("DisplayInPartialScreen")&&this.queryState("InfoWindowMode")==="4"&&(BG==="1"||BG==="2");case"ShowAsCollapsiblePanel":return(this.getCommonAttValue(T,"sacp","ShowAsCollapsiblePanel")==="-1");case"enableEmbeddedImages":return BB.EnableEmbeddedImages==="1";case"InitialSlidingInWidth":case"InitialSlidingInHeight":default:return AR.checkFormat(BI,AO);}}catch(L){microstrategy.errors.log(L);}return null;};mstrDocCommandsImpl.prototype.queryVisible=function(B){var C=this.parentBone.selections;if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(B)){if(!C||!C.isOnlyOneGridSelected()){return false;}var E=microstrategy.findBone(C.getSelectedGrid());if(!E){return false;}E=(E instanceof mstrReportGraphImpl)?E:microstrategy.bone(E.id+"_graph");return(E&&E.commands)?E.commands.queryVisible(B):false;}try{var A,E;switch(B){case"showCreatePanelSelector":return this.queryEnabled("onepanelstack")&&!this.queryEnabled("oneTable");case"tbUnitSelector":if(!this.queryEnabled("isNotLinkedGraph")){return false;}if(this.queryEnabled("onepanelstack")){return true;}return(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.queryEnabled("onegrid"));case"tbValueSelector":if(!this.queryEnabled("isNotLinkedGraph")){return false;}if(this.queryEnabled("onepanelstack")){return(this.queryState("IsPortal")&&this.parentBone.selections.panelUnitFormat!=1);}if(this.queryEnabled("onecontrol")){return(this.queryState("IsPortal")&&this.parentBone.selections.controlUnitFormat!=4);}if(!this.queryEnabled("onegrid")){return false;}if(this.parentBone.selections.isGridContainerSelected()){if(!this.queryState("IsPortal")){return false;}}else{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.parentBone.selections.gridUnitFormatX==microstrategy.GRID_BORDERS){return false;}}return true;case"TextAlign":return !(this.queryEnabled("onegrid")&&microstrategy.formatType!=2);case"GridHorizontal":return this.queryEnabled("onegrid")&&microstrategy.formatType!=2;case"visFlashMode":case"visAjaxMode":A="visualizations-supported;visualizations-available-for-rw-grids";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}if(!C||!C.isOnlyOneGridSelected()){return false;}E=microstrategy.findBone(C.getSelectedGrid());return(E&&E.commands)?E.commands.queryVisible(B):false;case"gridSelectedVisualization":A="visualizations-supported;visualizations-available-for-rw-grids";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}if(!C||!C.isOnlyOneGridSelected()){return false;}E=microstrategy.findBone(C.getSelectedGrid());return(E&&E.commands)?E.commands.queryVisible("selectedVisualization"):false;case"tbLoading":return false;case"openBasicConditionalFormatting":A="rw-interactive-view-mode-eplus;use-basic-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}return this.queryEnabled("openBasicConditionalFormatting");case"openAdvConditionalFormatting":A="rw-interactive-view-mode-eplus;use-advanced-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}return this.queryEnabled("openAdvConditionalFormatting");case"openSimpleThresholdEditor":A="rw-interactive-view-mode-eplus;use-basic-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}return !this.queryEnabled("openBasicConditionalFormatting");case"openAdvThresholdEditor":A="rw-interactive-view-mode-eplus;use-advanced-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}return !this.queryEnabled("openAdvConditionalFormatting");case"showApplyThemeOnNode":case"showPropertiesAndFormatting":E=microstrategy.findBone(C.getSelectedGrid());return mstr.behaviors.featureResolver.featAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS)||(mstr.behaviors.featureResolver.featAvailable("rw-interactive-view-mode")&&this.parentBone.selections.isOnlyOneGridSelected()&&E.commands.queryState("gridType")!="flash");default:return true;}}catch(D){}return false;};mstrDocCommandsImpl.prototype.searchForSelectedObjectType=function(G){try{if(G==null||G.length==0){return true;}var E="~"+G.join("~")+"~";var I="";var F=0;var C=0;var B=this.parentBone.selections;var A=B.getTypes();if(A==null||A.length==0){return false;}var K=E.split(/obj.52\|/g);if(K.length>1){for(F=1,C=K.length;F<C;F++){I+="~"+(parseInt(K[F].charAt(0))+1);}I+="~";}var H=B.getItems();for(F=0,C=A.length;F<C;F++){if(I.length>0&&A[F]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var J=microstrategy.findBone(H[F]);if(I.indexOf("~"+J.commands.queryState("effectiveView")+"~")>-1){return true;}}else{if(A[F]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE){if(E.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE+"~")>-1){return true;}if(E.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND+"~")>-1){if(H[F].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){return true;}}}else{if(E.indexOf("~"+A[F]+"~")>-1){return true;}}}}return false;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocCommandsImpl.prototype.ensureSelectedObjectTypes=function(G){try{if(G==null||G.length==0){return false;}var D="~"+G.join("~")+"~";var I="";var E=0;var B=0;var A=this.parentBone.selections.getTypes();if(A==null||A.length==0){return false;}var K=D.split(/obj.52\|/g);if(K.length>1){for(E=1,B=K.length;E<B;E++){I+="~"+(parseInt(K[E].charAt(0))+1);}I+="~";}var H=this.parentBone.selections.getItems();for(E=0,B=A.length;E<B;E++){if(I.length>0&&A[E]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var J=microstrategy.findBone(H[E]);if(I.indexOf("~"+J.commands.queryState("effectiveView")+"~")==-1){return false;}}else{if(A[E]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE){var F=H[E].getAttribute(microstrategy.HTMLATTR_STYLE);if(F==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){if(D.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND+"~")==-1){return false;}}else{if(D.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE+"~")==-1){return false;}}}else{if(!D.match(new RegExp("~"+A[E]+"~"))){return false;}}}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocCommandsImpl.prototype.getCurrentSectionDef=function(){var F=microstrategy.findAncestorWithAtt(this.parentBone.selections.firstItem(),microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION),B=microstrategy.findBone(F),D=this.parentBone.parentBone,A=D&&D.sectionsList,G=B.id,E=null;if(G&&A){for(var C=0;C<A.length;C++){if(A[C].d===G){E=A[C];break;}}}return E;};mstrDocCommandsImpl.prototype.belongsToSectionOfTypes=function(A){var B=this.getCurrentSectionDef();return B&&A&&(mstr.utils.Arrays.find(A,B.t)>-1);};mstrDocCommandsImpl.prototype.getCommonAttValue=function(G,H,A,J,E){try{var F="";var B=false;if(typeof (J)=="undefined"){J=false;}for(var C in G){if(A&&!microstrategy.isEnabledForItem(G[C],A)){continue;}if(G[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_LINE&&J==false){if(A=="widthMode"||A=="heightMode"||A=="width"||A=="height"){continue;}}var I=this.parentBone.styleObj.getAttValue(G[C],H,E);if(!B){F=I;B=true;}if(I!=F){return null;}}return F;}catch(D){microstrategy.errors.log(D);return null;}};mstrDocCommandsImpl.prototype.getCommonBoneProperty=function(C,G,B,E){try{for(var F in C){if(C[F].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&C[F].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==B){var A=mstrStaticDoc.getBone(C[F]);if(A){if(A[G]!=E){return A[G];}}}}}catch(D){microstrategy.errors.log(D);}return E;};mstrDocCommandsImpl.prototype.getDDICBoneProperty=function(H,A,E,J){try{for(var B in H){var K=H[B],I=mstrStaticDoc.getBone(K);while(K&&!I){K=K.parentElement;I=microstrategy.findBone(K);}if(I){var K=H[B],G=I.tscObjs;for(var D in G){var F=G[D];if(F.key===K.id){return F[A]||F.ctl&&F.ctl[A]||F.ctl&&F.ctl.ddic&&F.ctl.ddic[A]||J;}}}}}catch(C){microstrategy.errors.log(C);}return J;};mstrDocCommandsImpl.prototype.setDDICBoneProperty=function(G,A,I){try{for(var B in G){var J=G[B],H=mstrStaticDoc.getBone(J);while(J&&!H){J=J.parentElement;H=microstrategy.findBone(J);}if(H){var J=G[B],F=H.tscObjs;for(var D in F){var E=F[D];if(E.key===J.id){E.ctl.ddic[A]=I;}}}}}catch(C){microstrategy.errors.log(C);}};mstrDocCommandsImpl.prototype.isTypeSelectedInOB=function(C){try{var E=microstrategy.bone("reportObjs_RWWorkingSetStyle");if(E){var B=E.selections;if(B.length>0){var A=mstr.utils.Arrays.fromHashValues(B.items)[0];if(A){if(A.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==C){return true;}}}}return false;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocCommandsImpl.prototype.isDesignMode=function(){try{return microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;}catch(A){microstrategy.errors.log(A);return false;}};function mstrDocCommandsImpl(){return this;}menuScript=true;var oSubCTimer=null;var oSubPkrTimer=null;var bIsOverContext=false;var bDisplayLeft=false;var sQuote="\\'";var sQuoteSimple="'";var sQuoteDouble='"';var aOndemandMenuItems=null;var aMenuItems=null;var aMenuItemsName;var sDrillContextMenuExtraArg1;var currentPicker=null;var specialMenuLayers=null;mstrMenuObj.prototype=new Object();function mstrMenuObj(A){}mstrMenuObj.adjustMenuPositionForClient=function(I,H,B,D){if(B.getAttribute("origHeight")){B.style.height=B.getAttribute("origHeight")+"px";}if(B.getAttribute("origWidth")){B.style.width=B.getAttribute("origWidth")+"px";}var F=B.getAttribute("ty")=="cxt";var J=getObjWidth(F?B.firstChild:B);if(J+I<getClientWidth()+getDocumentScrollLeft()){if(bDisplayLeft&&D){I=D-J+2;}else{bDisplayLeft=false;}}else{bDisplayLeft=true;if(D){I=D-J+2;}else{I=I-J+10;}}var A=getClientHeight();var C=getObjHeight(F?B.firstChild:B);var G=getDocumentScrollTop();var E=(H+C)-(G+A);if(C>A){H=G+1;if(E>0){if(!B.getAttribute("origHeight")){B.setAttribute("origHeight",C);}if(!B.getAttribute("origWidth")){B.setAttribute("origWidth",J);}if(!F){B.style.height=Math.min(C,A)+"px";B.style.width=Math.min(J,J+B.offsetWidth-B.clientWidth)+"px";B.style.overflowY="auto";}}}else{if(E>0){H=G+A-C-2;}}if(F){B.style.height=Math.min(C,A)+"px";B.style.width=Math.min(J,J+B.offsetWidth-B.clientWidth)+"px";if(B.offsetHeight<C){if(bIsIE7){B.style.overflow="auto";}else{B.style.overflowY="auto";}}}moveObjTo(B,I,H);};function displayContextMenu(oTarget,e,moveMenu){var sMenu=oTarget.getAttribute("CX");if(sMenu.length==0){return true;}var menuDefTarget=findTarget(oTarget,"CXID");var aMenuElementsName=menuDefTarget.getAttribute("CXID");var aMenuElements=microstrategy.getContextMenuManager(aMenuElementsName).menu_items;if(!aMenuElements||aMenuElements.length==0){return false;}var sDrillExtraArgument1=oTarget.getAttribute("D1");var types=oTarget.getAttribute("cxty");if(typeof (microstrategy)!="undefined"){microstrategy.updateActiveCXProps(oTarget,e);}hideContextMenus();getMouse(e);aMenuItems=aMenuElements;aMenuItemsName=aMenuElementsName;sDrillContextMenuExtraArg1=sDrillExtraArgument1;var avMenu=eval(sMenu);buildContextMenu(avMenu,1,eval(types),oTarget,false,null);if(hasMenuItem(avMenu,eval(types))){var menuX,menuY;if(moveMenu){var tID=oTarget.id;var menuX=getObjSumLeftScrolled(tID)+3;var menuY=getObjSumTopScrolled(tID)+getObjHeight(tID)+4;oTarget.onmouseout=function(){OutContext();};}else{menuX=lMouseX-microstrategy.CURSOR_OFFSET;menuY=lMouseY-microstrategy.CURSOR_OFFSET;}positionContextMenu(menuX,menuY,aMenuItemsName+"1");if(bIsIE4){togglePulldowns(getObj(aMenuItemsName+"1"),false);}document.getElementById(aMenuItemsName+"1").style.visibility="visible";microstrategy.setContextMenuStatus(true);}return false;}function isMenuShown(menuItem,selectedTypes){var supportedTypes=menuItem[5];var showJS=menuItem[6];var displayMenuItem=true;var __result=true;if(supportedTypes&&supportedTypes.length>0&&selectedTypes&&selectedTypes.length>0){var supportedTypesArray=eval(supportedTypes);__result=false;for(var j=0;j<selectedTypes.length;j++){for(var i=0;i<supportedTypesArray.length;i++){if(selectedTypes[j]==supportedTypesArray[i]){__result=true;break;}}if(__result){break;}}}if(showJS&&showJS.length>0&&__result==true){if(showJS=="$check-subMenu-existence$"){var subs=eval(menuItem[4]);var n=subs.length;if(n>0){for(var i=0;i<n;i++){var sub=aMenuItems[subs[i]];if(sub){__result=isMenuShown(sub,selectedTypes);if(__result){break;}}}}else{__result=false;}}else{__result=eval(showJS)?true:false;}}return __result;}function getPicker(D){var E=document.getElementsByName(D);var A=null;var C=document.body.childNodes;for(var B=0;B<C.length;B++){if(C[B].id==D){A=C[B];break;}}if(E){if(!A){while(E.length>1){E[0].parentNode.removeChild(E[0]);}A=document.body.appendChild(E[0]);}}return A;}function showPicker(A,E,H,G,F){var C=getPicker(E);if(C){if(A){currentPicker=C;var B=aMenuItemsName+F;var D=getElementById(B);if(D){C.style.zIndex=D.style.zIndex+100;}C.style.visibility="hidden";C.style.display="block";mstrMenuObj.adjustMenuPositionForClient(H,G,C);if(bDisplayLeft){C.style.left=parseInt(C.style.left,10)-getObjWidth(D)+"px";}C.style.visibility="visible";}else{C.style.display="none";currentPicker=null;}}}function buildContextMenuRows(avItems,iMenu,types,oTarget,loadOndemandMenuItems,modelID){var sContent="";var lRowCount=0;var sRowID="";var sSubCommand="";var sOnClickLink="";var hasMenuItem=false;var enabled=true;if(!oTarget){oTarget=microstrategy.activeCXMenu;}var aMenuItemsLocal=null;if(loadOndemandMenuItems){aMenuItemsLocal=aOndemandMenuItems;lRowCount=getNumTagsInDiv(aMenuItemsName+iMenu,"tr");}else{aMenuItemsLocal=aMenuItems;}for(var iIndex=0;iIndex<avItems.length;iIndex++){if(aMenuItemsLocal[avItems[iIndex]][3]!=2){if(isMenuShown(aMenuItemsLocal[avItems[iIndex]],types)){hasMenuItem=true;var menuClass="menu-item";var menuClassWithSeparator="menu-item-with-separator";var separatorClass="menu-item-separator";enabled=true;var enableJS=aMenuItemsLocal[avItems[iIndex]][7];if(enableJS&&enableJS.length>0){enabled=eval(enableJS);}if(!enabled||aMenuItemsLocal[avItems[iIndex]][8]==1){menuClass="menu-item-disabled";menuClassWithSeparator="menu-item-disabled-with-separator";}sRowID="cm"+iMenu+"r"+lRowCount;sContent+='<TR ID="'+sRowID+'" HEIGHT="18" AC="true" ';var cmd=aMenuItemsLocal[avItems[iIndex]][1];if(menuClass=="menu-item"){cmd=replacePlaceholders(cmd,oTarget);if(aMenuItemsLocal[avItems[iIndex]][3]==1){var typesString=convertArrayToString(types);if(aMenuItemsLocal[avItems[iIndex]][10]!=null){var ondemandModelId=aMenuItemsLocal[avItems[iIndex]][10];var ondemandDynamicMenuKey=aMenuItemsLocal[avItems[iIndex]][11];var ondemandViewId=aMenuItemsLocal[avItems[iIndex]][12];sSubCommand="buildSubMenu("+aMenuItemsLocal[avItems[iIndex]][4]+", "+(iMenu+1)+", getObjSumTop("+sQuote+sRowID+sQuote+"), ["+typesString+"], "+loadOndemandMenuItems+", "+sQuote+ondemandModelId+sQuote+", "+sQuote+ondemandDynamicMenuKey+sQuote+", "+sQuote+ondemandViewId+sQuote+" );";}else{sSubCommand="buildSubMenu("+aMenuItemsLocal[avItems[iIndex]][4]+", "+(iMenu+1)+", getObjSumTopScrolled("+sQuote+sRowID+sQuote+"), ["+typesString+"], "+loadOndemandMenuItems+");";}sContent+="onMouseOver=\"clearTimeout(oSubCTimer); delaySubCMenus('"+sSubCommand+"'); menuOn(this);\" ";sContent+='onMouseOut="menuOff(this);" LI="sub" ';}else{if(aMenuItemsLocal[avItems[iIndex]][3]==3){sSubCommand="hideContextSubMenus("+iMenu+"); showPicker(true,"+sQuote+aMenuItemsLocal[avItems[iIndex]][4]+sQuote+",getObjWidth("+sQuote+sRowID+sQuote+") + getObjSumLeft("+sQuote+sRowID+sQuote+"), getObjSumTop("+sQuote+sRowID+sQuote+"),"+iMenu+");";sContent+="onMouseOver=\"clearTimeout(oSubCTimer); delaySubCMenus('"+sSubCommand+"'); menuOn(this);\"";sContent+='onMouseOut="menuOff(this);"';var pkr=getPicker(aMenuItemsLocal[avItems[iIndex]][4]);if(pkr){pkr.onmouseover=new Function("clearTimeout(oSubPkrTimer);");pkr.onmouseout=new Function("OutContext();");pkr.onmousedown=new Function("e","if (!e) {e=window.event;} eval("+cmd+");OutContext();");}}else{sContent+='onMouseOver="clearTimeout(oSubCTimer); menuOn(this);';sContent+=" hideContextSubMenus("+iMenu+");";sContent+='" onMouseOut="menuOff(this);" ';sOnClickLink=cmd;if(sOnClickLink.indexOf("DCM")!=-1){if(sDrillContextMenuExtraArg1==null){sOnClickLink=sOnClickLink.substr(0,sOnClickLink.indexOf(")"))+",'')";}else{sOnClickLink=sOnClickLink.substr(0,sOnClickLink.indexOf(")"))+",'"+sDrillContextMenuExtraArg1+"')";}}sContent+="onClick=\"menuClick(this, '"+aMenuItemsName+iMenu+'\');" LI="'+sOnClickLink+';" ';}}if(bIsW3C){sContent+='STYLE="cursor: pointer;"';}else{sContent+='STYLE="cursor: hand;"';}}var isNextMenuOptionASeparator=isNextMenuSeparator(aMenuItemsLocal,avItems,iIndex,types);sContent+=">\n";sContent+='<TD WIDTH="12" ALIGN="MIDDLE" CLASS="mstrContextMenuLeft"';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+=">";switch(aMenuItemsLocal[avItems[iIndex]][2]){case 0:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 1:var showCheck=true;var checkJS=aMenuItemsLocal[avItems[iIndex]][9];if(checkJS&&checkJS.length>0){showCheck=eval(checkJS);}if(showCheck){sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuCheck.gif" WIDTH="12" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';}break;case 2:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'CMenuRemove.gif" WIDTH="11" HEIGHT="11" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" /><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="1" HEIGHT="1" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 3:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'CMenuSubtotal.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 4:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillUp.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 5:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillDown.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 6:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillTemplate.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 7:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'drill.png" WIDTH="16" HEIGHT="16" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 8:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'treeLoading.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;}sContent+="</TD>";sContent+='<TD WIDTH="1"';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+='><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"></TD>';sContent+='<TD ALIGN="LEFT" NOWRAP="1" ';if(isNextMenuOptionASeparator){sContent+=" class="+menuClassWithSeparator+" ";}else{sContent+=" class="+menuClass+" ";}sContent+=">"+aMenuItemsLocal[avItems[iIndex]][0]+"&nbsp;&nbsp;<BR/></TD>";sContent+='<TD WIDTH="12" ALIGN="RIGHT" NOWRAP="1" ';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+=">";if(aMenuItemsLocal[avItems[iIndex]][3]==1||aMenuItemsLocal[avItems[iIndex]][3]==3){var expandImage=enabled?"MenuExpand.gif":"MenuExpand_off.gif";sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+expandImage+'" WIDTH="8" HEIGHT="9" ALT="" BORDER="0" /><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="2" HEIGHT="1" ALT="0" BORDER="0" />';}else{sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" ALT="0" BORDER="0" />';}sContent+="</TD></TR>\n";lRowCount++;}}}return sContent;}function replacePlaceholders(str,oTarget){var matched=false;var tempStr=str;if(tempStr.indexOf("%40")>-1){tempStr=unescape(tempStr);}if(tempStr.indexOf("@")>-1){tempStr=tempStr.replace(/@[^@]+@/g,function(token){matched=true;var attName=token.substring(1,token.length-1);if(attName.indexOf("__bone__")>-1){attName=attName.replace("__bone__","microstrategy.findBone(microstrategy.activeCXMenu)");return eval(attName);}else{return oTarget.getAttribute(attName)||"";}});}if(matched){return tempStr;}else{return str;}}function isNextMenuSeparator(E,A,D,C){for(var B=D+1;B<A.length;B++){if(isMenuShown(E[A[B]],C)){return(E[A[B]][3]==2);}}return false;}function getMenuDiv(B){var A=getObj(B);if(!A){A=document.createElement("DIV");A.setAttribute("id",B);A.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_CONTEXT_MENU);A.onmouseover=OverContext;A.onmouseout=OutContext;A.style.visibility="hidden";A.style.position="absolute";A.style.backgroundColor="#FFFFFF";A.style.border="1px #ddd solid";A.style.top="-999px";document.body.appendChild(A);}return A;}function buildContextMenu(B,H,E,C,F,G){var D="";D='<TABLE BORDER="0" CELLSPACING="0" CLASS="mstrContextMenuRight">\n';D+=buildContextMenuRows(B,H,E,C,F,G);D+="</TABLE>";var A=getMenuDiv(aMenuItemsName+H);A.innerHTML=D;}function hasMenuItem(A,B){for(var C=0;C<A.length;C++){if(aMenuItems[A[C]][3]!=2){if(isMenuShown(aMenuItems[A[C]],B)){return true;}}}return false;}function upClick(C){if(bIsW3C&&!C){return false;}var B=(bIsIE4)?(event.button==2||event.button==3):(C.button==3);if(B){var A=getEventTarget(C);A=findTarget(A,"CX");if(A){document.onmouseup=null;return false;}}}function OverContext(){bIsOverContext=true;}function OutContext(){clearTimeout(oSubCTimer);bIsOverContext=false;}function hideContextMenus(){if(typeof (aMenuItemsName)=="undefined"){return ;}if(!bIsOverContext){hideContextSubMenus(1);var A=getObj(aMenuItemsName+"1");if(A){A.style.visibility="hidden";A.style.top="-999px";microstrategy.setContextMenuStatus(false);A.innerHTML="";}if(bIsIE4){togglePulldowns(A,true);}}}function hideContextSubMenus(C){var B=1;for(var B=4;B>C;B--){var A=getObj(aMenuItemsName+B);if(A){A.style.visibility="hidden";A.innerHTML="";if(bIsIE4){togglePulldowns(A,true);}}}if(currentPicker!=null){currentPicker.style.display="none";currentPicker=null;}}function buildSubMenu(C,D,K,H,F,B,L,A){var G=aMenuItemsName+D;var I=getMenuDiv(G);I.modelID=B;if(bIsIE4){I.style.height="auto";I.style.width="auto";I.style.overflowY="visible";}I.style.zIndex=1000;buildContextMenu(C,D,H,null,F,B);addOndemandSubMenuItems(B,L,A,D);if(I.childNodes.length==0){return ;}var E=getObjLeft(aMenuItemsName+(D-1));var J=getObjWidth(aMenuItemsName+(D-1));positionContextMenu(E+J-2,K,G,E);if(bIsIE4){togglePulldowns(getObj(aMenuItemsName+D),false);}hideContextSubMenus(D);document.getElementById(aMenuItemsName+D).style.visibility="visible";}function delaySubCMenus(sExecuteText){clearTimeout(oSubCTimer);if(sExecuteText.length>0){if(bIsInPortal&&mstr.utils.ISFF3){eval(sExecuteText);}else{oSubCTimer=window.setTimeout(sExecuteText,250);}}}function positionContextMenu(E,C,D,B){if(bIsIE4){var A=D;if(typeof (A)=="string"){A=document.getElementById(D);}if(A){A.style.height="auto";A.style.width="auto";A.style.overflowY="visible";}}var A=getObj(D);A.style.zIndex=1000;mstrMenuObj.adjustMenuPositionForClient(E,C,A,B);}function generateLink(A){A+="&innerWidth="+getClientWidth()+"&innerHeight="+getClientHeight();return A;}function submitCM(D,B,E){if(B){D=D+"&iframe=true";}var A=true;if(microstrategy&&microstrategy.eventManager){A=microstrategy.eventManager.notifyOrphanBones("onmenusubmitform");}if(A){var C=createDynamicForm(D);if(B){C.target="frameManager";}if(E!=null){C.target=E;}}submitForm(C);}dropDownMenusScript=true;var oTimer=null;var bIsOver=false;var oSubTimer=null;var bMenuOpen=false;var bCompleted=false;var asBranch=new Array();var nBranchElements=0;var bClickStyle=false;function activateHeader(F,E,D){for(var B=0;B<iMainMenus;B++){var A=getObj("menuHeader"+B);if(A){var C=A.getAttribute("E")=="0";if(!C){if(B==F){A.className=E;}else{A.className=D;}}}}}function fixMenus(A){var B;for(i=0;i<A.length;i++){B=getObj(A[i][1]);if(B){B.setAttribute(A[i][2],A[i][3]);}}B=B=getObj("mb"+A[0][0]);if(B){B.setAttribute("C","0");}}function updateCheckedAndEnabledOptions(menuName){var menu=getObj(menuName);var TABLEs=menu.getElementsByTagName("TABLE");TABLEs[0].className="menu-block";var TRs=TABLEs[0].getElementsByTagName("TR");var menuUpdated=false;var newValue;var wasChecked;var wasEnabled;var wasShown;var baseBone;for(i=0;i<TRs.length;i++){baseBone=TRs[i].getAttribute("BB");wasChecked=TRs[i].getAttribute("H");wasEnabled=TRs[i].getAttribute("E");wasShown=(TRs[i].style.display!="none");if(baseBone&&baseBone.length>0&&!(microstrategy&&microstrategy.bone(baseBone))){continue;}var auxStr=TRs[i].getAttribute("DS");if(auxStr&&auxStr.length>0){newValue=eval(auxStr);if(newValue!=wasShown){menuUpdated=true;if(newValue){TRs[i].style.display="";}else{TRs[i].style.display="none";continue;}}}var auxStr=TRs[i].getAttribute("DC");if(auxStr&&auxStr.length>0){newValue=eval(auxStr)?"1":"0";if(newValue!=wasChecked){TRs[i].setAttribute("H",newValue);menuUpdated=true;}}auxStr=TRs[i].getAttribute("DE");if(auxStr&&auxStr.length>0){newValue=eval(auxStr)?"1":"0";if(newValue!=wasEnabled){TRs[i].setAttribute("E",newValue);menuUpdated=true;}}}if(menuUpdated){menu.setAttribute("C","0");}}function completeMenu(A){var E;var C;var F=getObj(A);var D=F.getElementsByTagName("TABLE");D[0].className="menu-block";var B=D[0].getElementsByTagName("TD");for(i=0;i<B.length;i++){if(B[i].id=="blank"){B[i].width="1";B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="1" HEIGTH="1">';}else{if(B[i].id=="mnI"){B[i].align="middle";if(B[i].parentNode.getAttribute("E")=="1"){B[i].className="menu-item-image";}else{B[i].className="menu-item-image-disabled";}if(B[i].parentNode.getAttribute("H")=="1"){B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuCheck.gif" style="width:12px;height:9px;">';}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif">';}}else{if(B[i].id=="mnT"||B[i].id=="mnS"){B[i].noWrap=true;C=(B[i].parentNode.getAttribute("E")=="1");if(C){B[i].className="menu-item";}else{B[i].className="menu-item-disabled";}if(B[i].parentNode.getAttribute("AS")=="1"){if(C){B[i].className="menu-top-separator";}else{B[i].className="menu-top-separator-disabled";}}}else{if(B[i].id=="mnE"){B[i].width="12";B[i].align="right";C=(B[i].parentNode.getAttribute("E")=="1");if(B[i].parentNode.getAttribute("AS")=="1"){if(C){B[i].className="menu-top-separator";}else{B[i].className="menu-top-separator-disabled";}}if(B[i].parentNode.getAttribute("SB")=="1"){if(C){B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuExpand.gif" WIDTH="8" HEIGTH="9">';}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuExpand_off.gif" WIDTH="8" HEIGTH="9">';}}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGTH="10">';}}}}}}F.setAttribute("C","1");bCompleted=true;}function ShowLayer(G,E){if(oTimer){clearTimeout(oTimer);}HideAllLayers();if(isNaN(G)){if(specialMenuLayers==null){specialMenuLayers=[];}specialMenuLayers.push(G);}var F=getObj("mb"+G);if(F.getAttribute("C")!="1"){completeMenu("mb"+G);}var B=(E)?E:("menuHeader"+G);var C=getObjSumTop(B)+getObjHeight(B);var D=getObjSumLeftScrolled(B);var A=getObj("mb"+G);A.style.zIndex=1000;positionContextMenu(D,C,A);if(bIsIE4){togglePulldowns(A,false);}asBranch[0]="mb"+G;nBranchElements=1;A.style.visibility="visible";bMenuOpen=true;}function hidePopupMenus(A){hideContextMenus();if(A||(bClickStyle&&bMenuOpen)){UnselectAllLayers();}}function UnselectAllLayers(){if(!bIsOver&&typeof (iMainMenus)!="undefined"){HideAllLayers();var B;for(var A=0;A<iMainMenus;A++){B=getObj("menuHeader"+A);if(B){if(B.getAttribute("E")=="0"){B.className=mstrMenuDisabledClass;}else{B.className=mstrMenuEnabledClass;}}}bMenuOpen=false;}}function HideAllLayers(){nBranchElements=0;if(!bIsOver&&typeof (iSubMenus)!="undefined"){for(var A=0;A<iSubMenus;A++){var B=document.getElementById("mb"+A);if(B){B.style.visibility="hidden";}}if(specialMenuLayers!=null){for(var A=0;A<=specialMenuLayers.length;A++){document.getElementById("mb"+specialMenuLayers[A]).style.visibility="hidden";}specialMenuLayers=null;}if(bIsIE4){togglePulldowns(null,true);}}bMenuOpen=false;}function OverLayer(){if(oTimer){clearTimeout(oTimer);}bIsOver=true;}function OutLayer(){if(oTimer){clearTimeout(oTimer);}bIsOver=false;if(!bClickStyle){oTimer=setTimeout("UnselectAllLayers()",300);}}function hideSubMenu(F,C,B){var E=false;var A=0;for(i=0;i<nBranchElements;i++){if(E){var D=document.getElementById(asBranch[i]);if(D){if(bIsIE4){togglePulldowns(D,true);}D.style.visibility="hidden";}asBranch[i]=0;}if(asBranch[i]==C){E=true;A=i+1;}}nBranchElements=A+1;asBranch[nBranchElements-1]=F;}function menuOn(A){if(A.className!="menuDisabled"){A.className="menu-row-selected";}}function menuOff(A){if(A.className!="menuDisabled"){A.className="menu-row";}}function menuClick(oMenuItem,sMenu){var oMenu=typeof (sMenu)=="string"?document.getElementById(sMenu):sMenu;if(oMenu.modelID){var model=mstr.$obj(oMenu.modelID);if(model){var state=model.get("readyState");if(state&&state===mstr.Enum.Widget.READYSTATE.WAITING){return ;}}}if(oMenuItem.className!="menuDisabled"){if(oMenuItem.getAttribute("AC")=="true"){var sLink=oMenuItem.getAttribute("LI");if(sLink.length>0){bIsOverContext=false;oMenu.style.visibility="hidden";hideContextMenus();window.mstrSubmitLink=true;eval(sLink);}}else{bIsOverContext=false;oMenu.style.visibility="hidden";HideAllLayers();hideContextMenus();}}}function onCl(A){onMv(A);ShowLayer(A.getAttribute("ndx"));}function onMv(C){var B=C.getAttribute("E")=="0";var A=C.getAttribute("ndx");updateCheckedAndEnabledOptions("mb"+A);if(getObj("mb"+A).getAttribute("C")!="1"){completeMenu("mb"+A);}if(!B){if(bMenuOpen){activateHeader(A,"menu-header-selected","menu-header");ShowLayer(A);}else{activateHeader(A,"menu-header-selected","menu-header");}}}function onMo(B){var A=B.getAttribute("E")=="0";if(!A){if(!bMenuOpen){B.className="menu-header";}else{OutLayer("menu-header","menu-header-disabled");}}}function convertArrayToString(A){var C="";if(A){for(var B=0;B<A.length;B++){if(A[B]){C=C+sQuote+A[B]+sQuote+", ";}else{C=C+"null, ";}}C=C.substr(0,C.length-2);}return C;}function buildWidgetSubMenu(C,J,Q,D){completeMenu(C);if(!D){D="currentControl";}var P=getObj(C);var L=P.getElementsByTagName("tbody")[0];var I=L.firstChild;var M=I.getAttribute("id");M=M.substr(0,M.length-1);var K=microstrategy.getViewerBone().widgets;var G=false;if(K){if(L.hasChildNodes()){for(var F=L.childNodes.length-1;F>=0;F--){if(J||L.childNodes[F].getAttribute("dyn_menu")){L.removeChild(L.childNodes[F]);}}}G=!J&&L.hasChildNodes();var E=false;for(var F=0;F<K.length;F++){var O=K[F];if(!Q||Q==O.scope){var B=I.getAttribute("id");var H=I.cloneNode(true);H.setAttribute("id",M+F);H.setAttribute("dyn_menu",true);H.className="ctrl"+O.tbClass;if(!E&&G){H.setAttribute("AS",1);E=true;}var N=microstrategy.SUBOBJTYPE_DOC_WIDGET+"|"+O.fqcn+";"+O.rslPath+";"+O.title+";"+O.previewImage+";"+O.isApp+";"+O.scope+";"+O.defaultDHTMLStyle;var A="microstrategy.bone('rwb_viewer').commands.exec('"+D+"', '"+N+"');";if(D=="currentControl"){A+="microstrategy.eventManager.notifyOrphanBones('requestCurrentControlChange', '"+N+"');";}H.setAttribute("JS",A);H.childNodes[2].innerHTML=O.title;L.appendChild(H);}}completeMenu(C);}}function addOndemandSubMenuItems(G,C,E,H){if(G){var B=mstr.$obj(G);if(!B){return ;}var A=mstr.$obj(E);if(C){B.setCurrentDynamicMenuKey(C);}var D="";if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){D="Report";}else{var F=microstrategy.findBone(microstrategy.activeCXMenu);D=F.objId;}B.setGridKey(D);A.setMenuLevel(H);A.setModel(B);B.execPopulate();}}function addDynamicMenus(E,D,B){setOndemandMenuItems(D);var C=buildContextMenuRows(B,E,null,null,true,null);var A=getMenuDiv(aMenuItemsName+E);if(C==""){if(A.childNodes[0].rows&&A.childNodes[0].rows.length==0){hideContextSubMenus(E-1);}}else{addToExistingDivTable(A,C);mstrMenuObj.adjustMenuPositionForClient(parseInt(A.style.left,10),parseInt(A.style.top,10),A);}}function addToExistingDivTable(E,C){var B=document.createElement("div");B.innerHTML="<TABLE>"+C+"</TABLE>\n";var D=B.childNodes[0];var A=E.childNodes[0];if(A!=null&&(A.tBodies==null||A.tBodies.length==0)){A.appendChild(document.createElement("tbody"));}while(D.rows.length>0&&(A!=undefined)){A.tBodies[0].appendChild(D.rows[0]);}}function getNumTagsInDiv(C,B){var D=getObj(C);var A=D.getElementsByTagName(B);if(A!=null){return A.length;}else{return 0;}}function setOndemandMenuItems(A){aOndemandMenuItems=A;}function removeProcessingMenuItem(D){var A=getMenuDiv(aMenuItemsName+D);var C=A.getElementsByTagName("tr");if(C!=null){var B=0;while(B<C.length){if(C[B]!=null&&"processing"==C[B].getAttribute("id")){C[B].parentNode.removeChild(C[B]);}B++;}}}function addProcessingMenuItem(E){var B=microstrategy.descriptors.getDescriptor("2901");var C="";var D="menu-item";C+='<TR ID="processing" name="processing" HEIGHT="18" AC="true" ';C+='onMouseOver="clearTimeout(oSubCTimer); menuOn(this);';C+=" hideContextSubMenus("+E+");";C+='" onMouseOut="menuOff(this);" ';if(bIsW3C){C+='STYLE="cursor: pointer;"';}else{C+='STYLE="cursor: hand;"';}C+=">\n";C+='<TD WIDTH="12" ALIGN="MIDDLE" CLASS="mstrContextMenuLeft">';C+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'treeLoading.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';C+="</TD>";C+='<TD WIDTH="1"><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"></TD>';C+='<TD ALIGN="LEFT" NOWRAP="1" ';C+=" class="+D+" ";C+=">"+B+"&nbsp;&nbsp;<BR/></TD>";C+='<TD WIDTH="12" ALIGN="RIGHT" NOWRAP="1" ';C+=">";C+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" ALT="0" BORDER="0" />';C+="</TD>";C+="</TR>";var A=getMenuDiv(aMenuItemsName+E);addToExistingDivTable(A,C);}mstrPageByMapperImplScript=true;mstrPageByMapperImpl.prototype=new Object();mstrPageByMapperImpl.prototype.getAreas=function(G,V,H){try{var F=new Object();var I=0;var P=H.height;var L=0,K=0,M=0,B=0;var T;var R=G.units;if(R&&R.length>0){P=getObjHeight(R[0]);var D=R.length;var O=H.left;var J=H.top;var C=getObjHeight(R[0]);K=M=getObjSumTop(R[0])-J-1;if(Math.floor(P/C)>1){B=getObjSumTop(R[0])+C-J+1;P=C+3;}else{B=M+P;}var N=getObjSumLeft(R[0])-O;var A=getObjWidth(R[0]);var U=N+(A/2);F[I++]=this.buildArea(R[0].getAttribute("id"),L,K,L+U,B,N,M,P);L=U;for(var S=1;S<D;S++){U=getObjSumLeft(R[S])-O;L++;if(U<L){F[I++]=this.buildArea(R[S].getAttribute("id"),L,K,H.width,B,(getObjSumLeft(R[S-1])-O+getObjWidth(R[S-1])+3),M,P);K=B+1;if(H.height-getObjSumTop(R[S])+J<2*C){B=H.height-1;}else{B=getObjSumTop(R[S])+C-J+1;}M=getObjSumTop(R[S])-J-1;T=(getObjWidth(R[S])/2);F[I++]=this.buildArea(R[S].getAttribute("id"),0,K,T,B,1,M,P);L=T;}else{T=U+(getObjWidth(R[S])/2);F[I++]=this.buildArea(R[S].getAttribute("id"),L,K,T,B,U-2,M,P);L=T;}}var Q=(D==1)?N+A:getObjSumLeft(R[R.length-1])-O+getObjWidth(R[R.length-1]);F[I++]=this.buildArea(G.id,L+1,K,H.width,B,Q+3,M,P);}else{F[I++]=this.buildArea(G.id,L,K,H.width,P,L,K,P);}F.length=I;return F;}catch(E){microstrategy.errors.log(E);return null;}};mstrPageByMapperImpl.prototype.buildArea=function(B,H,E,A,F,C,J,I){try{var G=new mstrAreaObjectImpl();G.coords=H+","+E+","+A+","+F;G.pointsTo=B;G.onmouseovercoords=C+","+J+","+I+","+microstrategy.DND_HILITE_WIDTH;return G;}catch(D){microstrategy.errors.log(D);return null;}};function mstrPageByMapperImpl(){return this;}GradientUtilScript=true;var gradientUtil=new function(){};gradientUtil.prototype=new Object();gradientUtil.PIXEL_WIDTH=2;gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL=1;gradientUtil.GRADIENTSHADING_STYLE_VERTICAL=2;gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP=3;gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN=4;gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER=5;gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER=6;gradientUtil.GRADIENTSHADING_STYLE_CUSTOM=7;gradientUtil.GRADIENT_START_COLOR_INDEX=0;gradientUtil.GRADIENT_END_COLOR_INDEX=1;gradientUtil.GRADIENT_TRANSITION_TYPE_INDEX=2;gradientUtil.GRADIENT_ANGLE_INDEX=3;gradientUtil.GRADIENT_XOFFSET_INDEX=4;gradientUtil.GRADIENT_YOFFSET_INDEX=5;gradientUtil.GRADIENT_POSTFIX="_gradient";gradientUtil.getXCoordinate=function(C,A){try{return parseInt(C%(A/this.PIXEL_WIDTH));}catch(B){microstrategy.errors.log(B);return false;}};gradientUtil.getYCoordinate=function(C,A){try{return parseInt(C/(A/this.PIXEL_WIDTH));}catch(B){microstrategy.errors.log(B);return false;}};gradientUtil.getColorPercent=function(E,G,A,C,B){try{switch(parseInt(B)){case gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:if(A==1){return E*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return 1-E*gradientUtil.PIXEL_WIDTH/C;}else{if(A==3){return 1-(((-2)*Math.abs(E-(C/gradientUtil.PIXEL_WIDTH)/2))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_VERTICAL:if(A==1){return G*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return 1-G*gradientUtil.PIXEL_WIDTH/C;}else{if(A==3){return 1-(((-2)*Math.abs(G-(C/gradientUtil.PIXEL_WIDTH)/2))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP:if(A==1){return((E+G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==2){return 1-((E+G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==3){return 1-(((-1)*Math.abs((E+G)-(C/gradientUtil.PIXEL_WIDTH)))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN:if(A==1){return 1-((E+(C/gradientUtil.PIXEL_WIDTH)-G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==2){return((E+(C/gradientUtil.PIXEL_WIDTH)-G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==3){return 1-(((-1)*Math.abs((E+(C/gradientUtil.PIXEL_WIDTH)-G)-(C/gradientUtil.PIXEL_WIDTH)))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER:if(A==1){return Math.max(E,G)*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return Math.max((C/gradientUtil.PIXEL_WIDTH)-E,G)*gradientUtil.PIXEL_WIDTH/C;}else{if(A==3){return 1-Math.min(E,G)*gradientUtil.PIXEL_WIDTH/C;}else{if(A==4){return 1-Math.min((C/gradientUtil.PIXEL_WIDTH)-E,G)*gradientUtil.PIXEL_WIDTH/C;}}}}break;case gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER:var F=2*gradientUtil.PIXEL_WIDTH;if(A==1){return 1-(2*Math.min(Math.min((C/gradientUtil.PIXEL_WIDTH)-E,E),Math.min((C/gradientUtil.PIXEL_WIDTH)-G,G)))*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return((Math.abs(E-(C/F))/(C/F))+(Math.abs(G-(C/F))/(C/F)))/2;}else{if(A==3){return Math.sqrt((Math.pow(Math.abs(E-(C/F)),2)+Math.pow(Math.abs(G-(C/F)),2))/Math.pow((C/F),2));}}}break;}}catch(D){microstrategy.errors.log(D);}};gradientUtil.getRGBColor=function(B){try{if(B.indexOf("#")>=0){B=B.substring(B.indexOf("#")+1);}var C=new Array();if(B.length==6){var F=parseInt(B.substring(0,2),16);var E=parseInt(B.substring(2,4),16);var A=parseInt(B.substring(4,6),16);C.push(F);C.push(E);C.push(A);return C;}else{return[0,0,0];}}catch(D){microstrategy.errors.log(D);return false;}};gradientUtil.createIntervalColors=function(C,B,A,D){try{var E=new Array();var G=(A-D)/2;E[0]=gradientUtil.createIntervalColor(C,B,(A-G)/A);E[1]=gradientUtil.createIntervalColor(C,B,G/A);return E;}catch(F){microstrategy.errors.log(F);return false;}};gradientUtil.createIntervalColor=function(B,A,D){try{var C=gradientUtil.setColorHue(gradientUtil.longHexToDec(B),D,gradientUtil.longHexToDec(A));return mstr.utils.Color.rgb2hex(C[0],C[1],C[2]);}catch(E){microstrategy.errors.log(E);return false;}};gradientUtil.setColorHue=function(E,D,F){try{var A=new Array();for(var B=0;B<E.length;B++){A[B]=Math.round(E[B]*D)+Math.round(F[B]*(1-D));A[B]=A[B]>255?255:A[B];}return A;}catch(C){microstrategy.errors.log(C);return false;}};gradientUtil.longHexToDec=function(A){try{return new Array(gradientUtil.toDec(A.substring(0,2)),gradientUtil.toDec(A.substring(2,4)),gradientUtil.toDec(A.substring(4,6)));}catch(B){microstrategy.errors.log(B);return false;}};gradientUtil.toDec=function(B){try{return parseInt(B,16);}catch(A){microstrategy.errors.log(A);return false;}};gradientUtil.applyGradientSettings=function(C,A,B){gradientUtil.applyGradient(C,A[gradientUtil.GRADIENT_START_COLOR_INDEX],A[gradientUtil.GRADIENT_END_COLOR_INDEX],A[gradientUtil.GRADIENT_ANGLE_INDEX],A[gradientUtil.GRADIENT_XOFFSET_INDEX],A[gradientUtil.GRADIENT_YOFFSET_INDEX],microstrategy.styleObj);};gradientUtil.applyGradient=function(E,H,C,I,F,B,A){try{var G=(I==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;if((G==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL&&F!=100)||(G==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL&&B!=100)){gradientUtil.createGradient(E,H,C,G,A,true);}else{gradientUtil.createGradient(E,C,H,G,A,false);}}catch(D){microstrategy.errors.log(D);return false;}};gradientUtil.createGradient=function(H,K,E,J,A,M){try{var C=(J==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL)?1:0;if(bIsDXIE){var B=false;var D=H.style.filter;if((D==null||D.length==0)&&A){D=A.getFilter(H);if(D&&D.length>0){B=true;}}var I=null;if(D!=null&&D.length>0){I=H.filters["DXImageTransform.Microsoft.Gradient"];}if((getObjInnerHeight(H)<2&&J==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL)||(getObjInnerWidth(H)<2&&J==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL)){if(I){I.enabled=false;}H.style.backgroundColor="#"+K;return ;}if(I!=null){I.gradientType=C;I.startColorStr="#FF"+K;I.endColorStr="#FF"+E;I.enabled=true;}else{if(!B){H.style.filter+="progid:DXImageTransform.Microsoft.Gradient(GradientType="+C+", StartColorStr='#"+K+"', EndColorStr='#"+E+"') ";}else{A.objSheet.styleRules[A.getId(H)].style.filter+="progid:DXImageTransform.Microsoft.Gradient(GradientType="+C+", StartColorStr='#"+K+"', EndColorStr='#"+E+"') ";}}H.style.backgroundColor="transparent";}else{H.style.backgroundColor="#"+((M==true)?K:E);var L="#"+K,G="#"+E;if(mstr.utils.ISFF){H.style.background="-moz-linear-gradient("+((C===0)?"top":"left")+","+L+","+G+")";}else{if(mstr.utils.ISWK){H.style.background="-webkit-gradient(linear,"+((C===0)?"left top, left bottom":"left top, right top")+",from("+L+"),to("+G+"))";}else{if(mstr.utils.ISIE10||mstr.utils.ISW3CIE){H.style.background="linear-gradient("+((C===0)?"to bottom":"to right")+","+L+","+G+")";}}}}}catch(F){microstrategy.errors.log(F);return false;}};microstrategy.FEATURE_CHECK_SHOW_SUBTOTALS="check-show-subtotals";microstrategy.FEATURE_CHECK_MERGE_COL_HEADER="check-merge-col-header";microstrategy.FEATURE_CHECK_MERGE_ROW_HEADER="check-merge-row-header";microstrategy.FEATURE_CHECK_OUTLINE_MODE="check-outline-mode";microstrategy.FEATURE_WEB_REMOVE_FROM_GRID="web-remove-from-grid";microstrategy.FEATURE_INSERT_NEW_METRIC="insert-new-metric";microstrategy.FEATURE_INSERT_TRANSFORMATION_METRICS="insert-transformation-metrics";microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS="modify-grid-level-in-documents";microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE="documents-design-mode";microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY="set-attributeform-display";microstrategy.FEATURE_RW_INTERACTIVE_VIEW_MODE_EPLUS="rw-interactive-view-mode-eplus";microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS="rw-editable-view-mode-eplus";microstrategy.FEATURE_DATASET_OBJECTS_LIST="dataset-objects-list";microstrategy.FEATURE_WEB_PIVOT="web-pivot";microstrategy.FEATURE_CHECK_SHOW_PIVOT_BUTTONS="check-show-pivot-buttons";microstrategy.FEATURE_CHECK_SHOW_SORT_BUTTONS="check-show-sort-buttons";microstrategy.FEATURE_USE_OFFICE="useOffice";microstrategy.FEATURE_MODIFY_REPORT_LIST="modify-report-list";microstrategy.FEATURE_REPORT_FROM_REPORT="web-remove-from-report";microstrategy.FEATURE_USE_REPORT_OBJECT_WINDOW="report-objects-window";microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE="embedded-template-node";microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE="rw-editable-view-mode";microstrategy.FEATURE_ENABLE_REEXECUTE="enable-reexecute";microstrategy.FEATURE_CHECK_SHOW_BANDING="check-show-banding";microstrategy.FEATURE_ENABLE_SCHEDULING="enable-scheduling";microstrategy.FEATURE_IS_NON_VIEWABLE_REPORT="is-non-viewable-report";microstrategy.FEATURE_REPORT_FILTER="report-filter";microstrategy.FEATURE_CREATE_HTML_CONTAINER="create-html-container";microstrategy.FEATURE_CHECK_SHOW_GRAPH_ZONES="check-show-graph-zones";microstrategy.FEATURE_INSERT_INTO_PANEL="insert-into-panel";microstrategy.FEATURE_CHECK_DESIGN_MODE="check-design-mode";microstrategy.FEATURE_ENABLE_SHOW_SUBTOTALS="enable-show-subtotals";microstrategy.FEATURE_IS_VIEW_REPORT="is-view-report";microstrategy.FEATURE_CHECK_LOCK_COLUMN_HEADERS="check-lock-column-headers";microstrategy.FEATURE_CHECK_LOCK_ROW_HEADERS="check-lock-row-headers";microstrategy.FEATURE_CONFIGURE_TRANSACTIONS="configure-transactions";microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES="ask-before-save-changes";microstrategy.FEATURE_FORCE_SAVE_AS="force-save-as";microstrategy.FEATURE_REPORT_TEMPLATE_SEARCH="report-template-search";microstrategy.FEATURE_SINGLE_SOURCE_GRID="single-source-grid";microstrategy.FEATURE_RW_LEVEL_MCE_JOIN="rw-MCE-join";microstrategy.FEATURE_PROJECT_LEVEL_MCE_JOIN="project-MCE-join";microstrategy.FEATURE_MANAGE_DATASETS="manage-datasets";var oldFormatDrillPathImportance=null;mstrDrillObj.prototype=new Object();function mstrDrillObj(A){}function optDrl(E,G,I){if(window.event){window.event.returnValue=false;}var D=window.localStorage,F=(D.getItem("nlli"))||0,A=document.URL;if(history.pushState){history.pushState({target:A,href:A,index:++F},A,A);D.setItem("nlli",F);}var B=microstrategy.findBone(G);var C=microstrategy.findParentWithTag(G,"td");var H=B.gridStructureInfo.getGridCellProps(C);return B.drill(H.getCellDrillKey(),E,H.getCellDrillElement(C),I);}function Drill(E,B,A,D){var C=microstrategy.findBone(D);return C.drill(E,B,A);}function rwDrl(E,B,A,F,D){var C=microstrategy.findBone(D);return C.drill(E,B,A,F);}function storeLocation(){var A=document.URL,C=A.split(/[?#]/)[0],B=parseInt((history.state&&history.state.index),10)||0;history.pushState({target:A,href:A,index:B},C,C);}function DCM(D,B,A){storeLocation();window.mstrSubmitLink=false;var C=microstrategy.getActiveCXBone();C.drill(D,B,A);}function rwDCM(C,A,D){var B=microstrategy.getActiveCXBone();B.drill(C,A,null,D);}function graphDCM(B,A){var C=microstrategy.getActiveCXBone();var D=microstrategy.findRegisteredChildBone(C.elem,"div","mstrReportGraphCMImpl");D.submitGraphDrill(B,A,null,false);}function rwGraphDCM(B,A,E){var C=microstrategy.getActiveCXBone();var D=microstrategy.findRegisteredChildBone(C.elem,"div","mstrReportGraphCMImpl");D.submitGraphDrill(B,A,E,false);}function moreOptions(D,B,A){var C=microstrategy.getActiveCXBone();C.showAdvDrillEditor(D,B,A);}function findTargetDrill(A,B){try{while(A){if(A.getAttribute&&A.getAttribute(B)){return A;}A=A.parentNode;}return null;}catch(C){return null;}}function openFormInNewWindow(B){var A=findTargetDrill(B,"method");if(A){if(A.iframe){A.iframe.value="false";}A.target="_blank";}return true;}mstrTemplateImpl.prototype={};mstrTemplateImpl.prototype.parentBone=null;mstrTemplateImpl.prototype.target=null;mstrTemplateImpl.prototype.gridInfo=null;mstrTemplateImpl.prototype.fp=null;mstrTemplateImpl.prototype.showAttForms=true;mstrTemplateImpl.prototype.onload=function(C,B,A){try{this.target=C;this.parentBone=B;this.showAttForms=this.parentBone.showAttForms;this.fp=A;this.gridInfo=this.parentBone.gridStructureInfo;return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrTemplateImpl.prototype.prepareColGroupAndHandles=function(){try{if(!this.parentBone.quickSearchEnabled||!mstrGridReport.isDesignMode()||!(this.parentBone.isGrid&&mstrGridReport.isReport())){return ;}var H=this.target;var D=H.getElementsByTagName("COLGROUP")[0];if(D){H.removeChild(D);}D=document.createElement("colgroup");var F=H.getElementsByTagName("TBODY")[0];var G=F.rows[0].childNodes.length;for(var E=0;E<G;E++){var B=document.createElement("col");D.appendChild(B);}H.insertBefore(D,F);var A=H.parentNode;var I=microstrategy.findChildrenWithAtt(A,"div","sty","vline");for(var E in I){A.removeChild(I[E]);}this.parentBone.initColResize();}catch(C){microstrategy.errors.log(C);}};mstrTemplateImpl.buildEmptyTemplate=function(C,A){try{var D=document.createElement("table");D.setAttribute("width","100%");D.border=0;D.cellSpacing=0;D.cellPadding=0;D.className=C+"default";D.style.fontSize=(8*(microstrategy.ZOOM_FACTOR/100))+"pt";D.appendChild(document.createElement("tbody"));mstrTemplateImpl.buildEmptyTemplateRows(D,C,A);return D;}catch(B){microstrategy.errors.log(B);return null;}};mstrTemplateImpl.buildEmptyTemplateRows=function(F,D,A){try{var B=F.getElementsByTagName("TBODY")[0];mstrTemplateImpl.removeAllChildren(B);var E=B.insertRow(-1);mstrTemplateImpl.buildEmptyTemplateCell(E.insertCell(E.cells.length),null,D);mstrTemplateImpl.buildEmptyTemplateCell(E.insertCell(E.cells.length),microstrategy.GRIDCELL_AXIS_COLUMNS,D);E=B.insertRow(-1);mstrTemplateImpl.buildEmptyTemplateCell(E.insertCell(E.cells.length),microstrategy.GRIDCELL_AXIS_ROWS,D);if(A){E.appendChild(mstrTemplateImpl.buildEmptyCell(microstrategy.GRIDCELL_AXIS_METRICS,D));}else{mstrTemplateImpl.buildEmptyTemplateCell(E.insertCell(E.cells.length),microstrategy.GRIDCELL_AXIS_METRICS,D);}}catch(C){microstrategy.errors.log(C);}};mstrTemplateImpl.buildEmptyTemplateCell=function(D,A,C){try{switch(A){case null:D.className="r-rowTitle r-cell";D.innerHTML="&nbsp;";break;case microstrategy.GRIDCELL_AXIS_ROWS:D.className="r-rowHeader r-cell";D.appendChild(document.createTextNode(microstrategy.descriptors.getDescriptor("4500")));break;case microstrategy.GRIDCELL_AXIS_COLUMNS:D.className="r-colHeader r-cell";D.appendChild(document.createTextNode(microstrategy.descriptors.getDescriptor("4502")));break;case microstrategy.GRIDCELL_AXIS_METRICS:D.className="r-metricValue r-cell";D.appendChild(document.createTextNode(microstrategy.descriptors.getDescriptor("4501")));break;}D.appendChild(document.createElement("br"));if(A&&mstrGridReport.createQuickSearchPlaceHolder){D.appendChild(mstrGridReport.createQuickSearchPlaceHolder(A));}}catch(B){microstrategy.errors.log(B);}};mstrTemplateImpl.buildEmptyCell=function(A,C){try{var D=document.createElement("td");D.innerHTML="&nbsp;";D.appendChild(document.createElement("br"));D.className=(A==microstrategy.GRIDCELL_AXIS_ROWS)?C+"rowTitle":C+"metricValue";return D;}catch(B){microstrategy.errors.log(B);return false;}};mstrTemplateImpl.removeAllChildren=function(B){try{while(B.hasChildNodes()){B.removeChild(B.firstChild);}}catch(A){microstrategy.errors.log(A);}};mstrTemplateImpl.prototype.buildPreviewCell=function(A,C,B){try{var E=A.cloneNode(true);E.className+=" "+C;E.innerHTML="&lt;"+B+"&gt;";return E;}catch(D){microstrategy.errors.log(D);}return A;};mstrTemplateImpl.prototype.buildEmptyRows=function(H,B,D){try{this.target.className=this.target.className.replace("metricsOnRows","");var A=this.target.getElementsByTagName("TBODY")[0];var F=A.insertRow(-1);var G,C;if(!H||H.length==0){mstrTemplateImpl.buildEmptyTemplateCell(F.insertCell(F.cells.length),microstrategy.GRIDCELL_AXIS_ROWS,this.parentBone.gridCellCssPrefix);}else{G=this.buildHeaderCell(microstrategy.GRIDCELL_AXIS_ROWS);for(C=0;C<H.length;C++){F.appendChild(this.buildPreviewCell(G,"r-cell-preview",H[C].getAttribute(microstrategy.HTMLATTR_DESCRIPTION)));}}if(B&&B.length>0){F.appendChild(this.buildHeaderCell(microstrategy.GRIDCELL_AXIS_ROWS));}if(!D||D.length==0){mstrTemplateImpl.buildEmptyTemplateCell(F.insertCell(F.cells.length),microstrategy.GRIDCELL_AXIS_METRICS,this.parentBone.gridCellCssPrefix);}else{if(this.gridInfo.metricsAxis==microstrategy.GRIDCELL_AXIS_COLUMNS){G=mstrTemplateImpl.buildEmptyCell(microstrategy.GRIDCELL_AXIS_METRICS,this.parentBone.gridCellCssPrefix);for(C=0;C<D.length;C++){F.appendChild(this.buildPreviewCell(G,"r-cell-preview",D[C].getAttribute(microstrategy.HTMLATTR_DESCRIPTION)));}}else{F.appendChild(this.buildPreviewCell(mstrTemplateImpl.buildEmptyCell(microstrategy.GRIDCELL_AXIS_METRICS,this.parentBone.gridCellCssPrefix),"r-cell-preview",D[0].getAttribute(microstrategy.HTMLATTR_DESCRIPTION)));}}}catch(E){microstrategy.errors.log(E);}};mstrTemplateImpl.prototype.buildMetricsRows=function(A,H){try{if(this.target.className.indexOf("metricsOnRows")==-1){this.target.className+=" metricsOnRows";}var G=this.target.getElementsByTagName("TBODY")[0];var B=this.buildHeaderCell(microstrategy.GRIDCELL_AXIS_ROWS);var E=this.gridInfo.rowAxis.unitLength(this.gridInfo.metricsDepth);var D;for(var F=0;F<H.length;F++){var I=G.insertRow(-1);for(D=1;D<E;D++){I.appendChild(this.buildPreviewCell(B,"r-cell-preview",A[D-1].getAttribute(microstrategy.HTMLATTR_DESCRIPTION)));}I.appendChild(H[F]);for(D=E;D<A.length;D++){I.appendChild(this.buildPreviewCell(B,"r-cell-preview",A[D].getAttribute(microstrategy.HTMLATTR_DESCRIPTION)));}if(this.gridInfo.colAxis.size()>0){I.appendChild(B.cloneNode(true));}I.appendChild(this.buildPreviewCell(mstrTemplateImpl.buildEmptyCell(microstrategy.GRIDCELL_AXIS_METRICS,this.parentBone.gridCellCssPrefix)," ",H[F].getAttribute(microstrategy.HTMLATTR_DESCRIPTION)));}}catch(C){microstrategy.errors.log(C);}};mstrTemplateImpl.prototype.buildHeaderCell=function(A){try{var D=document.createElement("td");D.innerHTML="&nbsp;";D.appendChild(document.createElement("br"));var C=this.parentBone.gridCellCssPrefix;D.className=(A==microstrategy.GRIDCELL_AXIS_ROWS)?C+"rowHeader":C+"colHeader";return D;}catch(B){microstrategy.errors.log(B);return false;}};mstrTemplateImpl.prototype.buildTitleCell=function(A){try{var G=document.createElement("td");G.setAttribute(microstrategy.HTMLATTR_TARGET,"TRUE",0);G.setAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH.toUpperCase(),A.depth,0);G.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,A.subtype,0);if(A.isLocked){G.setAttribute(microstrategy.HTMLATTR_IS_LOCKED,microstrategy.TRUE);}if(A.dssId!=null&&A.dssId.length>0){G.setAttribute(microstrategy.HTMLATTR_DSS_ID,A.dssId,0);G.setAttribute(microstrategy.HTMLATTR_DSS_TYPE,A.dssType,0);if(A.dssSubtype){G.setAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE,A.dssSubtype,0);}}else{if(A.alias){G.setAttribute("mh","TRUE",0);}}var B=A.alias;var F=this.parentBone.gridCellCssPrefix;if(A.subtype==microstrategy.SUBOBJTYPE_METRIC){var C=this.gridInfo.metricsAxis;G.setAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS,C,0);if(C==microstrategy.GRIDCELL_AXIS_ROWS){G.setAttribute(microstrategy.HTMLATTR_ORIENTATION,microstrategy.GRIDCELL_ORIENTATION_HORIZONTAL,0);G.className=F+"rowHeader";}else{G.setAttribute(microstrategy.HTMLATTR_ORIENTATION,microstrategy.GRIDCELL_ORIENTATION_VERTICAL,0);G.className=F+"colHeader";}}else{G.setAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS,A.axis,0);G.setAttribute(microstrategy.HTMLATTR_FORM_ID,A.attFormId,0);G.setAttribute(microstrategy.HTMLATTR_FORM_NAME,A.attFormName,0);if(A.attFormList!=null){G.setAttribute(microstrategy.HTMLATTR_FORM_LIST,A.attFormList.toString(),0);}G.setAttribute(microstrategy.HTMLATTR_FORM_POS,A.subDepth,0);if(A.subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM){G.setAttribute(microstrategy.HTMLATTR_DSS_ID,A.parentDssId,0);B=A.parentAlias+" "+A.alias;}if(A.axis==microstrategy.GRIDCELL_AXIS_ROWS){G.setAttribute(microstrategy.HTMLATTR_GRIDROW_MAX_DEPTH,(this.gridInfo.colAxis.size()>0)?this.gridInfo.colAxis.size():1,0);G.setAttribute(microstrategy.HTMLATTR_ORIENTATION,microstrategy.GRIDCELL_ORIENTATION_VERTICAL,0);G.className=F+"rowTitle";}else{G.setAttribute(microstrategy.HTMLATTR_GRIDROW_MAX_DEPTH,this.gridInfo.rowAxis.size()+1,0);G.setAttribute(microstrategy.HTMLATTR_ORIENTATION,microstrategy.GRIDCELL_ORIENTATION_HORIZONTAL,0);G.className=F+"colTitle";}}if(B!=null&&B.length>0){if(this.fp.isDragAndDropEnabled||this.parentBone.showGraphDropZones){G.setAttribute("dg","TRUE",0);G.style.cursor=(bIsIE4)?"hand":"pointer";}var E=B;if(this.fp.showDescriptionAsTooltip!=microstrategy.FALSE&&A.description.length>0){E+="; "+A.description;}else{if((this.fp.isDragAndDropEnabled||this.parentBone.showGraphDropZones)&&!this.parentBone.commands.queryEnabled("isLinkedGrid")){E+="; "+microstrategy.descriptors.getDescriptor("2146");}if(this.fp.isContextMenuEnabled&&!this.parentBone.commands.queryEnabled("isLinkedGrid")){E+="; "+microstrategy.descriptors.getDescriptor("2142");}}G.setAttribute("title",E,0);G.setAttribute(microstrategy.HTMLATTR_DESCRIPTION,B,0);G.setAttribute(microstrategy.HTMLATTR_DSS_DESCRIPTION,A.description,0);G.appendChild(document.createTextNode(B));}G.appendChild(document.createElement("br"));A.src=G;return G;}catch(D){microstrategy.errors.log(D);return false;}};mstrTemplateImpl.prototype.buildTitleCellCollection=function(F){try{var B=null;var A=F.size();if(A>0){B=[];for(var D=0;D<A;D++){var E=F.units[D];if(this.showAttForms&&E.attForms!=null&&E.attForms.size()>1){for(var C=0;C<E.attForms.size();C++){B.push(this.buildTitleCell(E.attForms.units[C]));}E.src=E.attForms.units[0].src;}else{B.push(this.buildTitleCell(E));if(E.hasAttForms()){E.attForms.units[0].src=E.src;}}}if(F.axisType!=microstrategy.GRIDCELL_AXIS_METRICS||this.gridInfo.metricsAxis!=microstrategy.GRIDCELL_AXIS_ROWS){B=this.buildAxisPivotButtons(B);}B=this.buildAxisContextMenus(B);}return B;}catch(G){microstrategy.errors.log(G);return false;}};mstrTemplateImpl.prototype.buildAxisPivotButtons=function(C){try{if(this.fp.showPivot&&C.length>0&&!this.parentBone.commands.queryEnabled("isLinkedGrid")){var G=document.createElement("span");G.className="mstrIconPivot";G.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_BTN);var A=C.length;var E=(C[0].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_METRIC)?microstrategy.GRIDCELL_AXIS_METRICS:parseInt(C[0].getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS));var B=C[0].getAttribute(microstrategy.HTMLATTR_ORIENTATION);for(var D=0;D<A;D++){if(B==microstrategy.GRIDCELL_ORIENTATION_VERTICAL){if(D>0){C[D].appendChild(this.addPivotImage(G,microstrategy.FOLDER_IMAGES+this.fp.imgShiftLeft,microstrategy.descriptors.getDescriptor("142"),"l"));}if(D<A-1){C[D].appendChild(this.addPivotImage(G,microstrategy.FOLDER_IMAGES+this.fp.imgShiftRight,microstrategy.descriptors.getDescriptor("143"),"r"));}if(E==microstrategy.GRIDCELL_AXIS_ROWS){C[D].appendChild(this.addPivotImage(G,microstrategy.FOLDER_IMAGES+this.fp.imgShiftRightUp,microstrategy.descriptors.getDescriptor("141"),"c"));}}else{if(E==microstrategy.GRIDCELL_AXIS_COLUMNS){C[D].appendChild(this.addPivotImage(G,microstrategy.FOLDER_IMAGES+this.fp.imgShiftLeftDown,microstrategy.descriptors.getDescriptor("137"),"c"));}if(D>0){C[D].appendChild(this.addPivotImage(G,microstrategy.FOLDER_IMAGES+this.fp.imgShiftUp,microstrategy.descriptors.getDescriptor("138"),"u"));}if(D<A-1){C[D].appendChild(this.addPivotImage(G,microstrategy.FOLDER_IMAGES+this.fp.imgShiftDown,microstrategy.descriptors.getDescriptor("139"),"d"));}}if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){if(C[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_METRIC){C[D].appendChild(this.addPivotImage(G,microstrategy.FOLDER_IMAGES+this.fp.imgToPageBy,microstrategy.descriptors.getDescriptor("140"),"p"));}}if(this.fp.showRemove){var H=this.parentBone.isFeatureAvailable(microstrategy.FEATURE_WEB_REMOVE_FROM_GRID)?"2214":"2216";C[D].appendChild(this.addPivotImage(G,microstrategy.FOLDER_IMAGES+this.fp.imgRemove,microstrategy.descriptors.getDescriptor(H),"x"));}}}return C;}catch(F){microstrategy.errors.log(F);return C;}};mstrTemplateImpl.prototype.addPivotImage=function(C,E,D,F){try{var A=C.cloneNode(false);A.setAttribute("title",D);A.setAttribute("id",F);A.className+=" "+F;return A;}catch(B){microstrategy.errors.log(B);return img;}};mstrTemplateImpl.prototype.buildShortcutContextMenus=function(M,G){try{var O=microstrategy.getContextMenuManager("vb_GM");var B=O.getMenu();var D=O.getMenu();var L=O.getMenu();var A=[microstrategy.DSSTYPE_FILTER];var C=microstrategy.descriptors.getDescriptor("3331").split("##");var P=O.getMenu();P.addItem(microstrategy.descriptors.getDescriptor("1885"),M+"('rm', '"+SORT_ASCENDING+",n');","");P.addItem(microstrategy.descriptors.getDescriptor("1886"),M+"('rm', '"+SORT_DESCENDING+",n');","");L.addItem(C[0]+microstrategy.descriptors.getDescriptor("2057"),P);if(this.gridInfo.hasNonMetricUnitsOnAxis(microstrategy.GRIDCELL_AXIS_ROWS)&&!this.gridInfo.unitTypeExistsOnAxis(microstrategy.GRIDCELL_AXIS_COLUMNS,A)&&!this.gridInfo.unitTypeExistsOnAxis(microstrategy.GRIDCELL_AXIS_PAGE_BY,A)){D.addItem(microstrategy.descriptors.getDescriptor("3326"),M+"('pttm', 'r');","");}if(this.gridInfo.hasNonMetricUnitsOnAxis(microstrategy.GRIDCELL_AXIS_COLUMNS)&&!this.gridInfo.unitTypeExistsOnAxis(microstrategy.GRIDCELL_AXIS_ROWS,A)&&!this.gridInfo.unitTypeExistsOnAxis(microstrategy.GRIDCELL_AXIS_PAGE_BY,A)){D.addItem(microstrategy.descriptors.getDescriptor("3327"),M+"('pttm', 'c');","");}if(this.gridInfo.hasNonMetricUnitsOnAxis(microstrategy.GRIDCELL_AXIS_PAGE_BY)&&!this.gridInfo.unitTypeExistsOnAxis(microstrategy.GRIDCELL_AXIS_PAGE_BY,A)){D.addItem(microstrategy.descriptors.getDescriptor("3328"),M+"('pttm', 'p');","");}D.addItem(microstrategy.descriptors.getDescriptor("3329"),M+"('pttm', 'g');","");var F=this.gridInfo.getAttributes();if(F!=null&&F.length>0){var K=O.getMenu();if(F!=null){for(var I=0;I<F.length;I++){K.addItem(F[I].alias,M+"('pttm', 'a,"+F[I].dssId+"');","");P=O.getMenu();P.addItem(microstrategy.descriptors.getDescriptor("1885"),M+"('rm', '"+SORT_ASCENDING+",a,"+F[I].dssId+"');","");P.addItem(microstrategy.descriptors.getDescriptor("1886"),M+"('rm', '"+SORT_DESCENDING+",a,"+F[I].dssId+"');","");L.addItem(C[0]+F[I].alias,P);}}D.addItem(microstrategy.descriptors.getDescriptor("3330"),K);}B.addItem(microstrategy.descriptors.getDescriptor("3323"),D);if(this.parentBone.isFeatureAvailable(microstrategy.FEATURE_INSERT_TRANSFORMATION_METRICS)&&microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){var N=O.getMenu();if(this.parentBone.transformationRoles!=null){for(var H in this.parentBone.transformationRoles){var J=O.getMenu();J.addItem(microstrategy.descriptors.getDescriptor("2120"),M+"('tm', '"+H+",1');","");J.addItem(microstrategy.descriptors.getDescriptor("2132"),M+"('tm', '"+H+",2');","");J.addItem(microstrategy.descriptors.getDescriptor("3325"),M+"('tm', '"+H+",3');","");N.addItem(this.parentBone.transformationRoles[H],J);}}B.addItem(microstrategy.descriptors.getDescriptor("3324"),N);}B.addItem(microstrategy.descriptors.getDescriptor("2789"),L);if(this.parentBone.isFeatureAvailable(microstrategy.FEATURE_INSERT_NEW_METRIC)){B.addSeparator();B.addItem(microstrategy.descriptors.getDescriptor("1895"),"microstrategy.bone('rwb_viewer').commands.exec('edtDMetric');","microstrategy.bone('rwb_viewer').commands.queryEnabled('edtDMetric');","microstrategy.EXECUTION_SCOPE == microstrategy.RWD_EXECUTION");}G.addItem(microstrategy.descriptors.getDescriptor("3322"),B);}catch(E){microstrategy.errors.log(E);}};mstrTemplateImpl.prototype.buildAxisContextMenus=function(E){try{if(this.fp.isContextMenuEnabled&&E.length>0&&!this.parentBone.commands.queryEnabled("isLinkedGrid")){var A=E.length;var C=(E[0].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_METRIC)?microstrategy.GRIDCELL_AXIS_METRICS:parseInt(E[0].getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS));var D=E[0].getAttribute(microstrategy.HTMLATTR_ORIENTATION);var L=microstrategy.getContextMenuManager("vb_GM");var O="var bone = microstrategy.findBone(microstrategy.activeCXMenu); bone.processContextMenus";for(var S=0;S<E.length;S++){var T=L.getMenu();if(this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ENABLE_SORT)&&E[S].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_CONSOLIDATION&&E[S].getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE)!=microstrategy.DSSTYPE_CUSTOM_GROUP){var G=(C==microstrategy.GRIDCELL_AXIS_ROWS)?microstrategy.GRIDCELL_AXIS_ROWS:microstrategy.GRIDCELL_AXIS_COLUMNS;if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){T.addItem(microstrategy.descriptors.getDescriptor("3200"),"var bone = microstrategy.findBone(microstrategy.activeCXMenu); bone.commands.exec('sort', "+G+");");}else{T.addItem(microstrategy.descriptors.getDescriptor("3200"),"microstrategy.bone('rwb_viewer').commands.exec('edtSortGrid',"+G+");");}T.addSeparator();}if(C==microstrategy.GRIDCELL_AXIS_METRICS&&this.parentBone.isFeatureAvailable(microstrategy.FEATURE_INSERT_NEW_METRIC)){this.buildShortcutContextMenus(O,T);}if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION&&C!=microstrategy.GRIDCELL_AXIS_METRICS){var I=O+"('tuce');";var Q=O+"('cgs');";T.addItem(microstrategy.descriptors.getDescriptor("6152"),I,"","microstrategy.bone('rwb_viewer').commands.queryState('hasNoTargets') && !microstrategy.bone('rwb_viewer').autoWire");T.addItem(microstrategy.descriptors.getDescriptor("7483"),Q,"","microstrategy.bone('rwb_viewer').commands.queryState('hasNoTargets') && microstrategy.bone('rwb_viewer').autoWire");T.addItem(microstrategy.descriptors.getDescriptor("4964"),I,"","!microstrategy.bone('rwb_viewer').commands.queryState('hasNoTargets')");T.addItem(microstrategy.descriptors.getDescriptor("6151"),"microstrategy.bone('rwb_viewer').commands.exec('removeTargets')","","!microstrategy.bone('rwb_viewer').commands.queryState('hasNoTargets')");T.addItem(microstrategy.descriptors.getDescriptor("4724"),O+"('sct');");T.addItem(microstrategy.descriptors.getDescriptor("4725"),O+"('csc');");}if(this.fp.showPivotRMC){var B=L.getMenu();if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION&&C!=microstrategy.GRIDCELL_AXIS_METRICS){B.addItem(microstrategy.descriptors.getDescriptor("1892"),O+"('p');");}if(D==microstrategy.GRIDCELL_ORIENTATION_VERTICAL){if(C==microstrategy.GRIDCELL_AXIS_ROWS){B.addItem(microstrategy.descriptors.getDescriptor("3048"),O+"('c');");B.addSeparator();}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION&&(S>0||S<A-1)){B.addSeparator();}}if(S>0){B.addItem(microstrategy.descriptors.getDescriptor("3049"),O+"('l');");}if(S<A-1){B.addItem(microstrategy.descriptors.getDescriptor("3050"),O+"('r');");}}else{if(C==microstrategy.GRIDCELL_AXIS_COLUMNS){B.addItem(microstrategy.descriptors.getDescriptor("3051"),O+"('c');");B.addSeparator();}else{if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION&&(S>0||S<A-1)){B.addSeparator();}}if(S>0){B.addItem(microstrategy.descriptors.getDescriptor("3052"),O+"('u');");}if(S<A-1){B.addItem(microstrategy.descriptors.getDescriptor("3053"),O+"('d');");}}if(B.length>0){T.addItem(microstrategy.descriptors.getDescriptor("3054"),B);}}this.buildRemoveContextMenus(T,"x");if(this.fp.showFormattingRMC){T.addItem(microstrategy.descriptors.getDescriptor("2215"),O+"('gridFormat');","microstrategy.bone('rwb_viewer').commands.queryEnabled('onegrid');");}if(this.parentBone.isFeatureAvailable(microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY)){var N=E[S].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(N==microstrategy.DSSTYPE_ATTRIBUTE||N==microstrategy.DSSTYPE_ATTRIBUTE_FORM){var R=L.getMenu();if(E[S].getAttribute(microstrategy.HTMLATTR_FORM_LIST)){var M=E[S].getAttribute(microstrategy.HTMLATTR_FORM_LIST).split(unescape(UNIT_SEPARATOR));var J=[];var H=[];var U=[];var P;for(P=0;P<M.length;P++){form=M[P].split(unescape(mstrUpdateManager.ITEM_SEPARATOR));switch(parseInt(form[microstrategy.FORM_LIST_STATUS])){case microstrategy.FORM_NOT_ON_WS:U.push(M[P]);break;case microstrategy.FORM_ON_VIEW:J.push(M[P]);break;case microstrategy.FORM_ON_WS:H.push(M[P]);break;}}for(P=0;(J!=null)&&(P<J.length);P++){form=J[P].split(unescape(mstrUpdateManager.ITEM_SEPARATOR));R.addItem(form[microstrategy.FORM_LIST_NAME],O+"('atfr', '"+form[microstrategy.FORM_LIST_ID]+"');","","",mstrContextMenuImpl.IMG_CHECK);}for(P=0;(H!=null)&&(P<H.length);P++){form=H[P].split(unescape(mstrUpdateManager.ITEM_SEPARATOR));R.addItem(form[microstrategy.FORM_LIST_NAME],O+"('atfa', '"+form[microstrategy.FORM_LIST_ID]+EXPRESSION_SEPARATOR+form[microstrategy.FORM_LIST_NAME]+"');");}if(microstrategy.EXECUTION_SCOPE!=microstrategy.RWD_EXECUTION){R.addSeparator();R.addItem(microstrategy.descriptors.getDescriptor("1005"),O+"('atfm');");}}if(R.length>0){T.addItem(microstrategy.descriptors.getDescriptor("2890"),R);}}}if(this.fp.showRenameRMC){C=E[S].getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS);var V=E[S].getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH);var K=this.gridInfo.getAttrFormPos(E[S]);if(microstrategy.subObjectType(E[S])==microstrategy.SUBOBJTYPE_METRIC){C=microstrategy.GRIDCELL_AXIS_METRICS;K=1;}T.addItem(microstrategy.descriptors.getDescriptor("2453"),O+"('rename', "+this.gridInfo.getUnitIndex(C,V,K)+");");}if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION&&E[S].getAttribute(microstrategy.HTMLATTR_DSS_ID)){T.addItem(microstrategy.descriptors.getDescriptor("5140"),"microstrategy.bone('rwb_viewer').commands.exec('WebHyperLinkEditor');");}T.registerTrigger(E[S]);}}return E;}catch(F){microstrategy.errors.log(F);return E;}};mstrTemplateImpl.prototype.buildRemoveContextMenus=function(C,A){try{var B="var bone = microstrategy.findBone(microstrategy.activeCXMenu); bone.processContextMenus";var E=false;if((this.fp.showRemoveRMC||this.parentBone.showGraphDropZones)&&(this.parentBone.isFeatureAvailable(microstrategy.FEATURE_WEB_REMOVE_FROM_GRID)||microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION)){C.addItem(microstrategy.descriptors.getDescriptor("2214"),B+"('"+A+"');","","",mstrContextMenuImpl.IMG_REMOVE);E=true;}if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION&&this.parentBone.isFeatureAvailable(microstrategy.FEATURE_MODIFY_REPORT_LIST)&&this.parentBone.isFeatureAvailable(microstrategy.FEATURE_REPORT_FROM_REPORT)&&(!E||this.fp.showExtraRemoveRMC||this.parentBone.showGraphDropZones)){C.addItem(microstrategy.descriptors.getDescriptor("2216"),B+"('"+A+"x');","","",mstrContextMenuImpl.IMG_REMOVE);}}catch(D){microstrategy.errors.log(D);}};mstrTemplateImpl.prototype.generateTemplate=function(){try{var F=this.target.getElementsByTagName("TBODY")[0];mstrTemplateImpl.removeAllChildren(F);if(this.gridInfo.isEmptyTemplate){mstrTemplateImpl.buildEmptyTemplateRows(this.target,this.parentBone.gridCellCssPrefix,this.gridInfo.hasMetrics);}else{var I=1;var K=colSpacer=null;var E,D,J;var H=this.gridInfo;if(H.rowAxis.size()==0||H.colAxis.headerSize()>1){K=mstrTemplateImpl.buildEmptyCell(microstrategy.GRIDCELL_AXIS_ROWS,this.parentBone.gridCellCssPrefix);K.colSpan=Math.max(H.rowAxis.headerSize(),1);}if(H.metricsAxis!=microstrategy.GRIDCELL_AXIS_COLUMNS||H.colAxis.headerSize()>1){colSpacer=this.buildHeaderCell(microstrategy.GRIDCELL_AXIS_COLUMNS);if(H.metricsAxis==microstrategy.GRIDCELL_AXIS_COLUMNS){I=H.metricAxis.headerSize();}}var L=this.buildTitleCellCollection(H.metricAxis);var A=this.buildTitleCellCollection(H.rowAxis);var B=this.buildTitleCellCollection(H.colAxis);var G=-1;if(H.metricsAxis==microstrategy.GRIDCELL_AXIS_COLUMNS){G=H.colAxis.unitLength(H.metricsDepth);}else{if(H.metricsAxis==microstrategy.GRIDCELL_AXIS_ROWS){G=H.rowAxis.unitLength(H.metricsDepth);}}if(B!=null){for(E=0;E<B.length-1;E++){J=F.insertRow(-1);if(K!=null){J.appendChild(K.cloneNode(true));}J.appendChild(B[E]);if(H.metricsAxis==microstrategy.GRIDCELL_AXIS_COLUMNS&&(G-1==E)){for(D=0;D<L.length;D++){J.appendChild(L[D]);}}else{if(colSpacer!=null){for(D=0;D<I;D++){J.appendChild(this.buildPreviewCell(colSpacer,"previewHeaderCell",B[E].getAttribute(microstrategy.HTMLATTR_DESCRIPTION)));}}}}}if(A!=null||B!=null){J=F.insertRow(-1);if(A==null){J.appendChild(K.cloneNode(true));}else{for(E=0;E<A.length;E++){J.appendChild(A[E]);}}if(B==null){mstrTemplateImpl.buildEmptyTemplateCell(J.insertCell(J.cells.length),microstrategy.GRIDCELL_AXIS_COLUMNS,this.parentBone.gridCellCssPrefix);}else{J.appendChild(B[B.length-1]);if(H.metricsAxis==microstrategy.GRIDCELL_AXIS_COLUMNS&&G==B.length){for(D=0;D<L.length;D++){J.appendChild(L[D]);}}else{if(colSpacer!=null){for(D=0;D<I;D++){J.appendChild(this.buildPreviewCell(colSpacer,"previewHeaderCell",B[B.length-1].getAttribute(microstrategy.HTMLATTR_DESCRIPTION)));}}}}}if(H.metricsAxis==microstrategy.GRIDCELL_AXIS_ROWS&&L!=null){this.buildMetricsRows(A,L);}else{this.buildEmptyRows(A,B,L);}}if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){this.renderPageBy();}}catch(C){microstrategy.errors.log(C);}};mstrTemplateImpl.prototype.adjustPageByMetrics=function(D){try{var C="";for(var B=0;B<this.gridInfo.metricAxis.size();B++){var A=this.gridInfo.metricAxis.units[B];C+=A.dssId+"|"+A.alias+ITEM_SEPARATOR;A.src=D;}if(C.length>0){D.setAttribute("mid",C.substr(0,C.length-1));}}catch(E){microstrategy.errors.log(E);}};mstrTemplateImpl.prototype.generatePageBySpan=function(E,G){try{var B=document.createElement("span");B.setAttribute("id","pbk"+G);if(this.fp.isDragAndDropEnabled||this.parentBone.showGraphDropZones){B.setAttribute("dg","TRUE");}B.setAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS,microstrategy.GRIDCELL_AXIS_PAGE_BY);if(E.hasAttForms()){B.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM);}else{B.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_ATTRIBUTE);}B.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_PAGE_BY_ELEM);B.setAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH,G);B.setAttribute(microstrategy.HTMLATTR_FORM_POS,"1");if(E.isMetricTemplateUnit){B.setAttribute("MH","TRUE");this.adjustPageByMetrics(B);}else{B.setAttribute(microstrategy.HTMLATTR_DSS_ID,E.dssId);B.setAttribute(microstrategy.HTMLATTR_DSS_TYPE,E.dssType);}if(E.attFormList.forms){var A,D,F=[];for(A=0;D=E.attFormList.forms[A];A++){F.push(D.join(unescape(mstrUpdateManager.ITEM_SEPARATOR)));}B.setAttribute(microstrategy.HTMLATTR_FORM_LIST,F.join(unescape(UNIT_SEPARATOR)));}B.setAttribute(microstrategy.HTMLATTR_DESCRIPTION,E.alias);B.className="pgby"+(mstrGridReport.isDesignMode()?"Design":"");B.onmouseover=new Function("this.className+=' pgbyHover';");B.onmouseout=new Function("this.className = this.className.replace(' pgbyHover','');");B.setAttribute("nowrap","1");B.appendChild(document.createTextNode(E.alias+" "));B.style.cursor=(bIsIE4)?"hand":"pointer";return B;}catch(C){microstrategy.errors.log(C);}return null;};mstrTemplateImpl.prototype.renderPageBy=function(){try{var B=this.gridInfo.pageAxis;var J=document.getElementById("pbb_PageByStyle");if(J!=null){var A=microstrategy.subObjectFind(J,"div",microstrategy.SUBOBJTYPE_BODY);mstrTemplateImpl.removeAllChildren(A);var I;var F=B.size();if(F>0){for(var E=0;E<F;E++){var H=B.units[E];var D=E+1;I=this.generatePageBySpan(H,D);H.src=I;if(H.attForms){H.attForms.setUnitSource(I);}A.appendChild(I);}this.buildPageByAxisPivotButtons();this.buildPageByAxisContextMenus();}else{I=document.createElement("span");var K=document.createTextNode(microstrategy.descriptors.getDescriptor("2020"));I.className="pgbyNone";I.appendChild(K);A.appendChild(I);}microstrategy.eventManager.notifyOrphanBones("onpagebychange");if(mstrGridReport.createQuickSearchPlaceHolder){A.appendChild(mstrGridReport.createQuickSearchPlaceHolder(microstrategy.GRIDCELL_AXIS_PAGE_BY));}var G=document.createElement("div");G.setAttribute("style","clear:both;height:0;line-height:0");A.appendChild(G);}}catch(C){microstrategy.errors.log(C);}};mstrTemplateImpl.prototype.buildPageByAxisPivotButtons=function(){try{var D=this.gridInfo.pageAxis;if((this.fp.showPivot||this.parentBone.showGraphDropZones)&&D.size()>0){var F=document.createElement("span");F.className="mstrIconPivot";var A=D.size();for(var B=0;B<A;B++){var C=D.units[B].src;if(B>0){C.appendChild(this.buildPageByPivotImage(F,"pivotLeft",microstrategy.descriptors.getDescriptor("142"),"move","l"));}if(B<A-1){C.appendChild(this.buildPageByPivotImage(F,"pivotRight",microstrategy.descriptors.getDescriptor("143"),"move","r"));}C.appendChild(this.buildPageByPivotImage(F,"pivotToRows",microstrategy.descriptors.getDescriptor("137"),"move","tr"));C.appendChild(this.buildPageByPivotImage(F,"pivotToCols",microstrategy.descriptors.getDescriptor("141"),"move","tc"));if(this.fp.showRemove||this.parentBone.showGraphDropZones){var G=this.parentBone.isFeatureAvailable(microstrategy.FEATURE_WEB_REMOVE_FROM_GRID)?"2214":"2216";C.appendChild(this.buildPageByPivotImage(F,"pivotRemove",microstrategy.descriptors.getDescriptor(G),"rmv","x"));}}}return D;}catch(E){microstrategy.errors.log(E);return D;}};mstrTemplateImpl.prototype.buildPageByPivotImage=function(E,B,G,A,F){try{var C=E.cloneNode(false);C.setAttribute("title",G);C.setAttribute("cmdid",A);C.setAttribute("cmdvl",F);C.className+=" "+B;return C;}catch(D){microstrategy.errors.log(D);return E;}};mstrTemplateImpl.prototype.buildPageByAxisContextMenus=function(){try{var E=this.gridInfo.pageAxis;if((this.fp.isContextMenuEnabled||this.parentBone.showGraphDropZones)&&E.size()>0){var A=E.size();if(microstrategy.getContextMenuManager!=undefined){var H=microstrategy.getContextMenuManager("vb_GM");var B="var bone = microstrategy.findBone(microstrategy.activeCXMenu); bone.processContextMenus";for(var D=0;D<A;D++){var C=H.getMenu();if(this.fp.showPivotRMC||this.parentBone.showGraphDropZones){var G=H.getMenu();G.addItem(microstrategy.descriptors.getDescriptor("3051"),B+"('move', 'tr');");G.addItem(microstrategy.descriptors.getDescriptor("3048"),B+"('move', 'tc');");G.addSeparator();if(D>0){G.addItem(microstrategy.descriptors.getDescriptor("3049"),B+"('move', 'l');");}if(D<A-1){G.addItem(microstrategy.descriptors.getDescriptor("3050"),B+"('move', 'r');");}if(G.length>0){C.addItem(microstrategy.descriptors.getDescriptor("3054"),G);}}this.buildRemoveContextMenus(C,"rmv");C.registerTrigger(E.units[D].src);}}}return E;}catch(F){microstrategy.errors.log(F);return E;}};mstrTemplateImpl.prototype.add=function(C,D,F,B){try{var A=this.gridInfo.buildGridUnitInfo(C,D,F,B);this.addFromObjInfo(A);return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrTemplateImpl.prototype.addFromObjInfo=function(A){try{this.gridInfo.add(A,true);this.generateTemplate();this.sendUpdate();return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrTemplateImpl.prototype.pivot=function(E,C,G,B){try{if(!E){this.gridInfo.pivotUnit(this.gridInfo.metricsAxis,this.gridInfo.metricsDepth,1,C,G,1);}else{var A=this.gridInfo.getGridUnitInfo(E);var F=this.gridInfo.buildGridUnitInfo(E,C,G,B);this.gridInfo.pivot(A,F);}this.generateTemplate();this.sendUpdate();return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrTemplateImpl.prototype.remove=function(A){try{this.gridInfo.remove(A);this.generateTemplate();this.sendUpdate();}catch(B){microstrategy.errors.log(B);}};mstrTemplateImpl.prototype.swapAxes=function(){try{this.gridInfo.swapAxes();this.generateTemplate();this.sendUpdate();}catch(A){microstrategy.errors.log(A);}};mstrTemplateImpl.prototype.sendUpdate=function(){try{this.parentBone.hasNoMetrics=!this.gridInfo.hasMetrics;if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION&&microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){var A=document.getElementById("btnApplyDesignChanges");if(A){A.disabled=(this.gridInfo.hasNoUnits);}A=document.getElementById("3013");if(A){A.disabled=(this.gridInfo.hasNoUnits);}}microstrategy.eventManager.notifyOrphanBones("onselectedgridstructurechange");}catch(B){microstrategy.errors.log(B);}};mstrTemplateImpl.prototype.undo=function(E){try{var J,C,G,B,A;var H=E.id;switch(H){case mstrUpdateManager.PIVOT_TEMPLATE_UNIT:J=this.gridInfo.findUnit(E.elem.dssId);if(J){C=parseInt(E.args[1]);G=parseInt(E.args[2]);this.pivot(J.src,C,G,1);}break;case mstrUpdateManager.PIVOT_TEMPLATE_METRIC:J=this.gridInfo.findUnit(E.elem.dssId);if(J){G=parseInt(E.args[1]);this.pivot(J.src,this.gridInfo.metricsAxis,G);}break;case mstrUpdateManager.ADD_TEMPLATE_UNIT:case mstrUpdateManager.ADD_TEMPLATE_METRIC:J=this.gridInfo.findUnit(E.elem.dssId);if(J){this.remove(J);}break;case mstrUpdateManager.ADD_FORM:C=parseInt(E.args[3]);G=parseInt(E.args[4]);B=parseInt(E.args[5]);J=this.gridInfo.findUnit(E.elem.parentDssId);if(E.cachedArray.pivot){if(J){A=J.attForms.findUnit(E.elem.dssId);if(A){this.pivot(A.src,C,G,B);}}}else{if(E.cachedArray.allForms){this.remove(J);}else{A=J.attForms.findUnit(E.elem.dssId);if(A){this.remove(A);}}}break;case mstrUpdateManager.REMOVE_TEMPLATE_UNIT:C=parseInt(E.args[1]);G=parseInt(E.args[2]);if(E.elem.isMetricTemplateUnit){var I=E.cachedArray.metrics;this.add(I[0].src,C,G,1);for(var F=1;F<I.length;F++){this.add(I[F].src,C,F+1,1);}}else{this.add(E.elem.src,C,G,1);}break;case mstrUpdateManager.REMOVE_TEMPLATE_METRIC:C=E.cachedArray.metricsAxis;G=(E.cachedArray.metricsDepth!=null)?E.cachedArray.metricsDepth:parseInt(E.args[1]);this.add(E.elem.src,E.cachedArray.metricsAxis,G,1);break;case mstrUpdateManager.REMOVE_FORM:if(E.elem.isVisible){this.add(E.elem.src,E.elem.axis,E.elem.depth,E.elem.subDepth);}else{this.addFromObjInfo(E.elem);}break;case mstrUpdateManager.SWAP_TEMPLATE_AXES:this.swapAxes();break;}microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",this.gridInfo);}catch(D){microstrategy.errors.log(D);}};mstrTemplateImpl.prototype.redo=function(D){try{var G=D.id;var C=this.gridInfo.findUnit(D.elem.dssId);switch(G){case mstrUpdateManager.PIVOT_TEMPLATE_UNIT:this.pivot(C.src,parseInt(D.args[3]),parseInt(D.args[4]),1);break;case mstrUpdateManager.PIVOT_TEMPLATE_METRIC:this.pivot(C.src,this.gridInfo.metricsAxis,parseInt(D.args[2]),1);break;case mstrUpdateManager.ADD_TEMPLATE_UNIT:this.add(D.elem.src,parseInt(D.args[1]),parseInt(D.args[2]),1);break;case mstrUpdateManager.ADD_TEMPLATE_METRIC:if(this.gridInfo.hasMetrics){this.add(D.elem,this.gridInfo.metricsAxis,parseInt(D.args[1]),1);}else{this.add(D.elem,parseInt(D.args[2]),parseInt(D.args[3]),1);}break;case mstrUpdateManager.ADD_FORM:var A=parseInt(D.args[3]);var F=parseInt(D.args[4]);var E=parseInt(D.args[5]);if(D.cachedArray.pivot){C=this.gridInfo.findUnit(D.elem.parentDssId);if(C){var H=C.attForms.findUnit(D.elem.dssId);if(H){this.pivot(H.src,A,F,E);}}}else{this.add(D.elem.src,A,F,E);}break;case mstrUpdateManager.REMOVE_TEMPLATE_UNIT:case mstrUpdateManager.REMOVE_TEMPLATE_METRIC:this.remove(C);break;case mstrUpdateManager.REMOVE_FORM:this.remove(D.elem);break;case mstrUpdateManager.SWAP_TEMPLATE_AXES:this.swapAxes();break;}microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",this.gridInfo);}catch(B){microstrategy.errors.log(B);}};function mstrTemplateImpl(){return this;}mstrGraphTemplateImpl.prototype=new mstrTemplateImpl();mstrGraphTemplateImpl.prototype.onload=function(C,B,A){try{mstrTemplateImpl.prototype.onload.call(this,C,B,A);this.showAttForms=false;return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrGraphTemplateImpl.prototype.generatePageBySpan=function(C,D){try{var A=mstrTemplateImpl.prototype.generatePageBySpan.call(this,C,D);if(A!=null&&this.parentBone.showGraphDropZones){A.setAttribute("dg","TRUE");}return A;}catch(B){microstrategy.errors.log(B);}return null;};mstrGraphTemplateImpl.prototype.adjustPageByMetrics=function(A){try{}catch(B){microstrategy.errors.log(B);}};mstrGraphTemplateImpl.prototype.generateTemplate=function(){try{var B=document.getElementById(this.parentBone.zonesTargetId+"_gdz1");var A=document.getElementById(this.parentBone.zonesTargetId+"_gdz2");if(this.parentBone.seriesLayout=="1"){this.renderAxisDropUnits(B,this.gridInfo.colAxis);this.renderAxisDropUnits(A,this.gridInfo.rowAxis);}else{this.renderAxisDropUnits(B,this.gridInfo.rowAxis);this.renderAxisDropUnits(A,this.gridInfo.colAxis);}var C=document.getElementById(this.parentBone.zonesTargetId+"_gdz3");if(this.gridInfo.metricsAxis==microstrategy.GRIDCELL_AXIS_PAGE_BY){mstrTemplateImpl.removeAllChildren(C);C.parentNode.style.display="none";}else{this.renderAxisDropUnits(C,this.gridInfo.metricAxis);C.parentNode.style.display="";}if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){this.renderPageBy();}}catch(D){microstrategy.errors.log(D);}};mstrGraphTemplateImpl.prototype.renderAxisDropUnits=function(A,D){try{mstrTemplateImpl.removeAllChildren(A);if(D.size()>0){for(var J=0;J<D.size();J++){var M=D.get(J);if(!M){continue;}if(M.isMetricTemplateUnit&&!this.parentBone.renderMetricsZone){M.src=null;M.isVisible=false;continue;}var N=document.createElement("span");N.appendChild(document.createTextNode(M.alias));if(M.isMetricTemplateUnit){N.setAttribute("mh","true");}else{N.setAttribute(microstrategy.HTMLATTR_DSS_ID,M.dssId);N.setAttribute(microstrategy.HTMLATTR_DSS_TYPE,M.dssType);}N.setAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH,(J+1));N.setAttribute(microstrategy.HTMLATTR_FORM_POS,"1");N.setAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS,D.axisType);N.setAttribute("id",this.parentBone.zonesTargetId+"_"+D.axisType+"_"+(J+1)+"_1");N.setAttribute("dg","1");if(D.axisType==microstrategy.GRIDCELL_AXIS_METRICS){N.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"MV");}else{N.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"ATT");}if(M.attFormList.forms){var G,B,I=[];for(G=0;B=M.attFormList.forms[G];G++){I.push(B.join(unescape(mstrUpdateManager.ITEM_SEPARATOR)));}N.setAttribute(microstrategy.HTMLATTR_FORM_LIST,I.join(unescape(UNIT_SEPARATOR)));}A.appendChild(N);if(mstr.utils.ISIE6||mstr.utils.ISIE7){var H=document.createElement("img");N.appendChild(H);N.removeChild(H);}M.src=N;if(microstrategy.getContextMenuManager!=undefined){var O=microstrategy.getContextMenuManager("vb_GM");var C="var bone = microstrategy.getActiveCXBone(); bone.processContextMenus('sct');";var L="var bone = microstrategy.getActiveCXBone(); bone.processContextMenus('tuce');";var K="var bone = microstrategy.getActiveCXBone(); bone.processContextMenus('cgs');";var F=O.getMenu();if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION&&D.axisType!=microstrategy.GRIDCELL_AXIS_METRICS){F.addItem(microstrategy.descriptors.getDescriptor("4724"),C);F.addItem(microstrategy.descriptors.getDescriptor("6152"),L,"","microstrategy.bone('rwb_viewer').commands.queryState('hasNoTargets') && !microstrategy.bone('rwb_viewer').autoWire");F.addItem(microstrategy.descriptors.getDescriptor("7483"),K,"","microstrategy.bone('rwb_viewer').commands.queryState('hasNoTargets') && microstrategy.bone('rwb_viewer').autoWire");F.addItem(microstrategy.descriptors.getDescriptor("4964"),L,"","!microstrategy.bone('rwb_viewer').commands.queryState('hasNoTargets')");F.addItem(microstrategy.descriptors.getDescriptor("6151"),"microstrategy.bone('rwb_viewer').commands.exec('removeTargets')","","!microstrategy.bone('rwb_viewer').commands.queryState('hasNoTargets')");}F.registerTrigger(N);}}}else{A.innerHTML="<br />&nbsp;<br />";}}catch(E){microstrategy.errors.log(E);}};function mstrGraphTemplateImpl(){this.inherits=mstrTemplateImpl;this.inherits();delete this.inherits;return this;}var mstrFormatObject={visibility:["FormattingAppearance","Visible",false,"101,102,105,106,107,52,53,4,8,111"],DisplayStyle:["FormattingAppearance","DisplayStyle",true,"106"],zoom:["RWDocumentProperties","ZoomFactor",false,"all"],borderBottomColor2:["FormattingBorder","Border3DBottomColor",false,"102,106,107,52,53,111,101,8,t,de"],GraphFormat:["FormattingPage","GraphFormat",true,"all"],FormattingNavigation:{Hyperlink:["link",true,"102,106","href"],OpenInNewWindow:["newWin",true,"102,106","nw"],IsHyperlink:["isLink",true,"102,106","isl"]},Autowire:["FormattingLayout","Autowire",true,"all"],textDecoration:["FormattingFont","Underline",false,"52,106,107,111,8,208,t,de,df"],SetBadgeToValueOnField:["FormattingTransactions","SetBadgeToValueOnField",true,"106"],MobileDataView:["Mobile","View",true,"all"],EnableHorizontalSwipeToChange:["FormattingView","EnableHorizontalSwipeToChange",true,"8"],topRightCornerRadius:["FormattingAppearance","TopRightCornerRadius",true,"101,8"],BlackAndWhite:["FormattingPage","BlackAndWhite",true,"all"],EmbedFonts:["FormattingPage","EmbedFonts",true,"all"],InitialSlidingInHeight:["FormattingView","InitialSlidingInHeight",true,"8"],AvailableViewModes:["FormattingPage","AvailableViewModes",true,"all"],FormattingPadding:{TopPadding:["paddingTop",false,"52,106,t,de"],LeftPadding:["paddingLeft",false,"52,106,t,de"],LineSpacing:["lineHeight",false,"106,t"],RightPadding:["paddingRight",false,"52,106,t,de"],BottomPadding:["paddingBottom",false,"52,106,t,de"]},PDFExportDocumentURL:["RWDocumentProperties","PDFExportDocumentURL",true,"all"],fontWeight:["FormattingFont","Bold",false,"52,106,107,111,8,t,de,df"],CalculateDocWidth:["RWDocumentProperties","CalculateDocWidth",true,"all"],titleBarDisplay:["FormattingView","TitleBarDisplay",true,"52,8"],LayoutWidth:["FormattingPage","Width",true,"all"],IPhoneVisualization:["Visualization","IPhoneVisualization",true,"52"],gridExportOverFlow:["FormattingCrosstab","ExportOverflowMode",true,"52"],SelectedVisualization:["Visualization","SelectedVisualization",true,"52"],gradientYOffset:["FormattingPatterns","GradientYOffset",true,"101,106,107,52,53,4,8,9,111,208"],TOCTitleFontItalic:["TableOfContents","TitleFontItalic",true,"all"],PaperType:["FormattingPage","PaperType",false,"all"],InfoWindowPosition:["FormattingView","InfoWindowPosition",true,"8"],SecondaryDataProviders:["FormattingWidget","SecondaryDataProviders",true,"52,111"],FilterDetailsFormat:["FilterDetailsFormatProperties","FilterDetailsFormat",true,"all"],left:["FormattingPosition","Left",false,"101,102,105,106,107,52,53,8,111"],showOnlyInRepeatingCopies:["FormattingAppearance","ShowOnlyInRepeatingCopies",true,"101,102,105,106,107,52,53,8,111"],paddingBottom:["FormattingPadding","BottomPadding",false,"52,106,t,de"],Blur:["FormattingAppearance","Blur",true,"8"],Orientation:["FormattingPage","Orientation",true,"all"],borderTopColor2:["FormattingBorder","Border3DTopColor",false,"102,106,107,52,53,111,101,8,t,de"],isLink:["FormattingNavigation","IsHyperlink",true,"102,106"],FilterDetailsFormatProperties:{FilterDetailsFormat:["FilterDetailsFormat",true,"all"]},gridOverFlow:["FormattingCrosstab","OverflowMode",true,"52"],DisplaySelectorDocked:["FormattingSelector","DisplaySelectorDocked",true,"111"],RSLPath:["FormattingWidget","RSLPath",true,"52,111"],listSeparators:{"2055":";","2064":";","2060":";","2052":",","3082":",","1046":";","1028":",","1036":";","1045":";","1049":";","4108":";","1033":",","1030":";","1031":";","1040":";","1041":",","1042":",","1043":";","1053":";","2057":","},canGrowHorizontal:["FormattingSize","CanGrowHorizontal",true,"4"],fontStyle:["FormattingFont","Italic",false,"52,106,107,111,8,t,de,df"],lockAspectRatio:["FormattingSize","LockAspectRatio",true,"102,106"],FormattingIncrementalFetch:{PreLoadAllPanels:["PSPreLoadAllPanels",true,"8","plp"],MaxRows:["gridIfMaxRows",true,"52","gmr"],RowIFMode:["gridIfRowMode",true,"52","gifmd"],EnableIFOnGrid:["gridIfEnabled",true,"52","gif"]},SupportedOrientations:["FormattingLayout","SupportedOrientations",true,"all"],APhoneVisualization:["Visualization","APhoneVisualization",true,"52"],textAlign2:["FormattingAlignment","Horizontal2",false,"52"],FormattingHTML:{HTMLType:["htmlType",true,"107","htype"],URL:["url",true,"107","hsrc"],HTMLText:["htmlText",true,"107","htxt"]},formatVersion:["FormattingAppearance","FormatVersion",true,"52"],OfflineSubmission:["FormattingSelector","OfflineSubmission",true,"111"],Enable:["FormattingWidget","Enable",true,"52,111"],ViewModeInteractivityLevel:["RWDocumentProperties","ViewModeInteractivityLevel",true,"all"],IPadVisualization:["Visualization","IPadVisualization",true,"52"],topCornersOnly:["FormattingAppearance","TopCornersOnly",true,"101,8"],backgroundColor:["FormattingPatterns","FillColor",false,"101,106,107,52,53,4,8,9,111,208,t,de"],borderLeftStyle:["FormattingBorder","LeftStyle",false,"102,106,107,52,53,111,8,t,de"],UseAsNavBar:["FormattingLayout","UseAsNavBar",true,"8"],ActionForDirectTargetSelectors:["FormattingSelector","ActionForDirectTargetSelectors",true,"111"],ShowFloatingToolbars:["RWDocumentProperties","ShowFloatingToolbars",true,"all"],MarginLeft:["FormattingPage","MarginLeft",true,"all"],TOCTitleFontBold:["TableOfContents","TitleFontBold",true,"all"],height:["FormattingSize","Height",false,"101,102,105,106,107,52,53,4,8,111,4"],PSPreLoadAllPanels:["FormattingIncrementalFetch","PreLoadAllPanels",true,"8"],borderRightColor2:["FormattingBorder","Border3DRightColor",false,"102,106,107,52,53,111,101,8,t,de"],decodeValue:function(A,H){try{if((A in mstrFormatObject)&&mstrFormatObject[A][mstrFormatObject.USE_VALUE]){return H;}var B=function(J,K){if(K!=undefined&&(J==null||J.length==0)){return K+"px";}else{if(J=="auto"||J=="100%"){return J;}else{return(parseFloat(microstrategy.number.toString(J))*microstrategy.DPI_CONVERSION*(microstrategy.ZOOM_FACTOR/100))+"px";}}};var E=function(J,K){if(K!=undefined&&(J==null||J.length==0)){J=K;}return parseFloat(J)*(microstrategy.ZOOM_FACTOR/100)+"pt";};var C=function(K,N){if(K==null||K.length==0){return(N!=undefined)?N:null;}if(K=="-1"){return"transparent";}else{if(K=="-2"){return -2;}else{var J=parseInt(K).toString(16);for(var M=0,L=J.length;M<6-L;M++){J="0"+J;}return"#"+J.substring(4)+J.substring(2,4)+J.substring(0,2);}}};var F={0:"0pt solid",8:"0pt none",3:"1pt dashed",4:"1pt dotted",5:"1.5pt solid",6:"2.5pt double",1:"1pt solid",7:"0.5pt solid"};var G=function(K){K=F[K]||"";if(K==null||K==""){return"";}var J=K.indexOf("pt");return(K.substring(0,J)*(microstrategy.ZOOM_FACTOR/100))+K.substring(J);};H=String(H);var I=H.toLowerCase();switch(A){case"top":return B(I);case"left":return B(I);case"width":return B(I);case"height":return B(I);case"oldWidth":case"oldHeight":case"heightMode":return I;case"widthMode":return I;case"maxHeight":return B(I);case"maxWidth":return B(I);case"TextOverflow":switch(I){case"-1":return"auto";case"0":return"hidden";}case"visibility":switch(I){case"-1":return"visible";case"0":return"hidden";}case"textAlign":switch(I){case"1":return"right";case"2":return"center";case"6":return"justify";default:return"left";}case"textAlign2":switch(I){case"4":return"right";case"3":return"center";case"6":return"justify";default:return"left";}case"verticalAlign":switch(I){case"1":return"middle";case"2":return"bottom";default:return"top";}case"verticalAlign2":switch(I){case"2":return"middle";case"3":return"bottom";default:return"top";}case"whiteSpace":switch(I){case"0":return"nowrap";default:return"normal";}case"fontSize":return E(I);case"color":return C(I,"");case"fontWeight":switch(I){case"-1":return"bold";default:return"normal";}case"fontStyle":switch(I){case"-1":return"italic";default:return"normal";}case"textDecoration":return(I==null||I.length==0||I=="0")?null:"underline";case"textDecoration2":return(I==null||I.length==0||I=="0")?null:"line-through";case"FontHighlightColor":return C(I);case"backgroundColor":return C(I,"");case"backgroundStyle":if(I==null||I.length==0){return null;}else{return(I=="1")?"transparent":"0";}case"gradientColor":return C(I);case"selectionColor":return C(I);case"BackgroundHighlightColor":return C(I);case"borderTopColor2":return C(I);case"borderRightColor2":return C(I);case"borderBottomColor2":return C(I);case"borderLeftColor2":return C(I);case"borderTopColor":return C(I);case"borderRightColor":return C(I);case"borderBottomColor":return C(I);case"borderLeftColor":return C(I);case"borderTopStyle":return G(I);case"borderRightStyle":return G(I);case"borderBottomStyle":return G(I);case"borderLeftStyle":return G(I);case"paddingLeft":return E(I);case"paddingRight":return E(I);case"paddingTop":return E(I);case"paddingBottom":return E(I);case"lineHeight":return(I==null||I.length==0||I=="0"||I=="")?"normal":parseFloat(I)+"in";case"lineStyle":switch(I){case"2":return"dashed";case"3":return"dotted";case"4":return"double";case"0":return"none";default:return"solid";}case"lineColor":return C(I,"");case"lineWeight":return E(I);case"orientation":switch(I){case"1":return"border-left";default:return"border-top";}case"PaperType":switch(I){case"1":return"2A,46.81,66.18";case"2":return"A0,33.11,46.81";case"3":return"A1,23.39,33.11";case"4":return"A2,16.54,23.39";case"5":return"A3,11.69,16.54";case"6":return"A4,8.27,11.69";case"7":return"A5,5.83,8.27";case"8":return"A6,4.13,5.83";case"9":return"A7,2.91,4.13";case"10":return"A8,2.09,2.91";case"11":return"C,17,22";case"12":return"D,22,34";case"13":return"E,34,44";case"14":return"Executive,7.25,10.5";case"15":return"F,28,40";case"16":return"Ledger,11,17";case"17":return"Legal,8.5,14";case"18":return"Letter,8.5,11";case"19":return"Super A3/B,13,19";case"20":return"Folio,8.5,13";default:return"Custom";}case"zoom":return parseFloat(microstrategy.number.toString(I));case"TabColor":return C(I,"");}}catch(D){microstrategy.errors.log(D);return H;}},mct:["FormattingSelector","MetricConditionType",true,"111"],maxWidth:["FormattingSize","MaxWidth",false,"4"],lengthMode:["FormattingSize","LengthMode",true,"105"],PromptUserForPagebyExport:["RWDocumentProperties","PromptUserForPagebyExport",true,"all"],whiteSpace:["FormattingAlignment","TextWrap",false,"52,106,107,t,de"],RemoveMissingUnits:["AnalyticalEngineProperties","RemoveMissingUnits",true,"all"],OfflineOnCube:["RWDocumentProperties","OfflineOnCube",true,"all"],TOCLeftIndent:["TableOfContents","LeftIndent",true,"all"],borderLeftColor:["FormattingBorder","LeftColor",false,"102,106,107,52,53,111,8,t,de"],SmartClientDoc:["RWDocumentProperties","SmartClientDoc",true,"all"],Transition:["FormattingTransitions","Transition",true,"8,52"],Scaling:["FormattingPage","Scaling",true,"all"],borderRightColor:["FormattingBorder","RightColor",false,"102,106,107,52,53,111,8,t,de"],zIndex:["FormattingOrder","ZIndex",true,"101,102,105,106,107,52,53,8,111"],ExpandAllPanels:["FormattingAppearance","ExpandAllPanels",true,"8"],FormattingOrder:{ZIndex:["zIndex",true,"101,102,105,106,107,52,53,8,111"]},FormattingSelector:{IndependentNodeSelector:["IndependentNodeSelector",true,"52"],Orientation:["ctlOrientation",true,"111"],MouseOverAction:["mouseOverAction",true,"111"],TXNSubmitInOrder:["TXNSubmitInOrder",true,"111"],DisplaySelectorDocked:["DisplaySelectorDocked",true,"111"],NoSelectionBehavior:["NoSelectionBehavior",true,"111","nsb"],MinSelectionCount:["MinSelectionCount",true,"111","misc"],Style:["Style",true,"111"],ActionForDirectTargetSelectors:["ActionForDirectTargetSelectors",true,"111","adts"],Multiselect:["Multiselect",true,"52,111"],InformationWindowTarget:["InformationWindowTarget",true,"102,106,111","ifw"],ShowElementCount:["showElementCount",true,"111","sec"],ItemWidthMode:["ItemWidthMode",true,"111"],ExportAsShownOnWeb:["ExportAsShownOnWeb",true,"111","aow"],MaxSelectionCount:["MaxSelectionCount",true,"111","masc"],ShowSummary:["ShowSummary",true,"111"],MetricConditionType:["mct",true,"111"],OfflineSubmission:["OfflineSubmission",true,"111"],SubmitMessage:["SubmitMessage",true,"111"],DisplayText:["DisplayText",true,"111"],SearchOnServer:["SearchOnServer",true,"111","sos"],Include:["Include",true,"111"],DisplayConfirmation:["DisplayConfirmation",true,"111"]},gridShowRH:["FormattingCrosstab","ShowRowHeaders",true,"52"],MaxSelectionCount:["FormattingSelector","MaxSelectionCount",true,"111"],TARGET:4,name:["FormattingAppearance","Name",true,"101,102,105,106,107,52,53,4,8,111"],textAlign:["FormattingAlignment","Horizontal",false,"106,111,107,t,de"],borderLeftColor2:["FormattingBorder","Border3DLeftColor",false,"102,106,107,52,53,111,101,8,t,de"],DisplayConfirmation:["FormattingSelector","DisplayConfirmation",true,"111"],TOCBorderColor:["TableOfContents","BorderColor",true,"all"],TXNSubmitInOrder:["FormattingSelector","TXNSubmitInOrder",true,"111"],NonFlashRender:["FormattingWidget","NonFlashRender",true,"52"],VisualizationList:["Visualization","VisualizationList",true,"52"],TOCFontName:["TableOfContents","FontName",true,"all"],TOCTitleFillColor:["TableOfContents","TitleFillColor",true,"all"],UseAsFilterPanel:["FormattingLayout","UseAsFilterPanel",true,"8"],forceNewPage:["FormattingSection","ForceNewPage",true,"4"],color:["FormattingFont","Color",false,"52,106,107,111,8,t,de,df"],RefreshFrequency:["Mobile","RefreshFrequency",true,"all"],windowState:["FormattingView","WindowState",true,"52,111"],TOCTitleFontColor:["TableOfContents","TitleFontColor",true,"all"],gridArea:["FormattingCrosstab","GridAreaPercent",true,"52"],lineHeight:["FormattingPadding","LineSpacing",false,"106,t"],PROP_SET:0,borderRightStyle:["FormattingBorder","RightStyle",false,"102,106,107,52,53,111,8,t,de"],exportOptions:["FormattingCrosstab","ShowExportOptions",true,"52"],CustomProps:["Visualization","CustomProps",true,"52"],FontHighlightColor:["FormattingFont","HighlightColor",false,"106"],ShowTabLeader:["TableOfContents","ShowTabLeader",true,"all"],autoResizeInDesign:["FormattingSize","AutoResizeInDesign",true,"106"],EnableExport:["Mobile","EnableExport",true,"all"],bottomRightCornerRadius:["FormattingAppearance","BottomRightCornerRadius",true,"101,8"],BeforeLayout:["TableOfContents","BeforeLayout",true,"all"],InformationWindowPlacement:["FormattingView","InformationWindowPlacement",true,"8"],orientation:["FormattingLine","LineOrientation",false,"105"],paddingTop:["FormattingPadding","TopPadding",false,"52,106,t,de"],FormattingFont:{Name:["fontFamily",true,"52,106,107,111,8,t,de,df"],Bold:["fontWeight",false,"52,106,107,111,8,t,de,df"],HighlightColor:["FontHighlightColor",false,"106","fhlc"],Underline:["textDecoration",false,"52,106,107,111,8,208,t,de,df"],Strikeout:["textDecoration2",false,"52,106,107,111,8,208,t,de,df"],Italic:["fontStyle",false,"52,106,107,111,8,t,de,df"],Color:["color",false,"52,106,107,111,8,t,de,df"],Size:["fontSize",false,"52,106,107,111,8,t,de,df"]},Visualization:{APhoneVisualization:["APhoneVisualization",true,"52","aphv"],IncludeMDProperties:["IncludeMDProperties",true,"52"],ATabletVisualization:["ATabletVisualization",true,"52","atv"],IPadVisualization:["IPadVisualization",true,"52","ipadv"],ViewMode:["ViewMode",true,"52"],IPhoneVisualization:["IPhoneVisualization",true,"52","iphv"],FileName:["FileName",true,"52"],VisualizationsEnabled:["VisualizationsEnabled",true,"52"],VisualizationList:["VisualizationList",true,"52"],SelectedVisualization:["SelectedVisualization",true,"52"],VisProps:["VisProps",true,"52"],CustomProps:["CustomProps",true,"52"]},fontSize:["FormattingFont","Size",false,"52,106,107,111,8,t,de,df"],paddingLeft:["FormattingPadding","LeftPadding",false,"52,106,t,de"],showTitleBar:["FormattingView","ShowTitleBar",true,"52,8,111"],BackgroundHighlightColor:["FormattingPatterns","HighlightColor",false,"8,106"],IgnoreInExport:["FormattingAppearance","IgnoreInExport",true,"8"],xTabView:["FormattingUnassigned","xTabView",true,"52"],oldWidth:["FormattingSize","OldWidth",false,"52"],SectionHorizontalOverflow:["FormattingPage","SectionHorizontalOverflow",true,"all"],EnableCopyForGridCell:["Mobile","EnableCopyForGridCell",true,"all"],SelectorBehavior:["RWDocumentProperties","SelectorBehavior",true,"all"],Multiselect:["FormattingSelector","Multiselect",true,"52,111"],ScalePagesTall:["FormattingPage","ScalePagesTall",true,"all"],ShowBookmarks:["FormattingPage","ShowBookmarks",true,"all"],ExportAsShownOnWeb:["FormattingSelector","ExportAsShownOnWeb",true,"111"],ExcelExportDocumentURL:["RWDocumentProperties","ExcelExportDocumentURL",true,"all"],WatermarkFontItalic:["WatermarkProperties","FontItalic",true,"all"],hideIfEmpty:["FormattingSection","HideIfEmpty",true,"4"],src:["FormattingUnassigned","src",true,"102"],FormattingPicture:{PictureAlignment:["pictureAlignment",true,"102"],NormalURL:["NormalURL",true,"106","nmurl"],HighlightURL:["HighlightURL",true,"106","hlurl"],PictureMode:["pictureMode",true,"102"]},ZoomType:["RWDocumentProperties","ZoomType",true,"all"],AnalysisSection:["FormattingAnalysis","AnalysisSection",true,"8,52"],NormalURL:["FormattingPicture","NormalURL",true,"106"],UseAsMasterPanel:["FormattingLayout","UseAsMasterPanel",true,"8"],"VLDB Select":{"MCE Join To Get Data Combination":["RWLevelMCEJoin",true,"all"]},FormattingLayout:{UseAsMasterPanel:["UseAsMasterPanel",true,"8","uamp"],UseAsTableControl:["UseAsTableControl",true,"8","uatc"],UseAsNavBar:["UseAsNavBar",true,"8","uanb"],UseMasterPageHeaderFooter:["TabMPHF",true,"all"],SupportedOrientations:["SupportedOrientations",true,"all"],UseAsFilterPanel:["UseAsFilterPanel",true,"8","uafp"],FitPDFContentHeight:["FitPDFContentHeight",true,"all"],ResetToFirstPanelWhenTargeted:["ResetToFirstPanelWhenTargeted",true,"all","rtfp"],Autowire:["Autowire",true,"all"],NavBarLayout:["NavBarLayout",true,"8","nbl"],UseSegments:["UseSegments",true,"all"],CtlAutoSubmit:["CtlAutoSubmit",true,"8","cas"],TabColor:["TabColor",false,"all"],DisplayPageByBar:["DisplayPageByBar",true,"all"],UseAsInfoWindow:["UseAsInfoWindow",true,"all"],DisplayRePromptIcon:["DisplayRePromptIcon",true,"all"],TableControlDefinition:["TableControlDefinition",true,"8","tcd"]},TARGET_VALUE_STYLE:1,TOCTitleFontStrikeout:["TableOfContents","TitleFontStrikeout",true,"all"],WatermarkFontStrikeout:["WatermarkProperties","FontStrikeout",true,"all"],TableControlDefinition:["FormattingLayout","TableControlDefinition",true,"8"],docked:["FormattingSection","DockSection",true,"dsec"],EditableViewMode:["FormattingPage","EditableViewMode",true,"all"],FormattingSection:{HideIfEmpty:["hideIfEmpty",true,"4","he"],FitExcelRowHeight:["fitExcelRowHeight",true,"4","ferh"],ForceNewPage:["forceNewPage",true,"4","fnp"],RepeatHorizontally:["repeatHorizontally",true,"4","rpth"],KeepSectionTogether:["keepSectionTogether",true,"4","kst"],RepeatSection:["repeatSection",true,"4","rpts"],ShowInHTMLViewMode:["showInHTMLViewMode",true,"4","shvm"],Expanded:["expanded",true,"none"],DockSection:["docked",true,"dsec","docked"]},TOCFontUnderline:["TableOfContents","FontUnderline",true,"all"],DocumentThemeColor:["Mobile","DocumentThemeColor",true,"all"],lineColor:["FormattingLine","LineColor",false,"101,105"],FormattingPage:{PageWidth:["PageWidth",true,"all"],PaperType:["PaperType",false,"all"],EditableViewMode:["EditableViewMode",true,"all"],GraphQualityDPI:["GraphQualityDPI",true,"all"],MarginTop:["MarginTop",true,"all"],DefaultGridStyle:["DefaultGridStyle",true,"all"],GraphFormat:["GraphFormat",true,"all"],ScalePagesTall:["ScalePagesTall",true,"all"],MarginLeft:["MarginLeft",true,"all"],ShowBookmarks:["ShowBookmarks",true,"all"],UsePageWidthAsLayoutWidth:["UsePageWidthAsLayoutWidth",true,"all"],ScalePageHeaderFooter:["ScalePageHeaderFooter",true,"all"],MarginBottom:["MarginBottom",true,"all"],PageHeight:["PageHeight",true,"all"],Width:["LayoutWidth",true,"all"],IncludeBookmarks:["IncludeBookmarks",true,"all"],BlackAndWhite:["BlackAndWhite",true,"all"],Orientation:["Orientation",true,"all"],EmbedFonts:["EmbedFonts",true,"all"],AvailableViewModes:["AvailableViewModes",true,"all"],MarginRight:["MarginRight",true,"all"],PrintHeaderOn:["PrintHeaderOn",true,"all"],UseOneSheetPerLayout:["UseOneSheetPerLayout",true,"all"],UseOneSheetPerGroupElement:["UseOneSheetPerGroupElement",true,"all"],ExpandToFit:["ExpandToFit",true,"all"],ScalePagesWide:["ScalePagesWide",true,"all"],PrintFooterOn:["PrintFooterOn",true,"all"],DefaultViewMode:["DefaultViewMode",true,"all"],ScalePercentage:["ScalePercentage",true,"all"],Scaling:["Scaling",true,"all"],SectionHorizontalOverflow:["SectionHorizontalOverflow",true,"all"]},DisplayText:["FormattingSelector","DisplayText",true,"111"],ShowTabsForSingleLayout:["RWDocumentProperties","ShowTabsForSingleLayout",true,"all"],CopyMode:["FormattingView","CopyMode",true,"106,52"],pictureAlignment:["FormattingPicture","PictureAlignment",true,"102"],DisplayInPartialScreen:["FormattingView","DisplayInPartialScreen",true,"8"],TOCTitleAlignment:["TableOfContents","TitleAlignment",true,"all"],pictureMode:["FormattingPicture","PictureMode",true,"102"],decimalSeparators:{"2055":".","2064":".","2060":",","2052":".","3082":",","1046":",","1028":".","1036":",","1045":",","1049":",","4108":".","1033":".","1030":",","1031":",","1040":",","1041":".","1042":".","1043":",","1053":",","2057":"."},AnalyticalEngineProperties:{TrimEmptySections:["TrimNoSectionData",true,"all"],RemoveNullGroups:["RemoveNullGroups",true,"all"],SingleSourceGrid:["SingleSourceGrid",true,"all"],KeepControlTargetsConsistent:["KeepControlTargetsConsistent",true,"all"],RemoveMissingUnits:["RemoveMissingUnits",true,"all"]},InformationWindowTarget:["FormattingSelector","InformationWindowTarget",true,"102,106,111"],backgroundStyle:["FormattingPatterns","FillStyle",false,"101,106,107,52,53,4,8,9,111,208"],lineWeight:["FormattingLine","LineWeight",false,"101,105"],ExpandToFit:["FormattingPage","ExpandToFit",true,"all"],TOCBorderStyle:["TableOfContents","BorderStyle",true,"all"],maxHeight:["FormattingSize","MaxHeight",false,"4"],IsNavigationDocument:["RWDocumentProperties","IsNavigationDocument",true,"all"],PROP_NAME:1,DatasetObjectsVisible:["FormattingAnalysis","DatasetObjectsVisible",true,"4"],CurrencySymbol:["FormattingNumber","CurrencySymbol",true,"100,106,52,t,de"],borderBottomColor:["FormattingBorder","BottomColor",false,"102,106,107,52,53,111,8,t,de"],ATTR_NAME:3,layoutBarStyle:["RWDocumentProperties","layoutBarStyle",true,"all"],AutoFontSize:["WatermarkProperties","AutoFontSize",true,"all"],ImageScale:["WatermarkProperties","ImageScale",true,"all"],heightMode:["FormattingSize","HeightMode",false,"101,102,105,106,107,52,53,111,8"],MarginTop:["FormattingPage","MarginTop",true,"all"],ExecutionFullScreenMode:["RWDocumentProperties","ExecutionFullScreenMode",true,"all"],FormattingCrosstab:{ShowExportOptions:["exportOptions",true,"52","seo"],ExportOverflowMode:["gridExportOverFlow",true,"52","xovf","2"],ShowRowHeaders:["gridShowRH",true,"52"],GridAreaPercent:["gridArea",true,"52"],ShowColHeaders:["gridShowCH",true,"52"],OverflowMode:["gridOverFlow",true,"52","ovf","2"],Prefetch:["quickSwitch",true,"52"],GridPosition:["gridPosition",true,"52"]},PageHeight:["FormattingPage","PageHeight",true,"all"],Include:["FormattingSelector","Include",true,"111"],CurrencyPosition:["FormattingNumber","CurrencyPosition",true,"100,106,52,t,de"],getAttrNameFromStyle:function(D){try{if(mstrFormatObject[D]){var C=mstrFormatObject[D][mstrFormatObject.PROP_SET];var A=mstrFormatObject[D][mstrFormatObject.PROP_NAME];if(C&&A){return mstrFormatObject[C][A][mstrFormatObject.ATTR_NAME];}}}catch(B){microstrategy.errors.log(err);}return null;},EnableTransition:["FormattingTransitions","Enable",true,"8,52"],NoSelectionBehavior:["FormattingSelector","NoSelectionBehavior",true,"111"],FormattingView:{DisplayInPartialScreen:["DisplayInPartialScreen",true,"8","dips"],TitleBarDisplay:["titleBarDisplay",true,"52,8","tbd"],ShowTitleBar:["showTitleBar",true,"52,8,111","swt"],InitialSlidingInHeight:["InitialSlidingInHeight",true,"8","isih"],InfoWindowPosition:["InfoWindowPosition",true,"8","iwp"],Title:["windowTitle",true,"52,8,9,111","wt"],WindowState:["windowState",true,"52,111","ws"],StyleForSwitchingPanel:["StyleForSwitchingPanel",true,"8","sfwp"],InitialSlidingInWidth:["InitialSlidingInWidth",true,"8","isiw"],InfoWindowMode:["InfoWindowMode",true,"8","iwm"],TabCloseToDismissInfoWindow:["TabCloseToDismissInfoWindow",true,"8","tctdiw"],UseAsInformationWindow:["UseAsInformationWindow",true,"8","uaiw"],EnableHorizontalSwipeToChange:["EnableHorizontalSwipeToChange",true,"8","ehstc"],ShowWidgetTitleBar:["ShowWidgetTitleBar",true,"52","swwt"],ShowAsCollapsiblePanel:["ShowAsCollapsiblePanel",true,"8","sacp"],CopyMode:["CopyMode",true,"106,52","mcm"],InformationWindowPlacement:["InformationWindowPlacement",true,"8","iwpl"]},FormattingUnassigned:{xTabView:["xTabView",true,"52","xTabView"],src:["src",true,"102","src"]},ShowChangeIndication:["FormattingTransactions","",true,"51,52"],enableGraphTooltips:["RWDocumentProperties","enableGraphTooltips",true,"all"],WatermarkFontSize:["WatermarkProperties","FontSize",true,"all"],UseAsInformationWindow:["FormattingView","UseAsInformationWindow",true,"8"],keepSectionTogether:["FormattingSection","KeepSectionTogether",true,"4"],Format:["FormattingNumber","Format",true,"100,106,52,t,de"],FormattingWidget:{WidgetProps:["WidgetProps",true,"52,111","wp"],SecondaryDataProviders:["SecondaryDataProviders",true,"52,111"],Enable:["Enable",true,"52,111"],RSLPath:["RSLPath",true,"52,111"],NonFlashRender:["NonFlashRender",true,"52","nfr","2"],ClassName:["ClassName",true,"52,111","twc","2"],IsApp:["IsApp",true,"52,111"],DhtmlRenderer:["DhtmlRenderer",true,"52","dr","2"]},DefaultGridStyle:["FormattingPage","DefaultGridStyle",true,"all"],getDecimalSeparator:function(B){try{return mstrFormatObject.decimalSeparators[B];}catch(A){microstrategy.errors.log(A);return".";}},TOCTitleFontUnderline:["TableOfContents","TitleFontUnderline",true,"all"],RepeatPanelSpacing:["FormattingAppearance","RepeatPanelSpacing",true,"8"],MarginBottom:["FormattingPage","MarginBottom",true,"all"],getPropertySetName:function(A){return mstrFormatObject[A][mstrFormatObject.PROP_SET];},DropZonesVisible:["FormattingAnalysis","DropZonesVisible",true,"8"],FormattingAlignment:{TextDirection:["TextDirection",true,"52,106,107,t,de","td","3"],Vertical2:["verticalAlign2",false,"52","vta2","3"],Vertical:["verticalAlign",false,"52,106,107,111,t,de","vta","3"],Horizontal2:["textAlign2",false,"52"],Horizontal:["textAlign",false,"106,111,107,t,de"],TextWrap:["whiteSpace",false,"52,106,107,t,de"]},TrimNoSectionData:["AnalyticalEngineProperties","TrimEmptySections",true,"all"],expanded:["FormattingSection","Expanded",true,"none"],ResetToFirstPanelWhenTargeted:["FormattingLayout","ResetToFirstPanelWhenTargeted",true,"all"],Collapsed:["FormattingAnalysis","Collapsed",true,"111"],DefaultPageByExportMode:["RWDocumentProperties","DefaultPageByExportMode",true,"all"],ExportRange:["RWDocumentProperties","ExportRange",true,"all"],topLeftCornerRadius:["FormattingAppearance","TopLeftCornerRadius",true,"101,8"],FormattingAppearance:{Transparency:["Transparency",true,"8","trpr"],Blur:["Blur",true,"8","blur"],TopCornersOnly:["topCornersOnly",true,"101,8","tco"],ExpandAllPanels:["ExpandAllPanels",true,"8","ep"],Visible:["visibility",false,"101,102,105,106,107,52,53,4,8,111","visible"],FormatVersion:["formatVersion",true,"52","fmtv"],DisplayStyle:["DisplayStyle",true,"106","dpst"],BottomRightCornerRadius:["bottomRightCornerRadius",true,"101,8","brcr"],ShowOnlyInRepeatingCopies:["showOnlyInRepeatingCopies",true,"101,102,105,106,107,52,53,8,111","sirc"],Name:["name",true,"101,102,105,106,107,52,53,4,8,111","nm"],IgnoreInExport:["IgnoreInExport",true,"8","cone"],DropShadowDepth:["dropShadowDepth",true,"101,102,105,106,107,53,8,111,52","dsw","3"],HasRoundedCorners:["hasRoundedCorners",true,"101,8","rc"],RepeatPanelSpacing:["RepeatPanelSpacing",true,"8","povfs"],Radius:["radius",true,"101,8","rd"],TooltipText:["title",true,"101,102,105,106,107,52,53,8,111","title"],TopRightCornerRadius:["topRightCornerRadius",true,"101,8","trcr"],BottomLeftCornerRadius:["bottomLeftCornerRadius",true,"101,8","blcr"],TopLeftCornerRadius:["topLeftCornerRadius",true,"101,8","tlcr"],DropShadowEffect:["dropShadowEffect",true,"101,102,105,106,107,53,8,111,52","dse","3"],SplitPanelAcrossPages:["SplitPanelAcrossPages",true,"8","spcp"]},ATabletVisualization:["Visualization","ATabletVisualization",true,"52"],FormattingSize:{MaxWidth:["maxWidth",false,"4","mw"],TextOverflow:["TextOverflow",false,"106,8","tovf"],AutoResizeInDesign:["autoResizeInDesign",true,"106","ard"],CanShrinkHorizontal:["canShrinkHorizontal",true,"4","csh"],CanShrink:["canShrink",true,"4","cs"],CanGrowHorizontal:["canGrowHorizontal",true,"4","cgh"],OldHeight:["oldHeight",false,"52","oldht","3"],Height:["height",false,"101,102,105,106,107,52,53,4,8,111,4","ht","3"],LockAspectRatio:["lockAspectRatio",true,"102,106"],LengthMode:["lengthMode",true,"105"],HeightMode:["heightMode",false,"101,102,105,106,107,52,53,111,8","hm"],MaxHeight:["maxHeight",false,"4","mh"],Length:["length",true,"105","cs"],Width:["width",false,"101,102,105,106,107,52,53,8,111,4","wd","3"],OldWidth:["oldWidth",false,"52","oldwd","3"],WidthMode:["widthMode",false,"101,102,105,106,107,52,53,8,111","wm"],CanGrow:["canGrow",true,"4","cg"]},lineStyle:["FormattingLine","LineStyle",false,"101,105"],getThousandsSeparator:function(B){try{return mstrFormatObject.thousandsSeparators[B];}catch(A){microstrategy.errors.log(A);return",";}},selectionStyle:["FormattingPatterns","SelectorSelectionFillStyle",true,"52,111"],FormattingGroup:{UseOneSheetPerPage:["UseOneSheetPerPage",true,"all"]},verticalAlign:["FormattingAlignment","Vertical",false,"52,106,107,111,t,de"],UsePageWidthAsLayoutWidth:["FormattingPage","UsePageWidthAsLayoutWidth",true,"all"],RWLevelMCEJoin:["VLDB Select","MCE Join To Get Data Combination",true,"all"],EnableSwipingToSwitchLayout:["Mobile","EnableSwipingToSwitchLayout",true,"all"],CtlAutoSubmit:["FormattingLayout","CtlAutoSubmit",true,"8"],fontFamily:["FormattingFont","Name",true,"52,106,107,111,8,t,de,df"],DisplayPageByBar:["FormattingLayout","DisplayPageByBar",true,"all"],PreLoadAllPanels:["RWDocumentProperties","PreLoadAllPanels",true,"all"],WatermarkFontBold:["WatermarkProperties","FontBold",true,"all"],layoutBarPosition:["RWDocumentProperties","layoutBarPosition",true,"all"],gridIfMaxRows:["FormattingIncrementalFetch","MaxRows",true,"52"],selectionColor:["FormattingPatterns","SelectorSelectionColor",false,"52,111"],Title:["TableOfContents","Title",true,"all"],paddingRight:["FormattingPadding","RightPadding",false,"52,106,t,de"],DropZonesWidth:["FormattingAnalysis","DropZonesWidth",true,"8"],FilterMode:["FormattingAnalysis","FilterMode",true,"8"],dropShadowDepth:["FormattingAppearance","DropShadowDepth",true,"101,102,105,106,107,53,8,111,52"],gridIfRowMode:["FormattingIncrementalFetch","RowIFMode",true,"52"],APPLIES_TO:3,borderBottomStyle:["FormattingBorder","BottomStyle",false,"102,106,107,52,53,111,8,t,de"],TextOverflow:["FormattingSize","TextOverflow",false,"106,8"],htmlType:["FormattingHTML","HTMLType",true,"107"],verticalAlign2:["FormattingAlignment","Vertical2",false,"52"],GraphQualityDPI:["FormattingPage","GraphQualityDPI",true,"all"],MinSelectionCount:["FormattingSelector","MinSelectionCount",true,"111"],FormattingPatterns:{SelectorSelectionColor:["selectionColor",false,"52,111","ssc"],GradientColor:["gradientColor",false,"101,106,107,52,53,4,8,9,111,208"],GradientXOffset:["gradientXOffset",true,"101,106,107,52,53,4,8,9,111,208"],FillColor:["backgroundColor",false,"101,106,107,52,53,4,8,9,111,208,t,de"],HighlightColor:["BackgroundHighlightColor",false,"8,106","bhlc"],SelectorSelectionFillStyle:["selectionStyle",true,"52,111","sstyle"],GradientYOffset:["gradientYOffset",true,"101,106,107,52,53,4,8,9,111,208"],GradientAngle:["gradientAngle",true,"101,106,107,52,53,4,8,9,111,208"],FillStyle:["backgroundStyle",false,"101,106,107,52,53,4,8,9,111,208","bgstyle","3"],FillEffect:["FillEffect",true,"106","fe"]},canShrink:["FormattingSize","CanShrink",true,"4"],gridIfEnabled:["FormattingIncrementalFetch","EnableIFOnGrid",true,"52"],WatermarkFontUnderline:["WatermarkProperties","FontUnderline",true,"all"],bottomLeftCornerRadius:["FormattingAppearance","BottomLeftCornerRadius",true,"101,8"],gridPosition:["FormattingCrosstab","GridPosition",true,"52"],EnableBookStylePagebyNavigation:["Mobile","EnableBookStylePagebyNavigation",true,"all"],ShowAsCollapsiblePanel:["FormattingView","ShowAsCollapsiblePanel",true,"8"],VisProps:["Visualization","VisProps",true,"52"],NegativeNumbers:["FormattingNumber","NegativeNumbers",true,"100,106,52,t,de"],TOCTitleFontName:["TableOfContents","TitleFontName",true,"all"],quickSwitch:["FormattingCrosstab","Prefetch",true,"52"],ViewMode:["Visualization","ViewMode",true,"52"],width:["FormattingSize","Width",false,"101,102,105,106,107,52,53,8,111,4"],showInHTMLViewMode:["FormattingSection","ShowInHTMLViewMode",true,"4"],MarginRight:["FormattingPage","MarginRight",true,"all"],TARGET_VALUE_ATTR:2,USE_VALUE:2,url:["FormattingHTML","URL",true,"107"],FitPDFContentHeight:["FormattingLayout","FitPDFContentHeight",true,"all"],ExcelGraphFormat:["RWDocumentProperties","ExcelGraphFormat",true,"all"],WatermarkProperties:{FontColor:["WatermarkFontColor",true,"all"],FontName:["WatermarkFontName",true,"all"],AutoFontSize:["AutoFontSize",true,"all"],ImageScale:["ImageScale",true,"all"],FontScript:["WatermarkFontScript",true,"all"],FontBold:["WatermarkFontBold",true,"all"],FontSize:["WatermarkFontSize",true,"all"],TextOrientation:["TextOrientation",true,"all"],ImageSource:["ImageSource",true,"all"],FontItalic:["WatermarkFontItalic",true,"all"],Text:["Text",true,"all"],WatermarkType:["WatermarkType",true,"all"],FontStrikeout:["WatermarkFontStrikeout",true,"all"],FontUnderline:["WatermarkFontUnderline",true,"all"],TextWashout:["TextWashout",true,"all"]},b3dstyle:["FormattingBorder","Border3DStyle",true,"102,106,107,52,53,111,112,101,8,t,de"],TabCloseToDismissInfoWindow:["FormattingView","TabCloseToDismissInfoWindow",true,"8"],PrintFooterOn:["FormattingPage","PrintFooterOn",true,"all"],ScalePercentage:["FormattingPage","ScalePercentage",true,"all"],Enabled:["TableOfContents","Enabled",true,"all"],thousandsSeparators:{"2055":"'","2064":"'","2060":".","2052":",","3082":".","1046":".","1028":",","1036":" ","1045":" ","1049":" ","4108":"'","1033":",","1030":".","1031":".","1040":".","1041":",","1042":",","1043":".","1053":" ","2057":","},ShowHiddenObjects:["RWDocumentProperties","ShowHiddenObjects",true,"all"],canGrow:["FormattingSize","CanGrow",true,"4"],RemoveNullGroups:["AnalyticalEngineProperties","RemoveNullGroups",true,"all"],RWDocumentProperties:{ShowHiddenObjects:["ShowHiddenObjects",true,"all"],layoutBarStyle:["layoutBarStyle",true,"all"],EmbeddedFonts:["EmbeddedFonts",true,"all"],ZoomFactor:["zoom",false,"all"],SelectorBehavior:["SelectorBehavior",true,"all"],ShowFloatingToolbars:["ShowFloatingToolbars",true,"all"],ApplyGBToAllLayouts:["ApplyGBToAllLayouts",true,"all"],ShowingBarsTemporarily:["ShowingBarsTemporarily",true,"all"],ExcelExportDocumentURL:["ExcelExportDocumentURL",true,"all"],ExecutionFullScreenMode:["ExecutionFullScreenMode",true,"all"],CtlAutoSubmit:["CtlAutoSubmit",true,"all"],ShowTabsForSingleLayout:["ShowTabsForSingleLayout",true,"all"],ZoomType:["ZoomType",true,"all"],PromptUserForPagebyExport:["PromptUserForPagebyExport",true,"all"],PreLoadAllPanels:["PreLoadAllPanels",true,"all"],ExcelEmbedImages:["ExcelEmbedImages",true,"all"],PreserveTranslations:["PreserveTranslations",true,"all"],OfflineOnCube:["OfflineOnCube",true,"all"],layoutBarPosition:["layoutBarPosition",true,"all"],DocumentVersion:["DocumentVersion",true,"all"],PDFExportDocumentURL:["PDFExportDocumentURL",true,"all"],CalculateDocWidth:["CalculateDocWidth",true,"all"],ExcelGraphFormat:["ExcelGraphFormat",true,"all"],enableGraphTooltips:["enableGraphTooltips",true,"all"],SmartClientDoc:["SmartClientDoc",true,"all"],ViewModeInteractivityLevel:["ViewModeInteractivityLevel",true,"all"],IsNavigationDocument:["IsNavigationDocument",true,"all"],DefaultPageByExportMode:["DefaultPageByExportMode",true,"all"],ExportRange:["ExportRange",true,"all"]},TOCFontBold:["TableOfContents","FontBold",true,"all"],TextDirection:["FormattingAlignment","TextDirection",true,"52,106,107,t,de"],WatermarkFontName:["WatermarkProperties","FontName",true,"all"],getPropertyName:function(A){return mstrFormatObject[A][mstrFormatObject.PROP_NAME];},windowTitle:["FormattingView","Title",true,"52,8,9,111"],Duration:["FormattingTransitions","Duration",true,"8,52"],top:["FormattingPosition","Top",false,"101,102,105,106,107,52,53,8,111"],EnableCopyForText:["Mobile","EnableCopyForText",true,"all"],WidgetProps:["FormattingWidget","WidgetProps",true,"52,111"],HTML_PROP_NAME:0,TOCFontSize:["TableOfContents","FontSize",true,"all"],Category:["FormattingNumber","Category",true,"100,106,52,t,de"],ShowSummary:["FormattingSelector","ShowSummary",true,"111"],SubmitMessage:["FormattingSelector","SubmitMessage",true,"111"],TOCFontStrikeout:["TableOfContents","FontStrikeout",true,"all"],InfoWindowMode:["FormattingView","InfoWindowMode",true,"8"],showElementCount:["FormattingSelector","ShowElementCount",true,"111"],FileName:["Visualization","FileName",true,"52"],ScalePagesWide:["FormattingPage","ScalePagesWide",true,"all"],getPxFromPt:function(A){return parseFloat(A)*(microstrategy.DPI_CONVERSION/72);},UseAsInfoWindow:["FormattingLayout","UseAsInfoWindow",true,"all"],WatermarkFontColor:["WatermarkProperties","FontColor",true,"all"],oldHeight:["FormattingSize","OldHeight",false,"52"],DisplayRePromptIcon:["FormattingLayout","DisplayRePromptIcon",true,"all"],WatermarkFontScript:["WatermarkProperties","FontScript",true,"all"],gradientColor:["FormattingPatterns","GradientColor",false,"101,106,107,52,53,4,8,9,111,208"],mouseOverAction:["FormattingSelector","MouseOverAction",true,"111"],canShrinkHorizontal:["FormattingSize","CanShrinkHorizontal",true,"4"],htmlText:["FormattingHTML","HTMLText",true,"107"],ClassName:["FormattingWidget","ClassName",true,"52,111"],gradientAngle:["FormattingPatterns","GradientAngle",true,"101,106,107,52,53,4,8,9,111,208"],IndependentNodeSelector:["FormattingSelector","IndependentNodeSelector",true,"52"],HTML_USE_VALUE:1,IsApp:["FormattingWidget","IsApp",true,"52,111"],DhtmlRenderer:["FormattingWidget","DhtmlRenderer",true,"52"],encodeValue:function(A,H){try{if((A in mstrFormatObject)&&mstrFormatObject[A][mstrFormatObject.USE_VALUE]){return H;}var B=function(J,K){if(K!=undefined&&(J==null||J.length==0)){return parseInt(K,10);}else{if(J=="auto"||J=="100%"){return J;}else{return microstrategy.number.toLocaleString(parseFloat(I)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100));}}};var F=function(J,K){if(K!=undefined&&(J==null||J.length==0)){J=K;}return parseFloat(microstrategy.number.toString(J,false))/(microstrategy.ZOOM_FACTOR/100);};var C=function(J,K){if(K!=undefined&&(J==null||J.length==0||J=="undefined")){J=K;}if(J=="transparent"){return -1;}else{if(J==-2){return -2;}else{return parseInt(J.substring(5)+J.substring(3,5)+J.substring(1,3),16);}}};var D=function(J,K){return(J!=null&&J.indexOf(K)>-1)?"-1":"0";};var G=function(K){K=K||"";if(K!=""){var J=K.indexOf("pt");K=((K.substring(0,J)/(microstrategy.ZOOM_FACTOR/100))+"").substring(0,Math.min(J,3))+K.substring(J);}switch(K){case"0pt solid":return"0";case"0pt none":return"8";case"1pt dashed":return"3";case"1pt dotted":return"4";case"1.5pt solid":return"5";case"2.5pt double":return"6";case"1pt solid":return"1";case"0.5pt solid":return"7";default:return"-1";}};H=String(H);var I=H.toLowerCase();switch(A){case"top":return B(I);case"left":return B(I);case"width":return B(I);case"height":return B(I);case"oldWidth":case"oldHeight":case"heightMode":return I;case"widthMode":return I;case"maxHeight":return B(I);case"maxWidth":return B(I);case"TextOverflow":switch(I){case"auto":return"-1";case"hidden":return"0";}case"visibility":switch(I){case"visible":return"-1";case"hidden":return"0";}case"textAlign":switch(I){case"right":return"1";case"center":return"2";case"justify":return"6";default:return"0";}case"textAlign2":switch(I){case"right":return"4";case"center":return"3";case"justify":return"6";default:return"2";}case"verticalAlign":switch(I){case"middle":return"1";case"bottom":return"2";default:return"0";}case"verticalAlign2":switch(I){case"middle":return"2";case"bottom":return"3";default:return"1";}case"whiteSpace":switch(I){case"nowrap":return"0";default:return"-1";}case"fontSize":return F(I);case"color":return C(I,"#000000");case"fontWeight":switch(I){case"bold":return"-1";default:return"0";}case"fontStyle":switch(I){case"italic":return"-1";default:return"0";}case"textDecoration":return D(I,"underline");case"textDecoration2":return D(I,"line-through");case"FontHighlightColor":return C(I,"#000000");case"backgroundColor":if(I&&I.indexOf(",")>0){I="#"+I.split(",")[0];}return C(I,"#FFFFFF");case"backgroundStyle":if(I&&I.indexOf(",")>0){return"2";}if(I=="gradient"){return"2";}if(I=="transparent"){return"1";}else{return"0";}case"gradientColor":if(I&&I.indexOf(",")>0){I="#"+I.split(",")[1];}return C(I,"#000000");case"selectionColor":return C(I,"#000000");case"BackgroundHighlightColor":return C(I,"#000000");case"borderTopColor2":return C(I,"#000000");case"borderRightColor2":return C(I,"#000000");case"borderBottomColor2":return C(I,"#000000");case"borderLeftColor2":return C(I,"#000000");case"borderTopColor":return C(I,"#000000");case"borderRightColor":return C(I,"#000000");case"borderBottomColor":return C(I,"#000000");case"borderLeftColor":return C(I,"#000000");case"borderTopStyle":return G(I);case"borderRightStyle":return G(I);case"borderBottomStyle":return G(I);case"borderLeftStyle":return G(I);case"paddingLeft":return F(I);case"paddingRight":return F(I);case"paddingTop":return F(I);case"paddingBottom":return F(I);case"lineHeight":return(I==null||I=="0"||I=="normal"||I=="")?"":parseFloat(I);case"lineStyle":switch(I){case"dashed":return"2";case"dotted":return"3";case"double":return"4";case"none":return"0";default:return"1";}case"lineColor":return C(I,"#000000");case"lineWeight":return F(I);case"orientation":switch(I){case"border-left":return"1";default:return"0";}case"PaperType":switch(I){case"2a,46.81,66.18":return"1";case"a0,33.11,46.81":return"2";case"a1,23.39,33.11":return"3";case"a2,16.54,23.39":return"4";case"a3,11.69,16.54":return"5";case"a4,8.27,11.69":return"6";case"a5,5.83,8.27":return"7";case"a6,4.13,5.83":return"8";case"a7,2.91,4.13":return"9";case"a8,2.09,2.91":return"10";case"c,17,22":return"11";case"d,22,34":return"12";case"e,34,44":return"13";case"executive,7.25,10.5":return"14";case"f,28,40":return"15";case"ledger,11,17":return"16";case"legal,8.5,14":return"17";case"letter,8.5,11":return"18";case"super a3/b,13,19":return"19";case"folio,8.5,13":return"20";default:return"0";}case"zoom":return microstrategy.number.toLocaleString(parseFloat(I));case"TabColor":return C(I,"#ffffff");case"colWidth":return Math.round(parseInt(I)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100)*microstrategy.BASE_DPI);}}catch(E){microstrategy.errors.log(E);return H;}},TableOfContents:{TitleFontItalic:["TOCTitleFontItalic",true,"all"],Enabled:["Enabled",true,"all"],FontColor:["TOCFontColor",true,"all"],TitleAlignment:["TOCTitleAlignment",true,"all"],TitleFontBold:["TOCTitleFontBold",true,"all"],BorderWeight:["TOCBorderWeight",true,"all"],TitleFontStrikeout:["TOCTitleFontStrikeout",true,"all"],UserSeparateStyleForTitle:["TOCTitleEnableInherit",true,"all"],FontSize:["TOCFontSize",true,"all"],RightIndent:["TOCRightIndent",true,"all"],FontItalic:["TOCFontItalic",true,"all"],TitleFontUnderline:["TOCTitleFontUnderline",true,"all"],ShowTabLeader:["ShowTabLeader",true,"all"],FillColor:["TOCFillColor",true,"all"],BeforeLayout:["BeforeLayout",true,"all"],LeftIndent:["TOCLeftIndent",true,"all"],TitleFontSize:["TOCTitleFontSize",true,"all"],FontName:["TOCFontName",true,"all"],TitleFontColor:["TOCTitleFontColor",true,"all"],BorderStyle:["TOCBorderStyle",true,"all"],TitleFillStyle:["TOCTitleFillStyle",true,"all"],FontBold:["TOCFontBold",true,"all"],FillStyle:["TOCFillStyle",true,"all"],Title:["Title",true,"all"],IncludePageHeaderFooter:["IncludePageHeaderFooter",true,"all"],BorderColor:["TOCBorderColor",true,"all"],TitleFillColor:["TOCTitleFillColor",true,"all"],FontUnderline:["TOCFontUnderline",true,"all"],FontStrikeout:["TOCFontStrikeout",true,"all"],TitleFontName:["TOCTitleFontName",true,"all"]},UseOneSheetPerGroupElement:["FormattingPage","UseOneSheetPerGroupElement",true,"all"],DecimalPlaces:["FormattingNumber","DecimalPlaces",true,"100,106,52,t,de"],radius:["FormattingAppearance","Radius",true,"101,8"],locked:["FormattingPosition","Locked",true,"101,102,105,106,107,52,53,8,111"],SplitPanelAcrossPages:["FormattingAppearance","SplitPanelAcrossPages",true,"8"],ctlOrientation:["FormattingSelector","Orientation",true,"111"],link:["FormattingNavigation","Hyperlink",true,"102,106"],FormattingNumber:{ThousandSeparator:["ThousandSeparator",true,"100,106,52,t,de","nth","2"],Category:["Category",true,"100,106,52,t,de","nct","2"],Format:["Format",true,"100,106,52,t,de","nfs","2"],DecimalPlaces:["DecimalPlaces",true,"100,106,52,t,de","ndp","2"],CurrencyPosition:["CurrencyPosition",true,"100,106,52,t,de","ncp","2"],CurrencySymbol:["CurrencySymbol",true,"100,106,52,t,de","ncs","2"],NegativeNumbers:["NegativeNumbers",true,"100,106,52,t,de","nnn","2"]},UseOneSheetPerPage:["FormattingGroup","UseOneSheetPerPage",true,"all"],repeatHorizontally:["FormattingSection","RepeatHorizontally",true,"4"],title:["FormattingAppearance","TooltipText",true,"101,102,105,106,107,52,53,8,111"],UseSegments:["FormattingLayout","UseSegments",true,"all"],ScalePageHeaderFooter:["FormattingPage","ScalePageHeaderFooter",true,"all"],length:["FormattingSize","Length",true,"105"],EnableZoom:["Mobile","EnableZoom",true,"all"],DatasetsSettings:["FormattingAnalysis","DatasetsSettings",true,"4"],Transparency:["FormattingAppearance","Transparency",true,"8"],TOCRightIndent:["TableOfContents","RightIndent",true,"all"],FormattingPosition:{Top:["top",false,"101,102,105,106,107,52,53,8,111"],Locked:["locked",true,"101,102,105,106,107,52,53,8,111","lck"],Left:["left",false,"101,102,105,106,107,52,53,8,111"]},ExcelEmbedImages:["RWDocumentProperties","ExcelEmbedImages",true,"all"],PreserveTranslations:["RWDocumentProperties","PreserveTranslations",true,"all"],gridShowCH:["FormattingCrosstab","ShowColHeaders",true,"52"],UseAsTableControl:["FormattingLayout","UseAsTableControl",true,"8"],DocumentVersion:["RWDocumentProperties","DocumentVersion",true,"all"],TOCBorderWeight:["TableOfContents","BorderWeight",true,"all"],SearchOnServer:["FormattingSelector","SearchOnServer",true,"111"],DefaultViewMode:["FormattingPage","DefaultViewMode",true,"all"],PageWidth:["FormattingPage","PageWidth",true,"all"],TabMPHF:["FormattingLayout","UseMasterPageHeaderFooter",true,"all"],DatasetObjectsWidth:["FormattingAnalysis","DatasetObjectsWidth",true,"4"],borderTopStyle:["FormattingBorder","TopStyle",false,"102,106,107,52,53,111,8,t,de"],FormattingTransactions:{"":["ShowChangeIndication",true,"51,52"],SetBadgeToValueOnField:["SetBadgeToValueOnField",true,"106"]},EmbeddedFonts:["RWDocumentProperties","EmbeddedFonts",true,"all"],Style:["FormattingSelector","Style",true,"111"],b3dweight:["FormattingBorder","Border3DWeight",true,"102,106,107,52,53,111,112,101,8,t,de"],ApplyGBToAllLayouts:["RWDocumentProperties","ApplyGBToAllLayouts",true,"all"],ItemWidthMode:["FormattingSelector","ItemWidthMode",true,"111"],ShowingBarsTemporarily:["RWDocumentProperties","ShowingBarsTemporarily",true,"all"],NavBarLayout:["FormattingLayout","NavBarLayout",true,"8"],TOCFillColor:["TableOfContents","FillColor",true,"all"],VisualizationsEnabled:["Visualization","VisualizationsEnabled",true,"52"],repeatSection:["FormattingSection","RepeatSection",true,"4"],Mobile:{EnableCopyForGridCell:["EnableCopyForGridCell",true,"all"],EnableCopyForText:["EnableCopyForText",true,"all"],View:["MobileDataView",true,"all"],EnableSwipingToSwitchLayout:["EnableSwipingToSwitchLayout",true,"all"],DocumentThemeColor:["DocumentThemeColor",true,"all"],EnableExport:["EnableExport",true,"all"],RefreshFrequency:["RefreshFrequency",true,"all"],EnableZoom:["EnableZoom",true,"all"],EnableBookStylePagebyNavigation:["EnableBookStylePagebyNavigation",true,"all"]},TabColor:["FormattingLayout","TabColor",false,"all"],FormattingAnalysis:{FilterMode:["FilterMode",true,"8"],DropZonesWidth:["DropZonesWidth",true,"8"],AnalysisSection:["AnalysisSection",true,"8,52"],FilterDisplay:["FilterDisplay",true,"8"],DatasetObjectsWidth:["DatasetObjectsWidth",true,"4"],Collapsed:["Collapsed",true,"111"],DropZonesVisible:["DropZonesVisible",true,"8"],DatasetsSettings:["DatasetsSettings",true,"4"],DatasetObjectsVisible:["DatasetObjectsVisible",true,"4"]},IncludeBookmarks:["FormattingPage","IncludeBookmarks",true,"all"],FillEffect:["FormattingPatterns","FillEffect",true,"106"],IncludeMDProperties:["Visualization","IncludeMDProperties",true,"52"],FilterDisplay:["FormattingAnalysis","FilterDisplay",true,"8"],textDecoration2:["FormattingFont","Strikeout",false,"52,106,107,111,8,208,t,de,df"],dropShadowEffect:["FormattingAppearance","DropShadowEffect",true,"101,102,105,106,107,53,8,111,52"],ImageSource:["WatermarkProperties","ImageSource",true,"all"],IncludePageHeaderFooter:["TableOfContents","IncludePageHeaderFooter",true,"all"],TOCTitleFontSize:["TableOfContents","TitleFontSize",true,"all"],TOCTitleEnableInherit:["TableOfContents","UserSeparateStyleForTitle",true,"all"],fitExcelRowHeight:["FormattingSection","FitExcelRowHeight",true,"4"],ShowWidgetTitleBar:["FormattingView","ShowWidgetTitleBar",true,"52"],FormattingTransitions:{Enable:["EnableTransition",true,"8,52"],Duration:["Duration",true,"8,52","tdr","2"],Transition:["Transition",true,"8,52","ttr","2"]},ThousandSeparator:["FormattingNumber","ThousandSeparator",true,"100,106,52,t,de"],FormattingBorder:{TopColor:["borderTopColor",false,"102,106,107,52,53,111,8,t,de","btc","3"],BottomStyle:["borderBottomStyle",false,"102,106,107,52,53,111,8,t,de","bbs","3"],Border3DWeight:["b3dweight",true,"102,106,107,52,53,111,112,101,8,t,de","b3dweight","3"],TopStyle:["borderTopStyle",false,"102,106,107,52,53,111,8,t,de","bts","3"],LeftColor:["borderLeftColor",false,"102,106,107,52,53,111,8,t,de","blc","3"],BottomColor:["borderBottomColor",false,"102,106,107,52,53,111,8,t,de","bbc","3"],Border3DRightColor:["borderRightColor2",false,"102,106,107,52,53,111,101,8,t,de","b3drc","3"],RightStyle:["borderRightStyle",false,"102,106,107,52,53,111,8,t,de","brs","3"],Border3DLeftColor:["borderLeftColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dlc","3"],Border3DBottomColor:["borderBottomColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dbc","3"],RightColor:["borderRightColor",false,"102,106,107,52,53,111,8,t,de","brc","3"],Border3DTopColor:["borderTopColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dtc","3"],Border3DStyle:["b3dstyle",true,"102,106,107,52,53,111,112,101,8,t,de","b3dstyle","3"],LeftStyle:["borderLeftStyle",false,"102,106,107,52,53,111,8,t,de","bls","3"]},TOCFontColor:["TableOfContents","FontColor",true,"all"],StyleForSwitchingPanel:["FormattingView","StyleForSwitchingPanel",true,"8"],TOCTitleFillStyle:["TableOfContents","TitleFillStyle",true,"all"],newWin:["FormattingNavigation","OpenInNewWindow",true,"102,106"],TOCFillStyle:["TableOfContents","FillStyle",true,"all"],SingleSourceGrid:["AnalyticalEngineProperties","SingleSourceGrid",true,"all"],getListSeparator:function(B){try{return mstrFormatObject.listSeparators[B];}catch(A){microstrategy.errors.log(A);return",";}},gradientXOffset:["FormattingPatterns","GradientXOffset",true,"101,106,107,52,53,4,8,9,111,208"],isTargetStyleOrAttr:function(E){try{var B=mstrFormatObject.TARGET_VALUE_STYLE;if(!mstrFormatObject[E]){return B;}var D=mstrFormatObject.getPropertySetName(E);var A=mstrFormatObject.getPropertyName(E);if(mstrFormatObject.getAttrNameFromStyle(E)==null||mstrFormatObject.getAttrNameFromStyle(E).length==0){return B;}B=mstrFormatObject.TARGET_VALUE_ATTR;if(mstrFormatObject[D][A][mstrFormatObject.TARGET]&&(parseInt(mstrFormatObject[D][A][mstrFormatObject.TARGET])&(parseInt(mstrFormatObject.TARGET_VALUE_STYLE)+parseInt(mstrFormatObject.TARGET_VALUE_ATTR)))>0){B+=mstrFormatObject.TARGET_VALUE_STYLE;}return B;}catch(C){microstrategy.errors.log(err);}return null;},TextWashout:["WatermarkProperties","TextWashout",true,"all"],widthMode:["FormattingSize","WidthMode",false,"101,102,105,106,107,52,53,8,111"],borderTopColor:["FormattingBorder","TopColor",false,"102,106,107,52,53,111,8,t,de"],FormattingLine:{LineStyle:["lineStyle",false,"101,105","ls","3"],LineWeight:["lineWeight",false,"101,105","lw","3"],LineOrientation:["orientation",false,"105","or"],LineColor:["lineColor",false,"101,105","lc","3"]},TextOrientation:["WatermarkProperties","TextOrientation",true,"all"],PrintHeaderOn:["FormattingPage","PrintHeaderOn",true,"all"],KeepControlTargetsConsistent:["AnalyticalEngineProperties","KeepControlTargetsConsistent",true,"all"],UseOneSheetPerLayout:["FormattingPage","UseOneSheetPerLayout",true,"all"],Text:["WatermarkProperties","Text",true,"all"],InitialSlidingInWidth:["FormattingView","InitialSlidingInWidth",true,"8"],WatermarkType:["WatermarkProperties","WatermarkType",true,"all"],TOCFontItalic:["TableOfContents","FontItalic",true,"all"],hasRoundedCorners:["FormattingAppearance","HasRoundedCorners",true,"101,8"],HighlightURL:["FormattingPicture","HighlightURL",true,"106"]};mstrRaOutlineModeImplScript=true;mstrRaOutlineModeImpl.prototype=new Object();mstrRaOutlineModeImpl.prototype.expandImage="";mstrRaOutlineModeImpl.prototype.contractImage="";mstrRaOutlineModeImpl.prototype.startRow=0;mstrRaOutlineModeImpl.prototype.endRow=0;mstrRaOutlineModeImpl.prototype.gridBone=null;function mstrRaOutlineModeImpl(B,A,C){this.startRow=B;this.endRow=A;this.expandImage="../images/expand.gif";this.contractImage="../images/contract.gif";this.gridBone=C;return this;}mstrRaOutlineModeImpl.prototype.showHideRows=function(F){var E=new RaGridCell(microstrategy.findParentWithTag(F,"td"));var H=this.findScanScopeStartRow(E);var D=0;while(H){var C=new RaGridRow(H);if(this.isOutOfScanScope(E,C)||(C.getFirstCellIdOrdinal()==E.gridCellId.iOrdinal&&C.getFirstCellRaLvl()<=E.iRaElementLevel)){break;}C.updateCollapseTime(!E.bExpandable);if((!E.bExpandable&&!C.isHidden())||(E.bExpandable&&C.isCollapseTimeCleared())){C.updateDisplayStatus(E.bExpandable);D+=(E.bExpandable?1:-1);}H=H.nextElementSibling;}if(D!=0){var G=E.gridCellId.iOrdinal-1;var H=E.srcHtmlTableCell.parentNode;while(G>0){while(H){var C=new RaGridRow(H);var A=C.findCellsWithTargetIdOrdinal(G);if(A&&A.length>0){for(var B=0;B<A.length;B++){this.updateRowSpan(A[B],D);}break;}H=H.previousSibling;}G--;}}else{E.hideCollapseExpandIcon();}E.updateExpdAndImg(this.expandImage,this.contractImage,E.bExpandable);this.resize();};mstrRaOutlineModeImpl.prototype.findScanScopeStartRow=function(A){var C=A.srcHtmlTableCell.parentNode.nextSibling;while(C){var B=new RaGridRow(C).getFirstCellIdOrdinal();if(B<A.gridCellId.iOrdinal){C=null;break;}if(B==A.gridCellId.iOrdinal){break;}C=C.nextSibling;}return C;};mstrRaOutlineModeImpl.prototype.isOutOfScanScope=function(B,A){return A.getFirstCellIdOrdinal()<B.gridCellId.iOrdinal;};mstrRaOutlineModeImpl.prototype.updateRowSpan=function(A,C){var B=parseInt(A.getAttribute("rowspan")||"0");A.setAttribute("rowspan",B+C);};mstrRaOutlineModeImpl.prototype.resize=function(){if(this.gridBone&&this.gridBone.lockSet&&this.gridBone.lockSet.resize){this.gridBone.lockSet.resize(true);}};function RaGridCell(B){this.srcHtmlTableCell=B;var A=B.getAttribute(microstrategy.HTMLATTR_GRIDCELL_ID);this.gridCellId={sGridCellId:A,iAxis:parseInt(A.split("A")[0]),iOrdinal:parseInt(A.split("A")[1])};this.iRaElementLevel=parseInt(B.firstElementChild.getAttribute(microstrategy.HTMLATTR_RA_LEVEL));this.bExpandable=B.firstElementChild.firstElementChild.getAttribute(microstrategy.HTMLATTR_RA_EXPAND)=="1";}RaGridCell.prototype.updateExpdAndImg=function(B,C,A){this.srcHtmlTableCell.firstElementChild.firstElementChild.setAttribute(microstrategy.HTMLATTR_RA_EXPAND,A?"0":"1");this.srcHtmlTableCell.firstElementChild.firstElementChild.setAttribute("src",A?C:B);};RaGridCell.prototype.hideCollapseExpandIcon=function(){this.srcHtmlTableCell.getElementsByTagName("span")[0].style.visibility="hidden";};function RaGridRow(A){this.srcHtmlTableRow=A;}RaGridRow.prototype.getFirstCellIdOrdinal=function(){var A=this.srcHtmlTableRow.getElementsByTagName("td")[0].getAttribute(microstrategy.HTMLATTR_GRIDCELL_ID);return parseInt(A.split("A")[1]);};RaGridRow.prototype.getFirstCellRaLvl=function(){return parseInt(this.srcHtmlTableRow.getElementsByTagName("span")[0].getAttribute(microstrategy.HTMLATTR_RA_LEVEL));};RaGridRow.prototype.updateCollapseTime=function(A){var B=parseInt(this.srcHtmlTableRow.getAttribute(microstrategy.HTMLATTR_RA_COLLAPSE_TIME)||"0");this.srcHtmlTableRow.setAttribute(microstrategy.HTMLATTR_RA_COLLAPSE_TIME,B+(A?1:-1));};RaGridRow.prototype.isHidden=function(){return(this.srcHtmlTableRow.style.display=="none");};RaGridRow.prototype.isCollapseTimeCleared=function(){var A=parseInt(this.srcHtmlTableRow.getAttribute(microstrategy.HTMLATTR_RA_COLLAPSE_TIME)||"0");return A<=0;};RaGridRow.prototype.updateDisplayStatus=function(A){this.srcHtmlTableRow.style.display=(A?"":"none");};RaGridRow.prototype.findCellsWithTargetIdOrdinal=function(A){return microstrategy.findChildrenWithAtt(this.srcHtmlTableRow,"td","i",1+"A"+A);};mstrObjectPropsImpl.prototype=new Object();mstrObjectPropsImpl.prototype.parentBone=null;mstrObjectPropsImpl.prototype.defaultFormats=null;mstrObjectPropsImpl.DEFAULT_COPYABLE_ON_SINGLE_CLICK=1;mstrObjectPropsImpl.DEFAULT_COPYABLE_ALWAYS=0;mstrObjectPropsImpl.DEFAULT_COPYABLE_NOT="false";mstrObjectPropsImpl.prototype.onredo=function(B){try{this.pasteFormat(B.elem,B.cachedArray,false);this.parentBone.doc.selections.syncUp();}catch(A){microstrategy.errors.log(A);}return false;};mstrObjectPropsImpl.prototype.onundo=function(D){try{var E=D.cachedArray;var B=false;var J;for(var A in E){var G=microstrategy.styleObj.getCssText(E[A]);var H=document.getElementsByName(A);if(E[A].getAttribute("gradientcolor")!=null){J=(E[A].getAttribute("gradientcolor"))?E[A].getAttribute("gradientcolor").split(","):null;B=(J!=null);}for(var F=0;F<H.length;F++){H[F].style.cssText+=("; "+G);if(B){H[F].setAttribute("gradientcolor",E[A].getAttribute("gradientcolor"));gradientUtil.applyGradient(H[F],J[gradientUtil.GRADIENT_START_COLOR_INDEX],J[gradientUtil.GRADIENT_END_COLOR_INDEX],J[gradientUtil.GRADIENT_ANGLE_INDEX],J[gradientUtil.GRADIENT_XOFFSET_INDEX],J[gradientUtil.GRADIENT_YOFFSET_INDEX]);}else{if(H[F].getAttribute("gradientcolor")){H[F].removeAttribute("gradientcolor");}if(bIsDXIE){var I=microstrategy.styleObj.getFilter(H[F],"Gradient");if(I!=null){I.enabled=false;}}}}}this.parentBone.doc.selections.syncUp();}catch(C){microstrategy.errors.log(C);}return false;};mstrObjectPropsImpl.prototype.applyCtrlDft=function(K,A){try{var B,N=false;var E=microstrategy.getFormatObject();if(A){var G={orgObjs:{}};var L="";for(B in K){G.orgObjs[B]=K[B].cloneNode(true);L+=B+mstrUpdateManager.ITEM_SEPARATOR;}}var D=null;for(B in K){var I=document.getElementsByName(B);var O=K[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)||K[B].getAttribute(microstrategy.HTMLATTR_OBJTYPE);for(var H=0;H<I.length;H++){this.initObjectFormat(I[H],false);if(O==microstrategy.SUBOBJTYPE_DOC_LINE){this.parentBone.doc.fixLineItem(I[H],microstrategy.SUBOBJTYPE_DOC_LINE);}}var C=mstrStaticDoc.getBone(K[B]);if(C&&C.onApplyDefaultFormat){C.onApplyDefaultFormat();}if(K[B].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){D=(I.length&&I.length>0)?I[0]:K[B];}if(O==microstrategy.SUBOBJTYPE_DOC_SHAPE&&K[B].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){if(C){C.synchronizeFormat();}}if(O==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){N=true;}}if(D!=null){var M=microstrategy.findBone(D);if(M!=null){M.resizeRuler(getObjHeight(D));}}if(A){var J=this.parentBone.updateManager;if(L.indexOf(mstrUpdateManager.ITEM_SEPARATOR)!=-1){J.add([J.createActionObject(K,mstrUpdateManager.APPLY_CONTROL_DEFAULT,this.parentBone.beanPath,["2048018","2048076"],[mstrUpdateManager.UPDATE_LATER,L],[],G)]);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&N){J.flushAndSubmitChanges();}}}return true;}catch(F){microstrategy.errors.log(F);return false;}};mstrObjectPropsImpl.prototype.pasteFormat=function(J,Y,q){try{var y=J.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);var K=this.defaultFormats[y];var P;var m;var U=(y==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL?microstrategy.FORMAT_TYPE_CONTROL_TITLE:microstrategy.FORMAT_TYPE_TITLE);var W=[microstrategy.FORMAT_TYPE_MAIN,U];var m;var Q=null;var a=null;var N=function(AC,AA){var AD=mstrStaticDoc.getBone(AC),AB=null;if(AD){if(AA==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&AD.isTitleVisible){AB=AD.titleBar;}else{if(AA==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&AD.isTitleVisible){AB=AD.titleBars[0];}else{if(AA==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&AD.titleBarObj){AB=AD.titleBarObj;}}}}return AB;};if(!K){return true;}var S;for(S=0;S<W.length;S++){m=W[S];P=K[m];if(!P){continue;}if(m!=microstrategy.FORMAT_TYPE_MAIN){var D=N(J,y);if(!D){continue;}}var Z;var O=microstrategy.getFormatObject();var e=new Object();if(q){var X=new Object();for(Z in Y){X[Z]=Y[Z].cloneNode(true);}}for(Z in Y){var g=Y[Z].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);var E=(m==microstrategy.FORMAT_TYPE_MAIN?microstrategy.FORMAT_TYPE_MAIN:(g==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL?microstrategy.FORMAT_TYPE_CONTROL_TITLE:microstrategy.FORMAT_TYPE_TITLE));var A=this.defaultFormats[g][E];var I=document.getElementsByName(Z);if(!A){continue;}for(var H in P){var z=P[H];var B=A[H];if(!B){continue;}var L=O[H];for(var M in z){var F=z[M];if(!F.isCopyable){continue;}var C=B[M];if(!C){continue;}var G;if(H=="FormattingBorder"&&M.indexOf("Style")!=-1){G="border"+M.substr(0,M.indexOf("Style"));}else{G=L[M][mstrFormatObject.HTML_PROP_NAME];}e[Z]=Z;var R=false;var o;if(G=="backgroundColor"){a=J;if(m!=microstrategy.FORMAT_TYPE_MAIN){a=N(J,y);}else{if(y==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){Q=microstrategy.findBone(J);if(Q){a=Q.getCurrentPanel().elem;}}}if(a&&a.getAttribute("gradientcolor")!=null){o=(a.getAttribute("gradientcolor"))?a.getAttribute("gradientcolor").split(","):null;R=(o!=null);}else{R=false;}}for(var n=0;n<I.length;n++){var T=I[n];if(m!=microstrategy.FORMAT_TYPE_MAIN){var D=N(T,g);if(!D){continue;}}if(g==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&H=="FormattingPatterns"&&m==microstrategy.FORMAT_TYPE_MAIN){Q=microstrategy.findBone(I[n]);if(Q){T=Q.getCurrentPanel().elem;}}if(g==microstrategy.SUBOBJTYPE_DOC_SHAPE&&H=="FormattingLine"&&M=="LineColor"){var c=microstrategy.styleObj.getValue(J,G);this.parentBone.doc.formatLineSetting([T],"lineColor",c,false,[]);}else{microstrategy.styleObj.setValue(T,G,microstrategy.styleObj.getValue(J,G,m),E);}if(G=="backgroundColor"){if(m!=microstrategy.FORMAT_TYPE_MAIN){T=N(T,g);if(!T){continue;}}if(R){T.setAttribute("gradientcolor",a.getAttribute("gradientcolor"));gradientUtil.applyGradient(T,o[gradientUtil.GRADIENT_START_COLOR_INDEX],o[gradientUtil.GRADIENT_END_COLOR_INDEX],o[gradientUtil.GRADIENT_ANGLE_INDEX],o[gradientUtil.GRADIENT_XOFFSET_INDEX],o[gradientUtil.GRADIENT_YOFFSET_INDEX]);}else{if(T.getAttribute("gradientcolor")){T.removeAttribute("gradientcolor");}if(bIsDXIE){var h=microstrategy.styleObj.getFilter(T,"Gradient");if(h!=null){h.enabled=false;}}}}}}}if(y==g){this.pasteItemFormats(J,Y[Z]);}if(g==microstrategy.SUBOBJTYPE_DOC_SHAPE){for(var n=0;n<I.length;n++){if(I[n].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var x=microstrategy.findBone(I[n]);if(x){x.synchronizeFormat();}}}}}}if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}if(q){e=mstr.utils.Arrays.fromHashValues(e);if(e.length>0){var V=this.parentBone.updateManager;V.add([V.createActionObject(J,mstrUpdateManager.PASTE_FORMATTING,this.parentBone.beanPath,["2048018","2048066"],[mstrUpdateManager.UPDATE_LATER,e.toString()],[],X)]);}}return true;}catch(u){microstrategy.errors.log(u);}return false;};mstrObjectPropsImpl.prototype.pasteItemFormats=function(G,D){try{var F=mstrStaticDoc.getBone(G);if((!F)||(!F.getItemFormats)){return false;}var H=F.getItemFormats();if(!H){return false;}var E=mstrStaticDoc.getBone(D);for(var B in H){for(var A in H[B]){E.setFormatValue(B,H[B][A]);}}}catch(C){microstrategy.errors.log(C);}return false;};mstrObjectPropsImpl.prototype.initObjectFormat=function(M,a,A,q){try{var e=M.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)||M.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var AF=(A!=null)?A:e;var Q=this.defaultFormats[AF];if(!Q){return M;}if(!q){q=microstrategy.FORMAT_TYPE_MAIN;}var AE=Q[q];if(!AE){return M;}var U=microstrategy.getFormatObject();this.clearAllFormat(M);var N=false;var AA=new Array();var T=new Array();var O=0;var Y=false;var Z=false;var E=false;var X=null;var L=null;var J=null;var B=null;var c=null;var G=null;var F=null;var u=null;var V;for(var I in AE){if(AF==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&q==microstrategy.FORMAT_TYPE_MAIN){if(e==AF){if(I=="FormattingPatterns"){continue;}}else{if(I!="FormattingPatterns"){continue;}}}var P=AE[I];var R=U[I];for(var S in P){var K=P[S];if((!a)&&(!K.isCopyable)){continue;}var h=K.defaultValue;if((!h&&h!=0)||String(h).length==0){continue;}var C=R[S];if(!C){continue;}var o=C[mstrFormatObject.HTML_PROP_NAME];var H=U.decodeValue(o,h);if(H==null){continue;}if(I=="FormattingPatterns"&&S=="SelectorSelectionColor"){microstrategy.styleObj.setAttValue(M,U.getAttrNameFromStyle(o),H);continue;}if(I=="FormattingPatterns"&&S=="FillColor"){if(P.FillStyle.defaultValue=="1"){H="transparent";M.style.backgroundColor=H;}else{if(P.FillStyle.defaultValue=="2"){Y=true;J=H.slice(1);B=U.decodeValue("gradientColor",P.GradientColor.defaultValue).slice(1);c=P.GradientAngle.defaultValue;G=P.GradientXOffset.defaultValue;F=P.GradientYOffset.defaultValue;H="transparent";}}}if(S=="HighlightColor"){if(I=="FormattingPatterns"||I=="FormattingFont"){microstrategy.styleObj.setAttValue(M,U.getAttrNameFromStyle(o),h);}}if(I=="FormattingAppearance"){if(S=="DropShadowEffect"&&parseInt(H)!=0){Z=true;X=P.DropShadowDepth.defaultValue;}else{if(S=="AlphaEffect"&&parseInt(H)!=0){E=true;L=P.AlphaOpacity.defaultValue;}}}if(I=="FormattingAlignment"){if(S=="TextDirection"&&parseInt(H)!=0&&bIsW3C){u=true;V=H;}}if(I=="FormattingSize"&&(S=="Height"||S=="Width")&&AF!=microstrategy.SUBOBJTYPE_DOC_LINE&&!(AF==microstrategy.SUBOBJTYPE_DOC_SHAPE&&microstrategy.styleObj.getAttValue(M,microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){var AC=microstrategy.styleObj.adjustSizes(o,H,AE);M.style[o]=AC+"px";microstrategy.styleObj.setAttValue(M,U.getAttrNameFromStyle(o),h);}else{if(C[mstrFormatObject.ATTR_NAME]&&C[mstrFormatObject.ATTR_NAME].length>0){if(C[mstrFormatObject.TARGET]&&(parseInt(C[mstrFormatObject.TARGET])&(parseInt(mstrFormatObject.TARGET_VALUE_STYLE)+parseInt(mstrFormatObject.TARGET_VALUE_ATTR)))>0){M.setAttribute(C[mstrFormatObject.ATTR_NAME],h);if(I=="FormattingBorder"&&S.indexOf("Style")!=-1&&S.indexOf("3D")==-1){o=o.substr(0,o.length-"Style".length);M.style[o]=H+" "+microstrategy.styleObj.getValue(M,o+"Color");}else{if(I=="FormattingLine"&&S.indexOf("Line")!=-1){if(S.indexOf("Weight")!=-1){S="LineWidth";}var D=S.substr("Line".length,S.length-1);var AD=null;if(microstrategy.subObjectType(M)==microstrategy.SUBOBJTYPE_DOC_LINE){AD=new Array("borderTop","borderLeft");}else{if(microstrategy.subObjectType(M)==microstrategy.SUBOBJTYPE_DOC_SHAPE){AD=new Array("borderTop","borderLeft","borderRight","borderBottom");}}for(var z=0;AD&&z<AD.length;z++){microstrategy.styleObj.setValue(M,AD[z]+D,H);}}else{if(I=="FormattingBorder"){microstrategy.styleObj.setValue(M,o,H);if(S=="Border3DStyle"&&h!=0){N=true;}else{if(S=="Border3DWeight"){O=h;}else{if(S.indexOf("Border3D")>-1){AA.push(o.substr(0,o.length-1));T.push(H);}}}}else{if(I=="FormattingAppearance"&&S.indexOf("DropShadow")!=-1){microstrategy.styleObj.setValue(M,o,H);}M.style[o]=H;}}}}else{microstrategy.styleObj.setValue(M,o,H);}}else{microstrategy.styleObj.setValue(M,o,H);}}}}if(N){M.style.borderWidth=O+"pt";M.style.borderStyle="solid";for(var g=0;g<T.length;g++){M.style[AA[g]]=T[g];}}if(Y){if((M.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&M.getAttribute("scriptclass")!="mstrPanel")||(M.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SHAPE&&M.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){var W=(M.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION)?this.parentBone&&this.parentBone.getChildBone(M):microstrategy.bone(M.id);if(W){if(e==microstrategy.OBJTYPE_DOC_SUBSECTION){W.setSibsWithGradients([M]);var y=new Array();y[gradientUtil.GRADIENT_START_COLOR_INDEX]=J;y[gradientUtil.GRADIENT_END_COLOR_INDEX]=B;y[gradientUtil.GRADIENT_ANGLE_INDEX]=c;y[gradientUtil.GRADIENT_TRANSITION_TYPE_INDEX]=14;y[gradientUtil.GRADIENT_XOFFSET_INDEX]=G;y[gradientUtil.GRADIENT_YOFFSET_INDEX]=F;W.setGradientInfo([M],y);}W.applyGradient();}}else{M.style.backgroundColor="transparent";M.setAttribute("gradientcolor",J+","+B+",14,"+c+","+G+","+F);M.setAttribute("bgstyle","2");gradientUtil.applyGradient(M,J,B,c,G,F,microstrategy.styleObj);}}else{var n=(M.style.backgroundColor=="transparent")?1:0;M.setAttribute("bgstyle",n);if(M.getAttribute("gradientcolor")){M.removeAttribute("gradientcolor");}if(bIsDXIE){var m=this.parentBone.doc.styleObj.getFilter(M,"Gradient");if(m!=null){m.enabled=false;}}}if(Z){M.setAttribute("dropShadowDepth",X);M.setAttribute("dropShadowEffect","1");microstrategy.styleObj.applyShadow(M,"dropShadowEffect","1");}if(E){M.setAttribute("alphaOpacity",L);M.setAttribute("alphaEffect","1");microstrategy.styleObj.applyAlpha(M,"alphaEffect","1");}if(u){this.parentBone.doc.styleObj.applyTextDirection(M,null,V);}if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}}catch(AB){microstrategy.errors.log(AB);}return M;};mstrObjectPropsImpl.prototype.createFormatObject=function(D,H){try{var L=new Object();var P=this.defaultFormats[D];if(!P){return L;}var K=P[H];if(!K){return L;}var E=microstrategy.getFormatObject();for(var I in K){var N=K[I];var J=E[I];for(var F in N){var B=N[F];var M=B.defaultValue;if((!M)||String(M).length==0){continue;}var O=J[F];if(!O){continue;}var A=O[mstrFormatObject.HTML_PROP_NAME];var C=E.decodeValue(A,M);if(C==null){continue;}if(I=="FormattingPatterns"){if(F=="FillStyle"){continue;}if(F=="FillColor"){if(N.FillStyle.defaultValue=="1"){C="transparent";}}}L[A]=C;}}if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}}catch(G){microstrategy.errors.log(G);}return L;};mstrObjectPropsImpl.prototype.cloneFormats=function(E){try{var D=null;if(E){D=new Object();for(var B in E){D[B]=new Object();for(var A in E[B]){D[B][A]=E[B][A];}}}return D;}catch(C){microstrategy.errors.log(C);}return res;};mstrObjectPropsImpl.prototype.setDefaultFormat=function(N){var T=microstrategy.formatType;try{var K=microstrategy.getFormatObject();var G=N.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)||N.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var J=this.defaultFormats[G];if(!J){return true;}for(var S in J){var B=J[S];microstrategy.formatType=S;var A=null;var V=null;if((G==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||G==microstrategy.SUBOBJTYPE_DOC_TEMPLATE)&&S==mstrPanelStack.FMT_TYPE_TITLE){V=microstrategy.styleObj.getValue(N,"gradientcolor",S);}else{V=N.getAttribute("gradientcolor");}if(V&&V.length>0){A=V.split(",");}for(var L in B){if(G==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&S==microstrategy.FORMAT_TYPE_MAIN){if(L=="FormattingPatterns"){continue;}}var O=B[L];var E=K[L];for(var F in O){var D=O[F];var H=E[F];if(D.isDefaultCopyable==mstrObjectPropsImpl.DEFAULT_COPYABLE_NOT||!H){continue;}var P=H[mstrFormatObject.HTML_PROP_NAME];var U=H[mstrFormatObject.ATTR_NAME];if(L=="FormattingPatterns"&&A!=null){if(F=="FillStyle"){D.defaultValue=2;}else{switch(F){case"FillColor":D.defaultValue=K.encodeValue(P,"#"+A[gradientUtil.GRADIENT_START_COLOR_INDEX]);break;case"GradientColor":D.defaultValue=K.encodeValue("backgroundColor","#"+A[gradientUtil.GRADIENT_END_COLOR_INDEX]);break;case"GradientAngle":D.defaultValue=A[gradientUtil.GRADIENT_ANGLE_INDEX];break;case"GradientXOffset":D.defaultValue=A[gradientUtil.GRADIENT_XOFFSET_INDEX];break;case"GradientYOffset":D.defaultValue=A[gradientUtil.GRADIENT_YOFFSET_INDEX];break;default:break;}}}else{if(G==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&L=="FormattingSize"&&F=="Height"&&microstrategy.styleObj.getAttValue(N,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE&&microstrategy.styleObj.getAttValue(N,microstrategy.HTMLATTR_WINDOW_STATE)!=microstrategy.WINDOW_STATE_NORMAL){D.defaultValue=microstrategy.styleObj.getAttValue(N,microstrategy.HTMLATTR_OLD_HEIGHT,S);}else{if(U&&U.length>0){if(U==microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR){D.defaultValue=K.encodeValue(P,microstrategy.styleObj.getAttValue(N,U,S));}else{D.defaultValue=microstrategy.styleObj.getAttValue(N,U,S);}}else{var Q=microstrategy.styleObj.getValue(N,P,S);if(L=="FormattingBorder"&&F.indexOf("Style")!=-1){var R=P.substr(0,P.length-"Style".length);D.defaultValue=K.encodeValue(P,microstrategy.styleObj.getValue(N,R+"Width")+" "+Q);}else{D.defaultValue=K.encodeValue(P,Q);}}}}}}}var C=mstrStaticDoc.getBone(N);if(C&&C.onSetDefaultFormat){C.onSetDefaultFormat();}var M=this.parentBone.updateManager;M.add([M.createActionObject(N,mstrUpdateManager.SET_CTRL_DEFAULT,this.parentBone.beanPath,["2048018","2048012"],[mstrUpdateManager.UPDATE_LATER,N.getAttribute("id")],[],null)],true);}catch(I){microstrategy.errors.log(I);}finally{microstrategy.formatType=T;}return false;};mstrObjectPropsImpl.prototype.clearAllFormat=function(C){try{if(C){var A=C.style;if(A&&A.textDecoration){A.textDecoration="none";}if(microstrategy.styleObj.objSheet&&microstrategy.styleObj.objSheet.styleRules&&microstrategy.styleObj.objSheet.styleRules[microstrategy.styleObj.getId(C)]){A=microstrategy.styleObj.objSheet.styleRules[microstrategy.styleObj.getId(C)].style;}if(A&&A.textDecoration){A.textDecoration="none";}}}catch(B){microstrategy.errors.log(B);}return false;};mstrObjectPropsImpl.prototype.isCtrlDftObj=function(C){try{if(C){var A=C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(A==microstrategy.SUBOBJTYPE_DOC_TEXT||A==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||A==microstrategy.SUBOBJTYPE_DOC_IMAGE||A==microstrategy.SUBOBJTYPE_DOC_LINE||A==microstrategy.SUBOBJTYPE_DOC_SHAPE||A==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||A==microstrategy.SUBOBJTYPE_DOC_SUBSECTION||A==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||A==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||A==microstrategy.SUBOBJTYPE_DOC_PANEL){return true;}}return false;}catch(B){microstrategy.errors.log(B);}return false;};function mstrObjectPropsImpl(A){this.parentBone=A;this.defaultFormats=this.parentBone.defaultFormats;return this;}mstrDragnDropObjImpl.prototype=new Object();mstrDragnDropObjImpl.prototype.updateManager=microstrategy.updateManager;mstrDragnDropObjImpl.prototype.path="";mstrDragnDropObjImpl.prototype.verifiedPath="";mstrDragnDropObjImpl.prototype.parentBone=null;mstrDragnDropObjImpl.prototype.onResizeDown=function(B){try{if(!B){B=window.event;}if(B.e){B=B.e;}getMouse(B);this.resizeX=lMouseX;this.resizeY=lMouseY;this.resizeHandler=getEventTarget(B);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","onResizeStart");this.parentBone.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".onResizeStart(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDragnDropObjImpl.prototype.onResizeStart=function(B){try{if(!B){B=window.event;}if(B.e){B=B.e;}this.minSize=(this.target)?this.target.getRightMostPos():70;this.target.elem.appendChild(this.data);this.data.style.left=getObjLeft(this.elem)+"px";if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","onResize");this.parentBone.attachWinListener(this,"mouseup","onResizeEnd");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".onResize(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onResizeEnd(e); }");}this.onResize(B);return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDragnDropObjImpl.prototype.onResize=function(D){try{if(!D){D=window.event;}if(D.e){D=D.e;}getMouse(D);if(this.elem==null){return false;}var A=lMouseX-this.resizeX;var B=getObjLeft(this.elem)+A;B=Math.min(Math.max(B,this.minSize),this.maxSize);if(B>this.minSize&&B<this.maxSize){this.elem.style.left=getObjLeft(this.elem)+A+"px";this.data.style.left=getObjLeft(this.elem)+"px";this.resizeX=lMouseX;}return false;}catch(C){microstrategy.errors.log(C);return false;}};mstrDragnDropObjImpl.prototype.onResizeEnd=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}eval(this.onResizeEndEvent);this.elem.style.visibility="visible";this.onmouseup(e);return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrDragnDropObjImpl.prototype.onmouseup=function(B){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener(this,"mousemove");this.parentBone.detachWinListener(this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}return false;}catch(A){microstrategy.errors.log(A);return false;}};function mstrDragnDropObjImpl(G,F,A,D,B,C){var E=mstrFormatObject;this.id=G;this.elem=document.getElementById(G);this.path=F;this.parentBone=C;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.onResizeEndEvent=A;this.target=D;this.data=B;this.maxSize=parseInt(E.decodeValue("width",D.MAX_WIDTH));this.elem.onmousedown=new Function("e",this.verifiedPath+" { return "+this.path+".onResizeDown(e); }");}mstrPortalImplScript=true;mstrPortalImpl.prototype=new mstrBoneImpl();mstrPortalImpl.prototype.path=null;mstrPortalImpl.prototype.onload=function(){try{this.initBone();this.path="microstrategy.bone('"+this.id+"')";this.viewer=microstrategy.bone("rwb_viewer");var B=microstrategy.findAncestor(this.elem);this.targetObjID=microstrategy.styleObj.getAttValue(B,microstrategy.HTMLATTR_ID);this.attachEvents();var G=microstrategy.findChildrenWithAtt(this.elem,"img",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_WINDOW_BUTTON);if(G!=null&&(G.length>0)){var H=getObjHeight(this.elem);if(H==0){if(this.elem.currentStyle&&"auto"!=this.elem.currentStyle.height){H=parseInt(this.elem.currentStyle.height);}else{var E=document.defaultView&&document.defaultView.getComputedStyle;var D=NaN;if(E){var C=E(this.elem,"");if(C){D=parseInt(C.getPropertyValue("height"));}}if(!isNaN(D)){H=D;}}}for(var A=0;A<G.length;A++){if(G[A].id=="maximize"){this.btnMax=G[A];}else{if(G[A].id=="minimize"){this.btnMin=G[A];}else{if(G[A].id=="restore"){this.btnRestore=G[A];}else{if(G[A].id=="delete"){this.btnDelete=G[A];}}}}G[A].style.height=Math.min(Math.max(H-4,1),15)+"px";G[A].style.width=Math.min(Math.max(H-3,1),15)+"px";}G[0].parentNode.parentNode.style.width=G.length*Math.min(Math.max(H-4,1),15)+"px";}this.togglePulldowns();}catch(F){microstrategy.errors.log(F);return false;}};mstrPortalImpl.prototype.onreload=function(){try{mstrBoneImpl.prototype.onreload.call(this);this.togglePulldowns();}catch(A){microstrategy.errors.log(A);return false;}};mstrPortalImpl.prototype.togglePulldowns=function(){try{if(!this.elem||!this.elem.parentNode){return ;}if(this.btnMax&&this.btnMax.style.display=="none"){togglePulldowns(this.elem.parentNode,false);}else{togglePulldowns(this.elem.parentNode,true);}}catch(A){microstrategy.errors.log(A);return false;}};mstrPortalImpl.prototype.attachEvents=function(){try{this.elem=document.getElementById(this.id);this.elem.onmousedown=new Function("e","if ("+this.path+" != null) { return "+this.path+".onmousedown(e); }");this.elem.onclick=new Function("e","if ("+this.path+" != null) { return "+this.path+".onbtnclick(e); }");}catch(A){microstrategy.errors.log(A);}return false;};mstrPortalImpl.prototype.onmousedown=function(C){try{microstrategy.hidePopups();if(!C){C=window.event;}var A=getEventTarget(C);if(A==null||(A.tagName.toLowerCase()=="img"&&A.id.substr(0,A.id.indexOf("_"))!="localDataMenu")){if(typeof (C.cancelBubble)!="undefined"){this.onbtnclick(C);C.cancelBubble=true;}return false;}}catch(B){microstrategy.errors.log(B);}return false;};mstrPortalImpl.prototype.onmouseup=function(B){try{}catch(A){microstrategy.errors.log(A);}return false;};mstrPortalImpl.prototype.onbtnclick=function(G){try{if(!G){G=window.event;}var C=getEventTarget(G);if(C.tagName.toLowerCase()!="img"||this.viewer==null){return ;}var B=this.viewer&&this.viewer.doc&&this.viewer.doc.selections;var A=microstrategy.findAncestor(C);if(B&&A){B.addToSelection(G.ctrlKey,A);}this.viewer.commands.exec("resetObjectFormatLevel");switch(C.getAttribute("id")){case"minimize":this.viewer.commands.exec("minimizePortal",this.targetObjID);break;case"restore":this.viewer.commands.exec("restorePortal",this.targetObjID);break;case"maximize":this.viewer.commands.exec("maximizePortal",this.targetObjID);break;case"delete":showMessage({contents:microstrategy.descriptors.getDescriptor("637"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').deleteWindow();",type:mstrMsgBoxImpl.MSG_WARNING});break;case"collapse":this.viewer.commands.exec("collapsePortal",this.targetObjID);break;case"expand":this.viewer.commands.exec("expandPortal",this.targetObjID);break;}var E=C.id.substr(0,C.id.indexOf("_"));if(E=="localDataMenu"){if((G.which==3)||(G.button==2)){C.setAttribute("cx","");return false;}var H=C.id.replace("localDataMenu_","");var F=H.indexOf("Ctl_");if(F>-1){H=H.substring(0,F+3);}var I=microstrategy.bones[H];if(I){I["show"+(I.isGridBone||I.isGraph?"Grid":"Control")+"Options"](G);}}}catch(D){microstrategy.errors.log(D);}};mstrPortalImpl.prototype.deleteWindow=function(){microstrategy.eventManager.notifyOrphanBones("portalWindowResize","delete",this.targetObjID);this.viewer.commands.exec("deleteFromPortal",this.targetObjID);};mstrPortalImpl.prototype.portalWindowResize=function(B,A){try{if(this.targetObjID==A){switch(B){case"minimize":this.hideButton(this.btnMin);this.showButton(this.btnRestore);this.showButton(this.btnMax);togglePulldowns(this.elem.parentNode,true);break;case"restore":this.hideButton(this.btnRestore);this.showButton(this.btnMin);this.showButton(this.btnMax);this.elem.nextSibling.style.display="";togglePulldowns(this.elem.parentNode,true);break;case"maximize":this.hideButton(this.btnMax);this.showButton(this.btnMin);this.showButton(this.btnRestore);this.elem.nextSibling.style.display="";togglePulldowns(this.elem.parentNode,false);break;}}}catch(C){microstrategy.errors.log(C);}};mstrPortalImpl.prototype.showButton=function(A){try{if(A){A.style.display="";}}catch(B){microstrategy.errors.log(B);}return false;};mstrPortalImpl.prototype.hideButton=function(A){try{if(A){A.style.display="none";}}catch(B){microstrategy.errors.log(B);}return false;};mstrPortalImpl.prototype.ongriddatasourcechange=function(){try{var E=microstrategy.findAncestor(this.elem),A=microstrategy.findChildWithAtt(E,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_GRID_TABLE),B=microstrategy.findBone(A);if(B&&microstrategy.isEnabledForItem(E,"windowTitle")){var I=this.viewer.doc.styleObj.getAttValue(E,microstrategy.HTMLATTR_WINDOW_TITLE);if(I==null||I.length==0){var F=this.viewer.documentDataSets,D=B.gridStructureInfo?B.gridStructureInfo.dataSetId:B.dSetId,H=F[D],G=microstrategy.findChildWithAtt(E,"div","id","titleBar");G.innerText=H;}}}catch(C){microstrategy.errors.log(C);}return false;};function mstrPortalImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrPathImplScript=true;mstrPathImpl.prototype=new mstrBoneImpl();mstrPathImpl.prototype.commands=null;mstrPathImpl.prototype.openHistoryPageEvent="";mstrPathImpl.prototype.openHistoryPageEventID="";mstrPathImpl.prototype.openHistoryPageEventArgumentID="";mstrPathImpl.prototype.openHistoryPageEventArgumentName="";mstrPathImpl.prototype.pathSize=0;mstrPathImpl.PINNED_CLASS="pinned";mstrPathImpl.PADDING=23;mstrPathImpl.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.updateAccountButton();this.commands=new mstrPathCommandsImpl(this);this.onwinresize();}catch(A){microstrategy.errors.log(A);}};mstrPathImpl.prototype.updateAccountButton=function(){var D=document.getElementById("mstrPathAccount"),B=microstrategy.servletName,A;if(D){if(microstrategy.hasSession&&!mstrApp.isAdminPage&&D.getAttribute("_isstatic")!="true"){D.href="#";var C=microstrategy.menuHover?"mouseover":"click";D["on"+C]=microstrategy.showAccountSCList;}}};mstrPathImpl.prototype.onwinresize=function(){try{if(window.mstrInterfacePlugin){if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){return ;}var A=this.id;this.pathBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_path");this.footerBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_footer");if(!this.pathBar&&!this.footerBar){return ;}if(mstr.utils.ISIE8&&this.pathBar){this.pathBar.className=this.pathBar.className.replace(/ ie8/,"")+" ie8";}this.pathText=this.findChildByCssClass(this.elem,"mstrPathText");if(this.pathText){if(!this.pathBar){this.pathText.onclick=function(D){microstrategy.bone(A).pinPath(D);};}this.pathAncestor=this.findChildByCssClass(this.pathText,"mstrPathTextAncestors");this.pathCurrent=this.findChildByCssClass(this.pathText,"mstrPathTextCurrent");this.pathAncestors=this.findChildByCssClass(this.pathText,"mstrPathAncestors");this.pathBreadCrumbs=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbs");this.pathBreadCrumbsParent=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsParent","span");this.pathBreadCrumbsAncestors=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");}this.closeIcon=this.findChildByCssClass(this.footerBar,"mstrFooterPathClose","div");if(this.closeIcon){this.closeIcon.onclick=function(D){microstrategy.bone(A).toggleFooterPath(D);};}var C=this;if(this.pathBar&&this.pathText&&this.pathAncestors&&this.pathBreadCrumbs){this.neededWidth=C.getNeededWidth(),this.availableWidth=C.getAvailWidth();if(this.neededWidth<this.availableWidth){C.hideBreadCrumbs();}else{C.showBreadCrumbs();}}else{window.setTimeout(function(){C.resizePathBar();},10);}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getNeededWidth=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,B=this.pathAncestor,C=this.pathCurrent;if(A&&E&&B&&C){A.className=A.className.replace(" hidden","");if(!this.hasClass(E,"hidden")){E.className=E.className+" hidden";}return B.scrollWidth+C.scrollWidth+40;}else{return 0;}}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.hideBreadCrumbs=function(){try{var A=this.pathAncestors,D=this.pathBreadCrumbs,B=this.pathBreadCrumbsAncestors;A.className=A.className.replace(" hidden","");if(!this.hasClass(D,"hidden")){D.className=D.className+" hidden";}if(!this.hasClass(B,"hidden")){B.className=B.className+" hidden";}if(A&&D){this.resizePathBar();}}catch(C){microstrategy.errors.log(C);}};mstrPathImpl.prototype.showBreadCrumbs=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,C=this.pathBreadCrumbsAncestors;if(!this.hasClass(A,"hidden")){A.className=A.className+" hidden";}E.className=E.className.replace(" hidden","");if(!this.hasClass(C,"hidden")){C.className=C.className+" hidden";}this.resizeBreadCrumbs();C.style.left=mstr.$BM.position(E,true).left+"px";var B=this.id;E.onclick=function(F){microstrategy.bone(B).toggleBreadCrumbsSelector(F);};}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.toggleBreadCrumbsSelector=function(){try{var A=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");if(A){if(this.hasClass(A,"hidden")){A.className=A.className.replace(" hidden","");}else{A.className=A.className+" hidden";}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getAvailWidth=function(){try{this.pathText.style.maxWidth="0px";if(mstr.utils.ISIE8){this.pathText.style.display="none";}var K=mstr.utils.BoxModel,C=document.body.clientWidth,F=this.pathBar||this.footerBar,M=microstrategy.findChildWithAtt(F,"div","id","mstrSearchSuggest"),D=microstrategy.findChildWithAtt(F,"div","id","mstrPathAccount"),E=this.findChildByCssClass(F,"mstrFooterPathClose","div"),L=M||D||E,J=Math.min(L?K.position(L).left:C,C),I=this.findChildByCssClass(F,"mstrPathIcons"),B=0;if(I){var A=K.position(I),H=A.left+A.width,B=J-H-20;}if(mstr.utils.ISIE8){this.pathText.style.display="block";}return Math.max(B,0);}catch(G){microstrategy.errors.log(G);return 0;}};mstrPathImpl.prototype.resizePathBar=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,J=this.pathAncestor,H=this.getAvailWidth();if(D){D.style.maxWidth=H+"px";}if(J){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-15;this.curWidth=Math.min(this.pathSize/2,C.offsetWidth);var G=this.pathSize-this.curWidth;var I=parseInt(mstr.utils.CSS.getStyleValue(J,"padding-right")),F=J.scrollWidth+I,B=G>F?G-F:0;G-=B;this.curWidth+=B;J.style.maxWidth=Math.max(0,G)+"px";if((bIsDXIE)&&this.pathBar){J.style.marginLeft=-G-20+"px";}if(this.pathBar){C.style.maxWidth=Math.max(0,this.pathSize-(this.isPinned(D)?G:0))+"px";}else{C.style.maxWidth=Math.max(0,this.pathSize-G)+"px";}}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.resizeBreadCrumbs=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,G=this.pathBreadCrumbsParent,F=this.pathAncestor,H=this.availableWidth;if(D){D.style.maxWidth=H+"px";G.style.maxWidth=H+"px";C.style.maxWidth=H+"px";F.style.maxWidth=H+"px";}if(G){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-50;this.curWidth=Math.min(this.pathSize/2,C.scrollWidth);var I=this.pathSize-this.curWidth;var B=I>G.scrollWidth?I-G.scrollWidth:0;I-=B;G.style.maxWidth=Math.max(0,I)+"px";C.style.maxWidth=Math.max(0,this.pathSize-I)+"px";F.style.maxWidth=Math.max(0,I+31)+"px";}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.pinPath=function(){try{var E=" "+mstrPathImpl.PINNED_CLASS,B=this.pathText,D=this.pathAncestor,H=this.pathCurrent;if(D&&B&&this.pathBar){var C=this.isPinned(B),G=this.pathSize;if(C){B.className=B.className.replace(E,"");var A=microstrategy.bones;if(A.leftToolbar){A.leftToolbar.resize();}window.setTimeout(function(){H.style.maxWidth=G+"px";},(bIsDXIE?0:300));}else{B.className+=E;H.style.maxWidth=Math.max(0,this.curWidth)+"px";}}}catch(F){microstrategy.errors.log(F);}};mstrPathImpl.prototype.findChildByCssClass=function(F,A,D){try{if(!F){return null;}if(F.getElementsByClassName){return F.getElementsByClassName(A)[0];}else{var D=D||"div",G=new RegExp("(^|\\s)"+A+"(\\s|$)","i");if(F.tagName!=null&&F.tagName.toLowerCase()==D.toLowerCase()&&G.test(F.className)){return F;}var H=F.getElementsByTagName(D),C=H&&H.length;if(C){for(var B=0;B<C;B++){if(G.test(H[B].className)){return H[B];}}}return null;}}catch(E){microstrategy.errors.log(E);return null;}};mstrPathImpl.prototype.hasClass=function(B,A){try{return(" "+B.className+" ").indexOf(" "+A+" ")>-1;}catch(C){microstrategy.errors.log(C);return null;}};mstrPathImpl.prototype.isPinned=function(A){try{return this.hasClass(A,mstrPathImpl.PINNED_CLASS);}catch(B){microstrategy.errors.log(B);return null;}};mstrPathImpl.prototype.toggleFooterPath=function(){var C=document.getElementById("mstrWeb_footer");if(C){C.style.bottom="-41px";var B=this.id;window.setTimeout(function(){C.innerHTML="";microstrategy.unRegisterBone(B);microstrategy.eventManager.ondialogresize();},500);}var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,microstrategy.servletName+"."+microstrategy.pageName,mstrUpdateManager.actions[mstrUpdateManager.SET_PREFERENCE].paramID,["showFooterPath",0])]);};function mstrPathImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrPathCommandsImpl.prototype=new Object();mstrPathCommandsImpl.prototype.item=null;mstrPathCommandsImpl.prototype.queryEnabled=function(A){try{return true;}catch(B){microstrategy.errors.log(B);}};mstrPathCommandsImpl.prototype.queryState=function(A){try{switch(A){case"openPage":return this.item;default:microstrategy.errors.log(A+" command id not implemented.");break;}}catch(B){microstrategy.errors.log(B);}return null;};mstrPathCommandsImpl.prototype.exec=function(A,F){try{switch(A){case"openPage":var C=microstrategy.updateManager;if(C){mstrUpdateManager.addEvent({OPEN_HISTORY_PAGE:{p:[this.parentBone.openHistoryPageEventArgumentID],n:[this.parentBone.openHistoryPageEventArgumentName],i:this.parentBone.openHistoryPageEventID}});C.useIframe=false;var B=new Array();B.push(C.createActionObject(this.elem,mstrUpdateManager.OPEN_HISTORY_PAGE,microstrategy.servletName+"."+microstrategy.pageName,[this.parentBone.openHistoryPageEventArgumentID],[F]));C.add(B,true);C.flushAndSubmitChanges();}else{var D=createDynamicForm(this.parentBone.openHistoryPageEvent+F);D.method="POST";D.submit();}break;default:microstrategy.errors.log(values[0]+" command id not implemented.");break;}return true;}catch(E){microstrategy.errors.log(E);}};function mstrPathCommandsImpl(A){this.parentBone=A;return this;}mstrRoundedRectangleScript=true;mstrRoundedRectangle.prototype=new mstrBoneImpl();mstrRoundedRectangle.prototype.topBlock=null;mstrRoundedRectangle.prototype.content=null;mstrRoundedRectangle.prototype.bottomBlock=null;mstrRoundedRectangle.prototype.sibs=null;mstrRoundedRectangle.prototype.backgroundColor=null;mstrRoundedRectangle.prototype.gradientColor=null;mstrRoundedRectangle.prototype.conditionalBackgroundColor=null;mstrRoundedRectangle.prototype.conditionalGradients=null;mstrRoundedRectangle.TOP_1=0;mstrRoundedRectangle.TOP_2=1;mstrRoundedRectangle.TOP_3=2;mstrRoundedRectangle.TOP_4=3;mstrRoundedRectangle.CONTENT=4;mstrRoundedRectangle.BOTTOM_1=8;mstrRoundedRectangle.BOTTOM_2=7;mstrRoundedRectangle.BOTTOM_3=6;mstrRoundedRectangle.BOTTOM_4=5;mstrRoundedRectangle.margins=[4,2,1,1];mstrRoundedRectangle.prototype.onload=function(){try{var C=function(F){var E=(F)?F.split(","):null;return(E)?{startingColor:E[gradientUtil.GRADIENT_START_COLOR_INDEX],endingColor:E[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientAngle:E[gradientUtil.GRADIENT_ANGLE_INDEX],gradientXOffset:E[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientYOffset:E[gradientUtil.GRADIENT_YOFFSET_INDEX]}:{startingColor:null,endingColor:null,gradientAngle:0,gradientXOffset:0,gradientYOffset:0};};mstrBoneImpl.prototype.onload.call(this);this.sibs=document.getElementsByName(this.id);if(this.sibs.length>0){this.conditionalGradients=[],this.conditionalBackgroundColor=[];this.gradientColor=C(this.sibs[0].getAttribute("gradientcolor"));for(var A=0;A<this.sibs.length;A++){var D=(this.sibs[A].getAttribute("bgcolor"))||null;if(D!=null&&D.indexOf(",")>0){this.conditionalGradients.push(C(D));this.conditionalBackgroundColor.push(null);}else{this.conditionalBackgroundColor.push((this.sibs[A].getAttribute("bgcolor"))?(this.sibs[A].getAttribute("bgcolor")):null);this.conditionalGradients.push(null);}}}for(var A=0;A<this.sibs.length;A++){if(mstr.utils.ISIE7){mstr.$D.clearChilds(this.sibs[A]);}else{this.sibs[A].innerHTML="";}this.createCorners(this.sibs[A],A);}}catch(B){microstrategy.errors.log(B);return false;}};mstrRoundedRectangle.prototype.initNewUnit=function(B){try{bone=microstrategy.registerBone(B.id,"mstrRWControlImplScript",{backgroundColor:this.backgroundColor});bone.onload();}catch(A){microstrategy.errors.log(A);return false;}};mstrRoundedRectangle.prototype.synchronizeSize=function(){try{for(var A=0;A<this.sibs.length;A++){this.adjustRoundedCornerHeight(this.sibs[A]);}this.applyGradient();}catch(B){microstrategy.errors.log(B);return false;}};mstrRoundedRectangle.prototype.synchronizeFormat=function(){try{var C=this.gradientColor;this.backgroundColor=null;C.startingColor=null;C.endingColor=null;for(var A=0;A<this.sibs.length;A++){this.changeFormattingToRoundedCorner(this.sibs[A],A);}}catch(B){microstrategy.errors.log(B);return false;}};mstrRoundedRectangle.prototype.createCorners=function(C,F){try{var H=document.createElement("div");this.topBlock=H;var I=microstrategy.ZOOM_FACTOR/100;for(var E=0;E<4;E++){var A=document.createElement("span");A.style.margin="0px "+Math.round(mstrRoundedRectangle.margins[E]*I)+"px";A.style.height=Math.round(1*I)+"px";A.style.display="block";A.style.overflow="hidden";A.setAttribute("minheight",(2*E)+1);H.appendChild(A);}var G=document.createElement("span");this.content=G;G.style.display="block";G.style.overflow="hidden";var B=document.createElement("div");this.bottomBlock=B;for(var E=3;E>=0;E--){var A=document.createElement("span");A.style.margin="0px "+Math.round(mstrRoundedRectangle.margins[E]*I)+"px";A.style.height=Math.round(1*I)+"px";A.style.display="block";A.style.overflow="hidden";A.setAttribute("minheight",(2*E)+2);B.appendChild(A);}C.appendChild(H);C.appendChild(G);C.appendChild(B);C.setAttribute(microstrategy.HTMLATTR_STYLE,microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);this.adjustRoundedCornerHeight(C);this.changeFormattingToRoundedCorner(C,F);}catch(D){microstrategy.errors.log(D);return false;}};mstrRoundedRectangle.prototype.changeFormattingToRoundedCorner=function(C,A){try{if(this.conditionalGradients[A]!=null){this.setRoundedCornerGradientColor(C,this.conditionalGradients[A]);}else{if(this.gradientColor.startingColor!=null&&this.gradientColor.endingColor!=null&&this.conditionalBackgroundColor[A]==null){this.setRoundedCornerGradientColor(C,this.gradientColor);}else{this.backgroundColor=microstrategy.styleObj.getValue(C,"backgroundColor");if(this.conditionalBackgroundColor[A]!=null&&this.conditionalBackgroundColor[A].length>0){this.setRoundedCornerBackgroundColor(C,this.conditionalBackgroundColor[A]);}else{if(this.backgroundColor!=null&&this.backgroundColor.length>0){this.setRoundedCornerBackgroundColor(C,this.backgroundColor);}}}}C.style.backgroundColor="transparent";C.style.border="none";}catch(B){microstrategy.errors.log(B);return false;}};mstrRoundedRectangle.prototype.applyGradient=function(){try{var C=this.gradientColor;if(!C||!C.startingColor||!C.endingColor){return ;}for(var A=0;A<this.sibs.length;A++){this.sibs[A].setAttribute("gradientcolor",C.startingColor+","+C.endingColor+",14,"+C.gradientAngle+","+C.gradientXOffset+","+C.gradientYOffset);if(this.conditionalBackgroundColor[A]==null&&(!this.conditionalGradients[A]||this.conditionalGradients[A].startingColor==null)){this.setRoundedCornerGradientColor(this.sibs[A],C);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrRoundedRectangle.prototype.setRoundedCornerGradientColor=function(u,R){try{var L=u.getElementsByTagName("SPAN");var o=L[mstrRoundedRectangle.TOP_1];var n=L[mstrRoundedRectangle.TOP_2];var g=L[mstrRoundedRectangle.TOP_3];var e=L[mstrRoundedRectangle.TOP_4];var Q=L[mstrRoundedRectangle.BOTTOM_1];var P=L[mstrRoundedRectangle.BOTTOM_2];var O=L[mstrRoundedRectangle.BOTTOM_3];var N=L[mstrRoundedRectangle.BOTTOM_4];var D=L[mstrRoundedRectangle.CONTENT];if(R.gradientAngle==0){var G=getObjInnerWidth(o);var E=getObjInnerWidth(n);var I=getObjInnerWidth(g);var H=getObjInnerWidth(e);var F=getObjInnerWidth(D);if(G==0||E==0||I==0||H==0||F==0){return ;}var W=gradientUtil.createIntervalColors(R.startingColor,R.endingColor,F,G);var U=gradientUtil.createIntervalColors(R.startingColor,R.endingColor,F,E);var T=gradientUtil.createIntervalColors(R.startingColor,R.endingColor,F,I);var X=gradientUtil.createIntervalColors(R.startingColor,R.endingColor,F,H);gradientUtil.applyGradient(o,W[0],W[1],R.gradientAngle,R.gradientXOffset,R.gradientYOffset);gradientUtil.applyGradient(n,U[0],U[1],R.gradientAngle,R.gradientXOffset,R.gradientYOffset);gradientUtil.applyGradient(g,T[0],T[1],R.gradientAngle,R.gradientXOffset,R.gradientYOffset);gradientUtil.applyGradient(e,X[0],X[1],R.gradientAngle,R.gradientXOffset,R.gradientYOffset);gradientUtil.applyGradient(D,R.startingColor,R.endingColor,R.gradientAngle,R.gradientXOffset,R.gradientYOffset);gradientUtil.applyGradient(Q,W[0],W[1],R.gradientAngle,R.gradientXOffset,R.gradientYOffset);gradientUtil.applyGradient(P,U[0],U[1],R.gradientAngle,R.gradientXOffset,R.gradientYOffset);gradientUtil.applyGradient(O,T[0],T[1],R.gradientAngle,R.gradientXOffset,R.gradientYOffset);gradientUtil.applyGradient(N,X[0],X[1],R.gradientAngle,R.gradientXOffset,R.gradientYOffset);}else{var V=getObjOuterHeight(o);var Z=getObjOuterHeight(n);var c=getObjOuterHeight(g);var q=getObjOuterHeight(e);var B=getObjOuterHeight(D);if(V==0||Z==0||c==0||q==0||B==0){return ;}var S=V*2+Z*2+c*2+q*2+B;var K=(R.gradientYOffset==0||R.gradientYOffset==50)?R.startingColor:R.endingColor;var A=(R.gradientYOffset==0||R.gradientYOffset==50)?R.endingColor:R.startingColor;var h=gradientUtil.createIntervalColor(K,A,(S-V)/S);var y=gradientUtil.createIntervalColor(K,A,(S-V-Z)/S);var C=gradientUtil.createIntervalColor(K,A,(S-V-Z-c)/S);var M=gradientUtil.createIntervalColor(K,A,(S-V-Z-c-q)/S);var a=gradientUtil.createIntervalColor(K,A,(V+Z+c+q)/S);var m=gradientUtil.createIntervalColor(K,A,(c+Z+V)/S);var Y=gradientUtil.createIntervalColor(K,A,(Z+V)/S);var J=gradientUtil.createIntervalColor(K,A,V/S);gradientUtil.applyGradient(o,K,h,R.gradientAngle,R.gradientXOffset,0);gradientUtil.applyGradient(n,h,y,R.gradientAngle,R.gradientXOffset,0);gradientUtil.applyGradient(g,y,C,R.gradientAngle,R.gradientXOffset,0);gradientUtil.applyGradient(e,C,M,R.gradientAngle,R.gradientXOffset,0);gradientUtil.applyGradient(D,M,a,R.gradientAngle,R.gradientXOffset,0);gradientUtil.applyGradient(N,a,m,R.gradientAngle,R.gradientXOffset,0);gradientUtil.applyGradient(O,m,Y,R.gradientAngle,R.gradientXOffset,0);gradientUtil.applyGradient(P,Y,J,R.gradientAngle,R.gradientXOffset,0);gradientUtil.applyGradient(Q,J,A,R.gradientAngle,R.gradientXOffset,0);}}catch(x){microstrategy.errors.log(x);return false;}};mstrRoundedRectangle.prototype.setRoundedCornerBackgroundColor=function(E,A){try{var C=E.getElementsByTagName("SPAN");for(var B=0;B<C.length;B++){C[B].style.backgroundColor=A;if(bIsDXIE){var F=this.getFilter(C[B],"Gradient");if(F!=null){F.enabled=false;}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrRoundedRectangle.prototype.getFilter=function(D,A){try{var E=D.style.filter;var B=null;if((E==null||E.length==0)&&microstrategy.styleObj){E=microstrategy.styleObj.getFilter(D);}if(E.length>0){B=D.filters["DXImageTransform.Microsoft."+A];}return B;}catch(C){microstrategy.errors.log(C);return false;}};mstrRoundedRectangle.prototype.adjustRoundedCornerHeight=function(G){try{var F=microstrategy.ZOOM_FACTOR/100;var A=parseInt(microstrategy.styleObj.getValue(G,"height"));var C=G.getElementsByTagName("SPAN");var E=C[mstrRoundedRectangle.CONTENT];if(E){E.style.height=A-Math.round(8*F)<=0?"0px":A-Math.round(8*F)+"px";}var C=G.getElementsByTagName("SPAN");for(var B=0;B<C.length;B++){if(C[B].getAttribute("minheight")){var H=parseInt(C[B].getAttribute("minheight"));if(H>A){C[B].style.display="none";}else{C[B].style.display="block";}}}}catch(D){microstrategy.errors.log(D);return false;}};function mstrRoundedRectangle(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrSubSection.prototype=new mstrBoneImpl();mstrSubSection.prototype.maxZindex=1;mstrSubSection.prototype.minZindex=1;mstrSubSection.prototype.path="";mstrSubSection.prototype.type=microstrategy.OBJTYPE_DOC_SUBSECTION;mstrSubSection.prototype.verifiedPath="";mstrSubSection.prototype.isDetails=false;mstrSubSection.prototype.sibs=null;mstrSubSection.prototype.doc=null;mstrSubSection.prototype.needToUpdateMaxContentHeight=true;mstrSubSection.prototype.subsectionType=0;mstrSubSection.prototype.oldHeight=null;mstrSubSection.prototype.gradientInfo=null;mstrSubSection.prototype.sibsWithGradients=null;mstrSubSection.TYPE_FIXED=0;mstrSubSection.TYPE_HORIZ=1;mstrSubSection.TYPE_PANEL=2;mstrSubSection.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.sibs=document.getElementsByName(this.id);var B=microstrategy.getViewerBone();this.minZindex=1;if(B.isInteractiveViewModeEplus()){this.initGuideline();this.calcZIndexAndPositions();}this.doc=B.doc;if(B.gradientsOnSS){this.initGradients();}}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.getGradientInfo=function(){try{if(!this.gradientInfo){this.gradientInfo=[];}return this.gradientInfo;}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.setSibsWithGradients=function(B){try{this.sibsWithGradients=[];if(B){for(i=0;i<B.length;i++){this.sibsWithGradients.push(B[i]);}}}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.setGradientInfo=function(C,A){try{this.gradientInfo=[];if(A){for(i=0;i<C.length;i++){this.gradientInfo.push(A);}}}catch(B){microstrategy.errors.log(B);}};mstrSubSection.prototype.getSibsWithGradients=function(){try{if(!this.sibsWithGradients){this.sibsWithGradients=[];}return this.sibsWithGradients;}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.initGradients=function(){try{for(var A=0;A<this.sibs.length;A++){var B=this.sibs[A].getAttribute("gradientcolor");if(B){this.getGradientInfo().push(B.split(","));this.getSibsWithGradients().push(this.sibs[A]);}}}catch(C){microstrategy.errors.log(C);}};mstrSubSection.prototype.syncPosition=function(){try{this.applyGradient();}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.initGuideline=function(){try{if(microstrategy.getViewerBone().isEditableViewModeEplus()){this.guidelineEnabled=true;this.positionMap=this.positionMap||{};}}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.initPositionMap=function(){try{if(!this.guidelineEnabled||this.positionMapReady){return ;}for(var D=0,A=this.sibs.length;D<A;D++){var F=this.sibs[D];if(F!=null){if(!this.containsDocObject(F)){continue;}for(var C=0,B=F.childNodes.length;C<B;C++){var G=F.childNodes[C];if(G.nodeType==1&&G.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){this.updatePositionMap(G);}}}this.positionMapReady=true;break;}}catch(E){microstrategy.errors.log(E);}};mstrSubSection.prototype.calcZIndexAndPositions=function(){try{var E=1;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;var D=null;for(var B=0;B<this.sibs.length;B++){D=this.sibs[B];if(D!=null){if(!this.containsDocObject(D)){continue;}for(var A=0;A<D.childNodes.length;A++){var G=D.childNodes[A];if(G.nodeType==1){if(G.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var F=parseInt(microstrategy.styleObj.getValue(G,"zIndex"));if(F==0){E++;G.style.zIndex=E;}else{if(F>E){E=F;}}}}}break;}}this.maxZindex=++E;}catch(C){microstrategy.errors.log(C);return false;}};mstrSubSection.prototype.containsDocObject=function(C){for(var B=0,A=C.childNodes.length;B<A;B++){var D=C.childNodes[B];if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){if(document.defaultView&&document.defaultView.getComputedStyle&&document.defaultView.getComputedStyle(D,"").display=="none"){continue;}if(D.currentStyle&&D.currentStyle.display=="none"){continue;}return true;}}return false;};mstrSubSection.prototype.setNeedToUpdateMaxContentHeight=function(A){try{this.needToUpdateMaxContentHeight=A;}catch(B){microstrategy.errors.log(B);}};mstrSubSection.prototype.reduceObjZIndex=function(D,C){try{var E=microstrategy.styleObj.getValue(D,"zIndex");for(var A=0;A<this.elem.childNodes.length;A++){var G=this.elem.childNodes[A];if(G.nodeType==1&&G.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var F=microstrategy.styleObj.getValue(G,"zIndex");if(F>E){F--;C=this.doc.formatItems(microstrategy.createAssociativeArray(G),"zIndex",F,false,C);}}}if(this.maxZindex>1){this.maxZindex--;}return C;}catch(B){microstrategy.errors.log(B);return C;}};mstrSubSection.prototype.ondrop=function(C,A){try{var D=","+A.getDssTypes().toString()+",";if(D.indexOf(","+microstrategy.DSSTYPE_HIERARCHY+",")!=-1){return ;}this.addUnits(C,A,A.shiftKey);}catch(B){microstrategy.errors.log(B);return false;}};mstrSubSection.prototype.addUnits=function(Q,E,R){try{var D=getObjSumLeft(Q);var O=getObjSumTop(Q);var K=Math.max(0,E.dragX);var I=E.dragY;var U=E.parentBone;var M=microstrategy.updateManager;var Y=[];var P=false;var T=(E.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF;var S=E.getItems();if(this.isFilterPanel){showMessage({contents:microstrategy.descriptors.getDescriptor("9512"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return null;}var G=[];var V=[];var N=this.doc.selections;for(var X=0;X<S.length;X++){if(S[X].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_RPT_DEFINITION){G.push(S[X]);}else{V.push(S[X]);}}if(R){if(G.length>0){var H=[];for(var X=0;X<G.length;X++){var B={dataSetID:G[X].getAttribute("id").substring(0,32),shiftKey:false,displayGrid:(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE),dataSetName:G[X].getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME)};Y=this.doc.addCtrl(new Rect(I+O,null,null,K+D),Q,Y,microstrategy.SUBOBJTYPE_DOC_TEMPLATE,null,B,T);if(Y==null){return null;}P=true;if(!P){var L=[];var A=microstrategy.findBone(Q.lastChild);var C=U.selections.getDatasetMembers(G[X]);if(C){var J=colCount=1;for(var W=0;W<C.length;W++){if((C[W].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_METRIC)||(C[W].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_METRIC)||(C[W].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_SUMMARY_METRIC)){A.commands.exec("addTemplateUnit",C[W],microstrategy.GRIDCELL_AXIS_COLUMNS,colCount,L);colCount++;}else{if(C[W].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_ATTRIBUTE_FORM){A.commands.exec("addTemplateUnit",C[W],microstrategy.GRIDCELL_AXIS_ROWS,J,L);J++;}}}}}K=K+getObjWidth(Q.lastChild)+10;H.push(Q.lastChild);}if(H.length>0){N.finishAddAllObjs(H,Y,true);}}else{if(V.length>0){this.addObjsWithFormat(K,I,V,Q,U,T,Y,false);}}}else{if(G.length>0){this.addObjsWithFormat(K,I,G,Q,U,T,Y,false);}else{if(V.length>0){var H=[];for(var X=0;X<V.length;X++){this.doc.addObj(K,I,this,V[X],Y,T);K=K+getObjWidth(Q.lastChild)+10;H.push(Q.lastChild);}if(H.length>0){N.finishAddAllObjs(H,Y,true);}}}}if(Y&&Y.length>0){M.add(Y);if(P){M.flushAndSubmitChanges();}}return Y;}catch(F){microstrategy.errors.log(F);return Y;}};mstrSubSection.prototype.findObjects=function(G){try{var A=null;var F=[];for(var E=0,B=this.sibs.length;E<B;E++){A=this.sibs[E];var H=A.childNodes;for(var D=0,I=H.length;D<I;D++){if(H[D].getAttribute("sty")==G){F.push(H[D]);}}}return F;}catch(C){microstrategy.errors.log(C);return null;}};mstrSubSection.prototype.getTargets=function(F){var I=this.findObjects(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);I=I.concat(this.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK));var K=[],D=[],A=[];var C={};for(var G=0,J=I.length;G<J;G++){var E=microstrategy.findBone(I[G])||I[G];if(!E){continue;}var B=(E.objId||E.id);if(F&&F.excludeTargets){if(mstr.utils.Arrays.find(F.excludeTargets,B)>-1){continue;}}if(C[B]!=true){if(E.type==microstrategy.OBJTYPE_GRID){D.push(E);}else{if(E.type==microstrategy.OBJTYPE_PANEL_STACK){A.push(E);}}K.push(B);C[B]=true;}}if(F&&F.includeTargets){var L=F.includeTargets;for(var G=0,J=L.length;G<J;G++){var H=microstrategy.bone("grid_"+L[G]+"_0");if(H){D.push(H);}else{H=microstrategy.bone(L[G]);if(H){A.push(H);}}}K=K.concat(F.includeTargets);}var I={};I.keys=K;I.grids=D;I.panels=A;return I;};mstrSubSection.prototype.recursiveWiring=function(E,D){var A=this.getTargets();var F=A.panels;for(var C in F){if(F[C].panels){for(var B in F[C].panels){F[C].panels[B].recursiveWiring(E,D);}}}this.wireControllers(E,D,A.keys,A.grids,true);};mstrSubSection.prototype.wireControllers=function(R,T,F,D,B,H){var E=this.findObjects(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);var J=microstrategy.updateManager;var C=[];for(var M=0,N=E.length;M<N;M++){var L=E[M].getAttribute("id");if(H&&H.excludeControls){if(mstr.utils.Arrays.find(H.excludeControls,L)>-1){continue;}}C.push(L);}C=(!H||!H.includeControls)?C:C.concat(H.includeControls);for(var M=0,N=C.length;M<N;M++){var K=microstrategy.bone(C[M]+"_Ctl");if(K.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){continue;}microstrategy.getViewerBone().doc.formattingAttributes[K.RWUnitId]["dfm"]=-1;if(K.targetKeys!=null&&F&&F.length>0){K.targetKeys=F;R.push(J.createActionObject(null,mstrUpdateManager.CTRL_SET_TARGETS,T,["2048130","2048129","2048116"],[K.ctlKey,"",F.join(CLIPBOARD_ITEM_SEPARATOR)]));this.doc.selections.flush=true;}}if(!B){return ;}for(var M=0,N=D.length;M<N;M++){var S=D[M];var O=S.objId;var I=S.controlLinks;if(I){for(var G in I){if("1"==I[G].targetTy){continue;}var Q=(G=="Metrics")?"":""+I[G].ty;var A=[];for(var P in F){if(F[P]!=O){A.push(F[P]);}}I[G].targets=A;R.push(J.createActionObject(null,mstrUpdateManager.ADD_CONTROL_TO_GRID,T,["2048007","2048130","2048001","2048009","2048129","2048116"],[O,"",G=="Metrics"?"":G,Q,"",A.join(CLIPBOARD_ITEM_SEPARATOR)],[],null));}}}};mstrSubSection.prototype.wireTargets=function(D,C,F,E){try{var A=this.getTargets(E);this.wireControllers(D,C,A.keys,A.grids,F,E);return D;}catch(B){microstrategy.errors.log(B);}};mstrSubSection.prototype.addObjsWithFormat=function(L,J,T,Q,V,U,Y,B){try{var I=[];var W=[];var M=this.doc.parentBone.updateManager;var N=this.doc.selections;for(var X=0;X<T.length;X++){if(T[X].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_RPT_DEFINITION){I.push(T[X]);}else{W.push(T[X]);}}var E=getObjSumLeft(Q);var O=getObjSumTop(Q);var P=false;if(Y==null){Y=[];}for(var X=0;X<I.length;X++){var D=microstrategy.DISPLAY_MODE_GRID;var S=I[X].getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);if(S){switch(S){case microstrategy.DSSTYPE_GRAPH:D=microstrategy.DISPLAY_MODE_GRAPH;break;case microstrategy.DSSTYPE_GRID_AND_GRAPH:D=microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;break;}}var R=true;if(B){R=false;}var C={dataSetID:I[X].getAttribute("id").substring(0,32),shiftKey:R,displayGrid:(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE),viewMode:D,dssSubType:S,dataSetName:I[X].getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME),addAsLinked:B};Y=this.doc.addCtrl(new Rect(J+O,null,null,L+E),Q,Y,microstrategy.SUBOBJTYPE_DOC_TEMPLATE,"",C,U);if(Y==null){return null;}L=L+getObjWidth(Q.lastChild)+10;P=true;}if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||(V!=null&&V.type==microstrategy.OBJTYPE_OBJBROWSER&&V.isFeatureAvailable(microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS))){var H="";var A=null;var K=colCount=null;for(var X=0;X<W.length;X++){var G=new mstrObjectInfoImpl(W[X]);if(H!=G.dSetId){P=(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE);H=G.dSetId;K=colCount=1;var C={dataSetID:null,shiftKey:false,displayGrid:true,dataSetName:null};Y=this.doc.addCtrl(new Rect(J+O,null,null,L+E),Q,Y,microstrategy.SUBOBJTYPE_DOC_TEMPLATE,null,C,U);if(Y==null){return null;}L=L+getObjWidth(Q.lastChild)+10;A=microstrategy.findBone(Q.lastChild);}if((W[X].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_METRIC)||(W[X].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_METRIC)||(W[X].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_SUMMARY_METRIC)){Y=A.commands.exec("addTemplateUnit",W[X],microstrategy.GRIDCELL_AXIS_COLUMNS,colCount,Y);colCount++;}else{Y=A.commands.exec("addTemplateUnit",W[X],microstrategy.GRIDCELL_AXIS_ROWS,K,Y);K++;}}}Y=N.finishAdd(Q.lastChild,Y);if(P){if(Y.length>0){M.add(Y);Y=null;}M.flushAndSubmitChanges();}return Y;}catch(F){microstrategy.errors.log(F);return Y;}};mstrSubSection.prototype.onmousedown=function(F){try{if(!F){F=window.event;}var G=getEventTarget(F);var C=G&&G.tagName.toLowerCase();if(C==="select"||C==="textarea"||C==="input"){return true;}var B=microstrategy.eventManager.getSource(F);var A=this.doc.parentBone;if(!A.isInteractiveViewModeEplus(F)){if(this.doc.selections){this.doc.selections.clear(false);}microstrategy.hidePopups();F.cancelBubble=true;mstr.controllers.EventManager.notifyWindowListeners({name:"closeMenus"});return true;}if(B&&B.button==2&&(B.type==microstrategy.OBJTYPE_DOC_SUBSECTION||B.type==microstrategy.OBJTYPE_DOC_SECTION)){if(this.elem.getAttribute("cx")==null){microstrategy.getContextMenuManager("RWM").getMenu("rw_subsection_menu").registerTrigger(this.elem);this.parentBone.currentSubSection=this;this.doc.currentSection=this.parentBone;}if(G.getAttribute("cx")==null){microstrategy.getContextMenuManager("RWM").getMenu("rw_subsection_menu").registerTrigger(G);}var E=this.doc.selections;E.addSubSection(this.elem);microstrategy.hidePopups(null,F);F.cancelBubble=true;return false;}else{this.checkForResize(G);return(this.doc.selections.onmousedown)?this.doc.selections.onmousedown(F):false;}}catch(D){microstrategy.errors.log(D);return false;}};mstrSubSection.prototype.onclick=function(B){try{if(!B){B=window.event;}return(this.doc.selections.onclick)?this.doc.selections.onclick(B):false;}catch(A){microstrategy.errors.log(A);return false;}};mstrSubSection.prototype.ondblclick=function(D){try{if(!D){D=window.event;}var A=this.doc.parentBone;if(!A.isInteractiveViewModeEplus(D)){if(this.doc.selections){this.doc.selections.clear(false);}D.cancelBubble=true;return true;}var E=getEventTarget(D);try{if(!E||!E.tagName){return true;}}catch(C){alert("here");return true;}var B=E.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(B){case microstrategy.OBJTYPE_DOC_OBJECT:this.doc.editObj(D,E);break;case microstrategy.OBJTYPE_DOC_SELECTION:if(E.src){this.doc.editObj(D,E.src);}break;}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrSubSection.prototype.changeSubHeight=function(A,C,B){return B;};mstrSubSection.prototype.getSectionFormattingProps=function(){};mstrSubSection.prototype.checkForResize=function(A){};mstrSubSection.prototype.toggleSelected=function(){};mstrSubSection.prototype.toggleGrid=function(A){};mstrSubSection.prototype.marqueeSelect=function(G,F,A){try{for(var B=0;B<this.sibs.length;B++){var E=this.getOuterRect(this.sibs[B]);if(microstrategy.doRectsIntersect(E,F)){var D=this.sibs[B].firstChild;while(D){if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){if(A(this.getOuterRect(D),F)){G.push(D);}}D=D.nextSibling;}break;}}}catch(C){microstrategy.errors.log(C);}return G;};mstrSubSection.prototype.getOuterRect=function(C){try{var B={};if(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==null){B.left=getObjSumLeft(C);B.top=getObjSumTop(C);}else{B.left=getObjSumLeftScrolled(C);B.top=getObjSumTopScrolled(C);}B.right=Math.max(B.left+getObjWidth(C),B.left+1);B.bottom=Math.max(B.top+getObjHeight(C),B.top+1);return B;}catch(A){microstrategy.errors.log(A);return null;}};mstrSubSection.prototype.applyGradient=function(){try{if(!this.sibsWithGradients||this.hasConditionalFormatting){return ;}for(var C=0;C<this.sibsWithGradients.length;C++){if(!this.gradientInfo[C][gradientUtil.GRADIENT_START_COLOR_INDEX]||!this.gradientInfo[C][gradientUtil.GRADIENT_END_COLOR_INDEX]){continue;}if(!this.doc.parentBone.isEditableViewModeEplus()){gradientUtil.applyGradient(this.sibsWithGradients[C],this.gradientInfo[C][gradientUtil.GRADIENT_START_COLOR_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_END_COLOR_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_ANGLE_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_XOFFSET_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_YOFFSET_INDEX]);}else{var F;var B=false;if(!getObjOuterHeight(this.sibs[C])||!getObjOuterWidth(this.sibsWithGradients[C])){continue;}this.sibsWithGradients[C].setAttribute("gradientcolor",this.gradientInfo[C][gradientUtil.GRADIENT_START_COLOR_INDEX]+","+this.gradientInfo[C][gradientUtil.GRADIENT_END_COLOR_INDEX]+",14,"+this.gradientInfo[C][gradientUtil.GRADIENT_ANGLE_INDEX]+","+this.gradientInfo[C][gradientUtil.GRADIENT_XOFFSET_INDEX]+","+this.gradientInfo[C][gradientUtil.GRADIENT_YOFFSET_INDEX]);this.sibsWithGradients[C].setAttribute("bgstyle",2);if(this.sibsWithGradients[C].previousSibling&&this.sibsWithGradients[C].previousSibling.id&&this.sibsWithGradients[C].previousSibling.id==(this.sibsWithGradients[C].id+gradientUtil.GRADIENT_POSTFIX)){F=this.sibsWithGradients[C].previousSibling;B=true;}else{F=document.createElement("div");F.id=(this.sibsWithGradients[C].id+gradientUtil.GRADIENT_POSTFIX);F.style.position="absolute";}var A=getObjOuterHeight(this.sibsWithGradients[C]);var D=getObjOuterWidth(this.sibsWithGradients[C]);F.style.top="0px";F.style.left="0px";F.style.height=A+"px";F.style.width=D+"px";if(!B){this.sibsWithGradients[C].parentNode.insertBefore(F,this.sibsWithGradients[C]);}this.sibsWithGradients[C].style.backgroundColor="transparent";gradientUtil.applyGradient(F,this.gradientInfo[C][gradientUtil.GRADIENT_START_COLOR_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_END_COLOR_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_ANGLE_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_XOFFSET_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_YOFFSET_INDEX]);}}}catch(E){microstrategy.errors.log(E);}};mstrSubSection.prototype.getDocBone=function(){try{var A=microstrategy.getViewerBone();return A&&A.doc;}catch(B){microstrategy.errors.log(B);return null;}};mstrSubSection.prototype.canShowGuideline=function(){try{var B=this.getDocBone();return this.guidelineEnabled&&!(B&&B.selections.isMulti());}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.guidelineOffsetX=microstrategy.SNAP_SIZE;mstrSubSection.prototype.guidelineOffsetY=microstrategy.SNAP_SIZE;mstrSubSection.prototype.showGuidelines=function(B){try{var I=microstrategy.eventManager.source.elem;if(I&&I.id&&I.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){srcPos=this.positionMap[I.id];if(srcPos){B.height=srcPos.height;B.width=srcPos.width;}}if(!this.guidelineEnabled||!this.canShowGuideline()){return ;}var m=this.getDocBone();if(m.prevGuidelineSubsec){m.prevGuidelineSubsec.hideGuidelines();}m.prevGuidelineSubsec=this;this.hideGuidelines();this.showDimension(B);this.neighbors=null;this.guidelineOffsetX=microstrategy.SNAP_SIZE;this.guidelineOffsetY=microstrategy.SNAP_SIZE;var e=function(o,n){return Math.abs(o)>=Math.abs(n)?n:o;};var Y=m.selections.firstItem();if(!Y){return ;}var P=Y.id;var Q=["center","hcenter","left","right","top","bottom","vcenter","top-bottom","bottom-top","left-right","right-left","distance-vertical","distance-horizontal","width","height"];for(var V=0,W=Q.length;V<W;V++){var E=Q[V];switch(E){case"center":var R=Math.round(B.left+B.width/2),G=Math.round(B.top+B.height/2);var K=this.getLocalPosition(this.elem)||{top:0,left:0,width:this.elem.offsetWidth,height:this.elem.offsetHeight},Z=Math.round(K.left+K.width/2),g=Math.round(K.top+K.height/2);if(R==Z){this.renderGuidelines({top:K.top,left:R,height:K.height,width:1,borderColor:"#008000"});}if(G==g){this.renderGuidelines({top:G,left:K.left,height:1,width:K.width,borderColor:"#008000"});}this.guidelineOffsetX=e(this.guidelineOffsetX,R-Z);this.guidelineOffsetY=e(this.guidelineOffsetY,G-g);break;case"distance-vertical":var M=this.getNeighbor(B,P,"top"),L=this.getNeighbor(B,P,"bottom");if(!M.id||!L.id||M.v!=L.v){continue;}var U=M.pos,a=L.pos;var O={top:B.top-M.v,bottom:B.top,left:Math.max(U.left,B.left),right:Math.min(U.left+U.width,B.left+B.width)},N={top:a.top-M.v,bottom:a.top,left:Math.max(a.left,B.left),right:Math.min(a.left+a.width,B.left+B.width)};this.renderGuidelines({top:O.top,left:O.left+(O.right-O.left)/2,width:1,height:M.v},true);this.renderGuidelines({top:N.top,left:N.left+(N.right-N.left)/2,width:1,height:L.v},true);this.showDistance({top:O.top,left:O.left+(O.right-O.left)/2,idx:"t",v:M.v});this.showDistance({top:N.top,left:N.left+(N.right-N.left)/2,idx:"b",v:L.v});break;case"distance-horizontal":var M=this.getNeighbor(B,P,"left"),L=this.getNeighbor(B,P,"right");if(!M.id||!L.id||M.v!=L.v){continue;}var U=M.pos,a=L.pos;var O={top:Math.max(U.top,B.top),bottom:Math.min(U.top+U.height,B.top+B.height),left:U.left+U.width,right:B.left},N={top:Math.max(a.top,B.top),bottom:Math.min(a.top+a.height,B.top+B.height),left:B.left+B.width,right:a.left};this.renderGuidelines({top:O.top+(O.bottom-O.top)/2,left:O.left,width:M.v,height:1},true);this.renderGuidelines({top:N.top+(N.bottom-O.top)/2,left:N.left,width:L.v,height:1},true);this.showDistance({top:O.top+(O.bottom-O.top)/2,left:O.left,idx:"l",v:M.v});this.showDistance({top:N.top+(N.bottom-O.top)/2,left:N.left,idx:"r",v:L.v});break;default:var X=this.positionMap;for(var h in X){if(h==P){continue;}var H=X[h];H=mstr.$H.clone(H);H.top=parseInt(H.top);H.left=parseInt(H.left);var c=null,C=H,A=B,J=3;var D=function(n){if(C[n]>B[n]){C=B;A=H;}};switch(E){case"width":if(Math.round(C.width)==Math.round(A.width)){this.renderGuidelines({top:C.top+C.height+J,left:C.left,width:C.width,height:1},true);this.renderGuidelines({top:A.top+A.height+J,left:A.left,width:A.width,height:1},true);continue;}break;case"height":if(Math.round(C.height)==Math.round(A.height)){this.renderGuidelines({top:C.top,left:C.left+C.width+J,width:1,height:C.height},true);this.renderGuidelines({top:A.top,left:A.left+A.width+J,width:1,height:A.height},true);continue;}break;case"hcenter":var T=Math.round(H.left+H.width/2),S=Math.round(B.left+B.width/2);if(T==S){D("top");c={top:C.top+C.height,left:T,width:1,height:A.top-(C.top+C.height)};}this.guidelineOffsetX=e(this.guidelineOffsetX,S-T);break;case"vcenter":var T=Math.round(H.top+H.height/2),S=Math.round(B.top+B.height/2);if(T==S){D("left");c={top:T,left:C.left+C.width,width:A.left-C.left-C.width,height:1};}this.guidelineOffsetY=e(this.guidelineOffsetY,S-T);break;case"left":var T=Math.round(H.left),S=Math.round(B.left);if(T==S){D("top");c={top:C.top+C.height,left:T,width:1,height:A.top-(C.top+C.height)};}this.guidelineOffsetX=e(this.guidelineOffsetX,S-T);break;case"right":var T=Math.round(H.left+H.width),S=Math.round(B.left+B.width);if(T==S){D("top");c={top:C.top+C.height,left:T,width:1,height:A.top-(C.top+C.height)};}this.guidelineOffsetX=e(this.guidelineOffsetX,S-T);break;case"top":var T=Math.round(H.top),S=Math.round(B.top);if(T==S){D("left");c={top:T,left:C.left+C.width,width:A.left-(C.left+C.width),height:1};}this.guidelineOffsetY=e(this.guidelineOffsetY,S-T);break;case"bottom":var T=Math.round(H.top+H.height),S=Math.round(B.top+B.height);if(T==S){D("left");c={top:T,left:C.left+C.width,width:A.left-(C.left+C.width),height:1};}this.guidelineOffsetY=e(this.guidelineOffsetY,S-T);break;case"top-bottom":var T=Math.round(H.top+H.height),S=Math.round(B.top);if(T==S){D("left");c={top:T,left:C.left+C.width,width:A.left-(C.left+C.width),height:1};}this.guidelineOffsetY=e(this.guidelineOffsetY,S-T);break;case"bottom-top":var T=Math.round(H.top),S=Math.round(B.top+B.height);if(T==S){D("left");c={top:T,left:C.left+C.width,width:A.left-(C.left+C.width),height:1};}this.guidelineOffsetY=e(this.guidelineOffsetY,S-T);break;case"left-right":var T=Math.round(H.left+H.width),S=Math.round(B.left);if(T==S){D("top");c={top:C.top+C.height,left:T,width:1,height:A.top-(C.top+C.height)};}this.guidelineOffsetX=e(this.guidelineOffsetX,S-T);break;case"right-left":var T=Math.round(H.left),S=Math.round(B.left+B.width);if(T==S){D("top");c={top:C.top+C.height,left:T,width:1,height:A.top-(C.top+C.height)};}this.guidelineOffsetX=e(this.guidelineOffsetX,S-T);break;}c&&this.renderGuidelines(c,false);}break;}}if(this.positionMap[P]){this.positionMap[P]=B;}}catch(F){microstrategy.errors.log(F);}};mstrSubSection.prototype.getNeighbor=function(F,G,K,A){try{var R=mstr.utils.Math;var P=F.top,B=F.left,Y=this.elem,c=min_bottom=Y.offsetHeight,I=min_right=Y.offsetWidth,C={top:{id:"",v:c},bottom:{id:"",v:min_bottom},left:{id:"",v:I},right:{id:"",v:min_right}},J={h:{min:F.left,max:F.left+F.width},v:{min:F.top,max:F.top+F.height}};var E=this.elem.childNodes;for(var U=0,W=E.length;U<W;U++){var V=E[U],X=V.id;if(X&&X!=G){if(!this.positionMap[X]){if(V.nodeType==1&&V.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){this.updatePositionMap(V);}else{continue;}}var Q=this.positionMap[X],M=Q.top,a=M+Q.height,S=Q.left,O=S+Q.width;for(var T=0;T<4;T++){var H=["top","bottom","left","right"][T];var Z=-1,N=null,L=null;switch(H){case"top":case"bottom":Z=H=="top"?P-a:M-(F.top+F.height);N={min:S,max:O};L=J.h;break;case"left":case"right":Z=H=="left"?B-O:S-(B+F.width);N={min:M,max:a};L=J.v;break;}if(Z>0&&(A||!A&&R.rangesIntersect(N,L))&&Z<C[H].v){C[H].v=Z;C[H].id=X;C[H].pos=Q;}}}}this.neighbors=C;return K?C[K]:C;}catch(D){microstrategy.errors.log(D);}};mstrSubSection.prototype.getGuidelineSnapOffset=function(H,D,B,A){try{var E=0;var G=this.getNeighbor(H,D,A,true);if(G&&G.pos){var F=G.pos;switch(A){case"top":E=H.top-(F.top+F.height);break;case"bottom":E=F.top-(H.top+H.height);break;case"left":E=H.left-(F.left+F.width);break;case"right":E=F.left-(H.left+H.width);break;}E=E<microstrategy.SNAP_SIZE?E:0;}return B*E;return E!=0?B*(microstrategy.SNAP_SIZE-E):0;}catch(C){microstrategy.errors.log(C);}};mstrSubSection.prototype.renderGuidelines=function(G,D){try{if(!this.cnt){this.cnt=0;}var F=G.height==1?"h":"v",C=G.height==1?"v":"h",A=document.createElement("div");A.setAttribute("cnt",this.cnt);A.setAttribute("ty","gl");A.className="mstrGuideline "+F+(D?" s":"");A.style.zIndex=this.maxZindex+1;for(var B in G){A.style[B]=mstr.utils.LocaleParser.isNumeric(G[B])?Math.max(G[B],0)+"px":G[B];}if(D){A.innerHTML='<div class="mstrGuideline-tip '+C+' tl" ></div><div class="mstrGuideline-tip '+C+' rb" ></div>';}this.elem.appendChild(A);this.guidelines=this.guidelines||[];this.guidelines.push(A);}catch(E){microstrategy.errors.log(E);}};mstrSubSection.prototype.hideGuidelines=function(){try{this.hideDimension();this.hideDistance();if(!this.guidelines){return ;}for(var C=0,A=this.guidelines.length;C<A;C++){var B=this.guidelines[C];B.parentNode.removeChild(B);}this.guidelines=[];}catch(D){microstrategy.errors.log(D);}};mstrSubSection.prototype.showDimension=function(C){try{var A=this.elDim;if(!A){A=document.createElement("span");A.className="mstrGuideline-dim";this.elem.appendChild(A);this.elDim=A;}A.style.display="block";A.style.left=(C.left+C.width+10)+"px";A.style.top=(C.top)+"px";A.innerHTML="x:"+parseInt(C.left,10)+"px<br/>y:"+parseInt(C.top,10)+"px<br/>width:"+parseInt(C.width,10)+"px<br/>height:"+parseInt(C.height,10)+"px";}catch(B){microstrategy.errors.log(B);}};mstrSubSection.prototype.hideDimension=function(){try{if(this.elDim){this.elDim.style.display="none";}}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.showDistance=function(F){try{var C=F.v,A=F.idx,B=A=="l"||A=="r";var D=(this.elDis||(this.elDis={l:null,t:null,r:null,b:null}))[F.idx];if(!D){D=document.createElement("span");D.className="mstrGuideline-dis";this.elem.appendChild(D);this.elDis[A]=D;}D.innerHTML=F.v+"px";D.style.left=(F.left+(B?C/2-10:3))+"px";D.style.top=(F.top+(B?-20:C/2-10))+"px";D.style.display="block";}catch(E){microstrategy.errors.log(E);}};mstrSubSection.prototype.hideDistance=function(){try{var B=this.elDis;if(B){for(var A in B){var C=B[A];if(C){C.style.display="none";}}}}catch(D){microstrategy.errors.log(D);}};mstrSubSection.prototype.readFormatPosition=function(A){return this.getLocalPosition(A);};mstrSubSection.prototype.getLocalPosition=function(C){try{var G=[];var F=C.constructor===Array,C=F?C:[C];if(C&&C.length){var D=mstr.$BM.position(this.elem);for(var B in C){var A=mstr.$BM.position(C[B]);A.top=A.top-D.top;A.left=A.left-D.left;G.push(A);}}return F?G:(G&&G[0]);}catch(E){microstrategy.errors.log(E);}};mstrSubSection.prototype.updatePositionMap=function(B,A){try{if(!this.guidelineEnabled){return ;}if(A){delete this.positionMap[B.id];}else{this.positionMap[B.id]=this.readFormatPosition(B);}}catch(C){microstrategy.errors.log(C);}};mstrSubSection.prototype.syncPositionMap=function(A){try{if(!this.guidelineEnabled){return ;}A=mstr.$A.toArray(A);for(var C in A){this.updatePositionMap(A[C]);}}catch(B){microstrategy.errors.log(B);}};function mstrSubSection(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrTreeImplScript=true;mstrTreeImpl.prototype=new mstrBoneImpl();mstrTreeImpl.prototype.path="";mstrTreeImpl.prototype.selections=null;mstrTreeImpl.prototype.onload=function(B){try{this.initBone();this.elem.onmousedown=new Function("e","return "+this.path+".onmousedown(e);");this.getSelections();}catch(A){microstrategy.errors.log(A);return false;}};mstrTreeImpl.prototype.onmousedown=function(G){try{if(!G){G=window.event;}this.getSelections();var F=getEventTarget(G);if(F){if(F.tagName.toLowerCase()=="img"||(F.tagName.toLowerCase()=="span")&&!F.getAttribute(microstrategy.HTMLATTR_DSS_ID)){F=F.parentNode;}if(this.selections!=null){this.selections.clickedSrc=F;}switch(F.tagName.toLowerCase()){case"span":if(this.selections!=null&&F.getAttribute(microstrategy.HTMLATTR_DSS_ID)){if(this.selections.isSelected(F)){if(G.ctrlKey){if(typeof (mstr)!="undefined"){this.attachWinListener(this.selections,"mouseup","ondeselect");}else{document.onmouseup=new Function("e","return "+this.selections.path+".ondeselect(e);");}}}else{if(!G.ctrlKey){this.selections.clear();}this.selections.add(F);}if(this.selections.onmousedown){return this.selections.onmousedown(G);}}break;case"li":var H=F.className;if(H&&(H=="mstrTreeOpen"||H=="mstrTreeClosed")){var C=microstrategy.findChildWithAtt(F,"span","oty","12");var A=C&&C.getAttribute("oid"),B=microstrategy.findChildWithAtt(F,"ul","af","1");if(B){B.className="loading";var E=this;mstr.$XHR.request(mstrConfig.taskURL,{taskId:"getAttributeForms",styleName:"MojoAttributeStyle",attributeID:A,displayedForms:0},{success:function(K){var M=K.fms;for(var J=0;J<M.length;J++){var L=M[J];if(!L.itf){continue;}var I=document.createElement("li");I.innerHTML="<nobr><span id="+E._nextId()+" ds="+L.n+" oid="+L.did+" oty="+L.t+" title="+L.n+'><img border=0 align=absmiddle src="../images/formli.png" alt="">&nbsp;'+L.n+"</span></nobr>";B.appendChild(I);}B.removeAttribute("af");B.className="";}});}if(F.className=="mstrTreeOpen"){this.collapseNode(F);}else{this.expandNode(F);}break;}default:if(this.selections!=null){this.selections.clear();}}}return false;}catch(D){microstrategy.errors.log(D);return false;}};mstrTreeImpl.prototype._nextId=function(){var B=this.elem.getAttribute("pfx")||"",A=B+this.elem.getElementsByTagName("span").length;return A;};mstrTreeImpl.prototype.addNode=function(C,J){var H=this.elem.firstChild;if(H){if(microstrategy.findChildWithAtt(H,"span","oid",C.getAttribute("oid"))){return ;}var A=C.getAttribute("oty")==microstrategy.DSSTYPE_ATTRIBUTE;C.id=this._nextId();C.className="mstrTreeStrong";C.innerHTML='<img border="0" align="absmiddle" src="../images/'+(A?"attributeli.png":"metricli.png")+'" alt="">&nbsp;'+C.getAttribute("ds");var I=document.createElement("li");I.className=A?"mstrTreeClosed":"";var D=document.createElement("nobr");D.appendChild(C);I.appendChild(D);H.appendChild(I);if(A){var B=document.createElement("ul");B.style.display="none";if(!J){B.setAttribute("af","1");}else{for(var E=0;E<J.length;E++){var G=J[E];var F=document.createElement("li");F.innerHTML="<nobr><span ds="+G.n+" oid="+G.dssid+" oty="+G.ty+" title="+G.n+'><img border=0 align=absmiddle src="../images/formli.png" alt="">&nbsp;'+G.n+"</span></nobr>";B.appendChild(F);}}I.appendChild(B);}}};mstrTreeImpl.prototype.updateAttForms=function(){var xhr=this.xhr;switch(xhr.readyState){case 4:if(xhr.status==200&&!xhr.cancelled){var txt=xhr.responseText;if(txt){try{var rsData=eval("("+txt+")");}catch(ex){}}console.log(txt);}else{if(xhr.status>=400){alert(xhr.status+" : "+xhr.statusText);}}break;default:break;}};mstrTreeImpl.prototype.collapseNode=function(B){try{if(B.tagName.toLowerCase()=="li"){B.className="mstrTreeClosed";if(B.lastChild&&B.lastChild.tagName.toLowerCase()=="ul"){B.lastChild.style.display="none";}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrTreeImpl.prototype.expandNode=function(B){try{if(B.tagName.toLowerCase()=="li"){B.className="mstrTreeOpen";if(B.lastChild&&B.lastChild.tagName.toLowerCase()=="ul"){B.lastChild.style.display="block";}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrTreeImpl.prototype.getSelections=function(){try{if(this.selections==null&&this.parentBone!=null&&this.parentBone.selections!=null){this.selections=this.parentBone.selections;}}catch(A){microstrategy.errors.log(A);return false;}};function mstrTreeImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}microstrategy.HTMLATTR_MASKEDOBJECT="MB";microstrategy.HTMLATTR_MASKFOR="MASKFOR";microstrategy.HTMLATTR_MASKFOR_DELIM=",";mstrMaskImpl.prototype=new mstrBoneImpl();mstrMaskImpl.prototype.elem=null;mstrMaskImpl.prototype.img=null;mstrMaskImpl.prototype.borderWidth=3;mstrMaskImpl.prototype.onload=function(B){try{this.maskedBone=B;this.initElem();this.img.onmouseover=new Function("this.style.borderWidth = '"+this.borderWidth+"px';");this.img.onmouseout=new Function("this.style.borderWidth = '0px';");if(this.maskedBone){this.maskfor=(B.maskFor)?microstrategy.HTMLATTR_MASKFOR_DELIM+this.maskedBone.maskFor+microstrategy.HTMLATTR_MASKFOR_DELIM:"";this.onmaskedobjectresize();}}catch(A){microstrategy.errors.log(A);return false;}};mstrMaskImpl.prototype.onmaskedobjectresize=function(B,A){try{if(this.maskedBone&&this.maskedBone.maskArea){var D=2*this.borderWidth;B=(B>D?B:Math.max(7,getObjHeight(this.maskedBone.maskArea)))-D;A=(A>D?A:Math.max(7,this.maskedBone.maskArea.scrollWidth))-D;this.img.style.height=B+"px";this.img.style.width=A+"px";}}catch(C){microstrategy.errors.log(C);return false;}};mstrMaskImpl.prototype.initElem=function(){try{var C=document.createElement("div");C.className="mstrMask";this.elem=C;var A=document.createElement("img");A.className="mstrMaskedImage";A.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";A.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK);if(this.maskedBone){A.setAttribute(microstrategy.HTMLATTR_MASKEDOBJECT,this.maskedBone.id);A.setAttribute(microstrategy.HTMLATTR_POINTS_TO,this.maskedBone.id);}this.img=A;this.elem.appendChild(this.img);if(this.maskedBone.maskArea.childNodes.length>0){this.maskedBone.maskArea.insertBefore(this.elem,this.maskedBone.maskArea.firstChild);}else{this.maskedBone.maskArea.appendChild(this.elem);}}catch(B){microstrategy.errors.log(B);return false;}};mstrMaskImpl.prototype.toggle=function(A,B){try{if(!this.elem){return ;}this.elem.style.display=(A&&this.maskfor.indexOf(microstrategy.HTMLATTR_MASKFOR_DELIM+B+microstrategy.HTMLATTR_MASKFOR_DELIM)>-1)?"block":"none";}catch(C){microstrategy.errors.log(C);return false;}};function mstrMaskImpl(){return this;}mstrRWUnitBoneImplScript=true;mstrRWUnitBoneImpl.prototype=new mstrBoneImpl();mstrRWUnitBoneImpl.prototype.toolbar=null;mstrRWUnitBoneImpl.prototype.hasToolbar=true;mstrRWUnitBoneImpl.prototype.sibRWUnits=null;mstrRWUnitBoneImpl.prototype.activeRWUnit=null;mstrRWUnitBoneImpl.prototype.RWUnitId=null;mstrRWUnitBoneImpl.prototype.docViewer=null;mstrRWUnitBoneImpl.prototype.toolbarShown=false;mstrRWUnitBoneImpl.prototype.boneSelected=false;mstrRWUnitBoneImpl.prototype.isMouseOver=false;mstrRWUnitBoneImpl.prototype.showTBSelected=true;mstrRWUnitBoneImpl.prototype.toolbar_pos_x=null;mstrRWUnitBoneImpl.prototype.toolbar_pos_y=null;mstrRWUnitBoneImpl.prototype.toolbarTimer=null;mstrRWUnitBoneImpl.prototype.isLocked=false;mstrRWUnitBoneImpl.prototype.TIME_DELAY_SHOW_TOOLBAR=0;mstrRWUnitBoneImpl.prototype.TIME_DELAY_SHOW_TOOLBAR_SHORT=0;mstrRWUnitBoneImpl.prototype.TIME_DELAY_HIDE_TOOLBAR=9;mstrRWUnitBoneImpl.prototype.stickToolbar=false;mstrRWUnitBoneImpl.prototype.elemTagName="div";mstrRWUnitBoneImpl.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.docViewer=microstrategy.bone("rwb_viewer");this.activeRWUnit=microstrategy.findAncestor(this.elem);if(this.activeRWUnit){this.RWUnitId=this.activeRWUnit.getAttribute("id");}this.initToolbar();}catch(A){microstrategy.errors.log(A);}};mstrRWUnitBoneImpl.prototype.initToolbar=function(){try{if(this.checkToolbarCondition(true)){this.attachToolbarEvents();}}catch(A){microstrategy.errors.log(A);}};mstrRWUnitBoneImpl.prototype.checkToolbarCondition=function(A){try{if(this.docViewer==null){this.getDocViewer();}if(this.docViewer){return this.docViewer.isEditableViewModeEplus()&&(A||getObjWidth(this.activeRWUnit)!=0||getObjHeight(this.activeRWUnit)!=0);}else{return false;}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWUnitBoneImpl.prototype.switchActiveRWUnit=function(C){try{if(!C){return ;}var A=C.split("_");this.activeRWUnit=document.getElementsByName(this.RWUnitId)[A[1]];}catch(B){microstrategy.errors.log(B);}};mstrRWUnitBoneImpl.prototype.switchActiveElem=function(C){try{var B=microstrategy.findChildWithAtt(this.activeRWUnit,this.elemTagName,"id",this.id);if(B){this.elem=B;}}catch(A){microstrategy.errors.log(A);}};mstrRWUnitBoneImpl.prototype.getTitleAndClassOfFirstToolbar=function(){var A=this.isLocked,B={};B.title=microstrategy.descriptors.getDescriptor(A?"5604":"5773");B.className=A?"mstrLocked":"select";return B;};mstrRWUnitBoneImpl.prototype.createToolbarBody=function(){try{var D=document.createElement("div");if(this.docViewer.isEditableViewModeEplus()){var B=document.createElement("div");B.setAttribute("id","select_icon");B.setAttribute("targetBoneId",this.id);var A=this.getTitleAndClassOfFirstToolbar();B.setAttribute("title",A.title);B.className=A.className;B.onmousedown=new Function("e","return  microstrategy.bone('"+this.id+"').getDocSelections().onmousedown(e);");D.appendChild(B);}return D;}catch(C){microstrategy.errors.log(C);return false;}};mstrRWUnitBoneImpl.prototype.createToolbar=function(){try{var C=this.createToolbarBody();C.id="toolbar_"+this.id;C.className="floatingToolbar";C.onmouseover=new Function("e","return microstrategy.bone('"+this.id+"').onmouseover(e);");C.onmouseout=new Function("e","return microstrategy.bone('"+this.id+"').onmouseout(e);");var A=getElementById("floatingToolbars");if(A){A.appendChild(C);}this.toolbar=C;}catch(B){microstrategy.errors.log(B);}};mstrRWUnitBoneImpl.prototype.computeToolbarPos=function(B){try{this.toolbar_pos_x=getObjSumLeft(this.activeRWUnit)-getObjSumLeft(this.docViewer.doc.elem)-(bIsIE4?2:1);this.toolbar_pos_y=this.getObjSumTopScrolled(this.activeRWUnit)-this.getObjSumTopScrolled("page")-getObjHeight(this.toolbar)+(mstr.utils.ISFF?1:0);}catch(A){microstrategy.errors.log(A);}};mstrRWUnitBoneImpl.prototype.showToolbar=function(A){try{if(!this.checkToolbarCondition()){return ;}this.toolbar=getObj("toolbar_"+this.id);if(!this.toolbar){this.createToolbar();}this.toolbar.style.display="block";this.computeToolbarPos();this.toolbar_pos_x=Math.max(this.toolbar_pos_x,0);this.toolbar_pos_y=Math.max(this.toolbar_pos_y,0);this.toolbar.style.width=this.toolbar.clientWidth+"px";moveObjTo(this.toolbar,this.toolbar_pos_x,this.toolbar_pos_y);this.toolbarShown=true;this.toolbar.setAttribute("shown",1);if(A){this.stickToolbar=true;}}catch(B){microstrategy.errors.log(B);}};mstrRWUnitBoneImpl.prototype.showToolbarWithDelay=function(A){try{if(this.toolbarShown){return null;}var C=this;var D=function(){var E=microstrategy.bone(C.id);if(E&&document.getElementById(C.id)){E.showToolbar();}};return window.setTimeout(D,A);}catch(B){microstrategy.errors.log(B);return false;}};mstrRWUnitBoneImpl.prototype.resetToolbar=function(){var A=this.stickToolbar;var B=this.toolbarShown;if(B){this.stickToolbar=false;this.hideToolbar(true);}if(this.toolbar){this.toolbar.parentNode.removeChild(this.toolbar);}this.toolbar=null;if(B){this.showToolbar(A);}};mstrRWUnitBoneImpl.prototype.hideToolbar=function(C){try{if(this.stickToolbar){return ;}var A=(C==true||C=="true");if(!A&&((this.showTBSelected&&this.boneSelected)||this.isMouseOver)){return ;}if(this.toolbar){this.toolbar.style.display="none";this.toolbarShown=false;this.toolbar.setAttribute("shown",0);}}catch(B){microstrategy.errors.log(B);}};mstrRWUnitBoneImpl.prototype.hideToolbarWithDelay=function(A){try{if(!this.toolbarShown){return null;}return window.setTimeout("if (microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').hideToolbar();",A);}catch(B){microstrategy.errors.log(B);return false;}};mstrRWUnitBoneImpl.prototype.syncToolbarElem=function(B){try{this.switchActiveRWUnit(B);this.switchActiveElem(B);this.attachToolbarEvents();}catch(A){microstrategy.errors.log(A);}};mstrRWUnitBoneImpl.prototype.syncToolbarPos=function(){try{this.computeToolbarPos();moveObjTo(this.toolbar,this.toolbar_pos_x,this.toolbar_pos_y);}catch(A){microstrategy.errors.log(A);}};mstrRWUnitBoneImpl.prototype.attachToolbarEvents=function(){try{this.sibRWUnits=document.getElementsByName(this.RWUnitId);var A=new Function("e","microstrategy.bone('"+this.id+"').onmouseover(e);");var D=new Function("e","microstrategy.bone('"+this.id+"').onmouseout(e); ");for(var B=0;B<this.sibRWUnits.length;B++){this.sibRWUnits[B].onmouseover=A;this.sibRWUnits[B].onmouseout=D;}}catch(C){microstrategy.errors.log(C);}};mstrRWUnitBoneImpl.prototype.sibBoneSelected=function(){try{return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrRWUnitBoneImpl.prototype.getObjSumTopScrolled=function(B){try{var E=getObj(B);var F=0;if(E&&(E.getClientRects||E.getBoundingClientRect)){var A=(self==top)?0:self.screenLeft;if(E.getBoundingClientRect){F=E.getBoundingClientRect().top;}else{F=E.getClientRects()[0].top;}F=F-A-2;F+=getDocumentScrollTop();return Math.round(F);}else{for(var C=0;(E);C++){F+=E.offsetTop;if(E.offsetParent&&E.offsetParent.scrollTop&&E.offsetParent.tagName.toLowerCase()!="html"){F-=E.offsetParent.scrollTop;}E=E.offsetParent;}return parseInt(F);}}catch(D){microstrategy.errors.log(D);return 0;}};mstrRWUnitBoneImpl.prototype.onboneaftermove=function(A,C){try{if(A.indexOf("|"+this.RWUnitId+"|")>-1){if(this.toolbarShown){if(C){this.syncToolbarElem(C);}if(this.toolbarShown){this.syncToolbarPos();}}}}catch(B){microstrategy.errors.log(B);}};mstrRWUnitBoneImpl.prototype.onboneafterresize=function(B){try{if(B.indexOf("|"+this.RWUnitId+"|")>-1){if(this.toolbarShown){this.syncToolbarPos();}}}catch(A){microstrategy.errors.log(A);}};mstrRWUnitBoneImpl.prototype.onboneselected=function(A,C){try{if(!A||A.indexOf("|"+this.RWUnitId+"|")>-1){if(this.showTBSelected&&this.checkToolbarCondition()){this.boneSelected=true;if(C){this.switchActiveRWUnit(C);}if(this.toolbarTimer!=null){window.clearTimeout(this.toolbarTimer);}this.toolbarTimer=this.showToolbarWithDelay(this.TIME_DELAY_SHOW_TOOLBAR_SHORT);}}}catch(B){microstrategy.errors.log(B);}};mstrRWUnitBoneImpl.prototype.onbonedeselected=function(A){try{if(!A||A.indexOf("|"+this.RWUnitId+"|")>-1){this.boneSelected=false;window.clearTimeout(this.toolbarTimer);this.toolbarTimer=this.hideToolbarWithDelay(this.TIME_DELAY_HIDE_TOOLBAR);}}catch(B){microstrategy.errors.log(B);}};mstrRWUnitBoneImpl.prototype.onbonedeleted=function(B){try{if(!B||B.indexOf("|"+this.RWUnitId+"|")>-1){this.boneSelected=false;this.isMouseOver=false;if(this.toolbarShown){this.stickToolbar=false;this.hideToolbar();}}}catch(A){microstrategy.errors.log(A);}};mstrRWUnitBoneImpl.prototype.onmouseover=function(D){try{D=D||window.event;stopEventBubbling(D);var C=getEventTarget(D);if(this.isParentSelected()||!this.checkToolbarCondition()){return ;}if(this.sibRWUnits&&this.sibRWUnits.length>1){var A=microstrategy.findAncestorWithAtt(C,"id",this.id);if(A){this.activeRWUnit=microstrategy.findAncestor(A);}}this.isMouseOver=true;if(this.toolbarTimer!=null){window.clearTimeout(this.toolbarTimer);}this.toolbarTimer=this.showToolbarWithDelay(this.TIME_DELAY_SHOW_TOOLBAR);}catch(B){microstrategy.errors.log(B);}};mstrRWUnitBoneImpl.prototype.hideToolbarOnMouseOut=function(){try{this.isMouseOver=false;if((this.showTBSelected&&this.boneSelected)||!this.checkToolbarCondition()){return ;}window.clearTimeout(this.toolbarTimer);this.toolbarTimer=this.hideToolbarWithDelay(this.TIME_DELAY_HIDE_TOOLBAR);}catch(A){microstrategy.errors.log(A);}};mstrRWUnitBoneImpl.prototype.onmouseout=function(B){try{this.hideToolbarOnMouseOut();}catch(A){microstrategy.errors.log(A);}};mstrRWUnitBoneImpl.prototype.isParentSelected=function(){try{var B=microstrategy.findAncestorBone(this,"mstrPanelStack");return(B&&B.boneSelected);}catch(A){microstrategy.errors.log(A);return false;}};mstrRWUnitBoneImpl.prototype.getDocViewer=function(){try{return this.docViewer;}catch(A){microstrategy.errors.log(A);return false;}};mstrRWUnitBoneImpl.prototype.getDocSelections=function(){try{if(!this.docViewer){this.getDocViewer();}if(this.docViewer&&this.docViewer.doc&&this.docViewer.doc.selections){return this.docViewer.doc.selections;}return null;}catch(A){microstrategy.errors.log(A);return false;}};function mstrRWUnitBoneImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrButtonScript=true;mstrButton.prototype=new mstrBoneImpl();(function(){mstrButton.BUTTON_DEFAULT_SIZES=[,{w:96,h:50},{w:96,h:50},{w:120,h:50},{w:120,h:50},{w:96,h:70},{w:60,h:60}];var B="#CCCCCC",E="#E3E3E3",J="#DEDEDE",G="about:blank";var A=null;mstrButton.prototype.sibs=null;mstrButton.prototype.docViewer=null;mstrButton.prototype.onload=function(){mstrBoneImpl.prototype.onload.call(this);var Q=this.id;this.docViewer=microstrategy.getViewerBone();this.sibs=document.getElementsByName(Q);mstr.controllers.EventManager.attachEventListener(this,this,"Add","onAdd");this.forEachSib(function(R){R.onmousedown=function(S){return microstrategy.bone(Q).onmousedown(S);};R.ondblclick=function(S){return microstrategy.bone(Q).ondblclick(S);};F(R);});};mstrButton.prototype.onAdd=function(V){var S=V.ac,W=V.update,R=V.item,U=microstrategy.styleObj,Q=microstrategy.formatObj,T=this.docViewer.doc;this.updateIcons();T.formatAttribute([R],"DisplayStyle",U.getAttValue(R,microstrategy.HTMLATTR_DISPLAY_STYLE),W,microstrategy.HTMLATTR_DISPLAY_STYLE,S);T.formatSizeMode([R],"heightMode",microstrategy.FIX_MODE,S,W);if(U.getAttValue(R,microstrategy.HTMLATTR_DISPLAY_STYLE)!=microstrategy.BUTTON_STYLE_CUSTOM){T.formatItemBorders([R],["borderLeft","borderRight","borderTop","borderBottom"],"solid","1pt",B,W,S);T.formatItems([R],"backgroundColor",E,W,S);T.formatAttribute([R],"BackgroundHighlightColor",Q.encodeValue("color",J),W,microstrategy.HTMLATTR_BACKGROUND_HIGHLIGHT_COLOR,S);}T.formatItems([R],"whiteSpace","nowrap",W,S);};mstrButton.initHTML=function(Q){addCssClass(Q,"mstrDocButton");Q.innerHTML='<div class="buttonCanvas"><div class="iconCanvas"><div class="iconWrapper"><img /><img class="highlightStateIcon" /></div></div><div class="textCanvas"><div class="textWrapper"><span>'+Q.innerHTML+'</span></div></div></div><div class="buttonEffectOverlay"></div>';};function F(S){var Q=K(S),R=document.createElement("div");R.className="iconCanvasMask";Q.appendChild(R);}mstrButton.prototype.initNewUnit=function(R){try{bone=microstrategy.registerBone(R.id,"mstrButtonScript",null);bone.onload();}catch(Q){microstrategy.errors.log(Q);return false;}};mstrButton.prototype.synchronizeSize=function(){this.forEachSib(function(U){var a=microstrategy.getFormatObject();var S=microstrategy.styleObj;var Q=Number(S.getAttValue(U,microstrategy.HTMLATTR_DISPLAY_STYLE));var g=K(U);var Y=I(U);removeCssClass(U,"mstrDocButton-\\S+");addCssClass(U,"mstrDocButton-"+microstrategy.BUTTON_STYLE_CSS_SUFFIXES[Q]);g.style.fontSize="";Y.style.top="";Y.style.left="";Y.style.right="";switch(Q){case microstrategy.BUTTON_STYLE_CUSTOM:case microstrategy.BUTTON_STYLE_ICON_ONLY:case microstrategy.BUTTON_STYLE_CAPTION_ONLY:return ;}var c=Math.round(parseFloat(S.getValue(U,"width"),10));var V=Math.round(parseFloat(S.getValue(U,"height"),10));var Z=this.docViewer.btncfg[Q];var R=Z.minsp;var X=Z.mincs;var W;switch(Q){case microstrategy.BUTTON_STYLE_ICON_TOP:var e=parseInt(a.decodeValue("height",S.getAttValue(U,microstrategy.HTMLATTR_HEIGHT)));W=Math.floor(Math.max(0,Math.min(0.6*e,V-R-X)));Y.style.top=Math.min(V,W+R)+"px";break;case microstrategy.BUTTON_STYLE_ICON_LEFT:case microstrategy.BUTTON_STYLE_ICON_RIGHT:W=Math.max(0,Math.min(V,c-R-X));var T=Math.min(c,W+R);Y.style[Q==microstrategy.BUTTON_STYLE_ICON_LEFT?"left":"right"]=T+"px";break;}g.style.fontSize=W+"px";});};mstrButton.syncEditHighlight=function(T){var Q=microstrategy.getViewerBone();if(!Q.isEditableViewModeEplus()){return true;}var S=getEventTarget(T||window.event);var R=microstrategy.findAncestor(S);if(Q.doc.isDocButton(R)){if(H(S,R)){M(R,"caption");return ;}else{if(D(S,R)){M(R,"icon");return ;}}}M(null);};mstrButton.prototype.updateFillEffect=function(){this.forEachSib(function(R){var Q=microstrategy.styleObj.getAttValue(R,microstrategy.HTMLATTR_FILL_EFFECT);var S=microstrategy.styleObj.getAttValue(R,microstrategy.HTMLATTR_DISPLAY_STYLE);if(Q==microstrategy.HTMLATTR_EFFECT_GLOSSY&&S!=microstrategy.BUTTON_STYLE_CUSTOM){addCssClass(R,"gloss");}else{removeCssClass(R,"gloss");}});};mstrButton.prototype.updateDisplayStyle=function(Z,T){var X=this.docViewer.doc,W=microstrategy.formatObj,R=this.elem,Y=microstrategy.styleObj.getAttValue(R,microstrategy.HTMLATTR_DISPLAY_STYLE);if(Y==microstrategy.BUTTON_STYLE_CUSTOM){X.formatItemBorders([R],["borderLeft","borderRight","borderTop","borderBottom"],"none","0pt","#000000",T,Z);X.formatItems([R],"backgroundColor","transparent",T,Z);X.formatItems([R],"backgroundStyle","transparent",T,Z);X.formatAttribute([R],"BackgroundHighlightColor",-1,T,microstrategy.HTMLATTR_BACKGROUND_HIGHLIGHT_COLOR,Z);}var V=this.docViewer.btncfg[Y],S={Left:"pl",Right:"pr",Top:"pt",Bottom:"pb"};function U(c,a){X.formatPadding([R],"padding"+c,V[a]*0.75+"pt",T,Z);}for(var Q in S){U(Q,S[Q]);}this.synchronizeSize();this.updateFillEffect();};mstrButton.prototype.updateIcons=function(){this.forEachSib(function(R){var Q=R.getElementsByTagName("img");Q[0].src=microstrategy.styleObj.getAttValue(R,microstrategy.HTMLATTR_NORMAL_URL)||G;Q[1].src=microstrategy.styleObj.getAttValue(R,microstrategy.HTMLATTR_HIGHLIGHT_URL)||Q[0].src;});};mstrButton.updateButtonCaption=function(R,Q){O(R).innerHTML=Q;};mstrButton.prototype.onmousedown=function(R){var T=microstrategy.eventManager.getSource(R);if(T&&T.button==1&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){this.onButtonPressed(T.elem);}var Q=getEventTarget(R),S=this.docViewer.doc.textEditor;if(this.docViewer.isEditableViewModeEplus()&&S.source==T.elem&&S.onblur){S.onblur();}};mstrButton.prototype.onButtonPressed=function(R){var S=microstrategy.styleObj,Q=microstrategy.getFormatObject();this.pressedSibs=this.pressedSibs||[];this.pressedSibs.push(R);this.normalFontColor=S.getValue(R,"color");this.normalBackgroundColor=S.getValue(R,"backgroundColor");addCssClass(R,"mstrDocButton-highlight");S.setValue(R,"backgroundColor",Q.decodeValue("backgroundColor",S.getAttValue(R,microstrategy.HTMLATTR_BACKGROUND_HIGHLIGHT_COLOR)));S.setValue(R,"color",Q.decodeValue("color",S.getAttValue(R,microstrategy.HTMLATTR_FONT_HIGHLIGHT_COLOR)));this.attachWinListener(this,"mouseup","onButtonReleased",true);};mstrButton.prototype.onButtonReleased=function(U){var T=microstrategy.styleObj,S=microstrategy.getFormatObject();for(var R=0;R<this.pressedSibs.length;R++){var Q=this.pressedSibs[R];removeCssClass(Q,"mstrDocButton-highlight");T.setValue(Q,"backgroundColor",this.normalBackgroundColor);T.setValue(Q,"color",this.normalFontColor);}delete this.pressedSibs;this.detachWinListener(this,"mouseup");};mstrButton.prototype.ondblclick=function(R){try{R=R||window.event;if(!this.docViewer.isEditableViewModeEplus()){return true;}var S=microstrategy.findAncestor(getEventTarget(R));this.editContentsOnMouseEvent(R,S);return true;}catch(Q){microstrategy.errors.log(Q);return false;}finally{stopEventBubbling(R);}};mstrButton.prototype.editContents=function(Q,R){if(!this.docViewer.isInteractiveViewModeEplus(Q)){return true;}Q=Q||window.event;if(Q){this.editContentsOnMouseEvent(Q,R);}else{this.docViewer.doc.editText(null,R);}};mstrButton.prototype.editContentsOnMouseEvent=function(R,S){var Q=getEventTarget(R);if(D(Q,S)){this.docViewer.commands.exec("edtPropsTabSelected",microstrategy.PROPERTIES_EDITOR_BUTTON_TAB);return ;}if(H(Q,S)){this.docViewer.doc.editText(R,S);return ;}};mstrButton.prototype.onEditText=function(T,S){M(S,"caption");var R=microstrategy.styleObj.getAttValue(S,microstrategy.HTMLATTR_DISPLAY_STYLE);var Q=I(S);T.style.padding="0";T.style.width=getObjInnerWidth(Q)+"px";T.style.height=getObjInnerHeight(Q)+"px";T.style.backgroundColor="transparent";I(S).style.visibility="hidden";T.style.left=getObjSumLeft(Q)-this.docViewer.doc.left+1+"px";T.style.top=getObjSumTop(Q)-this.docViewer.doc.top+1+"px";T.style.textAlign=(R==microstrategy.BUTTON_STYLE_ICON_LEFT||R==microstrategy.BUTTON_STYLE_ICON_RIGHT)?"left":"center";T.style.textDecoration="none";N(T,R==microstrategy.BUTTON_STYLE_ICON_TOP?"bottom":"middle");};mstrButton.prototype.postEditText=function(R,Q){C(R);I(Q).style.visibility="";};mstrButton.prototype.forEachSib=function(Q){for(var R=0;R<this.sibs.length;R++){Q.call(this,this.sibs[R]);}};function M(R,Q){if(R&&Q!="icon"&&Q!="caption"){return ;}if(A){removeCssClass(A,"captionHighlight");removeCssClass(A,"iconHighlight");}if(R){addCssClass(R,Q+"Highlight");}A=R;}function H(R,Q){return mstr.$D.containsElement(I(Q),R,true);}function D(R,Q){return mstr.$D.findAncestor(R,"className","iconCanvasMask",Q,true);}function I(Q){return Q.getElementsByTagName("div")[0].children[1];}function O(Q){return Q.getElementsByTagName("span")[0];}function K(Q){return Q.getElementsByTagName("div")[0].children[0];}function N(R,Q){P(R,Q);R.onchange=R.oninput=R.propertychange=R.onmouseup=R.onkeyup=R.onkeypress=function(S){S=S||window.event;var T=S.target||S.srcElement;setTimeout(function(){P(T,Q);},0);};}function C(Q){Q.onchange=Q.oninput=Q.propertychange=Q.onmouseup=Q.onkeyup=Q.onkeypress=null;}function P(S,Y){var a=function(c){return parseInt(c,10)||0;};var T=a(S.style.borderTopWidth),X=a(S.style.borderBottomWidth),V=S.offsetHeight-T-X,W=a(S.style.paddingTop),U=a(S.style.paddingBottom),R=V-W-U;var Z;if(bIsIE7){Z=Math.max(0,S.scrollHeight-W-U);}else{S.style.paddingTop="0";S.style.paddingBottom="0";Z=S.scrollHeight;S.style.height=(R+1)+"px";if(S.scrollHeight>Z){S.style.height="0";Z=S.scrollHeight;}}var Q=Math.max(0,V-Z);switch(Y){case"middle":W=Math.floor(Q/2);U=Math.ceil(Q/2);break;case"bottom":W=Q;U=0;break;default:W=0;U=Q;}S.style.paddingTop=W+"px";S.style.paddingBottom=U+"px";S.style.height=(V-W-U)+"px";L(S);}function L(R){var Q=document.documentMode>=8;if(Q){R.style.paddingLeft="0";R.offsetWidth;R.style.paddingLeft="";}}})();function mstrButton(A){mstrBoneImpl.call(this,A);}mstrHorizontalContainerImpl.prototype=new mstrBoneImpl();mstrHorizontalContainerImpl.prototype.path="";mstrHorizontalContainerImpl.prototype.verifiedPath="";mstrHorizontalContainerImpl.prototype.height=-1;mstrHorizontalContainerImpl.prototype.oldHeight=-1;mstrHorizontalContainerImpl.prototype.subSections=null;mstrHorizontalContainerImpl.prototype.titles=null;mstrHorizontalContainerImpl.prototype.subHandles=null;mstrHorizontalContainerImpl.prototype.onload=function(B){try{this.initBone();this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.subSections=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);this.titles=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);this.subHandles=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrHorizontalContainerImpl.prototype.propogateHeightToChildren=function(){try{if(this.height==-1){for(var D=0,B=this.subSections.length;D<B;D++){var E=parseInt(microstrategy.styleObj.getValue(this.subSections[D],"height"));if(E){this.height=E;break;}}}if(this.height!=-1){var A;var I=mstrFormatObject;this.elem.style.height=this.height+"px";if(bIsIE7){var H=this;var G=function(){var J=H.elem.currentStyle.position;H.elem.style.position="absolute";H.elem.style.position=J;};window.setTimeout(G,0);}var F=I.encodeValue("height",this.height);if(this.elem&&this.elem.childNodes&&this.subSections){for(var D=0;D<this.subSections.length;D++){this.subSections[D].style.height=this.height+"px";A=microstrategy.findBone(this.subSections[D]);if(A){this.parentBone.resizeSubMaskForHorizontalContainer&&this.parentBone.resizeSubMaskForHorizontalContainer(this.id,this.height-this.oldHeight,"height");if(this.height>0){this.parentBone.hideSubMaskForHorizontalContainer&&this.parentBone.hideSubMaskForHorizontalContainer(this.id,false);}microstrategy.styleObj.setAttValue(A.elem,microstrategy.HTMLATTR_HEIGHT,F);this.parentBone.parentBone.resize100HMObjects(A.id,this.subSections[D]);}}this.oldHeight=this.height;}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrHorizontalContainerImpl.prototype.adjustSubsectionHeight=function(E){try{var A;var D=mstrFormatObject;if(this.elem&&this.elem.childNodes&&this.subSections){for(var B=0;B<this.subSections.length;B++){A=microstrategy.findBone(this.subSections[B]);if(A&&A.adjustSubsectionHeight){A.adjustSubsectionHeight(E);}}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrHorizontalContainerImpl.prototype.getRightMostPos=function(){try{var A=0;for(var B=0;B<this.subSections.length;B++){A=A+parseInt(microstrategy.styleObj.getValue(this.subSections[B],"width"));}for(var B=0;B<this.titles.length;B++){A=A+getObjWidth(this.titles[B]);}for(var B=0;B<this.subHandles.length;B++){A=A+getObjWidth(this.subHandles[B]);}return A;}catch(C){microstrategy.errors.log(C);return -1;}};mstrHorizontalContainerImpl.prototype.resetHeight=function(){try{this.height=-1;}catch(A){microstrategy.errors.log(A);return -1;}};mstrHorizontalContainerImpl.prototype.onmousedown=function(E){try{if(!E){E=window.event;}var F=getEventTarget(E);var B=this.parentBone.parentBone;var A=microstrategy.findAncestorWithAtt(F,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE);this.currentHCont=microstrategy.findAncestorWithAtt(F,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_PARENT_HORIZONTAL_CONTAINER);var C=microstrategy.eventManager.getSource(E);if(this.currentHCont){this.prevSec=this.currentHCont.previousSibling;}if(C&&C.button==2){}else{if(!B.isFeatureAvailable(microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE)){return true;}if(A&&((icon=microstrategy.subObjectFind(this.prevSec,["IMG"],"cimg"))&&icon.src.indexOf("treeCollapse.gif")>-1)||microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondragstart");this.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondragstart(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}}this.parentBone.selections.clear();}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrHorizontalContainerImpl.prototype.ondragstart=function(D){try{if(!D){D=window.event;}if(D.e){D=D.e;}getMouse(D);if(this.currentHCont){var C=this.parentBone.elem;var E=microstrategy.objectListFind(this.prevSec,["DIV"],microstrategy.OBJTYPE_DOC_SUBSECTION_CONTAINER);if(E==null||E.length==0){return true;}var A=E[E.length-1];this.prevSubElem=A.lastChild;this.prevRuler=A.firstChild;this.prevSubBone=microstrategy.findBone(this.prevSubElem);if(this.prevSubBone){this.prevSubBone.oldHeight=getObjHeight(this.prevSubElem);this.prevSubBone.oldCanGrow=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_GROW);this.prevSubBone.oldCanShrink=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_SHRINK);this.prevSubBone.oldHideIfEmpty=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);}if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondrag");this.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondragend(e); }");}this.ondrag(D);}}catch(B){microstrategy.errors.log(B);}return false;};mstrHorizontalContainerImpl.prototype.ondrag=function(C){try{if(!C){C=window.event;}if(C.e){C=C.e;}getMouse(C);var B=this.parentBone.parentBone.elem.scrollTop;if(this.prevSubElem){var D=lMouseY+B-getObjSumTop(this.currentHCont);var E=getObjHeight(this.prevSubElem)+D;if(E>=0){if(this.prevRuler){this.prevRuler.style.height=E+"px";}this.prevSubElem.style.height=E+"px";}}}catch(A){microstrategy.errors.log(A);}return false;};mstrHorizontalContainerImpl.prototype.ondragend=function(C){try{if(!C){C=window.event;}if(C.e){C=C.e;}this.prevSubBone.resize(getObjHeight(this.prevSubElem),true,null);this.onmouseup(C);var B=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.parentBone.parentBone.formattingAttributes;if(B){var D=this.prevSubBone.id;B[D][microstrategy.HTMLATTR_CAN_SHRINK]=microstrategy.FALSE;B[D][microstrategy.HTMLATTR_CAN_GROW]=microstrategy.FALSE;B[D][microstrategy.HTMLATTR_HIDE_IF_EMPTY]=microstrategy.FALSE;}}catch(A){microstrategy.errors.log(A);}return false;};mstrHorizontalContainerImpl.prototype.onmouseup=function(B){try{if(typeof (mstr)!="undefined"){this.detachWinListener(this,"mousemove");this.detachWinListener(this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(A){microstrategy.errors.log(A);}return false;};mstrHorizontalContainerImpl.prototype.getLastNonCollapsedSection=function(C){try{var E=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION);if(E){for(var A=E.length-1;A>=0;A--){var D=microstrategy.findBone(E[A]);if(D.isCollapsed==false){return E[A];}}}return null;}catch(B){microstrategy.errors.log(B);}return false;};function mstrHorizontalContainerImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrPickerImplScript=true;mstrPickerImpl.prototype=new mstrBoneImpl();mstrPickerImpl.prototype.pulldownName="";mstrPickerImpl.prototype.targetCombodown="";mstrPickerImpl.prototype.onload=function(){try{this.currentPicker=null;this.initPulldown();}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.initPulldown=function(){var C=new Function("e","return microstrategy.bone('"+this.id+"').togglePicker(e);");var B=document.getElementById(this.pulldownName);if(!B){return ;}for(var A=0;A<B.childNodes.length;A++){if(B.childNodes[A].tagName&&B.childNodes[A].tagName.toLowerCase()=="span"){B.childNodes[A].onclick=C;}}};mstrPickerImpl.prototype.execPicker=function(C,F){try{var E=true;var B=this.getAppliesTo();var G=F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!G){G=C.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);}var A=F.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!A){A=C.getAttribute(microstrategy.HTMLATTR_CMD_ID);}if(B&&A&&B.commands.queryEnabled(A)){E=B.commands.exec(A,G);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrPickerImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.togglePicker=function(E){try{if(!E){E=window.event;}var D=getEventTarget(E);var B="";if(D.getAttribute(microstrategy.HTMLATTR_CMD_ID)==null){this.targetCombodown=findTarget(D,microstrategy.HTMLATTR_CMD_ID);B=findTarget(D,microstrategy.HTMLATTR_CMD_ID).className;}else{B=D.className;}if(D&&B.indexOf("disabled")==-1){var F=D.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);if(!F){F=D.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);}var A=document.getElementById(F);if(D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){if(B.indexOf("Selected")==-1){this.targetCombodown.className="mstrCombodownSelected";}dropDown.togglePicker(true,F,D.parentNode,this);}else{this.execPicker(A,D);}}}catch(C){microstrategy.errors.log(C);}return false;};mstrPickerImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);this.targetCombodown.className="mstrCombodown";return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);alert(A);}};mstrPickerImpl.setPickerValues=function(D,F,G){try{if(D){D="pkr"+D;}var J=F.getElementsByTagName("span");for(var E=0,B=J.length;E<B;E++){var H=J[E];var I=true;if(G){I=microstrategy.isValueInFilter(G,H.getAttribute(microstrategy.HTMLATTR_FILTER_VALUE),H.getAttribute(microstrategy.HTMLATTR_FILTER_COMPARISON));var A=H.getAttribute(microstrategy.HTMLATTR_FILTER_TYPE);if(!A||A==0){H.style.display=(I)?"block":"none";}else{H.className=(I)?"":"disabled";}}if(I&&H.getAttribute("id")==D){H.className="selected";F.selected=H;}}}catch(C){microstrategy.errors.log(C);}};function mstrPickerImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrUpdateManager.prototype=new Object;mstrUpdateManager.prototype.id="bonesUpdateManager";mstrUpdateManager.prototype.observer=null;mstrUpdateManager.prototype.actions={};mstrUpdateManager.prototype.redoActions=[];mstrUpdateManager.prototype.undoActions=[];mstrUpdateManager.prototype.staticActions=[];mstrUpdateManager.prototype.useIframe=false;mstrUpdateManager.prototype.newWindow=false;mstrUpdateManager.prototype.newWindowName="_blank";mstrUpdateManager.prototype.extraURL="";mstrUpdateManager.prototype.iframeTarget="frameManager";mstrUpdateManager.prototype.formAction="";mstrUpdateManager.prototype.OPTIMIZE_EVENTS=true;mstrUpdateManager.prototype.ADD_EVENT_IDS=null;mstrUpdateManager.prototype.optActions=[];mstrUpdateManager.prototype.lastPosArray=[];mstrUpdateManager.prototype.copyActions={};mstrUpdateManager.prototype.cachedActionCollection=null;mstrUpdateManager.prototype.queueActions=false;mstrUpdateManager.prototype.forceSubmitAfterQueue=false;mstrUpdateManager.prototype.ctlCurElementsPosition=null;mstrUpdateManager.prototype.currentPanelPosition=null;mstrUpdateManager.prototype.hiddenInputs=null;mstrUpdateManager.prototype.submittedForm=null;mstrUpdateManager.prototype.submittedXhr=false;mstrUpdateManager.prototype.newActions=false;mstrUpdateManager.prototype.sTimeOutID=null;mstrUpdateManager.prototype.callback=null;mstrUpdateManager.UNIT_SEPARATOR=",";mstrUpdateManager.ITEM_SEPARATOR=";";mstrUpdateManager.UPDATE_LATER="0";mstrUpdateManager.UPDATE_NOW="1";mstrUpdateManager.STATIC_ACTION=-1;mstrUpdateManager.ARG_KEY_SEPARATOR="_";mstrUpdateManager.addEvent=function(A){if(!mstrUpdateManager.actions){mstrUpdateManager.actions={};}for(var B in A){var C=A[B].i;mstrUpdateManager[B]=C;mstrUpdateManager.actions[C]={eventID:C,paramName:A[B].n,paramID:A[B].p};}mstrUpdateManager.newActions=true;};mstrUpdateManager.prototype.addSingleAction=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection.push(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getUseIFrame=function(){try{return this.useIframe;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setUseIFrame=function(B){try{this.useIframe=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getNewWindowSetting=function(){try{return this.newWindow;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setNewWindowSetting=function(B){try{this.newWindow=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.addActionCollection=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection=this.cachedActionCollection.concat(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.hasCachedActions=function(){try{return(this.cachedActionCollection&&this.cachedActionCollection.length>0);}catch(A){microstrategy.errors.log(A);}return false;};mstrUpdateManager.prototype.addCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.add(this.cachedActionCollection,false);this.cachedActionCollection=null;if(this.forceSubmitAfterQueue){this.flushAndSubmitChanges();}}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.killCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.cachedActionCollection=null;}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.add=function(C,A){try{if(this.queueActions){if(C.length){this.addActionCollection(C);}else{this.addSingleAction(C);}}else{if(A){this.staticActions.push(C);this.redoActions.unshift(mstrUpdateManager.STATIC_ACTION);this.newActions=true;}else{this.clearRedoActions();this.undoActions.push(C);this.newActions=true;}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","add",C);if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.addURL=function(A){try{if(A){if(this.extraURL.length>0){this.extraURL+="&"+A;}else{this.extraURL=A;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.replaceURL=function(A,D){try{if(this.extraURL.length>0){if(this.extraURL.indexOf(A)>-1){var E=this.extraURL.substring(0,this.extraURL.indexOf(A)-2);var C=this.extraURL.indexOf("&",this.extraURL.indexOf(A));if(E==null||E.length==0){E="";}else{E+="&";}if(C>this.extraURL.indexOf(A)){this.extraURL=E+this.extraURL.substring(C+1,this.extraURL.length)+"&"+A+"="+D;}else{this.extraURL=A+"="+D;}}else{this.extraURL+="&"+A+"="+D;}}else{this.extraURL=A+"="+D;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.processUndoRedo=function(C,D){try{while(C.length>0){var B=C.pop();D.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;}}}catch(A){microstrategy.errors.log(A);}return null;};mstrUpdateManager.prototype.broadcastUpdate=function(){try{while(source.length>0){var B=source.pop();target.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;break;}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.undo=function(C){try{var D=false;C=C||1;for(var A=0;A<C;A++){var F=this.processUndoRedo(this.undoActions,this.redoActions);if(F){for(var B=0;B<F.length;B++){microstrategy.eventManager.notifyOrphanBones("onundo",new mstrUndoObj(F[B]));}D=true;}}if(D){microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","undo");}if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.redo=function(){try{var C=this.processUndoRedo(this.redoActions,this.undoActions);if(C){for(var A=0;A<C.length;A++){microstrategy.eventManager.notifyOrphanBones("onredo",new mstrRedoObj(C[A]));}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","redo");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.getPendingEventsForTask=function(A){var E;var J;var B=0;var N=[];var D=A.split(".");var C=D[D.length-1];var F=this.optActions;this.optActions=[];if(this.OPTIMIZE_EVENTS){for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;this.createOptimizedArray(H);G.splice(M,1);M=M-1;}}}for(var I=0;I<this.optActions.length;I++){if(this.optActions[I].id!=null){N.push(this.createEventForAction(this.optActions[I]));}}this.postOptimizationCleanup();}else{for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;N.push(this.createEventForAction(H));G.splice(M,1);M=M-1;}}}}this.optActions=F;if(N.length>0){var L=new mstrSerializer();L.addValues(N);return L.getState();}else{return"";}};mstrUpdateManager.prototype.flushChanges=function(I){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){addURLAsHiddenInputsToForm(I,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){this.createOptimizedArray(D[H]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){J.push(this.createEventForAction(D[H]));}}}var G=new mstrSerializer();G.addValues(J);if(I.getAttribute("hasUpdateChanges")=="true"){updateDynamicInput(I,mstrUpdateManager.multipleEventArgName,G.getState());}else{this.submittedForm=I;this.hiddenInputs=[];this.createHiddenInput(I,mstrUpdateManager.multipleEventArgName,G.getState());this.createHiddenInput(I,"evt",mstrUpdateManager.multipleEventID);this.createHiddenInput(I,"src",mstrUpdateManager.multipleEventSrc);this.createHiddenInput(I,mstrUpdateManager.multipleEventID,"1");I.setAttribute("hasUpdateChanges","true");}if(this.newWindow){I.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.flushChangesAsParams=function(G){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){UpdateHelper.addURLToParams(G,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){this.createOptimizedArray(D[I]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){J.push(this.createEventForAction(D[I]));}}}var H=new mstrSerializer();H.addValues(J);if(G.hasUpdateChanges=="true"){G[mstrUpdateManager.multipleEventArgName]=H.getState();}else{this.submittedXhr=true;UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventArgName,H.getState());UpdateHelper.addAdditionalParam(G,"evt",mstrUpdateManager.multipleEventID);UpdateHelper.addAdditionalParam(G,"src",mstrUpdateManager.multipleEventSrc);UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventID,"1");G.hasUpdateChanges=="true";}if(this.newWindow){G.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.createHiddenInput=function(D,B,C){var A=createHiddenInput(D,B,C);this.hiddenInputs.push(A);};mstrUpdateManager.prototype.postOptimizationCleanup=function(A){if(this.fullScreenModePosition){delete this.fullScreenModePosition;}if(this.lTbarBrowserSettingPosition){delete this.lTbarBrowserSettingPosition;}if(this.ctlCurElementsPosition){delete this.ctlCurElementsPosition;}if(this.currentPanelPosition){delete this.currentPanelPosition;}if(this.widgetPropEdits){delete this.widgetPropEdits;}this.optActions=[];this.lastPosArray=[];};mstrUpdateManager.prototype.createEventForAction=function(G){try{var A=mstrUpdateManager.actions[G.id];var E=new mstrSerializer();E.addStr(A.eventID);E.addStr(G.beanPath+"."+A.eventID);var D="";for(var C=0;C<G.newArgs.length;C++){actionID=G.argID[C];for(var B=0;B<A.paramID.length;B++){if(A.paramID[B]==actionID){if(false){D+="<arg name='"+A.paramName[B]+"' v='"+G.newArgs[C]+"' />";}if(G.argKey==null){E.addStr(A.paramName[B]);}else{E.addStr(A.paramName[B]+mstrUpdateManager.ARG_KEY_SEPARATOR+G.argKey);}E.addStr(G.newArgs[C]);break;}}}if(false){alert(D);}return E.getState();}catch(F){microstrategy.errors.log(F);return false;}};mstrUpdateManager.prototype.flushAndSubmitChanges=function(C,H){this.callback=H||{};var B=this,G=this.callback.success,F=this.callback.noRefresh;this.callback.success=function(I){if(G){G(I);}if(!F&&I&&I.status=="6"){B.refreshPage();}};try{if(useXHR&&!C){mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var A=UpdateHelper.createParamsFromURL(this.getFormAction(),this.useIframe&&!this.newWindow);this.flushing=true;UpdateHelper.submitRequest(A);}else{mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var D=createDynamicForm(this.getFormAction());if(this.useIframe&&!this.newWindow){addURLAsHiddenInputsToForm(D,"iframe=true");D.target=this.iframeTarget;}this.flushing=true;submitForm(D,C);}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.acknowledgeRequest=function(){try{this.undoActions=[];this.redoActions=[];this.staticActions=[];this.optActions=[];this.lastPosArray=[];this.copyActions={};this.newWindow=false;microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}var B;if(this.submittedForm!=null){for(var A=0;A<this.hiddenInputs.length;A++){B=this.hiddenInputs[A];try{this.submittedForm.removeChild(B);}catch(C){if((C&&C.code!=8)&&(C.number&&C.number!=-2147024809)){throw (C);}}}this.submittedForm.setAttribute("hasUpdateChanges","false");this.submittedForm=null;this.hiddenInputs=null;this.flushing=false;}if(this.submittedXhr){this.submittedXhr=false;this.flushing=false;}}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.isFlushing=function(){return !!this.flushing;};mstrUpdateManager.prototype.acknowledgeReloadEnd=function(){if(this.observer){this.observer.notifyAll("acknowledgeReloadEnd");}};mstrUpdateManager.prototype.getFixStateActions=function(){try{var E=[];for(var B=0;B<this.staticActions.length;B++){var D=this.staticActions[B];for(var A=0;A<D.length;A++){E.push(D[A]);}}return E;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.hasChangesToSubmit=function(){try{return(this.undoActions.length>0||this.isRedoStatic()||(this.extraURL!=null&&this.extraURL.length>0));}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.hasNewChanges=function(){try{var A=this.newActions;this.newActions=false;return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.clearRedoActions=function(){try{while(this.redoActions.length>0){var B=this.redoActions.pop();if(B==mstrUpdateManager.STATIC_ACTION){this.undoActions.push(B);}}}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.getLastAction=function(){try{return this.undoActions.pop();}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.isRedoStatic=function(){try{var C=false;for(var A=0;A<this.redoActions.length;A++){if(this.redoActions[A]==mstrUpdateManager.STATIC_ACTION){C=true;break;}}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.anyNonStatic=function(B){try{var A=(B)?this.redoActions:this.undoActions;var E=false;for(var C=0;C<A.length;C++){if(A[C]!=mstrUpdateManager.STATIC_ACTION){E=true;break;}}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createActionObject=function(C,A,G,H,B,F,J,I){try{var E={};E.elem=C;E.id=A;E.beanPath=G;E.argID=H;E.newArgs=B;E.oldArgs=F;E.cachedArray=J;E.argKey=I;if(A==mstrUpdateManager.EDIT_PROPS){E.formatType=microstrategy.formatType;E.argID.push("2048131");E.newArgs.push(microstrategy.formatType);E.oldArgs.push(microstrategy.formatType);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createOptimizedArray=function(G){try{var I=G.id;if(!this.ADD_EVENT_IDS){this.ADD_EVENT_IDS=mstrUpdateManager.ADD_TEXT+"|"+mstrUpdateManager.ADD_LINE+"|"+mstrUpdateManager.ADD_SHAPE+"|"+mstrUpdateManager.ADD_TEMPLATE+"|"+mstrUpdateManager.ADD_DATASET_TEMPLATE+"|"+mstrUpdateManager.ADD_IMAGE+"|"+mstrUpdateManager.ADD_HTML_CONTAINER+"|"+mstrUpdateManager.ADD_PANEL_STACK+"|"+mstrUpdateManager.CTRL_ADD+"|";}var N=(G.elem)?G.elem.id:null;var B=N;if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="4146"){B=N+G.newArgs[K].split("!")[0]+G.newArgs[K].split("!")[1]+G.newArgs[K].split("!")[2];break;}}}var P;if(I==mstrUpdateManager.EDIT_PROPS){for(var K=0,D=G.argID.length;K<D;K++){if(G.argID[K]=="2048035"){var J=G.newArgs[K].split(mstrUpdateManager.UNIT_SEPARATOR);if(J[1]=="FormattingWidget"&&J[2]=="WidgetProps"){var C=this.widgetPropEdits||{};if(J[0] in C){this.optActions[C[J[0]]].id=null;}C[J[0]]=this.optActions.length;this.widgetPropEdits=C;}break;}}this.optActions.push(G);}else{if(I==mstrUpdateManager.COPY_TO_CLIPBOARD||I==mstrUpdateManager.CUT_TO_CLIPBOARD){P=G.newArgs[0].split(CLIPBOARD_ITEM_SEPARATOR);for(var K=0;K<P.length;K++){this.copyActions[P[K]]={};this.copyActions[P[K]].position=this.optActions.length;this.copyActions[P[K]].applied=false;}this.optActions.push(G);}else{if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES||I==mstrUpdateManager.EDIT_TEXT||I==mstrUpdateManager.SET_TOPLEFT_POSITION||I==mstrUpdateManager.CHANGE_BONE_PROPERTY){if(!this.lastPosArray[I]){this.lastPosArray[I]={};}if(this.copyActions[N]&&this.copyActions[N].applied==false){this.copyActions[N].applied=true;for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}else{if(this.lastPosArray[I][B]){var L=this.lastPosArray[I][B].position;var F=this.optActions[L];var H=mstr.$A.find(F.argID,"2048007");if(H==-1){H=null;}var M=mstr.$A.find(F.argID,"2048007");if(M==-1){H=null;}if(M==H){F.newArgs=G.newArgs;}else{this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}else{this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}}else{if(I==mstrUpdateManager.REMOVE_OBJECT){if(this.copyActions[N]){for(var K=this.copyActions[N].position;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N){this.optActions[K].id=null;}}delete this.copyActions[N];for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}}else{for(var K=0;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N&&!this.ADD_EVENT_IDS.contains(this.optActions[K].id,"|")){this.optActions[K].id=null;}}}this.optActions.push(G);}else{if(I==mstrUpdateManager.SWITCH_FULL_SCREEN_MODE){if(typeof (this.fullScreenModePosition)!="undefined"&&this.optActions[this.fullScreenModePosition]&&this.optActions[this.fullScreenModePosition].newArgs&&this.optActions[this.fullScreenModePosition].id==I){this.optActions[this.fullScreenModePosition].newArgs=G.newArgs;}else{this.fullScreenModePosition=this.optActions.length;this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING){if(G.argID[0]=="5005"&&G.newArgs[0]=="lTbar"){if(typeof (this.lTbarBrowserSettingPosition)!="undefined"&&this.optActions[this.lTbarBrowserSettingPosition]&&this.optActions[this.lTbarBrowserSettingPosition].newArgs){this.optActions[this.lTbarBrowserSettingPosition].newArgs=G.newArgs;}else{this.lTbarBrowserSettingPosition=this.optActions.length;this.optActions.push(G);}}else{this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_CUR_CTL_ELEMENTS){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="2048130"){this.ctlCurElementsPosition=this.ctlCurElementsPosition||{};var A=G.newArgs[K];if(A in this.ctlCurElementsPosition){this.optActions[this.ctlCurElementsPosition[A]].id=null;}this.ctlCurElementsPosition[A]=this.optActions.length;this.optActions.push(G);break;}}}else{if(I==mstrUpdateManager.SET_CURRENT_PANEL){var O=G.newArgs[0];if(!this.currentPanelPosition){this.currentPanelPosition={};}if(typeof (this.currentPanelPosition[O])!="undefined"){this.optActions.splice(this.currentPanelPosition[O],1);}this.currentPanelPosition[O]=this.optActions.length;this.optActions.push(G);}else{this.optActions.push(G);}}}}}}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.getFormAction=function(){if(!this.formAction){this.formAction=microstrategy.servletName;}return this.formAction;};mstrUpdateManager.prototype.setFormAction=function(A){this.formAction=A;};mstrUpdateManager.createPropertyEditString=function(C,B,G,A,H){try{var F=mstrFormatObject;if(!F){return"";}if(!A){G=F.encodeValue(B,G);}var D=C||"";if(D){D+=mstrUpdateManager.UNIT_SEPARATOR;}return D+(H||F.getPropertySetName(B))+mstrUpdateManager.UNIT_SEPARATOR+F.getPropertyName(B)+mstrUpdateManager.UNIT_SEPARATOR+G+mstrUpdateManager.ITEM_SEPARATOR;}catch(E){microstrategy.errors.log(E);return"";}};mstrUpdateManager.prototype.createEditPropsAction=function(F,J,S,I,Q,D,A,L,K,R){try{var E=(A)?mstrUpdateManager.UPDATE_NOW:mstrUpdateManager.UPDATE_LATER;var M=mstrUpdateManager.createPropertyEditString;var O=K?"1":"0";var H="",C="";for(var N=0;N<I.length;N++){H+=M(J,I[N],Q[N],R);if(D&&(N in D)){C+=M(J,I[N],D[N]);}}var B=K?["2048018","2048035","2048241"]:["2048018","2048035"],G=K?[E,H,O]:[E,H];return this.createActionObject(F,mstrUpdateManager.EDIT_PROPS,S,B,G,(C&&[E,C])||[],L);}catch(P){microstrategy.errors.log(err);return null;}};mstrUpdateManager.prototype.findRwbInputOnPageStateForm=function(){var C=getObj("pageStateForm");var B=C.getElementsByTagName("INPUT");for(i=0,cnt=B.length;i<cnt;i++){var A=B[i];if(A.name==="rwb"){return A;}}return null;};mstrUpdateManager.prototype.getRWBState=function(A){if(A){var B=this.findRwbInputOnPageStateForm();if(B){return B.value;}}else{if(pageState){var C=(pageState+"&").match(/rwb=(.*?)\&/);if(C!=-1){return C[1];}}}return"";};mstrUpdateManager.prototype.setRWStateInForm=function(A){var B=this.findRwbInputOnPageStateForm();if(B){B.value=A;}};mstrUpdateManager.prototype.refreshPage=function(){try{this.useIframe=false;var B=this.createActionObject(null,mstrUpdateManager.PAGE_REFRESH,microstrategy.servletName+"."+microstrategy.pageName,[],[],[],null);this.add([B],true);this.flushAndSubmitChanges();}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.submitPartialUpdate=function(C){try{microstrategy.puStatus=0;iframe.notifyParent(true);if(!this.partialUpdateModel){this.partialUpdateModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.partialUpdateModel);var A=this.partialUpdateModel&&this.partialUpdateModel&&this.partialUpdateModel.init();if(!("id" in this)||!mstr.$obj(this.id)){mstr.controllers.Factory.add(this);}this.partialUpdateModel.attachEventListener(this,"set_readyState","handleStateChange");}C.processorClass=mstr.http.PUProcessor;this.partialUpdateModel.execSubmit({params:C,callback:this.callback});}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.handleStateChange=function(evt){try{switch(evt.memo.value){case mstr.Enum.Widget.READYSTATE.TIMEOUT:case mstr.Enum.Widget.READYSTATE.ERROR:break;case mstr.Enum.Widget.READYSTATE.SUCCESS:var updateResult=evt.src.get("requestContext").response.data;if(updateResult){if(updateResult.status=="2"){iframe.showWaitPage();}else{iframe.hideWaitPage();}UpdateHelper.replaceComponents(updateResult.components);document.title=updateResult.title;if(updateResult.status=="2"){this.doRedirect(updateResult.redirectURL,updateResult.waitSeconds);}microstrategy.eventManager.executeFunction("microstrategy.eventManager.onreload()");if(updateResult.script){eval(updateResult.script);}microstrategy.puStatus=1;}else{if(window.document.readyState=="complete"){var sMarkup=evt.src.get("requestContext").response.text;if(bIsIE6&&!bIsIE7){document.write(sMarkup);}else{var oNewDoc=window.document.open("text/html");if(sMarkup.indexOf("<!DOCTYPE")==-1){oNewDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd " >');}oNewDoc.write(sMarkup);oNewDoc.close();}}}delete this.callback;break;}}catch(err){microstrategy.errors.log(err);}};mstrUpdateManager.prototype.doRedirect=function(C,A){try{this.sTimeOutID=window.setTimeout('microstrategy.updateManager.timedRedirect("'+C+'")',A*1000);}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.timedRedirect=function(C){try{window.clearTimeout(this.sTimeOutID);var A=UpdateHelper.createParamsFromURL(C);UpdateHelper.submitRequest(A);}catch(B){microstrategy.errors.log(B);}};function mstrUpdateManager(){this.commands=new UpdateManagerCommands(this);if(typeof (mstrObserverImpl)!="undefined"){this.observer=new mstrObserverImpl();}return this;}if(typeof (microstrategy)!="undefined"){microstrategy.updateManager=new mstrUpdateManager();}mstrUndoObj.prototype={};function mstrUndoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.oldArgs;this.cachedArray=A.cachedArray;return this;}mstrRedoObj.prototype={};function mstrRedoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.newArgs;this.cachedArray=A.cachedArray;return this;}function UpdateManagerCommands(A){this.queryVisible=function(B){return true;};this.queryEnabled=function(B){switch(B){case"redo":return A.anyNonStatic(true);case"undo":return A.anyNonStatic(false);case"apply":return A.hasChangesToSubmit();default:return false;}};this.queryState=function(B){return false;};this.exec=function(B,C){switch(B){case"redo":return A.redo();case"undo":return A.undo();case"apply":A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return A.flushAndSubmitChanges();default:return false;}};return this;}var UpdateHelper=new function(){};UpdateHelper.prototype=new Object();UpdateHelper.createParamsFromURL=function(B,G){var C={method:"post"};var H=B.indexOf("?")>0;var F=B.indexOf("#")>0;var E=(B.indexOf("iframe=true")>0||G);var D=((H)?B.substring(0,B.indexOf("?")):B);if(F){var A="";B=moveAnchor(B);A=B.substring(B.indexOf("#"));D=D.replace(A,"")+A;B=B.substring(0,B.indexOf("#"));}D=microstrategy.addJSessionID(D);if(H){UpdateHelper.addURLToParams(C,B);}C.iframe=(E)?"true":"false";C.action=D;return C;};UpdateHelper.createParamsFromForm=function(I,J,F,H){var G=getObj(I);var C=microstrategy.findChildrenWithAtt(G,["INPUT","SELECT","TEXTAREA"],"name");var B={action:G.action,method:G.method};if(typeof G.target!=undefined){B.target=G.target;}for(var D=0;D<C.length;D++){var A=C[D];if(H===true&&A.ps===true){continue;}if(A.type=="select-multiple"&&A.options&&A.options.length>0&&A.disabled!=true){for(var E=0;E<A.options.length;E++){if(UpdateHelper.shouldSubmit(A.options[E])){UpdateHelper.addAdditionalParam(B,A.name,A.options[E].value);}}}else{if(UpdateHelper.shouldSubmit(A)){UpdateHelper.addAdditionalParam(B,A.name,A.value);}}}if(J){B[J]=F;}return B;};UpdateHelper.shouldSubmit=function(A){if(A.disabled==true){return false;}if(A.type=="submit"||A.type=="button"||A.type=="image"||A.value=="undefined"){return false;}if(A.type=="radio"||A.type=="checkbox"){if(!A.getAttribute("agg")){return A.checked;}else{A.value=A.checked?"true":"false";return true;}}if(A.tagName.toLowerCase()=="option"){return A.selected;}return true;};UpdateHelper.addURLToParams=function(D,F,C){F=F.substring(F.indexOf("?")+1,F.length);var G=F.split("&");var I="";var E="";var A="";var H=/\+/g;for(var B=0;B<G.length;B++){I=G[B].split("=");E=I[0];A=I[1];if(A){A=decodeURIComponent(A.replace(H," "));}if(C){D[E]=A;}else{UpdateHelper.addAdditionalParam(D,E,A);}}return false;};UpdateHelper.addAdditionalParam=function(A,B,C){if(A[B]&&typeof A[B]!="object"){A[B]=[A[B],C];}else{if(A[B]&&A[B].push){A[B].push(C);}else{A[B]=C;}}};UpdateHelper.submitRequest=function(H){var N=getObj("pageStateForm");var E=null;var I=null;var G;var F;var C;var O;UpdateHelper.appendPageStateToParams(H);if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){var L=microstrategy.bones.rwb_viewer;H.docSelections=L.commands.queryState("selectionsKey");L.adjustScrollValues();H.viewerScroll=L.dScrollTop+","+L.dScrollLeft;H.isLocked=(L.insertionControlLocked)?1:0;var M=L.doc.currentControlSubtype?"|"+L.doc.currentControlSubtype:"";H.currentControl=L.doc.currentControl+M;}if(typeof (microstrategy)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){for(var A in microstrategy.bones){if(microstrategy.bones[A]!=null&&microstrategy.bones[A].type==microstrategy.OBJTYPE_GRID){var B=microstrategy.bones[A];if(B&&B.gridStructureInfo&&!B.gridStructureInfo.emptyCase&&!B.gridStructureInfo.isEmptyTemplate){if(B.isGrid){var K=B.commands.queryState("selections");if(K){H[B.id]=K;}}if(B.isGraph&&A.indexOf("_graph")==-1){H[B.id+"_gs"]=B.commands.queryState("graphSelections");}}}}}if(H.iframe=="true"){microstrategy.updateManager.submitPartialUpdate(H);}else{var J=UpdateHelper.createFormFromParams(H);UpdateHelper.appendPageSizeToParams(J);if(mstr.utils.ISSAFARI&&J.target=="_blank"){J.action+=(J.action.indexOf("?")==-1?"?":"&");J.action+="t="+new Date().getTime();}try{microstrategy.submitForm(J);}catch(D){if(J.target!=""&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){showMessage({contents:microstrategy.descriptors.getDescriptor("5877"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.errors.log(D);}}}return false;};UpdateHelper.createFormFromParams=function(A){var C=document.createElement("FORM");C.name="dynamic_form";C.method=A.method;delete A.method;C.action=A.action;delete A.action;if(typeof A.target!="undefined"){C.target=A.target;delete A.target;}C.setAttribute("hasUpdateChanges",A.hasUpdateChanges=="true");for(var D in A){if(A[D]){if(typeof A[D]=="object"){for(var B=0;B<A[D].length;B++){if(A[D][B]){createHiddenInput(C,D,A[D][B]);}}}else{createHiddenInput(C,D,A[D]);}}}document.body.insertAdjacentElement("beforeEnd",C);return C;};UpdateHelper.submitFormThroughXHR=function(B,D){if(D){if(!B){B=window.event;}var B=getEventTarget(B);if(!B){return false;}}var F=microstrategy.findAncestorWithTag(B,"FORM");var C=B.name;var A=B.value;if(typeof F=="undefined"||typeof C=="undefined"||typeof A=="undefined"){return false;}var E=UpdateHelper.createParamsFromForm(F,C,A,true);UpdateHelper.appendPageStateToParams(E);microstrategy.updateManager.submitPartialUpdate(E);return false;};UpdateHelper.appendPageStateToParams=function(A){var E=getObj("pageStateForm");var D=null;var B=(typeof (microstrategy)!="undefined")?microstrategy.updateManager:null;var C;if(B&&B.hasChangesToSubmit()){B.flushChangesAsParams(A);UpdateHelper.addEvtOrderToParams(A,mstrUpdateManager.multipleEventID);}if(E){if(A.method=="get"||A.method=="GET"){UpdateHelper.addURLToParams(A,pageState,true);}else{D=E.getElementsByTagName("INPUT");for(C=0;C<D.length;C++){A[D[C].name]=D[C].value;}}}};UpdateHelper.appendPageSizeToParams=function(A){createHiddenInput(A,"innerWidth",getClientWidth());createHiddenInput(A,"innerHeight",getClientHeight());};UpdateHelper.submitLink=function(F){var H;H=F.href;var C;C=F.target;var G=document.getElementById("cssAnalyzerToolbar");var A=(getCookie(ENABLE)=="true")&&(G!=null);if(A){return false;}window.mstrSubmitLink=true;if(C=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){var B=UpdateHelper.createParamsFromURL(H);if(C){B.target=C;}UpdateHelper.submitRequest(B);return false;}if(typeof (pageState)!="undefined"){var D=updateLink(H);D=moveAnchor(D);var E=null;if(bIsIE6&&F.childNodes&&(F.childNodes.length==1)&&F.childNodes[0].nodeType==3){E=F.innerHTML;}F.href=D;if(bIsIE6&&E!=null){F.innerHTML=E;}return true;}else{return true;}};UpdateHelper.addEvtOrderToParams=function(A,B,C){if(A.evtorder){if(A.evtorder.indexOf(B)<0){if(C){A.evtorder=A.evtorder+","+B;}else{A.evtorder=B+","+A.evtorder;}A[B]="1";}}else{A.evtorder=B;if(A.evt&&A.evt.length<3){for(j=0;j<A.evt.length;j++){A[A.evt[j]]="1";}}}};UpdateHelper.replaceComponents=function(A,G){try{if(!G){iframe.consolidatedStyles={};iframe.isProcessing=true;if(!bIsW3C){iframe.togglePulldownChildren(document.body,false);}}var C;for(C=0;C<A.length;C++){var F=A[C];if(F&&F.ISEMPTY!="true"){if(F.errBox!="true"||currentModalEditor.length==0){UpdateHelper.updateComponent(F,G);}else{var E=F.content;if(E.length>0){showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}}}}if(!G){for(var B in iframe.consolidatedStyles){updateStyleContainer(iframe.consolidatedStyles[B],B);}if(!bIsW3C){iframe.togglePulldownChildren(document.body,true);}iframe.targets=null;microstrategy.loadDynamicJS();microstrategy.registerNewBones();}}catch(D){microstrategy.errors.log(D);}};UpdateHelper.updateComponent=function(cB,parentId){try{var sReplaceHTML;var aScripts=null;var j;var oParentDiv;if(!cB.id){return ;}if(cB.components&&cB.components.length>1){UpdateHelper.replaceComponents(cB.components,cB.id);return ;}else{if(cB.components&&cB.components.length==1){return ;}}if(cB.slid){var slices=document.getElementsByName(cB.id);if(slices&&slices.length>0){for(var i=0,len=slices.length;i<len;i++){if(slices[i].getAttribute("slid")==cB.slid){oParentDiv=slices[i];break;}}}}if(!oParentDiv){var oParentDivs=document.getElementById(cB.id);if(!oParentDivs&&(cB.dialog||cB.css=="1")){iframe.createPlaceHolder(cB.id);oParentDivs=document.getElementById(cB.id);}if(oParentDivs){if(oParentDivs.length>1){for(var i=0;i<oParentDivs.length;i++){if(oParentDivs[i].tagName=="DIV"){oParentDiv=oParentDivs[i];break;}}}else{oParentDiv=oParentDivs;}}}if(oParentDiv){var sReplaceHTML=cB.content.replace(/'/g,"'");if(cB.message=="true"){showMessage({contents:sReplaceHTML,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}var scriptArray=[],chartArray=[];var oDivNode=iframe.createElementFromHTML(sReplaceHTML);if(!oDivNode){return ;}iframe.extractScript(oDivNode,scriptArray);iframe.extractImage(oDivNode,chartArray);if(cB.errorInfo){var errorHolder=document.getElementById("errorInfo");if(errorHolder){errorHolder.innerHTML+=cB.errorInfo;}}if(cB.css=="1"){var styleId=oDivNode.getAttribute("styleid");if(!iframe.consolidatedStyles[styleId]){iframe.consolidatedStyles[styleId]=[];}iframe.consolidatedStyles[styleId]=consolidateStyleSheets(oDivNode,iframe.consolidatedStyles[styleId],styleId);}else{if(oParentDiv.getAttribute(mstrHTMLAttributes.ATTR_MODAL)=="true"||(oParentDiv.popupMask)){togglePulldowns(oParentDiv,true);}if(cB.partialUpdate=="true"&&oParentDiv.childNodes.length>1){oParentDiv.innerHTML=oDivNode.innerHTML;}else{if(bIsW3C&&!bIsIE8&&!bIsIE9&&!bIsIE10&&!bIsSafari){iframe.setOuterHTML(oParentDiv,oDivNode);}else{if(oParentDiv&&oDivNode){if(cB.isFlashVis&&bIsIE8){var o=oParentDiv.getElementsByTagName("object");if(o&&o.length>0){for(var i=0;i<o.length;i++){o[i].parentNode.removeChild(o[i]);}}}oParentDiv.parentNode.replaceChild(oDivNode,oParentDiv);}if(chartArray.length>0){for(var j=0,cnt=chartArray.length;j<cnt;j++){chartArray[j].src=chartArray[j].getAttribute("dsrc");}}}}for(var i=0,len=scriptArray.length;i<len;i++){eval(scriptArray[i].toString());}}}}catch(err){microstrategy.errors.log(err);}};mstr.Enum.ColorPickerFlags={NO_COLOR:1,MORE_COLORS:2,GRADIENT_COLORS:4,USER_COLORS:8,GRAPH_GRADIENTS:16,AUTOMATIC:32};mstr.Enum.AttrFormSelector={AUTOMATIC:1,CUSTOM:4,DEFAULT_SORT:1};mstr.bones={};mstr.bones.editors={};mstr.bones.editors.Map={};mstr.controllers.ExportTypes=(function(){var B={};B.exportSet=[{c:"Excel",d:"4",n:"3958",f:"web-export-to-excel;enable-export"},{c:"PDF",d:"3",n:"1877",f:"web-export-to-pdf;enable-pdf;document-html-view-mode"},{c:"HTML",d:"-1",n:"3957",f:"web-export-to-html;enable-html-export;document-html-view-mode"},{c:"Flash",d:"7",n:"14513",f:"rw-flash-view-mode-enabled;web-export-to-flash;enable-flash"}];B.getExportModes=function A(){var C={items:[],value:""};for(var E in this.exportSet){var D=this.exportSet[E];if(mstr.behaviors.featureResolver.resolveFeatSet(D.f)){C.items.push({dssid:D.d,n:microstrategy.descriptors.getDescriptor(D.n),cssClass:"ToolbarList x"+D.c});}}C.value=C.items[0]?C.items[0].dssid:"";return C;};return B;})();mstr.controllers.ZoomFactors=(function(){var C={};var A;C.getZoomFactors=function B(E,J,K){if(!A){A={items:[{n:"400%",dssid:"400"},{n:"300%",dssid:"300"},{n:"200%",dssid:"200"},{n:"150%",dssid:"150"},{n:"125%",dssid:"125"},{n:"100%",dssid:"100"},{n:"75%",dssid:"75"},{n:"50%",dssid:"50"},{n:"25%",dssid:"25"},{n:microstrategy.descriptors.getDescriptor("4809"),dssid:"Width"},{n:microstrategy.descriptors.getDescriptor("4808"),dssid:"Page"}]};}if(typeof (J)=="undefined"){return A;}if(K&&E!=microstrategy.ZOOM_STATIC){A.value=(E==microstrategy.ZOOM_FIT_WIDTH)?"Width":"Page";return A;}var H=[{n:J+"%",dssid:J}];var F=A.items;var D=0,I;for(;D<F.length-2;D++){I=parseInt(F[D].dssid);if(I==J){A.value=J;return A;}if(I<J){break;}}var G={};G.items=mstr.$A.insert(A.items,H,D);G.value=J;return G;};return C;})();mstr.models.ChangeTrackingModel=(function(){mstr.$O.extendsClass(G,mstr.models.BaseModel);G.prototype.init=function B(){mstr.models.BaseModel.prototype.init.apply(this);for(var I in this.props){var H=this.props[I];if(H instanceof mstr.models.ListModel){H.attachEventListener(this,"hashadd_selectedIndices","onHashAdd");H.attachEventListener(this,"hashremove_selectedIndices","onHashRemove");H.set("propName",I);}}};G.prototype.set=function F(J,I){var H=mstr.models.BaseModel.prototype.set.apply(this,[J,I]);if(H){this.changedProps[J]=I;}return H;};G.prototype.onHashAdd=function E(H){var I=H.src.get("propName");this._updateChangedProp(I);};G.prototype.onHashRemove=function A(H){var I=H.src.get("propName");this._updateChangedProp(I);};G.prototype._updateChangedProp=function C(K){var J=this.get(K);var M=J.get("valueForm");var L=J.getSelectedItems();var H="";for(var I=0;I<L.length;I++){H+=L[I][M]+"|";}if(H.charAt(H.length-1)=="|"){H=H.substring(0,H.length-1);}this.changedProps[K]=H;};G.prototype.getChanges=function D(){return this.changedProps;};function G(H){mstr.models.BaseModel.apply(this,[H]);this.changedProps={};}return G;})();mstr.models.ChangeTrackingModelManager=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.getChangesAsString=function C(G){var O="";var L;var N;var H;if(!G){G=UNIT_SEPARATOR;}for(var F in this.props){var E=this.props[F];N="";if(E instanceof mstr.models.ChangeTrackingModel){L=M.getChanges();for(var K in L){H=L[K];if(isNaN(H)){H='"'+H+'"';}N+=K+"="+L[K]+G;}N=N.substring(0,N.length-1);O+=N+G;}else{if(E instanceof mstr.models.ListModel){var J=E.props.items;for(var I=0;I<J.length;I++){var M=J[I];N="";if(M instanceof mstr.models.ChangeTrackingModel){L=M.getChanges();for(var K in L){H=L[K];if(isNaN(H)){H='"'+H+'"';}N+=K+"="+H+G;}if(N.charAt(N.length-1)==G){N=N.substring(0,N.length-1);}if(N.length>0){O+=N+G;}}}}}}if(O.charAt(O.length-1)==G){O=O.substring(0,O.length-1);}return O;};A.prototype.execSubmitChanges=function B(E){};A.prototype.execCancelChanges=function D(){};function A(E){mstr.models.BaseModel.apply(this,[E]);}return A;})();mstr.models.FilterDetailsEditor=(function(){mstr.$O.extendsClass(E,mstr.models.ChangeTrackingModelManager);E.prototype.PROPERTY_SET_NAME="FilterDetailsFormatProperties";E.prototype.PROPERTY_NAME="FilterDetailsFormat";E.prototype.getChangesAsString=function D(G){var J=mstr.models.ChangeTrackingModelManager.prototype.getChangesAsString.apply(this,[G]);J=this.updateRelatedProperties(J);if(!J||J.length==0){return J;}if(!G){G=UNIT_SEPARATOR;}var I=this.props.oldValue||"";var F;var H;var M;var N;var P;var O='\\s*\\b[A-Za-z]+\\b\\s*=\\s*([0-9]+|"[^"]*")\\s*';var L=J.split(G);for(var K=0;K<L.length;K++){M=L[K].indexOf("=");if(M==-1){continue;}F=L[K].substring(0,M);H=L[K].substring(M+1);if(F=="isComplex"){continue;}if(isNaN(H)){H=H.substring(1,H.length-1);if(H.indexOf("\\")>=0){H=H.replace("\\","\\\\");}if(H.indexOf('"')>=0){H=H.replace('"','\\",');}H='"'+H+'"';}N=I.indexOf(F);if(N>=0){P=I.substring(N);P=P.match(O);if(P){if(H!="-1"&&H!=""){I=I.replace(P[0],L[K]);}else{I=I.replace(P[0],"");}}}else{if(H!="-1"){I+=","+L[K];}}}if(I.charAt(0)==","){I=I.substring(1);}if(I.charAt(I.length-1)==","){I=I.substring(0,I.length-1);}return I;};E.prototype.execSubmitChanges=function B(H){var J=this.getChangesAsString(H);var G=microstrategy.updateManager;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var L=microstrategy.getViewerBone().doc;var F=[];if(L){if(!this.props.objId){L.processRWDocProperty(this.PROPERTY_NAME,J);}else{var K=mstrUpdateManager.createPropertyEditString(this.props.objId,this.PROPERTY_NAME,J);F.push(G.createActionObject(null,mstrUpdateManager.EDIT_PROPS,L.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,K],[]));F.push(G.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,L.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,K],[]));G.add(F);G.flushAndSubmitChanges();}}}else{var I=microstrategy.bone("UniqueReportID");var F=new Array();I.setReportProp(this.PROPERTY_SET_NAME,this.PROPERTY_NAME,J,F);G.add(F);G.flushAndSubmitChanges();}return true;};E.prototype.updateRelatedProperties=function C(F){var G=F.replace(" ","");if(G.indexOf("SBLT=-1")>=0){F+=UNIT_SEPARATOR+"CDLT=";}return F;};E.prototype.execCancelChanges=function A(){return true;};function E(F){mstr.models.ChangeTrackingModelManager.apply(this,[F]);}return E;})();mstr.models.TaskModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.execFetchBlock=function C(G,F,E){var D=this.props.requestContext;if(D&&D.id){this.cancelRequest(D.id);this.set("readyState",mstr.Enum.Widget.READYSTATE.CANCELLED);}this.waitingElement=F;this.submitRequest(G,E);};A.prototype.loadRequestResponse=function B(){var D=this.props.requestContext;var F=D&&D.response;if(!F||!F.data){if(this.get("readyState")!=mstr.Enum.Widget.READYSTATE.WAITING){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);}return ;}var G=F.data;this.set("models",G.get("models"));this.set("views",G.get("views"));var E=G.get("views")[0];E.set("element",this.waitingElement);E.set("document",this.waitingElement.ownerDocument);this.set("renderableView",E);this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);this.props.requestContext={};};function A(D){mstr.models.BaseModel.apply(this,[D]);}return A;})();mstr.models.SelectDataSetModel=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.setItems=function B(I){for(var J=0;J<I.length;J++){if(I[J].tp===microstrategy.DSSTYPE_FOLDER){I[J].did=I[J].dssid;}else{I[J].did=I[J].did||I[J].dssid;}}mstr.models.ListModel.prototype.setItems.apply(this,[I]);};C.prototype.execSelectDataset=function H(){var I=this.getSelectedItems();if(I==null){return false;}var K=this.get("oldDSID");var L=this.get("ReplaceAllDS");var J=(K&&(K.length>0))||L;this.get("opener").handleDatasetExplorer({items:I,formatting:this.get("addWithFormatting"),oldDSID:K,oldDSType:this.get("oldDSType"),ReplaceAllDS:L});return true;};C.prototype._showWarningMessage=function G(I){showMessage({contents:microstrategy.descriptors.getDescriptor(I),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});document.getElementById(currentModalEditor[0]).style.zIndex=9999;};C.prototype._updateCommandEnabledSelectDataset=function F(){this.set("CommandEnabledSelectDataset",(this.getSelectedItem()!=null));};C.prototype.on_hashadd_selectedIndices=function A(I){mstr.models.ListModel.prototype.on_hashadd_selectedIndices.apply(this,[I]);if(I&&I.src==this){this._updateCommandEnabledSelectDataset();}};C.prototype.on_hashremove_selectedIndices=function D(I){mstr.models.ListModel.prototype.on_hashremove_selectedIndices.apply(this,[I]);if(I&&I.src==this){this._updateCommandEnabledSelectDataset();}};C.prototype.execOpenImportData=function E(){var I=this,J=function J(K){if(!K||!K.length){return false;}I.get("opener").handleDatasetExplorer({items:K,oldDSID:I.get("oldDSID"),oldDSType:I.get("oldDSType"),ReplaceAllDS:I.get("ReplaceAllDS")});return true;};microstrategy.openDataImport({AnalysisId:microstrategy.bone("rwb_viewer").messageID,callback:J});};function C(I){mstr.models.ListModel.apply(this,[I]);this._updateCommandEnabledSelectDataset();}return C;})();mstr.models.AnnotationModel=(function(){mstr.$O.extendsClass(F,mstr.models.BaseModel);F.ADDITION_MAX_LENGTH=32000;F.NOTES_MAX_LENGTH=65535;F.prototype.execSetMode=function H(I){this.set("mode",I);};F.prototype.loadRequestResponse=function B(){var I=this.props.requestContext;var J=I&&I.response;if(!J||!J.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var K=J.data;if(I.memo.command=="fetch"||I.memo.command=="add"||I.memo.command=="save"){this.set("value",decode(K.annotation));}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};F.prototype.execSave=function C(){var I=new mstr.http.SaveAnnotationsInputs(this.get("objectID"),this.get("objectType"),this.get("value").substring(0,F.NOTES_MAX_LENGTH-this.get("postfixLen")),0);this.submitRequest(I,{command:"save"});return true;};F.prototype.execAdd=function E(I){var J=new mstr.http.SaveAnnotationsInputs(this.get("objectID"),this.get("objectType"),I.substring(0,F.ADDITION_MAX_LENGTH-this.get("addition").get("prefixLen")-this.get("addition").get("postfixLen")),1);this.submitRequest(J,{command:"add"});return true;};F.prototype.execFetch=function D(){var I=new mstr.http.GetAnnotationsInput(this.get("objectID"),this.get("objectType"),"GetAnnotationsStyle");this.submitRequest(I,{command:"fetch"});return true;};F.prototype.updateValue=function A(I){if(I!=this.get("value")){this.set("CommandEnabledValidateEdit",true);}};F.prototype.execValidateEdit=function G(I){return true;};function F(I){if(I.value){I.value=decode(I.value);}mstr.models.BaseModel.apply(this,[I]);this.set("CommandEnabledValidateEdit",false);}return F;})();mstr.models.AnnotationAddArea=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.execClear=function A(){this.set("value","");return true;};B.prototype.execValidateAdd=function C(E,F){return true;};B.prototype.updateValue=function D(E){this.set("CommandEnabledValidateAdd",true);};function B(E){mstr.models.BaseModel.apply(this,[E]);this.set("CommandEnabledValidateAdd",false);}return B;})();mstr.models.NotesIconModel=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.loadRequestResponse=function A(){var D=this.props.requestContext;var E=D&&D.response;if(!E||!E.data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var F=E.data;this.set("hasAnnotation",F.hasAnnotation);this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};B.prototype.execCheck=function C(){this.set("hasAnnotation",false);var D=new mstr.http.GetAnnotationsInput(this.get("objectID"),this.get("objectType"),"CheckAnnotationsStyle");this.submitRequest(D,{});return true;};function B(D){mstr.models.BaseModel.apply(this,[D]);}return B;})();mstr.models.ColorPicker=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.init=function B(){mstr.models.ListModel.prototype.init.apply(this);var G=this.getItems()&&this.getItems()[0];if(G){this.set("hasColor",G[this.get("valueForm")]!="transparent");}};C.prototype.on_hashadd_selectedIndices=function E(G){mstr.models.ListModel.prototype.on_hashadd_selectedIndices.apply(this,[G]);var I=this.getSelectedItem();if(I){var H=this.set("actualColor",I[this.get("valueForm")]);}};C.prototype.execSelectValue=function D(G){if(G==null||G==""){G="#000000";}if(G!="transparent"&&G!="automatic"){G=G.toUpperCase();}if(mstr.models.ListModel.prototype.execSelectValue.apply(this,[G])){return true;}this.set("actualColor",G);this.execClearSelect();this.raiseEvent("hashremove_selectedIndices",{name:"selectedIndices",at:{}});return true;};C.prototype.set=function A(H,G){if(H=="actualColor"&&this.props.enableReselect&&this.props[H]==G){this.raiseEvent("set_"+H,{name:H,value:G,valueWas:G});return true;}else{return mstr.models.ListModel.prototype.set.apply(this,arguments);}};C.prototype.execInsertCustomColor=function F(Q){if(!Q||!this.getItems()||!this.getItems()[0]){return ;}var K=this.get("valueForm");var J=mstr.$H.clone(this.getItems()[0]);J[K]=Q;if(K!="n"){J.n=microstrategy.descriptors.getDescriptor("2133")+" "+Q;}var L=-1;var R=mstr.$A.len(this.props.items);var P=this.get("maxSize");if(P>-1&&P<=R){L=0;var I={min:P-1,max:R-1};this.removeItemsAtRanges([I],true);}this.execSingleSelect(this.insertItemsAt([J],L));this.set("hasColor",true);var M=microstrategy&&microstrategy.updateManager;if(M){var G="";var O="";var N=this.getItems();for(var H=0;H<8;H++){if(N[H][K]=="transparent"){break;}G+=O+N[H][K];O=",";}M.add([M.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,mstr.$obj("mstrPageInfo").get("beanPath"),["5003","5004"],["userPalette",G],[],null)],true);}};function C(G){mstr.models.ListModel.apply(this,[G]);}return C;})();mstr.models.AdvancedColorPicker=(function(){mstr.$O.extendsClass(C,mstr.models.BaseModel);C.monitoredFields=["color","rootColor","hex","r","g","b","h","s","v"];C.prototype.init=function I(){mstr.models.BaseModel.prototype.init.apply(this);for(var J=0;J<9;J++){this["on_set_"+C.monitoredFields[J]]=this.synchFields;}this.get("basicColors").attachEventListener(this,"set_actualColor","synchFields");this.getTarget()&&this.initFromTarget();};C.prototype.getTarget=function A(){return this.get("targetPath")?mstr.controllers.Factory.getPath(this.get("targetPath"),this):null;};C.prototype.initFromTarget=function B(){if(!this.getTarget()){return ;}this.set("color",this.getTarget().getCurrentColor());this.set("activeControlId",this.getTarget().getActiveControlId());};C.prototype.execUpdateTarget=function E(){if(!this.getTarget()){return ;}this.getTarget().exec("advColorPicker",this.get("activeControlId")+"|"+this.get("color"));};C.prototype.set=function H(M,K){mstr.models.BaseModel.prototype.set.apply(this,[M,K]);if(M=="opener"){var J=K&&K.getModel&&K.getModel();if(!J){return ;}var L=J.get("actualColor");if(L){L=L.split(",")[0];if(L=="transparent"){L="#ffffff";}else{if(L.charAt(0)!="#"){L="#"+L;}}this.set("color",L);}mstr.$obj("mstrPageInfo").get("userPalette").attachEventListener(this,"set_actualColor","synchFields");}if(M=="targetPath"){this.getTarget()&&this.initFromTarget();mstr.$obj("mstrPageInfo").get("userPalette").attachEventListener(this,"set_actualColor","synchFields");}};C.prototype.synchFields=function F(J){if(this.synchronizing){return ;}switch(J.name){case"set_color":this.synchronizing=true;var M=J.memo.value;this.set("hex",M.substr(1));var L=mstr.utils.Color.hex2rgb(M);this.set("r",L[0]);this.set("g",L[1]);this.set("b",L[2]);var K=mstr.utils.Color.rgb2hsv(L[0],L[1],L[2]);this.set("h",K[0]);this.set("s",K[1]);this.set("v",K[2]);this.set("rootColor","#"+mstr.utils.Color.hsv2hex(K[0],100,100));this.synchronizing=false;break;case"set_hex":this.set("color","#"+(this.get("hex")||"000000"));break;case"set_r":case"set_g":case"set_b":this.set("color","#"+mstr.utils.Color.rgb2hex(this.get("r"),this.get("g"),this.get("b")));break;case"set_h":case"set_s":case"set_v":this.set("color","#"+mstr.utils.Color.hsv2hex(this.get("h"),this.get("s"),this.get("v")));break;case"set_actualColor":var M=J.src.get("actualColor");if(M!="transparent"){this.set("color",M);}break;}};C.prototype.execDetachUserPalette=function G(J){mstr.$obj("mstrPageInfo").get("userPalette").detachEventListener(this,"set_actualColor");};C.prototype.execAddUserColor=function D(J){var L=this.get("color");if(this.get("basicColors").indexOfValue(L)!=-1){return ;}var K=mstr&&mstr.$obj("mstrPageInfo")&&mstr.$obj("mstrPageInfo").get("userPalette");if(!K||K.indexOfValue(L)!=-1){return ;}K.execInsertCustomColor(L);};function C(J){mstr.models.BaseModel.apply(this,[J]);}return C;})();mstr.models.GradientEditor=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.init=function D(){mstr.models.BaseModel.prototype.init.apply(this);this["on_set_gradient"]=this.gradientChange;this.get("color1").attachEventListener(this,"set_actualColor","gradientChange");this.get("color2").attachEventListener(this,"set_actualColor","gradientChange");this.get("gradientType").attachEventListener(this,"hashadd_selectedIndices","gradientChange");this.get("variants").attachEventListener(this,"hashadd_selectedIndices","gradientChange");};B.prototype.set=function A(I,G){mstr.models.BaseModel.prototype.set.apply(this,[I,G]);if(I=="opener"){var F=G&&G.getModel&&G.getModel();if(!F){return ;}var H=F.get("actualColor");if(H&&H.indexOf(",")>-1){this.set("gradient",H);}else{H=(H&&H!="transparent")?H.substr(1):"000000";this.set("gradient",H+",ffffff,14,0,0,0");}}};B.prototype.gradientChange=function C(Q){if(this.changingGradient){return ;}switch(Q.name){case"set_gradient":this.changingGradient=true;var I=Q.memo.value.split(",");this.get("color1").execSelectValue("#"+I[0]);this.get("color2").execSelectValue("#"+I[1]);var K,J,G;var L=I.slice(2).join(",");var F=this.get("variantsCache");var P=F.length+1;for(J=0,G=F.length;J<G;J++){var H=F[J];var S=H.indexOfValue(L);if(S!=-1){P=J+1;K=H;break;}}this.get("gradientType").execSelectValue(P);if(P==gradientUtil.GRADIENTSHADING_STYLE_CUSTOM){this.customGradientInit(L);}if(K){var R=mstr.utils.Hash.deepClone(K.getItems());for(J=0,G=R.length;J<G;J++){R[J].dssid=I[0]+","+I[1]+","+R[J].dssid;}var N=this.get("variants");N.setItems(R);N.execSelectValue(Q.memo.value);}this.changingGradient=false;break;case"set_actualColor":case"hashadd_selectedIndices":if(Q.src==this.get("variants")){this.changingGradient=true;this.set("gradient",this.get("variants").getSelectedItemValue());this.changingGradient=false;}else{var L=this.get("color1").get("actualColor").substr(1)+",";L+=this.get("color2").get("actualColor").substr(1)+",";var M=this.get("gradientType").getSelectedIndex();var O=this.get("variantsCache");if(!O[M]){return ;}L+=O[M].getSelectedItemValue();this.set("gradient",L);}break;}};B.prototype.customGradientInit=function E(F){};function B(F){mstr.models.BaseModel.apply(this,[F]);}return B;})();mstr.models.GraphGradientEditor=(function(){mstr.$O.extendsClass(E,mstr.models.GradientEditor);E.prototype.init=function B(){mstr.models.GradientEditor.prototype.init.apply(this);this.get("transitionType").attachEventListener(this,"hashadd_selectedIndices","customGradientChange");this.attachEventListener(this,"set_angle","customGradientChange");this.attachEventListener(this,"set_xOffset","customGradientChange");this.attachEventListener(this,"set_yOffset","customGradientChange");};E.prototype.customGradientChange=function D(F){var G=this.get("color1").get("actualColor").substr(1)+",";G+=this.get("color2").get("actualColor").substr(1)+",";G+=this.get("transitionType").getSelectedItemValue()+",";G+=this.get("angle")+","+this.get("xOffset")+","+this.get("yOffset");this.changingGradient=true;this.set("gradient",G);this.changingGradient=false;};E.prototype.customGradientInit=function A(F){var G=F.split(",");if(G.length==4){this.get("transitionType").execSelectValue(G[0]);this.set("angle",G[1]);this.set("xOffset",G[2]);this.set("yOffset",G[3]);}};E.prototype.gradientChange=function C(F){if(this.changingGradient){return ;}if(this.get("gradientType").getSelectedItemValue()==gradientUtil.GRADIENTSHADING_STYLE_CUSTOM){this.customGradientChange(null);return ;}mstr.models.GradientEditor.prototype.gradientChange.apply(this,arguments);};function E(F){mstr.models.GradientEditor.apply(this,[F]);}return E;})();mstr.models.Validator=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.setValidationStatus=function B(E){var D=this.get("parent");if(!D){return true;}if(E.length==0){D.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.VALID,message:"",bubble:true});return true;}var C=this.get("errMessage")||E;D.set("validationStatus",{statusCode:mstr.Enum.Validation.STATUSCODE.INVALID_ANSWERS,message:C,bubble:true});return false;};function A(C){mstr.models.BaseModel.apply(this,[C]);}return A;})();mstr.models.FieldValidator=(function(){mstr.$O.extendsClass(C,mstr.models.Validator);C.EXCEPTION_DELIMITER=";";C.prototype.intRegExp=/(^-?\d\d*$)/;C.prototype.validate=function B(M){var E="",J=this.props.descriptors;var K=false,F;if(this.get("exceptions")){F=mstr.utils.String.trimDelimited(C.EXCEPTION_DELIMITER+this.get("exceptions")+C.EXCEPTION_DELIMITER,C.EXCEPTION_DELIMITER);if(F.indexOf(mstr.utils.String.trimDelimited(C.EXCEPTION_DELIMITER+M+C.EXCEPTION_DELIMITER,C.EXCEPTION_DELIMITER))!=-1){K=true;}if(K){return this.setValidationStatus(E);}}var I=(M==null||(typeof (M)=="string"&&M.length==0));if(this.get("required")&&I){E=J.errRequired;}if(E.length==0&&!I){var G=rangeErr=regErr=0;var Q="";var L=this.get("max");var H=this.get("min");if(L=="x"){L=null;}if(H=="x"){H=null;}var P=this._resolveComparisonFields("lessThan");var O=this._resolveComparisonFields("greaterThan");var N=this.get("regEx");var D=this.get("type");if(H&&L||H&&P||L&&O||P&&O){Q=J.errMinMax;}else{if(H||O){Q=J.errMinOrGreater;}else{if(L||P){Q=J.errMaxOrLess;}else{if(N){Q=J.errRegEx;}else{if(D){Q=J.errType;}}}}}switch(D){case mstr.Enum.Nodes.DATATYPE.INTEGER:if((!this.intRegExp.test(M)&&!this.snRegExp.test(M))||parseInt(M,10)!=parseFloat(M)){Q=Q.replace("#",J.errTypeInt);G=1;}break;case mstr.Enum.Nodes.DATATYPE.FLOAT:if(!this.floatRegExp.test(M)&&!this.snRegExp.test(M)){Q=Q.replace("#",J.errTypeNum);G=1;}break;}if(!G){Q=Q.replace("# ","");}if((L||H)&&mstr.utils.Math.inNumericRange(M,H,L)){rangeErr=1;}if(H){Q=Q.replace("##",H);}if(L){Q=Q.replace("###",L);}if(!isNaN(P)){if(M>P||G){rangeErr=1;}Q=Q.replace("###",P);}if(!isNaN(O)){if(M<O||G){rangeErr=1;}Q=Q.replace("##",O);}if(N&&!(new RegExp(N,"g").test(M))){regErr=1;}if(G||rangeErr||regErr){E=Q;}}return this.setValidationStatus(E);};C.prototype._resolveComparisonFields=function A(K){var G=this.get(K);if(!G){return NaN;}var J=0;var D,F,E;var I=G.split("|");if(I[0]){var H=I[0].split(";");for(F=0,E=H.length;F<E;F++){D=mstr.$path(H[F],this.get("parent"));J+=parseFloat(D,10);}}if(I[1]){var L=I[1].split(";");for(F=0,E=L.length;F<E;F++){D=mstr.$path(L[F],this.get("parent"));J-=parseFloat(D,10);}}return J;};function C(D){mstr.models.Validator.apply(this,[D]);var E=mstr.controllers.Factory.getPath("userInfo/decimalSeparator",mstr.$obj("mstrPageInfo"));this.floatRegExp=new RegExp("(^-?\\d\\d*\\"+E+"\\d*$)|(^-?\\d\\d*\\"+E+"?\\d*e(\\+|-)\\d+$)|(^-?\\d\\d*$)|(^-?\\"+E+"\\d\\d*$)");this.snRegExp=new RegExp("^-?[1-9](\\"+E+"\\d+)?[Ee]([+-]?\\d+)$");}return C;})();mstr.models.ListValidator=(function(){mstr.$O.extendsClass(B,mstr.models.Validator);B.prototype.validate=function A(D,E){var C=this.get("parent").getModel();if(this.get("required")&&D=="ToggleSelect"){var F=[];if(C.getSelectedIndices()[E]&&C.getSelectedItems().length==1){F=[microstrategy.descriptors.getDescriptor("6076")];}return this.setValidationStatus(F);}return true;};function B(C){mstr.models.Validator.apply(this,[C]);}return B;})();mstr.models.RibbonToolbarModel=(function(){mstr.$O.extendsClass(D,mstr.models.ListModel);D.prototype.init=function B(){microstrategy.bones[this.getId()]=this;mstr.models.ListModel.prototype.init.apply(this,[]);if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){this.set("selectedToolbar",0);}this.selectToolbar();};D.prototype.onreload=function A(){var R=this.getSelectedItem();var P=this.getItems();for(var N=0,K=P.length;N<K;N++){var L=P[N];var M=L.visibleFeatures;var J=L.enabledFeatures;var Q=mstr.behaviors.featureResolver.resolveFeatSet(M,true);var O=mstr.behaviors.featureResolver.resolveFeatSet(J,true);if(Q&&!L.visible){this.get("toolbarModels").getItems()[N].execSynchronizeControls();}L.visible=Q;}if(!R.visible||!O){this.execSelectValue(0);}this.raiseEvent("featuresChanged");};D.prototype.onload=function C(){this.onreload();};D.prototype.selectToolbar=function H(){this.set("initializing",true);if(!this.execSelectValue(this.get("selectedToolbar"))){var J=0;while(!this.execSelectValue(J)){J++;}}this.set("initializing",false);};D.prototype.execSingleSelect=function G(L){mstr.controllers.EventManager.notifyWindowListeners({name:"closeMenus"});if(this.props.items[L].enabledFeatures){if(!mstr.behaviors.featureResolver.resolveFeatSet(this.props.items[L].enabledFeatures)){return false;}}mstr.models.ListModel.prototype.execSingleSelect.call(this,L);if((mstrUpdateManager.SET_REPORT_SELECTED_RIBBON||mstrUpdateManager.SET_RW_SELECTED_RIBBON)&&!this.get("initializing")){var K=microstrategy.updateManager;if(!this.action){this.action=K.createActionObject(null,mstrUpdateManager.SET_REPORT_SELECTED_RIBBON||mstrUpdateManager.SET_RW_SELECTED_RIBBON,this.get("beanPath").replace("mstrWeb",microstrategy.servletName),["120005"],[],[],null);K.add([this.action],true);}this.action.newArgs=[this.getSelectedItemValue()];}var J=this.get("toolbarModels");J.execSingleSelect(L);if(J.getSelectedItem().get("requestToolbar")){this.requestToolbar(L);}return true;};D.prototype.requestToolbar=function I(K){var J=this.props.requestContext;if(J&&J.id){this.cancelRequest(J.id);}var L=new mstr.http.LoadToolbarInput();L.params.viewer=this.get("targetPath");L.params.toolbarName=this.getItems()[K]["toolbarName"];L.params.ribbonListName=this.get("ribbonListName");this.submitRequest(L,{index:K});};D.prototype.on_set_readyState=function F(J){if(J.memo.value==mstr.Enum.Widget.READYSTATE.ERROR){microstrategy.handleTaskModelError(J);}mstr.models.ListModel.prototype.on_set_readyState.apply(J);};D.prototype.loadRequestResponse=function E(){var M=this.props.requestContext;var N=M&&M.response;if(!N||!N.data){return ;}var K=N.data.props.n;var R=this.get("toolbarModels");var O=R.getItems();var Q=M.memo.index;var S=K.getItems();for(var L=0,J=S.length;L<J;L++){if(S[L].set){S[L].set("parent",O[Q]);}}var P=K.get("targetPath");if(P){O[Q].set("targetPath",P);}O[Q].setItems(S);O[Q].set("requestToolbar",false);this.props.requestContext={};};function D(J){mstr.models.ListModel.apply(this,[J]);}return D;})();mstr.models.Toolbar=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.queueStatus={};C.prototype.init=function G(J){if(!this.props.targetPath){var N=this.getAncestorByProperty("targetPath",true);if(N){this.props.targetPath=N.get("targetPath");}}if(this.props.targetPath){var K=this.get("items");for(var M=0,L=K.length;M<L;M++){if(!K[M].targetPath){mstr.controllers.Factory.safeset(K[M],"targetPath",this.props.targetPath);}}}mstr.models.ListModel.prototype.init.apply(this,arguments);};C.prototype.clearQueuedValues=function B(K,J){if(!this.queue){return ;}var L=this.queue[K];if(!L){return ;}if(J){delete L[J];if(mstr.utils.Hash.isEmpty(L)){delete this.queue[K];}}else{delete this.queue[K];}this.set("CommandEnabledSubmitQueue",!this.get("CommandEnabledSubmitQueue"));};C.prototype.queueValue=function E(M,K,L){var J=this.queue||{};var N=J[M]||{};N[K]=L;J[M]=N;this.queue=J;this.set("CommandEnabledSubmitQueue",!this.get("CommandEnabledSubmitQueue"));};C.prototype.execSubmitQueue=function F(K){if(!this.isQueueStatusValid(K)){return ;}var L=mstr.controllers.Factory.getPath(this.get("targetPath"),this);var J=L&&L.commands&&L.commands.exec(K,this.queue[K]);this.clearQueuedValues(K);};C.prototype.queryCommandEnabled=function A(K,J){if(K=="SubmitQueue"&&J&&J[0]){return this.isQueueStatusValid(J[0]);}else{return mstr.models.BaseModel.prototype.queryCommandEnabled.apply(this,arguments);}};C.prototype.setQueueValidationStatus=function D(K,J){this.queueStatus[K]=J;this.set("CommandEnabledSubmitQueue",!this.get("CommandEnabledSubmitQueue"));};C.prototype.isQueueStatusValid=function I(J){return this.queue&&this.queue[J]&&!(this.queueStatus[J]>mstr.Enum.Validation.STATUSCODE.VALID);};C.prototype.execSynchronizeControls=function H(){var J=this.getItems();for(var L=0,K=J.length;L<K;L++){var M=J[L].get&&J[L].get("toolbarHelper");if(M){M.synchronizeControl();}}};function C(J){mstr.models.ListModel.apply(this,[J]);}return C;})();mstr.models.TextBoxModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.submitParentQueue=function B(){var C=this.props&&this.props.parent&&this.props.parent.execSubmitQueue;if(C&&this.props.queueGroup){this.props.parent.execSubmitQueue(this.props.queueGroup);}};function A(C){mstr.models.BaseModel.apply(this,[C]);}return A;})();mstr.models.ToolbarControlHelper=(function(){mstr.$O.extendsClass(TCH,mstr.models.BaseModel);TCH.prototype.init=function TCH_init(excludedProps){mstr.models.BaseModel.prototype.init.apply(this,arguments);var path=this.get("parent").get("targetPath");if(!path){return ;}this.set("targetPath",path);var that=this;var fn=function(){that.synchronizeControl();};var methods=this.get("parent").get("listenerMethods").split(",");for(var i=0,cnt=methods.length;i<cnt;i++){this[methods[i]]=fn;}if(this.get("targetPath")&&!this.getTarget()){this.synchronizeControl();var h=window.setInterval(function(){if(that.attachToTarget()){window.clearInterval(h);}},100);return ;}this.attachToTarget();};TCH.prototype.attachToTarget=function TCH_attachToTarget(){var target=this.getTarget();if(!target){return false;}this.synchronizeControl();var zz=target.observer&&target.observer.register(this.get("id"));return true;};TCH.prototype.getCmdId=function(){var parent=this.get("parent");return parent&&parent.get("cmdid");};TCH.prototype.getTarget=function(){return mstr.controllers.Factory.getPath(this.get("targetPath"),this);};TCH.prototype.synchronizeControl=function TCH_synchronizeControl(){var target=this.getTarget();var cmdId=this.getCmdId();var b=this.get("visible");var parent=this.get("parent");var vFeatures=parent.get("visibleFeatures");if(vFeatures){b=mstr.behaviors.featureResolver.resolveFeatSet(vFeatures);}if((cmdId&&target)&&(!vFeatures||b)){b=target.commands.queryVisible(cmdId);}this.set("visible",b);if(!b){return false;}b=this.get("enabled");var eFeatures=parent.get("enabledFeatures");if(eFeatures){b=mstr.behaviors.featureResolver.resolveFeatSet(eFeatures);}else{if(cmdId&&target){b=target.commands.queryEnabled(cmdId);}}this.set("enabled",b);return b;};TCH.prototype._getCustomizationInfo=function TCH__getCustomizationInfo(n){return this.get("parent").get(n);};TCH.prototype.processCustomizations=function TCH_processCustomizations(){var ext=this._getCustomizationInfo("extra-url");if(ext){microstrategy.updateManager.addURL(ext);}var js=this._getCustomizationInfo("on-click");if(js){eval(js);}this.execHyperlink(this._getCustomizationInfo("link"),ext);this.execEvent(this._getCustomizationInfo("event"),ext);};TCH.prototype.execHyperlink=function TCH_execHyperlink(link,extraUrl){if(!link){return ;}var h=link.href;if(!h){return ;}var p=link.params;if(link["append-state"]||p){if(!(/\?$/.test(h))){h+="?";}if(link["append-state"]){h=updateLink(h);}h=this._parameterizeUrl(h,p);}if(extraUrl){h+="&"+extraUrl;}var t=this._resolveTarget(link);window.open(h,t);};TCH.prototype.execEvent=function TCH_execEvent(evt,extraUrl){if(!evt){return ;}var p=this.getAncestorByProperty("evtInfo");if(!p){p=this.getAncestorByProperty("ribbonId");p=mstr.$obj(p.get("ribbonId")).getAncestorByProperty("evtInfo",true);}var h=p&&p.get("evtInfo").get(evt["action-id"]);if(!h){return ;}if(evt.iframe){h+="&iframe=true";}var t=this._resolveTarget(evt);if(evt["append-state"]){submitLink({href:h,target:t});}else{if(extraUrl){h+="&"+extraUrl;}window.open(h,t);}};TCH.prototype._parameterizeUrl=function TCH__parameterizeUrl(h,p){if(!p){return h;}var delim=(/\?$/.test(h))?"":"&";var parent=this.get("parent");for(var i=0,cnt=p.length;i<cnt;i++){var v=mstr.controllers.Factory.getPath(p[i].value,parent);v=(v!=undefined)?v:p[i].value;h+=delim+escape(p[i].n)+"="+escape(v);delim="&";}return h;};TCH.prototype._resolveTarget=function TCH__resolveTarget(info){var t="_self";if(info.target){t=info.target;}else{if(info.iframe){t="frameManager";}else{if(info["use-window-open"]){t="_blank";}}}return t;};function TCH(props){mstr.models.BaseModel.apply(this,[props]);}return TCH;})();mstr.models.ToolbarButtonHelper=(function(){mstr.$O.extendsClass(B,mstr.models.ToolbarControlHelper);B.prototype.execPressed=function A(){var D=this.getCmdId();if(D){var E=this.getTarget();var C=E&&E.commands&&E.commands.exec(D);}this.processCustomizations();};function B(C){mstr.models.ToolbarControlHelper.apply(this,[C]);}return B;})();mstr.models.ToolbarDualStateButtonHelper=(function(){mstr.$O.extendsClass(C,mstr.models.ToolbarButtonHelper);C.prototype.synchronizeControl=function A(){if(!mstr.models.ToolbarButtonHelper.prototype.synchronizeControl.apply(this,arguments)){return false;}var D=this.getTarget();this.get("parent").set("state",D&&D.commands.queryState(this.getCmdId()));};C.prototype.execPressed=function B(){var F=this.get("parent");var H=!F.get("state");F.set("state",H);var E=this.getCmdId();if(E){var G=this.getTarget();var D=G&&G.commands&&G.commands.exec(E,H);}this.processCustomizations();};function C(D){mstr.models.ToolbarButtonHelper.apply(this,[D]);}return C;})();mstr.models.ToolbarListHelper=(function(){mstr.$O.extendsClass(B,mstr.models.ToolbarControlHelper);B.prototype.init=function F(H){mstr.models.ToolbarControlHelper.prototype.init.apply(this,arguments);var I=this.get("parent");I.attachEventListener(this,"hashadd_selectedIndices","updateTarget");};B.prototype._getCustomizationInfo=function A(J){var I=this.get("parent");var H=I&&I.getSelectedItem();return(H&&mstr.controllers.Factory.safeget(H,J))||I.get(J);};B.prototype.updateTarget=function C(J){if(this.get("synchronizing")){return ;}var M=this.get("parent");var K=M.getSelectedItem();if(!K){return ;}var I=this.getCmdId();if(I){var L=this.getTarget();var H=L.commands&&L.commands.exec(I,K[M.get("valueForm")]);}this.processCustomizations();};B.prototype.synchronizeControl=function G(){if(!mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){return false;}var J=this.getTarget();var I=J&&J.commands.queryState(this.getCmdId());if(!I){return true;}this.set("synchronizing",true);this.checkItemFeatures();var H=(mstr.$A.isArray(I))?"execSelectValues":"execSelectValue";var K=this.get("parent")[H](I);if(!K){this.get("parent").execClearSelect();}this.set("synchronizing",false);return true;};B.prototype.checkItemFeatures=function E(){if(this.get("noFeatures")){return ;}var K,J;var M=this.get("parent");var N=this.get("cachedItems");if(!N){var I=M.getItems();var H=false;for(K=0,J=I.length;K<J;K++){if(I[K]["visibleFeatures"]){H=true;break;}}if(H){N=mstr.utils.Hash.deepClone(M.getItems());this.set("cachedItems",N);}else{this.set("noFeatures",true);return ;}}N=mstr.utils.Hash.deepClone(N);for(K=N.length-1;K>=0;K--){var L=N[K]["visibleFeatures"];if(!L){continue;}if(!mstr.behaviors.featureResolver.resolveFeatSet(L)){N.splice(K,1);}}M.setItems(N);};B.prototype.pickerButtonPushed=function D(){if(this.get("parent").get("updateOnClick")){this.updateTarget();this.synchronizeControl();return true;}else{return false;}};function B(H){mstr.models.ToolbarControlHelper.apply(this,[H]);}return B;})();mstr.models.ToolbarCheckListHelper=(function(){mstr.$O.extendsClass(G,mstr.models.ToolbarListHelper);G.prototype.init=function D(H){mstr.models.ToolbarListHelper.prototype.init.apply(this,arguments);var I=this.get("parent");I.attachEventListener(this,"hashremove_selectedIndices","cacheAction");I.attachEventListener(this,"hashadd_selectedIndices","cacheAction");};G.prototype.cacheAction=function B(H){if(this.get("synchronizing")){return ;}var I=this._killUpdateTimeout();I.push(this._packageValue(mstr.utils.Arrays.fromHashKeys(H.memo.at,true),(H.name=="hashadd_selectedIndices")));this._setUpdateTimeout(I);};G.prototype.updateTarget=function F(){if(this.get("synchronizing")){return ;}var J=this.get("parent").get("lastSelection");var K=this.get("updateCache")||[this._packageValue(J?[J]:[],true)];this.set("updateCache",null);var I=this.getCmdId();if(I){var L=this.getTarget();var H=L.commands&&L.commands.exec(I,K);}};G.prototype._packageValue=function C(O,H){H=!!H;var N=this.get("parent");var K=N.getItems();var I=N.get("valueForm");var J=[];for(var M=0,L=O.length;M<L;M++){J.push(K[O[M]][I]);}return{cl:H,v:J};};G.prototype._killUpdateTimeout=function A(){if(this.get("updateHandle")){window.clearTimeout(this.get("updateHandle"));this.set("updateHandle",null);if(!!!this.get("discardQueue")){return this.get("updateCache");}}return[];};G.prototype._setUpdateTimeout=function E(H){this.set("updateCache",H);this.set("updateHandle",window.setTimeout('mstr.$obj("'+this.getId()+'").updateTarget();',0));};function G(H){mstr.models.ToolbarListHelper.apply(this,[H]);}return G;})();mstr.models.ToolbarDynamicListHelper=(function(){mstr.$O.extendsClass(A,mstr.models.ToolbarListHelper);A.prototype.synchronizeControl=function B(){if(!mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){return false;}var D=this.getTarget();var C=D.commands.queryState(this.getCmdId());this.set("synchronizing",true);this.get("parent").setItems(C.items);var E=this.get("parent").execSelectValue(C.value);if(!E){this.get("parent").execClearSelect();}this.set("synchronizing",false);return true;};function A(C){mstr.models.ToolbarListHelper.apply(this,[C]);}return A;})();mstr.models.ToolbarColorPickerHelper=(function(){mstr.$O.extendsClass(D,mstr.models.ToolbarControlHelper);D.prototype.init=function C(F){mstr.models.ToolbarControlHelper.prototype.init.apply(this,arguments);var G=this.get("parent");G.attachEventListener(this,"set_actualColor","updateTarget");};D.prototype.updateTarget=function B(F){if(this.get("synchronizing")){return ;}var G=F.memo.value;this.get("parent").set("lastColor",G);this.getTarget().commands.exec(this.getCmdId(),G);};D.prototype.synchronizeControl=function A(){if(!mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){return ;}var G=this.getTarget();var F=G.commands.queryState(this.getCmdId());this.set("synchronizing",true);this.get("parent").execSelectValue(F);this.set("synchronizing",false);F=G.commands.queryState(this.getCmdId()+"_vf");if(F!=""){this.get("parent").set("popup|viewFlags",F);}};D.prototype.pickerButtonPushed=function E(){var G=this.get("parent");var F=G.get("lastColor");if(F){G.set("actualColor",F);this.synchronizeControl();}return true;};function D(F){mstr.models.ToolbarControlHelper.apply(this,[F]);}return D;})();mstr.models.ToolbarTextBoxHelper=(function(){mstr.$O.extendsClass(D,mstr.models.ToolbarControlHelper);D.prototype.init=function A(){mstr.models.ToolbarControlHelper.prototype.init.apply(this,arguments);var E=this.get("parent");E.attachEventListener(this,"set_value","queueValue");};D.prototype.queueValue=function C(E){if(this.get("synchronizing")){return ;}var F=E.memo.value;var G=this.get("parent");var H=G.get("parent");H.queueValue(G.get("queueGroup"),this.getCmdId(),F);};D.prototype.synchronizeControl=function B(){var E=this.get("parent");E.get("parent").clearQueuedValues(E.get("queueGroup"),this.getCmdId());var F="";if(mstr.models.ToolbarControlHelper.prototype.synchronizeControl.apply(this,arguments)){var G=this.getTarget();F=G.commands.queryState(this.getCmdId())||"";}this.set("synchronizing",true);this.get("parent").set("value",F);this.set("synchronizing",false);};function D(E){mstr.models.ToolbarControlHelper.apply(this,[E]);}return D;})();mstr.models.ToolbarButtonModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.DEFAULTS={tooltip:"",enabled:true,visible:true};function A(B){mstr.models.BaseModel.apply(this,[B]);}return A;})();mstr.models.BlockContainer=(function(){mstr.$O.extendsClass(B,mstr.models.BaseModel);B.prototype.init=function A(){mstr.models.BaseModel.prototype.init.call(this,["models","views"]);var D,G,F,C;var E=this.props[mstr.$W.DOCUMENT];G=this.props.models;for(D=0;G&&G.length&&D<G.length;D++){F=G[D][mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(G[D],E);if(F){G[D]=F;C=F.props&&(F.props[mstr.$W.PARENT]=this);C=F.init&&F.init();}}G=this.props.views;for(D=0;G&&G.length&&D<G.length;D++){F=G[D][mstr.$W.SCRIPTCLASS]&&mstr.controllers.Factory.registerJSON(G[D],E);if(F){G[D]=F;C=F.props&&(F.props[mstr.$W.PARENT]=this);C=F.init&&F.init();}}};function B(C){mstr.models.BaseModel.apply(this,[C]);}return B;})();mstr.models.InsertLayoutEditor=(function(){mstr.$O.extendsClass(D,mstr.models.BaseModel);D.prototype.init=function C(){this.props.existingLayouts.styleName="WidgetFolderStyle";mstr.models.BaseModel.prototype.init.call(this,["models","views"]);var H=["tabList","newDashboardLayouts","newDocumentLayouts","existingLayouts"];for(var G=0;G<4;G++){var F=this.get(H[G]);F.attachEventListener(this,"hashadd_selectedIndices","updateCommandEnabledSubmitModel");F.attachEventListener(this,"hashremove_selectedIndices","updateCommandEnabledSubmitModel");}};D.prototype.updateCommandEnabledSubmitModel=function A(){this.set("CommandEnabledSubmitModel",(this._getSelectedItem()!=null));};D.prototype.execSubmitModel=function B(){var H=this._getSelectedItem();if(!H){return false;}var I=mstr.$obj(this.props.boneId);if(I){I.commands.exec("unloadDocViewer");}var G=this.get("tabList").getSelectedIndex()!=2?"1":"0";var F=microstrategy.updateManager;F.add([F.createActionObject(null,mstrUpdateManager.RW_IMPORT_DOC,mstr.$obj("mstrPageInfo").get("beanPath"),["2048001","2048175"],[H.dssid,G])]);F.flushAndSubmitChanges();return true;};D.prototype._getSelectedItem=function E(){var F=this.get("tabList").getSelectedIndex();if(F==NaN||F==-1){return null;}if(F==0){p="newDashboardLayouts";}else{if(F==1){p="newDocumentLayouts";}else{if(F==2){p="existingLayouts";}}}return this.get(p).getSelectedItem();};function D(F){mstr.models.BaseModel.apply(this,[F]);}return D;})();mstr.models.ContextMenuModel=(function(){mstr.$O.extendsClass(CMM,mstr.models.BaseModel);CMM.prototype.execPopulate=function CMM_execPopulate(){if(this.gridMenuItemsMap[this.getGridKey()]==null){var ondemandMenusRequestInputs=null;ondemandMenusRequestInputs=new mstr.http.OndemandContextMenuInputs(this.getGridKey());this.submitRequest(ondemandMenusRequestInputs,{});}else{this.raiseEvent("set_menu_ready",null);}};CMM.prototype.clearMenuItems=function CMM_clearMenuItems(gridKey){this.gridMenuItemsMap[gridKey]=null;this.submittedGridKeys[gridKey]=null;};CMM.prototype.submitRequest=function CMM_submitRequest(reqInputs,memo){this.raiseEvent("set_menu_processing",null);if(this.submittedGridKeys[this.getGridKey()]==null){var id=mstr.models.BaseModel.prototype.submitRequest.apply(this,[reqInputs,memo]);this.submittedGridKeys[this.getGridKey()]=id;}};CMM.prototype.setGridKey=function CMM_setGridKey(key){this.gridKey=key;};CMM.prototype.getGridKey=function CMM_getGridKey(){return this.gridKey;};CMM.prototype.setCurrentDynamicMenuKey=function CMM_setCurrentDynamicMenuKey(key){this.currentDynamicMenuKey=key;};CMM.prototype.getCurrentDynamicMenuKey=function CMM_getCurrentDynamicMenuKey(){return this.currentDynamicMenuKey;};CMM.prototype.onRequestCallback=function CMM_onRequestCallback(req){mstr.models.BaseModel.prototype.onRequestCallback.apply(this,[req]);switch(this.props.readyState){case mstr.Enum.Widget.READYSTATE.ERROR:this.raiseEvent("set_hide_menu_processing",null);this.submittedGridKeys[this.getGridKey()]=null;break;}};CMM.prototype.loadRequestResponse=function CMM_loadRequestResponse(){var ctxt=this.props.requestContext;var data=ctxt&&ctxt.response&&ctxt.response.data;if(!data){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);this.submittedGridKeys[this.getGridKey()]=null;return ;}if(data.dynamicMenus&&data.menuItems){var dyn_avItems=eval(data.dynamicMenus);var gridKey=this.getGridKey();for(var i=0;i<dyn_avItems.length;i++){var dynamicMenuKey=dyn_avItems[i][0];this.dynamicMenusMap[gridKey+dynamicMenuKey]=dyn_avItems[i][1];}this.gridMenuItemsMap[gridKey]=eval(data.menuItems);}this.props.requestContext={};this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);this.raiseEvent("set_hide_menu_processing",null);this.raiseEvent("set_menu_ready",null);};CMM.prototype.getMenuItems=function CMM_getMenuItems(){return this.gridMenuItemsMap[this.getGridKey()];};CMM.prototype.getCurrentMenuItemIndices=function(){var hashKey=this.getGridKey()+this.getCurrentDynamicMenuKey();return this.dynamicMenusMap[hashKey]||null;};function CMM(props){mstr.models.BaseModel.apply(this,[props]);this.gridMenuItemsMap=[];this.dynamicMenusMap=[];this.currentDynamicMenuKey=null;this.gridKey=null;this.submittedGridKeys=[];}return CMM;})();mstr.models.ToolbarPickerListModel=(function(){mstr.$O.extendsClass(C,mstr.models.ListModel);C.prototype.on_hashadd_selectedIndices=function B(E){this._storeLastSelection(E);mstr.models.ListModel.prototype.on_hashadd_selectedIndices.apply(this,arguments);};C.prototype.on_hashremove_selectedIndices=function A(E){this._storeLastSelection(E);mstr.models.ListModel.prototype.on_hashremove_selectedIndices.apply(this,arguments);};C.prototype._storeLastSelection=function D(E){var F=this.get("toolbarHelper");if(!F||!F.get||F.get("synchronizing")){return ;}this.set("lastSelection",mstr.utils.Hash.firstKey(E.memo.at));};function C(E){mstr.models.ListModel.apply(this,[E]);}return C;})();mstr.models.ToolbarBorderListModel=(function(){mstr.$O.extendsClass(B,mstr.models.ToolbarPickerListModel);B.prototype.execToggleSelect=function A(C){var F=this.props.selectedIndices;if(F[C]){if(C<2){return false;}else{if(F[0]){this.execRemoveSelect(0);}}this.execRemoveSelect(C);if(!F[2]&&!F[3]&&!F[4]&&!F[5]){C=1;this.execAddSelect(C);}}else{if(C==1){this.execClearSelect();}else{if(F[1]){this.execRemoveSelect(1);}if(C==0){for(var D=2;D<6;D++){if(!F[D]){this.execAddSelect(D);}}}else{var E=mstr.utils.Hash.clone(F);E[C]=true;if(E[2]&&E[3]&&E[4]&&E[5]){this.execAddSelect(0);}}}this.execAddSelect(C);}this.set("leadIndex",C);return true;};function B(C){mstr.models.ToolbarPickerListModel.apply(this,[C]);}return B;})();mstr.behaviors.TriStateCheckBox=(function(){var B={};B._DISABLED="Disabled";B._INTERMEDIATE="Intermediate";B._ON="On";B._OFF="Off";B.on_set_enabled=function D(F,G,J){var H=J.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0];var E=J.childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0];var I=F.props.cssPrefix+F.props.cssClass;if(F.props.enabled==false){H.className=I+this._DISABLED;E.className=I+"Caption"+this._DISABLED;return ;}else{this.setTriState(F,G,J);}};B.on_model_hashadd_selectedIndices=function C(E,F,G){if(E.get("enabled")){this.setTriState(E,F,G);}};B.setTriState=function A(H,I,L){var J=L.childNodes[0].childNodes[0].childNodes[0].childNodes[0].childNodes[0];var G=L.childNodes[0].childNodes[0].childNodes[0].childNodes[1].childNodes[0];var K=H.props.cssPrefix+H.props.cssClass;var E=I.getSelectedIndex();var F=I.props.items[E].cssClass;switch(E){case 0:J.className=K+(F||this._INTERMEDIATE);break;case 1:J.className=K+(F||this._ON);G.className=K+"Caption"+(F||this._ON);break;case 2:J.className=K+(F||this._OFF);G.className=K+"Caption"+(F||this._OFF);break;}};return B;})();mstr.behaviors.ToolbarPickerButton=(function(){var C=mstr.$H.clone(mstr.behaviors.Pulldown);C.on_set_enabled=function B(F,H,J){var G=!!F.props.enabled;J.disabled=!G;var I="0px",E="0px";if(!G){I="20px";E="22px";}var D=J.childNodes[1].rows[0].cells[1].firstChild.childNodes[3];D.style.height=I;D.style.width=E;};C.pickerButtonPushed=function A(E){var F=mstr.$obj(E);if(!F.get("enabled")){return ;}var D=F.getModel();var G=D.get("toolbarHelper");if(G&&G.pickerButtonPushed&&!G.pickerButtonPushed()){mstr.behaviors.ToolbarPickerButton.onmousedown(E);}};return C;})();mstr.behaviors.ColorPickerPopup=(function(){var A={elements:{0:mstr.Enum.ColorPickerFlags.NO_COLOR,1:mstr.Enum.ColorPickerFlags.AUTOMATIC,3:mstr.Enum.ColorPickerFlags.USER_COLORS,4:mstr.Enum.ColorPickerFlags.MORE_COLORS,5:mstr.Enum.ColorPickerFlags.GRADIENT_COLORS,6:mstr.Enum.ColorPickerFlags.GRAPH_GRADIENTS}};A.resolveViewFlags=function B(D){var C=D.props.viewFlags;for(var E in A.elements){if(!!(C&A.elements[E])){D._showChildViewAtPath("children/"+E);}else{mstr.controllers.Factory.safeset(D.props.children[E],"visible",false);}}};return A;})();mstr.itemrenderers.FastTileView=(function(){var B=mstr.$H.clone(mstr.itemrenderers.FastListView);B.renderListItem=function A(L,F,P,D,C){var R=D.item;var U=L.props[mstr.$W.DOCUMENT];var J=(L.props.cssPrefix||"")+(L.props.itemCSSPrefix||"");if("enabled" in R&&!R.enabled){J+="Disabled";}var G=U.createElement("div");if(R.cssClass){G.className=R.cssClass+" "+J;}else{G.className=J;}if(R.cssText){G.style.cssText=R.cssText;}if(R.desc!=null&&R.desc!=""){G.title=R.n+". "+R.desc;}else{G.title=R.n||"";}var V=U.createElement("div");G.appendChild(V);V.className=J+"Name";if(L.props.showDescriptions&&R.desc){var O=U.createElement("div");G.appendChild(O);O.className=J+"Desc";O.appendChild(U.createTextNode(R.desc));}else{var O=null;}if(L.props.itemCSSPrefix!="TileViewItem"){var T=U.createTextNode(R.n||"");var S=D.browseCommand;if(S&&!R.locked){var K=U.createElement("a");V.appendChild(K);K.appendChild(T);K.href="javascript:void(0)";S=null;}else{V.appendChild(T);}}if(L.props.showIcons&&!C){var Q=R.icon;if(R.locked){Q+="_locked";}var H=U.createElement("div");H.className="mstrTileViewImgContainer";V.appendChild(H);var I;if(!Q){var N=microstrategy.bones.ribbon_graphToolbar.block.get("major").getSelectedItems();if(N){var E=mstr.Settings.Scheme.LARGEPREVIEWS[N[0].icon];I=E+"_"+R.dssid;H.className+=" "+E+"_subtype";}}else{I=mstr.Settings.Scheme.LARGEPREVIEWS[Q];}if(I){if(I.substr(0,5)=="graph"&&Q){H.className+=" graphBgImg";}H.className+=" "+I;if(L.props.itemCSSPrefix!="TileViewItem"){V.style.paddingLeft="23px";if(O){O.style.paddingLeft="23px";}}}else{if(Q){H.className+=" "+Q;if(L.props.itemCSSPrefix!="TileViewItem"){V.style.paddingLeft="23px";if(O){O.style.paddingLeft="23px";}}}}var M=U.createElement("div");M.className=J+"NameImg";H.appendChild(M);M.onmouseover=this.hover;M.onmouseout=this.unhover;}return G;};return B;})();mstr.itemrenderers.PreviewPickerView=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListPulldownView);A.renderListItem=function(B,D,I,E){var C=mstr.itemrenderers.FastTileView.renderListItem(B,D,I,E,true);var H=this._getContentContainer(I);mstr.utils.Dom.clearChild(H,0);H.appendChild(C);H.title=C.title||"";if(mstr.utils.ISIE4){var F=H.style,G=F.width;if(G==null){G="";}F.width="1px";F.width=G;}};return A;})();mstr.itemrenderers.ColorPickerView=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListPulldownView);A.renderListItem=function(B,C,E,D){this._renderItem(B,C,E,D.item);};A.renderEmpty=function(C,D,H,E){var G=D&&D.get("actualColor");if(G){var B=D.get("valueForm");var F={};F[B]=G;if(B!="n"){F.n=microstrategy.descriptors.getDescriptor("2133")+" "+G;}this._renderItem(C,D,H,F);}else{mstr.itemrenderers.ListPulldownView.renderEmpty(C,D,H,E);}};A._renderItem=function(E,C,J,I){var F=E.props[mstr.$W.DOCUMENT];var D=(E.props.cssPrefix||"")+(E.props.itemCSSPrefix||"");var B=F.createElement("div");B.className=D+"ColorItem";var G=I[C.get("valueForm")];if(G!=null&&G.indexOf(",")>-1){mstr.itemrenderers.GradientItem.renderGradientItem(B,G,80,12);}else{if(G!="#"&&(!(bIsIE6||bIsIE7||bIsIE8||bIsIE9)||G!="0")){B.style.backgroundColor=(G!="automatic")?G:"transparent";}if(I.n){B.setAttribute("title",I.n);}if(G.toLowerCase()=="transparent"||G.toLowerCase()=="automatic"){B.style.border="1px dashed #999999";}}var H=this._getContentContainer(J);mstr.utils.Dom.clearChild(H,0);H.appendChild(B);};return A;})();mstr.itemrenderers.ColorPickerListView=(function(){var C=mstr.$H.clone(mstr.itemrenderers.ListView);C.renderListItem=function(I,E,M,D){var L=D.item;var K=I.props[mstr.$W.DOCUMENT];var G=(I.props.cssPrefix||"")+(I.props.itemCSSPrefix||"");var H=(L.dssid=="transparent");if(!I.props.renderTransparent&&H){return null;}var F=(L.dssid=="automatic");if(!I.props.renderAutomatic&&F){return null;}if(L.dssid.indexOf(",")>-1){return null;}var J=K.createElement("span");J.className=G+I.props.itemCssClass;J.style.backgroundColor=L.dssid;J.setAttribute("title",L.n);J.onmouseover=this.hover;J.onmouseout=this.unhover;if(H){J.style.cursor="default";}this._insertElementForIndex(I,M,D.at,J);return J;};C.on_set_visible=function B(D,G,I){var H=D.props.visible;if(H){var F=mstr.$obj("mstrPageInfo")&&mstr.$obj("mstrPageInfo").get("userPalette");if(F){if(G&&G.getSelectedItem()){F.execClearSelect();}else{var E=G&&G.get("actualColor");if(E){F.execSelectValue(E.toUpperCase());}}}}mstr.behaviors.Generic.set_css_display(I,"block","none",D.props.visible);};C.hover=function A(){this.className+="Hover";};C.unhover=function A(){this.className=this.className.replace(/Hover/,"");};return C;})();mstr.itemrenderers.GradientItem=(function(){var A={};A.renderGradientItem=function(B,O,G,N){var L=O.split(",");var K=mstr.utils.Color.hex2rgb(L[0]);var J=mstr.utils.Color.hex2rgb(L[1]);var T=gradientUtil.GRADIENTSHADING_STYLE_CUSTOM;var F=1;var C=L[2];var Q=parseInt(L[3],10);var E=parseInt(L[4],10);var D=parseInt(L[5],10);if(C=="9"){T=gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER;F=3;}else{if(C=="10"){if(E==50){T=gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER;if(Q==45){F=2;}}else{T=gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER;if(E+D==200){F=3;}else{if(E+D==100){F=(E==100)?2:4;}}}}else{if(Q==0||Q==90){T=(Q==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;}else{T=(Q==135)?gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP:gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN;}var P=(Q==0)?E:D;if(P==100){F=2;}else{if(P==50){F=3;}}}}var R=(G/gradientUtil.PIXEL_WIDTH)*(N/gradientUtil.PIXEL_WIDTH);for(var M=0;M<R;M++){var I=document.createElement("div");I.className="pixel";var S=gradientUtil.getColorPercent(gradientUtil.getXCoordinate(M,G),gradientUtil.getYCoordinate(M,N),F,G,T);var H=parseInt(S*(J[0]-K[0]))+K[0];var O=parseInt(S*(J[1]-K[1]))+K[1];var U=parseInt(S*(J[2]-K[2]))+K[2];I.style.backgroundColor="rgb("+H+", "+O+", "+U+")";B.appendChild(I);}};return A;})();mstr.itemrenderers.GradientListView=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListView);A.renderListItem=function(I,F,M,D){var L=D.item;var K=I.props[mstr.$W.DOCUMENT];var G=(I.props.cssPrefix||"")+(I.props.itemCSSPrefix||"");var J=K.createElement("span");J.className=G;J.setAttribute("title",mstr.itemrenderers.GradientListView._buildTooltip(L.dssid,L.flashOnly));mstr.itemrenderers.GradientItem.renderGradientItem(J,L.dssid,50,50);var H=document.createElement("span");var C=I.props;H.className=C.cssPrefix+C.cssClass+"ItemContainer";var E=document.createElement("span");E.innerHTML=L.flashOnly?microstrategy.descriptors.getDescriptor("4875"):"&nbsp;";E.style.paddingLeft="5px";H.appendChild(E);H.appendChild(J);J=H;this._insertElementForIndex(I,M,D.at,J);return J;};A._buildTooltip=function B(E,D){var F=E.split(",");var C=microstrategy.descriptors.getDescriptor("4883")+" ";if(F[2]=="9"){C+=microstrategy.descriptors.getDescriptor("4889");}else{if(F[2]=="10"){C+=microstrategy.descriptors.getDescriptor("4862");}else{C+=microstrategy.descriptors.getDescriptor("4888");}}C+="; "+microstrategy.descriptors.getDescriptor("4884")+" "+F[3]+"; "+microstrategy.descriptors.getDescriptor("4885")+" "+F[5]+"; "+microstrategy.descriptors.getDescriptor("4886")+" "+F[4];if(D){C+="; "+microstrategy.descriptors.getDescriptor("4875");}return C;};return A;})();mstr.itemrenderers.ToolbarRadioButtons=(function(){var B=mstr.$H.clone(mstr.itemrenderers.ListView);B.renderListItem=function(G,E,L,D){var J=D.item;var I=G.props[mstr.$W.DOCUMENT];var F=(G.props.cssPrefix||"")+(G.props.itemCSSPrefix||"");var H=I.createElement("a");H.className=F;H.setAttribute("title",J.n);var K=I.createElement("span");if(J.id){K.setAttribute("id",J.id);}K.setAttribute("align","absmiddle");K.onmouseover=function(){mstr.itemrenderers.ToolbarRadioButtons.markListItemAsSelected(G,E,L,D);};K.onmouseout=function(){mstr.itemrenderers.ToolbarRadioButtons.markListItemAsUnselected(G,E,L,D);};H.appendChild(K);this._insertElementForIndex(G,L,D.at,H);return H;};B.markListItemAsSelected=function C(D,E,H,F){var G=this._findElementForIndex(D,H,F.at);if(G){G.className+=" on";}};B.markListItemAsUnselected=function A(D,E,H,F){var G=this._findElementForIndex(D,H,F.at);if(G){G.className=G.className.replace(" on","");}};return B;})();mstr.itemrenderers.ToolbarPickerButton=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListPulldownView);A.renderListItem=function(C,D,F,E){if(C.get("showLastSelection")){var B=D.get("lastSelection");if(!isNaN(B)){E.item=D.getItems()[D.get("lastSelection")];}else{return ;}}mstr.itemrenderers.ListPulldownView.renderListItem.apply(this,[C,D,F,E]);this._updatePickerButton(C,F);};A.renderMultipleItems=function(B,C,E,D){this.renderListItem(B,C,E,D);};A._updatePickerButton=function(B,H){var F=B.getModel().get("tooltip");var E=this._getContentContainer(H);var G=[E];if(B.get("useDynamicBtnImg")){if(E.firstChild.nodeType==3){E.innerHTML="";}else{E.replaceChild(E.firstChild.cloneNode(false),E.firstChild);G.push(E.firstChild);}}else{E.removeChild(E.firstChild);}if(F){for(var D=0,C=G.length;D<C;D++){G[D].setAttribute("title",F);}}};A.renderEmpty=function(B,C,E,D){};A._getContentContainer=function(B){return B.childNodes[1].rows[0].cells[1].firstChild.childNodes[1];};return A;})();mstr.itemrenderers.VerticalTileList=(function(){var A=mstr.$H.clone(mstr.itemrenderers.ListView);A.renderListItem=function(F,D,K,B){var H=B.item;var G=F.props[mstr.$W.DOCUMENT];var E=(F.props.cssPrefix||"")+(F.props.itemCSSPrefix||"");var C=G.createElement("div");C.className=E;C.setAttribute("id","vt_"+H.dssid);if(F.props.showDescriptions&&H.desc){C.setAttribute("title",H.desc);}if(F.props.showIcons){var J=G.createElement("div");J.className=E+"Img";C.appendChild(J);}var I=G.createElement("div");I.className=E+"Txt";I.innerHTML=H.n;C.appendChild(I);this._insertElementForIndex(F,K,B.at,C);return C;};return A;})();mstr.itemrenderers.FontList=(function(){var E={};E.renderListItem=function A(F,G,J,H){var I=mstr.itemrenderers.FastListView.renderListItem.apply(this,[F,G,J,H]);I.style.fontFamily=H.item[G.get("valueForm")];return I;};E.hover=function(F){this.className+="Hover";};E.unhover=function(F){this.className=this.className.replace(/Hover/,"");};E.markListItemAsSelected=function C(F,G,I,H){mstr.itemrenderers.FastListView.markListItemAsSelected.apply(this,[F,G,I,H]);};E.markListItemAsUnselected=function B(F,G,I,H){mstr.itemrenderers.FastListView.markListItemAsUnselected.apply(this,[F,G,I,H]);};E.on_set_leadIndex=function D(F,G,H){mstr.itemrenderers.FastListView.on_set_leadIndex.apply(this,[F,G,H]);};return E;})();mstr.itemrenderers.TabTreeList=(function(){var G={};var E=function(K){var J=mstr.utils.ListViewHelper.getItemRenderer(this);J&&J.on_target_object_change(this,this.getModel(),this.get("element"),{item:K.src,at:this.getModel().indexOfItem(K.src)});};G.on_target_object_change=function F(P,M,S,K){var Q=K.item;var L=mstr.itemrenderers.TabTreeList.findElementFromIndex(P,M,S,K);var O=Q.get(Q.get("visibleField"));L.style.display=(O)?"block":"none";var J=Q.get("categoryText");var N=P.props.categoryElems;if(N&&N[J]){var R=N[J]["visibleElems"];R+=Q.get(Q.get("visibleField"))?1:-1;N[J]["visibleElems"]=R;N[J]["elem"].style.display=(R==0)?"none":"block";}};G.renderListItem=function I(Q,N,W,L){var a=Q.props.document;var P=(Q.props.cssPrefix||"")+(Q.props.cssClass||"");var V=Q.get("scrollArea").childNodes[0];var R=N.getItems();var X=L.item;var T=X.get("categoryText");var O=null;var U=N.get("valueForm");var Z=Q.props.categoryElems;if(!Z){Z=[];Q.props.categoryElems=Z;}if(L.at==0||T!=R[L.at-1].get("categoryText")){O=a.createElement("div");O.className=P+"TabTreeItemCategory";O.appendChild(a.createTextNode(T));V.appendChild(O);var S=X[U];if(S==null&&X.get){S=X.get(U);}O.mstrListItemInfo=Q.getId()+"/"+(S||"")+"/"+L.browseCommand;Z[T]={elem:O,visibleElems:0};O.style.display="none";}var J=X.get("titleField"),c=X.get("titleText"),Y=a.createElement("div");if(J!=null){c=X.get(J);Q._notifyTitleChanged=function(){c=X.get(J);Y.innerHTML="";Y.appendChild(a.createTextNode(c));};X.attachEventListener(Q,"set_"+J,"_notifyTitleChanged");}Y.className=P+"TabTreeItem";V.appendChild(Y);Y.onmouseover=this.hover;Y.onmouseout=this.unhover;Y.appendChild(a.createTextNode(c));var K=X.get("visibleField");var M=false;if(K!=null){M=X.get(K);if(!Q._notifyItemRenderer){Q._notifyItemRenderer=E;}X.attachEventListener(Q,"set_"+K,"_notifyItemRenderer");}else{M=X.get("visible");}Y.style.display=M?"block":"none";if(M){Z[T]["elem"].style.display="block";Z[T]["visibleElems"]++;}return Y;};G.markListItemAsSelected=function H(J,K,O,L){var M=mstr.itemrenderers.TabTreeList.findElementFromIndex(J,K,O,L);if(!M){return ;}var N=M.className;if(/Hover/.test(N)){N=N.replace(/Hover/,"SelectedHover");}else{N+="Selected";}M.className=N;};G.markListItemAsUnselected=function B(J,K,N,L){var M=mstr.itemrenderers.TabTreeList.findElementFromIndex(J,K,N,L);if(M){M.className=M.className.replace(/Selected/,"");}};G.hover=function C(){this.className+="Hover";};G.unhover=function D(J){this.className=this.className.replace(/Hover/,"");};G.findElementFromIndex=function A(Q,N,S,K){var O=parseInt(K.at);if(isNaN(O)||O<0){return null;}var P=N.getItems();var R=0;var M="";for(var L=0;L<=O;L++){var J=P[L].get("categoryText");if(J!=M){R++;}M=J;}return Q.get("scrollArea").childNodes[0].childNodes[O+R];};return G;})();mstr.behaviors.FontPreview=(function(){var A={};A.on_set_enabled=function(C,B){if(B){C.className=C.className.replace("Disabled","");}else{if(C.className.indexOf("Disabled")==-1){C.className+="Disabled";}}};A.on_model_set_prop=function(K,B,H,E){var I=E&&E.get(H.get(B));if(I instanceof mstr.models.ColorPicker){I=I.get("actualColor");}else{if(I instanceof mstr.models.ListModel){var J=I.getSelectedItem();var F=I.get("valueForm");I=(J&&J[F])||(B=="fontFamily"&&"Arial")||(B=="fontSize"&&"10")||I.getItems()[0][F];}}if(isNaN(I)&&!I){return ;}var D=K.childNodes[1];if(B=="boldItalic"){D.style.fontWeight=(I==1||I==3)?"bold":"normal";D.style.fontStyle=(I==2||I==3)?"italic":"normal";}else{switch(B){case"fontSize":I+="pt";break;case"textUnderline":case"textStrikeout":B="textDecoration";var C=E.get(H.get("textUnderline"));var G=E.get(H.get("textStrikeout"));if(!C&&!G){I="none";}else{I=(C)?"underline":"";I+=(G)?" line-through":"";}break;case"fontColor":B="color";D.style.backgroundColor=mstr.utils.Color.getContrastingColor(I,["#ffffff","#000000"]);break;}D.style[B]=I;}};return A;})();mstr.behaviors.ImagePreview=(function(){var B={};B.on_set_src=function(Q,J,E){if(Q.intervalHandle){window.clearInterval(Q.intervalHandle);}mstr.$D.clearChilds(Q);var G=E.get(J.get("valueField"));if(!G||G.length==0){return ;}if(G!==""){var S=document.getElementById("imgUrl_txt");if(S){var I=microstrategy.getViewerBone().doc.prevSelectedId,D=document.getElementById(I),K=Number(D.getAttribute("ut")),M=mstrmojo.string;switch(K){case mstr.Enum.IMAGE_URL_TYPE.DUMMY_URL:S.value="";return ;case mstr.Enum.IMAGE_URL_TYPE.TASK_URL:S.value=decodeURIComponent(D.getAttribute("n"));break;case mstr.Enum.IMAGE_URL_TYPE.BLOB_URL:case mstr.Enum.IMAGE_URL_TYPE.IMAGE_NAME:G=Q.blobURL;S.value=Q.imgName;break;}}}if(mstr.utils.ISFF){var L=G.split("?");if(L.length>1){L[0]=L[0].replace(/\\/g,"/");G=L.join("?");}else{G=L[0].replace(/\\/g,"/");}}var T=J.get("document").createElement("img");T.style.visibility="hidden";T.src=G;var C=J.get(mstr.Props.Widget.ELEMENT);var N=mstr.utils.BoxModel.getElementInnerWidth(C),R=mstr.utils.BoxModel.getElementInnerHeight(C);if(!N||!R){N=parseInt(mstr.utils.CSS.getStyleValue(C,"width"));R=parseInt(mstr.utils.CSS.getStyleValue(C,"height"));}N=Math.max(N-6,0);R=Math.max(R-6,0);var H=N/R;var F=new Date();var O=false;Q.intervalHandle=window.setInterval(function(){var X=(T.readyState=="complete"||T.complete);var W=(new Date()-F>=5000);var V=mstr.utils.BoxModel.getElementOuterWidth(T);var Y=mstr.utils.BoxModel.getElementOuterHeight(T);var U=mstr.utils.ISIE4?(T.readyState=="loading"):(V&&Y);if(X||W||O||U){window.clearInterval(Q.intervalHandle);(U||X)&&P();}T.style.visibility="visible";},100);var P=function(){var U=mstr.utils.BoxModel.getElementOuterWidth(T);var V=mstr.utils.BoxModel.getElementOuterHeight(T);var W=U/V;if(V>R||U>N){if(W>H){U=N;V=(N/W);}else{V=R;U=V*W;}T.style.width=U+"px";T.style.height=V+"px";}T.style.marginTop=Math.abs(((R-V)/2))+3+"px";};T.onload=P;T.onerror=function(){O=true;P();};Q.appendChild(T);};B.on_set_visible=function A(E,G,C,D){mstr.behaviors.Generic.set_css_display(E,G,C,D);if(!mstr.utils.ISIE4){return ;}var F=E.getElementsByTagName("img");if(F[0]){F[0].style.visibility=(!!D)?"visible":"hidden";}};return B;})();mstr.behaviors.Tab=(function(){var A={};A.on_set_visible=function(H,B,C){var F=!!B.props.visible;var D=H.style;D.display=F?"block":"none";D.visibility=F?"inherit":"hidden";var E=(B.get("helpTopic")==null?"":B.get("helpTopic"));var G=B.props[mstr.$W.PARENT];while(G&&!(G instanceof mstr.views.FloatingEditor)){G=G.props[mstr.$W.PARENT];}if(G&&(G instanceof mstr.views.FloatingEditor)){G.set("helpTopic",E);}};return A;})();mstr.itemrenderers.TabbedToolbarView=(function(){var C=mstr.$H.clone(mstr.itemrenderers.ListView);C.markListItemAsUnselected=function B(D,E,H,F){var G=this._findElementForIndex(D,H,F.at);if(!G){return ;}G.className=G.className.replace(/SelectedHover/,"");G.className=G.className.replace(/Selected/,"");G.className=G.className.replace(/pinned/,"");};C.markListItemAsSelected=function A(D,E,I,F){var G=this._findElementForIndex(D,I,F.at);if(!G){return ;}var H=G.className;if(/Selected/.test(H)){H=H.replace(/Selected/,"");}if(/Hover/.test(H)){H=H.replace(/Hover/,"SelectedHover");}else{H+="Selected";}if(E.get("items")[F.at]["pinned"]){H="pinned "+H;}else{if(/pinned/.test(H)){H=H.replace(/pinned/,"");}}G.className=H;};C.renderListItem=function(N,J,Q,D){var F=mstr.itemrenderers.FastListView.renderListItem(N,J,Q,D);F.title="";var P=document.createElement("table");var R=P.insertRow(0);var H=R.insertCell(0);H.className="left";var G=R.insertCell(1);var M=R.insertCell(2);var E=F.childNodes[0];G.appendChild(E);G.className=E.className;E.className="";G.onmousedown=function(S){mstr.behaviors.ListView.onmousedown(S||window.event,self,N.get("id"));};var I=false;var O,K;if((O=J.get("items")[D.at])&&(feats=O.enabledFeatures)){I=!mstr.behaviors.featureResolver.resolveFeatSet(feats);}if(D.item.menuModel){M.className="right menu";var L=function(S){S=S||window.event;mstr.behaviors.ToolbarListView.displayMenu(S,N,J,D,P);};M.onmouseover=L;M.onmousedown=L;if(I){G.onmousedown=L;}M=null;}else{M.className="right";if(I){F.onmouseover=null;F.onmouseout=null;}}G=null;F.appendChild(P);P.cellSpacing=0;this._insertElementForIndex(N,Q,D.at,F);F.style.display=(D.item.visible)?"block":"none";return F;};C.hover=function(D){mstr.itemrenderers.FastListView.hover.apply(this,arguments);};C.unhover=function(D){mstr.itemrenderers.FastListView.unhover.apply(this,arguments);};return C;})();mstr.behaviors.ToolbarListView=(function(){var C={};C.displayMenu=function B(Q,N,K,G,R){if(!mstr.controllers.Factory.getPath(N.getModel().get("targetPath"),N)||!mstr.behaviors.ToolbarListView.shouldProcessEvt(Q,K)){return ;}if(G&&G.item){var D=G.item.menuStyle?G.item.menuStyle:K.props.menuStyle;var L=G.item.menuModel;var P=G.item.layouts;}if(!D){return ;}var H=mstr.$obj(mstr.behaviors.FloatingMenu.getMenuId({modelName:L,layouts:P}));if(H&&H.get("visible")){if(Q.type==="mousedown"){H.execCloseMenu();}return ;}var J=N.get("menus")||{};for(var F in J){if(F!==D){var I=mstr.$obj(F);if(I&&I.get&&I.get("visible")){I.execCloseMenu();}}}J[mstr.behaviors.FloatingMenu.getMenuId({modelName:L,layouts:P})]=true;N.set("menus",J);var E=R.parentNode;N.set("openerEl",E);mstr.behaviors.FloatingMenu.toggleOpenerHoverEffect(N,true);var O=mstr.utils.BoxModel.getElementSumOffsetLeft(R);var M=mstr.utils.BoxModel.getElementSumOffsetTop(R)+mstr.utils.BoxModel.getElementOuterHeight(R);O+=getDocumentScrollLeft();M+=getDocumentScrollTop();mstr.behaviors.FloatingMenu.displayMenu(N,O,M,D,L,P,document.body);};C.shouldProcessEvt=function A(D,E){return(!mstr.behaviors.featureResolver.featAvailable(E.get("featurePopMenus"))||D.type!=="mouseover");};return C;})();mstr.behaviors.ToolbarButton=(function(){var A={};A.setButtonClassName=function(C,F){var E=C.get("cssPrefix")+C.get("cssClass");var B=C.get("extraCssClass");if(B){E+=" "+B;}var D=C.get("enabled");if(!D){E+=" disabled";}if(C.getModel().get("state")||(F&&D)){E+=" on";}C.get("element").className=E;};return A;})();mstr.behaviors.FloatingMenu=(function(){var C={};C.displayMenu=function(J,K,I,E,H,L,F){if(J.get("requestingMenu")){return ;}microstrategy.setJLSCXMenuOpen(true);var D={cssText:"top:"+I+"px;left:"+K+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",showing:J.get("mOverOpen")?false:true,viewer:J.getModel().get("targetPath"),modelName:H,ribbonId:J.getModel().get("id")};if(L){D.layouts=L;}var G=microstrategy.getBlockEditorFromCache(this.getMenuId(D),null,D,J,F);if(G){return ;}mstr.behaviors.FloatingMenu.showProgressIndicator(J,K,I,F);J.set("requestingMenu",true);microstrategy.openBlockLoaderEditor(this.getMenuId(D),E,null,D,J,{scope:this,method:this.menuDisplayed},F);};C.getMenuId=function(D){var E=D.layouts?D.layouts.replace(/[.,\/]/g,""):"";return D.modelName+"_"+E;};C.menuDisplayed=function(D){var F=D.src.get("requestContext");var E=F&&F.memo&&F.memo.opener;if(E){this.killProgressIndicator(E);}var G=D&&D.memo&&D.memo.name;if(G=="readyState"){if(D.memo.value==mstr.Enum.Widget.READYSTATE.ERROR||D.memo.value==mstr.Enum.Widget.READYSTATE.CANCELLED){mstr.behaviors.FloatingMenu.toggleOpenerHoverEffect(E,false);}}};C.showProgressIndicator=function(F,E,H,D){var G={pn:D,handle:window.setTimeout(function(){var K=F.get("element").ownerDocument;var J=K.createElement("table");J.className="select-free mstrFloatingMenu mstrFloatingMenuProgress";J.style.top=H+"px";J.style.left=E+"px";var L=J.insertRow(-1).insertCell(-1);L.appendChild(K.createTextNode(microstrategy.descriptors.getDescriptor("2901")));var I=G.pn||K.body;I.appendChild(J);G.indicator=J;},3000)};F.set("progressIndicator",G);D=null;};C.killProgressIndicator=function(D){var E=D&&D.get("progressIndicator");if(!E){return ;}var F=E.indicator;if(!F){window.clearTimeout(E.handle);}else{if(F.parentNode){F.parentNode.removeChild(F);}}D.set("progressIndicator",null);D.set("requestingMenu",false);};C.toggleOpenerHoverEffect=function A(D,G){var F=D&&D.get&&D.get("openerEl");if(!F){return ;}var E=mstr.utils.ListViewHelper.getItemRenderer(D);if(G){if(E&&E.hover){E.hover.call(F);}F.ignoreMouseEvents=true;}else{F.ignoreMouseEvents=false;if(E&&E.unhover){E.unhover.call(F);}}};C.adjustMenuPosition=function B(K){if(K.get("useFixedPosition")){return ;}var G=K.get("element");var E=G.parentNode;var N=K.get("document");var L=parseInt(G.style.left,10);var J=parseInt(G.style.top,10);var O=mstr.utils.BoxModel.getElementOuterWidth(G);var I=mstr.utils.BoxModel.getElementOuterHeight(G);var H=0;var F=0;var P=0;var M=0;if(E==N.body){P=getDocumentScrollLeft();M=getDocumentScrollTop();H=mstr.utils.BoxModel.getBrowserWindowWidth(N)+P;F=mstr.utils.BoxModel.getBrowserWindowHeight(N)+M;}else{P=E.scrollLeft;M=E.scrollTop;H=mstr.utils.BoxModel.getElementInnerWidth(E)+P;F=mstr.utils.BoxModel.getElementInnerHeight(E)+M;}if(L+O>H){var D=L;if(K.get("opener").get){D-=O;D-=mstr.utils.BoxModel.getElementOuterWidth(K.get("opener").get("element"));}else{D=H-O;}G.style.left=Math.max(D,P)+"px";}if(J+I>F){G.style.top=Math.max(F-I,M)+"px";}};C.onmouseout=function(E){var D=mstr.$obj(E);if(D.get&&D.get("hasToClose")){if(D.timeout){clearTimeout(D.timeout);}D.timeout=setTimeout("mstr.$obj('"+D.get("id")+"').set('visible',false);",2000);}};C.onmouseover=function(E){var D=mstr.$obj(E);if(D.timeout){clearTimeout(D.timeout);}};return C;})();mstr.behaviors.MenuOption=(function(){var A={};A.onmouseover=function D(F){var G=F.get("parent");G=G&&G.get("opener");if(G&&G.get){G=G.get("menuCloserTO");clearTimeout(G);}if(F.get("cmds")=="OpenSubMenu"){var H=F.get("menuCloserTO");if(H){clearTimeout(H);}H=window.setTimeout(function(){F.set("mOverOpen",true);mstr.behaviors.MenuOption.fireCommands(F,null);},250);F.set("menuOpenerTO",H);}};A.onmouseout=function E(F){if(F.get("cmds")!="OpenSubMenu"){return ;}var G=F.get("menuOpenerTO");if(G){clearTimeout(G);}G=window.setTimeout(function(){F.execCloseSubMenu();},350);F.set("menuCloserTO",G);};A.fireCommands=function C(G,F){if(!G.get("enabled")){return ;}G.fireCommands();if(!G.getModel().get("menuModel")){G.get("parent").execCloseMenu();}};A.updateCSS=function B(G,H){var J=G.get("cssPrefix");var F=G.get("cssClass");F+=G.get("extraCssClass")?" "+G.get("extraCssClass"):"";var I="";if(!G.get("enabled")){I=" disabled";}if(G.props.pressed||(G.props.model&&G.props.model.props.state)){I+=" pressed";}if(H&&G.get("enabled")){I+=" hover";}G.get("element").className=J+F+I;};return A;})();mstr.behaviors.FieldSet=(function(){var A={};A.set_fieldSet_enabled=function B(H,E){if(!E){var G=H.childNodes[1];var C=G&&G.lastChild;if(C&&C.id&&C.id.substring(0,12)=="fieldSetMask"){C.style.display="block";}else{H.style.position="relative";G.style.position="relative";var C=document.createElement("div");C.setAttribute("id","fieldSetMask_"+H.getAttribute("id"));var D=C.style;D.top="0px";D.left="0px";D.width="100%";D.height="100%";D.position="absolute";D.background="transparent url(images/1ptrans.gif) repeat";G.appendChild(C);}if(mstr.utils.ISFF||mstr.utils.ISWK||mstr.utils.ISIE10||mstr.utils.ISW3CIE){C.style.opacity="0.8";C.style.backgroundColor="#fafafa";}else{G.style.filter="progid:DXImageTransform.Microsoft.Alpha(opacity=30)";if(mstr.utils.ISIE6){window.setTimeout(function F(){C.style.height=G.offsetHeight;},0);}}}else{var G=H.childNodes[1];var C=G&&G.lastChild;if(C&&C.id&&C.id.substring(0,12)=="fieldSetMask"){C.style.display="none";if(mstr.utils.ISFF||mstr.utils.ISWK||mstr.utils.ISIE10||mstr.utils.ISW3CIE){G.style.opacity="1";}else{G.style.filter="";}}}};return A;})();mstr.http.SaveAnnotationsInputs=(function(){function A(E,C,B,D){this.params={taskId:"setAnnotations",objectID:E,objectType:C,annotation:B,isAppend:(typeof (D)!="undefined")?D:0,locale:mstr.Settings.Locale.ID};}return A;})();mstr.http.GetAnnotationsInput=(function(){function B(F,C,D,E){this.params={taskId:"getAnnotations",objectID:F,objectType:C,locale:mstr.Settings.Locale.ID,counter:A++};if(D){this.params.styleName=D;}else{this.params.styleName="AnnotationsStyle";}if(typeof (E)!="undefined"){this.params.juil=E;}}var A=0;return B;})();mstr.http.PingServer=(function(){function A(){this.params={taskId:"keepSessionAlive"};}return A;})();mstr.http.BlockLoaderInput=(function(){function A(B){this.params={taskId:"loadBlocks",styleName:B,juil:true};}return A;})();mstr.http.LoadToolbarInput=(function(){function A(){this.params={taskId:"loadToolbar",juil:true};}return A;})();mstr.http.FolderBlockLoaderInput=(function(){function A(B,C){this.params={taskId:"folderBrowse",styleName:B,juil:true};mstr.utils.Hash.overwrite(this.params,C);}return A;})();mstr.http.RwBlockLoaderInput=(function(){function A(C,E,B){this.params={taskId:"loadDocBlocks",styleName:C,juil:true};if(pageState){var D=(pageState+"&").match(/rwb=(.*?)\&/);if(D!=-1){this.params[E]=D[1];}}}return A;})();mstr.http.ReportBlockLoaderInput=(function(){function A(C,E,B){this.params={taskId:"loadReportBlocks",styleName:C,juil:true};if(pageState){var D=pageState.match(/rb=[^\&]*/);D=D[0].replace("rb=","");if(D!=-1){this.params[E]=D;}}}return A;})();mstr.http.GetGridFormats=(function(){function A(B,C){this.params={taskId:"getDocGridFormat",juil:true,docGridKey:B,msgID:C};}return A;})();mstr.http.GetRWGraphProperties=(function(){function A(B,C){this.params={taskId:"getRWGraphProperties",juil:true,docGridKey:B,msgID:C};}return A;})();mstr.http.GetReportGraphProperties=(function(){function A(B,C){this.params={taskId:"getReportGraphProperties",juil:true,stateID:C,msgID:B};}return A;})();mstr.http.OndemandContextMenuInputs=(function(){A.prototype.setDrillParams=function B(C){var D=microstrategy.findBone(microstrategy.activeCXMenu);var F=false;if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){F=true;}if(F){this.params={taskId:"ReportOndemandDrill",juil:true,styleName:"OndemandContextMenusStyle",ondemandDrillMinimalXML:true};if(pageState){var E=pageState.match(/rb=(.*?)(\&|$)/);if(E!=-1){this.params.rb=E[1];}}}else{this.params={taskId:"RWOnDemandDrill",juil:true,styleName:"OndemandContextMenusStyle",viewMode:D&&D.effectiveView||1,usePartDisplay:1,docGridKey:C,isQuickSwitchEnabled:D&&D.quickSwitchCurrent||false};if(pageState){var E=pageState.match(/rwb=(.*?)(\&|$)/);if(E!=-1){this.params.rwb=E[1];}}}};function A(C){this.setDrillParams(C);}return A;})();mstr.views.BaseView.prototype.taskModelCallback=function BV_taskModelCallback(B){switch(B.name){case"set_readyState":this.set("readyState",B.memo.value);if(B.memo.value==mstr.Enum.Widget.READYSTATE.IDLE){var A=this.taskModel.get("models")&&this.taskModel.get("models")[0];if(A){A.set("opener",this);}var C=this.taskModel.get("views")[0];if(C){C.set("opener",this);C.render();}}break;}};mstr.views.BaseView.prototype.execOpenModalPopup=function BV_execOpenModalPopup(B,A,D){self.supressWaitPage=true;A=A||{};D=D||{};var C,G;var I=mstr.$obj(B);if(I){var F=I.getModel();if(F){for(C in D){mstr.controllers.Factory.setPath(C,F,D[C],false);}F.set("opener",this);}for(C in A){mstr.controllers.Factory.setPath(C,I,A[C],false);}I.set("opener",this);I.set("visible",true);}else{var H=document.createElement("textarea");H.setAttribute("id",B);H.className="mstrJSON";this.get(mstr.$W.DOCUMENT).body.appendChild(H);var J=new mstr.http.BlockLoaderInput(B);for(C in D){J.params[C]=D[C];}for(C in A){J.params[C]=A[C];}if(!this.taskModel){this.taskModel=new mstr.models.TaskModel({parent:this});mstr.controllers.Factory.add(this.taskModel);var E=this.taskModel&&this.taskModel.init&&this.taskModel.init();this.taskModel.attachEventListener(this,"set_readyState","taskModelCallback");}this.set("readyState",mstr.Enum.Widget.READYSTATE.WAITING);this.taskModel.execFetchBlock(J,H);}window.setTimeout("self.supressWaitPage = false;",10);};mstr.views.FastTileView=(function(){mstr.$O.extendsClass(F,mstr.views.FastListView);F.DEFAULT_LIST_ITEM_HEIGHT=75;F.DEFAULT_LIST_ITEM_WIDTH=76;F.prototype._computeVisibleItemsRange=function E(){var H=mstr.views.FastListView.prototype._computeVisibleItemsRange.apply(this);if(H){var I=Math.max(parseInt(this.props.itemsPerRow)||1,1);H.min=H.min*I;H.max=(H.max+1)*I-1;}return H;};F.prototype._updateItemsContainerDimensions=function D(){mstr.views.FastListView.prototype._updateItemsContainerDimensions.apply(this);this._updateItemsContainerWidth();};F.prototype._updateItemsContainerHeight=function C(){var K=this.props.listItemsContainer;if(!K){return ;}var L=mstr.utils.ListViewHelper.getItemRenderer(this);var J=F.DEFAULT_LIST_ITEM_HEIGHT;if(J){var I=this.getModel();var H=mstr.$A.len(I&&I.getItems&&I.getItems()),N=Math.max(parseInt(this.props.itemsPerRow)||1,1),M=parseInt(H/N);if(H%N){M++;}J=J*M;}if(J){K.style.height=J+"px";}else{K.style.height=mstr.utils.ISIE4?"1px":"auto";}if(mstr.utils.ISIE4){K.style.overflow=J?"visible":"hidden";}};F.prototype._updateItemsContainerWidth=function G(){var J=this.props.listItemsContainer;if(!J){return ;}var I=this.getModel();var H=mstr.$A.len(I&&I.getItems&&I.getItems()),L=Math.max(parseInt(this.props.itemsPerRow)||1,1);J.style.width=(F.DEFAULT_LIST_ITEM_WIDTH*Math.min(H,L))+"px";var K=parseInt(H/L);if(mstr.utils.ISW3C&&(K*F.DEFAULT_LIST_ITEM_WIDTH>parseInt(this.props.height))){J.style.width=(parseInt(J.style.width)+SCROLLBAR_SIZE)+"px";}};F.prototype._adjustWhiteSpaceAboveItem=function B(H,I){return ;};F.prototype._adjustWhiteSpaceBelowItem=function A(H,I){return ;};function F(H){mstr.views.FastListView.apply(this,[H]);}return F;})();mstr.views.TabTreeListView=(function(){mstr.$O.extendsClass(A,mstr.views.ListView);A.prototype.execClickListItem=function B(J){var C=this.props.model;var F=C.indexOfValue(J.valueForm);if(F!=-1){var E=C.getItems();var I=E[F];var D=I&&I.get&&I.get("visibleField");if(D){if(!I.get(D)){for(var H=F,G=E.length;H<G;H++){D=E[H].get("visibleField");if(!D||E[H].get(D)){J.valueForm=E[H].getId();break;}}}}}return mstr.views.ListView.prototype.execClickListItem.apply(this,[J]);};function A(C){mstr.views.ListView.apply(this,[C]);}return A;})();mstr.views.AnnotationView=(function(){mstr.$O.extendsClass(G,mstr.views.BaseView);G.prototype.execResize=function F(){this.resize();return true;};G.prototype.resize=function D(I,H){if(H==null){H=mstr.utils.BoxModel.getElementOuterHeight(this.props[mstr.$W.ELEMENT]);}else{this.props[mstr.$W.ELEMENT].style.height=Math.max(H-26,0)+"px";}if(I==null){I=mstr.utils.BoxModel.getElementOuterWidth(this.props[mstr.$W.ELEMENT]);}else{this.props[mstr.$W.ELEMENT].style.width=Math.max(I-26,0)+"px";}this.nonEditableArea=this.nonEditableArea||document.getElementById("nonEditableArea");this.editableArea=this.editableArea||document.getElementById("editableArea");this.addArea=this.addArea||document.getElementById("addArea");this.editButtons=this.editButtons||document.getElementById("editButtons");this.scratchPad=this.scratchPad||document.getElementById("scratchPad");if(this.editableArea&&this.nonEditableArea){if(this.scratchPad){this.scratchPad.style.width=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.width),0)+"px";}this.editableArea.style.height=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.height)-mstr.utils.BoxModel.getElementOuterHeight(this.addArea)-mstr.utils.BoxModel.getElementOuterHeight(this.editButtons)-10,0)+"px";this.editableArea.style.width=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.width),0)+"px";this.nonEditableArea.style.height=this.editableArea.style.height;this.nonEditableArea.style.width=Math.max(parseInt(this.props[mstr.$W.ELEMENT].style.width),0)+"px";}};G.prototype.execUpdate=function B(H){if(H=="true"){this.addArea=this.addArea||document.getElementById("addArea");this.getModel().get("addition").set("value",this.addArea.firstChild.value);}else{this.editableArea=this.editableArea||document.getElementById("editableArea");this.getModel().set("value",this.editableArea.value);}};G.prototype.execValidateAdd=function E(H,I){if(!H||H.length==0){this.execConfirm(microstrategy.descriptors.getDescriptor("6156"));return false;}else{if((H.length+this.getModel().get("addition").get("prefixLen")+this.getModel().get("addition").get("postfixLen"))>mstr.models.AnnotationModel.ADDITION_MAX_LENGTH){return this.execConfirm("*Additional notes cannot be longer than ## characters. The note you are adding will be truncated if you proceed.*".replace(/##/,mstr.models.AnnotationModel.ADDITION_MAX_LENGTH));}else{if(this.getModel().get("value")&&((this.getModel().get("value").length+H.length)>mstr.models.AnnotationModel.NOTES_MAX_LENGTH)){return this.execConfirm("*Notes cannot be longer than ## characters. The note you are editing will be truncated if you proceed.*".replace(/##/,mstr.models.AnnotationModel.NOTES_MAX_LENGTH));}}}return true;};G.prototype.execValidateEdit=function C(H){if((H.length+this.getModel().get("postfixLen"))>mstr.models.AnnotationModel.NOTES_MAX_LENGTH){return this.execConfirm("*Notes cannot be longer than ## characters. The note you are editing will be truncated if you proceed.*".replace(/##/,mstr.models.AnnotationModel.NOTES_MAX_LENGTH));}return true;};G.prototype.setEditCursor=function A(){if(this.editableArea){this.editableArea.focus();if(mstr.utils.ISW3C){this.editableArea.scrollTop=this.editableArea.scrollHeight;}else{var H=this.editableArea.createTextRange();H.collapse(false);H.select();}}};function G(H){mstr.views.BaseView.apply(this,[H]);}return G;})();mstr.views.Slider=(function(){mstr.$O.extendsClass(S,mstr.views.BaseView);S.prototype._getThumb=function S__getThumb(){var el=this.get(mstr.Props.Widget.ELEMENT);return el&&el.lastChild.firstChild;};S.prototype._getTooltip=function S__getTooltip(){var el=this.get(mstr.Props.Widget.ELEMENT);return el&&el.lastChild.lastChild;};S.prototype.init=function S_init(){mstr.views.BaseView.prototype.init.apply(this,arguments);var m=this.getModel();if(m&&m.attachEventListener){m.attachEventListener(this,"set_"+this.get("xField"),"schedule_thumb_move");m.attachEventListener(this,"set_"+this.get("yField"),"schedule_thumb_move");}};S.prototype.render=function S_render(){mstr.views.BaseView.prototype.render.apply(this,arguments);this.schedule_thumb_move(null,true);if(!this.get("dnd")){return null;}var el=this.get("element").lastChild;var thumb=this._getThumb();var props={view:this};var f1,f2;var o=this.get("orientation");if(o=="h"||o=="b"){f1=function(){return Math.round(mstr.utils.BoxModel.getElementSumOffsetLeft(el)-(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2));};props.xMin=f1;props.xMax=function(){return f1()+mstr.utils.BoxModel.getElementInnerWidth(el);};}else{f1=function(){return mstr.utils.BoxModel.getElementSumOffsetLeft(el);};props.xMin=f1;props.xMax=f1;}if(o=="v"||o=="b"){f2=function(){return Math.round(mstr.utils.BoxModel.getElementSumOffsetTop(el)-(mstr.utils.BoxModel.getElementOuterHeight(thumb)/2));};props.yMin=f2;props.yMax=function(){return f2()+mstr.utils.BoxModel.getElementInnerHeight(el);};}else{f2=function(){return mstr.utils.BoxModel.getElementSumOffsetTop(el);};props.yMin=f2;props.yMax=f2;}this.set("dz",new mstr.models.dnd.DragZone(props,{findTarget:function(view,e){var t=mstr.utils.Dom.findAncestor(e.target(),"className",thumb.className);return(t&&t==thumb)?t:null;},startDrag:function(view){if(!view.get("dndGhost")){thumb.style.visibility="hidden";}var origClickJump=!!view.get("enableClickJumps");if(!origClickJump){view.set("enableClickJumps",true);}},drag:function(view,l,t){l=l+Math.round(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2);t=t+Math.round(mstr.utils.BoxModel.getElementOuterHeight(thumb)/2);view.repositionThumb({x:l,y:t},1);},endDrag:function(view,l,t){var origClickJump=!!view.get("enableClickJumps");if(!origClickJump){view.set("enableClickJumps",true);}var origAnimation=!!view.get("animate");if(origAnimation){view.set("animate",false);}l=l+Math.round(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2);t=t+Math.round(mstr.utils.BoxModel.getElementOuterHeight(thumb)/2);view.repositionThumb({x:l,y:t},1);if(!origClickJump){view.set("enableClickJumps",false);}if(origAnimation){view.set("animate",true);}if(!view.get("dndGhost")){thumb.style.visibility="visible";}}}));return null;};S.prototype.on_click=function S_on_click(e,hWin){if(!this.get("enabled")||(!this.get("xField")&&!this.get("yField"))){return ;}e=e||window.event;if((e.target||e.srcElement).tagName!="DIV"){return ;}var evt=new mstr.lang.Event(e,hWin,this);var el=this.get(mstr.Props.Widget.ELEMENT).lastChild;var h=parseInt(this.get("height"),10);var offset=(mstr.utils.ISW3C)?(mstr.utils.BoxModel.getElementOuterHeight(el)-h)/2:4;this.repositionThumb(evt,offset);};S.prototype.repositionThumb=function S_repositionThumb(evt,offset){var x,y;var h=parseInt(this.get("height"),10);var w=parseInt(this.get("width"),10);var el=this.get(mstr.Props.Widget.ELEMENT).lastChild;var or=this.get("orientation");var og=this.get("origin");if(or=="h"||or=="b"){x=evt.x-mstr.utils.BoxModel.getElementSumOffsetLeft(el)-offset;if(og==2||og==6){x=NaN;}else{if(og==3||og==4||og==5){x=w-x;}}}if(or=="v"||or=="b"){y=evt.y-mstr.utils.BoxModel.getElementSumOffsetTop(el)-offset;if(og==4||og==8){y=NaN;}else{if(og==5||og==6||og==7){y=h-y;}}}var info={x:{n:x,d:w},y:{n:y,d:h}};var m=this.getModel();for(var id in info){if(!isNaN(info[id]["n"])){var f=this.get(id+"Field");if(!f){continue;}var min=this.get(id+"Min");var max=this.get(id+"Max");var v=Math.round(((info[id]["n"]/info[id]["d"])*(max-min))+min);if(this.get("enableClickJumps")){m.set(f,v);}else{var ov=m.get(f);v=(ov<v)?ov++:ov--;m.set(f,ov);}}}if(!isNaN(x)){var thumb=this._getThumb();thumb.style.left=(x-Math.round(mstr.utils.BoxModel.getElementOuterWidth(thumb)/2)-(mstr.utils.ISIE6||mstr.utils.ISIE7?1:0))+"px";}this.showTooltip(true);};S.prototype._buildTooltipText=function S__buildTooltipText(){var tf=this.get("tooltipFunction");if(tf){eval("var f ="+tf);}var s="";var m=this.getModel();var or=this.get("orientation");if(this.get("xField")&&(or=="h"||or=="b")){s+=(tf)?f(m.get(this.get("xField"))):microstrategy.descriptors.getDescriptor("4891").replace("##",m.get(this.get("xField"))).replace("###",this.get("xMax"));}if(this.get("yField")&&(or=="v"||or=="b")){if(s.length>0){s+="<br />";}s+=(tf)?f(m.get(this.get("yField"))):microstrategy.descriptors.getDescriptor("4891").replace("##",m.get(this.get("yField"))).replace("###",this.get("yMax"));}return s;};S.prototype._moveTooltip=function S__moveTooltip(){if(!this.get("showTooltip")){return ;}var el=this.get(mstr.Props.Widget.ELEMENT);var tooltip=this._getTooltip();if(!tooltip){return ;}var or=this.get("orientation");tooltip.lastChild.innerHTML=this._buildTooltipText();var x,y;var h=mstr.utils.BoxModel.getElementOuterHeight(tooltip);var w=mstr.utils.BoxModel.getElementOuterWidth(tooltip);var thumb=this._getThumb();var tt=mstr.utils.BoxModel.getElementSumOffsetTop(thumb)-mstr.utils.BoxModel.getElementSumOffsetTop(el.lastChild);var tl=mstr.utils.BoxModel.getElementSumOffsetLeft(thumb)-mstr.utils.BoxModel.getElementSumOffsetLeft(el.lastChild);var th=mstr.utils.BoxModel.getElementOuterHeight(thumb);var tw=mstr.utils.BoxModel.getElementOuterWidth(thumb);switch(or){case"h":x=Math.round(tl+(tw/2)-(w/2));y=Math.round(tt-h-1);break;case"v":x=Math.round(tl+tw+1);y=Math.round(tt+(th/2)-(h/2));break;case"b":x=Math.round(tl+tw+1);y=Math.round(tt-h-1);break;}tooltip.style.left=x+"px";tooltip.style.top=y+"px";};S.prototype.showTooltip=function S_showTooltip(show){if(!this.get("showTooltip")){return ;}var tooltip=this._getTooltip();if(!tooltip){return ;}if(this.get("enabled")&&show){tooltip.style.display="inline";tooltip.style.visibility="visible";this._moveTooltip();}else{tooltip.style.visibility="hidden";}};S.prototype.schedule_thumb_move=function S_schedule_thumb_move(evt,noAnimation){if(!isNaN(this.get("animationTimeout"))){self.clearTimeout(this.get("animationTimeout"));this.set("animationTimeout",null);}var thumb=this._getThumb();var og="|"+this.get("origin")+"|";var tempT=thumb.cloneNode(true);tempT.style.display="block";tempT.style.position="absolute";tempT.style.left="3000px";tempT.style.top="2000px";tempT=document.body.appendChild(tempT);var info={x:{d:parseInt(this.get("width"),10),i:"|2|6|",o:"|3|4|5|",t:mstr.utils.BoxModel.getElementOuterWidth(tempT)/2,v:NaN},y:{d:parseInt(this.get("height"),10),i:"|4|8|",o:"|5|6|7|",t:mstr.utils.BoxModel.getElementOuterHeight(tempT)/2,v:NaN}};document.body.removeChild(tempT);var model=this.getModel();for(var id in info){var f=this.get(id+"Field");if(!f){continue;}var min=this.get(id+"Min");var n=(model.get(f)-min)/(this.get(id+"Max")-min);if(info[id]["i"].indexOf(og)>-1){n=NaN;}else{if(info[id]["o"].indexOf(og)>-1){n=1-n;}}info[id]["v"]=Math.round(n*info[id]["d"]-info[id]["t"]);}var x=info.x["v"]||null;var y=info.y["v"]||null;if(noAnimation||!this.get("animate")||this.get("animationStep")<=1){if(x&&!isNaN(x)){thumb.style.left=x+"px";}if(y&&!isNaN(y)){thumb.style.top=y+"px";}}else{this.props.animationTimeout=self.setTimeout("mstr.$obj('"+this.get("id")+"').move_thumb("+x+", "+y+")",10);}this._moveTooltip();};S.prototype.move_thumb=function S_move_thumb(x,y){var thumb=this._getThumb();if(thumb){mstr.utils.Animations.move(thumb,x,y,this.get("animationStep"));this.set("animationTimeout",null);}};S.prototype.after_set_enabled=function S_after_set_enabled(evt){var thumb=this._getThumb();if(thumb){thumb.style.display=(this.get("enabled"))?"inline":"none";}};function S(props){mstr.views.BaseView.apply(this,[props]);}return S;})();mstr.views.FontFormatter=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.pathMap={nameModelPath:{p:"children/0/children/0",f:"fontFamily",vp:"parent/parent/model/"},styleModelPath:{p:"children/1/children/0/children/0",f:"boldItalic",vp:"parent/model/"},sizeModelPath:{p:"children/1/children/0/children/1",f:"fontSize",vp:"parent/model/"},underlineField:{p:"children/0/children/1/children/0",f:"textUnderline",vp:"parent/model/"},strikeoutField:{p:"children/0/children/1/children/1",f:"textStrikeout",vp:"parent/model/"},colorModelPath:{p:"children/1/children/1",f:"fontColor",vp:"parent/model/"}};A.prototype.init=function B(){var E=this;var D=function(G){var H=G.name.split("_").pop();E._updateViewProperties(H);};for(var F in mstr.views.FontFormatter.pathMap){this._updateViewProperties(F);this["after_set_"+F]=D;}mstr.views.BaseView.prototype.init.apply(this);};A.prototype._updateViewProperties=function C(J){var E=mstr.$path(mstr.views.FontFormatter.pathMap[J].p,this);var H=this.get(J);if(J.indexOf("Field")>-1){mstr.controllers.Factory.safeset(E,"valueField",H);}else{var G=mstr.views.FontFormatter.pathMap[J].vp+H;mstr.controllers.Factory.safeset(E,"modelPath",G);}var D=this.get("enabledField");if(D){var F=mstr.views.FontFormatter.pathMap[J].vp+D;mstr.controllers.Factory.safeset(E,"enabledField",F);}var I=mstr.$path("children/1/children/2",this);mstr.controllers.Factory.safeset(I,mstr.views.FontFormatter.pathMap[J].f,H);};function A(D){mstr.views.BaseView.apply(this,[D]);}return A;})();mstr.views.ToolbarListView=(function(){mstr.$O.extendsClass(A,mstr.views.ListView);A.prototype.init=function C(){mstr.views.ListView.prototype.init.apply(this);this.getModel().attachEventListener(this,"featuresChanged","render");};A.prototype.render=function B(){if(!this.props.model.get("items")[1]&&!this.props.model.get("items")[0]["menuModel"]&&mstr.utils.Hash.isEmpty(this.props.rightIcons)){var E=" mstrNoTabs";if(document.body.className.indexOf(E)==-1){document.body.className+=E;}return ;}mstr.views.ListView.prototype.render.call(this,[]);var I=this.get("rightIcons"),D=this.props.scrollArea,J=D&&D.firstChild;if(!J||!I){return ;}for(var G=0,F=I.length;G<F;G++){var H=I[G];if(H.get){J.appendChild(H.get(mstr.$W.ELEMENT));}else{H=mstr.controllers.Factory.registerJSON(I[G],this.props[mstr.$W.DOCUMENT]);H.set("parent",this);H.init();H.set(mstr.$W.ELEMENT,J.appendChild(document.createElement("div")));}H.render();I[G]=H;}};function A(D){mstr.views.ListView.apply(this,[D]);}return A;})();mstr.views.FloatingMenuOption=(function(){mstr.$O.extendsClass(C,mstr.views.BaseView);C.prototype.execOpenSubMenu=function B(){var G=this.getModel().get("style");var E=this.getModel().get("menuModel");var I=this.getModel().get("layouts");if(!G){G=this.props.parent.props.model.props.styleName;}if(!G||!E){return ;}this.get("parent").execCloseSubMenus();var F=this.get("element");var H=this.get("parent").get("element");var D=parseInt(H.style.left,10)+mstr.utils.BoxModel.getElementOuterWidth(H)-12;var J=parseInt(H.style.top,10)+mstr.utils.BoxModel.getElementSumOffsetTop(F)-mstr.utils.BoxModel.getElementSumOffsetTop(H);mstr.behaviors.FloatingMenu.displayMenu(this,D,J,G,E,I,H.parentNode);};C.prototype.execCloseSubMenu=function A(){if(!this.getModel().get("menuModel")){return ;}var E=mstr.$obj(mstr.behaviors.FloatingMenu.getMenuId({layouts:this.getModel().get("layouts"),modelName:this.getModel().get("menuModel")}));var D=E&&E.execCloseMenu();};function C(D){mstr.views.BaseView.apply(this,[D]);}return C;})();mstr.views.ToolbarButton=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype._attachLayoutHandlers=function C(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this,[]);var D=this.props.model;if(!D){return ;}D.attachEventListener(this,"set_showPressed","set_pressed");};B.prototype.set_pressed=function A(D){this.set("pressed",D.memo.value);};function B(D){mstr.views.BaseView.apply(this,[D]);}return B;})();mstr.views.LastUpdateView=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.render=function A(){var D=mstr.$path(mstr.$path("parent/model/targetPath",this),this);if(!D){return ;}mstr.views.BaseView.prototype.render.apply(this,arguments);var C=this.get(mstr.$W.ELEMENT);if(D.lastUpdate){C.innerHTML=D.lastUpdate;}C.className=this.get("cssPrefix")+this.get("cssClass");};function B(C){mstr.views.BaseView.apply(this,[C]);}return B;})();mstr.views.Toolbar=(function(){mstr.$O.extendsClass(C,mstr.views.ViewBook);C.prototype.render=function E(){mstr.views.ViewBook.prototype.render.apply(this);this.checkAllSeparators();var G=this.get("views");for(var I=0,H=G.length;I<H;I++){var J=G[I];if(!(J.get("ge"))){var F=J.attachEventListener&&J.attachEventListener(this,"set_visible","checkSeparators");}}};C.prototype.checkAllSeparators=function B(){var F=this.get("views");var J=false;var I;for(var H=0,G=F.length;H<G;H++){I=F[H].get("ge");if(!this.renderFirstSeparator&&F[H].get("visible")&&!J){J=true;if(I){F[H].set("visible",false);continue;}}if(I&&H+1<G){this.checkSeparators({src:F[H+1]});}}};C.prototype.checkSeparators=function D(G){var F=this.get("views");var H=mstr.$A.find(F,G.src);var K=G.src.get("visible");var J,M,I;var L;for(M=H-1;M>=0;M--){J=F[M];if(J.get("ge")){L=M;break;}}for(M=L+1,I=F.length;M<I;M++){J=F[M];if(J.get("ge")){F[L].set("visible",false);break;}if(J.get("visible")){F[L].set("visible",true);break;}}if(M==F.length&&!this.renderLastSeparator){F[L].set("visible",false);}};C.prototype.after_set_childValidationStatus=function A(H){var F=H.memo;var I=mstr.$obj(F.id).getModel().get("queueGroup");this.childValidationStatus=this.childValidationStatus||{};var J=this.childValidationStatus[I]=this.childValidationStatus[I]||{};var G=this.get("model");if(F.code==mstr.Enum.Validation.STATUSCODE.VALID){if(F.id in J){delete J[F.id];if(mstr.utils.Hash.isEmpty(J)){G.setQueueValidationStatus(I,mstr.Enum.Validation.STATUSCODE.VALID);}}}else{if(mstr.utils.Hash.isEmpty(J)){G.setQueueValidationStatus(I,mstr.Enum.Validation.STATUSCODE.INVALID_ANSWERS);}J[F.id]=F.code;}};function C(F){this.renderFirstSeparator=true;this.renderLastSeparator=true;mstr.views.ViewBook.apply(this,[F]);}return C;})();mstr.views.ClickableMessage=(function(){mstr.$O.extendsClass(B,mstr.views.BaseView);B.prototype.showMessage=function D(){showMessage({contents:this.get("dlgText"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,zIndex:1001,okEval:'mstr.$obj("'+this.get("id")+'").handleOK()',type:mstrMsgBoxImpl.MSG_WARNING});};B.prototype.handleOK=function C(){};B.prototype.render=function A(){mstr.views.BaseView.prototype.render.apply(this,arguments);var H=this.get("element");var F=this.get("msgText");var G=F.match(/##(.*)##/);if(G&&G.length>0){var E="<span style='text-decoration:underline;cursor:pointer' onclick='mstr.$obj(\""+this.get("id")+"\").showMessage();'>"+G[1]+"</span>";F=F.replace(/##.*##/,E);H.innerHTML=F;}};function B(E){mstr.views.BaseView.apply(this,[E]);}return B;})();mstr.views.TooltipText=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.render=function B(){mstr.views.BaseView.prototype.render.apply(this,arguments);var C=this.get("element");model=this.getModel();currAttr=model.getSelectedItemValue();attrName=currAttr.split("|")[2];abbr=attrName;if(attrName.length>20){abbr=attrName.substring(0,17)+"...";}C.innerHTML="<div style='margin-top:6px;' title='"+attrName+"'>"+abbr+":</div>";};function A(C){mstr.views.BaseView.apply(this,[C]);}return A;})();mstr.views.DisableAutowireMessage=(function(){mstr.$O.extendsClass(B,mstr.views.ClickableMessage);B.prototype.handleOK=function A(){microstrategy.getViewerBone().commands.exec("disableAutowire");this.get("parent").getModel().set("Autowire",false);};function B(C){mstr.views.BaseView.apply(this,[C]);}return B;})();mstr.views.FloatingMenuBook=(function(){mstr.$O.extendsClass(D,mstr.views.Toolbar);D.prototype.zIndex=1000;D.prototype.getZIndex=function I(){return this.zIndex++;};D.prototype.init=function A(){mstr.views.Toolbar.prototype.init.apply(this);mstr.controllers.EventManager.attachWindowEventListener(this,"mousedown","documentClick");mstr.controllers.EventManager.attachWindowEventListener(this,"closeMenus","documentClick");};D.prototype.after_set_visible=function G(J){if(this.props.visible){mstr.behaviors.FloatingMenu.adjustMenuPosition(this);}else{mstr.behaviors.FloatingMenu.toggleOpenerHoverEffect(this.props.opener,false);}};D.prototype.render=function B(){mstr.views.Toolbar.prototype.render.apply(this);mstr.utils.Dom.insertPopupMask(this.get("element"),this.execLayoutHandler("maskContainer"));var J=this.get("opener");if(J&&J.get&&J.get("visible")===false){this.execCloseMenu();}else{mstr.behaviors.FloatingMenu.adjustMenuPosition(this);}};D.prototype.documentClick=function F(J){if(this.props.visible===false){return ;}if(this.props.showing){this.set("showing",false);return ;}var K=J&&J.target&&J.target();if(K&&K.tagName&&K.tagName.toLowerCase()=="html"){return ;}if(((!K&&J.name=="closeMenus")||!mstr.utils.Dom.containsElement(this.props.element,K,true))&&!(this.props.opener.props&&mstr.utils.Dom.containsElement(this.props.opener.props.element,K,true))&&!this.isSubMenu(K)){this.execCloseMenu();}};D.prototype.isSubMenu=function E(N){var K=N,J,L,M,O;while(K){O=(K.getAttribute&&K.getAttribute("blockId"))||K.id;if(O){J=mstr.$obj(O);if(J&&J.props){M=M||(J.props.cmds);L=J.props.opener;L=L&&L.props.element;if(L){return M=="OpenSubMenu"&&mstr.utils.Dom.containsElement(this.props.element,L,true);}}}K=K.parentNode;}return false;};D.prototype.isSubMenu=function E(N){var K=N,J,L,M,O;while(K){O=(K.getAttribute&&K.getAttribute("blockId"))||K.id;if(O){J=mstr.$obj(O);if(J&&J.props){M=M||(J.props.cmds);L=J.props.opener;L=L&&L.props.element;if(L){return M=="OpenSubMenu"&&mstr.utils.Dom.containsElement(this.props.element,L,true);}}}K=K.parentNode;}return false;};D.prototype.execCloseMenu=function H(){if(this.props.visible===false){return ;}if(!(this.props.opener instanceof mstr.views.FloatingMenuOption)){microstrategy.setJLSCXMenuOpen(false);}this.set("visible",false);this.set("cssText","left:-2000px;top:-2000px");};D.prototype.execCloseSubMenus=function C(){if(!this.props.views){return ;}for(var L=0,K=this.props.views.length;L<K;L++){var M=this.props.views[L];var J=M.execCloseSubMenu&&M.execCloseSubMenu();}};function D(J){mstr.views.Toolbar.apply(this,[J]);this.renderLastSeparator=false;this.renderFirstSeparator=false;}return D;})();mstr.views.ContextMenuProcessingView=(function(){mstr.$O.extendsClass(A,mstr.views.BaseView);A.prototype.setModel=function(B){mstr.views.BaseView.prototype.setModel.apply(this,[B]);B.attachEventListener(this,"set_menu_ready","on_menu_ready");B.attachEventListener(this,"set_menu_processing","on_menu_processing");B.attachEventListener(this,"set_hide_menu_processing","on_hide_menu_processing");};A.prototype.on_menu_processing=function(){addProcessingMenuItem(this.getMenuLevel());};A.prototype.on_hide_menu_processing=function(){removeProcessingMenuItem(this.getMenuLevel());};A.prototype.on_menu_ready=function(){var C=this.getModel().getMenuItems();var B=this.getModel().getCurrentMenuItemIndices();if(C!=null&&B!=null){addDynamicMenus(this.getMenuLevel(),C,B);}};A.prototype.setMenuLevel=function(B){this.iMenu=B;};A.prototype.getMenuLevel=function(){return this.iMenu;};function A(B){mstr.views.BaseView.apply(this,[B]);}return A;})();mstr.views.ToolbarColorPickerButton=(function(){mstr.$O.extendsClass(A,mstr.views.Pulldown);A.prototype._attachLayoutHandlers=function D(){mstr.views.Pulldown.prototype._attachLayoutHandlers.apply(this);var E=this.props.model;if(E&&E.attachEventListener){E.attachEventListener(this,"set_lastColor","lastColorChanged");}this.lastColorChanged();};A.prototype._detachLayoutHandlers=function B(){mstr.views.Pulldown.prototype._detachLayoutHandlers.apply(this);var E=this.props.model;if(E&&E.detachEventListener){E.detachEventListener(this,"set_lastColor");}};A.prototype.lastColorChanged=function C(){var F=this.getModel();var H=F.get("lastColor");H=(H.indexOf(",")>-1)?H.split(",")[0]:H;var E=mstr.utils.ListViewHelper.getItemRenderer(this);var G=E._getContentContainer(this.props[mstr.$W.ELEMENT]);if(/^#[0-9a-f]{6}$/i.test(H)){G.style.backgroundColor=H;}};function A(E){mstr.views.Pulldown.apply(this,[E]);}return A;})();mstr.bones.editors.BoneTranslator=(function(){mstr.$O.extendsClass(P,mstr.models.BaseModel);P.prototype.translating=false;P.prototype._createNewModel=function H(Y){var X=Y.scriptClass;if(!X||!mstr.models[X]){return null;}var W=new mstr.models[X](Y);if(!W){return null;}mstr.controllers.Factory.add(W);var V=W.init&&W.init();return W;};P.prototype._initializeDynamicModel=function Q(V,W,Y){this._setDynamicModelValues(V,W,Y);this.props[V]=W;this._setModelChangeEventListeners(W,V);this.dynamicModels=this.dynamicModels||[];this.dynamicModels.push({dm:W,p:V,s:Y});if(V==="EditSelectorTargets"&&Y==="availableTemplates"){var a=this.get("EditSelectorSource"),Z=a&&a.getSelectedItem()&&a.getSelectedItem().olap,X=a&&a.getSelectedItem(),c=X&&X.de&&X.sty!=12033;if(Z){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",W,"availableTemplatesNoPlaceholder");}if(c){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",W,"availableTemplatesNoPlaceholder");}}};P.prototype._setModelChangeEventListeners=function M(W,V){if(W instanceof mstr.models.ListModel){if(W instanceof mstr.models.ColorPicker){W.attachEventListener(this,"set_actualColor","onModelPropertyChange");}else{W.attachEventListener(this,"hashadd_selectedIndices","onModelPropertyChange");W.attachEventListener(this,"hashremove_selectedIndices","onModelPropertyChange");}W.set("mappedPropertyName",V);}else{if(mstr.models.ListCart&&W instanceof mstr.models.ListCart){var X=W.get("selected");X.attachEventListener(this,"listadd_items","onModelPropertyChange");X.attachEventListener(this,"listremove_items","onModelPropertyChange");X.set("mappedPropertyName",V);}}};P.prototype._setDynamicModelValues=function G(W,X,Y){var V=(typeof (Y)=="string")?this.getBone().commands.queryState(Y):Y;if(X instanceof mstr.models.ListModel){this._setDynamicListModelValues(X,V,W);}else{if(mstr.models.ListCart&&X instanceof mstr.models.ListCart){this._setDynamicCartModelValues(X,V,W);}}};P.prototype._setDynamicListModelValues=function J(X,W,V){X.setItems(W);var Z=this.getBone().commands.queryState(V);var Y=(mstr.$A.isArray(Z))?"execSelectValues":"execSelectValue";X[Y](Z);};P.prototype._setDynamicCartModelValues=function S(X,W,V){X.get("available").setItems(W);var Y=this.getBone().commands.queryState(V);X.get("selected").setItems(Y);X._updateAvailableFilteredItems();};P.prototype._resolveDynamicModelSource=function D(V){return(V in this.props&&"getItems" in this.props[V])?this.get(V).getItems():V;};P.prototype._getPropertyCategory=function E(){return"default";};P.prototype._storeDeltaProp=function C(X,V){if(this.get("previewDisabledFields")&&this.get("previewDisabledFields")[X]){this.props.parent.set("disablePreview",true);this.props.parent.set("enablePreview",false);}var W=this._getPropertyCategory();this.deltaProps[W]=this.deltaProps[W]||{};this.deltaProps[W][X]=V;this.raiseEvent("store_deltaProp",{category:W,name:X,value:V});mstr.models.BaseModel.prototype.set.apply(this,["hasChanges",true]);};P.prototype._getDeltaProp=function O(W){var V=this._getPropertyCategory();if(!(V in this.deltaProps)||!(W in this.deltaProps[V])){return null;}return this.deltaProps[V][W];};P.prototype.getBone=function N(){return mstr.$obj(this.props.boneId);};P.prototype.reinitializeModel=function F(){var W=("dynamicModels" in this);this.translateBone();if(!this.get("enabled")){return ;}if(!W){return ;}var Z=this.translating;this.translating=true;for(var a=0,Y=this.dynamicModels.length;a<Y;a++){var c=this.dynamicModels[a];if(c.p==="EditSelectorTargets"&&c.s==="availableTemplates"){var V=this.get("EditSelectorSource"),g=V&&V.getSelectedItem()&&V.getSelectedItem().olap,X=V&&V.getSelectedItem(),e=X&&X.de&&X.sty!=12033;if(g){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",c.dm,"availableTemplatesNoPlaceholder");continue;}if(e){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",c.dm,"availableTemplatesNoPlaceholder");continue;}}this._setDynamicModelValues(c.p,c.dm,c.s);}this.translating=Z;};P.prototype.getDynamicListModel=function R(X,W){var Y=this._resolveDynamicModelSource(X);var V=this._createNewModel({scriptClass:"ListModel",parent:this,valueForm:"dssid"});if(V){this._initializeDynamicModel(W,V,Y);}return V;};P.prototype.getDynamicCartModel=function K(X,W){var Y=this._resolveDynamicModelSource(X);var V=this._createNewModel({scriptClass:"ListCart",parent:this,available:{scriptClass:"mstr.models.ListModel",valueForm:"dssid"},selected:{scriptClass:"mstr.models.ListModel",valueForm:"dssid"}});if(V){this._initializeDynamicModel(W,V,Y);}return V;};P.prototype.set=function U(Y,V){var X=mstr.models.BaseModel.prototype.set.apply(this,[Y,V]);if(!X){return ;}if(!this.translating&&this._isTranslatedProperty(Y)){this._storeDeltaProp(Y,V);}var W=this.get("broadcastProperties");if(W&&W[Y]){this.get("parent").notifyPropertyChange(Y,{memo:{value:V}});}};P.prototype.translateBone=function I(){var Z=this.getBone();var W=this.props.visibleField;if(W!=null&&W.length>0){this.set(W,Z.commands.queryEnabled(W));if(!this.props[W]){return ;}}if(!this.get("enabled")||!Z){return ;}var c=this.get("fields");if(!c){return ;}c=c.split("|");if(c[0]==""){c.shift();}if(c[c.length-1]==""){c.pop();}if(!c){return ;}this.translating=true;for(var a=0,Y=c.length;a<Y;a++){var X=c[a];if(!Z.commands.queryEnabled(X)){continue;}var g=this._getDeltaProp(X);if(g==null){g=Z.commands.queryState(X);}if(g&&typeof g=="string"){g=g.replace(/'+/g,"");}var V=this.props[X];if(mstr.models.ListCart&&V instanceof mstr.models.ListCart){V.get("selected").setItems(g);this._setModelChangeEventListeners(V,X);}else{if(V instanceof mstr.models.ListModel){var e=(mstr.$A.isArray(g))?"execSelectValues":"execSelectValue";var h=V[e](g);if(!h&&V.execClearSelect){V.execClearSelect();}this._setModelChangeEventListeners(V,X);}else{this.set(X,g);}}}this.translating=false;};P.prototype.onModelPropertyChange=function L(h){var Z=h.src;var g="";var W=null;if(h.name=="set_actualColor"){g=Z.get("actualColor");W=h.memo.valueWas;}else{var e=[];switch(h.name){case"hashadd_selectedIndices":case"hashremove_selectedIndices":e=Z.getSelectedItems();W=h.memo.at;break;case"listadd_items":case"listremove_items":e=Z.getItems();break;default:return ;}var a=Z.get("valueForm");var c="";for(var X=0,V=e.length;X<V;X++){g+=c+e[X][a];c=CLIPBOARD_ITEM_SEPARATOR;}}var Y=Z.get("mappedPropertyName");this.raiseEvent("set_"+Y,{name:Y,src:h.name,value:g,valueWas:W});if(this.translating){return ;}this._storeDeltaProp(Y,g);};P.prototype.resetDeltas=function B(){this.deltaProps={};mstr.models.BaseModel.prototype.set.apply(this,["hasChanges",false]);};P.prototype.collectChanges=function A(X){for(var W in this.deltaProps){var V=(W.indexOf("|")==-1)?{}:mstr.utils.Arrays.toHashProperties(W.split("|"),["category","unit","format"]);for(var Y in this.deltaProps[W]){X.push({obj:null,cmdId:Y,value:this.deltaProps[W][Y],memo:V,performFormatChange:true,submitUpdateManager:false});}}};P.prototype._isTranslatedProperty=function T(X){var V=this.props.fields;if(!V){return false;}var W=new RegExp("\\|"+X+"\\||^"+X+"\\||\\|"+X+"$|^"+X+"$");return W.test(V);};function P(V){mstr.models.BaseModel.apply(this,[V]);this.resetDeltas();}return P;})();mstr.bones.editors.BoneTranslatorManager=(function(){mstr.$O.extendsClass(P,mstr.models.ListModel);P.prototype.init=function A(){mstr.models.BaseModel.prototype.init.apply(this);this.attachEventListener(this,"set_lockedTab","_lockTabs");this._lockTabs();var R=this.getItems();var T=R.length;for(var S=0;S<T;S++){R[S].attachEventListener(this,"set_hasChanges","handleChanges");}this._startBoneTranslation();this._fixSelection();};P.prototype.on_set_viewDisabled=function N(R){this.set("CommandEnabledOkChanges",(!R.memo.value&&this.get("enableOk")));this.set("CommandEnabledPreviewChanges",(!R.memo.value&&this.get("enablePreview")));};P.prototype.on_set_enableOk=function J(R){this.set("CommandEnabledOkChanges",(R.memo.value&&!this.get("viewDisabled")));};P.prototype.on_set_enablePreview=function O(R){this.set("CommandEnabledPreviewChanges",(R.memo.value&&!this.get("viewDisabled")&&!this.get("disablePreview")));};P.prototype._startBoneTranslation=function K(){var R=this.getItems();var T=R.length;for(var S=0;S<T;S++){R[S].translateBone();}};P.prototype._lockTabs=function I(){var R=this.get("lockedTab");if(R!=-1){this.execSingleSelect(R);this.set("disableList",true);}else{this.set("disableList",false);}};P.prototype.execReinitializeModel=function E(){this.set("hasChanges",false);this.set("previewCount",0);this.props.enableOk=false;this.props.enablePreview=false;this.set("viewDisabled",false);this.set("disablePreview",false);this._reinitializeChildModels();this._fixSelection();};P.prototype._reinitializeChildModels=function G(){var R=this.getItems();for(var T=0,S=R.length;T<S;T++){R[T].reinitializeModel();}};P.prototype.handleChanges=function Q(R){this.set("hasChanges",R.memo.value);if(!R.memo.value){return ;}this.set("enableOk",true);this.set("enablePreview",true);if(this.get("lockedTab")!=-1&&!this.get("viewDisabled")){this.set("lockedTab",-1);}};P.prototype.disableModelFromView=function F(R){this.set("viewDisabled",R);};P.prototype.execOkChanges=function D(){this.saveModelChanges();this.set("enableOk",false);this.set("enablePreview",false);return true;};P.prototype.execPreviewChanges=function H(){var R=microstrategy.updateManager;if(R){R.observer.register(this.props.id);}this.saveModelChanges();this.set("enablePreview",false);this.props.previewCount++;if(R&&!R.isFlushing()){var S=mstr.$obj(this.get("boneId"));if(S&&S.commands.queryEnabled("oneTable")){this._initializeSelectors();}this._reinitializeChildModels();R.observer.unregister(this.props.id);}return true;};P.prototype.saveModelChanges=function C(){var S=new Array();var R=this.getItems();for(var U=0,T=R.length;U<T;U++){R[U].collectChanges(S);}if(S.length>0){var V=mstr.$obj(this.props.boneId);if(V){if(!(V.commands.exec(this.props.boneCmdId,S))){return false;}}}this.execClearChanges();return true;};P.prototype.execClearChanges=function L(){var R=this.getItems();for(var T=0,S=R.length;T<S;T++){R[T].resetDeltas();}};P.prototype.execCancelChanges=function M(){this.execClearChanges();var R=mstr.$obj(this.props.boneId);if(R){R.commands.exec("cancelEdit",this.get("previewCount"));}this.set("lockedTab",-1);this.set("enablePreview",false);this.set("enableOk",false);};P.prototype._fixSelection=function B(){var U=this.getSelectedItem();if(!U.get(U.get("visibleField"))){var R=this.getItems();for(var T=0,S=R.length;T<S;T++){if(R[T].get(R[T].get("visibleField"))){this.execSingleSelect(T);return ;}}}};function P(R){mstr.models.ListModel.apply(this,[R]);}return P;})();mstr.bones.editors.PropertiesBoneTranslatorManager=(function(){mstr.$O.extendsClass(I,mstr.bones.editors.BoneTranslatorManager);I.prototype._initializeSelectors=function N(){var X=mstr.$obj(this.get("boneId"));this.set("showGridSelectors",X.commands.queryEnabled("showGridSelectors"));this.set("showPanelSelector",X.commands.queryEnabled("showPanelSelector"));var V=["edtUnitSelector","edtValueSelector"];for(var W=0;W<2;W++){this._initializeSingleSelector(V[W]);}};I.prototype._initializeSingleSelector=function O(W){var X=mstr.$obj(this.get("boneId"));var V=this.get(W);V.detachEventListener(this,"hashadd_selectedIndices");V.set("cmdId",W);var Y=X.commands.queryState(W,this._getTabName());if(Y.isFetching&&(!this.pollInterval)){this._setGridModelEnablement(false);this.pollInterval=self.setInterval("mstr.$obj('"+this.get("id")+"').pollForGridFormat();",100);}V.set("visible",Y.visible);V.set("enabled",Y.enabled);if(Y.items){V.setItems(Y.items);if("value" in Y){V.execSelectValue(Y.value);}}V.attachEventListener(this,"hashadd_selectedIndices","updateTargetFromUnitSelectors");};I.prototype._getTabName=function B(){return mstr.controllers.Factory.safeget(this.getSelectedItem(),"tabName");};I.prototype._setGridModelEnablement=function C(W){var V=this.getItems();for(var Y=0,X=V.length;Y<X;Y++){var Z=mstr.controllers.Factory.safeget(V[Y],"unitSelectorChange");if(Z&&(Z.indexOf("Grid")>-1)){mstr.controllers.Factory.safeset(V[Y],"enabled",W);if(W&&V[Y].reinitializeModel){V[Y].reinitializeModel();}}}};I.prototype.on_set_enablePreview=function T(V){if(!V.memo.value||this.get("viewDisabled")){mstr.bones.editors.BoneTranslatorManager.prototype.on_set_enablePreview.apply(this,[V]);return ;}this.set("CommandEnabledPreviewChanges",!this.get("isGridFormatted"));};I.prototype.pollForGridFormat=function F(){var V=mstr.$obj(this.get("boneId"));if(V.commands.queryState("areGridFormatsReady")){this._clearGridFormatPoll();this._setGridModelEnablement(true);}};I.prototype._clearGridFormatPoll=function D(){if(this.pollInterval){self.clearInterval(this.pollInterval);delete this.pollInterval;}};I.prototype._cancelGridFormatPoll=function Q(){if(!this.pollInterval){return ;}this._clearGridFormatPoll();var Y=mstr.$obj(this.get("boneId"));Y.commands.exec("cancelGridFormatRequest");var V=this.getItems();for(var X=0,W=V.length;X<W;X++){mstr.controllers.Factory.safeset(V[X],"enabled",true);}};I.prototype._startBoneTranslation=function M(){this._initializeSelectors();mstr.bones.editors.BoneTranslatorManager.prototype._startBoneTranslation.apply(this);};I.prototype._handleDeltaPropStorage=function P(V){return ;var W=V.memo.category.split("|");if(W.length==3){if(W[0]=="Grid"||(W[0]=="AllGrid"&&W[1]!="0")){this.set("isGridFormatted",true);this.set("enablePreview",false);}}};I.prototype.init=function E(){mstr.bones.editors.BoneTranslatorManager.prototype.init.apply(this);this.set("isGridFormatted",false);var V=this.getItems();for(var X=0,W=V.length;X<W;X++){V[X].attachEventListener(this,"store_deltaProp","_handleDeltaPropStorage");}};I.prototype.acknowledgeReloadEnd=function U(){this.execReinitializeModel();var V=microstrategy.updateManager;if(V){V.observer.unregister(this.props.id);}};I.prototype.execReinitializeModel=function H(){this._initializeSelectors();this.set("isGridFormatted",false);this.set("showCancelButton",true);mstr.bones.editors.BoneTranslatorManager.prototype.execReinitializeModel.apply(this);var V=this.getSelectedItem();if(!V.get(V.get("visibleField"))){this.execSingleSelect(0);}};I.prototype.updateTargetFromUnitSelectors=function A(X){var W=X.src.get("cmdId");var V=this.get(W);var Y={src:W,v:V.getSelectedItem()[V.get("valueForm")],t:this._getTabName()};mstr.$obj(this.get("boneId")).commands.exec("setUnitFormatLevels",Y);if(W=="edtUnitSelector"){this._initializeSingleSelector("edtValueSelector");}this._reinitializeSelectorBasedModels();};I.prototype._reinitializeSelectorBasedModels=function S(){if(this.pollInterval){return ;}var V=this.getItems();for(var X=0,W=V.length;X<W;X++){var Y=V[X].get("unitSelectorChange");if(Y){V[X].reinitializeModel();}}};I.prototype.execClearChanges=function R(){mstr.bones.editors.BoneTranslatorManager.prototype.execClearChanges.apply(this);this._cancelGridFormatPoll();};I.prototype.execOpenWebHyperLinkEditor=function L(){mstr.$obj("rwb_viewer").doc.commands.exec("WebHyperLinkEditor");this.set("showCancelButton",false);};I.prototype.handleChanges=function G(V){mstr.bones.editors.BoneTranslatorManager.prototype.handleChanges.apply(this,[V]);V.memo.value&&this.set("showCancelButton",true);};I.prototype.on_hashadd_selectedIndices=function K(V){mstr.bones.editors.BoneTranslatorManager.prototype.on_hashadd_selectedIndices.call(this,V);var X=this._getTabName();if(X){mstr.$obj(this.get("boneId")).commands.exec("edtTabChange",X);}var W=this.getItems();if(W.length>0&&W[0].get){this._initializeSelectors();this._reinitializeSelectorBasedModels();}};I.prototype.notifyPropertyChange=function J(X,V){var W=this.getItems();for(var Z=0,Y=W.length;Z<Y;Z++){if(W[Z]["on_set_ext_prop_"+X]){W[Z]["on_set_ext_prop_"+X](V);}}};function I(V){mstr.bones.editors.BoneTranslatorManager.apply(this,[V]);}return I;})();mstr.bones.editors.FormatEditingBoneTranslator=(function(){mstr.$O.extendsClass(C,mstr.bones.editors.BoneTranslator);C.prototype._getPropertyCategory=function A(){var F=mstr.bones.editors.BoneTranslator.prototype._getPropertyCategory.apply(this);var J=this.get("parent");var H=J.get("edtUnitSelector");var I=J.get("edtValueSelector");var E=((J.get("showGridSelectors"))?"Grid":"default")+"|";var G=H.getSelectedItem();if(!G){return F;}E+=H.getSelectedItem()[H.get("valueForm")]+"|";G=I.getSelectedItem();if(!G){return F;}E+=I.getSelectedItem()[I.get("valueForm")];return E;};C.prototype.refreshForSearchBox=function B(G,E){if(E){var F=G.get("visibleField");if(F=="alignmentTabEnabled"||F=="effectsTabEnabled"){G.set(F,false);}}};C.prototype.translateBone=function D(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;var E=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);this.refreshForSearchBox(this,E);this.translating=false;};function C(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return C;})();mstr.bones.editors.EffectsPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.FormatEditingBoneTranslator);A.prototype.on_set_ext_prop_showTranslucent=function B(C){var D=C.InfoWindowMode;this.set("showTranslucent",(C.UseAsInformationWindow&&(D==="2"||D==="3"||D==="4")));};function A(C){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[C]);}return A;})();mstr.bones.editors.FontPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.FormatEditingBoneTranslator);A.prototype._getPropertyCategory=function C(){return mstr.bones.editors.FormatEditingBoneTranslator.prototype._getPropertyCategory.apply(this);};A.prototype.on_set_ext_prop_ButtonDisplayStyle=function B(D){var E=Number(D.memo.value);var F=this.get("visibleField");switch(E){case microstrategy.BUTTON_STYLE_CAPTION_ONLY:case microstrategy.BUTTON_STYLE_ICON_LEFT:case microstrategy.BUTTON_STYLE_ICON_RIGHT:case microstrategy.BUTTON_STYLE_ICON_TOP:this.set(F,true);break;case microstrategy.BUTTON_STYLE_ICON_ONLY:case microstrategy.BUTTON_STYLE_CUSTOM:this.set(F,false);break;}};function A(D){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[D]);}return A;})();mstr.bones.editors.LayoutPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(R,mstr.bones.editors.BoneTranslator);var E=null;var D={};R.prototype.init=function S(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);E=this.get("XTabView").getItems()[this.get("XTabView").indexOfValue("50")];};R.prototype.translateBone=function B(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);var Y=this.get("XTabView").getSelectedItemValue();this.set("ExportOverflowVisible",!this.get("IsPortal")&&(Y==1||Y==3));this.on_set_DataSource();D={};};R.prototype.getDynamicListModel=function I(a,Z){var Y=mstr.bones.editors.BoneTranslator.prototype.getDynamicListModel.apply(this,[a,Z]);if(Z=="DataSource"){this.on_set_DataSource();}else{if(Z=="EditSelectorStyle"){this.on_set_EditSelectorStyle();}}return Y;};R.prototype._setDynamicModelValues=function G(Z,a,c){if(Z=="EditSelectorStyle"){this.isNde=this._isNde();var Y=this._getApplicableStyles(this.isNde);this._setDynamicListModelValues(a,Y,Z);}else{mstr.bones.editors.BoneTranslator.prototype._setDynamicModelValues.apply(this,[Z,a,c]);}};R.prototype._isNde=function Q(){var c=mstr.controllers.Factory.getPath("parent/items/6/EditSelectorSource",this);var Y=c&&c.get("selectedIndicesList"),Z,a;if(Y!=undefined){a=c.get("items")[Y];Z=a.sty==12033;}else{a=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorSource");if(a){Z=a.split("|")[1]==47;}}return Z;};R.prototype._getApplicableStyles=function V(a){var e=[],Y=this.get("SelectorStyles").get("items"),Z,c;for(Z=0;Z<Y.length;Z++){c=Y[Z];if(a&&c.dssid==9){continue;}e.push(c);}this.isNde=a;return e;};R.prototype.on_set_ext_prop_EditSelectorSource=function M(Y){var e=this._isNde();if(e!=this.isNde){this.isNde=e;var a=this.get("EditSelectorStyle");if(a){var Z=this._getApplicableStyles(e),c=a.getSelectedItemValue();a.setItems(Z);if(c){a.execSelectValue(c);}}}};R.prototype.on_set_ext_prop_IsPortal=function P(Y){var Z=Y.memo.value;var a=this.translating;this.translating=true;this.set("IsPortal",Z);this.translating=a;if(!this.get("isOneGrid")){return ;}this.set("showFixedHeightOnly",Z);this.set("showFixedFitHeight",!Z);this.set("showFixedWidthOnly",Z);this.set("showFixedFitWidth",!Z);this.set("ExportOverflowVisible",!Z&&this.props.XTabView.getSelectedIndex()!=1);};R.prototype.on_set_DataSource=function F(Y){this.set("enableShortcut",this.props.DataSource&&this.props.DataSource.props.selectedCount>0&&!this.props.isCubeReportDataset);};R.prototype.on_set_XTabView=function J(Y){if(!this.translating){this.get("parent").notifyPropertyChange("XTabView",Y);this.set("ExportOverflowVisible",!this.get("IsPortal")&&(Y.memo.value==1||Y.memo.value==3));}};R.prototype.on_set_Height=function A(Y){if(this._shouldLockRatio()){this._lockRatio(Y,"Width");}};R.prototype.on_set_Width=function U(Y){if(this._shouldLockRatio()){this._lockRatio(Y,"Height");}};R.prototype.on_set_ext_prop_EditSelectorType=function H(Y){this.on_set_EditSelectorStyle(Y);};R.prototype.on_set_EnableSelCount=function H(Y){if(!this.get("EnableSelCount")){this.set("MaxSel","");this.set("MinSel","");}};R.prototype.on_set_ext_prop_isDSAsTarget=function X(Y){this._checkSearchBoxProps(Y);};R.prototype.on_set_ext_prop_EditSelectorStyle=function T(Y){this._checkSearchBoxProps(Y);};R.prototype._checkSearchBoxProps=function L(Y){var Z=this.isSearchBox(this);this.set("visibleSearchOnServ",Z);this.set("ItemWidthModeEnabled",!Z);if(Z){this.get("EditSelectorOrientation").set("selectedIndicesList",0);var a=this.get("setWidget");if(a){a.set("selectedIndicesList",0);}}mstr.bones.editors.ColorLinesPropertiesBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[8],Z);mstr.bones.editors.FormatEditingBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[11],Z);mstr.bones.editors.FormatEditingBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[12],Z);mstr.bones.editors.SelectorPageBoneTranslator.prototype.refreshForSearchBox(this.get("parent").get("items")[6],Z);};R.prototype.on_set_EditSelectorStyle=function N(a){var e=mstr.controllers.Factory.getPath("parent/items/6/EditSelectorType",this);var Z,g,h;this._checkSearchBoxProps(a);if(e.props&&e.props.selectedIndicesList!=undefined){Z=e.props.selectedIndicesList=="2";g=e.props.selectedIndicesList=="4";h=e.props.selectedIndicesList=="5";}else{Z=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorType")=="3";g=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorType")=="5";h=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorType")=="8";}if(Z||h){this.set("EditSelectorMultiSelectEnabled",false);return ;}if(g){this.set("EditSelectorMultiSelectEnabled",true);return ;}var c=this.get("EditSelectorStyle"),Y=c&&c.props.selectedIndicesList;switch(Y){case"1":case"2":case"3":case"5":case"6":case"7":this.set("EditSelectorMultiSelectEnabled",true);break;default:this.set("EditSelectorMultiSelectEnabled",false);}this.set("ChangeSelectionOnMouseOverEnabled",(this.props.isSlicingSelector&&Y!=7));};R.prototype._shouldLockRatio=function W(){return(!this.translating&&!this.adjustingRatio&&this.get("LockAspectRatio"));};R.prototype._lockRatio=function K(Y,h){var a=Y.memo,Z=a.value,e=a.name,c=h;if(!(D[e]&&D[e].hasOwnProperty(c))){if(!D[e]){D[e]={};}var g=this.get(c)/a.valueWas;g=isNaN(g)||!isFinite(g)?0:g;D[e][c]=g;if(!D[c]){D[c]={};}D[c][e]=1/g;}this.adjustingRatio=true;this.set(h,Z*D[e][c]);this.adjustingRatio=false;};R.prototype.on_set_LockAspectRatio=function C(Y){if(!Y.memo.value){D={};}};R.prototype.isSearchBox=function O(a){var Y=mstr.controllers.Factory.getPath("parent/items/6/EditSelectorType",a);var e=mstr.controllers.Factory.getPath("parent/items/1/EditSelectorStyle",a);if(Y&&e){var Z=Y.getSelectedItemValue()!=null?Y.getSelectedItemValue():microstrategy.getViewerBone().commands.queryState("EditSelectorType");var c=e.getSelectedItemValue()!=null?e.getSelectedItemValue():microstrategy.getViewerBone().commands.queryState("EditSelectorStyle");return(Z=="1"&&c=="9");}return false;};function R(Y){mstr.bones.editors.BoneTranslator.apply(this,[Y]);}return R;})();mstr.bones.editors.GridPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.BoneTranslator);D.prototype.translateBone=function B(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;this.on_set_DrillOptions();this.translating=false;};D.prototype.on_set_DrillOptions=function C(E){var F=(E&&E.memo&&E.memo.value);if(F==null){F=this.get("DrillOptions").getSelectedItemValue();}if(F==""){return ;}this.set("showSyncDrillingOpt",(F==2)&&mstr.behaviors.featureResolver.featAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS));};D.prototype.IF_MODE_ROWS="1";D.prototype.IF_MODE_BLOCKS="2";D.prototype.on_set_gridIfRowMode=function A(K){var E=(K&&K.memo&&K.memo.value);if(E==null){E=this.get("gridIfRowMode").getSelectedItemValue();}if(E==""){return ;}var G=this.getBone(),H=G.doc.selections.getSelectedGrid(),F=microstrategy.findBone(H),J=F.ifTotalRows,I=F.ifTotalBlocks,L=this.get("gridIfMaxRows"),M=L;if(J&&I){if(E===this.IF_MODE_ROWS){M=Math.round(L*J/I)||1;}else{M=Math.round(L*I/J)||1;}}else{M=1;}this.set("gridIfMaxRows",M);};function D(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return D;})();mstr.bones.editors.NumberPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.FormatEditingBoneTranslator);D.prototype.init=function F(){mstr.bones.editors.FormatEditingBoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"set_Category","_buildFormatString");this.attachEventListener(this,"set_DecimalPlaces","_buildFormatString");this.attachEventListener(this,"set_ThousandSeparator","_buildFormatString");this.attachEventListener(this,"set_CurrencySymbol","_buildFormatString");this.attachEventListener(this,"set_CurrencyPosition","_buildFormatString");this.get("NegativeNumbers").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");this.get("Date").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");this.get("Time").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");this.get("Fraction").attachEventListener(this,"hashadd_selectedIndices","_buildFormatString");};D.prototype.translateBone=function E(){mstr.bones.editors.FormatEditingBoneTranslator.prototype.translateBone.apply(this);var J=this.get("Format");var L=this.get("Category").getSelectedItem();L=L?parseInt(L.dssid):-2;switch(L){case -2:case 9:if(this.get("Format")=="General"){var K=this.translating;this.translating=true;this.set("Format","");this.translating=K;}break;case 0:case 1:case 4:this._rebuildNegativeNumberField(this._buildDecimalString(true));break;case 2:this.get("Date").execSelectValue(J);break;case 3:this.get("Time").execSelectValue(J);break;case 5:this.get("Fraction").execSelectValue(J);break;}};D.prototype.onModelPropertyChange=function H(J){mstr.bones.editors.FormatEditingBoneTranslator.prototype.onModelPropertyChange.apply(this,[J]);this._buildFormatString(J);};D.prototype._buildDecimalString=function I(N){var J="";var L=parseInt(this.get("DecimalPlaces"));for(var K=0;K<L;K++){J+="0";}var M=".";if(N){M=mstr.$obj("mstrPageInfo").get("userInfo").get("decimalSeparator");}return(J.length>0)?M+J:"";};D.prototype._addNegativeFormatString=function A(J){switch(this.get("NegativeNumbers").getSelectedIndex()){case 1:return J+";[RED]-"+J;case 2:return J+";[RED]"+J;case 3:return J+";("+J+")";case 4:return J+";[RED]("+J+")";default:return J;}};D.prototype._addCurrencySymbolFormatString=function C(J){var K="";var L=this.get("CurrencySymbol");switch(this.get("CurrencyPosition").getSelectedIndex()){case 1:K=J+'"'+L+'"';break;case 2:K='"'+L+' "'+J;break;case 3:K=J+'" '+L+'"';break;default:K='"'+L+'"'+J;}return this._addNegativeFormatString(K);};D.prototype._buildFormatString=function B(M){var O=this.get("Category").getSelectedItem();if(!O){return ;}var K=parseInt(O.dssid);if(K==7){return ;}var J=this._buildDecimalString();if(K==0||K==1||K==4){this._rebuildNegativeNumberField(this._buildDecimalString(true));}var N=(this.get("ThousandSeparator"))?",":"";var L="";switch(K){case 0:L=this._addNegativeFormatString("#"+N+"##0"+J);break;case 1:L=this._addCurrencySymbolFormatString("#,##0"+J);break;case 2:L=this.get("Date").getSelectedItem()["dssid"];break;case 3:L=this.get("Time").getSelectedItem()["dssid"];break;case 4:L=this._addNegativeFormatString("0"+J+"%");break;case 5:L=this.get("Fraction").getSelectedItem()["dssid"];break;case 6:L="0"+J+"E+00";}this.set("Format",L);};D.prototype._rebuildNegativeNumberField=function G(Q){var L=this.translating;this.translating=true;var J=this.get("NegativeNumbers");var P=mstr.utils.Hash.deepClone(J.getItems());var T=J.getSelectedItem()&&J.getSelectedItem()["dssid"];J.detachEventListener(this,"hashadd_selectedIndices");J.detachEventListener(this,"hashremove_selectedIndices");var N=this.get("Red");var K=this.getBone().commands.queryState("textfieldSelected")?"color:red;display:block;":"color:red;display:none;";var S=mstr.Settings.Locale.THOUSANDSEP;var R=parseInt(this.get("Category").getSelectedItem()["dssid"]);switch(R){case 0:S=(this.get("ThousandSeparator"))?S:"";P[0]["n"]="-1"+S+"234"+Q;P[1]["n"]="-1"+S+"234"+Q+" ["+N+"]";P[1]["cssText"]=K;P[2]["n"]="1"+S+"234"+Q+" ["+N+"]";P[2]["cssText"]=K;P[3]["n"]="(1"+S+"234"+Q+")";P[4]["n"]="(1"+S+"234"+Q+") ["+N+"]";P[4]["cssText"]=K;break;case 1:var O="";var U="";var M=this.get("CurrencySymbol");switch(this.get("CurrencyPosition").getSelectedIndex()){case 2:O+=" ";case 0:O=M+O;break;case 3:U+=" ";case 1:U+=M;break;}P[0]["n"]=O+"-1"+S+"234"+Q+U;P[1]["n"]=O+"-1"+S+"234"+Q+U+" ["+N+"]";P[1]["cssText"]=K;P[2]["n"]=O+"1"+S+"234"+Q+U+" ["+N+"]";P[2]["cssText"]=K;P[3]["n"]="("+O+"1"+S+"234"+Q+U+")";P[4]["n"]="("+O+"1"+S+"234"+Q+U+") ["+N+"]";P[4]["cssText"]=K;break;case 4:P[0]["n"]="-123"+Q+"%";P[1]["n"]="-123"+Q+"% ["+N+"]";P[1]["cssText"]=K;P[2]["n"]="123"+Q+"% ["+N+"]";P[2]["cssText"]=K;P[3]["n"]="(123"+Q+"%)";P[4]["n"]="(123"+Q+"%) ["+N+"]";P[4]["cssText"]=K;break;}J.setItems(P);if(T){J.execSelectValue(T);}J.attachEventListener(this,"hashadd_selectedIndices","onModelPropertyChange");J.attachEventListener(this,"hashremove_selectedIndices","onModelPropertyChange");this.translating=L;};function D(J){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[J]);}return D;})();mstr.bones.editors.ColorLinesPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(C,mstr.bones.editors.FormatEditingBoneTranslator);C.prototype.on_set_enableBorders=function G(H){var I=mstr.controllers.Factory.safeget;this.resolveBorderEnablement(H.memo.value,I(this.get("parent").get("items")[12],"enabled3d"));};C.prototype.on_set_ext_prop_enabled3d=function D(H){this.resolveBorderEnablement(this.get("enableBorders"),H.memo.value);};C.prototype.resolveBorderEnablement=function B(I,H){this.set("enableBordersNot3d",I&&!H);};C.prototype.translateBone=function F(){mstr.bones.editors.FormatEditingBoneTranslator.prototype.translateBone.apply(this);this.translating=true;var H=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);this.refreshForSearchBox(this,H);this.translating=false;};C.prototype.refreshForSearchBox=function A(L,J){var M=microstrategy.formatType;var I=L.get("parent").get("edtValueSelector");var K=I.get("items");var H=mstr.$A.findByForm(K,4,"dssid",false);if(J&&H>=0){I.set("selectedIndicesList",H);}I.set("formatEnabled",!J);microstrategy.formatType=M;};C.prototype.on_set_ext_prop_ButtonDisplayStyle=function E(H){var I=Number(H.memo.value);var J=this.get("visibleField");switch(I){case microstrategy.BUTTON_STYLE_CAPTION_ONLY:case microstrategy.BUTTON_STYLE_ICON_LEFT:case microstrategy.BUTTON_STYLE_ICON_RIGHT:case microstrategy.BUTTON_STYLE_ICON_TOP:case microstrategy.BUTTON_STYLE_ICON_ONLY:this.set(J,true);break;case microstrategy.BUTTON_STYLE_CUSTOM:this.set(J,false);break;}};function C(H){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[H]);}return C;})();mstr.bones.editors.ThemePropertiesBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.FormatEditingBoneTranslator);function D(I){mstr.bones.editors.FormatEditingBoneTranslator.apply(this,[I]);}D.prototype._resolveAppliedThemeTypeSelected=function H(){var J=this.get("appliedThemeID"),I=this.get("appliedThemeType"),K=this.get("appliedThemeTypes");if(!K){return ;}switch(I){case microstrategy.APPLIED_THEME_NONE:case microstrategy.APPLIED_THEME_CUSTOM:K.execSelectValue(I);break;case microstrategy.APPLIED_THEME_DEFAULT:K.execSelectValue(J);break;}};D.prototype._resolveAppliedThemeAsLink=function G(){var I=this.get("appliedThemeAsLink"),J=this.get("appliedThemeAsTypes");if(!J){return ;}J.execSelectValue(I?"1":"0");};D.prototype.translateBone=function F(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;this._resolveAppliedThemeTypeSelected();this._resolveAppliedThemeAsLink();this.translating=false;};D.prototype._handleAppliedThemeTypeChange=function E(I){if(this.translating){return ;}var K=this.get("appliedThemeTypes"),J=K.getSelectedItemValue();if(J===microstrategy.APPLIED_THEME_CUSTOM){this.set("appliedThemeType",J);this.set("appliedThemeID",null);this.set("showAppliedThemeAsType",true);this.set("showCustomThemePicker",true);}else{if(J===microstrategy.APPLIED_THEME_NONE){this.set("appliedThemeType",J);this.set("appliedThemeID",null);this.set("showAppliedThemeAsType",false);this.set("showCustomThemePicker",false);}else{this.set("appliedThemeType",microstrategy.APPLIED_THEME_DEFAULT);this.set("appliedThemeID",J);this.set("showAppliedThemeAsType",true);this.set("showCustomThemePicker",false);}}};D.prototype._handleAppliedThemeAsTypeChange=function A(I){if(this.translating){return ;}var K=this.get("appliedThemeAsTypes"),J=K.getSelectedItemValue();this.set("appliedThemeAsLink",J==="0"?false:true);};D.prototype.onModelPropertyChange=function C(I){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[I]);if(this.get("appliedThemeTypes")==I.src&&I.name=="hashadd_selectedIndices"){this._handleAppliedThemeTypeChange(I);}else{if(this.get("appliedThemeAsTypes")==I.src&&I.name=="hashadd_selectedIndices"){this._handleAppliedThemeAsTypeChange(I);}}};D.prototype.execBrowseTheme=function B(J){var L=microstrategy.getViewerBone(),I=L.saveFolderId?L.saveFolderId:L.parentFolderID,K=this;microstrategy.showApplyThemeEditor(false,null,function(O,N,M){K.set("appliedThemeID",O);K.set("appliedThemePath",encode(M));});};return D;})();mstr.bones.editors.DocAdvancedBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype._storeDeltaProp=function B(E,C){mstr.bones.editors.BoneTranslator.prototype._storeDeltaProp.apply(this,arguments);if(E=="RefreshDocument"&&C){var D="RefreshFrequency";this._storeDeltaProp(D,this.get(D));}};function A(C){mstr.bones.editors.BoneTranslator.apply(this,[C]);}return A;})();mstr.bones.editors.DocMobileBoneTranslator=(function(){mstr.$O.extendsClass(B,mstr.bones.editors.BoneTranslator);B.prototype.set=function A(D,C){mstr.bones.editors.BoneTranslator.prototype.set.apply(this,[D,C]);};function B(C){mstr.bones.editors.BoneTranslator.apply(this,[C]);}return B;})();mstr.bones.editors.PageSetupPageBoneTranslator=(function(){mstr.$O.extendsClass(E,mstr.bones.editors.BoneTranslator);E.prototype.init=function C(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"set_PageWidth","_handlePaperSizeChange");this.attachEventListener(this,"set_PageHeight","_handlePaperSizeChange");this.attachEventListener(this,"set_ScalePercentage","_handleScalingChange");this.attachEventListener(this,"set_ScalePagesWide","_handleScalingChange");this.attachEventListener(this,"set_ScalePagesTall","_handleScalingChange");};E.prototype._handlePaperSizeChange=function D(O){if(this.translating||this.changingPaperSize){return ;}if(O.name=="hashremove_selectedIndices"){return ;}this.changingPaperSize=true;var J,M,N,H,L;var P=this.get("PaperType");var G=this.get("PaperOrientation");var F=O.src;if(F==this){J=parseFloat(microstrategy.number.toUSUnits(this.get("PageHeight"),true),10);M=parseFloat(microstrategy.number.toUSUnits(this.get("PageWidth"),true),10);N=G.getSelectedIndex();if(N==0&&M>J){G.execSingleSelect(1);}else{if(N==1&&J>M){G.execSingleSelect(0);}}H=Math.min(J,M);L=Math.max(J,M);if(!P.execSelectString(".*,"+H+","+L,P.get("valueForm"))){P.execClearSelect();}}else{if(F==P){var N=P.getSelectedItemValue().split(",").slice(1);var K=["PageWidth","PageHeight"];if(G.getSelectedIndex()!=0){K.reverse();}for(var I=0;I<N.length;I++){this.set(K[I],microstrategy.number.toUserUnits(N[I]));}}else{J=parseFloat(microstrategy.number.toUSUnits(this.get("PageHeight")),10);M=parseFloat(microstrategy.number.toUSUnits(this.get("PageWidth")),10);H=Math.min(J,M);L=Math.max(J,M);H=microstrategy.number.toUserUnits(H);L=microstrategy.number.toUserUnits(L);N=G.getSelectedIndex();if(N==0){if(J!=L){this.set("PageHeight",L);this.set("PageWidth",H);}}else{if(J!=H){this.set("PageHeight",H);this.set("PageWidth",L);}}}}this.changingPaperSize=false;};E.prototype.onModelPropertyChange=function A(F){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[F]);if(F.src==this.get("PaperType")||F.src==this.get("PaperOrientation")){this._handlePaperSizeChange(F);}};E.prototype._handleScalingChange=function B(F){if(this.translating||this.changingScale){return ;}this.changingScale=true;var H=this.get("Scaling");var G=H.getSelectedIndex();if(F.name=="set_ScalePercentage"){if(G!=0){H.execSingleSelect(0);}}else{if(G!=1){H.execSingleSelect(1);}}this.changingScale=false;};function E(F){mstr.bones.editors.BoneTranslator.apply(this,[F]);}return E;})();mstr.bones.editors.ButtonPropertiesBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype.on_set_DisplayStyle=function D(E){var F=E.memo.value;this._onSetDisplayStyle(F);this.get("parent").notifyPropertyChange("ButtonDisplayStyle",E);};A.prototype._onSetDisplayStyle=function B(F){F=Number(F);var E=this;function G(H){E.set("normalURLEnable",H);E.set("highlightURLEnable",H);}switch(F){case microstrategy.BUTTON_STYLE_CAPTION_ONLY:G(false);break;case microstrategy.BUTTON_STYLE_ICON_ONLY:case microstrategy.BUTTON_STYLE_ICON_LEFT:case microstrategy.BUTTON_STYLE_ICON_RIGHT:case microstrategy.BUTTON_STYLE_ICON_TOP:case microstrategy.BUTTON_STYLE_CUSTOM:G(true);break;}if(this.get("isInsideNavBar")){this.set("highlightURLEnable",false);}};A.prototype.translateBone=function C(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;displayStyleValue=this.get("DisplayStyle").getSelectedItemValue();this._onSetDisplayStyle(displayStyleValue);this.translating=false;};function A(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return A;})();mstr.bones.editors.DocumentTabBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype.on_set_ExecutionFullScreenMode=function B(F){if(F.memo.value){this.set("ShowingBarsTemporarily",true);}};A.prototype.on_set_DefaultViewMode=function E(N){var G=this.get("DefaultViewMode");var L=mstr.utils.Hash.firstKey(N.memo.valueWas);var M=G.getItems()[L][G.get("valueForm")];switch(N.memo.src){case"hashremove_selectedIndices":this.cache={};this.cache[M]=true;break;case"hashadd_selectedIndices":this.cache[M]=false;this.changingRunMode=true;var I=this.get("AvailableViewModes");var F=this.get("AvailableExportModes");var H=I.getSelectedItems();var K=F.getSelectedItems();I.execEnableIndices(this.cache);F.execEnableIndices(this.cache);var J=function(O,S,Q){var P=O.getSelectedItems();outer:for(f1 in P){if(Q[P[f1].dssid]!=undefined){continue;}for(f2 in S){if(S[f2].dssid==P[f1].dssid){continue outer;}}var R=O.indexOfItem(P[f1]);O.execRemoveSelect(R);}};J(F,K,this.cache);J(I,H,this.cache);this.changingRunMode=false;if(!this._selectDefaultRunMode(I,M)){this._selectDefaultRunMode(F,M);}break;}};A.prototype._selectDefaultRunMode=function C(F,G){var H=F.indexOfValue(G);if(H==-1){return false;}var I=F.getSelectedIndices();if(!(H in I)){F.execAddSelect(H);}return true;};A.prototype.onModelPropertyChange=function D(F){if(this.changingRunMode){return ;}mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[F]);};function A(F){mstr.bones.editors.BoneTranslator.apply(this,[F]);}return A;})();mstr.bones.editors.WidgetBoneTranslator=(function(){mstr.$O.extendsClass(W,mstr.bones.editors.BoneTranslator);W.prototype.execOpenWidgets=function M(o){var m=getObjSumLeft(o),q=getObjSumTop(o)+getObjHeight(o),n;microstrategy.openBlockLoaderEditor("addWidgetMenu","InsertMenuBlockLoader",null,{cssText:"position:absolute;top:"+q+"px;left:"+m+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",useFixedPosition:"false",contextMenuName:"insertWidgetEditor",viewer:"#widgetBoneTranslator"},this,null,n);};W.prototype.execOpenVisPropsEditor=function F(x){var o=microstrategy.getViewerBone();if(o){var u=o.gridWidgets.lst;var AC=u[this.props.widgetId];if(AC&&AC.edt){var AA=o.doc.selections.getSelectedGrid();if(AA){var n=microstrategy.findBone(AA);if(n){if(this.isMojoVis(AC.edt)){if(this.props.hasChanges){var AB=this.props.parent.props.parent.props.models[0];AB.execPreviewChanges();}return n.docViewer.commands.exec("mojoVisPropsEditor",AC.edt);}var z=microstrategy.VIS_EDITOR_SCOPE_RW_GRID;var y=[z,AC.edt,""];y.push(this.props.WidgetProps||"");var m=this.deltaProps["default"];var q=(m&&m.SecondaryDataProviders)?m.SecondaryDataProviders:this.props.SecondaryDataProvidersValue;y.push(q||"");n.commands.exec("visPropsEditor",y);}}}}};W.prototype.commands={getTranslator:function(){if(!this.t){this.t=mstr.$obj("widgetBoneTranslator");}return this.t;},queryEnabled:function(){return true;},queryVisible:function(){return true;},queryState:function(){return true;},exec:function(m){var o=this.getTranslator();var n=m.split(";")[1];o.set("widgetId",n);}};W.prototype.on_set_widgetId=function I(m){var n=m.memo.value;this.set("ADisplayEnabled",n!="");this.updateWidgetInfo(n);};W.prototype.updateWidgetInfo=function a(o){var AF=this.getWidgetObj(o);if(AF){var q=microstrategy.getViewerBone();this.setupSecondaryDataProviders(AF);this.set("widgetName",AF.t);this.set("FlashDisplayEnabled",!!AF.wgt);this.set("DHTMLDisplayEnabled",!!AF.vis);this.set("iPhoneDisplayEnabled",!!AF.iphVis);this.set("iPadDisplayEnabled",!!AF.ipadVis);this.updateIPhoneFullscreen();this.set("AndroidDisplayEnabled",!!AF.aVis);this.set("AndroidTabletDisplayEnabled",!!AF.atVis);this.set("AndroidDisplayFullScreenEnabled",!!this.props.AndroidDisplayEnabled&&q.isMultiLayout);if(!this.translating){this.sureBoolSet("FlashDisplay",!!this.props.FlashDisplayEnabled);this.sureBoolSet("DHTMLDisplay",!!this.props.DHTMLDisplayEnabled&&AF.vis.vm!=50);this.sureBoolSet("iPhoneDisplay",!!this.props.iPhoneDisplayEnabled);this.sureBoolSet("iPhoneDisplayFullScreen",!!this.props.iPhoneDisplayEnabled);this.sureBoolSet("iPadDisplay",!!this.props.iPadDisplayEnabled);this.sureBoolSet("AndroidDisplay",!!this.props.AndroidDisplayEnabled);this.sureBoolSet("AndroidTabletDisplay",!!this.props.AndroidTabletDisplayEnabled);this.sureBoolSet("AndroidDisplayFullScreen",!!this.props.AndroidDisplayEnabled);this.set("WidgetProps","");}else{var AE=q.commands.queryState("setWidget");if(AE&&AE!="None"){var q=microstrategy.getViewerBone(),y=!!q&&q.gridWidgets&&q.gridWidgets.lst;for(var x in y){var AD=y[x];if(AD.wgt&&(AD.wgt.rsl==AE||AD.wgt.cn==AE)){this.set("FlashDisplay",o==x);break;}}}var AC=q.doc.selections.getSelectedGrid();if(AC){var n=microstrategy.findBone(AC);if(n){this.set("DHTMLDisplay",AF.vis&&AF.vis.s==n.selectedVisualization&&n.isVisualization);this.set("iPadDisplay",AF.ipadVis&&AF.ipadVis.s==n.iPadVis);}}var u=AF.iphVis&&AF.iphVis.s==q.iPhoneVis;var m=AF.iphVis&&AF.iphVis.s==n.iPhoneVis;this.set("iPhoneDisplay",u||m);this.set("iPhoneDisplayFullScreen",u);var AA=AF.aVis&&AF.aVis.s==q.aVis;var z=AF.aVis&&AF.aVis.s==n.aVis;this.set("AndroidDisplay",AA||z);if(q.aVis){this._storeDeltaProp("AndroidDisplay",true);}var AB=AF.atVis&&AF.atVis.s==n.atVis;this.set("AndroidTabletDisplay",AB);}this.set("OpenVisPropsEditor",AF.edt);}else{this.props.NonFlashRender.execSelectValue(0);this.set("widgetName",microstrategy.descriptors.getDescriptor(181));this.sureBoolSet("FlashDisplayEnabled",false);this.sureBoolSet("DHTMLDisplayEnabled",false);this.sureBoolSet("iPhoneDisplayEnabled",false);this.sureBoolSet("iPadDisplayEnabled",false);this.sureBoolSet("AndroidDisplayEnabled",false);this.sureBoolSet("AndroidTabletDisplayEnabled",false);this.sureBoolSet("FlashDisplay",false);this.sureBoolSet("DHTMLDisplay",false);this.sureBoolSet("iPadDisplay",false);this.sureBoolSet("AndroidDisplay",false);this.sureBoolSet("AndroidTabletDisplay",false);this.sureBoolSet("iPhoneDisplay",false);this.sureBoolSet("iPhoneDisplayFullScreen",false);this.sureBoolSet("AndroidDisplayFullScreen",false);}this.updateLabelsForAltDisplay();this.updateFlashDisplayLabel();this.updateIPhoneDisplayLabel();this.updateIPadDisplayLabel();this.updateAndroidDisplayLabel();this.updateAndroidTabletDisplayLabel();};W.prototype.sureBoolSet=function L(o,m){if(m==this.props[o]){this.props[o]=!m;}this.set(o,m);};W.prototype.setupSecondaryDataProviders=function J(m){if(!m){m=this.getWidgetObj(this.props.widgetId);}if(!m){this.set("showSecondaryDataProviders",false);return ;}if((!!this.props.FlashDisplay||!!this.props.DHTMLDisplay||!!this.props.iPadDisplay||!!this.props.AndroidDisplay||!!this.props.AndroidTabletDisplay||!!this.props.iPhoneDisplay)&&(m.smn>0||m.smx>0)){this.set("showSecondaryDataProviders",true);this.validateSecondaryDataProviders();}else{this.set("showSecondaryDataProviders",false);if(!this.translating){this.get("parent").set("enableOk",true);this.get("parent").set("enablePreview",true);}}};W.prototype.validateSecondaryDataProviders=function g(m){var n=this.get("SecondaryDataProviders"),q=n&&n.get("selected").get("items").length,o=this.getWidgetObj(this.get("widgetId"));if(!o){return ;}if(q<o.smn||q>o.smx){this.get("parent").set("enableOk",false);this.get("parent").set("enablePreview",false);}else{this.get("parent").set("enableOk",true);this.get("parent").set("enablePreview",true);}};W.prototype.on_set_SecondaryDataProviders=function c(m){this.validateSecondaryDataProviders();};W.prototype.on_set_FlashDisplay=function N(m){this.setupSecondaryDataProviders();this.updateFlashDisplayLabel();};W.prototype.updateFlashDisplayLabel=function R(){this.set("FlashDisplayLabel",!!this.props.FlashDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.on_set_DHTMLDisplay=function e(m){this.setupSecondaryDataProviders();this.set("DHTMLDisplayLabel",m.memo.value?this.props.widgetName:this.props.PDFExcelDisplayLabel);};W.prototype.on_set_iPhoneDisplay=function Q(m){this.setupSecondaryDataProviders();this.updateIPhoneDisplayLabel();};W.prototype.on_set_iPhoneDisplayFullScreen=function E(m){this.sureBoolSet("iPhoneDisplay",!!this.props.iPhoneDisplay);};W.prototype.updateIPhoneDisplayLabel=function H(){this.set("iPhoneDisplayLabel",!!this.props.iPhoneDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.updateIPhoneFullscreen=function U(){this.set("iPhoneDisplayFullScreenEnabled",!!this.props.iPhoneDisplay&&!!this.props.iPhoneDisplayEnabled&&microstrategy.getViewerBone().isMultiLayout);};W.prototype.on_set_iPadDisplay=function h(m){this.setupSecondaryDataProviders();this.updateIPadDisplayLabel();};W.prototype.updateIPadDisplayLabel=function C(){this.set("iPadDisplayLabel",!!this.props.iPadDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.on_set_AndroidDisplay=function T(m){this.setupSecondaryDataProviders();this.updateAndroidDisplayLabel();};W.prototype.on_set_AndroidTabletDisplay=function K(m){this.setupSecondaryDataProviders();this.updateAndroidTabletDisplayLabel();};W.prototype.on_set_AndroidDisplayFullScreen=function Y(m){this.sureBoolSet("AndroidDisplay",!!this.props.AndroidDisplay);};W.prototype.on_set_mojoVisPropsChanged=function D(m){if(m.memo.value){this.setupSecondaryDataProviders();}};W.prototype.updateAndroidDisplayLabel=function A(){this.set("AndroidDisplayLabel",!!this.props.AndroidDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.updateAndroidTabletDisplayLabel=function G(){this.set("AndroidTabletDisplayLabel",!!this.props.AndroidTabletDisplay?this.props.widgetName:microstrategy.descriptors.getDescriptor(7759));};W.prototype.on_set_NonFlashRender=function Z(m){this.updateLabelsForAltDisplay();};W.prototype.updateLabelsForAltDisplay=function P(){this.set("PDFExcelDisplayLabel",this.getAltDisplayLabel(this.props.NonFlashRender.props.selectedIndicesList));this.set("DHTMLDisplayLabel",!!this.props.DHTMLDisplay?this.props.widgetName:this.props.PDFExcelDisplayLabel);};W.prototype.getAltDisplayLabel=function S(m){var n=7759;if(m=="1"){n=7760;}else{if(m=="2"){n=7761;}}return microstrategy.descriptors.getDescriptor(n);};W.prototype.getWidgetObj=function V(o){var n=microstrategy.getViewerBone(),m=!!n&&n.gridWidgets&&n.gridWidgets.lst;return !!m&&m[o];};W.prototype.isMojoVis=function B(m){return["GraphMatrixVisualizationStyle","VIHeatMapVisualizationStyle","NetworkVisualizationStyle"].indexOf(m)>-1;};W.prototype.onModelPropertyChange=function X(m){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[m]);this.validateSecondaryDataProviders(m);};W.prototype.translateBone=function O(){this.props.widgetId="-1";mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);};function W(m){mstr.bones.editors.BoneTranslator.apply(this,[m]);}return W;})();mstr.bones.editors.OnlineBoneTranslator=(function(){mstr.$O.extendsClass(D,mstr.bones.editors.BoneTranslator);D.prototype.init=function C(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);if(!this.get("boneModel")){return ;}var G=this.props.parent;if(G){var H=mstr.$obj(G.props.boneId);if(H&&H.observer){H.observer.register(this.get("id"));}}};D.prototype.onselectionchange=function(){this.translateBone();};D.prototype.translateBone=function E(){var H=this.get("boneModel");var I=this.props.enabledField;if(I!=null&&I.length>0){var G=H.commands.queryEnabled(I);if(G!=this.props[I]){this.set(I,G);}if(!this.props[I]){return ;}}mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);};D.prototype.on_set_fontTabEnabled=function B(H){var G=this.props.fields;var K=G&&G.length>0?G.split("|"):[];var J;for(var I=0;I<K.length;I++){J=K[I];if(!J||!J.length>0){continue;}this.props[J]&&this.props[J].set&&this.props[J].set(H.memo.name,H.memo.value);}};D.prototype._storeDeltaProp=function A(H,G){this.exec(H,G);};D.prototype.exec=function F(K,G){var I=this.props.parent;if(I){var J=mstr.$obj(I.props.boneId);if(J){var H=[{obj:null,cmdId:K,value:G,memo:{},performFormatChange:true,submitUpdateManager:false}];if(!(J.commands.exec(I.props.boneCmdId,H))){return false;}}}};function D(G){mstr.bones.editors.BoneTranslator.apply(this,[G]);}return D;})();mstr.bones.editors.TOCPageBoneTranslator=(function(){mstr.$O.extendsClass(A,mstr.bones.editors.BoneTranslator);A.prototype._resolveTOCTitleSet=function C(E){if(E&&E.props&&E.props.selectedCount&&E.props.selectedCount==1&&E.props.selectedIndicesList){if(E.props.selectedIndicesList=="0"||E.props.selectedIndicesList==""){this.set("TOCBorderStyleEnable",false);}else{this.set("TOCBorderStyleEnable",true);}}};A.prototype.onModelPropertyChange=function B(E){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[E]);if(E.src==this.get("TOCBorderStyle")){this._resolveTOCTitleSet(E.src);}};A.prototype.set=function D(H,F){mstr.bones.editors.BoneTranslator.prototype.set.apply(this,[H,F]);if(H=="EnableToc"||H=="TOCTitleEnableInherit"){var E=this.get("EnableToc");var G=this.get("TOCTitleEnableInherit");if(E&&!G){this.set("TOCTitleSetEnable",true);}else{this.set("TOCTitleSetEnable",false);}}if(H=="EnableToc"){this._resolveTOCTitleSet(this.get("TOCBorderStyle"));}};function A(E){mstr.bones.editors.BoneTranslator.apply(this,[E]);}return A;})();mstr.bones.editors.SelectorPageBoneTranslator=(function(){mstr.$O.extendsClass(B,mstr.bones.editors.BoneTranslator);B.prototype.init=function K(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"openPopup","_handleOpenPopup");};B.prototype.reinitializeModel=function S(){mstr.bones.editors.BoneTranslator.prototype.reinitializeModel.apply(this);if(this.get(this.props.visibleField)){this._resolveUCLogic();}this._resolveStateEnabled();var AK=null;var AJ=null;var AL=this.translating;this.translating=true;this._resolveDelimiterSelected();this._resolveAttrFormSelected();this._resolveAttrFormEnabled();this.translating=AL;};B.prototype._resolveDelimiterSelected=function AH(){if(!this.get("EditSelectorSource")){return ;}var AK=this.get("showFormDelimiters");if(this.get("EditSelectorSource").getSelectedIndex()==0){AK.execSingleSelect(0);}else{var AJ=this.get("EditFormDelimiter");if(AJ==" "){AJ="SPACE";}AK.execSelectValue(AJ)||AK.execSingleSelect(4);}};B.prototype._resolveAttrFormSelected=function R(){if(!this.get("EditSelectorSource")){return ;}var AK=this.get("displayForms");if(this.get("EditSelectorSource").getSelectedIndex()==0){this.updateDisplayFormList(null);AK.execSingleSelect(0);this.attrFormSelectedIndex=0;this.attrFormSelectedItems=null;}else{var AL=this.get("EditDisplayForm");if(AL==mstr.Enum.AttrFormSelector.CUSTOM){var AJ=this.get("selectedAttrForms");this.updateDisplayFormList(AJ);this.checkAvailabilityAndSelect(AJ);this.attrFormSelectedIndex=1;this.attrFormSelectedItems=AJ;}else{this.updateDisplayFormList(null);AK.execSingleSelect(0);this.attrFormSelectedIndex=0;this.attrFormSelectedItems=null;}}};B.prototype._resolveAttrFormEnabled=function h(){if(!this.get("EditSelectorSource")){return ;}this.set("displayFormsEnable",true);var AJ=this.get("EditSelectorSource").getSelectedIndex();if(AJ<0){return ;}if(AJ==0){this.set("displayFormsEnable",false);}else{var AM=this.getBone().commands.queryState("documentAttributesType")[AJ];if(!AM){return ;}var AL=AM.type.split("|")[0];var AK=AM.type.split("|")[1];if(AL&&(AL==microstrategy.DSSTYPE_CONSOLIDATION||(AL==microstrategy.DSSTYPE_FILTER&&AK==microstrategy.DSSTYPE_CUSTOM_GROUP))){this.set("displayFormsEnable",false);}else{this.set("displayFormsEnable",true);}}};B.prototype._initializeDynamicModel=function q(AJ,AK,AN){if(AJ=="selectedAttrForms"){this._setDynamicModelValues(AJ,AK,AN);this.set("afCartModel",AK);var AM=AK.get("selected");AM.attachEventListener(this,"listadd_items","onOkEnabledChange");AM.attachEventListener(this,"listremove_items","onOkEnabledChange");this.set("okBtnEnable",!!(AK&&AK.props&&AK.props.selected&&AK.props.selected.getItems().length>0));}else{if(AJ=="sortAttrForm"){this._setDynamicModelValues(AJ,AK,AN);this.set("afListModel",AK);AK.attachEventListener(this,"hashadd_selectedIndices","onModelPropertyChange");this._resolveSortType();}else{mstr.bones.editors.BoneTranslator.prototype._initializeDynamicModel.apply(this,[AJ,AK,AN]);if(AJ=="EditSelectorTargets"){var AL=this.translating;this.translating=true;this._resolveUCLogic();this.translating=AL;}if(AJ=="selectorCurrentState"){var AL=this.translating;this.translating=true;this._resolveCountEnabled();this._resolveStateEnabled();this._resolveAllEnabled();this.translating=AL;}if(AJ=="EditSelectorSource"){var AL=this.translating;this.translating=true;this._resolveDelimiterSelected();this._resolveAttrFormSelected();this._resolveAttrFormEnabled();this.translating=AL;}}}};B.prototype.checkAvailabilityAndSelect=function y(AO){if(this.availAttrForms==null){this.availAttrForms={};}var AK=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue();if(AK){var AM=AK.split("|")[0];if(this.availAttrForms[AM]==null){var AL=this;var AJ={success:function(AU){var AP=[];var AT={};for(var AS in AU.objects){var AW=AU.objects[AS];var AQ=AW.did+"|"+AW.t+"|"+AW.n;AP.push({dssid:AQ,n:AW.n});AT[AQ]=true;}AL.availAttrForms[AM]=AP;var AV=[];for(var AS in AO){if(AT[AO[AS].dssid]){AV.push(AO[AS]);}}var AR=AL.translating;AL.translating=true;AL.updateDisplayFormList(AV);AL.translating=AR;},failure:function(AP){AL.updateDisplayFormList([]);}},AN={taskId:"getWSAttributeForms",attributeID:AM,objectType:55,msgID:this.getBone().messageID};mstr.$XHR.request(mstrConfig.taskURL,AN,AJ);}}};B.prototype._getAvailableSortForm=function AE(AN,AL){if(!AN||!AL){return undefined;}var AK=AN.split("|")[0],AJ=AL.length,AO;for(var AM=0;AM<AJ;AM++){AO=AL[AM].dssid;if(AK==AO.split("|")[0]){return AO;}}return undefined;};B.prototype._setDynamicModelValues=function I(AJ,AK,AN){if(AN=="availAttrFormsList"||AN=="availAttrFormsCart"){if(this.availAttrForms==null){this.availAttrForms={};}var AL=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue();if(AL){var AM=AL.split("|")[0];if(this.availAttrForms[AM]==null){return ;}else{if(AN=="availAttrFormsList"){this._setDynamicListModelValues(AK,this.availAttrForms[AM],AJ);}else{this._setDynamicCartModelValues(AK,this.availAttrForms[AM],AJ);}}}}else{mstr.bones.editors.BoneTranslator.prototype._setDynamicModelValues.apply(this,[AJ,AK,AN]);}};B.prototype._setDynamicListModelValues=function Z(AL,AP,AN){if(AN=="sortAttrForm"){var AM=microstrategy.descriptors.getDescriptor("959"),AK=this.get(AN)||this.getBone().commands.queryState(AN),AS=AK.dssid,AP,AJ=mstr.Enum.AttrFormSelector.DEFAULT_SORT;if(AS){AS=this._getAvailableSortForm(AS,AP)||AJ;}else{AS=AJ;}AP=AP&&[{dssid:AJ,n:AM}].concat(AP);}else{var AS=this.getBone().commands.queryState(AN);}if(AN=="EditSelectorSource"){var AT=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);if(AT){AP=this.getBone().commands.queryState("documentPureAttributes");}}var AO=this.getBone().commands.queryState("isAQSelector");if(AO){AP=this.getBone().commands.queryState("documentAttributesWithDateForm");}AL.setItems(AP);var AR=(mstr.$A.isArray(AS))?"execSelectValues":"execSelectValue";var AQ=AL[AR](AS);if(AN=="EditSelectorSource"&&!AQ){AL.execSingleSelect(0);}};B.prototype._setDynamicCartModelValues=function Y(AL,AK,AJ){AL.get("available").setItems(AK);if(AJ=="selectedAttrForms"){var AM=this.get(AJ)||this.getBone().commands.queryState(AJ);}else{var AM=this.getBone().commands.queryState(AJ);}AL.get("selected").setItems(AM);AL._updateAvailableFilteredItems();};B.prototype._resolveSelecotrSourceForUConDS=function AF(AQ){if(AQ&&AQ.selectedCount==1){if(isNaN(AQ.selectedIndicesList)){return false;}var AN=parseInt(AQ.selectedIndicesList);if(AQ.items[AN]){var AL=AQ.items[AN],AP=-1,AM=AL.sty;var AJ=AL.dssid.split("|");if(AJ.length>2&&!isNaN(AJ[1])){AP=parseInt(AJ[1]);}var AR=this.get("dsAsTgtChkVisible"),AK=this.get("isDSAsTarget"),AO=this.get("EditSelectorType"),AS=AO.getSelectedItemValue();if(AP===parseInt(microstrategy.DSSTYPE_ATTRIBUTE)&&AM!==microstrategy.DSSSUB_TYPE_DERIVED_ATTRIBUTE&&AS!==mstrRWControlImpl.CTL_TYPE_ATTR_QUAL&&AS!==mstrRWControlImpl.CTL_TYPE_ATTR_LIST){if(!AR){this.set("dsAsTgtChkVisible",true);}}else{if(AK){this.set("isDSAsTarget",false);}if(AR){this.set("dsAsTgtChkVisible",false);}}}}};B.prototype._resolveEditSelectorTargetsCartList=function AD(AJ){var AM=this.get("EditSelectorSource");if(!AM||!AM.getSelectedItem()){return ;}var AL=AM.getSelectedItem().olap,AK=AM&&AM.getSelectedItem(),AN=AK&&AK.de&&AK.sty!=12033;lastSelectedItem=AM.getItems()[this.lastSelectedSourceIdx],lastde=lastSelectedItem&&lastSelectedItem.de&&lastSelectedItem.sty!=12003,lastOlap=lastSelectedItem&&lastSelectedItem.olap;if(AL&&!lastOlap||AN&&!lastde){this._setDynamicModelValues("EditSelectorTargetsNoPlaceholder",this.get("EditSelectorTargets"),"availableTemplatesNoPlaceholder");}else{if(!AL&&lastOlap||!AN&&lastde){this._setDynamicModelValues("EditSelectorTargets",this.get("EditSelectorTargets"),"availableTemplates");}}};B.prototype._storeLastSelectedSourceIdx=function J(AJ){if(AJ&&AJ.memo){this.lastSelectedSourceIdx=mstr.utils.Hash.firstKey(AJ.memo.at);}};B.prototype.onModelPropertyChange=function C(AJ){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[AJ]);if(AJ.src==this.get("EditSelectorType")){this._handleSelectorTypeChange();this.get("parent").notifyPropertyChange("EditSelectorType",AJ);this._resolveUCLogic();this._resolveStateUCVisible();this._resolveCountEnabled();this._resolveStateEnabled();this._resolveAllEnabled();this._resolveGUIComponentsVisible();this._resolveCartListVisible();}else{if(AJ.src==this.get("DataFilterMode")){this._resolveTotalAndAutoSynchEnabled();this._resolveCountEnabled();this._resolveStateUCVisible();this._resolveUpdateFilterTargetEnabled();}else{if(this.get("EditSelectorTargets")&&(AJ.src==this.get("EditSelectorTargets").get("selected")||this.get("EditSelectorSource")==AJ.src)){this._resolveUCLogic();if(this.get("EditSelectorSource")==AJ.src){this._resolveAttrFormEnabled();this._resolveEditSelectorTargetsCartList(AJ);this._storeLastSelectedSourceIdx(AJ);}if(AJ.name!="listremove_items"&&!this.translating){this._resolveDataFilterMode();}}else{if(this.get("EditSelectorTargets")&&(AJ.src==this.get("EditSelectorTargets").get("selected")||this.get("EditSelectorSourceDDIC")==AJ.src)){this._resolveUCLogic();if(AJ.name!="listremove_items"&&!this.translating){this._resolveDataFilterMode();}}else{if(this.get("selectorCurrentState")==AJ.src){this._resolveCountEnabled();}else{if(this.get("EditSelectorSelectionType")==AJ.src){this._resolveAllEnabled();}else{if(this.get("showFormDelimiters")==AJ.src&&AJ.name=="hashadd_selectedIndices"){this._resolveDelimiter();}else{if(this.get("displayForms")==AJ.src&&AJ.name=="hashadd_selectedIndices"){this._resolveDisplayForm();}else{if(this.get("afListModel")==AJ.src&&AJ.name=="hashadd_selectedIndices"){this._resolveSortType();}}}}}}}}}if(this.get("EditSelectorSource")==AJ.src&&AJ.name=="hashadd_selectedIndices"){this._clearAttrFormSelector();this.get("parent").notifyPropertyChange("EditSelectorSource",AJ);this._resolveSelecotrSourceForUConDS(AJ.src.props);}};B.prototype.set=function P(AM,AK){mstr.bones.editors.BoneTranslator.prototype.set.apply(this,[AM,AK]);if(AM=="isDSAsTarget"){var AL=this.get("EditSelectorType");if(AK){this.set("DataFilterVisible",false);this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",true);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);this.set("selectorAutoSyncVisible",false);this.set("showTotalVisible",false);this.set("countVisible",false);this.set("selectionTypeVisible",false);this._moveSelectedBack("EditSelectorTargets");}else{if(AL.getSelectedItemValue()==1){if(!this.getBone().commands.queryState("isMetricQualifier")){this.set("DataFilterVisible",true);}this.set("attrLCVisible",true);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);this.set("selectorAutoSyncVisible",true);var AJ=this.getBone().commands.queryState("isDDIC");this.set("showTotalVisible",!AJ);this.set("countVisible",!AJ);this.set("selectionTypeVisible",!AJ);this._moveSelectedBack("EditSelectorTargetsDataset");}}this._resolveStateUCVisible();}else{if(AM=="Autowire"){this.set("showAutoWireMessage",AK);}}};B.prototype._moveSelectedBack=function AC(AK){var AJ=this.get(AK);if(AJ){AJ.execRemoveAll();}};B.prototype._resolveStateUCVisible=function V(){var AK=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();var AL=this.get("DataFilterMode");var AM=AL&&AL.getSelectedItemValue();var AJ=this.get("isDSAsTarget");if(AM==null||AM==undefined){AM=this.getBone().commands.queryState("DataFilterMode");}if(AM=="1"||(AK=="1"&&AJ)){this.set("stateUCVisible",true);}else{this.set("stateUCVisible",false);}};B.prototype._resolveGUIComponentsVisible=function O(){var AK=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();this.set("DataFilterVisible",true);this.set("selectionTypeVisible",false);this.set("showAdvanced",true);if(AK==1){this.set("dsAsTgtChkVisible",true);var AJ=this.get("isDSAsTarget");if(AJ){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",true);this.set("attrReplaceLCVisible",false);this.set("DataFilterVisible",false);this.set("submissionLCVisible",false);}else{this.set("attrLCVisible",true);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("selectionTypeVisible",true);this.set("submissionLCVisible",false);}}else{if(AK==2){this.set("dsAsTgtChkVisible",false);this.set("isDSAsTarget",false);this.set("attrLCVisible",false);this.set("metricLCVisible",true);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AK==3){this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AK==4){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("DataFilterVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",true);}else{if(AK==8){this.set("dsAsTgtChkVisible",false);this.set("isDSAsTarget",false);this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",true);this.set("DataFilterVisible",false);this.set("showAdvanced",false);this.set("submissionLCVisible",false);this.set("EditSelectorShowAll",false);this.set("EditSelectorMultiSelect",false);}}}}}this._resolveStateUCVisible();};B.prototype._clearAttrFormSelector=function E(){if(!this.translating){this._clearPopupDelta();this.get("displayForms").execSingleSelect(0);this.get("showFormDelimiters").execSingleSelect(0);if(this.get("stRadioList")){this.get("stRadioList").execClearSelect();}}};B.prototype._resolveSortType=function X(){if(this.translating){return ;}if(!this.get("stRadioList")){this.getSortTypeModel();}if(this.get("afListModel").getSelectedItemValue()==mstr.Enum.AttrFormSelector.DEFAULT_SORT){this.get("stRadioList").execClearSelect();this.set("SortTypeEnabled",false);}else{var AJ=this.get("sortType");this.get("stRadioList").execSelectValue(AJ);this.set("SortTypeEnabled",true);}};B.prototype._resolveDisplayForm=function u(){if(!this.translating){displayFormList=this.get("displayForms");if(!displayFormList){return ;}var AJ=displayFormList.getSelectedItemValue();if(AJ==mstr.Enum.AttrFormSelector.AUTOMATIC){if(displayFormList.props.items.length>2){this._removeCustom(displayFormList);}this.set("EditDisplayForm",AJ);this.attrFormSelectedIndex=0;this.attrFormSelectedItems=null;}else{if(AJ=="custom"){this.execTryOpenPopup("AttrFormsEditor","AttrFormsCartBlock","selectedAttrForms","availAttrFormsCart");this.set("EditDisplayForm",mstr.Enum.AttrFormSelector.CUSTOM);}}}};B.prototype._clearPopupDelta=function x(){this.set("selectedAttrForms",[]);this.set("sortAttrForm",mstr.Enum.AttrFormSelector.DEFAULT_SORT);};B.prototype.execTryOpenPopup=function G(AL,AN,AQ,AJ){if(this.availAttrForms==null){this.availAttrForms={};}var AS=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue(),AK=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItem().n;if(AS){var AP=AS.split("|")[0],AT=arguments;AT.title=microstrategy.descriptors.getDescriptor("2890")+(AK?" - "+AK:"");if(this.availAttrForms[AP]==null){var AR=this;var AM={success:function(AW){var AU=[];for(var AV in AW.objects){var AX=AW.objects[AV];AU.push({dssid:AX.did+"|"+AX.t+"|"+AX.n,n:AX.n});}AR.availAttrForms[AP]=AU;AR.raiseEvent("openPopup",{args:AT});},failure:function(AU){showMessage({contents:AU.getResponseHeader("X-MSTR-TaskFailureMsg"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}},AO={taskId:"getWSAttributeForms",attributeID:AP,objectType:55,msgID:this.getBone().messageID};mstr.$XHR.request(mstrConfig.taskURL,AO,AM);}else{this.raiseEvent("openPopup",{args:AT});}}};B.prototype._handleOpenPopup=function a(AJ){args=AJ&&AJ.memo&&AJ.memo.args;editorId=args[0],editorStyle=args[1],propertyName=args[2],source=args[3];microstrategy.openBlockLoaderEditor(editorId,editorStyle,{},{title:(args&&args.title)||""},this,null,null);if(propertyName=="selectedAttrForms"&&this.get("afCartModel")){this._setDynamicModelValues(propertyName,this.get("afCartModel"),source);}else{if(propertyName=="sortAttrForm"&&this.get("afListModel")){this._setDynamicModelValues(propertyName,this.get("afListModel"),source);mstr.$obj("tt").render();}}};B.prototype.onOkEnabledChange=function F(AJ){model=AJ&&AJ.src;this.set("okBtnEnable",!!(model&&model.getItems().length>0));};B.prototype.execSelectAttrForms=function n(AL){if(AL&&AL.get("selected")){var AK=AL.get("selected"),AJ=AK.getItems();if(this.translating){return ;}this.updateDisplayFormList(AJ);AJ=AJ&&[].concat(AJ);this.set("selectedAttrForms",AJ);this.attrFormSelectedIndex=1;this.attrFormSelectedItems=AJ;}};B.prototype.updateDisplayFormList=function Q(AK){displayFormList=this.get("displayForms");if(displayFormList.get("items").length>2){this._removeCustom(displayFormList);}if(!AK||AK.length==0){displayFormList.execSingleSelect(0);return ;}this.set("selectedAttrForms",AK);itemValue=AK[0].n;for(i=1;i<AK.length;i++){itemValue+=","+AK[i].n;}var AJ=mstr.Enum.AttrFormSelector.CUSTOM;displayFormList.insertItemsAt([{dssid:AJ,n:itemValue}],2);displayFormList.execSingleSelect(2);};B.prototype._removeCustom=function T(AJ){this.set("selectedAttrForms",[]);AJ.removeItemsAt([2]);var AK=mstr.$obj("formLPD");if(AK&&AK.props.currentPopUp){AK.props.currentPopUp.props.scrollArea.children[0].style.width="200px";}};B.prototype.execCancelSelectAttrForms=function AB(){if(this.attrFormSelectedIndex==0){this.get("displayForms").execSingleSelect(0);return ;}else{if(this.attrFormSelectedIndex==1&&this.attrFormSelectedItems){this.updateDisplayFormList(this.attrFormSelectedItems);return ;}}this.get("displayForms").execSingleSelect(0);};B.prototype.execSelectSortAttrForm=function z(){if(this.translating){return ;}var AK=this.get("afListModel").getSelectedItem();var AJ=mstr.$H.clone(AK);AJ.attr=this.get("EditSelectorSource")&&this.get("EditSelectorSource").getSelectedItemValue();this.set("sortAttrForm",AJ);this.set("sortType","-1");this.set("sortType",this.get("stRadioList").getSelectedItemValue());};B.prototype._resolveDelimiter=function g(){var AK=this.get("showFormDelimiters");var AL=AK.getSelectedItemValue()||"";if(AL=="OTHER"){var AJ=this.get("EditFormDelimiter");if(AJ==":"||AJ==";"||AJ==","||AJ==" "){AJ=":";}this.set("EditFormDelimiter",AJ);}else{if(AL=="SPACE"){AL=" ";}this.set("EditFormDelimiter",AL);}};B.prototype.getSortTypeModel=function e(){var AJ=this._createNewModel({scriptClass:"ListModel",parent:this,valueForm:"dssid"});var AK=microstrategy.descriptors.getDescriptor("1885"),AL=microstrategy.descriptors.getDescriptor("1886");AJ.setItems([{dssid:"1",n:AK},{dssid:"0",n:AL}]);this.set("stRadioList",AJ);return AJ;};B.prototype._moveSelectedBack=function AC(AK){var AJ=this.get(AK);if(AJ){AJ.execRemoveAll();}};B.prototype._resolveCartListVisible=function AG(){var AK=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();this.set("DataFilterVisible",true);this.set("showAdvanced",true);if(AK==1){var AJ=this.get("isDSAsTarget");if(AJ){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",true);this.set("attrReplaceLCVisible",false);this.set("DataFilterVisible",false);this.set("submissionLCVisible",false);}else{this.set("attrLCVisible",true);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}}else{if(AK==2){this.set("attrLCVisible",false);this.set("metricLCVisible",true);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AK==3){this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",false);}else{if(AK==4){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("DataFilterVisible",false);this.set("attrReplaceLCVisible",false);this.set("submissionLCVisible",true);}else{if(AK==8){this.set("attrLCVisible",false);this.set("metricLCVisible",false);this.set("datasetLCVisible",false);this.set("attrReplaceLCVisible",true);this.set("DataFilterVisible",false);this.set("showAdvanced",false);this.set("submissionLCVisible",false);this.set("EditSelectorShowAll",false);this.set("EditSelectorMultiSelect",false);}}}}}};B.prototype._resolveCountEnabled=function m(){var AK=this.get("EditSelectorType").getSelectedItemValue(),AM=this.get("DataFilterMode"),AJ=AM&&AM.getSelectedItemValue(),AL=this.get("selectorCurrentState"),AL=AL&&AL.getSelectedItemValue(),AN=(AL&&AL!="-1");this.set("countEnabled",AK=="1"&&AN);this.set("nonMixed",(AJ!="-1"));};B.prototype._resolveStateEnabled=function o(){var AJ=this.get("EditSelectorType").getSelectedItemValue();this.set("stateEnabled",AJ=="1");};B.prototype._resolveAllEnabled=function H(){this._handleSelectorTypeChange();var AK=this.get("EditSelectorType"),AJ=AK.getSelectedItemValue(),AL=AJ!=="3";if(AL){AK=this.get("EditSelectorSelectionType");AJ=AK.getSelectedItemValue();AL=AJ!=="0";}if(!AL){this.set("EditSelectorShowAll",false);}this.set("OptionAllEnabled",AL);};B.prototype._handleSelectorTypeChange=function W(){if(this.translating){return ;}var AK=this.get("EditSelectorType"),AJ=AK.getSelectedItemValue();switch(AJ){case"3":this.set("EditSelectorShowAll",false);case"2":this.set("EditSelectorShowTotal",false);break;}this._clearAttrFormSelector();};B.prototype._resolveUCLogic=function M(){this._resolveDataFilterModeEnabled();this._resolveTotalAndAutoSynchEnabled();this._resolveUpdateFilterTargetEnabled();};B.prototype._resolveDataFilterModeEnabled=function AI(){var AL=this.get("EditSelectorType");var AQ=this.props["EditSelectorSource"+(this.get("isMetricQualifier")?"Metrics":this.get("isDDIC")?"DDIC":"")];if(!AQ){return ;}var AP=AQ&&AQ.getSelectedItem()&&AQ.getSelectedItem().olap,AK=AQ&&AQ.getSelectedItem()&&AQ.getSelectedItem().sty;AQ=AQ&&AQ.getSelectedItemValue();AQ=AQ&&AQ.split("|");AQ=AQ&&AQ.length>2&&(AQ[1]==microstrategy.DSSTYPE_ATTRIBUTE||(AQ[1]==microstrategy.DSSTYPE_CONSOLIDATION&&AK=="12033"));var AJ=this.get("EditSelectorTargets").get("selected").props.items;var AN=false;for(var AM=0;AJ&&AM<AJ.length;AM++){var AO=AJ[AM];if(AO.dssid.indexOf("_")>-1){AN=true;break;}}this.set("DataFilterModeEnabled",(AJ&&AJ.length>0)&&(AL.getSelectedItemValue()==1)&&!!AQ&&!AP&&!AN);};B.prototype._resolveDataFilterMode=function L(){var AO=this.get("EditSelectorSource"),AK=AO&&AO.getSelectedItem(),AN=AO&&AO.getSelectedItemValue(),AQ=AN&&AN.split("|"),AL=AK&&AK.sty===257,AM=AQ&&AQ.length>2&&AQ[1]==microstrategy.DSSTYPE_CONSOLIDATION&&AK.sty===12032;var AR=this.get("DataFilterMode"),AJ=AR.getItems(),AP=AR.get("valueForm");AR.setItems(AJ.map(function(AS){if(AS[AP]==="-1"){if(AL||AM){AS.cssClass="Disabled";}else{delete AS.cssClass;}}return AS;}));this.get("DataFilterMode").execSelectValue((AL||AM)?"-1":"1");};B.prototype._resolveTotalAndAutoSynchEnabled=function N(){var AM=this.get("DataFilterMode");var AJ=AM&&AM.getSelectedItemValue();var AN=this.get("DataFilterModeEnabled");var AL=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();var AK=mstr.bones.editors.LayoutPropertiesBoneTranslator.prototype.isSearchBox(this);this.set("showTotalEnabled",(AJ=="0"||!AN)&&AL==1&&!AK);this.set("selectorAutoSyncEnabled",AJ=="0"||!AN);if(!((AJ=="0"||!AN)&&AL==1)){this.set("EditSelectorShowTotal",false);}if(AJ!="0"&&AN){this.set("EditSelectorAutoSync",false);}};B.prototype._resolveUpdateFilterTargetEnabled=function c(){var AL=this.get("DataFilterMode");var AJ=AL&&AL.getSelectedItemValue();var AM=this.get("DataFilterModeEnabled");var AK=this.get("EditSelectorType")&&this.get("EditSelectorType").getSelectedItemValue();this.set("updateFilterTargetEnabled",(AJ!="0"&&AM)&&AK==1);};B.prototype.execSelectObject=function AA(AJ){this.set("runReportDocName",AJ[0].n);this.set("runReportDocId",AJ[0].dssid);this.set("runObjectType",AJ[0].tp);};B.prototype.refreshForSearchBox=function A(AJ,AR){AJ.set("showTotalEnabled",!AR);var AO=AJ.get("EditSelectorSource"),AK=AO&&AO.getSelectedItemValue();if(AO){var AP=AJ.getBone().commands.queryState(AR?"documentPureAttributes":"documentAttributes"),AN=AO.getItems()||[];if(AN.length!=AP.length){AO.setItems(AP);var AQ=AO.execSelectValue(AK);if(!AQ){AO.execSingleSelect(0);}}}if(AR){AJ.get("EditSelectorType").set("selectedIndicesList",0);if(!AO){var AM=AJ.getBone().commands.queryState("EditSelectorSource")||"",AL=AM.split("|")[1];if(AL&&AL!=microstrategy.DSSTYPE_ATTRIBUTE){AJ._storeDeltaProp("EditSelectorSource","");}}}};B.prototype.on_set_ext_prop_UseAsInformationWindow=function U(AJ){if(this.get("showTableDisplayMode")){var AK=microstrategy.descriptors;this.set("TableCancelType",AJ.memo.value?AK.getDescriptor("11174"):AK.getDescriptor("11175"));this.set("TableCancelText",AJ.memo.value?AK.getDescriptor("221"):AK.getDescriptor("2827"));}};B.prototype.translateBone=function D(){this.translating=true;var AK=this.props.EditSelectorType,AL=AK&&AK.getItems().concat(),AN=(AL&&mstr.$A.findByForm(AL,3,"dssid",false))||-1,AM=this.getBone().commands.queryState("isInFilterPanel"),AJ=!!AK.iifp;isAQ=microstrategy.getViewerBone()&&microstrategy.getViewerBone().commands.queryState("EditSelectorStyle")=="11";mstr.$A.forEach(AL,function(AP){var AO=AP.dssid;if(AO!=4){if(isAQ){AP.cssText=(AO==7)?"":"display: none;";}else{AP.cssText=(AO==7)?"display: none;":"";}}});if(AM!=AJ){AL[AN].cssText=AM?"display: none;":"";AK.iifp=AM;}AK.setItems(AL);this.translating=false;mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);};function B(AJ){mstr.bones.editors.BoneTranslator.apply(this,[AJ]);}return B;})();mstr.bones.editors.GeneralTabBoneTranslator=(function(){mstr.$O.extendsClass(K,mstr.bones.editors.BoneTranslator);K.prototype.init=function H(){mstr.bones.editors.BoneTranslator.prototype.init.apply(this);this.attachEventListener(this,"set_Visible","_handleVisiblilityChange");};K.prototype._handleVisiblilityChange=function B(P){if(this.translating){return ;}if(!P.memo.value){this.set("VisibleHTML",false);}};K.prototype.on_set_IsPortal=function J(P){if(this.translating){return ;}this.get("parent").notifyPropertyChange("IsPortal",P);this.updatePanelCustomTitle();};K.prototype.on_set_TitleBarDisplay=function D(P){if(this.translating){return ;}this.updatePanelCustomTitle();};K.prototype.updateShowTranslucent=function L(R,Q){var P={};P.UseAsInformationWindow=R;P.InfoWindowMode=Q;this.get("parent").notifyPropertyChange("showTranslucent",P);};K.prototype.updateInitialSlidingInWidthAndHeightEnabled=function C(T){var S=T.usiw!==undefined?T.usiw:this.get("UseAsInformationWindow"),Q=T.dips!==undefined?T.dips:this.get("DisplayInPartialScreen"),R=T.iwm!==undefined?T.iwm:this.get("InfoWindowMode").getSelectedItemValue(),P=T.iwp!==undefined?T.iwp:this.get("InfoWindowPosition").getSelectedItemValue();this.set("InitialSlidingInHeightEnabled",S&&Q&&R==="4"&&(P==="1"||P==="2"));this.set("InitialSlidingInWidthEnabled",S&&Q&&R==="4"&&(P==="3"||P==="4"));};K.prototype.on_set_InfoWindowMode=function O(P){if(this.translating){return ;}this.updateShowTranslucent(this.get("UseAsInformationWindow"),P.memo.value);this.updateInfoWinPosition();this.updateInitialSlidingInWidthAndHeightEnabled({iwm:P.memo.value});};K.prototype.on_set_UseAsInformationWindow=function N(P){if(this.translating){return ;}this.updateShowTranslucent(P.memo.value,this.get("InfoWindowMode").getSelectedItemValue());if(this.get("showTableDisplayMode")){!P.memo.value&&this.set("IsPortal",P.memo.value);this.get("parent").notifyPropertyChange("UseAsInformationWindow",P);}if(P.memo.value){this.set("ShowAsCollapsiblePanel",false);}this.updateInfoWinPosition();this.updateInitialSlidingInWidthAndHeightEnabled({usiw:P.memo.value});};K.prototype.on_set_DisplayInPartialScreen=function A(P){this.updateInitialSlidingInWidthAndHeightEnabled({dips:P.memo.value});};K.prototype.on_set_InfoWindowPosition=function M(P){this.updateInitialSlidingInWidthAndHeightEnabled({iwp:P.memo.value});};K.prototype.updateInfoWinPosition=function F(){var P=this.get("InfoWindowMode").getSelectedItemValue(),Q=this.get("UseAsInformationWindow");this.set("InfoWindowPositionEnabled",Q&&(P==4));};K.prototype.updatePanelCustomTitle=function E(){var P=this.get("TitleBarDisplay").getSelectedItemValue();this.set("panelCustomTitle",P&&P=="1"&&this.get("IsPortal"));};K.prototype.onModelPropertyChange=function I(P){mstr.bones.editors.BoneTranslator.prototype.onModelPropertyChange.apply(this,[P]);if(P.src==this.get("titleTriState")){if(this.translating){return ;}var Q=(this.get("titleTriState").getSelectedItemValue()=="1");this.set("ShowWidgetTitleBar",Q);this.set("IsPortal",Q);}};K.prototype.translateBone=function G(){mstr.bones.editors.BoneTranslator.prototype.translateBone.apply(this);this.translating=true;var P=!this.get("IsPortal")?"0":(this.get("ShowWidgetTitleBar")?"1":"-1");this.get("titleTriState").execSelectValue(P);this.translating=false;};function K(P){mstr.bones.editors.BoneTranslator.apply(this,[P]);}return K;})();mstr.bones.editors.ActionsBoneTranslator=(function(){mstr.$O.extendsClass(E,mstr.bones.editors.BoneTranslator);E.prototype.getDynamicListModel=function B(I,H){var G=mstr.bones.editors.BoneTranslator.prototype.getDynamicListModel.apply(this,arguments);if(H=="ControlGroupByList"){G.detachEventListener(this,"hashadd_selectedIndices");G.detachEventListener(this,"hashremove_selectedIndices");G.attachEventListener(this,"listadd_items","onControlGroupByChange");}return G;};E.prototype.onControlGroupByChange=function F(H){var K=H.src;var J="";var G=null;var I=[];J=K.getItems();var L=K.get("mappedPropertyName");this.raiseEvent("set_"+L,{name:L,src:H.name,value:J,valueWas:G});if(this.translating){return ;}this._storeDeltaProp(L,J);};E.prototype.on_set_ext_prop_XTabView=function D(G){var H=G.memo.value;var I=this.translating;this.translating=true;this.set("showGridIf",H==1||H==3);this.translating=I;};E.prototype.on_set_expandPanels=function A(H){var G=H.memo.value;var I=this.translating;this.translating=true;this.set("allowPanelsToSplitAcrossPages",G==0);this.set("panelOverflowSpacingEnabled",this.get("ClipOnExport")&&G!=0);this.translating=I;};E.prototype.on_set_ClipOnExport=function F(H){var J=this.translating;if(J){return ;}this.translating=true;var I=H.memo.value;var G=this.get("expandPanels");this.set("panelOverflowSpacingEnabled",I&&G.getSelectedIndex()!=0);this.translating=J;};E.prototype.joinTypeChange=function C(G,I){var H=this._getDeltaProp("joinTypes");if(!H){H={};}H[G]=I;this._storeDeltaProp("joinTypes",H);};function E(G){mstr.bones.editors.BoneTranslator.apply(this,[G]);}return E;})();mstr.models.TriStateListModel=(function(){mstr.$O.extendsClass(A,mstr.models.ListModel);A.prototype.execSingleSelectNextAndLoop=function B(){mstr.models.ListModel.prototype.execSingleSelectNextAndLoop.apply(this);var D=this.props.selectedIndicesList;if(isNaN(D)){return false;}var C=parseInt(D);var E=this.get("ExcludedItemsOnLoop");E=E&&E.split(",");if(E&&C in E){this.execSingleSelectNextAndLoop();}return true;};function A(C){mstr.models.ListModel.apply(this,[C]);}return A;})();mstr.models.IPhoneTimeSeriesEditorModel=(function(){mstr.$O.extendsClass(N,mstr.models.BaseModel);N.prototype.init=function J(){mstr.models.BaseModel.prototype.init.apply(this);this.set("granularity","");if(this.props.isReport){this.selectItemFromId(this.props.dataSets,"r");}this.aeh();this.changeSelectedNode();this.ROOT_NODE="rl";this.ITEM_NODE="it";this.TEMPLATE_NODE="nk";this.NAME_NODE="lbl";this.LEVEL_NODE="lvl";this.RANGE_NODE="rng";this.RANGE_ATT_NODE="ut";this.RANGE_SIZE_NODE="v";};N.prototype.aeh=function L(){this.props.nodes.attachEventListener(this,"hashadd_selectedIndices","changeSelectedNode");this.props.rangeList.attachEventListener(this,"hashadd_selectedIndices","changeRangeList");this.props.dataSets.attachEventListener(this,"hashadd_selectedIndices","changeDataSet");};N.prototype.changeSelectedNode=function C(S){var X=this.props.nodes,U=X.getSelectedItem();if(U){if(U.dssid=="-1"){if(!this.props.justRemoved){this.execAdd();}return ;}this.set("empty",false);this.set("downEnabled",!S.memo.at[mstr.$A.len(X.props.items)-2]);this.set("upEnabled",!X.props.selectedIndices[0]);var W=this.changingN;this.changingN=true;var T=mstr.$obj("selectedNameIphoneEditorField");if(T){T.textBoxInitialized=false;}this.set("selectedName",U.n);this.set("selectedRangeSize",U.rs);var V=this.selectItemFromId(this.props.dataSets,U.ds);this.selectItemFromId(this.props.rangeList,U.sr);if(!V){this.set("attEnabled",false);}this.changingN=W;}else{this.set("empty",true);}this.updatePreview();};N.prototype.updatePreview=function K(){var W=microstrategy.descriptors.getDescriptor("7678"),U=this.props.nodes.getSelectedItem(),V=this.props.dataSets.getSelectedItem(),S=this.props.rangeList.getSelectedItem(),T=this.props.granularity;v=V&&T&&S&&U;W=W.replace("######",V?V.n:"").replace("#####",T?T:"").replace("####",S?S.n:"").replace("###",U?U.rs:"").replace("##",U?U.n:"");this.props.preview.set("value",v?W:"");};N.prototype.selectItemFromId=function E(U,V){var S=U.getItems();for(var T in S){if(S[T][U.props.valueForm]==V){U.setSelectedItems([S[T]]);return true;}}U.execClearSelect();return false;};N.prototype.on_set_selectedRangeSize=function F(){this.props.nodes.getSelectedItem().rs=this.props.selectedRangeSize;this.updatePreview();};N.prototype.on_set_selectedName=function G(){if(this.changingN){return ;}var S=this.changingN;this.changingN=true;this.props.justRemoved=true;this.props.nodes.execRenameSelectedItem(this.props.selectedName);this.props.justRemoved=false;this.changingN=S;this.updatePreview();};N.prototype.changeRangeList=function B(){this.props.nodes.getSelectedItem().sr=this.props.rangeList.getSelectedItem()[this.props.rangeList.props.valueForm];this.updatePreview();};N.prototype.changeDataSet=function O(){this.set("attEnabled",true);this.props.rangeList.execClearSelect();this.props.rangeList.removeItems(this.props.rangeList.getItems());var T=this.props.dataSets.getSelectedItem();var U=this.props.__atts[T.dssid];this.set("granularity",U[U.length-1].n);this.props.rangeList.insertItemsAt(U);var S=this.props.nodes.getSelectedItem();S.ds=this.props.dataSets.getSelectedItem()[this.props.dataSets.props.valueForm];S.sl=U[U.length-1].dssid;if(!this.changingN){S.sr=null;}this.updatePreview();};N.prototype.execAdd=function Q(){this.set("empty",false);this.set("downEnabled",false);this.set("attEnabled",false);this.set("upEnabled",false);var T={dssid:Math.random(),n:microstrategy.descriptors.getDescriptor(945),sl:null,sr:null,rs:"1",ds:null},U=this.props.nodes,S=U.props.items.length;U.insertItemsAt([T],S-1);U.execSingleSelect(S-1);this.props.rangeList.execClearSelect();this.set("granularity","");if(this.props.isReport){this.selectItemFromId(this.props.dataSets,"r");}else{this.props.dataSets.execClearSelect();}};N.prototype.execRemove=function R(){this.props.justRemoved=true;};N.prototype.execPostRemove=function H(){var T=this.props.nodes,S=mstr.$A.len(T.props.items);this.props.justRemoved=false;this.set("empty",S==1);this.set("attEnabled",S>1);if(S==1){T.execClearSelect();}else{if(parseInt(T.props.selectedIndicesList)==(S-1)){T.execSingleSelect(S-2);}}};N.prototype.execCheckDown=function A(){var T=this.props.nodes,S=mstr.$A.len(T.props.items);this.set("downEnabled",!T.props.selectedIndices[S-2]);this.set("upEnabled",!T.props.selectedIndices[0]);};N.prototype.getXMLValue=function P(){var S=this.props.nodes.getItems();var U="<"+this.ROOT_NODE+">";for(var T in S){if(T==S.length-1){continue;}U+=this.appendItemXML(S[T]);}U+="</"+this.ROOT_NODE+">";return U;};N.prototype.appendItemXML=function M(T){var S="<"+this.ITEM_NODE+"><"+this.TEMPLATE_NODE+">"+T.ds+"</"+this.TEMPLATE_NODE+"><"+this.NAME_NODE+">"+T.n+"</"+this.NAME_NODE+"><"+this.LEVEL_NODE+">"+T.sl+"</"+this.LEVEL_NODE+"><"+this.RANGE_NODE+"><"+this.RANGE_SIZE_NODE+">"+T.rs+"</"+this.RANGE_SIZE_NODE+"><"+this.RANGE_ATT_NODE+">"+T.sr+"</"+this.RANGE_ATT_NODE+"></"+this.RANGE_NODE+"></"+this.ITEM_NODE+">";return S;};N.prototype.validate=function I(){var T=this.props.nodes.getItems(),U,V="";for(var S in T){if(S==T.length-1){continue;}U=T[S];if(!U.n||!U.sl||!U.sr||!U.ds||!/^\d+$/.test(U.rs)){V+=" "+U.n+",";}}if(V){V=V.substring(0,V.length-1);return microstrategy.descriptors.getDescriptor(7565)+" "+V;}return true;};N.prototype.checkValidationStatus=function D(){var V=this.props.nodes.props.items,U=microstrategy.bone("visPropsEditor_VisualizationPropertiesEditorStyle").elem,S=microstrategy.findChildWithAtt(U,"input","id","ok");for(var T in V){if(V[T].invalidRS){S.disabled=true;return ;}}S.disabled=false;};function N(S){mstr.models.BaseModel.apply(this,[S]);}return N;})();mstr.models.IphoneTSFieldValidator=(function(){mstr.$O.extendsClass(C,mstr.models.FieldValidator);C.prototype.validate=function A(D){this.props.theValue=D;var E=mstr.models.FieldValidator.prototype.validate.apply(this,[D]);};C.prototype.setValidationStatus=function B(H){var G=mstr.models.FieldValidator.prototype.setValidationStatus.apply(this,[H]);var D=this.props.parent;D=D&&D.props.model;var F=D&&D.props.nodes,E=this.props.theValue;F=F&&F.getSelectedItem();if(F){F.rs=E;F.invalidRS=!G;D.set("selectedRangeSize",E);D.checkValidationStatus();}return G;};function C(D){mstr.models.FieldValidator.apply(this,[D]);}return C;})();mstr.behaviors.ToolbarContextMenuOpener=(function(){var B={};B.openMenu=function C(E){var G=E.props.element,D=getObjSumLeft(G),H=getObjSumTop(G)+getObjHeight(G),F=E.getModel();microstrategy.openBlockLoaderEditor("addWidgetToolbarMenu","InsertMenuBlockLoader",null,{cssText:"position:absolute;top:"+H+"px;left:"+D+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",useFixedPosition:"false",contextMenuName:F.get("contextMenuName"),viewer:"#"+F.props.id},E,null,document.body);};B.changeIcon=function A(D,E,G){var F=E.props.cmdid.split(";");F=F.length>1?F[1]:F.join();G.className=D.props.cssBaseIcon+F;};return B;})();mstr.models.ToolbarContextMenuOpenerModel=(function(){mstr.$O.extendsClass(A,mstr.models.BaseModel);A.prototype.init=function B(){mstr.models.BaseModel.prototype.init.apply(this);this.commands.p=this;this.commands.h=this.props.toolbarHelper;};A.prototype.commands={queryEnabled:function(){return true;},queryVisible:function(){return true;},queryState:function(){return true;},exec:function(C){this.p.set("cmdid",C);this.h.execPressed();}};function A(C){mstr.models.BaseModel.apply(this,[C]);}return A;})();mstr.itemrenderers.IPhoneTimeSeriesItemRenderer=(function(){LV=mstr.$H.clone(mstr.itemrenderers.ListView);LV.renderListItem=function(A,C,F,D){var B=mstr.itemrenderers.FastListView.renderListItem(A,C,F,D);this._insertElementForIndex(A,F,D.at,B);if(D&&D.item&&D.item.dssid==-1){var E=B.style;E.fontStyle="italic";E.textDecoration="underline";E.cursor="pointer";B.className="";B.title="";}return B;};return LV;})();mstr.utils.Trees=(function(){var D={};D.insertChildNodes=function K(S,R,P,T){if(!S){return false;}var O=mstr.$A.len(R);if(!O){return false;}S.children=mstr.$A.insert(S.children||[],R,P);for(var Q=0;Q<O;Q++){R[Q].parent=S;R[Q].treeId=T;}return true;};D.removeChildNode=function E(O,Q){var P=this.findChildIndex(O,Q);if(P>-1){return this.removeChildNodeAt(O,P);}return false;};D.removeChildNodeAt=function C(O,Q){var P=O&&O.children&&O.children[Q];if(P){O.children.splice(Q,1);P.parent=null;P.treeId=null;}return P;};D.removeAllChildNodes=function I(Q){if(!Q){return ;}var S=Q.children,R;for(var P=0,O=mstr.$A.len(S);P<O;P++){R=S[P];if(!R){continue;}R.parent=null;R.treeId=null;}Q.children=[];return S;};D.removeNodeAtPath=function N(P,S){if(!P||(S==null)){return null;}var R=P._pathParts(paths[i]);if(R.length>1){var T=R.pop();var O=P.getNodeAt(R.join(mstr.models.AbstractTreeBase.PATHDELIM));return this.removeChildNodeAt(O,T);}else{var Q=P.getRootNode();P.setRootNode(null);return Q;}};D.previousSibling=function M(P){if(P){var O=this.findChildIndex(P.parent,P);if(O>0){return P.parent.children[O-1];}}return null;};D.nextSibling=function H(P){if(P){var O=this.findChildIndex(P.parent,P);if(O>-1){return P.parent.children[O+1];}}return null;};D.findChildIndex=function A(O,P){if(O&&P&&(P.parent==O)&&O.children){return mstr.$A.find(O.children,P);}return -1;};D.find=function B(T,R){if(!T){return null;}if(T.value==R){return T;}else{if(T.children){var S=T.children;var O=S.length||0;for(var Q=0;Q<O;Q++){var P=this.find(S[Q],R);if(P){return P;}}}}return null;};D.findByForm=function G(U,S,R){if(!U){return null;}if(U.value&&U.value[R]==S){return U;}else{if(U.children){var T=U.children;var O=T.length||0;for(var Q=0;Q<O;Q++){var P=this.findByForm(T[Q],S,R);if(P){return P;}}}}return null;};D.findByNodeForm=function L(U,S,R){if(!U){return null;}if(U[R]==S){return U;}else{if(U.children){var T=U.children;var O=T.length||0;for(var Q=0;Q<O;Q++){var P=this.findByNodeForm(T[Q],S,R);if(P){return P;}}}}return null;};D.matchByForm=function F(P,R,T,V){var O=mstr.utils.Arrays.len(P),V=(V&&(V>-1))?V:0,Q,U;for(var S=V;S<O;S++){U=P[S];if(R.test(String(U&&U.value&&U.value[T]))){return S;}}if(V>0){for(var S=0;S<V;S++){U=P[S];if(R.test(String(U&&U.value&&U.value[T]))){return S;}}}return -1;};D.cloneSubTree=function J(U,P){if(!U){return null;}var T={value:P?U.value:mstr.$H.clone(U.value)};var S=U.children;var O=mstr.$A.len(S);if(O){T.children=new Array(O);var R;for(var Q=0;Q<O;Q++){R=this.cloneSubTree(S[Q],P);R&&(R.parent=T);T.children[Q]=R;}}return T;};return D;})();mstr.models.AbstractCartBase=(function(){mstr.$O.extendsClass(J,mstr.models.BaseModel);J.prototype.canAdd=function H(K){var L=this.props.allowedItemFormName;if(L!=null){if(this.props.allowedItemFormValues){if(!this.props.allowedItemFormValuesHash){this.props.allowedItemFormValuesHash=mstr.$A.toHash(this.props.allowedItemFormValues&&this.props.allowedItemFormValues.split(","));}return !!this.props.allowedItemFormValuesHash[K[L]];}else{if(this.props.prohibitedItemFormValues){if(!this.props.prohibitedItemFormValuesHash){this.props.prohibitedItemFormValuesHash=mstr.$A.toHash(this.props.prohibitedItemFormValues&&this.props.prohibitedItemFormValues.split(","));}return !this.props.prohibitedItemFormValuesHash[K[L]];}}}return true;};J.prototype._hasMetAddMax=function D(){var K=Math.max(0,parseInt(this.props.max)||0);if(K){var M=this.props.selected;var L=M&&M.getItems();return(mstr.$A.len(L)>=K);}return false;};J.prototype._findAddableItem=function F(L){if(L){for(var M=0,K=L.length;M<K;M++){if(mstr.utils.ListModelHelper.canAdd(this,L[M])){return L[M];}}}return null;};J.prototype._addItemsToSelectedModel=function I(M){var N=this.props.selected;if(!N){return ;}var L=N.getSelectedIndices();var K=mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(L,true))[0];N.insertItemsAt(M,(K!=null)?K:-1);};J.prototype._getAvailableOriginInfo=function A(){var O=this.get("available"),N=O&&O.getContainer(),M=N&&N.value&&N.value.dssid,K=(O&&O.get("blockBegin"))||1,L=(O&&O.get("searchPattern"))||"";return{containerId:M,searchPattern:L,blockBegin:K};};J.prototype._markItemsWithOrigin=function B(U){var R=U&&U.length;if(!R){return null;}var S=this._getAvailableOriginInfo(),T=S.containerId,Q=S.blockBegin,M=S.searchPattern;var K=this.props.available,L=K&&K.getItems(),O=L&&mstr.$A.findByFormMultiple(L,U,"dssid",true),P=O&&O.indices||[];for(var N=0;N<R;N++){var V=U[N];if(P[N]>-1){V.origin={containerId:T,searchPattern:M,blockOrdinal:Q+P[N]};}else{if(!V.origin){U.origin={containerId:null,searchPattern:"",blockOrdinal:null};}}}return O;};J.prototype._computeAllowedAddCount=function E(){var M=this.props.selected;if(!M){return 0;}if(!this.props.allowAddAlways){var K=Math.max(0,parseInt(this.props.max)||0);if(K){var L=M.getItems();K-=mstr.$A.len(L);return Math.max(0,K);}}return -1;};J.prototype.updateCommandEnabledRemove=function G(){var M=this.props.selected;var K=M&&M.getSelectedItems();var L=!!mstr.$A.len(K);this.set("CommandEnabledRemove",L);};J.prototype.updateCommandEnabledRemoveAll=function C(){var L=this.props.selected;var K=L&&L.getItems();var M=!!mstr.$A.len(K);this.set("CommandEnabledRemoveAll",M);};function J(K){mstr.models.BaseModel.apply(this,[K]);}return J;})();mstr.models.ListCart=(function(){mstr.$O.extendsClass(J,mstr.models.AbstractCartBase);J.prototype.init=function T(){mstr.models.AbstractCartBase.prototype.init.apply(this);this._initAvailableFilteredList();this._updateAvailableFilteredItems();this.updateCommandEnabledAdd();this.updateCommandEnabledAddAll();this.updateCommandEnabledRemove();this.updateCommandEnabledRemoveAll();var W=this.props.available;if(W){W.attachEventListener(this,"set_readyState","_updateAvailableFilteredItems");}var V=this.props.availableFiltered;if(V){V.attachEventListener(this,"listadd_items","onAddRmvItemsFromAvailFilt");V.attachEventListener(this,"listremove_items","onAddRmvItemsFromAvailFilt");V.attachEventListener(this,"hashadd_selectedIndices","updateCommandEnabledAdd");V.attachEventListener(this,"hashremove_selectedIndices","updateCommandEnabledAdd");}var U=this.props.selected;if(U){U.attachEventListener(this,"listadd_items","onAddItemsToSelectedModel");U.attachEventListener(this,"listremove_items","onRemoveItemsFromSelectedModel");U.attachEventListener(this,"hashadd_selectedIndices","updateCommandEnabledRemove");U.attachEventListener(this,"hashremove_selectedIndices","updateCommandEnabledRemove");}};J.prototype.onAddRmvItemsFromAvailFilt=function P(){this.updateCommandEnabledAdd();this.updateCommandEnabledAddAll();};J.prototype.onAddItemsToSelectedModel=function L(){this.updateCommandEnabledRemoveAll();var U=Math.max(0,parseInt(this.props.max)||0);if(U){this.updateCommandEnabledAdd();this.updateCommandEnabledAddAll();}};J.prototype.onRemoveItemsFromSelectedModel=function M(){this.updateCommandEnabledRemoveAll();this.updateCommandEnabledRemove();var U=Math.max(0,parseInt(this.props.max)||0);if(U){this.updateCommandEnabledAdd();this.updateCommandEnabledAddAll();}};J.prototype._initAvailableFilteredList=function G(){var V=this.props.available&&this.props.available.props;V=mstr.$H.clone(V);V.items=[];V.id=mstr.controllers.Factory.nextFreeId();V.parent=this;var U=new mstr.models.ListModel(V);if(!U){return ;}this.props.availableFiltered=U;mstr.controllers.Factory.add(U);U.init&&U.init();};J.prototype._updateAvailableFilteredItems=function O(){var U=this.props.available;if(!U){return ;}if(this.props.keepAvailableSorted!==false){var V=U.getItems(),g=V&&V.length||0;if(g){var h=this._getAvailableOriginInfo(),n=h.containerId,e=h.blockBegin,W=h.searchPattern;for(var Z=0;Z<g;Z++){V[Z].origin={containerId:n,searchPattern:W,blockOrdinal:e+Z};}}}var m=this.props.availableFiltered;if(!m){return ;}m.set("searchPattern",this._getAvailableOriginInfo().searchPattern||"");var X=U.get("readyState");m.props.requestContext=U.props.requestContext;m.set("readyState",X);this.updateCommandEnabledAdd();this.updateCommandEnabledAddAll();if(X!=mstr.Enum.Widget.READYSTATE.IDLE){return ;}var Y=[].concat(U.getItems());if(!this.props.keepAvailableItems){if(this.props.selected){var o=this.props.selected.getItems();var c=m.get("valueForm");if(c){if(this.props.keepAvailableSorted===false){Y=mstr.$A.removeItemsByForm(Y,o,c);}else{var a=this._markItemsWithOrigin(o);if(a){Y=mstr.$A.remove(Y,a.indices);}}}else{Y=mstr.$A.removeItems(Y,o);}}}m.setItems(Y);if(Y&&Y.length){m.execCommand("SingleSelect",0);}};J.prototype.execAdd=function Q(){var V=this._computeAllowedAddCount();if(!V){return ;}var Y=this.props.availableFiltered;if(!Y){return ;}var U=Y.getSelectedIndices();var a=mstr.$H.len(U);if(!a){return ;}var X=this._findAddableItemsInIndices(mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(U,true)),V);if(X.count){this._addItemsToSelectedModel(X.itemsToAdd);if(!this.props.keepAvailableItems){Y.removeItemsAt(X.indicesToAdd);}else{var W=Y.indexOfMultiple(X.itemsToAdd);if(W&&W.foundCount){var Z=W.indices[W.foundCount-1];Y.execCommand("SingleSelect",Z+1);}}}};J.prototype.execAddAll=function S(){var Y=new Date();var U=this._computeAllowedAddCount();if(!U){return ;}var Z=this.props.availableFiltered;if(!Z){return ;}var X=Z.getItems();var c=mstr.$A.len(X);if(!c){return ;}var a=new Array(c);for(var W=0;W<c;W++){a[W]=W;}var V=this._findAddableItemsInIndices(a,U);if(V.count){this._addItemsToSelectedModel(V.itemsToAdd);if(!this.props.keepAvailableItems){Z.removeItemsAt(V.indicesToAdd,true);}}};J.prototype.execRemove=function A(){var W=this.props.selected;if(!W){return ;}var V=W.getSelectedIndices();var Y=mstr.$H.len(V);if(!Y){return ;}var a=mstr.$A.sortNumericArray(mstr.$A.fromHashKeys(V,true));var U=W.getItems();var Z=new Array(Y);for(var X=0;X<Y;X++){Z[X]=U[a[X]];}W.removeItemsAt(a,true);if(!this.props.keepAvailableItems){this._addItemsToAvailableFilteredModel(Z);}};J.prototype.execRemoveAll=function I(){var V=this.props.selected;if(!V){return ;}var U=V.getItems();var W=mstr.$A.len(U);if(!W){return ;}if(!this.props.keepAvailableItems){this._addItemsToAvailableFilteredModel(U.slice(0,W));}V.removeItemsAtRanges([{min:0,max:W-1}],true);};J.prototype.updateCommandEnabledAdd=function K(){var V=true;if(!this.props.allowAddAlways&&this._hasMetAddMax()){V=false;}else{var U=this.props.availableFiltered;if(!U||!this._findAddableItem(U.getSelectedItems())||U.get("readyState")==mstr.Enum.Widget.READYSTATE.ERROR){V=false;}}this.set("CommandEnabledAdd",V);};J.prototype.updateCommandEnabledAddAll=function C(){var U=true;if(!this.props.allowAddAlways&&this._hasMetAddMax()){U=false;}else{var V=this.props.availableFiltered;if(!V||!this._findAddableItem(V.getItems())||V.get("readyState")==mstr.Enum.Widget.READYSTATE.ERROR){U=false;}}this.set("CommandEnabledAddAll",U);};J.prototype._addItemsToAvailableFilteredModel=function D(Y){var a=this.props.availableFiltered;if(!a){return ;}if(this.props.keepAvailableSorted===false){this._insertItemsIntoAvailableFiltered(Y,-1);}else{var V=this._groupByOrigin(Y),c=null;for(var W in V){var h=V[W],e=h&&h.sort(J.ordinalSorter),X=e&&this._contiguousOrdinals(e);for(var g in X){var Z=X[g],U=this._computeInsertionIndexForAvailableFiltered(Z);if(c==null){c=U>-1?U:(a.props.items||[]).length;a.execCommand("ClearSelect");}this._insertItemsIntoAvailableFiltered(Z,U);this.execCommand("Select",mstr.utils.Hash.fromRanges([{min:U,max:U+Z.length-1}]));}}a.set("leadIndex",c);}};J.prototype._contiguousOrdinals=function F(Y){var V={},c=null,Z=null;for(var W=0,X=Y&&Y.length||0;W<X;W++){var e=Y[W],a=e&&e.origin,U=a&&a.blockOrdinal;if(c!=null&&(Z==U-1)){V[c].push(e);}else{c=U;if(V[c]){V[c].push(e);}else{V[c]=[e];}}Z=U;}return V;};J.prototype._groupByOrigin=function B(a){var U={};for(var W=0,Y=a&&a.length||0;W<Y;W++){var e=a[W],c=e&&e.origin,Z=c&&c.containerId||"null",g=c&&c.searchPattern||"",V=Z+"-"+g,X=U[V];if(!X){X=U[V]=[];}X.push(e);}return U;};J.ordinalSorter=function N(V,U){var X=V&&V.origin,Z=X&&X.blockOrdinal,W=U&&U.origin,Y=W&&W.blockOrdinal;if(Z!=null&&Y!=null){return Z-Y;}else{if(Z!=null){return -1;}else{if(Y!=null){return 1;}else{return 0;}}}};J.prototype._computeInsertionIndexForAvailableFiltered=function H(m){var V=m&&m[0],q=V&&V.origin,e=q&&q.containerId,u=q&&q.searchPattern,h=q&&q.blockOrdinal;if(!V){return -1;}var g=this.props.availableFiltered,Y=g&&g.getItems(),c=this._getAvailableOriginInfo(),U=c.containerId,n=c.searchPattern;var X=-1;if(U&&U==e&&n==u){for(var Z=0,a=Y&&Y.length||0;Z<a;Z++){var W=Y[Z];if(W.origin&&W.origin.containerId==e&&W.origin.searchPattern==u){if(W.origin.blockOrdinal>h){X=Z;break;}}else{X=Z;break;}}}return X;};J.prototype._insertItemsIntoAvailableFiltered=function E(U,V){var X=this.props.availableFiltered;if(!X){return ;}X.insertItemsAt(U,V);var Y={},Z=(V>-1)?V:mstr.$A.len(X.getItems()),W=mstr.$A.len(U);for(i=0;i<W;i++){Y[Z+i]=true;}X.execCommand("Select",Y);X.set("leadIndex",Z);};J.prototype._findAddableItemsInIndices=function R(g,W){var o={indicesToAdd:[],itemsToAdd:[],count:0};var a=this.props.availableFiltered;var c=a&&a.getItems();if(!c){return o;}var U=this.props.selected;if(!U){return o;}var h=U.get("valueForm");var V=null;for(var X=0,Z=mstr.$A.len(g);X<Z;X++){var Y=g[X];var m=c[Y];if(mstr.utils.ListModelHelper.canAdd(this,m)){var e=false;if(h){if(!V){V=mstr.utils.Hash.generateItemArrayLookup(U.getItems(),h);}var n=m[h];e=(V[n]!=null);}else{e=(U.indexOfItem(m)>-1);}if(!e){o.indicesToAdd[o.count]=Y;o.itemsToAdd[o.count]=m;o.count++;if(o.count==W){break;}}}}return o;};function J(U){mstr.models.AbstractCartBase.apply(this,[U]);}return J;})();mstr.models.AbstractTreeBase=(function(){mstr.$O.extendsClass(P,mstr.models.BaseModel);P.NEXT_NODE_ID=0;P.PATHDELIM="/";P.prototype.getNodeAt=function I(AC){var AB=this._pathParts(AC);switch(AB.length){case 0:return null;case 1:return this.props.rootNode;default:var AA=this.props.rootNode;var y=AB.length;for(var z=1;z<y;z++){AA=AA.children&&AA.children[AB[z]];if(!AA){break;}}return AA;}};P.prototype.getNodePath=function n(y,AA){var z=this.getNodePathIndices(y,AA);if(z&&z.join){return z.join(P.PATHDELIM);}};P.prototype.getNodePathIndices=function x(z,AB){if(!z){return null;}if(!AB){AB=this.props.rootNode;}var AA=[];while(z){var y=z.parent?mstr.utils.Trees.findChildIndex(z.parent,z):0;if(y>-1){AA.push(y);z=z.parent;}else{break;}}return AA.reverse();};P.prototype._silentInsertNodesAt=function J(AA,AD){var z=mstr.$A.len(AA);if(!z||AD==null){return false;}var AC=this._pathParts(AD);if(AC.length>1){var AE=AC.pop();var y=this.getNodeAt(AC.join(P.PATHDELIM));if(!mstr.utils.Trees.insertChildNodes(y,AA,AE,this.getId())){return false;}}else{z=1;AA=[AA[0]];this.props.rootNode=AA[0];AA[0].parent=null;}for(var AB=0;AB<z;AB++){this._validateNodeId(AA[AB]);}return true;};P.prototype._silentRemoveNode=function m(y){if(!y){return false;}if(y.parent){return mstr.utils.Trees.removeChildNode(y.parent,y);}else{if(y==this.props.rootNode){this.props.rootNode=null;y.treeId=null;return true;}}return false;};P.prototype.getSelectedNodes=function e(){return this.props.selections;};P.prototype.getSelectedNode=function F(){return mstr.$H.firstItem(this.props.selections);};P.prototype._isSingleFilterNode=function c(z){var y=z&&z.value;if(y&&(y.stp==256||y.tp==1)){var AA=z.parent&&z.parent.value;if(AA&&AA.filters&&AA.filters.length==1){return true;}}return false;};P.prototype.getViewableSelectedItems=function L(){var z=[];var y=this.props.selections;for(var AB in y){var AA=y[AB];if(AA&&AA.value){if(this._isSingleFilterNode(AA)){z.push(AA.parent.value);}else{z.push(AA.value);}}}return z;};P.prototype.getSelectedItems=function R(){var z=[];var y=this.props.selections;for(var AB in y){var AA=y[AB];if(AA&&AA.value){z.push(AA.value);}}return z;};P.prototype.getSelectedItem=function C(){var y=this.props.selections,z;for(var AA in y){z=y[AA];if(z&&z.value){return z.value;}}return null;};P.prototype.getSelectedPaths=function W(AA){var y=this.props.selections;var AC,AB=0,z=[];for(var AD in y){AC=y[AD];if(AC){z[AB]=this.getNodePath(AC);AB++;}}if(AB>1&&AA){z=this._sortPaths(z);}return z;};P.prototype.setSelectedPaths=function E(AB){var y=mstr.$A.len(AB);var z=new Array(y);for(var AA=0;AA<y;AA++){z[AA]=this.getNodeAt(AB[AA]);}return this.execSelect(z);};P.prototype._selectNodes=function G(z){var y=mstr.$A.len(z);if(y){var AC={};for(var AA=0;AA<y;AA++){var AB=z[AA];if(!AB){continue;}this._validateNodeId(AB);AC[AB.id]=AB;}return this.hashadd("selections",AC);}return false;};P.prototype._unselectNodes=function Y(z){var y=mstr.$A.len(z);if(y){var AC={};for(var AA=0;AA<y;AA++){var AB=z[AA];if(!AB||!AB.id){continue;}AC[AB.id]=true;}return this.hashremove("selections",AC);}return false;};P.prototype._isNodeSelected=function g(y){if(y&&y.id){var z=this.props.selections;return !!(z&&z[y.id]);}return false;};P.prototype._hasMultiSelections=function S(){return !!mstr.utils.Hash.lenGreaterThan(this.props.selections,1);};P.prototype.execClearSelect=function u(){var y=mstr.$H.clone(this.props.selections);this.hashremove("selections",y);this.props.anchorNode=null;};P.prototype.execSelect=function Q(y){this.execClearSelect();this.props.anchorNode=y&&y[0];return this._selectNodes(y);};P.prototype.execSingleSelect=function N(y){if(this._isNodeSelected(y)&&!this._hasMultiSelections()){return false;}return this.execSelect([y]);};P.prototype.execEditNode=function A(y){this.set("editNode",y);return !!y;};P.prototype.find=function D(z,y){return mstr.utils.Trees.find(z,y);};P.prototype.findByNodeId=function a(y){return mstr.utils.Trees.findByNodeForm(this.props.rootNode,y,"id");};P.prototype.findByForm=function Z(AA,z,y){return mstr.utils.Trees.findByForm(AA,z,y);};P.prototype.pathOfItem=function U(AA){var y=this.props.valueForm;if(y!=null){return this.pathOfValue(AA&&AA[y]);}else{var z=this.find(this.props.rootNode,AA);return z?this.getNodePath(z):null;}};P.prototype.pathOfValue=function T(AA){var y=this.props.valueForm;if(y!=null){var z=this.findByForm(this.props.rootNode,AA,y);return z?this.getNodePath(z):null;}return null;};P.prototype._pathParts=function O(AB){var AA=[];if(AB){AA=AB&&AB.split(P.PATHDELIM);for(var z=0,y=AA.length;z<y;z++){AA[z]=parseInt(AA[z]);}}return AA;};P.prototype._validateNodeId=function B(AA){if(AA){if(!AA.id){AA.id=this.props.id+"_"+P.NEXT_NODE_ID++;}AA.treeId=this.props.id;if(AA.children){var AB=AA.children;for(var z=0,y=mstr.$A.len(AB);z<y;z++){this._validateNodeId(AB[z]);}}}};P.prototype._unflattenNodes=function o(z){var y=mstr.$A.len(z);if(!y){return ;}for(var AA=0;AA<y;AA++){this._silentInsertNodesAt([{value:z[AA].value}],z[AA].path);}};P.prototype._sortPaths=function V(AC){var y=mstr.$A.len(AC);if(!y){return[];}var AB=new Array(y);for(var AA=0;AA<y;AA++){AB[AA]={originalIndex:AA,pathIndices:this._pathParts(AC[AA])};}AB=AB.sort(P._pathListSorter);var z=new Array(y);for(var AA=0;AA<y;AA++){z[AA]=AC[AB[AA].originalIndex];}return z;};P._pathListSorter=function M(z,y){return mstr.models.AbstractTreeBase._comparePathIndices(z&&z.pathIndices,y&&y.pathIndices);};P._comparePathIndices=function h(AB,AA){var y=Math.max(AB&&AB.length,AA&&AA.length);if(y&&AB&&AA){for(var z=0;z<y;z++){if((AB[z]==null)&&(AA[z]!=null)){return -1;}else{if((AB[z]!=null)&&(AA[z]==null)){return 1;}else{if(AB[z]<AA[z]){return -1;}else{if(AB[z]>AA[z]){return 1;}}}}}}return 0;};P.prototype.clone=function q(){var z=mstr.$H.clone(this.props);z.id=mstr.controllers.Factory.nextFreeId();if(z.rootNode){z.rootNode=mstr.utils.Trees.cloneSubTree(z.rootNode);}z.selections={};var y=mstr.controllers.Factory.create(z);if(!y){return null;}mstr.controllers.Factory.add(y);y.init&&y.init();y.setSelectedPaths(this.getSelectedPaths());return y;};P.prototype.init=function K(){mstr.models.BaseModel.prototype.init.apply(this);this._initRoot();this._initSelectedPathList(this.props.selectedPathList);};P.prototype._initRoot=function H(){var y=this.props.rootNode;if(y){this._validateNodeId(y);}else{if(this.props.flattenedNodes){this._unflattenNodes(this.props.flattenedNodes);}}};P.prototype._initSelectedPathList=function X(AD){if(!AD){return ;}var AC=AD.split(",");var y=AC.length;var z=[];var AB;for(var AA=0;AA<y;AA++){AB=this.getNodeAt(AC[AA]);if(AB){z.push(AB);}}this.execSelect(z);};function P(y){mstr.models.BaseModel.apply(this,[y]);if(!this.props.selections){this.props.selections={};}}return P;})();mstr.models.TreeModel=(function(){mstr.$O.extendsClass(o,mstr.models.AbstractTreeBase);o.prototype.getRootNode=function U(){return this.props.rootNode;};o.prototype.setRootNode=function n(AE){var AF=this.props.rootNode;if(AF==AE){return true;}if(AF){if(!this.removeNodesAt(["0"])){return false;}}if(AE){return this.insertNodesAt([AE],"0");}else{return !!AF;}};o.prototype.insertNodesAt=function X(AE,AF){if(this._silentInsertNodesAt(AE,AF)){this.raiseEvent("insertNodes",{nodes:AE,at:AF,count:AE.length});return true;}return false;};o.prototype.removeNodesAt=function D(AK,AG){var AE=mstr.$A.len(AK);if(!AE){return false;}if(!AG){AK=this._sortPaths(AK);}var AF=[],AI,AJ;for(var AH=AE-1;AH>-1;AH--){AJ=AK[AH];AI=this.getNodeAt(AJ);if(this._silentRemoveNode(AI)){AF.push(AJ);}}if(AF.length){this.raiseEvent("removeNodes",{at:AF});return true;}return false;};o.prototype.removeAllChildNodes=function O(AH){if(!AH){return false;}var AE=mstr.$A.len(AH.children);if(!AE){return false;}if(mstr.utils.Trees.removeAllChildNodes(AH)){var AI=this.getNodePath(AH);var AJ=new Array(AE);var AF=0;for(var AG=AE-1;AG>-1;AG--){AJ[AF]=AI+mstr.models.AbstractTreeBase.PATHDELIM+AG;AF++;}this.raiseEvent("removeNodes",{at:AJ});return true;}return false;};o.prototype.execToggleSelect=function E(AF){if(!AF){return false;}if(this._isNodeSelected(AF)){return this._unselectNodes([AF]);}else{var AE=mstr.$H.firstItem(this.props.selections);if(AE&&AE.parent==AF.parent){this.props.anchorNode=AF;return this._selectNodes([AF]);}else{return this.execSingleSelect(AF);}}};o.prototype.execRangeSelect=function AD(AG){var AF=this.props.anchorNode;var AE=this._buildNodeRange(AG,AF);if(mstr.$A.len(AE)){var AH=this.execSelect(AE);this.props.anchorNode=AF;return AH;}else{return this.execSingleSelect(AG);}};o.prototype.execSelectString=function e(AG){if(!AG){return false;}var AI=this.firstSelectionByIndex(),AH=AI&&AI.node&&AI.node.parent&&AI.node.parent.children;if(!AH){return false;}var AF=new RegExp("^"+AG,"i"),AE=mstr.utils.Trees.matchByForm(AH,AF,"n",AI.childIndex+1);return(AE>-1)&&this.execSingleSelect(AH[AE]);};o.prototype.firstSelectionByIndex=function z(){var AF=this.props.selections;node=mstr.$H.firstItem(AF),childIndex=mstr.utils.Trees.findChildIndex(node&&node.parent,node);if((childIndex>-1)&&mstr.$H.lenGreaterThan(AF,1)){var AG=node.parent,AH=AG&&AG.children;for(var AE=0;AE<childIndex;AE++){if(AF[AH[AE].id]){childIndex=AE;break;}}}return{node:node,childIndex:childIndex};};o.prototype.lastSelectionByIndex=function S(){var AF=this.props.selections;node=mstr.$H.firstItem(AF),childIndex=mstr.utils.Trees.findChildIndex(node&&node.parent,node);if((childIndex>-1)&&mstr.$H.lenGreaterThan(AF,1)){var AG=node.parent,AH=AG&&AG.children;for(var AE=mstr.$A.len(AH)-1;AE>childIndex;AE--){if(AF[AH[AE].id]){childIndex=AE;break;}}}return{node:node,childIndex:childIndex};};o.prototype._buildNodeRange=function V(AO,AN){if(AO&&AN&&AO.parent&&AO.parent==AN.parent){var AE=[],AG=AO.parent,AL=AG.children,AK=mstr.utils.Trees.findChildIndex(AG,AO),AJ=mstr.utils.Trees.findChildIndex(AG,AN),AF=Math.min(AK,AJ),AM=Math.max(AK,AJ);var AH;for(var AI=AF;AI<=AM;AI++){AH=AL[AI];if(AH){AE.push(AH);}}return AE;}return null;};o.prototype.importListModel=function I(AQ,AT){if(!AQ){return ;}var AE=["dataSourcesXML","objectType","elementSearchRequired","hierarchical","searchMatchCase","searchMatchCaseAvailable"];for(var AK=0,AH=AE.length;AK<AH;AK++){this.props[AE[AK]]=AQ.get(AE[AK]);}var AR=AQ.props&&AQ.props.tree&&AQ.props.tree.getRootNode(),AL;var AU=AQ.getContainerTree();var AI=AU&&AU.getRootNode();if(AI){AL=AU.getSelectedNode();if(AL){AE=["blockBegin","blockCount","totalSize","readyState","searchXML","leafElements"];for(var AK=0,AH=AE.length;AK<AH;AK++){AL[AE[AK]]=AQ.get(AE[AK]);}AL.drillPaths=AQ.get("rmc")&&AQ.get("rmc").getItems();if(AT){AL.autoExpand=true;}}}if(AR){var AO=AL||AI;if(AO){mstr.utils.Trees.insertChildNodes(AO,[AR],0,this.getId());}else{AI=AR;}}if(AI){this.setRootNode(AI);this.execCommand("SingleSelect",AL);}var AP=AQ.getItems();var AN=mstr.$A.len(AP);if(!AN){return ;}var AJ=new Array(AN);for(var AK=0;AK<AN;AK++){AJ[AK]={value:AP[AK]};}var AS=null;if(this.getRootNode()){AS=this.getNodePath(this.getSelectedNode());if(AS!=null){AS+=mstr.models.AbstractTreeBase.PATHDELIM;}}else{if(AN==1){AS="";}else{this.setRootNode({value:null});AS="0"+mstr.models.AbstractTreeBase.PATHDELIM;}}if(AS!=null){this.insertNodesAt(AJ,AS+"0");var AG=[];var AF=AQ.getSelectedIndices();if(AF){for(var AM in AF){AG.push(AJ[parseInt(AM)]);}}else{AG.push(AJ[0]);}this.execCommand("Select",AG);}};o.prototype.execFetchBlock=function K(AF,AE){if(!AE){AE=this.props.editNode;}if(!AE||!AF){return ;}return this.fetchBlock(AE,AF,AE.searchPattern);};o.prototype.execFetchFirst=function L(AE){return this.execFetchBlock(1,AE);};o.prototype.execFetchPrevious=function AA(AE){return this.execFetchBlock(this._computePreviousBlockBegin(AE),AE);};o.prototype.execFetchNext=function q(AE){return this.execFetchBlock(this._computeNextBlockBegin(AE),AE);};o.prototype.execFetchLast=function C(AE){return this.execFetchBlock(this._computeLastBlockBegin(AE),AE);};o.prototype.queryEnabledFetchFirst=function a(AF){if(AF){var AE=AF.totalSize;var AG=AF.blockCount;return(AE>0)&&(AG>0)&&(AF.blockBegin>1);}return false;};o.prototype.queryEnabledFetchPrevious=function u(AF){if(AF){var AE=AF.blockBegin;return(AE>1)&&(this._computePreviousBlockBegin(AF)<AE);}return false;};o.prototype.queryEnabledFetchNext=function M(AE){return this._computeNextBlockBegin(AE)>0;};o.prototype.queryEnabledFetchLast=function c(AF){if(AF){var AE=AF.blockBegin;return AE>0&&(this._computeLastBlockBegin(AF)>AE);}return false;};o.prototype.queryEnabledFetchBlock=function Y(AF){if(!AF||!AF.value){AF=this.props.editNode;}if(AF){var AG=AF.blockCount;var AE=AF.totalSize;return(AF.readyState==mstr.Enum.Widget.READYSTATE.IDLE)&&(AG>0)&&(AE>0)&&(AG<AE);}return(!AF);};o.prototype._computePreviousBlockBegin=function G(AF){if(AF){var AE=AF.totalSize;var AG=AF.blockCount;if(AE>0&&AG>0){return Math.max(1,AF.blockBegin-AG);}}return -1;};o.prototype._computeNextBlockBegin=function h(AF){if(AF){var AE=AF.totalSize;var AG=AF.blockCount;if(AE>0&&AG>0){if(AF.blockBegin+AG<=AE){return AF.blockBegin+AG;}}}return -1;};o.prototype._computeLastBlockBegin=function g(AF){if(AF){var AE=AF.totalSize;var AG=AF.blockCount;if(AE>0&&AG>0){var AH=AE%AG;if(AH==0){AH=AG;}return AE-AH+1;}}return -1;};o.prototype.getFetchBlockModel=function AB(){var AE=this.props.fetchBlockModel;if(!AE){AE=new mstr.models.ConstantPromptAnswer({parent:this,dataType:mstr.Enum.Nodes.DATATYPE.INTEGER});if(!AE){return null;}mstr.controllers.Factory.add(AE);AE.init&&AE.init();this.props.fetchBlockModel=AE;}var AG=this.props.editNode;if(!AG){return null;}var AF=parseInt(AG.totalSize)||0;AE.set("min",Math.min(1,AF));AE.set("max",AF);AE.set("valueString",parseInt(AG.blockBegin)||"");return AE;};o.prototype.getNodeBrowseType=function N(AH,AI,AF,AE){if(AI==null){AI=true;}if(AF==null){AF=true;}if(AE==null){AE=true;}if(!AI&&!AF&&!AE){return null;}var AG=AH&&AH.value;if(!AG){return null;}if(AG.locked){return null;}switch(parseInt(AG.tp)){case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:return null;case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:return AI?"BrowseFolder":null;break;default:if(!AE&&!AF){return null;}if(AH.isWithinHierarchy==null){AH.isWithinHierarchy=mstr.utils.ListViewHelper.isWithinHierarchy(AH);}if(AH.isWithinHierarchy){return AE?"BrowseHierarchyItem":null;}else{if(AF){if(parseInt(AH.value.tp)==mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE){return"BrowseAttribute";}}}break;}};o.prototype.fetchBlock=function B(AR,AK,AP){var AH=function(AZ,Aa,AX){var AY={value:Aa,autoExpand:true};this.insertNodesAt([AY],this.getNodePath(AZ)+mstr.models.AbstractTreeBase.PATHDELIM+"0");this.setNodeReadyState(AZ,mstr.Enum.Widget.READYSTATE.IDLE);AZ.totalSize=AX;AZ.blockCount=AX;AZ.blockBegin=1;AZ.leafElements=false;return AY;};switch(this.getNodeBrowseType(AR)){case"BrowseFolder":return this.browseFolderBlock(AR.value.dssid,AK,AP,AR);break;case"BrowseAttribute":return this.browseAttributeBlock(AR.value.dssid,AK,AP,AR);break;case"BrowseHierarchyItem":var AQ=this._buildHierarchyPathForNode(AR);var AJ=[],AI=0,AL=AR&&(AR.parent&&AR.parent.drillPaths||AR.value&&AR.value.filters);for(var AS=0,AT=mstr.$A.len(AL);AS<AT;AS++){if(AL[AS]&&(AL[AS]["drillDir"]=="down"||AL[AS]["tp"]=="1")){AJ.push(AL[AS]);AI++;}}if((AI>1&&!AP)||((AI==1)&&AJ[0]["locked"])){var AN=[];for(var AS=0;AS<AI;AS++){AN.push({value:AJ[AS]});}this.insertNodesAt(AN,this.getNodePath(AR)+mstr.models.AbstractTreeBase.PATHDELIM+"0");this.setNodeReadyState(AR,mstr.Enum.Widget.READYSTATE.IDLE);AR.totalSize=AI;AR.blockCount=AI;AR.blockBegin=1;AR.leafElements=false;}else{var AM=AI>0&&AJ[0]["tp"]=="1"&&AP;var AF=this.canAutoExpandOnDrill()||AM;if(AF&&(AI==1||AM)&&(!AJ[0]["locked"]||AL[AS]["tp"]=="1")){AQ+=(AJ[0].tp=="1"?o.ELE_FILTER_ATT_DELIM:o.HIERARCHY_PATHDELIM)+encodeBrowsePathElement(AJ[0][this.props.valueForm]);AR=AH.call(this,AR,AJ[0],AI);if(AR.value.tp=="12"&&AR.value.filters&&AR.value.filters.length==1){var AG=AR.value.filters[0];AQ+=(AG.tp=="1"?o.ELE_FILTER_ATT_DELIM:o.HIERARCHY_PATHDELIM)+encodeBrowsePathElement(AG[this.props.valueForm]);AR=AH.call(this,AR,AG,1);}}if(!AP&&this.props.elementSearchRequired){var AV=AR&&AR.value,AW=parseInt(AV.tp);if(AW==mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE||AW==mstr.Enum.MSTRFolderItem.TYPE.FILTER){var AU=AR.parent,AO=AU&&AU.value,AE=AO&&AO.tp;nparpartp=AU&&AU.parent&&AU.parent.value&&AU.parent.value.tp;if((AW==mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE&&AE==mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY&&!mstr.$A.len(AV.filters))||(AW==mstr.Enum.MSTRFolderItem.TYPE.FILTER&&AE==mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE&&nparpartp==mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY)){AR.elementSearchRequired=true;this.setNodeReadyState(AR,mstr.Enum.Widget.READYSTATE.ERROR);return true;}}}return this.browseHierarchyBlock(AQ,AK,AP,{commandId:"BrowseHierarchyItem",node:AR,searchPattern:AP});}break;}return false;};o.prototype.browseFolderBlock=function m(AF,AI,AK,AH){if(!AH||!AI||AI<0){return false;}var AJ="",AL=AH;while(AL&&!AJ){AJ=AL.searchXML;AL=AL.parent;}if(!AJ){AJ="";}if(!AF&&!AJ){return false;}var AE,AG;if(AK!=null&&AK!=""){AE=new mstr.http.MetadataSearchRequestInputs(AF||"",AI,mstr.utils.ListViewHelper.getFetchBlockForTask("searchMetadata"),AH.totalSize||0,this.props.objectType||"",AJ,AK,this.props.dataSourcesXML);AG={commandId:"Search",searchPattern:AK,node:AH};}else{AE=new mstr.http.BrowseFolderRequestInputs(AF||"",AI,mstr.utils.ListViewHelper.getFetchBlockForTask("searchMetadata"),AH.totalSize||0,this.props.hierarchical,this.props.objectType||"",AJ,this.props.dataSourcesXML);AG={commandId:"BrowseFolder",node:AH};}this.submitRequest(AE,AG);return true;};o.prototype.browseAttributeBlock=function Z(AI,AH,AJ,AG){if(!AG||!AI||!AH||AH<0){return false;}if(AJ==null){AJ="";}var AE=new mstr.http.BrowseAttributeRequestInputs(AI,AH,mstr.utils.ListViewHelper.getFetchBlockForTask("browseElements"),AG.totalSize||0,false,AJ,this.props.searchMatchCaseAvailable&&this.props.searchMatchCase,AG.filterXML||(AG.parent&&AG.parent.filterXML)||"",this.props.dataSourcesXML||"");var AF={commandId:"BrowseAttribute",searchPattern:AJ,node:AG};this.submitRequest(AE,AF);return true;};o.prototype.browseHierarchyBlock=function A(AI,AG,AH,AF){if(!AG||AG<0){return false;}if(AH==null){AH="";}var AE=new mstr.http.DataExploreRequestInputs(AI,AH,this.props.searchMatchCaseAvailable&&this.props.searchMatchCase,AG,mstr.utils.ListViewHelper.getFetchBlockForTask("browseHierarchy"),this.props.dataSourcesXML||"");this.submitRequest(AE,AF);return true;};o.prototype.canAutoExpandOnDrill=function Q(){var AE=this.props.autoExpandOnDrill;return(AE===false||AE===true)?AE:mstr.Settings.DataExplorer.AUTOEXPANDONDRILL;};o.HIERARCHY_PATHDELIM="~";o.ELE_FILTER_ATT_DELIM=",";o.prototype._buildHierarchyPathForNode=function J(AH){var AI=[],AE=this.props.valueForm,AG,AJ,AF;while(AH){if(AH.hierarchyPath!=null){if(AF&&AH.value&&parseInt(AH.value.tp)==mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE){AI.unshift((AH.hierarchyPath)+o.ELE_FILTER_ATT_DELIM+encodeBrowsePathElement(AF[AE]));AF=null;}else{AI.unshift((AH.hierarchyPath));}break;}else{AG=AH.value;if(!AG){break;}AJ=parseInt(AG.tp);switch(AJ){case mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE:if(AF){AI.unshift(encodeBrowsePathElement(AG[AE])+o.ELE_FILTER_ATT_DELIM+encodeBrowsePathElement(AF[AE]));AF=null;break;}case mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY:case mstr.Enum.MSTRFolderItem.TYPE.ELEMENT:AI.unshift(encodeBrowsePathElement(AG[AE]));AF=null;break;case mstr.Enum.MSTRFolderItem.TYPE.FILTER:AF=AG;break;case mstr.Enum.MSTRFolderItem.TYPE.PROJECT:case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:default:AJ=null;AH=null;AF=null;break;}}if(AJ==mstr.Enum.MSTRFolderItem.TYPE.HIERARCHY){break;}AH=AH&&AH.parent;}return AI.join(o.HIERARCHY_PATHDELIM);};o.prototype.onRequestCallback=function W(AG){var AE=this.props.requestContext;if(!AG||!AE||(AE.id!=AG.id)){return ;}var AH=mstr.models.AbstractTreeBase.prototype.onRequestCallback.apply(this,[AG]);var AF=AE.memo&&AE.memo.node;if(AF){this.setNodeReadyState(AF,AG.readyState);}return AH;};o.prototype.setNodeReadyState=function F(AG,AE){if(AG){var AF=AG.readyState;if(parseInt(AF)!=parseInt(AE)){AG.readyState=AE;this.raiseEvent("set_nodeReadyState",{name:"readyState",node:AG,value:AE,valueWas:AF});return true;}}return false;};o.prototype.loadRequestResponse=function x(){var AN=this.props.requestContext;var AH=AN&&AN.memo&&AN.memo.node;if(!AH){this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var AP=AN.response;if(!AP||!AP.data){this.setNodeReadyState(AH,mstr.Enum.Widget.READYSTATE.ERROR);this.set("readyState",mstr.Enum.Widget.READYSTATE.ERROR);return ;}var AI=AP.data;var AQ=AI.props&&AI.props.tree&&AI.props.tree.getRootNode();if(!AH.value.did&&!AH.value.dssid&&this.getRootNode()==AH){var AM=this.props.hierarchical;this.importListModel(AI,true);if(AM&&!this.props.hierarchical){this.props.hierarchical=AM;}}else{if(AQ){AH=AH.parent;this.removeAllChildNodes(AH);AH.children=[AQ];AQ.parent=AH;this.insertNodesAt([AQ],this.getNodePath(AH)+mstr.models.AbstractTreeBase.PATHDELIM+"0");this.execSingleSelect(AH);}else{var AR=["totalSize","blockCount","blockBegin","leafElements"];for(var AJ=0;AJ<AR.length;AJ++){AH[AR[AJ]]=AI.get(AR[AJ]);}AH.searchPattern=AN.memo.searchPattern;AH.drillPaths=AI.get("rmc")&&AI.get("rmc").getItems();this.removeAllChildNodes(AH);var AO=AI.getItems();var AL=mstr.$A.len(AO);if(AL){var AE=AH&&AH.isWithinHierarchy&&(AH.value&&AH.value.tp==mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE);var AF=new Array(AL);for(var AJ=0;AJ<AL;AJ++){AF[AJ]={value:AO[AJ]};if(AE&&AO[AJ]&&AO[AJ].tp==mstr.Enum.MSTRFolderItem.TYPE.FILTER){if(AH.value&&!AH.value.filters){AH.value.filters=[];}var AG=AH.value&&AH.value.filters;if(AG&&(mstr.utils.Arrays.findByForm(AG,AO[AJ][this.props.valueForm],this.props.valueForm)<0)){AH.value.filters[AH.value.filters.length]=AO[AJ];}}}this.insertNodesAt(AF,this.getNodePath(AH)+mstr.models.AbstractTreeBase.PATHDELIM+"0");}var AK=this.getSelectedNode();if(AK&&AK.parent){this.execSingleSelect(AK);}else{this.execClearSelect();}}}this.props.requestContext={};this.setNodeReadyState(AH,mstr.Enum.Widget.READYSTATE.IDLE);this.set("readyState",mstr.Enum.Widget.READYSTATE.IDLE);};o.prototype.cancelRequest=function y(AH){var AF=this.props.requestContext;var AG=AF&&AF.memo&&AF.memo.node;if(AG&&(AG.readyState==mstr.Enum.Widget.READYSTATE.WAITING||AG.readyState==mstr.Enum.Widget.READYSTATE.SUCCESS)){this.setNodeReadyState(AG,mstr.Enum.Widget.READYSTATE.CANCELLED);}var AE=mstr.models.AbstractTreeBase.prototype.cancelRequest.apply(this,[AH]);return AE;};o.prototype.execSearch=function T(AE){return this.execSearchNode({node:this.getSelectedNode(),searchPattern:AE});};o.prototype.execSearchNode=function AC(AJ){var AK=AJ&&AJ.node,AL=AJ&&AJ.searchPattern;if(!AK){return false;}var AF=this.props.searchResultsNode;if(AF&&AF.parent){this.removeNodesAt([this.getNodePath(AF)]);}var AH=this.props.searchResultsNode=this._createSearchResultsNode(AK,AL);if(AH){var AG=this.props.rootNode;if(!AG){return null;}var AE=mstr.$A.len(AG.children);this.insertNodesAt([AH],"0"+mstr.models.AbstractTreeBase.PATHDELIM+AE);var AI=AH.children[0];if(AI.children&&AI.children.length){AI=AI.children[0];}this.fetchBlock(AI,1,AL);this.execSingleSelect(AI);return true;}return false;};o.prototype._createSearchResultsNode=function H(AJ,AI){var AG=mstr.$H.clone(AJ);AG.value=mstr.$H.clone(AJ.value);var AH="",AK=AG;while(AK&&!AH){AH=AK.searchXML;AK=AK.parent;}if(!AH){AH="";}AG.parent=null;AG.children=[];AG.id=null;AG.readyState=mstr.Enum.Widget.READYSTATE.WAITING;AG.isWithinHierarchy=mstr.utils.ListViewHelper.isWithinHierarchy(AJ);if(AG.isWithinHierarchy){AG.hierarchyPath=this._buildHierarchyPathForNode(AJ);if(AG.value&&AG.value.tp==mstr.Enum.MSTRFolderItem.TYPE.FILTER&&AJ.parent){var AE=mstr.$H.clone(AJ.parent);AE.value=mstr.$H.clone(AJ.parent.value);AE.parent=null;AE.children=[AG];AE.id=null;AE.hierarchyPath=this._buildHierarchyPathForNode(AJ.parent);AG.parent=AE;AG=AE;}}var AF={value:{icon:"f",tp:-1,n:(microstrategy.descriptors.getDescriptor("538"))+" "+AI,dssid:null},searchXML:AH};AF.children=[AG];AG.parent=AF;return AF;};o.prototype._updateCommandEnabledSearch=function R(){var AE=false;var AF=false;var AH=this.props.selections;if(!mstr.$H.lenGreaterThan(AH,1)&&!mstr.$H.isEmpty(AH)){var AG=mstr.$H.firstItem(AH);switch(AG&&AG.value&&parseInt(AG.value.tp)){case mstr.Enum.MSTRFolderItem.TYPE.FOLDER:AF=false;AE=true;break;case mstr.Enum.MSTRFolderItem.TYPE.ATTRIBUTE:if(AG.value.locked){AF=AE=false;}else{if(mstr.utils.ListViewHelper.isWithinHierarchy(AG)){AF=AE=true;}else{AF=AE=false;}}break;case mstr.Enum.MSTRFolderItem.TYPE.FILTER:AE=mstr.utils.ListViewHelper.isWithinHierarchy(AG);AF=AE;break;}}this.set("CommandEnabledSearch",AE);this.set("searchMatchCaseAvailable",AF);};o.prototype.on_hashadd_selections=o.prototype.on_hashremove_selections=function P(AE){if(AE&&AE.src==this){this._updateCommandEnabledSearch();}};function o(AE){mstr.models.AbstractTreeBase.apply(this,[AE]);}return o;})();mstr.behaviors.FetchControl=(function(){var E={};E.fireFetchCommand=function B(J,I,M){var K=mstr.$obj(J);var H=K&&K.getModel();var L=K.get("targetView");if(!L&&K.get("targetViewPath")){K.props.targetView=L=mstr.controllers.Factory.getPath(K.get("targetViewPath"),K);}if(L&&L.restoreFocus){L.restoreFocus();}if(H&&H.queryCommandEnabled(I)){H.execCommand(I,M);}};E.on_set_enabled=function A(O,L,R){var M=O.props.enabled;var Q=R.rows[0].cells;M=O.props.enabledCaption=M&&L&&L.queryCommandEnabled("FetchBlock");var P=Q[2].childNodes[0];P.disabled=!M;var I=["FetchFirst","FetchPrevious",null,"FetchNext","FetchLast"],K=["fetchFirst","fetchPrevious",null,"fetchNext","fetchLast"];for(var J=0;J<I.length;J++){if(!I[J]){continue;}var H=M&&L&&L.queryCommandEnabled(I[J]);var N=K[J]+(H?"":"Disabled");mstr.utils.Dom.setBGIconClass(Q[J].firstChild,N);Q[J].firstChild.style.cursor=H?"pointer":"";}};E.on_set_visible=function D(H,I,J){E.update_css_display(H,J);if(H.props.visible){this.updateCaption(H,I,J);}};E.update_css_display=function F(H,M){var L=H.props,K=L.visible,J=L.needsFetch;mstr.behaviors.Generic.set_css_display(M,"table","none",!!K!==false);var I=M.rows[0].cells;mstr.behaviors.Generic.set_css_display(I[0].firstChild,"block","none",!!J!==false);mstr.behaviors.Generic.set_css_display(I[1].firstChild,"block","none",!!J!==false);mstr.behaviors.Generic.set_css_display(I[3].firstChild,"block","none",!!J!==false);mstr.behaviors.Generic.set_css_display(I[4].firstChild,"block","none",!!J!==false);};E.on_model_set_readyState=function C(H,I,J){if(I&&I.get("readyState")==mstr.Enum.Widget.READYSTATE.IDLE){this.updateCaption(H,I,J);}};E.updateCaption=function G(L,I,P){var O=L.props.descriptors.noItems,H=false;if(I){var M=parseInt(I.props.blockBegin)||0;var K=parseInt(I.props.blockCount)||0;var Q=parseInt(I.props.totalSize)||0;if(Q&&M){var J=(K>0)?Math.min(M+K-1,Q):Q;O=microstrategy.descriptors.getDescriptor("117");O=O.replace(/####/,Q).replace(/###/,J).replace(/##/,M);H=(M>1)||(K<Q);}}var N=P.rows[0].cells[2].childNodes[0];N.innerHTML=O;L.props.needsFetch=H;E.update_css_display(L,P);};E.on_mousedown=function(H){var I=mstr.$obj(H);if(I&&I.props.enabled){I.execCommand("OpenPopup",{popup:mstr.$obj("FetchBlockPopup1")});}return true;};return E;})();mstr.behaviors.TreeView=(function(){var C={};C.isTargetTextbox=function E(H,F){var G=mstr.utils.Events.target(H,F);return !!(G&&G.type=="text");};C.redirectFocus=function A(H,G,F){if(!this.isTargetTextbox(H,G)){try{document.getElementById(F+"TabStop").focus();}catch(I){}}return true;};C.onmouseupRootParent=function(H,G,F){if(mstr.utils.ISFF||!this.isTargetTextbox(H,G)){mstr.behaviors.Generic.clearBrowserHighlights(G);}this.redirectFocus(H,G,F);return true;};C.onmousedownRootParent=function(H,G,F){this.onmousedown(H,G,F);this.redirectFocus(H,G,F);return true;};C.onmousedown=function D(L,J,O){var P=new mstr.lang.Event(L,J);var I=P.ctrl(),R=P.shift();if(I||R){mstr.utils.Dom.clearBrowserHighlights(J);}var M=mstr.$obj(O);if(!M||!M.fireCommands){return true;}var K={nodeId:null,ctrl:I,shift:R,x:P.x+3,y:P.y+3};var H=P.target();var Q=mstr.utils.Dom.findAncestor(H,"mstrTreeNodeInfo",null,M.props[mstr.$W.ELEMENT],true);if(Q){K.nodeId=Q.mstrTreeNodeInfo;K.elNode=Q;var N=mstr.utils.ListViewHelper.getItemRenderer(M);K.expandState=N&&N.getNodeExpandState&&N.getNodeExpandState(Q);var G=mstr.utils.Dom.findAncestor(H,"mstrTreeNodePart",null,Q,true);K.elNodePart=G;K.part=G&&!G.disabled?G.mstrTreeNodePart:null;var F=mstr.utils.Dom.findAncestor(H,"mstrPopupInfo",null,Q,true);K.popup=F&&!F.disabled?F.mstrPopupInfo:null;}M.fireCommands(null,K);return true;};C.ondblclick=function B(J,H,G){var I=mstr.$obj(G);if(!I||!I.fireCommands){return true;}var F=I.props.cmdsDblClick;if(!F){return true;}I.fireCommands(F,null);return true;};return C;})();mstr.behaviors.ExpandableTreeView=(function(){var R={};R.renderNode=function B(m,e,u,W){if(!W||!W.node){return null;}var Y=(m.props.cssPrefix||"")+(m.props.itemCSSPrefix||""),Z=W.node,h=Z.value;var o=false;if(!Z.parent&&m.props.hideRootNodeTypes&&h&&h.tp){var c=mstr.$A.toHash(String(m.props.hideRootNodeTypes).split(","));o=!!c[h.tp];}var X=this.generateNodeElement(Z,m.props.document,Y,o);var q=m&&m.getExtraNodeCssClass&&m.getExtraNodeCssClass(Z)||"";if(q){X.className=X.className+" "+q;}var V;if(o||mstr.$A.len(Z.children)){V=1;}else{if(Z.autoExpand){V=1;}else{switch(parseInt(Z.readyState)){case mstr.Enum.Widget.READYSTATE.WAITING:case mstr.Enum.Widget.READYSTATE.SUCCESS:V=1;break;default:V=W.browseType?0:2;break;}}}this._renderNodeExpandState(X,V,m.props.allowExpandCollapse,m.props.autoCollapse&&(Z.parent));var n=W.node.parent;this._renderNodePosition(X,!n||(n.children[0]==W.node),!n||(n.children[n.children.length-1]==W.node),!n);if(e&&e._isNodeSelected(Z)){this._renderNodeValueState(m,X,true);}var a=Z.readyState;if(a!=null){this._renderNodeReadyState(m,e,Z,X);}var g=this.findLocationForNode(W.treeRootParent,e._pathParts(W.path),Y);mstr.utils.Dom.insertNode(X,g.parent,g.before);return X;};R.scrollToNode=function D(h,a,o,V){if(!V){return ;}if(V.paddingLeft==null){V.paddingLeft=0;}if(V.paddingRight==null){V.paddingRight=35;}if(V.paddingTop==null){V.paddingTop=0;}if(V.paddingBottom==null){V.paddingBottom=35;}var Y=V.treeRootParent.parentNode;if(!Y){return ;}if(!V.el){var e=this.findLocationForNode(V.treeRootParent,a._pathParts(V.path));V.el=e&&e.before;}if(!V.el){return ;}var m=(mstr.utils.ISIE4&&!mstr.utils.ISIE8PLUS)?mstr.utils.BoxModel.getElementSumOffsetLeft(V.el,Y):mstr.utils.BoxModel.getElementSumOffsetLeftAccurately(V.el,Y);var g=(mstr.utils.ISIE4&&!mstr.utils.ISIE8PLUS)?mstr.utils.BoxModel.getElementSumOffsetTop(V.el,Y):mstr.utils.BoxModel.getElementSumOffsetTopAccurately(V.el,Y);var c={x:null,y:null};var Z=Y.clientWidth;var X=Y.scrollLeft;if(m<X+V.paddingLeft){c.x=m+V.paddingLeft;}else{if(m>X+Z-V.paddingRight){c.x=Math.max(m-Z+V.paddingRight,0);}}var n=Y.clientHeight;var W=Y.scrollTop;if(g<W+V.paddingTop){c.y=g;}else{if(g>W+n-V.paddingBottom){c.y=Math.max(g-n+V.paddingBottom,0);}}if(c.x!=null||c.y!=null){mstr.utils.Animations.scroll(Y,c.x,c.y);}};R.markNodePosition=function N(V,W,a,X){var Z=this.findLocationForNode(X.treeRootParent,W._pathParts(X.path));if(!Z||!Z.before){return ;}var Y=X.node.parent;this._renderNodePosition(Z.before,!Y||(Y.children[0]==X.node),!Y||(Y.children[Y.children.length-1]==X.node),!Y);};R._renderNodePosition=function A(W,Y,Z,V){var a="",X="no-repeat";if(!V){if(Z){a="treeViewChildConnectorLast";}else{a="treeViewChildConnector";X="repeat-y";}}if(a){mstr.utils.Dom.setBGIconClass(W,a);}"";W.style.backgroundRepeat=X;};R.markNodeReadyState=function I(V,W,a,X){if(W&&X&&X.node&&X.treeRootParent){var Y=W.getNodePath(X.node);var Z=this.findLocationForNode(X.treeRootParent,W._pathParts(Y));if(!Z||!Z.before){return ;}this._renderNodeReadyState(V,W,X.node,Z.before);}};R._renderNodeReadyState=function F(u,h,c,X){if(!c){return ;}var Y=X.childNodes[1];var x=Y.childNodes[0],e=Y.childNodes[1],a=Y.childNodes[2],y=Y.childNodes[3];if(!x){var n=Y.className;x=Y.ownerDocument.createElement("div");Y.appendChild(x);x.className=n.replace("LongDisplay","Fetch");e=Y.ownerDocument.createElement("div");Y.appendChild(e);e.className=n.replace("LongDisplay","Msg");var a=Y.ownerDocument.createElement("div");Y.appendChild(a);a.className=n.replace("LongDisplay","ChildrenContainer");y=doc.createElement("div");Y.appendChild(y);y.className=n.replace("LongDisplay","FetchBottom");}var g=parseInt(c.readyState);if(g==mstr.Enum.Widget.READYSTATE.IDLE){this._updateFetchControls(u,h,c,x);this._updateFetchControls(u,h,c,y);}var Z=null,V=null;var m=u.props.descriptors;switch(g){case mstr.Enum.Widget.READYSTATE.ERROR:if(c.elementSearchRequired){Z=u.props.descriptors.searchRequiredText+'<br><input type="text" class="mstrTreeViewSearch" onkeypress="mstr.behaviors.ExpandableTreeView.onSearchKeyPress(arguments[0], self, \''+u.props.id+"' ,this.value, '"+c.id+'\' )" /><img src="../style/mstr/images/tbSearchEnabled.gif" align="absmiddle" title="" alt="Search"  onclick="mstr.behaviors.ExpandableTreeView.onClickSearchBtn(\''+u.props.id+"' ,this.previousSibling.value, '"+c.id+"' )\" />";}else{var o=h&&h.props.requestContext,q=o&&o.response,W=q&&q.errorMessage,Z=m&&m.errorText;if(W){Z=Z+' <a href="javascript:void(0)" onclick="alert(\''+W.replace(/'/g,"\\'").replace(/[\r\n]/g,"")+"');return false;\">"+(m&&m.errorDetailsText)+"</a>";}}V="exclamRed.gif";break;case mstr.Enum.Widget.READYSTATE.WAITING:Z=m&&m.waitingText;V="treeLoading.gif";break;case mstr.Enum.Widget.READYSTATE.SUCCESS:Z=m&&m.loadingText;V="treeLoading.gif";break;case mstr.Enum.Widget.READYSTATE.CANCELLED:Z=m&&m.requestCancelledText;V="exclamRed.gif";break;case mstr.Enum.Widget.READYSTATE.TIMEOUT:Z=m&&m.requestTimeOutText;V="exclamRed.gif";break;default:break;}e.style.display=Z?"block":"none";if(Z){e.innerHTML=Z;}e.style.backgroundImage=V?"url(../style/mstr/images/"+V+")":"";};R.onSearchKeyPress=function Q(Y,W,V,X,Z){Y=Y||W.event;if(Y.keyCode==13){this.onClickSearchBtn(V,X,Z);return false;}return true;};R.onClickSearchBtn=function C(W,a,e){var X=mstr.$obj(W),c=X&&X.props,V=c&&c.cmdsSearch;if(X&&V&&a){var Y=c.model,Z=Y&&mstr.utils.Trees.findByNodeForm(Y.props.rootNode,e,"id");if(Z){X.fireCommands(V,{node:Z,searchPattern:a});}}return true;};R._updateFetchControls=function E(g,Z,q,m){if(!q){return ;}if(!m.childNodes[0]){this._buildFetchControls(g,m);if(!m.childNodes[0]){return ;}}var n=(q.blockCount>0&&q.totalSize>q.blockCount);if(n){m.style.display="block";var Y=m.childNodes[0].rows[0].cells;var o=["FetchFirst","FetchPrevious",null,"FetchNext","FetchLast"];var u=["fetchFirst","fetchPrevious",null,"fetchNext","fetchLast"];var X=["fetchFirstDisabled","fetchPreviousDisabled",null,"fetchNextDisabled","fetchLastDisabled"];var V,W;for(var x=0;x<o.length;x++){if(!o[x]){continue;}W=Y[x].childNodes[0];V=!!(Z&&Z.queryCommandEnabled(o[x],q));W.disabled=!V;mstr.utils.Dom.setBGIconClass(W,(V?u[x]:X[x]));W.style.cursor=V?"pointer":"default";}var a=Y[2].childNodes[0];a.disabled=!(Z&&Z.queryCommandEnabled("FetchBlock",q));var z=g.props.descriptors.noItems;if(Z&&q){var AB=parseInt(q.blockBegin)||0;var AA=parseInt(q.blockCount)||0;var h=parseInt(q.totalSize)||0;if(h&&AB){var y=(AA>0)?Math.min(AB+AA-1,h):h;z=g.props.descriptors.incrementalFetchSeparator;z=z.replace(/##/,AB).replace(/###/,y).replace(/####/,h);}}a.innerHTML=z;}else{m.style.display="none";}};R._buildFetchControls=function J(V,Y){var X='<table cellspacing="0" cellpadding="0" class="{@cssPrefix}TreeViewFetchControl"><tr><td><div class="{@cssPrefix}{@cssClass}FetchButton" mstrTreeNodePart="FetchFirst" >&nbsp;</div></td><td><div class="{@cssPrefix}{@cssClass}FetchButton" mstrTreeNodePart="FetchPrevious" >&nbsp;</div></td><td><div class="{@cssPrefix}{@cssClass}FetchControlText"  onmouseover="if (!this.disabled) this.className += \'Hover\'"  onmouseout="this.className = this.className.replace(/Hover/,\'\')" > </div></td><td><div class="{@cssPrefix}{@cssClass}FetchButton" mstrTreeNodePart="FetchNext" >&nbsp;</div></td><td><div class="{@cssPrefix}{@cssClass}FetchButton" mstrTreeNodePart="FetchLast" >&nbsp;</div></td></tr></table>';X=X.replace(/\{\@cssPrefix\}/gm,V.props.cssPrefix||"");X=X.replace(/\{\@cssClass\}/gm,V.props.cssClass||"");Y.innerHTML=X;var W=Y.childNodes[0].rows[0].cells;W[0].childNodes[0].mstrTreeNodePart="FetchFirst";W[1].childNodes[0].mstrTreeNodePart="FetchPrevious";W[2].childNodes[0].mstrPopupInfo="FetchBlockPopup1";W[3].childNodes[0].mstrTreeNodePart="FetchNext";W[4].childNodes[0].mstrTreeNodePart="FetchLast";};R.markNodeExpandState=function G(V,W,Z,X){if(!X){return ;}if(!X.el){if(X.path==null){X.path=X.node&&W&&W.getNodePath(X.node);}var Y=this.findLocationForNode(X.treeRootParent,W._pathParts(X.path));if(!Y||!Y.before){return ;}X.el=Y.before;}this._renderNodeExpandState(X.el,X.state,V.props.allowExpandCollapse);if(X.scroll){if(X.state==1){this.scrollToNode(V,W,Z,{el:X.el,paddingBottom:70,treeRootParent:V.props.treeRootParent});}}};R.getNodeExpandState=function P(W){var V=W&&W.childNodes[0]&&W.childNodes[0].childNodes[0];var X=V&&V.className;if(X){if(/Opened/.test(X)){return 1;}else{if(/Closed/.test(X)){return 0;}else{if(/Leaf/.test(X)){return 2;}}}}return 2;};R._renderNodeExpandState=function O(Z,c,a,Y){var W="",e="";c=(c==1&&Y)?0:c;switch(c){case 1:W="treeNodeOpenedOrphan";e="block";break;case 0:W="treeNodeClosedOrphan";e="none";break;case 2:W="treeLeafOrphan";Z.onclick=null;e="none";break;default:W="treeNodeClosedOrphan";e="none";break;}if(!a){W="treeLeafOrphan";Z.onclick=null;}var V=Z&&Z.childNodes[0]&&Z.childNodes[0].childNodes[0];if(V){mstr.utils.Dom.setBGIconClass(V,W);}var X=Z&&Z.childNodes[1];if(X){X.style.display=e;}};R.markNodeAsSelected=function T(V,W,Z,X){var Y=this.findLocationForNode(X.treeRootParent,W._pathParts(X.path));if(!Y||!Y.before){return ;}this._renderNodeValueState(V,Y.before,true);};R.markNodeAsUnselected=function K(V,W,Z,X){var Y=this.findLocationForNode(X.treeRootParent,W._pathParts(X.path));if(!Y||!Y.before){return ;}this._renderNodeValueState(V,Y.before,false);};R._renderNodeValueState=function S(V,W,X){W.childNodes[0].childNodes[1].className=X?"Selected":"";};R.removeNode=function L(V,W,Z,X){if(!V){return ;}var Y=this.findLocationForNode(V.props.treeRootParent,W._pathParts(X.path));if(!Y||!Y.parent||!Y.before){return ;}Y.parent.removeChild(Y.before);};R.generateNodeElement=function U(c,q,a,u){var h=c&&c.value;if(!h){return null;}var X=q.createElement("div");X.className=a+"Node";var V=q.createElement("div");X.appendChild(V);V.className=a+"NodeShortDisplay";V.mstrTreeNodePart="value";if(u){V.style.display="none";}V.onmouseover=this.hover;V.onmouseout=this.unhover;var h=c.value;var m=h.icon;if(h.locked){m+="_locked";}if(m){mstr.utils.Dom.setBGIconClass(V,m);}var Z=q.createElement("img");V.appendChild(Z);Z.className=a+"NodeConnector";Z.align="absmiddle";Z.src="../images/1ptrans.gif";mstr.utils.Dom.setBGIconClass(Z,"treeLeafLast");Z.mstrTreeNodePart="connector";if(u){Z.style.display="none";}var n=q.createElement("span");V.appendChild(n);n.appendChild(q.createTextNode(h.n));var g=h.desc;V.title=(g!=null&&g!="")?h.n+". "+g:h.n;var W=q.createElement("div");X.appendChild(W);W.className=a+"NodeLongDisplay";if(u){W.style.marginLeft="0px";}var o=q.createElement("div");W.appendChild(o);o.className=a+"NodeFetch";if(u){o.style.backgroundImage="none";}var e=q.createElement("div");W.appendChild(e);e.className=a+"NodeMsg";var Y=q.createElement("div");W.appendChild(Y);Y.className=a+"NodeChildrenContainer";var x=q.createElement("div");W.appendChild(x);x.className=a+"NodeFetchBottom";if(u){x.style.backgroundImage="none";}return X;};R.hover=function(V){this.childNodes[1].className+="Hover";};R.unhover=function(W){var V=this.childNodes[1];V.className=V.className.replace(/Hover/,"");};R.findLocationForNode=function M(c,g,W){var e=c&&c.ownerDocument;if(!e){return ;}var Y={};Y.parent=c;Y.before=c.childNodes[0];for(var X=1,a=g.length;X<a;X++){if(!Y.before){break;}var Z=g[X];var V=Y.before.childNodes[1].childNodes[2];Y.parent=V;Y.before=V.childNodes[Z];}return Y;};R.on_model_set_readyState=function H(Y,h,z){var W=Y&&Y.get("readyState");if(W==null){W=mstr.Enum.Widget.READYSTATE.IDLE;}z.childNodes[0].childNodes[1].style.cursor=(W==mstr.Enum.Widget.READYSTATE.WAITING)?"wait":"default";switch(W){case mstr.Enum.Widget.READYSTATE.WAITING:var m=mstr.$obj(z.id);if(!m){return ;}var e=m.getInsertionPoint();if(!e){return ;}var u=e.substr(0,e.lastIndexOf(mstr.util.Trees.PATH_DELIM));var g=m.getNodeAt(u);if(!g){return ;}try{var AA=mstr.behaviors.ExpandableTreeView.findElementByPath.apply(z,[u,false]);var c=z.childNodes[0].childNodes[1];var X=AA.elChild;mstr.util.BoxModel.scrollToElement(c,X);}catch(n){mstr.debug("Inside mstr.layouts.ExpandableTreeView: "+n.message);}var q=m.getBlockInfoForRequest(m.getRequestId(),g);var Z;if(q){if(q.blockBegin&&q.blockEnd>0){Z=" "+String(q.blockBegin)+" to "+String(q.blockEnd);}else{Z=" all blocks";}}var AB="leafLast";if(g&&m.getFetchState(g)==mstr.features.net.BrowseableTreeNodes.FETCHEDSOME){AB="leaf";}var o=[];var x=z.ownerDocument.createTextNode("Loading "+Z+"...\xA0\xA0");o.push(x);var a=z.ownerDocument.createElement("a");o.push(a);var y=function(){mstr.$obj(z.id).execCommand(mstr.Cmd.CANCELREQUEST);};a.onclick=y;a.href="javascript:void(0)";a.appendChild(z.ownerDocument.createTextNode("Cancel"));mstr.behaviors.ExpandableTreeView.addSpecialNodeAtInsertionPoint.apply(z,[AB,"wait",o]);a=null;break;case mstr.Enum.Widget.READYSTATE.ERROR:var V=z.ownerDocument.createTextNode("{@errorText}");mstr.behaviors.ExpandableTreeView.replaceSpecialNodeAtInsertionPointWithRetryRemove.apply(z,[V]);break;case mstr.Enum.Widget.READYSTATE.TIMEOUT:var V=z.ownerDocument.createTextNode("Timeout");mstr.behaviors.ExpandableTreeView.replaceSpecialNodeAtInsertionPointWithRetryRemove.apply(z,[V]);break;case mstr.Enum.Widget.READYSTATE.CANCELLED:mstr.behaviors.ExpandableTreeView.removeSpecialNodeAtInsertionPoint.apply(z,[]);break;case mstr.Enum.Widget.READYSTATE.SUCCESS:mstr.behaviors.ExpandableTreeView.removeSpecialNodeAtInsertionPoint.apply(z,[]);mstr.behaviors.ExpandableTreeView.addFetchControl.apply(z,[]);break;}};return R;})();mstr.views.TreeView=(function(){mstr.$O.extendsClass(W,mstr.views.BaseView);W.prototype._attachLayoutHandlers=function P(){mstr.views.BaseView.prototype._attachLayoutHandlers.apply(this);var c=this.props.model;if(c&&c.attachEventListener){c.attachEventListener(this,"insertNodes","onInsertNodes");c.attachEventListener(this,"removeNodes","onRemoveNodes");c.attachEventListener(this,"set_nodeReadyState","onSetNodeReadyState");c.attachEventListener(this,"hashadd_selections","onAddSelections");c.attachEventListener(this,"hashremove_selections","onRemoveSelections");}};W.prototype._detachLayoutHandlers=function Y(){mstr.views.BaseView.prototype._detachLayoutHandlers.apply(this);var c=this.props.model;if(c&&c.attachEventListener){c.detachEventListener(this,"insertNodes");c.detachEventListener(this,"removeNodes");c.detachEventListener(this,"hashadd_selections");c.detachEventListener(this,"hashremove_selections");}};W.prototype.onInsertNodes=function V(y){var e=y&&y.memo&&y.memo.at;var q=y&&y.memo&&y.memo.count;var c=y&&y.memo&&y.memo.nodes;if(!q||!c||(e==null)){return ;}var g=this.props.model,u=mstr.utils.ListViewHelper.getItemRenderer(this);if(!g||!u){return ;}var n=g._pathParts(e);var h=n.pop();if(!this.props.allowExpandCollapse){var x=c[0]&&c[0].parent;if(x){u.markNodeExpandState&&u.markNodeExpandState(this,g,this.props.element,{node:x,path:n.join(mstr.models.AbstractTreeBase.PATHDELIM),state:1,treeRootParent:this.props.treeRootParent});}}var z;for(var o=0;o<q;o++){z=n.concat([h+o]).join(mstr.models.AbstractTreeBase.PATHDELIM);this.renderSubTree(c[o],u,z);}};W.prototype.onRemoveNodes=function D(h){var u=h&&h.memo&&h.memo.at;var e=mstr.$A.len(u);if(!e){return ;}var n=this,c=this.props.model,g=this.props[mstr.$W.ELEMENT],q=mstr.utils.ListViewHelper.getItemRenderer(this);if(!c||!q){return ;}for(var o=0,e=mstr.$A.len(u);o<e;o++){q.removeNode(n,c,g,{path:u[o]});}};W.prototype.onSetNodeReadyState=function Q(c){var e=c&&c.memo&&c.memo.node;if(!e){return ;}var g=mstr.utils.ListViewHelper.getItemRenderer(this);if(!g||!g.markNodeReadyState){return ;}g.markNodeReadyState(this,this.props.model,this.props.element,{node:e,treeRootParent:this.props.treeRootParent});};W.prototype.onAddSelections=function a(e){this._toggleSelections(e.memo.at,"markNodeAsSelected");var h=mstr.utils.ListViewHelper.getItemRenderer(this);if(h&&h.scrollToNode){var g=mstr.$H.firstItem(e.memo.at);var c=this.props.model;h.scrollToNode(this,c,this.props.element,{path:c.getNodePath(g),node:g,treeRootParent:this.props.treeRootParent});}};W.prototype.onRemoveSelections=function N(c){this._toggleSelections(c.memo.at,"markNodeAsUnselected");};W.prototype._toggleSelections=function G(h,g){if(!h){return ;}var q=mstr.utils.ListViewHelper.getItemRenderer(this);var e=this,c=this.props.model,o=this.props[mstr.$W.ELEMENT],n=this.props.treeRootParent;if(!c){return ;}for(var u in h){q[g](e,c,o,{path:c.getNodePath(h[u]),node:h[u],treeRootParent:n});}};W.prototype.render=function F(){mstr.views.BaseView.prototype.render.apply(this);var g=this.execLayoutHandler("treeRootParent");this.props.treeRootParent=g;var c=this.getModel();var e=c&&c.getRootNode();if(e&&(e.value.dssid||mstr.$A.len(e.children))){this.renderSubTree(e,mstr.utils.ListViewHelper.getItemRenderer(this),"0",this.props.model,this.props.element,g);}mstr.timers.renderStop=new Date();mstr.timers.render=mstr.timers.renderStop-mstr.timers.renderStart;};W.prototype.renderSubTree=function T(e,o,n,h,q,g){this.renderNode(e,o,n,h,q,g);for(var m=0,c=mstr.$A.len(e.children);m<c;m++){this.renderSubTree(e.children[m],o,n+mstr.models.AbstractTreeBase.PATHDELIM+m,h,q,g);}};W.prototype.renderNodesAt=function B(z,u){var h=this.props.model,n=this.props[mstr.$W.ELEMENT],y=this.props.treeRootParent,x=mstr.utils.ListViewHelper.getItemRenderer(this);if(!h||!x){return ;}var c=h.getNodeAt(z);var AA=h._pathParts(z);var e=AA.pop();var q=(AA.length)?c.parent:null;for(var o=0;o<u;o++){var g=q?q.children[e+o]:h.getRootNode();if(g){this.renderNode(g,x,AA.join(".")+(e+o),h,n,y);}}};W.prototype.renderNode=function M(h,n,m,e,q,c){if(!h){return ;}if(!e){e=this.props.model;}if(!m){m=e.getNodePath(h);}if(!q){q=this.props.element;}if(!c){c=this.props.treeRootParent;}var o=null;if(!h.parent||!h.parent.leafElements){o=e&&e.getNodeBrowseType(h,this.props.allowBrowseFolder,this.props.allowBrowseAttribute,this.props.allowBrowseHierarchy);}var g=n.renderNode(this,e,q,{path:m,node:h,browseType:o,treeRootParent:c});g.mstrTreeNodeInfo=h.id;};W.prototype.execClickTreeNode=function I(n){var c=this.props.model;if(!c){return false;}var e=n&&n.nodeId&&c.findByNodeId(n.nodeId);if(!e){return false;}switch(n.part){case"connector":var g;switch(n.expandState){case 2:g=null;break;case 1:g=0;break;case 0:g=1;break;}if(g!=null){var h=mstr.utils.ListViewHelper.getItemRenderer(this);if(!h){return ;}h.markNodeExpandState(this,this.props.model,this.props.element,{el:n.elNode,state:g,scroll:true});}return false;break;case"value":return this._clickTreeNodeValue(e,n);break;}return false;};W.prototype._clickTreeNodeValue=function Z(h,n){var e=this.props.model;if(!e){return false;}var g=!!this.props.multiSelect;if(h){var c=null;if(n.ctrl&&g){c="ToggleSelect";}else{if(n.shift&&g){c="RangeSelect";}else{c="SingleSelect";}}e.execCommand(c,h);return true;}else{if(g){e.execCommand("ClearSelect");}return false;}};W.prototype.execBrowseTreeNode=function R(n){var c=this.props.model;var h=c&&c.findByNodeId(n.nodeId);if(!h){return false;}if(n.popup){var e=mstr.$obj(n.popup);if(e){if(c.execCommand("EditNode",h)){return this.execCommand("OpenPopup",{popup:e,x:n.x,y:n.y,orientation:1});}}}else{if(n.part=="connector"&&n.expandState==0){var g=mstr.Enum.Widget.READYSTATE;switch(h.readyState){case null:case undefined:case g.CANCELLED:case g.ERROR:if(!mstr.$A.len(h.children)){return c.execCommand("FetchFirst",h);}}}else{if(/Fetch/.test(n.part)){return c.execCommand(n.part,h);}}}return false;};W.prototype.execSearch=function C(q){var g=this.props.model;var o=g&&g.getSelectedNode();if(!o){return false;}var e=this.props.searchResultsNode;if(e){g.removeNodesAt([this.getNodePath(e)]);}var n=this.props.searchResultsNode=this._createSearchResultsNode(o,q);if(n){var h=g.get("rootNode");if(!h){return null;}var c=mstr.$A.len(h.children);this.insertNodesAt([searchFolderNode],"0"+mstr.models.AbstractTreeBase.PATHDELIM+c);g.fetchBlock(n.children[0],1,q);}return true;};W.prototype._createSearchResultsNode=function S(n,h){var g=mstr.$H.clone(n);g.value=mstr.$H.clone(n.value);g.parent=null;g.children=[];g.id=null;g.isWithinHierarchy=mstr.utils.ListViewHelper.isWithinHierarchy(n);if(g.isWithinHierarchy){var c=this.props.model;g.hierarchyPath=c&&c._buildHierarchyPathForNode(n);}var e={value:{icon:"f",tp:-1,n:(this.props.descriptors.searchResultsCaption||"Search for:")+" "+h,dssid:null}};e.children=[g];g.parent=e;return e;};W.prototype.onkeypress=function K(o,h){var g=this.getModel();if(!g){return true;}var n=mstr.utils.Events.keyChar(o,h),c=(n==String.fromCharCode(9));if(mstr.Enum.REGEXP_RESERVED_CHARS[n]){n="\\"+n;}g.execCommand("SelectString",n);if(!c){mstr.utils.Events.cancel(o,h);}return c;};W.prototype.onkeydown=function A(o,g){var c=this.getModel();if(!c){return true;}var n=mstr.utils.Events.keyCode(o,g),h=mstr.utils.Events.shiftKey(o,g);switch(n){case 38:this.execSelectPrevious(h);mstr.utils.Events.cancel(o,g);return false;case 40:this.execSelectNext(h);mstr.utils.Events.cancel(o,g);return false;case 37:this.execSelectParent();mstr.utils.Events.cancel(o,g);return false;case 39:this.execSelectChild();mstr.utils.Events.cancel(o,g);return false;default:return true;}};W.prototype.execSelectPrevious=function U(){var c=this.getModel(),e=c&&c.firstSelectionByIndex();if(e&&e.node){if(e.childIndex>0){return c.execCommand("SingleSelect",e.node.parent.children[e.childIndex-1]);}else{if(e.node.parent){return c.execCommand("SingleSelect",e.node.parent);}}}return false;};W.prototype.execSelectNext=function H(){var c=this.getModel(),g=c&&c.lastSelectionByIndex();if(g&&g.node){if((this.getNodeExpandState(g.node)==1)&&g.node.children&&g.node.children[0]){return c.execCommand("SingleSelect",g.node.children[0]);}else{if((g.childIndex>-1)&&g.node.parent&&g.node.parent.children&&g.node.parent.children[g.childIndex+1]){return c.execCommand("SingleSelect",g.node.parent.children[g.childIndex+1]);}else{if(g.parent){var e=mstr.utils.Trees.nextSibling(g.node.parent);if(e){return c.execCommand("SingleSelect",e);}}}}}return false;};W.prototype.execSelectParent=function E(){var c=this.getModel(),e=c&&c.getSelectedNodes(),g=c&&c.getSelectedNode();if(g&&mstr.$H.lenGreaterThan(e,1)){if(g.parent){return c.execCommand("SingleSelect",g.parent);}}else{if(g){if(this.getNodeExpandState(g)==1){this.setNodeExpandState(g,0);}else{if(g.parent){return c.execCommand("SingleSelect",g.parent);}}}}return false;};W.prototype.execSelectChild=function L(){var c=this.getModel(),e=c&&c.getSelectedNodes(),g=c&&c.getSelectedNode();if(g&&!mstr.$H.lenGreaterThan(e,1)){switch(this.getNodeExpandState(g)){case 0:this.setNodeExpandState(g,1);if(g.readyState==null){if(!mstr.$A.len(g.children)){return c.execCommand("FetchFirst",g);}}break;case 1:default:if(g.children&&g.children[0]){return c.execCommand("SingleSelect",g.children[0]);}break;}}return false;};W.prototype.getNodeExpandState=function O(g){var e=mstr.utils.ListViewHelper.getItemRenderer(this),c=this.getModel();if(c&&e&&e.findLocationForNode&&e.getNodeExpandState){var h=e.findLocationForNode(this.props.treeRootParent,c.getNodePathIndices(g));if(h&&h.before){return e.getNodeExpandState(h.before);}}};W.prototype.setNodeExpandState=function J(g,h){var e=mstr.utils.ListViewHelper.getItemRenderer(this),c=this.getModel();if(c&&e&&e.markNodeExpandState&&e.findLocationForNode){var n=e.findLocationForNode(this.props.treeRootParent,c.getNodePathIndices(g));return e.markNodeExpandState(this,c,this.props.element,{el:n.before,state:h,scroll:true});}};W.prototype.getExtraNodeCssClass=function X(h){var g="",e=this.props.singleFilterCssClass,c=h&&h.value;if(e&&(c&&(c.stp==256||c.tp==1))){var m=h.parent&&h.parent.value;if(m&&m.filters&&m.filters.length==1){g=e;}}return g;};function W(c){mstr.views.BaseView.apply(this,[c]);}return W;})();mstrSelectionsImpl.prototype={};mstrSelectionsImpl.prototype.length=0;mstrSelectionsImpl.prototype.path="";mstrSelectionsImpl.prototype.dragX=0;mstrSelectionsImpl.prototype.dragY=0;mstrSelectionsImpl.prototype.mousedownX=0;mstrSelectionsImpl.prototype.mousedownY=0;mstrSelectionsImpl.prototype.shiftKey=false;mstrSelectionsImpl.prototype.ctrlKey=false;mstrSelectionsImpl.prototype.clickedSrc=null;mstrSelectionsImpl.prototype.onload=function(A){};mstrSelectionsImpl.prototype.onmousedown=function(B){try{if(!B){B=window.event;}getMouse(B);this.mousedownX=lMouseX;this.mousedownY=lMouseY;}catch(A){microstrategy.errors.log(A);}};mstrSelectionsImpl.prototype.onmouseup=function(C,B){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener((B)?B:this,"mousemove");this.parentBone.detachWinListener((B)?B:this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.ondeselect=function(B){try{if(B.e){B=B.e;}this.onmouseup(B);if(this.clickedSrc!=null){this.remove(this.clickedSrc);}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.ondragstart=function(C){try{if(!C){C=window.event;}if(C.e){C=C.e;}getMouse(C);if(Math.abs(lMouseX-this.mousedownX)>=3||Math.abs(lMouseY-this.mousedownY)>=3){microstrategy.eventManager.onnotifydrag(this.items,this.parentBone,this.getDssTypes());var A=microstrategy.getEventHandlerString(this.path);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","ondrag");this.parentBone.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",A+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",A+" { return "+this.path+".ondragend(e); }");}this.ondrag(C);}}catch(B){microstrategy.errors.log(B);}return false;};mstrSelectionsImpl.prototype.ondrag=function(A){};mstrSelectionsImpl.prototype.ondragend=function(A){};mstrSelectionsImpl.prototype.add=function(B){try{this.items[B.getAttribute("id")]=B;this.length++;if(this.parentBone&&this.parentBone.onselectionchange){this.parentBone.onselectionchange();}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.remove=function(B){try{delete this.items[B.getAttribute("id")];this.length--;if(this.parentBone.onselectionchange){this.parentBone.onselectionchange();}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.clear=function(C,B){try{if(C==null){C=true;}this.items={};this.length=0;if(C&&this.parentBone&&this.parentBone.onselectionchange){this.parentBone.onselectionchange(B);}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.firstItem=function(){try{for(member in this.items){return this.items[member];break;}}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.isMulti=function(){try{return(this.length>1);}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.isSelected=function(B){try{return(typeof (this.items[B.getAttribute("id")])!="undefined");}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.isActive=function(){try{return(this.length>0);}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.getTypes=function(){try{var A=[];var B=0;for(var D in this.items){if(this.items[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)){A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_OBJTYPE)+"."+this.items[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}else{A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_OBJTYPE);}}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.isSameType=function(){try{var A=this.getDssTypes();A.sort(function(D,C){return parseInt(D)-parseInt(C);});return(A[0]==A[A.length-1]);}catch(B){microstrategy.errors.log(B);return null;}};mstrSelectionsImpl.prototype.isOnlyMetrics=function(){try{for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_METRIC&&this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_USER_METRIC&&this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_USER_SUMMARY_METRIC){return false;}}return true;}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getDssTypes=function(){try{var A=[];var B=0;for(var D in this.items){A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.getSelectedIds=function(){try{var C="|";for(var B in this.items){C+=B+"|";}return C;}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.getDataSetIDs=function(){try{var B=[];var C=0;for(var E in this.items){var A=new mstrObjectInfoImpl(this.items[E]);B[C++]=A.dSetId;}return B;}catch(D){microstrategy.errors.log(D);return null;}};mstrSelectionsImpl.prototype.getSelectionsKey=function(){try{var A=[];var B=0;for(var D in this.items){A[B++]=this.items[D].id;}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.getFirstObjSubType=function(){try{var A=null;var C=this.firstItem();if(C){A=C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrSelectionsImpl.prototype.getFirstObjType=function(){try{var A=null;var C=this.firstItem();if(C){A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrSelectionsImpl.prototype.getChildren=function(B){try{return B.parentNode.parentNode.lastChild.getElementsByTagName("span");}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getItems=function(){try{return mstr.utils.Arrays.fromHashValues(this.items);}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getInnerRect=function(D){try{var C=microstrategy.styleObj;var B={};B.left=getObjSumLeft(D);B.top=getObjSumTop(D);if(bIsIE6){B.right=B.left+getObjWidth(D);B.bottom=B.top+getObjHeight(D);}else{B.left+=D.clientLeft;B.top+=D.clientTop;B.right=B.left+C.getInnerWidth(D);B.bottom=B.top+C.getInnerHeight(D);}if(B.right<(B.left+1)){B.right=B.left+1;}if(B.bottom<(B.top+1)){B.bottom=B.top+1;}return B;}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getOuterRect=function(D,A){try{var C={};if(D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==null){C.left=getObjSumLeft(D);C.top=getObjSumTop(D);}else{C.left=getObjSumLeftScrolled(D);C.top=getObjSumTopScrolled(D,A);}C.right=Math.max(C.left+getObjWidth(D),C.left+1);C.bottom=Math.max(C.top+getObjHeight(D),C.top+1);return C;}catch(B){microstrategy.errors.log(B);return null;}};function mstrSelectionsImpl(A){this.items={};this.parentBone=A;return this;}mstrContextMenuManagerImpl.prototype=new Object();contextMenuManagerScript=true;mstrContextMenuManagerImpl.prototype.id=null;mstrContextMenuManagerImpl.prototype.dynamic_menus=new Array;mstrContextMenuManagerImpl.prototype.menu_items=new Array;microstrategy.contextMenuManagers=new Array;microstrategy.unloadContextMenuManager=function(B){for(var A=0;A<microstrategy.contextMenuManagers.length;A++){if(microstrategy.contextMenuManagers[A].id==B){microstrategy.contextMenuManagers.splice(A,1);}}};microstrategy.getContextMenuManager=function(B){for(var A=0;A<microstrategy.contextMenuManagers.length;A++){if(microstrategy.contextMenuManagers[A].id==B){return microstrategy.contextMenuManagers[A];}}var C=new mstrContextMenuManagerImpl(B);microstrategy.contextMenuManagers.push(C);return C;};mstrContextMenuManagerImpl.prototype.getMenu=function(D){var C,A;try{if(D){for(C=0;C<this.dynamic_menus.length;C++){if(this.dynamic_menus[C]!=null){if(this.dynamic_menus[C][0]==D){return new mstrContextMenuImpl(this.id,this.menu_items,this.dynamic_menus[C][1]);}}}}var B=this.dynamic_menus.length;this.dynamic_menus[B]=new Array;this.dynamic_menus[B][0]=D;this.dynamic_menus[B][1]=new Array;return new mstrContextMenuImpl(this.id,this.menu_items,this.dynamic_menus[B][1]);}catch(E){microstrategy.errors.log(E);return false;}};mstrContextMenuManagerImpl.prototype.findMenuItem=function(C,B){try{var A=new Array();if(B!=null){for(i=0;i<B.length;i++){if(this.menu_items[B[i]][0]==C){A.push(this.menu_items[B[i]]);}}}else{for(i=0;i<this.menu_items.length;i++){if(this.menu_items[i][0]==C){A.push(this.menu_items[i]);}}}return A;}catch(D){microstrategy.errors.log(D);return false;}};function mstrContextMenuManagerImpl(key){try{if(key){if(eval("(typeof("+key+") != 'undefined')")){this.menu_items=eval(key);}if(eval("(typeof("+key+"_dyn) != 'undefined')")){this.dynamic_menus=eval(key+"_dyn");}this.id=key;}return this;}catch(err){microstrategy.errors.log(err);return false;}}mstrDocSelectionsImpl.prototype=new mstrSelectionsImpl();mstrDocSelectionsImpl.prototype.resize=null;mstrDocSelectionsImpl.prototype.range=new Rect(null,null,null,null);mstrDocSelectionsImpl.prototype.handles={};mstrDocSelectionsImpl.prototype.hilites={};mstrDocSelectionsImpl.prototype.sections={};mstrDocSelectionsImpl.prototype.dragRectangles=null;mstrDocSelectionsImpl.prototype.objCache={copyBuffer:null,activeHilite:null,resizeStyle:null,hiLite:null,lineHiLite:null};mstrDocSelectionsImpl.prototype.marquee=null;mstrDocSelectionsImpl.prototype.marqueeConstrained=false;mstrDocSelectionsImpl.prototype.marqueeSingleClick=true;mstrDocSelectionsImpl.prototype.marqueeOrientation=mstrDocSelectionsImpl.MARQUEE_ORIENTATION_V;mstrDocSelectionsImpl.prototype.styleObj=null;mstrDocSelectionsImpl.prototype.path="";mstrDocSelectionsImpl.prototype.verifiedPath="";mstrDocSelectionsImpl.prototype.selectionOpacity=40;mstrDocSelectionsImpl.prototype.topBorderOffset=0;mstrDocSelectionsImpl.prototype.leftBorderOffset=0;mstrDocSelectionsImpl.prototype.savedZIndex=0;mstrDocSelectionsImpl.prototype.docViewer=null;mstrDocSelectionsImpl.prototype.isVisible=true;mstrDocSelectionsImpl.prototype.isSingleSelectionType=true;mstrDocSelectionsImpl.prototype.panelUnitFormat=0;mstrDocSelectionsImpl.prototype.panelValueFormat=0;mstrDocSelectionsImpl.prototype.controlUnitFormat=0;mstrDocSelectionsImpl.prototype.controlValueFormat=0;mstrDocSelectionsImpl.prototype.allGridUnitFormat=microstrategy.GRID_UNIT_CONTAINER;mstrDocSelectionsImpl.prototype.allGridValueFormat=5;mstrDocSelectionsImpl.prototype.gridUnitFormat=microstrategy.GRID_OTHER;mstrDocSelectionsImpl.prototype.gridValueFormat=5;mstrDocSelectionsImpl.prototype.gridUnitFormatX=microstrategy.GRID_UNIT_CONTAINER;mstrDocSelectionsImpl.prototype.gridValueFormatX=1;mstrDocSelectionsImpl.prototype.addingCtrl=null;mstrDocSelectionsImpl.MARQUEE_ORIENTATION_V=1;mstrDocSelectionsImpl.MARQUEE_ORIENTATION_H=2;mstrDocSelectionsImpl.NOBORDERS=0;mstrDocSelectionsImpl.TOPBORDER=1;mstrDocSelectionsImpl.BOTTOMBORDER=2;mstrDocSelectionsImpl.LEFTBORDER=4;mstrDocSelectionsImpl.RIGHTBORDER=8;mstrDocSelectionsImpl.ALLBORDERS=16;mstrDocSelectionsImpl.DEFAULT_LINE_COLOR="#000000";mstrDocSelectionsImpl.DEFAULT_LINE_STYLE="solid";mstrDocSelectionsImpl.DEFAULT_LINE_WIDTH="1pt";mstrDocSelectionsImpl.TCF={font:"ff",BoldItalic:["fb","fi"],fsize:"fs",TextUnderline:"ful",TextStrikeout:"fso",color:"fc",FillColor:"bgc",ShapeSettingStyle:"bs",LineSettingColor:"bc",LineSettingWeight:"bw"};mstrDocSelectionsImpl.prototype.onload=function(F){try{var C=this.parentBone;this.docViewer=C.parentBone;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.elem.onmousedown=new Function("e",this.verifiedPath+" { return "+this.path+".onmousedown(e); }");this.elem.onclick=new Function("e",this.verifiedPath+" { return "+this.path+".onclick(e); }");var E=(this.firstItem()!=null);if(E){this.onreload(F);}this.resize=new mstrResizeDocObjs();this.resize.onload(this,this.path+".resize");this.styleObj=C.styleObj;this.initCopyBuffer();var G=function(I){var J=parseFloat(C.elem.style["border"+I+"Width"]);if(isNaN(J)){return 0;}return Math.round(J*microstrategy.DPI_CONVERSION/72);};this.topBorderOffset=G("Top");this.leftBorderOffset=G("Left");var H=document.createElement("div");H.className="mstrMarquee";H.style.position="absolute";H.style.display="none";var B=document.createElement("span");B.className="mstrMarqueeWhite";H.appendChild(B);var A=document.createElement("span");A.className="mstrMarqueeBlack";H.appendChild(A);document.body.appendChild(H);this.marquee=H;this.dragRectangles=microstrategy.objectFind(C.elem,"div",microstrategy.OBJTYPE_DSEL_MOVE_RECS);return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocSelectionsImpl.prototype.onreload=function(B){try{this.clear(true);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isFeatureAvailable=function(B){try{return this.docViewer.isFeatureAvailable(B);}catch(A){microstrategy.errors.log(A);}return true;};mstrDocSelectionsImpl.prototype.isScrollOrHyperlink=function(C,B){try{if(!B||B.onscroll!=null){return true;}var D=function(E){return E.tagName.toLowerCase()=="a"&&((E.href!=null&&E.href!="")||(E.getAttribute("href")!=null&&E.getAttribute("href")!=""));};return(C.button!=2&&(D(B)||D(B.parentNode)));}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isTableControl=function(C){try{var B=microstrategy.findBone(C);return B&&B.isTable;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.onmousedown=function(O){try{microstrategy.hidePopups(null,O);if(window.mstrButton){mstrButton.syncEditHighlight(O);}O=O||window.event;var M=getEventTarget(O);try{if(!M||!M.tagName){return true;}}catch(E){O.cancelBubble=true;return true;}if(this.isScrollOrHyperlink(O,M)){return true;}if(M.getAttribute(microstrategy.HTMLATTR_ID)&&M.getAttribute(microstrategy.HTMLATTR_ID).indexOf("MstrFlash")==0||M.attributes.getNamedItem("type")&&M.attributes.getNamedItem("type").value.indexOf("flash")>-1){return true;}if(microstrategy.subObjectType(M)=="shw"&&M.nextSibling){M=M.nextSibling;}mstrSelectionsImpl.prototype.onmousedown.call(this,O);this.mousedownScrollLeft=this.docViewer.elem.scrollLeft;this.mousedownScrollTop=this.docViewer.elem.scrollTop;this.lastMouseX=this.mousedownX;this.lastMouseY=this.mousedownY;var D=microstrategy.findAncestor(M);if(D&&D.tagName.toLowerCase()=="img"){D=microstrategy.findAncestor(D.parentNode);}var N=(microstrategy.objectType(D)==microstrategy.OBJTYPE_FLOATING_TOOLBAR);var B,J;if(D){var H=microstrategy.subObjectType(D);if(N){J=microstrategy.bone(M.getAttribute("targetBoneId")).activeRWUnit;}else{if(H==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||H==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){B=microstrategy.findRWObjectBone(M);if(B){J=B.activeRWUnit;}}else{if(H==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){B=microstrategy.findRWObjectBone(D,"mstrGridRW")||microstrategy.findRWObjectBone(D,"mstrReportGraphImpl");if(B){if((microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE)&&!B.boneSelected&&B.sibBoneSelected&&B.sibBoneSelected()){return true;}J=B.activeRWUnit;}}}}}var A=microstrategy.eventManager;var F=A.getSource(O,J);var L=microstrategy.getContextMenuManager("RWM").getMenu("rw_context_menu");var R=this.path+".getTypes()";var P=this.parentBone.currentControl;var Q=F.bone&&F.bone.isTable;switch(F.type){case microstrategy.OBJTYPE_DOC_SELECTION:if(P!="cursor"){return true;}if(microstrategy.subObjectType(M)==microstrategy.SUBOBJTYPE_SEL_HANDLE&&P=="cursor"){if(this.getSelectedGrid()==null||(this.getPortalGridWithProperty(microstrategy.WINDOW_STATE_MAXIMIXED)==null&&this.getPortalGridWithProperty(microstrategy.WINDOW_STATE_MINIMIZED)==null)){this.objCache.activeHilite=M.parentNode;var C=M.className+"-resize";var K=C.slice(0,C.indexOf("-"));if(typeof (mstr)!="undefined"){this.activeHandle=K;this.parentBone.attachWinListener(this,"mousemove","onresizestart");this.parentBone.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".resize.onresizestart(e, '"+K+"'); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}}break;}L.registerTrigger(F.elem,R);F=A.getSource(O,M.src);case microstrategy.OBJTYPE_DOC_OBJECT:if(P=="cursor"){if(F.button!=1){this.addToSelection(O.ctrlKey,F.elem);if(!N&&Q){return true;}if(bIsW3C&&microstrategy.subObjectType(F.elem)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){this.elem.style.zIndex=1;}L.registerTrigger(document.getElementById("hilite"+F.id),R);L.registerTrigger(F.elem,R);if(N){L.registerTrigger(D,R);}return false;}var G=this.getHyperLink(F);if(G!=null&&G.length>0){return false;}var I=N||(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)||(F.subType!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)||(F.subType==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&(D==M||M.getAttribute("scriptclass")));if(I){this.addToSelection(O.ctrlKey,F.elem);if(Q&&!N){return true;}if(!this.isLocked(F.elem)&&this.isActive()&&this.docViewer.isEditableViewModeEplus()){this.clickedSrc=F.elem;if(N||F.subType!=microstrategy.SUBOBJTYPE_DOC_TEMPLATE||!(F.bone&&F.bone.isGraph)){if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","ondragstart");this.parentBone.attachWinListener(this,"mouseup","onmouseup",false);}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondragstart(e); }");if(document.onmouseup==null){document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}}}}}if(F.subType==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||mstr.utils.ISIE9&&F.subType==microstrategy.SUBOBJTYPE_DOC_TEXT||(Q&&N)){return true;}else{O.cancelBubble=true;mstr.controllers.EventManager.notifyWindowListeners({name:"closeMenus"});return false;}}case microstrategy.OBJTYPE_DOC_SUBSECTION:this.activeSubsection=(F.type!=microstrategy.OBJTYPE_DOC_SUBSECTION)?microstrategy.findAncestor(F.elem.parentNode):A.getSource(O).elem;if(F.button!=1){L.registerTrigger(this.activeSubsection,R);}this.marqueeConstrained=this.marqueeSingleClick=false;if(mstr.behaviors.featureResolver.featAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS)){if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","onlassostart");this.parentBone.attachWinListener(this,"mouseup","onlassoabort");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".onlassostart(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onlassoabort(e); }");}}return false;break;case microstrategy.OBJTYPE_RULER:if(P=="cursor"){this.activeSubsection=null;this.marqueeConstrained=this.marqueeSingleClick=true;this.marqueeOrientation=(F.subType==microstrategy.SUBOBJTYPE_VRULER)?mstrDocSelectionsImpl.MARQUEE_ORIENTATION_V:mstrDocSelectionsImpl.MARQUEE_ORIENTATION_H;this.onlassostart(O);return false;}break;default:if(mstrGridStatic.isMouseOverScrollBar(M,this.mousedownX,this.mousedownY)){return true;}}return(!bIsW3C);}catch(E){microstrategy.errors.log(E);return false;}};mstrDocSelectionsImpl.prototype.onmouseup=function(C,B){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener((B)?B:this,"mousemove");this.parentBone.detachWinListener((B)?B:this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}this.hideGuidelines();}catch(A){microstrategy.errors.log(A);}return false;};mstrDocSelectionsImpl.prototype.getSnapThreshold=function(B){try{return this.getNotUseSnap(B)?5:microstrategy.SNAP_SIZE;}catch(A){microstrategy.errors.log(A);}};mstrDocSelectionsImpl.prototype.getMouseDirection=function(){try{var B=lMouseX-this.lastMouseX,A=lMouseY-this.lastMouseY;this.mouseDir={x:B>0?1:(B<0?-1:1),y:A>0?1:(A<0?-1:1)};this.lastMouseX=lMouseX;this.lastMouseY=lMouseY;return this.mouseDir;}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.getSubSecBone=function(B){try{var A=null;if(B){if(B.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){A=microstrategy.findBone(B.parentNode);}else{A=microstrategy.findBone(B);}}else{var D=this.parentBone.parentBone.commands.queryState("selectedSection");if(D){A=microstrategy.findBone(D);}}return A;}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.syncPositionMap=function(){try{var B=this.items;for(var E in B){var D=B[E];var A=this.getSubSecBone(D);A&&A.syncPositionMap(D);}}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.hideGuidelines=function(){try{var B=this.items;for(var E in B){var D=B[E];var A=this.getSubSecBone(D);A&&A.hideGuidelines();}}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.onresizestart=function(A){this.parentBone.detachWinListener(this,"mousemove");this.resetObjectFormatLevel();this.docViewer.isDragging=true;return this.resize.onresizestart(A,this.activeHandle);};mstrDocSelectionsImpl.prototype.onclick=function(E){try{E=E||window.event;var G=getEventTarget(E);var B=G&&G.tagName.toLowerCase();if(B==="select"||B==="textarea"||B==="input"){return true;}if(this.isScrollOrHyperlink(E,G)){return true;}var A=this.parentBone.currentControl;var F=microstrategy.eventManager.getSource(E);switch(F.type){case microstrategy.OBJTYPE_DOC_SELECTION:if(A!="cursor"){return true;}F=microstrategy.eventManager.getSource(E,G.src);case microstrategy.OBJTYPE_DOC_OBJECT:if(A=="cursor"){if(F.button>1){return true;}var D=this.getHyperLink(F);if(D!=null&&D.length>0){try{if(!E.shiftKey&&this.styleObj.getAttValue(F.elem,microstrategy.HTMLATTR_NEW_WINDOW)==microstrategy.FALSE){window.location=D;}else{window.open(D);}}catch(C){if(D.length<=2082){microstrategy.errors.log(C);}else{showMessage({contents:microstrategy.descriptors.getDescriptor("4420"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}}}return(F.subType==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);}default:if(typeof (mstrGridStatic)!="undefined"&&mstrGridStatic.isMouseOverScrollBar(G,this.mousedownX,this.mousedownY)){return true;}}return(!bIsW3C);}catch(C){microstrategy.errors.log(C);return true;}};mstrDocSelectionsImpl.prototype.onnotifydrag=function(A,C,B){this.savedZIndex=this.elem.style.zIndex;this.elem.style.zIndex=1;};mstrDocSelectionsImpl.prototype.onnotifydragend=function(A){this.elem.style.zIndex=this.savedZIndex;};mstrDocSelectionsImpl.prototype.isLocked=function(B){try{return this.styleObj.getAttValue(B,microstrategy.HTMLATTR_LOCKED)==microstrategy.TRUE;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.onpanelchange=function(){try{if(!this.isActive()){return ;}if(!isInDocument(this.firstItem())){this.clear();return ;}var E=this.firstItem();if(!E||!E.parentNode){return ;}var C=microstrategy.findAncestor(E.parentNode);if(!C||!C.parentNode){return ;}var D=microstrategy.findAncestor(C.parentNode);if(!D||microstrategy.subObjectType(D)!=microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){return ;}var A=microstrategy.findBone(C.parentNode).isPanelCurrent(C.getAttribute("id"));if(this.isVisible!=A){this.isVisible=A;this.elem.style.display=(A)?"block":"none";if(this.docViewer.observer){this.docViewer.delay("observer.notifyAll('onselectionchange')");}}microstrategy.eventManager.notifyOrphanBones("onbone"+((A)?"":"de")+"selected",this.getSelectedIds());}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.getHyperLink=function(F){try{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){return"";}var E=(this.styleObj.getAttValue(F.elem,microstrategy.HTMLATTR_IS_LINK)==microstrategy.TRUE);if(E){var C=this.styleObj.getAttValue(F.elem,microstrategy.HTMLATTR_LINK_HREFVALUE);if((C==null||C.length==0)&&microstrategy.subObjectType(F.elem)==microstrategy.SUBOBJTYPE_DOC_TEXT){var D=decode(this.styleObj.getAttValue(F.elem,microstrategy.HTMLATTR_DSS_FORMULA));var B=D&&D.match(/href="([^"]+)"/i);C=B&&B[1];}return C;}}catch(A){microstrategy.errors.log(A);}return"";};mstrDocSelectionsImpl.prototype.addToSelection=function(B,E){try{if(microstrategy.subObjectType(E)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var D=microstrategy.findBone(E);if(D){D.gridUnitFormat=microstrategy.GRID_UNIT_CONTAINER;this.gridUnitFormatX=microstrategy.GRID_UNIT_CONTAINER;if(D.isGridInCellSelectionMode&&D.isGridInCellSelectionMode()){D.selections.clearAll(true);}}}if(this.isSelected(E)){if(B){if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mouseup","ondeselect");}else{document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondeselect(e); }");}return ;}else{this.hiliteSelected(E);}}else{if(!B||(this.isActive()&&this.firstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION)){this.clear(true);this.add(E);}else{if(this.isActive()){var A=this.processAddToSelections(E);if(A){this.add(A);}}else{this.add(E);}this.onpanelchange();}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.getPeerSubsection=function(B,D){try{var A=microstrategy.findBone(B.elem.parentNode);if(A==null||(A.type!=microstrategy.OBJTYPE_PANEL_STACK&&A.type!=microstrategy.OBJTYPE_DOC_SUBSECTION)){return null;}else{if(A.id==D){return B;}else{return this.getPeerSubsection(A,D);}}}catch(C){microstrategy.errors.log(C);return null;}};mstrDocSelectionsImpl.prototype.performDrill=function(C,D){try{for(var B in this.items){if(D){window.open(C);}else{window.location=C;}}}catch(A){microstrategy.errors.log(A);}};mstrDocSelectionsImpl.prototype.initEventObject=function(C,A){try{C=C||window.event;if(C.e){C=C.e;}if(A){getMouse(C);}return C;}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.ondragstart=function(F){try{F=this.initEventObject(F,true);for(var E in this.items){var D=this.items[E];var A=microstrategy.findBone(D);if(A&&A.isFilterPanel){A.secIdBeforeDrag=D.parentNode.parentNode.parentNode.id;}}if(this.getPortalGridWithProperty(microstrategy.WINDOW_STATE_MAXIMIXED)!=null){return ;}if(lMouseX==this.mousedownX&&lMouseY==this.mousedownY){return ;}this.docViewer.isDragging=true;this.buildDragRectangles();var B=this.parentBone;if(typeof (mstr)!="undefined"){B.attachWinListener(this,"mousemove","ondrag");B.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondragend(e); }");}microstrategy.eventManager.onnotifydrag(this.items,B,this.getDssTypes());B.parentBone.turnOnRulerShade(this.range);this.bubbleMouseMoves=false;if(bIsIE6){var G=getEventTarget(F);if(G&&G.tagName&&(G.tagName.toLowerCase()=="img")){this.bubbleMouseMoves=true;this.mouseoverMask=null;}}this.ondrag(F);}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.getNotUseSnap=function(A){return(A&&A.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF;};mstrDocSelectionsImpl.prototype.ondrag=function(U){try{if(bIsIE4&&getButtonId(U)==0){this.ondragend(U);}U=this.initEventObject(U,true);var S=getEventTarget(U);if(this.bubbleMouseMoves){var T=this.mouseoverMask;if(T&&(T!=S)&&T.onmouseout){T.onmouseout(U);}if(S&&S.onmouseover){S.onmouseover(U);this.mouseoverMask=S;}}var G=microstrategy.eventManager.source;var B=this.parentBone;var O=this.dragRectangles;var J=O.firstChild;var M=this.range;var N=this.getNotUseSnap(U);var H=function(Z){O.style.left=0;O.style.top=0;B.parentBone.dragRulerShade(M.left+B.left,Z,M);};if(!S.getAttribute||lMouseX<B.left||lMouseX>B.left+getObjWidth(B.dockMask)){H((this.isSameSubSection())?M.top+B.top:-10000);return false;}var K=S.getAttribute&&S.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT);if(K){var V=microstrategy.findBone(document.getElementById(K));M.offsetSection=V;if(bIsIE6&&V.isDetails){var W=","+this.getTypes().toString()+",";if(W.contains(microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE,",")||W.contains(microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK,",")){B.elem.style.cursor="not-allowed";}}}var P=S.id||K;var D=getObjSumTop(M.offsetSection.elem);var R=lMouseX-G.mousedownX;var L=M.top+B.top-D;this.getMouseDirection();var X=M.offsetSection;var E=function(c,g,o){var e=this.mouseDir[o],Z=c.style,h=o=="x"?"left":"top";if(X.canShowGuideline()){var n=X["guidelineOffset"+o.toUpperCase()],m=this.getSnapThreshold();if(Math.abs(n)<m&&(n!=0&&(n>0&&e<0||n<0&&e>0))){n*=e*(n>0&&e<0?1:-1);n+=(N?(e*(n>0&&e<0?1:-1)):0);g=g+n;Z[h]=g+"px";return ;}}var a=parseInt(Z[h])||0;if(e<0&&g<a||e>0&&g>a){Z[h]=g+"px";}};if(R!=0&&(this.isSameSubSection()||!this.hasHorizSections())){var Y=0;if(B.containsHorizontalSections&&S&&S.getAttribute(microstrategy.HTMLATTR_POINTS_TO)){var Q=S.getAttribute(microstrategy.HTMLATTR_POINTS_TO).split("|");var A=B.getSubMaskBone(Q[0],Q[1],0);if(A&&A.maskedBone!=null){Y=getObjSumLeft(A.maskedBone.elem)-B.left;}}if(R<-M.left+this.leftBorderOffset){R=-M.left+this.leftBorderOffset;}else{R=microstrategy.snapCoordinate(R+(M.left+this.leftBorderOffset-Y),0,!N);}R=Math.max(R,0);var C=R-(M.left+this.leftBorderOffset-Y);E.call(this,O,C,"x");}else{R=M.left+B.left-getObjSumLeft(M.offsetSection.elem);}if((lMouseY-G.mousedownY)!=0&&(this.isSameSubSection()||this.hasHorizSections(true))){L=(lMouseY-G.mousedownY);if(lMouseY<B.top||lMouseY>B.top+getObjHeight(B.dockMask)){H(M.top+B.top);return false;}if(L<-M.top){L=-M.top;}else{L=microstrategy.snapCoordinate((M.top+L-(D-B.top)),0,!N);}L=Math.max(L,0);var I=L-(M.top-(D-B.top));E.call(this,O,I,"y");}B.parentBone.dragRulerShade(R+B.left,L+D,M);X.showGuidelines(X.getLocalPosition(O.firstChild));}catch(F){microstrategy.errors.log(F);}return false;};mstrDocSelectionsImpl.prototype.ondragend=function(G){try{G=this.initEventObject(G,true);this.onmouseup(G);var J=this.parentBone;J.elem.style.cursor="default";var B=getEventTarget(G);var M=microstrategy.boneForMask(microstrategy.findAncestor(B));if(M){var K=M.elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(K==microstrategy.OBJTYPE_OBJBROWSER){J.promptDeleteItems(this.items,true);}else{if(K==microstrategy.OBJTYPE_DOC_SUBSECTION){if(M.isFilterPanel){this.moveItemsToFP(B);}else{this.moveItems(B);}}}}else{if(bIsW3C&&!bIsIE4){var P=J.getMaskFromPoint(lMouseX,lMouseY);if(P!=null){this.moveItems(P.firstChild);}else{if(microstrategy.isObjectBrowserOpen()){M=microstrategy.getObjectBrowser();if(M!=null){if(microstrategy.doRectsIntersect(new Rect(lMouseY,lMouseX+1,lMouseY+1,lMouseX),microstrategy.getRect(M.elem))){J.promptDeleteItems(this.items,true);}}}}}}var E=this.dragRectangles;E.style.zIndex=-1;mstr.$D.clearChilds(E);E.style.left=0;E.style.top=0;this.onmoveend();microstrategy.eventManager.notifyOrphanBones("onnotifydragend",J);for(var O in this.items){var D=this.items[O];var I=microstrategy.findBone(D);if(I&&I.isFilterPanel){var N=D.parentNode.parentNode.parentNode.id;if(N!=I.secIdBeforeDrag){var H=J.docMaskCollection;var L=I.panels;for(var C in L){var A=L[C].id;if(H[I.secIdBeforeDrag]&&H[I.secIdBeforeDrag][A]){if(!H[N]){H[N]={};}H[N][A]=H[I.secIdBeforeDrag][A];delete H[I.secIdBeforeDrag][A];}}}}}this.docViewer.isDragging=false;this.syncPositionMap(this.items);}catch(F){microstrategy.errors.log(F);}return false;};mstrDocSelectionsImpl.prototype.hiliteLine=function(B,D,A){try{B.style.border="0";B.style["border"+((this.styleObj.getAttValue(D,microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_VERTICAL)?"Left":"Top")]=A;}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.toggleHiliteBorders=function(D){try{var B=0;var E=-2;if(D){B=1;E=2;}B+="px dashed #000000";for(var F in this.hilites){var A=this.hilites[F].getDefault();if(microstrategy.subObjectType(A.src)==microstrategy.SUBOBJTYPE_DOC_LINE){this.hiliteLine(A,A.src,B);}else{A.style.border=B;A.style.width=Math.max(1,parseInt(A.style.width)-E)+"px";A.style.height=Math.max(1,parseInt(A.style.height)-E)+"px";A.style.visibility=D?"visible":"";this.hilites[F].syncHandles(D);}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.buildDragRectangles=function(){try{var F=function(J){return parseInt(C.getAttribute("o"+J)||0,10);};var I="mstrMarquee";for(var B in this.hilites){var C=this.hilites[B].getDefault();if(C){var A=C.src;if(this.isLocked(A)){continue;}var D=document.createElement("div");D.className=I;D.style.left=C.style.left;D.style.top=C.style.top;var H=document.createElement("span");H.className=I+"White";D.appendChild(H);var G=document.createElement("span");G.className=I+"Black";D.appendChild(G);this.resizeMarquee(D,F("Height"),F("Width"));this.dragRectangles.appendChild(D);}}this.dragRectangles.style.zIndex=50;}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.onmoveend=function(){if(this.docViewer.rulerShadeOn){this.docViewer.turnOffRulerShade();}};mstrDocSelectionsImpl.prototype.onlassoabort=function(H){try{H=this.initEventObject(H,true);this.onmouseup(H);if(this.parentBone.currentControl!="cursor"){var G=this,E=this.parentBone,D=function(){if(E.currentControl!="cursor"){G.addCtrl(new Rect(lMouseY-2,null,null,lMouseX-2),(H.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF);}};if((!window.mstrmojo||!mstrmojo.platform.TableControl)&&E.currentControl==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&E.currentControlSubtype=="TC"){microstrategy.mojoLoader.loadWidget({bundle:"mojo-tc.js",callback:function(){D();}});}else{D();}}else{var C=microstrategy.findAncestor(this.activeSubsection.parentNode);var A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(A==microstrategy.OBJTYPE_DOC_SUBSECTION_CONTAINER){this.addSubSection(this.activeSubsection);}else{if(A==microstrategy.OBJTYPE_DOC_OBJECT){var B=microstrategy.getRegisteredAncestor(C);if(B.activeRWUnit){C=B.activeRWUnit;}this.addToSelection(H.ctrlKey,C);}}}}catch(F){microstrategy.errors.log(F);}return false;};mstrDocSelectionsImpl.prototype.constrainMarquee=function(C){try{var A=this.docViewer.elem;if(this.marqueeOrientation==mstrDocSelectionsImpl.MARQUEE_ORIENTATION_V){C.left=getObjSumLeftScrolled(A);C.right=C.top+getObjWidth(A);}else{C.top=getObjSumTopScrolled(A);C.bottom=C.top+getObjHeight(A);}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.onlassostart=function(F){try{F=this.initEventObject(F,true);var A=this.mousedownX;var G=this.mousedownY;if(!this.marqueeConstrained&&Math.abs(lMouseX-A)<=3&Math.abs(lMouseY-G)<=3){return false;}var D=1,B=1;if(this.marqueeConstrained){var C=new Rect(G,A+B,G+D,A);this.constrainMarquee(C);A=C.left;G=C.top;B=C.right-A;D=C.bottom-G;this.docViewer.turnOnRulerShade(C);}this.resizeMarquee(this.marquee,D,B);this.marquee.style.left=A+"px";this.marquee.style.top=G+"px";this.marquee.style.visibility="hidden";this.marquee.style.display="block";if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","onlasso");this.parentBone.attachWinListener(this,"mouseup","onlassoend");}else{document.onmousemove=new Function("e",'return microstrategy.bone("'+this.docViewer.id+'").doc.selections.onlasso(e);');document.onmouseup=new Function("e",'return microstrategy.bone("'+this.docViewer.id+'").doc.selections.onlassoend(e);');}}catch(E){microstrategy.errors.log(E);}return false;};mstrDocSelectionsImpl.prototype.onlassomarquee=function(L){try{var C=this.marquee;C.style.visibility="visible";var P=lMouseX;var N=lMouseY;var D=this.mousedownX;var O=this.mousedownY;var K=D;var I=O;var H=N-O;var Q=P-D;if(Q<0){D=P;Q=Math.abs(Q);}if(H<0){O=N;H=Math.abs(H);}var A=this.parentBone.currentControl;if(this.marqueeConstrained){var G=new Rect(O,D+Q,O+H,D);this.constrainMarquee(G);D=G.left;O=G.top;Q=G.right-D;H=G.bottom-O;this.docViewer.dragRulerShade(G.left,G.top,G);this.marqueeSingleClick=false;}else{if(A==microstrategy.SUBOBJTYPE_DOC_LINE){C.style.border="";if(Q>=H){O=I;H=1;}else{D=K;Q=1;}}}var J=this;var B=function(R){return window["getObjSum"+R](J.activeSubsection)-J.docViewer.elem["scroll"+R];};if(A!="cursor"){var F=B("Top");if(O<F){H=Math.max(H-F+O,1);O=F;}var M=B("Left");if(D<M){Q=Math.max(Q-M+D,1);D=M;}}C.style.left=D+"px";C.style.top=O+"px";this.resizeMarquee(C,H,Q);}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.onlasso=function(B){try{B=this.initEventObject(B,true);this.onlassomarquee(B);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mouseup","onlassoend");}else{document.onmouseup=new Function("e","return microstrategy.bone('"+this.docViewer.id+"').doc.selections.onlassoend(e);");}}catch(A){microstrategy.errors.log(A);}return false;};mstrDocSelectionsImpl.prototype.onlassoend=function(H){try{H=this.initEventObject(H,true);this.onmouseup(H);if(mstr.utils.ISIE8&&this.marquee.style.height=="1px"&&this.marquee.style.width=="1px"){this.onlassomarquee(H);}if(this.marqueeConstrained){this.docViewer.turnOffRulerShade();}var J=this.getOuterRect(this.marquee),L=this.parentBone;if(L.currentControl!="cursor"){var I=this,K=function(){I.addCtrl(J,I.getNotUseSnap(H));I.marquee.style.display="none";};if((!window.mstrmojo||!mstrmojo.platform.TableControl)&&L.currentControl==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&L.currentControlSubtype=="TC"){microstrategy.mojoLoader.loadWidget({bundle:"mojo-tc.js",callback:K});}else{K();}}else{if(!H.ctrlKey){this.clear();}var F=[];var B=microstrategy[(this.marqueeSingleClick||microstrategy.MARQUEE_STYLE==microstrategy.MARQUEE_STYLE_PARTIAL)?"doRectsIntersect":"isRectInRect"];var D=microstrategy.findBone(this.activeSubsection);var P=(D&&D.subsectionType==mstrSubSection.TYPE_PANEL);var M=(this.isActive()&&microstrategy.findBone(this.firstItem().parentNode));if(M&&M.subsectionType==mstrSubSection.TYPE_PANEL){M.marqueeSelect(F,J,B);}else{if(P&&(!this.isActive()||this.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION)){D.marqueeSelect(F,J,B);}else{var G=this.parentBone.sections;for(var O in G){for(var A in G[O].subsections){var N=G[O].subsections[A];if(N.subsectionType==mstrSubSection.TYPE_FIXED){N.marqueeSelect(F,J,B);}}}}}if(F.length>0){for(var E=0;E<F.length;E++){this[(H.ctrlKey&&this.isSelected(F[E]))?"remove":"add"](F[E]);}}else{if(!this.marqueeConstrained&&!this.isActive()&&!P){this.addSubSection(this.activeSubsection);}}this.marquee.style.display="none";}}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.addCtrl=function(G,F){var K=(this.parentBone.currentControl==microstrategy.GRAPH_CTL);var H=this.parentBone;var D=microstrategy.updateManager;var J;var C=microstrategy.hasAppliedTheme(this.activeSubsection),A=this.parentBone.currentControl,E=(A==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||A==microstrategy.SUBOBJTYPE_DOC_TEXT||A==microstrategy.SUBOBJTYPE_DOC_IMAGE||A==microstrategy.SUBOBJTYPE_DOC_LINE||A==microstrategy.SUBOBJTYPE_DOC_SHAPE||microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);if(!C&&E){var B=this.activeSubsection&&this.activeSubsection.getAttribute("fgKey");if(B&&H.formattingAttributes[B]&&H.formattingAttributes[B]["thmid"]){C=true;}}this.flush=K||(A==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE)||C||(A==microstrategy.SUBOBJTYPE_DOC_IMAGE);var I=microstrategy.findBone(this.activeSubsection);if(I&&I.isFilterPanel){J=H.addCtrl(null,this.activeSubsection,[],null,null,null,true);}else{J=H.addCtrl(G,this.activeSubsection,[],null,null,null,F);}if(J){J=this.finishAdd(this.activeSubsection.lastChild,J);if(J.length>0){D.add(J);}if(K||C||A==microstrategy.SUBOBJTYPE_DOC_IMAGE){D.add([D.createActionObject(H.elem,mstrUpdateManager.APPLY_CHANGES,H.parentBone.beanPath,[],[],[])]);}if(this.flush){D.flushAndSubmitChanges();this.flush=false;}}};mstrDocSelectionsImpl.prototype.getActiveSectionIndex=function(B){try{var A=microstrategy.findAncestorWithAtt(B,"scriptclass","mstrFixedPanel");var D=A&&A.getAttribute("sn");if(D){return D;}}catch(C){microstrategy.errors.log(C);}return null;};mstrDocSelectionsImpl.prototype.resizeMarquee=function(E,D,A){try{E.style.height=D+"px";E.style.width=A+"px";var C=function(H,G){E.childNodes[B].style[H]=(Math.max(G-3,1))+"px";};for(var B=0;B<2;B++){C("height",D);C("width",A);}}catch(F){microstrategy.errors.log(F);}};mstrDocSelectionsImpl.prototype.sizeToGrid=function(){try{var I=[];var C=microstrategy.updateManager;var G=false;var F=this.parentBone;var E=function(K,L){return microstrategy.snapCoordinate(K,L,true);};for(var A in this.items){var J=this.items[A];if(this.isLocked(J)){continue;}var D=new RectObj(J);var H=getObjSumTop(J.parentNode)-F.top;D.setBase(F.left+this.leftBorderOffset,F.top);D.left=E(D.left,0);D.top=E(D.top,H);D.right=E(D.right,0);D.bottom=E(D.bottom,H);D.height=D.bottom-D.top;D.width=D.right-D.left;if(this.resize.resizeItem(J,D,I,microstrategy.WIDTH_AND_HEIGHT_UPDATE)){G=true;}}this.resizeSubSection(false,I);this.resetRange(false,I);if(I&&I.length>0){C.add(I);if(G){C.flushAndSubmitChanges();}}this.syncUp();return true;}catch(B){microstrategy.errors.log(B);return true;}};mstrDocSelectionsImpl.prototype.getEmptyCopyBuffer=function(){return{items:{},parentIds:{},offsets:{},length:0};};mstrDocSelectionsImpl.prototype.initCopyBuffer=function(){try{var cb=document.getElementById("clipboard");if(cb){var buf=this.getEmptyCopyBuffer();eval("buf.offsets = "+cb.getAttribute("offset"));for(var sec in buf.offsets){buf.offsets[sec]=parseInt(buf.offsets[sec])*microstrategy.SNAP_SIZE;}eval("buf.parentIds = "+cb.getAttribute("pk"));for(var i=0,cnt=cb.childNodes.length;i<cnt;i++){var c=cb.childNodes[i];buf.items[c.getAttribute("id")]=c.cloneNode(true);buf.length++;}this.objCache.copyBuffer=buf;}}catch(err){microstrategy.errors.log(err);}};mstrDocSelectionsImpl.prototype.copyToClipboard=function(H){try{var A="";if(this.isActive()&&this.firstObjType()==microstrategy.OBJTYPE_DOC_OBJECT){var E=this.getEmptyCopyBuffer();var D="";for(var B in H){A+=D+B;var F=H[B].cloneNode(true);if(F.getAttribute("trx")==="1"){var I=F.getAttribute("class");F.setAttribute("class",I.replace(/txttrx /,""));mstr.$A.forEach(["trx","trxsid","trxctlkey","trxn","trxdfm"],function(J){F.removeAttribute(J);});}E.items[B]=F;E.parentIds[B]=H[B].parentNode.getAttribute("id");E.length++;D=CLIPBOARD_ITEM_SEPARATOR;}this.objCache.copyBuffer=E;var C=this.docViewer.observer;if(C){C.notifyAll("onaddtoclipboard");}}return A;}catch(G){microstrategy.errors.log(G);}return"";};mstrDocSelectionsImpl.prototype.duplicate=function(){try{if(this.atLeastOneTableSelected()){showMessage({contents:microstrategy.descriptors.getDescriptor("11179"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return false;}if(!this.duplicatePanelStacks()){var B=(this.copy()==false);if(B){return this.paste();}}return false;}catch(A){microstrategy.errors.log(A);return true;}};mstrDocSelectionsImpl.prototype.duplicatePanelStacks=function(){try{var B=this.getTypes();var A=B.join(",").match(new RegExp("("+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+")","g"));if(!A){return false;}if(A.length!=B.length){showMessage({contents:microstrategy.descriptors.getDescriptor("7763"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{var F=this.getSelectedIds().split("|").join(CLIPBOARD_ITEM_SEPARATOR);var C=microstrategy.updateManager;C.add([C.createActionObject(null,mstrUpdateManager.DUPLICATE_PANEL_STACK,this.docViewer.beanPath,["2048012","2048171"],[F,microstrategy.getFormatObject().encodeValue("top",microstrategy.SNAP_SIZE)])]);C.flushAndSubmitChanges();if(microstrategy.getViewerBone().autoWire){for(id in this.sections){var D=document.getElementById(id);var G=microstrategy.findBone(D);this.docViewer.dirtySections.push({bone:G,isTarget:true});}}}}catch(E){microstrategy.errors.log(E);}return true;};mstrDocSelectionsImpl.prototype.copy=function(){try{var C=this.copyToClipboard(this.items);if(C.length>0){var A=microstrategy.updateManager;microstrategy.updateManager.add([A.createActionObject(null,mstrUpdateManager.COPY_TO_CLIPBOARD,this.docViewer.beanPath,["2048012"],[C],[],null)]);return false;}}catch(B){microstrategy.errors.log(B);}return true;};mstrDocSelectionsImpl.prototype.cut=function(){try{var B=(this.copy()==false);if(B){this.parentBone.deleteItems(this.items,true);}return false;}catch(A){microstrategy.errors.log(A);}return true;};mstrDocSelectionsImpl.prototype.paste=function(){try{var R=this.objCache.copyBuffer;if(!R){return true;}var J=this.styleObj;var c;var T=null;var A=true;var O=false;var m=false;switch(this.firstObjType()){case microstrategy.OBJTYPE_DOC_SUBSECTION:T=this.firstItem();m=true;break;case microstrategy.OBJTYPE_DOC_OBJECT:if(this.isSameSubSection()){m=true;if(this.isOnlyOnePanelStackSelected()){T=microstrategy.findBone(this.getSelectedPanelStack()).getCurrentPanel().elem;}else{for(c in this.sections){T=document.getElementById(c);break;}}}break;default:return false;}if(m){var E=prevSection=null;for(c in R.items){E=document.getElementById(R.parentIds[c]);if(prevSection&&E&&(prevSection.getAttribute("id")!=E.getAttribute("id"))){O=true;break;}prevSection=E;}A=(O||(E!=null&&E.getAttribute("id")==T.getAttribute("id")));}var W=function(AA){var AB=[];for(c in AA){AB.push(microstrategy.subObjectType(AA[c]));}return AB;};var e=W(R.items).join(",");var q=function(AA){return !!e.match("("+microstrategy["SUBOBJTYPE_DOC_"+AA]+")");};var g=q("TEMPLATE");var x=q("SELECTOR_CONTROL");var K=q("PANEL_STACK");if(!A&&T.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)=="-1"){if(g||x||K){var Q="*Sorry, but this paste operation is being canceled because you cannot paste a panel stack into the details section.*";showMessage({contents:K?Q:microstrategy.descriptors.getDescriptor((g)?"2945":"4992"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return false;}}var P=microstrategy.findBone(T);if(P&&P.isFilterPanel&&!x){showMessage({contents:"*This paste operation is being cancelled because you cannot paste a node other than selector to the Filter Panel.*",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}this.clear();var U="";var Z={elements:[],parents:[]};var G={};var z={};var S={control:false,target:false};for(var V in R.items){var N=R.items[V];var Y=N.cloneNode(true);var F=microstrategy.subObjectType(Y);var u=((A&&T)||!m)?document.getElementById(R.parentIds[V]):T;if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&F==microstrategy.SUBOBJTYPE_DOC_TEXT){var h=J.getAttValue(N,microstrategy.HTMLATTR_DSS_FORMULA);if(h!=null){this.parentBone.updateSingleTextField(Y,h);}}var H=u.getAttribute("id");if(!A){u=T;if(R.offsets[H]==null){R.offsets[H]=0;}}else{u=document.getElementById(R.parentIds[V]);if(R.offsets[H]==null){R.offsets[H]=microstrategy.SNAP_SIZE;}}moveObjTo(Y,parseInt(J.getValue(Y,"left"))+R.offsets[H],parseInt(J.getValue(Y,"top"))+R.offsets[H]);Y=this.parentBone.addItemsToSubsection(u,Y,true,N,microstrategy.findBone(microstrategy.findBone(T)));G[H]=true;if(!z[H]){z[H]={};}z[H].elem=u;if(F==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){S.control=true;z[H].isTarget=false;}else{if(F==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||F==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){S.target=true;z[H].isTarget=true;}}J.cloneAttValues(N,Y);if(J.getAttValue(Y,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT)!="0"&&F!=microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){J.applyShadow(Y,"dropShadowEffect","1");}c=Y.getAttribute("id");var D=this.parentBone.formattingAttributes[c];D[microstrategy.HTMLATTR_NAME]=this.parentBone.getDefaultNameOfObject(Y);var C=function(AA){return microstrategy.findBone(microstrategy.subObjectFind(AA,"div",microstrategy.SUBOBJTYPE_GRID_TABLE));};if(F==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var y=C(Y);var L=C(N);if(y&&L){y.copyBoneProperties(L);}}this.add(Y);Z.parents.push(u);Z.elements.push(Y);U+=CLIPBOARD_ITEM_SEPARATOR+c;}if(U.length>0){var a=microstrategy.updateManager;var B=u.getAttribute("id");var X=mstrFormatObject.encodeValue("top",R.offsets[B]);var I=[a.createActionObject(null,mstrUpdateManager.PASTE_FROM_CLIPBOARD,this.parentBone.parentBone.beanPath,["2048066","2048007","2048010","2048011","2048018","2048241"],[U.substr(1),B,X,X,mstrUpdateManager.UPDATE_LATER,"true"],[],Z)];this.resizeSubSection(false,I);a.add(I);if(T){for(var V in this.items){var Y=this.items[V];var F=microstrategy.subObjectType(Y);if(F==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.enforceTitleBar(T,Y);}}}if((S.control||S.target)&&microstrategy.getViewerBone().autoWire){for(c in z){subSecBone=microstrategy.findBone(z[c].elem);this.docViewer.dirtySections.push({bone:subSecBone,isTarget:z[H].isTarget});}}var M=q("IMAGE");if(M){a.add([a.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.parentBone.parentBone.beanPath,[],[],[])]);}if(g||x||K||M){a.flushAndSubmitChanges();}}for(var n in G){R.offsets[n]=parseInt(R.offsets[n])+microstrategy.SNAP_SIZE;}}catch(o){microstrategy.errors.log(o);}return false;};mstrDocSelectionsImpl.prototype.isSameSubSection=function(){try{var A=0;for(var B in this.sections){A++;if(A>1){break;}}return(A<2);}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.hasHorizSections=function(D){try{if(this.parentBone.containsHorizontalSections){for(var E in this.sections){var A=microstrategy.findBone(document.getElementById(E));var B=!!(A&&A.isHorizontal);if(D&&!B){return false;}if(!D&&B){return true;}}}}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.addIdToSection=function(A,B){try{var D=this.sections[A]||{};D[B]=true;this.sections[A]=D;}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.syncUp=function(D){try{var C;if(D){C={};C[D.id||"_k"]=D;}D=C||this.items;for(var E in D){var A=this.hilites[D[E].getAttribute("id")];A&&A.syncHilites(this);}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.canNudge=function(){if(this.isSameSubSection()){return true;}for(var B in this.sections){var A=microstrategy.findBone(document.getElementById(B));if(A.subsectionType!=mstrSubSection.TYPE_FIXED){return false;}}return true;};mstrDocSelectionsImpl.prototype.nudge=function(L,D){try{if(!this.isActive()||this.firstObjType()!=microstrategy.OBJTYPE_DOC_OBJECT){return true;}if(!this.canNudge()){return false;}var m=this.parentBone.parentBone;m.turnOnRulerShade(this.range);var Z=(L%2==0);if(!this.isSameSubSection()&&(Z||this.hasHorizSections())){return false;}if(this.getPortalGridWithProperty(microstrategy.WINDOW_STATE_MAXIMIXED)!=null){return false;}var X=this.styleObj;var N=microstrategy.updateManager;var c=[];var R={acrossSections:false};var E=(Z)?"top":"left";var I=(D)?1:microstrategy.SNAP_SIZE;var e=microstrategy.SNAP_DIRET_POS;if(L<39){I=-I;e=microstrategy.SNAP_DIRET_NEG;}var H=this.range.offsetSection.elem;var C=getObjSumTop(H);var S=C+this.range.top-(C-this.parentBone.top);var O=getObjSumLeft(H)+this.range.left-this.leftBorderOffset;m.dragRulerShade(O,S,this.range);var J=this;var W=function(){window.setTimeout(J.path+".onmoveend()",0);};var B=function(o,q,n){return(o&&(J.range[q]<=(n-J.parentBone[q])));};if(I<0&&(B(Z,"top",C)||B(!Z,"left",getObjSumLeft(this.firstItem().parentNode)))){W();return false;}var M=(Z)?S:O;if(!D){if(!microstrategy.isSnapped(M,H,Z)){I=0;}}var V=M;M=this.parentBone.getNewPosition(M+I,H,Z,!D,e);var Q=0;var h=microstrategy.findBone(this.firstItem().parentNode);if(h&&h.isHorizontal&&!Z){Q=getObjSumLeft(this.firstItem().parentNode)-getObjSumLeft(this.range.offsetLeftSection.elem);}var g=M-V-Q;var Y=function(o,n){if(n==null){n=parseInt(X.getValue(J.items[a],o),10);}return mstrFormatObject.encodeValue(o,n);};for(var a in this.items){if(this.isLocked(this.items[a])){continue;}var P=this.items[a].getAttribute("id");var G=[mstrUpdateManager.UPDATE_LATER,P,this.items[a].parentNode.getAttribute("id")];M=window["getObjSum"+((Z)?"Top":"Left")](this.items[a])+g;if(!this.getNotUseSnap()&&!D&&h.canShowGuideline()){var A=Z?h.guidelineOffsetY:h.guidelineOffsetX;if(Math.abs(A)<microstrategy.SNAP_SIZE&&(A!=0&&(A>0&&e<0||A<0&&e>0))){M=M-(A!=0?e*(microstrategy.SNAP_SIZE-Math.abs(A)):0);}}M=(!Z&&M<0)?0:M;if(X.getValue(this.items[a],E)!=M+"px"){c.push(N.createActionObject(this.items[a],mstrUpdateManager.MOVE_OBJECT,m.beanPath,["2048018","2048012","2048007","2048010","2048011"],G.concat([Y("top",(Z)?M:null),Y("left",(Z)?null:M)]),G.concat([Y("top",null),Y("left",null)]),R));var K=document.getElementsByName(P);for(var U=0,T=K.length;U<T;U++){K[U].style[E]=M+"px";}}}this.resizeSubSection(false,c);this.resetRange(false,c);if(c.length>0){N.add(c);}this.syncUp();W();microstrategy.eventManager.notifyOrphanBones("onboneaftermove",this.getSelectedIds());if(h&&h.guidelineEnabled){this.syncPositionMap(this.items);h.showGuidelines(h.getLocalPosition(this.firstItem()));window.setTimeout(function(){h.hideGuidelines();},500);}return false;}catch(F){microstrategy.errors.log(F);}return true;};mstrDocSelectionsImpl.prototype.reselect=function(H){try{var D=H.split(",");for(var C=0;C<D.length;C++){var G=document.getElementById(D[C]);if(G){var A=G.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(A==microstrategy.OBJTYPE_DOC_OBJECT){var B=microstrategy.subObjectType(G);if(B==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var F=microstrategy.findBone(G);if(F&&F.selections&&F.selections.hasHilitedCells()){continue;}}this.add(G);}else{if(A==microstrategy.OBJTYPE_DOC_SUBSECTION){this.addSubSection(G);}}}}microstrategy.eventManager.notifyOrphanBones("onboneselected",this.getSelectedIds());}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.add=function(F,H,M){try{if(!F){return false;}var N=this.parentBone;N.syncPosition();var D=F.getAttribute("id");var L=document.getElementById(D);if(!L){return false;}var Q=microstrategy.subObjectType(F);var O;if(F.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&Q==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){O=microstrategy.findBone(F);if(!O){return false;}}var K=false;if(typeof (this.items[D])=="undefined"){this.items[D]=F;this.hilites[D]=new mstrDocHilite(this);this.addIdToSection(L.parentNode.getAttribute("id"),D);this.notifySelectedBone(F,true);K=true;this.length++;}if(this.length>1&&this.isSingleSelectionType){this.isSingleSelectionType=(microstrategy.subObjectType(this.firstItem())==F.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE));}this.updateRange(F);if(!this.objCache.hiLite||!this.objCache.lineHiLite){var J=document.createElement("img");J.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SEL_HANDLE);var A=document.createElement("div");A.className="mstrDocHilites";var E=["nw","n","ne","w","e","sw","s","se"];for(var I=0;I<8;I++){var P=J.cloneNode(true);P.className=E[I];A.appendChild(P);}this.objCache.hiLite=A;var C=document.createElement("div");C.className="mstrDocHilites";J.className="w";C.appendChild(J.cloneNode(false));J.className="e";C.appendChild(J.cloneNode(false));this.objCache.lineHiLite=C;}this.setPanelStackSelectionHandleEvents(F);this.setGridSelectionHandleEvents(F);if(O){if(O.isGridInCellSelectionMode&&O.isGridInCellSelectionMode()){O.selections.clearAll(true);}this.verifyFormatLevels("color");}else{if(Q==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){this.setObjectFormatLevel("Panels",this.resolvePanelsFormat(0,0));}else{if(Q==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.setObjectFormatLevel("Control",this.resolveControlFormat(0,0));}else{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}}if(typeof (H)=="undefined"||H==false){this.addHilites(F);}if(typeof (M)=="undefined"||M==false){if(K&&N.parentBone.observer){N.parentBone.delay("observer.notifyAll('onselectionchange')");}N.onselectionchange(D);}var B=microstrategy.findBone(L.parentNode);if(B){B.updatePositionMap(L);B.hideGuidelines();}return true;}catch(G){microstrategy.errors.log(G);return false;}};mstrDocSelectionsImpl.prototype.addHilites=function(F){try{var H=F.getAttribute("id");var E=document.getElementById(H);var C=this.objCache[(microstrategy.subObjectType(F)==microstrategy.SUBOBJTYPE_DOC_LINE)?"lineHiLite":"hiLite"];C.setAttribute("id","hilite"+H);var G=C.cloneNode(true);if(this.isLocked(F)){G.className="mstrDocHilites mstrLockedHilites";}G.src=F;G.ondblclick=new Function("e","microstrategy.bone('"+this.parentBone.parentBone.id+"').doc.editObj(e, this.src);");var A=this.hilites[H].items.push(G)-1;this.hilites[H].base=A;if(this.docViewer.isEditableViewModeEplus()){this.elem.appendChild(this.hilites[H].items[A]);this.elem.style.zIndex=this.parentBone.commands.exec("maxZIndex")+1;this.syncUp(E);this.hiliteElements(F);}this.elem.style.display="block";var B=microstrategy.findBone(E.parentNode);if(B&&B.subsectionType==mstrSubSection.TYPE_PANEL){this.elem.style.display=B.elem.style.display;}this.isVisible=true;}catch(D){microstrategy.errors.log(D);}};mstrDocSelectionsImpl.prototype.notifySelectedBone=function(F,E){try{var B=function(G){return microstrategy.findRWObjectBone(F,G);};var A;var D=microstrategy.findAncestor(F);if(D&&microstrategy.subObjectType(D)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){A=B("mstrGridRW")||B("mstrReportGraphImpl");}else{if(D&&microstrategy.subObjectType(D)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){A=B("mstrRWControlImpl");}else{A=B();}}if(A){if(E){A.onboneselected(null,this.getActiveSectionIndex(F));}else{A.onbonedeselected();}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.addSubSection=function(D){try{var B=microstrategy.findBone(D);if(!B){return ;}this.clear();var E=D.getAttribute("id");var D=document.getElementById(E);if(typeof (this.items[E])=="undefined"){this.items[E]=D;this.addIdToSection(D.parentNode.getAttribute("id"),E);this.length++;}var A=this.parentBone;if(A.parentBone.observer){A.parentBone.delay("observer.notifyAll('onselectionchange')");}A.onselectionchange(E);}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.remove=function(E,J){try{var B=E.getAttribute("id");E=document.getElementById(B);this.removePanelStackSelectionHandleEvents(E);this.removeGridSelectionHandleEvents(E);if(typeof (this.hilites[B])!="undefined"){for(var F=0,C=this.hilites[B].items.length;F<C;F++){if(this.elem.hasChildNodes()){this.elem.removeChild(this.hilites[B].items[F]);}}delete this.hilites[B];delete this.items[B];var G=E.parentNode.getAttribute("id");var H=this.sections[G];delete H[B];if(mstr.$H.isEmpty(H)){delete this.sections[G];}this.length--;var K=this.parentBone;if(K.parentBone.observer){K.parentBone.delay("observer.notifyAll('onselectionchange')");}K.onselectionchange(B);}this.notifySelectedBone(E,false);this.restoreElements(B);try{if(this.isActive()&&this.firstItem().focus){this.firstItem().focus();}else{if(document.body.focus){document.body.focus();}}}catch(I){}if(!J){this.resetRange();}if(this.length<2){this.isSingleSelectionType=true;}var A=microstrategy.findBone(E.parentNode);if(A){A.updatePositionMap(E,true);}}catch(D){microstrategy.errors.log(D);}};mstrDocSelectionsImpl.prototype.clear=function(H){try{H=H||false;this.elem.style.zIndex=-1;var I=function(N){if(M==microstrategy["SUBOBJTYPE_DOC_"+N]){return microstrategy.findBone(L);}return null;};for(var A in this.items){var L=this.items[A];var M=microstrategy.subObjectType(L);var J=I("PANEL_STACK");if(J){this.removePanelStackSelectionHandleEvents(L);}else{J=I("TEMPLATE");if(J){this.removeGridSelectionHandleEvents(L);var C=J.selections&&J.selections.clearAll(true);}}}if(this.elem.hasChildNodes()){for(var A in this.hilites){for(var F=0,B=this.hilites[A].items.length;F<B;F++){var G=this.hilites[A].items[F];if(G.parentNode!=null){this.elem.removeChild(G);}}this.restoreElements(A);}}var E=(this.length>0);if(E){microstrategy.eventManager.notifyOrphanBones("onbonedeselected",this.getSelectedIds());}this.isSingleSelectionType=true;this.hilites={};this.sections={};this.items={};this.range=new Rect(null,null,null,null);this.range.offsetSection=null;this.range.offsetLeftSection=null;this.isVisible=true;this.length=0;var K=this.parentBone;if(E&&!H&&K.parentBone.observer){K.parentBone.delay("observer.notifyAll('onselectionchange')");}K.onselectionchange(A);}catch(D){microstrategy.errors.log(D);}};mstrDocSelectionsImpl.prototype.firstObjType=function(){try{if(this.isActive()){return this.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE);}}catch(A){microstrategy.errors.log(A);}return null;};mstrDocSelectionsImpl.prototype.processFormatProperty=function(H,J,C){try{if(!H){return ;}var A=H[0];var F=H[1];if(!A){return ;}var E=this.parentBone;var D=function(K){return(parseInt(I[0],10)&K);};var G=F.toString();var I=G.split(",");if(A=="textDecoration"&&(I.length>1||D(4)||D(8))){E.formatUnderlineStrikeout(this.items,A,G,J);}else{E.formatItems(this.items,A,F,false,J,C);}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.processPropertyChanges=function(AV){try{var At=null;var P=null;var Aw=null;var A1=null;var A0=null;var A3=null;var X=[];var z=null;var Ad=null;var e=null;var AQ=null;var x=null;var F=null;var AT=null;var Av=(this.isOnlyOneGridSelected())?this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE):null;var AZ=(this.isOnlyOnePanelStackSelected())?this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK):null;var Ae=(AZ&&AZ.isTable)?AZ:null;var U=(this.isSelectorControlSelected())?this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL):null;var A=microstrategy.formatType;var AJ,Ah,O,Ap,AO;var AP=mstrFormatObject;var h=this.parentBone;var Aq=this.styleObj;var Ao=[];var AL=h.parentBone.updateManager;var C=false;var Az=null;var B=null;var AN=false;var As=this.items;var A2=function(g){return(g)?microstrategy.TRUE:microstrategy.FALSE;};var AD=function(n,m,g){h.formatAttribute(As,n,m,false,g,Ao);};var An=function(g,m){g=microstrategy.number.toUSUnits(g);if(m){g=AP.decodeValue(m,g);}return g;};for(var AM=0;AM<AV.length;AM++){var Af=AV[AM].cmdId;var c=AV[AM].obj;var AB=AV[AM].value;var Ac=AV[AM].formatType;var AY=AV[AM].performFormatChange;AT=AV[AM].memo;var Au=AV[AM].memo;var Ai=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&Av!=null&&"category" in Au&&Au.unit>microstrategy.GRID_UNIT_CONTAINER);if((Av||AZ||U)&&Au&&"unit" in Au){var AX=(Av)?"Grid":(U?"Control":"Panels");var AI=this.resolveGridFormat(Au.unit,Au.format);this.setObjectFormatLevel(AX,AI);this.resolveFormatType(AX,AI);}else{if(U&&Af=="IsPortal"){var AX=(Av)?"Grid":(U?"Control":"Panels");var AI=this.resolveControlFormat(0,4);this.setObjectFormatLevel(AX,AI);this.resolveFormatType(AX,AI);}else{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}var H;if(C==false&&AV[AM].submitUpdateManager&&AV[AM].submitUpdateManager==true){C=true;}var AK=mstrDocSelectionsImpl.TCF[Af];if(Ae&&AT&&parseInt(AT.unit)>1&&AK){microstrategy.formatType=1;switch(Af){case"font":case"TextStrikeout":case"TextUnderline":case"fsize":case"color":case"FillColor":case"LineSettingColor":case"LineSettingWeight":Ae.setFormat({u:AT.unit,f:AT.format,p:AK,v:AB});break;case"ShapeSettingStyle":Ae.setFormat({u:AT.unit,f:AT.format,p:AK,v:AP.decodeValue("lineStyle",AB)});break;case"BoldItalic":Ae.setFormat({u:AT.unit,f:AT.format,p:"fb",v:(parseInt(AB)&1)==1});Ae.setFormat({u:AT.unit,f:AT.format,p:"fi",v:(parseInt(AB)&2)==2});break;}}else{switch(Af){case"Name":AD("name",AB,microstrategy.HTMLATTR_NAME);h.parentBone.delay("observer.notifyAll('onselectionchange')");break;case"ToolTip":h.formatTitle(As,"title",AB,Ao);break;case"Visible":case"VisibleHTML":AQ=AQ||{};AQ[Af]=AB;break;case"IsLink":h.formatIsLink(As,AB,Ao);break;case"Link":var K=(h.secMode||trim(AB).toLowerCase().indexOf("javascript")!=0)?AB:"";AD("link",K,microstrategy.HTMLATTR_LINK_HREFVALUE);AD("link",AB,microstrategy.HTMLATTR_LINK_HREF);break;case"EditFieldTargetInfoWin":AD("InformationWindowTarget",AB,"ifw");var G=microstrategy.bone(AB);if(G){h.formatAttribute([G.elem],"UseAsInformationWindow",microstrategy.TRUE,false,microstrategy.HTMLATTR_USE_AS_INFORMATION_WINDOW,Ao);}break;case"InformationWindowPlacement":AD("InformationWindowPlacement",AB,"iwpl");break;case"NewWin":AD("newWin",A2(AB),microstrategy.HTMLATTR_NEW_WINDOW);break;case"HTMLType":h.formatHTMLType(As,AB,Ao);break;case"IFrameSource":AD("url",AB,microstrategy.HTMLATTR_HTML_SOURCE);h.formatIframeSource(As,AB);break;case"ShowWidgetTitleBar":AD("ShowWidgetTitleBar",A2(AB),microstrategy.HTMLATTR_WIDGET_SHOW_WINDOW_TITLE);break;case"UseAsInformationWindow":AD("UseAsInformationWindow",A2(AB),microstrategy.HTMLATTR_USE_AS_INFORMATION_WINDOW);break;case"InfoWindowMode":AD("InfoWindowMode",AB,microstrategy.HTMLATTR_INFO_WIN_MODE);break;case"InfoWindowPosition":AD("InfoWindowPosition",AB,microstrategy.HTMLATTR_INFO_WIN_POSITION);break;case"TabCloseToDismissInfoWindow":AD("TabCloseToDismissInfoWindow",A2(AB),microstrategy.HTMLATTR_TAB_CLOSE_TO_DISMISS_INFOWIN);break;case"TextCopyMode":case"GridCellCopyMode":AD("CopyMode",AB,microstrategy.HTMLATTR_IOS_COPY_MODE);break;case"ResetToFirstPanelWhenTargeted":AD("ResetToFirstPanelWhenTargeted",A2(AB),microstrategy.HTMLATTR_RESET_TO_FIRST_PANEL_WHEN_TARGETED);break;case"EnableHorizontalSwipeToChange":AD("EnableHorizontalSwipeToChange",A2(AB),microstrategy.HTMLATTR_HORIZONTAL_SWIPE_CHANGE);break;case"SwipePanelStyle":AD("StyleForSwitchingPanel",AB,microstrategy.HTMLATTR_STYLE_FOR_SWIPE_PANEL);break;case"fpAutoSubmit":AD("CtlAutoSubmit",A2(AB),microstrategy.HTMLATTR_CTL_AUTO_SUBMIT);break;case"EditSelectorSearchOnServ":AD("SearchOnServer",A2(AB),microstrategy.HTMLATTR_CTL_SEARCH_ON_SERVER);break;case"EditSelectorNoSelectionBehavior":AD("NoSelectionBehavior",AB,microstrategy.HTMLATTR_CTL_NO_SELECTION_BEHAVIOR);break;case"MinSel":AD("MinSelectionCount",(AB===""?-1:AB),microstrategy.HTMLATTR_CTL_MIN_SELECTION_COUNT);break;case"MaxSel":AD("MaxSelectionCount",(AB===""?-1:AB),microstrategy.HTMLATTR_CTL_MAX_SELECTION_COUNT);break;case"ShowElementCount":AD("showElementCount",A2(AB),microstrategy.HTMLATTR_CTL_SHOW_ELEMENT_COUNT);break;case"SelectionColor":this.processFormatProperty(this.setSingleFormat("selectionStyle",AB),Ao);this.processFormatProperty(this.setSingleFormat("selectionColor",AB),Ao);break;case"IsPortal":AD("showTitleBar",A2(AB),microstrategy.HTMLATTR_SHOW_WINDOW_TITLE);for(O in As){AJ=As[O].getAttribute("id");var E=document.getElementsByName(AJ);if(E&&h.checkAppliesTo(As[O],"showTitleBar")){if(AB){var Ay=microstrategy.formatType;if(microstrategy.subObjectType(As[O])==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){microstrategy.formatType=1;}var Z=function(g){h.formatSizeMode({0:As[O]},g+"Mode","0",Ao,false);};Z("height");Z("width");microstrategy.formatType=Ay;}}if(microstrategy.subObjectType(As[O])==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&AB){var AU=microstrategy.findBone(As[O]);if(AU&&AU.commands&&!AU.commands.queryState("fittowindow")){AU.handleFitToWindow(Ao);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){AU.commands.exec("setColWidthsMode",1);}else{C=true;}}}}break;case"PortalTitle":AD("windowTitle",AB,microstrategy.HTMLATTR_WINDOW_TITLE);break;case"TitleBarDisplay":AD("titleBarDisplay",AB,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY);break;case"PortalState":var V="restore";if(AB==microstrategy.WINDOW_STATE_MAXIMIXED){V="maximize";}else{if(AB==microstrategy.WINDOW_STATE_MINIMIZED){V="minimize";}}h[V+"Portal"](As,"windowState",AB,false,Ao);break;case"ExportOptions":AD("exportOptions",AB,microstrategy.HTMLATTR_EXPORT_OPTION);break;case"Locked":AD("locked",A2(AB),microstrategy.HTMLATTR_LOCKED);for(AJ in As){var Am=microstrategy.subObjectType(As[AJ]);if(Am==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||Am==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){Ah=microstrategy.findBone(As[AJ]);Ah.isLocked=AB;Ah.resetToolbar();}}break;case"Left":case"Top":var u=Af.toLowerCase();h.formatItems(As,u,An(AB,u),false,Ao);if(Af=="Left"){h.updateLayoutWidth(Ao);}microstrategy.eventManager.notifyOrphanBones("onboneaftermove",this.getSelectedIds());break;case"Wmode11":case"Wmode12":case"Wmode13":case"Wmode":case"Hmode11":case"Hmode12":case"Hmode13":case"Hmode":var Ar=(Af.charAt(0)=="W")?"width":"height";h.formatSizeMode(As,Ar+"Mode",AB,Ao,AY);if(Ar=="width"&&bIsFirefox){C=true;}var L=microstrategy.findBone(this.getSelectedGrid());if(L&&L.isGrid){L.onresize();if(Ar==="height"){var Ak=L.getParentSubsection(),AW=Ak.elem.offsetHeight,Y=L.gridSpan.offsetHeight,AC=parseInt(microstrategy.styleObj.getAttValue(Ak.elem,microstrategy.HTMLATTR_CAN_GROW));if(Y>AW&&AC){Ak.simpleResize(Y);}}}break;case"Height":case"Width":var T=Af.toLowerCase();h.formatSize(As,T,An(AB,T),Ao,AY);AN=true;if(Af=="Width"&&bIsFirefox){C=true;}var L=microstrategy.findBone(this.getSelectedGrid());if(L&&L.isGrid){L.onresize();if(Af==="Height"){var Ak=L.getParentSubsection(),AW=Ak.elem.offsetHeight,Y=L.gridSpan.offsetHeight,AC=parseInt(microstrategy.styleObj.getAttValue(Ak.elem,microstrategy.HTMLATTR_CAN_GROW));if(Y>AW&&AC){Ak.simpleResize(Y);}}}break;case"SubHeight":case"MaxHeight":case"Shrink":case"Grow":Ad=Ad||{};Ad[Af]=AB;break;case"SubWidth":case"MaxWidth":case"ShrinkHorizontal":case"GrowHorizontal":e=e||{};e[Af]=AB;break;case"HideIfEmpty":AD("hideIfEmpty",A2(AB),microstrategy.HTMLATTR_HIDE_IF_EMPTY);break;case"LockAspectRatio":h.formatLockAspectRatio(As,AB,Ao);break;case"Lmode":h.formatLineLength(As,"lengthMode",AB,Ao,AY);break;case"Length":h.formatLineLength(As,"length",An(AB,"width"),Ao,AY);break;case"FitExcelRowHeight":AD("fitExcelRowHeight",A2(AB),microstrategy.HTMLATTR_FIT_EXCEL_ROW_HEIGHT);break;case"Keep":AD("keepSectionTogether",A2(AB),microstrategy.HTMLATTR_KEEP_SECTION_TOGETHER);break;case"Repeat":AD("repeatSection",A2(AB),microstrategy.HTMLATTR_REPEAT_SECTION);break;case"showInRptCp":AD("showOnlyInRepeatingCopies",A2(AB),microstrategy.HTMLATTR_SHOW_IN_RPT_COPY);break;case"RepeatHoriz":AD("repeatHorizontally",A2(AB),microstrategy.HTMLATTR_REPEAT_HORIZONTALLY);break;case"NewPage":AD("forceNewPage",AB,microstrategy.HTMLATTR_FORCE_NEW_PAGE);break;case"DataSource":A3=A3||{};A3[Af]=AB;break;case"Shortcut":A3=A3||{};A3[Af]=AB;C=true;break;case"XTabView":h.formatTemplateSize(As,AB,Ao);C=true;AN=true;break;case"QuickSwitch":AD("quickSwitch",A2(AB),microstrategy.HTMLATTR_QUICK_SWITCH);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){C=true;}break;case"Overflow":AD("gridOverFlow",AB,microstrategy.HTMLATTR_GRID_OVERFLOW);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){C=true;}break;case"TextOverflow":AD("TextOverflow",AB,microstrategy.HTMLATTR_TEXT_OVERFLOW);break;case"ExportOverflow":AD("gridExportOverFlow",AB,microstrategy.HTMLATTR_GRID_EXPORT_OVERFLOW);break;case"XTabPos":AD("gridPosition",AB,microstrategy.HTMLATTR_GRID_POS);Az=AB;AN=true;C=true;break;case"XTabPer":AD("gridArea",AB,microstrategy.HTMLATTR_GRID_AREA_PCT);B=AB;AN=true;C=true;break;case"ItemWidthMode":this.setCommonBoneProperty(As,"itemWidthMode","ItemWidthMode",A2(!AB),microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,Ao);C|=microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE;break;case"DisplaySelectorDocked":this.setCommonBoneProperty(As,"DisplaySelectorDocked","DisplaySelectorDocked",A2(AB),microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,Ao);break;case"exportSelectorTriState":this.setCommonBoneProperty(As,"aow","ExportAsShownOnWeb",AB,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,Ao);break;case"TitleHeight":if(!!AB){microstrategy.formatType=this.docViewer.doc.selections.isSelectorControlSelected()?mstrRWControlImpl.FMT_TYPE_TITLE:2;h.formatSize(As,"height",An(AB,"height"),Ao,AY);microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}break;case"Source":if(this.addingCtrl!=microstrategy.SUBOBJTYPE_DOC_IMAGE){var J=h.img?h.img.url:AB;C=h.formatImageSource(As,J,Ao,1);h.autoSizeImages(0,J,As,Ao,true);}break;case"imgFile":if(this.addingCtrl!=microstrategy.SUBOBJTYPE_DOC_IMAGE){h.img=AB;}break;case"autoSizeImg":h.autoSizeImages(0,AB,As,Ao);break;case"LineOrientation":h.changeLineOrientation(As,AB,Ao);break;case"RHS":case"RHM":case"RHL":case"CHS":case"CHM":case"CHL":case"Outline":case"Banding":case"AttForms":case"ShowThreshold":case"TitleOverlap":case"DrillOptions":case"HideNullsOrZeros":case"HideNullZeroValues":if(Af=="HideNullsOrZeros"){AB=(AB)?0:-1;}else{if(Af!="DrillOptions"&&Af!="AttForms"&&Af!="HideNullZeroValues"){AB=(AB)?-1:0;}}AO=this.getSelectedGrid();Ah=microstrategy.findBone(AO);Ah.elem.setAttribute("avk",AO.getAttribute("id"));Ah.processGridPropertyChanges(Af,AB,Ao);C=true;break;case"assoNodesDrill":var q={assoNodesDrill:1}[Af];var O=this.firstItem();Ah=microstrategy.findBone(O);Ah.processGridPropertyChanges(Af,AB,Ao);Ao.push(AL.createActionObject(null,mstrUpdateManager.SET_ASSO_NODES,h.parentBone.beanPath,["2048012","2048248","2048247"],[O.getAttribute("id"),AB,q]));C=(C||microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);break;case"GraphExportOverflow":case"GraphExportOverflowSpacing":Ah=microstrategy.findBone(this.getSelectedGrid());Ah.processGridPropertyChanges(Af,AB,Ao);break;case"ControlGroupByList":AO=this.getSelectedGrid();if(AO){Ah=microstrategy.findBone(AO);Ah.processGridPropertyChanges(Af,AB,Ao);}else{var c=this.getSelectedPanelStack()||this.getSelectedSelectorControl();if(c){Ah=microstrategy.findBone(c);if(Ah){Ah.setControlGroupByList(AB,Ao);}}}C=true;break;case"EditSelectorSelectionType":case"EditSelectorMetricConditionType":case"EditSelectorType":case"EditSelectorSource":case"EditSelectorSourceMetrics":case"EditSelectorSourceAttributes":case"EditSelectorShowAll":case"EditSelectorAllAlias":case"EditSelectorShowTotal":case"EditSelectorTotalPosition":case"EditSelectorMouseOverAction":case"EditSelectorMultiSelect":case"EditSelectorStyle":case"EditSelectorStyleSingleSelect":case"EditSelectorStyleMetricQual":case"EditSelectorStyleAction":case"EditSelectorTargets":case"EditSelectorTargetsMetrics":case"EditSelectorTargetsAttributes":case"EditSelectorTargetsSingleSelect":case"EditSelectorTargetsDataset":case"EditSelectorCandidateAttributes":case"EditSelectorOrientation":case"EditSelectorAutoSync":case"DataFilterMode":case"selectorCurrentStateUC":case"selectorCurrentState":case"UnsetCount":case"ActionSelectorStyle":case"actionSelectorType":case"postSubmitOption":case"runReportDocName":case"runReportDocId":case"runObjectType":case"DisplayText":case"OfflineSubmission":case"TXNSubmitInOrder":case"DisplayConfirmation":case"SubmitMessage":case"ShowSubmitMessage":case"InvalidateCache":case"ForceLiveExecution":case"AutoAnswerPrompt":case"EditFormDelimiter":case"EditDisplayForm":case"selectedAttrForms":case"sortAttrForm":case"sortType":case"isDSAsTarget":if(Ae&&Af==="DisplayConfirmation"){Ae.exec({id:"setSelectorDisplayConfirmation",v:{key:Ae.model.def.smk,value:AB}});break;}A1=A1||{};A1[Af]=AB;var Ab={EditSelectorSelectionType:"include",EditSelectorMouseOverAction:"mouseOverAction",EditSelectorAutoSync:"autoSync",EditSelectorShowAll:"showAll",EditSelectorShowTotal:"showTotal",EditSelectorAllAlias:"allAlias",isDSAsTarget:"isDSAsTarget"};var AF=Ab[Af];var N=this.docViewer.doc.commands;var Q=N.queryState("isDDIC");if(AF){for(var AH in As){var AU=mstrStaticDoc.getBone(As[AH]);if(AU){AU[AF]=AB;}else{if(Q){N.setDDICBoneProperty([As[AH]],AF,AB);}}}}break;case"UpdateFilterTarget":AD("ActionForDirectTargetSelectors",AB,"adts");break;case"setWidget":var y;var AS="";var S="";var AE=false;if(AB&&AB.toLowerCase()!="none"){var Aj=h.parentBone.widgets;for(var Ag in Aj){if((Aj[Ag]["rslPath"]&&Aj[Ag]["rslPath"]==AB)||(Aj[Ag]["fqcn"]&&Aj[Ag]["fqcn"]==AB)){y=Aj[Ag];AS=y.fqcn;S=y.rslPath;AE=y.isApp;break;}}}AD("ClassName",AS,microstrategy.HTMLATTR_WIDGET_CLASS);AD("RSLPath",S,microstrategy.HTMLATTR_WIDGET_RSL_PATH);AD("IsApp",AE,microstrategy.HTMLATTR_WIDGET_IS_APP);break;case"SecondaryDataProviders":AD("SecondaryDataProviders",AB.split(CLIPBOARD_ITEM_SEPARATOR).join(","),microstrategy.HTMLATTR_SEC_DATA_PROVIDERS);C=true;break;case"NonFlashRender":AD("NonFlashRender",AB,microstrategy.HTMLATTR_NON_FLASH_RENDER);break;case"setWidgetDhtmlRenderForViewModeChange":if(this.isWidgetToVisLinked(Av)){AD("DhtmlRenderer",AB,microstrategy.HTMLATTR_DHTML_RENDER);}break;case"setTransition":AD("Transition",AB,microstrategy.HTMLATTR_TRANSITION);break;case"setTransDuration":AD("Duration",AB,microstrategy.HTMLATTR_TRANS_DURATION);break;case"PSPreLoadAllPanels":AD("PSPreLoadAllPanels",AB,"plp");break;case"ClipOnExport":AD("IgnoreInExport",AB?microstrategy.FALSE:microstrategy.TRUE,"cone");break;case"allowPanelsToSplitAcrossPages":AD("SplitPanelAcrossPages",AB?microstrategy.TRUE:microstrategy.FALSE,"spcp");break;case"panelOverflowSpacing":AD("RepeatPanelSpacing",AB,"povfs");break;case"expandPanels":AD("ExpandAllPanels",AB,"ep");AD("SplitPanelAcrossPages",AB!=0?microstrategy.FALSE:microstrategy.TRUE,"spcp");break;case"gridIfEnabled":AD("gridIfEnabled",A2(AB),"gif");if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){C=true;}break;case"gridIfMaxRows":AD("gridIfMaxRows",AB,"gmr");if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){C=true;}break;case"gridIfRowMode":AD("gridIfRowMode",AB,"gifmd");if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){C=true;}break;case"setWidgetRslPath":for(var O in As){Ao.push(AL.createEditPropsAction(As[O],As[O].getAttribute("id"),h.parentBone.beanPath,["RSLPath"],[AB]));}break;case"FillColor":H=this.setSingleFormat(Af,AB);if(Ae&&AT&&parseInt(AT.unit)>1){Ae.setFormat({p:H[0],v:H[1],u:AT.unit,f:AT.format});}else{if(Ai&&Au.unit>microstrategy.GRID_UNIT_CONTAINER){X.push({n:H[0],m:Au,v:AB});}else{var M=this.setSingleFormat("FillStyle",AB);this.processFormatProperty(H,Ao);this.processFormatProperty(M,Ao);At=At||{};At[Af]=AB;}}break;case"ShapeSettingStyle":case"LineSettingStyle":h.formatLineSetting(As,"lineStyle",AP.decodeValue("lineStyle",AB),false,Ao);break;case"LineSettingColor":h.formatLineSetting(As,"lineColor",AB,false,Ao);break;case"LineSettingWeight":h.formatLineSetting(As,"lineWeight",AP.decodeValue("lineWeight",AB),false,Ao);break;case"propBorderStyle":case"propButtonBorderStyle":case"AllStyle":case"AllColor":case"LeftStyle":case"LeftColor":case"TopStyle":case"TopColor":case"RightStyle":case"RightColor":case"BottomStyle":case"BottomColor":if(Ai&&Au.unit>microstrategy.GRID_UNIT_CONTAINER){AX=Au.unit+"|"+Au.format;Aw=Aw||{};Aw[AX]=Aw[AX]||{};Aw[AX][Af]=AB;}else{AX="default|"+microstrategy.formatType;}P=P||{};P[AX]=P[AX]||{};if(Af=="propButtonBorderStyle"){Af="propBorderStyle";}P[AX][Af]=AB;break;case"font":case"fsize":case"color":H=this.setSingleFormat(Af,AB);if(Ai){X.push({n:H[0],m:Au,v:AB});}else{if(AZ){microstrategy.formatType=2;}this.processFormatProperty(H,Ao);}break;case"BoldItalic":if(Ai){X.push({n:"fontWeight",m:Au,v:((AB==1||AB==3)?-1:0)});X.push({n:"fontStyle",m:Au,v:((AB==2||AB==3)?-1:0)});}else{if(AZ){microstrategy.formatType=2;}this.processFormatProperty(this.setSingleFormat("Bold",(AB==1||AB==3)),Ao);this.processFormatProperty(this.setSingleFormat("Italic",(AB==2||AB==3)),Ao);if(AZ){AZ.setFormatValue(mstrPanelStack.FMT_TYPE_TITLE,"fontWeight",(AB==1||AB==3)?"bold":"normal");AZ.setFormatValue(mstrPanelStack.FMT_TYPE_TITLE,"fontStyle",(AB==2||AB==3)?"italic":"normal");}}break;case"TextUnderline":if(Ai){X.push({n:"textDecoration",m:Au,v:AB});}else{if(AZ){microstrategy.formatType=2;}this.processFormatProperty(this.setSingleFormat("Underline",AB),Ao);}break;case"TextStrikeout":if(Ai){X.push({n:"textDecoration2",m:Au,v:AB});}else{if(AZ){microstrategy.formatType=2;}this.processFormatProperty(this.setSingleFormat("StrikeOut",AB),Ao);}break;case"Category":case"DecimalPlaces":case"CurrencySymbol":case"CurrencyPosition":case"NegativeNumbers":case"ThousandSeparator":case"Format":if(Ai){if(Af=="ThousandSeparator"){AB=AB?microstrategy.TRUE:microstrategy.FALSE;}z=z||{};z[Af]=AB;X.push({n:Af,m:Au,v:AB});}else{this.processFormatProperty(this.setSingleFormat(Af,AB),Ao);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){C=true;}}break;case"GridHorizontal":case"Vertical2":case"Vertical":case"SelectorVertical":case"TextWrap":case"TextDirection":case"TextDirectionGrid":if(Af=="TextDirectionGrid"){Af="TextDirection";}if(Af=="SelectorVertical"){Af="Vertical";}var I=bIsFirefox||bIsChrome||bIsIE4||bIsW3CIE;if(Af=="TextDirection"&&!I&&AB!="0"){showMessage({contents:microstrategy.descriptors.getDescriptor("5158"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}if(Ai){X.push({n:Af,m:Au,v:AB});}else{this.processFormatProperty(this.setSingleFormat(Af,AB),Ao);}break;case"Horizontal":this.processFormatProperty(this.setSingleFormat(Af,AB),Ao);break;case"LeftPadding":case"TopPadding":case"RightPadding":case"BottomPadding":if(Ai){X.push({n:"padding"+Af.replace("Padding",""),m:Au,v:microstrategy.number.toLocalUnits(mstrNumber.UNIT_PT,An(AB))});}else{this.processFormatProperty(this.setSingleFormat(Af,microstrategy.number.toLocalUnits(mstrNumber.UNIT_PT,An(AB),true)),Ao);}break;case"HasDropShadow":case"DropShadow":this.processFormatProperty(this.setSingleFormat(Af,AB),Ao);break;case"HasRoundedCorners":case"TopCornersOnly":case"Radius":A0=A0||{};A0[Af]=AB;break;case"enabled3d":case"b3dstyle":case"b3dweight":At=At||{};At[Af]=AB;break;case"Transparency":AD("Transparency",AB,microstrategy.HTMLATTR_PS_TRANSPARENCY);break;case"Blur":AD("Blur",A2(AB),microstrategy.HTMLATTR_PS_BLUR);break;case"FlashDisplay":case"DHTMLDisplay":case"iPhoneDisplay":case"AndroidDisplay":case"AndroidTabletDisplay":case"iPadDisplay":case"widgetId":case"WidgetProps":case"SecondaryDataProvidersValue":x=x||{};x[Af]=AB;break;case"docked":var AR=this.parentBone.commands.getCurrentSectionDef();var AA=AB?microstrategy.TRUE:microstrategy.FALSE;if(AR.dc!=(AA==microstrategy.TRUE)){AR.dc=(AA==microstrategy.TRUE);}var c=microstrategy.findAncestorWithAtt(this.parentBone.selections.firstItem(),microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION);h.formatAttribute([c],"docked",AA,false,null,Ao);break;case"DisplayStyle":AD("DisplayStyle",AB,microstrategy.HTMLATTR_DISPLAY_STYLE);break;case"NormalURL":AD("NormalURL",AB,microstrategy.HTMLATTR_NORMAL_URL);break;case"HighlightURL":AD("HighlightURL",AB,microstrategy.HTMLATTR_HIGHLIGHT_URL);break;case"BackgroundHighlightColor":AD("BackgroundHighlightColor",mstrFormatObject.encodeValue("BackgroundHighlightColor",AB),microstrategy.HTMLATTR_BACKGROUND_HIGHLIGHT_COLOR);break;case"FontHighlightColor":AD("FontHighlightColor",mstrFormatObject.encodeValue("FontHighlightColor",AB),microstrategy.HTMLATTR_FONT_HIGHLIGHT_COLOR);break;case"FillEffect":AD("FillEffect",AB,microstrategy.HTMLATTR_FILL_EFFECT);break;case"SetBadgeToValueOnField":AD("SetBadgeToValueOnField",A2(AB),microstrategy.HTMLATTR_SET_BADGE_TO_VALUE_ON_FIELD);break;case"TableSubmitText":Ae&&Ae.exec({id:"setSelectorDisplayText",v:{key:Ae.model.def.smk,txt:AB}});break;case"TableCancelText":Ae&&Ae.exec({id:"setSelectorDisplayText",v:{key:Ae.model.def.dck,txt:AB}});break;case"TableCancelConfirmation":Ae&&Ae.exec({id:"setSelectorDisplayConfirmation",v:{key:Ae.model.def.dck,value:AB}});break;case"joinTypes":var Ah=microstrategy.findBone(this.getSelectedGrid()),D=Ah.editorProperties=Ah.editorProperties||{},Ax,R,AG,W;D.outerJoinType=D.outerJoinType||{};for(var Aa in AB){if(Aa==="allAttrs"){Ax="VLDB Select!Outer Join To Lookup Table!"+(AB[Aa]==="dft"?" !dft":AB[Aa]);Ao.push(AL.createActionObject(this.elem,mstrUpdateManager.SET_PROPERTY_VALUES,Ah.beanPath,["4146"],[Ax],[]));D.outerJoinType=AB[Aa];}else{Ax="VLDB Select!Metric Join Type!"+(AB[Aa]==="dft"?" !dft":AB[Aa]);R=Ah.RWUnitId;AG=Aa;W=4;Ao.push(AL.createActionObject(this.elem,mstrUpdateManager.SET_TEMPLATE_UNIT_PROPS,this.docViewer.beanPath,["4146","2048012","2048001","2048009"],[Ax,R,AG,W],[]));D.tmsProps=D.tmsProps||{};D.tmsProps[Aa]={outerJoinType:AB[Aa]};}}C=true;if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){Ao.push(AL.createActionObject(h.elem,mstrUpdateManager.APPLY_CHANGES,this.docViewer.beanPath,[],[],[]));}break;case"DisplayInPartialScreen":AD("DisplayInPartialScreen",A2(AB),"dips");break;case"InitialSlidingInWidth":AD("InitialSlidingInWidth",An(AB,Af),"isiw");break;case"InitialSlidingInHeight":AD("InitialSlidingInHeight",An(AB,Af),"isih");break;case"ShowAsCollapsiblePanel":AD("ShowAsCollapsiblePanel",A2(AB),"sacp");break;case"InfoWindowPositionEnabled":case"showTranslucent":case"InitialSlidingInHeightEnabled":case"InitialSlidingInWidthEnabled":break;case"showCustomThemePicker":case"showAppliedThemeAsType":case"appliedThemeTypes":case"appliedThemeAsTypes":case"appliedThemePath":case"appliedThemeType":case"appliedThemeID":case"appliedThemeAsLink":F=F||{};F[Af]=AB;break;default:if(typeof (console)!="undefined"){console.log(Af+" property not handled in processPropertyChanges.");}}}}if(AN&&this.processGraphPropertyChanges(As,Az,B,Ao)){C=true;}var a="";this.processVisibilityChanges(AQ,Ao);this.processSubDimensionPropertyChanges(Ad,"Height",Ao);this.processSubDimensionPropertyChanges(e,"Width",Ao);this.processBorderPropertyChanges(P,Ao);this.process3DBorderPropertyChanges(At,Ao);C|=Ao.forceSubmit;if(this.processGridOriginPropertyChanges(A3,Ao)){C=true;}if(Ae&&A1){var o=Ae.submitBtn;this.processSelectorSubsequentChanges(A1,o,Ao);A1=null;}else{if(this.processSelectorPropertyChanges(A1,Ao)){C=true;}}if(this.processThemePropertyChanges(F,Ao)){C=true;}this.processRoundedCornerChanges(A0,Ao);a=this.processGridNumberFormatChanges(z,Au,Ao);if(Aw){X.push({n:"borders",v:Aw});}if(X.length>0){if(Ai&&Av.processGridFormattingProperties(X,Ao)){C=true;}}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;this.processWidgetPropertyChanges(x,Av,Ao,As);microstrategy.formatType=A;if(Ao.length>0){AL.add(Ao);if(C==true){AL.flushAndSubmitChanges();}}if(a){delete microstrategy.gridFormatCache[a];}this.addingCtrl=null;}catch(Al){microstrategy.errors.log(Al);}};mstrDocSelectionsImpl.prototype.isWidgetToVisLinked=function(D){try{if(D){for(var C in this.items){var B=this.styleObj.getAttValue(this.items[C],microstrategy.HTMLATTR_WIDGET_RSL_PATH);var E=this.parentBone.getLinkedVisualization(B);return(E&&E==D.selectedVisualization);}}}catch(A){microstrategy.errors.log(A);}return false;};mstrDocSelectionsImpl.prototype.processWidgetPropertyChanges=function(J,W,T,P){try{if(!J){return ;}var B=this.parentBone;var R=this.styleObj;var U=function(c,Z,Y){B.formatAttribute(P,c,Z,false,Y,T);};var N=function(Z,Y,e){var g=[];if(Y){g.push(Y);}if(W.visualizationList&&W.visualizationList.length>0){for(var c=0,a=W.visualizationList.length;c<a;c++){if(W.visualizationList[c].name!=Y){g.push(Y);}}}W.setVisualizationSettings(Z,Y,g.join(","),e,T);};var S=function(){if(typeof (J.WidgetProps)=="undefined"){if(I.wgtProps){J.WidgetProps=I.wgtProps;}}};var O=J.widgetId;var I=this.docViewer;var M=I.commands.queryState("widgetId");if(typeof (O)=="undefined"){O=M;}var K=I.gridWidgets.lst,L=K[O];if(typeof (J.FlashDisplay)!="undefined"){var H="";var V="";var Q=false;var A="0";if(J.FlashDisplay){H=L.wgt.cn;V=L.wgt.rsl;Q=L.wgt.ia;A="-1";W.curWgtId=O;W.isWidget=true;}else{W.isWidget=false;}U("ClassName",H,microstrategy.HTMLATTR_WIDGET_CLASS);U("RSLPath",V,microstrategy.HTMLATTR_WIDGET_RSL_PATH);U("IsApp",Q,microstrategy.HTMLATTR_WIDGET_IS_APP);U("Enable",A);}if(typeof (J.DHTMLDisplay)!="undefined"){if(J.DHTMLDisplay){N("1",L.vis.s,L.vis.vm);W.curWgtId=O;}else{N("0","","0");}}if(typeof (J.iPhoneDisplay)!="undefined"){var G="";if(J.iPhoneDisplay){G=L.iphVis.s;W.iPhoneVis=G;W.curWgtId=O;}if(I.iPhoneVis){I.doc.saveDocProperty("IPhoneVisualization","");S();}U("IPhoneVisualization",G,microstrategy.HTMLATTR_IPHONE_VIS);}if(typeof (J.iPadDisplay)!="undefined"){var C="";W.iPadVis="";if(J.iPadDisplay){C=L.ipadVis.s;W.iPadVis=C;W.curWgtId=O;}U("IPadVisualization",C,microstrategy.HTMLATTR_IPAD_VIS);}if(typeof (J.AndroidDisplay)!="undefined"){var F="";if(J.AndroidDisplay){F=L.aVis.s;W.aVis=F;W.curWgtId=O;}if(I.aVis){I.doc.saveDocProperty("APhoneVisualization","");S();}U("APhoneVisualization",F,microstrategy.HTMLATTR_ANDROID_VIS);}if(typeof (J.AndroidTabletDisplay)!="undefined"){var X="";if(J.AndroidTabletDisplay){X=L.atVis.s;W.curWgtId=O;W.atVis=X;}U("ATabletVisualization",X,microstrategy.HTMLATTR_ANDROID_TABLET_VIS);}if(W&&W.buildWidgetPreview){W.buildWidgetPreview(O);}if(O==""){W.curWgtId="";W.iPadVis="";I.iPhoneVis="";I.curWgtId="";I.aVis="";I.doc.saveDocProperty("WidgetProps","");I.wgtProps="";U("WidgetProps","",microstrategy.HTMLATTR_WIDGET_PROPS);W.wgtProps="";}else{if(!W.curWgtId&&(W.iPadVis||W.isWidget)){W.curWgtId=O;}if(typeof (J.WidgetProps)!="undefined"){var D=J.WidgetProps;U("WidgetProps",D,microstrategy.HTMLATTR_WIDGET_PROPS);W.wgtProps=D;if(I.wgtProps){I.doc.saveDocProperty("WidgetProps","");}}}if(!W.curWgtId){U("SecondaryDataProviders","",microstrategy.HTMLATTR_SEC_DATA_PROVIDERS);}if(typeof (J.SecondaryDataProvidersValue)!="undefined"){U("SecondaryDataProviders",J.SecondaryDataProvidersValue.split(CLIPBOARD_ITEM_SEPARATOR).join(","),microstrategy.HTMLATTR_SEC_DATA_PROVIDERS);forceSubmit=true;}}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.cancelPropertyEdit=function(A){if(this.addingCtrl==microstrategy.SUBOBJTYPE_DOC_IMAGE){this.parentBone.commands.exec("deleteStubImg");}this.addingCtrl=null;};mstrDocSelectionsImpl.prototype.resolveDeltaPropertyValue=function(B,A){return(A in B)?B[A]:this.checkFormat(A);};mstrDocSelectionsImpl.prototype.convertBooleanToString=function(A){return(A)?microstrategy.TRUE:microstrategy.FALSE;};mstrDocSelectionsImpl.prototype.processVisibilityChanges=function(B,J){try{if(!B){return ;}var H=this.parentBone;var F=this;var G=function(M,L,K){H.formatAttribute(F.items,M,F.convertBooleanToString(L),false,K,J);};var I="Visible";var D="VisibleHTML";var A=H.commands.queryState(I);if(I in B){A=B[I];G("visibility",A,microstrategy.HTMLATTR_VISIBLE);}if(H.commands.queryState("showVisibleInHTMLViewMode")){var E=(D in B)?B[D]:H.commands.queryState(D);if(D in B||(!A&&E)){if(!A){E=false;}G("showInHTMLViewMode",E,microstrategy.HTMLATTR_VISIBLE_HTML_VIEW_MODE);}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.processSubDimensionPropertyChanges=function(B,G,L){try{if(!B){return ;}if(G=="Height"&&("Grow" in B||"Shrink" in B)){var K=microstrategy.findBone(this.firstItem());if(K&&K.isHorizontal){var H=microstrategy.findAncestorWithAtt(K.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(H){var J=function(N,M){H.setAttribute(M,B[N]?microstrategy.TRUE:microstrategy.FALSE);};if("Grow" in B){J("Grow",microstrategy.HTMLATTR_CAN_GROW);}if("Shrink" in B){J("Shrink",microstrategy.HTMLATTR_CAN_SHRINK);}}}}var F=this;var I=function(O,M){var N=F.resolveDeltaPropertyValue(B,M);if(O){return microstrategy.number.toUSUnits(N);}else{return F.convertBooleanToString(N);}};var A=G.toLowerCase();var D="";if(A=="width"){D="Horizontal";}else{for(var E in B){A+="|"+E;}}this.parentBone.formatSubHeightWidth(this.items,A,[I(true,"Sub"+G),I(true,"Max"+G),I(false,"Grow"+D),I(false,"Shrink"+D),this.convertBooleanToString(this.checkFormat("HideIfEmpty"))],L);}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.processGridOriginPropertyChanges=function(F,C){try{if(!F){return false;}var E=false;var D=null;var B=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if("DataSource" in F){D=F.DataSource;this.parentBone.setGridDataSource(this.items,D,C);E=true;}else{D=B.commands.queryState("DataSource");}if("Shortcut" in F){this.parentBone.setGridOrigin(this.items,F.Shortcut,D,C);B.commands.exec("Shortcut",F.Shortcut);if(!E){E=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);}}return E;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.processGridNumberFormatChanges=function(E,B,Q){try{if(!E||E.length==7){return false;}var L=[];var K=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);var O=["Category","DecimalPlaces","CurrencySymbol","CurrencyPosition","NegativeNumbers","ThousandSeparator","Format"];var N=(E.Category=="-2");for(var J=0,D=O.length;J<D;J++){var P=O[J];if(!E[P]){L.push({n:P,m:B,v:((N)?"-2":this.parentBone.commands.queryState(P))});}}var C=[],I,A,M;K.processGridFormattingProperties(L,C);I=C[0];A=I.argID;M=I.newArgs;for(var J in C){_j:for(var H in C[J].argID){for(var G in A){if(C[J].argID[H]==A[G]){continue _j;}}A.push(C[J].argID[H]);M.push(C[J].newArgs[H]);}}Q.push(I);if(K.RWUnitId in microstrategy.gridFormatCache&&N){return K.RWUnitId;}}catch(F){microstrategy.errors.log(F);}return false;};mstrDocSelectionsImpl.prototype.processBorderPropertyChanges=function(G,L){try{if(!G){return ;}for(var D in G){var J;if(D.indexOf("default")>=0){J=G[D];}else{continue;}microstrategy.formatType=D.split("|")[1];var A;var B=["borderTop","borderRight","borderLeft","borderBottom"];var H=this;var K=function(P,M){var O={width:"0pt",style:"solid",color:(P[M+"Color"]||H.checkFormat(M+"Color"))||"#000000"};var N=mstrFormatObject.decodeValue("borderTopStyle",P[M+"Style"]||H.checkFormat(M+"Style")).split(" ");if(N.length>1){O.width=N[0];O.style=N[1];}return O;};var E=function(P,N,O,M){H.parentBone.formatItemBorders(H.items,P,N,O,M,false,L);};var I=parseInt((("propBorderStyle" in J)?J.propBorderStyle:this.checkBorderStyle()),10);switch(parseInt(I)){case 0:E(B,"solid","0pt","#000000");break;case 1:A=K(J,"All");E(B,A.style,A.width,A.color);break;case 2:for(var F=0;F<4;F++){A=K(J,B[F].replace("border",""));E([B[F]],A.style,A.width,A.color);}break;}delete J;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.process3DBorderPropertyChanges=function(E,C){try{if(!E){return ;}var A="0";var D="";if(this.resolveDeltaPropertyValue(E,"enabled3d")){A=this.resolveDeltaPropertyValue(E,microstrategy.HTMLATTR_BORDER_3D_STYLE);D=this.resolveDeltaPropertyValue(E,microstrategy.HTMLATTR_BORDER_3D_WEIGHT);}this.parentBone.format3DItems(this.items,A,D,C);}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.processThemePropertyChanges=function(B,J){if(!B){return false;}var C=microstrategy.updateManager,I=this.parentBone.formattingAttributes,H=this.parentBone.parentBone.beanPath,G=microstrategy.getViewerBone().commands.queryState,E=function(M,O,L){var N=null,K=[];for(N in M){K.push(N);I[N]=I[N]||{};I[N]["thmid"]=O;I[N]["thmlnk"]=!!L;}J.push(C.createActionObject(null,mstrUpdateManager.APPLY_THEME,H,["2048292","2048076","2048293"],[O,K.join(mstrUpdateManager.ITEM_SEPARATOR),L]));},A=function(L){var M=null,K=[];for(M in L){K.push(M);I[M]=I[M]||{};I[M]["thmid"]=null;I[M]["thmlnk"]=false;}J.push(C.createActionObject(null,mstrUpdateManager.REMOVE_THEME,H,["2048076"],[K.join(mstrUpdateManager.ITEM_SEPARATOR)]));};var D=B.appliedThemeID||microstrategy.getViewerBone().commands.queryState("appliedThemeID"),F=("appliedThemeAsLink" in B)?B.appliedThemeAsLink:microstrategy.getViewerBone().commands.queryState("appliedThemeAsLink");if("appliedThemeType" in B){switch(B.appliedThemeType){case microstrategy.APPLIED_THEME_NONE:A(this.items);break;case microstrategy.APPLIED_THEME_DEFAULT:E(this.items,D,F);break;case microstrategy.APPLIED_THEME_CUSTOM:if(D&&!microstrategy.isDefaultTheme(D)){E(this.items,D,F);}else{showMessage({contents:"*You should choose one Theme before applying it.*",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return false;}break;}return true;}if("appliedThemeID" in B||"appliedThemeAsLink" in B){E(this.items,D,F);return true;}return false;};mstrDocSelectionsImpl.prototype.processSelectorPropertyChanges=function(A,N){try{if(!A){return false;}var Z=microstrategy.updateManager,T=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL),y=this.parentBone.parentBone.beanPath,C=false,R=T&&T.ctlKey,D=function(AI,e,AJ){N.push(Z.createActionObject(null,mstrUpdateManager["CTRL_"+AI],y,["2048130"].concat(e),[R].concat(AJ),[]));},E={MouseOverAction:{e:"SET_MOUSE_OVER_ACTION",a:"136"},ShowAll:{e:"SHOW_ALL_SETTING",a:"125"},AllAlias:{e:"SET_ALL_ALIAS",a:"134",c:1},ShowTotal:{e:"SET_SHOW_TOTAL",a:"169"},TotalPosition:{e:"SET_TOTAL_POSITION",a:"170",c:1},MultiSelect:{e:"MULTISELECT_SETTING",a:"120"},AutoSync:{e:"SET_AUTO_SYNC",a:"139"}},L=null;if(microstrategy.getViewerBone().commands.queryState("isDDIC")){var c=microstrategy.getViewerBone().doc.commands,AB="EditSelectorTargets",S=["2048129","2048116"],P=["",A[AB]],n=null;R=c.getDDICBoneProperty(this.items,"ctlKey",null);nk=c.getDDICBoneProperty(this.items,"key",null);if(AB in A){if("DataFilterMode" in A){var AG=A.DataFilterMode;if(AG&&AG!="-1"){for(n in this.items){this.parentBone.formattingAttributes[n]=this.parentBone.formattingAttributes[n]||{},this.parentBone.formattingAttributes[n]["dfm"]=AG;}S.push("2048187");P.push(AG);}}c.setDDICBoneProperty(this.items,"targetKeys",A[AB]);D("SET_TARGETS",S,P);}if("DataFilterMode" in A){if(!(AB in A)){var W=A.DataFilterMode;for(n in this.items){this.parentBone.formattingAttributes[n]=this.parentBone.formattingAttributes[n]||{},this.parentBone.formattingAttributes[n]["dfm"]=W;}if(W!=-1){N.push(Z.createActionObject(null,mstrUpdateManager.RW_SET_CONTROL_DATA_FILTER_MODE,y,["2048130","2048187"],[R,W],[]));}}}if("selectorCurrentStateUC" in A||"selectorCurrentState" in A){var u=["2048130"],AF=[R];N.push(Z.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_UNSET_SELECTOR_CONTROL,y,u,AF,[]));}if("selectorCurrentState" in A||"UnsetCount" in A){var u=["2048130"],AF=[R];u[u.length]="2048204";if("UnsetCount" in A){AF[AF.length]=A.UnsetCount;this.parentBone.formattingAttributes[nk]["usc"]=A.UnsetCount;}else{AF[AF.length]=this.parentBone.formattingAttributes[nk]["usc"];}u[u.length]="2048203";if("selectorCurrentState" in A){AF[AF.length]=A.selectorCurrentState;this.parentBone.formattingAttributes[nk]["ust"]=A.selectorCurrentState;}else{AF[AF.length]=this.parentBone.formattingAttributes[nk]["ust"];}N.push(Z.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_CHANGE_UNSET_SELECTOR_PROPERTIES,y,u,AF,[]));}for(var X in E){var x="EditSelector"+X;if(x in A){var AE=E[X];var o=A[x];if(!AE.c){o=(o)?1:0;}D(AE.e,["2048"+AE.a],[o]);}}return C;}if("EditSelectorType" in A){L=A.EditSelectorType;T.setType(L,N);T.clearSource();T.clearReplaceAtt();}else{L=T.ctlType;}if("isDSAsTarget" in A){var AD=A.isDSAsTarget;if(AD){T.setTargetType(mstrRWControlImpl.CTL_TARGET_TYPE_DATASET);}else{T.setTargetType(mstrRWControlImpl.CTL_TARGET_TYPE_DOCUMENT);}}var M="EditSelectorSource"+(T.ctlStyle==7||T.ctlStyle==8?"Metrics":"");if(L==mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST){if(M in A){var J=A[M].split("|");T.setSource(J[0],J[1],J[2],N);}}if("EditSelectorSourceAttributes" in A&&L==mstrRWControlImpl.CTL_TYPE_ATTR_LIST){var J=A.EditSelectorSourceAttributes.split("|");T.setReplaceAtt(J[0],J[1],J[2],N);}if("EditFormDelimiter" in A){delimiter=A.EditFormDelimiter;T.setDelimiter(delimiter,N);}if("EditDisplayForm" in A){displayFormType=A.EditDisplayForm;T.setDisplayFormType(displayFormType,N);N.push(Z.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[]));}if("selectedAttrForms" in A){attrForms=A.selectedAttrForms;T.setAttrForms(attrForms,N);}if("sortAttrForm" in A){var G=A.sortAttrForm;if(G!="1"){sort={form:G};if("sortType" in A){sort.type=A.sortType;}T.setSortAttrForm(sort,N);}}var z=(L==mstrRWControlImpl.CTL_TYPE_PANEL_STACK||L==mstrRWControlImpl.CTL_TYPE_ATTR_LIST)?"SingleSelect":"",B="EditSelectorStyleMetricQual" in A,Y="EditSelectorStyleAction" in A;if(Y||B||"EditSelectorStyle" in A||"EditSelectorStyleSingleSelect" in A){var O=Y?A.EditSelectorStyleAction:B?A.EditSelectorStyleMetricQual:A["EditSelectorStyle"+z];if(!isNaN(O)){switch(O){case mstrRWControlImpl.CTL_STYLE_POOL_DOWN:A.EditSelectorMultiSelect=false;case mstrRWControlImpl.CTL_STYLE_LIST_BOX:A.EditSelectorOrientation=mstrRWControlImpl.ORIENTATION_VERTICAL;break;case mstrRWControlImpl.CTL_STYLE_RADIO_BUTTON:A.EditSelectorMultiSelect=false;break;case mstrRWControlImpl.CTL_STYLE_CHECKBOX:case mstrRWControlImpl.CTL_STYLE_SEARCH_BOX:A.EditSelectorMultiSelect=true;break;}var I=("EditSelectorMultiSelect" in A)?A.EditSelectorMultiSelect:T.multiSelect;T.setStyle(O,A.EditSelectorOrientation||T.ctlOrientation,I);N.push(Z.createActionObject(null,mstrUpdateManager.CTRL_SET_STYLE,y,["2048130","2048119"],[R,O],[]));}}if("EditSelectorOrientation" in A){N.push(Z.createEditPropsAction(null,R,y,["ctlOrientation"],[A.EditSelectorOrientation],null,true));if(!("EditSelectorStyle" in A)){T.setStyle(T.ctlStyle,A.EditSelectorOrientation,("EditSelectorMultiSelect" in A)?A.EditSelectorMultiSelect:T.multiSelect);}}if("EditSelectorMetricConditionType" in A){N.push(Z.createEditPropsAction(null,R,y,["mct"],[A.EditSelectorMetricConditionType],null,true));var u=!!T.unitKeyContext?["2048137"]:["2048130"],AF=!!T.unitKeyContext?[T.unitKeyContext]:[R];N.push(Z.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_UNSET_SELECTOR_CONTROL,y,u,AF,[]));}if("EditSelectorMultiSelect" in A){if(!("EditSelectorStyle" in A&&"EditSelectorOrientation" in A)){T.setStyle(T.ctlStyle,T.ctlOrientation,A.EditSelectorMultiSelect);}}if("DataFilterMode" in A){var AB="EditSelectorTargets"+z;if(!(AB in A)){var W=A.DataFilterMode;this.parentBone.formattingAttributes[R]["dfm"]=W;if(W!=-1){N.push(Z.createActionObject(null,mstrUpdateManager.RW_SET_CONTROL_DATA_FILTER_MODE,y,["2048130","2048187"],[R,W],[]));C=true;}}}var h=this;var H=function(){var AR;var AN=-1;var AI=false;if("EditSelectorType" in A){AR=A.EditSelectorType;s=(AR=="2")?"Metrics":z;}else{AR=microstrategy.getViewerBone().commands.queryState("EditSelectorType");s=(AR=="2")?"Metrics":z;}if(AR=="1"&&T.ctlTargetType==mstrRWControlImpl.CTL_TARGET_TYPE_DATASET){s="Dataset";}var AQ="EditSelectorTargets"+s,AK=["2048129","2048116"],AT=["",A[AQ]];if(T.ctlTargetType!==null&&T.ctlTargetType!==undefined){AK.push("2048260");AT.push(T.ctlTargetType);}if(AQ in A){if("DataFilterMode" in A){var AN=A.DataFilterMode;if(AN&&AN!="-1"){h.parentBone.formattingAttributes[R]["dfm"]=AN;AK.push("2048187");AT.push(AN);}}if(AR==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION&&(A.TXNSubmitInOrder||T.sio)){while(AK.length<7){AK.push("");AT.push("");}AK.push("2048280");AT.push("1");}T.targetKeys=A[AQ].split(CLIPBOARD_ITEM_SEPARATOR);D("SET_TARGETS",AK,AT);return true;}else{if(AR=="1"&&"isDSAsTarget" in A){AT=["","",0];T.targetKeys=[];D("SET_TARGETS",AK,AT);}else{if(A.EditSelectorType=="2"){var AJ=microstrategy.getViewerBone().commands.queryState("EditSelectorTargetsMetrics"),AS=[];for(var AM in AJ){AS.push(AJ[AM].dssid);}D("SET_TARGETS",AK,["",AS.join(CLIPBOARD_ITEM_SEPARATOR)]);}else{if(AR==mstrRWControlImpl.CTL_TYPE_ATTR_LIST){if("EditSelectorTargetsAttributes" in A){T.targetKeys=A.EditSelectorTargetsAttributes.split(CLIPBOARD_ITEM_SEPARATOR);AT=["",A.EditSelectorTargetsAttributes];D("SET_TARGETS",AK,AT);}if("EditSelectorCandidateAttributes" in A){var AP=A.EditSelectorCandidateAttributes.split(CLIPBOARD_ITEM_SEPARATOR);var e=[],AO=[],AL=[];AP.forEach(function(AV){var AU=AV.split("|");e.push(AU[0]);AO.push(AU[1]);AL.push({dssid:AV,n:AU[2],sty:AU[1]});});T.candidateAtts=AL;AK=["","","","","","2048278","2048279"];AT=["","","","","",e.join(CLIPBOARD_ITEM_SEPARATOR),AO.join(CLIPBOARD_ITEM_SEPARATOR)];D("SET_TARGETS",AK,AT);}return true;}else{return false;}}}}};if(T.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK&&T.groupByTargetKeys){T.groupByTargetKeys=null;}if(!microstrategy.getViewerBone().autoWire){H();}else{if(!H()){var q=microstrategy.findBone(this.parentBone.commands.queryState("selectedSection"));var U;if(T.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){var K=q.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);T.targetKeys=K.length>0?K[0].getAttribute("id"):"";U=T.targetKeys;}else{var m=microstrategy.findBone(this.parentBone.commands.queryState("selectedSection"));var a=m.findObjects(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);a=a.concat(m.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK));var AH=[];var V={};for(var AA=0,Q=a.length;AA<Q;AA++){var F=microstrategy.findBone(a[AA])||a[AA];var g=(F.objId||F.id);if(V[g]!=true){AH.push(g);V[g]=true;}}T.targetKeys=AH;U=AH.join(CLIPBOARD_ITEM_SEPARATOR);}D("SET_TARGETS",["2048129","2048116"],["",U]);}}if("selectorCurrentStateUC" in A||"selectorCurrentState" in A||(M in A&&("EditSelectorStyle" in A||microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE))){var u=!!T.unitKeyContext?["2048137"]:["2048130"],AF=!!T.unitKeyContext?[T.unitKeyContext]:[R];if("selectorCurrentStateUC" in A){this.parentBone.formattingAttributes[R]["isUs"]=A.selectorCurrentStateUC;}N.push(Z.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_UNSET_SELECTOR_CONTROL,y,u,AF,[]));}if("selectorCurrentState" in A||"UnsetCount" in A){var u=!!T.unitKeyContext?["2048137"]:["2048130"],AF=!!T.unitKeyContext?[T.unitKeyContext]:[R];u[u.length]="2048204";if("UnsetCount" in A){AF[AF.length]=A.UnsetCount;this.parentBone.formattingAttributes[R]["usc"]=A.UnsetCount;}else{AF[AF.length]=this.parentBone.formattingAttributes[R]["usc"];}u[u.length]="2048203";if("selectorCurrentState" in A){AF[AF.length]=A.selectorCurrentState;this.parentBone.formattingAttributes[R]["ust"]=A.selectorCurrentState;}else{AF[AF.length]=this.parentBone.formattingAttributes[R]["ust"];}N.push(Z.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_CHANGE_UNSET_SELECTOR_PROPERTIES,y,u,AF,[]));}if("actionSelectorType" in A){var u=!!T.unitKeyContext?["2048137"]:["2048130"],AF=!!T.unitKeyContext?[T.unitKeyContext]:[R];T.ast=A.actionSelectorType;T.updateDisplayText();u.push("2048226");AF.push(A.actionSelectorType);N.push(Z.createActionObject(null,mstrUpdateManager.SET_CTL_ACTIONS,y,u,AF,[]));}if(T.ast=="8"&&("postSubmitOption" in A||"runReportDocId" in A||"ShowSubmitMessage" in A||"SubmitMessage" in A||"ForceLiveExecution" in A||"InvalidateCache" in A||"AutoAnswerPrompt" in A)){this.processSelectorSubsequentChanges(A,T,N);}if(T.ast=="8"||T.ast=="4"){if("DisplayConfirmation" in A){T.dpCfm=A.DisplayConfirmation;N.push(Z.createEditPropsAction(null,R,y,["DisplayConfirmation"],[A.DisplayConfirmation],null,false));}if("OfflineSubmission" in A){T.os=A.OfflineSubmission;N.push(Z.createEditPropsAction(null,R,y,["OfflineSubmission"],[A.OfflineSubmission],null,false));}if("TXNSubmitInOrder" in A){T.sio=A.TXNSubmitInOrder;N.push(Z.createEditPropsAction(null,R,y,["TXNSubmitInOrder"],[A.TXNSubmitInOrder],null,false));}}if("DisplayText" in A){var u=!!T.unitKeyContext?["2048137"]:["2048130"],AF=!!T.unitKeyContext?[T.unitKeyContext]:[R];T.dpTxt=A.DisplayText;T.updateDisplayText();u.push("2048234");AF.push(T.dpTxt);N.push(Z.createActionObject(null,mstrUpdateManager.SET_CTL_DISPLAY_TEXT,y,u,AF,[]));}if("EditSelectorSelectionType" in A){var o=A.EditSelectorSelectionType;N.push(Z.createActionObject(null,mstrUpdateManager.CTRL_SET_INCLUDE,y,["2048130","2048224","2048001","2048009"],[R,o,T.ctlSrcId,T.ctlSrcType],[]));if(o==="0"){A.EditSelectorShowAll=false;}}for(var X in E){var x="EditSelector"+X;if(x in A){var AE=E[X];var o=A[x];if(!AE.c){o=(o)?1:0;}D(AE.e,["2048"+AE.a],[o]);}}}catch(AC){microstrategy.errors.log(AC);}return(C||microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);};mstrDocSelectionsImpl.prototype.processSelectorSubsequentChanges=function(C,G,N){var H=microstrategy.updateManager,A=this.parentBone.parentBone.beanPath,L=G.ctlKey,I=!!G.unitKeyContext?["2048137"]:["2048130"],M=!!G.unitKeyContext?[G.unitKeyContext]:[L],E={shSubMsg:"ShowSubmitMessage",fcLvExec:"ForceLiveExecution",invCache:"InvalidateCache",aapm:"AutoAnswerPrompt"},F=1,J=268435456,O=536870912,K=1073741824;for(var B in E){if(!(B in G)){G[B]=false;}if(E[B] in C){G[B]=C[E[B]];}}G.pso=C.postSubmitOption||G.pso||"0";if(G.shSubMsg){G.subMsg=C.SubmitMessage||G.subMsg||"";I.push("2048231");M.push(G.subMsg);}if(G.pso=="16"){G.execId=C.runReportDocId||G.execId||"";G.execObjTp=C.runObjectType||G.execObjTp||"";G.execName=C.runReportDocName||G.execName||"";if(G.execId){I.push("2048229","2048230","2048233");M.push(G.execId,G.execObjTp,G.execName);}else{G.pso="8";}}var D=G.pso;if(G.shSubMsg){D|=F;}if(G.fcLvExec){if(G.pso=="16"&&G.execId){D|=J;}else{G.fcLvExec=false;}}if(G.aapm){if(G.pso=="16"&&G.execId){D|=K;}else{G.aapm=false;}}if(G.invCache){D|=O;}I.push("2048228");M.push(D);N.push(H.createActionObject(null,mstrUpdateManager.SET_CTL_SUBSEQUENT_ACTIONS,A,I,M,[]));};mstrDocSelectionsImpl.prototype.processRoundedCornerChanges=function(B,I){try{if(!B){return ;}if("HasRoundedCorners" in B){this.processFormatProperty(this.setSingleFormat("HasRoundedCorners",B.HasRoundedCorners),I);}var F=this;var A=function(J,K){return(J)?B[K]:F.parentBone.commands.queryState(K);};var G=("Radius" in B);var C=("TopCornersOnly" in B);var H=A(G,"Radius");var E=function(J){F.processFormatProperty(F.setSingleFormat(J+"CornerRadius",H),I);};if(G){E("topLeft");E("topRight");}if(G||C){H=(A(C,"TopCornersOnly"))?0:H;E("bottomLeft");E("bottomRight");}}catch(D){microstrategy.errors.log(D);}};mstrDocSelectionsImpl.prototype.getSelectedControlBone=function(C){try{var B=this.getSelectedControl(C);if(B){return mstrStaticDoc.getBone(B);}}catch(A){microstrategy.errors.log(A);}return null;};mstrDocSelectionsImpl.prototype.processGraphPropertyChanges=function(E,H,G,F){try{for(var I in E){var B=E[I].getAttribute("id");var D=document.getElementsByName(B);if(D[0].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(D[0]);if(A&&A.isGraph){H=(H==null)?A.commands.queryState("gridPosition"):H;G=(G==null)?A.commands.queryState("gridFactor"):G;A.adjustGraphSize(H,G,F);if(this.parentBone.commands.refreshOnWindowChange(E[I],microstrategy.findBone(E[I]))){return true;}}}}return false;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.setFormat=function(Q,F,C){try{var G=this.parentBone.parentBone.updateManager;var D=false;var I=[];var H=null;switch(Q){case"formatBulk":for(var O=0;O<F.length;O++){var L=F[O].split("|");var A=L[0];var J=L[1];switch(A){case"borderTop":case"borderRight":case"borderLeft":case"borderBottom":var R=J.split(",");var N=(R.length>0)?R[0]:"";var M=(R.length>1)?R[1]:"";var P=(R.length>2)?R[2]:"";I=this.parentBone.formatItemBorders(this.items,new Array(A),P,M,N,false,I);break;case"LineSettingColor":case"LineSettingWeight":case"LineSettingStyle":var B="lineColor";if(A=="LineSettingWeight"){B="lineWeight";}else{if(A=="LineSettingStyle"){B="lineStyle";}}this.parentBone.formatLineSetting(this.items,B,J,false,I);break;case"FillColor":this.processFormatProperty(this.setSingleFormat(A,J),I,C);if(J.indexOf(",")<0){this.processFormatProperty(this.setSingleFormat("FillStyle",J),I,C);}this.parentBone.format3DItems(this.items,null,null,I);break;case"border3D":var R=J.split(",");var K=(R.length>0)?R[1]:"";var P=(R.length>1)?R[0]:"";this.parentBone.format3DItems(this.items,P,K,I);if(I.forceSubmit){D=true;}break;default:this.processFormatProperty(this.setSingleFormat(A,J),I);}}microstrategy.eventManager.notifyOrphanBones("onformatchange");break;case"PropertyChanges":this.processPropertyChanges(F);break;case"FillColor":case"bgcolor":this.processFormatProperty(this.setSingleFormat("FillColor",F),I,C);if(F.indexOf(",")<0){this.processFormatProperty(this.setSingleFormat("FillStyle",F),I,C);}this.parentBone.format3DItems(this.items,null,null,I);break;case"bgcolorgradient":this.processFormatProperty(this.setSingleFormat("Gradient",F),I,C);this.parentBone.format3DItems(this.items,null,null,I);break;default:this.processFormatProperty(this.setSingleFormat(Q,F),I);}if(I&&I.length>0){G.add(I);}if(D==true&&I.length>0){G.flushAndSubmitChanges();}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrDocSelectionsImpl.prototype.setCommonBoneProperty=function(F,L,A,I,D,J){try{var H=mstrFormatObject;var E=this.parentBone.parentBone.updateManager;for(var B in F){if(F[B].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&F[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==D){var K=mstrStaticDoc.getBone(F[B]);if(K){K[L]=I;var G=K.ctlKey+mstrUpdateManager.UNIT_SEPARATOR+H[A][mstrFormatObject.PROP_SET]+mstrUpdateManager.UNIT_SEPARATOR+A+mstrUpdateManager.UNIT_SEPARATOR+I;J.push(E.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,G],[]));}}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.setSingleFormat=function(D,A){try{var C=[];C=microstrategy.setSingleFormat(D,A);return C;}catch(B){microstrategy.errors.log(B);return null;}};mstrDocSelectionsImpl.prototype.setNumberFormat=function(F,D){try{var E=microstrategy.updateManager;var J=mstrUpdateManager.FIELD_NUMBER_FORMAT;var A=this.parentBone.parentBone.beanPath;var G=[2048012,2048183];var I=D;if(F=="number"){G[1]=G[1]+parseInt(D,10);I=1;}var H=this.parentBone.selections.items;for(var B in H){E.add([E.createActionObject(H[B],J,A,G,[B,I],[],null)]);}if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){E.flushAndSubmitChanges();}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.setBorderFormat=function(S,G){try{var U=[];var N="";var Q="";var O="";this.parentBone.format3DItems(this.items,"0",null,U);if(S=="lnstyle"){var M=microstrategy.getFormatObject().decodeValue("borderTopStyle",G).split(" ");N=M[0];Q=M[1];}else{O=G;}for(var K in this.items){var L=this.items[K];var A={id:this.items[K]};var I=Q;var C=N;var H=O;var R=microstrategy.subObjectType(L);if(R==microstrategy.SUBOBJTYPE_DOC_LINE||R==microstrategy.SUBOBJTYPE_DOC_SHAPE){if(R==microstrategy.SUBOBJTYPE_DOC_LINE){var J=Math.ceil(parseFloat(N))+"pt";if(S=="lnstyle"&&(!J||parseInt(J,10)==0)){continue;}else{C=J;}}else{if(this.styleObj.getValue(L,"lineStyle").indexOf("none")>-1||this.styleObj.getValue(L,"lineWeight").indexOf("0pt")>-1){I=I||mstrDocSelectionsImpl.DEFAULT_LINE_STYLE;C=C||mstrDocSelectionsImpl.DEFAULT_LINE_WIDTH;H=H||mstrDocSelectionsImpl.DEFAULT_LINE_COLOR;}}if(I){this.parentBone.formatLineSetting(A,"lineStyle",I,true,U);}if(C){this.parentBone.formatLineSetting(A,"lineWeight",C,true,U);}if(H){this.parentBone.formatLineSetting(A,"lineColor",H,true,U);}}else{var E=this.checkborders(L);if(E==mstrDocSelectionsImpl.NOBORDERS){E=mstrDocSelectionsImpl.ALLBORDERS;I=I||mstrDocSelectionsImpl.DEFAULT_LINE_STYLE;C=C||mstrDocSelectionsImpl.DEFAULT_LINE_WIDTH;H=H||mstrDocSelectionsImpl.DEFAULT_LINE_COLOR;}var B=[];var D=["Top","Bottom","Left","Right"];for(var P=0;P<4;P++){var T=D[P];if(E==mstrDocSelectionsImpl.ALLBORDERS||(mstrDocSelectionsImpl[T.toUpperCase()+"BORDER"]&E)>0){B.push("border"+T);}}this.parentBone.formatItemBorders(A,B,I,C,H,true,U);}}if(this.parentBone.parentBone.observer){this.parentBone.parentBone.observer.notifyAll("onBorderStyleChange");}if(U.length>0){microstrategy.updateManager.add(U);}}catch(F){microstrategy.errors.log(F);}};mstrDocSelectionsImpl.prototype.enableBorders=function(J){try{var N=[];this.parentBone.format3DItems(this.items,"0",null,N);var K={};K[mstrDocSelectionsImpl.TOPBORDER]="Top";K[mstrDocSelectionsImpl.BOTTOMBORDER]="Bottom";K[mstrDocSelectionsImpl.LEFTBORDER]="Left";K[mstrDocSelectionsImpl.RIGHTBORDER]="Right";for(var G=0,C=J.length;G<C;G++){var M=J[G];var B=(M.cl)?mstrDocSelectionsImpl.DEFAULT_LINE_WIDTH:"0pt";var A=mstrDocSelectionsImpl.DEFAULT_LINE_STYLE;var E=mstrDocSelectionsImpl.DEFAULT_LINE_COLOR;var I=[];var L=parseInt(M.v[0],10);if(L==mstrDocSelectionsImpl.NOBORDERS||L==mstrDocSelectionsImpl.ALLBORDERS){I=["borderTop","borderRight","borderBottom","borderLeft"];if(L==mstrDocSelectionsImpl.NOBORDERS){B="0pt";}}else{for(var F=0,H=M.v.length;F<H;F++){I.push("border"+K[M.v[F]]);}}this.parentBone.formatItemBorders(this.items,I,A,B,E,true,N);}this.parentBone.parentBone.updateManager.add(N);}catch(D){microstrategy.errors.log(D);}};mstrDocSelectionsImpl.prototype.checkFormat=function(e,g){try{var P=microstrategy.getFormatObject();var I=null;var Y=null;var O,q;var V,a,M;var A=this.firstItem();var Q=(this.isSingleSelectionType&&A&&(A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK));var D=this.isOnlyOneTableSelected()&&this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(microstrategy.findBone(this.firstItem())!=null){Q&=!microstrategy.findBone(this.firstItem()).isTable;}var W=this.isOnlyOneGridSelected();var c=this.isSelectorControlSelected();var H=mstrDocSelectionsImpl.TCF[e];if(D&&parseInt(this.panelUnitFormat)>1&&H){switch(e){case"font":case"fsize":case"TextUnderline":case"TextStrikeout":case"color":case"FillColor":case"LineSettingColor":case"LineSettingWeight":return D.getFormat({u:this.panelUnitFormat,f:this.panelValueFormat,p:H});case"ShapeSettingStyle":return P.encodeValue("lineStyle",D.getFormat({u:this.panelUnitFormat,f:this.panelValueFormat,p:H}));case"BoldItalic":var U=D.getFormat({u:this.panelUnitFormat,f:this.panelValueFormat,p:"fb"}),S=D.getFormat({u:this.panelUnitFormat,f:this.panelValueFormat,p:"fi"});return(U?1:0)+(S?2:0);}}switch(e){case"Wmode11":case"Wmode12":case"Wmode13":case"Wmode":return(this.isActive())?this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_WIDTH_MODE,"widthMode"):"";case"Hmode11":case"Hmode12":case"Hmode13":case"Hmode":return(this.isActive())?this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_HEIGHT_MODE,"heightMode"):"";case"Lmode":return this.evaluateLineProperties(this.items,"lengthMode");case"Width":case"SubWidth":Y=this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_WIDTH,"width");return(this.isActive()&&Y!=null&&Y.length!=0)?microstrategy.number.toUserUnits(Y):"";case"Height":case"SubHeight":Y=this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_HEIGHT,"height");return(this.isActive()&&Y!=null&&Y.length!=0)?microstrategy.number.toUserUnits(Y):"";case"Length":return this.evaluateLineProperties(this.items,"length");case"AutoResize":return(this.isActive())?this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_AUTO_RESIZE_IN_DESIGNMODE):"";case"Shrink":var N=this.getFormatFromHContainer(microstrategy.HTMLATTR_CAN_SHRINK);if(N!=undefined){return N==-1;}return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_CAN_SHRINK)==-1);case"ShrinkHorizontal":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL)==-1);case"Grow":var N=this.getFormatFromHContainer(microstrategy.HTMLATTR_CAN_GROW);if(N!=undefined){return N==-1;}return this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_CAN_GROW)==-1;case"SelectionColor":return(this.isActive())?((this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE)=="1")?this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR):"automatic"):"automatic";case"GrowHorizontal":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL)==-1);case"HideIfEmpty":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_HIDE_IF_EMPTY)==-1);case"MaxHeight":return(this.isActive())?microstrategy.number.toUserUnits(this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_MAX_HEIGHT)):"";case"MaxWidth":return(this.isActive())?microstrategy.number.toUserUnits(this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_MAX_WIDTH)):"";case"FitExcelRowHeight":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_FIT_EXCEL_ROW_HEIGHT)==-1);case"Keep":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_KEEP_SECTION_TOGETHER)==-1);case"Repeat":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_REPEAT_SECTION)==-1);case"showInRptCp":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_SHOW_IN_RPT_COPY)==-1);case"RepeatHoriz":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_REPEAT_HORIZONTALLY)==-1);case"NewPage":return(this.isActive())?this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_FORCE_NEW_PAGE):"";case"Locked":Y=this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_LOCKED,"locked");return(this.isActive()&&Y!=null&&Y.length!=0&&Y==-1);case"InitialSlidingInWidth":Y=(this.isActive())?this.getCommonFormatValue(this.items,"InitialSlidingInWidth",microstrategy.FORMAT_TYPE_MAIN):0;if(Y==null||Y.length==0){return"";}return(Y==0)?"0":microstrategy.number.toUserUnits(P.encodeValue("InitialSlidingInWidth",Y));case"InitialSlidingInHeight":Y=(this.isActive())?this.getCommonFormatValue(this.items,"InitialSlidingInHeight",microstrategy.FORMAT_TYPE_MAIN):0;if(Y==null||Y.length==0){return"";}return(Y==0)?"0":microstrategy.number.toUserUnits(P.encodeValue("InitialSlidingInHeight",Y));case"Left":Y=(this.isActive())?this.getCommonFormatValue(this.items,"left",microstrategy.FORMAT_TYPE_MAIN):0;if(Y==null||Y.length==0){return"";}return(Y==0)?"0":microstrategy.number.toUserUnits(P.encodeValue("left",parseInt(Y)));case"Top":Y=(this.isActive())?this.getCommonFormatValue(this.items,"top",microstrategy.FORMAT_TYPE_MAIN):0;if(Y==null||Y.length==0){return"";}return(Y==0)?"0":microstrategy.number.toUserUnits(P.encodeValue("top",parseInt(Y)));case"LineSpacing":a=this.getCommonFormatValue(this.items,"lineHeight");if(a!=null){a=P.encodeValue("lineHeight",a);}return a;case"Horizontal":case"align":case"TextAlign":if(this.isOnlyOneGridSelected()){return this.getCommonFormatValue(this.items,"textAlign","GRID");}else{Y=P.encodeValue("textAlign",this.getCommonFormatValue(this.items,"textAlign"));return(isNaN(Y))?0:Y;}case"Vertical2":if(this.isOnlyOneGridSelected()){return this.getCommonFormatValue(this.items,"verticalAlign","GRID");}else{return P.encodeValue("verticalAlign2",this.getCommonFormatValue(this.items,"verticalAlign"));}break;case"Vertical":if(!this.isGridSelected()){Y=P.encodeValue("verticalAlign",this.getCommonFormatValue(this.items,"verticalAlign"));return Y;}break;case"lnsize":return this.getCommonFormatValue(this.items,borderWidth);case"LineSettingColor":case"ShapeSettingStyle":case"LineSettingStyle":case"LineSettingWeight":case"lncolor":case"lnstyle":a="";var o=microstrategy.HTMLATTR_LINE_COLOR;I="lineColor";if(e=="LineSettingWeight"){o=microstrategy.HTMLATTR_LINE_WEIGHT;I="lineWeight";}else{if(e=="LineSettingStyle"||e=="ShapeSettingStyle"){o=microstrategy.HTMLATTR_LINE_STYLE;I="lineStyle";}else{if(e=="lncolor"){o=microstrategy.HTMLATTR_BORDER_TOP_COLOR;I="borderTopColor";}else{if(e=="lnstyle"){o=microstrategy.HTMLATTR_BORDER_TOP_STYLE;I="borderTopStyle";}}}}if(this.isActive()){A=true;for(V in this.items){if(microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_LINE||microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_SHAPE){if(e=="lncolor"){o=microstrategy.HTMLATTR_LINE_COLOR;I="lineColor";}else{if(e=="lnstyle"){o=microstrategy.HTMLATTR_LINE_STYLE;I="lineStyle";}}}var G,F,R,y;if(this.parentBone.checkAppliesTo(this.items[V],I)){if(A){a=this.styleObj.getAttValue(this.items[V],o);if(e=="lnstyle"){if(microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_LINE||microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_SHAPE){G=a;F=this.styleObj.getAttValue(this.items[V],"lw");R=P.decodeValue("lineStyle",G);y=P.encodeValue("borderTopStyle",F+"pt "+R);a=y;}}A=false;if(this.hasNoBorder(this.items[V])){return 0;}}Y="";Y=this.styleObj.getAttValue(this.items[V],o);if(e=="lnstyle"){if(microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_LINE||microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_SHAPE){G=Y;F=this.styleObj.getAttValue(this.items[V],"lw");R=P.decodeValue("lineStyle",G);y=P.encodeValue("borderTopStyle",F+"pt "+R);Y=y;}}if(Y!=a){return null;}}}}return(e.toLowerCase().indexOf("color")>0)?P.decodeValue("borderRightColor",a):a;break;case"enabled3d":if(this.isActive()){for(V in this.items){a=this.styleObj.getAttValue(this.items[V],"b3dstyle");if(a!="1"&&a!="2"){return 0;}}return 1;}return 0;case"b3dstyle":case"b3dweight":if(this.isActive()){M=this.styleObj.getAttValue(this.firstItem(),e);a=null;for(V in this.items){a=this.styleObj.getAttValue(this.items[V],e);if(a!=M){return null;}}if(e=="b3dstyle"&&parseInt(a)==0){a=1;}return a;}return false;case"DisplayStyle":return this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_DISPLAY_STYLE);case"NormalURL":return this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_NORMAL_URL);case"HighlightURL":return this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_HIGHLIGHT_URL);case"BackgroundHighlightColor":var C=this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_BACKGROUND_HIGHLIGHT_COLOR);return mstrFormatObject.decodeValue("color",C!=null?C:"-1");case"FontHighlightColor":var T=this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_FONT_HIGHLIGHT_COLOR);return mstrFormatObject.decodeValue("color",T!=null?T:"-1");case"FillEffect":return this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_FILL_EFFECT);}var K=null;var X=null;if(this.isOnlyOnePanelStackSelected()){X=this.panelValueFormat+1;}else{if(this.isSelectorControlSelected()){X=this.controlValueFormat+1;}else{if(W){if(this.resolveGridFormat().unit>microstrategy.GRID_UNIT_CONTAINER){X="GRID";}else{if(this.gridValueFormatX==2){X=2;}}K=X;}}}var Z;switch(e){case"BoldItalic":var z=this.getCommonFormatValue(this.items,"fontWeight",X),q=this.getCommonFormatValue(this.items,"fontStyle",X);if(z==q&&q=="default"){return -2;}var m=0;if(z=="bold"){m+=1;}if(q=="italic"){m+=2;}return m;case"TextUnderline":Z=this.getCommonFormatValue(this.items,"textDecoration",X);return(Z&&Z.indexOf("underline")>-1);case"TextStrikeout":Z=this.getCommonFormatValue(this.items,"textDecoration2",X);return(Z&&Z.indexOf("line-through")>-1);case"Bold":return(this.getCommonFormatValue(this.items,"fontWeight",X)=="bold");case"Italic":return(this.getCommonFormatValue(this.items,"fontStyle",X)=="italic");case"Underline":Z=this.getCommonFormatValue(this.items,"textDecoration",X);return(Z&&Z.indexOf("underline")>-1);case"fstyle":var L=this.checkFormat("BoldItalic");if(this.checkFormat("TextUnderline")){L+=4;}if(this.checkFormat("TextStrikeout")){L+=8;}return L;case"FontSize":case"fsize":return P.encodeValue("fontSize",this.getCommonFormatValue(this.items,"fontSize",X));case"FontColor":case"color":return this.getCommonFormatValue(this.items,"color",X);case"FontFamily":case"font":return this.getCommonFormatValue(this.items,"fontFamily",X);case"FillColor":var n=this.checkFormat("gradientcolor");if(n){return n;}case"bgcolor":I="backgroundColor";if(Q||D){if(D){if(this.panelValueFormat==0){var z=microstrategy.findBone(this.firstItem());a=this.styleObj.getValue(z.getCurrentPanel().elem,I);for(V in this.items){z=microstrategy.findBone(this.items[V]);Y=this.styleObj.getValue(z.getCurrentPanel().elem,I);if(Y!=a){return null;}}return a;}return null;}else{if(this.panelValueFormat==0){var z=microstrategy.findBone(this.firstItem());a=this.styleObj.getValue(z.getCurrentPanel().elem,I);for(V in this.items){z=microstrategy.findBone(this.items[V]);Y=this.styleObj.getValue(z.getCurrentPanel().elem,I);if(Y!=a){return null;}}}else{a=this.styleObj.getValue(this.firstItem(),I,mstrPanelStack.FMT_TYPE_TITLE);for(V in this.items){Y=this.styleObj.getValue(this.items[V],I,mstrPanelStack.FMT_TYPE_TITLE);if(Y!=a){return null;}}}return a;}}else{if(c&&this.isSingleSelectionType){if(this.controlValueFormat==0){var z=microstrategy.findBone(this.firstItem().lastChild);a=this.styleObj.getValue(z.elem.parentNode,I);}else{a=this.styleObj.getValue(this.firstItem(),I,mstrRWControlImpl.FMT_TYPE_TITLE);}return a;}else{return this.getCommonFormatValue(this.items,I,X||microstrategy.formatType);}}case"gradientcolor":O=this.firstItem();if(O){a=this.parentBone.getGradientColor(((O.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&microstrategy.formatType==mstrRWControlImpl.FMT_TYPE_TITLE)?O.lastChild:O),X||microstrategy.formatType,g);if(O.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){return a;}for(V in this.items){if(this.items[V]!=O){Y=this.parentBone.getGradientColor(this.items[V],X||microstrategy.formatType,g);if(Y!=a){return null;}}}}return a;case"propBorderStyle":case"propButtonBorderStyle":if(this.isOnlyOnePanelStackSelected()&&this.panelValueFormat==1){return 0;}else{if(W&&this.isGridContainerSelected()&&this.gridValueFormatX==2){return 0;}else{if(K){return this.styleObj.getValue(this.firstItem(),e,K);}else{return this.checkBorderStyle();}}}case"AllColor":var J=this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_BORDER_LEFT_COLOR,K);return(J&&(typeof (J)!="string"||J.indexOf("#")==-1))?P.decodeValue("borderLeftColor",J):J;case"AllStyle":var B=this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_BORDER_LEFT_STYLE,K);return(B==0)?1:B;case"TopColor":case"LeftColor":case"RightColor":case"BottomColor":case"TopStyle":case"LeftStyle":case"RightStyle":case"BottomStyle":if(!this.isActive()){return null;}var E=(e.indexOf("Style")>-1);var h=(E)?"Style":"Color";I=microstrategy["HTMLATTR_BORDER_"+e.replace(h,"").toUpperCase()+"_"+h.toUpperCase()];Z=this.styleObj.getAttValue(this.firstItem(),I,K);for(V in this.items){if(this.styleObj.getAttValue(this.items[V],I,K)!=Z){return null;}}if(isNaN(Z)&&(Z==""||Z==null)){return null;}if(!E&&Z!=null&&(typeof (Z)!="string"||Z.indexOf("#")==-1)){Z=P.decodeValue("borderLeftColor",Z);}return Z;case"borders":case"Borders":if(K){return this.styleObj.getValue(this.firstItem(),e,K);}else{M=this.checkborders(this.firstItem());a=0;for(V in this.items){a=this.checkborders(this.items[V]);if(a!=M){return[0];}}return microstrategy.resolveBorderFlags(a,(e=="borders"));}case"GridHorizontal":case"Vertical":var x=(e=="Vertical")?"verticalAlign":"textAlign2";Y=this.getCommonFormatValue(this.items,x,K);return(isNaN(Y))?0:Y;case"SelectorVertical":Y=P.encodeValue("verticalAlign",this.getCommonFormatValue(this.items,"verticalAlign",K));return(isNaN(Y))?0:Y;case"TextWrap":return(this.getCommonFormatValue(this.items,"whiteSpace",K)!="nowrap");case"TextDirection":case"TextDirectionGrid":return this.getCommonFormatValue(this.items,"TextDirection",K);case"LeftPadding":case"TopPadding":case"RightPadding":case"BottomPadding":I="paddingLeft";if(e=="TopPadding"){I="paddingTop";}if(e=="RightPadding"){I="paddingRight";}if(e=="BottomPadding"){I="paddingBottom";}a=this.getCommonFormatValue(this.items,I,K);if(a!=null){a=microstrategy.number.toUserUnits(parseFloat(a)/72);}return a;}}catch(u){microstrategy.errors.log(u);}return"";};mstrDocSelectionsImpl.prototype.getFormatFromHContainer=function(C){if(!this.isActive()){return false;}var A=microstrategy.findBone(this.firstItem());if(A&&A.isHorizontal){var B=microstrategy.findAncestorWithAtt(this.firstItem(),microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(B){return this.styleObj.getAttValue(B,C);}}};mstrDocSelectionsImpl.prototype.getGridFormatInfo=function(C){if(!this.useGridFormat(C)){return null;}var B=(C)?this.allGridUnitFormat:this.gridUnitFormatX;var A=(C)?this.allGridValueFormat:this.gridValueFormatX;return{unit:B,format:A};};mstrDocSelectionsImpl.prototype.useGridFormat=function(A){return(this.isOnlyOneGridSelected()&&!(A&&(this.isGridContainerSelected())));};mstrDocSelectionsImpl.prototype.getGridFormat=function(A,C){var B=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);return B.getFormatValue(this.getGridFormatInfo(C),A);};mstrDocSelectionsImpl.prototype.resolveGridFormat=function(C,B){try{if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&C==null&&B==null){var A=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(A){return A.commands.queryState("GridSelections");}}else{var E={value:B||this.gridValueFormatX};E.unit=(C==null)?this.gridUnitFormatX:C;return E;}}catch(D){microstrategy.errors.log(D);}return{};};mstrDocSelectionsImpl.prototype.resolvePanelsFormat=function(B,A){try{var D={};D.unit=(B==null)?this.panelUnitFormat:B;D.value=(A==null)?this.panelValueFormat:A;return D;}catch(C){microstrategy.errors.log(C);}return{};};mstrDocSelectionsImpl.prototype.resolveControlFormat=function(B,A){try{var D={};D.unit=(B==null)?this.controlUnitFormat:B;D.value=(A==null)?this.controlValueFormat:A;return D;}catch(C){microstrategy.errors.log(C);}return{};};mstrDocSelectionsImpl.prototype.isGridContainerSelected=function(){if(this.isOnlyOneGridSelected()){var A=microstrategy.findBone(this.getSelectedGrid()),A=A&&A.commands.queryState("isGraphSelected");if(A){return false;}}return(this.gridUnitFormatX==microstrategy.GRID_UNIT_CONTAINER);};mstrDocSelectionsImpl.prototype.resolveFormatType=function(A,B){if(A.indexOf("Panels")>-1){microstrategy.formatType=parseInt(B.value,10)+1;}else{if(A.indexOf("Control")>-1){microstrategy.formatType=parseInt(B.value,10)+1;}else{if(parseInt(B.unit,10)==microstrategy.GRID_UNIT_CONTAINER){microstrategy.formatType=parseInt(B.value,10);}else{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}}};mstrDocSelectionsImpl.prototype.verifyFormatLevels=function(H){try{if(!H){return ;}var G=this.isOnlyOneGridSelected();var B=this.isOnlyOnePanelStackSelected();var E=this.isOnlyOneTableSelected();var F=this.isSelectorControlSelected();if(!G&&!B&&!F){return ;}var D=null;var I="";if(G){I="Grid";if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&!this.isGridContainerSelected()){var C=(this.parentBone.commands.queryState("IsPortal"))?2:1;D=this.resolveGridFormat(microstrategy.GRID_UNIT_CONTAINER,Math.min(this.gridValueFormatX,C));}else{switch(H){case"color":if(this.isGridContainerSelected()){if(!this.parentBone.commands.queryState("IsPortal")&&this.gridValueFormatX!=1){D=this.resolveGridFormat(null,1);}}break;case"font":if(this.isGridContainerSelected()){if(!this.parentBone.commands.queryState("IsPortal")){D=this.resolveGridFormat(microstrategy.GRID_OTHER,2);}else{if(this.gridValueFormatX!=2){D=this.resolveGridFormat(null,2);}}}else{if(this.gridUnitFormatX==microstrategy.GRID_BORDERS){D=this.resolveGridFormat(microstrategy.GRID_UNIT_CONTAINER,2);}}break;default:if(this.gridUnitFormatX<microstrategy.GRID_OTHER){D=this.resolveGridFormat(microstrategy.GRID_OTHER,2);}break;}}}else{if(B){I="Panels";if(H=="color"){if((this.panelUnitFormat==1||!this.parentBone.commands.queryState("IsPortal"))&&this.panelValueFormat==1){D=this.resolvePanelsFormat(null,0);}if(E){D=this.resolvePanelsFormat(0,0);}}else{if(H=="font"){if(this.parentBone.commands.queryState("IsPortal")){D=this.resolvePanelsFormat(null,1);}}else{if(H="effect"){D=this.resolvePanelsFormat(null,0);}}}}else{if(F){}}}if(D){this.setObjectFormatLevel(I,D);}}catch(A){microstrategy.errors.log(A);}};mstrDocSelectionsImpl.prototype.resetObjectFormatLevel=function(){try{if(this.isOnlyOneGridSelected()){this.setObjectFormatLevel("Grid",this.resolveGridFormat(microstrategy.GRID_UNIT_CONTAINER,1));}else{if(this.isOnlyOnePanelStackSelected()){this.setObjectFormatLevel("Panels",this.resolvePanelsFormat(0,0));}else{if(this.isSelectorControlSelected()){this.setObjectFormatLevel("Control",this.resolveControlFormat(0,0));}}}}catch(A){microstrategy.errors.log(A);}};mstrDocSelectionsImpl.prototype.setObjectFormatLevel=function(A,C){try{this.resolveFormatType(A,C);if(A.indexOf("Panels")>-1){this.panelUnitFormat=parseInt(C.unit,10);this.panelValueFormat=parseInt(C.value,10);this.parentBone.parentBone.commands.exec("proxyForGridObservers","ongridselectionschange");}else{if(A.indexOf("Control")>-1){this.controlUnitFormat=parseInt(C.unit,10);this.controlValueFormat=parseInt(C.value,10);this.parentBone.parentBone.commands.exec("proxyForGridObservers","ongridselectionschange");}else{this.gridUnitFormatX=parseInt(C.unit,10);this.gridValueFormatX=parseInt(C.value,10);var D=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(D&&D.commands&&D.isGrid){D.commands.exec("setGridUnitSelections",C);}if(C.unit<microstrategy.GRID_OTHER){this.parentBone.parentBone.commands.exec("proxyForGridObservers","ongridselectionschange");}}}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.fetchObjectFormatLevelFromGrid=function(){try{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){return ;}var C=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(C&&C.commands){var B=C.commands.queryState("GridSelections");if(!B){return ;}this.gridUnitFormatX=B.unit;this.gridValueFormatX=B.value;}}catch(A){microstrategy.errors.log(A);}};mstrDocSelectionsImpl.prototype.getCachedObjectFormatLevels=function(){try{if(!this.isOnlyOneGridSelected()&&!this.isOnlyOnePanelStackSelected()){return null;}return{id:this.firstItem().getAttribute("id"),unit:this.gridUnitFormatX,value:this.gridValueFormatX};}catch(A){microstrategy.errors.log(A);return null;}};mstrDocSelectionsImpl.prototype.evaluateLineProperties=function(J,C){try{var H="";var D=false;var I={};var L={};var K;var M;var A=false;var B=false;for(var F in J){if(C&&!microstrategy.isEnabledForItem(J[F],C)){continue;}var E=this.parentBone.styleObj.getAttValue(J[F],microstrategy.HTMLATTR_ORIENTATION);if(E=="0"){L[J[F].id]=J[F];A=true;}if(E=="1"){I[J[F].id]=J[F];B=true;}}if(C=="lengthMode"){if(B&&A){K=this.parentBone.commands.getCommonAttValue(I,microstrategy.HTMLATTR_HEIGHT_MODE,"heightMode",true);M=this.parentBone.commands.getCommonAttValue(L,microstrategy.HTMLATTR_WIDTH_MODE,"widthMode",true);return(K==M&&B&&A)?K:"";}else{if(B){return this.parentBone.commands.getCommonAttValue(I,microstrategy.HTMLATTR_HEIGHT_MODE,"heightMode",true);}else{return this.parentBone.commands.getCommonAttValue(L,microstrategy.HTMLATTR_WIDTH_MODE,"widthMode",true);}}}else{if(C=="length"){if(B&&A){K=this.parentBone.commands.getCommonAttValue(I,microstrategy.HTMLATTR_HEIGHT,"height",true);M=this.parentBone.commands.getCommonAttValue(L,microstrategy.HTMLATTR_WIDTH,"width",true);return(K!=null&&K.length!=0&&K==M)?microstrategy.number.toUserUnits(K):"";}else{if(B){K=this.parentBone.commands.getCommonAttValue(I,microstrategy.HTMLATTR_HEIGHT,"height",true);return(K!=null&&K.length!=0)?microstrategy.number.toUserUnits(K):"";}else{M=this.parentBone.commands.getCommonAttValue(L,microstrategy.HTMLATTR_WIDTH,"width",true);return(M!=null&&M.length!=0)?microstrategy.number.toUserUnits(M):"";}}}}return null;}catch(G){microstrategy.errors.log(G);return null;}};mstrDocSelectionsImpl.prototype.getCommonFormatValue=function(B,G){try{var A="";var D=false;for(var F in B){if(G&&!microstrategy.isEnabledForItem(B[F],G)){continue;}var C=this.styleObj.getValue(B[F],G);if(!D){A=C;D=true;}if(C!=A){return null;}}return A;}catch(E){microstrategy.errors.log(E);return null;}};mstrDocSelectionsImpl.prototype.getCommonFormatValue=function(H,A,F){try{var G="";var B=false;for(var C in H){if(A&&!microstrategy.isEnabledForItem(H[C],A)){continue;}var I=this.styleObj.getValue(H[C],A,F);var D={left:{p:microstrategy.HTMLATTR_WIDTH_MODE.toString(),o:microstrategy.ORIENTATION_HORIZONTAL.toString(),v:microstrategy.HTMLATTR_OLD_LEFT.toString()},top:{p:microstrategy.HTMLATTR_HEIGHT_MODE.toString(),o:microstrategy.ORIENTATION_VERTICAL.toString(),v:microstrategy.HTMLATTR_OLD_TOP.toString()}};if(A=="left"||A=="top"){if(this.styleObj.getAttValue(H[C],D[A].p)=="1"){var J=H[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if((J==microstrategy.SUBOBJTYPE_DOC_LINE&&this.styleObj.getAttValue(H[C],microstrategy.HTMLATTR_ORIENTATION)==D[A].o)||J==microstrategy.SUBOBJTYPE_DOC_SHAPE){I=this.styleObj.getAttValue(H[C],D[A].v);}}}if(!B){G=I;B=true;}if(I!=G){return null;}}return G;}catch(E){microstrategy.errors.log(E);return null;}};mstrDocSelectionsImpl.prototype.hasNoBorder=function(C){try{var A=this.styleObj.getAttValue(C,microstrategy.HTMLATTR_BORDER);return(A!=null&&A==microstrategy.NO_BORDER);}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.checkborders=function(G){try{var A=mstrDocSelectionsImpl.NOBORDERS;if(this.hasNoBorder(G)){return A;}var F=["Top","Bottom","Left","Right"];for(var B=0;B<4;B++){var H="border"+F[B];var D=parseInt(this.styleObj.getValue(G,H+"Width"),10);var C=this.styleObj.getValue(G,H+"Style");if(D>0&&(C&&C!="none")){A+=mstrDocSelectionsImpl[F[B].toUpperCase()+"BORDER"];}}if(A==mstrDocSelectionsImpl.ALLBORDERS-1){A+=mstrDocSelectionsImpl.ALLBORDERS;}return A;}catch(E){microstrategy.errors.log(E);return mstrDocSelectionsImpl.NOBORDERS;}};mstrDocSelectionsImpl.prototype.checkBorderStyle=function(){try{if(!this.isActive()){return 0;}var B=this.parentBone.checkBorderProperties(this.firstItem(),this.styleObj,"border","Width","Color");var A=this.parentBone.checkBorderProperties(this.firstItem(),this.styleObj,"border","Style","Color");for(var D in this.items){if(this.parentBone.checkBorderProperties(this.items[D],this.styleObj,"border","Width","Color")!=B){return 2;}if(this.parentBone.checkBorderProperties(this.items[D],this.styleObj,"border","Style","Color")!=A){return 2;}}return(A==2||B==2)?2:B;}catch(C){microstrategy.errors.log(C);return 0;}};mstrDocSelectionsImpl.prototype.alignObjs=function(alignId){try{if(alignId!="AlignToGrid"&&!this.isMulti()){return false;}var offset,start,end,i,id,secId,t,l;var isVertical=(alignId.indexOf("Top")!=-1||alignId.indexOf("Middle")!=-1||alignId.indexOf("Bottom")!=-1||alignId.indexOf("Vert")!=-1);if(isVertical){offset=getObjSumTop(this.firstItem().parentNode)-this.parentBone.top;var top=this.range.top-offset;var bottom=this.range.bottom-offset;var middle=top+(bottom-top)/2;}else{offset=getObjSumLeft(this.firstItem().parentNode)-this.parentBone.left;var left=this.range.left-this.leftBorderOffset-offset;var right=this.range.right-this.leftBorderOffset-offset;var center=left+(right-left)/2;}var format=mstrFormatObject;var updateManager=this.parentBone.parentBone.updateManager;var actionCollection=[];var cachedArray={};cachedArray.acrossSections=false;if(alignId.indexOf("Dist")>-1){var elements=mstr.utils.Arrays.fromHashValues(this.items);var p=(isVertical)?"top":"left";start=(isVertical)?top:left;end=(isVertical)?bottom:right;elements.sort(function(a,b){return parseInt(microstrategy.styleObj.getValue(a,p))-parseInt(microstrategy.styleObj.getValue(b,p));});var total=end-start;var sizes=new Array(this.length);var fn=(isVertical)?getObjHeight:getObjWidth;for(i=0;i<this.length;i++){sizes[i]=fn(elements[i]);total-=sizes[i];}var overlap=(total<1);if(overlap){total=(end-sizes[this.length-1]/2)-(start+sizes[0]/2);}var unit=total/(this.length-1);var pos=start;var prop=(isVertical)?"top":"left";for(i=0;i<this.length;i++){id=elements[i].getAttribute("id");secId=elements[i].parentNode.getAttribute("id");t=format.encodeValue("top",this.styleObj.getValue(elements[i],"top"));l=format.encodeValue("left",this.styleObj.getValue(elements[i],"left"));if(isVertical){actionCollection.push(updateManager.createActionObject(elements[i],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,format.encodeValue("top",pos),l],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));}else{actionCollection.push(updateManager.createActionObject(elements[i],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,t,format.encodeValue("left",pos)],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));}elements[i].style[prop]=pos+"px";if(overlap){pos=(i==this.length-2)?end-sizes[i+1]:start+sizes[0]/2+(i+1)*unit-sizes[i+1]/2;if(pos<start){pos=start;}else{if(pos+sizes[i+1]>end){pos=end-sizes[i+1];}}}else{pos+=sizes[i]+unit;}}}else{var deltaY;var deltaX;if(alignId=="AlignToGrid"){deltaY=microstrategy.snapCoordinate(this.range.top-(getObjSumTop(this.range.offsetSection.elem)-this.parentBone.top),0,true)+getObjSumTop(this.range.offsetSection.elem)-(this.range.top+this.parentBone.top);deltaX=microstrategy.snapCoordinate(this.range.left+this.leftBorderOffset,0,true)-this.range.left+this.leftBorderOffset;}for(var item in this.items){id=this.items[item].getAttribute("id");secId=this.items[item].parentNode.getAttribute("id");t=format.encodeValue("top",parseInt(this.styleObj.getValue(this.items[item],"top")));l=format.encodeValue("left",parseInt(this.styleObj.getValue(this.items[item],"left")));var objsRaw=document.getElementsByName(id);var objs=[];for(i=0;i<objsRaw.length;i++){if(this.isLocked(objsRaw[i])){continue;}objs.push(objsRaw[i]);}switch(alignId){case"AlignLeft":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,t,format.encodeValue("left",left)],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.left=left+"px";}break;case"AlignCenter":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,t,format.encodeValue("left",(center-getObjWidth(this.items[item])/2))],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.left=(center-getObjWidth(objs[i])/2)+"px";}break;case"AlignRight":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,t,format.encodeValue("left",(right-getObjWidth(this.items[item])))],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.left=(right-getObjWidth(objs[i]))+"px";}break;case"AlignTop":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,format.encodeValue("top",top),l],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.top=top+"px";}break;case"AlignMiddle":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,format.encodeValue("top",(middle-getObjHeight(this.items[item])/2)),l],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.top=(middle-getObjHeight(objs[i])/2)+"px";}break;case"AlignBottom":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,format.encodeValue("top",(bottom-getObjHeight(this.items[item]))),l],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.top=(bottom-getObjHeight(objs[i]))+"px";}break;case"AlignToGrid":var itemLeft=parseInt(this.styleObj.getValue(this.items[item],"left"));var itemTop=parseInt(this.styleObj.getValue(this.items[item],"top"));actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,format.encodeValue("top",itemTop+deltaY),format.encodeValue("left",itemLeft+deltaX)],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.top=itemTop+deltaY+"px";objs[i].style.left=itemLeft+deltaX+"px";}with(this.range){top+=deltaY;bottom+=deltaY;left+=deltaX;right+=deltaX;}break;}}actionCollection=this.resizeSubSection(false,actionCollection);actionCollection=this.resetRange(false,actionCollection);}if(actionCollection.length>0){updateManager.add(actionCollection);}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocSelectionsImpl.prototype.resizeObjs=function(E){try{if(E=="Grid"){return this.sizeToGrid();}var I=[];var C=(E=="Tallest"||E=="Shortest");var K=(E=="Shortest"||E=="Narrowest");var A=(C)?"Height":"Width";var G=(C)?microstrategy.HTMLATTR_HEIGHT_MODE:microstrategy.HTMLATTR_WIDTH_MODE;var L=-1;var J=[];for(var H in this.items){if(!this.isLocked(this.items[H])){J.push(this.items[H]);}var F=this.items[H];if(parseInt(this.styleObj.getAttValue(F,G))!=microstrategy.FIX_MODE){this.parentBone.formatSizeMode([F],A.toLowerCase()+"Mode",microstrategy.FIX_MODE,I,true);}if(microstrategy.subObjectType(F)==microstrategy.SUBOBJTYPE_DOC_LINE){if(this.styleObj.getAttValue(F,microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_HORIZONTAL){if(C){continue;}}else{if(!C){continue;}}}var D=this.styleObj["getInner"+A](F);D+=Math.round(microstrategy.getPaddingAndBorderPixels(this.items[H],A));if(L==-1){L=D;}L=Math[(K)?"min":"max"](D,L);}this.parentBone.formatSize(J,A.toLowerCase(),L+"px",I);this.resizeSubSection(false,I);this.resetRange(false,I);if(I&&I.length>0){this.parentBone.parentBone.updateManager.add(I);}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.resizeSubSection=function(F,J){try{for(var A in this.items){var C=this.items[A].parentNode;var K=microstrategy.findBone(C);if(K&&K.elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){var G=parseInt(this.styleObj.getValue(this.items[A],"top"))+getObjHeight(this.items[A]);var B=this.styleObj.getValue(this.items[A],"dropShadowEffect");if(B=="1"){var E=parseInt(this.styleObj.getValue(this.items[A],"dropShadowDepth"));var H=parseInt(microstrategy.number.toLocalUnits(mstrNumber.UNIT_PX,microstrategy.number.convertToUSUnits(mstrNumber.UNIT_PT,E,true),true));G=G-H;}if(G>getObjHeight(C)){J=K.changeSubHeight(G,F,J);if(K.isHorizontal){this.parentBone.synchHeightOfHorizontalSections(K);}}if(K.isHorizontal){var I=parseInt(this.styleObj.getValue(this.items[A],"left"))+getObjWidth(this.items[A]);if(I>getObjWidth(C)){J=K.changeSubWidth(I,F,J);}}}}this.syncUp();this.parentBone.updateLayoutWidth(J);}catch(D){microstrategy.errors.log(D);}finally{return J;}};mstrDocSelectionsImpl.prototype.resizeUnitsInFP=function(){for(var F in this.items){var C=this.items[F];var D=C.parentNode;var A=microstrategy.findBone(D);if(A.isFilterPanel){var B=[];this.parentBone.formatItems(microstrategy.createAssociativeArray(C),"width",this.parentBone.removePaddingAndBorder(C,getObjWidth(D)-2*mstrFilterPanelMaskImpl.ITEM_SPA,"width")+"px",false,B);var E=microstrategy.formatType;microstrategy.formatType=microstrategy.FORMAT_TYPE_CONTROL_TITLE;this.parentBone.formatAttribute([C],"showTitleBar",microstrategy.TRUE,false,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,B,true);microstrategy.formatType=E;if(B.length>0){this.parentBone.parentBone.updateManager.add(B);}}}};mstrDocSelectionsImpl.prototype.enforceTitleBar=function(D,B){try{D=D.elem?D:microstrategy.findBone(D);if(D.isFilterPanel){if(this.parentBone.styleObj.getAttValue(B,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)!=microstrategy.TRUE){var A={obj:null,cmdId:"IsPortal",value:true,memo:{},performFormatChange:true,submitUpdateManager:false};this.processPropertyChanges([A]);}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.resetRange=function(C,A){try{this.range=new Rect(null,null,null,null);this.range.offsetSection=null;this.range.offsetLeftSection=null;for(member in this.items){this.updateRange(this.items[member]);}return A;}catch(B){microstrategy.errors.log(B);}finally{return A;}};mstrDocSelectionsImpl.prototype.getUpdatedZIndex=function(A){var F={};var G=this.styleObj;if(G){for(var C in this.items){var E=this.items[C];var D=0;for(var B in this.items){if(G.getValue(E,"zIndex")>G.getValue(this.items[B],"zIndex")){D++;}}F[E.getAttribute("id")]=A+D;}}return F;};mstrDocSelectionsImpl.prototype.moveItems=function(mask){try{this.resetObjectFormatLevel();if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrDocSelectionsImpl.moveItems",mstrLogImpl.MOVE_ITEMS);}var newSection,oldSection,maskBone,baseTop=0,baseLeft=0,forceUpdate=false,updateManager=this.parentBone.parentBone.updateManager,format=mstrFormatObject,ac=[],deltaX=getObjLeft(this.dragRectangles),deltaY=getObjTop(this.dragRectangles),coords=mask.getAttribute(microstrategy.HTMLATTR_POINTS_TO).split("|"),maskBone=this.parentBone.getSubMaskBone(coords[0],coords[1],0);if(maskBone.elem.getAttribute("isCollapsed")=="true"){return false;}var subsectionID=mask.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT);if((deltaY!=0||deltaX!=0)&&(!this.isMulti()||this.isSameSubSection())){oldSection=this.firstItem().parentNode;if(oldSection.getAttribute("id")!=subsectionID){newSection=document.getElementById(subsectionID);}}var firstMaskTopOffset=(maskBone!=null&&parseInt(this.styleObj.getAttValue(maskBone.elem,microstrategy.HTMLATTR_HEIGHT))<parseInt(maskBone.elem.style.height))?this.parentBone.mouseoffsetTop:0,baseTop=lMouseY-getObjSumTop(mask)+this.parentBone.parentBone.elem.scrollTop-firstMaskTopOffset,baseLeft=lMouseX-getObjSumLeft(mask)+this.parentBone.parentBone.elem.scrollLeft,isPanel=String(mask.getAttribute("isPanel")).toLowerCase()=="true";if(!isPanel){baseTop-=maskBone.topOffset;baseLeft-=this.parentBone.mouseoffsetLeft;}else{if(microstrategy.getViewerBone().dividerOn){baseTop-=maskBone.topOffset;}}if(baseTop<0){baseTop=0;}if(baseLeft<0){baseLeft=0;}if(newSection){var newSecBone=microstrategy.findBone(newSection);if(newSecBone.isDetails&&this.isGridSelected()){showMessage({contents:microstrategy.descriptors.getDescriptor("3622"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(newSecBone.isDetails&&this.isPanelStackSelected()){showMessage({contents:microstrategy.descriptors.getDescriptor("4814"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(newSecBone.isDetails&&this.isSelectorControlSelected()){showMessage({contents:microstrategy.descriptors.getDescriptor("4993"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(newSecBone.isFilterPanel&&!this.isSelectorControlSelected()){showMessage({contents:"*This move operation is being cancelled because you cannot move a node other than selector to the Filter Panel.*",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}else{if(newSecBone.parentBone.isCollapsed){return ;}}if(isPanel&&this.atLeastOneTableSelected()){showMessage({contents:microstrategy.descriptors.getDescriptor("11959"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}var newItems=[];var oldSecBone=microstrategy.findBone(oldSection);oldSecBone.setNeedToUpdateMaxContentHeight(true);var orgRangeLeft=this.range.left;var orgRangeTop=this.range.top;var bWire={control:false,target:false};var bAW=microstrategy.getViewerBone().autoWire;var exceptionObjs={oldSection:{},newSection:{}};var zi=this.getUpdatedZIndex(newSecBone.maxZindex);newSecBone.maxZindex+=this.length;for(var id in this.items){if(this.isLocked(this.items[id])){continue;}var isTarget=false;var isControl=false;var type=this.items[id].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(type==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){isControl=bWire.control=true;}else{if(type==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||type==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){isTarget=bWire.target=true;}}if(oldSecBone.isFilterPanel){var sec=microstrategy.findAncestorWithAtt(oldSection,microstrategy.HTMLATTR_OBJTYPE,"dsec");var maskBone=this.parentBone.getSubMaskBone(sec.id,oldSection.id,0);this.adjustItemsInFP(oldSection,maskBone,ac,null,id,true);}else{ac=oldSecBone.reduceObjZIndex(this.items[id],ac);}ac=this.parentBone.formatItems(microstrategy.createAssociativeArray(this.items[id]),"zIndex",zi[id],false,ac);var l=microstrategy.snapCoordinate(baseLeft+(getObjSumLeft(this.items[id])-this.parentBone.left-orgRangeLeft),0,!microstrategy.SNAP_OFF);var t=microstrategy.snapCoordinate(baseTop+(getObjSumTop(this.items[id])-this.parentBone.top-orgRangeTop),0,!microstrategy.SNAP_OFF);var ca={acrossSections:true,orginalSection:oldSection,newSection:newSection};ac.push(updateManager.createActionObject(this.items[id],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011","2048241"],[mstrUpdateManager.UPDATE_LATER,id,subsectionID,format.encodeValue("top",t),format.encodeValue("left",l),"true"],[mstrUpdateManager.UPDATE_LATER,id,subsectionID,format.encodeValue("top",this.styleObj.getValue(this.items[id],"top")),format.encodeValue("left",this.styleObj.getValue(this.items[id],"left"))],ca));if(!forceUpdate){forceUpdate=(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&(bAW?(bWire.control||bWire.target):type==microstrategy.SUBOBJTYPE_DOC_TEMPLATE));}if(!forceUpdate){var item=this.items[id];this.remove(item);var objs=document.getElementsByName(id);for(var i=objs.length-1;i>=0;i--){objs[i].parentNode.removeChild(objs[i]);}if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&type==microstrategy.SUBOBJTYPE_DOC_TEXT){if(this.styleObj.getAttValue(item,microstrategy.HTMLATTR_DSS_FORMULA)!=null){this.parentBone.updateSingleTextField(item,this.styleObj.getAttValue(item,microstrategy.HTMLATTR_DSS_FORMULA).replace(/\n/g,"<br />"));}}moveObjTo(item,l,t);newItems[newItems.length]=this.parentBone.addItemsToSubsection(newSection,item,false,null,oldSecBone);this.add(document.getElementById(item.getAttribute("id")));}else{if(forceUpdate&&bAW){if(isTarget){if(!exceptionObjs.newSection.includeTargets){exceptionObjs.newSection.includeTargets=[];}exceptionObjs.newSection.includeTargets.push(id);if(!exceptionObjs.oldSection.excludeTargets){exceptionObjs.oldSection.excludeTargets=[];}exceptionObjs.oldSection.excludeTargets.push(id);}else{if(isControl){if(!exceptionObjs.newSection.includeControls){exceptionObjs.newSection.includeControls=[];}exceptionObjs.newSection.includeControls.push(id);if(!exceptionObjs.oldSection.excludeControls){exceptionObjs.oldSection.excludeControls=[];}exceptionObjs.oldSection.excludeControls.push(id);}}}}}if((bWire.control||bWire.target)&&bAW){newSecBone.wireTargets(ac,this.parentBone.parentBone.beanPath,bWire.target,exceptionObjs.newSection);oldSecBone.wireTargets(ac,this.parentBone.parentBone.beanPath,bWire.target,exceptionObjs.oldSection);}if(!forceUpdate){ac=this.resizeSubSection(false,ac);ac=this.resetRange(false,ac);}microstrategy.eventManager.notifyOrphanBones("onboneaftermove",this.getSelectedIds(),this.getActiveSectionIndex(this.firstItem()));}else{for(var id in this.items){if(this.isLocked(this.items[id])){continue;}var t=parseInt(this.styleObj.getValue(this.items[id],"top"));if(t+deltaY<0){deltaY=0-t;}}for(var id in this.items){if(this.isLocked(this.items[id])){continue;}var subsectionID=this.items[id].parentNode.getAttribute("id");var l=parseInt(this.styleObj.getValue(this.items[id],"left"));var t=parseInt(this.styleObj.getValue(this.items[id],"top"));var textDirection=this.items[id].direction||this.styleObj.getValue(this.items[id],"TextDirection")||"0";var ca={acrossSections:false};ac.push(updateManager.createActionObject(this.items[id],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,subsectionID,format.encodeValue("top",t+deltaY),format.encodeValue("left",l+deltaX)],[mstrUpdateManager.UPDATE_LATER,id,subsectionID,format.encodeValue("top",t),format.encodeValue("left",l)],ca));var objHilites=document.getElementsByName(id);for(var i=0;i<objHilites.length;i++){if(textDirection==="0"){moveObjTo(objHilites[i],Math.max(l+deltaX,0),t+deltaY);}else{this.styleObj.changeVerticalTextPosition(objHilites[i],{x:t+deltaY,y:Math.max(l+deltaX,0)});}}}with(this.range){top+=deltaY;bottom+=deltaY;left+=deltaX;right+=deltaX;}ac=this.resizeSubSection(false,ac);microstrategy.eventManager.notifyOrphanBones("onboneaftermove",this.getSelectedIds());}if(ac.length>0){updateManager.add(ac);if(forceUpdate){updateManager.flushAndSubmitChanges();}}this.onmoveend();return true;}catch(err){microstrategy.errors.log(err);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrDocSelectionsImpl.moveItems",mstrLogImpl.MOVE_ITEMS);}}};mstrDocSelectionsImpl.prototype.moveItemsToFP=function(X){try{this.resetObjectFormatLevel();if(this.isMulti()){return false;}if(X.tagName!="AREA"){return false;}var n=X.parentNode,a,C,W,L=0,N=0,R=false,I=this.parentBone.parentBone.updateManager,V=mstrFormatObject,g=[],m=getObjLeft(this.dragRectangles),h=getObjTop(this.dragRectangles),S=n.getAttribute(microstrategy.HTMLATTR_POINTS_TO).split("|"),W=this.parentBone.getSubMaskBone(S[0],S[1],0),Z=n.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT),B=X.getAttribute("ctrlId");var A=null;var T=null;if(B){A=document.getElementById(B);T=microstrategy.bone(B+"_Ctl");}if((h!=0||m!=0)&&(!this.isMulti()||this.isSameSubSection())){C=this.firstItem().parentNode;if(C.getAttribute("id")!=Z){a=document.getElementById(Z);}}if(a){var P=microstrategy.findBone(a);if(P.isFilterPanel){var o=this.getSelectedSelectorControl(),M=o&&microstrategy.findBone(o);if(o==null){showMessage({contents:"*This move operation is being cancelled because you cannot move a node other than selector to the Filter Panel.*",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}else{if(M&&M.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){showMessage({contents:"*This move operation is being cancelled because you cannot move a panel selector to the Filter Panel.*",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}}}if(P.parentBone.isCollapsed){return ;}var K=[];var e=microstrategy.findBone(C);e.setNeedToUpdateMaxContentHeight(true);var Y=this.firstItem();if(e.isFilterPanel){var c=microstrategy.findAncestorWithAtt(C,microstrategy.HTMLATTR_OBJTYPE,"dsec");var W=this.parentBone.getSubMaskBone(c.id,C.id,0);this.adjustItemsInFP(C,W,g,null,Y.id,true);}else{g=e.reduceObjZIndex(Y,g);}W.maxZIndex++;var H=X.getAttribute("soz")?X.getAttribute("soz"):W.maxZIndex;g=this.parentBone.formatItems(microstrategy.createAssociativeArray(Y),"zIndex",H,false,g);var G=X.getAttribute("coords").split(","),D=parseInt(G[0]),O=parseInt(G[1]);var Q={acrossSections:true,orginalSection:C,newSection:a};g.push(I.createActionObject(Y,mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,Y.id,Z,V.encodeValue("top",O),V.encodeValue("left",D)],[mstrUpdateManager.UPDATE_LATER,Y.id,Z,V.encodeValue("top",this.styleObj.getValue(Y,"top")),V.encodeValue("left",this.styleObj.getValue(Y,"left"))],Q));this.remove(Y);var J=document.getElementsByName(Y.id);for(var U=J.length-1;U>=0;U--){J[U].parentNode.removeChild(J[U]);}moveObjTo(Y,D,O);var F=this.parentBone.addItemsToSubsection(a,Y,false,null,e);g=this.parentBone.formatItems(microstrategy.createAssociativeArray(Y),"width",this.parentBone.removePaddingAndBorder(Y,getObjWidth(a)-2*mstrFilterPanelMaskImpl.ITEM_SPA,"width")+"px",false,g);this.add(document.getElementById(F.getAttribute("id")));this.enforceTitleBar(a,F);this.adjustItemsInFP(a,W,g,null,B);}else{this.adjustItemsInFP(C,W,g,this.firstItem().id,B);}if(g.length>0){I.add(g);if(R){I.flushAndSubmitChanges();}}this.onmoveend();return true;}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.adjustItemsInFP=function(K,H,Q,C,J,O){try{var L=this.parentBone.parentBone.updateManager,N=mstrFormatObject;if(H.adjustZIndex(C,J,O)){var M=H.getMoveItems();if(M.length<=0){return ;}var A=H.getStartArea(M[0].zIndex);var B=A?parseInt(A.getAttribute("coords").split(",")[1]):mstrFilterPanelMaskImpl.ITEM_SPA;for(var I=0;I<M.length;I++){var D=M[I];Q=this.parentBone.formatItems(microstrategy.createAssociativeArray(D.item),"zIndex",D.zIndex,false,Q);var E=A?parseInt(A.getAttribute("coords").split(",")[0]):mstrFilterPanelMaskImpl.ITEM_SPA,P=B;moveObjTo(D.item,E,P);var G={acrossSections:false};Q.push(L.createActionObject(D.item,mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,D.item.id,K.id,N.encodeValue("top",P),N.encodeValue("left",E)],[mstrUpdateManager.UPDATE_LATER,D.item.id,K.id,N.encodeValue("top",this.styleObj.getValue(D.item,"top")),N.encodeValue("left",this.styleObj.getValue(D.item,"left"))],G));B+=getObjHeight(D.item)+mstrFilterPanelMaskImpl.ITEM_SPA;}}}catch(F){microstrategy.errors.log(F);}};mstrDocSelectionsImpl.prototype.updateRange=function(F){try{var B=getObjSumLeft(F)-this.parentBone.left;var C=getObjSumTop(F)-this.parentBone.top;var A=getObjWidth(F);var D=getObjHeight(F);if((this.range.left==null)||(B<this.range.left)){this.range.left=B;this.range.offsetLeftSection=microstrategy.findBone(F.parentNode);}if((this.range.top==null)||(C<this.range.top)){this.range.top=C;this.range.offsetSection=microstrategy.findBone(F.parentNode);}if((this.range.right==null)||(B+A>this.range.right)){this.range.right=B+A;}if((this.range.bottom==null)||(C+D>this.range.bottom)){this.range.bottom=C+D;}}catch(E){microstrategy.errors.log(E);return false;}};mstrDocSelectionsImpl.prototype.sendTo=function(N){try{if(!this.isActive()||this.firstObjType()!=microstrategy.OBJTYPE_DOC_OBJECT){return true;}var L=[];var A=mstr.utils.Arrays.fromHashValues(this.items);A.sort(function(P,O){return parseInt(P.style.zIndex)-parseInt(O.style.zIndex);});switch(N){case"back":for(j=A.length-1;j>=0;j--){var G=A[j].parentNode;var C=microstrategy.findBone(G);if(C){var K=this.styleObj.getValue(A[j],"zIndex");for(i=0;i<G.childNodes.length;i++){var D=G.childNodes[i];if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var J=this.styleObj.getValue(D,"zIndex");if(J<K){J++;L=this.parentBone.formatItems(microstrategy.createAssociativeArray(D),"zIndex",J,false,L);}}}K=C.minZindex;L=this.parentBone.formatItems(microstrategy.createAssociativeArray(A[j]),"zIndex",K,false,L);}}break;case"front":for(j=0;j<A.length;j++){var G=A[j].parentNode;var C=microstrategy.findBone(G);if(C){var K=this.styleObj.getValue(A[j],"zIndex");for(i=0;i<G.childNodes.length;i++){var D=G.childNodes[i];if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var J=this.styleObj.getValue(D,"zIndex");if(J>K){J--;L=this.parentBone.formatItems(microstrategy.createAssociativeArray(D),"zIndex",J,false,L);}}}K=C.maxZindex-1;L=this.parentBone.formatItems(microstrategy.createAssociativeArray(A[j]),"zIndex",K,false,L);}}break;case"oneBack":var E=false;for(j=0;j<A.length;j++){var G=A[j].parentNode;var C=microstrategy.findBone(G);if(C){var K=this.styleObj.getValue(A[j],"zIndex");if(K!=C.minZindex){var M=null;var I=null;for(i=0;i<G.childNodes.length;i++){var D=G.childNodes[i];if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var J=this.styleObj.getValue(D,"zIndex");var B=D.getAttribute("id");if(J<K&&this.items[B]==null){if(M==null){M=i;I=K-J;}else{if(K-J<I){M=i;I=K-J;}}}}}if(M!=null){var D=G.childNodes[M];var J=this.styleObj.getValue(D,"zIndex");L=this.parentBone.formatItems(microstrategy.createAssociativeArray(D),"zIndex",K,false,L);L=this.parentBone.formatItems(microstrategy.createAssociativeArray(A[j]),"zIndex",J,false,L);}}}}break;case"oneFront":for(j=A.length-1;j>=0;j--){var G=A[j].parentNode;var C=microstrategy.findBone(G);if(C){K=this.styleObj.getValue(A[j],"zIndex");if(K!=C.maxZindex-1){var M=null;var I=null;for(i=0;i<G.childNodes.length;i++){var D=G.childNodes[i];if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var J=this.styleObj.getValue(D,"zIndex");var B=D.getAttribute("id");if(J>K&&this.items[B]==null){if(M==null){M=i;I=J-K;}else{if(J-K<I){M=i;I=J-K;}}}}}if(M!=null){var D=G.childNodes[M];var J=this.styleObj.getValue(D,"zIndex");L=this.parentBone.formatItems(microstrategy.createAssociativeArray(D),"zIndex",K,false,L);L=this.parentBone.formatItems(microstrategy.createAssociativeArray(A[j]),"zIndex",K,false,L);L=this.parentBone.formatItems(microstrategy.createAssociativeArray(A[j]),"zIndex",J,false,L);}}}}break;}var H=this.parentBone.parentBone.updateManager;if(L.length>0){H.add(L);}}catch(F){microstrategy.errors.log(F);}};mstrDocSelectionsImpl.prototype.enablePropertiesEditor=function(){try{var C=false;for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){C=true;break;}}if((this.length>1&&C==true)||this.length==0){return false;}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.getSelectedGrid=function(){return this.getSelectedControl(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);};mstrDocSelectionsImpl.prototype.getSelectedControl=function(A){try{for(var D in this.items){var C=this.items[D];if(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==A){return C;break;}}return null;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.getSelectedPanelStack=function(){return this.getSelectedControl(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);};mstrDocSelectionsImpl.prototype.getSelectedSelectorControl=function(){return this.getSelectedControl(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);};mstrDocSelectionsImpl.prototype.getPortalGridWithProperty=function(D){try{for(var C in this.items){var B=this.items[C];if(B.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&B.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&microstrategy.styleObj.getAttValue(B,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE&&microstrategy.styleObj.getAttValue(B,microstrategy.HTMLATTR_WINDOW_STATE)==D){return B;break;}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneCtrlDftObjSelected=function(){try{return(!this.isMulti()&&this.parentBone.parentBone.objProps.isCtrlDftObj(this.firstItem()));}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneCtrlDftObjSelected=function(){try{for(var B in this.items){if(this.parentBone.parentBone.objProps.isCtrlDftObj(this.items[B])){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneRectangleSelected=function(){try{for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SHAPE&&this.items[B].getAttribute(microstrategy.HTMLATTR_STYLE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneRoundedRectangleSelected=function(){try{for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SHAPE&&this.items[B].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneSubtypeSelected=function(D){try{var C=D.toString();for(var B in this.items){if(microstrategy.isValueInFilter(this.items[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE),C)){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneControlSelected=function(){try{for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isGridSelected=function(){try{return(this.getSelectedGrid()!=null);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isPanelStackSelected=function(){try{return(this.getSelectedPanelStack()!=null);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isSelectorControlSelected=function(){try{return(this.getSelectedSelectorControl()!=null);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.areAllSameSubtypeSelected=function(A){try{for(var D in this.items){var C=this.items[D];if(!(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==A)){return false;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isGridOrGraphSelected=function(){try{var B=this.getSelectedGrid();if(B){var A=microstrategy.findBone(B);if(A!=null){if(A.isGraph&&A.isGrid){return microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;}if(A.isGraph){return microstrategy.DISPLAY_MODE_GRAPH;}if(A.isGrid){return microstrategy.DISPLAY_MODE_GRID;}}}return false;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneSelectorCtrlSelected=function(){try{return(!this.isMulti()&&this.isSelectorControlSelected());}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneGridSelected=function(){try{return(!this.isMulti()&&this.isGridSelected());}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneGraphSelected=function(){try{var B=this.isGridOrGraphSelected();return(!this.isMulti()&&(B==microstrategy.DISPLAY_MODE_GRID_AND_GRAPH||B==microstrategy.DISPLAY_MODE_GRAPH));}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneGGridSelected=function(){try{var A=this.isGridOrGraphSelected();return(!this.isMulti()&&(A==microstrategy.DISPLAY_MODE_GRID_AND_GRAPH||A==microstrategy.DISPLAY_MODE_GRID));}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyRoundedRectanglesSelected=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE||this.items[C].getAttribute(microstrategy.HTMLATTR_STYLE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlySquareRectanglesSelected=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE||this.items[C].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyRectanglesSelected=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyImagesSelected=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_IMAGE){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyLinesSelected=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_LINE){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOnePanelStackSelected=function(){try{return(this.isPanelStackSelected()&&!this.isMulti());}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneTableSelected=function(){try{for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var A=microstrategy.bones[this.items[C].id];if(A&&A.isTable){return true;}}}return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneTableSelected=function(){try{var A=false;if(this.isOnlyOnePanelStackSelected()){var C=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);A=C&&C.isTable;}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.areAllSelectedPanelStacks=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneButtonSelected=function(){try{return(this.length==1&&this.getSelectedButtons())?true:false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.getSelectedButtons=function(){try{var C=[];for(var D in this.items){var B=this.items[D];if(B.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT){if(microstrategy.styleObj.getAttValue(B,microstrategy.HTMLATTR_DISPLAY_STYLE)>0){C.push(B);}}}if(C.length){return C;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneNavBarSelected=function(){try{return(this.isOnlyOnePanelStackSelected()&&microstrategy.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_USE_AS_NAVIGATION_BAR)==microstrategy.TRUE);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isItemInsideNavBar=function(){try{var B=microstrategy.findAncestorWithAtt(this.firstItem(),microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(B&&B!=this.firstItem()&&B.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var A=microstrategy.findBone(B);return A&&A.isNavigationBar;}return false;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.isEmptyTemplateSelected=function(){try{for(var E in this.items){var B=this.items[E];if(B.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&B.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var D=document.getElementsByName(E);var C=microstrategy.bone("grid_"+E+"_"+0);if(!C){C=microstrategy.bone("grid_"+E);}if(C&&C.isTemplateEmpty()){return true;}}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.nubmerOfLinesSelected=function(A){try{var D=0;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_LINE&&this.styleObj.getAttValue(this.items[C],microstrategy.HTMLATTR_ORIENTATION)==A){D++;}}return D;}catch(B){microstrategy.errors.log(B);return null;}};mstrDocSelectionsImpl.prototype.isItemOfTypeSelected=function(B){try{var A=false;for(var D in this.items){if(microstrategy.styleObj.getAttValue(this.items[D],microstrategy.HTMLATTR_SUBOBJTYPE)==B){A=true;break;}}return A;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.isImageReady=function(){try{var A=false;for(var E in this.items){var D=this.items[E];if(D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_IMAGE){var B=D.getElementsByTagName("IMG")[0];A|=B.readyState=="complete"||B.complete==true;}}return A;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.getSelectedGridProperty=function(D){try{var A=this.getSelectedGrid();var C=microstrategy.findBone(A);return(C)?C[D]:false;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.getSelectedGridFeature=function(B){try{var A=this.getSelectedGrid();var D=microstrategy.findBone(A);return(D)?D.isFeatureAvailable(B):false;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.hiliteSelected=function(G){try{var H=G.getAttribute("id");this.items[H]=G;var B=this.hilites[H].base;var A=this.hilites[H].items[B];if(!A){var F=document.getElementsByName(H);for(var D=0;D<F.length;D++){var C=microstrategy.findBone(F[D]);if(C&&C.isGridInCellSelectionMode()){C.selections.clearAll();}}this.addHilites(G);}else{if(A.src!=G){setFilter(A.src,"Alpha",{opacity:this.selectionOpacity});setFilter(G,"Alpha",{opacity:100});A.src=G;this.syncUp(G);this.resetRange();}}this.setPanelStackSelectionHandleEvents(G);this.setGridSelectionHandleEvents(G);}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.hiliteElements=function(D){try{if(!bIsW3C||bIsIE8){return ;}var C=document.getElementsByName(D.getAttribute("id"));for(var A=0;A<C.length;A++){setFilter(C[A],"Alpha",{opacity:this.selectionOpacity});}setFilter(D,"Alpha",{opacity:100});}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.setGridSelectionHandleEvents=function(C){try{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&microstrategy.styleObj.getAttValue(C,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)!=microstrategy.TRUE){var A=microstrategy.findBone(C);if(A!=null){if(A.onmouseover&&A.onmouseout){this.elem.onmouseover=new Function("e","return microstrategy.bone('"+A.id+"').onmouseover(e);");this.elem.onmouseout=new Function("e","return microstrategy.bone('"+A.id+"').onmouseout(e);");}}}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.removeGridSelectionHandleEvents=function(C){try{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_TEMPLATE){return ;}var A=microstrategy.findBone(C);if(A!=null){if(A.onmouseover&&A.onmouseout){this.elem.onmouseover=null;this.elem.onmouseout=null;}}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.restoreElements=function(D){try{var C=document.getElementsByName(D);for(var A=0;A<C.length;A++){setFilter(C[A],"Alpha",{opacity:100});}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.processAddToSelections=function(E){try{if(this.firstItem()){var D=microstrategy.findBone(this.firstItem().parentNode);var C=microstrategy.findBone(E.parentNode);if(D.subsectionType==C.subsectionType){switch(C.subsectionType){case mstrSubSection.TYPE_FIXED:return E;case mstrSubSection.TYPE_PANEL:if(C.id==D.id){return E;}else{var A=this.getPeerSubsection(C,D.id);if(A){return A.elem;}else{return null;}}break;}}else{switch(C.subsectionType){case mstrSubSection.TYPE_FIXED:return null;case mstrSubSection.TYPE_PANEL:var A=this.getPeerSubsection(C,D.id);if(A){return A.elem;}else{return null;}}}}else{return E;}}catch(B){microstrategy.errors.log(B);return null;}};mstrDocSelectionsImpl.prototype.selectAll=function(E){try{this.clear(true);var F=microstrategy.objectListFind(this.parentBone.elem,"span",microstrategy.OBJTYPE_DOC_OBJECT);var A="";for(var C=0;C<F.length;C++){var G=F[C].getAttribute("id")+"|";if(A.indexOf(G)==-1){A+=G;var B=this.processAddToSelections(F[C]);if(B){this.add(B);}}}return false;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocSelectionsImpl.prototype.getOffsetSubsection=function(){try{return this.range.offsetSection;}catch(A){microstrategy.errors.log(A);return null;}};mstrDocSelectionsImpl.prototype.getSelectedSubsection=function(){try{if(!this.isActive()){return null;}var A=this.firstItem();if(A.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return microstrategy.findBone(A);}if(this.isSameSubSection()){return this.getOffsetSubsection();}return null;}catch(B){microstrategy.errors.log(B);return null;}};mstrDocSelectionsImpl.prototype.finishAdd=function(C,B){try{return this.finishAddAllObjs(microstrategy.createAssociativeArray(C),B);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.finishAddAllObjs=function(F,C,H){try{this.clear();var A=(typeof (H)!="undefined"&&H==false)?false:true;var E=null;for(var G in F){E=F[G];this.add(E);}C=this.resizeSubSection(false,C);C=this.resetRange(false,C);this.parentBone.commands.exec("ctrlJustAdded");if(this.parentBone.parentBone.observer){this.parentBone.parentBone.observer.notifyAll("onaddcontrol");}if(E&&A){if(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT){this.parentBone.editText(null,E);}else{if(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){var D=microstrategy.findRWObjectBone(E,"mstrHTMLContainerImpl");D.editContents(null);}}}}catch(B){microstrategy.errors.log(B);}return C;};mstrDocSelectionsImpl.prototype.setPanelStackSelectionHandleEvents=function(C){try{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var A=microstrategy.findBone(C);if(A!=null){if(A.onmouseover&&A.onmouseout){this.elem.onmouseover=new Function("e","return microstrategy.bone('"+A.id+"').onmouseover(e);");this.elem.onmouseout=new Function("e","return microstrategy.bone('"+A.id+"').onmouseout(e);");}}}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.removePanelStackSelectionHandleEvents=function(C){try{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){return ;}var A=microstrategy.findBone(C);if(A!=null){if(A.onmouseover&&A.onmouseout){this.elem.onmouseover=null;this.elem.onmouseout=null;}}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.getTransactionUnitKey=function(){try{if(this.isActive()&&!this.isMulti()){var D=this.firstItem();if(this.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEMPLATE)){var C=microstrategy.findBone(D),A=C&&C.commands;if(A&&!A.queryState("isLinkedTemplate")&&(A.queryEnabled("attForms")||A.queryEnabled("hasmetrics"))){return{k:D.id};}}else{if(this.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)){if(microstrategy.findAncestorWithAtt(D,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_PANEL_STACK)!=null){return{k:(D.parentNode.getAttribute("fgkey")||""),sk:D.parentNode.id};}}}}return null;}catch(B){microstrategy.errors.log(B);}};function mstrDocSelectionsImpl(){return this;}mstrDocHilite.prototype={};mstrDocHilite.prototype.parentBone=null;mstrDocHilite.prototype.base=0;mstrDocHilite.prototype.items=null;mstrDocHilite.prototype.vflipped=false;mstrDocHilite.prototype.hflipped=false;mstrDocHilite.OFFSET=2;mstrDocHilite.HANDLE_SIZE=7;mstrDocHilite.prototype.getDefault=function(){return(this.items.length>0)?this.items[this.base]:null;};mstrDocHilite.prototype.setDefault=function(C){try{for(var A=0;A<this.items.length;A++){if(this.items[A]==C){this.base=A;break;}}}catch(B){microstrategy.errors.log(B);}return ;};mstrDocHilite.prototype.syncHilites=function(C){try{var J=microstrategy.formatType;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;var O=mstrFormatObject;for(var H=0;H<this.items.length;H++){var G=this.items[H].src;var E=getObjSumLeft(G)-C.parentBone.left;if(bIsIE7&&!bIsIE8&&!bIsIE10){if(G.offsetWidth>0){var N=G.getBoundingClientRect();var I=Math.round((N.right-N.left)/G.offsetWidth*100);E=E/I*100;}}var M;if(!bIsDXIE){var L=microstrategy.getViewerBone().elem;M=G.getBoundingClientRect().top-2+getDocumentScrollTop()+(L&&L.scrollTop)||0;}else{M=getObjSumTop(G);}M=M-C.parentBone.top;var Q=0;var B=0;if(G.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_LINE){var P=microstrategy.styleObj.getValue(G,"borderTopWidth");var D=microstrategy.styleObj.getValue(G,"borderLeftWidth");if(P&&parseFloat(P)>0){Q=parseInt(O.getPxFromPt(parseFloat(P)));B=parseInt(this.styleObj.getValue(G,"width"));}if(D&&parseFloat(D)>0){Q=parseInt(this.styleObj.getValue(G,"height"));B=parseInt(O.getPxFromPt(parseFloat(D)));}}else{var A,K;A=this.styleObj.getInnerHeight(G);K=this.styleObj.getInnerWidth(G);Q=Math.floor(A+microstrategy.getPaddingAndBorderPixels(G,"height"));B=Math.floor(K+microstrategy.getPaddingAndBorderPixels(G,"width"));}this.items[H].style.left=E+"px";this.items[H].style.top=M+"px";if(Q>0){this.items[H].style.height=Q+"px";}if(B>0){this.items[H].style.width=B+"px";}}this.syncHandles();microstrategy.formatType=J;}catch(F){microstrategy.errors.log(F);}return ;};mstrDocHilite.prototype.syncHandles=function(F){try{var C=this.getDefault();if(C==null){return ;}var H=parseInt(C.style.height);var I=parseInt(C.style.width);if(isNaN(H)||isNaN(I)){return ;}var B=(C.style.borderTopWidth.length>0&&C.style.borderTopWidth!="none"&&C.style.borderTopWidth!="0pt")?1:0;var G=-Math.floor(mstrDocHilite.HANDLE_SIZE/2);C.setAttribute("oHeight",C.style.height);C.setAttribute("oWidth",C.style.width);if(C.src.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_LINE){var D=mstrDocHilite.OFFSET-mstrDocHilite.HANDLE_SIZE;var J=C.childNodes[0].className;var A=(this.styleObj.getAttValue(C.src,microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_VERTICAL);if(A){if(J=="w"||J=="e"){C.childNodes[0].className="n";C.childNodes[1].className="s";}B=(C.style.borderLeftWidth.length>0&&C.style.borderLeftWidth!="none"&&C.style.borderLeftWidth!="0pt")?1:0;moveObjTo(C.childNodes[0],G-B,D);moveObjTo(C.childNodes[1],G-B,H+G);}else{if(J=="n"||J=="s"){C.childNodes[0].className="w";C.childNodes[1].className="e";}moveObjTo(C.childNodes[0],D,G-B);moveObjTo(C.childNodes[1],I+G,G-B);}}else{C.childNodes[0].style.top=C.childNodes[1].style.top=C.childNodes[2].style.top=-5-B+"px";C.childNodes[0].style.left=C.childNodes[3].style.left=C.childNodes[5].style.left=-5-B+"px";C.childNodes[3].style.top=C.childNodes[4].style.top=(Math.floor(H/2)+G)+"px";C.childNodes[5].style.top=C.childNodes[6].style.top=C.childNodes[7].style.top=(H-2+B)+"px";C.childNodes[1].style.left=C.childNodes[6].style.left=(Math.floor(I/2)+G)+"px";C.childNodes[2].style.left=C.childNodes[4].style.left=C.childNodes[7].style.left=(I-2+B)+"px";}}catch(E){microstrategy.errors.log(E);}return ;};function mstrDocHilite(A){this.items=[];this.parentBone=A;this.styleObj=A.styleObj;return this;}mstrResizeDocObjs.prototype={};mstrResizeDocObjs.prototype.onload=function(C,B){try{this.parentBone=C;this.path=B;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.doc=this.parentBone.parentBone;this.oc=this.parentBone.objCache;this.um=this.doc.parentBone.updateManager;}catch(A){microstrategy.errors.log(A);}return false;};mstrResizeDocObjs.prototype.onresizestart=function(C,A){try{if(!C){C=window.event;}if(C.e){C=C.e;}this.items=this.parentBone.items;this.doc.syncPosition();this.oc.resizeStyle=A;this.parentBone.hilites[this.oc.activeHilite.getAttribute("id").substr(6)].setDefault(this.oc.activeHilite);this.parentBone.toggleHiliteBorders(true);if(typeof (mstr)!="undefined"){this.parentBone.parentBone.attachWinListener(this,"mousemove","onresize");this.parentBone.parentBone.attachWinListener(this,"mouseup","onresizeend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".onresize(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onresizeend(e); }");}for(var D in this.items){if(this.items[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){microstrategy.bone(this.items[D].firstChild.id).toggleCurtain(true);}}this.onresize(C);}catch(B){microstrategy.errors.log(B);}return false;};mstrResizeDocObjs.prototype.checkMovedDistance=function(E){var D=parseInt(microstrategy.SNAP_SIZE/2),C=this.parentBone,B=this.getMovedDistance(E),A=Math.abs(B.x)%D,G=Math.abs(B.y)%D,F=parseInt(D/2);A=A>F?D-A:A;G=G>F?D-G:G;return A>=F||G>=F;};mstrResizeDocObjs.prototype.getMovedDistance=function(E){var C=this.parentBone,B=C.docViewer.elem;var A=(mstr.utils.ISFF2||mstr.utils.ISIE8)?(B.scrollLeft-C.mousedownScrollLeft):0,D=B.scrollTop-C.mousedownScrollTop;return{x:A+lMouseX-C.mousedownX,y:D+lMouseY-C.mousedownY};};mstrResizeDocObjs.prototype.onresize=function(S){try{if(!S){S=window.event;}if(S.e){S=S.e;}var B=this.parentBone;getMouse(S);B.getMouseDirection();var K=(S.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF;if(!K&&!this.checkMovedDistance(S)){return false;}var G=dy=dr=db=1;var L=this.oc.activeHilite.getAttribute("id").substr(6);var R=this.oc.resizeStyle;var C=new RectObj(B.hilites[L].getDefault().src);var E=this.getMovedDistance(S);if(R.indexOf("w")>-1){G=(C.width-E.x)/C.width;}if(R.indexOf("e")>-1){dr=(C.width+E.x)/C.width;}if(R.indexOf("n")>-1){dy=(C.height-E.y)/C.height;}if(R.indexOf("s")>-1){db=(C.height+E.y)/C.height;}var O=this.getNewRects(R,G,dy,dr,db,true,true,K);if(!O){return false;}var P=0;var U=microstrategy.findBone(this.items[L].parentNode);this.dxoff=this.dyoff=this.droff=this.dboff=0;if(!K&&U.canShowGuideline()){if(R.indexOf("w")>-1){this.dxoff=U.guidelineOffsetX||0;}if(R.indexOf("e")>-1){this.droff=U.guidelineOffsetX||0;}if(R.indexOf("n")>-1){this.dyoff=U.guidelineOffsetY||0;}if(R.indexOf("s")>-1){this.dboff=U.guidelineOffsetY||0;}}for(var L in this.items){if(this.parentBone.isLocked(this.items[L])){continue;}var A=this.parentBone.hilites[L].getDefault();var J=O&&O[P++];if((this.dxoff||this.droff||this.dyoff||this.dboff)){this.previousRect=J;J=this.adjustForGuidelineSnapOffset(J,R);var R=A.style;R.width=Math.max(Math.ceil(J.width-microstrategy.getPaddingAndBorderPixels(A,"width")),0)+"px";R.height=Math.max(Math.ceil(J.height-microstrategy.getPaddingAndBorderPixels(A,"height")),0)+"px";if(U.isHorizontal){R.left=J.left+getObjSumLeft(this.items[L].parentNode)-this.doc.left+"px";}else{R.left=J.left+"px";}R.top=J.top+"px";this.parentBone.hilites[L].syncHandles(true);U.showGuidelines(U.getLocalPosition(A));}else{if(!(this.previousRect&&(J.left==this.previousRect.left&&J.top==this.previousRect.top&&J.width==this.previousRect.width&&J.height==this.previousRect.height))){this.previousRect=null;var T=this.parentBone.parentBone.selections.mouseDir,H=T.x,M=T.y;var F=Math.max(parseInt(J.width-microstrategy.getPaddingAndBorderPixels(A,"width")),0),Q=Math.max(parseInt(J.height-microstrategy.getPaddingAndBorderPixels(A,"height")),0),I=J.top,N=U.isHorizontal?J.left+getObjSumLeft(this.items[L].parentNode)-this.doc.left:J.left,R=A.style;if(H<0&&N<parseInt(R.left)||H>0&&N>parseInt(R.left)){R.left=N+"px";}if(M<0&&I<parseInt(R.top)||M>0&&I>parseInt(R.top)){R.top=I+"px";}if(H<0&&F<parseInt(R.width)||H>0&&F>parseInt(R.width)){R.width=F+"px";}if(M<0&&Q<parseInt(R.height)||M>0&&Q>parseInt(R.height)){R.height=Q+"px";}this.parentBone.hilites[L].syncHandles(true);U.showGuidelines(U.getLocalPosition(A));}}}}catch(D){microstrategy.errors.log(D);}return false;};mstrResizeDocObjs.prototype.onresizeend=function(G){try{if(!G){G=window.event;}if(G.e){G=G.e;}this.parentBone.onmouseup(G,this.path);for(var H in this.items){if(this.items[H].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){microstrategy.bone(this.items[H].firstChild.id).toggleCurtain(false);}}var H=this.oc.activeHilite.getAttribute("id").substr(6);if(!this.parentBone.hilites[H]){return ;}var E=new RectObj(this.parentBone.hilites[H].getDefault().src);this.parentBone.toggleHiliteBorders(false);var C=this.oc.resizeStyle;var A=dy=dr=db=0;var B=this.getMovedDistance(G);if(C.indexOf("w")>-1){A=-B.x;}if(C.indexOf("e")>-1){dr=B.x;}if(C.indexOf("n")>-1){dy=-B.y;}if(C.indexOf("s")>-1){db=B.y;}var F=(G.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF;this.resizeItems(C,A,dy,dr,db,true,F);this.oc.activeHilite=null;for(var H in this.parentBone.hilites){this.parentBone.hilites[H].vflipped=this.parentBone.hilites[H].hflipped=false;}microstrategy.eventManager.notifyOrphanBones("onboneafterresize",this.parentBone.getSelectedIds());this.doc.parentBone.isDragging=false;this.parentBone.parentBone.selections.syncPositionMap(this.items);}catch(D){microstrategy.errors.log(D);}return false;};mstrResizeDocObjs.prototype.getNewRects=function(U,M,L,P,Z,H,D,O){try{this.items=this.parentBone.items;var S=[];var X=100000;var W=100000;var a=-100000;var I=-100000;for(var Q in this.items){var N=this.items[Q];var K=N.parentNode;var C=new RectObj(N);var T=new RectObj(K);X=Math.min(((C.right-getObjSumLeft(K))/C.width),X);W=Math.min(((C.bottom-getObjSumTop(K))/C.height),W);a=Math.max(((C.left-T.right)/C.width),a);I=Math.max(((C.top-T.bottom)/C.height),I);}var B=N.parentNode.getAttribute("sty")==microstrategy.SUBOBJTYPE_DOC_PANEL;if(B){M=Math.max(1+a,Math.min(X,M));P=Math.min(-a,Math.max(1-X,P));L=Math.max(1+I,Math.min(W,L));Z=Math.min(-I,Math.max(1-W,Z));}else{M=Math.min(X,M);P=Math.max(1-X,P);L=Math.min(W,L);Z=Math.max(1-W,Z);}for(var Q in this.items){var A=this.parentBone.hilites[Q];var N=this.items[Q];var G=N.parentNode;var C=new RectObj(N);var R=C.height;var J=C.width;C.add(Math.round(-C.width*M+C.width),Math.round(-C.height*L+C.height),Math.round(C.width*P-C.width),Math.round(C.height*Z-C.height));var Y=microstrategy.findBone(this.items[Q].parentNode);if(Y.isHorizontal){C.setBase(((bIsW3C)?this.parentBone.leftBorderOffset:0)+getObjSumLeft(K),this.doc.top);}else{C.setBase(this.doc.left+((bIsW3C)?this.parentBone.leftBorderOffset:0),this.doc.top);}var F=snapY=snapR=snapB=0;if(M&&M!=1){F=microstrategy.snapCoordinate(C.left,0,!O,(M<1)?microstrategy.SNAP_DIRET_POS:microstrategy.SNAP_DIRET_NEG)-C.left;}if((L&&L!=1)&&!O){snapY=microstrategy.snapCoordinate(C.top,(getObjSumTop(G)-this.doc.top),!O,(L<1)?microstrategy.SNAP_DIRET_POS:microstrategy.SNAP_DIRET_NEG)-C.top;}if(P&&P!=1){snapR=microstrategy.snapCoordinate(C.right,0,!O,(P>1)?microstrategy.SNAP_DIRET_POS:microstrategy.SNAP_DIRET_NEG)-C.right;}if((Z&&Z!=1)&&!O){snapB=microstrategy.snapCoordinate(C.bottom,getObjSumTop(G)-this.doc.top,!O,(Z>1)?microstrategy.SNAP_DIRET_POS:microstrategy.SNAP_DIRET_NEG)-C.bottom;}if(!O&&B){if((Z!=1)&&(C.height+snapB)>(R*-I)){snapB=1;}if((L!=1)&&(C.height-snapY)<(R*(1+I))){snapY=1;}if((M!=1)&&((C.width-F)>(J*X)||(C.width-F)<(J*(1+a)))){F=1;}if((P!=1)&&((C.width+snapR)>(J*-a)||(C.width+snapR)<(J*(1-X)))){snapR=1;}}C.add(F,snapY,snapR,snapB);if(this.parentBone.styleObj.getAttValue(this.items[Q],microstrategy.HTMLATTR_LOCK_ASPECT_RATIO)==microstrategy.TRUE&&U.length==2){var V=new RectObj(N);M=P=C.width/V.width;L=Z=C.height/V.height;if(U.indexOf("n")>-1){if(U.indexOf("w")>-1){M=L=Math.abs(M)>Math.abs(L)?M:L;if(W<L){M=L=W;}if(X<M){L=M=X;}P=Z=1;}else{P=L=Math.abs(P)>Math.abs(L)?P:L;if(W<L){P=L=W;}M=Z=1;}}else{if(U.indexOf("w")>-1){M=Z=Math.abs(M)>Math.abs(Z)?M:Z;if(X<M){Z=M=X;}L=P=1;}else{P=Z=Math.abs(P)>Math.abs(Z)?P:Z;M=L=1;}}C=new RectObj(N);C.add(Math.round(-C.width*M+C.width),Math.round(-C.height*L+C.height),Math.round(C.width*P-C.width),Math.round(C.height*Z-C.height));if(Y.isHorizontal){C.setBase(this.parentBone.leftBorderOffset+getObjSumLeft(K),this.doc.top);}else{C.setBase(this.doc.left+this.parentBone.leftBorderOffset,this.doc.top);}}if(C.checkHFlip()){if(!H){return null;}if(D){A.hflipped=!A.hflipped;}}if(C.checkVFlip()){if(!H){return null;}if(D){A.vflipped=!A.vflipped;}}S.push(C);}return S;}catch(E){microstrategy.errors.log(E);}};mstrResizeDocObjs.prototype.adjustForGuidelineSnapOffset=function(F){try{var C=parseInt(this.dxoff)||0,H=parseInt(this.droff)||0,L=parseInt(this.dyoff)||0,K=parseInt(this.dboff)||0;var B=microstrategy.SNAP_SIZE;if(Math.abs(C)<B&&Math.abs(H)<B&&Math.abs(L)<B&&Math.abs(K)<B){var G={left:0,top:0,width:0,height:0};var A=this.oc.resizeStyle,I=this.parentBone.parentBone.selections.mouseDir,J=I.x,E=I.y;if(A.indexOf("w")>-1&&(J<0&&C>0||J>0&&C<0)){F.left+=J*(Math.abs(C));F.width-=J*(Math.abs(C));G.left=J*(Math.abs(C));G.width=-J*(Math.abs(C));}if(A.indexOf("e")>-1&&(J<0&&H>0||J>0&&H<0)){F.width+=J*(Math.abs(H));G.width=J*(Math.abs(H));}if(A.indexOf("n")>-1&&(E<0&&L>0||E>0&&L<0)){F.top+=E*(Math.abs(L));F.height-=E*(Math.abs(L));G.top=E*(Math.abs(L));G.height=-E*(Math.abs(L));}if(A.indexOf("s")>-1&&(E<0&&K>0||E>0&&K<0)){F.height+=E*(Math.abs(K));G.height=E*(Math.abs(L));}this.deltaRect=G;}return F;}catch(D){microstrategy.errors.log(D);}};mstrResizeDocObjs.prototype.resizeItems=function(R,K,J,O,U,F,N){if(!this.parentBone.isActive()){return true;}try{if(F){var E=this.parentBone.hilites[this.oc.activeHilite.getAttribute("id").substr(6)].getDefault().src;}else{var E=this.parentBone.firstItem();for(var P in this.items){var L=this.items[P];if(R.indexOf("e")>-1&&getObjWidth(L)<getObjWidth(E)){E=L;}if(R.indexOf("s")>-1&&getObjHeight(L)<getObjHeight(E)){E=L;}}}var A=new RectObj(E);var I=1;var M=1;var H=1;var T=1;var G=0;if(R.indexOf("w")>-1){I=(A.width+K)/A.width;G+=microstrategy.WIDTH_UPDATE;}if(R.indexOf("e")>-1){M=(A.width+O)/A.width;G+=microstrategy.WIDTH_UPDATE;}if(R.indexOf("n")>-1){H=(A.height+J)/A.height;G+=microstrategy.HEIGHT_UPDATE;}if(R.indexOf("s")>-1){T=(A.height+U)/A.height;G+=microstrategy.HEIGHT_UPDATE;}var Q=this.getNewRects(R,I,H,M,T,F,false,N);if(!Q){this.parentBone.syncUp();return true;}this.items=this.parentBone.items;var S=[];var C=0;var D=false;for(var P in this.items){if(this.parentBone.isLocked(this.items[P])){continue;}if(this.resizeItem(this.items[P],Q[C++],S,G)){D=true;}}S=this.parentBone.resizeSubSection(false,S);S=this.parentBone.resetRange(false,S);if(S&&S.length>0){this.um.add(S);if(D){this.um.flushAndSubmitChanges();}}this.parentBone.syncUp();microstrategy.eventManager.notifyOrphanBones("onboneafterresize",this.parentBone.getSelectedIds());}catch(B){microstrategy.errors.log(B);}return false;};mstrResizeDocObjs.prototype.resizeItem=function(P,B,T,J){try{var H=false;if(!this.parentBone.isActive()){return H;}var V=this.deltaRect;if(V){B.left+=V.left;B.top+=V.top;B.width+=V.width;B.height+=V.height;}var I=microstrategy.styleObj;var U=microstrategy.findBone(P.parentNode);var O=null;var R=0;if(U.isHorizontal){R=getObjSumLeft(P.parentNode)-this.doc.left;}if(bIsW3C){var A=I.getValue(this.doc.elem,"borderLeftWidth");if(A!=null&&A.indexOf("pt")>0){var M=microstrategy.getFormatObject();A=Math.round(M.getPxFromPt(parseFloat(A)));}else{A=0;}T=this.doc.formatItems(microstrategy.createAssociativeArray(P),"left",(B.left-getObjSumLeft(P.parentNode)+this.doc.left+A+R)+"px",false,T);}else{T=this.doc.formatItems(microstrategy.createAssociativeArray(P),"left",(B.left-getObjSumLeft(P.parentNode)+this.doc.left+R)+"px",false,T);}T=this.doc.formatItems(microstrategy.createAssociativeArray(P),"top",(B.top-getObjSumTop(P.parentNode)+this.doc.top)+"px",false,T);switch(P.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)){case microstrategy.SUBOBJTYPE_DOC_LINE:if(this.parentBone.styleObj.getAttValue(P,microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_VERTICAL){this.doc.formatSize(microstrategy.createAssociativeArray(P),"height",B.height+"px",T);this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"heightMode","0",T,false);}else{this.doc.formatSize(microstrategy.createAssociativeArray(P),"width",B.width+"px",T);this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"widthMode","0",T,false);}break;case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_TEXT:var C=null,L=microstrategy.styleObj.getValue(P,"TextDirection")||"0";if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){var D=this.parentBone.checkFormat("Hmode");var F=this.parentBone.checkFormat("Wmode");this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"heightMode","0",T,false);this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"widthMode","0",T,false);if(P.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){C=microstrategy.findBone(P);if(C&&((C.commands.queryState("gridMode")!=microstrategy.DISPLAY_MODE_GRID&&C.isTemplateEmpty()==false)||(this.parentBone.parentBone.commands.queryState("Overflow")=="1"&&D=="2"&&F=="2"))){H=true;}}}this.doc.formatSize(microstrategy.createAssociativeArray(P),"height",B.height+"px",T,true);this.doc.formatSize(microstrategy.createAssociativeArray(P),"width",B.width+"px",T,true);if(C&&C.commands.queryState("gridMode")==microstrategy.DISPLAY_MODE_GRID&&C.isTemplateEmpty()==false&&C.commands.queryState("fittowindow")&&!C.lockSet){O=C;}break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:if(J==microstrategy.HEIGHT_UPDATE||J==microstrategy.WIDTH_AND_HEIGHT_UPDATE){if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"heightMode","0",T,false);}this.doc.formatSize(microstrategy.createAssociativeArray(P),"height",B.height+"px",T,true);}if(J==microstrategy.WIDTH_UPDATE||J==microstrategy.WIDTH_AND_HEIGHT_UPDATE){if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"widthMode","0",T,false);}this.doc.formatSize(microstrategy.createAssociativeArray(P),"width",B.width+"px",T,true);}break;default:this.doc.formatSize(microstrategy.createAssociativeArray(P),"height",B.height+"px",T,true);this.doc.formatSize(microstrategy.createAssociativeArray(P),"width",B.width+"px",T,true);break;}var N=getObjWidth(P);var S=getObjHeight(P);var Q=P.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(Q==microstrategy.SUBOBJTYPE_DOC_IMAGE){var K=microstrategy.subObjectFind(P,["IMG"]);this.setPictureDimension(P,K,S,N);}else{if(Q==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){mstrStaticDoc.getBone(P).resizeGridAndGraph(S,N);}else{if(Q==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var G=microstrategy.bone(P.getAttribute("id"));if(G){G.resize(this.doc.removePaddingAndBorder(P,B.height,"height"),this.doc.removePaddingAndBorder(P,B.width,"width"));}}}}if(O){O.commands.exec("setColWidthsMode",mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY);if(O.colWidths){O.colWidths.syncCols();}}return H;}catch(E){microstrategy.errors.log(E);return false;}};mstrResizeDocObjs.prototype.setPictureDimension=function(B,E,C,A){try{if(E){E.style.height="100%";E.style.width="100%";}}catch(D){microstrategy.errors.log(D);}};function mstrResizeDocObjs(){return this;}function Rect(D,B,A,C){this.top=D;this.right=B;this.bottom=A;this.left=C;return this;}RectObj.prototype={};RectObj.prototype.toString=function(){try{var A="";for(var C in this){if(typeof (this[C])!="function"){A+=C+": "+this[C]+"\n";}}return A;}catch(B){microstrategy.errors.log(B);return"";}};RectObj.prototype.add=function(C,A,E,B){try{if(C){this.left+=C;}if(A){this.top+=A;}if(E){this.right+=E;}if(B){this.bottom+=B;}this.height=this.bottom-this.top;this.width=this.right-this.left;}catch(D){microstrategy.errors.log(D);}};RectObj.prototype.setBase=function(A,C){try{this.left-=A;this.top-=C;this.right-=A;this.bottom-=C;}catch(B){microstrategy.errors.log(B);}};RectObj.prototype.checkHFlip=function(){try{if(this.bottom<=this.top){var A=this.top;this.top=this.bottom;this.bottom=A;this.height=this.bottom-this.top;return true;}return false;}catch(B){microstrategy.errors.log(B);}};RectObj.prototype.checkVFlip=function(){try{if(this.right<=this.left){var A=this.left;this.left=this.right;this.right=A;this.width=this.right-this.left;return true;}return false;}catch(B){microstrategy.errors.log(B);}};function RectObj(D){var G=microstrategy.styleObj.getValue(D,"TextDirection")||"0";try{var A=I=0;if(D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var B="width",H="height",A=Math.round(microstrategy.getPaddingAndBorderPixels(D,H)),I=Math.round(microstrategy.getPaddingAndBorderPixels(D,B));var E=microstrategy.styleObj.getValue(D,H);var F=microstrategy.styleObj.getValue(D,B);if(E=="auto"||E=="100%"){this.height=G==="0"?getObjHeight(D):getObjWidth(D);}else{this.height=Math.max(parseInt(E)+A,0);}if(F=="auto"||F=="100%"){this.width=G==="0"?getObjWidth(D):getObjHeight(D);}else{this.width=Math.max(parseInt(F)+I,0);}}else{var J=0;if(D.style.borderTopWidth.length>0){J+=parseFloat(D.style.borderTopWidth);}if(D.style.borderBottomWidth.length>0){J+=parseFloat(D.style.borderBottomWidth);}A=Math.round(microstrategy.getFormatObject().getPxFromPt(J));J=0;if(D.style.borderLeftWidth.length>0){J+=parseFloat(D.style.borderLeftWidth);}if(D.style.borderRightWidth.length>0){J+=parseFloat(D.style.borderRightWidth);}I=Math.round(microstrategy.getFormatObject().getPxFromPt(J));this.height=Math.max(parseInt(D.style.height)+A);this.width=Math.max(parseInt(D.style.width)+I);}this.left=getObjSumLeft(D);this.top=getObjSumTop(D);if(!bIsDXIE&&G==="90"){this.top=this.top-this.height;}this.right=this.left+this.width;this.bottom=this.top+this.height;return this;}catch(C){microstrategy.errors.log(C);return null;}}mstrGridSelectionsImpl.prototype=new mstrSelectionsImpl();mstrGridSelectionsImpl.prototype.path="";mstrGridSelectionsImpl.prototype.verifiedPath="";mstrGridSelectionsImpl.prototype.selectedUnits=null;mstrGridSelectionsImpl.prototype.hilitedItems=null;mstrGridSelectionsImpl.prototype.clipboardUnits=undefined;mstrGridSelectionsImpl.prototype.drillingElementsList="";mstrGridSelectionsImpl.prototype.prevSelectionObj=null;mstrGridSelectionsImpl.prototype.x=0;mstrGridSelectionsImpl.prototype.y=0;mstrGridSelectionsImpl.prototype.onload=function(B){try{this.verifiedPath=microstrategy.getEventHandlerString(this.path);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrGridSelectionsImpl.prototype.singleAttributeElementsAreSelected=function(){try{if(this.getSelectedUnitsCount()==1){for(var A in this.selectedUnits){var C=this.selectedUnits[A];if(C&&C.countLevel()==1){return(C.hasLevel(microstrategy.GRIDCELLTYPE_UNIT_VALUE));}}}return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrGridSelectionsImpl.prototype.anyAttributeElementSelected=function(){try{for(var A in this.selectedUnits){var C=this.selectedUnits[A];if(C&&C.hasLevel(microstrategy.GRIDCELLTYPE_UNIT_VALUE)){return true;}}return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrGridSelectionsImpl.prototype.getSelectedItemCount=function(){try{var B=this.getItems();return(B)?B.length:0;}catch(A){microstrategy.errors.log(A);return false;}};mstrGridSelectionsImpl.prototype.repopulateSelections=function(){try{this.clearUnits();var pb=this.parentBone,gridSelections=pb.gridSelections;if(gridSelections==null||typeof (gridSelections)=="undefined"||gridSelections.length==0){return ;}this.prevSelectionObj=eval("("+gridSelections+")");if(this.prevSelectionObj==null||typeof (this.prevSelectionObj)=="undefined"){return ;}if(this.prevSelectionObj!=null){var currentpage=this.parentBone.currentPageX+","+this.parentBone.currentPageY;var reselectItems=(this.prevSelectionObj.items!=null);var reselectUnits=(this.prevSelectionObj.page==currentpage&&this.prevSelectionObj.units!=null);var selectionActive=(reselectItems||reselectUnits)&&this.hasHilitedCells();if(selectionActive&&microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){this.parentBone.switchToCellSelectionMode();}if(reselectItems){var isFetchingColumns=pb.currentPageX!=pb.previousPageX,items=this.prevSelectionObj.items,cItems=items[currentpage],cnt;if(isFetchingColumns){cnt=pb.chc;for(var idx in cItems){if(idx.substring(0,idx.indexOf(","))>=cnt){delete cItems[idx];}}}else{cnt=pb.rhc;for(var idx in cItems){if(idx.substring(idx.indexOf(","),idx.length-1)>=cnt){delete cItems[idx];}}}for(var page in items){if(items[page]!=null){this.reselectItems(items[page]);}}}if(reselectUnits){for(var i in this.prevSelectionObj.units){var value=this.prevSelectionObj.units[i];if(value!=null){var temps=value.split("|");if(temps!=null){var uIndex=temps[0];var uLevel=temps[1];var uTemps=uIndex.split(",");if(uTemps){var uAxis=uTemps[0];var uDepth=uTemps[1];var unit=this.parentBone.gridStructureInfo.getUnit(uAxis,uDepth);if(unit!=null){if(unit.isVisible&&(this.selectedUnits[uIndex]==null||(!this.selectedUnits[uIndex].hasLevel(uLevel))||(this.selectedUnits[uIndex].levelObjs&&!(this.selectedUnits[uIndex].levelObjs[uLevel]).hasSelectedCells()))){this.addToSelectedUnits(null,unit.src,uLevel,true);}this.resolveParentSelectionInfo(unit,uLevel);}}}}}}}}catch(err){return false;}};mstrGridSelectionsImpl.prototype.checkForSpannedCell=function(D,E,B){try{var A=D.rows[0].cells[0];if(A&&A.getAttribute(B)!=null&&A.getAttribute(B)==E){return A;}return null;}catch(C){microstrategy.errors.log(C);return false;}};mstrGridSelectionsImpl.prototype.reselectItems=function(E){try{var J=this.parentBone.elem.getElementsByTagName("table")[0];if(J==null){return ;}var L=false;for(var B in E){if(E[B]==null||E[B]=="null"||typeof (E[B])=="undefined"){continue;}var C=B.split(",");var F=C[0];var H=C[1];var I=util_findCell(J,F,H,E[B],"d1");if(I==null){I=this.checkForSpannedCell(J,E[B],"d1");}if(I==null){var K=J.rows[F];if(K!=null){var D=this.parentBone.gridStructureInfo.getGridCellProps(K.cells[H]);var G=D&&D.getCellDrillElement(K.cells[H]);if(G&&(G.toLowerCase()==E[B].toLowerCase())){I=K.cells[H];I.setAttribute("d1",G);}}}if(I!=null){this.add(I,false);L=true;}}return L;}catch(A){microstrategy.errors.log(A);return false;}};mstrGridSelectionsImpl.prototype.add=function(C,B){try{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION&&this.parentBone!=null&&!this.parentBone.isGridInCellSelectionMode()){this.parentBone.switchToCellSelectionMode();}if(C.nodeName.toLowerCase()!="td"){return null;}var A=this.getCellLevel(C);this.selectUnitsItems(C,A,B);}catch(D){microstrategy.errors.log(D);}return false;};mstrGridSelectionsImpl.prototype.isCellSingleSelectable=function(F,B){try{var E=false;var D=this.parentBone.gridStructureInfo.getGridCellProps(F);var H=F.getAttribute("D1");if(!H){H=D&&D.getCellDrillElement(F);if(H){F.setAttribute("D1",H);}}var E=(H!=null&&H.length>0);if(!E){E=F.getAttribute("peix")!=null;}if(B==microstrategy.GRIDCELLTYPE_UNIT_VALUE&&E){var A=F.getAttribute("CX");if(!A){A=D&&D.getCellCx();if(A){F.setAttribute("CX",A);}}E=(A!=null&&A.length>0);}if(!E&&D){E=D.getGridUnitInfo().src.getAttribute("cde");}var C=(B==microstrategy.GRIDCELLTYPE_UNIT_HEADER);return(E||C);}catch(G){microstrategy.errors.log(G);}return false;};mstrGridSelectionsImpl.prototype.findTemplateUnit=function(B,A){if(A==microstrategy.GRIDCELLTYPE_UNIT_HEADER){return B;}var C=this.findTemplateUnitObj(B,A);return C&&C.src;};mstrGridSelectionsImpl.prototype.findTemplateUnitObj=function(D,A){try{var F;switch(A){case microstrategy.GRIDCELLTYPE_UNIT_HEADER:F=D;break;case microstrategy.GRIDCELLTYPE_SUBTOTAL_HEADER:case microstrategy.GRIDCELLTYPE_SUBTOTAL_VALUE:case microstrategy.GRIDCELLTYPE_UNIT_VALUE:case microstrategy.GRIDCELLTYPE_METRIC_DATA:var C=D.getAttribute(microstrategy.HTMLATTR_GRID_UNIT_POS);if(C!=null&&C.length>0){var G=C.split(",");var B=this.parentBone.gridStructureInfo.getUnit(G[0],G[1]);if(B!=null){F=B;}}else{var H=D.nodeName.toLowerCase();if((H!="td")){D=microstrategy.findParentWithTag(D,"td");}var B=this.parentBone.gridStructureInfo.getGridCellProps(D)&&this.parentBone.gridStructureInfo.getGridCellProps(D).getGridUnitInfo();if(B!=null){F=B;}}break;}return F;}catch(E){microstrategy.errors.log(E);}return false;};mstrGridSelectionsImpl.prototype.getAttrFormUnits=function(B,F){try{var A=new Array;var G=F.getSubAxis();var C;if(this.parentBone.gridStructureInfo!=null&&this.parentBone.gridStructureInfo.showAttForms&&G!=null){for(var D in G.units){A.push(G.units[D].src);}}else{A.push(B);}return A;}catch(E){microstrategy.errors.log(E);}return null;};mstrGridSelectionsImpl.prototype.getAttrFormValueCells=function(J,H){try{var K=new Array;var E=H.getSubAxis();var F;var I=this.parentBone.gridStructureInfo;if(I!=null&&I.showAttForms&&E!=null){if(H.axis==microstrategy.GRIDCELL_AXIS_ROWS){F=J.parentNode.rowIndex;var A=J.parentNode.cells;var G=H.axis+","+H.depth;for(var D=0;D<A.length;D++){var C=A[D].getAttribute(microstrategy.HTMLATTR_GRID_UNIT_POS);if(!C){C=I.getGridCellProps(A[D])&&I.getGridCellProps(A[D]).getCellUpt();if(C){A[D].setAttribute(microstrategy.HTMLATTR_GRID_UNIT_POS,C);}}if(C==G){K.push(A[D]);}}}else{if(H.axis==microstrategy.GRIDCELL_AXIS_COLUMNS){F=J.cellIndex;K.push(J);}}}else{K.push(J);}return K;}catch(B){microstrategy.errors.log(B);}return false;};mstrGridSelectionsImpl.prototype.selectUnitsItems=function(C,A,B){try{var D=true;if(this.isCellSingleSelectable(C,A)){D=false;if(!B){this.lastSelection=C;}}var F=this.findTemplateUnitObj(C,A);if(F.subtype==microstrategy.SUBOBJTYPE_METRIC||A==microstrategy.GRIDCELLTYPE_SUBTOTAL_VALUE){D=false;}if(F&&F.src){F=F.src;}if(F!=null){this.addToSelectedUnits(C,F,A,D);this.parentBone.setGraphSelected(false);if(!B){this.parentBone.notifySelectionChange("ongridselectionschange");}}}catch(E){microstrategy.errors.log(E);}};mstrGridSelectionsImpl.prototype.isEmpty=function(){try{var B=this.getSelectedUnitsCount();return(B<=0);}catch(A){microstrategy.errors.log(A);}return false;};mstrGridSelectionsImpl.prototype.getSelectedCellsWithAttr=function(I,H){try{var G=new Array;for(var E in this.selectedUnits){var F=this.selectedUnits[E];F=F&&F.levelObjs;if(F){for(var D in F){for(var B in F[D].selectedItems){var A=F[D].selectedItems[B].getAttribute(I);if(A!=null&&A.length>0&&A.toLowerCase()==H){G.push(F[D].selectedItems[B]);}}}}}return G;}catch(C){microstrategy.errors.log(C);return null;}};mstrGridSelectionsImpl.prototype.addToHilitedItemsCollection=function(B){try{var A=this.getIndexFromCell(B);this.hilitedItems[A]=B;this.hiliteSelected(B);}catch(C){microstrategy.errors.log(C);}return false;};mstrGridSelectionsImpl.prototype.addToSelectedUnits=function(S,N,D,X){try{var A=new Array();var I=new Array();var C=new Array();var W=false;var G=N.getAttribute?N.getAttribute(microstrategy.HTMLATTR_DSS_ID):N.dssId;var M=this.parentBone.gridStructureInfo.findUnit(G);if(M==null){return ;}var J=M.axis+","+M.depth;if(this.selectedUnits[J]==null){this.selectedUnits[J]=new mstrUnitObjImpl(this);}this.selectedUnits[J].unit=M;var V="";var F=false;switch(M.subtype){case microstrategy.SUBOBJTYPE_ATTRIBUTE:case microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM:if(M.isMetricTemplateUnit){V="0,-999,6";}else{V=M.axis+","+M.depth+",1";}break;case microstrategy.SUBOBJTYPE_METRIC:V=(M.depth-1)+",-1,2";F=true;break;}this.selectedUnits[J].gridTarget=V;this.selectedUnits[J].isMetric=F;if(this.selectedUnits[J].levelObjs[D]==null){this.selectedUnits[J].levelObjs[D]=new mstrUnitLevelObjImpl(this.selectedUnits[J]);}if(X){if(D==microstrategy.GRIDCELLTYPE_UNIT_HEADER){if(X&&this.parentBone.gridStructureInfo.showAttForms&&M.hasAttForms()){I=this.getAttrFormUnits(N,M);}else{I.push(N);}}else{I=this.parentBone.findAllCells(M,D);}}else{if(D!=microstrategy.GRIDCELLTYPE_UNIT_HEADER){A=this.getAttrFormValueCells(S,M);if(M.axis==microstrategy.GRIDCELL_AXIS_ROWS&&M.depth==this.parentBone.gridStructureInfo.getMaxAxisPosition(M.axis)-1){var U=this.parentBone.elem.getElementsByTagName("table")[0];if(this.parentBone.commands.queryState("checkMergeRowHeader")){C=util_getAllCellsInRowFromThisCell(S,U);}else{C=U.rows[S.parentNode.rowIndex].cells;}}}else{A.push(S);}}for(var Q=0;C!=null&&Q<C.length;Q++){if(C[Q]==S){continue;}var O=this.getCellLevel(C[Q]);var B=this.findTemplateUnit(C[Q],O);if(B==null){continue;}var K=B.getAttribute(microstrategy.HTMLATTR_DSS_ID);var T=this.parentBone.gridStructureInfo.findUnit(K);var P=T.axis+","+T.depth;if(this.selectedUnits[P]==null){this.selectedUnits[P]=new mstrUnitObjImpl(this);}this.selectedUnits[P].unit=T;if(this.selectedUnits[P].levelObjs[O]==null){this.selectedUnits[P].levelObjs[O]=new mstrUnitLevelObjImpl(this.selectedUnits[P]);}var L=this.selectedUnits[P].levelObjs[O];L.addToHilitedItems(C[Q]);}var E=this.selectedUnits[J].levelObjs[D];for(var R in I){E.addToHilitedItems(I[R]);}for(var R in A){E.addToHilitedItems(A[R]);E.addToSelectedItems(A[R]);}if(this.selectedUnits[J].levels.toString().indexOf(D)<0){this.selectedUnits[J].levels.push(D);W=true;}if(S!=null){this.parentBone.resetSelections();}return W;}catch(H){microstrategy.errors.log(H);return false;}};mstrGridSelectionsImpl.prototype.getSelectedGridTarget=function(){try{var C=this.getSelectedUnitsCount();if(C==0){return microstrategy.GRID_TARGET_NONE;}else{if(C==1){for(var A in this.selectedUnits){if(this.selectedUnits[A]!=null&&this.selectedUnits[A].gridTarget!=null&&this.selectedUnits[A].gridTarget.length>0){return this.selectedUnits[A].gridTarget;}}}else{return microstrategy.GRID_TARGET_MULTIPLE;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrGridSelectionsImpl.prototype.getSelectedGridLevel=function(){try{var A=this.getSelectedGridTarget();switch(A){case microstrategy.GRID_TARGET_NONE:return microstrategy.GRIDCELLTYPE_LEVEL_NONE;case microstrategy.GRID_TARGET_MULTIPLE:return microstrategy.GRIDCELLTYPE_LEVEL_MULTIPLE;default:for(var C in this.selectedUnits){if(this.selectedUnits[C]!=null&&this.selectedUnits[C].levels.length>0){var E=this.selectedUnits[C].levels;var B=this.getLevelsCount(E);if(B<=0){return microstrategy.GRIDCELLTYPE_LEVEL_NONE;}else{if(B==1){return E[0];}else{return microstrategy.GRIDCELLTYPE_LEVEL_MULTIPLE;}}}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrGridSelectionsImpl.prototype.addToSelections=function(F,A,L){try{var G=this.getCellLevel(A);if(G==null||G.length<=0){return false;}var I=this.findTemplateUnitObj(A,G);if(!I){if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION&&this.parentBone){var C=this.parentBone.getDocSelections();C&&C.addToSelection(F.ctrlKey,findTarget(this.parentBone.elem,microstrategy.HTMLATTR_OBJTYPE));}return false;}I=I.src||I;var E=I.getAttribute?I.getAttribute(microstrategy.HTMLATTR_DSS_ID):I.dssId;var H=this.parentBone.gridStructureInfo.findUnit(E);if(F.button==2){if(!this.isSelected(A,H,G)){if(!F.ctrlKey){this.clearCurrentPage(true);}this.resolveParentSelectionInfo(H,G);this.add(A);}}else{if((F.ctrlKey||isMac&&F.metaKey)&&!F.shiftKey){var B=this.getSelectedUnitsCount();if(this.isSelected(A,H,G)){if(B==2){var K=null;for(var J in this.selectedUnits){if(this.selectedUnits[J]&&this.selectedUnits[J].unit!=H){K=this.selectedUnits[J];}}if(K){this.resolveParentSelectionInfo(K.unit,K.resolveLevelsValue());}}else{if(B==1){this.updateParentSelectionInfo(microstrategy.GRID_UNIT_CONTAINER,1);}}this.remove(A);}else{this.selectStartFunc=this.parentBone.elem.onselectstart;this.restoreSelectStartFunc=true;this.parentBone.elem.onselectstart=new Function("return false;");if(this.lastSelectionIsFromToolbar()){this.clearCurrentPage(true);}if(B>0){this.updateParentSelectionInfo(-1,-1);}if(this.isCellSingleSelectable(A,G)){this.add(A);}else{if(this.isCellHilited(A)){this.remove(A);}else{this.add(A);}}}}else{if(F.shiftKey&&this.isCellShiftSelectable(A,G)){this.selectStartFunc=this.parentBone.elem.onselectstart;this.restoreSelectStartFunc=true;this.parentBone.elem.onselectstart=new Function("return false;");if(!F.ctrlKey){this.clearCurrentPage(true);}this.updateParentSelectionInfo(-1,-1);this.shiftSelect(H,A,G);}else{if(!L){if(this.isSelected(A,H,G)&&(G==microstrategy.GRIDCELLTYPE_UNIT_HEADER)){this.deferredSrc=A;return false;}else{this.deferredSrc=null;}}if(G==microstrategy.GRIDCELLTYPE_UNIT_HEADER){this.clearAll(true);}else{this.clearCurrentPage(true);}this.resolveParentSelectionInfo(H,G);this.add(A);}}}this.handleCopySelections(A,H,F);}catch(D){microstrategy.errors.log(D);}return false;};mstrGridSelectionsImpl.prototype.isCellShiftSelectable=function(B,A){return(A==microstrategy.GRIDCELLTYPE_UNIT_VALUE)&&B.nodeName.toLowerCase()=="td"&&this.lastSelection&&this.lastSelection!=B&&this.lastSelection.getAttribute(microstrategy.HTMLATTR_GRIDCELL_ID)===B.getAttribute(microstrategy.HTMLATTR_GRIDCELL_ID);};mstrGridSelectionsImpl.prototype.shiftSelect=function(H,C,G){try{var B=((H.axis==-1)?0:H.axis)+"A"+H.depth;var K=this.parentBone.getCellsWithAttr(microstrategy.HTMLATTR_GRIDCELL_ID,B);var J=false;var A=-1,E=-1;for(var F=0;F<K.length;F++){var I=K[F];if(I===C||I===this.lastSelection){J=!J;if(!J){this.add(I,true);break;}}if(J){this.add(I,true);}}this.parentBone.notifySelectionChange("ongridselectionschange");}catch(D){microstrategy.errors.log(D);}};mstrGridSelectionsImpl.prototype.resolveParentSelectionInfo=function(C,A){try{if(C!=null){var D=(C.isMetricTemplateUnit)?mstrGridReport.METRIC_UNITS:this.parentBone.resolveGridUnitId(C.axis,C.depth);this.updateParentSelectionInfo(D,A);}}catch(B){microstrategy.errors.log(B);}};mstrGridSelectionsImpl.prototype.updateParentSelectionInfo=function(C,A){try{this.parentBone.gridUnitFormat=C;this.parentBone.gridValueFormat=A;}catch(B){microstrategy.errors.log(B);}};mstrGridSelectionsImpl.prototype.clearDeferredSrc=function(){this.deferredSrc=null;};mstrGridSelectionsImpl.prototype.onmouseup=function(A){if(this.restoreSelectStartFunc){this.parentBone.elem.onselectstart=this.selectStartFunc;}this.selectStartFunc=null;this.restoreSelectStartFunc=false;if(this.deferredSrc){this.addToSelections(A,this.deferredSrc,true);}};mstrGridSelectionsImpl.prototype.lastSelectionIsFromToolbar=function(){try{return(this.parentBone.selectedAxis!=null||this.parentBone.selectedLevel!=null||this.parentBone.selectedPosition!=null||this.parentBone.selectedUnit!=null);}catch(A){microstrategy.errors.log(A);return false;}};mstrGridSelectionsImpl.prototype.isCellHilited=function(F){try{var B=false;for(var E in this.selectedUnits){var C=this.selectedUnits[E];if(C!=null&&C.levelObjs!=null){var A=C.levelObjs;for(var D in A){if(A[D]!=null){B=A[D].hasHilitedCell(F);if(B){return B;}}}}}return B;}catch(G){microstrategy.errors.log(G);return null;}};mstrGridSelectionsImpl.prototype.isCellSelected=function(F){try{var A=this.getCellLevel(F);if(A==null||A.length<=0){return false;}var B=this.findTemplateUnit(F,A);if(B==null){return false;}var C=B.getAttribute(microstrategy.HTMLATTR_DSS_ID);var E=this.parentBone.gridStructureInfo.findUnit(C);return this.isSelected(F,E,A);}catch(D){microstrategy.errors.log(D);return false;}};mstrGridSelectionsImpl.prototype.isSelected=function(E,D,F){try{if(this.selectedUnits!=null&&D!=null){var B=D.axis+","+D.depth;var A=this.selectedUnits[B];if(A!=null&&A.levelObjs!=null&&A.levelObjs[F]!=null){return A.levelObjs[F].hasSelectedCell(E);}}return false;}catch(C){microstrategy.errors.log(C);return null;}};mstrGridSelectionsImpl.prototype.hasSelectedCells=function(){try{var A=false;if(this.selectedUnits!=null){for(var C in this.selectedUnits){var B=this.selectedUnits[C];if(B!=null&&B.levelObjs!=null){var E=B.levelObjs;for(var F in E){A=E[F].hasSelectedCells();if(A){return A;}}}}}return A;}catch(D){microstrategy.errors.log(D);return null;}};mstrGridSelectionsImpl.prototype.hasHilitedCells=function(){try{var A=false;if(this.selectedUnits!=null){for(var C in this.selectedUnits){var B=this.selectedUnits[C];if(B!=null&&B.levelObjs!=null){var E=B.levelObjs;for(var F in E){A=E[F].hasHilitedCells();if(A){return A;}}}}}return A;}catch(D){microstrategy.errors.log(D);return null;}};mstrGridSelectionsImpl.prototype.remove=function(B){try{if(B.nodeName.toLowerCase()!="td"){return false;}var A=this.getCellLevel(B);this.removeUnitsItems(B,A);}catch(C){microstrategy.errors.log(C);}return false;};mstrGridSelectionsImpl.prototype.removeUnitsItems=function(B,A){try{var E=true;if(this.isCellSingleSelectable(B,A)){E=false;}var D=this.findTemplateUnit(B,A);if(D!=null){this.removeFromSelectedUnits(B,D,A,E);this.parentBone.notifySelectionChange("ongridselectionschange");}}catch(C){microstrategy.errors.log(C);}return false;};mstrGridSelectionsImpl.prototype.removeFromSelectedUnits=function(T,N,C,S){try{var W=false;var M=new Array();var L=new Array;var H=new Array;var B=new Array;var E=N.getAttribute(microstrategy.HTMLATTR_DSS_ID);var K=this.parentBone.gridStructureInfo.findUnit(E);var G=K.axis+","+K.depth;var D=this.selectedUnits[G].levelObjs[C];if(S){D.clearSelectedItems();D.clearHilitedItems();}else{if(C!=microstrategy.RIDCELLTYPE_UNIT_HEADER){H=this.getAttrFormValueCells(T,K);if(K.axis==microstrategy.GRIDCELL_AXIS_ROWS&&K.depth==this.parentBone.gridStructureInfo.getMaxAxisPosition(K.axis)-1){var V=this.parentBone.elem.getElementsByTagName("table")[0];if(this.parentBone.commands.queryState("checkMergeRowHeader")){B=util_getAllCellsInRowFromThisCell(T,V);}else{B=V.rows[T.parentNode.rowIndex].cells;}}}else{H.push(T);}}for(var Q=0;B!=null&&Q<B.length;Q++){if(B[Q]==T){continue;}var O=this.getCellLevel(B[Q]);var A=this.findTemplateUnit(B[Q],O);if(A==null){return false;}var I=A.getAttribute(microstrategy.HTMLATTR_DSS_ID);var U=this.parentBone.gridStructureInfo.findUnit(I);var P=U.axis+","+U.depth;if(this.selectedUnits[P]==null){this.selectedUnits[P]=new mstrUnitObjImpl(this);}this.selectedUnits[P].unit=U;if(this.selectedUnits[P].levelObjs[O]==null){this.selectedUnits[P].levelObjs[O]=new mstrUnitLevelObjImpl(this.selectedUnits[P]);}var J=this.selectedUnits[P].levelObjs[O];J.removeHilitedItems(B[Q]);}for(var R in H){D.removeSelectedItems(H[R]);D.removeHilitedItems(H[R]);}if(D.selectedItemsLength==0){W=true;this.selectedUnits[G].removeLevel(C);}if(this.selectedUnits[G].countLevel()<=0){this.selectedUnits[G]=null;}return W;}catch(F){microstrategy.errors.log(F);return false;}};mstrGridSelectionsImpl.prototype.getIndexFromCell=function(B){try{if(B==null||typeof (B)=="undefined"||B.nodeName==null||typeof (B.nodeName)=="undefined"||B.nodeName.toLowerCase()!="td"){return null;}return(B.parentNode.rowIndex+","+B.cellIndex);}catch(A){microstrategy.errors.log(A);}return null;};mstrGridSelectionsImpl.prototype.hiliteSelected=function(B){try{if(B.nodeName.toLowerCase()=="td"){this.hiliteObj(B,"50");}}catch(A){microstrategy.errors.log(A);}return false;};mstrGridSelectionsImpl.prototype.hiliteObj=function(D,A){try{if(D.nodeName.toLowerCase()=="td"&&bIsIE8){var E,C;if(A!="100"){if(D.firstChild&&D.firstChild.nodeName.toLowerCase()=="div"&&D.firstChild.getAttribute("f")=="1"){E=D.firstChild;}else{E=document.createElement("div");E.setAttribute("f","1");while(D.firstChild){C=D.removeChild(D.firstChild);E.appendChild(C);}D.appendChild(E);}setFilter(E,"Alpha",{opacity:"50"});return ;}else{if(D.firstChild&&D.firstChild.nodeName.toLowerCase()=="div"&&D.firstChild.getAttribute("f")=="1"){E=D.firstChild;while(E.firstChild){C=E.removeChild(E.firstChild);D.appendChild(C);}D.removeChild(E);return ;}}}setFilter(D,"Alpha",{opacity:A});}catch(B){microstrategy.errors.log(B);}};mstrGridSelectionsImpl.prototype.clear=function(){try{this.clearAll(true);}catch(A){microstrategy.errors.log(A);}return false;};mstrGridSelectionsImpl.prototype.clearAll=function(A){try{if(this.hasHilitedCells()){this.clearCurrentPage(A);this.clearSelectionsFromOtherPages();this.clearClipboardItems();var B=this.parentBone&&this.parentBone.switchToContainerSelectionMode&&this.parentBone.switchToContainerSelectionMode();}}catch(C){microstrategy.errors.log(C);}return false;};mstrGridSelectionsImpl.prototype.clearCurrentPage=function(A){try{this.removeAllHilites();this.clearSelectedItemsOnCurrentPage();this.clearUnits();if(A){return ;}this.parentBone.notifySelectionChange("ongridselectionschange");}catch(B){microstrategy.errors.log(B);}};mstrGridSelectionsImpl.prototype.clearUnits=function(){try{this.selectedUnits=new Array;}catch(A){microstrategy.errors.log(A);}return false;};mstrGridSelectionsImpl.prototype.clearSelectedItemsOnCurrentPage=function(){try{for(var B in this.selectedUnits){if(this.selectedUnits[B]!=null&&this.selectedUnits[B].levelObjs!=null){for(var A in this.selectedUnits[B].levelObjs){this.selectedUnits[B].levelObjs[A].clearSelectedItems();}}}}catch(C){microstrategy.errors.log(C);}return false;};mstrGridSelectionsImpl.prototype.removeAllHilites=function(){try{for(var B in this.selectedUnits){if(this.selectedUnits[B]!=null&&this.selectedUnits[B].levelObjs!=null){for(var A in this.selectedUnits[B].levelObjs){this.selectedUnits[B].levelObjs[A].clearHilitedItems();}}}return false;}catch(C){microstrategy.errors.log(C);}};mstrGridSelectionsImpl.prototype.removeHilites=function(B){try{if(B.nodeName.toLowerCase()=="td"){if(!this.parentBone.restoreHiliteIfCurrent(B)){this.hiliteObj(B,"100");}}}catch(A){microstrategy.errors.log(A);}return false;};mstrGridSelectionsImpl.prototype.removeFromHilitedItems=function(C){try{var A=this.getIndexFromCell(Obj);delete this.hilitedItems[A];}catch(B){microstrategy.errors.log(B);}return false;};mstrGridSelectionsImpl.prototype.getSelectionsFromOtherPages=function(){try{return this.parentBone.gridSelections;}catch(A){microstrategy.errors.log(A);}return false;};mstrGridSelectionsImpl.prototype.clearSelectionsFromOtherPages=function(){try{this.parentBone.gridSelections="";}catch(A){microstrategy.errors.log(A);}return false;};mstrGridSelectionsImpl.prototype.getSelectedUnitsCount=function(){try{var A=0;for(var B in this.selectedUnits){if(this.selectedUnits[B]!=null){var D=this.selectedUnits[B].levels;if(D!=null&&this.getLevelsCount(D)>0){A++;}}}return A;}catch(C){microstrategy.errors.log(C);return 0;}};mstrGridSelectionsImpl.prototype.getLevelsCount=function(D){try{var A=0;for(var B in D){if(D[B]!=null&&typeof (D[B])!="undefined"){A++;}}return A;}catch(C){microstrategy.errors.log(C);return 0;}};mstrGridSelectionsImpl.prototype.getSelectedGridTargetGridLevel=function(){try{var A=new Array();if(this.parentBone.selectedAxis!=null&&this.parentBone.selectedPosition!=null&&this.parentBone.selectedUnit!=null&&this.parentBone.selectedLevel!=null){A.push(this.parentBone.selectedAxis+","+this.parentBone.selectedPosition+","+this.parentBone.selectedUnit+","+this.parentBone.selectedLevel);}else{if(this.selectedUnits.length==0&&this.parentBone.gridUnitFormat==microstrategy.GRID_BORDERS){A=["0,-99,2,6"];}else{for(var F in this.selectedUnits){if(this.selectedUnits[F]!=null){var I=this.selectedUnits[F].levels;var B;var G;var H;var C=this.selectedUnits[F].gridTarget.split(",");if(this.selectedUnits[F].isMetric){B="0";G=C[0];}else{B=C[0];G=C[1];}H=C[2];for(var D in I){A.push(B+","+G+","+H+","+I[D]);}}}}}return A;}catch(E){microstrategy.errors.log(E);return 0;}};mstrGridSelectionsImpl.prototype.getCellLevel=function(D){try{var A=D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);var C="";switch(A){case microstrategy.SUBOBJTYPE_ATTRIBUTE:case microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM:case microstrategy.SUBOBJTYPE_METRIC:C=microstrategy.GRIDCELLTYPE_UNIT_HEADER;break;}if(C==""){var B=this.parentBone.gridStructureInfo.getCellType(D);switch(B){case microstrategy.GRIDCELLTYPE_SUBTOTAL_HEADER:case microstrategy.GRIDCELLTYPE_SUBTOTAL_VALUE:case microstrategy.GRIDCELLTYPE_UNIT_VALUE:C=B;break;}}return C;}catch(E){microstrategy.errors.log(E);return null;}};mstrGridSelectionsImpl.prototype.getSelections=function(){try{var A="";var H="";var G="'"+this.parentBone.currentPageX+","+this.parentBone.currentPageY+"':{"+this.getItemSelections(this.getItemsAsAssociativeArray())+"}";H+="'items':{"+G+"}";var E=this.parentBone.gridSelections.indexOf("'units'");if(E>-1){this.parentBone.gridSelections=this.parentBone.gridSelections.substring(0,E-1)+"}";}if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION||this.parentBone.gridSelections.length<=0){A="{"+H+"}";}else{var C=new RegExp("'"+this.parentBone.currentPageX+","+this.parentBone.currentPageY+"':\\{(('\\d+,\\d+':'(\\w,*)*'),*)*\\}","g");if(this.parentBone.gridSelections.match(C)!=null){A=this.parentBone.gridSelections.replace(C,G);}else{A=this.parentBone.gridSelections.substring(0,this.parentBone.gridSelections.length-2)+","+G+"}}";}}var F=this.getUnitSelections(this.selectedUnits);if(F!=""){F="'units':{"+F+"}";}else{F="'units':null";}var B="'page':'"+this.parentBone.currentPageX+","+this.parentBone.currentPageY+"'";A=A.substring(0,A.length-2)+"},"+F+","+B+"}";return A;}catch(D){microstrategy.errors.log(D);}return null;};mstrGridSelectionsImpl.prototype.getItemSelections=function(B){try{var E=false;var F="";if(B!=null){for(var C in B){var A=B[C].getAttribute("d1");F+="'"+C+"':'"+A+"',";E=true;}if(E){F=F.substring(0,F.length-1);}}return F;}catch(D){microstrategy.errors.log(D);return"";}};mstrGridSelectionsImpl.prototype.getItemsAsAssociativeArray=function(){try{var D=new Object;var G=false;for(var C in this.selectedUnits){if(this.selectedUnits[C]!=null){var F=this.selectedUnits[C].levelObjs;for(var B in F){for(var A in F[B].selectedItems){D[A]=F[B].selectedItems[A];G=true;}}}}return(G)?D:null;}catch(E){microstrategy.errors.log(E);return"";}};mstrGridSelectionsImpl.prototype.getItems=function(){try{var D=new Array;for(var C in this.selectedUnits){if(this.selectedUnits[C]!=null){var F=this.selectedUnits[C].levelObjs;for(var B in F){for(var A in F[B].selectedItems){D.push(F[B].selectedItems[A]);}}}}return D;}catch(E){microstrategy.errors.log(E);return"";}};mstrGridSelectionsImpl.prototype.allOnOneAxis=function(){try{var A=this.getSelectedUnitHeaders();if(A.length==0){return true;}A.sort(function(D,C){return(parseInt(D.getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS))-parseInt(C.getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS)));});return(A[0].getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS)==A[A.length-1].getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS));}catch(B){microstrategy.errors.log(B);return"";}};mstrGridSelectionsImpl.prototype.getFullLevelSelectedUnits=function(B){try{var G=false;var H="";var C=0;if(B!=null){for(var D in B){for(var A in B[D].levels){var E=B[D].levelObjs[A];H+="'"+(C++)+"':'"+D+","+B[D].levels[A]+"',";G=true;}}if(G){H=H.substring(0,H.length-1);}}return H;}catch(F){microstrategy.errors.log(F);return"";}};mstrGridSelectionsImpl.prototype.getUnitSelections=function(B){try{var F=false;var G="";var C=0;if(B!=null){for(var D in B){if(B[D]!=null){for(var A in B[D].levels){G+="'"+(C++)+"':'"+D+"|"+B[D].levels[A]+"',";F=true;}}}if(F){G=G.substring(0,G.length-1);}}return G;}catch(E){microstrategy.errors.log(E);return"";}};mstrGridSelectionsImpl.prototype.getSelectedUnitHeaders=function(){try{var D=new Array;if(this.selectedUnits!=null){for(var C in this.selectedUnits){if(this.selectedUnits[C]!=null){var F=this.selectedUnits[C].levelObjs;if(F[microstrategy.GRIDCELLTYPE_UNIT_HEADER]!=null){for(var B in F[microstrategy.GRIDCELLTYPE_UNIT_HEADER].selectedItems){var A=F[microstrategy.GRIDCELLTYPE_UNIT_HEADER].selectedItems[B];if(A!=null){D.push(A);}}}}}}return D;}catch(E){microstrategy.errors.log(E);return"";}};mstrGridSelectionsImpl.prototype.hasMetricsSelected=function(){try{if(this.selectedUnits!=null){for(var A in this.selectedUnits){if(this.selectedUnits[A]!=null){if(this.selectedUnits[A].isMetric){return true;}}}}return false;}catch(B){microstrategy.errors.log(B);return"";}};mstrGridSelectionsImpl.prototype.getSelectedDrillElements=function(){try{var J="";var G=this.getItems();for(var D in G){var E=G[D].getAttribute("d1");if(E!=null&&E!="null"){J+=E+",";}}if(this.prevSelectionObj!=null){for(var F in this.prevSelectionObj.items){var A=F.split(",");var I=A[0];var H=A[1];if(I!=this.parentBone.currentPageX||H!=this.parentBone.currentPageY){var C=this.prevSelectionObj.items[F];for(var D in C){var E=C[D];if(E!=null&&E!="null"){J+=E+",";}}}}}J=J+(this.parentBone.hiddenDrillValues||"");if(J.length>0){J=J.substring(0,J.length-1);}return J;}catch(B){microstrategy.errors.log(B);}return null;};mstrGridSelectionsImpl.prototype.getSelectedDrillElementsCount=function(){try{var K=0;var H=this.getItems();var F={};for(var D in H){var E=H[D].getAttribute("d1");if(E!=null&&E!="null"&&!F[E]){F[E]=true;K++;}}if(this.prevSelectionObj!=null){for(var G in this.prevSelectionObj.items){var A=G.split(",");var J=A[0];var I=A[1];if(J!=this.parentBone.currentPageX||I!=this.parentBone.currentPageY){var C=this.prevSelectionObj.items[G];for(var D in C){var E=C[D];if(E!=null&&E!="null"&&!F[E]){F[E]=true;K++;}}}}}return K;}catch(B){microstrategy.errors.log(B);}return null;};mstrGridSelectionsImpl.prototype.getSelectedElementsOrdinals=function(B){try{var J=new Array();var D=this.getSelectedGridTarget();if(D!=null){var O=D.split(",");var A=this.parentBone.gridStructureInfo.getUnit(O[0],O[1],1);if(A!=null){var N=A.src;var L=this.getIndexFromCell(N);for(var H in this.selectedUnits){if(this.selectedUnits[H]!=null){var I=this.selectedUnits[H].levelObjs;for(var G in I){for(var K in I[G].selectedItems){var C=I[G].selectedItems[K];var F=C.getAttribute("D1");if(F&&F.length>0){var M=F.split("A");if(M&&M.length==3){J.push(parseInt(M[2]));}}B.push(trim(decode(C.innerHTML,false)));}}}}}}return J;}catch(E){microstrategy.errors.log(E);}};mstrGridSelectionsImpl.prototype.containsDerivedElements=function(){try{var C=this.getSelectedGridTarget();if(C!=null){var J=C.split(",");var A=this.parentBone.gridStructureInfo.getUnit(J[0],J[1],1);if(A!=null){for(var F in this.selectedUnits){if(this.selectedUnits[F]!=null){var G=this.selectedUnits[F].levelObjs;for(var E in G){for(var I in G[E].selectedItems){var B=G[E].selectedItems[I];var H=B.getAttribute("ide");if(H){return true;}}}}}}}return false;}catch(D){microstrategy.errors.log(D);}};mstrGridSelectionsImpl.prototype.ondocumentclick=function(L){try{var B="";var C="";var E=false;var D=false;if(!L){L=window.event;}getMouse(L);var A=getEventTarget(L),G=microstrategy.findAncestorWithAtt(A,"tagName","table");var P=false;if(this.hasHilitedCells()==false){if(G==null||(G.getAttribute("id")!="table_"+this.parentBone.id)){this.clearClipboardItems();}return ;}if(mstrGridStatic.isMouseOverScrollBar(A,lMouseX,lMouseY)){return ;}if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){P=!!microstrategy.findAncestorWithAtt(A,"id","rwb_viewer");}else{var K=(A.className&&A.className=="repLayoutRight");var J=(bIsW3C)?"class":"className";var M=microstrategy.findAncestorWithAtt(A,J,"mstrVerticalDocks");var I=microstrategy.findAncestorWithAtt(A,microstrategy.HTMLATTR_OBJTYPE,"if");if(I==null){var F=microstrategy.findAncestorWithAtt(A,microstrategy.HTMLATTR_ID,"drillEditor_pane");if(F==null){var O=microstrategy.findAncestorWithAtt(A,J,"report-right");if(O==null){var N=microstrategy.findAncestorWithAtt(A,J,"report-left");if(N!=null){D=true;}}else{D=true;}}else{D=true;}}else{D=true;}if(M!=null||K){P=true;}}E=(P&&!D&&(G==null||(G.getAttribute("id")!="table_"+this.parentBone.id)));if(E){this.clearAll();}}catch(H){microstrategy.errors.log(H);}};mstrGridSelectionsImpl.prototype.handleCopySelections=function(L,N,V){if(V.button==2){return ;}var S={ADD:0,REMOVE:1,RANGE_ADD:2},Q=this.clipboardUnits||{},R=this.getCellLevel(L),O=this.findTemplateUnit(L,R),E=this.getCellIndexInTable(L),H=this.findAllAssociatedCells(N,L,R),C=(V.ctrlKey||isMac&&V.metaKey),M=V.shiftKey,F=!M,J=S.ADD,X=false,T;if(C&&!M){J=Q[E]?S.REMOVE:S.ADD;}else{if(M){J=S.RANGE_ADD;X=!C;}else{X=true;}}if(X){Q={};this.clearClipboardItems();}var P=X;switch(J){case S.ADD:var W=[],D;if(R==microstrategy.GRIDCELLTYPE_UNIT_HEADER||R==microstrategy.GRIDCELLTYPE_SUBTOTAL_HEADER){W=H;}else{if(N.axis==microstrategy.GRIDCELL_AXIS_ROWS&&N.depth==this.parentBone.gridStructureInfo.getMaxAxisPosition(N.axis)-1){var U=this.parentBone.elem.getElementsByTagName("table")[0];var K=L.parentNode;var B=K.nodeName.toLowerCase();if((B!="tr")){K=microstrategy.findParentWithTag(K,"tr");}W=(this.parentBone.commands.queryState("checkMergeRowHeader")?util_getAllCellsInRowFromThisCell(L,U):U.rows[K.rowIndex].cells)||[];P=false;}}for(T=0;T<W.length;T++){D=W[T];Q[this.getCellIndexInTable(D)]=D;}Q[E]=L;break;case S.REMOVE:this.clearClipboardItems();delete Q[E];break;case S.RANGE_ADD:var Y=L.getAttribute(microstrategy.HTMLATTR_GRIDCELL_ID),A=false,I=-1,G=-1,D;for(T=0;T<H.length;T++){D=H[T];if(D===L||D===this.lastCopySelection){A=!A;if(!A){Q[this.getCellIndexInTable(D)]=D;break;}}if(A){Q[this.getCellIndexInTable(D)]=D;}}if(A){Q={};Q[E]=L;F=true;}break;}if(F){this.lastCopySelection=L;}this.clipboardUnits=Q;this.copyToClipboard(false,P);};mstrGridSelectionsImpl.prototype.handleSelectAll=function(){try{microstrategy.showWait();var G={},H=this,A=this.parentBone,E=A.elem,J=E.getElementsByTagName("table")[0],F=J.rows,D,C,I;A.commands.exec("tbGridUnitSelector",mstrGridReport.ALL_UNITS);A.commands.exec("tbGridValueSelector",mstrGridReport.ALL_FORMAT_VALUES);addCssClass(E,["cbSel"]);window.setTimeout(function(){for(D=0;D<F.length;D++){I=F[D].cells;for(C=0;C<I.length;C++){G[H.getCellIndexInTable(I[C])]=I[C];}}H.clipboardUnits=G;H.copyToClipboard(true,true);},0);}catch(B){microstrategy.errors.log(B);}};mstrGridSelectionsImpl.prototype.getCellIndexInTable=function(N){var A=this.tableLookup;if(!A){var E=[],O=this.parentBone.elem.getElementsByTagName("table")[0],H=O.rows,I,P,F,F,D,C,B;A={};for(F=0;F<H.length;F++){P=H[F].cells;var M=H[F].rowIndex;for(D=0;D<P.length;D++){var L=P[D],K=L.rowSpan||1,G=L.colSpan||1,J;I=E[M]=E[M]||[];for(C=0;C<I.length+1;C++){if(!I[C]){J=C;break;}}A[this.getIndexFromCell(L)]=J;for(C=M;C<M+K;C++){I=E[C]=E[C]||[];for(B=J;B<J+G;B++){I[B]=[M,J];}}}}this.tableLookup=A;this.tableReference=E;}return(N.parentNode.rowIndex+","+A[this.getIndexFromCell(N)]);};mstrGridSelectionsImpl.prototype.findAllAssociatedCells=function(C,A){try{if(!C){return[];}var B=microstrategy,G=[],I=[],D=this.getCellLevel(A),H=(C.subtype==B.SUBOBJTYPE_METRIC),F;if(D==B.GRIDCELLTYPE_UNIT_HEADER){D=B.GRIDCELLTYPE_UNIT_VALUE;}else{if(D==B.GRIDCELLTYPE_SUBTOTAL_HEADER){D=B.GRIDCELLTYPE_SUBTOTAL_VALUE;}}G=G.concat(this.parentBone.findAllCells(C,D,true));if(H){G=G.concat(this.parentBone.getCellsWithAttr(B.HTMLATTR_GRID_CELL_TYPE,B.GRIDCELLTYPE_SUBTOTAL_VALUE));}for(F in G){if(this.isAlignedHeader(G[F],A)){I.push(G[F]);}}return I;}catch(E){microstrategy.errors.log(E);return false;}};mstrGridSelectionsImpl.prototype.isAlignedHeader=function(C,G){var F=false,E=[G.rowSpan,G.colSpan],A=this.getCellIndexInTable(C).split(","),D=this.getCellIndexInTable(G).split(","),B;for(B=0;B<2;B++){F=F||((parseInt(D[B],10)<=parseInt(A[B],10))&&((parseInt(D[B],10)+E[B])>parseInt(A[B],10)));}return F;};mstrGridSelectionsImpl.prototype.getHeaderSourceList=function(C){var B=microstrategy,D=[],E=this.getCellLevel(C),G=this.findTemplateUnitObj(C,E);if(G){var I=(G.subtype==B.SUBOBJTYPE_METRIC),A=microstrategy.HTMLATTR_DSS_ID,F=G.dssId;switch(E){case B.GRIDCELLTYPE_SUBTOTAL_VALUE:D.push(this.parentBone.findAllCells(G,B.GRIDCELLTYPE_SUBTOTAL_HEADER,true)[0]);I=true;A=B.HTMLATTR_SUBOBJTYPE;F="MV";case B.GRIDCELLTYPE_UNIT_VALUE:case B.GRIDCELLTYPE_METRIC_DATA:if(I){var H=this.parentBone.getCellsWithAttr(A,F);i;for(i=0;i<H.length;i++){if(this.isAlignedHeader(C,H[i])){D.push(H[i]);}}}else{D.push(this.findTemplateUnit(C,E));}break;default:D.push(C);}}return D;};mstrGridSelectionsImpl.prototype.copyToClipboard=function(N,D){var T=[],I=this.clipboardUnits,O,P,A,H=function(a,U,Y){var W,e,X,Z,V;X=U.split(",");W=X[0];e=X[1];Y[W]=Y[W]||[];Z=(a.innerText||a.textContent||"").replace("\n","");if(!trimString(Z)){V=a.getElementsByTagName("img");if(V&&V[0]){Z=V[0].title;}}Y[W][e]=Z;};for(P in I){H(I[P],P,T);if(!D){A=this.getHeaderSourceList(I[P]);for(O=0;O<A.length;O++){var Q=A[O];if(Q){var E=this.getCellIndexInTable(Q);H(Q,E,T);I[E]=Q;}}}}var M="",G,J=-1,F=true,B=-1;for(G in T){B=Math.max(T[G].length,B);}P=0;while(P<B){for(G in T){if(T[G][P]!=undefined){P++;F=false;break;}}if(F){for(G in T){T[G]=T[G].slice(0,P).concat(T[G].slice(P+1));}B--;}else{F=true;}}for(G in T){if(T[G].length){M=M+T[G].join("\t")+"\n";}}var R=document.getElementById("mstrWeb_content")||document.body,K=document.getElementById("clipboardTextArea")||R.appendChild(document.createElement("textarea"));if(K){K.setAttribute("id","clipboardTextArea");K.value=M;var L=K.style;L.left=document.documentElement.scrollLeft+"px";L.top=document.documentElement.scrollTop+"px";window.setTimeout(function(){K.select();K.focus();microstrategy.showWait(false);},50);var C=this;K.onkeyup=function S(V){V=V||window.event;switch(V.keyCode){case 65:if(V.ctrlKey){var U=C.parentBone;if(!(U.delegateSelectAll&&U.delegateSelectAll())){C.handleSelectAll();}else{C.clearClipboardItems();}}break;}return true;};}};mstrGridSelectionsImpl.prototype.clearClipboardItems=function(){if(!this.clipboardUnits){return ;}removeCssClass(this.parentBone.elem,["cbSel"]);delete this.clipboardUnits;var A=document.getElementById("clipboardTextArea");if(A){A.value="";A.blur();}};function mstrGridSelectionsImpl(){this.selectedUnits=new Array();this.hilitedItems=new Array();return this;}mstrUnitObjImpl.prototype=new Object();mstrUnitObjImpl.prototype.levels=null;mstrUnitObjImpl.prototype.gridTarget="";mstrUnitObjImpl.prototype.isMetric=false;mstrUnitObjImpl.prototype.levelObjs=null;mstrUnitObjImpl.prototype.removeLevel=function(C){try{for(var A in this.levels){if(this.levels[A]==C){delete this.levels[A];}}}catch(B){microstrategy.errors.log(B);}};mstrUnitObjImpl.prototype.hasLevel=function(C){try{for(var A in this.levels){if(this.levels[A]==C){return true;}}return false;}catch(B){microstrategy.errors.log(B);}};mstrUnitObjImpl.prototype.countLevel=function(){try{var C=0;for(var A in this.levels){if(this.levels[A]!=null&&this.levels[A].length>0){C++;}}return C;}catch(B){microstrategy.errors.log(B);}};mstrUnitObjImpl.prototype.resolveLevelsValue=function(){try{if(!this.levels||this.levels.length==0){return 0;}switch(this.levels.length){case 1:return this.levels[0];case 4:return 5;default:return -1;}}catch(A){microstrategy.errors.log(A);return 2;}};function mstrUnitObjImpl(A){this.parentBone=A;this.levels=new Array;this.levelObjs=new Array;this.isMetric=false;this.gridTarget="";return this;}mstrUnitLevelObjImpl.prototype=new Object();mstrUnitLevelObjImpl.prototype.selectedItems=null;mstrUnitLevelObjImpl.prototype.selectedItemsLength=0;mstrUnitLevelObjImpl.prototype.hilitedItems=null;mstrUnitLevelObjImpl.prototype.hilitedItemsLength=0;mstrUnitLevelObjImpl.prototype.addToSelectedItems=function(B){try{var A=this.gridSelections.getIndexFromCell(B);this.selectedItems[A]=B;this.selectedItemsLength++;}catch(C){microstrategy.errors.log(C);}};mstrUnitLevelObjImpl.prototype.removeSelectedItems=function(B){try{var A=this.gridSelections.getIndexFromCell(B);delete this.selectedItems[A];this.selectedItemsLength--;}catch(C){microstrategy.errors.log(C);}};mstrUnitLevelObjImpl.prototype.clearSelectedItems=function(){try{this.selectedItems=new Array;this.selectedItemsLength=0;}catch(A){microstrategy.errors.log(A);}};mstrUnitLevelObjImpl.prototype.addToHilitedItems=function(A){try{var C=this.gridSelections.getIndexFromCell(A);this.hilitedItems[C]=A;this.hilitedItemsLength++;var G=this.gridSelections.parentBone.elem.getElementsByTagName("table");if(G!=null&&G.length&&G.length>1){var D=A.cellIndex;var E=A.parentNode.rowIndex;for(i=0,len=G.length;i<len;++i){var H=G[i];if(H&&H.rows){if(E<H.rows.length){var I=H.rows[E];if(I&&I.cells&&(D<I.cells.length)){var F=I.cells[D];if(F){this.gridSelections.hiliteSelected(F);}}}}}}else{this.gridSelections.hiliteSelected(A);}}catch(B){microstrategy.errors.log(B);}};mstrUnitLevelObjImpl.prototype.removeHilitedItems=function(B){try{var A=this.gridSelections.getIndexFromCell(B);delete this.hilitedItems[A];this.hilitedItemsLength--;this.gridSelections.removeHilites(B);}catch(C){microstrategy.errors.log(C);}};mstrUnitLevelObjImpl.prototype.clearHilitedItems=function(){try{var H=this.gridSelections.parentBone.elem.getElementsByTagName("table"),D,J;if(H!=null&&H.length&&H.length>1){for(J=0,D=H.length;J<D;++J){var I=H[J],A,E,F,K,G,C;if(I&&I.rows){for(C in this.hilitedItems){if(typeof C==="string"){A=C.split(",");F=A[0];if(F<I.rows.length){K=I.rows[F];E=A[1];if(K&&K.cells&&(E<K.cells.length)){G=K.cells[E];if(G){this.gridSelections.removeHilites(G);}}}}}}}}else{for(C in this.hilitedItems){this.gridSelections.removeHilites(this.hilitedItems[C]);}}this.hilitedItems=new Array;this.hilitedItemsLength=0;}catch(B){microstrategy.errors.log(B);}};mstrUnitLevelObjImpl.prototype.hasSelectedCell=function(B){try{var A=this.gridSelections.getIndexFromCell(B);return(typeof (this.selectedItems[A])!="undefined"&&this.selectedItems[A]!=null);}catch(C){microstrategy.errors.log(C);return false;}};mstrUnitLevelObjImpl.prototype.hasSelectedCells=function(){try{return(this.selectedItems&&this.selectedItemsLength>0);}catch(A){microstrategy.errors.log(A);return false;}};mstrUnitLevelObjImpl.prototype.hasHilitedCells=function(){try{return(this.hilitedItems&&this.hilitedItemsLength>0);}catch(A){microstrategy.errors.log(A);return false;}};mstrUnitLevelObjImpl.prototype.hasHilitedCell=function(B){try{var A=this.gridSelections.getIndexFromCell(B);return(typeof (this.hilitedItems[A])!="undefined"&&this.hilitedItems[A]!=null);}catch(C){microstrategy.errors.log(C);return false;}};function mstrUnitLevelObjImpl(A){this.parentBone=A;this.gridSelections=this.parentBone.parentBone;this.selectedItems=new Array;this.hilitedItems=new Array;return this;}mstrGridStaticScript=true;var mstrGrid=mstrGridStatic;mstrGridStatic.prototype=new mstrRWUnitBoneImpl();mstrGridStatic.prototype.useLockset=false;mstrGridStatic.prototype.lockSet=null;mstrGridStatic.prototype.commands=null;mstrGridStatic.prototype.isGridBone=true;mstrGridStatic.prototype.isGridPostLoaded=false;mstrGridStatic.prototype.hasResized=false;mstrGridStatic.prototype.emptyCase=false;mstrGridStatic.prototype.lockHeadersInitialized=false;mstrGridStatic.prototype.titleBarObj=null;mstrGridStatic.prototype.isTitleVisible=false;mstrGridStatic.prototype.wait=null;mstrGridStatic.prototype.isGridStatic=true;mstrGridStatic.prototype.onload=function(){try{mstrRWUnitBoneImpl.prototype.onload.call(this);if(!this.elem){return ;}this.wait=document.getElementById(this.id+"_wait");this.commands=new mstrGridStaticCommands(this);this.observer=microstrategy.observer||new mstrObserverImpl();microstrategy.observer=this.observer;var A=this.isGridStatic&&this.initGrid();}catch(B){microstrategy.errors.log(B);}};mstrGridStatic.prototype.onpostload=function(){try{mstrRWUnitBoneImpl.prototype.onpostload.call(this);if(this.lockSet){this.onresize();}this.isGridPostLoaded=true;}catch(A){microstrategy.errors.log(A);}};mstrGridStatic.prototype.onresize=function(){try{this.resizeLockSet();if(this.isGridPostLoaded){this.hasResized=true;}}catch(A){microstrategy.errors.log(A);}};mstrGridStatic.prototype.initGrid=function(){try{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var C=microstrategy.findAncestor(this.elem.parentNode);if(C!=null&&microstrategy.styleObj){this.gridPosition=parseInt(microstrategy.styleObj.getAttValue(C,microstrategy.HTMLATTR_GRID_POS));this.gridArea=parseInt(microstrategy.styleObj.getAttValue(C,microstrategy.HTMLATTR_GRID_AREA_PCT))/100;}}this.emptyCase=(this.elem.getAttribute("ept")=="-1");if(this.isGridBone&&!this.emptyCase){var B=this;window.setTimeout(function(){B.initLockHeaders();B.resizeLockSet();},100);if(bIsIE6){this.forcerepaint(document.getElementById("ReportFrame"));}}this.hasResized=false;if(bIsIE7){window.setTimeout("microstrategy.bone('"+this.id+"'). forcerepaint();",0);}}catch(A){microstrategy.errors.log(A);}};mstrGridStatic.prototype.initLockHeaders=function(){try{if(!this.useLockset){return ;}var C=this.id;var B=document.getElementById(C);var D=document.getElementById(C+"divLock4");if(B&&D){D.style.overflow="visible";this.lockSet=new mstrLockSet(B,D,this);if(!this.lockSet.initialized){return ;}this.lockSet.addScrollEventHandler();D.style.overflow="auto";}this.LockHeadersInitialized=true;window.setTimeout("microstrategy.repaintContent('"+this.id+"');",0);window.setTimeout("microstrategy.bone('"+this.id+"'). hideWait();",0);}catch(A){microstrategy.errors.log(A);}};mstrGridStatic.prototype.hideWait=function(){if(this.wait){this.wait.style.display="none";}};mstrGridStatic.prototype.showWait=function(){if(this.wait){this.wait.style.display="block";}};mstrGridStatic.prototype.forcerepaint=function(B){try{var A=document.createElement("img");B=B||this.elem;B.appendChild(A);A.parentNode.removeChild(A);}catch(C){microstrategy.errors.log(C);}};mstrGridStatic.prototype.resizeLockSet=function(C){try{if(!this.lockSet){return ;}if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var E=microstrategy.findAncestor(this.elem.parentNode),B=mstr.utils.BoxModel;if(E){var J=B.getElementInnerWidth(E)+((mstr.utils.ISIE8||mstr.utils.ISIE9||mstr.utils.ISIE10)?2:0),G=B.getElementInnerHeight(E)+(mstr.utils.ISIE?1:0);if(J<=0&&G<=0){return ;}J=Math.max(J,mstrLockSet.MINIMUM_GRID_WIDTH);G=Math.max(G,mstrLockSet.MINIMUM_GRID_HEIGHT);if(this.isGrid&&this.isGraph){if(this.gridPosition<2){G=Math.round(G*this.gridArea);}else{J=Math.round(J*this.gridArea);}}var H=(this.isGridStatic)?0:this.getTitleHeight(),D=Math.max((G-H-(this.incfetchvisible?26:0)),0);var A=parseInt(microstrategy.styleObj.getAttValue(E,microstrategy.HTMLATTR_HEIGHT_MODE));if(A===microstrategy.AUTO_MODE){var I=document.getElementById(this.id+"divLock4");if(I){D+=Math.max(I.scrollHeight-I.clientHeight,0);window.setTimeout(function(){I.style.height="auto";},0);}}this.lockSet.resize(C,J,D);}else{this.lockSet.resize(C,mstrLockSet.MINIMUM_GRID_WIDTH,mstrLockSet.MINIMUM_GRID_HEIGHT);}}else{this.lockSet.resize(C);}}catch(F){microstrategy.errors.log(F);}};mstrGridStatic.prototype.getFixedRows=function(){try{return this.getFixedHeaders(0);}catch(A){microstrategy.errors.log(A);}return 0;};mstrGridStatic.prototype.getFixedColumns=function(){try{return this.getFixedHeaders(1);}catch(A){microstrategy.errors.log(A);}return 0;};mstrGridStatic.prototype.getFixedHeaders=function(A){try{var C=0;var J=document.getElementById(this.id+"divLock4");if(!J){return C;}var F,B;var K=J.getElementsByTagName("tbody")[0].rows;if(A==0){for(F=0,B=K.length;F<B;F++){var H=K[F];if(H.getAttribute("o")){break;}C++;}}else{var I=K[0].cells;for(F=0,B=I.length;F<B;F++){var D=I[F];if(D.getAttribute("upt")||D.getAttribute("i")){break;}var G=parseInt(D.getAttribute("colSpan"));C+=G||1;}}return C;}catch(E){microstrategy.errors.log(E);return 0;}};mstrGridStatic.prototype.onstatechange=function(){if(this.observer){this.observer.notifyAll("onstatechange");}};mstrGridStatic.isGraphCommand=function(A){switch(A){case"majorPicker":case"minorPicker":case"major":case"minor":case"legend":case"dValues":case"seriesByColumn":case"seriesByRow":case"maxCategories":case"maxSeries":case"CategoriesSeries":case"FormatGraphUniversal":case"fmtSubTargets":case"numSubTargets":case"gfeField":case"majorType":case"minorType":case"curvedLines":case"mainCat":case"subCat":case"seriesLayout":case"seriesLabels":case"antiAliasing":case"roundedEffect":case"lockFontSize":case"showSubtotals":case"fontName":case"fontSize":case"textBoldItalic":case"textBold":case"textItalic":case"textUnderline":case"textStrikeout":case"fontColor":case"fillColor":case"lineColor":case"bevelType":case"areaAlpha":case"show":case"dataTextShow":case"titlePosition":case"titleContent":case"titleOriContent":case"tooltipsShow":case"tooltipsEditor":case"tooltipsEditor_ie":case"tooltipsEditor_ie_ScatterBubble":case"gridIntervalX":case"gridIntervalY1":case"gridIntervalY2":case"gridIntervalZ":case"maxScaleX":case"minScaleX":case"maxScaleY1":case"minScaleY1":case"maxScaleY2":case"minScaleY2":case"maxScaleZ":case"minScaleZ":case"maxScaleCKX":case"minScaleCKX":case"maxScaleCKY1":case"minScaleCKY1":case"maxScaleCKY2":case"minScaleCKY2":case"maxScaleCKZ":case"minScaleCKZ":case"gridIntervalCKX":case"gridIntervalCKY1":case"gridIntervalCKY2":case"gridIntervalCKZ":case"dualAxisAuto":case"dualOptionItems":case"seriesLabels":case"gfnCat":case"gfnTime":case"gfnFraction":case"gfnDate":case"gfnDecimalPlaces":case"gfnCurrencySymbol":case"gfnCurrencyPosition":case"gfnNegativeNumbers":case"gfnThousandSeparator":case"gfnFormat":case"gaugeStyle":case"gaugeNeedleStyle":case"gaugeBorderStyle":case"gaugeBorderThick":case"gaugeRangeThick":case"gaugeStartAngle":case"gaugeStopAngle":case"ResetGFEStatus":case"openGraphFormatter":case"getDefaultVal":case"tbGraphValueSelector":case"isGraphPropertiesReady":case"gaugeQBShow":case"seriesLineColor":case"seriesLineStyle":case"seriesLineThickness":case"lineAlpha":case"seriesLineAlpha":case"seriesLineAlphaText":case"markerShow":case"markerShape":case"markerBevelType":case"markerSize":case"markerColor":case"markerAlphaText":case"markerBorderColor":case"markerBorderStyle":case"markerBorderThickness":case"markerBorderAlpha":case"markerBorderAlphaText":case"maxBarSizeType":case"maxBarSizeValue":case"textFormatField_visible":case"seriesLineFormatField_visible":case"seriesAreaFormatField_visible":case"markerFormatField_visible":case"increfillColor":case"decreFillColor":case"increDecreColorField":case"isIncreDecreItem":return true;default:return false;}};mstrGridStatic.isGridGraphCommand=function(A){switch(A){case"font":case"FontFamily":case"fsize":case"FontSize":case"color":case"FontColor":case"fstyle":case"Bold":case"Italic":case"Underline":case"FillColor":case"bgcolor":case"lncolor":case"TextAlign":case"number":case"align":case"Currency":case"deltaDecimal":case"IncreaseDecimal":case"DecreaseDecimal":case"IntlCurrency":case"Percent":case"Comma":case"borders":case"lnstyle":case"FillColor_vf":case"lncolor_vf":return true;default:return false;}};mstrGridStatic.isMouseOverScrollBar=function(F,L,K){try{var J=document.documentElement,A=J.scrollLeft,G=J.scrollTop;var E=false;if(!mstr.utils.ISW3C&&F.componentFromPoint){return F.componentFromPoint(L-A,K-G).indexOf("scroll")>-1;}else{if((getObjOuterWidth(F)-getObjInnerWidth(F)>(SCROLLBAR_SIZE-2))||(getObjOuterHeight(F)-getObjInnerHeight(F)>(SCROLLBAR_SIZE-2))){var B=0,C=0;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var I=microstrategy.getViewerBone().elem;B=I.scrollTop;C=I.scrollLeft;}else{var H=document.getElementById("mstrWebContents"),C=H&&H.scrollLeft||0;B=H&&H.scrollTop||0;}if((L>getObjSumLeft(F)+getObjInnerWidth(F)-C)||(K>getObjSumTop(F)+getObjInnerHeight(F)-B)){return true;}}}return false;}catch(D){microstrategy.errors.log(D);return false;}};mstrGridStatic.prototype.getSelectionData=function(B){var C=this.selectionData;if(!C||!C.attl){return ;}if(B){return C.attl[B];}for(var A in C.attl){return C.attl[A];}};mstrGridStatic.prototype.getAllSelectionData=function(){return this.selectionData;};mstrGridStatic.prototype.saveCustomProps=function(E){var D=new Array();var B=microstrategy.updateManager;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var C=window.parent.mstrUpdateManager;var A=this.objId+C.UNIT_SEPARATOR+"Visualization"+C.UNIT_SEPARATOR+"CustomProps"+C.UNIT_SEPARATOR+E;D.push(B.createActionObject(null,C.EDIT_PROPS,microstrategy.bone("rwb_viewer").beanPath,["2048018","2048035"],["false",A],[]));}else{this.setReportProp("Visualization","CustomProps",E,D);}B.add(D);};mstrGridStatic.prototype.getCustomProperties=function(){return this.customProps;};mstrGridStatic.prototype.getVisProperties=function(){return this.visProps;};function mstrGridStatic(A){this.inherits=mstrRWUnitBoneImpl;this.inherits(A);delete this.inherits;this.primaryBone=true;return this;}mstrGridStaticCommands.prototype={};mstrGridStaticCommands.prototype.exec=function(P,J,H,F,E){var L=microstrategy.updateManager;switch(P){case"addToHistoryList":this.sendUMAction(L,L.createActionObject(null,mstrUpdateManager.ADD_HISTORY_LIST,this.parentBone.beanPath,[],[],[]));break;case"openReportFrameElement":this.sendUMAction(L,L.createActionObject(this.elem,mstrUpdateManager.OPEN_FRAME_ELEMENT,this.parentBone.beanPath,["6034"],[J],[]));break;case"allObjects":microstrategy.toggleAccordion(microstrategy.ACCORDION_REPORT_ALL_OBJECT_PANEL);return true;case"objBrowser":microstrategy.toggleAccordion(microstrategy.ACCORDION_REPORT_RP_OBJECT_PANEL);return true;case"relatedReportsPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_REPORT_RELATED_RP_PANEL);return true;case"notesPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_REPORT_NOTES_PANEL);return true;case"reportDetails":microstrategy.toggleEditor("reportDetails_ReportDetailsPanelStyle","reportDetails");return true;case"new":this.sendUMAction(L,L.createActionObject(this.elem,mstrUpdateManager.REPORT_NEW,microstrategy.servletName,[],[],[]),true);break;case"ncSendNow":case"subs":case"mobileSubs":case"ncSubs":case"ncFileSubs":case"ncCacheSubs":case"ncFtpSubs":case"ncPrintSubs":toggleShowBean(P,true);break;case"reset":this.sendUMAction(L,L.createActionObject(this.elem,mstrUpdateManager.REPORT_EVENT_RESET,this.parentBone.beanPath,[],[],[]));break;case"rerun":this.exec("refresh",false,true);break;case"refresh":J=J||false;H=H||false;this.sendUMAction(L,L.createActionObject(this.elem,mstrUpdateManager.REPORT_EVENT_REFRESH,this.parentBone.beanPath,["4136","4145"],[J,H],[]),J);break;case"reprompt":this.exec("refresh",true,false);break;case"reportDetailsPage":var L=microstrategy.updateManager,C=this.parentBone.stateID,O=this.parentBone.messageID;O=O!=undefined?O:microstrategy.bones.ReportFrame.reportProps.messageID;C=C!=undefined?C:microstrategy.bones.ReportFrame.reportProps.stateID;this.sendUMAction(L,L.createActionObject(this.elem,mstrUpdateManager.REPORT_DETAILS_PAGE,microstrategy.servletName,["3015","3010","3016"],[C,O,"0"],[]),true);break;case"createPersonalView":toggleShowBean("pvsubs",true);break;case"ShowSharingEditor":var N=this.parentBone,G=N.isReportBlank,B=N.stateID,K="sharingEditor",M=window.mstrmojo&&mstrmojo.all[K],A=!(M&&M.lastState===B),D=-1,I=false;if(N.isGrid&&N.isGraph){D=microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;}else{if(N.isGrid){D=microstrategy.DISPLAY_MODE_GRID;}else{if(N.isGraph){D=microstrategy.DISPLAY_MODE_GRAPH;}}}I=!(M&&D===M.viewMode);A=A||I;if(G){showMessage({contents:microstrategy.descriptors.getDescriptor("14120"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"mstr.$obj('"+this.parentBone.id+"').commands.exec('dmSaveAs', {origin:"+microstrategy.SAVE_AS_SHARE_EDITOR+"});",buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("118")},type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.showSharingEditor(null,{viewMode:D,lastState:B},A);}break;default:microstrategy.errors.log("cmdId: "+P+" "+microstrategy.descriptors.getDescriptor("2950"));}};mstrGridStaticCommands.prototype.sendUMAction=function(A,C,B){A.add([C]);A.useIframe=!B;A.flushAndSubmitChanges();};mstrGridStaticCommands.prototype.queryEnabled=function(A){try{switch(A){case"relatedReportsPanel":case"notesPanel":case"new":case"reportDetails":case"refresh":case"reprompt":case"reset":case"reportDetailsPage":case"ShowSharingEditor":case"openHome":return true;case"rerun":return this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ENABLE_REEXECUTE);case"addToHistoryList":return mstr.behaviors.featureResolver.featAvailable("enable-add-history-list");case"createPersonalView":case"subs":return this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ENABLE_SCHEDULING);case"subscribeToMenu":var B=mstr.behaviors.featureResolver;return B.featAvailable("nc-enabled")&&(B.featAvailable("scheduling")||(B.featAvailable("is-viewable-report")&&(B.featAvailable("use-mobile")||B.featAvailable("scheduled-email")||B.featAvailable("scheduled-file-export-menu")||B.featAvailable("scheduled-print-menu"))));default:return false;}}catch(C){microstrategy.errors.log(C);return false;}};mstrGridStaticCommands.prototype.queryState=function(A,D){try{switch(A){case"visualizationMode":case"XTabView":if(this.parentBone.isVisualization){return this.parentBone.visualizationMode;}case"XTabViewDHTML":var B=microstrategy.DISPLAY_MODE_GRID;if(this.parentBone.effectiveView){B=this.parentBone.effectiveView;}else{if(this.parentBone.isGrid&&this.parentBone.isGraph){B=microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;}else{if(this.parentBone.isGraph){B=microstrategy.DISPLAY_MODE_GRAPH;}}}return B;case"fixedRows":return this.parentBone.getFixedRows();case"fixedColumns":return this.parentBone.getFixedColumns();case"reportDetails":return !!microstrategy.bone("reportDetails_ReportDetailsPanelStyle");case"notesPanel":bone=microstrategy.bone("accordion_AccordionTabManagerStyle");return(bone&&bone.currentTabName==microstrategy.ACCORDION_REPORT_NOTES_PANEL);case"relatedReportsPanel":bone=microstrategy.bone("accordion_AccordionTabManagerStyle");return(bone&&bone.currentTabName==microstrategy.ACCORDION_REPORT_RELATED_RP_PANEL);}}catch(C){microstrategy.errors.log(C);}return"";};mstrGridStaticCommands.prototype.queryVisible=function(A){switch(A){case"tbLoading":return false;case"forwardPicker":case"backPicker":case"openPage":return microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE;case"subscribeToMenu":return this.queryEnabled(A);default:return true;}};function mstrGridStaticCommands(A){this.parentBone=A;return this;}mstrHTMLContainerImplScript=true;mstrHTMLContainerImpl.prototype=new mstrRWUnitBoneImpl();mstrHTMLContainerImpl.prototype.onload=function(){try{mstrRWUnitBoneImpl.prototype.onload.call(this);this.elem.ondblclick=new Function("e","microstrategy.bone('"+this.id+"').ondblclick(e);");}catch(A){microstrategy.errors.log(A);return false;}};mstrHTMLContainerImpl.prototype.ondblclick=function(C){try{if(!C){C=window.event;}var A=this.getDocViewer();if(!A.isInteractiveViewModeEplus(C)){if(A.doc.selections){A.doc.selections.clear(false);}stopEventBubbling(C);return true;}stopEventBubbling(C);this.editContents(C);return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrHTMLContainerImpl.prototype.editContents=function(B){var A=this.getDocViewer();if(!A.isFeatureAvailable(microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE)||!A.isFeatureAvailable(microstrategy.FEATURE_CREATE_HTML_CONTAINER)){return ;}A.doc.editText(B,this.elem);};mstrHTMLContainerImpl.prototype.updateContents=function(C,A){var B;if(A==null){B=new Object();B.displayValue=B.saveValue="";}else{if(typeof (A)=="string"){B=new Object();B.displayValue=B.saveValue=A;}else{B=A;}}if(C==microstrategy.HTML_CONTAINER_TYPE_IFRAME){if(B.displayValue==""){this.elem.innerHTML="http://";}else{this.elem.innerHTML=B.displayValue;}}else{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){this.elem.innerHTML=B.displayValue;}else{this.elem.innerHTML=B.saveValue;}}};mstrHTMLContainerImpl.prototype.initNewUnit=function(D){try{var B=D.id+"_Ctr";var A=microstrategy.findChildrenWithAtt(D,"div","scriptClass","mstrHTMLContainerImpl")[0];A.setAttribute("id",B);A.setAttribute("name",B);var E=microstrategy.registerBone(B,"mstrHTMLContainerImplScript",null);E.onload();}catch(C){microstrategy.errors.log(C);return false;}};mstrHTMLContainerImpl.prototype.toggleCurtain=function(A){if(!this.curtain){this.curtain=document.createElement("div");this.curtain.style.position="absolute";this.curtain.style.backgroundColor="#fff";this.curtain.style.width=this.curtain.style.height="100%";this.curtain.style.top=this.curtain.style.left="0px";this.elem.parentNode.appendChild(this.curtain);setFilter(this.curtain,"Alpha",{opacity:50});}if(A){this.curtain.style.display="block";}else{this.curtain.style.display="none";}};function mstrHTMLContainerImpl(A){this.inherits=mstrRWUnitBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrRWControlImplScript=true;mstrRWControlImpl.prototype=new mstrRWUnitBoneImpl();mstrRWControlImpl.prototype.updateManager=microstrategy.updateManager;mstrRWControlImpl.prototype.type=microstrategy.OBJTYPE_RW_CONTROL;mstrRWControlImpl.prototype.ctlKey="";mstrRWControlImpl.prototype.ctlType="";mstrRWControlImpl.prototype.targetKeys="";mstrRWControlImpl.prototype.extraKeys="";mstrRWControlImpl.prototype.ctlStyle="";mstrRWControlImpl.prototype.ctlOrientation="";mstrRWControlImpl.prototype.multiSelect=false;mstrRWControlImpl.prototype.mouseOverAction=false;mstrRWControlImpl.prototype.allAlias="";mstrRWControlImpl.prototype.showAll=false;mstrRWControlImpl.prototype.ctlSrcId="";mstrRWControlImpl.prototype.ctlSrcType="";mstrRWControlImpl.prototype.ctlSrcSubtype="";mstrRWControlImpl.prototype.ctlSrcName="";mstrRWControlImpl.prototype.styleHelper=null;mstrRWControlImpl.prototype.isInteractive=false;mstrRWControlImpl.prototype.itemWidthMode="1";mstrRWControlImpl.prototype.unitKeyContext="";mstrRWControlImpl.prototype.showTotal=false;mstrRWControlImpl.prototype.totalPosition=1;mstrRWControlImpl.prototype.formDelimiter=":";mstrRWControlImpl.prototype.displayFormType=1;mstrRWControlImpl.prototype.attrForms="";mstrRWControlImpl.prototype.sortAttrForm=1;mstrRWControlImpl.prototype.sortType=1;mstrRWControlImpl.prototype.aow=0;mstrRWControlImpl.prototype.candidateAtts="";mstrRWControlImpl.prototype.replaceAttId="";mstrRWControlImpl.prototype.replaceAttType="";mstrRWControlImpl.prototype.replaceAttName="";mstrRWControlImpl.prototype.selections=null;mstrRWControlImpl.prototype.isAllSelected=false;mstrRWControlImpl.prototype.autoSync=false;mstrRWControlImpl.prototype.include=true;mstrRWControlImpl.OPTION_ALL="u;";mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST="1";mstrRWControlImpl.CTL_TYPE_METRIC_LIST="2";mstrRWControlImpl.CTL_TYPE_PANEL_STACK="3";mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION="4";mstrRWControlImpl.CTL_TYPE_ATTR_QUAL="7";mstrRWControlImpl.CTL_TYPE_ATTR_LIST="8";mstrRWControlImpl.CTL_STYLE_POOL_DOWN="0";mstrRWControlImpl.CTL_STYLE_SCROLLER="1";mstrRWControlImpl.CTL_STYLE_LIST_BOX="2";mstrRWControlImpl.CTL_STYLE_RADIO_BUTTON="3";mstrRWControlImpl.CTL_STYLE_CHECKBOX="4";mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY="5";mstrRWControlImpl.CTL_STYLE_LINK_ARRAY="6";mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER="7";mstrRWControlImpl.CTL_STYLE_METRIC_QUALIFICATION="8";mstrRWControlImpl.CTL_STYLE_SEARCH_BOX="9";mstrRWControlImpl.CTL_STYLE_ATTR_QUALIFICATION="11";mstrRWControlImpl.ORIENTATION_VERTICAL="0";mstrRWControlImpl.ORIENTATION_HORIZONTAL="1";mstrRWControlImpl.FMT_TYPE_UNSELECTED="2";mstrRWControlImpl.FMT_TYPE_SELECTED="3";mstrRWControlImpl.FMT_TYPE_HIGHLIGHTED="4";mstrRWControlImpl.FMT_TYPE_TITLE=5;mstrRWControlImpl.FMT_TYPE_TITLE_BASE=4;mstrRWControlImpl.heightAndWidthAttMap={hm:"heightMode",wm:"widthMode",ht:"height",wd:"width"};mstrRWControlImpl.DFM_MIXED=-1;mstrRWControlImpl.DFM_SLICING=0;mstrRWControlImpl.DFM_UC=1;mstrRWControlImpl.DFM_UC_ON_DS=2;mstrRWControlImpl.CTL_SUBTYPE_UNSPECIFIED=0;mstrRWControlImpl.CTL_SUBTYPE_CONDITION_SELECTOR=1;mstrRWControlImpl.CTL_SUBTYPE_CONDITION_SELECTOR_ON_DS=2;mstrRWControlImpl.EVENT_SEPARATOR="\u001E";mstrRWControlImpl.CTL_TARGET_TYPE_DOCUMENT=0;mstrRWControlImpl.CTL_TARGET_TYPE_DATASET=1;mstrRWControlImpl.prototype.onload=function(D){try{mstrRWUnitBoneImpl.prototype.onload.call(this);if(!this.getDocViewer()){return ;}if(D){this.init(D);}this.isInteractive=this.getDocViewer().isInteractiveViewModeEplus()&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.ctlType!=mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION;if(!this.sibElems){this.sibElems=document.getElementsByName(this.id);}this.createStyleHelper();if(this.styleHelper){this.styleHelper.onload();}this.isAllSelected=this.selections[mstrRWControlImpl.OPTION_ALL]!=null;if(!this.isInteractive){this.addSelectorCurtain();}this.updateTargetKeys();var B=this.getDocViewer();if(!this.itemFormats){this.itemFormats=new Object();this.itemFormats[mstrRWControlImpl.FMT_TYPE_TITLE]=B.objProps.createFormatObject(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,mstrRWControlImpl.FMT_TYPE_TITLE);this.itemFormats[microstrategy.FORMAT_TYPE_MAIN]=B.objProps.createFormatObject(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.FORMAT_TYPE_MAIN);if(this.ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION){this.itemFormats[mstrRWControlImpl.FMT_TYPE_TITLE]["showTitleBar"]="0";}}if(this.itemFormats&&this.itemFormats[microstrategy.FORMAT_TYPE_MAIN]){this.aow=this.getFormatValue(microstrategy.FORMAT_TYPE_MAIN,"ExportAsShownOnWeb");}this.isTitleVisible=this.itemFormats[mstrRWControlImpl.FMT_TYPE_TITLE]["showTitleBar"]=="-1";this.titleBar=microstrategy.findChildWithAtt(this.elem.parentNode,"DIV",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_CONTAINER_TITLEBAR);this.toggleTitleBars();this.elem.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e);");this.synchronizeShadow();if(this.ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION&&this.ast==null){this.ast=8;this.pso=8;}if(this.isInteractive&&this.ctlStyle==mstrRWControlImpl.CTL_STYLE_LIST_BOX){var C=microstrategy.styleObj,F=C.objSheet.styleRules[C.getId(this.elem.parentNode)],A=F&&F.style.textDecoration;if(F){this.elem.parentNode.style.textDecoration="none";this.textDecoration=A;}if(A){this.cascadeFormatting(this.elem,"textDecoration",A);}}}catch(E){microstrategy.errors.log(E);return false;}};mstrRWControlImpl.prototype.onreload=function(B){try{mstrRWUnitBoneImpl.prototype.onreload.call(this);this.updateTargetKeys();}catch(A){microstrategy.errors.log(A);return false;}};mstrRWControlImpl.prototype.onbonedeleted=function(E){try{mstrRWUnitBoneImpl.prototype.onbonedeleted.apply(this,arguments);var F=E.split("|"),D=[];for(var B=0;B<F.length;B++){if(F[B]!=""){for(var A in this.targetKeys){if(F[B]==this.targetKeys[A]){D.push(A);}}}}for(B in D){delete this.targetKeys[D[B]];}}catch(C){microstrategy.errors.log(C);}};mstrRWControlImpl.prototype.updateTargetKeys=function(){var B=microstrategy.getViewerBone();if(B&&B.targetGroupBys){if(this.groupByTargetKeys&&this.targetKeys&&(this.groupByTargetKeys.length!=this.targetKeys.length)){for(var D=0;D<this.groupByTargetKeys.length;D++){var A=B.targetGroupBys[this.groupByTargetKeys[D]];if(A){var G=false;for(var C=0;C<this.targetKeys.length;C++){if(this.targetKeys[C]==A){G=true;break;}}if(!G){this.targetKeys.push(A);}}}}if(this.phGroupByTargetKeys&&this.targetKeys){for(var D=0;D<this.phGroupByTargetKeys.length;D++){var E=this.phGroupByTargetKeys[D].split("_");var A=B.targetGroupBys[E[0]];if(A){var F=A+"_"+E[1];var G=false;for(var C=0;C<this.targetKeys.length;C++){if(this.targetKeys[C]==F){G=true;break;}}if(!G){this.targetKeys.push(F);}}}}}};mstrRWControlImpl.prototype.synchronizeShadow=function(C){try{if(!bIsFirefox&&this.ctlStyle==mstrRWControlImpl.CTL_STYLE_SCROLLER){var B=this.getDocViewer().doc.styleObj;var I=this.elem;C=C?C:B.getAttValue(I,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT);if(C==null){C=B.getAttValue(I.parentNode,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT);if(C!=null){I=I.parentNode;}}var A=B.getAttValue(I,microstrategy.HTMLATTR_DROP_SHADOW);var G=microstrategy.findChildWithAtt(I,"span","sty","shw");if(G){G.parentNode.removeChild(G);}this.shadowContainer=null;if(C=="1"){this.shadowContainer=I.cloneNode(false);this.shadowContainer.setAttribute("sty","shw");this.shadowContainer.id=I.id+"_sh";I.insertAdjacentElement("afterBegin",this.shadowContainer);this.shadowContainer.style.backgroundColor=B.getValue(I,"backgroundColor");for(var E=0;E<I.childNodes.length;E++){if(I.childNodes[E].nodeType==1){I.childNodes[E].style.zIndex=2;I.childNodes[E].style.position="absolute";}}this.shadowContainer.style.zIndex=1;this.shadowContainer.style.left="-"+B.getValue(I,"borderLeftWidth");this.shadowContainer.style.top="-"+B.getValue(I,"borderTopWidth");var H=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,Math.round(A*microstrategy.ZOOM_FACTOR/100));if(mstr.utils.ISDXIE){this.shadowContainer.style.filter="progid:DXImageTransform.Microsoft.dropshadow(Color='#66000000', Positive='true', OffX="+H+", OffY="+H+") ";}else{var F=mstr.utils.ISWK?"webkitBoxShadow":"boxShadow";this.shadowContainer.style[F]=H+"px "+H+"px 3px 0 #888";}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrRWControlImpl.prototype.onmousedown=function(B){try{B=B||window.event;getMouse(B);if(typeof (mstrGridStatic)!="undefined"&&mstrGridStatic.isMouseOverScrollBar(this.elem,lMouseX,lMouseY)){B.cancelBubble=true;stopEventBubbling(B);}}catch(A){microstrategy.errors.log(A);return false;}};mstrRWControlImpl.prototype.initNewUnit=function(C){try{var A=C.id+"_Ctl";var E=microstrategy.findChildrenWithAtt(C,"div","scriptClass","mstrRWControlImpl")[0];E.setAttribute("id",A);E.setAttribute("name",A);var D=microstrategy.registerBone(A,"mstrRWControlImplScript",{ctlKey:C.id});D.ctlType=this.ctlType;D.targetKeys=this.targetKeys;D.ctlStyle=this.ctlStyle;D.ctlOrientation=this.ctlOrientation;D.multiSelect=this.multiSelect;D.showAll=this.showAll;D.ctlSrcId=this.ctlSrcId;D.ctlSrcType=this.ctlSrcType;D.ctlSrcSubtype=this.ctlSrcSubtype;D.ctlSrcName=this.ctlSrcName;D.itemWidthMode=this.itemWidthMode;D.itemFormats=this.getDocViewer().objProps.cloneFormats(this.itemFormats);D.autoSync=this.autoSync;D.onload();}catch(B){microstrategy.errors.log(B);return false;}};mstrRWControlImpl.prototype.onSectionChange=function(){try{this.onload();if(this.styleHelper&&this.ctlStyle==mstrRWControlImpl.CTL_STYLE_SCROLLER){for(var B=0;B<this.sibElems.length;B++){var A=microstrategy.bone(this.id+"_scr_"+B);if(A){A.onload();}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrRWControlImpl.prototype.init=function(A){try{if(A!=null){this.ctlType=A.ctlType;this.ctlStyle=A.ctlStyle;this.ctlSrcId=A.ctlSrcId;this.ctlSrcType=A.ctlSrcType;if(A.ctlSrcSubtype){this.ctlSrcSubtype=A.ctlSrcSubtype;}this.ctlOrientation=A.ctlOrientation;this.ctlSrcName=A.ctlSrcName;if(A.ctlTargetStr){this.targetKeys=A.ctlTargetStr.split(CLIPBOARD_ITEM_SEPARATOR);}}this.multiSelect=this.ctlStyle!=mstrRWControlImpl.CTL_STYLE_POOL_DOWN&&this.ctlStyle!=this.CTL_STYLE_RADIO_BUTTON&&this.ctlStyle!=this.CTL_STYLE_SCROLLER;this.showAll=this.ctlType!=mstrRWControlImpl.CTL_TYPE_PANEL_STACK;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWControlImpl.prototype.applyGradientOnItem=function(G,B,N,P,M){try{var L=this.titleBar;var I;var A;if(L&&G==mstrRWControlImpl.FMT_TYPE_TITLE){if(L.getAttribute("gradientcolor")==null){I=L.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR;A=M.encodeValue("backgroundColor",this.getFormatValue(G,"backgroundColor"));}else{I=L.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+"Gradient"+mstrUpdateManager.UNIT_SEPARATOR;A=L.getAttribute("gradientcolor");}var O=N.split(",");var C=this.elem.parentNode;var K=C.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("backgroundStyle")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("backgroundStyle")+mstrUpdateManager.UNIT_SEPARATOR;var Q=C.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR;var H=C.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("gradientColor")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("gradientColor")+mstrUpdateManager.UNIT_SEPARATOR;var F=C.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("gradientAngle")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("gradientAngle")+mstrUpdateManager.UNIT_SEPARATOR;var J=C.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("gradientXOffset")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("gradientXOffset")+mstrUpdateManager.UNIT_SEPARATOR;var D=C.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("gradientYOffset")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("gradientYOffset")+mstrUpdateManager.UNIT_SEPARATOR;if(P){P.push(microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.getDocViewer().beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,Q+M.encodeValue("backgroundColor",N)+mstrUpdateManager.ITEM_SEPARATOR+H+M.encodeValue("gradientColor",N)+mstrUpdateManager.ITEM_SEPARATOR+K+M.encodeValue("backgroundStyle",N)+mstrUpdateManager.ITEM_SEPARATOR+F+O[3]+mstrUpdateManager.ITEM_SEPARATOR+J+O[4]+mstrUpdateManager.ITEM_SEPARATOR+D+O[5]+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,I+A+mstrUpdateManager.ITEM_SEPARATOR]));}this.titleBar.setAttribute("bgstyle","2");this.titleBar.setAttribute("gradientcolor",N);gradientUtil.applyGradient(this.titleBar,O[gradientUtil.GRADIENT_START_COLOR_INDEX],O[gradientUtil.GRADIENT_END_COLOR_INDEX],O[gradientUtil.GRADIENT_ANGLE_INDEX],O[gradientUtil.GRADIENT_XOFFSET_INDEX],O[gradientUtil.GRADIENT_YOFFSET_INDEX],this.getDocViewer().doc.styleObj);}}catch(E){microstrategy.errors.log(E);return false;}};mstrRWControlImpl.prototype.onApplyDefaultFormat=function(F){try{var I=this.getDocViewer(),B=I.doc.styleObj,D=I.objProps,H,A,G,E;if(B){this.elem.setAttribute(microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,B.getAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE));this.elem.setAttribute(microstrategy.HTMLATTR_TITLE_BAR_DISPLAY,B.getAttValue(this.elem,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY));this.isTitleVisible=B.getAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE;this.titleBarDisplay=B.getAttValue(this.elem,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY);}this.toggleTitleBars();this.updatePortalTitle(this.title);if(this.titleBar){D.initObjectFormat(this.titleBar,false,this.activeRWUnit.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE),mstrRWControlImpl.FMT_TYPE_TITLE);}}catch(C){microstrategy.errors.log(C);return false;}};mstrRWControlImpl.prototype.applyGradientOnTitle=function(){try{var A=(this.titleBar.getAttribute("gradientcolor"))?this.titleBar.getAttribute("gradientcolor").split(","):null;if(A){gradientUtil.applyGradient(this.titleBar,A[gradientUtil.GRADIENT_START_COLOR_INDEX],A[gradientUtil.GRADIENT_END_COLOR_INDEX],A[gradientUtil.GRADIENT_ANGLE_INDEX],A[gradientUtil.GRADIENT_XOFFSET_INDEX],A[gradientUtil.GRADIENT_YOFFSET_INDEX]);}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWControlImpl.prototype.setControlGroupByList=function(F,E){try{var C=microstrategy.updateManager;var A="";for(var B=0;B<F.length;B++){A+=(B>0)?"!":"";A+=F[B].dssid;}E.push(C.createActionObject(this.elem,mstrUpdateManager.RW_REORDER_CONTROL_GROUP_BY,this.getDocViewer().beanPath,["2048012","2048173"],[this.ctlKey,A],[]));this.ControlGroupByList=F;}catch(D){microstrategy.errors.log(D);}};mstrRWControlImpl.prototype.setTitle=function(B,C){var A=microstrategy.findChildWithAtt(B,"DIV",microstrategy.HTMLATTR_ID,"titleBar");A.innerHTML=encode(C);};mstrRWControlImpl.prototype.updatePortalTitle=function(B){try{if(!B){B=this.getDocViewer().formattingAttributes[this.RWUnitId].nm;B=this.ctlSrcName||B;B=this.getDocViewer().doc.styleObj.getAttValue(this.elem,microstrategy.HTMLATTR_WINDOW_TITLE)||B;}this.setTitle(this.titleBar,B);this.title=B;}catch(A){}};mstrRWControlImpl.prototype.toggleTitleBars=function(){try{if(this.titleBar){if(this.isTitleVisible){displayObj(this.titleBar);}else{removeObj(this.titleBar);}}else{if(this.isTitleVisible){this.titleBar=this.docViewer.doc.createTitleBar(null,"portal_"+this.id,(this.ctlStyle==7||this.ctlStyle==8)?{boneId:this.id,objKey:this.objId,isSelector:true}:{isSelectorControl:true});this.titleBar.style.height="auto";var B=this.elem.parentNode;B.insertBefore(this.titleBar,B.firstChild);insertDynamicScript("mstrPortalImpl",javaScriptPath+"mstrPortalImpl.js");var D=microstrategy.registerBone(this.titleBar.id,"mstrPortalImpl",null);D.onload();this.updatePortalTitle(this.title);}}if(this.isTitleVisible){this.applyGradientOnTitle();}if(this.titleBar){var A=this.isTitleVisible?"-1":"0";this.docViewer.doc.styleObj.setAttValue(this.titleBar,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,A);this.docViewer.doc.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,A);}}catch(C){microstrategy.errors.log(C);return false;}};mstrRWControlImpl.prototype.showControlOptions=function(D){try{var C=getEventTarget(D),A=microstrategy.getContextMenuManager("RWM").getMenu("controlLocalDataMenu");if(!C.getAttribute("cx")){A.registerTrigger(C,null);}displayContextMenu(C,D,true);}catch(B){microstrategy.errors.log(B);}};mstrRWControlImpl.prototype.setInclude=function(A){try{var E=this.elem.className;this.elem.className=E.replace(/ strikeout/g,"")+(A?"":" strikeout");var C=this.include;this.include=A;if(C!=A){this.swapFunction();var B=this.updateManager;if(B){B.add([B.createActionObject(null,mstrUpdateManager.CTRL_SET_INCLUDE,this.getDocViewer().beanPath,["2048130","2048224","2048001","2048009"],[this.ctlKey,this.include,this.ctlSrcId,this.ctlSrcType],[])]);}B.flushAndSubmitChanges();}}catch(D){microstrategy.errors.log(D);}};mstrRWControlImpl.prototype.setQualType=function(C){try{var F=this.funcType,A=this.mct;this.funcType=C[0];this.asc=C[1];this.mct=C[2];var E=this.updateManager;E.add([E.createEditPropsAction(this.elem.parentNode,this.elem.parentNode.id,this.getDocViewer().beanPath,["mct"],[this.mct],null,true)]);if(this.ctlStyle==8){this.styleHelper.generateSelectOptions();this.styleHelper.onSelectionChange();}else{if(this.ctlStyle==7){var E=microstrategy.updateManager;if(F!=this.funcType){var D=!!this.unitKeyContext?["2048137"]:["2048130"],B=!!this.unitKeyContext?[this.unitKeyContext]:[this.ctlKey];E.add([E.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_UNSET_SELECTOR_CONTROL,this.beanPath,D,B,[])]);E.flushAndSubmitChanges();}else{if(!this.unset){var H=mstr.Enum.Nodes.MRPFUNCTION;if(A!=this.mct){switch(this.func){case H.EQUALSDESCENDING:this.func=H.EQUALSASCENDING;break;case H.NOTEQUALSDESCENDING:this.func=H.NOTEQUALSASCENDING;break;case H.GREATERTHANDESCENDING:this.func=H.GREATERTHANASCENDING;break;case H.GREATERTHANEQUALSDESCENDING:this.func=H.GREATERTHANEQUALSASCENDING;break;case H.LESSTHANDESCENDING:this.func=H.LESSTHANASCENDING;break;case H.LESSTHANEQUALSDESCENDING:this.func=H.LESSTHANEQUALSASCENDING;break;case H.BETWEENDESCENDING:this.func=H.BETWEENASCENDING;break;case H.NOTBETWEENDESCENDING:this.func=H[""];break;case H.INDESCENDING:this.func=H.INASCENDING;break;case H.NOTINDESCENDING:this.func=H.NOTINASCENDING;break;case H.EQUALSASCENDING:this.func=H.EQUALSDESCENDING;break;case H.NOTEQUALSASCENDING:this.func=H.NOTEQUALSDESCENDING;break;case H.GREATERTHANASCENDING:this.func=H.GREATERTHANDESCENDING;break;case H.GREATERTHANEQUALSASCENDING:this.func=H.GREATERTHANEQUALSDESCENDING;break;case H.LESSTHANASCENDING:this.func=H.LESSTHANDESCENDING;break;case H.LESSTHANEQUALSASCENDING:this.func=H.LESSTHANEQUALSDESCENDING;break;case H.BETWEENASCENDING:this.func=H.BETWEENDESCENDING;break;case H.NOTBETWEENASCENDING:this.func=H.NOTBETWEENDESCENDING;break;case H.INASCENDING:this.func=H.INDESCENDING;break;case H.NOTINASCENDING:this.func=H.NOTINDESCENDING;break;}this.onExpressionChanged();}}}}}}catch(G){microstrategy.errors.log(G);}};mstrRWControlImpl.prototype.getViewerOffsets=function(){var A=this.docViewer&&this.docViewer.elem;return{y:A?A.scrollTop:0,x:A?A.scrollLeft:0};};mstrRWControlImpl.prototype.computeToolbarPos=function(){try{mstrRWUnitBoneImpl.prototype.computeToolbarPos.call(this);if(this.toolbar_pos_x+2<0||this.toolbar_pos_y<0){var A=this.activeRWUnit.getElementsByTagName("select");if(A.length>0){this.toolbar_pos_x=getObjSumLeft(this.activeRWUnit)-this.docViewer.doc.left;this.toolbar_pos_y=getObjSumTop(this.activeRWUnit)-this.docViewer.doc.top+getObjOuterHeight(this.elem);}else{this.toolbar_pos_x=getObjSumLeft(this.activeRWUnit)-this.docViewer.doc.left;this.toolbar_pos_y=getObjSumTop(this.activeRWUnit)-this.docViewer.doc.top;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWControlImpl.prototype.addSelectorCurtain=function(){var C=document.createElement("div"),E=getObjHeight(this.elem);C.className="mstrSelectorCurtain";if(E>0){C.style.height=E+"px";}var B=this.sibElems,A=(B&&B.length)||0,D;for(D=0;D<A;D++){B[D].appendChild(C.cloneNode(false));}};mstrRWControlImpl.prototype.createStyleHelper=function(){switch(this.ctlStyle){case mstrRWControlImpl.CTL_STYLE_POOL_DOWN:this.styleHelper=new mstrRWPoolDownStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_SCROLLER:this.styleHelper=new mstrRWScrollerStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_LIST_BOX:case mstrRWControlImpl.CTL_STYLE_ATTR_QUALIFICATION:this.styleHelper=new mstrRWListBoxStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_RADIO_BUTTON:this.styleHelper=new mstrRWRadioStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_CHECKBOX:this.styleHelper=new mstrRWCheckStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY:this.styleHelper=new mstrRWButtonStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_LINK_ARRAY:this.styleHelper=new mstrRWLinkStyleHelper(this);var A=microstrategy.styleObj.getAttValue(this.elem.parentNode,microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR);this.setSelectionColor(A);break;case mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER:this.styleHelper=new mstrRWMetricScrollerStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_METRIC_QUALIFICATION:this.styleHelper=new mstrRWMetricQualificationStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_SEARCH_BOX:this.styleHelper=new mstrRWSearchBoxStyleHelper(this);break;default:break;}};mstrRWControlImpl.prototype.setSelectionColor=function(A){if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_LINK_ARRAY){var B=microstrategy.styleObj;if(B.getAttValue(this.elem.parentNode,microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE)=="0"){var C=B.getValue(this.elem.parentNode,"backgroundColor");if(C=="transparent"||C=="#FFFFFF"){this.styleHelper.bgSelectedColor=(A!="transparent")?A:null;}else{this.styleHelper.bgSelectedColor=null;}}else{this.styleHelper.bgSelectedColor=(A!="transparent")?A:null;}this.styleHelper.onload();}};mstrRWControlImpl.prototype.newSelections=function(){this.selections=new Object();this.isAllSelected=false;};mstrRWControlImpl.prototype.fixPercentConstants=function(E){var D=E.split(mstrRWMetricQualificationStyleHelper.ITEM_SEPARATOR),A,C=[],B,F=microstrategy.number;for(B in D){A=D[B];if(!/%$/.test(A)){A=F.toString(A,true);A=parseFloat(A);A=A/100;A=F.toLocaleString(A);}C.push(A);}return C.join(mstrRWMetricQualificationStyleHelper.ITEM_SEPARATOR);};mstrRWControlImpl.prototype.exec=function(F,J){try{switch(F){case"setExpression":if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_METRIC_QUALIFICATION){var L="",M="",N=this.styleHelper.numOfInputs();if(N>0){L=this.mcInput.value;if(this.funcType==mstr.Enum.Nodes.FUNCTIONTYPE.RANKPERCENT){L=this.fixPercentConstants(L);}if(N==2){M=this.mcInput2.value;if(this.funcType==mstr.Enum.Nodes.FUNCTIONTYPE.RANKPERCENT){M=this.fixPercentConstants(M);}L+=mstrRWMetricQualificationStyleHelper.ITEM_SEPARATOR+M;}}L=L.replace(/;/g,mstrRWMetricQualificationStyleHelper.EVENT_ITEM_SEPARATOR);this.consts=L;this.onExpressionChanged();}else{if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER){var T=mstr.Enum.Nodes.FUNCTION;switch(this.funcType){case 1:if(J!=null){var S=microstrategy.number,K=J.split("|"),H=K[1]=="unset",G=K[0]=="unset",P=S.toString(K[0],true),R=S.toString(K[1],true);if(H){this.consts=S.toLocaleString(P);this.func=this.include?T.GREATERTHANEQUALS:T.LESSTHAN;}else{if(G){this.consts=S.toLocaleString(R);this.func=this.include?T.LESSTHANEQUALS:T.GREATERTHAN;}else{if(R==P){this.consts=S.toLocaleString(P);this.func=this.include?T.EQUALS:T.NOTEQUALS;}else{this.consts=S.toLocaleString(Math.min(P,R))+mstrRWMetricQualificationStyleHelper.EVENT_ITEM_SEPARATOR+S.toLocaleString(Math.max(P,R));this.func=this.include?T.BETWEEN:T.NOTBETWEEN;}}}}else{this.consts=null;this.func=this.include?T.BETWEEN:T.NOTBETWEEN;}break;case 3:if(J!=null){J=J.split("|");J[0]+="%";J[1]+="%";J=J.join("|");}case 2:if(J!=null){var K=J.split("|"),H=K[1].replace("%","")=="unset",G=K[0].replace("%","")=="unset",O=this.asc?"ASCENDING":"DESCENDING",A;if(H){this.consts=K[0];func=this.include?"GREATERTHANEQUALS":"LESSTHAN";}else{if(G){this.consts=K[1];func=this.include?"LESSTHANEQUALS":"GREATERTHAN";}else{if(K[0]==K[1]){this.consts=K[0];func=this.include?"EQUALS":"DIFFERENTFROM";}else{this.consts=K.join(mstrRWMetricQualificationStyleHelper.EVENT_ITEM_SEPARATOR);func=this.include?"BETWEEN":"NOTBETWEEN";}}}A=func+O;this.func=mstr.Enum.Nodes.MRPFUNCTION[A];}}this.onExpressionChanged();}}break;case"setElements_horizontal":case"setElements_vertical":info=J.split("|");var U=microstrategy.bone(this.id+"_scr_0");if(U){var C=parseInt(info[0]);var B=parseInt(info[1]);this.newSelections();if((this.showAll||!this.multiSelect)&&C==1&&B==U.maxUnits){this.selections[mstrRWControlImpl.OPTION_ALL]=mstrRWControlImpl.OPTION_ALL;}else{var E=U.dataValues;for(var Q=C;Q<=B;Q++){this.selections[E[Q-1]]=E[Q-1];}}this.onSelectionChanged();for(var Q=0;Q<this.sibElems.length;Q++){var I=microstrategy.bone(this.id+"_scr_"+Q);if(I&&I.positionScroller){I.positionScroller(C,B);}}}break;}}catch(D){microstrategy.errors.log(D);return false;}};mstrRWControlImpl.prototype.swapFunction=function(){if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER){var C=mstr.Enum.Nodes.FUNCTION,A=mstr.Enum.Nodes.MRPFUNCTION,D=this.funcType,B=this.func;switch(D){case 1:switch(B){case C.EQUALS:this.func=C.NOTEQUALS;break;case C.NOTEQUALS:this.func=C.EQUALS;break;case C.GREATERTHAN:this.func=C.LESSTHANEQUALS;break;case C.GREATERTHANEQUALS:this.func=C.LESSTHAN;break;case C.LESSTHAN:this.func=C.GREATERTHANEQUALS;break;case C.LESSTHANEQUALS:this.func=C.GREATERTHAN;break;case C.BETWEEN:this.func=C.NOTBETWEEN;break;case C.NOTBETWEEN:this.func=C.BETWEEN;break;case C.ISNULL:this.func=C.ISNOTNULL;break;case C.ISNOTNULL:this.func=C.ISNULL;break;case C.IN:this.func=C.NOTIN;break;case C.NOTIN:this.func=C.IN;break;}break;case 3:case 2:switch(B){case A.TOP:this.func=A.BOTTOM;break;case A.BOTTOM:this.func=A.TOP;break;case A.BETWEEN:this.func=A.NOTBETWEEN;break;case A.EXCLUDETOP:this.func=A.EXCLUDEBOTTOM;break;case A.EXCLUDEBOTTOM:this.func=A.EXCLUDETOP;break;case A.NOTBETWEEN:this.func=A.BETWEEN;break;case A.EQUALS:this.func=A.NOTEQUALS;break;case A.DIFFERENTFROM:this.func=A.DIFFERENTFROM;break;case A.EQUALSDESCENDING:this.func=A.NOTEQUALSDESCENDING;break;case A.NOTEQUALSDESCENDING:this.func=A.EQUALSDESCENDING;break;case A.GREATERTHANDESCENDING:this.func=A.LESSTHANEQUALSDESCENDING;break;case A.GREATERTHANEQUALSDESCENDING:this.func=A.LESSTHANDESCENDING;break;case A.LESSTHANDESCENDING:this.func=A.GREATERTHANEQUALSDESCENDING;break;case A.LESSTHANEQUALSDESCENDING:this.func=A.GREATERTHANDESCENDING;break;case A.BETWEENDESCENDING:this.func=A.NOTBETWEENDESCENDING;break;case A.NOTBETWEENDESCENDING:this.func=A.BETWEENDESCENDING;break;case A.INDESCENDING:this.func=A.NOTINDESCENDING;break;case A.NOTINDESCENDING:this.func=A.INDESCENDING;break;case A.EQUALSASCENDING:this.func=A.NOTEQUALSASCENDING;break;case A.NOTEQUALSASCENDING:this.func=A.EQUALSASCENDING;break;case A.GREATERTHANASCENDING:this.func=A.LESSTHANEQUALSASCENDING;break;case A.GREATERTHANEQUALSASCENDING:this.func=A.LESSTHANASCENDING;break;case A.LESSTHANASCENDING:this.func=A.GREATERTHANEQUALSASCENDING;break;case A.LESSTHANEQUALSASCENDING:this.func=A.GREATERTHANASCENDING;break;case A.BETWEENASCENDING:this.func=A.NOTBETWEENASCENDING;break;case A.NOTBETWEENASCENDING:this.func=A.BETWEENASCENDING;break;case A.INASCENDING:this.func=A.NOTINASCENDING;break;case A.NOTINASCENDING:this.func=A.INASCENDING;break;}break;}}};mstrRWControlImpl.prototype.onExpressionChanged=function(){try{var B=[],G=[],F=this.func;ctdt=this.ctlDataType;dt=(Number(this.mct)==0&&(ctdt==14||ctdt==15||ctdt==16))?ctdt:5;if(F!=mstr.Enum.Nodes.FUNCTION.ISNOTNULL&&F!=mstr.Enum.Nodes.FUNCTION.ISNULL&&this.consts!=null){B=["2048221","2048222"];G=[this.consts,dt];}B=B.concat(["2048138"]);G=G.concat(["1"]);var H=this.applyNow()?"1":"0";var A=microstrategy.bone("pbb_GroupByStyle");var D=A&&A.hasAllSelected?"0":"1";var C=this.updateManager;C.add([C.createActionObject(null,mstrUpdateManager.CTRL_SET_EXPRESSION,this.getDocViewer().beanPath,["2048001","2048009","2048130","2048220","2048223","2048018","2048138"].concat(B),[this.ctlSrcId,this.ctlSrcType,this.ctlKey,this.func,this.funcType,H,D].concat(G),[])]);if(this.applyNow()){microstrategy.bone(this.getDocViewer().id).commands.exec("setUnsetFalse",this.RWUnitId);C.flushAndSubmitChanges();}}catch(E){microstrategy.errors.log(E);}};mstrRWControlImpl.prototype.cascadeFormatting=function(A,C,B){this.styleHelper.cascadeFormatting(A,C,B);};mstrRWControlImpl.prototype.initDefaultFormats=function(A){if(this.styleHelper.initDefaultFormats(A)){var B=this.getDocViewer().observer;if(B){B.notifyAll("onselectionchange");}}};mstrRWControlImpl.prototype.getItemFormats=function(){try{return this.itemFormats;}catch(A){microstrategy.errors.log(A);return false;}};mstrRWControlImpl.prototype.getAttValue=function(C,A){try{if(C==mstrRWControlImpl.FMT_TYPE_TITLE){if(this.titleBar){var D=microstrategy.styleObj.formattingAttributes[this.titleBar.getAttribute("id")];if(D!=null&&typeof (D[A])!="undefined"){return D[A];}return this.titleBar.getAttribute(A,0);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWControlImpl.prototype.setAttValue=function(D,A,C){try{this.itemFormats[D][A]=C;if(D==mstrRWControlImpl.FMT_TYPE_TITLE){if(this.titleBar){var F=this.titleBar.getAttribute("id");var E=microstrategy.styleObj.formattingAttributes[F];if(typeof (E)=="undefined"){microstrategy.styleObj.formattingAttributes[F]=new Object();microstrategy.styleObj.formattingAttributes[F][A]=C;}else{E[A]=C;}microstrategy.styleObj.formattingAttributes[this.id.split("_")[0]][(A=="ht"?"wth":A)]=C;this.titleBar.style[mstrRWControlImpl.heightAndWidthAttMap[A]]=mstrFormatObject.decodeValue(mstrRWControlImpl.heightAndWidthAttMap[A],C);}}}catch(B){microstrategy.errors.log(B);}};mstrRWControlImpl.prototype.getFormatValue=function(B,C){try{if(B==2){B=mstrRWControlImpl.FMT_TYPE_TITLE;}if(C=="gradientcolor"&&B==mstrRWControlImpl.FMT_TYPE_TITLE){if(this.titleBar){return this.titleBar.getAttribute(C);}return null;}if(this.itemFormats[B]){return this.itemFormats[B][C];}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrRWControlImpl.prototype.setFormatValue=function(D,E,C){try{this.itemFormats[D][E]=C;if(D==mstrRWControlImpl.FMT_TYPE_TITLE){if(E=="Gradient"){return ;}if(this.titleBar){var A=this.titleBar;if(E.indexOf("textDecoration")>-1||E.indexOf("textAlign")>-1){A=microstrategy.findChildWithAtt(A,"div",microstrategy.HTMLATTR_ID,"titleBar");}this.getDocViewer().doc.styleObj.formatElem(A,E,C);if(E&&E.toLowerCase()=="backgroundcolor"){this.titleBar.setAttribute("bgstyle",(C=="transparent")?1:0);if(this.titleBar.getAttribute("gradientcolor")){this.titleBar.removeAttribute("gradientcolor");}}}}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWControlImpl.prototype.setStyle=function(C,A,E){try{if(this.ctlStyle==C&&this.ctlOrientation==A&&this.multiSelect==E){return ;}var B=this.ctlStyle!=C||this.ctlStyle==mstrRWControlImpl.CTL_STYLE_SCROLLER||(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY&&this.ctlOrientation!=A);this.ctlStyle=C;this.ctlOrientation=A;this.multiSelect=E;this.createStyleHelper();this.initDefaultFormats(null);if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&B){this.renderPreview();}}catch(D){microstrategy.errors.log(D);return false;}};mstrRWControlImpl.prototype.renderPreview=function(){try{if(this.styleHelper){var C=this.elem;C.innerHTML="";var A="";if(this.ctlType==mstrRWControlImpl.CTL_TYPE_ATTR_LIST){A=this.replaceAttName?this.replaceAttName:this.getDefaultSourceDisplay(this.ctlType);}else{A=this.ctlSrcName?this.ctlSrcName:this.getDefaultSourceDisplay(this.ctlType);}this.styleHelper.renderPreview(C,A);this.addSelectorMask(C,A);this.updateDisplayText();}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWControlImpl.prototype.addSelectorMask=function(B,A){var C=document.createElement("img");C.style.position="absolute";C.style.top="0";C.style.left="0";C.style.zindex="10";C.style.height="100%";C.style.width="100%";C.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";B.appendChild(C);};mstrRWControlImpl.prototype.onRemovePanel=function(D,B,A){try{if(this.ctlType!=mstrRWControlImpl.CTL_TYPE_PANEL_STACK){return false;}if(this.targetKeys[0]!=D){return false;}if(!this.styleHelper){return false;}this.styleHelper.removeElement("v"+B+";");this.newSelections();this.styleHelper.select("v"+A+";");}catch(C){microstrategy.errors.log(C);return false;}};mstrRWControlImpl.prototype.onredo=function(B){try{this.undoredo(B);}catch(A){microstrategy.errors.log(A);}};mstrRWControlImpl.prototype.onundo=function(B){try{this.undoredo(B);}catch(A){microstrategy.errors.log(A);}};mstrRWControlImpl.prototype.undoredo=function(E){try{var F=E.id;if(E.elem&&E.elem.getAttribute&&E.elem.getAttribute("id")==this.RWUnitId){switch(F){case mstrUpdateManager.EDIT_PROPS:var B=E.args;if(B.length<2){break;}var A=B[1].split(mstrUpdateManager.UNIT_SEPARATOR),G=A[1]&&A[2]&&mstrFormatObject[A[1]]&&mstrFormatObject[A[1]][A[2]]&&mstrFormatObject[A[1]][A[2]][mstrFormatObject.HTML_PROP_NAME],D=A[3];if(D!==undefined){D=(D.substr(D.length-1)==mstrUpdateManager.ITEM_SEPARATOR)?D.substr(0,D.length-1):D;D=mstrFormatObject.decodeValue(G,D);}if(A[1]=="FormattingView"){switch(G){case"showTitleBar":this.isTitleVisible=D==microstrategy.TRUE;this.toggleTitleBars();break;}}break;}}}catch(C){microstrategy.errors.log(C);}};mstrRWControlImpl.prototype.onSelectionChanged=function(){try{if(this.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){var R=this.targetKeys[0];var D=microstrategy.findBone(document.getElementById(R));if(D!=null){var M="";for(var Q in this.selections){M=Q;break;}D.setCurrentPanel(M.substring(1,M.length-1),true);D.updateIconStatus(D.titleBars[0],D.getCurrentPanel().elem);}}else{this.isAllSelected=this.selections[mstrRWControlImpl.OPTION_ALL]!=null;var N="";for(var Q in this.selections){if(N.length>0){N+=CLIPBOARD_ITEM_SEPARATOR;}N+=Q;}if(N.length==0&&this.ctlType==mstrRWControlImpl.CTL_TYPE_METRIC_LIST){return ;}var E=this.updateManager;if(E){var K="";var L;for(var Q in this.targetKeys){if(mstrDocImpl.shallRenderTarget(this.targetKeys[Q])||this.ctlTargetType){if(K.length>0){K+=CLIPBOARD_ITEM_SEPARATOR;}K+=this.targetKeys[Q];}}if(this.extraKeys){for(var Q in this.extraKeys){K+=CLIPBOARD_ITEM_SEPARATOR;K+=this.extraKeys[Q];}}var G=this.applyNow()&&K?"1":"0";var A=microstrategy.bone("pbb_GroupByStyle");var O=((A&&A.hasAllSelected)||this.ctlTargetType==mstrRWControlImpl.CTL_TARGET_TYPE_DATASET)?"0":"1";E.add([E.createActionObject(null,mstrUpdateManager.SET_CUR_CTL_ELEMENTS,this.getDocViewer().beanPath,["2048130","2048127","2048137","2048138","2048224","2048018","2048260"],[this.ctlKey,N,this.unitKeyContext,O,this.include,G,this.ctlTargetType],[])]);if(this.applyNow()){if(K){microstrategy.bone(this.getDocViewer().id).commands.exec("setUnsetFalse",this.RWUnitId);E.flushAndSubmitChanges();}}else{var J=microstrategy.bones.controlSubmitButton;if(J){var C=J.elem;var P=this.elem.parentNode;var I=getObjSumLeft(P)+getObjWidth(P)+1;var F=I+getObjWidth(C);if(F>getClientWidth()){I-=(F-getClientWidth());}if(I<0){I=0;}var H=getObjSumTopScrolled(P)-5;if(H<0){H=0;}C.style.left=I+"px";C.style.top=H+"px";showMessage({contents:"",elements:microstrategy.OK_BUTTON,okEval:"(function(){microstrategy.bone('"+this.getDocViewer().id+"').commands.exec('setUnsetFalse','"+this.RWUnitId+"'); microstrategy.bone('"+this.getDocViewer().id+"').commands.exec('doFlush');})();",type:mstrMsgBoxImpl.MSG_WARNING,messageBoxID:"controlSubmitButton",positionInMiddle:false});}}}}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWControlImpl.prototype.applyNow=function(A){return this.getDocViewer().ctlAutoSubmit;};mstrRWControlImpl.prototype.onwinresize=function(){if(this.mask){this.mask.onmaskedobjectresize();}};mstrRWControlImpl.prototype.setType=function(B,A){try{if(this.ctlType!=B){this.ctlType=B;var D=this.getDefaultSourceDisplay(B);this.changeSourceText(D);A.push(this.updateManager.createActionObject(this.elem,mstrUpdateManager.CTRL_SET_TYPE,this.getDocViewer().beanPath,["2048130","2048113"],[this.ctlKey,B],[]));}return A;}catch(C){microstrategy.errors.log(C);return ac;}};mstrRWControlImpl.prototype.setTargetType=function(A){if(this.ctlTargetType!=A){this.ctlTargetType=A;}};mstrRWControlImpl.prototype.getDefaultSourceDisplay=function(A){var B="Element";switch(A){case"1":B=microstrategy.descriptors.getDescriptor("4778");break;case"2":B=microstrategy.descriptors.getDescriptor("517");break;case"3":B=microstrategy.descriptors.getDescriptor("4780");break;case"8":B=microstrategy.descriptors.getDescriptor("518");break;default:B=microstrategy.descriptors.getDescriptor("4778");break;}return B;};mstrRWControlImpl.prototype.setSource=function(A,E,D,C){try{this.ctlSrcId=A;this.ctlSrcType=E;this.ctlSrcName=D;this.setType(mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST,C);this.changeSourceText(D);if(C){C.push(this.updateManager.createActionObject(this.elem,mstrUpdateManager.CTRL_SET_SOURCE,this.getDocViewer().beanPath,["2048130","2048114","2048115"],[this.ctlKey,A,E],[]));}return C;}catch(B){microstrategy.errors.log(B);return C;}};mstrRWControlImpl.prototype.setReplaceAtt=function(A,E,B,D){try{this.replaceAttId=A;this.replaceAttType=E;this.replaceAttName=B;this.setType(mstrRWControlImpl.CTL_TYPE_ATTR_LIST,D);this.changeSourceText(B?B:this.getDefaultSourceDisplay(this.ctlType));if(D){D.push(this.updateManager.createActionObject(this.elem,mstrUpdateManager.CTRL_SET_SOURCE,this.getDocViewer().beanPath,["2048130","2048114","2048115"],[this.ctlKey,A,E],[]));}return D;}catch(C){microstrategy.errors.log(C);return D;}};mstrRWControlImpl.prototype.clearSource=function(){this.ctlSrcId="";this.ctlSrcType="";this.ctlSrcName="";};mstrRWControlImpl.prototype.clearReplaceAtt=function(){this.replaceAttId="";this.replaceAttType="";this.replaceAttName="";this.candidateAtts="";};mstrRWControlImpl.prototype.isDefinitionComplete=function(){return this.targetKeys&&(this.ctlType!=mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST||(this.ctlSrcId&&this.ctlSrcType));};mstrRWControlImpl.prototype.changeSourceText=function(B){try{var D=null;if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&this.isDefinitionComplete()){return ;}switch(this.ctlStyle){case mstrRWControlImpl.CTL_STYLE_POOL_DOWN:case mstrRWControlImpl.CTL_STYLE_LIST_BOX:case mstrRWControlImpl.CTL_STYLE_SEARCH_BOX:case mstrRWControlImpl.CTL_STYLE_ATTR_QUALIFICATION:D=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SECTION_NAME,"itemList");break;case mstrRWControlImpl.CTL_STYLE_RADIO_BUTTON:case mstrRWControlImpl.CTL_STYLE_CHECKBOX:D=microstrategy.findChildrenWithAtt(this.elem,"label",microstrategy.HTMLATTR_SECTION_NAME,"itemList");break;case mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY:this.elem.getElementsByTagName("input")[0].value=B+"-1";break;case mstrRWControlImpl.CTL_STYLE_LINK_ARRAY:D=this.elem.getElementsByTagName("td");if((!D)||D.length==0){D=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SECTION_NAME,"itemList");}break;case mstrRWControlImpl.CTL_STYLE_SCROLLER:break;case mstrRWControlImpl.CTL_STYLE_METRIC_QUALIFICATION:case mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER:break;default:alert("Invalid Style, Orientation selection");break;}if(D){for(var A=0;A<D.length;A++){D[A].innerHTML=B+"-"+A;}}}catch(C){microstrategy.errors.log(C);return false;}};mstrRWControlImpl.prototype.updateDisplayText=function(){if(this.ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION){var A=this.dpTxt;if(!A){if(this.ast==8){A=microstrategy.descriptors.getDescriptor(5369);}else{if(this.ast==4){A=microstrategy.descriptors.getDescriptor(8233);}else{if(this.ast==16){A=microstrategy.descriptors.getDescriptor(8232);}}}}if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY){this.elem.getElementsByTagName("input")[0].value=A;}else{if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_LINK_ARRAY){var B=this.elem.getElementsByTagName("td");if(!B||B.length==0){B=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SECTION_NAME,"itemList");}if(B&&B.length>0){B[0].innerHTML=A;}}}}};mstrRWControlImpl.prototype.onboneafterresize=function(B){try{mstrRWUnitBoneImpl.prototype.onboneafterresize.call(this,B);this.synchronizeShadow();}catch(A){microstrategy.errors.log(A);return false;}};mstrRWControlImpl.prototype.setDelimiter=function(B,D){this.formDelimiter=B;var C=["2048137","2048245"],A=[this.unitKeyContext||this.ctlKey,this.encodeSpace(B)];D.push(this.updateManager.createActionObject(null,mstrUpdateManager.SET_CTL_FORM_DELIMITER,this.getDocViewer().beanPath,C,A,[]));};mstrRWControlImpl.prototype.encodeSpace=function(A){return A.replace(/ /g,"SPACE");};mstrRWControlImpl.prototype.setDisplayFormType=function(A,D){this.displayFormType=A;var C=["2048137","2048244"],B=[this.unitKeyContext||this.ctlKey,A];D.push(this.updateManager.createActionObject(null,mstrUpdateManager.SET_CTL_FORM_DISPLAY_TYPE,this.getDocViewer().beanPath,C,B,[]));};mstrRWControlImpl.prototype.setAttrForms=function(G,I){this.attrForms=G;var B="",E=G.length,A,C=mstrRWControlImpl.EVENT_SEPARATOR;for(var D=0;D<E;D++){A=G[D].dssid.split("|")[0];B+=A+C;}var F=["2048137","2048243"],H=[this.unitKeyContext||this.ctlKey,B];I.push(this.updateManager.createActionObject(null,mstrUpdateManager.SET_CTL_FORMS,this.getDocViewer().beanPath,F,H,[]));};mstrRWControlImpl.prototype.setSortAttrForm=function(F,K){this.sortAttrForm=F.form;this.sortType=F.type||1;var A=this.sortAttrForm,B="",J=A.attr.split("|")[0],D=A.attr.split("|")[1],E=mstrRWControlImpl.EVENT_SEPARATOR,G="2"+E+"1"+E+J+E+D+E+B,C=(A.dssid===1);if(!C){B=A.dssid.split("|")[0];}var G=(C?"3":"2")+E+"1"+E+J+E+D+E+B,H=["2048130","2048137","2048045","2048047","2048246"],I=[this.ctlKey,this.unitKeyContext||this.ctlKey,this.sortType,1,G];K.push(this.updateManager.createActionObject(null,mstrUpdateManager.SET_CTL_SORTS,this.getDocViewer().beanPath,H,I,[]));};function mstrRWControlImpl(A){this.inherits=mstrRWUnitBoneImpl;this.inherits(A);this.inherits=null;this.selections=new Object();return this;}mstrRWCtlStyleHelper.prototype=new Object();mstrRWCtlStyleHelper.prototype.ctlBone=null;mstrRWCtlStyleHelper.prototype.boneStr=function(){return"microstrategy.bone('"+this.ctlBone.id+"')";};mstrRWCtlStyleHelper.prototype.addRadioCheckboxSelector=function(A,B,D){try{var J=A.appendChild(document.createElement("table"));J.setAttribute("width","100%");J.setAttribute("height","100%");J.border=0;J.cellSpacing=0;J.cellPadding=0;var I=J.insertRow(J.rows.length);for(var G=0;G<1;G++){var C=I.insertCell(I.cells.length);C.setAttribute("vAlign","top");C.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");C.setAttribute("nowrap","true");var H=document.createElement("input");H.setAttribute("type",B);H.value=G;C.appendChild(H);var F=C.appendChild(document.createElement("label"));F.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");F.style.whiteSpace="nowrap";F.appendChild(document.createTextNode(D+"-"+G));}}catch(E){microstrategy.errors.log(E);return false;}};mstrRWCtlStyleHelper.prototype.adjustHeight=function(F,E,D,A){var G=microstrategy.findAncestorWithAtt(F,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);if(G){if(this.ctlBone.getDocViewer()){var C=this.ctlBone.getDocViewer().doc.styleObj;if(C){var B=C.getValue(G,"height");this.applyStyleValue(F,E,"height",B,D,A);}}}};mstrRWCtlStyleHelper.prototype.initDefaultFormats=function(A){return false;};mstrRWCtlStyleHelper.prototype.applyStyleValue=function(C,F,A,H,E,G){try{var I=microstrategy.findChildrenWithAtt(C,F,E,G);if(I){for(var D=0;D<I.length;D++){I[D].style[A]=H;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWCtlStyleHelper.prototype.toggleSelectedCssClass=function(A,C){try{A.className=A.className.replace(/\s?selected/g,"")+(C?" selected":"");}catch(B){microstrategy.errors.log(B);return false;}};function mstrRWCtlStyleHelper(A){this.ctlBone=A;return this;}mstrRWSelectStyleHelper.prototype=new mstrRWCtlStyleHelper();mstrRWSelectStyleHelper.prototype.onload=function(){try{if(this.ctlBone.isInteractive){var H=new Function("e","return "+this.boneStr()+".styleHelper.onSelectionChange(e);");}for(var F=0;F<this.ctlBone.sibElems.length;F++){var E=this.ctlBone.sibElems[F];this.adjustHeight(E,"div","id","insetDiv");if(this.ctlBone.isInteractive){var B=this.getSelect(E);if(B){B.onchange=H;B.style.cursor="pointer";if(F!=0){continue;}var A=B.options;if(!A){continue;}var D;for(var C=0;C<A.length;C++){D=A[C];if(D.selected){this.ctlBone.selections[D.value]=D.value;}}}}}}catch(G){microstrategy.errors.log(G);return false;}};mstrRWSelectStyleHelper.prototype.applyStyleValue=function(E,G,F,C,A,B){var D=mstrRWCtlStyleHelper.prototype.applyStyleValue;D.apply(this,[E,G,F,C,A,B]);D.apply(this,[E,"select",F,C,"id",this.ctlBone.ctlKey+"_S"]);if(F==="color"){this.currentTextColor=C;}};mstrRWSelectStyleHelper.prototype.getSelect=function(B){try{return microstrategy.findChildWithAtt(B,"select","id",this.ctlBone.ctlKey+"_Sl");}catch(A){microstrategy.errors.log(A);return false;}};mstrRWSelectStyleHelper.prototype.select=function(C){try{var A=false;this.ctlBone.newSelections();this.ctlBone.selections[C]=C;this.highlightSelectSiblings(this.ctlBone.sibElems[0],A);this.ctlBone.onSelectionChanged();return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWSelectStyleHelper.prototype.onSelectionChange=function(I){try{if(!I){I=window.event;}var A=getEventTarget(I);if(!A){return ;}var N=A.options;if(!N||N.length===0){return ;}var C=this.ctlBone;var J=C.isAllSelected,H=-1;C.newSelections();var M=false;if(A.multiple){C.selectedIndices=[];var F,L;for(var E=0,G=N.length;E<G;E++){F=N[E];L=F.value;if(F.selected&&L){C.selections[L]=L;if(F.value==mstrRWControlImpl.OPTION_ALL){C.isAllSelected=true;H=E;}C.selectedIndices.push(E);}}if(J&&C.isAllSelected&&N.length>C.selectedIndices.length&&C.selectedIndices.length!==1){C.isAllSelected=false;C.selectedIndices.splice(H,1);N[H].selected=false;delete C.selections[mstrRWControlImpl.OPTION_ALL];}}else{var B=A.options[A.selectedIndex],K=B&&B.value;if(B){C.selections[K]=K;if(A.selectedIndex>0&&A.options[0].getAttribute("dummy")){M=true;}}}this.highlightSelectSiblings(A,J,M);C.onSelectionChanged();return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrRWSelectStyleHelper.prototype.highlightSelectSiblings=function(A,L,N){try{var F="match";var B=this.ctlBone;if(A&&A.multiple){if(B.isAllSelected){F="selectAll";}}for(var H=0;H<B.sibElems.length;H++){var M=B.sibElems[H];var D=this.getSelect(M);var O=D.options;if(N&&O[0]&&O[0].getAttribute("dummy")){D.remove(0);O=D.options;}if(D==A&&F=="match"){continue;}if(bIsIE7&&F=="selectAll"){selectCloned=D.cloneNode(true);selectCloned.onchange=A.onchange;selectCloned.onscroll=A.onscroll;O=selectCloned.options;}var J=false;for(var G=0,K=O.length;G<K;G++){var I=O[G];if(F=="selectAll"){I.selected=true;B.selections[I.value]=I.value;}else{if(F=="unselectAll"){I.selected=false;}else{I.selected=B.selections[I.value]==I.value;J|=B.selections[I.value]==I.value;}}}if(bIsIE7&&F=="selectAll"){A.parentNode.replaceChild(selectCloned,A);window.setTimeout(function(){selectCloned.scrollTop=0;},10);}if(F=="match"&&!J){if(O[0]&&!O[0].getAttribute("dummy")){var C=new Option("","");C.setAttribute("dummy","1");C.setAttribute("selected",true);D.insertBefore(C,D.options[0]);}D.options[0].setAttribute("selected",true);}}}catch(E){microstrategy.errors.log(E);return false;}};mstrRWSelectStyleHelper.prototype.removeElement=function(A){try{for(var G=0;G<this.ctlBone.sibElems.length;G++){var F=this.ctlBone.sibElems[G];var C=this.getSelect(F);var B=C.options;if(B){var E;for(var D=B.length-1;D>=0;D--){E=B[D];if(E.value==A){C.remove(D);}}}}}catch(H){microstrategy.errors.log(H);return false;}};mstrRWSelectStyleHelper.prototype.cascadeFormatting=function(C,F,E){try{if(F!="backgroundColor"){var B=C.getElementsByTagName("select");for(var A=0;A<B.length;A++){B[A].style[F]=E;}}}catch(D){microstrategy.errors.log(D);return false;}};function mstrRWSelectStyleHelper(A){this.inherits=mstrRWCtlStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWListBoxStyleHelper.prototype=new mstrRWSelectStyleHelper();mstrRWListBoxStyleHelper.prototype.onload=function(){try{var ctlBone=this.ctlBone;if(ctlBone.isInteractive&&!ctlBone.include&&!mstr.utils.ISFF){var cssClass=" strikeout "+(bIsIE7?"ie":"");ctlBone.elem.className=ctlBone.elem.className.replace(cssClass,"")+(ctlBone.include?"":cssClass);var elStrikeoutContainer=(this.elStrikeoutContainer=microstrategy.findChildWithAtt(ctlBone.elem,"div",mstr.utils.ISIE7?"className":"class","strikeoutContainer")),elSelect=this.getSelect(ctlBone.elem);if(elStrikeoutContainer&&elSelect&&elSelect.multiple){mstrRWListBoxStyleHelper.OH=mstr.utils.ISWK?17:(mstr.utils.ISIE9||mstr.utils.ISIE10?16.09:(mstr.utils.ISIE8?16:16.005));var fnSyncScroll=function(){elStrikeoutContainer.style.top=-(elSelect.scrollTop+mstrRWListBoxStyleHelper.OH/2)+"px";};elSelect.onscroll=fnSyncScroll;if(ctlBone.selectedIndices){ctlBone.selectedIndices=eval(ctlBone.selectedIndices);}else{ctlBone.selectedIndices=[];if(bIsIE7){var ops=elSelect.options;for(var i=0,len=ops.length;i<len;i++){if(ops[i].selected){ctlBone.selectedIndices.push(i);}}}else{ctlBone.selectedIndices=mstr.$A.findMultiple(elSelect.options,elSelect.selectedOptions).indices;}}this.toggleStrikeoutDiv(ctlBone.selectedIndices,true);fnSyncScroll();}}mstrRWSelectStyleHelper.prototype.onload.call(this);}catch(err){microstrategy.errors.log(err);}};mstrRWListBoxStyleHelper.prototype.onSelectionChange=function(B){try{this.toggleStrikeoutDiv(this.ctlBone.selectedIndices,false);mstrRWSelectStyleHelper.prototype.onSelectionChange.call(this,B);this.toggleStrikeoutDiv(this.ctlBone.selectedIndices,true);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrRWListBoxStyleHelper.prototype.renderPreview=function(E,B){try{var D=document.createElement("div");D.className="controlListboxInset1";D.id="insetDiv";var A=document.createElement("div");A.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");A.appendChild(document.createTextNode(B+"-"+0));D.appendChild(A);E.appendChild(D);this.adjustHeight(E,"div",microstrategy.HTMLATTR_SECTION_NAME,"itemList");}catch(C){microstrategy.errors.log(C);return false;}};mstrRWListBoxStyleHelper.prototype.cascadeFormatting=function(B,E,D){try{if(E=="height"){var A=this.ctlBone.titleBar;D=(parseFloat(D)-((A&&A.offsetHeight)||0))+"px";}mstrRWSelectStyleHelper.prototype.cascadeFormatting.call(this,B,E,D);if(E!="backgroundColor"){this.applyStyleValue(B,"div",E,D,microstrategy.HTMLATTR_SECTION_NAME,"itemList");}}catch(C){microstrategy.errors.log(C);return false;}};mstrRWListBoxStyleHelper.prototype.toggleStrikeoutDiv=function(I,F){try{var A=!this.ctlBone.include&&this.elStrikeoutContainer;if(A&&I){var G=this.elStrikeoutContainer,B=G&&G.childNodes;for(var D=0,E=I.length;D<E;D++){var H=B[I[D]];H.className=H.className.replace(/ selected/g,"")+(F?" selected":"");H.style.top=(I[D]+1)*mstrRWListBoxStyleHelper.OH+"px";}}}catch(C){microstrategy.errors.log(C);}};function mstrRWListBoxStyleHelper(A){this.inherits=mstrRWSelectStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWPoolDownStyleHelper.prototype=new mstrRWSelectStyleHelper();mstrRWPoolDownStyleHelper.prototype.onload=function(){try{mstrRWSelectStyleHelper.prototype.onload.call(this);}catch(A){microstrategy.errors.log(A);return false;}};mstrRWPoolDownStyleHelper.prototype.renderPreview=function(A,C){try{var J=this.ctlBone.getFormatValue(microstrategy.FORMAT_TYPE_MAIN,"heightMode");if(J==="2"){A.parentElement.style.height="auto";}var G=document.createElement("table");G.cellSpacing=0;G.cellPadding=0;G.className="controlPulldownTable";var F=G.insertRow(G.rows.length);F.className="controlPulldown";var B=F.insertCell(F.cells.length);B.className="controlPulldownOptionCell";var H=document.createElement("div");H.className="controlPulldownOption";var K=document.createElement("div");K.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");K.className="controlPulldownOptionInset";K.appendChild(document.createTextNode(C+"-"+0));H.appendChild(K);B.appendChild(H);B=F.insertCell(F.cells.length);B.className="controlPulldownButtonCell";var I=document.createElement("div");I.className="controlPulldownButton";var L=document.createElement("div");L.className="controlPulldownButtonInset";var E=document.createElement("img");E.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";L.appendChild(E);I.appendChild(L);B.appendChild(I);A.appendChild(G);}catch(D){microstrategy.errors.log(D);return false;}};mstrRWPoolDownStyleHelper.prototype.cascadeFormatting=function(A,D,C){try{mstrRWSelectStyleHelper.prototype.cascadeFormatting.call(this,A,D,C);if(D!="width"&&D!="height"&&D!="backgroundColor"){this.applyStyleValue(A,"div",D,C,microstrategy.HTMLATTR_SECTION_NAME,"itemList");}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWPoolDownStyleHelper.prototype.adjustHeight=function(D,C,B,A){};function mstrRWPoolDownStyleHelper(A){this.inherits=mstrRWSelectStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWMultiTagStyleHelper.prototype=new mstrRWCtlStyleHelper();mstrRWMultiTagStyleHelper.SELECT=1;mstrRWMultiTagStyleHelper.UNSELECT=2;mstrRWMultiTagStyleHelper.HIGHLIGHT=3;mstrRWMultiTagStyleHelper.UNHIGHLIGHT=4;mstrRWMultiTagStyleHelper.prototype.doRebuild=true;mstrRWMultiTagStyleHelper.prototype.onload=function(){try{if(this.ctlBone.isInteractive){var H=this.getEventHandlers();}for(var C=0;C<this.ctlBone.sibElems.length;C++){var E=this.ctlBone.sibElems[C];var B=this.getOptions(E);if(!B){break;}this.adjustHeight(E,"input",microstrategy.HTMLATTR_ORIENTATION,"1");if(this.ctlBone.ctlOrientation==mstrRWControlImpl.ORIENTATION_HORIZONTAL&&this.ctlBone.itemWidthMode=="1"){this.adjustColWidths(E);}if(this.ctlBone.isInteractive){for(var A=0;A<B.length;A++){var D=B[A];if(this.isSelected(D)){var G=this.getValue(D);this.ctlBone.selections[G]=G;}D.style.cursor="pointer";this.initOption(D,H);}}}}catch(F){microstrategy.errors.log(F);return false;}};mstrRWMultiTagStyleHelper.prototype.initOption=function(B,D){try{for(var A in D){B[A]=D[A];}}catch(C){microstrategy.errors.log(C);return false;}};mstrRWMultiTagStyleHelper.prototype.reHighlight=function(D){try{if(!this.ctlBone.isInteractive){return ;}this.initHighlighting();var B=this.getOptions(D);if(!B){return ;}for(var A=0;A<B.length;A++){var C=B[A];if(this.isSelected(C)){this.highlightOption(C,mstrRWMultiTagStyleHelper.SELECT);}else{this.highlightOption(C,mstrRWMultiTagStyleHelper.UNSELECT);}}}catch(E){microstrategy.errors.log(E);return false;}};mstrRWMultiTagStyleHelper.prototype.initHighlighting=function(){};mstrRWMultiTagStyleHelper.prototype.onSingleSelectChange=function(C){try{if(!C){C=window.event;}C.cancelBubble=true;var E=getEventTarget(C);var D=this.getValue(E);if(!this.ctlBone.selections[D]){if(E){for(var A in this.ctlBone.selections){this.unselect(A);}this.doRebuild=false;this.select(D);this.ctlBone.onSelectionChanged();}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWMultiTagStyleHelper.prototype.onMultiSelectChange=function(B){try{if(!B){B=window.event;}B.cancelBubble=true;var D=getEventTarget(B);if(D){this.doRebuild=true;var C=D.id;if(this.isSelected(D)){this.unselect(this.getValue(D));}else{this.select(this.getValue(D));}this.ctlBone.onSelectionChanged();}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrRWMultiTagStyleHelper.prototype.select=function(K){try{var B=this.ctlBone,A=false,J=B.isAllSelected;if(J&&!B.include){J=B.isAllSelected=false;B.newSelections();}else{if(K==mstrRWControlImpl.OPTION_ALL&&B.multiSelect){B.newSelections();J=B.isAllSelected=true;A=!!B.include;}else{A=!!this.doRebuild;}}if(A){B.selections=[];var D=0,I=B.sibElems,H=I.length;for(;D<H;D++){var M=this.getOptions(I[D]);for(var E=0,G=M.length;E<G;E++){var F=M[E],L=this.getValue(F);if(J||this.isSelected(F)||L===K){B.selections[L]=L;}}}}else{B.selections[K]=K;}this.highlightSiblings();}catch(C){microstrategy.errors.log(C);return false;}};mstrRWMultiTagStyleHelper.prototype.unselect=function(B){try{this.ctlBone.isAllSelected=false;if(B==mstrRWControlImpl.OPTION_ALL&&this.ctlBone.multiSelect){this.ctlBone.newSelections();}else{delete this.ctlBone.selections[B];if(this.ctlBone.selections[mstrRWControlImpl.OPTION_ALL]!=null&&this.ctlBone.multiSelect){delete this.ctlBone.selections[mstrRWControlImpl.OPTION_ALL];}}this.highlightSiblings();}catch(A){microstrategy.errors.log(A);return false;}};mstrRWMultiTagStyleHelper.prototype.highlightSiblings=function(){try{for(var C=0;C<this.ctlBone.sibElems.length;C++){var B=this.getOptions(this.ctlBone.sibElems[C]);if(!B){break;}for(var A=0;A<B.length;A++){var D=B[A];var F;if((this.ctlBone.isAllSelected&&this.ctlBone.include)||this.ctlBone.selections[this.getValue(D)]!=null){F=mstrRWMultiTagStyleHelper.SELECT;}else{F=mstrRWMultiTagStyleHelper.UNSELECT;}this.highlightOption(D,F);}}}catch(E){microstrategy.errors.log(E);return false;}};mstrRWMultiTagStyleHelper.prototype.removeElement=function(D){try{for(var I=0;I<this.ctlBone.sibElems.length;I++){var G=this.ctlBone.sibElems[I];var J=this.getOptions(G);if(J){var E;for(var C=J.length-1;C>=0;C--){E=J[C];if(this.getValue(E)==D){var H=findTargetTag(E,"table");if(this.ctlBone.ctlOrientation==mstrRWControlImpl.ORIENTATION_VERTICAL){H.deleteRow(C);}else{var F=H.getElementsByTagName("col");if(F){var A=F[C];A.parentNode.removeChild(A);}H.rows[0].deleteCell(C);}}}}}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWMultiTagStyleHelper.prototype.adjustColWidths=function(D){var G=D.getElementsByTagName("table");if(G.length>0){var H=G[0];var C=H.getElementsByTagName("col");var E=C.length;var I=util_getColumnWidthsArray(H,E,1,true);var F=0;for(var B=0;B<E;B++){F+=I[B];}var A;if(F!=0){for(var B=0;B<E;B++){A=I[B]*100/F;C[B].style.width=A+"%";}if(mstr.utils.ISSAFARI){H.style.tableLayout="fixed";}}}};function mstrRWMultiTagStyleHelper(A){this.inherits=mstrRWCtlStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWRadioStyleHelper.prototype=new mstrRWMultiTagStyleHelper();mstrRWRadioStyleHelper.prototype.getOptions=function(B){try{return B.getElementsByTagName("input");}catch(A){microstrategy.errors.log(A);return false;}};mstrRWRadioStyleHelper.prototype.getEventHandlers=function(){try{var A=new Object();A.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onSingleSelectChange(e);");return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWRadioStyleHelper.prototype.highlightOption=function(A,C){try{switch(C){case mstrRWMultiTagStyleHelper.SELECT:A.checked=true;break;case mstrRWMultiTagStyleHelper.UNSELECT:A.checked=false;break;}this.toggleSelectedCssClass(A.parentNode,A.checked);}catch(B){microstrategy.errors.log(B);return false;}};mstrRWRadioStyleHelper.prototype.getValue=function(A){try{return A.value;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWRadioStyleHelper.prototype.isSelected=function(A){try{return A.checked;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWRadioStyleHelper.prototype.renderPreview=function(B,A){this.addRadioCheckboxSelector(B,"radio",A);};mstrRWRadioStyleHelper.prototype.cascadeFormatting=function(A,D,C){try{if(D!="width"||mstrStaticDoc.getBone(A).ctlOrientation!=1){this.applyStyleValue(A,"td",D,C,microstrategy.HTMLATTR_SECTION_NAME,"itemList");this.applyStyleValue(A,"label",D,C,microstrategy.HTMLATTR_SECTION_NAME,"itemList");}}catch(B){microstrategy.errors.log(B);return false;}};function mstrRWRadioStyleHelper(A){this.inherits=mstrRWMultiTagStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWCheckStyleHelper.prototype=new mstrRWMultiTagStyleHelper();mstrRWCheckStyleHelper.prototype.getOptions=function(B){try{return B.getElementsByTagName("input");}catch(A){microstrategy.errors.log(A);return false;}};mstrRWCheckStyleHelper.prototype.getEventHandlers=function(){try{var A=new Object();if(this.ctlBone.multiSelect){A.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onMultiSelectChange(e);");}else{A.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onSingleSelectChange(e);");}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWCheckStyleHelper.prototype.onMultiSelectChange=function(B){try{if(!B){B=window.event;}var D=getEventTarget(B);if(D){var C=D.id;if(this.isSelected(D)){this.select(this.getValue(D));}else{this.unselect(this.getValue(D));}this.ctlBone.onSelectionChanged();}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrRWCheckStyleHelper.prototype.highlightOption=function(A,C){try{switch(C){case mstrRWMultiTagStyleHelper.SELECT:A.checked=true;break;case mstrRWMultiTagStyleHelper.UNSELECT:A.checked=false;break;}this.toggleSelectedCssClass(A.parentNode,A.checked);}catch(B){microstrategy.errors.log(B);return false;}};mstrRWCheckStyleHelper.prototype.getValue=function(A){try{return A.value;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWCheckStyleHelper.prototype.isSelected=function(A){try{return A.checked;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWCheckStyleHelper.prototype.renderPreview=function(B,A){this.addRadioCheckboxSelector(B,"checkbox",A);};mstrRWCheckStyleHelper.prototype.cascadeFormatting=function(A,D,C){try{if(!(D=="width"||D=="left"||D=="top")){this.applyStyleValue(A,"td",D,C,microstrategy.HTMLATTR_SECTION_NAME,"itemList");this.applyStyleValue(A,"label",D,C,microstrategy.HTMLATTR_SECTION_NAME,"itemList");}}catch(B){microstrategy.errors.log(B);return false;}};function mstrRWCheckStyleHelper(A){this.inherits=mstrRWMultiTagStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWSearchBoxStyleHelper.prototype=new mstrRWListBoxStyleHelper();mstrRWSearchBoxStyleHelper.prototype.initDefaultFormats=function(I){var A=microstrategy.findAncestorWithAtt(this.ctlBone.elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL),F=[A],G=microstrategy.bone("rwb_viewer").defaultFormats[microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL][microstrategy.FORMAT_TYPE_MAIN]["FormattingFont"],E=[["FontSize",G.Size.defaultValue],["FontFamily",G.Name.defaultValue],["Bold",G.Bold.defaultValue=="-1"],["Italic",G.Italic.defaultValue=="-1"],["Underline",G.Underline.defaultValue=="-1"],["StrikeOut",G.Strikeout.defaultValue=="-1"],["Color",microstrategy.getFormatObject().decodeValue("color",G.Color.defaultValue)]],H=this.ctlBone.getDocViewer().doc,B=H.selections,J=B.controlValueFormat;resetFmt=I?false:true,ac=resetFmt?[]:I;B.controlValueFormat=0;for(var D=0;D<E.length;D++){var C=microstrategy.setSingleFormat(E[D][0],E[D][1]);if("textDecoration"==C[0]){H.formatUnderlineStrikeout(F,C[0],C[1].toString(),ac);}else{H.formatItems(F,C[0],C[1],false,ac);}}B.controlValueFormat=J;if(resetFmt){microstrategy.updateManager.add(ac);}return true;};function mstrRWSearchBoxStyleHelper(A){this.inherits=mstrRWListBoxStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWButtonStyleHelper.prototype=new mstrRWMultiTagStyleHelper();mstrRWButtonStyleHelper.prototype.getOptions=function(B){try{return microstrategy.findChildrenWithAtt(B,"input","type","button");}catch(A){microstrategy.errors.log(A);return false;}};mstrRWButtonStyleHelper.prototype.getEventHandlers=function(){try{var A=new Object();if(this.ctlBone.multiSelect){A.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onMultiSelectChange(e);");}else{A.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onSingleSelectChange(e);");}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWButtonStyleHelper.prototype.highlightOption=function(B,C){try{switch(C){case mstrRWMultiTagStyleHelper.SELECT:B.style.borderStyle="inset";if(mstr.utils.ISIE4){B.style.borderColor="#ece9d8";}break;case mstrRWMultiTagStyleHelper.UNSELECT:B.style.borderStyle="outset";if(mstr.utils.ISIE4){B.style.cssText=B.style.cssText.replace(/border-(left|right|bottom|top)-color\s?:\s?#[a-z0-9]{6}\s?;/gi,"");}break;}this.toggleSelectedCssClass(B,C==mstrRWMultiTagStyleHelper.SELECT);}catch(A){microstrategy.errors.log(A);return false;}};mstrRWButtonStyleHelper.prototype.getValue=function(A){try{return A.id;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWButtonStyleHelper.prototype.isSelected=function(A){try{return A.style.borderStyle.indexOf("inset")>=0;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWButtonStyleHelper.prototype.renderPreview=function(D,B){var A=document.createElement("input");A.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");switch(this.ctlBone.ctlOrientation){case mstrRWControlImpl.ORIENTATION_VERTICAL:A.style.width="100%";break;case mstrRWControlImpl.ORIENTATION_HORIZONTAL:if(D.parentNode){A.style.height=D.parentNode.style.height;}A.setAttribute(microstrategy.HTMLATTR_ORIENTATION,mstrRWControlImpl.ORIENTATION_HORIZONTAL);break;}A.setAttribute("type","button");A.value=B+"-0";var C=document.createElement("div");C.style.textAlign="left";C.appendChild(A);D.appendChild(C);};mstrRWButtonStyleHelper.prototype.initDefaultFormats=function(A){var C=microstrategy.findAncestorWithAtt(this.ctlBone.elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);var B=[C];this.ctlBone.getDocViewer().doc.formatItems(B,"textAlign","center",true,A);return true;};mstrRWButtonStyleHelper.prototype.cascadeFormatting=function(A,D,C){try{if(D=="backgroundColor"){return ;}if(this.cascadeToOptionsRequired(D)){this.applyStyleValue(A,"input",D,C,"type","button");}if(D=="height"){this.adjustHeight(A,"input",microstrategy.HTMLATTR_ORIENTATION,mstrRWControlImpl.ORIENTATION_HORIZONTAL);}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWButtonStyleHelper.prototype.cascadeToOptionsRequired=function(A){return A=="color"||A=="fontFamily"||A=="textDecoration"||A=="fontStyle"||A=="fontWeight"||A=="textAlign"||A=="fontSize";};function mstrRWButtonStyleHelper(A){this.inherits=mstrRWMultiTagStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWLinkStyleHelper.prototype=new mstrRWMultiTagStyleHelper();mstrRWLinkStyleHelper.prototype.bgNormalColor=null;mstrRWLinkStyleHelper.prototype.bgSelectedColor=null;mstrRWLinkStyleHelper.prototype.bgHighlightedColor=null;mstrRWLinkStyleHelper.prototype.textNormalColor=null;mstrRWLinkStyleHelper.prototype.textSelectedColor=null;mstrRWLinkStyleHelper.prototype.textHighlightedColor=null;mstrRWLinkStyleHelper.SELECTED_COLOR=[127,206,255];mstrRWLinkStyleHelper.HIGHLIGHTED_COLOR=[216,230,239];mstrRWLinkStyleHelper.prototype.onload=function(){try{this.initHighlighting();mstrRWMultiTagStyleHelper.prototype.onload.call(this);}catch(A){microstrategy.errors.log(A);return false;}};mstrRWLinkStyleHelper.prototype.highlight=function(D,G){if(!D||D=="transparent"){D="#FFFFFF";}var C=mstr.utils.Color.hex2rgb(D);var F,E,A;if(!G){F=Math.round((3/5)*parseInt(C[0])+110);E=Math.round((3/5)*parseInt(C[1])+110);A=Math.round((3/5)*parseInt(C[2])+110);}else{C=mstr.utils.Color.hex2rgb(D);F=C[0]*G[0]/255;E=C[1]*G[1]/255;A=C[2]*G[2]/255;var B=C[0]*0.3+C[1]*0.59+C[2]*0.11;if(B<85){F=F+(63*((85-B)/85));if(F>255){F=255;}E=E+(63*((85-B)/85));if(E>255){E=255;}A=A+(96*((85-B)/85));if(A>255){A=255;}}}return"#"+mstr.utils.Color.rgb2hex(F,E,A);};mstrRWLinkStyleHelper.prototype.initHighlighting=function(){try{if(this.getOptions(this.ctlBone.elem).length==0){return ;}var C=microstrategy.findAncestorWithAtt(this.ctlBone.elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);if(!C){return ;}if(this.ctlBone.getDocViewer()){var A=this.ctlBone.getDocViewer().doc.styleObj;if(A){this.bgNormalColor=A.getValue(C,"backgroundColor");if(this.bgSelectedColor==null){this.bgSelectedColor=this.highlight(this.bgNormalColor,mstrRWLinkStyleHelper.SELECTED_COLOR);this.bgHighlightedColor=this.highlight(this.bgNormalColor,mstrRWLinkStyleHelper.HIGHLIGHTED_COLOR);}else{this.bgHighlightedColor=this.highlight(this.bgSelectedColor);}this.textNormalColor=A.getValue(C,"color");this.textSelectedColor=mstr.utils.Color.getContrastingColor(this.bgSelectedColor,["#ffffff","#000000"]);this.textHighlightedColor=mstr.utils.Color.getContrastingColor(this.bgHighlightedColor,["#ffffff","#000000"]);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWLinkStyleHelper.prototype.adjustHeight=function(D,C,B,A){};mstrRWLinkStyleHelper.prototype.initOption=function(A,C){try{mstrRWMultiTagStyleHelper.prototype.initOption.call(this,A,C);if(this.isSelected(A)){this.highlightOption(A,mstrRWMultiTagStyleHelper.SELECT);}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWLinkStyleHelper.prototype.getOptions=function(B){try{return B.getElementsByTagName("td");}catch(A){microstrategy.errors.log(A);return false;}};mstrRWLinkStyleHelper.prototype.getEventHandlers=function(){try{var A=new Object();if(this.ctlBone.multiSelect){A.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onMultiSelectChange(e);");}else{A.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onSingleSelectChange(e);");}A.onmouseover=new Function("e","return "+this.boneStr()+".styleHelper.onMouseOver(e);");A.onmouseout=new Function("e","return "+this.boneStr()+".styleHelper.onMouseOut(e);");return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWLinkStyleHelper.prototype.highlightOption=function(B,C){try{switch(C){case mstrRWMultiTagStyleHelper.SELECT:B.setAttribute("selected","1");B.style.backgroundColor=this.bgSelectedColor;B.style.color=this.textSelectedColor;this.toggleSelectedCssClass(B,C==mstrRWMultiTagStyleHelper.SELECT);break;case mstrRWMultiTagStyleHelper.UNSELECT:B.setAttribute("selected","0");B.style.backgroundColor="transparent";B.style.color=this.textNormalColor;this.toggleSelectedCssClass(B,C==mstrRWMultiTagStyleHelper.SELECT);break;case mstrRWMultiTagStyleHelper.HIGHLIGHT:B.style.backgroundColor=this.bgHighlightedColor;B.style.color=this.textHighlightedColor;break;case mstrRWMultiTagStyleHelper.UNHIGHLIGHT:B.style.backgroundColor="transparent";B.style.color=this.textNormalColor;break;}}catch(A){microstrategy.errors.log(A);return false;}};mstrRWLinkStyleHelper.prototype.onMouseOver=function(A){var B=getEventTarget(A);if(B){B.style.cursor="pointer";if(!this.isSelected(B)){this.highlightOption(B,mstrRWMultiTagStyleHelper.HIGHLIGHT);}}};mstrRWLinkStyleHelper.prototype.onMouseOut=function(A){var B=getEventTarget(A);if(B){B.style.cursor="auto";if(!this.isSelected(B)){this.highlightOption(B,mstrRWMultiTagStyleHelper.UNHIGHLIGHT);}}};mstrRWLinkStyleHelper.prototype.getValue=function(A){try{return A.id;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWLinkStyleHelper.prototype.isSelected=function(A){try{return A.getAttribute("selected")=="1";}catch(B){microstrategy.errors.log(B);return false;}};mstrRWLinkStyleHelper.prototype.renderPreview=function(D,B){var A=document.createElement("div");A.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");switch(this.ctlBone.ctlOrientation){case mstrRWControlImpl.ORIENTATION_VERTICAL:A.style.width="100%";break;case mstrRWControlImpl.ORIENTATION_HORIZONTAL:if(D.parentNode){A.style.height=D.parentNode.style.height;}A.setAttribute(microstrategy.HTMLATTR_ORIENTATION,"1");A.style.textAlign="left";break;}var C=document.createTextNode(B+"-0");A.appendChild(C);D.appendChild(A);};mstrRWLinkStyleHelper.prototype.cascadeFormatting=function(A,D,C){try{if(this.cascadeToOptionsRequired(D)){this.applyStyleValue(A,"td",D,C,"sn","itemList");}if(D=="backgroundColor"){this.reHighlight(A);}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWLinkStyleHelper.prototype.cascadeToOptionsRequired=function(A){return A=="color"||A=="fontFamily"||A=="textDecoration"||A=="fontStyle"||A=="fontWeight"||A=="textAlign"||A=="fontSize";};mstrRWLinkStyleHelper.prototype.initDefaultFormats=function(A){var C=microstrategy.findAncestorWithAtt(this.ctlBone.elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);var B=[C];this.ctlBone.getDocViewer().doc.formatItems(B,"textAlign","center",true,A);return true;};function mstrRWLinkStyleHelper(A){this.inherits=mstrRWCtlStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWScrollerStyleHelper.prototype=new mstrRWCtlStyleHelper();mstrRWScrollerStyleHelper.prototype.onload=function(){for(var D=0;D<this.ctlBone.sibElems.length;D++){var C=this.ctlBone.sibElems[D];var B=C.getElementsByTagName("td");if(B){for(var A=0;A<B.length;A++){B[A].style.cursor="pointer";}}var E=microstrategy.findChildWithAtt(C,"div","ty","sctrk");if(E){E.style.cursor="pointer";}}};mstrRWScrollerStyleHelper.prototype.cascadeFormatting=function(C,F,D){if(F=="height"&&this.ctlBone.ctlOrientation==mstrRWControlImpl.ORIENTATION_VERTICAL||F=="width"&&this.ctlBone.ctlOrientation==mstrRWControlImpl.ORIENTATION_HORIZONTAL){this.adjustHeight(C,"div","id","scroller-background-ver");var E=microstrategy.findChildrenWithAtt(C,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrScrollerImpl");if(E){for(var B=0;B<E.length;B++){var A=microstrategy.bone(E[B].id);if(A){A.onafterresize();}}}}};mstrRWScrollerStyleHelper.prototype.renderPreview=function(C,F){var D=this.ctlBone.multiSelect;try{switch(this.ctlBone.ctlOrientation){case mstrRWControlImpl.ORIENTATION_VERTICAL:var B=document.createElement("div");B.style.height="100%";B.style.width="100%";var K=document.createElement("div");K.className="scroller-ver";var H=document.createElement("div");H.className="scroller-background-ver";H.id="scroller-background-ver";H.style.height="100%";var A=document.createElement("table");A.cellSpacing=0;A.cellPadding=0;A.className="scroller-container-ver";A.style.top="0.0px";var J=null;var E=null;if(D){J=A.insertRow(A.rows.length);var E=J.insertCell(J.cells.length);E.className="scroller-top";}J=A.insertRow(A.rows.length);E=J.insertCell(J.cells.length);if(D){E.className="scroller-selection-ver";}else{E.className="scroller-singleticker-ver";}E.style.height="27.0px";if(D){J=A.insertRow(A.rows.length);E=J.insertCell(J.cells.length);E.className="scroller-bottom";}K.appendChild(H);K.appendChild(A);B.appendChild(K);C.appendChild(B);this.adjustHeight(this.ctlBone.elem,"div","id","scroller-background-ver");break;case mstrRWControlImpl.ORIENTATION_HORIZONTAL:var B=document.createElement("div");B.style.width="100%";var I=document.createElement("div");I.className="scroller-hor";var H=document.createElement("div");H.className="scroller-background-hor";var A=document.createElement("table");A.cellSpacing=0;A.cellPadding=0;A.className="scroller-container-hor";A.style.left="0.0px";var J=A.insertRow(A.rows.length);var E=null;if(D){E=J.insertCell(J.cells.length);E.className="scroller-left";}E=J.insertCell(J.cells.length);if(D){E.className="scroller-selection-hor";}else{E.className="scroller-singleticker-hor";}E.style.width="27.0px";if(D){E=J.insertCell(J.cells.length);E.className="scroller-right";}I.appendChild(H);I.appendChild(A);B.appendChild(I);C.appendChild(B);break;}}catch(G){microstrategy.errors.log(G);return false;}};mstrRWScrollerStyleHelper.prototype.removeElement=function(B){try{for(var C=0;C<this.ctlBone.sibElems.length;C++){var A=microstrategy.bone(this.ctlBone.id+"_scr_"+C);if(A&&A.removeSelectorElement){A.removeSelectorElement(B);}}}catch(D){microstrategy.errors.log(D);return false;}};mstrRWScrollerStyleHelper.prototype.select=function(A){};function mstrRWScrollerStyleHelper(A){this.inherits=mstrRWCtlStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWMetricQualificationStyleHelper.prototype=new mstrRWSelectStyleHelper();mstrRWMetricQualificationStyleHelper.ITEM_SEPARATOR=";";mstrRWMetricQualificationStyleHelper.EVENT_ITEM_SEPARATOR="\u001E";mstrRWMetricQualificationStyleHelper.prototype.onload=function(){try{var A=this.ctlBone,C=A.elem;if(A.ctlSrcId){A.mcSelect=this.getSelect(C);A.mcInput=microstrategy.findChildWithAtt(C,"input","mci","1");A.mcInput2=microstrategy.findChildWithAtt(C,"input","mci","2");A.mcApply=microstrategy.findChildWithAtt(C,"input","type","button");if(A.isInteractive){A.mcSelect.onchange=new Function("e","return "+this.boneStr()+".styleHelper.onSelectionChange(e);");A.mcApply.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onMCQApply(e);");A.mcInput.onkeyup=new Function("e","return "+this.boneStr()+".styleHelper.onKeyup(e);");A.mcInput2.onkeyup=new Function("e","return "+this.boneStr()+".styleHelper.onKeyup(e);");this.validate();}}}catch(B){microstrategy.errors.log(B);}};mstrRWMetricQualificationStyleHelper.prototype.onMCQApply=function(){try{this.ctlBone.exec("setExpression");}catch(A){microstrategy.errors.log(A);}};mstrRWMetricQualificationStyleHelper.prototype.onKeyup=function(B){try{this.validate();B=B||window.event;if(B.keyCode==13){this.ctlBone.mcApply.click();}}catch(A){microstrategy.errors.log(A);}};mstrRWMetricQualificationStyleHelper.prototype.validate=function(I){try{var C=this.ctlBone,K=this.ctlBone.mcApply,H=K.className,O=Number(C.mct)==0&&(C.ctlDataType==14||C.ctlDataType==15||C.ctlDataType==16),M=C.func,Q=M==21||M==22||M==23||M==24||M==57;if(!I){switch(this.numOfInputs()){case 0:I=[];break;case 1:I=[C.mcInput];break;case 2:I=[C.mcInput,C.mcInput2];}}else{if(!(I instanceof Array)){I=[I];}}this.invalid=I.length;for(var F=0,B=I.length;F<B;F++){var N=I[F],L=N.value.split(mstrRWMetricQualificationStyleHelper.ITEM_SEPARATOR),A=L.length==1||Q,E=true;for(var G=0,J=L.length;G<J;G++){var P=L[G];if(P.length>0){if(O){if(!P.match(/^([0]?[1-9]|[1][0-2])\/([0]?[1-9]|[1|2][0-9]|[3][0|1])\/([0-9]{4}|[0-9]{2})(( [012]?[0-9]:[0-5]?[0-9]:[0-5][0-9]| [0-5]?[0-9]:[0-5][0-9])( ([Aa]|[Pp])[Mm])?)?$/)){E=false;}}if((!O&&!mstr.utils.LocaleParser.isNumeric(P))||(O&&!E)){A=false;break;}else{N.style.color=this.currentTextColor?this.currentTextColor:"";}}else{A=false;}}if(!A){N.style.color="#ff0000";N.title=microstrategy.descriptors.getDescriptor(6103);}this.invalid+=A?-1:1;if((""+P).length>6&&A){if(A){N.title=P;}}else{N.title="";}}this.setApplyStatus(this.invalid===0);}catch(D){microstrategy.errors.log(D);}};mstrRWMetricQualificationStyleHelper.prototype.setApplyStatus=function(B){try{var A=this.ctlBone.mcApply,C=A.className;A.disabled=B?"":"disabled";A.className=B?C.replace(/ disabled/g,""):C+" disabled";}catch(D){microstrategy.errors.log(D);}};mstrRWMetricQualificationStyleHelper.prototype.getFuncAndType=function(){try{var C="~";var B=this.ctlBone.mcSelect.value.split("~");return{func:B[0],funcType:B[1]};}catch(A){microstrategy.errors.log(A);}};mstrRWMetricQualificationStyleHelper.prototype.numOfInputs=function(){try{var G=1,D=this.ctlBone.func,E=this.ctlBone.funcType,C=mstr.Enum.Nodes.FUNCTION,A=mstr.Enum.Nodes.MRPFUNCTION;if(E==1&&(D==C.BETWEEN||D==C.NOTBETWEEN)||E>=2&&(D==A.BETWEENASCENDING||D==A.NOTBETWEENASCENDING)||E>=2&&(D==A.BETWEENDESCENDING||D==A.NOTBETWEENDESCENDING)){G=2;}else{if(D==C.ISNULL||D==C.ISNOTNULL){G=0;}}return G;}catch(B){microstrategy.errors.log(B);}};mstrRWMetricQualificationStyleHelper.prototype.onSelectionChange=function(){try{var A=this.ctlBone;if(!A.mcSelect){return ;}A.func=this.getFuncAndType().func;A.funcType=this.getFuncAndType().funcType;var C=this.numOfInputs();d="";A.mcInput.parentNode.style.display=(C>0)?d:"none";A.mcInput2.parentNode.style.display=(C==2)?d:"none";this.validate();}catch(B){microstrategy.errors.log(B);}};mstrRWMetricQualificationStyleHelper.prototype.renderPreview=function(A,D){try{var B=">=";var L="0";var H=document.createElement("table");H.cellSpacing=0;H.cellPadding=0;H.className="controlPulldownTable";var G=H.insertRow(H.rows.length);G.className="controlPulldown";var C=G.insertCell(G.cells.length);C.className="controlPulldownOptionCell";var I=document.createElement("div");I.className="controlPulldownOption";var M=document.createElement("div");M.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");M.className="controlPulldownOptionInset";M.appendChild(document.createTextNode(B));I.appendChild(M);C.appendChild(I);C=G.insertCell(G.cells.length);C.className="controlPulldownButtonCell";var K=document.createElement("div");K.className="controlPulldownButton";var N=document.createElement("div");N.className="controlPulldownButtonInset";var F=document.createElement("img");F.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";N.appendChild(F);K.appendChild(N);C.appendChild(K);C=G.insertCell(G.cells.length);C.className="controlInputCell";var J=document.createElement("input");J.setAttribute("size",1);J.setAttribute("value",L);C.appendChild(J);A.appendChild(H);}catch(E){microstrategy.errors.log(E);}};mstrRWMetricQualificationStyleHelper.prototype.getSelect=function(B){try{var D=microstrategy.findChildWithAtt,C=D(B,"select","id",this.ctlBone.ctlKey+"_S");if(!C){C=D(B,"select","mc","1");}return C;}catch(A){microstrategy.errors.log(A);return null;}};mstrRWMetricQualificationStyleHelper.prototype.cascadeFormatting=function(A,D,C){try{if(D!="width"&&D!="height"&&D!="backgroundColor"){this.applyStyleValue(A,"input",D,C,"type","text");}}catch(B){microstrategy.errors.log(B);return false;}};mstrRWMetricQualificationStyleHelper.prototype.generateSelectOptions=function(){try{var A=this.ctlBone,B=A.elem,C=A.func,G=A.funcType,I=A.asc,J=this.getSelect(B,G+","+I);if(!J){return ;}var H=function(F){return microstrategy.descriptors.getDescriptor(F);},D=function(P,N,O,M){var F=new Option(H(O),N+"~"+P);F.setAttribute("title",H(O));if(M===true){F.setAttribute("selected",M);}J.options[J.length++]=F;};J.length=0;var L=mstr.Enum.Nodes.FUNCTIONTYPE;var K=G==L.DEFAULT?mstr.Enum.Nodes.FUNCTION:mstr.Enum.Nodes.MRPFUNCTION;var I=G==L.DEFAULT?"":(I==true?"ASCENDING":"DESCENDING");D(G,K["EQUALS"+I],2795);D(G,K["NOTEQUALS"+I],2796);D(G,K["GREATERTHAN"+I],521);D(G,K["GREATERTHANEQUALS"+I],522,true);D(G,K["LESSTHAN"+I],523);D(G,K["LESSTHANEQUALS"+I],524);D(G,K["BETWEEN"+I],519);D(G,K["NOTBETWEEN"+I],614);D(G,K["IN"+I],898);D(G,K["NOTIN"+I],2394);if(G==L.DEFAULT){D(G,K.ISNULL,2202);D(G,K.ISNOTNULL,2203);}}catch(E){microstrategy.errors.log(E);return false;}};function mstrRWMetricQualificationStyleHelper(A){this.inherits=mstrRWCtlStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrRWMetricScrollerStyleHelper.prototype=new mstrRWScrollerStyleHelper();mstrRWMetricScrollerStyleHelper.prototype.onload=function(){mstrRWScrollerStyleHelper.prototype.onload.call(this);var A=this.ctlBone,B=A.elem;B.className=B.className.replace(/ strikeout/g,"")+(A.include?"":" strikeout");};mstrRWMetricScrollerStyleHelper.prototype.renderPreview=function(E,B){try{E.className+="mstrRWControl metricSlider fake";var G=document.createElement("div");G.style.width="100%";var F=document.createElement("div");F.className="scroller-hor";F.style.marginRight="1px";var H=document.createElement("div");H.className="scroller-selection start";H.style.cssText="top: 2px; left: 0pt; width: 10%;";F.appendChild(H);H=document.createElement("div");H.className="scroller-selection center";H.style.cssText="top: 2px; left: 10%; width: 70%;";F.appendChild(H);H=document.createElement("div");H.className="scroller-selection end";H.style.cssText="top: 2px; left: 80%; width: 20%;";F.appendChild(H);var A=document.createElement("div");var D=document.createElement("div");D.className="scroller-left";D.style.cssText="left: 10%;";A.appendChild(D);D=document.createElement("div");D.className="scroller-right";D.style.cssText="left: 80%;";A.appendChild(D);F.appendChild(A);G.appendChild(F);E.appendChild(G);}catch(C){microstrategy.errors.log(C);return false;}};mstrRWMetricScrollerStyleHelper.prototype.removeElement=function(A){};function mstrRWMetricScrollerStyleHelper(A){this.inherits=mstrRWScrollerStyleHelper;this.inherits(A);this.inherits=null;return this;}mstrSubSectionMaskImpl.prototype=new mstrMaskImpl();mstrSubSectionMaskImpl.prototype.superClass=mstrMaskImpl.prototype;mstrSubSectionMaskImpl.prototype.elem=null;mstrSubSectionMaskImpl.prototype.img=null;mstrSubSectionMaskImpl.prototype.docMask=null;mstrSubSectionMaskImpl.prototype.adjusted=false;mstrSubSectionMaskImpl.prototype.path="";mstrSubSectionMaskImpl.prototype.verifiedPath="";mstrSubSectionMaskImpl.prototype.horizontalBone=null;mstrSubSectionMaskImpl.prototype.sibIndex=null;mstrSubSectionMaskImpl.MASK_HILITE_BORDER=microstrategy.DND_HILITE_WIDTH*2;mstrSubSectionMaskImpl.prototype.onload=function(B){try{this.maskedBone=B;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.initElem();}catch(A){microstrategy.errors.log(A);return false;}};mstrSubSectionMaskImpl.prototype.onmaskedobjectresize=function(C,B){try{if(C){if(B=="height"){this.elem.style.height=Math.max(parseInt(this.elem.style.height)+C,0)+"px";if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))<parseInt(this.elem.style.height)){this.elem.setAttribute(microstrategy.HTMLATTR_HEIGHT,this.getSectionHeight(document.getElementById(this.subId))+this.topOffset);}}if(B=="width"){if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=parseInt(this.elem.style.width)+C+"px";}if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_WIDTH))<parseInt(this.elem.style.width)){this.elem.setAttribute(microstrategy.HTMLATTR_WIDTH,this.getSectionWidth(document.getElementById(this.subId))+this.leftOffset);}}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrSubSectionMaskImpl.prototype.onpanelresize=function(A,B){try{this.elem.style.height=A+"px";this.elem.style.width=B+"px";}catch(C){microstrategy.errors.log(C);}};mstrSubSectionMaskImpl.prototype.toggleMaskHilite=function(A){try{if(this.maskedBone.isHorizontal){this.elem.style.height=(A)?this.topOffset+parseInt(this.horizontalBone.elem.style.height)+"px":this.getSectionHeight(document.getElementById(this.subId))+this.topOffset+"px";if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=(A)?this.leftOffset+"px":this.getSectionWidth(document.getElementById(this.subId))+this.leftOffset+"px";}}else{this.elem.style.height=(A)?this.topOffset+"px":this.getSectionHeight(document.getElementById(this.subId))+this.topOffset+"px";}if(A){this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");if(bIsIE6){this.elem.style.cursor="not-allowed";}}else{this.img.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(true); }");this.img.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(false); }");this.elem.style.cursor="default";this.elem.setAttribute("isCollapsed","false");}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrSubSectionMaskImpl.prototype.onmaskedobjectresizeForSib=function(C,A,D){try{if(C){if(D=="height"){this.elem.style.height=C+"px";if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))<parseInt(this.elem.style.height)){this.elem.setAttribute(microstrategy.HTMLATTR_HEIGHT,this.getSectionHeight(document.getElementsByName(this.subId)[A])+this.topOffset);}}if(D=="width"){if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=C+"px";}if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_WIDTH))<parseInt(this.elem.style.width)){this.elem.setAttribute(microstrategy.HTMLATTR_WIDTH,this.getSectionWidth(document.getElementsByName(this.subId)[A])+this.leftOffset);}}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrSubSectionMaskImpl.prototype.toggleMaskHiliteForSib=function(B,A){try{if(this.maskedBone.isHorizontal){this.elem.style.height=(B)?this.topOffset+parseInt(this.horizontalBone.elem.style.height)+"px":this.getSectionHeight(document.getElementsByName(this.subId)[A])+this.topOffset+"px";if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=(B)?this.leftOffset+"px":this.getSectionWidth(document.getElementsByName(this.subId)[A])+this.leftOffset+"px";}}else{this.elem.style.height=(B)?this.topOffset+"px":this.getSectionHeight(document.getElementsByName(this.subId)[A])+this.topOffset+"px";}if(B){this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");if(bIsIE6){this.elem.style.cursor="not-allowed";}}else{this.img.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(true); }");this.img.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(false); }");this.elem.style.cursor="default";this.elem.setAttribute("isCollapsed","false");}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrSubSectionMaskImpl.prototype.initElem=function(){try{var B=(this.maskedBone.subsectionType==mstrSubSection.TYPE_PANEL);var D=document.createElement("div");D.setAttribute("id",this.maskedBone.id+"_mask");D.setAttribute("name",this.maskedBone.id+"_mask");D.style.position=(B)?"absolute":"relative";D.style.overflow="hidden";var A=document.createElement("img");A.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";A.style.width="100%";A.style.height="100%";A.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK);A.setAttribute("isPanel",B);if(this.maskedBone){A.setAttribute(microstrategy.HTMLATTR_MASKEDOBJECT,this.maskedBone.id);A.setAttribute(microstrategy.HTMLATTR_POINTS_TO,this.secId+"|"+this.subId+"|"+this.subIndex);D.style.height=this.getSectionHeight(this.maskedBone.elem)+"px";if(this.maskedBone.isHorizontal){if(this.getSectionWidth(this.maskedBone.elem)!=0){D.style.width=this.getSectionWidth(this.maskedBone.elem)+"px";}}}D.appendChild(A);this.img=A;this.elem=D;if(parseInt(this.elem.style.height)>0){this.img.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(true); }");this.img.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(false); }");this.elem.setAttribute("isCollapsed","false");}else{this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");this.elem.style.cursor="not-allowed";}}catch(C){microstrategy.errors.log(C);return false;}};mstrSubSectionMaskImpl.prototype.displayMask=function(show){try{var submaskDiv=document.getElementById("maskDiv");if(!submaskDiv){submaskDiv=document.createElement("div");submaskDiv.setAttribute("id","maskDiv");submaskDiv.style.position="absolute";var docMask=document.getElementById("docMask");docMask.insertBefore(submaskDiv,docMask.firstChild);}if(!show){submaskDiv.style.display="none";return false;}var isPanel=(this.maskedBone.subsectionType==mstrSubSection.TYPE_PANEL);if(isPanel){with(submaskDiv.style){border=(this.parentBone.selections.isSameSubSection())?"3px solid #ffff00":"0px solid #ffff00";display="block";visibility="visible";var panelStack=this.maskedBone.parentBone;var h=getObjHeight(panelStack.elem);if(panelStack.isTitleVisible){h-=getObjHeight(panelStack.titleBars[0]);}var w=getObjWidth(panelStack.elem);h=(h<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?h:h-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;w=(w<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?w:w-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;height=h+"px";width=w+"px";left=getObjSumLeft(this.maskedBone.elem)-parseInt(this.maskedBone.doc.left)+"px";top=getObjSumTop(this.maskedBone.elem)-parseInt(this.maskedBone.doc.top)+"px";}}else{var isFirstMask=(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))<parseInt(this.elem.style.height));var dHeight=(isFirstMask)?parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))-this.topOffset:parseInt(this.elem.style.height)-this.topOffset;var subObj=document.getElementById(this.subId);var dWidth=getObjWidth(subObj);dHeight=(dHeight<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?dHeight:dHeight-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;dWidth=(dWidth<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?dWidth:dWidth-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;with(submaskDiv.style){height=dHeight+"px";width=dWidth+"px";border=(this.parentBone.selections.isSameSubSection())?"3px solid #ffff00":"0px solid #ffff00";display="block";visibility="visible";}if(dHeight>0){var offset=(isFirstMask)?0:this.parentBone.mouseoffsetTop;var left=0;if(this.maskedBone.isHorizontal){left=getObjSumLeft(subObj)-getObjSumLeft(this.parentBone.elem);}moveObjTo(submaskDiv,left,getObjSumTop(this.elem)-offset-getObjSumTop(this.parentBone.elem)-parseInt(this.parentBone.docMask.style.top)+this.topOffset);}}}catch(err){microstrategy.errors.log(err);}return false;};mstrSubSectionMaskImpl.prototype.getSectionHeight=function(B){try{if(B.style.display!=null&&B.style.display.toLowerCase()=="none"){return 0;}else{return getObjHeight(B);}}catch(A){microstrategy.errors.log(A);return 0;}};mstrSubSectionMaskImpl.prototype.getSectionWidth=function(B){try{if(B.style.display!=null&&B.style.display.toLowerCase()=="none"){return 0;}else{return getObjWidth(B);}}catch(A){microstrategy.errors.log(A);return 0;}};function mstrSubSectionMaskImpl(C,B,A){this.secId=C;this.subId=B;this.subIndex=A;this.topOffset=0;this.leftOffset=0;return this;}microstrategy.HTMLATTR_MAPS="MAPS";microstrategy.HTMLATTR_MAPS_DELIM=",";mstrMaskMappedImpl.prototype=new mstrMaskImpl();mstrMaskMappedImpl.prototype.maps=null;mstrMaskMappedImpl.prototype.mask=null;mstrMaskMappedImpl.prototype.hiLite=null;mstrMaskMappedImpl.prototype.surroundHilite=null;mstrMaskMappedImpl.MASK_TYPE=-1;mstrMaskMappedImpl.prototype.onload=function(E){try{this.maskedBone=E;this.initElem();var H=document.createElement("span");H.className="mstrMaskedHilite";H.style.visibility="hidden";this.hiLite=H;this.elem.appendChild(this.hiLite);if(this.maskedBone&&this.maskedBone.maskFor){var J=this.maskedBone.maskFor;this.maskfor=microstrategy.HTMLATTR_MASKFOR_DELIM+J+microstrategy.HTMLATTR_MASKFOR_DELIM;var G=J.split(microstrategy.HTMLATTR_MASKFOR_DELIM);this.maps=new Object();var F=document.getElementById("useMap");for(var C=0;C<G.length;C++){var I=this.maskedBone.id+"_map"+G[C]+(this.midx?this.midx:"");var A=F.cloneNode(false);A.name=I;A.setAttribute("id",I);A.setAttribute(microstrategy.HTMLATTR_MASKEDOBJECT,this.maskedBone.id);A.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK_MAP);A.setAttribute(microstrategy.HTMLATTR_MASKFOR,G[C]);this.maps[G[C]]=A;var D=document.getElementById(I);if(D){document.body.removeChild(D);}document.body.appendChild(this.maps[G[C]]);}this.maskedBone.maskFor=mstrMaskMappedImpl.MASK_TYPE;this.mask=new mstrMaskImpl();this.mask.onload(this.maskedBone);this.maskedBone.maskFor=J;this.onmaskedobjectresize(true);}this.isLoaded=true;}catch(B){microstrategy.errors.log(B);}};mstrMaskMappedImpl.prototype.onmaskedobjectresize=function(D){try{if(this.maskedBone){if(D!=true){var C=this.maskedBone.gridStructureInfo;if(C&&C.colAxis&&C.colAxis.units&&C.colAxis.units[0]){C.colAxis.units[0].needBuildColMetricAreas=true;}}var B=this;window.setTimeout(function(){B.resizeMask();},0);}}catch(A){microstrategy.errors.log(A);}};mstrMaskMappedImpl.prototype.sizeMask=function(B,A){try{if(!this.img){return ;}this.img.style.height=B+"px";this.img.style.width=A+"px";}catch(C){microstrategy.errors.log(C);}};mstrMaskMappedImpl.prototype.resizeMask=function(){try{if(this.maskedBone==null){return ;}var G;var I={height:getObjHeight(this.maskedBone.maskArea),width:this.maskedBone.maskArea.scrollWidth,top:getObjSumTop(this.maskedBone.maskArea),left:getObjSumLeft(this.maskedBone.maskArea)};this.sizeMask(I.height,I.width);this.mask.onmaskedobjectresize(I.height,I.width);this.updateMaskDimensions&&this.updateMaskDimensions(I);for(var D in this.maps){var C=this.maps[D];for(G=C.childNodes.length-1;G>=0;G--){C.removeChild(C.childNodes[G]);}var A=this.maskedBone.mapper.getAreas(this.maskedBone,C,I);if(A){for(G=0;G<A.length;G++){var H=A[G];var E=document.createElement("area");E.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK_MAP_AREA);E.shape=(H.shape)?H.shape:"rect";E.coords=(H.coords)?H.coords:"0,0,0,0";if(H.pointsTo){E.setAttribute(microstrategy.HTMLATTR_POINTS_TO,H.pointsTo);}if(H.onmouseovercoords){if(H.moveHilite){E.onmouseover=new Function("microstrategy.bone('"+this.maskedBone.id+"').mask.moveHilite('"+H.onmouseovercoords+"');");var B=new Function("microstrategy.bone('"+this.maskedBone.id+"').mask.hiLite && (microstrategy.bone('"+this.maskedBone.id+"').mask.hiLite.style.visibility = 'hidden');");if(mstrGridReport&&mstrGridReport.isRWD()&&mstr.utils.ISIE7){E.attachEvent("onmouseout",B);}else{E.onmouseout=B;}}else{arnea.onmouseover=new Function("microstrategy.bone('"+this.maskedBone.id+"').mask.moveSurroundHilite('"+H.onmouseovercoords+"');");E.onmouseout=new Function("microstrategy.bone('"+this.maskedBone.id+"').mask.surroundHilite.style.visibility = 'hidden';");}}C.appendChild(E);}}}}catch(F){microstrategy.errors.log(F);}};mstrMaskMappedImpl.prototype.toggle=function(A,B){try{if(!A||B==mstrMaskMappedImpl.MASK_TYPE){this.mask.toggle(A,B);}if(A&&this.maps[B]){this.img.useMap="#"+this.maskedBone.id+"_map"+B+(this.midx?this.midx:"");this.elem.style.display="block";}else{this.elem.style.display="none";this.hiLite.style.visibility="hidden";if(this.surroundHilite){this.surroundHilite.style.visibility="hidden";}}}catch(C){microstrategy.errors.log(C);}};mstrMaskMappedImpl.prototype.moveHilite=function(s){try{if(!this.hiLite){return ;}var a=s.split(",");with(this.hiLite.style){if(visibility=="hidden"){left=a[0]+"px";top=a[1]+"px";height=a[2]+"px";width=a[3]+"px";visibility="visible";}}}catch(err){microstrategy.errors.log(err);}};mstrMaskMappedImpl.prototype.moveSurroundHilite=function(s){try{if(!this.surroundHilite){var span=document.createElement("span");span.className="mstrMaskedSurroundHilite";this.surroundHilite=span;this.elem.appendChild(this.surroundHilite);}var a=s.split(",");with(this.surroundHilite.style){if(visibility=="hidden"){left=a[0]+"px";top=a[1]+"px";height=a[2]+"px";width=a[3]+"px";visibility="visible";}}}catch(err){microstrategy.errors.log(err);}};function mstrMaskMappedImpl(A){this.updateMaskDimensions=A;return this;}mstrTabStripMask.prototype=new mstrMaskMappedImpl();mstrTabStripMask.prototype.sizeMask=function(B,A){try{this.maskedBone.shiftMaskArea();mstrMaskMappedImpl.prototype.sizeMask.call(this,B,A);this.maskedBone.restoreMaskArea();}catch(C){microstrategy.errors.log(C);}};function mstrTabStripMask(){return this;}mstrPanel.prototype=new mstrSubSection();mstrPanel.prototype.subsectionType=mstrSubSection.TYPE_PANEL;mstrPanel.prototype.onShowCalled=false;mstrPanel.prototype.contentsMenu=null;mstrPanel.prototype.docViewer=null;mstrPanel.prototype.isFilterPanel=false;mstrPanel.prototype.onload=function(){try{mstrSubSection.prototype.onload.call(this);this.docViewer=microstrategy.getViewerBone();var D=this.docViewer.doc.styleObj;microstrategy.formatType=1;var C=D.getValue(this.parentBone.elem,"width");var F=parseInt(D.getValue(this.parentBone.elem,"height"));if(this.parentBone.isTitleVisible&&F>getObjHeight(this.parentBone.titleBars[0])){F-=getObjHeight(this.parentBone.titleBars[0]);}var B=microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE;this.isFilterPanel=this.parentBone.isFilterPanel;for(var E=0;E<this.sibs.length;E++){var A=this.sibs[E];if(B){A.onmousedown=new Function("e",this.verifiedPath+" { return "+this.path+".onmousedown(e); }");A.onclick=new Function("e",this.verifiedPath+" { return "+this.path+".onclick(e); }");A.ondblclick=new Function("e",this.verifiedPath+" { return "+this.path+".ondblclick(e); }");A.onselectstart=new Function("return false");}A.style.width=C;A.style.height=F+"px";this.clearContentsMenu();this.updateContentsMenu();}}catch(G){microstrategy.errors.log(G);}};mstrPanel.prototype.onpostload=function(){try{if(this.isFilterPanel){this.adjustChnPos();}}catch(A){microstrategy.errors.log(A);}};mstrPanel.prototype.adjustChnPos=function(){try{var H=this.doc,C=this.elem.childNodes,B=microstrategy.styleObj,F;if(C&&C.length>0){var G=[];for(F=0;F<C.length;F++){G.push(C[F]);}G.sort(function(K,J){var L=parseInt(B.getValue(K,"zIndex")),M=parseInt(B.getValue(J,"zIndex"));return L-M;});var A=mstrFilterPanelMaskImpl.ITEM_SPA;for(F=0;F<C.length;F++){var D=B.getValue(C[F],"left"),I=A;moveObjTo(C[F],D,I);A=I+getObjHeight(C[F])+mstrFilterPanelMaskImpl.ITEM_SPA;}}}catch(E){microstrategy.errors.log(E);}};mstrPanel.prototype.synchronizeSize=function(){try{if(!!this.sibs.length&&!!this.sibs[0]){if(!this.sibs[0].style.width){this.onShowCalled=false;var A=parseInt(microstrategy.styleObj.getValue(this.parentBone.elem,"width"));var B=parseInt(microstrategy.styleObj.getValue(this.parentBone.elem,"height"));if(this.parentBone.isTitleVisible&&B>getObjHeight(this.parentBone.titleBars[0])){B-=getObjHeight(this.parentBone.titleBars[0]);}this.resize(B,A);this.onShow();}}}catch(C){microstrategy.errors.log(C);}};mstrPanel.prototype.resetElement=function(){this.elem=document.getElementById(this.id);var C=null;for(var A=0;A<this.elem.childNodes.length;A++){C=this.elem.childNodes[A];if((C.tagName=="SPAN")&&(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK)){var B=microstrategy.bone(C.id);if(B){B.resetElement();}}}};mstrPanel.prototype.clearContentsMenu=function(){var A=document.getElementById(this.id+"_contentsMenu");if(A){this.elem.removeChild(A);this.contentsMenu=null;}};mstrPanel.prototype.addContentsMenu=function(){if(!this.isPanelEmpty()||!this.docViewer.isFeatureAvailable(microstrategy.FEATURE_INSERT_INTO_PANEL)){return ;}this.contentsMenu=document.createElement("div");this.contentsMenu.setAttribute("id",this.id+"_contentsMenu");this.contentsMenu.className="contentsMenu";this.contentsMenu.setAttribute(microstrategy.HTMLATTR_CMD_ID,"cm");this.contentsMenu.onmousedown=new Function("e","microstrategy.bone('"+this.parentBone.id+"').onmousedown(e);");this.elem.appendChild(this.contentsMenu);var A=this.contentsMenu.appendChild(document.createElement("span"));A.setAttribute("id","contentsMenuIcon");A.className="addContents";A.setAttribute(microstrategy.HTMLATTR_CMD_ID,"cm");A=this.contentsMenu.appendChild(document.createElement("span"));A.setAttribute("id","contentsMenuIconPD");A.className="contentsPD";A.setAttribute(microstrategy.HTMLATTR_CMD_ID,"cm");A=this.contentsMenu.appendChild(document.createElement("span"));A.innerHTML=microstrategy.descriptors.getDescriptor((this.isFilterPanel)?"9241":"5702");A.setAttribute("id","addContents");A.className="addContentsText";A.setAttribute(microstrategy.HTMLATTR_CMD_ID,"cm");};mstrPanel.prototype.updateContentsMenu=function(){if(!this.docViewer.isEditableViewModeEplus()){return ;}if(this.contentsMenu){if(!this.isPanelEmpty()){this.clearContentsMenu();}}else{this.addContentsMenu();}};mstrPanel.prototype.isPanelEmpty=function(){var A=this.elem.childNodes.length;if(A>1){return false;}else{if(A==1){var B=this.elem.childNodes[0].id;if(B!=""){return false;}}}return true;};mstrPanel.prototype.onmousedown=function(C){try{if(!C){C=window.event;}mstr.controllers.EventManager.notifyWindowListeners({name:"closeMenus"});var B=microstrategy.findBone(getEventTarget(C));if(B&&(B.isTable||B.isVisualization)){return true;}C.cancelBubble=true;return(this.doc.selections.onmousedown)?this.doc.selections.onmousedown(C):false;}catch(A){microstrategy.errors.log(A);return false;}};mstrPanel.prototype.hideMask=function(){try{var A=document.getElementsByName(this.id+"_mask");for(var B=0;B<A.length;B++){A[B].style.display="none";A[B].setAttribute("isCollapsed","true");}}catch(C){microstrategy.errors.log(C);}};mstrPanel.prototype.showMask=function(topOffset,leftOffset){try{var masks=document.getElementsByName(this.id+"_mask");if(masks.length>0){var panelStack=(this.parentBone.elem);var h=getObjHeight(panelStack);if(this.parentBone.isTitleVisible&&h>getObjHeight(this.parentBone.titleBars[0])){h-=getObjHeight(this.parentBone.titleBars[0]);}var w=getObjWidth(panelStack);for(var i=0;i<masks.length;i++){masks[i].setAttribute("isCollapsed","false");with(masks[i].style){height=h+"px";width=w+"px";top=(getObjSumTop(this.sibs[i])-this.doc.top+topOffset)+"px";left=(getObjSumLeft(panelStack)-this.doc.left+leftOffset)+"px";display="block";}}if(this.isFilterPanel&&this.docViewer.doc){var sec=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,"dsec");var maskBone=this.docViewer.doc.getSubMaskBone(sec.id,this.id,0);if(maskBone){maskBone.updateImageMap();}}}}catch(err){microstrategy.errors.log(err);}};mstrPanel.prototype.onclick=function(B){try{return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrPanel.prototype.resize=function(A,C){try{if(A<=0||C<=0){return ;}for(var B=0;B<this.sibs.length;B++){this.sibs[B].style.height=A+"px";this.sibs[B].style.width=C+"px";}microstrategy.getViewerBone().resize100HMObjects(this.id);microstrategy.getViewerBone().resize100WMObjects(this.id,true);}catch(D){microstrategy.errors.log(D);}};mstrPanel.prototype.applyGradient=function(){};mstrPanel.prototype.onShow=function(){try{if(!this.onShowCalled){var J=microstrategy.findChildrenWithAtt(this.elem,"span",microstrategy.HTMLATTR_STYLE,microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);if(J){for(var F=0;F<J.length;F++){var Q=microstrategy.bone(J[F].id);if(Q){Q.synchronizeSize();}}}var K=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrScrollerImpl");if(K){for(var F=0;F<K.length;F++){var B=microstrategy.bone(K[F].id);if(B){B.reset();}}}var P=microstrategy.findChildrenWithAtt(this.elem,"span",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(P){for(var F=0;F<P.length;F++){var I=microstrategy.bone(P[F].id);if(I&&I.isLoaded){I.synchronizeSize();}}}var E=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE);if(E){for(var F=0;F<E.length;F++){var C=microstrategy.bone(E[F].id);if(C){C.onresize();}}}var E=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_GRID_TABLE);if(E){for(var F=0;F<E.length;F++){var C=microstrategy.bone(E[F].id);if(C){C.onresize();window.setTimeout("microstrategy.bone('"+E[F].id+"').resizeLockSet()",0);}}}var H=this.elem.getAttribute("gradientcolor");if(H){var G=document.getElementsByName(this.elem.getAttribute("id"));var M=H.split(",");for(var F=0;F<G.length;F++){gradientUtil.applyGradient(G[F],M[gradientUtil.GRADIENT_START_COLOR_INDEX],M[gradientUtil.GRADIENT_END_COLOR_INDEX],M[gradientUtil.GRADIENT_ANGLE_INDEX],M[gradientUtil.GRADIENT_XOFFSET_INDEX],M[gradientUtil.GRADIENT_YOFFSET_INDEX],microstrategy.styleObj);}}var L=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_GMAP);if(window.mstrmojo&&L){for(F=0;F<L.length;F++){var A=mstrmojo.all[L[F].id];if(A){A.onShow();}}}var O=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_ESRIMAP);if(window.mstrmojo&&O){for(F=0;F<O.length;F++){var N=mstrmojo.all[O[F].id];if(N){N.onShow();}}}this.onShowCalled=true;}}catch(D){microstrategy.errors.log(D);}};mstrPanel.prototype.updatePortalTitle=function(A){this.parentBone.adjustTitle(this.elem);};mstrPanel.prototype.deletePanel=function(){try{microstrategy.eventManager.notifyOrphanBones("onPanelDeleted",this.id);}catch(A){microstrategy.errors.log(A);}};function mstrPanel(C,A,B){this.inherits=mstrSubSection;this.inherits(C);delete this.inherits;this.parentBone=A;this.path=B;}mstrFixedPanel.prototype=new mstrSubSection();mstrFixedPanel.prototype.ruler=null;mstrFixedPanel.prototype.handle=null;mstrFixedPanel.prototype.rulerShade=null;mstrFixedPanel.prototype.nextSibling="";mstrFixedPanel.prototype.isCanGrowCanShrink=true;mstrFixedPanel.prototype.oldHeight=null;mstrFixedPanel.prototype.subsectionType=mstrSubSection.TYPE_FIXED;mstrFixedPanel.prototype.isHorizontal=false;mstrFixedPanel.prototype.isBeginHorizontal=false;mstrFixedPanel.prototype.isEndHorizontal=false;mstrFixedPanel.prototype.horizontalContainerBone=null;mstrFixedPanel.prototype.isCanGrowCanShrinkHorizontal=true;mstrFixedPanel.prototype.oldWidth=null;mstrFixedPanel.prototype.forceGrowOnResize=false;mstrFixedPanel.prototype.hasConditionalFormatting=false;mstrFixedPanel.prototype.onload=function(){try{mstrSubSection.prototype.onload.call(this);var B=microstrategy.styleObj;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.isDetails=(this.elem.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)==-1);this.isHorizontal=(B.getAttValue(this.elem,microstrategy.HTMLATTR_IS_HORIZONTAL)=="-1");if(this.isHorizontal){this.isBeginHorizontal=(B.getAttValue(this.elem,microstrategy.HTMLATTR_IS_BEGIN_HORIZONTAL)=="-1");this.isEndHorizontal=(B.getAttValue(this.elem,microstrategy.HTMLATTR_IS_END_HORIZONTAL)=="-1");}this.container=this.elem.parentNode;this.hasConditionalFormatting=(B.getAttValue(this.elem,microstrategy.HTMLATTR_HAS_CONDITIONAL_FORMATTING)=="-1");var A=B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW);var F=B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK);if(((A==microstrategy.FALSE&&F==microstrategy.FALSE)||microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE)){this.isCanGrowCanShrink=false;}var C=B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);var I=B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);if(((C==microstrategy.FALSE&&I==microstrategy.FALSE)||microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE)){this.isCanGrowCanShrinkHorizontal=false;}this.calcHasObjects();var G=this.doc.parentBone;if(G.isEditableViewModeEplus()){var H=microstrategy.objectFind(this.container,["DIV"],microstrategy.OBJTYPE_RULER);if(H&&H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_VRULER){this.ruler=H;this.rulerShade=microstrategy.subObjectFind(this.ruler,["DIV"],microstrategy.SUBOBJTYPE_VRULER_SHADE);}}if(G.layoutHeightMode!=1){this.adjustSubsectionHeight(false);}if(this.isHorizontal==false&&G.isEditableViewModeEplus()){for(var E=0;E<this.sibs.length;E++){G.totalHeight+=parseInt(B.getValue(this.sibs[E],"height"));}}if(this.isHorizontal){this.adjustSubsectionWidth(false);}this.applyGradient();}catch(D){microstrategy.errors.log(D);}};mstrFixedPanel.prototype.getOldHeight=function(){try{if(this.oldHeight==null){this.oldHeight=getObjHeight(this.elem);}return this.oldHeight;}catch(A){microstrategy.errors.log(A);return -1;}};mstrFixedPanel.prototype.getOldWidth=function(){try{if(this.oldWidth==null){this.oldWidth=getObjWidth(this.elem);}return this.oldWidth;}catch(A){microstrategy.errors.log(A);return -1;}};mstrFixedPanel.prototype.calcMaxContentHeight=function(){try{this.maxContentHeight=-1;this.maxContentWidth=-1;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE){return ;}if(this.isHorizontal){if(!this.isCanGrowCanShrink&&!this.isCanGrowCanShrinkHorizontal){return ;}}else{if(!this.isCanGrowCanShrink){return ;}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){if(this.isCanGrowCanShrink){this.sibsHeight=new Array();}if(this.isCanGrowCanShrinkHorizontal&&this.isHorizontal){this.sibsWidth=new Array();}}var L=-1;var A=-1;var D=microstrategy.styleObj;var E=null;for(var H=0;H<this.sibs.length;H++){E=this.sibs[H];if(E!=null){var B=-1;var I=-1;if(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.RESIZE_EACH_SUBSECTION&&!this.containsDocObject(E)){continue;}for(var G=0;G<E.childNodes.length;G++){var C=E.childNodes[G];if(C.nodeType==1){if(this.isCanGrowCanShrinkHorizontal&&this.isHorizontal){A=getObjWidth(C);if(microstrategy.subObjectType(C)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){A=Math.max((C.scrollWidth?C.scrollWidth:0),A);}A+=parseInt(D.getValue(C,"left"));if(A>I){I=A;}}if(this.isCanGrowCanShrink){if(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&C.style.display!="none"){if(D.getAttValue(C,microstrategy.HTMLATTR_HEIGHT_MODE)){if(D.getAttValue(C,microstrategy.HTMLATTR_HEIGHT_MODE)!=microstrategy.HUNDRED_PERCENT_MODE){var J=getObjHeight(C);var K=parseInt(D.getValue(C,"top"));L=(isNaN(K)?0:K)+J;}}else{L=parseInt(D.getValue(C,"top"))+getObjHeight(C);}if(L>B){B=L;}}}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){this.maxContentHeight=B;this.maxContentWidth=I;break;}else{if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){if(this.isCanGrowCanShrink){this.sibsHeight.push(B);}if(this.isCanGrowCanShrinkHorizontal&&this.isHorizontal){this.sibsWidth.push(I);}}}}window.setTimeout(this.path+".getOldHeight()",0);}catch(F){microstrategy.errors.log(F);return false;}};mstrFixedPanel.prototype.calcHasObjects=function(){try{for(var A=0;A<this.sibs.length;A++){if(this.containsDocObject(this.sibs[A])){return true;}}return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrFixedPanel.prototype.toggleSelected=function(){try{for(var C=0;C<this.sibs.length;C++){if(this.isHorizontal){var B=this.sibs[C].parentNode.parentNode.previousSibling.firstChild;}else{var B=this.sibs[C].parentNode.previousSibling;}if(B){var A=B.className;var E=A.indexOf("selected");if(E>-1){B.className=A.substring(0,E);}else{B.className+="selected";if(bIsFirefox){getObj("rwb_viewer").focus();}}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrFixedPanel.prototype.isEndHorizontalSib=function(A){try{if(this.isDetails&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){return this.isEndHorizontal&&this.sibs.length-1==A;}else{return this.isEndHorizontal;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFixedPanel.prototype.isBeginHorizontalSib=function(A){try{if(this.isDetails&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){return this.isBeginHorizontal&&A==0;}else{return this.isBeginHorizontal;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFixedPanel.prototype.toggleGrid=function(B){try{for(var A=0;A<this.sibs.length;A++){this.sibs[A].style.backgroundImage=(B)?"url(none)":"url("+microstrategy.FOLDER_IMAGES+microstrategy.GRID_IMAGE+")";}}catch(C){microstrategy.errors.log(C);return false;}};mstrFixedPanel.prototype.ondragstart=function(C){try{var B=microstrategy.styleObj;if(!C){C=window.event;}if(C.e){C=C.e;}getMouse(C);if(this.isHorizontal){this.startX=lMouseX;this.oldWidth=getObjWidth(this.prevElem);this.oldCanGrowHorizontal=B.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);this.oldCanShrinkHorizontal=B.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);}else{this.startY=lMouseY;this.oldHeight=getObjHeight(this.prevElem);this.oldCanGrow=B.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_GROW);this.oldCanShrink=B.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_SHRINK);}this.oldHideIfEmpty=B.getAttValue(this.prevElem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondrag");this.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondragend(e); }");}this.ondrag(C);}catch(A){microstrategy.errors.log(A);}return false;};mstrFixedPanel.prototype.ondrag=function(F){try{if(!F){F=window.event;}if(F.e){F=F.e;}getMouse(F);if(this.isHorizontal){var C=lMouseX-this.startX;var E=this.getOldWidth()+C;if(E>=0){if(this.ruler!=null){this.ruler.style.width=E+"px";}this.prevElem.style.width=E+"px";this.oldWidth=E;this.startX=lMouseX;}}else{var A=lMouseY-this.startY;var B=this.getOldHeight()+A;if(B>=0){if(this.ruler!=null){this.ruler.style.height=B+"px";}this.prevElem.style.height=B+"px";this.oldHeight=B;this.startY=lMouseY;}}}catch(D){microstrategy.errors.log(D);}return false;};mstrFixedPanel.prototype.ondragend=function(C){try{if(!C){C=window.event;}if(C.e){C=C.e;}getMouse(C);var B=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.parentBone.parentBone.parentBone.formattingAttributes;var D=this.id;if(this.isHorizontal){this.resizeWidth(parseInt(microstrategy.styleObj.getValue(this.prevElem,"width")),true,null);if(B&&D){B[D][microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL]=microstrategy.FALSE;B[D][microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL]=microstrategy.FALSE;}}else{this.resize(parseInt(microstrategy.styleObj.getValue(this.prevElem,"height")),true,null);if(B&&D){B[D][microstrategy.HTMLATTR_CAN_SHRINK]=microstrategy.FALSE;B[D][microstrategy.HTMLATTR_CAN_GROW]=microstrategy.FALSE;B[D][microstrategy.HTMLATTR_HIDE_IF_EMPTY]=microstrategy.FALSE;}}this.onmouseup(C);if(this.isHorizontal){this.oldWidth=getObjWidth(this.elem);}else{this.oldHeight=getObjHeight(this.elem);}}catch(A){microstrategy.errors.log(A);}return false;};mstrFixedPanel.prototype.onmouseup=function(B){try{if(typeof (mstr)!="undefined"){this.detachWinListener(this,"mousemove");this.detachWinListener(this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(A){microstrategy.errors.log(A);}return false;};mstrFixedPanel.prototype.resizeEverySubSection=function(B,F,A,C,G){try{var D=mstrFormatObject.encodeValue("height",B);if(this.isHorizontal){this.updateHorizontalContainerHeight(F,B);}else{F.style.height=B+"px";this.parentBone.parentBone.resizeSubMaskForSib(this.parentBone.id,this.id,B,C,"height");if(B>0){this.parentBone.parentBone.hideSubMaskForSib(this.parentBone.id,this.id,false,C);}if(A){if(G){microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT,D);}this.oldHeight=getObjHeight(this.elem);if(this.resizeTimer){window.clearTimeout(this.resizeTimer);}this.resizeTimer=window.setTimeout(function(){microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");},0);}}}catch(E){microstrategy.errors.log(E);}};mstrFixedPanel.prototype.resizeEverySubSectionWidth=function(F,E,A,B){try{var C=mstrFormatObject.encodeValue("width",F);E.style.width=F+"px";if(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){}this.parentBone.parentBone.resizeSubMaskForSib(this.parentBone.id,this.id,F,B,"width");if(F>0){this.parentBone.parentBone.hideSubMaskForSib(this.parentBone.id,this.id,false,B);}if(A){microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_WIDTH,C);this.oldwidth=getObjWidth(this.elem);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}}catch(D){microstrategy.errors.log(D);}};mstrFixedPanel.prototype.simpleWidthResize=function(D){try{var A=mstrFormatObject.encodeValue("width",D);for(var B=0;B<this.sibs.length;B++){this.sibs[B].style.width=D+"px";}this.parentBone.parentBone.resizeSubMask(this.parentBone.id,this.id,D-this.getOldWidth(),"width");if(D>0){this.parentBone.parentBone.hideSubMask(this.parentBone.id,this.id,false);}microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_WIDTH,A);this.oldWidth=getObjWidth(this.elem);this.parentBone.parentBone.parentBone.resize100WMObjects(this.id);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}catch(C){microstrategy.errors.log(C);}};mstrFixedPanel.prototype.updateHorizontalContainerHeight=function(K,A){try{var I=null;var D=microstrategy.findAncestorWithAtt(K,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(D){D.style.height=A+"px";I=microstrategy.findBone(D);}if(I){var H=Math.max(I.height,A);I.height=H;hcTitle=microstrategy.findChildrenWithAtt(D,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);if(hcTitle){for(var F=0,C=hcTitle.length;F<C;F++){hcTitle[F].style.height=H+"px";if(mstr.utils.ISFF3_5){var J=hcTitle[F].firstChild;J.style.display="block";J.style.MozTransform="rotate(-90deg)";J.style.height=H+"px";J.style.width=H+"px";var B=J.firstChild;if(B&&B.tagName&&B.tagName.toLowerCase()=="img"){B.setAttribute("style","float: right");B.style.MozTransform="rotate(90deg)";}}}}if(mstr.utils.ISIE8){var G=microstrategy.findChildrenWithAtt(D,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE);if(G){for(var F=0,C=G.length;F<C;F++){G[F].style.height=H+"px";}}}}}catch(E){microstrategy.errors.log(E);}};mstrFixedPanel.prototype.simpleResize=function(A){try{var C=mstrFormatObject.encodeValue("height",A);for(var B=0;B<this.sibs.length;B++){if(this.isHorizontal){this.updateHorizontalContainerHeight(this.sibs[B],A);}else{this.sibs[B].style.height=A+"px";this.sibs[B].parentNode.firstChild.style.height=A+"px";}}if(!this.isHorizontal){this.doc.resizeSubMask(this.parentBone.id,this.id,A-this.getOldHeight(),"height");if(A>0){this.doc.hideSubMask(this.parentBone.id,this.id,false);}microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT,C);this.oldHeight=getObjHeight(this.elem);this.doc.parentBone.resize100HMObjects(this.id);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}}catch(D){microstrategy.errors.log(D);}};mstrFixedPanel.prototype.resize=function(A,G,P){try{var L=mstrFormatObject;var B=microstrategy.styleObj;var J=L.encodeValue("height",A);var M=L.encodeValue("height",this.getOldHeight());if(this.isHorizontal){var C=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(C){var E=microstrategy.findBone(C);E.oldHeight=M;}}var D=[B.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];this.simpleResize(A);var N=(P!=null);if(G||N){var K=microstrategy.bones.rwb_viewer.updateManager;if(!N){var P=new Array();}}if(P){var O=new Object();O.subsectionHeight=true;var H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+J;var I=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+M;O.origValue=[B.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];O.cachedOldValue=D;P.push(K.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H],[mstrUpdateManager.UPDATE_LATER,I],O));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrow"+mstrUpdateManager.UNIT_SEPARATOR+"0";I=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrow"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanGrow;P.push(K.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H],[mstrUpdateManager.UPDATE_LATER,I],O));H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrink"+mstrUpdateManager.UNIT_SEPARATOR+"0";I=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrink"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanShrink;P.push(K.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H],[mstrUpdateManager.UPDATE_LATER,I],O));H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+"0";I=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+this.oldHideIfEmpty;P.push(K.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H],[mstrUpdateManager.UPDATE_LATER,I],O));}if(!N&&G&&P.length>0){K.add(P);}}this.applyGradient();return(N)?P:null;}catch(F){microstrategy.errors.log(F);return P;}};mstrFixedPanel.prototype.resizeWidth=function(G,E,N){try{var J=mstrFormatObject;var B=microstrategy.styleObj;var K=J.encodeValue("width",G);var A=J.encodeValue("width",this.getOldWidth());var C=[B.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];this.simpleWidthResize(G);var L=(N!=null);if(E||L){var I=this.parentBone.parentBone.parentBone.updateManager;if(!L){var N=new Array();}}this.parentBone.parentBone.updateLayoutWidth(N,false);if(N){var M=new Object();M.subsectionWidth=true;var F=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+K;var H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+A;M.origValue=[B.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];M.cachedOldValue=C;N.push(I.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,F],[mstrUpdateManager.UPDATE_LATER,H],M));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){F=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrowHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+"0";H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrowHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanGrow;N.push(I.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,F],[mstrUpdateManager.UPDATE_LATER,H],M));F=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrinkHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+"0";H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrinkHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanShrink;N.push(I.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,F],[mstrUpdateManager.UPDATE_LATER,H],M));F=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+"0";H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+this.oldHideIfEmpty;N.push(I.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,F],[mstrUpdateManager.UPDATE_LATER,H],M));}if(!L&&E&&N.length>0){I.add(N);}}return(L)?N:null;}catch(D){microstrategy.errors.log(D);return N;}};mstrFixedPanel.prototype.changeSubHeight=function(A,G,Q){try{var L=microstrategy.getFormatObject();var B=microstrategy.styleObj;var J=L.encodeValue("height",A);var N=L.encodeValue("height",this.getOldHeight());var E=[B.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];if(this.isHorizontal){var C=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(C){var D=microstrategy.findBone(C);D.oldHeight=N;}}this.simpleResize(A);var O=(Q!=null);if(G||O){var K=this.parentBone.parentBone.parentBone.updateManager;if(!O){var Q=new Array();}}if(Q){var P=new Object();P.subsectionHeight=true;var H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+J;var I=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+N;var M=[J,B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];P.origValue=M;P.cachedOldValue=E;Q.push(K.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H],[mstrUpdateManager.UPDATE_LATER,I],P));if(!O&&G&&Q.length>0){K.add(Q);}}return(O)?Q:null;}catch(F){microstrategy.errors.log(F);return Q;}};mstrFixedPanel.prototype.changeSubWidth=function(G,E,N){try{var J=mstrFormatObject;var B=microstrategy.styleObj;var K=J.encodeValue("width",G);var A=J.encodeValue("width",this.getOldWidth());var C=[B.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];this.simpleWidthResize(G);var L=(N!=null);if(E||L){var I=this.parentBone.parentBone.parentBone.updateManager;if(!L){var N=new Array();}}this.parentBone.parentBone.updateLayoutWidth(N);if(N){var M=new Object();M.subsectionWidth=true;var F=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+K;var H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+A;M.origValue=C;M.cachedOldValue=C;N.push(I.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,F],[mstrUpdateManager.UPDATE_LATER,H],M));if(!L&&E&&N.length>0){I.add(N);}}this.applyGradient();return(L)?N:null;}catch(D){microstrategy.errors.log(D);return N;}};mstrFixedPanel.prototype.hide=function(){try{this.elem.style.display="none";this.container.style.display="none";if(this.parentBone.parentBone.parentBone.rulerOn&&this.ruler){this.ruler.style.display="none";}this.parentBone.parentBone.hideSubMask(this.parentBone.id,this.id,true);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}catch(A){microstrategy.errors.log(A);return false;}};mstrFixedPanel.prototype.show=function(){try{this.elem.style.display="block";this.container.style.display="block";if(this.parentBone.parentBone.parentBone.rulerOn){if(this.ruler){this.ruler.style.display="block";}}this.parentBone.parentBone.hideSubMask(this.parentBone.id,this.id,false);var D=microstrategy.findChildrenWithAtt(this.elem,"SPAN","sty",8);for(var B=0;B<D.length;B++){var A=microstrategy.findBone(D[B]);if(A&&A.onSubSectionShow){A.onSubSectionShow();}}microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");this.applyGradient();}catch(C){microstrategy.errors.log(C);return false;}};mstrFixedPanel.prototype.turnOffRulerShade=function(){try{if(this.rulerShade){this.rulerShade.style.height="0px";this.rulerShade.style.left="0px";this.rulerShade.style.top="0px";}}catch(A){microstrategy.errors.log(A);}};mstrFixedPanel.prototype.turnOnRulerShade=function(A){try{if(this.rulerShade){this.rulerShade.style.height=(A.bottom-A.top+3)+"px";this.rulerShade.style.left="0px";}}catch(B){microstrategy.errors.log(B);}};mstrFixedPanel.prototype.dragRulerShade=function(B){try{if(this.rulerShade){this.rulerShade.style.top=B+"px";}}catch(A){microstrategy.errors.log(A);}};mstrFixedPanel.prototype.insertSubSectionAbove=function(){try{var A=this.parentBone.parentBone.parentBone.updateManager;A.add([A.createActionObject(this.elem,mstrUpdateManager.ADD_SUBSECTION,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048007","2048101","2048102"],[mstrUpdateManager.UPDATE_LATER,this.parentBone.id,this.id,"before"],[])]);A.flushAndSubmitChanges();}catch(B){microstrategy.errors.log(B);}};mstrFixedPanel.prototype.resizeRuler=function(A){try{if(this.ruler){this.ruler.style.height=A+"px";}}catch(B){microstrategy.errors.log(B);}};mstrFixedPanel.prototype.insertSubSectionBelow=function(){try{var A=this.parentBone.parentBone.parentBone.updateManager;A.add([A.createActionObject(this.elem,mstrUpdateManager.ADD_SUBSECTION,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048007","2048101","2048102"],[mstrUpdateManager.UPDATE_LATER,this.parentBone.id,this.id,"after"],[])]);A.flushAndSubmitChanges();}catch(B){microstrategy.errors.log(B);}};mstrFixedPanel.prototype.deleteSubSection=function(){try{var A=this.parentBone.parentBone.parentBone.updateManager;if(this.parentBone.getSubsectionCount()>1){A.add([A.createActionObject(this.elem,mstrUpdateManager.REMOVE_SUBSECTION,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048041"],[mstrUpdateManager.UPDATE_LATER,this.id],[])]);A.flushAndSubmitChanges();}}catch(B){microstrategy.errors.log(B);}};mstrFixedPanel.prototype.adjustSubsectionWidth=function(A){try{var I=mstrFormatObject;var C=microstrategy.styleObj;var B=parseFloat(I.decodeValue("width",C.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH)));var H=B;if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){var G=C.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);if(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.IGNORE_RESIZE){var M=C.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);var D=C.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);var L=parseInt(I.decodeValue("width",C.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH)));this.isCanGrowCanShrinkHorizontal=true;if((D==microstrategy.FALSE&&M==microstrategy.FALSE)||microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE){this.isCanGrowCanShrinkHorizontal=false;}if(this.needToUpdateMaxContentHeight){this.calcMaxContentHeight();this.setNeedToUpdateMaxContentHeight(false);}if(!this.isCanGrowCanShrinkHorizontal){if(A&&H>=0){this.simpleWidthResize(H);}return true;}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&G!=microstrategy.FALSE&&!this.calcHasObjects()){H=0.001;this.simpleWidthResize(H);return true;}var K=false;for(var F=0;F<this.sibs.length;F++){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION&&G!="0"&&!this.containsDocObject(this.sibs[F])){H=0.001;this.resizeEverySubSectionWidth(H,this.sibs[F],(F==this.sibs.length),F);K=true;continue;}var J=(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION)?this.sibsWidth[F]:this.maxContentWidth;if(L<B&&L!="0"){L=B;}if(J==B){if(!A){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){return true;}else{continue;}}}else{if(D=="-1"&&J>B){if(L=="0"){H=J;}else{if(L>J){H=J;}else{H=L;}}}else{if(M=="-1"){if((microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION&&!this.containsDocObject(this.sibs[F]))||(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&!this.calcHasObjects())){H=0.001;}else{if(J<B){H=(J==-1)?0.001:J;}}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){break;}if(H>=0&&microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){this.resizeEverySubSectionWidth(H,this.sibs[F],F==this.sibs.length-1,F);K=true;}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){if(H>=0){this.simpleWidthResize(H);}}else{if(K){this.parentBone.parentBone.parentBone.resize100WMObjects(this.id);}}}else{if(H>=0){this.simpleWidthResize(H);}}}else{if(H>=0){this.simpleWidthResize(H);}}}catch(E){microstrategy.errors.log(E);}};mstrFixedPanel.prototype.resizeSubsection=function(B){try{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;this.setNeedToUpdateMaxContentHeight(true);this.adjustSubsectionHeight(false);if(this.isHorizontal){this.adjustSubsectionWidth(false);}}catch(A){microstrategy.errors.log(A);}};mstrFixedPanel.prototype.adjustSubsectionHeight=function(A){try{var K=microstrategy.getFormatObject();var E=microstrategy.styleObj;var O=Math.round(parseFloat(K.decodeValue("height",E.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT))));var B=O;var F=parseInt(E.getValue(this.elem,"height"));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){var I=E.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);if(microstrategy.bones.rwb_viewer.layoutHeightMode==0){var L,D;if(this.isHorizontal){var C=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);L=E.getAttValue(C,microstrategy.HTMLATTR_CAN_SHRINK);D=E.getAttValue(C,microstrategy.HTMLATTR_CAN_GROW);}L=L!=undefined?L:E.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK);D=D!=undefined?D:E.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW);var J=parseInt(K.decodeValue("height",microstrategy.styleObj.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT)));this.isCanGrowCanShrink=true;if((D==microstrategy.FALSE&&L==microstrategy.FALSE&&I==microstrategy.FALSE)){this.isCanGrowCanShrink=false;}if(this.needToUpdateMaxContentHeight){this.calcMaxContentHeight();this.setNeedToUpdateMaxContentHeight(false);}if(!this.isCanGrowCanShrink||A){if((A&&B>=0)||this.isHorizontal){this.simpleResize(B);}return true;}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&I!=microstrategy.FALSE&&!this.calcHasObjects()){B=0.001;this.simpleResize(B);return true;}if(!this.isCanGrowCanShrink&&I==microstrategy.FALSE){if(A&&B>=0&&B!=F){this.simpleResize(B);return true;}}var N=false;for(var H=0;H<this.sibs.length;H++){B=O;if(microstrategy.bones.rwb_viewer.layoutHeightMode==0&&I!=microstrategy.FALSE&&!this.containsDocObject(this.sibs[H])){B=0.001;this.resizeEverySubSection(B,this.sibs[H],(H==this.sibs.length-1),H,A);N=true;continue;}var M=(microstrategy.bones.rwb_viewer.layoutHeightMode==0&&this.sibsHeight)?this.sibsHeight[H]:this.maxContentHeight;if(J<O&&J!=microstrategy.FALSE){J=O;}if(M==O){if(!A){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){return true;}else{if(this.isHorizontal&&H==this.sibs.length-1){this.simpleResize(B);continue;}else{continue;}}}}else{if((D==microstrategy.TRUE||(I==microstrategy.TRUE&&this.forceGrowOnResize))&&M>O){if(J==microstrategy.FALSE){B=M;}else{if(J>M){B=M;}else{B=J;}}}else{if(L==microstrategy.TRUE){if((microstrategy.bones.rwb_viewer.layoutHeightMode==0&&!this.containsDocObject(this.sibs[H]))||(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&!this.calcHasObjects())){B=0.001;}else{if(M<O){B=(M==-1)?0.001:M;}}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){break;}if(B>=0&&microstrategy.bones.rwb_viewer.layoutHeightMode==0){if(B!=O){this.resizeEverySubSection(B,this.sibs[H],H==this.sibs.length-1,H,A);N=true;}else{if(this.isHorizontal){this.updateHorizontalContainerHeight(this.sibs[H],B);}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){if(B>=0){this.simpleResize(B);}}else{if(N){microstrategy.bones.rwb_viewer.resize100HMObjects(this.id);}}}else{if(B>=0){this.simpleResize(B);}}}else{if(B>=0){this.simpleResize(B);}}}catch(G){microstrategy.errors.log(G);}};mstrFixedPanel.prototype.getRightMostPos=function(){try{var A=0;var F=microstrategy.styleObj;if(this.elem&&this.elem.childNodes&&!this.isHorizontal){for(var B=0;B<this.elem.childNodes.length;B++){var H=this.elem.childNodes[B];if(H.nodeType==1){if(H.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var G=F.getAttValue(H,microstrategy.HTMLATTR_WIDTH_MODE);if(G==microstrategy.FIX_MODE){var D=microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE?parseInt(F.getValue(H,"width",microstrategy.FORMAT_TYPE_MAIN)):H.scrollWidth;A=Math.max(parseInt(F.getValue(H,"left",microstrategy.FORMAT_TYPE_MAIN))+D,A);}else{if(G==microstrategy.AUTO_MODE){var C=H.style.display;H.style.display="block";A=Math.max(parseInt(F.getValue(H,"left",microstrategy.FORMAT_TYPE_MAIN))+H.scrollWidth,A);H.style.display=C;}}}}}}return A;}catch(E){microstrategy.errors.log(E);return -1;}};mstrFixedPanel.prototype.checkForResize=function(C){try{var B=microstrategy.findAncestorWithAtt(C,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE);if(B){var D=null;if(this.isHorizontal){this.prevElem=B.parentNode.previousSibling.lastChild.lastChild;D=microstrategy.findChildWithAtt(B.parentNode.nextSibling,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);}else{this.prevElem=B.previousSibling.lastChild;D=microstrategy.findChildWithAtt(B.nextSibling,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);}if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondragstart");this.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondragstart(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}if(D){this.doc.selections.addSubSection(D);}}}catch(A){microstrategy.errors.log(A);return ac;}};function mstrFixedPanel(A){this.inherits=mstrSubSection;this.inherits(A);this.inherits=null;return this;}mstrDocSectionImpl.prototype=new mstrBoneImpl();mstrDocSectionImpl.prototype.path="";mstrDocSectionImpl.prototype.verifiedPath="";mstrDocSectionImpl.prototype.sibs=null;mstrDocSectionImpl.prototype.prevSec=null;mstrDocSectionImpl.prototype.currentSec=null;mstrDocSectionImpl.prototype.isCollapsed=false;mstrDocSectionImpl.prototype.isDetails=false;mstrDocSectionImpl.prototype.isHorizontal=false;mstrDocSectionImpl.prototype.isBeginHorizontal=false;mstrDocSectionImpl.prototype.prevRuler=null;mstrDocSectionImpl.prototype.groupID=null;mstrDocSectionImpl.prototype.onload=function(B){try{this.initBone();this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.sibs=document.getElementsByName(this.id);this.initSection();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSectionImpl.prototype.syncPosition=function(){try{for(var B in this.subsections){if(this.subsections[B].syncPosition){this.subsections[B].syncPosition();}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSectionImpl.prototype.onmousedown=function(T){try{if(!T){T=window.event;}var I=getEventTarget(T);var F=this.parentBone.parentBone;var H=F.updateManager;var S=mstrFormatObject;var K=[];this.currentSec=microstrategy.findAncestorWithAtt(I,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION);var Q=microstrategy.eventManager.getSource(T);if(!F.isEditableViewModeEplus()){return ;}if(this.isHorizontal){if(!this.isBeginHorizontal){this.prevSec=this.currentSec.parentNode.previousSibling.firstChild;}}else{var R=0;if(this.currentSec){var W=this.parentBone.elem;for(R=0;R<W.childNodes.length;R++){if(this.currentSec==W.childNodes[R]){break;}}}if(R>0){this.prevSec=this.parentBone.elem.childNodes[R-1];}if(microstrategy.styleObj.getAttValue(this.prevSec,microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_DOC_SECTION&&microstrategy.styleObj.getAttValue(this.prevSec,microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_PARENT_HORIZONTAL_CONTAINER){var O=microstrategy.findChildWithAtt(this.prevSec,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(O){var U=microstrategy.findBone(O);this.prevSec=U.getLastNonCollapsedSection();}}}var P=microstrategy.findChildWithAtt(this.currentSec,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);if(I.tagName=="IMG"){var X=I.src.substr(I.src.lastIndexOf("/")+1);var A=(X=="treeCollapse.gif")?"0":"-1";this.toggleSections(A,I);var N,L;if(A=="-1"){L="-1";N="0";}else{L="0";N="-1";}if(H){var C={};C.source=I;var M=document.getElementById(this.id);var V=M.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+S.expanded[mstrFormatObject.PROP_SET]+mstrUpdateManager.UNIT_SEPARATOR+S.expanded[mstrFormatObject.PROP_NAME]+mstrUpdateManager.UNIT_SEPARATOR;K.push(H.createActionObject(M,mstrUpdateManager.EDIT_PROPS,F.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,V+L+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,V+N+mstrUpdateManager.ITEM_SEPARATOR],C));for(var J in this.subsections){M=this.subsections[J].elem;V=this.subsections[J].id+mstrUpdateManager.UNIT_SEPARATOR+S.expanded[mstrFormatObject.PROP_SET]+mstrUpdateManager.UNIT_SEPARATOR+S.expanded[mstrFormatObject.PROP_NAME]+mstrUpdateManager.UNIT_SEPARATOR;K.push(H.createActionObject(M,mstrUpdateManager.EDIT_PROPS,F.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,V+L+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,V+N+mstrUpdateManager.ITEM_SEPARATOR],C));}H.add(K,true);}if(P){this.parentBone.selections.addSubSection(P);}}else{if(Q&&Q.button==2){if(P){var B=microstrategy.findBone(P);if(B){B.onmousedown(T);}}}else{var G=false;if(this.isHorizontal){if(!this.isBeginHorizontal){G=true;}}else{if(this.currentSec.previousSibling!=this.currentSec.parentNode.firstChild){G=true;}}if(G){var D=microstrategy.findAncestorWithAtt(I,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);if(D){if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondragstart");this.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondragstart(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}}}if(P){this.parentBone.selections.addSubSection(P);}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrDocSectionImpl.prototype.ondragstart=function(D){try{if(!D){D=window.event;}if(D.e){D=D.e;}getMouse(D);if(this.currentSec){var C=this.parentBone.elem;var E=microstrategy.objectListFind(this.prevSec,["DIV"],microstrategy.OBJTYPE_DOC_SUBSECTION_CONTAINER);if(E==null||E.length==0){return true;}var A=E[E.length-1];this.prevSubElem=A.lastChild;this.prevRuler=A.firstChild;this.prevSubBone=microstrategy.findBone(this.prevSubElem);if(this.prevSubBone){if(this.isHorizontal){this.prevSubBone.oldwidth=getObjWidth(this.prevSubElem);this.prevSubBone.oldCanGrowHorizontal=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);this.prevSubBone.oldCanShrinkHorizontal=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);}else{this.prevSubBone.oldHeight=getObjHeight(this.prevSubElem);this.prevSubBone.oldCanGrow=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_GROW);this.prevSubBone.oldCanShrink=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_SHRINK);}this.prevSubBone.oldHideIfEmpty=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);}if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondrag");this.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondragend(e); }");}this.ondrag(D);}}catch(B){microstrategy.errors.log(B);}return false;};mstrDocSectionImpl.prototype.ondrag=function(I){try{if(!I){I=window.event;}if(I.e){I=I.e;}getMouse(I);if(this.isHorizontal){var F=0;if(this.prevSubElem){var B=lMouseX+F-getObjSumLeft(this.currentSec);var E=getObjWidth(this.prevSubElem)+B;if(E>=0){this.prevSubElem.style.width=E+"px";}}}else{var D=this.parentBone.parentBone.elem.scrollTop;if(this.prevSubElem){var A=lMouseY+D-getObjSumTop(this.currentSec);var E=getObjHeight(this.prevSubElem)+A;if(E>=0){if(this.prevRuler){this.prevRuler.style.height=E+"px";}if(!this.prevSubBone.isHorizontal){this.prevSubElem.style.height=E+"px";}else{var J=microstrategy.findAncestorWithAtt(this.prevSubElem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);J.style.height=E+"px";var C=microstrategy.findChildrenWithAtt(J,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);if(C){for(var H=0;H<C.length;H++){C[H].style.height=E+"px";}}}}}}}catch(G){microstrategy.errors.log(G);}return false;};mstrDocSectionImpl.prototype.ondragend=function(D){try{if(!D){D=window.event;}if(D.e){D=D.e;}if(this.isHorizontal){this.prevSubBone.resizeWidth(getObjWidth(this.prevSubElem),true,null);}else{if(this.prevSubBone.isHorizontal){this.parentBone.resetHeightOfHorizontalSections(this.prevSubBone);}this.prevSubBone.resize(getObjHeight(this.prevSubElem),true,null);if(this.prevSubBone.isHorizontal){this.parentBone.synchHeightOfHorizontalSections(this.prevSubBone);}}var B=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.parentBone.parentBone.formattingAttributes;var C=this.isHorizontal&&this.prevSubBone.isHorizontal;var F=this.prevSubBone.id;if(B&&F){if(C){B[F][microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL]=microstrategy.FALSE;B[F][microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL]=microstrategy.FALSE;}else{if(this.prevSubBone.isHorizontal){var E=microstrategy.findAncestorWithAtt(this.prevSubBone.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(E){E.setAttribute(microstrategy.HTMLATTR_CAN_GROW,microstrategy.FALSE);E.setAttribute(microstrategy.HTMLATTR_CAN_SHRINK,microstrategy.FALSE);B[F][microstrategy.HTMLATTR_HIDE_IF_EMPTY]=microstrategy.FALSE;}}else{B[F][microstrategy.HTMLATTR_CAN_SHRINK]=microstrategy.FALSE;B[F][microstrategy.HTMLATTR_CAN_GROW]=microstrategy.FALSE;B[F][microstrategy.HTMLATTR_HIDE_IF_EMPTY]=microstrategy.FALSE;}}}this.onmouseup(D);}catch(A){microstrategy.errors.log(A);}return false;};mstrDocSectionImpl.prototype.onmouseup=function(B){try{if(typeof (mstr)!="undefined"){this.detachWinListener(this,"mousemove");this.detachWinListener(this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(A){microstrategy.errors.log(A);}return false;};mstrDocSectionImpl.prototype.toggleSections=function(D){try{var B=microstrategy.subObjectFind(this.elem,["IMG"],"cimg");if(D=="0"){for(var C in this.subsections){this.subsections[C].hide();}B.src=microstrategy.FOLDER_IMAGES+"treeExpand.gif";this.isCollapsed=true;}else{for(var C in this.subsections){this.subsections[C].show();}B.src=microstrategy.FOLDER_IMAGES+"treeCollapse.gif";this.isCollapsed=false;}if(this.parentBone.selections){this.parentBone.selections.clear();}}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSectionImpl.prototype.initSection=function(){try{var C=null;var I=microstrategy.getViewerBone();if(I.isEditableViewModeEplus()){C=microstrategy.subObjectFind(this.elem,["IMG"],"cimg");}var F=(C!=null&&C.src.indexOf("treeExpand.gif")>-1);this.isCollapsed=F;var G="";this.subsectionLength=0;var B=this.parentBone.subSectionsInSection[this.id].split(",");this.groupID=microstrategy.styleObj.getAttValue(this.elem,"group");if(this.elem&&this.elem.childNodes){this.isBeginHorizontal=(microstrategy.styleObj.getAttValue(this.elem,microstrategy.HTMLATTR_IS_BEGIN_HORIZONTAL)=="-1");for(var E=0;E<B.length;E++){var A=B[E];if(A&&A!=""&&typeof (this.subsections[A])=="undefined"){var J=new mstrFixedPanel(A);J.parentBone=this;J.path=this.path+".subsections['"+A+"']";if(J.onload){J.onload();}this.isDetails=J.isDetails;this.isHorizontal=J.isHorizontal;this.subsections[A]=J;if(G!=""){this.subsections[G].nextSibling=A;}G=A;this.subsectionLength++;}}if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){if(F){for(var H in this.subsections){this.subsections[H].hide();}}else{for(var H in this.subsections){this.subsections[H].show();}}}}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocSectionImpl.prototype.getRightMostPos=function(){try{var A=0;for(var B in this.subsections){A=Math.max(this.subsections[B].getRightMostPos(),A);}return A;}catch(C){microstrategy.errors.log(C);return -1;}};mstrDocSectionImpl.prototype.getSubsectionCount=function(){try{return this.subsectionLength;}catch(A){microstrategy.errors.log(A);return null;}};mstrDocSectionImpl.prototype.setCursor=function(C){try{for(var A=0;A<this.sibs.length;A++){this.sibs[A].style.cursor=C;}}catch(B){microstrategy.errors.log(B);}};mstrDocSectionImpl.prototype.getChildBone=function(B){try{if(B.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){if(B.getAttribute("id") in this.subsections&&this.subsections[B.getAttribute("id")].isLoaded){return this.subsections[B.getAttribute("id")];}}return null;}catch(A){microstrategy.errors.log(A);return null;}};function mstrDocSectionImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;this.subsections={};return this;}mstrPanelStackScript=true;mstrPanelStack.prototype=new mstrRWUnitBoneImpl();mstrPanelStack.prototype.type=microstrategy.OBJTYPE_PANEL_STACK;mstrPanelStack.prototype.titleBars=null;mstrPanelStack.prototype.containers=null;mstrPanelStack.prototype.panels=null;mstrPanelStack.prototype.renderedPanels=null;mstrPanelStack.prototype.dirtyKeys=null;mstrPanelStack.prototype.panelMap=null;mstrPanelStack.prototype.docViewer=null;mstrPanelStack.prototype.currentPanelId=-1;mstrPanelStack.prototype.currentTbElem=null;mstrPanelStack.prototype.mouseTimer=null;mstrPanelStack.prototype.isTitleVisible=true;mstrPanelStack.prototype.titleBarDisplay=1;mstrPanelStack.prototype.customTitle="";mstrPanelStack.prototype.PREVIOUS_DIR=0;mstrPanelStack.prototype.NEXT_DIR=mstrPanelStack.CURRENT_PANEL;mstrPanelStack.prototype.disabled=false;mstrPanelStack.prototype.selectedTarget=null;mstrPanelStack.prototype.selectedLevel=null;mstrPanelStack.prototype.shadowContainer=null;mstrPanelStack.prototype.panelStackKeyContext="";mstrPanelStack.prototype.isFilterPanel=false;mstrPanelStack.prototype.commands=null;mstrPanelStack.prototype.elemTagName="span";mstrPanelStack.FMT_TYPE_TITLE="2";mstrPanelStack.heightAndWidthAttMap={hm:"heightMode",wm:"widthMode",ht:"height",wd:"width"};mstrPanelStack.CURRENT_PANEL=0;mstrPanelStack.CUSTOM_TITLE=1;mstrPanelStack.prototype.onload=function(){try{mstrRWUnitBoneImpl.prototype.onload.call(this);if(this.elem){this.resetDomObjects();this.panels=this.panels||[];this.panelMap=this.panelMap||{};var B=this.getDocViewer();var E=B&&B.doc;if(!E){return ;}var A=E.styleObj;if(A){this.isTitleVisible=A.getAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE;this.titleBarDisplay=A.getAttValue(this.elem,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY);this.customTitle=(A.getAttValue(this.elem,microstrategy.HTMLATTR_WINDOW_TITLE))?A.getAttValue(this.elem,microstrategy.HTMLATTR_WINDOW_TITLE):"";this.isLocked=A.getAttValue(this.elem,microstrategy.HTMLATTR_LOCKED)==microstrategy.TRUE;this.isFilterPanel=A.getAttValue(this.elem,microstrategy.HTMLATTR_USE_AS_FILTER_PANEL)==microstrategy.TRUE;}this.toggleTitleBars();var D=this.containers[0].childNodes[0];while(D){this.registerPanel(D);D=D.nextSibling;}D=this.getCurrentPanel();this.setCurrentPanel(D.id);this.disabled=false;this.commands=new mstrPanelStackCommandsImpl(this);if(!this.itemFormats){this.itemFormats=new Object();this.itemFormats[mstrPanelStack.FMT_TYPE_TITLE]=B.objProps.createFormatObject(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK,mstrPanelStack.FMT_TYPE_TITLE);}this.resizeContent();this.synchronizeShadow();}}catch(C){microstrategy.errors.log(C);return false;}};mstrPanelStack.prototype.onpostload=function(){try{if(this.isFilterPanel){for(var A=0;A<this.panels.length;A++){this.panels[A].onpostload();}}}catch(B){microstrategy.errors.log(B);}};mstrPanelStack.prototype.resetDomObjects=function(){this.titleBars=document.getElementsByName(this.id+"_toolbar");this.containers=document.getElementsByName(this.id+"_container");};mstrPanelStack.prototype.resetElement=function(){this.elem=document.getElementById(this.id);this.resetDomObjects();for(var A=0;A<this.panels.length;A++){this.panels[A].resetElement();}};mstrPanelStack.prototype.applyGradientOnTitle=function(){try{for(var B=0;B<this.titleBars.length;B++){var A=(this.titleBars[B].getAttribute("gradientcolor"))?this.titleBars[B].getAttribute("gradientcolor").split(","):null;if(A){gradientUtil.applyGradient(this.titleBars[B],A[gradientUtil.GRADIENT_START_COLOR_INDEX],A[gradientUtil.GRADIENT_END_COLOR_INDEX],A[gradientUtil.GRADIENT_ANGLE_INDEX],A[gradientUtil.GRADIENT_XOFFSET_INDEX],A[gradientUtil.GRADIENT_YOFFSET_INDEX]);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrPanelStack.prototype.synchronizeShadow=function(F,G){try{var C=this.getDocViewer().doc.styleObj;F=F?F:C.getAttValue(this.elem,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT);G=G!=undefined?G:C.getAttValue(this.elem,microstrategy.HTMLATTR_DROP_SHADOW);var H=document.getElementById(this.elem.id+"_sh");if(H){H.parentNode.removeChild(H);}this.shadowContainer=null;if(F=="1"){this.shadowContainer=this.elem.cloneNode(false);this.shadowContainer.setAttribute("sty","shw");this.shadowContainer.id=this.elem.id+"_sh";this.shadowContainer.setAttribute("name",this.elem.id+"_sh");this.elem.insertAdjacentElement("afterBegin",this.shadowContainer);this.shadowContainer.style.backgroundColor=C.getValue(this.getCurrentPanel().elem,"backgroundColor");for(var D=0;D<this.elem.childNodes.length;D++){if(this.elem.childNodes[D].nodeType==1){this.elem.childNodes[D].style.zIndex=2;this.elem.childNodes[D].style.position="absolute";}}this.shadowContainer.style.zIndex=1;this.shadowContainer.style.left="-"+C.getValue(this.elem,"borderLeftWidth",microstrategy.FORMAT_TYPE_MAIN);this.shadowContainer.style.top="-"+C.getValue(this.elem,"borderTopWidth",microstrategy.FORMAT_TYPE_MAIN);var B=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,Math.round(G*microstrategy.ZOOM_FACTOR/100));if(mstr.utils.ISDXIE){this.shadowContainer.style.filter="progid:DXImageTransform.Microsoft.dropshadow(Color='#66000000', Positive='true', OffX="+B+", OffY="+B+") ";}else{var A=mstr.utils.ISWK?"webkitBoxShadow":"boxShadow";this.shadowContainer.style[A]=B+"px "+B+"px 3px 0 #888";}}}catch(E){microstrategy.errors.log(E);return false;}};mstrPanelStack.prototype.getItemFormats=function(){try{return this.itemFormats;}catch(A){microstrategy.errors.log(A);return false;}};mstrPanelStack.prototype.getAttValue=function(C,A){try{if(C==mstrPanelStack.FMT_TYPE_TITLE){if(this.titleBars&&this.titleBars.length>0){var D=microstrategy.styleObj.formattingAttributes[this.titleBars[0].getAttribute("id")];if(D!=null&&typeof (D[A])!="undefined"){return D[A];}return this.titleBars[0].getAttribute(A,0);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrPanelStack.prototype.setAttValue=function(E,A,D){try{this.itemFormats[E][A]=D;if(E==mstrPanelStack.FMT_TYPE_TITLE){if(this.titleBars&&this.titleBars.length>0){var G=this.titleBars[0].getAttribute("id");var F=microstrategy.styleObj.formattingAttributes[G];if(typeof (F)=="undefined"){microstrategy.styleObj.formattingAttributes[G]=new Object();microstrategy.styleObj.formattingAttributes[G][A]=D;}else{F[A]=D;}for(var B=0;B<this.titleBars.length;B++){this.titleBars[B].style[mstrPanelStack.heightAndWidthAttMap[A]]=mstrFormatObject.decodeValue(mstrPanelStack.heightAndWidthAttMap[A],D);}}}}catch(C){microstrategy.errors.log(C);}};mstrPanelStack.prototype.getFormatValue=function(B,C){try{if(B!=microstrategy.FORMAT_TYPE_MAIN){B=mstrPanelStack.FMT_TYPE_TITLE;}if(C=="gradientcolor"&&B==mstrPanelStack.FMT_TYPE_TITLE){if(this.titleBars&&this.titleBars.length>0){return this.titleBars[0].getAttribute(C);}return null;}return this.itemFormats[B][C];}catch(A){microstrategy.errors.log(A);return false;}};mstrPanelStack.prototype.setFormatValue=function(E,F,D){try{if(!F){return ;}this.itemFormats[E][F]=D;if(E==mstrPanelStack.FMT_TYPE_TITLE){if(F=="Gradient"){return ;}if(this.titleBars&&this.titleBars.length>0){for(var A=0;A<this.titleBars.length;A++){var B=this.titleBars[A];if(F.indexOf("textDecoration")>-1){B=microstrategy.findChildWithAtt(B,"div",microstrategy.HTMLATTR_ID,"titleBar");}this.getDocViewer().doc.styleObj.formatElem(B,F,D);if(F&&F.toLowerCase()=="backgroundcolor"){this.titleBars[A].setAttribute("bgstyle",(D=="transparent")?1:0);if(this.titleBars[A].getAttribute("gradientcolor")){this.titleBars[A].removeAttribute("gradientcolor");}}}}}}catch(C){microstrategy.errors.log(C);}};mstrPanelStack.prototype.applyGradientOnItem=function(F,B,N,P,M){try{var L;if(this.titleBars&&this.titleBars.length>0){L=this.titleBars[0];}var I;var A;if(L&&F==mstrPanelStack.FMT_TYPE_TITLE){if(L.getAttribute("gradientcolor")==null){I=L.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR;A=M.encodeValue("backgroundColor",this.getFormatValue(F,"backgroundColor"));}else{I=L.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+"Gradient"+mstrUpdateManager.UNIT_SEPARATOR;A=L.getAttribute("gradientcolor");}var O=N.split(",");var K=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("backgroundStyle")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("backgroundStyle")+mstrUpdateManager.UNIT_SEPARATOR;var Q=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR;var H=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("gradientColor")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("gradientColor")+mstrUpdateManager.UNIT_SEPARATOR;var E=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("gradientAngle")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("gradientAngle")+mstrUpdateManager.UNIT_SEPARATOR;var J=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("gradientXOffset")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("gradientXOffset")+mstrUpdateManager.UNIT_SEPARATOR;var C=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertySetName("gradientYOffset")+mstrUpdateManager.UNIT_SEPARATOR+M.getPropertyName("gradientYOffset")+mstrUpdateManager.UNIT_SEPARATOR;if(P){P.push(microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.getDocViewer().beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,Q+M.encodeValue("backgroundColor",N)+mstrUpdateManager.ITEM_SEPARATOR+H+M.encodeValue("gradientColor",N)+mstrUpdateManager.ITEM_SEPARATOR+K+M.encodeValue("backgroundStyle",N)+mstrUpdateManager.ITEM_SEPARATOR+E+O[3]+mstrUpdateManager.ITEM_SEPARATOR+J+O[4]+mstrUpdateManager.ITEM_SEPARATOR+C+O[5]+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,I+A+mstrUpdateManager.ITEM_SEPARATOR]));}for(var G=0;G<this.titleBars.length;G++){this.titleBars[G].setAttribute("bgstyle","2");this.titleBars[G].setAttribute("gradientcolor",N);gradientUtil.applyGradient(this.titleBars[G],O[gradientUtil.GRADIENT_START_COLOR_INDEX],O[gradientUtil.GRADIENT_END_COLOR_INDEX],O[gradientUtil.GRADIENT_ANGLE_INDEX],O[gradientUtil.GRADIENT_XOFFSET_INDEX],O[gradientUtil.GRADIENT_YOFFSET_INDEX],this.getDocViewer().doc.styleObj);}}}catch(D){microstrategy.errors.log(D);return false;}};mstrPanelStack.prototype.onApplyDefaultFormat=function(F){try{var I=this.getDocViewer();var B=I.doc.styleObj;var D=I.objProps;var H;var A;for(var G=0;G<this.panels.length;G++){H=this.panels[G];for(var E=0;E<H.sibs.length;E++){A=H.sibs[E];D.initObjectFormat(A,false,microstrategy.SUBOBJTYPE_DOC_PANEL);}}if(B){this.elem.setAttribute(microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,B.getAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE));this.elem.setAttribute(microstrategy.HTMLATTR_TITLE_BAR_DISPLAY,B.getAttValue(this.elem,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY));this.isTitleVisible=B.getAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE;this.titleBarDisplay=B.getAttValue(this.elem,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY);}this.toggleTitleBars();this.updatePortalTitle(this.customTitle);if(this.titleBars){for(var G=0;G<this.titleBars.length;G++){D.initObjectFormat(this.titleBars[G],false,microstrategy.SUBOBJTYPE_DOC_PANEL_STACK,mstrPanelStack.FMT_TYPE_TITLE);}}this.synchronizeSize();}catch(C){microstrategy.errors.log(C);return false;}};mstrPanelStack.prototype.onSetDefaultFormat=function(){try{var A=this.getDocViewer().objProps;A.setDefaultFormat(this.getCurrentPanel().elem);}catch(B){microstrategy.errors.log(B);return false;}};mstrPanelStack.prototype.toggleTitleBars=function(){try{for(var A=0;A<this.titleBars.length;A++){if(this.isTitleVisible){displayObj(this.titleBars[A]);}else{removeObj(this.titleBars[A]);}}if(this.isTitleVisible){this.applyGradientOnTitle();}}catch(B){microstrategy.errors.log(B);return false;}};mstrPanelStack.prototype.onreload=function(B){try{if(this.disabled||!this.isBoneInPage()){microstrategy.unRegisterBone(this.id);}else{mstrRWUnitBoneImpl.prototype.onreload.call(this);this.onload();this.updateVerticalTextFields();}}catch(A){microstrategy.errors.log(A);return false;}};mstrPanelStack.prototype.isBoneInPage=function(){try{var A=mstrBoneImpl.prototype.isBoneInPage.apply(this,arguments);if(A){var D=getElementById(this.id),B=microstrategy.subObjectType(D);A=(B==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);}return A;}catch(C){microstrategy.errors.log(C);return true;}};mstrPanelStack.prototype.updateVerticalTextFields=function(){var B=this.getDocViewer(),E=B&&B.formattingAttributes&&B.formattingAttributes.tdUnits;if(!bIsDXIE&&E&&this.elem){var C=this.panels,A=function(J,I){var K=microstrategy.styleObj,H=0,G;if(I){if(J.hasOwnProperty(I.id)){H=-parseInt(J[I.id],10);K.changeTextFieldRotation(I,H);}else{if(I.hasChildNodes()){G=I.childNodes.length;for(var F=0;F<G;F++){A(J,I.childNodes[F]);}}}}};for(var D=0;D<C.length;++D){A(E,C[D].elem);}}};mstrPanelStack.prototype.syncToolbarElem=function(E){try{mstrRWUnitBoneImpl.prototype.syncToolbarElem.call(this,E);var A=this.activeRWUnit.getElementsByTagName("div");for(var B=0;B<A.length;B++){if(A[B].getAttribute("scriptclass")){var D=microstrategy.bone(A[B].id);if(D&&D.hasToolbar){D.syncToolbarElem(E);}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrPanelStack.prototype.computeToolbarPos=function(){try{mstrRWUnitBoneImpl.prototype.computeToolbarPos.call(this);if(this.toolbar_pos_x+2<0||this.toolbar_pos_y<0){var A=document.getElementById(this.getCurrentPanel().id);if(A){this.toolbar_pos_x=getObjSumLeft(A)-this.docViewer.doc.left;this.toolbar_pos_y=getObjSumTop(A)-this.docViewer.doc.top;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrPanelStack.prototype.ondocobjectdrag=function(A,E,C){try{for(var B=0;B<this.panels.length;B++){this.panels[B].hideMask();}for(var B in A){if(B==this.id){return ;}if(mstr.utils.Dom.containsElement(A[B],this.elem)){return ;}}this.getCurrentPanel().showMask(C,E);}catch(D){microstrategy.errors.log(D);}};mstrPanelStack.prototype.onmousedown=function(B){try{B=B||window.event;var C=findTarget(getEventTarget(B),microstrategy.HTMLATTR_CMD_ID);if(!C||C.getAttribute(microstrategy.HTMLATTR_CMD_ID)=="tb"){return ;}if((B.which==3)||(B.button==2)){return false;}if(C.getAttribute(microstrategy.HTMLATTR_CMD_ID)=="cm"){this.selectPanelStack(B);this.panelInsertMenu(B);}else{this.selectPanelStack();if(C.className.indexOf("Disabled")==-1){switch(C.getAttribute(microstrategy.HTMLATTR_CMD_ID)){case"ap":this.addPanel();break;case"dp":this.duplicatePanel();break;case"pp":this.moveCurrentPanel(this.PREVIOUS_DIR);break;case"np":this.moveCurrentPanel(this.NEXT_DIR);break;case"rp":this.removePanel();break;case"mpp":this.movePanel(this.PREVIOUS_DIR);break;case"mpn":this.movePanel(this.NEXT_DIR);break;case"rnp":this.renamePanel();break;case"pim":this.panelInsertMenu(B);break;}}}B.cancelBubble=true;return false;}catch(A){microstrategy.errors.log(A);}};mstrPanelStack.prototype.selectPanelStack=function(E){try{var A=microstrategy.getViewerBone();var D="select";if(E&&E.ctrlKey){D=D+"_multiple";}var F=this.elem.id;var B=this.elem.getAttribute("sty");A.commands.exec(D,(F+"|"+B));}catch(C){microstrategy.errors.log(C);}};mstrPanelStack.prototype.renamePanel=function(){try{var A=microstrategy.getViewerBone();A.commands.exec("rnp");}catch(B){microstrategy.errors.log(B);}};mstrPanelStack.prototype.panelInsertMenu=function(D){try{var C=getEventTarget(D);var F=microstrategy.getViewerBone();if(C.getAttribute(microstrategy.HTMLATTR_CMD_ID)=="cm"){C=C.parentNode;}var A=getObjSumLeft(C)-getObjSumLeft(F.elem);var E=getObjSumTop(C)+getObjHeight(C)-getObjSumTop(F.elem);if(C.getClientRects||C.getBoundingClientRect){A+=F.elem.scrollLeft;}mstr.controllers.EventManager.notifyWindowListeners({name:"closeMenus"});microstrategy.setJLSCXMenuOpen(true);if(this.isFilterPanel){microstrategy.openBlockLoaderEditor("addToFilterPanelMenu","InsertMenuBlockLoader",null,{cssText:"position:absolute;top:"+E+"px;left:"+A+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",useFixedPosition:"false",contextMenuName:"insertSelector"},this,null,F.elem);}else{microstrategy.openBlockLoaderEditor("addToPanelMenu","InsertMenuBlockLoader",null,{cssText:"position:absolute;top:"+E+"px;left:"+A+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",useFixedPosition:"false",contextMenuName:"insertPanel"},this,null,F.elem);}}catch(B){microstrategy.errors.log(B);}};mstrPanelStack.prototype.removePanel=function(A,N,F){try{var C=true;var E=A;if(!E){E=this.getCurrentPanel().elem;}if(N!=null){C=N;}var G=E.getAttribute("id");var L=this.panelMap[G];var M=(L==this.panels.length-1)?L-1:L;var J,D;for(J=0,D=this.containers.length;J<D;J++){this.containers[J].removeChild(this.containers[J].childNodes[L]);}var B=this.panels.splice(L,1);this.resetPanelMap();if(F){this.setCurrentPanel(F);}else{this.setCurrentPanel(this.panels[M].id);}for(J=0,D=B.length;J<D;J++){B[J].deletePanel();}if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){microstrategy.eventManager.notifyOrphanBones("onRemovePanel",this.id,G,this.panels[M].id);}if(C){var I=new Object();I.panelStackId=this.id;I.panelIndex=L;var K=this.docViewer.updateManager;K.add([K.createActionObject(E,mstrUpdateManager.REMOVE_PANEL,this.docViewer.beanPath,["2048018","2048012"],[mstrUpdateManager.UPDATE_LATER,G],[],I)]);}}catch(H){microstrategy.errors.log(H);}};mstrPanelStack.PANEL_FORMATS=["backgroundColor"];mstrPanelStack.prototype.addPanel=function(E,P,M){try{var B=this.getDocViewer();if(!B){return ;}var N=E?true:false;var C=P!=null?P:true;var I;if(N){I=E;}else{I=B.commands.exec("createPanel");}var O=M;if(!N){var L=this.getCurrentPanel().elem;if(L){var A=this.getDocViewer().doc.styleObj;var D;for(var J in mstrPanelStack.PANEL_FORMATS){D=A.getValue(L,mstrPanelStack.PANEL_FORMATS[J]);A.setValue(I,mstrPanelStack.PANEL_FORMATS[J],D);}if(L.getAttribute("gradientcolor")){I.setAttribute("gradientcolor",L.getAttribute("gradientcolor"));I.setAttribute("bgstyle","2");}}}if((typeof (M)=="undefined")||M==null){for(var J=0;J<this.containers.length;J++){if(this.panelMap[this.currentPanelId]==this.containers[J].childNodes.length-1){this.containers[J].appendChild(I);}else{O=this.panelMap[this.currentPanelId]+1;this.containers[J].insertBefore(I,this.containers[J].childNodes[O]);}}}else{if(M==this.panels.length){for(var J=0;J<this.containers.length;J++){this.containers[J].appendChild(I);}}else{for(var J=0;J<this.containers.length;J++){this.containers[J].insertBefore(I,this.containers[J].childNodes[M]);}}}this.registerPanel(I,O);this.resetPanelMap();var H=this.currentPanelId;if(this.renderedPanels){this.renderedPanels[I.getAttribute("id")]=true;}this.setCurrentPanel(I.getAttribute("id"));if(C){var K=B.updateManager;var Q=new Array();var G=new Object();G.panelStackId=this.id;G.oldPanelId=H;Q.push(K.createActionObject(I,mstrUpdateManager.ADD_PANEL,B.beanPath,["2048007","2048117","2048018"],[this.id,I.getAttribute("id"),mstrUpdateManager.UPDATE_LATER],[],G));K.add(Q);}}catch(F){microstrategy.errors.log(F);}};mstrPanelStack.prototype.duplicatePanel=function(){try{var B=this.getDocViewer();if(!B){return ;}var A=B.updateManager;var D=new Array();D.push(A.createActionObject(this,mstrUpdateManager.DUPLICATE_PANEL,B.beanPath,["2048117"],[this.currentPanelId],[],null));A.add(D);A.flushAndSubmitChanges();}catch(C){microstrategy.errors.log(C);}};mstrPanelStack.prototype.moveCurrentPanel=function(J,K,C){try{var H=this.panels.length;if(H<=1){return ;}var A=this.getDocViewer();if(!A){return ;}var B=true;if(K!=null){B=K;}var F=this.getCurrentPanel().id;var G=C;if(!G){if(J==this.PREVIOUS_DIR){G=this.panels[this.panelMap[F]-1].id;}else{G=this.panels[this.panelMap[F]+1].id;}}this.setCurrentPanel(G);if(B){var I=A.updateManager;var L=new Array();var E=new Object();E.panelStackId=this.id;E.oldPanelId=F;E.direction=J;L.push(I.createActionObject(F,mstrUpdateManager.SET_CURRENT_PANEL,A.beanPath,["2048007","2048117","2048137","2048018"],[this.id,G,this.panelStackKeyContext,mstrUpdateManager.UPDATE_LATER],[],E));I.add(L);}}catch(D){microstrategy.errors.log(D);}};mstrPanelStack.prototype.movePanel=function(J,L){try{var C=this.getCurrentPanel().id;var I=this.panelMap[C];var K;if(J==this.PREVIOUS_DIR){K=I-1;for(var G=0;G<this.containers.length;G++){this.containers[G].insertBefore(this.containers[G].childNodes[I],this.containers[G].childNodes[K]);}var D=this.panels.splice(I,1);this.panels.splice(I-1,0,D[0]);}else{K=I+1;if(K==this.panels.length-1){for(var G=0;G<this.containers.length;G++){var D=this.containers[G].removeChild(this.containers[G].childNodes[I]);this.containers[G].appendChild(D);}}else{for(var G=0;G<this.containers.length;G++){this.containers[G].insertBefore(this.containers[G].childNodes[I],this.containers[G].childNodes[K]);}}var D=this.panels.splice(I,1);this.panels.splice(I+1,0,D[0]);}this.resetPanelMap();this.setCurrentPanel(C);var A=this.getDocViewer();if(!A){return ;}var B=true;if(L!=null){B=L;}if(B){var H=A.updateManager;var M=new Array();var F=new Object();F.panelStackId=this.id;F.direction=J;M.push(H.createActionObject(C,mstrUpdateManager.MOVE_PANEL,A.beanPath,["2048007","2048117","2048018","2048118"],[this.id,C,mstrUpdateManager.UPDATE_LATER,J],[],F));H.add(M);}}catch(E){microstrategy.errors.log(E);}};mstrPanelStack.prototype.createToolbar=function(){try{mstrRWUnitBoneImpl.prototype.createToolbar.call(this);this.toolbar.setAttribute(microstrategy.HTMLATTR_CMD_ID,"tb");this.toolbar.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e);");s=document.createElement("div");s.className="panelPrevious";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4717"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"pp");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelNext";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4718"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"np");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelAdd";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4719"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"ap");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelDuplicate";s.setAttribute("title",microstrategy.descriptors.getDescriptor("6048"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"dp");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelRemove";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4720"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"rp");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelMoveBack";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4721"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"mpp");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelMoveNext";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4722"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"mpn");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelRename";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4795"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"rnp");this.toolbar.appendChild(s);if(this.getDocViewer().isFeatureAvailable(microstrategy.FEATURE_INSERT_INTO_PANEL)){s=document.createElement("div");s.className="panelInsertMenu";s.id="pim_"+this.id;s.setAttribute("title",microstrategy.descriptors.getDescriptor("2919"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"pim");this.toolbar.appendChild(s);}this.setToolbarState();}catch(A){microstrategy.errors.log(A);}};mstrPanelStack.prototype.setToolbarState=function(){try{if(this.toolbar==null){return ;}this.clearToolbarState();if(!this.containers[0]){return ;}for(var B=(this.containers[0].childNodes.length==1)?1:3;B<9;B++){if(this.toolbar.childNodes[B]){this.toolbar.childNodes[B].style.display=this.isLocked?"none":"block";}}if(this.containers[0].childNodes.length==1){if(this.toolbar.childNodes[1]){this.toolbar.childNodes[1].className+="Disabled";}if(this.toolbar.childNodes[2]){this.toolbar.childNodes[2].className+="Disabled";}if(this.toolbar.childNodes[5]){this.toolbar.childNodes[5].className+="Disabled";}if(this.toolbar.childNodes[6]){this.toolbar.childNodes[6].className+="Disabled";}if(this.toolbar.childNodes[7]){this.toolbar.childNodes[7].className+="Disabled";}return ;}var A=this.panelMap[this.getCurrentPanel().id];if(A==0){if(this.toolbar.childNodes[1]){this.toolbar.childNodes[1].className+="Disabled";}if(this.toolbar.childNodes[6]){this.toolbar.childNodes[6].className+="Disabled";}}if(A==this.panels.length-1){if(this.toolbar.childNodes[2]){this.toolbar.childNodes[2].className+="Disabled";}if(this.toolbar.childNodes[7]){this.toolbar.childNodes[7].className+="Disabled";}}}catch(C){microstrategy.errors.log(C);}};mstrPanelStack.prototype.clearToolbarState=function(){try{if(this.toolbar==null){return ;}var B=this.toolbar.childNodes[0];while(B){B.className=B.className.replace("Disabled","");B=B.nextSibling;}}catch(A){microstrategy.errors.log(A);}};mstrPanelStack.prototype.getDocViewer=function(){try{return microstrategy.getViewerBone();}catch(A){microstrategy.errors.log(A);}return null;};mstrPanelStack.prototype.registerPanel=function(J,F){try{var K=J.getAttribute("id");var D;var E=((typeof (F)=="undefined")||F==null||F==this.panels.length);if(!E||(typeof (this.panelMap[K])=="undefined")){D=new mstrPanel(K,this,"microstrategy.bone('"+this.id+"').getPanel('"+K+"')");D.onload();if(E){this.panelMap[K]=this.panels.length;this.panels.push(D);var V=J.childNodes[0],M=microstrategy.bone("rwb_viewer"),T=M.ddic||{},I=this.getDocViewer(),U=[].concat(I.getAvailableAttributes?I.getAvailableAttributes():[]).concat(I.getAvailableMetrics?I.getAvailableMetrics():[]);D.tscObjs=[];while(V){if(V.getAttribute("trx")==="1"){var W=V.getAttribute("id"),A=V.getAttribute("trxn"),Q={key:W,mapped:1,edt:1,tn:A};if(V.getAttribute("trxctlkey")){var P=V.getAttribute("trxctlkey"),L=V.getAttribute("trxsid"),R=V.getAttribute("trxtgs"),N=V.getAttribute("trxdfm"),C=V.getAttribute("trxautosync"),O=V.getAttribute("trxisus"),H=V.getAttribute("trxust"),S=V.getAttribute("trxadts"),G=mstr.$A.filter(U,{filter:function(X){return X.dssid.indexOf(L)>=0;}},"filter");Q.ctl={ctlKey:P};if(L){Q.ctl.ddic={trxsid:L,targetKeys:R||"",ctlSrc:G.length>0?G[0].dssid:"",autoSync:C==="true"};M.doc.formattingAttributes[W].dfm=N;M.doc.formattingAttributes[W].ust=H;M.doc.formattingAttributes[W].isUs=(O==="true");M.doc.formattingAttributes[W].adts=S;}}D.tscObjs.push(Q);}V=V.nextSibling;}M.ddic=T;}else{this.panelMap[K]=F;this.panels.splice(F,0,D);}this.getDocViewer().doc.addPanelMask&&this.getDocViewer().doc.addPanelMask(D);}else{if(typeof (this.panelMap[K])!="undefined"){if(this.currentPanelId==K){D=this.panels[this.panelMap[K]];if(D){D.synchronizeSize();}}else{if(J.getAttribute("pu")=="1"){D=this.panels[this.panelMap[K]];if(D){D.onload();}J.removeAttribute("pu");}}}}}catch(B){microstrategy.errors.log(B);}};mstrPanelStack.prototype.getPanel=function(B){try{return(B==-1)?this.panels[0]:this.panels[this.panelMap[B]];}catch(A){microstrategy.errors.log(A);}return null;};mstrPanelStack.prototype.getCurrentPanel=function(){try{return this.getPanel(this.currentPanelId);}catch(A){microstrategy.errors.log(A);}return null;};mstrPanelStack.prototype.setCurrentPanel=function(B,C){try{var M=document.getElementsByName(B);if(M.length==0){return ;}var E=this.getCurrentPanel();var I=this.currentPanelId;if(E&&E.id!=B){var N=document.getElementsByName(E.id);for(var J=0;J<N.length;J++){N[J].style.display="none";}}this.currentPanelId=B;this.elemSaved=this.elem;for(var J=0;J<M.length;J++){M[J].style.display="block";var D=M[J];this.showPanel(D,B,I);}this.elem=this.elemSaved;this.adjustTitle(M[0]);this.setToolbarState();var P="";if(this.renderedPanels&&!this.renderedPanels[B]){P=B;this.renderedPanels[B]=true;}else{if(this.dirtyKeys&&this.dirtyKeys[B]){var K=false;for(var H in this.dirtyKeys[B]){if(K){P+=",";}else{K=true;}P+=H;}this.dirtyKeys[B]=null;}}if(C||P){var A=this.getDocViewer();var L=A.updateManager;var O=new Array();var G=new Object();G.panelStackId=this.id;G.oldPanelId=I;O.push(L.createActionObject(I,mstrUpdateManager.SET_CURRENT_PANEL,A.beanPath,["2048007","2048117","2048137","2048018","2048178"],[this.id,B,this.panelStackKeyContext,mstrUpdateManager.UPDATE_LATER,P],[],G));L.add(O);if(P){if(!A.hasStylesFor(B)){L.addURL("ruleCounter="+A.ruleCounter);}L.flushAndSubmitChanges();}}microstrategy.eventManager.notifyOrphanBones("onpanelchange");}catch(F){microstrategy.errors.log(F);}return null;};mstrPanelStack.prototype.showPanel=function(B,C,A){window.setTimeout(function(){var D=microstrategy.findBone(B);if(D.elem!=B||C!=A){D.onShowCalled=false;D.elem=B;}D.onShow();},0);};mstrPanelStack.prototype.switchToPanel=function(A){var C=this.getCurrentPanel().elem;var B=A==-1?C.previousSibling:C.nextSibling;if(B!=null){this.setCurrentPanel(B.id,true);C.style.display="none";B.style.display="block";this.updateIconStatus(this.titleBars[0],B);}};mstrPanelStack.prototype.updateIconStatus=function(A,E){var D=microstrategy.findChildrenWithAtt(A,"SPAN","ps","1");if(D&&D.length>0){var B={previous:D[0],next:D[1]};for(var F in B){var C=B[F];if(E[F+"Sibling"]){C.className=C.className.replace(/ disabled/g,"");}else{C.className+=" disabled";}}}};mstrPanelStack.prototype.addDirtyKey=function(A,B){try{if(!this.dirtyKeys){this.dirtyKeys={};}if(!this.dirtyKeys[A.id]){this.dirtyKeys[A.id]={};}this.dirtyKeys[A.id][B]=true;}catch(C){microstrategy.errors.log(C);}return null;};mstrPanelStack.prototype.updatePortalTitle=function(D){try{var C=document.getElementsByName(this.id+"_toolbar");if(!D){D="";}if(this.titleBarDisplay==mstrPanelStack.CUSTOM_TITLE){for(var A=0;A<C.length;A++){this.setTitle(C[A],D);}}this.customTitle=D;}catch(B){}};mstrPanelStack.prototype.setTitle=function(B,C){var A=microstrategy.findChildWithAtt(B,"DIV",microstrategy.HTMLATTR_ID,"titleBar");A.innerHTML=encode(C);};mstrPanelStack.prototype.adjustTitle=function(A){try{if(!A){A=this.getCurrentPanel().elem;}var B=this.getDocViewer().doc.styleObj;var E=document.getElementsByName(this.id+"_toolbar");for(var C=0;C<E.length;C++){var F;if(this.titleBarDisplay==mstrPanelStack.CURRENT_PANEL){F=(B.getAttValue(A,microstrategy.HTMLATTR_WINDOW_TITLE))?B.getAttValue(A,microstrategy.HTMLATTR_WINDOW_TITLE):"";}else{F=this.customTitle;}this.setTitle(E[C],F);}}catch(D){microstrategy.errors.log(D);return false;}};mstrPanelStack.prototype.getPanelMap=function(){try{return this.panelMap;}catch(A){microstrategy.errors.log(A);}};mstrPanelStack.prototype.resetPanelMap=function(){try{this.panelMap=new Object();for(var A=0;A<this.panels.length;A++){this.panelMap[this.panels[A].id]=A;}}catch(B){microstrategy.errors.log(B);}};mstrPanelStack.prototype.isPanelCurrent=function(B){try{return(this.getCurrentPanel().id==B);}catch(A){microstrategy.errors.log(A);}};mstrPanelStack.prototype.synchronizeSize=function(){try{var B=this.getDocViewer().doc.styleObj;var F=microstrategy.formatType;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;var A=parseInt(B.getValue(this.elem,"width"));var D=parseInt(B.getValue(this.elem,"height"));microstrategy.formatType=F;if(this.isTitleVisible&&D>getObjHeight(this.titleBars[0])){D-=getObjHeight(this.titleBars[0]);}if(!isNaN(D)&&!isNaN(A)){for(var C=0;C<this.panels.length;C++){this.panels[C].resize(D,A);}}this.resizeContent();this.synchronizeShadow();}catch(E){microstrategy.errors.log(E);}};mstrPanelStack.prototype.resize=function(A,C){try{this.elem.style.height=A+"px";this.elem.style.width=C+"px";this.resizeContent();if(this.isTitleVisible){A-=getObjHeight(this.titleBars[0]);}for(var B=0;B<this.panels.length;B++){this.panels[B].resize(A,C);}this.synchronizeShadow();}catch(D){microstrategy.errors.log(D);}};mstrPanelStack.prototype.resizeContent=function(){try{var A=this.getDocViewer().doc.styleObj;var D=parseInt(A.getValue(this.elem,"padding"));D=isNaN(D)?1:D;for(var B=0;B<this.containers.length;B++){this.containers[B].parentNode.style.height=this.elem.style.height?this.elem.style.height:Math.max(parseInt(A.getValue(this.elem,"height",microstrategy.FORMAT_TYPE_MAIN))-(2*D),0)+"px";}}catch(C){microstrategy.errors.log(C);}};mstrPanelStack.prototype.deleteStack=function(){try{this.disabled=true;for(var A=0;A<this.panels.length;A++){this.panels[A].deletePanel();}}catch(B){microstrategy.errors.log(B);}};mstrPanelStack.prototype.onPanelDeleted=function(C){try{if(C&&this.panelMap[C]){var A=microstrategy.findAncestor(this.elem.parentNode);if(A&&(A.getAttribute("id")===C)){this.deleteStack();}}}catch(B){microstrategy.errors.log(B);}};mstrPanelStack.prototype.onredo=function(B){try{var C=B.id;if(B.cachedArray&&B.cachedArray.panelStackId==this.id){switch(C){case mstrUpdateManager.ADD_PANEL:this.addPanel(B.elem,false,B.cachedArray.panelIndex);break;case mstrUpdateManager.REMOVE_PANEL:this.removePanel(B.elem,false);break;case mstrUpdateManager.SET_CURRENT_PANEL:this.moveCurrentPanel(B.cachedArray.direction,false,B.cachedArray.redoPanelId);break;case mstrUpdateManager.MOVE_PANEL:this.movePanel(B.cachedArray.direction,false);break;}}this.undoredo(B);}catch(A){microstrategy.errors.log(A);return false;}};mstrPanelStack.prototype.setControlGroupByList=function(F,E){try{var C=microstrategy.updateManager;var A="";for(var B=0;B<F.length;B++){A+=(B>0)?"!":"";A+=F[B].dssid;}E.push(C.createActionObject(this.elem,mstrUpdateManager.RW_REORDER_CONTROL_GROUP_BY,this.getDocViewer().beanPath,["2048012","2048173"],[this.id,A],[]));this.ControlGroupByList=F;}catch(D){microstrategy.errors.log(D);}};mstrPanelStack.prototype.onSubSectionShow=function(){try{if(this.isLoaded){this.resizeContent();}}catch(A){microstrategy.errors.log(A);return false;}};mstrPanelStack.prototype.onundo=function(B){try{var D=B.id;if(B.cachedArray&&B.cachedArray.panelStackId==this.id){switch(D){case mstrUpdateManager.ADD_PANEL:this.removePanel(B.elem,false,B.cachedArray.oldPanelId);break;case mstrUpdateManager.REMOVE_PANEL:this.addPanel(B.elem,false,B.cachedArray.panelIndex);break;case mstrUpdateManager.SET_CURRENT_PANEL:B.cachedArray.redoPanelId=this.currentPanelId;this.moveCurrentPanel(C,false,B.cachedArray.oldPanelId);break;case mstrUpdateManager.MOVE_PANEL:var C=(B.cachedArray.direction==this.PREVIOUS_DIR)?this.NEXT_DIR:this.PREVIOUS_DIR;this.movePanel(C,false);break;}}this.undoredo(B);}catch(A){microstrategy.errors.log(A);return false;}};mstrPanelStack.prototype.undoredo=function(D){try{var E=D.id;if(D.elem&&D.elem.getAttribute&&D.elem.getAttribute("id")==this.RWUnitId){switch(E){case mstrUpdateManager.EDIT_PROPS:var A=D.args[1].split(mstrUpdateManager.UNIT_SEPARATOR);if(A[1]=="Gradient"){return ;}var F=A[1]&&A[2]&&mstrFormatObject[A[1]][A[2]]&&mstrFormatObject[A[1]][A[2]][mstrFormatObject.HTML_PROP_NAME];var C=A[3];C=(C.substr(C.length-1)==mstrUpdateManager.ITEM_SEPARATOR)?C.substr(0,C.length-1):C;C=mstrFormatObject.decodeValue(F,C);if(A[1]=="FormattingView"){switch(F){case"showTitleBar":this.isTitleVisible=C==microstrategy.TRUE;this.toggleTitleBars();break;case"titleBarDisplay":this.titleBarDisplay=C;break;case"windowTitle":C=(C=="null"||!C)?"":C;this.docViewer.doc.styleObj.setAttValue(this.elem,"wt",C);this.updatePortalTitle(C);this.adjustTitle();break;}}else{if(A[1]=="FormattingPosition"){switch(F){case"locked":this.isLocked=C==microstrategy.TRUE;if(this.resetToolbar){this.resetToolbar();}break;}}}break;}}}catch(B){microstrategy.errors.log(B);return false;}};function mstrPanelStack(A){this.inherits=mstrRWUnitBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrPanelStackCommandsImpl.prototype=new Object();mstrPanelStackCommandsImpl.prototype.exec=function(A,C){try{}catch(B){microstrategy.errors.log(B);return false;}};mstrPanelStackCommandsImpl.prototype.queryEnabled=function(A,B){try{switch(A){case"Hmode":return !(microstrategy.formatType==mstrPanelStack.FMT_TYPE_TITLE);case"Height":return(microstrategy.formatType==mstrPanelStack.FMT_TYPE_TITLE&&this.parentBone.isTitleVisible==true);case"number":case"deltaDecimal":case"align":return false;case"font":case"fsize":case"fstyle":case"color":return microstrategy.formatType==mstrPanelStack.FMT_TYPE_TITLE;case"lncolor":case"borders":case"lnstyle":case"lineColor":case"borderLeftStyle":case"lineStyle":return(microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN&&B!=true);case"advColorPicker":case"major":case"minor":case"dValues":case"level":case"target":case"edtColorGradient":case"gradientcolor":case"b3dstyle":case"b3dweight":case"enabled3d":case"bgcolor":return true;}}catch(C){microstrategy.errors.log(C);return false;}};mstrPanelStackCommandsImpl.prototype.queryState=function(A,B){try{switch(A){case"getControlGroupByList":return this.parentBone.ControlGroupByList;default:if(B==true){return this.parentBone.docViewer.doc.commands.queryState(A,B);}else{return this.parentBone.docViewer.doc.commands.queryState(A);}}}catch(C){microstrategy.errors.log(C);return false;}};function mstrPanelStackCommandsImpl(A){this.parentBone=A;return this;}mstrFilterPanelMaskImpl.prototype=new mstrSubSectionMaskImpl();mstrFilterPanelMaskImpl.prototype.selectorInfo={};mstrFilterPanelMaskImpl.prototype.maxZIndex=0;mstrFilterPanelMaskImpl.ITEM_SPA=2;mstrFilterPanelMaskImpl.prototype.onload=function(B){try{this.maskedBone=B;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.initElem();}catch(A){microstrategy.errors.log(A);return false;}};mstrFilterPanelMaskImpl.prototype.initElem=function(){try{var B=(this.maskedBone.subsectionType==mstrSubSection.TYPE_PANEL);var D=document.createElement("div");D.setAttribute("id",this.maskedBone.id+"_mask");D.setAttribute("name",this.maskedBone.id+"_mask");D.style.position=(B)?"absolute":"relative";D.style.overflow="hidden";var A=document.createElement("img");A.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";A.style.width="100%";A.style.height="100%";if(this.maskedBone){D.style.height=this.getSectionHeight(this.maskedBone.elem)+"px";if(this.maskedBone.isHorizontal){if(this.getSectionWidth(this.maskedBone.elem)!=0){D.style.width=this.getSectionWidth(this.maskedBone.elem)+"px";}}}D.appendChild(A);this.img=A;this.elem=D;this.createImageMap();if(parseInt(this.elem.style.height)>0){this.elem.setAttribute("isCollapsed","false");}else{this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");this.elem.style.cursor="not-allowed";}}catch(C){microstrategy.errors.log(C);return false;}};mstrFilterPanelMaskImpl.prototype.updateImageMap=function(){try{this.elem.removeChild(this.imgMap);this.maxZIndex=0;this.createImageMap();}catch(A){microstrategy.errors.log(A);}};mstrFilterPanelMaskImpl.prototype.createImageMap=function(){try{var I=document.createElement("map");var H=this.maskedBone.id+"_fpMap";I.setAttribute("id",H);I.setAttribute("name",H);this.img.setAttribute("usemap","#"+H);I.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK);I.setAttribute(microstrategy.HTMLATTR_MASKEDOBJECT,this.maskedBone.id);I.setAttribute(microstrategy.HTMLATTR_POINTS_TO,this.secId+"|"+this.subId+"|"+this.subIndex);this.elem.appendChild(I);this.imgMap=I;if(this.maskedBone.elem){var B,F=this.maskedBone.elem,C=mstrFilterPanelMaskImpl.ITEM_SPA;this.selectorInfo={};for(var E=0;E<F.childNodes.length;E++){var G=F.childNodes[E];if(G.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){B=document.createElement("area");B.setAttribute("shape","rect");B.setAttribute("coords",this.getChildCoords(G));B.setAttribute("ctrlId",G.getAttribute("id"));I.appendChild(B);C+=mstr.utils.BoxModel.getElementOuterHeight(G)+mstrFilterPanelMaskImpl.ITEM_SPA;var A=parseInt(microstrategy.styleObj.getValue(G,"zIndex"));this.selectorInfo[G.getAttribute("id")]={zIndex:A,item:G};if(A>this.maxZIndex){this.maxZIndex=A;}B.setAttribute("soz",A);B.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(e, true); }");B.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(e, false); }");}}if(mstr.utils.BoxModel.getElementOuterHeight(this.maskedBone.elem)>C){B=document.createElement("area");B.setAttribute("shape","rect");B.setAttribute("coords",this.getChildCoords(this.maskedBone.elem,C));I.appendChild(B);B.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(e, true); }");B.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(e, false); }");}}}catch(D){microstrategy.errors.log(D);}};mstrFilterPanelMaskImpl.prototype.getChildCoords=function(E,C){try{var D=microstrategy.styleObj.getAttValue(E,microstrategy.HTMLATTR_HEIGHT_MODE);if(!D||D!=microstrategy.HUNDRED_PERCENT_MODE){var A=(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL);t=A?C:parseInt(microstrategy.styleObj.getValue(E,"top")),l=A?mstrFilterPanelMaskImpl.ITEM_SPA:parseInt(microstrategy.styleObj.getValue(E,"left")),b=t+mstr.utils.BoxModel.getElementOuterHeight(E),r=l+mstr.utils.BoxModel.getElementOuterWidth(E);}return l+", "+t+", "+r+", "+b;}catch(B){microstrategy.errors.log(B);return false;}};mstrFilterPanelMaskImpl.prototype.displayMask=function(e,show){try{var submaskDiv=document.getElementById("maskDiv");if(!submaskDiv){submaskDiv=document.createElement("div");submaskDiv.setAttribute("id","maskDiv");submaskDiv.style.position="absolute";var docMask=document.getElementById("docMask");docMask.insertBefore(submaskDiv,docMask.firstChild);}if(!show){submaskDiv.style.display="none";return false;}if(!e){e=window.event;}var srcArea=getEventTarget(e);if(!srcArea&&srcArea.tagName!="AREA"){return false;}with(submaskDiv.style){border="solid #ffff00";borderTopWidth="3px";borderLeftWidth=borderRightWidth=borderBottomWidth="0px";display="block";visibility="visible";var coords=srcArea.getAttribute("coords").split(",");height=(parseInt(coords[3])-parseInt(coords[1]))+"px";width=(parseInt(coords[2])-parseInt(coords[0]))+"px";left=getObjSumLeft(this.maskedBone.elem)-parseInt(this.maskedBone.doc.left)+parseInt(coords[0])+"px";top=getObjSumTop(this.maskedBone.elem)-parseInt(this.maskedBone.doc.top)+parseInt(coords[1])+"px";}}catch(err){microstrategy.errors.log(err);}return false;};mstrFilterPanelMaskImpl.prototype.adjustZIndex=function(B,F,E){try{var G=B?this.selectorInfo[B]:null,I=F?this.selectorInfo[F]:null,D,J;if(!B){if(!F){return false;}else{D=E?parseInt(I.zIndex)+1:parseInt(I.zIndex);J=E?parseInt(this.maxZIndex)+1:parseInt(this.maxZIndex);for(var A in this.selectorInfo){var H=this.selectorInfo[A];if(H.zIndex>=D&&H.zIndex<J){if(E){H.zIndex--;}else{H.zIndex++;}}}}}else{if(!F||G.zIndex<I.zIndex){D=parseInt(G.zIndex);J=parseInt(I?I.zIndex-1:this.maxZIndex);if(G.zIndex==J){return false;}G.zIndex=J;for(var A in this.selectorInfo){var H=this.selectorInfo[A];if(A==B){continue;}if(H.zIndex>D&&H.zIndex<=J){H.zIndex--;}}}else{if(G.zIndex>I.zIndex){D=I.zIndex;J=G.zIndex;G.zIndex=D;for(var A in this.selectorInfo){var H=this.selectorInfo[A];if(A==B){continue;}if(H.zIndex>=D&&H.zIndex<J){H.zIndex++;}}}else{if(G.zIndex==I.zIndex){return false;}}}}}catch(C){microstrategy.errors.log(C);return false;}return true;};mstrFilterPanelMaskImpl.prototype.getMoveItems=function(){try{var A=[];for(var D in this.selectorInfo){var C=this.selectorInfo[D];if(C.zIndex!=microstrategy.styleObj.getValue(C.item,"zIndex")){A.push(C);}}A.sort(function(E,F){return E.zIndex-F.zIndex;});return A;}catch(B){microstrategy.errors.log(B);}};mstrFilterPanelMaskImpl.prototype.getStartArea=function(C){try{var B=microstrategy.findChildWithAtt(this.imgMap,"AREA","soz",C+"");if(B){return B;}else{return this.imgMap.lastChild;}}catch(A){microstrategy.errors.log(A);}};function mstrFilterPanelMaskImpl(C,B,A){this.inherits=mstrSubSectionMaskImpl;this.inherits(C,B,A);this.inherits=null;return this;}mstrStaticPageBy.prototype=new mstrEditorImpl();mstrStaticPageBy.prototype.type=microstrategy.OBJTYPE_PAGE_BY;mstrStaticPageBy.prototype.updateManager=microstrategy.updateManager;mstrStaticPageBy.prototype.activeElement=null;mstrStaticPageBy.prototype.mapper=null;mstrStaticPageBy.prototype.selections=null;mstrStaticPageBy.prototype.dndHelper=null;mstrStaticPageBy.prototype.onload=function(){try{this.initEditor();if(!(this.body)){microstrategy.unRegisterBone(this.id);return ;}var E=document.getElementById("pagebyApply");this.autoSubmit=(E)?false:true;var D=this.body.getElementsByTagName("SELECT");if(D){for(var C=0;C<D.length;C++){D[C].onchange=new Function("e","return microstrategy.bone('"+this.id+"').onpagechange(e);");}}this.units=microstrategy.objectListFind(this.elem,"SPAN",microstrategy.OBJTYPE_PAGE_BY_ELEM);if(mstr.utils.ISIE7){var A=document.getElementById("pbb_GroupByStyle"),B=document.getElementById("mstrWebContentTable");if(B&&A&&A.currentStyle.display!="none"){B.style.width="100%";document.documentElement.style.overflow="visible";}}}catch(F){microstrategy.errors.log(F);return false;}};mstrStaticPageBy.prototype.onpagechange=function(C){try{if(!C){C=window.event;}if(this.autoSubmit){var E=getEventTarget(C);if(E){var D=E.options[E.selectedIndex].value;var B=250;D=D.replace(/\\/g,"\\\\");D=D.replace(/'/g,"\\'");D=D.replace(/"/g,'\\"');window.setTimeout("microstrategy.bone('"+this.id+"').handlePageByRequest('"+D+"')",B);}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticPageBy.prototype.handlePageByRequest=function(A){try{var B=this.updateManager;if(B){B.add([B.createActionObject(null,mstrUpdateManager.SET_PAGEBY_ELEMENT,this.beanPath,["20005"],[A],[])]);B.flushAndSubmitChanges();}}catch(C){microstrategy.errors.log(C);return false;}};mstrStaticPageBy.prototype.getUnit=function(C){try{if(this.units){var A=new mstrObjectInfoImpl(C);for(var D in this.units){if(A.dssId==this.units[D].oid){return this.units[D];}}}return null;}catch(B){microstrategy.errors.log(B);return null;}};mstrStaticPageBy.prototype.isEditableViewModeEplus=function(){return false;};function mstrStaticPageBy(A){this.inherits=mstrEditorImpl;this.inherits(A);this.inherits=null;return this;}mstrStaticDoc.prototype=new mstrBoneImpl();mstrStaticDoc.prototype.type=microstrategy.OBJTYPE_DOC;mstrStaticDoc.prototype.sections={};mstrStaticDoc.prototype.horizontalContainers={};mstrStaticDoc.prototype.commands=new mstrDocCommandsImpl();mstrStaticDoc.prototype.styleObj=null;mstrStaticDoc.prototype.left=null;mstrStaticDoc.prototype.top=null;mstrStaticDoc.prototype.MAX_WIDTH=56;mstrStaticDoc.prototype.path="";mstrStaticDoc.prototype.verifiedPath="";mstrStaticDoc.prototype.items=null;mstrStaticDoc.prototype.formattingAttributes=null;mstrStaticDoc.prototype.isVisualization=false;mstrStaticDoc.prototype.containsHorizontalSections=false;mstrStaticDoc.prototype.prevSelectedId=null;mstrStaticDoc.prototype.docPropsMap={PageWidth:{l:"paperWidth"},PageHeight:{l:"paperHeight"},PaperOrientation:{f:"Orientation"},MarginLeft:{l:"marginLeft"},MarginTop:{l:"marginTop"},MarginRight:{l:"marginRight"},MarginBottom:{l:"marginBottom"},LayoutFillColor:{f:"backgroundColor"},tabMPHF:{f:"TabMPHF",l:"currentLayoutMPHF"},TabName:{f:"windowTitle",l:"currentLayoutName"},CtlAutoSubmit:{l:"ctlAutoSubmit"},Autowire:{l:"autoWire"},EnableToc:{f:"Enabled"},TOCTitle:{f:"Title"},TabLeader:{f:"ShowTabLeader"},WatermarkText:{f:"Text"},incrFetchEnabled:{l:"enabled"},incrFetchBlockCount:{l:"blockCount"},incrFetchCurLevel:{l:"curLevel"},incrFetchLevels:{l:"levels"},DefaultSelectorsAsFilter:{f:"SelectorBehavior"},PreserveTranslations:{f:"PreserveTranslations"}};mstrStaticDoc.prototype.onload=function(B){try{this.initDoc();window.setTimeout(function(){mstrMsgBoxImpl.hideMessage(null,"controlTargetsRecorder");},100);if(typeof (mstr)!="undefined"){this.initNotesIcon();mstr.controllers.Factory.add(microstrategy.updateManager);}if(this.parentBone.isEditableViewModeEplus()&&this.parentBone.prevControl){this.commands.exec("currentControl",this.parentBone.prevControl);if(this.parentBone.prevControlLocked=="1"){this.parentBone.insertionControlLocked=true;}}if(mstrApp!==undefined){if(!this.parentBone.isEditableViewModeEplus()){mstrLocalStorage.addScreenshot(mstrApp.getLastMsgRecoveryInfo(),"mstrWebContents");}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.processDocPropertyChanges=function(A){try{var D=new Array();var B=this.parentBone.updateManager;var E=this.processStaticDocPropertyChanges(A,D);if(D.length>0){B.add(D,true);if(E){B.flushAndSubmitChanges();}}}catch(C){microstrategy.errors.log(C);}};mstrStaticDoc.prototype.processStaticDocPropertyChanges=function(C,T){try{var K=false,A=this.parentBone;um=A.updateManager,scheduleProcessed=false,usersProcessed=false;for(var R=0,Q=C.length;R<Q;R++){var E=C[R].cmdId;var O=C[R].value;var F=(this.docPropsMap[E]&&this.docPropsMap[E].f)||E;var G=(this.docPropsMap[E]&&this.docPropsMap[E].l)||E;switch(E){case"PaperOrientation":case"PaperType":case"Scaling":case"ScalePercentage":case"SectionHorizontalOverflow":case"ExportRange":case"ExcelGraphFormat":this.saveDocProperty(F,O,T);this.parentBone[G]=O;break;case"ScalePagesWide":case"ScalePagesTall":O=(trim(O)==""?0:O);this.saveDocProperty(F,O,T);this.parentBone[G]=O;break;case"ScalePageHeaderFooter":case"UseOneSheetPerLayout":case"UseOneSheetPerGroupElement":case"PromptUserForPagebyExport":case"IncludeBookmarks":case"ShowBookmarks":case"EmbedFonts":case"ExcelEmbedImages":case"enableGraphTooltips":case"EnableZoom":case"EnableCopyForText":case"EnableCopyForGridCell":this.saveDocProperty(F,(O)?microstrategy.TRUE:microstrategy.FALSE,T);this.parentBone[G]=O;break;case"RefreshDocument":this.parentBone.RefreshDocument=O;if(O==false){var J=-1;this.saveDocProperty("RefreshFrequency",J,T);this.parentBone.RefreshFrequency=J;}break;case"RefreshFrequency":var I=this.commands.queryState("RefreshDocument");O=I?O:-1;this.saveDocProperty(E,O,T);this.parentBone[E]=O;break;case"PageWidth":case"PageHeight":case"MarginLeft":case"MarginTop":case"MarginRight":case"MarginBottom":var J=microstrategy.number.toUSUnits(O);this.saveDocProperty(F,J,T);this.parentBone[G]=J;break;case"GraphFormat":this.saveDocProperty(F,(O)?"10":"11",T);this.parentBone[G]=O;break;case"GraphQualityDPI":this.saveDocProperty(F,(O)?"96":"288",T);this.parentBone[G]=O;break;case"DefaultPageByExportMode":this.saveDocProperty(F,(O)?"0":"1",T);this.parentBone[G]=O;break;case"scheduleType":case"selectedSchedules":A[G]=O;scheduleProcessed=true;break;case"userType":case"selectedUsers":A[G]=O;usersProcessed=true;break;case"MakePrivate":T.push(um.createActionObject(null,mstrUpdateManager.SET_VIEW_MEDIA,this.parentBone.beanPath,[(O)?"2048290":"2048291"],[mstr.Enum.VIEWMEDIA.PRIVATE],[]));K=true;break;}switch(E){case"PaperOrientation":case"PageWidth":case"MarginLeft":case"MarginRight":this.updatePageWidth();this.displayPageBreaker();break;case"PromptUserForPagebyExport":K=true;}}var N=A.scheduleType,P=A.selectedSchedules;if(scheduleProcessed&&(N!=A.scheduleTypeWas||P!=A.selectedSchedulesWas)){T.push(um.createActionObject(null,mstrUpdateManager.SAVE_RW_ASSOCIATED_SCHEDULES,this.parentBone.beanPath,["2048254","2048255"],[N,P]));}var M=parseInt(A.userType,10),H=A.selectedUsers;if(usersProcessed&&(M!=A.userTypeWas||H!=A.selectedUsersWas)){var B={0:1,1:0,2:1}[M];var J=[];if(M===2){for(var R=0,S=H.length;R<S;R++){var V=H[R],U=A.userSubscribeRights[V.rgt];J.push(V.did+ITEM_SEPARATOR+U+ITEM_SEPARATOR+V.n);}}var L=J.join(CLIPBOARD_ITEM_SEPARATOR);T.push(um.createActionObject(null,mstrUpdateManager.SAVE_RW_ASSOCIATED_USERS,this.parentBone.beanPath,["2048277","2048276"],[B,L]));}return K;}catch(D){microstrategy.errors.log(D);}return false;};mstrStaticDoc.prototype.saveDocProperty=function(A,H,J,D){try{var F=this.parentBone.updateManager;var E=mstrFormatObject;var C;switch(A){case"width":case"windowTitle":var I=D||this.parentBone.currentLayout||this.parentBone.rootNodeKey;if(!I){break;}C=mstrUpdateManager.createPropertyEditString(I,A,H);J.push(F.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,C],[]));break;case"PaperType":case"PageWidth":case"PageHeight":case"Orientation":case"Scaling":case"ScalePercentage":case"ScalePagesWide":case"ScalePagesTall":case"ScalePageHeaderFooter":case"SectionHorizontalOverflow":case"MarginLeft":case"MarginRight":case"MarginTop":case"MarginBottom":case"UsePageWidthAsLayoutWidth":if(this.parentBone.currentLayout){C=mstrUpdateManager.createPropertyEditString(this.parentBone.currentLayout,A,H);J.push(F.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,C],[]));}else{C=mstrUpdateManager.createPropertyEditString(null,A,H);J.push(F.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,C],[]));}break;default:var G;if(A==="CtlAutoSubmit"){G="RWDocumentProperties";}C=mstrUpdateManager.createPropertyEditString(null,A,H,false,G);J.push(F.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,C],[]));}}catch(B){microstrategy.errors.log(B);}};mstrStaticDoc.prototype.updatePageWidth=function(){try{if(this.parentBone.usePageWidthAsLayoutWidth==-1){var B=this.getPageWidth();B=((this.minWidth>parseInt(B))?this.minWidth:B)+"px";this.styleObj.setValue(this.elem,"width",B);this.parentBone.syncDocRszHandler();this.updateHRulerWidth();}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.getPageWidth=function(){try{var E=microstrategy.getFormatObject();var F=parseInt(E.decodeValue("width",this.parentBone.paperWidth));var C=parseInt(E.decodeValue("left",this.parentBone.marginLeft));var A=parseInt(E.decodeValue("left",this.parentBone.marginRight));var D=parseInt(E.decodeValue("left",this.parentBone.leftBorderWidth));var G=parseInt(E.decodeValue("left",this.parentBone.rightBorderWidth));return(F-C-A-D-G);}catch(B){microstrategy.errors.log(B);return null;}};mstrStaticDoc.prototype.displayPageBreaker=function(){};mstrStaticDoc.prototype.initNotesIcon=function(){try{var B=mstr.$obj("NotesIconModel_model");if(B&&!this.parentBone.needSaveBeforeNotes){B.set("objectID",this.parentBone.objectID);B.set("objectType",this.parentBone.objectType);}if(this.parentBone.needSaveBeforeNotes||(microstrategy.bone("accordion_AccordionTabManagerStyle")&&microstrategy.bone("accordion_AccordionTabManagerStyle").currentTabName==microstrategy.ACCORDION_RW_NOTES_PANEL)){var A=mstr.$obj("NotesIconView_view");if(A){A.set("visible",false);}}else{if(B){B.execCheck();}}}catch(C){microstrategy.errors.log(C);}};mstrStaticDoc.prototype.onpostload=function(B){try{mstrBoneImpl.prototype.onpostload.call(this);if(this.parentBone.isInteractiveViewModeEplus()||this.parentBone.layoutHeightMode!=1||this.parentBone.layoutWidthMode==0){this.synchHeightOfHorizontalSections();}this.syncPosition();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.onwinresize=function(B,A){try{this.syncPosition(B,A);window.setTimeout(function(){iframe.hideWaitPage(true);},mstr.utils.ISIE8?100:0);}catch(C){microstrategy.errors.log(C);}};mstrStaticDoc.prototype.shouldIgnoreKeyEvent=function(C){try{if(!C){C=window.event;}if(currentModalEditor!=null&&currentModalEditor.length>0||mstr.controllers.ModalEditors.size()>0){return true;}if(microstrategy.isContextMenuOpen()){return true;}var D=getEventTarget(C);if(D.tagName){var A=D.tagName.toLowerCase();if(A=="input"||A=="select"||A=="textarea"){return true;}}return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrStaticDoc.prototype.onkeydown=function(B){try{if(!B){B=window.event;}if(this.shouldIgnoreKeyEvent(B)){return true;}switch(B.keyCode){case 8:if(bIsIE4){B.cancelBubble=true;}return false;break;case 123:if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){toggleScreenMode();return false;}break;case 119:if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.parentBone.isFeatureAvailable(microstrategy.FEATURE_DATASET_OBJECTS_LIST)){this.commands.exec("toggleAccordion");return false;}break;}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.onkeypress=function(A){return true;};mstrStaticDoc.prototype.ondocumentclick=function(A){return true;};mstrStaticDoc.prototype.initDoc=function(){try{this.initBone();this.syncPosition();this.commands.parentBone=this;this.formattingAttributes=this.parentBone.formattingAttributes;microstrategy.styleObj=new mstrDocStyleImpl(this.formattingAttributes);microstrategy.styleObj.onload();this.styleObj=microstrategy.styleObj;this.path="microstrategy.bone('"+this.parentBone.id+"').doc";this.verifiedPath=microstrategy.getEventHandlerString(this.path);if(this.parentBone.isInteractiveViewModeEplus()||this.parentBone.layoutHeightMode!=1||this.parentBone.layoutWidthMode==0){this.initHorizontalContainers();this.initSections();var D=this;window.setTimeout(function(){D.synchHeightOfHorizontalSections();},0);}this.initRoundedRectangles();this.initButtons();for(var A=0;A<currentModalEditor.length;A++){var B=document.getElementById(currentModalEditor[A]);if(B!=null&&B.getAttribute(mstrHTMLAttributes.ATTR_HIDDEN)=="true"){currentModalEditor.length=A;break;}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrStaticDoc.prototype.adjustWidth=function(){try{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.parentBone.layoutWidthMode==0){var A=this.elem.style.width;if(bIsW3C||bIsIE7){this.elem.style.width="100000px";}this.minWidth=this.getRightMostPos();var D=(this.minWidth>parseInt(A))?this.minWidth+"px":A;if(this.elem.style.width!=D){this.elem.style.width=D;}if(mstr.utils.ISIE6){var C=microstrategy.findChildWithAtt(this.parentBone.elem,"table","className","rulerTable");if(C){C.style.width=D;}}}else{if(this.parentBone.currentRWViewMode==microstrategy.RW_VIEW_MODE_EDITABLE){this.minWidth=0;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrStaticDoc.prototype.onpanelchange=function(){return true;};mstrStaticDoc.prototype.syncPosition=function(B,A){try{this.left=A||getObjSumLeft(this.elem);this.top=B||getObjSumTop(this.elem);for(var D in this.sections){if(this.sections[D].syncPosition){this.sections[D].syncPosition();}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrStaticDoc.prototype.initSections=function(){try{this.sections={};this.subSectionsInSection={};var B=this.parentBone.sectionSubsections;if(B!=null){var A=B.split(";");for(var C=0;C<A.length;C++){var F=A[C].substring(0,A[C].indexOf("?"));this.subSectionsInSection[F]=A[C].substring(A[C].indexOf("?")+1);if(typeof (this.sections[F])=="undefined"){var E=new mstrDocSectionImpl(F);E.parentBone=this;E.path=this.path+".sections['"+F+"']";this.sections[F]=E;if(E.onload){E.onload();}}}}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrStaticDoc.prototype.initRoundedRectangles=function(){try{this.roundedRectangles={};var A=this.parentBone.roundedRectangles;if(A!=null&&A.length>0){var C=A.split(";");for(var B=0;B<C.length-1;B++){this.initRoundedRectangle(C[B]);}}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrStaticDoc.prototype.initRoundedRectangle=function(C){try{microstrategy.registerBone(C,"mstrRoundedRectangleScript",null);function B(D){if(microstrategy.bone(D)!=null){microstrategy.bone(D).onload();}else{window.setTimeout(function(){B(D);},250);}}B(C);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.initButtons=function(){try{var B=this.parentBone.buttons;if(B!=null&&B.length>0){var D=B.split(";");for(var A=0;A<D.length-1;A++){this.initButton(D[A]);}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrStaticDoc.prototype.initButton=function(C){try{microstrategy.registerBone(C,"mstrButtonScript",null);function B(){if(microstrategy.bone(C)!=null){microstrategy.bone(C).onload();}else{window.setTimeout(B,250);}}B();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.initHorizontalContainers=function(){try{if(!this.containsHorizontalSections){return ;}this.horizontalContainers={};var A=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(A){for(var B=0;B<A.length;B++){var E=A[B].getAttribute("id");if(typeof (this.horizontalContainers[E])=="undefined"){var D=new mstrHorizontalContainerImpl(E);D.parentBone=this;D.path=this.path+".horizontalContainers['"+E+"']";if(D.onload){D.onload();}this.horizontalContainers[E]=D;}}}}catch(C){microstrategy.errors.log(C);}};mstrStaticDoc.prototype.synchHeightOfHorizontalSections=function(A){try{if(!this.containsHorizontalSections){return ;}if(A){for(var E=0;E<A.sibs.length;E++){var D=microstrategy.findAncestorWithAtt(A.sibs[E],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(D){var C=microstrategy.findBone(D);C.propogateHeightToChildren();}}}else{for(var G in this.horizontalContainers){this.horizontalContainers[G].propogateHeightToChildren();var B=microstrategy.styleObj.getValue(this.horizontalContainers[G].elem,"height");if(B==-1||B==""){this.parentBone.totalHeight+=parseInt(microstrategy.styleObj.getValue(this.horizontalContainers[G].subSections[0],"height"));}else{this.parentBone.totalHeight+=parseInt(microstrategy.styleObj.getValue(this.horizontalContainers[G].elem,"height"));}}}microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}catch(F){microstrategy.errors.log(F);}};mstrStaticDoc.prototype.adjustHeightOfHorizontalSubSections=function(A,E){try{if(!this.containsHorizontalSections){return ;}if(A){var C=microstrategy.findAncestorWithAtt(A.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(C){var B=microstrategy.findBone(C);B.adjustSubsectionHeight(E);}}}catch(D){microstrategy.errors.log(D);}};mstrStaticDoc.prototype.resetHeightOfHorizontalSections=function(A){try{if(A){for(var D=0;D<A.sibs.length;D++){var C=microstrategy.findAncestorWithAtt(A.sibs[D],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(C){var B=microstrategy.findBone(C);B.resetHeight();}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrStaticDoc.prototype.onSubSectionResize=function(){return true;};mstrStaticDoc.prototype.getGradientColor=function(B,D,G){try{var H;if(D==microstrategy.FORMAT_TYPE_MAIN){if(B.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){H=microstrategy.findBone(B);if(!H.isTable){if(G==true){if(H.panels){var F=H.panels[0].elem.getAttribute("gradientcolor");for(var C=1;C<H.panels.length;C++){var E=H.panels[C].elem.getAttribute("gradientcolor");if(E!=F){return null;}}return F;}}else{var I=H.getCurrentPanel().elem;return I.getAttribute("gradientcolor");}}}else{return B.getAttribute("gradientcolor");}}else{H=microstrategy.findBone(B);if(H&&H.getFormatValue){return H.getFormatValue(D,"gradientcolor");}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.processSubsectionBone=function(A){try{if(A){if(A.subsectionType!=mstrSubSection.TYPE_PANEL){A.setNeedToUpdateMaxContentHeight(true);if(A.isHorizontal){this.resetHeightOfHorizontalSections(A);this.adjustHeightOfHorizontalSubSections(A);this.synchHeightOfHorizontalSections(A);}else{A.adjustSubsectionHeight();}}}}catch(B){microstrategy.errors.log(B);}};mstrStaticDoc.prototype.removePaddingAndBorder=function(C,D,A){try{D=String(D);if(D=="100%"||D=="auto"){return D;}return Math.max(Math.round(parseFloat(D)-microstrategy.getPaddingAndBorderPixels(C,A)),0);}catch(B){microstrategy.errors.log(B);return D;}};mstrStaticDoc.prototype.checkAppliesTo=function(B,C){try{return microstrategy.isEnabledForItem(B,C);}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.hasMoved=function(){try{return(getObjSumLeft(this.elem)!=this.left||getObjSumTop(this.elem)!=this.top);}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.getRightMostPos=function(){try{var A=0;for(var C in this.sections){A=Math.max(this.sections[C].getRightMostPos(),A);}for(var B in this.horizontalContainers){A=Math.max(this.horizontalContainers[B].getRightMostPos(),A);}return A;}catch(D){microstrategy.errors.log(D);return false;}};mstrStaticDoc.prototype.getChildBone=function(D){try{var B=D.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(B){case microstrategy.OBJTYPE_DOC_SUBSECTION:var A=microstrategy.findAncestorWithAtt(D,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION).getAttribute("id");if(A in this.sections&&this.sections[A].isLoaded){return this.sections[A].getChildBone(D);}break;case microstrategy.OBJTYPE_DOC_SECTION:if(D.getAttribute("id") in this.sections&&this.sections[D.getAttribute("id")].isLoaded){return this.sections[D.getAttribute("id")];}break;case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:if(D.getAttribute("id") in this.horizontalContainers&&this.horizontalContainers[D.getAttribute("id")].isLoaded){return this.horizontalContainers[D.getAttribute("id")];}break;}return null;}catch(C){microstrategy.errors.log(C);return false;}};mstrStaticDoc.prototype.getMaxZIndex=function(F){try{var C=0;if(this.sections){for(var G in this.sections){var A=this.sections[G].subsections;if(A){for(var B in A){var E=A[B];if(E.maxZindex){C=(E.maxZindex>C)?E.maxZindex:C;}}}}}return C;}catch(D){microstrategy.errors.log(D);return 0;}};mstrStaticDoc.prototype.showGradient=function(){return false;};mstrStaticDoc.getBone=function(D){try{var B=null;var E=D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);switch(E){case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:B=microstrategy.bone(D.id+"_Ctl");break;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:B=microstrategy.bone(D.id);break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:if(D.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){B=microstrategy.bone(D.id);}break;case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:var A=microstrategy.subObjectFind(D,"div",microstrategy.SUBOBJTYPE_GRID_TABLE);if(!A){A=microstrategy.findChildWithAtt(D,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrGridRW");}if(!A){A=microstrategy.findChildWithAtt(D,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrReportGraphImpl");}if(A){B=microstrategy.bone(A.id);}break;}return B;}catch(C){microstrategy.errors.log(C);return null;}};mstrStaticDoc.prototype.resizeSubMaskForSib=function(C,B,D,A,E){return false;};mstrStaticDoc.prototype.hideSubMaskForSib=function(C,B,D,A){return false;};mstrStaticDoc.prototype.setVisualizationSettings=function(H,L,J,C,M,F,K,G){try{var A=mstrUpdateManager.SET_DOC_VISUALIZATION_PROPERTIES;this.parentBone.updateManager.useIframe=!!G;var E=new Array();var I=new Array();if(H){E[E.length]="2048112";I[I.length]=H;}if(L!=null){E[E.length]="2048110";I[I.length]=L;var B=this.parentBone.getAllVisList()[L];if(B){E[E.length]="2048177";I[I.length]=(typeof (B.ip)!="undefined")?B.ip:"0";E[E.length]="2048211";I[I.length]=(typeof (B.im)!="undefined")?B.im:"";}}if(J!=null){E[E.length]="2048111";I[I.length]=J;}if(C){E[E.length]="2048109";I[I.length]=C;}if(F!=null){E[E.length]="2048213";I[I.length]=F;}if(K){E[E.length]="2048212";I[I.length]=K;}microstrategy.updateVisProps(H,L,J,C,this.parentBone);if(M){M.push(this.parentBone.updateManager.createActionObject(this.elem,A,this.parentBone.beanPath,E,I,[]));M.push(this.parentBone.updateManager.createActionObject(this.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[]));if(this.parentBone.observer){this.parentBone.observer.notifyAll("onvischange");}}else{this.parentBone.updateManager.add([this.parentBone.updateManager.createActionObject(this.elem,A,this.parentBone.beanPath,E,I,[])]);this.parentBone.updateManager.add([this.parentBone.updateManager.createActionObject(this.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[])]);this.parentBone.updateManager.flushAndSubmitChanges();}return true;}catch(D){microstrategy.errors.log(D);return false;}};function mstrStaticDoc(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrDocStyleImpl.prototype={};mstrDocStyleImpl.prototype.objSheet=null;mstrDocStyleImpl.prototype.styleDefaults={zIndex:0};mstrDocStyleImpl.prototype.formattingAttributes=null;mstrDocStyleImpl.HTMLATTR_CLASS_ID="rl";mstrDocStyleImpl.prototype.onload=function(C){try{for(var A=document.styleSheets.length-1;A>=0;A--){var D=document.styleSheets[A];if(D.title=="docObjectRules"||(D.ownerNode&&D.ownerNode.id=="docObjectStyle")||D.id=="docObjectStyle"){this.objSheet=document.styleSheets[A];this.objSheet.styleRules=(this.objSheet.rules)?this.objSheet.rules:this.objSheet.cssRules;break;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocStyleImpl.prototype.reloadFormattingAttributes=function(A){this.formattingAttributes=A;this.onload();};mstrDocStyleImpl.prototype.getValue=function(H,B,G){try{var O;B=this.swapForRotation(H,B);if(!G){G=microstrategy.formatType;}if(G&&G!=microstrategy.FORMAT_TYPE_MAIN){O=mstrStaticDoc.getBone(H);if(O&&O.getFormatValue){return O.getFormatValue(G,B);}}var I=H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);B=this.resolveStyles(H,B);if(B=="backgroundColor"){if(I==microstrategy.SUBOBJTYPE_DOC_SHAPE){if(H.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){O=microstrategy.bone(H.id);if(O&&O.backgroundColor!=null){return O.backgroundColor;}}}else{if(I==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){O=microstrategy.findBone(H);H=O.getCurrentPanel().elem;}}}if(B=="textDecoration"&&this.doTextDecOnBone(H)){O=microstrategy.findBone(H);return O.textDecoration;}var M=H.style[B];if((!M)||M.length==0||(B in this.styleDefaults&&M==this.styleDefaults[B])){var C=this.getId(H);if(!isNaN(C)){M=this.objSheet.styleRules[C].style[B];}}if(M=="medium"&&B.indexOf("border")>-1&&B.indexOf("Width")>-1){M="0pt";}if((B.toLowerCase()).indexOf("color")>-1&&M){M=mstr.utils.Color.rgbStr2hex(M);}if(typeof (M)=="undefined"){var E=microstrategy.getFormatObject();var L=E.isTargetStyleOrAttr(B);if(L&mstrFormatObject.TARGET_VALUE_ATTR){var J=E.getAttrNameFromStyle(B);M=this.getAttValue(H,J);}}if(!bIsDXIE&&(B==="left"||B==="top")){var N=H.direction||"0",D=Math.round(microstrategy.getPaddingAndBorderPixels(H,"height")),P=Math.round(microstrategy.getPaddingAndBorderPixels(H,"width")),K=parseInt(this.getValue(H,"width"),0)+P,A=parseInt(this.getValue(H,"height"),0)+D;if(B==="top"&&N==="90"){M=parseInt(M,0)-A+"px";}else{if(B==="left"&&N==="-90"){M=parseInt(M,0)-K+"px";}}}return M;}catch(F){microstrategy.errors.log(F);return false;}};mstrDocStyleImpl.prototype.isRotated=function(F){try{var B=false,A=this.formattingAttributes;if(!A){return B;}var E=A.tdUnits,C=E&&E[F.id];if(C){B=parseInt(E[F.id],10);}return B;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocStyleImpl.prototype.swapForRotation=function(D,E,A){try{if(E.indexOf("width")<0&&E.indexOf("height")<0&&E.indexOf("padding")<0&&E.indexOf("border")){return E;}var B=D.direction||this.getValue(D,"TextDirection")||"0";if(B!=="0"){switch(E){case"height":return"width";case"width":return"height";}}if((!A&&B==="90")||(A&&B==="-90")){if(E.indexOf("Left")>=0){return E.replace("Left","Top");}else{if(E.indexOf("Right")>=0){return E.replace("Right","Bottom");}else{if(E.indexOf("Top")>=0){return E.replace("Top","Right");}else{if(E.indexOf("Bottom")>=0){return E.replace("Bottom","Left");}}}}}else{if((!A&&B==="-90")||(A&&B==="90")){if(E.indexOf("Left")>=0){return E.replace("Left","Bottom");}else{if(E.indexOf("Right")>=0){return E.replace("Right","Top");}else{if(E.indexOf("Top")>=0){return E.replace("Top","Left");}else{if(E.indexOf("Bottom")>=0){return E.replace("Bottom","Right");}}}}}}return E;}catch(C){microstrategy.errors.log(C);return E;}};mstrDocStyleImpl.prototype.setValue=function(B,F,E,D){try{D=D||microstrategy.formatType;if(D!=microstrategy.FORMAT_TYPE_MAIN){var C=mstrStaticDoc.getBone(B);if(C&&C.setFormatValue){C.setFormatValue(D,F,E);return ;}}this.formatElem(B,F,E);}catch(A){microstrategy.errors.log(A);}};mstrDocStyleImpl.prototype.doTextDecOnBone=function(D){try{var B=false;if(D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){var A=microstrategy.bone(D.getAttribute("id")+"_Ctl");if(A){B=(A.ctlStyle==mstrRWControlImpl.CTL_STYLE_LIST_BOX);}}return B;}catch(C){microstrategy.errors.log(C);}};mstrDocStyleImpl.prototype.formatElem=function(E,B,O){try{if(O!=null&&String(O).length>0){var K=B;B=this.resolveStyles(E,B);if(B){if(B=="backgroundColor"){if(bIsDXIE){var L=this.getFilter(E,"Gradient");if(L!=null){L.enabled=false;}}else{if(E.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&E.getAttribute("scriptclass")!="mstrPanel"){var P=E.previousSibling;if(P&&P.id==(E.id+gradientUtil.GRADIENT_POSTFIX)){P.style.background="transparent";}}else{E.style.background="transparent";}}}var D=microstrategy.getFormatObject();var M=D.isTargetStyleOrAttr(B);if(M&mstrFormatObject.TARGET_VALUE_STYLE){switch(B){case"dropShadowDepth":case"dropShadowEffect":E.style[B]=O;this.applyShadow(E,B,O);break;case"alphaOpacity":case"alphaEffect":this.applyAlpha(E,B,O);E.style[B]=O;break;case"textDecoration":var I=E.style[B].indexOf("underline")>=0;var N=E.style[B].indexOf("line-through")>=0;if(this.doTextDecOnBone(E)){var F=microstrategy.findBone(E);I=F[B]&&F[B].indexOf("underline")>=0;N=F[B]&&F[B].indexOf("line-through")>=0;}var C="";if(K=="textDecoration"){I=O.indexOf("underline")>=0;}else{N=O.indexOf("line-through")>=0;}C="none";if(I){C="underline";}if(N){if(I){C+=" line-through";}else{C="line-through";}}if(this.doTextDecOnBone(E)){E.style[B]="none";F[B]=C;}else{E.style[B]=C;}var A=E.getElementsByTagName("a");if(A){for(var H=0;H<A.length;H++){A[H].style[B]=C;}}break;case"TextDirection":E.style[B]=O;this.applyTextDirection(E,B,O);break;case"color":E.style[B]=O;var A=E.getElementsByTagName("a");if(A){for(var H=0;H<A.length;H++){A[H].style[B]=O;}}break;case"paddingTop":case"paddingBottom":case"paddingRight":case"paddingLeft":this.applyPadding(E,B,O);break;default:E.style[B]=O;}if(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.cascadeSelectorValue(E,K,O);}}if(M&mstrFormatObject.TARGET_VALUE_ATTR){var J=D.getAttrNameFromStyle(B);this.setAttValue(E,J,D.encodeValue(B,O));}}}return false;}catch(G){microstrategy.errors.log(G);return false;}};mstrDocStyleImpl.prototype.applyTextDirection=function(K,C,N){if(bIsDXIE){var Q;if(N=="0"){Q=0;}else{if(N=="90"){Q=3;}else{if(N=="-90"){Q=1;}}}var E=this.getFilter(K,"BasicImage");var L=E?E.rotation:0;var G=Math.abs(L-Q)%2==1;var M=this.getValue(K,this.swapForRotation(K,"height",true));var P=this.getValue(K,this.swapForRotation(K,"width",true));var I=this.getValue(K,this.swapForRotation(K,"paddingTop",true));var B=this.getValue(K,this.swapForRotation(K,"paddingRight",true));var A=this.getValue(K,this.swapForRotation(K,"paddingBottom",true));var H=this.getValue(K,this.swapForRotation(K,"paddingLeft",true));if(G){K.style.height=P;K.style.width=M;}if(G&&(Q==1||L==3)){K.style.paddingTop=B;K.style.paddingRight=A;K.style.paddingBottom=H;K.style.paddingLeft=I;}else{if(G&&(Q==3||L==1)){K.style.paddingTop=H;K.style.paddingLeft=A;K.style.paddingBottom=B;K.style.paddingRight=I;}else{if(!G&&(Q==1||Q==3)){K.style.paddingTop=A;K.style.paddingBottom=I;K.style.paddingLeft=B;K.style.paddingRight=H;}}}if(E){E.rotation=Q;}else{if(Q==0){return ;}var F=K.style.filter;var D=false;if(F==null||F.length==0){F=this.getFilter(K);if(F!=null&&F.length>0){D=true;}}var J=" progid:DXImageTransform.Microsoft.BasicImage(rotation="+Q+") ";if(D){this.objSheet.styleRules[this.getId(K)].style.filter=J+this.objSheet.styleRules[this.getId(K)].style.filter;}else{K.style.filter=J+K.style.filter;}if(bIsIE8){setFilter(K,"Alpha",{opacity:100});}}}else{var O=-N;this.changeTextFieldRotation(K,O);}};mstrDocStyleImpl.prototype.changeTextFieldRotation=function(E,C){if(bIsDXIE){return ;}if(E.direction===undefined){E.direction="0";}var G=bIsIE10||bIsW3CIE?"t":(bIsFirefox?"MozT":"webkitT"),F=parseInt(this.formattingAttributes[E.id].hm,10),D=this.getValue(E,"width"),B=this.getValue(E,"height"),A={x:parseInt(this.getValue(E,"top")),y:parseInt(this.getValue(E,"left"))};E.style[G+"ransform"]="rotate("+C+"deg)";E.style[G+"ransformOrigin"]="top left";if(C!==0){E.style.width=B;E.style.height=F===0||microstrategy.DISPLAY_MODE===microstrategy.DESIGN_MODE?D:"auto";}else{E.style.width=D;E.style.height=F===0||microstrategy.DISPLAY_MODE===microstrategy.DESIGN_MODE?B:"auto";}this.updateVerticalTextPaddingAndBorder(E,C);this.updateVerticalTextShadow(E,C);E.direction=this.getValue(E,"TextDirection");this.changeVerticalTextPosition(E,A);};mstrDocStyleImpl.prototype.updateVerticalTextPaddingAndBorder=function(D,B){var C={paddingTop:this.getValue(D,"paddingTop"),paddingBottom:this.getValue(D,"paddingBottom"),paddingLeft:this.getValue(D,"paddingLeft"),paddingRight:this.getValue(D,"paddingRight"),borderTopWidth:this.getValue(D,"borderTopWidth"),borderTopStyle:this.getValue(D,"borderTopStyle"),borderTopColor:this.getValue(D,"borderTopColor"),borderBottomWidth:this.getValue(D,"borderBottomWidth"),borderBottomStyle:this.getValue(D,"borderBottomStyle"),borderBottomColor:this.getValue(D,"borderBottomColor"),borderLeftWidth:this.getValue(D,"borderLeftWidth"),borderLeftStyle:this.getValue(D,"borderLeftStyle"),borderLeftColor:this.getValue(D,"borderLeftColor"),borderRightWidth:this.getValue(D,"borderRightWidth"),borderRightStyle:this.getValue(D,"borderRightStyle"),borderRightColor:this.getValue(D,"borderRightColor")},A=function(G,F){for(var E=0;E<4;E++){D.style["padding"+G[E]]=C["padding"+F[E]];D.style["border"+G[E]+"Width"]=C["border"+F[E]+"Width"];D.style["border"+G[E]+"Style"]=C["border"+F[E]+"Style"];D.style["border"+G[E]+"Color"]=C["border"+F[E]+"Color"];}};switch(B){case 0:A(["Top","Bottom","Left","Right"],["Top","Bottom","Left","Right"]);break;case -90:A(["Top","Bottom","Left","Right"],["Left","Right","Bottom","Top"]);break;case 90:A(["Top","Bottom","Left","Right"],["Right","Left","Top","Bottom"]);break;}};mstrDocStyleImpl.prototype.changeVerticalTextPosition=function(G,B){if(bIsDXIE){return ;}var D=G.direction||this.getValue(G,"TextDirection")||"0",A=Math.round(microstrategy.getPaddingAndBorderPixels(G,"height")),C=Math.round(microstrategy.getPaddingAndBorderPixels(G,"width")),F=parseInt(this.getValue(G,"width"),0)+C,E=parseInt(this.getValue(G,"height"),0)+A;if(B.x!==null){if(D==="90"){G.style.top=B.x+E+"px";}else{G.style.top=B.x+"px";}}if(B.y!==null){if(D==="-90"){G.style.left=B.y+F+"px";}else{G.style.left=B.y+"px";}}};mstrDocStyleImpl.prototype.updateVerticalTextShadow=function(F,D){if(!bIsDXIE){var E=parseInt(this.getValue(F,"dropShadowEffect",microstrategy.FORMAT_TYPE_MAIN)),G=parseInt(this.getValue(F,"dropShadowDepth",microstrategy.FORMAT_TYPE_MAIN)),C=0,B=0,A=0;if(E==0||isNaN(E)){G=0;}C=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,Math.round(G*microstrategy.ZOOM_FACTOR/100));B=C;A=C;if(D===-90){B=-C;}else{if(D===90){A=-C;}}F.style[(mstr.utils.ISWK?"webkitBoxShadow":"boxShadow")]=B+"px "+A+"px 3px 0 #888";}};mstrDocStyleImpl.prototype.applyPadding=function(B,C,A){C=this.swapForRotation(B,C);B.style[C]=A;};mstrDocStyleImpl.prototype.applyShadow=function(E,B,H){if(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var G=microstrategy.findBone(E);if(G){G.synchronizeShadow(B=="dropShadowEffect"?H:null,B=="dropShadowDepth"?H:null);}return ;}var C=0;var A=3;switch(B){case"dropShadowDepth":C=parseInt(this.getValue(E,"dropShadowEffect",microstrategy.FORMAT_TYPE_MAIN));A=parseInt(H);break;case"dropShadowEffect":A=parseInt(this.getValue(E,"dropShadowDepth",microstrategy.FORMAT_TYPE_MAIN));C=parseInt(H);break;}var I;var F=this;function D(){if(!document.getElementById(E.getAttribute(microstrategy.HTMLATTR_ID))){window.setTimeout(D,100);return ;}E=document.getElementById(E.getAttribute(microstrategy.HTMLATTR_ID));if(bIsDXIE){if(C==0||isNaN(C)){A=0;}I=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,Math.round(A*microstrategy.ZOOM_FACTOR/100));var M=F.getFilter(E,"dropshadow");if(M){M.color="#66000000";M.positive="true";M.OffX=Math.round(I);M.OffY=Math.round(I);M.enabled=(A>0);}else{if(A==0){return ;}var N=E.style.filter;var J=false;if(N==null||N.length==0){N=F.getFilter(E);if(N!=null&&N.length>0){J=true;}}var K=" progid:DXImageTransform.Microsoft.dropshadow(Color='#66000000', Positive='true', OffX="+I+", OffY="+I+") ";if(J){F.objSheet.styleRules[F.getId(E)].style.filter+=K;}else{E.style.filter+=K;if(mstr.utils.ISIE4){window.setTimeout(function(){E.style.visibility="visible";},100);}}}}else{var L=-parseInt(F.getValue(E,"TextDirection")||"0",0);F.updateVerticalTextShadow(E,L);}}D();};mstrDocStyleImpl.prototype.applyAlpha=function(E,A,I){var F=0;var D=3;switch(A){case"alphaOpacity":F=parseInt(this.getValue(E,"alphaEffect"));D=parseInt(I);break;case"alphaEffect":D=parseInt(this.getValue(E,"alphaOpacity"));F=parseInt(I);break;}if(bIsDXIE){var H=this.getFilter(E,"Alpha");if(F==0){D=0;}if(H){H.opacity=D;H.enabled=(D>0);}else{var C=E.style.filter;var B=false;if(C==null||C.length==0){C=this.getFilter(E);if(C!=null&&C.length>0){B=true;}}var G=" progid:DXImageTransform.Microsoft.Alpha(Transparency="+D+") ";if(B){this.objSheet.styleRules[this.getId(E)].style.filter+=G;}else{E.style.filter+=G;}}}};mstrDocStyleImpl.prototype.getFilter=function(D,A){try{if(A=="Gradient"&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&D.getAttribute("scriptclass")!="mstrPanel"){var E=D.previousSibling;if(E&&E.id==(D.id+gradientUtil.GRADIENT_POSTFIX)){D=E;}}var G=D.currentStyle?D.currentStyle.filter:D.style.filter;if(G==null||G.length==0){var F=this.getId(D);if(!isNaN(F)){G=this.objSheet.styleRules[F].style.filter;}}if(!A){return G;}var B=null;if(G.length>0){B=D.filters["DXImageTransform.Microsoft."+A];}return B;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocStyleImpl.prototype.cascadeSelectorValue=function(C,D,B){var A=microstrategy.bone(C.getAttribute("id")+"_Ctl");if(A){A.cascadeFormatting(C,D,B);}if(A&&A.ctlStyle==mstrRWControlImpl.CTL_STYLE_LIST_BOX&&D.indexOf("textDecoration")==0&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){C.style[D]="none";A[D]=B;}else{C.style[D]=B;}};mstrDocStyleImpl.prototype.getAttValue=function(E,A,D){try{if(!E||!this.formattingAttributes){return null;}if(D&&D!=microstrategy.FORMAT_TYPE_MAIN){var C=mstrStaticDoc.getBone(E);if(C&&C.getAttValue){return C.getAttValue(D,A);}}var F=this.formattingAttributes[E.getAttribute("id")];if(F!=null&&typeof (F[A])!="undefined"){return F[A];}return E.getAttribute(A,0);}catch(B){microstrategy.errors.log(B);return null;}};mstrDocStyleImpl.prototype.setAttValue=function(E,A,D){try{if(microstrategy.formatType!=microstrategy.FORMAT_TYPE_MAIN){var C=mstrStaticDoc.getBone(E);if(C&&C.setAttValue){return C.setAttValue(microstrategy.formatType,A,D);}}var G=E.getAttribute("id");var F=this.formattingAttributes[G];if(typeof (F)=="undefined"){this.formattingAttributes[G]={};this.formattingAttributes[G][A]=D;}else{F[A]=D;}}catch(B){microstrategy.errors.log(B);}return null;};mstrDocStyleImpl.prototype.cloneAttValues=function(D,E){try{var F=this.formattingAttributes[D.getAttribute("id")];if(typeof (F)=="undefined"){return ;}var G=E.getAttribute("id");var B=this.formattingAttributes[G];if(typeof (B)=="undefined"){this.formattingAttributes[G]={};B=this.formattingAttributes[G];}for(var A in F){if(A==microstrategy.HTMLATTR_LOCKED){B[A]=false;}else{B[A]=F[A];}}}catch(C){microstrategy.errors.log(C);}};mstrDocStyleImpl.prototype.getInnerHeight=function(G){try{var B=this.getValue(G,"height");if(isNaN(parseInt(B))||B.indexOf("%")>-1){var F=mstrFormatObject;var D=parseInt(this.getValue(G,"paddingTop"));var E=parseInt(this.getValue(G,"paddingBottom"));D=(isNaN(D))?0:D;E=(isNaN(E))?0:E;var A;if(!this.getValue(G,"TextDirection")||this.getValue(G,"TextDirection")=="0"){A=getObjInnerHeight(G);}else{A=getObjInnerWidth(G);}B=A-F.getPxFromPt(D+E);}return Math.max(parseInt(B),1);}catch(C){microstrategy.errors.log(C);return false;}};mstrDocStyleImpl.prototype.getInnerWidth=function(F){try{var A=this.getValue(F,"width");if(isNaN(parseInt(A))||A.indexOf("%")>-1){var E=mstrFormatObject;var B=parseInt(this.getValue(F,"paddingLeft"));var G=parseInt(this.getValue(F,"paddingRight"));B=(isNaN(B))?0:B;G=(isNaN(G))?0:G;var D;if(!this.getValue(F,"TextDirection")||this.getValue(F,"TextDirection")=="0"){D=getObjInnerWidth(F);}else{D=getObjInnerHeight(F);}A=D-E.getPxFromPt(B+G);}return Math.max(parseInt(A),1);}catch(C){microstrategy.errors.log(C);return false;}};mstrDocStyleImpl.prototype.getCssText=function(C){try{var A="";var D=this.getId(C);if(isNaN(D)){return C.style.cssText;}else{if(this.objSheet.styleRules[D]){A+=this.objSheet.styleRules[D].style.cssText+"; ";}A+=C.style.cssText;}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocStyleImpl.prototype.resolveStyles=function(C,D){try{if(D.indexOf("line")===0){if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)===microstrategy.SUBOBJTYPE_DOC_LINE){var A=(parseInt(this.getAttValue(C,microstrategy.HTMLATTR_ORIENTATION))===microstrategy.ORIENTATION_HORIZONTAL)?"Top":"Left";if(D==="lineColor"){D="border"+A+"Color";}else{if(D==="lineStyle"){D="border"+A+"Style";}else{if(D==="lineWeight"){D="border"+A+"Width";}}}}else{if(D==="lineColor"){D="borderTopColor";}else{if(D==="lineColor2"){D="borderBottomColor";}else{if(D==="lineStyle"){D="borderStyle";}else{if(D==="lineWeight"){D="borderWidth";}}}}}}else{if(D==="textDecoration2"){D="textDecoration";}}return D;}catch(B){microstrategy.errors.log(B);return null;}};mstrDocStyleImpl.prototype.getId=function(B){try{return parseInt(this.getAttValue(B,mstrDocStyleImpl.HTMLATTR_CLASS_ID));}catch(A){microstrategy.errors.log(A);return null;}};mstrDocStyleImpl.prototype.adjustSizes=function(A,E,B,D){try{E=String(E);if(E=="100%"||E=="auto"){return E;}return Math.max(Math.round(parseFloat(E)-microstrategy.getPaddingAndBorderPixels(D,A,B)),0);}catch(C){microstrategy.errors.log(C);return E;}};function mstrDocStyleImpl(A){this.formattingAttributes=A;return this;}mstrStaticDocViewer.prototype=new mstrBoneImpl();mstrStaticDocViewer.prototype.superClass=mstrEditorImpl.prototype;mstrStaticDocViewer.prototype.updateManager=microstrategy.updateManager;mstrStaticDocViewer.prototype.zoom=100;mstrStaticDocViewer.prototype.flags=0;mstrStaticDocViewer.prototype.rulerOn=false;mstrStaticDocViewer.prototype.gridOn=false;mstrStaticDocViewer.prototype.dividerOn=false;mstrStaticDocViewer.prototype.rulerShadeOn=false;mstrStaticDocViewer.prototype.rulers={};mstrStaticDocViewer.prototype.scrollTopPosition=0;mstrStaticDocViewer.prototype.scrollLeftPosition=0;mstrStaticDocViewer.prototype.noDataset=false;mstrStaticDocViewer.prototype.objProps=null;mstrStaticDocViewer.prototype.resizeTimer=null;mstrStaticDocViewer.prototype.totalHeight=0;mstrStaticDocViewer.prototype.gridCellCssPrefix="";mstrStaticDocViewer.prototype.messageID="";mstrStaticDocViewer.prototype.objectID="";mstrStaticDocViewer.prototype.objectType=microstrategy.DSSTYPE_DOC_DEFINITION;mstrStaticDocViewer.prototype.parentFolderID=null;mstrStaticDocViewer.prototype.needSaveBeforeNotes=true;mstrStaticDocViewer.prototype.isMultiLayout=false;mstrStaticDocViewer.prototype.tabCount=0;mstrStaticDocViewer.prototype.sectionSubsections=null;mstrStaticDocViewer.prototype.panelStacks=null;mstrStaticDocViewer.prototype.onLoadCalled=false;mstrStaticDocViewer.prototype.resizedSubsections=null;mstrStaticDocViewer.prototype.documentDataSets=null;mstrStaticDocViewer.prototype.hasHorizontalSections=false;mstrStaticDocViewer.prototype.viewerBone=true;mstrStaticDocViewer.prototype.gradientsOnSS=false;mstrStaticDocViewer.prototype.gridGraphFormatting=true;mstrStaticDocViewer.prototype.dScrollTop=0;mstrStaticDocViewer.prototype.dScrollLeft=0;mstrStaticDocViewer.prototype.needWidthAdjustment=false;mstrStaticDocViewer.prototype.onload=function(){try{this.commands=new mstrViewerCommandsImpl();this.observer=microstrategy.viewerObserver||new mstrObserverImpl();microstrategy.viewerObserver=this.observer;this.initViewer();if(this.layoutHeightMode!=1){this.callDelayedResize();if(this.scrollTopPosition!=0||this.scrollLeftPosition!=0){this.delayedScrollAdjust(this.scrollTopPosition,this.scrollLeftPosition);}}this.onLoadCalled=true;}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.onrepostload=function(B){try{mstrBoneImpl.prototype.onrepostload.call(this);this.observer.notifyAll("onDocReload");}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);this.adjustWidth();this.updateVerticalTextFields();}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.onstatechange=function(){this.observer.notifyAll("onstatechange");};mstrStaticDocViewer.prototype.onObjectBrowserTabChange=function(){this.observer.notifyAll("onObjectBrowserTabChange");};mstrStaticDocViewer.prototype.onselectionchange=function(){this.observer.notifyAll("onselectionchange");};mstrStaticDocViewer.prototype.onreload=function(E){try{this.onLoadCalled=false;this.resizedSubsections={};var G=document.getElementById("docObjectStyleIFrame");if(G){var B=document.getElementById("docObjectStyle");if(B&&B.parentNode){B.parentNode.removeChild(B);}}var F=document.getElementById("consolidatedGridStyleSheetIFrame");if(F){var A=document.getElementById("consolidatedGridStyleSheet");if(A&&A.parentNode){A.parentNode.removeChild(A);}}var D=this.superClass.onreload.call(this,E);this.doc.formattingAttributes=this.formattingAttributes;this.doc.styleObj.reloadFormattingAttributes(this.formattingAttributes);if(!D&&this.doc.hasMoved()){this.onwinresize();}}catch(C){microstrategy.errors.log(C);}};mstrStaticDocViewer.prototype.adjustScrollValues=function(C){try{var A=document.createElement("img");document.body.appendChild(A);A.parentNode.removeChild(A);this.elem.onmousemove=null;this.dScrollTop=this.elem.scrollTop;this.dScrollLeft=this.elem.scrollLeft;return true;}catch(B){microstrategy.errors.log(B);}};mstrStaticDocViewer.prototype.onwinresize=function(){try{this.callDelayedResize();}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.getAvailableDatasets=function(){try{var B=[];if(!this.noDataset){for(var C in this.documentDataSets){B.push({dssid:C,n:this.documentDataSets[C]});}}return B;}catch(A){microstrategy.errors.log(A);return B;}};mstrStaticDocViewer.prototype.delayedScrollAdjust=function(B,C){try{if(this.scrollTimer){window.clearTimeout(this.scrollTimer);}this.scrollTimer=window.setTimeout("microstrategy.bone('"+this.id+"').onscrollAdjust("+B+","+C+")",0);}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.onscrollAdjust=function(B,C){try{if(this.elem&&this.elem.hasChildNodes()){if(this.elem.style){if(B!=0){this.elem.scrollTop=B;this.dScrollTop=B;}if(C!=0){this.elem.scrollLeft=C;this.dScrollLeft=C;}}}}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.callDelayedResize=function(B){try{if(this.resizeTimer){window.clearTimeout(this.resizeTimer);}if(!!B){this.resizeTimer=window.setTimeout("microstrategy.bone('"+this.id+"').doc.onwinresize()",0);}else{this.resizeTimer=window.setTimeout("microstrategy.bone('"+this.id+"').ondialogresize()",0);}}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.ondialogresize=function(){try{if(this.tmr_dr){window.clearTimeout(this.tmr_dr);}iframe.showWaitPage(true);var B=this;this.tmr_dr=window.setTimeout(function(){B.delayedOndialogresize();},300);}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.getAvaiableDocViewerWidth=function getAvaiableDocViewerWidth(){try{var C=mstr.utils.BoxModel,B=C.getBrowserWindowWidth(document);return C.hasScrollbar(document.documentElement,"y")?B+SCROLLBAR_SIZE:B;}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.delayedOndialogresize=function(){var D=this;if(D.elem&&D.elem.hasChildNodes()){if(D.elem.style){var A=getClientHeight();var F=D.getAvaiableDocViewerWidth();var E=getObjSumTop(D.elem);var G=getObjSumLeft(D.elem);var C=0;if(true){C=document.getElementById("mstrWeb_footer").offsetHeight+document.getElementById("mstrWeb_dockBottom").offsetHeight;}D.elem.style.height=Math.max(A-E-4-C,SCROLLBAR_SIZE)+"px";D.elem.style.width=Math.max(F-G-4,SCROLLBAR_SIZE)+"px";if(mstr.utils.ISWK){var B=document.getElementById("mstrWebContents");B.style.overflow="hidden";window.setTimeout(function(){B.style.overflow="auto";},0);}}if(D.doc&&D.doc.onwinresize){D.callDelayedResize(true);}}};mstrStaticDocViewer.prototype.onforcerepaint=function(){try{if(!this.doc||!this.doc.elem){return ;}var A=document.createElement("img");this.doc.elem.appendChild(A);A.parentNode.removeChild(A);}catch(B){microstrategy.errors.log(B);}};mstrStaticDocViewer.prototype.initViewer=function(){try{this.initBone();var C=microstrategy.objectFind(this.elem,["DIV"],microstrategy.OBJTYPE_DOC);if(this.commands){this.commands.parentBone=this;}if(C){var D=C.getAttribute("id");if(!(microstrategy.bone(D))){var A=C.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);this.doc=new window[A](D);this.doc.parentBone=this;this.doc.containsHorizontalSections=this.hasHorizontalSections;if(this.doc.onload){this.doc.onload();}this.needWidthAdjustment=true;}if(this.doc&&this.doc.containsHorizontalSections){this.resize100WMObjects();}}}catch(B){microstrategy.errors.log(B);}};mstrStaticDocViewer.prototype.updateVerticalTextFields=function(){if(bIsDXIE){return ;}var F=function(G){return document.getElementById(G);},A=this.formattingAttributes;if(!A){return ;}var E=A.tdUnits,C;for(C in E){var D=F(C),B=-parseInt(E[C],10);if(D){microstrategy.styleObj.changeTextFieldRotation(D,B);}}};mstrStaticDocViewer.prototype.resize100WMObjects=function(G,K){try{var A="";var F=0;var D=0;var I=null;if(G&&(this.doc.containsHorizontalSections||K)){var H;if(this[G+"_100wm"]!=null){A=String(this[G+"_100wm"]).split(",");for(F=0;F<A.length;F++){I=document.getElementsByName(A[F]);H=getObjWidth(document.getElementById(G))+"px";for(D=0;I!=null&&D<I.length;D++){if(I[F]&&microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){H=getObjWidth(I[F].parentNode)+"px";}I[D].style.width=this.doc.removePaddingAndBorder(I[D],H,"width")+"px";}}}}else{var J=getObjWidth(this.doc.elem)+"px";var E=this.doc.selections;A=String(this.viewer100wm).split(",");for(F=0;F<A.length;F++){I=document.getElementsByName(A[F]);var B=microstrategy.findBone(I[0]);if(B&&!B.isHorizontal){for(D=0;I!=null&&D<I.length;D++){I[D].style.width=this.doc.removePaddingAndBorder(I[D],J,"width")+"px";}if(E!=null){E.syncUp(I[0]);}}}}}catch(C){microstrategy.errors.log(C);}};mstrStaticDocViewer.prototype.resize100HMObjects=function(F,J){try{if(this[F+"_100hm"]!=null){var A=String(this[F+"_100hm"]).split(",");for(var E=0;E<A.length;E++){if(J){var D=microstrategy.findChildWithAtt(J,"SPAN","id",A[E]);if(D){var I=(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.RESIZE_EACH_SUBSECTION)?document.getElementById(F):D.parentNode;D.style.height=this.doc.removePaddingAndBorder(D,getObjHeight(I)+"px","height")+"px";}}else{var H;var G=document.getElementsByName(A[E]);if(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.RESIZE_EACH_SUBSECTION){H=getObjHeight(document.getElementById(F))+"px";}for(var C=0;G!=null&&C<G.length;C++){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){H=getObjHeight(G[C].parentNode)+"px";}G[C].style.height=this.doc.removePaddingAndBorder(G[C],H,"height")+"px";}}}}}catch(B){microstrategy.errors.log(B);}};mstrStaticDocViewer.prototype.syncDocRszHandler=function(){};mstrStaticDocViewer.prototype.setZoom=function(A){this.zoom=A;return false;};mstrStaticDocViewer.prototype.setFlags=function(A){return false;};mstrStaticDocViewer.prototype.getChildBone=function(C){try{if(this.doc==null||!this.doc.isLoaded){return null;}var A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(A){case microstrategy.OBJTYPE_DOC:return this.doc;break;case microstrategy.OBJTYPE_DOC_SUBSECTION:case microstrategy.OBJTYPE_DOC_SECTION:case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:return this.doc.getChildBone(C);break;}return null;}catch(B){microstrategy.errors.log(B);return false;}};mstrStaticDocViewer.prototype.handleTaskModelReadyStateChange=function(A){try{this.doc.handleTaskModelReadyStateChange(A);}catch(B){microstrategy.errors.log(B);}};mstrStaticDocViewer.prototype.findParentSubsection=function(C){try{var A=microstrategy.findAncestorWithAtt(C.parentNode,"ty",microstrategy.OBJTYPE_DOC_SUBSECTION);if(A&&A.getAttribute("sty")){A=this.findParentSubsection(A);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrStaticDocViewer.prototype.isInteractiveViewModeEplus=function(A){return false;};mstrStaticDocViewer.prototype.isEditableViewModeEplus=function(){return false;};mstrStaticDocViewer.prototype.adjustWidth=function(){try{if(this.needWidthAdjustment&&this.doc&&this.doc.adjustWidth){this.doc.adjustWidth();}this.needWidthAdjustment=false;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDocViewer.onUnitReload=function(D){try{if(!D.elem){return ;}var B=microstrategy.getViewerBone();if((!B)||B.onLoadCalled){return ;}if(!B.resizedSubsections){B.resizedSubsections={};}var E=B.findParentSubsection(D.elem);if((!E)||B.resizedSubsections[E.id]){return ;}var A=microstrategy.findBone(E);if(A&&A.resizeSubsection){A.resizeSubsection();B.resizedSubsections[E.id]=true;}B.doc.synchHeightOfHorizontalSections();}catch(C){microstrategy.errors.log(C);}};mstrStaticDocViewer.prototype.setNeedWidthAdjustment=function(B){try{this.needWidthAdjustment=this.isLoaded&&B;}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.getAllVisList=function(){return this.allVisList;};mstrStaticDocViewer.prototype.showWarningMessageForUnsupportFeature=function(B,A){if(this.isFeatureAvailable("rw-support-flash-mode")){showMessage({contents:microstrategy.descriptors.getDescriptor(13964),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:B,cancelEval:A,type:mstrMsgBoxImpl.MSG_WARNING});}else{B();}};mstrStaticDocViewer.prototype.checkAndDisableFlashDefaultMode=function(B,D){if(this.DefaultViewMode===mstr.Enum.VIEWMEDIA.FLASH){var C=mstr.Enum.VIEWMEDIA,E=this.AvailableViewModes,A=(C.STATIC&E)?C.STATIC:(C.INTERACTIVE&E)?C.INTERACTIVE:0;D.push(B.createActionObject(null,mstrUpdateManager.SET_VIEW_MEDIA,this.beanPath,["2048163"],[A],[]));}};function mstrStaticDocViewer(A){this.inherits=mstrEditorImpl;this.inherits(A);this.inherits=null;this.primaryBone=true;return this;}mstrTabImplScript=true;mstrTabImpl.prototype=new mstrEditorImpl();mstrTabImpl.prototype.settings=new Array();mstrTabImpl.prototype.settingsNameArray=new Array();mstrTabImpl.prototype.enforceSubmit=false;mstrTabImpl.prototype.currentPropertyName=null;mstrTabImpl.prototype.tabManager=null;mstrTabImpl.prototype.PIXEL_WIDTH=2;mstrTabImpl.prototype.cmdLevel=null;mstrTabImpl.prototype.appliesTo=null;mstrTabImpl.prototype.tabSwitch=null;mstrTabImpl.CMD_TYPE_DEFAULT=0;mstrTabImpl.CMD_TYPE_BITFLAG=1;mstrTabImpl.prototype.onload=function(){try{this.initEditor();if(this.elem&&this.elem.parentNode){var A=this.elem.parentNode.getAttribute("at");if(A&&A.length>0){this.appliesTo=A;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.onunload=function(C){try{mstrEditorImpl.prototype.onunload.call(this,C);var B=this.getAppliesTo();if(B&&B.observer){B.observer.unregister(this.id);}}catch(A){microstrategy.errors.log(A);}return true;};mstrTabImpl.prototype.exec=function(A,H){try{switch(A){case"advColorPicker":var G=H.split("|");var F=document.getElementById(G[0]);if(F){this.updateColorPicker(F,G[1]);}break;case"edtColorGradient":var G=H.split("|");var F=document.getElementById(G[0]);var E=G[1].split(",");if(E.length>=2&&(E[0]==E[1])){if(F){this.updateColorPicker(F,E[0]);}break;}else{if(F){F.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);var C=F.getElementsByTagName("span");if(C.length>0){C[0].setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);}else{F.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);}var B=document.getElementById(this.id+F.getAttribute(microstrategy.HTMLATTR_CMD_ID));if(B){B.value=G[1];if(!this.initializing){B.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);}}}this.updateColorPickerGradient(H);break;}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.showOptions=function(E){try{if(!E){return false;}var D=E.parentNode.getElementsByTagName(E.tagName);for(var B=0;B<D.length;B++){var A=D[B].id;if(A){A=document.getElementById("div"+A);}if(A){A.style.display=(D[B]==E)?"block":"none";}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);}};mstrTabImpl.prototype.togglePicker=function(A,D,B){try{if(B&&(!B.disabled)){dropDown.togglePicker(A,D,B,this);}}catch(C){microstrategy.errors.log(C);}return false;};mstrTabImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.checkForFormatChanges=function(){try{return false;}catch(A){microstrategy.errors.log(A);}};mstrTabImpl.prototype.applyFormatChanges=function(A,B){try{return B;}catch(C){microstrategy.errors.log(C);return B;}};mstrTabImpl.prototype.checkRGBColors=function(B,A){try{if((A!=null)&&(B.toLowerCase().indexOf("color")>-1)){A=mstr.utils.Color.rgbStr2hex(A);}return A;}catch(C){microstrategy.errors.log(C);return A;}};mstrTabImpl.prototype.applyPropertyChanges=function(G){try{for(counter=0;counter<this.settings.length;counter++){var C=this.settings[counter];var F=C.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(F!=null){var D=C.getAttribute(microstrategy.HTMLATTR_CMD_ID);var B=C.getAttribute(microstrategy.HTMLATTR_CMD_LEVEL);if(!B){B=this.cmdLevel;}var A=new this.propChangeObject(C,D,F,null,null,B);G.push(A);if(!this.enforceSubmit){C.removeAttribute(microstrategy.HTMLATTR_CMD_VALUE);}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrTabImpl.prototype.propChangeObject=function(E,B,G,D,A,C,F){this.obj=E;this.cmdId=B;this.value=G;this.performFormatChange=D;this.submitUpdateManager=A;this.level=(C!=null)?C:this.cmdLevel;this.formatType=(F!=null)?F:microstrategy.FORMAT_TYPE_MAIN;return this;};mstrTabImpl.prototype.simpleInitCheckValue=function(D,C,A){try{if(D&&D.tagName.toLowerCase()!="input"){if(C==0){D.src=microstrategy.FOLDER_IMAGES+"check_off.gif";D.setAttribute("cv","0");}else{D.src=microstrategy.FOLDER_IMAGES+"check_on.gif";D.setAttribute("cv","-1");}}else{if((C||typeof (C)=="boolean")&&D){if(C&D.value||C==D.value){D.checked=true;}else{D.checked=false;}}}if(D){if(A==null||A=="true"){D.onclick();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initCheckValue=function(B,A,H,C,F){try{var G=document.getElementById(H);if(!G||!B||!B.commands){return ;}if(F==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),F))){if(B.commands.queryEnabled()&&B.commands.queryEnabled(A)){var E=B.commands.queryState(A);this.simpleInitCheckValue(G,E,C);return ;}}this.disableObj(H);}catch(D){microstrategy.errors.log(D);}};mstrTabImpl.prototype.simpleInitTextValue=function(D,C,A){try{if((C||(C!=null&&C.length==0))&&D){D.value=C;if(A==null||A=="true"){D.onchange();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initTextValue=function(B,A,H,C,F){try{if(document.getElementById(H)){if(F==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),F))){if(B.commands&&B.commands.queryEnabled()){if(B.commands.queryEnabled(A)){var E=B.commands.queryState(A);var G=document.getElementById(H);this.simpleInitTextValue(G,E,C);}}}else{this.disableObj(H);}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.simpleInitRadioValue=function(D,C,A){try{if(D){D.checked=true;if(A==null||A=="true"){D.onclick();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initRadioValue=function(A,J,I,F,E){try{var B=document.getElementsByName(I);if(B){if(E==null||(A.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(A.commands.queryState("selectedItems"),E))){if(A.commands&&A.commands.queryEnabled()){if(A.commands.queryEnabled(J)){var H=A.commands.queryState(J);var G=document.getElementById(I+H);this.simpleInitRadioValue(G,H,F);}}}else{for(var D=0;D<B.length;D++){this.disableOptionAndLabel(B[D]);}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.simpleInitLabelValue=function(C,B){try{if(B&&C){C.innerHTML=B;}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.disableOptionAndLabel=function(A){try{if(A){A.disabled=true;A.className="disabled";if(document.getElementById(A.id+"_label")){document.getElementById(A.id+"_label").className="disabledLabel";}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.enableOptionAndLabel=function(A){try{if(A){A.disabled=false;A.className="";if(document.getElementById(A.id+"_label")){document.getElementById(A.id+"_label").className="";}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initLabelValue=function(B,A,F){try{if(B.commands&&B.commands.queryEnabled()){if(B.commands.queryEnabled(A)){var D=B.commands.queryState(A);var E=document.getElementById(F);this.simpleInitLabelValue(E,D);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.simpleInitComboValue=function(H,J,G){try{if(J!=null&&(J.toString()).length>0&&H!=null){var F=parseInt(H.getAttribute(microstrategy.HTMLATTR_CMD_TYPE));switch(F){case mstrTabImpl.CMD_TYPE_BITFLAG:var B=H.options;var E=-1;var I=parseInt(J);var A=0;for(var D=0;D<B.length;D++){var L=B.item(D);var K=parseInt(L.value);if((((I&K)||(K==A))&&(K>E))||(K==0==I)){E=K;I=I-K;A+=K;}if((I==0)&&(K==A)&&(E>-1)){break;}}if(E>-1){H.value=E;}break;default:H.value=J;}if(G==null||G=="true"){H.onchange();}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.initComboValue=function(B,A,H,C,F){try{if(F==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),F))){if(B.commands&&B.commands.queryEnabled()){if(B.commands.queryEnabled(A)){var E=B.commands.queryState(A);var G=document.getElementById(H);this.simpleInitComboValue(G,E,C);}}}else{this.disableObj(H);}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.initColorPickerValue=function(B,A,G,E){try{if(E==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),E))){if(B.commands&&B.commands.queryEnabled()){var D;var F=document.getElementById(G);if(A=="bgcolor"){D=F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!D&&B.commands.queryEnabled("gradientcolor")){D=B.commands.queryState("gradientcolor");}}if(B.commands.queryEnabled(A)){if((A=="bgcolor"&&!D)||A!="bgcolor"){D=B.commands.queryState(A,this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}this.updateColorPicker(F,D);}}}else{if(document.getElementById(G)){document.getElementById(G).disabled=true;document.getElementById(G).className="mstrPulldowndisabled";}if(document.getElementById(G+"_label")){document.getElementById(G+"_label").className="disabledLabel";}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.setAppliesTo=function(B){if(B==null){return true;}try{if(!this.appliesTo){this.appliesTo=(typeof (B)=="string")?B:B.id;}B=microstrategy.bone(this.appliesTo);if(B.observer){B.observer.register(this.id);}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.isEnabled=function(A,D){try{var B=microstrategy.isEnabled(A,D);return B;}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.updateList=function(A){};mstrTabImpl.prototype.updateText=function(C,A){try{if(C&&(typeof (A)=="undefined"||!A)){C.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,C.value);}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.updateCheck=function(C){try{if(C){var B=(C.checked)?"-1":"0";C.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,B);}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.updateDropdown=function(E,C,D,A){try{if(E){E.innerHTML=C;if(typeof (A)=="undefined"||!A){E.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.updateColorPicker=function(E,D,A){try{if(D==null){D="transparent";}if(E&&(D!="-2")){var B=E.getElementsByTagName("span");if(D&&D.indexOf(",")>=0&&D.indexOf("rgb")<0){this.updateColorPickerGradient(E.id+"|"+D);}else{if(B.length>0){B[0].style.backgroundColor=D;if(!D||D=="transparent"){B[0].innerHTML=microstrategy.descriptors.getDescriptor(3779);}else{B[0].innerHTML="";}}else{E.style.backgroundColor=D;}}if(typeof (A)=="undefined"||!A){E.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.getColorPickerValue=function(E){try{var D="";if(E){var A=E.getElementsByTagName("span");var B=null;if(A.length>0){B=A[0];}else{B=E;}D=B.style.backgroundColor;}return D;}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.disableObj=function(A){try{if(document.getElementById(A)){this.disableOptionAndLabel(document.getElementById(A));}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.enableObj=function(A){try{if(document.getElementById(A)){this.enableOptionAndLabel(document.getElementById(A));}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.allSelectedItemsAreOfType=function(C){try{var G=true;var A=this.getAppliesTo();var B=A.commands.queryState("selectedItems");for(var E in B){var F=B[E].getAttribute("sty");if(F!=C){G=false;break;}}return G;}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.cleanup=function(A){};mstrTabImpl.prototype.getJSONProperty=function(A,E,D){try{var B="";if(A!=null&&E!=null){E=(D)?E:'"'+E+'"';E=E.replace(/%5C/g,"%5C%5C");E=E.replace(/%22/g,"%5C%22");B+='"'+A+'":'+E+",";}return B;}catch(C){microstrategy.errors.log(C);return"";}};mstrTabImpl.prototype.getChanges=function(){try{var C="";var B;for(B=0;B<this.settings.length;B++){var A=this.settings[B];var D=A.getAttribute(microstrategy.HTMLATTR_CMD_ID);var F=this.getChangedValue(A);C+=this.getJSONProperty(D,F);}if(C.length>0){C=C.substring(0,C.length-1);}return C;}catch(E){microstrategy.errors.log(E);return false;}};mstrTabImpl.prototype.getChangedValue=function(A){try{var C=A.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(C==null){if(A.nodeName.toLowerCase()=="input"&&A.type.toLowerCase()=="checkbox"){C=A.checked;}}return C;}catch(B){microstrategy.errors.log(B);return null;}};mstrTabImpl.prototype.saveTabSelections=function(){var C="{"+this.getChanges(true)+"}";var B=this.tabManager.selectedTabOptions||"";var A=B.length;if(A){B=B.substring(1,A-1)+",";}this.tabManager.selectedTabOptions="{"+B+'"'+this.id+'":'+C+"}";microstrategy.updateManager.replaceURL("selectedTabOptions",this.tabManager.selectedTabOptions);};mstrTabImpl.prototype.restorePreviousSelections=function(A){try{for(var B in A){var D=document.getElementById(this.id+B);if(D!=null&&A[B]!=null&&D.id==this.id+B){this.restoreEachSelection(D,B,A[B]);}else{if(D==null||D.getAttribute("name")==this.id+B){this.updateSpecialCases(B,A[B]);}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.restoreEachSelection=function(E,A,D){try{if(A.indexOf("Color")>-1){this.updateColorPicker(E,D);}else{var F=E.nodeName;switch(F.toLowerCase()){case"select":this.updateComboBox(E,D);this.updateList(E);break;case"input":var B=E.type.toLowerCase();switch(B){case"checkbox":this.reselectCheckBox(E,D);this.updateCheck(E);break;case"radio":this.updateRadioButton(E,D);break;case"text":this.updateText(E);break;}break;default:E.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.updateRadioButton=function(B,A){};mstrTabImpl.prototype.updateSpecialCases=function(A,B){};mstrTabImpl.prototype.reselectCheckBox=function(field,value){try{field.checked=eval(value);}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.updateComboBox=function(F,E){try{var B=F.childNodes;var A=-1;var G=0;for(var C=0;C<B.length;C++){if(B[C]!=null&&B[C].nodeName.toLowerCase()=="option"){if(this.matchesListValue(B[C].value,E,F.getAttribute(microstrategy.HTMLATTR_CMD_ID))){A=G;break;}G++;}}F.selectedIndex=A;F.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,E);}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.matchesListValue=function(B,D,A){try{return(B==D);}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.openAdvancedColorPicker=function(B,A,C){try{if(B&&B.commands){var E=mstr.utils.Color.rgbStr2hex(C);B.commands.exec("edtColorPicker",this.id+"|"+this.id+A+"|"+E+"|"+this.tabManager.getChangedTabOptions());}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.openColorGradientEditor=function(A,B){try{if(A&&A.commands){A.commands.exec("edtColorGradient",B+"|"+this.tabManager.getChangedTabOptions());}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.openColorGradientEditor=function(A,C,B){try{if(A&&A.commands){if(B==true){A.commands.exec("graphEdtColorGradient",C+"|"+this.tabManager.getChangedTabOptions());}else{this.tabManager.adjustFormatType();A.commands.exec("edtColorGradient",C+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.openGradientColorPicker=function(B,J,I,H,C,D,G,E){try{if(B&&B.commands){this.tabManager.adjustFormatType();if(!C){B.commands.exec("edtColorGradient",this.id+"|"+this.id+J+"|"+0+"|"+I+"|"+H+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}else{var A=((D==0&&G==0)||(D==90&&E==0))?0:1;B.commands.exec("edtColorGradient",this.id+"|"+this.id+J+"|"+A+"|"+I+"|"+H+"|"+C+"|"+D+"|"+G+"|"+E+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}catch(F){microstrategy.errors.log(F);return false;}};mstrTabImpl.prototype.updateColorPickerGradient=function(J){try{var N=J.split("|");var F=document.getElementById(N[0]);F.style.backgroundColor="transparent";var K=F.getElementsByTagName("span");if(K.length>0){F=K[0];}else{return false;}F.innerHTML="";var O=N[1].split(",");var H=getObjInnerWidth(F);var G=getObjInnerHeight(F);if(H%2==1){H=H-1;}if(G%2==1){G=G-1;}var S=gradientUtil.getRGBColor(O[0]);var A=gradientUtil.getRGBColor(O[1]);var Q=(O[3]==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;var U=O[4];var D=O[5];var T=(Q==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL&&U!=100)||(Q==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL&&D!=100)?1:2;var R=(H/gradientUtil.PIXEL_WIDTH)*(G/gradientUtil.PIXEL_WIDTH);for(var L=0;L<R;L++){var B=document.createElement("div");B.className="pixel";var P=gradientUtil.getColorPercent(gradientUtil.getXCoordinate(L,H),gradientUtil.getYCoordinate(L,G),T,H,Q);var E=parseInt(P*(A[0]-S[0]))+S[0];var I=parseInt(P*(A[1]-S[1]))+S[1];var M=parseInt(P*(A[2]-S[2]))+S[2];B.style.backgroundColor="rgb("+E+", "+I+", "+M+")";F.appendChild(B);}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.initSettings=function(){try{if(this.settingsNameArray.length==0){return ;}this.settings=new Array();for(var A=0;A<this.settingsNameArray.length;A++){var C=document.getElementById(this.id+this.settingsNameArray[A]);if(C){this.settings.push(C);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initCtrlValue=function(G,D){try{var B=this.getAppliesTo();if(!B){return ;}var A=G.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(B.commands&&B.commands.queryEnabled(A)){var F=B.commands.queryState(A);var C=G.type||G.getAttribute("type");switch(C){case"text":this.simpleInitTextValue(G,F,D);break;case"checkbox":this.simpleInitCheckValue(G,(F==true),D);break;case"colorpicker":this.updateColorPicker(G,F);break;case"picker":break;}}else{this.disableObj(fieldName);}}catch(E){microstrategy.errors.log(E);return false;}};mstrTabImpl.prototype.updateCtrl=function(B){try{if(!B){return ;}if(this.initializing){return ;}switch(B.type){case"text":B.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,B.value);break;case"checkbox":B.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,(B.checked)?microstrategy.TRUE:microstrategy.FALSE);break;}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.getSwitchMode=function(){try{if(!this.tabSwitch){if(this.tabManager){this.tabSwitch=microstrategy.findChildWithAtt(this.tabManager,"td","tab",this.id);}}if(this.tabSwitch){return this.tabSwitch.getAttribute(microstrategy.TAB_SWITCH_MODE);}return 0;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.setSwitchMode=function(B){try{if(!this.tabSwitch){if(this.tabManager){this.tabSwitch=microstrategy.findChildWithAtt(this.tabManager,"td","tab",this.id);}}if(this.tabSwitch){this.tabSwitch.setAttribute(microstrategy.TAB_SWITCH_MODE,B);}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.afterresize=function(){try{if(mstrEditorImpl.prototype.afterresize){mstrEditorImpl.prototype.afterresize.call(this);}var D=microstrategy.findChildrenWithAtt(this.elem,"div","ty");for(var B=0;B<D.length;B++){var A=microstrategy.findBone(D[B]);if(A&&A.afterresize){A.afterresize();}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.onwinresize=function(){try{if(mstrEditorImpl.prototype.onwinresize){mstrEditorImpl.prototype.onwinresize.call(this);}this.resize();}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.resize=function(){try{if(mstrEditorImpl.prototype.resize){mstrEditorImpl.prototype.resize.call(this);}var D=microstrategy.findChildrenWithAtt(this.elem,"div","ty");if(D){for(var B=0;B<D.length;B++){var A=microstrategy.findBone(D[B]);if(A&&A.resize){A.resize();}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.toggleCheck=function(C,A){if(this.initializing!=false){return false;}var D=parseInt(C.getAttribute("cv"),10)-1;if(D<-2){D=0;}var B="check_off.gif";if(D==-1){B="check_on.gif";}else{if(D==-2){if(A){B="Check_conflict.gif";}else{D=0;}}}C.src=microstrategy.FOLDER_IMAGES+B;C.setAttribute("cv",D);C.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);return true;};mstrTabImpl.prototype.unregister=function(){try{var C=microstrategy.findChildrenWithAtt(this.elem,"div","ty");if(C){for(var A=0;A<C.length;A++){microstrategy.unRegisterBone(C[A].getAttribute("id"));}}}catch(B){microstrategy.errors.log(B);return false;}};function mstrTabImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);delete this.inherits;return this;}mstrObjectBrowserImplScript=true;mstrObjectBrowserImpl.prototype=new mstrEditorImpl();mstrObjectBrowserImpl.prototype.updateManager=microstrategy.updateManager;mstrObjectBrowserImpl.prototype.tree=null;mstrObjectBrowserImpl.prototype.selections=null;mstrObjectBrowserImpl.prototype.mask=null;mstrObjectBrowserImpl.prototype.dragSource=null;mstrObjectBrowserImpl.prototype.dndHelper=null;mstrObjectBrowserImpl.prototype.type=microstrategy.OBJTYPE_OBJBROWSER;mstrObjectBrowserImpl.prototype.isRWTab=false;mstrObjectBrowserImpl.prototype.onload=function(){try{this.dragSource=null;this.initEditor();this.initTree();if(typeof (mstrMaskImpl)!="undefined"){this.mask=new mstrMaskImpl();}this.maskFor=microstrategy.OBJTYPE_ANY;this.updateManager=microstrategy.updateManager;this.dndHelper=new mstrDNDHelperImpl(this);var B=microstrategy.findAncestorWithAtt(this.elem,"scriptClass","mstrAccordionTabManagerImpl");if(B){this.tabManager=microstrategy.findBone(B);}if(bIsIE4){this.elem.onselectstart=new Function("return microstrategy.bone('"+this.id+"').onselectstart();");}}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.onpostload=function(){try{if((microstrategy.IS_RELOAD||(bIsW3C&&!bIsIE4))&&!this.isRWTab){microstrategy.eventManager.ondialogresize();}}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.cancelContextMenu=function(C){try{if(!C){C=window.event;}var B=getEventTarget(C);if(B!=null){if((B.nodeName.toLowerCase()=="input"&&(B.getAttribute("type")=="text"||B.getAttribute("type")=="password"))||(B.nodeName.toLowerCase()=="textarea")){return true;}}if(this.selections!=null&&!this.selections.isSameType()){if(bIsIE4){C.cancelBubble=true;}return false;}return true;}catch(A){microstrategy.errors.log(A);return true;}};mstrObjectBrowserImpl.prototype.resize=function(){try{if(!this.elem){return ;}var C=250;var A=Math.max(getClientHeight()-getObjSumTop(this.elem)-getFooterHeight(),C);if(A!=parseInt(this.elem.style.height)){if(bIsIE7){A=A-SCROLLBAR_SIZE;}this.elem.style.height=A+"px";microstrategy.updateBrowserSetting("obH",getObjHeight(this.elem));}if(this.moveResizeHandles){this.moveResizeHandles();}if(this.resizeContents){this.resizeContents();}if(this.mask&&this.mask.onmaskedobjectresize){this.mask.onmaskedobjectresize();}}catch(B){microstrategy.errors.log(B);return false;}};mstrObjectBrowserImpl.prototype.onwinresize=function(){try{var B=function(){var C=microstrategy.bone(this.id);if(C&&C.resizeObjectBrowser){C.resizeObjectBrowser();}};window.setTimeout(B,0);}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.resizeObjectBrowser=function(){try{if((!(this.elem))||(!(this.elem.style))||!(isInDocument(this.elem))){return false;}this.resize();}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.hasMetrics=function(){try{}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.afterresize=function(){try{if(this.resizeContents){this.resizeContents();}microstrategy.updateBrowserSetting("obW",getObjWidth(this.elem));microstrategy.updateBrowserSetting("obH",getObjHeight(this.elem));}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.onnotifydrag=function(A,E,B){try{if((microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION)&&(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE)&&!this.isFeatureAvailable(microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS)){return ;}if(E!=this&&E.deleteItems){var C=false;if(microstrategy.EXECUTION_SCOPE!=microstrategy.RWD_EXECUTION){if(microstrategy.getViewerBone()){if(!microstrategy.getViewerBone().isFeatureAvailable(microstrategy.FEATURE_MODIFY_REPORT_LIST)){return ;}}C=this.isFeatureAvailable(microstrategy.FEATURE_WEB_PIVOT);}else{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.isFeatureAvailable(microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS)){C=true;}}if(C){this.mask.toggle(true,microstrategy.OBJTYPE_ANY);this.dragSource=E;}}}catch(D){microstrategy.errors.log(D);return false;}};mstrObjectBrowserImpl.prototype.ondrop=function(C,A){try{if(this.dragSource){this.dragSource.deleteItems(A.getItems());}}catch(B){microstrategy.errors.log(B);return false;}};mstrObjectBrowserImpl.prototype.onselectstart=function(C){try{if(!C){C=window.event;}var B=getEventTarget(C);if(B){if((B.nodeName.toLowerCase()=="input"&&(B.getAttribute("type")=="text"||B.getAttribute("type")=="password"))||(B.nodeName.toLowerCase()=="textarea")){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrObjectBrowserImpl.prototype.onselectionchange=function(B){try{}catch(A){microstrategy.errors.log(A);}};mstrObjectBrowserImpl.prototype.ondocumentclick=function(B){try{if(this.selections&&this.selections.ondocumentclick){this.selections.ondocumentclick(B);}}catch(A){microstrategy.errors.log(A);}};mstrObjectBrowserImpl.prototype.close=function(){try{mstrEditorImpl.prototype.close.call(this);if(bIsW3C&&!bIsIE4&&!this.isRWTab){microstrategy.eventManager.ondialogresize();}}catch(A){microstrategy.errors.log(A);}};mstrObjectBrowserImpl.prototype.initTree=function(){try{var A=microstrategy.subObjectFind(this.elem,["DIV"],microstrategy.SUBOBJTYPE_TREE);if(A!=null){this.tree=new mstrTreeImpl(A.getAttribute("id"));this.tree.parentBone=this;this.tree.path="microstrategy.bone('"+this.id+"').tree";if(this.tree.onload){this.tree.onload();}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrObjectBrowserImpl.prototype.getAttributeForms=function(E){try{var A=[];var C=findTargetTag(E,"LI");var B=C.lastChild;if(B!=null&&B.tagName.toLowerCase()=="ul"){A=B.getElementsByTagName("span");}return A;}catch(D){microstrategy.errors.log(D);return false;}};mstrObjectBrowserImpl.prototype.getDNDHelperImage=function(C,A){try{return(C.id==this.id)?null:microstrategy.FOLDER_IMAGES+"XDelete.gif";}catch(B){microstrategy.errors.log(B);}return null;};function mstrObjectBrowserImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);delete this.inherits;return this;}mstrObjSelectionsImplScript=true;mstrObjSelectionsImpl.prototype=new mstrSelectionsImpl();mstrObjSelectionsImpl.prototype.updateManager=microstrategy.updateManager;mstrObjSelectionsImpl.prototype.selectedClass="selected";mstrObjSelectionsImpl.prototype.onmouseup=function(B){try{this.parentBone.dndHelper.onmouseup(this.path);}catch(A){microstrategy.errors.log(A);}};mstrObjSelectionsImpl.prototype.ondocumentclick=function(C){try{if(!this.isActive()){return ;}if(!C){C=window.event;}if(C.e){C=C.e;}var B=microstrategy.findAncestor(getEventTarget(C));if(B==null){this.clear();return ;}var D=B.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(D==microstrategy.OBJTYPE_CONTEXT_MENU||D==microstrategy.OBJTYPE_MESSAGE_BOX){return ;}if(this.needToClear(B)){this.clear();}}catch(A){microstrategy.errors.log(A);}};mstrObjSelectionsImpl.prototype.needToClear=function(B){var A=findTarget(B,microstrategy.HTMLATTR_SCRIPTCLASS);return(A==null||A.getAttribute("id")!=this.parentBone.id);};mstrObjSelectionsImpl.prototype.add=function(C,D){try{C=(C.tagName.toLowerCase()=="span"&&C.parentNode.tagName.toLowerCase()=="span"&&C.parentNode.className.indexOf("mstrIcon-lv")>-1)?C.parentNode.nextSibling:C;if(D){if(D.length==0){D.push(C);}else{D[0]=C;}}mstrSelectionsImpl.prototype.add.call(this,C);var A=C.className;C.className=(typeof (A)=="undefined")?this.selectedClass:this.selectedClass+" "+A;}catch(B){microstrategy.errors.log(B);}return false;};mstrObjSelectionsImpl.prototype.resetClassName=function(D){try{var C="";if(D){var A=D.className;if((A.length>0)&&(A.indexOf(this.selectedClass)==0)){C=A.substr(this.selectedClass.length);}else{C=A;}D.className=C;}}catch(B){microstrategy.errors.log(B);}return true;};mstrObjSelectionsImpl.prototype.remove=function(B){try{mstrSelectionsImpl.prototype.remove.call(this,B);this.resetClassName(B);}catch(A){microstrategy.errors.log(A);}return false;};mstrObjSelectionsImpl.prototype.clear=function(){try{for(var B in this.items){this.resetClassName(this.items[B]);}mstrSelectionsImpl.prototype.clear.call(this);}catch(A){microstrategy.errors.log(A);}return false;};mstrObjSelectionsImpl.prototype.getItems=function(){try{var A=mstrSelectionsImpl.prototype.getItems.call(this);if(A!=null&&A.length>0){if(A[0].getAttribute(microstrategy.HTMLATTR_ID)!=A[0].getAttribute(microstrategy.HTMLATTR_DSS_ID)){A.sort(function(D,C){return parseInt(D.getAttribute("id").substr(32))-parseInt(C.getAttribute("id").substr(32));});}}return A;}catch(B){microstrategy.errors.log(B);return null;}};function mstrObjSelectionsImpl(){this.inherits=mstrSelectionsImpl;this.inherits();delete this.inherits;return this;}mstrFormatImplScript=true;mstrFormatImpl.prototype=new mstrEditorImpl();mstrFormatImpl.prototype.childrenTabs=new Array();mstrFormatImpl.prototype.changesApplied=0;mstrFormatImpl.prototype.currentTab=1;mstrFormatImpl.prototype.actionId=microstrategy.OPEN_EDITOR_ACTION_EDIT;mstrFormatImpl.prototype.selectedTabOptions="";mstrFormatImpl.prototype.autoSubmitJS=null;mstrFormatImpl.prototype.sharedObj=null;mstrFormatImpl.prototype.useDynamicTitle=false;mstrFormatImpl.prototype.titleContainer=null;mstrFormatImpl.prototype.targetAxis=null;mstrFormatImpl.prototype.targetLevel=null;mstrFormatImpl.prototype.targetUnit=null;mstrFormatImpl.prototype.targetPosition=null;mstrFormatImpl.prototype.submitUponTargetLevelChange=true;mstrFormatImpl.prototype.axisOptionId=null;mstrFormatImpl.prototype.levelOptionId=null;mstrFormatImpl.prototype.targetOptions=null;mstrFormatImpl.prototype.levelOptions=null;mstrFormatImpl.prototype.commands=null;mstrFormatImpl.prototype.helpButton=null;mstrFormatImpl.prototype.defaultHelpURL=null;mstrFormatImpl.panelStackOptionsMapDescriptors=[["4579","3297"],["512"]];mstrFormatImpl.gridContainerOptionsMapDescriptors=[["4579","3297"],["512"]];mstrFormatImpl.panelStackOptionsMap=[[{name:"",value:0},{name:"",value:1}],[{name:"",value:2}]];mstrFormatImpl.gridContainerOptionsMap=[[{name:"",value:8},{name:"",value:9}],[{name:"",value:8}]];mstrFormatImpl.prototype.onload=function(){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.onload",mstrLogImpl.LOAD_TABS);}mstrFormatImpl.initOptionsMap();this.initFormatManager();this.tabContainer=microstrategy.subObjectFind(this.body,["DIV"],microstrategy.SUBOBJTYPE_TAB_CONTAINER);this.commands=new mstrFormatImplCommandsImpl(this);}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.onload",mstrLogImpl.LOAD_TABS);}}};mstrFormatImpl.initOptionsMap=function(){try{if(mstrFormatImpl.panelStackOptionsMap[0][0].name!=""){return ;}else{for(var B=0;B<mstrFormatImpl.panelStackOptionsMap.length;B++){for(var A=0;A<mstrFormatImpl.panelStackOptionsMap[B].length;A++){mstrFormatImpl.panelStackOptionsMap[B][A].name=microstrategy.descriptors.getDescriptor(mstrFormatImpl.panelStackOptionsMapDescriptors[B][A]);}}for(var B=0;B<mstrFormatImpl.gridContainerOptionsMap.length;B++){for(var A=0;A<mstrFormatImpl.gridContainerOptionsMap[B].length;A++){mstrFormatImpl.gridContainerOptionsMap[B][A].name=microstrategy.descriptors.getDescriptor(mstrFormatImpl.gridContainerOptionsMapDescriptors[B][A]);}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.onreload=function(){try{mstrEditorImpl.prototype.onreload.call(this);var F=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab");if(!F){return false;}for(var C=0;C<F.length;C++){if(F[C].getAttribute("curTab")==this.currentTab){var E;var B=F[C].getAttribute("tab");if(B){E=getElementById(B);}if(E){this.updateDynamicInfo(F[C]);this.showTabSection(E);if(!microstrategy.bone(B)){var A=E.getAttribute("scriptClass");if(A){loadInit(A+"Script",'microstrategy.registerBone("'+B+'", "(true)", null);');this.setTimeout('microstrategy.bone("'+B+'")','microstrategy.bone("'+this.id+'").loadChildrenTab("'+B+'")',500);}}}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.onpostload=function(){try{mstrEditorImpl.prototype.onpostload.call(this);this.initChildrenTabs();this.initSelections();this.restorePreviousSelections();}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.onload",mstrLogImpl.LOAD_TABS);}}};mstrFormatImpl.prototype.onunload=function(C){try{mstrEditorImpl.prototype.onunload.call(this,C);this.unRegisterChildren();var B=this.getAppliesTo();if(B!=null&&B.observer){B.observer.unregister(this.id);}}catch(A){microstrategy.errors.log(A);}return true;};mstrFormatImpl.prototype.restorePreviousSelections=function(){try{if(this.selectedTabOptions!=null&&this.selectedTabOptions.length>0){eval("this.selectedTabOptions = "+this.selectedTabOptions);for(var id in this.selectedTabOptions){var tab=microstrategy.bone(id);if(tab!=null){var settings=this.selectedTabOptions[id];tab.restorePreviousSelections(settings);}}this.selectedTabOptions=null;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFormatImpl.prototype.initFormatManager=function(){try{this.initEditor();this.changesApplied=0;if(this.elem){var A=this.elem.getAttribute("at");if(A&&A.length>0){this.setAppliesTo(A);}}if(this.axisOptionId&&this.levelOptionId){this.targetOptions=microstrategy.findChildWithAtt(this.elem,"SELECT","id",this.axisOptionId);this.levelOptions=microstrategy.findChildWithAtt(this.elem,"SELECT","id",this.levelOptionId);}this.adjustTargetLevelOptions();this.initHelpButton();}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.initHelpButton=function(){try{var B=microstrategy.findChildWithAtt(this.elem,"img",(bIsW3C)?"class":"className","mstrIcon-btn mstrIcon-btnHelp");if(B){this.help=B.parentNode;}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.isPanelStackSelected=function(){try{var A=this.getAppliesTo();return(A&&A.commands.queryEnabled("onepanelstack")==true);}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.areAllSelectedPanelStacks=function(){try{var A=this.getAppliesTo();return(A&&A.commands.queryEnabled("allpanelstack")==true&&A.commands.queryEnabled("onepanelstack")==false);}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.isGridSelected=function(){try{var A=this.getAppliesTo();return(A&&A.commands.queryEnabled("onegrid")==true);}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.isGridContainerSelected=function(){try{var A=this.getAppliesTo();return(this.isGridSelected()&&this.targetAxis==0&&(this.targetLevel==8||this.targetLevel==9));}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.adjustTargetLevelOptions=function(){try{var D;var J;var H;if(this.levelOptions){D=this.levelOptions.options;J=D.length;if(this.isGridContainerSelected()){if(D){H=D[this.levelOptions.selectedIndex].value;for(var G=0;G<J;G++){this.levelOptions.removeChild(D[0]);}}var C=microstrategy.findBone(this.getAppliesTo().commands.queryState("selectedGrid"));if(!C.showTitleBar()){this.targetLevel=8;B=1;this.levelOptions.disabled=true;}else{B=0;this.levelOptions.disabled=false;}for(var F=0;F<mstrFormatImpl.gridContainerOptionsMap[B].length;F++){var I=document.createElement("OPTION");this.levelOptions.options.add(I);I.text=mstrFormatImpl.gridContainerOptionsMap[B][F].name;I.value=mstrFormatImpl.gridContainerOptionsMap[B][F].value;I.selected=(F==0||I.value==H);}}if(this.isPanelStackSelected()){if(D){H=D[this.levelOptions.selectedIndex].value;for(var G=0;G<J;G++){this.levelOptions.removeChild(D[0]);}}var B=0;if(this.targetAxis==0){var A=microstrategy.findBone(this.getAppliesTo().commands.queryState("selectedPanelStack"));if(!A.isTitleVisible){this.targetLevel=0;B=1;this.levelOptions.disabled=true;}else{B=0;this.levelOptions.disabled=false;}}else{if(this.targetAxis==1){this.targetLevel=2;B=1;this.levelOptions.disabled=true;}}for(var F=0;F<mstrFormatImpl.panelStackOptionsMap[B].length;F++){var I=document.createElement("OPTION");this.levelOptions.options.add(I);I.text=mstrFormatImpl.panelStackOptionsMap[B][F].name;I.value=mstrFormatImpl.panelStackOptionsMap[B][F].value;I.selected=(F==0||I.value==H);}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrFormatImpl.prototype.enableChildrenTabs=function(){try{var G=microstrategy.objectListFind(this.body,["span"],microstrategy.OBJTYPE_TAB);var B=this.getAppliesTo();var I=false;var A=null;if(G&&G.length){for(var E=0;E<G.length;E++){var H=false;var C=G[E].getAttribute(microstrategy.HTMLATTR_CMD_ID);if(C&&C.length>0){if(!B.commands.queryEnabled(C)||!this.commands.queryEnabled(C)){H=true;}}if(A==null&&!H){A=E;}if((this.currentTab-1)==E&&H){I=true;}if(H){G[E].className="mstrTabSetTabdisabled";microstrategy.unRegisterBone(G[E].id);var F=G[E].getAttribute("tab");if(F){F=getElementById(F);}if(F){F.style.display="none";F.style.visibility="hidden";}}else{if(!this.submitUponTargetLevelChange){if(G[E].className&&G[E].className.indexOf("disabled")>=0){G[E].className=G[E].className.replace("disabled"," ");}}}}}if(I){this.setCurrentTab(G[A]);}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.initChildrenTabs=function(){try{this.childrenTabs=new Array();this.enableChildrenTabs();if(this.tabContainer){var C=microstrategy.subObjectListFind(this.tabContainer,["DIV"],microstrategy.SUBOBJTYPE_TAB_SECTION);if(C&&C.length){for(var B=0;B<C.length;B++){var A=microstrategy.bone(C[B].id);var E=microstrategy.findChildWithAtt(this.body,"SPAN","id",C[B].id+"_tab");if((E&&(E.className.indexOf("disabled")==-1))||C.length==1){if(!A){if(C[B].getAttribute("scriptClass")){loadInit(C[B].getAttribute("scriptClass")+"Script",'microstrategy.registerBone("'+C[B].id+'", "(true)", null);');this.setTimeout('microstrategy.bone("'+C[B].id+'")','microstrategy.bone("'+this.id+'").loadChildrenTab("'+C[B].id+'")',500);}}else{A.dialogDiv=this.elem;A.tabManager=this;this.childrenTabs[this.childrenTabs.length]=A;if(A.initValues){A.initValues();}}}this.setScheduleTab(A);this.setDeliveryTab(A);}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.loadChildrenTab=function(A){try{var C=microstrategy.bone(A);if(C){C.tabManager=this;C.setAppliesTo(this.getAppliesTo());if(A in this){for(var B in this[A]){C[B]=this[A][B];}}if(C.onload){C.onload();}C.dialogDiv=this.elem;if(C.initSharedObj){C.initSharedObj(this.sharedObj);}this.childrenTabs[this.childrenTabs.length]=C;if(C.onpostload){C.onpostload();}this.setScheduleTab(C);this.setDeliveryTab(C);this.resizePopUp(this.elem);}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.setScheduleTab=function(A){try{if(A&&A.scheduleType!=undefined){A.initScheduleInfo();this.scheduleTab=A;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.setDeliveryTab=function(A){try{if(A&&A.userType!=undefined){this.deliveryTab=A;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.unRegisterChildren=function(){try{if(this.tabContainer){if(this.childrenTabs&&this.childrenTabs.length){var C=this.getAppliesTo();for(var A=0;A<this.childrenTabs.length;A++){if(C&&C.observer){C.observer.unregister(this.childrenTabs[A].id);}microstrategy.unRegisterBone(this.childrenTabs[A].id);}}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.initSelections=function(){try{if(this.titleBar){var A=this.getAppliesTo();if(A==null){return ;}var F=this.titleBar.getElementsByTagName("span");var E=this.titleBar;if(F.length>0){E=F[0];}var D=E.innerHTML;var B=D.indexOf(":");if(B<0){B=D.indexOf("\uFF1A");}if(B==D.length-1){D=D.substr(0,B+1);if(A.commands&&A.commands.queryEnabled("isUserMetricSelected")){D=D+" "+microstrategy.descriptors.getDescriptor("3865");}else{if(A.commands&&A.commands.queryEnabled("isSummaryMetricSelected")){D=D+" "+microstrategy.descriptors.getDescriptor("3866");}else{if(A.commands&&!A.commands.queryEnabled()&&!A.commands.queryEnabled("onegrid")){D=D+" "+microstrategy.descriptors.getDescriptor("3520");}else{if(A.commands){D=D+" "+A.commands.queryState("selected");}}}}}E.innerHTML=D;}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.setAppliesTo=function(B){try{if(!this.appliesTo){this.appliesTo=(typeof (B)=="string")?B:B.id;}B=microstrategy.bone(this.appliesTo);if(B&&B.observer){B.observer.register(this.id);}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.cancelChanges=function(){try{var A=this.getAppliesTo();var C=A.updateManager||A.um;if(A&&C){while(this.changesApplied>0){C.undo();this.changesApplied--;}}this.changesApplied=0;for(var B=0;B<this.childrenTabs.length;B++){this.childrenTabs[B].cleanup();}this.actionId=null;this.closeEditor();return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.applyGraphFormatChanges=function(C){try{var A=this.getAppliesTo();if(!this.validateInputs()){return false;}if(C==null){C=new Array();}var B;if(C.length==0){for(B=0;B<this.childrenTabs.length;B++){var E=this.childrenTabs[B];C=E.applyFormatChanges(A,C);}}if(C.length>0){A.commands.exec("formatGraphBulk",C);}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.applyFormatChanges=function(E){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}var C=this.getAppliesTo();var I=C.updateManager||C.um;if(E==null){E=new Array();}var A;if(!this.validateInputs()){return false;}this.changeGridProperties=(C&&C.commands.queryEnabled("onegrid")==true)?true:false;var L=this.isGridContainerSelected();var B=false;var H=null;if(this.isPanelStackSelected()){if(this.targetAxis==0&&this.targetLevel==1){microstrategy.formatType=mstrPanelStack.FMT_TYPE_TITLE;}}if(this.changeGridProperties&&L&&this.targetLevel==9){microstrategy.formatType=mstrGridReport.FMT_TYPE_TITLE;}if(E.length==0){for(A=0;A<this.childrenTabs.length;A++){var G=this.childrenTabs[A];if(this.changeGridProperties&&!L){G.enforceSubmit=true;}G.applyFormatChanges(C,E);B=B||G.enforceSubmit;if(typeof (G.isUserMetric)!="undefined"&&G.isUserMetric){this.formatUserMetric=true;H=G;}}this.getExtraFormatChanges(C,E);}if(E.length>0){if(this.formatUserMetric){var K=new Object();K.userMetricId=H.userMetricId;K.dataSetId=H.dataSetId;K.bulkChanges=E;C.commands.exec("formatUserMetric",K);}else{if(this.changeGridProperties==true&&this.targetAxis!=null){var J=C.commands.queryState("selectedGrid");var F=microstrategy.findBone(J);if(F==null){F=microstrategy.findBone(document.getElementById(J.id));}if(F){F.selectedAxis=this.targetAxis;F.selectedPosition=this.targetPosition;F.selectedLevel=this.targetLevel;F.selectedUnit=this.targetUnit;}if(L){C.commands.exec("formatBulk",E);if(B&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&I){I.flushAndSubmitChanges();}}else{C.commands.exec("formatGridBulk",E);}}else{C.commands.exec("formatBulk",E,this.isPanelStackSelected()&&this.targetAxis==1);if(B&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&I){I.flushAndSubmitChanges();}}}this.changesApplied++;}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;return true;}catch(D){microstrategy.errors.log(D);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.getExtraFormatChanges=function(A,B){try{}catch(C){microstrategy.errors.log(C);}return B;};mstrFormatImpl.prototype.applyMultiLevelFormatChanges=function(){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyMultiLevelFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}var B=this.getAppliesTo();if(!B){return ;}if(!this.validateInputs()){return false;}var D=microstrategy.updateManager;var C=new Array();var A=false;D.queueActions=true;for(var E=0;E<this.childrenTabs.length;E++){var G=this.childrenTabs[E];C=G.applyFormatChanges(B,C);A=A||G.enforceSubmit;}if(C.length==0){D.queueActions=false;return ;}B.commands.exec("formatMultiLevelBulk",C);D.addCachedActions();if(A){D.flushAndSubmitChanges();}this.changesApplied++;return true;}catch(F){microstrategy.errors.log(F);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyMultiLevelFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.applyScheduleChanges=function(G){try{var B=this.scheduleTab;if(B){var A=this.getAppliesTo();var D=B.getScheduleType();var E=B.getScheduleList();if(D!=B.scheduleType||E!=B.scheduleList){var C=A.updateManager||A.um;C.add([C.createActionObject(A.elem,mstrUpdateManager.SAVE_REPORT_ASSOCIATED_SCHEDULES,A.beanPath,["4238","4239"],[D,E],[B.scheduleType,B.schedule])]);if(G){C&&C.flushAndSubmitChanges();}}return true;}}catch(F){microstrategy.errors.log(F);return false;}};mstrFormatImpl.prototype.applyUserChanges=function(H){try{var C=this.deliveryTab;if(C){var B=this.getAppliesTo(),D=C.getAssociatedUserInfo(),F=D.userType,A=D.users;if(F!=C.userTypeWas||A!=C.usersWas){var E=B.updateManager||B.um;E.add([E.createActionObject(B.elem,mstrUpdateManager.SAVE_REPORT_ASSOCIATED_USERS,B.beanPath,["4241","4242"],[D.allowType,A])]);if(H){E&&E.flushAndSubmitChanges();}C.userTypeWas=F;C.usersWas=A;}return true;}}catch(G){microstrategy.errors.log(G);return false;}};mstrFormatImpl.prototype.applyPropertyChanges=function(G,F){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}if(F==false||this.validateInputs(true)){var A=this.getAppliesTo();var D=new Array();for(var B=0;B<this.childrenTabs.length;B++){var E=this.childrenTabs[B];E.applyPropertyChanges(D);if(E.applySharedObjChanges){E.applySharedObjChanges(D);}}this.applyScheduleChanges(D.length==0);this.applyUserChanges(D.length==0);if(D.length>0){if(G&&G.length>0){A.commands.exec(G,D);}else{A.commands.exec("PropertyChanges",D);}}this.changesApplied++;return true;}else{return false;}}catch(C){microstrategy.errors.log(C);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.applyMultiLevelPropertyChanges=function(H){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}var B=this.getAppliesTo();if(!B){return ;}if(H&&!this.validateInputs()){return false;}var D=microstrategy.updateManager;var C=new Array();var A=false;D.queueActions=true;for(var E=0;E<this.childrenTabs.length;E++){var G=this.childrenTabs[E];G.applyPropertyChanges(C);A=A||G.enforceSubmit;}if(C.length==0){D.queueActions=false;return ;}B.commands.exec("MultiLevelPropertyChanges",C);D.addCachedActions();if(A){D.flushAndSubmitChanges();}this.changesApplied++;return true;}catch(F){microstrategy.errors.log(F);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyMultiLevelPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.okPropertyChanges=function(E,D){try{var B=true;B=this.validateInputs(true);if(B){this.close();if(D){this.applyMultiLevelPropertyChanges(false);}else{this.applyPropertyChanges(E,false);}for(var A=0;A<this.childrenTabs.length;A++){this.childrenTabs[A].cleanup();}this.actionId=null;microstrategy.unRegisterBone(this.id);}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.okFormatChanges=function(B){try{B=(B==true);if(!this.validateInputs()){return false;}else{this.close();if(B){this.applyMultiLevelFormatChanges();}else{this.applyFormatChanges();}microstrategy.unRegisterBone(this.id);}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.okGraphFormatChanges=function(){try{if(!this.validateInputs()){return false;}else{this.close();this.applyGraphFormatChanges();microstrategy.unRegisterBone(this.id);}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.adjustFormatType=function(){try{if(this.changeGridProperties&&this.targetAxis==0&&this.targetLevel==9){microstrategy.formatType=mstrGridReport.FMT_TYPE_TITLE;}if(this.isPanelStackSelected()){if(this.targetAxis==0&&this.targetLevel==1){microstrategy.formatType=mstrPanelStack.FMT_TYPE_TITLE;}}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.getHTMLElement=function(A){if(typeof (A)=="string"){A=getElementById(A);}return A;};mstrFormatImpl.prototype.hasChanges=function(){var A=false;var B;for(B=0;B<this.childrenTabs.length;B++){var C=this.childrenTabs[B];A=C.checkForFormatChanges();if(A){break;}}return A;};mstrFormatImpl.prototype.changeTarget=function(F,H){try{var A=this.getAppliesTo();var C=new Array();F=mstrFormatImpl.getHTMLElement(F);var G=A.updateManager||A.um;var D=this.hasChanges();if((typeof (H)=="undefined")&&D){showMessage({contents:microstrategy.descriptors.getDescriptor("3044"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').changeTarget('"+F.id+"',true);",cancelEval:"microstrategy.bone('"+this.id+"').changeTarget('"+F.id+"',false);",type:mstrMsgBoxImpl.MSG_WARNING});}else{var I=new Array();for(counter=0;counter<this.childrenTabs.length;counter++){var E=this.childrenTabs[counter];E.applyFormatChanges(A,C);}if((typeof (H)=="boolean")&&H&&(C.length>0)){if(this.applyFormatPropertyChanges){this.applyFormatPropertyChanges(C);}else{this.applyFormatChanges(C);}this.targetAxis=F.value;I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003"],[F.value]));G.add(I);if(this.submitUponTargetLevelChange){this.unRegisterChildren();}}else{this.targetAxis=F.value;if(A&&G){I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003"],[F.value]));G.add(I);if(this.submitUponTargetLevelChange){G.flushAndSubmitChanges();this.unRegisterChildren();}}}}if(!this.submitUponTargetLevelChange){this.adjustTargetLevelOptions();this.initChildrenTabs();}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.changePosition=function(F,H){try{var A=this.getAppliesTo();var C=new Array();F=mstrFormatImpl.getHTMLElement(F);var G=A.updateManager||A.um;var D=this.hasChanges();if((typeof (H)=="undefined")&&D){showMessage({contents:microstrategy.descriptors.getDescriptor("3044"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').changePosition('"+F.id+"',true);",cancelEval:"microstrategy.bone('"+this.id+"').changePosition('"+F.id+"',false);",type:mstrMsgBoxImpl.MSG_WARNING});}else{var I=new Array();for(counter=0;counter<this.childrenTabs.length;counter++){var E=this.childrenTabs[counter];C=E.applyFormatChanges(A,C);}if((typeof (H)=="boolean")&&H&&(C.length>0)){if(F.value=="0,-9"){I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003","72002"],[0,8]));}else{I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72001"],[F.value]));}G.add(I);this.applyFormatChanges(C);G.flushAndSubmitChanges();this.unRegisterChildren();}else{if(A&&G){if(F.value=="0,-9"){I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003","72002"],[0,8]));}else{I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72001"],[F.value]));}G.add(I);G.flushAndSubmitChanges();this.unRegisterChildren();}}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.changeLevel=function(G,F){try{var B=this.getAppliesTo();G=mstrFormatImpl.getHTMLElement(G);var D=B.updateManager||B.um;var A=this.hasChanges();if(typeof (F)=="undefined"&&A){showMessage({contents:microstrategy.descriptors.getDescriptor("3044"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').changeLevel('"+G.id+"',true);",cancelEval:"microstrategy.bone('"+this.id+"').changeLevel('"+G.id+"',false);",type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(F==true&&A){this.applyFormatChanges();}this.targetLevel=G.value;if(B&&D){if(this.submitUponTargetLevelChange==true||F==true){var C=new Array();C.push(D.createActionObject(G,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72002"],[G.value]));D.add(C);}if(this.submitUponTargetLevelChange){D.flushAndSubmitChanges();this.unRegisterChildren();}else{this.initChildrenTabs();}}}catch(E){microstrategy.errors.log(E);return false;}};mstrFormatImpl.prototype.setCurTab=function(D){try{var B=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab");for(var A=0;A<B.length;A++){if(B[A].getAttribute("curTab")==D){this.setCurrentTab(B[A]);break;}}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.setCurrentTab=function(G){try{if(!G){return false;}if(this.currentTab==G.getAttribute("curTab")){return false;}if((G.className.indexOf("disabled")>=0)||(!this.validateInputs())){return true;}var C=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab");var E=true;var H=null;for(var B=0;B<C.length;B++){var F=C[B].getAttribute("tab");if(F){F=getElementById(F);}if(C[B]==G){C[B].className="mstrTabSetTabSelected";this.currentTab=G.getAttribute("curTab");if(F&&G.getAttribute(microstrategy.TAB_SWITCH_MODE)==microstrategy.TAB_SWITCH_MODE_CACHED){this.updateDynamicInfo(G);this.showTabSection(F);H=microstrategy.findBone(F);E=false;for(var A=0;A<this.childrenTabs.length;A++){if(this.childrenTabs[A]&&this.childrenTabs[A].id==G.id.substring(0,G.id.indexOf("_tab"))&&this.childrenTabs[A].onpostswitch){this.childrenTabs[A].onpostswitch();break;}}}}else{if(C[B].className.indexOf("disabled")==-1){C[B].className="mstrTabSetTab";this.hideTabSection(F);}}}this.addSetTabEvent(E);if(E){microstrategy.updateManager.flushAndSubmitChanges();}else{if(this.adjustTabTable){this.adjustTabTable();if(H){if(H.resize){H.resize();}if(H.onSwitchToCurrent){H.onSwitchToCurrent();}}}}this.resizePopUp(this.elem);microstrategy.eventManager.notifyOrphanBones("onstatechange");return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.findTabSectionContainer=function(B){try{return B;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.showTabSection=function(C){try{if(!C){return ;}var A=this.findTabSectionContainer(C);A.style.display="block";A.style.visibility="visible";}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.hideTabSection=function(C){try{if(!C){return ;}var A=this.findTabSectionContainer(C);A.style.display="none";A.style.visibility="hidden";}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.updateDynamicInfo=function(B){try{this.updateDynamicTitle(B);this.updateDynamicHelp(B);}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.updateDynamicTitle=function(C){try{var A=this.getTitleContainer();if(this.useDynamicTitle&&A){if(A.childNodes[0]){A.childNodes[0].nodeValue=(C.childNodes[0].childNodes[0])?C.childNodes[0].childNodes[0].nodeValue:C.childNodes[0].nodeValue;A.setAttribute("title",A.childNodes[0].nodeValue);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.updateDynamicHelp=function(C){if(this.help){this.help.setAttribute("href",(C.getAttribute("helpUrl"))?C.getAttribute("helpUrl"):this.defaultHelpURL);if(this.help.childNodes[0]&&this.getTitleContainer()){var B=microstrategy.descriptors.getDescriptor("2409").replace("###",this.titleContainer.childNodes[0].nodeValue);this.help.childNodes[0].setAttribute("title",B);}}try{}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.addSetTabEvent=function(C){try{var B=microstrategy.updateManager;if(B){var A=new Array();A.push(B.createActionObject(null,mstrUpdateManager.SET_CURRENT_TAB,this.beanPath,["49001","49002"],[this.currentTab,C]));B.add(A,true);}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.getChangedTabOptions=function(){try{var B="";for(var A=0;A<this.childrenTabs.length;A++){var D=this.childrenTabs[A];var E=D.getChanges();if(E!=null&&E.length>0){B+='"'+D.id+'":{'+E+"},";}}if(B.length>0){B=B.substring(0,B.length-1);}B="{"+B+"}";return B;}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.validateInputs=function(C){try{if(!mstrEditorImpl.prototype.validateInputs.call(this)){return false;}if(C){for(var A=0;A<this.childrenTabs.length;A++){var D=this.childrenTabs[A];if(!D.validateInputs()){return false;}}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.onmenusubmitform=function(){if(this.autoSubmitJS!=null){return eval(this.autoSubmitJS);}};mstrFormatImpl.prototype.applySortChanges=function(){try{var B=new Array();for(var A=0;A<this.childrenTabs.length;A++){var E=this.childrenTabs[A];E.getSortChanges(B);}var C=microstrategy.updateManager;if(B.length>0&&C){C.add(B,true);C.flushAndSubmitChanges();}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.okSortChanges=function(){try{this.close();this.applySortChanges();microstrategy.unRegisterBone(this.id);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.afterresize=function(){try{if(mstrEditorImpl.prototype.afterresize){mstrEditorImpl.prototype.afterresize.call(this);}for(var A=0;A<this.childrenTabs.length;A++){if(this.childrenTabs[A]&&this.childrenTabs[A].afterresize){this.childrenTabs[A].afterresize();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.getTitleContainer=function(){try{if(!this.titleContainer){this.titleContainer=microstrategy.findChildWithAtt(this.elem,"span",((bIsW3C)?"class":"className"),"mstrPanelTitle");}return this.titleContainer;}catch(A){microstrategy.errors.log(A);return false;}};function mstrFormatImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);this.inherits=null;return this;}mstrFormatImplCommandsImpl.prototype=new Object();mstrFormatImplCommandsImpl.prototype.queryEnabled=function(A){try{switch(A){case"fontprops":if(this.parentBone.areAllSelectedPanelStacks()){return false;}if(this.parentBone.isPanelStackSelected()){if(this.parentBone.targetAxis==1){return false;}if(this.parentBone.targetLevel!=1){return false;}}else{if(this.parentBone.isGridSelected()){if((this.parentBone.targetPosition==-9&&this.parentBone.targetLevel==8)||(this.parentBone.targetPosition==-99)){return false;}}}break;case"numberprops":if(this.parentBone.areAllSelectedPanelStacks()){return false;}if(this.parentBone.isPanelStackSelected()){return false;}if(this.parentBone.isGridSelected()){if(this.parentBone.isGridContainerSelected()||(this.parentBone.targetPosition==-99)){return false;}}break;case"alignprops":if(this.parentBone.areAllSelectedPanelStacks()){return false;}if(this.parentBone.isPanelStackSelected()){return false;}if(this.parentBone.isGridSelected()){if(this.parentBone.isGridContainerSelected()||(this.parentBone.targetPosition==-99)){return false;}}break;case"dropShadowEffect":if(this.parentBone.isGridSelected()){if(this.parentBone.targetPosition==-99){return false;}}case"effectprops":if(this.parentBone.isPanelStackSelected()){if(this.parentBone.targetLevel==1){return false;}}else{if(this.parentBone.isGridSelected()){if((this.parentBone.targetPosition!=-9||this.parentBone.targetLevel!=8)&&(this.parentBone.targetPosition!=-99)){return false;}}}break;}return true;}catch(B){microstrategy.errors.log(B);return false;}};function mstrFormatImplCommandsImpl(A){this.parentBone=A;return this;}mstrLeftToolBarImpl.prototype=new mstrEditorImpl();mstrLeftToolBarImpl.prototype.onload=function(){try{this.initEditor();mstrBoneImpl.prototype.onload.call(this);var B=document.getElementById("btnDockLeft");if(B){B.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').close(); return false;");}this.updateTooltip();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrLeftToolBarImpl.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);this.resize();this.initResize();this.resizeLeftToolbar(this.ltW);}catch(A){microstrategy.errors.log(A);return false;}};mstrLeftToolBarImpl.prototype.resize=function(){var A=getObj(window.mstrInterfacePlugin?"mstrWeb_dockLeft":"mstrWeb_content");var B=microstrategy.contentHeight-(window.mstrInterfacePlugin?0:5);if(B>=0){if(this.elem&&this.elem.style){A.style.height=B+"px";this.elem.style.height=A.style.height;}}else{this.elem.style.height=0;A.style.height=0;}if(window.mstrInterfacePlugin){var C=microstrategy.findAncestorWithAtt(A,"id","td_mstrWeb_dockLeft");C.style.height=A.style.height;}};mstrLeftToolBarImpl.prototype.resizeLeftToolbar=function(B){var A=getObj("td_mstrWeb_dockLeft");if(A){A.style.width=B+"px";}};mstrLeftToolBarImpl.prototype.afterresize=function(){try{var B=getObjWidth(this.elem);this.resizeLeftToolbar(B);if(window.mstrUpdateManager){microstrategy.updateBrowserSetting("ltW",B);}microstrategy.eventManager.ondialogresize();this.resize();}catch(A){microstrategy.errors.log(A);return false;}};mstrLeftToolBarImpl.prototype.onwinresize=function(){try{this.resize();this.initResize();}catch(A){microstrategy.errors.log(A);return false;}};mstrLeftToolBarImpl.prototype.updateTooltip=function(){try{var A=getObj("tbTreeView");if(A){if(!this.elem){A.title=microstrategy.descriptors.getDescriptor("5695");}else{A.title=microstrategy.descriptors.getDescriptor("5696");}}}catch(B){microstrategy.errors.log(B);}};mstrLeftToolBarImpl.prototype.close=function(){try{removeObj(this.elem);var B=this.elem.parentNode;while(B!=null){if(B.nodeName=="DIV"&&B.className=="mstrDockLeft"){B.style.display="none";}if(B.nodeName=="TD"&&B.className=="tdDockLeft"){B.style.width="0px";B.style.display="none";break;}B=B.parentNode;}microstrategy.updateCookieSetting("lTbar","0");microstrategy.updateBrowserSetting("lTbar","0");microstrategy.unRegisterBone(this.id);var A=getObj("tbTreeView");if(A){A.className="mstrIcon-tb unselected";}this.updateTooltip();if(microstrategy.eventManager){microstrategy.eventManager.ondialogresize();}}catch(C){microstrategy.errors.log(C);return false;}};function mstrLeftToolBarImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}var mstrGrid=mstrGridReport;mstrGridReportScript=true;mstrGridReport.prototype=new mstrGridStatic();mstrGridReport.prototype.type=microstrategy.OBJTYPE_GRID;mstrGridReport.prototype.um=microstrategy.updateManager;mstrGridReport.prototype.mask=null;mstrGridReport.prototype.maskFor=null;mstrGridReport.prototype.maskArea=null;mstrGridReport.prototype.gridTable=null;mstrGridReport.prototype.selections=null;mstrGridReport.prototype.activeElement=null;mstrGridReport.prototype.hasNoMetrics=true;mstrGridReport.prototype.metricsCount=-1;mstrGridReport.prototype.metricsOnRows=false;mstrGridReport.prototype.checkBanding=false;mstrGridReport.prototype.hasThresholds=false;mstrGridReport.prototype.thresholdsState=false;mstrGridReport.prototype.disabled=false;mstrGridReport.prototype.objId=null;mstrGridReport.prototype.dragDisplay=null;mstrGridReport.prototype.imgDisplay=null;mstrGridReport.prototype.x=0;mstrGridReport.prototype.y=0;mstrGridReport.prototype.template=null;mstrGridReport.prototype.viewerId=null;mstrGridReport.prototype.bp=null;mstrGridReport.prototype.fp=null;mstrGridReport.prototype.parentSubsection=null;mstrGridReport.prototype.useClientSideManipulations=false;mstrGridReport.prototype.isEmptyTemplate=true;mstrGridReport.prototype.dSetId="";mstrGridReport.prototype.dSetName="";mstrGridReport.prototype.doColWidths=false;mstrGridReport.prototype.colWidths=null;mstrGridReport.prototype.startCol=0;mstrGridReport.prototype.endCol=0;mstrGridReport.prototype.maxCols=-1;mstrGridReport.prototype.gridStructureInfo=null;mstrGridReport.prototype.showAttForms=false;mstrGridReport.prototype.isDndEnabled=true;mstrGridReport.prototype.isMdxCube=false;mstrGridReport.prototype.isXDACustomSQLReport=false;mstrGridReport.prototype.isViewReport=false;mstrGridReport.prototype.useDNDMapping=false;mstrGridReport.prototype.dndHelper=null;mstrGridReport.prototype.overlapGridTitles=false;mstrGridReport.prototype.showEmptyAxis=false;mstrGridReport.prototype.emptyAxisVisible=false;mstrGridReport.prototype.showGraphDropZones=false;mstrGridReport.prototype.isFilterVisible=false;mstrGridReport.prototype.gridFormatReqId=null;mstrGridReport.prototype.gridSelections="";mstrGridReport.prototype.currentPageX="";mstrGridReport.prototype.currentPageY="";mstrGridReport.prototype.showColHeaders=true;mstrGridReport.prototype.showRowHeaders=true;mstrGridReport.prototype.rowAxis=null;mstrGridReport.prototype.colAxis=null;mstrGridReport.prototype.pagebyAxis=null;mstrGridReport.prototype.metricsAxis=null;mstrGridReport.prototype.copyAxes=false;mstrGridReport.prototype.gridCellCssPrefix="";mstrGridReport.prototype.isReportRedoable=false;mstrGridReport.prototype.isReportUndoable=false;mstrGridReport.prototype.isOutlineMode=false;mstrGridReport.prototype.isStaticOutlineMode=false;mstrGridReport.prototype.outlineMode=null;mstrGridReport.prototype.outlineModeStartRow=0;mstrGridReport.prototype.outlineModeEndRow=0;mstrGridReport.prototype.outlineModeExpandImage="";mstrGridReport.prototype.outlineModeContractImage="";mstrGridReport.prototype.outlineModeLevel=0;mstrGridReport.prototype.outlineModeWithLockHeaders=false;mstrGridReport.prototype.isSaveBeforeDocCreate=false;mstrGridReport.prototype.reportID=null;mstrGridReport.prototype.parentFolderID=null;mstrGridReport.prototype.messageID=null;mstrGridReport.prototype.stateID=null;mstrGridReport.prototype.objTypeReport=null;mstrGridReport.prototype.outlineModeMaxLevels=-1;mstrGridReport.prototype.currentView=microstrategy.DISPLAY_MODE_GRID;mstrGridReport.prototype.isDrilled=false;mstrGridReport.prototype.isNew=false;mstrGridReport.prototype.saveStateID=null;mstrGridReport.prototype.isReadOnly=false;mstrGridReport.prototype.saveEnabled=false;mstrGridReport.prototype.needSaveAs=false;mstrGridReport.prototype.autostyleId="";mstrGridReport.prototype.selectedAxis=null;mstrGridReport.prototype.selectedPosition=null;mstrGridReport.prototype.selectedLevel=null;mstrGridReport.prototype.selectedUnit=null;mstrGridReport.prototype.positionForGradient=null;mstrGridReport.prototype.gridArea=0.5;mstrGridReport.prototype.gridPosition=1;mstrGridReport.prototype.isGrid=false;mstrGridReport.prototype.isGraph=false;mstrGridReport.prototype.isVisualization=false;mstrGridReport.prototype.major=0;mstrGridReport.prototype.minor=0;mstrGridReport.prototype.categories=0;mstrGridReport.prototype.series=0;mstrGridReport.prototype.enableLegends=false;mstrGridReport.prototype.enableLabels=false;mstrGridReport.prototype.legend=false;mstrGridReport.prototype.dValues=false;mstrGridReport.prototype.seriesLayout=1;mstrGridReport.prototype.allowedGraphTypes=null;mstrGridReport.prototype.GRAPH_OBJECT_ID_FOOTNOTE=3;mstrGridReport.prototype.GRAPH_OBJECT_ID_TITLE=5;mstrGridReport.prototype.GRAPH_OBJECT_ID_SUBTITLE=4;mstrGridReport.prototype.GRAPH_OBJECT_ID_LEGEND_TEXT=9;mstrGridReport.prototype.GRAPH_OBJECT_ID_DATA_TEXT=260;mstrGridReport.prototype.GRAPH_OBJECT_ID_2DX_TITLE=293;mstrGridReport.prototype.GRAPH_OBJECT_ID_2DY1_TITLE=299;mstrGridReport.prototype.GRAPH_OBJECT_ID_2DY2_TITLE=305;mstrGridReport.prototype.GRAPH_OBJECT_ID_3DCOL_TITLE=515;mstrGridReport.prototype.GRAPH_OBJECT_ID_3DLY_TITLE=534;mstrGridReport.prototype.GRAPH_OBJECT_ID_3DROW_TITLE=555;mstrGridReport.prototype.GRAPH_OBJECT_ID_3DRY_TITLE=561;mstrGridReport.prototype.GRAPH_OBJECT_ID_NULL=9999;mstrGridReport.prototype.GRAPH_OBJECT_ID_OPILBL_VALUE=418;mstrGridReport.prototype.DEFAULT_GRAPH_MAJOR_TYPE=4;mstrGridReport.prototype.DEFAULT_GRAPH_MINOR_TYPE=1;mstrGridReport.prototype.Major_3D_surface=131072;mstrGridReport.prototype.Major_Hichert=33554432;mstrGridReport.prototype.Major_3D_scatter=262144;mstrGridReport.prototype.Major_Scatter=128;mstrGridReport.prototype.Major_Bubble=1024;mstrGridReport.prototype.Major_Gauge=524288;mstrGridReport.prototype.drillOpenInNewWindow=false;mstrGridReport.prototype.drillIframeEnabled=false;mstrGridReport.prototype.drillRetainParentValue="";mstrGridReport.prototype.drillKeepThreshValue="";mstrGridReport.prototype.oldFormatDrillPathImportance=null;mstrGridReport.prototype.drillElementListName="";mstrGridReport.prototype.gradientColorId="4225";mstrGridReport.prototype.gradientAngleId="4226";mstrGridReport.prototype.gradientXOffsetId="4229";mstrGridReport.prototype.gradientYOffsetId="4230";mstrGridReport.prototype.quickSwitch=false;mstrGridReport.prototype.isWidget=false;mstrGridReport.prototype.widgetDescription=null;mstrGridReport.prototype.widgetPreviewSrc=null;mstrGridReport.prototype.widgetPreview=null;mstrGridReport.prototype.needSaveBeforeNotes=true;mstrGridReport.prototype.hiliteCell=[];mstrGridReport.prototype.gridGraphUnitKeyContext=null;mstrGridReport.prototype.visualizationsEnabled=false;mstrGridReport.prototype.effectiveView=1;mstrGridReport.ALL_UNITS=microstrategy.GRID_OTHER;mstrGridReport.ROW_UNITS=microstrategy.GRID_OTHER+1;mstrGridReport.COL_UNITS=microstrategy.GRID_OTHER+2;mstrGridReport.METRIC_UNITS=microstrategy.GRID_OTHER+3;mstrGridReport.ALL_FORMAT_VALUES=5;mstrGridReport.prototype.nonUnitCount=mstrGridReport.METRIC_UNITS+1;mstrGridReport.prototype.gridUnitFormat=mstrGridReport.ALL_UNITS;mstrGridReport.prototype.gridValueFormat=2;mstrGridReport.prototype.formatMap=null;mstrGridReport.prototype.toolbarFormatMap={FontFamily:"fontFamily",FontSize:"fontSize",Bold:"fontWeight",Italic:"fontStyle",Underline:"textDecoration",FillColor:"backgroundColor",FontColor:"color"};mstrGridReport.prototype.saveFolderId=null;mstrGridReport.prototype.allVisList=null;mstrGridReport.prototype.isVFEmpty=false;mstrGridReport.FMT_TYPE_TITLE="2";mstrGridReport.OPACITY_MOUSE_OVER="0.6";mstrGridReport.OPACITY_MOUSE_OUT="1";mstrGridReport.OPACITY_SELECTED="0.5";mstrGridReport.SELECTOR_HILITE_CLASS="gridSelectorHilite";mstrGridReport.SELECTOR_MOUSE_OVER_CLASS="gridSelectorMouseOver";mstrGridReport.SELECTOR_MOUSE_OUT_CLASS="";mstrGridReport.ELEMENT_HILITE_CLASS="gridElementHilite";mstrGridReport.ELEMENT_HILITE_CLEAR_CLASS="";mstrGridReport.GRAPH_IMAGE=microstrategy.FOLDER_IMAGES+"graph.gif";mstrGridReport.GRID_GRAPH_IMAGE=microstrategy.FOLDER_IMAGES+"gridGraphli.gif";mstrGridReport.GRID_IMAGE=microstrategy.FOLDER_IMAGES+"iconGrid2.gif";mstrGridReport.heightAndWidthAttMap={hm:"heightMode",wm:"widthMode",ht:"height",wd:"width"};mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY=1;mstrGridReport.COL_WIDTH_FIT_TO_CONTENT=2;mstrGridReport.COL_WIDTH_FIXED=3;mstrGridReport.prototype.gridWidthInfo={colScenario:mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY,rowScenario:mstrGridReport.COL_WIDTH_FIT_TO_CONTENT,rowHeight:""};mstrGridReport.SAME_PROMPT=1;mstrGridReport.DO_NOT_ANSWER=2;mstrGridReport.CLOSE=3;mstrGridReport.DYNAMIC=4;mstrGridReport.STATIC=5;mstrGridReport.CURRENT_UNIT=6;mstrGridReport.ALL_VALID_UNITS=7;mstrGridReport.USE_DEFAULT_ANSWER=8;mstrGridReport.DYNAMIC_OR_SAME_PROMPT=9;mstrGridReport.CONSTANT_PROMPT_TYPE=1;mstrGridReport.TARGET_VALUE="tval";mstrGridReport.GRAPH_FONT_STYLE="gfs";mstrGridReport.GRAPH_FONT_FAMILY="gff";mstrGridReport.GRAPH_FONT_SIZE="gfz";mstrGridReport.GRAPH_FONT_COLOR="gfc";mstrGridReport.APPLICABLE_PROPERTY="ap";mstrGridReport.INDEX="index";mstrGridReport.IS_FOR_ALL="forAll";mstrGridReport.prototype.initObjId=function(){try{var A=this.id.split("_");this.objId=A[1]||A[0];}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.isModifyGridInDoc=function(){return false;};mstrGridReport.isDesignMode=function(){return(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE);};mstrGridReport.isReport=function(){return(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION);};mstrGridReport.isRWD=function(){return(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION);};mstrGridReport.allowEdit=function(){return(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE);};mstrGridReport.isViewMode=function(){return(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);};mstrGridReport.updateNow=function(){return(mstrGridReport.isDesignMode())?mstrUpdateManager.UPDATE_LATER:mstrUpdateManager.UPDATE_NOW;};mstrGridReport.prototype.addBoneHandler=function(B,A){return new Function("e","return microstrategy.bone('"+B+"')."+A+"(e);");};mstrGridReport.prototype.onload=function(){try{this.isGridStatic=false;mstrGridStatic.prototype.onload.call(this);this.disabled=false;this.isGridPostLoaded=false;this.commands=new mstrGridCommands(this);if(this.objId==null){this.initObjId();}this.useDNDMapping=this.isDndMapping();if(mstrGridReport.allowEdit()){this.dndHelper=new mstrDNDHelperImpl(this);}this.initGrid();if(this.fp!=null){if(mstrGridReport.isDesignMode()){this.useClientSideManipulations=true;this.checkQuickSearchEnabled();}this.initTemplate();}if(this.isReportRedoable||this.isReportUndoable){microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange");}var D=this.useLockset;var H=window.__expdRowPos;var K=this.expdRowOrd;var I;var B;var J;if(typeof (K)!=="undefined"){if(D){B=document.getElementById(this.id+"divLock4");J=B.getElementsByTagName("table")[0];}else{J=this.elem.getElementsByTagName("table")[0];}tBody=J.tBodies[0],rows=J.rows;for(var F=0;F<rows.length;F++){var A=rows[F];var C=A.getAttribute("o");if(C==K){I=A;break;}}if(window.__expdRowPos){delete window.__expdRowPos;}}if(I){var G=function(){if(D){var M=getObjSumTop(I,B);var L=M-H;B.scrollTop=L;}else{var M=getObjSumTopScrolled(I);var L=M-H;window.scrollTo(window.pageXOffset,L);}};window.setTimeout(G,0);}else{if(mstrGridReport.isReport()&&getObjSumTopScrolled(this.elem)-document.documentElement.scrollTop<0){window.scrollTo(0,0);}}this.elem.onscroll=this.addBoneHandler(this.id,"onscroll");this.isGridBone=true;if(mstrGridReport.isReport()&&mstr){this.initNotesIcon();}this.initIncrementalFetchBoxes();this.initReportQuickSearch();}catch(E){microstrategy.errors.log(E);}finally{if(window.__expdRowPos){delete window.__expdRowPos;}}};mstrGridReport.prototype.checkQuickSearchEnabled=function(){try{this.quickSearchEnabled=this.isFeatureAvailable(microstrategy.FEATURE_REPORT_TEMPLATE_SEARCH)&&this.isGrid&&mstrGridReport.isReport()&&(microstrategy.useQuickSearch())&&!(this.isViewReport||this.isMdxCube||this.isXDACustomSQLReport)&&(mstrGridReport.isDesignMode()||!mstrGridReport.isDesignMode()&&microstrategy.enableGridViewSearch);return this.quickSearchEnabled;}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.initReportQuickSearch=function(){try{this.checkQuickSearchEnabled();if(!this.quickSearchEnabled){return ;}var B=this;mstrGridReport.createQuickSearchPlaceHolder=function(D){var C=document.createElement("div");C.setAttribute("ty","qs");if(D){C.setAttribute("ax",D);}C.className="dummy-searchbox";C.onmousedown=function(){microstrategy.openReportQuickSearchBox(this);};return C;};mstrGridReport.attachSearchBoxPlaceholderHandler=function(G){var D=microstrategy.findChildrenWithAtt(G||B.elem,"div","ty","qs");for(var E=0,C=D.length;E<C;E++){var F=D[E];F.className="dummy-searchbox";F.onmousedown=function(H){microstrategy.openReportQuickSearchBox(this);};}};mstrGridReport.fnGetQuickSearchWidget=function(D){var C=B.quickSearch||window.mstrmojo&&mstrmojo.all.ReportQuickSearchBox;if(C){return C;}else{var C=mstrmojo.insert({scriptClass:"mstrmojo.ReportQuickSearchBox",id:"ReportQuickSearchBox",quicksearch:B.quickSearchEnabled,enableOptions:true,visible:false,itemSelectCallback:function(H,I){if(!microstrategy.checkACL(H,[microstrategy.ACL_EXECUTE,microstrategy.ACL_USE])){return ;}B=microstrategy.bone(B.id);var G=function(M,K,N){if(!K){K=M.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_METRIC?microstrategy.GRIDCELL_AXIS_COLUMNS:microstrategy.GRIDCELL_AXIS_ROWS;}else{if(K==microstrategy.GRIDCELL_AXIS_METRICS&&(!B.gridStructureInfo.hasMetrics||M.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_ATTRIBUTE)){K=microstrategy.GRIDCELL_AXIS_COLUMNS;}}var J=microstrategy.updateManager,L=B.commands.exec("addTemplateUnit",M,K,N||-1,[]);J.add(L);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){J.flushAndSubmitChanges();}};if(!this.axis||this.axis&&(this.axis!=microstrategy.GRIDCELL_AXIS_PAGE_BY)||this.axis&&(this.axis==microstrategy.GRIDCELL_AXIS_PAGE_BY)&&mstrGridReport.isDesignMode()){G(H,this.axis,this.depth);}if(this.axis&&(this.axis==microstrategy.GRIDCELL_AXIS_PAGE_BY)){if(mstrGridReport.isDesignMode()){microstrategy.activeCXMenu=microstrategy.findChildWithAtt(B.elem,"td",microstrategy.HTMLATTR_DSS_ID,H.getAttribute(microstrategy.HTMLATTR_DSS_ID));B.processContextMenus("p");}else{var E=microstrategy.bone("pbb_PageByStyle");E.useClientSideManipulations=false;E.addUnit(H,microstrategy.GRIDCELL_AXIS_PAGE_BY,1,null);}}var F=microstrategy.bone("tbWkSet_ObjectBrowserReportWorkingSetStyle");F&&F.tree.addNode(H);}});if(C&&!C.hasRendered){C.render();document.body.appendChild(C.domNode);}B.quickSearch=C;return B.quickSearch;}};microstrategy.openReportQuickSearchBox=function(C){var D=function(){var F=mstrGridReport.fnGetQuickSearchWidget(C);if(!F){return ;}var E=F.domNode;if(C.firstChild){window.setTimeout(function(){F.set("visible",true);F.inputNode.focus();},10);return ;}F.axis=C.getAttribute("ax")||F.axis;switch(parseInt(F.axis,10)){case -1:F.set("objectType",F.objectType||"4");break;default:F.set("objectType",F.objectType||F.ALL_TYPES);break;}if(F.suggestionPopup&&F.suggestionPopup.containerNode){F.suggestionPopup.containerNode.scrollTop=0;}C.appendChild(E);F.set("visible",false);window.setTimeout(function(){F.set("visible",true);F.clearSearch();F.inputNode.focus();},20);};microstrategy.mojoLoader.loadWidget({bundle:"mojo-ros.js",callback:D});};}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.isDndMapping=function(){try{if(!this.showColHeaders&&!this.showRowHeaders){return false;}if(!this.isDndEnabled){return false;}if(!this.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE)){return false;}var C=this;var A=function(D){return C.isFeatureAvailable(microstrategy["FEATURE_"+D]);};return(this.isModifyGridInDoc()||A("DESIGN_MODE")||A("OBJECT_BROWSER_EDITOR")||A("WEB_PIVOT"));}catch(B){microstrategy.errors.log(B);}return false;};mstrGridReport.prototype.onpostload=function(){try{mstrGridStatic.prototype.onpostload.call(this);if(mstrGridReport.allowEdit()&&!(this.visualizationMode==50&&this.docViewer&&!this.docViewer.isEditableViewModeEplus())){this.selections=null;this.initSelections(true);}this.rowAxis=this.colAxis=this.pagebyAxis=this.metricsAxis=null;this.notifySelectionChange("ongridselectionschange");}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.onreload=function(e){try{mstrRWUnitBoneImpl.prototype.onreload.call(this,e);if(bIsW3C&&mstrGridReport.isReport()){if(document.getElementById("gridStyleIFrame")){var gridStyle=document.getElementById("gridStyle");var t=gridStyle&&gridStyle.parentNode&&gridStyle.parentNode.removeChild(gridStyle);}}if(!!this.graphSelections){var ps=eval("("+this.graphSelections+")");this.setGraphSelected(ps.graphSelected);if(this.graphSelected){this.selectedGraphUnit=ps.graphSelectedUnit;this.selectedGraphTargetValue=ps.graphSelectedValue;}}}catch(err){microstrategy.errors.log(err);}};mstrGridReport.prototype.onrepostload=function(B){try{mstrGridStatic.prototype.onrepostload.call(this);if(mstrGridReport.isReport()){this.observer.notifyAll("onReportReload");}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.onscroll=function(B){try{stopEventBubbling(B||window.event);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.initGrid=function(){try{mstrGridStatic.prototype.initGrid.call(this);if(this.copyAxes){var J=microstrategy.bone(this.id.substr(0,this.id.lastIndexOf("_"))+"_0");this.rowAxis=J.rowAxis;this.colAxis=J.colAxis;this.pagebyAxis=J.pagebyAxis;this.metricsAxis=J.metricsAxis;this.copyAxes=false;}var I=this.gridStructureInfo;if(!this.gridStructureInfo){if(!this.isGrid&&this.isGraph){var B=this.elem.id;var E=B.slice(0,B.lastIndexOf("_"));var C=microstrategy.bone(E);if(C&&C.gridStructureInfo){I=this.gridStructureInfo=C.gridStructureInfo;}else{this.needsGridInfo=true;}}}if(!I){I=this.gridStructureInfo=new mstrGridInfo(this);I.init(this.elem);}if(this.isGrid&&this.isGraph){var E=this.elem.id;var B=E+"_graph";var D=microstrategy.bone(B);if(D&&D.needsGridInfo){D.gridStructureInfo=this.gridStructureInfo;D.needsGridInfo=false;}}if(this.shouldInitMask()){this.initMask();}if(this.isGridBone||mstrGridReport.isDesignMode()){if(!I.emptyCase){var G=this.elem.getElementsByTagName("table");if(G){this.gridTable=G[0];for(i=0;i<G.length;i++){G[i].getElementsByTagName("tbody")[0].onmousedown=this.addBoneHandler(this.id,"onmousedown");if(!mstrGridReport.isDesignMode()){G[i].getElementsByTagName("tbody")[0].onclick=this.addBoneHandler(this.id,"onclick");}}}this.doColWidths=(!mstrGridReport.isDesignMode()&&I.enableColWidths()&&this.isFeatureAvailable("enable-resize-columns-rows"));if(this.doColWidths&&this.isGrid&&this.isFeatureAvailable("grid-layout")){var H=this;window.setTimeout(function A(){H.initColResize();},0);}if(this.isOutlineMode){this.outlineMode=new mstrOutlineModeImpl(parseInt(this.outlineModeStartRow),parseInt(this.outlineModeEndRow),this.outlineModeExpandImage,this.outlineModeContractImage,this.outlineModeLevel,this.outlineModeMaxLevels,this);}var H=this;window.setTimeout(function(){if(mstr.utils.ISFF&&H.elem&&H.elem.offsetHeight>32768){H.elem.style.overflowX="";}},0);}}this.setDsetId(this.dSetId);}catch(F){microstrategy.errors.log(F);}};mstrGridReport.prototype.initNotesIcon=function(){try{var A=mstr.$obj("NotesIconModel_model");if(A&&!this.needSaveBeforeNotes){A.set("objectID",this.reportID);A.set("objectType",this.objTypeReport);}if(this.needSaveBeforeNotes||(microstrategy.bone("accordion_AccordionTabManagerStyle")&&microstrategy.bone("accordion_AccordionTabManagerStyle").currentTabName==microstrategy.ACCORDION_REPORT_NOTES_PANEL)){var B=mstr.$obj("NotesIconView_view");if(B){B.set("visible",false);}}else{if(!this.inReload&&A){A.execCheck();}}}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.initMapper=function(){try{if(this.mapper){return ;}if(this.useDNDMapping){this.getMapper();this.maskArea=this.elem;this.maskFor=microstrategy.DSSTYPE_METRIC+microstrategy.HTMLATTR_MASKFOR_DELIM+microstrategy.DSSTYPE_ATTRIBUTE;}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.getMapper=function(){try{this.mapper=new mstrGridMapperImpl();}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.initTemplate=function(){try{this.template=new mstrTemplateImpl();this.template.onload(this.gridTable,this,this.fp);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.addAction=function(F,G,E,C,A,D){E=E||this.beanPath;C=C||[];A=A||[];var B=this.um.createActionObject(F,G,E,C,A,[]);if(D){D.push(B);}else{this.um.add([B]);this.um.flushAndSubmitChanges();}};mstrGridReport.prototype.handleDatasetExplorer=function(C){try{var B=C.items[0];this.addAction(this.elem,mstrUpdateManager.ADD_DATASET_AND_TEMPLATE,mstr.$obj("mstrPageInfo").get("beanPath"),["2048032","2048033","2048012","2048135"],[B.dssid,B.tp,this.objId,(C.formatting)?1:2]);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.onlockscroll=function(){try{if(this.colWidths!=null){this.colWidths.syncCols();}if(this.mask!=null){this.mask.onmaskedobjectresize();}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.onresize=function(){try{if(this.mask!=null){this.mask.onmaskedobjectresize();}if(mstr.utils.ISIE8||mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE){var C=this;window.setTimeout(function(){C.resizeLockSet(true);},10);}else{this.resizeLockSet();}if(this.colWidths){this.colWidths.syncCols();}if(mstr.utils.ISIE6&&mstrGridReport.isReport()&&this.image&&!mstrGridReport.isDesignMode()){var A=microstrategy.bone("ReportFrame").elem;if(document.body.clientWidth>mstr.utils.BoxModel.getBrowserWindowWidth(document)){A.style.width=Math.max(mstr.utils.BoxModel.getBrowserWindowWidth(document)-mstr.utils.BoxModel.getElementSumOffsetLeft(document.getElementById("reportViewAllModes")),this.image.clientWidth)+"px";}else{A.style.width="auto";}}}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.copyBoneProperties=function(B){try{if(B){this.setFeature(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE,B.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE));if(this.gridStructureInfo&&B.gridStructureInfo){this.gridStructureInfo.dataSetId=B.gridStructureInfo.dataSetId;}this.editorProperties=B.editorProperties;}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.onwinresize=function(){try{if(this.isGridPostLoaded){this.ondialogresize();}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.ondocumentclick=function(D){try{var B=this.selections;window.setTimeout(this.resetGridUnitSelections,0);var A=B&&B.ondocumentclick&&B.ondocumentclick(D);}catch(C){microstrategy.errors.log(C);}};mstrGridReport.desp=function(A){return microstrategy.descriptors.getDescriptor(A);};mstrGridReport.prototype.onObjectBrowserTabChange=function(A){try{this.observer.notifyAll("onObjectBrowserTabChange");if(mstrGridReport.isDesignMode()){return ;}var V=this.gridStructureInfo;if((V.isEmptyTemplate&&V.metricsAxis!=microstrategy.GRIDCELL_AXIS_PAGE_BY)||!this.showEmptyAxis||!V.hasEmptyAxis()||this.noData){return ;}var G=false;var U,e,P,B;var H=function(g){return document.createTextNode(mstrGridReport.desp(g));};var O=function(g){return g.getElementsByTagName("tbody")[0].rows;};if(this.lockSet){var X=this.lockSet.quadrants;U=X[0]?O(X[0]):null;e=X[1]?O(X[1]):null;P=X[2]?O(X[2]):null;B=X[3]?O(X[3]):null;G=true;}else{U=O(this.elem);}var C,M,a,Y,Z,W;var R=(this.showAttForms)?"totalSize":"size";var T=this.getFixedRows();var F=T==U.length?1:U.length-T;var D=function(){W=[U,e,B,P];for(a=0;a<4;a++){if(W[a]){M=W[a][0].insertCell(0);if(T>0){M.rowSpan=T;}M.className="r-rowTitle r-cell";M.innerHTML="&nbsp;";}}};var K=function(m){W=[U,B];for(a=0;a<2;a++){if(W[a]){C=m?W[a][0].parentNode.insertRow(W[a].length):W[a][T];M=C.insertCell(0);if(F>0){M.rowSpan=F;}M.className="r-rowHeader r-cell";M.appendChild(H("4500"));if(m){M=U[T].insertCell(1);var h=U[V.colAxis[R]()-1];if(h&&h.cells){var g=h.cells.length;if(bIsIE8||bIsIE6||bIsIE7&&g>1000){M.colSpan=250;}else{M.colSpan=g;}}M.className="r-metricValue r-cell";M.appendChild(H("4501"));}}}};var L=this;var N=function(g){if(!L.gridTable){return ;}var h=L.gridTable.getElementsByTagName("colgroup")[0];var m;if(g){m=h.firstChild;}else{m=h.lastChild;}if(m){h.removeChild(m);}};var Q=function(g){if(!L.gridTable){return ;}var h=L.gridTable.getElementsByTagName("colgroup")[0];var m=document.createElement("col");m.setAttribute("key","3");if(g){h.insertBefore(m,h.firstChild);}else{h.appendChild(m);}};var E=function(g){return(g&&g.cells&&g.cells.length>0);};switch(A){case"workingSet":case"objectBrowser":if(this.emptyAxisVisible){return ;}if(V.rowAxis[R]()==0&&V.metricAxis[R]()==0){Q(true);D();K(true);}else{if(V.rowAxis[R]()==0){Q(true);D();K();}if(V.metricAxis[R]()==0){Q();var J=V.colAxis[R]();if(J==0){W=[U,P];for(a=0;a<2;a++){if(W[a]){M=W[a][0].insertCell(W[a][0].cells.length);M.className="r-colHeader r-cell";M.appendChild(H("4502"));}}if(U[1]){M=U[1].insertCell(U[1].cells.length);M.rowSpan=U.length-1;M.className="r-metricValue r-cell";M.appendChild(H("4501"));}}else{C=U[J];M=C.cells[C.cells.length-1];if(M.rowSpan==1){for(a=J+1,Z=U.length;a<Z;a++){C=U[a];C.removeChild(C.cells[C.cells.length-1]);}M.rowSpan=U.length-V.colAxis[R]();}M.className="r-metricValue r-cell";M.appendChild(H("4501"));}}}this.emptyAxisVisible=true;break;default:if(!this.emptyAxisVisible){return ;}if(V.rowAxis[R]()==0){N(true);W=[U,e,P,B];for(a=0;a<4;a++){if(W[a]&&E(W[a][0])){W[a][0].removeChild(W[a][0].cells[0]);}}W=[U,B];for(a=0;a<2;a++){if(W[a]){C=W[a][T];var c;if(E(C)){c=C&&C.removeChild(C.cells[0]);}}}}if(V.rowAxis[R]()==0&&V.metricAxis[R]()==0){W=[U,B];for(a=0;a<2;a++){if(W[a]){C=W[a][W[a].length-1];C.parentNode.removeChild(C);}}}else{if(V.metricAxis[R]()==0){if(V.colAxis[R]()==0){N();W=[U,P];for(a=0;a<2;a++){if(W[a]){C=W[a][0];C.removeChild(C.cells[C.cells.length-1]);}}C=U[1];if(E(C)){C.removeChild(C.cells[C.cells.length-1]);}}else{C=U[V.colAxis[R]()];M=C.cells[C.cells.length-1];while(M.hasChildNodes()){M.removeChild(M.lastChild);}}}}this.emptyAxisVisible=false;break;}if(G){W=[U,e,B,P];for(a=0;a<4;a++){if(W[a]){var S=W[a][0].parentNode.parentNode;S.style.tableLayout="auto";S.style.width="auto";}}}this.onresize();}catch(I){microstrategy.errors.log(I);}};mstrGridReport.prototype.ondialogresize=function(B){try{if(this.gridWidthInfo!=null&&this.gridWidthInfo.colScenario==mstrGridReport.COL_WIDTH_FIXED){this.resizeLockSet();}else{this.onresize(B);}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.onQuickSwitchClick=function(A){};mstrGridReport.isMetric=function(A,B){var C=function(D,E){E=!E?"":E+"_";return(D==microstrategy["DSSTYPE_"+E+"METRIC"]);};return(C(A)||C(A,"USER")||C(A,"USER_SUMMARY")||(B&&A==microstrategy.DSSTYPE_PROMPT&&mstrGridReport.isDesignMode()));};mstrGridReport.prototype.onnotifydrag=function(F,I,E){try{if(this.mask==null||this.disabled||!this.useDNDMapping){return null;}var G=null;var K=true;if(I==this||I.type==microstrategy.OBJTYPE_PAGE_BY||I.type==microstrategy.OBJTYPE_OBJBROWSER){if(!this.isFeatureAvailable(microstrategy.FEATURE_WEB_PIVOT)){return null;}G=E[0];var B=(mstrGridReport.isRWD()&&this.dSetId)?this.dSetId:null;for(var J in F){var H=new mstrObjectInfoImpl(F[J]);if(I.type==microstrategy.OBJTYPE_OBJBROWSER){if(H.dssType==microstrategy.DSSTYPE_RPT_DEFINITION){if(mstrGridReport.isReport()||(mstrGridReport.isRWD()&&E.length>1)){return null;}}else{if(!this.isFeatureAvailable(microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS)){return null;}}if(H.dssType==microstrategy.DSSTYPE_FILTER&&H.dssSubType!=microstrategy.DSSTYPE_CUSTOM_GROUP){return null;}if(H.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM&&!this.isFeatureAvailable(microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY)){return null;}if(H.dssType==microstrategy.DSSTYPE_PROMPT&&H.dssSubType!=microstrategy.DSSSUB_TYPE_PROMPT_OBJECTS){return null;}if(!microstrategy.checkACL(F[J],[microstrategy.ACL_USE])){return null;}if(mstrGridReport.isRWD()&&microstrategy.bones.rwb_viewer.isFeatureAvailable(microstrategy.FEATURE_SINGLE_SOURCE_GRID)){if(B==null){B=H.dSetId;}if(H.dssType!=microstrategy.DSSTYPE_RPT_DEFINITION&&H.dSetId!=B){return null;}}G=F[J].getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(G!=null&&G==microstrategy.OBJTYPE_ELEMENT){return null;}if(mstrGridReport.isReport()&&this.isMdxCube&&!this.canAddMDXUnit(F[J])){return null;}}if(K&&!mstrGridReport.isMetric(H.dssType)){K=false;}}E.sort(function(M,L){return parseInt(M)-parseInt(L);});if(E[0]==E[E.length-1]){G=E[0];}else{G=(K)?microstrategy.DSSTYPE_METRIC:microstrategy.DSSTYPE_ATTRIBUTE;}}if(G==null){return null;}switch(G){case microstrategy.DSSTYPE_TEMPLATE:G=mstrMaskMappedImpl.MASK_TYPE;break;case microstrategy.DSSTYPE_METRIC:case microstrategy.DSSTYPE_USER_METRIC:case microstrategy.DSSTYPE_USER_SUMMARY_METRIC:G=microstrategy.DSSTYPE_METRIC;break;case microstrategy.DSSTYPE_RPT_DEFINITION:G=microstrategy.DSSTYPE_RPT_DEFINITION;break;default:G=microstrategy.DSSTYPE_ATTRIBUTE;break;}if(this.gridStructureInfo.emptyCase||G==microstrategy.DSSTYPE_RPT_DEFINITION){G=mstrMaskMappedImpl.MASK_TYPE;}microstrategy.eventManager.notifyOrphanBones("onforcerepaint");this.dragSource=I;if(!this.mask.isLoaded){var A=this.mask;var D=this;if(mstrGridReport.isReport()){this.initializeMapper(A,G);}else{this.elem.onmouseover=function(){D.elem.onmouseover=null;D.initializeMapper(A,G);};}}else{this.mask.toggle(true,G);}this.dragSource=I;}catch(C){microstrategy.errors.log(C);}return null;};mstrGridReport.prototype.onnotifydragend=function(){try{if(this.mask&&this.mask.isLoaded&&this.mask.toggle){this.mask.toggle(false);microstrategy.eventManager.notifyOrphanBones("onforcerepaint");}else{if(this.dragSource){var C=this.dragSource;var A=C.type;if(C==this||A==microstrategy.OBJTYPE_PAGE_BY||A==microstrategy.OBJTYPE_OBJBROWSER){this.elem.onmouseover=null;}}}}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.initializeMapper=function(B,A){if(microstrategy.midx==undefined){microstrategy.midx=0;}this.mask.midx=microstrategy.midx++;this.initMapper();B.onload(this);B.toggle(true,A);this.initializeDragDisplay();};mstrGridReport.prototype.adjustGridWidth=function(D){try{if((mstr.utils.Arrays.find(["0","2"],D)>-1)&&this.isGrid&&this.gridTable){var E="auto";var B="auto";if(D=="0"){if(this.gridWidthInfo.colScenario!="2"){E="fixed";B="100%";}else{return true;}}var A=this.gridTable.style;A.tableLayout=E;A.width=B;}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrGridReport.prototype.processRedoUndo=function(A){try{if(this.um.anyNonStatic(true)){this.um[A.toLowerCase()]();}else{if(this["isReport"+A+"able"]){this.addAction(this.elem,mstrUpdateManager["REPORT_"+A.toUpperCase()]);}}}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.processRedo=function(){this.processRedoUndo("Redo");};mstrGridReport.prototype.processUndo=function(){this.processRedoUndo("Undo");};mstrGridReport.prototype.commonRedoUndoCode=function(D,G){try{var E=this.colWidths;switch(D.id){case mstrUpdateManager.RESIZE_SINGLE_COLUMN:if(this.objId==D.cachedArray.objId&&E&&(G=="undo"||this.gridWidthInfo.colScenario==mstrGridReport.COL_WIDTH_FIXED)){var K=D.args[0];if(K=="allcolumns"){for(var F=0,A=E.widths.length;F<A;F++){E.setColWidthByIndex(F,(G=="undo")?D.args[1][F]:D.args[1],E.getColWidthByIndex(F));}}else{E.setColWidthByKey(K,D.args[1],E.getColWidthByKey(K));}E.syncCols();}break;case mstrUpdateManager.SET_RESIZE_ROW_SCENARIO:case mstrUpdateManager.SET_RESIZE_COLUMNS_SCENARIO:if(this.objId!=D.cachedArray.objId||!E){break;}var I=(D.id==mstrUpdateManager.SET_RESIZE_ROW_SCENARIO);var J=[D.args[0]];if(I){J.push(D.args[1]);}E[(I)?"setRowHeightMode":"setColWidthsMode"].apply(E,J);this.gridWidthInfo[(I)?"rowScenario":"colScenario"]=D.args[0];E.syncCols();break;case mstrUpdateManager.PIVOT_TEMPLATE_UNIT:case mstrUpdateManager.PIVOT_TEMPLATE_METRIC:case mstrUpdateManager.ADD_TEMPLATE_UNIT:case mstrUpdateManager.ADD_TEMPLATE_METRIC:case mstrUpdateManager.REMOVE_TEMPLATE_UNIT:case mstrUpdateManager.REMOVE_TEMPLATE_METRIC:case mstrUpdateManager.ADD_FORM:case mstrUpdateManager.REMOVE_FORM:case mstrUpdateManager.SWAP_TEMPLATE_AXES:if(D.cachedArray.id==this.id&&this.useClientSideManipulations&&this.template){if(D.id!=mstrUpdateManager.SWAP_TEMPLATE_AXES||this.isGrid||this.zonesEditor){this.template[G](D);this.onresize();}}break;case mstrUpdateManager.PIVOT_MULTIPLE_UNITS:case mstrUpdateManager.REMOVE_MULTIPLE_UNITS:var C=D.cachedArray;if(C&&C.id==this.id&&this.useClientSideManipulations&&this.template){var H=C.list;if(H&&H.length){if(G=="undo"){H.reverse();}for(var F=0,A=H.length;F<A;F++){H[F].args=H[F].oldArgs;this.template[G](H[F]);}if(G=="undo"){H.reverse();}this.onresize();}}break;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrGridReport.prototype.redoundo=function(A,C){try{return this.commonRedoUndoCode(C,A);}catch(B){microstrategy.errors.log(B);return false;}};mstrGridReport.prototype.onredo=function(A){this.redoundo("redo",A);};mstrGridReport.prototype.onundo=function(A){this.redoundo("undo",A);};mstrGridReport.prototype.ondrop=function(c,I){try{var T=I.getItems();var D=c.getAttribute(microstrategy.HTMLATTR_POINTS_TO);if(this.dragSource&&D!=null){var Q=this.um;var g=[];var e=this.gridStructureInfo;var E=toDepth=toSubDepth=1;if(!e.emptyCase&&D!=this.id){var C=D.split(",");if(C.length<2){return null;}E=parseInt(C[0]);toDepth=parseInt(C[1]);toSubDepth=parseInt(C[2]);if(isNaN(toSubDepth)){toSubDepth=1;}}if(this.dragSource.type==microstrategy.OBJTYPE_OBJBROWSER){var N=I.isMulti();var O=(N)?I.isOnlyMetrics():true;var X=false;var H=e.metricAxis.size()+1;for(var Y=T.length-1;Y>=0;Y--){var a=T[Y].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);var G=T[Y].getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(G==microstrategy.OBJTYPE_ELEMENT){continue;}if(a==microstrategy.DSSTYPE_TEMPLATE&&D==this.id){g=this.replaceTemplate(T[Y],true,g);continue;}if(N&&!O&&e.hasMetrics&&(mstrGridReport.isMetric(a))){if(!e.findUnit(T[Y].getAttribute(microstrategy.HTMLATTR_DSS_ID))){g=this.addUnit(T[Y],microstrategy.GRIDCELL_AXIS_METRICS,H,1,g);}}else{var Z=toDepth;var W=toSubDepth;var P=(a==microstrategy.DSSTYPE_ATTRIBUTE_FORM)?T[Y].getAttribute(microstrategy.HTMLATTR_ATTRIBUTE_ID):T[Y].getAttribute(microstrategy.HTMLATTR_DSS_ID);if(toSubDepth>1){if(a!=microstrategy.DSSTYPE_ATTRIBUTE_FORM){Z++;W=1;}else{var B=e.getUnit(E,toDepth,1);if(B!=null){if(P!=B.parentDssId){Z++;W=1;}else{if(this.showAttForms){var F=e.findUnit(P);if(F!=null&&F.hasAttForms()){var L=F.getSubUnit(T[Y].getAttribute(microstrategy.HTMLATTR_DSS_ID));if(L!=null&&L.subDepth<W){W--;}}}}}}}var A=e.findUnit(P);if(A!=null){if(A.axis==E&&A.depth<Z){if(W>1){W=1;}else{Z--;}}}if(mstrGridReport.isMetric(a)){if(e.hasMetrics){if(E!=microstrategy.GRIDCELL_AXIS_METRICS){if(!X&&(E!=e.metricsAxis||Z!=e.metricsDepth)){var S=e.getUnit(e.metricsAxis,e.metricsDepth,1);if(S){var M=g.length;g=this.pivotUnit(S,E,Z,1,g);var K=e.buildGridUnitInfo(T[Y],E,Z,W);if(mstrGridReport.isRWD()&&K.dssSetId!=e.dataSetId&&g.length>M){g=this.changeGridDataSource(K.dssSetId,g);}H=Z;}X=true;}if(e.findUnit(T[Y].getAttribute(microstrategy.HTMLATTR_DSS_ID))==null){g=this.addUnit(T[Y],microstrategy.GRIDCELL_AXIS_METRICS,H,1,g);}}else{g=this.addUnit(T[Y],microstrategy.GRIDCELL_AXIS_METRICS,Z,1,g);}}else{if(N&&!O&&E!=microstrategy.GRIDCELL_AXIS_COLUMNS){g=this.addUnit(T[Y],microstrategy.GRIDCELL_AXIS_COLUMNS,e.colAxis.size()+1,1,g);}else{g=this.addUnit(T[Y],E,Z,W,g);}}}else{g=this.addUnit(T[Y],E,Z,W,g);}}}}else{if(this.dragSource==this||this.dragSource.type==microstrategy.OBJTYPE_PAGE_BY||this.dragSource.type==microstrategy.OBJTYPE_GRAPH_ZONES){var V=this.getObjInfoList(T);if(V.length==1){var R=V[0];var U=this.computeDepthsForPivot(R,E,toDepth,toSubDepth);g=this.pivotUnit(R,E,U.depth,U.subDepth,g);}else{g=this.pivotUnits(V,E,toDepth,toSubDepth,g,true);}}}if(g.length>0){Q.add(g);if(this.selections){this.selections.clearAll(true);}if(this.flush){Q.flushAndSubmitChanges();this.flush=false;}else{if(this.useClientSideManipulations){microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",e);}else{if(this.dragSource&&this.dragSource.type==microstrategy.OBJTYPE_GRAPH_ZONES){togglePulldowns(this.dragSource.elem,true);}Q.flushAndSubmitChanges();}}}}return false;}catch(J){microstrategy.errors.log(J);return false;}};mstrGridReport.prototype.computeDepthsForPivot=function(B,E,D,F){var A={depth:D,subDepth:F};var H=D;var C=F;if(F>1){if(B.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM&&this.showAttForms&&B.axis==E&&B.depth==H&&B.subDepth<C){C--;}else{H++;C=1;}}if(B.axis==E&&B.depth<H){if(C>1){C=1;}else{H--;}}var G=this.gridStructureInfo.getMaxAxisPosition(E);if(H>G||H==-1){H=G;}A.depth=H;A.subDepth=C;return A;};mstrGridReport.prototype.sortByAxisDepth=function(D,C){try{var F=this.gridStructureInfo;var B=F.getGridUnitInfo(D);var H=F.getGridUnitInfo(C);var A=(B.subtype==microstrategy.OBJTYPE_METRIC)?F.metricsAxis:B.axis;var G=(H.subtype==microstrategy.OBJTYPE_METRIC)?F.metricsAxis:H.axis;if(A==G){return this.sortByDepth(B,H);}return((A<G)?-1:((A>G)?1:0));}catch(E){microstrategy.errors.log(E);return null;}};mstrGridReport.prototype.sortByDepth=function(C,B){try{var A=C.depth;var E=B.depth;return((A<E)?-1:((A>E)?1:0));}catch(D){microstrategy.errors.log(D);return null;}};mstrGridReport.prototype.pivotUnits=function(O,C,J,U,T,G){try{var R="";var M=this.um;var A=mstrGridReport.updateNow();var B=0;var S=this.gridStructureInfo;var F=S.getMaxAxisPosition(C);if(J==-1){J=F;}for(var N=0;N<O.length;N++){R+=this.buildPivotingSrc(O[N]);if(O[N].dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){B++;}}if(R.length>0){var L={depth:J,subDepth:U};if(G){L=this.computeDepthsForPivot(O[0],C,J,U);}var H=L.depth;var Q=C;if(H==J&&L.subDepth>1){if(B==O.length){Q=0;H=L.subDepth;}}var D=null;if(A==mstrUpdateManager.UPDATE_LATER){var P=[];var D={id:this.id,list:P};var I=this;var K=function(V){var W=O[V];P=I.pivotUnit(W,C,L.depth,L.subDepth,P);};if(this.pivotClientSideInReverseOrder(O,Q,H,U)){for(i=O.length-1;i>=0;--i){K(i);}}else{for(i=0;i<O.length;++i){K(i);}}D.list=P;}T.push(M.createActionObject(null,mstrUpdateManager.PIVOT_MULTIPLE_UNITS,this.beanPath,["4110","4213","4008","4009"],[A,R,Q,H],null,D));}return T;}catch(E){microstrategy.errors.log(E);return null;}};mstrGridReport.prototype.pivotClientSideInReverseOrder=function(E,B,A,D){if(E&&E.length){var C=E[0];switch(C.dssType){case microstrategy.DSSTYPE_METRIC:case microstrategy.DSSTYPE_USER_METRIC:case microstrategy.DSSTYPE_USER_SUMMARY_METRIC:case microstrategy.DSSTYPE_ATTRIBUTE_FORM:if(C.depth<A){return false;}break;case microstrategy.DSSTYPE_ATTRIBUTE:if(C.axis==B&&C.depth<A){return false;}break;default:return true;}}return true;};mstrGridReport.prototype.buildPivotingSrc=function(A){try{var B=",";var C=A.dssType;var E=null;if(A.subtype==microstrategy.SUBOBJTYPE_METRIC){E=A.depth;}else{if(A.subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM){E=A.parentDssId+B+A.attFormId;}else{C=A.isMetricTemplateUnit?"-1":A.dssType;E=A.axis+B+A.depth;}}return C+B+E+"!";}catch(D){microstrategy.errors.log(D);return null;}};mstrGridReport.prototype.buildDeletingFromReportSrc=function(A){try{var B=",";var C=A.dssType;var E=null;if(A.subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM){E=A.parentDssId+B+A.attFormId;}else{C=A.isMetricTemplateUnit?"-1":A.dssType;E=A.dssId;}return C+B+E+"!";}catch(D){microstrategy.errors.log(D);return null;}};mstrGridReport.prototype.onmouseover=function(D){try{D=D||window.event;var E=getEventTarget(D);var F=E&&E.nodeName&&E.nodeName.toLowerCase();if(!F){return ;}if((F!="td")){E=microstrategy.findParentWithTag(E,"td");}var C=this.gridStructureInfo&&this.gridStructureInfo.getGridCellProps(E);if(E&&!E.getAttribute("title")){if(C&&C.getCellTooltip()){E.setAttribute("title",C.getCellTooltip());}}if(this.quickSearchEnabled&&E){var B=microstrategy.findParentWithTag(E,"tr");if(B.getAttribute(microstrategy.HTMLATTR_GRIDROW_ORDINAL)){this.hideQuickSearchIcon();return ;}else{this.showQuickSearchIcon(E);}}mstrGridStatic.prototype.onmouseover.apply(this,arguments);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.onmouseout=function(B){try{this.hideQuickSearchIcon();this.hideToolbarOnMouseOut();}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.hideQuickSearchIcon=function(B){try{var C=this.qsPopupIcon;if(C){C.style.display="none";}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.canShowQuickSearchIcon=function(J){try{var H=this.quickSearch&&this.quickSearch.searchBoxPopup;if(H&&H.modal){return false;}var G=microstrategy.findParentWithTag(J,"tr");if(G.getAttribute(microstrategy.HTMLATTR_GRIDROW_ORDINAL)){return false;}var I=J.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH),A=J.getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS),E=J.getAttribute(microstrategy.HTMLATTR_GRID_UNIT_POS),D=J.getAttribute(microstrategy.HTMLATTR_ORIENTATION),C=J.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);this.qsDepthInfo={};this.qsCssName="row";if(D==microstrategy.GRIDCELL_ORIENTATION_VERTICAL){this.qsCssName=C==microstrategy.SUBOBJTYPE_ATTRIBUTE?"row":"metric";}else{if(D==microstrategy.GRIDCELL_ORIENTATION_HORIZONTAL&&C==microstrategy.SUBOBJTYPE_ATTRIBUTE){this.qsCssName="col";}}if(E){if(D==microstrategy.GRIDCELL_ORIENTATION_VERTICAL&&C==microstrategy.SUBOBJTYPE_METRIC){A=microstrategy.GRIDCELL_AXIS_METRICS;this.qsDepthInfo.upt=E;}else{var F=J.previousSibling;while(F&&F.tagName&&F.tagName.toLowerCase()=="td"){I=F.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH);A=F.getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS);D=F.getAttribute(microstrategy.HTMLATTR_ORIENTATION)==microstrategy.GRIDCELL_ORIENTATION_HORIZONTAL;if(A&&I&&D){break;}F=F.previousSibling;}}}if(A&&I){this.qsDepthInfo.axis=A;this.qsDepthInfo.depth=parseInt(I)+1;return true;}return false;}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.showQuickSearchIcon=function(K){try{if(!this.canShowQuickSearchIcon(K)){return ;}var B="mstrQSIcon",E=w=20;var I=this.qsPopupIcon;if(!I){var D=this.id;var A=document.createElement("div");A.id=B;A.onclick=function(){microstrategy.bone(D).showQuickSearchPopup();};A.onmouseover=function(){this.style.display="block";};A.onmouseout=function(){this.style.display="none";};var J=document.createElement("div");J.className="mstrQSIcon-axis";A.appendChild(J);var F=document.createElement("div");F.className="mstrQSIcon-line";A.appendChild(F);document.body.appendChild(A);this.qsPopupIcon=I=A;}var G=mstr.utils.BoxModel,H=G.position(K),L=I.style;L.display="block";L.left=Math.min(G.getBrowserWindowWidth(document)-w,H.left+K.offsetWidth)-w+"px";L.top=H.top-E+"px";I.className=this.qsCssName;I.lastChild.style.top=(this.qsCssName=="col"&&this.qsDepthInfo.axis==2)?E+K.offsetHeight+"px":"";}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.showQuickSearchPopup=function(){try{var B=this,C=function(){var D=(B.quickSearch=mstrGridReport.fnGetQuickSearchWidget());var E=B.qsDepthInfo;D.axis=E.axis;D.depth=E.depth;D.openPlaceholderPopup(mstr.utils.BoxModel.position(B.qsPopupIcon,true));};microstrategy.mojoLoader.loadWidget({bundle:"mojo-ros.js",callback:C});}catch(A){microstrategy.errors.log(A);}return false;};mstrGridReport.prototype.onclick=function(A){return null;};mstrGridReport.prototype.onmousedown=function(J){try{microstrategy.hidePopups();if(this.gridStructureInfo.isEmptyTemplate||!this.isGrid){return null;}J=J||window.event;var E=getEventTarget(J);var L=E.nodeName.toLowerCase();if(L=="select"&&E.name=="WBV"){return null;}if((L!="td")&&J.button==2){E=microstrategy.findParentWithTag(E,"td");}var N=E;if((N.nodeName.toLowerCase()!="td")){N=microstrategy.findParentWithTag(N,"td");}var I=N.getAttribute("cx");var B=N.getAttribute("D1");var K=N.getAttribute("ctm");if(N.getAttribute(microstrategy.HTMLATTR_GRIDCELL_ID)&&(!I||!B||!K)){var D=this.gridStructureInfo.getGridCellProps(N);if(D){if(!I&&D.getCellCx()){N.setAttribute("cx",D.getCellCx());}if(!B&&N.getAttribute(microstrategy.HTMLATTR_GRIDCELL_ORDINAL)){N.setAttribute("D1",D.getCellDrillElement(N));}if(!K&&D.getAttColTitleMissing()){N.setAttribute("ctm","1");N.setAttribute("AX","2");N.setAttribute("DPT",String(D.depth));N.setAttribute("STY",microstrategy.SUBOBJTYPE_ATTRIBUTE);var M=this.gridStructureInfo.getUnit(2,D.depth);var C=M&&M.dssId;if(C){N.setAttribute(microstrategy.HTMLATTR_DSS_ID,C);}}}}if(L.toLowerCase()=="a"){var F=microstrategy.findParentWithTag(E,"td");var A=7;if(F.getAttribute("ts")==A){E.href=microstrategy.addCSRFTokenToURL(E.href);}}if(J.button==2){this.processRightMouseClick(J,E);}var H=null;if(J.button!=2){H=this.processMousedown(J,E);if(H!=null){return H;}return this.postmousedown(J,E);}else{return true;}}catch(G){microstrategy.errors.log(G);return false;}};mstrGridReport.prototype.processRightMouseClick=function(D,B){try{D.cancelBubble=true;var A=(B!=null&&this.selections)?this.selections.isCellSelected(B):false;if(!A&&this.selections!=null){this.selections.addToSelections(D,B);}}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.processMousedown=function(G,C){try{var B=findTarget(C,microstrategy.HTMLATTR_SUBOBJTYPE);if(B){getMouse(G);this.x=lMouseX;this.y=lMouseY;this.activeElement=B;var F=this.activeElement.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);G.cancelBubble=true;switch(F){case microstrategy.SUBOBJTYPE_RESIZE_VLINE:this.bindingEvents(this,{mousemove:{s:"onresizestart"},mouseup:{s:"onmouseup"}});return false;case microstrategy.SUBOBJTYPE_BTN:if(getButtonId(G)==1){var K=B.getAttribute("id");var J=findTarget(B.parentNode,microstrategy.HTMLATTR_SUBOBJTYPE);if(K&&J){return this.processPivotButtons(J,K);}}break;case microstrategy.SUBOBJTYPE_OUTLINE_MODE_IMG:var E=B.getAttribute("dpt");var I=B.getAttribute("rcnt");var H=B.getAttribute("ist");if(this.outlineMode){this.outlineMode.showHideRows(this.id,parseInt(E),parseInt(I),H);}return true;case microstrategy.SUBOBJTYPE_RA_BTN:this.raOutlineModeImpl=new mstrRaOutlineModeImpl(0,this.gridTable.rows.length-1,this);this.raOutlineModeImpl.showHideRows(B);return true;case microstrategy.SUBOBJTYPE_ATTRIBUTE:case microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM:case microstrategy.SUBOBJTYPE_METRIC:stopEventBubbling(G);var A=B.getAttribute("dg");if(A&&A.toLowerCase()=="true"&&this.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE)){this.bindingEvents(this,{mousemove:{s:"ondragstart"},mouseup:{s:"ondragcancel"}});}break;}}if(C&&this.selections!=null&&C.nodeName.toLowerCase()=="td"){this.selections.addToSelections(G,C);}return null;}catch(D){microstrategy.errors.log(D);return null;}};mstrGridReport.prototype.postmousedown=function(C,A){try{stopEventBubbling(C);return false;}catch(B){microstrategy.errors.log(B);return null;}};mstrGridReport.prototype.onresizestart=function(B){try{this.detachWinListener(this,"mousemove");this.saveEnabled=true;this.isSaveBeforeDocCreate=true;this.notifySelectionChange("ongridselectionschange");return this.colWidths.onresizestart(B);}catch(A){microstrategy.errors.log(A);return null;}};mstrGridReport.prototype.createDrillActions=function(G,F,A,C,E,I){try{var B=["4034","4134","4035","4212"];var H=[G,F,A,C,E];if(!this.oldFormatDrillPathImportance){B=["4178"].concat(B);}else{B=["4033","4124"].concat(B);H.splice(1,0,this.oldFormatDrillPathImportance);}if(I&&this.sliceID){B.push("4254");H.push(this.sliceID);}return this.um.createActionObject(this.elem,mstrUpdateManager.GRID_DRILL,this.beanPath,B,H,[]);}catch(D){microstrategy.errors.log(D);return null;}};mstrGridReport.prototype.showAdvDrillEditor=function(C,B,A){this.um.useIframe=A?true:false;this.addAction(null,mstrUpdateManager.OPEN_ADV_DRILL_EDITOR,this.beanPath,["6011","6012","6010","6031"],[C,B,1,"drillEditor"]);};mstrGridReport.prototype.drill=function(G,E,B,H){try{var F="";if(this.drillRetainParentValue!="3"){F=this.drillRetainParentValue;}var A="";if(this.drillKeepThreshValue!="3"){A=this.drillKeepThreshValue;}var I=this.commands.queryState("selectedDrillElements");if(B==null){B=I;}else{if(I&&(!this.isReportMdxCube())){B=B+","+I;}}var D=this.createDrillActions(G,F,A,B,E,H);if(this.drillOpenInNewWindow&&!(parseInt(H))){this.um.newWindow=true;}this.um.useIframe=this.drillIframeEnabled;this.commands.exec("clearAllGridSelections");if(D){this.um.add([D]);this.um.flushAndSubmitChanges();this.um.acknowledgeRequest();}}catch(C){microstrategy.errors.log(C);}return false;};mstrGridReport.createDragDisplay=function(){var A=document.createElement("span");A.className="mstrDnDReportDragItem";A.appendChild(document.createTextNode(""));return document.body.appendChild(A);};mstrGridReport.prototype.initializeDragDisplay=function(){try{this.dragDisplay=this.dragDisplay||mstrGridReport.createDragDisplay();}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.ondragstart=function(H){try{H=this.initEvent(H,true);var M=this.selections;var K=Math.abs(lMouseX-this.x);var J=Math.abs(lMouseY-this.y);if(K>3||J>3){var B=getEventTarget(H);var L=(B!=null&&M)?M.isCellSelected(B):false;if(!L){M.addToSelections(H,B);}var A=(M!=null)?M.getSelectedCellsWithAttr("dg","true"):new Array;if(M.isEmpty()||A==null||A.length<1){M.clearAll(true);}if(!M.isCellSelected(this.activeElement)){M.add(this.activeElement);A.push(this.activeElement);}A.sort(new Function("a","b","return microstrategy.bone('"+this.id+"').sortByAxisDepth(a,b);"));var I=new Array;this.dragItems=new Array;var G="";var D=0;for(var F in A){var E=A[F];this.dragItems[D]=E;I[D++]=(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_METRIC)?microstrategy.DSSTYPE_METRIC:microstrategy.DSSTYPE_ATTRIBUTE;G+=E.getAttribute(microstrategy.HTMLATTR_DESCRIPTION)+",";}this.initializeDragDisplay();this.dragDisplay.replaceChild(document.createTextNode(G.substring(0,G.length-1)),this.dragDisplay.firstChild);this.initMapper();M.clearAll();for(F in this.dragItems){M.add(this.dragItems[F]);}M.clearDeferredSrc();microstrategy.eventManager.onnotifydrag(this.dragItems,this,I);this.bindingEvents(this,{mousemove:{s:"ondrag"},mouseup:{s:"ondragend"}});this.ondrag(H);}}catch(C){microstrategy.errors.log(C);}return false;};mstrGridReport.prototype.ondrag=function(B){try{B=this.initEvent(B,true);if(lMouseX>Math.max(document.documentElement.scrollWidth,document.body.scrollWidth)-25){return ;}moveObjTo(this.dragDisplay,lMouseX-getObjWidth(this.dragDisplay)-microstrategy.CURSOR_OFFSET,lMouseY-getObjHeight(this.dragDisplay)-microstrategy.CURSOR_OFFSET);this.dndHelper.moveHelperImage(B);microstrategy.scrollPageHorizontally(lMouseX);}catch(A){microstrategy.errors.log(A);}return false;};mstrGridReport.prototype.ondragend=function(C){try{C=this.initEvent(C);microstrategy.eventManager.notifyOrphanBones("onnotifydragend");this.onmouseup(C);this.dndHelper.parkObject(this.dragDisplay);var D=microstrategy.findAncestor(getEventTarget(C));if(D){var B=microstrategy.boneForMask(D);if(B&&B.ondrop){if(B.id=="UniqueReportID"&&D.tagName.toLowerCase()!="area"&&!B.isGraph){return ;}B.ondrop(D,this.selections);if(this.selections){this.selections.clearAll(true);}if(this.useClientSideManipulations){microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",this.gridStructureInfo);}}}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.ondragcancel=function(B){try{B=this.initEvent(B,true);this.onmouseup(B);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.onmouseup=function(C,B){try{if(C&&C.e){C=C.e;}this.activeElement=null;if(this.dndHelper){this.dndHelper.onmouseup((B)?B:this.id);}if(!this.isDropZoneEditor&&this.selections){this.selections.onmouseup(C);}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.shouldInitMask=function(){try{return(this.useDNDMapping);}catch(A){microstrategy.errors.log(A);return null;}};mstrGridReport.prototype.initMask=function(){try{this.mask=new mstrMaskMappedImpl(function(D){try{D=D||{};var B=this.maskedBone&&this.maskedBone.elem.getElementsByTagName("tbody")[0];if(B!=null&&B.rows!=null){D.height=parseInt(B.offsetHeight);D.width=parseInt(B.offsetWidth);}return D;}catch(C){microstrategy.errors.log(C);}});}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.initSelections=function(restoreState){try{if(this.isGrid){var s=this.selections=new mstrGridSelectionsImpl();s.parentBone=this;s.path="microstrategy.bone('"+this.id+"').selections";s.onload();if(restoreState&&this.gridSelections&&!(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION&&microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)){var gs=eval("("+this.gridSelections+")");if(gs&&gs.src==true){this.setGridUnitSelections(gs.unit,gs.value);}else{s.repopulateSelections();}}}}catch(err){microstrategy.errors.log(err);}};mstrGridReport.prototype.getExecTarget=function(){try{return microstrategy;}catch(A){microstrategy.errors.log(A);return null;}};mstrGridReport.prototype.exec=function(I,S,V){try{var M=false;var a=this.getExecTarget();if(a!=null){var H;if(typeof (S)=="string"||typeof (S)=="number"){if(I=="lncolor"){H=["borderTopColor",S];}else{H=a.setSingleFormat(I,S);}}else{if(S!=null){H=new Array(2);if(I=="lncolor"){H[0]="borderTopColor";}H[1]=S[1];}else{return(M=false);}}var O=this.um;I=H[0];S=H[1];if(I&&S){var T=null;if(this.isGraph){var c=null;var C=[];var D=[];D.push(S);switch(I){case"changeChartWindow_horizontal":case"changeChartWindow_vertical":c=S.split("|");var N=(I=="changeChartWindow_vertical")?"series":"categories";this.changeChartWindow(O,N,c[0],c[1]);O.flushAndSubmitChanges();M=true;break;default:}if(C.length>0&&T!=null){O.add([O.createActionObject(this.elem,T,this.beanPath,C,D,[],[])]);if(!this.useClientSideManipulations&&!V){O.flushAndSubmitChanges();}M=true;}}if(this.isGrid&&!M){var Z=mstrFormatObject;if((I!="backgroundColor"&&I!="Gradient")||S.indexOf(",")<0||S.indexOf("rgb")>=0){S=Z.encodeValue(I,S);}var J=null;var L=S;var W=null;var P=null;var K=null;T=null;if(I=="Gradient"){I="backgroundColor";}var E=Z[I];if(E!=null){E=E[0];switch(E){case"FormattingFont":T=mstrUpdateManager.SAVE_GRID_FONT_PROPERTIES;J={fontFamily:"4042",fontSize:"4045",color:"4048"}[I];break;case"FormattingAlignment":T=mstrUpdateManager.SAVE_GRID_ALIGNMENT_PROPERTIES;switch(I){case"textAlign":L=this.adjustTextAlignValueForGrid(L);J="4056";break;}break;case"FormattingBorder":T=mstrUpdateManager.SAVE_GRID_BORDER_PROPERTIES;switch(I){case"borderTopColor":case"borderLeftColor":case"borderRightColor":case"borderBottomColor":var F=this.selections.getSelectedGridTargetGridLevel();for(var Y in F){var U=F[Y].split(",");var B=U[0];var e=U[1];var R=U[2];var A=U[3];if(this.isTargetUnitLevelValid(R,A)){O.add([O.createActionObject(this.elem,T,this.beanPath,["4006","4007","4109","4108","4067","4068","4069","4070","4223","4126"],[B,e,A,R,L,L,L,L,"0",this.styleName],[],[])]);}}if(!this.useClientSideManipulations&&!V){O.flushAndSubmitChanges();}M=true;break;}break;case"FormattingPatterns":T=mstrUpdateManager.SAVE_GRID_PATTERN_PROPERTIES;break;default:}}var Q=this.selections.getSelectedGridTargetGridLevel();if(Q.length==0){this.setGridUnitSelections(this.gridUnitFormat,this.gridValueFormat);Q=this.selections.getSelectedGridTargetGridLevel();}for(Y in Q){U=Q[Y].split(",");B=U[0];e=U[1];R=U[2];A=U[3];if(J!=null&&T!=null){var X=O.createActionObject(this.elem,T,this.beanPath,["4006","4007","4109","4108",J,"4126",W],[B,e,A,R,L,this.styleName,P],[],[]);if(!(W&&P&&K&&K.length>0)){O.add([X]);}M=true;}}if(!this.useClientSideManipulations&&!V){O.flushAndSubmitChanges();}}}}}catch(G){microstrategy.errors.log(G);M=false;}return M;};mstrGridReport.prototype.changeChartWindow=function(G,A,H,C){var F=(C-H+1)<1?1:C-H+1;var D=(this.isGrid&&this.isGraph)?H:"";var B=(this.isGrid&&this.isGraph)?F:"";if(this.seriesLayout!="1"){A=(A=="categories")?"series":"categories";}var E=(A=="categories")?["4018","4020","4022","4024"]:["4019","4021","4023","4025"];G.add([G.createActionObject(this.elem,mstrUpdateManager.SET_RESULT_WINDOW,this.beanPath,E,[D,B,H,F])]);};mstrGridReport.prototype.isTargetUnitLevelValid=function(C,E){try{var A=(C==2)||(C==6);var D=(E==3)||(E==4);return(!A||!D);}catch(B){microstrategy.errors.log(B);return false;}};mstrGridReport.prototype.adjustTextAlignValueForGrid=function(A){return{0:"2",1:"4",2:"3"}[A]||A;};mstrGridReport.prototype.getDNDHelperImage=function(D,A){if(!A){return null;}if(D.type!=this.type||D.id==this.id){var E=A.split(",");if(!isNaN(E[0])){var C=parseInt(E[0]);var B=microstrategy.FOLDER_IMAGES;if(C==microstrategy.GRIDCELL_AXIS_ROWS){B+="dRows.gif";}else{if(C==microstrategy.GRIDCELL_AXIS_COLUMNS){B+="dcols.gif";}else{if(C==microstrategy.GRIDCELL_AXIS_METRICS){B+="dMetrics.gif";}}}return B;}}return null;};mstrGridReport.prototype.isRemoveFromGrid=function(B){try{return(B)?this.isFeatureAvailable(B):false;}catch(A){microstrategy.errors.log(A);return null;}};mstrGridReport.prototype.deleteItems=function(B){try{if(this.selections){this.selections.clearAll(true);}var C=microstrategy.updateManager;var E=[];var F=this.isRemoveFromGrid(microstrategy.FEATURE_WEB_REMOVE_FROM_GRID);var A=(B.length==1);E=this[(A)?"deleteItemSrc":"deleteMultiItemSrc"](((A)?B[0]:B),E,!F);if(E.length>0){C.add(E);if(!this.useClientSideManipulations){if(this.dragSource&&this.dragSource.type==microstrategy.OBJTYPE_GRAPH_ZONES){togglePulldowns(this.dragSource.elem,true);}C.flushAndSubmitChanges();}}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrGridReport.prototype.processPivotButtons=function(J,L){try{var G=microstrategy.updateManager;if(!G){return false;}var K=[];if(L=="x"){K=this.deleteItemSrc(J,K);}else{if(L=="xx"){if(this.useClientSideManipulations){microstrategy.eventManager.notifyOrphanBones("onunitremoved",this.gridStructureInfo.buildGridUnitInfo(J));}K=this.deleteItemSrc(J,K,true);}else{var H=this.gridStructureInfo.getGridUnitInfo(J);var C=H.axis;var E=H.depth;var A=H.subDepth;if(L=="c"){C=(C==microstrategy.GRIDCELL_AXIS_ROWS)?microstrategy.GRIDCELL_AXIS_COLUMNS:microstrategy.GRIDCELL_AXIS_ROWS;K=this.pivotUnit(H,C,1,1,K);}else{if(L=="p"){K=this.pivotUnit(H,microstrategy.GRIDCELL_AXIS_PAGE_BY,-1,1,K);}else{if(H.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){if(this.isFeatureAvailable(microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY)&&this.showAttForms){if(L=="l"||L=="u"){(A==1)?E--:A--;}else{var B=this.gridStructureInfo.findUnit(H.parentDssId);(A==B.attForms.size())?E++:A++;}}else{A=1;(L=="l"||L=="u")?E--:E++;}}else{H=this.gridStructureInfo.getGridUnitInfoBySrc(J);var F=H?H.index:-1;C=H.axis;E=H.depth;A=H.subDepth;if(F>-1){(L=="l"||L=="u")?F--:F++;var I=this.gridStructureInfo.allAxes[(C==microstrategy.GRIDCELL_AXIS_METRICS)?0:C].units[F];E=I?I.depth:H.depth;}else{(L=="l"||L=="u")?E--:E++;}}K=this.pivotUnit(H,C,E,A,K);}}}}if(K.length>0){G.add(K);this.selections.clearAll(true);if(this.useClientSideManipulations){microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",this.gridStructureInfo);}else{G.flushAndSubmitChanges();if(bIsChrome){window.setTimeout(function(){window.getSelection().removeAllRanges();},0);}}}return true;}catch(D){microstrategy.errors.log(D);return null;}};mstrGridReport.prototype.processContextMenus=function(P,D){try{var V=microstrategy.updateManager;if(!V){return false;}var N=microstrategy.activeCXMenu;var S=function(a){return N.getAttribute(microstrategy["HTMLATTR_DSS_"+a]);};if(N){var I=false;var H=[];var h=[];var AG,Z;switch(P){case"pttm":h=D.split(",");switch(h[0]){case"r":case"c":case"p":case"g":var y={r:1,c:2,p:4,g:0};this.addPercentToTotal(N,y[h[0]],null);break;case"a":this.addPercentToTotal(N,0,h[1]);break;}break;case"rm":h=D.split(",");var AE=mstr.utils.Arrays.find(["a","n"],h[1]);if(AE>-1){var AC=null;if(AE==0){AC=h[2];}this.addRankMetric(N,AC,h[0]);}break;case"tm":h=D.split(",");this.addTransformationMetric(N,h[0],h[1]);break;case"xx":if(this.useClientSideManipulations){var Q=[N];if(this.selections){Q=this.getObjInfoList(this.selections.getSelectedUnitHeaders());}microstrategy.eventManager.notifyOrphanBones("onunitsremoved",Q);}case"x":var AD=this.selections&&this.selections.getSelectedUnitHeaders();if(this.selections&&AD&&AD.length>1){var Y=(P=="xx");H=this.deleteMultiItemSrc(AD,H,Y);}else{H=this.deleteItemSrc(N,H,P=="xx");}if(this.selections){this.selections.clearAll(true);}if(H.length>0&&this.useClientSideManipulations){microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",this.gridStructureInfo);}I=(P=="xx");break;case"keepOnGrid":var AD=this.selections&&this.selections.getSelectedUnitHeaders();if(this.selections&&AD&&AD.length>=1){H=this.keepUnits(AD,H);}if(this.selections){this.selections.clearAll(true);}if(H.length>0&&this.useClientSideManipulations){microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",this.gridStructureInfo);}break;case"p":case"c":case"l":case"r":case"u":case"d":var K=this.selections.getSelectedCellsWithAttr("dg","true");K.sort(new Function("a","b","return microstrategy.bone('"+this.id+"').sortByAxisDepth(a,b);"));var Q=this.getObjInfoList(K);var R;if(K.length<=1){R=N;}else{if(P=="l"||P=="u"){R=K[0];}else{if(P=="r"||P=="d"){R=K[K.length-1];}else{R=N;}}}U=this.gridStructureInfo.getGridUnitInfo(R);var O=U.axis;var F=U.depth;var o=U.subDepth;if(P=="p"){O=microstrategy.GRIDCELL_AXIS_PAGE_BY;F=-1;o=1;}else{if(P=="c"){O=(O==microstrategy.GRIDCELL_AXIS_ROWS)?microstrategy.GRIDCELL_AXIS_COLUMNS:microstrategy.GRIDCELL_AXIS_ROWS;F=1;o=1;}else{if(U.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){if(this.isFeatureAvailable(microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY)&&this.showAttForms){if(P=="l"||P=="u"){(o==1)?F--:o--;}else{var A=this.gridStructureInfo.findUnit(U.parentDssId);(o==A.attForms.size())?F++:o++;}}else{o=1;(P=="l"||P=="u")?F--:F++;}}else{U=this.gridStructureInfo.getGridUnitInfoBySrc(R);var T=U?U.index:-1;O=U.axis;F=U.depth;o=U.subDepth;if(T>-1){(P=="l"||P=="u")?T--:T++;var e=this.gridStructureInfo.allAxes[(O==microstrategy.GRIDCELL_AXIS_METRICS)?0:O].units[T];F=e?e.depth:U.depth;}else{(P=="l"||P=="u")?F--:F++;}}}}if(P=="l"||P=="r"||P=="u"||P=="d"){var AH=this.gridStructureInfo.getMaxAxisPosition(O);if(F<1||F>=AH){return false;}}H=(Q.length>1)?this.pivotUnits(Q,O,F,o,H):this.pivotUnit(U,O,F,o,H);var q=this.selections&&this.selections.clearAll(true);q=(H.length>0)&&microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",this.gridStructureInfo);break;case"atfa":h=D.split(EXPRESSION_SEPARATOR);var AA=h[0];var L=h[1];U=this.gridStructureInfo.buildGridUnitInfo(N);var X=this.gridStructureInfo.buildFormSrcFromCM(U,L,AA);o=this.gridStructureInfo&&this.gridStructureInfo.getAttrFormPos(X);H=this.addUnit(X,U.axis,U.depth,o,H);q=this.selections&&this.selections.clearAll(true);q=(H.length>0)&&this.useClientSideManipulations&&microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",this.gridStructureInfo);break;case"atfr":var E=this.gridStructureInfo.findUnit(S("ID"));if(E==null){break;}if(E.hasAttForms()&&E.attForms.size()>1){var C=E.attForms.findUnit(D);H=this.deleteUnit(C,H);q=this.selections&&this.selections.clearAll(true);q=(H.length>0&&this.useClientSideManipulations)&&microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",this.gridStructureInfo);}else{showMessage({contents:mstrGridReport.desp("3626"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}break;case"atfm":this.addAction(null,mstrUpdateManager.OPEN_ATT_FORMS_EDITOR,this.beanPath,["6042","6044"],[S("ID"),"false"]);break;case"gridFormat":var AB=this.gridStructureInfo.getGridUnitInfo(N);this.gridUnitFormat=this.resolveGridUnitId(AB.axis,AB.depth);this.gridValueFormat=1;window.setTimeout("microstrategy.bone('"+this.viewerId+"').commands.exec('openFormatGrid', { selectedIndicesList : 9 });",20);break;case"rename":var g="formulaMode=0&activeViewID="+this.objId+"&activeDatasetID="+this.dSetId;g=g+"&activeElemIndx="+D;toggleShowBean("formula",true,g);break;case"mfc":case"mftop":case"mfbottom":case"mfedit":case"mfadd":var G={mfc:"CLEAR_UNIT_LIMIT",mfedit:"EDIT_UNIT_LIMIT",mfadd:"ADD_SUBEXPRESSION"}[P]||"SET_UNIT_LIMIT";AG=["1001"];Z=[S("ID")];if(P=="mftop"||P=="mfbottom"){AG=AG.concat(["1002","262144011","262144017","262144014"]);Z=Z.concat([S("TYPE"),((P=="mftop")?"1":"2"),"2","10"]);}var n=mstrUpdateManager[G];this.addAction(null,n,this.bp[n],AG,Z);break;case"fos":var x=this.commands.queryState("selectedDrillElements");this.commands.exec("clearAllGridSelections");var AI=["4035"];var AF=[x];if(this.sliceID){AI.push("4254");AF.push(this.sliceID);}AI.push("4134");AF.push("1");this.addAction(null,mstrUpdateManager.FILTER_ON_SELECTIONS,this.beanPath,AI,AF);break;case"deopenNewSort":var U=this.gridStructureInfo.getGridUnitInfo(N),W={dssId:U.dssType==21?U.parentDssId:U.dssId,dssSetId:U.dssSetId};var J=this;microstrategy.openCustomSortEditor({mid:this.messageID||mstrApp.oi.mid,uKey:this.RWUnitId,att:W,bp:this.beanPath,onSave:function(c){var a=mstrmojo.hash.copy(c,{attId:W.dssId});J.addAction(null,mstrUpdateManager.VIEW_EVENT_CUSTOM_SORT,J.beanPath,[409606622],[JSON.stringify(a)]);}});break;case"deopenSort":case"deopen":AG=["1001"];Z=[S("ID")];if(P==="deopenSort"){AG.push("6048");Z.push("1");}this.addAction(null,mstrUpdateManager.OPEN_DERIVED_ELEMENTS_EDITOR,this.bp[mstrUpdateManager.OPEN_DERIVED_ELEMENTS_EDITOR],AG,Z);break;case"declear":showMessage({contents:mstrGridReport.desp("5776"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bones['"+this.id+"'].clearDerivedElements('"+S("ID")+"')",title:mstrGridReport.desp("5950")});break;case"deSum":case"deAvg":case"deMin":case"deMax":case"deMinus":case"deDivide":case"deList":this.addCalculationQuickGroup(P);return null;case"WebHyperLinkEditor":var B="activeUnitID="+S("ID")+"&activeUnitType="+S("TYPE")+"&renderPromptsOnly=false";toggleShowBean("webHyperLinkEditor",true,B);break;case"edtSimpleThresholds":case"edtAdvancedThresholds":var M=P;if(microstrategy.EXECUTION_SCOPE!=microstrategy.RWD_EXECUTION){M=M.replace("edtSim","edtReportSim");}toggleShowBean(M,true,"&activeViewID="+this.objId+"&container="+D);break;case"alert":g="&activeViewID="+this.objId+"&container="+D;toggleShowBean("alertsEditor",true,g);break;case"alertMobile":g="&activeViewID="+this.objId+"&container="+D;this.um.replaceURL("deliveryMode","128");toggleShowBean("mobileAlertsEditor",true,g);break;case"alertEmail":g="&activeViewID="+this.objId+"&container="+D;this.um.replaceURL("deliveryMode","1");toggleShowBean("alertsEditor",true,g);break;}if(H.length>0){V.add(H);if(!this.useClientSideManipulations||I){V.flushAndSubmitChanges();}}return true;}}catch(z){microstrategy.errors.log(z);}return false;};mstrGridReport.prototype.clearDerivedElements=function(A){try{this.addAction(null,mstrUpdateManager.CLEAR_DERIVED_ELEMENTS,this.beanPath,["1001"],[A]);return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrGridReport.prototype.pivotUnit=function(K,E,I,C,O){try{var J=this.um;var H={id:this.id,pivot:true};var L=this.gridStructureInfo;var A=L.getMaxAxisPosition(E);if(K.axis!=E){if(I>A||I==-1){I=A;}}else{if(I>=A||I==-1){I=A-1;}}var B=false;if(K.subtype==microstrategy.SUBOBJTYPE_METRIC||K.isMetricTemplateUnit){if(K.axis!=E){B=(L.metricsAxis!=E||L.metricsDepth!=I);}else{B=(K.depth!=I);}}else{B=(K.axis!=E||K.depth!=I);if(this.isFeatureAvailable(microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY)&&this.showAttForms){B=(B||K.subDepth!=C);}}var N=K.src;if(B){var G=mstrGridReport.updateNow();switch(K.subtype){case microstrategy.SUBOBJTYPE_ATTRIBUTE:O.push(J.createActionObject(K,mstrUpdateManager.PIVOT_TEMPLATE_UNIT,this.beanPath,["4110","4006","4007","4008","4009"],[G,K.axis,K.depth,E,I],[G,K.axis,K.depth,E,I],H));break;case microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM:if(K.axis!=E||K.depth!=I){var D=L.findUnit(K.parentDssId);O.push(J.createActionObject(D,mstrUpdateManager.PIVOT_TEMPLATE_UNIT,this.beanPath,["4110","4006","4007","4008","4009"],[G,K.axis,K.depth,E,I],[G,K.axis,K.depth,E,I],H));}else{O.push(J.createActionObject(K,mstrUpdateManager.ADD_FORM,this.beanPath,["4110","4165","4166","4008","4009","4168","4096001"],[G,K.parentDssId,K.dssId,E,I,C,this.dSetId],[G,K.parentDssId,K.dssId,K.axis,K.depth,K.subDepth,this.dSetId],H));}break;case microstrategy.SUBOBJTYPE_METRIC:if(K.axis!=E){K=L.getUnit(L.metricsAxis,L.metricsDepth,1);N=K.src;O.push(J.createActionObject(K,mstrUpdateManager.PIVOT_TEMPLATE_UNIT,this.beanPath,["4110","4006","4007","4008","4009"],[G,K.axis,K.depth,E,I],[G,K.axis,K.depth,E,I],H));}else{O.push(J.createActionObject(K,mstrUpdateManager.PIVOT_TEMPLATE_METRIC,this.beanPath,["4110","4028","4029"],[G,K.depth,I],[G,K.depth,I],H));}break;}if(this.useClientSideManipulations){this.template.pivot(N,E,I,C);if(mstrGridReport.isReport()){var M=null;if(this.id.indexOf("_graph")>-1){var M=microstrategy.bone(this.id.substr(0,this.id.indexOf("_graph")));}else{var M=microstrategy.bone(this.id+"_graph");}}if(M){M.template.generateTemplate();M.template.sendUpdate();}if(this.useDNDMapping&&this.mask!=null){this.mask.onmaskedobjectresize();}}}return O;}catch(F){microstrategy.errors.log(F);return false;}};mstrGridReport.prototype.addUnit=function(R,B,T,O,S,C){try{var N=this.um;var P={id:this.id,allForms:false,pivot:false};if(this.isGraph&&!this.gridStructureInfo.hasMetrics&&B==-1){B=2;}var G=this.gridStructureInfo;var M=G.getMaxAxisPosition(B);if(!C&&(T>M||T==-1)){T=M;}var H=G.buildGridUnitInfo(R,B,T,O);var K=subUnitInfo=null;var L=S.length;if(H.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){K=G.findUnit(H.parentDssId);if(K!=null){if(K.attFormId==H.dssId){S=this.pivotUnit(K,B,T,O,S);if(mstrGridReport.isRWD()&&H.dssSetId!=G.dataSetId&&S.length>L){S=this.changeGridDataSource(H.dssSetId,S);}return S;}else{subUnitInfo=K.attForms.findUnit(H.dssId);if(subUnitInfo!=null){S=this.pivotUnit(subUnitInfo,B,T,O,S);if(mstrGridReport.isRWD()&&H.dssSetId!=G.dataSetId&&S.length>L){S=this.changeGridDataSource(H.dssSetId,S);}return S;}else{if(K.axis!=B||K.depth!=T){S=this.pivotUnit(K,B,T,1,S);T=K.depth;O=K.hasAttForms()?Math.max(K.attForms.size()+1,2):2;}}}}else{P.allForms=true;}}else{K=G.findUnit(H.dssId);if(K!=null){S=this.pivotUnit(K,B,T,O,S);if(mstrGridReport.isRWD()&&H.dssSetId!=G.dataSetId&&S.length>L){S=this.changeGridDataSource(H.dssSetId,S);}return S;}}var A=mstrGridReport.updateNow();var D=microstrategy.bone("pbb_GroupByStyle");var F=D&&D.hasAllSelected;var J=F?"1":"0";switch(H.dssType){case microstrategy.DSSTYPE_ATTRIBUTE:case microstrategy.DSSTYPE_HIERARCHY:if(R.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_XDA_DATA_ELEMENT){S.push(N.createActionObject(H,mstrUpdateManager.ADD_TEMPLATE_UNIT,this.beanPath,["4110","4008","4009","4026","4027","4177","4200","4220","4221","4229"],[A,B,H.depth,H.dssType,H.dssId,H.dssSetId,H.alias,R.getAttribute("did"),R.getAttribute("hid"),J],[],P));break;}case microstrategy.DSSTYPE_PROMPT:if(H.dssType==microstrategy.DSSTYPE_PROMPT){iframe.showWaitPage();var Q=false;mstr.$XHR.request(mstrConfig.taskURL,{taskId:"validatePromptForTemplate",objectID:H.dssId},{success:function(U){Q=U.v||false;}},false);iframe.hideWaitPage();if(!Q){showMessage({contents:mstrGridReport.desp(8946),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});break;}}case microstrategy.DSSTYPE_CONSOLIDATION:case microstrategy.DSSTYPE_FILTER:S.push(N.createActionObject(H,mstrUpdateManager.ADD_TEMPLATE_UNIT,this.beanPath,["4110","4008","4009","4026","4027","4177","4200","4229"],[A,B,H.depth,H.dssType,H.dssId,H.dssSetId,H.alias,J],[],P));break;case microstrategy.DSSTYPE_ATTRIBUTE_FORM:S.push(N.createActionObject(H,mstrUpdateManager.ADD_FORM,this.beanPath,["4110","4165","4166","4008","4009","4168","4177","4200"],[A,H.parentDssId,H.dssId,B,H.depth,O,H.dssSetId,H.parentAlias],[],P));break;case microstrategy.DSSTYPE_METRIC:case microstrategy.DSSTYPE_USER_METRIC:case microstrategy.DSSTYPE_USER_SUMMARY_METRIC:if(!G.hasMetrics){S.push(N.createActionObject(H,mstrUpdateManager.ADD_TEMPLATE_METRIC,this.beanPath,["4110","4029","4008","4009","4122","4201","4177","4164","4229"],[A,"0",B,H.depth,H.dssId,H.alias,H.dssSetId,H.dssSubtype,J],[],P));}else{S.push(N.createActionObject(H,mstrUpdateManager.ADD_TEMPLATE_METRIC,this.beanPath,["4110","4029","4122","4201","4177","4164","4229"],[A,H.depth,H.dssId,H.alias,H.dssSetId,H.dssSubtype,J],[],P));}if(H.dssType==microstrategy.DSSTYPE_USER_METRIC&&mstrGridReport.isRWD()){this.flush=true;S.push(N.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[],null));}break;}if(this.useClientSideManipulations&&S.length>0){this.template.add(R,B,H.depth,O);if(mstrGridReport.isReport()){var I=null;if(this.id.indexOf("_graph")>-1){I=microstrategy.bone(this.id.substr(0,this.id.indexOf("_graph")));}else{I=microstrategy.bone(this.id+"_graph");}if(I){I.template.generateTemplate();I.template.sendUpdate();}}if(this.useDNDMapping&&this.mask!=null){this.mask.onmaskedobjectresize();}}this.dSetId=H.dssSetId||this.dSetId;return S;}catch(E){microstrategy.errors.log(E);return false;}};mstrGridReport.prototype.canAddMDXUnit=function(F){try{if(this.reportObjs){var D=this.reportObjs,H=F.getAttribute(microstrategy.HTMLATTR_DSS_TYPE),G=F.getAttribute("hid"),B=F.getAttribute("did");if(H==microstrategy.DSSTYPE_DIMENSION){for(var C=0,A=D.length;C<A;C++){if(D[C].oty==microstrategy.DSSTYPE_ATTRIBUTE&&D[C].hid==G&&D[C].did==B){return false;}}}else{if(H==microstrategy.DSSTYPE_ATTRIBUTE){for(var C=0,A=D.length;C<A;C++){if(D[C].oty==microstrategy.DSSTYPE_DIMENSION&&D[C].hid==G&&D[C].did==B){return false;}}}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrGridReport.prototype.changeGridDataSource=function(A,B){if(A==this.gridStructureInfo.dataSetId){return B;}B.push(this.um.createActionObject(this.elem,mstrUpdateManager.CHANGE_DATA_SET,this.beanPath,["2048031","2048012"],[A,this.objId]));this.gridStructureInfo.dataSetId=A;if(this.useClientSideManipulations){microstrategy.eventManager.notifyOrphanBones("ongriddatasourcechange");}return B;};mstrGridReport.prototype.replaceTemplate=function(D,E,C){try{var A=new mstrObjectInfoImpl(D);alert("Sorry, this feature has not been implemented yet.");}catch(B){microstrategy.errors.log(B);}return C;};mstrGridReport.prototype.isGridInCellSelectionMode=function(){try{return(this.selections&&this.selections.hasHilitedCells());}catch(A){microstrategy.errors.log(A);return null;}};mstrGridReport.prototype.getObjInfoList=function(F){try{var E=[];for(var C=0,B=F.length;C<B;++C){var A=this.gridStructureInfo.getGridUnitInfo(F[C],(microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM==F[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)));if(A){E.push(A);}}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrGridReport.prototype._updateObjInfoList=function(E){if(!E){return ;}if(!mstrGridReport.isDesignMode()&&this.overlapGridTitles){return ;}var C=false;var D=false;for(var B=0;B<E.length;B++){var A=E[B];if(A.isMetricTemplateUnit){C=true;}else{if(A.subtype==microstrategy.SUBOBJTYPE_METRIC){D=true;}}if(C&&D){break;}}B=0;if(C&&D){while(B<E.length){var A=E[B];if(A.subtype==microstrategy.SUBOBJTYPE_METRIC){E.splice(B,1);}else{B++;}}}};mstrGridReport.prototype.keepUnits=function(G,K){try{var F=this.getObjInfoList(G),J=this.gridStructureInfo,A=[],B={metricCount:0,hasRowAxis:false,hasColAxis:false,hasMetricTemplateUnit:false};for(var E=0,C=F.length;E<C;E++){switch(F[E].axis){case microstrategy.GRIDCELL_AXIS_METRICS:B[F[E].dssId]=true;B.metricCount++;break;case microstrategy.GRIDCELL_AXIS_ROWS:case microstrategy.GRIDCELL_AXIS_COLUMNS:if(F[E].isMetricTemplateUnit){B.hasMetricTemplateUnit=true;}else{if(F[E].subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE){B.hasRowAxis=B.hasRowAxis||(F[E].axis==microstrategy.GRIDCELL_AXIS_ROWS);B.hasColAxis=B.hasColAxis||(F[E].axis==microstrategy.GRIDCELL_AXIS_COLUMNS);B[F[E].dssId]=true;}else{if(F[E].subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM){B.hasRowAxis=B.hasRowAxis||(F[E].axis==microstrategy.GRIDCELL_AXIS_ROWS);B.hasColAxis=B.hasColAxis||(F[E].axis==microstrategy.GRIDCELL_AXIS_COLUMNS);B[F[E].dssId+F[E].parentDssId]=true;}}}break;default:break;}}if(!B.hasMetricTemplateUnit&&B.metricCount>0&&B.metricCount<J.metricAxis.units.length){for(var E=0,C=J.metricAxis.units.length;E<C;E++){var I=J.metricAxis.units[E];if(!B.hasOwnProperty(I.dssId)){A.push(I);}}}function H(O){if(O.isMetricTemplateUnit){return ;}if(!B.hasOwnProperty(O.dssId)){if(O.hasAttForms()){for(var N=0,M=O.attForms.size();N<M;N++){var L=O.attForms.units[N];if(!B.hasOwnProperty(L.dssId+L.parentDssId)){A.push(L);}}}else{A.push(O);}}}if(B.hasRowAxis){for(var E=0,C=J.rowAxis.units.length;E<C;E++){H(J.rowAxis.units[E]);}}if(B.hasColAxis){for(var E=0,C=J.colAxis.units.length;E<C;E++){H(J.colAxis.units[E]);}}K=this.deleteUnits(A,K,false);}catch(D){microstrategy.errors.log(D);}return K;};mstrGridReport.prototype.deleteMultiItemSrc=function(A,C,E){try{var D=this.getObjInfoList(A);C=this.deleteUnits(D,C,E);}catch(B){microstrategy.errors.log(B);}return C;};mstrGridReport.prototype.deleteUnits=function(E,Q,H){try{var M=!!H;var O=this.isRemoveFromGrid(microstrategy.FEATURE_WEB_REMOVE_FROM_GRID);var F=mstrGridReport.updateNow();var B="";var N=[];var P={id:this.id};if(this.isGridObjectLocked(E)){return Q;}this._updateObjInfoList(E);var J=this.um;for(var G=0,C=E.length;G<C;G++){var L=E[G];if(!M&&O){B+=this.buildPivotingSrc(L);}else{B+=this.buildDeletingFromReportSrc(L);}}if(F==mstrUpdateManager.UPDATE_LATER&&!M){for(var G=0,C=E.length;G<C;G++){var L=E[G];N=this.deleteUnit(L,N,H);}}if(B.length>0){P.list=N;var A=mstrUpdateManager.REMOVE_MULTIPLE_UNITS_FROM_WORKING_SET;var K=["4213"];var I=[B];if(!M&&O){A=mstrUpdateManager.REMOVE_MULTIPLE_UNITS;K=["4110"].concat(K);I=[F].concat(I);if(mstrGridReport.isRWD()){K=["4179"].concat(K);I=["true"].concat(I);}}Q.push(J.createActionObject(null,A,this.beanPath,K,I,null,P));}}catch(D){microstrategy.errors.log(D);}return Q;};mstrGridReport.prototype.deleteItemSrc=function(D,C,E){try{var A=this.gridStructureInfo.buildGridUnitInfo(D);this.deleteUnit(A,C,E);return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrGridReport.prototype.deleteUnit=function(K,N,G){try{var H=this.um;var E={id:this.id};var D=mstrGridReport.updateNow();var J=!!G;var M=this.isRemoveFromGrid(microstrategy.FEATURE_WEB_REMOVE_FROM_GRID);if(K.subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM){M=this.isRemoveFromGrid(microstrategy.FEATURE_USE_REPORT_OBJECT_WINDOW);}if(this.isGridObjectLocked([K])){return N;}if(!J&&M){var L=mstrGridReport.isRWD();var P=microstrategy.bone("pbb_GroupByStyle");var C=P&&P.hasAllSelected;var A=C?"1":"0";switch(K.subtype){case microstrategy.SUBOBJTYPE_ATTRIBUTE:if(this.useClientSideManipulations){if(K.isMetricTemplateUnit){var I=[];for(var F=0;F<this.gridStructureInfo.metricAxis.size();F++){I.push(this.gridStructureInfo.metricAxis.units[F]);}E.metrics=I;if(this.controlLinks&&this.controlLinks.Metrics){delete this.controlLinks.Metrics;}}}if(this.controlLinks&&this.controlLinks[K.dssId]){delete this.controlLinks[K.dssId];}if(K.depth>2){var O=this.gridStructureInfo.allAxes[K.axis].units;for(var F=0;F<O.length;F++){if(K.dssId==O[F].dssId){K.depth=O[F].depth;break;}}}N.push(H.createActionObject(K,mstrUpdateManager.REMOVE_TEMPLATE_UNIT,this.beanPath,["4110","4006","4007","4179","4229"],[D,K.axis,K.depth,L,A],[D,K.axis,K.depth,L,A],E));break;case microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM:if(this.isFeatureAvailable(microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY)){N.push(H.createActionObject(K,mstrUpdateManager.REMOVE_FORM,this.beanPath,["4110","4165","4166"],[D,K.parentDssId,K.dssId],[D,K.parentDssId,K.dssId],E));}else{K=this.gridStructureInfo.findUnit(K.parentDssId);N.push(H.createActionObject(K,mstrUpdateManager.REMOVE_TEMPLATE_UNIT,this.beanPath,["4110","4006","4007","4179"],[D,K.axis,K.depth,L],[D,K.axis,K.depth,L],E));}break;case microstrategy.SUBOBJTYPE_METRIC:E.metricsAxis=this.gridStructureInfo.metricsAxis;E.metricsDepth=(this.gridStructureInfo.metricAxis.size()>1)?null:this.gridStructureInfo.metricsDepth;N.push(H.createActionObject(K,mstrUpdateManager.REMOVE_TEMPLATE_METRIC,this.beanPath,["4110","4028","4179","4229"],[D,K.depth,L,A],[D,K.depth,L,A],E));break;}}else{if(K.isMetricTemplateUnit){N.push(H.createActionObject(K,mstrUpdateManager.REMOVE_ALL_WORKINGSET_METRICS,this.beanPath,["4110"],[D],[D],E));}else{switch(K.subtype){case microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM:if(this.isFeatureAvailable(microstrategy.FEATURE_MODIFY_REPORT_LIST)){if(this.isFeatureAvailable(microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY)){N.push(H.createActionObject(K,mstrUpdateManager.REMOVE_FORM,this.beanPath,["4110","4165","4166"],[D,K.parentDssId,K.dssId],[D,K.parentDssId,K.dssId],E));}else{N.push(H.createActionObject(K,mstrUpdateManager.REMOVE_WORKINGSET_OBJECT,this.beanPath,["4110","4165","4166"],[D,K.dssId,K.dssType],[D,K.dssId,K.dssType],E));}}else{showMessage({contents:"You do not have the necessary privileges to perform the selected action.",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}break;default:N.push(H.createActionObject(K,mstrUpdateManager.REMOVE_WORKINGSET_OBJECT,this.beanPath,["4110","4165","4166"],[D,K.dssId,K.dssType],[D,K.dssId,K.dssType],E));break;}}}if(this.isMdxCube){this.useClientSideManipulations=false;}if(this.useClientSideManipulations){this.template.remove(K);if(this.useDNDMapping&&this.mask!=null){this.mask.onmaskedobjectresize();}if(this.gridStructureInfo.isEmptyTemplate){this.dSetId=null;}}return N;}catch(B){microstrategy.errors.log(B);return false;}};mstrGridReport.prototype.isGridObjectLocked=function(A){if(A){var C=A.length;for(var B=0;B<C;B++){var D=A[B];if(D.isLocked&&(D.subtype!=microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM||!this.isFeatureAvailable(microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY))){var E=(C==1)?"3807":"3811";showMessage({contents:mstrGridReport.desp(E),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return true;}}}return false;};mstrGridReport.prototype.swapAxes=function(){try{this.um.add([this.um.createActionObject(this.elem,mstrUpdateManager.SWAP_TEMPLATE_AXES,this.beanPath,[],[],[],{id:this.id})]);if(this.useClientSideManipulations){if(this.isGrid||this.zonesEditor){this.template.swapAxes();}}else{this.um.flushAndSubmitChanges();}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.addPercentToTotal=function(F,G,D){try{var A=this.gridStructureInfo.buildGridUnitInfo(F);var C=["4176","4122"];var B=[G,A.dssId];if(D!=null){C.splice(1,0,"4165");B.splice(1,0,D);}this.addAction(A,mstrUpdateManager.INSERT_PERCENT_TO_TOTAL_METRIC,this.beanPath,C,B);}catch(E){microstrategy.errors.log(E);}};mstrGridReport.prototype.addRankMetric=function(G,E,D){try{var A=this.gridStructureInfo.buildGridUnitInfo(G);var C=["4122","4012"];var B=[A.dssId,D];if(E!=null){C.splice(0,0,"4165");B.splice(0,0,E);}this.addAction(A,mstrUpdateManager.INSERT_RANK_METRIC,this.beanPath,C,B);}catch(F){microstrategy.errors.log(F);}};mstrGridReport.prototype.addTransformationMetric=function(D,B,E){try{var A=this.gridStructureInfo.buildGridUnitInfo(D);this.addAction(A,mstrUpdateManager.INSERT_TRANSFORMATION_METRIC,this.beanPath,["4175","4122","4032"],[B,A.dssId,E]);}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.handleBanding=function(E,D){try{if(!E){E=(this.checkBanding)?0:1;}this.checkBanding=!this.checkBanding;var A=["4125"];var C=[E];if(this.styleName&&this.styleName.length>0){A.push("4126");C.push(this.styleName);}this.addAction(this.elem,mstrUpdateManager.TOGGLE_BANDING,this.beanPath,A,C,D);}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.setSubtotalDisplayOption=function(B,A,D){try{this.addAction(this.elem,mstrUpdateManager.SET_SUBTOTAL_POSITION,this.beanPath,["4006","4217"],[B,A],D);}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.setSubtotalAxisStyle=function(A,F){try{var G=A.split("|");if(!G){return false;}var D=G[0];var B=G[1];var C=G[2];this.addAction(null,mstrUpdateManager.ADD_AXIS_SUBTOTAL,this.beanPath,["4006","4218","4016","4110"],[D,B,C,"1"],F);}catch(E){microstrategy.errors.log(E);}};mstrGridReport.prototype.setSubtotalSelectedUnit=function(A,D){try{var F=A.split("|");if(!F){return false;}var B=F[0];var E=F[1];this.addAction(null,mstrUpdateManager.ADD_UNIT_SUBTOTAL,this.beanPath,["4215","4218"],[E,B],D);}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.disableSubtotal=function(A,D){try{var C=A;this.addAction(null,mstrUpdateManager.DISABLE_SUB_TOTALS,this.beanPath,["4218","4110"],[C,"1"],D);}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.handleChangeStyle=function(A,C){try{this.addAction(this.elem,mstrUpdateManager.CHANGE_STYLE,this.beanPath,["4041"],[A],C);}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.setVisualizationSettings=function(K,N,M,E,P,I,C,O,D,F){try{var A=mstrUpdateManager.SET_VISUALIZATION_PROPERTIES;var H=mstrGridReport.updateNow();var L=[];var J=[];if(K){L.push("4096048");J.push(K);}var B;if(N!=null){L.push("4096049");J.push(N);B=this.getAllVisList()[N];if(B){L.push("4255");J.push((typeof (B.ip)!="undefined")?B.ip:"0");L.push("409606615");J.push((typeof (B.im)!="undefined")?B.im:"");}}if(M!=null){L.push("4096050");J.push(M);}if(E){L.push("4096051");J.push(E);}if(I!=null){L.push("409606616");J.push(I);}if(C!=null){L.push("409606617");J.push(C);}if(O!=null){L.push("409606618");J.push(O);}if(D!=null){L.push("409606619");J.push(D);}if(D!=null){L.push("409606621");J.push(F);}microstrategy.updateVisProps(K,N,M,E,this);if(mstrGridReport.isRWD()&&(B||N=="")){this.curWgtId=N==""?"":B.id;}L.push("4110");J.push(H);this.addAction(this.elem,A,this.beanPath,L,J,P);if(P){this.notifySelectionChange("onvischange");}return true;}catch(G){microstrategy.errors.log(G);return false;}};mstrGridReport.prototype.getAllVisList=function(){return(this.allVisList)?this.allVisList:this.docViewer.allVisList;};mstrGridReport.prototype.handleViewMode=function(A,D,E){try{var B=(mstrGridReport.isReport())?mstrUpdateManager.REPORT_CHANGE_VIEW_MODE:mstrUpdateManager.CHANGE_VIEW_MODE;this.addAction(this.elem,B,this.beanPath,["4115"],[A],D);}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.updateViewMode=function(A){try{var C=parseInt(A);if(this.isTemplateEmpty()&&!this.quickSwitch){this.isGrid=true;this.isGraph=false;this.isVisualization=false;}else{this.isGrid=(C==microstrategy.DISPLAY_MODE_GRID_AND_GRAPH||C==microstrategy.DISPLAY_MODE_GRID);this.isGraph=(C==microstrategy.DISPLAY_MODE_GRID_AND_GRAPH||C==microstrategy.DISPLAY_MODE_GRAPH);this.isVisualization=(C>=microstrategy.FIRST_VISUALIZATION_VIEW_MODE);}if(this.isGraph&&!this.quickSwitch){this.major=this.DEFAULT_GRAPH_MAJOR_TYPE;this.minor=this.DEFAULT_GRAPH_MINOR_TYPE;}}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.toggleSubtotals=function(){try{var B=(this.isFeatureAvailable(microstrategy.FEATURE_CHECK_SHOW_SUBTOTALS))?0:1;this.addAction(this.elem,mstrUpdateManager.TOGGLE_SUBTOTALS,this.beanPath,["4116"],[B]);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.displayThresholds=function(C,B){try{this.addAction(this.elem,mstrUpdateManager.TOGGLE_GRID_THRESHOLDS,this.beanPath,["4171"],[C],B);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.addQuickThresholds=function(T,U){try{if(U==null||U.indexOf("|")<1){return false;}var M=U.split("|");var F=M[0];var S=M[1];var H=microstrategy.servletName+"."+microstrategy.pageName+"."+S;var N=this.selections.selectedUnits;var V="";var K="";for(var R in N){if(N[R]!=null&&N[R].isMetric){if(N[R].gridTarget!=null&&N[R].gridTarget.length>0){var L=N[R].gridTarget.split(",");var P=this.gridStructureInfo.getUnitIndex(microstrategy.GRIDCELL_AXIS_METRICS,parseInt(L[0])+1);if(P!=null){V+=P+",";}var J=this.gridStructureInfo.getUnit(microstrategy.GRIDCELL_AXIS_METRICS,parseInt(L[0])+1);if(J!=null){K+=J.dssId+",";}}}}if(V.length>0){V=V.slice(0,-1);}if(K.length>0){K=K.slice(0,-1);}var I=mstrQuickThresholds[F];var G=(T)?T:[];if(I){G.push(this.um.createActionObject(this.elem,mstrUpdateManager.CLEAR_THRESHOLDS,H,["111009","111013","111018"],[V,"0","1"]));var C=I.length;for(R=0;R<C;R++){var D=I[R];var A=((C-1)==R)?1:0;var Q=null;var O=["111002","111003","111004","111005","111007","111008","111009","111010","111013"];var B=[D.formatProps,D.replaceType,D.replaceValue,D.floor,D.thresholdType,K,V,D.thresholdName,A];if(D.ceiling!=null&&D.ceiling.length>0&&D.floor!=null&&D.floor.length>0){O.splice(4,0,"111006");B.splice(4,0,D.ceiling);}else{if(D.ceiling!=null&&D.ceiling.length>0){O.splice(3,1,"111006");B.splice(3,1,D.ceiling);}else{if(D.floor!=null&&D.floor.length>0){}else{O=null;B=null;}}}if(O!=null&&B!=null){Q=this.um.createActionObject(this.elem,mstrUpdateManager.ADD_THRESHOLD,H,O,B);}if(Q!=null){G.push(Q);}}if(T==null){this.um.add(G);}this.applyAddQuickThresholds();return true;}}catch(E){microstrategy.errors.log(E);}return false;};mstrGridReport.prototype.isReportCustomSQL=function(){try{return this.isXDACustomSQLReport;}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.isReportMdxCube=function(){try{return this.isMdxCube;}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.isReportViewReport=function(){try{return this.isViewReport;}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.applyAddQuickThresholds=function(){try{this.um.flushAndSubmitChanges();}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.submitSetPropertyValueAction=function(B,A){this.addAction(this.elem,mstrUpdateManager.SET_PROPERTY_VALUES,this.beanPath,["4146"],["Template Formatting!"+B+"!"+A]);};mstrGridReport.prototype.toggleAttForms=function(){try{this.submitSetPropertyValueAction("LongNames!",this.showAttForms?0:4);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.toggleMergeHeaders=function(C){try{var B=C.substr(10,3);this.submitSetPropertyValueAction("Merge"+((B=="Col")?"Column":"")+"Cells",(this.isFeatureAvailable(microstrategy["FEATURE_CHECK_MERGE_"+B.toUpperCase()+"_HEADER"]))?0:-1);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.toggleLockHeaders=function(A){try{var E=A.substr(9,3)=="Col"?"Column":"Row",J=microstrategy.FEATURE_CHECK_LOCK_COLUMN_HEADERS,D=microstrategy.FEATURE_CHECK_LOCK_ROW_HEADERS,F=(E=="Row"?D:J),C=this.lockSet,I=this.isFeatureAvailable(F),B=I?0:-1,H;H=this.um.createActionObject(this.elem,mstrUpdateManager.SET_PROPERTY_VALUES,this.beanPath,["4146"],["Template Formatting!Lock"+E+"Headers!"+B],[]);this.um.add([H]);this.setFeature(F,!I);this.useLockset=this.isFeatureAvailable(D)||this.isFeatureAvailable(J);iframe.showWaitPage(true);if(C){C.removeQuadrants();delete this.lockSet;}this.initLockHeaders();this.resizeLockSet();this.saveEnabled=true;this.notifySelectionChange("ongridselectionschange");iframe.hideWaitPage();}catch(G){microstrategy.errors.log(G);}};mstrGridReport.prototype.oncolresize=function(F,A,E,D){try{if(F.objId==this.objId){if(F!=this&&this.isGridBone&&this.colWidths){this.colWidths.oncolresize(A,E,D);}window.setTimeout("microstrategy.bone('"+F.id+"').resizeLockSet(true)",1);var B=this.mask&&this.mask.onmaskedobjectresize();}}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.raiseColResizeEvent=function(A,C,B){this.oncolresize(this,A,C,B);};mstrGridReport.prototype.initColResize=function(A){try{this.setupColResize(A);this.nowrapHiddenColumn();}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.setupColResize=function(A){try{if(!this.gridTable||!this.isResizable){return ;}this.gridWidthInfo.useExtraColTag=A;this.colWidths=new mstrColResizeImpl(this.gridTable,"microstrategy.bone('"+this.id+"').colWidths",this);this.colWidths.syncCols();}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.nowrapHiddenColumn=function(){var D=this.gridTable;this.nowrapHidColOnGrid(D);if(this.lockSet){var B=this.lockSet.quadrants;for(var C=1;C<B.length;C++){var A=B[C]&&B[C].firstChild;if(A){this.nowrapHidColOnGrid(A);}}}};mstrGridReport.prototype.nowrapHidColOnGrid=function(A){try{var H=A.getElementsByTagName("TBODY")[0];if(!H||A.style.tableLayout!="fixed"){return ;}var L,D,G;if(!this.colWidths){if(A.childNodes[0].tagName.toUpperCase()!="COLGROUP"){return ;}var J=A.childNodes[0].childNodes;L=J.length;D=[];for(G=0;G<L;G++){D.push(parseInt(J[G].style.width,10));}}else{L=this.colWidths.colCount;D=this.colWidths.widths;}var F,M,K,I,B,C;for(G=0;G<H.rows.length;G++){M=H.rows[G];I=L-1;B=0;for(F=M.cells.length-1;F>=0;F--){K=M.cells[F];B=K.getAttribute("colspan")||1;if(B>1){C=0;for(k=0;k<B;k++){C+=D[I];I--;}if(C<=0){K.className=K.className+" nwFixedWidth0";}}else{if(D[I]<=0){K.className=K.className+" nwFixedWidth0";}I--;}}}}catch(E){microstrategy.errors.log(E);}};mstrGridReport.prototype.processGridFormattingProperties=function(O){try{var V=this.um;var J=[];var I=null;var S=mstrFormatObject;var X=this.styleName;var G=false;for(var e=0;e<O.length;e++){var F=O[e].split("|");var q=F[0];var R=F[1];var Z="",T="",c="";var B=null;var D=null;var n=this.selections.getSelectedGridTargetGridLevel();for(var N in n){var M=n[N].split(",");var Q=M[0];var Y=M[1];var a=M[2];var C=M[3];if(a==2){Y=Q;Q="0";}var L=[];var U={Name:["4042"],Size:["4045","fontSize"],Color:["4048","color"],Bold:["4043"],Italic:["4044"],Underline:["4047"],Strikeout:["4046"]};if(!!U[q]){c=mstrUpdateManager.SAVE_GRID_FONT_PROPERTIES;L=U[q];}else{var H={Horizontal:["4056"],Vertical:["4057"],TextWrap:["4058"],TextDirection:["4222"],LeftPadding:["4223"],TopPadding:["4224"],RightPadding:["4225"],BottomPadding:["4226"]};if(!!H[q]){c=mstrUpdateManager.SAVE_GRID_ALIGNMENT_PROPERTIES;L=H[q];}else{var h={TopColor:["4067","borderTopColor"],LeftColor:["4068","borderLeftColor"],BottomColor:["4069","borderBottomColor"],RightColor:["4070","borderRightColor"],TopStyle:["4061"],LeftStyle:["4062"],BottomStyle:["4063"],RightStyle:["4064"],b3dweight:["4222"],b3dstyle:["4223"]};if(!!h[q]){c=mstrUpdateManager.SAVE_GRID_BORDER_PROPERTIES;L=h[q];}else{var x={Category:["4050"],DecimalPlaces:["4051"],ThousandSeparator:["4052"],CurrencySymbol:["4053"],CurrencyPosition:["4054"],NegativeNumbers:["4111"],Format:["4055"]};if(!!x[q]){c=mstrUpdateManager.SAVE_GRID_NUMBER_PROPERTIES;L=x[q];}else{var P={FillColor:["4071"]};if(!!P[q]){c=mstrUpdateManager.SAVE_GRID_PATTERN_PROPERTIES;L=P[q];B="4224";if(!R||R==""){L[1]="backgroundColor";D="1";}else{if(R.indexOf(",")<0){L[1]="backgroundColor";D="0";}else{D="2";}}}}}}}Z=L[0];T=!L[1]?R:S.encodeValue(L[1],R);if(c!=""){var u=["4006","4007","4109","4108",Z,"4126"];var o=[Q,Y,C,a,T,X];if(Z=="4071"){u=u.concat(B);o=o.concat(D);if(R.indexOf&&R.indexOf(",")>=0){var K=this.convertGradientInfo(R);T=S.encodeValue("backgroundColor",T);o[4]=T;u=u.concat(this.gradientColorId,this.gradientAngleId,this.gradientXOffsetId,this.gradientYOffsetId);o=o.concat(K[this.gradientColorId],K[this.gradientAngleId],K[this.gradientXOffsetId],K[this.gradientYOffsetId]);}}else{if(Z=="4223"){var m=mstr.utils.Color.hex2rgb("#FFFFFF");var W=mstr.utils.Color.get3DBorderColor(m,"dark");var A=mstr.utils.Color.get3DBorderColor(m,"light");if(T!="1"){var E=A;A=W;W=E;}A=S.encodeValue("borderTopColor2",A);W=S.encodeValue("borderBottomColor2",W);u.splice(5,1,"4229","4231","4230","4232");o.splice(5,1,A,A,W,W);}}J.push(V.createActionObject(this.elem,c,this.beanPath,u,o,[],[]));X="";}}}if(J.length>0){V.add(J);if(!this.useClientSideManipulations){V.flushAndSubmitChanges();}}}catch(g){microstrategy.errors.log(g);}};mstrGridReport.prototype.processSingleFormattingProperty=function(A,E){if(this.graphSelected){if(this.processSingleFormattingPropertyGraph){this.processSingleFormattingPropertyGraph(A,E);}else{var C=microstrategy.bone(this.id+"_gb");C.graphFontStyle=this.graphFontStyle;C.selectedGraphTargetValue=this.selectedGraphTargetValue;if(C.processSingleFormattingPropertyGraph){C.processSingleFormattingPropertyGraph(A,E);}}}else{var D=true;for(var B in this.selections.selectedUnits){D=false;break;}if(D){this.setGridUnitSelections(this.gridUnitFormat,this.gridValueFormat);}this.processSingleFormattingPropertyGrid(A,E);}};mstrGridReport.prototype.processSingleFormattingPropertyGrid=function(A,G){try{var F=["4006","4007","4108","4109","4126"];var E={n:A,v:G};var D=[];if(A in this.toolbarFormatMap){E.n=this.toolbarFormatMap[A];}switch(A){case"IncreaseDecimal":case"DecreaseDecimal":case"Currency":case"IntlCurrency":case"Percent":case"Comma":if(A.indexOf("Decimal")>-1){E.n="409606611";E.v=(A.indexOf("Increase")>-1)?1:-1;}else{var B=1;if(A=="Percent"){B++;}else{if(A=="Comma"){B=B+2;}}E.n=String(409606611+B);E.v=1;}break;}this.saveGridFormattingChange(F,E,D);if(D.length>0){this.um.add(D);this.um.flushAndSubmitChanges();}}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.saveGridFormattingChange=function(K,V,Y){try{var D=[];var T="";if(V.m){var e=this.resolveGridTargetProperties(V.m);D=[[e.axis,e.position,e.unit,e.level,this.styleName]];}else{var O=this.styleName;var N=this.selections.getSelectedGridTargetGridLevel();for(var M in N){D.push(N[M].split(",").concat(O));O="";}}var I=this.getGridFormatMap();var G=I.getArgId(V.n)||V.n;var P=I.encode(V.n,V.v);if(!P&&isNaN(P)){P=V.v;}var Z={1:{i:0},2:{i:2},4:{i:1},8:{i:3}};for(var S=0,R=D.length;S<R;S++){var L=[].concat(K);var H=[].concat(D[S]);switch(V.n){case"backgroundColor":case"Gradient":T=mstrUpdateManager.SAVE_GRID_PATTERN_PROPERTIES;L=L.concat("4224");if(V.n.indexOf("Gradient")>-1||V.v.indexOf(",")>-1){H=H.concat("2");L=L.concat([4071,4225,4226,4229,4230]);H=H.concat(P);}else{H=H.concat((V.v=="transparent")?"1":"0");if(V.v=="transparent"&&V.n=="backgroundColor"){P=null;}}break;case"fontFamily":case"fontSize":case"color":case"fontWeight":case"fontStyle":case"textDecoration":case"textDecoration2":T=mstrUpdateManager.SAVE_GRID_FONT_PROPERTIES;break;case"Category":case"DecimalPlaces":case"CurrencySymbol":case"CurrencyPosition":case"NegativeNumbers":case"ThousandSeparator":case"Format":T=mstrUpdateManager.SAVE_GRID_NUMBER_PROPERTIES;break;case"GridHorizontal":case"Vertical":case"Vertical2":case"TextWrap":case"TextDirection":case"paddingLeft":case"paddingTop":case"paddingRight":case"paddingBottom":T=mstrUpdateManager.SAVE_GRID_ALIGNMENT_PROPERTIES;break;case"409606611":case"409606612":case"409606613":case"409606614":T=mstrUpdateManager.NUMBER_FORMAT;break;case"borders":case"lncolor":case"lnstyle":G=null;P=null;T=mstrUpdateManager.SAVE_GRID_BORDER_PROPERTIES;var A=4061;var a=4067;var U=this.convertSelectToUnitMemo(D[S]);var J,Q,X;var C=["Top","Left","Bottom","Right"];if(V.n=="borders"){X=V.v[0];var B=parseInt(X.v[0],10);if(B==0){J=0;}else{if(B==16){J=1;}else{J=(X.cl)?1:0;for(Q=0;Q<4;Q++){if(Z[B].i!=Q){C[Q]=null;}}}}}var W,F;for(Q=0;Q<4;Q++){if(!C[Q]){continue;}L.push(String(A+Q));L.push(String(a+Q));W=C[Q]+"Style";F=C[Q]+"Color";if(V.n=="lncolor"){H.push(this.getGridFormatValue(U,W,false));H.push(I.encode(F,V.v));this.setGridFormatValue(U,F,V.v);}else{if(V.n=="borders"){H.push(String(J));this.setGridFormatValue(U,W,J);}else{J=this.getGridFormatValue(U,W,true);if(J>0){this.setGridFormatValue(U,W,parseInt(V.v,10));H.push(V.v);}else{H.push(J);}}H.push(I.encode(F,this.getGridFormatValue(U,F,false)));}}break;default:continue;}if(G!=null&&P!=null){L.push(G);H.push(P);}var c=this.bp[T]||this.beanPath;this.packageGridFormat(Y,T,L,H,c,this.convertSelectToUnitMemo(D[S]),V.n,V.v);}}catch(E){microstrategy.errors.log(E);}};mstrGridReport.prototype.isSelectionUnit=function(A){try{return(A>=this.nonUnitCount);}catch(B){microstrategy.errors.log(B);return false;}};mstrGridReport.prototype.resolveGridTargetProperties=function(C){try{var B;var G;var D;var A=parseInt(C.format);if(this.isSelectionUnit(C.unit)){var F=this.getSelectedGridUnitByIndex(C.unit);if(F){B=Math.max(F.axis,0);G=(B==0)?F.depth-1:F.depth;D=(B==0)?2:1;}}else{B=0;G=0;D=parseInt(C.unit);switch(D){case microstrategy.GRID_BORDERS:D=2;A=6;break;case mstrGridReport.ALL_UNITS:G=-9999;D=7;break;case mstrGridReport.ROW_UNITS:B=1;D=3;break;case mstrGridReport.COL_UNITS:B=2;D=4;break;case mstrGridReport.METRIC_UNITS:G=-999;D=6;break;}}return{axis:B,position:G,unit:D,level:A};}catch(E){microstrategy.errors.log(E);return null;}};mstrGridReport.prototype.convertSelectToUnitMemo=function(B){try{var E=parseInt(B[1],10);var D={unit:-1,format:parseInt(B[3],10)};switch(E){case -9999:D.unit=mstrGridReport.ALL_UNITS;break;case -999:D.unit=mstrGridReport.METRIC_UNITS;break;case -99:D.unit=microstrategy.GRID_BORDERS;break;default:var A=parseInt(B[0],10);if(E==0&&A!=0){D.unit=(parseInt(B[2],10)==3)?mstrGridReport.ROW_UNITS:mstrGridReport.COL_UNITS;}else{if(A<1){E++;}D.unit=this.resolveGridUnitId(A,E);}break;}return D;}catch(C){microstrategy.errors.log(C);return{};}};mstrGridReport.prototype.packageGridFormat=function(H,C,B,E,A,G,F,I){try{H.push(this.um.createActionObject(this.elem,C,A||this.beanPath,B,E,[],[]));this.setGridFormatValue(G,F,I);}catch(D){microstrategy.errors.log(D);}};mstrGridReport.prototype.getCellsWithAttr=function(D,B){var A=[],C=this.elem.getElementsByTagName("table")[0];if(C){A=microstrategy.findChildrenWithAtt(C,"td",D,B)||[];}return A;};mstrGridReport.prototype.findAllCells=function(C,B,A){try{var J=[];var G=this.elem.getElementsByTagName("table")[0];var H=C.axis+","+C.depth;if(C.subtype==microstrategy.SUBOBJTYPE_METRIC){H=microstrategy.GRIDCELL_AXIS_METRICS+","+parseInt(C.depth);}var I=microstrategy.findChildrenWithAtt(G,"td",microstrategy.HTMLATTR_GRID_UNIT_POS,H)||[];if(!I||I.length==0||A){var D=((C.axis==-1)?0:C.axis)+"A"+C.depth;I=I.concat(microstrategy.findChildrenWithAtt(G,"td",microstrategy.HTMLATTR_GRIDCELL_ID,D));}for(var F in I){if(this.gridStructureInfo.getCellType(I[F])==B){J.push(I[F]);}}return J;}catch(E){microstrategy.errors.log(E);return false;}};mstrGridReport.prototype.setGridProp=function(J,D,F,L,K,H){try{var I=J+"!"+D+"!"+F;var E=this.um;var A=["4146"];var G=[I];if(H&&this.styleName&&this.styleName.length>0){A.splice(1,0,"4126");G.splice(1,0,this.styleName);}K.push(E.createActionObject(this.elem,mstrUpdateManager.SET_PROPERTY_VALUES,this.beanPath,A,G,[]));if(L&&L.length>0){var B=(F=="-1")?true:false;this.setFeature(L,B);}}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.setReportProp=function(A,F,E,D){try{var B="1!"+A+"!"+F+"!"+E;D.push(this.um.createActionObject(this.elem,mstrUpdateManager.SET_REPORT_PROPERTY_VALUES,this.beanPath,["4146"],[B],[]));}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.processGridPropertyChanges=function(H,B,N){try{if(this.selections){this.selections.clearAll(true);}if(this.getDocSelections&&this.getDocSelections()){this.getDocSelections().add(this.activeRWUnit,true,true);}var J=false;var K=function(O){return microstrategy["FEATURE_CHECK_"+O];};switch(H){case"RHS":case"CHS":case"RHM":case"CHM":case"RHL":case"CHL":case"Outline":case"AttForms":case"TitleOverlap":var E={RHS:{p:"ShowRowHeaders"},CHS:{p:"ShowColumnHeaders"},RHM:{p:"MergeCells",f:K("MERGE_ROW_HEADER")},CHM:{p:"MergeColumnCells",f:K("MERGE_COL_HEADER")},RHL:{p:"LockRowHeaders",f:K("LOCK_ROW_HEADERS")},CHL:{p:"LockColumnHeaders",f:K("LOCK_COLUMN_HEADERS")},Outline:{p:"Indented",f:K("OUTLINE_MODE")},AttForms:{p:"LongNames"},TitleOverlap:{p:"TitleOverlapViewMode"}};var C=E[H];C.f=C.f||"";this.setGridProp("Template Formatting",C.p,B,C.f,N,false);J=true;break;case"HideNullZeroValues":this.setGridProp("AnalyticalEngineProperties","HideNullZeroValues",B,"",N,false);break;case"HideNullsOrZeros":this.setGridProp("AnalyticalEngineProperties","ShowAllRows",B,"",N,false);break;case"ExecutionFullScreenMode":this.setReportProp("WebProperties","ExecutionFullScreenMode",B,N);break;case"View":this.setReportProp("Mobile","View",B,N);break;case"EnableBookStylePagebyNavigation":this.setGridProp("Mobile",H,B,"",N,false);break;case"EnableZoom":this.setReportProp("Mobile","EnableZoom",B,N);break;case"EnableCopyForGridCell":this.setReportProp("Mobile","EnableCopyForGridCell",B,N);break;case"Banding":J=true;this.handleBanding(B,N);break;case"ShowThreshold":J=true;this.displayThresholds(B,N);break;case"DrillOptions":J=true;var I=this;var D=function(P,O){I.setGridProp("GeneralTemplateProperties","Drilling"+P,O,"",N,false);};D("Options",B);var A=microstrategy.TRUE;if(B==0){A=microstrategy.FALSE;}D("EnableRWDDrilling",A);D("EnableReportDrilling",A);if(mstr.$obj("dcmmID")){mstr.$obj("dcmmID").clearMenuItems(this.objId);}break;case"assoNodesDrill":var G={assoNodesDrill:"1"}[H];this["associatedNodes"]=this["associatedNodes"]||{};this["associatedNodes"][G]=B.split(CLIPBOARD_ITEM_SEPARATOR);break;case"subtotalDisplayrowSec":case"subtotalDisplaycolSec":case"subtotalDisplaypageSec":var M={subtotalDisplayrowSec:"ROWS",subtotalDisplaycolSec:"COLUMNS",subtotalDisplaypageSec:"PAGE_BY"};this.setSubtotalDisplayOption(microstrategy["GRIDCELL_AXIS_"+M[H]],B,N);break;case"setSubtotalAxisStyle":this.setSubtotalAxisStyle(B,N);break;case"setSubtotalSelectedUnit":this.setSubtotalSelectedUnit(B,N);break;case"disableSubtotal":this.disableSubtotal(B,N);break;case"DefaultViewMode":this.setViewMedia(null,B,N);break;case"AvailableViewModes":if(B.indexOf(",")>0){var L=B.split(",");this.setViewMedia("",null,N,L[0],L[1]);}else{this.setViewMedia(B,null,N);}break;case"MakePrivate":if(B!=="0"){this.setViewMedia("",null,N,mstr.Enum.VIEWMEDIA.PRIVATE);}else{this.setViewMedia("",null,N,null,mstr.Enum.VIEWMEDIA.PRIVATE);}break;case"ControlGroupByList":this.setControlGroupByList(B,N);break;case"GraphExportOverflow":case"GraphExportOverflowSpacing":this.xgovf=B;var L=(H=="GraphExportOverflow")?"":"Spacing";this.setGridProp("GraphInfo","RepeatGraph"+L,B,"",N,false);break;case"IfRowMode":J=true;this.setGridProp("GeneralTemplateProperties","IFRowMode",B,"",N,false);break;case"IfMaxRows":J=true;this.setGridProp("GeneralTemplateProperties","IFMaxRows",B,"",N,false);break;case"IfColMode":J=true;this.setGridProp("GeneralTemplateProperties","IFColumnMode",B,"",N,false);break;case"IfMaxCols":J=true;this.setGridProp("GeneralTemplateProperties","IFMaxColumns",B,"",N,false);break;}if(J&&this.editorProperties){this.editorProperties[H]=B;}microstrategy.eventManager.notifyOrphanBones("onpropertychange");}catch(F){microstrategy.errors.log(F);}};mstrGridReport.prototype.setControlGroupByList=function(F,E){try{var A="";for(var C=0,B=F.length;C<B;C++){A+=(C>0)?"!":"";A+=F[C].dssid;}this.addAction(this.elem,mstrUpdateManager.RW_REORDER_CONTROL_GROUP_BY,this.beanPath,["2048012","2048173"],[this.objId,A],E);this.ControlGroupByList=F;}catch(D){microstrategy.errors.log(D);}};mstrGridReport.prototype.setViewMedia=function(D,F,C,E,B){try{if(D==null){D="";}if(F==null){F="";}this.addAction(this.elem,mstrUpdateManager.SET_REPORT_VIEW_MEDIA,this.beanPath,["4228","4229","4243","4244"],[D,F,E||"",B||""],C);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.hiliteObj=function(F,B,A){try{var C=F.className;var E=C.lastIndexOf(" ");if(E>-1){F.className=C.substr(0,E);}if(A.length>0){F.className+=" "+A;}if(bIsIE6){setFilter(F,"Alpha",{opacity:B*100});}else{if(bIsW3C){F.style.MozOpacity=B;}}}catch(D){microstrategy.errors.log(D);}};mstrGridReport.prototype.restoreHiliteIfCurrent=function(C){try{if(this.hiliteCell){for(var A in this.hiliteCell){if(this.hiliteCell[A]==C){this.hiliteObj(C,mstrGridReport.OPACITY_SELECTED,mstrGridReport.SELECTOR_HILITE_CLASS);return true;}}return false;}}catch(B){microstrategy.errors.log(B);}return false;};mstrGridReport.prototype.hiliteIfNotCurrent=function(A,C,B){try{if(A){var F=microstrategy.findAncestorWithTag(A,"TD");if(this.hiliteCell){for(var D in this.hiliteCell){if(this.hiliteCell[D]==F){return ;}}F.className=F.className.replace(B,"")+" "+B;}}}catch(E){microstrategy.errors.log(E);}};mstrGridReport.prototype.mouseOverSelector=function(A){try{this.hiliteIfNotCurrent(A,mstrGridReport.OPACITY_MOUSE_OVER,mstrGridReport.SELECTOR_MOUSE_OVER_CLASS);}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.mouseOutSelector=function(A){try{this.hiliteIfNotCurrent(A,mstrGridReport.OPACITY_MOUSE_OUT,mstrGridReport.SELECTOR_MOUSE_OUT_CLASS);}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.processHL=function(E,A,B,C){try{var H=[];var D;if(B){var G=B.getAttribute("peix")||B.parentNode.getAttribute("peix");H.push(this.parsePeix(G));D=this.parsePfvix(B.getAttribute("pfvix")||B.parentNode.getAttribute("pfvix"));}this.execHL(E,A,H,C,D);}catch(F){microstrategy.errors.log(F);}};mstrGridReport.prototype.executeCMHyperLink=function(C,H,K){try{var E=this.selections.getItems();var F=[];if(E!=null){var B={};for(var G=0,J=E.length;G<J;G++){var L=E[G].getAttribute("peix");if(!B[L]){B[L]=true;F.push(this.parsePeix(L));}}}var A=microstrategy.activeCXMenu;var I=this.parsePfvix(A&&A.getAttribute("pfvix"));this.execHL(C,H,F,K,I);}catch(D){microstrategy.errors.log(D);}};mstrGridReport.prototype.parsePeix=function(A){return this.parsePix(A,true);};mstrGridReport.prototype.parsePfvix=function(A){return this.parsePix(A,false);};mstrGridReport.prototype.parsePix=function(F,G){try{var E={};E.elements=[];if(F){var C=F.split("_");for(var A=0,D=C.length;A<D;A++){var B=C[A].split(":");E.elements[B[0]]=B[1];if(A==0&&G){E.currAtt=B[0];}}}return E;}catch(H){microstrategy.errors.log(H);return null;}};mstrGridReport.prototype.getElementId=function(A,E){try{if(A>=0){var D=this.attMap[A];var C;C=(D.isPageBy)?0:E.elements[A];if(C>=0){return D.elementMap[C];}}}catch(B){microstrategy.errors.log(B);}return null;};mstrGridReport.prototype.getFormId=function(A,E){try{if(A>=0){var D=this.formMap[A];var C;C=(D.isPageBy)?0:E.elements[A];if(C>=0){return D.elementMap[C];}}}catch(B){microstrategy.errors.log(B);}return null;};mstrGridReport.prototype.execHL=function(A,C,H,F,D){try{var I=this.linkMap[A][C][0];var G=I.links;var E=G[F];E=E?E:G[I.def];if(E){if(this.selections){this.selections.clearAll(true);}this[!E.url?"execDynamiclLink":"execUrlLink"](I,E,H,D);}}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.execLinkDrill=function(B,F,A,H){try{var K=this.linkMap[B][F][0];var I=K.links;var G=I[H];G=G?G:I[K.def];if(G){var J={};for(var D=0;(A!=null)&&D<A.length;D++){J[A[D].id]=A[D].ans;}if(D>0){J.nAns=A[0].ans.length;}var E=this.buildLinkXml(K,G,null,null,J);microstrategy.execDynamiclLink(G,E,K&&K.nw);}}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.getLinkMap=function(){try{return this.linkMap;}catch(A){microstrategy.errors.log(A);return null;}};mstrGridReport.prototype.execUrlLink=function(A,D,H){try{var G=null;var C=D.url;if(C.indexOf("&CurrentElement")>-1&&H){var B=H[0]?H[0]:H;var F=this.getElementId(B.currAtt,B);C=D.url.replace("&CurrentElement",F);}G=createDynamicForm(C);if(A.nw){G.target="_blank";}microstrategy.submitForm(G);return ;}catch(E){microstrategy.errors.log(E);}};mstrGridReport.prototype.execDynamiclLink=function(A,C,F,D){try{var B=this.buildLinkXml(A,C,F,D);microstrategy.execDynamiclLink(C,B,A&&A.nw);}catch(E){microstrategy.errors.log(E);}};mstrGridReport.prototype.buildLinkXml=function(c,G,J,X,H){try{var K=function(e,g){return microstrategy.addXmlAttr(e,g);};var V=function(e,g){return microstrategy.addXmlAttrEncoded(e,g);};var E="<hl"+K("mid",G.msg)+K("srct",microstrategy.EXECUTION_SCOPE)+K("aopam",G.daMode)+">";var D=G.ans;if(D!=null){E+="<prms>";for(var Y=0,W=D.length;Y<W;Y++){var R=D[Y];var O=R.pid;var P=R.aty;var Z=R.pty;var I=R.values;var N=R.dispNames;E+="<prm"+K("id",O)+K("am",P);if(R.orId){E+=K("orid",R.orId)+K("ortp",R.orTp);if(Z==mstrGridReport.CONSTANT_PROMPT_TYPE&&P==mstrGridReport.DYNAMIC&&R.bfi){E+=K("pt",Z)+K("bfi",R.bfi);}}E+=">";var C=null;var A=null;var M=null;var Q=null;switch(P){case mstrGridReport.DO_NOT_ANSWER:case mstrGridReport.CLOSE:case mstrGridReport.USE_DEFAULT_ANSWER:case mstrGridReport.SAME_PROMPT:break;case mstrGridReport.STATIC:if(I!=null){E+='<pa ia="1"><es>';for(var S=0;S<I.length;S++){E+="<e"+K("ei",I[S])+V("disp_n",N[S])+K("emt","1")+"/>";}E+="</es></pa>";}break;case mstrGridReport.DYNAMIC:case mstrGridReport.DYNAMIC_OR_SAME_PROMPT:A=R.attrs;if(A!=null&&A.length==1){M=A[0];E+='<pa ia="1">';if(Z==mstrGridReport.CONSTANT_PROMPT_TYPE&&X){Q=this.formMap[M];var B=this.getFormId(M,X);if(B){E+=mstr.utils.String.encodeXMLAttribute(mstr.utils.String.decodeHtmlString(B,false));}}else{if(H){Q=this.attMap[M];E+="<es "+K("dispForms",Q?Q.displayFormsMap:"")+">";var T=H[Q.id];for(var L=0;T&&L<T.length;L++){C=T[L];if(!C){continue;}E+="<e"+V("ei",C)+K("emt","1")+"/>";}E+="</es>";}else{if(J){Q=this.attMap[M];E+="<es "+K("dispForms",Q?Q.displayFormsMap:"")+">";for(var L=0;J!=null&&L<J.length;L++){var U=J[L];C=this.getElementId(M,U);if(!C){continue;}E+="<e"+V("ei",C)+K("emt","1")+"/>";}E+="</es>";}}}E+="</pa>";}break;case mstrGridReport.ALL_VALID_UNITS:A=R.attrs;if(A!=null&&A.length>0&&(J||H)){E+='<pa ia="1"><attGroups>';if(H){for(var L=0;L<H.nAns;L++){E+="<attGroup>";for(var a=0;a<A.length;a++){M=A[a];Q=this.attMap[M];if(!H[Q.id]){continue;}C=H[Q.id][L];if(!C){continue;}E+="<a"+K("id",Q.id)+V("n",Q.n)+"><es "+K("dispForms",Q.displayFormsMap)+"><e"+V("ei",C)+K("emt","1")+"/></es></a>";}E+="</attGroup>";}}else{for(var L=0;J!=null&&L<J.length;L++){E+="<attGroup>";var U=J[L];for(var a=0;a<A.length;a++){M=A[a];Q=this.attMap[M];C=this.getElementId(M,U);if(!C){continue;}E+="<a"+K("id",Q.id)+V("n",Q.n)+"><es "+K("dispForms",Q.displayFormsMap)+"><e"+V("ei",C)+K("emt","1")+"/></es></a>";}E+="</attGroup>";}}E+="</attGroups></pa>";}break;case mstrGridReport.CURRENT_UNIT:A=R.attrs;if(A!=null&&A.length==1&&(J||H)){M=A[0];Q=this.attMap[M];E+='<pa ia="1">';E+="<a"+K("id",Q.id)+V("n",Q.n)+">";E+="<es "+K("dispForms",Q.displayFormsMap)+">";if(H){for(var L=0;H[Q.id]&&L<H[Q.id].length;L++){C=H[Q.id][L];if(C){E+="<e"+V("ei",C)+K("emt","1")+"/>";}}}else{for(var L=0;L<J.length;L++){C=this.getElementId(M,J[L]);if(C){E+="<e"+V("ei",C)+K("emt","1")+"/>";}}}E+="</es>";E+="</a></pa>";}break;}E+="</prm>";}E+="</prms>";}E+="</hl>";return E;}catch(F){microstrategy.errors.log(F);return null;}};mstrGridReport.prototype.applySelector=function(G,K,I,B,A,E,H,J){try{this.hiliteControlElem(H,K);var F=this.controlLinks&&this.controlLinks[G];if(F){B=this.getVisibleTargets(F);}var D=F&&F.dsTargets&&F.dsTargets.length>0;var A=D?"0":A;this.addAction(null,mstrUpdateManager.SET_CUR_CTL_ELEMENTS,this.docViewer.beanPath,["2048130","2048127","2048137","2048138","2048018"],[K,I,E,A,"false"],J);}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.hiliteControlElem=function(A,B){try{var E=this.hiliteCell;if(E[B]){this.hiliteObj(E[B],mstrGridReport.OPACITY_MOUSE_OUT,mstrGridReport.SELECTOR_MOUSE_OUT_CLASS);if(E.filter){E[B].style.filter=E.filter;}}if(A){var D=microstrategy.findAncestorWithTag(A,"TD");if(D){E[B]=D;E.filter=getFilter(D);this.hiliteObj(D,mstrGridReport.OPACITY_SELECTED,mstrGridReport.SELECTOR_HILITE_CLASS);}}}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.getVisibleTargets=function(B){try{var F="";if(B.gbTargets){B.targets=[];if(this.docViewer.targetGroupBys){for(var D=0,C=B.gbTargets.length;D<C;++D){var A=this.docViewer.targetGroupBys[B.gbTargets[D]];if(A){B.targets.push(A);}}}delete B.gbTargets;}if(B.targets){for(var D=0,C=B.targets.length;D<C;++D){if(mstrDocImpl.shallRenderTarget(B.targets[D])){if(D>0){F+=CLIPBOARD_ITEM_SEPARATOR;}F+=B.targets[D];}}}return F;}catch(E){microstrategy.errors.log(E);return null;}};mstrGridReport.prototype.sliceMetric=function(B,D){try{var C=this.controlLinks&&this.controlLinks.Metrics;if(!C){return ;}var E=C.ck;this.hiliteControlElem(B,E);var A=this.getVisibleTargets(C);this.addAction(null,mstrUpdateManager.SET_CUR_CTL_ELEMENTS,this.docViewer.beanPath,["2048130","2048127","2048137","2048138"],[E,D,C.ctxt,C.partialUpdate],null,!A);}catch(F){microstrategy.errors.log(F);}};mstrGridReport.prototype.sliceElem=function(L,C,Q,I,B){try{var H=this.gridStructureInfo.getUnit(parseInt(C),parseInt(Q));if(H!=null){var M=this.controlLinks&&this.controlLinks[H.dssId];if(!M){return ;}var D=M.ck;this.hiliteControlElem(L,D);if(I>=0){var J=this.attMap[I];if(B>=0){var R=J.elementMap[B];var O=this.getVisibleTargets(M);var A=O||(!M.partialUpdate)?"1":"0";var N=[];var E=microstrategy.bone("pbb_GroupByStyle");var G=E&&E.hasAllSelected;var P=M.dsTargets&&M.dsTargets.length>0;var K=G||P?"0":M.partialUpdate;this.addAction(null,mstrUpdateManager.SET_CUR_CTL_ELEMENTS,this.docViewer.beanPath,["2048130","2048127","2048137","2048138","2048018"],[D,R,M.ctxt,K,A],N);this.um.add(N);if(A){this.um.flushAndSubmitChanges();}}}}}catch(F){microstrategy.errors.log(F);}};mstrGridReport.prototype.processGraphFormattingProperties=function(I){try{var Q=this.um;var o=[];for(var c=0,a=I.length;c<a;c++){var R=I[c];var C=null;var S=null;var E=[];var B=[];var n=R[0];var D=null;var G=null;var Z,A;function M(q){var m=q[0].split("_");E.push("4085");B.push(m[0]);if(m[1]){E.unshift("4209");B.unshift(m[1]);}G=m[0];}var g=null;var L=function(q,x){E.push("4202");B.push(q);E.push("4203");if(x){g=x;}};switch(n){case"formatGraphSetting":S=mstrUpdateManager.EDIT_GRAPH_PROPS;C=R[1];E.push("4085");B.push(C[0]);E.push("4202");B.push(C[1]);E.push("4203");B.push(C[2]);break;case"formatGraphPropertyBulk":case"formatGraphWindowSizeBulk":S=mstrUpdateManager.EDIT_GRAPH_PROPS;if(n=="formatGraphWindowSizeBulk"){S=mstrUpdateManager.EDIT_GRAPH_WINDOW_SIZE;}C=R[1];for(Z=0,A=C.length;Z<A;Z++){var P=C[Z];switch(P[0]){case"major":E.push("4082");this.major=P[1];break;case"minor":E.push("4083");this.minor=P[1];break;case"seriesLayout":E.push("4175");this.seriesLayout=P[1];break;case"showSubtotals":E.push("4176");break;case"useCurvedLines":case"roundedEffect":case"useFontAntiAliasing":var W={useCurvedLines:"804",roundedEffect:"10123",useFontAntiAliasing:"881"}[P[0]];E.push("4085");B.push("9999");E.push("4202");B.push(W);E.push("4203");break;case"categories":E.push("4025");this.categories=P[1];break;case"series":E.push("4024");this.series=P[1];break;}if(E.length>B.length){B.push(P[1]);}if(S!=null){o.push(Q.createActionObject(this.elem,S,this.beanPath,E,B,[],[]));B=[];E=[];}}S=null;break;case"formatGraphObjectBulk":S=mstrUpdateManager.EDIT_GRAPH_TEXT_PROPS;C=R[1];M(C);C=C[1];for(Z=0;Z<C.length;Z++){switch(C[Z][0]){case"titleShow":E.push("4084");break;case"titleColor":E.push("4087");break;case"titleFillColor":E.push("4211");break;case"titleName":E.push("4088");break;case"titleStyle":E.push("4089");break;case"titleSize":E.push("4090");break;case"titleContent":E.push("4091");break;case"relativeSize":E.push("4202");B.push("604");E.push("4203");if(C[Z][1]=="1"){C[Z][1]=C[Z][1]+","+this.graphWidth+","+this.graphHeight;}break;case"titlePosition":E.push("4202");B.push("644");E.push("4203");break;case"tooltipsShow":E.push("4202");if(D){B.push("10004");}else{B.push("10041");}E.push("4203");break;case"tooltipsEditor":E.push("4202");if(D){B.push("10005");}else{B.push("10042");}E.push("4203");break;}if(E.length>B.length){B.push(C[Z][1]);}}break;case"saveGraphProperties":var V=255;S=mstrUpdateManager.EDIT_GRAPH_PROPS;C=R[1];M(C);C=C[1];for(Z=0;Z<C.length;Z++){var P=C[Z];switch(P[0]){case"titleGradient":case"titleColorFillEffect":case"titleFillEffect":case"titleTransparency":case"titleContent":var W={titleGradient:"567",titleColorFillEffect:"10002",titleFillEffect:"4203",titleTransparency:"608"}[P[0]]||"9999";L(W);break;case"titleFillColor":case"titleLineColor":case"titleColor":var U={titleFillColor:["564","608"],titleLineColor:["588","609"],titleColor:["574","610"]}[P[0]];if(D&&G=="286"&&P[0]=="titleFillColor"){B.push("556");}L(U[0],U[1]);break;}if(E.length>B.length){B.push(P[1]);}if((P[0]=="titleFillColor"||P[0]=="titleLineColor"||P[0]=="titleColor")&&(P[1]=="-1"||P[1]=="transparent")){V=0;S=null;}if(g){if(!D){D="-1";}o.push(Q.createActionObject(this.currentArea,mstrUpdateManager.EDIT_GRAPH_PROPS,this.beanPath,["4085","4209","4202","4203"],[G,D,g,V]));}}break;case"formatGraphNumberBulk":S=mstrUpdateManager.EDIT_GRAPH_PROPS;C=R[1];if(!C||C.length==0){return false;}G=C[0];attributeId="-616";if(G.indexOf("_")>0){M(C);}else{switch(G){case"272":case"290":attributeId="618";break;case"531":case"558":case"296":attributeId="619";break;case"302":attributeId="620";break;case"512":case"552":attributeId="621";break;case"10002":attributeId="10077";break;}G=G=="10002"?G:"9999";E.push("4085");B.push(G);}var K,O,u,Y,T,N,h,e;for(Z=1;Z<C.length;Z++){var W=C[Z].split("|");var U=W[1];switch(W[0]){case"Category":K=U+",";break;case"DecimalPlaces":O=U+",";break;case"ThousandSeparator":var J=(U>0)?"3":"0";u=J+",";break;case"CurrencySymbol":T=U+",";break;case"CurrencyPosition":N=U+",";break;case"NegativeNumbers":h=U+",";break;case"Format":e=U;break;}}E.push("4202");B.push(attributeId);E.push("4203");B.push(K+O+u+N+h+T+e);break;case"formatGraphColorGradient":S=mstrUpdateManager.EDIT_GRAPH_PROPS;C=R[1];M(C);C=C[1];for(Z=0;Z<C.length;Z++){var P=C[Z];if(P[0]=="titleGradient"){L("567");}else{L("10002");}if(E.length>B.length){B.push(C[Z][1]);}}break;case"formatGraphDualAxis":S=mstrUpdateManager.EDIT_GRAPH_PROPS;C=R[1];M(C);B[B.length-1]="9999";var F=C[1];if(F[0]=="titleSeriesOnAxis"){L("140");}else{L("10054");}if(E.length>B.length){B.push(F[1]);}break;case"formatGraphAxisBulk":S=mstrUpdateManager.EDIT_GRAPH_AXIS_PROPS;C=R[1];var X={gShow_318:"4096",gShow_325:"4099",gShow_117:"4092",gShow_321:"4097",gShow_127:"4093",gShow_128:"4094",gShow_129:"4095",gScale_127:"4104",gScale_129:"4106",gStep_321:"4101",gStep_128:"4101",gStep_127:"4100",gStep_129:"4102"};for(Z=0;Z<C.length;Z++){var P=C[Z];E.push(X[P[0]]||"4105");if(E.length>B.length){B.push(C[Z][1]);}}break;case"formatTemplateObjectBulk":C=R[1];for(Z=0;Z<C.length;Z++){if(C[Z][0]=="showMetrics"){S=mstrUpdateManager.SET_PROPERTY_VALUES;E=["4146"];B=["Template Formatting!ShowMetricObjectInGraphZone!"+C[Z][1]];}}break;}if(S!=null){o.push(Q.createActionObject(this.elem,S,this.beanPath,E,B,[],[]));}}if(o.length>0){Q.add(o);if(!this.useClientSideManipulations){Q.flushAndSubmitChanges();}else{this.notifySelectionChange("ongridselectionchange");}}}catch(H){microstrategy.errors.log(H);}return null;};mstrGridReport.prototype.setDsetId=function(B){try{this.dSetId=(this.gridStructureInfo&&this.gridStructureInfo.hasNoUnits)?null:B;}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.openDialog=function(F,B,E,C,A){try{microstrategy.openDialog(F,B,E,C,A);}catch(D){microstrategy.errors.log(D);}};mstrGridReport.prototype.convertToDoc=function(E,A){try{var C=[];if(!E){var D;if(this.isGraph&&this.isGrid){D=microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;}else{if(this.isGraph){D=microstrategy.DISPLAY_MODE_GRAPH;}else{if(this.isGrid){D=microstrategy.DISPLAY_MODE_GRID;}}}this.addAction(this.elem,mstrUpdateManager.EXECUTE_RWDOC,microstrategy.servletName,["2048001","2048002","2048092","2048143","2048009","4115"],[this.reportID,this.messageID,microstrategy.RWD_EXECUTION_MODE_DATA,this.stateID,this.objTypeReport,D],C);var F="currentViewMedia="+microstrategy.RW_VIEW_MODE_EDITABLE;this.um.addURL(F);}else{if(A){this.addAction(this.elem,mstrUpdateManager.CONVERT_TO_DOCUMENT,microstrategy.servletName,["3001","3010","3115","2048143","3007","3158","3163","3017"],[this.reportID,this.messageID,microstrategy.RWD_EXECUTION_MODE_DATA,this.stateID,this.objTypeReport,microstrategy.RW_VIEW_MODE_VIEWANALYSIS,microstrategy.RWD_EASE_CREATION_ANALYSIS,microstrategy.APP_BEAN_VIEW_EXECUTION],C);}else{if(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8){showMessage({contents:mstrGridReport.desp(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return ;}else{this.addAction(this.elem,mstrUpdateManager.CREATE_HTML5_VI,microstrategy.servletName,["3001","3010","3115","3007","3163"],[this.reportID,this.messageID,microstrategy.RWD_EXECUTION_MODE_DATA,this.objTypeReport,microstrategy.RWD_EASE_CREATION_HTML5_DASHBOARD_WITH_TEMPLATE],C);}}}this.um.add(C);this.um.useIframe=false;this.um.flushAndSubmitChanges();}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.saveReport=function(){try{var H=document.getElementById("askBeforeSaveCheckbox");if(H&&H.checked){this.commands.exec("forceSaveAs");}var G=[],D=[],B=[];var A=this.saveCmdId,E=7;if(A){switch(A){case"createIVEFromRpt":E=15;break;case"createHTML5IVEFromRpt":if(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8){showMessage({contents:mstrGridReport.desp(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return ;}E=16;break;default:E=7;}delete this.saveCmdId;}var C=this.getSaveFolderId();if(mstrGridReport.isViewMode()){D=["3013","3031","3017"];B=[false,E,"false"];if(C&&!(A)){D.splice(1,0,"3014");B.splice(1,1,C,C);}else{D.push("3014");B.push(C);}}else{D=["3013","3017"];B=["1","true"];this.addAction(this.elem,mstrUpdateManager.DESIGN_MODE_PROCESS,this.beanPath,["6032","6018"],["1","1"],G);if(C){D.push("3014");B.push(C);}}this.addAction(this.elem,mstrUpdateManager.SAVE_GRID,microstrategy.servletName,D,B,G);this.um.useIframe=false;this.um.add(G);this.um.flushAndSubmitChanges();}catch(F){microstrategy.errors.log(F);}};mstrGridReport.prototype.save=function(){try{if(this.isNew||this.isReadonly||this.isDrilled||this.needSaveAs){return this.saveReport();}else{this.um.add([this.um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.beanPath,[],[],[],null)]);this.um.add([this.um.createActionObject(null,mstrUpdateManager.SAVE_OBJECT,this.beanPath,["89001"],["0"],[],null)]);this.um.flushAndSubmitChanges();}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.submitSave=function(){try{var B=document.getElementById("askBeforeSaveCheckbox");if(B&&B.checked&&this.isFeatureAvailable(microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES)){this.commands.exec("dontAskAgain");}this.um.add([this.um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.beanPath,[],[],[],null)]);this.um.add([this.um.createActionObject(null,mstrUpdateManager.SAVE_OBJECT,this.beanPath,["89001"],["0"],[],null)]);this.um.flushAndSubmitChanges();}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.getSaveFolderId=function(){try{if(this.saveFolderId){return this.saveFolderId;}else{return this.parentFolderID;}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.addAllLevel=function(C,D){var A=["UNIT_HEADER","UNIT_VALUE","SUBTOTAL_HEADER","SUBTOTAL_VALUE"];for(var B in A){C.addToSelectedUnits(null,D,microstrategy["GRIDCELLTYPE_"+B],true);}};mstrGridReport.prototype.selectAxis=function(D,F){try{if(F==null||F=="none"){return false;}var C=this.selections;if(D!=null&&D.size()>0){for(var B in D.units){var A=D.units[B].src;if(A==null){continue;}if(F==microstrategy.GRIDCELLTYPE_LEVEL_ALL){mstrGridReport.addAllLevel(C,A);}else{C.addToSelectedUnits(null,A,F,true);}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrGridReport.prototype.getGridUnitItems=function(){try{var A=[];var F=this.gridStructureInfo;var G=[F.rowAxis.units,F.colAxis.units,F.metricAxis.units];for(var D=0;D<3;D++){for(var B=0,C=G[D].length;B<C;B++){if(!G[D][B].isMetricTemplateUnit){A.push(G[D][B]);}}}return A;}catch(E){microstrategy.errors.log(E);return null;}};mstrGridReport.prototype.getGridUnitSelectorItems=function(D){try{var E=this.nonUnitCount;var F=[];var G=this.getGridUnitItems();var H=0;for(var C=0,A=G.length;C<A;C++){var J=G[C],I;if(D&&J.dssType!=microstrategy.DSSTYPE_METRIC){E++;continue;}if(!!J.dssType){F[H++]=I={dssid:E++,n:G[C].alias,tp:G[C].dssType,cssClass:"ToolbarList U"+G[C].dssType};if(J.dssSubtype==3076){I.cssClass+="R";}}else{E++;}}return F;}catch(B){microstrategy.errors.log(B);return null;}};mstrGridReport.prototype.getSelectedGridUnitByIndex=function(B){try{var A=this.getGridUnitItems();return A[B-this.nonUnitCount];}catch(C){microstrategy.errors.log(C);}return null;};mstrGridReport.prototype.getGridFormats=function(){try{return this.gridFormat||{};}catch(A){microstrategy.errors.log(A);return{};}};mstrGridReport.prototype.getGridFormatMap=function(){try{if(!this.formatMap){this.formatMap={unitMap:{},valueMap:{1:"h",2:"v",3:"sn",4:"sv",5:"a"},fontFamily:{n:"ff",id:"4042"},fontWeight:{n:"fw",id:"4043"},fontStyle:{n:"fs",id:"4044"},fontSize:{n:"fz",id:"4045"},textDecoration2:{n:"ft",id:"4046"},textDecoration:{n:"fu",id:"4047"},color:{n:"c",id:"4048"},textAlign:{n:"hz",id:"4056"},textAlign2:{n:"hz",id:"4056"},GridHorizontal:{n:"hz",id:"4056"},verticalAlign:{n:"vt",id:"4057"},Vertical:{n:"vt",id:"4057"},Vertical2:{n:"vt",id:"4057"},whiteSpace:{n:"tw",id:"4058"},TextWrap:{n:"tw",id:"4058"},TextDirection:{n:"td",id:"4222"},paddingLeft:{n:"lp",id:"4223"},paddingTop:{n:"tp",id:"4224"},paddingRight:{n:"rp",id:"4225"},paddingBottom:{n:"bp",id:"4226"},Category:{n:"nct",id:"4050"},DecimalPlaces:{n:"ndp",id:"4051"},ThousandSeparator:{n:"nth",id:"4052"},CurrencySymbol:{n:"ncs",id:"4053"},CurrencyPosition:{n:"ncp",id:"4054"},NegativeNumbers:{n:"nnn",id:"4111"},Format:{n:"nfs",id:"4055"},propBorderStyle:{n:"bd",id:""},TopStyle:{n:"bts",id:"4061"},LeftStyle:{n:"bls",id:"4062"},BottomStyle:{n:"bbs",id:"4063"},RightStyle:{n:"brs",id:"4064"},TopColor:{n:"btc",id:"4067"},LeftColor:{n:"blc",id:"4068"},BottomColor:{n:"bbc",id:"4069"},RightColor:{n:"brc",id:"4070"},fillStyle:{n:"fty",id:"4224"},backgroundColor:{n:"bg",id:"4071"},gradientcolor:{n:"gr",id:["4071","4225","4226","4229","4230"]},Gradient:{n:"gr",id:["4071","4225","4226","4229","4230"]}};this.formatMap.unitMap[microstrategy.GRID_BORDERS]="gb";this.formatMap.unitMap[mstrGridReport.ALL_UNITS]="agc";this.formatMap.unitMap[mstrGridReport.ROW_UNITS]="ra";this.formatMap.unitMap[mstrGridReport.COL_UNITS]="ca";this.formatMap.unitMap[mstrGridReport.METRIC_UNITS]="am";this.formatMap.getName=function(B){return(this[B]&&this[B]["n"])||B;};this.formatMap.getArgId=function(B){return(this[B]&&this[B]["id"])||null;};this.formatMap.decode=function(C,B){switch(C){case"fontWeight":return(B==-2)?"default":(B==microstrategy.TRUE?"bold":"");case"fontStyle":return(B==-2)?"default":(B==microstrategy.TRUE?"italic":"");case"textDecoration":return(B)?"underline":"";case"textDecoration2":return(B)?"line-through":"";case"whiteSpace":return(B)?"normal":"nowrap";}return B;};this.formatMap.encode=function(E,B){var D=mstrFormatObject;switch(E){case"textDecoration":case"textDecoration2":case"TextWrap":return(B)?microstrategy.TRUE:microstrategy.FALSE;case"color":case"TopColor":case"LeftColor":case"BottomColor":case"RightColor":return(B=="transparent")?0:D.encodeValue("color",B);case"backgroundColor":case"Gradient":if(B.indexOf(",")==-1){return(B=="transparent")?0:D.encodeValue("color",B);}var C=B.split(",");return[D.encodeValue("color","#"+C[gradientUtil.GRADIENT_START_COLOR_INDEX]),D.encodeValue("color","#"+C[gradientUtil.GRADIENT_END_COLOR_INDEX]),C[gradientUtil.GRADIENT_ANGLE_INDEX],C[gradientUtil.GRADIENT_XOFFSET_INDEX],C[gradientUtil.GRADIENT_YOFFSET_INDEX]];}return B;};}return this.formatMap;}catch(A){microstrategy.errors.log(A);return null;}};mstrGridReport.prototype.getGridFormatNode=function(G,H){try{var C=this.getGridFormats();if(!C){return null;}var B=this.getGridFormatMap();var D;if(G.unit>mstrGridReport.METRIC_UNITS){var F=C.u[G.unit-mstrGridReport.METRIC_UNITS-1];D=F?F[B.valueMap[G.format]]:null;}else{var A=C[B.unitMap[G.unit]];if(G.unit==microstrategy.GRID_BORDERS){D=A;D.defaultsApplied=true;}else{if(A){D=A[B.valueMap[G.format]];}}}if(!D||!D.defaultsApplied){D=mstr.utils.Hash.applydefault(D,C.de);D.defaultsApplied=true;}return D;}catch(E){microstrategy.errors.log(E);return null;}};mstrGridReport.prototype.getGridFormatValue=function(E,H,F){try{if((E.unit==-1&&E.format==-1)||(E.unit==0)){return"";}var A=this.getGridFormatMap();var G=A.getName(H);var D=this.getGridFormatNode(E);if(!D){return"";}var B="";if(H=="borders"){B=microstrategy.resolveBorderFlags(this.checkBorders(A,D),true);}else{if((G in D)&&H=="propBorderStyle"){B=this.checkBorderStyle(A,D);}else{B=(G in D)?D[G]:"";}}if(H=="backgroundColor"){B=D.fty==1?"transparent":B;}if(F){B=A.decode(H,B);}return isNaN(B)?B||"":B;}catch(C){microstrategy.errors.log(C);return"";}};mstrGridReport.prototype.checkBorderStyle=function(D,E){var A=0;var B=function(F){return E[D.getName(F)];};try{if(B("propBorderStyle")==0){return 0;}if(B("TopStyle")!=0&&B("BottomStyle")!=0&&B("LeftStyle")!=0&&B("RightStyle")!=0){return B("propBorderStyle");}else{return 0;}}catch(C){microstrategy.errors.log(C);}return A;};mstrGridReport.prototype.checkBorders=function(D,E){var A=0;var B=function(F){return E[D.getName(F)];};try{if(B("propBorderStyle")==0){return 0;}if(B("propBorderStyle")==1){return 31;}if(B("TopStyle")!=0){A+=1;}if(B("BottomStyle")!=0){A+=2;}if(B("LeftStyle")!=0){A+=4;}if(B("RightStyle")!=0){A+=8;}A=(A==15)?31:A;}catch(C){microstrategy.errors.log(C);}return A;};mstrGridReport.prototype.setGridFormatValue=function(F,H,E,D){try{var A=this.getGridFormatMap();var G=A.getName(H);var C=this.getGridFormatNode(F);if(C&&C[G]!=E){C[G]=E;}}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.updateSelected=function(Q,A,B){try{if(A==null||A=="none"){return ;}var M=Q.split(",");var C=M[0];var F=M[1];var I=M[2];var R=F;this.positionForGradient=F;if(B){C="0";R=parseInt(F,10)+1;}this.selectedAxis=C;this.selectedPosition=F;this.selectedUnit=I;this.selectedLevel=A;this.gridValueFormat=A;var D=false;var N=this.gridStructureInfo;if(!D){this.selections.clearSelectionsFromOtherPages();}var G=this;var H=function(S){G.selectAxis(S,A);};switch(Q){case"0,-9999,7":this.gridUnitFormat=mstrGridReport.ALL_UNITS;if(D){H(N.rowAxis);H(N.colAxis);H(N.metricAxis);}break;case"1,0,3":this.gridUnitFormat=mstrGridReport.ROW_UNITS;if(D){H(N.rowAxis);}break;case"2,0,4":this.gridUnitFormat=mstrGridReport.COL_UNITS;if(D){H(N.colAxis);}break;case"0,-999,6":this.gridUnitFormat=mstrGridReport.METRIC_UNITS;if(D){H(N.metricAxis);}break;case"0,-9,7":this.gridUnitFormat=microstrategy.GRID_UNIT_CONTAINER;this.gridValueFormat=0;break;case"0,-99,7":this.gridUnitFormat=microstrategy.GRID_BORDERS;this.gridValueFormat=0;break;default:I=N.getUnit(this.selectedAxis,R,this.selectedUnit);var L=(I!=null)?I.src:null;if(L==null){break;}var J=Q.split(",");var P=parseInt(J[0]);var K=parseInt(J[1]);var O=(K==-1||P<1);this.gridUnitFormat=this.resolveGridUnitId((O==true?-1:P),(O==true?K+1:K));if(this.selectedLevel==microstrategy.GRIDCELLTYPE_LEVEL_ALL){this.gridValueFormat=this.selectedLevel;if(D){mstrGridReport.addAllLevel(this.selections,L);}}else{this.gridValueFormat=this.selectedLevel;if(D){this.selections.addToSelectedUnits(null,L,this.selectedLevel,true);}}break;}this.notifySelectionChange("ongridselectionschange");}catch(E){microstrategy.errors.log(E);}};mstrGridReport.prototype.resolveGridUnitId=function(E,H){try{var G=this.gridStructureInfo;var A=(E<1);if(A){E=G.metricsAxis;}var B=mstrGridReport.METRIC_UNITS;if(A||(E!=G.metricsAxis||H!=G.metricsDepth)){var D=false;if(A){B+=G.rowAxis.size();B+=G.colAxis.size();D=(G.metricsAxis!=microstrategy.GRIDCELL_AXIS_PAGE_BY);}else{var C=function(L){var K=G.hasMetrics&&G.metricsAxis==microstrategy.GRIDCELL_AXIS_ROWS;var J=G.metricsDepth<H;var I=G.metricsAxis==microstrategy.GRIDCELL_AXIS_COLUMNS;if(L){return(K||(J&&I));}else{return(K&&J);}};switch(E){case microstrategy.GRIDCELL_AXIS_ROWS:D=C();break;case microstrategy.GRIDCELL_AXIS_COLUMNS:B+=G.rowAxis.size();D=C(true);break;}}B+=H;if(D){B-=1;}}return B;}catch(F){microstrategy.errors.log(F);return mstrGridReport.METRIC_UNITS;}};mstrGridReport.prototype.resetSelections=function(){try{var A=["Axis","Level","Position","Unit"];for(var B in A){this["selected"+A[B]]=null;}}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.setGridUnitSelections=function(E,F){try{this.gridUnitFormat=E;this.gridValueFormat=F;if(!this.selections){return ;}var B=this.resolveGridTargetProperties({unit:this.gridUnitFormat,format:this.gridValueFormat});this.selections.clearAll(true);if(E<mstrGridReport.ALL_UNITS){return ;}var A=false;if(E>=this.nonUnitCount){var D=this.getGridUnitSelectorItems()[E-this.nonUnitCount];A=!!(D&&D.tp==microstrategy.DSSTYPE_METRIC);}this.updateSelected(B.axis+","+B.position+","+B.unit,B.level,A);}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.resetGridUnitSelections=function(){this.gridUnitFormat=mstrGridReport.ALL_UNITS;this.gridValueFormat=2;};mstrGridReport.prototype.notifySelectionChange=function(A){try{if(this.observer){this.observer.notifyAll(A);}}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.getSelectedUnit=function(){var D=null;if(this.selections&&this.selections.getSelectedGridTarget){var B=this.selections.getSelectedGridTarget();if(B&&B.length>0){var A=B.split(",");if(A!=null&&A.length>=2){var C=A[0];var F=A[1];var E=A[2];D=this.gridStructureInfo.getUnit(C,F,E);}}}return D;};mstrGridReport.prototype.addCalculationQuickGroup=function(Q){try{var H="";var I="";var B="";var N=null;var J="";var F="";var L="";var A="";if(this.selections&&this.selections.getSelectedGridTarget){var E=this.selections.getSelectedGridTarget();if(E&&E.length>0){var O=E.split(",");if(O!=null&&O.length>=2){F=O[0];I=O[1];B=O[2];N=this.gridStructureInfo.getUnit(F,I,B);if(N!=null){if(N.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){N=this.gridStructureInfo.findUnit(N.parentDssId);}J=N.dssId;L=N.alias;if(N.src){I=parseInt(N.src.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH));}else{if(N.depth){I=N.depth;}}}}}}var K=[];var D=this.selections.getSelectedElementsOrdinals(K);var C=mstrGridReport.desp("5207");var P=mstrGridReport.desp("5422");var M=function(R){return"["+L+"] "+mstrGridReport.desp(R)+" ";};switch(Q){case"deSum":H=M("2131");A=134;break;case"deAvg":H=M("2122");A=135;break;case"deMin":H=M("5416");A=116;break;case"deMax":H=M("5417");A=115;break;case"deMinus":H=K.join(" - ");A=2;break;case"deDivide":H=K.join(" / ");A=4;break;case"deList":P=mstrGridReport.desp("6177");break;}this.getNewListName(Q,J,I,D.join(","),A,C,P);}catch(G){microstrategy.errors.log(G);}};mstrGridReport.prototype.submitQuickGroupEvent=function(J,F,H,G,D,A){try{if(this.selections){this.selections.clearAll(true);}var B=["4233","4234","4235","4236"];var I=[F,H,G,D];if(this.sliceID){B.push("4254");I.push(this.sliceID);}var C=mstrUpdateManager.DE_ADD_QUICK_LIST;if(J!="deList"){B.splice(4,0,"4237");I.splice(4,0,A);C=mstrUpdateManager.DE_ADD_QUICK_CALCULATION;}this.addAction(this.elem,C,this.beanPath,B,I);}catch(E){microstrategy.errors.log(E);}};mstrGridReport.prototype.getNewListName=function(L,G,F,B,A,C,K){try{var I="<label for='gname' id='glabel'> "+C+" </label>";var E="onpropertychange";if(!bIsIE4){E="oninput";}var J="<input name='gname' id='gname' type='text' size='35' value='"+K+"' "+E+"= \"var gnamev = document.getElementById('gname').value;if((!gnamev) || gnamev.replace(/^\\s+/g,'').length <= 0){microstrategy.bones['msgBox'].okButton.disabled = true ;}else{ microstrategy.bones['msgBox'].okButton.disabled = false ;}\"/> ";var H=mstrGridReport.desp(A?"5415":"5414");showMessage({contents:"<div style='overflow:auto'>"+I+J+"</div>",elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bones['"+this.id+"'].submitQuickGroupEvent('"+L+"', document.getElementById('gname').value || '"+K+"','"+G+"', "+F+", '"+B+"', '"+A+"')",title:H});}catch(D){microstrategy.errors.log(D);}};mstrGridReport.prototype.getUnitInfo=function(B){try{return this.gridStructureInfo.getGridUnitInfo(B);}catch(A){microstrategy.errors.log(A);return null;}};mstrGridReport.prototype.getItemFormats=function(){try{return this.itemFormats;}catch(A){microstrategy.errors.log(A);return false;}};mstrGridReport.prototype.getAttValue=function(C,A){try{if(C==mstrGridReport.FMT_TYPE_TITLE&&this.titleBarObj){var D=microstrategy.styleObj.formattingAttributes[this.titleBarObj.getAttribute("id")];if(D!=null&&typeof (D[A])!="undefined"){return D[A];}return this.titleBarObj.getAttribute(A,0);}}catch(B){microstrategy.errors.log(B);}return null;};mstrGridReport.prototype.getFormatValue=function(B,C){try{if(!this.itemFormats){return null;}if(C=="gradientcolor"&&B==mstrGridReport.FMT_TYPE_TITLE){return(this.titleBarObj)?this.titleBarObj.getAttribute(C):null;}if(B==microstrategy.FORMAT_TYPE_CONTROL_TITLE){B=microstrategy.FORMAT_TYPE_TITLE;}return this.itemFormats[B][C];}catch(A){microstrategy.errors.log(A);return null;}};mstrGridReport.prototype.setAttValue=function(E,B,D){try{this.itemFormats[E][B]=D;if(E==mstrGridReport.FMT_TYPE_TITLE){if(this.titleBarObj){var G=this.titleBarObj.getAttribute("id");var F=microstrategy.styleObj.formattingAttributes[G];if(typeof (F)=="undefined"){F=microstrategy.styleObj.formattingAttributes[G]={};}F[B]=D;var A=mstrGridReport.heightAndWidthAttMap[B];this.titleBarObj.style[A]=microstrategy.getFormatObject().decodeValue(A,D);}}}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.setFormatValue=function(E,G,D,C){try{if(typeof (E)=="object"&&"unit" in E){this.setGridFormatValue(E,G,D);}else{if(this.itemFormats){this.itemFormats[E][G]=D;if(E==mstrGridReport.FMT_TYPE_TITLE){if(G=="Gradient"){return ;}if(this.titleBarObj){var B=this.titleBarObj;var F=G&&G.toLowerCase();if(F=="textdecoration"||F=="textdecoration2"||F=="textalign"){B=microstrategy.findChildWithAtt(this.titleBarObj,"div","id","titleBar");}microstrategy.bone("rwb_viewer").doc.styleObj.formatElem(B,G,D);if(G&&G.toLowerCase()=="backgroundcolor"){this.titleBarObj.setAttribute("bgstyle",(D=="transparent")?1:0);if(this.titleBarObj.getAttribute("gradientcolor")){this.titleBarObj.removeAttribute("gradientcolor");}}}}}}}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.isContainerSelected=function(){try{return(this.selectedAxis==0&&(this.selectedLevel==8||this.selectedLevel==9));}catch(A){microstrategy.errors.log(A);return false;}};mstrGridReport.prototype.isTemplateEmpty=function(B){try{return(this.gridStructureInfo.hasNoUnits);}catch(A){microstrategy.errors.log(A);return false;}};mstrGridReport.prototype.convertGradientInfo=function(D){try{var A=[];var F=D.split(",");var E=mstrFormatObject;var B=function(G){return F[gradientUtil["GRADIENT_"+G]];};A[this.gradientColorId]=E.encodeValue("gradientColor",D);A[this.gradientAngleId]=B("ANGLE_INDEX");A[this.gradientXOffsetId]=B("XOFFSET_INDEX");A[this.gradientYOffsetId]=B("YOFFSET_INDEX");}catch(C){microstrategy.errors.log(C);}return A;};mstrGridReport.prototype.makeSelectionByName=function(E,B,A,D){var F=this.getSelectionData(B);if(F&&F.el&&E&&F.el[E]){var C=new Array(F.el[E].id);this.makeSelection(C,B,A,D,true);}};mstrGridReport.prototype.makeSelection=function(I,G,H,J){try{var A="\x1e";var E=this.getSelectionData(G);if(E&&I&&I.length>0){var K=I.join(A);E.sel=I;E.ias=false;for(var D in I){if(D=="u;"){E.ias=true;break;}}var C=this.controlLinks&&this.controlLinks[G];if(!C&&this.controlLinks){for(var F in this.controlLinks){C=this.controlLinks[F];break;}}if(C){this.applySelector(G,C.ck,K,this.getVisibleTargets(C),C.partialUpdate,C.ctxt,H,J);}}}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.makeSelections=function(B){try{var D=[];for(var A=0;A<B.length;A++){this.makeSelection(B[A].values,B[A].attId,null,D);}if(D.length>0){this.um.add(D);this.um.flushAndSubmitChanges();}}catch(C){microstrategy.errors.log(C);}};mstrGridReport.prototype.handleFitToAction=function(C){try{var B=[];this.saveEnabled=true;this.isSaveBeforeDocCreate=true;this.notifySelectionChange("ongridselectionschange");this.commands.exec("setColWidthsMode",parseInt(C));this.colWidths.saveColWidthsMode(parseInt(C),B);this.colWidths.syncCols();this.um.add(B);}catch(A){microstrategy.errors.log(A);}};mstrGridReport.prototype.handleFitToWindow=function(){this.handleFitToAction("1");};mstrGridReport.prototype.handleFitToContent=function(){this.handleFitToAction("2");};mstrGridReport.prototype.setGraphSelected=function(A){this.graphSelected=A;};mstrGridReport.prototype.getFixedRC=function(B){try{if(this.gridStructureInfo){return this.gridStructureInfo["getFixed"+B]();}else{return mstrGridStatic.prototype["getFixed"+B].apply(this);}}catch(A){microstrategy.errors.log(A);}return 0;};mstrGridReport.prototype.getFixedRows=function(){return this.getFixedRC("Rows");};mstrGridReport.prototype.getFixedColumns=function(){return this.getFixedRC("Columns");};mstrGridReport.prototype.addRefreshEvent=function(){try{var A=this.um;var C=A.createActionObject(null,mstrUpdateManager.PAGE_REFRESH,microstrategy.servletName+"."+microstrategy.pageName,[],[],[],null);A.add([C],true);}catch(B){microstrategy.errors.log(B);}};mstrGridReport.prototype.isADrillElemCheckBoxOrARadio=function(A){return(A.name&&(A.name.indexOf(microstrategy.DRILL_BOX_NAME)==0||A.name.indexOf(microstrategy.FILTER_BOX_NAME)==0)&&(A.type=="checkbox"||A.type=="radio"));};mstrGridReport.prototype.submitIncrementalFetch=function(G,H){if(!H){H=window.event;}if(H&&H.ctrlKey){return false;}if(G.getAttribute("useIframe")){G.href=replaceURLParameter(G.href,"iframe","true");}var B=G.target;var I=getObj("ReportEditorGrid");var C="";var A=G.href;if(I){var E=createDynamicForm(A);if(B){E.target=B;}for(var F=0;F<I.elements.length;F++){var J=I.elements[F];if(this.isADrillElemCheckBoxOrARadio(J)&&J.checked){if(J.type=="radio"){C=J.value;break;}C=C+J.value+",";}}var D=document.createElement("INPUT");D.type="HIDDEN";D.name="hiddenDrillValues";D.id="hiddenDrillValues";if(this.hiddenDrillValues){D.value=C+this.hiddenDrillValues;}else{D.value=C;}E.insertAdjacentElement("beforeEnd",D);submitForm(E);}};mstrGridReport.prototype.submitDrillFromEditor=function(A){var C=A.form;var B=document.createElement("input");B.type="hidden";B.name=A.name;B.value=A.value;C.appendChild(B);C.onsubmit();C.submit();};mstrGridReport.prototype.initIncrementalFetchBoxes=function(){var A=this.hiddenDrillValues;var C=A?A.split(","):[];var G=getObj("ReportEditorGrid");var H="";var I;var F=false;if(G){for(var E=0;E<G.elements.length;E++){I=G.elements[E];if(I.name&&I.name.indexOf(microstrategy.DRILL_BOX_NAME)==0&&I.type=="radio"){F=true;break;}}for(var E=0;E<G.elements.length;E++){I=G.elements[E];if(this.isADrillElemCheckBoxOrARadio(I)){for(var D=0;D<C.length;D++){if(I.value==C[D]){I.checked=true;if(I.type=="radio"){return ;}break;}}}}if(F){H=C[0];}else{var B=false;for(var D=0;D<C.length;D++){B=false;for(var E=0;E<G.elements.length;E++){I=G.elements[E];if(I.name&&I.name.indexOf(microstrategy.DRILL_BOX_NAME)==0&&I.type=="checkbox"){if(I.value==C[D]){B=true;break;}}}if(B==false){H=H+C[D]+",";}}if(H.substr(H.length-1)==","){H=H.substr(0,H.length-1);}}if(G.hiddendrillvalues){G.hiddendrillvalues.value=H;}}};mstrGridReport.styAttrValue=function(B,A){return microstrategy.styleObj.getAttValue(B,microstrategy["HTMLATTR_"+A]);};mstrGridReport.prototype.getFilterBone=function(){try{return microstrategy.bone("rfe_pane")||microstrategy.bone("rle_pane")||microstrategy.bone("vfe_pane");}catch(A){microstrategy.errors.log(A);return null;}};mstrGridReport.prototype.prompt2ApplyFilter=function(){try{if(this.isFilterVisible){var B=this.getFilterBone();if(B){return B.prompt2ApplyFilter();}}}catch(A){microstrategy.errors.log(A);}return false;};function mstrGridReport(A){this.inherits=mstrGridStatic;this.inherits(A);delete this.inherits;this.primaryBone=true;return this;}mstrGridCommands.prototype=new mstrGridStaticCommands();mstrGridCommands.prototype.exec=function(L,h,g,a,Y){try{var C=null;var R=null;var AC=this.parentBone.um;var T=[];var Z=this.parentBone;if(L&&L.match(/exportMenu;/)){return this.exec("exportMenu",L.substring(11,L.length));}if((Z.isGraph&&mstrGridStatic.isGraphCommand(L))||(Z.graphSelected&&mstrGridStatic.isGridGraphCommand(L))){var AD=microstrategy.bone(Z.id+"_graph");return AD&&AD.commands.exec(L,h,g,a,Y);}switch(L){case"clearAllGridSelections":if(Z.selections){Z.selections.clearAll();}return true;case"clearAllGridSelectionsWithOutNotify":if(Z.selections){Z.selections.clearAll(true);}return true;case"updateSelected":Z.updateSelected(h,g,a);return true;case"setColWidthsMode":this.exec("ensureColWidthsReady");if(Z.colWidths){Z.colWidths.setColWidthsMode(h);}return true;case"setColWidth":this.exec("ensureColWidthsReady");if(Z.colWidths){Z.colWidths.setColWidthByKey(h,g,a);}return true;case"setRowHeightMode":this.exec("ensureColWidthsReady");if(Z.colWidths){Z.colWidths.setRowHeightMode(h,g);}return true;case"saveColWidthsMode":this.exec("ensureColWidthsReady");if(Z.colWidths){return Z.colWidths.saveColWidthsMode(h,g);}case"saveColWidths":this.exec("ensureColWidthsReady");if(Z.colWidths){return Z.colWidths.saveAllColWidths(h,g);}case"saveRowHeightMode":this.exec("ensureColWidthsReady");if(Z.colWidths){return Z.colWidths.saveRowHeightMode(h,g,a);}case"cancelAllWidthsChanges":this.exec("ensureColWidthsReady");if(Z.colWidths){Z.colWidths.cancelAllOperations();}return true;case"syncColumns":this.exec("ensureColWidthsReady");if(Z.colWidths){Z.colWidths.syncCols();}return true;case"ensureColWidthsReady":if(Z.doColWidths&&!Z.colWidths){Z.setupColResize(Z.colResizeExtraTag);}return ;case"saveActionCollection":Z.um.add(h);return true;case"restoreColumnWidths":this.exec("ensureColWidthsReady");if(Z.colWidths){Z.colWidths.restoreColumns();}return true;case"createIVEFromRpt":case"createHTML5IVEFromRpt":case"createDocFromRpt":var M=L!=="createDocFromRpt";var W=M?14333:5867;if((Z.isNew||Z.isReadonly||Z.isDrilled)||Z.isSaveBeforeDocCreate){microstrategy.bone(Z.id).saveCmdId=L;var o="microstrategy.bone('"+Z.id+"').save()";var J=microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON;showMessage({contents:mstrGridReport.desp(W),elements:J,okEval:o,type:mstrMsgBoxImpl.MSG_WARNING});}else{if(Z.stateID>0&&Z.stateID!=Z.saveStateID){var AB=L==="createIVEFromRpt",o="microstrategy.bone('"+Z.id+"').save()",I="microstrategy.bone('"+Z.id+"').convertToDoc("+M+","+AB+")",H={Ok:microstrategy.descriptors.getDescriptor("218"),Cancel:microstrategy.descriptors.getDescriptor("221"),Apply:microstrategy.descriptors.getDescriptor("219")};J=microstrategy.APPLY_BUTTON+microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON;showMessage({contents:mstrGridReport.desp(5956),elements:J,applyEval:o,okEval:I,type:mstrMsgBoxImpl.MSG_WARNING,buttonLabels:H});}else{Z.convertToDoc(L!=="createDocFromRpt",L==="createIVEFromRpt");}}return true;case"addTemplateUnitAttForm":case"addTemplateUnit":var AG=h.getAttribute(microstrategy.HTMLATTR_PARENT_ID);if(AG!=null){var AO=Z.gridStructureInfo.findUnit(AG);if(AO!=null){g=AO.axis;a=AO.depth;}}var AH=(L=="addTemplateUnitAttForm")||(a!=-1);T=Z.addUnit(h,g,a,-1,Y,AH);if(this.selections){this.selections.clearAll(true);}if(T.length>0&&Z.useClientSideManipulations){microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",Z.gridStructureInfo);}return T;case"edtColorPicker":C=h.split("|");Z.openDialog("edtColorPicker",null,null,microstrategy.servletName+"."+microstrategy.pageName,{activeBoneID:C[0],activeControlID:C[1],currentColor:C[2]});Z.um.replaceURL("selectedTabOptions",C[3]);Z.um.flushAndSubmitChanges();break;case"graphEdtColorGradient":case"edtColorGradient":case"rwdEdtColorGradient":C=h.split("|");var u=(L=="graphEdtColorGradient");var AI=function(AX,m,AY){Z.openDialog(AX,m,null,microstrategy.servletName+"."+microstrategy.pageName);if(AY){Z.um.replaceURL("selectedTabOptions",AY);}};var x=null;var S="parentBoneID="+C[0]+"&controlID="+C[1]+"&activeViewKey=";if(!Z.isGrid||u){S+=((this.objId)?this.objId:C[2])+"&graphObjectID="+C[3]+"&graphSeriesID="+parseInt(C[4]);if(C.length>5){S+="&color1="+C[5]+"&color2="+C[6]+"&transitionType="+C[7]+"&angle="+C[8]+"&xOffset="+C[9]+"&yOffset="+C[10];x=C[11];}AI("edtColorGradient",S,x);}else{var y=(L=="edtColorGradient")?"gridEdtColorGradient":"rwdEdtColorGradient";if(C.length>6){S+=this.objId+"startFromSolid="+false+"&retrieveGradient="+C[3]+"&color1="+C[4]+"&color2="+C[5]+"&angle="+C[6]+"&xOffset="+C[7]+"&yOffset="+C[8]+"&formatType="+microstrategy.formatType;x=C[9];}else{if(C.length==6){var V=(C[4]=="transparent")?"#FFFFFF":C[4];S+=C[2]+"&retrieveGradient="+C[3]+"&color1="+V+"&startFromSolid="+true+"&formatType="+microstrategy.formatType;x=C[5];}else{S+=C[2]+"&retrieveGradient="+C[3]+"&color1="+C[4]+"&startFromSolid="+true+"&targetAxis="+Z.selectedAxis+"&targetPosition="+Z.positionForGradient+"&targetLevel="+Z.selectedLevel+"&formatType="+microstrategy.formatType;}}AI(y,S,x);}Z.um.flushAndSubmitChanges();break;case"bgcolorgradient":Z.exec("backgroundColor",h);break;case"removeTemplateUnit":T=null;var z=Z.gridStructureInfo.findUnit(g);if(z!=null){if(a!=null){var D=z.attForms.findUnit(a);T=(D!=null)?Z.deleteUnit(D,Y):Z.deleteUnit(z,Y);}else{T=Z.deleteUnit(z,Y);}if(this.selections){this.selections.clearAll(true);}if(T.length>0&&!this.queryState("graphMode")&&Z.useClientSideManipulations){microstrategy.eventManager.notifyOrphanBones("ongridstructurechange",Z.gridStructureInfo);}}return T;case"getGridUnits":if(Z.gridStructureInfo){return Z.gridStructureInfo.getGridUnits();}break;case"formatGridBulk":Z.processGridFormattingProperties(h);return true;case"formatGraphBulk":Z.processGraphFormattingProperties(h);return true;case"redo":Z.processRedo();return true;case"undo":Z.processUndo();return true;case"subtotalChanges":case"PropertyChanges":R=[];for(var AU=0,X=h.length;AU<X;AU++){var AP=h[AU].cmdId;var P=h[AU].value;Z.processGridPropertyChanges(AP,P,R);}Z.um.add(R);Z.um.flushAndSubmitChanges();return true;case"ShowThreshold":Z.displayThresholds(Z.thresholdsState?"0":"1");return true;case"quickThresholds":Z.addQuickThresholds(R,h+"|edtAdvancedThresholds");return true;case"swapAxes":Z.swapAxes();return true;case"gridMode":case"graphMode":var AR={gridMode:1,graphMode:2}[L];if(Z.isGraph){var AD=microstrategy.bone(Z.id+"_graph");if(AD&&AD.zonesEditor){AD.toggleZonesEditor(null,false);}}if(Z.quickSwitch&&!Z.hasResized&&(!Z.isGrid||!Z.isGraph)){if((AR==1&&Z.isGraph)||(AR==2&&Z.isGrid)){Z.onQuickSwitchClick();}else{Z.notifySelectionChange("onselectionchange");}}else{Z.updateViewMode(AR);Z.handleViewMode(AR);}return true;case"gridGraphMode":Z.updateViewMode(3);Z.handleViewMode(3);return true;case"visFlashMode":case"visAjaxMode":var F=((L=="visFlashMode")?50:51);microstrategy.adjustSelectedVisualization(Z,F);Z.updateViewMode(F);Z.handleViewMode(F);return true;case"visualizationMode":microstrategy.adjustSelectedVisualization(Z,h);Z.updateViewMode(h);Z.handleViewMode(h);return true;case"autostyle":Z.handleChangeStyle(h);return true;case"selectedVisualization":R=[];C=h.split("|");Z.setVisualizationSettings(null,C[0],null,C[1],R);Z.um.add(R);if((mstrGridReport.isRWD()&&microstrategy.EDIT_MODE==microstrategy.NOT_ALLOW_EDIT_MODE)||(mstrGridReport.isReport()&&mstrGridReport.isViewMode())){Z.um.flushAndSubmitChanges();}return true;case"setVisProps":R=[];Z.setVisualizationSettings(null,null,null,null,R,h);Z.um.add(R);return true;case"raiseGridResize":Z.onresize();return true;case"tbanding":Z.handleBanding();return true;case"tOutline":R=[];var AL=1;if(this.queryState("tOutline")){AL=0;}Z.processGridPropertyChanges("Outline",AL,R);Z.um.add(R);Z.um.flushAndSubmitChanges();return true;case"fittocontent":Z.handleFitToContent();return true;case"fittowindow":Z.handleFitToWindow();return true;case"checkMergeRowHeader":case"checkMergeColHeader":Z.toggleMergeHeaders(L);return true;case"checkLockRowHeader":case"checkLockColHeader":Z.toggleLockHeaders(L);return true;case"pageBy":microstrategy.toggleEditor("pbb_PageByStyle","pbb");return true;case"reportFilter":microstrategy.toggleEditor("rfe_pane","rfe");return true;case"viewFilter":microstrategy.toggleEditor("vfep_pane","vfep");return true;case"replaceTemplate":return Z.replaceTemplate(h,g,a);case"promptDetails":microstrategy.toggleEditor("promptDetails_PromptDetailsStyle","promptDetails");return true;case"simpleThresholds":microstrategy.toggleEditor("edtReportSimpleThresholds_SimpleThresholdsReportEditorStyle","edtReportSimpleThresholds");return true;case"addQuickTotals":Z.addAction(this.elem,mstrUpdateManager.ADD_QUICK_SUBTOTAL,Z.beanPath);return true;case"save":if(mstrGridReport.isDesignMode()){return this.exec("dmSave",h,g,a,Y);}else{var B=Z.getSaveFolderId();var AN=["3013","3017"];var AM=["false","false"];if(B){AN.splice(1,0,"3014");AM.splice(1,0,B);}AC.useIframe=false;this.submitAction(this.elem,mstrUpdateManager.DESIGN_MODE_SAVE_AS,microstrategy.servletName,AN,AM);break;}case"menuDirectSave":case"dSave":if(Z.prompt2ApplyFilter()){return ;}if(Z.isNew||Z.isReadonly||Z.isDrilled||Z.needSaveAs){return this.exec("save",h,g,a,Y);}else{if(Z.isFeatureAvailable(microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES)){Z.askBeforeSaveOverwrite();}else{if(Z.isFeatureAvailable(microstrategy.FEATURE_FORCE_SAVE_AS)&&L=="dSave"){Z.saveReport();}else{Z.submitSave();}}break;}case"dmFilters":var n=microstrategy.findBone(Z.elem.parentNode);if(n){n.toggleFilterViewers(null,(h<0));Z.isFilterVisible=(h>0);}break;case"dmSave":if(Z.prompt2ApplyFilter()){return ;}if(Z.isNew||Z.isReadonly||Z.isDrilled){return this.exec("dmSaveAs",h,g,a,Y);}else{Z.submitSave();}break;case"dmSaveAs":if(Z.prompt2ApplyFilter()){return ;}T.push(AC.createActionObject(this.elem,mstrUpdateManager.DESIGN_MODE_PROCESS,Z.beanPath,["6032","6018"],["1","1"],[]));var B=Z.getSaveFolderId();var AN=["3013","3017"];var AM=["1","true"];if(B){AN.splice(1,0,"3014");AM.splice(1,0,B);}if(h&&h.origin){AN.push("3031");AM.push(h.origin);}T.push(AC.createActionObject(this.elem,mstrUpdateManager.DESIGN_MODE_SAVE_AS,microstrategy.servletName,AN,AM,[]));AC.add(T);AC.useIframe=false;AC.flushAndSubmitChanges();break;case"dmRun":if(Z.prompt2ApplyFilter()){return ;}AC.useIframe=false;this.submitAction(this.elem,mstrUpdateManager.DESIGN_MODE_PROCESS,Z.beanPath,["6017"],["1"]);break;case"Shortcut":case"isLinkedTemplate":Z.setFeature(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE,!h);break;case"cancelGridFormatRequest":Z.cancelGridFormatRequest();break;case"FilterDetailsFormat":microstrategy.openDataBasedBlockEditor("FilterDetailsEditor","FilterDetailsEditorBlockLoader",Z.beanPath,{});break;case"fos":AC=Z.um;var O=Z.commands.queryState("selectedDrillElements");if(O){AC.add([AC.createActionObject(null,mstrUpdateManager.FILTER_ON_SELECTIONS,Z.beanPath,["4035","4134"],[O,"1"],[],null)]);Z.commands.exec("clearAllGridSelections");AC.flushAndSubmitChanges();}break;case"togglePivot":case"toggleSort":case"toggleGraphZones":case"dontAskAgain":case"forceSaveAs":var AK="showGraphZones";var AA=microstrategy.FEATURE_CHECK_SHOW_GRAPH_ZONES;if(L=="togglePivot"){AK="showPivot";AA=microstrategy.FEATURE_CHECK_SHOW_PIVOT_BUTTONS;}else{if(L=="toggleSort"){AK="sSrt";AA=microstrategy.FEATURE_CHECK_SHOW_SORT_BUTTONS;}else{if(L=="dontAskAgain"){AK="askBeforeSaveChanges";AA=microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES;if(this.observer){this.observer.notifyAll("onstatechange");}this.submitAction(this.elem,mstrUpdateManager.SET_PREFERENCE,Z.beanPath,["5003","5004"],[AK,0]);break;}else{if(L=="forceSaveAs"){AK="askBeforeSaveChanges";AA=microstrategy.FEATURE_FORCE_SAVE_AS;if(this.observer){this.observer.notifyAll("onstatechange");}this.submitAction(this.elem,mstrUpdateManager.SET_PREFERENCE,Z.beanPath,["5003","5004"],[AK,2]);break;}}}}if(this.observer){this.observer.notifyAll("onstatechange");}this.submitAction(this.elem,mstrUpdateManager.SET_PREFERENCE,Z.beanPath,["5003","5004"],[AK,Z.isFeatureAvailable(AA)?0:1]);break;case"comboToggleButton":if(this.queryEnabled("toggleSubtotals")){this.exec("toggleSubtotals");}else{this.exec("quickTotals");}break;case"tsubtotals":case"toggleSubtotals":Z.toggleSubtotals();break;case"showBean":this.submitAction(this.elem,mstrUpdateManager.SHOW_BEAN,Z.beanPath,["5018","5017"],[h,g]);break;case"openFormulaEditor":this.submitAction(this.elem,mstrUpdateManager.OPEN_FORMULA_EDITOR,Z.beanPath,["6036","6037"],[h,g]);break;case"setPropertyValues":this.submitAction(this.elem,mstrUpdateManager.REPORT_EVENT_SET_PROPERTY_VALUES,Z.beanPath,["4146"],[h]);break;case"quickTotals":case"addViewFilterCondition":case"toggleThresholds":case"banding":case"outline":case"mergeCols":case"mergeRows":case"lockCols":case"lockRows":case"fitContents":case"fitWindow":case"attForms":var AR=this.getActionMap(L);this.submitAction(AR.e,AR.id,Z.beanPath,AR.s,AR.v);break;case"saveReport":var B=Z.getSaveFolderId();var AN=["3013"];var AM=[false];if(B){AN.push("3014");AM.push(B);}AC.useIframe=false;this.submitAction(this.elem,mstrUpdateManager.SAVE_GRID,microstrategy.servletName,AN,AM);break;case"optimizedMode":AC.useIframe=false;this.submitAction(this.elem,mstrUpdateManager.CHANGE_OPTIMIZED_MODE,microstrategy.servletName,["3017"],["1"]);break;case"designMode":AC.useIframe=false;this.submitAction(this.elem,mstrUpdateManager.CHANGE_DESIGN_MODE,Z.beanPath,["3017"],["1"]);break;case"browseParent":if(!Z.parentFolderID||Z.isParentFolderHidden){return this.exec("openHome");}AC.useIframe=false;this.submitAction(null,mstrUpdateManager.BROWSE_FOLDER,microstrategy.servletName,["1001"],[Z.parentFolderID]);break;case"openHome":AC.useIframe=false;this.submitAction(null,mstrUpdateManager.OPEN_DESKTOP,microstrategy.servletName,[],[]);break;case"export":case"print":case"printPDF":case"buttonPDF":case"buttonFlash":var G=1;G=Z.isGraph?G+1:G;G=Z.isGrid&&Z.isGraph?G+1:G;var A=Z.isFeatureAvailable("export-new-window")?"_blank":"mstrExportWindow";exportReport(null,A,L,G);break;case"toggleScreenMode":toggleScreenMode();break;case"gridEditor":case"graphEditor":case"gridOptions":case"resizeEditor":this.exec("showBean",L,true);break;case"sort":microstrategy.openAdvSortEditor({beanPath:Z.beanPath,subtotalPosition:Z.subtotalPosition,isReportDesignMode:mstrGridReport.isDesignMode(),isReportBlank:Z.isReportBlank,sourceAxis:h&&h[0],sourceType:h&&h[1],targetGrid:Z,taskParams:{taskId:"reportExecute",styleName:"AdvSortDataStyle",startCol:Z.startCol,maxCols:Z.maxCols,msgID:mstrApp.getMsgID()}});break;case"drill":toggleShowBean("drillEditor",!this.queryState("drill"));break;case"editDM":case"newMetric":var E=mstrApp.getMsgID(),AE=[Z.wksInfos],e=microstrategy.activeCXMenu,c=Z.gridStructureInfo,AS="",q="",N=1,AF={datasets:AE,msgID:E},AJ=[];if(e){AS=e.getAttribute(microstrategy.HTMLATTR_DSS_ID);q=e.getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME);N=e.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH);}else{var K=c&&c.metricAxis&&c.metricAxis.units&&c.metricAxis.units[0];if(K){AS=K.dssId;q=K.alias;N=K.depth;}}var AT=function(m){AC.add(m);AC.flushAndSubmitChanges();};if(L==="newMetric"){AF.metricId="";AF.action={cmd:"editNew",refOi:{did:AS,n:q}};AF.onApplyMetricCallback=function(AX){var m=["4031","4032","4259","4029"],AY=[AX.alias,AX.tokenStreamXML,!mstrmojo.string.isEmpty(AX.tokenStreamXML),N+1];if(AX.afb!==undefined){m.push("4260");AY.push(AX.afb);}if(AX.sfb!==undefined){m.push("4258");AY.push(AX.sfb);}AJ.push(AC.createActionObject(null,mstrUpdateManager.ADD_DERIVED_METRIC,Z.beanPath,m,AY));AT.call(this,AJ);};}else{AF.metricId=AS;AF.action={cmd:"edit",n:q};AF.onApplyMetricCallback=function(AX){var m=["4248","4031","4032","4259"],AY=[AS,AX.alias,AX.tokenStreamXML,!mstrmojo.string.isEmpty(AX.tokenStreamXML)];if(AX.afb!==undefined){m.push("4260");AY.push(AX.afb);}if(AX.sfb!==undefined){m.push("4258");AY.push(AX.sfb);}AJ.push(AC.createActionObject(null,mstrUpdateManager.CHANGE_METRIC_FORMULA,Z.beanPath,m,AY));AT.call(this,AJ);};}microstrategy.openDerivedMetricEditor(AF);break;case"renameEditObjects":this.exec("openFormulaEditor","1",false);break;case"toggleattforms":case"toggleAttributeForms":Z.toggleAttForms();break;case"editTotals":this.exec("showBean","ReportSubtotalsDHTMLEditor",true);break;case"advancedThresholds":this.exec("showBean","edtAdvancedThresholds",true);break;case"setGridUnitSelections":Z.setGridUnitSelections(h.unit,h.value);break;case"tbGridUnitSelector":Z.setGridUnitSelections(h,Math.max(Z.gridValueFormat,microstrategy.GRID_BORDERS));break;case"tbGridValueSelector":Z.setGridUnitSelections(Z.gridUnitFormat,h);break;case"tbGraphUnitSelector":var U=(Z.isGraph&&!Z.isGrid)?Z:microstrategy.bone(Z.id+"_graph");if(U){Z.setGraphSelected(true);U.commands.exec(L,h);Z.notifySelectionChange("ongridselectionschange");}break;case"tbUnitSelector":if(h!="-1"){if(h.indexOf("**grid")>-1){Z.setGraphSelected(false);this.exec("tbGridUnitSelector",h.replace("**grid",""));}else{if(h.indexOf("**graph")>-1){if(Z.selections&&Z.selections.removeAllHilites){Z.selections.removeAllHilites(true);}this.exec("tbGraphUnitSelector",h.replace("**graph",""));}}}else{Z.notifySelectionChange("ongridselectionschange");}break;case"tbValueSelector":Z.graphSelected?this.exec("tbGraphValueSelector",h):this.exec("tbGridValueSelector",h);break;case"FontFamily":case"FontSize":case"Underline":case"GridHorizontal":case"IncreaseDecimal":case"DecreaseDecimal":case"Currency":case"IntlCurrency":case"Percent":case"Comma":case"FillColor":case"lncolor":case"borders":case"FontColor":case"lnstyle":Z.processSingleFormattingProperty(L,h);break;case"Bold":case"Italic":Z.processSingleFormattingProperty(L,h?microstrategy.TRUE:microstrategy.FALSE);break;case"autoArrange":var AD=microstrategy.bone(Z.id+"_gb");if(AD){AD.submitAutoArrange(Z.id);}break;case"major":case"minor":if(Z.isGrid&&Z.isGraph){microstrategy.bones[Z.id+"_graph"].exec(L,h);}return true;case"toggleReportBar":var AW=this.queryState("toggleReportBar")?"0":"1";this.submitAction(this.elem,mstrUpdateManager.TOGGLE_REPORT_BAR,Z.beanPath,["6050"],[AW]);break;case"exportMenu":var A=mstr.behaviors.featureResolver.featAvailable("export-new-window")?"_blank":"mstrExportWindow";exportReport(h,A,"export",Z.currentView);break;case"customVisualizations":this.exec("openReportFrameElement","visualizationsEditor");break;case"visPropsEditor":var AN="scope="+h[0]+"&selVis="+h[1]+"&visEditorId="+h[2];if(mstrGridReport.isRWD()){AN+="&activeViewID="+Z.objId;}if(h[3]){AN+="&widgetPropsXml="+escape(h[3]);}if(h[4]){AN+="&secDataProv="+escape(h[4]);}if(mstrGridReport.isRWD()&&mstrGridReport.isDesignMode()){R=[];R.push(AC.createActionObject(this.elem,mstrUpdateManager.APPLY_CHANGES,Z.beanPath,[],[],[]));Z.um.add(R);}toggleShowBean("visPropsEditor",true,AN);break;case"drillEditor":case"drillFilterEditor":this.exec("openReportFrameElement",L);break;case"forwardPicker":case"backPicker":AC.useIframe=false;var AQ=new Array();AQ.push(AC.createActionObject(this.elem,mstrUpdateManager.OPEN_HISTORY_PAGE,microstrategy.servletName+"."+microstrategy.pageName,["3140"],[h]));AC.add(AQ,true);AC.flushAndSubmitChanges();return true;case"toggleHideNullsOrZeros":var Q=this.queryState("HideNullsOrZeros"),R=[];R.push(AC.createActionObject(this.elem,mstrUpdateManager.TOGGLE_HIDE_NULLS,Z.beanPath,["4261"],[(Q)?microstrategy.TRUE:microstrategy.FALSE],[],null));AC.add(R,true);AC.flushAndSubmitChanges();break;default:if(Z.exec(L,h)){return true;}mstrGridStaticCommands.prototype.exec.call(this,L,h,g,a,Y);}return false;}catch(AV){microstrategy.errors.log(AV);return false;}};mstrGridReport.prototype.askBeforeSaveOverwrite=function(){try{var C=mstrGridReport.desp("11165").replace(/##/,"<b>"+this.objName+"</b>");var A="<label for='askBeforeSaveCheckbox' id='glabel'> "+mstrGridReport.desp("211")+" </label>";var D="<input name='askBeforeSave' id='askBeforeSaveCheckbox' type='checkbox'/> ";showMessage({contents:"<div style='overflow:auto'>"+C+"</div><br/><br/><div style='overflow:auto' text-align:center>"+D+A+"</div>",elements:microstrategy.APPLY_BUTTON+microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,applyEval:"microstrategy.bones['"+this.id+"'].submitSave()",okEval:"microstrategy.bones['"+this.id+"'].saveReport()",buttonLabels:{Apply:microstrategy.descriptors.getDescriptor("219"),Ok:microstrategy.descriptors.getDescriptor("218")},title:mstrGridReport.desp("5728"),type:mstrMsgBoxImpl.MSG_TEXT_ONLY});}catch(B){microstrategy.errors.log(B);}};mstrGridCommands.prototype.submitAction=function(D,E,C,B,A){this.parentBone.addAction(D,E,C,B,A);};mstrGridCommands.prototype.getActionMap=function(B){var E=this.am;var D=this.parentBone;var C=mstrUpdateManager;if(!E){E={quickTotals:{id:C.ADD_QUICK_SUBTOTAL},addViewFilterCondition:{id:C.ADD_VIEW_FILTER_CONDITION},attForms:{id:C.OPEN_ATT_FORMS_EDITOR},toggleThresholds:{id:C.REPORT_EVENT_SET_THRESHOLDS_DISPLAY,s:["4193"],v:[D.thresholdsState?0:1]},banding:{id:C.REPORT_EVENT_SHOW_BANDING,s:["4125"],v:[D.isFeatureAvailable(microstrategy.FEATURE_CHECK_SHOW_BANDING)?0:1]},outline:{id:C.REPORT_EVENT_SHOW_OUTLINE_MODE,s:["4121"],v:[D.isFeatureAvailable(microstrategy.FEATURE_CHECK_OUTLINE_MODE)?0:1]},mergeCols:{id:C.MERGE_COLUMN_HEADERS,s:["6038"],v:[!D.isFeatureAvailable(microstrategy.FEATURE_CHECK_MERGE_COL_HEADER)]},mergeRows:{id:C.REPORT_EVENT_SET_PROPERTY_VALUES,s:["4126","4146"],v:[D.styleName,"4!Template Formatting!MergeCells!"+(D.isFeatureAvailable(microstrategy.FEATURE_CHECK_MERGE_ROW_HEADER)?0:-1)]},lockCols:{id:C.REPORT_EVENT_SET_PROPERTY_VALUES,s:["4146"],v:["4!Template Formatting!LockColumnHeaders!"+(D.isFeatureAvailable("check-lock-column-headers")?0:1)]},lockRows:{id:C.REPORT_EVENT_SET_PROPERTY_VALUES,s:["4146"],v:["4!Template Formatting!LockRowHeaders!"+(D.isFeatureAvailable("check-lock-row-headers")?0:1)]},fitContents:{id:C.REPORT_EVENT_SET_COLUMN_SCENARIO,s:["4153","4154","4155","4056"],v:["2","2","1","1"]},fitWindow:{id:C.REPORT_EVENT_SET_COLUMN_SCENARIO,s:["4153","4154","4155","4056"],v:["1","2","1","1"]}};this.am=E;}var A=E[B];A.e=this.elem;if(!A.s){A.s=[];}if(!A.v){A.v=[];}return A;};mstrGridCommands.prototype.queryEnabled=function(I,Q){try{var B=this.parentBone;if(!Q&&((B.isGraph&&mstrGridStatic.isGraphCommand(I))||(B.graphSelected&&mstrGridStatic.isGridGraphCommand(I)))){var C=microstrategy.bone(B.id+"_graph");return C&&C.commands.queryEnabled(I);}var D=null;var J;if(I&&(J=I.match(/exportMenu;/))&&J.index==0){return true;}var K=function(e,a){var g=true;if(a){g=!B.isVisualization;}return(B.isFeatureAvailable(microstrategy["FEATURE_"+e])&&g);};var G=function(a){return mstr.behaviors.featureResolver.featAvailable(a+"-formatting");};switch(I){case"Hmode":return !(microstrategy.formatType==mstrGridReport.FMT_TYPE_TITLE);case"Height":return(microstrategy.formatType==mstrGridReport.FMT_TYPE_TITLE&&B.showTitleBar()==true);case"number":case"IntlCurrency":case"Currency":case"deltaDecimal":case"IncreaseDecimal":case"DecreaseDecimal":case"Percent":case"Comma":if((G("number")||G("grid-graph"))&&this.queryEnabled("canUseGridFormatting")){return !(B.selectedPosition=="-9"||B.selectedPosition=="-99");}else{return false;}case"TextAlign":case"align":case"font":case"FontFamily":case"fsize":case"FontSize":case"color":case"FontColor":case"fstyle":case"Bold":case"Italic":case"Underline":case"GridHorizontal":return this.queryEnabled("canUseGridFormatting")&&G("grid-graph")&&!((B.selectedPosition=="-9"&&B.selectedLevel=="8")||B.gridUnitFormat==microstrategy.GRID_BORDERS);case"FillColor":case"bgcolor":return this.queryEnabled("canUseGridFormatting")&&(G("grid-graph")&&B.gridUnitFormat!=microstrategy.GRID_BORDERS);case"lncolor":case"borders":case"lnstyle":return this.queryEnabled("canUseGridFormatting")&&G("grid-graph")&&!(B.selectedPosition=="-9"&&B.selectedLevel=="9");case"canUseGridFormatting":var O=!this.queryState("Shortcut")&&!(B.selectedPosition=="-999"&&(B.selectedLevel=="1"||B.selectedLevel=="5")&&B.hasNoMetrics);return O&&(B.graphSelected||mstr.behaviors.featureResolver.featAvailable("change-grid-autostyle"));case"lineColor":case"borderLeftStyle":case"lineStyle":return(microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN);case"advColorPicker":case"onegrid":case"edtSort":case"edtRename":case"level":case"target":case"graphCategory":case"graphTarget":case"reportFilter":case"promptDetails":case"fmtToolbar":case"advColorPicker":case"visualizationsEditor":case"edtColorGradient":case"gradientcolor":case"export":case"saveReport":case"designMode":case"save":case"print":case"printPDF":case"browseParent":case"toggleScreenMode":case"createDocFromRpt":case"createIVEFromRpt":case"createHTML5IVEFromRpt":case"gridOptions":case"addViewFilterCondition":case"visFlashMode":case"visAjaxMode":case"toggleGraphZones":case"toggleReportBar":case"buttonPDF":case"buttonFlash":case"FilterDetailsFormat":case"drillFilterEditor":case"optimizedMode":return true;case"menuDirectSave":if(mstrGridReport.isDesignMode()){return B.gridStructureInfo!=null&&!B.gridStructureInfo.hasNoUnits;}else{return B.saveEnabled;}case"dSave":if(B.isFeatureAvailable(microstrategy.FEATURE_FORCE_SAVE_AS)){return true;}else{return B.saveEnabled;}case"togglePivot":case"toggleSort":return B.isGrid;case"renameEditObjects":return K("ENABLE_RENAME_EDIT_OBJECT",true);case"newMetric":return K("ENABLE_INSERT_NEW_METRIC",true);case"editTotals":return K("ENABLE_SHOW_TOTALS",true);case"toggleSubtotals":return K("ENABLE_SHOW_SUBTOTALS");case"sort":return K("ENABLE_SORT",true);case"drill":case"drillEditor":return K("ENABLE_DRILL_EDITOR",true);case"viewFilter":return K("ENABLE_VIEW_FILTER_EDITOR");case"pageBy":return K("ENABLE_PAGE_BY");case"allObjects":return !K("IS_VIEW_REPORT")&&K("ENABLE_OBJECT_BROWSER");case"objBrowser":return K("ENABLE_OBJECT_BROWSER");case"ncSendNow":return K("ENABLE_SEND_NOW");case"gridMode":return K("ENABLE_GRID_MODE");case"graphMode":return K("ENABLE_GRAPH_MODE");case"gridGraphMode":return K("ENABLE_GRID_GRAPH_MODE");case"redo":return((B.um.anyNonStatic(true)||B.isReportRedoable)&&!B.isVisualization);case"undo":return((B.um.anyNonStatic(false)||B.isReportUndoable)&&!B.isVisualization);case"gridGraphCategory":return B.isGrid&&B.isGraph;case"autoArrange":var C=microstrategy.bone(B.id+"_gb");return C&&!C.autoArrange;case"edtDMetric":return !B.isTemplateEmpty();case"quickThresholds":return B.isGrid&&B.selections&&B.selections.hasMetricsSelected&&B.selections.hasMetricsSelected()&&B.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE);case"checkMergeRowHeader":return this.queryEnabled("mergeHeader")&&!this.queryState("tOutline")&&mstr.behaviors.featureResolver.featAvailable("enable-grid-format-editor");case"checkMergeColHeader":return this.queryEnabled("mergeHeader");case"mergeHeader":case"autostyle":case"tbanding":case"tOutline":case"checkLockColHeader":case"checkLockRowHeader":case"fittocontent":case"fittowindow":case"edtSortGridMenu":case"edtSortGrid":case"vfeRWGrid":case"gridNoVisNoEmpty":return B.isGrid&&B.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE)&&!((B.isVisualization&&B.docViewer&&!B.docViewer.isEditableViewModeEplus())||B.isTemplateEmpty());case"toggleAttributeForms":case"toggleattforms":if(!this.queryEnabled("gridNoVisNoEmpty")){return false;}var R=B.gridStructureInfo&&B.gridStructureInfo.getAttributes();var L=false;if(!R){return false;}for(var T=0;T<R.length;T++){L|=R[T].hasAttForms();if(L){return true;}}return false;case"graphCategory":case"graphTarget":case"graphZones":return B.isGraph&&K("EMBEDDED_TEMPLATE_NODE")&&!(B.isVisualization||B.isTemplateEmpty());case"visualizationMode":return B.visualizationsEnabled;case"selectedVisualization":return B.visualizationList&&B.visualizationList.length>0;case"isLinkedGrid":return !K("EMBEDDED_TEMPLATE_NODE");case"toggleThresholds":case"ShowThreshold":return B&&(B.isGrid||B.isGraph)&&B.hasThresholds&&K("EMBEDDED_TEMPLATE_NODE");case"simpleThresholds":case"advancedThresholds":case"edtSubtotals":case"addQuickTotals":case"edtSubtotalsOldIServer":case"openSimpleThresholdEditor":case"openAdvThresholdEditor":return this.queryEnabled("hasmetrics")&&K("EMBEDDED_TEMPLATE_NODE");case"comboToggleButton":return this.queryEnabled("addQuickTotals")&&(this.queryEnabled("toggleSubtotals")||K("SHOW_TOTALS"));case"hasmetrics":return !B.hasNoMetrics;case"tsubtotals":return K("ENABLE_SHOW_SUBTOTALS")&&K("EMBEDDED_TEMPLATE_NODE");case"edtResize":return B.isGrid&&this.queryEnabled("notEmptyTemplate");case"notEmptyTemplate":case"swapAxes":return(B.gridStructureInfo!=null&&K("EMBEDDED_TEMPLATE_NODE"))?!B.gridStructureInfo.isEmptyTemplate:false;case"attForms":return K("ENABLE_MODIFY_ATTRIBUTE_FORMS")&&B.gridStructureInfo&&B.gridStructureInfo.getAttributes()&&B.gridStructureInfo.getAttributes().length>0;case"fos":D=mstr.behaviors.featureResolver.featAvailable("is-not-single-row-report")&&this.queryEnabled("mdxOneSelection")&&B.selections;return(D!=null&&D.getSelectedDrillElementsCount&&D.getSelectedDrillElementsCount()>0&&D.anyAttributeElementSelected());case"b3dstyle":case"b3dweight":case"enabled3d":return(B.selectedPosition=="-9"&&B.selectedLevel=="8")||B.selectedPosition=="-99";case"fontprops":case"numberprops":case"alignprops":case"colorprops":return true;case"moveLeft":case"moveRight":case"moveUp":case"moveDown":return(B.selections!=null&&B.selections.allOnOneAxis());case"showRight":var D=B&&B.selections;if(D){var P=D.getSelectedCellsWithAttr("dg","true");if(P.length==0){return false;}P.sort(function(e,c){return(parseInt(e.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH))-parseInt(c.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH)));});var Z=P[P.length-1].getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH);var U=B.gridStructureInfo.getGridUnitInfoBySrc(P[P.length-1]);return U.index<(B.gridStructureInfo.allAxes[(U.axis==microstrategy.GRIDCELL_AXIS_METRICS)?0:U.axis].units.length-1);}return false;case"showLeft":var D=B&&B.selections;if(D){var P=D.getSelectedCellsWithAttr("dg","true");if(P.length==0){return false;}P.sort(function(e,c){return(parseInt(c.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH))-parseInt(e.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH)));});var Z=P[P.length-1].getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH);var U=B.gridStructureInfo.getGridUnitInfoBySrc(P[P.length-1]);return U.index>0;}return false;case"dmFilters":case"dmCancel":return mstrGridReport.isDesignMode();case"dmRun":case"dmSave":case"dmSaveAs":return mstrGridReport.isDesignMode()&&(B.gridStructureInfo!=null&&!B.gridStructureInfo.hasNoUnits);case"deList":case"deCalc":case"deSum":case"deAvg":case"deMin":case"deMax":case"deMinus":case"deDivide":case"editSelector":case"links":case"dynLinks":D=B.selections;var X=D.singleAttributeElementsAreSelected();var W=D.getSelectedItemCount();var V=!D.containsDerivedElements();var M=B.getSelectedUnit();var A={deList:X&&W>=1&&V,dynLinks:V||(!X&&W==1),deCalc:X&&W>1&&(V||!(M&&M.src.getAttribute("pthr"))),deSum:X&&W>1,deAvg:X&&W>1,deMin:X&&W>1,deMax:X&&W>1,deMinus:X&&W==2,deDivide:X&&W==2,editSelector:W==1,links:W>=1}[I];return D!=null&&A;case"WebHyperLinkEditor":case"showWebHyperLinkEditor":if(B.selections&&B.selections.getSelectedItemCount()==1){var S=B.selections.getItems();if(S&&S[0]){var N=S[0].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);return(N==microstrategy.DSSTYPE_METRIC||N==microstrategy.DSSTYPE_ATTRIBUTE||N==microstrategy.DSSTYPE_CONSOLIDATION||N==microstrategy.DSSTYPE_CUSTOM_GROUP);}}return false;case"showPageByHyperLinkEditor":return true;case"isGraph":return B.isGraph;case"graphEditor":return(G("grid-graph")||G("simple-graph"))&&B.isGraph;case"gridEditor":return(G("grid-graph")||G("number"))&&B.isGrid&&mstr.behaviors.featureResolver.featAvailable("enable-grid-format-editor");case"tbGridUnitSelector":case"tbGridValueSelector":return B.isGrid&&!B.isGraph;case"tbGraphUnitSelector":case"tbGraphValueSelector":return !B.isGrid&&B.isGraph;case"tbUnitSelector":case"tbValueSelector":return B.isGrid||B.isGraph;case"rmcDrilling":case"rmcPageByDrilling":case"mdxOneSelection":if(B.isMdxCube){D=B.selections;var W=D?D.getSelectedItemCount():0;var F=W==0;if(I=="rmcDrilling"||I=="mdxOneSelection"){F=W==1;if(!F&&B.gridStructureInfo&&B.gridStructureInfo.showAttForms){F=D&&D.getSelectedDrillElementsCount&&D.getSelectedDrillElementsCount()==1;}}return D!=null&&F;}if("rmcDrilling"==I){var Y=(B.selections&&B.selections.getItems())||[],H=Y[0];return H!=null&&H.getAttribute?H.getAttribute("emp")!="1":true;}return true;case"resizeEditor":return mstr.behaviors.featureResolver.resolveFeatSet("enable-resize-columns-rows;is-not-visualization-mode");case"vfeRWView":return !B.isVFEmpty;case"toggleHideNullsOrZeros":return mstrGridReport.isViewMode()&&K("EMBEDDED_TEMPLATE_NODE");default:return mstrGridStaticCommands.prototype.queryEnabled.call(this,I);}}catch(E){microstrategy.errors.log(E);return false;}};mstrGridCommands.prototype.queryState=function(E,B,AC){try{var O=this.parentBone;if(!AC&&((O.isGraph&&mstrGridStatic.isGraphCommand(E))||(O.graphSelected&&mstrGridStatic.isGridGraphCommand(E)))){var e=microstrategy.bone(O.id+"_graph");return e&&e.commands.queryState(E,B,AC);}var N=null;var W=mstrFormatObject;var z,x,L,e;var V=function(u){return O.isFeatureAvailable(microstrategy["FEATURE_"+u]);};var T=function(AD,u){return O.getGridFormatValue({unit:O.gridUnitFormat,format:O.gridValueFormat},AD,u);};var n=O.selections;switch(E){case"isGraphSelected":return O.graphSelected;case"isLocked":var q=O.gridStructureInfo.findUnit(B);return(q)?q.isLocked:false;case"existSelectedUnits":return(n&&n.getSelectedUnitsCount()>0);case"selectedTarget":return(n)?n.getSelectedGridTarget():null;case"selectedLevel":return(n)?n.getSelectedGridLevel():null;case"selected":case"SubType":if(O.isWidget){return mstrGridReport.desp("4921");}switch(parseInt(O.effectiveView)-1){case microstrategy.GRID_EFFECTIVE_VIEW_GRAPH:return mstrGridReport.desp("3479");case microstrategy.GRID_EFFECTIVE_VIEW_GRID_GRAPH:return mstrGridReport.desp("3702");default:return mstrGridReport.desp("3624");}case"isOnGrid":var a=O.gridStructureInfo.buildGridUnitInfo(B);return(O.gridStructureInfo.findUnitInfo(a)!=null);case"getRowHeight":return O.colWidths.getRowHeight();case"getGridWidthsObj":if(O.colWidths==null){O.setupColResize();}return O.colWidths!=null?O.colWidths.getColWidthsObj():null;case"selectedGrid":return O.elem;case"tbanding":return O.checkBanding;case"checkLockRowHeader":return V("CHECK_LOCK_ROW_HEADERS");case"checkLockColHeader":return V("CHECK_LOCK_COLUMN_HEADERS");case"checkMergeRowHeader":return V("CHECK_MERGE_ROW_HEADER")||this.queryState("tOutline");case"checkMergeColHeader":return V("CHECK_MERGE_COL_HEADER");case"tsubtotals":case"checkSubtotals":return V("CHECK_SHOW_SUBTOTALS");case"tOutline":return V("CHECK_OUTLINE_MODE");case"checkBanding":case"enableLegends":case"enableLabels":case"allowedGraphTypes":case"styleName":return O[E];case"assoNodesDrill":var C={assoNodesDrill:"1"}[E];return("associatedNodes" in O)?O.associatedNodes[C]:false;case"target":return O.selectedAxis+","+O.selectedPosition+","+O.selectedUnit;case"level":return O.selectedLevel;case"autostyle":return O.autostyleId||"custom";case"selectedVisualization":var o=[];var S=-1;var G=O.visualizationList;if(G&&G.length>0){for(z=0;z<G.length;z++){if(O.selectedVisualization==G[z].name){S=z;}o.push({dssid:G[z].name+"|"+G[z].vm,n:G[z].desc});}return{items:o,value:G[S].name+"|"+G[S].vm};}return{items:[]};case"toggleThresholds":case"ShowThreshold":return O.thresholdsState;case"toggleAttributeForms":case"toggleattforms":return O.showAttForms;case"fittocontent":return(O.gridWidthInfo)?O.gridWidthInfo.colScenario==mstrGridReport.COL_WIDTH_FIT_TO_CONTENT:false;case"fittowindow":return(O.gridWidthInfo)?O.gridWidthInfo.colScenario==mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY:false;case"objBrowser":N=microstrategy.bone("accordion_AccordionTabManagerStyle");return(N&&N.currentTabName==microstrategy.ACCORDION_REPORT_RP_OBJECT_PANEL);case"allObjects":N=microstrategy.bone("accordion_AccordionTabManagerStyle");return(N&&N.currentTabName==microstrategy.ACCORDION_REPORT_ALL_OBJECT_PANEL);case"pageBy":N=microstrategy.bone("pbb_PageByStyle");return(N&&isInDocument(N.elem));case"reportFilter":N=microstrategy.bone("rfe_pane");return(N&&isInDocument(N.elem));case"viewFilter":N=microstrategy.bone("vfep_pane");return(N&&isInDocument(N.elem));case"promptDetails":N=microstrategy.bone("promptDetails_PromptDetailsStyle");return(N&&isInDocument(N.elem));case"simpleThresholds":N=microstrategy.bone("edtReportSimpleThresholds_SimpleThresholdsReportEditorStyle");return(N&&isInDocument(N.elem));case"formatToolbar":return(microstrategy.bone("reportFormatToolbar"))?true:false;case"gridPosition":case"gridFactor":var c=microstrategy.findAncestor(O.elem.parentNode);if(c){return(E=="gridPosition")?mstrGridReport.styAttrValue(c,"GRID_POS"):mstrGridReport.styAttrValue(c,"GRID_AREA_PCT");}break;case"selections":var P=n&&n.lastSelectionIsFromToolbar&&n.lastSelectionIsFromToolbar();var H=O.gridUnitFormat;var Q=O.gridValueFormat;var U=(H!=-1)&&(Q!=-1);if(P&&U){return"{ src: true, unit: "+H+", value: "+Q+" }";}else{return(n&&n.getSelections)?n.getSelections():null;}case"graphSelections":var K="'graphSelected':"+(O.graphSelected?"true":"false");if(O.graphSelected&&O.selectedGraphUnit&&O.selectedGraphTargetValue){K+=",'graphSelectedUnit':'"+O.selectedGraphUnit+"','graphSelectedValue':'"+O.selectedGraphTargetValue+"'";}return"{"+K+"}";case"selectedDrillElements":return(n!=null&&n.getSelectedDrillElements)?n.getSelectedDrillElements():"";case"dmFilters":return O.isFilterVisible;case"ShowDrillingOptions":return V("SHOW_GRID_OPTIONS_DRILL");case"RHS":case"RHM":case"RHL":case"CHS":case"CHM":case"Outline":case"Banding":case"ShowThreshold":case"TitleOverlap":case"enableAttForms":case"enableThresholds":return("editorProperties" in O&&O.editorProperties[E]==microstrategy.TRUE);case"CHL":return("editorProperties" in O&&O.editorProperties[E]!==microstrategy.FALSE);case"HideNullsOrZeros":return O.ShowAllRows===microstrategy.FALSE;case"HideNullZeroValues":return O.HideNullZeroValues;case"AttForms":case"DrillOptions":return("editorProperties" in O)?O.editorProperties[E]:"";case"isShowHeadersAvailable":return(mstrGridReport.isRWD());case"isMergeHeadersAvailable":return this.queryState("isGridFormattingEnabled");case"isLockHeadersAvailable":return O.isFeatureAvailable("lock-grid-headers");case"isNonLinkedTemplate":return !this.queryState("isLinkedTemplate");case"Shortcut":case"isLinkedTemplate":return !V("EMBEDDED_TEMPLATE_NODE");case"isGridFormattingEnabled":return(microstrategy.EXECUTION_SCOPE!=microstrategy.REPORT_EXECUTION||O.isFeatureAvailable("enable-grid-format-editor"));case"DataSource":return O.gridStructureInfo.dataSetId;case"effectiveView":return O.effectiveView;case"areGridFormatsReady":return(O.getGridFormats()!=null);case"getControlGroupByList":return O.ControlGroupByList;case"GraphExportOverflow":return O.xgovf;case"GraphExportOverflowSpacing":return O.xgovfs;case"togglePivot":return V("CHECK_SHOW_PIVOT_BUTTONS");case"toggleSort":return V("CHECK_SHOW_SORT_BUTTONS");case"toggleGraphZones":return V("CHECK_SHOW_GRAPH_ZONES");case"promptDetails":return !!microstrategy.bone("promptDetails_PromptDetailsStyle");case"viewFilter":return !!microstrategy.bone("vfep_pane");case"pageBy":return !!microstrategy.bone("pbb_PageByStyle");case"reportFilter":return !!microstrategy.bone("rfe_pane");case"drill":var F=document.getElementById("drillEditor_BeanGeneratedOutputStyle");return F&&F.hasChildNodes()&&F.firstChild.style.display!="none";case"comboToggleButton":case"toggleSubtotals":return V("CHECK_SHOW_SUBTOTALS");case"gridMode":return O.isGrid&&!O.isGraph&&!this.queryState("visFlashMode")&&!this.queryState("visAjaxMode");case"graphMode":return !O.isGrid&&O.isGraph&&!this.queryState("visFlashMode")&&!this.queryState("visAjaxMode");case"gridGraphMode":return O.isGrid&&O.isGraph&&!this.queryState("visFlashMode")&&!this.queryState("visAjaxMode");case"visFlashMode":return O.isVisualization&&O.visualizationMode==50;case"visAjaxMode":return O.isVisualization&&O.visualizationMode==51;case"XTabView":if(this.queryState("gridMode")){return"1";}if(this.queryState("graphMode")){return"2";}if(this.queryState("gridGraphMode")){return"3";}if(this.queryState("visFlashMode")){return"50";}if(this.queryState("visAjaxMode")){return"51";}return"1";case"GridSelections":return{unit:O.gridUnitFormat,value:O.gridValueFormat};case"AllGridUnitSelector":case"tbGridUnitSelector":case"GridUnitSelector":var A=mstr.behaviors.featureResolver.featAvailable;var R=!A("grid-graph-formatting")&&A("number-formatting");x=O.getGridUnitSelectorItems(R);var M=[];if(!R){M.push({dssid:mstrGridReport.ALL_UNITS,n:mstrGridReport.desp("4754"),cssClass:"ToolbarList UAC"},{dssid:mstrGridReport.ROW_UNITS,n:mstrGridReport.desp("2185"),cssClass:"ToolbarList URA"},{dssid:mstrGridReport.COL_UNITS,n:mstrGridReport.desp("2184"),cssClass:"ToolbarList UCA"});}M.push({dssid:mstrGridReport.METRIC_UNITS,n:mstrGridReport.desp("2460"),tp:parseInt(microstrategy.DSSTYPE_METRIC,10),cssClass:"ToolbarList UMA"});L={items:M.concat(x),value:O.gridUnitFormat,isFetching:!this.queryState("areGridFormatsReady")};if(E=="tbGridUnitSelector"&&L.value==-1){L.items.splice(0,0,{dssid:-1,n:mstrGridReport.desp("3625")});}return L;case"tbGridValueSelector":case"AllGridUnitValueSelector":case"GridUnitValueSelector":var y={items:[{dssid:5,n:mstrGridReport.desp("2461")},{dssid:1,n:mstrGridReport.desp("2033")},{dssid:2,n:mstrGridReport.desp("2175")}],value:O.gridValueFormat,isFetching:!this.queryState("areGridFormatsReady")};if(E=="tbGridValueSelector"&&y.value==-1){y.items.splice(0,0,{dssid:-1,n:mstrGridReport.desp("3625")});}var m=O.getSelectedGridUnitByIndex(O.gridUnitFormat);if(O.gridUnitFormat==mstrGridReport.METRIC_UNITS||(m&&m.dssType==microstrategy.DSSTYPE_METRIC)){return y;}y.items=y.items.concat([{dssid:3,n:mstrGridReport.desp("2034")},{dssid:4,n:mstrGridReport.desp("2035")}]);return y;case"tbGraphUnitSelector":var J=microstrategy.bone(O.id+"_graph");if(J){return J.commands.queryState(E);}return{items:[],value:""};case"tbUnitSelector":var AB={items:[],value:""};var D,I;var g=this;var Z=function(AE){var AF;var AD=(AE=="Grid");var AG=AD?"Graph":"Grid";var AH=AD?"3478":"3479";if(O["is"+AE]){if(O["is"+AG]){AB.items=AB.items.concat({dssid:"-1",n:mstrGridReport.desp(AH),cssClass:"ToolbarListH"});}AF=g.queryState("tb"+AE+"UnitSelector");for(var u in AF.items){AF.items[u].dssid+="**"+AE.toLowerCase();}AB.items=AB.items.concat(AF.items);}return AF;};I=Z("Grid");if(O.isFeatureAvailable("grid-graph-formatting")){D=Z("Graph");}O.setGraphSelected(O.graphSelected||!I);AB.value=O.graphSelected?(D?D.value+="**graph":AB.value):I.value+="**grid";return AB;case"tbValueSelector":if(O.graphSelected||!O.isGrid){return this.queryState("tbGraphValueSelector");}else{return this.queryState("tbGridValueSelector");}case"FillColor_vf":return(mstr.Enum.ColorPickerFlags.NO_COLOR+mstr.Enum.ColorPickerFlags.MORE_COLORS+mstr.Enum.ColorPickerFlags.GRADIENT_COLORS+mstr.Enum.ColorPickerFlags.USER_COLORS);case"lncolor_vf":return(mstr.Enum.ColorPickerFlags.MORE_COLORS+mstr.Enum.ColorPickerFlags.USER_COLORS);case"FillColor":return T("backgroundColor",true);case"FontColor":return T("color",true);case"Bold":return T("fontWeight",true)=="bold";case"Italic":return T("fontStyle",true)=="italic";case"Underline":var h=T("textDecoration",true);return(h&&h.indexOf("underline")>-1);case"FontSize":return W.encodeValue("fontSize",T("fontSize",true));case"FontFamily":return T("fontFamily",true);case"TextAlign":var Y=T("textAlign",true);if(Y in [3,4,2]){return{3:2,4:1,2:0}[Y];}return -1;case"borders":return T("borders",false);case"toggleReportBar":var X=document.getElementById("report_toolbar");return X&&X.childNodes.length!=0;case"forwardPicker":return O.forwardHistory;case"backPicker":return O.backHistory;case"toggleHideNullsOrZeros":return this.queryState("HideNullsOrZeros");default:return mstrGridStaticCommands.prototype.queryState.call(this,E,B);}}catch(AA){microstrategy.errors.log(AA);}return"";};mstrGridCommands.prototype.queryVisible=function(A){var D=this.parentBone;switch(A){case"visFlashMode":case"visAjaxMode":if(!D.visualizationsEnabled){return false;}var B=D.visualizationList;for(var C=0;C<B.length;C++){if(B[C].vm==((A=="visFlashMode")?50:51)){return true;}}return false;case"toggleGraphZones":return D.isGraph;case"selectedVisualization":if(!D.visualizationsEnabled){return false;}var B=D.visualizationList;if(B){return B.length>1;}return false;case"tbGridUnitSelector":case"tbGridValueSelector":return D.isGrid&&!D.isGraph;case"tbGraphUnitSelector":case"tbGraphValueSelector":return !D.isGrid&&D.isGraph;case"tbUnitSelector":case"tbValueSelector":return(D.isGrid||D.isGraph)&&!D.isVisualization;case"drillEditor":return mstr.behaviors.featureResolver.resolveFeatSet("drill-editor;enable-drill-editor;is-not-visualization-mode;show-filter-on-selections-checks");case"drill":return mstr.behaviors.featureResolver.resolveFeatSet("drill-editor;enable-drill-editor;is-not-visualization-mode;!show-filter-on-selections-checks");default:if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(A)){if(D.isGrid&&D.isGraph){var E=microstrategy.bone(D.id+"_graph");return E&&E.commands.queryVisible(A);}}return mstrGridStaticCommands.prototype.queryVisible.call(this,A);}};function mstrGridCommands(A){this.parentBone=A;return this;}mstrGridInfo.prototype={};mstrGridInfo.prototype.dataSetId="";mstrGridInfo.prototype.hasNoUnits=true;mstrGridInfo.prototype.isEmptyTemplate=true;mstrGridInfo.prototype.hasMetrics=false;mstrGridInfo.prototype.metricsAxis=-1;mstrGridInfo.prototype.metricsDepth=-1;mstrGridInfo.prototype.showAttForms=false;mstrGridInfo.prototype.showColHeaders=true;mstrGridInfo.prototype.showRowHeaders=true;mstrGridInfo.prototype.metricAxis=null;mstrGridInfo.prototype.rowAxis=null;mstrGridInfo.prototype.colAxis=null;mstrGridInfo.prototype.pageAxis=null;mstrGridInfo.prototype.allAxes=[];mstrGridInfo.prototype.overlapGridTitles=false;mstrGridInfo.prototype.emptyCase=false;mstrGridInfo.prototype.toString=function(){return"";};mstrGridInfo.prototype.enableColWidths=function(){try{return(this.rowAxis.size()>0||this.colAxis.size()>0||this.metricsAxis==microstrategy.GRIDCELL_AXIS_PAGE_BY);}catch(A){microstrategy.errors.log(A);return false;}};mstrGridInfo.prototype.useExtraColTag=function(){try{return(this.rowAxis.size()==0&&this.colAxis.size()==0&&this.metricsAxis==microstrategy.GRIDCELL_AXIS_PAGE_BY);}catch(A){microstrategy.errors.log(A);return false;}};mstrGridInfo.prototype.hasNonMetricUnitsOnAxis=function(B){try{var C=false;if(!this.isEmptyTemplate&&B!=null){var A=this.getAxisFromType(B);if(A!=null){var D=A.size();if(D>0&&(D>1||this.metricsAxis!=B)){C=true;}}}return C;}catch(E){microstrategy.errors.log(E);return false;}};mstrGridInfo.prototype.getAttributes=function(){try{var A=[];for(var E=0,D=this.allAxes.length;E<D;E++){var H=this.allAxes[E];for(var B=0,F=H.size();B<F;B++){var C=H.units[B];if(C!=null&&C.dssType==microstrategy.DSSTYPE_ATTRIBUTE){A.push(H.units[B]);}}}return A;}catch(G){microstrategy.errors.log(G);return null;}};mstrGridInfo.prototype.getFixedColumns=function(){try{if(!this.showRowHeaders){return 0;}var A=(this.parentBone.isOutlineMode)?this.rowAxis.size():this.rowAxis.totalSize();if(this.showColHeaders&&(this.colAxis.size()>0)&&!this.overlapGridTitles){A++;}return A;}catch(B){microstrategy.errors.log(B);return -1;}};mstrGridInfo.prototype.getFixedRows=function(){try{var A=0;if(this.showColHeaders){A=this.colAxis.totalSize();A=(A==0)?1:A;}else{A=util_getFixedRows(this.parentBone.gridTable);}return A;}catch(B){microstrategy.errors.log(B);return -1;}};mstrGridInfo.prototype.getAxisFromType=function(B){var A=null;switch(B){case microstrategy.GRIDCELL_AXIS_ROWS:A=1;break;case microstrategy.GRIDCELL_AXIS_COLUMNS:A=2;break;case microstrategy.GRIDCELL_AXIS_PAGE_BY:A=3;break;}return A&&this.allAxes[A];};mstrGridInfo.prototype.unitTypeExistsOnAxis=function(I,D){try{var E=false;if(!this.isEmptyTemplate&&I!=null){var H=this.getAxisFromType(I);if(H!=null){for(var F=0,A=H.units.length;F<A;F++){if(H.units[F]!=null){for(var C=0,G=D.length;C<G;C++){if(H.units[F].dssType==D[C]){return true;}}}}}}return E;}catch(B){microstrategy.errors.log(B);return null;}};mstrGridInfo.prototype.findUnit=function(E){try{var A=null;for(var C=0,B=this.allAxes.length;C<B;C++){A=this.allAxes[C].findUnit(E);if(A!=null){break;}}return A;}catch(D){microstrategy.errors.log(D);return null;}};mstrGridInfo.prototype.findUnitInfo=function(B){try{var A=null;if(B.dssType!=microstrategy.DSSTYPE_ATTRIBUTE_FORM){A=this.findUnit(B.dssId);}else{var D=this.findUnit(B.parentDssId);if(D){if(D.hasAttForms()){A=D.attForms.findUnit(B.dssId);}else{if(D.attFormId==B.dssId){A=D;}}}}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrGridInfo.prototype.getUnitIndex=function(C,F,E){try{var A=0;var B=function(G){if(G>1){A+=G-1;}};if(C==microstrategy.GRIDCELL_AXIS_ROWS){A+=this.rowAxis.unitLength(F);B(E);if(this.metricsAxis==microstrategy.GRIDCELL_AXIS_ROWS&&this.metricsDepth<=F){A+=this.metricAxis.size()-1;}return A;}if(C==microstrategy.GRIDCELL_AXIS_COLUMNS){A+=this.rowAxis.headerSize();if(this.metricsAxis==microstrategy.GRIDCELL_AXIS_ROWS){A--;A+=this.metricAxis.size();}A+=this.colAxis.unitLength(F);B(E);if(this.metricsAxis==microstrategy.GRIDCELL_AXIS_COLUMNS&&this.metricsDepth<=F){A+=this.metricAxis.size()-1;}return A;}if(C==microstrategy.GRIDCELL_AXIS_METRICS){if(this.metricsAxis==microstrategy.GRIDCELL_AXIS_ROWS){A+=this.metricsDepth;B(F);return A;}if(this.metricsAxis==microstrategy.GRIDCELL_AXIS_COLUMNS){A+=this.rowAxis.size();A+=this.metricsDepth;B(F);return A;}}}catch(D){microstrategy.errors.log(D);}return null;};mstrGridInfo.prototype.getMaxAxisPosition=function(A){try{if((A==microstrategy.GRIDCELL_AXIS_METRICS)&&mstrGridReport.isViewMode()){return this.parentBone.metricsCount+1;}return(A==microstrategy.GRIDCELL_AXIS_METRICS)?this.allAxes[0].size()+1:this.allAxes[A].size()+1;}catch(B){microstrategy.errors.log(B);return null;}};mstrGridInfo.prototype.getGridUnitInfo=function(M,K){try{var D=microstrategy.GRIDCELL_AXIS_METRICS;var L=function(O){return M.getAttribute(microstrategy["HTMLATTR_"+O]);};var I=L("SUBOBJTYPE");var G=L("DSS_TYPE");if(!mstrGridReport.isMetric(G,(I==microstrategy.SUBOBJTYPE_METRIC&&G==microstrategy.DSSTYPE_PROMPT))){D=parseInt(L("GRIDCELL_AXIS"));}var B=null;if(K==undefined||K){B=Math.max(parseInt(this.getAttrFormPos(M)),1);}var C=L("DSS_ID");var A=C&&this.findUnit(C);var H=null;if(mstr.utils.String.isEmpty(A)){if(M.getAttribute("MH")&&M.getAttribute("MH").toLowerCase()=="true"){var N=this.allAxes[D].units;for(var F=0;F<N.length;F++){if(N[F].isMetricTemplateUnit){return N[F];}}}else{H=L("GRIDCELL_DEPTH");}}else{H=A.depth;}var J=this.getUnit(D,parseInt(H),B);if(!J){J=A;}return J;}catch(E){microstrategy.errors.log(E);return null;}};mstrGridInfo.prototype.getGridUnitInfoBySrc=function(F){var C=microstrategy.GRIDCELL_AXIS_METRICS;var G=function(H){return F.getAttribute(microstrategy["HTMLATTR_"+H]);};var A=G("SUBOBJTYPE");var B=G("DSS_TYPE");if(!mstrGridReport.isMetric(B,(A==microstrategy.SUBOBJTYPE_METRIC&&B==microstrategy.DSSTYPE_PROMPT))){C=parseInt(G("GRIDCELL_AXIS"));}subDepth=Math.max(parseInt(this.getAttrFormPos(F)),1);var E=this.getUnitByLocation(C,parseInt(G("GRIDCELL_DEPTH")),subDepth);if(!E){var D=G("DSS_ID");E=D&&this.findUnit(D);}return E;};mstrGridInfo.prototype.getUnitByLocation=function(B,E,A){try{var D=null;var G=(B==microstrategy.GRIDCELL_AXIS_METRICS)?0:B;var H=this.allAxes[G];if(H!=null){var I=null;for(var F in H.units){var J=H.units[F];if(J.depth==E){I=J;J.index=F;break;}}D=(I&&I.hasAttForms()&&A!=null&&A>0&&I.attForms.size()>=A)?I.attForms.units[A-1]:I;}return D;}catch(C){microstrategy.errors.log(C);return null;}};mstrGridInfo.prototype.getUnit=function(D,H,G){try{var A=null;var B=(D==microstrategy.GRIDCELL_AXIS_METRICS)?0:D;var C=this.allAxes[B];if(C!=null&&C.size()>=H){var F=C.units[H-1];A=(F&&F.hasAttForms()&&G!=null&&G>0&&F.attForms.size()>=G)?F.attForms.units[G-1]:F;}return A;}catch(E){microstrategy.errors.log(E);return null;}};mstrGridInfo.prototype.getGridUnits=function(){try{var A=[];var G=new Array(this.rowAxis,this.colAxis,this.metricAxis);for(var D=0,C=G.length;D<C;D++){for(var B=0,E=G[D].size();B<E;B++){A.push(G[D].units[B]);}}return A;}catch(F){microstrategy.errors.log(F);return[];}};mstrGridInfo.prototype.getAxisObj=function(B){try{var A=(B.subtype==microstrategy.SUBOBJTYPE_METRIC&&B.dssType==microstrategy.DSSTYPE_PROMPT);return((this.hasMetrics||(B.axis==this.metricAxis.axisType))&&(mstrGridReport.isMetric(B.dssType,A)))?this.metricAxis:this.allAxes[B.axis];}catch(C){microstrategy.errors.log(C);return null;}};mstrGridInfo.prototype.add=function(I,G){try{var K=this.getAxisObj(I);if(K){switch(I.subtype){case microstrategy.SUBOBJTYPE_ATTRIBUTE:if(I.isMetricTemplateUnit&&I.axis==microstrategy.GRIDCELL_AXIS_PAGE_BY){var H=this.buildPageByMetrics(I.src);for(var F=0,B=H.length;F<B;F++){this.metricAxis.add(H[F]);}}K.add(I);break;case microstrategy.SUBOBJTYPE_METRIC:if(!this.hasMetrics){var J=this.parentBone.metricsPosInGrid&&this.parentBone.metricsPosInGrid.split("A");if(!J||J.length<2){J=I.src.getAttribute("upt")&&I.src.getAttribute("upt").split(",");}if(J&&J.length>=2){var L=this.buildGridMetricsHeaderInfo(parseInt(J[0]),parseInt(J[1]));this.allAxes[parseInt(J[0])].add(L);}else{var L=this.buildGridMetricsHeaderInfo(I.axis,I.depth);K.add(L);}if(G){I.depth=1;}}I.axis=microstrategy.GRIDCELL_AXIS_METRICS;this.metricAxis.add(I);break;case microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM:L=K.findUnit(I.parentDssId);if(L==null){L=this.buildGridAttUnitInfoFromForm(I);K.add(L);}else{if(L.attForms.size()==0){var A=this.buildGridAttFormInfoFromUnit(L);L.attForms.add(A);}}var E=L.attForms.findUnit(I.dssId);if(E==null){L.attForms.add(I);}if(!L.attFormList){L.attFormList=new mstrAttFormListObj(null);}L.attFormList.addForm(I.dssId);for(var D=0,B=L.attForms.units.length;D<B;D++){L.attForms.units[D].attFormList=L.attFormList;}this.dataSetId=(I.dssSetId)?I.dssSetId:this.dataSetId;break;}if(this.parentBone.useClientSideManipulations){microstrategy.eventManager.notifyOrphanBones("ongriddatasourcechange");}}}catch(C){microstrategy.errors.log(C);}};mstrGridInfo.prototype.pivot=function(A,F){try{var E=this.getAxisObj(A);var B=this.getAxisObj(F);switch(A.subtype){case microstrategy.SUBOBJTYPE_ATTRIBUTE:case microstrategy.SUBOBJTYPE_METRIC:E.remove(A.depth);B.add(F);break;case microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM:var D=E.findUnit(A.parentDssId);if(A.axis!=F.axis||A.depth!=F.depth){D=E.remove(A.depth);E.setAxis(D,F.axis);E.setDepth(D,F.depth);B.add(D);}else{D.attForms.remove(A.subDepth);D.attForms.add(F);}break;}}catch(C){microstrategy.errors.log(C);}};mstrGridInfo.prototype.pivotUnit=function(I,H,J,F,D,G){try{var C=this.getUnit(I,H,J);var A=this.allAxes[I];var B=this.allAxes[F];A.remove(H);C.axis=F;C.depth=D;C.subDepth=G;B.add(C);}catch(E){microstrategy.errors.log(E);}};mstrGridInfo.prototype.remove=function(H){try{var J=this.getAxisObj(H);switch(H.subtype){case microstrategy.SUBOBJTYPE_ATTRIBUTE:J.remove(H.depth);if(H.isMetricTemplateUnit){this.allAxes[0]=this.metricAxis=new mstrGridAxisObj(this,microstrategy.GRIDCELL_AXIS_METRICS);}break;case microstrategy.SUBOBJTYPE_METRIC:J.remove(H.depth);if(this.metricAxis.size()==0){var I=this.metricsAxis==microstrategy.GRIDCELL_AXIS_ROWS?"rowAxis":"colAxis";if(this[I].size()>=this.metricsDepth){this[I].remove(this.metricsDepth);}}break;case microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM:var C=J.findUnit(H.parentDssId);var K=C.attForms;K.remove(H.subDepth);var A=K.size();if(A==0){J.remove(C.depth);}else{if(A==1){var G=C.depth;var F=this.buildGridAttUnitInfoFromForm(K.units[0]);J.remove(C.depth);J.add(F);C=F;}else{C.attFormName=K.units[0].alias;C.attFormId=K.units[0].dssId;}}C.attFormList.removeForm(H.dssId);for(var E=0,B=K.units.length;E<B;E++){K.units[E].attFormList=C.attFormList;}break;}}catch(D){microstrategy.errors.log(D);}};mstrGridInfo.prototype.swapAxes=function(){try{if(!this.isEmptyTemplate){var H=microstrategy.GRIDCELL_AXIS_ROWS;var L=microstrategy.GRIDCELL_AXIS_COLUMNS;var C=(!this.hasNonMetricUnitsOnAxis(H)||!this.hasNonMetricUnitsOnAxis(L));var E=(this.metricsAxis==H||this.metricsAxis==L);if(E&&!C){var F=this.metricsDepth;var B=this.getUnit(this.metricsAxis,this.metricsDepth,1);if(F==this.getAxisObj(B).size()){F=-1;}var I=this.metricAxis.clear();this.remove(B);}this.rowAxis.setEntireAxis(L);var K=this.rowAxis.clear();this.colAxis.setEntireAxis(H);var M=this.colAxis.clear();var G=this;var J=function(N){for(var P=0,O=N.length;P<O;P++){G.add(N[P]);}};J(K);J(M);if(E&&!C){var A=this.getAxisObj(B);if(F==-1||F>A.size()){B.depth=A.size()+1;}this.add(B);for(i=0,cnt=I.length;i<cnt;i++){this.add(I[i]);}}}}catch(D){microstrategy.errors.log(D);}};mstrGridInfo.prototype.init=function(B){try{var E=this;var C=function(F){return new mstrGridAxisObj(E,microstrategy["GRIDCELL_AXIS_"+F]);};this.rowAxis=C("ROWS");this.colAxis=C("COLUMNS");this.metricAxis=C("METRICS");this.pageAxis=C("PAGE_BY");this.allAxes=new Array(this.metricAxis,this.rowAxis,this.colAxis,this.pageAxis);this.emptyCase=(B.getAttribute("ept")=="-1");var A=this.parentBone;if(A.rowAxis||A.colAxis||A.pagebyAxis||A.metricsAxis){this.initFromProp();}else{this.initFromHTML(B);}this.initSharedCellProperties();this.isEmptyTemplate=(this.rowAxis.size()==0&&this.colAxis.size()==0);this.hasNoUnits=(this.isEmptyTemplate&&this.pageAxis.size()==0);}catch(D){microstrategy.errors.log(D);}};mstrGridInfo.prototype.initFromProp=function(){try{var H=this.parentBone;var G=new Array(H.rowAxis,H.colAxis,H.pagebyAxis,H.metricsAxis);for(var E=0,A=G.length;E<A;E++){var B=G[E];if(B!=null){for(var D=0,F=B.length;D<F;D++){var I=new mstrGridUnitInfo();I.populate(B[D],this);this.add(I);}}}}catch(C){microstrategy.errors.log(C);}};mstrGridInfo.prototype.initFromHTML=function(F){try{var H=F.getElementsByTagName("table")[0];var E=(H&&H.getAttribute("id")===(this.parentBone.id+"_gdz"));if(E){this.initFromGraphHtml(F);}else{this.initFromGridHtml(F);}if(mstrGridReport.isReport()){var D=document.getElementById("pbb_PageByStyle");if(!D){return ;}var A=D.getElementsByTagName("span");for(var C=0,B=A.length;C<B;C++){if(A[C].getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_PAGE_BY_ELEM){continue;}this.add(this.buildGridUnitInfo(A[C]));}}}catch(G){microstrategy.errors.log(G);}};mstrGridInfo.prototype.initFromGraphHtml=function(D){try{var A=D.getElementsByTagName("span");for(var C=0,B=A.length;C<B;C++){var F=A[C].getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS);if(!F){continue;}if(A[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.OBJTYPE_METRIC){this.hasMetrics=true;this.metricsAxis=F;}this.add(this.buildGridUnitInfo(A[C]));}}catch(E){microstrategy.errors.log(E);}};mstrGridInfo.prototype.initFromGridHtml=function(B){try{var I=B.getElementsByTagName("TBODY")[0];if(!I){return ;}if(mstrGridReport.isReport()){var L=this;I.onmouseover=function(Q){return L.parentBone.onmouseover(Q);};I.onmouseout=function(Q){return L.parentBone.onmouseout(Q);};}var J=0;outer:for(var H=0,C=I.rows.length;H<C;H++){var P=I.rows[H];if(P.getAttribute("o")!=null&&!this.parentBone.metricsOnRows){break;}for(var F=0,G=P.cells.length;F<G;F++){var N=P.cells[F];if(N.nodeType==1){var A=N.getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS);if(A!=null&&(N.getAttribute(microstrategy.HTMLATTR_DSS_ID)!=null||N.getAttribute("mh")=="TRUE")){var K=this.buildGridUnitInfo(N);var O=(K.subtype==microstrategy.OBJTYPE_METRIC);var M=(O)?M=this.findUnit(K.dssId):null;if(A==microstrategy.GRIDCELL_AXIS_ROWS&&O&&M){if(J==this.parentBone.metricsCount){break outer;}break;}if(!M){if(O&&A==microstrategy.GRIDCELL_AXIS_ROWS){J++;}this.add(K);if(this.colAxis.units&&this.colAxis.units[0]&&this.colAxis.units[0].src==null&&O){this.colAxis.units[0].src=K.src;this.colAxis.units[0].isVisible=true;this.colAxis.units[0].needBuildColMetricAreas=true;}}}}}}if(this.parentBone.hiddenUnitInfo){var D=new mstrGridUnitInfo();D.populate(this.parentBone.hiddenUnitInfo,this);this.add(D);}}catch(E){microstrategy.errors.log(E);}};mstrGridInfo.prototype.syncUnitSources=function(H,C,B){try{for(var E=0,D=this.allAxes.length;E<D;E++){for(var A=0,F=this.allAxes[E].size();A<F;A++){this.allAxes[E].units[A].populateUnitSrc(H,C,B);}}}catch(G){microstrategy.errors.log(G);}};mstrGridInfo.prototype.getAttValue=function(B,A,E){try{var D=B&&B.getAttribute(A);return(D?D:E);}catch(C){microstrategy.errors.log(C);return null;}};mstrGridInfo.prototype.getAttrFormPos=function(A){return this.getAttValue(A,microstrategy.HTMLATTR_FORM_POS,"1");};mstrGridInfo.prototype.getCellType=function(A){return this.getAttValue(A,microstrategy.HTMLATTR_GRID_CELL_TYPE,microstrategy.GRIDCELLTYPE_UNIT_VALUE);};mstrGridInfo.prototype.buildGridUnitInfo=function(A,C,V,G){try{var H=new mstrGridUnitInfo();if(A!=null){if(A.nodeType==1){var L=function(W){return A.getAttribute(microstrategy["HTMLATTR_"+W]);};H.subtype=L("SUBOBJTYPE");H.dssSubtype=L("DSS_SUBTYPE");var F=L("DESCRIPTION");H.alias=(F!=null)?trim(F):A.firstChild&&A.firstChild.data;if(!H.alias){H.alias="";}var T=L("DSS_DESCRIPTION");if(T!=null){H.description=T;}H.src=A;var S=microstrategy.SUBOBJTYPE_ATTRIBUTE;var M=microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM;var R=microstrategy.SUBOBJTYPE_METRIC;var N="|"+S+"|"+M+"|"+R+"|";function B(a,W){for(var Y=0,X=a.length;Y<X;Y++){var Z=new mstrGridUnitInfo();Z.axis=W.axis;Z.depth=W.depth;Z.subDepth=Y+1;Z.subtype=M;Z.dssSetId=W.dssSetId;Z.dssId=Z.attFormId=a[Y][mstrAttFormListObj.FORM_ID];Z.dssType=microstrategy.DSSTYPE_ATTRIBUTE_FORM;Z.alias=Z.attFormName=a[Y][mstrAttFormListObj.FORM_NAME];Z.parentDssId=W.dssId;Z.parentAlias=W.alias;Z.attFormList=W.attFormList;Z.isVisible=true;Z.src=W.src;W.attForms.add(Z);}}if(N.indexOf("|"+H.subtype+"|")>-1){H.axis=(C!=null)?parseInt(C):(H.subtype==microstrategy.OBJTYPE_METRIC)?microstrategy.GRIDCELL_AXIS_METRICS:parseInt(L("GRIDCELL_AXIS"));H.depth=(V!=null)?parseInt(V):parseInt(L("GRIDCELL_DEPTH"));H.subDepth=(G!=null)?parseInt(G):parseInt(this.getAttrFormPos(A));H.isMetricTemplateUnit=(A.getAttribute("MH")&&A.getAttribute("MH").toLowerCase()=="true");H.dssSetId=this.dataSetId;H.isLocked=(L("IS_LOCKED")==microstrategy.TRUE);if(H.subtype==M){H.dssId=H.attFormId=L("FORM_ID");H.dssType=microstrategy.DSSTYPE_ATTRIBUTE_FORM;H.parentDssId=L("DSS_ID");var O=H.alias;H.alias=H.attFormName=L("FORM_NAME");if(O.indexOf(H.alias)>-1){H.parentAlias=trim(O.substr(0,O.indexOf(H.alias)));}H.attFormList=new mstrAttFormListObj(L("FORM_LIST"));}else{if(!H.isMetricTemplateUnit){H.dssId=L("DSS_ID");H.dssType=L("DSS_TYPE");}if(H.subtype==S&&!H.isMetricTemplateUnit){H.attForms=new mstrGridAxisObj(null,0);var U=L("FORM_ID");var Q=L("FORM_NAME");if(U!=null&&Q!=null){H.attFormId=U;H.attFormName=Q;}H.attFormList=new mstrAttFormListObj(L("FORM_LIST"));if(!this.showAttForms||this.parentBone.isOutlineMode||this.parentBone.isStaticOutlineMode){var P=H.attFormList.getFormsOnView();if(P&&P.length>1){B(P,H);}}}}}else{H.dssId=L("DSS_ID");H.dssType=L("DSS_TYPE");H.dssSetId=(A.getAttribute("id"))?A.getAttribute("id").slice(0,32):"";H.axis=parseInt(C);H.depth=parseInt(V);H.isMetricTemplateUnit=false;if(H.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){H.attFormName=L("DESCRIPTION");H.attFormId=L("DSS_ID");H.attFormList=new mstrAttFormListObj(L("FORM_LIST"));var K=findTargetTag(A,"UL");if(K){var J=findTargetTag(K,"LI");if(J&&J.getElementsByTagName("span")[0]){var I=J.getElementsByTagName("span")[0];H.parentDssId=I.getAttribute(microstrategy.HTMLATTR_DSS_ID);H.parentAlias=I.getAttribute(microstrategy.HTMLATTR_DESCRIPTION);}}}else{if(H.dssType==microstrategy.DSSTYPE_ATTRIBUTE){H.attForms=new mstrGridAxisObj(null,0);H.attFormList=new mstrAttFormListObj(L("FORM_LIST"));H.attFormList.addDefaultForms();var D=H.attFormList.getDefaultForms();if(D.length<=1){for(i=0,cnt=D.length;i<cnt;i++){H.attFormName=D[i][mstrAttFormListObj.FORM_NAME];H.attFormId=D[i][mstrAttFormListObj.FORM_ID];}}else{B(D,H);}}}H.subDepth=1;if(mstrGridReport.isMetric(H.dssType)){H.subtype=R;}else{if(H.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){H.subtype=M;H.subDepth=parseInt(G);}else{H.subtype=S;}}}}}else{H.subtype=S;H.axis=C;H.depth=V;H.subDepth=1;H.dssSetId=this.dataSetId;}if(H.subDepth==null||isNaN(H.subDepth)){H.subDepth=1;}if(A&&A.getAttribute("olap")=="1"){H.olap=true;}return H;}catch(E){microstrategy.errors.log(E);return null;}};mstrGridInfo.prototype.buildFormSrcFromCM=function(H,K,C){try{var I=H.src;var A=I.getAttribute(microstrategy.HTMLATTR_DSS_ID);var G=I.getAttribute(microstrategy.HTMLATTR_FORM_LIST);var L=new mstrAttFormListObj(G);var B=(L!=null&&L.getFormsOnView()!=null)?L.getFormsOnView().length+1:"1";var D=document.createElement("td");var J=function(N,M){D.setAttribute(microstrategy["HTMLATTR_"+N],M);};J("IS_LOCKED",((H.isLocked)?microstrategy.TRUE:microstrategy.FALSE));J("SUBOBJTYPE",microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM);J("FORM_ID",C);J("DSS_ID",A);J("FORM_NAME",K);J("FORM_POS",B);J("FORM_LIST",G);var F;if(H.parentAlias!=null&&H.parentAlias.length>0){F=H.parentAlias;}else{if(H.alias!=null&&H.alias.length>0){F=H.alias;}}F+=" "+K;D.setAttribute(microstrategy.HTMLATTR_DESCRIPTION,F);return D;}catch(E){microstrategy.errors.log(E);return null;}};mstrGridInfo.prototype.buildGridAttUnitInfoFromForm=function(C){try{var A=this.buildGridUnitInfo(C.src,C.axis,C.depth,1);A.subtype=microstrategy.SUBOBJTYPE_ATTRIBUTE;A.alias=C.parentAlias;A.attForms=new mstrGridAxisObj(null,0);A.attForms.add(C);A.parentDssId="";A.parentAlias="";A.attFormName=C.alias;A.attFormId=C.dssId;A.attFormList=C.attFormList;A.dssId=C.parentDssId;A.dssType=microstrategy.DSSTYPE_ATTRIBUTE;A.isMetricTemplateUnit=false;A.dssSetId=C.dssSetId;A.isLocked=C.isLocked;return A;}catch(B){microstrategy.errors.log(B);return null;}};mstrGridInfo.prototype.buildGridAttFormInfoFromUnit=function(C){try{var A=this.buildGridUnitInfo(C.src,C.axis,C.depth,1);A.subtype=microstrategy.SUBOBJTYPE_ATTRIBUTE_FORM;A.alias=C.attFormName;A.attForms=null;A.parentDssId=C.dssId;A.parentAlias=C.alias;A.attFormName=C.attFormName;A.attFormId=C.attFormId;A.attFormList=C.attFormList;A.dssId=C.attFormId;A.dssType=microstrategy.DSSTYPE_ATTRIBUTE_FORM;A.isMetricTemplateUnit=false;A.dssSetId=C.dssSetId;A.isLocked=C.isLocked;return A;}catch(B){microstrategy.errors.log(B);return null;}};mstrGridInfo.prototype.buildGridMetricsHeaderInfo=function(B,D){try{var A=this.buildGridUnitInfo(null,B,D,1);A.subtype=microstrategy.SUBOBJTYPE_ATTRIBUTE;A.alias=mstrGridReport.desp("1158");A.attForms=null;A.parentDssId="";A.parentAlias="";A.attFormName="";A.attFormId="";A.attFormList="";A.dssId="";A.dssType="";A.isMetricTemplateUnit=true;A.isVisible=false;A.dssSetId=this.dataSetId;return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrGridInfo.prototype.buildPageByMetrics=function(A){try{var G=[];if(A){var H=A.getAttribute("mid");if(H){var I=H.split("~");for(var E=0,C=I.length;E<C;E++){var B=this.buildGridUnitInfo(null,microstrategy.GRIDCELL_AXIS_METRICS,E+1,1);var F=I[E].split("|");B.subtype=microstrategy.SUBOBJTYPE_METRIC;B.dssType=microstrategy.DSSTYPE_METRIC;B.dssId=F[0];B.alias=F[1];B.dssSetId=this.dataSetId;B.src=A;G.push(B);}}}return G;}catch(D){microstrategy.errors.log(D);return null;}};mstrGridInfo.prototype.axisUnitChange=function(){try{this.isEmptyTemplate=(this.rowAxis.size()==0&&this.colAxis.size()==0);this.hasNoUnits=(this.isEmptyTemplate&&this.pageAxis.size()==0);}catch(A){microstrategy.errors.log(A);}};mstrGridInfo.prototype.hasEmptyAxis=function(){try{return(this.rowAxis.size()==0||this.colAxis.size()==0||this.metricAxis.size()==0);}catch(A){microstrategy.errors.log(A);return false;}};mstrGridInfo.prototype.initSharedCellProperties=function(){var C=this.parentBone&&this.parentBone.hdrMvMap;if(C){this.valueCellProps={};for(var A in C){this.valueCellProps[A]={};var E=C[A];for(var G in E){var D=new mstrGridCellProps(this,A,parseInt(G)+1);for(var H in E[G]){if(E[G][H]){D[H]=E[G][H];}}if(!D.p){D.p=D.depth;if(A==="0"&&this.parentBone.currentPageX>0){var B=this.allAxes[0];for(var F in B.units){if(B.units[F].depth==D.depth){D.p=parseInt(F)+1;break;}}}}if(!D.tup){D.tup=D.depth;}this.valueCellProps[A][G]=D;}}}};mstrGridInfo.prototype.getGridCellProps=function getGridCellProps(A){if(!A){return ;}var B;if(typeof A=="string"){B=A;}else{B=A.getAttribute(microstrategy.HTMLATTR_GRIDCELL_ID);}var C=B&&B.split("A");if(C&&C.length==2&&!isNaN(C[0])&&!isNaN(C[1])&&this.valueCellProps){return this.valueCellProps[C[0]][parseInt(C[1])-1];}};function mstrGridInfo(A){this.parentBone=A;this.dataSetId=A.dSetId;this.showAttForms=A.showAttForms;this.showColHeaders=A.showColHeaders;this.showRowHeaders=A.showRowHeaders;this.overlapGridTitles=A.overlapGridTitles;return this;}mstrGridAxisObj.prototype={};mstrGridAxisObj.prototype.parentGridInfo=null;mstrGridAxisObj.prototype.axisType=-2;mstrGridAxisObj.prototype.units=null;mstrGridAxisObj.prototype.toString=function(E){try{if(E==null){E="";}if(this.size()>0){var C=E+"Axis "+this.axisType+"\n\n";for(var B=0,A=this.size();B<A;B++){C+=(this.units[B].hasAttForms())?this.units[B].attForms.toString("     "):this.units[B].toString(E);}return C;}else{return mstrGridReport.desp("2210");}}catch(D){microstrategy.errors.log(D);return -1;}};mstrGridAxisObj.prototype.clear=function(){try{var A=[];for(var B=0;B<this.size();B++){if(!this.units[B].isMetricsTemplateUnit){A.push(this.units[B]);}}this.units=[];return A;}catch(C){microstrategy.errors.log(C);return -1;}};mstrGridAxisObj.prototype.size=function(){try{return this.units.length;}catch(A){microstrategy.errors.log(A);return -1;}};mstrGridAxisObj.prototype.unitLength=function(B){try{return(this.parentGridInfo!=null&&this.parentGridInfo.showAttForms)?this.axisCellLength(B):B;}catch(A){microstrategy.errors.log(A);return -1;}};mstrGridAxisObj.prototype.get=function(A){try{if(A>this.size()-1){microstrategy.errors.log("Index out of bounds exception: Axis "+this.axisType+" doesn't contain an unit at the "+A+" index.");return null;}return this.units[A];}catch(B){microstrategy.errors.log(B);return null;}};mstrGridAxisObj.prototype.axisCellLength=function(D){try{var A=0;for(var B=0;B<D;B++){A+=(this.units[B]!=null&&this.units[B].hasAttForms())?this.units[B].attForms.size():1;}return A;}catch(C){microstrategy.errors.log(C);return -1;}};mstrGridAxisObj.prototype.headerSize=function(){try{return(this.parentGridInfo!=null&&this.parentGridInfo.showAttForms)?this.headerCellSize():this.size();}catch(A){microstrategy.errors.log(A);return -1;}};mstrGridAxisObj.prototype.headerCellSize=function(){try{return this.axisCellLength(this.size());}catch(A){microstrategy.errors.log(A);return -1;}};mstrGridAxisObj.prototype.totalSize=function(){try{var A=0;for(var D=0,C=this.size();D<C;D++){var B=this.units[D];A+=(B!=null&&B.hasAttForms())?B.attForms.size():1;}return A;}catch(E){microstrategy.errors.log(E);return -1;}};mstrGridAxisObj.prototype.findUnit=function(C){try{if(C==null){C="";}for(var B=0,A=this.units.length;B<A;B++){if(this.units[B].dssId==C){return this.units[B];}}return null;}catch(D){microstrategy.errors.log(D);return null;}};mstrGridAxisObj.prototype.add=function(D){try{var E=(this.axisType!=microstrategy.GRIDCELL_AXIS_ATT_FORMS)?D.depth:D.subDepth;if(E==-1){E=this.size()+1;if(this.axisType!=microstrategy.GRIDCELL_AXIS_ATT_FORMS){D.depth=E;}else{D.subDepth=E;}}if(D.dssType==microstrategy.DSSTYPE_HIERARCHY){var C=this.findUnit(D.dssId);if(C){C.lastHiSrc=D.src;return true;}}if(E>this.size()){var A=this.units.push(D);E=A;}else{this.updateDepth(E,1);this.units.splice(E-1,0,D);}if(this.axisType>microstrategy.GRIDCELL_AXIS_ATT_FORMS){this.setDepth(this.units[E-1],E);this.setAxis(this.units[E-1],this.axisType);}if(this.parentGridInfo!=null){if(D.isMetricTemplateUnit){this.updateMetricsInfo(E);}this.parentGridInfo.axisUnitChange();this.parentGridInfo.dataSetId=D.dssSetId;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrGridAxisObj.prototype.remove=function(C){try{this.updateDepth(C+1,-1);var A=this.units.splice(C-1,1)[0];if(this.parentGridInfo!=null){if(A.isMetricTemplateUnit){this.updateMetricsInfo(-1);}this.parentGridInfo.axisUnitChange();}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrGridAxisObj.prototype.updateMetricsInfo=function(C){try{if(this.parentGridInfo!=null){var D=(C!=-1);var A=this.parentGridInfo;A.hasMetrics=D;A.metricsAxis=D?this.axisType:-1;A.metricsDepth=D?C:-1;}}catch(B){microstrategy.errors.log(B);}};mstrGridAxisObj.prototype.updateDepth=function(E,C){try{if(this.axisType!=microstrategy.GRIDCELL_AXIS_ATT_FORMS){for(var F=E-1,A=this.units.length;F<A;F++){var H=this.units[F];if(H){H.depth=H.depth+C;if(H.hasAttForms()){for(var D=0,G=H.attForms.size();D<G;D++){H.attForms.units[D].depth=H.attForms.units[D].depth+C;}}}}var I=this.parentGridInfo;if(I.metricsAxis==this.axisType&&I.metricsDepth>=E){I.metricsDepth=I.metricsDepth+C;}}else{for(F=E-1,A=this.units.length;F<A;F++){this.units[F].subDepth=this.units[F].subDepth+C;}}}catch(B){microstrategy.errors.log(B);}};mstrGridAxisObj.prototype.setAxis=function(E,A){try{E.axis=A;if(E.hasAttForms()){for(var C=0,B=E.attForms.size();C<B;C++){E.attForms.setAxis(E.attForms.units[C],A);}}}catch(D){microstrategy.errors.log(D);}};mstrGridAxisObj.prototype.setEntireAxis=function(A){try{for(var C=0,B=this.size();C<B;C++){this.setAxis(this.units[C],A);}}catch(D){microstrategy.errors.log(D);}};mstrGridAxisObj.prototype.setDepth=function(D,E){try{D.depth=E;if(D.hasAttForms()){for(var B=0,A=D.attForms.size();B<A;B++){D.attForms.setDepth(D.attForms.units[B],E);}}}catch(C){microstrategy.errors.log(C);}};mstrGridAxisObj.prototype.getAxisUnitInfos=function(E){try{for(var B=0,A=this.units.length;B<A;B++){var D=this.units[B];var F=D.getSubAxis();if(this.parentGridInfo!=null&&this.parentGridInfo.showAttForms&&F!=null){E=F.getAxisUnitInfos(E);}else{E.push(D);}}return E;}catch(C){microstrategy.errors.log(C);return E;}};mstrGridAxisObj.prototype.setUnitSource=function(D){try{for(var B=0,A=this.units.length;B<A;B++){this.units[B].src=D;}}catch(C){microstrategy.errors.log(C);}};function mstrGridAxisObj(B,A){this.parentGridInfo=B;this.axisType=A;this.units=[];return this;}mstrGridUnitInfo.prototype={};mstrGridUnitInfo.prototype.axis=-9;mstrGridUnitInfo.prototype.depth=1;mstrGridUnitInfo.prototype.subDepth=1;mstrGridUnitInfo.prototype.alias="";mstrGridUnitInfo.prototype.description="";mstrGridUnitInfo.prototype.subtype="";mstrGridUnitInfo.prototype.isMetricTemplateUnit=false;mstrGridUnitInfo.prototype.dssSetId="";mstrGridUnitInfo.prototype.dssId="";mstrGridUnitInfo.prototype.dssType="";mstrGridUnitInfo.prototype.dssSubtype="";mstrGridUnitInfo.prototype.attForms=null;mstrGridUnitInfo.prototype.lastHiSrc=null;mstrGridUnitInfo.prototype.parentDssId="";mstrGridUnitInfo.prototype.parentAlias="";mstrGridUnitInfo.prototype.attFormName="";mstrGridUnitInfo.prototype.attFormId="";mstrGridUnitInfo.prototype.attFormList="";mstrGridUnitInfo.prototype.src=null;mstrGridUnitInfo.prototype.isVisible=true;mstrGridUnitInfo.prototype.isLocked=false;mstrGridUnitInfo.prototype.toString=function(C){try{C=C||"";var A="";for(var D in this){if(typeof (this[D])!="function"){A+=C+D+": "+this[D]+"\n";}}return(A+C+"___________________________\n");}catch(B){microstrategy.errors.log(B);return"";}};mstrGridUnitInfo.prototype.populate=function(C,A){try{for(var D in C){this[D]=C[D];}if(this.subtype==microstrategy.SUBOBJTYPE_ATTRIBUTE){this.attForms=new mstrGridAxisObj(null,0);}if(this.attFormList.length>0){this.attFormList=new mstrAttFormListObj(this.attFormList);}this.populateUnitSrc(A.parentBone.isGraph,A.parentBone.id,A.showAttForms);}catch(B){microstrategy.errors.log(B);}};mstrGridUnitInfo.prototype.populateUnitSrc=function(E,B,A){try{var F="";if(this.axis==microstrategy.GRIDCELL_AXIS_PAGE_BY){F="pbk"+this.depth;}else{F=B+"_"+this.axis+"_"+this.depth+"_";if(E&&mstrGridReport.isRWD()){F+="1";}else{F+=(!A&&this.subDepth>1)?"1":this.subDepth;}}var D=document.getElementById(F);if(D!=null){this.src=D;}else{this.isVisible=false;}}catch(C){microstrategy.errors.log(C);}};mstrGridUnitInfo.prototype.hasAttForms=function(){try{return(this.attForms!=null&&this.attForms.size()>0);}catch(A){microstrategy.errors.log(A);return false;}};mstrGridUnitInfo.prototype.getSubAxis=function(){try{return(this.hasAttForms())?this.attForms:null;}catch(A){microstrategy.errors.log(A);return false;}};mstrGridUnitInfo.prototype.getSubUnit=function(C){try{var A=this.getSubAxis();return(A!=null)?A.findUnit(C):null;}catch(B){microstrategy.errors.log(B);return false;}};function mstrGridUnitInfo(){return this;}mstrAttFormListObj.prototype={};mstrAttFormListObj.prototype.forms=null;mstrAttFormListObj.FORM_NAME=0;mstrAttFormListObj.FORM_ID=1;mstrAttFormListObj.FORM_STATUS=2;mstrAttFormListObj.IS_TEMPLATE_FORM=3;function mstrAttFormListObj(D){try{if(D!=null){this.forms=[];var C=D.split(unescape(UNIT_SEPARATOR));for(var B=0,A=C.length;B<A;B++){this.forms.push(C[B].split(unescape(mstrUpdateManager.ITEM_SEPARATOR)));}return this;}}catch(E){microstrategy.errors.log(E);}return null;}mstrAttFormListObj.prototype.toString=function(){try{if(this.forms!=null){var A=[];for(var C=0,B=this.forms.length;C<B;C++){A.push(this.forms[C].join(mstrUpdateManager.ITEM_SEPARATOR));}return A.join(UNIT_SEPARATOR);}}catch(D){microstrategy.errors.log(D);}return"";};mstrAttFormListObj.prototype.putForm=function(E,A){try{if(this.forms!=null){for(var C=0,B=this.forms.length;C<B;C++){if(this.forms[C][microstrategy.FORM_LIST_ID]==E){this.forms[C][microstrategy.FORM_LIST_STATUS]=A;break;}}}}catch(D){microstrategy.errors.log(D);}};mstrAttFormListObj.prototype.addForm=function(A){this.putForm(A,microstrategy.FORM_ON_VIEW);};mstrAttFormListObj.prototype.addDefaultForms=function(){try{var A=this.getDefaultForms();for(var C=0,B=A.length;C<B;C++){this.addForm(A[C][microstrategy.FORM_LIST_ID]);}}catch(D){microstrategy.errors.log(D);}};mstrAttFormListObj.prototype.removeForm=function(A){this.putForm(A,microstrategy.FORM_ON_WS);};mstrAttFormListObj.prototype.removeFormFromWS=function(A){this.putForm(A,microstrategy.FORM_NOT_ON_WS);};mstrAttFormListObj.prototype.getForms=function(F,D,A){try{if(this.forms!=null){F=[];for(var C=0,B=this.forms.length;C<B;C++){if(this.forms[C][mstrAttFormListObj[D]]==A){F.push(this.forms[C]);}}}return F;}catch(E){microstrategy.errors.log(E);return null;}};mstrAttFormListObj.prototype.getFormsOnView=function(){return this.getForms(null,"FORM_STATUS","1");};mstrAttFormListObj.prototype.getDefaultForms=function(){return this.getForms([],"IS_TEMPLATE_FORM",microstrategy.TRUE);};mstrGridCellProps.prototype={};mstrGridCellProps.prototype.getGridUnitInfo=function getGridUnitInfo(){return this.parentBone.getUnit(this.axis,this.p);};mstrGridCellProps.prototype.getCellUpt=function getCellUpt(){var A=this.getGridUnitInfo();if(mstrGridReport.isMetric(A.dssType)){return"-1,"+this.tup;}else{return this.axis+","+this.tup;}};mstrGridCellProps.prototype.getCellCx=function getCellCx(){return this.cx;};mstrGridCellProps.prototype.getAttColTitleMissing=function getAttColTitleMissing(){return this.ctm;};mstrGridCellProps.prototype.getCellDrillKey=function getCellDrillKey(){return this.dk;};mstrGridCellProps.prototype.getCellTooltip=function getCellTooltip(){return this.tp;};mstrGridCellProps.prototype.getCellDrillElement=function getCellDrillElement(D){var H;if(typeof D!="string"&&isNaN(D)){D=D.getAttribute&&D.getAttribute(microstrategy.HTMLATTR_GRIDCELL_ORDINAL);}if(!D){return ;}H=D.split(",");var F=this.getGridUnitInfo();if(F&&mstrGridReport.isMetric(F.dssType)){var E="";var C=this.parentBone;var G=this.nh.split(",");for(var B in G){if(B>0){E+=",";}var A=G[B].split("A");E+=C.valueCellProps[A[0]][parseInt(A[1])-1].getCellDrillElement(H[B]);}return E;}else{return this.axis+"A"+this.depth+"A"+H[0];}};function mstrGridCellProps(B,A,C){this.parentBone=B;this.axis=A;this.depth=C;return this;}mstrGridRWScript=true;var mstrGrid=mstrGridRW;var $ARR=mstrmojo.array;mstrGridRW.prototype=new mstrGridReport();mstrGridRW.prototype.quickSwitchCurrent=false;mstrGridRW.prototype.toolbarTimer=null;mstrGridRW.prototype.sliceID=null;mstrGridRW.prototype.gridUnitFormat=microstrategy.GRID_UNIT_CONTAINER;mstrGridRW.prototype.gridValueFormat=1;mstrGridRW.INC_FETCH_BAR_HEIGHT=26;mstrGridRW.prototype.hasFeature=function(A){return this.isFeatureAvailable(microstrategy["FEATURE_"+A]);};mstrGridRW.prototype.isModifyGridInDoc=function(){return this.hasFeature("MODIFY_GRID_LEVEL_IN_DOCUMENTS");};mstrGridRW.prototype.onload=function(){try{if(mstrGridReport.isDesignMode()){this.showEmptyAxis=true;}this.initObjId();var A=microstrategy.getViewerBone();var E=A&&A.commands&&A.commands.queryState("getCachedObjectFormatLevels");var G=this.objId;if(E&&E.id==G){this.gridUnitFormat=E.unit;this.gridValueFormat=E.value;}this.viewerId="rwb_viewer";var F=microstrategy.bone(this.viewerId);if(F){this.fp=this.fp||F.gridFP;this.bp=this.bp||F.gridBP;if(!this.itemFormats){var D=F.gridItemFormats;D=D||(F.gridItemFormats={});if(!D[G]){D[G]={};D[G][mstrPanelStack.FMT_TYPE_TITLE]=F.objProps.createFormatObject(microstrategy.SUBOBJTYPE_DOC_TEMPLATE,mstrGridReport.FMT_TYPE_TITLE);}this.itemFormats=D[G];}if(!this.hasFeatures()){for(var G in F.gridFeatures){this.features[G]=F.gridFeatures[G];}}}mstrGridReport.prototype.onload.call(this);this.initHiliteForSelectors();if(mstrGridReport.allowEdit()){E=findTarget(this.elem,microstrategy.HTMLATTR_OBJTYPE);if(mstrGridReport.styAttrValue(E,"SHOW_WINDOW_TITLE")!=microstrategy.TRUE&&!(this.visualizationMode==50&&!this.docViewer.isEditableViewModeEplus())){this.elem.onmouseover=this.addBoneHandler(this.id,"onmouseover");this.elem.onmouseout=this.addBoneHandler(this.id,"onmouseout");}}if(this.curWgtId){this.buildWidgetPreview(this.curWgtId);}var C=mstr.$obj("dcmmID");if(C&&G){C.clearMenuItems(G);}}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.onunload=function(){if(this.gridSpan&&this.gridSpan.lastChild&&!this.gridSpan.lastChild.innerHTML){this.gridSpan.style.display="none";this.gridSpan.setAttribute("disp","none");this.callSectionResize();}var A=this.getDocSelections();var B=document.getElementById(this.objId);if(A&&B&&A.isSelected(B)){A.remove(B);}if(!this.isBoneInPage()){this.hideToolbar(true);}mstrGridReport.prototype.onunload.apply(this,arguments);};mstrGridRW.prototype.isDndMapping=function(){try{if(this.isVisualization&&!this.docViewer.isInteractiveViewModeEplus()){return false;}return mstrGridReport.prototype.isDndMapping.call(this);}catch(A){microstrategy.errors.log(A);return false;}};mstrGridRW.prototype.onreload=function(D){try{mstrGridReport.prototype.onreload.call(this,D);var C=this;window.setTimeout(function(){mstrStaticDocViewer.onUnitReload(C);},0);if(this.objId&&microstrategy.gridFormatCache&&microstrategy.gridFormatCache[this.objId]){delete microstrategy.gridFormatCache[this.objId];}this.getDocViewer().setNeedWidthAdjustment(true);if(this.elem){this.relinkToolbar();}else{var A=function(E){C.activeRWUnit["onmouse"+E]=null;};A("over");A("out");}}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.ondialogresize=function(A){};mstrGridRW.prototype.onnotifydrag=function(A,D,B){try{if(D.type==microstrategy.OBJTYPE_PAGE_BY){return ;}if((mstrGridReport.isViewMode())&&!this.isFeatureAvailable(microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE)&&!this.hasFeature("MODIFY_GRID_LEVEL_IN_DOCUMENTS")){return ;}mstrGridReport.prototype.onnotifydrag.apply(this,arguments);}catch(C){microstrategy.errors.log(C);}};mstrGridRW.prototype.onresize=function(){try{mstrGridReport.prototype.onresize.apply(this,arguments);var F=document.getElementById(this.objId);var C=this.getDocSelections();if(C&&F&&C.isSelected(F)){C.syncUp(F);}if(mstr.utils.ISIE7){var E=this.getDocViewer().doc.styleObj;var B=this.getGridContainerSpan();if((E&&E.getAttValue(B,"wm")==2)&&B){var A=this.gridTable.parentNode;if(this.gridTable&&A){B.style.width=A.scrollWidth+(A.offsetHeight-A.clientHeight)+"px";}}}}catch(D){microstrategy.errors.log(D);}};mstrGridRW.prototype.initMapper=function(){try{mstrGridReport.prototype.initMapper.call(this);if(this.maskFor){this.maskFor+=microstrategy.HTMLATTR_MASKFOR_DELIM+microstrategy.DSSTYPE_RPT_DEFINITION;}}catch(A){microstrategy.errors.log(A);}};mstrGridRW.prototype.getExecTarget=function(){try{this.getParentSubsection();return(this.parentSubsection!=null)?microstrategy.findAncestorBone(this,"mstrDocViewerImpl").doc.selections:null;}catch(A){microstrategy.errors.log(A);return null;}};mstrGridRW.prototype.processRightMouseClick=function(D,C){mstrGridReport.prototype.processRightMouseClick.call(this,D,C);var B=microstrategy.getContextMenuManager("RWM");if(B){var A=B.getMenu("rw_context_menu");if(A&&this.getDocSelections()){A.registerTrigger(this.elem,this.getDocSelections().path+".getTypes()");}}};mstrGridRW.prototype.ondrop=function(D,B){try{var A=B.getItems();if(this.dragSource.type==microstrategy.OBJTYPE_OBJBROWSER){if((microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE)&&!this.isModifyGridInDoc()){return ;}}if(this.isSingleDataSetSelected(B)){this.populateTemplateWithDataSet(A[0],B.shiftKey);return ;}mstrGridReport.prototype.ondrop.apply(this,arguments);}catch(C){microstrategy.errors.log(C);}};mstrGridRW.prototype.initGrid=function(){try{var B=microstrategy.findAncestor(this.elem.parentNode);if(B!=null){this.gridPosition=parseInt(mstrGridReport.styAttrValue(B,"GRID_POS"));this.gridArea=parseInt(mstrGridReport.styAttrValue(B,"GRID_AREA_PCT"))/100;}mstrGridReport.prototype.initGrid.call(this);}catch(A){microstrategy.errors.log(A);}};mstrGridRW.prototype.callSectionResize=function(){var B=this.activeRWUnit.parentNode;if(B&&B.getAttribute&&B.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_PANEL&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){var E=B.id;var D=this.docViewer.doc.subSectionsInSection;var A;for(A in D){if(RegExp(",?"+E+"(,|$)").test(D[A])){break;}}var C=this.docViewer.doc.sections[A].subsections[E];C.needToUpdateMaxContentHeight=true;C.forceGrowOnResize=true;C.adjustSubsectionHeight();C.forceGrowOnResize=false;}};mstrGridRW.getChildAtt=function(E,D,C,B){var A=B.charAt(0)=="_"?microstrategy["SUBOBJTYPE"+B]:B;return microstrategy.findChildWithAtt(E,D,microstrategy["HTMLATTR_"+C],A);};mstrGridRW.prototype.onpostload=function(){try{var B=this.getGridContainerSpan();if(B){this.titleBarObj=this.titleBarObj||mstrGridRW.getChildAtt(B,"DIV","SUBOBJTYPE","_CONTAINER_TITLEBAR");}var F=this.getDocViewer().doc.styleObj;if(F&&B){this.isTitleVisible=F.getAttValue(B,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE;if(this.gridSpan.getAttribute("disp")=="none"){this.gridSpan.style.display="block";this.callSectionResize();this.gridSpan.removeAttribute("disp");}this.isLocked=F.getAttValue(B,microstrategy.HTMLATTR_LOCKED)==microstrategy.TRUE;if(this.gridWidthInfo&&this.gridWidthInfo.colScenario==mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY&&this.gridTable){this.gridTable.style.tableLayout="auto";var E=this;window.setTimeout(function(){E.resizeLockSet(true);},1);if(mstr.utils.ISIE7&&this.gridTable.parentNode.clientWidth>0){this.gridTable.style.width=(this.gridTable.parentNode.clientWidth)+"px";}}if(mstr.utils.ISIE7&&this.gridTable&&this.gridTable.parentNode){var A=this.gridTable.parentNode;if(F.getAttValue(B,"hm")==2){var C=(A.offsetHeight-A.clientHeight);if(A.clientHeight>0&&C==16){A.style.height=A.offsetHeight+C+"px";}}if((F.getAttValue(B,"wm")==2)){B.style.width=A.scrollWidth+(A.offsetHeight-A.clientHeight)+"px";}}if(mstr.utils.ISIE7&&this.lockSet){this.elem.parentNode.style.position="relative";}}if(this.getDocViewer().adjustWidth){this.getDocViewer().adjustWidth();}mstrGridReport.prototype.onpostload.call(this);}catch(D){microstrategy.errors.log(D);}};mstrGridRW.prototype.onGridSelectionHandleMousedown=function(A){return true;};mstrGridRW.prototype.populateTemplateWithDataSet=function(D,E){try{var C=E?"2":"1";var A=D.getAttribute(microstrategy.HTMLATTR_DSS_ID);this.addAction(D,mstrUpdateManager.POPULATE_TEMPLATE_FROM_DATASET,this.beanPath,["2048032","2048033","2048012","2048135"],[A,"3",this.objId,C]);}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.getGraidentProperties=function(E,D,B){try{var A=mstrUpdateManager.UNIT_SEPARATOR;return E.getAttribute("id")+A+D.getPropertySetName(B)+A+D.getPropertyName(B)+A;}catch(C){microstrategy.errors.log(C);return null;}};mstrGridRW.prototype.applyGradientOnItem=function(H,C,L,M,K){try{var D=this.getGridContainerSpan();var J=mstrGridRW.getChildAtt(D,"DIV","SUBOBJTYPE","_CONTAINER_TITLEBAR");if(J&&H==mstrGridReport.FMT_TYPE_TITLE){var I;var B;if(J.getAttribute("gradientcolor")==null){I=this.getGraidentProperties(J,K,"backgroundColor");B=this.getFormatValue(H,"backgroundColor");}else{I=J.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+"Gradient"+mstrUpdateManager.UNIT_SEPARATOR;B=J.getAttribute("gradientcolor");}var E=L.split(",");var F=B.split(",");var A=function(N,O){return O[gradientUtil["GRADIENT_"+N+"_INDEX"]];};if(J.getAttribute("gradientcolor")){F=["#"+A("START_COLOR",F),"#"+A("END_COLOR",F),B,A("ANGLE",F),A("XOFFSET",F),A("YOFFSET",F)];}if(M){M.push(this.um.createEditPropsAction(D,D.getAttribute("id"),this.docViewer.beanPath,["backgroundColor","gradientColor","backgroundStyle","gradientAngle","gradientXOffset","gradientYOffset"],["#"+A("START_COLOR",E),"#"+A("END_COLOR",E),L,A("ANGLE",E),A("XOFFSET",E),A("YOFFSET",E)],F));}J.setAttribute("bgstyle","2");J.setAttribute("gradientcolor",L);gradientUtil.applyGradient(J,A("START_COLOR",E),A("END_COLOR",E),A("ANGLE",E),A("XOFFSET",E),A("YOFFSET",E),this.docViewer.doc.styleObj);}}catch(G){microstrategy.errors.log(G);}};mstrGridRW.prototype.buildWidgetPreview=function(D){try{if(!mstrGridReport.isDesignMode()){return ;}var A=this.widgetPreview;if(!D){if(A){A.className="";A.id="";A.setAttribute("title","");}}else{var C=microstrategy.getViewerBone().gridWidgets.lst[D].t;if(!A){A=document.createElement("img");A.src="../images/1ptrans.gif";this.widgetPreview=this.elem.parentNode.appendChild(A);}A.className="widgetPreview wdgtImg";A.id="mnuInsertWg"+D;A.setAttribute("title",C);}}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.relinkToolbar=function(D){try{var C=this.getDocSelections();if(this.sibBoneSelected()&&C.isOnlyOneGridSelected()&&(C.getActiveSectionIndex(C.getSelectedGrid())==C.getActiveSectionIndex(this.elem))){var B=document.getElementById("toolbar_"+this.id);if(B){this.boneSelected=true;this.toolbarShown=B.getAttribute("shown")==1;this.toolbar=B;}}}catch(A){microstrategy.errors.log(A);}};mstrGridRW.prototype.updatePortalTitle=function(D){try{if(this.titleBarObj){var B=mstrGridRW.getChildAtt(this.titleBarObj,"DIV","ID","titleBar");D=D||this.docViewer.doc.commands.queryState("PortalTitle");B.innerHTML=(D&&D.length>0)?D:this.dSetName;var A=(this.titleBarObj.getAttribute("gradientcolor"))?this.titleBarObj.getAttribute("gradientcolor").split(","):null;if(A){gradientUtil.applyGradient(this.titleBarObj,A[gradientUtil.GRADIENT_START_COLOR_INDEX],A[gradientUtil.GRADIENT_END_COLOR_INDEX],A[gradientUtil.GRADIENT_ANGLE_INDEX],A[gradientUtil.GRADIENT_XOFFSET_INDEX],A[gradientUtil.GRADIENT_YOFFSET_INDEX]);}}}catch(C){microstrategy.errors.log(C);}};mstrGridRW.prototype.toggleTitleBars=function(){try{var A=this.getGridContainerSpan();if(A){this.titleBarObj=this.titleBarObj||mstrGridRW.getChildAtt(A,"DIV","SUBOBJTYPE","_CONTAINER_TITLEBAR");}var D=this.titleBarObj;if(D){this.isTitleVisible?displayObj(D):removeObj(D);}else{if(this.isTitleVisible){D=this.titleBarObj=this.docViewer.doc.createTitleBar(null,"portal_"+this.id,{boneId:this.id,objKey:this.objId,treeType:this.treeType,displayMode:this.displayMode});D.style.height="auto";A.insertBefore(D,A.firstChild);insertDynamicScript("mstrPortalImpl",javaScriptPath+"mstrPortalImpl.js");var C=microstrategy.registerBone(D.id,"mstrPortalImpl",null);C.onload();this.updatePortalTitle();}}}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.showTitleBar=function(){return this.isTitleVisible||false;};mstrGridRW.prototype.isMode=function(A){return(this.currentView==microstrategy["DISPLAY_MODE_"+(A?A:"GRID_AND_GRAPH")]);};mstrGridRW.prototype.getView=function(){return(mstrGridReport.isDesignMode()||!this.isMode("GRAPH"))&&!(this.visualizationMode==50&&!this.docViewer.isEditableViewModeEplus());};mstrGridRW.prototype.onboneselected=function(A){try{if(!A||A.indexOf("|"+this.RWUnitId+"|")>-1){if(this.checkToolbarCondition()&&this.showTBSelected){var C=this.getDocSelections();if(this.sibBoneSelected()){if(C.getActiveSectionIndex(C.getSelectedGrid())==C.getActiveSectionIndex(this.elem)){this.boneSelected=true;if(this.getView()){this.showToolbarWithDelay(this.TIME_DELAY_SHOW_TOOLBAR);}}}}}}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.sibBoneSelected=function(){try{var A=this.getDocSelections();return(A&&(typeof (A.items[this.RWUnitId])!="undefined"));}catch(B){microstrategy.errors.log(B);return false;}};mstrGridRW.prototype.handleSiblingsQuickSwitch=function(){try{var A=document.getElementsByName(this.RWUnitId);var E=null;for(var C=0,B=A.length;C<B;C++){E=microstrategy.findRWObjectBone(A[C],this.isGridBone?"mstrGridRW":"mstrReportGraphImpl");if(E&&E.id!=this.id){E.handleQuickSwitch();}}}catch(D){microstrategy.errors.log(D);}};mstrGridRW.prototype.handleQuickSwitch=function(E){try{this.quickSwitchCurrent=false;var B=document.getElementsByName(this.RWUnitId+"_"+this.sliceID+"_container");var J=null;var I=function(N,M){return microstrategy.findRegisteredChildBone(N,"div",M);};for(var F=0,C=B.length;F<C;F++){J=B[F].getAttribute("view");if(J==this.currentView){var A=I(B[F],(J==microstrategy.DISPLAY_MODE_GRID)?"mstrGridRW":"mstrReportGraphImpl");removeObj(B[F]);A.hideToolbar(true);}}this.currentView=microstrategy["DISPLAY_MODE_"+(this.isMode("GRID")?"GRAPH":"GRID")];A.currentView=this.currentView;if(this.currentView==microstrategy.DISPLAY_MODE_GRID){A.toggleZonesEditor(null,false);}for(F=0,C=B.length;F<C;F++){J=B[F].getAttribute("view");if(J==this.currentView){var L=I(B[F],(J==microstrategy.DISPLAY_MODE_GRID)?"mstrGridRW":"mstrReportGraphImpl");var G=microstrategy["DISPLAY_MODE_"+(this.isGrid?"GRAPH":"GRID")];L.currentView=this.currentView;L.quickSwitchCurrent=true;L.updateViewMode(G);displayObj(B[F]);var H=L.mask&&L.mask.onmaskedobjectresize();if(A&&A.boneSelected){L.boneSelected=true;}L.attachToolbarEvents();if(E){L.showToolbar();}if(mstrGridReport.allowEdit()){if(!L.selections){L.initSelections&&L.initSelections(false);}}if(G==microstrategy.DISPLAY_MODE_GRID){window.setTimeout("microstrategy.bone('"+L.id+"'). resizeLockSet();",0);window.setTimeout("microstrategy.bone('"+L.id+"'). resizeLockSet();",0);}}}if(E){var K=[];L.handleViewMode(G,K,true);L.um.add(K);}}catch(D){microstrategy.errors.log(D);}};mstrGridRW.prototype.attachToolbarEvents=function(){try{if(this.getView()){this.activeRWUnit.onmouseover=this.addBoneHandler(this.id,"onmouseover");this.activeRWUnit.onmouseout=this.addBoneHandler(this.id,"onmouseout");}var B=this.titleBarObj;if(B&&B.id&&microstrategy.bone(B.id)){microstrategy.bone(B.id).attachEvents();}}catch(A){microstrategy.errors.log(A);}};mstrGridRW.prototype.showGridOptions=function(C){try{target=getEventTarget(C);var A=microstrategy.getContextMenuManager("RWM").getMenu("gridLocalDataMenu");if(!target.getAttribute("cx")){A.registerTrigger(target,null);}displayContextMenu(target,C,true);}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.onQuickSwitchClick=function(C){try{if(this.hasResized){var A=(this.isGrid)?microstrategy.DISPLAY_MODE_GRAPH:microstrategy.DISPLAY_MODE_GRID;var D=(this.isGrid)?"graphMode":"gridMode";this.commands.exec(D,A);}else{this.handleQuickSwitch(true);this.handleSiblingsQuickSwitch();this.notifySelectionChange("onselectionchange");}this.resetToolbar();}catch(B){microstrategy.errors.log(B);}finally{stopEventBubbling(C||window.event);}};mstrGridRW.prototype.onLinkDataset=function(){try{microstrategy.openFolderBasedBlockEditor("linkDatasetEditor","AddDatasetBlockLoader",null,{targetKey:this.objId,objectType:"2048,768,769,774"},{multiSelect:false},this);}catch(A){microstrategy.errors.log(A);}};mstrGridRW.prototype.synchronizeSize=function(){try{var E=this.getDocViewer().doc.styleObj;var D=microstrategy.getFormatObject();var C=this;var A=function(F){var G=D.decodeValue(F,E.getAttValue(C.activeRWUnit,microstrategy["HTMLATTR_"+F.toUpperCase()]));return parseFloat(G)-C.getBorderAdjust(F);};this.resizeGridAndGraph(A("height"),A("width"));}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.getBorderAdjust=function(F){try{var H=mstrFormatObject;var E=0;var A=this.getDocViewer().doc.styleObj;if(A.getAttValue(this.activeRWUnit,microstrategy.HTMLATTR_BORDER_3D_STYLE)=="1"){E=2*microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,A.getAttValue(this.activeRWUnit,microstrategy.HTMLATTR_BORDER_3D_WEIGHT));}else{var I=null;var C=(F=="width")?["bt","bb"]:["bl","br"];for(var G=0,B=C.length;G<B;G++){I=H.decodeValue("borderTopStyle",A.getAttValue(this.activeRWUnit,C[G]+"s"));if(I&&I!=""){var J=I.indexOf(" ");E+=parseInt(I.slice(0,J));}}E=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,E);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrGridRW.prototype.resizeGridAndGraph=function(D,G){try{var L=this.getTitleHeight();var A={el:null,height:Math.max(D-L,0),width:G};var I=mstr.utils.Hash.clone(A);if(this.isGrid&&this.isGraph){A.el=microstrategy.subObjectFind(this.activeRWUnit,["DIV"],microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE)||this.elem;I.el=microstrategy.objectFind(this.activeRWUnit,["IMG","INPUT"],microstrategy.OBJTYPE_GRAPH);var J=this.getDocViewer().doc.styleObj;var F=J.getAttValue(this.activeRWUnit,microstrategy.HTMLATTR_GRID_AREA_PCT)||50;var H=J.getAttValue(this.activeRWUnit,microstrategy.HTMLATTR_GRID_POS)||0;if(H==0||H==1){var E=Math.max((D*(F/100))-L,0);A.height=E;I.height=D-E;}else{var M=G*F/100;A.width=M;I.width=G-A.width;}}else{if(this.isGraph){I.el=microstrategy.objectFind(this.activeRWUnit,["IMG","INPUT"],microstrategy.OBJTYPE_GRAPH);}else{A.el=microstrategy.subObjectFind(this.activeRWUnit,["DIV"],microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE)||this.elem;}}if(A.el){this.setGridDimension(A.el,A.height,A.width);}if(I.el){this.setGraphDimension(I.el,I.height,I.width);this.setGridDimension(I.el.parentNode,I.height,I.width);}var K=microstrategy.findChildWithAtt(this.elem,"DIV","scriptclass","mstrFlashViewerImpl");if(K){var C=(mstr.utils.ISIE4)?K.getElementsByTagName("object"):K.getElementsByTagName("embed");if(C){C[0].width=A.width;C[0].height=A.height;}}this.onresize();if(this.isGridPostLoaded&&this.quickSwitch){this.hasResized=true;}}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.setGridDimension=function(B,D,A){try{if(B){var C=B.style;if(D!=null){C.height=C.height&&(Math.max(mstrGridRW.INC_FETCH_BAR_HEIGHT,(D||0)-(this.incfetchvisible?mstrGridRW.INC_FETCH_BAR_HEIGHT:0))+"px");}if(A!=null){C.width=C.width&&(Math.max((A||0),0)+"px");}}}catch(E){microstrategy.errors.log(E);}};mstrGridRW.prototype.setGraphDimension=function(D,B,A){try{if(D){D.height=B;D.width=A;if(this.docViewer.isEditableViewModeEplus()&&mstr.utils.ISFF){var E=D.src;D.src=E.replace(/graphHeight=0/,"graphHeight="+B);}}}catch(C){microstrategy.errors.log(C);}};mstrGridRW.prototype.checkToolbarCondition=function(){try{if(this.docViewer==null){this.getDocViewer();}if(this.docViewer){return this.docViewer.isInteractiveViewModeEplus()||(mstrGridReport.isDesignMode());}}catch(A){microstrategy.errors.log(A);}return false;};mstrGridRW.prototype.showToolbar=function(B){try{var H=document.getElementsByName(this.RWUnitId+"_"+this.sliceID+"_container");var A=null;var F=function(J,I){return microstrategy.findRegisteredChildBone(J,"div",I);};var E=this;for(var D=0,C=H.length;D<C;D++){A=H[D].getAttribute("view");if(A==this.currentView){E=F(H[D],(A==microstrategy.DISPLAY_MODE_GRID)?"mstrGridRW":"mstrReportGraphImpl");}}if(!this.toolbar){this.toolbar=document.getElementById("toolbar_"+this.id);}mstrRWUnitBoneImpl.prototype.showToolbar.call(E,B);}catch(G){microstrategy.errors.log(G);}};mstrGridRW.prototype.createToolbar=function(){try{mstrRWUnitBoneImpl.prototype.createToolbar.call(this);var E=this;var C=function(G,K,J,H){var I=null;I=document.createElement("div");I.setAttribute("id",E.id+G);I.className=K;if(H){I.setAttribute("title",mstrGridReport.desp(H));}I.onclick=E.addBoneHandler(E.id,J);E.toolbar.appendChild(I);};if(this.docViewer.isEditableViewModeEplus()&&this.hasFeature("MANAGE_DATASETS")){C("_DS","addDataset","onLinkDataset","3033");}if(this.isGrid&&this.isGraph&&this.isGridBone){var B=this.elem.id;var A=B+"_graph";var F=microstrategy.bone(A);if(F){F.createToolbar();this.toolbar=F.toolbar;}return ;}if(mstrGridReport.isDesignMode()||this.isMode()){return ;}if(this.docViewer.isInteractiveViewModeEplus()&&this.quickSwitch){C("_gridTb",this.isGridBone?"toGraph":"toGrid","onQuickSwitchClick",this.isGridBone?"3548":"3547");}}catch(D){microstrategy.errors.log(D);}};mstrGridRW.prototype.computeToolbarPos=function(){try{mstrRWUnitBoneImpl.prototype.computeToolbarPos.call(this);if(this.toolbar_pos_x+2<0||this.toolbar_pos_y<0){this.toolbar_pos_x=getObjSumLeft(this.activeRWUnit)-getObjSumLeft(this.docViewer.doc.elem);this.toolbar_pos_y=getObjSumTop(this.activeRWUnit)-this.docViewer.doc.top;}}catch(A){microstrategy.errors.log(A);}};mstrGridRW.prototype.getDocSelections=function(){try{var A=microstrategy.getViewerBone();return A&&A.doc&&A.doc.selections;}catch(B){microstrategy.errors.log(B);return null;}};mstrGridRW.prototype.switchToContainerSelectionMode=function(){try{var C=this.getDocSelections();var A=C&&C.remove(findTarget(this.elem,microstrategy.HTMLATTR_OBJTYPE));}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.switchToCellSelectionMode=function(){try{var B=this.getDocSelections();if(B){B.clear(true);B.add(findTarget(this.elem,microstrategy.HTMLATTR_OBJTYPE),true,false);}}catch(A){microstrategy.errors.log(A);}};mstrGridRW.prototype.getDocBone=function(){try{var A=microstrategy.getViewerBone();return A&&A.doc;}catch(B){microstrategy.errors.log(B);return null;}};mstrGridRW.prototype.ignoreGridMouseEvent=function(B){try{B=B||window.event;if(this.getDocBone()&&this.getDocBone().isInsertMode){B.cancelBubble=false;return true;}}catch(A){microstrategy.errors.log(A);}return false;};mstrGridRW.prototype.processMousedown=function(E,A){try{if(this.ignoreGridMouseEvent(E)){return false;}var C=this.getDocSelections();if(C){var D=findTarget(this.elem,microstrategy.HTMLATTR_OBJTYPE);if(E.ctrlKey&&C!=null&&!(C.length==1&&C.isSelected(D))){if(this.isGridInCellSelectionMode()){this.selections.clearAll(true);}return this.onGridSelectionHandleMousedown(E);}if(!this.isGridInCellSelectionMode()){this.switchToCellSelectionMode();}}mstrGridReport.prototype.processMousedown.apply(this,arguments);}catch(B){microstrategy.errors.log(B);}return null;};mstrGridRW.prototype.postmousedown=function(F,A){try{if(A&&this.selections!=null&&A.nodeName.toLowerCase()!="td"){var E=A.getAttribute("id");if(E!=null&&E==this.id){var C=this.getDocSelections();if(C){var D=findTarget(this.elem,microstrategy.HTMLATTR_OBJTYPE);return C.addToSelection(F,D);}return null;}}mstrGridReport.prototype.postmousedown.apply(this,arguments);}catch(B){microstrategy.errors.log(B);}return false;};mstrGridRW.prototype.applyAddQuickThresholds=function(){try{this.um.replaceURL("activeViewID",this.objId);mstrGridReport.prototype.applyAddQuickThresholds.call(this);}catch(A){microstrategy.errors.log(A);}};mstrGridRW.prototype.updateSelected=function(B,D,A){try{if(D==null||D=="none"){return ;}if(B!="0,-99,7"&&B!="0,-9,7"&&!this.isGridInCellSelectionMode()){this.switchToCellSelectionMode();}mstrGridReport.prototype.updateSelected.apply(this,arguments);}catch(C){microstrategy.errors.log(C);}};mstrGridRW.prototype.createDrillActions=function(F,G,E,C,B,H){try{if(H=="0"){var A=microstrategy.bone(this.viewerId);if(A){this.drillIframeEnabled=false;return this.um.createActionObject(this.elem,mstrUpdateManager.GRID_DRILL_OUTSIDE,microstrategy.servletName,["3141","3142","3144","3143","3146","3010","3151","3152"],[F,G,E,C,B,A.messageID,this.getGroupByElements(),this.sliceID],[]);}}return mstrGridReport.prototype.createDrillActions.apply(this,arguments);}catch(D){microstrategy.errors.log(D);}return null;};mstrGridRW.prototype.getGroupByElements=function(){try{var C="";var A=findTarget(this.elem,microstrategy.HTMLATTR_SCRIPTCLASS,"mstrDocSectionImpl");if(A!=null&&A.getAttribute("pbes")!=null){C=A.getAttribute("pbes");}return C;}catch(B){microstrategy.errors.log(B);return"";}};mstrGridRW.prototype.initHiliteForSelectors=function(){try{if(this.selectedElementsCount&&this.selectedElems&&parseInt(this.selectedElementsCount)>0){var B=this.controlLinks;if(B){for(var A in B){var D=B[A].ck;var C=getElementById(this.selectedElems[D]);if(C){this.hiliteCell[D]=C;this.hiliteObj(C,mstrGridReport.OPACITY_SELECTED,mstrGridReport.SELECTOR_HILITE_CLASS);}}}}}catch(E){microstrategy.errors.log(E);}};mstrGridRW.prototype.drillOutToFixedTemplate=function(C,E,F){try{var A=microstrategy.bone(this.viewerId);if(A){this.drillIframeEnabled=false;var B=A.messageID;action=this.um.createActionObject(this.elem,mstrUpdateManager.DRILL_OUT_TO_FIXED_TEMPLATE,microstrategy.servletName,["3149","3150","3146","3010","3151","3152"],[C,E,F,B,this.getGroupByElements(),this.sliceID?this.sliceID:0],[]);}if(this.drillOpenInNewWindow){this.um.newWindow=true;}this.um.useIframe=this.drillIframeEnabled;if(action){this.um.add([action]);this.um.flushAndSubmitChanges();this.um.acknowledgeRequest();}}catch(D){microstrategy.errors.log(D);}};mstrGridRW.prototype.getObjectValue=function(C,D,A){try{if(typeof (C)=="object"&&"unit" in C){return this.getGridFormatValue(C,D,A=="Format"?true:false);}else{if(C==="GRID"){if(this.gridUnitFormat==-1||this.gridValueFormat==-1){return null;}else{return this.getGridFormatValue({unit:this.gridUnitFormat,format:this.gridValueFormat},D,true);}}else{return mstrGridReport.prototype["get"+A+"Value"].apply(this,arguments);}}}catch(B){microstrategy.errors.log(B);}return null;};mstrGridRW.prototype.getAttValue=function(B,A){return this.getObjectValue(B,A,"Att");};mstrGridRW.prototype.getFormatValue=function(A,B){return this.getObjectValue(A,B,"Format");};mstrGridRW.prototype.isSingleDataSetSelected=function(A){try{if(A.length==1&&A.firstItem().getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_RPT_DEFINITION){return true;}}catch(B){microstrategy.errors.log(B);}return false;};mstrGridRW.prototype.getDNDHelperImage=function(C,A){try{if(A==null||A.length==0){return null;}if((C.type!=this.type||C.id==this.id)){if(this.isSingleDataSetSelected&&this.isSingleDataSetSelected(C.selections)&&A==this.id){return microstrategy.FOLDER_IMAGES+"1ptrans.gif";}return mstrGridReport.prototype.getDNDHelperImage.apply(this,arguments);}}catch(B){microstrategy.errors.log(B);}return null;};mstrGridRW.prototype.adjustGraphSize=function(C,D,H){try{if(!this.isGraph){return H;}C=C||"1";facotr=D||"50";var G=false;if(!H){H=[];G=true;}var A=microstrategy.findAncestor(this.elem.parentNode);if(A){var I=mstrGridReport.styAttrValue(A,"HEIGHT");var E=mstrGridReport.styAttrValue(A,"WIDTH");if(I&&E){var F=microstrategy.getFormatObject();I=parseInt(F.decodeValue("height",I));E=parseInt(F.decodeValue("width",E));if(this.isGrid){I=(C=="0"||C=="1")?parseInt(I*(100-D)/100):I;E=(C!="0"&&C!="1")?parseInt(E*(100-D)/100):E;}this.addAction(this.elem,mstrUpdateManager.EDIT_GRAPH_PROPS,this.beanPath,["4080","4081"],[I,E],H);}}if(G){this.um.add(H);}return H;}catch(B){microstrategy.errors.log(B);return false;}};mstrGridRW.prototype.handleViewMode=function(A,C,D){try{if(this.isGraph){this.adjustGraphSize(this.commands.queryState("gridPosition"),this.commands.queryState("gridFactor"),C);}if(C&&D&&this.gridGraphUnitKeyContext&&this.gridGraphUnitKeyContext.length>0){this.addAction(this.elem,mstrUpdateManager.SET_GRID_GRAPH_DISPLAY_MODE,this.docViewer.beanPath,["2048137","2048025"],[this.gridGraphUnitKeyContext,A],C);}else{return mstrGridReport.prototype.handleViewMode.apply(this,arguments);}}catch(B){microstrategy.errors.log(B);}return false;};mstrGridRW.prototype.raiseColResizeEvent=function(A,D,C){try{microstrategy.eventManager.notifyOrphanBones("oncolresize",this,A,D,C);}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.initColResize=function(A){try{this.colResizeExtraTag=A;this.nowrapHiddenColumn();}catch(B){microstrategy.errors.log(B);}};mstrGridRW.prototype.onmouseover=function(B){try{if(this.ignoreGridMouseEvent(B)){return ;}if(this.commands){this.commands.exec("ensureColWidthsReady");}mstrGridReport.prototype.onmouseover.apply(this,arguments);}catch(A){microstrategy.errors.log(A);}};mstrGridRW.prototype.processGridFormattingProperties=function(H,Z){try{var C=Z.length;var O=this.id;var J=this.getGridFormatMap();if(!this.getGridFormats()){window.setTimeout(function(){var c=[];var h=microstrategy.bone(O).processGridFormattingProperties(H,c);if(c.length>0){microstrategy.updateManager.add(c);if(h){microstrategy.updateManager.flushAndSubmitChanges();}}},250);return false;}var P;var K=["4006","4007","4108","4109","4126"];var a="propBorderStyle";var G="AllStyle";var Q="AllColor";var L=["LeftStyle","TopStyle","RightStyle","BottomStyle"];var W=["LeftColor","TopColor","RightColor","BottomColor"];for(var S=0,R=H.length;S<R;S++){var V=H[S];if(V.n!="borders"){this.saveGridFormattingChange(K,V,Z);}else{O=mstrUpdateManager.SAVE_GRID_BORDER_PROPERTIES;for(var E in V.v){var X=E.split("|");if(X[0]=="default"){break;}var U={unit:X[0],format:X[1]};var g=this.resolveGridTargetProperties(U);var e=[g.axis,g.position,g.unit,g.level,this.styleName];var T=V.v[E];var B=(a in T)?T[a]:this.getGridFormatValue(U,a);var F=this;var I=function(c,m){for(var h in c){F.packageGridFormat(Z,O,K.concat(J.getArgId(c[h])),m,null,U,c[h],P);}};switch(parseInt(B)){case 0:this.setGridFormatValue(U,a,0);P=0;var N=e.concat(P);I(L,N);break;case 1:this.setGridFormatValue(U,a,1);P=(G in T)?T[G]:this.getGridFormatValue(U,L[0]);if(!(G in T)&&P==0){P="1";}var M=e.concat(P);I(L,M);P=(Q in T)?T[Q]:this.getGridFormatValue(U,W[0]);var A=e.concat(J.encode("color",P));I(W,A);break;case 2:this.setGridFormatValue(U,a,2);for(var Y in T){if(Y==a){continue;}this.packageGridFormat(Z,O,K.concat(J.getArgId(Y)),e.concat(J.encode(Y,T[Y])),null,U,Y,T[Y]);}break;}}}}return(C<Z.length);}catch(D){microstrategy.errors.log(D);return false;}};mstrGridRW.prototype.notifySelectionChange=function(A){try{var B=microstrategy.getViewerBone();if(B){if(A=="ongridselectionschange"){B.commands.exec("synchronizeGridSelections");}B.commands.exec("proxyForGridObservers",A);}}catch(C){microstrategy.errors.log(C);}};mstrGridRW.prototype.getActiveUnitString=function(C){var A="activeViewID="+this.objId;if(C.getAttribute(microstrategy.HTMLATTR_DSS_ID)!=null){A+="&activeUnitId="+C.getAttribute(microstrategy.HTMLATTR_DSS_ID);}var B=C.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(B){if(B==microstrategy.DSSTYPE_ATTRIBUTE_FORM){B=microstrategy.DSSTYPE_ATTRIBUTE;}A+="&activeUnitType="+B;}if(C.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE)!=null){A+="&activeUnitSubType="+C.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);}return A;};mstrGridRW.prototype.processContextMenus=function(N,O){try{var J=microstrategy.updateManager;if(!J){return null;}var G=microstrategy.activeCXMenu;if(G){switch(N){case"sct":case"csc":microstrategy.bone("rwb_viewer").commands.exec(N);break;case"tuce":case"cgs":if(microstrategy.bone("rwb_viewer").autoWire&&N=="cgs"){microstrategy.bone("rwb_viewer").commands.exec("createAutowireSelector");}else{var H=this.getActiveUnitString(G);toggleShowBean("rwaceb",true,H);}break;case"deopenSort":var E=true;case"deopen":var C={activeViewKey:this.objId,attributeId:G.getAttribute(microstrategy.HTMLATTR_DSS_ID)};if(E){C.forSortStr="true";}this.openDialog("deed",null,null,microstrategy.servletName+"."+microstrategy.pageName,C);J.flushAndSubmitChanges();break;case"editDerived":var P=mstrApp.getMsgID();var K={success:function(T){J.add([J.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);J.flushAndSubmitChanges();}};var A=microstrategy.bone("rwb_viewer")["datasetInfos"],F=G.getAttribute(microstrategy.HTMLATTR_DSS_ID),B=G.getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME),R=this.dSetId,L=this.editorProperties&&this.editorProperties.tmsProps,Q={datasets:A,dsid:R,msgID:P},I=[];var M=function(T){mstrmojo.xhr.request("POST",mstrConfig.taskURL,K,{taskId:"mojoRWManipulation",rwb:J.getRWBState(),messageID:P,suppressData:true,params:JSON.stringify({actions:T,style:{params:{treesToRender:0},name:"RWIVEMojoStyle"}})});};var S=function(){var T;for(var V in A){var U=A[V].mx.concat(A[V].att);$ARR.forEach(U,function(W){if(W.did===F){T=V;return false;}});if(T){break;}}return T;};Q.metricId=F;Q.action={cmd:"edit",n:B};Q.onApplyMetricCallback=function(T){I.push({act:"editDM",formula:T.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(T.tokenStreamXML),afb:T.afb,sfb:T.sfb,alias:T.alias,name:T.alias,dsid:S()||R,did:F});M.call(this,I);};microstrategy.openDerivedMetricEditor(Q);break;default:return mstrGridReport.prototype.processContextMenus.apply(this,arguments);}return true;}}catch(D){microstrategy.errors.log(D);}return false;};mstrGridRW.prototype.isRemoveFromGrid=function(A){return true;};mstrGridRW.prototype.onApplyDefaultFormat=function(){try{var C=this.docViewer;var E=C.doc.styleObj;var A=C.objProps;var B=this.getGridContainerSpan();if(E&&B){B.setAttribute(microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,E.getAttValue(B,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE));this.isTitleVisible=E.getAttValue(B,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE;}this.toggleTitleBars();if(this.titleBarObj){A.initObjectFormat(this.titleBarObj,false,microstrategy.SUBOBJTYPE_DOC_TEMPLATE,mstrGridReport.FMT_TYPE_TITLE);}}catch(D){microstrategy.errors.log(D);}};mstrGridRW.prototype.getGridContainerSpan=function(){try{this.gridSpan=this.gridSpan||microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_TEMPLATE);return this.gridSpan;}catch(A){microstrategy.errors.log(A);return false;}};mstrGridRW.prototype.handleFit=function(D,A){try{if(this.commands&&this.commands.queryState("isLinkedTemplate")){return true;}var C=this.gridWidthInfo;var F=this.um.createActionObject(this.elem,mstrUpdateManager.SET_RESIZE_COLUMNS_SCENARIO,this.beanPath,["4153"],[A],[C.colScenario],{objId:this.RWUnitId});var E=this.um.createActionObject(this.elem,mstrUpdateManager.SET_RESIZE_ROW_SCENARIO,this.beanPath,["4154"],["2",""],[C.rowScenario,C.rowHeight],{objId:this.RWUnitId});if(D){D.push(F,E);}else{um=this.um;um.add([F]);um.add([E]);um.flushAndSubmitChanges();}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrGridRW.prototype.handleFitToContent=function(A){this.handleFit(A,mstrGridReport.COL_WIDTH_FIT_TO_CONTENT);};mstrGridRW.prototype.handleFitToWindow=function(A){this.handleFit(A,mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY);};mstrGridRW.prototype.getParentSubsection=function(){try{var C=this.parentSubsection;if(C==null){var A=microstrategy.findAncestor(this.elem);if(A!=null){A=A.parentNode;if(A!=null){C=this.parentSubsection=microstrategy.findBone(A);}}}}catch(B){microstrategy.errors.log(B);}return C;};mstrGridRW.prototype.getTitleHeight=function(){try{var B=0;if(this.isTitleVisible){this.titleBarObj=this.titleBarObj||document.getElementById("portal_"+this.id);B=this.titleBarObj&&getObjHeight(this.titleBarObj)||B;}return B;}catch(A){microstrategy.errors.log(A);return null;}};mstrGridRW.prototype.selectAxis=function(A,C){try{if(C==null||C=="none"){return false;}if(!this.isGridInCellSelectionMode()){this.switchToCellSelectionMode();}return mstrGridReport.prototype.selectAxis.apply(this,arguments);}catch(B){microstrategy.errors.log(B);return false;}};mstrGridRW.prototype.getGridFormats=function(){try{if(!(this.objId in microstrategy.gridFormatCache)&&!this.gridFormatReqId){var B=new mstr.http.GetGridFormats(this.objId,mstr.$obj("mstrPageInfo").get("messageID"));this.gridFormatReqId=mstr.http.Governor.submitRequest(B,this.id,"setGridFormats");return null;}else{return microstrategy.gridFormatCache[this.objId];}}catch(A){microstrategy.errors.log(A);}return null;};mstrGridRW.prototype.setGridFormats=function(A){try{var B=mstr.Enum.Widget.READYSTATE;switch(A.readyState){case B.SUCCESS:microstrategy.gridFormatCache[this.objId]=A.response.data;this.notifySelectionChange("ongridformatready");case B.ERROR:case B.TIMEOUT:this.cancelGridFormatRequest();break;}}catch(C){microstrategy.errors.log(C);}};mstrGridRW.prototype.cancelGridFormatRequest=function(){try{if(!this.gridFormatReqId){return ;}mstr.http.Governor.removeRequest(this.gridFormatReqId);delete this.gridFormatReqId;}catch(A){microstrategy.errors.log(A);}};mstrGridRW.prototype.resetGridUnitSelections=function(){this.gridUnitFormat=microstrategy.GRID_UNIT_CONTAINER;this.gridValueFormat=0;};mstrGridRW.prototype.genericUndoRedo=function(C){if(C.elem&&(C.elem==this.elem||(C.elem.getAttribute&&C.elem.getAttribute("id")==this.RWUnitId))){if(C.id==mstrUpdateManager.EDIT_PROPS){if(C.args[1]){var D=microstrategy.getFormatObject();var A=C.args[1].split(mstrUpdateManager.UNIT_SEPARATOR);if(A[1]=="Gradient"){return ;}var E=D[A[1]][A[2]][mstrFormatObject.HTML_PROP_NAME];var B=A[3];B=(B.substr(B.length-1)==mstrUpdateManager.ITEM_SEPARATOR)?B.substr(0,B.length-1):B;B=D.decodeValue(E,B);if(A[1]=="FormattingSize"&&E=="width"){this.synchronizeSize();}else{if(A[1]=="FormattingView"&&E=="showTitleBar"){this.isTitleVisible=B==microstrategy.TRUE;this.toggleTitleBars();}else{if(A[1]=="FormattingPosition"&&E=="locked"){this.isLocked=B==microstrategy.TRUE;this.resetToolbar();}}}}}else{if(C.id==mstrUpdateManager.SET_GRID_GRAPH_DISPLAY_MODE){this.handleQuickSwitch(false);}}}return true;};mstrGridRW.prototype.onundoredo=function(A,B){mstrGridReport.prototype["on"+B].call(this,A);this.genericUndoRedo(A);return true;};mstrGridRW.prototype.onundo=function(A){this.onundoredo(A,"undo");};mstrGridRW.prototype.onredo=function(A){this.onundoredo(A,"redo");};mstrGridRW.prototype.delegateSelectAll=function delegateSelectAll(){var C=this.commands,D=C.queryState("tbGridUnitSelector"),A=C.queryState("tbGridValueSelector"),B=false;if(D.value==mstrGridReport.ALL_UNITS&&A.value==mstrGridReport.ALL_FORMAT_VALUES){microstrategy.bone(this.viewerId).doc.selections.selectAll();B=true;}return B;};function mstrGridRW(A){this.inherits=mstrGridReport;this.inherits(A);delete this.inherits;this.primaryBone=true;return this;}mstrAccordionTabManagerImplScript=true;mstrAccordionTabManagerImpl.prototype=new mstrFormatImpl();mstrAccordionTabManagerImpl.prototype.adjustContainer=true;mstrAccordionTabManagerImpl.prototype.bottomAdjustHeight=10;mstrAccordionTabManagerImpl.prototype.currentTabName="";mstrAccordionTabManagerImpl.prototype.bottomSum=0;mstrAccordionTabManagerImpl.prototype.onload=function(){try{mstrFormatImpl.prototype.onload.call(this);this.bottomAdjustHeight=(this.adjustContainer)?2:5;microstrategy.eventManager.notifyOrphanBones("onObjectBrowserTabChange",this.currentTabName);microstrategy.eventManager.ondialogresize();}catch(A){microstrategy.errors.log(A);}};mstrAccordionTabManagerImpl.prototype.closeEditor=function(B){try{mstrEditorImpl.prototype.closeEditor.call(this,B);microstrategy.eventManager.notifyOrphanBones("onObjectBrowserTabChange",null);}catch(A){microstrategy.errors.log(A);}};mstrAccordionTabManagerImpl.prototype.onforcerepaint=function(){try{var B=document.createElement("img");if(this.elem){this.elem.parentNode.parentNode.style.width=getObjOuterWidth(this.elem)+"px";this.elem.appendChild(B);this.elem.removeChild(B);}window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').resize()",0);window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').adjustTabTable()",0);var A=microstrategy.findChildWithAtt(this.elem,"DIV","id",this.id+"_tabSet");if(A){A.style.visibility="visible";}this.callOnTabs("onforcerepaint");}catch(C){microstrategy.errors.log(C);return false;}};mstrAccordionTabManagerImpl.prototype.onreload=function(){try{mstrFormatImpl.prototype.onreload.call(this);window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').resize()",0);window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').adjustTabTable()",0);}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.findTabSectionContainer=function(B){try{return(B.parentNode)?B.parentNode:B;}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.callDelayedResize=function(){try{if(this.resizeTimer){window.clearTimeout(this.resizeTimer);}this.resizeTimer=window.setTimeout("microstrategy.bone('"+this.id+"').ondialogresize()",0);}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.onwinresize=function(){try{if(bIsFirefox||bIsChrome){this.callDelayedResize();}else{this.ondialogresize();}}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.ondialogresize=function(){try{if(mstrFormatImpl.prototype.ondialogresize){mstrFormatImpl.prototype.ondialogresize.call(this);}if(this.elem&&this.elem.parentNode){if(microstrategy.pageScreenMode!=microstrategy.PAGE_FULL_SCREEN_MODE){var D=microstrategy.findChildWithAtt(this.elem,"DIV","sty","titl");if(D){var E=D.firstChild;if(E){var C=E.nextSibling;var A=((C!=null)?getObjWidth(C):0)+20;E.style.width=Math.max(0,getObjWidth(this.elem)-A)+"px";}}}this.elem.parentNode.parentNode.style.width=getObjOuterWidth(this.elem)+"px";this.elem.style.height=Math.max(microstrategy.contentHeight-this.bottomAdjustHeight-this.bottomSum,SCROLLBAR_SIZE)+"px";this.elem.parentNode.style.height=Math.max(getObjOuterHeight(this.elem)-1,0)+"px";if(this.adjustContainer){this.elem.parentNode.parentNode.style.height=microstrategy.contentHeight-1+"px";}}this.callOnTabs("onwinresize");window.setTimeout("if(microstrategy.bone('"+this.id+"')) microstrategy.bone('"+this.id+"').adjustTabTable()",0);}catch(B){microstrategy.errors.log(B);return false;}};mstrAccordionTabManagerImpl.prototype.adjustTabTable=function(){try{if(!this.elem||microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){return ;}if(this.adjustContainer){if(this.elem.parentNode&&this.elem.parentNode.parentNode){var B=Math.max(microstrategy.contentHeight-this.bottomAdjustHeight-this.bottomSum,SCROLLBAR_SIZE);this.elem.parentNode.parentNode.style.height=B+"px";var F=(B-this.bottomAdjustHeight/2);this.elem.parentNode.style.height=F+"px";this.elem.style.height=Math.max((F-1),0)+"px";}}else{if(this.elem.parentNode){}}var C=microstrategy.findChildWithAtt(this.elem,"DIV","id",this.id+"_tabSet");if(C){C.style.width=Math.max(getObjWidth(this.elem)-2,0)+"px";}this.moveResizeHandles();var E=(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?microstrategy.ACCORDION_REPORT_RELATED_RP_PANEL:microstrategy.ACCORDION_RW_RELATED_RP_PANEL;if(this.currentTabName==E){var G=document.getElementById(E+"Id");var A=document.getElementById(E+"IdList");if(A!=null){A.style.height=Math.max(this.getAvailableHeight()-10,0)+"px";A.style.width=Math.max(this.getAvailableWidth()-6,0)+"px";}}}catch(D){microstrategy.errors.log(D);return false;}};mstrAccordionTabManagerImpl.prototype.afterresize=function(){try{if(mstrFormatImpl.prototype.afterresize){mstrFormatImpl.prototype.afterresize.call(this);}var B=getObjWidth(this.elem);this.elem.parentNode.parentNode.style.width=B+"px";microstrategy.eventManager.ondialogresize();this.onforcerepaint();microstrategy.updateBrowserSetting("rwltW",B);}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.getAvailableHeight=function(){try{var A=microstrategy.findChildWithAtt(this.elem,"DIV","id",this.id+"_tabSet");var D=(A)?getObjOuterHeight(A):0;var B=(this.getTitleContainer())?getObjOuterHeight(this.titleContainer.parentNode):0;return(Math.max(microstrategy.contentHeight-this.bottomAdjustHeight-this.bottomSum,SCROLLBAR_SIZE)-D-B);}catch(C){microstrategy.errors.log(C);return false;}};mstrAccordionTabManagerImpl.prototype.getAvailableWidth=function(){try{return getObjInnerWidth(this.elem);}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.resize=function(){try{if(mstrFormatImpl.prototype.resize){mstrFormatImpl.prototype.resize.call(this);}this.callOnTabs("resize");}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.callOnTabs=function(A){for(var B=0;B<this.childrenTabs.length;B++){if(this.childrenTabs[B]&&this.childrenTabs[B][A]){this.childrenTabs[B][A]();}}};mstrAccordionTabManagerImpl.prototype.unregister=function(){try{for(var A=0;A<this.childrenTabs.length;A++){if(this.childrenTabs[A]&&this.childrenTabs[A].unregister){var C=this.childrenTabs[A];this.unRegisterChildrenBones(C.elem.getElementsByTagName("div"));C.unregister();}}this.elem.innerHTML="";microstrategy.unRegisterBone(this.id);}catch(B){microstrategy.errors.log(B);return false;}};mstrAccordionTabManagerImpl.prototype.unRegisterChildrenBones=function(D){try{for(var B=0,A=D.length;B<A;B++){var E=D[B].id;if(microstrategy.bones[E]){microstrategy.unRegisterBone(E);}}}catch(C){microstrategy.errors.log(C);}};mstrAccordionTabManagerImpl.prototype.close=function(){try{mstrEditorImpl.prototype.close.call(this);if(this.elem&&this.elem.parentNode){this.elem.parentNode.parentNode.style.width="0px";}}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.hideAccordion=function(){try{microstrategy.toggleAccordion();microstrategy.eventManager.notifyOrphanBones("onwinresize");}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.onMouseOverTab=function(B){try{B.className+="Hover";}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.onMouseOutTab=function(B){try{if(B.className.indexOf("Hover")>=0){B.className=B.className.slice(0,B.className.indexOf("Hover"));}}catch(A){microstrategy.errors.log(A);return false;}};mstrAccordionTabManagerImpl.prototype.setCurTab=function(A){try{var B=(isNaN(A))?"curTabName":"curTab";var D=microstrategy.findChildrenWithAtt(this.elem,"SPAN","ty","tab");for(var C=0;C<D.length;C++){if(D[C].getAttribute(B)==A){this.setCurrentTab(D[C]);break;}}}catch(E){microstrategy.errors.log(E);return false;}};mstrAccordionTabManagerImpl.prototype.setCurrentTab=function(E){try{this.currentTabName=E.getAttribute("curTabName");if(mstrApp.rememberLastEditorPanel!=="0"){microstrategy.updateBrowserSetting((microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION)?"accordionRWTab":"accordionReportTab",this.currentTabName);}mstrFormatImpl.prototype.setCurrentTab.call(this,E);var D=(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?microstrategy.ACCORDION_REPORT_NOTES_PANEL:microstrategy.ACCORDION_RW_NOTES_PANEL;if(this.currentTabName==D||microstrategy.needSaveBeforeNotes()){var A=mstr.$obj("NotesIconView_view");if(A){A.set("visible",false);}}else{var B=mstr.$obj("NotesIconModel_model");if(B){B.execCheck();}}microstrategy.eventManager.notifyOrphanBones("onObjectBrowserTabChange",this.currentTabName);return true;}catch(C){microstrategy.errors.log(C);return false;}};function mstrAccordionTabManagerImpl(A){this.inherits=mstrFormatImpl;this.inherits(A);this.inherits=null;return this;}mstrRWObjectsImplScript=true;mstrRWObjectsImpl.prototype=new mstrObjectBrowserImpl();mstrRWObjectsImpl.prototype.superClass=mstrObjectBrowserImpl.prototype;mstrRWObjectsImpl.prototype.deleteButton=null;mstrRWObjectsImpl.prototype.taskModel=null;mstrRWObjectsImpl.prototype.selectDataSetEditor=null;mstrRWObjectsImpl.HTMLATTR_BTN_ID="b";mstrRWObjectsImpl.NEW_DATASET="new";mstrRWObjectsImpl.EDIT_DATASET="edit";mstrRWObjectsImpl.DELETE_DATASET="del";mstrRWObjectsImpl.prototype.onload=function(E){try{this.superClass.onload.call(this,E);this.isRWTab=true;if(!(this.body)){microstrategy.unRegisterBone(this.id);return ;}this.maskArea=this.body.firstChild;this.mask.onload(this);this.selections=new mstrRWObjSelectionsImpl();this.selections.parentBone=this;this.selections.path="microstrategy.bone('"+this.id+"').selections";var D=microstrategy.subObjectFind(this.elem,["DIV"],microstrategy.SUBOBJTYPE_TOOLBAR);if(D){var F=D.getElementsByTagName("img");for(var A=0;A<F.length;A++){if(F[A].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN){F[A].onclick=new Function("e","return microstrategy.bone('"+this.id+"').onclick(e);");if(F[A].getAttribute(mstrRWObjectsImpl.HTMLATTR_BTN_ID)==mstrRWObjectsImpl.DELETE_DATASET){this.deleteButton=F[A];}}}}var B=microstrategy.subObjectFind(this.tree.elem,["IMG"],microstrategy.SUBOBJTYPE_BTN);if(B){B.onclick=new Function("e","return microstrategy.bone('"+this.id+"').onclick(e);");}this.resizeContents();}catch(C){microstrategy.errors.log(C);return false;}};mstrRWObjectsImpl.prototype.onpostload=function(A){if(microstrategy.getViewerBone()){this.selections.targetMask=new mstrTransparentMask(microstrategy.getViewerBone().elem);this.populateInDocAttributeLinkInfo();}};mstrRWObjectsImpl.prototype.onforcerepaint=function(){try{var A=function(D){if(D){D=D.parentNode;var C=document.createElement("img");D.appendChild(C);C.parentNode.removeChild(C);}};A(microstrategy.findAncestor(this.elem));if(bIsIE4){A(microstrategy.findChildWithAtt(this.elem,"TABLE","sty","tree"));}}catch(B){microstrategy.errors.log(B);}};mstrRWObjectsImpl.prototype.resizeContents=function(){try{var D=10;var G=15;var I=5;var L=1;var F=2;var E=2;var A=7;if(!isInDocument(this.elem)){return false;}var J=0;if(this.tabManager&&this.tabManager.getAvailableHeight){J=Math.max((this.tabManager.getAvailableHeight()-A),0);}if(this.tree&&this.tree.elem&&this.tree.elem.style&&(isInDocument(this.tree.elem))){var H=J-(F+E);if(H>0){this.elem.childNodes[0].style.height=H+"px";}else{this.elem.childNodes[0].style.height="0px";}var B=H-(G+I+L*2);if(B>0&&(this.tree.elem.style.height!=B+"px")){this.tree.elem.style.height=B+"px";}var K=getObjOuterWidth(this.elem)-(D+L)*2;if(K>0){this.tree.elem.style.width=K+"px";}}}catch(C){microstrategy.errors.log(C);return false;}};mstrRWObjectsImpl.prototype.onclick=function(C){try{if(!C){C=window.event;}var E=findTarget(getEventTarget(C),mstrRWObjectsImpl.HTMLATTR_BTN_ID);if(E){var F=E.getAttribute(mstrRWObjectsImpl.HTMLATTR_BTN_ID);switch(F){case mstrRWObjectsImpl.NEW_DATASET:var D=microstrategy.getViewerBone(),A=D&&D.commands;if(A){A.exec("openSelectDatasetEditor");}break;case mstrRWObjectsImpl.EDIT_DATASET:this.selections.editDataSet();break;case mstrRWObjectsImpl.DELETE_DATASET:if(E.className!="mstrIcon-tb mstrIcon-disabled"){this.confirmDeleteDataSet();}break;}return false;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrRWObjectsImpl.prototype.confirmDeleteDataSet=function(){try{var C=microstrategy.descriptors.getDescriptor("4966");if(this.selections){var B=this.selections;for(member in B.items){var D=B.items[member].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(D==microstrategy.DSSTYPE_RPT_DEFINITION&&B.items[member].getAttribute("oid")==microstrategy.primeDataSetId){C=microstrategy.descriptors.getDescriptor("5171");}}}showMessage({contents:C,elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').selections.deleteDataSet();",type:mstrMsgBoxImpl.MSG_WARNING});}catch(A){microstrategy.errors.log(A);}};mstrRWObjectsImpl.prototype.confirmSetPrimeDataSet=function(){try{var B=microstrategy.descriptors.getDescriptor("3043");if(this.selections.determineIsValid()){this.selections.setPrimeDataSet();}else{showMessage({contents:B,elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').selections.setPrimeDataSet();",type:mstrMsgBoxImpl.MSG_WARNING});}}catch(A){microstrategy.errors.log(A);}};mstrRWObjectsImpl.prototype.onselectionchange=function(D){try{var A=false;if(this.selections&&this.selections.isActive()&&!this.selections.isMulti()){var C=this.selections.firstItem();A=(C!=null&&C.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_RPT_DEFINITION);}if(this.deleteButton){this.deleteButton.className=(A)?"mstrIcon-tb":"mstrIcon-tb mstrIcon-disabled";}}catch(B){microstrategy.errors.log(B);}};mstrRWObjectsImpl.prototype.hasMetrics=function(){try{var A=this.tree.elem.getElementsByTagName("span");for(var B=0;B<A.length;B++){if(A[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_METRIC){return true;}}return false;}catch(C){microstrategy.errors.log(C);return false;}};mstrRWObjectsImpl.prototype.getDatasetName=function(A){return this.getDatasetAtt(A,"ds");};mstrRWObjectsImpl.prototype.getDatasetType=function(A){return this.getDatasetAtt(A,"oty");};mstrRWObjectsImpl.prototype.getDatasetAtt=function(D,E){try{var A=microstrategy.findChildrenWithAtt(this.elem,"span",microstrategy.HTMLATTR_DSS_TYPE,microstrategy.DSSTYPE_RPT_DEFINITION);if(!A){return"";}for(var B=0;A&&B<A.length;B++){if(A[B].getAttribute("id").indexOf(D)>-1){return A[B].getAttribute(E);}}}catch(C){microstrategy.errors.log(C);}return"";};mstrRWObjectsImpl.prototype.isMetricUnique=function(E){try{var D=0;var A=microstrategy.findChildrenWithAtt(this.elem,"span",microstrategy.HTMLATTR_DSS_TYPE,microstrategy.DSSTYPE_METRIC);for(var B=0;A&&B<A.length&&D<2;B++){if(A[B].getAttribute("ds")==E){D++;}}return(D<=1);}catch(C){microstrategy.errors.log(C);}return true;};mstrRWObjectsImpl.prototype.resize=function(){try{var B=7;var F=12;var D=microstrategy.findAncestorWithAtt(this.elem,"scriptClass","mstrAccordionTabManagerImpl");if(D){var G=microstrategy.findBone(D);var E=G.getAvailableHeight();var A=0;if(E>B){A=E-B;}this.elem.parentNode.style.height=A+"px";this.elem.style.height=A+"px";this.elem.parentNode.parentNode.style.height=(((E-(B-F))<F)?F:(E-(B-F)))+"px";this.elem.style.width=G.getAvailableWidth()+"px";}if(this.moveResizeHandles){this.moveResizeHandles();}if(this.resizeContents){this.resizeContents();}if(this.mask&&this.mask.onmaskedobjectresize){this.mask.onmaskedobjectresize();}}catch(C){microstrategy.errors.log(C);return false;}};mstrRWObjectsImpl.prototype.afterresize=function(){try{if(this.resizeContents){this.resizeContents();}}catch(A){microstrategy.errors.log(A);return false;}};mstrRWObjectsImpl.prototype.populateInDocAttributeLinkInfo=function populateInDocAttributeLinkInfo(){var G=microstrategy.bone("rwb_viewer")["als"];if(!G){return ;}if(!G.links){G.links={};var D=G.links,A=(G&&G.length)||0,E,F,C,B;for(E=0;E<A;E++){F=G[E];for(C in F){B=F[C];if(!D[C]){D[C]=[];}D[C].push(B);if(!D[B]){D[B]=[];}D[B].push(C);}}}};function mstrRWObjectsImpl(A){this.inherits=mstrObjectBrowserImpl;this.inherits(A);delete this.inherits;return this;}mstrRWObjSelectionsImplScript=true;mstrRWObjSelectionsImpl.prototype=new mstrObjSelectionsImpl();mstrRWObjSelectionsImpl.prototype.dragDisplay=null;mstrRWObjSelectionsImpl.prototype.targetMask=null;mstrRWObjSelectionsImpl.prototype.onmousedown=function(F){try{var G=getEventTarget(F);var D=microstrategy.eventManager.getSource(F);if(D&&D.button>1){var C="["+this.getDssTypes().toString()+"]";for(var H in this.items){var A=new mstrObjectInfoImpl(this.items[H]);microstrategy.getContextMenuManager("RWObjB").getMenu("rwobjbrowser_context_menu").registerTrigger(this.items[H],C);}return false;}if(F.ctrlKey){return ;}mstrSelectionsImpl.prototype.onmousedown.call(this,F);if(this.clickedSrc.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE)==microstrategy.DSSTYPE_REPORT_CUBE){return ;}var B=microstrategy.getEventHandlerString(this.path);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","ondragstart");this.parentBone.attachWinListener(this,"mouseup","onmouseup",false);}else{document.onmousemove=new Function("e",B+" { return "+this.path+".ondragstart(e); }");if(document.onmouseup==null){document.onmouseup=new Function("e",B+" { return "+this.path+".onmouseup(e); }");}}return false;}catch(E){microstrategy.errors.log(E);}return false;};mstrRWObjSelectionsImpl.prototype.ondrag=function(L){try{if(!L){L=window.event;}if(L.e){L=L.e;}getMouse(L);var P=lMouseX;var O=lMouseY;var I=55;var H=12;var E=","+this.getDssTypes().toString()+",";if(E.indexOf(","+microstrategy.DSSTYPE_HIERARCHY+",")==-1){var A=microstrategy.findAncestor(getEventTarget(L));if(A){var B=false;var K=(E.indexOf(","+microstrategy.DSSTYPE_RPT_DEFINITION+",")>-1);var D=A.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var N=this.getOuterRect(A,getObj("mstrWebContents"));switch(D){case microstrategy.OBJTYPE_DOC_OBJECT:var Q=A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(!this.isEditableViewModeEplus()&&Q!=microstrategy.SUBOBJTYPE_DOC_TEMPLATE){break;}if(Q==microstrategy.SUBOBJTYPE_DOC_TEXT){B=(!K);N.top-=3;N.right+=5;N.bottom+=2;break;}else{if(Q==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){B=this.getItems()&&(this.getItems().length==1)&&(this.isSupportedBySelector(this.getItems()[0],A));N.top-=3;N.right+=5;N.bottom+=2;break;}else{A=microstrategy.findAncestor(A.parentNode);N=this.getOuterRect(A,getObj("mstrWebContents"));}}case microstrategy.OBJTYPE_DOC_SUBSECTION:if(!this.isEditableViewModeEplus()){break;}var J=(L.ctrlKey)?microstrategy.SNAP_OFF:!microstrategy.SNAP_OFF;if(J){P=microstrategy.snapCoordinate(P-I-microstrategy.CURSOR_OFFSET,getObjSumLeft(A.parentNode),true);O=microstrategy.snapCoordinate(O-H-microstrategy.CURSOR_OFFSET,getObjSumTop(A.parentNode),true);P+=I+microstrategy.CURSOR_OFFSET;O+=H+microstrategy.CURSOR_OFFSET;}N.left+=3;B=true;if(A.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)==microstrategy.TRUE&&K){B=false;}break;default:B=false;break;}if(B){this.targetMask.resize(N);var M=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?N.top+1:N.top;var C=microstrategy.getViewerBone().elem;var F=N.left-this.targetMask.offset-C.offsetLeft+C.scrollLeft;M-=C.offsetTop-C.scrollTop;this.targetMask.moveTo(F,M);this.targetMask.show();}else{this.targetMask.hide();}}}moveObjTo(this.dragDisplay,P-I-microstrategy.CURSOR_OFFSET,O-H-microstrategy.CURSOR_OFFSET);this.parentBone.dndHelper.moveHelperImage(L);}catch(G){microstrategy.errors.log(G);}return false;};mstrRWObjSelectionsImpl.prototype.ondragend=function(S){try{if(!S){S=window.event;}if(S.e){S=S.e;}var F=parseInt(this.dragDisplay.style.left);var E=parseInt(this.dragDisplay.style.top);this.parentBone.dndHelper.parkObject(this.dragDisplay);microstrategy.eventManager.notifyOrphanBones("onnotifydragend",this.parentBone);this.targetMask.hide();this.onmouseup(S);var D=microstrategy.findAncestor(getEventTarget(S));if(D){this.shiftKey=S.shiftKey;this.ctrlKey=S.ctrlKey;var O=this.getItems();var M=D.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(M){case microstrategy.OBJTYPE_DOC_OBJECT:if(!this.isEditableViewModeEplus()){return ;}var R=D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(R==microstrategy.SUBOBJTYPE_DOC_TEXT){var J=this.parentBone.elem.getAttribute("at");if(J!=null&&J.length>0){var C=microstrategy.bone(J);if(C&&C.commands){var U=[];for(var Q=0;Q<O.length;Q++){var T=O[Q];var M=T.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(M!=microstrategy.DSSTYPE_RPT_DEFINITION){var G=T.getAttribute(microstrategy.HTMLATTR_DESCRIPTION);if(M==microstrategy.DSSTYPE_ATTRIBUTE_FORM){var I=findTargetTag(T.parentNode,"ul");if(I){var H=findTargetTag(I,"li");if(H&&H.getElementsByTagName("span")[0]){if(G.indexOf(" ")>-1){G="["+G+"]";}var P=H.getElementsByTagName("span")[0].getAttribute(microstrategy.HTMLATTR_DESCRIPTION);G=((P.indexOf(" ")>-1)?"["+P+"]":P)+"@"+G;}}}else{if(G.indexOf(" ")>-1){G="["+G+"]";}}C.commands.exec("addToTextField",["{"+G+"}",D,U]);}}if(U.length>0){this.updateManager.add(U);C.commands.exec("editTextField",D);}}}break;}else{if(R==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(O.length==1){var J=this.parentBone.elem.getAttribute("at");if(J!=null&&J.length>0){var C=microstrategy.bone(J);if(C&&C.commands){var T=O[0];var A=T.getAttribute(microstrategy.HTMLATTR_DSS_ID);var G=T.getAttribute(microstrategy.HTMLATTR_DESCRIPTION);var M=T.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(G.indexOf(" ")>-1){G="["+G+"]";}if(this.isSupportedBySelector(T,D)){C.commands.exec("setSelectorSource",[A,M,G,D]);}}}}break;}else{D=microstrategy.findAncestor(D.parentNode);}}case microstrategy.OBJTYPE_DOC_SUBSECTION:if(!this.isEditableViewModeEplus()){return ;}this.dragX=F-getObjSumLeftScrolled(D);this.dragY=E-getObjSumTop(D);this.docViewerBone=microstrategy.bone("rwb_viewer");if(this.docViewerBone.docViewsSize>1&&!this.docViewerBone.defaultInsertMode){var L="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('msgPref'), checked = p && p.checked;";var N="var ob = microstrategy.bone('reportObjs_RWWorkingSetStyle');var src= document.getElementById('"+D.id+"');var bone = microstrategy.findBone(src);bone.ondrop(src, ob.selections);";var V=L+"rwb.visibleCurOnly=false;"+N+"if(checked) rwb.updateInsertMode(true);";var K=L+"rwb.visibleCurOnly=true;"+N+"if(checked) rwb.updateInsertMode(false);";fnShowMessageAdd(V,K);}else{var C=microstrategy.findBone(D);C.ondrop(D,this);}break;default:var C=microstrategy.boneForMask(D);if(C&&C.ondrop){C.ondrop(D,this);}break;}}}catch(B){microstrategy.errors.log(B);}return false;};mstrRWObjSelectionsImpl.prototype.isSupportedBySelector=function(F,G){var C=G&&microstrategy.bone(G.id+"_Ctl"),B=C&&C.ctlType,A=C&&C.ctlStyle;if(mstrRWControlImpl&&B==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION){return false;}switch(F.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)){case microstrategy.DSSTYPE_CONSOLIDATION:return A!="9";case microstrategy.DSSTYPE_ATTRIBUTE:if(A=="11"){var D=F.getAttribute(microstrategy.HTMLATTR_DSS_ID),H=microstrategy.bone("rwb_viewer").getAttributesWithDateForms(),E=false;mstr.$A.forEach(H,function(I){var J=I.dssid.split("|")[0];if(J==D){E=true;return false;}});return E;}return !A||(A!="7"&&A!="8");case microstrategy.DSSTYPE_USER_METRIC:case microstrategy.DSSTYPE_METRIC:case microstrategy.DSSTYPE_USER_SUMMARY_METRIC:return A=="7"||A=="8";case microstrategy.DSSTYPE_FILTER:return F.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE)==microstrategy.DSSTYPE_CUSTOM_GROUP&&A!="9";default:return false;}return false;};mstrRWObjSelectionsImpl.prototype.editDataSet=function(){try{for(member in this.items){var B=this.items[member].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(B==microstrategy.DSSTYPE_RPT_DEFINITION){}}return true;}catch(A){microstrategy.errors.log(A);return null;}};mstrRWObjSelectionsImpl.prototype.isPrimaryJoinDataset=function(){try{for(member in this.items){var B=this.items[member].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(B==microstrategy.DSSTYPE_RPT_DEFINITION){return(this.items[member].getAttribute(microstrategy.HTMLATTR_IS_DATASET_JOIN_PRIMARY)=="1");}}return false;}catch(A){microstrategy.errors.log(A);}return true;};mstrRWObjSelectionsImpl.prototype.setPrimaryJoinDataset=function(E){try{var C=this.parentBone.updateManager;var A=new Array();var B=microstrategy.bone("rwb_viewer");for(member in this.items){var F=this.items[member].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);this.items[member].setAttribute(microstrategy.HTMLATTR_IS_DATASET_JOIN_PRIMARY,(E?"1":"0"));if(F==microstrategy.DSSTYPE_RPT_DEFINITION){if(C){A.push(C.createActionObject(this.items[member],mstrUpdateManager.SET_DATASET_JOIN_MODE,B.beanPath,["2048032","2048155"],[this.items[member].getAttribute("oid"),E],[this.items[member].getAttribute("oid"),"true"]));}}}if(A.length>0){C.add(A);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){C.flushAndSubmitChanges();}}}catch(D){microstrategy.errors.log(D);}return true;};mstrRWObjSelectionsImpl.prototype.deleteDataSet=function(){try{var B=false;for(id in this.items){if(this.items[id].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_RPT_DEFINITION){B=true;break;}}if(!B){return true;}var C=this.parentBone.updateManager;var A=new Array();for(member in this.items){var E=this.items[member].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(E==microstrategy.DSSTYPE_RPT_DEFINITION){if(C){A.push(C.createActionObject(this.items[member],mstrUpdateManager.REMOVE_DATASET,this.parentBone.beanPath,["2048032","2048034"],[this.items[member].getAttribute("oid"),"true"],[this.items[member].getAttribute("oid"),"true"]));}}}if(A.length>0){C.add(A);C.flushAndSubmitChanges();}return true;}catch(D){microstrategy.errors.log(D);return null;}};mstrRWObjSelectionsImpl.prototype.setPrimeDataSet=function(){try{var B=false;for(id in this.items){if(this.items[id].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_RPT_DEFINITION){B=true;break;}}if(!B){return true;}var C=this.parentBone.updateManager;var A=new Array();for(member in this.items){var E=this.items[member].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(E==microstrategy.DSSTYPE_RPT_DEFINITION){if(C){A.push(C.createActionObject(this.items[member],mstrUpdateManager.SET_PRIMARY_DATASET,this.parentBone.beanPath,["2048031"],[this.items[member].getAttribute("oid")],[microstrategy.primeDataSetId]));}}}if(A.length>0){C.add(A);C.flushAndSubmitChanges();}return true;}catch(D){microstrategy.errors.log(D);return null;}};mstrRWObjSelectionsImpl.prototype.getDatasetMembers=function(C){try{var A=null;if(C.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_RPT_DEFINITION){A=this.getChildren(C);}return A;}catch(B){microstrategy.errors.log(B);return null;}};mstrRWObjSelectionsImpl.prototype.getDataSetId=function(){try{var B=null;var C=new Array();for(var E in this.items){var A=new mstrObjectInfoImpl(this.items[E]);if(A.dssType!=microstrategy.DSSTYPE_RPT_DEFINITION){C.push(A.dSetId);}else{C.push(A.dssId);}}if(C.length>0){C.sort();if(C[0]==C[C.length-1]){B=C[0];}}return B;}catch(D){microstrategy.errors.log(D);return null;}};mstrRWObjSelectionsImpl.prototype.getActiveUserMetricIndxKey=function(){try{var A=null;var C=mstr.utils.Arrays.fromHashValues(this.items);if((C[0].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_METRIC)||(C[0].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_SUMMARY_METRIC)){A=new Array();A[0]=C[0].oid;A[1]=C[0].key;}return A;}catch(B){microstrategy.errors.log(B);return null;}};mstrRWObjSelectionsImpl.prototype.processContextMenu=function(D){this.docViewerBone=microstrategy.bone("rwb_viewer");if(this.docViewerBone.docViewsSize>1&&!this.docViewerBone.defaultInsertMode&&(D=="addToSectionWithFormat"||D=="addToSectionAsShortcut"||D=="addToSectionAsStatic"||D=="addToSectionAsSelector"||D=="addToSection"||D=="addToSectionAsDynamic")){var C="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('msgPref'), checked = p && p.checked;";var B="var ob = microstrategy.bone('reportObjs_RWWorkingSetStyle');ob.selections.doProcessContextMenu('"+D+"');";var A=C+"rwb.visibleCurOnly=false;"+B+"if(checked) rwb.updateInsertMode(true);";var E=C+"rwb.visibleCurOnly=true;"+B+"if(checked) rwb.updateInsertMode(false);";fnShowMessageAdd(A,E);}else{this.doProcessContextMenu(D);}};mstrRWObjSelectionsImpl.prototype.doProcessContextMenu=function(c){try{this.docViewerBone=microstrategy.bone("rwb_viewer");var g=this.getItems();var Z;var q=this.getDataSetId();var N=0;var R=this.parentBone.updateManager,m=mstrApp.getMsgID();var V=[R.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])],U={success:function(u){R.add(V);R.flushAndSubmitChanges();}};switch(c){case"addToSectionWithFormat":var T=new Array(g,this.parentBone);this.shiftKey=false;return(this.docViewerBone.commands.exec("addObjsWithFormat",T));case"addToSectionAsShortcut":var T=new Array(g,this.parentBone);return(this.docViewerBone.commands.exec("addObjsAsLinked",T));case"addToSectionAsStatic":return(this.docViewerBone.commands.exec("addasText",g));case"addToSectionAsSelector":return(this.docViewerBone.commands.exec("addAsSelector",g));case"addToSection":var K=this.docViewerBone.commands.queryState("selectedSection");this.dragX=getObjSumLeftScrolled(K)-getObjSumLeft(K)+5;this.dragY=getObjSumTopScrolled(K)-getObjSumTop(K)+5;this.ctrlKey=false;this.shiftKey=true;return(this.docViewerBone.commands.exec("addObjs",this));case"addToSectionAsDynamic":var K=this.docViewerBone.commands.queryState("selectedSection");this.dragX=getObjSumLeftScrolled(K)-getObjSumLeft(K)+5;this.dragY=getObjSumTopScrolled(K)-getObjSumTop(K)+5;this.ctrlKey=this.shiftKey=false;return(this.docViewerBone.commands.exec("addObjs",this));case"addToGrouping":return(this.docViewerBone.commands.exec("addToGrouping",this));case"editUserMetric":case"addUserMetric":var A=microstrategy.bone("rwb_viewer")["datasetInfos"],J=g[0]&&g[0].getAttribute(microstrategy.HTMLATTR_DSS_ID),B=g[0]&&g[0].getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME),n={datasets:A,dsid:q,msgID:m},M=[];var Y=function(u){mstrmojo.xhr.request("POST",mstrConfig.taskURL,U,{taskId:"mojoRWManipulation",rwb:R.getRWBState(),messageID:m,suppressData:true,params:JSON.stringify({actions:u,style:{params:{treesToRender:0},name:"RWIVEMojoStyle"}})});};if(c==="addUserMetric"){n.metricId="";n.action={cmd:"editNew",refOi:{did:J,n:B}};n.onApplyMetricCallback=function(u){M.push({act:"addDerivedMetricToDataset",dsid:q,formula:u.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(u.tokenStreamXML),name:u.alias,afb:u.afb,sfb:u.sfb});Y.call(this,M);};}else{n.metricId=J;n.action={cmd:"edit",n:B};n.onApplyMetricCallback=function(u){M.push({act:"editDM",formula:u.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(u.tokenStreamXML),afb:u.afb,sfb:u.sfb,alias:u.alias,name:u.alias,dsid:q,did:J});Y.call(this,M);};}microstrategy.openDerivedMetricEditor(n);break;case"addDerivedAttr":var h=true;case"editDerivedAttr":if(q&&(q.length>0)){var D=microstrategy.bone("rwb_viewer"),A=D.datasetInfos,J=g[0]&&g[0].getAttribute(microstrategy.HTMLATTR_DSS_ID),a,H=A&&A[q],Q=(H&&H.att&&H.att.length)||0,W={},Y=function(u,x){D.checkAndDisableFlashDefaultMode(R,V);U=mstrmojo.func.wrapMethods(x,U);mstrmojo.xhr.request("POST",mstrConfig.taskURL,U,{taskId:"mojoRWManipulation",rwb:R.getRWBState(),messageID:m,suppressData:true,params:JSON.stringify({actions:[u],style:{params:{treesToRender:0},name:"RWIVEMojoStyle"}})});};for(var e=0;e<Q;e++){var S=H.att[e];if(S.did===J){a=S;if(!h&&S.da){W=S;}break;}}var C=function(){microstrategy.openDerivedAttrEditor({datasets:A,dsid:q,msgID:m,did:W.did,n:W.n,forms:W.fs,onAttribute:a,oncreate:Y,onupdate:Y});};if(h){D.showWarningMessageForUnsupportFeature(C);break;}C();}break;case"removeDerivedAttr":if(q&&(q.length>0)){var J=g[0]&&g[0].getAttribute(microstrategy.HTMLATTR_DSS_ID),E=q+mstrUpdateManager.UNIT_SEPARATOR+J,I=this.parentBone.updateManager,L=new Array();if(I){L.push(I.createActionObject(this,mstrUpdateManager.REMOVE_DERIVED_ATTRIBUTES_FROM_DATASET,this.parentBone.beanPath,["2048075","2048018"],[E,"1"],[]));}if(L.length>0){I.add(L);I.flushAndSubmitChanges();}}break;case"addShortcutMetricCount":case"addShortcutMetricMin":case"addShortcutMetricMax":case"addShortcutMetricAvg":case"addShortcutMetricSum":case"addShortcutMetricStdDev":case"addShortcutMetricVar":if(q&&(q.length>0)){var I=this.parentBone.updateManager;var L=new Array();var P=g[0].getAttribute(microstrategy.HTMLATTR_DSS_ID);var X=g[0].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(I&&P&&P.length>0){var G={addShortcutMetricSum:12,addShortcutMetricCount:13,addShortcutMetricAvg:14,addShortcutMetricMin:15,addShortcutMetricMax:16,addShortcutMetricStdDev:32,addShortcutMetricVar:33}[c];L.push(I.createActionObject(this,mstrUpdateManager.RW_ADD_SHORTCUT_METRIC,this.parentBone.beanPath,["2048032","2048033","2048249","2048251"],[q,this.parentBone.getDatasetType(q),G,P+","+X],[]));}if(L.length>0){I.add(L);I.flushAndSubmitChanges();}}break;case"removeUserMetric":if(this.isMulti()&&!this.isSameType()){return false;}var O="";var o="";for(var e=0;e<g.length;e++){if(g[e]!=null){O+=o+q+mstrUpdateManager.UNIT_SEPARATOR+g[e].getAttribute(microstrategy.HTMLATTR_DSS_ID);o=mstrUpdateManager.ITEM_SEPARATOR;}}if(O.length>0){var I=this.parentBone.updateManager;var L=new Array();if(I){L.push(I.createActionObject(this,mstrUpdateManager.REMOVE_DERIVED_METRICS_FROM_DATASET,this.parentBone.beanPath,["2048075","2048018"],[O,"1"],[]));}if(L.length>0){I.add(L);I.flushAndSubmitChanges();}}break;case"formatUserMetric":return(this.docViewerBone.commands.exec("openFormatDMetric",g));break;default:return false;}}catch(F){microstrategy.errors.log(F);return null;}};mstrRWObjSelectionsImpl.prototype.getDataSets=function(){var A=microstrategy.bone("rwb_viewer")["documentDataSets"];if(A){return A;}return null;};mstrRWObjSelectionsImpl.prototype.loadAttributeLinkTarget=function loadAttributeLinkTarget(){var G=microstrategy.getContextMenuManager("RWObjB"),C=G.findMenuItem(microstrategy.descriptors.getDescriptor("2901")),F=this.clickedSrc.getAttribute(microstrategy.HTMLATTR_DSS_ID),A=this.clickedSrc.getAttribute(microstrategy.HTMLATTR_ID).substring(0,32),E=function E(I,J){var R=microstrategy.bone("rwb_viewer")["datasetInfos"],N,O,Q,M,P,L,H,K,S;for(N in R){O=R[N].att;for(L=0,H=O.length;L<H;L++){Q=O[L];if(Q.did==I){M=Q.fs;for(K=0,S=M.length;K<S;K++){P=M[K];if(J==P.fid&&P.idf){return true;}}break;}}}return false;},B=function B(){var L=getMenuDiv(aMenuItemsName+2),K=L.getElementsByTagName("tr"),H,I,J;if(K!=null){for(H=0,I=K.length;H<I;H++){J=K[H];J.parentNode.removeChild(J);}}},D={success:function(m){var h=m.als,T=h[0].ats,g=microstrategy.bone("rwb_viewer")["als"],H=microstrategy.bone("rwb_viewer")["datasetInfos"],J=g&&g.links||{},L={},c={},e={},O=false,X,N,V,R,Q,I,M,U,P,Z,Y,a,W,K,S;for(X=0,N=T.length;X<N;X++){Q=T[X].at;I=T[X].fms;for(V=0,R=I.length;V<R;V++){M=I[V].fm;if(E(Q,M)){L[Q]=true;O=true;break;}}}for(U in J){if(U.indexOf(F+" ")==0){P=J[U];for(X=0,N=P.length;X<N;X++){Z=P[X].split(" ")[0];L[Z]=true;O=true;}break;}}Y=G.getMenu();if(O){for(U in H){P=H[U];T=P.att;for(X=0,N=T.length;X<N;X++){Q=T[X];if(L[Q.did]){if(!e[Q.n]){e[Q.n]={};}if(!e[Q.n][Q.did]){e[Q.n][Q.did]=[];}e[Q.n][Q.did].push(P.name);c[Q.did]=Q;}}}for(Z in L){Q=c[Z];W=Q.n;K=e[Q.n];if(K){S=0;for(U in K){S++;}if(S>1){W+=" ("+K[Q.did].join(",")+")";}}a=Y.addItem(W,"microstrategy.bone('reportObjs_RWWorkingSetStyle').selections.confirmAttributeLinking('"+Z+"')",null,null,mstrContextMenuImpl.IMG_CHECK);a[9]="microstrategy.bone('reportObjs_RWWorkingSetStyle').selections.showAttributeLinkingCheckmark('"+Z+"')";}}else{Y.addItem(microstrategy.descriptors.getDescriptor("13398"),"");}B();addDynamicMenus(2,G.menu_items,Y.menu_items);loadAttributeLinkTarget.attrMenu[F]=Y.menu_items;loadAttributeLinkTarget.cmmMenuItemSize=G.menu_items.length;}};if(!loadAttributeLinkTarget.attrMenu||(loadAttributeLinkTarget.cmmMenuItemSize!=G.menu_items.length)){loadAttributeLinkTarget.attrMenu={};}if(!loadAttributeLinkTarget.attrMenu[F]){C[0][2]=mstrContextMenuImpl.IMG_LOADING;mstrmojo.xhr.request("POST",mstrConfig.taskURL,D,{taskId:"validateDocumentLinks",msgID:mstrApp.getMsgID(),action:1,attributeList:F});}else{window.setTimeout(function(){B();addDynamicMenus(2,G.menu_items,loadAttributeLinkTarget.attrMenu[F]);},0);}return true;};mstrRWObjSelectionsImpl.prototype.isAttributesLinked=function(G,F){var H=microstrategy.bone("rwb_viewer")["als"],D=H&&H.links||{},C,B,E,A;for(C in D){if(C.indexOf(G+" ")==0){B=D[C];for(E=0,A=B.length;E<A;E++){if(B[E].indexOf(F+" ")==0){return true;}}}}return false;};mstrRWObjSelectionsImpl.prototype.showAttributeLinkingCheckmark=function(A){var B=this.clickedSrc.getAttribute(microstrategy.HTMLATTR_DSS_ID);return(this.clickedSrc.getAttribute(microstrategy.HTMLATTR_LINK_TO)=="1"&&this.isAttributesLinked(B,A));};mstrRWObjSelectionsImpl.prototype.confirmAttributeLinking=function(C){var E=this.clickedSrc.getAttribute(microstrategy.HTMLATTR_DSS_ID),D=function D(G){var O=microstrategy.bone("rwb_viewer")["datasetInfos"],K,L,N,J,M,I,F,H,P;for(K in O){L=O[K].att;for(I=0,F=L.length;I<F;I++){N=L[I];if(N.did==G){J=N.fs;for(H=0,P=J.length;H<P;H++){M=J[H];if(M.idf){return M.fid;}}break;}}}};if(this.clickedSrc.getAttribute(microstrategy.HTMLATTR_LINK_TO)=="1"&&this.isAttributesLinked(E,C)){return ;}var B=this,A=function(){B.attributeLinking(E,D(E),C,D(C),false);};microstrategy.bone("rwb_viewer").showWarningMessageForUnsupportFeature(A);};mstrRWObjSelectionsImpl.prototype.confirmAttributeUnlinking=function(){var F=microstrategy.bone("rwb_viewer")["als"],K=F&&F.links||{},M=this.clickedSrc.getAttribute(microstrategy.HTMLATTR_DSS_ID),A=[],C=[],E=[],H="\u001E",B,J,I,L,D,G;for(B in K){I=B.split(" ");if(I[0]===M){J=K[B];for(D=0,G=J.length;D<G;D++){L=J[D].split(" ");C.push(L[0]);E.push(L[1]);A.push(I[1]);}}}this.attributeLinking(M,A.join(H),C.join(H),E.join(H),true);};mstrRWObjSelectionsImpl.prototype.attributeLinking=function(D,H,G,F,A){var B=this.parentBone.updateManager,C=[],E=microstrategy.bone("rwb_viewer");C.push(B.createActionObject(this,mstrUpdateManager.LINK_ATTRIBUTES,this.parentBone.beanPath,["2048262","2048286","2048287","2048288","2048289"],[D,H,G,F,A],[]));E.checkAndDisableFlashDefaultMode(B,C);B.add(C);B.flushAndSubmitChanges();};mstrRWObjSelectionsImpl.prototype.enableAttributeLinking=function(){var C=this.getDataSets();if(C==null){return ;}var A=0,B;for(B in C){A++;}if(A<=1){var D=microstrategy.getContextMenuManager("RWObjB").findMenuItem(microstrategy.descriptors.getDescriptor("9747"));D[0][3]="0";return false;}return true;};mstrRWObjSelectionsImpl.prototype.enableAttributeUnlinking=function(){var D=microstrategy.bone("rwb_viewer")["als"],B=D&&D.links||{},C=this.clickedSrc.getAttribute(microstrategy.HTMLATTR_DSS_ID),A;for(A in B){if(A.indexOf(C+" ")==0){return true;}}return false;};mstrRWObjSelectionsImpl.prototype.enableContextMenuItem=function(H){try{var E=false,K=microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.getViewerBone().currentRWViewMode==microstrategy.RW_VIEW_MODE_EDITABLE),O=(function(a){var X=true,Z=a.getDataSetId();if(Z&&(Z.length>0)){var c=microstrategy.bone("rwb_viewer"),W=c.datasetInfos,Y=W&&W[Z];if(Y.isDDA&&Y.isMDX||microstrategy.hasCGorCon(Y)){X=false;}}return X;})(this);switch(H){case"addToSectionWithFormat":case"addToSection":case"addToSectctionAsShortcut":if(this.clickedSrc.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE)==microstrategy.DSSTYPE_REPORT_CUBE){break;}case"addToSectionAsStatic":var J=this.parentBone.elem.getAttribute("at");if(J!=null&&J.length>0){var D=microstrategy.bone(J);if(D&&D.commands.queryEnabled("subSectionIsSelected")){var Q=","+this.getDssTypes().toString()+",";var M=(Q.indexOf(","+microstrategy.DSSTYPE_RPT_DEFINITION+",")!=-1);var T=(Q.indexOf(","+microstrategy.DSSTYPE_ATTRIBUTE_FORM+",")!=-1);var L=new Array(microstrategy.DSSTYPE_METRIC,microstrategy.DSSTYPE_USER_METRIC,microstrategy.DSSTYPE_ATTRIBUTE,microstrategy.DSSTYPE_FILTER,microstrategy.DSSTYPE_CONSOLIDATION,microstrategy.DSSTYPE_CUSTOM_GROUP,microstrategy.DSSTYPE_DIMENSION,microstrategy.DSSTYPE_USER_SUMMARY_METRIC);for(var P=0;P<L.length;P++){var G=new RegExp(","+L[P]+",","g");Q=Q.replace(G,"~");}var V=(Q.indexOf("~")!=-1);var R=((M&&!T&&!V)||(!M&&T&&!V)||(!M&&!T&&V));if(R){if(M){var F=D.commands.queryState("selectedSection");if(F&&F.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)!=microstrategy.TRUE){E=true;}}else{E=true;}}}}break;case"addToSectionAsSelector":var J=this.parentBone.elem.getAttribute("at");if(J!=null&&J.length>0){var D=microstrategy.bone(J);if(D&&D.commands.queryEnabled("subSectionIsSelected")){if(this.isMulti()){return false;}return true;}}break;case"addDerivedAttr":if(!K||!O){return false;}case"addUserMetric":var Q=","+this.getDssTypes().toString()+",";var M=(Q.indexOf(","+microstrategy.DSSTYPE_RPT_DEFINITION+",")!=-1);if(M){E=(this.getDataSetId()!=null);}else{var N=this.getDataSetIDs();N.sort();return(N[0]==N[N.length-1]);}break;case"editDerivedAttr":if(!K||!O){return false;}case"removeDerivedAttr":return !this.isMulti()&&this.clickedSrc.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_ATTRIBUTE&&this.clickedSrc.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE)==microstrategy.DSSSUB_TYPE_DERIVED_ATTRIBUTE;case"addToGrouping":var S=this.determineIsValid();if(!S){return false;}var U=false;var J=this.parentBone.elem.getAttribute("at");if(J!=null&&J.length>0){var D=microstrategy.bone(J);var I=this.getItems();for(var P=0;P<I.length;P++){if(microstrategy.isValidGroupByType(I[P].getAttribute(microstrategy.HTMLATTR_DSS_TYPE))){var A=I[P].oid||I[P].getAttribute("oid");var B=D.commands.queryState("groupByDssIds");U=(B.indexOf("|"+A+"|")==-1);if(U){break;}}}}return(U);break;case"attributeUnlinking":return this.clickedSrc.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_ATTRIBUTE&&this.clickedSrc.getAttribute(microstrategy.HTMLATTR_LINK_TO)=="1";break;}return E;}catch(C){microstrategy.errors.log(C);return null;}};mstrRWObjSelectionsImpl.prototype.determineIsValid=function(){try{var B=this.parentBone.elem.getAttribute("at");var A=false;if(B!=null){A=microstrategy.bone(B).groupByPresent;}var C=microstrategy.primeDataSetId!=null&&microstrategy.primeDataSetId!=-1;if(C&&this.getDataSetId()!=microstrategy.primeDataSetId&&(microstrategy.sortDefinedOnDefault||A)){return false;}return true;}catch(D){microstrategy.errors.log(D);return null;}};mstrRWObjSelectionsImpl.prototype.isEditableViewModeEplus=function(){var A=microstrategy.bone("rwb_viewer");if(!A||A.isEditableViewModeEplus()){return true;}else{return false;}};function mstrRWObjSelectionsImpl(){this.inherits=mstrObjSelectionsImpl;this.inherits();delete this.inherits;var A=document.createElement("img");A.src=microstrategy.FOLDER_IMAGES+"dragRectangle.gif";A.className="mstrDnDRWDragItem";A.style.zIndex="10000";this.dragDisplay=document.body.appendChild(A);return this;}mstrTransparentMask.prototype=new Object();mstrTransparentMask.prototype.sides=null;mstrTransparentMask.prototype.offset=3;mstrTransparentMask.prototype.resize=function(B){try{this.sides.top.style.width=this.sides.bottom.style.width=(B.right-B.left)+"px";this.sides.left.style.height=this.sides.right.style.height=(B.bottom-B.top)+"px";}catch(A){microstrategy.errors.log(A);return null;}};mstrTransparentMask.prototype.moveTo=function(A,C){try{this.sides.top.style.top=this.sides.left.style.top=this.sides.right.style.top=C+"px";this.sides.bottom.style.top=(C+parseInt(this.sides.left.style.height)-2)+"px";this.sides.top.style.left=this.sides.left.style.left=this.sides.bottom.style.left=A+"px";this.sides.right.style.left=(A+parseInt(this.sides.top.style.width)-2)+"px";}catch(B){microstrategy.errors.log(B);return null;}};mstrTransparentMask.prototype.show=function(){try{for(var B in this.sides){this.sides[B].style.display="inline";}}catch(A){microstrategy.errors.log(A);return null;}};mstrTransparentMask.prototype.hide=function(){try{for(var B in this.sides){this.sides[B].style.display="none";}}catch(A){microstrategy.errors.log(A);return null;}};function mstrTransparentMask(A){try{this.sides=new Object();var C=document.createElement("span");C.className="mstrTransparentMaskSide";C.style.height=this.offset+"px";C.style.width=this.offset+"px";this.sides.top=A.appendChild(C.cloneNode(false));this.sides.right=A.appendChild(C.cloneNode(false));this.sides.bottom=A.appendChild(C.cloneNode(false));this.sides.left=A.appendChild(C.cloneNode(false));return this;}catch(B){microstrategy.errors.log(B);return null;}}fnShowMessageAdd=function(A,B){showMessage({contents:microstrategy.descriptors.getDescriptor("8498"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:A,buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("219"),Cancel:microstrategy.descriptors.getDescriptor("218")},cancelEval:B,type:mstrMsgBoxImpl.MSG_PREF_WARNING});};mstrDocViewerImpl.prototype=new mstrStaticDocViewer();mstrDocViewerImpl.prototype.superClass=mstrEditorImpl.prototype;mstrDocViewerImpl.prototype.updateManager=microstrategy.updateManager;mstrDocViewerImpl.prototype.nextId=0;mstrDocViewerImpl.prototype.selectedObjects="";mstrDocViewerImpl.prototype.rArrowDND;mstrDocViewerImpl.prototype.rootNodeKey="";mstrDocViewerImpl.prototype.dirtySections=[];mstrDocViewerImpl.prototype.dScrollTop=0;mstrDocViewerImpl.prototype.dScrollLeft=0;mstrDocViewerImpl.prototype.allVisList=null;mstrDocViewerImpl.prototype.renderedPanelStyles=null;mstrDocViewerImpl.prototype.ruleCounter=0;mstrDocViewerImpl.prototype.timeoutQueue=new Object;mstrDocViewerImpl.prototype.callbackOnReload=null;mstrDocViewerImpl.prototype.onload=function(){try{mstrStaticDocViewer.prototype.onload.call(this);if(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){this.objProps=new mstrObjectPropsImpl(this);}this.elem.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e)");if(this.layoutHeightMode==1){this.callDelayedResize();if(this.scrollTopPosition!=0||this.scrollLeftPosition!=0){this.delayedScrollAdjust(this.scrollTopPosition,this.scrollLeftPosition);}}this.onLoadCalled=true;if(this.keepAlive){window.setTimeout("microstrategy.getViewerBone().commands.exec('ping');",this.keepAlive);}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.onreload=function(){mstrStaticDocViewer.prototype.onreload.call(this);if(this.updatedFGKeys){this.partialUpdateFGS();}};mstrDocViewerImpl.prototype.onpostload=function(){try{mstrStaticDocViewer.prototype.onpostload.call(this);if(this.selectedObjects!=""){this.doc.selections.reselect(this.selectedObjects);this.selectedObjects="";}if(this.observer){this.observer.notifyAll("onselectionchange");}if(this.dirtySections.length>0){var B=this.updateManager;var F=[];var G=false;for(var D=0,A=this.dirtySections.length;D<A;D++){var H=this.dirtySections[D].bone;var C=this.dirtySections[D].isTarget;G=(G||C);H.wireTargets(F,this.beanPath,C);}if(F.length>0){B.add(F,true);}this.dirtySections=[];}if(this.callbackOnReload){this.callbackOnReload();this.callbackOnReload=null;}}catch(E){microstrategy.errors.log(E);}};mstrDocViewerImpl.prototype.partialUpdateFGS=function(){var I=this.updatedFGKeys;var E=this.updatedFGData;for(var F in E){var C=E[F];var K=C.sectionKey;for(var A in C){if(A=="sectionKey"){continue;}var B=C[A];var G=document.getElementsByName(A);for(var H=0;G&&H<G.length;H++){if(!B||(H+1>B.length)){G[H].parentNode.removeChild(G[H]);}else{G[H].innerHTML=B[H].value;G[H].className=B[H].cssClass;}}if(!G||(B&&(G.length<B.length))){var D=G?0:G.length;for(var H=D;H<B.length;H++){var J=document.createElement("span");J.id=A;J.setAttribute("name",A);J.setAttribute("sty",106);J.setAttribute("ty","obj");J.innerHTML=B[H].value;J.className=B[H].cssClass;if(document.getElementById(K)){document.getElementById(K).appendChild(J);}}}}}this.updatedFGKeys=undefined;this.updatedFGData=undefined;};mstrDocViewerImpl.prototype.onmousedown=function(C){try{if(!C){C=window.event;}getMouse(C);var B=getEventTarget(C);if(this.isEditableViewModeEplus()&&!mstrGridStatic.isMouseOverScrollBar(this.elem,lMouseX,lMouseY)){if(B==this.elem||B.firstChild==this.doc.elem){this.doc.selections.clear();}}if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){var D=microstrategy.eventManager.getSource(C);if(D&&D.elem&&D.elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_RULER){return this.doc.selections.onmousedown(C);}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocViewerImpl.prototype.adjustScrollValues=function(C){try{var A=document.createElement("img");document.body.appendChild(A);A.parentNode.removeChild(A);this.elem.onmousemove=null;this.dScrollTop=this.elem.scrollTop;this.dScrollLeft=this.elem.scrollLeft;return true;}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.onnotifydrag=function(A,D,B){try{if(this.isEditableViewModeEplus()){this.doc.onnotifydrag(A,D,B);}}catch(C){microstrategy.errors.log(C);}};mstrDocViewerImpl.prototype.onnotifydragend=function(B){try{if(this.isEditableViewModeEplus()){this.doc.onnotifydragend(B);}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.onpanelchange=function(){try{this.doc.onpanelchange();}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.onPanelDeleted=function(B){try{this.doc.onPanelDeleted(B);}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.ondocumentclick=function(B){try{if(this.doc){this.doc.ondocumentclick(B);}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.onSubSectionResize=function(){try{if(this.docRszHandler&&this.tempHandler){var A=getObjHeight(this.doc.elem)+"px";this.docRszHandler.style.height=A;this.tempHandler.style.height=A;}this.doc.onSubSectionResize();return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocViewerImpl.prototype.onwinresize=function(){try{this.callDelayedResize();}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.getAvailableWidgets=function(B){try{var F=[];for(var D=0,C=this.widgets.length;D<C;D++){var A=this.widgets[D];if(A.scope==B){F.push({dssid:A.rslPath||A.fqcn,n:A.title,mxsp:A.maxSecondaryProviders,mnsp:A.minSecondaryProviders,isVis:A.isVis});}}return F;}catch(E){microstrategy.errors.log(E);return F;}};mstrDocViewerImpl.prototype.getAvailableObjs=function(D){try{var G=[],H=this["document"+D];if(H){for(var C=0,B=H.length;C<B;C++){var A=H[C];var F={dssid:A.id+"|"+A.ty+"|"+A.n,n:(A.als||A.n)};if(A.dsn){F.dsn=A.dsn;}if(D==="Attributes"&&A.sty){F.sty=A.sty;}if(D==="Attributes"){if(A.olap){F.olap=A.olap;}if(A.de){F.de=A.de;}}G.push(F);}}return G;}catch(E){microstrategy.errors.log(E);return G;}};mstrDocViewerImpl.prototype.getAvailableAttributes=function(){return this.getAvailableObjs("Attributes");};mstrDocViewerImpl.prototype.getAvailableMetrics=function(){return this.getAvailableObjs("Metrics");};mstrDocViewerImpl.prototype.getPureAttributes=function(){try{var E=[],F=this["documentAttributes"];if(F){for(var C=0,B=F.length;C<B;C++){var A=F[C];if(A.ty!=microstrategy.DSSTYPE_CONSOLIDATION&&!(A.ty==microstrategy.DSSTYPE_FILTER&&A.sty==microstrategy.DSSTYPE_CUSTOM_GROUP)){E.push({dssid:A.id+"|"+A.ty+"|"+A.n,n:(A.als||A.n)});}}}return E;}catch(D){microstrategy.errors.log(D);return E;}};mstrDocViewerImpl.prototype.getAttributesWithDateForms=function(){try{var E=[],F=this["documentAttributes"],A=this["datasetInfos"],C={};if(A&&F){for(var D in A){mstr.$A.forEach(A[D].att,function(G){if(!C[G.did]&&G.t!=microstrategy.DSSTYPE_CONSOLIDATION&&!(G.t==microstrategy.DSSTYPE_FILTER&&G.st==microstrategy.DSSTYPE_CUSTOM_GROUP)&&!G.de){mstr.$A.forEach(G.fs,function(H){if(H.idf&&(H.obf||G.da)&&(H.bftp==8||H.bftp==1)){C[G.did]=true;return false;}});}});}mstr.$A.forEach(F,function(G){if(C[G.id]){E.push({dssid:G.id+"|"+G.ty+"|"+G.n,n:(G.als||G.n)});}});}return E;}catch(B){microstrategy.errors.log(B);return E;}};mstrDocViewerImpl.prototype.getAttributesType=function(){try{var E=[],F=this["documentAttributes"];if(F){for(var C=0,B=F.length;C<B;C++){var A=F[C];E.push({type:A.ty+"|"+A.sty,n:A.n});}}return E;}catch(D){microstrategy.errors.log(D);return E;}};mstrDocViewerImpl.prototype.delay=function(eval){try{var timeoutID=window.setTimeout("microstrategy.bone('"+this.id+"')."+eval,0);if(this.timeoutQueue[eval]){window.clearTimeout(this.timeoutQueue[eval]);}this.timeoutQueue[eval]=timeoutID;}catch(err){microstrategy.errors.log(err);}};mstrDocViewerImpl.prototype.onunload=function(){try{mstrBoneImpl.prototype.onunload.call(this);if(this.observer){this.observer.onunload();}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.onredo=function(B){try{switch(B.id){case mstrUpdateManager.PASTE_FORMATTING:this.objProps.onredo(B);break;default:this.doc.onredo(B);break;}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocViewerImpl.prototype.onundo=function(B){try{switch(B.id){case mstrUpdateManager.PASTE_FORMATTING:this.objProps.onundo(B);break;default:this.doc.onundo(B);break;}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocViewerImpl.prototype.initViewer=function(){try{mstrStaticDocViewer.prototype.initViewer.call(this);if(this.observer){this.observer.onload();}if(this.isEditableViewModeEplus()){this.initRulers();}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.initRulers=function(){try{if(this.doc){for(var J in this.doc.sections){var D=this.doc.sections[J];for(var F in D.subsections){var A=D.subsections[F];if((A.ruler)&&(A.ruler!=null)){this.rulers[A.id]=A.ruler;}if(A.elem&&A.elem.childNodes){for(var C=0;C<A.elem.childNodes.length;C++){var H=A.elem.childNodes[C];if((H.nodeType==1)&&(H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=null)&&(H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_VRULER)){this.rulers[A.id+C]=H;}}}}}this.rulers[this.id]=microstrategy.objectFind(this.elem,["DIV"],microstrategy.OBJTYPE_RULER);this.rulerShade=microstrategy.subObjectFind(this.rulers[this.id],["DIV"],microstrategy.SUBOBJTYPE_HRULER_SHADE);this.rulerTicker=document.getElementById("rArrow");if(this.rulerTicker){this.rulerTicker.style.left=getObjWidth(this.doc.elem)-parseInt(getObjWidth(this.rulerTicker)/2)+"px";this.rulerTicker.style.top="2.5px";}this.docRszHandler=document.getElementById("docRszHandler");if(this.docRszHandler){var I=getObjHeight(this.doc.elem);var G=getObjTop(this.doc.elem);this.docRszHandler.style.left=this.doc.elem.style.width;this.docRszHandler.style.top=G+"px";this.docRszHandler.style.height=I+"px";var E=microstrategy.styleObj.getValue(this.docRszHandler,"backgroundColor");this.docRszHandler.onmouseover=new Function("this.style.cursor = 'e-resize';");this.docRszHandler.onmouseout=new Function("this.style.cursor = 'auto';");if(!this.tempHandler){this.tempHandler=document.createElement("img");this.tempHandler.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";this.tempHandler.style.position="absolute";this.tempHandler.style.zIndex=2;this.tempHandler.style.backgroundColor="#ffff00";this.tempHandler.style.left=this.doc.left+"px";this.tempHandler.style.top=this.docRszHandler.style.top;this.tempHandler.style.width="3px";this.tempHandler.style.height=I+"px";}this.dObj=new mstrDragnDropObjImpl("docRszHandler","microstrategy.bone('"+this.id+"').dObj","microstrategy.bone('"+this.id+"').rArrowDragEndEvent()",this.doc,this.tempHandler,this);this.doc.updateHRulerWidth();}if(this.rulerTicker){this.rArrowDND=new mstrDragnDropObjImpl("rArrow","microstrategy.bone('"+this.id+"').rArrowDND","microstrategy.bone('"+this.id+"').rArrowDragEndEvent()",this.doc,this.tempHandler,this);}}}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.syncDocRszHandler=function(){try{if(!this.docRszHandler){this.docRszHandler=document.getElementById("docRszHandler");}if(this.docRszHandler){this.docRszHandler.style.left=getObjWidth(this.doc.elem)+"px";this.docRszHandler.style.top=getObjTop(this.doc.elem)+"px";this.docRszHandler.style.height=getObjHeight(this.doc.elem)+"px";}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.rArrowDragEndEvent=function(){try{var F=mstrFormatObject;var A=parseInt(microstrategy.styleObj.getValue(this.doc.elem,"width"));var E=getObjLeft(this.docRszHandler);if(this.rulerTicker){var D=getObjLeft(this.rulerTicker)+parseInt(getObjWidth(this.rulerTicker)/2);if(D==A){this.rulerTicker.style.left=E-parseInt(getObjWidth(this.rulerTicker)/2)+"px";}}if(E==A&&this.rulerTicker){this.docRszHandler.style.left=D+"px";}this.doc.elem.style.width=getObjLeft(this.docRszHandler)+"px";var C=[];this.doc.saveDocProperty("width",this.doc.elem.style.width,C);if(this.usePageWidthAsLayoutWidth!=0){this.usePageWidthAsLayoutWidth=0;this.doc.saveDocProperty("UsePageWidthAsLayoutWidth",this.usePageWidthAsLayoutWidth,C);}if(C.length){microstrategy.updateManager.add(C,true);}if(this.tempHandler){this.doc.elem.removeChild(this.tempHandler);}if(getObjWidth(this.doc.elem)<this.doc.minWidth){this.doc.minWidth=getObjWidth(this.doc.elem);}this.docRszHandler.style.backgroundColor="";this.doc.displayPageBreaker();if(this.viewer100wm!=null){this.resize100WMObjects();}this.doc.updateHRulerWidth();}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.removeFrom100HMObjects=function(C){try{var E=document.getElementById(C);if(E!=null){var A=microstrategy.findBone(E);if(A!=null&&A.elem!=null){var B=A.elem.getAttribute("id");if(this[B+"_100hm"]!=null){this[B+"_100hm"]=this[B+"_100hm"].replace(C+",","");}}}}catch(D){microstrategy.errors.log(D);}};mstrDocViewerImpl.prototype.addTo100HMObjects=function(C){try{var E=document.getElementById(C);if(E!=null){var A=microstrategy.findBone(E);if(A!=null&&A.elem!=null){var B=A.elem.getAttribute("id");if(this[B+"_100hm"]!=null){if(this[B+"_100hm"].indexOf(C)<0){this[B+"_100hm"]=this[B+"_100hm"].concat(C+",");}}else{this[B+"_100hm"]=C+",";}}}}catch(D){microstrategy.errors.log(D);}};mstrDocViewerImpl.prototype.removeFrom100WMObjects=function(C){try{var E=document.getElementById(C);if(E!=null){var A=microstrategy.findBone(E);if(A!=null&&A.elem!=null){var B=A.elem.getAttribute("id");if(this[B+"_100wm"]!=null){this[B+"_100wm"]=this[B+"_100wm"].replace(C+",","");}}}if(String(this.viewer100wm).indexOf(C)>-1){this.viewer100wm=this.viewer100wm.replace(C+",","");}}catch(D){microstrategy.errors.log(D);}};mstrDocViewerImpl.prototype.addTo100WMObjects=function(C){try{var E=document.getElementById(C);if(E!=null){var A=microstrategy.findBone(E);if(A!=null&&A.elem!=null){var B=A.elem.getAttribute("id");if(this[B+"_100wm"]!=null){if(this[B+"_100wm"].indexOf(C)<0){this[B+"_100wm"]=this[B+"_100wm"].concat(C+",");}}else{this[B+"_100wm"]=C+",";}}}if(this.viewer100wm!=null){if(String(this.viewer100wm).indexOf(C)<0){this.viewer100wm+=C+",";}}else{this.viewer100wm=C+",";}}catch(D){microstrategy.errors.log(D);}};mstrDocViewerImpl.prototype.turnOffRulerShade=function(){try{if(this.rulerShadeOn&&this.rulerOn&&this.rulerShade){this.rulerShade.style.width=0;this.rulerShade.style.left=0;for(var D in this.doc.sections){var B=this.doc.sections[D];for(var A in B.subsections){var E=B.subsections[A];E.turnOffRulerShade();}}this.rulerShadeOn=false;}}catch(C){microstrategy.errors.log(C);}};mstrDocViewerImpl.prototype.turnOnRulerShade=function(A){try{if(!this.rulerShadeOn&&this.rulerOn&&this.rulerShade){this.rulerShade.style.width=(A.right-A.left+3)+"px";this.rulerShade.style.left=(A.left-this.doc.left)+"px";this.rulerShadeOn=true;}}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.dragRulerShade=function(J,I,E){try{if(this.rulerShadeOn&&this.rulerOn&&this.rulerShade){xOffset=J-1-this.doc.left;if(xOffset>0){this.rulerShade.style.left=xOffset+"px";this.rulerShade.style.width=(E.right-E.left)+"px";}var M=E.bottom-E.top+3;for(var L in this.doc.sections){var F=this.doc.sections[L];for(var G in F.subsections){var B=F.subsections[G];var C=getObjSumTopScrolled(B.elem);var H=C+getObjHeight(B.elem);var A=I-C;var K=((A%2)>0)?1:0;if((I>=C)&&(I<=H)){B.turnOnRulerShade(E);B.dragRulerShade(A);}else{if((I>=C)&&((I+M)>=H)){B.turnOnRulerShade(E);B.dragRulerShade(A);}else{if(((I+M)>=C)&&(I<=C)){B.turnOnRulerShade(E);B.dragRulerShade(A);}else{B.turnOffRulerShade();}}}}}}}catch(D){microstrategy.errors.log(D);}};mstrDocViewerImpl.prototype.toggleRuler=function(){try{for(var D in this.rulers){var E=this.rulers[D];if(E){E.style.display=(this.rulerOn)?"none":"block";}}var C=document.getElementById("hRulerRow");if(C!=null){if(bIsW3C){C.style.display=(this.rulerOn)?"none":"table-row";}else{C.style.display=(this.rulerOn)?"none":"block";}}var A=document.getElementById("vRulerCol");if(A!=null){A.className=A.className.replace(/ off/g,"")+(this.rulerOn?" off":"");}this.rulerOn=!this.rulerOn;this.onwinresize();if(this.observer){this.observer.notifyAll("onstatechange");}this.updateManager.add([this.updateManager.createActionObject(null,mstrUpdateManager.SET_RULERS_DISPLAY,this.beanPath,["55002"],[this.rulerOn],[])],true);return this.rulerOn;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocViewerImpl.prototype.toggleGrid=function(){try{if(this.doc){for(var D in this.doc.sections){var B=this.doc.sections[D];for(var A in B.subsections){B.subsections[A].toggleGrid(this.gridOn);}}}this.gridOn=!this.gridOn;this.toggleDivider(this.gridOn);if(this.observer){this.observer.notifyAll("onstatechange");}this.updateManager.add([this.updateManager.createActionObject(null,mstrUpdateManager.SET_ALIGNMENT_GRID_DISPLAY,this.beanPath,["55002"],[this.gridOn],[])],true);return this.gridOn;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocViewerImpl.prototype.toggleDivider=function(A){try{if(typeof (A)=="undefined"){A=!this.dividerOn;}this.dividerOn=A;var D=0;if(this.doc&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){for(var I in this.doc.sections){var F=this.doc.sections[I];for(var C=0;C<F.sibs.length;C++){var G=F.sibs[C];var H=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE);if(H){for(D=0;D<H.length;D++){H[D].style.display=(this.dividerOn)?"block":"none";}}var E=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);if(E){for(D=0;D<E.length;D++){E[D].style.display=(this.dividerOn)?"block":"none";}}}}this.doc.displayPageBreaker();this.doc.resetMask();if(this.commands){this.commands.exec("SyncSelections");}this.updateManager.add([this.updateManager.createActionObject(null,mstrUpdateManager.SET_DIVIDERS_DISPLAY,this.beanPath,["55002"],[this.dividerOn],[])],true);return this.dividerOn;}}catch(B){microstrategy.errors.log(B);}return null;};mstrDocViewerImpl.prototype.getNextObjId=function(){return this.nextId++;};mstrDocViewerImpl.prototype.getChildBone=function(C){try{if(this.doc==null||!this.doc.isLoaded){return null;}var A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(A){case microstrategy.OBJTYPE_DOC:return this.doc;break;case microstrategy.OBJTYPE_DOC_SUBSECTION:case microstrategy.OBJTYPE_DOC_SECTION:case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:return this.doc.getChildBone(C);break;}return null;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocViewerImpl.prototype.handleTaskModelReadyStateChange=function(A){try{this.doc.handleTaskModelReadyStateChange(A);}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.findParentSubsection=function(C){try{var A=microstrategy.findAncestorWithAtt(C.parentNode,"ty",microstrategy.OBJTYPE_DOC_SUBSECTION);if(A&&A.getAttribute("sty")){A=this.findParentSubsection(A);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocViewerImpl.prototype.isInteractiveViewModeEplus=function(D){if(!D){if(this.isFeatureAvailable(microstrategy.FEATURE_RW_INTERACTIVE_VIEW_MODE_EPLUS)){return true;}else{return false;}}var C=getEventTarget(D);if(!C){return true;}var E=microstrategy.eventManager.getSource(D);var F=false;var A=false;A=(E.bone!=null&&(E.bone.type==microstrategy.OBJTYPE_GRID||(E.bone.commands&&E.bone.commands.queryState("gridType")=="flash")));var B=(E.bone!=null&&(E.subType==microstrategy.SUBOBJTYPE_DOC_TEXT||E.subType==microstrategy.SUBOBJTYPE_DOC_IMAGE));if(this.isEditableViewModeEplus()){F=true;}else{if(this.isFeatureAvailable(microstrategy.FEATURE_RW_INTERACTIVE_VIEW_MODE_EPLUS)&&(A||B)){F=true;}}return F;};mstrDocViewerImpl.prototype.isEditableViewModeEplus=function(){return this.isFeatureAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS);};mstrDocViewerImpl.prototype.hasStylesFor=function(A){try{return this.renderedPanelStyles==null||this.renderedPanelStyles[A];}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.hasMultiDatasets=function(){try{if(!this.noDataset){var A=0;for(var C in this.documentDataSets){A++;if(A>1){return true;}}}return false;}catch(B){microstrategy.errors.log(B);}};function mstrDocViewerImpl(A){this.inherits=mstrStaticDocViewer;this.inherits(A);this.inherits=null;this.primaryBone=true;return this;}mstrDocImpl.prototype=new mstrStaticDoc();mstrDocImpl.prototype.currentControl="cursor";mstrDocImpl.prototype.currentControlSubtype=null;mstrDocImpl.prototype.textEditor=null;mstrDocImpl.prototype.controlSelectionMode=false;mstrDocImpl.prototype.controlSourceUnitID=null;mstrDocImpl.prototype.standAloneControlKey=null;mstrDocImpl.prototype.controlSourceUnitType="";mstrDocImpl.prototype.controlSource="";mstrDocImpl.prototype.resizedSubMaskOnDrag=null;mstrDocImpl.prototype.adjustImageSizeFlag=false;mstrDocImpl.prototype.docMask=null;mstrDocImpl.prototype.docMaskCollection=null;mstrDocImpl.prototype.prevSelectedId=null;mstrDocImpl.prototype.undoRedoSubSections=null;mstrDocImpl.prototype.heightAndWidthAttMap={heightMode:microstrategy.HTMLATTR_HEIGHT_MODE,widthMode:microstrategy.HTMLATTR_WIDTH_MODE,height:microstrategy.HTMLATTR_HEIGHT,width:microstrategy.HTMLATTR_WIDTH};mstrDocImpl.DELETE_MODE={DELETE:1,HIDE:2};mstrDocImpl.INSERT_MODE={ALL_VISIBLE:1,HIDE_OTHERS:2};mstrDocImpl.prototype.onselectionchange=function(A){try{var D=this.prevSelectedId;var B=function(H){if(!H){return ;}var F=document.getElementById(H);if(F&&microstrategy.objectType(F)==microstrategy.OBJTYPE_DOC_SUBSECTION){var E=microstrategy.findBone(F);if(E){E.toggleSelected();}}else{if(H==D&&F&&(F.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT||F.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER)){var G=document.getElementById("docEditTextArea");G&&G.onblur&&G.onblur();}}};B(D);B(A);this.prevSelectedId=A;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocImpl.prototype.onnotifydrag=function(H,K,G){try{if(this.parentBone.isEditableViewModeEplus()){if(K.id==this.id){this.dockMask=this.getMask();this.dockMask.style.display="block";this.dockMask.style.zIndex="101";var A=microstrategy.eventManager.source;this.mouseoffsetLeft=(A.mousedownX-getObjSumLeft(this.elem)+this.parentBone.elem.scrollLeft)-this.selections.range.left;this.mouseoffsetTop=(A.mousedownY-getObjSumTop(this.elem)+this.parentBone.elem.scrollTop)-this.selections.range.top;this.dockMask.style.width=(getClientWidth()-getObjSumLeftScrolled(this.elem))+"px";var M=this.findFirstVerticalNonCollapsedSubMask();if(M){var I=function(O,N,P){O.setAttribute(microstrategy.HTMLATTR_HEIGHT,N);O.style.height=N+P+"px";};var B=M.getAttribute("id");if(B&&B.indexOf("table")!=-1){if(M.rows&&M.rows[0]){var L=M.rows[0];for(var F=0;F<L.cells.length;F++){var E=L.cells[F].firstChild;I(E,getObjHeight(E),Math.max(this.mouseoffsetTop,0));}}}else{I(M,getObjHeight(M),this.mouseoffsetTop);}}this.resizedSubMaskOnDrag=M;microstrategy.eventManager.notifyOrphanBones("ondocobjectdrag",H,this.mouseoffsetLeft,this.mouseoffsetTop);var J=document.getElementById("maskDiv");if(J){J.style.display="block";}}else{if(K.type==microstrategy.OBJTYPE_OBJBROWSER&&bIsIE6){var D=","+G.toString()+",";if(D.indexOf(","+microstrategy.DSSTYPE_RPT_DEFINITION+",")>-1){for(var B in this.sections){if(this.sections[B].isDetails){this.sections[B].setCursor("not-allowed");}}}}}this.selections.onnotifydrag(H,K,G);}}catch(C){microstrategy.errors.log(C);return false;}};mstrDocImpl.prototype.ondocumentclick=function(e){try{if(
/*bIsIE6 && */
this.textEditor!=null&&this.textEditor.onblur!=null){var src=getEventTarget(e);if(src.getAttribute("id")!="docEditTextArea"){this.textEditor.blur(e);}}}catch(err){microstrategy.errors.log(err);}};mstrDocImpl.prototype.onnotifydragend=function(D){try{if(D!=null&&D.id==this.id&&this.parentBone.isEditableViewModeEplus()){this.docMask=this.getMask();var F=this.resizedSubMaskOnDrag;if(F){var H=F.getAttribute("id");var B=F.getAttribute(microstrategy.HTMLATTR_HEIGHT)+"px";if(H&&H.indexOf("table")!=-1){F=F.rows[0];if(F&&F.cells){for(var A=0;A<F.cells.length;A++){var G=F.cells[A].firstChild;G.style.height=G.getAttribute(microstrategy.HTMLATTR_HEIGHT)+"px";}}}else{F.style.height=B;}}this.docMask.style.zIndex="-1";this.docMask.style.display="none";var E=document.getElementById("maskDiv");if(E){E.style.display="none";}}else{for(var H in this.sections){if(this.sections[H].isDetails){this.sections[H].setCursor("");}}}this.resizedSubMaskOnDrag=null;this.selections.onnotifydragend(D);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.onpanelchange=function(){try{if(this.selections){this.selections.onpanelchange();}}catch(A){microstrategy.errors.log(A);}};mstrDocImpl.prototype.findFirstVerticalNonCollapsedSubMask=function(){try{var A=null;for(var B=0;B<this.dockMask.childNodes.length;B++){var A=this.docMask.childNodes[B];var D=A.getAttribute("id");if(D&&D.indexOf("table")>-1){return A;}if(D&&D!="maskDiv"&&A.getAttribute("isCollapsed")!="true"){return A;}}}catch(C){microstrategy.errors.log(C);}return null;};mstrDocImpl.prototype.addPanelMask=function(B){try{if(this.docMaskCollection==null){return ;}var A=microstrategy.findAncestorWithAtt(B.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION).getAttribute("id");for(var C=0;C<B.sibs.length;C++){this.addMask(A,C,B.sibs[C],0);}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.onPanelDeleted=function(D){try{if(this.docMaskCollection==null){return ;}var A=document.getElementsByName(D+"_mask");for(var B=0;B<A.length;B++){A[B].parentNode.removeChild(A[B]);}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.resizeSubMask=function(B,A,G,F){try{if(this.docMaskCollection==null){return ;}var E=this.docMaskCollection[B][A];for(var C=0;C<E.length;C++){E[C].onmaskedobjectresize(G,F);}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.hideSubMask=function(B,A,D){try{if(this.docMaskCollection==null){return ;}var F=this.docMaskCollection[B][A];for(var C=0;C<F.length;C++){F[C].toggleMaskHilite(D);}}catch(E){microstrategy.errors.log(E);}};mstrDocImpl.prototype.resizeSubMaskForSib=function(C,B,E,A,F){try{if(this.docMaskCollection==null){return ;}this.docMaskCollection[C][B][A].onmaskedobjectresizeForSib(E,A,F);}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.hideSubMaskForSib=function(C,B,D,A){try{if(this.docMaskCollection==null){return ;}this.docMaskCollection[C][B][A].toggleMaskHiliteForSib(D,A);}catch(E){microstrategy.errors.log(E);}};mstrDocImpl.prototype.resizeSubMaskForHorizontalContainer=function(A,F,E){try{if(this.docMaskHorizontalCollection==null){return ;}var D=this.docMaskHorizontalCollection[A];for(var B=0;B<D.length;B++){D[B].onmaskedobjectresize(F,E);}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.hideSubMaskForHorizontalContainer=function(A,C){try{if(this.docMaskHorizontalCollection==null){return ;}var E=this.docMaskHorizontalCollection[A];for(var B=0;B<E.length;B++){E[B].toggleMaskHilite(C);}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.getSubMask=function(B,A,F){try{if(this.docMaskCollection!=null){var E=this.docMaskCollection[B][A];for(var C=0;C<E.length;C++){if(E[C].img==F||E[C].imgMap==F.parentNode){return E[C];}}}}catch(D){microstrategy.errors.log(D);}return null;};mstrDocImpl.prototype.getSubMaskBone=function(C,B,A){try{if(this.docMaskCollection!=null){return this.docMaskCollection[C][B][A];}}catch(D){microstrategy.errors.log(D);}return null;};mstrDocImpl.prototype.resetMask=function(){try{if(this.docMask){this.docMask.innerHTML="";}this.docMask=null;this.docMaskCollection=null;this.docMaskHorizontalCollection=null;this.docMask=this.getMask();this.docMask.style.display="none";}catch(A){microstrategy.errors.log(A);}};mstrDocImpl.prototype.getMask=function(){try{if(!this.docMask){this.docMask=document.getElementById("docMask");this.docMask.style.position="absolute";this.docMaskCollection={};this.docMaskHorizontalCollection={};var secCollection=microstrategy.objectListFind(this.elem,"div",microstrategy.OBJTYPE_DOC_SECTION);if(secCollection&&this.docMask.childNodes.length<1){var secTitleHeight;if(secCollection[0]){secTitleHeight=getObjHeight(microstrategy.subObjectFind(secCollection[0],"div",microstrategy.SUBOBJTYPE_TITLEBAR));}for(var i=0;i<secCollection.length;i++){var secId=secCollection[i].getAttribute("id");if(!this.docMaskCollection[secId]){this.docMaskCollection[secId]={};}var subCollection=microstrategy.objectListFind(secCollection[i],"div",microstrategy.OBJTYPE_DOC_SUBSECTION);for(var j=0;j<subCollection.length;j++){this.addMask(secId,j,subCollection[j],secTitleHeight);}}}with(this.docMask.style){position="absolute";left=getObjLeft(this.elem)+"px";top=getObjTop(this.elem)+"px";}}return this.docMask;}catch(err){microstrategy.errors.log(err);return null;}};mstrDocImpl.prototype.addMask=function(O,H,W,L){try{var S=microstrategy.findBone(W);var I=S.id;var X=false;var G=0,R=0,D=0,U=0;var K=function(Z,c,Y){var a=microstrategy.subObjectFind(Z,"div",microstrategy["SUBOBJTYPE_"+Y]);return(a&&window["getObj"+c](a))||0;};if(!this.docMaskCollection[O][I]){this.docMaskCollection[O][I]=[];G=K(S.parentBone.elem,"Height","SUBSECTION_HANDLE");}var T;if(S.isFilterPanel){T=new mstrFilterPanelMaskImpl(O,I,H);}else{T=new mstrSubSectionMaskImpl(O,I,H);}T.parentBone=this;T.path=this.path+".getSubMask('"+O+"', '"+I+"', this)";this.docMaskCollection[O][I].push(T);var V,P,C;if(S.isHorizontal){V=microstrategy.findAncestorWithAtt(W,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);P=microstrategy.findBone(V);T.horizontalBone=P;T.sibIndex=H;C=P.id;var F=this.docMaskHorizontalCollection[C]||[];F.push(T);this.docMaskHorizontalCollection[C]=F;if(!X){R=K(V.parentNode,"Height","SUBSECTION_HANDLE");D=K(S.parentBone.elem,"Width","TITLEBAR");U=K(S.parentBone.elem,"Width","SUBSECTION_HANDLE");X=true;}}S.maskArea=W;T.onload(S);var A=function(Y){T.elem.style.height=parseInt(T.elem.style.height)+Y+"px";T.topOffset=Y;};if(H>0||S.isHorizontal){A((S.isHorizontal)?R:G);}if(H==0&&!S.isHorizontal){A(L);}if(S.isHorizontal){var B,J;if(S.isBeginHorizontalSib(H)&&!microstrategy.findChildWithAtt(this.docMask,"table","id","table_"+C)){var Q=document.createElement("table");Q.setAttribute("id","table_"+C);Q.setAttribute("height",P.height+"px");Q.style.tableLayout="auto";Q.cellSpacing=0;Q.cellPadding=0;B=Q.insertRow(Q.rows.length);J=B.insertCell(B.cells.length);B.setAttribute("id","tr_"+C);J.appendChild(T.elem);this.docMask.appendChild(Q);}else{B=document.getElementById("tr_"+C);J=B.insertCell(B.cells.length);J.appendChild(T.elem);}if(S.isEndHorizontalSib(H)){J.style.width="100%";}T.leftOffset=(H==0)?D:U;if(!S.isEndHorizontalSib(H)){var N=parseInt(T.elem.style.width),M=T.leftOffset;T.elem.style.width=(isNaN(N)?M:(N+M))+"px";}}else{this.docMask.appendChild(T.elem);}}catch(E){microstrategy.errors.log(E);}};mstrDocImpl.prototype.getMaskFromPoint=function(A,H){try{if(this.docMask){var G={left:A,top:H,right:A+1,bottom:H+1};for(var D=0,C=this.docMask.childNodes.length;D<C;D++){var B=this.docMask.childNodes[D];if(B.nodeType==1&&B.getAttribute("id")!="maskDiv"){var F=microstrategy.getRect(B);if(microstrategy.doRectsIntersect(G,F)){return B;}}}}}catch(E){microstrategy.errors.log(E);}return null;};mstrDocImpl.prototype.appendToTextField=function(F,C,K){try{if(!C){return ;}var J=!!K;K=K||[];var B=C.getAttribute("id");var G=document.getElementsByName(B);if(G.length>0){var A=decode(this.styleObj.getAttValue(G[0],microstrategy.HTMLATTR_DSS_FORMULA));if(A.length>0){F=A+" "+F;}var I=this.getTextFieldValues(C,F);if(I.hasChanged){for(var E=0;E<G.length;E++){this.updateSingleTextField(G[E],I.displayValue);}this.styleObj.setAttValue(G[0],microstrategy.HTMLATTR_DSS_FORMULA,I.attributeValue);var H=this.parentBone.updateManager;K.push(H.createActionObject(C,mstrUpdateManager.EDIT_TEXT,this.parentBone.beanPath,["2048012","2048008","2048018"],[B,I.saveValue,mstrUpdateManager.UPDATE_LATER],[B,I.oldValue,mstrUpdateManager.UPDATE_LATER]));}if(!J&&K.length>0){H.add(K);}}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.getAutoTextMacroCode=function(A){try{return{pgNum:"{&PAGE}",totPages:"{&NPAGES}",dateTime:"{&DATETIME}",curUsr:"{&USER}",docName:"{&DOCUMENT}",docDesc:"{&DESCRIPTION}",prjName:"{&PROJECT}",docExecTime:"{&EXECUTIONTIME}",filterDet:"{&FILTERDETAILS}",promptDet:"{&PROMPTDETAILS}",reportDet:"{&REPORTDETAILS}",notes:"{&NOTES}"}[A]||"{&}";}catch(B){microstrategy.errors.log(B);}return"";};mstrDocImpl.prototype.commonRedoUndoCode=function(B,I){try{var z=mstrFormatObject;var K=this.styleObj;var Q=B.cachedArray;var e=B.args;var y=B.elem;var S=(y&&y.getAttribute("id"))||e[0];var L=(y&&{0:y})||null;var o,M,N,O;switch(B.id){case mstrUpdateManager.EDIT_TEXT:N=document.getElementsByName(S);if(N.length>0){var u=this.getTextFieldValues(N[0],e[1]);K.setAttValue(N[0],microstrategy.HTMLATTR_DSS_FORMULA,u.attributeValue);for(o=0,M=N.length;o<M;o++){this.updateSingleTextField(N[o],u.displayValue);}}break;case mstrUpdateManager.MOVE_OBJECT:N=[];var U=(Q.acrossSections==true);if(U){this.deleteItems({0:document.getElementById(S)},false);N=[y];}else{N=document.getElementsByName(S);}for(o=0,M=N.length;o<M;o++){var Z=K.getValue(N[o],"TextDirection")||"0",D=z.decodeValue("left",e[4]),G=z.decodeValue("top",e[3]);if(Z==="0"){N[o].style.left=D;N[o].style.top=G;}else{K.changeVerticalTextPosition(N[o],{x:parseInt(G),y:parseInt(D)});}}if(U){var R=(I=="redo")?Q.newSection:Q.orginalSection;this.addItemsToSubsection(R,y,false);}break;case mstrUpdateManager.EDIT_PROPS:if(B.formatType!=null){microstrategy.formatType=B.formatType;}if(e[e.length-1]){microstrategy.formatType=e[e.length-1];}if(!e[1]){break;}var AC=B.args[1].split(mstrUpdateManager.UNIT_SEPARATOR);S=AC[0];var E=function(a){if(a.charAt(a.length-1)==mstrUpdateManager.ITEM_SEPARATOR){a=a.substr(0,a.length-1);}return a;};var T=this;var P=function(a){T.formatAttribute(L,h,W,false,a);};var F;if(e[1].indexOf("GradientColor")>0){var H=e[1].split(mstrUpdateManager.ITEM_SEPARATOR);var X=function(a){return H[a].split(mstrUpdateManager.UNIT_SEPARATOR)[3];};F=z.decodeValue("backgroundColor",X(0)).slice(1)+","+z.decodeValue("backgroundColor",X(1)).slice(1)+",14,"+X(3)+","+X(4)+","+X(5);}else{if(AC[1]=="Gradient"){F=AC[2];}}if(F){this.formatItems(L,"Gradient",E(F),false);break;}var J=AC[1];var h=z[J][AC[2]][mstrFormatObject.HTML_PROP_NAME];var W=z.decodeValue(h,E(AC[3]));if(J=="FormattingBorder"){var Y,V,AB;if(h.indexOf("b3d")>-1){Y=(h=="b3dstyle")?W:K.getAttValue(y,microstrategy.HTMLATTR_BORDER_3D_STYLE);V=parseInt((h=="b3dweight")?W:K.getAttValue(y,microstrategy.HTMLATTR_BORDER_3D_WEIGHT),10);if(parseInt(Y,10)==0){this.turnOffItem3D(y);}else{this.format3DItems(L,Y,V);}}else{if(h.indexOf("Color2")>-1){Y=K.getAttValue(y,microstrategy.HTMLATTR_BORDER_3D_STYLE);if(parseInt(Y,10)>0){this.process3DItemColorSettings(y,[h.slice(0,h.length-6)],[W],K.getAttValue(y,microstrategy.HTMLATTR_BORDER_3D_WEIGHT));}}else{Y=V=AB="";if(h.indexOf("Color")>-1){AB=W;}else{var A=W.split(" ");V=A[0];Y=A[1];}this.formatItemBorders(L,[h.slice(0,h.length-5)],Y,V,AB,false);}}}else{if(J=="FormattingHTML"&&h=="htmlType"){this.formatHTMLType(L,W);}else{if(J=="FormattingHTML"&&(h=="htmlText"||h=="url")){N=document.getElementsByName(S);if(N.length){var u=this.getHTMLFieldValues(N[0],W);K.setAttValue(N[0],microstrategy["HTMLATTR_HTML_"+((h=="htmlText")?"TEXT":"SOURCE")],u.attributeValue);var n=microstrategy["HTML_CONTAINER_TYPE_"+((h=="htmlText")?"HTML":"IFRAME")];for(o=0,M=N.length;o<M;o++){if(K.getAttValue(N[o],microstrategy.HTMLATTR_HTML_TYPE)==n){microstrategy.findRWObjectBone(N[o],"mstrHTMLContainerImpl").updateContents(n,u);}}}}else{if(J=="FormattingView"&&h=="windowState"){var O="restore";if(W==microstrategy.WINDOW_STATE_MINIMIZED){O="minimize";}else{if(W==microstrategy.WINDOW_STATE_MAXIMIXED){O="maximize";}}this[O+"Portal"](L,h,W,false);}else{if(J=="FormattingAppearance"&&h=="title"){this.formatTitle(L,h,W);}else{if(J=="FormattingAppearance"&&h=="name"){P(microstrategy.HTMLATTR_NAME);}else{if(J=="FormattingNavigation"&&h=="isLink"){this.formatIsLink(L,(W==microstrategy.TRUE));}else{if(J=="FormattingNavigation"&&h=="link"){P(microstrategy.HTMLATTR_LINK_HREF);}else{if(J=="FormattingSection"&&h=="keepSectionTogether"){P(microstrategy.HTMLATTR_KEEP_SECTION_TOGETHER);}else{if(J=="FormattingSection"&&h=="repeatSection"){P(microstrategy.HTMLATTR_REPEAT_SECTION);}else{if(J=="FormattingSection"&&h=="repeatHorizontally"){P(microstrategy.HTMLATTR_REPEAT_HORIZONTALLY);}else{if(J=="FormattingSection"&&h=="forceNewPage"){P(microstrategy.HTMLATTR_FORCE_NEW_PAGE);}else{if(J=="FormattingSection"&&h=="expanded"){this.sections[o].toggleSections(W);}else{if(J=="FormattingFont"&&h.indexOf("textDecoration")>-1){var AA=(AC[2]=="Underline")?4:8;if(parseInt(AC[3],10)>=0){AA=AA*-1;}this.formatUnderlineStrikeout(L,"textDecoration",String(AA));}else{if(J=="FormattingLine"&&h=="orientation"){this.changeLineOrientation(L,z.encodeValue(h,W));}else{if(J=="FormattingLine"&&(h=="lineColor"||h=="lineStyle"||h=="lineWeight")){var m=K.getAttValue(y,microstrategy.HTMLATTR_BORDER_3D_STYLE);if(I=="redo"||!m||m==0){this.formatLineSetting(L,h,W,false,[]);}else{K.setAttValue(y,z.getAttrNameFromStyle(h),z.encodeValue(h,W));}}else{if(I=="redo"&&J=="FormattingSize"&&(h=="oldHeight"||h=="oldWidth")){P(microstrategy["HTMLATTR_OLD_"+h.substr(3).toUpperCase()]);}else{if((J=="FormattingSize"&&h=="maxHeight"||h=="canShrink"||h=="canGrow")||(J=="FomattingSection"&&h=="hideIfEmpty")){}else{if(J=="FormattingSize"&&(h=="height"||h=="heightMode"||h=="width"||h=="widthMode")){var C;if(Q&&I=="redo"){W=Q.origValue;}if(Q&&(Q.subsectionHeight||Q.subsectionWidth)){var g=(I=="redo")?Q.origValue:Q.cachedOldValue;C=(Q.subsectionWidth)?"Horizontal":"";this.formatSubHeightWidth(L,h,[g[0],g[1],z.decodeValue("canGrow"+C,g[2]),z.decodeValue("canShrink"+C,g[3]),z.decodeValue("hideIfEmpty",g[4])]);}else{C=(h.indexOf("Mode")>-1)?"Mode":"";if(Q&&Q.subType==microstrategy.SUBOBJTYPE_DOC_LINE){this.formatLineLength(L,"length"+C,W,null,Q.performFormatChange);}else{this["formatSize"+C](L,h,W,null,Q&&Q.performFormatChange,(C)?Q.updateLayoutWidth:null);}}}else{this.formatItems(L,h,W,false);}}}}}}}}}}}}}}}}}}}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;break;}}catch(q){microstrategy.errors.log(q);}};mstrDocImpl.prototype.onredo=function(D){var G=microstrategy.formatType;try{var A={0:D.elem};var E=D.cachedArray;this.undoRedoSubSections=[];switch(D.id){case mstrUpdateManager.ADD_PANEL_STACK:case mstrUpdateManager.ADD_TEXT:case mstrUpdateManager.ADD_DATASET_TEMPLATE:case mstrUpdateManager.ADD_TEMPLATE:case mstrUpdateManager.ADD_LINE:case mstrUpdateManager.ADD_SHAPE:case mstrUpdateManager.ADD_IMAGE:case mstrUpdateManager.COPY_OBJECT:case mstrUpdateManager.CTRL_ADD:this.addItemsToSubsection(E.parent,D.elem,false);break;case mstrUpdateManager.PASTE_FROM_CLIPBOARD:for(var F=0;F<E.elements.length;F++){this.addItemsToSubsection(E.parents[F],E.elements[F],false);}break;case mstrUpdateManager.APPLY_CONTROL_DEFAULT:this.parentBone.objProps.applyCtrlDft(E.orgObjs,false);break;case mstrUpdateManager.EDIT_TEXT:case mstrUpdateManager.MOVE_OBJECT:case mstrUpdateManager.EDIT_PROPS:this.commonRedoUndoCode(D,"redo");break;case mstrUpdateManager.REMOVE_OBJECT:this.deleteItems(A,false,E.parent);break;}this.selections.syncUp();this.selections.resetRange(false,null);if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}if(this.undoRedoSubSections.length>0){for(var B in this.undoRedoSubSections){var H=this.undoRedoSubSections[B].bone;var I=this.undoRedoSubSections[B].isTarget;H.wireTargets([],this.parentBone.beanPath,I);}}this.undoRedoSubSections=null;return true;}catch(C){microstrategy.errors.log(C);return false;}finally{microstrategy.formatType=G;}};mstrDocImpl.prototype.onundo=function(E){var J=microstrategy.formatType;try{var A={1:E.elem};var F=E.cachedArray;this.undoRedoSubSections=[];switch(E.id){case mstrUpdateManager.ADD_PANEL_STACK:case mstrUpdateManager.ADD_TEXT:case mstrUpdateManager.ADD_DATASET_TEMPLATE:case mstrUpdateManager.ADD_TEMPLATE:case mstrUpdateManager.ADD_IMAGE:case mstrUpdateManager.ADD_LINE:case mstrUpdateManager.ADD_SHAPE:case mstrUpdateManager.COPY_OBJECT:case mstrUpdateManager.CTRL_ADD:this.deleteItems(A,false,F.parent);break;case mstrUpdateManager.PASTE_FROM_CLIPBOARD:for(var H=0;H<F.elements.length;H++){this.deleteItems({i:F.elements[H]},false,F.parents[H],true);}break;case mstrUpdateManager.APPLY_CONTROL_DEFAULT:var B=F.orgObjs;if(B){for(var H in B){var I=document.getElementsByName(B[H].getAttribute("id"));for(var G=0;G<I.length;G++){I[G].style.cssText=microstrategy.styleObj.getCssText(B[H]);}}}break;case mstrUpdateManager.EDIT_TEXT:case mstrUpdateManager.MOVE_OBJECT:case mstrUpdateManager.EDIT_PROPS:this.commonRedoUndoCode(E,"undo");break;case mstrUpdateManager.REMOVE_OBJECT:this.restoreDeletedItems(F.parent,F.srcObjects);break;}this.selections.syncUp();this.selections.resetRange(false,null);if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}if(this.undoRedoSubSections.length>0){for(var C in this.undoRedoSubSections){var K=this.undoRedoSubSections[C].bone;var L=this.undoRedoSubSections[C].isTarget;K.wireTargets([],this.parentBone.beanPath,L);}}this.undoRedoSubSections=null;return true;}catch(D){microstrategy.errors.log(D);return false;}finally{microstrategy.formatType=J;}};mstrDocImpl.prototype.onwinresize=function(B,A){try{this.syncPosition(B,A);if(this.selections){this.selections.syncUp();}window.setTimeout(function(){iframe.hideWaitPage(true);},mstr.utils.ISIE8?100:0);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.isValidSelectorTarget=function(A){return(A!=null&&A.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&(microstrategy.subObjectType(A)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||microstrategy.subObjectType(A)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||microstrategy.subObjectType(A)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)&&this.standAloneControlKey!=A.id)||this.commands.queryState("isDDIC");};mstrDocImpl.prototype.disableAutowire=function(){this.parentBone.commands.exec("disableAutowire");this.submitControlTargetSelections();};mstrDocImpl.prototype.submitControlTargetSelections=function(){try{if(this.parentBone.autoWire){showMessage({contents:microstrategy.descriptors.getDescriptor("6154"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,zIndex:1001,okEval:"microstrategy.getViewerBone().doc.disableAutowire()",cancelEval:"microstrategy.getViewerBone().doc.selections.clear()",type:mstrMsgBoxImpl.MSG_WARNING});return ;}var J=this.parentBone.updateManager;var D="";var G=this.selections.getItems();var E=true;var I=null;for(var H=0;H<G.length;H++){if(this.isValidSelectorTarget(G[H])){var B=G[H].getAttribute("id");if(I==null){if(microstrategy.subObjectType(G[H])==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){I=B;}}if(E==false){D+=CLIPBOARD_ITEM_SEPARATOR;}else{E=false;}if(this.commands.queryState("isDDIC")){var A=G[H].getAttribute("trxctlkey");D+=A;}else{D+=B;}}}this.selections.clear();var C;if(this.standAloneControlKey){C=microstrategy.bone(this.standAloneControlKey+"_Ctl");if(C){if(C.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){D=I||"";}C.targetKeys=D?D.split(CLIPBOARD_ITEM_SEPARATOR):[];}J.add([J.createActionObject(null,mstrUpdateManager.CTRL_SET_TARGETS,this.parentBone.beanPath,["2048130","2048129","2048116"],[this.standAloneControlKey,"",D],[])]);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&C.isDefinitionComplete()){J.flushAndSubmitChanges();}}else{C=microstrategy.bone("grid_"+this.controlSource);if(C){if(C.controlLinks==null){C.controlLinks={};}var K=this.controlSourceUnitID;if(this.controlSourceUnitID==null||this.controlSourceUnitID==""){K="Metrics";}if(C.controlLinks[K]==null){C.controlLinks[K]={};}C.controlLinks[K].targets=D?D.split(CLIPBOARD_ITEM_SEPARATOR):[];}J.add([J.createActionObject(null,mstrUpdateManager.ADD_CONTROL_TO_GRID,this.parentBone.beanPath,["2048007","2048012","2048001","2048009","2048129","2048116"],[this.controlSource,"",this.controlSourceUnitID,this.controlSourceUnitType,"",D],[])]);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){J.flushAndSubmitChanges();}}this.endControlSelectionMode();}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.onkeydown=function(H){try{var B=this.parentBone;if(!H){H=window.event;}if(this.shouldIgnoreKeyEvent(H)){return true;}if(!mstrStaticDoc.prototype.onkeydown.call(this,H)){return false;}this.isNotConstrained=(H.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF;if(!this.parentBone.isEditableViewModeEplus()){return true;}switch(H.keyCode){case 89:if(H.ctrlKey){this.parentBone.updateManager.redo();return false;}break;case 90:if(H.ctrlKey){this.parentBone.updateManager.undo();return false;}break;case 120:this.parentBone.commands.exec("grid");if(this.parentBone.observer){this.parentBone.observer.notifyAll("onstatechange");}return false;}if(!this.selections){return true;}switch(H.keyCode){case 65:H.cancelBubble=true;if(H.ctrlKey){return this.selections.selectAll(H);}break;case 86:H.cancelBubble=true;if(H.ctrlKey){if(B.IsNavigationDocument){return true;}return this.selections.paste();}break;}if(!this.selections.isActive()||!this.selections.isVisible){return true;}switch(H.keyCode){case 37:case 38:case 39:case 40:if(this.selections.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return false;}var I=true;var M=0,E=0;var A="";if(H.keyCode%2>0){A="e";E=(H.keyCode==37)?-1:1;}else{A="s";M=(H.keyCode==38)?-1:1;}I=(H.shiftKey)?this.selections.resize.resizeItems(A,0,0,E,M,false,this.isNotConstrained):this.selections.nudge(H.keyCode,this.isNotConstrained);if(bIsIE4){H.cancelBubble=!I;}if(bIsFirefox&&I&&H.shiftKey){mstr.utils.Dom.clearBrowserHighlights();}return I;case 46:if(B.IsNavigationDocument){var J=microstrategy.findBone(mstr.$H.firstItem(this.selections.items));if(J&&J.isNavigationBar){return true;}}this.promptDeleteItems(this.selections.items,true);return false;case 66:case 73:case 85:if(H.ctrlKey){H.cancelBubble=true;var D=1;if(H.keyCode==73){D=2;}else{if(H.keyCode==85){D=4;}}var C=this.commands.queryState("fstyle");if(D&C){D=-D;}this.commands.exec("fstyle",D);microstrategy.eventManager.notifyOrphanBones("onselectionchange");return false;}break;case 67:if(H.ctrlKey){if(B.IsNavigationDocument){return true;}return this.selections.copy();}break;case 68:if(H.ctrlKey&&this.selections.firstObjType()==microstrategy.OBJTYPE_DOC_OBJECT){if(B.IsNavigationDocument){return true;}H.cancelBubble=true;this.selections.duplicate();return false;}break;case 75:case 84:if(H.ctrlKey){var G=(H.altKey)?"one":"";G+=(H.keyCode==75)?"back":"front";return this.selections.sendTo(G);}break;case 88:if(H.ctrlKey){if(B.IsNavigationDocument){return true;}this.selections.cut();return false;}break;case 113:if(!this.selections.isMulti()){var L=this.selections.firstItem();var K=microstrategy.subObjectType(L);if(K==microstrategy.SUBOBJTYPE_DOC_TEXT){this.editObj(null,L);return false;}else{if(K==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){var J=microstrategy.findRWObjectBone(L,"mstrHTMLContainerImpl");J.editContents(H);}}}break;}return true;}catch(F){microstrategy.errors.log(F);return false;}};mstrDocImpl.prototype.onkeypress=function(F){try{F=F||window.event;if(this.shouldIgnoreKeyEvent(F)){return true;}if(this.parentBone.isEditableViewModeEplus()){if(!F.ctrlKey&&this.selections.isActive()&&!this.selections.isMulti()){var H=(bIsW3C&&!bIsIE4);var E=(H)?F.charCode:F.keyCode;var D=this.selections.firstItem();var G=this.textEditor;var B=function(K,J,I){if(E==13){K[J](null,I);return false;}else{if(E>=32){K[J](null,I);if(H){G.value+=String.fromCharCode(E);}}}return true;};var A=microstrategy.subObjectType(D);if(A==microstrategy.SUBOBJTYPE_DOC_TEXT){return B(this,"editText",D);}else{if(A==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){return B(microstrategy.findRWObjectBone(D,"mstrHTMLContainerImpl"),"editContents",null);}}}}}catch(C){microstrategy.errors.log(C);}return true;};mstrDocImpl.prototype.initDoc=function(){try{mstrStaticDoc.prototype.initDoc.call(this);window.setTimeout(this.path+".displayPageBreaker();",0);this.initSelection();this.parentBone.elem.onscroll=new Function("e",this.verifiedPath+" { "+this.path+".syncPosition(); }");if(this.parentBone.isEditableViewModeEplus()){var txt=document.createElement("textarea");txt.setAttribute("id","docEditTextArea");with(txt.style){overflow="hidden";position="absolute";zIndex=5;visibility="hidden";padding="0px";left="0px";top="0px";}txt.tabindex=1;txt.onkeydown=new Function("e",this.verifiedPath+" { return "+this.path+".catchEscKey(e); }");this.textEditor=this.elem.appendChild(txt);}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocImpl.prototype.catchEscKey=function(B){try{if(!B){B=window.event;}if(B.keyCode==27){this.saveTextEdit(false);return false;}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocImpl.prototype.initSelection=function(){try{for(var A=0;A<this.elem.childNodes.length;A++){var C=this.elem.childNodes[A];if(C.nodeType==1){if(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SELECTION){this.selections=new mstrDocSelectionsImpl();this.selections.parentBone=this;this.selections.elem=C;this.selections.path=this.path+".selections";if(this.selections.onload){this.selections.onload();}break;}}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocImpl.prototype.onSubSectionResize=function(){try{this.updatePageBreaker();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocImpl.prototype.displayPageBreaker=function(){try{this.showPageBreaker(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||(this.parentBone.dividerOn&&(this.parentBone.isEditableViewModeEplus())));}catch(A){microstrategy.errors.log(A);}};mstrDocImpl.prototype.getNewPosition=function(B,A,G,D,F){try{if(D){B=microstrategy.relativeSnapCoordinate(B,A,G,D,F);}var E=(G)?getObjSumTop(A):getObjSumLeft(A);B-=E;if(B<0){B=0;}return B;}catch(C){microstrategy.errors.log(C);return B;}};mstrDocImpl.updateSectionList=function(D,C,A,B){if(!D[C.id]){D[C.id]={};}D[C.id].bone=C;if(B){A.target=D[C.id].isTarget=true;}else{A.control=true;D[C.id].isTarget=D[C.id].isTarget||false;}};mstrDocImpl.prototype.deleteItems=function(T,N,J,K,O){try{var P=this.parentBone.updateManager;var o=(N)?[]:null;var R="|";var I,a,Z;var M={};var D={control:false,target:false};for(var m in T){var U=T[m].getAttribute("id");R+=U+"|";}for(var m in T){var h=T[m];if(h.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){continue;}var W=microstrategy.subObjectType(h);if(W==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){I=microstrategy.findBone(h);if(I&&I.isGridInCellSelectionMode()){continue;}}this.selections.remove(h,O);var C=value=this.styleObj.getValue(h,"zIndex");var F=J||h.parentNode;var S=this.styleObj.getValue(h,"top");var B=microstrategy.findBone(F);var U=h.getAttribute("id");var L=document.getElementsByName(U);if(B.isFilterPanel){this.docMask=this.getMask();var n=microstrategy.findAncestorWithAtt(F,microstrategy.HTMLATTR_OBJTYPE,"dsec");if(!n&&L[0]){n=microstrategy.findAncestorWithAtt(L[0],microstrategy.HTMLATTR_OBJTYPE,"dsec");}var e=this.getSubMaskBone(n.id,B.id,0);e.updateImageMap();}var V={parent:h.parentNode,srcObjects:[]};switch(W){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:mstrDocImpl.updateSectionList(M,B,D,true);for(a=0;a<L.length;a++){I=microstrategy.bone("grid_"+U+"_"+a);if(I){I.disabled=true;}}break;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:mstrDocImpl.updateSectionList(M,B,D,true);I=microstrategy.findBone(h);if(I&&I.deleteStack){I.deleteStack();}break;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:mstrDocImpl.updateSectionList(M,B,D);I=microstrategy.findBone(h.firstChild);if(I){I.disabled=true;}break;default:var Y=this.findNavigationBar(h);if(Y){Y.onButtonRemoved(h);}break;}for(a=L.length-1;a>=0;a--){V.srcObjects.push(L[a].parentNode.removeChild(L[a]));}var E=this.formattingAttributes[U];if(E){E.deleted=true;}if(N){V.srcObjects.reverse();var A=[mstrUpdateManager.UPDATE_LATER,U];o.push(P.createActionObject(V.srcObjects[V.srcObjects.length-1],mstrUpdateManager.REMOVE_OBJECT,this.parentBone.beanPath,["2048018","2048012"],A,A,V));}}this.updatePanelCM(B);if(B&&B.isFilterPanel){var e=this.getSubMaskBone(n.id,B.id,0);var c=mstrFormatObject;if(e.adjustZIndex(null,U,true)){var q=e.getMoveItems();var H=parseInt(S);for(var a=0;a<q.length;a++){var g=q[a];o=this.formatItems(microstrategy.createAssociativeArray(g.item),"zIndex",g.zIndex,false,o||[]);var X=mstrFilterPanelMaskImpl.ITEM_SPA,Q=H;moveObjTo(g.item,X,Q);var V={acrossSections:false};o.push(P.createActionObject(g.item,mstrUpdateManager.MOVE_OBJECT,this.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,g.item.id,B.id,c.encodeValue("top",Q),c.encodeValue("left",X)],[mstrUpdateManager.UPDATE_LATER,g.item.id,B.id,c.encodeValue("top",this.styleObj.getValue(g.item,"top")),c.encodeValue("left",this.styleObj.getValue(g.item,"left"))],V));H+=getObjHeight(g.item)+mstrFilterPanelMaskImpl.ITEM_SPA;}}}else{if(B&&B.isNavigationBar){B.parentBone.postRemoveButtons(o);}}microstrategy.eventManager.notifyOrphanBones("onbonedeleted",R);if((D.control||D.target)&&this.parentBone.autoWire&&this.undoRedoSubSections!=null){for(var U in M){this.undoRedoSubSections.push(M[U]);}}if(N&&o&&o.length>0){P.add(o,K);}return true;}catch(G){microstrategy.errors.log(G);return false;}};mstrDocImpl.prototype.addObj=function(A,K,L,F,V,M){try{var P=(V!=null);V=V||[];var G=this.parentBone.updateManager;var T=microstrategy.getFormatObject();var N={};var O=parseInt(Math.max(A,0));var H=parseInt(K)+this.parentBone.elem.scrollTop;var J=true;var C=null;if(!F.length){F=[F];}for(var Q=0;Q<F.length;Q++){C=new mstrObjectInfoImpl(F[Q]);C.height=C.width="";C.left=O;C.top=H;if(M!=null){C.left=microstrategy.snapCoordinate(C.left,0,!M);C.top=microstrategy.snapCoordinate(C.top,0,!M);O=C.left;}var S="";var I=F[Q].getAttribute("ds");J=true;switch(C.dssType){case microstrategy.DSSTYPE_FILTER:if(C.dssSubType!=microstrategy.DSSTYPE_CUSTOM_GROUP){J=false;break;}case microstrategy.DSSTYPE_METRIC:S=microstrategy.SUBOBJTYPE_DOC_TEXT;if(!C.isUnique){I="{["+C.dSetName+"]:["+I+"]}";}else{I="{["+I+"]}";}break;case microstrategy.DSSTYPE_USER_SUMMARY_METRIC:case microstrategy.DSSTYPE_USER_METRIC:case microstrategy.DSSTYPE_ATTRIBUTE:case microstrategy.DSSTYPE_CONSOLIDATION:S=microstrategy.SUBOBJTYPE_DOC_TEXT;I="{["+I+"]}";break;case microstrategy.DSSTYPE_ATTRIBUTE_FORM:S=microstrategy.SUBOBJTYPE_DOC_TEXT;var R="";var E=findTargetTag(F[Q],"UL");if(E){var D=findTargetTag(E,"LI");if(D){if(D.getElementsByTagName("span")[0]){R=D.getElementsByTagName("span")[0].getAttribute(microstrategy.HTMLATTR_DESCRIPTION);}}}R="["+R+"]";I="["+I+"]";I="{"+R+"@"+I+"}";break;default:J=false;break;}if(J){var U=this.addItem(I,L,S,C,V);N.parent=U.parentNode;V.push(G.createActionObject(U,mstrUpdateManager.ADD_TEXT,this.parentBone.beanPath,["2048018","2048012","2048020","2048007","2048008","2048010","2048011","2048100","2048099","2048241"],[mstrUpdateManager.UPDATE_LATER,U.getAttribute("id"),this.styleObj.getAttValue(U,microstrategy.HTMLATTR_NAME),L.id,I,T.encodeValue("top",C.top),T.encodeValue("left",C.left),String(this.styleObj.getValue(U,"zIndex")),T.encodeValue("textAlign",U.style.textAlign),"true"],[],N));if(this.parentBone.defaultInsertMode==mstrDocImpl.INSERT_MODE.HIDE_OTHERS||(!this.parentBone.defaultInsertMode&&this.visibleCurOnly)){this.formatAttribute([U],"visibility","0",false,microstrategy.HTMLATTR_VISIBLE,V,true);this.formatAttribute([U],"visibility","-1",false,microstrategy.HTMLATTR_VISIBLE,V,false);}O+=getObjWidth(U)+10;}}if(!P&&V.length>0){G.add(V);}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.getContentHeight=function(E){try{var F=E.elem;if(!F){return 0;}var A=0;var C;for(var B=0;B<F.childNodes.length;B++){var H=F.childNodes[B];if(H.nodeType!=1){continue;}if(H.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var G=microstrategy.styleObj.getAttValue(H,microstrategy.HTMLATTR_HEIGHT_MODE);if(!G||G!=microstrategy.HUNDRED_PERCENT_MODE){C=parseInt(microstrategy.styleObj.getValue(H,"top"))+getObjHeight(H);}if(C>A){A=C;}}}return A;}catch(D){microstrategy.errors.log(D);return 0;}};mstrDocImpl.prototype.addCtrl=function(Z,R,I,H,c,a,g){try{var U=(I!=null);if(!U){I=[];}var o=this.parentBone.updateManager;var AK=microstrategy.getFormatObject();var J=this.styleObj;var n={};var AB=microstrategy.findBone(R);var e=new mstrObjectInfoImpl(null);if(!H){H=this.currentControl;}var AA=this.currentControlSubtype;var u=(H==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&AA=="R");if(H==microstrategy.GRAPH_CTL){H=microstrategy.SUBOBJTYPE_DOC_TEMPLATE;e.viewMode=2;}if(H==microstrategy.BUTTON_CTL){H=microstrategy.SUBOBJTYPE_DOC_TEXT;}if(Z){e.left=Z.left-getObjSumLeft(R);if(bIsW3C){e.left+=this.parentBone.elem.scrollLeft;}e.top=Z.top-getObjSumTop(R)+this.parentBone.elem.scrollTop;e.height=(Z.bottom)?Z.bottom-Z.top:null;e.width=(Z.right)?Z.right-Z.left:null;if(AA=="FP"){e.height=(e.height==null)?625:e.height;e.width=(e.width==null)?145:e.width;}else{if(this.isDocButtonType(H,AA)){var A=mstrButton.BUTTON_DEFAULT_SIZES[AA];if(A){e.width=e.width==null?A.w:e.width;e.height=e.height==null?A.h:e.height;}}}}else{e.top=this.getContentHeight(AB);e.height=null;var F=false;if(H==microstrategy.SUBOBJTYPE_DOC_WIDGET){var AN=this.currentControlSubtype.split(";");if(AN[0]=="com.microstrategy.web.vf.viewer.DatePickerApplicationViewer"||AN[0]=="com.microstrategy.web.vf.viewer.FishEyeApplicationViewer"){resize=false;}else{resize=true;}}else{resize=H==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||H==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||H==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||H==microstrategy.SUBOBJTYPE_DOC_IMAGE;}if(resize){e.height=getObjHeight(AB.elem)-e.top;if(e.height<=0){e.height=null;}}e.width=getObjWidth(AB.elem);if(AB.isFilterPanel){e.width-=4;e.top+=2;e.left=2;}}if(g!=null){e.left=microstrategy.snapCoordinate(e.left,0,!g);e.top=microstrategy.snapCoordinate(e.top,0,!g);if(e.width){e.width=microstrategy.snapCoordinate(e.width,0,!g);}if(e.height){e.height=microstrategy.snapCoordinate(e.height,0,!g);}}var AH={isWidget:false,className:"",rslPath:"",title:"",previewImage:"",isApp:"false",scope:microstrategy.SUBOBJTYPE_DOC_TEMPLATE,defaultDHTMLStyle:0};switch(H){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:if(a!=null){if(a.dssSubType){e.dssSubType=a.dssSubType;}if(a.dataSetName){e.dSetName=a.dataSetName;}}break;case microstrategy.SUBOBJTYPE_DOC_WIDGET:var AN=this.currentControlSubtype.split(";");AH.isWidget=true;if(AN.length>1){AH.className=AN[0];AH.rslPath=AN[1];AH.title=AN[2];AH.previewImage=AN[3];if(AN.length>4){AH.isApp=AN[4];}if(AN.length>5){AH.scope=AN[5];}if(AN.length>6){AH.defaultDHTMLStyle=AN[6];}H=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL;}else{var y=microstrategy.getViewerBone().gridWidgets.lst;var x=y[AN];if(x){AH.gridWidget=x;AH.widgetId=AN[0];if(x.wgt){AH.className=x.wgt.cn;AH.rslPath=x.wgt.rsl;AH.title=x.t;AH.previewImage=x.wgt.img;AH.isApp=x.wgt.ia;AH.scope=x.wgt.scp;AH.defaultDHTMLStyle=x.wgt.sty;}}H=microstrategy.SUBOBJTYPE_DOC_TEMPLATE;}if(H==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){a={widgetName:AH.title,widgetPreviewSrc:AH.previewImage,widgetClass:AH.className,widgetRSL:AH.rslPath,widgetIsApp:AH.isApp};}else{if(H==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.currentControlSubtype=AH.defaultDHTMLStyle;AA=this.currentControlSubtype;}}}if(R.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL&&AA==="TC"){showMessage({contents:microstrategy.descriptors.getDescriptor("11959"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return null;}if(this.isAddToFilterPanel(R)&&H!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){showMessage({contents:microstrategy.descriptors.getDescriptor("9512"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return null;}var X=null;switch(H){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:if(this.isAddToDetailsSection(R)){return null;}X=document.createElement("div");X.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrGridRW");X.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_GRID_TABLE);X.style.position="relative";X.appendChild(mstrTemplateImpl.buildEmptyTemplate("r-",false));break;case microstrategy.SUBOBJTYPE_DOC_TEXT:X=(c&&c.length>0)?c:"";break;case microstrategy.SUBOBJTYPE_DOC_IMAGE:if(!e.height){e.height=30;}if(!e.width){e.width=28;}X=document.createElement("img");break;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:if(this.isAddToDetailsSection(R)){return null;}X=document.createElement("div");break;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:if(this.isAddToDetailsSection(R)){return null;}case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_SHAPE:X="";break;case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:X=document.createElement("div");break;default:X=H;break;}var Y=this.addItem(X,AB,H,e,I,a);var q=Y.getAttribute("id");n.parent=Y.parentNode;var AE=this.parentBone.beanPath;if(!e.height){e.height=getObjHeight(Y);}if(!e.width){e.width=getObjWidth(Y);}var B=J.getAttValue(Y,microstrategy.HTMLATTR_NAME);var AO=function(){var AP=["ClassName","Enable"];var AQ=[AH.className,"-1"];if(AH.rslPath&&AH.rslPath.length){AP.push("RSLPath");AQ.push(AH.rslPath);}if(AH.isApp&&AH.isApp.length>0){AP.push("IsApp");AQ.push(AH.isApp);}I.push(o.createEditPropsAction(Y,q,AE,AP,AQ));};var V=AK.encodeValue("top",e.top);var AL=AK.encodeValue("left",e.left);var C=AK.encodeValue("width",e.width);var Q=AK.encodeValue("height",e.height);var M=J.getValue(Y,"zIndex");var AG,T;var O=this;var AM=function(AP){if(O.parentBone.defaultInsertMode==mstrDocImpl.INSERT_MODE.HIDE_OTHERS||(!O.parentBone.defaultInsertMode&&O.visibleCurOnly)){O.formatAttribute([AP],"visibility","0",false,microstrategy.HTMLATTR_VISIBLE,I,true);O.formatAttribute([AP],"visibility","-1",false,microstrategy.HTMLATTR_VISIBLE,I,false);}};if(H==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var m=J.getAttValue(Y,microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL)==microstrategy.TRUE,K=Y.lastChild.lastChild.firstChild.getAttribute("id");var AF=o.createActionObject(Y,mstrUpdateManager.ADD_PANEL_STACK,AE,["2048007","2048012","2048117","2048010","2048011","2048100","2048043","2048042","2048018","2048020","2048241"],[AB.id,q,K,V,AL,M,C,Q,mstrUpdateManager.UPDATE_LATER,B,"true"],[],n);if(!m){I.push(AF);}else{microstrategy.updateManager.add([AF]);}if(m){this.formatAttribute([Y],"UseAsTableControl",microstrategy.TRUE,false,microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL,I,true);this.formatAttribute([Y],"showTitleBar",microstrategy.FALSE,false,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,I,true);this.formatItems([Y],"backgroundColor","#C5CCD4",false,I);microstrategy.findBone(Y).initNewTable(I,1);o.add([o.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}AM(Y);if(this.parentBone.autoWire){AB.wireTargets(I,AE,true);}if(J.getAttValue(Y,microstrategy.HTMLATTR_USE_AS_FILTER_PANEL)==microstrategy.TRUE){this.formatAttribute([Y],"UseAsFilterPanel",microstrategy.TRUE,false,microstrategy.HTMLATTR_USE_AS_FILTER_PANEL,I);}}else{if(H==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){var h=microstrategy.bone(q+"_Ctl");if(h!=null){var E=h.ctlSrcType?h.ctlSrcType:"";this.selections.syncUp(null,I);this.selections.finishAddAllObjs(microstrategy.createAssociativeArray(Y),I);I.push(o.createActionObject(Y,mstrUpdateManager.CTRL_ADD,AE,["2048010","2048011","2048100","2048043","2048042","2048007","2048012","2048113","2048129","2048114","2048115","2048116","2048119","2048120","2048121","2048125","2048020","2048139","2048241"],[V,AL,M,C,Q,AB.id,q,h.ctlType,"",h.ctlSrcId,E,h.targetKeys,h.ctlStyle,h.multiSelect?"1":"0",h.ctlOrientation,h.showAll?"1":"0",B,((h.autoSync)?"1":"0"),"true"],[],n));AM(Y);h.initDefaultFormats(I);if(AH.isWidget){AO();J.setAttValue(Y,"twc",AH.className);J.setAttValue(Y,"rsl",AH.rslPath);J.setAttValue(Y,"iap",AH.isApp);}if(this.isAddToFilterPanel(R)){O.formatAttribute([Y],"showElementCount",microstrategy.TRUE,false,microstrategy.HTMLATTR_CTL_SHOW_ELEMENT_COUNT,I);var S=microstrategy.formatType;microstrategy.formatType=microstrategy.FORMAT_TYPE_CONTROL_TITLE;O.formatAttribute([Y],"showTitleBar",microstrategy.TRUE,false,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,I);microstrategy.formatType=S;}}if(this.parentBone.autoWire&&h.ctlType!=mstrRWControlImpl.CTL_TYPE_PANEL_STACK){AB.wireTargets(I,AE);}}else{if(H==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var W=false;AG=["2048012","2048007","2048010","2048011","2048100","2048042","2048043"];T=[q,AB.id,V,AL,M,Q,C];if(a!=null&&a.dataSetID!=null){W=true;AG.push("2048031");T.push(a.dataSetID);if(a.addAsLinked){AG=AG.concat(["2048018","2048158"]);T=T.concat([mstrUpdateManager.UPDATE_LATER,"1"]);}else{if(a.shiftKey&&a.viewMode){var N=(a.viewMode=="3")?"7":a.viewMode;AG=AG.concat(["2048098","2048025","2048018"]);T=T.concat([a.shiftKey,N,mstrUpdateManager.UPDATE_LATER]);}else{AG=AG.concat(["2048098","2048018"]);T=T.concat([a.shiftKey,mstrUpdateManager.UPDATE_LATER]);}}}else{AG=AG.concat(["2048018","2048020","2048025"]);T=T.concat([mstrUpdateManager.UPDATE_LATER,B,(e.viewMode||1)]);}AG=AG.concat(["2048241"]);T=T.concat(["true"]);I.push(o.createActionObject(Y,mstrUpdateManager["ADD_"+((W)?"DATASET_":"")+"TEMPLATE"],AE,AG,T,[],n));AM(Y);if(!W){if(e.viewMode&&AA){I.push(o.createActionObject(Y,mstrUpdateManager.EDIT_GRAPH_PROPS,AE+"."+q,["4082"],[AA],[],n));}if(AH.isWidget){this.formatSizeMode({0:Y},"heightMode","0",I,true);this.formatSizeMode({0:Y},"widthMode","0",I,true);this.selections.processWidgetPropertyChanges({widgetId:AH.widgetId,FlashDisplay:AH.gridWidget.wgt!=null,DHTMLDisplay:AH.gridWidget.vis!=null&&AH.gridWidget.vis.vm!==50,iPhoneDisplay:AH.gridWidget.iphVis!=null,iPadDisplay:AH.gridWidget.ipadVis!=null,AndroidDisplay:AH.gridWidget.aVis!=null,AndroidTabletDisplay:AH.gridWidget.atVis!=null},microstrategy.findBone(Y),I,{id:Y});}}if(this.parentBone.autoWire){AB.wireTargets(I,AE,true);}}else{AG=["2048018","2048007","2048012","2048020","2048010","2048011","2048100"];T=[mstrUpdateManager.UPDATE_LATER,AB.id,q,B,V,AL,M];if(H==microstrategy.SUBOBJTYPE_DOC_LINE){var AD=J.getAttValue(Y,microstrategy.HTMLATTR_ORIENTATION);e[microstrategy.HTMLATTR_ORIENTATION]=AD;evtId=mstrUpdateManager.ADD_LINE;AG.push("2048061");T.push(AD);if(AD==microstrategy.ORIENTATION_HORIZONTAL){AG.push("2048043");T.push(C);}else{if(AD==microstrategy.ORIENTATION_VERTICAL){AG.push("2048042");T.push(Q);}}}else{AG.push("2048043");AG.push("2048042");T.push(C);T.push(Q);switch(H){case microstrategy.SUBOBJTYPE_DOC_TEXT:evtId=mstrUpdateManager.ADD_TEXT;var AC=J.getAttValue(Y,microstrategy.HTMLATTR_DSS_FORMULA);if(AC==null){AC="";}AG.splice(2,0,"2048008");T.splice(2,0,AC);break;case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:evtId=mstrUpdateManager.ADD_HTML_CONTAINER;AG.push("2048161");T.push(J.getAttValue(Y,microstrategy.HTMLATTR_HTML_TYPE));break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:evtId=mstrUpdateManager.ADD_SHAPE;AG.push("2048067");T.push((AA=="1")?"5":"2");break;case microstrategy.SUBOBJTYPE_DOC_IMAGE:this.selections.syncUp(null,I);this.selections.finishAddAllObjs(microstrategy.createAssociativeArray(Y),I);evtId=mstrUpdateManager.ADD_IMAGE;AG.splice(1,0,"2048019");T.splice(1,0,"dummy url");AG[8]="2048042";AG[9]="2048043";var P=function(AP){return AK.encodeValue(AP,Y.getAttribute(microstrategy["HTMLATTR_D"+AP.toUpperCase()]));};T.splice(5,5,P("top"),P("left"),M,P("height"),P("width"));break;}}if(evtId){AG.splice(0,0,"2048241");T.splice(0,0,"true");I.push(o.createActionObject(Y,evtId,AE,AG,T,[],n));AM(Y);}if(H==microstrategy.SUBOBJTYPE_DOC_SHAPE){if(AA=="1"){this.selections.syncUp(null,I);this.selections.finishAddAllObjs(microstrategy.createAssociativeArray(Y),I);}}else{if(H==microstrategy.SUBOBJTYPE_DOC_IMAGE){this.selections.addingCtrl=microstrategy.SUBOBJTYPE_DOC_IMAGE;this.commands.exec("addImg");}}}}}mstr.controllers.EventManager.notifyListenersOfId(Y.id,{name:"Add",ac:I,update:false,item:Y});mstr.controllers.EventManager.notifyListenersOfId(R.id,{name:"ChildAdded",ac:I,item:Y});if(u){var z=microstrategy.findBone(Y);if(z){z.onLinkDataset();}}if(this.isInsertMode&&this.currentControl==microstrategy.GRAPH_CTL){var D="activeViewID="+q+"&boneID=grid_"+q+"&zoomFactor="+microstrategy.ZOOM_FACTOR;if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){D+="&graphHeight="+e.height+"&graphWidth="+e.width;var G=q.replace("_graph",""),L=G.lastIndexOf("_"),AI=(L===-1)?null:G.substr(L+1);if(AI!=null){D+="&sliceIndex="+AI;}}I.push(o.createActionObject(null,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],[true,"edtGraphDropZones"],[]));o.addURL(D);}if(U){return I;}o.add(I);}catch(AJ){microstrategy.errors.log(AJ);return I;}};mstrDocImpl.prototype.getLinkedVisualization=function(A){if(this.parentBone&&this.parentBone.widgets){for(var D=0;D<this.parentBone.widgets.length;D++){var C=this.parentBone.widgets[D];if(C.rslPath==A&&C.scope==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){if(C.isVis){var B=this.parentBone.widgets[D].id;if(B=="FisheyeWidget"){return"visFishEye";}else{return"vis"+B;}}break;}}}return null;};mstrDocImpl.prototype.isAddToDetailsSection=function(B){try{if(B.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)&&B.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)==microstrategy.TRUE){showMessage({contents:microstrategy.descriptors.getDescriptor("4813"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return true;}}catch(A){microstrategy.errors.log(A);}return false;};mstrDocImpl.prototype.isAddToFilterPanel=function(C){try{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL){var B=microstrategy.findBone(C);if(B&&B.isFilterPanel){return true;}}}catch(A){microstrategy.errors.log(A);}return false;};mstrDocImpl.prototype.createTitleBar=function(K,C,G){try{var A=this.selections.isSelectorControlSelected()||(G&&(G.isSelector||G.isSelectorControl));var I=document.createElement("div");I.className="portal";I.id=C;I.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrPortalImpl");I.setAttribute("sty","ctitl");I.style.height=microstrategy.WINDOW_TITLE_HEIGHT+"px";I.style.position="relative";I=this.parentBone.objProps.initObjectFormat(I,true,A?microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:microstrategy.SUBOBJTYPE_DOC_TEMPLATE,A?mstrRWControlImpl.FMT_TYPE_TITLE:mstrGridReport.FMT_TYPE_TITLE);var O=document.createElement("table");I.appendChild(O);O.border=0;O.cellSpacing=0;O.cellPadding=0;O.className="pane";var H=O.insertRow(O.rows.length);var E=null;var M=null;var N="mstrIcon-btn mstrIcon-btn";var J=microstrategy.descriptors;if(this.parentBone.isInteractiveViewModeEplus()&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&G&&!G.isSelector){E=H.insertCell(H.cells.length);E.className="portalTitleBarZoomTD";M=this.createImageTag(J.getDescriptor("5567"),N+"Find","btnFind");M.onclick=new Function("var b = microstrategy.bone('"+G.boneId+"'); if(b) b.drillOutToFixedTemplate('"+G.objKey+"','"+G.treeType+"','"+G.displayMode+"');");E.appendChild(M);}E=H.insertCell(H.cells.length);E.className="portalTitleBarTD";var D=document.createElement("div");D.className="portalTitleBar";D.setAttribute("id","titleBar");D.setAttribute("name","titleBar");if(K){var B=document.createTextNode(K);D.appendChild(B);}E.appendChild(D);E=H.insertCell(H.cells.length);E.className="portalTitleBarButtonsTD";var L=document.createElement("span");L.className="portalTitleBarButtons";E.appendChild(L);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&G){M=this.createImageTag(J.getDescriptor("4161"),N+"Menu","localDataMenu_"+G.boneId);M.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"wBtn");L.appendChild(M);}if(G&&!G.isSelector){M=this.createImageTag(J.getDescriptor("4539"),N+"Minimize","minimize");M.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"wBtn");L.appendChild(M);M=this.createImageTag(J.getDescriptor("4540"),N+"Restore","restore");M.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"wBtn");M.style.display="none";L.appendChild(M);M=this.createImageTag(J.getDescriptor("4541"),N+"Maximize","maximize");M.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"wBtn");L.appendChild(M);M=this.createImageTag(J.getDescriptor("629"),N+"Close","delete");M.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"wBtn");L.appendChild(M);}return I;}catch(F){microstrategy.errors.log(F);return false;}};mstrDocImpl.prototype.createImageTag=function(D,A,E){try{var C=document.createElement("img");C.className=A;C.setAttribute("id",E);C.setAttribute("title",D);C.setAttribute("src",microstrategy.IMG_SRC_TRANSPARENT);return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocImpl.prototype.setStubImage=function(B){if(B!=null){var A=(B.getElementsByTagName("img"))[0];if(A!=null){A.setAttribute("src","");}this.styleObj.setAttValue(B,microstrategy.HTMLATTR_IMAGE_SOURCE,"");}this.stubImage=B;};mstrDocImpl.prototype.addNewImage=function(H,J){try{var A=this.styleObj;var D={parent:H.parentNode};this.selections.remove(H);var E=null;if(!bIsIE6){var B=microstrategy.findBone(H.parentNode);var F=new mstrObjectInfoImpl(null);var G=function(K){F[K]=parseInt(A.getValue(H,K),10);};G("left");G("top");G("height");G("width");this.commands.exec("deleteStubImg");E=this.addItem(document.createElement("img"),B,microstrategy.SUBOBJTYPE_DOC_IMAGE,F);}else{E=H.cloneNode(true);this.commands.exec("deleteStubImg");E=this.addItemsToSubsection(D.parent,E,true);}A.cloneAttValues(H,E);this.selections.add(E);var I=function(K){return mstrFormatObject.encodeValue(K,E.getAttribute(microstrategy["HTMLATTR_D"+K.toUpperCase()]));};J.push(this.parentBone.updateManager.createActionObject(E,mstrUpdateManager.ADD_IMAGE,this.parentBone.beanPath,["2048018","2048019","2048007","2048012","2048020","2048010","2048011","2048100","2048042","2048043","2048295","2048241"],[mstrUpdateManager.UPDATE_LATER,"dummy url",E.getAttribute(microstrategy.HTMLATTR_SECTION_ID),E.getAttribute(microstrategy.HTMLATTR_ID),A.getAttValue(E,microstrategy.HTMLATTR_NAME),I("top"),I("left"),A.getValue(E,"zIndex"),I("height"),I("width"),"true"],[],mstr.Enum.IMAGE_URL_TYPE.DUMMY_URL,D));if(this.parentBone.defaultInsertMode==mstr.Enum.INSERT_MODE.HIDE_OTHERS||(this.visibleCurOnly&&!this.parentBone.defaultInsertMode)){this.formatAttribute([E],"visibility","0",false,microstrategy.HTMLATTR_VISIBLE,J,true);this.formatAttribute([E],"visibility","-1",false,microstrategy.HTMLATTR_VISIBLE,J,false);}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.autoSizeImages=function(L,S,P,V,E){try{if(P){this.items=P;}var C=false;var M=this.parentBone.updateManager;if(this.items){for(var U in this.items){var A=this.items[U];if(microstrategy.subObjectType(A)==microstrategy.SUBOBJTYPE_DOC_IMAGE){var K=document.getElementsByName(A.getAttribute("id")+"_img");var D=K[0];if(D&&(D.readyState=="complete"||D.complete)){if(S){if(!V||V==null){V=this.parentBone.updateManager.getLastAction();C=true;}}D.style.width="auto";D.style.height="auto";var B=mstr.utils.BoxModel;if(this.adjustImageSizeFlag){this.adjustImageSizeFlag=false;var O=B.getElementInnerWidth(D.parentNode.parentNode);var W=B.getElementInnerHeight(D.parentNode.parentNode)-parseInt(microstrategy.styleObj.getValue(D.parentNode,"top"));var F=B.getElementOuterWidth(D);var N=B.getElementOuterHeight(D);var I=F/N;if(N>W||F>O){var Q=W/N;var R=O/F;if(Q>R){F=O;N=F/I;}else{N=W;F=N*I;}D.style.width=F+"px";D.style.height=N+"px";}}this.formatSizeMode({0:A},"widthMode","0",V,false);this.formatSizeMode({0:A},"heightMode","0",V,false);var T=getObjHeight(D),J=getObjWidth(D);this.formatSize({0:A},"height",""+T,V);this.formatSize({0:A},"width",""+J,V);if(E){this.formatAttribute([A],"height",""+mstrFormatObject.encodeValue("height",T),false,microstrategy.HTMLATTR_HEIGHT,V,true);this.formatAttribute([A],"width",""+mstrFormatObject.encodeValue("width",J),false,microstrategy.HTMLATTR_WIDTH,V,true);}if(C){this.parentBone.updateManager.add(V);}}else{if(L<10){var H=this;window.setTimeout(function(){H.autoSizeImages(L+1,S);},50);}else{this.adjustImageSizeFlag=false;}}}}this.selections.resizeSubSection(false,V);this.selections.resetRange(false,V);this.selections.syncUp();}}catch(G){microstrategy.errors.log(G);}};mstrDocImpl.prototype.editText=function(H,A){try{var C=this.styleObj;var D=this.textEditor;var L="";A=microstrategy.findAncestor(A);var J=microstrategy.HTMLATTR_DSS_FORMULA;var I=false;var O=microstrategy.subObjectType(A);var N=this.styleObj.getValue(A,"TextDirection")||"0";if(O==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){if(C.getAttValue(A,microstrategy.HTMLATTR_HTML_TYPE)==microstrategy.HTML_CONTAINER_TYPE_HTML){J=microstrategy.HTMLATTR_HTML_TEXT;}else{J=microstrategy.HTMLATTR_HTML_SOURCE;I=true;}}if(this.isDocButton(A)){var B=C.getAttValue(A,microstrategy.HTMLATTR_DISPLAY_STYLE);if(B==microstrategy.BUTTON_STYLE_ICON_ONLY||B==microstrategy.BUTTON_STYLE_CUSTOM){return ;}}L=C.getAttValue(A,J);if(!L&&I){L="http://";}if(L==null){L="";}L=L.replace(/\\n/g,"\r\n");L=decode(L,true);D.source=A;var K=function(P){var Q=(P)?microstrategy.findAncestorWithAtt(A.parentNode,microstrategy.HTMLATTR_OBJTYPE,P):A;var R=C.getValue(Q,"backgroundColor");return(R&&R.toLowerCase()!="transparent")?R:null;};var G=K()||K(microstrategy.OBJTYPE_DOC_SUBSECTION)||K(microstrategy.OBJTYPE_DOC);D.style.backgroundColor=(G!=null&&G.length>0&&G.toLowerCase()!="transparent")?G:"#ffffff";D.style.width=C.getValue(A,"width");D.style.height=C.getValue(A,"height");var F=function(R,S){var Q=R.toLowerCase();var P=parseFloat(C.getValue(A,"border"+R+"Width"));if(Q==="top"&&N==="90"&&!bIsDXIE){D.style[Q]=(window["getObjSum"+R](A)-S[Q]+((!isNaN(P))?P:0))-A.offsetWidth+"px";}else{D.style[Q]=(window["getObjSum"+R](A)-S[Q]+((!isNaN(P))?P:0))+"px";}};F("Top",this);F("Left",this);D.style.paddingTop=C.getValue(A,"paddingTop");D.style.paddingRight=C.getValue(A,"paddingRight");D.style.paddingBottom=C.getValue(A,"paddingBottom");D.style.paddingLeft=C.getValue(A,"paddingLeft");D.style.color=C.getValue(A,"color");D.style.textAlign=C.getValue(A,"textAlign");D.style.fontFamily=C.getValue(A,"fontFamily");D.style.fontSize=C.getValue(A,"fontSize");D.style.fontWeight=C.getValue(A,"fontWeight");D.style.fontStyle=C.getValue(A,"fontStyle");D.style.textDecoration=C.getValue(A,"textDecoration");if(C.getValue(A,"whiteSpace")=="nowrap"){D.setAttribute("wrap","off");}else{D.removeAttribute("wrap");}D.style.borderWidth="0px";D.style.visibility="visible";D.style.zIndex=(""+C.getValue(A,"zIndex")+1);D.onblur=new Function(this.verifiedPath+" { "+this.path+".saveTextEdit(true); }");D.value=L;if(this.isDocButton(A)){var M=microstrategy.findBone(A);if(M){M.onEditText(D,A);}}microstrategy.setCursorToEnd(D);D=null;}catch(E){microstrategy.errors.log(E);}};mstrDocImpl.prototype.editObj=function(C,D){try{switch(microstrategy.subObjectType(D)){case microstrategy.SUBOBJTYPE_DOC_TEXT:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:if(this.parentBone.isEditableViewModeEplus()){if(this.isDocButton(D)){var B=microstrategy.findBone(D);B.editContents(C,D);break;}this.editText(C,D);}break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:break;default:this.commands.exec("edtPropsTabSelected",0);break;}}catch(A){microstrategy.errors.log(A);return false;}};mstrDocImpl.prototype.saveTextEdit=function(M){try{var E=this.textEditor,B=E.source;E.onblur=null;E.style.visibility="hidden";E.style.top=E.style.left="0px";if(this.isDocButton(B)){var P=microstrategy.findBone(B);if(P){P.postEditText(E,B);}}if(M){var J=(microstrategy.subObjectType(B)==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER)?"HTML_CONTAINER":"Text";var N=this["get"+J.replace("_CONTAINER","")+"FieldValues"](B,E.value);if(N.hasChanged){var H=document.getElementsByName(B.getAttribute("id"));if(H&&H.length>0){var I=this.parentBone.updateManager;var Q=[];var O;var C=B.getAttribute("id");var A=this.parentBone.beanPath;var L=microstrategy["SUBOBJTYPE_DOC_"+J.toUpperCase()];if(L==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){var D;if(this.styleObj.getAttValue(B,microstrategy.HTMLATTR_HTML_TYPE)==microstrategy.HTML_CONTAINER_TYPE_HTML){var K=/^(&nbsp;|\s)*http:\/\//i;if(N.attributeValue&&N.attributeValue.search(K)!=-1){this.styleObj.setAttValue(H[0],microstrategy.HTMLATTR_HTML_TYPE,microstrategy.HTML_CONTAINER_TYPE_IFRAME);Q.push(I.createEditPropsAction(H[0],C,A,["htmlType"],[microstrategy.HTML_CONTAINER_TYPE_IFRAME],[microstrategy.HTML_CONTAINER_TYPE_HTML]));O=microstrategy.HTMLATTR_HTML_SOURCE;D="url";}else{O=microstrategy.HTMLATTR_HTML_TEXT;D="htmlText";}}else{O=microstrategy.HTMLATTR_HTML_SOURCE;D="url";}evtId=mstrUpdateManager.EDIT_PROPS;Q.push(I.createEditPropsAction(H[0],C,A,[D],[N.saveValue],[N.oldValue]));}else{O=microstrategy.HTMLATTR_DSS_FORMULA;Q.push(I.createActionObject(H[0],mstrUpdateManager.EDIT_TEXT,A,["2048012","2048008","2048018"],[C,N.saveValue,mstrUpdateManager.UPDATE_LATER],[C,N.oldValue,mstrUpdateManager.UPDATE_LATER]));}this.styleObj.setAttValue(H[0],O,N.attributeValue);for(var G=0;G<H.length;G++){if(L==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){microstrategy.findRWObjectBone(H[G],"mstrHTMLContainerImpl").updateContents(this.styleObj.getAttValue(H[G],microstrategy.HTMLATTR_HTML_TYPE),N);}else{this.updateSingleTextField(H[G],N.displayValue);}}this.selections.syncUp(B);this.selections.resizeSubSection(false,Q);I.add(Q);}}}E.value="";if(bIsW3C&&!bIsIE4){E.blur();}}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.getTextFieldValues=function(G,B){try{var C=this.styleObj;var I={};I.oldValue=decode(C.getAttValue(G,microstrategy.HTMLATTR_DSS_FORMULA),true);I.saveValue=B;I.hasChanged=(I.oldValue!=I.saveValue);I.attributeValue=encode(I.saveValue,true);I.displayValue=I.attributeValue.replace(/\r?\n/g,"<br />");if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){var E=(C.getAttValue(G,microstrategy.HTMLATTR_IS_LINK)==microstrategy.TRUE);var A=(E)?C.getAttValue(G,microstrategy.HTMLATTR_LINK_HREFVALUE):"";var H=I.saveValue.toLowerCase();var D=H.indexOf("<a");if(D>-1&&H.indexOf("href=",D)>-1&&E&&(A==null||A.length==0)){D=H.indexOf(">",D)+1;var J=H.indexOf("</a",D);if(J!=-1){I.displayValue=I.saveValue.substring(D,J);}else{I.displayValue=I.saveValue.substring(D);}I.displayValue=encode(I.displayValue,true);I.displayValue=I.displayValue.replace(/\r\n/g,"<br />");}}return I;}catch(F){microstrategy.errors.log(F);return null;}};mstrDocImpl.prototype.openReplaceObjectEditor=function(A,I,C,E){var H=this,J="mstrReconReplaceEditor",F=null,B=function(L){if(!F){F=mstrmojo.all[J]||mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.ReplaceObjectEditor",id:J});}F.setUnits({source:L.source,target:L.target});var K=function(M,N){var R={actions:[{act:"applyReconciliation",clr_af:N,members:M}],style:{name:"RWIVEMojoStyle"}};if(C.ReplaceAllDS){for(var O in E){M.unshift({srcid:O,srct:3,tgtid:L.target.did,tgtt:3});}}else{M.unshift({srcid:L.source.did,srct:3,tgtid:L.target.did,tgtt:3});}var P=microstrategy.getViewerBone(),Q={taskId:"mojoRWManipulation",style:"RWIVEMojoStyle",messageID:P.messageID,stateID:-1,params:JSON.stringify(R),rwb:document.getElementsByName("rwb")[0].value};mstr.$XHR.request(mstrConfig.taskURL,Q,{success:function(T){var S=microstrategy.updateManager;S.add([S.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);S.flushAndSubmitChanges();},failure:function(S){mstrmojo.alert(S);}});};F.onOk=K;F.onClose=function(){F.tooltip&&F.tooltip.hideTooltip();F.destroy();};F.open();};var G=function G(L){var K=[].concat(L.att.concat(L.mx));mstr.$A.forEach(K,function(M){if(M.hc){M.cont_did=L.did;M.cont_tp=L.type;}});return mstr.$A.filter(K,{umCheck:function(M){return !M.um;}},"umCheck");};var D=G(I);B({source:A,target:{did:I.did,units:D},});};mstrDocImpl.prototype.getTargetDataSet=function(C,A,H){var D=this,B=H.oldDSID,G=H.items[0].did||H.items[0].dssid,F=C[G],E={did:B,units:A};if(F){F=mstr.$H.clone(F);F.did=G;D.openReplaceObjectEditor(E,F,H,C);}else{mstr.$XHR.request(mstrConfig.taskURL,{taskId:"mojoGetReportWorkingSet",reportId:G},{success:function(I){D.openReplaceObjectEditor(E,I,H,C);},failure:function(I){mstrmojo.alert(I);}});}};mstrDocImpl.prototype.getManifest=function(E){var C=this,D=microstrategy.getViewerBone(),B=D.datasetInfos,G=E.oldDSID,F={taskId:"mojoGetDocumentManifest",style:"RWIVEMojoStyle",messageID:D.messageID,stateID:-1,rwb:""},A=function(I){var J=[],H=1;for(var K in J){var L=J[K];mstr.$A.forEach(I,function(M){if(H===parseInt(M,10)){J.push(L);}});H++;}return J;};if(G){F.dsid=G;}mstr.$XHR.request(mstrConfig.taskURL,F,{success:function(J){var H=[],L={},I={};for(var K in B){var M=B[K];mstr.$A.forEach(M.att.concat(M.mx),function(N){L[N.did]=N;});}J.manifest_objects.forEach(function(O){var N=L[O.did];if(N){O.cubes=A(O.cube_ids||[]);for(var P in N){O[P]=N[P];}H.push(O);I[O.did]=O;}});J.manifest_objects.forEach(function(N){if(N.dependents){N.dependentObjects=[];N.dependents.forEach(function(O){N.dependentObjects.push(I[O]);});}});getSortedDatasetUnits=function(N){var O=function O(P){return P.t===4?2:1;};N=N.concat();N.sort(function(S,Q){var T=O(S)-O(Q),R=S.n.toUpperCase(),P=Q.n.toUpperCase();return T!==0?T:(R!==P?R.localeCompare(P):S.n.localeCompare(Q.n));});return N;};H=getSortedDatasetUnits(H);C.getTargetDataSet(B,H,E);},failure:function(H){mstrmojo.alert(H);}});};mstrDocImpl.prototype.handleDatasetExplorer=function(C){if(C.ReplaceAllDS||(C.oldDSID&&C.oldDSID.length>0)){var J=this,L=function(){var N={success:function(O){if(O){J.getManifest(C);}else{if(mstrApp.onSessionExpired){mstrApp.onSessionExpired();}}}},M={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,N,M);};var B=function(){microstrategy.cssLoader.get("vi-base-themes.css",true,L);};var I=function(){microstrategy.mojoLoader.loadWidget({bundle:"mojo-dre.js",callback:B});};microstrategy.descriptorsLoader.loadDescriptors({bundle:"mojo-dre",callback:I});return ;}try{var G=microstrategy.updateManager;var E=C.items;var A="";var H="";for(var F=0;F<E.length;F++){A+=H+(E[F].dssid||E[F].did);H=mstrUpdateManager.ITEM_SEPARATOR;}var K=[];for(F=0;F<E.length;F++){K.push(E[F].dssid||E[F].did);}microstrategy.getCubesInfo(K,function(M){if(C.oldDSID&&C.oldDSID.length>0||C.ReplaceAllDS){var Q=E[0],O=Q.tp||Q.t,N=Q.dssid||Q.did,P=M[N];G.add([G.createActionObject(null,mstrUpdateManager.RW_REPLACE_DATASET,mstrUpdateManager.applyChangesBeanPath,["2048216","2048217","2048218","2048219","2048018"],[microstrategy.getViewerBone().hasMultiDatasets()?C.oldDSID:"",N,C.oldDSType,O,mstrUpdateManager.UPDATE_LATER],[],null)]);}else{var O=(E[0].tp||E[0].t);G.add([G.createActionObject(null,mstrUpdateManager.RW_ADD_DATASET,mstrUpdateManager.applyChangesBeanPath,["2048032","2048033","2048018"],[A,O,mstrUpdateManager.UPDATE_LATER],[],null)]);}G.add([G.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);G.flushAndSubmitChanges();});}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.getHTMLFieldValues=function(G,F){try{var E=this.styleObj;var A={};if(F==null){F="";}var B=(E.getAttValue(G,microstrategy.HTMLATTR_HTML_TYPE)==microstrategy.HTML_CONTAINER_TYPE_HTML)?"TEXT":"SOURCE";var C=decode(E.getAttValue(G,microstrategy["HTMLATTR_HTML_"+B]),true);if(C==null){C="";}A.oldValue=C;A.saveValue=F;A.hasChanged=(A.oldValue!=A.saveValue);A.attributeValue=encode(A.saveValue,true);A.displayValue=A.attributeValue.replace(/\r\n/g,"<br />");return A;}catch(D){microstrategy.errors.log(D);return null;}};mstrDocImpl.prototype.addItem=function(U,AC,AG,h,H,B){try{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;var AH,M,y,m;var I=this.styleObj;var AB=this.currentControlSubtype;var Z=AG==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&AB==microstrategy.CONTROLSUBTYPE_NAVIGATION_BAR;var R=(AG==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK)&&(AB=="TC");var o=microstrategy.OBJ_PREFIX+this.parentBone.getNextObjId();if(AC.parentBone.isCollapsed){AC.parentBone.toggleSections(1);}var N=document.createElement("span");N.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_OBJECT);N.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,AG);N.setAttribute("id",o);N.setAttribute("name",o);if(AG==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&this.currentControlSubtype=="FP"){I.setAttValue(N,microstrategy.HTMLATTR_NAME,microstrategy.descriptors.getDescriptor("2550")+o.substr(o.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length));}else{if(R){I.setAttValue(N,microstrategy.HTMLATTR_NAME,"Table Control"+o.substr(o.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length));}else{if(Z){I.setAttValue(N,microstrategy.HTMLATTR_NAME,microstrategy.descriptors.getDescriptor("8145")+o.substr(o.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length));}else{if(this.isDocButtonType(AG,AB)){I.setAttValue(N,microstrategy.HTMLATTR_NAME,microstrategy.descriptors.getDescriptor("6457")+o.substr(o.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length));}else{I.setAttValue(N,microstrategy.HTMLATTR_NAME,this.getName(AG,o));}}}}N.className="object";if(h.dssId){N.setAttribute(microstrategy.HTMLATTR_DSS_ID,h.dssId);}if(h.dssType){N.setAttribute(microstrategy.HTMLATTR_DSS_TYPE,h.dssType);}if(h.dSetId){N.setAttribute(microstrategy.HTMLATTR_DSS_SET,h.dSetId);}N.style.position="absolute";N.style.overflow="hidden";N.style.left=h.left+"px";N.style.top=h.top+"px";mstr.utils.Dom.setBGIconClass(N,"1ptrans");if(AG==microstrategy.SUBOBJTYPE_DOC_LINE&&h[microstrategy.HTMLATTR_ORIENTATION]!=null){I.setAttValue(N,microstrategy.HTMLATTR_ORIENTATION,h[microstrategy.HTMLATTR_ORIENTATION]);}if(AG==microstrategy.SUBOBJTYPE_DOC_SHAPE&&(this.currentControlSubtype=="1")){I.setAttValue(N,microstrategy.HTMLATTR_STYLE,microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);}N=this.parentBone.objProps.initObjectFormat(N,true);if(R){var AL=microstrategy.getFormatObject();N.style.width="318px";microstrategy.styleObj.setAttValue(N,AL.getAttrNameFromStyle("width"),AL.encodeValue("width","320px"));}if(AC.isFilterPanel&&this.currentControlSubtype==mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER){var P=84,J=parseInt(N.style.height,10);if(J<P){var V=microstrategy.getFormatObject(),AF="height";I.setAttValue(N,V.getAttrNameFromStyle(AF),V.encodeValue(AF,P));I.setValue(N,AF,P+"px");}}if(AG==microstrategy.SUBOBJTYPE_DOC_TEXT){I.setAttValue(N,microstrategy.HTMLATTR_DSS_FORMULA,U);U=encode(U);N.innerHTML=U;}else{if(typeof (U)=="string"){U=document.createTextNode(U);}if(AG==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A;if(I.getAttValue(N,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE){A=this.createTitleBar(h.dSetName);N.appendChild(A);}}N.appendChild(U);}I.setAttValue(N,microstrategy.HTMLATTR_OBJTYPE,AG);if(AG==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){N.style.overflow="visible";}if(h.width!=null&&!isNaN(parseInt(h.width,10))){I.setValue(N,"width",h.width+"px");}if(h.height!=null&&!isNaN(parseInt(h.height,10))){I.setValue(N,"height",h.height+"px");}if(h.dssType==microstrategy.DSSTYPE_METRIC||h.dssType==microstrategy.DSSTYPE_USER_METRIC||h.dssType==microstrategy.DSSTYPE_USER_SUMMARY_METRIC){N.style.textAlign="right";}switch(AG){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:N.setAttribute(microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,"0");N.setAttribute(microstrategy.HTMLATTR_WINDOW_STATE,"0");break;case microstrategy.SUBOBJTYPE_DOC_LINE:this.fixLineItem(N,AG);h.width=N.style.width;h.height=N.style.height;break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:this.fixShapeItem(N);break;case microstrategy.SUBOBJTYPE_DOC_IMAGE:N.getElementsByTagName("IMG")[0].setAttribute("id",o+"_img");N.getElementsByTagName("IMG")[0].setAttribute("name",o+"_img");I.setAttValue(N,microstrategy.HTMLATTR_HEIGHT,mstrFormatObject.encodeValue("height",h.height));I.setAttValue(N,microstrategy.HTMLATTR_WIDTH,mstrFormatObject.encodeValue("width",h.width));I.setAttValue(N,microstrategy.HTMLATTR_LOCK_ASPECT_RATIO,microstrategy.TRUE);N.setAttribute(microstrategy.HTMLATTR_SECTION_ID,AC.id);N.setAttribute(microstrategy.HTMLATTR_DTOP,h.top);N.setAttribute(microstrategy.HTMLATTR_DLEFT,h.left);N.setAttribute(microstrategy.HTMLATTR_DHEIGHT,h.height);N.setAttribute(microstrategy.HTMLATTR_DWIDTH,h.width);break;}N.style.zIndex=AC.maxZindex++;AC.setNeedToUpdateMaxContentHeight(true);if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&(AG==microstrategy.SUBOBJTYPE_DOC_TEXT||AG==microstrategy.SUBOBJTYPE_DOC_IMAGE||AG==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||AG==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||AG==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)){var S=(!N.style.borderWidth||parseInt(N.style.borderWidth)==0);if(S){N.style.border=microstrategy.DESIGNMODE_NOBORDER_STYLE;}I.setAttValue(N,microstrategy.HTMLATTR_BORDER,microstrategy[((S)?"NO":"HAS")+"_BORDER"]);var q=this;var X=function(c){if(h[c]){I.setValue(N,c,q.removePaddingAndBorder(N,h[c],c)+"px");}else{if(S){N.style[c]=Math.max(parseInt(N.style[c])-2,0)+"px";}}};if(this.isDocButtonType(AG,AB)){var D=I.getAttValue(N,microstrategy.HTMLATTR_WIDTH);var AE=I.getAttValue(N,microstrategy.HTMLATTR_HEIGHT);X("width");X("height");I.setAttValue(N,microstrategy.HTMLATTR_WIDTH,D);I.setAttValue(N,microstrategy.HTMLATTR_HEIGHT,AE);}else{X("width");X("height");}}var n=N.firstChild;switch(AG){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:var Y=N.cloneNode(true);var z=microstrategy.subObjectFind(Y,"div",microstrategy.SUBOBJTYPE_GRID_TABLE);var AO=microstrategy.findChildWithAtt(Y,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrPortalImpl");var K=true;if(h&&h.dssSubType){K=(h.dssSubType==microstrategy.DSSTYPE_GRID||h.dssSubType==microstrategy.DSSTYPE_GRID_AND_GRAPH);}var a=(B!=null&&"widgetName" in B);I.setAttValue(Y,"twc",((a)?B.widgetClass:"None"));I.setAttValue(Y,"rsl",(a)?B.widgetRSL:"");I.setAttValue(Y,"iap",(a)?B.widgetIsApp:false);for(AH=0;AH<AC.sibs.length;AH++){var g="grid_"+o+"_"+AH;Y.setAttribute(microstrategy.HTMLATTR_APPLIES_TO,g);z.setAttribute("id",g);var AK="portal_"+g;if(AO){AO.setAttribute("id",AK);AO.setAttribute("name",AK);}AC.sibs[AH].appendChild(Y.cloneNode(true));if(AO){var W=microstrategy.registerBone(AK,"(true)",null);W.onload();}M=microstrategy.registerBone(g,"(true)",null);M.beanPath=this.parentBone.beanPath+"."+o;M.gridCellCssPrefix=this.parentBone.gridCellCssPrefix;M.isGraph=(h&&(h.dssSubType==microstrategy.DSSTYPE_GRAPH||h.dssSubType==microstrategy.DSSTYPE_GRID_AND_GRAPH));M.isGrid=K;M.isWidget=a;M.widgetDescription=(a)?B.widgetName:null;M.widgetPreviewSrc=(a)?B.widgetPreviewSrc:null;M.dSetName=(h.dSetName)?h.dSetName:"";M.onload();M.onpostload();if(AO){M.updatePortalTitle();}}break;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:var u="mstrPanelStack";if(AB==microstrategy.CONTROLSUBTYPE_NAVIGATION_BAR){u="mstrNavigationBar";}else{if(AB=="TC"){u="mstrTableControl";}}N.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,u);N.className+=" panelStack";var AD=N.appendChild(document.createElement("div"));AD.setAttribute("id",o+"_content");AD.style.position="absolute";if(bIsIE7){AD.style.position="relative";window.setTimeout(function(){var c=document.getElementById(o+"_content");if(c){c.style.position="absolute";}},0);}AD.style.overflow="hidden";AD.style.width="100%";var AA=AD.appendChild(document.createElement("div"));AA.className="title_"+o;AA.setAttribute("id",o+"_toolbar");AA.setAttribute("name",o+"_toolbar");AA.style.height=microstrategy.WINDOW_TITLE_HEIGHT+"px";AA=this.parentBone.objProps.initObjectFormat(AA,true,microstrategy.subObjectType(N),mstrPanelStack.FMT_TYPE_TITLE);mstr.utils.Dom.setBGIconClass(AA,"1ptrans");var O=document.createElement("table");AA.appendChild(O);O.className="pane";O.cellSpacing=0;O.cellPadding=0;O.style.height="100%";var AM=O.insertRow(-1);var C=AM.insertCell(-1);C.className="titleTD";var x=C.appendChild(document.createElement("div"));x.setAttribute("id","titleBar");x.setAttribute("name","titleBar");x.className="titleBar";var AN=AD.appendChild(document.createElement("div"));AN.setAttribute("id",o+"_container");AN.setAttribute("name",o+"_container");AN.className="panels";AN.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_PANEL_CONTAINER);AN.appendChild(this.createPanel());for(AH=0;AH<AC.sibs.length;AH++){AC.sibs[AH].appendChild(N.cloneNode(true));}insertDynamicScript(u+"Script",javaScriptPath+u+".js");var AJ=null;if(this.currentControlSubtype=="FP"){I.setAttValue(N,microstrategy.HTMLATTR_USE_AS_FILTER_PANEL,microstrategy.TRUE);}else{if(Z){I.setAttValue(N,microstrategy.HTMLATTR_USE_AS_NAVIGATION_BAR,microstrategy.TRUE);}else{if(this.currentControlSubtype=="TC"){I.setAttValue(N,microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL,microstrategy.TRUE);I.setAttValue(N,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,microstrategy.FALSE);AJ={def:"",fmt:""};}}}M=microstrategy.registerBone(o,u+"Script",AJ);M.onload();M.onpostload();break;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:y=o+"_Ctl";n.setAttribute("id",y);n.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrRWControlImpl");n.setAttribute("name",y);I.setAttValue(N,microstrategy.HTMLATTR_STYLE,this.currentControlSubtype);insertDynamicScript("mstrRWControlImplScript",javaScriptPath+"mstrRWControlImpl.js");var Q=this.getSelectorOrientation(h,AC);for(AH=0;AH<AC.sibs.length;AH++){AC.sibs[AH].appendChild(N.cloneNode(true));}var T=(AB==mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY||AB==mstrRWControlImpl.CTL_STYLE_LIST_BOX||AB==mstrRWControlImpl.CTL_STYLE_CHECKBOX||AB==mstrRWControlImpl.CTL_STYLE_SEARCH_BOX),Q=AB==mstrRWControlImpl.CTL_STYLE_METRIC_QUALIFICATION||AB==mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER?"1":Q;m=microstrategy.registerBone(y,"mstrRWControlImplScript",{ctlKey:o,ctlType:this.currentControl_SelectorControlType||"1",ctlStyle:this.currentControlSubtype,ctlOrientation:Q,multiSelect:T,showAll:true,autoSync:false});m.onload(B);m.onpostload();m.renderPreview();break;case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:y=o+"_Ctr";n.setAttribute("id",y);n.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrHTMLContainerImpl");n.setAttribute("name",y);insertDynamicScript("mstrHTMLContainerImplScript",javaScriptPath+"mstrHTMLContainerImpl.js");for(AH=0;AH<AC.sibs.length;AH++){AC.sibs[AH].appendChild(N.cloneNode(true));}m=microstrategy.registerBone(y,"mstrHTMLContainerImplScript",null);m.onload();m.onpostload();break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:var G=(this.currentControlSubtype=="1");if(G){N.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrRoundedRectangle");}I.setAttValue(N,microstrategy.HTMLATTR_ROUNDED_CORNERS,(G)?microstrategy.TRUE:microstrategy.FALSE);for(AH=0;AH<AC.sibs.length;AH++){AC.sibs[AH].appendChild(N.cloneNode(true));}if(this.currentControlSubtype=="1"){I.setAttValue(N,microstrategy.HTMLATTR_STYLE,microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);insertDynamicScript("mstrRoundedRectangleScript",javaScriptPath+"mstrRoundedRectangle.js");microstrategy.registerBone(o,"mstrRoundedRectangleScript",null).onload();}break;case microstrategy.SUBOBJTYPE_DOC_TEXT:if(this.isDocButtonType(AG,AB)){I.setAttValue(N,microstrategy.HTMLATTR_DISPLAY_STYLE,AB);N.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrButton");insertDynamicScript("mstrButtonScript",javaScriptPath+"mstrButton.js");mstrButton.initHTML(N);for(AH=0;AH<AC.sibs.length;AH++){AC.sibs[AH].appendChild(N.cloneNode(true));}microstrategy.registerBone(o,"mstrButtonScript",null).onload();break;}default:for(AH=0;AH<AC.sibs.length;AH++){AC.sibs[AH].appendChild(N.cloneNode(true));}}var E=N.getAttribute("gradientcolor");if(E){if((N.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&N.getAttribute("scriptclass")!="mstrPanel")||(AG==microstrategy.SUBOBJTYPE_DOC_SHAPE&&N.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){var e=(N.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION)?this.getChildBone(N):microstrategy.bone(N.id);e.applyGradient();}else{var L=document.getElementsByName(N.getAttribute("id"));var F=E.split(",");for(AH=0;AH<L.length;AH++){gradientUtil.applyGradientSettings(L[AH],F,I);}}}this.updatePanelCM(AC);return AC.sibs[0].lastChild;}catch(AI){microstrategy.errors.log(AI);return false;}};mstrDocImpl.prototype.getSelectorOrientation=function(A,C){var B=this.getOrientationConstraint(C);if(B==null){if(A){if(A.height){if(A.width&&A.width>=A.height){B=mstrRWControlImpl.ORIENTATION_HORIZONTAL;}else{B=mstrRWControlImpl.ORIENTATION_VERTICAL;}}else{if(A.width){B=mstrRWControlImpl.ORIENTATION_HORIZONTAL;}}}}if(B==null){B=mstrRWControlImpl.ORIENTATION_VERTICAL;}return B;};mstrDocImpl.prototype.getOrientationConstraint=function(B){var A=mstrRWControlImpl;switch(this.currentControlSubtype){case A.CTL_STYLE_POOL_DOWN:case A.CTL_STYLE_LIST_BOX:return A.ORIENTATION_VERTICAL;break;case A.CTL_STYLE_CHECKBOX:case A.CTL_STYLE_RADIO_BUTTON:case A.CTL_STYLE_LINK_ARRAY:case A.CTL_STYLE_BUTTON_ARRAY:if(B.isFilterPanel){return A.ORIENTATION_VERTICAL;}break;}return null;};mstrDocImpl.prototype.createPanel=function(){try{var E=document.createElement("div");var A=this.parentBone.getNextObjId();var B=microstrategy.OBJ_PREFIX+A;var F=microstrategy.descriptors.getDescriptor("4780")+A;E.setAttribute("id",B);E.setAttribute("name",B);E.setAttribute(microstrategy.HTMLATTR_NAME,F);E.setAttribute(microstrategy.HTMLATTR_WINDOW_TITLE,F);E.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);E.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_PANEL);E.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrPanel");E.className+=" panel";this.parentBone.objProps.initObjectFormat(E,true,microstrategy.SUBOBJTYPE_DOC_PANEL);var D=document.createElement("div");D.style.height="100%";E.appendChild(D);return E;}catch(C){microstrategy.errors.log(C);}return null;};mstrDocImpl.prototype.fixLineItem=function(B,A){try{if(A==microstrategy.SUBOBJTYPE_DOC_LINE){var D=parseInt(this.styleObj.getValue(B,"width"))>=parseInt(this.styleObj.getValue(B,"height"))?"HORIZONTAL":"VERTICAL";this.setLineOrientation(B,microstrategy["ORIENTATION_"+D]);}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.fixShapeItem=function(B){try{if(this.currentControlSubtype=="0"){var D=mstrFormatObject;var E=this.styleObj;var A=E.getAttValue(B,"b3dstyle");if(A==null||parseInt(A)==0){B.style.border=(D.decodeValue("lineStyle",E.getAttValue(B,"ls"))||"solid")+" "+(D.decodeValue("lineColor",E.getAttValue(B,"lc")||0))+" "+parseInt(D.decodeValue("lineWeight",E.getAttValue(B,"lw"))||1,10)+"pt";}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.addItemsToSubsection=function(N,V,W,S,X){try{var P;var L={};var F={control:false,target:false};var H=null;if(N){var D=microstrategy.findBone(N);if(W){P=this.parentBone.getNextObjId();V.setAttribute("id",microstrategy.OBJ_PREFIX+P);V.setAttribute("name",microstrategy.OBJ_PREFIX+P);V.style.zIndex=D.maxZindex;}D.maxZindex++;D.setNeedToUpdateMaxContentHeight(true);var K=document.getElementsByName(N.getAttribute("id"));var Q=microstrategy.subObjectType(V);if(Q==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){mstrDocImpl.updateSectionList(L,D,F,true);K[0].appendChild(V);if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){P=V.getAttribute("id");var A=microstrategy.subObjectFind(V,"div",microstrategy.SUBOBJTYPE_GRID_TABLE)||microstrategy.subObjectFind(V,"div",microstrategy.SUBOBJTYPE_DOC_GRAPH_TEMPLATE);if(A!=null){var O=A.getAttribute("id");var C=microstrategy.findChildWithAtt(V,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrPortalImpl");if(W){O="grid_"+P+"_0";var M="portal_"+O;A.setAttribute("id",O);if(S&&this.parentBone.gridItemFormats){this.parentBone.gridItemFormats[P]=this.parentBone.objProps.cloneFormats(this.parentBone.gridItemFormats[S.id]);}if(C){C.setAttribute("id",M);C.setAttribute("name",M);}loadInit("mstrGridRWScript",'microstrategy.registerBone("'+O+'", "(true)", { beanPath : \''+this.parentBone.beanPath+"."+P+"' });");loadInit('mstrGridRWScript && microstrategy.bone("'+O+'") != null','microstrategy.bone("'+O+'").onload();');loadInit('mstrGridRWScript && microstrategy.bone("'+O+'") != null','microstrategy.bone("'+O+'").gridCellCssPrefix = "'+this.parentBone.gridCellCssPrefix+'";');if(C){loadInit("mstrPortalImplScript",'microstrategy.registerBone("'+M+'", "(true)", null);');loadInit('mstrPortalImplScript && microstrategy.bone("'+M+'") != null','microstrategy.bone("'+M+'").onload();');}}else{loadInit('mstrGridRWScript && microstrategy.bone("'+O+'") != null','microstrategy.bone("'+O+'").beanPath = "'+this.parentBone.beanPath+"."+P+'"; microstrategy.bone("'+O+'").onload();');loadInit('mstrGridRWScript && microstrategy.bone("'+O+'") != null','microstrategy.bone("'+O+'").gridCellCssPrefix = "'+this.parentBone.gridCellCssPrefix+'";');}}}this.updatePanelCM(D);this.updatePanelCM(X);H=K[0].lastChild;}else{if(Q==microstrategy.SUBOBJTYPE_DOC_IMAGE){V.getElementsByTagName("IMG")[0].setAttribute("id",V.id+"_img");}var B=null,U=K.length;for(var T=0;T<U;T++){B=V.cloneNode(true);K[T].appendChild(B);}var Y,E;if(Q==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){if(!W){var I=microstrategy.bone(V.id);if(!I.isTable){I.resetElement();I.onload();I.getCurrentPanel().clearContentsMenu();I.getCurrentPanel().updateContentsMenu();mstrDocImpl.updateSectionList(L,D,F,true);}}}else{if(Q==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(W){Y=document.getElementById(V.id);if(S){this.styleObj.cloneAttValues(S,V);E=microstrategy.bone(S.id+"_Ctl");E.initNewUnit(Y);}}else{if(V&&B){var G=V.getElementsByTagName("select");var R=B.getElementsByTagName("select");if(G&&G.length>0&&R&&R.length>0){R[0].selectedIndex=G[0].selectedIndex;}}microstrategy.bone(V.id+"_Ctl").onSectionChange();}mstrDocImpl.updateSectionList(L,D,F);}else{if(Q==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){if(W){Y=document.getElementById(V.id);if(S){E=microstrategy.bone(S.id+"_Ctr");E.initNewUnit(Y);}}}else{if(Q==microstrategy.SUBOBJTYPE_DOC_SHAPE&&V.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){if(W){Y=document.getElementById(V.id);if(S){this.styleObj.cloneAttValues(S,V);}E=microstrategy.bone(S.id);if(E){E.initNewUnit(Y);}else{this.initRoundedRectangle(V.id);}}}else{if(Q==microstrategy.SUBOBJTYPE_DOC_TEXT&&W&&this.isDocButton(S)){microstrategy.registerBone(V.id,"mstrButtonScript",null).onload();}}}}}this.updatePanelCM(D);this.updatePanelCM(X);H=B;}if((F.control||F.target)&&this.parentBone.autoWire&&this.undoRedoSubSections!=null){for(var P in L){this.undoRedoSubSections.push(L[P]);}}}return H;}catch(J){microstrategy.errors.log(J);return null;}};mstrDocImpl.prototype.updatePanelCM=function(A){if(A&&microstrategy.subObjectType(A.elem)==microstrategy.SUBOBJTYPE_DOC_PANEL){A.updateContentsMenu();}};mstrDocImpl.prototype.restoreDeletedItems=function(F,A){try{var H=document.getElementsByName(F.getAttribute("id"));for(var C=0;C<A.length;C++){var E=A[C];H[C].appendChild(E);if(microstrategy.subObjectType(E)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var B=microstrategy.findBone(E);if(B){B.onload();}}var G=this.formattingAttributes[E.id];G.deleted=false;}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.formatUnderlineStrikeout=function(P,E,R,V){try{var K,B;var M=R.split(",");var N=parseInt(M[0],10);if(M.length==1){if(N&4){K=(N>0);B=-1;}else{K=-1;B=(N>0);}}else{K=((N&4)&&(N>0));N=parseInt(M[1],10);B=((N&8)&&(N>0));}var A="underline";var H="line-through";var F="textDecoration";var D="textDecoration2";for(var T in P){var Q=P[T].getAttribute("id");var L=document.getElementsByName(Q);if(L&&this.checkAppliesTo(P[T],E)){var C=this.styleObj.getValue(P[T],F,microstrategy.formatType);C=C!=undefined?(C.indexOf(A)>-1):false;var U=this.styleObj.getValue(P[T],D,microstrategy.formatType);U=U!=undefined?(U.indexOf(H)>-1):false;if(this.styleObj.doTextDecOnBone(P[T])){var J=microstrategy.findBone(P[T]);C=J[F];C=C!=undefined?(C.indexOf(A)>-1):false;U=J[D];U=U!=undefined?(U.indexOf(H)>-1):false;}var G=(K==-1)?C:K;var W=(B==-1)?U:B;if(V){var O=this.parentBone.updateManager;if(G!=C){V.push(O.createEditPropsAction(L[0],Q,this.parentBone.beanPath,[F],[(G)?A:""],[(C)?A:""]));}if(W!=U){V.push(O.createEditPropsAction(L[0],Q,this.parentBone.beanPath,[D],[(W)?H:""],[(U)?H:""]));}}R="";if(microstrategy.subObjectType(L[0])==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(!(G||W)){R="none";}else{if(G){R+=A;if(W){R+=" ";}}if(W){R+=H;}}}for(var S=0;S<L.length;S++){this.styleObj.setValue(L[S],F,(G)?A:"none");this.styleObj.setValue(L[S],D,(W)?H:"none");if(R&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){this.styleObj.cascadeSelectorValue(L[S],F,R);}}}}}catch(I){microstrategy.errors.log(I);}};mstrDocImpl.prototype.renamePanel=function(){try{var A=microstrategy.bones.msgBox;if(A.getInputValue()&&this.commands.queryEnabled("onepanelstack")){var B=microstrategy.findBone(this.commands.queryState("selectedPanelStack"));if(B){this.formatAttribute({0:B.getCurrentPanel().elem},"windowTitle",A.getInputValue(),true,microstrategy.HTMLATTR_WINDOW_TITLE,null);B.getCurrentPanel().elem.setAttribute("wt",A.getInputValue());microstrategy.eventManager.notifyOrphanBones("onpanelchange");this.parentBone.delay("observer.notifyAll('onselectionchange')");}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatPadding=function(L,C,M,G,O){try{var N=(O!=null);if(G||N){if(!N){O=[];}}var K=microstrategy.getFormatObject(),E=this.styleObj,J=this.parentBone.updateManager,B=this.parentBone.beanPath,H,I,A,M;var D=function(P){return microstrategy.number.toLocaleString(K.encodeValue(C,microstrategy.number.toLocaleString(M)));};mstr.$A.forEach(L,function(P){var Q=P.id;if(!this.checkAppliesTo(P,C)){return ;}H=Q+mstrUpdateManager.UNIT_SEPARATOR+K.getPropertySetName(C)+mstrUpdateManager.UNIT_SEPARATOR+K.getPropertyName(C)+mstrUpdateManager.UNIT_SEPARATOR;A=D(E.getValue(P,C));O.push(J.createActionObject(P,mstrUpdateManager.EDIT_PROPS,B,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H+D(M)+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,H+A+mstrUpdateManager.ITEM_SEPARATOR]));mstr.$A.forEach(document.getElementsByName(Q),function(R){E.setValue(R,C,M);});},this);if(!N&&G&&O&&O.length>0){J.add(O);}return(N)?O:null;}catch(F){microstrategy.errors.log(F);return(O!=null)?O:false;}};mstrDocImpl.prototype.formatItems=function(L,J,n,Y,H,o){try{var AE=mstrFormatObject;var I=this.styleObj;var Z=this.parentBone.updateManager;var T=(H!=null);if(Y||T){if(!T){H=[];}}var AB,e,AF,P,B,O;var Q=microstrategy.formatType;var z=this.parentBone.beanPath;for(var V in L){var g=L[V];var e=microstrategy.subObjectType(g);var M=null;if(this.checkAppliesTo(g,J)){if(e==microstrategy.SUBOBJTYPE_DOC_LINE){var W=I.getAttValue(g,microstrategy.HTMLATTR_ORIENTATION);if((J=="height"&&W==microstrategy.ORIENTATION_HORIZONTAL)||(J=="height"&&W==microstrategy.ORIENTATION_HORIZONTAL)){continue;}}var AG=[];if((J=="backgroundColor"||J=="backgroundStyle"||J=="Gradient")&&e==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){M=microstrategy.findBone(g);if(this.selections.panelUnitFormat==0){if(this.selections.panelValueFormat==0&&Q==microstrategy.FORMAT_TYPE_MAIN){g=M.getCurrentPanel().elem;}AG.push(g);}else{if(M.panels){for(var AA=0;AA<M.panels.length;AA++){AG.push(M.panels[AA].elem);}}}}else{AG.push(g);}for(var K in AG){var A=AG[K];var c=A.getAttribute(microstrategy.HTMLATTR_OBJTYPE);e=microstrategy.subObjectType(A);var AI=this.getGradientColor(A,Q);var a=A.getAttribute("id");if(H&&J!="Gradient"&&J!="selectionColor"&&J!="selectionStyle"){if((J!="backgroundColor"&&J!="backgroundStyle")||(AI==null||AI=="")){var AD=n;var U=false;if(J=="paddingLeft"||J=="paddingTop"||J=="paddingBottom"||J=="paddingRight"){AD=microstrategy.number.toLocaleString(n);U=true;}H.push(Z.createEditPropsAction(A,a,z,[J],[AD],[(J=="backgroundStyle")?"transparent":I.getValue(A,J)],null,null,null,U));if(e==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&bIsIE4){var h=microstrategy.findBone(A);if(h&&h.isGraph){H.forceSubmit=true;}}}else{AF=a+mstrUpdateManager.UNIT_SEPARATOR+AE.getPropertySetName(J)+mstrUpdateManager.UNIT_SEPARATOR+AE.getPropertyName(J)+mstrUpdateManager.UNIT_SEPARATOR;P=(J=="backgroundColor")?a+mstrUpdateManager.UNIT_SEPARATOR+"Gradient"+mstrUpdateManager.UNIT_SEPARATOR:AF;B=AI;if(J=="backgroundStyle"){B="gradient";}H.push(Z.createActionObject(A,mstrUpdateManager.EDIT_PROPS,z,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,AF+AE.encodeValue(J,n)+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,P+B+mstrUpdateManager.ITEM_SEPARATOR]));}}var E=J;if(J=="backgroundStyle"&&n=="transparent"&&I.getValue(A,"backgroundColor")=="transparent"&&AI==null){E="backgroundColor";}var N=document.getElementsByName(a);if(E=="backgroundColor"&&Q==microstrategy.FORMAT_TYPE_MAIN){var u=(n=="transparent")?1:0;for(AB=0;AB<N.length;AB++){N[AB].setAttribute("bgstyle",u);if(N[AB].getAttribute("gradientcolor")){N[AB].removeAttribute("gradientcolor");}}if(c==microstrategy.OBJTYPE_DOC_SUBSECTION&&A.getAttribute("scriptclass")!="mstrPanel"){var F=this.getChildBone(A);if(F){F.setSibsWithGradients(null);F.setGradientInfo(N,null);}}}if(E=="Gradient"){if(!bIsIE4&&!this.parentBone.isFeatureAvailable(microstrategy.FEATURE_IS_CLOUD)){showMessage({contents:microstrategy.descriptors.getDescriptor("9751"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING,zIndex:1001});}if(Q==microstrategy.FORMAT_TYPE_MAIN){if(AI==null){P=a+mstrUpdateManager.UNIT_SEPARATOR+AE.getPropertySetName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR+AE.getPropertyName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR;B=AE.encodeValue("backgroundColor",I.getValue(A,"backgroundColor"));}else{P=a+mstrUpdateManager.UNIT_SEPARATOR+"Gradient"+mstrUpdateManager.UNIT_SEPARATOR;B=AI;}var D=n.split(",");if((c==microstrategy.OBJTYPE_DOC_SUBSECTION&&A.getAttribute("scriptclass")!="mstrPanel")||(e==microstrategy.SUBOBJTYPE_DOC_SHAPE&&A.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){var X=(c==microstrategy.OBJTYPE_DOC_SUBSECTION)?this.getChildBone(A):microstrategy.bone(A.id);if(X){if(c==microstrategy.OBJTYPE_DOC_SUBSECTION){X.setSibsWithGradients(N);X.setGradientInfo(N,D);}else{X.gradientColor={startingColor:D[gradientUtil.GRADIENT_START_COLOR_INDEX],endingColor:D[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientAngle:D[gradientUtil.GRADIENT_ANGLE_INDEX],gradientXOffset:D[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientYOffset:D[gradientUtil.GRADIENT_YOFFSET_INDEX]};}X.applyGradient();}}else{for(AB=0;AB<N.length;AB++){N[AB].setAttribute("bgstyle","2");N[AB].setAttribute("gradientcolor",n);gradientUtil.applyGradientSettings(N[AB],D,microstrategy.styleObj);}}if(H){var m=function(AK,AJ){return a+mstrUpdateManager.UNIT_SEPARATOR+AE.getPropertySetName(AK)+mstrUpdateManager.UNIT_SEPARATOR+AE.getPropertyName(AK)+mstrUpdateManager.UNIT_SEPARATOR+AJ+mstrUpdateManager.ITEM_SEPARATOR;};H.push(Z.createActionObject(A,mstrUpdateManager.EDIT_PROPS,z,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,m("backgroundColor",AE.encodeValue("backgroundColor",n))+m("gradientColor",AE.encodeValue("gradientColor",n))+m("backgroundStyle",AE.encodeValue("backgroundStyle",n))+m("gradientAngle",D[3])+m("gradientXOffset",D[4])+m("gradientYOffset",D[5])],[mstrUpdateManager.UPDATE_LATER,P+B+mstrUpdateManager.ITEM_SEPARATOR]));}}else{O=microstrategy.findBone(A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL?A.lastChild:A);if(O&&O.applyGradientOnItem){O.applyGradientOnItem(Q,J,n,H,AE);}}}if(E=="selectionColor"||E=="selectionStyle"){var y=(E=="selectionColor")?microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR:microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE;var S=I.getAttValue(g,y);I.setAttValue(g,y,n);if(E=="selectionColor"&&g.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(g.lastChild){var x=microstrategy.bone(g.lastChild.id);if(x&&x.setSelectionColor){x.setSelectionColor(n);}}}if(H){H.push(Z.createEditPropsAction(g,a,z,[E],[n],[S]));}}else{if(E!="backgroundStyle"){if(this.selections.isSingleSelectionType&&N[0]&&microstrategy.subObjectType(N[0])==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&!(this.selections.panelUnitFormat==0&&this.selections.panelValueFormat==0)){var AH=mstrStaticDoc.getBone(N[0]);if(AH&&AH.setFormatValue){AH.setFormatValue(mstrPanelStack.FMT_TYPE_TITLE,E,n);}}else{if(this.selections.isSingleSelectionType&&N[0]&&microstrategy.subObjectType(N[0])==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&!(this.selections.controlUnitFormat==0&&this.selections.controlValueFormat==0)&&!(E=="dropShadowDepth"||E=="dropShadowEffect")){var AH=mstrStaticDoc.getBone(N[0]);if(AH&&AH.setFormatValue){AH.setFormatValue(mstrRWControlImpl.FMT_TYPE_TITLE,E,n);}}else{for(AB=0;AB<N.length;AB++){var q=I.getValue(N[AB],"TextDirection")||"0";I.setValue(N[AB],E,n);if(E.match(/^padding/)){var G,C;if(E.match(/Left$/)||E.match(/Right$/)){G="width";C=microstrategy.HTMLATTR_WIDTH;}else{G="height";C=microstrategy.HTMLATTR_HEIGHT;}N[AB].style[q==="0"?G:G==="width"?"height":"width"]=I.adjustSizes(G,AE.decodeValue(G,I.getAttValue(N[AB],C)),null,N[AB])+"px";}if(q!="0"){I.changeVerticalTextPosition(N[AB],{x:E==="top"?parseInt(n,0):null,y:E==="left"?parseInt(n,0):null});}}}}}}if(J=="backgroundColor"&&c==microstrategy.OBJTYPE_DOC_SUBSECTION&&A.getAttribute("scriptclass")!="mstrPanel"){var R=this.getChildBone(A);if(R){R.startingColor=null;R.endingColor=null;}}if(J=="backgroundColor"&&e==microstrategy.SUBOBJTYPE_DOC_SHAPE&&A.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){O=microstrategy.bone(A.id);if(O){O.synchronizeFormat();}if(A.getAttribute("gradientcolor")){A.removeAttribute("gradientcolor");}}if(J=="backgroundColor"&&g.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(g.lastChild){var x=microstrategy.bone(g.lastChild.id);if(x.setSelectionColor){x.setSelectionColor(microstrategy.styleObj.getAttValue(g,microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR));}}}}if(M){M.synchronizeShadow();}}}if(!T&&Y&&H&&H.length>0){Z.add(H);}return(T)?H:null;}catch(AC){microstrategy.errors.log(AC);return(H!=null)?H:false;}};mstrDocImpl.prototype.setGridDataSource=function(A,E,D){try{for(var C in A){var G=A[C].getAttribute("id");var F=document.getElementsByName(G);if(F){if(D){D.push(this.parentBone.updateManager.createActionObject(F[0],mstrUpdateManager.CHANGE_DATA_SET,this.parentBone.beanPath,["2048031","2048012"],[E,G]));}}}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.setGridOrigin=function(E,A,G,H){try{var F=(A)?"1":"0";for(var I in E){var B=E[I].getAttribute("id");var D=document.getElementsByName(B);if(D){if(H){H.push(this.parentBone.updateManager.createActionObject(D[0],mstrUpdateManager.CHANGE_TEMPLATE_ORIGIN,this.parentBone.beanPath,["2048158","2048031","2048012"],[F,G,B]));}}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatItemBorders=function(S,F,c,U,W,N,o){try{var g=mstrFormatObject;var Y=(o!=null);var Q=this.parentBone.updateManager;var a=this.styleObj;if(N||Y){if(!Y){var o=[];}}var H=(parseFloat(U)>0);var m=[];for(var Z=0;Z<F.length;Z++){switch(F[Z]){case"borderTop":m.push("bt");break;case"borderBottom":m.push("bb");break;case"borderRight":m.push("br");break;case"borderLeft":m.push("bl");break;}}for(var h in S){var T=S[h].getAttribute("id");var M=document.getElementsByName(T);if(M.length==0){continue;}var e=microstrategy.subObjectType(S[h]);var L=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&(e==microstrategy.SUBOBJTYPE_DOC_TEXT||e==microstrategy.SUBOBJTYPE_DOC_IMAGE||e==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||e==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER));var G=(a.getAttValue(S[h],microstrategy.HTMLATTR_BORDER)==microstrategy.HAS_BORDER);if(U.length>0){if(L&&H&&!G){for(var X=0;X<M.length;X++){M[X].style.border="";}}for(var Z=0;Z<F.length;Z++){if(this.checkAppliesTo(S[h],F[Z]+"Color")&&this.checkAppliesTo(S[h],F[Z]+"Style")){var K=(U!="0pt"&&(W.length==0||!G));if(K){K=(!G||a.getAttValue(S[h],m[Z]+"c").length==0);}var P=true;if(W.length==0){if(K){W="#000000";}else{P=false;}}if(o){o.push(Q.createEditPropsAction(S[h],T,this.parentBone.beanPath,[F[Z]+"Style"],[U+" "+c],[g.decodeValue(F[Z]+"Style",a.getAttValue(S[h],m[Z]+"s"))]));if(P){o.push(Q.createEditPropsAction(S[h],T,this.parentBone.beanPath,[F[Z]+"Color"],[W],[g.decodeValue(F[Z]+"Color",a.getAttValue(S[h],m[Z]+"c"))]));}}a.setAttValue(S[h],m[Z]+"c",g.encodeValue(F[Z]+"Color",W));a.setAttValue(S[h],m[Z]+"s",g.encodeValue(F[Z]+"Style",U+" "+c));var D=U+" "+c,E=F[Z];if(M[0].getAttribute(F[Z])!=null){for(var X=0;X<M.length;X++){E=a.swapForRotation(M[X],F[Z]);M[X].setAttribute(E,D,0);if(P){M[X].setAttribute(E+"Color",W,0);}}}else{var C=(P)?W:a.getValue(M[0],F[Z]+"Color");for(var X=0;X<M.length;X++){E=a.swapForRotation(M[X],F[Z]);M[X].style[E]=D;M[X].style[E+"Color"]=C;}}}}}else{for(var Z=0;Z<F.length;Z++){if(this.checkAppliesTo(S[h],F[Z]+"Color")){if(o!=null){o.push(Q.createEditPropsAction(S[h],T,this.parentBone.beanPath,[F[Z]+"Color"],[W],[g.decodeValue(F[Z]+"Color",a.getAttValue(S[h],m[Z]+"c"))]));}a.setAttValue(S[h],m[Z]+"c",g.encodeValue(F[Z]+"Color",W));var E=F[Z];if(M[0].getAttribute(F[Z]+"Color")){for(var X=0;X<M.length;X++){E=a.swapForRotation(M[X],F[Z]);M[X].setAttribute(E+"Color",W,0);}}else{for(var X=0;X<M.length;X++){E=a.swapForRotation(M[X],F[Z]);M[X].style[E+"Color"]=W;}}}}}if(L){if(H){a.setAttValue(M[0],microstrategy.HTMLATTR_BORDER,microstrategy.HAS_BORDER);}else{var B={Top:false,Bottom:false,Left:false,Right:false};for(var n in B){var O=a.getValue(M[0],"border"+n+"Width");var R=a.getValue(M[0],"border"+n+"Style");B[n]=(O.length!=0&&O!="0pt"&&R.length!=0&&R!="none");}if(!B.Top&&!B.Bottom&&!B.Left&&!B.Right){a.setAttValue(M[0],microstrategy.HTMLATTR_BORDER,microstrategy.NO_BORDER);for(var X=0;X<M.length;X++){M[X].style.border=microstrategy.DESIGNMODE_NOBORDER_STYLE;}}}}var V=function(y,u,q,x){y.style[x?u:u==="width"?"height":"width"]=a.adjustSizes(u,g.decodeValue(u,a.getAttValue(y,q)),null,y)+"px";},J=true;for(var Z=0;Z<M.length;Z++){J=!a.getValue(M[Z],"TextDirection")||a.getValue(M[Z],"TextDirection")==="0";if(a.getAttValue(M[Z],microstrategy.HTMLATTR_WIDTH_MODE)!=microstrategy.AUTO_MODE){V(M[Z],"width",microstrategy.HTMLATTR_WIDTH,J);}if(a.getAttValue(M[Z],microstrategy.HTMLATTR_HEIGHT_MODE)!=microstrategy.AUTO_MODE){V(M[Z],"height",microstrategy.HTMLATTR_HEIGHT,J);}}this.adjustObjectSize(M);if(e==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(S[h]);if(A&&A.isGraph){if(o){o.forceSubmit=true;}}}}if(!Y&&N&&o.length>0){Q.add(o);}return(Y)?o:null;}catch(I){microstrategy.errors.log(I);return false;}};mstrDocImpl.prototype.adjustObjectSize=function(H){try{var G={0:H[0]};var F=this.styleObj;var B=microstrategy.subObjectType(H[0]);var D=this;var E=function(I,L,K){var J;if(I==microstrategy.HUNDRED_PERCENT_MODE&&B==microstrategy.SUBOBJTYPE_DOC_SHAPE){J=D.calcParentSubHeightWidth(H[0],L)+"px";}else{if(I!=microstrategy.AUTO_MODE){J=mstrFormatObject.decodeValue(L,F.getAttValue(H[0],K));}else{return ;}}D.formatSize(G,L,J);};E(F.getAttValue(H[0],microstrategy.HTMLATTR_HEIGHT_MODE),"height",microstrategy.HTMLATTR_HEIGHT);E(F.getAttValue(H[0],microstrategy.HTMLATTR_WIDTH_MODE),"width",microstrategy.HTMLATTR_WIDTH);if(B==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||B==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(H[0]);A.synchronizeSize();}}catch(C){microstrategy.errors.log(C);return false;}};mstrDocImpl.prototype.formatLineSetting=function(G,A,K,E,S){try{var N=(S!=null);var F=this.parentBone.updateManager;S=S||[];var P=mstrFormatObject;var O=this.styleObj;var H=A.substr(4);if(H=="Weight"){H="Width";}for(var R in G){var I=G[R].getAttribute("id");var D=document.getElementsByName(I);if(!D||!this.checkAppliesTo(G[R],A)){continue;}var C=microstrategy["HTMLATTR_LINE_"+H.toUpperCase()];var Q=H;var J=microstrategy.subObjectType(G[R]);if(J==microstrategy.SUBOBJTYPE_DOC_LINE){if(A=="lineWeight"&&parseInt(K,10)<=0){continue;}if(O.getAttValue(G[R],microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_HORIZONTAL){Q="Top"+Q;}else{Q="Left"+Q;}}Q="border"+Q;if(S){S.push(F.createEditPropsAction(G[R],I,this.parentBone.beanPath,[A],[K],[P.decodeValue(A,O.getAttValue(G[R],C))]));}O.setAttValue(G[R],C,P.encodeValue(A,K));if(J!=microstrategy.SUBOBJTYPE_DOC_SHAPE||G[R].getAttribute(microstrategy.HTMLATTR_STYLE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var L=function(U,T){D[M].style[U]=O.adjustSizes(U,P.decodeValue(U,O.getAttValue(D[M],T)),null,D[M])+"px";};for(var M=0;M<D.length;M++){D[M].style[Q]=K;if(Q=="borderWidth"||Q=="borderStyle"){L("width",microstrategy.HTMLATTR_WIDTH);L("height",microstrategy.HTMLATTR_HEIGHT);}}}}if(!N&&E&&S.length>0){F.add(S);}return(N)?S:null;}catch(B){microstrategy.errors.log(B);return null;}};mstrDocImpl.prototype.formatLineSetting=function(G,A,L,E,S){try{var F=this.parentBone.updateManager;var P=mstrFormatObject;var O=this.styleObj;var H=A.substr(4);var C=microstrategy["HTMLATTR_LINE_"+H.toUpperCase()];if(H=="Weight"){H="Width";}for(var R in G){var I=G[R].getAttribute("id");var D=document.getElementsByName(I);if(!D||!this.checkAppliesTo(G[R],A)){continue;}var Q=H;var K=microstrategy.subObjectType(G[R]);if(K==microstrategy.SUBOBJTYPE_DOC_LINE){if(A=="lineWeight"&&parseInt(L,10)<=0){continue;}var J=(O.getAttValue(G[R],microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_HORIZONTAL)?"Top":"Left";Q=J+Q;}Q="border"+Q;if(S){S.push(F.createEditPropsAction(G[R],I,this.parentBone.beanPath,[A],[L],[P.decodeValue(A,O.getAttValue(G[R],C))]));}O.setAttValue(G[R],C,P.encodeValue(A,L));if(K!=microstrategy.SUBOBJTYPE_DOC_SHAPE||G[R].getAttribute(microstrategy.HTMLATTR_STYLE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var M=function(T){D[N].style[T]=O.adjustSizes(T,P.decodeValue(T,O.getAttValue(D[N],microstrategy["HTMLATTR_"+T.toUpperCase()])),null,D[N])+"px";};for(var N=0;N<D.length;N++){D[N].style[Q]=L;if(Q=="borderWidth"||Q=="borderStyle"){M("width");M("height");}}}}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.applyUserMetricFormat=function(A){try{var H=A.userMetricId;var C=A.dataSetId;var D=A.bulkChanges;if(H&&C){var E=this.parentBone.updateManager;var G=[];var B="";for(counter=0;counter<D.length;counter++){D[counter]=D[counter].replace("|",mstrUpdateManager.UNIT_SEPARATOR);B=B+"FormattingNumber"+mstrUpdateManager.UNIT_SEPARATOR+D[counter]+mstrUpdateManager.ITEM_SEPARATOR;}B=B.substring(0,B.length-1);G.push(E.createActionObject(null,mstrUpdateManager.FORMAT_USER_METRIC,this.parentBone.beanPath,["2048031","2048001","2048035","2048018"],[C,H,B,mstrUpdateManager.UPDATE_LATER]));E.add(G);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){E.flushAndSubmitChanges();}}}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.populatePortalSizeValues=function(G,E,F,B,D){try{var A=G.getAttValue(E,microstrategy[B]);this.formatAttribute({0:E},F,A,null,microstrategy[B.replace("_","_OLD_")],D);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.minimizePortal=function(L,B,O,G,U){try{var R=(U!=null);var J=this.parentBone.updateManager;if(G||R){if(!R){U=[];}}var S=this.styleObj;var K="|";for(var T in L){var M=L[T].getAttribute("id");K+=M+"|";var F=document.getElementsByName(M);if(F&&this.checkAppliesTo(L[T],B)&&S.getAttValue(L[T],microstrategy.HTMLATTR_WINDOW_STATE)!=microstrategy.WINDOW_STATE_MINIMIZED){this.restoreOldTopAndLeft(L[T]);var W=microstrategy.findBone(microstrategy.findAncestorWithAtt(L[T],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION));if(U){var N={0:L[T]};var A=S.getAttValue(L[T],microstrategy.HTMLATTR_WINDOW_STATE);if(A==microstrategy.WINDOW_STATE_NORMAL){this.populatePortalSizeValues(S,L[T],"oldHeight","HTMLATTR_HEIGHT",U);this.populatePortalSizeValues(S,L[T],"oldWidth","HTMLATTR_WIDTH",U);}var C=microstrategy.findChildWithAtt(F[0],"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrPortalImpl");var V=(C)?getObjHeight(C):microstrategy.WINDOW_TITLE_HEIGHT;if(C){var E=S.getAttValue(L[T],"wth");if(E!=null){V=E+microstrategy.getPaddingAndBorderPixels(L[T],"height");}V+="px";}this.formatSize(N,"height",""+V,U,!!C,false,true);if(A==microstrategy.WINDOW_STATE_MAXIMIXED){var I=S.getAttValue(L[T],microstrategy.HTMLATTR_OLD_WIDTH);if(I){this.formatSize(N,"width",mstrFormatObject.decodeValue("width",I),U,true,false,true);}}U.push(J.createEditPropsAction(F[0],M,this.parentBone.beanPath,[B],[O],[mstrFormatObject.decodeValue(B,S.getAttValue(L[T],microstrategy.HTMLATTR_WINDOW_STATE))]));if(W){var H=W.maxZindex-1;var Q=microstrategy.getViewerBone();if(Q.portals&&Q.portals[L[T].id]&&typeof (Q.portals[L[T].id][microstrategy.WINDOW_STATE_NORMAL])!="undefined"){H=Q.portals[L[T].id][microstrategy.WINDOW_STATE_NORMAL];}this.formatItems(N,"zIndex",H,false,U);}}if(W){this.processSubsectionBone(W);}for(var P=0;P<F.length;P++){S.setAttValue(F[P],microstrategy.HTMLATTR_WINDOW_STATE,O);}}microstrategy.eventManager.notifyOrphanBones("portalWindowResize","minimize",M);}this.selections.syncUp();this.updateLayoutWidth(U);if(!R&&G&&U.length>0){J.add(U);}microstrategy.eventManager.notifyOrphanBones("onboneafterresize",K);return(R)?U:null;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocImpl.prototype.maximizePortal=function(M,C,Q,H,a){try{var U=(a!=null);var K=this.parentBone.updateManager;if(H||U){if(!U){a=[];}}var Y=mstrFormatObject;var W=this.styleObj;var L="|";var F={};for(var Z in M){var N=M[Z].getAttribute("id");L+=N+"|";var G=document.getElementsByName(N);var B=W.getAttValue(M[Z],microstrategy.HTMLATTR_WINDOW_STATE);if(G&&this.checkAppliesTo(M[Z],C)&&B!=microstrategy.WINDOW_STATE_MAXIMIXED){var E=this;var O={0:M[Z]};var A=function(e){W.setAttValue(M[Z],microstrategy["HTMLATTR_OLD_"+e.toUpperCase()],Y.encodeValue(e,parseInt(W.getValue(M[Z],e))));E.formatItems(O,e,0,false);};A("top");A("left");var c=microstrategy.findBone(microstrategy.findAncestorWithAtt(M[Z],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION));if(a){F[c.id]=c;if(B==microstrategy.WINDOW_STATE_NORMAL){this.populatePortalSizeValues(W,M[Z],"oldHeight","HTMLATTR_HEIGHT",a);this.populatePortalSizeValues(W,M[Z],"oldWidth","HTMLATTR_WIDTH",a);}var X=function(h,e){var e=!!e?e:E.calcParentSubHeightWidth(M[Z],h),g=e;if(bIsIE8){g=(parseInt(g)-1)+"px";}E.formatSize(O,h,g,a,true,false);return e;};var R=W.getAttValue(c.elem,microstrategy.HTMLATTR_HEIGHT);if(R){R=Y.decodeValue("height",R);}R=X("height",R);var J=X("width");if(mstrStaticDoc.getBone(M[Z])){mstrStaticDoc.getBone(M[Z]).synchronizeSize();}if(c.subsectionType!=mstrSubSection.TYPE_PANEL){this.formatSubHeightWidth({0:c.elem},"height",[Y.encodeValue("height",R),W.getAttValue(c.elem,microstrategy.HTMLATTR_MAX_HEIGHT),"0","0",W.getAttValue(c.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)],a);}a.push(K.createEditPropsAction(G[0],N,this.parentBone.beanPath,[C],[Q],[B]));var P=c.maxZindex;var I=W.getValue(M[Z],"zIndex");if(P>=I){P++;var T=microstrategy.getViewerBone();T.portals=T.portals||{};T.portals[M[Z].id]=T.portals[M[Z].id]||{};T.portals[M[Z].id][B]=I;a=this.formatItems(O,"zIndex",P,false,a);}}if(c){this.processSubsectionBone(c);}for(var S=0;S<G.length;S++){W.setAttValue(G[S],microstrategy.HTMLATTR_WINDOW_STATE,Q);}}microstrategy.eventManager.notifyOrphanBones("portalWindowResize","maximize",N);}if(F&&a){for(var V in F){var c=F[V];c.maxZindex++;}}this.selections.syncUp();this.updateLayoutWidth(a);if(!U&&H&&a.length>0){K.add(a);}microstrategy.eventManager.notifyOrphanBones("onboneafterresize",L);return(U)?a:null;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocImpl.prototype.restorePortal=function(L,B,O,G,X){try{var S=(X!=null);var J=this.parentBone.updateManager;if(G||S){if(!S){X=[];}}var V=mstrFormatObject;var T=this.styleObj;var K="|";var E={};for(var W in L){var M=L[W].getAttribute("id");K+=M+"|";var F=document.getElementsByName(M);var A=T.getAttValue(L[W],microstrategy.HTMLATTR_WINDOW_STATE);if(F&&this.checkAppliesTo(L[W],B)&&A!=microstrategy.WINDOW_STATE_NORMAL){this.restoreOldTopAndLeft(L[W]);var Y=microstrategy.findBone(microstrategy.findAncestorWithAtt(L[W],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION));var D=this;var N={0:L[W]};if(X){var U=function(a){var Z=T.getAttValue(L[W],microstrategy["HTMLATTR_OLD_"+a.toUpperCase()]);D.formatSize(N,a,V.decodeValue(a,Z),X,true,false);return Z;};var P=U("height");var I=U("width");if(mstrStaticDoc.getBone(L[W])){mstrStaticDoc.getBone(L[W]).synchronizeSize();}X.push(J.createEditPropsAction(F[0],M,this.parentBone.beanPath,[B],[O],[A]));if(Y){var H=Y.maxZindex-1;var R=microstrategy.getViewerBone();if(R.portals&&R.portals[L[W].id]&&typeof (R.portals[L[W].id][microstrategy.WINDOW_STATE_NORMAL])!="undefined"){H=R.portals[L[W].id][microstrategy.WINDOW_STATE_NORMAL];}this.formatItems(N,"zIndex",H,false,X);}}if(Y){this.processSubsectionBone(Y);}for(var Q=0;Q<F.length;Q++){T.setAttValue(F[Q],microstrategy.HTMLATTR_WINDOW_STATE,O);}}microstrategy.eventManager.notifyOrphanBones("portalWindowResize","restore",M);}this.selections.syncUp();this.updateLayoutWidth(X);if(!S&&G&&X.length>0){J.add(X);}microstrategy.eventManager.notifyOrphanBones("onboneafterresize",K);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.restoreOldTopAndLeft=function(E,A){try{if(typeof (A)=="undefined"){A=microstrategy.RESTORE_BOTH;}var D=this;var B=function(G){var F=D.styleObj.getAttValue(E,microstrategy["HTMLATTR_OLD_"+G.toUpperCase()]);if(F){D.formatItems({0:E},G,mstrFormatObject.decodeValue(G,F),false);}};if(A!=microstrategy.RESTORE_LEFT){B("top");}if(A!=microstrategy.RESTORE_TOP){B("left");}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatTitle=function(F,A,G,H){try{for(var I in F){var B=F[I].getAttribute("id");var E=document.getElementsByName(B);if(E&&this.checkAppliesTo(F[I],A)){if(H){H.push(this.parentBone.updateManager.createEditPropsAction(E[0],B,this.parentBone.beanPath,[A],[G],[mstrFormatObject.decodeValue(A,(F[I].getAttribute("title",0)||""))]));}this.styleObj.setAttValue(F[I],microstrategy.HTMLATTR_TOOLTIP_FORMULA,G);for(var D=0;D<E.length;D++){if(bIsIE7&&E[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){E[D].setAttribute("tooltip",G,0);}else{E[D].setAttribute("title",G,0);}}}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatAttribute=function(J,A,L,G,K,P,D){try{var N;var M=(P!=null);if(G||M){var I=this.parentBone.updateManager;if(!M){P=[];}}for(var O in J){var E=J[O];var B=J[O].getAttribute("id");var H=document.getElementsByName(B);if(H&&this.checkAppliesTo(J[O],A)){if(P){P.push(I.createActionObject(H[0],mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035","2048241"],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(B,A,L,true),D?"1":"0"],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(B,A,this.styleObj.getAttValue(E,K,true))]));}this.styleObj.setAttValue(E,K,L);if(K=="swt"){N=microstrategy.findBone(E);if(N&&N.toggleTitleBars){N.isTitleVisible=(L==-1);N.toggleTitleBars();if(N.synchronizeSize){N.synchronizeSize();}}}if(K=="wt"){N=microstrategy.findBone(E);if(N&&N.updatePortalTitle){N.updatePortalTitle(L);}}if(K=="tbd"){N=microstrategy.findBone(J[O]);if(N){N.titleBarDisplay=L;N.adjustTitle();}}if(K=="nm"&&microstrategy.subObjectType(J[O])==microstrategy.SUBOBJTYPE_DOC_PANEL){microstrategy.findBone(J[O]).parentBone.adjustTitle(J[O]);}if(K=="visible"||K=="nm"||K=="wt"||K=="lck"||K=="twc"||K=="rsl"){this.styleObj.setAttValue(E,K,L);}if(K==microstrategy.HTMLATTR_NORMAL_URL||K==microstrategy.HTMLATTR_HIGHLIGHT_URL){N=microstrategy.findBone(E);if(N&&N.updateIcons){N.updateIcons();}}if(K==microstrategy.HTMLATTR_FILL_EFFECT){N=microstrategy.findBone(E);if(N&&N.updateFillEffect){N.updateFillEffect();}}if(K==microstrategy.HTMLATTR_DISPLAY_STYLE){N=microstrategy.findBone(E);if(N&&N.updateDisplayStyle){N.updateDisplayStyle(P,G);}}}else{if(H&&this.parentBone.commands.queryState("isDDIC")){if(P){var C=microstrategy.getViewerBone().doc.commands,Q=C.getDDICBoneProperty([J[O]],"ctlKey",null);P.push(I.createActionObject(H[0],mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035","2048241"],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(Q,A,L,true),D?"1":"0"],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(Q,A,this.styleObj.getAttValue(E,K,true))]));}this.styleObj.setAttValue(E,K,L);}}}if(!M&&G&&P.length>0){I.add(P);}return(M)?P:null;}catch(F){microstrategy.errors.log(F);return(P!=null)?P:false;}};mstrDocImpl.prototype.formatIframeSource=function(A,E){try{for(var D in A){var G=A[D].getAttribute("id");var F=document.getElementsByName(G);if(F&&this.checkAppliesTo(A[D],"url")){var B=this.styleObj.getAttValue(F[0],microstrategy.HTMLATTR_HTML_TYPE);if(B==microstrategy.HTML_CONTAINER_TYPE_IFRAME){microstrategy.findRWObjectBone(F[0],"mstrHTMLContainerImpl").updateContents(B,E);}}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.importImage=function(C,B){var D=this;function F(H){var I=[];I.push(H.target.result);var G=new Blob(I);mstrmojo.xhr.upload("POST",mstrConfig.taskURL,{success:function(J){},failure:function(J){},complete:function(J){delete D.img;B.add([B.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,D.parentBone.beanPath,[],[],[])]);B.flushAndSubmitChanges();}},C.props,G,{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12963,"Uploading File...")});}function E(){var G={code:0,message:mstrmojo.desc(12814,"Cannot read file content")};if(callbacks.failure){callbacks.failure(G);}if(callbacks.complete){callbacks.complete();}}var A=new FileReader();A.onerror=E;A.onload=F;A.readAsArrayBuffer(C);};mstrDocImpl.prototype.formatImageSource=function(J,M,R,S){var O=false;try{for(var Q in J){var L=J[Q].getAttribute("id");var F=document.getElementsByName(L);if(microstrategy.subObjectType(J[Q])==microstrategy.SUBOBJTYPE_DOC_IMAGE&&F&&this.checkAppliesTo(J[Q],"src")){if(R){var T=F[0].getElementsByTagName("img");var K=(T.length>0)?T[0].getAttribute("src"):"";var E=microstrategy.getViewerBone().doc.prevSelectedId,A=document.getElementById(E),B=Number(A.getAttribute("ut")),C=B,H=this.parentBone.updateManager;if(this.img){C=mstr.Enum.IMAGE_URL_TYPE.BLOB_URL;this.img.props={taskId:"importImage",imageFieldName:"myFile",sectionKey:J[Q].parentNode.getAttribute("id"),fieldKey:L,fieldName:J[Q].getAttribute("name"),imageName:encodeURIComponent(this.img.name),imageSize:this.img.size,msgID:this.parentBone.messageID,isEdit:S};this.importImage(this.img,H);}else{C=mstr.Enum.IMAGE_URL_TYPE.HTTP_URL;}R.push(H.createActionObject(J[Q],mstrUpdateManager.EDIT_IMAGE,this.parentBone.beanPath,["2048012","2048019","2048295","2048018"],[L,M,C,mstrUpdateManager.UPDATE_LATER],[L,K,B,mstrUpdateManager.UPDATE_LATER]));if(!this.img){O=true;R.push(H.createActionObject(J[Q],mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[]));}}var N=false;for(var P=0;P<F.length;P++){var U=F[P].getElementsByTagName("img");if(U.length>0){var G=U[0].id;U[0].outerHTML="<img />";if(mstr.utils.ISFF){var I=M.split("?");if(I.length>1){I[0]=I[0].replace(/\\/g,"/");U[0].src=I.join("?");}else{U[0].src=I[0].replace(/\\/g,"/");}}else{U[0].src=M;}U[0].id=G;U[0].name=G;N=true;}}if(N){this.styleObj.setAttValue(J[Q],microstrategy.HTMLATTR_IMAGE_SOURCE,M);}}}}catch(D){microstrategy.errors.log(D);}return O;};mstrDocImpl.prototype.formatTemplateSize=function(A,F,E){try{var B=this.parentBone.updateManager;for(var D in A){var H=A[D].getAttribute("id");var G=document.getElementsByName(H);if(G&&this.checkAppliesTo(A[D],"xTabView")){microstrategy.findBone(this.selections.getSelectedGrid()).updateViewMode(F);E.push(B.createActionObject(G[0],mstrUpdateManager.CHANGE_VIEW_MODE,this.parentBone.beanPath+"."+G[0].id,["4115"],[F],[]));}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.changeLineOrientation=function(I,K,L){try{var H=this.parentBone.updateManager;for(var M in I){var A=I[M].getAttribute("id");var F=document.getElementsByName(A);if(F.length==0){F=mstr.utils.Arrays.fromHashValues(I);}if(F&&this.checkAppliesTo(I[M],"orientation")){var C=this.styleObj.getAttValue(I[M],microstrategy.HTMLATTR_ORIENTATION);if(C!=K){if(L){L.push(H.createActionObject(F[0],mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(A,"orientation",K,true)],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(A,"orientation",C,true)]));}var B=this.styleObj;var G=this;var J=function(R){var P=B.getValue(R,"width");var S=B.getValue(R,"height");var O=B.getValue(R,"widthMode");var Q=B.getValue(R,"heightMode");var N=(O==Q);R.style.width=(N||O==1)?S:"100%";R.style.height=(N||Q==1)?P:"100%";if(!N){G.formatSizeMode([R],"heightMode",O,L,false);G.formatSizeMode([R],"widthMode",Q,L,false);}if(N||O==1){G.formatSize([R],"height",P,L,false);}if(N||Q==1){G.formatSize([R],"width",S,L,false);}if(!N){G.restoreOldTopAndLeft(R,microstrategy["RESTORE_"+(O==1)?"LEFT":"TOP"]);}};for(var E=0;E<F.length;E++){J(F[E]);this.setLineOrientation(F[E],K);F[E].setAttribute(microstrategy.HTMLATTR_ORIENTATION,K,0);}}}}this.updateLayoutWidth(L);}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.setLineOrientation=function(G,B,D){try{var F=this.styleObj;var A=(F.getValue(G,"lineStyle")||"solid")+" "+(F.getValue(G,"lineColor")||"#000000")+" "+parseInt(F.getValue(G,"lineWeight")||1,10)+"pt";var E={};E[microstrategy.ORIENTATION_HORIZONTAL]={0:"Top",1:"Left",2:"height"};E[microstrategy.ORIENTATION_VERTICAL]={0:"Left",1:"Top",2:"width"};var H=E[B];if(H){G.style["border"+H[0]]=A;G.style["border"+H[1]+"Width"]=0;F.setValue(G,H[2],0);}F.setAttValue(G,microstrategy.HTMLATTR_ORIENTATION,B);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatIsLink=function(E,F,I){try{var G=(F)?"-1":"0";for(var J in E){var A=E[J].getAttribute("id");var D=document.getElementsByName(A);if(D&&this.checkAppliesTo(E[J],"isLink")){if(I){I.push(this.parentBone.updateManager.createEditPropsAction(D[0],A,this.parentBone.beanPath,["isLink"],[G],[this.styleObj.getAttValue(E[J],microstrategy.HTMLATTR_IS_LINK)]));}this.styleObj.setAttValue(E[J],microstrategy.HTMLATTR_IS_LINK,G);var H=(F&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE)?"pointer":"default";for(var C=0;C<D.length;C++){D[C].style.cursor=H;}}}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.formatHTMLType=function(F,H,I){try{for(var J in F){var B=F[J].getAttribute("id");var E=document.getElementsByName(B);if(E&&this.checkAppliesTo(F[J],"htmlType")){var A=this.styleObj.getAttValue(F[J],microstrategy.HTMLATTR_HTML_TYPE);if(A!=H){var G=this.getHTMLFieldValues(E[0],decode(this.styleObj.getAttValue(E[0],(H==microstrategy.HTML_CONTAINER_TYPE_HTML)?microstrategy.HTMLATTR_HTML_TEXT:microstrategy.HTMLATTR_HTML_SOURCE),true));for(var D=0;D<E.length;D++){microstrategy.findRWObjectBone(E[D],"mstrHTMLContainerImpl").updateContents(H,G);}}}}this.formatAttribute(F,"htmlType",H,false,microstrategy.HTMLATTR_HTML_TYPE,I);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatLockAspectRatio=function(E,F,H){try{var G=(F)?"-1":"0";for(var I in E){var A=E[I].getAttribute("id");var D=document.getElementsByName(A);if(D.length==0){D=mstr.utils.Arrays.fromHashValues(E);}if(D&&this.checkAppliesTo(E[I],"lockAspectRatio")){var B=this.styleObj.getAttValue(E[I],microstrategy.HTMLATTR_LOCK_ASPECT_RATIO);if(B!=G){if(H){H.push(this.parentBone.updateManager.createEditPropsAction(D[0],A,this.parentBone.beanPath,["lockAspectRatio"],[G],[B]));}this.styleObj.setAttValue(E[I],microstrategy.HTMLATTR_LOCK_ASPECT_RATIO,G);}}}this.updateLayoutWidth(H);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatSubHeightWidth=function(J,C,M,U){try{var F=C.split("|");C=F[0];var S=mstrFormatObject;var Q=this.styleObj;var H=C.toUpperCase();var R=(C=="width")?"Horizontal":"";var B=(R)?"_"+R.toUpperCase():"";var L=[{tp:C,at:microstrategy["HTMLATTR_"+H]},{tp:"max"+H.substr(0,1)+C.substr(1),at:microstrategy["HTMLATTR_MAX_"+H]},{tp:"canGrow"+R,at:microstrategy["HTMLATTR_CAN_GROW"+B]},{tp:"canShrink"+R,at:microstrategy["HTMLATTR_CAN_SHRINK"+B]},{tp:"hideIfEmpty",at:microstrategy["HTMLATTR_HIDE_IF_EMPTY"+B]}];for(var T in J){var K=J[T].getAttribute("id");var G=document.getElementsByName(K);for(var P=0;P<M.length;P++){var A=L[P].tp;if(G&&this.checkAppliesTo(J[T],A)){var W=null;if(P==0){var B=(C=="width")?"_HORIZONTAL":"";W=[Q.getAttValue(J[T],L[P].at),Q.getAttValue(J[T],microstrategy["HTMLATTR_MAX_"+C.toUpperCase()]),Q.getAttValue(J[T],microstrategy["HTMLATTR_CAN_GROW"+B]),Q.getAttValue(J[T],microstrategy["HTMLATTR_CAN_SHRINK"+B]),Q.getAttValue(J[T],microstrategy.HTMLATTR_HIDE_IF_EMPTY)];}if(U){U.push(this.parentBone.updateManager.createEditPropsAction(G[0],K,this.parentBone.beanPath,[A],[S.decodeValue(A,M[P])],[1],false,{origValue:M,cachedOldValue:W,subsectionHeight:true}));}Q.setAttValue(J[T],L[P].at,M[P]);if(P==0&&microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){var I=S.decodeValue(A,M[P]||0);for(var O=0;O<G.length;O++){G[O].style[A]=I;if(C=="height"){G[O].parentNode.firstChild.style[A]=I;}}}if(P==4){var V=microstrategy.findBone(J[T]);V.setNeedToUpdateMaxContentHeight(true);if(C=="height"){if(V.isHorizontal){this.adjustHeightOfHorizontalSubSections(V,true);var E=microstrategy.findBone(microstrategy.findAncestorWithAtt(V.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER));if(E){for(var N=1;N<F.length;N++){if(F[N]=="SubHeight"){E.height=parseInt(S.decodeValue("height",M[0]),10);break;}}E.propogateHeightToChildren();}}else{V.adjustSubsectionHeight(true);}}else{if(C=="width"){V.adjustSubsectionWidth(true);}}}}}}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.formatSize=function(P,E,S,c,D,J,U){try{var Y=mstrFormatObject;var W=this.styleObj;for(var Z in P){var Q=P[Z].getAttribute("id");var L=document.getElementsByName(Q);var I=false;if(L.length==0||(!this.checkAppliesTo(P[Z],E)&&microstratgegy.formatType==microstrategy.FORMAT_TYPE_MAIN)){continue;}var R=microstrategy.subObjectType(P[Z]);var H=mstrStaticDoc.getBone(P[Z]);var M=H&&H.isTable;if(E!=null&&S!=null){if(R==microstrategy.SUBOBJTYPE_DOC_IMAGE){var X=microstrategy.findChildWithAtt(P[Z],"img","id",Q+"_img");if(X!=null){X.style[E]="100%";}}}if(c){var G=W.getValue(P[Z],E);if(G!="auto"&&G!="100%"){G=Math.max(Math.round(parseFloat(G)+microstrategy.getPaddingAndBorderPixels(P[Z],E)),0)+"px";}var V=M?true:false;c.push(this.parentBone.updateManager.createEditPropsAction(L[0],Q,this.parentBone.beanPath,[E],[S],[G],false,{origValue:S,performFormatChange:D,updateLayoutWidth:J,subType:R},V));}W.setAttValue(P[Z],this.heightAndWidthAttMap[E],Y.encodeValue(E,S));I=!this.useModeForStyle(E,P[Z]);var N=S;if(I&&(D!=false)){if(S!="100%"&&S!="auto"){N=Math.max(this.removePaddingAndBorder(L[0],S,E),1)+"px";}for(var T=0;T<L.length;T++){if(microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){E=W.swapForRotation(L[T],E);var e={x:parseInt(W.getValue(L[T],"top")),y:parseInt(W.getValue(L[T],"left"))},K=L[T].direction||this.styleObj.getValue(L[T],"TextDirection")||"0";L[T].style[E]=N;if(K!="0"){W.changeVerticalTextPosition(L[T],e);}if(R==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){var C=mstrStaticDoc.getBone(L[T]);var O=C.ctlStyle;var a=C.ctlOrientation;if(E!="height"||a!="0"||(O!="0"&&O!="4"&&O!="3")){W.cascadeSelectorValue(L[T],E,N);}}if(R==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&/width|height/.test(E)){var B=mstrStaticDoc.getBone(L[T]);if(B&&B.isTable){if(E=="width"){B.resize(null,parseInt(N));}if(E=="height"){B.resize(parseInt(N),null);}}}}if(R==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(L[T]);if(A&&A.isGraph&&!U&&A.adjustGraphSize){A.adjustGraphSize(A.commands.queryState("gridPosition"),A.commands.queryState("gridFactor"),c);}else{if(A&&!A.isGraph){if(E=="width"){A.setGridDimension(A.elem,null,parseInt(N));}if(E=="height"){A.setGridDimension(A.elem,parseInt(N),null);}}}}}}if((R==microstrategy.SUBOBJTYPE_DOC_SHAPE&&P[Z].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)||R==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||this.isDocButton(P[Z])){var H=microstrategy.bone(Q);if(H){H.synchronizeSize(c);}}}if(E=="width"&&(J=="undefined"||J==null||J==true)){this.updateLayoutWidth(c);}}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.formatSizeMode=function(L,C,O,T,B){try{var R=mstrFormatObject;var Q=this.styleObj;var H=C.replace("Mode","").toLowerCase();for(var S in L){var M=L[S].getAttribute("id");var G=document.getElementsByName(M);if(G.length==0||!this.checkAppliesTo(L[S],C)){continue;}var N=microstrategy.subObjectType(L[S]);if(N==microstrategy.SUBOBJTYPE_DOC_SHAPE){var K="100"+C.toUpperCase().substr(0,1)+"MObjects";if(parseInt(O,10)==microstrategy.HUNDRED_PERCENT_MODE){K="addTo"+K;}else{K="removeFrom"+K;}this.parentBone[K](M);}if(O==microstrategy.HUNDRED_PERCENT_MODE||O==microstrategy.AUTO_MODE){if(N==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||N==microstrategy.SUBOBJTYPE_DOC_IMAGE){continue;}if((Q.getAttValue(L[S],microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE)&&(N!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)){continue;}}else{if(O==microstrategy.HUNDRED_PERCENT_MODE&&N==microstrategy.SUBOBJTYPE_DOC_TEXT){continue;}}if(T){T.push(this.parentBone.updateManager.createEditPropsAction(G[0],M,this.parentBone.beanPath,[C],[O],[Q.getAttValue(L[S],this.heightAndWidthAttMap[C])],false,{origValue:O,performFormatChange:B,subType:N}));}var J=parseInt(O);if(!isNaN(J)){Q.setAttValue(L[S],this.heightAndWidthAttMap[C],String(J));}var I;var F=(J==microstrategy.FIX_MODE)||this.useModeForStyle(C,L[S]);switch(J){case microstrategy.FIX_MODE:I=R.decodeValue(H,Q.getAttValue(L[S],this.heightAndWidthAttMap[H]));break;case microstrategy.HUNDRED_PERCENT_MODE:I=(N==microstrategy.SUBOBJTYPE_DOC_SHAPE)?this.calcParentSubHeightWidth(L[S],H):"100%";var U=(C=="heightMode")?"top":"left";Q.setAttValue(L[S],(C=="heightMode")?microstrategy.HTMLATTR_OLD_TOP:microstrategy.HTMLATTR_OLD_LEFT,R.encodeValue(U,parseInt(Q.getValue(L[S],U))));this.formatItems([L[S]],U,"0",false,T);break;case microstrategy.AUTO_MODE:I="auto";break;}if(F&&(B!=false)){if(I!="100%"&&I!="auto"){I=Math.max(this.removePaddingAndBorder(G[0],I,H),1)+"px";}for(var P=0;P<G.length;P++){H=Q.swapForRotation(G[P],H);G[P].style[H]=I;if((C=="widthMode")&&microstrategy.subObjectType(G[P])==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(G[P]);if(A&&A.adjustGridWidth){A.adjustGridWidth(String(J));}}}}if(N==microstrategy.SUBOBJTYPE_DOC_SHAPE&&L[S].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var E=microstrategy.bone(M);if(E){E.synchronizeSize();}}}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.useModeForStyle=function(F,E){try{var B=(F.indexOf("height")>-1)?microstrategy.HTMLATTR_HEIGHT_MODE:microstrategy.HTMLATTR_WIDTH_MODE;var A=microstrategy.subObjectType(E);if(A==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){return false;}if(parseInt(this.styleObj.getAttValue(E,B))!=microstrategy.FIX_MODE){if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){if(A==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var D=microstrategy.findBone(E);return !!(D&&D.isGrid);}return true;}else{if(A==microstrategy.SUBOBJTYPE_DOC_SHAPE||A==microstrategy.SUBOBJTYPE_DOC_LINE){return true;}}}}catch(C){microstrategy.errors.log(C);}return false;};mstrDocImpl.prototype.calcParentSubHeightWidth=function(C,D){try{var A=microstrategy.findAncestorWithAtt(C,"ty",microstrategy.OBJTYPE_DOC_SUBSECTION);if(A!=null){return window["getObj"+D.substr(0,1).toUpperCase()+D.substr(1)](A);}}catch(B){microstrategy.errors.log(B);}return 0;};mstrDocImpl.prototype.formatLineLength=function(E,A,G,I,C){try{var D;for(var J in E){if(this.checkAppliesTo(E[J],A)){var F=(this.styleObj.getAttValue(E[J],microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_HORIZONTAL)?"width":"height";var H=(A.indexOf("Mode")>-1)?"Mode":"";this["formatSize"+H]([E[J]],F+H,G,I,C);}}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.process3DItemSetting=function(E,F,A,D){try{if(D){var B=this.styleObj.getAttValue(E,F);B=(B==null)?0:parseInt(B);D.push(microstrategy.updateManager.createEditPropsAction(E,E.getAttribute("id"),this.parentBone.beanPath,[F],[A],[B]));}this.styleObj.setAttValue(E,F,A);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.process3DItemColorSettings=function(N,L,M,I,O){try{var J=mstrFormatObject;var D=this.styleObj;var C=N.getAttribute("id");var H=document.getElementsByName(C);if(H.length==0){return ;}for(var G=0;G<L.length;G++){var B=L[G]+"Color2";var K=J.getAttrNameFromStyle(B);if(O){O.push(microstrategy.updateManager.createEditPropsAction(N,C,this.parentBone.beanPath,[B],[M[G]],[J.decodeValue(B,D.getAttValue(N,K))]));}for(var F=0;F<H.length;F++){var A=D.swapForRotation(H[F],L[G]);H[F].style[A]=I+"pt solid";H[F].style[A+"Color"]=M[G];D.setAttValue(N,K,J.encodeValue(B,M[G]));}}}catch(E){microstrategy.errors.log(E);}};mstrDocImpl.prototype.format3DItems=function(K,H,E,N){try{var D=this.styleObj;var G=function(T){var S=T.getAttribute("gradientColor");var U=S&&S.split(",");if(U&&U.length==6){var R=(U[5]==0&&U[4]==0)?0:1;return"#"+U[R];}return D.getValue(T,"backgroundColor");};for(var O in K){var P=microstrategy.subObjectType(K[O]);if(!this.checkAppliesTo(K[O],"b3dstyle")){continue;}if((P==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||P==microstrategy.SUBOBJTYPE_DOC_TEMPLATE)&&microstrategy.formatType!=microstrategy.FORMAT_TYPE_MAIN){continue;}var C=true;var J=H;var B=E;if(H==null||H.length==0){J=this.styleObj.getAttValue(K[O],microstrategy.HTMLATTR_BORDER_3D_STYLE);}if(J!=null&&parseInt(J)>0){if(E==null||E.length==0){B=this.styleObj.getAttValue(K[O],microstrategy.HTMLATTR_BORDER_3D_WEIGHT);}B=parseInt(B,10);if(B!=null&&B>0){C=false;var Q=(P==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK)?null:G(K[O]);if(Q==null||Q.length==0||Q.toLowerCase()=="transparent"){Q="#FFFFFF";}Q=mstr.utils.Color.hex2rgb(Q);var L=mstr.utils.Color.get3DBorderColor(Q,"dark");var I=mstr.utils.Color.get3DBorderColor(Q,"light");if(J!="1"){var M=I;I=L;L=M;}this.process3DItemSetting(K[O],"b3dstyle",J,N);this.process3DItemSetting(K[O],"b3dweight",B,N);if(!(P==microstrategy.SUBOBJTYPE_DOC_SHAPE&&K[O].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){this.process3DItemColorSettings(K[O],["borderLeft","borderTop","borderRight","borderBottom"],[I,I,L,L],B,N);this.adjustObjectSize(document.getElementsByName(K[O].getAttribute("id")));}}}if(C){J=this.styleObj.getAttValue(K[O],microstrategy.HTMLATTR_BORDER_3D_STYLE);if((H!=null&&parseInt(H)==0)&&(J!=null&&parseInt(J)>0)){this.turnOffItem3D(K[O],N);}}if(P==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(K[O]);if(A&&A.isGraph&&A.adjustGraphSize){A.adjustGraphSize(A.commands.queryState("gridPosition"),A.commands.queryState("gridFactor"),N);if(N){N.forceSubmit=true;}}}}}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.turnOffItem3D=function(J,K){try{this.process3DItemSetting(J,"b3dstyle","0",K);var A=this.styleObj;var D=mstrFormatObject;var L=microstrategy.subObjectType(J);if(L!=microstrategy.SUBOBJTYPE_DOC_SHAPE){var E={borderLeft:"bl",borderTop:"bt",borderRight:"br",borderBottom:"bb"};for(var G in E){var H=E[G];var I=D.decodeValue(G+"Style",A.getAttValue(J,H+"s")).split(" ");this.formatItemBorders({0:J},[G],I[1],I[0],D.decodeValue(G+"Color",A.getAttValue(J,H+"c")));}}else{if(L==microstrategy.SUBOBJTYPE_DOC_SHAPE&&J.getAttribute(microstrategy.HTMLATTR_STYLE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var C=this;var F=function(N,M){C.formatLineSetting({0:J},N,D.decodeValue(N,A.getAttValue(J,M)));};F("lineColor","lc");F("lineStyle","ls");F("lineWeight","lw");}}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.checkAppliesTo=function(B,C){try{return microstrategy.isEnabledForItem(B,C);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocImpl.prototype.checkBorderProperties=function(G,J,I,B,F){try{if(this.selections.hasNoBorder(G)){return 0;}var H;var C=["Right","Bottom","Left"];var A=J.getValue(G,I+"Top"+B);for(H=0;H<3;H++){if(A!=J.getValue(G,I+C[H]+B)){return 2;}}var K=parseFloat(A,10);if(isNaN(K)||K==0){return 0;}var D=J.getValue(G,I+"Top"+F);for(H=0;H<3;H++){if(D!=J.getValue(G,I+C[H]+F)){return 2;}}return 1;}catch(E){microstrategy.errors.log(E);return 0;}};mstrDocImpl.prototype.resolveDeltaPropertyValue=function(B,A){return(A in B)?B[A]:this.commands.queryState(A);};mstrDocImpl.prototype.processDocBorderChanges=function(B,M){try{if(!B){return ;}var F=mstrFormatObject;var K=["Top","Right","Bottom","Left"];var O,I,L,A,H,D;var N=this.resolveDeltaPropertyValue(B,"LayoutBorderStyle");switch(parseInt(N)){case 0:this.elem.style.borderWidth=0;var E=this;var J=function(P){P+="Style";E.saveDocProperty("border"+P,F.decodeValue("border"+P,0),M);E.parentBone["Layout"+P]=0;};for(D=0;D<4;D++){J(K[D]);}break;case 1:O=this.resolveDeltaPropertyValue(B,"LayoutAllStyle");I=this.resolveDeltaPropertyValue(B,"LayoutAllColor");L=F.decodeValue("borderTopStyle",O);this.elem.style.border=L+" "+I;for(D=0;D<4;D++){this.saveDocProperty("border"+K[D]+"Style",L,M);this.saveDocProperty("border"+K[D]+"Color",I,M);this.parentBone["Layout"+K[D]+"Style"]=O;this.parentBone["Layout"+K[D]+"Color"]=I;}break;case 2:for(D=0;D<4;D++){O=B["Layout"+K[D]+"Style"];if(!isNaN(O)){A="border"+K[D]+"Style";L=F.decodeValue("borderTopStyle",O);var G=L.split(" ");this.elem.style["border"+K[D]+"Width"]=G[0];this.elem.style[A]=G[1];this.saveDocProperty(A,L,M);this.parentBone["Layout"+K[D]+"Style"]=O;}I=B["Layout"+K[D]+"Color"];if(I){A="border"+K[D]+"Color";this.elem.style[A]=I;this.saveDocProperty(A,I,M);this.parentBone["Layout"+K[D]+"Color"]=I;}}break;}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.processIncrFetchChanges=function(D){try{var A=this.parentBone.ifSettings;var B=["2048166"];var E=(A.enabled)?[microstrategy.TRUE]:[microstrategy.FALSE];if(A.curLevel){B.push("2048167");E.push(A.curLevel);}if(A.blockCount){B.push("2048168");E.push(A.blockCount);}D.push(this.parentBone.updateManager.createActionObject(null,mstrUpdateManager.RW_IF_SETTINGS,this.parentBone.beanPath,B,E));}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.processDocViewModeChanges=function(E,M){try{if(!E){return false;}var G,D,H,L=0;var J=this.parentBone.updateManager,K=this;var C=function(N){var P=0,O=K.resolveDeltaPropertyValue(E,N);if(typeof (O)=="string"){O=O.split(CLIPBOARD_ITEM_SEPARATOR);}for(G=0;G<O.length;G++){D=parseInt(O[G],10);if(!isNaN(D)){P+=D;}}return P;};H=C("AvailableViewModes");H+=C("AvailableExportModes");var B=mstr.Enum.VIEWMEDIA;var A=B.STATIC+B.INTERACTIVE+B.EDITABLE+B.FLASH+B.EXPORT_EXCEL+B.EXPORT_PDF+B.EXPORT_HTML+B.EXPORT_FLASH;L=A-H;this.parentBone.AvailableViewModes=H;var I=this.resolveDeltaPropertyValue(E,"DefaultViewMode");M.push(J.createActionObject(null,mstrUpdateManager.SET_VIEW_MEDIA,this.parentBone.beanPath,["2048163","2048290","2048291"],[I,H,L],[]));return true;}catch(F){microstrategy.errors.log(F);return false;}};mstrDocImpl.prototype.processDocPropertyChanges=function(F){try{var W=[];var Q=this.parentBone.updateManager;var P=false;var K=false;var E=null;var Z=null;var J=this.parentBone.ifSettings;var X=false;var N={};for(var V=0,U=F.length;V<U;V++){var I=F[V].cmdId;var S=F[V].value;var A=null;var T;var M=(this.docPropsMap[I]&&this.docPropsMap[I].f)||I;var L=(this.docPropsMap[I]&&this.docPropsMap[I].l)||I;switch(I){case"TabName":var c=F[V].id;this.saveDocProperty(M,S,W,c);if(c==this.parentBone.currentLayout){this.parentBone[L]=S;}break;case"DefaultGridStyle":case"CalculateDocWidth":case"TOCTitle":case"TOCFontName":case"TOCFontSize":case"WatermarkType":case"WatermarkText":case"TextOrientation":case"ImageSource":case"ImageScale":case"WatermarkFontName":case"WatermarkFontSize":case"EmbeddedFonts":case"MobileDataView":case"PreLoadAllPanels":case"SupportedOrientations":case"layoutBarPosition":case"ExcelExportDocumentURL":case"PDFExportDocumentURL":case"TOCTitleAlignment":case"TOCTitleFontName":case"TOCTitleFontSize":case"TOCLeftIndent":case"TOCRightIndent":case"TOCBorderStyle":case"TOCBorderWeight":case"RemoveMissingUnits":case"SingleSourceGrid":case"DocumentThemeColor":case"SmartClientDoc":case"RWLevelMCEJoin":this.saveDocProperty(M,S,W);this.parentBone[L]=S;break;case"layoutBarStyle":this.saveDocProperty(M,S,W);this.parentBone[L]=S;if(S=="0"){this.saveDocProperty("layoutBarPosition",1,W);this.parentBone.layoutBarPosition=1;}break;case"BeforeLayout":this.saveDocProperty(M,parseInt(S)+1,W);this.parentBone[L]=S;break;case"Autowire":N[I]={value:S,fn:M,lp:L};break;case"FitPDFContentHeight":case"DisplayPageByBar":case"DisplayRePromptIcon":case"UseAsInfoWindow":case"ExecutionFullScreenMode":case"PreserveTranslations":case"ShowingBarsTemporarily":case"ShowFloatingToolbars":case"CtlAutoSubmit":case"tabMPHF":case"EnableToc":case"TOCFontStrikeout":case"TOCFontUnderline":case"TabLeader":case"AutoFontSize":case"TextWashout":case"WatermarkFontStrikeout":case"WatermarkFontUnderline":case"RemoveNullGroups":case"TrimNoSectionData":case"ShowTabsForSingleLayout":case"IncludePageHeaderFooter":case"EnableExport":case"EnableSwipingToSwitchLayout":case"TOCTitleFontUnderline":case"TOCTitleFontStrikeout":case"KeepControlTargetsConsistent":this.saveDocProperty(M,(S)?microstrategy.TRUE:microstrategy.FALSE,W);this.parentBone[L]=S;break;case"OfflineOnCube":if(!!this.parentBone.ShowOfflineUCOnCubeConfig){this.saveDocProperty(M,(S)?microstrategy.TRUE:microstrategy.FALSE,W);this.parentBone[L]=S;}break;case"TOCTitleEnableInherit":this.saveDocProperty(M,(S)?microstrategy.FALSE:microstrategy.TRUE,W);this.parentBone[L]=S;break;case"ViewModeInteractivityLevel":this.saveDocProperty(M,(S)?2:1,W);this.parentBone[L]=S;break;case"DefaultSelectorsAsFilter":N[I]={value:S,fn:M,lp:L};break;case"LayoutFillColor":A=(S=="transparent")?"#ffffff":S;this.saveDocProperty(M,A,W);this.parentBone[L]=S;this.saveDocProperty("backgroundStyle",S,W);break;case"LayoutBorderStyle":case"LayoutAllStyle":case"LayoutAllColor":case"LayoutLeftStyle":case"LayoutLeftColor":case"LayoutTopStyle":case"LayoutTopColor":case"LayoutRightStyle":case"LayoutRightColor":case"LayoutBottomStyle":case"LayoutBottomColor":E=E||{};E[I]=S;break;case"AvailableViewModes":case"AvailableExportModes":case"DefaultViewMode":Z=Z||{};Z[I]=S;break;case"VisibleSections":case"DockedSections":var D=(I=="VisibleSections")?"visibility":"docked",B=(I=="VisibleSections")?"v":"dc";S=CLIPBOARD_ITEM_SEPARATOR+S+CLIPBOARD_ITEM_SEPARATOR;var a=this.commands.queryState("sectionsList");for(T=0;T<a.length;T++){var O=(S.indexOf(CLIPBOARD_ITEM_SEPARATOR+a[T].dssid+CLIPBOARD_ITEM_SEPARATOR)>-1)?microstrategy.TRUE:microstrategy.FALSE;var Y=mstrUpdateManager.createPropertyEditString(a[T].dssid,D,O,true);if(a[T].v!=(O==microstrategy.TRUE)){this.parentBone.sectionsList[T][B]=(O==microstrategy.TRUE);}W.push(Q.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,Y],[]));}break;case"ShowConditionalFormatting":W.push(Q.createActionObject(this.elem,mstrUpdateManager.TOGGLE_DOC_THRESHOLDS,[],[],[],[]));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){P=true;}break;case"TOCFontBoldItalic":this.parentBone.TOCFontBold=(S&1);this.saveDocProperty("TOCFontBold",(S&1)?microstrategy.TRUE:microstrategy.FALSE,W);this.parentBone.TOCFontItalic=(S&2);this.saveDocProperty("TOCFontItalic",(S&2)?microstrategy.TRUE:microstrategy.FALSE,W);break;case"TOCTitleFontBoldItalic":this.parentBone.TOCTitleFontBold=(S&1);this.saveDocProperty("TOCTitleFontBold",(S&1)?microstrategy.TRUE:microstrategy.FALSE,W);this.parentBone.TOCTitleFontItalic=(S&2);this.saveDocProperty("TOCTitleFontItalic",(S&2)?microstrategy.TRUE:microstrategy.FALSE,W);break;case"WatermarkFontBoldItalic":this.parentBone.WatermarkFontBold=(S&1);this.saveDocProperty("WatermarkFontBold",(S&1)?microstrategy.TRUE:microstrategy.FALSE,W);this.parentBone.WatermarkFontItalic=(S&2);this.saveDocProperty("WatermarkFontItalic",(S&2)?microstrategy.TRUE:microstrategy.FALSE,W);break;case"TOCFillColor":case"TOCTitleFillColor":A=(S=="transparent")?"#ffffff":S;this.saveDocProperty(M,microstrategy.getFormatObject().encodeValue("color",A),W);this.parentBone[L]=S;break;case"TOCFontColor":case"TOCTitleFontColor":case"TOCBorderColor":case"WatermarkFontColor":this.saveDocProperty(I,microstrategy.getFormatObject().encodeValue("color",S),W);this.parentBone[I]=S;break;case"incrFetchEnabled":case"incrFetchBlockCount":case"incrFetchCurLevel":X=true;J[L]=S;break;case"ApplyGBToAllLayouts":var R=S?2:1;this.saveDocProperty(M,R,W);this.parentBone[L]=R;break;}switch(I){case"TOCFillColor":if(S=="transparent"){this.saveDocProperty("TOCFillStyle","1",W);}else{this.saveDocProperty("TOCFillStyle","0",W);}break;case"TOCTitleFillColor":if(S=="transparent"){this.saveDocProperty("TOCTitleFillStyle","1",W);}else{this.saveDocProperty("TOCTitleFillStyle","0",W);}break;case"LayoutFillColor":this.elem.style.backgroundColor=S;break;case"TabName":case"tabMPHF":case"VisibleSections":case"ShowConditionalFormatting":case"CalculateDocWidth":P=true;break;case"RemoveNullGroups":case"TrimNoSectionData":case"RemoveMissingUnits":case"KeepControlTargetsConsistent":P=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);break;case"SingleSourceGrid":if(S==="0"){this.parentBone.features[microstrategy.FEATURE_SINGLE_SOURCE_GRID]=this.parentBone.isFeatureAvailable(microstrategy.FEATURE_SINGLE_SOURCE_GRID_PROJECT);}else{this.parentBone.features[microstrategy.FEATURE_SINGLE_SOURCE_GRID]=S==="1"?true:false;}P=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);break;case"RWLevelMCEJoin":if(S==="-1"){this.parentBone.features[microstrategy.FEATURE_RW_LEVEL_MCE_JOIN]=this.parentBone.features[microstrategy.FEATURE_PROJECT_LEVEL_MCE_JOIN];}else{this.parentBone.features[microstrategy.FEATURE_RW_LEVEL_MCE_JOIN]=S;}P=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);break;case"ShowTabsForSingleLayout":P=true;K=true;break;}}this.processDelayedActions(N,W);this.processDocBorderChanges(E,W);if(this.processDocViewModeChanges(Z,W)){P=true;}if(X){this.processIncrFetchChanges(W);P=true;}var H=this.processStaticDocPropertyChanges(F,W);if(W.length>0){Q.add(W,true);if(P||H){Q.flushAndSubmitChanges();}}if(K){var C=mstr.$obj("RWDocPropertiesEditorModel1");if(C){C.execReinitializeModel();}}}catch(G){microstrategy.errors.log(G);}};mstrDocImpl.prototype.processDelayedActions=function(G,L){var D=["DefaultSelectorsAsFilter","Autowire"];for(var I in D){var C=D[I];if(C in G){var B=G[C];var J=B.value;var H=B.fn;var F=B.lp;switch(C){case"Autowire":this.saveDocProperty(H,(J)?microstrategy.TRUE:microstrategy.FALSE,L);this.parentBone[F]=J;if(J){for(var K in this.sections){var A=this.sections[K];for(var E in A.subsections){A.subsections[E].recursiveWiring(L,this.parentBone.beanPath);}}}break;case"DefaultSelectorsAsFilter":this.saveDocProperty(H,(J)?"1":"0",L);this.parentBone[F]=J;break;}}}};mstrDocImpl.prototype.processRWDocProperty=function(H,G){try{var E=[];var A=this.parentBone.updateManager;var F=mstrUpdateManager.createPropertyEditString(null,H,G);var D=this;var B=function(I){E.push(A.createActionObject(null,I,D.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,F],[]));};B(mstrUpdateManager.SAVE_DOC_PROPERIES);B(mstrUpdateManager.APPLY_CHANGES);A.add(E);A.flushAndSubmitChanges();}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.saveDocProperty=function(B,H,I,D){try{var F=(!I);if(F){I=[];}var E=this.parentBone.updateManager;var A=this.parentBone.beanPath;switch(B){case"backgroundColor":case"borderTopColor":case"borderTopStyle":case"borderRightColor":case"borderRightStyle":case"borderBottomColor":case"borderBottomStyle":case"borderLeftColor":case"borderLeftStyle":case"name":case"TabMPHF":case"TabColor":case"SupportedOrientations":case"Autowire":case"FitPDFContentHeight":case"DisplayPageByBar":case"DisplayRePromptIcon":case"UseAsInfoWindow":case"IPhoneVisualization":case"APhoneVisualization":case"ATabletVisualization":case"WidgetProps":if(this.parentBone.currentLayout){I.push(E.createEditPropsAction(null,this.parentBone.currentLayout,A,[B],[H],null,true));}else{I.push(E.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,A,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,mstrUpdateManager.createPropertyEditString(null,B,H)],[]));}break;case"FilterDetailsFormat":var G=H.split(UNIT_SEPARATOR);if(G.length!=2){break;}if(G[0]){I.push(E.createEditPropsAction(null,G[0],A,[B],[G[1]],null,true));}break;default:mstrStaticDoc.prototype.saveDocProperty.apply(this,[B,H,I,D]);}if(F){E.add(I,(B=="width"||B=="UsePageWidthAsLayoutWidth"));}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.openDialog=function(F,A,D,C,E){try{C=C||this.parentBone.beanPath+".rwd";microstrategy.openDialog(F,A,D,C,E);}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.showPageBreaker=function(C){try{if(this.pgBreakers){for(var E in this.pgBreakers){this.elem.removeChild(this.pgBreakers[E]);}this.pgBreakers=null;}if(C){this.pgBreakers={};var G=parseInt(this.getPageWidth());var B=Math.ceil(getObjWidth(this.elem)/G);if(!this.docbgDiv){this.docbgDiv=document.getElementById("docbg");}this.docbgDiv.style.left=((B-1)*G)+"px";this.docbgDiv.style.width=G+"px";var A=getObjHeight(this.elem);var D=document.createElement("div");D.style.position="absolute";D.style.borderLeft="1pt dashed gray";D.style.height=getObjHeight(this.elem)+"px";D.style.zIndex="30";D.style.top=getObjTop(this.elem);for(var E=1;E<B;E++){D.setAttribute("id",E);D.style.left=(E*G)+"px";this.pgBreakers[E]=this.elem.appendChild(D.cloneNode(true));}}}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.updatePageBreaker=function(){try{var A=getObjHeight(this.elem);var B=parseInt(this.getPageWidth());if(this.pgBreakers){for(var C in this.pgBreakers){this.pgBreakers[C].style.height=A+"px";this.pgBreakers[C].style.left=C*B+"px";}}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.updateHRulerWidth=function(A){try{var D=(typeof A!="undefined"&&A!=null)?parseInt(A,10):12;var C=this.parentBone.rulers.rwb_viewer;if(C){C.style.width=parseInt(this.parentBone.docRszHandler.style.left)+"px";C.style.paddingRight=D+"pt";}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.updateLayoutWidth=function(C,D){try{var B=this.getRightMostPos();if(this.minWidth!=null&&(this.minWidth<B&&B>getObjWidth(this.elem)||D)){this.minWidth=B;this.elem.style.width=this.minWidth+"px";this.saveDocProperty("width",this.minWidth,C);if(this.parentBone.usePageWidthAsLayoutWidth!=0){this.parentBone.usePageWidthAsLayoutWidth=0;this.saveDocProperty("UsePageWidthAsLayoutWidth",this.parentBone.usePageWidthAsLayoutWidth,C);}if(this.parentBone.rulerTicker){this.parentBone.rulerTicker.style.left=(this.minWidth-parseInt(getObjWidth(this.parentBone.rulerTicker)/2))+"px";}if(this.parentBone.docRszHandler){this.parentBone.docRszHandler.style.left=this.minWidth+"px";}this.updateHRulerWidth();if(this.parentBone.viewer100wm!=null){this.parentBone.resize100WMObjects();}this.displayPageBreaker();}else{this.minWidth=B;}}catch(A){microstrategy.errors.log(A);}};mstrDocImpl.prototype.getName=function(C,A){try{var E=A.substr(A.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length);var B=function(F){return microstrategy.descriptors.getDescriptor(F)+E;};switch(C){case microstrategy.SUBOBJTYPE_DOC_TEXT:return B("1013");case microstrategy.SUBOBJTYPE_DOC_IMAGE:return B("2922");case microstrategy.SUBOBJTYPE_DOC_LINE:return B("2059");case microstrategy.SUBOBJTYPE_DOC_SHAPE:return B("3196");case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:return B("3313");case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:return B("4727");case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:return B("4728");case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:return B("3957");default:return"Unknown";}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.getDefaultNameOfObject=function(C){var D=C.getAttribute("id"),A=microstrategy.subObjectType(C);var B=function(E){return microstrategy.descriptors.getDescriptor(E)+D.substr(D.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length);};if(this.isDocButton(C)){return B("6457");}return this.getName(A,D);};mstrDocImpl.prototype.openAddImagePropertiesEditor=function(){try{this.setStubImage(this.selections.firstItem());microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",{lockedTab:2});}catch(A){microstrategy.errors.log(A);}};mstrDocImpl.prototype.startControlSelectionMode=function(){try{var A=null;if(this.selections.getFirstObjType()==microstrategy.OBJTYPE_DOC_OBJECT&&this.selections.getFirstObjSubType()==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.standAloneControlKey=this.selections.firstItem().id;}else{var F=null;var J=microstrategy.getActiveCXBone();A=J&&J.getGraphBone&&J.getGraphBone();if(A){F=A.objId;}else{if(this.selections.isGridSelected()){F=this.selections.getSelectedGrid().getAttribute("id");}}if(F){var C=microstrategy.activeCXMenu;this.controlSourceUnitType=C.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);this.controlSource=F;if(this.controlSourceUnitType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){this.controlSourceUnitType=microstrategy.DSSTYPE_ATTRIBUTE;this.controlSourceUnitID=microstrategy.getActiveCXBone().getUnitInfo(C).parentDssId;}else{this.controlSourceUnitID=C.getAttribute(microstrategy.HTMLATTR_DSS_ID);}if(this.controlSourceUnitID==null){this.controlSourceUnitID="";}}else{return ;}}this.controlSelectionMode=true;this.selections.clear();var D="";if(this.standAloneControlKey){D=microstrategy.bone(this.standAloneControlKey+"_Ctl").targetKeys;}else{var I=A||microstrategy.getActiveCXBone();var H=this.controlSourceUnitID;if(H==null||H==""){this.controlSourceUnitID="";H="Metrics";}if(I.controlLinks&&I.controlLinks[H]){D=I.controlLinks[H].targets;}}if(D){for(var E in D){var G=document.getElementById(D[E]);if(G){this.selections.addToSelection(true,G);}}}showMessage({contents:"Control Selection Mode",elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.parentBone.id+"').doc.submitControlTargetSelections();",cancelEval:"microstrategy.bone('"+this.parentBone.id+"').doc.endControlSelectionMode();",type:mstrMsgBoxImpl.MSG_WARNING,messageBoxID:"controlTargetsRecorder"});}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.endControlSelectionMode=function(){try{this.standAloneControlKey=null;this.controlSourceUnitID=null;this.controlSourceUnitType="";this.controlSelectionMode=false;this.controlSource=null;this.selections.clear();}catch(A){microstrategy.errors.log(A);}};function mstrDocImpl(A){this.inherits=mstrStaticDoc;this.inherits(A);this.inherits=null;return this;}mstrDocImpl.shallRenderTarget=function(C){try{var E=document.getElementById(C);if(!E){return false;}var A=microstrategy.findBone(E.parentNode);while(A&&A.elem.getAttribute("scriptclass")=="mstrPanel"){var B=A.parentBone;if(B.getCurrentPanel()!=A){B.addDirtyKey(A,C);return false;}A=microstrategy.findBone(B.elem.parentNode);}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocImpl.prototype.promptDeleteItems=function(G,A,F,E,H){if(this.parentBone.docViewsSize>1){var C=this.parentBone.defaultDeleteMode;if(!C){var D="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('msgPref'), checked = p && p.checked; ";var B=D+"rwb.deleteItems(rwb.selections.items, true);if(checked)rwb.updateDeleteMode(true);";var I=D+"rwb.formatAttribute(rwb.selections.items,'visibility','0',true,microstrategy.HTMLATTR_VISIBLE,null,false);if(checked)rwb.updateDeleteMode(false);";showMessage({contents:microstrategy.descriptors.getDescriptor("8563"),elements:microstrategy.OK_BUTTON+microstrategy.APPLY_BUTTON,okEval:I,buttonLabels:{Apply:microstrategy.descriptors.getDescriptor("219"),Ok:microstrategy.descriptors.getDescriptor("218")},applyEval:B,type:mstrMsgBoxImpl.MSG_PREF_WARNING});}else{var J=mstrDocImpl.DELETE_MODE;if(C==J.DELETE){this.deleteItems(this.selections.items,true);}else{if(C==J.HIDE){this.formatAttribute(this.selections.items,"visibility","0",true,microstrategy.HTMLATTR_VISIBLE,null,false);}}}}else{this.deleteItems(this.selections.items,true);}};mstrDocImpl.prototype.updateInsertMode=function(D){var C=this.parentBone,B=C.updateManager,A=mstrDocImpl.INSERT_MODE;C.defaultInsertMode=D?A.ALL_VISIBLE:A.HIDE_OTHERS;B.add([B.createActionObject(null,mstrUpdateManager.SET_DEFAULT_INSERT_MODE,C.beanPath,["55005"],[C.defaultInsertMode],[])]);};mstrDocImpl.prototype.updateDeleteMode=function(D){var C=this.parentBone,B=C.updateManager,A=mstrDocImpl.DELETE_MODE;C.defaultDeleteMode=D?A.DELETE:A.HIDE;B.add([B.createActionObject(null,mstrUpdateManager.SET_DEFAULT_DELETE_MODE,C.beanPath,["55006"],[C.defaultDeleteMode],[])]);};mstrDocImpl.prototype.isDocButton=function(A){return this.isDocButtonType(microstrategy.subObjectType(A),microstrategy.styleObj.getAttValue(A,microstrategy.HTMLATTR_DISPLAY_STYLE));};mstrDocImpl.prototype.isDocButtonType=function(B,A){return B==microstrategy.SUBOBJTYPE_DOC_TEXT&&A>0;};mstrDocImpl.prototype.updateSingleTextField=function(A,B){if(this.isDocButton(A)){mstrButton.updateButtonCaption(A,B);}else{A.innerHTML=B;}};mstrDocImpl.prototype.isNavigationBar=function(A){return microstrategy.subObjectType(A)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&microstrategy.styleObj.getAttValue(A,microstrategy.HTMLATTR_USE_AS_NAVIGATION_BAR)==microstrategy.TRUE;};mstrDocImpl.prototype.findNavigationBar=function(A){if(!A){return null;}var B=microstrategy.findAncestorWithAtt(A,"scriptclass","mstrNavigationBar");if(!B){return null;}return mstr.$obj(B.id);};mstrPageByImplScript=true;mstrPageByImpl.prototype=new mstrStaticPageBy();mstrPageByImpl.prototype.type=microstrategy.OBJTYPE_PAGE_BY;mstrPageByImpl.prototype.updateManager=microstrategy.updateManager;mstrPageByImpl.prototype.activeElement=null;mstrPageByImpl.prototype.mapper=null;mstrPageByImpl.prototype.selections=null;mstrPageByImpl.prototype.dndHelper=null;mstrPageByImpl.prototype.onload=function(){try{this.initEditor();if(!(this.body)){microstrategy.unRegisterBone(this.id);return ;}var E=document.getElementById("pagebyApply");this.autoSubmit=(E)?false:true;var D=this.body.getElementsByTagName("SELECT");if(D){for(var C=0;C<D.length;C++){D[C].onchange=new Function("e","return microstrategy.bone('"+this.id+"').onpagechange(e);");}}this.units=microstrategy.objectListFind(this.elem,"SPAN",microstrategy.OBJTYPE_PAGE_BY_ELEM);this.body.onmousedown=new Function("e","return microstrategy.bone('"+this.id+"').onmousedown(e);");if(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){if(this.isEditableViewModeEplus()){this.initMapper();this.dndHelper=new mstrDNDHelperImpl(this);}}if(mstr.utils.ISIE7){var A=document.getElementById("pbb_GroupByStyle"),B=document.getElementById("mstrWebContentTable");if(B&&A&&A.currentStyle.display!="none"){B.style.width="100%";}}}catch(F){microstrategy.errors.log(F);return false;}};mstrPageByImpl.prototype.initMapper=function(){try{this.selections=new mstrSelectionsImpl();this.selections.parentBone=this;this.mapper=new mstrPageByMapperImpl();this.maskFor=microstrategy.DSSTYPE_ATTRIBUTE;this.maskArea=this.elem.getElementsByTagName("div")[0];if(this.units&&this.units.length>0){this.mask=new mstrMaskMappedImpl();}else{this.mask=new mstrMaskImpl();}this.mask.onload(this);var A=document.createElement("img");A.src=microstrategy.FOLDER_IMAGES+"dragRectangle.gif";A.className="mstrDnDRWDragItem";this.dragDisplay=document.body.appendChild(A);}catch(B){microstrategy.errors.log(B);return false;}};mstrPageByImpl.prototype.onnotifydrag=function(G,J,E){try{if(!this.isEditableViewModeEplus()){return ;}if(J!=this&&J.type!=microstrategy.OBJTYPE_OBJBROWSER){return ;}E.sort(function(O,N){return parseInt(O)-parseInt(N);});if(E[0]!=E[E.length-1]){return ;}if(J.type==microstrategy.OBJTYPE_OBJBROWSER){var F=this.units;var A=F.length;var M=true;for(var K in G){var I=new mstrObjectInfoImpl(G[K]);var B=microstrategy.primeDataSetId!=null&&microstrategy.primeDataSetId!=-1;if(B&&I.dSetId!=microstrategy.primeDataSetId&&(microstrategy.sortDefinedOnDefault||A>0)){return false;}var L=false;for(var D=0;D<A;D++){if(I.dssId==F[D].getAttribute(microstrategy.HTMLATTR_DSS_ID)){L=true;break;}}M&=L;}if(M){return false;}}var H=E[0];if(H==microstrategy.DSSTYPE_CONSOLIDATION||H==microstrategy.DSSTYPE_FILTER){H=microstrategy.DSSTYPE_ATTRIBUTE;}this.mask.toggle(true,H);}catch(C){microstrategy.errors.log(C);return false;}};mstrPageByImpl.prototype.onmousedown=function(E){try{if(!E){E=window.event;}if(!this.isEditableViewModeEplus()){E.cancelBubble=true;return ;}if(E.button==2){return false;}else{var F=getEventTarget(E);if(F&&F.tagName.toLowerCase()!="select"&&F.tagName.toLowerCase()!="option"){var C=microstrategy.findAncestor(F);if(C&&C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_PAGE_BY_ELEM){var A=F.getAttribute(microstrategy.HTMLATTR_CMD_ID);var D=F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(A){this.exec(A,D,C);}else{if(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){this.activeElement=C;if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondragstart");this.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e","return microstrategy.bone('"+this.id+"').ondragstart(e);");document.onmouseup=new Function("e","return microstrategy.bone('"+this.id+"').onmouseup(e);");}}}return false;}}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrPageByImpl.prototype.exec=function(A,E,C){try{if(!C){C=this.activeElement;}if(C){var D=C.getAttribute("id").slice(3);switch(A){case"sort":this.handleSortRequest(D,E);break;case"attrForms":this.handleAttrForms(D,E);break;case"move":this.handlePivotRequest(D,E);break;case"rmv":this.handleRemoveRequest(D);break;case"editor":this.handleEditorProperties(D);break;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrPageByImpl.prototype.processContextMenus=function(A,C){try{this.exec(A,C,microstrategy.activeCXMenu);}catch(B){microstrategy.errors.log(B);return false;}};mstrPageByImpl.prototype.ondragstart=function(B){try{if(!B){B=window.event;}if(B.e){B=B.e;}getMouse(B);microstrategy.eventManager.onnotifydrag(microstrategy.createAssociativeArray(this.activeElement),this,[this.activeElement.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)]);this.selections.clear();this.selections.add(this.activeElement);if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondrag");this.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e","return microstrategy.bone('"+this.id+"').ondrag(e);");document.onmouseup=new Function("e","return microstrategy.bone('"+this.id+"').ondragend(e);");}this.ondrag(B);}catch(A){microstrategy.errors.log(A);}return false;};mstrPageByImpl.prototype.ondrag=function(B){try{if(!B){B=window.event;}if(B.e){B=B.e;}getMouse(B);moveObjTo(this.dragDisplay,lMouseX+20,lMouseY+20);}catch(A){microstrategy.errors.log(A);}return false;};mstrPageByImpl.prototype.ondragend=function(F){try{if(!F){F=window.event;}if(F.e){F=F.e;}this.dndHelper.parkObject(this.dragDisplay);var E=this.activeElement;this.onmouseup(F);microstrategy.eventManager.notifyOrphanBones("onnotifydragend");var A=microstrategy.findAncestor(getEventTarget(F));if(A){var D=microstrategy.boneForMask(A);var B=this.updateManager;if(D){if(D==this){if(A.getAttribute(microstrategy.HTMLATTR_POINTS_TO)==D.id){B.add([B.createActionObject(E,mstrUpdateManager.MOVE_PAGEBY,this.beanPath,["20001"],[E.getAttribute("id").slice(3)],[])]);B.flushAndSubmitChanges();}else{if(A.getAttribute(microstrategy.HTMLATTR_POINTS_TO)!=E.id){B.add([B.createActionObject(E,mstrUpdateManager.MOVE_PAGEBY,this.beanPath,["20001","20002"],[E.getAttribute("id").slice(3),A.getAttribute(microstrategy.HTMLATTR_POINTS_TO).slice(3)],[])]);B.flushAndSubmitChanges();}}}else{if(D&&D.elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_OBJBROWSER){this.handleRemoveRequest(E.getAttribute("id").slice(3));}}}}}catch(C){microstrategy.errors.log(C);}return false;};mstrPageByImpl.prototype.onmouseup=function(B){try{this.activeElement=null;if(typeof (mstr)!="undefined"){this.detachWinListener(this,"mousemove");this.detachWinListener(this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(A){microstrategy.errors.log(A);}return false;};mstrPageByImpl.prototype.ondrop=function(A,B){try{var I=B.getItems();var L=false;var G=this.updateManager;var M=new Array();var H=(A.getAttribute(microstrategy.HTMLATTR_POINTS_TO)!=null)?document.getElementById(A.getAttribute(microstrategy.HTMLATTR_POINTS_TO)):this.elem;var K=H.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var E=(K==microstrategy.OBJTYPE_PAGE_BY_ELEM)?H.getAttribute("id").slice(3):null;var D=new Array("20007","20008","20012","20013");if(E){D[D.length]="20002";}for(var F=0;F<I.length;F++){if(this.getUnit(I[F])==null){var J=new mstrObjectInfoImpl(I[F]);if(microstrategy.isValidGroupByType(J.dssType)){var N=new Array(J.dssId,J.dssType,J.dssSubType,B.getDataSetId());if(E){N[N.length]=E;}M.push(G.createActionObject(I[F],mstrUpdateManager.ADD_PAGEBY,this.beanPath,D,N,[]));L=true;}}}if(L){G.add(M);G.flushAndSubmitChanges();}}catch(C){microstrategy.errors.log(C);return false;}};mstrPageByImpl.prototype.onpagechange=function(C){try{if(!C){C=window.event;}if(this.autoSubmit){var E=getEventTarget(C);if(E){var D=E.options[E.selectedIndex].value;var B=250;D=D.replace(/\\/g,"\\\\");D=D.replace(/'/g,"\\'");D=D.replace(/"/g,'\\"');window.setTimeout("microstrategy.bone('"+this.id+"').handlePageByRequest('"+D+"')",B);}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrPageByImpl.prototype.handleSortRequest=function(D,B){try{var A=this.updateManager;if(A){A.add([A.createActionObject(null,mstrUpdateManager.SORT_PAGEBY,this.beanPath,["20001","20011"],[D,B],[])]);A.flushAndSubmitChanges();}}catch(C){microstrategy.errors.log(C);return false;}};mstrPageByImpl.prototype.handleAttrForms=function(G,E){try{var F=this.updateManager;if(F){if(E==1){F.add([F.createActionObject(null,mstrUpdateManager.DISPLAYTYPE_PAGEBY,this.beanPath,["20001","20014"],[G,E],[])]);F.flushAndSubmitChanges();}else{var I=microstrategy.activeCXMenu||this.activeElement,D=I&&I.getAttribute("oid");if(!D){return ;}microstrategy.availAttrForms||(microstrategy.availAttrForms={});if(microstrategy.attrBone){this.attrBone=microstrategy.attrBone;}else{this.attrBone=microstrategy.attrBone=new mstr.bones.editors.BoneTranslator();}if(microstrategy.availAttrForms[G]==null){var H=this;var A={success:function(L){var J=[];for(var K in L.objects){var M=L.objects[K];J.push({dssid:M.did+"|"+M.t+"|"+M.n,n:M.n});}microstrategy.availAttrForms[G]=J;H.updateCartModel();microstrategy.openBlockLoaderEditor("CustomAttrForms","CustomAttrFormsBlock",{},{},H,null,null);},failure:function(J){showMessage({contents:J.getResponseHeader("X-MSTR-TaskFailureMsg"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}},C={taskId:"getWSAttributeForms",attributeID:D,objectType:55,msgID:mstr.$obj("rwb_viewer").messageID};mstr.$XHR.request(mstrConfig.taskURL,C,A);}else{this.updateCartModel();microstrategy.openBlockLoaderEditor("CustomAttrForms","CustomAttrFormsBlock",{},{},this,null,null);}}}}catch(B){microstrategy.errors.log(B);return false;}};mstrPageByImpl.prototype.updateSelectedForms=function(G){microstrategy.selectedAttrForms||(microstrategy.selectedAttrForms={});var B=G.split(","),A=B&&B.length||0,F=[],C,D=microstrategy.activeCXMenu||this.activeElement,E=D.getAttribute("id").slice(3);for(C=0;C<A;C++){F.push({dssid:B[C],n:B[C].split("|")[2]});}microstrategy.selectedAttrForms[E]=F;};mstrPageByImpl.prototype.updateCartModel=function(){var B=microstrategy.activeCXMenu||this.activeElement,C=B.getAttribute("id").slice(3);var A=microstrategy.attrFormsCartModel;if(A){A.get("available").setItems(microstrategy.availAttrForms[C]);microstrategy.selectedAttrForms||(microstrategy.selectedAttrForms={});microstrategy.selectedAttrForms&&A.get("selected").setItems(microstrategy.selectedAttrForms[C]);A._updateAvailableFilteredItems();}this.attrBone.set("okBtnEnable",false);};mstrPageByImpl.prototype.getAttrFormsCartModel=function(){var A=new mstr.models.ListCart({scriptClass:"ListCart",parent:this,available:{scriptClass:"mstr.models.ListModel",valueForm:"dssid"},selected:{scriptClass:"mstr.models.ListModel",valueForm:"dssid"}});A.init();mstr.controllers.Factory.add(A);microstrategy.attrFormsCartModel=A;var B=A.get("selected");B.attachEventListener(this,"listadd_items","onOkEnabledChange");B.attachEventListener(this,"listremove_items","onOkEnabledChange");this.updateCartModel();return A;};mstrPageByImpl.prototype.onOkEnabledChange=function SP_onOkEnabledChange(A){var B=A&&A.src;this.attrBone.set("okBtnEnable",!!(B&&B.getItems().length>0));};mstrPageByImpl.prototype.execCommand=function(B,A){switch(B){case"SelectAttrForms":this.handleCustomAttrForms(A);break;}};mstrPageByImpl.prototype.handleCustomAttrForms=function(E){var I=microstrategy.activeCXMenu||this.activeElement,H=I.getAttribute("id").slice(3),A=E&&E.get("selected").get("items")||null,F=this.updateManager,B="",G=A&&A.length||0,C=mstrRWControlImpl.EVENT_SEPARATOR,D;if(G>0){F.add([F.createActionObject(null,mstrUpdateManager.DISPLAYTYPE_PAGEBY,this.beanPath,["20001","20014"],[H,4],[])]);for(D=0;D<G;D++){B+=A[D].dssid+C;}F.add([F.createActionObject(null,mstrUpdateManager.ATTRFORMS_PAGEBY,this.beanPath,["20001","20015"],[H,B],[])]);F.flushAndSubmitChanges();}this.attrBone.set("okBtnEnable",false);};mstrPageByImpl.prototype.handlePivotRequest=function(D,C){try{var A=this.updateManager;if(A){A.add([A.createActionObject(null,mstrUpdateManager.MOVE_PAGEBY,this.beanPath,["20001","20004"],[D,C],[])]);A.flushAndSubmitChanges();}}catch(B){microstrategy.errors.log(B);return false;}};mstrPageByImpl.prototype.handleRemoveRequest=function(F){try{var A=microstrategy.getViewerBone().sectionsList;var B=true;for(var D=0;D<A.length;D++){if(A[D].v&&A[D].g!=F){B=false;break;}}if(B){showMessage({contents:microstrategy.descriptors.getDescriptor("4560"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}var C=this.updateManager;if(C){C.add([C.createActionObject(null,mstrUpdateManager.REMOVE_PAGEBY,this.beanPath,["20001"],[F],[])]);C.flushAndSubmitChanges();}}catch(E){microstrategy.errors.log(E);return false;}};mstrPageByImpl.prototype.handleEditorProperties=function(B){try{toggleShowBean("gbeb",true,"activeGroupby="+B);}catch(A){microstrategy.errors.log(A);return false;}};mstrPageByImpl.prototype.handlePageByRequest=function(A){try{var B=this.updateManager;if(B){B.add([B.createActionObject(null,mstrUpdateManager.SET_PAGEBY_ELEMENT,this.beanPath,["20005"],[A],[])]);B.flushAndSubmitChanges();}}catch(C){microstrategy.errors.log(C);return false;}};mstrPageByImpl.prototype.getUnit=function(C){try{if(this.units){var A=new mstrObjectInfoImpl(C);for(var D in this.units){if(A.dssId==this.units[D].oid){return this.units[D];}}}return null;}catch(B){microstrategy.errors.log(B);return null;}};mstrPageByImpl.prototype.isEditableViewModeEplus=function(){var A=microstrategy.bone("rwb_viewer");if(!A||A.isEditableViewModeEplus()){return true;}else{return false;}};mstrPageByImpl.prototype.deleteItems=function(){return true;};mstrPageByImpl.prototype.onwinresize=function(){if(this.mask){this.mask.onmaskedobjectresize();}};function mstrPageByImpl(A){this.inherits=mstrStaticPageBy;this.inherits(A);this.inherits=null;return this;}mstrNavigationBarScript=true;mstrNavigationBar.prototype=new mstrPanelStack();(function(){var G="nbl",E=1,H=2,D=35,B=76,J=-1,F=1;var C={UseAsNavBar:microstrategy.TRUE,showTitleBar:microstrategy.FALSE,BackgroundHighlightColor:16089629,backgroundColor:"#000000"};var I={locked:microstrategy.TRUE,BackgroundHighlightColor:-1,FontHighlightColor:16777215,color:"#FFFFFF",fontSize:"10pt",fontFamily:"Helvetica",fontWeight:"bold",backgroundColor:"transparent",backgroundStyle:"transparent"};mstrNavigationBar.prototype.buttons=null;mstrNavigationBar.prototype.isNavigationBar=true;mstrNavigationBar.prototype.onload=function(){this.buttons=[];mstrPanelStack.prototype.onload.call(this);this.docViewer=microstrategy.getViewerBone();var M=this.getCurrentPanel(),L=M.elem;M.isNavigationBar=true;M.isPanelEmpty=function(){return false;};M.clearContentsMenu();if(L){var N=microstrategy.findChildrenWithAtt(L,"span","scriptclass","mstrButton"),Q=microstrategy.styleObj;for(var O=0;O<N.length;O++){var P=microstrategy.bone(N[O].id);if(P){this.registerButton(P);}}this.buttons.sort(function(T,R){var U=T.elem,S=R.elem;return Q.getValue(U,"zIndex")-Q.getValue(S,"zIndex");});}mstr.controllers.EventManager.attachEventListener(this,this,"Add","onAdd");mstr.controllers.EventManager.attachEventListener(this,M,"ChildAdded","onButtonInserted");mstr.controllers.EventManager.attachEventListener(this,M,"ChildDeleted","onButtonRemoved");mstr.controllers.EventManager.attachEventListener(this,M,"PostRemoveChildren","postRemoveButtons");this.docViewer.observer.register(this.id);};mstrNavigationBar.prototype.addButton=function(L){this.docViewer.commands.exec("addToPanel;106B|"+microstrategy.BUTTON_STYLE_ICON_TOP);};mstrNavigationBar.prototype.onAdd=function(P){var N=P.ac,Q=P.update,M=this.elem,O=this.docViewer.doc,L=microstrategy.formatObj;K(O,[M],C,N,Q);O.formatItemBorders([M],["borderLeft","borderRight","borderTop","borderBottom"],"none","0pt","#000000",Q,N);};function A(O,N,M){var M=M||(function(){return this;})();for(var L in O){if(N.call(M,O[L],L,O)===false){break;}}}function K(P,M,L,O,Q){var N=microstrategy.formatObj;A(L,function(T,S){var R=N.isTargetStyleOrAttr(S)&N.TARGET_VALUE_STYLE;if(R){P.formatItems(M,S,T,Q,O);}else{P.formatAttribute(M,S,T,Q,N.getAttrNameFromStyle(S),O);}});}mstrNavigationBar.prototype.onButtonInserted=function(P){var M=P.item,L=P.ac,Q=P.update,N=microstrategy.findBone(M),O=this.docViewer.doc;K(O,[M],I,L,Q);O.formatItemBorders([M],["borderLeft","borderRight","borderTop","borderBottom"],"none","0pt","#000000",Q,L);this.registerButton(N);this.synchronizeSize(L);};mstrNavigationBar.prototype.onButtonRemoved=function(L){var M=L&&microstrategy.findBone(L);if(M){mstr.$A.removeItems(this.buttons,[M]);}};mstrNavigationBar.prototype.postRemoveButtons=function(L){this.synchronizeSize(L);};mstrNavigationBar.prototype.onselectionchange=function(L){this.setToolbarState();};mstrNavigationBar.prototype.synchronizeSize=function(L){mstrPanelStack.prototype.synchronizeSize.apply(this,arguments);this.updateLayout(L);};mstrNavigationBar.prototype.updateLayout=function(Z){var M=this.getCurrentPanel().elem;if(!M){return ;}var O=this.buttons.length,X=getObjInnerWidth(M),S=getObjInnerHeight(M);var T=Number(microstrategy.styleObj.getAttValue(this.elem,G))||E,W=this.docViewer.doc,P=0,U=0,N=X;if(T==H){var Q=X-O*B;if(Q>=0){var U=O>1?Math.min(D,Math.floor(Q/(O-1))):0;P=Math.max(0,Math.floor((Q-(O-1)*U)/2));N=O*B;}}for(var R=0,V=P;R<O;R++){var Y=this.buttons[R].elem,L=P+Math.floor((R+1)*N/O)+R*U;W.formatItems([Y],"left",V+"px",false,Z);W.formatItems([Y],"top","0px",false,Z);W.formatSize([Y],"width",L-V+"px",Z);W.formatSize([Y],"height",S+"px",Z);V=L+U;}};mstrNavigationBar.prototype.registerButton=function(L){this.buttons.push(L);};mstrNavigationBar.prototype.onmousedown=function(M){try{M=M||window.event;var O=findTarget(getEventTarget(M),microstrategy.HTMLATTR_CMD_ID);if(!O||O.getAttribute(microstrategy.HTMLATTR_CMD_ID)=="tb"){return ;}if((M.which==3)||(M.button==2)){return false;}if(O.className.indexOf("Disabled")==-1){var N=O.getAttribute(microstrategy.HTMLATTR_CMD_ID);switch(N){case"mbl":case"mbr":this.moveButton((N=="mbl")?J:F);break;case"ab":this.selectPanelStack();this.addButton();break;}}M.cancelBubble=true;return false;}catch(L){microstrategy.errors.log(L);}};mstrNavigationBar.prototype.moveButton=function(S){var V=this.docViewer,U=V.doc,L=U.selections,P=this.buttons,R=L.isOnlyOneButtonSelected()?mstr.$A.find(P,microstrategy.findBone(L.getSelectedButtons()[0])):-1;if(R>-1){var W=[],N=R+S;if(0<=N&&N<P.length){var M=P[R],Q=P[N],T=microstrategy.styleObj.getValue(M.elem,"zIndex"),O=microstrategy.styleObj.getValue(Q.elem,"zIndex");U.formatItems([M.elem],"zIndex",O,false,W);U.formatItems([Q.elem],"zIndex",T,false,W);P[R]=Q;P[N]=M;this.synchronizeSize(W);V.updateManager.add(W);L.reselect(M.elem.id);this.setToolbarState();}}};mstrNavigationBar.prototype.getTitleAndClassOfFirstToolbar=function(){return{title:microstrategy.descriptors.getDescriptor("5773"),className:"select"};};mstrNavigationBar.prototype.createToolbar=function(){try{mstrRWUnitBoneImpl.prototype.createToolbar.call(this);var L=this.toolbar,O=this.toolbarMap={select:L.childNodes[0]};L.setAttribute(microstrategy.HTMLATTR_CMD_ID,"tb");L.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e);");function M(P,S,R){var Q=document.createElement("div");Q.className=P;Q.setAttribute("title",S);Q.setAttribute(microstrategy.HTMLATTR_CMD_ID,R);L.appendChild(Q);O[R]=Q;}M("moveButtonLeft",microstrategy.descriptors.getDescriptor("9887"),"mbl");M("moveButtonRight",microstrategy.descriptors.getDescriptor("9888"),"mbr");M("panelInsertMenu",microstrategy.descriptors.getDescriptor("9889"),"ab");this.setToolbarState();}catch(N){microstrategy.errors.log(N);}};mstrNavigationBar.prototype.setToolbarState=function(){try{if(this.toolbar==null){return ;}this.clearToolbarState();var L=this.docViewer.doc.selections,N=this.buttons,O=L.isOnlyOneButtonSelected()?mstr.$A.find(N,microstrategy.findBone(L.getSelectedButtons()[0])):-1,Q=this.toolbarMap;function P(R){if(R){R.className+="Disabled";}}if(O>-1){if(O==0){P(Q.mbl);}if(O==N.length-1){P(Q.mbr);}}else{P(Q.mbl);P(Q.mbr);}}catch(M){microstrategy.errors.log(M);}};})();function mstrNavigationBar(A){mstrPanelStack.call(this,A);}mstrTableControlScript=true;mstrTableControl.prototype=new mstrPanelStack();mstrTableControl.prototype.unloadBone=true;mstrTableControl.prototype.isTable=true;mstrTableControl.prototype.tables=[];mstrTableControl.prototype.def="";mstrTableControl.DEFAULT_ICON="../style/mstr/images/table_icon.png";mstrTableControl.DEFAULT_INDICATOR="../style/mstr/images/navRight.png";mstrTableControl.DEFAULT_GROUP_TITLE_TEXT="4756";mstrTableControl.DEFAULT_TITLE_TEXT="4756";mstrTableControl.DEFAULT_SUBTITLE_TEXT="Subtitle";mstrTableControl.DEFAULT_VALUE_TEXT="7760";mstrTableControl.GROUP_TITLE_HEIGHT=36;mstrTableControl.DEFAULT_GROUP_TITLE_TOP_PADDING=10;mstrTableControl.DEFAULT_CELL_PADDING=10;mstrTableControl.CELL_HEIGHT=44;mstrTableControl.CELL_PADDING=0;mstrTableControl.DEFAULT_ICON_WIDTH=30;mstrTableControl.DEFAULT_INDICATOR_WIDTH=16;mstrTableControl.DEFAULT_TABLE_MARGIN=10;mstrTableControl.SELECTOR_BUTTON_HEIGHT=44;mstrTableControl.SELECTOR_BUTTON_INTERVAL=14;mstrTableControl.RECT_ZINDEX=5;mstrTableControl.IMG_ZINDEX=10;mstrTableControl.TEXT_ZINDEX=10;mstrTableControl.LINE_ZINDEX=10;mstrTableControl.SELECTOR_ZINDEX=10;mstrTableControl.LINE_PROPS={bc:true,bs:true,bw:true};mstrTableControl.RECT_PROPS={bc:true,bs:true,bw:true,bgc:true};mstrTableControl.TEXT_PROPS={ff:true,fs:true,fc:true,fb:true,fi:true,fso:true,ful:true};mstrTableControl.prototype.getDefaultSubmitBtnConfig=function(){return{dpCfm:false,subMsg:"",invCache:false,ast:8,shSubMsg:false,aapm:false,fcLvExec:false,dpTxt:microstrategy.descriptors.getDescriptor("5369"),pso:8};};mstrTableControl.prototype.getDefaultCancelBtnConfig=function(){return{dpCfm:false,subMsg:"",invCache:false,ast:4,shSubMsg:false,aapm:false,fcLvExec:false,dpTxt:microstrategy.descriptors.getDescriptor("2827"),pso:8};};mstrTableControl.prototype.onload=function(){try{mstrPanelStack.prototype.onload.call(this);if(!this.elem){return ;}this.commands=new mstrPanelStackCommandsImpl(this);this.sibs=document.getElementsByName(this.id);this.rwb=microstrategy.getViewerBone();this.um=microstrategy.updateManager;this.cleanupTables();this.submitBtn=this.submitBtn||this.getDefaultSubmitBtnConfig();this.cancelBtn=this.cancelBtn||this.getDefaultCancelBtnConfig();var props={bone:this,textPaddings:this.getDefaultTextPadding()};if(this.def){eval("var tb="+this.def);props.def=tb.table.def;props.tp=tb.table.tp;props.fmt=tb.table.fmt;props.sg={smt:{key:props.def.smk,dpTxt:this.submitBtn.dpTxt},dsc:{key:props.def.dck,dpTxt:this.cancelBtn.dpTxt},marginLeft:mstrTableControl.DEFAULT_TABLE_MARGIN,buttonInterval:mstrTableControl.SELECTOR_BUTTON_INTERVAL};}this.renderTC(props);mstr.controllers.EventManager.attachWindowEventListener(this,"closeContextMenu","closeContextMenu");}catch(err){microstrategy.errors.log(err);}};mstrTableControl.prototype.renderTC=function(A){var C=this,E=C.getDocViewer().doc.styleObj,B=function(F){F.style.width="100%";F.style.display="";F.removeAttribute(microstrategy.HTMLATTR_OBJTYPE);F.removeAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);F.removeAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);F.innerHTML='<div style="height:100%;"/>';};var D=function(){A.scriptClass="mstrmojo.platform.TableModel";if(C.trxInfo){A.trxInfo=C.trxInfo;}var J=mstrmojo.insert(A);C.model=J;for(var K=0;K<C.sibs.length;K++){var I=C.sibs[K],H=I.lastChild.lastChild.firstChild;C.currentPanelId=C.currentPanelId?C.currentPanelId:H.id;var L=parseInt(E.getValue(C.elem,"padding"));L=isNaN(L)?1:L;var G=C.elem.style.height?C.elem.style.height:Math.max(parseInt(E.getValue(C.elem,"height",microstrategy.FORMAT_TYPE_MAIN))-(2*L),0)+"px";I.lastChild.style.height=G;H.style.height=G;B(H);var F=mstrmojo.insert({scriptClass:"mstrmojo.platform.TableControl",model:J,container:C,text:"hello",width:microstrategy.getFormatObject().decodeValue("width",C.queryState("Width"))});C.tables.push(F);F.domNode=H.lastChild;F.render();}};if(!window.mstrmojo||!mstrmojo.platform.TableControl){microstrategy.mojoLoader.loadWidget({bundle:"mojo-tc.js",callback:D});}else{D();}};mstrTableControl.prototype.onboneaftermove=function(A,F){if(F){mstrPanelStack.prototype.onload.call(this);mstrPanelStack.prototype.onboneaftermove.call(this,A,F);this.commands=new mstrPanelStackCommandsImpl(this);this.sibs=document.getElementsByName(this.id);this.rwb=microstrategy.getViewerBone();this.um=microstrategy.updateManager;for(var D=0;D<this.sibs.length;D++){var C=this.sibs[D],B=C.lastChild.lastChild.firstChild,E=this.tables[0];this.currentPanelId=this.currentPanelId?this.currentPanelId:B.id;E.domNode=B.lastChild;E.refresh();}}else{mstrPanelStack.prototype.onboneaftermove.call(this,A,F);}};mstrTableControl.prototype.getTextTopInCell=function(A,B){var C=microstrategy.getFormatObject(),D=(parseFloat(B)-parseFloat(C.encodeValue("top",C.getPxFromPt(A))))/2;return D>0?D:0;};mstrTableControl.prototype.getTextTopInCellPx=function(A,B){var C=microstrategy.getFormatObject(),D=(B-parseInt(this.getDefaultTextPadding().v)*2-parseInt(C.getPxFromPt(A)))/2;return D>0?D:0;};mstrTableControl.prototype.getTitlesTopInCell=function(E,B,A){var C=microstrategy.getFormatObject(),E=parseFloat(C.encodeValue("top",C.getPxFromPt(E))),B=parseFloat(C.encodeValue("top",C.getPxFromPt(B))),D=(parseFloat(A)-E-B)/2;D=D>0?D:0;return{st:D+E,t:D};};mstrTableControl.prototype.genObjId=function(){return microstrategy.OBJ_PREFIX+this.rwb.getNextObjId();};mstrTableControl.prototype.getLineWidth=function(A,D){var E=microstrategy.getFormatObject(),C=A.g.r,B=parseInt(E.getPxFromPt((C.bs=="none")?0:C.bw));return parseInt(D)-B*2;};mstrTableControl.prototype.getNewCell=function(R,E,B,N){var H=(this.model.tp==1)?null:this.genObjId(),c=this.genObjId(),T=this.genObjId(),V=microstrategy.descriptors,F=V.getDescriptor(mstrTableControl.DEFAULT_VALUE_TEXT),J={h:E,tp:106,ick:H,tk:c,vk:T,vph:F,is:"textvalue",idx:"0",t:R},X=microstrategy.getFormatObject(),S=B.g.r,U=parseFloat(X.getPxFromPt((S.bs=="none")?0:S.bw)),a=parseFloat(this.queryState("Width"))-parseFloat(X.encodeValue("width",U))*2,Q=parseFloat(X.encodeValue("left",mstrTableControl.DEFAULT_TABLE_MARGIN)),G=H?mstrTableControl.DEFAULT_ICON_WIDTH:mstrTableControl.DEFAULT_CELL_PADDING,C=parseFloat(X.encodeValue("height",G)),W=(a-C*2)/2,L=R,R=parseFloat(X.encodeValue("height",R)),P=parseFloat(X.encodeValue("height",E)),I=X.encodeValue("height",X.getPxFromPt(B.c.t.fs)),Z=X.encodeValue("height",X.getPxFromPt(B.c.v.fs)),M=(P>C)?((P-C)/2):0,D=this.getTextTopInCell(B.c.t.fs,P),A=this.getTextTopInCell(B.c.v.fs,P);if(H){this.exec({id:"addImg",v:{key:H,n:"icon_"+H,url:mstrTableControl.DEFAULT_ICON,top:R+M,left:Q,height:C,width:C},umNow:true});}this.exec({id:"addText",v:{key:c,n:"title"+c,fmla:V.getDescriptor(mstrTableControl.DEFAULT_TITLE_TEXT),top:R+D,left:C+Q,height:I,width:W},umNow:true});this.exec({id:"addText",v:{key:T,n:"value"+T,fmla:F,top:R+A,left:W+parseFloat(C)+Q,height:Z,width:W},umNow:true});var Y=this.getDefaultFormat(106,"1"),K=[{key:c,ps:mstrTableControl.TEXT_PROPS,df:Y,applyFmt:B.c.t},{key:T,ps:mstrTableControl.TEXT_PROPS,df:Y,applyFmt:B.c.v}];this.applyDefaultFormats(K);if(N){var O=this.genObjId();this.exec({id:"addLine",v:{key:O,n:"line"+O,top:L,left:mstrTableControl.DEFAULT_TABLE_MARGIN+U,width:this.queryState("decWidth")-2*U,fmt:B},umNow:true});J.lk=O;}return J;};mstrTableControl.prototype.getNewGroup=function(L,M,J,A){var D=this.genObjId(),K=this.genObjId(),H=microstrategy.getFormatObject(),E=parseFloat(this.queryState("Width")),B=parseFloat(H.encodeValue("left",mstrTableControl.DEFAULT_TABLE_MARGIN)),O=parseInt(this.getDefaultTextPadding().v),F=H.encodeValue("height",parseInt(H.getPxFromPt(A.g.t.fs))+2*O),N=H.encodeValue("top",L+this.getTextTopInCellPx(A.g.t.fs,mstrTableControl.GROUP_TITLE_HEIGHT)),I=H.encodeValue("height",J),C=H.encodeValue("top",L+M);this.exec({id:"addText",v:{key:D,n:"title"+D,fmla:microstrategy.descriptors.getDescriptor(mstrTableControl.DEFAULT_GROUP_TITLE_TEXT),top:N,left:B,height:F,width:E},umNow:true});this.exec({id:"addRect",v:{key:K,n:"rect"+K,top:C,left:B,height:I},umNow:true});var G=[{key:D,ps:mstrTableControl.TEXT_PROPS,df:this.getDefaultFormat(106,"1"),applyFmt:A.g.t},{key:K,ps:mstrTableControl.RECT_PROPS,df:this.getDefaultFormat(101,"1"),applyFmt:A.g.r}];this.applyDefaultFormats(G);return{tk:D,rk:K,t:parseFloat(L)+"px",h:parseFloat(M)+parseFloat(J)+"px",cells:[this.getNewCell(L+M,J,A)]};};mstrTableControl.prototype.getDefaultIOSFormat=function(){return{g:{h:mstrTableControl.GROUP_TITLE_HEIGHT+"px",t:{ff:"Helvetica",fs:"12",fc:"#4C576B",fb:true,fi:false,fso:false,ful:false},r:{bgc:"#FFFFFF",bs:"solid",bc:"#969696",bw:"1"}},c:{h:mstrTableControl.CELL_HEIGHT+"px",t:{ff:"Helvetica",fs:"12",fc:"#000000",fb:true,fi:false,fso:false,ful:false},st:{ff:"Arial",fs:"10",fc:"#999999",fb:true,fi:false,fso:false,ful:false},v:{ff:"Helvetica",fs:"12",fc:"#385487",fb:false,fi:false,fso:false,ful:false}}};};mstrTableControl.prototype.getDefaultTextPadding=function(){var B=this.rwb.defaultFormats[106][1].FormattingPadding,D=microstrategy.getFormatObject(),C=parseFloat(B.LeftPadding.defaultValue)+parseFloat(B.RightPadding.defaultValue),A=parseFloat(B.TopPadding.defaultValue)+parseFloat(B.BottomPadding.defaultValue);return{h:D.getPxFromPt(C),v:D.getPxFromPt(A)};};mstrTableControl.prototype.getDefaultFormat=function(F,G){var E=this.rwb.defaultFormats[F][G],D=microstrategy.getFormatObject();switch(F){case 106:var A=E&&E.FormattingFont;return A&&{ff:A.Name.defaultValue,fs:A.Size.defaultValue,fc:D.decodeValue("color",A.Color.defaultValue),fb:!!parseInt(A.Bold.defaultValue),fi:!!parseInt(A.Italic.defaultValue),fso:!!parseInt(A.Strikeout.defaultValue),ful:!!parseInt(A.Underline.defaultValue)};case 101:var B=E&&E.FormattingPatterns,C=E&&E.FormattingLine;return txtFont=B&&C&&{bgc:D.decodeValue("color",B.FillColor.defaultValue),bs:D.decodeValue("lineStyle",C.LineStyle.defaultValue),bc:D.decodeValue("color",C.LineColor.defaultValue),bw:C.LineWeight.defaultValue};case 105:var C=E&&E.FormattingLine;return txtFont=C&&{bs:D.decodeValue("lineStyle",C.LineStyle.defaultValue),bc:D.decodeValue("color",C.LineColor.defaultValue),bw:C.LineWeight.defaultValue};}};mstrTableControl.prototype.initNewTable=function(M,AB){var AA=this.rwb,y=microstrategy.getFormatObject(),c=function(AG){y.encodeValue("height",AG);},K=(AB==1),H=this.getDefaultFormat(106,"1"),h=this.genObjId(),C=this.genObjId(),E=K?null:this.genObjId(),a=this.genObjId(),q=this.genObjId(),AD=this.genObjId(),AC=this.genObjId(),X=mstr.utils.Hash,O=microstrategy.descriptors,L=O.getDescriptor(mstrTableControl.DEFAULT_VALUE_TEXT),T={def:{gs:[{tk:C,rk:h,t:"0px",h:mstrTableControl.GROUP_TITLE_HEIGHT+mstrTableControl.CELL_HEIGHT+"px",cells:[{tp:106,ick:E,tk:a,vk:q,vph:L,t:mstrTableControl.GROUP_TITLE_HEIGHT+"px",h:mstrTableControl.CELL_HEIGHT+"px",sty:1,idx:"0"}]}],smk:AD,dck:AC},fmt:this.getDefaultIOSFormat()},n=T.fmt.g.r,J=parseInt(y.getPxFromPt((n.bs=="none")?0:n.bw)),z=mstrTableControl.CELL_PADDING,Z=parseInt(this.getDefaultTextPadding().v),I=this.queryState("decWidth")-2*J,Q=mstrTableControl.DEFAULT_TABLE_MARGIN,N=E?mstrTableControl.DEFAULT_ICON_WIDTH:mstrTableControl.DEFAULT_CELL_PADDING,W=N,m=(I-N*2)/2-z,o=mstrTableControl.CELL_HEIGHT-2*J,A=mstrTableControl.GROUP_TITLE_HEIGHT,g=parseInt(y.getPxFromPt(T.fmt.g.t.fs))+2*Z,P=this.getTextTopInCellPx(T.fmt.g.t.fs,mstrTableControl.GROUP_TITLE_HEIGHT),AF=Math.max(o-W,0)/2+A,AE=this.getTextTopInCellPx(T.fmt.c.t.fs,o)+A,D=parseInt(y.getPxFromPt(T.fmt.c.t.fs))+2*Z,e=parseInt(y.getPxFromPt(T.fmt.c.v.fs))+2*Z,Y=this.getTextTopInCellPx(T.fmt.c.v.fs,o)+A,x=A+o+2;M=[];M.push(this.exec({id:"addTextdec",v:{key:C,n:"title"+C,fmla:O.getDescriptor(mstrTableControl.DEFAULT_GROUP_TITLE_TEXT),top:P,left:Q,height:g,width:I},umNow:true}));M.push(this.exec({id:"addRectdec",v:{key:h,n:"rect"+h,top:A,left:Q,height:o},umNow:true}));if(E){M.push(this.exec({id:"addImgdec",v:{key:E,n:"icon_"+E,url:mstrTableControl.DEFAULT_ICON,top:AF,left:Q+z,height:W,width:N},umNow:true}));}M.push(this.exec({id:"addTextdec",v:{key:a,n:"title"+a,fmla:O.getDescriptor(mstrTableControl.DEFAULT_TITLE_TEXT),top:AE,left:Q+N,height:D,width:m},umNow:true}));M.push(this.exec({id:"addTextdec",v:{key:q,n:"value"+q,fmla:L,top:Y,left:Q+N+m,height:e,width:m},umNow:true}));this.submitBtn=this.getDefaultSubmitBtnConfig();this.submitBtn.ctlKey=AD;this.cancelBtn=this.getDefaultCancelBtnConfig();this.cancelBtn.ctlKey=AC;var S={smt:{key:AD,dpTxt:this.submitBtn.dpTxt},dsc:{key:AC,dpTxt:this.cancelBtn.dpTxt},marginLeft:mstrTableControl.DEFAULT_TABLE_MARGIN,buttonInterval:mstrTableControl.SELECTOR_BUTTON_INTERVAL},G=(I-mstrTableControl.SELECTOR_BUTTON_INTERVAL)/2,R=mstrTableControl.SELECTOR_BUTTON_HEIGHT,u=mstrTableControl.SELECTOR_BUTTON_INTERVAL;M.push(this.exec({id:"addSelector",v:{key:AD,n:"selector"+AD,top:x,left:G+u+Q,height:R,width:G},umNow:true}));M.push(this.exec({id:"addSelector",v:{key:AC,n:"selector"+AC,top:x,left:Q,height:R,width:G},umNow:true}));M.push(this.exec({id:"setSelectorAction",v:{key:AC,at:4},umNow:true}));M.push(this.exec({id:"setSelectorDisplayText",v:{key:AC,txt:O.getDescriptor("2827")},umNow:true}));M.push(this.exec({id:"setSelectorDisplayText",v:{key:AD,txt:O.getDescriptor("5369")},umNow:true}));this.model.set("fmt",T.fmt);this.model.set("tp",AB);this.model.set("sg",S);this.model.set("def",T.def);var U=T.fmt,B=mstrTableControl.RECT_PROPS,V=mstrTableControl.TEXT_PROPS,F=[{key:h,ps:B,df:this.getDefaultFormat(101,"1"),applyFmt:U.g.r},{key:C,ps:V,df:H,applyFmt:U.g.t},{key:a,ps:V,df:H,applyFmt:U.c.t},{key:q,ps:V,df:H,applyFmt:U.c.v}];this.applyDefaultFormats(F);};mstrTableControl.prototype.applyDefaultFormats=function(B){for(var H in B){var E=B[H],C=E.key,G=E.ps,F=E.df,A=E.applyFmt;for(var D in G){if(A[D]!=F[D]){this.exec({id:"set"+D,v:{key:C,value:A[D]}});}}}};mstrTableControl.prototype.cleanupTables=function(){var D=this.tables,C=D.length,B=0;if(C){for(;B<C;B++){var A=D[B];if(A&&A.destroy){A.destroy();}}}this.tables=[];};mstrTableControl.prototype.onunload=function(){this.cleanupTables();};mstrTableControl.prototype.createToolbar=function(){mstrRWUnitBoneImpl.prototype.createToolbar.call(this);};mstrTableControl.prototype.registerPanel=function(){};mstrTableControl.prototype.updatePositionMap=function(){};mstrTableControl.prototype.hideGuidelines=function(){};mstrTableControl.prototype.synchronizeShadow=function(){};mstrTableControl.prototype.ondocobjectdrag=function(){};mstrTableControl.prototype.showPanel=function(){};mstrTableControl.prototype.resize=function(B,A){if(B){this.getCurrentPanel().elem.style.height=B+"px";}if(A){this.getCurrentPanel().elem.style.width=A+"px";}this.tables[0].resize(B,A&&(A-mstrTableControl.DEFAULT_TABLE_MARGIN*2+"px"));};mstrTableControl.prototype.getCurrentPanel=function(){var A=this.elem.lastChild.lastChild.firstChild;return{elem:A,id:A.id};};mstrTableControl.prototype.getFormat=function(E){var B=E,A=this.tables[0].model,C={"2":"g","3":"c"}[B.u],D={"1":"t","2":"st","3":"v","4":"r"}[B.f];return C&&D&&A.fmt[C][D]&&A.fmt[C][D][B.p];};mstrTableControl.prototype.setFormat=function(E){var B=E,A=this.tables[0].model,C={"2":"g","3":"c"}[B.u],D={"1":"t","2":"st","3":"v","4":"r"}[B.f];if(C&&D&&A.fmt[C][D]){A.fmt[C][D].set(B.p,B.v);}};mstrTableControl.prototype.getTransactionUnitKey=function(){var A=this.getCurrentPanel().elem;return{k:A.getAttribute("fgkey"),sk:A.id};};mstrTableControl.prototype.exec=function(W){var Q=W.id,K=W.v,Z=W.umNow,L=this.um,c=[],e=this.rwb.beanPath,a=microstrategy.getFormatObject(),G=function(h){return a.encodeValue("height",h);};switch(W.id){case"postAddSelector":L.commands.exec("apply");break;case"transactionEdit":var R=this.getCurrentPanel().elem;this.rwb.doc.commands.exec(W.id);break;case"selectorEdit":var V=microstrategy.bones[K.key+"_Ctl"];if(V){this.rwb.doc.selections.add(V.activeRWUnit);this.rwb.doc.selections.remove(this.elem);this.rwb.doc.commands.exec("edtProps");}break;case"edtLinks":toggleShowBean("webHyperLinkEditor",true,"activeObjKey="+K.key+"&renderPromptsOnly=false");break;case"setTableDef":microstrategy.formatType=1;this.rwb.doc.formatAttribute([this.elem],"TableControlDefinition",K.def,false,microstrategy.HTMLATTR_TABLE_CONTROL_DEFINITION,c,true);if(Z){L.add(c);break;}else{return c[0];}case"newGroup":return this.getNewGroup(parseFloat(K.top),parseFloat(K.th),parseFloat(K.ch),K.fmt);case"newCell":return this.getNewCell(parseFloat(K.top),parseFloat(K.ch),K.fmt,K.line);case"setProp":microstrategy.formatType=1;L.add([L.createEditPropsAction(null,K.key,e,[K.prop],[K.value],null,null,null,true)]);if(K.value=="NaNpx"){microstrategy.errors.log({description:"an Error on object with key ["+K.key+"]: "+K.prop});}break;case"addLine":var U=K.key||this.genObjId(),T=a.encodeValue("left",K.left),N=a.encodeValue("top",K.top),I=K.width?K.width:this.getLineWidth(K.fmt,this.queryState("decWidth"));I=a.encodeValue("width",I);L.add([L.createActionObject(null,mstrUpdateManager.ADD_LINE,e,["2048018","2048012","2048020","2048007","2048010","2048011","2048100","2048241","2048043","2048061"],[mstrUpdateManager.UPDATE_LATER,U,K.n||"line",this.currentPanelId,N,T,mstrTableControl.LINE_ZINDEX,"true",I,microstrategy.ORIENTATION_HORIZONTAL],[],null)]);var F=this.rwb.doc.styleObj,S=F.formattingAttributes[U];if(typeof (S)=="undefined"){F.formattingAttributes[U]={};S=F.formattingAttributes[U];}S.lt=T;S.tp=N;S[microstrategy.HTMLATTR_WIDTH]=I;var E=[{key:U,ps:mstrTableControl.LINE_PROPS,df:this.getDefaultFormat(105,"1"),applyFmt:K.fmt.g.r}];this.applyDefaultFormats(E);return{key:U};break;case"addRectdec":K.top=G(K.top);K.left=G(K.left);K.height=G(K.height);case"addRect":var I=this.queryState("Width");L.add([L.createActionObject(null,mstrUpdateManager.ADD_SHAPE,e,["2048018","2048012","2048020","2048007","2048010","2048011","2048100","2048241","2048042","2048043","2048067"],[mstrUpdateManager.UPDATE_LATER,K.key,K.n,this.currentPanelId,K.top,K.left,mstrTableControl.RECT_ZINDEX,"true",K.height,I,"2"],[],null)]);var F=this.rwb.doc.styleObj,S=F.formattingAttributes[K.key];if(typeof (S)=="undefined"){F.formattingAttributes[K.key]={};S=F.formattingAttributes[K.key];}S.lt=K.left;S.tp=K.top;S[microstrategy.HTMLATTR_HEIGHT]=K.height;S[microstrategy.HTMLATTR_WIDTH]=I;break;case"setText":L.add([L.createActionObject(null,mstrUpdateManager.EDIT_TEXT,e,["2048012","2048008","2048018"],[K.key,K.fmla,mstrUpdateManager.UPDATE_LATER],[],null)]);break;case"setImg":L.add([L.createActionObject(null,mstrUpdateManager.EDIT_IMAGE,e,["2048012","2048019","2048018"],[K.key,K.url,mstrUpdateManager.UPDATE_LATER],[],null)]);break;case"addIndicator":var H=this.genObjId(),D=mstrTableControl.DEFAULT_INDICATOR,I=parseFloat(this.queryState("Width")),P=parseFloat(a.encodeValue("left",mstrTableControl.DEFAULT_TABLE_MARGIN)),O=parseFloat(a.encodeValue("width",mstrTableControl.DEFAULT_INDICATOR_WIDTH)),M=parseFloat(K.cellHeight)-parseFloat(mstrTableControl.DEFAULT_INDICATOR_WIDTH),N=a.encodeValue("top",parseFloat(K.top)+(M?M:0)/2);this.exec({id:"addImg",v:{key:H,n:"indicator"+H,url:D,top:N,left:I-O*2+P,height:O,width:O},umNow:true});return{key:H,url:D};break;case"addImgdec":K.width=G(K.width);K.top=G(K.top);K.left=G(K.left);K.height=G(K.height);case"addImg":L.add([L.createActionObject(null,mstrUpdateManager.ADD_IMAGE,e,["2048018","2048012","2048020","2048007","2048019","2048010","2048011","2048100","2048241","2048042","2048043"],[mstrUpdateManager.UPDATE_LATER,K.key,K.n,this.currentPanelId,K.url,K.top,K.left,mstrTableControl.IMG_ZINDEX,"true",K.height,K.width],[],null)]);var F=this.rwb.doc.styleObj,S=F.formattingAttributes[K.key];if(typeof (S)=="undefined"){F.formattingAttributes[K.key]={};S=F.formattingAttributes[K.key];}S[microstrategy.HTMLATTR_IMAGE_SOURCE]=K.url;S.lt=K.left;S.tp=K.top;S[microstrategy.HTMLATTR_HEIGHT]=K.height;S[microstrategy.HTMLATTR_WIDTH]=K.width;break;case"addCellValue":var C=this.genObjId(),N=parseFloat(a.encodeValue("top",K.top))+this.getTextTopInCell(K.fmt.fs,a.encodeValue("top",K.cellHeight));this.exec({id:"addText",v:{key:C,n:"value"+C,fmla:microstrategy.descriptors.getDescriptor(mstrTableControl.DEFAULT_VALUE_TEXT),top:N,left:a.encodeValue("left",K.left),height:a.encodeValue("top",K.height),width:a.encodeValue("top",K.width)},umNow:true});this.exec({id:"applyTextFormat",v:{key:C,fmt:K.fmt},umNow:true});return{key:C};case"addCellSubtitle":var Y=this.genObjId(),B=this.getTitlesTopInCell(K.fmt.t.fs,K.fmt.st.fs,a.encodeValue("top",K.cellHeight)),A=parseFloat(a.encodeValue("top",K.top)),N=A+B.st;this.exec({id:"addText",v:{key:Y,n:"subtitle"+Y,fmla:mstrTableControl.DEFAULT_SUBTITLE_TEXT,top:N,left:a.encodeValue("left",K.left),height:a.encodeValue("height",a.getPxFromPt(K.fmt.st.fs)),width:a.encodeValue("top",K.width)},umNow:true});this.exec({id:"applyTextFormat",v:{key:Y,fmt:K.fmt.st},umNow:true});return{key:Y,t:a.decodeValue("top",B.t+A),h:a.getPxFromPt(K.fmt.st.fs)+"px"};case"applyTextFormat":var E=[{key:K.key,ps:mstrTableControl.TEXT_PROPS,df:this.getDefaultFormat(106,"1"),applyFmt:K.fmt}];this.applyDefaultFormats(E);break;case"addTextdec":K.width=G(K.width||parseFloat(this.queryState("decWidth"))/2+"");K.top=G(K.top);K.left=G(K.left);K.height=G(K.height);case"addText":var I=K.width||parseFloat(this.queryState("Width"))/2+"";c=[L.createActionObject(null,mstrUpdateManager.ADD_TEXT,e,["2048018","2048012","2048020","2048007","2048008","2048010","2048011","2048100","2048241","2048042","2048043"],[mstrUpdateManager.UPDATE_LATER,K.key,K.n,this.currentPanelId,K.fmla,K.top,K.left,mstrTableControl.TEXT_ZINDEX,"true",K.height,I],[],null)];var F=this.rwb.doc.styleObj,S=F.formattingAttributes[K.key];if(typeof (S)=="undefined"){F.formattingAttributes[K.key]={};S=F.formattingAttributes[K.key];}S.frma=K.fmla;S.lt=K.left;S.tp=K.top;S[microstrategy.HTMLATTR_HEIGHT]=K.height;S[microstrategy.HTMLATTR_WIDTH]=I;c.push(L.createEditPropsAction(null,K.key,e,["heightMode"],["0"],["2"],false));S.hm="0";if(Z){L.add(c);break;}else{return c;}case"addSelector":var g=K.key,T=a.encodeValue("left",K.left),N=a.encodeValue("top",K.top),X=a.encodeValue("height",K.height),I=a.encodeValue("width",K.width),J=mstrTableControl.SELECTOR_ZINDEX;c=[L.createActionObject(null,mstrUpdateManager.CTRL_ADD,e,["2048010","2048011","2048100","2048043","2048042","2048007","2048012","2048113","2048129","2048114","2048115","2048116","2048119","2048120","2048121","2048125","2048020","2048139","2048241"],[N,T,J,I,X,this.currentPanelId,g,"4","","","",this.id,"5","1","1","1","selector"+g,"0","true"],[],null)];c.push(L.createEditPropsAction(null,g,e,["textAlign"],["center"]));c.push(L.createEditPropsAction(null,g,e,["fontSize"],["11"],null));c.push(L.createEditPropsAction(null,g,e,["fontWeight"],["bold"],null));var F=this.rwb.doc.styleObj,S=F.formattingAttributes[g];if(typeof (S)=="undefined"){F.formattingAttributes[g]={};S=F.formattingAttributes[g];}S.lt=T;S.tp=N;S[microstrategy.HTMLATTR_HEIGHT]=X;S[microstrategy.HTMLATTR_WIDTH]=I;L.add(c);return{key:g};case"setSelectorDisplayText":if(K.key===this.submitBtn.ctlKey){this.submitBtn.dpTxt=K.txt;this.model.selGroupModel&&this.model.selGroupModel.smt.set("dpTxt",K.txt);}else{if(K.key===this.cancelBtn.ctlKey){this.cancelBtn.dpTxt=K.txt;this.model.selGroupModel&&this.model.selGroupModel.dsc.set("dpTxt",K.txt);}}L.add([L.createActionObject(null,mstrUpdateManager.SET_CTL_DISPLAY_TEXT,e,["2048018","2048130","2048234"],[mstrUpdateManager.UPDATE_LATER,K.key,K.txt],[],null)]);break;case"setSelectorAction":L.add([L.createActionObject(null,mstrUpdateManager.SET_CTL_ACTIONS,e,["2048018","2048130","2048226"],[mstrUpdateManager.UPDATE_LATER,K.key,K.at],[],null)]);break;case"setSelectorDisplayConfirmation":if(K.key===this.submitBtn.ctlKey){this.submitBtn.dpCfm=K.value;}else{if(K.key===this.cancelBtn.ctlKey){this.cancelBtn.dpCfm=K.value;}}L.add([L.createEditPropsAction(null,K.key,e,["DisplayConfirmation"],[K.value?K.value:0],null,false)]);break;case"remove":L.add([L.createActionObject(null,mstrUpdateManager.REMOVE_OBJECT,e,["2048018","2048012"],[mstrUpdateManager.UPDATE_LATER,K.key],[],null)]);break;case"setff":this.exec({id:"setProp",v:{key:K.key,prop:"fontFamily",value:K.value}});break;case"setfs":this.exec({id:"setProp",v:{key:K.key,prop:"fontSize",value:K.value}});break;case"setfc":this.exec({id:"setProp",v:{key:K.key,prop:"color",value:K.value}});break;case"setfb":this.exec({id:"setProp",v:{key:K.key,prop:"fontWeight",value:K.value?"bold":""}});break;case"setfi":this.exec({id:"setProp",v:{key:K.key,prop:"fontStyle",value:K.value?"italic":""}});break;case"setfso":this.exec({id:"setProp",v:{key:K.key,prop:"textDecoration2",value:K.value?"line-through":""}});break;case"setful":this.exec({id:"setProp",v:{key:K.key,prop:"textDecoration",value:K.value?"underline":""}});break;case"setbgc":this.exec({id:"setProp",v:{key:K.key,prop:"backgroundColor",value:K.value}});break;case"setbc":this.exec({id:"setProp",v:{key:K.key,prop:"lineColor",value:K.value}});break;case"setbs":this.exec({id:"setProp",v:{key:K.key,prop:"lineStyle",value:K.value}});break;case"setbw":this.exec({id:"setProp",v:{key:K.key,prop:"lineWeight",value:K.value}});break;default:this.rwb.commands.exec(Q);}};mstrTableControl.prototype.querySelectorState=function(B,A){return this[A]&&this[A][B];};mstrTableControl.prototype.queryState=function(A,C){var F=this.tables[0];B=F&&F.model&&F.model.fmt,cf=B&&B.c,gf=B&&B.g,fas=this.rwb.formattingAttributes,f=microstrategy.getFormatObject();fn=function(I){return f.decodeValue("height",fas[C][I]);},cmdInfo=A.split("_");if(cmdInfo.length==3){var H=B[cmdInfo[0]][cmdInfo[1]];return H&&H[cmdInfo[2]];}switch(A){case"defaultCellPadding":return mstrTableControl.DEFAULT_CELL_PADDING;case"removeBorders":var B=C.fmt,D=C.v;return parseFloat(D)-parseFloat(B.bs=="none"?0:f.getPxFromPt(B.bw))*2;case"selectorDom":var G=document.getElementById(C);if(G){var D=G.cloneNode(true);D.className="";D.removeAttribute(microstrategy.HTMLATTR_OBJTYPE);D.removeAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);D.removeAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);return D;}return null;case"TRXObjs":return F.model.getTRXObjs();case"pxFromPt":return f.getPxFromPt(C);case"top":return fn("tp");case"left":return fn("lt");case"width":return fn(microstrategy.HTMLATTR_WIDTH);case"height":return fn(microstrategy.HTMLATTR_HEIGHT);case"text":return this.rwb.formattingAttributes[C].frma;case"img":return this.rwb.formattingAttributes[C][microstrategy.HTMLATTR_IMAGE_SOURCE];case"ctff":return cf.t.ff;case"ctfs":return cf.t.fs;case"ctfc":return cf.t.fc;case"tableId":return this.id;case"decWidth":var E=parseInt(f.decodeValue("width",this.rwb.doc.commands.getCommonAttValue([this.elem],microstrategy.HTMLATTR_WIDTH,"width")));return this.rwb.doc.removePaddingAndBorder(this.elem,E,"width")-2*parseInt(mstrTableControl.DEFAULT_TABLE_MARGIN);case"Width":return f.encodeValue("width",this.queryState("decWidth"));case"zIndex":return this.rwb.doc.styleObj.getValue(this.elem,"zIndex",microstrategy.FORMAT_TYPE_MAIN);case"newObjId":return this.genObjId();default:return this.rwb.commands.queryState(A);}};mstrTableControl.prototype.closeContextMenu=function(A){var B=this.tables&&this.tables[0]&&this.tables[0].contextMenu;if(B){B.closeMenuHandler(A.e);}};function mstrTableControl(A){this.inherits=mstrRWUnitBoneImpl;this.inherits(A);delete this.inherits;return this;}
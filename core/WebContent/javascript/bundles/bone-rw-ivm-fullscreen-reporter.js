mstrContextMenuImpl.prototype=new Object();contextMenuScript=true;mstrContextMenuImpl.prototype.cmm_id=null;mstrContextMenuImpl.prototype.cmm_items=null;mstrContextMenuImpl.prototype.menu_items=null;mstrContextMenuImpl.prototype.length=0;mstrContextMenuImpl.IMG_EMPTY=0;mstrContextMenuImpl.IMG_CHECK=1;mstrContextMenuImpl.IMG_REMOVE=2;mstrContextMenuImpl.IMG_SUBTOTAL=3;mstrContextMenuImpl.IMG_DRILL_UP=4;mstrContextMenuImpl.IMG_DRILL_DOWN=5;mstrContextMenuImpl.IMG_DRILL_TEMPLATE=6;mstrContextMenuImpl.IMG_DRILL=7;mstrContextMenuImpl.IMG_LOADING=8;mstrContextMenuImpl.prototype.addItem=function(B,C,E,A,G){try{var F;if(!E){E=1;}if(!A){A=1;}if(!G){G=mstrContextMenuImpl.IMG_EMPTY;}if(typeof (C)=="string"){F=new Array(B,C,G,0,"","",A,E);}else{F=new Array(B,"",G,1,"["+C.menu_items.toString()+"]","",A,E);}return this.addItemDefinition(F);}catch(D){microstrategy.errors.log(D);return false;}};mstrContextMenuImpl.prototype.addSeparator=function(){try{var B=new Array("-","",0,2,"",1,1);return this.addItemDefinition(B);}catch(A){microstrategy.errors.log(A);return false;}};mstrContextMenuImpl.prototype.addItemDefinition=function(B){try{this.cmm_items.push(B);this.menu_items.push(this.cmm_items.length-1);this.length=this.menu_items.length;return B;}catch(A){microstrategy.errors.log(A);return false;}};mstrContextMenuImpl.prototype.registerTrigger=function(A,B){try{if(A){A.setAttribute("cx","["+this.menu_items.toString()+"]");A.setAttribute("cxid",this.cmm_id);if(B){A.setAttribute("cxty",B);}}return true;}catch(C){microstrategy.errors.log(C);return false;}};function mstrContextMenuImpl(A,C,B){this.cmm_id=A;this.cmm_items=C;this.menu_items=B;return this;}function util_alignColumnHeaderCell(A,C){A.style.width=C+"px";if(mstr.utils.ISIE4&&!mstr.utils.ISIE8&&!(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){if(C==0){A.style.display="none";}else{A.style.display="";}var B=function(){var D=A.offsetWidth;if(D!=C){A.style.width=Math.max(parseInt(A.style.width)+C-D,0)+"px";}};window.setTimeout(B,0);}}function util_convert2Px(D,B){if(mstr.utils.ISIE8&&!/px$/.test(B)){var A=document.createElement("img"),C;A.style.zIndex=-1;A.style.left=B;D.appendChild(A);C=A.style.pixelLeft;D.removeChild(A);return C+"px";}return B;}function util_getBorderWidth(A,E){var B="border-"+E+"-width",C=mstr.utils.CSS.getStyleValue(A,B),D=mstrNumber["UNIT_"+C.substring(C.length-2,C.length).toUpperCase()];if(D){C=(parseFloat(microstrategy.number.convertUnit(D,mstrNumber.UNIT_PX,C))||0);}return C;}function util_getCellPadding(A,B){return parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-"+B));}function util_getRowHeight(G){if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var C=G.cells,A=null;if(G.style.height){return parseFloat(G.style.height);}var E=0;for(var D=0;D<C.length;D++){A=C[D];var B=util_getBorderWidth(A,"top")+util_getBorderWidth(A,"bottom");var F=util_getCellPadding(A,"top")+util_getCellPadding(A,"bottom");if(A.getAttribute("rowspan")==null){E=Math.max(E,parseFloat((mstr.utils.CSS.getStyleValue(A,"height")))+B+F);}}if(A){if(!G.getAttribute("o")){return getObjOuterHeight(G);}return E;}}return mstr.utils.ISIE8?getObjInnerHeight(G):getObjOuterHeight(G);}function util_getCellWidth(A){if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var B=(parseFloat(mstr.utils.CSS.getStyleValue(A,"width")));B=B==0?B:(B+(parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-right"))||0)+(parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-left"))||0)+util_getBorderWidth(A,"left")+util_getBorderWidth(A,"right"));return B+((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&A.parentNode.getAttribute("o")?0.1:0);}return getObjOuterWidth(A);}function util_serRowHeight(F,A,E){F.style.height=A+"px";if(mstr.utils.ISSAFARI){var C=F.cells;for(var B=0;B<C.length;B++){C[B].style.height=A+"px";}}if((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&E){var C=F.cells;if(C&&C[0]){window.setTimeout(function(){C[0].style.height=(A-util_getBorderWidth(C[0],"top")-util_getBorderWidth(C[0],"bottom"))+"px";},100);}}if(mstr.utils.ISIE4&&(!((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)))){var D=function(){var G=util_getRowHeight(F);if(G!=A){F.style.height=Math.max(2*A-G,0)+"px";}};window.setTimeout(D,0);}}function util_getRowHeight(G){if((mstr.utils.ISIE9||mstr.utils.ISIE10)){var C=G.cells,A=null;if(G.style.height){return parseFloat(G.style.height);}var E=0;for(var D=0;D<C.length;D++){A=C[D];var B=util_getBorderWidth(A,"top")+util_getBorderWidth(A,"bottom");var F=util_getCellPadding(A,"top")+util_getCellPadding(A,"bottom");if(A.getAttribute("rowspan")==null){E=Math.max(E,parseFloat((mstr.utils.CSS.getStyleValue(A,"height")))+B+F);}}if(A){if(!G.getAttribute("o")){return getObjOuterHeight(G);}return E;}}return mstr.utils.ISIE8?getObjInnerHeight(G):getObjOuterHeight(G);}function util_getBorderWidth(A,E){var B="border-"+E+"-width",C=mstr.utils.CSS.getStyleValue(A,B),D=mstrNumber["UNIT_"+C.substring(C.length-2,C.length).toUpperCase()];if(D){C=(parseFloat(microstrategy.number.convertUnit(D,mstrNumber.UNIT_PX,C))||0);}return C;}function util_getCellPadding(A,B){return parseFloat(mstr.utils.CSS.getStyleValue(A,"padding-"+B));}function util_getHeaderColumnLeftPosition(A){var B=util_getHeaderColumnHelper(A,"getObjOffsetLeft");return B;}function util_getHeaderColumnWidths(B){if(!mstr.utils.ISWK&&!mstr.utils.ISIE8&&!(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)){var A=[];if(!B){return A;}var E=B.getElementsByTagName("COL");if(E&&E.length){var D=E.length;for(var C=0;C<D;C++){A.push(getObjOuterWidth(E[C]));}}return A;}return util_getHeaderColumnHelper(B,"util_getCellWidth");}function util_getHeaderColumnHelper(U,I){var A=[];if(!U){return A;}var P=U.rows,Q,B=P&&P[0],L=0;for(Q=0;Q<P.length;Q++){if(P[Q].cells.length!==0){B=P[Q];break;}}var J=function(k,c){var h=k.getAttribute(c);return h==null?1:parseInt(h);};var d=function(m,c){var h=null;var n=m.getElementsByTagName("colgroup");var k=n&&n[0];if(k&&k.childNodes[c]){h=parseFloat(k.childNodes[c].style.width);}return h;};var D=function(h){var c=0;if((mstr.utils.ISIE7||mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))&&!h.parentNode.getAttribute("o")&&!h.getAttribute("p")){h.setAttribute("p",1);c=((parseFloat(util_convert2Px(h,mstr.utils.CSS.getStyleValue(h,"paddingRight")))||0)+((mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE))?1:0));h.style.paddingRight=((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)?c:Math.ceil(c))+"px";}};var S=function(p,u){var n=p.cells,q=0;for(var m=0,h=n.length;m<h;m++){var o=J(n[m],"colspan");if(o==1){A[u+m+q]=((mstr.utils.ISIE9||mstr.utils.ISIE10||mstr.utils.ISW3CIE)&&I=="util_getCellWidth")?d(U,u+m+q)||window[I](n[m]):window[I](n[m]);}else{var c=0;for(V=u+m+q+1;V<u+m+q+o;V++){c+=A[V];}A[u+m+q]=window[I](n[m])-c;q+=o-1;}}};var a=function(u,k){var q,h,p,o,m,x=k.cells,y=u.cells;for(h=0,p=x.length;h<p;h++){m=J(x[h],"rowspan");if(m===1){break;}}for(q=0,p=y.length;q<p;q++){o=y[q];if(o.getAttribute("CTY")=="3"){return false;}else{x[h++]=o;}}return true;};if(P.length>0){var X=B.cells;for(var V=0,f=X.length;V<f;V++){var K=J(X[V],"colspan");A.push(window[I](X[V]));while(K-->1){A.push(0);}}}var g=null,O=null,E=[],R={colStart:0,rowSpan:1},N=0,H=0;for(var W=Q+1,T=P.length;W<T;W++){var Z=P[W].getAttribute("level");if(!P[W].getAttribute("o")){var C=P[W].cells[0];if(C&&(C.getAttribute("oty")=="12"||C.getAttribute("MH"))){g=P[W];H=W;}else{H=W;}}else{if(!Z&&P[W].getAttribute("o")){if(!O){O={cells:[]};}if(a(P[W],O)){break;}}else{if(Z){if(Z<=N&&P[W].style.display!="none"){O=P[W-1];break;}else{N=Z;}}}}}if(g){for(var W=Q,Y=H;W<=Y;W++){X=P[W].cells;for(var V=0,M=X.length;V<M;V++){var G=J(X[V],"rowspan");if(G>H){L+=J(X[V],"colspan");}else{break;}}}S(g,L);}var F=function F(){var o,h,n,q,c,k,u=P.length,y=O&&O.cells,m=A.length,x=m,z=false;if(!y||y.length==m){return ;}for(o=Q+1;o<u;o++){if(P[o].getAttribute("level")){return ;}if(P[o].getAttribute("o")){n=P[o].cells;k=n.length;for(h=0;h<k;h++){if(n[h].getAttribute("CTY")=="3"){z=true;break;}}if(z&&(J(n[h],"rowspan")>1)){break;}return ;}}for(o=0;o<m;o++){y[o]=null;}for(o=0;o<u;o++){if(x==0){break;}n=P[o].cells;c=m;for(h=n.length-1;h>=0;h--){q=J(n[h],"colspan");if(q>1){c-=q;continue;}c-=1;if(!y[c]){y[c]=n[h];x--;}}}if(x>0){for(o=0;o<m;o++){if(!y[o]){y[o]={offsetLeft:0,parentNode:{getAttribute:function(){return null;}},getAttribute:function(p){if(p=="colspan"||p=="p"){return 1;}return null;}};}}}};F();if(O){for(W=0,T=Math.min(B.cells.length,O.cells.length);W<T;W++){var e=B.cells[W];if(e&&(e.getAttribute("AX")==="1"||e.getAttribute("AX")==="2"&&e.getAttribute("oty")==="12"||e.getAttribute("MH"))){if(J(B.cells[W],"colspan")>J(O.cells[W],"colspan")){S(O,0);break;}}else{break;}}}return A;}function util_getColumnWidthsArray(A,C,D,F){var E=util_getColumnLeftPositionsArray(A,C,D);var B=util_getWidthsArrayFromLeftsArray(A,C,D,E,F);return(B);}function util_getWidthsArrayFromLeftsArray(H,A,C,F,I){var G=(I)?1:0;var B=new Array;for(var E=0;E<A;E++){var J=E+1;for(J=E+1;J<=A;J++){if(F[J]!=null){break;}}if(J<=A){B[E]=Math.max(F[J]-F[E]-I,0);for(var D=E+1;D<J;D++){B[D]=0;}E+=J-(E+1);}}return(B);}function util_getColumnLeftPosition(K,A,B,I){var C=K.getElementsByTagName("COL");var D=(C)?C.length:0;var G=true;if(A<D){G=false;for(var H=A;H<D;H++){if(C[H].style.display!="none"){A=H;G=true;break;}}}if(G){var F=null;if(bIsIE4&&!bIsIE6){var L=util_getLetterForColumnNumber(A+1);var J=K.cells(L+"1:"+L+B);if(J){if(J.length){F=getObjSumLeft(J[0]);}else{F=getObjSumLeft(J);}}}else{if(bIsW3C||bIsIE6){if(mstr.utils.ISIE8||(mstr.utils.ISIE9||mstr.utils.ISIE10)){var E=util_getHeaderColumnLeftPosition(K);F=E[A]+getObjSumLeft(K);}else{if(mstr.utils.ISCHROME||mstr.utils.ISSAFARI||mstr.utils.ISW3CIE){E=util_getHeaderColumnHelper(K,"getObjSumLeft");F=E[A];}else{if(!I){I=K.getElementsByTagName("COL");}F=getObjSumLeft(I&&I[A]);}}}}return(F);}else{return(getObjSumLeft(K)+getObjWidth(K));}}function util_getColumnLeftPositionsArray(B,E,F){var G=new Array;if(!B){return(G);}for(var C=0;C<E;C++){G[C]=util_getColumnLeftPosition(B,C,F);}var A=null;if(bIsIE4){var D=util_getLetterForColumnNumber(E);A=B.cells.namedItem(D+"1:"+D+F);if(A){if(A.length){A=A[0];}}}if(A){G[E]=getObjSumLeft(A)+getObjWidth(A);}else{G[E]=getObjSumLeft(B)+getObjWidth(B);}return(G);}function util_setObjTableLayout(A,B){A.style.tableLayout="fixed";A.style.width="";if(A.width){A.width="";}return ;}function util_getRowHeightsOfTable(D,B){var A=new Array;for(var C=0;C<B;C++){A[C]=getObjHeight(D.rows[C]);}return(A);}function util_applyRowHeightsToTable(D,B){if(!D){return ;}var A=D.rows.length;for(var C=0;C<A;C++){if(B[C]!=getObjHeight(D.rows[C])){D.rows[C].style.height=B[C];}}return ;}function util_applyColWidthsToTable(H,C,A){if((!H)||(!C)){return ;}var B=C.length;var G=-1;var I=-1;var D=1;for(var F=0;F<B;F++){if(A[F]!=null){I=F;D=1;}else{I=G;var J=-1;for(var E=F+1;E<B;E++){if(A[F]!=null){J=E;break;}}D=J-G;if(D<1){D=1;}}if(I>-1){if(parseInt(A[I])>-1){C[F].style.width=(parseInt(A[I])/D)+"px";if(A[I]>0){C[F].style.display="";}else{if(!mstr.utils.ISW3C){C[F].style.display="none";}else{C[F].style.width="0px";}}G=I;}else{C[F].style.display="none";}}}H.style.width="";return ;}function util_parseRowSpan(B,C){var A=B.rowSpan;if((A)&&(!isNaN(parseInt(A)))&&(parseInt(A)>0)){return(parseInt(A));}return(C);}function util_initCOLTags(G,A){var C=0;var B=G.getElementsByTagName("COL");if(B){C=B.length;}if(C<A){var F=null;var E=G.getElementsByTagName("COLGROUP");if(E.length==0){F=document.createElement("COLGROUP");F=G.insertBefore(F,G.getElementsByTagName("TBODY")[0]);}else{F=E[0];}var I=A-C;for(var D=0;D<I;D++){var H=document.createElement("COL");F.appendChild(H);}}return ;}function util_getWidthofFixedColumns(A,D,E,C,B){if((!A)||(!D)||(!E)||(!C)){return(0);}if(D>=E){return(getObjWidth(A));}else{return(util_getColumnLeftPosition(A,D,C,B)-getObjSumLeft(A));}return(0);}function util_getHeightofFixedRows(A,B,C){if((!A)||(!B)||(!C)){return(0);}if(B>=C){return(getObjHeight(A));}else{return(getObjSumTop(A.rows[B])-getObjSumTop(A));}return(0);}function util_getLetterForColumnNumber(D){var G=97;var F=0;var E=0;var C=0;do{F++;E=26*F;C=26*(F-1)+1;if((D<=E)&&(D>=C)){break;}}while(E<=256);var B="";var A="";if(F>1){B=String.fromCharCode(G+F-2);}A=String.fromCharCode(G+(D-C));return(B+A);}function util_getFixedRows(C){if(!C){return(0);}var D=C.rows;if(!D){return(0);}var A=D.length;var E=0;var F="";if(D[A-1].getAttribute("o")){F="o";}else{if(D[A-1].getAttribute("level")){F="level";}}if(F==""){E=A;}else{for(var B=0;B<A;B++){if(D[B].getAttribute(F)){E=B;break;}}}return(E);}function util_getFixedCols(A){var C=0;var B=util_lastRepeatColHeaderInRow(A,0);C=util_sumColumnCountForCell(A,0,B);return(C);}function util_lastRepeatColHeaderInRow(B,E){var D=B.rows;if(!D){return(0);}var G=D[E].childNodes.length-1;var F=-1;for(var C=0;C<=G;C++){if(D[E].childNodes[C].getAttribute){var A=D[E].childNodes[C].getAttribute("AX");}if(!A||(A!="1")){break;}else{F=C;}}if(F<G){if(D[E].childNodes[F+1].getAttribute){if((D[E].childNodes[F+1].getAttribute("AX")=="2")&&(D[E].childNodes[F+1].getAttribute("OR")=="H")){F+=1;}}}return(F);}function util_sumColumnCountForCell(A,F,D){if(!(A.rows)){return(0);}var C=A.rows[F];if(!C){return(0);}var E=0;for(var B=0;B<D+1;B++){E+=util_parseSpan(C.childNodes[B],1);}return(E);}function util_parseSpan(B,C){var A=B.colSpan;if((A)&&(!isNaN(parseInt(A)))&&(parseInt(A)>0)){return(parseInt(A));}return(C);}function util_copyNode(C,A){A.innerHTML=C.innerHTML;if(C.attributes){var D=C.attributes.length;for(var B=0;B<D;B++){if((C.attributes[B])&&(C.attributes[B].specified)){A.setAttribute(C.attributes[B].nodeName,C.attributes[B].nodeValue,0);}}}if(C.className){A.className=C.className;}return ;}function util_resolveRepeatedColumnWidths(B,D){var H=B;var M=new Array;var K=0;if(!D){return(H);}var F=D.length;for(var I=0;I<F;I++){var L=false;var J=D[I].getAttribute("KEY");if(J){for(var G=0;G<K;G++){if(M[K]==J){L=true;break;}}}else{L=true;}if(!L){var C=new Array;var A=0;for(var G=I;G<F;G++){if(D[G].getAttribute("KEY")==J){C[A]=G;A++;}}var E=0;for(var G=0;G<C.length;G++){if(B[C[G]]>E){E=B[C[G]];}}for(var G=0;G<C.length;G++){H[C[G]]=E;}M[K]=J;K++;}}return(H);}function util_getColumnWidthsString(J,C,M,B){if(!J){return("");}var A=util_getColumnWidthsArray(J,M,B);A=util_resolveRepeatedColumnWidths(A);var E=new Array;var K=0;if(C){var D=C.length;for(var G=0;G<D;G++){var I=C[G].getAttribute("KEY");var L=false;for(var F=0;F<K;F=F+2){if(E[F]==I){L=true;break;}}if(!L){E[K]=I;K++;E[K]=parseInt(A[G]);K++;}}}var H="";var G=0;do{H+=E[G]+":"+E[G+1]+"_";G=G+2;}while(G<K);return(H);}function util_applySingleRowHeight(D,E,G,A){if((!D)||(!D.rows)||(!D.rows.length)){return ;}var F=D.rows.length;if(G>F-1){return ;}if(A>F-1){A=F-1;}var B=(E.length==0)?"":E+"px";for(var C=G;C<=A;C++){D.rows[C].style.height=B;}return ;}function util_getColIndex(K,M,C){try{var F=K.parentNode.rowIndex;var J=util_sumColumnCountForCell(M,F,K.cellIndex)-1;var N=M.rows;for(var A=F;A>=0;A--){for(var I=0,E=0;I<(J+C[F]);){var B=N[A].cells[E++];var H=util_parseRowSpan(B,1);var G=util_parseSpan(B,1);if(H>1){for(var L=A+1;L<(A+H);L++){C[L]+=G;}}I+=G;}}return(J+C[F]);}catch(D){microstrategy.errors.log(D);return null;}}function util_getAllCellsInColumnFromThisCell(B,R,A){try{var U=B.parentNode.rowIndex;var J=R.rows;var F=new Array();for(var Q=0;Q<J.length;Q++){F[Q]=0;}var O=util_getColIndex(B,R,F);var M=new Array();M[0]=B;var P=1;var H=util_parseRowSpan(B,1);if(A==null||typeof (A)=="undefined"){A=J.length;}for(var L=U+H;L<A;){var D=J[L].cells;for(var S=0,N=0;S<O-F[L]&&N<D.length;){var T=D[N++];var E=util_parseRowSpan(T,1);var I=util_parseSpan(T,1);if(E>1){for(var K=L+1;K<(L+E);K++){F[K]+=I;}}if(I>1){F[L]+=I-1;}S+=I;}var C=1;if((O-F[L])>=0){M[P++]=D[O-F[L]];C=util_parseRowSpan(D[O-F[L]],1);}L+=C;}return M;}catch(G){microstrategy.errors.log(G);return null;}}function util_getAllCellsInRowFromThisCell(G,H){if(G.nodeName.toLowerCase()!="td"){return null;}var F=G.parentNode.rowIndex;var B=new Array();B[0]=G;var C=1;var E=util_parseRowSpan(G,H);for(var D=G.cellIndex+1;D<G.parentNode.cells.length;D++){B[C]=G.parentNode.cells[D];C++;}for(var D=F+1;D<F+E;D++){var I=H.rows[D];for(var A=0;A<I.cells.length;A++){B[C]=H.rows[D].cells[A];C++;}}return B;}function util_findCell(D,H,B,C,G){var F=D.rows[H];if(F!=null){var A=F.cells[B];var E=A&&A.getAttribute(G);if(E&&E.toLowerCase()==C.toLowerCase()){return A;}}return null;}mstrDocCommandsImpl.prototype=new Object();mstrDocCommandsImpl.prototype.qeMap={Name:"name",ToolTip:"title",Link:"link",IsLink:"isLink",NewWin:"newWin",Visible:"visibility",VisibleHTML:"showInHTMLViewMode",LineOrientation:"orientation",Source:"src",Locked:"locked",Left:"left",Top:"top",Wmode:"widthMode",Hmode:"heightMode",Width:"width",Height:"height",LockAspectRatio:"lockAspectRatio",Length:"length",Lmode:"lengthMode",borderStyle:"borderTopStyle",IsPortal:"showTitleBar",PortalState:"windowState",PortalTitle:"windowTitle",TitleBarDisplay:"titleBarDisplay",ExportOptions:"exportOptions",HasDropShadow:"dropShadowEffect",DropShadow:"dropShadowDepth",HasRoundedCorners:"hasRoundedCorners",TopCornersOnly:"topCornersOnly",HasAlpha:"alphaEffect",HTMLType:"htmlType",IFrameSource:"url",ShowElementCount:"showElementCount",InformationWindowTarget:"InformationWindowTarget"};mstrDocCommandsImpl.prototype.rwObjNameMap={"106":"3575","102":"3576","105":"3577","101":"3196","52":"3702","111":"4728","8":"4780","107":"4538"};mstrDocCommandsImpl.prototype.exec=function(Aq,S,AB){try{var Bj=null;var BV=null;var u=null;var BJ=null;if(this.parentBone.selections&&this.parentBone.selections.isOnlyOneGridSelected()){u=this.parentBone.selections.getSelectedGrid();Bj=microstrategy.findBone(u);if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(Aq)){var AK=(Bj instanceof mstrReportGraphImpl)?Bj:microstrategy.bone(Bj.id+"_graph");return AK&&AK.commands.exec(Aq,S);}}if(this.parentBone.selections&&this.parentBone.selections.isOnlyOnePanelStackSelected()){BJ=this.parentBone.selections.getSelectedPanelStack();BV=microstrategy.findBone(BJ);}var Be=Aq&&Aq.match(/currentControl;|widget;|autotext;|addToPanel;|waddToPanel;/);if(Be&&Be.index==0){var BF=new RegExp(Be[0],"g"),E=Aq.replace(BF,"");E=(Be[0]=="widget;"||Be[0]=="waddToPanel;")?"113|"+E:E;var Z=Be[0].replace(";","").replace("waddToPanel","addToPanel");Z=Be[0]=="widget;"?"currentControl":Z;return this.exec(Z,E);}var W=function(x,y){showMessage({contents:microstrategy.descriptors.getDescriptor("8498"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:x,buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("219"),Cancel:microstrategy.descriptors.getDescriptor("218")},cancelEval:y,type:mstrMsgBoxImpl.MSG_PREF_WARNING});};switch(Aq){case"setControlQualType":var Ba=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());Ba.setQualType(S);break;case"controlInclude":var Ba=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());Ba.setInclude(S);break;case"sct":this.parentBone.startControlSelectionMode();return false;case"rnp":var AO=microstrategy.findBone(this.queryState("selectedPanelStack"));var Ag=microstrategy.bones.msgBox;if(Ag){var Y=microstrategy.descriptors.getDescriptor("2211");var T=this.parentBone.styleObj.getAttValue(AO.getCurrentPanel().elem,microstrategy.HTMLATTR_WINDOW_TITLE);var Bp=T;if(mstr&&mstr.utils&&mstr.utils.String){Bp=mstr.utils.String.escape4HTMLText(Bp);}Ag.initInput(Y,T,59,256);Ag.setButtons(microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,"microstrategy.bone('rwb_viewer').doc.renamePanel()","");Ag.setTitle(microstrategy.descriptors.getDescriptor("4815")+" "+Bp);Ag.show();}return false;case"cps":var A3=this.queryState("selectedSection");var AO=this.parentBone.selections.firstItem();var Bc="";if(A3!=null&&AO){Bc=AO.getAttribute("id");var A0=getObjSumLeftScrolled(A3)+5;var Ax=getObjSumTopScrolled(A3)+5;A0=getObjSumLeftScrolled(AO)+5;var F=getObjSumTopScrolled(AO);if(Ax<(F-20)){Ax=F-20;}var BS=new Array();var AY=new Array();var P={ctlType:mstrRWControlImpl.CTL_TYPE_PANEL_STACK,ctlSrcId:"",ctlSrcType:"",ctlSrcName:microstrategy.descriptors.getDescriptor("4780"),ctlTargetStr:Bc,ctlStyle:"0",ctlOrientation:"1"};BS=this.parentBone.addCtrl(new Rect(Ax,null,null,A0),A3,BS,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null,P,microstrategy.SNAP_OFF);A0=A0+getObjWidth(A3.lastChild)+10;AY.push(A3.lastChild);this.parentBone.selections.finishAddAllObjs(AY,BS,false);var K=this.parentBone.parentBone;K.updateManager.add(BS);if(K.isEditableViewModeEplus()&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){K.updateManager.flushAndSubmitChanges();}}break;case"csc":case"addAsSelector":var A7=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_ID),AF=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_TYPE),Bb=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE),O="0";if(AF==microstrategy.DSSTYPE_ATTRIBUTE_FORM){AF=microstrategy.DSSTYPE_ATTRIBUTE;}if(AF==microstrategy.DSSTYPE_METRIC||AF==microstrategy.DSSTYPE_USER_METRIC||AF==microstrategy.DSSTYPE_USER_SUMMARY_METRIC){O="7";}var Ad=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DESCRIPTION);var Bc="";if(Bj){Bc=this.parentBone.selections.getSelectedGrid().getAttribute("id");}var A3=this.queryState("selectedSection");if(A3!=null){var A0=getObjSumLeftScrolled(A3)+5;var Ax=getObjSumTopScrolled(A3)+5;if(Bc!=null){A0=getObjSumLeftScrolled(this.parentBone.selections.firstItem())+5;var F=getObjSumTopScrolled(this.parentBone.selections.firstItem());if(Ax<(F-20)){Ax=F-20;}}var BS=new Array();var AY=new Array();var P={ctlType:(AF=="12"||AF=="1"||AF=="47"||AF=="4"||AF=="101"||AF=="100")?"1":"2",ctlSrcId:A7,ctlSrcType:AF,ctlSrcSubtype:Bb,ctlSrcName:Ad,ctlTargetStr:Bc,ctlStyle:O,ctlOrientation:"1"};BS=this.parentBone.addCtrl(new Rect(Ax,null,null,A0),A3,BS,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null,P,microstrategy.SNAP_OFF);if(BS==null){return false;}A0=A0+getObjWidth(A3.lastChild)+10;AY.push(A3.lastChild);this.parentBone.selections.finishAddAllObjs(AY,BS,false);var K=this.parentBone.parentBone;K.updateManager.add(BS);if(K.isEditableViewModeEplus()&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){K.updateManager.flushAndSubmitChanges();}}break;case"setSelectorSource":var Al=microstrategy.bone(S[3].getAttribute("id")+"_Ctl");if(Al){var BS=new Array();BS=Al.setSource(S[0],S[1],S[2],BS);if(microstrategy.getViewerBone().autoWire&&S[1]==microstrategy.DSSTYPE_ATTRIBUTE){var BW=this.parentBone.selections.getSelectedSubsection();if(BW){BW.wireTargets(BS,this.parentBone.parentBone.beanPath,false);}}if(BS&&BS.length>0){microstrategy.updateManager.add(BS);}if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&Al.isDefinitionComplete()){microstrategy.updateManager.flushAndSubmitChanges();}}break;case"tocFtMgr":case"watermarkFtMgr":var A2=S.split("|");this.parentBone.openDialog(Aq,"",null,microstrategy.servletName+"."+microstrategy.pageName);this.parentBone.parentBone.updateManager.replaceURL("selectedTabOptions",A2[2]);this.parentBone.parentBone.updateManager.flushAndSubmitChanges();break;case"copy":return this.parentBone.selections.copy();case"cut":return this.parentBone.selections.cut();case"paste":return this.parentBone.selections.paste();case"delete":return this.exec("deleteSelections");case"selectAll":return this.parentBone.selections.selectAll();case"RwdUnits":this.parentBone.selections.clear();var p=document.getElementById(S);if(p.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.addSubSection(p);}else{this.parentBone.selections.add(p);}break;case"select":this.parentBone.selections.clear();var Ae=S.split("|");if(Ae[1]==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.addSubSection(document.getElementById(Ae[0]));}else{this.parentBone.selections.add(document.getElementById(Ae[0]));}break;case"select_multiple":var Ae=S.split("|");if(Ae[1]==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.addSubSection(document.getElementById(Ae[0]));}else{if(this.parentBone.selections.firstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.clear();}if(this.parentBone.selections.items[Ae[0]]){this.parentBone.selections.remove(document.getElementById(Ae[0]));}else{this.parentBone.selections.add(document.getElementById(Ae[0]));}}break;case"grid":return this.parentBone.toggleGrid();case"rulers":return this.parentBone.toggleRuler();case"duplicate":return this.parentBone.selections.duplicate();case"currentControl":if(S.indexOf("|")>-1){var AN=S.split("|");this.parentBone.currentControl=AN[0];this.parentBone.currentControlSubtype=AN[1];this.parentBone.currentControl_SelectorControlType=(AN.length>2)?AN[2]:null;}else{this.parentBone.currentControl=S;this.parentBone.currentControlSubtype=null;}this.parentBone.isInsertMode=(S!="cursor");this.parentBone.elem.style.cursor=this.parentBone.isInsertMode?"crosshair":"default";this.parentBone.selections.elem.className=this.parentBone.isInsertMode?"":"enabled";if(this.parentBone.parentBone.docViewsSize>1&&!this.parentBone.parentBone.defaultInsertMode){if(this.parentBone.isInsertMode){var AW="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('"+mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID+"'), checked = p && p.checked;";var BE=AW+"rwb.visibleCurOnly=false; if(checked) rwb.updateInsertMode(true);";var BK=AW+"rwb.visibleCurOnly=true; if(checked) rwb.updateInsertMode(false);";W(BE,BK);}}break;case"addToPanel":if(this.parentBone.parentBone.docViewsSize>1&&!this.parentBone.parentBone.defaultInsertMode){var AW="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('"+mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID+"'), checked = p && p.checked;";var BR="rwb.commands.exec('doAddToPanel','"+S+"',"+AB+");";var BE=AW+"rwb.visibleCurOnly=false;"+BR+"if(checked)rwb.updateInsertMode(true);";var BK=AW+"rwb.visibleCurOnly=true;"+BR+"if(checked) rwb.updateInsertMode(false);";W(BE,BK);}else{this.exec("doAddToPanel",S,AB);}break;case"doAddToPanel":var AN=(S.indexOf("|")>-1)?S.split("|"):[S,null];this.parentBone.currentControl=AN[0];this.parentBone.currentControlSubtype=AN[1];var Bl=this.queryState("selectedContainer");var BS=new Array();var h=microstrategy.updateManager;var AH=this.parentBone.currentControl;this.parentBone.addCtrl(null,Bl,BS,null,null,null,true);this.parentBone.selections.finishAddAllObjs(microstrategy.createAssociativeArray(Bl.lastChild),BS);this.exec("currentControl","cursor");if(BS.length>0){h.add(BS);if(AH==microstrategy.GRAPH_CTL){h.add([h.createActionObject(this.parentBone.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.parentBone.beanPath,[],[],[])]);var e=Bl.lastChild.id;var f=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"":"_0";this.exec("openGraphDropZones",{viewId:e,boneId:"grid_"+e+f,h:getObjHeight(Bl.lastChild),w:getObjWidth(Bl.lastChild),sliceIndex:null});}else{if(this.queryState("appliedTheme")||AH==microstrategy.SUBOBJTYPE_DOC_IMAGE){h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);h.flushAndSubmitChanges();}}}break;case"openGraphDropZones":var h=microstrategy.updateManager;h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);var A2="activeViewID="+S.viewId+"&boneID="+S.boneId+"&zoomFactor="+microstrategy.ZOOM_FACTOR;if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){A2+="&graphHeight="+S.h+"&graphWidth="+S.w;if(S.sliceIndex!=null){A2+="&sliceIndex="+S.sliceIndex;}}toggleShowBean("edtGraphDropZones",true,A2);break;case"setDocCursor":this.parentBone.elem.style.cursor=S;break;case"sizeToGrid":return this.parentBone.selections.sizeToGrid();case"AlignLeft":case"AlignCenter":case"AlignRight":case"AlignTop":case"AlignMiddle":case"AlignBottom":if(this.parentBone.selections.alignObjs(Aq)){this.parentBone.selections.syncUp();}else{return false;}break;case"objalign":if(this.parentBone.selections&&this.parentBone.selections.length>0){var q=this.parentBone.selections.alignObjs(S);if(!q){return q;}this.parentBone.selections.syncUp();}break;case"objsize":if(this.parentBone.selections&&this.parentBone.selections.length>0){var q=this.parentBone.selections.resizeObjs(S);if(!q){return q;}this.parentBone.selections.syncUp();}break;case"openFormatGrid":microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",S||{});break;case"openFormatGraph":case"openFormatControl":var Ar=(Aq=="openFormatControl")?"ftMgr":"ghftMgr";var Bh=microstrategy.activeCXMenu;var C=false;if(Bh&&Bh.clickedElement){if(Bh.clickedElement.className&&Bh.clickedElement.className.indexOf("title_")>=0){C=true;}var p=findTarget(Bh.clickedElement,microstrategy.HTMLATTR_SUBOBJTYPE);if(p&&p.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_CONTAINER_TITLEBAR){C=true;}Bh.clickedElement=null;}if(u){if(Aq=="openFormatControl"){var An=new Array();var Bf=this.parentBone.parentBone.updateManager;An.push(Bf.createActionObject(u,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.parentBone.parentBone.gridBP["72001"],["72001","72002"],["0,-9",(C)?"9":"8"]));Bf.add(An,true);}var e=u.getAttribute("id");toggleShowBean(Ar,true,"activeViewID="+e+"&selectedTypes="+this.parentBone.selections.getTypes());}else{if(BJ){var An=new Array();var Bf=this.parentBone.parentBone.updateManager;An.push(Bf.createActionObject(BJ,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.parentBone.parentBone.gridBP["72001"],["72003","72002"],["0",(C)?"1":"0"]));Bf.add(An,true);var e=BJ.getAttribute("id");toggleShowBean(Ar,true,"activeViewID="+e+"&selectedTypes="+this.parentBone.selections.getTypes());}else{toggleShowBean("ftMgr",true,"selectedTypes="+this.parentBone.selections.getTypes());}}break;case"openBasicConditionalFormatting":case"openSimpleThresholdEditor":case"openAdvConditionalFormatting":case"openAdvThresholdEditor":case"openBasicCondtFmtForHiddenSec":case"openAdvCondtFmtForHiddenSec":var Bn=null;var BX=null;if(Aq=="openBasicConditionalFormatting"||Aq=="openSimpleThresholdEditor"||Aq=="openBasicCondtFmtForHiddenSec"){Bn="edtSimpleThresholds";}else{if(Aq=="openAdvConditionalFormatting"||Aq=="openAdvThresholdEditor"||Aq=="openAdvCondtFmtForHiddenSec"){Bn="edtAdvancedThresholds";}}if(Aq=="openBasicCondtFmtForHiddenSec"||Aq=="openAdvCondtFmtForHiddenSec"){BX=microstrategy.getViewerBone().documentStructureTreeBone.selectedHiddenSection;}else{BX=this.parentBone.selections.firstItem().getAttribute("id");}var AC="";if(u){AC+="activeViewID="+u.getAttribute("id");AC+="&container="+u.getAttribute("id");}else{AC+="container="+BX;AC+="&activeViewID=";}toggleShowBean(Bn,true,AC);break;case"openFormatDMetric":var BC=S[0].getAttribute("key");var AZ=S[0].getAttribute("dsId");toggleShowBean("ftMgr",true,"selectedTypes=obj."+microstrategy.DSSTYPE_USER_METRIC+"&dataSetID="+AZ+"&userMetricKey="+BC);break;case"openSelectDatasetEditor":microstrategy.openFolderBasedBlockEditor("addDatasetEditor","AddDatasetBlockLoader",null,null,null,this.parentBone);break;case"openReplaceDataSetEditor":modelProps=(S)?{oldDSID:S,oldDSType:microstrategy.DSSTYPE_RPT_DEFINITION}:{oldDSID:"",ReplaceAllDS:true};viewProps={multiSelect:false};microstrategy.openFolderBasedBlockEditor("replaceDatasetEditor","AddDatasetBlockLoader",null,modelProps,viewProps,this.parentBone);break;case"formatUserMetric":this.parentBone.applyUserMetricFormat(S);break;case"edtRename":var Az=1;var A9=1;var D="";var BT=null;var At=null;if(Bj&&Bj.dSetId&&Bj.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE)){D=Bj.dSetId;if(u){BT=u.getAttribute("id");A9=0;}}else{A9=1;var Ak=microstrategy.bone("reportObjs_RWWorkingSetStyle");if(Ak){var AE=Ak.selections;if(AE.length>0){var e=AE.getDataSetId();D=(e==null)?microstrategy.primeDataSetId:e;var A1=AE.getActiveUserMetricIndxKey();if(A1){At=A1[0];Az=A1[1];}}else{D=microstrategy.primeDataSetId;}}else{D=microstrategy.primeDataSetId;}}var M="";M+=(A9!=null)?"&formulaMode="+A9:"";M+=(Az!=null)?"&activeElemIndx="+Az:"";M+=(BT!=null)?"&activeViewID="+BT:"";M+=(At!=null)?"&activeUserMetricId="+At:"";M+=(D!=null)?"&activeDatasetID="+D:"";toggleShowBean("formula",true,M);break;case"edtDMetric":var h=this.parentBone.parentBone.updateManager,BI=microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE,BZ=this;if(BI&&h.newActions){h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[],null)]);h.flushAndSubmitChanges(false,{success:function(){BZ.exec("doEdtDMetric",S);}});}else{this.exec("doEdtDMetric",S);}break;case"doEdtDMetric":var h=this.parentBone.parentBone.updateManager,A6=mstrApp.getMsgID();var Ab={success:function(x){h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);h.flushAndSubmitChanges();}};var BO=microstrategy.findBone(this.parentBone.selections.getSelectedGrid());if(BO){var AT=microstrategy.bone("rwb_viewer")["datasetInfos"],Bh=microstrategy.activeCXMenu,AX=BO.dSetId,Bk=BO.gridStructureInfo,AD={datasets:AT,dsid:AX,msgID:A6},Au=[],a,X,AF,m;if(Bh&&Bh.getAttribute(microstrategy.HTMLATTR_DSS_ID)!==null){a=Bh.getAttribute(microstrategy.HTMLATTR_DSS_ID);X=Bh.getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME);AF=Bh.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);m=Bh.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH);}else{var BP=Bk&&Bk.metricAxis&&Bk.metricAxis.units&&Bk.metricAxis.units[0];if(BP){a=BP.dssId;X=BP.alias;AF=BP.dssType;m=BP.depth;}else{AF=4;m=0;}}var R=function(x){mstrmojo.xhr.request("POST",mstrConfig.taskURL,Ab,{taskId:"mojoRWManipulation",rwb:h.getRWBState(),messageID:A6,suppressData:true,params:JSON.stringify({actions:x,style:{params:{treesToRender:0},name:"RWIVEMojoStyle"}})});};if(Aq==="doEdtDMetric"){AD.metricId="";AD.action={cmd:"editNew",refOi:{did:a,n:X}};AD.onApplyMetricCallback=function(x){Au.push({act:"addDerivedMetricToDataset",dsid:AX,formula:x.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(x.tokenStreamXML),name:x.alias,afb:x.afb,sfb:x.sfb,newObjectIds:["$GUID_135"]});Au.push({act:"updateTemplate",keyContext:BO.RWUnitId,actions:[{act:"addUnit",unitId:"$GUID_135",unitType:AF,unitPos:++m,dsId:AX,isFirst:!Bk||Bk.isEmptyTemplate}]});R.call(this,Au);};}microstrategy.openDerivedMetricEditor(AD);}break;case"edtResize":if(u){var e=u.getAttribute("id");toggleShowBean("resizeRW",true,"activeViewID="+e);}break;case"edtPageSetup":case"openPageSetupSectionsTab":case"edtDocProps":var BG=0;if(Aq=="openPageSetupSectionsTab"){BG=4;}else{if(Aq=="edtDocProps"){BG=7;}}var AM=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?0:this.parentBone.parentBone.currentRWViewMode;microstrategy.openBlockLoaderEditor("rwDocPropsEditor","RWDocPropertiesEditor",{selectedIndicesList:BG},{currentRWViewMode:AM,featureMode:this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE)});break;case"visualizationsEditor":if(u){var e=u.getAttribute("id");if(this.parentBone.parentBone){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}toggleShowBean("visualizationsEditor",true,"activeViewID="+e);}break;case"visualizationsEditorRW":toggleShowBean("visualizationsEditor",true,"activeViewID=");break;case"visualizationsEditorRWLayout":toggleShowBean("visualizationsEditor",true,"activeViewID=&activeTabID=-1");break;case"edtSubtotals":if(u){var e=u.getAttribute("id");toggleShowBean("subtotalsDHTMLRW",true,"activeViewID="+e);}break;case"edtSubtotalsOldIServer":if(u){var e=u.getAttribute("id");toggleShowBean("subtotalsDHTMLRWOldIServer",true,"activeViewID="+e);}break;case"edtSort":if(u&&Bj&&Bj.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE)){this.exec("edtSortGrid",S);}else{this.exec("edtSortRW",S);}break;case"edtSortGrid":if(u){var BT=u.getAttribute("id");microstrategy.openAdvSortEditor({beanPath:this.parentBone.parentBone.beanPath+"."+BT,subtotalPosition:Bj&&Bj.subtotalPosition,isDocDesignMode:microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE,sourceAxis:S&&S[0],sourceType:S&&S[1],targetGrid:Bj,taskParams:{taskId:"RWExecute",messageID:mstrApp.getMsgID(),gridStyle:"AdvSortDataStyle",partialDisplayKeys:BT,styleName:"RWGridStyle",sessionState:mstrApp.sessionState}});}break;case"graphZones":if(Bj&&Bj.toggleZonesEditor){var Aw=Bj.zonesEditor?false:true;Bj.toggleZonesEditor(null,Aw);}break;case"edtSortRW":toggleShowBean("sortEditorRWDoc",true,"");break;case"vfeRWGrid":if(u){var U=u.getAttribute("id"),BM=this.parentBone,K=BM.parentBone,h=K.updateManager,e="mfe",Ay={};var Am=function(){if(!window.mstrmojo||!mstrmojo.fe||!mstrmojo.fe.FilterEditor){microstrategy.mojoLoader.loadWidget({bundle:"mojo-fe.js",callback:Bg});}else{mstrmojo.locales.load(Bg);}},Bg=function(){var y={taskId:"getRWGridViewFilter",nodeKey:U,rwb:h.getRWBState(),msgID:K.messageID};var x={success:function(Br){Br.scriptClass="mstrmojo.Obj";var Bq=mstrmojo.insert(Br);BD(Bq);},failure:function(Bq){mstrmojo.err("Failed to load filter data. ");}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,x,y);},c=function(y,Br){var x,Bq=y.nds;if(y.ph){Br[y.ph.idx]=true;}else{if(Bq){for(x=0;x<Bq.length;x++){c(Bq[x],Br);}}}return Br;},BD=function(x){w=e&&window.mstrmojo&&mstrmojo.all[e];var y=microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;if(!w){w=mstrmojo.insert({id:e,scriptClass:"mstrmojo.fe.FilterEditor",onUpdateBrowseElementsParams:function(Br,Bq){Br.datasetID=this.model.dsid;Br.messageID=this.model.messageID;Br.templateNodeKey=U;},disableElementsBrowsing:function(Bq){return y&&Bq.da;}});w.walk.getAttributeForms=function(Bq){return mstrmojo.rw.ConditionWalk.getAttForms(Bq,microstrategy.bone("rwb_viewer")["datasetInfos"]);};}x.targets=mstr.$A.filter(x.targets,{filter:function(Bq){return !Bq.olap;}},"filter");x.targets=mstr.$A.filter(x.targets,{filter:function(Bq){switch(Bq.t){case 1:return(Bq.st!==257);case 47:return Bq.st==12033;}return true;}},"filter");w.set("onSave",Ao);w.set("model",x);if(w.mainExpr.items.length>0){Ay=c(w.mainExpr.items[0],Ay);}w.open();},Ao=function(Bs){var Bt=mstrmojo.fe.FilterUtils.getExprXml(Bs.expr),x=mstrmojo.fe.FilterUtils.getExprXml(Bs.limitExpr),Bx=microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;var Bq=[h.createActionObject(null,mstrUpdateManager.SET_GRID_VIEW_FILTER,K.beanPath,["2048012","2048207","2048138","2048274"],[U,Bt,"1","1"],[]),h.createActionObject(null,mstrUpdateManager.SET_GRID_VIEW_LIMIT,K.beanPath,["2048012","2048207","2048018"],[U,x,Bx],[])];var Bv={};if(w.mainExpr.items.length>0){Bv=c(this.mainExpr.items[0],Bv);}var By=[];for(key in Ay){if(!Bv[key]){By.push(key);}}if(By.length>0){var Bu=U+"_"+By.join("_");Bq.push(h.createActionObject(null,mstrUpdateManager.REMOVE_TARGETED_PLACEHOLDERS,K.beanPath,["2048285"],[Bu],[]));}var y=JSON.stringify(Bv)!="{}";if(y){Bq.push(h.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,K.beanPath,["2048065","2048018"],[mstrUpdateManager.createPropertyEditString(null,"DocumentVersion",10,true,"RWDocumentProperties"),Bx],[]));}var Bw=function(){K.checkAndDisableFlashDefaultMode(h,Bq);h.add(Bq);h.flushAndSubmitChanges();},Br=function(){w.open();};if(y){K.showWarningMessageForUnsupportFeature(Bw,Br);return ;}Bw();};if(h.hasChangesToSubmit()||K.isModified){K.callbackOnReload=Am;h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);h.flushAndSubmitChanges();}else{Am();}}break;case"pasteFormat":var Bo=this.parentBone.selections;var d=mstr.utils.Arrays.fromHashValues(Bo.objCache.copyBuffer.items);var Q=(d)?this.parentBone.parentBone.objProps.pasteFormat(d[0],Bo.items,true):null;if(Q){Bo.syncUp();}break;case"setCtrlDft":case"setDefaults":this.parentBone.parentBone.objProps.setDefaultFormat(this.parentBone.selections.firstItem());break;case"applyCtrlDft":case"applyDefaults":var Bo=this.parentBone.selections.items;this.parentBone.parentBone.objProps.applyCtrlDft(Bo,true);this.parentBone.selections.resizeSubSection();this.parentBone.selections.resizeUnitsInFP();break;case"edtProps":microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",{});break;case"fmtGridCells":this.exec("edtPropsTabSelected",10);break;case"edtPropsTabSelected":microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",{selectedIndicesList:S});break;case"addImg":this.parentBone.openAddImagePropertiesEditor();break;case"cancelImg":this.parentBone.deleteItems(this.parentBone.selections.items,bIsFirefox);this.adjustImageSizeFlag=false;break;case"deleteStubImg":if(this.parentBone.stubImage!=null){this.parentBone.deleteItems(microstrategy.createAssociativeArray(this.parentBone.stubImage),true);this.parentBone.setStubImage(null);}break;case"setStubImage":this.parentBone.setStubImage(this.parentBone.selections.firstItem());break;case"deleteSelections":this.parentBone.promptDeleteItems(this.parentBone.selections.items,true);break;case"cancelSelectorCreation":this.parentBone.deleteItems(this.parentBone.selections.items,false);break;case"deleteFromPortal":var Bm=document.getElementById(S);if(Bm){this.parentBone.promptDeleteItems(microstrategy.createAssociativeArray(Bm),true);}break;case"minimizePortal":var Bm=document.getElementById(S);if(Bm){var AI=this.parentBone.styleObj.getAttValue(Bm,microstrategy.HTMLATTR_WINDOW_STATE);this.parentBone.styleObj.setAttValue(Bm,microstrategy.HTMLATTR_WINDOW_LAST_STATE,AI);this.parentBone.minimizePortal(microstrategy.createAssociativeArray(Bm),"windowState",microstrategy.WINDOW_STATE_MINIMIZED,true);}break;case"maximizePortal":var Bm=document.getElementById(S);if(Bm){var AJ=this.parentBone.styleObj.getAttValue(Bm,microstrategy.HTMLATTR_WINDOW_LAST_STATE);this.parentBone.styleObj.setAttValue(Bm,microstrategy.HTMLATTR_WINDOW_LAST_STATE,"");this.parentBone.maximizePortal(microstrategy.createAssociativeArray(Bm),"windowState",microstrategy.WINDOW_STATE_MAXIMIXED,true);if(AJ!=microstrategy.WINDOW_STATE_MAXIMIXED){if(this.refreshOnWindowChange(Bm,microstrategy.findBone(Bm))){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}}mstrDocCommandsImpl.syncGridWidth(Bj);}break;case"restorePortal":var Bm=document.getElementById(S);if(Bm){var AJ=this.parentBone.styleObj.getAttValue(Bm,microstrategy.HTMLATTR_WINDOW_LAST_STATE);this.parentBone.styleObj.setAttValue(Bm,microstrategy.HTMLATTR_WINDOW_LAST_STATE,"");this.parentBone.restorePortal(microstrategy.createAssociativeArray(Bm),"windowState",microstrategy.WINDOW_STATE_NORMAL,true);if(AJ!=microstrategy.WINDOW_STATE_NORMAL){if(this.refreshOnWindowChange(Bm,microstrategy.findBone(Bm))){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}}mstrDocCommandsImpl.syncGridWidth(Bj);}break;case"back":case"front":case"oneBack":case"oneFront":this.parentBone.selections.sendTo(Aq);break;case"sendTo":this.parentBone.selections.sendTo(S);break;case"autoSizeImg":var An=new Array();this.parentBone.autoSizeImages(0,false,this.parentBone.selections.items,An);this.parentBone.parentBone.updateManager.add(An);break;case"groupProp":var Aa=this.parentBone.selections.getSelectedSubsection();if(Aa){toggleShowBean("gbeb",true,"activeGroupby="+Aa.parentBone.groupID);}break;case"WebHyperLinkEditor":var Bh=this.parentBone.selections.firstItem();var I=Bh?Bh.id:null;if(Bh.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var BO=microstrategy.findBone(Bh);if(BO&&BO.selections){Bh=BO.selections.getItems()[0];}}var A2="activeObjKey="+I;if(Bh){var N=Bh.getAttribute(microstrategy.HTMLATTR_DSS_ID);var Ac=Bh.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(N&&Ac){A2+="&activeUnitID="+N;A2+="&activeUnitType="+Ac;}A2+="&renderPromptsOnly=false";toggleShowBean("webHyperLinkEditor",true,A2);}break;case"FilterDetailsProperties":var AQ=this.parentBone.selections.length==0;var g={};if(this.parentBone.selections.isActive()&&!this.parentBone.selections.isMulti()&&this.parentBone.selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)){g.objId=this.parentBone.selections.firstItem().getAttribute(microstrategy.HTMLATTR_ID);AQ=true;}if(AQ){microstrategy.openDataBasedBlockEditor(null,"FilterDetailsEditorBlockLoader",this.parentBone.parentBone.beanPath,g);}break;case"unlinkTheme":console.log("TODO unlink the theme and apply copy as theme action");var h=microstrategy.updateManager,k=this.queryState("appliedThemeID"),K=this.parentBone.parentBone,Bo=this.parentBone.selections.items,BA=[];for(var e in Bo){BA.push(e);}h.add([h.createActionObject(null,mstrUpdateManager.APPLY_THEME,K.beanPath,["2048292","2048076","2048293"],[k,BA.join(mstrUpdateManager.ITEM_SEPARATOR),false])]);h.flushAndSubmitChanges();break;case"applyTheme":var K=this.parentBone.parentBone;microstrategy.showApplyThemeEditor(false,false,function(y,Bq){var x=microstrategy.updateManager;x.add([x.createActionObject(null,mstrUpdateManager.APPLY_THEME,K.beanPath,["2048292","2048076","2048293"],[y,"",Bq])]);x.flushAndSubmitChanges();});break;case"applyThemeOnNode":var K=this.parentBone.parentBone,Bo=this.parentBone.selections.items,BA=[];microstrategy.showApplyThemeEditor(true,this.queryState("appliedThemeAsLink"),function(y,Bq){var x=microstrategy.updateManager;for(var Br in Bo){BA.push(Br);}x.add([x.createActionObject(null,mstrUpdateManager.APPLY_THEME,K.beanPath,["2048292","2048076","2048293"],[y,BA.join(mstrUpdateManager.ITEM_SEPARATOR),Bq])]);x.flushAndSubmitChanges();});break;case"saveAsTheme":var K=this.parentBone.parentBone,h=K.updateManager;if(h.hasChangesToSubmit()||!!K.isModified){K.callbackOnReload=function(){microstrategy.showSaveAsThemeEditor();};h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);h.flushAndSubmitChanges();}else{microstrategy.showSaveAsThemeEditor();}break;case"insertSectionAbove":case"insertSectionBelow":this.exec("mngSections",Aq=="insertSectionAbove"?"above":"below");break;case"mngSections":switch(S){case"above":case"left":var Aa=this.parentBone.selections.getSelectedSubsection();if(Aa){Aa.insertSubSectionAbove();}break;case"below":case"right":var Aa=this.parentBone.selections.getSelectedSubsection();if(Aa){Aa.insertSubSectionBelow();}break;case"delete":showMessage({contents:microstrategy.descriptors.getDescriptor("3316"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.parentBone.parentBone.id+"').doc.sections['"+this.parentBone.currentSection.id+"'].subsections['"+this.parentBone.currentSection.currentSubSection.id+"'].deleteSubSection();",type:mstrMsgBoxImpl.MSG_WARNING});break;}break;case"number":case"deltaDecimal":this.parentBone.selections.setNumberFormat(Aq,S);this.parentBone.selections.syncUp();break;case"DocPropertyChanges":this.parentBone.processDocPropertyChanges(S);break;case"SyncSelections":if(this.parentBone.selections&&this.parentBone.selections.isActive()){this.parentBone.selections.syncUp();}break;case"addObj":this.parentBone.addObj("5","5",microstrategy.findBone(this.parentBone.selections.firstItem()),S,null,microstrategy.SNAP_OFF);break;case"addObjs":var Bd=microstrategy.findBone(this.queryState("selectedSection"));Bd.ondrop(Bd.elem,S);break;case"addObjsWithFormat":var Bd=microstrategy.findBone(this.queryState("selectedSection"));Bd.addObjsWithFormat(5,5-this.parentBone.parentBone.elem.scrollTop,S[0],Bd.elem,S[1],microstrategy.SNAP_OFF,null,false);break;case"addObjsAsLinked":var Bd=microstrategy.findBone(this.queryState("selectedSection"));Bd.addObjsWithFormat(5,5-this.parentBone.parentBone.elem.scrollTop,S[0],Bd.elem,S[1],microstrategy.SNAP_OFF,null,true);break;case"addasText":var A3=this.queryState("selectedSection");if(A3!=null){var A0=getObjSumLeftScrolled(A3)+5;var Ax=getObjSumTopScrolled(A3)+5;var BS=new Array();var AY=new Array();for(var A5 in S){BS=this.parentBone.addCtrl(new Rect(Ax,null,null,A0),A3,BS,microstrategy.SUBOBJTYPE_DOC_TEXT,S[A5].getAttribute("ds"),null,microstrategy.SNAP_OFF);A0=A0+getObjWidth(A3.lastChild)+10;AY.push(A3.lastChild);}this.parentBone.selections.finishAddAllObjs(AY,BS,false);this.parentBone.parentBone.updateManager.add(BS);}break;case"autotext":if(this.parentBone.parentBone.docViewsSize>1&&!this.parentBone.parentBone.defaultInsertMode){var AW="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('"+mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID+"'), checked = p && p.checked;";var BR="rwb.commands.exec('doAutotext','"+S+"');";var BE=AW+"rwb.visibleCurOnly=false;"+BR+"if(checked)rwb.updateInsertMode(true);";var BK=AW+"rwb.visibleCurOnly=true;"+BR+"if(checked) rwb.updateInsertMode(false);";W(BE,BK);}else{this.exec("doAutotext",S);}break;case"doAutotext":if(this.parentBone.selections&&!this.parentBone.selections.isMulti()&&this.parentBone.selections.isActive()){var BY=this.parentBone.selections.firstItem();if(BY!=null){var A4=BY.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);var L=BY.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(A4==microstrategy.SUBOBJTYPE_DOC_TEXT){this.parentBone.appendToTextField(this.parentBone.getAutoTextMacroCode(S),BY);this.parentBone.editText(null,BY);}else{if(L==microstrategy.OBJTYPE_DOC_OBJECT&&A4==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var J=microstrategy.findBone(BY);BY=J.getCurrentPanel().elem;}else{if(L!=microstrategy.OBJTYPE_DOC_SUBSECTION){BY=microstrategy.findAncestor(BY.parentNode);}}var Bi=new Rect(getObjSumTopScrolled(BY)+1,null,null,getObjSumLeftScrolled(BY)+1);this.parentBone.addCtrl(Bi,BY,null,microstrategy.SUBOBJTYPE_DOC_TEXT,this.parentBone.getAutoTextMacroCode(S));}}}break;case"addToTextField":this.parentBone.appendToTextField(S[0],S[1],S[2]);break;case"addToGrouping":var Bf=this.parentBone.parentBone.updateManager;var BS=new Array();var Bm=S.getItems();for(var A5=0;A5<Bm.length;A5++){var G=false;var n=Bm[A5].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);var BQ=Bm[A5].getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);var A=Bm[A5].getAttribute(microstrategy.HTMLATTR_DSS_ID);if(microstrategy.isValidGroupByType(n)){var BN=this.parentBone.parentBone.commands.queryState("groupByDssIds");G=(BN.indexOf("|"+A+"|")==-1);}if(G){BS.push(Bf.createActionObject(this,mstrUpdateManager.ADD_GROUP,this.parentBone.parentBone.beanPath,["2048004","2048005","2048106","2048031"],[A,n,BQ,S.getDataSetId()],[]));}}Bf.add(BS);Bf.flushAndSubmitChanges();break;case"editTextField":this.parentBone.editText(null,S);break;case"maxZIndex":return this.parentBone.getMaxZIndex();break;case"edtColorPicker":var A2=S.split("|");this.parentBone.openDialog("edtColorPicker",null,null,microstrategy.servletName+"."+microstrategy.pageName,{activeBoneID:A2[0],activeControlID:A2[1],currentColor:A2[2]});this.parentBone.parentBone.updateManager.replaceURL("selectedTabOptions",A2[3]);this.parentBone.parentBone.updateManager.flushAndSubmitChanges();break;case"graphEdtColorGradient":case"edtColorGradient":var A2=S.split("|");var As="parentBoneID="+A2[0]+"&controlID="+A2[1]+"&activeViewKey="+A2[2]+"&graphObjectID="+A2[3]+"&graphSeriesID="+parseInt(A2[4],10);if(A2.length>6){As+="&color1="+A2[5]+"&color2="+A2[6]+"&transitionType="+A2[7]+"&angle="+A2[8]+"&xOffset="+A2[9]+"&yOffset="+A2[10];microstrategy.updateManager.replaceURL("selectedTabOptions",A2[11]);}this.parentBone.openDialog("edtColorGradient",As,null,microstrategy.servletName+"."+microstrategy.pageName);microstrategy.updateManager.flushAndSubmitChanges();break;case"toggleSnap":microstrategy.SNAP_OFF=!microstrategy.SNAP_OFF;microstrategy.updateBrowserSetting("snapOff",microstrategy.SNAP_OFF);break;case"objBrowser":case"toggleAccordion":return microstrategy.toggleAccordion();case"groupBy":case"toggleGroupBy":return microstrategy.toggleEditor("pbb_GroupByStyle","pbb");case"docSelectedVisualization":var An=new Array();var A2=S.split("|");this.parentBone.setVisualizationSettings(null,A2[0],null,A2[1],An,null,(this.parentBone.parentBone.isLayoutLevelVis)?"-1":null);this.parentBone.parentBone.updateManager.add(An);if(!this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS)){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}return true;case"setVisProps":var A2=S.split("|");var BS=new Array();this.parentBone.setVisualizationSettings(null,null,null,null,BS,A2[0],A2[1],true);this.parentBone.parentBone.updateManager.add(BS,true);return true;case"createPanel":return this.parentBone.createPanel();case"secondaryDataSourcesEditor":if(u){var e=u.getAttribute("id");toggleShowBean("secondaryDataSourcesEditor",true,"activeViewID="+e+"&secondaryKeys="+S[0]+"&visEditorId="+S[1]);}break;case"visPropsEditor":var AC="scope="+S[0]+"&selVis="+S[1];toggleShowBean("visPropsEditor",true,AC);break;case"gridMode":case"graphMode":case"gridGraphMode":case"visualizationMode":case"tbanding":case"tOutline":case"toggleattforms":case"fittocontent":case"fittowindow":case"comboToggleButton":case"tsubtotals":case"checkMergeRowHeader":case"checkMergeColHeader":case"checkLockRowHeader":case"checkLockColHeader":case"ShowThreshold":case"quickThresholds":case"swapAxes":case"formatGridBulk":case"formatGraphBulk":case"autostyle":case"subtotalChanges":case"addQuickTotals":case"cancelGridFormatRequest":case"toggleHideNullsOrZeros":if(Bj&&Bj.commands){return Bj.commands.exec(Aq,S);}return false;case"gridGraphMode":if(Bj&&Bj.commands){var BS=[];this.parentBone.formatSizeMode(microstrategy.createAssociativeArray(u),"heightMode","0",BS);this.parentBone.formatSizeMode(microstrategy.createAssociativeArray(u),"widthMode","0",BS);microstrategy.updateManager.add(BS);return Bj.commands.exec(Aq,S);}case"gridSelectedVisualization":if(Bj&&Bj.commands){var AV=Bj.commands.exec("selectedVisualization",S);this.parentBone.parentBone.observer.notifyAll("onselectionchange");return AV;}return false;case"synchronizeGridSelections":if(this.parentBone.selections){this.parentBone.selections.fetchObjectFormatLevelFromGrid();}break;case"tbUnitSelector":if(this.queryEnabled("onepanelstack")){var V=null;if(S==1){V=0;}this.parentBone.selections.setObjectFormatLevel("Panels",this.parentBone.selections.resolvePanelsFormat(S,V));}else{if(S.indexOf("**grid")>-1){Bj.graphSelected=false;this.exec("tbGridUnitSelector",S.replace("**grid",""));}else{if(S.indexOf("**graph")>-1){Bj.commands.exec(Aq,S);}else{this.exec("tbGridUnitSelector",S);}}}break;case"tbValueSelector":if(this.queryEnabled("onepanelstack")){this.parentBone.selections.setObjectFormatLevel("Panels",this.parentBone.selections.resolvePanelsFormat(null,S));}else{if(this.queryEnabled("onecontrol")){this.parentBone.selections.setObjectFormatLevel("Control",this.parentBone.selections.resolveControlFormat(null,S));}else{if(Bj.graphSelected){Bj.commands.exec(Aq,S);}else{this.exec("tbGridValueSelector",S);}}}break;case"tbGridUnitSelector":case"tbGridValueSelector":var Af,BU;if(Aq=="tbGridUnitSelector"){Af=S;if(Af<microstrategy.GRID_OTHER){this.parentBone.selections.addToSelection(false,findTarget(Bj.elem,microstrategy.HTMLATTR_OBJTYPE));if(Af==microstrategy.GRID_UNIT_CONTAINER){BU=1;}}}else{BU=S;}this.parentBone.selections.setObjectFormatLevel(Aq,this.parentBone.selections.resolveGridFormat(Af,BU));return false;case"setUnitFormatLevels":var Ah=(Bj)?"Grid":(BV?"Panels":"Control");var Af,BU;if(S.src=="edtUnitSelector"){Af=S.v;if(Bj){if(Af<microstrategy.GRID_OTHER){this.parentBone.selections.addToSelection(false,findTarget(Bj.elem,microstrategy.HTMLATTR_OBJTYPE));if(Af==microstrategy.GRID_UNIT_CONTAINER){BU=1;}}}}else{BU=S.v;}var BB=this.parentBone.selections["resolve"+Ah+"Format"](Af,BU);this.parentBone.selections.setObjectFormatLevel(Ah,BB);this.parentBone.selections.verifyFormatLevels(S.t);break;case"resetObjectFormatLevel":if(this.parentBone&&this.parentBone.selections){this.parentBone.selections.resetObjectFormatLevel();}break;case"edtTabChange":this.parentBone.selections.verifyFormatLevels(S);break;case"formatMultiLevelBulk":for(var A5=S.length-1;A5>=0;A5--){var A8=S[A5].split("|");if(A8[0]==microstrategy.FORMAT_LEVEL_FLAG_DOC){var AU=S.splice(A5,1)[0];this.exec(A8[1],A8[2]);}}break;case"MultiLevelPropertyChanges":for(var A5=S.length-1;A5>=0;A5--){if(S[A5].level==microstrategy.FORMAT_LEVEL_FLAG_DOC){var AR=S.splice(A5,1)[0];this.exec(AR.cmdId,AR);}}break;case"showFunctionBuilder":toggleShowBean("functionWizard",true,"formulaMode=2");break;case"drill":case"drillNW":this.parentBone.selections.performDrill(S,(Aq=="drillNW"));break;case"execLink":this.execLink(S);break;case"cancelEdit":if(S){this.parentBone.parentBone.updateManager.undo(S);}if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.cancelPropertyEdit(S);}break;case"save":var h=this.parentBone.parentBone.updateManager;var BS=new Array();var z=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"true":"false";var AP=(this.parentBone.parentBone.saveFolderId)?this.parentBone.parentBone.saveFolderId:this.parentBone.parentBone.parentFolderID;BS.push(h.createActionObject(this.elem,mstrUpdateManager.RW_SAVE_AS,microstrategy.servletName,["3013","3014","3017"],["false",AP,z],[]));h.add(BS);h.useIframe=false;h.flushAndSubmitChanges();break;case"ctrlJustAdded":if(!this.queryState("lock")){this.exec("cursor");}break;case"cursor":this.parentBone.parentBone.insertionControlLocked=false;this.exec("currentControl",Aq);this.parentBone.parentBone.observer.notifyAll("insertionControlModified");break;case"lock":if(!this.queryState("cursor")){this.parentBone.parentBone.insertionControlLocked=!this.parentBone.parentBone.insertionControlLocked;}this.parentBone.parentBone.observer.notifyAll("insertionControlModified");break;case microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:Aq=Aq+"|false";case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|0":case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|1":S=Aq.split("|")[1];Aq=Aq.split("|")[0];case microstrategy.GRAPH_CTL:case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|FP":case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|TC":case microstrategy.SUBOBJTYPE_DOC_TEXT:case microstrategy.BUTTON_CTL:this.parentBone[Aq]=S;if((this.parentBone.currentControl==Aq&&!this.isSubtypedCmd(Aq))||(this.isSubtypedCmd(Aq)&&S==this.parentBone.currentControlSubtype)){if(this.queryState("lock")){this.exec("cursor");break;}else{this.parentBone.parentBone.insertionControlLocked=true;}}else{if(this.queryState("lock")){this.parentBone.parentBone.insertionControlLocked=false;}}if(Aq==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&S.indexOf(";")>=0){Aq=microstrategy.SUBOBJTYPE_DOC_WIDGET;}this.exec("currentControl",this.isSubtypedCmd(Aq)?Aq+"|"+S:Aq);this.parentBone.parentBone.observer.notifyAll("insertionControlModified");break;case"visFlashMode":case"visAjaxMode":case"autoArrange":if(Bj){Bj.commands.exec(Aq,"0");}break;case"FontFamily":case"FontSize":case"Bold":case"Italic":case"Underline":case"FillColor":case"FontColor":if(Bj){if(this.parentBone.selections.gridUnitFormatX!=microstrategy.GRID_UNIT_CONTAINER||Bj.graphSelected){if(this.passToGrid(Bj,Aq,S)){return true;}}else{microstrategy.formatType=this.parentBone.selections.gridValueFormatX;}}if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.setFormat(Aq,S,AB);this.parentBone.selections.syncUp();}break;case"GridHorizontal":this.passToGrid(Bj,Aq,S);break;case"IncreaseDecimal":case"DecreaseDecimal":if(!this.passToGrid(Bj,Aq,S)){this.exec("deltaDecimal",(Aq=="IncreaseDecimal")?"1":"-1");}break;case"Currency":case"IntlCurrency":if(!this.passToGrid(Bj,Aq,S)){this.exec("number","1");}break;case"Percent":if(!this.passToGrid(Bj,Aq,S)){this.exec("number","2");}break;case"Comma":if(!this.passToGrid(Bj,Aq,S)){this.exec("number","3");}break;case"lnstyle":case"lncolor":case"LineColor":if(this.parentBone.selections.isGridContainerSelected()||!this.passToGrid(Bj,Aq,S)){if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.setBorderFormat(Aq,S);this.parentBone.selections.syncUp();}}break;case"borders":if(this.parentBone.selections.isGridContainerSelected()||!this.passToGrid(Bj,Aq,S)){if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.enableBorders(S);this.parentBone.selections.syncUp();}}break;case"pivotButtons":var BH=this.parentBone.parentBone.isFeatureAvailable("check-show-pivot-buttons")?0:1;h=this.parentBone.parentBone.updateManager;var AS=h.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.parentBone.beanPath,["5003","5004"],["showPivot",BH],[],null);h.add([AS],true);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}h.flushAndSubmitChanges();break;case"sortButtons":BH=this.parentBone.parentBone.isFeatureAvailable("check-show-sort-buttons")?0:1;h=this.parentBone.parentBone.updateManager;AS=h.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.parentBone.beanPath,["5003","5004"],["sSrt",BH],[],null);h.add([AS],true);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}h.flushAndSubmitChanges();break;case"createAutowireSelector":case"removeTargets":h=this.parentBone.parentBone.updateManager;var Av=microstrategy.activeCXMenu;var AA=Av.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)||microstrategy.DSSTYPE_METRIC;var e=Av.getAttribute(microstrategy.HTMLATTR_DSS_ID)||"";var AG=this.parentBone.selections.getSelectedGrid().getAttribute("id");if(Aq=="createAutowireSelector"){var A3=this.parentBone.selections.getSelectedSubsection();var Aj=A3.getTargets({excludeTargets:[AG]}).keys;var AS=h.createActionObject(null,mstrUpdateManager.ADD_CONTROL_TO_GRID,this.parentBone.parentBone.beanPath,["2048007","2048012","2048001","2048009","2048129","2048116"],[AG,"",e,AA,"",Aj.join(CLIPBOARD_ITEM_SEPARATOR)],[]);}else{var AS=h.createActionObject(null,mstrUpdateManager.REMOVE_CONTROL_FROM_GRID,this.parentBone.parentBone.beanPath,["2048007","2048130","2048001","2048009"],[AG,"",e,AA],[],null);}h.add([AS],true);h.flushAndSubmitChanges();break;case"disableAutowire":this.parentBone.processDocPropertyChanges([{cmdId:"Autowire",memo:{},value:false}]);break;case"mojoVisPropsEditor":if(mstr.utils.ISIE8){return showMessage({contents:"This page is not supported in your browser",elements:microstrategy.OK_BUTTON,buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("219")},type:mstrMsgBoxImpl.MSG_WARNING});}var BZ=this,K=this.parentBone.parentBone;h=K.updateManager,e="mstrVisPropsEditor",openVPE=function(){microstrategy.showWait(false);mstr.$obj("widgetBoneTranslator").set("mojoVisPropsChanged",false);var x=mstrmojo.insert({scriptClass:"mstrmojo.mstr.VisPropsEditor",id:e,nodeKey:BZ.parentBone.selections.getSelectionsKey()[0],messageID:K.messageID,rwb:K.updateManager.getRWBState(),executionMode:BZ.isDesignMode()?1:null,zIndex:microstrategy.getMaxZIndex()+1,visible:true,onClose:function(){this.destroy();},onOK:function(){mstr.$obj("widgetBoneTranslator").set("mojoVisPropsChanged",true);}});x.start();},AL=function(){if(!window.mstrmojo||!mstrmojo.mstr.VisPropsEditor){microstrategy.showWait(true);microstrategy.mojoLoader.loadWidget({bundle:microstrategy.jsBundleDebug?"mojo-vis-props-debug.js":"mojo-vis-props.js",callback:openVPE});}else{openVPE();}};if(h.hasChangesToSubmit()||!!K.isModified){K.callbackOnReload=AL;h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);h.flushAndSubmitChanges();}else{AL();}break;case"transactionEdit":var K=this.parentBone.parentBone,BZ=this;h=K.updateManager,e="mstrTE",openTE=function(){if(!mstrmojo.all[e]){mstrmojo.insert(mstrmojo.txEditor.TransactionEditor);}var Bw=mstrmojo.all[e],x=K.messageID,Br=BZ.parentBone.selections,Bx=Br.isOnlyOneTableSelected()&&Br.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK),Bu=Bx?Bx.getTransactionUnitKey():Br.getTransactionUnitKey(),Bq=Bx&&Bx.queryState("TRXObjs"),y=function(B0){var B6=microstrategy.findBone(document.getElementById(BZ.parentBone.prevSelectedId)),B2=B0.rwTxs.tscObjs,Bz=microstrategy.bone("rwb_viewer"),B1=[].concat(Bz.getAvailableAttributes()).concat(Bz.getAvailableMetrics()),B5=Bz.ddic={},B3=B6.tscObjs||[],B4=[].concat(B2);if(B6){var By={};mstr.$A.forEach(B3,function(B7){if(B7.ctl&&B7.ctl.ddic){By[B7.ctl.ctlKey]=mstr.$H.deepClone(B7.ctl);}});mstr.$A.forEach(B4,function(CC){if(CC.ctl&&CC.ctl.ddic){var CA=By[CC.ctl.ctlKey],B7=CC.ctl.ddic,CD={trxsid:true,ctlSrc:true,autoSync:true,targetKeys:true},B9;if(CA){B9=CA.ddic;B9.trxsid=B7.csid;}else{var B8=CC.ctl.ddic.csid,CB=mstr.$A.filter(B1,{filter:function(CF){return CF.dssid.indexOf(B8)>=0;}},"filter");B9={trxsid:B7.trxsid,ctlSrc:CB.length>0?CB[0].dssid:"",autoSync:false,targetKeys:""};}for(var CE in CD){if(CD[CE]){B7[CE]=B9[CE];}}B5[CC.ctl.ctlKey]=CC.ctl;}});mstr.$A.forEach(B4,function(B8){var B7=mstr.$A.findByForm(B3,B8.key,"key");if(B8.edt&&(B7<0||!B3[B7].edt)){var B9=document.getElementById(B8.key);if(B9){mstrmojo.css.addClass(B9,"txttrx");}}});mstr.$A.forEach(B3,function(B8){var B7=mstr.$A.findByForm(B4,B8.key,"key");if(B7<0||!B4[B7].edt){var B9=document.getElementById(B8.key);if(B9){mstrmojo.css.removeClass(B9,"txttrx");}}});B6.tscObjs=B4;}Bz.ddic=B5;},Bv=function(B0,Bz){h.setRWStateInForm(Bz.rwb);if(Bx){var By=Bx.model;By.set("trxInfo",B0.rwTxs);By.raiseEvent({name:"trxInfoChange"});}y(B0,Bz);},Bs={success:function(B0){if(!B0){mstrmojo.alert(B0.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{Bw.mappingTxModel.messageID=x;Bw.mappingTxModel.getNewCtlKey=function(){return microstrategy.OBJ_PREFIX+K.getNextObjId();};Bw.mappingTxModel.onsave=Bv;if(Bq){var By=B0.tscObjs,B2=(By&&By.length)||0,Bz=B2-1;for(;Bz>=0;Bz--){var B3=By[Bz],B1=Bq[B3.key];if(!B1){By.splice(Bz,1);}else{B3.n=B1;}}}Bw.mappingTxModel.set("rwTxs",B0);Bw.mappingTxModel.nodeKey=Bu;Bw.localTxModel.nodeKey=Bu.k;Bw.localTxModel.messageID=x;Bw.localTxModel.set("offTxs",B0);Bw.localTxModel.onsave=function(B4,B5){h.setRWStateInForm(B5.rwb);};Bw.open();}},failure:function(By){mstrmojo.alert(By.getResponseHeader("X-MSTR-TaskFailureMsg"));}},Bt={taskId:"getRWTransactions",nodeKey:Bu.k,messageID:x};if(Bu.sk){Bt.sectionKey=Bu.sk;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,Bs,Bt);},AL=function(){if(!window.mstrmojo||!mstrmojo.all[e]){microstrategy.mojoLoader.loadWidget({bundle:"mojo-txe.js",callback:openTE});}else{openTE();}};if(h.hasChangesToSubmit()||!!K.isModified){K.callbackOnReload=AL;h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);h.flushAndSubmitChanges();}else{AL();}break;case"transactionCondition":var K=this.parentBone.parentBone,BZ=this,h=K.updateManager,e="mstrCTE",Ai=1,B=2,o=4,BL=function(x){h.setRWStateInForm(x.rwb);},Ap=function(){if(!mstrmojo.all[e]){mstrmojo.insert(mstrmojo.condTx.ConditionTransactionEditor);}var B2={ACTION_SELECTOR:0,TEXT_FIELD:1,TEMPLATE_UNIT_CONTROL:2},Bw=mstrmojo.all[e],y=K.messageID,Br=BZ.parentBone.selections,B8={taskId:"getRWTransactionSources",msgID:y},B9={nodeKey:true,ctlKey:true,fieldKey:true,bit:true,taskId:true,msgID:true},CB={};if(Br.isOnlyOneGridSelected()){var Bx=microstrategy.activeCXMenu,x=Bx&&Bx.getAttribute(microstrategy.HTMLATTR_DSS_ID),B6=microstrategy.findBone(Br.getSelectedGrid()),By=B6&&B6.tscObjs||[],B5=By.length,B3,Bt=[];for(B3=0;B3<B5;++B3){var B4=By[B3];if(B4.edt){B4.ctlKey=B4.ctl&&B4.ctl.ctlKey;Bt.push(B4);}}CB.nodeKey=Br.getSelectionsKey()[0];CB.nodeType=B2.TEMPLATE_UNIT_CONTROL;CB.txnObjs=Bt;CB.bit=Ai;}else{if(BZ.queryState("isActionSelector")){var Bu=Br.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);CB.ctlKey=Bu.ctlKey;CB.nodeKey=Bu.nodeKey;CB.nodeType=B2.ACTION_SELECTOR;CB.bit=Ai|o;}else{var B7=Br.firstItem(),Bs=microstrategy.findBone(B7),Bt=(Bs&&Bs.tscObjs)||[],Bv=Br.getSelectionsKey()[0],Bz=mstr.$A.findByForm(Bt,Bv,"key"),CA=Bz>-1&&Bt[Bz].ctl,Bq=CA&&CA.ctlKey;CB.fieldKey=Bv;CB.nodeType=B2.TEXT_FIELD;CB.nodeKey=Br.getTransactionUnitKey().k;CB.bit=B;if(Bq){CB.ctlKey=Bq;CB.bit|=o;}}}var B1={success:function(CC){if(!CC){mstrmojo.alert(CC.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{var CD={fieldGroups:CC.fieldGroups||[],templates:CC.templates||[],bwElements:CC.bwElements||{}};Bw.onsave=BL;Bw.set("messageID",y);Bw.set("source",CD);Bw.set("target",CB);Bw.set("model",{actions:CC.exps,originNodeActionCount:CC.ntc,originCtlActionCount:CC.ctc,originFieldActionCount:CC.ftc});Bw.open();}},failure:function(CC){mstrmojo.alert(CC.getResponseHeader("X-MSTR-TaskFailureMsg"));}};for(var B0 in CB){if(B9[B0]){B8[B0]=CB[B0];}}if(CB.nodeType===B2.ACTION_SELECTOR){B8.nodeKey=B8.ctlKey;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,B1,B8);},AL=function(){if(!window.mstrmojo||!mstrmojo.all[e]){microstrategy.mojoLoader.loadWidget({bundle:"mojo-ctxe.js",callback:Ap});}else{Ap();}};if(h.hasChangesToSubmit()||!!K.isModified){K.callbackOnReload=AL;h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);h.flushAndSubmitChanges();}else{AL();}break;case"docViewsEdit":var K=this.parentBone.parentBone,BZ=this,h=K.updateManager,e="mstrDVE";openDVE=function(){var y=mstrmojo.all[e],Bq=K.messageID,x={success:function(Bs){if(!Bs){mstrmojo.alert(Bs.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{y.initModel(Bs);y.model.msgID=Bq;y.open();}},failure:function(Bs){mstrmojo.alert(Bs.getResponseHeader("X-MSTR-TaskFailureMsg"));}},Br={taskId:"getRWDocumentViews",msgID:Bq,includePreDefined:true};mstrmojo.xhr.request("POST",mstrConfig.taskURL,x,Br);};AL=function(){if(!window.mstrmojo||!mstrmojo.all[e]){microstrategy.mojoLoader.loadWidget({scriptClass:"DocViewsEditor",id:e,bundle:"mojo-dve.js",callback:openDVE});}else{openDVE();}};if(h.hasChangesToSubmit()||!!K.isModified){K.callbackOnReload=AL;h.add([h.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);h.flushAndSubmitChanges();}else{AL();}break;default:if(Bj&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN&&Bj.exec(Aq,S)){}else{if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.setFormat(Aq,S,AB);this.parentBone.selections.syncUp();}}break;}return true;}catch(H){microstrategy.errors.log(H);return false;}};mstrDocCommandsImpl.syncGridWidth=function(B){if(B&&B.commands){var A=B.commands;if(A.queryState("gridMode")==microstrategy.DISPLAY_MODE_GRID&&!B.isTemplateEmpty()&&A.queryState("fittowindow")){A.exec("setColWidthsMode",mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY);if(B.colWidths){B.colWidths.syncCols();}}}};mstrDocCommandsImpl.prototype.execLink=function(G){var D;var E;var B;if(this.parentBone&&this.parentBone.selections){B=this.parentBone.selections.getItems();}if(G.ind!=null){E=G.ind-1;}else{if(B&&B[0]){E=B[0].getAttribute("ind");if(E){E=E-1;}}}if(G.id!=null){D=G.id;}else{if(B&&B[0]){D=B[0].id;}}if(D&&E!=null){var A=microstrategy.bone("rwb_viewer");var F=A.webHyperLinks[D];if(F!=null){var C=F[G.index];if(C!=null){if(C.url!=null){this.execUrlLink(C);}else{this.execDynamiclLink(C,E);}}}}};mstrDocCommandsImpl.prototype.refreshOnWindowChange=function(A,C){var B=this.parentBone.parentBone;return(C&&typeof (C.visualizationMode)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&this.parentBone.styleObj.getAttValue(A,microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&(this.parentBone.styleObj.getAttValue(A,microstrategy.HTMLATTR_DISPLAY_MODE)!=microstrategy.DISPLAY_MODE_GRID||this.parentBone.styleObj.getAttValue(A,microstrategy.HTMLATTR_QUICK_SWITCH)==microstrategy.TRUE)&&!(C.visualizationMode==50&&!B.isEditableViewModeEplus()));};mstrDocCommandsImpl.prototype.execUrlLink=function(A){try{if(A.url&&A.url.indexOf("mailto:")===0){window.open(A.url);return ;}var C=createDynamicForm(microstrategy.addCSRFTokenToURL(A.url));if(A.onw){C.target="_blank";}microstrategy.submitForm(C);return ;}catch(B){}};mstrDocCommandsImpl.prototype.execDynamiclLink=function(B,D){try{var A=B.linkXml[D];microstrategy.execDynamiclLink(B,A,B.onw);}catch(C){microstrategy.errors.log(C);}};mstrDocCommandsImpl.prototype.passToGrid=function(B,A,D){try{if(!B){return false;}B.commands.exec(A,D);return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocCommandsImpl.prototype.isSubtypedCmd=function(A){switch(A){case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.GRAPH_CTL:case microstrategy.BUTTON_CTL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:return true;default:return false;}};mstrDocCommandsImpl.prototype.queryEnabled=function(K,H){try{var E=this.parentBone.selections;var F=this.parentBone.parentBone;if(K&&K.match(/currentControl;|widget;/)){return true;}if(K&&(K.indexOf("autotext;")!=-1)){return this.queryEnabled("autotext");}switch(K){case"panelOverflowSpacingEnabled":return this.queryState("expandPanels")!=0&&this.queryState("ClipOnExport");case"enableGridFormat":return this.parentBone.parentBone.enableGridFormat;case"isUserMetricSelected":return this.isTypeSelectedInOB(microstrategy.DSSTYPE_USER_METRIC);case"isSummaryMetricSelected":return this.isTypeSelectedInOB(microstrategy.DSSTYPE_USER_SUMMARY_METRIC);case"editableViewMode":return(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE);case"edtSortRW":return !this.parentBone.parentBone.noDataset;case"docSelectedVisualization":return this.parentBone.parentBone.isVisualization;case"SupportedOrientations":case"ShowWidgetTitleBar":case"edtDocProps":case"edtPageSetup":case"selectAll":case"unit":case"visualizationsEditorRW":case"openPageSetupSectionsTab":case"openReplaceDataSetEditor":case"openSelectDatasetEditor":case"objBrowser":case"groupBy":case"grid":case"relatedReports":case"rulers":case"save":case"toggleSnap":case"shapesSubmenu":case"widgetsSubMenu":case"selectorSubMenu":case"graphSubMenu":case"buttonSubMenu":case"fontprops":case"numberprops":case"alignprops":case"colorprops":case"layoutColorTabEnabled":case"PaperType":case"PageWidth":case"PageHeight":case"PaperOrientation":case"Scaling":case"ScalePercentage":case"ScalePagesWide":case"ScalePagesTall":case"ScalePageHeaderFooter":case"SectionHorizontalOverflow":case"MarginLeft":case"MarginTop":case"MarginRight":case"MarginBottom":case"minimumPrintArea":case"LayoutFillColor":case"LayoutBorderStyle":case"LayoutAllStyle":case"LayoutAllColor":case"LayoutLeftStyle":case"LayoutLeftColor":case"LayoutTopStyle":case"LayoutTopColor":case"LayoutRightStyle":case"LayoutRightColor":case"LayoutBottomStyle":case"LayoutBottomColor":case"VisibleSections":case"EnableIncFetch":case"IncFetchLevel":case"IncFetchBlockSize":case"allowRemoveExtraColumn":case"showDisplayModes":case"DefaultGridStyle":case"AvailableViewModes":case"AvailableExportModes":case"DefaultViewMode":case"ExecutionFullScreenMode":case"ShowingBarsTemporarily":case"DefaultSelectorsAsFilter":case"PreserveTranslations":case"ShowFloatingToolbars":case"CtlAutoSubmit":case"Autowire":case"AppliedAutowire":case"CalculateDocWidth":case"ShowConditionalFormatting":case"DefaultPageByExportMode":case"ExportRange":case"ExcelGraphFormat":case"EmbeddedFonts":case"MobileDataView":case"UseOneSheetPerLayout":case"UseOneSheetPerGroupElement":case"PromptUserForPagebyExport":case"ExcelEmbedImages":case"IncludeBookmarks":case"ShowBookmarks":case"EmbedFonts":case"GraphFormat":case"GraphQualityDPI":case"isMultiLayout":case"multiLayoutMode":case"EnableToc":case"TOCTitle":case"TOCFontName":case"TOCFontBoldItalic":case"TOCFontSize":case"TOCFontStrikeout":case"TOCFontUnderline":case"TOCFontColor":case"TabLeader":case"WatermarkType":case"WatermarkText":case"WatermarkFontName":case"WatermarkFontBoldItalic":case"WatermarkFontSize":case"WatermarkFontStrikeout":case"WatermarkFontUnderline":case"WatermarkFontColor":case"AutoFontSize":case"TextWashout":case"TextOrientation":case"ImageSource":case"ImageScale":case"ShowTabsForSingleLayout":case"RemoveNullGroups":case"RemoveMissingUnits":case"SingleSourceGrid":case"RWLevelMCEJoin":case"TrimNoSectionData":case"incrFetchEnabled":case"FitPDFContentHeight":case"DisplayPageByBar":case"DisplayRePromptIcon":case"UseAsInfoWindow":case"incrFetchBlockCount":case"incrFetchLevels":case"PreLoadAllPanels":case"PSPreLoadAllPanels":case"gridIfEnabled":case"gridIfMaxRows":case"gridIfRowMode":case"layoutBarStyle":case"layoutBarPosition":case"enableGraphTooltips":case"UseAsInformationWindow":case"InformationWindowPlacement":case"InfoWindowMode":case"TabCloseToDismissInfoWindow":case"TextCopyMode":case"GridCellCopyMode":case"EnableHorizontalSwipeToChange":case"SwipePanelStyle":case"fpAutoSubmit":case"isFilterPanel":case"EnableExport":case"ExcelExportDocumentURL":case"PDFExportDocumentURL":case"TOCFillColor":case"TOCTitleAlignment":case"TOCTitleFontName":case"TOCTitleFontBoldItalic":case"TOCTitleFontSize":case"TOCTitleFontUnderline":case"TOCTitleFontStrikeout":case"TOCTitleFontColor":case"TOCTitleFillColor":case"TOCTitleEnableInherit":case"TOCLeftIndent":case"TOCRightIndent":case"TOCBorderStyle":case"TOCBorderColor":case"TOCBorderWeight":case"TOCTitleSetEnable":case"TOCBorderStyleEnable":case"cursor":case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|0":case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|1":case microstrategy.GRAPH_CTL:case microstrategy.BUTTON_CTL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|FP":case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|TC":case microstrategy.SUBOBJTYPE_DOC_TEXT:case"IncludePageHeaderFooter":case"docViewsEdit":case"EnableZoom":case"ApplyGBToAllLayouts":case"RefreshDocument":case"RefreshFrequency":case"EnableCopyForText":case"EnableCopyForGridCell":case"DocumentThemeColor":case"EnableSwipingToSwitchLayout":case"SetBadgeToValueOnField":case"isNavigationDocument":case"SmartClientDoc":case"OfflineOnCube":case"ShowOfflineUCOnCubeConfig":case"MakePrivate":case"KeepControlTargetsConsistent":return true;case"pageTabEnabled":case"marginTabEnabled":case"layoutMobileTabEnabled":case"incrFetchTabEnabled":case"documentTabEnabled":case"exportTabEnabled":case"tocTabEnabled":case"docMobileTabEnabled":case"docAdvTabEnabled":case"deliveryTabEnabled":return !F.IsNavigationDocument;case"InfoWindowPositionEnabled":return this.queryState("UseAsInformationWindow")&&(this.queryState("InfoWindowMode")==4);case"ViewModeInteractivityLevel":return this.queryState("ShowFloatingToolbars");case"lock":return this.parentBone.currentControl!="cursor";case"DataFilterModeEnabled":var Q=this.queryState("EditSelectorSource"+(this.queryState("isMetricQualifier")?"Metrics":(this.queryState("isDDIC")?"DDIC":"")));Q=Q&&Q.split("|");return(Q&&Q.length>2&&Q[1]==microstrategy.DSSTYPE_ATTRIBUTE)||this.queryState("IsSelectorSourceNDE");case"watermarkTabEnabled":return F.AllowWatermark&&!F.IsNavigationDocument;case"layoutLayoutTabEnabled":return(this.parentBone.parentBone.isMultiLayout||this.queryState("ShowTabsForSingleLayout"))&&!F.IsNavigationDocument;case"layoutIncTabEnabled":return false;case"selectorTabTitle":return true;case"BeforeLayout":case"visualizationsEditorRWLayout":return this.parentBone.parentBone.isMultiLayout;}if(!E){return false;}if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(K)){if(!E||!E.isOnlyOneGridSelected()){return false;}var p=microstrategy.findBone(E.getSelectedGrid());p=(p instanceof mstrReportGraphImpl)?p:microstrategy.bone(p.id+"_graph");return(p&&p.commands)?p.commands.queryEnabled(K):false;}switch(K){case"editSelector":if(E.isActive()&&!E.isMulti()&&E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEMPLATE)){var R=microstrategy.findBone(E.firstItem());return(R&&R.commands&&R.commands.queryEnabled(K));}return false;case"isNotLinkedGrid":case"isNotLinkedGridOrNoGrid":case"isNotLinkedGraph":if(!this.queryEnabled(K.indexOf("Grid")!=-1?"onegrid":"onegraph")){return true;}var p=microstrategy.findBone(E.getSelectedGrid());return(p&&p.commands&&!p.commands.queryState("isLinkedTemplate"));case"gradientcolor":return true;case"isSelectionsPresent":return true;case"deleteq":if(F.IsNavigationDocument){var P=E.length&&microstrategy.findBone(mstr.$H.firstItem(E.items));if(P&&P.isNavigationBar){return false;}}case"copyq":case"copy":case"cutq":case"cut":case"delete":case"duplicate":case"objalign":case"alignGrid":case"objsize":case"sizeToGrid":case"controlIsSelected":return(E.isActive()&&E.isVisible&&E.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_DOC_SUBSECTION);case"setCtrlDft":return(E.isOnlyOneCtrlDftObjSelected())&&!this.queryState("isButton")&&!E.atLeastOneTableSelected();case"applyCtrlDft":return(E.atLeastOneCtrlDftObjSelected())&&!this.queryState("isButton")&&!E.atLeastOneTableSelected();case"advformatmenu":return(E.isActive()&&E.isVisible);case"imgready":return(E.isActive())?E.isImageReady():false;case"oneNonLinkedGrid":return this.queryEnabled("onegrid")&&!this.queryEnabled("isLinkedGrid");case"graphMode":case"gridGraphMode":case"gridMode":case"graphMode":case"gridGraphMode":case"onegrid":return(E.isActive())?E.isOnlyOneGridSelected():false;case"oneTable":return(E.isActive())?E.isOnlyOneTableSelected():false;case"onepanelstack":return(E.isActive())?E.isOnlyOnePanelStackSelected():false;case"allpanelstack":return(E.isActive())?E.areAllSelectedPanelStacks():false;case"panelstackselected":return(E.isActive())?E.isPanelStackSelected():false;case"emptytemplate":return(E.isActive())?E.isEmptyTemplateSelected():false;case"onepanel":var I=this.queryEnabled("onepanelstack");var Q=microstrategy.activeCXMenu;if(Q&&Q.clickedElement){if(Q.clickedElement.className&&Q.clickedElement.className.indexOf("title_")>=0){I=false;}}return I;case"onegraph":return(E.isActive())?E.isOnlyOneGraphSelected():false;case"oneggrid":return(E.isActive())?E.isOnlyOneGGridSelected():false;case"roundShapesOnly":return(E.isActive())?E.isOnlyRoundedRectanglesSelected():false;case"shapesOnly":return(E.isActive())?E.isOnlyRectanglesSelected():false;case"squareShapesOnly":return(E.isActive())?E.isOnlySquareRectanglesSelected():false;case"anyrectangle":return(E.isActive())?E.atLeastOneRectangleSelected():false;case"anyRoundedRectangle":return(E.isActive())?E.atLeastOneRoundedRectangleSelected():false;case"anycontrol":return(E.isActive())?E.atLeastOneControlSelected():false;case"onecontrol":return(E.isActive())?E.atLeastOneControlSelected()&&!E.isMulti():false;case"fmtGridCells":case"oneggridfmt":return microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.queryEnabled("oneggrid")&&!this.queryEnabled("isLinkedGrid")&&!this.queryEnabled("emptytemplate");case"openFormatGraph":case"onegraphfmt":return microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.queryEnabled("onegraph")&&!this.queryEnabled("isLinkedGrid")&&!this.queryEnabled("emptytemplate");case"multiselect":return(E.isMulti());case"objalign2":case"objsize2":return(E.isActive());case"toTallest":case"toShortest":return(E.length-E.nubmerOfLinesSelected(microstrategy.ORIENTATION_HORIZONTAL)>1);case"toWidest":case"toNarrowest":return(E.length-E.nubmerOfLinesSelected(microstrategy.ORIENTATION_VERTICAL)>1);case"Name":case"ToolTip":case"Link":case"IsLink":case"NewWin":case"Visible":case"VisibleHTML":case"LineOrientation":case"Source":case"Left":case"Locked":case"Top":case"Wmode":case"Width":case"LockAspectRatio":case"Length":case"Lmode":case"borderStyle":case"IsPortal":case"PortalState":case"PortalTitle":case"TitleBarDisplay":case"TopCornersOnly":case"HasDropShadow":case"DropShadow":case"HasRoundedCorners":case"HasAlpha":case"HTMLType":case"IFrameSource":case"ShowElementCount":case"ExportOptions":return microstrategy.isEnabled(E.isVisible&&E.items,this.qeMap[K]);case"Wmode11":case"Wmode12":case"Wmode13":return this.queryEnabled("Wmode");case"Hmode11":case"Hmode12":case"Hmode13":return this.queryEnabled("Hmode");case"Wmode0":case"Hmode0":return this.queryEnabled(K.substr(0,5));case"Wmode1":case"Hmode1":var J=this.queryEnabled(K.substr(0,5));if(J){return E.atLeastOneSubtypeSelected([101]);}return false;case"Wmode2":var J=this.queryEnabled(K.substr(0,5));if(J){var A=this.parentBone.selections.getSelectedGrid();if(A){var P=microstrategy.findBone(A);return(P&&!P.isGraph);}}return false;case"Hmode2":var J=this.queryEnabled(K.substr(0,5));if(J){return E.atLeastOneSubtypeSelected([106,111])||this.queryEnabled("Wmode2");}return false;case"Hmode":case"Height":if(microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){return microstrategy.isEnabled(E.isVisible&&E.items,this.qeMap[K]);}else{var A;if(!(A=this.parentBone.selections.getSelectedGrid())){A=this.parentBone.selections.getSelectedPanelStack();}if(A){var P=microstrategy.findBone(A);return P.commands.queryEnabled(K);}return true;}case"backgroundColor":if(E.isOnlyOneGridSelected()){oGrid=this.parentBone.selections.getSelectedGrid();W=microstrategy.findBone(oGrid);if(W.gridUnitFormat==microstrategy.GRID_BORDERS){return false;}}case"fontWeight":case"fontStyle":case"textDecoration":case"TextDirection":case"fontFamily":case"fontSize":case"textAlign":case"Format":return microstrategy.isEnabled(E.isVisible&&E.items,K);case"TextDirectionGrid":return microstrategy.isEnabled(E.isVisible&&E.items,"TextDirection");case"borderLeftColor":var q=this.queryState("enabled3d");var D=(q>0);return !D&&microstrategy.isEnabled(E.isVisible&&E.items,K);case"color":return microstrategy.isEnabled(E.isVisible&&E.items,K);case"lineColor":case"borderLeftStyle":case"lineStyle":var q=this.queryState("enabled3d");var D=(q>0);if(this.queryEnabled("onepanelstack")){return !D&&microstrategy.findBone(this.queryState("selectedPanelStack")).commands.queryEnabled(K);}else{if(this.queryEnabled("onegrid")){return !D&&microstrategy.findBone(this.queryState("selectedGrid")).commands.queryEnabled(K);}else{return !D&&microstrategy.isEnabled(E.isVisible&&E.items,K)&&!this.queryEnabled("roundShapesOnly");}}case"AutoResize":case"SubWidth":case"ShrinkHorizontal":case"GrowHorizontal":case"MaxHeightWidth":case"SubHeight":case"Shrink":case"Grow":case"HideIfEmpty":case"MaxHeight":case"FitExcelRowHeight":case"Keep":case"Repeat":case"RepeatHoriz":case"NewPage":case"autotext":return(E.isActive()&&!E.isMulti());case"borders":if(!E.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(E.isOnlyOneGridSelected()){W=microstrategy.findBone(E.getSelectedGrid());if(W&&W.graphSelected){return false;}if(!E.isGridContainerSelected()||E.gridValueFormatX==1){return W&&W.commands.queryEnabled(K);}}if(E.isOnlyOnePanelStackSelected()){return(E.panelValueFormat!=1);}return(this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_IMAGE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER]));case"setSectionDefaults":return(E.isActive()&&!E.isMulti()&&(E.getFirstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION));case"setCtrlDefaults":return(E.isActive()&&!E.isMulti()&&(E.getFirstObjType()==microstrategy.OBJTYPE_DOC_OBJECT)||(E.getFirstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION));case"links":if(E.isActive()&&!E.isMulti()&&(E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_IMAGE)||E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT))){var a=null;var O=this.parentBone.selections.getItems();if(O&&O[0]){a=O[0].id;}if(a){var c=microstrategy.bone("rwb_viewer");var S=c.webHyperLinks[a];return(S!=null);}}return false;case"WebHyperLinkEditor":case"showWebHyperLinkEditor":if(E.isActive()&&!E.isMulti()){if(E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_IMAGE)||(E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)&&!this.queryState("isButton"))){return true;}else{if(E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEMPLATE)){var R=microstrategy.findBone(E.firstItem());return(R&&R.commands&&R.commands.queryEnabled(K));}}}return false;case"FilterDetailsProperties":return((E.length==0)||(E.isActive()&&!E.isMulti()&&E.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)))&&!this.queryState("isButton");case"ShowFilterDetailsProperties":return !this.queryState("isButton");case"SubType":return true;case"saveAsTheme":case"applyTheme":return true;case"pasteFormat":if(E.isActive()&&E.objCache.copyBuffer!=null&&E.objCache.copyBuffer.length==1){var U=E.firstItem();return(U.getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_DOC_SUBSECTION&&U.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_TEMPLATE)&&!this.queryState("isButton");}return false;case"paste":return(E.objCache.copyBuffer!=null&&E.objCache.copyBuffer.length>0);case"edtProps":return E.enablePropertiesEditor();case"subSectionIsSelected":return(E.isActive()&&(E.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION)||(E.length>0&&E.isSameSubSection()));case"ssRuler":if(!this.queryEnabled("subSectionIsSelected")){return false;}var u=microstrategy.findBone(E.firstItem());return(u&&u.subsectionType==mstrSubSection.TYPE_FIXED);case"insertSectionAbove":case"insertSectionBelow":case"mngSections":if(this.queryEnabled("subSectionIsSelected")){var V=microstrategy.findBone(E.firstItem());return(V&&V.subsectionType==mstrSubSection.TYPE_FIXED&&V.parentBone&&!V.parentBone.isDetails&&!V.isHorizontal);}return false;case"mngHorizontalSections":if(this.queryEnabled("subSectionIsSelected")){var V=microstrategy.findBone(this.parentBone.selections.firstItem()).parentBone;if(V!=null){return !V.isDetails&&V.isHorizontal;}}return false;case"edtDMetric":var W=microstrategy.findBone(E.getSelectedGrid());if(W&&!W.isFeatureAvailable(microstrategy.FEATURE_INSERT_NEW_METRIC)){return false;}case"edtRename":var d=microstrategy.bone("reportObjs_RWWorkingSetStyle");p=microstrategy.findBone(E.getSelectedGrid());var B=p&&p.commands.queryState("gridType")!="flash";return(B&&E.isGridSelected()&&(!E.isEmptyTemplateSelected())&&!this.queryEnabled("isLinkedGrid"))||(d&&d.selections&&d.selections.isActive());case"vfeRWGrid":return E.isActive()&&E.isOnlyOneGridSelected()&&(!F.noDataset)&&!this.queryEnabled("isLinkedGrid");case"vfeRWView":if(this.queryEnabled("vfeRWGrid")&&E&&E.isOnlyOneGridSelected()){var W=microstrategy.findBone(E.getSelectedGrid());return(W&&W.commands)?W.commands.queryEnabled(K):false;}else{return false;}case"edtSort":var W=microstrategy.findBone(E.getSelectedGrid());return(this.queryEnabled("vfeRWGrid")&&W&&W.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE))||this.queryEnabled("edtSortRW");case"deleteSubsection":if(this.queryEnabled("subSectionIsSelected")){var f=microstrategy.findAncestorWithAtt(E.firstItem(),microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION);var u=microstrategy.findBone(f);return(u&&u.getSubsectionCount()>1);}return false;case"groupProp":var G=this.parentBone.selections.getSelectedSubsection();if(G){return G.parentBone.groupID!=null;}return false;break;case"isSubsectionHorizontal":var G=this.parentBone.selections.getSelectedSubsection();if(G){return G.isHorizontal;}return false;break;case"showOrderCtxMenu":if(E.isActive()&&!E.isMulti()){var U=E.firstItem();if(U.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return false;}var f=microstrategy.findAncestorWithAtt(U,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);return(f&&f.childNodes.length>1);}return false;case"hasmetrics":case"comboToggleButton":case"tsubtotals":case"visualizationsEditor":case"visualizationMode":case"quickThresholds":case"openAdvThresholdEditor":case"edtSubtotalsOldIServer":case"addQuickTotals":case"edtSortGridMenu":case"edtSortGrid":case"graphZones":case"gridMode":case"isLinkedGrid":case"visFlashMode":case"visAjaxMode":case"toggleHideNullsOrZeros":if(E&&E.isOnlyOneGridSelected()){var W=microstrategy.findBone(E.getSelectedGrid());return(W&&W.commands)?W.commands.queryEnabled(K):false;}else{return false;}case"showInsertFunction":return(!this.parentBone.parentBone.noDataset&&!E.isMulti());case"insertFunctionVisible":return !this.queryState("isButton");case"openConditionalFormattingForHiddenSections":if(!E||E.isActive()){return false;}if(!F.isEditableViewModeEplus()){return false;}return(F.documentHasMetrics)?F.documentHasMetrics:false;case"openBasicConditionalFormatting":case"openAdvConditionalFormatting":if(!E||!F.isEditableViewModeEplus()){return false;}if(!E.isActive()||E.isMulti()){return false;}var U=E.firstItem();var x=U.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(x==null){x=U.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}switch(x){case microstrategy.SUBOBJTYPE_DOC_TEXT:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:return !F.noDataset;case microstrategy.OBJTYPE_DOC_SUBSECTION:if(U.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)==microstrategy.TRUE){return false;}return !F.noDataset;default:return false;}case"showDrillSubmenu":var U=E.firstItem();return(U&&microstrategy.styleObj.getAttValue(E.firstItem(),microstrategy.HTMLATTR_OBJINDEX)!=null);case"showDrillPaths":var U=E.firstItem();return(U&&v.indexOf(U.getAttribute("id")+"|"+U.getAttribute(microstrategy.HTMLATTR_OBJINDEX))>-1);case"showLinkPaths":return !!(E.items[H]);case"edtSubtotals":case"edtResize":case"swapAxes":case"autostyle":case"tbanding":case"tOutline":case"ShowThreshold":case"toggleattforms":case"checkMergeColHeader":case"checkMergeRowHeader":case"checkLockColHeader":case"checkLockRowHeader":case"fittocontent":case"fittowindow":case"graphEditor":case"gridEditor":if(!E.isOnlyOneGridSelected()){return false;}var e=microstrategy.findBone(E.firstItem());return(e&&e.commands&&e.commands.queryEnabled(K));case"openSimpleThresholdEditor":case"openAdvThresholdEditor":if(!E.isOnlyOneGridSelected()){return false;}var e=microstrategy.findBone(E.firstItem());return(e&&e.commands&&e.commands.queryEnabled(K)&&!this.queryEnabled("isLinkedGrid"));case"autoArrange":if(this.parentBone.selections&&this.parentBone.selections.isOnlyOneGridSelected()){var W=microstrategy.findBone(this.parentBone.selections.getSelectedGrid());if(W&&W.isGraph){var Y=microstrategy.bone(W.id+"_gb");return(Y)?!Y.autoArrange:true;}else{return false;}}else{return false;}break;case"generalTabEnabled":case"layoutSectionsTabEnabled":return F.isEditableViewModeEplus()&&!F.IsNavigationDocument;case"layoutTabEnabled":return F.isEditableViewModeEplus()&&!this.queryState("isNavBar")&&!E.isItemInsideNavBar();case"buttonTabEnabled":return this.queryState("onlyButtons");case"themeTabEnabled":return !E.isMulti();case"colorTabEnabled":if(this.queryState("appliedLinkedTheme")){return false;}if(this.queryState("isButton")){var T=E.getSelectedButtons();for(var u in T){if(microstrategy.styleObj.getAttValue(T[u],microstrategy.HTMLATTR_DISPLAY_STYLE)==microstrategy.BUTTON_STYLE_CUSTOM){return false;}}}return this.parentBone.parentBone.gridGraphFormatting&&!E.isItemInsideNavBar();case"fontTabEnabled":if(this.queryState("appliedLinkedTheme")){return false;}if(E.isOnlyOnePanelStackSelected()){return E.isOnlyOneTableSelected()?true:this.queryState("IsPortal");}else{if(this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE])){return this.queryState("IsPortal")||this.queryEnabled("fontAndAlignmentEnabled");}else{if(this.queryState("isButton")){var T=E.getSelectedButtons();for(var u in T){var M=microstrategy.styleObj.getAttValue(T[u],microstrategy.HTMLATTR_DISPLAY_STYLE);if(M==microstrategy.BUTTON_STYLE_ICON_ONLY||M==microstrategy.BUTTON_STYLE_CUSTOM){return false;}}}if(E.isItemInsideNavBar()){return false;}return((this.parentBone.parentBone.gridGraphFormatting&&this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]))||this.queryEnabled("fontAndAlignmentEnabled"));}}case"fontAndAlignmentEnabled":var C=this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER]);return(C||this.queryEnabled("showGridFormatTabs"))&&this.parentBone.parentBone.gridGraphFormatting;case"alignmentTabEnabled":return !this.queryState("appliedLinkedTheme")&&this.queryEnabled("fontAndAlignmentEnabled")&&!this.queryState("isButton");case"numberTabEnabled":return(!this.queryState("appliedLinkedTheme")&&(this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT])||this.queryEnabled("showGridFormatTabs"))&&mstr.behaviors.featureResolver.featAvailable("number-formatting")&&!this.queryState("isButton"));case"imageTabEnabled":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_IMAGE]);case"lineTabEnabled":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"gridTabEnabled":return E.isOnlyOneGridSelected();case"advancedTabEnabled":return F.isEditableViewModeEplus()&&(E.isOnlyOneGridSelected()||E.isOnlyOnePanelStackSelected()||E.isOnlyOneSelectorCtrlSelected())&&!this.queryState("isNavBar")&&!E.atLeastOneTableSelected();case"flashTabEnabled":return F.isEditableViewModeEplus()&&(this.queryEnabled("gridTabEnabled")||this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]));case"widgetTabEnabled":return F.isEditableViewModeEplus()&&(this.queryEnabled("gridTabEnabled"));case"selectorTabEnabled":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL])||E.isOnlyOneTableSelected()||this.queryState("isDDIC");case"effectsTabEnabled":return !this.queryState("appliedLinkedTheme")&&F.isEditableViewModeEplus()&&!this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_SUBSECTION])&&this.parentBone.parentBone.gridGraphFormatting&&!this.queryState("isButton")&&!this.queryState("isNavBar")&&!E.atLeastOneTableSelected();case"showGridFormatTabs":return(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE])&&this.queryEnabled("enableGridFormat")&&this.queryState("isOneGrid")&&E.getSelectedGrid()&&microstrategy.findBone(E.getSelectedGrid()).isGrid&&!this.queryEnabled("isLinkedGrid"));case"showGridSelectors":return(this.queryEnabled("showGridFormatTabs")&&this.queryState("isOneGrid"));case"showPanelSelector":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK])&&!this.queryState("isNavBar");case"Autostyle":if(!E.isOnlyOneGridSelected()){return false;}var e=microstrategy.findBone(E.firstItem());return(e&&e.commands&&e.commands.queryEnabled("autostyle"));case"AllStyle":case"AllColor":case"LeftStyle":case"LeftColor":case"RightStyle":case"RightColor":case"TopStyle":case"TopColor":case"BottomStyle":case"BottomColor":return !this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_SUBSECTION]);case"RwdUnits":return this.queryEnabled("isNotLinkedGraph");case"tbValueSelector":if(this.queryEnabled("onepanelstack")){return(this.queryState("IsPortal")&&E.panelUnitFormat!=1);}case"tbGridValueSelector":if(E.getSelectedGridProperty("isGraph")){return true;}switch(parseInt(E.gridUnitFormatX,10)){case microstrategy.GRID_UNIT_CONTAINER:return this.queryState("IsPortal");case microstrategy.GRID_BORDERS:return false;default:return true;}case"Bold":case"Italic":case"Underline":case"FontFamily":case"FontSize":case"TextAlign":case"GridHorizontal":case"FontColor":case"Currency":case"IntlCurrency":case"Percent":case"Comma":case"IncreaseDecimal":case"DecreaseDecimal":if(!E.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(!this.parentBone.selections.getSelectedGridProperty("graphSelected")){var m=("|FontFamily|FontSize|Bold|Italic|Underline|TextAlign|GridHorizontal|FontColor|".indexOf("|"+K+"|")>-1);var L=[microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT];if(m){L.push(microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER);if(K!="TextAlign"&&K!="GridHorizontal"){L.push(microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);}}if(this.ensureSelectedObjectTypes(L)){return true;}var k="|FontFamily|FontSize|Bold|Italic|Underline|FontColor|";if(E.isOnlyOnePanelStackSelected()){if(E.panelValueFormat==0){return false;}return(k.indexOf("|"+K+"|")>-1);}if(E.isOnlyOneGridSelected()){if(E.gridUnitFormatX==microstrategy.GRID_BORDERS){return false;}if(E.isGridContainerSelected()){if(E.gridValueFormatX==1){return false;}return((k+"TextAlign|").indexOf("|"+K+"|")>-1);}else{if(m&&!this.queryState("areGridFormatsReady")){return false;}}}else{if(E.isMulti()&&!!E.getSelectedGrid()){return((k+"TextAlign|Currency|IntlCurrency|Percent|Comma|IncreaseDecimal|DecreaseDecimal|").indexOf("|"+K+"|")==-1);}}}W=microstrategy.findBone(E.getSelectedGrid());if(!W){return false;}return W.commands.queryEnabled(K,H);case"FillColor":if(!E.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(E.isOnlyOneGridSelected()){if(E.isGridContainerSelected()){return true;}W=microstrategy.findBone(E.getSelectedGrid());if(!W){return false;}return W.commands.queryEnabled(K,H);}return(!this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]));case"showFlashOnlyForSelector":case"showFlashOnlyForFillColorSelector":return true;case"Borders":return(E.isActive()&&!this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_SUBSECTION]));case"lnstyle":case"lncolor":if(!E.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_SUBSECTION])||this.queryState("enabled3d")){return false;}if(E.isOnlyOneGridSelected()){W=microstrategy.findBone(E.getSelectedGrid());if(W&&W.graphSelected&&W.isGraph){return W.commands.queryEnabled(K,H);}switch(parseInt(E.gridUnitFormatX,10)){case microstrategy.GRID_UNIT_CONTAINER:return(E.gridValueFormatX!=2);case microstrategy.GRID_BORDERS:return true;default:if(!W){return false;}return W.commands.queryEnabled(K,H);}}if(E.isOnlyOnePanelStackSelected()){return(E.panelValueFormat!=1);}return true;case"AlignLeft":case"AlignCenter":case"AlignRight":return E.isMulti()&&(E.isSameSubSection()||!E.hasHorizSections());case"AlignTop":case"AlignMiddle":case"AlignBottom":return E.isMulti()&&(E.isSameSubSection()||E.hasHorizSections(true));case"DistHoriz":return E.length>2&&(E.isSameSubSection()||!E.hasHorizSections());case"DistVert":return E.length>2&&(E.isSameSubSection()||E.hasHorizSections(true));case"back":case"front":case"oneBack":case"oneFront":var Z=this.queryState("selectedSection");return(E.isActive()&&!E.isMulti()&&E.getFirstObjType()!=microstrategy.OBJTYPE_DOC_SUBSECTION&&Z&&Z.childNodes&&Z.childNodes.length>1);case"b3dstyle":case"b3dweight":case"enabled3d":var X=E.nubmerOfLinesSelected(microstrategy.ORIENTATION_HORIZONTAL)+E.nubmerOfLinesSelected(microstrategy.ORIENTATION_VERTICAL);if(E.length==X){return false;}return E.isActive();case"Transparency":case"Blur":return microstrategy.isEnabled(E.isVisible&&E.items,"Transparency");case"gridSelectedVisualization":if(!E||!E.isOnlyOneGridSelected()){return false;}var p=microstrategy.findBone(E.getSelectedGrid());return(p&&p.commands)?p.commands.queryEnabled("selectedVisualization"):false;case"transactionEdit":return(E.getTransactionUnitKey()!=null&&!this.queryState("isButton"))||E.isOnlyOneTableSelected();case"transactionCondition":if(E&&E.isOnlyOneGridSelected()){var p=microstrategy.findBone(E.getSelectedGrid()),h=p&&p.tscObjs||[],N=h.length,n;for(n=0;n<N;++n){if(h[n].edt){return true;}}return false;}return(E.getTransactionUnitKey()!=null&&!this.queryState("isButton")&&!E.isOnlyOneGridSelected())||this.queryState("isActionSelector");case"DisplayInPartialScreen":case"InitialSlidingInWidth":case"InitialSlidingInHeight":case"ShowAsCollapsiblePanel":return microstrategy.isEnabled(E.isVisible&&E.items,K);case"activeSelections":default:return E.isActive();}}catch(o){microstrategy.errors.log(o);return false;}};mstrDocCommandsImpl.prototype.queryState=function(BE,AK){try{var Bk=null;var x=null;var AS=null;var A7=this.parentBone.parentBone;var Ab,B9;var Ap=BE.split(";");if(Ap.length==2&&Ap[0]=="tc"){var As=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());return As&&As.queryState&&As.queryState(Ap[1]);}var n=function(CJ,CI){var CK=parseInt(CJ.panelUnitFormat),g=parseInt(CJ.panelValueFormat);if(CI=="font"){if(CK<2||CK>3){CJ.panelUnitFormat=2;}if(CK==2){CJ.panelValueFormat=1;}if(CK==3&&(g<1||g>3)){CJ.panelValueFormat=1;}}else{if(CI=="color"){CJ.panelUnitFormat=0;CJ.panelValueFormat=0;}}};switch(BE){case"showEditorSelector":return !this.queryState("isNavBar");case"controlInclude":var B4=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());return B4.include;case"allowRemoveExtraColumn":return this.parentBone.parentBone.isFeatureAvailable("grid-layout");case"objBrowser":Bk=microstrategy.bone("reportObjs_RWWorkingSetStyle");return(Bk&&isInDocument(Bk.elem));case"groupBy":Bk=microstrategy.bone("pbb_GroupByStyle");return(Bk&&isInDocument(Bk.elem));case"relatedReports":Bk=microstrategy.bone("relatedReports");return(Bk&&isInDocument(Bk.elem));case"grid":return this.parentBone.gridOn;case"rulers":return this.parentBone.rulerOn;case"panelTb":return(this.parentBone.currentControl=="cursor");case"PageWidth":case"PageHeight":case"MarginLeft":case"MarginTop":case"MarginRight":case"MarginBottom":case"minimumPrintArea":B9=(this.parentBone.docPropsMap[BE]&&this.parentBone.docPropsMap[BE].l)||BE;return microstrategy.number.toUserUnits(A7[B9]);case"Autowire":case"CtlAutoSubmit":B9=(this.parentBone.docPropsMap[BE]&&this.parentBone.docPropsMap[BE].l)||BE;return A7[B9];case"ScalePagesWide":case"ScalePagesTall":var BU=A7[BE];if(BU==0||BU=="0"){BU="";}return BU;case"PaperType":case"PaperOrientation":case"Scaling":case"ScalePercentage":case"ScalePageHeaderFooter":case"SectionHorizontalOverflow":case"LayoutFillColor":case"LayoutLeftStyle":case"LayoutLeftColor":case"LayoutTopStyle":case"LayoutTopColor":case"LayoutRightStyle":case"LayoutRightColor":case"LayoutBottomStyle":case"LayoutBottomColor":case"RenderConditionalFormatting":case"DefaultGridStyle":case"showDisplayModes":case"ExecutionFullScreenMode":case"ShowingBarsTemporarily":case"DefaultSelectorsAsFilter":case"PreserveTranslations":case"ShowFloatingToolbars":case"ViewModeInteractivityLevel":case"CalculateDocWidth":case"DefaultViewMode":case"DefaultPageByExportMode":case"ExportRange":case"ExcelGraphFormat":case"EmbeddedFonts":case"MobileDataView":case"UseOneSheetPerLayout":case"UseOneSheetPerGroupElement":case"PromptUserForPagebyExport":case"ExcelEmbedImages":case"IncludeBookmarks":case"ShowBookmarks":case"EmbedFonts":case"GraphFormat":case"GraphQualityDPI":case"isMultiLayout":case"multiLayoutMode":case"EnableToc":case"BeforeLayout":case"BeforeLayoutItems":case"TOCTitle":case"TabLeader":case"TOCFontName":case"TOCFontSize":case"TOCFontStrikeout":case"TOCFontUnderline":case"TOCFontColor":case"WatermarkType":case"WatermarkText":case"WatermarkFontName":case"WatermarkFontSize":case"WatermarkFontStrikeout":case"WatermarkFontUnderline":case"WatermarkFontColor":case"AutoFontSize":case"TextWashout":case"TextOrientation":case"ImageSource":case"ImageScale":case"ShowTabsForSingleLayout":case"RemoveNullGroups":case"RemoveMissingUnits":case"SingleSourceGrid":case"RWLevelMCEJoin":case"TrimNoSectionData":case"PreLoadAllPanels":case"SupportedOrientations":case"FitPDFContentHeight":case"DisplayPageByBar":case"DisplayRePromptIcon":case"UseAsInfoWindow":case"layoutBarStyle":case"layoutBarPosition":case"enableGraphTooltips":case"IncludePageHeaderFooter":case"EnableExport":case"ExcelExportDocumentURL":case"PDFExportDocumentURL":case"EnableZoom":case"DocumentThemeColor":case"EnableSwipingToSwitchLayout":case"EnableInherit":case"TOCFillColor":case"TOCTitleAlignment":case"TOCTitleFontName":case"TOCTitleFontSize":case"TOCTitleFontUnderline":case"TOCTitleFontStrikeout":case"TOCTitleFontColor":case"TOCTitleFillColor":case"TOCTitleEnableInherit":case"TOCLeftIndent":case"TOCRightIndent":case"TOCBorderStyle":case"TOCBorderColor":case"TOCBorderWeight":case"EnableCopyForText":case"EnableCopyForGridCell":case"SmartClientDoc":case"OfflineOnCube":case"ShowOfflineUCOnCubeConfig":case"KeepControlTargetsConsistent":return A7[BE];case"isNavigationDocument":return !!A7.IsNavigationDocument;case"RefreshDocument":return A7[BE]!=undefined?A7[BE]:A7.RefreshFrequency>=1;case"RefreshFrequency":var Ao=A7[BE];return Ao>1?Ao:(Ao==-1?30:Ao);case"ApplyGBToAllLayouts":return A7[BE]==2;case"WatermarkFontBoldItalic":var Br=0;if(A7.WatermarkFontBold){Br+=1;}if(A7.WatermarkFontItalic){Br+=2;}return Br;case"TOCFontBoldItalic":var Br=0;if(A7.TOCFontBold){Br+=1;}if(A7.TOCFontItalic){Br+=2;}return Br;case"TOCTitleFontBoldItalic":var Br=0;if(A7.TOCTitleFontBold){Br+=1;}if(A7.TOCTitleFontItalic){Br+=2;}return Br;case"TOCTitleSetEnable":return this.queryState("EnableToc")&&(!(this.queryState("TOCTitleEnableInherit")));case"TOCBorderStyleEnable":return this.queryState("EnableToc")&&(A7.TOCBorderStyle!="0");case"AvailableViewModeItems":case"AvailableDefaultRunModesItems":case"AvailableExportModeItems":return A7[BE];case"AvailableViewModes":case"AvailableExportModes":var B6=(BE=="AvailableViewModes")?[mstr.Enum.VIEWMEDIA.STATIC,mstr.Enum.VIEWMEDIA.INTERACTIVE,mstr.Enum.VIEWMEDIA.EDITABLE,mstr.Enum.VIEWMEDIA.FLASH]:[mstr.Enum.VIEWMEDIA.EXPORT_EXCEL,mstr.Enum.VIEWMEDIA.EXPORT_PDF,mstr.Enum.VIEWMEDIA.EXPORT_HTML,mstr.Enum.VIEWMEDIA.EXPORT_FLASH];var BQ=[];var BK=A7.AvailableViewModes;for(var Be=0;Be<B6.length;Be++){if((B6[Be]&BK)>0){BQ.push(B6[Be]);}}return BQ;case"MakePrivate":return(A7.AvailableViewModes&mstr.Enum.VIEWMEDIA.PRIVATE)>0;case"LayoutBorderStyle":var Aj={viewer:A7,getValue:function(g,CI){return this.viewer[CI];}};return this.parentBone.checkBorderProperties(null,Aj,"Layout","Style","Color");case"LayoutAllStyle":return this.queryState("LayoutLeftStyle");case"LayoutAllColor":return this.queryState("LayoutLeftColor");case"sectionsList":var Z=A7[BE];var BQ=new Array(Z.length);for(var Be=0;Be<Z.length;Be++){BQ[Be]={dssid:Z[Be].d,n:Z[Be].n,v:Z[Be].v};}return BQ;case"dockableSectionsList":var Z=A7.sectionsList;var BQ=[];for(var Be=0;Be<Z.length;Be++){if(Z[Be].t==6||Z[Be].t==7){BQ.push({dssid:Z[Be].d,n:Z[Be].n,v:Z[Be].v});}}return BQ;case"VisibleSections":var Z=A7.sectionsList;var BQ=[];for(var Be=0;Be<Z.length;Be++){if(Z[Be].v){BQ.push(Z[Be].d);}}return BQ;case"DockedSections":var Z=A7.sectionsList;var BQ=[];for(var Be=0;Be<Z.length;Be++){if(Z[Be].dc&&(Z[Be].t==6||Z[Be].t==7)){BQ.push(Z[Be].d);}}return BQ;case"showDisplayModes":return A7.isFeatureAvailable(microstrategy.FEATURE_CHECK_DESIGN_MODE)||A7.isFeatureAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE);case"incrFetchEnabled":return A7.ifSettings.enabled;case"incrFetchBlockCount":return A7.ifSettings.blockCount;case"incrFetchLevels":return A7.ifSettings.levels;case"incrFetchCurLevel":return A7.ifSettings.curLevel;case"cursor":return !this.parentBone.currentControl||this.parentBone.currentControl==BE;case"lock":return this.parentBone.parentBone.insertionControlLocked;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.GRAPH_CTL:case microstrategy.BUTTON_CTL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_SHAPE:return this.parentBone[BE];case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:case microstrategy.SUBOBJTYPE_DOC_TEXT:return this.parentBone.currentControl==BE;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:return this.parentBone.currentControl==BE&&!this.parentBone.currentControlSubtype;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|FP":return this.parentBone.currentControl==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&this.parentBone.currentControlSubtype=="FP";case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|TC":return this.parentBone.currentControl==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&this.parentBone.currentControlSubtype=="TC";case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:return this.parentBone.currentControl==BE.split("|")[0]&&this.parentBone.currentControlSubtype!="R";case microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE:return this.parentBone.currentControl==BE.split("|")[0]&&this.parentBone.currentControlSubtype==BE.split("|")[1];}if(!this.parentBone.selections){return null;}var AN=this.parentBone.selections;var T=AN.items;var Aq=null;var BL=(AN.useGridFormat(false))?AN.getGridFormatInfo(false):microstrategy.formatType;if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(BE)){if(!AN||!AN.isOnlyOneGridSelected()){return false;}var Bf=microstrategy.findBone(AN.getSelectedGrid());Bf=(Bf instanceof mstrReportGraphImpl)?Bf:microstrategy.bone(Bf.id+"_graph");if(BE=="seriesAreaFormatField_visible"){return(Bf&&Bf.commands)?Bf.commands.queryState(BE,AK):false;}return(Bf&&Bf.commands)?Bf.commands.queryState(BE):false;}switch(BE){case"showSelectionColor":for(var Be in T){var x=T[Be];var a=x.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(a==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(x.lastChild){var Bx=microstrategy.bone(x.lastChild.id);if(Bx&&Bx.ctlStyle!=mstrRWControlImpl.CTL_STYLE_POOL_DOWN&&Bx.ctlStyle!=mstrRWControlImpl.CTL_STYLE_LIST_BOX&&Bx.ctlStyle!=mstrRWControlImpl.CTL_STYLE_LINK_ARRAY||Bx&&Bx.ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION||this.queryState("edtValueSelector").value==mstrRWControlImpl.FMT_TYPE_TITLE_BASE){return false;}}}else{if(a==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){var Bf=microstrategy.findBone(AN.getSelectedGrid());if(!Bf||!Bf.isGrid||Bf.gridUnitFormat!=microstrategy.GRID_UNIT_CONTAINER){return false;}}else{return false;}}}return true;case"showFlashOnlyForSelector":case"showFlashOnlyForFillColorSelector":for(var Be in T){var x=T[Be];var a=x.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(a!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||this.queryState("edtValueSelector").value==mstrRWControlImpl.FMT_TYPE_TITLE_BASE){return false;}if(x.lastChild){var Bx=microstrategy.bone(x.lastChild.id);if(Bx&&Bx.ctlStyle!=mstrRWControlImpl.CTL_STYLE_POOL_DOWN&&(Bx.ctlStyle!=mstrRWControlImpl.CTL_STYLE_LIST_BOX||BE=="showFlashOnlyForFillColorSelector")){return false;}}}return true;case"selectedItems":return this.parentBone.selections.items;case"selectedTextField":if(this.parentBone.selections.isMulti()){return null;}x=this.parentBone.selections.firstItem();if(x.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT){return x;}else{return null;}break;case"RwdUnits":var O={items:[],value:""};if(!AN.isActive()||!AN.isVisible){O.items.push({dssid:"",n:microstrategy.descriptors.getDescriptor("3520")});}else{if(AN.isMulti()){O.items.push({dssid:"",n:microstrategy.descriptors.getDescriptor("3574")});}else{O.value=AN.firstItem().getAttribute("id");}}var Ae=[];var BR=this.parentBone;for(var AA in BR.formattingAttributes){var x=BR.formattingAttributes[AA];if(x.nm==undefined||x.clip||x.deleted){continue;}var Bh=false;if(x.ty==microstrategy.OBJTYPE_DOC_SUBSECTION){Bh=true;for(var C in BR.sections){var Ac=BR.sections[C].subsections;if(Ac&&AA in Ac){Bh=false;break;}}}if(Bh){continue;}Ae.push({dssid:AA,n:BR.formattingAttributes[AA].nm,cssClass:"ToolbarList T"+x.ty});}Ae=Ae.sort(function(CI,g){if(CI.n<g.n){return -1;}if(CI.n>g.n){return 1;}return 0;});O.items=O.items.concat(Ae);return O;case"units":var BX=new Object();for(var Be in this.parentBone.formattingAttributes){if(document.getElementById(Be)){BX[Be]=this.parentBone.formattingAttributes[Be];}}return BX;case"unit":var AA=-1;var Bj=null;var An=null;if(!AN.isActive()||!AN.isVisible){AS=microstrategy.descriptors.getDescriptor("3520");}else{if(AN.isMulti()){AS=microstrategy.descriptors.getDescriptor("3574");}else{x=AN.firstItem();AS=microstrategy.styleObj.getAttValue(x,microstrategy.HTMLATTR_NAME);AA=x.id;if(x.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){Bj=microstrategy.OBJTYPE_DOC_SUBSECTION;}else{Bj=x.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}}}switch(Bj){case microstrategy.SUBOBJTYPE_DOC_SHAPE:if(x.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){An=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND;}break;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:An=microstrategy.styleObj.getAttValue(x,"styst");break;}return{name:AS,id:AA,sty:Bj,styst:An};case"selected":case"SubType":if(!AN.isActive()||!AN.isVisible){return microstrategy.descriptors.getDescriptor("3520");}if(AN.isMulti()){return microstrategy.descriptors.getDescriptor("3574");}x=AN.firstItem();if(x.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return microstrategy.descriptors.getDescriptor("3580");}var a=x.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);switch(a){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:var Aw=microstrategy.findBone(x);if(Aw&&Aw.commands){return Aw.commands.queryState("selected");}case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:var CF=this.getCommonBoneProperty(T,"isFilterPanel",microstrategy.SUBOBJTYPE_DOC_PANEL_STACK),AY=this.getCommonBoneProperty(T,"isNavigationBar",microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(CF){return microstrategy.descriptors.getDescriptor("8966");}else{if(AY){return microstrategy.descriptors.getDescriptor("8145");}else{return microstrategy.descriptors.getDescriptor(this.rwObjNameMap[microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]);}}case microstrategy.SUBOBJTYPE_DOC_TEXT:if(this.queryState("isButton")){return microstrategy.descriptors.getDescriptor("6457");}default:return microstrategy.descriptors.getDescriptor(this.rwObjNameMap[a]);}case"Link":var M=this.getCommonAttValue(T,microstrategy.HTMLATTR_LINK_HREF,"link");if(M==null||M==""||M.length==0){M="http://";}return M;case"EditFieldTargetInfoWin":return this.getCommonAttValue(T,"ifw","InformationWindowTarget");case"IFrameSource":var A9=this.getCommonAttValue(T,microstrategy.HTMLATTR_HTML_SOURCE,"url");if(A9==null||A9==""||A9.length==0){A9="http://";}return A9;case"ToolTip":var AI=this.getCommonAttValue(T,microstrategy.HTMLATTR_TOOLTIP_FORMULA,"title");return(AI!=null)?AI:"";case"HTMLType":return this.getCommonAttValue(T,microstrategy.HTMLATTR_HTML_TYPE,"htmlType");case"IsPortal":var x=AN.firstItem();var AJ=x.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var Bo=x.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(AJ==microstrategy.OBJTYPE_DOC_OBJECT&&Bo==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){return false;}return(this.getCommonAttValue(T,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,"showTitleBar")=="-1");case"ShowWidgetTitleBar":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_WIDGET_SHOW_WINDOW_TITLE,"ShowWidgetTitleBar")=="-1");case"UseAsInformationWindow":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_USE_AS_INFORMATION_WINDOW,"UseAsInformationWindow")=="-1");case"InformationWindowPlacement":return this.getCommonAttValue(T,microstrategy.HTMLATTR_INFO_WIN_PLACEMENT,"InformationWindowPlacement");case"InfoWindowMode":return this.getCommonAttValue(T,microstrategy.HTMLATTR_INFO_WIN_MODE,"InfoWindowMode");case"TabCloseToDismissInfoWindow":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_TAB_CLOSE_TO_DISMISS_INFOWIN,"TabCloseToDismissInfoWindow")=="-1");case"InfoWindowPosition":return this.getCommonAttValue(T,microstrategy.HTMLATTR_INFO_WIN_POSITION,"InfoWindowPosition");case"InfoWindowPositionEnabled":return this.queryState("UseAsInformationWindow")&&(this.queryState("InfoWindowMode")==4);case"TextCopyMode":case"GridCellCopyMode":return this.getCommonAttValue(T,microstrategy.HTMLATTR_IOS_COPY_MODE,"CopyMode");case"UseAsTableControl":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL,"UseAsTableControl")=="-1");case"ResetToFirstPanelWhenTargeted":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_RESET_TO_FIRST_PANEL_WHEN_TARGETED,"ResetToFirstPanelWhenTargeted")=="-1");case"EnableHorizontalSwipeToChange":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_HORIZONTAL_SWIPE_CHANGE,"EnableHorizontalSwipeToChange")=="-1");case"SwipePanelStyle":return this.getCommonAttValue(T,microstrategy.HTMLATTR_STYLE_FOR_SWIPE_PANEL,"StyleForSwitchingPanel");case"TitleBarDisplay":return this.getCommonAttValue(T,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY,"titleBarDisplay");case"panelCustomTitle":return this.queryState("IsPortal")&&this.queryState("TitleBarDisplay")=="1";case"PortalTitle":return this.getCommonAttValue(T,microstrategy.HTMLATTR_WINDOW_TITLE,"windowTitle");case"ShowElementCount":return this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_SHOW_ELEMENT_COUNT,"showElementCount")!="0";case"SetBadgeToValueOnField":return this.getCommonAttValue(T,microstrategy.HTMLATTR_SET_BADGE_TO_VALUE_ON_FIELD,"SetBadgeToValueOnField")=="-1";case"PortalState":return this.getCommonAttValue(T,microstrategy.HTMLATTR_WINDOW_STATE,"windowState");case"ExportOptions":return this.getCommonAttValue(T,microstrategy.HTMLATTR_EXPORT_OPTION,"exportOptions");case"IsLink":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_IS_LINK,"isLink")=="-1");case"HasDropShadow":return this.getCommonAttValue(T,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT,"dropShadowEffect")!="0";case"DropShadow":return this.getCommonAttValue(T,microstrategy.HTMLATTR_DROP_SHADOW,"dropShadowDepth");case"HasRoundedCorners":return this.getCommonAttValue(T,microstrategy.HTMLATTR_ROUNDED_CORNERS,"hasRoundedCorners")!="0";case"Radius":return this.getCommonAttValue(T,microstrategy.HTMLATTR_TOPLEFT_CORNER_RADIUS,"topLeftCornerRadius");case"TopCornersOnly":return this.getCommonAttValue(T,microstrategy.HTMLATTR_BOTTOMLEFT_CORNER_RADIUS,"bottomLeftCornerRadius")=="0";case"Alpha":return this.getCommonAttValue(T,microstrategy.HTMLATTR_ALPHA,"alphaOpacity");case"HasAlpha":return this.getCommonAttValue(T,microstrategy.HTMLATTR_ALPHA_EFFECT,"alphaEffect")!="0";case"Name":AS=this.getCommonAttValue(T,microstrategy.HTMLATTR_NAME,"name");return(AS!=null&&AS.length>0)?AS:microstrategy.descriptors.getDescriptor("3574");case"NewWin":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_NEW_WINDOW,"newWin")=="-1");case"Visible":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_VISIBLE,"visibility")=="-1");case"VisibleHTML":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_VISIBLE_HTML_VIEW_MODE,"showInHTMLViewMode")=="-1");case"LockAspectRatio":return this.getCommonAttValue(T,microstrategy.HTMLATTR_LOCK_ASPECT_RATIO,"lockAspectRatio")==microstrategy.TRUE;case"Category":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_CATEGORY,BE,null,BL);case"DecimalPlaces":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_DECIMAL_PLACES,BE,null,BL);case"ThousandSeparator":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_THOUSAND_SEPARATOR,BE,null,BL);case"CurrencySymbol":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_SYMBOL,BE,null,BL);case"CurrencyPosition":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_POSITION,BE,null,BL);case"NegativeNumbers":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_NEGATIVE_NUMBERS,"NegativeNumbers",null,BL);case"enableRed":return !AN.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT);case"textfieldSelected":return !AN.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT);case"Format":return this.getCommonAttValue(T,microstrategy.HTMLATTR_NUMBER_FORMAT_STRING,BE,null,BL);case"Source":return this.getCommonAttValue(T,microstrategy.HTMLATTR_IMAGE_SOURCE,"src");case"Overflow":return this.getCommonAttValue(T,microstrategy.HTMLATTR_GRID_OVERFLOW,0);case"TextOverflow":return this.getCommonAttValue(T,microstrategy.HTMLATTR_TEXT_OVERFLOW,0);case"ExportOverflow":return this.getCommonAttValue(T,microstrategy.HTMLATTR_GRID_EXPORT_OVERFLOW,0);case"QuickSwitch":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE])&&this.getCommonAttValue(T,microstrategy.HTMLATTR_QUICK_SWITCH)==microstrategy.TRUE;case"SizeMode":return this.getCommonAttValue(T,"sm");case"LineOrientation":return this.getCommonAttValue(T,microstrategy.HTMLATTR_ORIENTATION,"orientation");case"selectionsKey":return AN&&AN.getSelectionsKey();case"selectedGrid":return AN&&AN.getSelectedGrid();case"selectedPanelStack":return AN&&AN.getSelectedPanelStack();case"userMetricSelected":var Bn=microstrategy.bone("reportObjs_RWWorkingSetStyle");if(Bn){var BY=Bn.selections;if(BY.isActive()){var G=BY.firstItem();if(G){return G;}}}break;case"selectedContainer":if(AN.length==1){x=AN.firstItem();var AJ=x.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var Bo=x.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(AJ==microstrategy.OBJTYPE_DOC_OBJECT&&Bo==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var N=microstrategy.findBone(x);var CC=N.getCurrentPanel();return CC.elem;}}case"selectedSection":if(this.queryEnabled("subSectionIsSelected")){x=AN.firstItem();if(x.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return x;}else{if(AN.isSameSubSection()){return x.parentNode;}}}break;case"isOnGrid":case"getRowHeight":case"getGridWidthsObj":case"selectedGrid":case"tbanding":case"gridMode":case"graphMode":case"gridGraphMode":case"checkLockRowHeader":case"checkLockColHeader":case"checkMergeRowHeader":case"checkMergeColHeader":case"comboToggleButton":case"tsubtotals":case"checkSubtotals":case"tOutline":case"checkBanding":case"enableLegends":case"enableLabels":case"allowedGraphTypes":case"styleName":case"target":case"level":case"autostyle":case"ShowThreshold":case"toggleattforms":case"fittocontent":case"fittowindow":case"objBrowser":case"pageBy":case"reportFilter":case"viewFilter":case"formatToolbar":case"promptDetails":case"visualizationMode":case"RHS":case"RHM":case"RHL":case"CHS":case"CHM":case"CHL":case"Outline":case"Banding":case"AttForms":case"ShowThreshold":case"TitleOverlap":case"ShowDrillingOptions":case"DrillOptions":case"enableAttForms":case"enableThresholds":case"isShowHeadersAvailable":case"isMergeHeadersAvailable":case"isLockHeadersAvailable":case"isNonLinkedTemplate":case"isGridFormattingEnabled":case"XTabView":case"XTabViewDHTML":case"Shortcut":case"GraphExportOverflow":case"GraphExportOverflowSpacing":case"visFlashMode":case"visAjaxMode":case"HideNullsOrZeros":case"HideNullZeroValues":case"toggleHideNullsOrZeros":if(!AN||!AN.isOnlyOneGridSelected()){return false;}var Bf=microstrategy.findBone(AN.getSelectedGrid());return(Bf&&Bf.commands)?Bf.commands.queryState(BE):false;case"assoNodesDrill":if(!AN||!AN.isOnlyOneGridSelected()){return false;}var Bf=microstrategy.findBone(AN.getSelectedGrid()),A2=(Bf&&Bf.commands)?Bf.commands.queryState(BE):false,R=[];var AW=this.queryState("availAssoNodes");if(A2){for(var Be=0;Be<A2.length;Be++){var W=mstr.utils.Arrays.findByForm(AW,A2[Be],"dssid",false);if(W>-1){R.push(AW[W]);}}}return R;case"DataSource":if(!AN||!AN.isOnlyOneGridSelected()){return false;}var Bf=microstrategy.findBone(AN.getSelectedGrid()),y=(Bf&&Bf.commands)?Bf.commands.queryState(BE):false;return y;case"FillColor_vf":case"lncolor_vf":var Bi=(BE=="FillColor_vf")?15:10;if(!AN||!AN.isOnlyOneGridSelected()){return Bi;}Bf=microstrategy.findBone(AN.getSelectedGrid());return(Bf&&Bf.commands)?Bf.commands.queryState(BE):Bi;case"hasNoTargets":if(!AN||!AN.isOnlyOneGridSelected()){return false;}Bf=microstrategy.findBone(AN.getSelectedGrid());var A5=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_ID)||"Metrics";return(Bf&&Bf.controlLinks&&(Bf.controlLinks[A5]))?false:true;case"isOLAP":var h,V,A,Au,Ah,Bq=microstrategy.activeCXMenu.getAttribute("d1"),B5=microstrategy.activeCXMenu.getAttribute("olap"),Aq=microstrategy.findBone(this.parentBone.selections.getSelectedGrid());if(B5=="1"){return true;}if(Aq&&Bq){Ah=Bq.split("A");if(Ah&&Ah.length>=2){V=Ah[0];A=Ah[1];h=Ah[2];Au=Aq.gridStructureInfo.getUnit(V,A,h);return Au&&Au.olap;}}return false;case"gridSelectedVisualization":if(!AN||!AN.isOnlyOneGridSelected()){return false;}var Bf=microstrategy.findBone(AN.getSelectedGrid());return(Bf&&Bf.commands)?Bf.commands.queryState("selectedVisualization"):false;case"Autostyle":if(!AN||!AN.isOnlyOneGridSelected()){return false;}var Bf=microstrategy.findBone(AN.getSelectedGrid());return(Bf&&Bf.commands)?Bf.commands.queryState(BE):false;case"getControlGroupByList":if(!AN||!(AN.isOnlyOneGridSelected()||AN.isOnlyOnePanelStackSelected()||AN.isOnlyOneSelectorCtrlSelected())){return false;}var Ax=AN.getSelectedGrid()||AN.getSelectedPanelStack()||AN.getSelectedSelectorControl();var Bf=microstrategy.findBone(Ax);return(Bf&&Bf.ControlGroupByList)?Bf.ControlGroupByList:false;case"visibleShortcut":return(A7.getAvailableDatasets().length>0);case"isCubeReportDataset":return A7.isCubeReportDataset;case"autoArrange":if(!AN||!AN.isOnlyOneGridSelected()){return false;}var CA=microstrategy.findBone(AN.getSelectedGrid());if(!CA){return false;}var Bv=microstrategy.bone(CA.id+"_gb");return(Bv)?Bv.autoArrange:false;break;case"controlSubtype":x=AN.firstItem();if(x.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&x.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){Bk=microstrategy.bone(x.id+"_Ctl");if(Bk&&Bk.ctlStyle){return Bk.ctlStyle;}}return -1;case"controlOrientation":x=AN.firstItem();if(x.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&x.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){Bk=microstrategy.bone(x.id+"_Ctl");if(Bk&&Bk.ctlOrientation){return Bk.ctlOrientation;}}return -1;case"ItemWidthMode":return(this.getCommonBoneProperty(T,"itemWidthMode",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0")=="0");case"DisplaySelectorDocked":return(this.getCommonBoneProperty(T,"DisplaySelectorDocked",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0")=="-1");case"ExportAsShownOnWeb":return this.getCommonBoneProperty(T,"aow",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"exportSelectorTriState":return this.queryState("ExportAsShownOnWeb");case"availableWidgets":if(AN.isOnlyOneGridSelected()){return[{dssid:"None",n:microstrategy.descriptors.getDescriptor("2057")}].concat(A7.getAvailableWidgets(microstrategy.SUBOBJTYPE_DOC_TEMPLATE));}else{if(this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL])){return[{dssid:"None",n:microstrategy.descriptors.getDescriptor("5028")}].concat(A7.getAvailableWidgets(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL));}}return[{dssid:"None",n:microstrategy.descriptors.getDescriptor("2057")}];case"XTabViewModes":var d=[{dssid:"1",n:microstrategy.descriptors.getDescriptor("2975")},{dssid:"2",n:microstrategy.descriptors.getDescriptor("115")},{dssid:"3",n:microstrategy.descriptors.getDescriptor("2972")}];if(this.queryVisible("visFlashMode")){d=d.concat({dssid:"50",n:microstrategy.descriptors.getDescriptor("4921")});}return d;case"EditSelectorMetricQualType":return"4";case"EditSelectorType":if(AN.isOnlyOneTableSelected()){return -1;}else{var X=this.queryState("EditSelectorStyle");if(X==="11"){return mstrRWControlImpl.CTL_TYPE_ATTR_QUAL;}return this.getCommonBoneProperty(T,"ctlType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");}case"UpdateFilterTarget":var Am;if(this.queryState("isDDIC")){var Bm=AN.firstItem()&&AN.firstItem().id;Am=A7.formattingAttributes[Bm]&&A7.formattingAttributes[Bm]["adts"];}else{Am=this.getCommonAttValue(T,"adts","ActionForDirectTargetSelectors")||"0";}return Am;case"controlQualType":var B4=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());return B4.mct;case"showControlIncludeMenu":var Al=this.queryState("EditSelectorType");var X=this.queryState("EditSelectorStyle");return(this.queryState("EditSelectorType")==mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST&&"01234567".indexOf(X)>-1)?true:false;case"showMetricConditionType":return this.queryState("isMetricQualifier");case"isMetricQualifier":var Aa=this.queryState("EditSelectorStyle");return Aa=="7"||Aa=="8";case"isMetricQualifierStyle":return this.queryState("EditSelectorStyle")=="8";case"isNormalSelector":return !this.queryState("isMetricQualifier")&&!this.queryState("isActionSelector")&&!this.queryState("showTableButtons")&&!this.queryState("isDDIC");case"DataFilterVisible":return this.queryState("isNormalSelector")&&!this.queryState("isDSAsTarget")&&!this.queryState("attrReplaceLCVisible")||this.queryState("isDDIC");case"selectorAutoSyncVisible":case"showTotalVisible":case"countVisible":return !this.queryState("isMetricQualifier")&&!this.queryState("isDSAsTarget")&&(BE==="selectorAutoSyncVisible"||!this.queryState("isDDIC"))&&!this.queryState("isAQSelector");case"selectionTypeVisible":return(this.queryState("EditSelectorType")==1||this.queryState("EditSelectorType")==7)&&!this.queryState("isDSAsTarget")&&!this.queryState("isDDIC");case"attrLCVisible":var Aa=this.queryState("EditSelectorType");return !(Aa==2||Aa==4||Aa==8)&&!this.queryState("isDSAsTarget");case"metricLCVisible":return(this.queryState("EditSelectorType")==2)&&!this.queryState("isDSAsTarget");case"datasetLCVisible":return !(this.queryState("EditSelectorType")==2)&&this.queryState("isDSAsTarget");case"attrReplaceLCVisible":return(this.queryState("EditSelectorType")==8)&&!this.queryState("isDSAsTarget");case"submissionLCVisible":return this.queryState("EditSelectorType")==4&&!this.queryState("isDSAsTarget");case"transactionEnabled":return this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_CONFIGURE_TRANSACTIONS);case"isActionSelector":return this.queryState("EditSelectorType")=="4";case"isPanelStackSelector":return this.queryState("EditSelectorType")=="3";case"isAQSelector":return this.queryState("EditSelectorType")=="7";case"isDDIC":var Be=0,Ak=this.parentBone.selections,CD=this.parentBone.selections.items,CH=Ak.getTypes();for(Be=0,Ab=CH.length;Be<Ab;Be++){if(CH[Be]!==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT){return false;}}for(Be in CD){var x=CD[Be];if(!this.getDDICBoneProperty(T,"ddic",microstrategy.SUBOBJTYPE_DOC_TEXT,null)){return false;}}return true;case"runReportDocName":return this.getCommonBoneProperty(T,"execName",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"actionSelectorType":return this.getCommonBoneProperty(T,"ast",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"postSubmitOption":var AV=this.getCommonBoneProperty(T,"pso",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");return(AV==null)?"8":AV;case"DisplayText":return this.getCommonBoneProperty(T,"dpTxt",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"ShowSubmitMessage":return this.getCommonBoneProperty(T,"shSubMsg",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"SubmitMessage":return this.getCommonBoneProperty(T,"subMsg",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"OfflineSubmission":var A4=this.getCommonBoneProperty(T,"os",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);return A4===undefined?true:A4;case"TXNSubmitInOrder":return this.getCommonBoneProperty(T,"sio",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"DisplayConfirmation":return this.getCommonBoneProperty(T,"dpCfm",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"InvalidateCache":case"ForceLiveExecution":case"AutoAnswerPrompt":case"TableSubmitText":var Bb={runReportDocName:"execName",actionSelectorType:"ast",postSubmitOption:"pso",DisplayText:"dpTxt",ShowSubmitMessage:"shSubMsg",SubmitMessage:"subMsg",OfflineSubmission:"os",DisplayConfirmation:"dpCfm",InvalidateCache:"invCache",ForceLiveExecution:"fcLvExec",AutoAnswerPrompt:"aapm",TableSubmitText:"dpTxt",TXNSubmitInOrder:"sio"},e;if(AN.isOnlyOneTableSelected()){var Bk=AN.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(Bk&&Bk.isTable){e=Bk.querySelectorState(Bb[BE],"submitBtn");}}else{e=this.getCommonBoneProperty(T,Bb[BE],microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);}if(BE=="postSubmitOption"){e=(e==null)?"8":e;}return e;case"TableCancelText":case"TableCancelConfirmation":var Bd={TableCancelConfirmation:"dpCfm",TableCancelText:"dpTxt"},e;if(AN.isOnlyOneTableSelected()){var Bk=AN.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(Bk&&Bk.isTable){e=Bk.querySelectorState(Bd[BE],"cancelBtn");}}return e;case"TableCancelType":var Bc=microstrategy.descriptors;return this.queryState("UseAsInformationWindow")?Bc.getDescriptor("11174"):Bc.getDescriptor("11175");case"showSelectorStyle":return this.queryState("isSelector")&&!this.queryState("isActionSelector")&&!this.queryState("isAQSelector");case"hasSelectorTitle":return this.queryState("isSelector")&&!this.queryState("isActionSelector");case"hasElemCount":return this.queryState("isSelector")&&!this.queryState("isAQSelector");case"EditSelectorStyleMetricQual":case"EditSelectorStyle":case"EditSelectorStyleSingleSelect":case"EditSelectorStyleAction":return this.getCommonBoneProperty(T,"ctlStyle",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"EditSelectorOrientation":return this.getCommonBoneProperty(T,"ctlOrientation",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"EditSelectorMouseOverAction":return this.getCommonBoneProperty(T,"mouseOverAction",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorShowAll":return this.getCommonBoneProperty(T,"showAll",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorAllAlias":return this.getCommonBoneProperty(T,"allAlias",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"EditSelectorShowTotal":return this.getCommonBoneProperty(T,"showTotal",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorTotalPosition":return this.getCommonBoneProperty(T,"totalPosition",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorMultiSelect":return this.getCommonBoneProperty(T,"multiSelect",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorSearchOnServ":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_SEARCH_ON_SERVER,"SearchOnServer")=="-1");case"EditSelectorNoSelectionBehavior":return this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_NO_SELECTION_BEHAVIOR,"NoSelectionBehavior");case"MinSel":var BZ=this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_MIN_SELECTION_COUNT,"MinSelectionCount");return(BZ>=0?BZ:"");case"MaxSel":var AM=this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_MAX_SELECTION_COUNT,"MaxSelectionCount");return(AM>=0?AM:"");case"EnableSelCount":var BZ=this.queryState("MinSel"),AM=this.queryState("MaxSel");return(BZ!==""||AM!=="");case"EditSelectorAutoSync":var AT=false;if(this.queryState("isDDIC")){AT=this.getDDICBoneProperty(T,"autoSync",microstrategy.SUBOBJTYPE_DOC_TEXT,false);}else{AT=this.getCommonBoneProperty(T,"autoSync",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);}return AT;case"EditSelectorSource":case"EditSelectorSourceMetrics":var Bl=this.getCommonBoneProperty(T,"ctlSrcId",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),CG=this.getCommonBoneProperty(T,"ctlSrcType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),Y=this.getCommonBoneProperty(T,"ctlSrcName",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);if(CG==100||CG==101){CG=4;}if(Y!=null){Y=((Y.indexOf("]")==Y.length-1)?Y.substring(0,Y.length-1):Y);Y=((Y.indexOf("[")==0)?Y.substring(1,Y.length):Y);}return(Bl!=null&&CG!=null&&Y)?Bl+"|"+CG+"|"+Y:"";case"EditSelectorSourceAttributes":var B2=this.getCommonBoneProperty(T,"replaceAttId",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),Bz=this.getCommonBoneProperty(T,"replaceAttType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),D=this.getCommonBoneProperty(T,"replaceAttName",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);if(Bz==100||Bz==101){Bz=4;}if(D!=null){D=((D.indexOf("]")==D.length-1)?D.substring(0,D.length-1):D);D=((D.indexOf("[")==0)?D.substring(1,D.length):D);}return(B2!=null&&Bz!=null&&D)?B2+"|"+Bz+"|"+D:"";case"IsSelectorSourceNDE":var CG=this.getCommonBoneProperty(T,"ctlSrcType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),Ar=this.getCommonBoneProperty(T,"ctlSrcSubtype",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);return CG==microstrategy.DSSTYPE_CONSOLIDATION&&Ar=="12033";case"EditSelectorSourceDDIC":return this.getDDICBoneProperty(T,"ctlSrc",microstrategy.SUBOBJTYPE_DOC_TEXT,null)||"";case"EditFormDelimiter":return this.getCommonBoneProperty(T,"formDelimiter",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"EditDisplayForm":return this.getCommonBoneProperty(T,"displayFormType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"selectedAttrForms":return this.getCommonBoneProperty(T,"attrForms",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"sortAttrForm":return this.getCommonBoneProperty(T,"sortAttrForm",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"sortType":return this.getCommonBoneProperty(T,"sortType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"EditSelectorSelectionType":return this.getCommonBoneProperty(T,"include",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");case"EditSelectorMetricConditionType":return this.getCommonBoneProperty(T,"mct",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0")||0;case"availableTemplates":case"availableTemplatesNoSelectors":case"availableTemplatesNoPlaceholder":Bk=microstrategy.getBonesByType([microstrategy.OBJTYPE_GRID,microstrategy.OBJTYPE_GRAPH]);var B1=this.queryState("isActionSelector"),AH=this.queryState("isMetricQualifier"),BV=this.queryState("isAQSelector"),AU=!B1&&!AH&&(BE=="availableTemplates"||BE==="availableTemplatesNoPlaceholder"),BD=(BE=="availableTemplates"),K={},BJ=[];for(Be=0;Be<Bk.length;Be++){AA=Bk[Be].objId;if(!document.getElementById(AA)){continue;}var Bu=this.parentBone.styleObj.getAttValue(document.getElementById(AA),microstrategy.HTMLATTR_NAME);if(!(AA in K)){BJ.push({dssid:AA,n:Bu});K[AA]=true;}if(AU){var A3={},CB=Bk[Be].gridStructureInfo,Ai=Bk[Be].tscObjs;mstr.$A.forEach(CB.allAxes,function(g){mstr.$A.forEach(g.units,function(CI){if(CI.dssId){A3[CI.dssId]=true;}});});if(Ai){mstr.$A.forEach(Ai,function(g){if(g.ctl&&g.ctl.ddic&&A3[g.did]){BJ.push({dssid:g.ctl.ctlKey,n:Bu+":"+g.n});}});}}if(BD){var AE=Bk[Be].phs,BP,BN,Ay;for(BN=0;AE&&AE.length&&BN<AE.length;BN++){BP=AE[BN];Ay=AA+"_"+BP.idx;if(!(Ay in K)){BJ.push({dssid:Ay,n:Bu+":"+BP.n});K[Ay]=true;}}}}var Am=BJ.concat(this.queryState("panelStackTargets"));if(AU){Am=Am.concat(this.queryState("panelStackTargetsDDIC"));}if(B1||BV||BE=="availableTemplatesNoSelectors"){return Am;}else{return Am.concat(this.queryState("availableSelectors"));}case"availAssoNodes":if(!AN||!AN.isOnlyOneGridSelected()){return false;}var K={};var Bf=microstrategy.findBone(AN.getSelectedGrid());K[Bf.RWUnitId]=true;Bk=microstrategy.getBonesByType([microstrategy.OBJTYPE_GRID,microstrategy.OBJTYPE_GRAPH]);var AW=[];for(Be=0;Be<Bk.length;Be++){AA=Bk[Be].RWUnitId;if(!document.getElementById(AA)||Bk[Be].isOnClipBoard||(AA in K)||(Bk[Be].commands&&Bk[Be].commands.queryState("Shortcut"))){continue;}AW.push({dssid:AA,n:this.parentBone.styleObj.getAttValue(document.getElementById(AA),microstrategy.HTMLATTR_NAME)});K[AA]=true;}return AW;case"availableTemplatesDataset":var f=microstrategy.getViewerBone();var AG=[];for(var AA in f.documentDataSets){var AX=f.documentDataSetsIsCube[AA],Bs=f.datasetInfos[AA].auct;if(AX==false&&Bs){AG.push({dssid:AA,n:f.documentDataSets[AA]});}}return AG;case"availablePanelStacks":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(this.queryState("panelStackTargets"));case"availableSelectors":Bk=microstrategy.getBonesByType([microstrategy.OBJTYPE_RW_CONTROL]);var A6=[],CE=this.queryState("isDDIC")||this.queryState("isMetricQualifier")||this.queryState("EditSelectorType")==1;for(Be=0;Be<Bk.length;Be++){AA=Bk[Be].RWUnitId;if(!document.getElementById(AA)||Bk[Be].boneSelected||Bk[Be].isOnClipBoard||Bk[Be].ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION||(Bk[Be].ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK&&CE)||Bk[Be].ctlStyle==mstrRWControlImpl.CTL_STYLE_ATTR_QUALIFICATION){continue;}A6.push({dssid:AA,n:this.parentBone.styleObj.getAttValue(document.getElementById(AA),microstrategy.HTMLATTR_NAME)});}return A6;case"selectorCurrentStateOptsUC":case"selectorCurrentStateOpts":var At=BE=="selectorCurrentStateOptsUC",Am=[],Ba,Af=!this.queryState("isSelectorUnset"),c=microstrategy.descriptors;if(Af){Am[Am.length]={dssid:"-1",n:c.getDescriptor("7625")};}Ba=Am.length;if(At){Am[Ba]={dssid:"1",n:c.getDescriptor("7622")};}else{if(Af){Am[Am.length]={dssid:"-1",n:c.getDescriptor("7625")};}Ba=Am.length;Am[Ba]={dssid:"2",n:c.getDescriptor("7623")};Am[Ba+1]={dssid:"4",n:c.getDescriptor("7624")};}return Am;case"isSelectorUnset":var Bm=AN.firstItem()&&AN.firstItem().id,F=A7.formattingAttributes[Bm]&&A7.formattingAttributes[Bm]["isUs"];return F==undefined?true:F;case"selectorCurrentStateUC":return this.queryState("isSelectorUnset")?"1":"-1";case"selectorCurrentState":if(!this.queryState("isSelectorUnset")){return"-1";}else{var Bm=AN.firstItem()&&AN.firstItem().id,Bw=A7.formattingAttributes[Bm]&&A7.formattingAttributes[Bm]["ust"];if(Bw==1){Bw=2;}return Bw||2;}case"selectorTabTitle":return AN.isOnlyOneTableSelected()?microstrategy.descriptors.getDescriptor("7821"):microstrategy.descriptors.getDescriptor("4728");case"UnsetCount":var Bm=AN.firstItem()&&AN.firstItem().id;return A7.formattingAttributes[Bm]&&A7.formattingAttributes[Bm]["usc"];case"panelStackTargets":var B0=[],Bk=microstrategy.getBonesByType(microstrategy.OBJTYPE_PANEL_STACK);for(Be=0;Be<Bk.length;Be++){AA=Bk[Be].id;if(!document.getElementById(AA)||Bk[Be].isOnClipBoard){continue;}B0.push({dssid:AA,n:this.parentBone.styleObj.getAttValue(Bk[Be].elem,microstrategy.HTMLATTR_NAME)});}return B0;case"panelStackTargetsDDIC":var J=this,Am=[],By=AN.firstItem()&&AN.firstItem().getAttribute("trxctlkey"),Bk=microstrategy.getBonesByType(microstrategy.OBJTYPE_PANEL_STACK),BM=this.queryState("isDDIC");for(Be=0;Be<Bk.length;Be++){AA=Bk[Be].id;if(!document.getElementById(AA)||Bk[Be].isOnClipBoard){continue;}var B0=Bk[Be].panels||[];mstr.$A.forEach(B0,function(CI){var g=CI.tscObjs;if(g){mstr.$A.forEach(g,function(CJ){if(CJ.ctl&&CJ.ctl.ddic&&CJ.ctl.ctlKey!=By&&document.getElementById(CJ.key)){Am.push({dssid:CJ.ctl.ctlKey,n:J.parentBone.styleObj.formattingAttributes[CJ.key]["nm"]});}});}});}return Am;case"EditSelectorTargetsSingleSelect":var k=this.getCommonBoneProperty(T,"ctlType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");if(this.parentBone.parentBone.autoWire){if(k==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){var BW=this.getCommonBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);return BW;}else{var Ac=microstrategy.findBone(this.queryState("selectedSection")),BH=Ac&&Ac.findObjects&&Ac.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(BH&&BH.length==1){return BH[0].getAttribute("id");}else{return"";}}}else{if(k!=mstrRWControlImpl.CTL_TYPE_PANEL_STACK){return"";}else{var BW=this.getCommonBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);return(BW.length>0)?BW[0]:"";}}case"EditSelectorTargetsMetrics":case"EditSelectorTargets":case"EditSelectorTargetsNoPlaceholder":case"EditSelectorTargetsAttributes":var k=this.getCommonBoneProperty(T,"ctlType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");var J=this;var I=[];var Aj=function(CM,CJ,CI){var CO,CN,CL,g,CK;for(Be=0;Be<CM.length;Be++){if(document.getElementById(CM[Be])){if(!CI||!(J.parentBone.styleObj.getAttValue(document.getElementById(CM[Be]),microstrategy.HTMLATTR_OBJTYPE) in CI)){I.push({dssid:CM[Be],n:J.parentBone.styleObj.getAttValue(document.getElementById(CM[Be]),microstrategy.HTMLATTR_NAME)});}}else{if(CM[Be]&&CM[Be].split("_").length===2){CO=CM[Be].split("_");g=document.getElementById(CO[0]);CN=microstrategy.findBone(g);if(CN&&CN.phs&&BE!=="EditSelectorTargetsNoPlaceholder"){var CP=mstr.utils.Arrays.findByForm(CN.phs,CO[1],"idx",false);if(CP>=0){CL=CN.phs[CP];CK=J.parentBone.styleObj.getAttValue(g,microstrategy.HTMLATTR_NAME);I.push({dssid:CM[Be],n:CK+":"+CL.n});}}}else{if(CJ&&CJ[CM[Be]]){I.push({dssid:CM[Be],n:CJ[CM[Be]]});}}}}return I;};if(this.parentBone.parentBone.autoWire){if(k==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){var BI=microstrategy.findBone(this.queryState("selectedSection"));var Ag=BI.findObjects(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);Ag=Ag.concat(BI.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK));var A0=[];var AR={};for(var Be=0,Av=Ag.length;Be<Av;Be++){var AP=microstrategy.findBone(Ag[Be]);var Bt=AP.objId||AP.id;if(AR[Bt]!=true){A0.push(Bt);AR[Bt]=true;}}return Aj(A0);}else{var Ag=J.getCommonBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);var AO=J.getCommonBoneProperty(T,"targetNames",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);return Aj(Ag,AO);}}else{if(k==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){return[];}else{var Ag=J.getCommonBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);var AO=J.getCommonBoneProperty(T,"targetNames",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,{});if(this.queryState("isDDIC")){Ag=Ag.concat(J.getDDICBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"").split(CLIPBOARD_ITEM_SEPARATOR));}var BW=this.queryState("availableTemplates");AO=AO||{};for(var H in BW){AO[BW[H].dssid]=BW[H].n;}return Aj(Ag,AO,(BE=="EditSelectorTargetsMetrics"||BE=="EditSelectorTargetsAttributes")?{111:true}:null);}}case"EditSelectorCandidateAttributes":return this.getCommonBoneProperty(T,"candidateAtts",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);case"EditSelectorTargetsDataset":var I=[],U=this.getCommonBoneProperty(T,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]),f=microstrategy.getViewerBone(),AL=f.documentDataSets||[];for(var Be=0,Av=U.length;Be<Av;Be++){var AA=U[Be];if(AL[AA]&&f.datasetInfos[AA].auct){I.push({dssid:AA,n:AL[AA]});}}return I;case"isDSAsTarget":return(this.getCommonBoneProperty(T,"ctlTargetType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[])==mstrRWControlImpl.CTL_TARGET_TYPE_DATASET);case"dsAsTgtChkVisible":var Ar=parseInt(this.getCommonBoneProperty(T,"ctlSrcSubtype",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null)),CG=this.getCommonBoneProperty(T,"ctlSrcType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);if(isNaN((Ar))){Ar=-1;}return(this.queryState("EditSelectorType")==1)&&CG===microstrategy.DSSTYPE_ATTRIBUTE&&Ar!==microstrategy.DSSSUB_TYPE_DERIVED_ATTRIBUTE;case"showTooltip":return this.queryEnabled("ToolTip");case"showNavigationProps":return this.queryEnabled("IsLink")&&!this.queryState("isButton");case"showVisibleInHTMLViewMode":var AZ=this.queryEnabled("VisibleHTML");if(AZ){for(AA in T){var A8=T[AA].getAttribute("dt");if(A8==-1||A8==-2){return false;}}}return AZ;case"docked":if(this.queryState("isSection")){var B7=this.getCurrentSectionDef();return B7&&B7.dc;}return false;case"showHTMLContainer":return this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE)&&this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_CREATE_HTML_CONTAINER)&&this.queryEnabled("HTMLType");case"showPortal":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE]);case"showPanelStackTitle":if(this.queryState("isNavBar")){return false;}if(AN.atLeastOneTableSelected()){return false;}case"isPanelStack":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]);case"showAdvanced":return !this.queryState("isActionSelector")&&!AN.isOnlyOneTableSelected()&&!this.queryState("attrReplaceLCVisible");case"showTableDisplayMode":case"showTableButtons":return AN.isOnlyOneTableSelected();case"showAutoWireMessage":return this.queryState("Autowire")&&!AN.isOnlyOneTableSelected()&&!this.queryState("isDSAsTarget");case"fpAutoSubmit":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_CTL_AUTO_SUBMIT,"CtlAutoSubmit")=="-1");case"isFilterPanel":return this.getCommonBoneProperty(T,"isFilterPanel",microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);case"showGridIf":var m=this.queryState("XTabView");return m==1||m==3;case"showTransition":return !this.queryState("isSelector");case"showFlushMsg":var AB=microstrategy.updateManager;return AB.commands.queryEnabled("apply");case"isSection":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_SUBSECTION]);case"showSize":return !this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_SUBSECTION,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"showPageBreak":return(this.queryState("isSection")&&AN.firstItem().getAttribute("dt")!="-3");case"isSelector":case"showItem":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL]);case"showFixedWidthOnly":return !this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])||this.queryState("IsPortal");case"showFixedHeightOnly":return !this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])||this.queryState("IsPortal")||this.queryState("isButton");case"showFixed100Width":case"showFixed100Height":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND]);case"showFixedFitWidth":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])&&!this.queryState("IsPortal");case"showFixedFitHeight":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])&&!this.queryState("IsPortal")&&!this.queryState("isButton");case"isOneGrid":return AN.isOnlyOneGridSelected();case"wasFullScreen":return this.parentBone.parentBone.curWgtId||false;case"isHorizontalSubsection":return this.queryEnabled("isSubsectionHorizontal");case"isImage":return this.queryEnabled("Source");case"isLine":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"showLockAspectRatio":if(this.queryState("onlyButtons")){return true;}return this.queryState("isImage");case"showTitleHeight":return(this.queryState("showPortal")||this.queryState("showPanelStackTitle")||this.queryState("isSelector"));case"setWidget":var AF=this.getCommonAttValue(T,"twc","ClassName");switch(AF){case"com.microstrategy.flex.viewer.HeatMapViewer":AF="../swf/HeatMapWidget.swf";break;case"com.microstrategy.flex.viewer.GaugeContainer":AF="../swf/GaugeWidget.swf";break;case"com.microstrategy.flex.viewer.InteractiveBubblePlotComponent":AF="../swf/InteractiveBubbleWidget.swf";break;}return this.getCommonAttValue(T,"rsl","RSLPath")||AF||"None";case"NonFlashRender":return this.getCommonAttValue(T,"nfr","NonFlashRender");case"setTransition":var AI=this.getCommonAttValue(T,"ttr","Transition");return AI!=""?AI:"None";case"setTransDuration":return this.getCommonAttValue(T,"tdr","Duration");case"PSPreLoadAllPanels":return this.getCommonAttValue(T,"plp","PSPreLoadAllPanels");case"ClipOnExport":return this.getCommonAttValue(T,"cone","IgnoreInExport")==microstrategy.FALSE;case"allowPanelsToSplitAcrossPages":return this.getCommonAttValue(T,"spcp","SplitPanelAcrossPages")==microstrategy.TRUE||this.queryState("expandPanels")==0;case"panelOverflowSpacing":return this.getCommonAttValue(T,"povfs","RepeatPanelSpacing");case"expandPanels":return this.getCommonAttValue(T,"ep","ExpandAllPanels");case"panelOverflowSpacingEnabled":return this.queryState("expandPanels")!=0&&this.queryState("ClipOnExport");case"gridIfEnabled":return this.getCommonAttValue(T,"gif","gridIfEnabled")!="0";case"gridIfMaxRows":return this.getCommonAttValue(T,"gmr","gridIfMaxRows");case"gridIfRowMode":return this.getCommonAttValue(T,"gifmd","gridIfRowMode");case"XTabPos":return this.getCommonAttValue(T,microstrategy.HTMLATTR_GRID_POS,"gridPosition");case"XTabPer":return this.getCommonAttValue(T,microstrategy.HTMLATTR_GRID_AREA_PCT,"gridArea");case"TitleHeight":if(!AN.isActive()){return"";}var BL=2;if(AN.isSelectorControlSelected()){BL=mstrRWControlImpl.FMT_TYPE_TITLE;}var o=this.getCommonAttValue(T,microstrategy.HTMLATTR_HEIGHT,"height",false,BL);return(o&&o.length>0)?microstrategy.number.toUserUnits(o):"";case"showFillColor":return this.queryEnabled("backgroundColor")&&!this.queryState("onlyButtons");case"enableFillColor":return(!AN.isOnlyOneGridSelected()||AN.gridUnitFormatX!=microstrategy.GRID_BORDERS);case"showBorders":return AN.isOnlyOneTableSelected()?(AN.panelUnitFormat==0):(this.queryEnabled("AllColor")&&!this.queryState("isNavBar"));case"enableBorders":if(AN.isOnlyOneGridSelected()){return(!AN.isGridContainerSelected()||AN.gridValueFormatX==1);}else{if(AN.isOnlyOneTableSelected()){return true;}else{if(AN.isOnlyOnePanelStackSelected()){return(AN.panelValueFormat!=1);}else{if(AN.isSelectorControlSelected()){return(AN.controlValueFormat!=mstrRWControlImpl.FMT_TYPE_TITLE_BASE);}}}}return true;case"showLineColor":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE])||(AN.isOnlyOneTableSelected()&&AN.panelUnitFormat>0);case"isText":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT]);case"iOSOnlyCopyVisible":return this.queryState("isText")&&!this.queryState("isButton");case"isButton":for(var x in AN.items){if(microstrategy.styleObj.getAttValue(AN.items[x],microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT&&microstrategy.styleObj.getAttValue(AN.items[x],microstrategy.HTMLATTR_DISPLAY_STYLE)>0){return true;}}return false;case"ShowInfoWindowTargets":return this.queryState("isButton")||microstrategy.isEnabled(AN.isVisible&&AN.items,this.qeMap.InformationWindowTarget);case"ShowMobile":return this.queryState("isText")&&!this.queryState("isButton");case"onlyButtons":for(var x in AN.items){if(microstrategy.styleObj.getAttValue(AN.items[x],microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_TEXT||microstrategy.styleObj.getAttValue(AN.items[x],microstrategy.HTMLATTR_DISPLAY_STYLE)<1){return false;}}return true;case"multiButtons":return this.queryState("onlyButtons")&&AN.length>1;case"isNavBar":return AN.isOnlyOneNavBarSelected();case"showTextControl":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT])||this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER])||this.queryEnabled("showGridSelectors");case"showPadding":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT])||this.queryEnabled("showGridSelectors");case"showCorners":var z=this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK])&&!AN.isOnlyOneTableSelected();var AC=this.queryState("isRoundShape");return((z&&!AC)||(!z&&AC));case"isRoundShape":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_STYLE,"hasRoundedCorners")==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);case"show3dBorders":return !this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"showTextOverflow":return this.queryState("isText")&&!this.queryState("isButton");case"showContentOverflow":return this.queryState("isPanelStack")&&!this.queryState("isNavBar")&&!AN.atLeastOneTableSelected();case"getCachedObjectFormatLevels":return this.parentBone.selections.getCachedObjectFormatLevels();case"areGridFormatsReady":return AN.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE).commands.queryState(BE);case"tbEmptySelector":return{items:[],value:""};case"tbPanelUnitSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4727")},{dssid:1,n:microstrategy.descriptors.getDescriptor("4758")}],value:AN.panelUnitFormat};case"tbTableUnitSelector":var Bc=microstrategy.descriptors;var Az=AK=="font";tus=Az?[]:[{dssid:0,n:Bc.getDescriptor("7755")}];Az&&tus.push({dssid:2,n:Bc.getDescriptor("4024")});if(Az){tus.push({dssid:3,n:Bc.getDescriptor("11176")});}return{items:tus,value:AN.panelUnitFormat};case"tbTableValueSelector":var Bc=microstrategy.descriptors;var Au=parseInt(this.parentBone.selections.panelUnitFormat),P=AK=="font";if(P){if(Au==2){return{items:[{dssid:1,n:Bc.getDescriptor("4756")}],enabled:false,value:AN.panelValueFormat};}else{if(Au==3){return{items:[{dssid:1,n:Bc.getDescriptor("4756")},{dssid:3,n:Bc.getDescriptor("527")}],value:AN.panelValueFormat};}}}else{if(Au==2){return{items:[{dssid:4,n:Bc.getDescriptor("11177")}],formatEnabled:false,value:AN.panelValueFormat};}else{if(Au==0){return{items:[{dssid:0,n:Bc.getDescriptor("4579")}],value:AN.panelValueFormat};}}}case"tbPanelValueSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4579")},{dssid:1,n:microstrategy.descriptors.getDescriptor("3297")}],value:AN.panelValueFormat};case"tbSelectorControlUnitSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4728")}],value:AN.controlUnitFormat};case"tbSelectorControlValueSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4579")},{dssid:mstrRWControlImpl.FMT_TYPE_TITLE_BASE,n:microstrategy.descriptors.getDescriptor("3297")}],value:AN.controlValueFormat};case"tbGridContainerValueSelector":return{items:[{dssid:1,n:microstrategy.descriptors.getDescriptor("4579")},{dssid:2,n:microstrategy.descriptors.getDescriptor("3297")}],value:AN.gridValueFormatX};case"tbUnitSelector":if(this.queryEnabled("onepanelstack")){return this.queryState("tbPanelUnitSelector");}case"tbGridUnitSelector":case"AllGridUnitSelector":Aq=microstrategy.findBone(AN.getSelectedGrid());if(!Aq){return this.queryState("tbEmptySelector");}var AD=Aq.commands.queryState(BE)||{items:[],value:""};if(Aq.isGrid){var CD=[];if(AD.items.length&&AD.items[0].dssid==-1){CD=[AD.items.shift()];}var B=(BE!="AllGridUnitSelector")?"**grid":"";CD=CD.concat([{dssid:microstrategy.GRID_UNIT_CONTAINER+B,n:microstrategy.descriptors.getDescriptor("4753"),cssClass:"ToolbarList UGC"},{dssid:microstrategy.GRID_BORDERS+B,n:microstrategy.descriptors.getDescriptor("3798"),cssClass:"ToolbarList UGB"}]).concat(AD.items);AD.items=CD;}return AD;case"showEditorSelector":return !this.queryState("isNavBar");case"edtUnitSelector":var Bp={visible:false,enabled:true,items:[]};this.parentBone.selections.verifyFormatLevels(AK);if(AN.isOnlyOneGridSelected()&&AK){Aq=AN.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(!Aq){return this.queryState("tbEmptySelector");}var Q=Aq.commands.queryState("graphMode");if(Q||microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){Bp.value=microstrategy.GRID_UNIT_CONTAINER;}else{Bp=this.queryState(AK=="color"?"AllGridUnitSelector":"GridUnitSelector");}var q=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&AK=="color");if(AK=="font"||q||Q){if(this.queryState("IsPortal")){Bp.items=[{dssid:microstrategy.GRID_UNIT_CONTAINER,n:microstrategy.descriptors.getDescriptor("4753"),cssClass:"ToolbarList UGC"}].concat(Bp.items);Bp.visible=true;}else{if(q){Bp.visible=false;}else{Bp.visible=!Q;}}}else{Bp.visible=true;}Bp.enabled=true;}else{if(AN.isOnlyOneTableSelected()){n(AN,AK);Bp=this.queryState("tbTableUnitSelector",AK);Bp.enabled=true;Bp.visible=(AK&&(AK=="color"||AK=="font"));}else{if(AN.isOnlyOnePanelStackSelected()){Bp=this.queryState("tbPanelUnitSelector");Bp.enabled=true;Bp.visible=(AK&&AK=="color");}else{if(AN.isSelectorControlSelected()){Bp=this.queryState("tbSelectorControlUnitSelector");Bp.enabled=true;Bp.visible=(AK&&(AK=="color"||AK=="font")&&this.queryState("IsPortal"));}}}}return Bp;case"edtValueSelector":var B8={visible:false,enabled:true};if(AN.isOnlyOneGridSelected()){if(AN.isGridContainerSelected()){if(AK&&(AK=="color"||AK=="font")){B8=this.queryState("tbGridContainerValueSelector");B8.visible=this.queryState("IsPortal");B8.enabled=(AK!="font");}}else{B8=this.queryState("AllGridUnitValueSelector");B8.visible=this.queryState("edtUnitSelector",AK).value>microstrategy.GRID_BORDERS;B8.enabled=true;}}else{if(AN.isOnlyOneTableSelected()){n(AN,AK);B8=this.queryState("tbTableValueSelector",AK);B8.visible=(AK&&(AK=="color"||AK=="font"));}else{if(AN.isOnlyOnePanelStackSelected()){B8=this.queryState("tbPanelValueSelector");B8.visible=(AK&&AK=="color"&&this.parentBone.commands.queryState("IsPortal"));B8.enabled=(AN.panelUnitFormat==0);}else{if(AN.isSelectorControlSelected()){B8=this.queryState("tbSelectorControlValueSelector");B8.visible=this.parentBone.selections.areAllSameSubtypeSelected(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)&&(AK&&(AK=="color"||AK=="font")&&this.parentBone.commands.queryState("IsPortal"));B8.enabled=(AN.controlUnitFormat==0);}}}}return B8;case"tbValueSelector":case"tbGridValueSelector":if(this.queryEnabled("onepanelstack")){return this.queryState("tbPanelValueSelector");}if(this.queryEnabled("onecontrol")){return this.queryState("tbSelectorControlValueSelector");}if(AN.isGridContainerSelected()&&!AN.getSelectedGridProperty("graphSelected")){AN.gridValueFormatX=Math.min(AN.gridValueFormatX,2);var AQ=this.queryState("tbGridContainerValueSelector");AQ.isFetching=false;return AQ;}case"GridUnitSelector":case"AllGridUnitValueSelector":case"GridUnitValueSelector":Aq=microstrategy.findBone(AN.getSelectedGrid());return(Aq&&Aq.commands.queryState(BE))||{items:[],value:""};case"PanelUnitSelector":return AN.panelUnitFormat;case"PanelUnitValueSelector":return AN.panelValueFormat;case"appliedThemeID":var Bm=AN.firstItem()&&AN.firstItem().id,A1=Bm&&A7.formattingAttributes[Bm]&&A7.formattingAttributes[Bm]["thmid"];return A1;case"appliedThemeAsLink":var Bm=AN.firstItem()&&AN.firstItem().id,E=Bm&&A7.formattingAttributes[Bm]&&A7.formattingAttributes[Bm]["thmlnk"];return !!E;case"appliedLinkedTheme":return microstrategy.hasAppliedTheme(AN.firstItem(),true);case"appliedTheme":return microstrategy.hasAppliedTheme(AN.firstItem());case"appliedThemePath":var Bm=AN.firstItem()&&AN.firstItem().id,BO=Bm&&A7.formattingAttributes[Bm]&&A7.formattingAttributes[Bm]["thmpath"];return microstrategy.isDefaultTheme(A1)?null:BO;case"appliedThemeType":var A1=this.queryState("appliedThemeID");if(!A1){return microstrategy.APPLIED_THEME_NONE;}else{if(microstrategy.isDefaultTheme(A1)){return microstrategy.APPLIED_THEME_DEFAULT;}else{return microstrategy.APPLIED_THEME_CUSTOM;}}case"showAppliedThemeAsType":return this.queryState("appliedThemeType")!==microstrategy.APPLIED_THEME_NONE;case"showCustomThemePicker":return this.queryState("appliedThemeType")===microstrategy.APPLIED_THEME_CUSTOM;case"Bold":case"Italic":case"Underline":case"FontFamily":case"FontSize":case"FontColor":case"FillColor":case"lncolor":Aq=AN.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(AN.isOnlyOneGridSelected()&&Aq&&Aq.graphSelected){return Aq.commands.queryState(BE);}else{return AN.checkFormat(BE,AK);}case"showRepeatSection":return(this.queryState("isSection")&&AN.styleObj.getAttValue(AN.firstItem(),"rps")!="0");case"visibleShowInRptCp":if(this.queryState("isSection")||!AN.items){return false;}for(var Be in AN.items){var BY=microstrategy.findAncestorWithAtt(AN.items[Be],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);if(BY){if(microstrategy.styleObj.getAttValue(BY,microstrategy.HTMLATTR_REPEAT_SECTION)!="-1"){return false;}var A8=BY.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION);if(A8=="-1"||A8=="-3"){return false;}}}return true;case"enableHorizontal":return microstrategy.isEnabled(AN.items,"textAlign");case"showSecondaryDataProviders":var Ad=this.parentBone.parentBone.getAvailableWidgets(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);var p=this.queryState("setWidget");for(var BT in Ad){var u=Ad[BT];if(u.dssid==p){return u.mnsp>0||u.mxsp>0;}}return false;case"availableSecondaryDataProviders":var CD=[];if(!this.queryState("isOneGrid")){return CD;}var Bg=this.parentBone.parentBone.dataProviderNames;var B3=null;for(var AA in Bg){if(AA==AN.getSelectedGrid().id){B3=Bg[AA][1];break;}}for(var AA in Bg){if(AA==AN.getSelectedGrid().id||Bg[AA][1]>B3){continue;}CD.push({dssid:AA,n:Bg[AA][0]});}CD=CD.sort(function(CI,g){if(CI.n<g.n){return -1;}if(CI.n>g.n){return 1;}return 0;});return CD;case"SecondaryDataProviders":var CD=[];var BG=this.getCommonAttValue(T,microstrategy.HTMLATTR_SEC_DATA_PROVIDERS,"SecondaryDataProviders");BG=BG?BG.split(","):[];var BB=this.queryState("availableSecondaryDataProviders");for(var BA in BG){for(var Be in BB){if(BG[BA]==BB[Be].dssid){CD.push(BB[Be]);}}}return CD;case"pivotButtons":return mstr.behaviors.featureResolver.featAvailable("check-show-pivot-buttons");case"sortButtons":return mstr.behaviors.featureResolver.featAvailable("check-show-sort-buttons");case"toggleSnap":return !microstrategy.SNAP_OFF;case"graphZones":var Bv=microstrategy.findBone(AN.getSelectedGrid());return(Bv.zonesEditor)?true:false;case"DataFilterMode":if(this.queryState("isMetricQualifier")){return 1;}if(!this.queryEnabled("DataFilterModeEnabled")){return 1;}var BS=AN.firstItem();var At=A7.formattingAttributes[BS.id]&&A7.formattingAttributes[BS.id]["dfm"];return At==undefined?1:At;case"stateUCVisible":return this.queryState("DataFilterMode")==1||(this.queryState("isNormalSelector")&&this.queryState("isDSAsTarget"));case"isSlicingSelector":return this.queryState("DataFilterMode")==0||this.queryState("isPanelStackSelector");case"SelectionColor":return(microstrategy.styleObj.getAttValue(AN.firstItem(),microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE)=="1")?microstrategy.styleObj.getAttValue(AN.firstItem(),microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR):"automatic";case"widgetId":var S=this.parentBone.parentBone.curWgtId;if(S){return S;}if(AN&&AN.isOnlyOneGridSelected()){var Bf=microstrategy.findBone(AN.getSelectedGrid());if(Bf){if(Bf.curWgtId){return Bf.curWgtId;}}}return"";case"isPageHeaderSection":return this.queryState("isSection")&&this.belongsToSectionOfTypes([6]);case"isPageFooterSection":return this.queryState("isSection")&&this.belongsToSectionOfTypes([7]);case"isInFilterPanel":var BY=microstrategy.findAncestorWithAtt(AN.firstItem(),microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(BY&&BY.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var Bk=microstrategy.findBone(BY);return Bk&&Bk.isFilterPanel;}return false;case"isInsideNavBar":return AN.isItemInsideNavBar();case"showTranslucent":if(!this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK])){return false;}var BF=this.queryState("InfoWindowMode");return this.queryState("UseAsInformationWindow")&&(BF==="2"||BF==="3"||BF==="4");case"Transparency":return this.getCommonAttValue(T,microstrategy.HTMLATTR_PS_TRANSPARENCY,"Transparency");case"Blur":return(this.getCommonAttValue(T,microstrategy.HTMLATTR_PS_BLUR,"Blur")==="-1");case"optionAllVisible":case"allAliasVisible":return !this.queryState("isMetricQualifier")&&!this.queryState("isDDIC")&&!this.queryState("isAQSelector");case"DisplayInPartialScreen":return(this.getCommonAttValue(T,"dips","DisplayInPartialScreen")==="-1");case"InitialSlidingInWidthEnabled":var BC=this.queryState("InfoWindowPosition");return this.queryState("UseAsInformationWindow")&&this.queryState("DisplayInPartialScreen")&&this.queryState("InfoWindowMode")==="4"&&(BC==="3"||BC==="4");case"InitialSlidingInHeightEnabled":var BC=this.queryState("InfoWindowPosition");return this.queryState("UseAsInformationWindow")&&this.queryState("DisplayInPartialScreen")&&this.queryState("InfoWindowMode")==="4"&&(BC==="1"||BC==="2");case"ShowAsCollapsiblePanel":return(this.getCommonAttValue(T,"sacp","ShowAsCollapsiblePanel")==="-1");case"enableEmbeddedImages":return A7.EnableEmbeddedImages==="1";case"InitialSlidingInWidth":case"InitialSlidingInHeight":default:return AN.checkFormat(BE,AK);}}catch(L){microstrategy.errors.log(L);}return null;};mstrDocCommandsImpl.prototype.queryVisible=function(B){var C=this.parentBone.selections;if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(B)){if(!C||!C.isOnlyOneGridSelected()){return false;}var E=microstrategy.findBone(C.getSelectedGrid());if(!E){return false;}E=(E instanceof mstrReportGraphImpl)?E:microstrategy.bone(E.id+"_graph");return(E&&E.commands)?E.commands.queryVisible(B):false;}try{var A,E;switch(B){case"showCreatePanelSelector":return this.queryEnabled("onepanelstack")&&!this.queryEnabled("oneTable");case"tbUnitSelector":if(!this.queryEnabled("isNotLinkedGraph")){return false;}if(this.queryEnabled("onepanelstack")){return true;}return(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.queryEnabled("onegrid"));case"tbValueSelector":if(!this.queryEnabled("isNotLinkedGraph")){return false;}if(this.queryEnabled("onepanelstack")){return(this.queryState("IsPortal")&&this.parentBone.selections.panelUnitFormat!=1);}if(this.queryEnabled("onecontrol")){return(this.queryState("IsPortal")&&this.parentBone.selections.controlUnitFormat!=4);}if(!this.queryEnabled("onegrid")){return false;}if(this.parentBone.selections.isGridContainerSelected()){if(!this.queryState("IsPortal")){return false;}}else{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.parentBone.selections.gridUnitFormatX==microstrategy.GRID_BORDERS){return false;}}return true;case"TextAlign":return !(this.queryEnabled("onegrid")&&microstrategy.formatType!=2);case"GridHorizontal":return this.queryEnabled("onegrid")&&microstrategy.formatType!=2;case"visFlashMode":case"visAjaxMode":A="visualizations-supported;visualizations-available-for-rw-grids";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}if(!C||!C.isOnlyOneGridSelected()){return false;}E=microstrategy.findBone(C.getSelectedGrid());return(E&&E.commands)?E.commands.queryVisible(B):false;case"gridSelectedVisualization":A="visualizations-supported;visualizations-available-for-rw-grids";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}if(!C||!C.isOnlyOneGridSelected()){return false;}E=microstrategy.findBone(C.getSelectedGrid());return(E&&E.commands)?E.commands.queryVisible("selectedVisualization"):false;case"tbLoading":return false;case"openBasicConditionalFormatting":A="rw-interactive-view-mode-eplus;use-basic-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}return this.queryEnabled("openBasicConditionalFormatting");case"openAdvConditionalFormatting":A="rw-interactive-view-mode-eplus;use-advanced-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}return this.queryEnabled("openAdvConditionalFormatting");case"openSimpleThresholdEditor":A="rw-interactive-view-mode-eplus;use-basic-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}return !this.queryEnabled("openBasicConditionalFormatting");case"openAdvThresholdEditor":A="rw-interactive-view-mode-eplus;use-advanced-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(A,true)){return false;}return !this.queryEnabled("openAdvConditionalFormatting");case"showApplyThemeOnNode":case"showPropertiesAndFormatting":E=microstrategy.findBone(C.getSelectedGrid());return mstr.behaviors.featureResolver.featAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS)||(mstr.behaviors.featureResolver.featAvailable("rw-interactive-view-mode")&&this.parentBone.selections.isOnlyOneGridSelected()&&E.commands.queryState("gridType")!="flash");default:return true;}}catch(D){}return false;};mstrDocCommandsImpl.prototype.searchForSelectedObjectType=function(G){try{if(G==null||G.length==0){return true;}var E="~"+G.join("~")+"~";var I="";var F=0;var C=0;var B=this.parentBone.selections;var A=B.getTypes();if(A==null||A.length==0){return false;}var K=E.split(/obj.52\|/g);if(K.length>1){for(F=1,C=K.length;F<C;F++){I+="~"+(parseInt(K[F].charAt(0))+1);}I+="~";}var H=B.getItems();for(F=0,C=A.length;F<C;F++){if(I.length>0&&A[F]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var J=microstrategy.findBone(H[F]);if(I.indexOf("~"+J.commands.queryState("effectiveView")+"~")>-1){return true;}}else{if(A[F]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE){if(E.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE+"~")>-1){return true;}if(E.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND+"~")>-1){if(H[F].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){return true;}}}else{if(E.indexOf("~"+A[F]+"~")>-1){return true;}}}}return false;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocCommandsImpl.prototype.ensureSelectedObjectTypes=function(G){try{if(G==null||G.length==0){return false;}var D="~"+G.join("~")+"~";var I="";var E=0;var B=0;var A=this.parentBone.selections.getTypes();if(A==null||A.length==0){return false;}var K=D.split(/obj.52\|/g);if(K.length>1){for(E=1,B=K.length;E<B;E++){I+="~"+(parseInt(K[E].charAt(0))+1);}I+="~";}var H=this.parentBone.selections.getItems();for(E=0,B=A.length;E<B;E++){if(I.length>0&&A[E]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var J=microstrategy.findBone(H[E]);if(I.indexOf("~"+J.commands.queryState("effectiveView")+"~")==-1){return false;}}else{if(A[E]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE){var F=H[E].getAttribute(microstrategy.HTMLATTR_STYLE);if(F==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){if(D.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND+"~")==-1){return false;}}else{if(D.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE+"~")==-1){return false;}}}else{if(!D.match(new RegExp("~"+A[E]+"~"))){return false;}}}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocCommandsImpl.prototype.getCurrentSectionDef=function(){var F=microstrategy.findAncestorWithAtt(this.parentBone.selections.firstItem(),microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION),B=microstrategy.findBone(F),D=this.parentBone.parentBone,A=D&&D.sectionsList,G=B.id,E=null;if(G&&A){for(var C=0;C<A.length;C++){if(A[C].d===G){E=A[C];break;}}}return E;};mstrDocCommandsImpl.prototype.belongsToSectionOfTypes=function(A){var B=this.getCurrentSectionDef();return B&&A&&(mstr.utils.Arrays.find(A,B.t)>-1);};mstrDocCommandsImpl.prototype.getCommonAttValue=function(G,H,A,J,E){try{var F="";var B=false;if(typeof (J)=="undefined"){J=false;}for(var C in G){if(A&&!microstrategy.isEnabledForItem(G[C],A)){continue;}if(G[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_LINE&&J==false){if(A=="widthMode"||A=="heightMode"||A=="width"||A=="height"){continue;}}var I=this.parentBone.styleObj.getAttValue(G[C],H,E);if(!B){F=I;B=true;}if(I!=F){return null;}}return F;}catch(D){microstrategy.errors.log(D);return null;}};mstrDocCommandsImpl.prototype.getCommonBoneProperty=function(C,G,B,E){try{for(var F in C){if(C[F].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&C[F].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==B){var A=mstrStaticDoc.getBone(C[F]);if(A){if(A[G]!=E){return A[G];}}}}}catch(D){microstrategy.errors.log(D);}return E;};mstrDocCommandsImpl.prototype.getDDICBoneProperty=function(H,A,E,J){try{for(var B in H){var K=H[B],I=mstrStaticDoc.getBone(K);while(K&&!I){K=K.parentElement;I=microstrategy.findBone(K);}if(I){var K=H[B],G=I.tscObjs;for(var D in G){var F=G[D];if(F.key===K.id){return F[A]||F.ctl&&F.ctl[A]||F.ctl&&F.ctl.ddic&&F.ctl.ddic[A]||J;}}}}}catch(C){microstrategy.errors.log(C);}return J;};mstrDocCommandsImpl.prototype.setDDICBoneProperty=function(G,A,I){try{for(var B in G){var J=G[B],H=mstrStaticDoc.getBone(J);while(J&&!H){J=J.parentElement;H=microstrategy.findBone(J);}if(H){var J=G[B],F=H.tscObjs;for(var D in F){var E=F[D];if(E.key===J.id){E.ctl.ddic[A]=I;}}}}}catch(C){microstrategy.errors.log(C);}};mstrDocCommandsImpl.prototype.isTypeSelectedInOB=function(C){try{var E=microstrategy.bone("reportObjs_RWWorkingSetStyle");if(E){var B=E.selections;if(B.length>0){var A=mstr.utils.Arrays.fromHashValues(B.items)[0];if(A){if(A.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==C){return true;}}}}return false;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocCommandsImpl.prototype.isDesignMode=function(){try{return microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;}catch(A){microstrategy.errors.log(A);return false;}};function mstrDocCommandsImpl(){return this;}menuScript=true;var oSubCTimer=null;var oSubPkrTimer=null;var bIsOverContext=false;var bDisplayLeft=false;var sQuote="\\'";var sQuoteSimple="'";var sQuoteDouble='"';var aOndemandMenuItems=null;var aMenuItems=null;var aMenuItemsName;var sDrillContextMenuExtraArg1;var currentPicker=null;var specialMenuLayers=null;mstrMenuObj.prototype=new Object();function mstrMenuObj(A){}mstrMenuObj.adjustMenuPositionForClient=function(I,H,B,D){if(B.getAttribute("origHeight")){B.style.height=B.getAttribute("origHeight")+"px";}if(B.getAttribute("origWidth")){B.style.width=B.getAttribute("origWidth")+"px";}var F=B.getAttribute("ty")=="cxt";var J=getObjWidth(F?B.firstChild:B);if(J+I<getClientWidth()+getDocumentScrollLeft()){if(bDisplayLeft&&D){I=D-J+2;}else{bDisplayLeft=false;}}else{bDisplayLeft=true;if(D){I=D-J+2;}else{I=I-J+10;}}var A=getClientHeight();var C=getObjHeight(F?B.firstChild:B);var G=getDocumentScrollTop();var E=(H+C)-(G+A);if(C>A){H=G+1;if(E>0){if(!B.getAttribute("origHeight")){B.setAttribute("origHeight",C);}if(!B.getAttribute("origWidth")){B.setAttribute("origWidth",J);}if(!F){B.style.height=Math.min(C,A)+"px";B.style.width=Math.min(J,J+B.offsetWidth-B.clientWidth)+"px";B.style.overflowY="auto";}}}else{if(E>0){H=G+A-C-2;}}if(F){B.style.height=Math.min(C,A)+"px";B.style.width=Math.min(J,J+B.offsetWidth-B.clientWidth)+"px";if(B.offsetHeight<C){if(bIsIE7){B.style.overflow="auto";}else{B.style.overflowY="auto";}}}moveObjTo(B,I,H);};function displayContextMenu(oTarget,e,moveMenu){var sMenu=oTarget.getAttribute("CX");if(sMenu.length==0){return true;}var menuDefTarget=findTarget(oTarget,"CXID");var aMenuElementsName=menuDefTarget.getAttribute("CXID");var aMenuElements=microstrategy.getContextMenuManager(aMenuElementsName).menu_items;if(!aMenuElements||aMenuElements.length==0){return false;}var sDrillExtraArgument1=oTarget.getAttribute("D1");var types=oTarget.getAttribute("cxty");if(typeof (microstrategy)!="undefined"){microstrategy.updateActiveCXProps(oTarget,e);}hideContextMenus();getMouse(e);aMenuItems=aMenuElements;aMenuItemsName=aMenuElementsName;sDrillContextMenuExtraArg1=sDrillExtraArgument1;var avMenu=eval(sMenu);buildContextMenu(avMenu,1,eval(types),oTarget,false,null);if(hasMenuItem(avMenu,eval(types))){var menuX,menuY;if(moveMenu){var tID=oTarget.id;var menuX=getObjSumLeftScrolled(tID)+3;var menuY=getObjSumTopScrolled(tID)+getObjHeight(tID)+4;oTarget.onmouseout=function(){OutContext();};}else{menuX=lMouseX-microstrategy.CURSOR_OFFSET;menuY=lMouseY-microstrategy.CURSOR_OFFSET;}positionContextMenu(menuX,menuY,aMenuItemsName+"1");if(bIsIE4){togglePulldowns(getObj(aMenuItemsName+"1"),false);}document.getElementById(aMenuItemsName+"1").style.visibility="visible";microstrategy.setContextMenuStatus(true);}return false;}function isMenuShown(menuItem,selectedTypes){var supportedTypes=menuItem[5];var showJS=menuItem[6];var displayMenuItem=true;var __result=true;if(supportedTypes&&supportedTypes.length>0&&selectedTypes&&selectedTypes.length>0){var supportedTypesArray=eval(supportedTypes);__result=false;for(var j=0;j<selectedTypes.length;j++){for(var i=0;i<supportedTypesArray.length;i++){if(selectedTypes[j]==supportedTypesArray[i]){__result=true;break;}}if(__result){break;}}}if(showJS&&showJS.length>0&&__result==true){if(showJS=="$check-subMenu-existence$"){var subs=eval(menuItem[4]);var n=subs.length;if(n>0){for(var i=0;i<n;i++){var sub=aMenuItems[subs[i]];if(sub){__result=isMenuShown(sub,selectedTypes);if(__result){break;}}}}else{__result=false;}}else{__result=eval(showJS)?true:false;}}return __result;}function getPicker(D){var E=document.getElementsByName(D);var A=null;var C=document.body.childNodes;for(var B=0;B<C.length;B++){if(C[B].id==D){A=C[B];break;}}if(E){if(!A){while(E.length>1){E[0].parentNode.removeChild(E[0]);}A=document.body.appendChild(E[0]);}}return A;}function showPicker(A,E,H,G,F){var C=getPicker(E);if(C){if(A){currentPicker=C;var B=aMenuItemsName+F;var D=getElementById(B);if(D){C.style.zIndex=D.style.zIndex+100;}C.style.visibility="hidden";C.style.display="block";mstrMenuObj.adjustMenuPositionForClient(H,G,C);if(bDisplayLeft){C.style.left=parseInt(C.style.left,10)-getObjWidth(D)+"px";}C.style.visibility="visible";}else{C.style.display="none";currentPicker=null;}}}function buildContextMenuRows(avItems,iMenu,types,oTarget,loadOndemandMenuItems,modelID){var sContent="";var lRowCount=0;var sRowID="";var sSubCommand="";var sOnClickLink="";var hasMenuItem=false;var enabled=true;if(!oTarget){oTarget=microstrategy.activeCXMenu;}var aMenuItemsLocal=null;if(loadOndemandMenuItems){aMenuItemsLocal=aOndemandMenuItems;lRowCount=getNumTagsInDiv(aMenuItemsName+iMenu,"tr");}else{aMenuItemsLocal=aMenuItems;}for(var iIndex=0;iIndex<avItems.length;iIndex++){if(aMenuItemsLocal[avItems[iIndex]][3]!=2){if(isMenuShown(aMenuItemsLocal[avItems[iIndex]],types)){hasMenuItem=true;var menuClass="menu-item";var menuClassWithSeparator="menu-item-with-separator";var separatorClass="menu-item-separator";enabled=true;var enableJS=aMenuItemsLocal[avItems[iIndex]][7];if(enableJS&&enableJS.length>0){enabled=eval(enableJS);}if(!enabled||aMenuItemsLocal[avItems[iIndex]][8]==1){menuClass="menu-item-disabled";menuClassWithSeparator="menu-item-disabled-with-separator";}sRowID="cm"+iMenu+"r"+lRowCount;sContent+='<TR ID="'+sRowID+'" HEIGHT="18" AC="true" ';var cmd=aMenuItemsLocal[avItems[iIndex]][1];if(menuClass=="menu-item"){cmd=replacePlaceholders(cmd,oTarget);if(aMenuItemsLocal[avItems[iIndex]][3]==1){var typesString=convertArrayToString(types);if(aMenuItemsLocal[avItems[iIndex]][10]!=null){var ondemandModelId=aMenuItemsLocal[avItems[iIndex]][10];var ondemandDynamicMenuKey=aMenuItemsLocal[avItems[iIndex]][11];var ondemandViewId=aMenuItemsLocal[avItems[iIndex]][12];sSubCommand="buildSubMenu("+aMenuItemsLocal[avItems[iIndex]][4]+", "+(iMenu+1)+", getObjSumTop("+sQuote+sRowID+sQuote+"), ["+typesString+"], "+loadOndemandMenuItems+", "+sQuote+ondemandModelId+sQuote+", "+sQuote+ondemandDynamicMenuKey+sQuote+", "+sQuote+ondemandViewId+sQuote+" );";}else{sSubCommand="buildSubMenu("+aMenuItemsLocal[avItems[iIndex]][4]+", "+(iMenu+1)+", getObjSumTopScrolled("+sQuote+sRowID+sQuote+"), ["+typesString+"], "+loadOndemandMenuItems+");";}sContent+="onMouseOver=\"clearTimeout(oSubCTimer); delaySubCMenus('"+sSubCommand+"'); menuOn(this);\" ";sContent+='onMouseOut="menuOff(this);" LI="sub" ';}else{if(aMenuItemsLocal[avItems[iIndex]][3]==3){sSubCommand="hideContextSubMenus("+iMenu+"); showPicker(true,"+sQuote+aMenuItemsLocal[avItems[iIndex]][4]+sQuote+",getObjWidth("+sQuote+sRowID+sQuote+") + getObjSumLeft("+sQuote+sRowID+sQuote+"), getObjSumTop("+sQuote+sRowID+sQuote+"),"+iMenu+");";sContent+="onMouseOver=\"clearTimeout(oSubCTimer); delaySubCMenus('"+sSubCommand+"'); menuOn(this);\"";sContent+='onMouseOut="menuOff(this);"';var pkr=getPicker(aMenuItemsLocal[avItems[iIndex]][4]);if(pkr){pkr.onmouseover=new Function("clearTimeout(oSubPkrTimer);");pkr.onmouseout=new Function("OutContext();");pkr.onmousedown=new Function("e","if (!e) {e=window.event;} eval("+cmd+");OutContext();");}}else{sContent+='onMouseOver="clearTimeout(oSubCTimer); menuOn(this);';sContent+=" hideContextSubMenus("+iMenu+");";sContent+='" onMouseOut="menuOff(this);" ';sOnClickLink=cmd;if(sOnClickLink.indexOf("DCM")!=-1){if(sDrillContextMenuExtraArg1==null){sOnClickLink=sOnClickLink.substr(0,sOnClickLink.indexOf(")"))+",'')";}else{sOnClickLink=sOnClickLink.substr(0,sOnClickLink.indexOf(")"))+",'"+sDrillContextMenuExtraArg1+"')";}}sContent+="onClick=\"menuClick(this, '"+aMenuItemsName+iMenu+'\');" LI="'+sOnClickLink+';" ';}}if(bIsW3C){sContent+='STYLE="cursor: pointer;"';}else{sContent+='STYLE="cursor: hand;"';}}var isNextMenuOptionASeparator=isNextMenuSeparator(aMenuItemsLocal,avItems,iIndex,types);sContent+=">\n";sContent+='<TD WIDTH="12" ALIGN="MIDDLE" CLASS="mstrContextMenuLeft"';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+=">";switch(aMenuItemsLocal[avItems[iIndex]][2]){case 0:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 1:var showCheck=true;var checkJS=aMenuItemsLocal[avItems[iIndex]][9];if(checkJS&&checkJS.length>0){showCheck=eval(checkJS);}if(showCheck){sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuCheck.gif" WIDTH="12" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';}break;case 2:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'CMenuRemove.gif" WIDTH="11" HEIGHT="11" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" /><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="1" HEIGHT="1" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 3:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'CMenuSubtotal.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 4:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillUp.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 5:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillDown.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 6:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillTemplate.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 7:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'drill.png" WIDTH="16" HEIGHT="16" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 8:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'treeLoading.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;}sContent+="</TD>";sContent+='<TD WIDTH="1"';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+='><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"></TD>';sContent+='<TD ALIGN="LEFT" NOWRAP="1" ';if(isNextMenuOptionASeparator){sContent+=" class="+menuClassWithSeparator+" ";}else{sContent+=" class="+menuClass+" ";}sContent+=">"+aMenuItemsLocal[avItems[iIndex]][0]+"&nbsp;&nbsp;<BR/></TD>";sContent+='<TD WIDTH="12" ALIGN="RIGHT" NOWRAP="1" ';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+=">";if(aMenuItemsLocal[avItems[iIndex]][3]==1||aMenuItemsLocal[avItems[iIndex]][3]==3){var expandImage=enabled?"MenuExpand.gif":"MenuExpand_off.gif";sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+expandImage+'" WIDTH="8" HEIGHT="9" ALT="" BORDER="0" /><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="2" HEIGHT="1" ALT="0" BORDER="0" />';}else{sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" ALT="0" BORDER="0" />';}sContent+="</TD></TR>\n";lRowCount++;}}}return sContent;}function replacePlaceholders(str,oTarget){var matched=false;var tempStr=str;if(tempStr.indexOf("%40")>-1){tempStr=unescape(tempStr);}if(tempStr.indexOf("@")>-1){tempStr=tempStr.replace(/@[^@]+@/g,function(token){matched=true;var attName=token.substring(1,token.length-1);if(attName.indexOf("__bone__")>-1){attName=attName.replace("__bone__","microstrategy.findBone(microstrategy.activeCXMenu)");return eval(attName);}else{return oTarget.getAttribute(attName)||"";}});}if(matched){return tempStr;}else{return str;}}function isNextMenuSeparator(E,A,D,C){for(var B=D+1;B<A.length;B++){if(isMenuShown(E[A[B]],C)){return(E[A[B]][3]==2);}}return false;}function getMenuDiv(B){var A=getObj(B);if(!A){A=document.createElement("DIV");A.setAttribute("id",B);A.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_CONTEXT_MENU);A.onmouseover=OverContext;A.onmouseout=OutContext;A.style.visibility="hidden";A.style.position="absolute";A.style.backgroundColor="#FFFFFF";A.style.border="1px #ddd solid";A.style.top="-999px";document.body.appendChild(A);}return A;}function buildContextMenu(B,H,E,C,F,G){var D="";D='<TABLE BORDER="0" CELLSPACING="0" CLASS="mstrContextMenuRight">\n';D+=buildContextMenuRows(B,H,E,C,F,G);D+="</TABLE>";var A=getMenuDiv(aMenuItemsName+H);A.innerHTML=D;}function hasMenuItem(A,B){for(var C=0;C<A.length;C++){if(aMenuItems[A[C]][3]!=2){if(isMenuShown(aMenuItems[A[C]],B)){return true;}}}return false;}function upClick(C){if(bIsW3C&&!C){return false;}var B=(bIsIE4)?(event.button==2||event.button==3):(C.button==3);if(B){var A=getEventTarget(C);A=findTarget(A,"CX");if(A){document.onmouseup=null;return false;}}}function OverContext(){bIsOverContext=true;}function OutContext(){clearTimeout(oSubCTimer);bIsOverContext=false;}function hideContextMenus(){if(typeof (aMenuItemsName)=="undefined"){return ;}if(!bIsOverContext){hideContextSubMenus(1);var A=getObj(aMenuItemsName+"1");if(A){A.style.visibility="hidden";A.style.top="-999px";microstrategy.setContextMenuStatus(false);A.innerHTML="";}if(bIsIE4){togglePulldowns(A,true);}}}function hideContextSubMenus(C){var B=1;for(var B=4;B>C;B--){var A=getObj(aMenuItemsName+B);if(A){A.style.visibility="hidden";A.innerHTML="";if(bIsIE4){togglePulldowns(A,true);}}}if(currentPicker!=null){currentPicker.style.display="none";currentPicker=null;}}function buildSubMenu(C,D,K,H,F,B,L,A){var G=aMenuItemsName+D;var I=getMenuDiv(G);I.modelID=B;if(bIsIE4){I.style.height="auto";I.style.width="auto";I.style.overflowY="visible";}I.style.zIndex=1000;buildContextMenu(C,D,H,null,F,B);addOndemandSubMenuItems(B,L,A,D);if(I.childNodes.length==0){return ;}var E=getObjLeft(aMenuItemsName+(D-1));var J=getObjWidth(aMenuItemsName+(D-1));positionContextMenu(E+J-2,K,G,E);if(bIsIE4){togglePulldowns(getObj(aMenuItemsName+D),false);}hideContextSubMenus(D);document.getElementById(aMenuItemsName+D).style.visibility="visible";}function delaySubCMenus(sExecuteText){clearTimeout(oSubCTimer);if(sExecuteText.length>0){if(bIsInPortal&&mstr.utils.ISFF3){eval(sExecuteText);}else{oSubCTimer=window.setTimeout(sExecuteText,250);}}}function positionContextMenu(E,C,D,B){if(bIsIE4){var A=D;if(typeof (A)=="string"){A=document.getElementById(D);}if(A){A.style.height="auto";A.style.width="auto";A.style.overflowY="visible";}}var A=getObj(D);A.style.zIndex=1000;mstrMenuObj.adjustMenuPositionForClient(E,C,A,B);}function generateLink(A){A+="&innerWidth="+getClientWidth()+"&innerHeight="+getClientHeight();return A;}function submitCM(D,B,E){if(B){D=D+"&iframe=true";}var A=true;if(microstrategy&&microstrategy.eventManager){A=microstrategy.eventManager.notifyOrphanBones("onmenusubmitform");}if(A){var C=createDynamicForm(D);if(B){C.target="frameManager";}if(E!=null){C.target=E;}}submitForm(C);}dropDownMenusScript=true;var oTimer=null;var bIsOver=false;var oSubTimer=null;var bMenuOpen=false;var bCompleted=false;var asBranch=new Array();var nBranchElements=0;var bClickStyle=false;function activateHeader(F,E,D){for(var B=0;B<iMainMenus;B++){var A=getObj("menuHeader"+B);if(A){var C=A.getAttribute("E")=="0";if(!C){if(B==F){A.className=E;}else{A.className=D;}}}}}function fixMenus(A){var B;for(i=0;i<A.length;i++){B=getObj(A[i][1]);if(B){B.setAttribute(A[i][2],A[i][3]);}}B=B=getObj("mb"+A[0][0]);if(B){B.setAttribute("C","0");}}function updateCheckedAndEnabledOptions(menuName){var menu=getObj(menuName);var TABLEs=menu.getElementsByTagName("TABLE");TABLEs[0].className="menu-block";var TRs=TABLEs[0].getElementsByTagName("TR");var menuUpdated=false;var newValue;var wasChecked;var wasEnabled;var wasShown;var baseBone;for(i=0;i<TRs.length;i++){baseBone=TRs[i].getAttribute("BB");wasChecked=TRs[i].getAttribute("H");wasEnabled=TRs[i].getAttribute("E");wasShown=(TRs[i].style.display!="none");if(baseBone&&baseBone.length>0&&!(microstrategy&&microstrategy.bone(baseBone))){continue;}var auxStr=TRs[i].getAttribute("DS");if(auxStr&&auxStr.length>0){newValue=eval(auxStr);if(newValue!=wasShown){menuUpdated=true;if(newValue){TRs[i].style.display="";}else{TRs[i].style.display="none";continue;}}}var auxStr=TRs[i].getAttribute("DC");if(auxStr&&auxStr.length>0){newValue=eval(auxStr)?"1":"0";if(newValue!=wasChecked){TRs[i].setAttribute("H",newValue);menuUpdated=true;}}auxStr=TRs[i].getAttribute("DE");if(auxStr&&auxStr.length>0){newValue=eval(auxStr)?"1":"0";if(newValue!=wasEnabled){TRs[i].setAttribute("E",newValue);menuUpdated=true;}}}if(menuUpdated){menu.setAttribute("C","0");}}function completeMenu(A){var E;var C;var F=getObj(A);var D=F.getElementsByTagName("TABLE");D[0].className="menu-block";var B=D[0].getElementsByTagName("TD");for(i=0;i<B.length;i++){if(B[i].id=="blank"){B[i].width="1";B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="1" HEIGTH="1">';}else{if(B[i].id=="mnI"){B[i].align="middle";if(B[i].parentNode.getAttribute("E")=="1"){B[i].className="menu-item-image";}else{B[i].className="menu-item-image-disabled";}if(B[i].parentNode.getAttribute("H")=="1"){B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuCheck.gif" style="width:12px;height:9px;">';}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif">';}}else{if(B[i].id=="mnT"||B[i].id=="mnS"){B[i].noWrap=true;C=(B[i].parentNode.getAttribute("E")=="1");if(C){B[i].className="menu-item";}else{B[i].className="menu-item-disabled";}if(B[i].parentNode.getAttribute("AS")=="1"){if(C){B[i].className="menu-top-separator";}else{B[i].className="menu-top-separator-disabled";}}}else{if(B[i].id=="mnE"){B[i].width="12";B[i].align="right";C=(B[i].parentNode.getAttribute("E")=="1");if(B[i].parentNode.getAttribute("AS")=="1"){if(C){B[i].className="menu-top-separator";}else{B[i].className="menu-top-separator-disabled";}}if(B[i].parentNode.getAttribute("SB")=="1"){if(C){B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuExpand.gif" WIDTH="8" HEIGTH="9">';}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuExpand_off.gif" WIDTH="8" HEIGTH="9">';}}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGTH="10">';}}}}}}F.setAttribute("C","1");bCompleted=true;}function ShowLayer(G,E){if(oTimer){clearTimeout(oTimer);}HideAllLayers();if(isNaN(G)){if(specialMenuLayers==null){specialMenuLayers=[];}specialMenuLayers.push(G);}var F=getObj("mb"+G);if(F.getAttribute("C")!="1"){completeMenu("mb"+G);}var B=(E)?E:("menuHeader"+G);var C=getObjSumTop(B)+getObjHeight(B);var D=getObjSumLeftScrolled(B);var A=getObj("mb"+G);A.style.zIndex=1000;positionContextMenu(D,C,A);if(bIsIE4){togglePulldowns(A,false);}asBranch[0]="mb"+G;nBranchElements=1;A.style.visibility="visible";bMenuOpen=true;}function hidePopupMenus(A){hideContextMenus();if(A||(bClickStyle&&bMenuOpen)){UnselectAllLayers();}}function UnselectAllLayers(){if(!bIsOver&&typeof (iMainMenus)!="undefined"){HideAllLayers();var B;for(var A=0;A<iMainMenus;A++){B=getObj("menuHeader"+A);if(B){if(B.getAttribute("E")=="0"){B.className=mstrMenuDisabledClass;}else{B.className=mstrMenuEnabledClass;}}}bMenuOpen=false;}}function HideAllLayers(){nBranchElements=0;if(!bIsOver&&typeof (iSubMenus)!="undefined"){for(var A=0;A<iSubMenus;A++){var B=document.getElementById("mb"+A);if(B){B.style.visibility="hidden";}}if(specialMenuLayers!=null){for(var A=0;A<=specialMenuLayers.length;A++){document.getElementById("mb"+specialMenuLayers[A]).style.visibility="hidden";}specialMenuLayers=null;}if(bIsIE4){togglePulldowns(null,true);}}bMenuOpen=false;}function OverLayer(){if(oTimer){clearTimeout(oTimer);}bIsOver=true;}function OutLayer(){if(oTimer){clearTimeout(oTimer);}bIsOver=false;if(!bClickStyle){oTimer=setTimeout("UnselectAllLayers()",300);}}function hideSubMenu(F,C,B){var E=false;var A=0;for(i=0;i<nBranchElements;i++){if(E){var D=document.getElementById(asBranch[i]);if(D){if(bIsIE4){togglePulldowns(D,true);}D.style.visibility="hidden";}asBranch[i]=0;}if(asBranch[i]==C){E=true;A=i+1;}}nBranchElements=A+1;asBranch[nBranchElements-1]=F;}function menuOn(A){if(A.className!="menuDisabled"){A.className="menu-row-selected";}}function menuOff(A){if(A.className!="menuDisabled"){A.className="menu-row";}}function menuClick(oMenuItem,sMenu){var oMenu=typeof (sMenu)=="string"?document.getElementById(sMenu):sMenu;if(oMenu.modelID){var model=mstr.$obj(oMenu.modelID);if(model){var state=model.get("readyState");if(state&&state===mstr.Enum.Widget.READYSTATE.WAITING){return ;}}}if(oMenuItem.className!="menuDisabled"){if(oMenuItem.getAttribute("AC")=="true"){var sLink=oMenuItem.getAttribute("LI");if(sLink.length>0){bIsOverContext=false;oMenu.style.visibility="hidden";hideContextMenus();window.mstrSubmitLink=true;eval(sLink);}}else{bIsOverContext=false;oMenu.style.visibility="hidden";HideAllLayers();hideContextMenus();}}}function onCl(A){onMv(A);ShowLayer(A.getAttribute("ndx"));}function onMv(C){var B=C.getAttribute("E")=="0";var A=C.getAttribute("ndx");updateCheckedAndEnabledOptions("mb"+A);if(getObj("mb"+A).getAttribute("C")!="1"){completeMenu("mb"+A);}if(!B){if(bMenuOpen){activateHeader(A,"menu-header-selected","menu-header");ShowLayer(A);}else{activateHeader(A,"menu-header-selected","menu-header");}}}function onMo(B){var A=B.getAttribute("E")=="0";if(!A){if(!bMenuOpen){B.className="menu-header";}else{OutLayer("menu-header","menu-header-disabled");}}}function convertArrayToString(A){var C="";if(A){for(var B=0;B<A.length;B++){if(A[B]){C=C+sQuote+A[B]+sQuote+", ";}else{C=C+"null, ";}}C=C.substr(0,C.length-2);}return C;}function buildWidgetSubMenu(C,J,Q,D){completeMenu(C);if(!D){D="currentControl";}var P=getObj(C);var L=P.getElementsByTagName("tbody")[0];var I=L.firstChild;var M=I.getAttribute("id");M=M.substr(0,M.length-1);var K=microstrategy.getViewerBone().widgets;var G=false;if(K){if(L.hasChildNodes()){for(var F=L.childNodes.length-1;F>=0;F--){if(J||L.childNodes[F].getAttribute("dyn_menu")){L.removeChild(L.childNodes[F]);}}}G=!J&&L.hasChildNodes();var E=false;for(var F=0;F<K.length;F++){var O=K[F];if(!Q||Q==O.scope){var B=I.getAttribute("id");var H=I.cloneNode(true);H.setAttribute("id",M+F);H.setAttribute("dyn_menu",true);H.className="ctrl"+O.tbClass;if(!E&&G){H.setAttribute("AS",1);E=true;}var N=microstrategy.SUBOBJTYPE_DOC_WIDGET+"|"+O.fqcn+";"+O.rslPath+";"+O.title+";"+O.previewImage+";"+O.isApp+";"+O.scope+";"+O.defaultDHTMLStyle;var A="microstrategy.bone('rwb_viewer').commands.exec('"+D+"', '"+N+"');";if(D=="currentControl"){A+="microstrategy.eventManager.notifyOrphanBones('requestCurrentControlChange', '"+N+"');";}H.setAttribute("JS",A);H.childNodes[2].innerHTML=O.title;L.appendChild(H);}}completeMenu(C);}}function addOndemandSubMenuItems(G,C,E,H){if(G){var B=mstr.$obj(G);if(!B){return ;}var A=mstr.$obj(E);if(C){B.setCurrentDynamicMenuKey(C);}var D="";if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){D="Report";}else{var F=microstrategy.findBone(microstrategy.activeCXMenu);D=F.objId;}B.setGridKey(D);A.setMenuLevel(H);A.setModel(B);B.execPopulate();}}function addDynamicMenus(E,D,B){setOndemandMenuItems(D);var C=buildContextMenuRows(B,E,null,null,true,null);var A=getMenuDiv(aMenuItemsName+E);if(C==""){if(A.childNodes[0].rows&&A.childNodes[0].rows.length==0){hideContextSubMenus(E-1);}}else{addToExistingDivTable(A,C);mstrMenuObj.adjustMenuPositionForClient(parseInt(A.style.left,10),parseInt(A.style.top,10),A);}}function addToExistingDivTable(E,C){var B=document.createElement("div");B.innerHTML="<TABLE>"+C+"</TABLE>\n";var D=B.childNodes[0];var A=E.childNodes[0];if(A!=null&&(A.tBodies==null||A.tBodies.length==0)){A.appendChild(document.createElement("tbody"));}while(D.rows.length>0&&(A!=undefined)){A.tBodies[0].appendChild(D.rows[0]);}}function getNumTagsInDiv(C,B){var D=getObj(C);var A=D.getElementsByTagName(B);if(A!=null){return A.length;}else{return 0;}}function setOndemandMenuItems(A){aOndemandMenuItems=A;}function removeProcessingMenuItem(D){var A=getMenuDiv(aMenuItemsName+D);var C=A.getElementsByTagName("tr");if(C!=null){var B=0;while(B<C.length){if(C[B]!=null&&"processing"==C[B].getAttribute("id")){C[B].parentNode.removeChild(C[B]);}B++;}}}function addProcessingMenuItem(E){var B=microstrategy.descriptors.getDescriptor("2901");var C="";var D="menu-item";C+='<TR ID="processing" name="processing" HEIGHT="18" AC="true" ';C+='onMouseOver="clearTimeout(oSubCTimer); menuOn(this);';C+=" hideContextSubMenus("+E+");";C+='" onMouseOut="menuOff(this);" ';if(bIsW3C){C+='STYLE="cursor: pointer;"';}else{C+='STYLE="cursor: hand;"';}C+=">\n";C+='<TD WIDTH="12" ALIGN="MIDDLE" CLASS="mstrContextMenuLeft">';C+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'treeLoading.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';C+="</TD>";C+='<TD WIDTH="1"><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"></TD>';C+='<TD ALIGN="LEFT" NOWRAP="1" ';C+=" class="+D+" ";C+=">"+B+"&nbsp;&nbsp;<BR/></TD>";C+='<TD WIDTH="12" ALIGN="RIGHT" NOWRAP="1" ';C+=">";C+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" ALT="0" BORDER="0" />';C+="</TD>";C+="</TR>";var A=getMenuDiv(aMenuItemsName+E);addToExistingDivTable(A,C);}var dropDown=new function(){};dropDown.prototype=new Object();dropDown.togglePicker=function(show,id,dropdown,bone){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.togglePicker",0);}var oldPicker=null;if(bone.currentPicker){oldPicker=bone.currentPicker;if(bone.currentPicker.selected){var item=bone.currentPicker.selected;if(item){item.className="";}bone.currentPicker.selected=null;bone.currentPicker.commandId=null;bone.currentPicker.toolId=null;}bone.currentPicker.style.display="none";bone.currentPicker=null;}if(show){bone.currentPicker=document.getElementById(id);if(!bone.currentPicker){microstrategy.errors.log(microstrategy.descriptors.getDescriptor("3623"));return false;}bone.currentPicker.style.zIndex=1000;var cmdId=dropdown.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!cmdId){cmdId=dropdown.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_ID);}bone.currentPicker.commandId=cmdId;var subtypeStyle=bone.currentPicker.getAttribute(microstrategy.HTMLATTR_STYLE);if(subtypeStyle!=null){this.adjustPickerElements(bone.currentPicker);}if(bone.selectPickerElement){bone.selectPickerElement(bone.currentPicker);}for(var i=0;i<bone.currentPicker.childNodes.length;i++){var oChild=bone.currentPicker.childNodes[i];auxStr=oChild.getAttribute("de");if(auxStr&&auxStr.length>0){oChild.className=(eval(auxStr))?" ":"disabled";}}var leftElem=mstr.utils.BoxModel.getElementSumOffsetLeftAccurately(dropdown,document.body);var bottomElem=mstr.utils.BoxModel.getElementSumOffsetTopAccurately(dropdown,document.body)+getObjHeight(dropdown);if(bone.dialogDiv&&bone.dialogDiv.getAttribute(mstrHTMLAttributes.ATTR_DIALOG)=="true"){leftElem-=getObjSumLeft(bone.dialogDiv);bottomElem-=getObjSumTop(bone.dialogDiv);}bone.currentPicker.style.visibility="hidden";bone.currentPicker.style.display="block";var lClientWidth=getClientWidth();var lPickerWidth=getObjWidth(bone.currentPicker);if(lPickerWidth+leftElem>lClientWidth+((bone.dialogDiv&&!mstr.utils.ISIE6)?bone.dialogDiv.scrollLeft:0)){leftElem=Math.max(leftElem-lPickerWidth+getObjWidth(dropdown),0);}moveObjTo(bone.currentPicker,leftElem,bottomElem);if(bIsIE6&&!bIsIE7&&bone.maxHeight){bone.currentPicker.style.height="auto";bone.currentPicker.style.height=(bone.currentPicker.clientHeight<parseInt(bone.maxHeight))?bone.currentPicker.clientHeight+"px":bone.maxHeight;}bone.currentPicker.style.visibility="visible";togglePulldowns(bone.currentPicker,false);}else{if(oldPicker){togglePulldowns(oldPicker,true);}}}catch(err){microstrategy.errors.log(err);}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.togglePicker",0);}}return false;};dropDown.closePicker=function(F,D){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.closePicker",0);}if(!F){F=window.event;}var E=getEventTarget(F);var C=true;if(E){if(!E.getAttribute("id")&&E.parentNode.nodeType==1){E=E.parentNode;}var B=false;if(D.currentPicker){B=(findTarget(E,"ty")==D.currentPicker)&&(E!=D.currentPicker)&&(E.className.indexOf("disabled")<0);C=(E.className.indexOf("disabled")<0)&&(E!=D.currentPicker);}if(B){if(D.execPicker){C=D.execPicker(D.currentPicker,E);}else{alert("Option '"+E.getAttribute("id")+"' was selected from picker '"+D.currentPicker.id+"'. Please make sure the bone '"+D.id+"' implements execPicker.");}}}if(C&&D.currentPicker){dropDown.togglePicker(false,D.currentPicker.id,null,D);}return true;}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.closePicker",0);}}};dropDown.adjustPickerElements=function(I){try{var E=I.getAttribute(microstrategy.HTMLATTR_STYLE);switch(E){case"color":var H=microstrategy.userPalette;if(H){var B=microstrategy.findChildWithAtt(I,"span","name","pkrCustom");if(!B){return ;}if(B.getElementsByTagName("img").length==0){var J=document.createElement("img");J.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";B.appendChild(J);}displayObj(B);if(!ISIE7){var F=microstrategy.findChildWithAtt(I,"span","name","pkrMore");if(F){F.style.marginTop="25px";}}H=H.split(",");var A=microstrategy.findChildrenWithAtt(I,"span","custom","1");if(A.length==H.length&&A.length==8){if(A[0].id=="pkr"+H[0]){return ;}}else{if(A.length==H.length){return ;}}for(var D=0;D<A.length;D++){I.removeChild(A[D]);}for(var D=(H.length-1);D>=0;D--){var G=document.createElement("span");G.setAttribute("custom","1");G.id="pkr"+H[D];G.setAttribute("name","pkr"+H[D]);G.setAttribute("title",H[D]);G.style.backgroundColor=H[D];B.insertAdjacentElement("afterEnd",G);}}break;}}catch(C){microstrategy.errors.log(C);return false;}};mstrSerializer.prototype=new Object;mstrSerializer.prototype.buffer="";mstrSerializer.prototype.needDelim=false;mstrSerializer.CH_ESCAPE="*";mstrSerializer.CH_DELIM=".";mstrSerializer.CH_BRA="-";mstrSerializer.CH_KET="_";mstrSerializer.CH_LESS="<";mstrSerializer.STR_NULL="*0";mstrSerializer.prototype.getState=function(){try{return this.buffer;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addStr=function(B){try{if(this.needDelim){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(B);this.needDelim=true;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addInt=function(B){try{this.addStr(B+"");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addBoolean=function(B){try{this.addStr(B?"1":"0");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addValues=function(A){try{this.buffer+=mstrSerializer.CH_BRA;for(var B=0;B<A.length;B++){if(B>0){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(A[B]);}this.buffer+=mstrSerializer.CH_KET;this.needDelim=false;}catch(C){microstrategy.errors.log(C);return false;}};mstrSerializer.prototype.appendValue=function(C){try{var A=new RegExp("[\\"+mstrSerializer.CH_ESCAPE+"\\"+mstrSerializer.CH_BRA+"\\"+mstrSerializer.CH_KET+"\\"+mstrSerializer.CH_DELIM+"\\"+mstrSerializer.CH_LESS+"]","g");var D=mstrSerializer.CH_ESCAPE+"$&";C=String(C).replace(A,D);this.buffer+=C;}catch(B){microstrategy.errors.log(B);return false;}};function mstrSerializer(){return this;}mstrNumber.UNIT_CM="1";mstrNumber.UNIT_IN="2";mstrNumber.UNIT_MM="3";mstrNumber.UNIT_PT="4";mstrNumber.UNIT_PC="5";mstrNumber.UNIT_PX="6";mstrNumber.UNIT_EM="7";mstrNumber.prototype=new Object;mstrNumber.prototype.locale="1033";mstrNumber.prototype.units=mstrNumber.UNIT_IN;mstrNumber.prototype.unitsLabel="";mstrNumber.prototype.thousandSeparatorRegex=null;mstrNumber.prototype.toLocaleString=function(B){try{return(B+"").replace(".",mstr.Settings.Locale.DECIMALSEP);}catch(A){microstrategy.errors.log(A);return B;}};mstrNumber.prototype.toString=function(D,A){try{if(A==true){var C=this.getThousandSepRegex();if(C){D=String(D).replace(C,"");}}D=String(D).replace(mstr.Settings.Locale.DECIMALSEP,".");return D;}catch(B){microstrategy.errors.log(B);return D;}};mstrNumber.prototype.toUserUnits=function(C,B){try{return this.toLocalUnits(this.units,C,B);}catch(A){microstrategy.errors.log(A);}};mstrNumber.prototype.toLocalUnits=function(D,E,C){try{var A;switch(D){case mstrNumber.UNIT_CM:A=(parseFloat(this.toString(E))*2.54).toFixed(4)+"";break;case mstrNumber.UNIT_MM:A=(parseFloat(this.toString(E))*25.4).toFixed(4)+"";break;case mstrNumber.UNIT_PT:A=(parseFloat(this.toString(E))*72).toFixed(4)+"";break;case mstrNumber.UNIT_PC:A=(parseFloat(this.toString(E))*6).toFixed(4)+"";break;case mstrNumber.UNIT_PX:A=(parseFloat(this.toString(E))*microstrategy.DPI_CONVERSION)+"";break;case mstrNumber.UNIT_EM:A=(parseFloat(this.toString(E))*10.6666).toFixed(4)+"";break;default:A=parseFloat(this.toString(E)).toFixed(4)+"";}if(C){return A;}else{return this.toLocaleString(A);}}catch(B){microstrategy.errors.log(B);}};mstrNumber.prototype.toUSUnits=function(C,B){try{return this.convertToUSUnits(this.units,C,B);}catch(A){microstrategy.errors.log(A);}};mstrNumber.prototype.convertToUSUnits=function(D,E,C){try{var A=E;switch(D){case mstrNumber.UNIT_CM:A=parseFloat(this.toString(E))/2.54+"";break;case mstrNumber.UNIT_MM:A=parseFloat(this.toString(E))/25.4+"";break;case mstrNumber.UNIT_PT:A=parseFloat(this.toString(E))/72+"";break;case mstrNumber.UNIT_PC:A=parseFloat(this.toString(E))/6+"";break;case mstrNumber.UNIT_PX:A=parseFloat(this.toString(E))/microstrategy.DPI_CONVERSION+"";break;case mstrNumber.UNIT_EM:A=(parseFloat(this.toString(E))/10.6666)+"";break;}if(C){return A;}else{return this.toLocaleString(A);}}catch(B){microstrategy.errors.log(B);}};mstrNumber.prototype.convertUnit=function(B,C,A){return this.toLocalUnits(C,this.convertToUSUnits(B,A,true),true);};mstrNumber.prototype.getThousandSepRegex=function(){if(this.thousandSeparatorRegex==null){var A=mstr.Settings.Locale.THOUSANDSEP;A=A.replace(/(\W){1}/g,"\\$1");this.thousandSeparatorRegex=new RegExp(A,"g");}return this.thousandSeparatorRegex;};function mstrNumber(){return this;}microstrategy.number=new mstrNumber();GradientUtilScript=true;var gradientUtil=new function(){};gradientUtil.prototype=new Object();gradientUtil.PIXEL_WIDTH=2;gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL=1;gradientUtil.GRADIENTSHADING_STYLE_VERTICAL=2;gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP=3;gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN=4;gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER=5;gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER=6;gradientUtil.GRADIENTSHADING_STYLE_CUSTOM=7;gradientUtil.GRADIENT_START_COLOR_INDEX=0;gradientUtil.GRADIENT_END_COLOR_INDEX=1;gradientUtil.GRADIENT_TRANSITION_TYPE_INDEX=2;gradientUtil.GRADIENT_ANGLE_INDEX=3;gradientUtil.GRADIENT_XOFFSET_INDEX=4;gradientUtil.GRADIENT_YOFFSET_INDEX=5;gradientUtil.GRADIENT_POSTFIX="_gradient";gradientUtil.getXCoordinate=function(C,A){try{return parseInt(C%(A/this.PIXEL_WIDTH));}catch(B){microstrategy.errors.log(B);return false;}};gradientUtil.getYCoordinate=function(C,A){try{return parseInt(C/(A/this.PIXEL_WIDTH));}catch(B){microstrategy.errors.log(B);return false;}};gradientUtil.getColorPercent=function(E,G,A,C,B){try{switch(parseInt(B)){case gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:if(A==1){return E*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return 1-E*gradientUtil.PIXEL_WIDTH/C;}else{if(A==3){return 1-(((-2)*Math.abs(E-(C/gradientUtil.PIXEL_WIDTH)/2))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_VERTICAL:if(A==1){return G*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return 1-G*gradientUtil.PIXEL_WIDTH/C;}else{if(A==3){return 1-(((-2)*Math.abs(G-(C/gradientUtil.PIXEL_WIDTH)/2))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP:if(A==1){return((E+G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==2){return 1-((E+G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==3){return 1-(((-1)*Math.abs((E+G)-(C/gradientUtil.PIXEL_WIDTH)))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN:if(A==1){return 1-((E+(C/gradientUtil.PIXEL_WIDTH)-G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==2){return((E+(C/gradientUtil.PIXEL_WIDTH)-G)*gradientUtil.PIXEL_WIDTH/C)/2;}else{if(A==3){return 1-(((-1)*Math.abs((E+(C/gradientUtil.PIXEL_WIDTH)-G)-(C/gradientUtil.PIXEL_WIDTH)))+(C/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/C;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER:if(A==1){return Math.max(E,G)*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return Math.max((C/gradientUtil.PIXEL_WIDTH)-E,G)*gradientUtil.PIXEL_WIDTH/C;}else{if(A==3){return 1-Math.min(E,G)*gradientUtil.PIXEL_WIDTH/C;}else{if(A==4){return 1-Math.min((C/gradientUtil.PIXEL_WIDTH)-E,G)*gradientUtil.PIXEL_WIDTH/C;}}}}break;case gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER:var F=2*gradientUtil.PIXEL_WIDTH;if(A==1){return 1-(2*Math.min(Math.min((C/gradientUtil.PIXEL_WIDTH)-E,E),Math.min((C/gradientUtil.PIXEL_WIDTH)-G,G)))*gradientUtil.PIXEL_WIDTH/C;}else{if(A==2){return((Math.abs(E-(C/F))/(C/F))+(Math.abs(G-(C/F))/(C/F)))/2;}else{if(A==3){return Math.sqrt((Math.pow(Math.abs(E-(C/F)),2)+Math.pow(Math.abs(G-(C/F)),2))/Math.pow((C/F),2));}}}break;}}catch(D){microstrategy.errors.log(D);}};gradientUtil.getRGBColor=function(B){try{if(B.indexOf("#")>=0){B=B.substring(B.indexOf("#")+1);}var C=new Array();if(B.length==6){var F=parseInt(B.substring(0,2),16);var E=parseInt(B.substring(2,4),16);var A=parseInt(B.substring(4,6),16);C.push(F);C.push(E);C.push(A);return C;}else{return[0,0,0];}}catch(D){microstrategy.errors.log(D);return false;}};gradientUtil.createIntervalColors=function(C,B,A,D){try{var E=new Array();var G=(A-D)/2;E[0]=gradientUtil.createIntervalColor(C,B,(A-G)/A);E[1]=gradientUtil.createIntervalColor(C,B,G/A);return E;}catch(F){microstrategy.errors.log(F);return false;}};gradientUtil.createIntervalColor=function(B,A,D){try{var C=gradientUtil.setColorHue(gradientUtil.longHexToDec(B),D,gradientUtil.longHexToDec(A));return mstr.utils.Color.rgb2hex(C[0],C[1],C[2]);}catch(E){microstrategy.errors.log(E);return false;}};gradientUtil.setColorHue=function(E,D,F){try{var A=new Array();for(var B=0;B<E.length;B++){A[B]=Math.round(E[B]*D)+Math.round(F[B]*(1-D));A[B]=A[B]>255?255:A[B];}return A;}catch(C){microstrategy.errors.log(C);return false;}};gradientUtil.longHexToDec=function(A){try{return new Array(gradientUtil.toDec(A.substring(0,2)),gradientUtil.toDec(A.substring(2,4)),gradientUtil.toDec(A.substring(4,6)));}catch(B){microstrategy.errors.log(B);return false;}};gradientUtil.toDec=function(B){try{return parseInt(B,16);}catch(A){microstrategy.errors.log(A);return false;}};gradientUtil.applyGradientSettings=function(C,A,B){gradientUtil.applyGradient(C,A[gradientUtil.GRADIENT_START_COLOR_INDEX],A[gradientUtil.GRADIENT_END_COLOR_INDEX],A[gradientUtil.GRADIENT_ANGLE_INDEX],A[gradientUtil.GRADIENT_XOFFSET_INDEX],A[gradientUtil.GRADIENT_YOFFSET_INDEX],microstrategy.styleObj);};gradientUtil.applyGradient=function(E,H,C,I,F,B,A){try{var G=(I==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;if((G==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL&&F!=100)||(G==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL&&B!=100)){gradientUtil.createGradient(E,H,C,G,A,true);}else{gradientUtil.createGradient(E,C,H,G,A,false);}}catch(D){microstrategy.errors.log(D);return false;}};gradientUtil.createGradient=function(H,K,E,J,A,M){try{var C=(J==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL)?1:0;if(bIsDXIE){var B=false;var D=H.style.filter;if((D==null||D.length==0)&&A){D=A.getFilter(H);if(D&&D.length>0){B=true;}}var I=null;if(D!=null&&D.length>0){I=H.filters["DXImageTransform.Microsoft.Gradient"];}if((getObjInnerHeight(H)<2&&J==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL)||(getObjInnerWidth(H)<2&&J==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL)){if(I){I.enabled=false;}H.style.backgroundColor="#"+K;return ;}if(I!=null){I.gradientType=C;I.startColorStr="#FF"+K;I.endColorStr="#FF"+E;I.enabled=true;}else{if(!B){H.style.filter+="progid:DXImageTransform.Microsoft.Gradient(GradientType="+C+", StartColorStr='#"+K+"', EndColorStr='#"+E+"') ";}else{A.objSheet.styleRules[A.getId(H)].style.filter+="progid:DXImageTransform.Microsoft.Gradient(GradientType="+C+", StartColorStr='#"+K+"', EndColorStr='#"+E+"') ";}}H.style.backgroundColor="transparent";}else{H.style.backgroundColor="#"+((M==true)?K:E);var L="#"+K,G="#"+E;if(mstr.utils.ISFF){H.style.background="-moz-linear-gradient("+((C===0)?"top":"left")+","+L+","+G+")";}else{if(mstr.utils.ISWK){H.style.background="-webkit-gradient(linear,"+((C===0)?"left top, left bottom":"left top, right top")+",from("+L+"),to("+G+"))";}else{if(mstr.utils.ISIE10||mstr.utils.ISW3CIE){H.style.background="linear-gradient("+((C===0)?"to bottom":"to right")+","+L+","+G+")";}}}}}catch(F){microstrategy.errors.log(F);return false;}};mstrObserverImpl.prototype=new Object();mstrObserverImpl.prototype.items=null;mstrObserverImpl.prototype.onload=function(){if(microstrategy.observerItems){this.items=microstrategy.observerItems;microstrategy.observerItems=null;}};mstrObserverImpl.prototype.onunload=function(){microstrategy.observerItems=this.items;};mstrObserverImpl.prototype.register=function(A){if(typeof (this.items[A])=="undefined"){this.items[A]=A;}return true;};mstrObserverImpl.prototype.unregister=function(A){if(typeof (this.items[A])!="undefined"){delete this.items[A];}return true;};mstrObserverImpl.prototype.notifyAll=function(A,D){try{for(var E in this.items){var C=mstr.$obj(E);if(C&&A in C){C[A](D);}}return true;}catch(B){microstrategy.errors.log(B);return false;}};function mstrObserverImpl(A){this.items=new Object();return this;}microstrategy.FEATURE_CHECK_SHOW_SUBTOTALS="check-show-subtotals";microstrategy.FEATURE_CHECK_MERGE_COL_HEADER="check-merge-col-header";microstrategy.FEATURE_CHECK_MERGE_ROW_HEADER="check-merge-row-header";microstrategy.FEATURE_CHECK_OUTLINE_MODE="check-outline-mode";microstrategy.FEATURE_WEB_REMOVE_FROM_GRID="web-remove-from-grid";microstrategy.FEATURE_INSERT_NEW_METRIC="insert-new-metric";microstrategy.FEATURE_INSERT_TRANSFORMATION_METRICS="insert-transformation-metrics";microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS="modify-grid-level-in-documents";microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE="documents-design-mode";microstrategy.FEATURE_SET_ATTRIBUTEFORM_DISPLAY="set-attributeform-display";microstrategy.FEATURE_RW_INTERACTIVE_VIEW_MODE_EPLUS="rw-interactive-view-mode-eplus";microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS="rw-editable-view-mode-eplus";microstrategy.FEATURE_DATASET_OBJECTS_LIST="dataset-objects-list";microstrategy.FEATURE_WEB_PIVOT="web-pivot";microstrategy.FEATURE_CHECK_SHOW_PIVOT_BUTTONS="check-show-pivot-buttons";microstrategy.FEATURE_CHECK_SHOW_SORT_BUTTONS="check-show-sort-buttons";microstrategy.FEATURE_USE_OFFICE="useOffice";microstrategy.FEATURE_MODIFY_REPORT_LIST="modify-report-list";microstrategy.FEATURE_REPORT_FROM_REPORT="web-remove-from-report";microstrategy.FEATURE_USE_REPORT_OBJECT_WINDOW="report-objects-window";microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE="embedded-template-node";microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE="rw-editable-view-mode";microstrategy.FEATURE_ENABLE_REEXECUTE="enable-reexecute";microstrategy.FEATURE_CHECK_SHOW_BANDING="check-show-banding";microstrategy.FEATURE_ENABLE_SCHEDULING="enable-scheduling";microstrategy.FEATURE_IS_NON_VIEWABLE_REPORT="is-non-viewable-report";microstrategy.FEATURE_REPORT_FILTER="report-filter";microstrategy.FEATURE_CREATE_HTML_CONTAINER="create-html-container";microstrategy.FEATURE_CHECK_SHOW_GRAPH_ZONES="check-show-graph-zones";microstrategy.FEATURE_INSERT_INTO_PANEL="insert-into-panel";microstrategy.FEATURE_CHECK_DESIGN_MODE="check-design-mode";microstrategy.FEATURE_ENABLE_SHOW_SUBTOTALS="enable-show-subtotals";microstrategy.FEATURE_IS_VIEW_REPORT="is-view-report";microstrategy.FEATURE_CHECK_LOCK_COLUMN_HEADERS="check-lock-column-headers";microstrategy.FEATURE_CHECK_LOCK_ROW_HEADERS="check-lock-row-headers";microstrategy.FEATURE_CONFIGURE_TRANSACTIONS="configure-transactions";microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES="ask-before-save-changes";microstrategy.FEATURE_FORCE_SAVE_AS="force-save-as";microstrategy.FEATURE_REPORT_TEMPLATE_SEARCH="report-template-search";microstrategy.FEATURE_SINGLE_SOURCE_GRID="single-source-grid";microstrategy.FEATURE_RW_LEVEL_MCE_JOIN="rw-MCE-join";microstrategy.FEATURE_PROJECT_LEVEL_MCE_JOIN="project-MCE-join";microstrategy.FEATURE_MANAGE_DATASETS="manage-datasets";mstrViewerCommandsImpl.prototype=new Object();mstrViewerCommandsImpl.prototype.itemSep="~";mstrViewerCommandsImpl.prototype.unitSep="\u001F";mstrViewerCommandsImpl.prototype.clipboardItemSep="\u001E";mstrViewerCommandsImpl.prototype.valueField="dssid";mstrViewerCommandsImpl.prototype.nameField="n";mstrViewerCommandsImpl.prototype.typeField="t";mstrViewerCommandsImpl.prototype.exec=function(K,H,h){try{var d=microstrategy.updateManager;switch(K){case"ping":return this.execPingServer();case"undo":return d.undo();case"redo":return d.redo();case"doFlush":d.add([d.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return d.flushAndSubmitChanges();case"IVEMode":if(microstrategy.pageScreenMode!=microstrategy.PAGE_FULL_SCREEN_MODE){toggleScreenMode();}case"interactiveViewMode":case"editableMode":case"flashViewMode":var e={interactiveViewMode:microstrategy.RW_VIEW_MODE_INTERACTIVE,editableMode:microstrategy.RW_VIEW_MODE_EDITABLE,flashViewMode:microstrategy.RW_VIEW_MODE_FLASH,IVEMode:microstrategy.RW_VIEW_MODE_VIEWANALYSIS};H=e[K];case"rwCurrentViewMode":d.add([d.createActionObject(null,mstrUpdateManager.SET_CURRENT_VIEW_MODE,this.parentBone.beanPath,["55004"],[H],[])],true);d.useIframe=false;d.flushAndSubmitChanges();return true;case"staticViewMode":case"publishViewMode":var I=this.parentBone.visualizationMode;var Q=this.parentBone.currentRWViewMode;if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){var Y=microstrategy.RW_VIEW_MODE_STATIC|microstrategy.RW_VIEW_MODE_INTERACTIVE|microstrategy.RW_VIEW_MODE_FLASH;if(Q&Y){I="0";}}if(this.parentBone.isLayoutLevelVis){I="0";}d.add([d.createActionObject(null,mstrUpdateManager.RUN_RW_DOCUMENT,microstrategy.servletName,["2048174","2048002","2048109"],["1",this.parentBone.messageID,I],[])],true);if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){Q=0;}d.replaceURL("prevViewMedia",Q);d.useIframe=false;d.flushAndSubmitChanges();return true;case"designViewMode":case"convertToDoc":H=1;if(K=="convertToDoc"){this.showMessageForIVE("rwChangeDesignMode",H,h);return true;}case"rwChangeDesignMode":d.add([d.createActionObject(null,mstrUpdateManager.CHANGE_DESIGN_MODE,this.parentBone.beanPath,["3017"],[H],[])],true);d.useIframe=false;d.flushAndSubmitChanges();return true;case"docVisualizationModeAJAX":return this.exec("docVisualizationMode",51);case"docVisualizationModeFlash":return this.exec("docVisualizationMode",50);case"docVisualizationMode":d.useIframe=false;microstrategy.adjustSelectedVisualization(this.parentBone,H);var Q=(this.parentBone.visualizationMode==H)?"0":H;d.add([d.createActionObject(this.elem,mstrUpdateManager.SET_VISUALIZATION_MODE,this.parentBone.beanPath,["2048109","2048212"],[Q,this.parentBone.isLayoutLevelVis?"-1":""],[],[])]);d.add([d.createActionObject(this.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[])]);d.flushAndSubmitChanges();this.parentBone.isVisualization=(Q>=microstrategy.FIRST_VISUALIZATION_VIEW_MODE);this.parentBone.visualizationMode=Q;return true;case"ZoomType":var X=mstrFormatObject;var y=X.getPropertySetName(K)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(K)+mstrUpdateManager.UNIT_SEPARATOR+H+mstrUpdateManager.ITEM_SEPARATOR;d.add([d.createActionObject(null,mstrUpdateManager.SET_DOCUMENT_ZOOM,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,y],[])]);return true;case"zoom":var J=H,O,m=this.queryState("rwCurrentViewMode"),V=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&(m==microstrategy.RW_VIEW_MODE_FLASH||m==microstrategy.RW_VIEW_MODE_VIEWANALYSIS)),Q=this.parentBone.isVisualization;if(J=="Width"){if(!V||Q){J=this.queryState("widthZoomFactor");}O=microstrategy.ZOOM_FIT_WIDTH;}else{if(J=="Page"){if(!V||Q){J=Math.min(this.queryState("heightZoomFactor"),this.queryState("widthZoomFactor"));}O=microstrategy.ZOOM_FIT_PAGE;}else{O=microstrategy.ZOOM_STATIC;}}if(J!=microstrategy.ZOOM_FACTOR||O!=microstrategy.zoomType){microstrategy.ZOOM_FACTOR=J;microstrategy.zoomType=O;this.exec("ZoomType",O);var a=false;if(V&&!Q){microstrategy.getViewerBone().callFlashPlayerFn("changeZoomType",[J,O]);if(O==microstrategy.ZOOM_STATIC){a=true;}}else{a=true;}if(a){J=J/100;var X=mstrFormatObject;var y=X.getPropertySetName(K)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(K)+mstrUpdateManager.UNIT_SEPARATOR+X.encodeValue(K,J)+mstrUpdateManager.ITEM_SEPARATOR;if(!V||Q){d.add([d.createActionObject(null,mstrUpdateManager.RW_GRAPH_DZ_SET_ZOOMFACTOR,this.parentBone.gdzBeanPath,["121002"],[microstrategy.ZOOM_FACTOR],[])]);}d.add([d.createActionObject(null,mstrUpdateManager.SET_DOCUMENT_ZOOM,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,y],[])]);if(Q){d.useIframe=false;}if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.queryState("rwCurrentViewMode")!=microstrategy.RW_VIEW_MODE_FLASH||Q){d.flushAndSubmitChanges();}}}if(!V){this.parentBone.onselectionchange();}return true;case"showBean":this.showBean(d,H);return true;case"sendNow":this.exec("showBean","ncSendNow",h);return true;case"scheduleHL":this.exec("showBean","subs",h);return true;case"mobileSubs":case"ncSubs":case"ncFileSubs":case"ncFtpSubs":case"ncPrintSubs":case"ncCacheSubs":this.exec("showBean",K,h);return true;case"save":var AB=document.getElementById("askBeforeSaveCheckbox");if(AB&&AB.checked&&this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES)){this.exec("forceSaveAs");}var L=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"true":"false";var C=(this.parentBone.saveFolderId)?this.parentBone.saveFolderId:this.parentBone.parentFolderID;var k=["3013","3014","3017"];var AC=["false",C,L];if(H&&H.origin){k.push("3031");AC.push(H.origin);}var D=d.createActionObject(null,mstrUpdateManager.RW_SAVE_AS,microstrategy.servletName,k,AC,[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"dSave":var q=this.parentBone.saveFolderId,U=this.parentBone.parentFolderID;if(q||this.isNew(U)||this.parentBone.isRWReadonly){return this.exec("save",K,h);}else{if(this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ASK_BEFORE_SAVE_CHANGES)){this.askBeforeSaveOverwrite();}else{this.submitSave();}return true;}case"dontAskAgain":var F=0;this.parentBone.setFeature("ask-before-save-changes",0);var D=d.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.beanPath,["5003","5004"],["askBeforeSaveChanges",F],[],null);d.add([D],true);d.flushAndSubmitChanges();return true;case"forceSaveAs":var F=2;this.parentBone.setFeature(microstrategy.FEATURE_FORCE_SAVE_AS,0);var D=d.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.beanPath,["5003","5004"],["askBeforeSaveChanges",F],[],null);d.add([D],true);d.flushAndSubmitChanges();return true;case"reprompt":this.refreshViewer(d,true,false,false);return true;case"refresh":this.refreshViewer(d,false,false,false);return true;case"rerun":this.refreshViewer(d,false,true,false);return true;case"regenerate":this.refreshViewer(d,false,false,true);return true;case"browseParent":var T=this.parentBone,n=["1001"],k=[T.parentFolderID];if(T.goBackOverride){this.exec("openPage","-1");return true;}else{if(!T.parentFolderID||T.isParentFolderHidden){return this.exec("openHome");}}if(T.sysFolderId){n.push("2023");k.push(T.sysFolderId);}var D=d.createActionObject(null,mstrUpdateManager.BROWSE_FOLDER,microstrategy.servletName,n,k,[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"openDefaultHome":case"openHome":var g={openHome:mstrUpdateManager.OPEN_DESKTOP,openDefaultHome:mstrUpdateManager.OPEN_DEFAULT_DESKTOP}[K];var D=d.createActionObject(null,g,microstrategy.servletName,[],[],[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"restoreScreenMode":var D=d.createActionObject(null,mstrUpdateManager.SWITCH_FULL_SCREEN_MODE,this.parentBone.beanPath,["5028"],[H],[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"saveToInbox":this.parentBone.sentToInbox=true;var D=d.createActionObject(null,mstrUpdateManager.RW_SAVE_TO_INBOX,this.parentBone.beanPath,[],[],[],null);d.add([D],true);d.flushAndSubmitChanges();return true;case"docDetails":d.add([d.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);var D=d.createActionObject(null,mstrUpdateManager.RW_DOC_DETAILS,microstrategy.servletName,["3010","3016"],[this.parentBone.messageID,"0"],[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"setPreference":var D=d.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.beanPath,["5003","5004"],[H.prefName,H.prefValue],[],null);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"toggleConditionalFormatting":var D=d.createActionObject(this.elem,mstrUpdateManager.TOGGLE_DOC_THRESHOLDS,this.parentBone.beanPath,[],[],[],[]);d.add([D],true);d.flushAndSubmitChanges();return true;case"datasetObjPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_DATASET_PANEL);return true;case"relatedReportsPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_RELATED_RP_PANEL);return true;case"notesPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_NOTES_PANEL);return true;case"outlinePanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_RW_OUTLINE_PANEL);return true;case"newRW":var D=d.createActionObject(this.elem,mstrUpdateManager.CREATE_NEW_DOCUMENT,microstrategy.servletName,[],[],[],[]);d.useIframe=false;d.add([D],true);d.flushAndSubmitChanges();return true;case"browseParent":case"openHome":return true;case"toggleScreenMode":toggleScreenMode();return true;case"exportExcel":return this.exec("export",4);case"exportHtml":return this.exec("export",-1);case"exportFlash":return this.exec("export",7);case"printPDF":return this.exec("export",3);case"export":if(H==7&&this.parentBone.hasUCSelectors){showMessage({contents:microstrategy.descriptors.getDescriptor("7482"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"mstr.$obj('"+this.parentBone.id+"').commands.exec('trueExport',"+H+");",type:mstrMsgBoxImpl.MSG_WARNING});}else{return this.exec("trueExport",H);}return true;case"trueExport":var A=this.parentBone.isFeatureAvailable("export-new-window")?"_blank":"mstrExportWindow";exportRW(H,A);case"proxyForGridObservers":if(this.parentBone.observer){this.parentBone.observer.notifyAll(H);}return true;case"toggleFlashGrouping":this.parentBone.toggleGrouping();return true;case"IVEHelp":window.open(this.parentBone.helpPath+"#about_interactive_visual_data_exploration.htm","_blank");return true;case"close":if(mstrApp.pathInfo.nb[1].href==="#"||mstrApp.isHomePage){return this.exec(mstrApp.preferences.startPage=="3187"?"openDefaultHome":"openHome");}H="-1";case"openPage":d.useIframe=false;var o=new Array();o.push(d.createActionObject(this.elem,mstrUpdateManager.OPEN_HISTORY_PAGE,microstrategy.servletName+"."+microstrategy.pageName,["3140"],[H]));d.add(o,true);d.flushAndSubmitChanges();return true;case"setUnsetFalse":H;var AA=this.parentBone.formattingAttributes[H];if(AA){AA.isUs=false;}return true;case"createPersonalView":this.exec("showBean","pvsubs",h);return true;case"ShowSharingEditor":var T=this.parentBone,Z=microstrategy.getViewerBone().isDocBlank||microstrategy.getViewerBone().isBlankAnalysis,f={success:function(){var AE=T.stateID,AF="sharingEditor",c=window.mstrmojo&&mstrmojo.all[AF];microstrategy.showSharingEditor(null,{lastState:AE},true);},failure:function(){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){}},R=microstrategy.updateManager;if(Z){showMessage({contents:microstrategy.descriptors.getDescriptor("14121"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"mstr.$obj('"+this.parentBone.id+"').commands.exec('save', {origin:"+microstrategy.SAVE_AS_SHARE_EDITOR+"});",buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("118")},type:mstrMsgBoxImpl.MSG_WARNING});}else{if(R.newActions){R.add([R.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[],null)]);R.flushAndSubmitChanges(false,f);}else{f.success();}}return true;}if(!this.parentBone.doc){return ;}switch(K){case"rulers":return this.parentBone.toggleRuler();break;case"grid":return this.parentBone.toggleGrid();break;case"divider":return this.parentBone.toggleDivider();break;case"unloadDocViewer":if(this.parentBone.doc.selections){this.parentBone.doc.selections.clear();}microstrategy.unregisterGridBones();window.setTimeout("microstrategy.unRegisterBone('"+this.parentBone.id+"')",0);break;case"activeTab":if(H!=this.parentBone.currentLayout){var d=this.parentBone.updateManager;d.add([d.createActionObject(null,mstrUpdateManager.SET_CURRENT_LAYOUT,this.parentBone.beanPath,["2048007"],[H],[])]);this.exec("unloadDocViewer");d.flushAndSubmitChanges();}break;case"moveTab":var d=this.parentBone.updateManager;var AD=["2048007"];var AC=[H[0]];if(H[1]){AD.push("2048036");AC.push(H[1]);}d.add([d.createActionObject(null,mstrUpdateManager.MOVE_LAYOUT,this.parentBone.beanPath,AD,AC,[])],true);break;case"addTab":case"addNewLayout":case"addExistingLayout":var B={};if(K=="addNewLayout"||K=="addTab"){B["tabList/selectedIndicesList"]=0;}else{if(K=="addExistingLayout"){B["tabList/selectedIndicesList"]=2;}}microstrategy.openFolderBasedBlockEditor("insertLayoutEditor","InsertLayoutEditorBlockLoader",{folderID:"FCA4BAFE4AF0D00088028989D7497A4F",typeRestriction:"14081"},B);break;case"removeTab":showMessage({contents:microstrategy.descriptors.getDescriptor("4360"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.parentBone.id+"').commands.exec('confirmRemoveTab', "+((H)?"'"+H+"'":"null")+");",type:mstrMsgBoxImpl.MSG_WARNING,title:microstrategy.descriptors.getDescriptor("5678")+": "+this.parentBone.currentLayoutName});break;case"confirmRemoveTab":var d=this.parentBone.updateManager;var N=(H)?H:this.parentBone.currentLayout;var E=this.parentBone.BeforeLayoutItems;var p=this.parentBone.BeforeLayout;for(var u=0;u<E.length;u++){var W=E[u];if(W.key==N){if(W.dssid==p&&E[u+1]){this.parentBone.BeforeLayout=E[u+1]["dssid"];}E.splice(u,1);break;}}var G=N==this.parentBone.currentLayout;d.add([d.createActionObject(null,mstrUpdateManager.REMOVE_LAYOUT,this.parentBone.beanPath,["2048007","2048176"],[N,G],[])],true);if(G){d.flushAndSubmitChanges();}else{this.parentBone.observer.notifyAll("onDeleteLayoutTab");}break;case"TabName":var X=mstrFormatObject;var S="name";var d=this.parentBone.updateManager;var y=this.parentBone.currentLayout+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertySetName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.encodeValue(S,H.value)+mstrUpdateManager.ITEM_SEPARATOR;d.add(d.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,y],[]));break;case"tabMPHF":var X=mstrFormatObject;var S="TabMPHF";var d=this.parentBone.updateManager;d.add(d.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,this.parentBone.currentLayout+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertySetName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.encodeValue(S,H.value)+mstrUpdateManager.ITEM_SEPARATOR],[]));break;case"VisibleSections":var X=mstrFormatObject;var S="visibility";var d=this.parentBone.updateManager;var y=H.obj.id+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertySetName(S)+mstrUpdateManager.UNIT_SEPARATOR+X.getPropertyName(S)+mstrUpdateManager.UNIT_SEPARATOR+H.value+mstrUpdateManager.ITEM_SEPARATOR;d.add(d.createActionObject(H.obj,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,y],[]));break;case"formatMultiLevelBulk":for(var u=H.length-1;u>=0;u--){var P=H[u].split("|");if(P[0]==microstrategy.FORMAT_LEVEL_FLAG_VIEWER){var z=H.splice(u,1)[0];this.exec(P[1],P[2]);}}if(H.length>0){this.parentBone.doc.commands.exec(K,H);}break;case"MultiLevelPropertyChanges":for(var u=H.length-1;u>=0;u--){if(H[u].level==microstrategy.FORMAT_LEVEL_FLAG_VIEWER){var M=H.splice(u,1)[0];this.exec(M.cmdId,M);}}if(H.length>0){this.parentBone.doc.commands.exec(K,H);}break;default:return this.parentBone.doc.commands.exec(K,H,h);break;}return true;}catch(x){microstrategy.errors.log(x);return false;}};mstrViewerCommandsImpl.prototype.askBeforeSaveOverwrite=function(){try{var C=microstrategy.descriptors.getDescriptor("11165").replace(/##/,"<b>"+encode(this.parentBone.objectName)+"</b>");var A="<label for='askBeforeSaveCheckbox' id='glabel'> "+microstrategy.descriptors.getDescriptor("211")+" </label>";var D="<input name='askBeforeSave' id='askBeforeSaveCheckbox' type='checkbox'/> ";showMessage({contents:"<div style='overflow:auto'>"+C+"</div><br/><br/><div style='overflow:auto' text-align:center>"+D+A+"</div>",elements:microstrategy.OK_BUTTON+microstrategy.APPLY_BUTTON+microstrategy.CANCEL_BUTTON,applyEval:"microstrategy.bones['"+this.parentBone.id+"'].commands.submitSave()",okEval:"microstrategy.bones['"+this.parentBone.id+"'].commands.exec('save')",buttonLabels:{Apply:microstrategy.descriptors.getDescriptor("219"),Ok:microstrategy.descriptors.getDescriptor("218")},title:microstrategy.descriptors.getDescriptor("5728"),type:mstrMsgBoxImpl.MSG_TEXT_ONLY});}catch(B){microstrategy.errors.log(B);}};mstrViewerCommandsImpl.prototype.submitSave=function(){try{var C=document.getElementById("askBeforeSaveCheckbox");if(C&&C.checked&&this.parentBone.isFeatureAvailable("ask-before-save-changes")){this.exec("dontAskAgain");}var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[],null)]);A.add([A.createActionObject(null,mstrUpdateManager.SAVE_OBJECT,this.parentBone.beanPath,["89001"],["0"],[],null)]);A.flushAndSubmitChanges();}catch(B){microstrategy.errors.log(B);}};mstrViewerCommandsImpl.prototype.isNew=function(A){return(A=="6C87013036D94E65B9FD227CF919327E"||A=="FCA4BAFE4AF0D00088028989D7497A4F"||A=="C1EDA6CB4A7933A0C0B3AF92EEBBFC2E");};mstrViewerCommandsImpl.prototype.showMessageForIVE=function(A,F,B){var E=typeof (A)=="string"?"'"+A+"'":A,D=typeof (F)=="string"?"'"+F+"'":F,C=typeof (B)=="string"?"'"+B+"'":B;showMessage({contents:microstrategy.descriptors.getDescriptor("8127"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bones['"+this.parentBone.id+"'].commands.askedForIVE = true; microstrategy.bones['"+this.parentBone.id+"'].commands.exec("+E+","+D+","+C+");",type:mstrMsgBoxImpl.MSG_WARNING});if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}};mstrViewerCommandsImpl.prototype.refreshViewer=function(B,A,D,C){var E=B.createActionObject(null,mstrUpdateManager.RW_REFRESH,this.parentBone.beanPath,["2048059","2048060","2048143"],[A,D,C],[],null);B.useIframe=false;B.add([E],true);B.flushAndSubmitChanges();};mstrViewerCommandsImpl.prototype.showBean=function(A,C){var B=A.createActionObject(null,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],[true,C],[],null);A.add([B],true);A.flushAndSubmitChanges();return true;};mstrViewerCommandsImpl.prototype.queryEnabled=function(P,J){try{var K=microstrategy.updateManager;switch(P){case"redoq":return K.anyNonStatic(true);break;case"undoq":return K.anyNonStatic(false);break;case"doFlush":return K.hasChangesToSubmit();break;case"IVEMode":case"designViewMode":case"convertToDoc":case"staticViewMode":case"publishViewMode":case"interactiveViewMode":case"editableMode":case"flashViewMode":case"export":case"printPDF":case"exportExcel":case"exportHtml":case"exportFlash":case"exportPDF":case"save":case"dSave":case"newRW":case"datasetObjPanel":case"relatedReportsPanel":case"outlinePanel":case"notesPanel":case"groupBy":case"zoom":case"grid":case"rwCurrentViewMode":case"rwChangeDesignMode":case"activeTab":case"moveTab":case"addTab":case"TabName":case"tabMPHF":case"addNewLayout":case"addExistingLayout":case"toggleScreenMode":case"openHome":case"sendNow":case"scheduleHL":case"mobileSubs":case"ncSubs":case"ncFileSubs":case"ncCacheSubs":case"ncFtpSubs":case"ncPrintSubs":case"createPersonalView":case"ShowSharingEditor":case"docVisualizationModeFlash":case"docVisualizationModeAJAX":case"toggleFlashGrouping":case"docDetails":case"hasMultipleLayouts":case"close":case"IVEHelp":case"canBeScheduled":case"canBeSubscribed":case"selectedUsers":case"userSubscribeRights":return true;break;case"browseParent":return !this.parentBone.isBlankAnalysis;case"removeTab":return this.queryState("hasMultipleLayouts");break;case"docVisualizationMode":return this.parentBone.visualizationsEnabled;case"refresh":return true;case"reprompt":return this.parentBone.isFeatureAvailable("enable-reprompt");case"rerun":case"regenerate":return this.parentBone.isFeatureAvailable("enable-reexecute");case"toggleConditionalFormatting":return this.parentBone.isFeatureAvailable("rw-document-has-thresholds");case"saveToInbox":var L=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE||!this.parentBone.sentToInbox;return mstr.behaviors.featureResolver.featAvailable("enable-add-history-list")&&L;case"createCalculationCM":case"customGroupCM":var A=this.parentBone.doc.selections.getSelectedGrid();var I=microstrategy.findBone(A);if(!(I&&I.selections&&I.selections.singleAttributeElementsAreSelected()&&I.selections.getSelectedGridTarget)){return false;}var G="";var C="";var N=null;var H="";var E="";var D=I.selections.getSelectedGridTarget();if(D&&D.length>0){var O=D.split(",");if(O!=null&&O.length>=2){E=O[0];G=O[1];C=O[2];N=I.gridStructureInfo.getUnit(E,G,C);if(N!=null){if(N.dssType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){N=I.gridStructureInfo.findUnit(N.parentDssId);}H=N.dssId;}}}if(!H){return false;}var Q=(I&&I.commands)?I.commands.queryState("getControlGroupByList"):false;if(Q){all:for(var B in Q){if(Q[B].dfm!="1"){continue;}var M=Q[B].oid;if(H==M){return false;}}}return true;default:return(this.parentBone&&this.parentBone.doc&&this.parentBone.doc.commands)?this.parentBone.doc.commands.queryEnabled(P,J):false;break;}}catch(F){microstrategy.errors.log(F);return false;}};mstrViewerCommandsImpl.prototype.queryState=function(F,c){try{var K=this;var P=this.parentBone;var f=function(AD){var AC=[];if(mstr.utils.String.trim(AD).length>0){var x=AD.split(K.clipboardItemSep);for(var y=0,g=x.length;y<g;y++){var z=x[y],AB=z.split(K.itemSep);var AA={};AA[K.valueField]=z;AA[K.typeField]=AB[1];AA[K.nameField]=AB[2];AC.push(AA);}}return AC;};var m=function(){try{if(!!P.asLoaded){return ;}iframe.showWaitPage();var x=function(z){var AC="";for(var AA=0,y=z.length;AA<y;AA++){var AB=z[AA];AC+=AB[K.valueField];if(AA<y-1){AC+=K.clipboardItemSep;}}return AC;};mstr.$XHR.request(mstrApp.taskURL||mstrConfig.taskURL,{taskId:"getSubscriptionAssociatedInformation",objectID:P.objectID,objectType:P.objectType,msgID:P.messageID},{success:function(y){P.asLoaded=true;P.canBeScheduled=!y.o.nc;P.scheduleType=y.o.st;P.selectedSchedules=x(y.o.items);P.availableSchedules=y.p.items;P.canBeSubscribed=!y.user.nc;P.userType=y.user.ut;P.selectedUsers=y.user.items||[];P.userSubscribeRights=y.user.rgts;}},false);iframe.hideWaitPage();}catch(g){microstrategy.errors.log(g);}};switch(F){case"canBeScheduled":m();return P[F];case"scheduleType":P[F+"Was"]=P[F];return P[F];case"availableSchedules":return P[F];case"selectedSchedules":P[F+"Was"]=P[F];return f(P[F]||"");case"canBeSubscribed":m();return P[F];case"userType":P[F+"Was"]=P[F];return P[F];case"selectedUsers":return P[F];case"userSubscribeRights":return P[F];case"rwCurrentViewMode":return P.currentRWViewMode;case"rulers":return P.rulerOn;case"grid":return P.gridOn;case"divider":return P.dividerOn;case"groupByDssIds":return(typeof (P.groupByDssIds!="undefined"))?P.groupByDssIds:null;case"TabName":return P.currentLayoutName;case"tabMPHF":return P.currentLayoutMPHF;case"zoom":var D=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_FLASH);return mstr.controllers.ZoomFactors.getZoomFactors(microstrategy.zoomType,microstrategy.ZOOM_FACTOR,D);case"docVisualizationModeFlash":return P.visualizationMode==50;case"docVisualizationModeAJAX":return P.visualizationMode==51;case"docVisualizationMode":return P.visualizationMode;case"documentDataSets":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAvailableDatasets());case"datasetObjPanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_DATASET_PANEL);case"relatedReportsPanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_RELATED_RP_PANEL);case"notesPanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_NOTES_PANEL);case"outlinePanel":b=microstrategy.bone("accordion_AccordionTabManagerStyle");return(b&&b.currentTabName==microstrategy.ACCORDION_RW_OUTLINE_PANEL);case"documentAttributes":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAvailableAttributes());case"documentPureAttributes":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getPureAttributes());case"documentAttributesWithDateForm":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAttributesWithDateForms());case"documentMetrics":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAvailableMetrics());case"documentAttributesType":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(P.getAttributesType());case"widthZoomFactor":var p=document.getElementById("page");var U=document.getElementById("rwb_viewer");if(p&&U){var A=0;var W=0;if(p.style.borderLeftWidth&&(p.style.borderLeftWidth.indexOf("pt")>-1)){A+=parseInt(microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,parseInt(p.style.borderLeftWidth)));}if(p.style.borderRightWidth&&(p.style.borderRightWidth.indexOf("pt")>-1)){A+=parseInt(microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,parseInt(p.style.borderRightWidth)));}A+=getObjWidth(document.getElementById("docRszHandler"));if(document.getElementById("vRulerCol")){W=getObjWidth(document.getElementById("vRulerCol"));}var V=mstr.utils.BoxModel.hasScrollbar(U,"y")?SCROLLBAR_SIZE:0;var H=mstr.utils.BoxModel.hasScrollbar(document.documentElement,"y")?SCROLLBAR_SIZE:0;var q=((getObjWidth(U)-A-V-H)/(getObjWidth(p)+W-A)*microstrategy.ZOOM_FACTOR-0.5).toFixed(0);if(q<0){return 1;}return q;}return 0;case"heightZoomFactor":var p=document.getElementById("page");var U=document.getElementById("rwb_viewer");var G=document.getElementById("rwb_ruler_table");if(p&&U){var Z=0;var e=0;if(p.style.borderTopWidth&&(p.style.borderTopWidth.indexOf("pt")>-1)){Z+=parseInt(microstrategy.number.toLocalUnits(mstrNumber.UNIT_PX,microstrategy.number.convertToUSUnits(mstrNumber.UNIT_PT,parseInt(p.style.borderTopWidth),true),true));}if(p.style.borderBottomWidth&&(p.style.borderBottomWidth.indexOf("pt")>-1)){Z+=parseInt(microstrategy.number.toLocalUnits(mstrNumber.UNIT_PX,microstrategy.number.convertToUSUnits(mstrNumber.UNIT_PT,parseInt(p.style.borderBottomWidth),true),true));}if(document.getElementById("hRulerRow")){e=getObjHeight(document.getElementById("hRulerRow"));}var E=0;var B=microstrategy.objectListFind(p,"div","dsec");for(var h=0;h<B.length;h++){var S=B[h].firstChild;var X=(S.style.display=="block"||S.style.display=="");if(S.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_TITLEBAR&&X){E+=getObjHeight(S);}}var q=((getObjHeight(U)-Z-2*SCROLLBAR_SIZE-E)/(getObjHeight(p)+e-E-Z)*microstrategy.ZOOM_FACTOR-0.5).toFixed(0);if(q<0){return 1;}return q;}return 0;case"IVEMode":return microstrategy.DISPLAY_MODE===microstrategy.VIEW_MODE&&P.currentRWViewMode===microstrategy.RW_VIEW_MODE_VIEWANALYSIS;case"designViewMode":case"convertToDoc":return microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;case"publishViewMode":case"staticViewMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_STATIC;case"interactiveViewMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_INTERACTIVE;case"editableMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_EDITABLE;case"flashViewMode":return microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&P.currentRWViewMode==microstrategy.RW_VIEW_MODE_FLASH;case"export":return mstr.controllers.ExportTypes.getExportModes();case"docSelectedVisualization":var d=[];var Q=-1;var I=P.visualizationList;if(P.isVisualization&&I&&I.length>0){for(var h=0;h<I.length;h++){if(I[h].vm==P.visualizationMode){if(P.selectedVisualization==I[h].name){Q=h;}d.push({dssid:I[h].name+"|"+I[h].vm,n:I[h].desc});}}return{items:d,value:I[Q].name+"|"+I[Q].vm};}return{items:[]};case"toggleFlashGrouping":return P.groupingChecked&&P.groupingChecked();case"toggleConditionalFormatting":return P.isFeatureAvailable("rw-check-document-thresholds");case"hasMultipleLayouts":return P.isMultiLayout&&P.BeforeLayoutItems&&P.BeforeLayoutItems.length>1;case"showJoinBehavior":var o=microstrategy.findBone(P.doc.selections.getSelectedGrid());return o&&o.isGrid;case"gridJoinType":var O=microstrategy.findBone(P.doc.selections.getSelectedGrid()),N=[];if(O){var C=O.editorProperties,J=C&&C.outerJoinType,R={alias:microstrategy.descriptors.getDescriptor("13185"),dssId:"allAttrs",jt:J||"dft",n:"allAttrs",ic:"jt-allattrs"},a=O.gridStructureInfo.metricAxis.units,u=C&&C.tmsProps,Y=C&&C.dmsProps;N.push(R);a=a&&mstr.$A.filter(a,{filter:function(g){var y=g.dssId,x;if(u&&u[y]){x=u[y];if(x.isDerived&&!x.afb&&x.isSmart&&!x.isSmartCalInBase){return false;}}return true;}},"filter");var M,T,n={};for(M in a){T=a[M].dssId;N.push({dssId:T,alias:a[M].alias,jt:(u&&u[T]&&u[T].outerJoinType)||"dft",n:"metric",ic:"jt-metric"});n[T]=true;}for(T in Y){var L=Y[T];if(!n[T]&&(!L.isDerived||L.afb||!L.isSmart||L.isSmartCalInBase)){N.push({dssId:T,alias:L.alias,jt:L.outerJoinType||"dft",n:"metric",ic:"jt-metric"});}}}return N;case"candidateAttributes":return P.getPureAttributes();default:return(P&&P.doc&&P.doc.commands)?P.doc.commands.queryState(F,c):null;break;}}catch(k){microstrategy.errors.log(k);return false;}};mstrViewerCommandsImpl.prototype.queryVisible=function(A){try{var C=this.parentBone;switch(A){case"docSelectedVisualization":var B=C.visualizationList;return C.isVisualization&&B&&B.length>1&&C.getAllVisList()&&C.getAllVisList()[C.selectedVisualization].sw!="0";case"docVisualizationModeFlash":return C.visualizationsEnabled&&this.isVisModeEnabled(50);case"docVisualizationModeAJAX":return C.visualizationsEnabled&&this.isVisModeEnabled(51);case"tbLoading":return false;case"openPage":return microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE;}return(C.doc&&C.doc.commands)?C.doc.commands.queryVisible(A):true;}catch(D){microstrategy.errors.log(D);return true;}};mstrViewerCommandsImpl.prototype.isVisModeEnabled=function(B){for(var A in this.parentBone.visualizationList){if(this.parentBone.visualizationList[A].vm==B){return true;}}return false;};mstrViewerCommandsImpl.prototype.execPingServer=function(){if(this.pingServer&&mstr.http.PingServer&&mstr.models.BooleanTaskModel){var A=microstrategy.updateManager;if(A.hasNewChanges()){var B=new mstr.http.PingServer();if(!this.booleanTaskModel){this.booleanTaskModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.booleanTaskModel);this.booleanTaskModel&&this.booleanTaskModel.init&&this.booleanTaskModel.init();this.booleanTaskModel.attachEventListener(this,"set_readyState","pingCallback");}this.booleanTaskModel.execSubmit(B);}if(this.parentBone.keepAlive){window.setTimeout("microstrategy.getViewerBone().commands.exec('ping');",this.parentBone.keepAlive);}return true;}return false;};mstrViewerCommandsImpl.prototype.pingCallback=function(A){try{switch(A.name){case"set_readyState":switch(A.memo.value){case mstr.Enum.Widget.READYSTATE.ERROR:this.pingServer=false;return ;}break;}}catch(B){microstrategy.errors.log(B);}};function mstrViewerCommandsImpl(){this.pingServer=true;return this;}var mstrFormatObject={visibility:["FormattingAppearance","Visible",false,"101,102,105,106,107,52,53,4,8,111"],DisplayStyle:["FormattingAppearance","DisplayStyle",true,"106"],zoom:["RWDocumentProperties","ZoomFactor",false,"all"],borderBottomColor2:["FormattingBorder","Border3DBottomColor",false,"102,106,107,52,53,111,101,8,t,de"],GraphFormat:["FormattingPage","GraphFormat",true,"all"],FormattingNavigation:{Hyperlink:["link",true,"102,106","href"],OpenInNewWindow:["newWin",true,"102,106","nw"],IsHyperlink:["isLink",true,"102,106","isl"]},Autowire:["FormattingLayout","Autowire",true,"all"],textDecoration:["FormattingFont","Underline",false,"52,106,107,111,8,208,t,de,df"],SetBadgeToValueOnField:["FormattingTransactions","SetBadgeToValueOnField",true,"106"],MobileDataView:["Mobile","View",true,"all"],EnableHorizontalSwipeToChange:["FormattingView","EnableHorizontalSwipeToChange",true,"8"],topRightCornerRadius:["FormattingAppearance","TopRightCornerRadius",true,"101,8"],BlackAndWhite:["FormattingPage","BlackAndWhite",true,"all"],EmbedFonts:["FormattingPage","EmbedFonts",true,"all"],InitialSlidingInHeight:["FormattingView","InitialSlidingInHeight",true,"8"],AvailableViewModes:["FormattingPage","AvailableViewModes",true,"all"],FormattingPadding:{TopPadding:["paddingTop",false,"52,106,t,de"],LeftPadding:["paddingLeft",false,"52,106,t,de"],LineSpacing:["lineHeight",false,"106,t"],RightPadding:["paddingRight",false,"52,106,t,de"],BottomPadding:["paddingBottom",false,"52,106,t,de"]},PDFExportDocumentURL:["RWDocumentProperties","PDFExportDocumentURL",true,"all"],fontWeight:["FormattingFont","Bold",false,"52,106,107,111,8,t,de,df"],CalculateDocWidth:["RWDocumentProperties","CalculateDocWidth",true,"all"],titleBarDisplay:["FormattingView","TitleBarDisplay",true,"52,8"],LayoutWidth:["FormattingPage","Width",true,"all"],IPhoneVisualization:["Visualization","IPhoneVisualization",true,"52"],gridExportOverFlow:["FormattingCrosstab","ExportOverflowMode",true,"52"],SelectedVisualization:["Visualization","SelectedVisualization",true,"52"],gradientYOffset:["FormattingPatterns","GradientYOffset",true,"101,106,107,52,53,4,8,9,111,208"],TOCTitleFontItalic:["TableOfContents","TitleFontItalic",true,"all"],PaperType:["FormattingPage","PaperType",false,"all"],InfoWindowPosition:["FormattingView","InfoWindowPosition",true,"8"],SecondaryDataProviders:["FormattingWidget","SecondaryDataProviders",true,"52,111"],FilterDetailsFormat:["FilterDetailsFormatProperties","FilterDetailsFormat",true,"all"],left:["FormattingPosition","Left",false,"101,102,105,106,107,52,53,8,111"],showOnlyInRepeatingCopies:["FormattingAppearance","ShowOnlyInRepeatingCopies",true,"101,102,105,106,107,52,53,8,111"],paddingBottom:["FormattingPadding","BottomPadding",false,"52,106,t,de"],Blur:["FormattingAppearance","Blur",true,"8"],Orientation:["FormattingPage","Orientation",true,"all"],borderTopColor2:["FormattingBorder","Border3DTopColor",false,"102,106,107,52,53,111,101,8,t,de"],isLink:["FormattingNavigation","IsHyperlink",true,"102,106"],FilterDetailsFormatProperties:{FilterDetailsFormat:["FilterDetailsFormat",true,"all"]},gridOverFlow:["FormattingCrosstab","OverflowMode",true,"52"],DisplaySelectorDocked:["FormattingSelector","DisplaySelectorDocked",true,"111"],RSLPath:["FormattingWidget","RSLPath",true,"52,111"],listSeparators:{"2055":";","2064":";","2060":";","2052":",","3082":",","1046":";","1028":",","1036":";","1045":";","1049":";","4108":";","1033":",","1030":";","1031":";","1040":";","1041":",","1042":",","1043":";","1053":";","2057":","},canGrowHorizontal:["FormattingSize","CanGrowHorizontal",true,"4"],fontStyle:["FormattingFont","Italic",false,"52,106,107,111,8,t,de,df"],lockAspectRatio:["FormattingSize","LockAspectRatio",true,"102,106"],FormattingIncrementalFetch:{PreLoadAllPanels:["PSPreLoadAllPanels",true,"8","plp"],MaxRows:["gridIfMaxRows",true,"52","gmr"],RowIFMode:["gridIfRowMode",true,"52","gifmd"],EnableIFOnGrid:["gridIfEnabled",true,"52","gif"]},SupportedOrientations:["FormattingLayout","SupportedOrientations",true,"all"],APhoneVisualization:["Visualization","APhoneVisualization",true,"52"],textAlign2:["FormattingAlignment","Horizontal2",false,"52"],FormattingHTML:{HTMLType:["htmlType",true,"107","htype"],URL:["url",true,"107","hsrc"],HTMLText:["htmlText",true,"107","htxt"]},formatVersion:["FormattingAppearance","FormatVersion",true,"52"],OfflineSubmission:["FormattingSelector","OfflineSubmission",true,"111"],Enable:["FormattingWidget","Enable",true,"52,111"],ViewModeInteractivityLevel:["RWDocumentProperties","ViewModeInteractivityLevel",true,"all"],IPadVisualization:["Visualization","IPadVisualization",true,"52"],topCornersOnly:["FormattingAppearance","TopCornersOnly",true,"101,8"],backgroundColor:["FormattingPatterns","FillColor",false,"101,106,107,52,53,4,8,9,111,208,t,de"],borderLeftStyle:["FormattingBorder","LeftStyle",false,"102,106,107,52,53,111,8,t,de"],UseAsNavBar:["FormattingLayout","UseAsNavBar",true,"8"],ActionForDirectTargetSelectors:["FormattingSelector","ActionForDirectTargetSelectors",true,"111"],ShowFloatingToolbars:["RWDocumentProperties","ShowFloatingToolbars",true,"all"],MarginLeft:["FormattingPage","MarginLeft",true,"all"],TOCTitleFontBold:["TableOfContents","TitleFontBold",true,"all"],height:["FormattingSize","Height",false,"101,102,105,106,107,52,53,4,8,111,4"],PSPreLoadAllPanels:["FormattingIncrementalFetch","PreLoadAllPanels",true,"8"],borderRightColor2:["FormattingBorder","Border3DRightColor",false,"102,106,107,52,53,111,101,8,t,de"],decodeValue:function(A,H){try{if((A in mstrFormatObject)&&mstrFormatObject[A][mstrFormatObject.USE_VALUE]){return H;}var B=function(J,K){if(K!=undefined&&(J==null||J.length==0)){return K+"px";}else{if(J=="auto"||J=="100%"){return J;}else{return(parseFloat(microstrategy.number.toString(J))*microstrategy.DPI_CONVERSION*(microstrategy.ZOOM_FACTOR/100))+"px";}}};var E=function(J,K){if(K!=undefined&&(J==null||J.length==0)){J=K;}return parseFloat(J)*(microstrategy.ZOOM_FACTOR/100)+"pt";};var C=function(K,N){if(K==null||K.length==0){return(N!=undefined)?N:null;}if(K=="-1"){return"transparent";}else{if(K=="-2"){return -2;}else{var J=parseInt(K).toString(16);for(var M=0,L=J.length;M<6-L;M++){J="0"+J;}return"#"+J.substring(4)+J.substring(2,4)+J.substring(0,2);}}};var F={0:"0pt solid",8:"0pt none",3:"1pt dashed",4:"1pt dotted",5:"1.5pt solid",6:"2.5pt double",1:"1pt solid",7:"0.5pt solid"};var G=function(K){K=F[K]||"";if(K==null||K==""){return"";}var J=K.indexOf("pt");return(K.substring(0,J)*(microstrategy.ZOOM_FACTOR/100))+K.substring(J);};H=String(H);var I=H.toLowerCase();switch(A){case"top":return B(I);case"left":return B(I);case"width":return B(I);case"height":return B(I);case"oldWidth":case"oldHeight":case"heightMode":return I;case"widthMode":return I;case"maxHeight":return B(I);case"maxWidth":return B(I);case"TextOverflow":switch(I){case"-1":return"auto";case"0":return"hidden";}case"visibility":switch(I){case"-1":return"visible";case"0":return"hidden";}case"textAlign":switch(I){case"1":return"right";case"2":return"center";case"6":return"justify";default:return"left";}case"textAlign2":switch(I){case"4":return"right";case"3":return"center";case"6":return"justify";default:return"left";}case"verticalAlign":switch(I){case"1":return"middle";case"2":return"bottom";default:return"top";}case"verticalAlign2":switch(I){case"2":return"middle";case"3":return"bottom";default:return"top";}case"whiteSpace":switch(I){case"0":return"nowrap";default:return"normal";}case"fontSize":return E(I);case"color":return C(I,"");case"fontWeight":switch(I){case"-1":return"bold";default:return"normal";}case"fontStyle":switch(I){case"-1":return"italic";default:return"normal";}case"textDecoration":return(I==null||I.length==0||I=="0")?null:"underline";case"textDecoration2":return(I==null||I.length==0||I=="0")?null:"line-through";case"FontHighlightColor":return C(I);case"backgroundColor":return C(I,"");case"backgroundStyle":if(I==null||I.length==0){return null;}else{return(I=="1")?"transparent":"0";}case"gradientColor":return C(I);case"selectionColor":return C(I);case"BackgroundHighlightColor":return C(I);case"borderTopColor2":return C(I);case"borderRightColor2":return C(I);case"borderBottomColor2":return C(I);case"borderLeftColor2":return C(I);case"borderTopColor":return C(I);case"borderRightColor":return C(I);case"borderBottomColor":return C(I);case"borderLeftColor":return C(I);case"borderTopStyle":return G(I);case"borderRightStyle":return G(I);case"borderBottomStyle":return G(I);case"borderLeftStyle":return G(I);case"paddingLeft":return E(I);case"paddingRight":return E(I);case"paddingTop":return E(I);case"paddingBottom":return E(I);case"lineHeight":return(I==null||I.length==0||I=="0"||I=="")?"normal":parseFloat(I)+"in";case"lineStyle":switch(I){case"2":return"dashed";case"3":return"dotted";case"4":return"double";case"0":return"none";default:return"solid";}case"lineColor":return C(I,"");case"lineWeight":return E(I);case"orientation":switch(I){case"1":return"border-left";default:return"border-top";}case"PaperType":switch(I){case"1":return"2A,46.81,66.18";case"2":return"A0,33.11,46.81";case"3":return"A1,23.39,33.11";case"4":return"A2,16.54,23.39";case"5":return"A3,11.69,16.54";case"6":return"A4,8.27,11.69";case"7":return"A5,5.83,8.27";case"8":return"A6,4.13,5.83";case"9":return"A7,2.91,4.13";case"10":return"A8,2.09,2.91";case"11":return"C,17,22";case"12":return"D,22,34";case"13":return"E,34,44";case"14":return"Executive,7.25,10.5";case"15":return"F,28,40";case"16":return"Ledger,11,17";case"17":return"Legal,8.5,14";case"18":return"Letter,8.5,11";case"19":return"Super A3/B,13,19";case"20":return"Folio,8.5,13";default:return"Custom";}case"zoom":return parseFloat(microstrategy.number.toString(I));case"TabColor":return C(I,"");}}catch(D){microstrategy.errors.log(D);return H;}},mct:["FormattingSelector","MetricConditionType",true,"111"],maxWidth:["FormattingSize","MaxWidth",false,"4"],lengthMode:["FormattingSize","LengthMode",true,"105"],PromptUserForPagebyExport:["RWDocumentProperties","PromptUserForPagebyExport",true,"all"],whiteSpace:["FormattingAlignment","TextWrap",false,"52,106,107,t,de"],RemoveMissingUnits:["AnalyticalEngineProperties","RemoveMissingUnits",true,"all"],OfflineOnCube:["RWDocumentProperties","OfflineOnCube",true,"all"],TOCLeftIndent:["TableOfContents","LeftIndent",true,"all"],borderLeftColor:["FormattingBorder","LeftColor",false,"102,106,107,52,53,111,8,t,de"],SmartClientDoc:["RWDocumentProperties","SmartClientDoc",true,"all"],Transition:["FormattingTransitions","Transition",true,"8,52"],Scaling:["FormattingPage","Scaling",true,"all"],borderRightColor:["FormattingBorder","RightColor",false,"102,106,107,52,53,111,8,t,de"],zIndex:["FormattingOrder","ZIndex",true,"101,102,105,106,107,52,53,8,111"],ExpandAllPanels:["FormattingAppearance","ExpandAllPanels",true,"8"],FormattingOrder:{ZIndex:["zIndex",true,"101,102,105,106,107,52,53,8,111"]},FormattingSelector:{IndependentNodeSelector:["IndependentNodeSelector",true,"52"],Orientation:["ctlOrientation",true,"111"],MouseOverAction:["mouseOverAction",true,"111"],TXNSubmitInOrder:["TXNSubmitInOrder",true,"111"],DisplaySelectorDocked:["DisplaySelectorDocked",true,"111"],NoSelectionBehavior:["NoSelectionBehavior",true,"111","nsb"],MinSelectionCount:["MinSelectionCount",true,"111","misc"],Style:["Style",true,"111"],ActionForDirectTargetSelectors:["ActionForDirectTargetSelectors",true,"111","adts"],Multiselect:["Multiselect",true,"52,111"],InformationWindowTarget:["InformationWindowTarget",true,"102,106,111","ifw"],ShowElementCount:["showElementCount",true,"111","sec"],ItemWidthMode:["ItemWidthMode",true,"111"],ExportAsShownOnWeb:["ExportAsShownOnWeb",true,"111","aow"],MaxSelectionCount:["MaxSelectionCount",true,"111","masc"],ShowSummary:["ShowSummary",true,"111"],MetricConditionType:["mct",true,"111"],OfflineSubmission:["OfflineSubmission",true,"111"],SubmitMessage:["SubmitMessage",true,"111"],DisplayText:["DisplayText",true,"111"],SearchOnServer:["SearchOnServer",true,"111","sos"],Include:["Include",true,"111"],DisplayConfirmation:["DisplayConfirmation",true,"111"]},gridShowRH:["FormattingCrosstab","ShowRowHeaders",true,"52"],MaxSelectionCount:["FormattingSelector","MaxSelectionCount",true,"111"],TARGET:4,name:["FormattingAppearance","Name",true,"101,102,105,106,107,52,53,4,8,111"],textAlign:["FormattingAlignment","Horizontal",false,"106,111,107,t,de"],borderLeftColor2:["FormattingBorder","Border3DLeftColor",false,"102,106,107,52,53,111,101,8,t,de"],DisplayConfirmation:["FormattingSelector","DisplayConfirmation",true,"111"],TOCBorderColor:["TableOfContents","BorderColor",true,"all"],TXNSubmitInOrder:["FormattingSelector","TXNSubmitInOrder",true,"111"],NonFlashRender:["FormattingWidget","NonFlashRender",true,"52"],VisualizationList:["Visualization","VisualizationList",true,"52"],TOCFontName:["TableOfContents","FontName",true,"all"],TOCTitleFillColor:["TableOfContents","TitleFillColor",true,"all"],UseAsFilterPanel:["FormattingLayout","UseAsFilterPanel",true,"8"],forceNewPage:["FormattingSection","ForceNewPage",true,"4"],color:["FormattingFont","Color",false,"52,106,107,111,8,t,de,df"],RefreshFrequency:["Mobile","RefreshFrequency",true,"all"],windowState:["FormattingView","WindowState",true,"52,111"],TOCTitleFontColor:["TableOfContents","TitleFontColor",true,"all"],gridArea:["FormattingCrosstab","GridAreaPercent",true,"52"],lineHeight:["FormattingPadding","LineSpacing",false,"106,t"],PROP_SET:0,borderRightStyle:["FormattingBorder","RightStyle",false,"102,106,107,52,53,111,8,t,de"],exportOptions:["FormattingCrosstab","ShowExportOptions",true,"52"],CustomProps:["Visualization","CustomProps",true,"52"],FontHighlightColor:["FormattingFont","HighlightColor",false,"106"],ShowTabLeader:["TableOfContents","ShowTabLeader",true,"all"],autoResizeInDesign:["FormattingSize","AutoResizeInDesign",true,"106"],EnableExport:["Mobile","EnableExport",true,"all"],bottomRightCornerRadius:["FormattingAppearance","BottomRightCornerRadius",true,"101,8"],BeforeLayout:["TableOfContents","BeforeLayout",true,"all"],InformationWindowPlacement:["FormattingView","InformationWindowPlacement",true,"8"],orientation:["FormattingLine","LineOrientation",false,"105"],paddingTop:["FormattingPadding","TopPadding",false,"52,106,t,de"],FormattingFont:{Name:["fontFamily",true,"52,106,107,111,8,t,de,df"],Bold:["fontWeight",false,"52,106,107,111,8,t,de,df"],HighlightColor:["FontHighlightColor",false,"106","fhlc"],Underline:["textDecoration",false,"52,106,107,111,8,208,t,de,df"],Strikeout:["textDecoration2",false,"52,106,107,111,8,208,t,de,df"],Italic:["fontStyle",false,"52,106,107,111,8,t,de,df"],Color:["color",false,"52,106,107,111,8,t,de,df"],Size:["fontSize",false,"52,106,107,111,8,t,de,df"]},Visualization:{APhoneVisualization:["APhoneVisualization",true,"52","aphv"],IncludeMDProperties:["IncludeMDProperties",true,"52"],ATabletVisualization:["ATabletVisualization",true,"52","atv"],IPadVisualization:["IPadVisualization",true,"52","ipadv"],ViewMode:["ViewMode",true,"52"],IPhoneVisualization:["IPhoneVisualization",true,"52","iphv"],FileName:["FileName",true,"52"],VisualizationsEnabled:["VisualizationsEnabled",true,"52"],VisualizationList:["VisualizationList",true,"52"],SelectedVisualization:["SelectedVisualization",true,"52"],VisProps:["VisProps",true,"52"],CustomProps:["CustomProps",true,"52"]},fontSize:["FormattingFont","Size",false,"52,106,107,111,8,t,de,df"],paddingLeft:["FormattingPadding","LeftPadding",false,"52,106,t,de"],showTitleBar:["FormattingView","ShowTitleBar",true,"52,8,111"],BackgroundHighlightColor:["FormattingPatterns","HighlightColor",false,"8,106"],IgnoreInExport:["FormattingAppearance","IgnoreInExport",true,"8"],xTabView:["FormattingUnassigned","xTabView",true,"52"],oldWidth:["FormattingSize","OldWidth",false,"52"],SectionHorizontalOverflow:["FormattingPage","SectionHorizontalOverflow",true,"all"],EnableCopyForGridCell:["Mobile","EnableCopyForGridCell",true,"all"],SelectorBehavior:["RWDocumentProperties","SelectorBehavior",true,"all"],Multiselect:["FormattingSelector","Multiselect",true,"52,111"],ScalePagesTall:["FormattingPage","ScalePagesTall",true,"all"],ShowBookmarks:["FormattingPage","ShowBookmarks",true,"all"],ExportAsShownOnWeb:["FormattingSelector","ExportAsShownOnWeb",true,"111"],ExcelExportDocumentURL:["RWDocumentProperties","ExcelExportDocumentURL",true,"all"],WatermarkFontItalic:["WatermarkProperties","FontItalic",true,"all"],hideIfEmpty:["FormattingSection","HideIfEmpty",true,"4"],src:["FormattingUnassigned","src",true,"102"],FormattingPicture:{PictureAlignment:["pictureAlignment",true,"102"],NormalURL:["NormalURL",true,"106","nmurl"],HighlightURL:["HighlightURL",true,"106","hlurl"],PictureMode:["pictureMode",true,"102"]},ZoomType:["RWDocumentProperties","ZoomType",true,"all"],AnalysisSection:["FormattingAnalysis","AnalysisSection",true,"8,52"],NormalURL:["FormattingPicture","NormalURL",true,"106"],UseAsMasterPanel:["FormattingLayout","UseAsMasterPanel",true,"8"],"VLDB Select":{"MCE Join To Get Data Combination":["RWLevelMCEJoin",true,"all"]},FormattingLayout:{UseAsMasterPanel:["UseAsMasterPanel",true,"8","uamp"],UseAsTableControl:["UseAsTableControl",true,"8","uatc"],UseAsNavBar:["UseAsNavBar",true,"8","uanb"],UseMasterPageHeaderFooter:["TabMPHF",true,"all"],SupportedOrientations:["SupportedOrientations",true,"all"],UseAsFilterPanel:["UseAsFilterPanel",true,"8","uafp"],FitPDFContentHeight:["FitPDFContentHeight",true,"all"],ResetToFirstPanelWhenTargeted:["ResetToFirstPanelWhenTargeted",true,"all","rtfp"],Autowire:["Autowire",true,"all"],NavBarLayout:["NavBarLayout",true,"8","nbl"],UseSegments:["UseSegments",true,"all"],CtlAutoSubmit:["CtlAutoSubmit",true,"8","cas"],TabColor:["TabColor",false,"all"],DisplayPageByBar:["DisplayPageByBar",true,"all"],UseAsInfoWindow:["UseAsInfoWindow",true,"all"],DisplayRePromptIcon:["DisplayRePromptIcon",true,"all"],TableControlDefinition:["TableControlDefinition",true,"8","tcd"]},TARGET_VALUE_STYLE:1,TOCTitleFontStrikeout:["TableOfContents","TitleFontStrikeout",true,"all"],WatermarkFontStrikeout:["WatermarkProperties","FontStrikeout",true,"all"],TableControlDefinition:["FormattingLayout","TableControlDefinition",true,"8"],docked:["FormattingSection","DockSection",true,"dsec"],EditableViewMode:["FormattingPage","EditableViewMode",true,"all"],FormattingSection:{HideIfEmpty:["hideIfEmpty",true,"4","he"],FitExcelRowHeight:["fitExcelRowHeight",true,"4","ferh"],ForceNewPage:["forceNewPage",true,"4","fnp"],RepeatHorizontally:["repeatHorizontally",true,"4","rpth"],KeepSectionTogether:["keepSectionTogether",true,"4","kst"],RepeatSection:["repeatSection",true,"4","rpts"],ShowInHTMLViewMode:["showInHTMLViewMode",true,"4","shvm"],Expanded:["expanded",true,"none"],DockSection:["docked",true,"dsec","docked"]},TOCFontUnderline:["TableOfContents","FontUnderline",true,"all"],DocumentThemeColor:["Mobile","DocumentThemeColor",true,"all"],lineColor:["FormattingLine","LineColor",false,"101,105"],FormattingPage:{PageWidth:["PageWidth",true,"all"],PaperType:["PaperType",false,"all"],EditableViewMode:["EditableViewMode",true,"all"],GraphQualityDPI:["GraphQualityDPI",true,"all"],MarginTop:["MarginTop",true,"all"],DefaultGridStyle:["DefaultGridStyle",true,"all"],GraphFormat:["GraphFormat",true,"all"],ScalePagesTall:["ScalePagesTall",true,"all"],MarginLeft:["MarginLeft",true,"all"],ShowBookmarks:["ShowBookmarks",true,"all"],UsePageWidthAsLayoutWidth:["UsePageWidthAsLayoutWidth",true,"all"],ScalePageHeaderFooter:["ScalePageHeaderFooter",true,"all"],MarginBottom:["MarginBottom",true,"all"],PageHeight:["PageHeight",true,"all"],Width:["LayoutWidth",true,"all"],IncludeBookmarks:["IncludeBookmarks",true,"all"],BlackAndWhite:["BlackAndWhite",true,"all"],Orientation:["Orientation",true,"all"],EmbedFonts:["EmbedFonts",true,"all"],AvailableViewModes:["AvailableViewModes",true,"all"],MarginRight:["MarginRight",true,"all"],PrintHeaderOn:["PrintHeaderOn",true,"all"],UseOneSheetPerLayout:["UseOneSheetPerLayout",true,"all"],UseOneSheetPerGroupElement:["UseOneSheetPerGroupElement",true,"all"],ExpandToFit:["ExpandToFit",true,"all"],ScalePagesWide:["ScalePagesWide",true,"all"],PrintFooterOn:["PrintFooterOn",true,"all"],DefaultViewMode:["DefaultViewMode",true,"all"],ScalePercentage:["ScalePercentage",true,"all"],Scaling:["Scaling",true,"all"],SectionHorizontalOverflow:["SectionHorizontalOverflow",true,"all"]},DisplayText:["FormattingSelector","DisplayText",true,"111"],ShowTabsForSingleLayout:["RWDocumentProperties","ShowTabsForSingleLayout",true,"all"],CopyMode:["FormattingView","CopyMode",true,"106,52"],pictureAlignment:["FormattingPicture","PictureAlignment",true,"102"],DisplayInPartialScreen:["FormattingView","DisplayInPartialScreen",true,"8"],TOCTitleAlignment:["TableOfContents","TitleAlignment",true,"all"],pictureMode:["FormattingPicture","PictureMode",true,"102"],decimalSeparators:{"2055":".","2064":".","2060":",","2052":".","3082":",","1046":",","1028":".","1036":",","1045":",","1049":",","4108":".","1033":".","1030":",","1031":",","1040":",","1041":".","1042":".","1043":",","1053":",","2057":"."},AnalyticalEngineProperties:{TrimEmptySections:["TrimNoSectionData",true,"all"],RemoveNullGroups:["RemoveNullGroups",true,"all"],SingleSourceGrid:["SingleSourceGrid",true,"all"],KeepControlTargetsConsistent:["KeepControlTargetsConsistent",true,"all"],RemoveMissingUnits:["RemoveMissingUnits",true,"all"]},InformationWindowTarget:["FormattingSelector","InformationWindowTarget",true,"102,106,111"],backgroundStyle:["FormattingPatterns","FillStyle",false,"101,106,107,52,53,4,8,9,111,208"],lineWeight:["FormattingLine","LineWeight",false,"101,105"],ExpandToFit:["FormattingPage","ExpandToFit",true,"all"],TOCBorderStyle:["TableOfContents","BorderStyle",true,"all"],maxHeight:["FormattingSize","MaxHeight",false,"4"],IsNavigationDocument:["RWDocumentProperties","IsNavigationDocument",true,"all"],PROP_NAME:1,DatasetObjectsVisible:["FormattingAnalysis","DatasetObjectsVisible",true,"4"],CurrencySymbol:["FormattingNumber","CurrencySymbol",true,"100,106,52,t,de"],borderBottomColor:["FormattingBorder","BottomColor",false,"102,106,107,52,53,111,8,t,de"],ATTR_NAME:3,layoutBarStyle:["RWDocumentProperties","layoutBarStyle",true,"all"],AutoFontSize:["WatermarkProperties","AutoFontSize",true,"all"],ImageScale:["WatermarkProperties","ImageScale",true,"all"],heightMode:["FormattingSize","HeightMode",false,"101,102,105,106,107,52,53,111,8"],MarginTop:["FormattingPage","MarginTop",true,"all"],ExecutionFullScreenMode:["RWDocumentProperties","ExecutionFullScreenMode",true,"all"],FormattingCrosstab:{ShowExportOptions:["exportOptions",true,"52","seo"],ExportOverflowMode:["gridExportOverFlow",true,"52","xovf","2"],ShowRowHeaders:["gridShowRH",true,"52"],GridAreaPercent:["gridArea",true,"52"],ShowColHeaders:["gridShowCH",true,"52"],OverflowMode:["gridOverFlow",true,"52","ovf","2"],Prefetch:["quickSwitch",true,"52"],GridPosition:["gridPosition",true,"52"]},PageHeight:["FormattingPage","PageHeight",true,"all"],Include:["FormattingSelector","Include",true,"111"],CurrencyPosition:["FormattingNumber","CurrencyPosition",true,"100,106,52,t,de"],getAttrNameFromStyle:function(D){try{if(mstrFormatObject[D]){var C=mstrFormatObject[D][mstrFormatObject.PROP_SET];var A=mstrFormatObject[D][mstrFormatObject.PROP_NAME];if(C&&A){return mstrFormatObject[C][A][mstrFormatObject.ATTR_NAME];}}}catch(B){microstrategy.errors.log(err);}return null;},EnableTransition:["FormattingTransitions","Enable",true,"8,52"],NoSelectionBehavior:["FormattingSelector","NoSelectionBehavior",true,"111"],FormattingView:{DisplayInPartialScreen:["DisplayInPartialScreen",true,"8","dips"],TitleBarDisplay:["titleBarDisplay",true,"52,8","tbd"],ShowTitleBar:["showTitleBar",true,"52,8,111","swt"],InitialSlidingInHeight:["InitialSlidingInHeight",true,"8","isih"],InfoWindowPosition:["InfoWindowPosition",true,"8","iwp"],Title:["windowTitle",true,"52,8,9,111","wt"],WindowState:["windowState",true,"52,111","ws"],StyleForSwitchingPanel:["StyleForSwitchingPanel",true,"8","sfwp"],InitialSlidingInWidth:["InitialSlidingInWidth",true,"8","isiw"],InfoWindowMode:["InfoWindowMode",true,"8","iwm"],TabCloseToDismissInfoWindow:["TabCloseToDismissInfoWindow",true,"8","tctdiw"],UseAsInformationWindow:["UseAsInformationWindow",true,"8","uaiw"],EnableHorizontalSwipeToChange:["EnableHorizontalSwipeToChange",true,"8","ehstc"],ShowWidgetTitleBar:["ShowWidgetTitleBar",true,"52","swwt"],ShowAsCollapsiblePanel:["ShowAsCollapsiblePanel",true,"8","sacp"],CopyMode:["CopyMode",true,"106,52","mcm"],InformationWindowPlacement:["InformationWindowPlacement",true,"8","iwpl"]},FormattingUnassigned:{xTabView:["xTabView",true,"52","xTabView"],src:["src",true,"102","src"]},ShowChangeIndication:["FormattingTransactions","",true,"51,52"],enableGraphTooltips:["RWDocumentProperties","enableGraphTooltips",true,"all"],WatermarkFontSize:["WatermarkProperties","FontSize",true,"all"],UseAsInformationWindow:["FormattingView","UseAsInformationWindow",true,"8"],keepSectionTogether:["FormattingSection","KeepSectionTogether",true,"4"],Format:["FormattingNumber","Format",true,"100,106,52,t,de"],FormattingWidget:{WidgetProps:["WidgetProps",true,"52,111","wp"],SecondaryDataProviders:["SecondaryDataProviders",true,"52,111"],Enable:["Enable",true,"52,111"],RSLPath:["RSLPath",true,"52,111"],NonFlashRender:["NonFlashRender",true,"52","nfr","2"],ClassName:["ClassName",true,"52,111","twc","2"],IsApp:["IsApp",true,"52,111"],DhtmlRenderer:["DhtmlRenderer",true,"52","dr","2"]},DefaultGridStyle:["FormattingPage","DefaultGridStyle",true,"all"],getDecimalSeparator:function(B){try{return mstrFormatObject.decimalSeparators[B];}catch(A){microstrategy.errors.log(A);return".";}},TOCTitleFontUnderline:["TableOfContents","TitleFontUnderline",true,"all"],RepeatPanelSpacing:["FormattingAppearance","RepeatPanelSpacing",true,"8"],MarginBottom:["FormattingPage","MarginBottom",true,"all"],getPropertySetName:function(A){return mstrFormatObject[A][mstrFormatObject.PROP_SET];},DropZonesVisible:["FormattingAnalysis","DropZonesVisible",true,"8"],FormattingAlignment:{TextDirection:["TextDirection",true,"52,106,107,t,de","td","3"],Vertical2:["verticalAlign2",false,"52","vta2","3"],Vertical:["verticalAlign",false,"52,106,107,111,t,de","vta","3"],Horizontal2:["textAlign2",false,"52"],Horizontal:["textAlign",false,"106,111,107,t,de"],TextWrap:["whiteSpace",false,"52,106,107,t,de"]},TrimNoSectionData:["AnalyticalEngineProperties","TrimEmptySections",true,"all"],expanded:["FormattingSection","Expanded",true,"none"],ResetToFirstPanelWhenTargeted:["FormattingLayout","ResetToFirstPanelWhenTargeted",true,"all"],Collapsed:["FormattingAnalysis","Collapsed",true,"111"],DefaultPageByExportMode:["RWDocumentProperties","DefaultPageByExportMode",true,"all"],ExportRange:["RWDocumentProperties","ExportRange",true,"all"],topLeftCornerRadius:["FormattingAppearance","TopLeftCornerRadius",true,"101,8"],FormattingAppearance:{Transparency:["Transparency",true,"8","trpr"],Blur:["Blur",true,"8","blur"],TopCornersOnly:["topCornersOnly",true,"101,8","tco"],ExpandAllPanels:["ExpandAllPanels",true,"8","ep"],Visible:["visibility",false,"101,102,105,106,107,52,53,4,8,111","visible"],FormatVersion:["formatVersion",true,"52","fmtv"],DisplayStyle:["DisplayStyle",true,"106","dpst"],BottomRightCornerRadius:["bottomRightCornerRadius",true,"101,8","brcr"],ShowOnlyInRepeatingCopies:["showOnlyInRepeatingCopies",true,"101,102,105,106,107,52,53,8,111","sirc"],Name:["name",true,"101,102,105,106,107,52,53,4,8,111","nm"],IgnoreInExport:["IgnoreInExport",true,"8","cone"],DropShadowDepth:["dropShadowDepth",true,"101,102,105,106,107,53,8,111,52","dsw","3"],HasRoundedCorners:["hasRoundedCorners",true,"101,8","rc"],RepeatPanelSpacing:["RepeatPanelSpacing",true,"8","povfs"],Radius:["radius",true,"101,8","rd"],TooltipText:["title",true,"101,102,105,106,107,52,53,8,111","title"],TopRightCornerRadius:["topRightCornerRadius",true,"101,8","trcr"],BottomLeftCornerRadius:["bottomLeftCornerRadius",true,"101,8","blcr"],TopLeftCornerRadius:["topLeftCornerRadius",true,"101,8","tlcr"],DropShadowEffect:["dropShadowEffect",true,"101,102,105,106,107,53,8,111,52","dse","3"],SplitPanelAcrossPages:["SplitPanelAcrossPages",true,"8","spcp"]},ATabletVisualization:["Visualization","ATabletVisualization",true,"52"],FormattingSize:{MaxWidth:["maxWidth",false,"4","mw"],TextOverflow:["TextOverflow",false,"106,8","tovf"],AutoResizeInDesign:["autoResizeInDesign",true,"106","ard"],CanShrinkHorizontal:["canShrinkHorizontal",true,"4","csh"],CanShrink:["canShrink",true,"4","cs"],CanGrowHorizontal:["canGrowHorizontal",true,"4","cgh"],OldHeight:["oldHeight",false,"52","oldht","3"],Height:["height",false,"101,102,105,106,107,52,53,4,8,111,4","ht","3"],LockAspectRatio:["lockAspectRatio",true,"102,106"],LengthMode:["lengthMode",true,"105"],HeightMode:["heightMode",false,"101,102,105,106,107,52,53,111,8","hm"],MaxHeight:["maxHeight",false,"4","mh"],Length:["length",true,"105","cs"],Width:["width",false,"101,102,105,106,107,52,53,8,111,4","wd","3"],OldWidth:["oldWidth",false,"52","oldwd","3"],WidthMode:["widthMode",false,"101,102,105,106,107,52,53,8,111","wm"],CanGrow:["canGrow",true,"4","cg"]},lineStyle:["FormattingLine","LineStyle",false,"101,105"],getThousandsSeparator:function(B){try{return mstrFormatObject.thousandsSeparators[B];}catch(A){microstrategy.errors.log(A);return",";}},selectionStyle:["FormattingPatterns","SelectorSelectionFillStyle",true,"52,111"],FormattingGroup:{UseOneSheetPerPage:["UseOneSheetPerPage",true,"all"]},verticalAlign:["FormattingAlignment","Vertical",false,"52,106,107,111,t,de"],UsePageWidthAsLayoutWidth:["FormattingPage","UsePageWidthAsLayoutWidth",true,"all"],RWLevelMCEJoin:["VLDB Select","MCE Join To Get Data Combination",true,"all"],EnableSwipingToSwitchLayout:["Mobile","EnableSwipingToSwitchLayout",true,"all"],CtlAutoSubmit:["FormattingLayout","CtlAutoSubmit",true,"8"],fontFamily:["FormattingFont","Name",true,"52,106,107,111,8,t,de,df"],DisplayPageByBar:["FormattingLayout","DisplayPageByBar",true,"all"],PreLoadAllPanels:["RWDocumentProperties","PreLoadAllPanels",true,"all"],WatermarkFontBold:["WatermarkProperties","FontBold",true,"all"],layoutBarPosition:["RWDocumentProperties","layoutBarPosition",true,"all"],gridIfMaxRows:["FormattingIncrementalFetch","MaxRows",true,"52"],selectionColor:["FormattingPatterns","SelectorSelectionColor",false,"52,111"],Title:["TableOfContents","Title",true,"all"],paddingRight:["FormattingPadding","RightPadding",false,"52,106,t,de"],DropZonesWidth:["FormattingAnalysis","DropZonesWidth",true,"8"],FilterMode:["FormattingAnalysis","FilterMode",true,"8"],dropShadowDepth:["FormattingAppearance","DropShadowDepth",true,"101,102,105,106,107,53,8,111,52"],gridIfRowMode:["FormattingIncrementalFetch","RowIFMode",true,"52"],APPLIES_TO:3,borderBottomStyle:["FormattingBorder","BottomStyle",false,"102,106,107,52,53,111,8,t,de"],TextOverflow:["FormattingSize","TextOverflow",false,"106,8"],htmlType:["FormattingHTML","HTMLType",true,"107"],verticalAlign2:["FormattingAlignment","Vertical2",false,"52"],GraphQualityDPI:["FormattingPage","GraphQualityDPI",true,"all"],MinSelectionCount:["FormattingSelector","MinSelectionCount",true,"111"],FormattingPatterns:{SelectorSelectionColor:["selectionColor",false,"52,111","ssc"],GradientColor:["gradientColor",false,"101,106,107,52,53,4,8,9,111,208"],GradientXOffset:["gradientXOffset",true,"101,106,107,52,53,4,8,9,111,208"],FillColor:["backgroundColor",false,"101,106,107,52,53,4,8,9,111,208,t,de"],HighlightColor:["BackgroundHighlightColor",false,"8,106","bhlc"],SelectorSelectionFillStyle:["selectionStyle",true,"52,111","sstyle"],GradientYOffset:["gradientYOffset",true,"101,106,107,52,53,4,8,9,111,208"],GradientAngle:["gradientAngle",true,"101,106,107,52,53,4,8,9,111,208"],FillStyle:["backgroundStyle",false,"101,106,107,52,53,4,8,9,111,208","bgstyle","3"],FillEffect:["FillEffect",true,"106","fe"]},canShrink:["FormattingSize","CanShrink",true,"4"],gridIfEnabled:["FormattingIncrementalFetch","EnableIFOnGrid",true,"52"],WatermarkFontUnderline:["WatermarkProperties","FontUnderline",true,"all"],bottomLeftCornerRadius:["FormattingAppearance","BottomLeftCornerRadius",true,"101,8"],gridPosition:["FormattingCrosstab","GridPosition",true,"52"],EnableBookStylePagebyNavigation:["Mobile","EnableBookStylePagebyNavigation",true,"all"],ShowAsCollapsiblePanel:["FormattingView","ShowAsCollapsiblePanel",true,"8"],VisProps:["Visualization","VisProps",true,"52"],NegativeNumbers:["FormattingNumber","NegativeNumbers",true,"100,106,52,t,de"],TOCTitleFontName:["TableOfContents","TitleFontName",true,"all"],quickSwitch:["FormattingCrosstab","Prefetch",true,"52"],ViewMode:["Visualization","ViewMode",true,"52"],width:["FormattingSize","Width",false,"101,102,105,106,107,52,53,8,111,4"],showInHTMLViewMode:["FormattingSection","ShowInHTMLViewMode",true,"4"],MarginRight:["FormattingPage","MarginRight",true,"all"],TARGET_VALUE_ATTR:2,USE_VALUE:2,url:["FormattingHTML","URL",true,"107"],FitPDFContentHeight:["FormattingLayout","FitPDFContentHeight",true,"all"],ExcelGraphFormat:["RWDocumentProperties","ExcelGraphFormat",true,"all"],WatermarkProperties:{FontColor:["WatermarkFontColor",true,"all"],FontName:["WatermarkFontName",true,"all"],AutoFontSize:["AutoFontSize",true,"all"],ImageScale:["ImageScale",true,"all"],FontScript:["WatermarkFontScript",true,"all"],FontBold:["WatermarkFontBold",true,"all"],FontSize:["WatermarkFontSize",true,"all"],TextOrientation:["TextOrientation",true,"all"],ImageSource:["ImageSource",true,"all"],FontItalic:["WatermarkFontItalic",true,"all"],Text:["Text",true,"all"],WatermarkType:["WatermarkType",true,"all"],FontStrikeout:["WatermarkFontStrikeout",true,"all"],FontUnderline:["WatermarkFontUnderline",true,"all"],TextWashout:["TextWashout",true,"all"]},b3dstyle:["FormattingBorder","Border3DStyle",true,"102,106,107,52,53,111,112,101,8,t,de"],TabCloseToDismissInfoWindow:["FormattingView","TabCloseToDismissInfoWindow",true,"8"],PrintFooterOn:["FormattingPage","PrintFooterOn",true,"all"],ScalePercentage:["FormattingPage","ScalePercentage",true,"all"],Enabled:["TableOfContents","Enabled",true,"all"],thousandsSeparators:{"2055":"'","2064":"'","2060":".","2052":",","3082":".","1046":".","1028":",","1036":" ","1045":" ","1049":" ","4108":"'","1033":",","1030":".","1031":".","1040":".","1041":",","1042":",","1043":".","1053":" ","2057":","},ShowHiddenObjects:["RWDocumentProperties","ShowHiddenObjects",true,"all"],canGrow:["FormattingSize","CanGrow",true,"4"],RemoveNullGroups:["AnalyticalEngineProperties","RemoveNullGroups",true,"all"],RWDocumentProperties:{ShowHiddenObjects:["ShowHiddenObjects",true,"all"],layoutBarStyle:["layoutBarStyle",true,"all"],EmbeddedFonts:["EmbeddedFonts",true,"all"],ZoomFactor:["zoom",false,"all"],SelectorBehavior:["SelectorBehavior",true,"all"],ShowFloatingToolbars:["ShowFloatingToolbars",true,"all"],ApplyGBToAllLayouts:["ApplyGBToAllLayouts",true,"all"],ShowingBarsTemporarily:["ShowingBarsTemporarily",true,"all"],ExcelExportDocumentURL:["ExcelExportDocumentURL",true,"all"],ExecutionFullScreenMode:["ExecutionFullScreenMode",true,"all"],CtlAutoSubmit:["CtlAutoSubmit",true,"all"],ShowTabsForSingleLayout:["ShowTabsForSingleLayout",true,"all"],ZoomType:["ZoomType",true,"all"],PromptUserForPagebyExport:["PromptUserForPagebyExport",true,"all"],PreLoadAllPanels:["PreLoadAllPanels",true,"all"],ExcelEmbedImages:["ExcelEmbedImages",true,"all"],PreserveTranslations:["PreserveTranslations",true,"all"],OfflineOnCube:["OfflineOnCube",true,"all"],layoutBarPosition:["layoutBarPosition",true,"all"],DocumentVersion:["DocumentVersion",true,"all"],PDFExportDocumentURL:["PDFExportDocumentURL",true,"all"],CalculateDocWidth:["CalculateDocWidth",true,"all"],ExcelGraphFormat:["ExcelGraphFormat",true,"all"],enableGraphTooltips:["enableGraphTooltips",true,"all"],SmartClientDoc:["SmartClientDoc",true,"all"],ViewModeInteractivityLevel:["ViewModeInteractivityLevel",true,"all"],IsNavigationDocument:["IsNavigationDocument",true,"all"],DefaultPageByExportMode:["DefaultPageByExportMode",true,"all"],ExportRange:["ExportRange",true,"all"]},TOCFontBold:["TableOfContents","FontBold",true,"all"],TextDirection:["FormattingAlignment","TextDirection",true,"52,106,107,t,de"],WatermarkFontName:["WatermarkProperties","FontName",true,"all"],getPropertyName:function(A){return mstrFormatObject[A][mstrFormatObject.PROP_NAME];},windowTitle:["FormattingView","Title",true,"52,8,9,111"],Duration:["FormattingTransitions","Duration",true,"8,52"],top:["FormattingPosition","Top",false,"101,102,105,106,107,52,53,8,111"],EnableCopyForText:["Mobile","EnableCopyForText",true,"all"],WidgetProps:["FormattingWidget","WidgetProps",true,"52,111"],HTML_PROP_NAME:0,TOCFontSize:["TableOfContents","FontSize",true,"all"],Category:["FormattingNumber","Category",true,"100,106,52,t,de"],ShowSummary:["FormattingSelector","ShowSummary",true,"111"],SubmitMessage:["FormattingSelector","SubmitMessage",true,"111"],TOCFontStrikeout:["TableOfContents","FontStrikeout",true,"all"],InfoWindowMode:["FormattingView","InfoWindowMode",true,"8"],showElementCount:["FormattingSelector","ShowElementCount",true,"111"],FileName:["Visualization","FileName",true,"52"],ScalePagesWide:["FormattingPage","ScalePagesWide",true,"all"],getPxFromPt:function(A){return parseFloat(A)*(microstrategy.DPI_CONVERSION/72);},UseAsInfoWindow:["FormattingLayout","UseAsInfoWindow",true,"all"],WatermarkFontColor:["WatermarkProperties","FontColor",true,"all"],oldHeight:["FormattingSize","OldHeight",false,"52"],DisplayRePromptIcon:["FormattingLayout","DisplayRePromptIcon",true,"all"],WatermarkFontScript:["WatermarkProperties","FontScript",true,"all"],gradientColor:["FormattingPatterns","GradientColor",false,"101,106,107,52,53,4,8,9,111,208"],mouseOverAction:["FormattingSelector","MouseOverAction",true,"111"],canShrinkHorizontal:["FormattingSize","CanShrinkHorizontal",true,"4"],htmlText:["FormattingHTML","HTMLText",true,"107"],ClassName:["FormattingWidget","ClassName",true,"52,111"],gradientAngle:["FormattingPatterns","GradientAngle",true,"101,106,107,52,53,4,8,9,111,208"],IndependentNodeSelector:["FormattingSelector","IndependentNodeSelector",true,"52"],HTML_USE_VALUE:1,IsApp:["FormattingWidget","IsApp",true,"52,111"],DhtmlRenderer:["FormattingWidget","DhtmlRenderer",true,"52"],encodeValue:function(A,H){try{if((A in mstrFormatObject)&&mstrFormatObject[A][mstrFormatObject.USE_VALUE]){return H;}var B=function(J,K){if(K!=undefined&&(J==null||J.length==0)){return parseInt(K,10);}else{if(J=="auto"||J=="100%"){return J;}else{return microstrategy.number.toLocaleString(parseFloat(I)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100));}}};var F=function(J,K){if(K!=undefined&&(J==null||J.length==0)){J=K;}return parseFloat(microstrategy.number.toString(J,false))/(microstrategy.ZOOM_FACTOR/100);};var C=function(J,K){if(K!=undefined&&(J==null||J.length==0||J=="undefined")){J=K;}if(J=="transparent"){return -1;}else{if(J==-2){return -2;}else{return parseInt(J.substring(5)+J.substring(3,5)+J.substring(1,3),16);}}};var D=function(J,K){return(J!=null&&J.indexOf(K)>-1)?"-1":"0";};var G=function(K){K=K||"";if(K!=""){var J=K.indexOf("pt");K=((K.substring(0,J)/(microstrategy.ZOOM_FACTOR/100))+"").substring(0,Math.min(J,3))+K.substring(J);}switch(K){case"0pt solid":return"0";case"0pt none":return"8";case"1pt dashed":return"3";case"1pt dotted":return"4";case"1.5pt solid":return"5";case"2.5pt double":return"6";case"1pt solid":return"1";case"0.5pt solid":return"7";default:return"-1";}};H=String(H);var I=H.toLowerCase();switch(A){case"top":return B(I);case"left":return B(I);case"width":return B(I);case"height":return B(I);case"oldWidth":case"oldHeight":case"heightMode":return I;case"widthMode":return I;case"maxHeight":return B(I);case"maxWidth":return B(I);case"TextOverflow":switch(I){case"auto":return"-1";case"hidden":return"0";}case"visibility":switch(I){case"visible":return"-1";case"hidden":return"0";}case"textAlign":switch(I){case"right":return"1";case"center":return"2";case"justify":return"6";default:return"0";}case"textAlign2":switch(I){case"right":return"4";case"center":return"3";case"justify":return"6";default:return"2";}case"verticalAlign":switch(I){case"middle":return"1";case"bottom":return"2";default:return"0";}case"verticalAlign2":switch(I){case"middle":return"2";case"bottom":return"3";default:return"1";}case"whiteSpace":switch(I){case"nowrap":return"0";default:return"-1";}case"fontSize":return F(I);case"color":return C(I,"#000000");case"fontWeight":switch(I){case"bold":return"-1";default:return"0";}case"fontStyle":switch(I){case"italic":return"-1";default:return"0";}case"textDecoration":return D(I,"underline");case"textDecoration2":return D(I,"line-through");case"FontHighlightColor":return C(I,"#000000");case"backgroundColor":if(I&&I.indexOf(",")>0){I="#"+I.split(",")[0];}return C(I,"#FFFFFF");case"backgroundStyle":if(I&&I.indexOf(",")>0){return"2";}if(I=="gradient"){return"2";}if(I=="transparent"){return"1";}else{return"0";}case"gradientColor":if(I&&I.indexOf(",")>0){I="#"+I.split(",")[1];}return C(I,"#000000");case"selectionColor":return C(I,"#000000");case"BackgroundHighlightColor":return C(I,"#000000");case"borderTopColor2":return C(I,"#000000");case"borderRightColor2":return C(I,"#000000");case"borderBottomColor2":return C(I,"#000000");case"borderLeftColor2":return C(I,"#000000");case"borderTopColor":return C(I,"#000000");case"borderRightColor":return C(I,"#000000");case"borderBottomColor":return C(I,"#000000");case"borderLeftColor":return C(I,"#000000");case"borderTopStyle":return G(I);case"borderRightStyle":return G(I);case"borderBottomStyle":return G(I);case"borderLeftStyle":return G(I);case"paddingLeft":return F(I);case"paddingRight":return F(I);case"paddingTop":return F(I);case"paddingBottom":return F(I);case"lineHeight":return(I==null||I=="0"||I=="normal"||I=="")?"":parseFloat(I);case"lineStyle":switch(I){case"dashed":return"2";case"dotted":return"3";case"double":return"4";case"none":return"0";default:return"1";}case"lineColor":return C(I,"#000000");case"lineWeight":return F(I);case"orientation":switch(I){case"border-left":return"1";default:return"0";}case"PaperType":switch(I){case"2a,46.81,66.18":return"1";case"a0,33.11,46.81":return"2";case"a1,23.39,33.11":return"3";case"a2,16.54,23.39":return"4";case"a3,11.69,16.54":return"5";case"a4,8.27,11.69":return"6";case"a5,5.83,8.27":return"7";case"a6,4.13,5.83":return"8";case"a7,2.91,4.13":return"9";case"a8,2.09,2.91":return"10";case"c,17,22":return"11";case"d,22,34":return"12";case"e,34,44":return"13";case"executive,7.25,10.5":return"14";case"f,28,40":return"15";case"ledger,11,17":return"16";case"legal,8.5,14":return"17";case"letter,8.5,11":return"18";case"super a3/b,13,19":return"19";case"folio,8.5,13":return"20";default:return"0";}case"zoom":return microstrategy.number.toLocaleString(parseFloat(I));case"TabColor":return C(I,"#ffffff");case"colWidth":return Math.round(parseInt(I)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100)*microstrategy.BASE_DPI);}}catch(E){microstrategy.errors.log(E);return H;}},TableOfContents:{TitleFontItalic:["TOCTitleFontItalic",true,"all"],Enabled:["Enabled",true,"all"],FontColor:["TOCFontColor",true,"all"],TitleAlignment:["TOCTitleAlignment",true,"all"],TitleFontBold:["TOCTitleFontBold",true,"all"],BorderWeight:["TOCBorderWeight",true,"all"],TitleFontStrikeout:["TOCTitleFontStrikeout",true,"all"],UserSeparateStyleForTitle:["TOCTitleEnableInherit",true,"all"],FontSize:["TOCFontSize",true,"all"],RightIndent:["TOCRightIndent",true,"all"],FontItalic:["TOCFontItalic",true,"all"],TitleFontUnderline:["TOCTitleFontUnderline",true,"all"],ShowTabLeader:["ShowTabLeader",true,"all"],FillColor:["TOCFillColor",true,"all"],BeforeLayout:["BeforeLayout",true,"all"],LeftIndent:["TOCLeftIndent",true,"all"],TitleFontSize:["TOCTitleFontSize",true,"all"],FontName:["TOCFontName",true,"all"],TitleFontColor:["TOCTitleFontColor",true,"all"],BorderStyle:["TOCBorderStyle",true,"all"],TitleFillStyle:["TOCTitleFillStyle",true,"all"],FontBold:["TOCFontBold",true,"all"],FillStyle:["TOCFillStyle",true,"all"],Title:["Title",true,"all"],IncludePageHeaderFooter:["IncludePageHeaderFooter",true,"all"],BorderColor:["TOCBorderColor",true,"all"],TitleFillColor:["TOCTitleFillColor",true,"all"],FontUnderline:["TOCFontUnderline",true,"all"],FontStrikeout:["TOCFontStrikeout",true,"all"],TitleFontName:["TOCTitleFontName",true,"all"]},UseOneSheetPerGroupElement:["FormattingPage","UseOneSheetPerGroupElement",true,"all"],DecimalPlaces:["FormattingNumber","DecimalPlaces",true,"100,106,52,t,de"],radius:["FormattingAppearance","Radius",true,"101,8"],locked:["FormattingPosition","Locked",true,"101,102,105,106,107,52,53,8,111"],SplitPanelAcrossPages:["FormattingAppearance","SplitPanelAcrossPages",true,"8"],ctlOrientation:["FormattingSelector","Orientation",true,"111"],link:["FormattingNavigation","Hyperlink",true,"102,106"],FormattingNumber:{ThousandSeparator:["ThousandSeparator",true,"100,106,52,t,de","nth","2"],Category:["Category",true,"100,106,52,t,de","nct","2"],Format:["Format",true,"100,106,52,t,de","nfs","2"],DecimalPlaces:["DecimalPlaces",true,"100,106,52,t,de","ndp","2"],CurrencyPosition:["CurrencyPosition",true,"100,106,52,t,de","ncp","2"],CurrencySymbol:["CurrencySymbol",true,"100,106,52,t,de","ncs","2"],NegativeNumbers:["NegativeNumbers",true,"100,106,52,t,de","nnn","2"]},UseOneSheetPerPage:["FormattingGroup","UseOneSheetPerPage",true,"all"],repeatHorizontally:["FormattingSection","RepeatHorizontally",true,"4"],title:["FormattingAppearance","TooltipText",true,"101,102,105,106,107,52,53,8,111"],UseSegments:["FormattingLayout","UseSegments",true,"all"],ScalePageHeaderFooter:["FormattingPage","ScalePageHeaderFooter",true,"all"],length:["FormattingSize","Length",true,"105"],EnableZoom:["Mobile","EnableZoom",true,"all"],DatasetsSettings:["FormattingAnalysis","DatasetsSettings",true,"4"],Transparency:["FormattingAppearance","Transparency",true,"8"],TOCRightIndent:["TableOfContents","RightIndent",true,"all"],FormattingPosition:{Top:["top",false,"101,102,105,106,107,52,53,8,111"],Locked:["locked",true,"101,102,105,106,107,52,53,8,111","lck"],Left:["left",false,"101,102,105,106,107,52,53,8,111"]},ExcelEmbedImages:["RWDocumentProperties","ExcelEmbedImages",true,"all"],PreserveTranslations:["RWDocumentProperties","PreserveTranslations",true,"all"],gridShowCH:["FormattingCrosstab","ShowColHeaders",true,"52"],UseAsTableControl:["FormattingLayout","UseAsTableControl",true,"8"],DocumentVersion:["RWDocumentProperties","DocumentVersion",true,"all"],TOCBorderWeight:["TableOfContents","BorderWeight",true,"all"],SearchOnServer:["FormattingSelector","SearchOnServer",true,"111"],DefaultViewMode:["FormattingPage","DefaultViewMode",true,"all"],PageWidth:["FormattingPage","PageWidth",true,"all"],TabMPHF:["FormattingLayout","UseMasterPageHeaderFooter",true,"all"],DatasetObjectsWidth:["FormattingAnalysis","DatasetObjectsWidth",true,"4"],borderTopStyle:["FormattingBorder","TopStyle",false,"102,106,107,52,53,111,8,t,de"],FormattingTransactions:{"":["ShowChangeIndication",true,"51,52"],SetBadgeToValueOnField:["SetBadgeToValueOnField",true,"106"]},EmbeddedFonts:["RWDocumentProperties","EmbeddedFonts",true,"all"],Style:["FormattingSelector","Style",true,"111"],b3dweight:["FormattingBorder","Border3DWeight",true,"102,106,107,52,53,111,112,101,8,t,de"],ApplyGBToAllLayouts:["RWDocumentProperties","ApplyGBToAllLayouts",true,"all"],ItemWidthMode:["FormattingSelector","ItemWidthMode",true,"111"],ShowingBarsTemporarily:["RWDocumentProperties","ShowingBarsTemporarily",true,"all"],NavBarLayout:["FormattingLayout","NavBarLayout",true,"8"],TOCFillColor:["TableOfContents","FillColor",true,"all"],VisualizationsEnabled:["Visualization","VisualizationsEnabled",true,"52"],repeatSection:["FormattingSection","RepeatSection",true,"4"],Mobile:{EnableCopyForGridCell:["EnableCopyForGridCell",true,"all"],EnableCopyForText:["EnableCopyForText",true,"all"],View:["MobileDataView",true,"all"],EnableSwipingToSwitchLayout:["EnableSwipingToSwitchLayout",true,"all"],DocumentThemeColor:["DocumentThemeColor",true,"all"],EnableExport:["EnableExport",true,"all"],RefreshFrequency:["RefreshFrequency",true,"all"],EnableZoom:["EnableZoom",true,"all"],EnableBookStylePagebyNavigation:["EnableBookStylePagebyNavigation",true,"all"]},TabColor:["FormattingLayout","TabColor",false,"all"],FormattingAnalysis:{FilterMode:["FilterMode",true,"8"],DropZonesWidth:["DropZonesWidth",true,"8"],AnalysisSection:["AnalysisSection",true,"8,52"],FilterDisplay:["FilterDisplay",true,"8"],DatasetObjectsWidth:["DatasetObjectsWidth",true,"4"],Collapsed:["Collapsed",true,"111"],DropZonesVisible:["DropZonesVisible",true,"8"],DatasetsSettings:["DatasetsSettings",true,"4"],DatasetObjectsVisible:["DatasetObjectsVisible",true,"4"]},IncludeBookmarks:["FormattingPage","IncludeBookmarks",true,"all"],FillEffect:["FormattingPatterns","FillEffect",true,"106"],IncludeMDProperties:["Visualization","IncludeMDProperties",true,"52"],FilterDisplay:["FormattingAnalysis","FilterDisplay",true,"8"],textDecoration2:["FormattingFont","Strikeout",false,"52,106,107,111,8,208,t,de,df"],dropShadowEffect:["FormattingAppearance","DropShadowEffect",true,"101,102,105,106,107,53,8,111,52"],ImageSource:["WatermarkProperties","ImageSource",true,"all"],IncludePageHeaderFooter:["TableOfContents","IncludePageHeaderFooter",true,"all"],TOCTitleFontSize:["TableOfContents","TitleFontSize",true,"all"],TOCTitleEnableInherit:["TableOfContents","UserSeparateStyleForTitle",true,"all"],fitExcelRowHeight:["FormattingSection","FitExcelRowHeight",true,"4"],ShowWidgetTitleBar:["FormattingView","ShowWidgetTitleBar",true,"52"],FormattingTransitions:{Enable:["EnableTransition",true,"8,52"],Duration:["Duration",true,"8,52","tdr","2"],Transition:["Transition",true,"8,52","ttr","2"]},ThousandSeparator:["FormattingNumber","ThousandSeparator",true,"100,106,52,t,de"],FormattingBorder:{TopColor:["borderTopColor",false,"102,106,107,52,53,111,8,t,de","btc","3"],BottomStyle:["borderBottomStyle",false,"102,106,107,52,53,111,8,t,de","bbs","3"],Border3DWeight:["b3dweight",true,"102,106,107,52,53,111,112,101,8,t,de","b3dweight","3"],TopStyle:["borderTopStyle",false,"102,106,107,52,53,111,8,t,de","bts","3"],LeftColor:["borderLeftColor",false,"102,106,107,52,53,111,8,t,de","blc","3"],BottomColor:["borderBottomColor",false,"102,106,107,52,53,111,8,t,de","bbc","3"],Border3DRightColor:["borderRightColor2",false,"102,106,107,52,53,111,101,8,t,de","b3drc","3"],RightStyle:["borderRightStyle",false,"102,106,107,52,53,111,8,t,de","brs","3"],Border3DLeftColor:["borderLeftColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dlc","3"],Border3DBottomColor:["borderBottomColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dbc","3"],RightColor:["borderRightColor",false,"102,106,107,52,53,111,8,t,de","brc","3"],Border3DTopColor:["borderTopColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dtc","3"],Border3DStyle:["b3dstyle",true,"102,106,107,52,53,111,112,101,8,t,de","b3dstyle","3"],LeftStyle:["borderLeftStyle",false,"102,106,107,52,53,111,8,t,de","bls","3"]},TOCFontColor:["TableOfContents","FontColor",true,"all"],StyleForSwitchingPanel:["FormattingView","StyleForSwitchingPanel",true,"8"],TOCTitleFillStyle:["TableOfContents","TitleFillStyle",true,"all"],newWin:["FormattingNavigation","OpenInNewWindow",true,"102,106"],TOCFillStyle:["TableOfContents","FillStyle",true,"all"],SingleSourceGrid:["AnalyticalEngineProperties","SingleSourceGrid",true,"all"],getListSeparator:function(B){try{return mstrFormatObject.listSeparators[B];}catch(A){microstrategy.errors.log(A);return",";}},gradientXOffset:["FormattingPatterns","GradientXOffset",true,"101,106,107,52,53,4,8,9,111,208"],isTargetStyleOrAttr:function(E){try{var B=mstrFormatObject.TARGET_VALUE_STYLE;if(!mstrFormatObject[E]){return B;}var D=mstrFormatObject.getPropertySetName(E);var A=mstrFormatObject.getPropertyName(E);if(mstrFormatObject.getAttrNameFromStyle(E)==null||mstrFormatObject.getAttrNameFromStyle(E).length==0){return B;}B=mstrFormatObject.TARGET_VALUE_ATTR;if(mstrFormatObject[D][A][mstrFormatObject.TARGET]&&(parseInt(mstrFormatObject[D][A][mstrFormatObject.TARGET])&(parseInt(mstrFormatObject.TARGET_VALUE_STYLE)+parseInt(mstrFormatObject.TARGET_VALUE_ATTR)))>0){B+=mstrFormatObject.TARGET_VALUE_STYLE;}return B;}catch(C){microstrategy.errors.log(err);}return null;},TextWashout:["WatermarkProperties","TextWashout",true,"all"],widthMode:["FormattingSize","WidthMode",false,"101,102,105,106,107,52,53,8,111"],borderTopColor:["FormattingBorder","TopColor",false,"102,106,107,52,53,111,8,t,de"],FormattingLine:{LineStyle:["lineStyle",false,"101,105","ls","3"],LineWeight:["lineWeight",false,"101,105","lw","3"],LineOrientation:["orientation",false,"105","or"],LineColor:["lineColor",false,"101,105","lc","3"]},TextOrientation:["WatermarkProperties","TextOrientation",true,"all"],PrintHeaderOn:["FormattingPage","PrintHeaderOn",true,"all"],KeepControlTargetsConsistent:["AnalyticalEngineProperties","KeepControlTargetsConsistent",true,"all"],UseOneSheetPerLayout:["FormattingPage","UseOneSheetPerLayout",true,"all"],Text:["WatermarkProperties","Text",true,"all"],InitialSlidingInWidth:["FormattingView","InitialSlidingInWidth",true,"8"],WatermarkType:["WatermarkProperties","WatermarkType",true,"all"],TOCFontItalic:["TableOfContents","FontItalic",true,"all"],hasRoundedCorners:["FormattingAppearance","HasRoundedCorners",true,"101,8"],HighlightURL:["FormattingPicture","HighlightURL",true,"106"]};mstrObjectPropsImpl.prototype=new Object();mstrObjectPropsImpl.prototype.parentBone=null;mstrObjectPropsImpl.prototype.defaultFormats=null;mstrObjectPropsImpl.DEFAULT_COPYABLE_ON_SINGLE_CLICK=1;mstrObjectPropsImpl.DEFAULT_COPYABLE_ALWAYS=0;mstrObjectPropsImpl.DEFAULT_COPYABLE_NOT="false";mstrObjectPropsImpl.prototype.onredo=function(B){try{this.pasteFormat(B.elem,B.cachedArray,false);this.parentBone.doc.selections.syncUp();}catch(A){microstrategy.errors.log(A);}return false;};mstrObjectPropsImpl.prototype.onundo=function(D){try{var E=D.cachedArray;var B=false;var J;for(var A in E){var G=microstrategy.styleObj.getCssText(E[A]);var H=document.getElementsByName(A);if(E[A].getAttribute("gradientcolor")!=null){J=(E[A].getAttribute("gradientcolor"))?E[A].getAttribute("gradientcolor").split(","):null;B=(J!=null);}for(var F=0;F<H.length;F++){H[F].style.cssText+=("; "+G);if(B){H[F].setAttribute("gradientcolor",E[A].getAttribute("gradientcolor"));gradientUtil.applyGradient(H[F],J[gradientUtil.GRADIENT_START_COLOR_INDEX],J[gradientUtil.GRADIENT_END_COLOR_INDEX],J[gradientUtil.GRADIENT_ANGLE_INDEX],J[gradientUtil.GRADIENT_XOFFSET_INDEX],J[gradientUtil.GRADIENT_YOFFSET_INDEX]);}else{if(H[F].getAttribute("gradientcolor")){H[F].removeAttribute("gradientcolor");}if(bIsDXIE){var I=microstrategy.styleObj.getFilter(H[F],"Gradient");if(I!=null){I.enabled=false;}}}}}this.parentBone.doc.selections.syncUp();}catch(C){microstrategy.errors.log(C);}return false;};mstrObjectPropsImpl.prototype.applyCtrlDft=function(K,A){try{var B,N=false;var E=microstrategy.getFormatObject();if(A){var G={orgObjs:{}};var L="";for(B in K){G.orgObjs[B]=K[B].cloneNode(true);L+=B+mstrUpdateManager.ITEM_SEPARATOR;}}var D=null;for(B in K){var I=document.getElementsByName(B);var O=K[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)||K[B].getAttribute(microstrategy.HTMLATTR_OBJTYPE);for(var H=0;H<I.length;H++){this.initObjectFormat(I[H],false);if(O==microstrategy.SUBOBJTYPE_DOC_LINE){this.parentBone.doc.fixLineItem(I[H],microstrategy.SUBOBJTYPE_DOC_LINE);}}var C=mstrStaticDoc.getBone(K[B]);if(C&&C.onApplyDefaultFormat){C.onApplyDefaultFormat();}if(K[B].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){D=(I.length&&I.length>0)?I[0]:K[B];}if(O==microstrategy.SUBOBJTYPE_DOC_SHAPE&&K[B].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){if(C){C.synchronizeFormat();}}if(O==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){N=true;}}if(D!=null){var M=microstrategy.findBone(D);if(M!=null){M.resizeRuler(getObjHeight(D));}}if(A){var J=this.parentBone.updateManager;if(L.indexOf(mstrUpdateManager.ITEM_SEPARATOR)!=-1){J.add([J.createActionObject(K,mstrUpdateManager.APPLY_CONTROL_DEFAULT,this.parentBone.beanPath,["2048018","2048076"],[mstrUpdateManager.UPDATE_LATER,L],[],G)]);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&N){J.flushAndSubmitChanges();}}}return true;}catch(F){microstrategy.errors.log(F);return false;}};mstrObjectPropsImpl.prototype.pasteFormat=function(J,Y,m){try{var p=J.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);var K=this.defaultFormats[p];var P;var g;var U=(p==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL?microstrategy.FORMAT_TYPE_CONTROL_TITLE:microstrategy.FORMAT_TYPE_TITLE);var W=[microstrategy.FORMAT_TYPE_MAIN,U];var g;var Q=null;var a=null;var N=function(y,u){var z=mstrStaticDoc.getBone(y),x=null;if(z){if(u==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&z.isTitleVisible){x=z.titleBar;}else{if(u==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&z.isTitleVisible){x=z.titleBars[0];}else{if(u==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&z.titleBarObj){x=z.titleBarObj;}}}}return x;};if(!K){return true;}var S;for(S=0;S<W.length;S++){g=W[S];P=K[g];if(!P){continue;}if(g!=microstrategy.FORMAT_TYPE_MAIN){var D=N(J,p);if(!D){continue;}}var Z;var O=microstrategy.getFormatObject();var d=new Object();if(m){var X=new Object();for(Z in Y){X[Z]=Y[Z].cloneNode(true);}}for(Z in Y){var e=Y[Z].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);var E=(g==microstrategy.FORMAT_TYPE_MAIN?microstrategy.FORMAT_TYPE_MAIN:(e==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL?microstrategy.FORMAT_TYPE_CONTROL_TITLE:microstrategy.FORMAT_TYPE_TITLE));var A=this.defaultFormats[e][E];var I=document.getElementsByName(Z);if(!A){continue;}for(var H in P){var q=P[H];var B=A[H];if(!B){continue;}var L=O[H];for(var M in q){var F=q[M];if(!F.isCopyable){continue;}var C=B[M];if(!C){continue;}var G;if(H=="FormattingBorder"&&M.indexOf("Style")!=-1){G="border"+M.substr(0,M.indexOf("Style"));}else{G=L[M][mstrFormatObject.HTML_PROP_NAME];}d[Z]=Z;var R=false;var k;if(G=="backgroundColor"){a=J;if(g!=microstrategy.FORMAT_TYPE_MAIN){a=N(J,p);}else{if(p==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){Q=microstrategy.findBone(J);if(Q){a=Q.getCurrentPanel().elem;}}}if(a&&a.getAttribute("gradientcolor")!=null){k=(a.getAttribute("gradientcolor"))?a.getAttribute("gradientcolor").split(","):null;R=(k!=null);}else{R=false;}}for(var h=0;h<I.length;h++){var T=I[h];if(g!=microstrategy.FORMAT_TYPE_MAIN){var D=N(T,e);if(!D){continue;}}if(e==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&H=="FormattingPatterns"&&g==microstrategy.FORMAT_TYPE_MAIN){Q=microstrategy.findBone(I[h]);if(Q){T=Q.getCurrentPanel().elem;}}if(e==microstrategy.SUBOBJTYPE_DOC_SHAPE&&H=="FormattingLine"&&M=="LineColor"){var c=microstrategy.styleObj.getValue(J,G);this.parentBone.doc.formatLineSetting([T],"lineColor",c,false,[]);}else{microstrategy.styleObj.setValue(T,G,microstrategy.styleObj.getValue(J,G,g),E);}if(G=="backgroundColor"){if(g!=microstrategy.FORMAT_TYPE_MAIN){T=N(T,e);if(!T){continue;}}if(R){T.setAttribute("gradientcolor",a.getAttribute("gradientcolor"));gradientUtil.applyGradient(T,k[gradientUtil.GRADIENT_START_COLOR_INDEX],k[gradientUtil.GRADIENT_END_COLOR_INDEX],k[gradientUtil.GRADIENT_ANGLE_INDEX],k[gradientUtil.GRADIENT_XOFFSET_INDEX],k[gradientUtil.GRADIENT_YOFFSET_INDEX]);}else{if(T.getAttribute("gradientcolor")){T.removeAttribute("gradientcolor");}if(bIsDXIE){var f=microstrategy.styleObj.getFilter(T,"Gradient");if(f!=null){f.enabled=false;}}}}}}}if(p==e){this.pasteItemFormats(J,Y[Z]);}if(e==microstrategy.SUBOBJTYPE_DOC_SHAPE){for(var h=0;h<I.length;h++){if(I[h].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var o=microstrategy.findBone(I[h]);if(o){o.synchronizeFormat();}}}}}}if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}if(m){d=mstr.utils.Arrays.fromHashValues(d);if(d.length>0){var V=this.parentBone.updateManager;V.add([V.createActionObject(J,mstrUpdateManager.PASTE_FORMATTING,this.parentBone.beanPath,["2048018","2048066"],[mstrUpdateManager.UPDATE_LATER,d.toString()],[],X)]);}}return true;}catch(n){microstrategy.errors.log(n);}return false;};mstrObjectPropsImpl.prototype.pasteItemFormats=function(G,D){try{var F=mstrStaticDoc.getBone(G);if((!F)||(!F.getItemFormats)){return false;}var H=F.getItemFormats();if(!H){return false;}var E=mstrStaticDoc.getBone(D);for(var B in H){for(var A in H[B]){E.setFormatValue(B,H[B][A]);}}}catch(C){microstrategy.errors.log(C);}return false;};mstrObjectPropsImpl.prototype.initObjectFormat=function(M,a,A,m){try{var d=M.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)||M.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var AB=(A!=null)?A:d;var Q=this.defaultFormats[AB];if(!Q){return M;}if(!m){m=microstrategy.FORMAT_TYPE_MAIN;}var AA=Q[m];if(!AA){return M;}var U=microstrategy.getFormatObject();this.clearAllFormat(M);var N=false;var q=new Array();var T=new Array();var O=0;var Y=false;var Z=false;var E=false;var X=null;var L=null;var J=null;var B=null;var c=null;var G=null;var F=null;var n=null;var V;for(var I in AA){if(AB==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&m==microstrategy.FORMAT_TYPE_MAIN){if(d==AB){if(I=="FormattingPatterns"){continue;}}else{if(I!="FormattingPatterns"){continue;}}}var P=AA[I];var R=U[I];for(var S in P){var K=P[S];if((!a)&&(!K.isCopyable)){continue;}var f=K.defaultValue;if((!f&&f!=0)||String(f).length==0){continue;}var C=R[S];if(!C){continue;}var k=C[mstrFormatObject.HTML_PROP_NAME];var H=U.decodeValue(k,f);if(H==null){continue;}if(I=="FormattingPatterns"&&S=="SelectorSelectionColor"){microstrategy.styleObj.setAttValue(M,U.getAttrNameFromStyle(k),H);continue;}if(I=="FormattingPatterns"&&S=="FillColor"){if(P.FillStyle.defaultValue=="1"){H="transparent";M.style.backgroundColor=H;}else{if(P.FillStyle.defaultValue=="2"){Y=true;J=H.slice(1);B=U.decodeValue("gradientColor",P.GradientColor.defaultValue).slice(1);c=P.GradientAngle.defaultValue;G=P.GradientXOffset.defaultValue;F=P.GradientYOffset.defaultValue;H="transparent";}}}if(S=="HighlightColor"){if(I=="FormattingPatterns"||I=="FormattingFont"){microstrategy.styleObj.setAttValue(M,U.getAttrNameFromStyle(k),f);}}if(I=="FormattingAppearance"){if(S=="DropShadowEffect"&&parseInt(H)!=0){Z=true;X=P.DropShadowDepth.defaultValue;}else{if(S=="AlphaEffect"&&parseInt(H)!=0){E=true;L=P.AlphaOpacity.defaultValue;}}}if(I=="FormattingAlignment"){if(S=="TextDirection"&&parseInt(H)!=0&&bIsW3C){n=true;V=H;}}if(I=="FormattingSize"&&(S=="Height"||S=="Width")&&AB!=microstrategy.SUBOBJTYPE_DOC_LINE&&!(AB==microstrategy.SUBOBJTYPE_DOC_SHAPE&&microstrategy.styleObj.getAttValue(M,microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){var y=microstrategy.styleObj.adjustSizes(k,H,AA);M.style[k]=y+"px";microstrategy.styleObj.setAttValue(M,U.getAttrNameFromStyle(k),f);}else{if(C[mstrFormatObject.ATTR_NAME]&&C[mstrFormatObject.ATTR_NAME].length>0){if(C[mstrFormatObject.TARGET]&&(parseInt(C[mstrFormatObject.TARGET])&(parseInt(mstrFormatObject.TARGET_VALUE_STYLE)+parseInt(mstrFormatObject.TARGET_VALUE_ATTR)))>0){M.setAttribute(C[mstrFormatObject.ATTR_NAME],f);if(I=="FormattingBorder"&&S.indexOf("Style")!=-1&&S.indexOf("3D")==-1){k=k.substr(0,k.length-"Style".length);M.style[k]=H+" "+microstrategy.styleObj.getValue(M,k+"Color");}else{if(I=="FormattingLine"&&S.indexOf("Line")!=-1){if(S.indexOf("Weight")!=-1){S="LineWidth";}var D=S.substr("Line".length,S.length-1);var z=null;if(microstrategy.subObjectType(M)==microstrategy.SUBOBJTYPE_DOC_LINE){z=new Array("borderTop","borderLeft");}else{if(microstrategy.subObjectType(M)==microstrategy.SUBOBJTYPE_DOC_SHAPE){z=new Array("borderTop","borderLeft","borderRight","borderBottom");}}for(var p=0;z&&p<z.length;p++){microstrategy.styleObj.setValue(M,z[p]+D,H);}}else{if(I=="FormattingBorder"){microstrategy.styleObj.setValue(M,k,H);if(S=="Border3DStyle"&&f!=0){N=true;}else{if(S=="Border3DWeight"){O=f;}else{if(S.indexOf("Border3D")>-1){q.push(k.substr(0,k.length-1));T.push(H);}}}}else{if(I=="FormattingAppearance"&&S.indexOf("DropShadow")!=-1){microstrategy.styleObj.setValue(M,k,H);}M.style[k]=H;}}}}else{microstrategy.styleObj.setValue(M,k,H);}}else{microstrategy.styleObj.setValue(M,k,H);}}}}if(N){M.style.borderWidth=O+"pt";M.style.borderStyle="solid";for(var e=0;e<T.length;e++){M.style[q[e]]=T[e];}}if(Y){if((M.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&M.getAttribute("scriptclass")!="mstrPanel")||(M.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SHAPE&&M.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){var W=(M.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION)?this.parentBone&&this.parentBone.getChildBone(M):microstrategy.bone(M.id);if(W){if(d==microstrategy.OBJTYPE_DOC_SUBSECTION){W.setSibsWithGradients([M]);var o=new Array();o[gradientUtil.GRADIENT_START_COLOR_INDEX]=J;o[gradientUtil.GRADIENT_END_COLOR_INDEX]=B;o[gradientUtil.GRADIENT_ANGLE_INDEX]=c;o[gradientUtil.GRADIENT_TRANSITION_TYPE_INDEX]=14;o[gradientUtil.GRADIENT_XOFFSET_INDEX]=G;o[gradientUtil.GRADIENT_YOFFSET_INDEX]=F;W.setGradientInfo([M],o);}W.applyGradient();}}else{M.style.backgroundColor="transparent";M.setAttribute("gradientcolor",J+","+B+",14,"+c+","+G+","+F);M.setAttribute("bgstyle","2");gradientUtil.applyGradient(M,J,B,c,G,F,microstrategy.styleObj);}}else{var h=(M.style.backgroundColor=="transparent")?1:0;M.setAttribute("bgstyle",h);if(M.getAttribute("gradientcolor")){M.removeAttribute("gradientcolor");}if(bIsDXIE){var g=this.parentBone.doc.styleObj.getFilter(M,"Gradient");if(g!=null){g.enabled=false;}}}if(Z){M.setAttribute("dropShadowDepth",X);M.setAttribute("dropShadowEffect","1");microstrategy.styleObj.applyShadow(M,"dropShadowEffect","1");}if(E){M.setAttribute("alphaOpacity",L);M.setAttribute("alphaEffect","1");microstrategy.styleObj.applyAlpha(M,"alphaEffect","1");}if(n){this.parentBone.doc.styleObj.applyTextDirection(M,null,V);}if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}}catch(u){microstrategy.errors.log(u);}return M;};mstrObjectPropsImpl.prototype.createFormatObject=function(D,H){try{var L=new Object();var P=this.defaultFormats[D];if(!P){return L;}var K=P[H];if(!K){return L;}var E=microstrategy.getFormatObject();for(var I in K){var N=K[I];var J=E[I];for(var F in N){var B=N[F];var M=B.defaultValue;if((!M)||String(M).length==0){continue;}var O=J[F];if(!O){continue;}var A=O[mstrFormatObject.HTML_PROP_NAME];var C=E.decodeValue(A,M);if(C==null){continue;}if(I=="FormattingPatterns"){if(F=="FillStyle"){continue;}if(F=="FillColor"){if(N.FillStyle.defaultValue=="1"){C="transparent";}}}L[A]=C;}}if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}}catch(G){microstrategy.errors.log(G);}return L;};mstrObjectPropsImpl.prototype.cloneFormats=function(E){try{var D=null;if(E){D=new Object();for(var B in E){D[B]=new Object();for(var A in E[B]){D[B][A]=E[B][A];}}}return D;}catch(C){microstrategy.errors.log(C);}return res;};mstrObjectPropsImpl.prototype.setDefaultFormat=function(N){var T=microstrategy.formatType;try{var K=microstrategy.getFormatObject();var G=N.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)||N.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var J=this.defaultFormats[G];if(!J){return true;}for(var S in J){var B=J[S];microstrategy.formatType=S;var A=null;var V=null;if((G==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||G==microstrategy.SUBOBJTYPE_DOC_TEMPLATE)&&S==mstrPanelStack.FMT_TYPE_TITLE){V=microstrategy.styleObj.getValue(N,"gradientcolor",S);}else{V=N.getAttribute("gradientcolor");}if(V&&V.length>0){A=V.split(",");}for(var L in B){if(G==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&S==microstrategy.FORMAT_TYPE_MAIN){if(L=="FormattingPatterns"){continue;}}var O=B[L];var E=K[L];for(var F in O){var D=O[F];var H=E[F];if(D.isDefaultCopyable==mstrObjectPropsImpl.DEFAULT_COPYABLE_NOT||!H){continue;}var P=H[mstrFormatObject.HTML_PROP_NAME];var U=H[mstrFormatObject.ATTR_NAME];if(L=="FormattingPatterns"&&A!=null){if(F=="FillStyle"){D.defaultValue=2;}else{switch(F){case"FillColor":D.defaultValue=K.encodeValue(P,"#"+A[gradientUtil.GRADIENT_START_COLOR_INDEX]);break;case"GradientColor":D.defaultValue=K.encodeValue("backgroundColor","#"+A[gradientUtil.GRADIENT_END_COLOR_INDEX]);break;case"GradientAngle":D.defaultValue=A[gradientUtil.GRADIENT_ANGLE_INDEX];break;case"GradientXOffset":D.defaultValue=A[gradientUtil.GRADIENT_XOFFSET_INDEX];break;case"GradientYOffset":D.defaultValue=A[gradientUtil.GRADIENT_YOFFSET_INDEX];break;default:break;}}}else{if(G==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&L=="FormattingSize"&&F=="Height"&&microstrategy.styleObj.getAttValue(N,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE&&microstrategy.styleObj.getAttValue(N,microstrategy.HTMLATTR_WINDOW_STATE)!=microstrategy.WINDOW_STATE_NORMAL){D.defaultValue=microstrategy.styleObj.getAttValue(N,microstrategy.HTMLATTR_OLD_HEIGHT,S);}else{if(U&&U.length>0){if(U==microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR){D.defaultValue=K.encodeValue(P,microstrategy.styleObj.getAttValue(N,U,S));}else{D.defaultValue=microstrategy.styleObj.getAttValue(N,U,S);}}else{var Q=microstrategy.styleObj.getValue(N,P,S);if(L=="FormattingBorder"&&F.indexOf("Style")!=-1){var R=P.substr(0,P.length-"Style".length);D.defaultValue=K.encodeValue(P,microstrategy.styleObj.getValue(N,R+"Width")+" "+Q);}else{D.defaultValue=K.encodeValue(P,Q);}}}}}}}var C=mstrStaticDoc.getBone(N);if(C&&C.onSetDefaultFormat){C.onSetDefaultFormat();}var M=this.parentBone.updateManager;M.add([M.createActionObject(N,mstrUpdateManager.SET_CTRL_DEFAULT,this.parentBone.beanPath,["2048018","2048012"],[mstrUpdateManager.UPDATE_LATER,N.getAttribute("id")],[],null)],true);}catch(I){microstrategy.errors.log(I);}finally{microstrategy.formatType=T;}return false;};mstrObjectPropsImpl.prototype.clearAllFormat=function(C){try{if(C){var A=C.style;if(A&&A.textDecoration){A.textDecoration="none";}if(microstrategy.styleObj.objSheet&&microstrategy.styleObj.objSheet.styleRules&&microstrategy.styleObj.objSheet.styleRules[microstrategy.styleObj.getId(C)]){A=microstrategy.styleObj.objSheet.styleRules[microstrategy.styleObj.getId(C)].style;}if(A&&A.textDecoration){A.textDecoration="none";}}}catch(B){microstrategy.errors.log(B);}return false;};mstrObjectPropsImpl.prototype.isCtrlDftObj=function(C){try{if(C){var A=C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(A==microstrategy.SUBOBJTYPE_DOC_TEXT||A==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||A==microstrategy.SUBOBJTYPE_DOC_IMAGE||A==microstrategy.SUBOBJTYPE_DOC_LINE||A==microstrategy.SUBOBJTYPE_DOC_SHAPE||A==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||A==microstrategy.SUBOBJTYPE_DOC_SUBSECTION||A==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||A==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||A==microstrategy.SUBOBJTYPE_DOC_PANEL){return true;}}return false;}catch(B){microstrategy.errors.log(B);}return false;};function mstrObjectPropsImpl(A){this.parentBone=A;this.defaultFormats=this.parentBone.defaultFormats;return this;}microstrategy.HTMLATTR_MASKEDOBJECT="MB";microstrategy.HTMLATTR_MASKFOR="MASKFOR";microstrategy.HTMLATTR_MASKFOR_DELIM=",";mstrMaskImpl.prototype=new mstrBoneImpl();mstrMaskImpl.prototype.elem=null;mstrMaskImpl.prototype.img=null;mstrMaskImpl.prototype.borderWidth=3;mstrMaskImpl.prototype.onload=function(B){try{this.maskedBone=B;this.initElem();this.img.onmouseover=new Function("this.style.borderWidth = '"+this.borderWidth+"px';");this.img.onmouseout=new Function("this.style.borderWidth = '0px';");if(this.maskedBone){this.maskfor=(B.maskFor)?microstrategy.HTMLATTR_MASKFOR_DELIM+this.maskedBone.maskFor+microstrategy.HTMLATTR_MASKFOR_DELIM:"";this.onmaskedobjectresize();}}catch(A){microstrategy.errors.log(A);return false;}};mstrMaskImpl.prototype.onmaskedobjectresize=function(B,A){try{if(this.maskedBone&&this.maskedBone.maskArea){var D=2*this.borderWidth;B=(B>D?B:Math.max(7,getObjHeight(this.maskedBone.maskArea)))-D;A=(A>D?A:Math.max(7,this.maskedBone.maskArea.scrollWidth))-D;this.img.style.height=B+"px";this.img.style.width=A+"px";}}catch(C){microstrategy.errors.log(C);return false;}};mstrMaskImpl.prototype.initElem=function(){try{var C=document.createElement("div");C.className="mstrMask";this.elem=C;var A=document.createElement("img");A.className="mstrMaskedImage";A.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";A.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK);if(this.maskedBone){A.setAttribute(microstrategy.HTMLATTR_MASKEDOBJECT,this.maskedBone.id);A.setAttribute(microstrategy.HTMLATTR_POINTS_TO,this.maskedBone.id);}this.img=A;this.elem.appendChild(this.img);if(this.maskedBone.maskArea.childNodes.length>0){this.maskedBone.maskArea.insertBefore(this.elem,this.maskedBone.maskArea.firstChild);}else{this.maskedBone.maskArea.appendChild(this.elem);}}catch(B){microstrategy.errors.log(B);return false;}};mstrMaskImpl.prototype.toggle=function(A,B){try{if(!this.elem){return ;}this.elem.style.display=(A&&this.maskfor.indexOf(microstrategy.HTMLATTR_MASKFOR_DELIM+B+microstrategy.HTMLATTR_MASKFOR_DELIM)>-1)?"block":"none";}catch(C){microstrategy.errors.log(C);return false;}};function mstrMaskImpl(){return this;}mstrSubSection.prototype=new mstrBoneImpl();mstrSubSection.prototype.maxZindex=1;mstrSubSection.prototype.minZindex=1;mstrSubSection.prototype.path="";mstrSubSection.prototype.type=microstrategy.OBJTYPE_DOC_SUBSECTION;mstrSubSection.prototype.verifiedPath="";mstrSubSection.prototype.isDetails=false;mstrSubSection.prototype.sibs=null;mstrSubSection.prototype.doc=null;mstrSubSection.prototype.needToUpdateMaxContentHeight=true;mstrSubSection.prototype.subsectionType=0;mstrSubSection.prototype.oldHeight=null;mstrSubSection.prototype.gradientInfo=null;mstrSubSection.prototype.sibsWithGradients=null;mstrSubSection.TYPE_FIXED=0;mstrSubSection.TYPE_HORIZ=1;mstrSubSection.TYPE_PANEL=2;mstrSubSection.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.sibs=document.getElementsByName(this.id);var B=microstrategy.getViewerBone();this.minZindex=1;if(B.isInteractiveViewModeEplus()){this.initGuideline();this.calcZIndexAndPositions();}this.doc=B.doc;if(B.gradientsOnSS){this.initGradients();}}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.getGradientInfo=function(){try{if(!this.gradientInfo){this.gradientInfo=[];}return this.gradientInfo;}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.setSibsWithGradients=function(B){try{this.sibsWithGradients=[];if(B){for(i=0;i<B.length;i++){this.sibsWithGradients.push(B[i]);}}}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.setGradientInfo=function(C,A){try{this.gradientInfo=[];if(A){for(i=0;i<C.length;i++){this.gradientInfo.push(A);}}}catch(B){microstrategy.errors.log(B);}};mstrSubSection.prototype.getSibsWithGradients=function(){try{if(!this.sibsWithGradients){this.sibsWithGradients=[];}return this.sibsWithGradients;}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.initGradients=function(){try{for(var A=0;A<this.sibs.length;A++){var B=this.sibs[A].getAttribute("gradientcolor");if(B){this.getGradientInfo().push(B.split(","));this.getSibsWithGradients().push(this.sibs[A]);}}}catch(C){microstrategy.errors.log(C);}};mstrSubSection.prototype.syncPosition=function(){try{this.applyGradient();}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.initGuideline=function(){try{if(microstrategy.getViewerBone().isEditableViewModeEplus()){this.guidelineEnabled=true;this.positionMap=this.positionMap||{};}}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.initPositionMap=function(){try{if(!this.guidelineEnabled||this.positionMapReady){return ;}for(var D=0,A=this.sibs.length;D<A;D++){var F=this.sibs[D];if(F!=null){if(!this.containsDocObject(F)){continue;}for(var C=0,B=F.childNodes.length;C<B;C++){var G=F.childNodes[C];if(G.nodeType==1&&G.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){this.updatePositionMap(G);}}}this.positionMapReady=true;break;}}catch(E){microstrategy.errors.log(E);}};mstrSubSection.prototype.calcZIndexAndPositions=function(){try{var E=1;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;var D=null;for(var B=0;B<this.sibs.length;B++){D=this.sibs[B];if(D!=null){if(!this.containsDocObject(D)){continue;}for(var A=0;A<D.childNodes.length;A++){var G=D.childNodes[A];if(G.nodeType==1){if(G.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var F=parseInt(microstrategy.styleObj.getValue(G,"zIndex"));if(F==0){E++;G.style.zIndex=E;}else{if(F>E){E=F;}}}}}break;}}this.maxZindex=++E;}catch(C){microstrategy.errors.log(C);return false;}};mstrSubSection.prototype.containsDocObject=function(C){for(var B=0,A=C.childNodes.length;B<A;B++){var D=C.childNodes[B];if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){if(document.defaultView&&document.defaultView.getComputedStyle&&document.defaultView.getComputedStyle(D,"").display=="none"){continue;}if(D.currentStyle&&D.currentStyle.display=="none"){continue;}return true;}}return false;};mstrSubSection.prototype.setNeedToUpdateMaxContentHeight=function(A){try{this.needToUpdateMaxContentHeight=A;}catch(B){microstrategy.errors.log(B);}};mstrSubSection.prototype.reduceObjZIndex=function(D,C){try{var E=microstrategy.styleObj.getValue(D,"zIndex");for(var A=0;A<this.elem.childNodes.length;A++){var G=this.elem.childNodes[A];if(G.nodeType==1&&G.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var F=microstrategy.styleObj.getValue(G,"zIndex");if(F>E){F--;C=this.doc.formatItems(microstrategy.createAssociativeArray(G),"zIndex",F,false,C);}}}if(this.maxZindex>1){this.maxZindex--;}return C;}catch(B){microstrategy.errors.log(B);return C;}};mstrSubSection.prototype.ondrop=function(C,A){try{var D=","+A.getDssTypes().toString()+",";if(D.indexOf(","+microstrategy.DSSTYPE_HIERARCHY+",")!=-1){return ;}this.addUnits(C,A,A.shiftKey);}catch(B){microstrategy.errors.log(B);return false;}};mstrSubSection.prototype.addUnits=function(Q,E,R){try{var D=getObjSumLeft(Q);var O=getObjSumTop(Q);var K=Math.max(0,E.dragX);var I=E.dragY;var U=E.parentBone;var M=microstrategy.updateManager;var Y=[];var P=false;var T=(E.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF;var S=E.getItems();if(this.isFilterPanel){showMessage({contents:microstrategy.descriptors.getDescriptor("9512"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return null;}var G=[];var V=[];var N=this.doc.selections;for(var X=0;X<S.length;X++){if(S[X].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_RPT_DEFINITION){G.push(S[X]);}else{V.push(S[X]);}}if(R){if(G.length>0){var H=[];for(var X=0;X<G.length;X++){var B={dataSetID:G[X].getAttribute("id").substring(0,32),shiftKey:false,displayGrid:(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE),dataSetName:G[X].getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME)};Y=this.doc.addCtrl(new Rect(I+O,null,null,K+D),Q,Y,microstrategy.SUBOBJTYPE_DOC_TEMPLATE,null,B,T);if(Y==null){return null;}P=true;if(!P){var L=[];var A=microstrategy.findBone(Q.lastChild);var C=U.selections.getDatasetMembers(G[X]);if(C){var J=colCount=1;for(var W=0;W<C.length;W++){if((C[W].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_METRIC)||(C[W].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_METRIC)||(C[W].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_SUMMARY_METRIC)){A.commands.exec("addTemplateUnit",C[W],microstrategy.GRIDCELL_AXIS_COLUMNS,colCount,L);colCount++;}else{if(C[W].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_ATTRIBUTE_FORM){A.commands.exec("addTemplateUnit",C[W],microstrategy.GRIDCELL_AXIS_ROWS,J,L);J++;}}}}}K=K+getObjWidth(Q.lastChild)+10;H.push(Q.lastChild);}if(H.length>0){N.finishAddAllObjs(H,Y,true);}}else{if(V.length>0){this.addObjsWithFormat(K,I,V,Q,U,T,Y,false);}}}else{if(G.length>0){this.addObjsWithFormat(K,I,G,Q,U,T,Y,false);}else{if(V.length>0){var H=[];for(var X=0;X<V.length;X++){this.doc.addObj(K,I,this,V[X],Y,T);K=K+getObjWidth(Q.lastChild)+10;H.push(Q.lastChild);}if(H.length>0){N.finishAddAllObjs(H,Y,true);}}}}if(Y&&Y.length>0){M.add(Y);if(P){M.flushAndSubmitChanges();}}return Y;}catch(F){microstrategy.errors.log(F);return Y;}};mstrSubSection.prototype.findObjects=function(G){try{var A=null;var F=[];for(var E=0,B=this.sibs.length;E<B;E++){A=this.sibs[E];var H=A.childNodes;for(var D=0,I=H.length;D<I;D++){if(H[D].getAttribute("sty")==G){F.push(H[D]);}}}return F;}catch(C){microstrategy.errors.log(C);return null;}};mstrSubSection.prototype.getTargets=function(F){var I=this.findObjects(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);I=I.concat(this.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK));var K=[],D=[],A=[];var C={};for(var G=0,J=I.length;G<J;G++){var E=microstrategy.findBone(I[G])||I[G];if(!E){continue;}var B=(E.objId||E.id);if(F&&F.excludeTargets){if(mstr.utils.Arrays.find(F.excludeTargets,B)>-1){continue;}}if(C[B]!=true){if(E.type==microstrategy.OBJTYPE_GRID){D.push(E);}else{if(E.type==microstrategy.OBJTYPE_PANEL_STACK){A.push(E);}}K.push(B);C[B]=true;}}if(F&&F.includeTargets){var L=F.includeTargets;for(var G=0,J=L.length;G<J;G++){var H=microstrategy.bone("grid_"+L[G]+"_0");if(H){D.push(H);}else{H=microstrategy.bone(L[G]);if(H){A.push(H);}}}K=K.concat(F.includeTargets);}var I={};I.keys=K;I.grids=D;I.panels=A;return I;};mstrSubSection.prototype.recursiveWiring=function(E,D){var A=this.getTargets();var F=A.panels;for(var C in F){if(F[C].panels){for(var B in F[C].panels){F[C].panels[B].recursiveWiring(E,D);}}}this.wireControllers(E,D,A.keys,A.grids,true);};mstrSubSection.prototype.wireControllers=function(R,T,F,D,B,H){var E=this.findObjects(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);var J=microstrategy.updateManager;var C=[];for(var M=0,N=E.length;M<N;M++){var L=E[M].getAttribute("id");if(H&&H.excludeControls){if(mstr.utils.Arrays.find(H.excludeControls,L)>-1){continue;}}C.push(L);}C=(!H||!H.includeControls)?C:C.concat(H.includeControls);for(var M=0,N=C.length;M<N;M++){var K=microstrategy.bone(C[M]+"_Ctl");if(K.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){continue;}microstrategy.getViewerBone().doc.formattingAttributes[K.RWUnitId]["dfm"]=-1;if(K.targetKeys!=null&&F&&F.length>0){K.targetKeys=F;R.push(J.createActionObject(null,mstrUpdateManager.CTRL_SET_TARGETS,T,["2048130","2048129","2048116"],[K.ctlKey,"",F.join(CLIPBOARD_ITEM_SEPARATOR)]));this.doc.selections.flush=true;}}if(!B){return ;}for(var M=0,N=D.length;M<N;M++){var S=D[M];var O=S.objId;var I=S.controlLinks;if(I){for(var G in I){if("1"==I[G].targetTy){continue;}var Q=(G=="Metrics")?"":""+I[G].ty;var A=[];for(var P in F){if(F[P]!=O){A.push(F[P]);}}I[G].targets=A;R.push(J.createActionObject(null,mstrUpdateManager.ADD_CONTROL_TO_GRID,T,["2048007","2048130","2048001","2048009","2048129","2048116"],[O,"",G=="Metrics"?"":G,Q,"",A.join(CLIPBOARD_ITEM_SEPARATOR)],[],null));}}}};mstrSubSection.prototype.wireTargets=function(D,C,F,E){try{var A=this.getTargets(E);this.wireControllers(D,C,A.keys,A.grids,F,E);return D;}catch(B){microstrategy.errors.log(B);}};mstrSubSection.prototype.addObjsWithFormat=function(L,J,T,Q,V,U,Y,B){try{var I=[];var W=[];var M=this.doc.parentBone.updateManager;var N=this.doc.selections;for(var X=0;X<T.length;X++){if(T[X].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_RPT_DEFINITION){I.push(T[X]);}else{W.push(T[X]);}}var E=getObjSumLeft(Q);var O=getObjSumTop(Q);var P=false;if(Y==null){Y=[];}for(var X=0;X<I.length;X++){var D=microstrategy.DISPLAY_MODE_GRID;var S=I[X].getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);if(S){switch(S){case microstrategy.DSSTYPE_GRAPH:D=microstrategy.DISPLAY_MODE_GRAPH;break;case microstrategy.DSSTYPE_GRID_AND_GRAPH:D=microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;break;}}var R=true;if(B){R=false;}var C={dataSetID:I[X].getAttribute("id").substring(0,32),shiftKey:R,displayGrid:(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE),viewMode:D,dssSubType:S,dataSetName:I[X].getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME),addAsLinked:B};Y=this.doc.addCtrl(new Rect(J+O,null,null,L+E),Q,Y,microstrategy.SUBOBJTYPE_DOC_TEMPLATE,"",C,U);if(Y==null){return null;}L=L+getObjWidth(Q.lastChild)+10;P=true;}if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||(V!=null&&V.type==microstrategy.OBJTYPE_OBJBROWSER&&V.isFeatureAvailable(microstrategy.FEATURE_MODIFY_GRID_LEVEL_IN_DOCUMENTS))){var H="";var A=null;var K=colCount=null;for(var X=0;X<W.length;X++){var G=new mstrObjectInfoImpl(W[X]);if(H!=G.dSetId){P=(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE);H=G.dSetId;K=colCount=1;var C={dataSetID:null,shiftKey:false,displayGrid:true,dataSetName:null};Y=this.doc.addCtrl(new Rect(J+O,null,null,L+E),Q,Y,microstrategy.SUBOBJTYPE_DOC_TEMPLATE,null,C,U);if(Y==null){return null;}L=L+getObjWidth(Q.lastChild)+10;A=microstrategy.findBone(Q.lastChild);}if((W[X].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_METRIC)||(W[X].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_METRIC)||(W[X].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==microstrategy.DSSTYPE_USER_SUMMARY_METRIC)){Y=A.commands.exec("addTemplateUnit",W[X],microstrategy.GRIDCELL_AXIS_COLUMNS,colCount,Y);colCount++;}else{Y=A.commands.exec("addTemplateUnit",W[X],microstrategy.GRIDCELL_AXIS_ROWS,K,Y);K++;}}}Y=N.finishAdd(Q.lastChild,Y);if(P){if(Y.length>0){M.add(Y);Y=null;}M.flushAndSubmitChanges();}return Y;}catch(F){microstrategy.errors.log(F);return Y;}};mstrSubSection.prototype.onmousedown=function(F){try{if(!F){F=window.event;}var G=getEventTarget(F);var C=G&&G.tagName.toLowerCase();if(C==="select"||C==="textarea"||C==="input"){return true;}var B=microstrategy.eventManager.getSource(F);var A=this.doc.parentBone;if(!A.isInteractiveViewModeEplus(F)){if(this.doc.selections){this.doc.selections.clear(false);}microstrategy.hidePopups();F.cancelBubble=true;mstr.controllers.EventManager.notifyWindowListeners({name:"closeMenus"});return true;}if(B&&B.button==2&&(B.type==microstrategy.OBJTYPE_DOC_SUBSECTION||B.type==microstrategy.OBJTYPE_DOC_SECTION)){if(this.elem.getAttribute("cx")==null){microstrategy.getContextMenuManager("RWM").getMenu("rw_subsection_menu").registerTrigger(this.elem);this.parentBone.currentSubSection=this;this.doc.currentSection=this.parentBone;}if(G.getAttribute("cx")==null){microstrategy.getContextMenuManager("RWM").getMenu("rw_subsection_menu").registerTrigger(G);}var E=this.doc.selections;E.addSubSection(this.elem);microstrategy.hidePopups(null,F);F.cancelBubble=true;return false;}else{this.checkForResize(G);return(this.doc.selections.onmousedown)?this.doc.selections.onmousedown(F):false;}}catch(D){microstrategy.errors.log(D);return false;}};mstrSubSection.prototype.onclick=function(B){try{if(!B){B=window.event;}return(this.doc.selections.onclick)?this.doc.selections.onclick(B):false;}catch(A){microstrategy.errors.log(A);return false;}};mstrSubSection.prototype.ondblclick=function(D){try{if(!D){D=window.event;}var A=this.doc.parentBone;if(!A.isInteractiveViewModeEplus(D)){if(this.doc.selections){this.doc.selections.clear(false);}D.cancelBubble=true;return true;}var E=getEventTarget(D);try{if(!E||!E.tagName){return true;}}catch(C){alert("here");return true;}var B=E.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(B){case microstrategy.OBJTYPE_DOC_OBJECT:this.doc.editObj(D,E);break;case microstrategy.OBJTYPE_DOC_SELECTION:if(E.src){this.doc.editObj(D,E.src);}break;}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrSubSection.prototype.changeSubHeight=function(A,C,B){return B;};mstrSubSection.prototype.getSectionFormattingProps=function(){};mstrSubSection.prototype.checkForResize=function(A){};mstrSubSection.prototype.toggleSelected=function(){};mstrSubSection.prototype.toggleGrid=function(A){};mstrSubSection.prototype.marqueeSelect=function(G,F,A){try{for(var B=0;B<this.sibs.length;B++){var E=this.getOuterRect(this.sibs[B]);if(microstrategy.doRectsIntersect(E,F)){var D=this.sibs[B].firstChild;while(D){if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){if(A(this.getOuterRect(D),F)){G.push(D);}}D=D.nextSibling;}break;}}}catch(C){microstrategy.errors.log(C);}return G;};mstrSubSection.prototype.getOuterRect=function(C){try{var B={};if(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==null){B.left=getObjSumLeft(C);B.top=getObjSumTop(C);}else{B.left=getObjSumLeftScrolled(C);B.top=getObjSumTopScrolled(C);}B.right=Math.max(B.left+getObjWidth(C),B.left+1);B.bottom=Math.max(B.top+getObjHeight(C),B.top+1);return B;}catch(A){microstrategy.errors.log(A);return null;}};mstrSubSection.prototype.applyGradient=function(){try{if(!this.sibsWithGradients||this.hasConditionalFormatting){return ;}for(var C=0;C<this.sibsWithGradients.length;C++){if(!this.gradientInfo[C][gradientUtil.GRADIENT_START_COLOR_INDEX]||!this.gradientInfo[C][gradientUtil.GRADIENT_END_COLOR_INDEX]){continue;}if(!this.doc.parentBone.isEditableViewModeEplus()){gradientUtil.applyGradient(this.sibsWithGradients[C],this.gradientInfo[C][gradientUtil.GRADIENT_START_COLOR_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_END_COLOR_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_ANGLE_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_XOFFSET_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_YOFFSET_INDEX]);}else{var F;var B=false;if(!getObjOuterHeight(this.sibs[C])||!getObjOuterWidth(this.sibsWithGradients[C])){continue;}this.sibsWithGradients[C].setAttribute("gradientcolor",this.gradientInfo[C][gradientUtil.GRADIENT_START_COLOR_INDEX]+","+this.gradientInfo[C][gradientUtil.GRADIENT_END_COLOR_INDEX]+",14,"+this.gradientInfo[C][gradientUtil.GRADIENT_ANGLE_INDEX]+","+this.gradientInfo[C][gradientUtil.GRADIENT_XOFFSET_INDEX]+","+this.gradientInfo[C][gradientUtil.GRADIENT_YOFFSET_INDEX]);this.sibsWithGradients[C].setAttribute("bgstyle",2);if(this.sibsWithGradients[C].previousSibling&&this.sibsWithGradients[C].previousSibling.id&&this.sibsWithGradients[C].previousSibling.id==(this.sibsWithGradients[C].id+gradientUtil.GRADIENT_POSTFIX)){F=this.sibsWithGradients[C].previousSibling;B=true;}else{F=document.createElement("div");F.id=(this.sibsWithGradients[C].id+gradientUtil.GRADIENT_POSTFIX);F.style.position="absolute";}var A=getObjOuterHeight(this.sibsWithGradients[C]);var D=getObjOuterWidth(this.sibsWithGradients[C]);F.style.top="0px";F.style.left="0px";F.style.height=A+"px";F.style.width=D+"px";if(!B){this.sibsWithGradients[C].parentNode.insertBefore(F,this.sibsWithGradients[C]);}this.sibsWithGradients[C].style.backgroundColor="transparent";gradientUtil.applyGradient(F,this.gradientInfo[C][gradientUtil.GRADIENT_START_COLOR_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_END_COLOR_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_ANGLE_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_XOFFSET_INDEX],this.gradientInfo[C][gradientUtil.GRADIENT_YOFFSET_INDEX]);}}}catch(E){microstrategy.errors.log(E);}};mstrSubSection.prototype.getDocBone=function(){try{var A=microstrategy.getViewerBone();return A&&A.doc;}catch(B){microstrategy.errors.log(B);return null;}};mstrSubSection.prototype.canShowGuideline=function(){try{var B=this.getDocBone();return this.guidelineEnabled&&!(B&&B.selections.isMulti());}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.guidelineOffsetX=microstrategy.SNAP_SIZE;mstrSubSection.prototype.guidelineOffsetY=microstrategy.SNAP_SIZE;mstrSubSection.prototype.showGuidelines=function(B){try{var I=microstrategy.eventManager.source.elem;if(I&&I.id&&I.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){srcPos=this.positionMap[I.id];if(srcPos){B.height=srcPos.height;B.width=srcPos.width;}}if(!this.guidelineEnabled||!this.canShowGuideline()){return ;}var g=this.getDocBone();if(g.prevGuidelineSubsec){g.prevGuidelineSubsec.hideGuidelines();}g.prevGuidelineSubsec=this;this.hideGuidelines();this.showDimension(B);this.neighbors=null;this.guidelineOffsetX=microstrategy.SNAP_SIZE;this.guidelineOffsetY=microstrategy.SNAP_SIZE;var d=function(k,h){return Math.abs(k)>=Math.abs(h)?h:k;};var Y=g.selections.firstItem();if(!Y){return ;}var P=Y.id;var Q=["center","hcenter","left","right","top","bottom","vcenter","top-bottom","bottom-top","left-right","right-left","distance-vertical","distance-horizontal","width","height"];for(var V=0,W=Q.length;V<W;V++){var E=Q[V];switch(E){case"center":var R=Math.round(B.left+B.width/2),G=Math.round(B.top+B.height/2);var K=this.getLocalPosition(this.elem)||{top:0,left:0,width:this.elem.offsetWidth,height:this.elem.offsetHeight},Z=Math.round(K.left+K.width/2),e=Math.round(K.top+K.height/2);if(R==Z){this.renderGuidelines({top:K.top,left:R,height:K.height,width:1,borderColor:"#008000"});}if(G==e){this.renderGuidelines({top:G,left:K.left,height:1,width:K.width,borderColor:"#008000"});}this.guidelineOffsetX=d(this.guidelineOffsetX,R-Z);this.guidelineOffsetY=d(this.guidelineOffsetY,G-e);break;case"distance-vertical":var M=this.getNeighbor(B,P,"top"),L=this.getNeighbor(B,P,"bottom");if(!M.id||!L.id||M.v!=L.v){continue;}var U=M.pos,a=L.pos;var O={top:B.top-M.v,bottom:B.top,left:Math.max(U.left,B.left),right:Math.min(U.left+U.width,B.left+B.width)},N={top:a.top-M.v,bottom:a.top,left:Math.max(a.left,B.left),right:Math.min(a.left+a.width,B.left+B.width)};this.renderGuidelines({top:O.top,left:O.left+(O.right-O.left)/2,width:1,height:M.v},true);this.renderGuidelines({top:N.top,left:N.left+(N.right-N.left)/2,width:1,height:L.v},true);this.showDistance({top:O.top,left:O.left+(O.right-O.left)/2,idx:"t",v:M.v});this.showDistance({top:N.top,left:N.left+(N.right-N.left)/2,idx:"b",v:L.v});break;case"distance-horizontal":var M=this.getNeighbor(B,P,"left"),L=this.getNeighbor(B,P,"right");if(!M.id||!L.id||M.v!=L.v){continue;}var U=M.pos,a=L.pos;var O={top:Math.max(U.top,B.top),bottom:Math.min(U.top+U.height,B.top+B.height),left:U.left+U.width,right:B.left},N={top:Math.max(a.top,B.top),bottom:Math.min(a.top+a.height,B.top+B.height),left:B.left+B.width,right:a.left};this.renderGuidelines({top:O.top+(O.bottom-O.top)/2,left:O.left,width:M.v,height:1},true);this.renderGuidelines({top:N.top+(N.bottom-O.top)/2,left:N.left,width:L.v,height:1},true);this.showDistance({top:O.top+(O.bottom-O.top)/2,left:O.left,idx:"l",v:M.v});this.showDistance({top:N.top+(N.bottom-O.top)/2,left:N.left,idx:"r",v:L.v});break;default:var X=this.positionMap;for(var f in X){if(f==P){continue;}var H=X[f];H=mstr.$H.clone(H);H.top=parseInt(H.top);H.left=parseInt(H.left);var c=null,C=H,A=B,J=3;var D=function(h){if(C[h]>B[h]){C=B;A=H;}};switch(E){case"width":if(Math.round(C.width)==Math.round(A.width)){this.renderGuidelines({top:C.top+C.height+J,left:C.left,width:C.width,height:1},true);this.renderGuidelines({top:A.top+A.height+J,left:A.left,width:A.width,height:1},true);continue;}break;case"height":if(Math.round(C.height)==Math.round(A.height)){this.renderGuidelines({top:C.top,left:C.left+C.width+J,width:1,height:C.height},true);this.renderGuidelines({top:A.top,left:A.left+A.width+J,width:1,height:A.height},true);continue;}break;case"hcenter":var T=Math.round(H.left+H.width/2),S=Math.round(B.left+B.width/2);if(T==S){D("top");c={top:C.top+C.height,left:T,width:1,height:A.top-(C.top+C.height)};}this.guidelineOffsetX=d(this.guidelineOffsetX,S-T);break;case"vcenter":var T=Math.round(H.top+H.height/2),S=Math.round(B.top+B.height/2);if(T==S){D("left");c={top:T,left:C.left+C.width,width:A.left-C.left-C.width,height:1};}this.guidelineOffsetY=d(this.guidelineOffsetY,S-T);break;case"left":var T=Math.round(H.left),S=Math.round(B.left);if(T==S){D("top");c={top:C.top+C.height,left:T,width:1,height:A.top-(C.top+C.height)};}this.guidelineOffsetX=d(this.guidelineOffsetX,S-T);break;case"right":var T=Math.round(H.left+H.width),S=Math.round(B.left+B.width);if(T==S){D("top");c={top:C.top+C.height,left:T,width:1,height:A.top-(C.top+C.height)};}this.guidelineOffsetX=d(this.guidelineOffsetX,S-T);break;case"top":var T=Math.round(H.top),S=Math.round(B.top);if(T==S){D("left");c={top:T,left:C.left+C.width,width:A.left-(C.left+C.width),height:1};}this.guidelineOffsetY=d(this.guidelineOffsetY,S-T);break;case"bottom":var T=Math.round(H.top+H.height),S=Math.round(B.top+B.height);if(T==S){D("left");c={top:T,left:C.left+C.width,width:A.left-(C.left+C.width),height:1};}this.guidelineOffsetY=d(this.guidelineOffsetY,S-T);break;case"top-bottom":var T=Math.round(H.top+H.height),S=Math.round(B.top);if(T==S){D("left");c={top:T,left:C.left+C.width,width:A.left-(C.left+C.width),height:1};}this.guidelineOffsetY=d(this.guidelineOffsetY,S-T);break;case"bottom-top":var T=Math.round(H.top),S=Math.round(B.top+B.height);if(T==S){D("left");c={top:T,left:C.left+C.width,width:A.left-(C.left+C.width),height:1};}this.guidelineOffsetY=d(this.guidelineOffsetY,S-T);break;case"left-right":var T=Math.round(H.left+H.width),S=Math.round(B.left);if(T==S){D("top");c={top:C.top+C.height,left:T,width:1,height:A.top-(C.top+C.height)};}this.guidelineOffsetX=d(this.guidelineOffsetX,S-T);break;case"right-left":var T=Math.round(H.left),S=Math.round(B.left+B.width);if(T==S){D("top");c={top:C.top+C.height,left:T,width:1,height:A.top-(C.top+C.height)};}this.guidelineOffsetX=d(this.guidelineOffsetX,S-T);break;}c&&this.renderGuidelines(c,false);}break;}}if(this.positionMap[P]){this.positionMap[P]=B;}}catch(F){microstrategy.errors.log(F);}};mstrSubSection.prototype.getNeighbor=function(F,G,K,A){try{var R=mstr.utils.Math;var P=F.top,B=F.left,Y=this.elem,c=min_bottom=Y.offsetHeight,I=min_right=Y.offsetWidth,C={top:{id:"",v:c},bottom:{id:"",v:min_bottom},left:{id:"",v:I},right:{id:"",v:min_right}},J={h:{min:F.left,max:F.left+F.width},v:{min:F.top,max:F.top+F.height}};var E=this.elem.childNodes;for(var U=0,W=E.length;U<W;U++){var V=E[U],X=V.id;if(X&&X!=G){if(!this.positionMap[X]){if(V.nodeType==1&&V.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){this.updatePositionMap(V);}else{continue;}}var Q=this.positionMap[X],M=Q.top,a=M+Q.height,S=Q.left,O=S+Q.width;for(var T=0;T<4;T++){var H=["top","bottom","left","right"][T];var Z=-1,N=null,L=null;switch(H){case"top":case"bottom":Z=H=="top"?P-a:M-(F.top+F.height);N={min:S,max:O};L=J.h;break;case"left":case"right":Z=H=="left"?B-O:S-(B+F.width);N={min:M,max:a};L=J.v;break;}if(Z>0&&(A||!A&&R.rangesIntersect(N,L))&&Z<C[H].v){C[H].v=Z;C[H].id=X;C[H].pos=Q;}}}}this.neighbors=C;return K?C[K]:C;}catch(D){microstrategy.errors.log(D);}};mstrSubSection.prototype.getGuidelineSnapOffset=function(H,D,B,A){try{var E=0;var G=this.getNeighbor(H,D,A,true);if(G&&G.pos){var F=G.pos;switch(A){case"top":E=H.top-(F.top+F.height);break;case"bottom":E=F.top-(H.top+H.height);break;case"left":E=H.left-(F.left+F.width);break;case"right":E=F.left-(H.left+H.width);break;}E=E<microstrategy.SNAP_SIZE?E:0;}return B*E;return E!=0?B*(microstrategy.SNAP_SIZE-E):0;}catch(C){microstrategy.errors.log(C);}};mstrSubSection.prototype.renderGuidelines=function(G,D){try{if(!this.cnt){this.cnt=0;}var F=G.height==1?"h":"v",C=G.height==1?"v":"h",A=document.createElement("div");A.setAttribute("cnt",this.cnt);A.setAttribute("ty","gl");A.className="mstrGuideline "+F+(D?" s":"");A.style.zIndex=this.maxZindex+1;for(var B in G){A.style[B]=mstr.utils.LocaleParser.isNumeric(G[B])?Math.max(G[B],0)+"px":G[B];}if(D){A.innerHTML='<div class="mstrGuideline-tip '+C+' tl" ></div><div class="mstrGuideline-tip '+C+' rb" ></div>';}this.elem.appendChild(A);this.guidelines=this.guidelines||[];this.guidelines.push(A);}catch(E){microstrategy.errors.log(E);}};mstrSubSection.prototype.hideGuidelines=function(){try{this.hideDimension();this.hideDistance();if(!this.guidelines){return ;}for(var C=0,A=this.guidelines.length;C<A;C++){var B=this.guidelines[C];B.parentNode.removeChild(B);}this.guidelines=[];}catch(D){microstrategy.errors.log(D);}};mstrSubSection.prototype.showDimension=function(C){try{var A=this.elDim;if(!A){A=document.createElement("span");A.className="mstrGuideline-dim";this.elem.appendChild(A);this.elDim=A;}A.style.display="block";A.style.left=(C.left+C.width+10)+"px";A.style.top=(C.top)+"px";A.innerHTML="x:"+parseInt(C.left,10)+"px<br/>y:"+parseInt(C.top,10)+"px<br/>width:"+parseInt(C.width,10)+"px<br/>height:"+parseInt(C.height,10)+"px";}catch(B){microstrategy.errors.log(B);}};mstrSubSection.prototype.hideDimension=function(){try{if(this.elDim){this.elDim.style.display="none";}}catch(A){microstrategy.errors.log(A);}};mstrSubSection.prototype.showDistance=function(F){try{var C=F.v,A=F.idx,B=A=="l"||A=="r";var D=(this.elDis||(this.elDis={l:null,t:null,r:null,b:null}))[F.idx];if(!D){D=document.createElement("span");D.className="mstrGuideline-dis";this.elem.appendChild(D);this.elDis[A]=D;}D.innerHTML=F.v+"px";D.style.left=(F.left+(B?C/2-10:3))+"px";D.style.top=(F.top+(B?-20:C/2-10))+"px";D.style.display="block";}catch(E){microstrategy.errors.log(E);}};mstrSubSection.prototype.hideDistance=function(){try{var B=this.elDis;if(B){for(var A in B){var C=B[A];if(C){C.style.display="none";}}}}catch(D){microstrategy.errors.log(D);}};mstrSubSection.prototype.readFormatPosition=function(A){return this.getLocalPosition(A);};mstrSubSection.prototype.getLocalPosition=function(C){try{var G=[];var F=C.constructor===Array,C=F?C:[C];if(C&&C.length){var D=mstr.$BM.position(this.elem);for(var B in C){var A=mstr.$BM.position(C[B]);A.top=A.top-D.top;A.left=A.left-D.left;G.push(A);}}return F?G:(G&&G[0]);}catch(E){microstrategy.errors.log(E);}};mstrSubSection.prototype.updatePositionMap=function(B,A){try{if(!this.guidelineEnabled){return ;}if(A){delete this.positionMap[B.id];}else{this.positionMap[B.id]=this.readFormatPosition(B);}}catch(C){microstrategy.errors.log(C);}};mstrSubSection.prototype.syncPositionMap=function(A){try{if(!this.guidelineEnabled){return ;}A=mstr.$A.toArray(A);for(var C in A){this.updatePositionMap(A[C]);}}catch(B){microstrategy.errors.log(B);}};function mstrSubSection(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrUpdateManager.prototype=new Object;mstrUpdateManager.prototype.id="bonesUpdateManager";mstrUpdateManager.prototype.observer=null;mstrUpdateManager.prototype.actions={};mstrUpdateManager.prototype.redoActions=[];mstrUpdateManager.prototype.undoActions=[];mstrUpdateManager.prototype.staticActions=[];mstrUpdateManager.prototype.useIframe=false;mstrUpdateManager.prototype.newWindow=false;mstrUpdateManager.prototype.newWindowName="_blank";mstrUpdateManager.prototype.extraURL="";mstrUpdateManager.prototype.iframeTarget="frameManager";mstrUpdateManager.prototype.formAction="";mstrUpdateManager.prototype.OPTIMIZE_EVENTS=true;mstrUpdateManager.prototype.ADD_EVENT_IDS=null;mstrUpdateManager.prototype.optActions=[];mstrUpdateManager.prototype.lastPosArray=[];mstrUpdateManager.prototype.copyActions={};mstrUpdateManager.prototype.cachedActionCollection=null;mstrUpdateManager.prototype.queueActions=false;mstrUpdateManager.prototype.forceSubmitAfterQueue=false;mstrUpdateManager.prototype.ctlCurElementsPosition=null;mstrUpdateManager.prototype.currentPanelPosition=null;mstrUpdateManager.prototype.hiddenInputs=null;mstrUpdateManager.prototype.submittedForm=null;mstrUpdateManager.prototype.submittedXhr=false;mstrUpdateManager.prototype.newActions=false;mstrUpdateManager.prototype.sTimeOutID=null;mstrUpdateManager.prototype.callback=null;mstrUpdateManager.UNIT_SEPARATOR=",";mstrUpdateManager.ITEM_SEPARATOR=";";mstrUpdateManager.UPDATE_LATER="0";mstrUpdateManager.UPDATE_NOW="1";mstrUpdateManager.STATIC_ACTION=-1;mstrUpdateManager.ARG_KEY_SEPARATOR="_";mstrUpdateManager.addEvent=function(A){if(!mstrUpdateManager.actions){mstrUpdateManager.actions={};}for(var B in A){var C=A[B].i;mstrUpdateManager[B]=C;mstrUpdateManager.actions[C]={eventID:C,paramName:A[B].n,paramID:A[B].p};}mstrUpdateManager.newActions=true;};mstrUpdateManager.prototype.addSingleAction=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection.push(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getUseIFrame=function(){try{return this.useIframe;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setUseIFrame=function(B){try{this.useIframe=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getNewWindowSetting=function(){try{return this.newWindow;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setNewWindowSetting=function(B){try{this.newWindow=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.addActionCollection=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection=this.cachedActionCollection.concat(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.hasCachedActions=function(){try{return(this.cachedActionCollection&&this.cachedActionCollection.length>0);}catch(A){microstrategy.errors.log(A);}return false;};mstrUpdateManager.prototype.addCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.add(this.cachedActionCollection,false);this.cachedActionCollection=null;if(this.forceSubmitAfterQueue){this.flushAndSubmitChanges();}}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.killCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.cachedActionCollection=null;}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.add=function(C,A){try{if(this.queueActions){if(C.length){this.addActionCollection(C);}else{this.addSingleAction(C);}}else{if(A){this.staticActions.push(C);this.redoActions.unshift(mstrUpdateManager.STATIC_ACTION);this.newActions=true;}else{this.clearRedoActions();this.undoActions.push(C);this.newActions=true;}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","add",C);if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.addURL=function(A){try{if(A){if(this.extraURL.length>0){this.extraURL+="&"+A;}else{this.extraURL=A;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.replaceURL=function(A,D){try{if(this.extraURL.length>0){if(this.extraURL.indexOf(A)>-1){var E=this.extraURL.substring(0,this.extraURL.indexOf(A)-2);var C=this.extraURL.indexOf("&",this.extraURL.indexOf(A));if(E==null||E.length==0){E="";}else{E+="&";}if(C>this.extraURL.indexOf(A)){this.extraURL=E+this.extraURL.substring(C+1,this.extraURL.length)+"&"+A+"="+D;}else{this.extraURL=A+"="+D;}}else{this.extraURL+="&"+A+"="+D;}}else{this.extraURL=A+"="+D;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.processUndoRedo=function(C,D){try{while(C.length>0){var B=C.pop();D.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;}}}catch(A){microstrategy.errors.log(A);}return null;};mstrUpdateManager.prototype.broadcastUpdate=function(){try{while(source.length>0){var B=source.pop();target.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;break;}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.undo=function(C){try{var D=false;C=C||1;for(var A=0;A<C;A++){var F=this.processUndoRedo(this.undoActions,this.redoActions);if(F){for(var B=0;B<F.length;B++){microstrategy.eventManager.notifyOrphanBones("onundo",new mstrUndoObj(F[B]));}D=true;}}if(D){microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","undo");}if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.redo=function(){try{var C=this.processUndoRedo(this.redoActions,this.undoActions);if(C){for(var A=0;A<C.length;A++){microstrategy.eventManager.notifyOrphanBones("onredo",new mstrRedoObj(C[A]));}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","redo");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.getPendingEventsForTask=function(A){var E;var J;var B=0;var N=[];var D=A.split(".");var C=D[D.length-1];var F=this.optActions;this.optActions=[];if(this.OPTIMIZE_EVENTS){for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;this.createOptimizedArray(H);G.splice(M,1);M=M-1;}}}for(var I=0;I<this.optActions.length;I++){if(this.optActions[I].id!=null){N.push(this.createEventForAction(this.optActions[I]));}}this.postOptimizationCleanup();}else{for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;N.push(this.createEventForAction(H));G.splice(M,1);M=M-1;}}}}this.optActions=F;if(N.length>0){var L=new mstrSerializer();L.addValues(N);return L.getState();}else{return"";}};mstrUpdateManager.prototype.flushChanges=function(I){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){addURLAsHiddenInputsToForm(I,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){this.createOptimizedArray(D[H]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){J.push(this.createEventForAction(D[H]));}}}var G=new mstrSerializer();G.addValues(J);if(I.getAttribute("hasUpdateChanges")=="true"){updateDynamicInput(I,mstrUpdateManager.multipleEventArgName,G.getState());}else{this.submittedForm=I;this.hiddenInputs=[];this.createHiddenInput(I,mstrUpdateManager.multipleEventArgName,G.getState());this.createHiddenInput(I,"evt",mstrUpdateManager.multipleEventID);this.createHiddenInput(I,"src",mstrUpdateManager.multipleEventSrc);this.createHiddenInput(I,mstrUpdateManager.multipleEventID,"1");I.setAttribute("hasUpdateChanges","true");}if(this.newWindow){I.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.flushChangesAsParams=function(G){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){UpdateHelper.addURLToParams(G,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){this.createOptimizedArray(D[I]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){J.push(this.createEventForAction(D[I]));}}}var H=new mstrSerializer();H.addValues(J);if(G.hasUpdateChanges=="true"){G[mstrUpdateManager.multipleEventArgName]=H.getState();}else{this.submittedXhr=true;UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventArgName,H.getState());UpdateHelper.addAdditionalParam(G,"evt",mstrUpdateManager.multipleEventID);UpdateHelper.addAdditionalParam(G,"src",mstrUpdateManager.multipleEventSrc);UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventID,"1");G.hasUpdateChanges=="true";}if(this.newWindow){G.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.createHiddenInput=function(D,B,C){var A=createHiddenInput(D,B,C);this.hiddenInputs.push(A);};mstrUpdateManager.prototype.postOptimizationCleanup=function(A){if(this.fullScreenModePosition){delete this.fullScreenModePosition;}if(this.lTbarBrowserSettingPosition){delete this.lTbarBrowserSettingPosition;}if(this.ctlCurElementsPosition){delete this.ctlCurElementsPosition;}if(this.currentPanelPosition){delete this.currentPanelPosition;}if(this.widgetPropEdits){delete this.widgetPropEdits;}this.optActions=[];this.lastPosArray=[];};mstrUpdateManager.prototype.createEventForAction=function(G){try{var A=mstrUpdateManager.actions[G.id];var E=new mstrSerializer();E.addStr(A.eventID);E.addStr(G.beanPath+"."+A.eventID);var D="";for(var C=0;C<G.newArgs.length;C++){actionID=G.argID[C];for(var B=0;B<A.paramID.length;B++){if(A.paramID[B]==actionID){if(false){D+="<arg name='"+A.paramName[B]+"' v='"+G.newArgs[C]+"' />";}if(G.argKey==null){E.addStr(A.paramName[B]);}else{E.addStr(A.paramName[B]+mstrUpdateManager.ARG_KEY_SEPARATOR+G.argKey);}E.addStr(G.newArgs[C]);break;}}}if(false){alert(D);}return E.getState();}catch(F){microstrategy.errors.log(F);return false;}};mstrUpdateManager.prototype.flushAndSubmitChanges=function(C,H){this.callback=H||{};var B=this,G=this.callback.success,F=this.callback.noRefresh;this.callback.success=function(I){if(G){G(I);}if(!F&&I&&I.status=="6"){B.refreshPage();}};try{if(useXHR&&!C){mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var A=UpdateHelper.createParamsFromURL(this.getFormAction(),this.useIframe&&!this.newWindow);this.flushing=true;UpdateHelper.submitRequest(A);}else{mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var D=createDynamicForm(this.getFormAction());if(this.useIframe&&!this.newWindow){addURLAsHiddenInputsToForm(D,"iframe=true");D.target=this.iframeTarget;}this.flushing=true;submitForm(D,C);}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.acknowledgeRequest=function(){try{this.undoActions=[];this.redoActions=[];this.staticActions=[];this.optActions=[];this.lastPosArray=[];this.copyActions={};this.newWindow=false;microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}var B;if(this.submittedForm!=null){for(var A=0;A<this.hiddenInputs.length;A++){B=this.hiddenInputs[A];try{this.submittedForm.removeChild(B);}catch(C){if((C&&C.code!=8)&&(C.number&&C.number!=-2147024809)){throw (C);}}}this.submittedForm.setAttribute("hasUpdateChanges","false");this.submittedForm=null;this.hiddenInputs=null;this.flushing=false;}if(this.submittedXhr){this.submittedXhr=false;this.flushing=false;}}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.isFlushing=function(){return !!this.flushing;};mstrUpdateManager.prototype.acknowledgeReloadEnd=function(){if(this.observer){this.observer.notifyAll("acknowledgeReloadEnd");}};mstrUpdateManager.prototype.getFixStateActions=function(){try{var E=[];for(var B=0;B<this.staticActions.length;B++){var D=this.staticActions[B];for(var A=0;A<D.length;A++){E.push(D[A]);}}return E;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.hasChangesToSubmit=function(){try{return(this.undoActions.length>0||this.isRedoStatic()||(this.extraURL!=null&&this.extraURL.length>0));}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.hasNewChanges=function(){try{var A=this.newActions;this.newActions=false;return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.clearRedoActions=function(){try{while(this.redoActions.length>0){var B=this.redoActions.pop();if(B==mstrUpdateManager.STATIC_ACTION){this.undoActions.push(B);}}}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.getLastAction=function(){try{return this.undoActions.pop();}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.isRedoStatic=function(){try{var C=false;for(var A=0;A<this.redoActions.length;A++){if(this.redoActions[A]==mstrUpdateManager.STATIC_ACTION){C=true;break;}}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.anyNonStatic=function(B){try{var A=(B)?this.redoActions:this.undoActions;var E=false;for(var C=0;C<A.length;C++){if(A[C]!=mstrUpdateManager.STATIC_ACTION){E=true;break;}}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createActionObject=function(C,A,G,H,B,F,J,I){try{var E={};E.elem=C;E.id=A;E.beanPath=G;E.argID=H;E.newArgs=B;E.oldArgs=F;E.cachedArray=J;E.argKey=I;if(A==mstrUpdateManager.EDIT_PROPS){E.formatType=microstrategy.formatType;E.argID.push("2048131");E.newArgs.push(microstrategy.formatType);E.oldArgs.push(microstrategy.formatType);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createOptimizedArray=function(G){try{var I=G.id;if(!this.ADD_EVENT_IDS){this.ADD_EVENT_IDS=mstrUpdateManager.ADD_TEXT+"|"+mstrUpdateManager.ADD_LINE+"|"+mstrUpdateManager.ADD_SHAPE+"|"+mstrUpdateManager.ADD_TEMPLATE+"|"+mstrUpdateManager.ADD_DATASET_TEMPLATE+"|"+mstrUpdateManager.ADD_IMAGE+"|"+mstrUpdateManager.ADD_HTML_CONTAINER+"|"+mstrUpdateManager.ADD_PANEL_STACK+"|"+mstrUpdateManager.CTRL_ADD+"|";}var N=(G.elem)?G.elem.id:null;var B=N;if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="4146"){B=N+G.newArgs[K].split("!")[0]+G.newArgs[K].split("!")[1]+G.newArgs[K].split("!")[2];break;}}}var P;if(I==mstrUpdateManager.EDIT_PROPS){for(var K=0,D=G.argID.length;K<D;K++){if(G.argID[K]=="2048035"){var J=G.newArgs[K].split(mstrUpdateManager.UNIT_SEPARATOR);if(J[1]=="FormattingWidget"&&J[2]=="WidgetProps"){var C=this.widgetPropEdits||{};if(J[0] in C){this.optActions[C[J[0]]].id=null;}C[J[0]]=this.optActions.length;this.widgetPropEdits=C;}break;}}this.optActions.push(G);}else{if(I==mstrUpdateManager.COPY_TO_CLIPBOARD||I==mstrUpdateManager.CUT_TO_CLIPBOARD){P=G.newArgs[0].split(CLIPBOARD_ITEM_SEPARATOR);for(var K=0;K<P.length;K++){this.copyActions[P[K]]={};this.copyActions[P[K]].position=this.optActions.length;this.copyActions[P[K]].applied=false;}this.optActions.push(G);}else{if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES||I==mstrUpdateManager.EDIT_TEXT||I==mstrUpdateManager.SET_TOPLEFT_POSITION||I==mstrUpdateManager.CHANGE_BONE_PROPERTY){if(!this.lastPosArray[I]){this.lastPosArray[I]={};}if(this.copyActions[N]&&this.copyActions[N].applied==false){this.copyActions[N].applied=true;for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}else{if(this.lastPosArray[I][B]){var L=this.lastPosArray[I][B].position;var F=this.optActions[L];var H=mstr.$A.find(F.argID,"2048007");if(H==-1){H=null;}var M=mstr.$A.find(F.argID,"2048007");if(M==-1){H=null;}if(M==H){F.newArgs=G.newArgs;}else{this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}else{this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}}else{if(I==mstrUpdateManager.REMOVE_OBJECT){if(this.copyActions[N]){for(var K=this.copyActions[N].position;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N){this.optActions[K].id=null;}}delete this.copyActions[N];for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}}else{for(var K=0;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N&&!this.ADD_EVENT_IDS.contains(this.optActions[K].id,"|")){this.optActions[K].id=null;}}}this.optActions.push(G);}else{if(I==mstrUpdateManager.SWITCH_FULL_SCREEN_MODE){if(typeof (this.fullScreenModePosition)!="undefined"&&this.optActions[this.fullScreenModePosition]&&this.optActions[this.fullScreenModePosition].newArgs&&this.optActions[this.fullScreenModePosition].id==I){this.optActions[this.fullScreenModePosition].newArgs=G.newArgs;}else{this.fullScreenModePosition=this.optActions.length;this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING){if(G.argID[0]=="5005"&&G.newArgs[0]=="lTbar"){if(typeof (this.lTbarBrowserSettingPosition)!="undefined"&&this.optActions[this.lTbarBrowserSettingPosition]&&this.optActions[this.lTbarBrowserSettingPosition].newArgs){this.optActions[this.lTbarBrowserSettingPosition].newArgs=G.newArgs;}else{this.lTbarBrowserSettingPosition=this.optActions.length;this.optActions.push(G);}}else{this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_CUR_CTL_ELEMENTS){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="2048130"){this.ctlCurElementsPosition=this.ctlCurElementsPosition||{};var A=G.newArgs[K];if(A in this.ctlCurElementsPosition){this.optActions[this.ctlCurElementsPosition[A]].id=null;}this.ctlCurElementsPosition[A]=this.optActions.length;this.optActions.push(G);break;}}}else{if(I==mstrUpdateManager.SET_CURRENT_PANEL){var O=G.newArgs[0];if(!this.currentPanelPosition){this.currentPanelPosition={};}if(typeof (this.currentPanelPosition[O])!="undefined"){this.optActions.splice(this.currentPanelPosition[O],1);}this.currentPanelPosition[O]=this.optActions.length;this.optActions.push(G);}else{this.optActions.push(G);}}}}}}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.getFormAction=function(){if(!this.formAction){this.formAction=microstrategy.servletName;}return this.formAction;};mstrUpdateManager.prototype.setFormAction=function(A){this.formAction=A;};mstrUpdateManager.createPropertyEditString=function(C,B,G,A,H){try{var F=mstrFormatObject;if(!F){return"";}if(!A){G=F.encodeValue(B,G);}var D=C||"";if(D){D+=mstrUpdateManager.UNIT_SEPARATOR;}return D+(H||F.getPropertySetName(B))+mstrUpdateManager.UNIT_SEPARATOR+F.getPropertyName(B)+mstrUpdateManager.UNIT_SEPARATOR+G+mstrUpdateManager.ITEM_SEPARATOR;}catch(E){microstrategy.errors.log(E);return"";}};mstrUpdateManager.prototype.createEditPropsAction=function(F,J,S,I,Q,D,A,L,K,R){try{var E=(A)?mstrUpdateManager.UPDATE_NOW:mstrUpdateManager.UPDATE_LATER;var M=mstrUpdateManager.createPropertyEditString;var O=K?"1":"0";var H="",C="";for(var N=0;N<I.length;N++){H+=M(J,I[N],Q[N],R);if(D&&(N in D)){C+=M(J,I[N],D[N]);}}var B=K?["2048018","2048035","2048241"]:["2048018","2048035"],G=K?[E,H,O]:[E,H];return this.createActionObject(F,mstrUpdateManager.EDIT_PROPS,S,B,G,(C&&[E,C])||[],L);}catch(P){microstrategy.errors.log(err);return null;}};mstrUpdateManager.prototype.findRwbInputOnPageStateForm=function(){var C=getObj("pageStateForm");var B=C.getElementsByTagName("INPUT");for(i=0,cnt=B.length;i<cnt;i++){var A=B[i];if(A.name==="rwb"){return A;}}return null;};mstrUpdateManager.prototype.getRWBState=function(A){if(A){var B=this.findRwbInputOnPageStateForm();if(B){return B.value;}}else{if(pageState){var C=(pageState+"&").match(/rwb=(.*?)\&/);if(C!=-1){return C[1];}}}return"";};mstrUpdateManager.prototype.setRWStateInForm=function(A){var B=this.findRwbInputOnPageStateForm();if(B){B.value=A;}};mstrUpdateManager.prototype.refreshPage=function(){try{this.useIframe=false;var B=this.createActionObject(null,mstrUpdateManager.PAGE_REFRESH,microstrategy.servletName+"."+microstrategy.pageName,[],[],[],null);this.add([B],true);this.flushAndSubmitChanges();}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.submitPartialUpdate=function(C){try{microstrategy.puStatus=0;iframe.notifyParent(true);if(!this.partialUpdateModel){this.partialUpdateModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.partialUpdateModel);var A=this.partialUpdateModel&&this.partialUpdateModel&&this.partialUpdateModel.init();if(!("id" in this)||!mstr.$obj(this.id)){mstr.controllers.Factory.add(this);}this.partialUpdateModel.attachEventListener(this,"set_readyState","handleStateChange");}C.processorClass=mstr.http.PUProcessor;this.partialUpdateModel.execSubmit({params:C,callback:this.callback});}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.handleStateChange=function(evt){try{switch(evt.memo.value){case mstr.Enum.Widget.READYSTATE.TIMEOUT:case mstr.Enum.Widget.READYSTATE.ERROR:break;case mstr.Enum.Widget.READYSTATE.SUCCESS:var updateResult=evt.src.get("requestContext").response.data;if(updateResult){if(updateResult.status=="2"){iframe.showWaitPage();}else{iframe.hideWaitPage();}UpdateHelper.replaceComponents(updateResult.components);document.title=updateResult.title;if(updateResult.status=="2"){this.doRedirect(updateResult.redirectURL,updateResult.waitSeconds);}microstrategy.eventManager.executeFunction("microstrategy.eventManager.onreload()");if(updateResult.script){eval(updateResult.script);}microstrategy.puStatus=1;}else{if(window.document.readyState=="complete"){var sMarkup=evt.src.get("requestContext").response.text;if(bIsIE6&&!bIsIE7){document.write(sMarkup);}else{var oNewDoc=window.document.open("text/html");if(sMarkup.indexOf("<!DOCTYPE")==-1){oNewDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd " >');}oNewDoc.write(sMarkup);oNewDoc.close();}}}delete this.callback;break;}}catch(err){microstrategy.errors.log(err);}};mstrUpdateManager.prototype.doRedirect=function(C,A){try{this.sTimeOutID=window.setTimeout('microstrategy.updateManager.timedRedirect("'+C+'")',A*1000);}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.timedRedirect=function(C){try{window.clearTimeout(this.sTimeOutID);var A=UpdateHelper.createParamsFromURL(C);UpdateHelper.submitRequest(A);}catch(B){microstrategy.errors.log(B);}};function mstrUpdateManager(){this.commands=new UpdateManagerCommands(this);if(typeof (mstrObserverImpl)!="undefined"){this.observer=new mstrObserverImpl();}return this;}if(typeof (microstrategy)!="undefined"){microstrategy.updateManager=new mstrUpdateManager();}mstrUndoObj.prototype={};function mstrUndoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.oldArgs;this.cachedArray=A.cachedArray;return this;}mstrRedoObj.prototype={};function mstrRedoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.newArgs;this.cachedArray=A.cachedArray;return this;}function UpdateManagerCommands(A){this.queryVisible=function(B){return true;};this.queryEnabled=function(B){switch(B){case"redo":return A.anyNonStatic(true);case"undo":return A.anyNonStatic(false);case"apply":return A.hasChangesToSubmit();default:return false;}};this.queryState=function(B){return false;};this.exec=function(B,C){switch(B){case"redo":return A.redo();case"undo":return A.undo();case"apply":A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return A.flushAndSubmitChanges();default:return false;}};return this;}var UpdateHelper=new function(){};UpdateHelper.prototype=new Object();UpdateHelper.createParamsFromURL=function(B,G){var C={method:"post"};var H=B.indexOf("?")>0;var F=B.indexOf("#")>0;var E=(B.indexOf("iframe=true")>0||G);var D=((H)?B.substring(0,B.indexOf("?")):B);if(F){var A="";B=moveAnchor(B);A=B.substring(B.indexOf("#"));D=D.replace(A,"")+A;B=B.substring(0,B.indexOf("#"));}D=microstrategy.addJSessionID(D);if(H){UpdateHelper.addURLToParams(C,B);}C.iframe=(E)?"true":"false";C.action=D;return C;};UpdateHelper.createParamsFromForm=function(I,J,F,H){var G=getObj(I);var C=microstrategy.findChildrenWithAtt(G,["INPUT","SELECT","TEXTAREA"],"name");var B={action:G.action,method:G.method};if(typeof G.target!=undefined){B.target=G.target;}for(var D=0;D<C.length;D++){var A=C[D];if(H===true&&A.ps===true){continue;}if(A.type=="select-multiple"&&A.options&&A.options.length>0&&A.disabled!=true){for(var E=0;E<A.options.length;E++){if(UpdateHelper.shouldSubmit(A.options[E])){UpdateHelper.addAdditionalParam(B,A.name,A.options[E].value);}}}else{if(UpdateHelper.shouldSubmit(A)){UpdateHelper.addAdditionalParam(B,A.name,A.value);}}}if(J){B[J]=F;}return B;};UpdateHelper.shouldSubmit=function(A){if(A.disabled==true){return false;}if(A.type=="submit"||A.type=="button"||A.type=="image"||A.value=="undefined"){return false;}if(A.type=="radio"||A.type=="checkbox"){if(!A.getAttribute("agg")){return A.checked;}else{A.value=A.checked?"true":"false";return true;}}if(A.tagName.toLowerCase()=="option"){return A.selected;}return true;};UpdateHelper.addURLToParams=function(D,F,C){F=F.substring(F.indexOf("?")+1,F.length);var G=F.split("&");var I="";var E="";var A="";var H=/\+/g;for(var B=0;B<G.length;B++){I=G[B].split("=");E=I[0];A=I[1];if(A){A=decodeURIComponent(A.replace(H," "));}if(C){D[E]=A;}else{UpdateHelper.addAdditionalParam(D,E,A);}}return false;};UpdateHelper.addAdditionalParam=function(A,B,C){if(A[B]&&typeof A[B]!="object"){A[B]=[A[B],C];}else{if(A[B]&&A[B].push){A[B].push(C);}else{A[B]=C;}}};UpdateHelper.submitRequest=function(H){var N=getObj("pageStateForm");var E=null;var I=null;var G;var F;var C;var O;UpdateHelper.appendPageStateToParams(H);if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){var L=microstrategy.bones.rwb_viewer;H.docSelections=L.commands.queryState("selectionsKey");L.adjustScrollValues();H.viewerScroll=L.dScrollTop+","+L.dScrollLeft;H.isLocked=(L.insertionControlLocked)?1:0;var M=L.doc.currentControlSubtype?"|"+L.doc.currentControlSubtype:"";H.currentControl=L.doc.currentControl+M;}if(typeof (microstrategy)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){for(var A in microstrategy.bones){if(microstrategy.bones[A]!=null&&microstrategy.bones[A].type==microstrategy.OBJTYPE_GRID){var B=microstrategy.bones[A];if(B&&B.gridStructureInfo&&!B.gridStructureInfo.emptyCase&&!B.gridStructureInfo.isEmptyTemplate){if(B.isGrid){var K=B.commands.queryState("selections");if(K){H[B.id]=K;}}if(B.isGraph&&A.indexOf("_graph")==-1){H[B.id+"_gs"]=B.commands.queryState("graphSelections");}}}}}if(H.iframe=="true"){microstrategy.updateManager.submitPartialUpdate(H);}else{var J=UpdateHelper.createFormFromParams(H);UpdateHelper.appendPageSizeToParams(J);if(mstr.utils.ISSAFARI&&J.target=="_blank"){J.action+=(J.action.indexOf("?")==-1?"?":"&");J.action+="t="+new Date().getTime();}try{microstrategy.submitForm(J);}catch(D){if(J.target!=""&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){showMessage({contents:microstrategy.descriptors.getDescriptor("5877"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.errors.log(D);}}}return false;};UpdateHelper.createFormFromParams=function(A){var C=document.createElement("FORM");C.name="dynamic_form";C.method=A.method;delete A.method;C.action=A.action;delete A.action;if(typeof A.target!="undefined"){C.target=A.target;delete A.target;}C.setAttribute("hasUpdateChanges",A.hasUpdateChanges=="true");for(var D in A){if(A[D]){if(typeof A[D]=="object"){for(var B=0;B<A[D].length;B++){if(A[D][B]){createHiddenInput(C,D,A[D][B]);}}}else{createHiddenInput(C,D,A[D]);}}}document.body.insertAdjacentElement("beforeEnd",C);return C;};UpdateHelper.submitFormThroughXHR=function(B,D){if(D){if(!B){B=window.event;}var B=getEventTarget(B);if(!B){return false;}}var F=microstrategy.findAncestorWithTag(B,"FORM");var C=B.name;var A=B.value;if(typeof F=="undefined"||typeof C=="undefined"||typeof A=="undefined"){return false;}var E=UpdateHelper.createParamsFromForm(F,C,A,true);UpdateHelper.appendPageStateToParams(E);microstrategy.updateManager.submitPartialUpdate(E);return false;};UpdateHelper.appendPageStateToParams=function(A){var E=getObj("pageStateForm");var D=null;var B=(typeof (microstrategy)!="undefined")?microstrategy.updateManager:null;var C;if(B&&B.hasChangesToSubmit()){B.flushChangesAsParams(A);UpdateHelper.addEvtOrderToParams(A,mstrUpdateManager.multipleEventID);}if(E){if(A.method=="get"||A.method=="GET"){UpdateHelper.addURLToParams(A,pageState,true);}else{D=E.getElementsByTagName("INPUT");for(C=0;C<D.length;C++){A[D[C].name]=D[C].value;}}}};UpdateHelper.appendPageSizeToParams=function(A){createHiddenInput(A,"innerWidth",getClientWidth());createHiddenInput(A,"innerHeight",getClientHeight());};UpdateHelper.submitLink=function(F){var H;H=F.href;var C;C=F.target;var G=document.getElementById("cssAnalyzerToolbar");var A=(getCookie(ENABLE)=="true")&&(G!=null);if(A){return false;}window.mstrSubmitLink=true;if(C=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){var B=UpdateHelper.createParamsFromURL(H);if(C){B.target=C;}UpdateHelper.submitRequest(B);return false;}if(typeof (pageState)!="undefined"){var D=updateLink(H);D=moveAnchor(D);var E=null;if(bIsIE6&&F.childNodes&&(F.childNodes.length==1)&&F.childNodes[0].nodeType==3){E=F.innerHTML;}F.href=D;if(bIsIE6&&E!=null){F.innerHTML=E;}return true;}else{return true;}};UpdateHelper.addEvtOrderToParams=function(A,B,C){if(A.evtorder){if(A.evtorder.indexOf(B)<0){if(C){A.evtorder=A.evtorder+","+B;}else{A.evtorder=B+","+A.evtorder;}A[B]="1";}}else{A.evtorder=B;if(A.evt&&A.evt.length<3){for(j=0;j<A.evt.length;j++){A[A.evt[j]]="1";}}}};UpdateHelper.replaceComponents=function(A,G){try{if(!G){iframe.consolidatedStyles={};iframe.isProcessing=true;if(!bIsW3C){iframe.togglePulldownChildren(document.body,false);}}var C;for(C=0;C<A.length;C++){var F=A[C];if(F&&F.ISEMPTY!="true"){if(F.errBox!="true"||currentModalEditor.length==0){UpdateHelper.updateComponent(F,G);}else{var E=F.content;if(E.length>0){showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}}}}if(!G){for(var B in iframe.consolidatedStyles){updateStyleContainer(iframe.consolidatedStyles[B],B);}if(!bIsW3C){iframe.togglePulldownChildren(document.body,true);}iframe.targets=null;microstrategy.loadDynamicJS();microstrategy.registerNewBones();}}catch(D){microstrategy.errors.log(D);}};UpdateHelper.updateComponent=function(cB,parentId){try{var sReplaceHTML;var aScripts=null;var j;var oParentDiv;if(!cB.id){return ;}if(cB.components&&cB.components.length>1){UpdateHelper.replaceComponents(cB.components,cB.id);return ;}else{if(cB.components&&cB.components.length==1){return ;}}if(cB.slid){var slices=document.getElementsByName(cB.id);if(slices&&slices.length>0){for(var i=0,len=slices.length;i<len;i++){if(slices[i].getAttribute("slid")==cB.slid){oParentDiv=slices[i];break;}}}}if(!oParentDiv){var oParentDivs=document.getElementById(cB.id);if(!oParentDivs&&(cB.dialog||cB.css=="1")){iframe.createPlaceHolder(cB.id);oParentDivs=document.getElementById(cB.id);}if(oParentDivs){if(oParentDivs.length>1){for(var i=0;i<oParentDivs.length;i++){if(oParentDivs[i].tagName=="DIV"){oParentDiv=oParentDivs[i];break;}}}else{oParentDiv=oParentDivs;}}}if(oParentDiv){var sReplaceHTML=cB.content.replace(/'/g,"'");if(cB.message=="true"){showMessage({contents:sReplaceHTML,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}var scriptArray=[],chartArray=[];var oDivNode=iframe.createElementFromHTML(sReplaceHTML);if(!oDivNode){return ;}iframe.extractScript(oDivNode,scriptArray);iframe.extractImage(oDivNode,chartArray);if(cB.errorInfo){var errorHolder=document.getElementById("errorInfo");if(errorHolder){errorHolder.innerHTML+=cB.errorInfo;}}if(cB.css=="1"){var styleId=oDivNode.getAttribute("styleid");if(!iframe.consolidatedStyles[styleId]){iframe.consolidatedStyles[styleId]=[];}iframe.consolidatedStyles[styleId]=consolidateStyleSheets(oDivNode,iframe.consolidatedStyles[styleId],styleId);}else{if(oParentDiv.getAttribute(mstrHTMLAttributes.ATTR_MODAL)=="true"||(oParentDiv.popupMask)){togglePulldowns(oParentDiv,true);}if(cB.partialUpdate=="true"&&oParentDiv.childNodes.length>1){oParentDiv.innerHTML=oDivNode.innerHTML;}else{if(bIsW3C&&!bIsIE8&&!bIsIE9&&!bIsIE10&&!bIsSafari){iframe.setOuterHTML(oParentDiv,oDivNode);}else{if(oParentDiv&&oDivNode){if(cB.isFlashVis&&bIsIE8){var o=oParentDiv.getElementsByTagName("object");if(o&&o.length>0){for(var i=0;i<o.length;i++){o[i].parentNode.removeChild(o[i]);}}}oParentDiv.parentNode.replaceChild(oDivNode,oParentDiv);}if(chartArray.length>0){for(var j=0,cnt=chartArray.length;j<cnt;j++){chartArray[j].src=chartArray[j].getAttribute("dsrc");}}}}for(var i=0,len=scriptArray.length;i<len;i++){eval(scriptArray[i].toString());}}}}catch(err){microstrategy.errors.log(err);}};mstrSelectionsImpl.prototype={};mstrSelectionsImpl.prototype.length=0;mstrSelectionsImpl.prototype.path="";mstrSelectionsImpl.prototype.dragX=0;mstrSelectionsImpl.prototype.dragY=0;mstrSelectionsImpl.prototype.mousedownX=0;mstrSelectionsImpl.prototype.mousedownY=0;mstrSelectionsImpl.prototype.shiftKey=false;mstrSelectionsImpl.prototype.ctrlKey=false;mstrSelectionsImpl.prototype.clickedSrc=null;mstrSelectionsImpl.prototype.onload=function(A){};mstrSelectionsImpl.prototype.onmousedown=function(B){try{if(!B){B=window.event;}getMouse(B);this.mousedownX=lMouseX;this.mousedownY=lMouseY;}catch(A){microstrategy.errors.log(A);}};mstrSelectionsImpl.prototype.onmouseup=function(C,B){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener((B)?B:this,"mousemove");this.parentBone.detachWinListener((B)?B:this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.ondeselect=function(B){try{if(B.e){B=B.e;}this.onmouseup(B);if(this.clickedSrc!=null){this.remove(this.clickedSrc);}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.ondragstart=function(C){try{if(!C){C=window.event;}if(C.e){C=C.e;}getMouse(C);if(Math.abs(lMouseX-this.mousedownX)>=3||Math.abs(lMouseY-this.mousedownY)>=3){microstrategy.eventManager.onnotifydrag(this.items,this.parentBone,this.getDssTypes());var A=microstrategy.getEventHandlerString(this.path);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","ondrag");this.parentBone.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",A+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",A+" { return "+this.path+".ondragend(e); }");}this.ondrag(C);}}catch(B){microstrategy.errors.log(B);}return false;};mstrSelectionsImpl.prototype.ondrag=function(A){};mstrSelectionsImpl.prototype.ondragend=function(A){};mstrSelectionsImpl.prototype.add=function(B){try{this.items[B.getAttribute("id")]=B;this.length++;if(this.parentBone&&this.parentBone.onselectionchange){this.parentBone.onselectionchange();}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.remove=function(B){try{delete this.items[B.getAttribute("id")];this.length--;if(this.parentBone.onselectionchange){this.parentBone.onselectionchange();}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.clear=function(C,B){try{if(C==null){C=true;}this.items={};this.length=0;if(C&&this.parentBone&&this.parentBone.onselectionchange){this.parentBone.onselectionchange(B);}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.firstItem=function(){try{for(member in this.items){return this.items[member];break;}}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.isMulti=function(){try{return(this.length>1);}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.isSelected=function(B){try{return(typeof (this.items[B.getAttribute("id")])!="undefined");}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.isActive=function(){try{return(this.length>0);}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.getTypes=function(){try{var A=[];var B=0;for(var D in this.items){if(this.items[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)){A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_OBJTYPE)+"."+this.items[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}else{A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_OBJTYPE);}}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.isSameType=function(){try{var A=this.getDssTypes();A.sort(function(D,C){return parseInt(D)-parseInt(C);});return(A[0]==A[A.length-1]);}catch(B){microstrategy.errors.log(B);return null;}};mstrSelectionsImpl.prototype.isOnlyMetrics=function(){try{for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_METRIC&&this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_USER_METRIC&&this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_USER_SUMMARY_METRIC){return false;}}return true;}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getDssTypes=function(){try{var A=[];var B=0;for(var D in this.items){A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.getSelectedIds=function(){try{var C="|";for(var B in this.items){C+=B+"|";}return C;}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.getDataSetIDs=function(){try{var B=[];var C=0;for(var E in this.items){var A=new mstrObjectInfoImpl(this.items[E]);B[C++]=A.dSetId;}return B;}catch(D){microstrategy.errors.log(D);return null;}};mstrSelectionsImpl.prototype.getSelectionsKey=function(){try{var A=[];var B=0;for(var D in this.items){A[B++]=this.items[D].id;}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.getFirstObjSubType=function(){try{var A=null;var C=this.firstItem();if(C){A=C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrSelectionsImpl.prototype.getFirstObjType=function(){try{var A=null;var C=this.firstItem();if(C){A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrSelectionsImpl.prototype.getChildren=function(B){try{return B.parentNode.parentNode.lastChild.getElementsByTagName("span");}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getItems=function(){try{return mstr.utils.Arrays.fromHashValues(this.items);}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getInnerRect=function(D){try{var C=microstrategy.styleObj;var B={};B.left=getObjSumLeft(D);B.top=getObjSumTop(D);if(bIsIE6){B.right=B.left+getObjWidth(D);B.bottom=B.top+getObjHeight(D);}else{B.left+=D.clientLeft;B.top+=D.clientTop;B.right=B.left+C.getInnerWidth(D);B.bottom=B.top+C.getInnerHeight(D);}if(B.right<(B.left+1)){B.right=B.left+1;}if(B.bottom<(B.top+1)){B.bottom=B.top+1;}return B;}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getOuterRect=function(D,A){try{var C={};if(D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==null){C.left=getObjSumLeft(D);C.top=getObjSumTop(D);}else{C.left=getObjSumLeftScrolled(D);C.top=getObjSumTopScrolled(D,A);}C.right=Math.max(C.left+getObjWidth(D),C.left+1);C.bottom=Math.max(C.top+getObjHeight(D),C.top+1);return C;}catch(B){microstrategy.errors.log(B);return null;}};function mstrSelectionsImpl(A){this.items={};this.parentBone=A;return this;}mstrContextMenuManagerImpl.prototype=new Object();contextMenuManagerScript=true;mstrContextMenuManagerImpl.prototype.id=null;mstrContextMenuManagerImpl.prototype.dynamic_menus=new Array;mstrContextMenuManagerImpl.prototype.menu_items=new Array;microstrategy.contextMenuManagers=new Array;microstrategy.unloadContextMenuManager=function(B){for(var A=0;A<microstrategy.contextMenuManagers.length;A++){if(microstrategy.contextMenuManagers[A].id==B){microstrategy.contextMenuManagers.splice(A,1);}}};microstrategy.getContextMenuManager=function(B){for(var A=0;A<microstrategy.contextMenuManagers.length;A++){if(microstrategy.contextMenuManagers[A].id==B){return microstrategy.contextMenuManagers[A];}}var C=new mstrContextMenuManagerImpl(B);microstrategy.contextMenuManagers.push(C);return C;};mstrContextMenuManagerImpl.prototype.getMenu=function(D){var C,A;try{if(D){for(C=0;C<this.dynamic_menus.length;C++){if(this.dynamic_menus[C]!=null){if(this.dynamic_menus[C][0]==D){return new mstrContextMenuImpl(this.id,this.menu_items,this.dynamic_menus[C][1]);}}}}var B=this.dynamic_menus.length;this.dynamic_menus[B]=new Array;this.dynamic_menus[B][0]=D;this.dynamic_menus[B][1]=new Array;return new mstrContextMenuImpl(this.id,this.menu_items,this.dynamic_menus[B][1]);}catch(E){microstrategy.errors.log(E);return false;}};mstrContextMenuManagerImpl.prototype.findMenuItem=function(C,B){try{var A=new Array();if(B!=null){for(i=0;i<B.length;i++){if(this.menu_items[B[i]][0]==C){A.push(this.menu_items[B[i]]);}}}else{for(i=0;i<this.menu_items.length;i++){if(this.menu_items[i][0]==C){A.push(this.menu_items[i]);}}}return A;}catch(D){microstrategy.errors.log(D);return false;}};function mstrContextMenuManagerImpl(key){try{if(key){if(eval("(typeof("+key+") != 'undefined')")){this.menu_items=eval(key);}if(eval("(typeof("+key+"_dyn) != 'undefined')")){this.dynamic_menus=eval(key+"_dyn");}this.id=key;}return this;}catch(err){microstrategy.errors.log(err);return false;}}mstrDocSelectionsImpl.prototype=new mstrSelectionsImpl();mstrDocSelectionsImpl.prototype.resize=null;mstrDocSelectionsImpl.prototype.range=new Rect(null,null,null,null);mstrDocSelectionsImpl.prototype.handles={};mstrDocSelectionsImpl.prototype.hilites={};mstrDocSelectionsImpl.prototype.sections={};mstrDocSelectionsImpl.prototype.dragRectangles=null;mstrDocSelectionsImpl.prototype.objCache={copyBuffer:null,activeHilite:null,resizeStyle:null,hiLite:null,lineHiLite:null};mstrDocSelectionsImpl.prototype.marquee=null;mstrDocSelectionsImpl.prototype.marqueeConstrained=false;mstrDocSelectionsImpl.prototype.marqueeSingleClick=true;mstrDocSelectionsImpl.prototype.marqueeOrientation=mstrDocSelectionsImpl.MARQUEE_ORIENTATION_V;mstrDocSelectionsImpl.prototype.styleObj=null;mstrDocSelectionsImpl.prototype.path="";mstrDocSelectionsImpl.prototype.verifiedPath="";mstrDocSelectionsImpl.prototype.selectionOpacity=40;mstrDocSelectionsImpl.prototype.topBorderOffset=0;mstrDocSelectionsImpl.prototype.leftBorderOffset=0;mstrDocSelectionsImpl.prototype.savedZIndex=0;mstrDocSelectionsImpl.prototype.docViewer=null;mstrDocSelectionsImpl.prototype.isVisible=true;mstrDocSelectionsImpl.prototype.isSingleSelectionType=true;mstrDocSelectionsImpl.prototype.panelUnitFormat=0;mstrDocSelectionsImpl.prototype.panelValueFormat=0;mstrDocSelectionsImpl.prototype.controlUnitFormat=0;mstrDocSelectionsImpl.prototype.controlValueFormat=0;mstrDocSelectionsImpl.prototype.allGridUnitFormat=microstrategy.GRID_UNIT_CONTAINER;mstrDocSelectionsImpl.prototype.allGridValueFormat=5;mstrDocSelectionsImpl.prototype.gridUnitFormat=microstrategy.GRID_OTHER;mstrDocSelectionsImpl.prototype.gridValueFormat=5;mstrDocSelectionsImpl.prototype.gridUnitFormatX=microstrategy.GRID_UNIT_CONTAINER;mstrDocSelectionsImpl.prototype.gridValueFormatX=1;mstrDocSelectionsImpl.prototype.addingCtrl=null;mstrDocSelectionsImpl.MARQUEE_ORIENTATION_V=1;mstrDocSelectionsImpl.MARQUEE_ORIENTATION_H=2;mstrDocSelectionsImpl.NOBORDERS=0;mstrDocSelectionsImpl.TOPBORDER=1;mstrDocSelectionsImpl.BOTTOMBORDER=2;mstrDocSelectionsImpl.LEFTBORDER=4;mstrDocSelectionsImpl.RIGHTBORDER=8;mstrDocSelectionsImpl.ALLBORDERS=16;mstrDocSelectionsImpl.DEFAULT_LINE_COLOR="#000000";mstrDocSelectionsImpl.DEFAULT_LINE_STYLE="solid";mstrDocSelectionsImpl.DEFAULT_LINE_WIDTH="1pt";mstrDocSelectionsImpl.TCF={font:"ff",BoldItalic:["fb","fi"],fsize:"fs",TextUnderline:"ful",TextStrikeout:"fso",color:"fc",FillColor:"bgc",ShapeSettingStyle:"bs",LineSettingColor:"bc",LineSettingWeight:"bw"};mstrDocSelectionsImpl.prototype.onload=function(F){try{var C=this.parentBone;this.docViewer=C.parentBone;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.elem.onmousedown=new Function("e",this.verifiedPath+" { return "+this.path+".onmousedown(e); }");this.elem.onclick=new Function("e",this.verifiedPath+" { return "+this.path+".onclick(e); }");var E=(this.firstItem()!=null);if(E){this.onreload(F);}this.resize=new mstrResizeDocObjs();this.resize.onload(this,this.path+".resize");this.styleObj=C.styleObj;this.initCopyBuffer();var G=function(I){var J=parseFloat(C.elem.style["border"+I+"Width"]);if(isNaN(J)){return 0;}return Math.round(J*microstrategy.DPI_CONVERSION/72);};this.topBorderOffset=G("Top");this.leftBorderOffset=G("Left");var H=document.createElement("div");H.className="mstrMarquee";H.style.position="absolute";H.style.display="none";var B=document.createElement("span");B.className="mstrMarqueeWhite";H.appendChild(B);var A=document.createElement("span");A.className="mstrMarqueeBlack";H.appendChild(A);document.body.appendChild(H);this.marquee=H;this.dragRectangles=microstrategy.objectFind(C.elem,"div",microstrategy.OBJTYPE_DSEL_MOVE_RECS);return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocSelectionsImpl.prototype.onreload=function(B){try{this.clear(true);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isFeatureAvailable=function(B){try{return this.docViewer.isFeatureAvailable(B);}catch(A){microstrategy.errors.log(A);}return true;};mstrDocSelectionsImpl.prototype.isScrollOrHyperlink=function(C,B){try{if(!B||B.onscroll!=null){return true;}var D=function(E){return E.tagName.toLowerCase()=="a"&&((E.href!=null&&E.href!="")||(E.getAttribute("href")!=null&&E.getAttribute("href")!=""));};return(C.button!=2&&(D(B)||D(B.parentNode)));}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isTableControl=function(C){try{var B=microstrategy.findBone(C);return B&&B.isTable;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.onmousedown=function(O){try{microstrategy.hidePopups(null,O);if(window.mstrButton){mstrButton.syncEditHighlight(O);}O=O||window.event;var M=getEventTarget(O);try{if(!M||!M.tagName){return true;}}catch(E){O.cancelBubble=true;return true;}if(this.isScrollOrHyperlink(O,M)){return true;}if(M.getAttribute(microstrategy.HTMLATTR_ID)&&M.getAttribute(microstrategy.HTMLATTR_ID).indexOf("MstrFlash")==0||M.attributes.getNamedItem("type")&&M.attributes.getNamedItem("type").value.indexOf("flash")>-1){return true;}if(microstrategy.subObjectType(M)=="shw"&&M.nextSibling){M=M.nextSibling;}mstrSelectionsImpl.prototype.onmousedown.call(this,O);this.mousedownScrollLeft=this.docViewer.elem.scrollLeft;this.mousedownScrollTop=this.docViewer.elem.scrollTop;this.lastMouseX=this.mousedownX;this.lastMouseY=this.mousedownY;var D=microstrategy.findAncestor(M);if(D&&D.tagName.toLowerCase()=="img"){D=microstrategy.findAncestor(D.parentNode);}var N=(microstrategy.objectType(D)==microstrategy.OBJTYPE_FLOATING_TOOLBAR);var B,J;if(D){var H=microstrategy.subObjectType(D);if(N){J=microstrategy.bone(M.getAttribute("targetBoneId")).activeRWUnit;}else{if(H==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||H==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){B=microstrategy.findRWObjectBone(M);if(B){J=B.activeRWUnit;}}else{if(H==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){B=microstrategy.findRWObjectBone(D,"mstrGridRW")||microstrategy.findRWObjectBone(D,"mstrReportGraphImpl");if(B){if((microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE)&&!B.boneSelected&&B.sibBoneSelected&&B.sibBoneSelected()){return true;}J=B.activeRWUnit;}}}}}var A=microstrategy.eventManager;var F=A.getSource(O,J);var L=microstrategy.getContextMenuManager("RWM").getMenu("rw_context_menu");var R=this.path+".getTypes()";var P=this.parentBone.currentControl;var Q=F.bone&&F.bone.isTable;switch(F.type){case microstrategy.OBJTYPE_DOC_SELECTION:if(P!="cursor"){return true;}if(microstrategy.subObjectType(M)==microstrategy.SUBOBJTYPE_SEL_HANDLE&&P=="cursor"){if(this.getSelectedGrid()==null||(this.getPortalGridWithProperty(microstrategy.WINDOW_STATE_MAXIMIXED)==null&&this.getPortalGridWithProperty(microstrategy.WINDOW_STATE_MINIMIZED)==null)){this.objCache.activeHilite=M.parentNode;var C=M.className+"-resize";var K=C.slice(0,C.indexOf("-"));if(typeof (mstr)!="undefined"){this.activeHandle=K;this.parentBone.attachWinListener(this,"mousemove","onresizestart");this.parentBone.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".resize.onresizestart(e, '"+K+"'); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}}break;}L.registerTrigger(F.elem,R);F=A.getSource(O,M.src);case microstrategy.OBJTYPE_DOC_OBJECT:if(P=="cursor"){if(F.button!=1){this.addToSelection(O.ctrlKey,F.elem);if(!N&&Q){return true;}if(bIsW3C&&microstrategy.subObjectType(F.elem)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){this.elem.style.zIndex=1;}L.registerTrigger(document.getElementById("hilite"+F.id),R);L.registerTrigger(F.elem,R);if(N){L.registerTrigger(D,R);}return false;}var G=this.getHyperLink(F);if(G!=null&&G.length>0){return false;}var I=N||(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)||(F.subType!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)||(F.subType==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&(D==M||M.getAttribute("scriptclass")));if(I){this.addToSelection(O.ctrlKey,F.elem);if(Q&&!N){return true;}if(!this.isLocked(F.elem)&&this.isActive()&&this.docViewer.isEditableViewModeEplus()){this.clickedSrc=F.elem;if(N||F.subType!=microstrategy.SUBOBJTYPE_DOC_TEMPLATE||!(F.bone&&F.bone.isGraph)){if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","ondragstart");this.parentBone.attachWinListener(this,"mouseup","onmouseup",false);}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondragstart(e); }");if(document.onmouseup==null){document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}}}}}if(F.subType==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||mstr.utils.ISIE9&&F.subType==microstrategy.SUBOBJTYPE_DOC_TEXT||(Q&&N)){return true;}else{O.cancelBubble=true;mstr.controllers.EventManager.notifyWindowListeners({name:"closeMenus"});return false;}}case microstrategy.OBJTYPE_DOC_SUBSECTION:this.activeSubsection=(F.type!=microstrategy.OBJTYPE_DOC_SUBSECTION)?microstrategy.findAncestor(F.elem.parentNode):A.getSource(O).elem;if(F.button!=1){L.registerTrigger(this.activeSubsection,R);}this.marqueeConstrained=this.marqueeSingleClick=false;if(mstr.behaviors.featureResolver.featAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS)){if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","onlassostart");this.parentBone.attachWinListener(this,"mouseup","onlassoabort");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".onlassostart(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onlassoabort(e); }");}}return false;break;case microstrategy.OBJTYPE_RULER:if(P=="cursor"){this.activeSubsection=null;this.marqueeConstrained=this.marqueeSingleClick=true;this.marqueeOrientation=(F.subType==microstrategy.SUBOBJTYPE_VRULER)?mstrDocSelectionsImpl.MARQUEE_ORIENTATION_V:mstrDocSelectionsImpl.MARQUEE_ORIENTATION_H;this.onlassostart(O);return false;}break;default:if(mstrGridStatic.isMouseOverScrollBar(M,this.mousedownX,this.mousedownY)){return true;}}return(!bIsW3C);}catch(E){microstrategy.errors.log(E);return false;}};mstrDocSelectionsImpl.prototype.onmouseup=function(C,B){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener((B)?B:this,"mousemove");this.parentBone.detachWinListener((B)?B:this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}this.hideGuidelines();}catch(A){microstrategy.errors.log(A);}return false;};mstrDocSelectionsImpl.prototype.getSnapThreshold=function(B){try{return this.getNotUseSnap(B)?5:microstrategy.SNAP_SIZE;}catch(A){microstrategy.errors.log(A);}};mstrDocSelectionsImpl.prototype.getMouseDirection=function(){try{var B=lMouseX-this.lastMouseX,A=lMouseY-this.lastMouseY;this.mouseDir={x:B>0?1:(B<0?-1:1),y:A>0?1:(A<0?-1:1)};this.lastMouseX=lMouseX;this.lastMouseY=lMouseY;return this.mouseDir;}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.getSubSecBone=function(B){try{var A=null;if(B){if(B.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){A=microstrategy.findBone(B.parentNode);}else{A=microstrategy.findBone(B);}}else{var D=this.parentBone.parentBone.commands.queryState("selectedSection");if(D){A=microstrategy.findBone(D);}}return A;}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.syncPositionMap=function(){try{var B=this.items;for(var E in B){var D=B[E];var A=this.getSubSecBone(D);A&&A.syncPositionMap(D);}}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.hideGuidelines=function(){try{var B=this.items;for(var E in B){var D=B[E];var A=this.getSubSecBone(D);A&&A.hideGuidelines();}}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.onresizestart=function(A){this.parentBone.detachWinListener(this,"mousemove");this.resetObjectFormatLevel();this.docViewer.isDragging=true;return this.resize.onresizestart(A,this.activeHandle);};mstrDocSelectionsImpl.prototype.onclick=function(E){try{E=E||window.event;var G=getEventTarget(E);var B=G&&G.tagName.toLowerCase();if(B==="select"||B==="textarea"||B==="input"){return true;}if(this.isScrollOrHyperlink(E,G)){return true;}var A=this.parentBone.currentControl;var F=microstrategy.eventManager.getSource(E);switch(F.type){case microstrategy.OBJTYPE_DOC_SELECTION:if(A!="cursor"){return true;}F=microstrategy.eventManager.getSource(E,G.src);case microstrategy.OBJTYPE_DOC_OBJECT:if(A=="cursor"){if(F.button>1){return true;}var D=this.getHyperLink(F);if(D!=null&&D.length>0){try{if(!E.shiftKey&&this.styleObj.getAttValue(F.elem,microstrategy.HTMLATTR_NEW_WINDOW)==microstrategy.FALSE){window.location=D;}else{window.open(D);}}catch(C){if(D.length<=2082){microstrategy.errors.log(C);}else{showMessage({contents:microstrategy.descriptors.getDescriptor("4420"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}}}return(F.subType==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);}default:if(typeof (mstrGridStatic)!="undefined"&&mstrGridStatic.isMouseOverScrollBar(G,this.mousedownX,this.mousedownY)){return true;}}return(!bIsW3C);}catch(C){microstrategy.errors.log(C);return true;}};mstrDocSelectionsImpl.prototype.onnotifydrag=function(A,C,B){this.savedZIndex=this.elem.style.zIndex;this.elem.style.zIndex=1;};mstrDocSelectionsImpl.prototype.onnotifydragend=function(A){this.elem.style.zIndex=this.savedZIndex;};mstrDocSelectionsImpl.prototype.isLocked=function(B){try{return this.styleObj.getAttValue(B,microstrategy.HTMLATTR_LOCKED)==microstrategy.TRUE;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.onpanelchange=function(){try{if(!this.isActive()){return ;}if(!isInDocument(this.firstItem())){this.clear();return ;}var E=this.firstItem();if(!E||!E.parentNode){return ;}var C=microstrategy.findAncestor(E.parentNode);if(!C||!C.parentNode){return ;}var D=microstrategy.findAncestor(C.parentNode);if(!D||microstrategy.subObjectType(D)!=microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){return ;}var A=microstrategy.findBone(C.parentNode).isPanelCurrent(C.getAttribute("id"));if(this.isVisible!=A){this.isVisible=A;this.elem.style.display=(A)?"block":"none";if(this.docViewer.observer){this.docViewer.delay("observer.notifyAll('onselectionchange')");}}microstrategy.eventManager.notifyOrphanBones("onbone"+((A)?"":"de")+"selected",this.getSelectedIds());}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.getHyperLink=function(F){try{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){return"";}var E=(this.styleObj.getAttValue(F.elem,microstrategy.HTMLATTR_IS_LINK)==microstrategy.TRUE);if(E){var C=this.styleObj.getAttValue(F.elem,microstrategy.HTMLATTR_LINK_HREFVALUE);if((C==null||C.length==0)&&microstrategy.subObjectType(F.elem)==microstrategy.SUBOBJTYPE_DOC_TEXT){var D=decode(this.styleObj.getAttValue(F.elem,microstrategy.HTMLATTR_DSS_FORMULA));var B=D&&D.match(/href="([^"]+)"/i);C=B&&B[1];}return C;}}catch(A){microstrategy.errors.log(A);}return"";};mstrDocSelectionsImpl.prototype.addToSelection=function(B,E){try{if(microstrategy.subObjectType(E)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var D=microstrategy.findBone(E);if(D){D.gridUnitFormat=microstrategy.GRID_UNIT_CONTAINER;this.gridUnitFormatX=microstrategy.GRID_UNIT_CONTAINER;if(D.isGridInCellSelectionMode&&D.isGridInCellSelectionMode()){D.selections.clearAll(true);}}}if(this.isSelected(E)){if(B){if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mouseup","ondeselect");}else{document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondeselect(e); }");}return ;}else{this.hiliteSelected(E);}}else{if(!B||(this.isActive()&&this.firstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION)){this.clear(true);this.add(E);}else{if(this.isActive()){var A=this.processAddToSelections(E);if(A){this.add(A);}}else{this.add(E);}this.onpanelchange();}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.getPeerSubsection=function(B,D){try{var A=microstrategy.findBone(B.elem.parentNode);if(A==null||(A.type!=microstrategy.OBJTYPE_PANEL_STACK&&A.type!=microstrategy.OBJTYPE_DOC_SUBSECTION)){return null;}else{if(A.id==D){return B;}else{return this.getPeerSubsection(A,D);}}}catch(C){microstrategy.errors.log(C);return null;}};mstrDocSelectionsImpl.prototype.performDrill=function(C,D){try{for(var B in this.items){if(D){window.open(C);}else{window.location=C;}}}catch(A){microstrategy.errors.log(A);}};mstrDocSelectionsImpl.prototype.initEventObject=function(C,A){try{C=C||window.event;if(C.e){C=C.e;}if(A){getMouse(C);}return C;}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.ondragstart=function(F){try{F=this.initEventObject(F,true);for(var E in this.items){var D=this.items[E];var A=microstrategy.findBone(D);if(A&&A.isFilterPanel){A.secIdBeforeDrag=D.parentNode.parentNode.parentNode.id;}}if(this.getPortalGridWithProperty(microstrategy.WINDOW_STATE_MAXIMIXED)!=null){return ;}if(lMouseX==this.mousedownX&&lMouseY==this.mousedownY){return ;}this.docViewer.isDragging=true;this.buildDragRectangles();var B=this.parentBone;if(typeof (mstr)!="undefined"){B.attachWinListener(this,"mousemove","ondrag");B.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondragend(e); }");}microstrategy.eventManager.onnotifydrag(this.items,B,this.getDssTypes());B.parentBone.turnOnRulerShade(this.range);this.bubbleMouseMoves=false;if(bIsIE6){var G=getEventTarget(F);if(G&&G.tagName&&(G.tagName.toLowerCase()=="img")){this.bubbleMouseMoves=true;this.mouseoverMask=null;}}this.ondrag(F);}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.getNotUseSnap=function(A){return(A&&A.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF;};mstrDocSelectionsImpl.prototype.ondrag=function(U){try{if(bIsIE4&&getButtonId(U)==0){this.ondragend(U);}U=this.initEventObject(U,true);var S=getEventTarget(U);if(this.bubbleMouseMoves){var T=this.mouseoverMask;if(T&&(T!=S)&&T.onmouseout){T.onmouseout(U);}if(S&&S.onmouseover){S.onmouseover(U);this.mouseoverMask=S;}}var G=microstrategy.eventManager.source;var B=this.parentBone;var O=this.dragRectangles;var J=O.firstChild;var M=this.range;var N=this.getNotUseSnap(U);var H=function(Z){O.style.left=0;O.style.top=0;B.parentBone.dragRulerShade(M.left+B.left,Z,M);};if(!S.getAttribute||lMouseX<B.left||lMouseX>B.left+getObjWidth(B.dockMask)){H((this.isSameSubSection())?M.top+B.top:-10000);return false;}var K=S.getAttribute&&S.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT);if(K){var V=microstrategy.findBone(document.getElementById(K));M.offsetSection=V;if(bIsIE6&&V.isDetails){var W=","+this.getTypes().toString()+",";if(W.contains(microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE,",")||W.contains(microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK,",")){B.elem.style.cursor="not-allowed";}}}var P=S.id||K;var D=getObjSumTop(M.offsetSection.elem);var R=lMouseX-G.mousedownX;var L=M.top+B.top-D;this.getMouseDirection();var X=M.offsetSection;var E=function(c,e,k){var d=this.mouseDir[k],Z=c.style,f=k=="x"?"left":"top";if(X.canShowGuideline()){var h=X["guidelineOffset"+k.toUpperCase()],g=this.getSnapThreshold();if(Math.abs(h)<g&&(h!=0&&(h>0&&d<0||h<0&&d>0))){h*=d*(h>0&&d<0?1:-1);h+=(N?(d*(h>0&&d<0?1:-1)):0);e=e+h;Z[f]=e+"px";return ;}}var a=parseInt(Z[f])||0;if(d<0&&e<a||d>0&&e>a){Z[f]=e+"px";}};if(R!=0&&(this.isSameSubSection()||!this.hasHorizSections())){var Y=0;if(B.containsHorizontalSections&&S&&S.getAttribute(microstrategy.HTMLATTR_POINTS_TO)){var Q=S.getAttribute(microstrategy.HTMLATTR_POINTS_TO).split("|");var A=B.getSubMaskBone(Q[0],Q[1],0);if(A&&A.maskedBone!=null){Y=getObjSumLeft(A.maskedBone.elem)-B.left;}}if(R<-M.left+this.leftBorderOffset){R=-M.left+this.leftBorderOffset;}else{R=microstrategy.snapCoordinate(R+(M.left+this.leftBorderOffset-Y),0,!N);}R=Math.max(R,0);var C=R-(M.left+this.leftBorderOffset-Y);E.call(this,O,C,"x");}else{R=M.left+B.left-getObjSumLeft(M.offsetSection.elem);}if((lMouseY-G.mousedownY)!=0&&(this.isSameSubSection()||this.hasHorizSections(true))){L=(lMouseY-G.mousedownY);if(lMouseY<B.top||lMouseY>B.top+getObjHeight(B.dockMask)){H(M.top+B.top);return false;}if(L<-M.top){L=-M.top;}else{L=microstrategy.snapCoordinate((M.top+L-(D-B.top)),0,!N);}L=Math.max(L,0);var I=L-(M.top-(D-B.top));E.call(this,O,I,"y");}B.parentBone.dragRulerShade(R+B.left,L+D,M);X.showGuidelines(X.getLocalPosition(O.firstChild));}catch(F){microstrategy.errors.log(F);}return false;};mstrDocSelectionsImpl.prototype.ondragend=function(G){try{G=this.initEventObject(G,true);this.onmouseup(G);var J=this.parentBone;J.elem.style.cursor="default";var B=getEventTarget(G);var M=microstrategy.boneForMask(microstrategy.findAncestor(B));if(M){var K=M.elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(K==microstrategy.OBJTYPE_OBJBROWSER){J.promptDeleteItems(this.items,true);}else{if(K==microstrategy.OBJTYPE_DOC_SUBSECTION){if(M.isFilterPanel){this.moveItemsToFP(B);}else{this.moveItems(B);}}}}else{if(bIsW3C&&!bIsIE4){var P=J.getMaskFromPoint(lMouseX,lMouseY);if(P!=null){this.moveItems(P.firstChild);}else{if(microstrategy.isObjectBrowserOpen()){M=microstrategy.getObjectBrowser();if(M!=null){if(microstrategy.doRectsIntersect(new Rect(lMouseY,lMouseX+1,lMouseY+1,lMouseX),microstrategy.getRect(M.elem))){J.promptDeleteItems(this.items,true);}}}}}}var E=this.dragRectangles;E.style.zIndex=-1;mstr.$D.clearChilds(E);E.style.left=0;E.style.top=0;this.onmoveend();microstrategy.eventManager.notifyOrphanBones("onnotifydragend",J);for(var O in this.items){var D=this.items[O];var I=microstrategy.findBone(D);if(I&&I.isFilterPanel){var N=D.parentNode.parentNode.parentNode.id;if(N!=I.secIdBeforeDrag){var H=J.docMaskCollection;var L=I.panels;for(var C in L){var A=L[C].id;if(H[I.secIdBeforeDrag]&&H[I.secIdBeforeDrag][A]){if(!H[N]){H[N]={};}H[N][A]=H[I.secIdBeforeDrag][A];delete H[I.secIdBeforeDrag][A];}}}}}this.docViewer.isDragging=false;this.syncPositionMap(this.items);}catch(F){microstrategy.errors.log(F);}return false;};mstrDocSelectionsImpl.prototype.hiliteLine=function(B,D,A){try{B.style.border="0";B.style["border"+((this.styleObj.getAttValue(D,microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_VERTICAL)?"Left":"Top")]=A;}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.toggleHiliteBorders=function(D){try{var B=0;var E=-2;if(D){B=1;E=2;}B+="px dashed #000000";for(var F in this.hilites){var A=this.hilites[F].getDefault();if(microstrategy.subObjectType(A.src)==microstrategy.SUBOBJTYPE_DOC_LINE){this.hiliteLine(A,A.src,B);}else{A.style.border=B;A.style.width=Math.max(1,parseInt(A.style.width)-E)+"px";A.style.height=Math.max(1,parseInt(A.style.height)-E)+"px";A.style.visibility=D?"visible":"";this.hilites[F].syncHandles(D);}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.buildDragRectangles=function(){try{var F=function(J){return parseInt(C.getAttribute("o"+J)||0,10);};var I="mstrMarquee";for(var B in this.hilites){var C=this.hilites[B].getDefault();if(C){var A=C.src;if(this.isLocked(A)){continue;}var D=document.createElement("div");D.className=I;D.style.left=C.style.left;D.style.top=C.style.top;var H=document.createElement("span");H.className=I+"White";D.appendChild(H);var G=document.createElement("span");G.className=I+"Black";D.appendChild(G);this.resizeMarquee(D,F("Height"),F("Width"));this.dragRectangles.appendChild(D);}}this.dragRectangles.style.zIndex=50;}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.onmoveend=function(){if(this.docViewer.rulerShadeOn){this.docViewer.turnOffRulerShade();}};mstrDocSelectionsImpl.prototype.onlassoabort=function(H){try{H=this.initEventObject(H,true);this.onmouseup(H);if(this.parentBone.currentControl!="cursor"){var G=this,E=this.parentBone,D=function(){if(E.currentControl!="cursor"){G.addCtrl(new Rect(lMouseY-2,null,null,lMouseX-2),(H.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF);}};if((!window.mstrmojo||!mstrmojo.platform.TableControl)&&E.currentControl==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&E.currentControlSubtype=="TC"){microstrategy.mojoLoader.loadWidget({bundle:"mojo-tc.js",callback:function(){D();}});}else{D();}}else{var C=microstrategy.findAncestor(this.activeSubsection.parentNode);var A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(A==microstrategy.OBJTYPE_DOC_SUBSECTION_CONTAINER){this.addSubSection(this.activeSubsection);}else{if(A==microstrategy.OBJTYPE_DOC_OBJECT){var B=microstrategy.getRegisteredAncestor(C);if(B.activeRWUnit){C=B.activeRWUnit;}this.addToSelection(H.ctrlKey,C);}}}}catch(F){microstrategy.errors.log(F);}return false;};mstrDocSelectionsImpl.prototype.constrainMarquee=function(C){try{var A=this.docViewer.elem;if(this.marqueeOrientation==mstrDocSelectionsImpl.MARQUEE_ORIENTATION_V){C.left=getObjSumLeftScrolled(A);C.right=C.top+getObjWidth(A);}else{C.top=getObjSumTopScrolled(A);C.bottom=C.top+getObjHeight(A);}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.onlassostart=function(F){try{F=this.initEventObject(F,true);var A=this.mousedownX;var G=this.mousedownY;if(!this.marqueeConstrained&&Math.abs(lMouseX-A)<=3&Math.abs(lMouseY-G)<=3){return false;}var D=1,B=1;if(this.marqueeConstrained){var C=new Rect(G,A+B,G+D,A);this.constrainMarquee(C);A=C.left;G=C.top;B=C.right-A;D=C.bottom-G;this.docViewer.turnOnRulerShade(C);}this.resizeMarquee(this.marquee,D,B);this.marquee.style.left=A+"px";this.marquee.style.top=G+"px";this.marquee.style.visibility="hidden";this.marquee.style.display="block";if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","onlasso");this.parentBone.attachWinListener(this,"mouseup","onlassoend");}else{document.onmousemove=new Function("e",'return microstrategy.bone("'+this.docViewer.id+'").doc.selections.onlasso(e);');document.onmouseup=new Function("e",'return microstrategy.bone("'+this.docViewer.id+'").doc.selections.onlassoend(e);');}}catch(E){microstrategy.errors.log(E);}return false;};mstrDocSelectionsImpl.prototype.onlassomarquee=function(L){try{var C=this.marquee;C.style.visibility="visible";var P=lMouseX;var N=lMouseY;var D=this.mousedownX;var O=this.mousedownY;var K=D;var I=O;var H=N-O;var Q=P-D;if(Q<0){D=P;Q=Math.abs(Q);}if(H<0){O=N;H=Math.abs(H);}var A=this.parentBone.currentControl;if(this.marqueeConstrained){var G=new Rect(O,D+Q,O+H,D);this.constrainMarquee(G);D=G.left;O=G.top;Q=G.right-D;H=G.bottom-O;this.docViewer.dragRulerShade(G.left,G.top,G);this.marqueeSingleClick=false;}else{if(A==microstrategy.SUBOBJTYPE_DOC_LINE){C.style.border="";if(Q>=H){O=I;H=1;}else{D=K;Q=1;}}}var J=this;var B=function(R){return window["getObjSum"+R](J.activeSubsection)-J.docViewer.elem["scroll"+R];};if(A!="cursor"){var F=B("Top");if(O<F){H=Math.max(H-F+O,1);O=F;}var M=B("Left");if(D<M){Q=Math.max(Q-M+D,1);D=M;}}C.style.left=D+"px";C.style.top=O+"px";this.resizeMarquee(C,H,Q);}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.onlasso=function(B){try{B=this.initEventObject(B,true);this.onlassomarquee(B);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mouseup","onlassoend");}else{document.onmouseup=new Function("e","return microstrategy.bone('"+this.docViewer.id+"').doc.selections.onlassoend(e);");}}catch(A){microstrategy.errors.log(A);}return false;};mstrDocSelectionsImpl.prototype.onlassoend=function(H){try{H=this.initEventObject(H,true);this.onmouseup(H);if(mstr.utils.ISIE8&&this.marquee.style.height=="1px"&&this.marquee.style.width=="1px"){this.onlassomarquee(H);}if(this.marqueeConstrained){this.docViewer.turnOffRulerShade();}var J=this.getOuterRect(this.marquee),L=this.parentBone;if(L.currentControl!="cursor"){var I=this,K=function(){I.addCtrl(J,I.getNotUseSnap(H));I.marquee.style.display="none";};if((!window.mstrmojo||!mstrmojo.platform.TableControl)&&L.currentControl==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&L.currentControlSubtype=="TC"){microstrategy.mojoLoader.loadWidget({bundle:"mojo-tc.js",callback:K});}else{K();}}else{if(!H.ctrlKey){this.clear();}var F=[];var B=microstrategy[(this.marqueeSingleClick||microstrategy.MARQUEE_STYLE==microstrategy.MARQUEE_STYLE_PARTIAL)?"doRectsIntersect":"isRectInRect"];var D=microstrategy.findBone(this.activeSubsection);var P=(D&&D.subsectionType==mstrSubSection.TYPE_PANEL);var M=(this.isActive()&&microstrategy.findBone(this.firstItem().parentNode));if(M&&M.subsectionType==mstrSubSection.TYPE_PANEL){M.marqueeSelect(F,J,B);}else{if(P&&(!this.isActive()||this.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION)){D.marqueeSelect(F,J,B);}else{var G=this.parentBone.sections;for(var O in G){for(var A in G[O].subsections){var N=G[O].subsections[A];if(N.subsectionType==mstrSubSection.TYPE_FIXED){N.marqueeSelect(F,J,B);}}}}}if(F.length>0){for(var E=0;E<F.length;E++){this[(H.ctrlKey&&this.isSelected(F[E]))?"remove":"add"](F[E]);}}else{if(!this.marqueeConstrained&&!this.isActive()&&!P){this.addSubSection(this.activeSubsection);}}this.marquee.style.display="none";}}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.addCtrl=function(G,F){var K=(this.parentBone.currentControl==microstrategy.GRAPH_CTL);var H=this.parentBone;var D=microstrategy.updateManager;var J;var C=microstrategy.hasAppliedTheme(this.activeSubsection),A=this.parentBone.currentControl,E=(A==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||A==microstrategy.SUBOBJTYPE_DOC_TEXT||A==microstrategy.SUBOBJTYPE_DOC_IMAGE||A==microstrategy.SUBOBJTYPE_DOC_LINE||A==microstrategy.SUBOBJTYPE_DOC_SHAPE||microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);if(!C&&E){var B=this.activeSubsection&&this.activeSubsection.getAttribute("fgKey");if(B&&H.formattingAttributes[B]&&H.formattingAttributes[B]["thmid"]){C=true;}}this.flush=K||(A==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE)||C||(A==microstrategy.SUBOBJTYPE_DOC_IMAGE);var I=microstrategy.findBone(this.activeSubsection);if(I&&I.isFilterPanel){J=H.addCtrl(null,this.activeSubsection,[],null,null,null,true);}else{J=H.addCtrl(G,this.activeSubsection,[],null,null,null,F);}if(J){J=this.finishAdd(this.activeSubsection.lastChild,J);if(J.length>0){D.add(J);}if(K||C||A==microstrategy.SUBOBJTYPE_DOC_IMAGE){D.add([D.createActionObject(H.elem,mstrUpdateManager.APPLY_CHANGES,H.parentBone.beanPath,[],[],[])]);}if(this.flush){D.flushAndSubmitChanges();this.flush=false;}}};mstrDocSelectionsImpl.prototype.getActiveSectionIndex=function(B){try{var A=microstrategy.findAncestorWithAtt(B,"scriptclass","mstrFixedPanel");var D=A&&A.getAttribute("sn");if(D){return D;}}catch(C){microstrategy.errors.log(C);}return null;};mstrDocSelectionsImpl.prototype.resizeMarquee=function(E,D,A){try{E.style.height=D+"px";E.style.width=A+"px";var C=function(H,G){E.childNodes[B].style[H]=(Math.max(G-3,1))+"px";};for(var B=0;B<2;B++){C("height",D);C("width",A);}}catch(F){microstrategy.errors.log(F);}};mstrDocSelectionsImpl.prototype.sizeToGrid=function(){try{var I=[];var C=microstrategy.updateManager;var G=false;var F=this.parentBone;var E=function(K,L){return microstrategy.snapCoordinate(K,L,true);};for(var A in this.items){var J=this.items[A];if(this.isLocked(J)){continue;}var D=new RectObj(J);var H=getObjSumTop(J.parentNode)-F.top;D.setBase(F.left+this.leftBorderOffset,F.top);D.left=E(D.left,0);D.top=E(D.top,H);D.right=E(D.right,0);D.bottom=E(D.bottom,H);D.height=D.bottom-D.top;D.width=D.right-D.left;if(this.resize.resizeItem(J,D,I,microstrategy.WIDTH_AND_HEIGHT_UPDATE)){G=true;}}this.resizeSubSection(false,I);this.resetRange(false,I);if(I&&I.length>0){C.add(I);if(G){C.flushAndSubmitChanges();}}this.syncUp();return true;}catch(B){microstrategy.errors.log(B);return true;}};mstrDocSelectionsImpl.prototype.getEmptyCopyBuffer=function(){return{items:{},parentIds:{},offsets:{},length:0};};mstrDocSelectionsImpl.prototype.initCopyBuffer=function(){try{var cb=document.getElementById("clipboard");if(cb){var buf=this.getEmptyCopyBuffer();eval("buf.offsets = "+cb.getAttribute("offset"));for(var sec in buf.offsets){buf.offsets[sec]=parseInt(buf.offsets[sec])*microstrategy.SNAP_SIZE;}eval("buf.parentIds = "+cb.getAttribute("pk"));for(var i=0,cnt=cb.childNodes.length;i<cnt;i++){var c=cb.childNodes[i];buf.items[c.getAttribute("id")]=c.cloneNode(true);buf.length++;}this.objCache.copyBuffer=buf;}}catch(err){microstrategy.errors.log(err);}};mstrDocSelectionsImpl.prototype.copyToClipboard=function(H){try{var A="";if(this.isActive()&&this.firstObjType()==microstrategy.OBJTYPE_DOC_OBJECT){var E=this.getEmptyCopyBuffer();var D="";for(var B in H){A+=D+B;var F=H[B].cloneNode(true);if(F.getAttribute("trx")==="1"){var I=F.getAttribute("class");F.setAttribute("class",I.replace(/txttrx /,""));mstr.$A.forEach(["trx","trxsid","trxctlkey","trxn","trxdfm"],function(J){F.removeAttribute(J);});}E.items[B]=F;E.parentIds[B]=H[B].parentNode.getAttribute("id");E.length++;D=CLIPBOARD_ITEM_SEPARATOR;}this.objCache.copyBuffer=E;var C=this.docViewer.observer;if(C){C.notifyAll("onaddtoclipboard");}}return A;}catch(G){microstrategy.errors.log(G);}return"";};mstrDocSelectionsImpl.prototype.duplicate=function(){try{if(this.atLeastOneTableSelected()){showMessage({contents:microstrategy.descriptors.getDescriptor("11179"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return false;}if(!this.duplicatePanelStacks()){var B=(this.copy()==false);if(B){return this.paste();}}return false;}catch(A){microstrategy.errors.log(A);return true;}};mstrDocSelectionsImpl.prototype.duplicatePanelStacks=function(){try{var B=this.getTypes();var A=B.join(",").match(new RegExp("("+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+")","g"));if(!A){return false;}if(A.length!=B.length){showMessage({contents:microstrategy.descriptors.getDescriptor("7763"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{var F=this.getSelectedIds().split("|").join(CLIPBOARD_ITEM_SEPARATOR);var C=microstrategy.updateManager;C.add([C.createActionObject(null,mstrUpdateManager.DUPLICATE_PANEL_STACK,this.docViewer.beanPath,["2048012","2048171"],[F,microstrategy.getFormatObject().encodeValue("top",microstrategy.SNAP_SIZE)])]);C.flushAndSubmitChanges();if(microstrategy.getViewerBone().autoWire){for(id in this.sections){var D=document.getElementById(id);var G=microstrategy.findBone(D);this.docViewer.dirtySections.push({bone:G,isTarget:true});}}}}catch(E){microstrategy.errors.log(E);}return true;};mstrDocSelectionsImpl.prototype.copy=function(){try{var C=this.copyToClipboard(this.items);if(C.length>0){var A=microstrategy.updateManager;microstrategy.updateManager.add([A.createActionObject(null,mstrUpdateManager.COPY_TO_CLIPBOARD,this.docViewer.beanPath,["2048012"],[C],[],null)]);return false;}}catch(B){microstrategy.errors.log(B);}return true;};mstrDocSelectionsImpl.prototype.cut=function(){try{var B=(this.copy()==false);if(B){this.parentBone.deleteItems(this.items,true);}return false;}catch(A){microstrategy.errors.log(A);}return true;};mstrDocSelectionsImpl.prototype.paste=function(){try{var R=this.objCache.copyBuffer;if(!R){return true;}var J=this.styleObj;var c;var T=null;var A=true;var O=false;var g=false;switch(this.firstObjType()){case microstrategy.OBJTYPE_DOC_SUBSECTION:T=this.firstItem();g=true;break;case microstrategy.OBJTYPE_DOC_OBJECT:if(this.isSameSubSection()){g=true;if(this.isOnlyOnePanelStackSelected()){T=microstrategy.findBone(this.getSelectedPanelStack()).getCurrentPanel().elem;}else{for(c in this.sections){T=document.getElementById(c);break;}}}break;default:return false;}if(g){var E=prevSection=null;for(c in R.items){E=document.getElementById(R.parentIds[c]);if(prevSection&&E&&(prevSection.getAttribute("id")!=E.getAttribute("id"))){O=true;break;}prevSection=E;}A=(O||(E!=null&&E.getAttribute("id")==T.getAttribute("id")));}var W=function(u){var x=[];for(c in u){x.push(microstrategy.subObjectType(u[c]));}return x;};var d=W(R.items).join(",");var m=function(u){return !!d.match("("+microstrategy["SUBOBJTYPE_DOC_"+u]+")");};var e=m("TEMPLATE");var o=m("SELECTOR_CONTROL");var K=m("PANEL_STACK");if(!A&&T.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)=="-1"){if(e||o||K){var Q="*Sorry, but this paste operation is being canceled because you cannot paste a panel stack into the details section.*";showMessage({contents:K?Q:microstrategy.descriptors.getDescriptor((e)?"2945":"4992"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return false;}}var P=microstrategy.findBone(T);if(P&&P.isFilterPanel&&!o){showMessage({contents:"*This paste operation is being cancelled because you cannot paste a node other than selector to the Filter Panel.*",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}this.clear();var U="";var Z={elements:[],parents:[]};var G={};var q={};var S={control:false,target:false};for(var V in R.items){var N=R.items[V];var Y=N.cloneNode(true);var F=microstrategy.subObjectType(Y);var n=((A&&T)||!g)?document.getElementById(R.parentIds[V]):T;if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&F==microstrategy.SUBOBJTYPE_DOC_TEXT){var f=J.getAttValue(N,microstrategy.HTMLATTR_DSS_FORMULA);if(f!=null){this.parentBone.updateSingleTextField(Y,f);}}var H=n.getAttribute("id");if(!A){n=T;if(R.offsets[H]==null){R.offsets[H]=0;}}else{n=document.getElementById(R.parentIds[V]);if(R.offsets[H]==null){R.offsets[H]=microstrategy.SNAP_SIZE;}}moveObjTo(Y,parseInt(J.getValue(Y,"left"))+R.offsets[H],parseInt(J.getValue(Y,"top"))+R.offsets[H]);Y=this.parentBone.addItemsToSubsection(n,Y,true,N,microstrategy.findBone(microstrategy.findBone(T)));G[H]=true;if(!q[H]){q[H]={};}q[H].elem=n;if(F==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){S.control=true;q[H].isTarget=false;}else{if(F==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||F==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){S.target=true;q[H].isTarget=true;}}J.cloneAttValues(N,Y);if(J.getAttValue(Y,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT)!="0"&&F!=microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){J.applyShadow(Y,"dropShadowEffect","1");}c=Y.getAttribute("id");var D=this.parentBone.formattingAttributes[c];D[microstrategy.HTMLATTR_NAME]=this.parentBone.getDefaultNameOfObject(Y);var C=function(u){return microstrategy.findBone(microstrategy.subObjectFind(u,"div",microstrategy.SUBOBJTYPE_GRID_TABLE));};if(F==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var p=C(Y);var L=C(N);if(p&&L){p.copyBoneProperties(L);}}this.add(Y);Z.parents.push(n);Z.elements.push(Y);U+=CLIPBOARD_ITEM_SEPARATOR+c;}if(U.length>0){var a=microstrategy.updateManager;var B=n.getAttribute("id");var X=mstrFormatObject.encodeValue("top",R.offsets[B]);var I=[a.createActionObject(null,mstrUpdateManager.PASTE_FROM_CLIPBOARD,this.parentBone.parentBone.beanPath,["2048066","2048007","2048010","2048011","2048018","2048241"],[U.substr(1),B,X,X,mstrUpdateManager.UPDATE_LATER,"true"],[],Z)];this.resizeSubSection(false,I);a.add(I);if(T){for(var V in this.items){var Y=this.items[V];var F=microstrategy.subObjectType(Y);if(F==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.enforceTitleBar(T,Y);}}}if((S.control||S.target)&&microstrategy.getViewerBone().autoWire){for(c in q){subSecBone=microstrategy.findBone(q[c].elem);this.docViewer.dirtySections.push({bone:subSecBone,isTarget:q[H].isTarget});}}var M=m("IMAGE");if(M){a.add([a.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,this.parentBone.parentBone.beanPath,[],[],[])]);}if(e||o||K||M){a.flushAndSubmitChanges();}}for(var h in G){R.offsets[h]=parseInt(R.offsets[h])+microstrategy.SNAP_SIZE;}}catch(k){microstrategy.errors.log(k);}return false;};mstrDocSelectionsImpl.prototype.isSameSubSection=function(){try{var A=0;for(var B in this.sections){A++;if(A>1){break;}}return(A<2);}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.hasHorizSections=function(D){try{if(this.parentBone.containsHorizontalSections){for(var E in this.sections){var A=microstrategy.findBone(document.getElementById(E));var B=!!(A&&A.isHorizontal);if(D&&!B){return false;}if(!D&&B){return true;}}}}catch(C){microstrategy.errors.log(C);}return false;};mstrDocSelectionsImpl.prototype.addIdToSection=function(A,B){try{var D=this.sections[A]||{};D[B]=true;this.sections[A]=D;}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.syncUp=function(D){try{var C;if(D){C={};C[D.id||"_k"]=D;}D=C||this.items;for(var E in D){var A=this.hilites[D[E].getAttribute("id")];A&&A.syncHilites(this);}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.canNudge=function(){if(this.isSameSubSection()){return true;}for(var B in this.sections){var A=microstrategy.findBone(document.getElementById(B));if(A.subsectionType!=mstrSubSection.TYPE_FIXED){return false;}}return true;};mstrDocSelectionsImpl.prototype.nudge=function(L,D){try{if(!this.isActive()||this.firstObjType()!=microstrategy.OBJTYPE_DOC_OBJECT){return true;}if(!this.canNudge()){return false;}var g=this.parentBone.parentBone;g.turnOnRulerShade(this.range);var Z=(L%2==0);if(!this.isSameSubSection()&&(Z||this.hasHorizSections())){return false;}if(this.getPortalGridWithProperty(microstrategy.WINDOW_STATE_MAXIMIXED)!=null){return false;}var X=this.styleObj;var N=microstrategy.updateManager;var c=[];var R={acrossSections:false};var E=(Z)?"top":"left";var I=(D)?1:microstrategy.SNAP_SIZE;var d=microstrategy.SNAP_DIRET_POS;if(L<39){I=-I;d=microstrategy.SNAP_DIRET_NEG;}var H=this.range.offsetSection.elem;var C=getObjSumTop(H);var S=C+this.range.top-(C-this.parentBone.top);var O=getObjSumLeft(H)+this.range.left-this.leftBorderOffset;g.dragRulerShade(O,S,this.range);var J=this;var W=function(){window.setTimeout(J.path+".onmoveend()",0);};var B=function(k,m,h){return(k&&(J.range[m]<=(h-J.parentBone[m])));};if(I<0&&(B(Z,"top",C)||B(!Z,"left",getObjSumLeft(this.firstItem().parentNode)))){W();return false;}var M=(Z)?S:O;if(!D){if(!microstrategy.isSnapped(M,H,Z)){I=0;}}var V=M;M=this.parentBone.getNewPosition(M+I,H,Z,!D,d);var Q=0;var f=microstrategy.findBone(this.firstItem().parentNode);if(f&&f.isHorizontal&&!Z){Q=getObjSumLeft(this.firstItem().parentNode)-getObjSumLeft(this.range.offsetLeftSection.elem);}var e=M-V-Q;var Y=function(k,h){if(h==null){h=parseInt(X.getValue(J.items[a],k),10);}return mstrFormatObject.encodeValue(k,h);};for(var a in this.items){if(this.isLocked(this.items[a])){continue;}var P=this.items[a].getAttribute("id");var G=[mstrUpdateManager.UPDATE_LATER,P,this.items[a].parentNode.getAttribute("id")];M=window["getObjSum"+((Z)?"Top":"Left")](this.items[a])+e;if(!this.getNotUseSnap()&&!D&&f.canShowGuideline()){var A=Z?f.guidelineOffsetY:f.guidelineOffsetX;if(Math.abs(A)<microstrategy.SNAP_SIZE&&(A!=0&&(A>0&&d<0||A<0&&d>0))){M=M-(A!=0?d*(microstrategy.SNAP_SIZE-Math.abs(A)):0);}}M=(!Z&&M<0)?0:M;if(X.getValue(this.items[a],E)!=M+"px"){c.push(N.createActionObject(this.items[a],mstrUpdateManager.MOVE_OBJECT,g.beanPath,["2048018","2048012","2048007","2048010","2048011"],G.concat([Y("top",(Z)?M:null),Y("left",(Z)?null:M)]),G.concat([Y("top",null),Y("left",null)]),R));var K=document.getElementsByName(P);for(var U=0,T=K.length;U<T;U++){K[U].style[E]=M+"px";}}}this.resizeSubSection(false,c);this.resetRange(false,c);if(c.length>0){N.add(c);}this.syncUp();W();microstrategy.eventManager.notifyOrphanBones("onboneaftermove",this.getSelectedIds());if(f&&f.guidelineEnabled){this.syncPositionMap(this.items);f.showGuidelines(f.getLocalPosition(this.firstItem()));window.setTimeout(function(){f.hideGuidelines();},500);}return false;}catch(F){microstrategy.errors.log(F);}return true;};mstrDocSelectionsImpl.prototype.reselect=function(H){try{var D=H.split(",");for(var C=0;C<D.length;C++){var G=document.getElementById(D[C]);if(G){var A=G.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(A==microstrategy.OBJTYPE_DOC_OBJECT){var B=microstrategy.subObjectType(G);if(B==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var F=microstrategy.findBone(G);if(F&&F.selections&&F.selections.hasHilitedCells()){continue;}}this.add(G);}else{if(A==microstrategy.OBJTYPE_DOC_SUBSECTION){this.addSubSection(G);}}}}microstrategy.eventManager.notifyOrphanBones("onboneselected",this.getSelectedIds());}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.add=function(F,H,M){try{if(!F){return false;}var N=this.parentBone;N.syncPosition();var D=F.getAttribute("id");var L=document.getElementById(D);if(!L){return false;}var Q=microstrategy.subObjectType(F);var O;if(F.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&Q==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){O=microstrategy.findBone(F);if(!O){return false;}}var K=false;if(typeof (this.items[D])=="undefined"){this.items[D]=F;this.hilites[D]=new mstrDocHilite(this);this.addIdToSection(L.parentNode.getAttribute("id"),D);this.notifySelectedBone(F,true);K=true;this.length++;}if(this.length>1&&this.isSingleSelectionType){this.isSingleSelectionType=(microstrategy.subObjectType(this.firstItem())==F.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE));}this.updateRange(F);if(!this.objCache.hiLite||!this.objCache.lineHiLite){var J=document.createElement("img");J.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SEL_HANDLE);var A=document.createElement("div");A.className="mstrDocHilites";var E=["nw","n","ne","w","e","sw","s","se"];for(var I=0;I<8;I++){var P=J.cloneNode(true);P.className=E[I];A.appendChild(P);}this.objCache.hiLite=A;var C=document.createElement("div");C.className="mstrDocHilites";J.className="w";C.appendChild(J.cloneNode(false));J.className="e";C.appendChild(J.cloneNode(false));this.objCache.lineHiLite=C;}this.setPanelStackSelectionHandleEvents(F);this.setGridSelectionHandleEvents(F);if(O){if(O.isGridInCellSelectionMode&&O.isGridInCellSelectionMode()){O.selections.clearAll(true);}this.verifyFormatLevels("color");}else{if(Q==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){this.setObjectFormatLevel("Panels",this.resolvePanelsFormat(0,0));}else{if(Q==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.setObjectFormatLevel("Control",this.resolveControlFormat(0,0));}else{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}}if(typeof (H)=="undefined"||H==false){this.addHilites(F);}if(typeof (M)=="undefined"||M==false){if(K&&N.parentBone.observer){N.parentBone.delay("observer.notifyAll('onselectionchange')");}N.onselectionchange(D);}var B=microstrategy.findBone(L.parentNode);if(B){B.updatePositionMap(L);B.hideGuidelines();}return true;}catch(G){microstrategy.errors.log(G);return false;}};mstrDocSelectionsImpl.prototype.addHilites=function(F){try{var H=F.getAttribute("id");var E=document.getElementById(H);var C=this.objCache[(microstrategy.subObjectType(F)==microstrategy.SUBOBJTYPE_DOC_LINE)?"lineHiLite":"hiLite"];C.setAttribute("id","hilite"+H);var G=C.cloneNode(true);if(this.isLocked(F)){G.className="mstrDocHilites mstrLockedHilites";}G.src=F;G.ondblclick=new Function("e","microstrategy.bone('"+this.parentBone.parentBone.id+"').doc.editObj(e, this.src);");var A=this.hilites[H].items.push(G)-1;this.hilites[H].base=A;if(this.docViewer.isEditableViewModeEplus()){this.elem.appendChild(this.hilites[H].items[A]);this.elem.style.zIndex=this.parentBone.commands.exec("maxZIndex")+1;this.syncUp(E);this.hiliteElements(F);}this.elem.style.display="block";var B=microstrategy.findBone(E.parentNode);if(B&&B.subsectionType==mstrSubSection.TYPE_PANEL){this.elem.style.display=B.elem.style.display;}this.isVisible=true;}catch(D){microstrategy.errors.log(D);}};mstrDocSelectionsImpl.prototype.notifySelectedBone=function(F,E){try{var B=function(G){return microstrategy.findRWObjectBone(F,G);};var A;var D=microstrategy.findAncestor(F);if(D&&microstrategy.subObjectType(D)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){A=B("mstrGridRW")||B("mstrReportGraphImpl");}else{if(D&&microstrategy.subObjectType(D)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){A=B("mstrRWControlImpl");}else{A=B();}}if(A){if(E){A.onboneselected(null,this.getActiveSectionIndex(F));}else{A.onbonedeselected();}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.addSubSection=function(D){try{var B=microstrategy.findBone(D);if(!B){return ;}this.clear();var E=D.getAttribute("id");var D=document.getElementById(E);if(typeof (this.items[E])=="undefined"){this.items[E]=D;this.addIdToSection(D.parentNode.getAttribute("id"),E);this.length++;}var A=this.parentBone;if(A.parentBone.observer){A.parentBone.delay("observer.notifyAll('onselectionchange')");}A.onselectionchange(E);}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.remove=function(E,J){try{var B=E.getAttribute("id");E=document.getElementById(B);this.removePanelStackSelectionHandleEvents(E);this.removeGridSelectionHandleEvents(E);if(typeof (this.hilites[B])!="undefined"){for(var F=0,C=this.hilites[B].items.length;F<C;F++){if(this.elem.hasChildNodes()){this.elem.removeChild(this.hilites[B].items[F]);}}delete this.hilites[B];delete this.items[B];var G=E.parentNode.getAttribute("id");var H=this.sections[G];delete H[B];if(mstr.$H.isEmpty(H)){delete this.sections[G];}this.length--;var K=this.parentBone;if(K.parentBone.observer){K.parentBone.delay("observer.notifyAll('onselectionchange')");}K.onselectionchange(B);}this.notifySelectedBone(E,false);this.restoreElements(B);try{if(this.isActive()&&this.firstItem().focus){this.firstItem().focus();}else{if(document.body.focus){document.body.focus();}}}catch(I){}if(!J){this.resetRange();}if(this.length<2){this.isSingleSelectionType=true;}var A=microstrategy.findBone(E.parentNode);if(A){A.updatePositionMap(E,true);}}catch(D){microstrategy.errors.log(D);}};mstrDocSelectionsImpl.prototype.clear=function(H){try{H=H||false;this.elem.style.zIndex=-1;var I=function(N){if(M==microstrategy["SUBOBJTYPE_DOC_"+N]){return microstrategy.findBone(L);}return null;};for(var A in this.items){var L=this.items[A];var M=microstrategy.subObjectType(L);var J=I("PANEL_STACK");if(J){this.removePanelStackSelectionHandleEvents(L);}else{J=I("TEMPLATE");if(J){this.removeGridSelectionHandleEvents(L);var C=J.selections&&J.selections.clearAll(true);}}}if(this.elem.hasChildNodes()){for(var A in this.hilites){for(var F=0,B=this.hilites[A].items.length;F<B;F++){var G=this.hilites[A].items[F];if(G.parentNode!=null){this.elem.removeChild(G);}}this.restoreElements(A);}}var E=(this.length>0);if(E){microstrategy.eventManager.notifyOrphanBones("onbonedeselected",this.getSelectedIds());}this.isSingleSelectionType=true;this.hilites={};this.sections={};this.items={};this.range=new Rect(null,null,null,null);this.range.offsetSection=null;this.range.offsetLeftSection=null;this.isVisible=true;this.length=0;var K=this.parentBone;if(E&&!H&&K.parentBone.observer){K.parentBone.delay("observer.notifyAll('onselectionchange')");}K.onselectionchange(A);}catch(D){microstrategy.errors.log(D);}};mstrDocSelectionsImpl.prototype.firstObjType=function(){try{if(this.isActive()){return this.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE);}}catch(A){microstrategy.errors.log(A);}return null;};mstrDocSelectionsImpl.prototype.processFormatProperty=function(H,J,C){try{if(!H){return ;}var A=H[0];var F=H[1];if(!A){return ;}var E=this.parentBone;var D=function(K){return(parseInt(I[0],10)&K);};var G=F.toString();var I=G.split(",");if(A=="textDecoration"&&(I.length>1||D(4)||D(8))){E.formatUnderlineStrikeout(this.items,A,G,J);}else{E.formatItems(this.items,A,F,false,J,C);}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.processPropertyChanges=function(AS){try{var Aq=null;var P=null;var At=null;var Ay=null;var Ax=null;var A0=null;var X=[];var u=null;var Aa=null;var d=null;var AN=null;var p=null;var F=null;var AQ=null;var As=(this.isOnlyOneGridSelected())?this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE):null;var AW=(this.isOnlyOnePanelStackSelected())?this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK):null;var Ab=(AW&&AW.isTable)?AW:null;var U=(this.isSelectorControlSelected())?this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL):null;var A=microstrategy.formatType;var AG,Ae,O,Am,AL;var AM=mstrFormatObject;var e=this.parentBone;var An=this.styleObj;var Al=[];var AI=e.parentBone.updateManager;var C=false;var Aw=null;var B=null;var AK=false;var Ap=this.items;var Az=function(f){return(f)?microstrategy.TRUE:microstrategy.FALSE;};var AA=function(m,g,f){e.formatAttribute(Ap,m,g,false,f,Al);};var Ak=function(f,g){f=microstrategy.number.toUSUnits(f);if(g){f=AM.decodeValue(g,f);}return f;};for(var AJ=0;AJ<AS.length;AJ++){var Ac=AS[AJ].cmdId;var c=AS[AJ].obj;var y=AS[AJ].value;var AZ=AS[AJ].formatType;var AV=AS[AJ].performFormatChange;AQ=AS[AJ].memo;var Ar=AS[AJ].memo;var Af=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&As!=null&&"category" in Ar&&Ar.unit>microstrategy.GRID_UNIT_CONTAINER);if((As||AW||U)&&Ar&&"unit" in Ar){var AU=(As)?"Grid":(U?"Control":"Panels");var AF=this.resolveGridFormat(Ar.unit,Ar.format);this.setObjectFormatLevel(AU,AF);this.resolveFormatType(AU,AF);}else{if(U&&Ac=="IsPortal"){var AU=(As)?"Grid":(U?"Control":"Panels");var AF=this.resolveControlFormat(0,4);this.setObjectFormatLevel(AU,AF);this.resolveFormatType(AU,AF);}else{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}var H;if(C==false&&AS[AJ].submitUpdateManager&&AS[AJ].submitUpdateManager==true){C=true;}var AH=mstrDocSelectionsImpl.TCF[Ac];if(Ab&&AQ&&parseInt(AQ.unit)>1&&AH){microstrategy.formatType=1;switch(Ac){case"font":case"TextStrikeout":case"TextUnderline":case"fsize":case"color":case"FillColor":case"LineSettingColor":case"LineSettingWeight":Ab.setFormat({u:AQ.unit,f:AQ.format,p:AH,v:y});break;case"ShapeSettingStyle":Ab.setFormat({u:AQ.unit,f:AQ.format,p:AH,v:AM.decodeValue("lineStyle",y)});break;case"BoldItalic":Ab.setFormat({u:AQ.unit,f:AQ.format,p:"fb",v:(parseInt(y)&1)==1});Ab.setFormat({u:AQ.unit,f:AQ.format,p:"fi",v:(parseInt(y)&2)==2});break;}}else{switch(Ac){case"Name":AA("name",y,microstrategy.HTMLATTR_NAME);e.parentBone.delay("observer.notifyAll('onselectionchange')");break;case"ToolTip":e.formatTitle(Ap,"title",y,Al);break;case"Visible":case"VisibleHTML":AN=AN||{};AN[Ac]=y;break;case"IsLink":e.formatIsLink(Ap,y,Al);break;case"Link":var K=(e.secMode||trim(y).toLowerCase().indexOf("javascript")!=0)?y:"";AA("link",K,microstrategy.HTMLATTR_LINK_HREFVALUE);AA("link",y,microstrategy.HTMLATTR_LINK_HREF);break;case"EditFieldTargetInfoWin":AA("InformationWindowTarget",y,"ifw");var G=microstrategy.bone(y);if(G){e.formatAttribute([G.elem],"UseAsInformationWindow",microstrategy.TRUE,false,microstrategy.HTMLATTR_USE_AS_INFORMATION_WINDOW,Al);}break;case"InformationWindowPlacement":AA("InformationWindowPlacement",y,"iwpl");break;case"NewWin":AA("newWin",Az(y),microstrategy.HTMLATTR_NEW_WINDOW);break;case"HTMLType":e.formatHTMLType(Ap,y,Al);break;case"IFrameSource":AA("url",y,microstrategy.HTMLATTR_HTML_SOURCE);e.formatIframeSource(Ap,y);break;case"ShowWidgetTitleBar":AA("ShowWidgetTitleBar",Az(y),microstrategy.HTMLATTR_WIDGET_SHOW_WINDOW_TITLE);break;case"UseAsInformationWindow":AA("UseAsInformationWindow",Az(y),microstrategy.HTMLATTR_USE_AS_INFORMATION_WINDOW);break;case"InfoWindowMode":AA("InfoWindowMode",y,microstrategy.HTMLATTR_INFO_WIN_MODE);break;case"InfoWindowPosition":AA("InfoWindowPosition",y,microstrategy.HTMLATTR_INFO_WIN_POSITION);break;case"TabCloseToDismissInfoWindow":AA("TabCloseToDismissInfoWindow",Az(y),microstrategy.HTMLATTR_TAB_CLOSE_TO_DISMISS_INFOWIN);break;case"TextCopyMode":case"GridCellCopyMode":AA("CopyMode",y,microstrategy.HTMLATTR_IOS_COPY_MODE);break;case"ResetToFirstPanelWhenTargeted":AA("ResetToFirstPanelWhenTargeted",Az(y),microstrategy.HTMLATTR_RESET_TO_FIRST_PANEL_WHEN_TARGETED);break;case"EnableHorizontalSwipeToChange":AA("EnableHorizontalSwipeToChange",Az(y),microstrategy.HTMLATTR_HORIZONTAL_SWIPE_CHANGE);break;case"SwipePanelStyle":AA("StyleForSwitchingPanel",y,microstrategy.HTMLATTR_STYLE_FOR_SWIPE_PANEL);break;case"fpAutoSubmit":AA("CtlAutoSubmit",Az(y),microstrategy.HTMLATTR_CTL_AUTO_SUBMIT);break;case"EditSelectorSearchOnServ":AA("SearchOnServer",Az(y),microstrategy.HTMLATTR_CTL_SEARCH_ON_SERVER);break;case"EditSelectorNoSelectionBehavior":AA("NoSelectionBehavior",y,microstrategy.HTMLATTR_CTL_NO_SELECTION_BEHAVIOR);break;case"MinSel":AA("MinSelectionCount",(y===""?-1:y),microstrategy.HTMLATTR_CTL_MIN_SELECTION_COUNT);break;case"MaxSel":AA("MaxSelectionCount",(y===""?-1:y),microstrategy.HTMLATTR_CTL_MAX_SELECTION_COUNT);break;case"ShowElementCount":AA("showElementCount",Az(y),microstrategy.HTMLATTR_CTL_SHOW_ELEMENT_COUNT);break;case"SelectionColor":this.processFormatProperty(this.setSingleFormat("selectionStyle",y),Al);this.processFormatProperty(this.setSingleFormat("selectionColor",y),Al);break;case"IsPortal":AA("showTitleBar",Az(y),microstrategy.HTMLATTR_SHOW_WINDOW_TITLE);for(O in Ap){AG=Ap[O].getAttribute("id");var E=document.getElementsByName(AG);if(E&&e.checkAppliesTo(Ap[O],"showTitleBar")){if(y){var Av=microstrategy.formatType;if(microstrategy.subObjectType(Ap[O])==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){microstrategy.formatType=1;}var Z=function(f){e.formatSizeMode({0:Ap[O]},f+"Mode","0",Al,false);};Z("height");Z("width");microstrategy.formatType=Av;}}if(microstrategy.subObjectType(Ap[O])==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&y){var AR=microstrategy.findBone(Ap[O]);if(AR&&AR.commands&&!AR.commands.queryState("fittowindow")){AR.handleFitToWindow(Al);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){AR.commands.exec("setColWidthsMode",1);}else{C=true;}}}}break;case"PortalTitle":AA("windowTitle",y,microstrategy.HTMLATTR_WINDOW_TITLE);break;case"TitleBarDisplay":AA("titleBarDisplay",y,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY);break;case"PortalState":var V="restore";if(y==microstrategy.WINDOW_STATE_MAXIMIXED){V="maximize";}else{if(y==microstrategy.WINDOW_STATE_MINIMIZED){V="minimize";}}e[V+"Portal"](Ap,"windowState",y,false,Al);break;case"ExportOptions":AA("exportOptions",y,microstrategy.HTMLATTR_EXPORT_OPTION);break;case"Locked":AA("locked",Az(y),microstrategy.HTMLATTR_LOCKED);for(AG in Ap){var Aj=microstrategy.subObjectType(Ap[AG]);if(Aj==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||Aj==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){Ae=microstrategy.findBone(Ap[AG]);Ae.isLocked=y;Ae.resetToolbar();}}break;case"Left":case"Top":var o=Ac.toLowerCase();e.formatItems(Ap,o,Ak(y,o),false,Al);if(Ac=="Left"){e.updateLayoutWidth(Al);}microstrategy.eventManager.notifyOrphanBones("onboneaftermove",this.getSelectedIds());break;case"Wmode11":case"Wmode12":case"Wmode13":case"Wmode":case"Hmode11":case"Hmode12":case"Hmode13":case"Hmode":var Ao=(Ac.charAt(0)=="W")?"width":"height";e.formatSizeMode(Ap,Ao+"Mode",y,Al,AV);if(Ao=="width"&&bIsFirefox){C=true;}var L=microstrategy.findBone(this.getSelectedGrid());if(L&&L.isGrid){L.onresize();if(Ao==="height"){var Ah=L.getParentSubsection(),AT=Ah.elem.offsetHeight,Y=L.gridSpan.offsetHeight,z=parseInt(microstrategy.styleObj.getAttValue(Ah.elem,microstrategy.HTMLATTR_CAN_GROW));if(Y>AT&&z){Ah.simpleResize(Y);}}}break;case"Height":case"Width":var T=Ac.toLowerCase();e.formatSize(Ap,T,Ak(y,T),Al,AV);AK=true;if(Ac=="Width"&&bIsFirefox){C=true;}var L=microstrategy.findBone(this.getSelectedGrid());if(L&&L.isGrid){L.onresize();if(Ac==="Height"){var Ah=L.getParentSubsection(),AT=Ah.elem.offsetHeight,Y=L.gridSpan.offsetHeight,z=parseInt(microstrategy.styleObj.getAttValue(Ah.elem,microstrategy.HTMLATTR_CAN_GROW));if(Y>AT&&z){Ah.simpleResize(Y);}}}break;case"SubHeight":case"MaxHeight":case"Shrink":case"Grow":Aa=Aa||{};Aa[Ac]=y;break;case"SubWidth":case"MaxWidth":case"ShrinkHorizontal":case"GrowHorizontal":d=d||{};d[Ac]=y;break;case"HideIfEmpty":AA("hideIfEmpty",Az(y),microstrategy.HTMLATTR_HIDE_IF_EMPTY);break;case"LockAspectRatio":e.formatLockAspectRatio(Ap,y,Al);break;case"Lmode":e.formatLineLength(Ap,"lengthMode",y,Al,AV);break;case"Length":e.formatLineLength(Ap,"length",Ak(y,"width"),Al,AV);break;case"FitExcelRowHeight":AA("fitExcelRowHeight",Az(y),microstrategy.HTMLATTR_FIT_EXCEL_ROW_HEIGHT);break;case"Keep":AA("keepSectionTogether",Az(y),microstrategy.HTMLATTR_KEEP_SECTION_TOGETHER);break;case"Repeat":AA("repeatSection",Az(y),microstrategy.HTMLATTR_REPEAT_SECTION);break;case"showInRptCp":AA("showOnlyInRepeatingCopies",Az(y),microstrategy.HTMLATTR_SHOW_IN_RPT_COPY);break;case"RepeatHoriz":AA("repeatHorizontally",Az(y),microstrategy.HTMLATTR_REPEAT_HORIZONTALLY);break;case"NewPage":AA("forceNewPage",y,microstrategy.HTMLATTR_FORCE_NEW_PAGE);break;case"DataSource":A0=A0||{};A0[Ac]=y;break;case"Shortcut":A0=A0||{};A0[Ac]=y;C=true;break;case"XTabView":e.formatTemplateSize(Ap,y,Al);C=true;AK=true;break;case"QuickSwitch":AA("quickSwitch",Az(y),microstrategy.HTMLATTR_QUICK_SWITCH);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){C=true;}break;case"Overflow":AA("gridOverFlow",y,microstrategy.HTMLATTR_GRID_OVERFLOW);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){C=true;}break;case"TextOverflow":AA("TextOverflow",y,microstrategy.HTMLATTR_TEXT_OVERFLOW);break;case"ExportOverflow":AA("gridExportOverFlow",y,microstrategy.HTMLATTR_GRID_EXPORT_OVERFLOW);break;case"XTabPos":AA("gridPosition",y,microstrategy.HTMLATTR_GRID_POS);Aw=y;AK=true;C=true;break;case"XTabPer":AA("gridArea",y,microstrategy.HTMLATTR_GRID_AREA_PCT);B=y;AK=true;C=true;break;case"ItemWidthMode":this.setCommonBoneProperty(Ap,"itemWidthMode","ItemWidthMode",Az(!y),microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,Al);C|=microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE;break;case"DisplaySelectorDocked":this.setCommonBoneProperty(Ap,"DisplaySelectorDocked","DisplaySelectorDocked",Az(y),microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,Al);break;case"exportSelectorTriState":this.setCommonBoneProperty(Ap,"aow","ExportAsShownOnWeb",y,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,Al);break;case"TitleHeight":if(!!y){microstrategy.formatType=this.docViewer.doc.selections.isSelectorControlSelected()?mstrRWControlImpl.FMT_TYPE_TITLE:2;e.formatSize(Ap,"height",Ak(y,"height"),Al,AV);microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}break;case"Source":if(this.addingCtrl!=microstrategy.SUBOBJTYPE_DOC_IMAGE){var J=e.img?e.img.url:y;C=e.formatImageSource(Ap,J,Al,1);e.autoSizeImages(0,J,Ap,Al,true);}break;case"imgFile":if(this.addingCtrl!=microstrategy.SUBOBJTYPE_DOC_IMAGE){e.img=y;}break;case"autoSizeImg":e.autoSizeImages(0,y,Ap,Al);break;case"LineOrientation":e.changeLineOrientation(Ap,y,Al);break;case"RHS":case"RHM":case"RHL":case"CHS":case"CHM":case"CHL":case"Outline":case"Banding":case"AttForms":case"ShowThreshold":case"TitleOverlap":case"DrillOptions":case"HideNullsOrZeros":case"HideNullZeroValues":if(Ac=="HideNullsOrZeros"){y=(y)?0:-1;}else{if(Ac!="DrillOptions"&&Ac!="AttForms"&&Ac!="HideNullZeroValues"){y=(y)?-1:0;}}AL=this.getSelectedGrid();Ae=microstrategy.findBone(AL);Ae.elem.setAttribute("avk",AL.getAttribute("id"));Ae.processGridPropertyChanges(Ac,y,Al);C=true;break;case"assoNodesDrill":var k={assoNodesDrill:1}[Ac];var O=this.firstItem();Ae=microstrategy.findBone(O);Ae.processGridPropertyChanges(Ac,y,Al);Al.push(AI.createActionObject(null,mstrUpdateManager.SET_ASSO_NODES,e.parentBone.beanPath,["2048012","2048248","2048247"],[O.getAttribute("id"),y,k]));C=(C||microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);break;case"GraphExportOverflow":case"GraphExportOverflowSpacing":Ae=microstrategy.findBone(this.getSelectedGrid());Ae.processGridPropertyChanges(Ac,y,Al);break;case"ControlGroupByList":AL=this.getSelectedGrid();if(AL){Ae=microstrategy.findBone(AL);Ae.processGridPropertyChanges(Ac,y,Al);}else{var c=this.getSelectedPanelStack()||this.getSelectedSelectorControl();if(c){Ae=microstrategy.findBone(c);if(Ae){Ae.setControlGroupByList(y,Al);}}}C=true;break;case"EditSelectorSelectionType":case"EditSelectorMetricConditionType":case"EditSelectorType":case"EditSelectorSource":case"EditSelectorSourceMetrics":case"EditSelectorSourceAttributes":case"EditSelectorShowAll":case"EditSelectorAllAlias":case"EditSelectorShowTotal":case"EditSelectorTotalPosition":case"EditSelectorMouseOverAction":case"EditSelectorMultiSelect":case"EditSelectorStyle":case"EditSelectorStyleSingleSelect":case"EditSelectorStyleMetricQual":case"EditSelectorStyleAction":case"EditSelectorTargets":case"EditSelectorTargetsMetrics":case"EditSelectorTargetsAttributes":case"EditSelectorTargetsSingleSelect":case"EditSelectorTargetsDataset":case"EditSelectorCandidateAttributes":case"EditSelectorOrientation":case"EditSelectorAutoSync":case"DataFilterMode":case"selectorCurrentStateUC":case"selectorCurrentState":case"UnsetCount":case"ActionSelectorStyle":case"actionSelectorType":case"postSubmitOption":case"runReportDocName":case"runReportDocId":case"runObjectType":case"DisplayText":case"OfflineSubmission":case"TXNSubmitInOrder":case"DisplayConfirmation":case"SubmitMessage":case"ShowSubmitMessage":case"InvalidateCache":case"ForceLiveExecution":case"AutoAnswerPrompt":case"EditFormDelimiter":case"EditDisplayForm":case"selectedAttrForms":case"sortAttrForm":case"sortType":case"isDSAsTarget":if(Ab&&Ac==="DisplayConfirmation"){Ab.exec({id:"setSelectorDisplayConfirmation",v:{key:Ab.model.def.smk,value:y}});break;}Ay=Ay||{};Ay[Ac]=y;var AY={EditSelectorSelectionType:"include",EditSelectorMouseOverAction:"mouseOverAction",EditSelectorAutoSync:"autoSync",EditSelectorShowAll:"showAll",EditSelectorShowTotal:"showTotal",EditSelectorAllAlias:"allAlias",isDSAsTarget:"isDSAsTarget"};var AC=AY[Ac];var N=this.docViewer.doc.commands;var Q=N.queryState("isDDIC");if(AC){for(var AE in Ap){var AR=mstrStaticDoc.getBone(Ap[AE]);if(AR){AR[AC]=y;}else{if(Q){N.setDDICBoneProperty([Ap[AE]],AC,y);}}}}break;case"UpdateFilterTarget":AA("ActionForDirectTargetSelectors",y,"adts");break;case"setWidget":var q;var AP="";var S="";var AB=false;if(y&&y.toLowerCase()!="none"){var Ag=e.parentBone.widgets;for(var Ad in Ag){if((Ag[Ad]["rslPath"]&&Ag[Ad]["rslPath"]==y)||(Ag[Ad]["fqcn"]&&Ag[Ad]["fqcn"]==y)){q=Ag[Ad];AP=q.fqcn;S=q.rslPath;AB=q.isApp;break;}}}AA("ClassName",AP,microstrategy.HTMLATTR_WIDGET_CLASS);AA("RSLPath",S,microstrategy.HTMLATTR_WIDGET_RSL_PATH);AA("IsApp",AB,microstrategy.HTMLATTR_WIDGET_IS_APP);break;case"SecondaryDataProviders":AA("SecondaryDataProviders",y.split(CLIPBOARD_ITEM_SEPARATOR).join(","),microstrategy.HTMLATTR_SEC_DATA_PROVIDERS);C=true;break;case"NonFlashRender":AA("NonFlashRender",y,microstrategy.HTMLATTR_NON_FLASH_RENDER);break;case"setWidgetDhtmlRenderForViewModeChange":if(this.isWidgetToVisLinked(As)){AA("DhtmlRenderer",y,microstrategy.HTMLATTR_DHTML_RENDER);}break;case"setTransition":AA("Transition",y,microstrategy.HTMLATTR_TRANSITION);break;case"setTransDuration":AA("Duration",y,microstrategy.HTMLATTR_TRANS_DURATION);break;case"PSPreLoadAllPanels":AA("PSPreLoadAllPanels",y,"plp");break;case"ClipOnExport":AA("IgnoreInExport",y?microstrategy.FALSE:microstrategy.TRUE,"cone");break;case"allowPanelsToSplitAcrossPages":AA("SplitPanelAcrossPages",y?microstrategy.TRUE:microstrategy.FALSE,"spcp");break;case"panelOverflowSpacing":AA("RepeatPanelSpacing",y,"povfs");break;case"expandPanels":AA("ExpandAllPanels",y,"ep");AA("SplitPanelAcrossPages",y!=0?microstrategy.FALSE:microstrategy.TRUE,"spcp");break;case"gridIfEnabled":AA("gridIfEnabled",Az(y),"gif");if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){C=true;}break;case"gridIfMaxRows":AA("gridIfMaxRows",y,"gmr");if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){C=true;}break;case"gridIfRowMode":AA("gridIfRowMode",y,"gifmd");if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){C=true;}break;case"setWidgetRslPath":for(var O in Ap){Al.push(AI.createEditPropsAction(Ap[O],Ap[O].getAttribute("id"),e.parentBone.beanPath,["RSLPath"],[y]));}break;case"FillColor":H=this.setSingleFormat(Ac,y);if(Ab&&AQ&&parseInt(AQ.unit)>1){Ab.setFormat({p:H[0],v:H[1],u:AQ.unit,f:AQ.format});}else{if(Af&&Ar.unit>microstrategy.GRID_UNIT_CONTAINER){X.push({n:H[0],m:Ar,v:y});}else{var M=this.setSingleFormat("FillStyle",y);this.processFormatProperty(H,Al);this.processFormatProperty(M,Al);Aq=Aq||{};Aq[Ac]=y;}}break;case"ShapeSettingStyle":case"LineSettingStyle":e.formatLineSetting(Ap,"lineStyle",AM.decodeValue("lineStyle",y),false,Al);break;case"LineSettingColor":e.formatLineSetting(Ap,"lineColor",y,false,Al);break;case"LineSettingWeight":e.formatLineSetting(Ap,"lineWeight",AM.decodeValue("lineWeight",y),false,Al);break;case"propBorderStyle":case"propButtonBorderStyle":case"AllStyle":case"AllColor":case"LeftStyle":case"LeftColor":case"TopStyle":case"TopColor":case"RightStyle":case"RightColor":case"BottomStyle":case"BottomColor":if(Af&&Ar.unit>microstrategy.GRID_UNIT_CONTAINER){AU=Ar.unit+"|"+Ar.format;At=At||{};At[AU]=At[AU]||{};At[AU][Ac]=y;}else{AU="default|"+microstrategy.formatType;}P=P||{};P[AU]=P[AU]||{};if(Ac=="propButtonBorderStyle"){Ac="propBorderStyle";}P[AU][Ac]=y;break;case"font":case"fsize":case"color":H=this.setSingleFormat(Ac,y);if(Af){X.push({n:H[0],m:Ar,v:y});}else{if(AW){microstrategy.formatType=2;}this.processFormatProperty(H,Al);}break;case"BoldItalic":if(Af){X.push({n:"fontWeight",m:Ar,v:((y==1||y==3)?-1:0)});X.push({n:"fontStyle",m:Ar,v:((y==2||y==3)?-1:0)});}else{if(AW){microstrategy.formatType=2;}this.processFormatProperty(this.setSingleFormat("Bold",(y==1||y==3)),Al);this.processFormatProperty(this.setSingleFormat("Italic",(y==2||y==3)),Al);if(AW){AW.setFormatValue(mstrPanelStack.FMT_TYPE_TITLE,"fontWeight",(y==1||y==3)?"bold":"normal");AW.setFormatValue(mstrPanelStack.FMT_TYPE_TITLE,"fontStyle",(y==2||y==3)?"italic":"normal");}}break;case"TextUnderline":if(Af){X.push({n:"textDecoration",m:Ar,v:y});}else{if(AW){microstrategy.formatType=2;}this.processFormatProperty(this.setSingleFormat("Underline",y),Al);}break;case"TextStrikeout":if(Af){X.push({n:"textDecoration2",m:Ar,v:y});}else{if(AW){microstrategy.formatType=2;}this.processFormatProperty(this.setSingleFormat("StrikeOut",y),Al);}break;case"Category":case"DecimalPlaces":case"CurrencySymbol":case"CurrencyPosition":case"NegativeNumbers":case"ThousandSeparator":case"Format":if(Af){if(Ac=="ThousandSeparator"){y=y?microstrategy.TRUE:microstrategy.FALSE;}u=u||{};u[Ac]=y;X.push({n:Ac,m:Ar,v:y});}else{this.processFormatProperty(this.setSingleFormat(Ac,y),Al);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){C=true;}}break;case"GridHorizontal":case"Vertical2":case"Vertical":case"SelectorVertical":case"TextWrap":case"TextDirection":case"TextDirectionGrid":if(Ac=="TextDirectionGrid"){Ac="TextDirection";}if(Ac=="SelectorVertical"){Ac="Vertical";}var I=bIsFirefox||bIsChrome||bIsIE4||bIsW3CIE;if(Ac=="TextDirection"&&!I&&y!="0"){showMessage({contents:microstrategy.descriptors.getDescriptor("5158"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}if(Af){X.push({n:Ac,m:Ar,v:y});}else{this.processFormatProperty(this.setSingleFormat(Ac,y),Al);}break;case"Horizontal":this.processFormatProperty(this.setSingleFormat(Ac,y),Al);break;case"LeftPadding":case"TopPadding":case"RightPadding":case"BottomPadding":if(Af){X.push({n:"padding"+Ac.replace("Padding",""),m:Ar,v:microstrategy.number.toLocalUnits(mstrNumber.UNIT_PT,Ak(y))});}else{this.processFormatProperty(this.setSingleFormat(Ac,microstrategy.number.toLocalUnits(mstrNumber.UNIT_PT,Ak(y),true)),Al);}break;case"HasDropShadow":case"DropShadow":this.processFormatProperty(this.setSingleFormat(Ac,y),Al);break;case"HasRoundedCorners":case"TopCornersOnly":case"Radius":Ax=Ax||{};Ax[Ac]=y;break;case"enabled3d":case"b3dstyle":case"b3dweight":Aq=Aq||{};Aq[Ac]=y;break;case"Transparency":AA("Transparency",y,microstrategy.HTMLATTR_PS_TRANSPARENCY);break;case"Blur":AA("Blur",Az(y),microstrategy.HTMLATTR_PS_BLUR);break;case"FlashDisplay":case"DHTMLDisplay":case"iPhoneDisplay":case"AndroidDisplay":case"AndroidTabletDisplay":case"iPadDisplay":case"widgetId":case"WidgetProps":case"SecondaryDataProvidersValue":p=p||{};p[Ac]=y;break;case"docked":var AO=this.parentBone.commands.getCurrentSectionDef();var x=y?microstrategy.TRUE:microstrategy.FALSE;if(AO.dc!=(x==microstrategy.TRUE)){AO.dc=(x==microstrategy.TRUE);}var c=microstrategy.findAncestorWithAtt(this.parentBone.selections.firstItem(),microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION);e.formatAttribute([c],"docked",x,false,null,Al);break;case"DisplayStyle":AA("DisplayStyle",y,microstrategy.HTMLATTR_DISPLAY_STYLE);break;case"NormalURL":AA("NormalURL",y,microstrategy.HTMLATTR_NORMAL_URL);break;case"HighlightURL":AA("HighlightURL",y,microstrategy.HTMLATTR_HIGHLIGHT_URL);break;case"BackgroundHighlightColor":AA("BackgroundHighlightColor",mstrFormatObject.encodeValue("BackgroundHighlightColor",y),microstrategy.HTMLATTR_BACKGROUND_HIGHLIGHT_COLOR);break;case"FontHighlightColor":AA("FontHighlightColor",mstrFormatObject.encodeValue("FontHighlightColor",y),microstrategy.HTMLATTR_FONT_HIGHLIGHT_COLOR);break;case"FillEffect":AA("FillEffect",y,microstrategy.HTMLATTR_FILL_EFFECT);break;case"SetBadgeToValueOnField":AA("SetBadgeToValueOnField",Az(y),microstrategy.HTMLATTR_SET_BADGE_TO_VALUE_ON_FIELD);break;case"TableSubmitText":Ab&&Ab.exec({id:"setSelectorDisplayText",v:{key:Ab.model.def.smk,txt:y}});break;case"TableCancelText":Ab&&Ab.exec({id:"setSelectorDisplayText",v:{key:Ab.model.def.dck,txt:y}});break;case"TableCancelConfirmation":Ab&&Ab.exec({id:"setSelectorDisplayConfirmation",v:{key:Ab.model.def.dck,value:y}});break;case"joinTypes":var Ae=microstrategy.findBone(this.getSelectedGrid()),D=Ae.editorProperties=Ae.editorProperties||{},Au,R,AD,W;D.outerJoinType=D.outerJoinType||{};for(var AX in y){if(AX==="allAttrs"){Au="VLDB Select!Outer Join To Lookup Table!"+(y[AX]==="dft"?" !dft":y[AX]);Al.push(AI.createActionObject(this.elem,mstrUpdateManager.SET_PROPERTY_VALUES,Ae.beanPath,["4146"],[Au],[]));D.outerJoinType=y[AX];}else{Au="VLDB Select!Metric Join Type!"+(y[AX]==="dft"?" !dft":y[AX]);R=Ae.RWUnitId;AD=AX;W=4;Al.push(AI.createActionObject(this.elem,mstrUpdateManager.SET_TEMPLATE_UNIT_PROPS,this.docViewer.beanPath,["4146","2048012","2048001","2048009"],[Au,R,AD,W],[]));D.tmsProps=D.tmsProps||{};D.tmsProps[AX]={outerJoinType:y[AX]};}}C=true;if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){Al.push(AI.createActionObject(e.elem,mstrUpdateManager.APPLY_CHANGES,this.docViewer.beanPath,[],[],[]));}break;case"DisplayInPartialScreen":AA("DisplayInPartialScreen",Az(y),"dips");break;case"InitialSlidingInWidth":AA("InitialSlidingInWidth",Ak(y,Ac),"isiw");break;case"InitialSlidingInHeight":AA("InitialSlidingInHeight",Ak(y,Ac),"isih");break;case"ShowAsCollapsiblePanel":AA("ShowAsCollapsiblePanel",Az(y),"sacp");break;case"InfoWindowPositionEnabled":case"showTranslucent":case"InitialSlidingInHeightEnabled":case"InitialSlidingInWidthEnabled":break;case"showCustomThemePicker":case"showAppliedThemeAsType":case"appliedThemeTypes":case"appliedThemeAsTypes":case"appliedThemePath":case"appliedThemeType":case"appliedThemeID":case"appliedThemeAsLink":F=F||{};F[Ac]=y;break;default:if(typeof (console)!="undefined"){console.log(Ac+" property not handled in processPropertyChanges.");}}}}if(AK&&this.processGraphPropertyChanges(Ap,Aw,B,Al)){C=true;}var a="";this.processVisibilityChanges(AN,Al);this.processSubDimensionPropertyChanges(Aa,"Height",Al);this.processSubDimensionPropertyChanges(d,"Width",Al);this.processBorderPropertyChanges(P,Al);this.process3DBorderPropertyChanges(Aq,Al);C|=Al.forceSubmit;if(this.processGridOriginPropertyChanges(A0,Al)){C=true;}if(Ab&&Ay){var h=Ab.submitBtn;this.processSelectorSubsequentChanges(Ay,h,Al);Ay=null;}else{if(this.processSelectorPropertyChanges(Ay,Al)){C=true;}}if(this.processThemePropertyChanges(F,Al)){C=true;}this.processRoundedCornerChanges(Ax,Al);a=this.processGridNumberFormatChanges(u,Ar,Al);if(At){X.push({n:"borders",v:At});}if(X.length>0){if(Af&&As.processGridFormattingProperties(X,Al)){C=true;}}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;this.processWidgetPropertyChanges(p,As,Al,Ap);microstrategy.formatType=A;if(Al.length>0){AI.add(Al);if(C==true){AI.flushAndSubmitChanges();}}if(a){delete microstrategy.gridFormatCache[a];}this.addingCtrl=null;}catch(Ai){microstrategy.errors.log(Ai);}};mstrDocSelectionsImpl.prototype.isWidgetToVisLinked=function(D){try{if(D){for(var C in this.items){var B=this.styleObj.getAttValue(this.items[C],microstrategy.HTMLATTR_WIDGET_RSL_PATH);var E=this.parentBone.getLinkedVisualization(B);return(E&&E==D.selectedVisualization);}}}catch(A){microstrategy.errors.log(A);}return false;};mstrDocSelectionsImpl.prototype.processWidgetPropertyChanges=function(J,W,T,P){try{if(!J){return ;}var B=this.parentBone;var R=this.styleObj;var U=function(c,Z,Y){B.formatAttribute(P,c,Z,false,Y,T);};var N=function(Z,Y,d){var e=[];if(Y){e.push(Y);}if(W.visualizationList&&W.visualizationList.length>0){for(var c=0,a=W.visualizationList.length;c<a;c++){if(W.visualizationList[c].name!=Y){e.push(Y);}}}W.setVisualizationSettings(Z,Y,e.join(","),d,T);};var S=function(){if(typeof (J.WidgetProps)=="undefined"){if(I.wgtProps){J.WidgetProps=I.wgtProps;}}};var O=J.widgetId;var I=this.docViewer;var M=I.commands.queryState("widgetId");if(typeof (O)=="undefined"){O=M;}var K=I.gridWidgets.lst,L=K[O];if(typeof (J.FlashDisplay)!="undefined"){var H="";var V="";var Q=false;var A="0";if(J.FlashDisplay){H=L.wgt.cn;V=L.wgt.rsl;Q=L.wgt.ia;A="-1";W.curWgtId=O;W.isWidget=true;}else{W.isWidget=false;}U("ClassName",H,microstrategy.HTMLATTR_WIDGET_CLASS);U("RSLPath",V,microstrategy.HTMLATTR_WIDGET_RSL_PATH);U("IsApp",Q,microstrategy.HTMLATTR_WIDGET_IS_APP);U("Enable",A);}if(typeof (J.DHTMLDisplay)!="undefined"){if(J.DHTMLDisplay){N("1",L.vis.s,L.vis.vm);W.curWgtId=O;}else{N("0","","0");}}if(typeof (J.iPhoneDisplay)!="undefined"){var G="";if(J.iPhoneDisplay){G=L.iphVis.s;W.iPhoneVis=G;W.curWgtId=O;}if(I.iPhoneVis){I.doc.saveDocProperty("IPhoneVisualization","");S();}U("IPhoneVisualization",G,microstrategy.HTMLATTR_IPHONE_VIS);}if(typeof (J.iPadDisplay)!="undefined"){var C="";W.iPadVis="";if(J.iPadDisplay){C=L.ipadVis.s;W.iPadVis=C;W.curWgtId=O;}U("IPadVisualization",C,microstrategy.HTMLATTR_IPAD_VIS);}if(typeof (J.AndroidDisplay)!="undefined"){var F="";if(J.AndroidDisplay){F=L.aVis.s;W.aVis=F;W.curWgtId=O;}if(I.aVis){I.doc.saveDocProperty("APhoneVisualization","");S();}U("APhoneVisualization",F,microstrategy.HTMLATTR_ANDROID_VIS);}if(typeof (J.AndroidTabletDisplay)!="undefined"){var X="";if(J.AndroidTabletDisplay){X=L.atVis.s;W.curWgtId=O;W.atVis=X;}U("ATabletVisualization",X,microstrategy.HTMLATTR_ANDROID_TABLET_VIS);}if(W&&W.buildWidgetPreview){W.buildWidgetPreview(O);}if(O==""){W.curWgtId="";W.iPadVis="";I.iPhoneVis="";I.curWgtId="";I.aVis="";I.doc.saveDocProperty("WidgetProps","");I.wgtProps="";U("WidgetProps","",microstrategy.HTMLATTR_WIDGET_PROPS);W.wgtProps="";}else{if(!W.curWgtId&&(W.iPadVis||W.isWidget)){W.curWgtId=O;}if(typeof (J.WidgetProps)!="undefined"){var D=J.WidgetProps;U("WidgetProps",D,microstrategy.HTMLATTR_WIDGET_PROPS);W.wgtProps=D;if(I.wgtProps){I.doc.saveDocProperty("WidgetProps","");}}}if(!W.curWgtId){U("SecondaryDataProviders","",microstrategy.HTMLATTR_SEC_DATA_PROVIDERS);}if(typeof (J.SecondaryDataProvidersValue)!="undefined"){U("SecondaryDataProviders",J.SecondaryDataProvidersValue.split(CLIPBOARD_ITEM_SEPARATOR).join(","),microstrategy.HTMLATTR_SEC_DATA_PROVIDERS);forceSubmit=true;}}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.cancelPropertyEdit=function(A){if(this.addingCtrl==microstrategy.SUBOBJTYPE_DOC_IMAGE){this.parentBone.commands.exec("deleteStubImg");}this.addingCtrl=null;};mstrDocSelectionsImpl.prototype.resolveDeltaPropertyValue=function(B,A){return(A in B)?B[A]:this.checkFormat(A);};mstrDocSelectionsImpl.prototype.convertBooleanToString=function(A){return(A)?microstrategy.TRUE:microstrategy.FALSE;};mstrDocSelectionsImpl.prototype.processVisibilityChanges=function(B,J){try{if(!B){return ;}var H=this.parentBone;var F=this;var G=function(M,L,K){H.formatAttribute(F.items,M,F.convertBooleanToString(L),false,K,J);};var I="Visible";var D="VisibleHTML";var A=H.commands.queryState(I);if(I in B){A=B[I];G("visibility",A,microstrategy.HTMLATTR_VISIBLE);}if(H.commands.queryState("showVisibleInHTMLViewMode")){var E=(D in B)?B[D]:H.commands.queryState(D);if(D in B||(!A&&E)){if(!A){E=false;}G("showInHTMLViewMode",E,microstrategy.HTMLATTR_VISIBLE_HTML_VIEW_MODE);}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.processSubDimensionPropertyChanges=function(B,G,L){try{if(!B){return ;}if(G=="Height"&&("Grow" in B||"Shrink" in B)){var K=microstrategy.findBone(this.firstItem());if(K&&K.isHorizontal){var H=microstrategy.findAncestorWithAtt(K.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(H){var J=function(N,M){H.setAttribute(M,B[N]?microstrategy.TRUE:microstrategy.FALSE);};if("Grow" in B){J("Grow",microstrategy.HTMLATTR_CAN_GROW);}if("Shrink" in B){J("Shrink",microstrategy.HTMLATTR_CAN_SHRINK);}}}}var F=this;var I=function(O,M){var N=F.resolveDeltaPropertyValue(B,M);if(O){return microstrategy.number.toUSUnits(N);}else{return F.convertBooleanToString(N);}};var A=G.toLowerCase();var D="";if(A=="width"){D="Horizontal";}else{for(var E in B){A+="|"+E;}}this.parentBone.formatSubHeightWidth(this.items,A,[I(true,"Sub"+G),I(true,"Max"+G),I(false,"Grow"+D),I(false,"Shrink"+D),this.convertBooleanToString(this.checkFormat("HideIfEmpty"))],L);}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.processGridOriginPropertyChanges=function(F,C){try{if(!F){return false;}var E=false;var D=null;var B=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if("DataSource" in F){D=F.DataSource;this.parentBone.setGridDataSource(this.items,D,C);E=true;}else{D=B.commands.queryState("DataSource");}if("Shortcut" in F){this.parentBone.setGridOrigin(this.items,F.Shortcut,D,C);B.commands.exec("Shortcut",F.Shortcut);if(!E){E=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);}}return E;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.processGridNumberFormatChanges=function(E,B,Q){try{if(!E||E.length==7){return false;}var L=[];var K=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);var O=["Category","DecimalPlaces","CurrencySymbol","CurrencyPosition","NegativeNumbers","ThousandSeparator","Format"];var N=(E.Category=="-2");for(var J=0,D=O.length;J<D;J++){var P=O[J];if(!E[P]){L.push({n:P,m:B,v:((N)?"-2":this.parentBone.commands.queryState(P))});}}var C=[],I,A,M;K.processGridFormattingProperties(L,C);I=C[0];A=I.argID;M=I.newArgs;for(var J in C){_j:for(var H in C[J].argID){for(var G in A){if(C[J].argID[H]==A[G]){continue _j;}}A.push(C[J].argID[H]);M.push(C[J].newArgs[H]);}}Q.push(I);if(K.RWUnitId in microstrategy.gridFormatCache&&N){return K.RWUnitId;}}catch(F){microstrategy.errors.log(F);}return false;};mstrDocSelectionsImpl.prototype.processBorderPropertyChanges=function(G,L){try{if(!G){return ;}for(var D in G){var J;if(D.indexOf("default")>=0){J=G[D];}else{continue;}microstrategy.formatType=D.split("|")[1];var A;var B=["borderTop","borderRight","borderLeft","borderBottom"];var H=this;var K=function(P,M){var O={width:"0pt",style:"solid",color:(P[M+"Color"]||H.checkFormat(M+"Color"))||"#000000"};var N=mstrFormatObject.decodeValue("borderTopStyle",P[M+"Style"]||H.checkFormat(M+"Style")).split(" ");if(N.length>1){O.width=N[0];O.style=N[1];}return O;};var E=function(P,N,O,M){H.parentBone.formatItemBorders(H.items,P,N,O,M,false,L);};var I=parseInt((("propBorderStyle" in J)?J.propBorderStyle:this.checkBorderStyle()),10);switch(parseInt(I)){case 0:E(B,"solid","0pt","#000000");break;case 1:A=K(J,"All");E(B,A.style,A.width,A.color);break;case 2:for(var F=0;F<4;F++){A=K(J,B[F].replace("border",""));E([B[F]],A.style,A.width,A.color);}break;}delete J;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.process3DBorderPropertyChanges=function(E,C){try{if(!E){return ;}var A="0";var D="";if(this.resolveDeltaPropertyValue(E,"enabled3d")){A=this.resolveDeltaPropertyValue(E,microstrategy.HTMLATTR_BORDER_3D_STYLE);D=this.resolveDeltaPropertyValue(E,microstrategy.HTMLATTR_BORDER_3D_WEIGHT);}this.parentBone.format3DItems(this.items,A,D,C);}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.processThemePropertyChanges=function(B,J){if(!B){return false;}var C=microstrategy.updateManager,I=this.parentBone.formattingAttributes,H=this.parentBone.parentBone.beanPath,G=microstrategy.getViewerBone().commands.queryState,E=function(M,O,L){var N=null,K=[];for(N in M){K.push(N);I[N]=I[N]||{};I[N]["thmid"]=O;I[N]["thmlnk"]=!!L;}J.push(C.createActionObject(null,mstrUpdateManager.APPLY_THEME,H,["2048292","2048076","2048293"],[O,K.join(mstrUpdateManager.ITEM_SEPARATOR),L]));},A=function(L){var M=null,K=[];for(M in L){K.push(M);I[M]=I[M]||{};I[M]["thmid"]=null;I[M]["thmlnk"]=false;}J.push(C.createActionObject(null,mstrUpdateManager.REMOVE_THEME,H,["2048076"],[K.join(mstrUpdateManager.ITEM_SEPARATOR)]));};var D=B.appliedThemeID||microstrategy.getViewerBone().commands.queryState("appliedThemeID"),F=("appliedThemeAsLink" in B)?B.appliedThemeAsLink:microstrategy.getViewerBone().commands.queryState("appliedThemeAsLink");if("appliedThemeType" in B){switch(B.appliedThemeType){case microstrategy.APPLIED_THEME_NONE:A(this.items);break;case microstrategy.APPLIED_THEME_DEFAULT:E(this.items,D,F);break;case microstrategy.APPLIED_THEME_CUSTOM:if(D&&!microstrategy.isDefaultTheme(D)){E(this.items,D,F);}else{showMessage({contents:"*You should choose one Theme before applying it.*",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return false;}break;}return true;}if("appliedThemeID" in B||"appliedThemeAsLink" in B){E(this.items,D,F);return true;}return false;};mstrDocSelectionsImpl.prototype.processSelectorPropertyChanges=function(A,N){try{if(!A){return false;}var Z=microstrategy.updateManager,T=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL),q=this.parentBone.parentBone.beanPath,C=false,R=T&&T.ctlKey,D=function(p,e,AF){N.push(Z.createActionObject(null,mstrUpdateManager["CTRL_"+p],q,["2048130"].concat(e),[R].concat(AF),[]));},E={MouseOverAction:{e:"SET_MOUSE_OVER_ACTION",a:"136"},ShowAll:{e:"SHOW_ALL_SETTING",a:"125"},AllAlias:{e:"SET_ALL_ALIAS",a:"134",c:1},ShowTotal:{e:"SET_SHOW_TOTAL",a:"169"},TotalPosition:{e:"SET_TOTAL_POSITION",a:"170",c:1},MultiSelect:{e:"MULTISELECT_SETTING",a:"120"},AutoSync:{e:"SET_AUTO_SYNC",a:"139"}},L=null;if(microstrategy.getViewerBone().commands.queryState("isDDIC")){var c=microstrategy.getViewerBone().doc.commands,y="EditSelectorTargets",S=["2048129","2048116"],P=["",A[y]],h=null;R=c.getDDICBoneProperty(this.items,"ctlKey",null);nk=c.getDDICBoneProperty(this.items,"key",null);if(y in A){if("DataFilterMode" in A){var AD=A.DataFilterMode;if(AD&&AD!="-1"){for(h in this.items){this.parentBone.formattingAttributes[h]=this.parentBone.formattingAttributes[h]||{},this.parentBone.formattingAttributes[h]["dfm"]=AD;}S.push("2048187");P.push(AD);}}c.setDDICBoneProperty(this.items,"targetKeys",A[y]);D("SET_TARGETS",S,P);}if("DataFilterMode" in A){if(!(y in A)){var W=A.DataFilterMode;for(h in this.items){this.parentBone.formattingAttributes[h]=this.parentBone.formattingAttributes[h]||{},this.parentBone.formattingAttributes[h]["dfm"]=W;}if(W!=-1){N.push(Z.createActionObject(null,mstrUpdateManager.RW_SET_CONTROL_DATA_FILTER_MODE,q,["2048130","2048187"],[R,W],[]));}}}if("selectorCurrentStateUC" in A||"selectorCurrentState" in A){var n=["2048130"],AC=[R];N.push(Z.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_UNSET_SELECTOR_CONTROL,q,n,AC,[]));}if("selectorCurrentState" in A||"UnsetCount" in A){var n=["2048130"],AC=[R];n[n.length]="2048204";if("UnsetCount" in A){AC[AC.length]=A.UnsetCount;this.parentBone.formattingAttributes[nk]["usc"]=A.UnsetCount;}else{AC[AC.length]=this.parentBone.formattingAttributes[nk]["usc"];}n[n.length]="2048203";if("selectorCurrentState" in A){AC[AC.length]=A.selectorCurrentState;this.parentBone.formattingAttributes[nk]["ust"]=A.selectorCurrentState;}else{AC[AC.length]=this.parentBone.formattingAttributes[nk]["ust"];}N.push(Z.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_CHANGE_UNSET_SELECTOR_PROPERTIES,q,n,AC,[]));}for(var X in E){var o="EditSelector"+X;if(o in A){var AB=E[X];var k=A[o];if(!AB.c){k=(k)?1:0;}D(AB.e,["2048"+AB.a],[k]);}}return C;}if("EditSelectorType" in A){L=A.EditSelectorType;T.setType(L,N);T.clearSource();T.clearReplaceAtt();}else{L=T.ctlType;}if("isDSAsTarget" in A){var AA=A.isDSAsTarget;if(AA){T.setTargetType(mstrRWControlImpl.CTL_TARGET_TYPE_DATASET);}else{T.setTargetType(mstrRWControlImpl.CTL_TARGET_TYPE_DOCUMENT);}}var M="EditSelectorSource"+(T.ctlStyle==7||T.ctlStyle==8?"Metrics":"");if(L==mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST){if(M in A){var J=A[M].split("|");T.setSource(J[0],J[1],J[2],N);}}if("EditSelectorSourceAttributes" in A&&L==mstrRWControlImpl.CTL_TYPE_ATTR_LIST){var J=A.EditSelectorSourceAttributes.split("|");T.setReplaceAtt(J[0],J[1],J[2],N);}if("EditFormDelimiter" in A){delimiter=A.EditFormDelimiter;T.setDelimiter(delimiter,N);}if("EditDisplayForm" in A){displayFormType=A.EditDisplayForm;T.setDisplayFormType(displayFormType,N);N.push(Z.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[]));}if("selectedAttrForms" in A){attrForms=A.selectedAttrForms;T.setAttrForms(attrForms,N);}if("sortAttrForm" in A){var G=A.sortAttrForm;if(G!="1"){sort={form:G};if("sortType" in A){sort.type=A.sortType;}T.setSortAttrForm(sort,N);}}var u=(L==mstrRWControlImpl.CTL_TYPE_PANEL_STACK||L==mstrRWControlImpl.CTL_TYPE_ATTR_LIST)?"SingleSelect":"",B="EditSelectorStyleMetricQual" in A,Y="EditSelectorStyleAction" in A;if(Y||B||"EditSelectorStyle" in A||"EditSelectorStyleSingleSelect" in A){var O=Y?A.EditSelectorStyleAction:B?A.EditSelectorStyleMetricQual:A["EditSelectorStyle"+u];if(!isNaN(O)){switch(O){case mstrRWControlImpl.CTL_STYLE_POOL_DOWN:A.EditSelectorMultiSelect=false;case mstrRWControlImpl.CTL_STYLE_LIST_BOX:A.EditSelectorOrientation=mstrRWControlImpl.ORIENTATION_VERTICAL;break;case mstrRWControlImpl.CTL_STYLE_RADIO_BUTTON:A.EditSelectorMultiSelect=false;break;case mstrRWControlImpl.CTL_STYLE_CHECKBOX:case mstrRWControlImpl.CTL_STYLE_SEARCH_BOX:A.EditSelectorMultiSelect=true;break;}var I=("EditSelectorMultiSelect" in A)?A.EditSelectorMultiSelect:T.multiSelect;T.setStyle(O,A.EditSelectorOrientation||T.ctlOrientation,I);N.push(Z.createActionObject(null,mstrUpdateManager.CTRL_SET_STYLE,q,["2048130","2048119"],[R,O],[]));}}if("EditSelectorOrientation" in A){N.push(Z.createEditPropsAction(null,R,q,["ctlOrientation"],[A.EditSelectorOrientation],null,true));if(!("EditSelectorStyle" in A)){T.setStyle(T.ctlStyle,A.EditSelectorOrientation,("EditSelectorMultiSelect" in A)?A.EditSelectorMultiSelect:T.multiSelect);}}if("EditSelectorMetricConditionType" in A){N.push(Z.createEditPropsAction(null,R,q,["mct"],[A.EditSelectorMetricConditionType],null,true));var n=!!T.unitKeyContext?["2048137"]:["2048130"],AC=!!T.unitKeyContext?[T.unitKeyContext]:[R];N.push(Z.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_UNSET_SELECTOR_CONTROL,q,n,AC,[]));}if("EditSelectorMultiSelect" in A){if(!("EditSelectorStyle" in A&&"EditSelectorOrientation" in A)){T.setStyle(T.ctlStyle,T.ctlOrientation,A.EditSelectorMultiSelect);}}if("DataFilterMode" in A){var y="EditSelectorTargets"+u;if(!(y in A)){var W=A.DataFilterMode;this.parentBone.formattingAttributes[R]["dfm"]=W;if(W!=-1){N.push(Z.createActionObject(null,mstrUpdateManager.RW_SET_CONTROL_DATA_FILTER_MODE,q,["2048130","2048187"],[R,W],[]));C=true;}}}var f=this;var H=function(){var AN;var AJ=-1;var p=false;if("EditSelectorType" in A){AN=A.EditSelectorType;s=(AN=="2")?"Metrics":u;}else{AN=microstrategy.getViewerBone().commands.queryState("EditSelectorType");s=(AN=="2")?"Metrics":u;}if(AN=="1"&&T.ctlTargetType==mstrRWControlImpl.CTL_TARGET_TYPE_DATASET){s="Dataset";}var AM="EditSelectorTargets"+s,AG=["2048129","2048116"],AP=["",A[AM]];if(T.ctlTargetType!==null&&T.ctlTargetType!==undefined){AG.push("2048260");AP.push(T.ctlTargetType);}if(AM in A){if("DataFilterMode" in A){var AJ=A.DataFilterMode;if(AJ&&AJ!="-1"){f.parentBone.formattingAttributes[R]["dfm"]=AJ;AG.push("2048187");AP.push(AJ);}}if(AN==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION&&(A.TXNSubmitInOrder||T.sio)){while(AG.length<7){AG.push("");AP.push("");}AG.push("2048280");AP.push("1");}T.targetKeys=A[AM].split(CLIPBOARD_ITEM_SEPARATOR);D("SET_TARGETS",AG,AP);return true;}else{if(AN=="1"&&"isDSAsTarget" in A){AP=["","",0];T.targetKeys=[];D("SET_TARGETS",AG,AP);}else{if(A.EditSelectorType=="2"){var AF=microstrategy.getViewerBone().commands.queryState("EditSelectorTargetsMetrics"),AO=[];for(var AI in AF){AO.push(AF[AI].dssid);}D("SET_TARGETS",AG,["",AO.join(CLIPBOARD_ITEM_SEPARATOR)]);}else{if(AN==mstrRWControlImpl.CTL_TYPE_ATTR_LIST){if("EditSelectorTargetsAttributes" in A){T.targetKeys=A.EditSelectorTargetsAttributes.split(CLIPBOARD_ITEM_SEPARATOR);AP=["",A.EditSelectorTargetsAttributes];D("SET_TARGETS",AG,AP);}if("EditSelectorCandidateAttributes" in A){var AL=A.EditSelectorCandidateAttributes.split(CLIPBOARD_ITEM_SEPARATOR);var e=[],AK=[],AH=[];AL.forEach(function(AR){var AQ=AR.split("|");e.push(AQ[0]);AK.push(AQ[1]);AH.push({dssid:AR,n:AQ[2],sty:AQ[1]});});T.candidateAtts=AH;AG=["","","","","","2048278","2048279"];AP=["","","","","",e.join(CLIPBOARD_ITEM_SEPARATOR),AK.join(CLIPBOARD_ITEM_SEPARATOR)];D("SET_TARGETS",AG,AP);}return true;}else{return false;}}}}};if(T.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK&&T.groupByTargetKeys){T.groupByTargetKeys=null;}if(!microstrategy.getViewerBone().autoWire){H();}else{if(!H()){var m=microstrategy.findBone(this.parentBone.commands.queryState("selectedSection"));var U;if(T.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){var K=m.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);T.targetKeys=K.length>0?K[0].getAttribute("id"):"";U=T.targetKeys;}else{var g=microstrategy.findBone(this.parentBone.commands.queryState("selectedSection"));var a=g.findObjects(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);a=a.concat(g.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK));var AE=[];var V={};for(var x=0,Q=a.length;x<Q;x++){var F=microstrategy.findBone(a[x])||a[x];var d=(F.objId||F.id);if(V[d]!=true){AE.push(d);V[d]=true;}}T.targetKeys=AE;U=AE.join(CLIPBOARD_ITEM_SEPARATOR);}D("SET_TARGETS",["2048129","2048116"],["",U]);}}if("selectorCurrentStateUC" in A||"selectorCurrentState" in A||(M in A&&("EditSelectorStyle" in A||microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE))){var n=!!T.unitKeyContext?["2048137"]:["2048130"],AC=!!T.unitKeyContext?[T.unitKeyContext]:[R];if("selectorCurrentStateUC" in A){this.parentBone.formattingAttributes[R]["isUs"]=A.selectorCurrentStateUC;}N.push(Z.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_UNSET_SELECTOR_CONTROL,q,n,AC,[]));}if("selectorCurrentState" in A||"UnsetCount" in A){var n=!!T.unitKeyContext?["2048137"]:["2048130"],AC=!!T.unitKeyContext?[T.unitKeyContext]:[R];n[n.length]="2048204";if("UnsetCount" in A){AC[AC.length]=A.UnsetCount;this.parentBone.formattingAttributes[R]["usc"]=A.UnsetCount;}else{AC[AC.length]=this.parentBone.formattingAttributes[R]["usc"];}n[n.length]="2048203";if("selectorCurrentState" in A){AC[AC.length]=A.selectorCurrentState;this.parentBone.formattingAttributes[R]["ust"]=A.selectorCurrentState;}else{AC[AC.length]=this.parentBone.formattingAttributes[R]["ust"];}N.push(Z.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_CHANGE_UNSET_SELECTOR_PROPERTIES,q,n,AC,[]));}if("actionSelectorType" in A){var n=!!T.unitKeyContext?["2048137"]:["2048130"],AC=!!T.unitKeyContext?[T.unitKeyContext]:[R];T.ast=A.actionSelectorType;T.updateDisplayText();n.push("2048226");AC.push(A.actionSelectorType);N.push(Z.createActionObject(null,mstrUpdateManager.SET_CTL_ACTIONS,q,n,AC,[]));}if(T.ast=="8"&&("postSubmitOption" in A||"runReportDocId" in A||"ShowSubmitMessage" in A||"SubmitMessage" in A||"ForceLiveExecution" in A||"InvalidateCache" in A||"AutoAnswerPrompt" in A)){this.processSelectorSubsequentChanges(A,T,N);}if(T.ast=="8"||T.ast=="4"){if("DisplayConfirmation" in A){T.dpCfm=A.DisplayConfirmation;N.push(Z.createEditPropsAction(null,R,q,["DisplayConfirmation"],[A.DisplayConfirmation],null,false));}if("OfflineSubmission" in A){T.os=A.OfflineSubmission;N.push(Z.createEditPropsAction(null,R,q,["OfflineSubmission"],[A.OfflineSubmission],null,false));}if("TXNSubmitInOrder" in A){T.sio=A.TXNSubmitInOrder;N.push(Z.createEditPropsAction(null,R,q,["TXNSubmitInOrder"],[A.TXNSubmitInOrder],null,false));}}if("DisplayText" in A){var n=!!T.unitKeyContext?["2048137"]:["2048130"],AC=!!T.unitKeyContext?[T.unitKeyContext]:[R];T.dpTxt=A.DisplayText;T.updateDisplayText();n.push("2048234");AC.push(T.dpTxt);N.push(Z.createActionObject(null,mstrUpdateManager.SET_CTL_DISPLAY_TEXT,q,n,AC,[]));}if("EditSelectorSelectionType" in A){var k=A.EditSelectorSelectionType;N.push(Z.createActionObject(null,mstrUpdateManager.CTRL_SET_INCLUDE,q,["2048130","2048224","2048001","2048009"],[R,k,T.ctlSrcId,T.ctlSrcType],[]));if(k==="0"){A.EditSelectorShowAll=false;}}for(var X in E){var o="EditSelector"+X;if(o in A){var AB=E[X];var k=A[o];if(!AB.c){k=(k)?1:0;}D(AB.e,["2048"+AB.a],[k]);}}}catch(z){microstrategy.errors.log(z);}return(C||microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);};mstrDocSelectionsImpl.prototype.processSelectorSubsequentChanges=function(C,G,N){var H=microstrategy.updateManager,A=this.parentBone.parentBone.beanPath,L=G.ctlKey,I=!!G.unitKeyContext?["2048137"]:["2048130"],M=!!G.unitKeyContext?[G.unitKeyContext]:[L],E={shSubMsg:"ShowSubmitMessage",fcLvExec:"ForceLiveExecution",invCache:"InvalidateCache",aapm:"AutoAnswerPrompt"},F=1,J=268435456,O=536870912,K=1073741824;for(var B in E){if(!(B in G)){G[B]=false;}if(E[B] in C){G[B]=C[E[B]];}}G.pso=C.postSubmitOption||G.pso||"0";if(G.shSubMsg){G.subMsg=C.SubmitMessage||G.subMsg||"";I.push("2048231");M.push(G.subMsg);}if(G.pso=="16"){G.execId=C.runReportDocId||G.execId||"";G.execObjTp=C.runObjectType||G.execObjTp||"";G.execName=C.runReportDocName||G.execName||"";if(G.execId){I.push("2048229","2048230","2048233");M.push(G.execId,G.execObjTp,G.execName);}else{G.pso="8";}}var D=G.pso;if(G.shSubMsg){D|=F;}if(G.fcLvExec){if(G.pso=="16"&&G.execId){D|=J;}else{G.fcLvExec=false;}}if(G.aapm){if(G.pso=="16"&&G.execId){D|=K;}else{G.aapm=false;}}if(G.invCache){D|=O;}I.push("2048228");M.push(D);N.push(H.createActionObject(null,mstrUpdateManager.SET_CTL_SUBSEQUENT_ACTIONS,A,I,M,[]));};mstrDocSelectionsImpl.prototype.processRoundedCornerChanges=function(B,I){try{if(!B){return ;}if("HasRoundedCorners" in B){this.processFormatProperty(this.setSingleFormat("HasRoundedCorners",B.HasRoundedCorners),I);}var F=this;var A=function(J,K){return(J)?B[K]:F.parentBone.commands.queryState(K);};var G=("Radius" in B);var C=("TopCornersOnly" in B);var H=A(G,"Radius");var E=function(J){F.processFormatProperty(F.setSingleFormat(J+"CornerRadius",H),I);};if(G){E("topLeft");E("topRight");}if(G||C){H=(A(C,"TopCornersOnly"))?0:H;E("bottomLeft");E("bottomRight");}}catch(D){microstrategy.errors.log(D);}};mstrDocSelectionsImpl.prototype.getSelectedControlBone=function(C){try{var B=this.getSelectedControl(C);if(B){return mstrStaticDoc.getBone(B);}}catch(A){microstrategy.errors.log(A);}return null;};mstrDocSelectionsImpl.prototype.processGraphPropertyChanges=function(E,H,G,F){try{for(var I in E){var B=E[I].getAttribute("id");var D=document.getElementsByName(B);if(D[0].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(D[0]);if(A&&A.isGraph){H=(H==null)?A.commands.queryState("gridPosition"):H;G=(G==null)?A.commands.queryState("gridFactor"):G;A.adjustGraphSize(H,G,F);if(this.parentBone.commands.refreshOnWindowChange(E[I],microstrategy.findBone(E[I]))){return true;}}}}return false;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.setFormat=function(Q,F,C){try{var G=this.parentBone.parentBone.updateManager;var D=false;var I=[];var H=null;switch(Q){case"formatBulk":for(var O=0;O<F.length;O++){var L=F[O].split("|");var A=L[0];var J=L[1];switch(A){case"borderTop":case"borderRight":case"borderLeft":case"borderBottom":var R=J.split(",");var N=(R.length>0)?R[0]:"";var M=(R.length>1)?R[1]:"";var P=(R.length>2)?R[2]:"";I=this.parentBone.formatItemBorders(this.items,new Array(A),P,M,N,false,I);break;case"LineSettingColor":case"LineSettingWeight":case"LineSettingStyle":var B="lineColor";if(A=="LineSettingWeight"){B="lineWeight";}else{if(A=="LineSettingStyle"){B="lineStyle";}}this.parentBone.formatLineSetting(this.items,B,J,false,I);break;case"FillColor":this.processFormatProperty(this.setSingleFormat(A,J),I,C);if(J.indexOf(",")<0){this.processFormatProperty(this.setSingleFormat("FillStyle",J),I,C);}this.parentBone.format3DItems(this.items,null,null,I);break;case"border3D":var R=J.split(",");var K=(R.length>0)?R[1]:"";var P=(R.length>1)?R[0]:"";this.parentBone.format3DItems(this.items,P,K,I);if(I.forceSubmit){D=true;}break;default:this.processFormatProperty(this.setSingleFormat(A,J),I);}}microstrategy.eventManager.notifyOrphanBones("onformatchange");break;case"PropertyChanges":this.processPropertyChanges(F);break;case"FillColor":case"bgcolor":this.processFormatProperty(this.setSingleFormat("FillColor",F),I,C);if(F.indexOf(",")<0){this.processFormatProperty(this.setSingleFormat("FillStyle",F),I,C);}this.parentBone.format3DItems(this.items,null,null,I);break;case"bgcolorgradient":this.processFormatProperty(this.setSingleFormat("Gradient",F),I,C);this.parentBone.format3DItems(this.items,null,null,I);break;default:this.processFormatProperty(this.setSingleFormat(Q,F),I);}if(I&&I.length>0){G.add(I);}if(D==true&&I.length>0){G.flushAndSubmitChanges();}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrDocSelectionsImpl.prototype.setCommonBoneProperty=function(F,L,A,I,D,J){try{var H=mstrFormatObject;var E=this.parentBone.parentBone.updateManager;for(var B in F){if(F[B].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&F[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==D){var K=mstrStaticDoc.getBone(F[B]);if(K){K[L]=I;var G=K.ctlKey+mstrUpdateManager.UNIT_SEPARATOR+H[A][mstrFormatObject.PROP_SET]+mstrUpdateManager.UNIT_SEPARATOR+A+mstrUpdateManager.UNIT_SEPARATOR+I;J.push(E.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,G],[]));}}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.setSingleFormat=function(D,A){try{var C=[];C=microstrategy.setSingleFormat(D,A);return C;}catch(B){microstrategy.errors.log(B);return null;}};mstrDocSelectionsImpl.prototype.setNumberFormat=function(F,D){try{var E=microstrategy.updateManager;var J=mstrUpdateManager.FIELD_NUMBER_FORMAT;var A=this.parentBone.parentBone.beanPath;var G=[2048012,2048183];var I=D;if(F=="number"){G[1]=G[1]+parseInt(D,10);I=1;}var H=this.parentBone.selections.items;for(var B in H){E.add([E.createActionObject(H[B],J,A,G,[B,I],[],null)]);}if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){E.flushAndSubmitChanges();}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.setBorderFormat=function(S,G){try{var U=[];var N="";var Q="";var O="";this.parentBone.format3DItems(this.items,"0",null,U);if(S=="lnstyle"){var M=microstrategy.getFormatObject().decodeValue("borderTopStyle",G).split(" ");N=M[0];Q=M[1];}else{O=G;}for(var K in this.items){var L=this.items[K];var A={id:this.items[K]};var I=Q;var C=N;var H=O;var R=microstrategy.subObjectType(L);if(R==microstrategy.SUBOBJTYPE_DOC_LINE||R==microstrategy.SUBOBJTYPE_DOC_SHAPE){if(R==microstrategy.SUBOBJTYPE_DOC_LINE){var J=Math.ceil(parseFloat(N))+"pt";if(S=="lnstyle"&&(!J||parseInt(J,10)==0)){continue;}else{C=J;}}else{if(this.styleObj.getValue(L,"lineStyle").indexOf("none")>-1||this.styleObj.getValue(L,"lineWeight").indexOf("0pt")>-1){I=I||mstrDocSelectionsImpl.DEFAULT_LINE_STYLE;C=C||mstrDocSelectionsImpl.DEFAULT_LINE_WIDTH;H=H||mstrDocSelectionsImpl.DEFAULT_LINE_COLOR;}}if(I){this.parentBone.formatLineSetting(A,"lineStyle",I,true,U);}if(C){this.parentBone.formatLineSetting(A,"lineWeight",C,true,U);}if(H){this.parentBone.formatLineSetting(A,"lineColor",H,true,U);}}else{var E=this.checkborders(L);if(E==mstrDocSelectionsImpl.NOBORDERS){E=mstrDocSelectionsImpl.ALLBORDERS;I=I||mstrDocSelectionsImpl.DEFAULT_LINE_STYLE;C=C||mstrDocSelectionsImpl.DEFAULT_LINE_WIDTH;H=H||mstrDocSelectionsImpl.DEFAULT_LINE_COLOR;}var B=[];var D=["Top","Bottom","Left","Right"];for(var P=0;P<4;P++){var T=D[P];if(E==mstrDocSelectionsImpl.ALLBORDERS||(mstrDocSelectionsImpl[T.toUpperCase()+"BORDER"]&E)>0){B.push("border"+T);}}this.parentBone.formatItemBorders(A,B,I,C,H,true,U);}}if(this.parentBone.parentBone.observer){this.parentBone.parentBone.observer.notifyAll("onBorderStyleChange");}if(U.length>0){microstrategy.updateManager.add(U);}}catch(F){microstrategy.errors.log(F);}};mstrDocSelectionsImpl.prototype.enableBorders=function(J){try{var N=[];this.parentBone.format3DItems(this.items,"0",null,N);var K={};K[mstrDocSelectionsImpl.TOPBORDER]="Top";K[mstrDocSelectionsImpl.BOTTOMBORDER]="Bottom";K[mstrDocSelectionsImpl.LEFTBORDER]="Left";K[mstrDocSelectionsImpl.RIGHTBORDER]="Right";for(var G=0,C=J.length;G<C;G++){var M=J[G];var B=(M.cl)?mstrDocSelectionsImpl.DEFAULT_LINE_WIDTH:"0pt";var A=mstrDocSelectionsImpl.DEFAULT_LINE_STYLE;var E=mstrDocSelectionsImpl.DEFAULT_LINE_COLOR;var I=[];var L=parseInt(M.v[0],10);if(L==mstrDocSelectionsImpl.NOBORDERS||L==mstrDocSelectionsImpl.ALLBORDERS){I=["borderTop","borderRight","borderBottom","borderLeft"];if(L==mstrDocSelectionsImpl.NOBORDERS){B="0pt";}}else{for(var F=0,H=M.v.length;F<H;F++){I.push("border"+K[M.v[F]]);}}this.parentBone.formatItemBorders(this.items,I,A,B,E,true,N);}this.parentBone.parentBone.updateManager.add(N);}catch(D){microstrategy.errors.log(D);}};mstrDocSelectionsImpl.prototype.checkFormat=function(d,e){try{var P=microstrategy.getFormatObject();var I=null;var Y=null;var O,m;var V,a,M;var A=this.firstItem();var Q=(this.isSingleSelectionType&&A&&(A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK));var D=this.isOnlyOneTableSelected()&&this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(microstrategy.findBone(this.firstItem())!=null){Q&=!microstrategy.findBone(this.firstItem()).isTable;}var W=this.isOnlyOneGridSelected();var c=this.isSelectorControlSelected();var H=mstrDocSelectionsImpl.TCF[d];if(D&&parseInt(this.panelUnitFormat)>1&&H){switch(d){case"font":case"fsize":case"TextUnderline":case"TextStrikeout":case"color":case"FillColor":case"LineSettingColor":case"LineSettingWeight":return D.getFormat({u:this.panelUnitFormat,f:this.panelValueFormat,p:H});case"ShapeSettingStyle":return P.encodeValue("lineStyle",D.getFormat({u:this.panelUnitFormat,f:this.panelValueFormat,p:H}));case"BoldItalic":var U=D.getFormat({u:this.panelUnitFormat,f:this.panelValueFormat,p:"fb"}),S=D.getFormat({u:this.panelUnitFormat,f:this.panelValueFormat,p:"fi"});return(U?1:0)+(S?2:0);}}switch(d){case"Wmode11":case"Wmode12":case"Wmode13":case"Wmode":return(this.isActive())?this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_WIDTH_MODE,"widthMode"):"";case"Hmode11":case"Hmode12":case"Hmode13":case"Hmode":return(this.isActive())?this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_HEIGHT_MODE,"heightMode"):"";case"Lmode":return this.evaluateLineProperties(this.items,"lengthMode");case"Width":case"SubWidth":Y=this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_WIDTH,"width");return(this.isActive()&&Y!=null&&Y.length!=0)?microstrategy.number.toUserUnits(Y):"";case"Height":case"SubHeight":Y=this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_HEIGHT,"height");return(this.isActive()&&Y!=null&&Y.length!=0)?microstrategy.number.toUserUnits(Y):"";case"Length":return this.evaluateLineProperties(this.items,"length");case"AutoResize":return(this.isActive())?this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_AUTO_RESIZE_IN_DESIGNMODE):"";case"Shrink":var N=this.getFormatFromHContainer(microstrategy.HTMLATTR_CAN_SHRINK);if(N!=undefined){return N==-1;}return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_CAN_SHRINK)==-1);case"ShrinkHorizontal":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL)==-1);case"Grow":var N=this.getFormatFromHContainer(microstrategy.HTMLATTR_CAN_GROW);if(N!=undefined){return N==-1;}return this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_CAN_GROW)==-1;case"SelectionColor":return(this.isActive())?((this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE)=="1")?this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR):"automatic"):"automatic";case"GrowHorizontal":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL)==-1);case"HideIfEmpty":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_HIDE_IF_EMPTY)==-1);case"MaxHeight":return(this.isActive())?microstrategy.number.toUserUnits(this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_MAX_HEIGHT)):"";case"MaxWidth":return(this.isActive())?microstrategy.number.toUserUnits(this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_MAX_WIDTH)):"";case"FitExcelRowHeight":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_FIT_EXCEL_ROW_HEIGHT)==-1);case"Keep":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_KEEP_SECTION_TOGETHER)==-1);case"Repeat":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_REPEAT_SECTION)==-1);case"showInRptCp":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_SHOW_IN_RPT_COPY)==-1);case"RepeatHoriz":return(this.isActive()&&this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_REPEAT_HORIZONTALLY)==-1);case"NewPage":return(this.isActive())?this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_FORCE_NEW_PAGE):"";case"Locked":Y=this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_LOCKED,"locked");return(this.isActive()&&Y!=null&&Y.length!=0&&Y==-1);case"InitialSlidingInWidth":Y=(this.isActive())?this.getCommonFormatValue(this.items,"InitialSlidingInWidth",microstrategy.FORMAT_TYPE_MAIN):0;if(Y==null||Y.length==0){return"";}return(Y==0)?"0":microstrategy.number.toUserUnits(P.encodeValue("InitialSlidingInWidth",Y));case"InitialSlidingInHeight":Y=(this.isActive())?this.getCommonFormatValue(this.items,"InitialSlidingInHeight",microstrategy.FORMAT_TYPE_MAIN):0;if(Y==null||Y.length==0){return"";}return(Y==0)?"0":microstrategy.number.toUserUnits(P.encodeValue("InitialSlidingInHeight",Y));case"Left":Y=(this.isActive())?this.getCommonFormatValue(this.items,"left",microstrategy.FORMAT_TYPE_MAIN):0;if(Y==null||Y.length==0){return"";}return(Y==0)?"0":microstrategy.number.toUserUnits(P.encodeValue("left",parseInt(Y)));case"Top":Y=(this.isActive())?this.getCommonFormatValue(this.items,"top",microstrategy.FORMAT_TYPE_MAIN):0;if(Y==null||Y.length==0){return"";}return(Y==0)?"0":microstrategy.number.toUserUnits(P.encodeValue("top",parseInt(Y)));case"LineSpacing":a=this.getCommonFormatValue(this.items,"lineHeight");if(a!=null){a=P.encodeValue("lineHeight",a);}return a;case"Horizontal":case"align":case"TextAlign":if(this.isOnlyOneGridSelected()){return this.getCommonFormatValue(this.items,"textAlign","GRID");}else{Y=P.encodeValue("textAlign",this.getCommonFormatValue(this.items,"textAlign"));return(isNaN(Y))?0:Y;}case"Vertical2":if(this.isOnlyOneGridSelected()){return this.getCommonFormatValue(this.items,"verticalAlign","GRID");}else{return P.encodeValue("verticalAlign2",this.getCommonFormatValue(this.items,"verticalAlign"));}break;case"Vertical":if(!this.isGridSelected()){Y=P.encodeValue("verticalAlign",this.getCommonFormatValue(this.items,"verticalAlign"));return Y;}break;case"lnsize":return this.getCommonFormatValue(this.items,borderWidth);case"LineSettingColor":case"ShapeSettingStyle":case"LineSettingStyle":case"LineSettingWeight":case"lncolor":case"lnstyle":a="";var k=microstrategy.HTMLATTR_LINE_COLOR;I="lineColor";if(d=="LineSettingWeight"){k=microstrategy.HTMLATTR_LINE_WEIGHT;I="lineWeight";}else{if(d=="LineSettingStyle"||d=="ShapeSettingStyle"){k=microstrategy.HTMLATTR_LINE_STYLE;I="lineStyle";}else{if(d=="lncolor"){k=microstrategy.HTMLATTR_BORDER_TOP_COLOR;I="borderTopColor";}else{if(d=="lnstyle"){k=microstrategy.HTMLATTR_BORDER_TOP_STYLE;I="borderTopStyle";}}}}if(this.isActive()){A=true;for(V in this.items){if(microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_LINE||microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_SHAPE){if(d=="lncolor"){k=microstrategy.HTMLATTR_LINE_COLOR;I="lineColor";}else{if(d=="lnstyle"){k=microstrategy.HTMLATTR_LINE_STYLE;I="lineStyle";}}}var G,F,R,q;if(this.parentBone.checkAppliesTo(this.items[V],I)){if(A){a=this.styleObj.getAttValue(this.items[V],k);if(d=="lnstyle"){if(microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_LINE||microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_SHAPE){G=a;F=this.styleObj.getAttValue(this.items[V],"lw");R=P.decodeValue("lineStyle",G);q=P.encodeValue("borderTopStyle",F+"pt "+R);a=q;}}A=false;if(this.hasNoBorder(this.items[V])){return 0;}}Y="";Y=this.styleObj.getAttValue(this.items[V],k);if(d=="lnstyle"){if(microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_LINE||microstrategy.subObjectType(this.items[V])==microstrategy.SUBOBJTYPE_DOC_SHAPE){G=Y;F=this.styleObj.getAttValue(this.items[V],"lw");R=P.decodeValue("lineStyle",G);q=P.encodeValue("borderTopStyle",F+"pt "+R);Y=q;}}if(Y!=a){return null;}}}}return(d.toLowerCase().indexOf("color")>0)?P.decodeValue("borderRightColor",a):a;break;case"enabled3d":if(this.isActive()){for(V in this.items){a=this.styleObj.getAttValue(this.items[V],"b3dstyle");if(a!="1"&&a!="2"){return 0;}}return 1;}return 0;case"b3dstyle":case"b3dweight":if(this.isActive()){M=this.styleObj.getAttValue(this.firstItem(),d);a=null;for(V in this.items){a=this.styleObj.getAttValue(this.items[V],d);if(a!=M){return null;}}if(d=="b3dstyle"&&parseInt(a)==0){a=1;}return a;}return false;case"DisplayStyle":return this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_DISPLAY_STYLE);case"NormalURL":return this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_NORMAL_URL);case"HighlightURL":return this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_HIGHLIGHT_URL);case"BackgroundHighlightColor":var C=this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_BACKGROUND_HIGHLIGHT_COLOR);return mstrFormatObject.decodeValue("color",C!=null?C:"-1");case"FontHighlightColor":var T=this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_FONT_HIGHLIGHT_COLOR);return mstrFormatObject.decodeValue("color",T!=null?T:"-1");case"FillEffect":return this.parentBone.commands.getCommonAttValue(this.items,microstrategy.HTMLATTR_FILL_EFFECT);}var K=null;var X=null;if(this.isOnlyOnePanelStackSelected()){X=this.panelValueFormat+1;}else{if(this.isSelectorControlSelected()){X=this.controlValueFormat+1;}else{if(W){if(this.resolveGridFormat().unit>microstrategy.GRID_UNIT_CONTAINER){X="GRID";}else{if(this.gridValueFormatX==2){X=2;}}K=X;}}}var Z;switch(d){case"BoldItalic":var u=this.getCommonFormatValue(this.items,"fontWeight",X),m=this.getCommonFormatValue(this.items,"fontStyle",X);if(u==m&&m=="default"){return -2;}var g=0;if(u=="bold"){g+=1;}if(m=="italic"){g+=2;}return g;case"TextUnderline":Z=this.getCommonFormatValue(this.items,"textDecoration",X);return(Z&&Z.indexOf("underline")>-1);case"TextStrikeout":Z=this.getCommonFormatValue(this.items,"textDecoration2",X);return(Z&&Z.indexOf("line-through")>-1);case"Bold":return(this.getCommonFormatValue(this.items,"fontWeight",X)=="bold");case"Italic":return(this.getCommonFormatValue(this.items,"fontStyle",X)=="italic");case"Underline":Z=this.getCommonFormatValue(this.items,"textDecoration",X);return(Z&&Z.indexOf("underline")>-1);case"fstyle":var L=this.checkFormat("BoldItalic");if(this.checkFormat("TextUnderline")){L+=4;}if(this.checkFormat("TextStrikeout")){L+=8;}return L;case"FontSize":case"fsize":return P.encodeValue("fontSize",this.getCommonFormatValue(this.items,"fontSize",X));case"FontColor":case"color":return this.getCommonFormatValue(this.items,"color",X);case"FontFamily":case"font":return this.getCommonFormatValue(this.items,"fontFamily",X);case"FillColor":var h=this.checkFormat("gradientcolor");if(h){return h;}case"bgcolor":I="backgroundColor";if(Q||D){if(D){if(this.panelValueFormat==0){var u=microstrategy.findBone(this.firstItem());a=this.styleObj.getValue(u.getCurrentPanel().elem,I);for(V in this.items){u=microstrategy.findBone(this.items[V]);Y=this.styleObj.getValue(u.getCurrentPanel().elem,I);if(Y!=a){return null;}}return a;}return null;}else{if(this.panelValueFormat==0){var u=microstrategy.findBone(this.firstItem());a=this.styleObj.getValue(u.getCurrentPanel().elem,I);for(V in this.items){u=microstrategy.findBone(this.items[V]);Y=this.styleObj.getValue(u.getCurrentPanel().elem,I);if(Y!=a){return null;}}}else{a=this.styleObj.getValue(this.firstItem(),I,mstrPanelStack.FMT_TYPE_TITLE);for(V in this.items){Y=this.styleObj.getValue(this.items[V],I,mstrPanelStack.FMT_TYPE_TITLE);if(Y!=a){return null;}}}return a;}}else{if(c&&this.isSingleSelectionType){if(this.controlValueFormat==0){var u=microstrategy.findBone(this.firstItem().lastChild);a=this.styleObj.getValue(u.elem.parentNode,I);}else{a=this.styleObj.getValue(this.firstItem(),I,mstrRWControlImpl.FMT_TYPE_TITLE);}return a;}else{return this.getCommonFormatValue(this.items,I,X||microstrategy.formatType);}}case"gradientcolor":O=this.firstItem();if(O){a=this.parentBone.getGradientColor(((O.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&microstrategy.formatType==mstrRWControlImpl.FMT_TYPE_TITLE)?O.lastChild:O),X||microstrategy.formatType,e);if(O.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){return a;}for(V in this.items){if(this.items[V]!=O){Y=this.parentBone.getGradientColor(this.items[V],X||microstrategy.formatType,e);if(Y!=a){return null;}}}}return a;case"propBorderStyle":case"propButtonBorderStyle":if(this.isOnlyOnePanelStackSelected()&&this.panelValueFormat==1){return 0;}else{if(W&&this.isGridContainerSelected()&&this.gridValueFormatX==2){return 0;}else{if(K){return this.styleObj.getValue(this.firstItem(),d,K);}else{return this.checkBorderStyle();}}}case"AllColor":var J=this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_BORDER_LEFT_COLOR,K);return(J&&(typeof (J)!="string"||J.indexOf("#")==-1))?P.decodeValue("borderLeftColor",J):J;case"AllStyle":var B=this.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_BORDER_LEFT_STYLE,K);return(B==0)?1:B;case"TopColor":case"LeftColor":case"RightColor":case"BottomColor":case"TopStyle":case"LeftStyle":case"RightStyle":case"BottomStyle":if(!this.isActive()){return null;}var E=(d.indexOf("Style")>-1);var f=(E)?"Style":"Color";I=microstrategy["HTMLATTR_BORDER_"+d.replace(f,"").toUpperCase()+"_"+f.toUpperCase()];Z=this.styleObj.getAttValue(this.firstItem(),I,K);for(V in this.items){if(this.styleObj.getAttValue(this.items[V],I,K)!=Z){return null;}}if(isNaN(Z)&&(Z==""||Z==null)){return null;}if(!E&&Z!=null&&(typeof (Z)!="string"||Z.indexOf("#")==-1)){Z=P.decodeValue("borderLeftColor",Z);}return Z;case"borders":case"Borders":if(K){return this.styleObj.getValue(this.firstItem(),d,K);}else{M=this.checkborders(this.firstItem());a=0;for(V in this.items){a=this.checkborders(this.items[V]);if(a!=M){return[0];}}return microstrategy.resolveBorderFlags(a,(d=="borders"));}case"GridHorizontal":case"Vertical":var o=(d=="Vertical")?"verticalAlign":"textAlign2";Y=this.getCommonFormatValue(this.items,o,K);return(isNaN(Y))?0:Y;case"SelectorVertical":Y=P.encodeValue("verticalAlign",this.getCommonFormatValue(this.items,"verticalAlign",K));return(isNaN(Y))?0:Y;case"TextWrap":return(this.getCommonFormatValue(this.items,"whiteSpace",K)!="nowrap");case"TextDirection":case"TextDirectionGrid":return this.getCommonFormatValue(this.items,"TextDirection",K);case"LeftPadding":case"TopPadding":case"RightPadding":case"BottomPadding":I="paddingLeft";if(d=="TopPadding"){I="paddingTop";}if(d=="RightPadding"){I="paddingRight";}if(d=="BottomPadding"){I="paddingBottom";}a=this.getCommonFormatValue(this.items,I,K);if(a!=null){a=microstrategy.number.toUserUnits(parseFloat(a)/72);}return a;}}catch(n){microstrategy.errors.log(n);}return"";};mstrDocSelectionsImpl.prototype.getFormatFromHContainer=function(C){if(!this.isActive()){return false;}var A=microstrategy.findBone(this.firstItem());if(A&&A.isHorizontal){var B=microstrategy.findAncestorWithAtt(this.firstItem(),microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(B){return this.styleObj.getAttValue(B,C);}}};mstrDocSelectionsImpl.prototype.getGridFormatInfo=function(C){if(!this.useGridFormat(C)){return null;}var B=(C)?this.allGridUnitFormat:this.gridUnitFormatX;var A=(C)?this.allGridValueFormat:this.gridValueFormatX;return{unit:B,format:A};};mstrDocSelectionsImpl.prototype.useGridFormat=function(A){return(this.isOnlyOneGridSelected()&&!(A&&(this.isGridContainerSelected())));};mstrDocSelectionsImpl.prototype.getGridFormat=function(A,C){var B=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);return B.getFormatValue(this.getGridFormatInfo(C),A);};mstrDocSelectionsImpl.prototype.resolveGridFormat=function(C,B){try{if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&C==null&&B==null){var A=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(A){return A.commands.queryState("GridSelections");}}else{var E={value:B||this.gridValueFormatX};E.unit=(C==null)?this.gridUnitFormatX:C;return E;}}catch(D){microstrategy.errors.log(D);}return{};};mstrDocSelectionsImpl.prototype.resolvePanelsFormat=function(B,A){try{var D={};D.unit=(B==null)?this.panelUnitFormat:B;D.value=(A==null)?this.panelValueFormat:A;return D;}catch(C){microstrategy.errors.log(C);}return{};};mstrDocSelectionsImpl.prototype.resolveControlFormat=function(B,A){try{var D={};D.unit=(B==null)?this.controlUnitFormat:B;D.value=(A==null)?this.controlValueFormat:A;return D;}catch(C){microstrategy.errors.log(C);}return{};};mstrDocSelectionsImpl.prototype.isGridContainerSelected=function(){if(this.isOnlyOneGridSelected()){var A=microstrategy.findBone(this.getSelectedGrid()),A=A&&A.commands.queryState("isGraphSelected");if(A){return false;}}return(this.gridUnitFormatX==microstrategy.GRID_UNIT_CONTAINER);};mstrDocSelectionsImpl.prototype.resolveFormatType=function(A,B){if(A.indexOf("Panels")>-1){microstrategy.formatType=parseInt(B.value,10)+1;}else{if(A.indexOf("Control")>-1){microstrategy.formatType=parseInt(B.value,10)+1;}else{if(parseInt(B.unit,10)==microstrategy.GRID_UNIT_CONTAINER){microstrategy.formatType=parseInt(B.value,10);}else{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}}};mstrDocSelectionsImpl.prototype.verifyFormatLevels=function(H){try{if(!H){return ;}var G=this.isOnlyOneGridSelected();var B=this.isOnlyOnePanelStackSelected();var E=this.isOnlyOneTableSelected();var F=this.isSelectorControlSelected();if(!G&&!B&&!F){return ;}var D=null;var I="";if(G){I="Grid";if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&!this.isGridContainerSelected()){var C=(this.parentBone.commands.queryState("IsPortal"))?2:1;D=this.resolveGridFormat(microstrategy.GRID_UNIT_CONTAINER,Math.min(this.gridValueFormatX,C));}else{switch(H){case"color":if(this.isGridContainerSelected()){if(!this.parentBone.commands.queryState("IsPortal")&&this.gridValueFormatX!=1){D=this.resolveGridFormat(null,1);}}break;case"font":if(this.isGridContainerSelected()){if(!this.parentBone.commands.queryState("IsPortal")){D=this.resolveGridFormat(microstrategy.GRID_OTHER,2);}else{if(this.gridValueFormatX!=2){D=this.resolveGridFormat(null,2);}}}else{if(this.gridUnitFormatX==microstrategy.GRID_BORDERS){D=this.resolveGridFormat(microstrategy.GRID_UNIT_CONTAINER,2);}}break;default:if(this.gridUnitFormatX<microstrategy.GRID_OTHER){D=this.resolveGridFormat(microstrategy.GRID_OTHER,2);}break;}}}else{if(B){I="Panels";if(H=="color"){if((this.panelUnitFormat==1||!this.parentBone.commands.queryState("IsPortal"))&&this.panelValueFormat==1){D=this.resolvePanelsFormat(null,0);}if(E){D=this.resolvePanelsFormat(0,0);}}else{if(H=="font"){if(this.parentBone.commands.queryState("IsPortal")){D=this.resolvePanelsFormat(null,1);}}else{if(H="effect"){D=this.resolvePanelsFormat(null,0);}}}}else{if(F){}}}if(D){this.setObjectFormatLevel(I,D);}}catch(A){microstrategy.errors.log(A);}};mstrDocSelectionsImpl.prototype.resetObjectFormatLevel=function(){try{if(this.isOnlyOneGridSelected()){this.setObjectFormatLevel("Grid",this.resolveGridFormat(microstrategy.GRID_UNIT_CONTAINER,1));}else{if(this.isOnlyOnePanelStackSelected()){this.setObjectFormatLevel("Panels",this.resolvePanelsFormat(0,0));}else{if(this.isSelectorControlSelected()){this.setObjectFormatLevel("Control",this.resolveControlFormat(0,0));}}}}catch(A){microstrategy.errors.log(A);}};mstrDocSelectionsImpl.prototype.setObjectFormatLevel=function(A,C){try{this.resolveFormatType(A,C);if(A.indexOf("Panels")>-1){this.panelUnitFormat=parseInt(C.unit,10);this.panelValueFormat=parseInt(C.value,10);this.parentBone.parentBone.commands.exec("proxyForGridObservers","ongridselectionschange");}else{if(A.indexOf("Control")>-1){this.controlUnitFormat=parseInt(C.unit,10);this.controlValueFormat=parseInt(C.value,10);this.parentBone.parentBone.commands.exec("proxyForGridObservers","ongridselectionschange");}else{this.gridUnitFormatX=parseInt(C.unit,10);this.gridValueFormatX=parseInt(C.value,10);var D=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(D&&D.commands&&D.isGrid){D.commands.exec("setGridUnitSelections",C);}if(C.unit<microstrategy.GRID_OTHER){this.parentBone.parentBone.commands.exec("proxyForGridObservers","ongridselectionschange");}}}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.fetchObjectFormatLevelFromGrid=function(){try{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){return ;}var C=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(C&&C.commands){var B=C.commands.queryState("GridSelections");if(!B){return ;}this.gridUnitFormatX=B.unit;this.gridValueFormatX=B.value;}}catch(A){microstrategy.errors.log(A);}};mstrDocSelectionsImpl.prototype.getCachedObjectFormatLevels=function(){try{if(!this.isOnlyOneGridSelected()&&!this.isOnlyOnePanelStackSelected()){return null;}return{id:this.firstItem().getAttribute("id"),unit:this.gridUnitFormatX,value:this.gridValueFormatX};}catch(A){microstrategy.errors.log(A);return null;}};mstrDocSelectionsImpl.prototype.evaluateLineProperties=function(J,C){try{var H="";var D=false;var I={};var L={};var K;var M;var A=false;var B=false;for(var F in J){if(C&&!microstrategy.isEnabledForItem(J[F],C)){continue;}var E=this.parentBone.styleObj.getAttValue(J[F],microstrategy.HTMLATTR_ORIENTATION);if(E=="0"){L[J[F].id]=J[F];A=true;}if(E=="1"){I[J[F].id]=J[F];B=true;}}if(C=="lengthMode"){if(B&&A){K=this.parentBone.commands.getCommonAttValue(I,microstrategy.HTMLATTR_HEIGHT_MODE,"heightMode",true);M=this.parentBone.commands.getCommonAttValue(L,microstrategy.HTMLATTR_WIDTH_MODE,"widthMode",true);return(K==M&&B&&A)?K:"";}else{if(B){return this.parentBone.commands.getCommonAttValue(I,microstrategy.HTMLATTR_HEIGHT_MODE,"heightMode",true);}else{return this.parentBone.commands.getCommonAttValue(L,microstrategy.HTMLATTR_WIDTH_MODE,"widthMode",true);}}}else{if(C=="length"){if(B&&A){K=this.parentBone.commands.getCommonAttValue(I,microstrategy.HTMLATTR_HEIGHT,"height",true);M=this.parentBone.commands.getCommonAttValue(L,microstrategy.HTMLATTR_WIDTH,"width",true);return(K!=null&&K.length!=0&&K==M)?microstrategy.number.toUserUnits(K):"";}else{if(B){K=this.parentBone.commands.getCommonAttValue(I,microstrategy.HTMLATTR_HEIGHT,"height",true);return(K!=null&&K.length!=0)?microstrategy.number.toUserUnits(K):"";}else{M=this.parentBone.commands.getCommonAttValue(L,microstrategy.HTMLATTR_WIDTH,"width",true);return(M!=null&&M.length!=0)?microstrategy.number.toUserUnits(M):"";}}}}return null;}catch(G){microstrategy.errors.log(G);return null;}};mstrDocSelectionsImpl.prototype.getCommonFormatValue=function(B,G){try{var A="";var D=false;for(var F in B){if(G&&!microstrategy.isEnabledForItem(B[F],G)){continue;}var C=this.styleObj.getValue(B[F],G);if(!D){A=C;D=true;}if(C!=A){return null;}}return A;}catch(E){microstrategy.errors.log(E);return null;}};mstrDocSelectionsImpl.prototype.getCommonFormatValue=function(H,A,F){try{var G="";var B=false;for(var C in H){if(A&&!microstrategy.isEnabledForItem(H[C],A)){continue;}var I=this.styleObj.getValue(H[C],A,F);var D={left:{p:microstrategy.HTMLATTR_WIDTH_MODE.toString(),o:microstrategy.ORIENTATION_HORIZONTAL.toString(),v:microstrategy.HTMLATTR_OLD_LEFT.toString()},top:{p:microstrategy.HTMLATTR_HEIGHT_MODE.toString(),o:microstrategy.ORIENTATION_VERTICAL.toString(),v:microstrategy.HTMLATTR_OLD_TOP.toString()}};if(A=="left"||A=="top"){if(this.styleObj.getAttValue(H[C],D[A].p)=="1"){var J=H[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if((J==microstrategy.SUBOBJTYPE_DOC_LINE&&this.styleObj.getAttValue(H[C],microstrategy.HTMLATTR_ORIENTATION)==D[A].o)||J==microstrategy.SUBOBJTYPE_DOC_SHAPE){I=this.styleObj.getAttValue(H[C],D[A].v);}}}if(!B){G=I;B=true;}if(I!=G){return null;}}return G;}catch(E){microstrategy.errors.log(E);return null;}};mstrDocSelectionsImpl.prototype.hasNoBorder=function(C){try{var A=this.styleObj.getAttValue(C,microstrategy.HTMLATTR_BORDER);return(A!=null&&A==microstrategy.NO_BORDER);}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.checkborders=function(G){try{var A=mstrDocSelectionsImpl.NOBORDERS;if(this.hasNoBorder(G)){return A;}var F=["Top","Bottom","Left","Right"];for(var B=0;B<4;B++){var H="border"+F[B];var D=parseInt(this.styleObj.getValue(G,H+"Width"),10);var C=this.styleObj.getValue(G,H+"Style");if(D>0&&(C&&C!="none")){A+=mstrDocSelectionsImpl[F[B].toUpperCase()+"BORDER"];}}if(A==mstrDocSelectionsImpl.ALLBORDERS-1){A+=mstrDocSelectionsImpl.ALLBORDERS;}return A;}catch(E){microstrategy.errors.log(E);return mstrDocSelectionsImpl.NOBORDERS;}};mstrDocSelectionsImpl.prototype.checkBorderStyle=function(){try{if(!this.isActive()){return 0;}var B=this.parentBone.checkBorderProperties(this.firstItem(),this.styleObj,"border","Width","Color");var A=this.parentBone.checkBorderProperties(this.firstItem(),this.styleObj,"border","Style","Color");for(var D in this.items){if(this.parentBone.checkBorderProperties(this.items[D],this.styleObj,"border","Width","Color")!=B){return 2;}if(this.parentBone.checkBorderProperties(this.items[D],this.styleObj,"border","Style","Color")!=A){return 2;}}return(A==2||B==2)?2:B;}catch(C){microstrategy.errors.log(C);return 0;}};mstrDocSelectionsImpl.prototype.alignObjs=function(alignId){try{if(alignId!="AlignToGrid"&&!this.isMulti()){return false;}var offset,start,end,i,id,secId,t,l;var isVertical=(alignId.indexOf("Top")!=-1||alignId.indexOf("Middle")!=-1||alignId.indexOf("Bottom")!=-1||alignId.indexOf("Vert")!=-1);if(isVertical){offset=getObjSumTop(this.firstItem().parentNode)-this.parentBone.top;var top=this.range.top-offset;var bottom=this.range.bottom-offset;var middle=top+(bottom-top)/2;}else{offset=getObjSumLeft(this.firstItem().parentNode)-this.parentBone.left;var left=this.range.left-this.leftBorderOffset-offset;var right=this.range.right-this.leftBorderOffset-offset;var center=left+(right-left)/2;}var format=mstrFormatObject;var updateManager=this.parentBone.parentBone.updateManager;var actionCollection=[];var cachedArray={};cachedArray.acrossSections=false;if(alignId.indexOf("Dist")>-1){var elements=mstr.utils.Arrays.fromHashValues(this.items);var p=(isVertical)?"top":"left";start=(isVertical)?top:left;end=(isVertical)?bottom:right;elements.sort(function(a,b){return parseInt(microstrategy.styleObj.getValue(a,p))-parseInt(microstrategy.styleObj.getValue(b,p));});var total=end-start;var sizes=new Array(this.length);var fn=(isVertical)?getObjHeight:getObjWidth;for(i=0;i<this.length;i++){sizes[i]=fn(elements[i]);total-=sizes[i];}var overlap=(total<1);if(overlap){total=(end-sizes[this.length-1]/2)-(start+sizes[0]/2);}var unit=total/(this.length-1);var pos=start;var prop=(isVertical)?"top":"left";for(i=0;i<this.length;i++){id=elements[i].getAttribute("id");secId=elements[i].parentNode.getAttribute("id");t=format.encodeValue("top",this.styleObj.getValue(elements[i],"top"));l=format.encodeValue("left",this.styleObj.getValue(elements[i],"left"));if(isVertical){actionCollection.push(updateManager.createActionObject(elements[i],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,format.encodeValue("top",pos),l],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));}else{actionCollection.push(updateManager.createActionObject(elements[i],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,t,format.encodeValue("left",pos)],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));}elements[i].style[prop]=pos+"px";if(overlap){pos=(i==this.length-2)?end-sizes[i+1]:start+sizes[0]/2+(i+1)*unit-sizes[i+1]/2;if(pos<start){pos=start;}else{if(pos+sizes[i+1]>end){pos=end-sizes[i+1];}}}else{pos+=sizes[i]+unit;}}}else{var deltaY;var deltaX;if(alignId=="AlignToGrid"){deltaY=microstrategy.snapCoordinate(this.range.top-(getObjSumTop(this.range.offsetSection.elem)-this.parentBone.top),0,true)+getObjSumTop(this.range.offsetSection.elem)-(this.range.top+this.parentBone.top);deltaX=microstrategy.snapCoordinate(this.range.left+this.leftBorderOffset,0,true)-this.range.left+this.leftBorderOffset;}for(var item in this.items){id=this.items[item].getAttribute("id");secId=this.items[item].parentNode.getAttribute("id");t=format.encodeValue("top",parseInt(this.styleObj.getValue(this.items[item],"top")));l=format.encodeValue("left",parseInt(this.styleObj.getValue(this.items[item],"left")));var objsRaw=document.getElementsByName(id);var objs=[];for(i=0;i<objsRaw.length;i++){if(this.isLocked(objsRaw[i])){continue;}objs.push(objsRaw[i]);}switch(alignId){case"AlignLeft":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,t,format.encodeValue("left",left)],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.left=left+"px";}break;case"AlignCenter":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,t,format.encodeValue("left",(center-getObjWidth(this.items[item])/2))],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.left=(center-getObjWidth(objs[i])/2)+"px";}break;case"AlignRight":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,t,format.encodeValue("left",(right-getObjWidth(this.items[item])))],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.left=(right-getObjWidth(objs[i]))+"px";}break;case"AlignTop":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,format.encodeValue("top",top),l],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.top=top+"px";}break;case"AlignMiddle":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,format.encodeValue("top",(middle-getObjHeight(this.items[item])/2)),l],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.top=(middle-getObjHeight(objs[i])/2)+"px";}break;case"AlignBottom":actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,format.encodeValue("top",(bottom-getObjHeight(this.items[item]))),l],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.top=(bottom-getObjHeight(objs[i]))+"px";}break;case"AlignToGrid":var itemLeft=parseInt(this.styleObj.getValue(this.items[item],"left"));var itemTop=parseInt(this.styleObj.getValue(this.items[item],"top"));actionCollection.push(updateManager.createActionObject(this.items[item],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,secId,format.encodeValue("top",itemTop+deltaY),format.encodeValue("left",itemLeft+deltaX)],[mstrUpdateManager.UPDATE_LATER,id,secId,t,l],cachedArray));for(i=0;i<objs.length;i++){objs[i].style.top=itemTop+deltaY+"px";objs[i].style.left=itemLeft+deltaX+"px";}with(this.range){top+=deltaY;bottom+=deltaY;left+=deltaX;right+=deltaX;}break;}}actionCollection=this.resizeSubSection(false,actionCollection);actionCollection=this.resetRange(false,actionCollection);}if(actionCollection.length>0){updateManager.add(actionCollection);}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocSelectionsImpl.prototype.resizeObjs=function(E){try{if(E=="Grid"){return this.sizeToGrid();}var I=[];var C=(E=="Tallest"||E=="Shortest");var K=(E=="Shortest"||E=="Narrowest");var A=(C)?"Height":"Width";var G=(C)?microstrategy.HTMLATTR_HEIGHT_MODE:microstrategy.HTMLATTR_WIDTH_MODE;var L=-1;var J=[];for(var H in this.items){if(!this.isLocked(this.items[H])){J.push(this.items[H]);}var F=this.items[H];if(parseInt(this.styleObj.getAttValue(F,G))!=microstrategy.FIX_MODE){this.parentBone.formatSizeMode([F],A.toLowerCase()+"Mode",microstrategy.FIX_MODE,I,true);}if(microstrategy.subObjectType(F)==microstrategy.SUBOBJTYPE_DOC_LINE){if(this.styleObj.getAttValue(F,microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_HORIZONTAL){if(C){continue;}}else{if(!C){continue;}}}var D=this.styleObj["getInner"+A](F);D+=Math.round(microstrategy.getPaddingAndBorderPixels(this.items[H],A));if(L==-1){L=D;}L=Math[(K)?"min":"max"](D,L);}this.parentBone.formatSize(J,A.toLowerCase(),L+"px",I);this.resizeSubSection(false,I);this.resetRange(false,I);if(I&&I.length>0){this.parentBone.parentBone.updateManager.add(I);}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.resizeSubSection=function(F,J){try{for(var A in this.items){var C=this.items[A].parentNode;var K=microstrategy.findBone(C);if(K&&K.elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){var G=parseInt(this.styleObj.getValue(this.items[A],"top"))+getObjHeight(this.items[A]);var B=this.styleObj.getValue(this.items[A],"dropShadowEffect");if(B=="1"){var E=parseInt(this.styleObj.getValue(this.items[A],"dropShadowDepth"));var H=parseInt(microstrategy.number.toLocalUnits(mstrNumber.UNIT_PX,microstrategy.number.convertToUSUnits(mstrNumber.UNIT_PT,E,true),true));G=G-H;}if(G>getObjHeight(C)){J=K.changeSubHeight(G,F,J);if(K.isHorizontal){this.parentBone.synchHeightOfHorizontalSections(K);}}if(K.isHorizontal){var I=parseInt(this.styleObj.getValue(this.items[A],"left"))+getObjWidth(this.items[A]);if(I>getObjWidth(C)){J=K.changeSubWidth(I,F,J);}}}}this.syncUp();this.parentBone.updateLayoutWidth(J);}catch(D){microstrategy.errors.log(D);}finally{return J;}};mstrDocSelectionsImpl.prototype.resizeUnitsInFP=function(){for(var F in this.items){var C=this.items[F];var D=C.parentNode;var A=microstrategy.findBone(D);if(A.isFilterPanel){var B=[];this.parentBone.formatItems(microstrategy.createAssociativeArray(C),"width",this.parentBone.removePaddingAndBorder(C,getObjWidth(D)-2*mstrFilterPanelMaskImpl.ITEM_SPA,"width")+"px",false,B);var E=microstrategy.formatType;microstrategy.formatType=microstrategy.FORMAT_TYPE_CONTROL_TITLE;this.parentBone.formatAttribute([C],"showTitleBar",microstrategy.TRUE,false,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,B,true);microstrategy.formatType=E;if(B.length>0){this.parentBone.parentBone.updateManager.add(B);}}}};mstrDocSelectionsImpl.prototype.enforceTitleBar=function(D,B){try{D=D.elem?D:microstrategy.findBone(D);if(D.isFilterPanel){if(this.parentBone.styleObj.getAttValue(B,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)!=microstrategy.TRUE){var A={obj:null,cmdId:"IsPortal",value:true,memo:{},performFormatChange:true,submitUpdateManager:false};this.processPropertyChanges([A]);}}}catch(C){microstrategy.errors.log(C);}};mstrDocSelectionsImpl.prototype.resetRange=function(C,A){try{this.range=new Rect(null,null,null,null);this.range.offsetSection=null;this.range.offsetLeftSection=null;for(member in this.items){this.updateRange(this.items[member]);}return A;}catch(B){microstrategy.errors.log(B);}finally{return A;}};mstrDocSelectionsImpl.prototype.getUpdatedZIndex=function(A){var F={};var G=this.styleObj;if(G){for(var C in this.items){var E=this.items[C];var D=0;for(var B in this.items){if(G.getValue(E,"zIndex")>G.getValue(this.items[B],"zIndex")){D++;}}F[E.getAttribute("id")]=A+D;}}return F;};mstrDocSelectionsImpl.prototype.moveItems=function(mask){try{this.resetObjectFormatLevel();if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrDocSelectionsImpl.moveItems",mstrLogImpl.MOVE_ITEMS);}var newSection,oldSection,maskBone,baseTop=0,baseLeft=0,forceUpdate=false,updateManager=this.parentBone.parentBone.updateManager,format=mstrFormatObject,ac=[],deltaX=getObjLeft(this.dragRectangles),deltaY=getObjTop(this.dragRectangles),coords=mask.getAttribute(microstrategy.HTMLATTR_POINTS_TO).split("|"),maskBone=this.parentBone.getSubMaskBone(coords[0],coords[1],0);if(maskBone.elem.getAttribute("isCollapsed")=="true"){return false;}var subsectionID=mask.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT);if((deltaY!=0||deltaX!=0)&&(!this.isMulti()||this.isSameSubSection())){oldSection=this.firstItem().parentNode;if(oldSection.getAttribute("id")!=subsectionID){newSection=document.getElementById(subsectionID);}}var firstMaskTopOffset=(maskBone!=null&&parseInt(this.styleObj.getAttValue(maskBone.elem,microstrategy.HTMLATTR_HEIGHT))<parseInt(maskBone.elem.style.height))?this.parentBone.mouseoffsetTop:0,baseTop=lMouseY-getObjSumTop(mask)+this.parentBone.parentBone.elem.scrollTop-firstMaskTopOffset,baseLeft=lMouseX-getObjSumLeft(mask)+this.parentBone.parentBone.elem.scrollLeft,isPanel=String(mask.getAttribute("isPanel")).toLowerCase()=="true";if(!isPanel){baseTop-=maskBone.topOffset;baseLeft-=this.parentBone.mouseoffsetLeft;}else{if(microstrategy.getViewerBone().dividerOn){baseTop-=maskBone.topOffset;}}if(baseTop<0){baseTop=0;}if(baseLeft<0){baseLeft=0;}if(newSection){var newSecBone=microstrategy.findBone(newSection);if(newSecBone.isDetails&&this.isGridSelected()){showMessage({contents:microstrategy.descriptors.getDescriptor("3622"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(newSecBone.isDetails&&this.isPanelStackSelected()){showMessage({contents:microstrategy.descriptors.getDescriptor("4814"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(newSecBone.isDetails&&this.isSelectorControlSelected()){showMessage({contents:microstrategy.descriptors.getDescriptor("4993"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(newSecBone.isFilterPanel&&!this.isSelectorControlSelected()){showMessage({contents:"*This move operation is being cancelled because you cannot move a node other than selector to the Filter Panel.*",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}else{if(newSecBone.parentBone.isCollapsed){return ;}}if(isPanel&&this.atLeastOneTableSelected()){showMessage({contents:microstrategy.descriptors.getDescriptor("11959"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}var newItems=[];var oldSecBone=microstrategy.findBone(oldSection);oldSecBone.setNeedToUpdateMaxContentHeight(true);var orgRangeLeft=this.range.left;var orgRangeTop=this.range.top;var bWire={control:false,target:false};var bAW=microstrategy.getViewerBone().autoWire;var exceptionObjs={oldSection:{},newSection:{}};var zi=this.getUpdatedZIndex(newSecBone.maxZindex);newSecBone.maxZindex+=this.length;for(var id in this.items){if(this.isLocked(this.items[id])){continue;}var isTarget=false;var isControl=false;var type=this.items[id].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(type==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){isControl=bWire.control=true;}else{if(type==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||type==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){isTarget=bWire.target=true;}}if(oldSecBone.isFilterPanel){var sec=microstrategy.findAncestorWithAtt(oldSection,microstrategy.HTMLATTR_OBJTYPE,"dsec");var maskBone=this.parentBone.getSubMaskBone(sec.id,oldSection.id,0);this.adjustItemsInFP(oldSection,maskBone,ac,null,id,true);}else{ac=oldSecBone.reduceObjZIndex(this.items[id],ac);}ac=this.parentBone.formatItems(microstrategy.createAssociativeArray(this.items[id]),"zIndex",zi[id],false,ac);var l=microstrategy.snapCoordinate(baseLeft+(getObjSumLeft(this.items[id])-this.parentBone.left-orgRangeLeft),0,!microstrategy.SNAP_OFF);var t=microstrategy.snapCoordinate(baseTop+(getObjSumTop(this.items[id])-this.parentBone.top-orgRangeTop),0,!microstrategy.SNAP_OFF);var ca={acrossSections:true,orginalSection:oldSection,newSection:newSection};ac.push(updateManager.createActionObject(this.items[id],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011","2048241"],[mstrUpdateManager.UPDATE_LATER,id,subsectionID,format.encodeValue("top",t),format.encodeValue("left",l),"true"],[mstrUpdateManager.UPDATE_LATER,id,subsectionID,format.encodeValue("top",this.styleObj.getValue(this.items[id],"top")),format.encodeValue("left",this.styleObj.getValue(this.items[id],"left"))],ca));if(!forceUpdate){forceUpdate=(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&(bAW?(bWire.control||bWire.target):type==microstrategy.SUBOBJTYPE_DOC_TEMPLATE));}if(!forceUpdate){var item=this.items[id];this.remove(item);var objs=document.getElementsByName(id);for(var i=objs.length-1;i>=0;i--){objs[i].parentNode.removeChild(objs[i]);}if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&type==microstrategy.SUBOBJTYPE_DOC_TEXT){if(this.styleObj.getAttValue(item,microstrategy.HTMLATTR_DSS_FORMULA)!=null){this.parentBone.updateSingleTextField(item,this.styleObj.getAttValue(item,microstrategy.HTMLATTR_DSS_FORMULA).replace(/\n/g,"<br />"));}}moveObjTo(item,l,t);newItems[newItems.length]=this.parentBone.addItemsToSubsection(newSection,item,false,null,oldSecBone);this.add(document.getElementById(item.getAttribute("id")));}else{if(forceUpdate&&bAW){if(isTarget){if(!exceptionObjs.newSection.includeTargets){exceptionObjs.newSection.includeTargets=[];}exceptionObjs.newSection.includeTargets.push(id);if(!exceptionObjs.oldSection.excludeTargets){exceptionObjs.oldSection.excludeTargets=[];}exceptionObjs.oldSection.excludeTargets.push(id);}else{if(isControl){if(!exceptionObjs.newSection.includeControls){exceptionObjs.newSection.includeControls=[];}exceptionObjs.newSection.includeControls.push(id);if(!exceptionObjs.oldSection.excludeControls){exceptionObjs.oldSection.excludeControls=[];}exceptionObjs.oldSection.excludeControls.push(id);}}}}}if((bWire.control||bWire.target)&&bAW){newSecBone.wireTargets(ac,this.parentBone.parentBone.beanPath,bWire.target,exceptionObjs.newSection);oldSecBone.wireTargets(ac,this.parentBone.parentBone.beanPath,bWire.target,exceptionObjs.oldSection);}if(!forceUpdate){ac=this.resizeSubSection(false,ac);ac=this.resetRange(false,ac);}microstrategy.eventManager.notifyOrphanBones("onboneaftermove",this.getSelectedIds(),this.getActiveSectionIndex(this.firstItem()));}else{for(var id in this.items){if(this.isLocked(this.items[id])){continue;}var t=parseInt(this.styleObj.getValue(this.items[id],"top"));if(t+deltaY<0){deltaY=0-t;}}for(var id in this.items){if(this.isLocked(this.items[id])){continue;}var subsectionID=this.items[id].parentNode.getAttribute("id");var l=parseInt(this.styleObj.getValue(this.items[id],"left"));var t=parseInt(this.styleObj.getValue(this.items[id],"top"));var textDirection=this.items[id].direction||this.styleObj.getValue(this.items[id],"TextDirection")||"0";var ca={acrossSections:false};ac.push(updateManager.createActionObject(this.items[id],mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,id,subsectionID,format.encodeValue("top",t+deltaY),format.encodeValue("left",l+deltaX)],[mstrUpdateManager.UPDATE_LATER,id,subsectionID,format.encodeValue("top",t),format.encodeValue("left",l)],ca));var objHilites=document.getElementsByName(id);for(var i=0;i<objHilites.length;i++){if(textDirection==="0"){moveObjTo(objHilites[i],Math.max(l+deltaX,0),t+deltaY);}else{this.styleObj.changeVerticalTextPosition(objHilites[i],{x:t+deltaY,y:Math.max(l+deltaX,0)});}}}with(this.range){top+=deltaY;bottom+=deltaY;left+=deltaX;right+=deltaX;}ac=this.resizeSubSection(false,ac);microstrategy.eventManager.notifyOrphanBones("onboneaftermove",this.getSelectedIds());}if(ac.length>0){updateManager.add(ac);if(forceUpdate){updateManager.flushAndSubmitChanges();}}this.onmoveend();return true;}catch(err){microstrategy.errors.log(err);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrDocSelectionsImpl.moveItems",mstrLogImpl.MOVE_ITEMS);}}};mstrDocSelectionsImpl.prototype.moveItemsToFP=function(X){try{this.resetObjectFormatLevel();if(this.isMulti()){return false;}if(X.tagName!="AREA"){return false;}var h=X.parentNode,a,C,W,L=0,N=0,R=false,I=this.parentBone.parentBone.updateManager,V=mstrFormatObject,e=[],g=getObjLeft(this.dragRectangles),f=getObjTop(this.dragRectangles),S=h.getAttribute(microstrategy.HTMLATTR_POINTS_TO).split("|"),W=this.parentBone.getSubMaskBone(S[0],S[1],0),Z=h.getAttribute(microstrategy.HTMLATTR_MASKEDOBJECT),B=X.getAttribute("ctrlId");var A=null;var T=null;if(B){A=document.getElementById(B);T=microstrategy.bone(B+"_Ctl");}if((f!=0||g!=0)&&(!this.isMulti()||this.isSameSubSection())){C=this.firstItem().parentNode;if(C.getAttribute("id")!=Z){a=document.getElementById(Z);}}if(a){var P=microstrategy.findBone(a);if(P.isFilterPanel){var k=this.getSelectedSelectorControl(),M=k&&microstrategy.findBone(k);if(k==null){showMessage({contents:"*This move operation is being cancelled because you cannot move a node other than selector to the Filter Panel.*",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}else{if(M&&M.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){showMessage({contents:"*This move operation is being cancelled because you cannot move a panel selector to the Filter Panel.*",elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return ;}}}if(P.parentBone.isCollapsed){return ;}var K=[];var d=microstrategy.findBone(C);d.setNeedToUpdateMaxContentHeight(true);var Y=this.firstItem();if(d.isFilterPanel){var c=microstrategy.findAncestorWithAtt(C,microstrategy.HTMLATTR_OBJTYPE,"dsec");var W=this.parentBone.getSubMaskBone(c.id,C.id,0);this.adjustItemsInFP(C,W,e,null,Y.id,true);}else{e=d.reduceObjZIndex(Y,e);}W.maxZIndex++;var H=X.getAttribute("soz")?X.getAttribute("soz"):W.maxZIndex;e=this.parentBone.formatItems(microstrategy.createAssociativeArray(Y),"zIndex",H,false,e);var G=X.getAttribute("coords").split(","),D=parseInt(G[0]),O=parseInt(G[1]);var Q={acrossSections:true,orginalSection:C,newSection:a};e.push(I.createActionObject(Y,mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,Y.id,Z,V.encodeValue("top",O),V.encodeValue("left",D)],[mstrUpdateManager.UPDATE_LATER,Y.id,Z,V.encodeValue("top",this.styleObj.getValue(Y,"top")),V.encodeValue("left",this.styleObj.getValue(Y,"left"))],Q));this.remove(Y);var J=document.getElementsByName(Y.id);for(var U=J.length-1;U>=0;U--){J[U].parentNode.removeChild(J[U]);}moveObjTo(Y,D,O);var F=this.parentBone.addItemsToSubsection(a,Y,false,null,d);e=this.parentBone.formatItems(microstrategy.createAssociativeArray(Y),"width",this.parentBone.removePaddingAndBorder(Y,getObjWidth(a)-2*mstrFilterPanelMaskImpl.ITEM_SPA,"width")+"px",false,e);this.add(document.getElementById(F.getAttribute("id")));this.enforceTitleBar(a,F);this.adjustItemsInFP(a,W,e,null,B);}else{this.adjustItemsInFP(C,W,e,this.firstItem().id,B);}if(e.length>0){I.add(e);if(R){I.flushAndSubmitChanges();}}this.onmoveend();return true;}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.adjustItemsInFP=function(K,H,Q,C,J,O){try{var L=this.parentBone.parentBone.updateManager,N=mstrFormatObject;if(H.adjustZIndex(C,J,O)){var M=H.getMoveItems();if(M.length<=0){return ;}var A=H.getStartArea(M[0].zIndex);var B=A?parseInt(A.getAttribute("coords").split(",")[1]):mstrFilterPanelMaskImpl.ITEM_SPA;for(var I=0;I<M.length;I++){var D=M[I];Q=this.parentBone.formatItems(microstrategy.createAssociativeArray(D.item),"zIndex",D.zIndex,false,Q);var E=A?parseInt(A.getAttribute("coords").split(",")[0]):mstrFilterPanelMaskImpl.ITEM_SPA,P=B;moveObjTo(D.item,E,P);var G={acrossSections:false};Q.push(L.createActionObject(D.item,mstrUpdateManager.MOVE_OBJECT,this.parentBone.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,D.item.id,K.id,N.encodeValue("top",P),N.encodeValue("left",E)],[mstrUpdateManager.UPDATE_LATER,D.item.id,K.id,N.encodeValue("top",this.styleObj.getValue(D.item,"top")),N.encodeValue("left",this.styleObj.getValue(D.item,"left"))],G));B+=getObjHeight(D.item)+mstrFilterPanelMaskImpl.ITEM_SPA;}}}catch(F){microstrategy.errors.log(F);}};mstrDocSelectionsImpl.prototype.updateRange=function(F){try{var B=getObjSumLeft(F)-this.parentBone.left;var C=getObjSumTop(F)-this.parentBone.top;var A=getObjWidth(F);var D=getObjHeight(F);if((this.range.left==null)||(B<this.range.left)){this.range.left=B;this.range.offsetLeftSection=microstrategy.findBone(F.parentNode);}if((this.range.top==null)||(C<this.range.top)){this.range.top=C;this.range.offsetSection=microstrategy.findBone(F.parentNode);}if((this.range.right==null)||(B+A>this.range.right)){this.range.right=B+A;}if((this.range.bottom==null)||(C+D>this.range.bottom)){this.range.bottom=C+D;}}catch(E){microstrategy.errors.log(E);return false;}};mstrDocSelectionsImpl.prototype.sendTo=function(N){try{if(!this.isActive()||this.firstObjType()!=microstrategy.OBJTYPE_DOC_OBJECT){return true;}var L=[];var A=mstr.utils.Arrays.fromHashValues(this.items);A.sort(function(P,O){return parseInt(P.style.zIndex)-parseInt(O.style.zIndex);});switch(N){case"back":for(j=A.length-1;j>=0;j--){var G=A[j].parentNode;var C=microstrategy.findBone(G);if(C){var K=this.styleObj.getValue(A[j],"zIndex");for(i=0;i<G.childNodes.length;i++){var D=G.childNodes[i];if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var J=this.styleObj.getValue(D,"zIndex");if(J<K){J++;L=this.parentBone.formatItems(microstrategy.createAssociativeArray(D),"zIndex",J,false,L);}}}K=C.minZindex;L=this.parentBone.formatItems(microstrategy.createAssociativeArray(A[j]),"zIndex",K,false,L);}}break;case"front":for(j=0;j<A.length;j++){var G=A[j].parentNode;var C=microstrategy.findBone(G);if(C){var K=this.styleObj.getValue(A[j],"zIndex");for(i=0;i<G.childNodes.length;i++){var D=G.childNodes[i];if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var J=this.styleObj.getValue(D,"zIndex");if(J>K){J--;L=this.parentBone.formatItems(microstrategy.createAssociativeArray(D),"zIndex",J,false,L);}}}K=C.maxZindex-1;L=this.parentBone.formatItems(microstrategy.createAssociativeArray(A[j]),"zIndex",K,false,L);}}break;case"oneBack":var E=false;for(j=0;j<A.length;j++){var G=A[j].parentNode;var C=microstrategy.findBone(G);if(C){var K=this.styleObj.getValue(A[j],"zIndex");if(K!=C.minZindex){var M=null;var I=null;for(i=0;i<G.childNodes.length;i++){var D=G.childNodes[i];if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var J=this.styleObj.getValue(D,"zIndex");var B=D.getAttribute("id");if(J<K&&this.items[B]==null){if(M==null){M=i;I=K-J;}else{if(K-J<I){M=i;I=K-J;}}}}}if(M!=null){var D=G.childNodes[M];var J=this.styleObj.getValue(D,"zIndex");L=this.parentBone.formatItems(microstrategy.createAssociativeArray(D),"zIndex",K,false,L);L=this.parentBone.formatItems(microstrategy.createAssociativeArray(A[j]),"zIndex",J,false,L);}}}}break;case"oneFront":for(j=A.length-1;j>=0;j--){var G=A[j].parentNode;var C=microstrategy.findBone(G);if(C){K=this.styleObj.getValue(A[j],"zIndex");if(K!=C.maxZindex-1){var M=null;var I=null;for(i=0;i<G.childNodes.length;i++){var D=G.childNodes[i];if(D.nodeType==1&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var J=this.styleObj.getValue(D,"zIndex");var B=D.getAttribute("id");if(J>K&&this.items[B]==null){if(M==null){M=i;I=J-K;}else{if(J-K<I){M=i;I=J-K;}}}}}if(M!=null){var D=G.childNodes[M];var J=this.styleObj.getValue(D,"zIndex");L=this.parentBone.formatItems(microstrategy.createAssociativeArray(D),"zIndex",K,false,L);L=this.parentBone.formatItems(microstrategy.createAssociativeArray(A[j]),"zIndex",K,false,L);L=this.parentBone.formatItems(microstrategy.createAssociativeArray(A[j]),"zIndex",J,false,L);}}}}break;}var H=this.parentBone.parentBone.updateManager;if(L.length>0){H.add(L);}}catch(F){microstrategy.errors.log(F);}};mstrDocSelectionsImpl.prototype.enablePropertiesEditor=function(){try{var C=false;for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){C=true;break;}}if((this.length>1&&C==true)||this.length==0){return false;}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.getSelectedGrid=function(){return this.getSelectedControl(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);};mstrDocSelectionsImpl.prototype.getSelectedControl=function(A){try{for(var D in this.items){var C=this.items[D];if(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==A){return C;break;}}return null;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.getSelectedPanelStack=function(){return this.getSelectedControl(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);};mstrDocSelectionsImpl.prototype.getSelectedSelectorControl=function(){return this.getSelectedControl(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);};mstrDocSelectionsImpl.prototype.getPortalGridWithProperty=function(D){try{for(var C in this.items){var B=this.items[C];if(B.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&B.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&microstrategy.styleObj.getAttValue(B,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE&&microstrategy.styleObj.getAttValue(B,microstrategy.HTMLATTR_WINDOW_STATE)==D){return B;break;}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneCtrlDftObjSelected=function(){try{return(!this.isMulti()&&this.parentBone.parentBone.objProps.isCtrlDftObj(this.firstItem()));}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneCtrlDftObjSelected=function(){try{for(var B in this.items){if(this.parentBone.parentBone.objProps.isCtrlDftObj(this.items[B])){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneRectangleSelected=function(){try{for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SHAPE&&this.items[B].getAttribute(microstrategy.HTMLATTR_STYLE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneRoundedRectangleSelected=function(){try{for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SHAPE&&this.items[B].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneSubtypeSelected=function(D){try{var C=D.toString();for(var B in this.items){if(microstrategy.isValueInFilter(this.items[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE),C)){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneControlSelected=function(){try{for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){return true;}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isGridSelected=function(){try{return(this.getSelectedGrid()!=null);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isPanelStackSelected=function(){try{return(this.getSelectedPanelStack()!=null);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isSelectorControlSelected=function(){try{return(this.getSelectedSelectorControl()!=null);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.areAllSameSubtypeSelected=function(A){try{for(var D in this.items){var C=this.items[D];if(!(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==A)){return false;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isGridOrGraphSelected=function(){try{var B=this.getSelectedGrid();if(B){var A=microstrategy.findBone(B);if(A!=null){if(A.isGraph&&A.isGrid){return microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;}if(A.isGraph){return microstrategy.DISPLAY_MODE_GRAPH;}if(A.isGrid){return microstrategy.DISPLAY_MODE_GRID;}}}return false;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneSelectorCtrlSelected=function(){try{return(!this.isMulti()&&this.isSelectorControlSelected());}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneGridSelected=function(){try{return(!this.isMulti()&&this.isGridSelected());}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneGraphSelected=function(){try{var B=this.isGridOrGraphSelected();return(!this.isMulti()&&(B==microstrategy.DISPLAY_MODE_GRID_AND_GRAPH||B==microstrategy.DISPLAY_MODE_GRAPH));}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneGGridSelected=function(){try{var A=this.isGridOrGraphSelected();return(!this.isMulti()&&(A==microstrategy.DISPLAY_MODE_GRID_AND_GRAPH||A==microstrategy.DISPLAY_MODE_GRID));}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyRoundedRectanglesSelected=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE||this.items[C].getAttribute(microstrategy.HTMLATTR_STYLE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlySquareRectanglesSelected=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE||this.items[C].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyRectanglesSelected=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyImagesSelected=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_IMAGE){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyLinesSelected=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_LINE){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOnePanelStackSelected=function(){try{return(this.isPanelStackSelected()&&!this.isMulti());}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.atLeastOneTableSelected=function(){try{for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var A=microstrategy.bones[this.items[C].id];if(A&&A.isTable){return true;}}}return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneTableSelected=function(){try{var A=false;if(this.isOnlyOnePanelStackSelected()){var C=this.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);A=C&&C.isTable;}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.areAllSelectedPanelStacks=function(){try{var A=true;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){A=false;break;}}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneButtonSelected=function(){try{return(this.length==1&&this.getSelectedButtons())?true:false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.getSelectedButtons=function(){try{var C=[];for(var D in this.items){var B=this.items[D];if(B.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT){if(microstrategy.styleObj.getAttValue(B,microstrategy.HTMLATTR_DISPLAY_STYLE)>0){C.push(B);}}}if(C.length){return C;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isOnlyOneNavBarSelected=function(){try{return(this.isOnlyOnePanelStackSelected()&&microstrategy.styleObj.getAttValue(this.firstItem(),microstrategy.HTMLATTR_USE_AS_NAVIGATION_BAR)==microstrategy.TRUE);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.isItemInsideNavBar=function(){try{var B=microstrategy.findAncestorWithAtt(this.firstItem(),microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(B&&B!=this.firstItem()&&B.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var A=microstrategy.findBone(B);return A&&A.isNavigationBar;}return false;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.isEmptyTemplateSelected=function(){try{for(var E in this.items){var B=this.items[E];if(B.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&B.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var D=document.getElementsByName(E);var C=microstrategy.bone("grid_"+E+"_"+0);if(!C){C=microstrategy.bone("grid_"+E);}if(C&&C.isTemplateEmpty()){return true;}}}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.nubmerOfLinesSelected=function(A){try{var D=0;for(var C in this.items){if(this.items[C].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_LINE&&this.styleObj.getAttValue(this.items[C],microstrategy.HTMLATTR_ORIENTATION)==A){D++;}}return D;}catch(B){microstrategy.errors.log(B);return null;}};mstrDocSelectionsImpl.prototype.isItemOfTypeSelected=function(B){try{var A=false;for(var D in this.items){if(microstrategy.styleObj.getAttValue(this.items[D],microstrategy.HTMLATTR_SUBOBJTYPE)==B){A=true;break;}}return A;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.isImageReady=function(){try{var A=false;for(var E in this.items){var D=this.items[E];if(D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_IMAGE){var B=D.getElementsByTagName("IMG")[0];A|=B.readyState=="complete"||B.complete==true;}}return A;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.getSelectedGridProperty=function(D){try{var A=this.getSelectedGrid();var C=microstrategy.findBone(A);return(C)?C[D]:false;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocSelectionsImpl.prototype.getSelectedGridFeature=function(B){try{var A=this.getSelectedGrid();var D=microstrategy.findBone(A);return(D)?D.isFeatureAvailable(B):false;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocSelectionsImpl.prototype.hiliteSelected=function(G){try{var H=G.getAttribute("id");this.items[H]=G;var B=this.hilites[H].base;var A=this.hilites[H].items[B];if(!A){var F=document.getElementsByName(H);for(var D=0;D<F.length;D++){var C=microstrategy.findBone(F[D]);if(C&&C.isGridInCellSelectionMode()){C.selections.clearAll();}}this.addHilites(G);}else{if(A.src!=G){setFilter(A.src,"Alpha",{opacity:this.selectionOpacity});setFilter(G,"Alpha",{opacity:100});A.src=G;this.syncUp(G);this.resetRange();}}this.setPanelStackSelectionHandleEvents(G);this.setGridSelectionHandleEvents(G);}catch(E){microstrategy.errors.log(E);}};mstrDocSelectionsImpl.prototype.hiliteElements=function(D){try{if(!bIsW3C||bIsIE8){return ;}var C=document.getElementsByName(D.getAttribute("id"));for(var A=0;A<C.length;A++){setFilter(C[A],"Alpha",{opacity:this.selectionOpacity});}setFilter(D,"Alpha",{opacity:100});}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.setGridSelectionHandleEvents=function(C){try{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&microstrategy.styleObj.getAttValue(C,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)!=microstrategy.TRUE){var A=microstrategy.findBone(C);if(A!=null){if(A.onmouseover&&A.onmouseout){this.elem.onmouseover=new Function("e","return microstrategy.bone('"+A.id+"').onmouseover(e);");this.elem.onmouseout=new Function("e","return microstrategy.bone('"+A.id+"').onmouseout(e);");}}}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.removeGridSelectionHandleEvents=function(C){try{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_TEMPLATE){return ;}var A=microstrategy.findBone(C);if(A!=null){if(A.onmouseover&&A.onmouseout){this.elem.onmouseover=null;this.elem.onmouseout=null;}}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.restoreElements=function(D){try{var C=document.getElementsByName(D);for(var A=0;A<C.length;A++){setFilter(C[A],"Alpha",{opacity:100});}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.processAddToSelections=function(E){try{if(this.firstItem()){var D=microstrategy.findBone(this.firstItem().parentNode);var C=microstrategy.findBone(E.parentNode);if(D.subsectionType==C.subsectionType){switch(C.subsectionType){case mstrSubSection.TYPE_FIXED:return E;case mstrSubSection.TYPE_PANEL:if(C.id==D.id){return E;}else{var A=this.getPeerSubsection(C,D.id);if(A){return A.elem;}else{return null;}}break;}}else{switch(C.subsectionType){case mstrSubSection.TYPE_FIXED:return null;case mstrSubSection.TYPE_PANEL:var A=this.getPeerSubsection(C,D.id);if(A){return A.elem;}else{return null;}}}}else{return E;}}catch(B){microstrategy.errors.log(B);return null;}};mstrDocSelectionsImpl.prototype.selectAll=function(E){try{this.clear(true);var F=microstrategy.objectListFind(this.parentBone.elem,"span",microstrategy.OBJTYPE_DOC_OBJECT);var A="";for(var C=0;C<F.length;C++){var G=F[C].getAttribute("id")+"|";if(A.indexOf(G)==-1){A+=G;var B=this.processAddToSelections(F[C]);if(B){this.add(B);}}}return false;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocSelectionsImpl.prototype.getOffsetSubsection=function(){try{return this.range.offsetSection;}catch(A){microstrategy.errors.log(A);return null;}};mstrDocSelectionsImpl.prototype.getSelectedSubsection=function(){try{if(!this.isActive()){return null;}var A=this.firstItem();if(A.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return microstrategy.findBone(A);}if(this.isSameSubSection()){return this.getOffsetSubsection();}return null;}catch(B){microstrategy.errors.log(B);return null;}};mstrDocSelectionsImpl.prototype.finishAdd=function(C,B){try{return this.finishAddAllObjs(microstrategy.createAssociativeArray(C),B);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSelectionsImpl.prototype.finishAddAllObjs=function(F,C,H){try{this.clear();var A=(typeof (H)!="undefined"&&H==false)?false:true;var E=null;for(var G in F){E=F[G];this.add(E);}C=this.resizeSubSection(false,C);C=this.resetRange(false,C);this.parentBone.commands.exec("ctrlJustAdded");if(this.parentBone.parentBone.observer){this.parentBone.parentBone.observer.notifyAll("onaddcontrol");}if(E&&A){if(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT){this.parentBone.editText(null,E);}else{if(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){var D=microstrategy.findRWObjectBone(E,"mstrHTMLContainerImpl");D.editContents(null);}}}}catch(B){microstrategy.errors.log(B);}return C;};mstrDocSelectionsImpl.prototype.setPanelStackSelectionHandleEvents=function(C){try{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var A=microstrategy.findBone(C);if(A!=null){if(A.onmouseover&&A.onmouseout){this.elem.onmouseover=new Function("e","return microstrategy.bone('"+A.id+"').onmouseover(e);");this.elem.onmouseout=new Function("e","return microstrategy.bone('"+A.id+"').onmouseout(e);");}}}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.removePanelStackSelectionHandleEvents=function(C){try{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){return ;}var A=microstrategy.findBone(C);if(A!=null){if(A.onmouseover&&A.onmouseout){this.elem.onmouseover=null;this.elem.onmouseout=null;}}}catch(B){microstrategy.errors.log(B);}};mstrDocSelectionsImpl.prototype.getTransactionUnitKey=function(){try{if(this.isActive()&&!this.isMulti()){var D=this.firstItem();if(this.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEMPLATE)){var C=microstrategy.findBone(D),A=C&&C.commands;if(A&&!A.queryState("isLinkedTemplate")&&(A.queryEnabled("attForms")||A.queryEnabled("hasmetrics"))){return{k:D.id};}}else{if(this.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)){if(microstrategy.findAncestorWithAtt(D,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_PANEL_STACK)!=null){return{k:(D.parentNode.getAttribute("fgkey")||""),sk:D.parentNode.id};}}}}return null;}catch(B){microstrategy.errors.log(B);}};function mstrDocSelectionsImpl(){return this;}mstrDocHilite.prototype={};mstrDocHilite.prototype.parentBone=null;mstrDocHilite.prototype.base=0;mstrDocHilite.prototype.items=null;mstrDocHilite.prototype.vflipped=false;mstrDocHilite.prototype.hflipped=false;mstrDocHilite.OFFSET=2;mstrDocHilite.HANDLE_SIZE=7;mstrDocHilite.prototype.getDefault=function(){return(this.items.length>0)?this.items[this.base]:null;};mstrDocHilite.prototype.setDefault=function(C){try{for(var A=0;A<this.items.length;A++){if(this.items[A]==C){this.base=A;break;}}}catch(B){microstrategy.errors.log(B);}return ;};mstrDocHilite.prototype.syncHilites=function(C){try{var J=microstrategy.formatType;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;var O=mstrFormatObject;for(var H=0;H<this.items.length;H++){var G=this.items[H].src;var E=getObjSumLeft(G)-C.parentBone.left;if(bIsIE7&&!bIsIE8&&!bIsIE10){if(G.offsetWidth>0){var N=G.getBoundingClientRect();var I=Math.round((N.right-N.left)/G.offsetWidth*100);E=E/I*100;}}var M;if(!bIsDXIE){var L=microstrategy.getViewerBone().elem;M=G.getBoundingClientRect().top-2+getDocumentScrollTop()+(L&&L.scrollTop)||0;}else{M=getObjSumTop(G);}M=M-C.parentBone.top;var Q=0;var B=0;if(G.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_LINE){var P=microstrategy.styleObj.getValue(G,"borderTopWidth");var D=microstrategy.styleObj.getValue(G,"borderLeftWidth");if(P&&parseFloat(P)>0){Q=parseInt(O.getPxFromPt(parseFloat(P)));B=parseInt(this.styleObj.getValue(G,"width"));}if(D&&parseFloat(D)>0){Q=parseInt(this.styleObj.getValue(G,"height"));B=parseInt(O.getPxFromPt(parseFloat(D)));}}else{var A,K;A=this.styleObj.getInnerHeight(G);K=this.styleObj.getInnerWidth(G);Q=Math.floor(A+microstrategy.getPaddingAndBorderPixels(G,"height"));B=Math.floor(K+microstrategy.getPaddingAndBorderPixels(G,"width"));}this.items[H].style.left=E+"px";this.items[H].style.top=M+"px";if(Q>0){this.items[H].style.height=Q+"px";}if(B>0){this.items[H].style.width=B+"px";}}this.syncHandles();microstrategy.formatType=J;}catch(F){microstrategy.errors.log(F);}return ;};mstrDocHilite.prototype.syncHandles=function(F){try{var C=this.getDefault();if(C==null){return ;}var H=parseInt(C.style.height);var I=parseInt(C.style.width);if(isNaN(H)||isNaN(I)){return ;}var B=(C.style.borderTopWidth.length>0&&C.style.borderTopWidth!="none"&&C.style.borderTopWidth!="0pt")?1:0;var G=-Math.floor(mstrDocHilite.HANDLE_SIZE/2);C.setAttribute("oHeight",C.style.height);C.setAttribute("oWidth",C.style.width);if(C.src.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_LINE){var D=mstrDocHilite.OFFSET-mstrDocHilite.HANDLE_SIZE;var J=C.childNodes[0].className;var A=(this.styleObj.getAttValue(C.src,microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_VERTICAL);if(A){if(J=="w"||J=="e"){C.childNodes[0].className="n";C.childNodes[1].className="s";}B=(C.style.borderLeftWidth.length>0&&C.style.borderLeftWidth!="none"&&C.style.borderLeftWidth!="0pt")?1:0;moveObjTo(C.childNodes[0],G-B,D);moveObjTo(C.childNodes[1],G-B,H+G);}else{if(J=="n"||J=="s"){C.childNodes[0].className="w";C.childNodes[1].className="e";}moveObjTo(C.childNodes[0],D,G-B);moveObjTo(C.childNodes[1],I+G,G-B);}}else{C.childNodes[0].style.top=C.childNodes[1].style.top=C.childNodes[2].style.top=-5-B+"px";C.childNodes[0].style.left=C.childNodes[3].style.left=C.childNodes[5].style.left=-5-B+"px";C.childNodes[3].style.top=C.childNodes[4].style.top=(Math.floor(H/2)+G)+"px";C.childNodes[5].style.top=C.childNodes[6].style.top=C.childNodes[7].style.top=(H-2+B)+"px";C.childNodes[1].style.left=C.childNodes[6].style.left=(Math.floor(I/2)+G)+"px";C.childNodes[2].style.left=C.childNodes[4].style.left=C.childNodes[7].style.left=(I-2+B)+"px";}}catch(E){microstrategy.errors.log(E);}return ;};function mstrDocHilite(A){this.items=[];this.parentBone=A;this.styleObj=A.styleObj;return this;}mstrResizeDocObjs.prototype={};mstrResizeDocObjs.prototype.onload=function(C,B){try{this.parentBone=C;this.path=B;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.doc=this.parentBone.parentBone;this.oc=this.parentBone.objCache;this.um=this.doc.parentBone.updateManager;}catch(A){microstrategy.errors.log(A);}return false;};mstrResizeDocObjs.prototype.onresizestart=function(C,A){try{if(!C){C=window.event;}if(C.e){C=C.e;}this.items=this.parentBone.items;this.doc.syncPosition();this.oc.resizeStyle=A;this.parentBone.hilites[this.oc.activeHilite.getAttribute("id").substr(6)].setDefault(this.oc.activeHilite);this.parentBone.toggleHiliteBorders(true);if(typeof (mstr)!="undefined"){this.parentBone.parentBone.attachWinListener(this,"mousemove","onresize");this.parentBone.parentBone.attachWinListener(this,"mouseup","onresizeend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".onresize(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onresizeend(e); }");}for(var D in this.items){if(this.items[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){microstrategy.bone(this.items[D].firstChild.id).toggleCurtain(true);}}this.onresize(C);}catch(B){microstrategy.errors.log(B);}return false;};mstrResizeDocObjs.prototype.checkMovedDistance=function(E){var D=parseInt(microstrategy.SNAP_SIZE/2),C=this.parentBone,B=this.getMovedDistance(E),A=Math.abs(B.x)%D,G=Math.abs(B.y)%D,F=parseInt(D/2);A=A>F?D-A:A;G=G>F?D-G:G;return A>=F||G>=F;};mstrResizeDocObjs.prototype.getMovedDistance=function(E){var C=this.parentBone,B=C.docViewer.elem;var A=(mstr.utils.ISFF2||mstr.utils.ISIE8)?(B.scrollLeft-C.mousedownScrollLeft):0,D=B.scrollTop-C.mousedownScrollTop;return{x:A+lMouseX-C.mousedownX,y:D+lMouseY-C.mousedownY};};mstrResizeDocObjs.prototype.onresize=function(S){try{if(!S){S=window.event;}if(S.e){S=S.e;}var B=this.parentBone;getMouse(S);B.getMouseDirection();var K=(S.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF;if(!K&&!this.checkMovedDistance(S)){return false;}var G=dy=dr=db=1;var L=this.oc.activeHilite.getAttribute("id").substr(6);var R=this.oc.resizeStyle;var C=new RectObj(B.hilites[L].getDefault().src);var E=this.getMovedDistance(S);if(R.indexOf("w")>-1){G=(C.width-E.x)/C.width;}if(R.indexOf("e")>-1){dr=(C.width+E.x)/C.width;}if(R.indexOf("n")>-1){dy=(C.height-E.y)/C.height;}if(R.indexOf("s")>-1){db=(C.height+E.y)/C.height;}var O=this.getNewRects(R,G,dy,dr,db,true,true,K);if(!O){return false;}var P=0;var U=microstrategy.findBone(this.items[L].parentNode);this.dxoff=this.dyoff=this.droff=this.dboff=0;if(!K&&U.canShowGuideline()){if(R.indexOf("w")>-1){this.dxoff=U.guidelineOffsetX||0;}if(R.indexOf("e")>-1){this.droff=U.guidelineOffsetX||0;}if(R.indexOf("n")>-1){this.dyoff=U.guidelineOffsetY||0;}if(R.indexOf("s")>-1){this.dboff=U.guidelineOffsetY||0;}}for(var L in this.items){if(this.parentBone.isLocked(this.items[L])){continue;}var A=this.parentBone.hilites[L].getDefault();var J=O&&O[P++];if((this.dxoff||this.droff||this.dyoff||this.dboff)){this.previousRect=J;J=this.adjustForGuidelineSnapOffset(J,R);var R=A.style;R.width=Math.max(Math.ceil(J.width-microstrategy.getPaddingAndBorderPixels(A,"width")),0)+"px";R.height=Math.max(Math.ceil(J.height-microstrategy.getPaddingAndBorderPixels(A,"height")),0)+"px";if(U.isHorizontal){R.left=J.left+getObjSumLeft(this.items[L].parentNode)-this.doc.left+"px";}else{R.left=J.left+"px";}R.top=J.top+"px";this.parentBone.hilites[L].syncHandles(true);U.showGuidelines(U.getLocalPosition(A));}else{if(!(this.previousRect&&(J.left==this.previousRect.left&&J.top==this.previousRect.top&&J.width==this.previousRect.width&&J.height==this.previousRect.height))){this.previousRect=null;var T=this.parentBone.parentBone.selections.mouseDir,H=T.x,M=T.y;var F=Math.max(parseInt(J.width-microstrategy.getPaddingAndBorderPixels(A,"width")),0),Q=Math.max(parseInt(J.height-microstrategy.getPaddingAndBorderPixels(A,"height")),0),I=J.top,N=U.isHorizontal?J.left+getObjSumLeft(this.items[L].parentNode)-this.doc.left:J.left,R=A.style;if(H<0&&N<parseInt(R.left)||H>0&&N>parseInt(R.left)){R.left=N+"px";}if(M<0&&I<parseInt(R.top)||M>0&&I>parseInt(R.top)){R.top=I+"px";}if(H<0&&F<parseInt(R.width)||H>0&&F>parseInt(R.width)){R.width=F+"px";}if(M<0&&Q<parseInt(R.height)||M>0&&Q>parseInt(R.height)){R.height=Q+"px";}this.parentBone.hilites[L].syncHandles(true);U.showGuidelines(U.getLocalPosition(A));}}}}catch(D){microstrategy.errors.log(D);}return false;};mstrResizeDocObjs.prototype.onresizeend=function(G){try{if(!G){G=window.event;}if(G.e){G=G.e;}this.parentBone.onmouseup(G,this.path);for(var H in this.items){if(this.items[H].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){microstrategy.bone(this.items[H].firstChild.id).toggleCurtain(false);}}var H=this.oc.activeHilite.getAttribute("id").substr(6);if(!this.parentBone.hilites[H]){return ;}var E=new RectObj(this.parentBone.hilites[H].getDefault().src);this.parentBone.toggleHiliteBorders(false);var C=this.oc.resizeStyle;var A=dy=dr=db=0;var B=this.getMovedDistance(G);if(C.indexOf("w")>-1){A=-B.x;}if(C.indexOf("e")>-1){dr=B.x;}if(C.indexOf("n")>-1){dy=-B.y;}if(C.indexOf("s")>-1){db=B.y;}var F=(G.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF;this.resizeItems(C,A,dy,dr,db,true,F);this.oc.activeHilite=null;for(var H in this.parentBone.hilites){this.parentBone.hilites[H].vflipped=this.parentBone.hilites[H].hflipped=false;}microstrategy.eventManager.notifyOrphanBones("onboneafterresize",this.parentBone.getSelectedIds());this.doc.parentBone.isDragging=false;this.parentBone.parentBone.selections.syncPositionMap(this.items);}catch(D){microstrategy.errors.log(D);}return false;};mstrResizeDocObjs.prototype.getNewRects=function(U,M,L,P,Z,H,D,O){try{this.items=this.parentBone.items;var S=[];var X=100000;var W=100000;var a=-100000;var I=-100000;for(var Q in this.items){var N=this.items[Q];var K=N.parentNode;var C=new RectObj(N);var T=new RectObj(K);X=Math.min(((C.right-getObjSumLeft(K))/C.width),X);W=Math.min(((C.bottom-getObjSumTop(K))/C.height),W);a=Math.max(((C.left-T.right)/C.width),a);I=Math.max(((C.top-T.bottom)/C.height),I);}var B=N.parentNode.getAttribute("sty")==microstrategy.SUBOBJTYPE_DOC_PANEL;if(B){M=Math.max(1+a,Math.min(X,M));P=Math.min(-a,Math.max(1-X,P));L=Math.max(1+I,Math.min(W,L));Z=Math.min(-I,Math.max(1-W,Z));}else{M=Math.min(X,M);P=Math.max(1-X,P);L=Math.min(W,L);Z=Math.max(1-W,Z);}for(var Q in this.items){var A=this.parentBone.hilites[Q];var N=this.items[Q];var G=N.parentNode;var C=new RectObj(N);var R=C.height;var J=C.width;C.add(Math.round(-C.width*M+C.width),Math.round(-C.height*L+C.height),Math.round(C.width*P-C.width),Math.round(C.height*Z-C.height));var Y=microstrategy.findBone(this.items[Q].parentNode);if(Y.isHorizontal){C.setBase(((bIsW3C)?this.parentBone.leftBorderOffset:0)+getObjSumLeft(K),this.doc.top);}else{C.setBase(this.doc.left+((bIsW3C)?this.parentBone.leftBorderOffset:0),this.doc.top);}var F=snapY=snapR=snapB=0;if(M&&M!=1){F=microstrategy.snapCoordinate(C.left,0,!O,(M<1)?microstrategy.SNAP_DIRET_POS:microstrategy.SNAP_DIRET_NEG)-C.left;}if((L&&L!=1)&&!O){snapY=microstrategy.snapCoordinate(C.top,(getObjSumTop(G)-this.doc.top),!O,(L<1)?microstrategy.SNAP_DIRET_POS:microstrategy.SNAP_DIRET_NEG)-C.top;}if(P&&P!=1){snapR=microstrategy.snapCoordinate(C.right,0,!O,(P>1)?microstrategy.SNAP_DIRET_POS:microstrategy.SNAP_DIRET_NEG)-C.right;}if((Z&&Z!=1)&&!O){snapB=microstrategy.snapCoordinate(C.bottom,getObjSumTop(G)-this.doc.top,!O,(Z>1)?microstrategy.SNAP_DIRET_POS:microstrategy.SNAP_DIRET_NEG)-C.bottom;}if(!O&&B){if((Z!=1)&&(C.height+snapB)>(R*-I)){snapB=1;}if((L!=1)&&(C.height-snapY)<(R*(1+I))){snapY=1;}if((M!=1)&&((C.width-F)>(J*X)||(C.width-F)<(J*(1+a)))){F=1;}if((P!=1)&&((C.width+snapR)>(J*-a)||(C.width+snapR)<(J*(1-X)))){snapR=1;}}C.add(F,snapY,snapR,snapB);if(this.parentBone.styleObj.getAttValue(this.items[Q],microstrategy.HTMLATTR_LOCK_ASPECT_RATIO)==microstrategy.TRUE&&U.length==2){var V=new RectObj(N);M=P=C.width/V.width;L=Z=C.height/V.height;if(U.indexOf("n")>-1){if(U.indexOf("w")>-1){M=L=Math.abs(M)>Math.abs(L)?M:L;if(W<L){M=L=W;}if(X<M){L=M=X;}P=Z=1;}else{P=L=Math.abs(P)>Math.abs(L)?P:L;if(W<L){P=L=W;}M=Z=1;}}else{if(U.indexOf("w")>-1){M=Z=Math.abs(M)>Math.abs(Z)?M:Z;if(X<M){Z=M=X;}L=P=1;}else{P=Z=Math.abs(P)>Math.abs(Z)?P:Z;M=L=1;}}C=new RectObj(N);C.add(Math.round(-C.width*M+C.width),Math.round(-C.height*L+C.height),Math.round(C.width*P-C.width),Math.round(C.height*Z-C.height));if(Y.isHorizontal){C.setBase(this.parentBone.leftBorderOffset+getObjSumLeft(K),this.doc.top);}else{C.setBase(this.doc.left+this.parentBone.leftBorderOffset,this.doc.top);}}if(C.checkHFlip()){if(!H){return null;}if(D){A.hflipped=!A.hflipped;}}if(C.checkVFlip()){if(!H){return null;}if(D){A.vflipped=!A.vflipped;}}S.push(C);}return S;}catch(E){microstrategy.errors.log(E);}};mstrResizeDocObjs.prototype.adjustForGuidelineSnapOffset=function(F){try{var C=parseInt(this.dxoff)||0,H=parseInt(this.droff)||0,L=parseInt(this.dyoff)||0,K=parseInt(this.dboff)||0;var B=microstrategy.SNAP_SIZE;if(Math.abs(C)<B&&Math.abs(H)<B&&Math.abs(L)<B&&Math.abs(K)<B){var G={left:0,top:0,width:0,height:0};var A=this.oc.resizeStyle,I=this.parentBone.parentBone.selections.mouseDir,J=I.x,E=I.y;if(A.indexOf("w")>-1&&(J<0&&C>0||J>0&&C<0)){F.left+=J*(Math.abs(C));F.width-=J*(Math.abs(C));G.left=J*(Math.abs(C));G.width=-J*(Math.abs(C));}if(A.indexOf("e")>-1&&(J<0&&H>0||J>0&&H<0)){F.width+=J*(Math.abs(H));G.width=J*(Math.abs(H));}if(A.indexOf("n")>-1&&(E<0&&L>0||E>0&&L<0)){F.top+=E*(Math.abs(L));F.height-=E*(Math.abs(L));G.top=E*(Math.abs(L));G.height=-E*(Math.abs(L));}if(A.indexOf("s")>-1&&(E<0&&K>0||E>0&&K<0)){F.height+=E*(Math.abs(K));G.height=E*(Math.abs(L));}this.deltaRect=G;}return F;}catch(D){microstrategy.errors.log(D);}};mstrResizeDocObjs.prototype.resizeItems=function(R,K,J,O,U,F,N){if(!this.parentBone.isActive()){return true;}try{if(F){var E=this.parentBone.hilites[this.oc.activeHilite.getAttribute("id").substr(6)].getDefault().src;}else{var E=this.parentBone.firstItem();for(var P in this.items){var L=this.items[P];if(R.indexOf("e")>-1&&getObjWidth(L)<getObjWidth(E)){E=L;}if(R.indexOf("s")>-1&&getObjHeight(L)<getObjHeight(E)){E=L;}}}var A=new RectObj(E);var I=1;var M=1;var H=1;var T=1;var G=0;if(R.indexOf("w")>-1){I=(A.width+K)/A.width;G+=microstrategy.WIDTH_UPDATE;}if(R.indexOf("e")>-1){M=(A.width+O)/A.width;G+=microstrategy.WIDTH_UPDATE;}if(R.indexOf("n")>-1){H=(A.height+J)/A.height;G+=microstrategy.HEIGHT_UPDATE;}if(R.indexOf("s")>-1){T=(A.height+U)/A.height;G+=microstrategy.HEIGHT_UPDATE;}var Q=this.getNewRects(R,I,H,M,T,F,false,N);if(!Q){this.parentBone.syncUp();return true;}this.items=this.parentBone.items;var S=[];var C=0;var D=false;for(var P in this.items){if(this.parentBone.isLocked(this.items[P])){continue;}if(this.resizeItem(this.items[P],Q[C++],S,G)){D=true;}}S=this.parentBone.resizeSubSection(false,S);S=this.parentBone.resetRange(false,S);if(S&&S.length>0){this.um.add(S);if(D){this.um.flushAndSubmitChanges();}}this.parentBone.syncUp();microstrategy.eventManager.notifyOrphanBones("onboneafterresize",this.parentBone.getSelectedIds());}catch(B){microstrategy.errors.log(B);}return false;};mstrResizeDocObjs.prototype.resizeItem=function(P,B,T,J){try{var H=false;if(!this.parentBone.isActive()){return H;}var V=this.deltaRect;if(V){B.left+=V.left;B.top+=V.top;B.width+=V.width;B.height+=V.height;}var I=microstrategy.styleObj;var U=microstrategy.findBone(P.parentNode);var O=null;var R=0;if(U.isHorizontal){R=getObjSumLeft(P.parentNode)-this.doc.left;}if(bIsW3C){var A=I.getValue(this.doc.elem,"borderLeftWidth");if(A!=null&&A.indexOf("pt")>0){var M=microstrategy.getFormatObject();A=Math.round(M.getPxFromPt(parseFloat(A)));}else{A=0;}T=this.doc.formatItems(microstrategy.createAssociativeArray(P),"left",(B.left-getObjSumLeft(P.parentNode)+this.doc.left+A+R)+"px",false,T);}else{T=this.doc.formatItems(microstrategy.createAssociativeArray(P),"left",(B.left-getObjSumLeft(P.parentNode)+this.doc.left+R)+"px",false,T);}T=this.doc.formatItems(microstrategy.createAssociativeArray(P),"top",(B.top-getObjSumTop(P.parentNode)+this.doc.top)+"px",false,T);switch(P.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)){case microstrategy.SUBOBJTYPE_DOC_LINE:if(this.parentBone.styleObj.getAttValue(P,microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_VERTICAL){this.doc.formatSize(microstrategy.createAssociativeArray(P),"height",B.height+"px",T);this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"heightMode","0",T,false);}else{this.doc.formatSize(microstrategy.createAssociativeArray(P),"width",B.width+"px",T);this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"widthMode","0",T,false);}break;case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_TEXT:var C=null,L=microstrategy.styleObj.getValue(P,"TextDirection")||"0";if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){var D=this.parentBone.checkFormat("Hmode");var F=this.parentBone.checkFormat("Wmode");this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"heightMode","0",T,false);this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"widthMode","0",T,false);if(P.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){C=microstrategy.findBone(P);if(C&&((C.commands.queryState("gridMode")!=microstrategy.DISPLAY_MODE_GRID&&C.isTemplateEmpty()==false)||(this.parentBone.parentBone.commands.queryState("Overflow")=="1"&&D=="2"&&F=="2"))){H=true;}}}this.doc.formatSize(microstrategy.createAssociativeArray(P),"height",B.height+"px",T,true);this.doc.formatSize(microstrategy.createAssociativeArray(P),"width",B.width+"px",T,true);if(C&&C.commands.queryState("gridMode")==microstrategy.DISPLAY_MODE_GRID&&C.isTemplateEmpty()==false&&C.commands.queryState("fittowindow")&&!C.lockSet){O=C;}break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:if(J==microstrategy.HEIGHT_UPDATE||J==microstrategy.WIDTH_AND_HEIGHT_UPDATE){if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"heightMode","0",T,false);}this.doc.formatSize(microstrategy.createAssociativeArray(P),"height",B.height+"px",T,true);}if(J==microstrategy.WIDTH_UPDATE||J==microstrategy.WIDTH_AND_HEIGHT_UPDATE){if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){this.doc.formatSizeMode(microstrategy.createAssociativeArray(P),"widthMode","0",T,false);}this.doc.formatSize(microstrategy.createAssociativeArray(P),"width",B.width+"px",T,true);}break;default:this.doc.formatSize(microstrategy.createAssociativeArray(P),"height",B.height+"px",T,true);this.doc.formatSize(microstrategy.createAssociativeArray(P),"width",B.width+"px",T,true);break;}var N=getObjWidth(P);var S=getObjHeight(P);var Q=P.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(Q==microstrategy.SUBOBJTYPE_DOC_IMAGE){var K=microstrategy.subObjectFind(P,["IMG"]);this.setPictureDimension(P,K,S,N);}else{if(Q==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){mstrStaticDoc.getBone(P).resizeGridAndGraph(S,N);}else{if(Q==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var G=microstrategy.bone(P.getAttribute("id"));if(G){G.resize(this.doc.removePaddingAndBorder(P,B.height,"height"),this.doc.removePaddingAndBorder(P,B.width,"width"));}}}}if(O){O.commands.exec("setColWidthsMode",mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY);if(O.colWidths){O.colWidths.syncCols();}}return H;}catch(E){microstrategy.errors.log(E);return false;}};mstrResizeDocObjs.prototype.setPictureDimension=function(B,E,C,A){try{if(E){E.style.height="100%";E.style.width="100%";}}catch(D){microstrategy.errors.log(D);}};function mstrResizeDocObjs(){return this;}function Rect(D,B,A,C){this.top=D;this.right=B;this.bottom=A;this.left=C;return this;}RectObj.prototype={};RectObj.prototype.toString=function(){try{var A="";for(var C in this){if(typeof (this[C])!="function"){A+=C+": "+this[C]+"\n";}}return A;}catch(B){microstrategy.errors.log(B);return"";}};RectObj.prototype.add=function(C,A,E,B){try{if(C){this.left+=C;}if(A){this.top+=A;}if(E){this.right+=E;}if(B){this.bottom+=B;}this.height=this.bottom-this.top;this.width=this.right-this.left;}catch(D){microstrategy.errors.log(D);}};RectObj.prototype.setBase=function(A,C){try{this.left-=A;this.top-=C;this.right-=A;this.bottom-=C;}catch(B){microstrategy.errors.log(B);}};RectObj.prototype.checkHFlip=function(){try{if(this.bottom<=this.top){var A=this.top;this.top=this.bottom;this.bottom=A;this.height=this.bottom-this.top;return true;}return false;}catch(B){microstrategy.errors.log(B);}};RectObj.prototype.checkVFlip=function(){try{if(this.right<=this.left){var A=this.left;this.left=this.right;this.right=A;this.width=this.right-this.left;return true;}return false;}catch(B){microstrategy.errors.log(B);}};function RectObj(D){var G=microstrategy.styleObj.getValue(D,"TextDirection")||"0";try{var A=I=0;if(D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var B="width",H="height",A=Math.round(microstrategy.getPaddingAndBorderPixels(D,H)),I=Math.round(microstrategy.getPaddingAndBorderPixels(D,B));var E=microstrategy.styleObj.getValue(D,H);var F=microstrategy.styleObj.getValue(D,B);if(E=="auto"||E=="100%"){this.height=G==="0"?getObjHeight(D):getObjWidth(D);}else{this.height=Math.max(parseInt(E)+A,0);}if(F=="auto"||F=="100%"){this.width=G==="0"?getObjWidth(D):getObjHeight(D);}else{this.width=Math.max(parseInt(F)+I,0);}}else{var J=0;if(D.style.borderTopWidth.length>0){J+=parseFloat(D.style.borderTopWidth);}if(D.style.borderBottomWidth.length>0){J+=parseFloat(D.style.borderBottomWidth);}A=Math.round(microstrategy.getFormatObject().getPxFromPt(J));J=0;if(D.style.borderLeftWidth.length>0){J+=parseFloat(D.style.borderLeftWidth);}if(D.style.borderRightWidth.length>0){J+=parseFloat(D.style.borderRightWidth);}I=Math.round(microstrategy.getFormatObject().getPxFromPt(J));this.height=Math.max(parseInt(D.style.height)+A);this.width=Math.max(parseInt(D.style.width)+I);}this.left=getObjSumLeft(D);this.top=getObjSumTop(D);if(!bIsDXIE&&G==="90"){this.top=this.top-this.height;}this.right=this.left+this.width;this.bottom=this.top+this.height;return this;}catch(C){microstrategy.errors.log(C);return null;}}mstrFixedPanel.prototype=new mstrSubSection();mstrFixedPanel.prototype.ruler=null;mstrFixedPanel.prototype.handle=null;mstrFixedPanel.prototype.rulerShade=null;mstrFixedPanel.prototype.nextSibling="";mstrFixedPanel.prototype.isCanGrowCanShrink=true;mstrFixedPanel.prototype.oldHeight=null;mstrFixedPanel.prototype.subsectionType=mstrSubSection.TYPE_FIXED;mstrFixedPanel.prototype.isHorizontal=false;mstrFixedPanel.prototype.isBeginHorizontal=false;mstrFixedPanel.prototype.isEndHorizontal=false;mstrFixedPanel.prototype.horizontalContainerBone=null;mstrFixedPanel.prototype.isCanGrowCanShrinkHorizontal=true;mstrFixedPanel.prototype.oldWidth=null;mstrFixedPanel.prototype.forceGrowOnResize=false;mstrFixedPanel.prototype.hasConditionalFormatting=false;mstrFixedPanel.prototype.onload=function(){try{mstrSubSection.prototype.onload.call(this);var B=microstrategy.styleObj;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.isDetails=(this.elem.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)==-1);this.isHorizontal=(B.getAttValue(this.elem,microstrategy.HTMLATTR_IS_HORIZONTAL)=="-1");if(this.isHorizontal){this.isBeginHorizontal=(B.getAttValue(this.elem,microstrategy.HTMLATTR_IS_BEGIN_HORIZONTAL)=="-1");this.isEndHorizontal=(B.getAttValue(this.elem,microstrategy.HTMLATTR_IS_END_HORIZONTAL)=="-1");}this.container=this.elem.parentNode;this.hasConditionalFormatting=(B.getAttValue(this.elem,microstrategy.HTMLATTR_HAS_CONDITIONAL_FORMATTING)=="-1");var A=B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW);var F=B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK);if(((A==microstrategy.FALSE&&F==microstrategy.FALSE)||microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE)){this.isCanGrowCanShrink=false;}var C=B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);var I=B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);if(((C==microstrategy.FALSE&&I==microstrategy.FALSE)||microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE)){this.isCanGrowCanShrinkHorizontal=false;}this.calcHasObjects();var G=this.doc.parentBone;if(G.isEditableViewModeEplus()){var H=microstrategy.objectFind(this.container,["DIV"],microstrategy.OBJTYPE_RULER);if(H&&H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_VRULER){this.ruler=H;this.rulerShade=microstrategy.subObjectFind(this.ruler,["DIV"],microstrategy.SUBOBJTYPE_VRULER_SHADE);}}if(G.layoutHeightMode!=1){this.adjustSubsectionHeight(false);}if(this.isHorizontal==false&&G.isEditableViewModeEplus()){for(var E=0;E<this.sibs.length;E++){G.totalHeight+=parseInt(B.getValue(this.sibs[E],"height"));}}if(this.isHorizontal){this.adjustSubsectionWidth(false);}this.applyGradient();}catch(D){microstrategy.errors.log(D);}};mstrFixedPanel.prototype.getOldHeight=function(){try{if(this.oldHeight==null){this.oldHeight=getObjHeight(this.elem);}return this.oldHeight;}catch(A){microstrategy.errors.log(A);return -1;}};mstrFixedPanel.prototype.getOldWidth=function(){try{if(this.oldWidth==null){this.oldWidth=getObjWidth(this.elem);}return this.oldWidth;}catch(A){microstrategy.errors.log(A);return -1;}};mstrFixedPanel.prototype.calcMaxContentHeight=function(){try{this.maxContentHeight=-1;this.maxContentWidth=-1;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE){return ;}if(this.isHorizontal){if(!this.isCanGrowCanShrink&&!this.isCanGrowCanShrinkHorizontal){return ;}}else{if(!this.isCanGrowCanShrink){return ;}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){if(this.isCanGrowCanShrink){this.sibsHeight=new Array();}if(this.isCanGrowCanShrinkHorizontal&&this.isHorizontal){this.sibsWidth=new Array();}}var L=-1;var A=-1;var D=microstrategy.styleObj;var E=null;for(var H=0;H<this.sibs.length;H++){E=this.sibs[H];if(E!=null){var B=-1;var I=-1;if(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.RESIZE_EACH_SUBSECTION&&!this.containsDocObject(E)){continue;}for(var G=0;G<E.childNodes.length;G++){var C=E.childNodes[G];if(C.nodeType==1){if(this.isCanGrowCanShrinkHorizontal&&this.isHorizontal){A=getObjWidth(C);if(microstrategy.subObjectType(C)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){A=Math.max((C.scrollWidth?C.scrollWidth:0),A);}A+=parseInt(D.getValue(C,"left"));if(A>I){I=A;}}if(this.isCanGrowCanShrink){if(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&C.style.display!="none"){if(D.getAttValue(C,microstrategy.HTMLATTR_HEIGHT_MODE)){if(D.getAttValue(C,microstrategy.HTMLATTR_HEIGHT_MODE)!=microstrategy.HUNDRED_PERCENT_MODE){var J=getObjHeight(C);var K=parseInt(D.getValue(C,"top"));L=(isNaN(K)?0:K)+J;}}else{L=parseInt(D.getValue(C,"top"))+getObjHeight(C);}if(L>B){B=L;}}}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){this.maxContentHeight=B;this.maxContentWidth=I;break;}else{if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){if(this.isCanGrowCanShrink){this.sibsHeight.push(B);}if(this.isCanGrowCanShrinkHorizontal&&this.isHorizontal){this.sibsWidth.push(I);}}}}window.setTimeout(this.path+".getOldHeight()",0);}catch(F){microstrategy.errors.log(F);return false;}};mstrFixedPanel.prototype.calcHasObjects=function(){try{for(var A=0;A<this.sibs.length;A++){if(this.containsDocObject(this.sibs[A])){return true;}}return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrFixedPanel.prototype.toggleSelected=function(){try{for(var C=0;C<this.sibs.length;C++){if(this.isHorizontal){var B=this.sibs[C].parentNode.parentNode.previousSibling.firstChild;}else{var B=this.sibs[C].parentNode.previousSibling;}if(B){var A=B.className;var E=A.indexOf("selected");if(E>-1){B.className=A.substring(0,E);}else{B.className+="selected";if(bIsFirefox){getObj("rwb_viewer").focus();}}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrFixedPanel.prototype.isEndHorizontalSib=function(A){try{if(this.isDetails&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){return this.isEndHorizontal&&this.sibs.length-1==A;}else{return this.isEndHorizontal;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFixedPanel.prototype.isBeginHorizontalSib=function(A){try{if(this.isDetails&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){return this.isBeginHorizontal&&A==0;}else{return this.isBeginHorizontal;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFixedPanel.prototype.toggleGrid=function(B){try{for(var A=0;A<this.sibs.length;A++){this.sibs[A].style.backgroundImage=(B)?"url(none)":"url("+microstrategy.FOLDER_IMAGES+microstrategy.GRID_IMAGE+")";}}catch(C){microstrategy.errors.log(C);return false;}};mstrFixedPanel.prototype.ondragstart=function(C){try{var B=microstrategy.styleObj;if(!C){C=window.event;}if(C.e){C=C.e;}getMouse(C);if(this.isHorizontal){this.startX=lMouseX;this.oldWidth=getObjWidth(this.prevElem);this.oldCanGrowHorizontal=B.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);this.oldCanShrinkHorizontal=B.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);}else{this.startY=lMouseY;this.oldHeight=getObjHeight(this.prevElem);this.oldCanGrow=B.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_GROW);this.oldCanShrink=B.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_SHRINK);}this.oldHideIfEmpty=B.getAttValue(this.prevElem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondrag");this.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondragend(e); }");}this.ondrag(C);}catch(A){microstrategy.errors.log(A);}return false;};mstrFixedPanel.prototype.ondrag=function(F){try{if(!F){F=window.event;}if(F.e){F=F.e;}getMouse(F);if(this.isHorizontal){var C=lMouseX-this.startX;var E=this.getOldWidth()+C;if(E>=0){if(this.ruler!=null){this.ruler.style.width=E+"px";}this.prevElem.style.width=E+"px";this.oldWidth=E;this.startX=lMouseX;}}else{var A=lMouseY-this.startY;var B=this.getOldHeight()+A;if(B>=0){if(this.ruler!=null){this.ruler.style.height=B+"px";}this.prevElem.style.height=B+"px";this.oldHeight=B;this.startY=lMouseY;}}}catch(D){microstrategy.errors.log(D);}return false;};mstrFixedPanel.prototype.ondragend=function(C){try{if(!C){C=window.event;}if(C.e){C=C.e;}getMouse(C);var B=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.parentBone.parentBone.parentBone.formattingAttributes;var D=this.id;if(this.isHorizontal){this.resizeWidth(parseInt(microstrategy.styleObj.getValue(this.prevElem,"width")),true,null);if(B&&D){B[D][microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL]=microstrategy.FALSE;B[D][microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL]=microstrategy.FALSE;}}else{this.resize(parseInt(microstrategy.styleObj.getValue(this.prevElem,"height")),true,null);if(B&&D){B[D][microstrategy.HTMLATTR_CAN_SHRINK]=microstrategy.FALSE;B[D][microstrategy.HTMLATTR_CAN_GROW]=microstrategy.FALSE;B[D][microstrategy.HTMLATTR_HIDE_IF_EMPTY]=microstrategy.FALSE;}}this.onmouseup(C);if(this.isHorizontal){this.oldWidth=getObjWidth(this.elem);}else{this.oldHeight=getObjHeight(this.elem);}}catch(A){microstrategy.errors.log(A);}return false;};mstrFixedPanel.prototype.onmouseup=function(B){try{if(typeof (mstr)!="undefined"){this.detachWinListener(this,"mousemove");this.detachWinListener(this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(A){microstrategy.errors.log(A);}return false;};mstrFixedPanel.prototype.resizeEverySubSection=function(B,F,A,C,G){try{var D=mstrFormatObject.encodeValue("height",B);if(this.isHorizontal){this.updateHorizontalContainerHeight(F,B);}else{F.style.height=B+"px";this.parentBone.parentBone.resizeSubMaskForSib(this.parentBone.id,this.id,B,C,"height");if(B>0){this.parentBone.parentBone.hideSubMaskForSib(this.parentBone.id,this.id,false,C);}if(A){if(G){microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT,D);}this.oldHeight=getObjHeight(this.elem);if(this.resizeTimer){window.clearTimeout(this.resizeTimer);}this.resizeTimer=window.setTimeout(function(){microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");},0);}}}catch(E){microstrategy.errors.log(E);}};mstrFixedPanel.prototype.resizeEverySubSectionWidth=function(F,E,A,B){try{var C=mstrFormatObject.encodeValue("width",F);E.style.width=F+"px";if(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){}this.parentBone.parentBone.resizeSubMaskForSib(this.parentBone.id,this.id,F,B,"width");if(F>0){this.parentBone.parentBone.hideSubMaskForSib(this.parentBone.id,this.id,false,B);}if(A){microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_WIDTH,C);this.oldwidth=getObjWidth(this.elem);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}}catch(D){microstrategy.errors.log(D);}};mstrFixedPanel.prototype.simpleWidthResize=function(D){try{var A=mstrFormatObject.encodeValue("width",D);for(var B=0;B<this.sibs.length;B++){this.sibs[B].style.width=D+"px";}this.parentBone.parentBone.resizeSubMask(this.parentBone.id,this.id,D-this.getOldWidth(),"width");if(D>0){this.parentBone.parentBone.hideSubMask(this.parentBone.id,this.id,false);}microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_WIDTH,A);this.oldWidth=getObjWidth(this.elem);this.parentBone.parentBone.parentBone.resize100WMObjects(this.id);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}catch(C){microstrategy.errors.log(C);}};mstrFixedPanel.prototype.updateHorizontalContainerHeight=function(K,A){try{var I=null;var D=microstrategy.findAncestorWithAtt(K,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(D){D.style.height=A+"px";I=microstrategy.findBone(D);}if(I){var H=Math.max(I.height,A);I.height=H;hcTitle=microstrategy.findChildrenWithAtt(D,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);if(hcTitle){for(var F=0,C=hcTitle.length;F<C;F++){hcTitle[F].style.height=H+"px";if(mstr.utils.ISFF3_5){var J=hcTitle[F].firstChild;J.style.display="block";J.style.MozTransform="rotate(-90deg)";J.style.height=H+"px";J.style.width=H+"px";var B=J.firstChild;if(B&&B.tagName&&B.tagName.toLowerCase()=="img"){B.setAttribute("style","float: right");B.style.MozTransform="rotate(90deg)";}}}}if(mstr.utils.ISIE8){var G=microstrategy.findChildrenWithAtt(D,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE);if(G){for(var F=0,C=G.length;F<C;F++){G[F].style.height=H+"px";}}}}}catch(E){microstrategy.errors.log(E);}};mstrFixedPanel.prototype.simpleResize=function(A){try{var C=mstrFormatObject.encodeValue("height",A);for(var B=0;B<this.sibs.length;B++){if(this.isHorizontal){this.updateHorizontalContainerHeight(this.sibs[B],A);}else{this.sibs[B].style.height=A+"px";this.sibs[B].parentNode.firstChild.style.height=A+"px";}}if(!this.isHorizontal){this.doc.resizeSubMask(this.parentBone.id,this.id,A-this.getOldHeight(),"height");if(A>0){this.doc.hideSubMask(this.parentBone.id,this.id,false);}microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT,C);this.oldHeight=getObjHeight(this.elem);this.doc.parentBone.resize100HMObjects(this.id);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}}catch(D){microstrategy.errors.log(D);}};mstrFixedPanel.prototype.resize=function(A,G,P){try{var L=mstrFormatObject;var B=microstrategy.styleObj;var J=L.encodeValue("height",A);var M=L.encodeValue("height",this.getOldHeight());if(this.isHorizontal){var C=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(C){var E=microstrategy.findBone(C);E.oldHeight=M;}}var D=[B.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];this.simpleResize(A);var N=(P!=null);if(G||N){var K=microstrategy.bones.rwb_viewer.updateManager;if(!N){var P=new Array();}}if(P){var O=new Object();O.subsectionHeight=true;var H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+J;var I=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+M;O.origValue=[B.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];O.cachedOldValue=D;P.push(K.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H],[mstrUpdateManager.UPDATE_LATER,I],O));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrow"+mstrUpdateManager.UNIT_SEPARATOR+"0";I=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrow"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanGrow;P.push(K.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H],[mstrUpdateManager.UPDATE_LATER,I],O));H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrink"+mstrUpdateManager.UNIT_SEPARATOR+"0";I=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrink"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanShrink;P.push(K.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H],[mstrUpdateManager.UPDATE_LATER,I],O));H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+"0";I=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+this.oldHideIfEmpty;P.push(K.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H],[mstrUpdateManager.UPDATE_LATER,I],O));}if(!N&&G&&P.length>0){K.add(P);}}this.applyGradient();return(N)?P:null;}catch(F){microstrategy.errors.log(F);return P;}};mstrFixedPanel.prototype.resizeWidth=function(G,E,N){try{var J=mstrFormatObject;var B=microstrategy.styleObj;var K=J.encodeValue("width",G);var A=J.encodeValue("width",this.getOldWidth());var C=[B.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];this.simpleWidthResize(G);var L=(N!=null);if(E||L){var I=this.parentBone.parentBone.parentBone.updateManager;if(!L){var N=new Array();}}this.parentBone.parentBone.updateLayoutWidth(N,false);if(N){var M=new Object();M.subsectionWidth=true;var F=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+K;var H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+A;M.origValue=[B.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];M.cachedOldValue=C;N.push(I.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,F],[mstrUpdateManager.UPDATE_LATER,H],M));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){F=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrowHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+"0";H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrowHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanGrow;N.push(I.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,F],[mstrUpdateManager.UPDATE_LATER,H],M));F=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrinkHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+"0";H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrinkHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanShrink;N.push(I.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,F],[mstrUpdateManager.UPDATE_LATER,H],M));F=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+"0";H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+this.oldHideIfEmpty;N.push(I.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,F],[mstrUpdateManager.UPDATE_LATER,H],M));}if(!L&&E&&N.length>0){I.add(N);}}return(L)?N:null;}catch(D){microstrategy.errors.log(D);return N;}};mstrFixedPanel.prototype.changeSubHeight=function(A,G,Q){try{var L=microstrategy.getFormatObject();var B=microstrategy.styleObj;var J=L.encodeValue("height",A);var N=L.encodeValue("height",this.getOldHeight());var E=[B.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];if(this.isHorizontal){var C=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(C){var D=microstrategy.findBone(C);D.oldHeight=N;}}this.simpleResize(A);var O=(Q!=null);if(G||O){var K=this.parentBone.parentBone.parentBone.updateManager;if(!O){var Q=new Array();}}if(Q){var P=new Object();P.subsectionHeight=true;var H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+J;var I=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+N;var M=[J,B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];P.origValue=M;P.cachedOldValue=E;Q.push(K.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H],[mstrUpdateManager.UPDATE_LATER,I],P));if(!O&&G&&Q.length>0){K.add(Q);}}return(O)?Q:null;}catch(F){microstrategy.errors.log(F);return Q;}};mstrFixedPanel.prototype.changeSubWidth=function(G,E,N){try{var J=mstrFormatObject;var B=microstrategy.styleObj;var K=J.encodeValue("width",G);var A=J.encodeValue("width",this.getOldWidth());var C=[B.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL),B.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];this.simpleWidthResize(G);var L=(N!=null);if(E||L){var I=this.parentBone.parentBone.parentBone.updateManager;if(!L){var N=new Array();}}this.parentBone.parentBone.updateLayoutWidth(N);if(N){var M=new Object();M.subsectionWidth=true;var F=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+K;var H=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+A;M.origValue=C;M.cachedOldValue=C;N.push(I.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,F],[mstrUpdateManager.UPDATE_LATER,H],M));if(!L&&E&&N.length>0){I.add(N);}}this.applyGradient();return(L)?N:null;}catch(D){microstrategy.errors.log(D);return N;}};mstrFixedPanel.prototype.hide=function(){try{this.elem.style.display="none";this.container.style.display="none";if(this.parentBone.parentBone.parentBone.rulerOn&&this.ruler){this.ruler.style.display="none";}this.parentBone.parentBone.hideSubMask(this.parentBone.id,this.id,true);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}catch(A){microstrategy.errors.log(A);return false;}};mstrFixedPanel.prototype.show=function(){try{this.elem.style.display="block";this.container.style.display="block";if(this.parentBone.parentBone.parentBone.rulerOn){if(this.ruler){this.ruler.style.display="block";}}this.parentBone.parentBone.hideSubMask(this.parentBone.id,this.id,false);var D=microstrategy.findChildrenWithAtt(this.elem,"SPAN","sty",8);for(var B=0;B<D.length;B++){var A=microstrategy.findBone(D[B]);if(A&&A.onSubSectionShow){A.onSubSectionShow();}}microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");this.applyGradient();}catch(C){microstrategy.errors.log(C);return false;}};mstrFixedPanel.prototype.turnOffRulerShade=function(){try{if(this.rulerShade){this.rulerShade.style.height="0px";this.rulerShade.style.left="0px";this.rulerShade.style.top="0px";}}catch(A){microstrategy.errors.log(A);}};mstrFixedPanel.prototype.turnOnRulerShade=function(A){try{if(this.rulerShade){this.rulerShade.style.height=(A.bottom-A.top+3)+"px";this.rulerShade.style.left="0px";}}catch(B){microstrategy.errors.log(B);}};mstrFixedPanel.prototype.dragRulerShade=function(B){try{if(this.rulerShade){this.rulerShade.style.top=B+"px";}}catch(A){microstrategy.errors.log(A);}};mstrFixedPanel.prototype.insertSubSectionAbove=function(){try{var A=this.parentBone.parentBone.parentBone.updateManager;A.add([A.createActionObject(this.elem,mstrUpdateManager.ADD_SUBSECTION,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048007","2048101","2048102"],[mstrUpdateManager.UPDATE_LATER,this.parentBone.id,this.id,"before"],[])]);A.flushAndSubmitChanges();}catch(B){microstrategy.errors.log(B);}};mstrFixedPanel.prototype.resizeRuler=function(A){try{if(this.ruler){this.ruler.style.height=A+"px";}}catch(B){microstrategy.errors.log(B);}};mstrFixedPanel.prototype.insertSubSectionBelow=function(){try{var A=this.parentBone.parentBone.parentBone.updateManager;A.add([A.createActionObject(this.elem,mstrUpdateManager.ADD_SUBSECTION,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048007","2048101","2048102"],[mstrUpdateManager.UPDATE_LATER,this.parentBone.id,this.id,"after"],[])]);A.flushAndSubmitChanges();}catch(B){microstrategy.errors.log(B);}};mstrFixedPanel.prototype.deleteSubSection=function(){try{var A=this.parentBone.parentBone.parentBone.updateManager;if(this.parentBone.getSubsectionCount()>1){A.add([A.createActionObject(this.elem,mstrUpdateManager.REMOVE_SUBSECTION,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048041"],[mstrUpdateManager.UPDATE_LATER,this.id],[])]);A.flushAndSubmitChanges();}}catch(B){microstrategy.errors.log(B);}};mstrFixedPanel.prototype.adjustSubsectionWidth=function(A){try{var I=mstrFormatObject;var C=microstrategy.styleObj;var B=parseFloat(I.decodeValue("width",C.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH)));var H=B;if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){var G=C.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);if(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.IGNORE_RESIZE){var M=C.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);var D=C.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);var L=parseInt(I.decodeValue("width",C.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH)));this.isCanGrowCanShrinkHorizontal=true;if((D==microstrategy.FALSE&&M==microstrategy.FALSE)||microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE){this.isCanGrowCanShrinkHorizontal=false;}if(this.needToUpdateMaxContentHeight){this.calcMaxContentHeight();this.setNeedToUpdateMaxContentHeight(false);}if(!this.isCanGrowCanShrinkHorizontal){if(A&&H>=0){this.simpleWidthResize(H);}return true;}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&G!=microstrategy.FALSE&&!this.calcHasObjects()){H=0.001;this.simpleWidthResize(H);return true;}var K=false;for(var F=0;F<this.sibs.length;F++){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION&&G!="0"&&!this.containsDocObject(this.sibs[F])){H=0.001;this.resizeEverySubSectionWidth(H,this.sibs[F],(F==this.sibs.length),F);K=true;continue;}var J=(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION)?this.sibsWidth[F]:this.maxContentWidth;if(L<B&&L!="0"){L=B;}if(J==B){if(!A){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){return true;}else{continue;}}}else{if(D=="-1"&&J>B){if(L=="0"){H=J;}else{if(L>J){H=J;}else{H=L;}}}else{if(M=="-1"){if((microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION&&!this.containsDocObject(this.sibs[F]))||(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&!this.calcHasObjects())){H=0.001;}else{if(J<B){H=(J==-1)?0.001:J;}}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){break;}if(H>=0&&microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){this.resizeEverySubSectionWidth(H,this.sibs[F],F==this.sibs.length-1,F);K=true;}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){if(H>=0){this.simpleWidthResize(H);}}else{if(K){this.parentBone.parentBone.parentBone.resize100WMObjects(this.id);}}}else{if(H>=0){this.simpleWidthResize(H);}}}else{if(H>=0){this.simpleWidthResize(H);}}}catch(E){microstrategy.errors.log(E);}};mstrFixedPanel.prototype.resizeSubsection=function(B){try{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;this.setNeedToUpdateMaxContentHeight(true);this.adjustSubsectionHeight(false);if(this.isHorizontal){this.adjustSubsectionWidth(false);}}catch(A){microstrategy.errors.log(A);}};mstrFixedPanel.prototype.adjustSubsectionHeight=function(A){try{var K=microstrategy.getFormatObject();var E=microstrategy.styleObj;var O=Math.round(parseFloat(K.decodeValue("height",E.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT))));var B=O;var F=parseInt(E.getValue(this.elem,"height"));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){var I=E.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);if(microstrategy.bones.rwb_viewer.layoutHeightMode==0){var L,D;if(this.isHorizontal){var C=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);L=E.getAttValue(C,microstrategy.HTMLATTR_CAN_SHRINK);D=E.getAttValue(C,microstrategy.HTMLATTR_CAN_GROW);}L=L!=undefined?L:E.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK);D=D!=undefined?D:E.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW);var J=parseInt(K.decodeValue("height",microstrategy.styleObj.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT)));this.isCanGrowCanShrink=true;if((D==microstrategy.FALSE&&L==microstrategy.FALSE&&I==microstrategy.FALSE)){this.isCanGrowCanShrink=false;}if(this.needToUpdateMaxContentHeight){this.calcMaxContentHeight();this.setNeedToUpdateMaxContentHeight(false);}if(!this.isCanGrowCanShrink||A){if((A&&B>=0)||this.isHorizontal){this.simpleResize(B);}return true;}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&I!=microstrategy.FALSE&&!this.calcHasObjects()){B=0.001;this.simpleResize(B);return true;}if(!this.isCanGrowCanShrink&&I==microstrategy.FALSE){if(A&&B>=0&&B!=F){this.simpleResize(B);return true;}}var N=false;for(var H=0;H<this.sibs.length;H++){B=O;if(microstrategy.bones.rwb_viewer.layoutHeightMode==0&&I!=microstrategy.FALSE&&!this.containsDocObject(this.sibs[H])){B=0.001;this.resizeEverySubSection(B,this.sibs[H],(H==this.sibs.length-1),H,A);N=true;continue;}var M=(microstrategy.bones.rwb_viewer.layoutHeightMode==0&&this.sibsHeight)?this.sibsHeight[H]:this.maxContentHeight;if(J<O&&J!=microstrategy.FALSE){J=O;}if(M==O){if(!A){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){return true;}else{if(this.isHorizontal&&H==this.sibs.length-1){this.simpleResize(B);continue;}else{continue;}}}}else{if((D==microstrategy.TRUE||(I==microstrategy.TRUE&&this.forceGrowOnResize))&&M>O){if(J==microstrategy.FALSE){B=M;}else{if(J>M){B=M;}else{B=J;}}}else{if(L==microstrategy.TRUE){if((microstrategy.bones.rwb_viewer.layoutHeightMode==0&&!this.containsDocObject(this.sibs[H]))||(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&!this.calcHasObjects())){B=0.001;}else{if(M<O){B=(M==-1)?0.001:M;}}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){break;}if(B>=0&&microstrategy.bones.rwb_viewer.layoutHeightMode==0){if(B!=O){this.resizeEverySubSection(B,this.sibs[H],H==this.sibs.length-1,H,A);N=true;}else{if(this.isHorizontal){this.updateHorizontalContainerHeight(this.sibs[H],B);}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){if(B>=0){this.simpleResize(B);}}else{if(N){microstrategy.bones.rwb_viewer.resize100HMObjects(this.id);}}}else{if(B>=0){this.simpleResize(B);}}}else{if(B>=0){this.simpleResize(B);}}}catch(G){microstrategy.errors.log(G);}};mstrFixedPanel.prototype.getRightMostPos=function(){try{var A=0;var F=microstrategy.styleObj;if(this.elem&&this.elem.childNodes&&!this.isHorizontal){for(var B=0;B<this.elem.childNodes.length;B++){var H=this.elem.childNodes[B];if(H.nodeType==1){if(H.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var G=F.getAttValue(H,microstrategy.HTMLATTR_WIDTH_MODE);if(G==microstrategy.FIX_MODE){var D=microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE?parseInt(F.getValue(H,"width",microstrategy.FORMAT_TYPE_MAIN)):H.scrollWidth;A=Math.max(parseInt(F.getValue(H,"left",microstrategy.FORMAT_TYPE_MAIN))+D,A);}else{if(G==microstrategy.AUTO_MODE){var C=H.style.display;H.style.display="block";A=Math.max(parseInt(F.getValue(H,"left",microstrategy.FORMAT_TYPE_MAIN))+H.scrollWidth,A);H.style.display=C;}}}}}}return A;}catch(E){microstrategy.errors.log(E);return -1;}};mstrFixedPanel.prototype.checkForResize=function(C){try{var B=microstrategy.findAncestorWithAtt(C,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE);if(B){var D=null;if(this.isHorizontal){this.prevElem=B.parentNode.previousSibling.lastChild.lastChild;D=microstrategy.findChildWithAtt(B.parentNode.nextSibling,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);}else{this.prevElem=B.previousSibling.lastChild;D=microstrategy.findChildWithAtt(B.nextSibling,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);}if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondragstart");this.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondragstart(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}if(D){this.doc.selections.addSubSection(D);}}}catch(A){microstrategy.errors.log(A);return ac;}};function mstrFixedPanel(A){this.inherits=mstrSubSection;this.inherits(A);this.inherits=null;return this;}mstrSubSectionMaskImpl.prototype=new mstrMaskImpl();mstrSubSectionMaskImpl.prototype.superClass=mstrMaskImpl.prototype;mstrSubSectionMaskImpl.prototype.elem=null;mstrSubSectionMaskImpl.prototype.img=null;mstrSubSectionMaskImpl.prototype.docMask=null;mstrSubSectionMaskImpl.prototype.adjusted=false;mstrSubSectionMaskImpl.prototype.path="";mstrSubSectionMaskImpl.prototype.verifiedPath="";mstrSubSectionMaskImpl.prototype.horizontalBone=null;mstrSubSectionMaskImpl.prototype.sibIndex=null;mstrSubSectionMaskImpl.MASK_HILITE_BORDER=microstrategy.DND_HILITE_WIDTH*2;mstrSubSectionMaskImpl.prototype.onload=function(B){try{this.maskedBone=B;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.initElem();}catch(A){microstrategy.errors.log(A);return false;}};mstrSubSectionMaskImpl.prototype.onmaskedobjectresize=function(C,B){try{if(C){if(B=="height"){this.elem.style.height=Math.max(parseInt(this.elem.style.height)+C,0)+"px";if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))<parseInt(this.elem.style.height)){this.elem.setAttribute(microstrategy.HTMLATTR_HEIGHT,this.getSectionHeight(document.getElementById(this.subId))+this.topOffset);}}if(B=="width"){if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=parseInt(this.elem.style.width)+C+"px";}if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_WIDTH))<parseInt(this.elem.style.width)){this.elem.setAttribute(microstrategy.HTMLATTR_WIDTH,this.getSectionWidth(document.getElementById(this.subId))+this.leftOffset);}}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrSubSectionMaskImpl.prototype.onpanelresize=function(A,B){try{this.elem.style.height=A+"px";this.elem.style.width=B+"px";}catch(C){microstrategy.errors.log(C);}};mstrSubSectionMaskImpl.prototype.toggleMaskHilite=function(A){try{if(this.maskedBone.isHorizontal){this.elem.style.height=(A)?this.topOffset+parseInt(this.horizontalBone.elem.style.height)+"px":this.getSectionHeight(document.getElementById(this.subId))+this.topOffset+"px";if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=(A)?this.leftOffset+"px":this.getSectionWidth(document.getElementById(this.subId))+this.leftOffset+"px";}}else{this.elem.style.height=(A)?this.topOffset+"px":this.getSectionHeight(document.getElementById(this.subId))+this.topOffset+"px";}if(A){this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");if(bIsIE6){this.elem.style.cursor="not-allowed";}}else{this.img.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(true); }");this.img.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(false); }");this.elem.style.cursor="default";this.elem.setAttribute("isCollapsed","false");}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrSubSectionMaskImpl.prototype.onmaskedobjectresizeForSib=function(C,A,D){try{if(C){if(D=="height"){this.elem.style.height=C+"px";if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))<parseInt(this.elem.style.height)){this.elem.setAttribute(microstrategy.HTMLATTR_HEIGHT,this.getSectionHeight(document.getElementsByName(this.subId)[A])+this.topOffset);}}if(D=="width"){if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=C+"px";}if(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_WIDTH))<parseInt(this.elem.style.width)){this.elem.setAttribute(microstrategy.HTMLATTR_WIDTH,this.getSectionWidth(document.getElementsByName(this.subId)[A])+this.leftOffset);}}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrSubSectionMaskImpl.prototype.toggleMaskHiliteForSib=function(B,A){try{if(this.maskedBone.isHorizontal){this.elem.style.height=(B)?this.topOffset+parseInt(this.horizontalBone.elem.style.height)+"px":this.getSectionHeight(document.getElementsByName(this.subId)[A])+this.topOffset+"px";if(!this.maskedBone.isEndHorizontalSib(this.sibIndex)){this.elem.style.width=(B)?this.leftOffset+"px":this.getSectionWidth(document.getElementsByName(this.subId)[A])+this.leftOffset+"px";}}else{this.elem.style.height=(B)?this.topOffset+"px":this.getSectionHeight(document.getElementsByName(this.subId)[A])+this.topOffset+"px";}if(B){this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");if(bIsIE6){this.elem.style.cursor="not-allowed";}}else{this.img.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(true); }");this.img.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(false); }");this.elem.style.cursor="default";this.elem.setAttribute("isCollapsed","false");}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrSubSectionMaskImpl.prototype.initElem=function(){try{var B=(this.maskedBone.subsectionType==mstrSubSection.TYPE_PANEL);var D=document.createElement("div");D.setAttribute("id",this.maskedBone.id+"_mask");D.setAttribute("name",this.maskedBone.id+"_mask");D.style.position=(B)?"absolute":"relative";D.style.overflow="hidden";var A=document.createElement("img");A.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";A.style.width="100%";A.style.height="100%";A.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK);A.setAttribute("isPanel",B);if(this.maskedBone){A.setAttribute(microstrategy.HTMLATTR_MASKEDOBJECT,this.maskedBone.id);A.setAttribute(microstrategy.HTMLATTR_POINTS_TO,this.secId+"|"+this.subId+"|"+this.subIndex);D.style.height=this.getSectionHeight(this.maskedBone.elem)+"px";if(this.maskedBone.isHorizontal){if(this.getSectionWidth(this.maskedBone.elem)!=0){D.style.width=this.getSectionWidth(this.maskedBone.elem)+"px";}}}D.appendChild(A);this.img=A;this.elem=D;if(parseInt(this.elem.style.height)>0){this.img.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(true); }");this.img.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(false); }");this.elem.setAttribute("isCollapsed","false");}else{this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");this.elem.style.cursor="not-allowed";}}catch(C){microstrategy.errors.log(C);return false;}};mstrSubSectionMaskImpl.prototype.displayMask=function(show){try{var submaskDiv=document.getElementById("maskDiv");if(!submaskDiv){submaskDiv=document.createElement("div");submaskDiv.setAttribute("id","maskDiv");submaskDiv.style.position="absolute";var docMask=document.getElementById("docMask");docMask.insertBefore(submaskDiv,docMask.firstChild);}if(!show){submaskDiv.style.display="none";return false;}var isPanel=(this.maskedBone.subsectionType==mstrSubSection.TYPE_PANEL);if(isPanel){with(submaskDiv.style){border=(this.parentBone.selections.isSameSubSection())?"3px solid #ffff00":"0px solid #ffff00";display="block";visibility="visible";var panelStack=this.maskedBone.parentBone;var h=getObjHeight(panelStack.elem);if(panelStack.isTitleVisible){h-=getObjHeight(panelStack.titleBars[0]);}var w=getObjWidth(panelStack.elem);h=(h<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?h:h-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;w=(w<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?w:w-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;height=h+"px";width=w+"px";left=getObjSumLeft(this.maskedBone.elem)-parseInt(this.maskedBone.doc.left)+"px";top=getObjSumTop(this.maskedBone.elem)-parseInt(this.maskedBone.doc.top)+"px";}}else{var isFirstMask=(parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))<parseInt(this.elem.style.height));var dHeight=(isFirstMask)?parseInt(this.elem.getAttribute(microstrategy.HTMLATTR_HEIGHT))-this.topOffset:parseInt(this.elem.style.height)-this.topOffset;var subObj=document.getElementById(this.subId);var dWidth=getObjWidth(subObj);dHeight=(dHeight<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?dHeight:dHeight-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;dWidth=(dWidth<mstrSubSectionMaskImpl.MASK_HILITE_BORDER)?dWidth:dWidth-mstrSubSectionMaskImpl.MASK_HILITE_BORDER;with(submaskDiv.style){height=dHeight+"px";width=dWidth+"px";border=(this.parentBone.selections.isSameSubSection())?"3px solid #ffff00":"0px solid #ffff00";display="block";visibility="visible";}if(dHeight>0){var offset=(isFirstMask)?0:this.parentBone.mouseoffsetTop;var left=0;if(this.maskedBone.isHorizontal){left=getObjSumLeft(subObj)-getObjSumLeft(this.parentBone.elem);}moveObjTo(submaskDiv,left,getObjSumTop(this.elem)-offset-getObjSumTop(this.parentBone.elem)-parseInt(this.parentBone.docMask.style.top)+this.topOffset);}}}catch(err){microstrategy.errors.log(err);}return false;};mstrSubSectionMaskImpl.prototype.getSectionHeight=function(B){try{if(B.style.display!=null&&B.style.display.toLowerCase()=="none"){return 0;}else{return getObjHeight(B);}}catch(A){microstrategy.errors.log(A);return 0;}};mstrSubSectionMaskImpl.prototype.getSectionWidth=function(B){try{if(B.style.display!=null&&B.style.display.toLowerCase()=="none"){return 0;}else{return getObjWidth(B);}}catch(A){microstrategy.errors.log(A);return 0;}};function mstrSubSectionMaskImpl(C,B,A){this.secId=C;this.subId=B;this.subIndex=A;this.topOffset=0;this.leftOffset=0;return this;}mstrToolbarImplScript=true;mstrToolbarImpl.prototype=new mstrEditorImpl();mstrToolbarImpl.CMD_TYPE_SIMPLE=0;mstrToolbarImpl.CMD_TYPE_RADIO=1;mstrToolbarImpl.CMD_TYPE_CHECK=2;mstrToolbarImpl.CMD_TYPE_PULLDOWN=3;mstrToolbarImpl.CMD_TYPE_COMBO=4;mstrToolbarImpl.CMD_TYPE_CAPTION=5;mstrToolbarImpl.CMD_TYPE_TEXT=6;mstrToolbarImpl.PULLDOWN_DISABLED="mstrPulldowndisabled";mstrToolbarImpl.COMBODOWN_DISABLED="mstrCombodowndisabled";mstrToolbarImpl.DISABLED="mstrIcon-tb disabled";mstrToolbarImpl.PULLDOWN_ENABLED="mstrPulldown";mstrToolbarImpl.COMBODOWN_ENABLED="mstrCombodown";mstrToolbarImpl.ENABLED="mstrIcon-tb selected";mstrToolbarImpl.ICON="mstrIcon-tb";mstrToolbarImpl.RADIO_DISABLED="mstrIcon-tb disabled";mstrToolbarImpl.prototype.onload=function(){try{this.initToolbar();}catch(A){microstrategy.errors.log(A);return false;}};mstrToolbarImpl.prototype.onunload=function(C){try{mstrEditorImpl.prototype.onunload.call(this,C);var B=this.getAppliesTo();if(B&&B.observer){B.observer.unregister(this.id);}}catch(A){microstrategy.errors.log(A);}return true;};mstrToolbarImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.ondblclick=function(B){try{return false;}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.onclick=function(J){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrToolbarImpl.onclick",mstrLogImpl.CLICK_TOOLBAR);}if(!J){J=window.event;}if(this.getAppliesTo()==null){return ;}var H=getEventTarget(J);if(H==null){return ;}var D=H;if(D.getAttribute(microstrategy.HTMLATTR_CMD_ID)==null){D=findTarget(H,microstrategy.HTMLATTR_CMD_ID);}if(D==null){return ;}var K=D.className;if(K.indexOf("disabled")!=-1){return ;}var L=D.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(L==null){return ;}var A=D.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);var C=D.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);var I=this.getCmdType(D);switch(I){case mstrToolbarImpl.CMD_TYPE_RADIO:if(H.className!=mstrToolbarImpl.ENABLED){var F=H.parentNode.childNodes;for(var G=0;G<F.length;G++){if(F[G].nodeType==1){F[G].className=(F[G]==H)?mstrToolbarImpl.ENABLED:mstrToolbarImpl.ICON;}}this.exec(L,A);}break;case mstrToolbarImpl.CMD_TYPE_CHECK:var B=(H.className.indexOf("selected")>=0);if(typeof (A)=="number"||Number(A)!=NaN){A=(B)?-A:A;}H.className=(B)?mstrToolbarImpl.ICON:mstrToolbarImpl.ENABLED;this.exec(L,A);break;case mstrToolbarImpl.CMD_TYPE_PULLDOWN:this.togglePicker(true,C,H);break;case mstrToolbarImpl.CMD_TYPE_COMBO:if(H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){this.togglePicker(true,C,D);}else{this.exec(L,A);}break;default:this.exec(L,A);break;}}catch(E){microstrategy.errors.log(E);}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrToolbarImpl.onclick",mstrLogImpl.CLICK_TOOLBAR);}}return false;};mstrToolbarImpl.prototype.onselectionchange=function(A){return this.update(A);};mstrToolbarImpl.prototype.getQueryState=function(A,C){try{return A.commands.queryState(C.getAttribute(microstrategy.HTMLATTR_CMD_ID));}catch(B){microstrategy.errors.log(B);}return"";};mstrToolbarImpl.prototype.update=function(G){try{var B=this.getAppliesTo();if(B&&B.commands){for(var C in this.controls){var F=this.controls[C];var A=F.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(A){var D=B.commands.queryEnabled(A);if(D){F.className=mstrToolbarImpl.ICON;F.disabled=false;this.enable(F,this.getQueryState(B,F),B,A);}else{F.disabled=true;this.disableCtrl(F);}if(B.commands.customUpdate){B.commands.customUpdate(F);}}if(F.getAttribute(microstrategy.HTMLATTR_DYN_TITLE)!=null){F.setAttribute("title",B.commands.queryState(F.getAttribute(microstrategy.HTMLATTR_DYN_TITLE)));}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrToolbarImpl.prototype.getBeanName=function(){try{var A=this.elem.parentNode.id;if(A.indexOf("_")>0){A=A.substr(0,A.indexOf("_"));}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrToolbarImpl.prototype.onmouseover=function(C){try{var A=this.getButton(C);if(A==null){return ;}var D=A.className.toLowerCase();if(D.indexOf("disabled")>-1){return ;}if(A.className.indexOf(" highlighted")==-1){A.className+=" highlighted";}}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.onmouseout=function(C){try{var A=this.getButton(C);if(A==null){return ;}A.className=A.className.replace(" highlighted","");}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.togglePicker=function(A,D,B){try{dropDown.togglePicker(A,D,B,this);}catch(C){microstrategy.errors.log(C);}return false;};mstrToolbarImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrToolbarImpl.prototype.selectPickerElement=function(C){try{var B=C.commandId;var A=this.getAppliesTo();if(A){var D=A.commands.queryState(B);if(D!=null){var F=document.getElementById("pkr"+D);if(F){F.className=mstrToolbarImpl.ENABLED;C.selected=F;}}}}catch(E){microstrategy.errors.log(E);}};mstrToolbarImpl.prototype.exec=function(B,D){try{if(!B){return ;}var A=this.getAppliesTo();if(!A){return ;}if(!A.commands.queryEnabled(B)){return ;}A.commands.exec(B,D);return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrToolbarImpl.prototype.execPicker=function(C,G){try{var F=true;var B=C.commandId;var A=this.getAppliesTo();if(A&&B&&A.commands.queryEnabled(B)){F=A.commands.exec(B,G.getAttribute("id").slice(3));if(F){var E=this.getControlFromCmdId(B);if(this.getCmdType(E)==mstrToolbarImpl.CMD_TYPE_PULLDOWN){this.enable(E,this.getQueryState(A,E),A,B);}}}return F;}catch(D){microstrategy.errors.log(D);return false;}};mstrToolbarImpl.prototype.initToolbar=function(){try{this.initEditor();this.controls=new Object();this.currentPicker=null;if(this.elem){var D=this.appliesTo||this.elem.getAttribute("at");this.setAppliesTo(D);var J=this.elem.getAttribute("beanPath");if(J&&J.length>0){this.beanPath=J;}var K=new Function("e","return microstrategy.bone('"+this.id+"').onclick(e);");var H=new Function("e","return microstrategy.bone('"+this.id+"').ondblclick(e);");this.elem.onmouseover=new Function("e","if (typeof(microstrategy) != 'undefined' && microstrategy.bone('"+this.id+"') != null) { return microstrategy.bone('"+this.id+"').onmouseover(e); }");this.elem.onmouseout=new Function("e","if (typeof(microstrategy) != 'undefined' && microstrategy.bone('"+this.id+"') != null) { return microstrategy.bone('"+this.id+"').onmouseout(e); }");if(!this.body){return ;}function I(L){var M=getObj(L);if(typeof (M.innerText)!="undefined"){return M.innerText;}if(bIsW3C&&M.childNodes&&M.childNodes[0]&&(M.childNodes[0].nodeValue!=null)){if(M.childNodes[0].nodeValue!=M.innerHTML){microstrategy.err.log("Please forward the reproduction scenario to reproduce this error to either Mark or Yong.  Do not log a TQMS issue.");}return M.childNodes[0].nodeValue;}}var B=this.body.getElementsByTagName("div");for(var F=0;F<B.length;F++){if(B[F].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_BTN_GROUP){for(var E=0;E<B[F].childNodes.length;E++){if(B[F].childNodes[E].nodeType==1){var G=B[F].childNodes[E];var A=G.getAttribute("id");if(G.getAttribute(microstrategy.HTMLATTR_CMD_ID)&&G.getAttribute(microstrategy.HTMLATTR_CMD_TYPE)!=mstrToolbarImpl.CMD_TYPE_TEXT&&G.tagName.toLowerCase()!="label"){G.onclick=K;G.ondblclick=H;}this.controls[A]=G;if(G.firstChild&&G.firstChild.tagName=="SPAN"){this.controls[A].origName=G.firstChild.innerHTML;}else{this.controls[A].origName=I(G);}}}}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrToolbarImpl.prototype.setAppliesTo=function(B){try{if(B==null){B=microstrategy.getViewerBone();}if(typeof (B)=="string"){B=microstrategy.bone(B);}if(B){this.appliesTo=B.id;if(B.observer){B.observer.register(this.id);}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrToolbarImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo&&this.appliesTo.length>0){return microstrategy.bone(this.appliesTo);}return null;}catch(A){microstrategy.errors.log(A);return null;}};mstrToolbarImpl.prototype.getControlFromCmdId=function(A){try{for(var C in this.controls){if((this.controls[C])&&(this.controls[C].getAttribute(microstrategy.HTMLATTR_CMD_ID)==A)){return this.controls[C];break;}}return null;}catch(B){microstrategy.errors.log(B);return null;}};mstrToolbarImpl.prototype.getCmdType=function(A){try{if(A.getAttribute(microstrategy.HTMLATTR_CMD_TYPE)==null){return mstrToolbarImpl.CMD_TYPE_SIMPLE;}else{return parseInt(A.getAttribute(microstrategy.HTMLATTR_CMD_TYPE));}}catch(B){microstrategy.errors.log(B);return null;}};mstrToolbarImpl.prototype.getButton=function(C){try{if(!C){C=window.event;}var A=findTarget(getEventTarget(C),microstrategy.HTMLATTR_SUBOBJTYPE);if(A==null){return null;}if(A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){A=A.parentNode;}if(A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_BTN){return null;}return A;}catch(B){microstrategy.errors.log(B);return null;}};mstrToolbarImpl.prototype.updatePulldownDisplayValue=function(B,A,C){try{if(B.firstChild&&B.firstChild.tagName=="SPAN"){B.firstChild.innerHTML=(A.name)?A.name:A;if(C){B.firstChild.className=C;}}else{B.innerHTML=(A.name)?A.name:A;if(C){B.className=C;}}B.setAttribute("title",A);}catch(D){microstrategy.errors.log(D);return null;}};mstrToolbarImpl.prototype.addPickerOption=function(E,K,J,F,G,C){var H=null;try{if(typeof (K)!="undefined"&&E){H=document.createElement("span");H.setAttribute("name","pkr"+J);H.setAttribute("id","pkr"+J);H.displayName=K;var I=document.createElement("span");I.className="mstrIcon-tb";if(C===12){I.className+=" attr";}H.appendChild(I);H.appendChild(document.createTextNode(K));if(F){for(var A in F){var D=F[A];H.setAttribute(A,D);}}if(G){H.className=G;}E.appendChild(H);}}catch(B){microstrategy.errors.log(B);}return H;};mstrToolbarImpl.prototype.displayVisModeButton=function(B){try{var A=this.getAppliesTo();if(A){var C=A.commands.queryEnabled(B);for(var E in this.controls){if(this.controls[E]&&this.controls[E].getAttribute(microstrategy.HTMLATTR_CMD_ID)==B){if(C&&this.visAvailable(this.controls[E].getAttribute(microstrategy.HTMLATTR_CMD_VALUE))){displayObj(this.controls[E]);}else{removeObj(this.controls[E]);}}}}}catch(D){microstrategy.errors.log(D);}};mstrToolbarImpl.prototype.visAvailable=function(D){try{var A=this.getAppliesTo();if(A){var B;if(A.doc&&A.doc.selections&&A.doc.selections.getSelectedGrid()){var F=A.doc.selections.getSelectedGrid();if(F){targetGrid=microstrategy.findBone(F);if(targetGrid){B=targetGrid.visualizationList;}}}else{B=A.visualizationList;}if(B){for(var C=0;C<B.length;C++){if(B[C].vm==D){return true;}}}}}catch(E){microstrategy.errors.log(E);}return false;};mstrToolbarImpl.prototype.removePickerOption=function(A,D){try{if(A){for(var B=0;A.childNodes&&B<A.childNodes.length;B++){if(A.childNodes[B].getAttribute("id")=="pkr"+D){A.removeChild(A.childNodes[B]);}}}}catch(C){microstrategy.errors.log(C);}};mstrToolbarImpl.prototype.disablePulldownCtrl=function(C,A){try{C.className=mstrToolbarImpl.PULLDOWN_DISABLED;var D=true;if(A!=null&&A==false){D=false;}if(D){this.updatePulldownDisplayValue(C,C.origName);}}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.enablePulldownCtrl=function(C,B){try{C.className=mstrToolbarImpl.PULLDOWN_ENABLED;if(B==null){B=C.origName;}this.updatePulldownDisplayValue(C,B);}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.enableCtrl=function(B){try{B.className=mstrToolbarImpl.PULLDOWN_ENABLED;}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.populatePulldownCtrl=function(E,B){try{var A=document.getElementById(E.getAttribute(microstrategy.HTMLATTR_CMD_PICKER));if(!A){return ;}while(A.hasChildNodes()){A.removeChild(A.firstChild);}for(var C=0;C<B.length;C++){var F=B.get(C);this.addPickerOption(A,F.text,F.value,null,undefined,F.oty);}}catch(D){microstrategy.errors.log(D);}};mstrToolbarImpl.prototype.disableCtrl=function(C,A){try{switch(this.getCmdType(C)){case mstrToolbarImpl.CMD_TYPE_PULLDOWN:this.disablePulldownCtrl(C,A);break;case mstrToolbarImpl.CMD_TYPE_COMBO:C.className=mstrToolbarImpl.COMBODOWN_DISABLED;if("true"==C.childNodes[0].getAttribute("fillColorContent")){C.childNodes[0].childNodes[0].className=mstrToolbarImpl.DISABLED;}else{C.childNodes[0].className=mstrToolbarImpl.DISABLED;}break;case mstrToolbarImpl.CMD_TYPE_CAPTION:break;case mstrToolbarImpl.CMD_TYPE_RADIO:case mstrToolbarImpl.CMD_TYPE_CHECK:if(!C.className.match(mstrToolbarImpl.RADIO_DISABLED)){C.className=C.className+"  "+mstrToolbarImpl.RADIO_DISABLED;}break;default:if(C.tagName!="A"){C.className=C.className.replace(mstrToolbarImpl.DISABLED,"")+" "+mstrToolbarImpl.DISABLED;}}if(C.getAttribute("title")){C.setAttribute("dtitle",C.getAttribute("title"));C.setAttribute("title","");}}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.deselectAllCtrls=function(){try{for(var C in this.controls){var B=this.controls[C];switch(this.getCmdType(B)){case mstrToolbarImpl.CMD_TYPE_CHECK:case mstrToolbarImpl.CMD_TYPE_RADIO:if(!B.className.match(mstrToolbarImpl.DISABLED)){B.className=mstrToolbarImpl.ICON;}break;case mstrToolbarImpl.CMD_TYPE_PULLDOWN:if(microstrategy.EXECUTION_SCOPE!=microstrategy.REPORT_EXECUTION){this.disablePulldownCtrl(B);}break;}}}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.enable=function(F,E,B,A){try{switch(this.getCmdType(F)){case mstrToolbarImpl.CMD_TYPE_CHECK:F.className=(E)?mstrToolbarImpl.ENABLED:mstrToolbarImpl.ICON;return ;case mstrToolbarImpl.CMD_TYPE_SIMPLE:case mstrToolbarImpl.CMD_TYPE_RADIO:F.className=(E==parseInt(F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE)))?mstrToolbarImpl.ENABLED:mstrToolbarImpl.ICON;break;case mstrToolbarImpl.CMD_TYPE_PULLDOWN:if(B.commands.queryEnabled(A)){if(E&&E.currentOptionValue){this.enablePulldownCtrl(F,E.currentOptionValue);this.populatePulldownCtrl(F,E);}else{this.enablePulldownCtrl(F,E);}}else{this.disablePulldownCtrl(F);}break;case mstrToolbarImpl.CMD_TYPE_COMBO:var C=B.commands.queryEnabled(A);F.className=C?mstrToolbarImpl.COMBODOWN_ENABLED:mstrToolbarImpl.COMBODOWN_DISABLED;if("true"==F.childNodes[0].getAttribute("fillColorContent")){F.childNodes[0].childNodes[0].className=C?mstrToolbarImpl.ICON:mstrToolbarImpl.DISABLED;}else{F.childNodes[0].className=C?mstrToolbarImpl.ICON:mstrToolbarImpl.DISABLED;}break;}if(F.getAttribute("dtitle")){F.setAttribute("title",F.getAttribute("dtitle"));F.setAttribute("dtitle","");}}catch(D){microstrategy.errors.log(D);}};mstrToolbarImpl.prototype.disableToolbar=function(){try{for(var C in this.controls){var B=this.controls[C];this.disableCtrl(B);}}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.adjustVisualization=function(B,D,I){try{if(B){if(D){var H=document.getElementById(B.getAttribute(microstrategy.HTMLATTR_CMD_PICKER));if(H){if(D.visualizationList&&D.visualizationList.length>1&&D.isVisualization){while(H.hasChildNodes()){H.removeChild(H.firstChild);}for(var F=0;F<D.visualizationList.length;F++){var A=D.visualizationList[F].name;var J=D.visualizationList[F].desc;var C=D.visualizationList[F].vm;if(D.filterVisPulldown&&C!=D.visualizationMode){continue;}var G=document.createElement("span");G.setAttribute("id",A+"|"+C);G.setAttribute("name",A);G.setAttribute("value",A);G.innerHTML=J;if(A==D.selectedVisualization){I.updatePulldownDisplayValue(B,J);B.setAttribute("value",D.selectedVisualization);}H.appendChild(G);}displayObj(B);}else{removeObj(B);return ;}}}else{removeObj(B);return ;}}}catch(E){microstrategy.errors.log(E);}};function mstrToolbarImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);delete this.inherits;return this;}mstrPulldownOptions.prototype=new Object();mstrPulldownOptions.prototype.length=0;mstrPulldownOptions.prototype.currentOptionValue="";mstrPulldownOptions.prototype.options=null;mstrPulldownOptions.prototype.add=function(C,D,A,B){this.options[this.length++]={value:C,text:D,oty:B};if(A){this.currentOptionValue=D;}};mstrPulldownOptions.prototype.get=function(A){if(A in this.options){return this.options[A];}return{value:"null",text:"Index "+A+" not found."};};mstrPulldownOptions.prototype.setSelectedOption=function(B){for(var A=0;A<this.length;A++){var C=this.get(A);if(C.value==B){this.currentOptionValue=C.text;break;}}};function mstrPulldownOptions(){this.options=new Object();return this;}mstrStaticDoc.prototype=new mstrBoneImpl();mstrStaticDoc.prototype.type=microstrategy.OBJTYPE_DOC;mstrStaticDoc.prototype.sections={};mstrStaticDoc.prototype.horizontalContainers={};mstrStaticDoc.prototype.commands=new mstrDocCommandsImpl();mstrStaticDoc.prototype.styleObj=null;mstrStaticDoc.prototype.left=null;mstrStaticDoc.prototype.top=null;mstrStaticDoc.prototype.MAX_WIDTH=56;mstrStaticDoc.prototype.path="";mstrStaticDoc.prototype.verifiedPath="";mstrStaticDoc.prototype.items=null;mstrStaticDoc.prototype.formattingAttributes=null;mstrStaticDoc.prototype.isVisualization=false;mstrStaticDoc.prototype.containsHorizontalSections=false;mstrStaticDoc.prototype.prevSelectedId=null;mstrStaticDoc.prototype.docPropsMap={PageWidth:{l:"paperWidth"},PageHeight:{l:"paperHeight"},PaperOrientation:{f:"Orientation"},MarginLeft:{l:"marginLeft"},MarginTop:{l:"marginTop"},MarginRight:{l:"marginRight"},MarginBottom:{l:"marginBottom"},LayoutFillColor:{f:"backgroundColor"},tabMPHF:{f:"TabMPHF",l:"currentLayoutMPHF"},TabName:{f:"windowTitle",l:"currentLayoutName"},CtlAutoSubmit:{l:"ctlAutoSubmit"},Autowire:{l:"autoWire"},EnableToc:{f:"Enabled"},TOCTitle:{f:"Title"},TabLeader:{f:"ShowTabLeader"},WatermarkText:{f:"Text"},incrFetchEnabled:{l:"enabled"},incrFetchBlockCount:{l:"blockCount"},incrFetchCurLevel:{l:"curLevel"},incrFetchLevels:{l:"levels"},DefaultSelectorsAsFilter:{f:"SelectorBehavior"},PreserveTranslations:{f:"PreserveTranslations"}};mstrStaticDoc.prototype.onload=function(B){try{this.initDoc();window.setTimeout(function(){mstrMsgBoxImpl.hideMessage(null,"controlTargetsRecorder");},100);if(typeof (mstr)!="undefined"){this.initNotesIcon();mstr.controllers.Factory.add(microstrategy.updateManager);}if(this.parentBone.isEditableViewModeEplus()&&this.parentBone.prevControl){this.commands.exec("currentControl",this.parentBone.prevControl);if(this.parentBone.prevControlLocked=="1"){this.parentBone.insertionControlLocked=true;}}if(mstrApp!==undefined){if(!this.parentBone.isEditableViewModeEplus()){mstrLocalStorage.addScreenshot(mstrApp.getLastMsgRecoveryInfo(),"mstrWebContents");}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.processDocPropertyChanges=function(A){try{var D=new Array();var B=this.parentBone.updateManager;var E=this.processStaticDocPropertyChanges(A,D);if(D.length>0){B.add(D,true);if(E){B.flushAndSubmitChanges();}}}catch(C){microstrategy.errors.log(C);}};mstrStaticDoc.prototype.processStaticDocPropertyChanges=function(C,T){try{var K=false,A=this.parentBone;um=A.updateManager,scheduleProcessed=false,usersProcessed=false;for(var R=0,Q=C.length;R<Q;R++){var E=C[R].cmdId;var O=C[R].value;var F=(this.docPropsMap[E]&&this.docPropsMap[E].f)||E;var G=(this.docPropsMap[E]&&this.docPropsMap[E].l)||E;switch(E){case"PaperOrientation":case"PaperType":case"Scaling":case"ScalePercentage":case"SectionHorizontalOverflow":case"ExportRange":case"ExcelGraphFormat":this.saveDocProperty(F,O,T);this.parentBone[G]=O;break;case"ScalePagesWide":case"ScalePagesTall":O=(trim(O)==""?0:O);this.saveDocProperty(F,O,T);this.parentBone[G]=O;break;case"ScalePageHeaderFooter":case"UseOneSheetPerLayout":case"UseOneSheetPerGroupElement":case"PromptUserForPagebyExport":case"IncludeBookmarks":case"ShowBookmarks":case"EmbedFonts":case"ExcelEmbedImages":case"enableGraphTooltips":case"EnableZoom":case"EnableCopyForText":case"EnableCopyForGridCell":this.saveDocProperty(F,(O)?microstrategy.TRUE:microstrategy.FALSE,T);this.parentBone[G]=O;break;case"RefreshDocument":this.parentBone.RefreshDocument=O;if(O==false){var J=-1;this.saveDocProperty("RefreshFrequency",J,T);this.parentBone.RefreshFrequency=J;}break;case"RefreshFrequency":var I=this.commands.queryState("RefreshDocument");O=I?O:-1;this.saveDocProperty(E,O,T);this.parentBone[E]=O;break;case"PageWidth":case"PageHeight":case"MarginLeft":case"MarginTop":case"MarginRight":case"MarginBottom":var J=microstrategy.number.toUSUnits(O);this.saveDocProperty(F,J,T);this.parentBone[G]=J;break;case"GraphFormat":this.saveDocProperty(F,(O)?"10":"11",T);this.parentBone[G]=O;break;case"GraphQualityDPI":this.saveDocProperty(F,(O)?"96":"288",T);this.parentBone[G]=O;break;case"DefaultPageByExportMode":this.saveDocProperty(F,(O)?"0":"1",T);this.parentBone[G]=O;break;case"scheduleType":case"selectedSchedules":A[G]=O;scheduleProcessed=true;break;case"userType":case"selectedUsers":A[G]=O;usersProcessed=true;break;case"MakePrivate":T.push(um.createActionObject(null,mstrUpdateManager.SET_VIEW_MEDIA,this.parentBone.beanPath,[(O)?"2048290":"2048291"],[mstr.Enum.VIEWMEDIA.PRIVATE],[]));K=true;break;}switch(E){case"PaperOrientation":case"PageWidth":case"MarginLeft":case"MarginRight":this.updatePageWidth();this.displayPageBreaker();break;case"PromptUserForPagebyExport":K=true;}}var N=A.scheduleType,P=A.selectedSchedules;if(scheduleProcessed&&(N!=A.scheduleTypeWas||P!=A.selectedSchedulesWas)){T.push(um.createActionObject(null,mstrUpdateManager.SAVE_RW_ASSOCIATED_SCHEDULES,this.parentBone.beanPath,["2048254","2048255"],[N,P]));}var M=parseInt(A.userType,10),H=A.selectedUsers;if(usersProcessed&&(M!=A.userTypeWas||H!=A.selectedUsersWas)){var B={0:1,1:0,2:1}[M];var J=[];if(M===2){for(var R=0,S=H.length;R<S;R++){var V=H[R],U=A.userSubscribeRights[V.rgt];J.push(V.did+ITEM_SEPARATOR+U+ITEM_SEPARATOR+V.n);}}var L=J.join(CLIPBOARD_ITEM_SEPARATOR);T.push(um.createActionObject(null,mstrUpdateManager.SAVE_RW_ASSOCIATED_USERS,this.parentBone.beanPath,["2048277","2048276"],[B,L]));}return K;}catch(D){microstrategy.errors.log(D);}return false;};mstrStaticDoc.prototype.saveDocProperty=function(A,H,J,D){try{var F=this.parentBone.updateManager;var E=mstrFormatObject;var C;switch(A){case"width":case"windowTitle":var I=D||this.parentBone.currentLayout||this.parentBone.rootNodeKey;if(!I){break;}C=mstrUpdateManager.createPropertyEditString(I,A,H);J.push(F.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,C],[]));break;case"PaperType":case"PageWidth":case"PageHeight":case"Orientation":case"Scaling":case"ScalePercentage":case"ScalePagesWide":case"ScalePagesTall":case"ScalePageHeaderFooter":case"SectionHorizontalOverflow":case"MarginLeft":case"MarginRight":case"MarginTop":case"MarginBottom":case"UsePageWidthAsLayoutWidth":if(this.parentBone.currentLayout){C=mstrUpdateManager.createPropertyEditString(this.parentBone.currentLayout,A,H);J.push(F.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,C],[]));}else{C=mstrUpdateManager.createPropertyEditString(null,A,H);J.push(F.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,C],[]));}break;default:var G;if(A==="CtlAutoSubmit"){G="RWDocumentProperties";}C=mstrUpdateManager.createPropertyEditString(null,A,H,false,G);J.push(F.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,C],[]));}}catch(B){microstrategy.errors.log(B);}};mstrStaticDoc.prototype.updatePageWidth=function(){try{if(this.parentBone.usePageWidthAsLayoutWidth==-1){var B=this.getPageWidth();B=((this.minWidth>parseInt(B))?this.minWidth:B)+"px";this.styleObj.setValue(this.elem,"width",B);this.parentBone.syncDocRszHandler();this.updateHRulerWidth();}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.getPageWidth=function(){try{var E=microstrategy.getFormatObject();var F=parseInt(E.decodeValue("width",this.parentBone.paperWidth));var C=parseInt(E.decodeValue("left",this.parentBone.marginLeft));var A=parseInt(E.decodeValue("left",this.parentBone.marginRight));var D=parseInt(E.decodeValue("left",this.parentBone.leftBorderWidth));var G=parseInt(E.decodeValue("left",this.parentBone.rightBorderWidth));return(F-C-A-D-G);}catch(B){microstrategy.errors.log(B);return null;}};mstrStaticDoc.prototype.displayPageBreaker=function(){};mstrStaticDoc.prototype.initNotesIcon=function(){try{var B=mstr.$obj("NotesIconModel_model");if(B&&!this.parentBone.needSaveBeforeNotes){B.set("objectID",this.parentBone.objectID);B.set("objectType",this.parentBone.objectType);}if(this.parentBone.needSaveBeforeNotes||(microstrategy.bone("accordion_AccordionTabManagerStyle")&&microstrategy.bone("accordion_AccordionTabManagerStyle").currentTabName==microstrategy.ACCORDION_RW_NOTES_PANEL)){var A=mstr.$obj("NotesIconView_view");if(A){A.set("visible",false);}}else{if(B){B.execCheck();}}}catch(C){microstrategy.errors.log(C);}};mstrStaticDoc.prototype.onpostload=function(B){try{mstrBoneImpl.prototype.onpostload.call(this);if(this.parentBone.isInteractiveViewModeEplus()||this.parentBone.layoutHeightMode!=1||this.parentBone.layoutWidthMode==0){this.synchHeightOfHorizontalSections();}this.syncPosition();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.onwinresize=function(B,A){try{this.syncPosition(B,A);window.setTimeout(function(){iframe.hideWaitPage(true);},mstr.utils.ISIE8?100:0);}catch(C){microstrategy.errors.log(C);}};mstrStaticDoc.prototype.shouldIgnoreKeyEvent=function(C){try{if(!C){C=window.event;}if(currentModalEditor!=null&&currentModalEditor.length>0||mstr.controllers.ModalEditors.size()>0){return true;}if(microstrategy.isContextMenuOpen()){return true;}var D=getEventTarget(C);if(D.tagName){var A=D.tagName.toLowerCase();if(A=="input"||A=="select"||A=="textarea"){return true;}}return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrStaticDoc.prototype.onkeydown=function(B){try{if(!B){B=window.event;}if(this.shouldIgnoreKeyEvent(B)){return true;}switch(B.keyCode){case 8:if(bIsIE4){B.cancelBubble=true;}return false;break;case 123:if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){toggleScreenMode();return false;}break;case 119:if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.parentBone.isFeatureAvailable(microstrategy.FEATURE_DATASET_OBJECTS_LIST)){this.commands.exec("toggleAccordion");return false;}break;}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.onkeypress=function(A){return true;};mstrStaticDoc.prototype.ondocumentclick=function(A){return true;};mstrStaticDoc.prototype.initDoc=function(){try{this.initBone();this.syncPosition();this.commands.parentBone=this;this.formattingAttributes=this.parentBone.formattingAttributes;microstrategy.styleObj=new mstrDocStyleImpl(this.formattingAttributes);microstrategy.styleObj.onload();this.styleObj=microstrategy.styleObj;this.path="microstrategy.bone('"+this.parentBone.id+"').doc";this.verifiedPath=microstrategy.getEventHandlerString(this.path);if(this.parentBone.isInteractiveViewModeEplus()||this.parentBone.layoutHeightMode!=1||this.parentBone.layoutWidthMode==0){this.initHorizontalContainers();this.initSections();var D=this;window.setTimeout(function(){D.synchHeightOfHorizontalSections();},0);}this.initRoundedRectangles();this.initButtons();for(var A=0;A<currentModalEditor.length;A++){var B=document.getElementById(currentModalEditor[A]);if(B!=null&&B.getAttribute(mstrHTMLAttributes.ATTR_HIDDEN)=="true"){currentModalEditor.length=A;break;}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrStaticDoc.prototype.adjustWidth=function(){try{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.parentBone.layoutWidthMode==0){var A=this.elem.style.width;if(bIsW3C||bIsIE7){this.elem.style.width="100000px";}this.minWidth=this.getRightMostPos();var D=(this.minWidth>parseInt(A))?this.minWidth+"px":A;if(this.elem.style.width!=D){this.elem.style.width=D;}if(mstr.utils.ISIE6){var C=microstrategy.findChildWithAtt(this.parentBone.elem,"table","className","rulerTable");if(C){C.style.width=D;}}}else{if(this.parentBone.currentRWViewMode==microstrategy.RW_VIEW_MODE_EDITABLE){this.minWidth=0;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrStaticDoc.prototype.onpanelchange=function(){return true;};mstrStaticDoc.prototype.syncPosition=function(B,A){try{this.left=A||getObjSumLeft(this.elem);this.top=B||getObjSumTop(this.elem);for(var D in this.sections){if(this.sections[D].syncPosition){this.sections[D].syncPosition();}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrStaticDoc.prototype.initSections=function(){try{this.sections={};this.subSectionsInSection={};var B=this.parentBone.sectionSubsections;if(B!=null){var A=B.split(";");for(var C=0;C<A.length;C++){var F=A[C].substring(0,A[C].indexOf("?"));this.subSectionsInSection[F]=A[C].substring(A[C].indexOf("?")+1);if(typeof (this.sections[F])=="undefined"){var E=new mstrDocSectionImpl(F);E.parentBone=this;E.path=this.path+".sections['"+F+"']";this.sections[F]=E;if(E.onload){E.onload();}}}}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrStaticDoc.prototype.initRoundedRectangles=function(){try{this.roundedRectangles={};var A=this.parentBone.roundedRectangles;if(A!=null&&A.length>0){var C=A.split(";");for(var B=0;B<C.length-1;B++){this.initRoundedRectangle(C[B]);}}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrStaticDoc.prototype.initRoundedRectangle=function(C){try{microstrategy.registerBone(C,"mstrRoundedRectangleScript",null);function B(D){if(microstrategy.bone(D)!=null){microstrategy.bone(D).onload();}else{window.setTimeout(function(){B(D);},250);}}B(C);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.initButtons=function(){try{var B=this.parentBone.buttons;if(B!=null&&B.length>0){var D=B.split(";");for(var A=0;A<D.length-1;A++){this.initButton(D[A]);}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrStaticDoc.prototype.initButton=function(C){try{microstrategy.registerBone(C,"mstrButtonScript",null);function B(){if(microstrategy.bone(C)!=null){microstrategy.bone(C).onload();}else{window.setTimeout(B,250);}}B();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.initHorizontalContainers=function(){try{if(!this.containsHorizontalSections){return ;}this.horizontalContainers={};var A=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(A){for(var B=0;B<A.length;B++){var E=A[B].getAttribute("id");if(typeof (this.horizontalContainers[E])=="undefined"){var D=new mstrHorizontalContainerImpl(E);D.parentBone=this;D.path=this.path+".horizontalContainers['"+E+"']";if(D.onload){D.onload();}this.horizontalContainers[E]=D;}}}}catch(C){microstrategy.errors.log(C);}};mstrStaticDoc.prototype.synchHeightOfHorizontalSections=function(A){try{if(!this.containsHorizontalSections){return ;}if(A){for(var E=0;E<A.sibs.length;E++){var D=microstrategy.findAncestorWithAtt(A.sibs[E],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(D){var C=microstrategy.findBone(D);C.propogateHeightToChildren();}}}else{for(var G in this.horizontalContainers){this.horizontalContainers[G].propogateHeightToChildren();var B=microstrategy.styleObj.getValue(this.horizontalContainers[G].elem,"height");if(B==-1||B==""){this.parentBone.totalHeight+=parseInt(microstrategy.styleObj.getValue(this.horizontalContainers[G].subSections[0],"height"));}else{this.parentBone.totalHeight+=parseInt(microstrategy.styleObj.getValue(this.horizontalContainers[G].elem,"height"));}}}microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}catch(F){microstrategy.errors.log(F);}};mstrStaticDoc.prototype.adjustHeightOfHorizontalSubSections=function(A,E){try{if(!this.containsHorizontalSections){return ;}if(A){var C=microstrategy.findAncestorWithAtt(A.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(C){var B=microstrategy.findBone(C);B.adjustSubsectionHeight(E);}}}catch(D){microstrategy.errors.log(D);}};mstrStaticDoc.prototype.resetHeightOfHorizontalSections=function(A){try{if(A){for(var D=0;D<A.sibs.length;D++){var C=microstrategy.findAncestorWithAtt(A.sibs[D],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(C){var B=microstrategy.findBone(C);B.resetHeight();}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrStaticDoc.prototype.onSubSectionResize=function(){return true;};mstrStaticDoc.prototype.getGradientColor=function(B,D,G){try{var H;if(D==microstrategy.FORMAT_TYPE_MAIN){if(B.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){H=microstrategy.findBone(B);if(!H.isTable){if(G==true){if(H.panels){var F=H.panels[0].elem.getAttribute("gradientcolor");for(var C=1;C<H.panels.length;C++){var E=H.panels[C].elem.getAttribute("gradientcolor");if(E!=F){return null;}}return F;}}else{var I=H.getCurrentPanel().elem;return I.getAttribute("gradientcolor");}}}else{return B.getAttribute("gradientcolor");}}else{H=microstrategy.findBone(B);if(H&&H.getFormatValue){return H.getFormatValue(D,"gradientcolor");}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.processSubsectionBone=function(A){try{if(A){if(A.subsectionType!=mstrSubSection.TYPE_PANEL){A.setNeedToUpdateMaxContentHeight(true);if(A.isHorizontal){this.resetHeightOfHorizontalSections(A);this.adjustHeightOfHorizontalSubSections(A);this.synchHeightOfHorizontalSections(A);}else{A.adjustSubsectionHeight();}}}}catch(B){microstrategy.errors.log(B);}};mstrStaticDoc.prototype.removePaddingAndBorder=function(C,D,A){try{D=String(D);if(D=="100%"||D=="auto"){return D;}return Math.max(Math.round(parseFloat(D)-microstrategy.getPaddingAndBorderPixels(C,A)),0);}catch(B){microstrategy.errors.log(B);return D;}};mstrStaticDoc.prototype.checkAppliesTo=function(B,C){try{return microstrategy.isEnabledForItem(B,C);}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.hasMoved=function(){try{return(getObjSumLeft(this.elem)!=this.left||getObjSumTop(this.elem)!=this.top);}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDoc.prototype.getRightMostPos=function(){try{var A=0;for(var C in this.sections){A=Math.max(this.sections[C].getRightMostPos(),A);}for(var B in this.horizontalContainers){A=Math.max(this.horizontalContainers[B].getRightMostPos(),A);}return A;}catch(D){microstrategy.errors.log(D);return false;}};mstrStaticDoc.prototype.getChildBone=function(D){try{var B=D.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(B){case microstrategy.OBJTYPE_DOC_SUBSECTION:var A=microstrategy.findAncestorWithAtt(D,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION).getAttribute("id");if(A in this.sections&&this.sections[A].isLoaded){return this.sections[A].getChildBone(D);}break;case microstrategy.OBJTYPE_DOC_SECTION:if(D.getAttribute("id") in this.sections&&this.sections[D.getAttribute("id")].isLoaded){return this.sections[D.getAttribute("id")];}break;case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:if(D.getAttribute("id") in this.horizontalContainers&&this.horizontalContainers[D.getAttribute("id")].isLoaded){return this.horizontalContainers[D.getAttribute("id")];}break;}return null;}catch(C){microstrategy.errors.log(C);return false;}};mstrStaticDoc.prototype.getMaxZIndex=function(F){try{var C=0;if(this.sections){for(var G in this.sections){var A=this.sections[G].subsections;if(A){for(var B in A){var E=A[B];if(E.maxZindex){C=(E.maxZindex>C)?E.maxZindex:C;}}}}}return C;}catch(D){microstrategy.errors.log(D);return 0;}};mstrStaticDoc.prototype.showGradient=function(){return false;};mstrStaticDoc.getBone=function(D){try{var B=null;var E=D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);switch(E){case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:B=microstrategy.bone(D.id+"_Ctl");break;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:B=microstrategy.bone(D.id);break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:if(D.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){B=microstrategy.bone(D.id);}break;case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:var A=microstrategy.subObjectFind(D,"div",microstrategy.SUBOBJTYPE_GRID_TABLE);if(!A){A=microstrategy.findChildWithAtt(D,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrGridRW");}if(!A){A=microstrategy.findChildWithAtt(D,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrReportGraphImpl");}if(A){B=microstrategy.bone(A.id);}break;}return B;}catch(C){microstrategy.errors.log(C);return null;}};mstrStaticDoc.prototype.resizeSubMaskForSib=function(C,B,D,A,E){return false;};mstrStaticDoc.prototype.hideSubMaskForSib=function(C,B,D,A){return false;};mstrStaticDoc.prototype.setVisualizationSettings=function(H,L,J,C,M,F,K,G){try{var A=mstrUpdateManager.SET_DOC_VISUALIZATION_PROPERTIES;this.parentBone.updateManager.useIframe=!!G;var E=new Array();var I=new Array();if(H){E[E.length]="2048112";I[I.length]=H;}if(L!=null){E[E.length]="2048110";I[I.length]=L;var B=this.parentBone.getAllVisList()[L];if(B){E[E.length]="2048177";I[I.length]=(typeof (B.ip)!="undefined")?B.ip:"0";E[E.length]="2048211";I[I.length]=(typeof (B.im)!="undefined")?B.im:"";}}if(J!=null){E[E.length]="2048111";I[I.length]=J;}if(C){E[E.length]="2048109";I[I.length]=C;}if(F!=null){E[E.length]="2048213";I[I.length]=F;}if(K){E[E.length]="2048212";I[I.length]=K;}microstrategy.updateVisProps(H,L,J,C,this.parentBone);if(M){M.push(this.parentBone.updateManager.createActionObject(this.elem,A,this.parentBone.beanPath,E,I,[]));M.push(this.parentBone.updateManager.createActionObject(this.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[]));if(this.parentBone.observer){this.parentBone.observer.notifyAll("onvischange");}}else{this.parentBone.updateManager.add([this.parentBone.updateManager.createActionObject(this.elem,A,this.parentBone.beanPath,E,I,[])]);this.parentBone.updateManager.add([this.parentBone.updateManager.createActionObject(this.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[])]);this.parentBone.updateManager.flushAndSubmitChanges();}return true;}catch(D){microstrategy.errors.log(D);return false;}};function mstrStaticDoc(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrDocStyleImpl.prototype={};mstrDocStyleImpl.prototype.objSheet=null;mstrDocStyleImpl.prototype.styleDefaults={zIndex:0};mstrDocStyleImpl.prototype.formattingAttributes=null;mstrDocStyleImpl.HTMLATTR_CLASS_ID="rl";mstrDocStyleImpl.prototype.onload=function(C){try{for(var A=document.styleSheets.length-1;A>=0;A--){var D=document.styleSheets[A];if(D.title=="docObjectRules"||(D.ownerNode&&D.ownerNode.id=="docObjectStyle")||D.id=="docObjectStyle"){this.objSheet=document.styleSheets[A];this.objSheet.styleRules=(this.objSheet.rules)?this.objSheet.rules:this.objSheet.cssRules;break;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocStyleImpl.prototype.reloadFormattingAttributes=function(A){this.formattingAttributes=A;this.onload();};mstrDocStyleImpl.prototype.getValue=function(H,B,G){try{var O;B=this.swapForRotation(H,B);if(!G){G=microstrategy.formatType;}if(G&&G!=microstrategy.FORMAT_TYPE_MAIN){O=mstrStaticDoc.getBone(H);if(O&&O.getFormatValue){return O.getFormatValue(G,B);}}var I=H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);B=this.resolveStyles(H,B);if(B=="backgroundColor"){if(I==microstrategy.SUBOBJTYPE_DOC_SHAPE){if(H.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){O=microstrategy.bone(H.id);if(O&&O.backgroundColor!=null){return O.backgroundColor;}}}else{if(I==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){O=microstrategy.findBone(H);H=O.getCurrentPanel().elem;}}}if(B=="textDecoration"&&this.doTextDecOnBone(H)){O=microstrategy.findBone(H);return O.textDecoration;}var M=H.style[B];if((!M)||M.length==0||(B in this.styleDefaults&&M==this.styleDefaults[B])){var C=this.getId(H);if(!isNaN(C)){M=this.objSheet.styleRules[C].style[B];}}if(M=="medium"&&B.indexOf("border")>-1&&B.indexOf("Width")>-1){M="0pt";}if((B.toLowerCase()).indexOf("color")>-1&&M){M=mstr.utils.Color.rgbStr2hex(M);}if(typeof (M)=="undefined"){var E=microstrategy.getFormatObject();var L=E.isTargetStyleOrAttr(B);if(L&mstrFormatObject.TARGET_VALUE_ATTR){var J=E.getAttrNameFromStyle(B);M=this.getAttValue(H,J);}}if(!bIsDXIE&&(B==="left"||B==="top")){var N=H.direction||"0",D=Math.round(microstrategy.getPaddingAndBorderPixels(H,"height")),P=Math.round(microstrategy.getPaddingAndBorderPixels(H,"width")),K=parseInt(this.getValue(H,"width"),0)+P,A=parseInt(this.getValue(H,"height"),0)+D;if(B==="top"&&N==="90"){M=parseInt(M,0)-A+"px";}else{if(B==="left"&&N==="-90"){M=parseInt(M,0)-K+"px";}}}return M;}catch(F){microstrategy.errors.log(F);return false;}};mstrDocStyleImpl.prototype.isRotated=function(F){try{var B=false,A=this.formattingAttributes;if(!A){return B;}var E=A.tdUnits,C=E&&E[F.id];if(C){B=parseInt(E[F.id],10);}return B;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocStyleImpl.prototype.swapForRotation=function(D,E,A){try{if(E.indexOf("width")<0&&E.indexOf("height")<0&&E.indexOf("padding")<0&&E.indexOf("border")){return E;}var B=D.direction||this.getValue(D,"TextDirection")||"0";if(B!=="0"){switch(E){case"height":return"width";case"width":return"height";}}if((!A&&B==="90")||(A&&B==="-90")){if(E.indexOf("Left")>=0){return E.replace("Left","Top");}else{if(E.indexOf("Right")>=0){return E.replace("Right","Bottom");}else{if(E.indexOf("Top")>=0){return E.replace("Top","Right");}else{if(E.indexOf("Bottom")>=0){return E.replace("Bottom","Left");}}}}}else{if((!A&&B==="-90")||(A&&B==="90")){if(E.indexOf("Left")>=0){return E.replace("Left","Bottom");}else{if(E.indexOf("Right")>=0){return E.replace("Right","Top");}else{if(E.indexOf("Top")>=0){return E.replace("Top","Left");}else{if(E.indexOf("Bottom")>=0){return E.replace("Bottom","Right");}}}}}}return E;}catch(C){microstrategy.errors.log(C);return E;}};mstrDocStyleImpl.prototype.setValue=function(B,F,E,D){try{D=D||microstrategy.formatType;if(D!=microstrategy.FORMAT_TYPE_MAIN){var C=mstrStaticDoc.getBone(B);if(C&&C.setFormatValue){C.setFormatValue(D,F,E);return ;}}this.formatElem(B,F,E);}catch(A){microstrategy.errors.log(A);}};mstrDocStyleImpl.prototype.doTextDecOnBone=function(D){try{var B=false;if(D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){var A=microstrategy.bone(D.getAttribute("id")+"_Ctl");if(A){B=(A.ctlStyle==mstrRWControlImpl.CTL_STYLE_LIST_BOX);}}return B;}catch(C){microstrategy.errors.log(C);}};mstrDocStyleImpl.prototype.formatElem=function(E,B,O){try{if(O!=null&&String(O).length>0){var K=B;B=this.resolveStyles(E,B);if(B){if(B=="backgroundColor"){if(bIsDXIE){var L=this.getFilter(E,"Gradient");if(L!=null){L.enabled=false;}}else{if(E.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&E.getAttribute("scriptclass")!="mstrPanel"){var P=E.previousSibling;if(P&&P.id==(E.id+gradientUtil.GRADIENT_POSTFIX)){P.style.background="transparent";}}else{E.style.background="transparent";}}}var D=microstrategy.getFormatObject();var M=D.isTargetStyleOrAttr(B);if(M&mstrFormatObject.TARGET_VALUE_STYLE){switch(B){case"dropShadowDepth":case"dropShadowEffect":E.style[B]=O;this.applyShadow(E,B,O);break;case"alphaOpacity":case"alphaEffect":this.applyAlpha(E,B,O);E.style[B]=O;break;case"textDecoration":var I=E.style[B].indexOf("underline")>=0;var N=E.style[B].indexOf("line-through")>=0;if(this.doTextDecOnBone(E)){var F=microstrategy.findBone(E);I=F[B]&&F[B].indexOf("underline")>=0;N=F[B]&&F[B].indexOf("line-through")>=0;}var C="";if(K=="textDecoration"){I=O.indexOf("underline")>=0;}else{N=O.indexOf("line-through")>=0;}C="none";if(I){C="underline";}if(N){if(I){C+=" line-through";}else{C="line-through";}}if(this.doTextDecOnBone(E)){E.style[B]="none";F[B]=C;}else{E.style[B]=C;}var A=E.getElementsByTagName("a");if(A){for(var H=0;H<A.length;H++){A[H].style[B]=C;}}break;case"TextDirection":E.style[B]=O;this.applyTextDirection(E,B,O);break;case"color":E.style[B]=O;var A=E.getElementsByTagName("a");if(A){for(var H=0;H<A.length;H++){A[H].style[B]=O;}}break;case"paddingTop":case"paddingBottom":case"paddingRight":case"paddingLeft":this.applyPadding(E,B,O);break;default:E.style[B]=O;}if(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.cascadeSelectorValue(E,K,O);}}if(M&mstrFormatObject.TARGET_VALUE_ATTR){var J=D.getAttrNameFromStyle(B);this.setAttValue(E,J,D.encodeValue(B,O));}}}return false;}catch(G){microstrategy.errors.log(G);return false;}};mstrDocStyleImpl.prototype.applyTextDirection=function(K,C,N){if(bIsDXIE){var Q;if(N=="0"){Q=0;}else{if(N=="90"){Q=3;}else{if(N=="-90"){Q=1;}}}var E=this.getFilter(K,"BasicImage");var L=E?E.rotation:0;var G=Math.abs(L-Q)%2==1;var M=this.getValue(K,this.swapForRotation(K,"height",true));var P=this.getValue(K,this.swapForRotation(K,"width",true));var I=this.getValue(K,this.swapForRotation(K,"paddingTop",true));var B=this.getValue(K,this.swapForRotation(K,"paddingRight",true));var A=this.getValue(K,this.swapForRotation(K,"paddingBottom",true));var H=this.getValue(K,this.swapForRotation(K,"paddingLeft",true));if(G){K.style.height=P;K.style.width=M;}if(G&&(Q==1||L==3)){K.style.paddingTop=B;K.style.paddingRight=A;K.style.paddingBottom=H;K.style.paddingLeft=I;}else{if(G&&(Q==3||L==1)){K.style.paddingTop=H;K.style.paddingLeft=A;K.style.paddingBottom=B;K.style.paddingRight=I;}else{if(!G&&(Q==1||Q==3)){K.style.paddingTop=A;K.style.paddingBottom=I;K.style.paddingLeft=B;K.style.paddingRight=H;}}}if(E){E.rotation=Q;}else{if(Q==0){return ;}var F=K.style.filter;var D=false;if(F==null||F.length==0){F=this.getFilter(K);if(F!=null&&F.length>0){D=true;}}var J=" progid:DXImageTransform.Microsoft.BasicImage(rotation="+Q+") ";if(D){this.objSheet.styleRules[this.getId(K)].style.filter=J+this.objSheet.styleRules[this.getId(K)].style.filter;}else{K.style.filter=J+K.style.filter;}if(bIsIE8){setFilter(K,"Alpha",{opacity:100});}}}else{var O=-N;this.changeTextFieldRotation(K,O);}};mstrDocStyleImpl.prototype.changeTextFieldRotation=function(E,C){if(bIsDXIE){return ;}if(E.direction===undefined){E.direction="0";}var G=bIsIE10||bIsW3CIE?"t":(bIsFirefox?"MozT":"webkitT"),F=parseInt(this.formattingAttributes[E.id].hm,10),D=this.getValue(E,"width"),B=this.getValue(E,"height"),A={x:parseInt(this.getValue(E,"top")),y:parseInt(this.getValue(E,"left"))};E.style[G+"ransform"]="rotate("+C+"deg)";E.style[G+"ransformOrigin"]="top left";if(C!==0){E.style.width=B;E.style.height=F===0||microstrategy.DISPLAY_MODE===microstrategy.DESIGN_MODE?D:"auto";}else{E.style.width=D;E.style.height=F===0||microstrategy.DISPLAY_MODE===microstrategy.DESIGN_MODE?B:"auto";}this.updateVerticalTextPaddingAndBorder(E,C);this.updateVerticalTextShadow(E,C);E.direction=this.getValue(E,"TextDirection");this.changeVerticalTextPosition(E,A);};mstrDocStyleImpl.prototype.updateVerticalTextPaddingAndBorder=function(D,B){var C={paddingTop:this.getValue(D,"paddingTop"),paddingBottom:this.getValue(D,"paddingBottom"),paddingLeft:this.getValue(D,"paddingLeft"),paddingRight:this.getValue(D,"paddingRight"),borderTopWidth:this.getValue(D,"borderTopWidth"),borderTopStyle:this.getValue(D,"borderTopStyle"),borderTopColor:this.getValue(D,"borderTopColor"),borderBottomWidth:this.getValue(D,"borderBottomWidth"),borderBottomStyle:this.getValue(D,"borderBottomStyle"),borderBottomColor:this.getValue(D,"borderBottomColor"),borderLeftWidth:this.getValue(D,"borderLeftWidth"),borderLeftStyle:this.getValue(D,"borderLeftStyle"),borderLeftColor:this.getValue(D,"borderLeftColor"),borderRightWidth:this.getValue(D,"borderRightWidth"),borderRightStyle:this.getValue(D,"borderRightStyle"),borderRightColor:this.getValue(D,"borderRightColor")},A=function(G,F){for(var E=0;E<4;E++){D.style["padding"+G[E]]=C["padding"+F[E]];D.style["border"+G[E]+"Width"]=C["border"+F[E]+"Width"];D.style["border"+G[E]+"Style"]=C["border"+F[E]+"Style"];D.style["border"+G[E]+"Color"]=C["border"+F[E]+"Color"];}};switch(B){case 0:A(["Top","Bottom","Left","Right"],["Top","Bottom","Left","Right"]);break;case -90:A(["Top","Bottom","Left","Right"],["Left","Right","Bottom","Top"]);break;case 90:A(["Top","Bottom","Left","Right"],["Right","Left","Top","Bottom"]);break;}};mstrDocStyleImpl.prototype.changeVerticalTextPosition=function(G,B){if(bIsDXIE){return ;}var D=G.direction||this.getValue(G,"TextDirection")||"0",A=Math.round(microstrategy.getPaddingAndBorderPixels(G,"height")),C=Math.round(microstrategy.getPaddingAndBorderPixels(G,"width")),F=parseInt(this.getValue(G,"width"),0)+C,E=parseInt(this.getValue(G,"height"),0)+A;if(B.x!==null){if(D==="90"){G.style.top=B.x+E+"px";}else{G.style.top=B.x+"px";}}if(B.y!==null){if(D==="-90"){G.style.left=B.y+F+"px";}else{G.style.left=B.y+"px";}}};mstrDocStyleImpl.prototype.updateVerticalTextShadow=function(F,D){if(!bIsDXIE){var E=parseInt(this.getValue(F,"dropShadowEffect",microstrategy.FORMAT_TYPE_MAIN)),G=parseInt(this.getValue(F,"dropShadowDepth",microstrategy.FORMAT_TYPE_MAIN)),C=0,B=0,A=0;if(E==0||isNaN(E)){G=0;}C=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,Math.round(G*microstrategy.ZOOM_FACTOR/100));B=C;A=C;if(D===-90){B=-C;}else{if(D===90){A=-C;}}F.style[(mstr.utils.ISWK?"webkitBoxShadow":"boxShadow")]=B+"px "+A+"px 3px 0 #888";}};mstrDocStyleImpl.prototype.applyPadding=function(B,C,A){C=this.swapForRotation(B,C);B.style[C]=A;};mstrDocStyleImpl.prototype.applyShadow=function(E,B,H){if(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var G=microstrategy.findBone(E);if(G){G.synchronizeShadow(B=="dropShadowEffect"?H:null,B=="dropShadowDepth"?H:null);}return ;}var C=0;var A=3;switch(B){case"dropShadowDepth":C=parseInt(this.getValue(E,"dropShadowEffect",microstrategy.FORMAT_TYPE_MAIN));A=parseInt(H);break;case"dropShadowEffect":A=parseInt(this.getValue(E,"dropShadowDepth",microstrategy.FORMAT_TYPE_MAIN));C=parseInt(H);break;}var I;var F=this;function D(){if(!document.getElementById(E.getAttribute(microstrategy.HTMLATTR_ID))){window.setTimeout(D,100);return ;}E=document.getElementById(E.getAttribute(microstrategy.HTMLATTR_ID));if(bIsDXIE){if(C==0||isNaN(C)){A=0;}I=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,Math.round(A*microstrategy.ZOOM_FACTOR/100));var M=F.getFilter(E,"dropshadow");if(M){M.color="#66000000";M.positive="true";M.OffX=Math.round(I);M.OffY=Math.round(I);M.enabled=(A>0);}else{if(A==0){return ;}var N=E.style.filter;var J=false;if(N==null||N.length==0){N=F.getFilter(E);if(N!=null&&N.length>0){J=true;}}var K=" progid:DXImageTransform.Microsoft.dropshadow(Color='#66000000', Positive='true', OffX="+I+", OffY="+I+") ";if(J){F.objSheet.styleRules[F.getId(E)].style.filter+=K;}else{E.style.filter+=K;if(mstr.utils.ISIE4){window.setTimeout(function(){E.style.visibility="visible";},100);}}}}else{var L=-parseInt(F.getValue(E,"TextDirection")||"0",0);F.updateVerticalTextShadow(E,L);}}D();};mstrDocStyleImpl.prototype.applyAlpha=function(E,A,I){var F=0;var D=3;switch(A){case"alphaOpacity":F=parseInt(this.getValue(E,"alphaEffect"));D=parseInt(I);break;case"alphaEffect":D=parseInt(this.getValue(E,"alphaOpacity"));F=parseInt(I);break;}if(bIsDXIE){var H=this.getFilter(E,"Alpha");if(F==0){D=0;}if(H){H.opacity=D;H.enabled=(D>0);}else{var C=E.style.filter;var B=false;if(C==null||C.length==0){C=this.getFilter(E);if(C!=null&&C.length>0){B=true;}}var G=" progid:DXImageTransform.Microsoft.Alpha(Transparency="+D+") ";if(B){this.objSheet.styleRules[this.getId(E)].style.filter+=G;}else{E.style.filter+=G;}}}};mstrDocStyleImpl.prototype.getFilter=function(D,A){try{if(A=="Gradient"&&D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&D.getAttribute("scriptclass")!="mstrPanel"){var E=D.previousSibling;if(E&&E.id==(D.id+gradientUtil.GRADIENT_POSTFIX)){D=E;}}var G=D.currentStyle?D.currentStyle.filter:D.style.filter;if(G==null||G.length==0){var F=this.getId(D);if(!isNaN(F)){G=this.objSheet.styleRules[F].style.filter;}}if(!A){return G;}var B=null;if(G.length>0){B=D.filters["DXImageTransform.Microsoft."+A];}return B;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocStyleImpl.prototype.cascadeSelectorValue=function(C,D,B){var A=microstrategy.bone(C.getAttribute("id")+"_Ctl");if(A){A.cascadeFormatting(C,D,B);}if(A&&A.ctlStyle==mstrRWControlImpl.CTL_STYLE_LIST_BOX&&D.indexOf("textDecoration")==0&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){C.style[D]="none";A[D]=B;}else{C.style[D]=B;}};mstrDocStyleImpl.prototype.getAttValue=function(E,A,D){try{if(!E||!this.formattingAttributes){return null;}if(D&&D!=microstrategy.FORMAT_TYPE_MAIN){var C=mstrStaticDoc.getBone(E);if(C&&C.getAttValue){return C.getAttValue(D,A);}}var F=this.formattingAttributes[E.getAttribute("id")];if(F!=null&&typeof (F[A])!="undefined"){return F[A];}return E.getAttribute(A,0);}catch(B){microstrategy.errors.log(B);return null;}};mstrDocStyleImpl.prototype.setAttValue=function(E,A,D){try{if(microstrategy.formatType!=microstrategy.FORMAT_TYPE_MAIN){var C=mstrStaticDoc.getBone(E);if(C&&C.setAttValue){return C.setAttValue(microstrategy.formatType,A,D);}}var G=E.getAttribute("id");var F=this.formattingAttributes[G];if(typeof (F)=="undefined"){this.formattingAttributes[G]={};this.formattingAttributes[G][A]=D;}else{F[A]=D;}}catch(B){microstrategy.errors.log(B);}return null;};mstrDocStyleImpl.prototype.cloneAttValues=function(D,E){try{var F=this.formattingAttributes[D.getAttribute("id")];if(typeof (F)=="undefined"){return ;}var G=E.getAttribute("id");var B=this.formattingAttributes[G];if(typeof (B)=="undefined"){this.formattingAttributes[G]={};B=this.formattingAttributes[G];}for(var A in F){if(A==microstrategy.HTMLATTR_LOCKED){B[A]=false;}else{B[A]=F[A];}}}catch(C){microstrategy.errors.log(C);}};mstrDocStyleImpl.prototype.getInnerHeight=function(G){try{var B=this.getValue(G,"height");if(isNaN(parseInt(B))||B.indexOf("%")>-1){var F=mstrFormatObject;var D=parseInt(this.getValue(G,"paddingTop"));var E=parseInt(this.getValue(G,"paddingBottom"));D=(isNaN(D))?0:D;E=(isNaN(E))?0:E;var A;if(!this.getValue(G,"TextDirection")||this.getValue(G,"TextDirection")=="0"){A=getObjInnerHeight(G);}else{A=getObjInnerWidth(G);}B=A-F.getPxFromPt(D+E);}return Math.max(parseInt(B),1);}catch(C){microstrategy.errors.log(C);return false;}};mstrDocStyleImpl.prototype.getInnerWidth=function(F){try{var A=this.getValue(F,"width");if(isNaN(parseInt(A))||A.indexOf("%")>-1){var E=mstrFormatObject;var B=parseInt(this.getValue(F,"paddingLeft"));var G=parseInt(this.getValue(F,"paddingRight"));B=(isNaN(B))?0:B;G=(isNaN(G))?0:G;var D;if(!this.getValue(F,"TextDirection")||this.getValue(F,"TextDirection")=="0"){D=getObjInnerWidth(F);}else{D=getObjInnerHeight(F);}A=D-E.getPxFromPt(B+G);}return Math.max(parseInt(A),1);}catch(C){microstrategy.errors.log(C);return false;}};mstrDocStyleImpl.prototype.getCssText=function(C){try{var A="";var D=this.getId(C);if(isNaN(D)){return C.style.cssText;}else{if(this.objSheet.styleRules[D]){A+=this.objSheet.styleRules[D].style.cssText+"; ";}A+=C.style.cssText;}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocStyleImpl.prototype.resolveStyles=function(C,D){try{if(D.indexOf("line")===0){if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)===microstrategy.SUBOBJTYPE_DOC_LINE){var A=(parseInt(this.getAttValue(C,microstrategy.HTMLATTR_ORIENTATION))===microstrategy.ORIENTATION_HORIZONTAL)?"Top":"Left";if(D==="lineColor"){D="border"+A+"Color";}else{if(D==="lineStyle"){D="border"+A+"Style";}else{if(D==="lineWeight"){D="border"+A+"Width";}}}}else{if(D==="lineColor"){D="borderTopColor";}else{if(D==="lineColor2"){D="borderBottomColor";}else{if(D==="lineStyle"){D="borderStyle";}else{if(D==="lineWeight"){D="borderWidth";}}}}}}else{if(D==="textDecoration2"){D="textDecoration";}}return D;}catch(B){microstrategy.errors.log(B);return null;}};mstrDocStyleImpl.prototype.getId=function(B){try{return parseInt(this.getAttValue(B,mstrDocStyleImpl.HTMLATTR_CLASS_ID));}catch(A){microstrategy.errors.log(A);return null;}};mstrDocStyleImpl.prototype.adjustSizes=function(A,E,B,D){try{E=String(E);if(E=="100%"||E=="auto"){return E;}return Math.max(Math.round(parseFloat(E)-microstrategy.getPaddingAndBorderPixels(D,A,B)),0);}catch(C){microstrategy.errors.log(C);return E;}};function mstrDocStyleImpl(A){this.formattingAttributes=A;return this;}mstrStaticDocViewer.prototype=new mstrBoneImpl();mstrStaticDocViewer.prototype.superClass=mstrEditorImpl.prototype;mstrStaticDocViewer.prototype.updateManager=microstrategy.updateManager;mstrStaticDocViewer.prototype.zoom=100;mstrStaticDocViewer.prototype.flags=0;mstrStaticDocViewer.prototype.rulerOn=false;mstrStaticDocViewer.prototype.gridOn=false;mstrStaticDocViewer.prototype.dividerOn=false;mstrStaticDocViewer.prototype.rulerShadeOn=false;mstrStaticDocViewer.prototype.rulers={};mstrStaticDocViewer.prototype.scrollTopPosition=0;mstrStaticDocViewer.prototype.scrollLeftPosition=0;mstrStaticDocViewer.prototype.noDataset=false;mstrStaticDocViewer.prototype.objProps=null;mstrStaticDocViewer.prototype.resizeTimer=null;mstrStaticDocViewer.prototype.totalHeight=0;mstrStaticDocViewer.prototype.gridCellCssPrefix="";mstrStaticDocViewer.prototype.messageID="";mstrStaticDocViewer.prototype.objectID="";mstrStaticDocViewer.prototype.objectType=microstrategy.DSSTYPE_DOC_DEFINITION;mstrStaticDocViewer.prototype.parentFolderID=null;mstrStaticDocViewer.prototype.needSaveBeforeNotes=true;mstrStaticDocViewer.prototype.isMultiLayout=false;mstrStaticDocViewer.prototype.tabCount=0;mstrStaticDocViewer.prototype.sectionSubsections=null;mstrStaticDocViewer.prototype.panelStacks=null;mstrStaticDocViewer.prototype.onLoadCalled=false;mstrStaticDocViewer.prototype.resizedSubsections=null;mstrStaticDocViewer.prototype.documentDataSets=null;mstrStaticDocViewer.prototype.hasHorizontalSections=false;mstrStaticDocViewer.prototype.viewerBone=true;mstrStaticDocViewer.prototype.gradientsOnSS=false;mstrStaticDocViewer.prototype.gridGraphFormatting=true;mstrStaticDocViewer.prototype.dScrollTop=0;mstrStaticDocViewer.prototype.dScrollLeft=0;mstrStaticDocViewer.prototype.needWidthAdjustment=false;mstrStaticDocViewer.prototype.onload=function(){try{this.commands=new mstrViewerCommandsImpl();this.observer=microstrategy.viewerObserver||new mstrObserverImpl();microstrategy.viewerObserver=this.observer;this.initViewer();if(this.layoutHeightMode!=1){this.callDelayedResize();if(this.scrollTopPosition!=0||this.scrollLeftPosition!=0){this.delayedScrollAdjust(this.scrollTopPosition,this.scrollLeftPosition);}}this.onLoadCalled=true;}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.onrepostload=function(B){try{mstrBoneImpl.prototype.onrepostload.call(this);this.observer.notifyAll("onDocReload");}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);this.adjustWidth();this.updateVerticalTextFields();}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.onstatechange=function(){this.observer.notifyAll("onstatechange");};mstrStaticDocViewer.prototype.onObjectBrowserTabChange=function(){this.observer.notifyAll("onObjectBrowserTabChange");};mstrStaticDocViewer.prototype.onselectionchange=function(){this.observer.notifyAll("onselectionchange");};mstrStaticDocViewer.prototype.onreload=function(E){try{this.onLoadCalled=false;this.resizedSubsections={};var G=document.getElementById("docObjectStyleIFrame");if(G){var B=document.getElementById("docObjectStyle");if(B&&B.parentNode){B.parentNode.removeChild(B);}}var F=document.getElementById("consolidatedGridStyleSheetIFrame");if(F){var A=document.getElementById("consolidatedGridStyleSheet");if(A&&A.parentNode){A.parentNode.removeChild(A);}}var D=this.superClass.onreload.call(this,E);this.doc.formattingAttributes=this.formattingAttributes;this.doc.styleObj.reloadFormattingAttributes(this.formattingAttributes);if(!D&&this.doc.hasMoved()){this.onwinresize();}}catch(C){microstrategy.errors.log(C);}};mstrStaticDocViewer.prototype.adjustScrollValues=function(C){try{var A=document.createElement("img");document.body.appendChild(A);A.parentNode.removeChild(A);this.elem.onmousemove=null;this.dScrollTop=this.elem.scrollTop;this.dScrollLeft=this.elem.scrollLeft;return true;}catch(B){microstrategy.errors.log(B);}};mstrStaticDocViewer.prototype.onwinresize=function(){try{this.callDelayedResize();}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.getAvailableDatasets=function(){try{var B=[];if(!this.noDataset){for(var C in this.documentDataSets){B.push({dssid:C,n:this.documentDataSets[C]});}}return B;}catch(A){microstrategy.errors.log(A);return B;}};mstrStaticDocViewer.prototype.delayedScrollAdjust=function(B,C){try{if(this.scrollTimer){window.clearTimeout(this.scrollTimer);}this.scrollTimer=window.setTimeout("microstrategy.bone('"+this.id+"').onscrollAdjust("+B+","+C+")",0);}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.onscrollAdjust=function(B,C){try{if(this.elem&&this.elem.hasChildNodes()){if(this.elem.style){if(B!=0){this.elem.scrollTop=B;this.dScrollTop=B;}if(C!=0){this.elem.scrollLeft=C;this.dScrollLeft=C;}}}}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.callDelayedResize=function(B){try{if(this.resizeTimer){window.clearTimeout(this.resizeTimer);}if(!!B){this.resizeTimer=window.setTimeout("microstrategy.bone('"+this.id+"').doc.onwinresize()",0);}else{this.resizeTimer=window.setTimeout("microstrategy.bone('"+this.id+"').ondialogresize()",0);}}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.ondialogresize=function(){try{if(this.tmr_dr){window.clearTimeout(this.tmr_dr);}iframe.showWaitPage(true);var B=this;this.tmr_dr=window.setTimeout(function(){B.delayedOndialogresize();},300);}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.getAvaiableDocViewerWidth=function getAvaiableDocViewerWidth(){try{var C=mstr.utils.BoxModel,B=C.getBrowserWindowWidth(document);return C.hasScrollbar(document.documentElement,"y")?B+SCROLLBAR_SIZE:B;}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.delayedOndialogresize=function(){var D=this;if(D.elem&&D.elem.hasChildNodes()){if(D.elem.style){var A=getClientHeight();var F=D.getAvaiableDocViewerWidth();var E=getObjSumTop(D.elem);var G=getObjSumLeft(D.elem);var C=0;if(true){C=document.getElementById("mstrWeb_footer").offsetHeight+document.getElementById("mstrWeb_dockBottom").offsetHeight;}D.elem.style.height=Math.max(A-E-4-C,SCROLLBAR_SIZE)+"px";D.elem.style.width=Math.max(F-G-4,SCROLLBAR_SIZE)+"px";if(mstr.utils.ISWK){var B=document.getElementById("mstrWebContents");B.style.overflow="hidden";window.setTimeout(function(){B.style.overflow="auto";},0);}}if(D.doc&&D.doc.onwinresize){D.callDelayedResize(true);}}};mstrStaticDocViewer.prototype.onforcerepaint=function(){try{if(!this.doc||!this.doc.elem){return ;}var A=document.createElement("img");this.doc.elem.appendChild(A);A.parentNode.removeChild(A);}catch(B){microstrategy.errors.log(B);}};mstrStaticDocViewer.prototype.initViewer=function(){try{this.initBone();var C=microstrategy.objectFind(this.elem,["DIV"],microstrategy.OBJTYPE_DOC);if(this.commands){this.commands.parentBone=this;}if(C){var D=C.getAttribute("id");if(!(microstrategy.bone(D))){var A=C.getAttribute(microstrategy.HTMLATTR_SCRIPTCLASS);this.doc=new window[A](D);this.doc.parentBone=this;this.doc.containsHorizontalSections=this.hasHorizontalSections;if(this.doc.onload){this.doc.onload();}this.needWidthAdjustment=true;}if(this.doc&&this.doc.containsHorizontalSections){this.resize100WMObjects();}}}catch(B){microstrategy.errors.log(B);}};mstrStaticDocViewer.prototype.updateVerticalTextFields=function(){if(bIsDXIE){return ;}var F=function(G){return document.getElementById(G);},A=this.formattingAttributes;if(!A){return ;}var E=A.tdUnits,C;for(C in E){var D=F(C),B=-parseInt(E[C],10);if(D){microstrategy.styleObj.changeTextFieldRotation(D,B);}}};mstrStaticDocViewer.prototype.resize100WMObjects=function(G,K){try{var A="";var F=0;var D=0;var I=null;if(G&&(this.doc.containsHorizontalSections||K)){var H;if(this[G+"_100wm"]!=null){A=String(this[G+"_100wm"]).split(",");for(F=0;F<A.length;F++){I=document.getElementsByName(A[F]);H=getObjWidth(document.getElementById(G))+"px";for(D=0;I!=null&&D<I.length;D++){if(I[F]&&microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){H=getObjWidth(I[F].parentNode)+"px";}I[D].style.width=this.doc.removePaddingAndBorder(I[D],H,"width")+"px";}}}}else{var J=getObjWidth(this.doc.elem)+"px";var E=this.doc.selections;A=String(this.viewer100wm).split(",");for(F=0;F<A.length;F++){I=document.getElementsByName(A[F]);var B=microstrategy.findBone(I[0]);if(B&&!B.isHorizontal){for(D=0;I!=null&&D<I.length;D++){I[D].style.width=this.doc.removePaddingAndBorder(I[D],J,"width")+"px";}if(E!=null){E.syncUp(I[0]);}}}}}catch(C){microstrategy.errors.log(C);}};mstrStaticDocViewer.prototype.resize100HMObjects=function(F,J){try{if(this[F+"_100hm"]!=null){var A=String(this[F+"_100hm"]).split(",");for(var E=0;E<A.length;E++){if(J){var D=microstrategy.findChildWithAtt(J,"SPAN","id",A[E]);if(D){var I=(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.RESIZE_EACH_SUBSECTION)?document.getElementById(F):D.parentNode;D.style.height=this.doc.removePaddingAndBorder(D,getObjHeight(I)+"px","height")+"px";}}else{var H;var G=document.getElementsByName(A[E]);if(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.RESIZE_EACH_SUBSECTION){H=getObjHeight(document.getElementById(F))+"px";}for(var C=0;G!=null&&C<G.length;C++){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){H=getObjHeight(G[C].parentNode)+"px";}G[C].style.height=this.doc.removePaddingAndBorder(G[C],H,"height")+"px";}}}}}catch(B){microstrategy.errors.log(B);}};mstrStaticDocViewer.prototype.syncDocRszHandler=function(){};mstrStaticDocViewer.prototype.setZoom=function(A){this.zoom=A;return false;};mstrStaticDocViewer.prototype.setFlags=function(A){return false;};mstrStaticDocViewer.prototype.getChildBone=function(C){try{if(this.doc==null||!this.doc.isLoaded){return null;}var A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(A){case microstrategy.OBJTYPE_DOC:return this.doc;break;case microstrategy.OBJTYPE_DOC_SUBSECTION:case microstrategy.OBJTYPE_DOC_SECTION:case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:return this.doc.getChildBone(C);break;}return null;}catch(B){microstrategy.errors.log(B);return false;}};mstrStaticDocViewer.prototype.handleTaskModelReadyStateChange=function(A){try{this.doc.handleTaskModelReadyStateChange(A);}catch(B){microstrategy.errors.log(B);}};mstrStaticDocViewer.prototype.findParentSubsection=function(C){try{var A=microstrategy.findAncestorWithAtt(C.parentNode,"ty",microstrategy.OBJTYPE_DOC_SUBSECTION);if(A&&A.getAttribute("sty")){A=this.findParentSubsection(A);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrStaticDocViewer.prototype.isInteractiveViewModeEplus=function(A){return false;};mstrStaticDocViewer.prototype.isEditableViewModeEplus=function(){return false;};mstrStaticDocViewer.prototype.adjustWidth=function(){try{if(this.needWidthAdjustment&&this.doc&&this.doc.adjustWidth){this.doc.adjustWidth();}this.needWidthAdjustment=false;}catch(A){microstrategy.errors.log(A);return false;}};mstrStaticDocViewer.onUnitReload=function(D){try{if(!D.elem){return ;}var B=microstrategy.getViewerBone();if((!B)||B.onLoadCalled){return ;}if(!B.resizedSubsections){B.resizedSubsections={};}var E=B.findParentSubsection(D.elem);if((!E)||B.resizedSubsections[E.id]){return ;}var A=microstrategy.findBone(E);if(A&&A.resizeSubsection){A.resizeSubsection();B.resizedSubsections[E.id]=true;}B.doc.synchHeightOfHorizontalSections();}catch(C){microstrategy.errors.log(C);}};mstrStaticDocViewer.prototype.setNeedWidthAdjustment=function(B){try{this.needWidthAdjustment=this.isLoaded&&B;}catch(A){microstrategy.errors.log(A);}};mstrStaticDocViewer.prototype.getAllVisList=function(){return this.allVisList;};mstrStaticDocViewer.prototype.showWarningMessageForUnsupportFeature=function(B,A){if(this.isFeatureAvailable("rw-support-flash-mode")){showMessage({contents:microstrategy.descriptors.getDescriptor(13964),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:B,cancelEval:A,type:mstrMsgBoxImpl.MSG_WARNING});}else{B();}};mstrStaticDocViewer.prototype.checkAndDisableFlashDefaultMode=function(B,D){if(this.DefaultViewMode===mstr.Enum.VIEWMEDIA.FLASH){var C=mstr.Enum.VIEWMEDIA,E=this.AvailableViewModes,A=(C.STATIC&E)?C.STATIC:(C.INTERACTIVE&E)?C.INTERACTIVE:0;D.push(B.createActionObject(null,mstrUpdateManager.SET_VIEW_MEDIA,this.beanPath,["2048163"],[A],[]));}};function mstrStaticDocViewer(A){this.inherits=mstrEditorImpl;this.inherits(A);this.inherits=null;this.primaryBone=true;return this;}mstrFilterPanelMaskImpl.prototype=new mstrSubSectionMaskImpl();mstrFilterPanelMaskImpl.prototype.selectorInfo={};mstrFilterPanelMaskImpl.prototype.maxZIndex=0;mstrFilterPanelMaskImpl.ITEM_SPA=2;mstrFilterPanelMaskImpl.prototype.onload=function(B){try{this.maskedBone=B;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.initElem();}catch(A){microstrategy.errors.log(A);return false;}};mstrFilterPanelMaskImpl.prototype.initElem=function(){try{var B=(this.maskedBone.subsectionType==mstrSubSection.TYPE_PANEL);var D=document.createElement("div");D.setAttribute("id",this.maskedBone.id+"_mask");D.setAttribute("name",this.maskedBone.id+"_mask");D.style.position=(B)?"absolute":"relative";D.style.overflow="hidden";var A=document.createElement("img");A.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";A.style.width="100%";A.style.height="100%";if(this.maskedBone){D.style.height=this.getSectionHeight(this.maskedBone.elem)+"px";if(this.maskedBone.isHorizontal){if(this.getSectionWidth(this.maskedBone.elem)!=0){D.style.width=this.getSectionWidth(this.maskedBone.elem)+"px";}}}D.appendChild(A);this.img=A;this.elem=D;this.createImageMap();if(parseInt(this.elem.style.height)>0){this.elem.setAttribute("isCollapsed","false");}else{this.img.onmouseover=null;this.img.onmouseout=null;this.elem.setAttribute("isCollapsed","true");this.elem.style.cursor="not-allowed";}}catch(C){microstrategy.errors.log(C);return false;}};mstrFilterPanelMaskImpl.prototype.updateImageMap=function(){try{this.elem.removeChild(this.imgMap);this.maxZIndex=0;this.createImageMap();}catch(A){microstrategy.errors.log(A);}};mstrFilterPanelMaskImpl.prototype.createImageMap=function(){try{var I=document.createElement("map");var H=this.maskedBone.id+"_fpMap";I.setAttribute("id",H);I.setAttribute("name",H);this.img.setAttribute("usemap","#"+H);I.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_MASK);I.setAttribute(microstrategy.HTMLATTR_MASKEDOBJECT,this.maskedBone.id);I.setAttribute(microstrategy.HTMLATTR_POINTS_TO,this.secId+"|"+this.subId+"|"+this.subIndex);this.elem.appendChild(I);this.imgMap=I;if(this.maskedBone.elem){var B,F=this.maskedBone.elem,C=mstrFilterPanelMaskImpl.ITEM_SPA;this.selectorInfo={};for(var E=0;E<F.childNodes.length;E++){var G=F.childNodes[E];if(G.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){B=document.createElement("area");B.setAttribute("shape","rect");B.setAttribute("coords",this.getChildCoords(G));B.setAttribute("ctrlId",G.getAttribute("id"));I.appendChild(B);C+=mstr.utils.BoxModel.getElementOuterHeight(G)+mstrFilterPanelMaskImpl.ITEM_SPA;var A=parseInt(microstrategy.styleObj.getValue(G,"zIndex"));this.selectorInfo[G.getAttribute("id")]={zIndex:A,item:G};if(A>this.maxZIndex){this.maxZIndex=A;}B.setAttribute("soz",A);B.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(e, true); }");B.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(e, false); }");}}if(mstr.utils.BoxModel.getElementOuterHeight(this.maskedBone.elem)>C){B=document.createElement("area");B.setAttribute("shape","rect");B.setAttribute("coords",this.getChildCoords(this.maskedBone.elem,C));I.appendChild(B);B.onmouseover=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(e, true); }");B.onmouseout=new Function("e",this.verifiedPath+" { return "+this.path+".displayMask(e, false); }");}}}catch(D){microstrategy.errors.log(D);}};mstrFilterPanelMaskImpl.prototype.getChildCoords=function(E,C){try{var D=microstrategy.styleObj.getAttValue(E,microstrategy.HTMLATTR_HEIGHT_MODE);if(!D||D!=microstrategy.HUNDRED_PERCENT_MODE){var A=(E.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL);t=A?C:parseInt(microstrategy.styleObj.getValue(E,"top")),l=A?mstrFilterPanelMaskImpl.ITEM_SPA:parseInt(microstrategy.styleObj.getValue(E,"left")),b=t+mstr.utils.BoxModel.getElementOuterHeight(E),r=l+mstr.utils.BoxModel.getElementOuterWidth(E);}return l+", "+t+", "+r+", "+b;}catch(B){microstrategy.errors.log(B);return false;}};mstrFilterPanelMaskImpl.prototype.displayMask=function(e,show){try{var submaskDiv=document.getElementById("maskDiv");if(!submaskDiv){submaskDiv=document.createElement("div");submaskDiv.setAttribute("id","maskDiv");submaskDiv.style.position="absolute";var docMask=document.getElementById("docMask");docMask.insertBefore(submaskDiv,docMask.firstChild);}if(!show){submaskDiv.style.display="none";return false;}if(!e){e=window.event;}var srcArea=getEventTarget(e);if(!srcArea&&srcArea.tagName!="AREA"){return false;}with(submaskDiv.style){border="solid #ffff00";borderTopWidth="3px";borderLeftWidth=borderRightWidth=borderBottomWidth="0px";display="block";visibility="visible";var coords=srcArea.getAttribute("coords").split(",");height=(parseInt(coords[3])-parseInt(coords[1]))+"px";width=(parseInt(coords[2])-parseInt(coords[0]))+"px";left=getObjSumLeft(this.maskedBone.elem)-parseInt(this.maskedBone.doc.left)+parseInt(coords[0])+"px";top=getObjSumTop(this.maskedBone.elem)-parseInt(this.maskedBone.doc.top)+parseInt(coords[1])+"px";}}catch(err){microstrategy.errors.log(err);}return false;};mstrFilterPanelMaskImpl.prototype.adjustZIndex=function(B,F,E){try{var G=B?this.selectorInfo[B]:null,I=F?this.selectorInfo[F]:null,D,J;if(!B){if(!F){return false;}else{D=E?parseInt(I.zIndex)+1:parseInt(I.zIndex);J=E?parseInt(this.maxZIndex)+1:parseInt(this.maxZIndex);for(var A in this.selectorInfo){var H=this.selectorInfo[A];if(H.zIndex>=D&&H.zIndex<J){if(E){H.zIndex--;}else{H.zIndex++;}}}}}else{if(!F||G.zIndex<I.zIndex){D=parseInt(G.zIndex);J=parseInt(I?I.zIndex-1:this.maxZIndex);if(G.zIndex==J){return false;}G.zIndex=J;for(var A in this.selectorInfo){var H=this.selectorInfo[A];if(A==B){continue;}if(H.zIndex>D&&H.zIndex<=J){H.zIndex--;}}}else{if(G.zIndex>I.zIndex){D=I.zIndex;J=G.zIndex;G.zIndex=D;for(var A in this.selectorInfo){var H=this.selectorInfo[A];if(A==B){continue;}if(H.zIndex>=D&&H.zIndex<J){H.zIndex++;}}}else{if(G.zIndex==I.zIndex){return false;}}}}}catch(C){microstrategy.errors.log(C);return false;}return true;};mstrFilterPanelMaskImpl.prototype.getMoveItems=function(){try{var A=[];for(var D in this.selectorInfo){var C=this.selectorInfo[D];if(C.zIndex!=microstrategy.styleObj.getValue(C.item,"zIndex")){A.push(C);}}A.sort(function(E,F){return E.zIndex-F.zIndex;});return A;}catch(B){microstrategy.errors.log(B);}};mstrFilterPanelMaskImpl.prototype.getStartArea=function(C){try{var B=microstrategy.findChildWithAtt(this.imgMap,"AREA","soz",C+"");if(B){return B;}else{return this.imgMap.lastChild;}}catch(A){microstrategy.errors.log(A);}};function mstrFilterPanelMaskImpl(C,B,A){this.inherits=mstrSubSectionMaskImpl;this.inherits(C,B,A);this.inherits=null;return this;}mstrDocSectionImpl.prototype=new mstrBoneImpl();mstrDocSectionImpl.prototype.path="";mstrDocSectionImpl.prototype.verifiedPath="";mstrDocSectionImpl.prototype.sibs=null;mstrDocSectionImpl.prototype.prevSec=null;mstrDocSectionImpl.prototype.currentSec=null;mstrDocSectionImpl.prototype.isCollapsed=false;mstrDocSectionImpl.prototype.isDetails=false;mstrDocSectionImpl.prototype.isHorizontal=false;mstrDocSectionImpl.prototype.isBeginHorizontal=false;mstrDocSectionImpl.prototype.prevRuler=null;mstrDocSectionImpl.prototype.groupID=null;mstrDocSectionImpl.prototype.onload=function(B){try{this.initBone();this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.sibs=document.getElementsByName(this.id);this.initSection();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSectionImpl.prototype.syncPosition=function(){try{for(var B in this.subsections){if(this.subsections[B].syncPosition){this.subsections[B].syncPosition();}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSectionImpl.prototype.onmousedown=function(T){try{if(!T){T=window.event;}var I=getEventTarget(T);var F=this.parentBone.parentBone;var H=F.updateManager;var S=mstrFormatObject;var K=[];this.currentSec=microstrategy.findAncestorWithAtt(I,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION);var Q=microstrategy.eventManager.getSource(T);if(!F.isEditableViewModeEplus()){return ;}if(this.isHorizontal){if(!this.isBeginHorizontal){this.prevSec=this.currentSec.parentNode.previousSibling.firstChild;}}else{var R=0;if(this.currentSec){var W=this.parentBone.elem;for(R=0;R<W.childNodes.length;R++){if(this.currentSec==W.childNodes[R]){break;}}}if(R>0){this.prevSec=this.parentBone.elem.childNodes[R-1];}if(microstrategy.styleObj.getAttValue(this.prevSec,microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_DOC_SECTION&&microstrategy.styleObj.getAttValue(this.prevSec,microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_PARENT_HORIZONTAL_CONTAINER){var O=microstrategy.findChildWithAtt(this.prevSec,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(O){var U=microstrategy.findBone(O);this.prevSec=U.getLastNonCollapsedSection();}}}var P=microstrategy.findChildWithAtt(this.currentSec,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);if(I.tagName=="IMG"){var X=I.src.substr(I.src.lastIndexOf("/")+1);var A=(X=="treeCollapse.gif")?"0":"-1";this.toggleSections(A,I);var N,L;if(A=="-1"){L="-1";N="0";}else{L="0";N="-1";}if(H){var C={};C.source=I;var M=document.getElementById(this.id);var V=M.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+S.expanded[mstrFormatObject.PROP_SET]+mstrUpdateManager.UNIT_SEPARATOR+S.expanded[mstrFormatObject.PROP_NAME]+mstrUpdateManager.UNIT_SEPARATOR;K.push(H.createActionObject(M,mstrUpdateManager.EDIT_PROPS,F.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,V+L+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,V+N+mstrUpdateManager.ITEM_SEPARATOR],C));for(var J in this.subsections){M=this.subsections[J].elem;V=this.subsections[J].id+mstrUpdateManager.UNIT_SEPARATOR+S.expanded[mstrFormatObject.PROP_SET]+mstrUpdateManager.UNIT_SEPARATOR+S.expanded[mstrFormatObject.PROP_NAME]+mstrUpdateManager.UNIT_SEPARATOR;K.push(H.createActionObject(M,mstrUpdateManager.EDIT_PROPS,F.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,V+L+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,V+N+mstrUpdateManager.ITEM_SEPARATOR],C));}H.add(K,true);}if(P){this.parentBone.selections.addSubSection(P);}}else{if(Q&&Q.button==2){if(P){var B=microstrategy.findBone(P);if(B){B.onmousedown(T);}}}else{var G=false;if(this.isHorizontal){if(!this.isBeginHorizontal){G=true;}}else{if(this.currentSec.previousSibling!=this.currentSec.parentNode.firstChild){G=true;}}if(G){var D=microstrategy.findAncestorWithAtt(I,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);if(D){if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondragstart");this.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondragstart(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}}}if(P){this.parentBone.selections.addSubSection(P);}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrDocSectionImpl.prototype.ondragstart=function(D){try{if(!D){D=window.event;}if(D.e){D=D.e;}getMouse(D);if(this.currentSec){var C=this.parentBone.elem;var E=microstrategy.objectListFind(this.prevSec,["DIV"],microstrategy.OBJTYPE_DOC_SUBSECTION_CONTAINER);if(E==null||E.length==0){return true;}var A=E[E.length-1];this.prevSubElem=A.lastChild;this.prevRuler=A.firstChild;this.prevSubBone=microstrategy.findBone(this.prevSubElem);if(this.prevSubBone){if(this.isHorizontal){this.prevSubBone.oldwidth=getObjWidth(this.prevSubElem);this.prevSubBone.oldCanGrowHorizontal=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);this.prevSubBone.oldCanShrinkHorizontal=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);}else{this.prevSubBone.oldHeight=getObjHeight(this.prevSubElem);this.prevSubBone.oldCanGrow=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_GROW);this.prevSubBone.oldCanShrink=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_CAN_SHRINK);}this.prevSubBone.oldHideIfEmpty=microstrategy.styleObj.getAttValue(this.prevSubElem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);}if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondrag");this.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondragend(e); }");}this.ondrag(D);}}catch(B){microstrategy.errors.log(B);}return false;};mstrDocSectionImpl.prototype.ondrag=function(I){try{if(!I){I=window.event;}if(I.e){I=I.e;}getMouse(I);if(this.isHorizontal){var F=0;if(this.prevSubElem){var B=lMouseX+F-getObjSumLeft(this.currentSec);var E=getObjWidth(this.prevSubElem)+B;if(E>=0){this.prevSubElem.style.width=E+"px";}}}else{var D=this.parentBone.parentBone.elem.scrollTop;if(this.prevSubElem){var A=lMouseY+D-getObjSumTop(this.currentSec);var E=getObjHeight(this.prevSubElem)+A;if(E>=0){if(this.prevRuler){this.prevRuler.style.height=E+"px";}if(!this.prevSubBone.isHorizontal){this.prevSubElem.style.height=E+"px";}else{var J=microstrategy.findAncestorWithAtt(this.prevSubElem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);J.style.height=E+"px";var C=microstrategy.findChildrenWithAtt(J,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);if(C){for(var H=0;H<C.length;H++){C[H].style.height=E+"px";}}}}}}}catch(G){microstrategy.errors.log(G);}return false;};mstrDocSectionImpl.prototype.ondragend=function(D){try{if(!D){D=window.event;}if(D.e){D=D.e;}if(this.isHorizontal){this.prevSubBone.resizeWidth(getObjWidth(this.prevSubElem),true,null);}else{if(this.prevSubBone.isHorizontal){this.parentBone.resetHeightOfHorizontalSections(this.prevSubBone);}this.prevSubBone.resize(getObjHeight(this.prevSubElem),true,null);if(this.prevSubBone.isHorizontal){this.parentBone.synchHeightOfHorizontalSections(this.prevSubBone);}}var B=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.parentBone.parentBone.formattingAttributes;var C=this.isHorizontal&&this.prevSubBone.isHorizontal;var F=this.prevSubBone.id;if(B&&F){if(C){B[F][microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL]=microstrategy.FALSE;B[F][microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL]=microstrategy.FALSE;}else{if(this.prevSubBone.isHorizontal){var E=microstrategy.findAncestorWithAtt(this.prevSubBone.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(E){E.setAttribute(microstrategy.HTMLATTR_CAN_GROW,microstrategy.FALSE);E.setAttribute(microstrategy.HTMLATTR_CAN_SHRINK,microstrategy.FALSE);B[F][microstrategy.HTMLATTR_HIDE_IF_EMPTY]=microstrategy.FALSE;}}else{B[F][microstrategy.HTMLATTR_CAN_SHRINK]=microstrategy.FALSE;B[F][microstrategy.HTMLATTR_CAN_GROW]=microstrategy.FALSE;B[F][microstrategy.HTMLATTR_HIDE_IF_EMPTY]=microstrategy.FALSE;}}}this.onmouseup(D);}catch(A){microstrategy.errors.log(A);}return false;};mstrDocSectionImpl.prototype.onmouseup=function(B){try{if(typeof (mstr)!="undefined"){this.detachWinListener(this,"mousemove");this.detachWinListener(this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(A){microstrategy.errors.log(A);}return false;};mstrDocSectionImpl.prototype.toggleSections=function(D){try{var B=microstrategy.subObjectFind(this.elem,["IMG"],"cimg");if(D=="0"){for(var C in this.subsections){this.subsections[C].hide();}B.src=microstrategy.FOLDER_IMAGES+"treeExpand.gif";this.isCollapsed=true;}else{for(var C in this.subsections){this.subsections[C].show();}B.src=microstrategy.FOLDER_IMAGES+"treeCollapse.gif";this.isCollapsed=false;}if(this.parentBone.selections){this.parentBone.selections.clear();}}catch(A){microstrategy.errors.log(A);return false;}};mstrDocSectionImpl.prototype.initSection=function(){try{var C=null;var I=microstrategy.getViewerBone();if(I.isEditableViewModeEplus()){C=microstrategy.subObjectFind(this.elem,["IMG"],"cimg");}var F=(C!=null&&C.src.indexOf("treeExpand.gif")>-1);this.isCollapsed=F;var G="";this.subsectionLength=0;var B=this.parentBone.subSectionsInSection[this.id].split(",");this.groupID=microstrategy.styleObj.getAttValue(this.elem,"group");if(this.elem&&this.elem.childNodes){this.isBeginHorizontal=(microstrategy.styleObj.getAttValue(this.elem,microstrategy.HTMLATTR_IS_BEGIN_HORIZONTAL)=="-1");for(var E=0;E<B.length;E++){var A=B[E];if(A&&A!=""&&typeof (this.subsections[A])=="undefined"){var J=new mstrFixedPanel(A);J.parentBone=this;J.path=this.path+".subsections['"+A+"']";if(J.onload){J.onload();}this.isDetails=J.isDetails;this.isHorizontal=J.isHorizontal;this.subsections[A]=J;if(G!=""){this.subsections[G].nextSibling=A;}G=A;this.subsectionLength++;}}if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){if(F){for(var H in this.subsections){this.subsections[H].hide();}}else{for(var H in this.subsections){this.subsections[H].show();}}}}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocSectionImpl.prototype.getRightMostPos=function(){try{var A=0;for(var B in this.subsections){A=Math.max(this.subsections[B].getRightMostPos(),A);}return A;}catch(C){microstrategy.errors.log(C);return -1;}};mstrDocSectionImpl.prototype.getSubsectionCount=function(){try{return this.subsectionLength;}catch(A){microstrategy.errors.log(A);return null;}};mstrDocSectionImpl.prototype.setCursor=function(C){try{for(var A=0;A<this.sibs.length;A++){this.sibs[A].style.cursor=C;}}catch(B){microstrategy.errors.log(B);}};mstrDocSectionImpl.prototype.getChildBone=function(B){try{if(B.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){if(B.getAttribute("id") in this.subsections&&this.subsections[B.getAttribute("id")].isLoaded){return this.subsections[B.getAttribute("id")];}}return null;}catch(A){microstrategy.errors.log(A);return null;}};function mstrDocSectionImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;this.subsections={};return this;}mstrDocImpl.prototype=new mstrStaticDoc();mstrDocImpl.prototype.currentControl="cursor";mstrDocImpl.prototype.currentControlSubtype=null;mstrDocImpl.prototype.textEditor=null;mstrDocImpl.prototype.controlSelectionMode=false;mstrDocImpl.prototype.controlSourceUnitID=null;mstrDocImpl.prototype.standAloneControlKey=null;mstrDocImpl.prototype.controlSourceUnitType="";mstrDocImpl.prototype.controlSource="";mstrDocImpl.prototype.resizedSubMaskOnDrag=null;mstrDocImpl.prototype.adjustImageSizeFlag=false;mstrDocImpl.prototype.docMask=null;mstrDocImpl.prototype.docMaskCollection=null;mstrDocImpl.prototype.prevSelectedId=null;mstrDocImpl.prototype.undoRedoSubSections=null;mstrDocImpl.prototype.heightAndWidthAttMap={heightMode:microstrategy.HTMLATTR_HEIGHT_MODE,widthMode:microstrategy.HTMLATTR_WIDTH_MODE,height:microstrategy.HTMLATTR_HEIGHT,width:microstrategy.HTMLATTR_WIDTH};mstrDocImpl.DELETE_MODE={DELETE:1,HIDE:2};mstrDocImpl.INSERT_MODE={ALL_VISIBLE:1,HIDE_OTHERS:2};mstrDocImpl.prototype.onselectionchange=function(A){try{var D=this.prevSelectedId;var B=function(H){if(!H){return ;}var F=document.getElementById(H);if(F&&microstrategy.objectType(F)==microstrategy.OBJTYPE_DOC_SUBSECTION){var E=microstrategy.findBone(F);if(E){E.toggleSelected();}}else{if(H==D&&F&&(F.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT||F.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER)){var G=document.getElementById("docEditTextArea");G&&G.onblur&&G.onblur();}}};B(D);B(A);this.prevSelectedId=A;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocImpl.prototype.onnotifydrag=function(H,K,G){try{if(this.parentBone.isEditableViewModeEplus()){if(K.id==this.id){this.dockMask=this.getMask();this.dockMask.style.display="block";this.dockMask.style.zIndex="101";var A=microstrategy.eventManager.source;this.mouseoffsetLeft=(A.mousedownX-getObjSumLeft(this.elem)+this.parentBone.elem.scrollLeft)-this.selections.range.left;this.mouseoffsetTop=(A.mousedownY-getObjSumTop(this.elem)+this.parentBone.elem.scrollTop)-this.selections.range.top;this.dockMask.style.width=(getClientWidth()-getObjSumLeftScrolled(this.elem))+"px";var M=this.findFirstVerticalNonCollapsedSubMask();if(M){var I=function(O,N,P){O.setAttribute(microstrategy.HTMLATTR_HEIGHT,N);O.style.height=N+P+"px";};var B=M.getAttribute("id");if(B&&B.indexOf("table")!=-1){if(M.rows&&M.rows[0]){var L=M.rows[0];for(var F=0;F<L.cells.length;F++){var E=L.cells[F].firstChild;I(E,getObjHeight(E),Math.max(this.mouseoffsetTop,0));}}}else{I(M,getObjHeight(M),this.mouseoffsetTop);}}this.resizedSubMaskOnDrag=M;microstrategy.eventManager.notifyOrphanBones("ondocobjectdrag",H,this.mouseoffsetLeft,this.mouseoffsetTop);var J=document.getElementById("maskDiv");if(J){J.style.display="block";}}else{if(K.type==microstrategy.OBJTYPE_OBJBROWSER&&bIsIE6){var D=","+G.toString()+",";if(D.indexOf(","+microstrategy.DSSTYPE_RPT_DEFINITION+",")>-1){for(var B in this.sections){if(this.sections[B].isDetails){this.sections[B].setCursor("not-allowed");}}}}}this.selections.onnotifydrag(H,K,G);}}catch(C){microstrategy.errors.log(C);return false;}};mstrDocImpl.prototype.ondocumentclick=function(e){try{if(
/*bIsIE6 && */
this.textEditor!=null&&this.textEditor.onblur!=null){var src=getEventTarget(e);if(src.getAttribute("id")!="docEditTextArea"){this.textEditor.blur(e);}}}catch(err){microstrategy.errors.log(err);}};mstrDocImpl.prototype.onnotifydragend=function(D){try{if(D!=null&&D.id==this.id&&this.parentBone.isEditableViewModeEplus()){this.docMask=this.getMask();var F=this.resizedSubMaskOnDrag;if(F){var H=F.getAttribute("id");var B=F.getAttribute(microstrategy.HTMLATTR_HEIGHT)+"px";if(H&&H.indexOf("table")!=-1){F=F.rows[0];if(F&&F.cells){for(var A=0;A<F.cells.length;A++){var G=F.cells[A].firstChild;G.style.height=G.getAttribute(microstrategy.HTMLATTR_HEIGHT)+"px";}}}else{F.style.height=B;}}this.docMask.style.zIndex="-1";this.docMask.style.display="none";var E=document.getElementById("maskDiv");if(E){E.style.display="none";}}else{for(var H in this.sections){if(this.sections[H].isDetails){this.sections[H].setCursor("");}}}this.resizedSubMaskOnDrag=null;this.selections.onnotifydragend(D);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.onpanelchange=function(){try{if(this.selections){this.selections.onpanelchange();}}catch(A){microstrategy.errors.log(A);}};mstrDocImpl.prototype.findFirstVerticalNonCollapsedSubMask=function(){try{var A=null;for(var B=0;B<this.dockMask.childNodes.length;B++){var A=this.docMask.childNodes[B];var D=A.getAttribute("id");if(D&&D.indexOf("table")>-1){return A;}if(D&&D!="maskDiv"&&A.getAttribute("isCollapsed")!="true"){return A;}}}catch(C){microstrategy.errors.log(C);}return null;};mstrDocImpl.prototype.addPanelMask=function(B){try{if(this.docMaskCollection==null){return ;}var A=microstrategy.findAncestorWithAtt(B.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION).getAttribute("id");for(var C=0;C<B.sibs.length;C++){this.addMask(A,C,B.sibs[C],0);}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.onPanelDeleted=function(D){try{if(this.docMaskCollection==null){return ;}var A=document.getElementsByName(D+"_mask");for(var B=0;B<A.length;B++){A[B].parentNode.removeChild(A[B]);}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.resizeSubMask=function(B,A,G,F){try{if(this.docMaskCollection==null){return ;}var E=this.docMaskCollection[B][A];for(var C=0;C<E.length;C++){E[C].onmaskedobjectresize(G,F);}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.hideSubMask=function(B,A,D){try{if(this.docMaskCollection==null){return ;}var F=this.docMaskCollection[B][A];for(var C=0;C<F.length;C++){F[C].toggleMaskHilite(D);}}catch(E){microstrategy.errors.log(E);}};mstrDocImpl.prototype.resizeSubMaskForSib=function(C,B,E,A,F){try{if(this.docMaskCollection==null){return ;}this.docMaskCollection[C][B][A].onmaskedobjectresizeForSib(E,A,F);}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.hideSubMaskForSib=function(C,B,D,A){try{if(this.docMaskCollection==null){return ;}this.docMaskCollection[C][B][A].toggleMaskHiliteForSib(D,A);}catch(E){microstrategy.errors.log(E);}};mstrDocImpl.prototype.resizeSubMaskForHorizontalContainer=function(A,F,E){try{if(this.docMaskHorizontalCollection==null){return ;}var D=this.docMaskHorizontalCollection[A];for(var B=0;B<D.length;B++){D[B].onmaskedobjectresize(F,E);}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.hideSubMaskForHorizontalContainer=function(A,C){try{if(this.docMaskHorizontalCollection==null){return ;}var E=this.docMaskHorizontalCollection[A];for(var B=0;B<E.length;B++){E[B].toggleMaskHilite(C);}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.getSubMask=function(B,A,F){try{if(this.docMaskCollection!=null){var E=this.docMaskCollection[B][A];for(var C=0;C<E.length;C++){if(E[C].img==F||E[C].imgMap==F.parentNode){return E[C];}}}}catch(D){microstrategy.errors.log(D);}return null;};mstrDocImpl.prototype.getSubMaskBone=function(C,B,A){try{if(this.docMaskCollection!=null){return this.docMaskCollection[C][B][A];}}catch(D){microstrategy.errors.log(D);}return null;};mstrDocImpl.prototype.resetMask=function(){try{if(this.docMask){this.docMask.innerHTML="";}this.docMask=null;this.docMaskCollection=null;this.docMaskHorizontalCollection=null;this.docMask=this.getMask();this.docMask.style.display="none";}catch(A){microstrategy.errors.log(A);}};mstrDocImpl.prototype.getMask=function(){try{if(!this.docMask){this.docMask=document.getElementById("docMask");this.docMask.style.position="absolute";this.docMaskCollection={};this.docMaskHorizontalCollection={};var secCollection=microstrategy.objectListFind(this.elem,"div",microstrategy.OBJTYPE_DOC_SECTION);if(secCollection&&this.docMask.childNodes.length<1){var secTitleHeight;if(secCollection[0]){secTitleHeight=getObjHeight(microstrategy.subObjectFind(secCollection[0],"div",microstrategy.SUBOBJTYPE_TITLEBAR));}for(var i=0;i<secCollection.length;i++){var secId=secCollection[i].getAttribute("id");if(!this.docMaskCollection[secId]){this.docMaskCollection[secId]={};}var subCollection=microstrategy.objectListFind(secCollection[i],"div",microstrategy.OBJTYPE_DOC_SUBSECTION);for(var j=0;j<subCollection.length;j++){this.addMask(secId,j,subCollection[j],secTitleHeight);}}}with(this.docMask.style){position="absolute";left=getObjLeft(this.elem)+"px";top=getObjTop(this.elem)+"px";}}return this.docMask;}catch(err){microstrategy.errors.log(err);return null;}};mstrDocImpl.prototype.addMask=function(O,H,W,L){try{var S=microstrategy.findBone(W);var I=S.id;var X=false;var G=0,R=0,D=0,U=0;var K=function(Z,c,Y){var a=microstrategy.subObjectFind(Z,"div",microstrategy["SUBOBJTYPE_"+Y]);return(a&&window["getObj"+c](a))||0;};if(!this.docMaskCollection[O][I]){this.docMaskCollection[O][I]=[];G=K(S.parentBone.elem,"Height","SUBSECTION_HANDLE");}var T;if(S.isFilterPanel){T=new mstrFilterPanelMaskImpl(O,I,H);}else{T=new mstrSubSectionMaskImpl(O,I,H);}T.parentBone=this;T.path=this.path+".getSubMask('"+O+"', '"+I+"', this)";this.docMaskCollection[O][I].push(T);var V,P,C;if(S.isHorizontal){V=microstrategy.findAncestorWithAtt(W,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);P=microstrategy.findBone(V);T.horizontalBone=P;T.sibIndex=H;C=P.id;var F=this.docMaskHorizontalCollection[C]||[];F.push(T);this.docMaskHorizontalCollection[C]=F;if(!X){R=K(V.parentNode,"Height","SUBSECTION_HANDLE");D=K(S.parentBone.elem,"Width","TITLEBAR");U=K(S.parentBone.elem,"Width","SUBSECTION_HANDLE");X=true;}}S.maskArea=W;T.onload(S);var A=function(Y){T.elem.style.height=parseInt(T.elem.style.height)+Y+"px";T.topOffset=Y;};if(H>0||S.isHorizontal){A((S.isHorizontal)?R:G);}if(H==0&&!S.isHorizontal){A(L);}if(S.isHorizontal){var B,J;if(S.isBeginHorizontalSib(H)&&!microstrategy.findChildWithAtt(this.docMask,"table","id","table_"+C)){var Q=document.createElement("table");Q.setAttribute("id","table_"+C);Q.setAttribute("height",P.height+"px");Q.style.tableLayout="auto";Q.cellSpacing=0;Q.cellPadding=0;B=Q.insertRow(Q.rows.length);J=B.insertCell(B.cells.length);B.setAttribute("id","tr_"+C);J.appendChild(T.elem);this.docMask.appendChild(Q);}else{B=document.getElementById("tr_"+C);J=B.insertCell(B.cells.length);J.appendChild(T.elem);}if(S.isEndHorizontalSib(H)){J.style.width="100%";}T.leftOffset=(H==0)?D:U;if(!S.isEndHorizontalSib(H)){var N=parseInt(T.elem.style.width),M=T.leftOffset;T.elem.style.width=(isNaN(N)?M:(N+M))+"px";}}else{this.docMask.appendChild(T.elem);}}catch(E){microstrategy.errors.log(E);}};mstrDocImpl.prototype.getMaskFromPoint=function(A,H){try{if(this.docMask){var G={left:A,top:H,right:A+1,bottom:H+1};for(var D=0,C=this.docMask.childNodes.length;D<C;D++){var B=this.docMask.childNodes[D];if(B.nodeType==1&&B.getAttribute("id")!="maskDiv"){var F=microstrategy.getRect(B);if(microstrategy.doRectsIntersect(G,F)){return B;}}}}}catch(E){microstrategy.errors.log(E);}return null;};mstrDocImpl.prototype.appendToTextField=function(F,C,K){try{if(!C){return ;}var J=!!K;K=K||[];var B=C.getAttribute("id");var G=document.getElementsByName(B);if(G.length>0){var A=decode(this.styleObj.getAttValue(G[0],microstrategy.HTMLATTR_DSS_FORMULA));if(A.length>0){F=A+" "+F;}var I=this.getTextFieldValues(C,F);if(I.hasChanged){for(var E=0;E<G.length;E++){this.updateSingleTextField(G[E],I.displayValue);}this.styleObj.setAttValue(G[0],microstrategy.HTMLATTR_DSS_FORMULA,I.attributeValue);var H=this.parentBone.updateManager;K.push(H.createActionObject(C,mstrUpdateManager.EDIT_TEXT,this.parentBone.beanPath,["2048012","2048008","2048018"],[B,I.saveValue,mstrUpdateManager.UPDATE_LATER],[B,I.oldValue,mstrUpdateManager.UPDATE_LATER]));}if(!J&&K.length>0){H.add(K);}}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.getAutoTextMacroCode=function(A){try{return{pgNum:"{&PAGE}",totPages:"{&NPAGES}",dateTime:"{&DATETIME}",curUsr:"{&USER}",docName:"{&DOCUMENT}",docDesc:"{&DESCRIPTION}",prjName:"{&PROJECT}",docExecTime:"{&EXECUTIONTIME}",filterDet:"{&FILTERDETAILS}",promptDet:"{&PROMPTDETAILS}",reportDet:"{&REPORTDETAILS}",notes:"{&NOTES}"}[A]||"{&}";}catch(B){microstrategy.errors.log(B);}return"";};mstrDocImpl.prototype.commonRedoUndoCode=function(B,I){try{var u=mstrFormatObject;var K=this.styleObj;var Q=B.cachedArray;var d=B.args;var q=B.elem;var S=(q&&q.getAttribute("id"))||d[0];var L=(q&&{0:q})||null;var m,M,N,O;switch(B.id){case mstrUpdateManager.EDIT_TEXT:N=document.getElementsByName(S);if(N.length>0){var o=this.getTextFieldValues(N[0],d[1]);K.setAttValue(N[0],microstrategy.HTMLATTR_DSS_FORMULA,o.attributeValue);for(m=0,M=N.length;m<M;m++){this.updateSingleTextField(N[m],o.displayValue);}}break;case mstrUpdateManager.MOVE_OBJECT:N=[];var U=(Q.acrossSections==true);if(U){this.deleteItems({0:document.getElementById(S)},false);N=[q];}else{N=document.getElementsByName(S);}for(m=0,M=N.length;m<M;m++){var Z=K.getValue(N[m],"TextDirection")||"0",D=u.decodeValue("left",d[4]),G=u.decodeValue("top",d[3]);if(Z==="0"){N[m].style.left=D;N[m].style.top=G;}else{K.changeVerticalTextPosition(N[m],{x:parseInt(G),y:parseInt(D)});}}if(U){var R=(I=="redo")?Q.newSection:Q.orginalSection;this.addItemsToSubsection(R,q,false);}break;case mstrUpdateManager.EDIT_PROPS:if(B.formatType!=null){microstrategy.formatType=B.formatType;}if(d[d.length-1]){microstrategy.formatType=d[d.length-1];}if(!d[1]){break;}var AA=B.args[1].split(mstrUpdateManager.UNIT_SEPARATOR);S=AA[0];var E=function(a){if(a.charAt(a.length-1)==mstrUpdateManager.ITEM_SEPARATOR){a=a.substr(0,a.length-1);}return a;};var T=this;var P=function(a){T.formatAttribute(L,g,W,false,a);};var F;if(d[1].indexOf("GradientColor")>0){var H=d[1].split(mstrUpdateManager.ITEM_SEPARATOR);var X=function(a){return H[a].split(mstrUpdateManager.UNIT_SEPARATOR)[3];};F=u.decodeValue("backgroundColor",X(0)).slice(1)+","+u.decodeValue("backgroundColor",X(1)).slice(1)+",14,"+X(3)+","+X(4)+","+X(5);}else{if(AA[1]=="Gradient"){F=AA[2];}}if(F){this.formatItems(L,"Gradient",E(F),false);break;}var J=AA[1];var g=u[J][AA[2]][mstrFormatObject.HTML_PROP_NAME];var W=u.decodeValue(g,E(AA[3]));if(J=="FormattingBorder"){var Y,V,z;if(g.indexOf("b3d")>-1){Y=(g=="b3dstyle")?W:K.getAttValue(q,microstrategy.HTMLATTR_BORDER_3D_STYLE);V=parseInt((g=="b3dweight")?W:K.getAttValue(q,microstrategy.HTMLATTR_BORDER_3D_WEIGHT),10);if(parseInt(Y,10)==0){this.turnOffItem3D(q);}else{this.format3DItems(L,Y,V);}}else{if(g.indexOf("Color2")>-1){Y=K.getAttValue(q,microstrategy.HTMLATTR_BORDER_3D_STYLE);if(parseInt(Y,10)>0){this.process3DItemColorSettings(q,[g.slice(0,g.length-6)],[W],K.getAttValue(q,microstrategy.HTMLATTR_BORDER_3D_WEIGHT));}}else{Y=V=z="";if(g.indexOf("Color")>-1){z=W;}else{var A=W.split(" ");V=A[0];Y=A[1];}this.formatItemBorders(L,[g.slice(0,g.length-5)],Y,V,z,false);}}}else{if(J=="FormattingHTML"&&g=="htmlType"){this.formatHTMLType(L,W);}else{if(J=="FormattingHTML"&&(g=="htmlText"||g=="url")){N=document.getElementsByName(S);if(N.length){var o=this.getHTMLFieldValues(N[0],W);K.setAttValue(N[0],microstrategy["HTMLATTR_HTML_"+((g=="htmlText")?"TEXT":"SOURCE")],o.attributeValue);var k=microstrategy["HTML_CONTAINER_TYPE_"+((g=="htmlText")?"HTML":"IFRAME")];for(m=0,M=N.length;m<M;m++){if(K.getAttValue(N[m],microstrategy.HTMLATTR_HTML_TYPE)==k){microstrategy.findRWObjectBone(N[m],"mstrHTMLContainerImpl").updateContents(k,o);}}}}else{if(J=="FormattingView"&&g=="windowState"){var O="restore";if(W==microstrategy.WINDOW_STATE_MINIMIZED){O="minimize";}else{if(W==microstrategy.WINDOW_STATE_MAXIMIXED){O="maximize";}}this[O+"Portal"](L,g,W,false);}else{if(J=="FormattingAppearance"&&g=="title"){this.formatTitle(L,g,W);}else{if(J=="FormattingAppearance"&&g=="name"){P(microstrategy.HTMLATTR_NAME);}else{if(J=="FormattingNavigation"&&g=="isLink"){this.formatIsLink(L,(W==microstrategy.TRUE));}else{if(J=="FormattingNavigation"&&g=="link"){P(microstrategy.HTMLATTR_LINK_HREF);}else{if(J=="FormattingSection"&&g=="keepSectionTogether"){P(microstrategy.HTMLATTR_KEEP_SECTION_TOGETHER);}else{if(J=="FormattingSection"&&g=="repeatSection"){P(microstrategy.HTMLATTR_REPEAT_SECTION);}else{if(J=="FormattingSection"&&g=="repeatHorizontally"){P(microstrategy.HTMLATTR_REPEAT_HORIZONTALLY);}else{if(J=="FormattingSection"&&g=="forceNewPage"){P(microstrategy.HTMLATTR_FORCE_NEW_PAGE);}else{if(J=="FormattingSection"&&g=="expanded"){this.sections[m].toggleSections(W);}else{if(J=="FormattingFont"&&g.indexOf("textDecoration")>-1){var y=(AA[2]=="Underline")?4:8;if(parseInt(AA[3],10)>=0){y=y*-1;}this.formatUnderlineStrikeout(L,"textDecoration",String(y));}else{if(J=="FormattingLine"&&g=="orientation"){this.changeLineOrientation(L,u.encodeValue(g,W));}else{if(J=="FormattingLine"&&(g=="lineColor"||g=="lineStyle"||g=="lineWeight")){var h=K.getAttValue(q,microstrategy.HTMLATTR_BORDER_3D_STYLE);if(I=="redo"||!h||h==0){this.formatLineSetting(L,g,W,false,[]);}else{K.setAttValue(q,u.getAttrNameFromStyle(g),u.encodeValue(g,W));}}else{if(I=="redo"&&J=="FormattingSize"&&(g=="oldHeight"||g=="oldWidth")){P(microstrategy["HTMLATTR_OLD_"+g.substr(3).toUpperCase()]);}else{if((J=="FormattingSize"&&g=="maxHeight"||g=="canShrink"||g=="canGrow")||(J=="FomattingSection"&&g=="hideIfEmpty")){}else{if(J=="FormattingSize"&&(g=="height"||g=="heightMode"||g=="width"||g=="widthMode")){var C;if(Q&&I=="redo"){W=Q.origValue;}if(Q&&(Q.subsectionHeight||Q.subsectionWidth)){var e=(I=="redo")?Q.origValue:Q.cachedOldValue;C=(Q.subsectionWidth)?"Horizontal":"";this.formatSubHeightWidth(L,g,[e[0],e[1],u.decodeValue("canGrow"+C,e[2]),u.decodeValue("canShrink"+C,e[3]),u.decodeValue("hideIfEmpty",e[4])]);}else{C=(g.indexOf("Mode")>-1)?"Mode":"";if(Q&&Q.subType==microstrategy.SUBOBJTYPE_DOC_LINE){this.formatLineLength(L,"length"+C,W,null,Q.performFormatChange);}else{this["formatSize"+C](L,g,W,null,Q&&Q.performFormatChange,(C)?Q.updateLayoutWidth:null);}}}else{this.formatItems(L,g,W,false);}}}}}}}}}}}}}}}}}}}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;break;}}catch(n){microstrategy.errors.log(n);}};mstrDocImpl.prototype.onredo=function(D){var G=microstrategy.formatType;try{var A={0:D.elem};var E=D.cachedArray;this.undoRedoSubSections=[];switch(D.id){case mstrUpdateManager.ADD_PANEL_STACK:case mstrUpdateManager.ADD_TEXT:case mstrUpdateManager.ADD_DATASET_TEMPLATE:case mstrUpdateManager.ADD_TEMPLATE:case mstrUpdateManager.ADD_LINE:case mstrUpdateManager.ADD_SHAPE:case mstrUpdateManager.ADD_IMAGE:case mstrUpdateManager.COPY_OBJECT:case mstrUpdateManager.CTRL_ADD:this.addItemsToSubsection(E.parent,D.elem,false);break;case mstrUpdateManager.PASTE_FROM_CLIPBOARD:for(var F=0;F<E.elements.length;F++){this.addItemsToSubsection(E.parents[F],E.elements[F],false);}break;case mstrUpdateManager.APPLY_CONTROL_DEFAULT:this.parentBone.objProps.applyCtrlDft(E.orgObjs,false);break;case mstrUpdateManager.EDIT_TEXT:case mstrUpdateManager.MOVE_OBJECT:case mstrUpdateManager.EDIT_PROPS:this.commonRedoUndoCode(D,"redo");break;case mstrUpdateManager.REMOVE_OBJECT:this.deleteItems(A,false,E.parent);break;}this.selections.syncUp();this.selections.resetRange(false,null);if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}if(this.undoRedoSubSections.length>0){for(var B in this.undoRedoSubSections){var H=this.undoRedoSubSections[B].bone;var I=this.undoRedoSubSections[B].isTarget;H.wireTargets([],this.parentBone.beanPath,I);}}this.undoRedoSubSections=null;return true;}catch(C){microstrategy.errors.log(C);return false;}finally{microstrategy.formatType=G;}};mstrDocImpl.prototype.onundo=function(E){var J=microstrategy.formatType;try{var A={1:E.elem};var F=E.cachedArray;this.undoRedoSubSections=[];switch(E.id){case mstrUpdateManager.ADD_PANEL_STACK:case mstrUpdateManager.ADD_TEXT:case mstrUpdateManager.ADD_DATASET_TEMPLATE:case mstrUpdateManager.ADD_TEMPLATE:case mstrUpdateManager.ADD_IMAGE:case mstrUpdateManager.ADD_LINE:case mstrUpdateManager.ADD_SHAPE:case mstrUpdateManager.COPY_OBJECT:case mstrUpdateManager.CTRL_ADD:this.deleteItems(A,false,F.parent);break;case mstrUpdateManager.PASTE_FROM_CLIPBOARD:for(var H=0;H<F.elements.length;H++){this.deleteItems({i:F.elements[H]},false,F.parents[H],true);}break;case mstrUpdateManager.APPLY_CONTROL_DEFAULT:var B=F.orgObjs;if(B){for(var H in B){var I=document.getElementsByName(B[H].getAttribute("id"));for(var G=0;G<I.length;G++){I[G].style.cssText=microstrategy.styleObj.getCssText(B[H]);}}}break;case mstrUpdateManager.EDIT_TEXT:case mstrUpdateManager.MOVE_OBJECT:case mstrUpdateManager.EDIT_PROPS:this.commonRedoUndoCode(E,"undo");break;case mstrUpdateManager.REMOVE_OBJECT:this.restoreDeletedItems(F.parent,F.srcObjects);break;}this.selections.syncUp();this.selections.resetRange(false,null);if(this.parentBone.observer){this.parentBone.observer.notifyAll("onselectionchange");}if(this.undoRedoSubSections.length>0){for(var C in this.undoRedoSubSections){var K=this.undoRedoSubSections[C].bone;var L=this.undoRedoSubSections[C].isTarget;K.wireTargets([],this.parentBone.beanPath,L);}}this.undoRedoSubSections=null;return true;}catch(D){microstrategy.errors.log(D);return false;}finally{microstrategy.formatType=J;}};mstrDocImpl.prototype.onwinresize=function(B,A){try{this.syncPosition(B,A);if(this.selections){this.selections.syncUp();}window.setTimeout(function(){iframe.hideWaitPage(true);},mstr.utils.ISIE8?100:0);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.isValidSelectorTarget=function(A){return(A!=null&&A.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&(microstrategy.subObjectType(A)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||microstrategy.subObjectType(A)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||microstrategy.subObjectType(A)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)&&this.standAloneControlKey!=A.id)||this.commands.queryState("isDDIC");};mstrDocImpl.prototype.disableAutowire=function(){this.parentBone.commands.exec("disableAutowire");this.submitControlTargetSelections();};mstrDocImpl.prototype.submitControlTargetSelections=function(){try{if(this.parentBone.autoWire){showMessage({contents:microstrategy.descriptors.getDescriptor("6154"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,zIndex:1001,okEval:"microstrategy.getViewerBone().doc.disableAutowire()",cancelEval:"microstrategy.getViewerBone().doc.selections.clear()",type:mstrMsgBoxImpl.MSG_WARNING});return ;}var J=this.parentBone.updateManager;var D="";var G=this.selections.getItems();var E=true;var I=null;for(var H=0;H<G.length;H++){if(this.isValidSelectorTarget(G[H])){var B=G[H].getAttribute("id");if(I==null){if(microstrategy.subObjectType(G[H])==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){I=B;}}if(E==false){D+=CLIPBOARD_ITEM_SEPARATOR;}else{E=false;}if(this.commands.queryState("isDDIC")){var A=G[H].getAttribute("trxctlkey");D+=A;}else{D+=B;}}}this.selections.clear();var C;if(this.standAloneControlKey){C=microstrategy.bone(this.standAloneControlKey+"_Ctl");if(C){if(C.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){D=I||"";}C.targetKeys=D?D.split(CLIPBOARD_ITEM_SEPARATOR):[];}J.add([J.createActionObject(null,mstrUpdateManager.CTRL_SET_TARGETS,this.parentBone.beanPath,["2048130","2048129","2048116"],[this.standAloneControlKey,"",D],[])]);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&C.isDefinitionComplete()){J.flushAndSubmitChanges();}}else{C=microstrategy.bone("grid_"+this.controlSource);if(C){if(C.controlLinks==null){C.controlLinks={};}var K=this.controlSourceUnitID;if(this.controlSourceUnitID==null||this.controlSourceUnitID==""){K="Metrics";}if(C.controlLinks[K]==null){C.controlLinks[K]={};}C.controlLinks[K].targets=D?D.split(CLIPBOARD_ITEM_SEPARATOR):[];}J.add([J.createActionObject(null,mstrUpdateManager.ADD_CONTROL_TO_GRID,this.parentBone.beanPath,["2048007","2048012","2048001","2048009","2048129","2048116"],[this.controlSource,"",this.controlSourceUnitID,this.controlSourceUnitType,"",D],[])]);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){J.flushAndSubmitChanges();}}this.endControlSelectionMode();}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.onkeydown=function(H){try{var B=this.parentBone;if(!H){H=window.event;}if(this.shouldIgnoreKeyEvent(H)){return true;}if(!mstrStaticDoc.prototype.onkeydown.call(this,H)){return false;}this.isNotConstrained=(H.ctrlKey)?!microstrategy.SNAP_OFF:microstrategy.SNAP_OFF;if(!this.parentBone.isEditableViewModeEplus()){return true;}switch(H.keyCode){case 89:if(H.ctrlKey){this.parentBone.updateManager.redo();return false;}break;case 90:if(H.ctrlKey){this.parentBone.updateManager.undo();return false;}break;case 120:this.parentBone.commands.exec("grid");if(this.parentBone.observer){this.parentBone.observer.notifyAll("onstatechange");}return false;}if(!this.selections){return true;}switch(H.keyCode){case 65:H.cancelBubble=true;if(H.ctrlKey){return this.selections.selectAll(H);}break;case 86:H.cancelBubble=true;if(H.ctrlKey){if(B.IsNavigationDocument){return true;}return this.selections.paste();}break;}if(!this.selections.isActive()||!this.selections.isVisible){return true;}switch(H.keyCode){case 37:case 38:case 39:case 40:if(this.selections.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return false;}var I=true;var M=0,E=0;var A="";if(H.keyCode%2>0){A="e";E=(H.keyCode==37)?-1:1;}else{A="s";M=(H.keyCode==38)?-1:1;}I=(H.shiftKey)?this.selections.resize.resizeItems(A,0,0,E,M,false,this.isNotConstrained):this.selections.nudge(H.keyCode,this.isNotConstrained);if(bIsIE4){H.cancelBubble=!I;}if(bIsFirefox&&I&&H.shiftKey){mstr.utils.Dom.clearBrowserHighlights();}return I;case 46:if(B.IsNavigationDocument){var J=microstrategy.findBone(mstr.$H.firstItem(this.selections.items));if(J&&J.isNavigationBar){return true;}}this.promptDeleteItems(this.selections.items,true);return false;case 66:case 73:case 85:if(H.ctrlKey){H.cancelBubble=true;var D=1;if(H.keyCode==73){D=2;}else{if(H.keyCode==85){D=4;}}var C=this.commands.queryState("fstyle");if(D&C){D=-D;}this.commands.exec("fstyle",D);microstrategy.eventManager.notifyOrphanBones("onselectionchange");return false;}break;case 67:if(H.ctrlKey){if(B.IsNavigationDocument){return true;}return this.selections.copy();}break;case 68:if(H.ctrlKey&&this.selections.firstObjType()==microstrategy.OBJTYPE_DOC_OBJECT){if(B.IsNavigationDocument){return true;}H.cancelBubble=true;this.selections.duplicate();return false;}break;case 75:case 84:if(H.ctrlKey){var G=(H.altKey)?"one":"";G+=(H.keyCode==75)?"back":"front";return this.selections.sendTo(G);}break;case 88:if(H.ctrlKey){if(B.IsNavigationDocument){return true;}this.selections.cut();return false;}break;case 113:if(!this.selections.isMulti()){var L=this.selections.firstItem();var K=microstrategy.subObjectType(L);if(K==microstrategy.SUBOBJTYPE_DOC_TEXT){this.editObj(null,L);return false;}else{if(K==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){var J=microstrategy.findRWObjectBone(L,"mstrHTMLContainerImpl");J.editContents(H);}}}break;}return true;}catch(F){microstrategy.errors.log(F);return false;}};mstrDocImpl.prototype.onkeypress=function(F){try{F=F||window.event;if(this.shouldIgnoreKeyEvent(F)){return true;}if(this.parentBone.isEditableViewModeEplus()){if(!F.ctrlKey&&this.selections.isActive()&&!this.selections.isMulti()){var H=(bIsW3C&&!bIsIE4);var E=(H)?F.charCode:F.keyCode;var D=this.selections.firstItem();var G=this.textEditor;var B=function(K,J,I){if(E==13){K[J](null,I);return false;}else{if(E>=32){K[J](null,I);if(H){G.value+=String.fromCharCode(E);}}}return true;};var A=microstrategy.subObjectType(D);if(A==microstrategy.SUBOBJTYPE_DOC_TEXT){return B(this,"editText",D);}else{if(A==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){return B(microstrategy.findRWObjectBone(D,"mstrHTMLContainerImpl"),"editContents",null);}}}}}catch(C){microstrategy.errors.log(C);}return true;};mstrDocImpl.prototype.initDoc=function(){try{mstrStaticDoc.prototype.initDoc.call(this);window.setTimeout(this.path+".displayPageBreaker();",0);this.initSelection();this.parentBone.elem.onscroll=new Function("e",this.verifiedPath+" { "+this.path+".syncPosition(); }");if(this.parentBone.isEditableViewModeEplus()){var txt=document.createElement("textarea");txt.setAttribute("id","docEditTextArea");with(txt.style){overflow="hidden";position="absolute";zIndex=5;visibility="hidden";padding="0px";left="0px";top="0px";}txt.tabindex=1;txt.onkeydown=new Function("e",this.verifiedPath+" { return "+this.path+".catchEscKey(e); }");this.textEditor=this.elem.appendChild(txt);}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocImpl.prototype.catchEscKey=function(B){try{if(!B){B=window.event;}if(B.keyCode==27){this.saveTextEdit(false);return false;}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocImpl.prototype.initSelection=function(){try{for(var A=0;A<this.elem.childNodes.length;A++){var C=this.elem.childNodes[A];if(C.nodeType==1){if(C.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SELECTION){this.selections=new mstrDocSelectionsImpl();this.selections.parentBone=this;this.selections.elem=C;this.selections.path=this.path+".selections";if(this.selections.onload){this.selections.onload();}break;}}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocImpl.prototype.onSubSectionResize=function(){try{this.updatePageBreaker();return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocImpl.prototype.displayPageBreaker=function(){try{this.showPageBreaker(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||(this.parentBone.dividerOn&&(this.parentBone.isEditableViewModeEplus())));}catch(A){microstrategy.errors.log(A);}};mstrDocImpl.prototype.getNewPosition=function(B,A,G,D,F){try{if(D){B=microstrategy.relativeSnapCoordinate(B,A,G,D,F);}var E=(G)?getObjSumTop(A):getObjSumLeft(A);B-=E;if(B<0){B=0;}return B;}catch(C){microstrategy.errors.log(C);return B;}};mstrDocImpl.updateSectionList=function(D,C,A,B){if(!D[C.id]){D[C.id]={};}D[C.id].bone=C;if(B){A.target=D[C.id].isTarget=true;}else{A.control=true;D[C.id].isTarget=D[C.id].isTarget||false;}};mstrDocImpl.prototype.deleteItems=function(T,N,J,K,O){try{var P=this.parentBone.updateManager;var k=(N)?[]:null;var R="|";var I,a,Z;var M={};var D={control:false,target:false};for(var g in T){var U=T[g].getAttribute("id");R+=U+"|";}for(var g in T){var f=T[g];if(f.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){continue;}var W=microstrategy.subObjectType(f);if(W==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){I=microstrategy.findBone(f);if(I&&I.isGridInCellSelectionMode()){continue;}}this.selections.remove(f,O);var C=value=this.styleObj.getValue(f,"zIndex");var F=J||f.parentNode;var S=this.styleObj.getValue(f,"top");var B=microstrategy.findBone(F);var U=f.getAttribute("id");var L=document.getElementsByName(U);if(B.isFilterPanel){this.docMask=this.getMask();var h=microstrategy.findAncestorWithAtt(F,microstrategy.HTMLATTR_OBJTYPE,"dsec");if(!h&&L[0]){h=microstrategy.findAncestorWithAtt(L[0],microstrategy.HTMLATTR_OBJTYPE,"dsec");}var d=this.getSubMaskBone(h.id,B.id,0);d.updateImageMap();}var V={parent:f.parentNode,srcObjects:[]};switch(W){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:mstrDocImpl.updateSectionList(M,B,D,true);for(a=0;a<L.length;a++){I=microstrategy.bone("grid_"+U+"_"+a);if(I){I.disabled=true;}}break;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:mstrDocImpl.updateSectionList(M,B,D,true);I=microstrategy.findBone(f);if(I&&I.deleteStack){I.deleteStack();}break;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:mstrDocImpl.updateSectionList(M,B,D);I=microstrategy.findBone(f.firstChild);if(I){I.disabled=true;}break;default:var Y=this.findNavigationBar(f);if(Y){Y.onButtonRemoved(f);}break;}for(a=L.length-1;a>=0;a--){V.srcObjects.push(L[a].parentNode.removeChild(L[a]));}var E=this.formattingAttributes[U];if(E){E.deleted=true;}if(N){V.srcObjects.reverse();var A=[mstrUpdateManager.UPDATE_LATER,U];k.push(P.createActionObject(V.srcObjects[V.srcObjects.length-1],mstrUpdateManager.REMOVE_OBJECT,this.parentBone.beanPath,["2048018","2048012"],A,A,V));}}this.updatePanelCM(B);if(B&&B.isFilterPanel){var d=this.getSubMaskBone(h.id,B.id,0);var c=mstrFormatObject;if(d.adjustZIndex(null,U,true)){var m=d.getMoveItems();var H=parseInt(S);for(var a=0;a<m.length;a++){var e=m[a];k=this.formatItems(microstrategy.createAssociativeArray(e.item),"zIndex",e.zIndex,false,k||[]);var X=mstrFilterPanelMaskImpl.ITEM_SPA,Q=H;moveObjTo(e.item,X,Q);var V={acrossSections:false};k.push(P.createActionObject(e.item,mstrUpdateManager.MOVE_OBJECT,this.parentBone.beanPath,["2048018","2048012","2048007","2048010","2048011"],[mstrUpdateManager.UPDATE_LATER,e.item.id,B.id,c.encodeValue("top",Q),c.encodeValue("left",X)],[mstrUpdateManager.UPDATE_LATER,e.item.id,B.id,c.encodeValue("top",this.styleObj.getValue(e.item,"top")),c.encodeValue("left",this.styleObj.getValue(e.item,"left"))],V));H+=getObjHeight(e.item)+mstrFilterPanelMaskImpl.ITEM_SPA;}}}else{if(B&&B.isNavigationBar){B.parentBone.postRemoveButtons(k);}}microstrategy.eventManager.notifyOrphanBones("onbonedeleted",R);if((D.control||D.target)&&this.parentBone.autoWire&&this.undoRedoSubSections!=null){for(var U in M){this.undoRedoSubSections.push(M[U]);}}if(N&&k&&k.length>0){P.add(k,K);}return true;}catch(G){microstrategy.errors.log(G);return false;}};mstrDocImpl.prototype.addObj=function(A,K,L,F,V,M){try{var P=(V!=null);V=V||[];var G=this.parentBone.updateManager;var T=microstrategy.getFormatObject();var N={};var O=parseInt(Math.max(A,0));var H=parseInt(K)+this.parentBone.elem.scrollTop;var J=true;var C=null;if(!F.length){F=[F];}for(var Q=0;Q<F.length;Q++){C=new mstrObjectInfoImpl(F[Q]);C.height=C.width="";C.left=O;C.top=H;if(M!=null){C.left=microstrategy.snapCoordinate(C.left,0,!M);C.top=microstrategy.snapCoordinate(C.top,0,!M);O=C.left;}var S="";var I=F[Q].getAttribute("ds");J=true;switch(C.dssType){case microstrategy.DSSTYPE_FILTER:if(C.dssSubType!=microstrategy.DSSTYPE_CUSTOM_GROUP){J=false;break;}case microstrategy.DSSTYPE_METRIC:S=microstrategy.SUBOBJTYPE_DOC_TEXT;if(!C.isUnique){I="{["+C.dSetName+"]:["+I+"]}";}else{I="{["+I+"]}";}break;case microstrategy.DSSTYPE_USER_SUMMARY_METRIC:case microstrategy.DSSTYPE_USER_METRIC:case microstrategy.DSSTYPE_ATTRIBUTE:case microstrategy.DSSTYPE_CONSOLIDATION:S=microstrategy.SUBOBJTYPE_DOC_TEXT;I="{["+I+"]}";break;case microstrategy.DSSTYPE_ATTRIBUTE_FORM:S=microstrategy.SUBOBJTYPE_DOC_TEXT;var R="";var E=findTargetTag(F[Q],"UL");if(E){var D=findTargetTag(E,"LI");if(D){if(D.getElementsByTagName("span")[0]){R=D.getElementsByTagName("span")[0].getAttribute(microstrategy.HTMLATTR_DESCRIPTION);}}}R="["+R+"]";I="["+I+"]";I="{"+R+"@"+I+"}";break;default:J=false;break;}if(J){var U=this.addItem(I,L,S,C,V);N.parent=U.parentNode;V.push(G.createActionObject(U,mstrUpdateManager.ADD_TEXT,this.parentBone.beanPath,["2048018","2048012","2048020","2048007","2048008","2048010","2048011","2048100","2048099","2048241"],[mstrUpdateManager.UPDATE_LATER,U.getAttribute("id"),this.styleObj.getAttValue(U,microstrategy.HTMLATTR_NAME),L.id,I,T.encodeValue("top",C.top),T.encodeValue("left",C.left),String(this.styleObj.getValue(U,"zIndex")),T.encodeValue("textAlign",U.style.textAlign),"true"],[],N));if(this.parentBone.defaultInsertMode==mstrDocImpl.INSERT_MODE.HIDE_OTHERS||(!this.parentBone.defaultInsertMode&&this.visibleCurOnly)){this.formatAttribute([U],"visibility","0",false,microstrategy.HTMLATTR_VISIBLE,V,true);this.formatAttribute([U],"visibility","-1",false,microstrategy.HTMLATTR_VISIBLE,V,false);}O+=getObjWidth(U)+10;}}if(!P&&V.length>0){G.add(V);}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.getContentHeight=function(E){try{var F=E.elem;if(!F){return 0;}var A=0;var C;for(var B=0;B<F.childNodes.length;B++){var H=F.childNodes[B];if(H.nodeType!=1){continue;}if(H.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var G=microstrategy.styleObj.getAttValue(H,microstrategy.HTMLATTR_HEIGHT_MODE);if(!G||G!=microstrategy.HUNDRED_PERCENT_MODE){C=parseInt(microstrategy.styleObj.getValue(H,"top"))+getObjHeight(H);}if(C>A){A=C;}}}return A;}catch(D){microstrategy.errors.log(D);return 0;}};mstrDocImpl.prototype.addCtrl=function(Z,R,I,H,c,a,e){try{var U=(I!=null);if(!U){I=[];}var m=this.parentBone.updateManager;var AH=microstrategy.getFormatObject();var J=this.styleObj;var k={};var y=microstrategy.findBone(R);var d=new mstrObjectInfoImpl(null);if(!H){H=this.currentControl;}var x=this.currentControlSubtype;var o=(H==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&x=="R");if(H==microstrategy.GRAPH_CTL){H=microstrategy.SUBOBJTYPE_DOC_TEMPLATE;d.viewMode=2;}if(H==microstrategy.BUTTON_CTL){H=microstrategy.SUBOBJTYPE_DOC_TEXT;}if(Z){d.left=Z.left-getObjSumLeft(R);if(bIsW3C){d.left+=this.parentBone.elem.scrollLeft;}d.top=Z.top-getObjSumTop(R)+this.parentBone.elem.scrollTop;d.height=(Z.bottom)?Z.bottom-Z.top:null;d.width=(Z.right)?Z.right-Z.left:null;if(x=="FP"){d.height=(d.height==null)?625:d.height;d.width=(d.width==null)?145:d.width;}else{if(this.isDocButtonType(H,x)){var A=mstrButton.BUTTON_DEFAULT_SIZES[x];if(A){d.width=d.width==null?A.w:d.width;d.height=d.height==null?A.h:d.height;}}}}else{d.top=this.getContentHeight(y);d.height=null;var F=false;if(H==microstrategy.SUBOBJTYPE_DOC_WIDGET){var AK=this.currentControlSubtype.split(";");if(AK[0]=="com.microstrategy.web.vf.viewer.DatePickerApplicationViewer"||AK[0]=="com.microstrategy.web.vf.viewer.FishEyeApplicationViewer"){resize=false;}else{resize=true;}}else{resize=H==microstrategy.SUBOBJTYPE_DOC_TEMPLATE||H==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||H==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||H==microstrategy.SUBOBJTYPE_DOC_IMAGE;}if(resize){d.height=getObjHeight(y.elem)-d.top;if(d.height<=0){d.height=null;}}d.width=getObjWidth(y.elem);if(y.isFilterPanel){d.width-=4;d.top+=2;d.left=2;}}if(e!=null){d.left=microstrategy.snapCoordinate(d.left,0,!e);d.top=microstrategy.snapCoordinate(d.top,0,!e);if(d.width){d.width=microstrategy.snapCoordinate(d.width,0,!e);}if(d.height){d.height=microstrategy.snapCoordinate(d.height,0,!e);}}var AE={isWidget:false,className:"",rslPath:"",title:"",previewImage:"",isApp:"false",scope:microstrategy.SUBOBJTYPE_DOC_TEMPLATE,defaultDHTMLStyle:0};switch(H){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:if(a!=null){if(a.dssSubType){d.dssSubType=a.dssSubType;}if(a.dataSetName){d.dSetName=a.dataSetName;}}break;case microstrategy.SUBOBJTYPE_DOC_WIDGET:var AK=this.currentControlSubtype.split(";");AE.isWidget=true;if(AK.length>1){AE.className=AK[0];AE.rslPath=AK[1];AE.title=AK[2];AE.previewImage=AK[3];if(AK.length>4){AE.isApp=AK[4];}if(AK.length>5){AE.scope=AK[5];}if(AK.length>6){AE.defaultDHTMLStyle=AK[6];}H=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL;}else{var q=microstrategy.getViewerBone().gridWidgets.lst;var p=q[AK];if(p){AE.gridWidget=p;AE.widgetId=AK[0];if(p.wgt){AE.className=p.wgt.cn;AE.rslPath=p.wgt.rsl;AE.title=p.t;AE.previewImage=p.wgt.img;AE.isApp=p.wgt.ia;AE.scope=p.wgt.scp;AE.defaultDHTMLStyle=p.wgt.sty;}}H=microstrategy.SUBOBJTYPE_DOC_TEMPLATE;}if(H==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){a={widgetName:AE.title,widgetPreviewSrc:AE.previewImage,widgetClass:AE.className,widgetRSL:AE.rslPath,widgetIsApp:AE.isApp};}else{if(H==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.currentControlSubtype=AE.defaultDHTMLStyle;x=this.currentControlSubtype;}}}if(R.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL&&x==="TC"){showMessage({contents:microstrategy.descriptors.getDescriptor("11959"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return null;}if(this.isAddToFilterPanel(R)&&H!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){showMessage({contents:microstrategy.descriptors.getDescriptor("9512"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return null;}var X=null;switch(H){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:if(this.isAddToDetailsSection(R)){return null;}X=document.createElement("div");X.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrGridRW");X.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_GRID_TABLE);X.style.position="relative";X.appendChild(mstrTemplateImpl.buildEmptyTemplate("r-",false));break;case microstrategy.SUBOBJTYPE_DOC_TEXT:X=(c&&c.length>0)?c:"";break;case microstrategy.SUBOBJTYPE_DOC_IMAGE:if(!d.height){d.height=30;}if(!d.width){d.width=28;}X=document.createElement("img");break;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:if(this.isAddToDetailsSection(R)){return null;}X=document.createElement("div");break;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:if(this.isAddToDetailsSection(R)){return null;}case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_SHAPE:X="";break;case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:X=document.createElement("div");break;default:X=H;break;}var Y=this.addItem(X,y,H,d,I,a);var n=Y.getAttribute("id");k.parent=Y.parentNode;var AB=this.parentBone.beanPath;if(!d.height){d.height=getObjHeight(Y);}if(!d.width){d.width=getObjWidth(Y);}var B=J.getAttValue(Y,microstrategy.HTMLATTR_NAME);var AL=function(){var f=["ClassName","Enable"];var AM=[AE.className,"-1"];if(AE.rslPath&&AE.rslPath.length){f.push("RSLPath");AM.push(AE.rslPath);}if(AE.isApp&&AE.isApp.length>0){f.push("IsApp");AM.push(AE.isApp);}I.push(m.createEditPropsAction(Y,n,AB,f,AM));};var V=AH.encodeValue("top",d.top);var AI=AH.encodeValue("left",d.left);var C=AH.encodeValue("width",d.width);var Q=AH.encodeValue("height",d.height);var M=J.getValue(Y,"zIndex");var AD,T;var O=this;var AJ=function(f){if(O.parentBone.defaultInsertMode==mstrDocImpl.INSERT_MODE.HIDE_OTHERS||(!O.parentBone.defaultInsertMode&&O.visibleCurOnly)){O.formatAttribute([f],"visibility","0",false,microstrategy.HTMLATTR_VISIBLE,I,true);O.formatAttribute([f],"visibility","-1",false,microstrategy.HTMLATTR_VISIBLE,I,false);}};if(H==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var h=J.getAttValue(Y,microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL)==microstrategy.TRUE,K=Y.lastChild.lastChild.firstChild.getAttribute("id");var AC=m.createActionObject(Y,mstrUpdateManager.ADD_PANEL_STACK,AB,["2048007","2048012","2048117","2048010","2048011","2048100","2048043","2048042","2048018","2048020","2048241"],[y.id,n,K,V,AI,M,C,Q,mstrUpdateManager.UPDATE_LATER,B,"true"],[],k);if(!h){I.push(AC);}else{microstrategy.updateManager.add([AC]);}if(h){this.formatAttribute([Y],"UseAsTableControl",microstrategy.TRUE,false,microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL,I,true);this.formatAttribute([Y],"showTitleBar",microstrategy.FALSE,false,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,I,true);this.formatItems([Y],"backgroundColor","#C5CCD4",false,I);microstrategy.findBone(Y).initNewTable(I,1);m.add([m.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}AJ(Y);if(this.parentBone.autoWire){y.wireTargets(I,AB,true);}if(J.getAttValue(Y,microstrategy.HTMLATTR_USE_AS_FILTER_PANEL)==microstrategy.TRUE){this.formatAttribute([Y],"UseAsFilterPanel",microstrategy.TRUE,false,microstrategy.HTMLATTR_USE_AS_FILTER_PANEL,I);}}else{if(H==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){var g=microstrategy.bone(n+"_Ctl");if(g!=null){var E=g.ctlSrcType?g.ctlSrcType:"";this.selections.syncUp(null,I);this.selections.finishAddAllObjs(microstrategy.createAssociativeArray(Y),I);I.push(m.createActionObject(Y,mstrUpdateManager.CTRL_ADD,AB,["2048010","2048011","2048100","2048043","2048042","2048007","2048012","2048113","2048129","2048114","2048115","2048116","2048119","2048120","2048121","2048125","2048020","2048139","2048241"],[V,AI,M,C,Q,y.id,n,g.ctlType,"",g.ctlSrcId,E,g.targetKeys,g.ctlStyle,g.multiSelect?"1":"0",g.ctlOrientation,g.showAll?"1":"0",B,((g.autoSync)?"1":"0"),"true"],[],k));AJ(Y);g.initDefaultFormats(I);if(AE.isWidget){AL();J.setAttValue(Y,"twc",AE.className);J.setAttValue(Y,"rsl",AE.rslPath);J.setAttValue(Y,"iap",AE.isApp);}if(this.isAddToFilterPanel(R)){O.formatAttribute([Y],"showElementCount",microstrategy.TRUE,false,microstrategy.HTMLATTR_CTL_SHOW_ELEMENT_COUNT,I);var S=microstrategy.formatType;microstrategy.formatType=microstrategy.FORMAT_TYPE_CONTROL_TITLE;O.formatAttribute([Y],"showTitleBar",microstrategy.TRUE,false,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,I);microstrategy.formatType=S;}}if(this.parentBone.autoWire&&g.ctlType!=mstrRWControlImpl.CTL_TYPE_PANEL_STACK){y.wireTargets(I,AB);}}else{if(H==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var W=false;AD=["2048012","2048007","2048010","2048011","2048100","2048042","2048043"];T=[n,y.id,V,AI,M,Q,C];if(a!=null&&a.dataSetID!=null){W=true;AD.push("2048031");T.push(a.dataSetID);if(a.addAsLinked){AD=AD.concat(["2048018","2048158"]);T=T.concat([mstrUpdateManager.UPDATE_LATER,"1"]);}else{if(a.shiftKey&&a.viewMode){var N=(a.viewMode=="3")?"7":a.viewMode;AD=AD.concat(["2048098","2048025","2048018"]);T=T.concat([a.shiftKey,N,mstrUpdateManager.UPDATE_LATER]);}else{AD=AD.concat(["2048098","2048018"]);T=T.concat([a.shiftKey,mstrUpdateManager.UPDATE_LATER]);}}}else{AD=AD.concat(["2048018","2048020","2048025"]);T=T.concat([mstrUpdateManager.UPDATE_LATER,B,(d.viewMode||1)]);}AD=AD.concat(["2048241"]);T=T.concat(["true"]);I.push(m.createActionObject(Y,mstrUpdateManager["ADD_"+((W)?"DATASET_":"")+"TEMPLATE"],AB,AD,T,[],k));AJ(Y);if(!W){if(d.viewMode&&x){I.push(m.createActionObject(Y,mstrUpdateManager.EDIT_GRAPH_PROPS,AB+"."+n,["4082"],[x],[],k));}if(AE.isWidget){this.formatSizeMode({0:Y},"heightMode","0",I,true);this.formatSizeMode({0:Y},"widthMode","0",I,true);this.selections.processWidgetPropertyChanges({widgetId:AE.widgetId,FlashDisplay:AE.gridWidget.wgt!=null,DHTMLDisplay:AE.gridWidget.vis!=null&&AE.gridWidget.vis.vm!==50,iPhoneDisplay:AE.gridWidget.iphVis!=null,iPadDisplay:AE.gridWidget.ipadVis!=null,AndroidDisplay:AE.gridWidget.aVis!=null,AndroidTabletDisplay:AE.gridWidget.atVis!=null},microstrategy.findBone(Y),I,{id:Y});}}if(this.parentBone.autoWire){y.wireTargets(I,AB,true);}}else{AD=["2048018","2048007","2048012","2048020","2048010","2048011","2048100"];T=[mstrUpdateManager.UPDATE_LATER,y.id,n,B,V,AI,M];if(H==microstrategy.SUBOBJTYPE_DOC_LINE){var AA=J.getAttValue(Y,microstrategy.HTMLATTR_ORIENTATION);d[microstrategy.HTMLATTR_ORIENTATION]=AA;evtId=mstrUpdateManager.ADD_LINE;AD.push("2048061");T.push(AA);if(AA==microstrategy.ORIENTATION_HORIZONTAL){AD.push("2048043");T.push(C);}else{if(AA==microstrategy.ORIENTATION_VERTICAL){AD.push("2048042");T.push(Q);}}}else{AD.push("2048043");AD.push("2048042");T.push(C);T.push(Q);switch(H){case microstrategy.SUBOBJTYPE_DOC_TEXT:evtId=mstrUpdateManager.ADD_TEXT;var z=J.getAttValue(Y,microstrategy.HTMLATTR_DSS_FORMULA);if(z==null){z="";}AD.splice(2,0,"2048008");T.splice(2,0,z);break;case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:evtId=mstrUpdateManager.ADD_HTML_CONTAINER;AD.push("2048161");T.push(J.getAttValue(Y,microstrategy.HTMLATTR_HTML_TYPE));break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:evtId=mstrUpdateManager.ADD_SHAPE;AD.push("2048067");T.push((x=="1")?"5":"2");break;case microstrategy.SUBOBJTYPE_DOC_IMAGE:this.selections.syncUp(null,I);this.selections.finishAddAllObjs(microstrategy.createAssociativeArray(Y),I);evtId=mstrUpdateManager.ADD_IMAGE;AD.splice(1,0,"2048019");T.splice(1,0,"dummy url");AD[8]="2048042";AD[9]="2048043";var P=function(f){return AH.encodeValue(f,Y.getAttribute(microstrategy["HTMLATTR_D"+f.toUpperCase()]));};T.splice(5,5,P("top"),P("left"),M,P("height"),P("width"));break;}}if(evtId){AD.splice(0,0,"2048241");T.splice(0,0,"true");I.push(m.createActionObject(Y,evtId,AB,AD,T,[],k));AJ(Y);}if(H==microstrategy.SUBOBJTYPE_DOC_SHAPE){if(x=="1"){this.selections.syncUp(null,I);this.selections.finishAddAllObjs(microstrategy.createAssociativeArray(Y),I);}}else{if(H==microstrategy.SUBOBJTYPE_DOC_IMAGE){this.selections.addingCtrl=microstrategy.SUBOBJTYPE_DOC_IMAGE;this.commands.exec("addImg");}}}}}mstr.controllers.EventManager.notifyListenersOfId(Y.id,{name:"Add",ac:I,update:false,item:Y});mstr.controllers.EventManager.notifyListenersOfId(R.id,{name:"ChildAdded",ac:I,item:Y});if(o){var u=microstrategy.findBone(Y);if(u){u.onLinkDataset();}}if(this.isInsertMode&&this.currentControl==microstrategy.GRAPH_CTL){var D="activeViewID="+n+"&boneID=grid_"+n+"&zoomFactor="+microstrategy.ZOOM_FACTOR;if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){D+="&graphHeight="+d.height+"&graphWidth="+d.width;var G=n.replace("_graph",""),L=G.lastIndexOf("_"),AF=(L===-1)?null:G.substr(L+1);if(AF!=null){D+="&sliceIndex="+AF;}}I.push(m.createActionObject(null,mstrUpdateManager.SHOW_BEAN,microstrategy.servletName+"."+microstrategy.pageName,["5017","5018"],[true,"edtGraphDropZones"],[]));m.addURL(D);}if(U){return I;}m.add(I);}catch(AG){microstrategy.errors.log(AG);return I;}};mstrDocImpl.prototype.getLinkedVisualization=function(A){if(this.parentBone&&this.parentBone.widgets){for(var D=0;D<this.parentBone.widgets.length;D++){var C=this.parentBone.widgets[D];if(C.rslPath==A&&C.scope==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){if(C.isVis){var B=this.parentBone.widgets[D].id;if(B=="FisheyeWidget"){return"visFishEye";}else{return"vis"+B;}}break;}}}return null;};mstrDocImpl.prototype.isAddToDetailsSection=function(B){try{if(B.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)&&B.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)==microstrategy.TRUE){showMessage({contents:microstrategy.descriptors.getDescriptor("4813"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});return true;}}catch(A){microstrategy.errors.log(A);}return false;};mstrDocImpl.prototype.isAddToFilterPanel=function(C){try{if(C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL){var B=microstrategy.findBone(C);if(B&&B.isFilterPanel){return true;}}}catch(A){microstrategy.errors.log(A);}return false;};mstrDocImpl.prototype.createTitleBar=function(K,C,G){try{var A=this.selections.isSelectorControlSelected()||(G&&(G.isSelector||G.isSelectorControl));var I=document.createElement("div");I.className="portal";I.id=C;I.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrPortalImpl");I.setAttribute("sty","ctitl");I.style.height=microstrategy.WINDOW_TITLE_HEIGHT+"px";I.style.position="relative";I=this.parentBone.objProps.initObjectFormat(I,true,A?microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:microstrategy.SUBOBJTYPE_DOC_TEMPLATE,A?mstrRWControlImpl.FMT_TYPE_TITLE:mstrGridReport.FMT_TYPE_TITLE);var O=document.createElement("table");I.appendChild(O);O.border=0;O.cellSpacing=0;O.cellPadding=0;O.className="pane";var H=O.insertRow(O.rows.length);var E=null;var M=null;var N="mstrIcon-btn mstrIcon-btn";var J=microstrategy.descriptors;if(this.parentBone.isInteractiveViewModeEplus()&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&G&&!G.isSelector){E=H.insertCell(H.cells.length);E.className="portalTitleBarZoomTD";M=this.createImageTag(J.getDescriptor("5567"),N+"Find","btnFind");M.onclick=new Function("var b = microstrategy.bone('"+G.boneId+"'); if(b) b.drillOutToFixedTemplate('"+G.objKey+"','"+G.treeType+"','"+G.displayMode+"');");E.appendChild(M);}E=H.insertCell(H.cells.length);E.className="portalTitleBarTD";var D=document.createElement("div");D.className="portalTitleBar";D.setAttribute("id","titleBar");D.setAttribute("name","titleBar");if(K){var B=document.createTextNode(K);D.appendChild(B);}E.appendChild(D);E=H.insertCell(H.cells.length);E.className="portalTitleBarButtonsTD";var L=document.createElement("span");L.className="portalTitleBarButtons";E.appendChild(L);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&G){M=this.createImageTag(J.getDescriptor("4161"),N+"Menu","localDataMenu_"+G.boneId);M.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"wBtn");L.appendChild(M);}if(G&&!G.isSelector){M=this.createImageTag(J.getDescriptor("4539"),N+"Minimize","minimize");M.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"wBtn");L.appendChild(M);M=this.createImageTag(J.getDescriptor("4540"),N+"Restore","restore");M.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"wBtn");M.style.display="none";L.appendChild(M);M=this.createImageTag(J.getDescriptor("4541"),N+"Maximize","maximize");M.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"wBtn");L.appendChild(M);M=this.createImageTag(J.getDescriptor("629"),N+"Close","delete");M.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,"wBtn");L.appendChild(M);}return I;}catch(F){microstrategy.errors.log(F);return false;}};mstrDocImpl.prototype.createImageTag=function(D,A,E){try{var C=document.createElement("img");C.className=A;C.setAttribute("id",E);C.setAttribute("title",D);C.setAttribute("src",microstrategy.IMG_SRC_TRANSPARENT);return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocImpl.prototype.setStubImage=function(B){if(B!=null){var A=(B.getElementsByTagName("img"))[0];if(A!=null){A.setAttribute("src","");}this.styleObj.setAttValue(B,microstrategy.HTMLATTR_IMAGE_SOURCE,"");}this.stubImage=B;};mstrDocImpl.prototype.addNewImage=function(H,J){try{var A=this.styleObj;var D={parent:H.parentNode};this.selections.remove(H);var E=null;if(!bIsIE6){var B=microstrategy.findBone(H.parentNode);var F=new mstrObjectInfoImpl(null);var G=function(K){F[K]=parseInt(A.getValue(H,K),10);};G("left");G("top");G("height");G("width");this.commands.exec("deleteStubImg");E=this.addItem(document.createElement("img"),B,microstrategy.SUBOBJTYPE_DOC_IMAGE,F);}else{E=H.cloneNode(true);this.commands.exec("deleteStubImg");E=this.addItemsToSubsection(D.parent,E,true);}A.cloneAttValues(H,E);this.selections.add(E);var I=function(K){return mstrFormatObject.encodeValue(K,E.getAttribute(microstrategy["HTMLATTR_D"+K.toUpperCase()]));};J.push(this.parentBone.updateManager.createActionObject(E,mstrUpdateManager.ADD_IMAGE,this.parentBone.beanPath,["2048018","2048019","2048007","2048012","2048020","2048010","2048011","2048100","2048042","2048043","2048295","2048241"],[mstrUpdateManager.UPDATE_LATER,"dummy url",E.getAttribute(microstrategy.HTMLATTR_SECTION_ID),E.getAttribute(microstrategy.HTMLATTR_ID),A.getAttValue(E,microstrategy.HTMLATTR_NAME),I("top"),I("left"),A.getValue(E,"zIndex"),I("height"),I("width"),"true"],[],mstr.Enum.IMAGE_URL_TYPE.DUMMY_URL,D));if(this.parentBone.defaultInsertMode==mstr.Enum.INSERT_MODE.HIDE_OTHERS||(this.visibleCurOnly&&!this.parentBone.defaultInsertMode)){this.formatAttribute([E],"visibility","0",false,microstrategy.HTMLATTR_VISIBLE,J,true);this.formatAttribute([E],"visibility","-1",false,microstrategy.HTMLATTR_VISIBLE,J,false);}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.autoSizeImages=function(L,S,P,V,E){try{if(P){this.items=P;}var C=false;var M=this.parentBone.updateManager;if(this.items){for(var U in this.items){var A=this.items[U];if(microstrategy.subObjectType(A)==microstrategy.SUBOBJTYPE_DOC_IMAGE){var K=document.getElementsByName(A.getAttribute("id")+"_img");var D=K[0];if(D&&(D.readyState=="complete"||D.complete)){if(S){if(!V||V==null){V=this.parentBone.updateManager.getLastAction();C=true;}}D.style.width="auto";D.style.height="auto";var B=mstr.utils.BoxModel;if(this.adjustImageSizeFlag){this.adjustImageSizeFlag=false;var O=B.getElementInnerWidth(D.parentNode.parentNode);var W=B.getElementInnerHeight(D.parentNode.parentNode)-parseInt(microstrategy.styleObj.getValue(D.parentNode,"top"));var F=B.getElementOuterWidth(D);var N=B.getElementOuterHeight(D);var I=F/N;if(N>W||F>O){var Q=W/N;var R=O/F;if(Q>R){F=O;N=F/I;}else{N=W;F=N*I;}D.style.width=F+"px";D.style.height=N+"px";}}this.formatSizeMode({0:A},"widthMode","0",V,false);this.formatSizeMode({0:A},"heightMode","0",V,false);var T=getObjHeight(D),J=getObjWidth(D);this.formatSize({0:A},"height",""+T,V);this.formatSize({0:A},"width",""+J,V);if(E){this.formatAttribute([A],"height",""+mstrFormatObject.encodeValue("height",T),false,microstrategy.HTMLATTR_HEIGHT,V,true);this.formatAttribute([A],"width",""+mstrFormatObject.encodeValue("width",J),false,microstrategy.HTMLATTR_WIDTH,V,true);}if(C){this.parentBone.updateManager.add(V);}}else{if(L<10){var H=this;window.setTimeout(function(){H.autoSizeImages(L+1,S);},50);}else{this.adjustImageSizeFlag=false;}}}}this.selections.resizeSubSection(false,V);this.selections.resetRange(false,V);this.selections.syncUp();}}catch(G){microstrategy.errors.log(G);}};mstrDocImpl.prototype.editText=function(H,A){try{var C=this.styleObj;var D=this.textEditor;var L="";A=microstrategy.findAncestor(A);var J=microstrategy.HTMLATTR_DSS_FORMULA;var I=false;var O=microstrategy.subObjectType(A);var N=this.styleObj.getValue(A,"TextDirection")||"0";if(O==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){if(C.getAttValue(A,microstrategy.HTMLATTR_HTML_TYPE)==microstrategy.HTML_CONTAINER_TYPE_HTML){J=microstrategy.HTMLATTR_HTML_TEXT;}else{J=microstrategy.HTMLATTR_HTML_SOURCE;I=true;}}if(this.isDocButton(A)){var B=C.getAttValue(A,microstrategy.HTMLATTR_DISPLAY_STYLE);if(B==microstrategy.BUTTON_STYLE_ICON_ONLY||B==microstrategy.BUTTON_STYLE_CUSTOM){return ;}}L=C.getAttValue(A,J);if(!L&&I){L="http://";}if(L==null){L="";}L=L.replace(/\\n/g,"\r\n");L=decode(L,true);D.source=A;var K=function(P){var Q=(P)?microstrategy.findAncestorWithAtt(A.parentNode,microstrategy.HTMLATTR_OBJTYPE,P):A;var R=C.getValue(Q,"backgroundColor");return(R&&R.toLowerCase()!="transparent")?R:null;};var G=K()||K(microstrategy.OBJTYPE_DOC_SUBSECTION)||K(microstrategy.OBJTYPE_DOC);D.style.backgroundColor=(G!=null&&G.length>0&&G.toLowerCase()!="transparent")?G:"#ffffff";D.style.width=C.getValue(A,"width");D.style.height=C.getValue(A,"height");var F=function(R,S){var Q=R.toLowerCase();var P=parseFloat(C.getValue(A,"border"+R+"Width"));if(Q==="top"&&N==="90"&&!bIsDXIE){D.style[Q]=(window["getObjSum"+R](A)-S[Q]+((!isNaN(P))?P:0))-A.offsetWidth+"px";}else{D.style[Q]=(window["getObjSum"+R](A)-S[Q]+((!isNaN(P))?P:0))+"px";}};F("Top",this);F("Left",this);D.style.paddingTop=C.getValue(A,"paddingTop");D.style.paddingRight=C.getValue(A,"paddingRight");D.style.paddingBottom=C.getValue(A,"paddingBottom");D.style.paddingLeft=C.getValue(A,"paddingLeft");D.style.color=C.getValue(A,"color");D.style.textAlign=C.getValue(A,"textAlign");D.style.fontFamily=C.getValue(A,"fontFamily");D.style.fontSize=C.getValue(A,"fontSize");D.style.fontWeight=C.getValue(A,"fontWeight");D.style.fontStyle=C.getValue(A,"fontStyle");D.style.textDecoration=C.getValue(A,"textDecoration");if(C.getValue(A,"whiteSpace")=="nowrap"){D.setAttribute("wrap","off");}else{D.removeAttribute("wrap");}D.style.borderWidth="0px";D.style.visibility="visible";D.style.zIndex=(""+C.getValue(A,"zIndex")+1);D.onblur=new Function(this.verifiedPath+" { "+this.path+".saveTextEdit(true); }");D.value=L;if(this.isDocButton(A)){var M=microstrategy.findBone(A);if(M){M.onEditText(D,A);}}microstrategy.setCursorToEnd(D);D=null;}catch(E){microstrategy.errors.log(E);}};mstrDocImpl.prototype.editObj=function(C,D){try{switch(microstrategy.subObjectType(D)){case microstrategy.SUBOBJTYPE_DOC_TEXT:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:if(this.parentBone.isEditableViewModeEplus()){if(this.isDocButton(D)){var B=microstrategy.findBone(D);B.editContents(C,D);break;}this.editText(C,D);}break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:break;default:this.commands.exec("edtPropsTabSelected",0);break;}}catch(A){microstrategy.errors.log(A);return false;}};mstrDocImpl.prototype.saveTextEdit=function(M){try{var E=this.textEditor,B=E.source;E.onblur=null;E.style.visibility="hidden";E.style.top=E.style.left="0px";if(this.isDocButton(B)){var P=microstrategy.findBone(B);if(P){P.postEditText(E,B);}}if(M){var J=(microstrategy.subObjectType(B)==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER)?"HTML_CONTAINER":"Text";var N=this["get"+J.replace("_CONTAINER","")+"FieldValues"](B,E.value);if(N.hasChanged){var H=document.getElementsByName(B.getAttribute("id"));if(H&&H.length>0){var I=this.parentBone.updateManager;var Q=[];var O;var C=B.getAttribute("id");var A=this.parentBone.beanPath;var L=microstrategy["SUBOBJTYPE_DOC_"+J.toUpperCase()];if(L==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){var D;if(this.styleObj.getAttValue(B,microstrategy.HTMLATTR_HTML_TYPE)==microstrategy.HTML_CONTAINER_TYPE_HTML){var K=/^(&nbsp;|\s)*http:\/\//i;if(N.attributeValue&&N.attributeValue.search(K)!=-1){this.styleObj.setAttValue(H[0],microstrategy.HTMLATTR_HTML_TYPE,microstrategy.HTML_CONTAINER_TYPE_IFRAME);Q.push(I.createEditPropsAction(H[0],C,A,["htmlType"],[microstrategy.HTML_CONTAINER_TYPE_IFRAME],[microstrategy.HTML_CONTAINER_TYPE_HTML]));O=microstrategy.HTMLATTR_HTML_SOURCE;D="url";}else{O=microstrategy.HTMLATTR_HTML_TEXT;D="htmlText";}}else{O=microstrategy.HTMLATTR_HTML_SOURCE;D="url";}evtId=mstrUpdateManager.EDIT_PROPS;Q.push(I.createEditPropsAction(H[0],C,A,[D],[N.saveValue],[N.oldValue]));}else{O=microstrategy.HTMLATTR_DSS_FORMULA;Q.push(I.createActionObject(H[0],mstrUpdateManager.EDIT_TEXT,A,["2048012","2048008","2048018"],[C,N.saveValue,mstrUpdateManager.UPDATE_LATER],[C,N.oldValue,mstrUpdateManager.UPDATE_LATER]));}this.styleObj.setAttValue(H[0],O,N.attributeValue);for(var G=0;G<H.length;G++){if(L==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){microstrategy.findRWObjectBone(H[G],"mstrHTMLContainerImpl").updateContents(this.styleObj.getAttValue(H[G],microstrategy.HTMLATTR_HTML_TYPE),N);}else{this.updateSingleTextField(H[G],N.displayValue);}}this.selections.syncUp(B);this.selections.resizeSubSection(false,Q);I.add(Q);}}}E.value="";if(bIsW3C&&!bIsIE4){E.blur();}}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.getTextFieldValues=function(G,B){try{var C=this.styleObj;var I={};I.oldValue=decode(C.getAttValue(G,microstrategy.HTMLATTR_DSS_FORMULA),true);I.saveValue=B;I.hasChanged=(I.oldValue!=I.saveValue);I.attributeValue=encode(I.saveValue,true);I.displayValue=I.attributeValue.replace(/\r?\n/g,"<br />");if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){var E=(C.getAttValue(G,microstrategy.HTMLATTR_IS_LINK)==microstrategy.TRUE);var A=(E)?C.getAttValue(G,microstrategy.HTMLATTR_LINK_HREFVALUE):"";var H=I.saveValue.toLowerCase();var D=H.indexOf("<a");if(D>-1&&H.indexOf("href=",D)>-1&&E&&(A==null||A.length==0)){D=H.indexOf(">",D)+1;var J=H.indexOf("</a",D);if(J!=-1){I.displayValue=I.saveValue.substring(D,J);}else{I.displayValue=I.saveValue.substring(D);}I.displayValue=encode(I.displayValue,true);I.displayValue=I.displayValue.replace(/\r\n/g,"<br />");}}return I;}catch(F){microstrategy.errors.log(F);return null;}};mstrDocImpl.prototype.openReplaceObjectEditor=function(A,I,C,E){var H=this,J="mstrReconReplaceEditor",F=null,B=function(L){if(!F){F=mstrmojo.all[J]||mstrmojo.insert({scriptClass:"mstrmojo.vi.ui.ReplaceObjectEditor",id:J});}F.setUnits({source:L.source,target:L.target});var K=function(M,N){var R={actions:[{act:"applyReconciliation",clr_af:N,members:M}],style:{name:"RWIVEMojoStyle"}};if(C.ReplaceAllDS){for(var O in E){M.unshift({srcid:O,srct:3,tgtid:L.target.did,tgtt:3});}}else{M.unshift({srcid:L.source.did,srct:3,tgtid:L.target.did,tgtt:3});}var P=microstrategy.getViewerBone(),Q={taskId:"mojoRWManipulation",style:"RWIVEMojoStyle",messageID:P.messageID,stateID:-1,params:JSON.stringify(R),rwb:document.getElementsByName("rwb")[0].value};mstr.$XHR.request(mstrConfig.taskURL,Q,{success:function(T){var S=microstrategy.updateManager;S.add([S.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);S.flushAndSubmitChanges();},failure:function(S){mstrmojo.alert(S);}});};F.onOk=K;F.onClose=function(){F.tooltip&&F.tooltip.hideTooltip();F.destroy();};F.open();};var G=function G(L){var K=[].concat(L.att.concat(L.mx));mstr.$A.forEach(K,function(M){if(M.hc){M.cont_did=L.did;M.cont_tp=L.type;}});return mstr.$A.filter(K,{umCheck:function(M){return !M.um;}},"umCheck");};var D=G(I);B({source:A,target:{did:I.did,units:D},});};mstrDocImpl.prototype.getTargetDataSet=function(C,A,H){var D=this,B=H.oldDSID,G=H.items[0].did||H.items[0].dssid,F=C[G],E={did:B,units:A};if(F){F=mstr.$H.clone(F);F.did=G;D.openReplaceObjectEditor(E,F,H,C);}else{mstr.$XHR.request(mstrConfig.taskURL,{taskId:"mojoGetReportWorkingSet",reportId:G},{success:function(I){D.openReplaceObjectEditor(E,I,H,C);},failure:function(I){mstrmojo.alert(I);}});}};mstrDocImpl.prototype.getManifest=function(E){var C=this,D=microstrategy.getViewerBone(),B=D.datasetInfos,G=E.oldDSID,F={taskId:"mojoGetDocumentManifest",style:"RWIVEMojoStyle",messageID:D.messageID,stateID:-1,rwb:""},A=function(I){var J=[],H=1;for(var K in J){var L=J[K];mstr.$A.forEach(I,function(M){if(H===parseInt(M,10)){J.push(L);}});H++;}return J;};if(G){F.dsid=G;}mstr.$XHR.request(mstrConfig.taskURL,F,{success:function(J){var H=[],L={},I={};for(var K in B){var M=B[K];mstr.$A.forEach(M.att.concat(M.mx),function(N){L[N.did]=N;});}J.manifest_objects.forEach(function(O){var N=L[O.did];if(N){O.cubes=A(O.cube_ids||[]);for(var P in N){O[P]=N[P];}H.push(O);I[O.did]=O;}});J.manifest_objects.forEach(function(N){if(N.dependents){N.dependentObjects=[];N.dependents.forEach(function(O){N.dependentObjects.push(I[O]);});}});getSortedDatasetUnits=function(N){var O=function O(P){return P.t===4?2:1;};N=N.concat();N.sort(function(S,Q){var T=O(S)-O(Q),R=S.n.toUpperCase(),P=Q.n.toUpperCase();return T!==0?T:(R!==P?R.localeCompare(P):S.n.localeCompare(Q.n));});return N;};H=getSortedDatasetUnits(H);C.getTargetDataSet(B,H,E);},failure:function(H){mstrmojo.alert(H);}});};mstrDocImpl.prototype.handleDatasetExplorer=function(C){if(C.ReplaceAllDS||(C.oldDSID&&C.oldDSID.length>0)){var J=this,L=function(){var N={success:function(O){if(O){J.getManifest(C);}else{if(mstrApp.onSessionExpired){mstrApp.onSessionExpired();}}}},M={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,N,M);};var B=function(){microstrategy.cssLoader.get("vi-base-themes.css",true,L);};var I=function(){microstrategy.mojoLoader.loadWidget({bundle:"mojo-dre.js",callback:B});};microstrategy.descriptorsLoader.loadDescriptors({bundle:"mojo-dre",callback:I});return ;}try{var G=microstrategy.updateManager;var E=C.items;var A="";var H="";for(var F=0;F<E.length;F++){A+=H+(E[F].dssid||E[F].did);H=mstrUpdateManager.ITEM_SEPARATOR;}var K=[];for(F=0;F<E.length;F++){K.push(E[F].dssid||E[F].did);}microstrategy.getCubesInfo(K,function(M){if(C.oldDSID&&C.oldDSID.length>0||C.ReplaceAllDS){var Q=E[0],O=Q.tp||Q.t,N=Q.dssid||Q.did,P=M[N];G.add([G.createActionObject(null,mstrUpdateManager.RW_REPLACE_DATASET,mstrUpdateManager.applyChangesBeanPath,["2048216","2048217","2048218","2048219","2048018"],[microstrategy.getViewerBone().hasMultiDatasets()?C.oldDSID:"",N,C.oldDSType,O,mstrUpdateManager.UPDATE_LATER],[],null)]);}else{var O=(E[0].tp||E[0].t);G.add([G.createActionObject(null,mstrUpdateManager.RW_ADD_DATASET,mstrUpdateManager.applyChangesBeanPath,["2048032","2048033","2048018"],[A,O,mstrUpdateManager.UPDATE_LATER],[],null)]);}G.add([G.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);G.flushAndSubmitChanges();});}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.getHTMLFieldValues=function(G,F){try{var E=this.styleObj;var A={};if(F==null){F="";}var B=(E.getAttValue(G,microstrategy.HTMLATTR_HTML_TYPE)==microstrategy.HTML_CONTAINER_TYPE_HTML)?"TEXT":"SOURCE";var C=decode(E.getAttValue(G,microstrategy["HTMLATTR_HTML_"+B]),true);if(C==null){C="";}A.oldValue=C;A.saveValue=F;A.hasChanged=(A.oldValue!=A.saveValue);A.attributeValue=encode(A.saveValue,true);A.displayValue=A.attributeValue.replace(/\r\n/g,"<br />");return A;}catch(D){microstrategy.errors.log(D);return null;}};mstrDocImpl.prototype.addItem=function(U,z,AD,g,H,B){try{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;var AE,M,q,h;var I=this.styleObj;var y=this.currentControlSubtype;var Z=AD==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&y==microstrategy.CONTROLSUBTYPE_NAVIGATION_BAR;var R=(AD==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK)&&(y=="TC");var m=microstrategy.OBJ_PREFIX+this.parentBone.getNextObjId();if(z.parentBone.isCollapsed){z.parentBone.toggleSections(1);}var N=document.createElement("span");N.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_OBJECT);N.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,AD);N.setAttribute("id",m);N.setAttribute("name",m);if(AD==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&this.currentControlSubtype=="FP"){I.setAttValue(N,microstrategy.HTMLATTR_NAME,microstrategy.descriptors.getDescriptor("2550")+m.substr(m.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length));}else{if(R){I.setAttValue(N,microstrategy.HTMLATTR_NAME,"Table Control"+m.substr(m.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length));}else{if(Z){I.setAttValue(N,microstrategy.HTMLATTR_NAME,microstrategy.descriptors.getDescriptor("8145")+m.substr(m.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length));}else{if(this.isDocButtonType(AD,y)){I.setAttValue(N,microstrategy.HTMLATTR_NAME,microstrategy.descriptors.getDescriptor("6457")+m.substr(m.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length));}else{I.setAttValue(N,microstrategy.HTMLATTR_NAME,this.getName(AD,m));}}}}N.className="object";if(g.dssId){N.setAttribute(microstrategy.HTMLATTR_DSS_ID,g.dssId);}if(g.dssType){N.setAttribute(microstrategy.HTMLATTR_DSS_TYPE,g.dssType);}if(g.dSetId){N.setAttribute(microstrategy.HTMLATTR_DSS_SET,g.dSetId);}N.style.position="absolute";N.style.overflow="hidden";N.style.left=g.left+"px";N.style.top=g.top+"px";mstr.utils.Dom.setBGIconClass(N,"1ptrans");if(AD==microstrategy.SUBOBJTYPE_DOC_LINE&&g[microstrategy.HTMLATTR_ORIENTATION]!=null){I.setAttValue(N,microstrategy.HTMLATTR_ORIENTATION,g[microstrategy.HTMLATTR_ORIENTATION]);}if(AD==microstrategy.SUBOBJTYPE_DOC_SHAPE&&(this.currentControlSubtype=="1")){I.setAttValue(N,microstrategy.HTMLATTR_STYLE,microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);}N=this.parentBone.objProps.initObjectFormat(N,true);if(R){var AI=microstrategy.getFormatObject();N.style.width="318px";microstrategy.styleObj.setAttValue(N,AI.getAttrNameFromStyle("width"),AI.encodeValue("width","320px"));}if(z.isFilterPanel&&this.currentControlSubtype==mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER){var P=84,J=parseInt(N.style.height,10);if(J<P){var V=microstrategy.getFormatObject(),AC="height";I.setAttValue(N,V.getAttrNameFromStyle(AC),V.encodeValue(AC,P));I.setValue(N,AC,P+"px");}}if(AD==microstrategy.SUBOBJTYPE_DOC_TEXT){I.setAttValue(N,microstrategy.HTMLATTR_DSS_FORMULA,U);U=encode(U);N.innerHTML=U;}else{if(typeof (U)=="string"){U=document.createTextNode(U);}if(AD==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A;if(I.getAttValue(N,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE){A=this.createTitleBar(g.dSetName);N.appendChild(A);}}N.appendChild(U);}I.setAttValue(N,microstrategy.HTMLATTR_OBJTYPE,AD);if(AD==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){N.style.overflow="visible";}if(g.width!=null&&!isNaN(parseInt(g.width,10))){I.setValue(N,"width",g.width+"px");}if(g.height!=null&&!isNaN(parseInt(g.height,10))){I.setValue(N,"height",g.height+"px");}if(g.dssType==microstrategy.DSSTYPE_METRIC||g.dssType==microstrategy.DSSTYPE_USER_METRIC||g.dssType==microstrategy.DSSTYPE_USER_SUMMARY_METRIC){N.style.textAlign="right";}switch(AD){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:N.setAttribute(microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,"0");N.setAttribute(microstrategy.HTMLATTR_WINDOW_STATE,"0");break;case microstrategy.SUBOBJTYPE_DOC_LINE:this.fixLineItem(N,AD);g.width=N.style.width;g.height=N.style.height;break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:this.fixShapeItem(N);break;case microstrategy.SUBOBJTYPE_DOC_IMAGE:N.getElementsByTagName("IMG")[0].setAttribute("id",m+"_img");N.getElementsByTagName("IMG")[0].setAttribute("name",m+"_img");I.setAttValue(N,microstrategy.HTMLATTR_HEIGHT,mstrFormatObject.encodeValue("height",g.height));I.setAttValue(N,microstrategy.HTMLATTR_WIDTH,mstrFormatObject.encodeValue("width",g.width));I.setAttValue(N,microstrategy.HTMLATTR_LOCK_ASPECT_RATIO,microstrategy.TRUE);N.setAttribute(microstrategy.HTMLATTR_SECTION_ID,z.id);N.setAttribute(microstrategy.HTMLATTR_DTOP,g.top);N.setAttribute(microstrategy.HTMLATTR_DLEFT,g.left);N.setAttribute(microstrategy.HTMLATTR_DHEIGHT,g.height);N.setAttribute(microstrategy.HTMLATTR_DWIDTH,g.width);break;}N.style.zIndex=z.maxZindex++;z.setNeedToUpdateMaxContentHeight(true);if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&(AD==microstrategy.SUBOBJTYPE_DOC_TEXT||AD==microstrategy.SUBOBJTYPE_DOC_IMAGE||AD==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||AD==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||AD==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)){var S=(!N.style.borderWidth||parseInt(N.style.borderWidth)==0);if(S){N.style.border=microstrategy.DESIGNMODE_NOBORDER_STYLE;}I.setAttValue(N,microstrategy.HTMLATTR_BORDER,microstrategy[((S)?"NO":"HAS")+"_BORDER"]);var n=this;var X=function(c){if(g[c]){I.setValue(N,c,n.removePaddingAndBorder(N,g[c],c)+"px");}else{if(S){N.style[c]=Math.max(parseInt(N.style[c])-2,0)+"px";}}};if(this.isDocButtonType(AD,y)){var D=I.getAttValue(N,microstrategy.HTMLATTR_WIDTH);var AB=I.getAttValue(N,microstrategy.HTMLATTR_HEIGHT);X("width");X("height");I.setAttValue(N,microstrategy.HTMLATTR_WIDTH,D);I.setAttValue(N,microstrategy.HTMLATTR_HEIGHT,AB);}else{X("width");X("height");}}var k=N.firstChild;switch(AD){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:var Y=N.cloneNode(true);var u=microstrategy.subObjectFind(Y,"div",microstrategy.SUBOBJTYPE_GRID_TABLE);var AL=microstrategy.findChildWithAtt(Y,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrPortalImpl");var K=true;if(g&&g.dssSubType){K=(g.dssSubType==microstrategy.DSSTYPE_GRID||g.dssSubType==microstrategy.DSSTYPE_GRID_AND_GRAPH);}var a=(B!=null&&"widgetName" in B);I.setAttValue(Y,"twc",((a)?B.widgetClass:"None"));I.setAttValue(Y,"rsl",(a)?B.widgetRSL:"");I.setAttValue(Y,"iap",(a)?B.widgetIsApp:false);for(AE=0;AE<z.sibs.length;AE++){var e="grid_"+m+"_"+AE;Y.setAttribute(microstrategy.HTMLATTR_APPLIES_TO,e);u.setAttribute("id",e);var AH="portal_"+e;if(AL){AL.setAttribute("id",AH);AL.setAttribute("name",AH);}z.sibs[AE].appendChild(Y.cloneNode(true));if(AL){var W=microstrategy.registerBone(AH,"(true)",null);W.onload();}M=microstrategy.registerBone(e,"(true)",null);M.beanPath=this.parentBone.beanPath+"."+m;M.gridCellCssPrefix=this.parentBone.gridCellCssPrefix;M.isGraph=(g&&(g.dssSubType==microstrategy.DSSTYPE_GRAPH||g.dssSubType==microstrategy.DSSTYPE_GRID_AND_GRAPH));M.isGrid=K;M.isWidget=a;M.widgetDescription=(a)?B.widgetName:null;M.widgetPreviewSrc=(a)?B.widgetPreviewSrc:null;M.dSetName=(g.dSetName)?g.dSetName:"";M.onload();M.onpostload();if(AL){M.updatePortalTitle();}}break;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:var o="mstrPanelStack";if(y==microstrategy.CONTROLSUBTYPE_NAVIGATION_BAR){o="mstrNavigationBar";}else{if(y=="TC"){o="mstrTableControl";}}N.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,o);N.className+=" panelStack";var AA=N.appendChild(document.createElement("div"));AA.setAttribute("id",m+"_content");AA.style.position="absolute";if(bIsIE7){AA.style.position="relative";window.setTimeout(function(){var c=document.getElementById(m+"_content");if(c){c.style.position="absolute";}},0);}AA.style.overflow="hidden";AA.style.width="100%";var x=AA.appendChild(document.createElement("div"));x.className="title_"+m;x.setAttribute("id",m+"_toolbar");x.setAttribute("name",m+"_toolbar");x.style.height=microstrategy.WINDOW_TITLE_HEIGHT+"px";x=this.parentBone.objProps.initObjectFormat(x,true,microstrategy.subObjectType(N),mstrPanelStack.FMT_TYPE_TITLE);mstr.utils.Dom.setBGIconClass(x,"1ptrans");var O=document.createElement("table");x.appendChild(O);O.className="pane";O.cellSpacing=0;O.cellPadding=0;O.style.height="100%";var AJ=O.insertRow(-1);var C=AJ.insertCell(-1);C.className="titleTD";var p=C.appendChild(document.createElement("div"));p.setAttribute("id","titleBar");p.setAttribute("name","titleBar");p.className="titleBar";var AK=AA.appendChild(document.createElement("div"));AK.setAttribute("id",m+"_container");AK.setAttribute("name",m+"_container");AK.className="panels";AK.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_PANEL_CONTAINER);AK.appendChild(this.createPanel());for(AE=0;AE<z.sibs.length;AE++){z.sibs[AE].appendChild(N.cloneNode(true));}insertDynamicScript(o+"Script",javaScriptPath+o+".js");var AG=null;if(this.currentControlSubtype=="FP"){I.setAttValue(N,microstrategy.HTMLATTR_USE_AS_FILTER_PANEL,microstrategy.TRUE);}else{if(Z){I.setAttValue(N,microstrategy.HTMLATTR_USE_AS_NAVIGATION_BAR,microstrategy.TRUE);}else{if(this.currentControlSubtype=="TC"){I.setAttValue(N,microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL,microstrategy.TRUE);I.setAttValue(N,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,microstrategy.FALSE);AG={def:"",fmt:""};}}}M=microstrategy.registerBone(m,o+"Script",AG);M.onload();M.onpostload();break;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:q=m+"_Ctl";k.setAttribute("id",q);k.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrRWControlImpl");k.setAttribute("name",q);I.setAttValue(N,microstrategy.HTMLATTR_STYLE,this.currentControlSubtype);insertDynamicScript("mstrRWControlImplScript",javaScriptPath+"mstrRWControlImpl.js");var Q=this.getSelectorOrientation(g,z);for(AE=0;AE<z.sibs.length;AE++){z.sibs[AE].appendChild(N.cloneNode(true));}var T=(y==mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY||y==mstrRWControlImpl.CTL_STYLE_LIST_BOX||y==mstrRWControlImpl.CTL_STYLE_CHECKBOX||y==mstrRWControlImpl.CTL_STYLE_SEARCH_BOX),Q=y==mstrRWControlImpl.CTL_STYLE_METRIC_QUALIFICATION||y==mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER?"1":Q;h=microstrategy.registerBone(q,"mstrRWControlImplScript",{ctlKey:m,ctlType:this.currentControl_SelectorControlType||"1",ctlStyle:this.currentControlSubtype,ctlOrientation:Q,multiSelect:T,showAll:true,autoSync:false});h.onload(B);h.onpostload();h.renderPreview();break;case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:q=m+"_Ctr";k.setAttribute("id",q);k.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrHTMLContainerImpl");k.setAttribute("name",q);insertDynamicScript("mstrHTMLContainerImplScript",javaScriptPath+"mstrHTMLContainerImpl.js");for(AE=0;AE<z.sibs.length;AE++){z.sibs[AE].appendChild(N.cloneNode(true));}h=microstrategy.registerBone(q,"mstrHTMLContainerImplScript",null);h.onload();h.onpostload();break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:var G=(this.currentControlSubtype=="1");if(G){N.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrRoundedRectangle");}I.setAttValue(N,microstrategy.HTMLATTR_ROUNDED_CORNERS,(G)?microstrategy.TRUE:microstrategy.FALSE);for(AE=0;AE<z.sibs.length;AE++){z.sibs[AE].appendChild(N.cloneNode(true));}if(this.currentControlSubtype=="1"){I.setAttValue(N,microstrategy.HTMLATTR_STYLE,microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);insertDynamicScript("mstrRoundedRectangleScript",javaScriptPath+"mstrRoundedRectangle.js");microstrategy.registerBone(m,"mstrRoundedRectangleScript",null).onload();}break;case microstrategy.SUBOBJTYPE_DOC_TEXT:if(this.isDocButtonType(AD,y)){I.setAttValue(N,microstrategy.HTMLATTR_DISPLAY_STYLE,y);N.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrButton");insertDynamicScript("mstrButtonScript",javaScriptPath+"mstrButton.js");mstrButton.initHTML(N);for(AE=0;AE<z.sibs.length;AE++){z.sibs[AE].appendChild(N.cloneNode(true));}microstrategy.registerBone(m,"mstrButtonScript",null).onload();break;}default:for(AE=0;AE<z.sibs.length;AE++){z.sibs[AE].appendChild(N.cloneNode(true));}}var E=N.getAttribute("gradientcolor");if(E){if((N.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&N.getAttribute("scriptclass")!="mstrPanel")||(AD==microstrategy.SUBOBJTYPE_DOC_SHAPE&&N.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){var d=(N.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION)?this.getChildBone(N):microstrategy.bone(N.id);d.applyGradient();}else{var L=document.getElementsByName(N.getAttribute("id"));var F=E.split(",");for(AE=0;AE<L.length;AE++){gradientUtil.applyGradientSettings(L[AE],F,I);}}}this.updatePanelCM(z);return z.sibs[0].lastChild;}catch(AF){microstrategy.errors.log(AF);return false;}};mstrDocImpl.prototype.getSelectorOrientation=function(A,C){var B=this.getOrientationConstraint(C);if(B==null){if(A){if(A.height){if(A.width&&A.width>=A.height){B=mstrRWControlImpl.ORIENTATION_HORIZONTAL;}else{B=mstrRWControlImpl.ORIENTATION_VERTICAL;}}else{if(A.width){B=mstrRWControlImpl.ORIENTATION_HORIZONTAL;}}}}if(B==null){B=mstrRWControlImpl.ORIENTATION_VERTICAL;}return B;};mstrDocImpl.prototype.getOrientationConstraint=function(B){var A=mstrRWControlImpl;switch(this.currentControlSubtype){case A.CTL_STYLE_POOL_DOWN:case A.CTL_STYLE_LIST_BOX:return A.ORIENTATION_VERTICAL;break;case A.CTL_STYLE_CHECKBOX:case A.CTL_STYLE_RADIO_BUTTON:case A.CTL_STYLE_LINK_ARRAY:case A.CTL_STYLE_BUTTON_ARRAY:if(B.isFilterPanel){return A.ORIENTATION_VERTICAL;}break;}return null;};mstrDocImpl.prototype.createPanel=function(){try{var E=document.createElement("div");var A=this.parentBone.getNextObjId();var B=microstrategy.OBJ_PREFIX+A;var F=microstrategy.descriptors.getDescriptor("4780")+A;E.setAttribute("id",B);E.setAttribute("name",B);E.setAttribute(microstrategy.HTMLATTR_NAME,F);E.setAttribute(microstrategy.HTMLATTR_WINDOW_TITLE,F);E.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);E.setAttribute(microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_PANEL);E.setAttribute(microstrategy.HTMLATTR_SCRIPTCLASS,"mstrPanel");E.className+=" panel";this.parentBone.objProps.initObjectFormat(E,true,microstrategy.SUBOBJTYPE_DOC_PANEL);var D=document.createElement("div");D.style.height="100%";E.appendChild(D);return E;}catch(C){microstrategy.errors.log(C);}return null;};mstrDocImpl.prototype.fixLineItem=function(B,A){try{if(A==microstrategy.SUBOBJTYPE_DOC_LINE){var D=parseInt(this.styleObj.getValue(B,"width"))>=parseInt(this.styleObj.getValue(B,"height"))?"HORIZONTAL":"VERTICAL";this.setLineOrientation(B,microstrategy["ORIENTATION_"+D]);}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.fixShapeItem=function(B){try{if(this.currentControlSubtype=="0"){var D=mstrFormatObject;var E=this.styleObj;var A=E.getAttValue(B,"b3dstyle");if(A==null||parseInt(A)==0){B.style.border=(D.decodeValue("lineStyle",E.getAttValue(B,"ls"))||"solid")+" "+(D.decodeValue("lineColor",E.getAttValue(B,"lc")||0))+" "+parseInt(D.decodeValue("lineWeight",E.getAttValue(B,"lw"))||1,10)+"pt";}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.addItemsToSubsection=function(N,V,W,S,X){try{var P;var L={};var F={control:false,target:false};var H=null;if(N){var D=microstrategy.findBone(N);if(W){P=this.parentBone.getNextObjId();V.setAttribute("id",microstrategy.OBJ_PREFIX+P);V.setAttribute("name",microstrategy.OBJ_PREFIX+P);V.style.zIndex=D.maxZindex;}D.maxZindex++;D.setNeedToUpdateMaxContentHeight(true);var K=document.getElementsByName(N.getAttribute("id"));var Q=microstrategy.subObjectType(V);if(Q==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){mstrDocImpl.updateSectionList(L,D,F,true);K[0].appendChild(V);if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){P=V.getAttribute("id");var A=microstrategy.subObjectFind(V,"div",microstrategy.SUBOBJTYPE_GRID_TABLE)||microstrategy.subObjectFind(V,"div",microstrategy.SUBOBJTYPE_DOC_GRAPH_TEMPLATE);if(A!=null){var O=A.getAttribute("id");var C=microstrategy.findChildWithAtt(V,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrPortalImpl");if(W){O="grid_"+P+"_0";var M="portal_"+O;A.setAttribute("id",O);if(S&&this.parentBone.gridItemFormats){this.parentBone.gridItemFormats[P]=this.parentBone.objProps.cloneFormats(this.parentBone.gridItemFormats[S.id]);}if(C){C.setAttribute("id",M);C.setAttribute("name",M);}loadInit("mstrGridRWScript",'microstrategy.registerBone("'+O+'", "(true)", { beanPath : \''+this.parentBone.beanPath+"."+P+"' });");loadInit('mstrGridRWScript && microstrategy.bone("'+O+'") != null','microstrategy.bone("'+O+'").onload();');loadInit('mstrGridRWScript && microstrategy.bone("'+O+'") != null','microstrategy.bone("'+O+'").gridCellCssPrefix = "'+this.parentBone.gridCellCssPrefix+'";');if(C){loadInit("mstrPortalImplScript",'microstrategy.registerBone("'+M+'", "(true)", null);');loadInit('mstrPortalImplScript && microstrategy.bone("'+M+'") != null','microstrategy.bone("'+M+'").onload();');}}else{loadInit('mstrGridRWScript && microstrategy.bone("'+O+'") != null','microstrategy.bone("'+O+'").beanPath = "'+this.parentBone.beanPath+"."+P+'"; microstrategy.bone("'+O+'").onload();');loadInit('mstrGridRWScript && microstrategy.bone("'+O+'") != null','microstrategy.bone("'+O+'").gridCellCssPrefix = "'+this.parentBone.gridCellCssPrefix+'";');}}}this.updatePanelCM(D);this.updatePanelCM(X);H=K[0].lastChild;}else{if(Q==microstrategy.SUBOBJTYPE_DOC_IMAGE){V.getElementsByTagName("IMG")[0].setAttribute("id",V.id+"_img");}var B=null,U=K.length;for(var T=0;T<U;T++){B=V.cloneNode(true);K[T].appendChild(B);}var Y,E;if(Q==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){if(!W){var I=microstrategy.bone(V.id);if(!I.isTable){I.resetElement();I.onload();I.getCurrentPanel().clearContentsMenu();I.getCurrentPanel().updateContentsMenu();mstrDocImpl.updateSectionList(L,D,F,true);}}}else{if(Q==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(W){Y=document.getElementById(V.id);if(S){this.styleObj.cloneAttValues(S,V);E=microstrategy.bone(S.id+"_Ctl");E.initNewUnit(Y);}}else{if(V&&B){var G=V.getElementsByTagName("select");var R=B.getElementsByTagName("select");if(G&&G.length>0&&R&&R.length>0){R[0].selectedIndex=G[0].selectedIndex;}}microstrategy.bone(V.id+"_Ctl").onSectionChange();}mstrDocImpl.updateSectionList(L,D,F);}else{if(Q==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER){if(W){Y=document.getElementById(V.id);if(S){E=microstrategy.bone(S.id+"_Ctr");E.initNewUnit(Y);}}}else{if(Q==microstrategy.SUBOBJTYPE_DOC_SHAPE&&V.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){if(W){Y=document.getElementById(V.id);if(S){this.styleObj.cloneAttValues(S,V);}E=microstrategy.bone(S.id);if(E){E.initNewUnit(Y);}else{this.initRoundedRectangle(V.id);}}}else{if(Q==microstrategy.SUBOBJTYPE_DOC_TEXT&&W&&this.isDocButton(S)){microstrategy.registerBone(V.id,"mstrButtonScript",null).onload();}}}}}this.updatePanelCM(D);this.updatePanelCM(X);H=B;}if((F.control||F.target)&&this.parentBone.autoWire&&this.undoRedoSubSections!=null){for(var P in L){this.undoRedoSubSections.push(L[P]);}}}return H;}catch(J){microstrategy.errors.log(J);return null;}};mstrDocImpl.prototype.updatePanelCM=function(A){if(A&&microstrategy.subObjectType(A.elem)==microstrategy.SUBOBJTYPE_DOC_PANEL){A.updateContentsMenu();}};mstrDocImpl.prototype.restoreDeletedItems=function(F,A){try{var H=document.getElementsByName(F.getAttribute("id"));for(var C=0;C<A.length;C++){var E=A[C];H[C].appendChild(E);if(microstrategy.subObjectType(E)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var B=microstrategy.findBone(E);if(B){B.onload();}}var G=this.formattingAttributes[E.id];G.deleted=false;}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.formatUnderlineStrikeout=function(P,E,R,V){try{var K,B;var M=R.split(",");var N=parseInt(M[0],10);if(M.length==1){if(N&4){K=(N>0);B=-1;}else{K=-1;B=(N>0);}}else{K=((N&4)&&(N>0));N=parseInt(M[1],10);B=((N&8)&&(N>0));}var A="underline";var H="line-through";var F="textDecoration";var D="textDecoration2";for(var T in P){var Q=P[T].getAttribute("id");var L=document.getElementsByName(Q);if(L&&this.checkAppliesTo(P[T],E)){var C=this.styleObj.getValue(P[T],F,microstrategy.formatType);C=C!=undefined?(C.indexOf(A)>-1):false;var U=this.styleObj.getValue(P[T],D,microstrategy.formatType);U=U!=undefined?(U.indexOf(H)>-1):false;if(this.styleObj.doTextDecOnBone(P[T])){var J=microstrategy.findBone(P[T]);C=J[F];C=C!=undefined?(C.indexOf(A)>-1):false;U=J[D];U=U!=undefined?(U.indexOf(H)>-1):false;}var G=(K==-1)?C:K;var W=(B==-1)?U:B;if(V){var O=this.parentBone.updateManager;if(G!=C){V.push(O.createEditPropsAction(L[0],Q,this.parentBone.beanPath,[F],[(G)?A:""],[(C)?A:""]));}if(W!=U){V.push(O.createEditPropsAction(L[0],Q,this.parentBone.beanPath,[D],[(W)?H:""],[(U)?H:""]));}}R="";if(microstrategy.subObjectType(L[0])==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(!(G||W)){R="none";}else{if(G){R+=A;if(W){R+=" ";}}if(W){R+=H;}}}for(var S=0;S<L.length;S++){this.styleObj.setValue(L[S],F,(G)?A:"none");this.styleObj.setValue(L[S],D,(W)?H:"none");if(R&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){this.styleObj.cascadeSelectorValue(L[S],F,R);}}}}}catch(I){microstrategy.errors.log(I);}};mstrDocImpl.prototype.renamePanel=function(){try{var A=microstrategy.bones.msgBox;if(A.getInputValue()&&this.commands.queryEnabled("onepanelstack")){var B=microstrategy.findBone(this.commands.queryState("selectedPanelStack"));if(B){this.formatAttribute({0:B.getCurrentPanel().elem},"windowTitle",A.getInputValue(),true,microstrategy.HTMLATTR_WINDOW_TITLE,null);B.getCurrentPanel().elem.setAttribute("wt",A.getInputValue());microstrategy.eventManager.notifyOrphanBones("onpanelchange");this.parentBone.delay("observer.notifyAll('onselectionchange')");}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatPadding=function(L,C,M,G,O){try{var N=(O!=null);if(G||N){if(!N){O=[];}}var K=microstrategy.getFormatObject(),E=this.styleObj,J=this.parentBone.updateManager,B=this.parentBone.beanPath,H,I,A,M;var D=function(P){return microstrategy.number.toLocaleString(K.encodeValue(C,microstrategy.number.toLocaleString(M)));};mstr.$A.forEach(L,function(P){var Q=P.id;if(!this.checkAppliesTo(P,C)){return ;}H=Q+mstrUpdateManager.UNIT_SEPARATOR+K.getPropertySetName(C)+mstrUpdateManager.UNIT_SEPARATOR+K.getPropertyName(C)+mstrUpdateManager.UNIT_SEPARATOR;A=D(E.getValue(P,C));O.push(J.createActionObject(P,mstrUpdateManager.EDIT_PROPS,B,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,H+D(M)+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,H+A+mstrUpdateManager.ITEM_SEPARATOR]));mstr.$A.forEach(document.getElementsByName(Q),function(R){E.setValue(R,C,M);});},this);if(!N&&G&&O&&O.length>0){J.add(O);}return(N)?O:null;}catch(F){microstrategy.errors.log(F);return(O!=null)?O:false;}};mstrDocImpl.prototype.formatItems=function(L,J,k,Y,H,m){try{var AB=mstrFormatObject;var I=this.styleObj;var Z=this.parentBone.updateManager;var T=(H!=null);if(Y||T){if(!T){H=[];}}var y,d,AC,P,B,O;var Q=microstrategy.formatType;var u=this.parentBone.beanPath;for(var V in L){var e=L[V];var d=microstrategy.subObjectType(e);var M=null;if(this.checkAppliesTo(e,J)){if(d==microstrategy.SUBOBJTYPE_DOC_LINE){var W=I.getAttValue(e,microstrategy.HTMLATTR_ORIENTATION);if((J=="height"&&W==microstrategy.ORIENTATION_HORIZONTAL)||(J=="height"&&W==microstrategy.ORIENTATION_HORIZONTAL)){continue;}}var AD=[];if((J=="backgroundColor"||J=="backgroundStyle"||J=="Gradient")&&d==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){M=microstrategy.findBone(e);if(this.selections.panelUnitFormat==0){if(this.selections.panelValueFormat==0&&Q==microstrategy.FORMAT_TYPE_MAIN){e=M.getCurrentPanel().elem;}AD.push(e);}else{if(M.panels){for(var x=0;x<M.panels.length;x++){AD.push(M.panels[x].elem);}}}}else{AD.push(e);}for(var K in AD){var A=AD[K];var c=A.getAttribute(microstrategy.HTMLATTR_OBJTYPE);d=microstrategy.subObjectType(A);var AF=this.getGradientColor(A,Q);var a=A.getAttribute("id");if(H&&J!="Gradient"&&J!="selectionColor"&&J!="selectionStyle"){if((J!="backgroundColor"&&J!="backgroundStyle")||(AF==null||AF=="")){var AA=k;var U=false;if(J=="paddingLeft"||J=="paddingTop"||J=="paddingBottom"||J=="paddingRight"){AA=microstrategy.number.toLocaleString(k);U=true;}H.push(Z.createEditPropsAction(A,a,u,[J],[AA],[(J=="backgroundStyle")?"transparent":I.getValue(A,J)],null,null,null,U));if(d==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&bIsIE4){var g=microstrategy.findBone(A);if(g&&g.isGraph){H.forceSubmit=true;}}}else{AC=a+mstrUpdateManager.UNIT_SEPARATOR+AB.getPropertySetName(J)+mstrUpdateManager.UNIT_SEPARATOR+AB.getPropertyName(J)+mstrUpdateManager.UNIT_SEPARATOR;P=(J=="backgroundColor")?a+mstrUpdateManager.UNIT_SEPARATOR+"Gradient"+mstrUpdateManager.UNIT_SEPARATOR:AC;B=AF;if(J=="backgroundStyle"){B="gradient";}H.push(Z.createActionObject(A,mstrUpdateManager.EDIT_PROPS,u,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,AC+AB.encodeValue(J,k)+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,P+B+mstrUpdateManager.ITEM_SEPARATOR]));}}var E=J;if(J=="backgroundStyle"&&k=="transparent"&&I.getValue(A,"backgroundColor")=="transparent"&&AF==null){E="backgroundColor";}var N=document.getElementsByName(a);if(E=="backgroundColor"&&Q==microstrategy.FORMAT_TYPE_MAIN){var o=(k=="transparent")?1:0;for(y=0;y<N.length;y++){N[y].setAttribute("bgstyle",o);if(N[y].getAttribute("gradientcolor")){N[y].removeAttribute("gradientcolor");}}if(c==microstrategy.OBJTYPE_DOC_SUBSECTION&&A.getAttribute("scriptclass")!="mstrPanel"){var F=this.getChildBone(A);if(F){F.setSibsWithGradients(null);F.setGradientInfo(N,null);}}}if(E=="Gradient"){if(!bIsIE4&&!this.parentBone.isFeatureAvailable(microstrategy.FEATURE_IS_CLOUD)){showMessage({contents:microstrategy.descriptors.getDescriptor("9751"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING,zIndex:1001});}if(Q==microstrategy.FORMAT_TYPE_MAIN){if(AF==null){P=a+mstrUpdateManager.UNIT_SEPARATOR+AB.getPropertySetName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR+AB.getPropertyName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR;B=AB.encodeValue("backgroundColor",I.getValue(A,"backgroundColor"));}else{P=a+mstrUpdateManager.UNIT_SEPARATOR+"Gradient"+mstrUpdateManager.UNIT_SEPARATOR;B=AF;}var D=k.split(",");if((c==microstrategy.OBJTYPE_DOC_SUBSECTION&&A.getAttribute("scriptclass")!="mstrPanel")||(d==microstrategy.SUBOBJTYPE_DOC_SHAPE&&A.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){var X=(c==microstrategy.OBJTYPE_DOC_SUBSECTION)?this.getChildBone(A):microstrategy.bone(A.id);if(X){if(c==microstrategy.OBJTYPE_DOC_SUBSECTION){X.setSibsWithGradients(N);X.setGradientInfo(N,D);}else{X.gradientColor={startingColor:D[gradientUtil.GRADIENT_START_COLOR_INDEX],endingColor:D[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientAngle:D[gradientUtil.GRADIENT_ANGLE_INDEX],gradientXOffset:D[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientYOffset:D[gradientUtil.GRADIENT_YOFFSET_INDEX]};}X.applyGradient();}}else{for(y=0;y<N.length;y++){N[y].setAttribute("bgstyle","2");N[y].setAttribute("gradientcolor",k);gradientUtil.applyGradientSettings(N[y],D,microstrategy.styleObj);}}if(H){var h=function(AG,f){return a+mstrUpdateManager.UNIT_SEPARATOR+AB.getPropertySetName(AG)+mstrUpdateManager.UNIT_SEPARATOR+AB.getPropertyName(AG)+mstrUpdateManager.UNIT_SEPARATOR+f+mstrUpdateManager.ITEM_SEPARATOR;};H.push(Z.createActionObject(A,mstrUpdateManager.EDIT_PROPS,u,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,h("backgroundColor",AB.encodeValue("backgroundColor",k))+h("gradientColor",AB.encodeValue("gradientColor",k))+h("backgroundStyle",AB.encodeValue("backgroundStyle",k))+h("gradientAngle",D[3])+h("gradientXOffset",D[4])+h("gradientYOffset",D[5])],[mstrUpdateManager.UPDATE_LATER,P+B+mstrUpdateManager.ITEM_SEPARATOR]));}}else{O=microstrategy.findBone(A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL?A.lastChild:A);if(O&&O.applyGradientOnItem){O.applyGradientOnItem(Q,J,k,H,AB);}}}if(E=="selectionColor"||E=="selectionStyle"){var q=(E=="selectionColor")?microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR:microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE;var S=I.getAttValue(e,q);I.setAttValue(e,q,k);if(E=="selectionColor"&&e.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(e.lastChild){var p=microstrategy.bone(e.lastChild.id);if(p&&p.setSelectionColor){p.setSelectionColor(k);}}}if(H){H.push(Z.createEditPropsAction(e,a,u,[E],[k],[S]));}}else{if(E!="backgroundStyle"){if(this.selections.isSingleSelectionType&&N[0]&&microstrategy.subObjectType(N[0])==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&!(this.selections.panelUnitFormat==0&&this.selections.panelValueFormat==0)){var AE=mstrStaticDoc.getBone(N[0]);if(AE&&AE.setFormatValue){AE.setFormatValue(mstrPanelStack.FMT_TYPE_TITLE,E,k);}}else{if(this.selections.isSingleSelectionType&&N[0]&&microstrategy.subObjectType(N[0])==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&!(this.selections.controlUnitFormat==0&&this.selections.controlValueFormat==0)&&!(E=="dropShadowDepth"||E=="dropShadowEffect")){var AE=mstrStaticDoc.getBone(N[0]);if(AE&&AE.setFormatValue){AE.setFormatValue(mstrRWControlImpl.FMT_TYPE_TITLE,E,k);}}else{for(y=0;y<N.length;y++){var n=I.getValue(N[y],"TextDirection")||"0";I.setValue(N[y],E,k);if(E.match(/^padding/)){var G,C;if(E.match(/Left$/)||E.match(/Right$/)){G="width";C=microstrategy.HTMLATTR_WIDTH;}else{G="height";C=microstrategy.HTMLATTR_HEIGHT;}N[y].style[n==="0"?G:G==="width"?"height":"width"]=I.adjustSizes(G,AB.decodeValue(G,I.getAttValue(N[y],C)),null,N[y])+"px";}if(n!="0"){I.changeVerticalTextPosition(N[y],{x:E==="top"?parseInt(k,0):null,y:E==="left"?parseInt(k,0):null});}}}}}}if(J=="backgroundColor"&&c==microstrategy.OBJTYPE_DOC_SUBSECTION&&A.getAttribute("scriptclass")!="mstrPanel"){var R=this.getChildBone(A);if(R){R.startingColor=null;R.endingColor=null;}}if(J=="backgroundColor"&&d==microstrategy.SUBOBJTYPE_DOC_SHAPE&&A.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){O=microstrategy.bone(A.id);if(O){O.synchronizeFormat();}if(A.getAttribute("gradientcolor")){A.removeAttribute("gradientcolor");}}if(J=="backgroundColor"&&e.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(e.lastChild){var p=microstrategy.bone(e.lastChild.id);if(p.setSelectionColor){p.setSelectionColor(microstrategy.styleObj.getAttValue(e,microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR));}}}}if(M){M.synchronizeShadow();}}}if(!T&&Y&&H&&H.length>0){Z.add(H);}return(T)?H:null;}catch(z){microstrategy.errors.log(z);return(H!=null)?H:false;}};mstrDocImpl.prototype.setGridDataSource=function(A,E,D){try{for(var C in A){var G=A[C].getAttribute("id");var F=document.getElementsByName(G);if(F){if(D){D.push(this.parentBone.updateManager.createActionObject(F[0],mstrUpdateManager.CHANGE_DATA_SET,this.parentBone.beanPath,["2048031","2048012"],[E,G]));}}}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.setGridOrigin=function(E,A,G,H){try{var F=(A)?"1":"0";for(var I in E){var B=E[I].getAttribute("id");var D=document.getElementsByName(B);if(D){if(H){H.push(this.parentBone.updateManager.createActionObject(D[0],mstrUpdateManager.CHANGE_TEMPLATE_ORIGIN,this.parentBone.beanPath,["2048158","2048031","2048012"],[F,G,B]));}}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatItemBorders=function(S,F,c,U,W,N,m){try{var e=mstrFormatObject;var Y=(m!=null);var Q=this.parentBone.updateManager;var a=this.styleObj;if(N||Y){if(!Y){var m=[];}}var H=(parseFloat(U)>0);var h=[];for(var Z=0;Z<F.length;Z++){switch(F[Z]){case"borderTop":h.push("bt");break;case"borderBottom":h.push("bb");break;case"borderRight":h.push("br");break;case"borderLeft":h.push("bl");break;}}for(var g in S){var T=S[g].getAttribute("id");var M=document.getElementsByName(T);if(M.length==0){continue;}var d=microstrategy.subObjectType(S[g]);var L=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&(d==microstrategy.SUBOBJTYPE_DOC_TEXT||d==microstrategy.SUBOBJTYPE_DOC_IMAGE||d==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||d==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER));var G=(a.getAttValue(S[g],microstrategy.HTMLATTR_BORDER)==microstrategy.HAS_BORDER);if(U.length>0){if(L&&H&&!G){for(var X=0;X<M.length;X++){M[X].style.border="";}}for(var Z=0;Z<F.length;Z++){if(this.checkAppliesTo(S[g],F[Z]+"Color")&&this.checkAppliesTo(S[g],F[Z]+"Style")){var K=(U!="0pt"&&(W.length==0||!G));if(K){K=(!G||a.getAttValue(S[g],h[Z]+"c").length==0);}var P=true;if(W.length==0){if(K){W="#000000";}else{P=false;}}if(m){m.push(Q.createEditPropsAction(S[g],T,this.parentBone.beanPath,[F[Z]+"Style"],[U+" "+c],[e.decodeValue(F[Z]+"Style",a.getAttValue(S[g],h[Z]+"s"))]));if(P){m.push(Q.createEditPropsAction(S[g],T,this.parentBone.beanPath,[F[Z]+"Color"],[W],[e.decodeValue(F[Z]+"Color",a.getAttValue(S[g],h[Z]+"c"))]));}}a.setAttValue(S[g],h[Z]+"c",e.encodeValue(F[Z]+"Color",W));a.setAttValue(S[g],h[Z]+"s",e.encodeValue(F[Z]+"Style",U+" "+c));var D=U+" "+c,E=F[Z];if(M[0].getAttribute(F[Z])!=null){for(var X=0;X<M.length;X++){E=a.swapForRotation(M[X],F[Z]);M[X].setAttribute(E,D,0);if(P){M[X].setAttribute(E+"Color",W,0);}}}else{var C=(P)?W:a.getValue(M[0],F[Z]+"Color");for(var X=0;X<M.length;X++){E=a.swapForRotation(M[X],F[Z]);M[X].style[E]=D;M[X].style[E+"Color"]=C;}}}}}else{for(var Z=0;Z<F.length;Z++){if(this.checkAppliesTo(S[g],F[Z]+"Color")){if(m!=null){m.push(Q.createEditPropsAction(S[g],T,this.parentBone.beanPath,[F[Z]+"Color"],[W],[e.decodeValue(F[Z]+"Color",a.getAttValue(S[g],h[Z]+"c"))]));}a.setAttValue(S[g],h[Z]+"c",e.encodeValue(F[Z]+"Color",W));var E=F[Z];if(M[0].getAttribute(F[Z]+"Color")){for(var X=0;X<M.length;X++){E=a.swapForRotation(M[X],F[Z]);M[X].setAttribute(E+"Color",W,0);}}else{for(var X=0;X<M.length;X++){E=a.swapForRotation(M[X],F[Z]);M[X].style[E+"Color"]=W;}}}}}if(L){if(H){a.setAttValue(M[0],microstrategy.HTMLATTR_BORDER,microstrategy.HAS_BORDER);}else{var B={Top:false,Bottom:false,Left:false,Right:false};for(var k in B){var O=a.getValue(M[0],"border"+k+"Width");var R=a.getValue(M[0],"border"+k+"Style");B[k]=(O.length!=0&&O!="0pt"&&R.length!=0&&R!="none");}if(!B.Top&&!B.Bottom&&!B.Left&&!B.Right){a.setAttValue(M[0],microstrategy.HTMLATTR_BORDER,microstrategy.NO_BORDER);for(var X=0;X<M.length;X++){M[X].style.border=microstrategy.DESIGNMODE_NOBORDER_STYLE;}}}}var V=function(u,n,f,q){u.style[q?n:n==="width"?"height":"width"]=a.adjustSizes(n,e.decodeValue(n,a.getAttValue(u,f)),null,u)+"px";},J=true;for(var Z=0;Z<M.length;Z++){J=!a.getValue(M[Z],"TextDirection")||a.getValue(M[Z],"TextDirection")==="0";if(a.getAttValue(M[Z],microstrategy.HTMLATTR_WIDTH_MODE)!=microstrategy.AUTO_MODE){V(M[Z],"width",microstrategy.HTMLATTR_WIDTH,J);}if(a.getAttValue(M[Z],microstrategy.HTMLATTR_HEIGHT_MODE)!=microstrategy.AUTO_MODE){V(M[Z],"height",microstrategy.HTMLATTR_HEIGHT,J);}}this.adjustObjectSize(M);if(d==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(S[g]);if(A&&A.isGraph){if(m){m.forceSubmit=true;}}}}if(!Y&&N&&m.length>0){Q.add(m);}return(Y)?m:null;}catch(I){microstrategy.errors.log(I);return false;}};mstrDocImpl.prototype.adjustObjectSize=function(H){try{var G={0:H[0]};var F=this.styleObj;var B=microstrategy.subObjectType(H[0]);var D=this;var E=function(I,L,K){var J;if(I==microstrategy.HUNDRED_PERCENT_MODE&&B==microstrategy.SUBOBJTYPE_DOC_SHAPE){J=D.calcParentSubHeightWidth(H[0],L)+"px";}else{if(I!=microstrategy.AUTO_MODE){J=mstrFormatObject.decodeValue(L,F.getAttValue(H[0],K));}else{return ;}}D.formatSize(G,L,J);};E(F.getAttValue(H[0],microstrategy.HTMLATTR_HEIGHT_MODE),"height",microstrategy.HTMLATTR_HEIGHT);E(F.getAttValue(H[0],microstrategy.HTMLATTR_WIDTH_MODE),"width",microstrategy.HTMLATTR_WIDTH);if(B==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||B==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(H[0]);A.synchronizeSize();}}catch(C){microstrategy.errors.log(C);return false;}};mstrDocImpl.prototype.formatLineSetting=function(G,A,K,E,S){try{var N=(S!=null);var F=this.parentBone.updateManager;S=S||[];var P=mstrFormatObject;var O=this.styleObj;var H=A.substr(4);if(H=="Weight"){H="Width";}for(var R in G){var I=G[R].getAttribute("id");var D=document.getElementsByName(I);if(!D||!this.checkAppliesTo(G[R],A)){continue;}var C=microstrategy["HTMLATTR_LINE_"+H.toUpperCase()];var Q=H;var J=microstrategy.subObjectType(G[R]);if(J==microstrategy.SUBOBJTYPE_DOC_LINE){if(A=="lineWeight"&&parseInt(K,10)<=0){continue;}if(O.getAttValue(G[R],microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_HORIZONTAL){Q="Top"+Q;}else{Q="Left"+Q;}}Q="border"+Q;if(S){S.push(F.createEditPropsAction(G[R],I,this.parentBone.beanPath,[A],[K],[P.decodeValue(A,O.getAttValue(G[R],C))]));}O.setAttValue(G[R],C,P.encodeValue(A,K));if(J!=microstrategy.SUBOBJTYPE_DOC_SHAPE||G[R].getAttribute(microstrategy.HTMLATTR_STYLE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var L=function(U,T){D[M].style[U]=O.adjustSizes(U,P.decodeValue(U,O.getAttValue(D[M],T)),null,D[M])+"px";};for(var M=0;M<D.length;M++){D[M].style[Q]=K;if(Q=="borderWidth"||Q=="borderStyle"){L("width",microstrategy.HTMLATTR_WIDTH);L("height",microstrategy.HTMLATTR_HEIGHT);}}}}if(!N&&E&&S.length>0){F.add(S);}return(N)?S:null;}catch(B){microstrategy.errors.log(B);return null;}};mstrDocImpl.prototype.formatLineSetting=function(G,A,L,E,S){try{var F=this.parentBone.updateManager;var P=mstrFormatObject;var O=this.styleObj;var H=A.substr(4);var C=microstrategy["HTMLATTR_LINE_"+H.toUpperCase()];if(H=="Weight"){H="Width";}for(var R in G){var I=G[R].getAttribute("id");var D=document.getElementsByName(I);if(!D||!this.checkAppliesTo(G[R],A)){continue;}var Q=H;var K=microstrategy.subObjectType(G[R]);if(K==microstrategy.SUBOBJTYPE_DOC_LINE){if(A=="lineWeight"&&parseInt(L,10)<=0){continue;}var J=(O.getAttValue(G[R],microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_HORIZONTAL)?"Top":"Left";Q=J+Q;}Q="border"+Q;if(S){S.push(F.createEditPropsAction(G[R],I,this.parentBone.beanPath,[A],[L],[P.decodeValue(A,O.getAttValue(G[R],C))]));}O.setAttValue(G[R],C,P.encodeValue(A,L));if(K!=microstrategy.SUBOBJTYPE_DOC_SHAPE||G[R].getAttribute(microstrategy.HTMLATTR_STYLE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var M=function(T){D[N].style[T]=O.adjustSizes(T,P.decodeValue(T,O.getAttValue(D[N],microstrategy["HTMLATTR_"+T.toUpperCase()])),null,D[N])+"px";};for(var N=0;N<D.length;N++){D[N].style[Q]=L;if(Q=="borderWidth"||Q=="borderStyle"){M("width");M("height");}}}}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.applyUserMetricFormat=function(A){try{var H=A.userMetricId;var C=A.dataSetId;var D=A.bulkChanges;if(H&&C){var E=this.parentBone.updateManager;var G=[];var B="";for(counter=0;counter<D.length;counter++){D[counter]=D[counter].replace("|",mstrUpdateManager.UNIT_SEPARATOR);B=B+"FormattingNumber"+mstrUpdateManager.UNIT_SEPARATOR+D[counter]+mstrUpdateManager.ITEM_SEPARATOR;}B=B.substring(0,B.length-1);G.push(E.createActionObject(null,mstrUpdateManager.FORMAT_USER_METRIC,this.parentBone.beanPath,["2048031","2048001","2048035","2048018"],[C,H,B,mstrUpdateManager.UPDATE_LATER]));E.add(G);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){E.flushAndSubmitChanges();}}}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.populatePortalSizeValues=function(G,E,F,B,D){try{var A=G.getAttValue(E,microstrategy[B]);this.formatAttribute({0:E},F,A,null,microstrategy[B.replace("_","_OLD_")],D);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.minimizePortal=function(L,B,O,G,U){try{var R=(U!=null);var J=this.parentBone.updateManager;if(G||R){if(!R){U=[];}}var S=this.styleObj;var K="|";for(var T in L){var M=L[T].getAttribute("id");K+=M+"|";var F=document.getElementsByName(M);if(F&&this.checkAppliesTo(L[T],B)&&S.getAttValue(L[T],microstrategy.HTMLATTR_WINDOW_STATE)!=microstrategy.WINDOW_STATE_MINIMIZED){this.restoreOldTopAndLeft(L[T]);var W=microstrategy.findBone(microstrategy.findAncestorWithAtt(L[T],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION));if(U){var N={0:L[T]};var A=S.getAttValue(L[T],microstrategy.HTMLATTR_WINDOW_STATE);if(A==microstrategy.WINDOW_STATE_NORMAL){this.populatePortalSizeValues(S,L[T],"oldHeight","HTMLATTR_HEIGHT",U);this.populatePortalSizeValues(S,L[T],"oldWidth","HTMLATTR_WIDTH",U);}var C=microstrategy.findChildWithAtt(F[0],"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrPortalImpl");var V=(C)?getObjHeight(C):microstrategy.WINDOW_TITLE_HEIGHT;if(C){var E=S.getAttValue(L[T],"wth");if(E!=null){V=E+microstrategy.getPaddingAndBorderPixels(L[T],"height");}V+="px";}this.formatSize(N,"height",""+V,U,!!C,false,true);if(A==microstrategy.WINDOW_STATE_MAXIMIXED){var I=S.getAttValue(L[T],microstrategy.HTMLATTR_OLD_WIDTH);if(I){this.formatSize(N,"width",mstrFormatObject.decodeValue("width",I),U,true,false,true);}}U.push(J.createEditPropsAction(F[0],M,this.parentBone.beanPath,[B],[O],[mstrFormatObject.decodeValue(B,S.getAttValue(L[T],microstrategy.HTMLATTR_WINDOW_STATE))]));if(W){var H=W.maxZindex-1;var Q=microstrategy.getViewerBone();if(Q.portals&&Q.portals[L[T].id]&&typeof (Q.portals[L[T].id][microstrategy.WINDOW_STATE_NORMAL])!="undefined"){H=Q.portals[L[T].id][microstrategy.WINDOW_STATE_NORMAL];}this.formatItems(N,"zIndex",H,false,U);}}if(W){this.processSubsectionBone(W);}for(var P=0;P<F.length;P++){S.setAttValue(F[P],microstrategy.HTMLATTR_WINDOW_STATE,O);}}microstrategy.eventManager.notifyOrphanBones("portalWindowResize","minimize",M);}this.selections.syncUp();this.updateLayoutWidth(U);if(!R&&G&&U.length>0){J.add(U);}microstrategy.eventManager.notifyOrphanBones("onboneafterresize",K);return(R)?U:null;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocImpl.prototype.maximizePortal=function(M,C,Q,H,a){try{var U=(a!=null);var K=this.parentBone.updateManager;if(H||U){if(!U){a=[];}}var Y=mstrFormatObject;var W=this.styleObj;var L="|";var F={};for(var Z in M){var N=M[Z].getAttribute("id");L+=N+"|";var G=document.getElementsByName(N);var B=W.getAttValue(M[Z],microstrategy.HTMLATTR_WINDOW_STATE);if(G&&this.checkAppliesTo(M[Z],C)&&B!=microstrategy.WINDOW_STATE_MAXIMIXED){var E=this;var O={0:M[Z]};var A=function(d){W.setAttValue(M[Z],microstrategy["HTMLATTR_OLD_"+d.toUpperCase()],Y.encodeValue(d,parseInt(W.getValue(M[Z],d))));E.formatItems(O,d,0,false);};A("top");A("left");var c=microstrategy.findBone(microstrategy.findAncestorWithAtt(M[Z],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION));if(a){F[c.id]=c;if(B==microstrategy.WINDOW_STATE_NORMAL){this.populatePortalSizeValues(W,M[Z],"oldHeight","HTMLATTR_HEIGHT",a);this.populatePortalSizeValues(W,M[Z],"oldWidth","HTMLATTR_WIDTH",a);}var X=function(f,d){var d=!!d?d:E.calcParentSubHeightWidth(M[Z],f),e=d;if(bIsIE8){e=(parseInt(e)-1)+"px";}E.formatSize(O,f,e,a,true,false);return d;};var R=W.getAttValue(c.elem,microstrategy.HTMLATTR_HEIGHT);if(R){R=Y.decodeValue("height",R);}R=X("height",R);var J=X("width");if(mstrStaticDoc.getBone(M[Z])){mstrStaticDoc.getBone(M[Z]).synchronizeSize();}if(c.subsectionType!=mstrSubSection.TYPE_PANEL){this.formatSubHeightWidth({0:c.elem},"height",[Y.encodeValue("height",R),W.getAttValue(c.elem,microstrategy.HTMLATTR_MAX_HEIGHT),"0","0",W.getAttValue(c.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)],a);}a.push(K.createEditPropsAction(G[0],N,this.parentBone.beanPath,[C],[Q],[B]));var P=c.maxZindex;var I=W.getValue(M[Z],"zIndex");if(P>=I){P++;var T=microstrategy.getViewerBone();T.portals=T.portals||{};T.portals[M[Z].id]=T.portals[M[Z].id]||{};T.portals[M[Z].id][B]=I;a=this.formatItems(O,"zIndex",P,false,a);}}if(c){this.processSubsectionBone(c);}for(var S=0;S<G.length;S++){W.setAttValue(G[S],microstrategy.HTMLATTR_WINDOW_STATE,Q);}}microstrategy.eventManager.notifyOrphanBones("portalWindowResize","maximize",N);}if(F&&a){for(var V in F){var c=F[V];c.maxZindex++;}}this.selections.syncUp();this.updateLayoutWidth(a);if(!U&&H&&a.length>0){K.add(a);}microstrategy.eventManager.notifyOrphanBones("onboneafterresize",L);return(U)?a:null;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocImpl.prototype.restorePortal=function(L,B,O,G,X){try{var S=(X!=null);var J=this.parentBone.updateManager;if(G||S){if(!S){X=[];}}var V=mstrFormatObject;var T=this.styleObj;var K="|";var E={};for(var W in L){var M=L[W].getAttribute("id");K+=M+"|";var F=document.getElementsByName(M);var A=T.getAttValue(L[W],microstrategy.HTMLATTR_WINDOW_STATE);if(F&&this.checkAppliesTo(L[W],B)&&A!=microstrategy.WINDOW_STATE_NORMAL){this.restoreOldTopAndLeft(L[W]);var Y=microstrategy.findBone(microstrategy.findAncestorWithAtt(L[W],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION));var D=this;var N={0:L[W]};if(X){var U=function(a){var Z=T.getAttValue(L[W],microstrategy["HTMLATTR_OLD_"+a.toUpperCase()]);D.formatSize(N,a,V.decodeValue(a,Z),X,true,false);return Z;};var P=U("height");var I=U("width");if(mstrStaticDoc.getBone(L[W])){mstrStaticDoc.getBone(L[W]).synchronizeSize();}X.push(J.createEditPropsAction(F[0],M,this.parentBone.beanPath,[B],[O],[A]));if(Y){var H=Y.maxZindex-1;var R=microstrategy.getViewerBone();if(R.portals&&R.portals[L[W].id]&&typeof (R.portals[L[W].id][microstrategy.WINDOW_STATE_NORMAL])!="undefined"){H=R.portals[L[W].id][microstrategy.WINDOW_STATE_NORMAL];}this.formatItems(N,"zIndex",H,false,X);}}if(Y){this.processSubsectionBone(Y);}for(var Q=0;Q<F.length;Q++){T.setAttValue(F[Q],microstrategy.HTMLATTR_WINDOW_STATE,O);}}microstrategy.eventManager.notifyOrphanBones("portalWindowResize","restore",M);}this.selections.syncUp();this.updateLayoutWidth(X);if(!S&&G&&X.length>0){J.add(X);}microstrategy.eventManager.notifyOrphanBones("onboneafterresize",K);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.restoreOldTopAndLeft=function(E,A){try{if(typeof (A)=="undefined"){A=microstrategy.RESTORE_BOTH;}var D=this;var B=function(G){var F=D.styleObj.getAttValue(E,microstrategy["HTMLATTR_OLD_"+G.toUpperCase()]);if(F){D.formatItems({0:E},G,mstrFormatObject.decodeValue(G,F),false);}};if(A!=microstrategy.RESTORE_LEFT){B("top");}if(A!=microstrategy.RESTORE_TOP){B("left");}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatTitle=function(F,A,G,H){try{for(var I in F){var B=F[I].getAttribute("id");var E=document.getElementsByName(B);if(E&&this.checkAppliesTo(F[I],A)){if(H){H.push(this.parentBone.updateManager.createEditPropsAction(E[0],B,this.parentBone.beanPath,[A],[G],[mstrFormatObject.decodeValue(A,(F[I].getAttribute("title",0)||""))]));}this.styleObj.setAttValue(F[I],microstrategy.HTMLATTR_TOOLTIP_FORMULA,G);for(var D=0;D<E.length;D++){if(bIsIE7&&E[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){E[D].setAttribute("tooltip",G,0);}else{E[D].setAttribute("title",G,0);}}}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatAttribute=function(J,A,L,G,K,P,D){try{var N;var M=(P!=null);if(G||M){var I=this.parentBone.updateManager;if(!M){P=[];}}for(var O in J){var E=J[O];var B=J[O].getAttribute("id");var H=document.getElementsByName(B);if(H&&this.checkAppliesTo(J[O],A)){if(P){P.push(I.createActionObject(H[0],mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035","2048241"],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(B,A,L,true),D?"1":"0"],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(B,A,this.styleObj.getAttValue(E,K,true))]));}this.styleObj.setAttValue(E,K,L);if(K=="swt"){N=microstrategy.findBone(E);if(N&&N.toggleTitleBars){N.isTitleVisible=(L==-1);N.toggleTitleBars();if(N.synchronizeSize){N.synchronizeSize();}}}if(K=="wt"){N=microstrategy.findBone(E);if(N&&N.updatePortalTitle){N.updatePortalTitle(L);}}if(K=="tbd"){N=microstrategy.findBone(J[O]);if(N){N.titleBarDisplay=L;N.adjustTitle();}}if(K=="nm"&&microstrategy.subObjectType(J[O])==microstrategy.SUBOBJTYPE_DOC_PANEL){microstrategy.findBone(J[O]).parentBone.adjustTitle(J[O]);}if(K=="visible"||K=="nm"||K=="wt"||K=="lck"||K=="twc"||K=="rsl"){this.styleObj.setAttValue(E,K,L);}if(K==microstrategy.HTMLATTR_NORMAL_URL||K==microstrategy.HTMLATTR_HIGHLIGHT_URL){N=microstrategy.findBone(E);if(N&&N.updateIcons){N.updateIcons();}}if(K==microstrategy.HTMLATTR_FILL_EFFECT){N=microstrategy.findBone(E);if(N&&N.updateFillEffect){N.updateFillEffect();}}if(K==microstrategy.HTMLATTR_DISPLAY_STYLE){N=microstrategy.findBone(E);if(N&&N.updateDisplayStyle){N.updateDisplayStyle(P,G);}}}else{if(H&&this.parentBone.commands.queryState("isDDIC")){if(P){var C=microstrategy.getViewerBone().doc.commands,Q=C.getDDICBoneProperty([J[O]],"ctlKey",null);P.push(I.createActionObject(H[0],mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035","2048241"],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(Q,A,L,true),D?"1":"0"],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(Q,A,this.styleObj.getAttValue(E,K,true))]));}this.styleObj.setAttValue(E,K,L);}}}if(!M&&G&&P.length>0){I.add(P);}return(M)?P:null;}catch(F){microstrategy.errors.log(F);return(P!=null)?P:false;}};mstrDocImpl.prototype.formatIframeSource=function(A,E){try{for(var D in A){var G=A[D].getAttribute("id");var F=document.getElementsByName(G);if(F&&this.checkAppliesTo(A[D],"url")){var B=this.styleObj.getAttValue(F[0],microstrategy.HTMLATTR_HTML_TYPE);if(B==microstrategy.HTML_CONTAINER_TYPE_IFRAME){microstrategy.findRWObjectBone(F[0],"mstrHTMLContainerImpl").updateContents(B,E);}}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.importImage=function(C,B){var D=this;function F(H){var I=[];I.push(H.target.result);var G=new Blob(I);mstrmojo.xhr.upload("POST",mstrConfig.taskURL,{success:function(J){},failure:function(J){},complete:function(J){delete D.img;B.add([B.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,D.parentBone.beanPath,[],[],[])]);B.flushAndSubmitChanges();}},C.props,G,{showProgress:true,showProgressText:true,progressText:mstrmojo.desc(12963,"Uploading File...")});}function E(){var G={code:0,message:mstrmojo.desc(12814,"Cannot read file content")};if(callbacks.failure){callbacks.failure(G);}if(callbacks.complete){callbacks.complete();}}var A=new FileReader();A.onerror=E;A.onload=F;A.readAsArrayBuffer(C);};mstrDocImpl.prototype.formatImageSource=function(J,M,R,S){var O=false;try{for(var Q in J){var L=J[Q].getAttribute("id");var F=document.getElementsByName(L);if(microstrategy.subObjectType(J[Q])==microstrategy.SUBOBJTYPE_DOC_IMAGE&&F&&this.checkAppliesTo(J[Q],"src")){if(R){var T=F[0].getElementsByTagName("img");var K=(T.length>0)?T[0].getAttribute("src"):"";var E=microstrategy.getViewerBone().doc.prevSelectedId,A=document.getElementById(E),B=Number(A.getAttribute("ut")),C=B,H=this.parentBone.updateManager;if(this.img){C=mstr.Enum.IMAGE_URL_TYPE.BLOB_URL;this.img.props={taskId:"importImage",imageFieldName:"myFile",sectionKey:J[Q].parentNode.getAttribute("id"),fieldKey:L,fieldName:J[Q].getAttribute("name"),imageName:encodeURIComponent(this.img.name),imageSize:this.img.size,msgID:this.parentBone.messageID,isEdit:S};this.importImage(this.img,H);}else{C=mstr.Enum.IMAGE_URL_TYPE.HTTP_URL;}R.push(H.createActionObject(J[Q],mstrUpdateManager.EDIT_IMAGE,this.parentBone.beanPath,["2048012","2048019","2048295","2048018"],[L,M,C,mstrUpdateManager.UPDATE_LATER],[L,K,B,mstrUpdateManager.UPDATE_LATER]));if(!this.img){O=true;R.push(H.createActionObject(J[Q],mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[]));}}var N=false;for(var P=0;P<F.length;P++){var U=F[P].getElementsByTagName("img");if(U.length>0){var G=U[0].id;U[0].outerHTML="<img />";if(mstr.utils.ISFF){var I=M.split("?");if(I.length>1){I[0]=I[0].replace(/\\/g,"/");U[0].src=I.join("?");}else{U[0].src=I[0].replace(/\\/g,"/");}}else{U[0].src=M;}U[0].id=G;U[0].name=G;N=true;}}if(N){this.styleObj.setAttValue(J[Q],microstrategy.HTMLATTR_IMAGE_SOURCE,M);}}}}catch(D){microstrategy.errors.log(D);}return O;};mstrDocImpl.prototype.formatTemplateSize=function(A,F,E){try{var B=this.parentBone.updateManager;for(var D in A){var H=A[D].getAttribute("id");var G=document.getElementsByName(H);if(G&&this.checkAppliesTo(A[D],"xTabView")){microstrategy.findBone(this.selections.getSelectedGrid()).updateViewMode(F);E.push(B.createActionObject(G[0],mstrUpdateManager.CHANGE_VIEW_MODE,this.parentBone.beanPath+"."+G[0].id,["4115"],[F],[]));}}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.changeLineOrientation=function(I,K,L){try{var H=this.parentBone.updateManager;for(var M in I){var A=I[M].getAttribute("id");var F=document.getElementsByName(A);if(F.length==0){F=mstr.utils.Arrays.fromHashValues(I);}if(F&&this.checkAppliesTo(I[M],"orientation")){var C=this.styleObj.getAttValue(I[M],microstrategy.HTMLATTR_ORIENTATION);if(C!=K){if(L){L.push(H.createActionObject(F[0],mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(A,"orientation",K,true)],[mstrUpdateManager.UPDATE_LATER,mstrUpdateManager.createPropertyEditString(A,"orientation",C,true)]));}var B=this.styleObj;var G=this;var J=function(R){var P=B.getValue(R,"width");var S=B.getValue(R,"height");var O=B.getValue(R,"widthMode");var Q=B.getValue(R,"heightMode");var N=(O==Q);R.style.width=(N||O==1)?S:"100%";R.style.height=(N||Q==1)?P:"100%";if(!N){G.formatSizeMode([R],"heightMode",O,L,false);G.formatSizeMode([R],"widthMode",Q,L,false);}if(N||O==1){G.formatSize([R],"height",P,L,false);}if(N||Q==1){G.formatSize([R],"width",S,L,false);}if(!N){G.restoreOldTopAndLeft(R,microstrategy["RESTORE_"+(O==1)?"LEFT":"TOP"]);}};for(var E=0;E<F.length;E++){J(F[E]);this.setLineOrientation(F[E],K);F[E].setAttribute(microstrategy.HTMLATTR_ORIENTATION,K,0);}}}}this.updateLayoutWidth(L);}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.setLineOrientation=function(G,B,D){try{var F=this.styleObj;var A=(F.getValue(G,"lineStyle")||"solid")+" "+(F.getValue(G,"lineColor")||"#000000")+" "+parseInt(F.getValue(G,"lineWeight")||1,10)+"pt";var E={};E[microstrategy.ORIENTATION_HORIZONTAL]={0:"Top",1:"Left",2:"height"};E[microstrategy.ORIENTATION_VERTICAL]={0:"Left",1:"Top",2:"width"};var H=E[B];if(H){G.style["border"+H[0]]=A;G.style["border"+H[1]+"Width"]=0;F.setValue(G,H[2],0);}F.setAttValue(G,microstrategy.HTMLATTR_ORIENTATION,B);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatIsLink=function(E,F,I){try{var G=(F)?"-1":"0";for(var J in E){var A=E[J].getAttribute("id");var D=document.getElementsByName(A);if(D&&this.checkAppliesTo(E[J],"isLink")){if(I){I.push(this.parentBone.updateManager.createEditPropsAction(D[0],A,this.parentBone.beanPath,["isLink"],[G],[this.styleObj.getAttValue(E[J],microstrategy.HTMLATTR_IS_LINK)]));}this.styleObj.setAttValue(E[J],microstrategy.HTMLATTR_IS_LINK,G);var H=(F&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE)?"pointer":"default";for(var C=0;C<D.length;C++){D[C].style.cursor=H;}}}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.formatHTMLType=function(F,H,I){try{for(var J in F){var B=F[J].getAttribute("id");var E=document.getElementsByName(B);if(E&&this.checkAppliesTo(F[J],"htmlType")){var A=this.styleObj.getAttValue(F[J],microstrategy.HTMLATTR_HTML_TYPE);if(A!=H){var G=this.getHTMLFieldValues(E[0],decode(this.styleObj.getAttValue(E[0],(H==microstrategy.HTML_CONTAINER_TYPE_HTML)?microstrategy.HTMLATTR_HTML_TEXT:microstrategy.HTMLATTR_HTML_SOURCE),true));for(var D=0;D<E.length;D++){microstrategy.findRWObjectBone(E[D],"mstrHTMLContainerImpl").updateContents(H,G);}}}}this.formatAttribute(F,"htmlType",H,false,microstrategy.HTMLATTR_HTML_TYPE,I);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatLockAspectRatio=function(E,F,H){try{var G=(F)?"-1":"0";for(var I in E){var A=E[I].getAttribute("id");var D=document.getElementsByName(A);if(D.length==0){D=mstr.utils.Arrays.fromHashValues(E);}if(D&&this.checkAppliesTo(E[I],"lockAspectRatio")){var B=this.styleObj.getAttValue(E[I],microstrategy.HTMLATTR_LOCK_ASPECT_RATIO);if(B!=G){if(H){H.push(this.parentBone.updateManager.createEditPropsAction(D[0],A,this.parentBone.beanPath,["lockAspectRatio"],[G],[B]));}this.styleObj.setAttValue(E[I],microstrategy.HTMLATTR_LOCK_ASPECT_RATIO,G);}}}this.updateLayoutWidth(H);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.formatSubHeightWidth=function(J,C,M,U){try{var F=C.split("|");C=F[0];var S=mstrFormatObject;var Q=this.styleObj;var H=C.toUpperCase();var R=(C=="width")?"Horizontal":"";var B=(R)?"_"+R.toUpperCase():"";var L=[{tp:C,at:microstrategy["HTMLATTR_"+H]},{tp:"max"+H.substr(0,1)+C.substr(1),at:microstrategy["HTMLATTR_MAX_"+H]},{tp:"canGrow"+R,at:microstrategy["HTMLATTR_CAN_GROW"+B]},{tp:"canShrink"+R,at:microstrategy["HTMLATTR_CAN_SHRINK"+B]},{tp:"hideIfEmpty",at:microstrategy["HTMLATTR_HIDE_IF_EMPTY"+B]}];for(var T in J){var K=J[T].getAttribute("id");var G=document.getElementsByName(K);for(var P=0;P<M.length;P++){var A=L[P].tp;if(G&&this.checkAppliesTo(J[T],A)){var W=null;if(P==0){var B=(C=="width")?"_HORIZONTAL":"";W=[Q.getAttValue(J[T],L[P].at),Q.getAttValue(J[T],microstrategy["HTMLATTR_MAX_"+C.toUpperCase()]),Q.getAttValue(J[T],microstrategy["HTMLATTR_CAN_GROW"+B]),Q.getAttValue(J[T],microstrategy["HTMLATTR_CAN_SHRINK"+B]),Q.getAttValue(J[T],microstrategy.HTMLATTR_HIDE_IF_EMPTY)];}if(U){U.push(this.parentBone.updateManager.createEditPropsAction(G[0],K,this.parentBone.beanPath,[A],[S.decodeValue(A,M[P])],[1],false,{origValue:M,cachedOldValue:W,subsectionHeight:true}));}Q.setAttValue(J[T],L[P].at,M[P]);if(P==0&&microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){var I=S.decodeValue(A,M[P]||0);for(var O=0;O<G.length;O++){G[O].style[A]=I;if(C=="height"){G[O].parentNode.firstChild.style[A]=I;}}}if(P==4){var V=microstrategy.findBone(J[T]);V.setNeedToUpdateMaxContentHeight(true);if(C=="height"){if(V.isHorizontal){this.adjustHeightOfHorizontalSubSections(V,true);var E=microstrategy.findBone(microstrategy.findAncestorWithAtt(V.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER));if(E){for(var N=1;N<F.length;N++){if(F[N]=="SubHeight"){E.height=parseInt(S.decodeValue("height",M[0]),10);break;}}E.propogateHeightToChildren();}}else{V.adjustSubsectionHeight(true);}}else{if(C=="width"){V.adjustSubsectionWidth(true);}}}}}}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.formatSize=function(P,E,S,c,D,J,U){try{var Y=mstrFormatObject;var W=this.styleObj;for(var Z in P){var Q=P[Z].getAttribute("id");var L=document.getElementsByName(Q);var I=false;if(L.length==0||(!this.checkAppliesTo(P[Z],E)&&microstratgegy.formatType==microstrategy.FORMAT_TYPE_MAIN)){continue;}var R=microstrategy.subObjectType(P[Z]);var H=mstrStaticDoc.getBone(P[Z]);var M=H&&H.isTable;if(E!=null&&S!=null){if(R==microstrategy.SUBOBJTYPE_DOC_IMAGE){var X=microstrategy.findChildWithAtt(P[Z],"img","id",Q+"_img");if(X!=null){X.style[E]="100%";}}}if(c){var G=W.getValue(P[Z],E);if(G!="auto"&&G!="100%"){G=Math.max(Math.round(parseFloat(G)+microstrategy.getPaddingAndBorderPixels(P[Z],E)),0)+"px";}var V=M?true:false;c.push(this.parentBone.updateManager.createEditPropsAction(L[0],Q,this.parentBone.beanPath,[E],[S],[G],false,{origValue:S,performFormatChange:D,updateLayoutWidth:J,subType:R},V));}W.setAttValue(P[Z],this.heightAndWidthAttMap[E],Y.encodeValue(E,S));I=!this.useModeForStyle(E,P[Z]);var N=S;if(I&&(D!=false)){if(S!="100%"&&S!="auto"){N=Math.max(this.removePaddingAndBorder(L[0],S,E),1)+"px";}for(var T=0;T<L.length;T++){if(microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){E=W.swapForRotation(L[T],E);var d={x:parseInt(W.getValue(L[T],"top")),y:parseInt(W.getValue(L[T],"left"))},K=L[T].direction||this.styleObj.getValue(L[T],"TextDirection")||"0";L[T].style[E]=N;if(K!="0"){W.changeVerticalTextPosition(L[T],d);}if(R==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){var C=mstrStaticDoc.getBone(L[T]);var O=C.ctlStyle;var a=C.ctlOrientation;if(E!="height"||a!="0"||(O!="0"&&O!="4"&&O!="3")){W.cascadeSelectorValue(L[T],E,N);}}if(R==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&/width|height/.test(E)){var B=mstrStaticDoc.getBone(L[T]);if(B&&B.isTable){if(E=="width"){B.resize(null,parseInt(N));}if(E=="height"){B.resize(parseInt(N),null);}}}}if(R==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(L[T]);if(A&&A.isGraph&&!U&&A.adjustGraphSize){A.adjustGraphSize(A.commands.queryState("gridPosition"),A.commands.queryState("gridFactor"),c);}else{if(A&&!A.isGraph){if(E=="width"){A.setGridDimension(A.elem,null,parseInt(N));}if(E=="height"){A.setGridDimension(A.elem,parseInt(N),null);}}}}}}if((R==microstrategy.SUBOBJTYPE_DOC_SHAPE&&P[Z].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)||R==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||this.isDocButton(P[Z])){var H=microstrategy.bone(Q);if(H){H.synchronizeSize(c);}}}if(E=="width"&&(J=="undefined"||J==null||J==true)){this.updateLayoutWidth(c);}}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.formatSizeMode=function(L,C,O,T,B){try{var R=mstrFormatObject;var Q=this.styleObj;var H=C.replace("Mode","").toLowerCase();for(var S in L){var M=L[S].getAttribute("id");var G=document.getElementsByName(M);if(G.length==0||!this.checkAppliesTo(L[S],C)){continue;}var N=microstrategy.subObjectType(L[S]);if(N==microstrategy.SUBOBJTYPE_DOC_SHAPE){var K="100"+C.toUpperCase().substr(0,1)+"MObjects";if(parseInt(O,10)==microstrategy.HUNDRED_PERCENT_MODE){K="addTo"+K;}else{K="removeFrom"+K;}this.parentBone[K](M);}if(O==microstrategy.HUNDRED_PERCENT_MODE||O==microstrategy.AUTO_MODE){if(N==microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER||N==microstrategy.SUBOBJTYPE_DOC_IMAGE){continue;}if((Q.getAttValue(L[S],microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE)&&(N!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)){continue;}}else{if(O==microstrategy.HUNDRED_PERCENT_MODE&&N==microstrategy.SUBOBJTYPE_DOC_TEXT){continue;}}if(T){T.push(this.parentBone.updateManager.createEditPropsAction(G[0],M,this.parentBone.beanPath,[C],[O],[Q.getAttValue(L[S],this.heightAndWidthAttMap[C])],false,{origValue:O,performFormatChange:B,subType:N}));}var J=parseInt(O);if(!isNaN(J)){Q.setAttValue(L[S],this.heightAndWidthAttMap[C],String(J));}var I;var F=(J==microstrategy.FIX_MODE)||this.useModeForStyle(C,L[S]);switch(J){case microstrategy.FIX_MODE:I=R.decodeValue(H,Q.getAttValue(L[S],this.heightAndWidthAttMap[H]));break;case microstrategy.HUNDRED_PERCENT_MODE:I=(N==microstrategy.SUBOBJTYPE_DOC_SHAPE)?this.calcParentSubHeightWidth(L[S],H):"100%";var U=(C=="heightMode")?"top":"left";Q.setAttValue(L[S],(C=="heightMode")?microstrategy.HTMLATTR_OLD_TOP:microstrategy.HTMLATTR_OLD_LEFT,R.encodeValue(U,parseInt(Q.getValue(L[S],U))));this.formatItems([L[S]],U,"0",false,T);break;case microstrategy.AUTO_MODE:I="auto";break;}if(F&&(B!=false)){if(I!="100%"&&I!="auto"){I=Math.max(this.removePaddingAndBorder(G[0],I,H),1)+"px";}for(var P=0;P<G.length;P++){H=Q.swapForRotation(G[P],H);G[P].style[H]=I;if((C=="widthMode")&&microstrategy.subObjectType(G[P])==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(G[P]);if(A&&A.adjustGridWidth){A.adjustGridWidth(String(J));}}}}if(N==microstrategy.SUBOBJTYPE_DOC_SHAPE&&L[S].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var E=microstrategy.bone(M);if(E){E.synchronizeSize();}}}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.useModeForStyle=function(F,E){try{var B=(F.indexOf("height")>-1)?microstrategy.HTMLATTR_HEIGHT_MODE:microstrategy.HTMLATTR_WIDTH_MODE;var A=microstrategy.subObjectType(E);if(A==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){return false;}if(parseInt(this.styleObj.getAttValue(E,B))!=microstrategy.FIX_MODE){if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){if(A==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var D=microstrategy.findBone(E);return !!(D&&D.isGrid);}return true;}else{if(A==microstrategy.SUBOBJTYPE_DOC_SHAPE||A==microstrategy.SUBOBJTYPE_DOC_LINE){return true;}}}}catch(C){microstrategy.errors.log(C);}return false;};mstrDocImpl.prototype.calcParentSubHeightWidth=function(C,D){try{var A=microstrategy.findAncestorWithAtt(C,"ty",microstrategy.OBJTYPE_DOC_SUBSECTION);if(A!=null){return window["getObj"+D.substr(0,1).toUpperCase()+D.substr(1)](A);}}catch(B){microstrategy.errors.log(B);}return 0;};mstrDocImpl.prototype.formatLineLength=function(E,A,G,I,C){try{var D;for(var J in E){if(this.checkAppliesTo(E[J],A)){var F=(this.styleObj.getAttValue(E[J],microstrategy.HTMLATTR_ORIENTATION)==microstrategy.ORIENTATION_HORIZONTAL)?"width":"height";var H=(A.indexOf("Mode")>-1)?"Mode":"";this["formatSize"+H]([E[J]],F+H,G,I,C);}}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.process3DItemSetting=function(E,F,A,D){try{if(D){var B=this.styleObj.getAttValue(E,F);B=(B==null)?0:parseInt(B);D.push(microstrategy.updateManager.createEditPropsAction(E,E.getAttribute("id"),this.parentBone.beanPath,[F],[A],[B]));}this.styleObj.setAttValue(E,F,A);}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.process3DItemColorSettings=function(N,L,M,I,O){try{var J=mstrFormatObject;var D=this.styleObj;var C=N.getAttribute("id");var H=document.getElementsByName(C);if(H.length==0){return ;}for(var G=0;G<L.length;G++){var B=L[G]+"Color2";var K=J.getAttrNameFromStyle(B);if(O){O.push(microstrategy.updateManager.createEditPropsAction(N,C,this.parentBone.beanPath,[B],[M[G]],[J.decodeValue(B,D.getAttValue(N,K))]));}for(var F=0;F<H.length;F++){var A=D.swapForRotation(H[F],L[G]);H[F].style[A]=I+"pt solid";H[F].style[A+"Color"]=M[G];D.setAttValue(N,K,J.encodeValue(B,M[G]));}}}catch(E){microstrategy.errors.log(E);}};mstrDocImpl.prototype.format3DItems=function(K,H,E,N){try{var D=this.styleObj;var G=function(T){var S=T.getAttribute("gradientColor");var U=S&&S.split(",");if(U&&U.length==6){var R=(U[5]==0&&U[4]==0)?0:1;return"#"+U[R];}return D.getValue(T,"backgroundColor");};for(var O in K){var P=microstrategy.subObjectType(K[O]);if(!this.checkAppliesTo(K[O],"b3dstyle")){continue;}if((P==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK||P==microstrategy.SUBOBJTYPE_DOC_TEMPLATE)&&microstrategy.formatType!=microstrategy.FORMAT_TYPE_MAIN){continue;}var C=true;var J=H;var B=E;if(H==null||H.length==0){J=this.styleObj.getAttValue(K[O],microstrategy.HTMLATTR_BORDER_3D_STYLE);}if(J!=null&&parseInt(J)>0){if(E==null||E.length==0){B=this.styleObj.getAttValue(K[O],microstrategy.HTMLATTR_BORDER_3D_WEIGHT);}B=parseInt(B,10);if(B!=null&&B>0){C=false;var Q=(P==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK)?null:G(K[O]);if(Q==null||Q.length==0||Q.toLowerCase()=="transparent"){Q="#FFFFFF";}Q=mstr.utils.Color.hex2rgb(Q);var L=mstr.utils.Color.get3DBorderColor(Q,"dark");var I=mstr.utils.Color.get3DBorderColor(Q,"light");if(J!="1"){var M=I;I=L;L=M;}this.process3DItemSetting(K[O],"b3dstyle",J,N);this.process3DItemSetting(K[O],"b3dweight",B,N);if(!(P==microstrategy.SUBOBJTYPE_DOC_SHAPE&&K[O].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND)){this.process3DItemColorSettings(K[O],["borderLeft","borderTop","borderRight","borderBottom"],[I,I,L,L],B,N);this.adjustObjectSize(document.getElementsByName(K[O].getAttribute("id")));}}}if(C){J=this.styleObj.getAttValue(K[O],microstrategy.HTMLATTR_BORDER_3D_STYLE);if((H!=null&&parseInt(H)==0)&&(J!=null&&parseInt(J)>0)){this.turnOffItem3D(K[O],N);}}if(P==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var A=microstrategy.findBone(K[O]);if(A&&A.isGraph&&A.adjustGraphSize){A.adjustGraphSize(A.commands.queryState("gridPosition"),A.commands.queryState("gridFactor"),N);if(N){N.forceSubmit=true;}}}}}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.turnOffItem3D=function(J,K){try{this.process3DItemSetting(J,"b3dstyle","0",K);var A=this.styleObj;var D=mstrFormatObject;var L=microstrategy.subObjectType(J);if(L!=microstrategy.SUBOBJTYPE_DOC_SHAPE){var E={borderLeft:"bl",borderTop:"bt",borderRight:"br",borderBottom:"bb"};for(var G in E){var H=E[G];var I=D.decodeValue(G+"Style",A.getAttValue(J,H+"s")).split(" ");this.formatItemBorders({0:J},[G],I[1],I[0],D.decodeValue(G+"Color",A.getAttValue(J,H+"c")));}}else{if(L==microstrategy.SUBOBJTYPE_DOC_SHAPE&&J.getAttribute(microstrategy.HTMLATTR_STYLE)!=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){var C=this;var F=function(N,M){C.formatLineSetting({0:J},N,D.decodeValue(N,A.getAttValue(J,M)));};F("lineColor","lc");F("lineStyle","ls");F("lineWeight","lw");}}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.checkAppliesTo=function(B,C){try{return microstrategy.isEnabledForItem(B,C);}catch(A){microstrategy.errors.log(A);return false;}};mstrDocImpl.prototype.checkBorderProperties=function(G,J,I,B,F){try{if(this.selections.hasNoBorder(G)){return 0;}var H;var C=["Right","Bottom","Left"];var A=J.getValue(G,I+"Top"+B);for(H=0;H<3;H++){if(A!=J.getValue(G,I+C[H]+B)){return 2;}}var K=parseFloat(A,10);if(isNaN(K)||K==0){return 0;}var D=J.getValue(G,I+"Top"+F);for(H=0;H<3;H++){if(D!=J.getValue(G,I+C[H]+F)){return 2;}}return 1;}catch(E){microstrategy.errors.log(E);return 0;}};mstrDocImpl.prototype.resolveDeltaPropertyValue=function(B,A){return(A in B)?B[A]:this.commands.queryState(A);};mstrDocImpl.prototype.processDocBorderChanges=function(B,M){try{if(!B){return ;}var F=mstrFormatObject;var K=["Top","Right","Bottom","Left"];var O,I,L,A,H,D;var N=this.resolveDeltaPropertyValue(B,"LayoutBorderStyle");switch(parseInt(N)){case 0:this.elem.style.borderWidth=0;var E=this;var J=function(P){P+="Style";E.saveDocProperty("border"+P,F.decodeValue("border"+P,0),M);E.parentBone["Layout"+P]=0;};for(D=0;D<4;D++){J(K[D]);}break;case 1:O=this.resolveDeltaPropertyValue(B,"LayoutAllStyle");I=this.resolveDeltaPropertyValue(B,"LayoutAllColor");L=F.decodeValue("borderTopStyle",O);this.elem.style.border=L+" "+I;for(D=0;D<4;D++){this.saveDocProperty("border"+K[D]+"Style",L,M);this.saveDocProperty("border"+K[D]+"Color",I,M);this.parentBone["Layout"+K[D]+"Style"]=O;this.parentBone["Layout"+K[D]+"Color"]=I;}break;case 2:for(D=0;D<4;D++){O=B["Layout"+K[D]+"Style"];if(!isNaN(O)){A="border"+K[D]+"Style";L=F.decodeValue("borderTopStyle",O);var G=L.split(" ");this.elem.style["border"+K[D]+"Width"]=G[0];this.elem.style[A]=G[1];this.saveDocProperty(A,L,M);this.parentBone["Layout"+K[D]+"Style"]=O;}I=B["Layout"+K[D]+"Color"];if(I){A="border"+K[D]+"Color";this.elem.style[A]=I;this.saveDocProperty(A,I,M);this.parentBone["Layout"+K[D]+"Color"]=I;}}break;}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.processIncrFetchChanges=function(D){try{var A=this.parentBone.ifSettings;var B=["2048166"];var E=(A.enabled)?[microstrategy.TRUE]:[microstrategy.FALSE];if(A.curLevel){B.push("2048167");E.push(A.curLevel);}if(A.blockCount){B.push("2048168");E.push(A.blockCount);}D.push(this.parentBone.updateManager.createActionObject(null,mstrUpdateManager.RW_IF_SETTINGS,this.parentBone.beanPath,B,E));}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.processDocViewModeChanges=function(E,M){try{if(!E){return false;}var G,D,H,L=0;var J=this.parentBone.updateManager,K=this;var C=function(N){var P=0,O=K.resolveDeltaPropertyValue(E,N);if(typeof (O)=="string"){O=O.split(CLIPBOARD_ITEM_SEPARATOR);}for(G=0;G<O.length;G++){D=parseInt(O[G],10);if(!isNaN(D)){P+=D;}}return P;};H=C("AvailableViewModes");H+=C("AvailableExportModes");var B=mstr.Enum.VIEWMEDIA;var A=B.STATIC+B.INTERACTIVE+B.EDITABLE+B.FLASH+B.EXPORT_EXCEL+B.EXPORT_PDF+B.EXPORT_HTML+B.EXPORT_FLASH;L=A-H;this.parentBone.AvailableViewModes=H;var I=this.resolveDeltaPropertyValue(E,"DefaultViewMode");M.push(J.createActionObject(null,mstrUpdateManager.SET_VIEW_MEDIA,this.parentBone.beanPath,["2048163","2048290","2048291"],[I,H,L],[]));return true;}catch(F){microstrategy.errors.log(F);return false;}};mstrDocImpl.prototype.processDocPropertyChanges=function(F){try{var W=[];var Q=this.parentBone.updateManager;var P=false;var K=false;var E=null;var Z=null;var J=this.parentBone.ifSettings;var X=false;var N={};for(var V=0,U=F.length;V<U;V++){var I=F[V].cmdId;var S=F[V].value;var A=null;var T;var M=(this.docPropsMap[I]&&this.docPropsMap[I].f)||I;var L=(this.docPropsMap[I]&&this.docPropsMap[I].l)||I;switch(I){case"TabName":var c=F[V].id;this.saveDocProperty(M,S,W,c);if(c==this.parentBone.currentLayout){this.parentBone[L]=S;}break;case"DefaultGridStyle":case"CalculateDocWidth":case"TOCTitle":case"TOCFontName":case"TOCFontSize":case"WatermarkType":case"WatermarkText":case"TextOrientation":case"ImageSource":case"ImageScale":case"WatermarkFontName":case"WatermarkFontSize":case"EmbeddedFonts":case"MobileDataView":case"PreLoadAllPanels":case"SupportedOrientations":case"layoutBarPosition":case"ExcelExportDocumentURL":case"PDFExportDocumentURL":case"TOCTitleAlignment":case"TOCTitleFontName":case"TOCTitleFontSize":case"TOCLeftIndent":case"TOCRightIndent":case"TOCBorderStyle":case"TOCBorderWeight":case"RemoveMissingUnits":case"SingleSourceGrid":case"DocumentThemeColor":case"SmartClientDoc":case"RWLevelMCEJoin":this.saveDocProperty(M,S,W);this.parentBone[L]=S;break;case"layoutBarStyle":this.saveDocProperty(M,S,W);this.parentBone[L]=S;if(S=="0"){this.saveDocProperty("layoutBarPosition",1,W);this.parentBone.layoutBarPosition=1;}break;case"BeforeLayout":this.saveDocProperty(M,parseInt(S)+1,W);this.parentBone[L]=S;break;case"Autowire":N[I]={value:S,fn:M,lp:L};break;case"FitPDFContentHeight":case"DisplayPageByBar":case"DisplayRePromptIcon":case"UseAsInfoWindow":case"ExecutionFullScreenMode":case"PreserveTranslations":case"ShowingBarsTemporarily":case"ShowFloatingToolbars":case"CtlAutoSubmit":case"tabMPHF":case"EnableToc":case"TOCFontStrikeout":case"TOCFontUnderline":case"TabLeader":case"AutoFontSize":case"TextWashout":case"WatermarkFontStrikeout":case"WatermarkFontUnderline":case"RemoveNullGroups":case"TrimNoSectionData":case"ShowTabsForSingleLayout":case"IncludePageHeaderFooter":case"EnableExport":case"EnableSwipingToSwitchLayout":case"TOCTitleFontUnderline":case"TOCTitleFontStrikeout":case"KeepControlTargetsConsistent":this.saveDocProperty(M,(S)?microstrategy.TRUE:microstrategy.FALSE,W);this.parentBone[L]=S;break;case"OfflineOnCube":if(!!this.parentBone.ShowOfflineUCOnCubeConfig){this.saveDocProperty(M,(S)?microstrategy.TRUE:microstrategy.FALSE,W);this.parentBone[L]=S;}break;case"TOCTitleEnableInherit":this.saveDocProperty(M,(S)?microstrategy.FALSE:microstrategy.TRUE,W);this.parentBone[L]=S;break;case"ViewModeInteractivityLevel":this.saveDocProperty(M,(S)?2:1,W);this.parentBone[L]=S;break;case"DefaultSelectorsAsFilter":N[I]={value:S,fn:M,lp:L};break;case"LayoutFillColor":A=(S=="transparent")?"#ffffff":S;this.saveDocProperty(M,A,W);this.parentBone[L]=S;this.saveDocProperty("backgroundStyle",S,W);break;case"LayoutBorderStyle":case"LayoutAllStyle":case"LayoutAllColor":case"LayoutLeftStyle":case"LayoutLeftColor":case"LayoutTopStyle":case"LayoutTopColor":case"LayoutRightStyle":case"LayoutRightColor":case"LayoutBottomStyle":case"LayoutBottomColor":E=E||{};E[I]=S;break;case"AvailableViewModes":case"AvailableExportModes":case"DefaultViewMode":Z=Z||{};Z[I]=S;break;case"VisibleSections":case"DockedSections":var D=(I=="VisibleSections")?"visibility":"docked",B=(I=="VisibleSections")?"v":"dc";S=CLIPBOARD_ITEM_SEPARATOR+S+CLIPBOARD_ITEM_SEPARATOR;var a=this.commands.queryState("sectionsList");for(T=0;T<a.length;T++){var O=(S.indexOf(CLIPBOARD_ITEM_SEPARATOR+a[T].dssid+CLIPBOARD_ITEM_SEPARATOR)>-1)?microstrategy.TRUE:microstrategy.FALSE;var Y=mstrUpdateManager.createPropertyEditString(a[T].dssid,D,O,true);if(a[T].v!=(O==microstrategy.TRUE)){this.parentBone.sectionsList[T][B]=(O==microstrategy.TRUE);}W.push(Q.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,Y],[]));}break;case"ShowConditionalFormatting":W.push(Q.createActionObject(this.elem,mstrUpdateManager.TOGGLE_DOC_THRESHOLDS,[],[],[],[]));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){P=true;}break;case"TOCFontBoldItalic":this.parentBone.TOCFontBold=(S&1);this.saveDocProperty("TOCFontBold",(S&1)?microstrategy.TRUE:microstrategy.FALSE,W);this.parentBone.TOCFontItalic=(S&2);this.saveDocProperty("TOCFontItalic",(S&2)?microstrategy.TRUE:microstrategy.FALSE,W);break;case"TOCTitleFontBoldItalic":this.parentBone.TOCTitleFontBold=(S&1);this.saveDocProperty("TOCTitleFontBold",(S&1)?microstrategy.TRUE:microstrategy.FALSE,W);this.parentBone.TOCTitleFontItalic=(S&2);this.saveDocProperty("TOCTitleFontItalic",(S&2)?microstrategy.TRUE:microstrategy.FALSE,W);break;case"WatermarkFontBoldItalic":this.parentBone.WatermarkFontBold=(S&1);this.saveDocProperty("WatermarkFontBold",(S&1)?microstrategy.TRUE:microstrategy.FALSE,W);this.parentBone.WatermarkFontItalic=(S&2);this.saveDocProperty("WatermarkFontItalic",(S&2)?microstrategy.TRUE:microstrategy.FALSE,W);break;case"TOCFillColor":case"TOCTitleFillColor":A=(S=="transparent")?"#ffffff":S;this.saveDocProperty(M,microstrategy.getFormatObject().encodeValue("color",A),W);this.parentBone[L]=S;break;case"TOCFontColor":case"TOCTitleFontColor":case"TOCBorderColor":case"WatermarkFontColor":this.saveDocProperty(I,microstrategy.getFormatObject().encodeValue("color",S),W);this.parentBone[I]=S;break;case"incrFetchEnabled":case"incrFetchBlockCount":case"incrFetchCurLevel":X=true;J[L]=S;break;case"ApplyGBToAllLayouts":var R=S?2:1;this.saveDocProperty(M,R,W);this.parentBone[L]=R;break;}switch(I){case"TOCFillColor":if(S=="transparent"){this.saveDocProperty("TOCFillStyle","1",W);}else{this.saveDocProperty("TOCFillStyle","0",W);}break;case"TOCTitleFillColor":if(S=="transparent"){this.saveDocProperty("TOCTitleFillStyle","1",W);}else{this.saveDocProperty("TOCTitleFillStyle","0",W);}break;case"LayoutFillColor":this.elem.style.backgroundColor=S;break;case"TabName":case"tabMPHF":case"VisibleSections":case"ShowConditionalFormatting":case"CalculateDocWidth":P=true;break;case"RemoveNullGroups":case"TrimNoSectionData":case"RemoveMissingUnits":case"KeepControlTargetsConsistent":P=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);break;case"SingleSourceGrid":if(S==="0"){this.parentBone.features[microstrategy.FEATURE_SINGLE_SOURCE_GRID]=this.parentBone.isFeatureAvailable(microstrategy.FEATURE_SINGLE_SOURCE_GRID_PROJECT);}else{this.parentBone.features[microstrategy.FEATURE_SINGLE_SOURCE_GRID]=S==="1"?true:false;}P=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);break;case"RWLevelMCEJoin":if(S==="-1"){this.parentBone.features[microstrategy.FEATURE_RW_LEVEL_MCE_JOIN]=this.parentBone.features[microstrategy.FEATURE_PROJECT_LEVEL_MCE_JOIN];}else{this.parentBone.features[microstrategy.FEATURE_RW_LEVEL_MCE_JOIN]=S;}P=(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE);break;case"ShowTabsForSingleLayout":P=true;K=true;break;}}this.processDelayedActions(N,W);this.processDocBorderChanges(E,W);if(this.processDocViewModeChanges(Z,W)){P=true;}if(X){this.processIncrFetchChanges(W);P=true;}var H=this.processStaticDocPropertyChanges(F,W);if(W.length>0){Q.add(W,true);if(P||H){Q.flushAndSubmitChanges();}}if(K){var C=mstr.$obj("RWDocPropertiesEditorModel1");if(C){C.execReinitializeModel();}}}catch(G){microstrategy.errors.log(G);}};mstrDocImpl.prototype.processDelayedActions=function(G,L){var D=["DefaultSelectorsAsFilter","Autowire"];for(var I in D){var C=D[I];if(C in G){var B=G[C];var J=B.value;var H=B.fn;var F=B.lp;switch(C){case"Autowire":this.saveDocProperty(H,(J)?microstrategy.TRUE:microstrategy.FALSE,L);this.parentBone[F]=J;if(J){for(var K in this.sections){var A=this.sections[K];for(var E in A.subsections){A.subsections[E].recursiveWiring(L,this.parentBone.beanPath);}}}break;case"DefaultSelectorsAsFilter":this.saveDocProperty(H,(J)?"1":"0",L);this.parentBone[F]=J;break;}}}};mstrDocImpl.prototype.processRWDocProperty=function(H,G){try{var E=[];var A=this.parentBone.updateManager;var F=mstrUpdateManager.createPropertyEditString(null,H,G);var D=this;var B=function(I){E.push(A.createActionObject(null,I,D.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,F],[]));};B(mstrUpdateManager.SAVE_DOC_PROPERIES);B(mstrUpdateManager.APPLY_CHANGES);A.add(E);A.flushAndSubmitChanges();}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.saveDocProperty=function(B,H,I,D){try{var F=(!I);if(F){I=[];}var E=this.parentBone.updateManager;var A=this.parentBone.beanPath;switch(B){case"backgroundColor":case"borderTopColor":case"borderTopStyle":case"borderRightColor":case"borderRightStyle":case"borderBottomColor":case"borderBottomStyle":case"borderLeftColor":case"borderLeftStyle":case"name":case"TabMPHF":case"TabColor":case"SupportedOrientations":case"Autowire":case"FitPDFContentHeight":case"DisplayPageByBar":case"DisplayRePromptIcon":case"UseAsInfoWindow":case"IPhoneVisualization":case"APhoneVisualization":case"ATabletVisualization":case"WidgetProps":if(this.parentBone.currentLayout){I.push(E.createEditPropsAction(null,this.parentBone.currentLayout,A,[B],[H],null,true));}else{I.push(E.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,A,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,mstrUpdateManager.createPropertyEditString(null,B,H)],[]));}break;case"FilterDetailsFormat":var G=H.split(UNIT_SEPARATOR);if(G.length!=2){break;}if(G[0]){I.push(E.createEditPropsAction(null,G[0],A,[B],[G[1]],null,true));}break;default:mstrStaticDoc.prototype.saveDocProperty.apply(this,[B,H,I,D]);}if(F){E.add(I,(B=="width"||B=="UsePageWidthAsLayoutWidth"));}}catch(C){microstrategy.errors.log(C);}};mstrDocImpl.prototype.openDialog=function(F,A,D,C,E){try{C=C||this.parentBone.beanPath+".rwd";microstrategy.openDialog(F,A,D,C,E);}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.showPageBreaker=function(C){try{if(this.pgBreakers){for(var E in this.pgBreakers){this.elem.removeChild(this.pgBreakers[E]);}this.pgBreakers=null;}if(C){this.pgBreakers={};var G=parseInt(this.getPageWidth());var B=Math.ceil(getObjWidth(this.elem)/G);if(!this.docbgDiv){this.docbgDiv=document.getElementById("docbg");}this.docbgDiv.style.left=((B-1)*G)+"px";this.docbgDiv.style.width=G+"px";var A=getObjHeight(this.elem);var D=document.createElement("div");D.style.position="absolute";D.style.borderLeft="1pt dashed gray";D.style.height=getObjHeight(this.elem)+"px";D.style.zIndex="30";D.style.top=getObjTop(this.elem);for(var E=1;E<B;E++){D.setAttribute("id",E);D.style.left=(E*G)+"px";this.pgBreakers[E]=this.elem.appendChild(D.cloneNode(true));}}}catch(F){microstrategy.errors.log(F);}};mstrDocImpl.prototype.updatePageBreaker=function(){try{var A=getObjHeight(this.elem);var B=parseInt(this.getPageWidth());if(this.pgBreakers){for(var C in this.pgBreakers){this.pgBreakers[C].style.height=A+"px";this.pgBreakers[C].style.left=C*B+"px";}}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.updateHRulerWidth=function(A){try{var D=(typeof A!="undefined"&&A!=null)?parseInt(A,10):12;var C=this.parentBone.rulers.rwb_viewer;if(C){C.style.width=parseInt(this.parentBone.docRszHandler.style.left)+"px";C.style.paddingRight=D+"pt";}}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.updateLayoutWidth=function(C,D){try{var B=this.getRightMostPos();if(this.minWidth!=null&&(this.minWidth<B&&B>getObjWidth(this.elem)||D)){this.minWidth=B;this.elem.style.width=this.minWidth+"px";this.saveDocProperty("width",this.minWidth,C);if(this.parentBone.usePageWidthAsLayoutWidth!=0){this.parentBone.usePageWidthAsLayoutWidth=0;this.saveDocProperty("UsePageWidthAsLayoutWidth",this.parentBone.usePageWidthAsLayoutWidth,C);}if(this.parentBone.rulerTicker){this.parentBone.rulerTicker.style.left=(this.minWidth-parseInt(getObjWidth(this.parentBone.rulerTicker)/2))+"px";}if(this.parentBone.docRszHandler){this.parentBone.docRszHandler.style.left=this.minWidth+"px";}this.updateHRulerWidth();if(this.parentBone.viewer100wm!=null){this.parentBone.resize100WMObjects();}this.displayPageBreaker();}else{this.minWidth=B;}}catch(A){microstrategy.errors.log(A);}};mstrDocImpl.prototype.getName=function(C,A){try{var E=A.substr(A.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length);var B=function(F){return microstrategy.descriptors.getDescriptor(F)+E;};switch(C){case microstrategy.SUBOBJTYPE_DOC_TEXT:return B("1013");case microstrategy.SUBOBJTYPE_DOC_IMAGE:return B("2922");case microstrategy.SUBOBJTYPE_DOC_LINE:return B("2059");case microstrategy.SUBOBJTYPE_DOC_SHAPE:return B("3196");case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:return B("3313");case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:return B("4727");case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:return B("4728");case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:return B("3957");default:return"Unknown";}}catch(D){microstrategy.errors.log(D);}};mstrDocImpl.prototype.getDefaultNameOfObject=function(C){var D=C.getAttribute("id"),A=microstrategy.subObjectType(C);var B=function(E){return microstrategy.descriptors.getDescriptor(E)+D.substr(D.indexOf(microstrategy.OBJ_PREFIX)+microstrategy.OBJ_PREFIX.length);};if(this.isDocButton(C)){return B("6457");}return this.getName(A,D);};mstrDocImpl.prototype.openAddImagePropertiesEditor=function(){try{this.setStubImage(this.selections.firstItem());microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",{lockedTab:2});}catch(A){microstrategy.errors.log(A);}};mstrDocImpl.prototype.startControlSelectionMode=function(){try{var A=null;if(this.selections.getFirstObjType()==microstrategy.OBJTYPE_DOC_OBJECT&&this.selections.getFirstObjSubType()==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.standAloneControlKey=this.selections.firstItem().id;}else{var F=null;var J=microstrategy.getActiveCXBone();A=J&&J.getGraphBone&&J.getGraphBone();if(A){F=A.objId;}else{if(this.selections.isGridSelected()){F=this.selections.getSelectedGrid().getAttribute("id");}}if(F){var C=microstrategy.activeCXMenu;this.controlSourceUnitType=C.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);this.controlSource=F;if(this.controlSourceUnitType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){this.controlSourceUnitType=microstrategy.DSSTYPE_ATTRIBUTE;this.controlSourceUnitID=microstrategy.getActiveCXBone().getUnitInfo(C).parentDssId;}else{this.controlSourceUnitID=C.getAttribute(microstrategy.HTMLATTR_DSS_ID);}if(this.controlSourceUnitID==null){this.controlSourceUnitID="";}}else{return ;}}this.controlSelectionMode=true;this.selections.clear();var D="";if(this.standAloneControlKey){D=microstrategy.bone(this.standAloneControlKey+"_Ctl").targetKeys;}else{var I=A||microstrategy.getActiveCXBone();var H=this.controlSourceUnitID;if(H==null||H==""){this.controlSourceUnitID="";H="Metrics";}if(I.controlLinks&&I.controlLinks[H]){D=I.controlLinks[H].targets;}}if(D){for(var E in D){var G=document.getElementById(D[E]);if(G){this.selections.addToSelection(true,G);}}}showMessage({contents:"Control Selection Mode",elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.parentBone.id+"').doc.submitControlTargetSelections();",cancelEval:"microstrategy.bone('"+this.parentBone.id+"').doc.endControlSelectionMode();",type:mstrMsgBoxImpl.MSG_WARNING,messageBoxID:"controlTargetsRecorder"});}catch(B){microstrategy.errors.log(B);}};mstrDocImpl.prototype.endControlSelectionMode=function(){try{this.standAloneControlKey=null;this.controlSourceUnitID=null;this.controlSourceUnitType="";this.controlSelectionMode=false;this.controlSource=null;this.selections.clear();}catch(A){microstrategy.errors.log(A);}};function mstrDocImpl(A){this.inherits=mstrStaticDoc;this.inherits(A);this.inherits=null;return this;}mstrDocImpl.shallRenderTarget=function(C){try{var E=document.getElementById(C);if(!E){return false;}var A=microstrategy.findBone(E.parentNode);while(A&&A.elem.getAttribute("scriptclass")=="mstrPanel"){var B=A.parentBone;if(B.getCurrentPanel()!=A){B.addDirtyKey(A,C);return false;}A=microstrategy.findBone(B.elem.parentNode);}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrDocImpl.prototype.promptDeleteItems=function(G,A,F,E,H){if(this.parentBone.docViewsSize>1){var C=this.parentBone.defaultDeleteMode;if(!C){var D="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('msgPref'), checked = p && p.checked; ";var B=D+"rwb.deleteItems(rwb.selections.items, true);if(checked)rwb.updateDeleteMode(true);";var I=D+"rwb.formatAttribute(rwb.selections.items,'visibility','0',true,microstrategy.HTMLATTR_VISIBLE,null,false);if(checked)rwb.updateDeleteMode(false);";showMessage({contents:microstrategy.descriptors.getDescriptor("8563"),elements:microstrategy.OK_BUTTON+microstrategy.APPLY_BUTTON,okEval:I,buttonLabels:{Apply:microstrategy.descriptors.getDescriptor("219"),Ok:microstrategy.descriptors.getDescriptor("218")},applyEval:B,type:mstrMsgBoxImpl.MSG_PREF_WARNING});}else{var J=mstrDocImpl.DELETE_MODE;if(C==J.DELETE){this.deleteItems(this.selections.items,true);}else{if(C==J.HIDE){this.formatAttribute(this.selections.items,"visibility","0",true,microstrategy.HTMLATTR_VISIBLE,null,false);}}}}else{this.deleteItems(this.selections.items,true);}};mstrDocImpl.prototype.updateInsertMode=function(D){var C=this.parentBone,B=C.updateManager,A=mstrDocImpl.INSERT_MODE;C.defaultInsertMode=D?A.ALL_VISIBLE:A.HIDE_OTHERS;B.add([B.createActionObject(null,mstrUpdateManager.SET_DEFAULT_INSERT_MODE,C.beanPath,["55005"],[C.defaultInsertMode],[])]);};mstrDocImpl.prototype.updateDeleteMode=function(D){var C=this.parentBone,B=C.updateManager,A=mstrDocImpl.DELETE_MODE;C.defaultDeleteMode=D?A.DELETE:A.HIDE;B.add([B.createActionObject(null,mstrUpdateManager.SET_DEFAULT_DELETE_MODE,C.beanPath,["55006"],[C.defaultDeleteMode],[])]);};mstrDocImpl.prototype.isDocButton=function(A){return this.isDocButtonType(microstrategy.subObjectType(A),microstrategy.styleObj.getAttValue(A,microstrategy.HTMLATTR_DISPLAY_STYLE));};mstrDocImpl.prototype.isDocButtonType=function(B,A){return B==microstrategy.SUBOBJTYPE_DOC_TEXT&&A>0;};mstrDocImpl.prototype.updateSingleTextField=function(A,B){if(this.isDocButton(A)){mstrButton.updateButtonCaption(A,B);}else{A.innerHTML=B;}};mstrDocImpl.prototype.isNavigationBar=function(A){return microstrategy.subObjectType(A)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&microstrategy.styleObj.getAttValue(A,microstrategy.HTMLATTR_USE_AS_NAVIGATION_BAR)==microstrategy.TRUE;};mstrDocImpl.prototype.findNavigationBar=function(A){if(!A){return null;}var B=microstrategy.findAncestorWithAtt(A,"scriptclass","mstrNavigationBar");if(!B){return null;}return mstr.$obj(B.id);};mstrDocViewerImpl.prototype=new mstrStaticDocViewer();mstrDocViewerImpl.prototype.superClass=mstrEditorImpl.prototype;mstrDocViewerImpl.prototype.updateManager=microstrategy.updateManager;mstrDocViewerImpl.prototype.nextId=0;mstrDocViewerImpl.prototype.selectedObjects="";mstrDocViewerImpl.prototype.rArrowDND;mstrDocViewerImpl.prototype.rootNodeKey="";mstrDocViewerImpl.prototype.dirtySections=[];mstrDocViewerImpl.prototype.dScrollTop=0;mstrDocViewerImpl.prototype.dScrollLeft=0;mstrDocViewerImpl.prototype.allVisList=null;mstrDocViewerImpl.prototype.renderedPanelStyles=null;mstrDocViewerImpl.prototype.ruleCounter=0;mstrDocViewerImpl.prototype.timeoutQueue=new Object;mstrDocViewerImpl.prototype.callbackOnReload=null;mstrDocViewerImpl.prototype.onload=function(){try{mstrStaticDocViewer.prototype.onload.call(this);if(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){this.objProps=new mstrObjectPropsImpl(this);}this.elem.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e)");if(this.layoutHeightMode==1){this.callDelayedResize();if(this.scrollTopPosition!=0||this.scrollLeftPosition!=0){this.delayedScrollAdjust(this.scrollTopPosition,this.scrollLeftPosition);}}this.onLoadCalled=true;if(this.keepAlive){window.setTimeout("microstrategy.getViewerBone().commands.exec('ping');",this.keepAlive);}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.onreload=function(){mstrStaticDocViewer.prototype.onreload.call(this);if(this.updatedFGKeys){this.partialUpdateFGS();}};mstrDocViewerImpl.prototype.onpostload=function(){try{mstrStaticDocViewer.prototype.onpostload.call(this);if(this.selectedObjects!=""){this.doc.selections.reselect(this.selectedObjects);this.selectedObjects="";}if(this.observer){this.observer.notifyAll("onselectionchange");}if(this.dirtySections.length>0){var B=this.updateManager;var F=[];var G=false;for(var D=0,A=this.dirtySections.length;D<A;D++){var H=this.dirtySections[D].bone;var C=this.dirtySections[D].isTarget;G=(G||C);H.wireTargets(F,this.beanPath,C);}if(F.length>0){B.add(F,true);}this.dirtySections=[];}if(this.callbackOnReload){this.callbackOnReload();this.callbackOnReload=null;}}catch(E){microstrategy.errors.log(E);}};mstrDocViewerImpl.prototype.partialUpdateFGS=function(){var I=this.updatedFGKeys;var E=this.updatedFGData;for(var F in E){var C=E[F];var K=C.sectionKey;for(var A in C){if(A=="sectionKey"){continue;}var B=C[A];var G=document.getElementsByName(A);for(var H=0;G&&H<G.length;H++){if(!B||(H+1>B.length)){G[H].parentNode.removeChild(G[H]);}else{G[H].innerHTML=B[H].value;G[H].className=B[H].cssClass;}}if(!G||(B&&(G.length<B.length))){var D=G?0:G.length;for(var H=D;H<B.length;H++){var J=document.createElement("span");J.id=A;J.setAttribute("name",A);J.setAttribute("sty",106);J.setAttribute("ty","obj");J.innerHTML=B[H].value;J.className=B[H].cssClass;if(document.getElementById(K)){document.getElementById(K).appendChild(J);}}}}}this.updatedFGKeys=undefined;this.updatedFGData=undefined;};mstrDocViewerImpl.prototype.onmousedown=function(C){try{if(!C){C=window.event;}getMouse(C);var B=getEventTarget(C);if(this.isEditableViewModeEplus()&&!mstrGridStatic.isMouseOverScrollBar(this.elem,lMouseX,lMouseY)){if(B==this.elem||B.firstChild==this.doc.elem){this.doc.selections.clear();}}if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){var D=microstrategy.eventManager.getSource(C);if(D&&D.elem&&D.elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_RULER){return this.doc.selections.onmousedown(C);}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocViewerImpl.prototype.adjustScrollValues=function(C){try{var A=document.createElement("img");document.body.appendChild(A);A.parentNode.removeChild(A);this.elem.onmousemove=null;this.dScrollTop=this.elem.scrollTop;this.dScrollLeft=this.elem.scrollLeft;return true;}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.onnotifydrag=function(A,D,B){try{if(this.isEditableViewModeEplus()){this.doc.onnotifydrag(A,D,B);}}catch(C){microstrategy.errors.log(C);}};mstrDocViewerImpl.prototype.onnotifydragend=function(B){try{if(this.isEditableViewModeEplus()){this.doc.onnotifydragend(B);}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.onpanelchange=function(){try{this.doc.onpanelchange();}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.onPanelDeleted=function(B){try{this.doc.onPanelDeleted(B);}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.ondocumentclick=function(B){try{if(this.doc){this.doc.ondocumentclick(B);}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.onSubSectionResize=function(){try{if(this.docRszHandler&&this.tempHandler){var A=getObjHeight(this.doc.elem)+"px";this.docRszHandler.style.height=A;this.tempHandler.style.height=A;}this.doc.onSubSectionResize();return false;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocViewerImpl.prototype.onwinresize=function(){try{this.callDelayedResize();}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.getAvailableWidgets=function(B){try{var F=[];for(var D=0,C=this.widgets.length;D<C;D++){var A=this.widgets[D];if(A.scope==B){F.push({dssid:A.rslPath||A.fqcn,n:A.title,mxsp:A.maxSecondaryProviders,mnsp:A.minSecondaryProviders,isVis:A.isVis});}}return F;}catch(E){microstrategy.errors.log(E);return F;}};mstrDocViewerImpl.prototype.getAvailableObjs=function(D){try{var G=[],H=this["document"+D];if(H){for(var C=0,B=H.length;C<B;C++){var A=H[C];var F={dssid:A.id+"|"+A.ty+"|"+A.n,n:(A.als||A.n)};if(A.dsn){F.dsn=A.dsn;}if(D==="Attributes"&&A.sty){F.sty=A.sty;}if(D==="Attributes"){if(A.olap){F.olap=A.olap;}if(A.de){F.de=A.de;}}G.push(F);}}return G;}catch(E){microstrategy.errors.log(E);return G;}};mstrDocViewerImpl.prototype.getAvailableAttributes=function(){return this.getAvailableObjs("Attributes");};mstrDocViewerImpl.prototype.getAvailableMetrics=function(){return this.getAvailableObjs("Metrics");};mstrDocViewerImpl.prototype.getPureAttributes=function(){try{var E=[],F=this["documentAttributes"];if(F){for(var C=0,B=F.length;C<B;C++){var A=F[C];if(A.ty!=microstrategy.DSSTYPE_CONSOLIDATION&&!(A.ty==microstrategy.DSSTYPE_FILTER&&A.sty==microstrategy.DSSTYPE_CUSTOM_GROUP)){E.push({dssid:A.id+"|"+A.ty+"|"+A.n,n:(A.als||A.n)});}}}return E;}catch(D){microstrategy.errors.log(D);return E;}};mstrDocViewerImpl.prototype.getAttributesWithDateForms=function(){try{var E=[],F=this["documentAttributes"],A=this["datasetInfos"],C={};if(A&&F){for(var D in A){mstr.$A.forEach(A[D].att,function(G){if(!C[G.did]&&G.t!=microstrategy.DSSTYPE_CONSOLIDATION&&!(G.t==microstrategy.DSSTYPE_FILTER&&G.st==microstrategy.DSSTYPE_CUSTOM_GROUP)&&!G.de){mstr.$A.forEach(G.fs,function(H){if(H.idf&&(H.obf||G.da)&&(H.bftp==8||H.bftp==1)){C[G.did]=true;return false;}});}});}mstr.$A.forEach(F,function(G){if(C[G.id]){E.push({dssid:G.id+"|"+G.ty+"|"+G.n,n:(G.als||G.n)});}});}return E;}catch(B){microstrategy.errors.log(B);return E;}};mstrDocViewerImpl.prototype.getAttributesType=function(){try{var E=[],F=this["documentAttributes"];if(F){for(var C=0,B=F.length;C<B;C++){var A=F[C];E.push({type:A.ty+"|"+A.sty,n:A.n});}}return E;}catch(D){microstrategy.errors.log(D);return E;}};mstrDocViewerImpl.prototype.delay=function(eval){try{var timeoutID=window.setTimeout("microstrategy.bone('"+this.id+"')."+eval,0);if(this.timeoutQueue[eval]){window.clearTimeout(this.timeoutQueue[eval]);}this.timeoutQueue[eval]=timeoutID;}catch(err){microstrategy.errors.log(err);}};mstrDocViewerImpl.prototype.onunload=function(){try{mstrBoneImpl.prototype.onunload.call(this);if(this.observer){this.observer.onunload();}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.onredo=function(B){try{switch(B.id){case mstrUpdateManager.PASTE_FORMATTING:this.objProps.onredo(B);break;default:this.doc.onredo(B);break;}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocViewerImpl.prototype.onundo=function(B){try{switch(B.id){case mstrUpdateManager.PASTE_FORMATTING:this.objProps.onundo(B);break;default:this.doc.onundo(B);break;}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrDocViewerImpl.prototype.initViewer=function(){try{mstrStaticDocViewer.prototype.initViewer.call(this);if(this.observer){this.observer.onload();}if(this.isEditableViewModeEplus()){this.initRulers();}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.initRulers=function(){try{if(this.doc){for(var J in this.doc.sections){var D=this.doc.sections[J];for(var F in D.subsections){var A=D.subsections[F];if((A.ruler)&&(A.ruler!=null)){this.rulers[A.id]=A.ruler;}if(A.elem&&A.elem.childNodes){for(var C=0;C<A.elem.childNodes.length;C++){var H=A.elem.childNodes[C];if((H.nodeType==1)&&(H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=null)&&(H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_VRULER)){this.rulers[A.id+C]=H;}}}}}this.rulers[this.id]=microstrategy.objectFind(this.elem,["DIV"],microstrategy.OBJTYPE_RULER);this.rulerShade=microstrategy.subObjectFind(this.rulers[this.id],["DIV"],microstrategy.SUBOBJTYPE_HRULER_SHADE);this.rulerTicker=document.getElementById("rArrow");if(this.rulerTicker){this.rulerTicker.style.left=getObjWidth(this.doc.elem)-parseInt(getObjWidth(this.rulerTicker)/2)+"px";this.rulerTicker.style.top="2.5px";}this.docRszHandler=document.getElementById("docRszHandler");if(this.docRszHandler){var I=getObjHeight(this.doc.elem);var G=getObjTop(this.doc.elem);this.docRszHandler.style.left=this.doc.elem.style.width;this.docRszHandler.style.top=G+"px";this.docRszHandler.style.height=I+"px";var E=microstrategy.styleObj.getValue(this.docRszHandler,"backgroundColor");this.docRszHandler.onmouseover=new Function("this.style.cursor = 'e-resize';");this.docRszHandler.onmouseout=new Function("this.style.cursor = 'auto';");if(!this.tempHandler){this.tempHandler=document.createElement("img");this.tempHandler.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";this.tempHandler.style.position="absolute";this.tempHandler.style.zIndex=2;this.tempHandler.style.backgroundColor="#ffff00";this.tempHandler.style.left=this.doc.left+"px";this.tempHandler.style.top=this.docRszHandler.style.top;this.tempHandler.style.width="3px";this.tempHandler.style.height=I+"px";}this.dObj=new mstrDragnDropObjImpl("docRszHandler","microstrategy.bone('"+this.id+"').dObj","microstrategy.bone('"+this.id+"').rArrowDragEndEvent()",this.doc,this.tempHandler,this);this.doc.updateHRulerWidth();}if(this.rulerTicker){this.rArrowDND=new mstrDragnDropObjImpl("rArrow","microstrategy.bone('"+this.id+"').rArrowDND","microstrategy.bone('"+this.id+"').rArrowDragEndEvent()",this.doc,this.tempHandler,this);}}}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.syncDocRszHandler=function(){try{if(!this.docRszHandler){this.docRszHandler=document.getElementById("docRszHandler");}if(this.docRszHandler){this.docRszHandler.style.left=getObjWidth(this.doc.elem)+"px";this.docRszHandler.style.top=getObjTop(this.doc.elem)+"px";this.docRszHandler.style.height=getObjHeight(this.doc.elem)+"px";}}catch(A){microstrategy.errors.log(A);}};mstrDocViewerImpl.prototype.rArrowDragEndEvent=function(){try{var F=mstrFormatObject;var A=parseInt(microstrategy.styleObj.getValue(this.doc.elem,"width"));var E=getObjLeft(this.docRszHandler);if(this.rulerTicker){var D=getObjLeft(this.rulerTicker)+parseInt(getObjWidth(this.rulerTicker)/2);if(D==A){this.rulerTicker.style.left=E-parseInt(getObjWidth(this.rulerTicker)/2)+"px";}}if(E==A&&this.rulerTicker){this.docRszHandler.style.left=D+"px";}this.doc.elem.style.width=getObjLeft(this.docRszHandler)+"px";var C=[];this.doc.saveDocProperty("width",this.doc.elem.style.width,C);if(this.usePageWidthAsLayoutWidth!=0){this.usePageWidthAsLayoutWidth=0;this.doc.saveDocProperty("UsePageWidthAsLayoutWidth",this.usePageWidthAsLayoutWidth,C);}if(C.length){microstrategy.updateManager.add(C,true);}if(this.tempHandler){this.doc.elem.removeChild(this.tempHandler);}if(getObjWidth(this.doc.elem)<this.doc.minWidth){this.doc.minWidth=getObjWidth(this.doc.elem);}this.docRszHandler.style.backgroundColor="";this.doc.displayPageBreaker();if(this.viewer100wm!=null){this.resize100WMObjects();}this.doc.updateHRulerWidth();}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.removeFrom100HMObjects=function(C){try{var E=document.getElementById(C);if(E!=null){var A=microstrategy.findBone(E);if(A!=null&&A.elem!=null){var B=A.elem.getAttribute("id");if(this[B+"_100hm"]!=null){this[B+"_100hm"]=this[B+"_100hm"].replace(C+",","");}}}}catch(D){microstrategy.errors.log(D);}};mstrDocViewerImpl.prototype.addTo100HMObjects=function(C){try{var E=document.getElementById(C);if(E!=null){var A=microstrategy.findBone(E);if(A!=null&&A.elem!=null){var B=A.elem.getAttribute("id");if(this[B+"_100hm"]!=null){if(this[B+"_100hm"].indexOf(C)<0){this[B+"_100hm"]=this[B+"_100hm"].concat(C+",");}}else{this[B+"_100hm"]=C+",";}}}}catch(D){microstrategy.errors.log(D);}};mstrDocViewerImpl.prototype.removeFrom100WMObjects=function(C){try{var E=document.getElementById(C);if(E!=null){var A=microstrategy.findBone(E);if(A!=null&&A.elem!=null){var B=A.elem.getAttribute("id");if(this[B+"_100wm"]!=null){this[B+"_100wm"]=this[B+"_100wm"].replace(C+",","");}}}if(String(this.viewer100wm).indexOf(C)>-1){this.viewer100wm=this.viewer100wm.replace(C+",","");}}catch(D){microstrategy.errors.log(D);}};mstrDocViewerImpl.prototype.addTo100WMObjects=function(C){try{var E=document.getElementById(C);if(E!=null){var A=microstrategy.findBone(E);if(A!=null&&A.elem!=null){var B=A.elem.getAttribute("id");if(this[B+"_100wm"]!=null){if(this[B+"_100wm"].indexOf(C)<0){this[B+"_100wm"]=this[B+"_100wm"].concat(C+",");}}else{this[B+"_100wm"]=C+",";}}}if(this.viewer100wm!=null){if(String(this.viewer100wm).indexOf(C)<0){this.viewer100wm+=C+",";}}else{this.viewer100wm=C+",";}}catch(D){microstrategy.errors.log(D);}};mstrDocViewerImpl.prototype.turnOffRulerShade=function(){try{if(this.rulerShadeOn&&this.rulerOn&&this.rulerShade){this.rulerShade.style.width=0;this.rulerShade.style.left=0;for(var D in this.doc.sections){var B=this.doc.sections[D];for(var A in B.subsections){var E=B.subsections[A];E.turnOffRulerShade();}}this.rulerShadeOn=false;}}catch(C){microstrategy.errors.log(C);}};mstrDocViewerImpl.prototype.turnOnRulerShade=function(A){try{if(!this.rulerShadeOn&&this.rulerOn&&this.rulerShade){this.rulerShade.style.width=(A.right-A.left+3)+"px";this.rulerShade.style.left=(A.left-this.doc.left)+"px";this.rulerShadeOn=true;}}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.dragRulerShade=function(J,I,E){try{if(this.rulerShadeOn&&this.rulerOn&&this.rulerShade){xOffset=J-1-this.doc.left;if(xOffset>0){this.rulerShade.style.left=xOffset+"px";this.rulerShade.style.width=(E.right-E.left)+"px";}var M=E.bottom-E.top+3;for(var L in this.doc.sections){var F=this.doc.sections[L];for(var G in F.subsections){var B=F.subsections[G];var C=getObjSumTopScrolled(B.elem);var H=C+getObjHeight(B.elem);var A=I-C;var K=((A%2)>0)?1:0;if((I>=C)&&(I<=H)){B.turnOnRulerShade(E);B.dragRulerShade(A);}else{if((I>=C)&&((I+M)>=H)){B.turnOnRulerShade(E);B.dragRulerShade(A);}else{if(((I+M)>=C)&&(I<=C)){B.turnOnRulerShade(E);B.dragRulerShade(A);}else{B.turnOffRulerShade();}}}}}}}catch(D){microstrategy.errors.log(D);}};mstrDocViewerImpl.prototype.toggleRuler=function(){try{for(var D in this.rulers){var E=this.rulers[D];if(E){E.style.display=(this.rulerOn)?"none":"block";}}var C=document.getElementById("hRulerRow");if(C!=null){if(bIsW3C){C.style.display=(this.rulerOn)?"none":"table-row";}else{C.style.display=(this.rulerOn)?"none":"block";}}var A=document.getElementById("vRulerCol");if(A!=null){A.className=A.className.replace(/ off/g,"")+(this.rulerOn?" off":"");}this.rulerOn=!this.rulerOn;this.onwinresize();if(this.observer){this.observer.notifyAll("onstatechange");}this.updateManager.add([this.updateManager.createActionObject(null,mstrUpdateManager.SET_RULERS_DISPLAY,this.beanPath,["55002"],[this.rulerOn],[])],true);return this.rulerOn;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocViewerImpl.prototype.toggleGrid=function(){try{if(this.doc){for(var D in this.doc.sections){var B=this.doc.sections[D];for(var A in B.subsections){B.subsections[A].toggleGrid(this.gridOn);}}}this.gridOn=!this.gridOn;this.toggleDivider(this.gridOn);if(this.observer){this.observer.notifyAll("onstatechange");}this.updateManager.add([this.updateManager.createActionObject(null,mstrUpdateManager.SET_ALIGNMENT_GRID_DISPLAY,this.beanPath,["55002"],[this.gridOn],[])],true);return this.gridOn;}catch(C){microstrategy.errors.log(C);return false;}};mstrDocViewerImpl.prototype.toggleDivider=function(A){try{if(typeof (A)=="undefined"){A=!this.dividerOn;}this.dividerOn=A;var D=0;if(this.doc&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){for(var I in this.doc.sections){var F=this.doc.sections[I];for(var C=0;C<F.sibs.length;C++){var G=F.sibs[C];var H=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE);if(H){for(D=0;D<H.length;D++){H[D].style.display=(this.dividerOn)?"block":"none";}}var E=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);if(E){for(D=0;D<E.length;D++){E[D].style.display=(this.dividerOn)?"block":"none";}}}}this.doc.displayPageBreaker();this.doc.resetMask();if(this.commands){this.commands.exec("SyncSelections");}this.updateManager.add([this.updateManager.createActionObject(null,mstrUpdateManager.SET_DIVIDERS_DISPLAY,this.beanPath,["55002"],[this.dividerOn],[])],true);return this.dividerOn;}}catch(B){microstrategy.errors.log(B);}return null;};mstrDocViewerImpl.prototype.getNextObjId=function(){return this.nextId++;};mstrDocViewerImpl.prototype.getChildBone=function(C){try{if(this.doc==null||!this.doc.isLoaded){return null;}var A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(A){case microstrategy.OBJTYPE_DOC:return this.doc;break;case microstrategy.OBJTYPE_DOC_SUBSECTION:case microstrategy.OBJTYPE_DOC_SECTION:case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:return this.doc.getChildBone(C);break;}return null;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocViewerImpl.prototype.handleTaskModelReadyStateChange=function(A){try{this.doc.handleTaskModelReadyStateChange(A);}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.findParentSubsection=function(C){try{var A=microstrategy.findAncestorWithAtt(C.parentNode,"ty",microstrategy.OBJTYPE_DOC_SUBSECTION);if(A&&A.getAttribute("sty")){A=this.findParentSubsection(A);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrDocViewerImpl.prototype.isInteractiveViewModeEplus=function(D){if(!D){if(this.isFeatureAvailable(microstrategy.FEATURE_RW_INTERACTIVE_VIEW_MODE_EPLUS)){return true;}else{return false;}}var C=getEventTarget(D);if(!C){return true;}var E=microstrategy.eventManager.getSource(D);var F=false;var A=false;A=(E.bone!=null&&(E.bone.type==microstrategy.OBJTYPE_GRID||(E.bone.commands&&E.bone.commands.queryState("gridType")=="flash")));var B=(E.bone!=null&&(E.subType==microstrategy.SUBOBJTYPE_DOC_TEXT||E.subType==microstrategy.SUBOBJTYPE_DOC_IMAGE));if(this.isEditableViewModeEplus()){F=true;}else{if(this.isFeatureAvailable(microstrategy.FEATURE_RW_INTERACTIVE_VIEW_MODE_EPLUS)&&(A||B)){F=true;}}return F;};mstrDocViewerImpl.prototype.isEditableViewModeEplus=function(){return this.isFeatureAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS);};mstrDocViewerImpl.prototype.hasStylesFor=function(A){try{return this.renderedPanelStyles==null||this.renderedPanelStyles[A];}catch(B){microstrategy.errors.log(B);}};mstrDocViewerImpl.prototype.hasMultiDatasets=function(){try{if(!this.noDataset){var A=0;for(var C in this.documentDataSets){A++;if(A>1){return true;}}}return false;}catch(B){microstrategy.errors.log(B);}};function mstrDocViewerImpl(A){this.inherits=mstrStaticDocViewer;this.inherits(A);this.inherits=null;this.primaryBone=true;return this;}mstrStdToolbarImplScript=true;mstrStdToolbarImpl.ZOOM_BTN_TEXT=["Static","Fit Width","Fit Page"];mstrStdToolbarImpl.prototype=new mstrToolbarImpl();mstrStdToolbarImpl.prototype.zoomBtnInnerHTML="";mstrStdToolbarImpl.prototype.defaultExportFormat;mstrStdToolbarImpl.prototype.currentRWViewMode;mstrStdToolbarImpl.prototype.onload=function(){try{this.initToolbar();this.onselectionchange();this.onupdatemanagerchange();this.initZoom();this.initExportPicker();}catch(A){microstrategy.errors.log(A);return false;}};mstrStdToolbarImpl.prototype.onupdatemanagerchange=function(D){try{var E=this.getControlFromCmdId("undo");var F=this.getControlFromCmdId("redo");var B=this.getControlFromCmdId("apply");var A=this.getAppliesTo();if(A){if(F){if(A.commands&&A.commands.queryEnabled("redoq")){F.className="mstrIcon-tb";F.disabled=null;}else{F.className="mstrIcon-tb disabled";F.disabled="true";}}if(E){if(A.commands&&A.commands.queryEnabled("undoq")){E.className="mstrIcon-tb";E.disabled=null;}else{E.className="mstrIcon-tb disabled";E.disabled="true";}}if(B){if(A.commands&&A.commands.queryEnabled("doFlush")){B.className="mstrIcon-tb";B.disabled=null;}else{B.className="mstrIcon-tb disabled";B.disabled="true";}}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrStdToolbarImpl.prototype.onselectionchange=function(D){try{var C=this.getControlFromCmdId("copy");var E=this.getControlFromCmdId("cut");var F=this.getControlFromCmdId("delete");var A=this.getAppliesTo();if(A){if(C){if(A.commands&&A.commands.queryEnabled("copyq")){C.className="mstrIcon-tb";C.disabled=null;}else{C.className="mstrIcon-tb disabled";C.disabled="true";}}if(E){if(A.commands&&A.commands.queryEnabled("cutq")){E.className="mstrIcon-tb";E.disabled=null;}else{E.className="mstrIcon-tb disabled";E.disabled="true";}}if(F){if(A.commands&&A.commands.queryEnabled("deleteq")){F.className="mstrIcon-tb";F.disabled=null;}else{F.className="mstrIcon-tb disabled";F.disabled="true";}}this.adjustVisualization();}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrStdToolbarImpl.prototype.adjustVisualization=function(){try{mstrToolbarImpl.prototype.adjustVisualization.call(this,this.getControlFromCmdId("docSelectedVisualization"),this.getVisualizationAppliesTo(),this);this.displayVisModeButton("docVisualizationMode");var A=this.getAppliesTo();if(A&&A.commands.queryEnabled("docVisualizationMode")){var C=A.commands.queryState("docVisualizationMode");for(var B in this.controls){var E=this.controls[B];if(C==parseInt(E.getAttribute(microstrategy.HTMLATTR_CMD_VALUE))){E.className="mstrIcon-tb selected";}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrStdToolbarImpl.prototype.onaddtoclipboard=function(C){try{var D=this.getControlFromCmdId("paste");var A=this.getAppliesTo();if(A){if(D){D.className="";D.disabled=null;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrStdToolbarImpl.prototype.exec=function(B,D){try{var A=this.getAppliesTo();if(A){switch(B){case"apply":if(A.commands){(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?A.commands.exec("doFlush",false):A.commands.exec("doFlush");}return true;case"rwCurrentViewMode":case"rwChangeDesignMode":if(A.commands){A.commands.exec(B,D);}return true;case"undo":case"redo":case"copy":case"cut":case"paste":case"delete":if(A.commands){A.commands.exec(B);}return true;case"docVisualizationMode":return this.getVisualizationAppliesTo().commands.exec(B,D);case"export":var E=document.getElementById(this.defaultExportFormat);if(E){if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){exportRW(E.getAttribute("execMode"),E.getAttribute("target"));}}return true;}return false;}}catch(C){microstrategy.errors.log(C);return false;}};mstrStdToolbarImpl.prototype.execPicker=function(H,F){try{var K=true;var N=H.commandId;switch(N){case"docSelectedVisualization":var D=this.getVisualizationAppliesTo();if(D.commands.queryEnabled(N)){var A=findTarget(F,"id");if(A&&A.tagName.toLowerCase()=="span"){var C=this.getControlFromCmdId(N);var M=C.getAttribute("value");var J=F.getAttribute("id");if(M!=J){K=D.commands.exec(N,J);this.adjustVisualization();}else{K=true;}}else{K=false;}}break;case"zoom":var G=F.getAttribute("id").slice(7);var I;var L;if(G=="Width"){I=microstrategy.ZOOM_FIT_WIDTH;}else{if(G=="Page"){I=microstrategy.ZOOM_FIT_PAGE;}else{I=microstrategy.ZOOM_STATIC;}}if(G!=microstrategy.ZOOM_FACTOR||I!=microstrategy.zoomType){this.getAppliesTo().commands.exec("ZoomType",I);var B=this.getControlFromCmdId(N);if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&this.currentRWViewMode==microstrategy.RW_VIEW_MODE_FLASH){var D=this.getAppliesTo();if(D){D.callFlashPlayerFn("changeZoomType",[G,I]);}if(microstrategy.zoomType==microstrategy.ZOOM_STATIC){if(B){this.updatePulldownDisplayValue(B,G+this.zoomBtnInnerHTML);}K=this.getAppliesTo().commands.exec(N,G);}else{if(B){this.updatePulldownDisplayValue(B,mstrStdToolbarImpl.ZOOM_BTN_TEXT[microstrategy.zoomType]);}}}else{G=this.getNewZoomFactor(G,I);if(B){this.updatePulldownDisplayValue(B,G+this.zoomBtnInnerHTML);}K=this.getAppliesTo().commands.exec(N,G);}}break;case"export":if(F){if(F.getAttribute("id")!=this.defaultExportFormat){this.defaultExportFormat=F.getAttribute("id");microstrategy.updateManager.add([microstrategy.updateManager.createActionObject(this,mstrUpdateManager.SET_TOOLBAR_PROP,this.tbBeanPath,["75001","75002"],["defaultExportFormat",this.defaultExportFormat],[],null)],true);}this.markDefaultExportFormatOnPicker();this.exec(N);}return true;}return K;}catch(E){microstrategy.errors.log(E);return true;}};mstrStdToolbarImpl.prototype.getNewZoomFactor=function(B,A){switch(A){case microstrategy.ZOOM_STATIC:return B;case microstrategy.ZOOM_FIT_WIDTH:return this.getWidthZoomFactor();case microstrategy.ZOOM_FIT_PAGE:return Math.min(this.getHeightZoomFactor(),this.getWidthZoomFactor());}};mstrStdToolbarImpl.prototype.markDefaultExportFormatOnPicker=function(){try{if(this.defaultExportFormat){var A=document.getElementById("pkrExp0");if(A){A.className="mstrIcon-tb "+this.defaultExportFormat;}}}catch(B){microstrategy.errors.log(B);return true;}};mstrStdToolbarImpl.prototype.getWidthZoomFactor=function(){try{var A=document.getElementById("page");var E=document.getElementById("rwb_viewer");if(A&&E){var F=0;var D=0;if(A.style.borderLeftWidth&&(A.style.borderLeftWidth.indexOf("pt")>-1)){F+=parseInt(microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,parseInt(A.style.borderLeftWidth)));}if(A.style.borderRightWidth&&(A.style.borderRightWidth.indexOf("pt")>-1)){F+=parseInt(microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,parseInt(A.style.borderRightWidth)));}F+=getObjWidth(document.getElementById("docRszHandler"));if(document.getElementById("vRulerCol")){D=getObjWidth(document.getElementById("vRulerCol"));}var C=((getObjWidth(E)-F-2*SCROLLBAR_SIZE)/(getObjWidth(A)+D-F)*microstrategy.ZOOM_FACTOR-0.5).toFixed(0);if(C<0){return 1;}return C;}}catch(B){microstrategy.errors.log(B);return false;}};mstrStdToolbarImpl.prototype.getHeightZoomFactor=function(){try{var B=document.getElementById("page");var H=document.getElementById("rwb_viewer");var K=document.getElementById("rwb_ruler_table");if(B&&H){var F=0;var D=0;if(B.style.borderTopWidth&&(B.style.borderTopWidth.indexOf("pt")>-1)){F+=parseInt(microstrategy.number.toLocalUnits(mstrNumber.UNIT_PX,microstrategy.number.convertToUSUnits(mstrNumber.UNIT_PT,parseInt(B.style.borderTopWidth),true),true));}if(B.style.borderBottomWidth&&(B.style.borderBottomWidth.indexOf("pt")>-1)){F+=parseInt(microstrategy.number.toLocalUnits(mstrNumber.UNIT_PX,microstrategy.number.convertToUSUnits(mstrNumber.UNIT_PT,parseInt(B.style.borderBottomWidth),true),true));}if(document.getElementById("hRulerRow")){D=getObjHeight(document.getElementById("hRulerRow"));}var I=0;var J=microstrategy.objectListFind(B,"div","dsec");for(var G=0;G<J.length;G++){var L=J[G].firstChild;var A=(L.style.display=="block"||L.style.display=="");if(L.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_TITLEBAR&&A){I+=getObjHeight(L);}}var C=((getObjHeight(H)-F-2*SCROLLBAR_SIZE-I)/(getObjHeight(B)+D-I-F)*microstrategy.ZOOM_FACTOR-0.5).toFixed(0);if(C<0){return 1;}return C;}}catch(E){microstrategy.errors.log(E);return false;}};mstrStdToolbarImpl.prototype.selectPickerElement=function(C){try{var B=C.commandId;var F=null;switch(B){case"zoom":F="zoompkr"+microstrategy.ZOOM_FACTOR;var E=C.getElementsByTagName("span");for(var D=0,A=E.length;D<A;D++){if(E[D].id==F){E[D].className+=" selected";}else{E[D].className=E[D].className.replace(/\s*selected\b/,"");}}break;default:}}catch(G){microstrategy.errors.log(G);return false;}};mstrStdToolbarImpl.prototype.initZoom=function(){try{var A=this.getAppliesTo();if(A&&A.commands){this.currentRWViewMode=A.commands.queryState("rwCurrentViewMode");}var B=this.getControlFromCmdId("zoom");if(B&&B.firstChild){if(!this.zoomBtnInnerHTML){this.zoomBtnInnerHTML=B.firstChild.innerHTML;}if((microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&this.currentRWViewMode==microstrategy.RW_VIEW_MODE_FLASH)&&microstrategy.zoomType!=microstrategy.ZOOM_STATIC){this.updatePulldownDisplayValue(B,mstrStdToolbarImpl.ZOOM_BTN_TEXT[microstrategy.zoomType]);}else{this.updatePulldownDisplayValue(B,microstrategy.ZOOM_FACTOR+this.zoomBtnInnerHTML);}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrStdToolbarImpl.prototype.getVisualizationAppliesTo=function(){try{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION&&!microstrategy.getViewerBone().commands.queryState("selectedGrid")){return microstrategy.getViewerBone();}return this.getAppliesTo();}catch(A){microstrategy.errors.log(A);return false;}};mstrStdToolbarImpl.prototype.initExportPicker=function(){try{var A=document.getElementById("exportPicker");if(!A){return ;}if(!(A.childNodes&&A.childNodes.length>0)&&document.getElementById("pkrExp")){document.getElementById("pkrExp").style.display="none";return ;}this.initDefaultExportFormat(A);}catch(B){microstrategy.errors.log(B);return false;}};mstrStdToolbarImpl.prototype.initDefaultExportFormat=function(B){try{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){if(!this.defaultExportFormat){for(var A=0;A<B.childNodes.length;A++){if(B.childNodes[A]&&B.childNodes[A].getAttribute("default")=="true"){this.defaultExportFormat=B.childNodes[A].getAttribute("id");break;}}}}if(!this.defaultExportFormat||!document.getElementById(this.defaultExportFormat)){if(B.firstChild.childNodes&&B.firstChild.childNodes[0]){this.defaultExportFormat=B.firstChild.childNodes[0].getAttribute("id");}}this.markDefaultExportFormatOnPicker();}catch(C){microstrategy.errors.log(C);return false;}};function mstrStdToolbarImpl(A){this.inherits=mstrToolbarImpl;this.inherits(A);this.inherits=null;return this;}
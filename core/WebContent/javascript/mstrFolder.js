mstrFolderImplScript=true;mstrFolderImpl.prototype=new mstrBoneImpl();mstrFolderImpl.prototype.currentContextMenuNode=null;mstrFolderImpl.prototype.inlineRenameObject=null;mstrFolderImpl.prototype.folderId=null;mstrFolderImpl.prototype.serverName=null;mstrFolderImpl.prototype.projectName=null;mstrFolderImpl.prototype.portNum=null;mstrFolderImpl.prototype.minColWidth=[32,100,100,100,100,130];mstrFolderImpl.prototype.colCount=6;mstrFolderImpl.prototype.ascCss="mstrSortIconAsc";mstrFolderImpl.prototype.descCss="mstrSortIconDesc";mstrFolderImpl.prototype.onload=function(){try{this.initBone();this.initFolderBone();this.updateQuickSearchBone();scroll(0,0);}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.initFolderBone=function(){try{this.elem.oncontextmenu=new Function("e","microstrategy.bone('"+this.id+"').onContextMenu(e); return true;");this.commands=this.setCommands();if(!mstr.utils.ISIE7){this.table=this.findTable();if(this.table){this.elem.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e); return true;");this.colGroups=[this.table.children[0]];if(this.colGroups&&this.colGroups[0]){this.colCount=this.colGroups[0].childNodes.length;}this.headersNode=this.table.tHead;this.elem.onclick=new Function("e","microstrategy.bone('"+this.id+"').onclick(e); return true;");this._buildColGroup();}this.lockHeader();if(this.table){this.initSort(true);}else{this.initSort(false);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.setCommands=function(){return new mstrFolderCommands(this);};mstrFolderImpl.prototype.findTable=function(){return microstrategy.findChildWithAtt(this.elem,"table","id","FolderList");};mstrFolderImpl.prototype.lockHeader=function(){try{var me=this;me.divLock=me.cloneListHeader4Lock();if(!me.divLock){return ;}me.tableLocked=me.divLock.firstChild;me.headersNode_locked=me.tableLocked.tHead;me.colGroups.push(me.tableLocked.children[0]);}catch(err){microstrategy.errors.log(err);}};mstrFolderImpl.prototype.cloneListHeader4Lock=function(){try{var table=this.table||document.getElementById("FolderList");if(!table){return null;}var tableCloned=this.table.cloneNode(false);var colgroups=table.getElementsByTagName("colgroup");if(colgroups){for(var idx=0,len=colgroups.length;idx<len;idx++){tableCloned.appendChild(colgroups[idx].cloneNode(true));}}tableCloned.appendChild(table.tHead.cloneNode(true));var div=document.createElement("div");div.className="mstrListView-locked";var errNode=document.getElementById("mstrWeb_error");if(errNode){this.elem.style.marginTop=this.elem.offsetTop+"px";errNode.style.cssText="position: fixed; background: white; z-index: 1; width:"+errNode.offsetWidth+"px";}div.style.marginLeft=-(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";mstr.$D.attachEvent(window,"scroll",function(e){div.style.marginLeft=-(document.body.scrollLeft||document.documentElement.scrollLeft)+"px";});div.appendChild(tableCloned);table.parentNode.insertBefore(div,table);return div;}catch(err){microstrategy.errors.log(err);}};mstrFolderImpl.prototype._buildColWidths=function(){if(this.headersNode===undefined){return ;}this.colWidths=this.colWidths||[];var cws=this.colWidths;if(cws.length===0){for(var i=this.colCount-1;i>-1;i--){cws[i]=this.headersNode.rows[0].cells[i].offsetWidth;}}var w=0;for(var j=cws.length-1;j>-1;j--){w+=cws[j];}var availableWidth=document.getElementById("mstrWeb_content").clientWidth;this.table.style.width=this.headersNode.style.width=availableWidth+"px";if(this.tableLocked){this.tableLocked.style.width=this.headersNode_locked.style.width=this.table.offsetWidth+"px";}};mstrFolderImpl.prototype._buildColGroup=function _buildColGroup(){this._buildColWidths();var ci=this.resizingIndex,cws=this.colWidths,cgs=this.colGroups;if(cgs&&cgs[0].childNodes.length==this.colCount){if((ci!==null&&ci>=0)){for(var j=cgs.length-1;j>-1;j--){for(var k=cgs[j].childNodes.length-1;k>-1;k--){cgs[j].childNodes[k].style.width=cws[k]+"px";}}}}else{var cg=document.createElement("colgroup");for(var i=0,cnt=this.colCount;i<cnt;i++){var col=document.createElement("col");col.style.width=cws[i]+"px";cg.appendChild(col);}var fnCG=function(w,cg){w[(w.firstChild.tagName.toLowerCase()!="colgroup")?"insertBefore":"replaceChild"](cg,w.firstChild);};fnCG(this.headersNode,cg);var cg2=cg.cloneNode(true);fnCG(this.itemsNode,cg2);this.colGroups=[cg,cg2];}};mstrFolderImpl.prototype.initSort=function(isListView){if(!microstrategy.bones.folderAllModes){return ;}this.folderId=microstrategy.bones.folderAllModes.folderId;if(!this.folderId){return ;}var sortJson=this.loadSorting(this.folderId);if(!sortJson){return ;}if(isListView){this.sortListViewObjectBrowser(sortJson.SortColID,sortJson.isAscSort);}else{this.sortFolderViewObjectBrowser(sortJson.SortColID,sortJson.isAscSort);}};mstrFolderImpl.prototype.loadSorting=function(){if(!this.folderId){return ;}var localStorageKey="ObjectBrowserSorting_"+mstrConfig.lastMsgKey;if(typeof (Storage)!="undefined"&&window.JSON){var sortJsonArray=null;if(localStorage.getItem(localStorageKey)){sortJsonArray=JSON.parse(localStorage.getItem(localStorageKey));}if(sortJsonArray){for(var i=0;i<sortJsonArray.length;i++){if(sortJsonArray[i].folderID==this.folderId){return sortJsonArray[i];}}}}return null;};mstrFolderImpl.prototype.saveSorting=function(sortColId,isAscSort){if(typeof (Storage)=="undefined"||!window.JSON){return ;}if(!this.folderId){return ;}var localStorageKey="ObjectBrowserSorting_"+mstrConfig.lastMsgKey;var sortJsonArray=null;if(localStorage.getItem(localStorageKey)!=null){sortJsonArray=JSON.parse(localStorage.getItem(localStorageKey));}if(sortJsonArray){var hasSort=false;for(var i=0;i<sortJsonArray.length;i++){if(sortJsonArray[i].folderID==this.folderId){sortJsonArray[i].SortColID=sortColId;sortJsonArray[i].isAscSort=isAscSort;hasSort=true;break;}}if(!hasSort){sortJsonArray[length]={folderID:this.folderId,SortColID:sortColId,isAscSort:isAscSort};}}else{sortJsonArray=[];sortJsonArray[0]={folderID:this.folderId,SortColID:sortColId,isAscSort:isAscSort};}localStorage.setItem(localStorageKey,JSON.stringify(sortJsonArray));};mstrFolderImpl.prototype.onclick=function(e){this.onselectstartFn=document.onselectstart;var hWin=window,e=e||window.event;var tgt=mstr.$E.target(e,hWin);var headerTag=tgt.parentNode.parentNode.parentNode.parentNode.parentNode;if(!tgt||!headerTag||headerTag.getAttribute("class")!="mstrListView-locked"||!tgt.parentNode.previousSibling||!tgt.parentNode.nextSibling){return ;}var sortCol=tgt.parentNode.cellIndex;var isAscSort=true;var sortNode=null;sortNode=microstrategy.findChildWithAtt(this.elem,"span","id",this.descCss);if(!sortNode){sortNode=microstrategy.findChildWithAtt(this.elem,"span","id",this.ascCss);}if(!sortNode){return ;}if(sortNode.parentNode.parentNode.cellIndex==sortCol){isAscSort=sortNode.id==this.ascCss?false:true;}else{if(sortCol==3){isAscSort=false;}}this.sortListViewObjectBrowser(sortCol,isAscSort);this.saveSorting(sortCol,isAscSort);};mstrFolderImpl.prototype.sortFolderViewObjectBrowser=function(sortCol,isAscSort){var sortfolders=[],sortObjects=[];var tableDiv=microstrategy.findChildWithAtt(this.elem,"table","id","FolderIcons");var tbodyDiv=tableDiv.getElementsByTagName("tbody")[0];var rows=tbodyDiv.childNodes;microstrategy.showWait(true);for(var i=0;i<rows.length;i++){var tdNodes=rows[i].childNodes;for(var j=0;j<tdNodes.length;j++){if(isFolder(tdNodes[j])){sortfolders.push(tdNodes[j]);}else{sortObjects.push(tdNodes[j]);}}}switch(sortCol){case 1:sortfolders.sort(sortFolderViewByName);sortObjects.sort(sortFolderViewByName);break;case 2:sortfolders.sort(sortFolderViewByOwner);sortObjects.sort(sortFolderViewByOwner);break;case 3:sortfolders.sort(sortFolderViewByDate);sortObjects.sort(sortFolderViewByDate);break;case 4:sortfolders.sort(sortFolderViewByDesc);sortObjects.sort(sortFolderViewByDesc);break;}while(tbodyDiv.hasChildNodes()){tbodyDiv.removeChild(tbodyDiv.firstChild);}var allobjects=[];if(isAscSort){allobjects=sortfolders.concat(sortObjects);}else{allobjects=sortObjects.reverse().concat(sortfolders.reverse());}for(var i=0;i<=allobjects.length/2-1;i++){var row=document.createElement("tr");row.appendChild(allobjects[2*i]);row.appendChild(allobjects[2*i+1]);tbodyDiv.appendChild(row);}if(tbodyDiv.childNodes.length<allobjects.length/2){var row=document.createElement("tr");row.appendChild(allobjects[allobjects.length-1]);tbodyDiv.appendChild(row);}microstrategy.showWait(false);function sortFolderViewByName(a,b){var nameDivA=microstrategy.findChildWithCssClass(a,"div","mstrLargeIconViewItemName");var nameDivB=microstrategy.findChildWithCssClass(b,"div","mstrLargeIconViewItemName");var nameA=nameDivA.innerText||nameDivA.textContent||"";var nameB=nameDivB.innerText||nameDivB.textContent||"";return nameA.localeCompare(nameB);}function sortFolderViewByOwner(a,b){var ownerDivA=microstrategy.findChildWithCssClass(a,"div","mstrLargeIconViewItemOwner");var ownerDivB=microstrategy.findChildWithCssClass(b,"div","mstrLargeIconViewItemOwner");var ownerA=ownerDivA.innerText||ownerDivA.textContent||"";var ownerB=ownerDivB.innerText||ownerDivB.textContent||"";var returnValue=ownerA.localeCompare(ownerB);if(!returnValue){return sortFolderViewByName(a,b);}return returnValue;}function sortFolderViewByDate(a,b){var timeDivA=microstrategy.findChildWithCssClass(a,"div","mstrLargeIconViewItemModified");var timeDivB=microstrategy.findChildWithCssClass(b,"div","mstrLargeIconViewItemModified");var longA=Number(timeDivA.getElementsByTagName("div")[0].getAttribute("timestamp"));var longB=Number(timeDivB.getElementsByTagName("div")[0].getAttribute("timestamp"));if(longA>longB){return 1;}else{if(longA==longB){return 0;}else{if(longA<longB){return -1;}}}}function sortFolderViewByDesc(a,b){var descDivA=microstrategy.findChildWithCssClass(a,"div","mstrLargeIconViewItemDescription");var descDivB=microstrategy.findChildWithCssClass(b,"div","mstrLargeIconViewItemDescription");var descTextA=descDivA.innerText||descDivA.textContent||"";var descTextB=descDivB.innerText||descDivB.textContent||"";var returnValue=descTextA.localeCompare(descTextB);if(!returnValue){return sortFolderViewByName(a,b);}return returnValue;}function isFolder(tdNode){if(microstrategy.findChildWithAtt(tdNode,"span","class","mstrIcon-lg mstrIcon-lg-f")){return true;}return false;}};mstrFolderImpl.prototype.sortListViewObjectBrowser=function(sortCol,isAscSort){var rowFolder=[],rowObject=[];var bandingCount=0;var folderDiv=microstrategy.findChildWithAtt(document,"div","scriptclass","mstrFolderImpl");var headerDiv=microstrategy.findChildWithAtt(folderDiv,"div","class","mstrListView-locked");var sortNode=microstrategy.findChildWithAtt(headerDiv,"span","id",this.ascCss);if(!sortNode){sortNode=microstrategy.findChildWithAtt(headerDiv,"span","id",this.descCss);}if(!sortNode){return ;}microstrategy.showWait(true);if(isAscSort&&sortNode.id==this.descCss){sortNode.id=this.ascCss;}else{if(!isAscSort&&sortNode.id==this.ascCss){sortNode.id=this.descCss;}}var iconRow=headerDiv.getElementsByTagName("tr")[0];iconRow.childNodes[sortCol].getElementsByTagName("div")[0].appendChild(sortNode);var table=headerDiv.nextSibling;var tbody=table.getElementsByTagName("tbody")[0];var rows=tbody.childNodes;for(var i=0;i<rows.length;i++){if(microstrategy.findChildWithCssClass(rows[i].childNodes[0],"span","mstrIcon-lv mstrIcon-lv-f")){rowFolder.push(rows[i]);}else{rowObject.push(rows[i]);}}switch(sortCol){case 1:rowFolder.sort(sortRowByName);rowObject.sort(sortRowByName);break;case 2:rowFolder.sort(sortRowByOwner);rowObject.sort(sortRowByOwner);break;case 3:rowFolder.sort(sortRowByDate);rowObject.sort(sortRowByDate);break;case 4:rowFolder.sort(sortRowByDesc);rowObject.sort(sortRowByDesc);break;}while(tbody.hasChildNodes()){tbody.removeChild(tbody.firstChild);}var sortedRows=[];if(isAscSort){sortedRows=rowFolder.concat(rowObject);}else{sortedRows=rowObject.reverse().concat(rowFolder.reverse());}for(var i=0;i<sortedRows.length;i++){bandingCount++;applyBanding(sortedRows[i],bandingCount);tbody.appendChild(sortedRows[i]);}microstrategy.showWait(false);function sortRowByName(a,b){var sortCol=1;var nodeA=a.childNodes[sortCol];var nodeB=b.childNodes[sortCol];var strA=nodeA.innerText||nodeA.textContent||"";var strB=nodeB.innerText||nodeB.textContent||"";return strA.localeCompare(strB);}function sortRowByOwner(a,b){var sortCol=2;var nodeA=a.childNodes[sortCol];var nodeB=b.childNodes[sortCol];var strA=nodeA.innerText||nodeA.textContent||"";var strB=nodeB.innerText||nodeB.textContent||"";var returnValue=strA.localeCompare(strB);if(!returnValue){return sortRowByName(a,b);}else{return returnValue;}}function sortRowByDate(a,b){var sortCol=3;var longA=Number(a.childNodes[sortCol].childNodes[0].getAttribute("timestamp"));var longB=Number(b.childNodes[sortCol].childNodes[0].getAttribute("timestamp"));if(longA>longB){return 1;}else{if(longA==longB){return 0;}else{if(longA<longB){return -1;}}}}function sortRowByDesc(a,b){var sortCol=4;var nodeA=a.childNodes[sortCol];var nodeB=b.childNodes[sortCol];var strA=nodeA.innerText||nodeA.textContent||"";var strB=nodeB.innerText||nodeB.textContent||"";var returnValue=strA.localeCompare(strB);if(!returnValue){return sortRowByName(a,b);}else{return returnValue;}}function applyBanding(row,bandingCount){if(bandingCount%2==0&&!row.hasAttribute("class")){row.setAttribute("class","mstrBandOn");}else{if(bandingCount%2!=0&&row.hasAttribute("class")){row.removeAttribute("class");}}}};mstrFolderImpl.prototype.onmousedown=function(e){this.onselectstartFn=document.onselectstart;var hWin=window,e=e||window.event;var tgt=mstr.$E.target(e,hWin);if(tgt&&tgt.tagName.toLowerCase()=="td"&&tgt.parentNode.parentNode.tagName.toLowerCase()=="thead"){document.onselectstart=function(){return false;};var pos=tgt.offsetLeft+tgt.offsetWidth-getDocumentScrollLeft();this.resizingIndex=tgt.cellIndex;this.startx=mstr.$E.getMousePosition(e,hWin).x;var buildRszHandle=function(x){var h=document.createElement("div");h.className="mstrListView-rzHandle";h.style.left=x+"px";return h;};var rh=this.resizeHandle||buildRszHandle(pos);if(!this.resizeHandle||!mstr.$D.containsElement(this.elem,rh)){this.resizeHandle=rh;this.elem.appendChild(rh);}else{rh.style.left=pos+"px";}rh.style.display="block";this.elem.className+=" resizing";var me=this;var mousemove=function(e){rh.style.left=Math.max(0,pos+mstr.$E.getMousePosition(e,hWin).x-me.startx)+"px";};var mouseup=function(e){if(rh){rh.style.display="none";mstr.$D.detachEvent(document,"mousemove",mousemove);mstr.$D.detachEvent(document,"mouseup",mouseup);}me.elem.className=me.elem.className.replace(/ resizing/,"");document.onselectstart=me.onselectstartFn;var ri=me.resizingIndex;if(ri>=0&&ri!=me.colWidths.length-1){calculateCWs(me,e);me._buildColGroup();me.resizingIndex=null;}};var calculateCWs=function(me,e){var colWs=me.colWidths,mColWs=me.minColWidth,ri=me.resizingIndex,li=colWs.length-1,oldCW=colWs[ri],delta;colWs[ri]=Math.max(mColWs[ri],colWs[ri]+mstr.$E.getMousePosition(e,hWin).x-me.startx);delta=colWs[ri]-oldCW;while(delta!=0&&li>=ri){if(colWs[li]-delta>=mColWs[li]){colWs[li]-=delta;delta=0;}else{delta-=colWs[li]-mColWs[li];colWs[li]=mColWs[li];li--;}}};mstr.$D.attachEvent(document,"mousemove",mousemove);mstr.$D.attachEvent(document,"mouseup",mouseup);}};mstrFolderImpl.prototype.onContextMenu=function(e){try{if(!e){e=window.event;}var oTarget=getEventTarget(e);if(oTarget.tagName.toLowerCase()!="tr"){oTarget=findTargetTag(oTarget,"tr");}if(oTarget.tagName.toLowerCase()=="tr"){this.currentContextMenuNode=oTarget;}else{this.currentContextMenuNode=null;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.processRename=function(){try{if(this.inlineRenameObject){this.inlineRenameObject.processRename(this.beanPath);this.inlineRenameObject=null;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.cancelRename=function(){try{if(this.inlineRenameObject){this.inlineRenameObject.cancelRename();this.inlineRenameObject=null;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.getNameTag=function(){try{return microstrategy.findChildWithAtt(this.currentContextMenuNode,"span","sty","nm");}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.getCurrentContextId=function(){return microstrategy.findChildWithAtt(this.currentContextMenuNode,"td","oty","1").getAttribute("oid");};mstrFolderImpl.prototype.getObjInfo=function(){var tr=this.currentContextMenuNode;if(tr){var tds=tr.getElementsByTagName("td"),td;for(var i=0,len=tds.length;i<len;i++){td=tds[i];if(td.getAttribute("oid")){var nameNode=microstrategy.findChildWithAtt(tr,"span",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.HTMLATTR_NAME),name="";if(nameNode){name=nameNode.firstChild.getAttribute("title");}return{id:td.getAttribute("oid"),ty:td.getAttribute("oty"),n:name};}}}return null;};mstrFolderImpl.prototype.enableRenameField=function(objectType,objectId){try{if(this.currentContextMenuNode){this.inlineRenameObject=new mstrInlineRenameImpl();this.inlineRenameObject.parentBone=this;this.inlineRenameObject.enableRenameField(objectType,objectId);}}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderImpl.prototype.openCustomGroupEditor=function(customGroupId){microstrategy.openCustomGroupEditor(customGroupId);};mstrFolderImpl.prototype.openMetricEditor=function(metricId,type){microstrategy.openMetricEditor(metricId,type);};mstrFolderImpl.prototype.openDataImport=function(reportId,type){microstrategy.openDataImprot(reportId,type);};mstrFolderImpl.prototype.openACLEditor=function(reportId,type){microstrategy.openACLEditor(reportId,type);};mstrFolderImpl.prototype.updateQuickSearchBone=function(){var qsBone=microstrategy.bone("mstrSearchSuggest");if(qsBone&&qsBone.isMiniSearchBox){if(this.folderName){qsBone.rootFolderName=mstr.utils.String.escape4HTMLText(this.folderName);}if(this.sysFolder!=undefined){qsBone.rootFolderType=this.sysFolder;}if(this.folderId){qsBone.rootFolderID=this.folderId;}qsBone.updateTipText();}};mstrFolderImpl.prototype.showExportLink=function(url,showIframe,name){mstrFolderActions.exportLink(url,this.serverName,this.projectName,this.portNum,showIframe,name);};mstrFolderImpl.prototype.onwinresize=function(){this._buildColWidths();};function mstrFolderImpl(id){this.inherits=mstrBoneImpl;this.inherits(id);delete this.inherits;return this;}mstrFolderCommands.prototype={};mstrFolderCommands.prototype.exec=function(cmdId,cmdArgs){switch(cmdId){case"edit":this.parentBone.openCustomGroupEditor(this.parentBone.getCurrentContextId());break;case"newCGE":this.parentBone.openCustomGroupEditor();break;case"newIVE":microstrategy.createIVE.call(this.parentBone);break;case"newIVEHTML5VI":microstrategy.createIVE.call(this.parentBone,true);break;case"newBlankVI":var isHTML5=!microstrategy.isFeatureAvailable("flashvi");if(isHTML5&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){showMessage({contents:microstrategy.descriptors.getDescriptor(12187),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}else{var um=microstrategy.updateManager,ac=[];ac.push(um.createActionObject(null,mstrUpdateManager.CREATE_BLANK_VI,microstrategy.servletName,[],[]));um.add(ac);um.useIframe=false;um.flushAndSubmitChanges();}break;case"ACLEditor":var oi=this.parentBone.getObjInfo();if(oi){this.parentBone.openACLEditor(oi.id,oi.ty);}break;case"shareEditor":var oi=this.parentBone.getObjInfo();microstrategy.showSharingEditor(cmdArgs.url,{objectName:cmdArgs.name,objId:oi.id,objType:oi.ty,mid:-1});break;case"newME":this.parentBone.openMetricEditor(null,"mstrME");break;case"newSME":this.parentBone.openMetricEditor(null,"mstrSME");break;case"newFSE":this.parentBone.openMetricEditor(null,"mstrFSE");break;case"openME":var oi=this.parentBone.getObjInfo();if(oi){this.parentBone.openMetricEditor(oi.id);}break;case"openDataImport":microstrategy.openDataImport.call(this.parentBone,cmdArgs);break;case"republishCube":var cubeId=cmdArgs.ReportId,me=this;microstrategy.getCubesInfo([cubeId],function(cubesInfo){var cb=function(){me.exec("openDataImport",cmdArgs);};if(cubesInfo[cubeId]&&cubesInfo[cubeId].ddam===2){showMessage({contents:microstrategy.descriptors.getDescriptor(13885),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,type:mstrMsgBoxImpl.MSG_INFO_WARNING,okEval:cb,focusButton:microstrategy.CANCEL_BUTTON});return ;}cb();});break;case"findDependents":var item=this.parentBone.getObjInfo();var searchEditor=mstrmojo.insert({scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-Search-editor",zIndex:102,title:microstrategy.descriptors.getDescriptor(14532)+" "+item.n,children:[{scriptClass:"mstrmojo.mstr.search.Search",id:"search",searchProps:mstrmojo.hash.copy({uses:item.id+":"+item.ty,objectType:[3,18,14081],dereferenceshortcut:0,rootFolderID:"",rootFolderType:39,searchPattern:"*"},mstrmojo.hash.copy(mstrConfig.searchProps)),allowEmptyInput:true,resultsOnly:true,getNotFoundMsg:function getNotFoundMsg(){var escape4HTML=function(txt){return"<b>"+mstrmojo.string.escape4HTMLText(txt)+"</b>";};var msg=mstrmojo.desc(14557,"Your search for dependents of ## in ### returned no results").replace("###",escape4HTML(mstrConfig.projectName)).replace("##",escape4HTML(item.n));return msg;}}],onOpen:function(){var offsetTop=45;this.set("top",mstrmojo.dom.getVerticalScroll()+offsetTop+"px");},onClose:function(){this.destroy();}});searchEditor.render();searchEditor.open();mstrmojo.all.search.forceSearch();break;}};mstrFolderCommands.prototype.queryVisible=function(cmdId,cmdValue){try{var item=this.parentBone.getObjInfo();if(!item){return false;}switch(cmdId){case"canFindDependents":var nonSupportedTypes=[8,18];return mstr.$A.find(nonSupportedTypes,parseInt(item.ty,10))==-1;}}catch(err){microstrategy.errors.log(err);}};function mstrFolderCommands(parentBone){this.parentBone=parentBone;return this;}
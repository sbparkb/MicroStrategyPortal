mstrSubscriptionsFolderImplScript=true;mstrSubscriptionsFolderImpl.prototype=new mstrBoneImpl();mstrSubscriptionsFolderImpl.DMODES={INBOX:16,MOBILE:128,EMAIL:1,FILE:2,PRINT:4,FTP:8192,PERSONAL_VIEW:4096,CACHE:64};mstrSubscriptionsFolderImpl.VMODES={GRID:0,GRAPH:1,GRIDGRAPH:2,DOC:3,RW:4,BULK:5,DATAMART:6,ICUBE:7,DASHBOARD:9};mstrSubscriptionsFolderImpl.prototype.um=null;mstrSubscriptionsFolderImpl.prototype.onload=function(){try{this.initBone();var DM=mstrSubscriptionsFolderImpl.DMODES;for(var mo in DM){var m=DM[mo];var tbl=document.getElementsByName("ncsList"+m);if(tbl&&tbl.length>=0){for(var i=0;i<tbl.length;i++){tbl[i].tBodies[0].onclick=new Function("e","var b = microstrategy.bone('"+this.id+"'); return b && b.onClick(e);");if(tbl[i].tHead){tbl[i].tHead.onclick=new Function("e","var b = microstrategy.bone('"+this.id+"'); return b && b.sortSubs(e);");}tbl[i].onmouseover=new Function("e","var b = microstrategy.bone('"+this.id+"'); return b && b.onMouseOver(e);");}}}this.um=microstrategy.updateManager;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubscriptionsFolderImpl.prototype.onClick=function(e){var elem=getEventTarget(e),tr=microstrategy.findAncestorWithTag(elem,"TR"),idxStr=tr?tr.getAttribute("idx"):null,idx=idxStr?idxStr.split("_"):null;if(idx&&idx.length>=2){var tp=parseInt(idx[0]),n=parseInt(idx[1]),items=this._getItems(elem),item=items?items[n]:null,cmd=elem.getAttribute("cmd")||(window.mstrInterfacePlugin?elem.parentNode.getAttribute("cmd"):null);if(item&&cmd){var isHTML5Vi=item.vm==8192,isFlashVi=item.vm==2048;if(isHTML5Vi||isFlashVi){var renderFlash=microstrategy.isFeatureAvailable("flashvi"),descId="";if(isHTML5Vi&&renderFlash){descId=13649;}else{if((isHTML5Vi||isFlashVi&&!renderFlash)&&(mstr.utils.ISIE6||mstr.utils.ISIE7||mstr.utils.ISIE8)){descId=12187;}}if(descId){showMessage({contents:microstrategy.descriptors.getDescriptor(descId),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}}switch(cmd){case"tgt":case"tgti":this.viewTarget(item.sID,item.tTp,item.tID);break;case"edit":this.editSubs(tp,item.sID);break;case"psn":this.editPersonalization(tp,item.sID);break;case"rmv":this.rmvSubs(item.sID);break;case"chk":this.updateChkbox(elem,item.sID);break;case"mult":var tbl=microstrategy.findAncestorWithTag(elem,"TABLE");var cNO=item.cNO;if(tbl&&cNO){this.onClickMulti(tbl,elem,n+1,cNO);}break;}}}};mstrSubscriptionsFolderImpl.prototype.onMouseOver=function(e){var elem=getEventTarget(e);if(!elem.getAttribute("title")){var cmd=elem?elem.getAttribute("cmd"):null;var fld=elem?elem.getAttribute("fld"):null;var desc=null;if(cmd=="tgti"){this.showTgtName(elem);}else{if(cmd){desc={mult:"3296",edit:"1088",psn:"6073",chk:"1087",rmv:"1087"}[cmd];}else{if(fld){var si=this._getSortInfo(elem);desc=(si&&fld==si.field&&si.asc==0)?"192":"191";}}if(desc){elem.setAttribute("title",microstrategy.descriptors.getDescriptor(desc));}}}};mstrSubscriptionsFolderImpl.prototype.onClickMulti=function(tbl,elem,n,cNO){if(tbl&&elem){var tbody=tbl.tBodies[0];var rows=tbody?tbody.rows:null;if(rows&&n<rows.length){for(i=n;i<n+cNO;i++){var r=rows[i];var dis=r.style.display=="none"?"":"none";var cn=(dis=="none")?"ncsExpand":"ncsCollapse";var t=microstrategy.descriptors.getDescriptor(((dis=="none")?"3296":"1995"));r.style.display=dis;elem.className=cn;elem.setAttribute("title",t);}}}};mstrSubscriptionsFolderImpl.prototype.viewTarget=function(subsID,targetTp,tID){var um=this.um;var EVT=mstrUpdateManager;if(um&&EVT){var vm=mstrSubscriptionsFolderImpl.VMODES;var ac=new Array();var newWin=null;var winName=null;var hl=this.save2HL?"1":"0";if(targetTp==vm.RW&&this.PDF){if(this.newWin){newWin=um.getNewWindowSetting();winName=um.newWindowName;um.setNewWindowSetting(true);um.newWindowName=this.newWin;}}else{if(this.newWinExec){newWin=um.getNewWindowSetting();winName=um.newWindowName;um.setNewWindowSetting(true);um.newWindowName=this.newWinExec;}}switch(targetTp){case vm.GRID:case vm.GRAPH:case vm.GRIDGRAPH:ac.push(um.createActionObject(null,EVT.REPORT_INIT_FROM_SUBSCRIPTION,null,["4163","4115","4172"],[subsID,targetTp+1,hl],[],null));break;case vm.DOC:ac.push(um.createActionObject(null,EVT.DOCUMENT_INIT_FROM_SUBSCRIPTION,null,["32316","32317"],[subsID,hl],[],null));break;case vm.RW:ac.push(um.createActionObject(null,EVT.RW_INIT_FROM_SUBSCRIPTION,null,["2048058"],[subsID],[],null));if(this.PDF){ac.push(um.createActionObject(null,EVT.RW_EXPORT,null,["3115"],[3],[],null));}break;case vm.DASHBOARD:ac.push(um.createActionObject(null,EVT.HTML5_VI_INIT_FROM_SUBSCRIPTION,null,["2048058"],[subsID],[],null));break;case vm.BULK:return ;case vm.DATAMART:case vm.ICUBE:ac.push(um.createActionObject(null,EVT.REPORT_INIT_FROM_SUBSCRIPTION,null,["4163","4172"],[subsID,hl],[],null));um.addURL("SubscriptionReportID="+tID);break;}if(ac.length>0){um.add(ac);um.useIframe=false;um.flushAndSubmitChanges();if(newWin!=null){um.setNewWindowSetting(newWin);}if(winName!=null){um.newWindowName=winName;}}}};mstrSubscriptionsFolderImpl.prototype.showTgtName=function(elem){var tr=microstrategy.findAncestorWithTag(elem,"TR"),idxStr=tr?tr.getAttribute("idx"):null,idx=idxStr?idxStr.split("_"):null;if(idx&&idx.length>=2){var tp=parseInt(idx[0]),n=parseInt(idx[1]),items=this._getItems(elem),item=items?items[n]:null;if(item&&item.tl){elem.setAttribute("title",item.tl);}}};mstrSubscriptionsFolderImpl.prototype.editSubs=function(subsTp,subsID){this._edit(subsTp,subsID,2);};mstrSubscriptionsFolderImpl.prototype.editPersonalization=function(subsTp,subsID){this._edit(subsTp,subsID,1);};mstrSubscriptionsFolderImpl.prototype.updateChkbox=function(input,subsID){if(input&&subsID){input.value=subsID;input.id=input.name="objectIDs";}};mstrSubscriptionsFolderImpl.prototype.rmvSubs=function(subsID){var um=this.um;if(um&&subsID){um.add([um.createActionObject(null,mstrUpdateManager.DELETE_SUBSCRIPTION,this.beanPath,["128001"],[subsID],[],null)]);um.useIframe=false;um.flushAndSubmitChanges();}};mstrSubscriptionsFolderImpl.prototype.sortSubs=function(e){var elem=getEventTarget(e);var mode=this._getMode(elem);var si=this._getSortInfo(elem);var field=elem?elem.getAttribute("fld"):null;if(si&&field){var asc=(field==si.field)?si.asc:1;var um=this.um;if(um){um.add([um.createActionObject(null,mstrUpdateManager.SORT_SUBSCRIPTIONS,this.beanPath,["128009","128003","128004"],[mode,field,asc],[],null)]);um.useIframe=false;um.flushAndSubmitChanges();}}};mstrSubscriptionsFolderImpl.prototype._getMode=function(elem){var tbl=elem?microstrategy.findAncestorWithTag(elem,"TABLE"):null;return(tbl&&tbl.id&&tbl.id.substring(0,7)=="ncsList")?tbl.id.substring(7):null;};mstrSubscriptionsFolderImpl.prototype._getSortInfo=function(elem){var items=this._getItems(elem);return(items?items.sortInfo:null);};mstrSubscriptionsFolderImpl.prototype._getItems=function(elem){if(!this.items){return null;}var tr=elem?microstrategy.findAncestorWithTag(elem,"TR"):null,idxStr,idx,mode;if(!tr||tr.getAttribute("idx")==null){var table=elem?microstrategy.findAncestorWithTag(elem,"TABLE"):null,rows=table&&table.rows,len=rows.length||0,i;for(i=0;i<len;i++){tr=rows[i];if(tr.getAttribute("idx")!=null){break;}}}idxStr=tr?tr.getAttribute("idx"):null;idx=idxStr?idxStr.split("_"):null;if(idx&&idx.length>=2){mode=idx[0];if(this.items[mode]){return this.items[mode];}if(mode==mstrSubscriptionsFolderImpl.DMODES.PERSONAL_VIEW&&idx.length==3){return this.items[mode+"_"+idx[2]];}}return null;};mstrSubscriptionsFolderImpl.prototype._edit=function(subsTp,subsID,mode){var evt=this._getEditEvt(subsTp);var um=this.um;if(um&&evt){um.add([um.createActionObject(null,evt,null,["3001","256012"],[subsID,mode],[],null)]);um.useIframe=false;um.flushAndSubmitChanges();}};mstrSubscriptionsFolderImpl.prototype._getEditEvt=function(tp){var m=mstrSubscriptionsFolderImpl.DMODES;var EVT=mstrUpdateManager;switch(tp){case m.INBOX:return EVT.EDIT_INBOX_SUBSCRIPTION;case m.CACHE:return EVT.EDIT_CACHE_SUBSCRIPTION;case m.MOBILE:return EVT.EDIT_MOBILE_SUBSCRIPTION;case m.EMAIL:return EVT.EDIT_EMAIL_SUBSCRIPTION;case m.FILE:return EVT.EDIT_FILE_SUBSCRIPTION;case m.PRINT:return EVT.EDIT_PRINT_SUBSCRIPTION;case m.FTP:return EVT.EDIT_FTP_SUBSCRIPTION;case m.PERSONAL_VIEW:return EVT.EDIT_PERSONAL_VIEW_SUBSCRIPTION;case m.PERSONAL_VIEW:return EVT.EDIT_PERSONAL_VIEW_SUBSCRIPTION;default:return null;}};function mstrSubscriptionsFolderImpl(id){this.inherits=mstrBoneImpl;this.inherits(id);delete this.inherits;return this;}
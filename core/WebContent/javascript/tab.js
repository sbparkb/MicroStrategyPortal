mstrTabImplScript=true;mstrTabImpl.prototype=new mstrEditorImpl();mstrTabImpl.prototype.settings=new Array();mstrTabImpl.prototype.settingsNameArray=new Array();mstrTabImpl.prototype.enforceSubmit=false;mstrTabImpl.prototype.currentPropertyName=null;mstrTabImpl.prototype.tabManager=null;mstrTabImpl.prototype.PIXEL_WIDTH=2;mstrTabImpl.prototype.cmdLevel=null;mstrTabImpl.prototype.appliesTo=null;mstrTabImpl.prototype.tabSwitch=null;mstrTabImpl.CMD_TYPE_DEFAULT=0;mstrTabImpl.CMD_TYPE_BITFLAG=1;mstrTabImpl.prototype.onload=function(){try{this.initEditor();if(this.elem&&this.elem.parentNode){var appliesTo=this.elem.parentNode.getAttribute("at");if(appliesTo&&appliesTo.length>0){this.appliesTo=appliesTo;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.onunload=function(e){try{mstrEditorImpl.prototype.onunload.call(this,e);var bone=this.getAppliesTo();if(bone&&bone.observer){bone.observer.unregister(this.id);}}catch(err){microstrategy.errors.log(err);}return true;};mstrTabImpl.prototype.exec=function(cmdId,cmdVal){try{switch(cmdId){case"advColorPicker":var info=cmdVal.split("|");var dropDown=document.getElementById(info[0]);if(dropDown){this.updateColorPicker(dropDown,info[1]);}break;case"edtColorGradient":var info=cmdVal.split("|");var dropDown=document.getElementById(info[0]);var gradientValue=info[1].split(",");if(gradientValue.length>=2&&(gradientValue[0]==gradientValue[1])){if(dropDown){this.updateColorPicker(dropDown,gradientValue[0]);}break;}else{if(dropDown){dropDown.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,info[1]);var spans=dropDown.getElementsByTagName("span");if(spans.length>0){spans[0].setAttribute(microstrategy.HTMLATTR_CMD_VALUE,info[1]);}else{dropDown.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,info[1]);}var inputObj=document.getElementById(this.id+dropDown.getAttribute(microstrategy.HTMLATTR_CMD_ID));if(inputObj){inputObj.value=info[1];if(!this.initializing){inputObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,info[1]);}}}this.updateColorPickerGradient(cmdVal);break;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.showOptions=function(elemOption){try{if(!elemOption){return false;}var opts=elemOption.parentNode.getElementsByTagName(elemOption.tagName);for(var i=0;i<opts.length;i++){var divSection=opts[i].id;if(divSection){divSection=document.getElementById("div"+divSection);}if(divSection){divSection.style.display=(opts[i]==elemOption)?"block":"none";}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.ondocumentclick=function(e){try{if(!e){e=window.event;}if(this.currentPicker){this.closePicker(e);}}catch(err){microstrategy.errors.log(err);}};mstrTabImpl.prototype.togglePicker=function(show,id,tool){try{if(tool&&(!tool.disabled)){dropDown.togglePicker(show,id,tool,this);}}catch(err){microstrategy.errors.log(err);}return false;};mstrTabImpl.prototype.closePicker=function(e){try{dropDown.closePicker(e,this);return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.checkForFormatChanges=function(){try{return false;}catch(err){microstrategy.errors.log(err);}};mstrTabImpl.prototype.applyFormatChanges=function(at,bulkChanges){try{return bulkChanges;}catch(err){microstrategy.errors.log(err);return bulkChanges;}};mstrTabImpl.prototype.checkRGBColors=function(formatName,formatValue){try{if((formatValue!=null)&&(formatName.toLowerCase().indexOf("color")>-1)){formatValue=mstr.utils.Color.rgbStr2hex(formatValue);}return formatValue;}catch(err){microstrategy.errors.log(err);return formatValue;}};mstrTabImpl.prototype.applyPropertyChanges=function(propertiesArray){try{for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(settingValue!=null){var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingLevel=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_LEVEL);if(!settingLevel){settingLevel=this.cmdLevel;}var propChange=new this.propChangeObject(aSetting,settingName,settingValue,null,null,settingLevel);propertiesArray.push(propChange);if(!this.enforceSubmit){aSetting.removeAttribute(microstrategy.HTMLATTR_CMD_VALUE);}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.propChangeObject=function(setting,cmdId,value,performFormatChange,submitUpdateManager,cmdLevel,formatType){this.obj=setting;this.cmdId=cmdId;this.value=value;this.performFormatChange=performFormatChange;this.submitUpdateManager=submitUpdateManager;this.level=(cmdLevel!=null)?cmdLevel:this.cmdLevel;this.formatType=(formatType!=null)?formatType:microstrategy.FORMAT_TYPE_MAIN;return this;};mstrTabImpl.prototype.simpleInitCheckValue=function(field,value,fireOnChange){try{if(field&&field.tagName.toLowerCase()!="input"){if(value==0){field.src=microstrategy.FOLDER_IMAGES+"check_off.gif";field.setAttribute("cv","0");}else{field.src=microstrategy.FOLDER_IMAGES+"check_on.gif";field.setAttribute("cv","-1");}}else{if((value||typeof (value)=="boolean")&&field){if(value&field.value||value==field.value){field.checked=true;}else{field.checked=false;}}}if(field){if(fireOnChange==null||fireOnChange=="true"){field.onclick();}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.initCheckValue=function(at,cmdId,fieldName,fireOnChange,propName){try{var field=document.getElementById(fieldName);if(!field||!at||!at.commands){return ;}if(propName==null||(at.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(at.commands.queryState("selectedItems"),propName))){if(at.commands.queryEnabled()&&at.commands.queryEnabled(cmdId)){var value=at.commands.queryState(cmdId);this.simpleInitCheckValue(field,value,fireOnChange);return ;}}this.disableObj(fieldName);}catch(err){microstrategy.errors.log(err);}};mstrTabImpl.prototype.simpleInitTextValue=function(field,value,fireOnChange){try{if((value||(value!=null&&value.length==0))&&field){field.value=value;if(fireOnChange==null||fireOnChange=="true"){field.onchange();}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.initTextValue=function(at,cmdId,fieldName,fireOnChange,propName){try{if(document.getElementById(fieldName)){if(propName==null||(at.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(at.commands.queryState("selectedItems"),propName))){if(at.commands&&at.commands.queryEnabled()){if(at.commands.queryEnabled(cmdId)){var value=at.commands.queryState(cmdId);var field=document.getElementById(fieldName);this.simpleInitTextValue(field,value,fireOnChange);}}}else{this.disableObj(fieldName);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.simpleInitRadioValue=function(field,value,fireOnChange){try{if(field){field.checked=true;if(fireOnChange==null||fireOnChange=="true"){field.onclick();}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.initRadioValue=function(at,cmdId,fieldName,fireOnChange,propName){try{var objArray=document.getElementsByName(fieldName);if(objArray){if(propName==null||(at.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(at.commands.queryState("selectedItems"),propName))){if(at.commands&&at.commands.queryEnabled()){if(at.commands.queryEnabled(cmdId)){var value=at.commands.queryState(cmdId);var field=document.getElementById(fieldName+value);this.simpleInitRadioValue(field,value,fireOnChange);}}}else{for(var i=0;i<objArray.length;i++){this.disableOptionAndLabel(objArray[i]);}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.simpleInitLabelValue=function(field,value){try{if(value&&field){field.innerHTML=value;}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.disableOptionAndLabel=function(option){try{if(option){option.disabled=true;option.className="disabled";if(document.getElementById(option.id+"_label")){document.getElementById(option.id+"_label").className="disabledLabel";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.enableOptionAndLabel=function(option){try{if(option){option.disabled=false;option.className="";if(document.getElementById(option.id+"_label")){document.getElementById(option.id+"_label").className="";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.initLabelValue=function(at,cmdId,fieldName){try{if(at.commands&&at.commands.queryEnabled()){if(at.commands.queryEnabled(cmdId)){var value=at.commands.queryState(cmdId);var field=document.getElementById(fieldName);this.simpleInitLabelValue(field,value);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.simpleInitComboValue=function(field,value,fireOnChange){try{if(value!=null&&(value.toString()).length>0&&field!=null){var cmdType=parseInt(field.getAttribute(microstrategy.HTMLATTR_CMD_TYPE));switch(cmdType){case mstrTabImpl.CMD_TYPE_BITFLAG:var optCol=field.options;var toSelect=-1;var iValue=parseInt(value);var savedValue=0;for(var i=0;i<optCol.length;i++){var anOption=optCol.item(i);var optValue=parseInt(anOption.value);if((((iValue&optValue)||(optValue==savedValue))&&(optValue>toSelect))||(optValue==0==iValue)){toSelect=optValue;iValue=iValue-optValue;savedValue+=optValue;}if((iValue==0)&&(optValue==savedValue)&&(toSelect>-1)){break;}}if(toSelect>-1){field.value=toSelect;}break;default:field.value=value;}if(fireOnChange==null||fireOnChange=="true"){field.onchange();}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.initComboValue=function(at,cmdId,fieldName,fireOnChange,propName){try{if(propName==null||(at.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(at.commands.queryState("selectedItems"),propName))){if(at.commands&&at.commands.queryEnabled()){if(at.commands.queryEnabled(cmdId)){var value=at.commands.queryState(cmdId);var field=document.getElementById(fieldName);this.simpleInitComboValue(field,value,fireOnChange);}}}else{this.disableObj(fieldName);}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.initColorPickerValue=function(at,cmdId,fieldName,propName){try{if(propName==null||(at.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(at.commands.queryState("selectedItems"),propName))){if(at.commands&&at.commands.queryEnabled()){var value;var dropdown=document.getElementById(fieldName);if(cmdId=="bgcolor"){value=dropdown.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!value&&at.commands.queryEnabled("gradientcolor")){value=at.commands.queryState("gradientcolor");}}if(at.commands.queryEnabled(cmdId)){if((cmdId=="bgcolor"&&!value)||cmdId!="bgcolor"){value=at.commands.queryState(cmdId,this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}this.updateColorPicker(dropdown,value);}}}else{if(document.getElementById(fieldName)){document.getElementById(fieldName).disabled=true;document.getElementById(fieldName).className="mstrPulldowndisabled";}if(document.getElementById(fieldName+"_label")){document.getElementById(fieldName+"_label").className="disabledLabel";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.setAppliesTo=function(bone){if(bone==null){return true;}try{if(!this.appliesTo){this.appliesTo=(typeof (bone)=="string")?bone:bone.id;}bone=microstrategy.bone(this.appliesTo);if(bone.observer){bone.observer.register(this.id);}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.getAppliesTo=function(bone){try{if(this.appliesTo){var bone=microstrategy.bone(this.appliesTo);return bone;}return null;}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.isEnabled=function(items,prop){try{var enabled=microstrategy.isEnabled(items,prop);return enabled;}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.updateList=function(obj){};mstrTabImpl.prototype.updateText=function(obj,skipCmdValue){try{if(obj&&(typeof (skipCmdValue)=="undefined"||!skipCmdValue)){obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,obj.value);}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.updateCheck=function(obj){try{if(obj){var newValue=(obj.checked)?"-1":"0";obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newValue);}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.updateDropdown=function(obj,newText,newValue,skipCmdValue){try{if(obj){obj.innerHTML=newText;if(typeof (skipCmdValue)=="undefined"||!skipCmdValue){obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newValue);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.updateColorPicker=function(obj,value,skipCmdValue){try{if(value==null){value="transparent";}if(obj&&(value!="-2")){var spans=obj.getElementsByTagName("span");if(value&&value.indexOf(",")>=0&&value.indexOf("rgb")<0){this.updateColorPickerGradient(obj.id+"|"+value);}else{if(spans.length>0){spans[0].style.backgroundColor=value;if(!value||value=="transparent"){spans[0].innerHTML=microstrategy.descriptors.getDescriptor(3779);}else{spans[0].innerHTML="";}}else{obj.style.backgroundColor=value;}}if(typeof (skipCmdValue)=="undefined"||!skipCmdValue){obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,value);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.getColorPickerValue=function(obj){try{var value="";if(obj){var spans=obj.getElementsByTagName("span");var span=null;if(spans.length>0){span=spans[0];}else{span=obj;}value=span.style.backgroundColor;}return value;}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.disableObj=function(objId){try{if(document.getElementById(objId)){this.disableOptionAndLabel(document.getElementById(objId));}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.enableObj=function(objId){try{if(document.getElementById(objId)){this.enableOptionAndLabel(document.getElementById(objId));}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.allSelectedItemsAreOfType=function(type){try{var allSelectedItemsAreOfType=true;var at=this.getAppliesTo();var items=at.commands.queryState("selectedItems");for(var item in items){var subType=items[item].getAttribute("sty");if(subType!=type){allSelectedItemsAreOfType=false;break;}}return allSelectedItemsAreOfType;}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.cleanup=function(type){};mstrTabImpl.prototype.getJSONProperty=function(name,value,isObjectValue){try{var jsonString="";if(name!=null&&value!=null){value=(isObjectValue)?value:'"'+value+'"';value=value.replace(/%5C/g,"%5C%5C");value=value.replace(/%22/g,"%5C%22");jsonString+='"'+name+'":'+value+",";}return jsonString;}catch(err){microstrategy.errors.log(err);return"";}};mstrTabImpl.prototype.getChanges=function(){try{var __result="";var counter;for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingValue=this.getChangedValue(aSetting);__result+=this.getJSONProperty(settingName,settingValue);}if(__result.length>0){__result=__result.substring(0,__result.length-1);}return __result;}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.getChangedValue=function(aSetting){try{var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(settingValue==null){if(aSetting.nodeName.toLowerCase()=="input"&&aSetting.type.toLowerCase()=="checkbox"){settingValue=aSetting.checked;}}return settingValue;}catch(err){microstrategy.errors.log(err);return null;}};mstrTabImpl.prototype.saveTabSelections=function(){var state="{"+this.getChanges(true)+"}";var sto=this.tabManager.selectedTabOptions||"";var l=sto.length;if(l){sto=sto.substring(1,l-1)+",";}this.tabManager.selectedTabOptions="{"+sto+'"'+this.id+'":'+state+"}";microstrategy.updateManager.replaceURL("selectedTabOptions",this.tabManager.selectedTabOptions);};mstrTabImpl.prototype.restorePreviousSelections=function(prevSettings){try{for(var settingName in prevSettings){var field=document.getElementById(this.id+settingName);if(field!=null&&prevSettings[settingName]!=null&&field.id==this.id+settingName){this.restoreEachSelection(field,settingName,prevSettings[settingName]);}else{if(field==null||field.getAttribute("name")==this.id+settingName){this.updateSpecialCases(settingName,prevSettings[settingName]);}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.restoreEachSelection=function(field,cmdId,value){try{if(cmdId.indexOf("Color")>-1){this.updateColorPicker(field,value);}else{var fType=field.nodeName;switch(fType.toLowerCase()){case"select":this.updateComboBox(field,value);this.updateList(field);break;case"input":var inputType=field.type.toLowerCase();switch(inputType){case"checkbox":this.reselectCheckBox(field,value);this.updateCheck(field);break;case"radio":this.updateRadioButton(field,value);break;case"text":this.updateText(field);break;}break;default:field.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,value);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.updateRadioButton=function(field,value){};mstrTabImpl.prototype.updateSpecialCases=function(cmdId,value){};mstrTabImpl.prototype.reselectCheckBox=function(field,value){try{field.checked=eval(value);}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.updateComboBox=function(field,value){try{var options=field.childNodes;var index=-1;var oIndex=0;for(var i=0;i<options.length;i++){if(options[i]!=null&&options[i].nodeName.toLowerCase()=="option"){if(this.matchesListValue(options[i].value,value,field.getAttribute(microstrategy.HTMLATTR_CMD_ID))){index=oIndex;break;}oIndex++;}}field.selectedIndex=index;field.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,value);}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.matchesListValue=function(option,value,cmdId){try{return(option==value);}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.openAdvancedColorPicker=function(at,cmdId,color){try{if(at&&at.commands){var value=mstr.utils.Color.rgbStr2hex(color);at.commands.exec("edtColorPicker",this.id+"|"+this.id+cmdId+"|"+value+"|"+this.tabManager.getChangedTabOptions());}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.openColorGradientEditor=function(at,args){try{if(at&&at.commands){at.commands.exec("edtColorGradient",args+"|"+this.tabManager.getChangedTabOptions());}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.openColorGradientEditor=function(at,args,forGraph){try{if(at&&at.commands){if(forGraph==true){at.commands.exec("graphEdtColorGradient",args+"|"+this.tabManager.getChangedTabOptions());}else{this.tabManager.adjustFormatType();at.commands.exec("edtColorGradient",args+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.openGradientColorPicker=function(at,cmdId,retrieveGradient,startColor,endColor,angle,xOffset,yOffset){try{if(at&&at.commands){this.tabManager.adjustFormatType();if(!endColor){at.commands.exec("edtColorGradient",this.id+"|"+this.id+cmdId+"|"+0+"|"+retrieveGradient+"|"+startColor+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}else{var activeViewKey=((angle==0&&xOffset==0)||(angle==90&&yOffset==0))?0:1;at.commands.exec("edtColorGradient",this.id+"|"+this.id+cmdId+"|"+activeViewKey+"|"+retrieveGradient+"|"+startColor+"|"+endColor+"|"+angle+"|"+xOffset+"|"+yOffset+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.updateColorPickerGradient=function(value){try{var info=value.split("|");var container=document.getElementById(info[0]);container.style.backgroundColor="transparent";var childSpans=container.getElementsByTagName("span");if(childSpans.length>0){container=childSpans[0];}else{return false;}container.innerHTML="";var gradientInfo=info[1].split(",");var width=getObjInnerWidth(container);var height=getObjInnerHeight(container);if(width%2==1){width=width-1;}if(height%2==1){height=height-1;}var color1RGB=gradientUtil.getRGBColor(gradientInfo[0]);var color2RGB=gradientUtil.getRGBColor(gradientInfo[1]);var direction=(gradientInfo[3]==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;var xOffset=gradientInfo[4];var yOffset=gradientInfo[5];var boxNum=(direction==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL&&xOffset!=100)||(direction==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL&&yOffset!=100)?1:2;var totalPixels=(width/gradientUtil.PIXEL_WIDTH)*(height/gradientUtil.PIXEL_WIDTH);for(var i=0;i<totalPixels;i++){var pixel=document.createElement("div");pixel.className="pixel";var comp=gradientUtil.getColorPercent(gradientUtil.getXCoordinate(i,width),gradientUtil.getYCoordinate(i,height),boxNum,width,direction);var colorr=parseInt(comp*(color2RGB[0]-color1RGB[0]))+color1RGB[0];var colorg=parseInt(comp*(color2RGB[1]-color1RGB[1]))+color1RGB[1];var colorb=parseInt(comp*(color2RGB[2]-color1RGB[2]))+color1RGB[2];pixel.style.backgroundColor="rgb("+colorr+", "+colorg+", "+colorb+")";container.appendChild(pixel);}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.initSettings=function(){try{if(this.settingsNameArray.length==0){return ;}this.settings=new Array();for(var i=0;i<this.settingsNameArray.length;i++){var elem=document.getElementById(this.id+this.settingsNameArray[i]);if(elem){this.settings.push(elem);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.initCtrlValue=function(field,fireOnChange){try{var at=this.getAppliesTo();if(!at){return ;}var cmdId=field.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(at.commands&&at.commands.queryEnabled(cmdId)){var value=at.commands.queryState(cmdId);var type=field.type||field.getAttribute("type");switch(type){case"text":this.simpleInitTextValue(field,value,fireOnChange);break;case"checkbox":this.simpleInitCheckValue(field,(value==true),fireOnChange);break;case"colorpicker":this.updateColorPicker(field,value);break;case"picker":break;}}else{this.disableObj(fieldName);}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.updateCtrl=function(obj){try{if(!obj){return ;}if(this.initializing){return ;}switch(obj.type){case"text":obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,obj.value);break;case"checkbox":obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,(obj.checked)?microstrategy.TRUE:microstrategy.FALSE);break;}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.getSwitchMode=function(){try{if(!this.tabSwitch){if(this.tabManager){this.tabSwitch=microstrategy.findChildWithAtt(this.tabManager,"td","tab",this.id);}}if(this.tabSwitch){return this.tabSwitch.getAttribute(microstrategy.TAB_SWITCH_MODE);}return 0;}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.setSwitchMode=function(switchMode){try{if(!this.tabSwitch){if(this.tabManager){this.tabSwitch=microstrategy.findChildWithAtt(this.tabManager,"td","tab",this.id);}}if(this.tabSwitch){this.tabSwitch.setAttribute(microstrategy.TAB_SWITCH_MODE,switchMode);}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.afterresize=function(){try{if(mstrEditorImpl.prototype.afterresize){mstrEditorImpl.prototype.afterresize.call(this);}var boneDivs=microstrategy.findChildrenWithAtt(this.elem,"div","ty");for(var counter=0;counter<boneDivs.length;counter++){var subBone=microstrategy.findBone(boneDivs[counter]);if(subBone&&subBone.afterresize){subBone.afterresize();}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.onwinresize=function(){try{if(mstrEditorImpl.prototype.onwinresize){mstrEditorImpl.prototype.onwinresize.call(this);}this.resize();}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.resize=function(){try{if(mstrEditorImpl.prototype.resize){mstrEditorImpl.prototype.resize.call(this);}var boneDivs=microstrategy.findChildrenWithAtt(this.elem,"div","ty");if(boneDivs){for(var counter=0;counter<boneDivs.length;counter++){var subBone=microstrategy.findBone(boneDivs[counter]);if(subBone&&subBone.resize){subBone.resize();}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.toggleCheck=function(oCheck,useDefault){if(this.initializing!=false){return false;}var chkState=parseInt(oCheck.getAttribute("cv"),10)-1;if(chkState<-2){chkState=0;}var chkSrc="check_off.gif";if(chkState==-1){chkSrc="check_on.gif";}else{if(chkState==-2){if(useDefault){chkSrc="Check_conflict.gif";}else{chkState=0;}}}oCheck.src=microstrategy.FOLDER_IMAGES+chkSrc;oCheck.setAttribute("cv",chkState);oCheck.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,chkState);return true;};mstrTabImpl.prototype.unregister=function(){try{var boneDivs=microstrategy.findChildrenWithAtt(this.elem,"div","ty");if(boneDivs){for(var counter=0;counter<boneDivs.length;counter++){microstrategy.unRegisterBone(boneDivs[counter].getAttribute("id"));}}}catch(err){microstrategy.errors.log(err);return false;}};function mstrTabImpl(id){this.inherits=mstrEditorImpl;this.inherits(id);delete this.inherits;return this;}
mstrFolderActionsScript=true;mstrFolderActions=new Object();mstrFolderActions.checkACL=function(elAnchor,e,objectID,objectType,messageID){try{var allowed=false;if(elAnchor&&elAnchor.getAttribute("ty")=="sub"){iframe.showWaitPage();mstr.$XHR.request(mstrApp.taskURL||mstrConfig.taskURL,{taskId:"getSubscriptionAssociatedInformation",loadInfo:"checkACL",objectID:objectID,objectType:objectType},{success:function(res){allowed=res.user.allow;}},false);iframe.hideWaitPage();}if(!allowed){var message=microstrategy.descriptors.getDescriptor("9181");showMessage({contents:message,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});e=e||window.event;stopEventBubbling(e);cancelEvent(e);}return allowed;}catch(err){microstrategy.errors.log(err);}};mstrFolderActions.submitShowBeanEvent=function(action,objectId,objectType){try{var strEvent="&actionType="+action+"&objectId="+objectId+"&objectType="+objectType;microstrategy.updateManager.useIframe=true;toggleShowBean("OMD",true,strEvent);}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderActions.actionConfirmDelete=function(objectId,objectType,objectName,folderBeanPath,isSC){try{var message=isSC?microstrategy.descriptors.getDescriptor("3833"):microstrategy.descriptors.getDescriptor("3829");message=message.replace("##",objectName);showMessage({contents:message,elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:'mstrFolderActions.actionNewMenuItemClick("delete", "'+objectId+'", ["'+objectType+'", "'+folderBeanPath+'"])',type:mstrMsgBoxImpl.MSG_WARNING});}catch(err){microstrategy.errors.log(err);return false;}};mstrFolderActions.actionNewMenuItemClick=function(menuItem,objectId,args){try{var updateManager=microstrategy.updateManager;var actionCollection=new Array();switch(menuItem){case"newFilter":actionCollection.push(updateManager.createActionObject(null,mstrUpdateManager.CREATE_NEW_FILTER,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CREATE_NEW_FILTER].paramID,["",true,objectId]));break;case"newPrompt":if(args.length==2){actionCollection.push(updateManager.createActionObject(null,mstrUpdateManager.CREATE_NEW_PROMPT,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CREATE_NEW_PROMPT].paramID,[args[0],objectId,args[1]]));}else{if(args.length==1){actionCollection.push(updateManager.createActionObject(null,mstrUpdateManager.CREATE_NEW_PROMPT,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CREATE_NEW_PROMPT].paramID,[args[0],objectId]));}}break;case"createDocument":actionCollection.push(updateManager.createActionObject(null,mstrUpdateManager.CONVERT_TO_DOCUMENT,microstrategy.servletName,mstrUpdateManager.actions[mstrUpdateManager.CONVERT_TO_DOCUMENT].paramID,[objectId,"",1,2,microstrategy.DSSTYPE_RPT_DEFINITION]));break;case"delete":actionCollection.push(updateManager.createActionObject(null,mstrUpdateManager.DELETE_OBJECT,args[1],mstrUpdateManager.actions[mstrUpdateManager.DELETE_OBJECT].paramID,[objectId,parseInt(args[0])]));break;case"newDocument":actionCollection.push(updateManager.createActionObject(null,mstrUpdateManager.CREATE_NEW_DOCUMENT,microstrategy.servletName,["3185"],[objectId]));break;case"newReport":actionCollection.push(updateManager.createActionObject(null,mstrUpdateManager.REPORT_NEW,microstrategy.servletName,["3185"],[objectId]));break;}updateManager.add(actionCollection);updateManager.useIframe=false;updateManager.flushAndSubmitChanges();}catch(err){microstrategy.errors.log(err);return false;}};
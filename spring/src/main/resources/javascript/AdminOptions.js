function AddOptionsToList(sFromList,sToList){var i;var lLength;var oOption;var aPreSelected=new Array();var bSomethingSelected;bSomethingSelected=false;var oFromList=getObj(sFromList);var oToList=getObj(sToList);for(i=0;i<oFromList.options.length;i++){if(oFromList.options[i].selected){if(IsOptionInList(oToList,oFromList.options[i])==false){bSomethingSelected=true;oOption=new Option(oFromList.options[i].text,oFromList.options[i].value,false,false);aPreSelected[aPreSelected.length]=oOption.text;if((oToList.options.length==1)&&(oToList.options[0].value=="(default)")){oToList.options[0]=oOption;}else{oToList.options[oToList.length]=oOption;}}}}if(bSomethingSelected){CleanSelectionsOnList(oFromList);UpdateHiddenValue(oToList);CheckPreSelected(oToList,aPreSelected);}}function RemoveOptionsFromList(sList){var i;var j;var lLength;var oOption;var bSomethingSelected;bSomethingSelected=false;var oList=getObj(sList);for(i=0;i<oList.options.length;i++){if(oList.options[i].selected){oList.options[i]=null;i--;bSomethingSelected=true;}}if(bSomethingSelected){if(oList.length==0){oOption=new Option(sDefaultDescriptor,"(default)",false,false);oList.options[0]=oOption;}CleanSelectionsOnList(oList);UpdateHiddenValue(oList);}}function MoveOptionsInListUp(sList){var oTempOptionText;var oTempOptionValue;var i;var aPreSelected=new Array();var bSomethingSelected;var oList=getObj(sList);bSomethingSelected=false;for(i=1;i<oList.options.length;i++){if(oList.options[i].selected){bSomethingSelected=true;aPreSelected[aPreSelected.length]=oList.options[i].text;oTempOptionText=oList.options[i].text;oTempOptionValue=oList.options[i].value;oList.options[i].text=oList.options[i-1].text;oList.options[i].value=oList.options[i-1].value;oList.options[i-1].text=oTempOptionText;oList.options[i-1].value=oTempOptionValue;}}if(bSomethingSelected){UpdateHiddenValue(oList);CheckPreSelected(oList,aPreSelected);}}function MoveOptionsInListDown(sList){var oTempOptionText;var oTempOptionValue;var i;var aPreSelected=new Array();var bSomethingSelected;bSomethingSelected=false;var oList=getObj(sList);for(i=oList.options.length-1;i>-1;i--){if(oList.options[i].selected&&i+1<oList.options.length){bSomethingSelected=true;aPreSelected[aPreSelected.length]=oList.options[i].text;oTempOptionText=oList.options[i].text;oTempOptionValue=oList.options[i].value;oList.options[i].text=oList.options[i+1].text;oList.options[i].value=oList.options[i+1].value;oList.options[i+1].text=oTempOptionText;oList.options[i+1].value=oTempOptionValue;}}if(bSomethingSelected){UpdateHiddenValue(oList);CheckPreSelected(oList,aPreSelected);}}function CleanSelectionsOnList(oList){var i;for(i=0;i<oList.options.length;i++){oList.options[i].selected=false;}}function CheckPreSelected(oList,aPreSelected){var i;var j;CleanSelectionsOnList(oList);for(i=0;i<oList.options.length;i++){for(j=0;j<aPreSelected.length;j++){if(aPreSelected[j]==oList.options[i].text){oList.options[i].selected=true;}}}}function IsOptionInList(oList,sElement){var i;for(i=0;i<oList.options.length;i++){if(oList.options[i].text==sElement.text){return true;}}return false;}function UpdateHiddenValue(oList){var sHidden;var i;sHidden="";for(i=0;i<oList.options.length;i++){if(sHidden==""){sHidden=oList.options[i].value;}else{sHidden=sHidden+","+oList.options[i].value;}}window.document.PreferenceForm[sHiddenName].value=sHidden;}function switchVisible(e){if(!e){e=window.event;}var controlButton=(e.srcElement)?e.srcElement:e.target;var targetDiv=controlButton.getAttribute("at");if(!targetDiv){return false;}var target=document.getElementById(targetDiv);if(!target){return false;}if(target.getAttribute("visibility")=="1"){target.setAttribute("visibility","0");removeObj(target);if(controlButton.getAttribute("lh")){controlButton.value=controlButton.getAttribute("lh");}}else{displayObj(target);if(controlButton.getAttribute("lv")){controlButton.value=controlButton.getAttribute("lv");}target.setAttribute("visibility","1");}return false;}
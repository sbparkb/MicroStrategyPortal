mstrReportGraphImplScript=true;mstrReportGraphImpl.prototype=new mstrGrid();mstrReportGraphImpl.prototype.x=0;mstrReportGraphImpl.prototype.y=0;mstrReportGraphImpl.prototype.graphWidth=0;mstrReportGraphImpl.prototype.graphHeight=0;mstrReportGraphImpl.prototype.datasetMappingEnabled=false;mstrReportGraphImpl.prototype.currentArea=null;mstrReportGraphImpl.prototype.graphTargetZones=null;mstrReportGraphImpl.prototype.showDropZoneHandle=false;mstrReportGraphImpl.prototype.zonesEditor=null;mstrReportGraphImpl.prototype.zonesTargetId="";mstrReportGraphImpl.prototype.designModeImageSrc=null;mstrReportGraphImpl.prototype.designModeImageFolder="";mstrReportGraphImpl.prototype.designModeImageDefault="";mstrReportGraphImpl.prototype.cmBoneID=null;mstrReportGraphImpl.prototype.gProps=null;mstrReportGraphImpl.prototype.gUtils=null;mstrReportGraphImpl.prototype.onload=function(){try{mstrGrid.prototype.onload.call(this);this.zonesTargetId=this.id;this.isGridBone=false;if(this.shouldInitMask()){this.elem.onmousedown=this.addBoneHandler(this.id,"onmousedown");this.onwinresize();}if(mstrGridReport.allowEdit()){var obj=findTarget(this.elem,microstrategy.HTMLATTR_OBJTYPE);if(obj){this.isLocked=mstrGridReport.styAttrValue(obj,"LOCKED")==microstrategy.TRUE;}}if(this.isGraph&&!this.isGrid&&this.elem){this.elem.onselectstart=new Function("return false;");}this.commands=new mstrGraphCommands(this);if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){microstrategy.graphPropertyCache[this.objId]=null;}var that=this;if(this.isGraph&&this.GFEStatesPassed){window.setTimeout(function(){that.prepareGraphProperties();},0);}}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.onwinresize=function(){try{mstrGrid.prototype.onwinresize.call(this);}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.onmousedown=function(e){try{e=e||window.event;if(e.button>1){return false;}if(!this.showGraphDropZones){return true;}var src=getEventTarget(e);if(src.tagName.toLowerCase()=="span"&&src.getAttribute("dg")=="1"){getMouse(e);this.x=lMouseX;this.y=lMouseY;this.activeElement=src;this.selections.clear();this.selections.add(src);this.bindingEvents(this,{mousemove:{s:"ondragstart"},mouseup:{s:"onmouseup"}});stopEventBubbling(e);}}catch(err){microstrategy.errors.log(err);}return false;};mstrReportGraphImpl.prototype.onPanelDeleted=function(id){try{if(!this.zonesEditor){return ;}var parent=this.getParentSubsection()&&this.getParentSubsection().id;if(id==parent){this.toggleZonesEditor(null,false);this.hideToolbar(true);}}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.getDropZonesPosition=function(edt){try{this.zonesEditor=edt;this.zonesTargetId="UniqueReportID";this.gridStructureInfo.syncUnitSources(true,this.zonesTargetId,false);this.showToolbar(true);return{left:getObjSumLeft(this.activeRWUnit),top:getObjSumTop(this.toolbar)+getObjHeight(this.toolbar)};}catch(err){microstrategy.errors.log(err);return null;}};mstrReportGraphImpl.prototype.ondragstart=function(e){try{if(!this.isFeatureAvailable(microstrategy.FEATURE_WEB_PIVOT)){return ;}e=this.initEvent(e,true);var x=Math.abs(lMouseX-this.x);var y=Math.abs(lMouseY-this.y);if(x>3||y>3){this.initializeDragDisplay();this.dragDisplay.replaceChild(document.createTextNode(this.activeElement.firstChild.data),this.dragDisplay.firstChild);var type="0";switch(this.activeElement.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)){case microstrategy.DSSTYPE_METRIC:case microstrategy.DSSTYPE_USER_METRIC:case microstrategy.DSSTYPE_USER_SUMMARY_METRIC:type=microstrategy.DSSTYPE_METRIC;break;default:type=microstrategy.DSSTYPE_ATTRIBUTE;break;}microstrategy.eventManager.onnotifydrag([this.activeElement],this,[type]);this.bindingEvents(this,{mousemove:{s:"ondrag"},mouseup:{s:"ondragend"}});this.ondrag(e);}stopEventBubbling(e);}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.initMapper=function(){try{mstrGrid.prototype.initMapper.call(this);if(this.showGraphDropZones||(mstrGridReport.isReport()&&mstrGridReport.isDesignMode())){this.maskFor=microstrategy.DSSTYPE_METRIC+microstrategy.HTMLATTR_MASKFOR_DELIM+microstrategy.DSSTYPE_ATTRIBUTE;}else{this.maskFor=microstrategy.DSSTYPE_RPT_DEFINITION;}}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.getMapper=function(){try{this.mapper=new mstrGraphMapperImpl(this.id,this);}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.prepareGraphProperties=function(){try{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){this.gUtils=new mstrGraphFormatUtil(null,this);return true;}if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){this.gProps=microstrategy.graphPropertyCache[this.objId];}if(this.gProps==null){if(this.gReqId){return false;}var req=null;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){req=new mstr.http.GetRWGraphProperties(this.objId,this.msgId);}else{req=new mstr.http.GetReportGraphProperties(this.msgId,this.stateId);}this.gReqId=mstr.http.Governor.submitRequest(req,this.id,"createGraphUtils");return false;}else{this.gUtils=new mstrGraphFormatUtil(this.gProps,this);return true;}}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.createGraphUtils=function(evt){try{switch(evt.readyState){case mstr.Enum.Widget.READYSTATE.SUCCESS:this.gProps=evt.response.data;this.gUtils=new mstrGraphFormatUtil(this.gProps,this);this.gReqId=null;break;}if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION&&this.docViewer){microstrategy.graphPropertyCache[this.objId]=this.gProps;this.docViewer.observer.notifyAll("onGraphPropertiesReady");}else{this.observer.notifyAll("onGraphPropertiesReady");}}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.initSelections=function(){try{if(this.showGraphDropZones){this.selections=new mstrSelectionsImpl(this);this.selections.clearAll=this.selections.clear;this.selections.path="microstrategy.bone('"+this.id+"').selections";this.selections.onload();}}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.onContextMenu=function(e){try{e=e||window.event;this.currentArea=getEventTarget(e);}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.initTemplate=function(){try{this.template=new mstrGraphTemplateImpl();this.template.onload(this.elem,this,this.fp);}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.createToolbar=function(){try{this.toolbar=getObj("toolbar_"+this.id);if(this.toolbar){return ;}mstrGrid.prototype.createToolbar.call(this);var vm=parseInt(this.currentView)-1;if(mstrGridReport.isDesignMode()&&vm==microstrategy.GRID_EFFECTIVE_VIEW_GRID_GRAPH){return ;}if(vm==microstrategy.GRID_EFFECTIVE_VIEW_GRID||!mstrGridReport.isRWD()){return ;}if(!this.useDNDMapping||!mstrGridReport.allowEdit()){return ;}if(!this.docViewer.isEditableViewModeEplus()||!this.isFeatureAvailable(microstrategy.FEATURE_WEB_PIVOT)){return ;}var x=document.createElement("div");x.setAttribute("id",this.id+"_graphPreview");x.className="graphPreview";this.formatPreviewBtn(x,(this.zonesEditor!=null));var that=this;x.onmousedown=function(e){var editorBone=microstrategy.bone(that.id);if(editorBone){editorBone.toggleZonesEditor(e,!this.zones);}};var span=document.createElement("span");span.setAttribute("title",mstrGridReport.desp("5686"));x.appendChild(span);var img=document.createElement("img");img.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";if(this.zonesEditor){img.className="gdz_dArrow";}else{img.className="gdz_rArrow";}x.appendChild(img);this.toolbar.appendChild(x);x=null;}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.onZonesEditorRequested=function(id){try{if(id!=this.id&&this.zonesEditor){this.zonesEditor.closeEditor();this.hideToolbar(true);}}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.toggleZonesEditor=function(e,show){try{if(show){microstrategy.eventManager.notifyOrphanBones("onZonesEditorRequested",this.id);this.formatPreviewBtn(this.toolbar.lastChild,show);var arrowEl=getObj(this.id+"_graphPreview").lastChild;var params={viewId:this.objId,boneId:this.id,h:parseInt(this.graphHeight*100/microstrategy.ZOOM_FACTOR),w:parseInt(this.graphWidth*100/microstrategy.ZOOM_FACTOR)};if(mstrGridReport.isViewMode()){var sliceIndexHelper=this.id.replace("_graph","");params.sliceIndex=sliceIndexHelper.substr(sliceIndexHelper.lastIndexOf("_")+1);}this.docViewer.commands.exec("openGraphDropZones",params);arrowEl.className="gdz_dArrow";}else{if(this.zonesEditor){this.zonesEditor.closeEditor();}}}catch(err){microstrategy.errors.log(err);}finally{stopEventBubbling(e||window.event);}};mstrReportGraphImpl.prototype.onstatechange=function(){if(this.zonesEditor&&!this.zonesEditor.isLoaded){this.onZonesEditorClose();}mstrGridStatic.prototype.onstatechange.call(this);};mstrReportGraphImpl.prototype.onZonesEditorClose=function(){this.formatPreviewBtn(this.toolbar.lastChild,false);var arrowEl=getObj(this.id+"_graphPreview").lastChild;this.zonesEditor=null;if(this.stickToolbar){this.stickToolbar=false;}arrowEl.className="gdz_rArrow";};mstrReportGraphImpl.prototype.formatPreviewBtn=function(btn,areZonesVisible){try{btn.zones=areZonesVisible;this.stickToolbar=areZonesVisible;if(areZonesVisible){if(btn.className.indexOf(" selected")==-1){btn.className+=" selected";}}else{if(btn.className.indexOf(" selected")!=-1){btn.className=btn.className.replace(" selected","");}}}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.getView=function(){return this.isMode("GRAPH");};mstrReportGraphImpl.prototype.attachToolbarEvents=function(){try{if(this.effectiveView==microstrategy.DISPLAY_MODE_GRAPH){this.activeRWUnit.onmouseout=this.addBoneHandler(this.id,"onmouseout");this.activeRWUnit.onmouseover=this.addBoneHandler(this.id,"onmouseover");}}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.changeGraphImageSrc=function(){try{if(!this.useClientSideManipulations){return ;}var img=document.getElementById(this.id+"_img");if(!img){return ;}var src="../images/graphImgs/grtp"+this.major+"_"+this.minor+".gif";img.src=src;if(this.zonesEditor){this.zonesEditor.changeImageSrc(src);}}catch(err){microstrategy.errors.log(err);}};mstrReportGraphImpl.prototype.processSingleFormattingPropertyGraph=function(cmdId,cmdVal){try{switch(cmdId){case"Bold":case"Italic":case"Underline":var m={Bold:1,Italic:2}[cmdId]||4;this.processSingleFormattingPropertyGraph("fstyle",m);break;case"fstyle":var styleForAllApplicable=this.graphFontStyleForAll&&this.graphFontStyleForAll.isCurrentTargetForAll;var currentStyle=styleForAllApplicable?this.graphFontStyleForAll.fontStyle:this.graphFontStyle;if(currentStyle!=null){cmdVal=parseInt(cmdVal);currentStyle=parseInt(currentStyle);if(styleForAllApplicable){var hexDigitValue=((currentStyle^cmdVal)&cmdVal)==0?2:1;cmdVal=hexDigitValue*Math.pow(16,Math.log(cmdVal)/Math.log(2));}else{cmdVal=currentStyle^cmdVal;}}case"FontFamily":case"FontSize":case"GridHorizontal":case"IncreaseDecimal":case"DecreaseDecimal":case"Currency":case"IntlCurrency":case"Percent":case"Comma":case"FillColor":case"lncolor":case"borders":case"FontColor":case"lnstyle":if(cmdId=="FillColor"&&cmdVal.indexOf&&cmdVal.indexOf(",")>0){cmdVal="bgcolorgradient|"+cmdVal;cmdId="edtColorGradient";}var graphCmdId=mstrGraphCommands.GRAPH_COMMANDS[cmdId];if(graphCmdId==null){var cmdValSplit=cmdVal.split("|");if(cmdValSplit.length>1){graphCmdId=cmdValSplit[0];cmdVal=cmdValSplit[1];graphCmdId=mstrGraphCommands.GRAPH_COMMANDS[graphCmdId];}}var b=graphCmdId=="titleColor"||graphCmdId=="titleLineColor"||graphCmdId=="titleFillColor";if(b){cmdVal=(cmdVal!="-1"&&(cmdVal.indexOf("#")==0))?cmdVal.substr(1):cmdVal;}if(graphCmdId&&this.selectedGraphTargetValue!=null){var formatGraphObjectBulk=new Array();formatGraphObjectBulk.push(new Array(graphCmdId,cmdVal));var auxArray=new Array(this.selectedGraphTargetValue,formatGraphObjectBulk);var p=null;if(graphCmdId=="titleGradient"){p="formatGraphColorGradient";}else{if(b){p="saveGraphProperties";}else{p="formatGraphObjectBulk";}}auxArray=new Array(p,auxArray);var formatBulkArray=new Array();formatBulkArray.push(auxArray);this.processGraphFormattingProperties(formatBulkArray);}break;default:mstrGridReport.prototype.processSingleFormattingProperty.call(this,cmdId,cmdVal);}}catch(err){microstrategy.errors.log(err);}};mstrGraphCommands.GRAPH_COMMANDS={fstyle:"titleStyle",FontSize:"titleSize",FontColor:"titleColor",lncolor:"titleLineColor",FillColor:"titleFillColor",FontFamily:"titleName",bgcolorgradient:"titleGradient"};mstrGraphCommands.prototype=new mstrGridCommands();mstrGraphCommands.prototype.exec=function(cmdId,cmdVal1,cmdVal2,cmdVal3,cmdVal4){try{var pb=this.parentBone;if(!pb){return false;}var gu=pb.gUtils;var cmdId=mstrGraphCommands.getMapCmd(cmdId);switch(cmdId){case"majorPicker":case"major":if(!gu){return false;}pb.major=cmdVal1;pb.minor=1;if(microstrategy.DISPLAY_MODE==microstrategy.EDIT_MODE){pb.notifySelectionChange("ongridselectionschange");}if(pb.useClientSideManipulations){pb.changeGraphImageSrc();}var changes=mstrGraphFormatUtil.addChangeObject(mstrGraphFormatUtil.createChangeObject("majorType",cmdVal1,"default"));gu.submitChanges(changes,pb.useClientSideManipulations);return true;case"minorPicker":case"minor":if(!gu){return false;}pb.minor=cmdVal1;if(pb.useClientSideManipulations){pb.changeGraphImageSrc();}var changes=mstrGraphFormatUtil.addChangeObject(mstrGraphFormatUtil.createChangeObject("minorType",cmdVal1,"default"));gu.submitChanges(changes,pb.useClientSideManipulations);return true;case"legend":if(!gu){return false;}cmdVal1=String(!this.queryState(cmdId));var changes=mstrGraphFormatUtil.addChangeObject(mstrGraphFormatUtil.createChangeObject("show",cmdVal1,pb.GRAPH_OBJECT_ID_LEGEND_TEXT+"_-1"));gu.submitChanges(changes);return true;case"dValues":if(!gu){return false;}cmdVal1=!this.queryState(cmdId);var objId=(pb.major==64||pb.major==1048576)?pb.GRAPH_OBJECT_ID_OPILBL_VALUE:pb.GRAPH_OBJECT_ID_DATA_TEXT;changes=mstrGraphFormatUtil.addChangeObject(mstrGraphFormatUtil.createChangeObject("show",cmdVal1,objId+""),changes);gu.submitChanges(changes);return true;case"seriesByRow":this.exec("seriesLayout","0");return true;case"seriesByColumn":this.exec("seriesLayout","1");return true;case"seriesLayout":case"maxCategories":case"maxSeries":if(!gu){return false;}var changes=mstrGraphFormatUtil.addChangeObject(mstrGraphFormatUtil.createChangeObject(cmdId,cmdVal1,"default"));gu.submitChanges(changes);return true;case"CategoriesSeries":if(document.activeElement&&document.activeElement.blur&&mstr.utils.ISCHROME){document.activeElement.blur();}var cat=cmdVal1.maxCategories;var ser=cmdVal1.maxSeries;if(cat){this.exec("maxCategories",cat,!!(cat&&ser));}if(ser){this.exec("maxSeries",ser,false);}return true;case"majorType":pb.GFEMajor=cmdVal1;return true;case"minorType":pb.GFEMinor=cmdVal1;return true;case"mainCat":if(pb.mainCategory!=cmdVal1){pb.mainCategory=cmdVal1;delete pb.fmtTargetId;delete pb.isIncreDecreItem;}return true;case"subCat":pb.fmtTargetId=cmdVal1;return true;case"isIncreDecreItem":pb.isIncreDecreItem=cmdVal1;return true;case"tbGraphUnitSelector":pb.setGraphSelected(true);pb.mainCategory=cmdVal1;delete pb.fmtTargetId;delete pb.isIncreDecreItem;pb.notifySelectionChange("ongridselectionschange");return true;case"tbGraphValueSelector":pb.setGraphSelected(true);pb.fmtTargetId=cmdVal1;pb.notifySelectionChange("ongridselectionschange");return true;case"seriesLabels":pb.numTargetId=cmdVal1;return true;case"gfeField":pb.gfeField=cmdVal1;return true;case"roundedEffect":pb.roundedEffect=cmdVal1?1:0;return true;case"fontName":case"fontSize":case"textBoldItalic":case"textBold":case"textItalic":case"textUnderline":case"textStrikeout":case"fontColor":case"fillColor":case"lineColor":if(!gu){return false;}if(!gu.isAllTarget(pb.fmtTargetId)){var changes=mstrGraphFormatUtil.addChangeObject(mstrGraphFormatUtil.createChangeObject(cmdId,cmdVal1,pb.fmtTargetId));gu.submitChanges(changes,false,this.queryState("GFEStates"));}else{var changes={};var subTargets=gu.getSubTargets(pb.fmtTargetId,cmdId,pb.major,pb.minor);if(subTargets&&subTargets.length>0){var aid="";for(id in subTargets){var sid=subTargets[id];if(sid.indexOf("_")>-1){sid=sid.substring(0,sid.indexOf("_"));}if(aid!=sid){aid=sid;changes=mstrGraphFormatUtil.addChangeObject(mstrGraphFormatUtil.createChangeObject(cmdId,cmdVal1,aid),changes);}}}else{changes=mstrGraphFormatUtil.addChangeObject(mstrGraphFormatUtil.createChangeObject(cmdId,cmdVal1,pb.fmtTargetId),changes);}gu.submitChanges(changes,false,this.queryState("GFEStates"));}return true;case"ResetGFEStatus":if(!gu){return false;}delete pb.GFEMajor;delete pb.GFEMinor;delete pb.mainCategory;delete pb.fmtTargetId;delete pb.isIncreDecreItem;delete pb.numTargetId;delete pb.gfeField;pb.roundedEffect=gu.getGraphPropertyValue("roundedEffect","default");pb.notifySelectionChange("ongridselectionschange");return true;case"FormatGraphUniversal":if(!pb.gUtils){pb.gUtils=new mstrGraphFormatUtil(null,pb);}pb.gUtils.submitChanges(cmdVal1,false,this.queryState("GFEStates"));return true;case"CMfillColor":case"CMfontColor":case"CMlineColor":var category=cmdVal1.objId+"_"+cmdVal1.seriesId;if(!pb.gUtils){pb.gUtils=new mstrGraphFormatUtil(null,pb);}var changes=mstrGraphFormatUtil.addChangeObject(mstrGraphFormatUtil.createChangeObject(cmdId,cmdVal1.v,category));pb.gUtils.submitChanges(changes);return true;case"addTemplateUnit":case"edtColorGradient":return mstrGridCommands.prototype.exec.call(this,cmdId,cmdVal1,cmdVal2,cmdVal3,cmdVal4);case"openGraphFormatter":if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){microstrategy.openBlockLoaderEditor("GraphFormatter","GraphFormatEditorBlockLoader");}else{microstrategy.openDataBasedBlockEditor("GraphFormatter","GraphFormatEditorBlockLoader",pb.beanPath,{targetPath:"#"+pb.id});}return true;case"gridGraphMode":case"gridMode":this.parentBone.toggleZonesEditor(null,false);default:if(pb.exec(cmdId,cmdVal1)){return true;}mstrGridCommands.prototype.exec.call(this,cmdId,cmdVal1,cmdVal2,cmdVal3,cmdVal4);}}catch(err){microstrategy.errors.log(err);}return false;};mstrGraphCommands.prototype.queryEnabled=function(cmdId){try{var pb=this.parentBone;var that=this;var fr=function(s){return mstr.behaviors.featureResolver.featAvailable(s+"-formatting");};var fa=function(s,v){var c=true;if(v){c=!pb.isVisualization;}return(pb.isFeatureAvailable(microstrategy["FEATURE_"+s])&&c);};var cmdId=mstrGraphCommands.getMapCmd(cmdId);var minor=(pb.GFEMinor)?pb.GFEMinor:pb.minor;var major=(pb.GFEMajor)?pb.GFEMajor:pb.major;switch(cmdId){case"isGraphPropertiesReady":if(!pb.gProps){pb.prepareGraphProperties();}return !!pb.gProps;case"majorPicker":case"minorPicker":case"major":case"minor":return((this.queryEnabled("isGraphPropertiesReady")&&pb.isGraph&&fa("EMBEDDED_TEMPLATE_NODE",true)||microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE));case"dValues":return this.queryEnabled("isGraphPropertiesReady")&&this.queryEnabled("maxCategories")&&(pb.major!=pb.Major_3D_surface);case"legend":if(this.queryEnabled("maxCategories")){var bLegend=true;if(mstr.utils.Arrays.find([4096,8192,16384,32768,65536,131072,4194304],pb.major)>-1){bLegend=false;}return bLegend;}else{return false;}case"seriesLayout":case"maxCategories":case"maxSeries":case"majorType":case"minorType":case"curvedLines":case"antiAliasing":case"roundedEffect":case"seriesLayout":case"lockFontSize":case"showSubtotals":return this.queryEnabled("isGraphPropertiesReady")&&pb.isGraph&&fa("EMBEDDED_TEMPLATE_NODE")&&!(pb.isVisualization||pb.isTemplateEmpty());case"seriesByColumn":case"seriesByRow":return this.queryEnabled("isGraphPropertiesReady")&&this.queryEnabled("seriesLayout");case"mainCat":case"subCat":return this.queryEnabled("isGraphPropertiesReady")&&pb.gUtils.isPropSupported(pb.fmtTargetId?pb.fmtTargetId:"10000",cmdId);case"fontName":case"fontSize":case"textBoldItalic":case"textBold":case"textItalic":case"textUnderline":case"textStrikeout":case"fontColor":case"fillColor":case"lineColor":case"show":return !(major==pb.Major_3D_surface&&pb.mainCategory==5)&&this.queryEnabled("isGraphPropertiesReady")&&pb.gUtils.isPropSupported(pb.fmtTargetId?pb.fmtTargetId:"10000",cmdId);case"maxScaleX":case"minScaleX":case"maxScaleY1":case"minScaleY1":case"maxScaleY2":case"minScaleY2":case"maxScaleZ":case"minScaleZ":case"maxScaleCKX":case"minScaleCKX":case"maxScaleCKY1":case"minScaleCKY1":case"maxScaleCKY2":case"minScaleCKY2":case"maxScaleCKZ":case"minScaleCKZ":return this.queryEnabled("isGraphPropertiesReady")&&!pb.gUtils.isPercentGraph(major,minor);case"CMlineColor":case"CMfillColor":case"CMfontColor":if(!pb.gUtils){pb.gUtils=new mstrGraphFormatUtil(null,pb);}return pb.gUtils.isPropSupported(pb.CMTargetId,cmdId.substring(2));case"bevelType":case"areaAlpha":var tId=pb.fmtTargetId?pb.fmtTargetId:"10000";return !(major==pb.Major_3D_surface&&pb.mainCategory==5)&&this.queryEnabled("isGraphPropertiesReady")&&(this.queryState("roundedEffect")==0||tId.indexOf("_")==-1)&&pb.gUtils.isPropSupported(tId,cmdId);case"TextAlign":case"number":case"align":case"Currency":case"deltaDecimal":case"IncreaseDecimal":case"DecreaseDecimal":case"IntlCurrency":case"Percent":case"Comma":case"borders":case"lnstyle":return false;case"openGraphFormatter":case"openGraphFormatter":case"openFormatGraph":case"onegraphfmt":var forRw=true;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){forRw=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&!this.queryEnabled("isLinkedGrid");}return(fr("grid-graph")||fr("simple-graph"))&&pb.isGraph&&forRw&&pb.gridStructureInfo.hasMetrics;case"seriesLineColor":case"seriesLineStyle":case"seriesLineThickness":case"lineAlpha":case"seriesLineAlpha":case"seriesLineAlphaText":case"markerShow":case"markerShape":case"markerBevelType":case"markerSize":case"markerColor":case"markerAlphaText":case"markerBorderColor":case"markerBorderStyle":case"markerBorderThickness":case"markerBorderAlpha":case"markerBorderAlphaText":case"maxBarSizeType":case"maxBarSizeValue":case"increfillColor":case"decreFillColor":case"increDecreColorField":return true;default:return mstrGridCommands.prototype.queryEnabled.call(this,cmdId,true);}}catch(err){microstrategy.errors.log(err);return false;}};mstrGraphCommands.prototype.queryVisible=function(cmdId){try{var pb=this.parentBone;var minor=(pb.GFEMinor)?pb.GFEMinor:pb.minor;var major=(pb.GFEMajor)?pb.GFEMajor:pb.major;var cmdId=mstrGraphCommands.getMapCmd(cmdId);switch(cmdId){case"markerShow":return !(major==pb.Major_3D_scatter||major==pb.Major_Scatter||major==pb.Major_Bubble||major==pb.Major_Gauge);case"show":return !(major==pb.Major_3D_surface&&pb.mainCategory==5)&&this.queryEnabled("isGraphPropertiesReady")&&pb.gUtils.isPropSupported(pb.fmtTargetId?pb.fmtTargetId:"10000",cmdId);case"subCat":return(!(major==pb.Major_Hichert&&pb.mainCategory==9)&&!(major==pb.Major_Hichert&&pb.mainCategory==3));case"tooltipsShow":case"tooltipsEditor":case"titlePosition":case"titleContent":return this.queryEnabled("isGraphPropertiesReady")&&pb.gUtils.isPropSupported(pb.fmtTargetId?pb.fmtTargetId:"10000",cmdId);case"tooltipsEditor_ie":return((major&33817728)==0)&&this.queryVisible("tooltipsEditor");case"tooltipsEditor_ie_ScatterBubble":return((major!=pb.Major_Hichert)&&(major&263296)>0)&&this.queryVisible("tooltipsEditor");case"fillColor":return !this.queryVisible("increDecreColorField");case"increDecreColorField":if(!pb||!pb.fmtTargetId){return false;}return(major==pb.Major_Hichert&&(minor==1||minor==2)&&pb.mainCategory==4&&pb.isIncreDecreItem);case"seriesLineThickness":return major!=pb.Major_Hichert;case"roundedEffect":case"lockFontSize":case"showSubtotals":case"tbUnitSelector":case"tbValueSelector":return pb.isFeatureAvailable("grid-graph-formatting");case"seriesByColumn":case"seriesByRow":case"maxCategories":case"maxSeries":return major!=pb.Major_Hichert;case"gridIntervalX":case"gridIntervalY1":case"gridIntervalY2":case"gridIntervalZ":case"maxScaleX":case"minScaleX":case"maxScaleY1":case"minScaleY1":case"maxScaleY2":case"minScaleY2":case"maxScaleZ":case"minScaleZ":case"maxScaleCKX":case"minScaleCKX":case"maxScaleCKY1":case"minScaleCKY1":case"maxScaleCKY2":case"minScaleCKY2":case"maxScaleCKZ":case"minScaleCKZ":case"gridIntervalCKX":case"gridIntervalCKY1":case"gridIntervalCKY2":case"gridIntervalCKZ":return this.queryEnabled("isGraphPropertiesReady")&&pb.gUtils.isAxesSupported(cmdId,major,minor);default:return mstrGridCommands.prototype.queryVisible.call(this,cmdId,true);}}catch(err){microstrategy.errors.log(err);}return false;};mstrGraphCommands.prototype.queryState=function(cmdId,cmdValue,skipGraph){try{var pb=this.parentBone;if(!pb){return ;}var gu=pb.gUtils;var minor=(pb.GFEMinor)?pb.GFEMinor:pb.minor;var major=(pb.GFEMajor)?pb.GFEMajor:pb.major;var that=this;var fmtToolbarEnabled=mstr.behaviors.featureResolver.featAvailable("show-format-toolbar");var cmdId=mstrGraphCommands.getMapCmd(cmdId);switch(cmdId){case"major":case"minor":return pb[cmdId];case"minorPicker":case"minorType":if(!gu){return ;}var mn=(cmdId=="minorType")?minor:pb.minor;var mj=(cmdId=="minorType")?major:pb.major;mn=mstrGraphFormatUtil.getMappedMinorType(mj,mn);return{items:gu.getMinorTypes(mj),value:mn};case"majorPicker":case"majorType":if(!gu){return ;}var mj=(cmdId=="majorType")?major:pb.major;return{items:gu.getMajorTypes(pb.allowedGraphTypes),value:mj};case"legend":if(!gu){return ;}return gu.getGraphPropertyValue("show",pb.GRAPH_OBJECT_ID_LEGEND_TEXT+"_-1");case"dValues":if(!gu){return ;}var objId=(pb.major==64||pb.major==1048576)?pb.GRAPH_OBJECT_ID_OPILBL_VALUE:pb.GRAPH_OBJECT_ID_DATA_TEXT;return gu.getGraphPropertyValue("show",objId+"");case"seriesByRow":return this.queryState("seriesLayout")==0;case"seriesByColumn":return this.queryState("seriesLayout")==1;case"maxCategories":case"maxSeries":case"seriesLayout":case"curvedLines":case"antiAliasing":case"seriesLayout":case"lockFontSize":case"showSubtotals":case"gridIntervalX":case"gridIntervalY1":case"gridIntervalY2":case"gridIntervalZ":case"maxScaleX":case"minScaleX":case"maxScaleY1":case"minScaleY1":case"maxScaleY2":case"minScaleY2":case"maxScaleZ":case"minScaleZ":case"maxScaleCKX":case"minScaleCKX":case"maxScaleCKY1":case"minScaleCKY1":case"maxScaleCKY2":case"minScaleCKY2":case"maxScaleCKZ":case"minScaleCKZ":case"gridIntervalCKX":case"gridIntervalCKY1":case"gridIntervalCKY2":case"gridIntervalCKZ":case"dualAxisAuto":case"gaugeStyle":case"gaugeNeedleStyle":case"gaugeBorderStyle":case"gaugeBorderThick":case"gaugeRangeThick":case"gaugeStartAngle":case"gaugeStopAngle":case"gaugeQBShow":case"maxBarSizeType":case"maxBarSizeValue":if(!gu){return ;}return gu.getGraphPropertyValue(cmdId,"default");case"roundedEffect":if(!gu){return ;}return("roundedEffect" in pb)?pb.roundedEffect:gu.getGraphPropertyValue(cmdId,"default");case"mainCat":case"tbGraphUnitSelector":var bGFE=(cmdId=="mainCat");var bHasMetric=pb.gridStructureInfo.hasMetrics;if(fmtToolbarEnabled&&this.queryEnabled("isGraphPropertiesReady")){var unitsObjs={items:pb.gUtils.getMainItems(major,minor,bGFE,bHasMetric),value:(!!pb.mainCategory?pb.mainCategory:"1")};if(unitsObjs.value=="5"&&unitsObjs.items.length<6&&unitsObjs.items[unitsObjs.items.length-1]["dssid"]!=5||unitsObjs.value=="6"&&unitsObjs.items[unitsObjs.items.length-1]["dssid"]!=6){unitsObjs.value="1";}pb.mainCategory=unitsObjs.value;return unitsObjs;}else{return{items:[],value:""};}case"subCat":case"tbGraphValueSelector":if(fmtToolbarEnabled&&this.queryEnabled("isGraphPropertiesReady")){var items=pb.gUtils&&pb.gUtils.getSubCatItems(pb.mainCategory?pb.mainCategory:"1",major,minor);var value=!!pb.fmtTargetId?pb.fmtTargetId:(items&&items[0]?items[0]["dssid"]:"");pb.fmtTargetId=value;return{items:items,value:value};}else{return{items:[],value:""};}case"seriesLabels":if(this.queryEnabled("isGraphPropertiesReady")){var items=pb.gUtils.getNumCatItems(major,minor);return{items:items,value:pb.numTargetId?pb.numTargetId:(items&&items[0]?items[0]["dssid"]:"")};}else{return{items:[],value:""};}case"dualOptionItems":if(!gu){return ;}var dualAxisOpts=gu.getDualAxisOptions();return{availableFiltered:{items:dualAxisOpts.y1Axis,value:null},selected:{items:dualAxisOpts.y2Axis,value:null},available:{items:dualAxisOpts.y1Axis.concat(dualAxisOpts.y2Axis),value:null}};case"fillColor":case"lineColor":case"bevelType":case"areaAlpha":case"dataTextShow":case"titlePosition":case"titleContent":case"titleOriContent":case"tooltipsShow":case"tooltipsEditor":case"show":case"fontName":case"fontSize":case"textBoldItalic":case"textBold":case"textItalic":case"textUnderline":case"textStrikeout":case"fontColor":case"seriesLineColor":case"seriesLineStyle":case"seriesLineThickness":case"lineAlpha":case"seriesLineAlpha":case"seriesLineAlphaText":case"markerShow":case"markerShape":case"markerBevelType":case"markerSize":case"markerColor":case"markerAlphaText":case"markerBorderColor":case"markerBorderStyle":case"markerBorderThickness":case"markerBorderAlpha":case"markerBorderAlphaText":case"increfillColor":case"decreFillColor":if(!gu){return ;}return gu.getGraphPropertyValue(cmdId,pb.fmtTargetId);case"seriesAreaFormatField_visible":if(!cmdValue){return false;}if(major==pb.Major_Hichert){return(cmdValue==0||cmdValue==1);}if(!gu){return ;}return(!gu.isTypeSupported("dataMarker",major,minor)&&!gu.isTypeSupported("radarDataMarker",major,minor))||(gu.hasMultipleShowTypes(major)&&gu.isSeriesTypeAreaInMulType(major,minor,cmdValue));case"gfnCat":case"gfnTime":case"gfnFraction":case"gfnDate":case"gfnDecimalPlaces":case"gfnCurrencySymbol":case"gfnCurrencyPosition":case"gfnNegativeNumbers":case"gfnThousandSeparator":case"gfnFormat":if(!gu){return ;}return gu.getGraphPropertyValue(cmdId,pb.numTargetId);case"fmtSubTargets":if(!gu){return ;}return gu.getSubTargets(pb.fmtTargetId,pb.gfeField,major,minor);case"numSubTargets":if(!gu){return ;}return gu.getSubTargets(pb.numTargetId,pb.gfeField,major,minor);case"GFEStates":var statesURL="GFEStatesPassed=1";var states=["GFEMajor","GFEMinor","mainCategory","fmtTargetId","numTargetId","gfeField","roundedEffect"];for(var i=0,len=states.length;i<len;i++){if(pb[states[i]]){statesURL+="&"+states[i]+"="+pb[states[i]];}}return statesURL;case"getDefaultVal":if(!gu){return ;}return gu.getDefaultFieldValue(pb.gfeField);case"imgSrc":var img=document.getElementById(pb.id+"_img");return(img)?img.src:"";case"autoArrange":return this.autoArrange;case"FillColor_vf":case"fillColor_vf":var vf=mstr.Enum.ColorPickerFlags.MORE_COLORS+mstr.Enum.ColorPickerFlags.USER_COLORS;var CPF=mstr.Enum.ColorPickerFlags;if(mstrGridReport.isDesignMode()){vf+=CPF.GRADIENT_COLORS;}else{vf+=CPF.GRAPH_GRADIENTS;}return vf;case"lncolor_vf":return(mstr.Enum.ColorPickerFlags.NO_COLOR+mstr.Enum.ColorPickerFlags.MORE_COLORS+mstr.Enum.ColorPickerFlags.USER_COLORS);case"roundEffectTooltip":if(pb.roundedEffect==1){return"To modify this setting, uncheck 'Apply rounded effect to all series' on the general tab.";}else{return"";}default:return mstrGridCommands.prototype.queryState.call(this,cmdId,cmdValue,!skipGraph);}}catch(err){microstrategy.errors.log(err);}return"";};mstrGraphCommands.getMapCmd=function(cmdId){try{switch(cmdId){case"font":case"FontFamily":return"fontName";case"fsize":case"FontSize":return"fontSize";case"color":case"FontColor":return"fontColor";case"fstyle":return"fontStyle";case"Bold":return"textBold";case"Italic":return"textItalic";case"Underline":return"textUnderline";case"FillColor":case"bgcolor":return"fillColor";case"lncolor":return"lineColor";default:return cmdId;}}catch(err){microstrategy.errors.log(err);}return cmdId;};function mstrGraphCommands(parentBone){this.parentBone=parentBone;return this;}function mstrReportGraphImpl(id){this.inherits=mstrGrid;this.inherits(id);delete this.inherits;return this;}mstrGraphMapperImpl.prototype=new Object();mstrGraphMapperImpl.prototype.x=0;mstrGraphMapperImpl.prototype.y=0;mstrGraphMapperImpl.prototype.targetId="";mstrGraphMapperImpl.prototype.getAreas=function(bone,map){try{if(!bone.elem){return null;}this.x=getObjSumLeft(bone.elem);this.y=getObjSumTop(bone.elem);var areas={length:0};var maskType=map.getAttribute(microstrategy.HTMLATTR_MASKFOR);if(mstrGridReport.isRWD()&&maskType==microstrategy.DSSTYPE_RPT_DEFINITION){var graphDimensions=new Object();graphDimensions.width=getObjWidth(bone.elem);graphDimensions.height=getObjHeight(bone.elem);return this.buildGraphArea(areas,graphDimensions);}else{if(this.parentBone.showGraphDropZones||(mstrGridReport.isReport()&&mstrGridReport.isDesignMode())){var that=this;var fn=function(v){return document.getElementById(that.targetId+"_gdz"+v);};this.getVerticalAreas(fn("1"),areas);this.getHorizontalAreas(fn("2"),areas);if(mstrGridReport.isMetric(maskType)){this.getVerticalAreas(fn("3"),areas);}}}return areas;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphMapperImpl.prototype.getVHAreas=function(axis,areas,v){try{if(!axis){return ;}var x=getObjSumLeft(axis)-this.x;var y=getObjSumTop(axis.previousSibling)+getObjHeight(axis.previousSibling)-this.y;var wh=v?getObjWidth(axis):getObjHeight(axis);var rb=(v?x:y)+wh;var units=axis.getElementsByTagName("span");var fn=function(a1,v1,a2){var a=new mstrAreaObjectImpl();a.coords=a1.join(",");a.pointsTo=axis.getAttribute(microstrategy.HTMLATTR_GRIDCELL_AXIS)+","+v1+",1";a.onmouseovercoords=a2.join(",");areas[areas.length++]=a;};var HW=microstrategy.DND_HILITE_WIDTH;for(var i=0;i<units.length;i++){var u=units[i];var d=this.getUnitDimensions(u);var gd=u.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH);var gdv=parseInt(u.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH))+1;v?fn([x,y,rb,d.vMidPoint],gd,[x,y,HW,wh]):fn([x,y,d.hMidPoint,rb],gd,[x,y,wh,HW]);v?fn([x,(d.vMidPoint+1),rb,d.bottom],gdv,[x,(d.bottom+1),HW,wh]):fn([(d.hMidPoint+1),y,d.right,rb],gdv,[(d.right+1),y,wh,HW]);v?y=d.bottom+1:x=d.right+1;}v?fn([x,y,rb,(getObjSumTop(axis)-this.y+getObjHeight(axis))],(units.length+1),[x,y,HW,wh]):fn([x,y,(getObjSumLeft(axis)-this.x+getObjWidth(axis)),rb],(units.length+1),[x,y,wh,HW]);}catch(err){microstrategy.errors.log(err);}};mstrGraphMapperImpl.prototype.getVerticalAreas=function(axis,areas){this.getVHAreas(axis,areas,true);};mstrGraphMapperImpl.prototype.getHorizontalAreas=function(axis,areas){this.getVHAreas(axis,areas,false);};mstrGraphMapperImpl.prototype.buildGraphArea=function(areas,graphDimensions){try{var a=new mstrAreaObjectImpl();a.coords="0,0,"+graphDimensions.width+","+graphDimensions.height;areas[areas.length++]=a;return areas;}catch(err){microstrategy.errors.log(err);return null;}};mstrGraphMapperImpl.prototype.getUnitDimensions=function(unit){try{var __result=new Object();__result.height=getObjHeight(unit);__result.width=getObjWidth(unit);__result.top=getObjSumTop(unit)-this.y;__result.vMidPoint=__result.top+Math.floor(__result.height/2);__result.bottom=__result.top+__result.height;__result.left=getObjSumLeft(unit)-this.x;__result.hMidPoint=__result.left+Math.floor(__result.width/2);__result.right=__result.left+__result.width;return __result;}catch(err){microstrategy.errors.log(err);return null;}};function mstrGraphMapperImpl(targetId,parentBone){this.targetId=targetId;this.parentBone=parentBone;return this;}
mstrResizeEditorImplScript=true;mstrResizeEditorImpl.prototype=new mstrEditorImpl();mstrResizeEditorImpl.prototype.grid=null;mstrResizeEditorImpl.prototype.colSelect=null;mstrResizeEditorImpl.prototype.colWindow=null;mstrResizeEditorImpl.prototype.colAuto=null;mstrResizeEditorImpl.prototype.colFixed=null;mstrResizeEditorImpl.prototype.widthBox=null;mstrResizeEditorImpl.prototype.rowAuto=null;mstrResizeEditorImpl.prototype.rowFixed=null;mstrResizeEditorImpl.prototype.heightBox=null;mstrResizeEditorImpl.prototype.gridWidthsObj=null;mstrResizeEditorImpl.prototype.isDirty=false;mstrResizeEditorImpl.prototype.setAllColumns=false;mstrResizeEditorImpl.prototype.onload=function(){try{this.initEditor();this.colSelect=this.elem.getElementsByTagName("select")[0];var inputs=this.elem.getElementsByTagName("input");for(var i=0;i<inputs.length;i++){var at=inputs[i].getAttribute("at");if(at!=null&&at.length>0){this[at]=inputs[i];}}var getBone=(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION)?'microstrategy.bone("UniqueReportID")':'microstrategy.findBone(microstrategy.bone("rwb_viewer").commands.queryState("selectedGrid"))';this.setTimeout(getBone+" != null && "+getBone+'.commands.queryState("getGridWidthsObj") != null','microstrategy.bone("'+this.id+'").populateEditorProps();',100);}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.populateEditorProps=function(){try{if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){this.grid=microstrategy.bone("UniqueReportID");}else{var htmlgrid=microstrategy.bone("rwb_viewer").commands.queryState("selectedGrid");this.grid=microstrategy.findBone(htmlgrid);}this.gridWidthsObj=this.grid.commands.queryState("getGridWidthsObj");this.getColWidth();if(this.gridWidthsObj.rowScenario==mstrGridReport.COL_WIDTH_FIXED){var height=this.grid.commands.queryState("getRowHeight");this.heightBox.value=this.toUserTableUnit(height);}this.isDirty=false;}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.getColWidth=function(){try{var key=this.colSelect.options[this.colSelect.selectedIndex].value;if(key=="*"){this.widthBox.value="";return ;}this.widthBox.value=this.toUserTableUnit(this.gridWidthsObj.widths[key]);}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.toUserTableUnit=function(value){var units=microstrategy.number.toUserUnits(microstrategy.getFormatObject().encodeValue("width",value),true);return microstrategy.number.toLocaleString(parseFloat(units).toFixed(2));};mstrResizeEditorImpl.prototype.resizeLockSet=function(){window.setTimeout("microstrategy.bone('"+this.grid.id+"').resizeLockSet(true)",1);};mstrResizeEditorImpl.prototype.setColWidth=function(){try{this.widthBox.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,"xx");if(this.gridWidthsObj.colScenario!=mstrGridReport.COL_WIDTH_FIXED&&this.widthBox.value!=null&&this.widthBox.value.length!=0){this.setColMode(mstrGridReport.COL_WIDTH_FIXED);}if(mstrEditorImpl.validateField(this.widthBox,"").length>0||this.widthBox.value==null||this.widthBox.value.length==0){return ;}var width=this.widthBox.value;width=Math.round(parseFloat(microstrategy.getFormatObject().decodeValue("width",microstrategy.number.toUSUnits(width))));var key=this.colSelect.options[this.colSelect.selectedIndex].value;if(key=="*"){this.setAllColumns=true;for(key in this.gridWidthsObj.widths){if(key!="xx"){this.grid.commands.exec("setColWidth",key,width,this.gridWidthsObj.widths[key]);this.gridWidthsObj.widths[key]=width;}}}else{this.setAllColumns=false;this.grid.commands.exec("setColWidth",key,width,this.gridWidthsObj.widths[key]);this.gridWidthsObj.widths[key]=width;}this.isDirty=true;this.resizeLockSet();}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.setColMode=function(mode){try{this.gridWidthsObj.colScenario=mode;this.grid.commands.exec("setColWidthsMode",mode);if(mode!=mstrGridReport.COL_WIDTH_FIXED){if(this.gridWidthsObj.rowScenario==mstrGridReport.COL_WIDTH_FIXED){this.setRowMode(mstrGridReport.COL_WIDTH_FIT_TO_CONTENT);}}if(mode==mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY){this.colWindow.checked=true;}else{if(mode==mstrGridReport.COL_WIDTH_FIT_TO_CONTENT){this.colAuto.checked=true;}else{this.colFixed.checked=true;}}this.isDirty=true;this.resizeLockSet();}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.setFixedColMode=function(){try{var gwo=this.gridWidthsObj,gwos=gwo&&gwo.colScenario;if(gwos!=mstrGridReport.COL_WIDTH_FIXED){this.setColMode(mstrGridReport.COL_WIDTH_FIXED);this.updateFixedWidth();}}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.updateFixedWidth=function(){this.grid.colWidths.calculateColSizeInfo();this.gridWidthsObj.widths=this.grid.commands.queryState("getGridWidthsObj").widths;this.getColWidth();};mstrResizeEditorImpl.prototype.setRowMode=function(mode){try{if(mode==mstrGridReport.COL_WIDTH_FIT_TO_CONTENT){this.rowAuto.checked=true;this.heightBox.value="";this.gridWidthsObj.rowScenario=mstrGridReport.COL_WIDTH_FIT_TO_CONTENT;this.grid.commands.exec("setRowHeightMode",mstrGridReport.COL_WIDTH_FIT_TO_CONTENT,"");}else{if(this.gridWidthsObj.rowScenario!=mstrGridReport.COL_WIDTH_FIXED){if(this.gridWidthsObj.colScenario!=mstrGridReport.COL_WIDTH_FIXED){this.setFixedColMode();}this.rowFixed.checked=true;var height=this.grid.commands.queryState("getRowHeight");this.heightBox.value=this.toUserTableUnit(height);this.gridWidthsObj.rowScenario=mstrGridReport.COL_WIDTH_FIXED;this.gridWidthsObj.rowHeight=(mstr.utils.ISIE6||mstr.utils.ISIE7)?height-1:height;this.grid.commands.exec("setRowHeightMode",mstrGridReport.COL_WIDTH_FIXED,height);}}this.isDirty=true;this.resizeLockSet();}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.changeRowButtons=function(mode){try{if(mode==mstrGridReport.COL_WIDTH_FIXED){this.rowFixed.checked=true;}else{this.rowAuto.checked=true;}}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.setRowHeight=function(){try{if(this.gridWidthsObj.colScenario!=mstrGridReport.COL_WIDTH_FIXED){this.setFixedColMode();}this.heightBox.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,"xx");if(mstrEditorImpl.validateField(this.heightBox,"").length>0){return ;}var height=this.heightBox.value;if(height.length==0){this.setRowMode(mstrGridReport.COL_WIDTH_FIT_TO_CONTENT);this.gridWidthsObj.rowHeight="";this.gridWidthsObj.rowScenario=mstrGridReport.COL_WIDTH_FIT_TO_CONTENT;}else{var usHeight=parseInt(microstrategy.getFormatObject().decodeValue("height",microstrategy.number.toUSUnits(height)));height=Math.max(((mstr.utils.ISIE6||mstr.utils.ISIE7)?usHeight-1:usHeight),0);this.gridWidthsObj.rowHeight=height;this.gridWidthsObj.rowScenario=mstrGridReport.COL_WIDTH_FIXED;this.grid.commands.exec("setRowHeightMode",mstrGridReport.COL_WIDTH_FIXED,height);}this.isDirty=true;this.resizeLockSet();}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.saveChanges=function(){try{if(this.isDirty){var ac=new Array();ac=this.grid.commands.exec("saveColWidthsMode",this.gridWidthsObj.colScenario,ac);if(this.gridWidthsObj.colScenario==mstrGridReport.COL_WIDTH_FIXED){ac=this.grid.commands.exec("saveColWidths",ac,this.setAllColumns);}if(this.gridWidthsObj.rowScenario==mstrGridReport.COL_WIDTH_FIXED){ac=this.grid.commands.exec("saveRowHeightMode",this.gridWidthsObj.rowScenario,this.gridWidthsObj.rowHeight,ac);}else{ac=this.grid.commands.exec("saveRowHeightMode",this.gridWidthsObj.rowScenario,"",ac);}ac=this.grid.commands.exec("saveActionCollection",ac);this.grid.commands.exec("raiseGridResize");}}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.okChanges=function(){try{if(this.validateInputs()){this.saveChanges();this.isDirty=false;this.closeEditor(true);}}catch(err){microstrategy.errors.log(err);}};mstrResizeEditorImpl.prototype.cancelChanges=function(){try{if(this.isDirty){this.grid.commands.exec("cancelAllWidthsChanges");}this.isDirty=false;this.closeEditor();}catch(err){microstrategy.errors.log(err);}};function mstrResizeEditorImpl(id){this.inherits=mstrEditorImpl;this.inherits(id);delete this.inherits;return this;}
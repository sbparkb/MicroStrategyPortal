var iTotalRows=0;var iFixedCols=0;var iFixedRows=0;var oTable=null;var oCOLTags=null;var bAutoFit=true;var lTableTop=0;var lTableLeft=0;var bOutlineMode=false;var bColumnResizeMode=false;var oColHandles=null;var oColHandlesMask=null;var bColHandlesInit=false;function initCOLTags(oT,iColumns){var iCOLTags=0;var oCOLTags=oT.getElementsByTagName("COL");if(oCOLTags){iCOLTags=oCOLTags.length;}if(iCOLTags<iColumns){var oCOLGROUP=null;var oCOLGROUPS=oT.getElementsByTagName("COLGROUP");if(oCOLGROUPS.length==0){oCOLGROUP=document.createElement("COLGROUP");oCOLGROUP=oT.appendChild(oCOLGROUP);}else{oCOLGROUP=oCOLGROUPS[0];}var iMissingCOLs=iColumns-iCOLTags;for(var i=0;i<iMissingCOLs;i++){var oNewCOL=document.createElement("COL");oCOLGROUP.appendChild(oNewCOL);}}return ;}function getColumnWidthsArray(oT,oCOLTags,iCells,iFixedRows,iFixedCols){var oldWidths=new Array;if(!oT){return ;}if((oCOLTags)&&(oCOLTags.length)){for(var i=0;i<oCOLTags.length;i++){if(oCOLTags[i].style.display=="none"){oldWidths[i]=0;}}}for(var i=0;i<iCells;i++){if(oldWidths[i]!=0){oldWidths[i]=getObjWidth(getCellForColumn(oT,iFixedRows,iFixedCols,i));}}if((iFixedCols>1)&&(oldWidths[iFixedCols-2]>0)){var oCell=getCellForColumn(oT,iFixedRows,iFixedCols,iFixedCols-2);if((oCell)&&(util_parseSpan(oCell,1)>1)){oldWidths[iFixedCols-2]-=oldWidths[iFixedCols-1];if(oldWidths[iFixedCols-2]<0){oldWidths[iFixedCols-2]=0;}}}return(oldWidths);}function getColumnWidthsArraySubtractive(oT,oCOLTags,iCells,iFixedRows,iFixedCols){var oldWidths=new Array;var oldLefts=new Array;if(!oT){return ;}if((oCOLTags)&&(oCOLTags.length)){for(var i=0;i<oCOLTags.length;i++){if(oCOLTags[i].style.display=="none"){oldWidths[i]=0;}}}for(var i=0;i<iCells;i++){oldLefts[i]=parseInt(getObjSumLeft(getCellForColumn722(oT,iFixedRows,iFixedCols,i)));}oldLefts[iCells]=getObjSumLeft(oT)+getObjWidth(oT);for(var i=0;i<iCells;i++){if(oldWidths[i]!=0){for(var j=i+1;j<iCells;j++){if(oldWidths[j]!=0){break;}}oldWidths[i]=oldLefts[j]-oldLefts[i];if(oldWidths[i]<0){oldWidths[i]=0;}}}return(oldWidths);}function longestDataRowIndex(oT,iFixedRows,iTotalRows){if(iFixedRows==iTotalRows){return(iFixedRows-1);}var iMaxCount=0;var iRow=-1;for(var i=iFixedRows;i<iTotalRows;i++){if(oT.rows[i].cells.length>iMaxCount){iMaxCount=oT.rows[i].cells.length;iRow=i;}}return(iRow);}function hasExtraFixedCol(oT){if((oT)&&(oT.rows)&&(oT.rows[0])){var oCells=oT.rows[0].cells;if((oCells)&&(oCells.length)){var iCells=oCells.length;for(var i=0;i<iCells;i++){if((oCells[i].getAttribute("AX")=="2")&&(oCells[i].getAttribute("OR")=="H")){return(true);break;}}}}return(false);}function getCellForColumn722(oT,iFixedRows,iFixedCols,iColumnIndex){if(!oT){return(null);}if(!oT.rows){return(null);}var oCell=null;var iSpan=0;var szColumnLetter=getLetterForColumn(iColumnIndex+1);var iRows=oT.rows.length;var oCells=oT.cells(szColumnLetter+1+":"+szColumnLetter+iRows);if(oCells){if(oCells.length){for(var i=0;i<oCells.length;i++){if((util_parseSpan(oCells[i],1)<iSpan)||(iSpan==0)){iSpan=util_parseSpan(oCells[i],1);oCell=oCells[i];}}}else{oCell=oCells;}}return(oCell);}function getCellForColumn(oT,iFixedRows,iFixedCols,iColumnIndex){var oCell=null;var iRow=-1;var iCol=-1;if(iTotalRows==0){iTotalRows=oT.rows.length;}var bHasExtraFixedCol=hasExtraFixedCol(oT);if((iColumnIndex<iFixedCols-1)||((iColumnIndex==iFixedCols-1)&&!bHasExtraFixedCol)){if((!bOutlineMode)&&(iFixedRows<iTotalRows)){iRow=longestDataRowIndex(oT,iFixedRows,iTotalRows);}else{var bColSpanned=false;if(oT.rows[0].cells.length>iColumnIndex){for(var i=0;i<=iColumnIndex;i++){var oCell=oT.rows[0].cells[i];if(util_parseSpan(oCell,1)>1){bColSpanned=true;break;}}}if(!bColSpanned){iRow=0;}else{iRow=iTotalRows-1;}}iCol=iColumnIndex;}else{if(iColumnIndex==iFixedCols-1){iRow=-1;var oTR=oT.rows[0];var iPreviousColumnNumber=iColumnIndex;if((oTR)&&(iFixedRows>0)){var colCounter=0;var iCells=oTR.cells.length;for(var i=0;i<iCells;i++){colCounter+=util_parseSpan(oTR.childNodes[i],1);if(colCounter>=iPreviousColumnNumber){break;}}if((colCounter==iPreviousColumnNumber)&&(i<iCells-1)){if(util_parseSpan(oTR.childNodes[i+1],1)==1){iRow=0;iCol=i+1;}}}if(iRow==-1){if(bOutlineMode){iRow=iTotalRows-1;}else{iRow=iFixedRows;}iCol=iColumnIndex;}}else{iRow=-1;iCol=-1;if(iFixedRows>0){var iRepeatCellsInRow=lastRepeatColHeaderInRow(oT,iFixedRows-1)+1;var iRepeatColumnsInRow=0;for(var c=0;c<iRepeatCellsInRow;c++){iRepeatColumnsInRow+=util_parseSpan(oT.rows[iFixedRows-1].cells[c]);}iCol=iColumnIndex-(iFixedCols-iRepeatColumnsInRow);var oCell=findCellForColumnNumber(oT,iFixedRows-1,iCol+1);if((oCell)&&(util_parseSpan(oCell,1)<2)){iRow=iFixedRows-1;iCol=oCell.cellIndex;}}if(iRow==-1){if(bOutlineMode){iRow=iTotalRows-1;}else{iRow=iFixedRows;}iCol=iColumnIndex;if((iFixedCols>1)&&(iFixedRows<iTotalRows)){var oNextToLastFixedCol=oT.rows[iRow].cells[iFixedCols-2];if((oNextToLastFixedCol)&&(util_parseSpan(oNextToLastFixedCol,1)==2)){iCol--;}}}}}if(iRow>iTotalRows-1){iRow=iTotalRows-1;}oCell=oT.rows[iRow].cells[iCol];return(oCell);}function findCellForColumnNumber(oT,iRowIndex,iColNumber){var oCell=null;var iCounter=0;for(var i=0;i<iColNumber;i++){iCounter+=util_parseSpan(oT.rows[iRowIndex].cells[i],1);if(iCounter>=iColNumber){oCell=oT.rows[iRowIndex].cells[i];break;}}return(oCell);}function getFixedRows(oT){if(!oT){return(0);}var oTRs=oT.rows;if(!oTRs){return(0);}var iTotalRows=oTRs.length;var iRepeatRows=0;var sFoundAttr="";if(oTRs[iTotalRows-1].getAttribute("o")){sFoundAttr="o";}if(sFoundAttr==""){if(oTRs[iTotalRows-1].getAttribute("level")){sFoundAttr="level";}}if(sFoundAttr!=""){for(var i=0;i<iTotalRows;i++){if(oTRs[i].getAttribute(sFoundAttr)){iRepeatRows=i;break;}}}else{iRepeatRows=iTotalRows;}return(iRepeatRows);}function getFixedCols(oTable){var iRepeatCols=0;var indexLastRepeatCell=lastRepeatColHeaderInRow(oTable,0);iRepeatCols=sumColumnCountForCell(oTable,0,indexLastRepeatCell);return(iRepeatCols);}function lastRepeatColHeaderInRow(oTable,indexRow){var oTRs=oTable.rows;if(!oTRs){return(0);}var iLastIndex=oTRs[indexRow].childNodes.length-1;var indexLastRepeatCell=-1;for(var i=0;i<=iLastIndex;i++){if(oTRs[indexRow].childNodes[i].getAttribute){var szAX=oTRs[indexRow].childNodes[i].getAttribute("AX");}if(!szAX||(szAX!="1")){break;}else{indexLastRepeatCell=i;}}if(indexLastRepeatCell<iLastIndex){if(oTRs[indexRow].childNodes[indexLastRepeatCell+1].getAttribute){if((oTRs[indexRow].childNodes[indexLastRepeatCell+1].getAttribute("AX")=="2")&&(oTRs[indexRow].childNodes[indexLastRepeatCell+1].getAttribute("OR")=="H")){indexLastRepeatCell+=1;}}}return(indexLastRepeatCell);}function sumColumnCountForCell(oTable,indexRow,indexCell){if(!(oTable.rows)){return(0);}var oTR=oTable.rows[indexRow];if(!oTR){return(0);}var colCounter=0;for(var i=0;i<indexCell+1;i++){colCounter+=util_parseSpan(oTR.childNodes[i],1);}return(colCounter);}function util_parseSpan(oTD,defaultVal){var iColspan=oTD.getAttribute("COLSPAN");if((iColspan)&&(!isNaN(parseInt(iColspan)))){return(parseInt(iColspan));}return(defaultVal);}function getLetterForColumn(iColumn){var CHAR_CODE_A=97;var n1=0;var nTop=0;var nBottom=0;do{n1++;nTop=26*n1;nBottom=26*(n1-1)+1;if((iColumn<=nTop)&&(iColumn>=nBottom)){break;}}while(nTop<=256);var sResult1="";var sResult2="";if(n1>1){sResult1=String.fromCharCode(CHAR_CODE_A+n1-2);}sResult2=String.fromCharCode(CHAR_CODE_A+(iColumn-nBottom));return(sResult1+sResult2);}
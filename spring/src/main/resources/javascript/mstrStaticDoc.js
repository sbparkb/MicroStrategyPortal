mstrStaticDoc.prototype=new mstrBoneImpl();mstrStaticDoc.prototype.type=microstrategy.OBJTYPE_DOC;mstrStaticDoc.prototype.sections={};mstrStaticDoc.prototype.horizontalContainers={};mstrStaticDoc.prototype.commands=new mstrDocCommandsImpl();mstrStaticDoc.prototype.styleObj=null;mstrStaticDoc.prototype.left=null;mstrStaticDoc.prototype.top=null;mstrStaticDoc.prototype.MAX_WIDTH=56;mstrStaticDoc.prototype.path="";mstrStaticDoc.prototype.verifiedPath="";mstrStaticDoc.prototype.items=null;mstrStaticDoc.prototype.formattingAttributes=null;mstrStaticDoc.prototype.isVisualization=false;mstrStaticDoc.prototype.containsHorizontalSections=false;mstrStaticDoc.prototype.prevSelectedId=null;mstrStaticDoc.prototype.docPropsMap={PageWidth:{l:"paperWidth"},PageHeight:{l:"paperHeight"},PaperOrientation:{f:"Orientation"},MarginLeft:{l:"marginLeft"},MarginTop:{l:"marginTop"},MarginRight:{l:"marginRight"},MarginBottom:{l:"marginBottom"},LayoutFillColor:{f:"backgroundColor"},tabMPHF:{f:"TabMPHF",l:"currentLayoutMPHF"},TabName:{f:"windowTitle",l:"currentLayoutName"},CtlAutoSubmit:{l:"ctlAutoSubmit"},Autowire:{l:"autoWire"},EnableToc:{f:"Enabled"},TOCTitle:{f:"Title"},TabLeader:{f:"ShowTabLeader"},WatermarkText:{f:"Text"},incrFetchEnabled:{l:"enabled"},incrFetchBlockCount:{l:"blockCount"},incrFetchCurLevel:{l:"curLevel"},incrFetchLevels:{l:"levels"},DefaultSelectorsAsFilter:{f:"SelectorBehavior"},PreserveTranslations:{f:"PreserveTranslations"}};mstrStaticDoc.prototype.onload=function(e){try{this.initDoc();window.setTimeout(function(){mstrMsgBoxImpl.hideMessage(null,"controlTargetsRecorder");},100);if(typeof (mstr)!="undefined"){this.initNotesIcon();mstr.controllers.Factory.add(microstrategy.updateManager);}if(this.parentBone.isEditableViewModeEplus()&&this.parentBone.prevControl){this.commands.exec("currentControl",this.parentBone.prevControl);if(this.parentBone.prevControlLocked=="1"){this.parentBone.insertionControlLocked=true;}}if(mstrApp!==undefined){if(!this.parentBone.isEditableViewModeEplus()){mstrLocalStorage.addScreenshot(mstrApp.getLastMsgRecoveryInfo(),"mstrWebContents");}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.processDocPropertyChanges=function(cmdArray){try{var ac=new Array();var um=this.parentBone.updateManager;var submit=this.processStaticDocPropertyChanges(cmdArray,ac);if(ac.length>0){um.add(ac,true);if(submit){um.flushAndSubmitChanges();}}}catch(err){microstrategy.errors.log(err);}};mstrStaticDoc.prototype.processStaticDocPropertyChanges=function(cmdArray,ac){try{var submit=false,pb=this.parentBone;um=pb.updateManager,scheduleProcessed=false,usersProcessed=false;for(var i=0,cnt=cmdArray.length;i<cnt;i++){var cmdId=cmdArray[i].cmdId;var value=cmdArray[i].value;var fn=(this.docPropsMap[cmdId]&&this.docPropsMap[cmdId].f)||cmdId;var lp=(this.docPropsMap[cmdId]&&this.docPropsMap[cmdId].l)||cmdId;switch(cmdId){case"PaperOrientation":case"PaperType":case"Scaling":case"ScalePercentage":case"SectionHorizontalOverflow":case"ExportRange":case"ExcelGraphFormat":this.saveDocProperty(fn,value,ac);this.parentBone[lp]=value;break;case"ScalePagesWide":case"ScalePagesTall":value=(trim(value)==""?0:value);this.saveDocProperty(fn,value,ac);this.parentBone[lp]=value;break;case"ScalePageHeaderFooter":case"UseOneSheetPerLayout":case"UseOneSheetPerGroupElement":case"PromptUserForPagebyExport":case"IncludeBookmarks":case"ShowBookmarks":case"EmbedFonts":case"ExcelEmbedImages":case"enableGraphTooltips":case"EnableZoom":case"EnableCopyForText":case"EnableCopyForGridCell":this.saveDocProperty(fn,(value)?microstrategy.TRUE:microstrategy.FALSE,ac);this.parentBone[lp]=value;break;case"RefreshDocument":this.parentBone.RefreshDocument=value;if(value==false){var v=-1;this.saveDocProperty("RefreshFrequency",v,ac);this.parentBone.RefreshFrequency=v;}break;case"RefreshFrequency":var ck=this.commands.queryState("RefreshDocument");value=ck?value:-1;this.saveDocProperty(cmdId,value,ac);this.parentBone[cmdId]=value;break;case"PageWidth":case"PageHeight":case"MarginLeft":case"MarginTop":case"MarginRight":case"MarginBottom":var v=microstrategy.number.toUSUnits(value);this.saveDocProperty(fn,v,ac);this.parentBone[lp]=v;break;case"GraphFormat":this.saveDocProperty(fn,(value)?"10":"11",ac);this.parentBone[lp]=value;break;case"GraphQualityDPI":this.saveDocProperty(fn,(value)?"96":"288",ac);this.parentBone[lp]=value;break;case"DefaultPageByExportMode":this.saveDocProperty(fn,(value)?"0":"1",ac);this.parentBone[lp]=value;break;case"scheduleType":case"selectedSchedules":pb[lp]=value;scheduleProcessed=true;break;case"userType":case"selectedUsers":pb[lp]=value;usersProcessed=true;break;case"MakePrivate":ac.push(um.createActionObject(null,mstrUpdateManager.SET_VIEW_MEDIA,this.parentBone.beanPath,[(value)?"2048290":"2048291"],[mstr.Enum.VIEWMEDIA.PRIVATE],[]));submit=true;break;}switch(cmdId){case"PaperOrientation":case"PageWidth":case"MarginLeft":case"MarginRight":this.updatePageWidth();this.displayPageBreaker();break;case"PromptUserForPagebyExport":submit=true;}}var st=pb.scheduleType,ss=pb.selectedSchedules;if(scheduleProcessed&&(st!=pb.scheduleTypeWas||ss!=pb.selectedSchedulesWas)){ac.push(um.createActionObject(null,mstrUpdateManager.SAVE_RW_ASSOCIATED_SCHEDULES,this.parentBone.beanPath,["2048254","2048255"],[st,ss]));}var userType=parseInt(pb.userType,10),selectedUsers=pb.selectedUsers;if(usersProcessed&&(userType!=pb.userTypeWas||selectedUsers!=pb.selectedUsersWas)){var allowType={0:1,1:0,2:1}[userType];var v=[];if(userType===2){for(var i=0,len=selectedUsers.length;i<len;i++){var user=selectedUsers[i],allow=pb.userSubscribeRights[user.rgt];v.push(user.did+ITEM_SEPARATOR+allow+ITEM_SEPARATOR+user.n);}}var users=v.join(CLIPBOARD_ITEM_SEPARATOR);ac.push(um.createActionObject(null,mstrUpdateManager.SAVE_RW_ASSOCIATED_USERS,this.parentBone.beanPath,["2048277","2048276"],[allowType,users]));}return submit;}catch(err){microstrategy.errors.log(err);}return false;};mstrStaticDoc.prototype.saveDocProperty=function(prop,value,ac,nodeKey){try{var um=this.parentBone.updateManager;var f=mstrFormatObject;var data;switch(prop){case"width":case"windowTitle":var key=nodeKey||this.parentBone.currentLayout||this.parentBone.rootNodeKey;if(!key){break;}data=mstrUpdateManager.createPropertyEditString(key,prop,value);ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,data],[]));break;case"PaperType":case"PageWidth":case"PageHeight":case"Orientation":case"Scaling":case"ScalePercentage":case"ScalePagesWide":case"ScalePagesTall":case"ScalePageHeaderFooter":case"SectionHorizontalOverflow":case"MarginLeft":case"MarginRight":case"MarginTop":case"MarginBottom":case"UsePageWidthAsLayoutWidth":if(this.parentBone.currentLayout){data=mstrUpdateManager.createPropertyEditString(this.parentBone.currentLayout,prop,value);ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_PROPS,this.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_NOW,data],[]));}else{data=mstrUpdateManager.createPropertyEditString(null,prop,value);ac.push(um.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,data],[]));}break;default:var psName;if(prop==="CtlAutoSubmit"){psName="RWDocumentProperties";}data=mstrUpdateManager.createPropertyEditString(null,prop,value,false,psName);ac.push(um.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,this.parentBone.beanPath,["2048018","2048065"],[mstrUpdateManager.UPDATE_NOW,data],[]));}}catch(err){microstrategy.errors.log(err);}};mstrStaticDoc.prototype.updatePageWidth=function(){try{if(this.parentBone.usePageWidthAsLayoutWidth==-1){var newWidth=this.getPageWidth();newWidth=((this.minWidth>parseInt(newWidth))?this.minWidth:newWidth)+"px";this.styleObj.setValue(this.elem,"width",newWidth);this.parentBone.syncDocRszHandler();this.updateHRulerWidth();}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.getPageWidth=function(){try{var format=microstrategy.getFormatObject();var obWidth=parseInt(format.decodeValue("width",this.parentBone.paperWidth));var obMarginLeft=parseInt(format.decodeValue("left",this.parentBone.marginLeft));var obMarginRight=parseInt(format.decodeValue("left",this.parentBone.marginRight));var obBorderLeft=parseInt(format.decodeValue("left",this.parentBone.leftBorderWidth));var obBorderRight=parseInt(format.decodeValue("left",this.parentBone.rightBorderWidth));return(obWidth-obMarginLeft-obMarginRight-obBorderLeft-obBorderRight);}catch(err){microstrategy.errors.log(err);return null;}};mstrStaticDoc.prototype.displayPageBreaker=function(){};mstrStaticDoc.prototype.initNotesIcon=function(){try{var notesIconModel=mstr.$obj("NotesIconModel_model");if(notesIconModel&&!this.parentBone.needSaveBeforeNotes){notesIconModel.set("objectID",this.parentBone.objectID);notesIconModel.set("objectType",this.parentBone.objectType);}if(this.parentBone.needSaveBeforeNotes||(microstrategy.bone("accordion_AccordionTabManagerStyle")&&microstrategy.bone("accordion_AccordionTabManagerStyle").currentTabName==microstrategy.ACCORDION_RW_NOTES_PANEL)){var notesIconView=mstr.$obj("NotesIconView_view");if(notesIconView){notesIconView.set("visible",false);}}else{if(notesIconModel){notesIconModel.execCheck();}}}catch(err){microstrategy.errors.log(err);}};mstrStaticDoc.prototype.onpostload=function(e){try{mstrBoneImpl.prototype.onpostload.call(this);if(this.parentBone.isInteractiveViewModeEplus()||this.parentBone.layoutHeightMode!=1||this.parentBone.layoutWidthMode==0){this.synchHeightOfHorizontalSections();}this.syncPosition();return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.onwinresize=function(t,l){try{this.syncPosition(t,l);window.setTimeout(function(){iframe.hideWaitPage(true);},mstr.utils.ISIE8?100:0);}catch(err){microstrategy.errors.log(err);}};mstrStaticDoc.prototype.shouldIgnoreKeyEvent=function(e){try{if(!e){e=window.event;}if(currentModalEditor!=null&&currentModalEditor.length>0||mstr.controllers.ModalEditors.size()>0){return true;}if(microstrategy.isContextMenuOpen()){return true;}var src=getEventTarget(e);if(src.tagName){var name=src.tagName.toLowerCase();if(name=="input"||name=="select"||name=="textarea"){return true;}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.onkeydown=function(e){try{if(!e){e=window.event;}if(this.shouldIgnoreKeyEvent(e)){return true;}switch(e.keyCode){case 8:if(bIsIE4){e.cancelBubble=true;}return false;break;case 123:if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){toggleScreenMode();return false;}break;case 119:if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.parentBone.isFeatureAvailable(microstrategy.FEATURE_DATASET_OBJECTS_LIST)){this.commands.exec("toggleAccordion");return false;}break;}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.onkeypress=function(e){return true;};mstrStaticDoc.prototype.ondocumentclick=function(e){return true;};mstrStaticDoc.prototype.initDoc=function(){try{this.initBone();this.syncPosition();this.commands.parentBone=this;this.formattingAttributes=this.parentBone.formattingAttributes;microstrategy.styleObj=new mstrDocStyleImpl(this.formattingAttributes);microstrategy.styleObj.onload();this.styleObj=microstrategy.styleObj;this.path="microstrategy.bone('"+this.parentBone.id+"').doc";this.verifiedPath=microstrategy.getEventHandlerString(this.path);if(this.parentBone.isInteractiveViewModeEplus()||this.parentBone.layoutHeightMode!=1||this.parentBone.layoutWidthMode==0){this.initHorizontalContainers();this.initSections();var that=this;window.setTimeout(function(){that.synchHeightOfHorizontalSections();},0);}this.initRoundedRectangles();this.initButtons();for(var i=0;i<currentModalEditor.length;i++){var editor=document.getElementById(currentModalEditor[i]);if(editor!=null&&editor.getAttribute(mstrHTMLAttributes.ATTR_HIDDEN)=="true"){currentModalEditor.length=i;break;}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.adjustWidth=function(){try{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.parentBone.layoutWidthMode==0){var orgWidth=this.elem.style.width;if(bIsW3C||bIsIE7){this.elem.style.width="100000px";}this.minWidth=this.getRightMostPos();var newWidth=(this.minWidth>parseInt(orgWidth))?this.minWidth+"px":orgWidth;if(this.elem.style.width!=newWidth){this.elem.style.width=newWidth;}if(mstr.utils.ISIE6){var table=microstrategy.findChildWithAtt(this.parentBone.elem,"table","className","rulerTable");if(table){table.style.width=newWidth;}}}else{if(this.parentBone.currentRWViewMode==microstrategy.RW_VIEW_MODE_EDITABLE){this.minWidth=0;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.onpanelchange=function(){return true;};mstrStaticDoc.prototype.syncPosition=function(t,l){try{this.left=l||getObjSumLeft(this.elem);this.top=t||getObjSumTop(this.elem);for(var id in this.sections){if(this.sections[id].syncPosition){this.sections[id].syncPosition();}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.initSections=function(){try{this.sections={};this.subSectionsInSection={};var sectionSubSections=this.parentBone.sectionSubsections;if(sectionSubSections!=null){var groups=sectionSubSections.split(";");for(var i=0;i<groups.length;i++){var section=groups[i].substring(0,groups[i].indexOf("?"));this.subSectionsInSection[section]=groups[i].substring(groups[i].indexOf("?")+1);if(typeof (this.sections[section])=="undefined"){var bone=new mstrDocSectionImpl(section);bone.parentBone=this;bone.path=this.path+".sections['"+section+"']";this.sections[section]=bone;if(bone.onload){bone.onload();}}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.initRoundedRectangles=function(){try{this.roundedRectangles={};var roundedRectanglesString=this.parentBone.roundedRectangles;if(roundedRectanglesString!=null&&roundedRectanglesString.length>0){var rectangles=roundedRectanglesString.split(";");for(var i=0;i<rectangles.length-1;i++){this.initRoundedRectangle(rectangles[i]);}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.initRoundedRectangle=function(id){try{microstrategy.registerBone(id,"mstrRoundedRectangleScript",null);function onloadRoundedRectangle(id){if(microstrategy.bone(id)!=null){microstrategy.bone(id).onload();}else{window.setTimeout(function(){onloadRoundedRectangle(id);},250);}}onloadRoundedRectangle(id);return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.initButtons=function(){try{var buttonsString=this.parentBone.buttons;if(buttonsString!=null&&buttonsString.length>0){var buttons=buttonsString.split(";");for(var i=0;i<buttons.length-1;i++){this.initButton(buttons[i]);}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.initButton=function(id){try{microstrategy.registerBone(id,"mstrButtonScript",null);function pollOnLoad(){if(microstrategy.bone(id)!=null){microstrategy.bone(id).onload();}else{window.setTimeout(pollOnLoad,250);}}pollOnLoad();return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.initHorizontalContainers=function(){try{if(!this.containsHorizontalSections){return ;}this.horizontalContainers={};var horizontalContainers=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(horizontalContainers){for(var i=0;i<horizontalContainers.length;i++){var id=horizontalContainers[i].getAttribute("id");if(typeof (this.horizontalContainers[id])=="undefined"){var bone=new mstrHorizontalContainerImpl(id);bone.parentBone=this;bone.path=this.path+".horizontalContainers['"+id+"']";if(bone.onload){bone.onload();}this.horizontalContainers[id]=bone;}}}}catch(err){microstrategy.errors.log(err);}};mstrStaticDoc.prototype.synchHeightOfHorizontalSections=function(subSectionBone){try{if(!this.containsHorizontalSections){return ;}if(subSectionBone){for(var i=0;i<subSectionBone.sibs.length;i++){var hcDiv=microstrategy.findAncestorWithAtt(subSectionBone.sibs[i],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(hcDiv){var horizontalContainer=microstrategy.findBone(hcDiv);horizontalContainer.propogateHeightToChildren();}}}else{for(var id in this.horizontalContainers){this.horizontalContainers[id].propogateHeightToChildren();var contHeight=microstrategy.styleObj.getValue(this.horizontalContainers[id].elem,"height");if(contHeight==-1||contHeight==""){this.parentBone.totalHeight+=parseInt(microstrategy.styleObj.getValue(this.horizontalContainers[id].subSections[0],"height"));}else{this.parentBone.totalHeight+=parseInt(microstrategy.styleObj.getValue(this.horizontalContainers[id].elem,"height"));}}}microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}catch(err){microstrategy.errors.log(err);}};mstrStaticDoc.prototype.adjustHeightOfHorizontalSubSections=function(subSectionBone,fromEditor){try{if(!this.containsHorizontalSections){return ;}if(subSectionBone){var hcDiv=microstrategy.findAncestorWithAtt(subSectionBone.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(hcDiv){var horizontalContainer=microstrategy.findBone(hcDiv);horizontalContainer.adjustSubsectionHeight(fromEditor);}}}catch(err){microstrategy.errors.log(err);}};mstrStaticDoc.prototype.resetHeightOfHorizontalSections=function(subSectionBone){try{if(subSectionBone){for(var i=0;i<subSectionBone.sibs.length;i++){var hcDiv=microstrategy.findAncestorWithAtt(subSectionBone.sibs[i],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(hcDiv){var horizontalContainer=microstrategy.findBone(hcDiv);horizontalContainer.resetHeight();}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.onSubSectionResize=function(){return true;};mstrStaticDoc.prototype.getGradientColor=function(obj,fmtType,allPanels){try{var bone;if(fmtType==microstrategy.FORMAT_TYPE_MAIN){if(obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){bone=microstrategy.findBone(obj);if(!bone.isTable){if(allPanels==true){if(bone.panels){var value=bone.panels[0].elem.getAttribute("gradientcolor");for(var i=1;i<bone.panels.length;i++){var local=bone.panels[i].elem.getAttribute("gradientcolor");if(local!=value){return null;}}return value;}}else{var item=bone.getCurrentPanel().elem;return item.getAttribute("gradientcolor");}}}else{return obj.getAttribute("gradientcolor");}}else{bone=microstrategy.findBone(obj);if(bone&&bone.getFormatValue){return bone.getFormatValue(fmtType,"gradientcolor");}}return null;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.processSubsectionBone=function(subBone){try{if(subBone){if(subBone.subsectionType!=mstrSubSection.TYPE_PANEL){subBone.setNeedToUpdateMaxContentHeight(true);if(subBone.isHorizontal){this.resetHeightOfHorizontalSections(subBone);this.adjustHeightOfHorizontalSubSections(subBone);this.synchHeightOfHorizontalSections(subBone);}else{subBone.adjustSubsectionHeight();}}}}catch(err){microstrategy.errors.log(err);}};mstrStaticDoc.prototype.removePaddingAndBorder=function(item,newValue,styleProp){try{newValue=String(newValue);if(newValue=="100%"||newValue=="auto"){return newValue;}return Math.max(Math.round(parseFloat(newValue)-microstrategy.getPaddingAndBorderPixels(item,styleProp)),0);}catch(err){microstrategy.errors.log(err);return newValue;}};mstrStaticDoc.prototype.checkAppliesTo=function(item,prop){try{return microstrategy.isEnabledForItem(item,prop);}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.hasMoved=function(){try{return(getObjSumLeft(this.elem)!=this.left||getObjSumTop(this.elem)!=this.top);}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.getRightMostPos=function(){try{var rightX=0;for(var sec in this.sections){rightX=Math.max(this.sections[sec].getRightMostPos(),rightX);}for(var hCont in this.horizontalContainers){rightX=Math.max(this.horizontalContainers[hCont].getRightMostPos(),rightX);}return rightX;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.getChildBone=function(obj){try{var type=obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE);switch(type){case microstrategy.OBJTYPE_DOC_SUBSECTION:var secId=microstrategy.findAncestorWithAtt(obj,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION).getAttribute("id");if(secId in this.sections&&this.sections[secId].isLoaded){return this.sections[secId].getChildBone(obj);}break;case microstrategy.OBJTYPE_DOC_SECTION:if(obj.getAttribute("id") in this.sections&&this.sections[obj.getAttribute("id")].isLoaded){return this.sections[obj.getAttribute("id")];}break;case microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER:if(obj.getAttribute("id") in this.horizontalContainers&&this.horizontalContainers[obj.getAttribute("id")].isLoaded){return this.horizontalContainers[obj.getAttribute("id")];}break;}return null;}catch(err){microstrategy.errors.log(err);return false;}};mstrStaticDoc.prototype.getMaxZIndex=function(obj){try{var maxZIndex=0;if(this.sections){for(var id in this.sections){var subsections=this.sections[id].subsections;if(subsections){for(var sub in subsections){var subSection=subsections[sub];if(subSection.maxZindex){maxZIndex=(subSection.maxZindex>maxZIndex)?subSection.maxZindex:maxZIndex;}}}}}return maxZIndex;}catch(err){microstrategy.errors.log(err);return 0;}};mstrStaticDoc.prototype.showGradient=function(){return false;};mstrStaticDoc.getBone=function(obj){try{var res=null;var objType=obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);switch(objType){case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:res=microstrategy.bone(obj.id+"_Ctl");break;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:res=microstrategy.bone(obj.id);break;case microstrategy.SUBOBJTYPE_DOC_SHAPE:if(obj.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){res=microstrategy.bone(obj.id);}break;case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:var gridORgraph=microstrategy.subObjectFind(obj,"div",microstrategy.SUBOBJTYPE_GRID_TABLE);if(!gridORgraph){gridORgraph=microstrategy.findChildWithAtt(obj,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrGridRW");}if(!gridORgraph){gridORgraph=microstrategy.findChildWithAtt(obj,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrReportGraphImpl");}if(gridORgraph){res=microstrategy.bone(gridORgraph.id);}break;}return res;}catch(err){microstrategy.errors.log(err);return null;}};mstrStaticDoc.prototype.resizeSubMaskForSib=function(secId,subId,newValue,sibIndex,prop){return false;};mstrStaticDoc.prototype.hideSubMaskForSib=function(secId,subId,hide,sibIndex){return false;};mstrStaticDoc.prototype.setVisualizationSettings=function(enabled,selectedVisualization,visualizationList,viewMode,actionCollection,visProps,layoutId,dontUseIFrame){try{var event=mstrUpdateManager.SET_DOC_VISUALIZATION_PROPERTIES;this.parentBone.updateManager.useIframe=!!dontUseIFrame;var argIdArray=new Array();var argValueArray=new Array();if(enabled){argIdArray[argIdArray.length]="2048112";argValueArray[argValueArray.length]=enabled;}if(selectedVisualization!=null){argIdArray[argIdArray.length]="2048110";argValueArray[argValueArray.length]=selectedVisualization;var vis=this.parentBone.getAllVisList()[selectedVisualization];if(vis){argIdArray[argIdArray.length]="2048177";argValueArray[argValueArray.length]=(typeof (vis.ip)!="undefined")?vis.ip:"0";argIdArray[argIdArray.length]="2048211";argValueArray[argValueArray.length]=(typeof (vis.im)!="undefined")?vis.im:"";}}if(visualizationList!=null){argIdArray[argIdArray.length]="2048111";argValueArray[argValueArray.length]=visualizationList;}if(viewMode){argIdArray[argIdArray.length]="2048109";argValueArray[argValueArray.length]=viewMode;}if(visProps!=null){argIdArray[argIdArray.length]="2048213";argValueArray[argValueArray.length]=visProps;}if(layoutId){argIdArray[argIdArray.length]="2048212";argValueArray[argValueArray.length]=layoutId;}microstrategy.updateVisProps(enabled,selectedVisualization,visualizationList,viewMode,this.parentBone);if(actionCollection){actionCollection.push(this.parentBone.updateManager.createActionObject(this.elem,event,this.parentBone.beanPath,argIdArray,argValueArray,[]));actionCollection.push(this.parentBone.updateManager.createActionObject(this.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[]));if(this.parentBone.observer){this.parentBone.observer.notifyAll("onvischange");}}else{this.parentBone.updateManager.add([this.parentBone.updateManager.createActionObject(this.elem,event,this.parentBone.beanPath,argIdArray,argValueArray,[])]);this.parentBone.updateManager.add([this.parentBone.updateManager.createActionObject(this.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.beanPath,[],[],[])]);this.parentBone.updateManager.flushAndSubmitChanges();}return true;}catch(err){microstrategy.errors.log(err);return false;}};function mstrStaticDoc(id){this.inherits=mstrBoneImpl;this.inherits(id);this.inherits=null;return this;}mstrDocStyleImpl.prototype={};mstrDocStyleImpl.prototype.objSheet=null;mstrDocStyleImpl.prototype.styleDefaults={zIndex:0};mstrDocStyleImpl.prototype.formattingAttributes=null;mstrDocStyleImpl.HTMLATTR_CLASS_ID="rl";mstrDocStyleImpl.prototype.onload=function(e){try{for(var i=document.styleSheets.length-1;i>=0;i--){var styleSheet=document.styleSheets[i];if(styleSheet.title=="docObjectRules"||(styleSheet.ownerNode&&styleSheet.ownerNode.id=="docObjectStyle")||styleSheet.id=="docObjectStyle"){this.objSheet=document.styleSheets[i];this.objSheet.styleRules=(this.objSheet.rules)?this.objSheet.rules:this.objSheet.cssRules;break;}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocStyleImpl.prototype.reloadFormattingAttributes=function(attrs){this.formattingAttributes=attrs;this.onload();};mstrDocStyleImpl.prototype.getValue=function(obj,prop,formatType){try{var bone;prop=this.swapForRotation(obj,prop);if(!formatType){formatType=microstrategy.formatType;}if(formatType&&formatType!=microstrategy.FORMAT_TYPE_MAIN){bone=mstrStaticDoc.getBone(obj);if(bone&&bone.getFormatValue){return bone.getFormatValue(formatType,prop);}}var subtype=obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);prop=this.resolveStyles(obj,prop);if(prop=="backgroundColor"){if(subtype==microstrategy.SUBOBJTYPE_DOC_SHAPE){if(obj.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){bone=microstrategy.bone(obj.id);if(bone&&bone.backgroundColor!=null){return bone.backgroundColor;}}}else{if(subtype==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){bone=microstrategy.findBone(obj);obj=bone.getCurrentPanel().elem;}}}if(prop=="textDecoration"&&this.doTextDecOnBone(obj)){bone=microstrategy.findBone(obj);return bone.textDecoration;}var local=obj.style[prop];if((!local)||local.length==0||(prop in this.styleDefaults&&local==this.styleDefaults[prop])){var id=this.getId(obj);if(!isNaN(id)){local=this.objSheet.styleRules[id].style[prop];}}if(local=="medium"&&prop.indexOf("border")>-1&&prop.indexOf("Width")>-1){local="0pt";}if((prop.toLowerCase()).indexOf("color")>-1&&local){local=mstr.utils.Color.rgbStr2hex(local);}if(typeof (local)=="undefined"){var fmt=microstrategy.getFormatObject();var type=fmt.isTargetStyleOrAttr(prop);if(type&mstrFormatObject.TARGET_VALUE_ATTR){var attr=fmt.getAttrNameFromStyle(prop);local=this.getAttValue(obj,attr);}}if(!bIsDXIE&&(prop==="left"||prop==="top")){var textDirection=obj.direction||"0",vExtra=Math.round(microstrategy.getPaddingAndBorderPixels(obj,"height")),hExtra=Math.round(microstrategy.getPaddingAndBorderPixels(obj,"width")),visualWidth=parseInt(this.getValue(obj,"width"),0)+hExtra,visualHeight=parseInt(this.getValue(obj,"height"),0)+vExtra;if(prop==="top"&&textDirection==="90"){local=parseInt(local,0)-visualHeight+"px";}else{if(prop==="left"&&textDirection==="-90"){local=parseInt(local,0)-visualWidth+"px";}}}return local;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocStyleImpl.prototype.isRotated=function(obj){try{var rotation=false,formats=this.formattingAttributes;if(!formats){return rotation;}var tdUnits=formats.tdUnits,tdUnit=tdUnits&&tdUnits[obj.id];if(tdUnit){rotation=parseInt(tdUnits[obj.id],10);}return rotation;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocStyleImpl.prototype.swapForRotation=function(obj,prop,inverse){try{if(prop.indexOf("width")<0&&prop.indexOf("height")<0&&prop.indexOf("padding")<0&&prop.indexOf("border")){return prop;}var textDirection=obj.direction||this.getValue(obj,"TextDirection")||"0";if(textDirection!=="0"){switch(prop){case"height":return"width";case"width":return"height";}}if((!inverse&&textDirection==="90")||(inverse&&textDirection==="-90")){if(prop.indexOf("Left")>=0){return prop.replace("Left","Top");}else{if(prop.indexOf("Right")>=0){return prop.replace("Right","Bottom");}else{if(prop.indexOf("Top")>=0){return prop.replace("Top","Right");}else{if(prop.indexOf("Bottom")>=0){return prop.replace("Bottom","Left");}}}}}else{if((!inverse&&textDirection==="-90")||(inverse&&textDirection==="90")){if(prop.indexOf("Left")>=0){return prop.replace("Left","Bottom");}else{if(prop.indexOf("Right")>=0){return prop.replace("Right","Top");}else{if(prop.indexOf("Top")>=0){return prop.replace("Top","Left");}else{if(prop.indexOf("Bottom")>=0){return prop.replace("Bottom","Right");}}}}}}return prop;}catch(err){microstrategy.errors.log(err);return prop;}};mstrDocStyleImpl.prototype.setValue=function(elem,prop,value,formatType){try{formatType=formatType||microstrategy.formatType;if(formatType!=microstrategy.FORMAT_TYPE_MAIN){var bone=mstrStaticDoc.getBone(elem);if(bone&&bone.setFormatValue){bone.setFormatValue(formatType,prop,value);return ;}}this.formatElem(elem,prop,value);}catch(err){microstrategy.errors.log(err);}};mstrDocStyleImpl.prototype.doTextDecOnBone=function(elem){try{var doOnBone=false;if(elem.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){var controlBone=microstrategy.bone(elem.getAttribute("id")+"_Ctl");if(controlBone){doOnBone=(controlBone.ctlStyle==mstrRWControlImpl.CTL_STYLE_LIST_BOX);}}return doOnBone;}catch(err){microstrategy.errors.log(err);}};mstrDocStyleImpl.prototype.formatElem=function(elem,prop,value){try{if(value!=null&&String(value).length>0){var originalProp=prop;prop=this.resolveStyles(elem,prop);if(prop){if(prop=="backgroundColor"){if(bIsDXIE){var gradientFilter=this.getFilter(elem,"Gradient");if(gradientFilter!=null){gradientFilter.enabled=false;}}else{if(elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&elem.getAttribute("scriptclass")!="mstrPanel"){var gradientBack=elem.previousSibling;if(gradientBack&&gradientBack.id==(elem.id+gradientUtil.GRADIENT_POSTFIX)){gradientBack.style.background="transparent";}}else{elem.style.background="transparent";}}}var fmt=microstrategy.getFormatObject();var type=fmt.isTargetStyleOrAttr(prop);if(type&mstrFormatObject.TARGET_VALUE_STYLE){switch(prop){case"dropShadowDepth":case"dropShadowEffect":elem.style[prop]=value;this.applyShadow(elem,prop,value);break;case"alphaOpacity":case"alphaEffect":this.applyAlpha(elem,prop,value);elem.style[prop]=value;break;case"textDecoration":var hasUnderline=elem.style[prop].indexOf("underline")>=0;var hasStrikeout=elem.style[prop].indexOf("line-through")>=0;if(this.doTextDecOnBone(elem)){var controlBone=microstrategy.findBone(elem);hasUnderline=controlBone[prop]&&controlBone[prop].indexOf("underline")>=0;hasStrikeout=controlBone[prop]&&controlBone[prop].indexOf("line-through")>=0;}var newValue="";if(originalProp=="textDecoration"){hasUnderline=value.indexOf("underline")>=0;}else{hasStrikeout=value.indexOf("line-through")>=0;}newValue="none";if(hasUnderline){newValue="underline";}if(hasStrikeout){if(hasUnderline){newValue+=" line-through";}else{newValue="line-through";}}if(this.doTextDecOnBone(elem)){elem.style[prop]="none";controlBone[prop]=newValue;}else{elem.style[prop]=newValue;}var anchors=elem.getElementsByTagName("a");if(anchors){for(var k=0;k<anchors.length;k++){anchors[k].style[prop]=newValue;}}break;case"TextDirection":elem.style[prop]=value;this.applyTextDirection(elem,prop,value);break;case"color":elem.style[prop]=value;var anchors=elem.getElementsByTagName("a");if(anchors){for(var k=0;k<anchors.length;k++){anchors[k].style[prop]=value;}}break;case"paddingTop":case"paddingBottom":case"paddingRight":case"paddingLeft":this.applyPadding(elem,prop,value);break;default:elem.style[prop]=value;}if(elem.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){this.cascadeSelectorValue(elem,originalProp,value);}}if(type&mstrFormatObject.TARGET_VALUE_ATTR){var attr=fmt.getAttrNameFromStyle(prop);this.setAttValue(elem,attr,fmt.encodeValue(prop,value));}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocStyleImpl.prototype.applyTextDirection=function(obj,prop,value){if(bIsDXIE){var newRotation;if(value=="0"){newRotation=0;}else{if(value=="90"){newRotation=3;}else{if(value=="-90"){newRotation=1;}}}var filter=this.getFilter(obj,"BasicImage");var oldRotation=filter?filter.rotation:0;var swap=Math.abs(oldRotation-newRotation)%2==1;var oldH=this.getValue(obj,this.swapForRotation(obj,"height",true));var oldW=this.getValue(obj,this.swapForRotation(obj,"width",true));var oldTop=this.getValue(obj,this.swapForRotation(obj,"paddingTop",true));var oldRight=this.getValue(obj,this.swapForRotation(obj,"paddingRight",true));var oldBottom=this.getValue(obj,this.swapForRotation(obj,"paddingBottom",true));var oldLeft=this.getValue(obj,this.swapForRotation(obj,"paddingLeft",true));if(swap){obj.style.height=oldW;obj.style.width=oldH;}if(swap&&(newRotation==1||oldRotation==3)){obj.style.paddingTop=oldRight;obj.style.paddingRight=oldBottom;obj.style.paddingBottom=oldLeft;obj.style.paddingLeft=oldTop;}else{if(swap&&(newRotation==3||oldRotation==1)){obj.style.paddingTop=oldLeft;obj.style.paddingLeft=oldBottom;obj.style.paddingBottom=oldRight;obj.style.paddingRight=oldTop;}else{if(!swap&&(newRotation==1||newRotation==3)){obj.style.paddingTop=oldBottom;obj.style.paddingBottom=oldTop;obj.style.paddingLeft=oldRight;obj.style.paddingRight=oldLeft;}}}if(filter){filter.rotation=newRotation;}else{if(newRotation==0){return ;}var filterText=obj.style.filter;var fromRules=false;if(filterText==null||filterText.length==0){filterText=this.getFilter(obj);if(filterText!=null&&filterText.length>0){fromRules=true;}}var basicImageDefinition=" progid:DXImageTransform.Microsoft.BasicImage(rotation="+newRotation+") ";if(fromRules){this.objSheet.styleRules[this.getId(obj)].style.filter=basicImageDefinition+this.objSheet.styleRules[this.getId(obj)].style.filter;}else{obj.style.filter=basicImageDefinition+obj.style.filter;}if(bIsIE8){setFilter(obj,"Alpha",{opacity:100});}}}else{var currRotation=-value;this.changeTextFieldRotation(obj,currRotation);}};mstrDocStyleImpl.prototype.changeTextFieldRotation=function(node,currRotation){if(bIsDXIE){return ;}if(node.direction===undefined){node.direction="0";}var cssPrefix=bIsIE10||bIsW3CIE?"t":(bIsFirefox?"MozT":"webkitT"),heightMode=parseInt(this.formattingAttributes[node.id].hm,10),width=this.getValue(node,"width"),height=this.getValue(node,"height"),position={x:parseInt(this.getValue(node,"top")),y:parseInt(this.getValue(node,"left"))};node.style[cssPrefix+"ransform"]="rotate("+currRotation+"deg)";node.style[cssPrefix+"ransformOrigin"]="top left";if(currRotation!==0){node.style.width=height;node.style.height=heightMode===0||microstrategy.DISPLAY_MODE===microstrategy.DESIGN_MODE?width:"auto";}else{node.style.width=width;node.style.height=heightMode===0||microstrategy.DISPLAY_MODE===microstrategy.DESIGN_MODE?height:"auto";}this.updateVerticalTextPaddingAndBorder(node,currRotation);this.updateVerticalTextShadow(node,currRotation);node.direction=this.getValue(node,"TextDirection");this.changeVerticalTextPosition(node,position);};mstrDocStyleImpl.prototype.updateVerticalTextPaddingAndBorder=function(obj,currRotation){var cachedStyle={paddingTop:this.getValue(obj,"paddingTop"),paddingBottom:this.getValue(obj,"paddingBottom"),paddingLeft:this.getValue(obj,"paddingLeft"),paddingRight:this.getValue(obj,"paddingRight"),borderTopWidth:this.getValue(obj,"borderTopWidth"),borderTopStyle:this.getValue(obj,"borderTopStyle"),borderTopColor:this.getValue(obj,"borderTopColor"),borderBottomWidth:this.getValue(obj,"borderBottomWidth"),borderBottomStyle:this.getValue(obj,"borderBottomStyle"),borderBottomColor:this.getValue(obj,"borderBottomColor"),borderLeftWidth:this.getValue(obj,"borderLeftWidth"),borderLeftStyle:this.getValue(obj,"borderLeftStyle"),borderLeftColor:this.getValue(obj,"borderLeftColor"),borderRightWidth:this.getValue(obj,"borderRightWidth"),borderRightStyle:this.getValue(obj,"borderRightStyle"),borderRightColor:this.getValue(obj,"borderRightColor")},exchangeStyle=function(src,des){for(var i=0;i<4;i++){obj.style["padding"+src[i]]=cachedStyle["padding"+des[i]];obj.style["border"+src[i]+"Width"]=cachedStyle["border"+des[i]+"Width"];obj.style["border"+src[i]+"Style"]=cachedStyle["border"+des[i]+"Style"];obj.style["border"+src[i]+"Color"]=cachedStyle["border"+des[i]+"Color"];}};switch(currRotation){case 0:exchangeStyle(["Top","Bottom","Left","Right"],["Top","Bottom","Left","Right"]);break;case -90:exchangeStyle(["Top","Bottom","Left","Right"],["Left","Right","Bottom","Top"]);break;case 90:exchangeStyle(["Top","Bottom","Left","Right"],["Right","Left","Top","Bottom"]);break;}};mstrDocStyleImpl.prototype.changeVerticalTextPosition=function(obj,position){if(bIsDXIE){return ;}var textDirection=obj.direction||this.getValue(obj,"TextDirection")||"0",vExtra=Math.round(microstrategy.getPaddingAndBorderPixels(obj,"height")),hExtra=Math.round(microstrategy.getPaddingAndBorderPixels(obj,"width")),visualWidth=parseInt(this.getValue(obj,"width"),0)+hExtra,visualHeight=parseInt(this.getValue(obj,"height"),0)+vExtra;if(position.x!==null){if(textDirection==="90"){obj.style.top=position.x+visualHeight+"px";}else{obj.style.top=position.x+"px";}}if(position.y!==null){if(textDirection==="-90"){obj.style.left=position.y+visualWidth+"px";}else{obj.style.left=position.y+"px";}}};mstrDocStyleImpl.prototype.updateVerticalTextShadow=function(obj,currRotation){if(!bIsDXIE){var dropShadowEffect=parseInt(this.getValue(obj,"dropShadowEffect",microstrategy.FORMAT_TYPE_MAIN)),dropShadowDepth=parseInt(this.getValue(obj,"dropShadowDepth",microstrategy.FORMAT_TYPE_MAIN)),dropShadowInPixels=0,offX=0,offY=0;if(dropShadowEffect==0||isNaN(dropShadowEffect)){dropShadowDepth=0;}dropShadowInPixels=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,Math.round(dropShadowDepth*microstrategy.ZOOM_FACTOR/100));offX=dropShadowInPixels;offY=dropShadowInPixels;if(currRotation===-90){offX=-dropShadowInPixels;}else{if(currRotation===90){offY=-dropShadowInPixels;}}obj.style[(mstr.utils.ISWK?"webkitBoxShadow":"boxShadow")]=offX+"px "+offY+"px 3px 0 #888";}};mstrDocStyleImpl.prototype.applyPadding=function(obj,prop,value){prop=this.swapForRotation(obj,prop);obj.style[prop]=value;};mstrDocStyleImpl.prototype.applyShadow=function(obj,prop,value){if(obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var panelStack=microstrategy.findBone(obj);if(panelStack){panelStack.synchronizeShadow(prop=="dropShadowEffect"?value:null,prop=="dropShadowDepth"?value:null);}return ;}var dropShadowEffect=0;var dropShadowDepth=3;switch(prop){case"dropShadowDepth":dropShadowEffect=parseInt(this.getValue(obj,"dropShadowEffect",microstrategy.FORMAT_TYPE_MAIN));dropShadowDepth=parseInt(value);break;case"dropShadowEffect":dropShadowDepth=parseInt(this.getValue(obj,"dropShadowDepth",microstrategy.FORMAT_TYPE_MAIN));dropShadowEffect=parseInt(value);break;}var dropShadowInPixels;var that=this;function _applyShadow(){if(!document.getElementById(obj.getAttribute(microstrategy.HTMLATTR_ID))){window.setTimeout(_applyShadow,100);return ;}obj=document.getElementById(obj.getAttribute(microstrategy.HTMLATTR_ID));if(bIsDXIE){if(dropShadowEffect==0||isNaN(dropShadowEffect)){dropShadowDepth=0;}dropShadowInPixels=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,Math.round(dropShadowDepth*microstrategy.ZOOM_FACTOR/100));var shadowFilter=that.getFilter(obj,"dropshadow");if(shadowFilter){shadowFilter.color="#66000000";shadowFilter.positive="true";shadowFilter.OffX=Math.round(dropShadowInPixels);shadowFilter.OffY=Math.round(dropShadowInPixels);shadowFilter.enabled=(dropShadowDepth>0);}else{if(dropShadowDepth==0){return ;}var filterText=obj.style.filter;var fromRules=false;if(filterText==null||filterText.length==0){filterText=that.getFilter(obj);if(filterText!=null&&filterText.length>0){fromRules=true;}}var shadowDefinition=" progid:DXImageTransform.Microsoft.dropshadow(Color='#66000000', Positive='true', OffX="+dropShadowInPixels+", OffY="+dropShadowInPixels+") ";if(fromRules){that.objSheet.styleRules[that.getId(obj)].style.filter+=shadowDefinition;}else{obj.style.filter+=shadowDefinition;if(mstr.utils.ISIE4){window.setTimeout(function(){obj.style.visibility="visible";},100);}}}}else{var rotation=-parseInt(that.getValue(obj,"TextDirection")||"0",0);that.updateVerticalTextShadow(obj,rotation);}}_applyShadow();};mstrDocStyleImpl.prototype.applyAlpha=function(obj,prop,value){var alphaEffect=0;var alphaOpacity=3;switch(prop){case"alphaOpacity":alphaEffect=parseInt(this.getValue(obj,"alphaEffect"));alphaOpacity=parseInt(value);break;case"alphaEffect":alphaOpacity=parseInt(this.getValue(obj,"alphaOpacity"));alphaEffect=parseInt(value);break;}if(bIsDXIE){var alphaFilter=this.getFilter(obj,"Alpha");if(alphaEffect==0){alphaOpacity=0;}if(alphaFilter){alphaFilter.opacity=alphaOpacity;alphaFilter.enabled=(alphaOpacity>0);}else{var filterText=obj.style.filter;var fromRules=false;if(filterText==null||filterText.length==0){filterText=this.getFilter(obj);if(filterText!=null&&filterText.length>0){fromRules=true;}}var alphaDefinition=" progid:DXImageTransform.Microsoft.Alpha(Transparency="+alphaOpacity+") ";if(fromRules){this.objSheet.styleRules[this.getId(obj)].style.filter+=alphaDefinition;}else{obj.style.filter+=alphaDefinition;}}}};mstrDocStyleImpl.prototype.getFilter=function(elem,name){try{if(name=="Gradient"&&elem.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION&&elem.getAttribute("scriptclass")!="mstrPanel"){var gradientBack=elem.previousSibling;if(gradientBack&&gradientBack.id==(elem.id+gradientUtil.GRADIENT_POSTFIX)){elem=gradientBack;}}var filterText=elem.currentStyle?elem.currentStyle.filter:elem.style.filter;if(filterText==null||filterText.length==0){var id=this.getId(elem);if(!isNaN(id)){filterText=this.objSheet.styleRules[id].style.filter;}}if(!name){return filterText;}var filter=null;if(filterText.length>0){filter=elem.filters["DXImageTransform.Microsoft."+name];}return filter;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocStyleImpl.prototype.cascadeSelectorValue=function(obj,prop,value){var controlBone=microstrategy.bone(obj.getAttribute("id")+"_Ctl");if(controlBone){controlBone.cascadeFormatting(obj,prop,value);}if(controlBone&&controlBone.ctlStyle==mstrRWControlImpl.CTL_STYLE_LIST_BOX&&prop.indexOf("textDecoration")==0&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){obj.style[prop]="none";controlBone[prop]=value;}else{obj.style[prop]=value;}};mstrDocStyleImpl.prototype.getAttValue=function(obj,att,formatType){try{if(!obj||!this.formattingAttributes){return null;}if(formatType&&formatType!=microstrategy.FORMAT_TYPE_MAIN){var bone=mstrStaticDoc.getBone(obj);if(bone&&bone.getAttValue){return bone.getAttValue(formatType,att);}}var o=this.formattingAttributes[obj.getAttribute("id")];if(o!=null&&typeof (o[att])!="undefined"){return o[att];}return obj.getAttribute(att,0);}catch(err){microstrategy.errors.log(err);return null;}};mstrDocStyleImpl.prototype.setAttValue=function(obj,att,value){try{if(microstrategy.formatType!=microstrategy.FORMAT_TYPE_MAIN){var bone=mstrStaticDoc.getBone(obj);if(bone&&bone.setAttValue){return bone.setAttValue(microstrategy.formatType,att,value);}}var id=obj.getAttribute("id");var o=this.formattingAttributes[id];if(typeof (o)=="undefined"){this.formattingAttributes[id]={};this.formattingAttributes[id][att]=value;}else{o[att]=value;}}catch(err){microstrategy.errors.log(err);}return null;};mstrDocStyleImpl.prototype.cloneAttValues=function(source,target){try{var sourceAtts=this.formattingAttributes[source.getAttribute("id")];if(typeof (sourceAtts)=="undefined"){return ;}var id=target.getAttribute("id");var targetAtts=this.formattingAttributes[id];if(typeof (targetAtts)=="undefined"){this.formattingAttributes[id]={};targetAtts=this.formattingAttributes[id];}for(var a in sourceAtts){if(a==microstrategy.HTMLATTR_LOCKED){targetAtts[a]=false;}else{targetAtts[a]=sourceAtts[a];}}}catch(err){microstrategy.errors.log(err);}};mstrDocStyleImpl.prototype.getInnerHeight=function(obj){try{var h=this.getValue(obj,"height");if(isNaN(parseInt(h))||h.indexOf("%")>-1){var format=mstrFormatObject;var paddingTop=parseInt(this.getValue(obj,"paddingTop"));var paddingBottom=parseInt(this.getValue(obj,"paddingBottom"));paddingTop=(isNaN(paddingTop))?0:paddingTop;paddingBottom=(isNaN(paddingBottom))?0:paddingBottom;var innerH;if(!this.getValue(obj,"TextDirection")||this.getValue(obj,"TextDirection")=="0"){innerH=getObjInnerHeight(obj);}else{innerH=getObjInnerWidth(obj);}h=innerH-format.getPxFromPt(paddingTop+paddingBottom);}return Math.max(parseInt(h),1);}catch(err){microstrategy.errors.log(err);return false;}};mstrDocStyleImpl.prototype.getInnerWidth=function(obj){try{var w=this.getValue(obj,"width");if(isNaN(parseInt(w))||w.indexOf("%")>-1){var format=mstrFormatObject;var paddingLeft=parseInt(this.getValue(obj,"paddingLeft"));var paddingRight=parseInt(this.getValue(obj,"paddingRight"));paddingLeft=(isNaN(paddingLeft))?0:paddingLeft;paddingRight=(isNaN(paddingRight))?0:paddingRight;var innerW;if(!this.getValue(obj,"TextDirection")||this.getValue(obj,"TextDirection")=="0"){innerW=getObjInnerWidth(obj);}else{innerW=getObjInnerHeight(obj);}w=innerW-format.getPxFromPt(paddingLeft+paddingRight);}return Math.max(parseInt(w),1);}catch(err){microstrategy.errors.log(err);return false;}};mstrDocStyleImpl.prototype.getCssText=function(obj){try{var __return="";var id=this.getId(obj);if(isNaN(id)){return obj.style.cssText;}else{if(this.objSheet.styleRules[id]){__return+=this.objSheet.styleRules[id].style.cssText+"; ";}__return+=obj.style.cssText;}return __return;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocStyleImpl.prototype.resolveStyles=function(obj,prop){try{if(prop.indexOf("line")===0){if(obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)===microstrategy.SUBOBJTYPE_DOC_LINE){var side=(parseInt(this.getAttValue(obj,microstrategy.HTMLATTR_ORIENTATION))===microstrategy.ORIENTATION_HORIZONTAL)?"Top":"Left";if(prop==="lineColor"){prop="border"+side+"Color";}else{if(prop==="lineStyle"){prop="border"+side+"Style";}else{if(prop==="lineWeight"){prop="border"+side+"Width";}}}}else{if(prop==="lineColor"){prop="borderTopColor";}else{if(prop==="lineColor2"){prop="borderBottomColor";}else{if(prop==="lineStyle"){prop="borderStyle";}else{if(prop==="lineWeight"){prop="borderWidth";}}}}}}else{if(prop==="textDecoration2"){prop="textDecoration";}}return prop;}catch(err){microstrategy.errors.log(err);return null;}};mstrDocStyleImpl.prototype.getId=function(obj){try{return parseInt(this.getAttValue(obj,mstrDocStyleImpl.HTMLATTR_CLASS_ID));}catch(err){microstrategy.errors.log(err);return null;}};mstrDocStyleImpl.prototype.adjustSizes=function(styleProp,newValue,defFmt,item){try{newValue=String(newValue);if(newValue=="100%"||newValue=="auto"){return newValue;}return Math.max(Math.round(parseFloat(newValue)-microstrategy.getPaddingAndBorderPixels(item,styleProp,defFmt)),0);}catch(err){microstrategy.errors.log(err);return newValue;}};function mstrDocStyleImpl(attrs){this.formattingAttributes=attrs;return this;}
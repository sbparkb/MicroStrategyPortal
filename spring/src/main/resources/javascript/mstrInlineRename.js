mstrInlineRenameImplScript=true;mstrInlineRenameImpl.prototype=new mstrBoneImpl();mstrInlineRenameImpl.prototype.previousOnMouseDown=null;mstrInlineRenameImpl.prototype.currentRenameField=null;mstrInlineRenameImpl.prototype.originalName=null;mstrInlineRenameImpl.prototype.onload=function(){try{this.initBone();}catch(err){microstrategy.errors.log(err);return false;}};mstrInlineRenameImpl.prototype.onkeydown=function(e){try{if(!e){e=window.event;}if(e.keyCode==13){microstrategy.bone(this.parentBone.id).processRename();if(bIsIE4){window.event.cancelBubble=true;}return false;}}catch(err){microstrategy.errors.log(err);return false;}};mstrInlineRenameImpl.prototype.createRenameFields=function(objectName,objectType,objectId){try{var span=document.createElement("span");span.className="rename";var inputTxt=document.createElement("input");inputTxt.className="mstrInputTextRename";inputTxt.value=objectName;this.originalName=objectName;inputTxt.setAttribute("oTy",objectType);inputTxt.setAttribute("oId",objectId);inputTxt.setAttribute("cx","");inputTxt.setAttribute("type","text");inputTxt.onkeydown=new Function("e","return microstrategy.bone('"+this.parentBone.id+"').inlineRenameObject.onkeydown(e);");span.appendChild(inputTxt);this.currentRenameField=inputTxt;var apply=document.createElement("img");span.appendChild(apply);apply.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";apply.className="mstrIcon-ls mstrIconApply";apply.onclick=new Function("e","return microstrategy.bone('"+this.parentBone.id+"').processRename();");apply.setAttribute("rmApply","1");apply.setAttribute("title",microstrategy.descriptors.getDescriptor("134"));var cancel=document.createElement("img");span.appendChild(cancel);cancel.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";cancel.className="mstrIcon-ls mstrIconCancel";cancel.onclick=new Function("e","return microstrategy.bone('"+this.parentBone.id+"').cancelRename();");cancel.setAttribute("title",microstrategy.descriptors.getDescriptor("221"));return span;}catch(err){microstrategy.errors.log(err);return null;}};mstrInlineRenameImpl.prototype.handleMouseDown=function(e){try{if(!e){e=window.event;}var oTarget=getEventTarget(e);if(oTarget==this.currentRenameField||oTarget.getAttribute("rmApply")=="1"){return true;}else{this.parentBone.cancelRename();}}catch(err){microstrategy.errors.log(err);return false;}};mstrInlineRenameImpl.prototype.processRename=function(beanPath){try{var input=this.currentRenameField;var oId=input.getAttribute("oId");var oType=input.getAttribute("oTy");var oName=trim(input.value);if((oType!=microstrategy.DSSTYPE_SHORTCUT&&oName.length==0)||oName==this.originalName){this.cancelRename();return ;}var nameTag=this.parentBone.getNameTag();var renameTag=nameTag.lastChild;var ac=new Array();ac.push(microstrategy.updateManager.createActionObject(this.parentBone,mstrUpdateManager.RENAME_OBJECT,beanPath,["1001","1002","1004"],[oId,oType,oName]));microstrategy.updateManager.add(ac);this.cancelRename();var mainTag=this.parentBone.getNameTag();var nameTag=(mainTag.lastChild!=null)?mainTag.lastChild:mainTag;if(typeof (nameTag.innerText)!="undefined"){nameTag.innerText=oName;}else{nameTag.textContent=oName;}microstrategy.updateManager.flushAndSubmitChanges();}catch(err){microstrategy.errors.log(err);return false;}};mstrInlineRenameImpl.prototype.cancelRename=function(){try{document.onmousedown=this.previousOnMouseDown;var nameTag=this.parentBone.getNameTag();nameTag.removeChild(nameTag.lastChild);displayObj(nameTag.lastChild);if(nameTag.lastChild.style.display){nameTag.lastChild.style.display="";}}catch(err){microstrategy.errors.log(err);return false;}};mstrInlineRenameImpl.prototype.enableRenameField=function(objectType,objectId){try{var nameTag=this.parentBone.getNameTag();var objName=null;if(typeof (nameTag.innerText)!="undefined"){objName=nameTag.innerText;}else{objName=nameTag.textContent;}var renameTag=this.createRenameFields(objName,objectType,objectId);if(renameTag!=null){removeObj(nameTag.lastChild);nameTag.appendChild(renameTag);var input=this.currentRenameField;if(input){input.focus();}this.previousOnMouseDown=document.onmousedown;document.onmousedown=new Function("e","return microstrategy.bone('"+this.parentBone.id+"').inlineRenameObject.handleMouseDown(e);");}}catch(err){microstrategy.errors.log(err);return false;}};function mstrInlineRenameImpl(id){this.inherits=mstrBoneImpl;this.inherits(id);delete this.inherits;return this;}
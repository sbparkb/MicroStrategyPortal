mstrPromptQuestionsTabImplScript=true;mstrPromptQuestionsTabImpl.prototype=new mstrPromptDefTabImpl();mstrPromptQuestionsTabImpl.prototype.customFormsOption=null;mstrPromptQuestionsTabImpl.prototype.onload=function(){try{mstrPromptDefTabImpl.prototype.onload.call(this);var elemList=getObj("ep_elem_pre_list");if(elemList){elemList.onchange=new Function("e","return microstrategy.bone('"+this.id+"').elemListChange(e);");}var addButton=getObj("ep_add_elem");if(addButton){addButton.onclick=new Function("e","return microstrategy.bone('"+this.id+"').addButtonClick(e);");}var removeButton=getObj("ep_remove_elem");if(removeButton){removeButton.onclick=new Function("e","return microstrategy.bone('"+this.id+"').removeButtonClick(e);");}var clearButton=getObj("ep_clear_elem");if(clearButton){clearButton.onclick=new Function("e","return microstrategy.bone('"+this.id+"').clearButtonClick(e);");}var setTab=function(fldId){var fld=getObj(fldId);if(fld){fld.setAttribute("tab","2");}};setTab("vp_num_min_value");setTab("vp_num_max_value");setTab("vp_d_min_value");setTab("vp_d_max_value");setTab("vp_text_min_value");setTab("vp_text_max_value");setTab("vp_bigdec_min_value");setTab("vp_bigdec_max_value");this.refreshButtonStates();}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.validateInputs=function(){try{var radiobuttons=microstrategy.findChildrenWithAtt(this.elem,"input","type","radio");if(radiobuttons){for(var i=0;i<radiobuttons.length;i++){if(radiobuttons[i].checked){return true;}}}showMessage({contents:microstrategy.descriptors.getDescriptor("5721"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.refreshButtonsForList=function(list,buttons){var upButton=buttons&&buttons.up&&getObj(buttons.up);var downButton=buttons&&buttons.down&&getObj(buttons.down);var removeButton=buttons&&buttons.remove&&getObj(buttons.remove);var removeAllButton=buttons&&buttons.removeAll&&getObj(buttons.removeAll);var sCount=this.selectedCount(list);if(sCount==0){this.disableButton(upButton);this.disableButton(downButton);this.disableButton(removeButton);}else{if(sCount==1){if(list.selectedIndex==0){this.disableButton(upButton);}else{this.enableButton(upButton);}if(list.selectedIndex==list.length-1){this.disableButton(downButton);}else{this.enableButton(downButton);}this.enableButton(removeButton);}else{this.disableButton(upButton);this.disableButton(downButton);this.enableButton(removeButton);}}var listObj=getObj(list);if(listObj&&listObj.options&&listObj.options.length>0){this.enableButton(removeAllButton);}else{this.disableButton(removeAllButton);}};mstrPromptQuestionsTabImpl.prototype.disableButton=function(button){if(button){button.className=this.getEnabledDisabledStyleName(button.className,true);button.disabled=true;}};mstrPromptQuestionsTabImpl.prototype.enableButton=function(button){if(button){button.className=this.getEnabledDisabledStyleName(button.className,false);button.disabled=false;}};mstrPromptQuestionsTabImpl.prototype.getEnabledDisabledStyleName=function(orgName,disable){if(orgName){if(disable&&!/Disabled$/.test(orgName)){orgName=orgName+"Disabled";}else{if(!disable&&/Disabled$/.test(orgName)){orgName=orgName.replace(/Disabled$/,"");}}}return orgName;};mstrPromptQuestionsTabImpl.prototype.updatePTypeRadioButton=function(obj){try{mstrPromptDefTabImpl.prototype.updateRadioButton.call(this,obj);var minMax=mstrPromptDefTabImpl.prototype.VPNum;switch(obj.id){case"vp_type_Date":minMax=mstrPromptDefTabImpl.prototype.VPDate;break;case"vp_type_Num":minMax=mstrPromptDefTabImpl.prototype.VPNum;break;case"vp_type_Text":minMax=mstrPromptDefTabImpl.prototype.VPText;break;case"vp_type_BigDec":minMax=mstrPromptDefTabImpl.prototype.VPBigDec;break;default:mixMax=mstrPromptDefTabImpl.prototype.VPNum;}microstrategy.bone("tabPromptDispId").switchVPMinMaxSection(minMax);microstrategy.bone("tabPromptDispId").updateTitleAndDesc();microstrategy.bone("tabPromptStyleId").showShowTimePickerDiv();microstrategy.bone("tabPromptStyleId").showShowNumericProps();microstrategy.bone("tabPromptStyleId").updateStyleValue();}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.filterButtonClick=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);this.tabManager.processValidation=true;if(this.tabManager.onmenusubmitform()){this.execImmediately(obj);}}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.clearButtonClick=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);this.removeAllItems("ep_elem_pre_list");this.refreshButtonStates();}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.removeButtonClick=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);this.removeItems("ep_elem_pre_list");this.refreshButtonStates();}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.addButtonClick=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);this.updateCheckByName("ep_elem_restriction_pre",true);var msg=this.tabManager.validateAttributeForAEPrompt(getObj(this.tabManager.attributeFieldID),"");if(msg!=null&&msg.length>0){showMessage({contents:msg,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}else{this.tabManager.applyPropertyChanges("processCommands",false);this.execImmediately(obj);}}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.attrButtonClick=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);this.tabManager.processValidation=false;if(this.tabManager.onmenusubmitform()){this.execImmediately(obj);}}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.elemListChange=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);this.refreshEPPredefinedListButtons(obj);this.updateList(obj);this.updateCheckByName("ep_elem_restriction_pre",true);}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.updateRadioButton=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);mstrPromptDefTabImpl.prototype.updateRadioButton.call(this,obj);this.refreshButtonStates();}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.refreshEPPredefinedListButtons=function(list){this.refreshButtonsForList(list,{remove:"ep_remove_elem",removeAll:"ep_clear_elem"});getObj("ep_add_elem").disabled=false;};mstrPromptQuestionsTabImpl.prototype.onClickExpPredefinedList=function(list){this.refreshExpPredefinedListButtons(list);};mstrPromptQuestionsTabImpl.prototype.refreshExpPredefinedListButtons=function(list){this.refreshButtonsForList(list,{remove:"exp_remove_elem",removeAll:"exp_clear_elem"});getObj("exp_add_elem").disabled=false;};mstrPromptQuestionsTabImpl.prototype.moveUpOPItem=function(list){mstrPromptDefTabImpl.prototype.moveUpItem.call(this,list);this.refreshOPButtonStates();this.updateList(getObj(list));};mstrPromptQuestionsTabImpl.prototype.moveDownOPItem=function(list){mstrPromptDefTabImpl.prototype.moveDownItem.call(this,list);this.refreshOPButtonStates();this.updateList(getObj(list));};mstrPromptQuestionsTabImpl.prototype.onClickOPPredefinedList=function(list){this.refreshOPPredefinedListButtons(list);};mstrPromptQuestionsTabImpl.prototype.refreshOPPredefinedListButtons=function(list){this.refreshButtonsForList(list,{up:"op_up_elem",down:"op_down_elem",remove:"op_remove_elem",removeAll:"op_clear_elem"});getObj("op_add_elem").disabled=false;};mstrPromptQuestionsTabImpl.prototype.selectedCount=function(fromList){var sCount=0;if(fromList!=null){var fromListObj=getObj(fromList);for(i=fromListObj.options.length-1;i>=0;i--){var option=fromListObj.options[i];if(option.selected){sCount++;}}}return sCount;};mstrPromptQuestionsTabImpl.prototype.initSettings=function(){try{var at=this.getAppliesTo();this.promptEditorType=at.webPromptType;if(at.webPromptType==mstrPromptDefImpl.CONSTANT_PROMPT){this.getQuestionConstantSettings();}else{if(at.webPromptType==mstrPromptDefImpl.OBJECTS_PROMPT){this.getQuestionObjectSettings();}else{if(at.webPromptType==mstrPromptDefImpl.ELEMENTS_PROMPT){this.getQuestionElementSettings();}else{if(at.webPromptType==mstrPromptDefImpl.EXPRESSION_PROMPT){this.getQuestionExpressionSettings();}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.getQuestionConstantSettings=function(){var props=new Array("vp_type_Date","vp_type_Num","vp_type_Text","vp_type_BigDec");this.settings=this.getSettings(props);var dateSubSettingsValue=this.getSettings(new Array("vp_d_hasDefault","vp_d_default","vp_d_min_check","vp_d_min_value","vp_d_max_check","vp_d_max_value"));var dateSubSettings=new Object();dateSubSettings.condition="1";dateSubSettings.settings=dateSubSettingsValue;var numSubSettingsValue=this.getSettings(new Array("vp_num_hasDefault","vp_num_default","vp_num_min_check","vp_num_min_value","vp_num_max_check","vp_num_max_value"));var numSubSettings=new Object();numSubSettings.condition="1";numSubSettings.settings=numSubSettingsValue;var textSubSettingsValue=this.getSettings(new Array("vp_text_hasDefault","vp_text_default","vp_text_min_check","vp_text_min_value","vp_text_max_check","vp_text_max_value"));var textSubSettings=new Object();textSubSettings.condition="1";textSubSettings.settings=textSubSettingsValue;var bigdecSubSettingsValue=this.getSettings(new Array("vp_bigdec_hasDefault","vp_bigdec_default","vp_bigdec_min_check","vp_bigdec_min_value","vp_bigdec_max_check","vp_bigdec_max_value"));var bigdecSubSettings=new Object();bigdecSubSettings.condition="1";bigdecSubSettings.settings=bigdecSubSettingsValue;for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute("id");if(aSetting.subSettings==null){aSetting.subSettings=new Array();}if(settingName=="vp_type_Date"){aSetting.subSettings[0]=dateSubSettings;}else{if(settingName=="vp_type_Num"){aSetting.subSettings[0]=numSubSettings;}else{if(settingName=="vp_type_Text"){aSetting.subSettings[0]=textSubSettings;}else{if(settingName=="vp_type_BigDec"){aSetting.subSettings[0]=bigdecSubSettings;}}}}}};mstrPromptQuestionsTabImpl.prototype.getQuestionObjectSettings=function(){var props=new Array("opPredefined","opSearch");this.settings=this.getSettings(props);var preSettingsValues=this.getSettings(new Array("op_elem_pre_list"));var preSettings=new Object();preSettings.condition="1";preSettings.settings=preSettingsValues;var searchSettingsValues=this.getSettings(new Array("op_search_value"));var searchSettings=new Object();searchSettings.condition="1";searchSettings.settings=searchSettingsValues;for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute("id");if(aSetting.subSettings==null){aSetting.subSettings=new Array();}if(settingName=="opPredefined"){aSetting.subSettings[0]=preSettings;}else{if(settingName=="opSearch"){aSetting.subSettings[0]=searchSettings;}}}};mstrPromptQuestionsTabImpl.prototype.getQuestionElementSettings=function(){var props=new Array("ep_att_name","ep_elem_restriction_all","ep_elem_restriction_pre","ep_elem_restriction_filter");this.settings=this.getSettings(props);var preSettingsValues=this.getSettings(new Array("ep_elem_pre_list"));var preSettings=new Object();preSettings.condition="1";preSettings.settings=preSettingsValues;var searchSettingsValues=this.getSettings(new Array("ep_filter_name"));var searchSettings=new Object();searchSettings.condition="1";searchSettings.settings=searchSettingsValues;for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute("id");if(aSetting.subSettings==null){aSetting.subSettings=new Array();}if(settingName=="ep_elem_restriction_pre"){aSetting.subSettings[0]=preSettings;}else{if(settingName=="ep_elem_restriction_filter"){aSetting.subSettings[0]=searchSettings;}}}};mstrPromptQuestionsTabImpl.prototype.getQuestionExpressionSettings=function(){var props=new Array("exp_type_all","exp_type_one","exp_type_pre","exp_type_search","exp_disp_att_form","exp_custom_forms");this.settings=this.getSettings(props);var oneSettingsValues=this.getSettings(new Array("exp_org_name"));var oneSettings=new Object();oneSettings.condition="1";oneSettings.settings=oneSettingsValues;var preSettingsValues=this.getSettings(new Array("exp_elem_pre_list"));var preSettings=new Object();preSettings.condition="1";preSettings.settings=preSettingsValues;var searchSettingsValues=this.getSettings(new Array("exp_search_name"));var searchSettings=new Object();searchSettings.condition="1";searchSettings.settings=searchSettingsValues;for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute("id");if(aSetting.subSettings==null){aSetting.subSettings=new Array();}if(settingName=="exp_type_pre"){aSetting.subSettings[0]=preSettings;}else{if(settingName=="exp_type_search"){aSetting.subSettings[0]=searchSettings;}else{if(settingName=="exp_type_one"){aSetting.subSettings[0]=oneSettings;}}}}};mstrPromptQuestionsTabImpl.prototype.refreshButtonStates=function(){this.refreshEPButtonStates();this.refreshOPButtonStates();this.refreshEXPButtonStates();this.refreshPButtonCursors();};mstrPromptQuestionsTabImpl.prototype.refreshPButtonCursors=function(){var objInputs=microstrategy.findChildrenWithAtt(this.elem,"input","type","button");if(objInputs==null||objInputs.length==0){return ;}for(var i in objInputs){objInputs[i].style.cursor=(objInputs[i].disabled)?"default":"pointer";}};mstrPromptQuestionsTabImpl.prototype.refreshOPButtonStates=function(){var objs=microstrategy.findChildrenWithAtt(this.elem,"input","name","optype");if(objs==null){return ;}for(var i=0;i<objs.length;i++){try{switch(objs[i].id){case"opPredefined":if(objs[i].checked){var fromListObj=getElementById("op_elem_pre_list");fromListObj.disabled=false;this.refreshOPPredefinedListButtons(fromListObj);}else{getObj("op_up_elem").className="mstrIcon-btn mstrIcon-btnArrowUpDisabled";getObj("op_down_elem").className="mstrIcon-btn mstrIcon-btnArrowDownDisabled";getObj("op_add_elem").disabled=true;getObj("op_remove_elem").disabled=true;getObj("op_clear_elem").disabled=true;getElementById("op_elem_pre_list").disabled=true;}break;case"opSearch":if(objs[i].checked){getElementById("op_search_selector").disabled=false;}else{getElementById("op_search_selector").disabled=true;getElementById("op_search_value").value="";}break;default:break;}}catch(err){microstrategy.errors.log(err);return false;}}};mstrPromptQuestionsTabImpl.prototype.refreshEPButtonStates=function(){var objs=microstrategy.findChildrenWithAtt(this.elem,"input","name","ep_elem_restriction");if(objs==null||objs.length==0){return ;}var enableElements=getElementById("ep_att_name").value;for(var i in objs){objs[i].disabled=enableElements?false:true;}for(var i=0;i<objs.length;i++){try{switch(objs[i].id){case"ep_elem_restriction_pre":if(objs[i].checked&&!objs[i].disabled){var fromListObj=getElementById("ep_elem_pre_list");fromListObj.disabled=false;this.refreshEPPredefinedListButtons(fromListObj);}else{this.removeAllItems(getElementById("ep_elem_pre_list"));getElementById("ep_add_elem").disabled=true;getElementById("ep_remove_elem").disabled=true;getElementById("ep_clear_elem").disabled=true;getElementById("ep_elem_pre_list").disabled=true;}break;case"ep_elem_restriction_all":this.setSearchBased(true);var bone=microstrategy.bone("tabPromptStyleId");if(bone){bone.adjustStyleListForOrigin(false);}break;case"ep_elem_restriction_filter":if(objs[i].checked&&!objs[i].disabled){getElementById("ep_filter_selector").disabled=false;}else{getElementById("ep_filter_selector").disabled=true;getElementById("ep_filter_name").value="";}break;default:break;}}catch(err){microstrategy.errors.log(err);return false;}}};mstrPromptQuestionsTabImpl.prototype.refreshEXPButtonStates=function(){var objs=microstrategy.findChildrenWithAtt(this.elem,"input","name","exp_type");if(objs==null){return ;}for(var i=0;i<objs.length;i++){try{switch(objs[i].id){case"exp_type_all":this.setSearchBased(true);break;case"exp_type_one":if(objs[i].checked){getElementById("exp_org_selector").disabled=false;this.renderCustomForms();this.setSearchBased(false);}else{getElementById("exp_org_name").value="";getElementById("exp_org_selector").disabled=true;this.renderCustomForms();}break;case"exp_type_pre":if(objs[i].checked){var fromListObj=getElementById("exp_elem_pre_list");fromListObj.disabled=false;this.refreshExpPredefinedListButtons(fromListObj);this.setSearchBased(false);}else{getElementById("exp_add_elem").disabled=true;getElementById("exp_remove_elem").disabled=true;getElementById("exp_clear_elem").disabled=true;getElementById("exp_elem_pre_list").disabled=true;}break;case"exp_type_search":if(objs[i].checked){getElementById("exp_search_selector").disabled=false;this.setSearchBased(true);}else{getElementById("exp_search_name").value="";getElementById("exp_search_selector").disabled=true;}break;default:break;}}catch(err){microstrategy.errors.log(err);return false;}}};mstrPromptQuestionsTabImpl.prototype.updateAttributeFormsList=function(list){this.updateList(list);if(list.selectedIndex>-1){var at=this.getAppliesTo();var sel=list.options[list.selectedIndex];if(sel.value=="-1"){at.customForms=true;}else{at.customForms=false;}this.renderCustomForms();}};mstrPromptQuestionsTabImpl.prototype.renderCustomForms=function(){var cfDiv=getElementById("customFormsDiv");if(cfDiv==null){return ;}if(!this.isAQ()){return ;}if(this.singleOriginSelected()){if(this.havingCustomForms()){cfDiv.style.display="block";this.refreshAQCFButtons(getObj("exp_all_att_forms"),getObj("exp_custom_forms"));}else{cfDiv.style.display="none";}if(this.customFormsOption){var attFormList=getObj("exp_disp_att_form");if(attFormList){if(this.havingCustomForms()){attFormList.options[attFormList.length]=new Option(this.customFormsOption.text,this.customFormsOption.value,this.customFormsOption.defaultSelected,true);}else{attFormList.options[attFormList.length]=new Option(this.customFormsOption.text,this.customFormsOption.value,this.customFormsOption.defaultSelected,false);}}this.customFormsOption=null;}}else{cfDiv.style.display="none";var attFormList=getObj("exp_disp_att_form");if(attFormList){if(!this.customFormsOption){this.customFormsOption=attFormList.options[attFormList.length-1];attFormList.remove(attFormList.length-1);}if(attFormList.length&&attFormList.selectedIndex==-1){attFormList.options[0].selected=true;}}}};mstrPromptQuestionsTabImpl.prototype.singleOriginSelected=function(){var objs=microstrategy.findChildrenWithAtt(this.elem,"input","name","exp_type");if(objs==null){return false;}for(var i=0;i<objs.length;i++){if(objs[i].id=="exp_type_one"){return objs[i].checked;}}return false;};mstrPromptQuestionsTabImpl.prototype.havingCustomForms=function(){try{var orgInput=document.getElementById("exp_org_name");var at=this.getAppliesTo();return at&&at.customForms&&orgInput&&orgInput.value;}catch(err){microstrategy.errors.log(err);return false;}};mstrPromptQuestionsTabImpl.prototype.onClickAQCFAvailList=function(list){this.refreshAQCFAvailButtons(list);};mstrPromptQuestionsTabImpl.prototype.onClickAQCFSelList=function(list){this.refreshAQCFSelButtons(list);};mstrPromptQuestionsTabImpl.prototype.refreshAQCFButtons=function(availList,selList){this.refreshAQCFAvailButtons(availList);this.refreshAQCFSelButtons(selList);};mstrPromptQuestionsTabImpl.prototype.refreshAQCFAvailButtons=function(list){this.refreshButtonsForList(list,{remove:"exp_add_cf",removeAll:"exp_addall_cf"});};mstrPromptQuestionsTabImpl.prototype.refreshAQCFSelButtons=function(list){this.refreshButtonsForList(list,{up:"exp_up_cf",down:"exp_down_cf",remove:"exp_remove_cf",removeAll:"exp_removeall_cf"});};mstrPromptQuestionsTabImpl.prototype.isDatePrompt=function(){if(this.getPromptType()==mstrPromptDefImpl.CONSTANT_PROMPT){var objs=microstrategy.findChildrenWithAtt(this.elem,"input","name","vptype");if(objs==null){return false;}for(var i=0;i<objs.length;i++){if(objs[i].id=="vp_type_Date"){return objs[i].checked;}}}return false;};mstrPromptQuestionsTabImpl.prototype.execCommand=function(id,value){mstrPromptDefTabImpl.prototype.execCommand.call(this,id,value);switch(id){case"SET_EP_ATTR":if(this.getPromptType()==mstrPromptDefImpl.ELEMENTS_PROMPT){microstrategy.bone("tabPromptStyleId").updateElementAttributes();}}};function mstrPromptQuestionsTabImpl(id){this.inherits=mstrPromptDefTabImpl;this.inherits(id);this.inherits=null;return this;}
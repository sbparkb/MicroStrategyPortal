mstrDocCommandsImpl.prototype=new Object();mstrDocCommandsImpl.prototype.qeMap={Name:"name",ToolTip:"title",Link:"link",IsLink:"isLink",NewWin:"newWin",Visible:"visibility",VisibleHTML:"showInHTMLViewMode",LineOrientation:"orientation",Source:"src",Locked:"locked",Left:"left",Top:"top",Wmode:"widthMode",Hmode:"heightMode",Width:"width",Height:"height",LockAspectRatio:"lockAspectRatio",Length:"length",Lmode:"lengthMode",borderStyle:"borderTopStyle",IsPortal:"showTitleBar",PortalState:"windowState",PortalTitle:"windowTitle",TitleBarDisplay:"titleBarDisplay",ExportOptions:"exportOptions",HasDropShadow:"dropShadowEffect",DropShadow:"dropShadowDepth",HasRoundedCorners:"hasRoundedCorners",TopCornersOnly:"topCornersOnly",HasAlpha:"alphaEffect",HTMLType:"htmlType",IFrameSource:"url",ShowElementCount:"showElementCount",InformationWindowTarget:"InformationWindowTarget"};mstrDocCommandsImpl.prototype.rwObjNameMap={"106":"3575","102":"3576","105":"3577","101":"3196","52":"3702","111":"4728","8":"4780","107":"4538"};mstrDocCommandsImpl.prototype.exec=function(cmdId,cmdValue,allPanels){try{var targetGrid=null;var targetPanelStack=null;var oGrid=null;var oPanelStack=null;if(this.parentBone.selections&&this.parentBone.selections.isOnlyOneGridSelected()){oGrid=this.parentBone.selections.getSelectedGrid();targetGrid=microstrategy.findBone(oGrid);if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(cmdId)){var gb=(targetGrid instanceof mstrReportGraphImpl)?targetGrid:microstrategy.bone(targetGrid.id+"_graph");return gb&&gb.commands.exec(cmdId,cmdValue);}}if(this.parentBone.selections&&this.parentBone.selections.isOnlyOnePanelStackSelected()){oPanelStack=this.parentBone.selections.getSelectedPanelStack();targetPanelStack=microstrategy.findBone(oPanelStack);}var match=cmdId&&cmdId.match(/currentControl;|widget;|autotext;|addToPanel;|waddToPanel;/);if(match&&match.index==0){var regex=new RegExp(match[0],"g"),value=cmdId.replace(regex,"");value=(match[0]=="widget;"||match[0]=="waddToPanel;")?"113|"+value:value;var rcmd=match[0].replace(";","").replace("waddToPanel","addToPanel");rcmd=match[0]=="widget;"?"currentControl":rcmd;return this.exec(rcmd,value);}var fnShowMessageAdd=function(fok,fcancel){showMessage({contents:microstrategy.descriptors.getDescriptor("8498"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:fok,buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("219"),Cancel:microstrategy.descriptors.getDescriptor("218")},cancelEval:fcancel,type:mstrMsgBoxImpl.MSG_PREF_WARNING});};switch(cmdId){case"setControlQualType":var ctl=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());ctl.setQualType(cmdValue);break;case"controlInclude":var ctl=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());ctl.setInclude(cmdValue);break;case"sct":this.parentBone.startControlSelectionMode();return false;case"rnp":var panelStack=microstrategy.findBone(this.queryState("selectedPanelStack"));var bone=microstrategy.bones.msgBox;if(bone){var label=microstrategy.descriptors.getDescriptor("2211");var panelName=this.parentBone.styleObj.getAttValue(panelStack.getCurrentPanel().elem,microstrategy.HTMLATTR_WINDOW_TITLE);var encodePanelName=panelName;if(mstr&&mstr.utils&&mstr.utils.String){encodePanelName=mstr.utils.String.escape4HTMLText(encodePanelName);}bone.initInput(label,panelName,59,256);bone.setButtons(microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,"microstrategy.bone('rwb_viewer').doc.renamePanel()","");bone.setTitle(microstrategy.descriptors.getDescriptor("4815")+" "+encodePanelName);bone.show();}return false;case"cps":var sub=this.queryState("selectedSection");var panelStack=this.parentBone.selections.firstItem();var targetKey="";if(sub!=null&&panelStack){targetKey=panelStack.getAttribute("id");var x=getObjSumLeftScrolled(sub)+5;var y=getObjSumTopScrolled(sub)+5;x=getObjSumLeftScrolled(panelStack)+5;var gridTop=getObjSumTopScrolled(panelStack);if(y<(gridTop-20)){y=gridTop-20;}var ac=new Array();var newItems=new Array();var templateInfo={ctlType:mstrRWControlImpl.CTL_TYPE_PANEL_STACK,ctlSrcId:"",ctlSrcType:"",ctlSrcName:microstrategy.descriptors.getDescriptor("4780"),ctlTargetStr:targetKey,ctlStyle:"0",ctlOrientation:"1"};ac=this.parentBone.addCtrl(new Rect(y,null,null,x),sub,ac,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null,templateInfo,microstrategy.SNAP_OFF);x=x+getObjWidth(sub.lastChild)+10;newItems.push(sub.lastChild);this.parentBone.selections.finishAddAllObjs(newItems,ac,false);var docViewer=this.parentBone.parentBone;docViewer.updateManager.add(ac);if(docViewer.isEditableViewModeEplus()&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){docViewer.updateManager.flushAndSubmitChanges();}}break;case"csc":case"addAsSelector":var unitID=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_ID),unitType=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_TYPE),unitSubtype=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE),ctlStyle="0";if(unitType==microstrategy.DSSTYPE_ATTRIBUTE_FORM){unitType=microstrategy.DSSTYPE_ATTRIBUTE;}if(unitType==microstrategy.DSSTYPE_METRIC||unitType==microstrategy.DSSTYPE_USER_METRIC||unitType==microstrategy.DSSTYPE_USER_SUMMARY_METRIC){ctlStyle="7";}var unitName=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DESCRIPTION);var targetKey="";if(targetGrid){targetKey=this.parentBone.selections.getSelectedGrid().getAttribute("id");}var sub=this.queryState("selectedSection");if(sub!=null){var x=getObjSumLeftScrolled(sub)+5;var y=getObjSumTopScrolled(sub)+5;if(targetKey!=null){x=getObjSumLeftScrolled(this.parentBone.selections.firstItem())+5;var gridTop=getObjSumTopScrolled(this.parentBone.selections.firstItem());if(y<(gridTop-20)){y=gridTop-20;}}var ac=new Array();var newItems=new Array();var templateInfo={ctlType:(unitType=="12"||unitType=="1"||unitType=="47"||unitType=="4"||unitType=="101"||unitType=="100")?"1":"2",ctlSrcId:unitID,ctlSrcType:unitType,ctlSrcSubtype:unitSubtype,ctlSrcName:unitName,ctlTargetStr:targetKey,ctlStyle:ctlStyle,ctlOrientation:"1"};ac=this.parentBone.addCtrl(new Rect(y,null,null,x),sub,ac,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null,templateInfo,microstrategy.SNAP_OFF);if(ac==null){return false;}x=x+getObjWidth(sub.lastChild)+10;newItems.push(sub.lastChild);this.parentBone.selections.finishAddAllObjs(newItems,ac,false);var docViewer=this.parentBone.parentBone;docViewer.updateManager.add(ac);if(docViewer.isEditableViewModeEplus()&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){docViewer.updateManager.flushAndSubmitChanges();}}break;case"setSelectorSource":var controlBone=microstrategy.bone(cmdValue[3].getAttribute("id")+"_Ctl");if(controlBone){var ac=new Array();ac=controlBone.setSource(cmdValue[0],cmdValue[1],cmdValue[2],ac);if(microstrategy.getViewerBone().autoWire&&cmdValue[1]==microstrategy.DSSTYPE_ATTRIBUTE){var subsec=this.parentBone.selections.getSelectedSubsection();if(subsec){subsec.wireTargets(ac,this.parentBone.parentBone.beanPath,false);}}if(ac&&ac.length>0){microstrategy.updateManager.add(ac);}if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&controlBone.isDefinitionComplete()){microstrategy.updateManager.flushAndSubmitChanges();}}break;case"tocFtMgr":case"watermarkFtMgr":var params=cmdValue.split("|");this.parentBone.openDialog(cmdId,"",null,microstrategy.servletName+"."+microstrategy.pageName);this.parentBone.parentBone.updateManager.replaceURL("selectedTabOptions",params[2]);this.parentBone.parentBone.updateManager.flushAndSubmitChanges();break;case"copy":return this.parentBone.selections.copy();case"cut":return this.parentBone.selections.cut();case"paste":return this.parentBone.selections.paste();case"delete":return this.exec("deleteSelections");case"selectAll":return this.parentBone.selections.selectAll();case"RwdUnits":this.parentBone.selections.clear();var obj=document.getElementById(cmdValue);if(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.addSubSection(obj);}else{this.parentBone.selections.add(obj);}break;case"select":this.parentBone.selections.clear();var newValue=cmdValue.split("|");if(newValue[1]==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.addSubSection(document.getElementById(newValue[0]));}else{this.parentBone.selections.add(document.getElementById(newValue[0]));}break;case"select_multiple":var newValue=cmdValue.split("|");if(newValue[1]==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.addSubSection(document.getElementById(newValue[0]));}else{if(this.parentBone.selections.firstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION){this.parentBone.selections.clear();}if(this.parentBone.selections.items[newValue[0]]){this.parentBone.selections.remove(document.getElementById(newValue[0]));}else{this.parentBone.selections.add(document.getElementById(newValue[0]));}}break;case"grid":return this.parentBone.toggleGrid();case"rulers":return this.parentBone.toggleRuler();case"duplicate":return this.parentBone.selections.duplicate();case"currentControl":if(cmdValue.indexOf("|")>-1){var values=cmdValue.split("|");this.parentBone.currentControl=values[0];this.parentBone.currentControlSubtype=values[1];this.parentBone.currentControl_SelectorControlType=(values.length>2)?values[2]:null;}else{this.parentBone.currentControl=cmdValue;this.parentBone.currentControlSubtype=null;}this.parentBone.isInsertMode=(cmdValue!="cursor");this.parentBone.elem.style.cursor=this.parentBone.isInsertMode?"crosshair":"default";this.parentBone.selections.elem.className=this.parentBone.isInsertMode?"":"enabled";if(this.parentBone.parentBone.docViewsSize>1&&!this.parentBone.parentBone.defaultInsertMode){if(this.parentBone.isInsertMode){var fc="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('"+mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID+"'), checked = p && p.checked;";var fok=fc+"rwb.visibleCurOnly=false; if(checked) rwb.updateInsertMode(true);";var fcancel=fc+"rwb.visibleCurOnly=true; if(checked) rwb.updateInsertMode(false);";fnShowMessageAdd(fok,fcancel);}}break;case"addToPanel":if(this.parentBone.parentBone.docViewsSize>1&&!this.parentBone.parentBone.defaultInsertMode){var fc="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('"+mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID+"'), checked = p && p.checked;";var doExec="rwb.commands.exec('doAddToPanel','"+cmdValue+"',"+allPanels+");";var fok=fc+"rwb.visibleCurOnly=false;"+doExec+"if(checked)rwb.updateInsertMode(true);";var fcancel=fc+"rwb.visibleCurOnly=true;"+doExec+"if(checked) rwb.updateInsertMode(false);";fnShowMessageAdd(fok,fcancel);}else{this.exec("doAddToPanel",cmdValue,allPanels);}break;case"doAddToPanel":var values=(cmdValue.indexOf("|")>-1)?cmdValue.split("|"):[cmdValue,null];this.parentBone.currentControl=values[0];this.parentBone.currentControlSubtype=values[1];var panel=this.queryState("selectedContainer");var ac=new Array();var um=microstrategy.updateManager;var ctrlType=this.parentBone.currentControl;this.parentBone.addCtrl(null,panel,ac,null,null,null,true);this.parentBone.selections.finishAddAllObjs(microstrategy.createAssociativeArray(panel.lastChild),ac);this.exec("currentControl","cursor");if(ac.length>0){um.add(ac);if(ctrlType==microstrategy.GRAPH_CTL){um.add([um.createActionObject(this.parentBone.elem,mstrUpdateManager.APPLY_CHANGES,this.parentBone.parentBone.beanPath,[],[],[])]);var id=panel.lastChild.id;var slice=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"":"_0";this.exec("openGraphDropZones",{viewId:id,boneId:"grid_"+id+slice,h:getObjHeight(panel.lastChild),w:getObjWidth(panel.lastChild),sliceIndex:null});}else{if(this.queryState("appliedTheme")||ctrlType==microstrategy.SUBOBJTYPE_DOC_IMAGE){um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);um.flushAndSubmitChanges();}}}break;case"openGraphDropZones":var um=microstrategy.updateManager;um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);var params="activeViewID="+cmdValue.viewId+"&boneID="+cmdValue.boneId+"&zoomFactor="+microstrategy.ZOOM_FACTOR;if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){params+="&graphHeight="+cmdValue.h+"&graphWidth="+cmdValue.w;if(cmdValue.sliceIndex!=null){params+="&sliceIndex="+cmdValue.sliceIndex;}}toggleShowBean("edtGraphDropZones",true,params);break;case"setDocCursor":this.parentBone.elem.style.cursor=cmdValue;break;case"sizeToGrid":return this.parentBone.selections.sizeToGrid();case"AlignLeft":case"AlignCenter":case"AlignRight":case"AlignTop":case"AlignMiddle":case"AlignBottom":if(this.parentBone.selections.alignObjs(cmdId)){this.parentBone.selections.syncUp();}else{return false;}break;case"objalign":if(this.parentBone.selections&&this.parentBone.selections.length>0){var rtn=this.parentBone.selections.alignObjs(cmdValue);if(!rtn){return rtn;}this.parentBone.selections.syncUp();}break;case"objsize":if(this.parentBone.selections&&this.parentBone.selections.length>0){var rtn=this.parentBone.selections.resizeObjs(cmdValue);if(!rtn){return rtn;}this.parentBone.selections.syncUp();}break;case"openFormatGrid":microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",cmdValue||{});break;case"openFormatGraph":case"openFormatControl":var beanName=(cmdId=="openFormatControl")?"ftMgr":"ghftMgr";var src=microstrategy.activeCXMenu;var clickedTitle=false;if(src&&src.clickedElement){if(src.clickedElement.className&&src.clickedElement.className.indexOf("title_")>=0){clickedTitle=true;}var obj=findTarget(src.clickedElement,microstrategy.HTMLATTR_SUBOBJTYPE);if(obj&&obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_CONTAINER_TITLEBAR){clickedTitle=true;}src.clickedElement=null;}if(oGrid){if(cmdId=="openFormatControl"){var actionCollection=new Array();var updateManager=this.parentBone.parentBone.updateManager;actionCollection.push(updateManager.createActionObject(oGrid,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.parentBone.parentBone.gridBP["72001"],["72001","72002"],["0,-9",(clickedTitle)?"9":"8"]));updateManager.add(actionCollection,true);}var id=oGrid.getAttribute("id");toggleShowBean(beanName,true,"activeViewID="+id+"&selectedTypes="+this.parentBone.selections.getTypes());}else{if(oPanelStack){var actionCollection=new Array();var updateManager=this.parentBone.parentBone.updateManager;actionCollection.push(updateManager.createActionObject(oPanelStack,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.parentBone.parentBone.gridBP["72001"],["72003","72002"],["0",(clickedTitle)?"1":"0"]));updateManager.add(actionCollection,true);var id=oPanelStack.getAttribute("id");toggleShowBean(beanName,true,"activeViewID="+id+"&selectedTypes="+this.parentBone.selections.getTypes());}else{toggleShowBean("ftMgr",true,"selectedTypes="+this.parentBone.selections.getTypes());}}break;case"openBasicConditionalFormatting":case"openSimpleThresholdEditor":case"openAdvConditionalFormatting":case"openAdvThresholdEditor":case"openBasicCondtFmtForHiddenSec":case"openAdvCondtFmtForHiddenSec":var toggleBeanId=null;var containerId=null;if(cmdId=="openBasicConditionalFormatting"||cmdId=="openSimpleThresholdEditor"||cmdId=="openBasicCondtFmtForHiddenSec"){toggleBeanId="edtSimpleThresholds";}else{if(cmdId=="openAdvConditionalFormatting"||cmdId=="openAdvThresholdEditor"||cmdId=="openAdvCondtFmtForHiddenSec"){toggleBeanId="edtAdvancedThresholds";}}if(cmdId=="openBasicCondtFmtForHiddenSec"||cmdId=="openAdvCondtFmtForHiddenSec"){containerId=microstrategy.getViewerBone().documentStructureTreeBone.selectedHiddenSection;}else{containerId=this.parentBone.selections.firstItem().getAttribute("id");}var args="";if(oGrid){args+="activeViewID="+oGrid.getAttribute("id");args+="&container="+oGrid.getAttribute("id");}else{args+="container="+containerId;args+="&activeViewID=";}toggleShowBean(toggleBeanId,true,args);break;case"openFormatDMetric":var userMetricKey=cmdValue[0].getAttribute("key");var dataSetID=cmdValue[0].getAttribute("dsId");toggleShowBean("ftMgr",true,"selectedTypes=obj."+microstrategy.DSSTYPE_USER_METRIC+"&dataSetID="+dataSetID+"&userMetricKey="+userMetricKey);break;case"openSelectDatasetEditor":microstrategy.openFolderBasedBlockEditor("addDatasetEditor","AddDatasetBlockLoader",null,null,null,this.parentBone);break;case"openReplaceDataSetEditor":modelProps=(cmdValue)?{oldDSID:cmdValue,oldDSType:microstrategy.DSSTYPE_RPT_DEFINITION}:{oldDSID:"",ReplaceAllDS:true};viewProps={multiSelect:false};microstrategy.openFolderBasedBlockEditor("replaceDatasetEditor","AddDatasetBlockLoader",null,modelProps,viewProps,this.parentBone);break;case"formatUserMetric":this.parentBone.applyUserMetricFormat(cmdValue);break;case"edtRename":var activeElemIndx=1;var mode=1;var dSetId="";var activeViewID=null;var activeUserMetricId=null;if(targetGrid&&targetGrid.dSetId&&targetGrid.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE)){dSetId=targetGrid.dSetId;if(oGrid){activeViewID=oGrid.getAttribute("id");mode=0;}}else{mode=1;var oObjBrowser=microstrategy.bone("reportObjs_RWWorkingSetStyle");if(oObjBrowser){var selections=oObjBrowser.selections;if(selections.length>0){var id=selections.getDataSetId();dSetId=(id==null)?microstrategy.primeDataSetId:id;var indexKey=selections.getActiveUserMetricIndxKey();if(indexKey){activeUserMetricId=indexKey[0];activeElemIndx=indexKey[1];}}else{dSetId=microstrategy.primeDataSetId;}}else{dSetId=microstrategy.primeDataSetId;}}var arg="";arg+=(mode!=null)?"&formulaMode="+mode:"";arg+=(activeElemIndx!=null)?"&activeElemIndx="+activeElemIndx:"";arg+=(activeViewID!=null)?"&activeViewID="+activeViewID:"";arg+=(activeUserMetricId!=null)?"&activeUserMetricId="+activeUserMetricId:"";arg+=(dSetId!=null)?"&activeDatasetID="+dSetId:"";toggleShowBean("formula",true,arg);break;case"edtDMetric":var um=this.parentBone.parentBone.updateManager,isDesignMode=microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE,me=this;if(isDesignMode&&um.newActions){um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[],null)]);um.flushAndSubmitChanges(false,{success:function(){me.exec("doEdtDMetric",cmdValue);}});}else{this.exec("doEdtDMetric",cmdValue);}break;case"doEdtDMetric":var um=this.parentBone.parentBone.updateManager,mid=mstrApp.getMsgID();var refreshCB={success:function(res){um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);um.flushAndSubmitChanges();}};var gridBone=microstrategy.findBone(this.parentBone.selections.getSelectedGrid());if(gridBone){var dss=microstrategy.bone("rwb_viewer")["datasetInfos"],src=microstrategy.activeCXMenu,datasetID=gridBone.dSetId,gsi=gridBone.gridStructureInfo,config={datasets:dss,dsid:datasetID,msgID:mid},actions=[],curId,curName,unitType,unitPos;if(src&&src.getAttribute(microstrategy.HTMLATTR_DSS_ID)!==null){curId=src.getAttribute(microstrategy.HTMLATTR_DSS_ID);curName=src.getAttribute(microstrategy.HTMLATTR_DISPLAY_NAME);unitType=src.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);unitPos=src.getAttribute(microstrategy.HTMLATTR_GRIDCELL_DEPTH);}else{var mu=gsi&&gsi.metricAxis&&gsi.metricAxis.units&&gsi.metricAxis.units[0];if(mu){curId=mu.dssId;curName=mu.alias;unitType=mu.dssType;unitPos=mu.depth;}else{unitType=4;unitPos=0;}}var submitAction=function(actions){mstrmojo.xhr.request("POST",mstrConfig.taskURL,refreshCB,{taskId:"mojoRWManipulation",rwb:um.getRWBState(),messageID:mid,suppressData:true,params:JSON.stringify({actions:actions,style:{params:{treesToRender:0},name:"RWIVEMojoStyle"}})});};if(cmdId==="doEdtDMetric"){config.metricId="";config.action={cmd:"editNew",refOi:{did:curId,n:curName}};config.onApplyMetricCallback=function(cfg){actions.push({act:"addDerivedMetricToDataset",dsid:datasetID,formula:cfg.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(cfg.tokenStreamXML),name:cfg.alias,afb:cfg.afb,sfb:cfg.sfb,newObjectIds:["$GUID_135"]});actions.push({act:"updateTemplate",keyContext:gridBone.RWUnitId,actions:[{act:"addUnit",unitId:"$GUID_135",unitType:unitType,unitPos:++unitPos,dsId:datasetID,isFirst:!gsi||gsi.isEmptyTemplate}]});submitAction.call(this,actions);};}microstrategy.openDerivedMetricEditor(config);}break;case"edtResize":if(oGrid){var id=oGrid.getAttribute("id");toggleShowBean("resizeRW",true,"activeViewID="+id);}break;case"edtPageSetup":case"openPageSetupSectionsTab":case"edtDocProps":var index=0;if(cmdId=="openPageSetupSectionsTab"){index=4;}else{if(cmdId=="edtDocProps"){index=7;}}var viewMode=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?0:this.parentBone.parentBone.currentRWViewMode;microstrategy.openBlockLoaderEditor("rwDocPropsEditor","RWDocPropertiesEditor",{selectedIndicesList:index},{currentRWViewMode:viewMode,featureMode:this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE)});break;case"visualizationsEditor":if(oGrid){var id=oGrid.getAttribute("id");if(this.parentBone.parentBone){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}toggleShowBean("visualizationsEditor",true,"activeViewID="+id);}break;case"visualizationsEditorRW":toggleShowBean("visualizationsEditor",true,"activeViewID=");break;case"visualizationsEditorRWLayout":toggleShowBean("visualizationsEditor",true,"activeViewID=&activeTabID=-1");break;case"edtSubtotals":if(oGrid){var id=oGrid.getAttribute("id");toggleShowBean("subtotalsDHTMLRW",true,"activeViewID="+id);}break;case"edtSubtotalsOldIServer":if(oGrid){var id=oGrid.getAttribute("id");toggleShowBean("subtotalsDHTMLRWOldIServer",true,"activeViewID="+id);}break;case"edtSort":if(oGrid&&targetGrid&&targetGrid.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE)){this.exec("edtSortGrid",cmdValue);}else{this.exec("edtSortRW",cmdValue);}break;case"edtSortGrid":if(oGrid){var activeViewID=oGrid.getAttribute("id");microstrategy.openAdvSortEditor({beanPath:this.parentBone.parentBone.beanPath+"."+activeViewID,subtotalPosition:targetGrid&&targetGrid.subtotalPosition,isDocDesignMode:microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE,sourceAxis:cmdValue&&cmdValue[0],sourceType:cmdValue&&cmdValue[1],targetGrid:targetGrid,taskParams:{taskId:"RWExecute",messageID:mstrApp.getMsgID(),gridStyle:"AdvSortDataStyle",partialDisplayKeys:activeViewID,styleName:"RWGridStyle",sessionState:mstrApp.sessionState}});}break;case"graphZones":if(targetGrid&&targetGrid.toggleZonesEditor){var show=targetGrid.zonesEditor?false:true;targetGrid.toggleZonesEditor(null,show);}break;case"edtSortRW":toggleShowBean("sortEditorRWDoc",true,"");break;case"vfeRWGrid":if(oGrid){var nodeKey=oGrid.getAttribute("id"),doc=this.parentBone,docViewer=doc.parentBone,um=docViewer.updateManager,id="mfe",openedPhs={};var fnLoadBundle=function(){if(!window.mstrmojo||!mstrmojo.fe||!mstrmojo.fe.FilterEditor){microstrategy.mojoLoader.loadWidget({bundle:"mojo-fe.js",callback:fnLoadFilter});}else{mstrmojo.locales.load(fnLoadFilter);}},fnLoadFilter=function(){var taskParams={taskId:"getRWGridViewFilter",nodeKey:nodeKey,rwb:um.getRWBState(),msgID:docViewer.messageID};var cb={success:function(res){res.scriptClass="mstrmojo.Obj";var m=mstrmojo.insert(res);fnShowEditor(m);},failure:function(req){mstrmojo.err("Failed to load filter data. ");}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,cb,taskParams);},fnExtractPlaceholders=function(exprRoot,phs){var i,nds=exprRoot.nds;if(exprRoot.ph){phs[exprRoot.ph.idx]=true;}else{if(nds){for(i=0;i<nds.length;i++){fnExtractPlaceholders(nds[i],phs);}}}return phs;},fnShowEditor=function(m){w=id&&window.mstrmojo&&mstrmojo.all[id];var isDesignMode=microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;if(!w){w=mstrmojo.insert({id:id,scriptClass:"mstrmojo.fe.FilterEditor",onUpdateBrowseElementsParams:function(params,attribute){params.datasetID=this.model.dsid;params.messageID=this.model.messageID;params.templateNodeKey=nodeKey;},disableElementsBrowsing:function(att){return isDesignMode&&att.da;}});w.walk.getAttributeForms=function(did){return mstrmojo.rw.ConditionWalk.getAttForms(did,microstrategy.bone("rwb_viewer")["datasetInfos"]);};}m.targets=mstr.$A.filter(m.targets,{filter:function(item){return !item.olap;}},"filter");m.targets=mstr.$A.filter(m.targets,{filter:function(item){switch(item.t){case 1:return(item.st!==257);case 47:return item.st==12033;}return true;}},"filter");w.set("onSave",fnOnSaveFilter);w.set("model",m);if(w.mainExpr.items.length>0){openedPhs=fnExtractPlaceholders(w.mainExpr.items[0],openedPhs);}w.open();},fnOnSaveFilter=function(model){var xml=mstrmojo.fe.FilterUtils.getExprXml(model.expr),limitXml=mstrmojo.fe.FilterUtils.getExprXml(model.limitExpr),applyNow=microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;var actions=[um.createActionObject(null,mstrUpdateManager.SET_GRID_VIEW_FILTER,docViewer.beanPath,["2048012","2048207","2048138","2048274"],[nodeKey,xml,"1","1"],[]),um.createActionObject(null,mstrUpdateManager.SET_GRID_VIEW_LIMIT,docViewer.beanPath,["2048012","2048207","2048018"],[nodeKey,limitXml,applyNow],[])];var savedPhs={};if(w.mainExpr.items.length>0){savedPhs=fnExtractPlaceholders(this.mainExpr.items[0],savedPhs);}var phRemoved=[];for(key in openedPhs){if(!savedPhs[key]){phRemoved.push(key);}}if(phRemoved.length>0){var phKeys=nodeKey+"_"+phRemoved.join("_");actions.push(um.createActionObject(null,mstrUpdateManager.REMOVE_TARGETED_PLACEHOLDERS,docViewer.beanPath,["2048285"],[phKeys],[]));}var isDocumentVersionTen=JSON.stringify(savedPhs)!="{}";if(isDocumentVersionTen){actions.push(um.createActionObject(null,mstrUpdateManager.SAVE_DOC_PROPERIES,docViewer.beanPath,["2048065","2048018"],[mstrUpdateManager.createPropertyEditString(null,"DocumentVersion",10,true,"RWDocumentProperties"),applyNow],[]));}var okCb=function(){docViewer.checkAndDisableFlashDefaultMode(um,actions);um.add(actions);um.flushAndSubmitChanges();},cancelCb=function(){w.open();};if(isDocumentVersionTen){docViewer.showWarningMessageForUnsupportFeature(okCb,cancelCb);return ;}okCb();};if(um.hasChangesToSubmit()||docViewer.isModified){docViewer.callbackOnReload=fnLoadBundle;um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);um.flushAndSubmitChanges();}else{fnLoadBundle();}}break;case"pasteFormat":var sel=this.parentBone.selections;var item=mstr.utils.Arrays.fromHashValues(sel.objCache.copyBuffer.items);var ids=(item)?this.parentBone.parentBone.objProps.pasteFormat(item[0],sel.items,true):null;if(ids){sel.syncUp();}break;case"setCtrlDft":case"setDefaults":this.parentBone.parentBone.objProps.setDefaultFormat(this.parentBone.selections.firstItem());break;case"applyCtrlDft":case"applyDefaults":var sel=this.parentBone.selections.items;this.parentBone.parentBone.objProps.applyCtrlDft(sel,true);this.parentBone.selections.resizeSubSection();this.parentBone.selections.resizeUnitsInFP();break;case"edtProps":microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",{});break;case"fmtGridCells":this.exec("edtPropsTabSelected",10);break;case"edtPropsTabSelected":microstrategy.openBlockLoaderEditor("rwPropsEditor","PropertiesEditorBlockLoader",{selectedIndicesList:cmdValue});break;case"addImg":this.parentBone.openAddImagePropertiesEditor();break;case"cancelImg":this.parentBone.deleteItems(this.parentBone.selections.items,bIsFirefox);this.adjustImageSizeFlag=false;break;case"deleteStubImg":if(this.parentBone.stubImage!=null){this.parentBone.deleteItems(microstrategy.createAssociativeArray(this.parentBone.stubImage),true);this.parentBone.setStubImage(null);}break;case"setStubImage":this.parentBone.setStubImage(this.parentBone.selections.firstItem());break;case"deleteSelections":this.parentBone.promptDeleteItems(this.parentBone.selections.items,true);break;case"cancelSelectorCreation":this.parentBone.deleteItems(this.parentBone.selections.items,false);break;case"deleteFromPortal":var items=document.getElementById(cmdValue);if(items){this.parentBone.promptDeleteItems(microstrategy.createAssociativeArray(items),true);}break;case"minimizePortal":var items=document.getElementById(cmdValue);if(items){var oldState=this.parentBone.styleObj.getAttValue(items,microstrategy.HTMLATTR_WINDOW_STATE);this.parentBone.styleObj.setAttValue(items,microstrategy.HTMLATTR_WINDOW_LAST_STATE,oldState);this.parentBone.minimizePortal(microstrategy.createAssociativeArray(items),"windowState",microstrategy.WINDOW_STATE_MINIMIZED,true);}break;case"maximizePortal":var items=document.getElementById(cmdValue);if(items){var lastState=this.parentBone.styleObj.getAttValue(items,microstrategy.HTMLATTR_WINDOW_LAST_STATE);this.parentBone.styleObj.setAttValue(items,microstrategy.HTMLATTR_WINDOW_LAST_STATE,"");this.parentBone.maximizePortal(microstrategy.createAssociativeArray(items),"windowState",microstrategy.WINDOW_STATE_MAXIMIXED,true);if(lastState!=microstrategy.WINDOW_STATE_MAXIMIXED){if(this.refreshOnWindowChange(items,microstrategy.findBone(items))){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}}mstrDocCommandsImpl.syncGridWidth(targetGrid);}break;case"restorePortal":var items=document.getElementById(cmdValue);if(items){var lastState=this.parentBone.styleObj.getAttValue(items,microstrategy.HTMLATTR_WINDOW_LAST_STATE);this.parentBone.styleObj.setAttValue(items,microstrategy.HTMLATTR_WINDOW_LAST_STATE,"");this.parentBone.restorePortal(microstrategy.createAssociativeArray(items),"windowState",microstrategy.WINDOW_STATE_NORMAL,true);if(lastState!=microstrategy.WINDOW_STATE_NORMAL){if(this.refreshOnWindowChange(items,microstrategy.findBone(items))){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}}mstrDocCommandsImpl.syncGridWidth(targetGrid);}break;case"back":case"front":case"oneBack":case"oneFront":this.parentBone.selections.sendTo(cmdId);break;case"sendTo":this.parentBone.selections.sendTo(cmdValue);break;case"autoSizeImg":var actionCollection=new Array();this.parentBone.autoSizeImages(0,false,this.parentBone.selections.items,actionCollection);this.parentBone.parentBone.updateManager.add(actionCollection);break;case"groupProp":var subBone=this.parentBone.selections.getSelectedSubsection();if(subBone){toggleShowBean("gbeb",true,"activeGroupby="+subBone.parentBone.groupID);}break;case"WebHyperLinkEditor":var src=this.parentBone.selections.firstItem();var selectionsKey=src?src.id:null;if(src.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var gridBone=microstrategy.findBone(src);if(gridBone&&gridBone.selections){src=gridBone.selections.getItems()[0];}}var params="activeObjKey="+selectionsKey;if(src){var dss_id=src.getAttribute(microstrategy.HTMLATTR_DSS_ID);var dss_type=src.getAttribute(microstrategy.HTMLATTR_DSS_TYPE);if(dss_id&&dss_type){params+="&activeUnitID="+dss_id;params+="&activeUnitType="+dss_type;}params+="&renderPromptsOnly=false";toggleShowBean("webHyperLinkEditor",true,params);}break;case"FilterDetailsProperties":var openEditor=this.parentBone.selections.length==0;var props={};if(this.parentBone.selections.isActive()&&!this.parentBone.selections.isMulti()&&this.parentBone.selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)){props.objId=this.parentBone.selections.firstItem().getAttribute(microstrategy.HTMLATTR_ID);openEditor=true;}if(openEditor){microstrategy.openDataBasedBlockEditor(null,"FilterDetailsEditorBlockLoader",this.parentBone.parentBone.beanPath,props);}break;case"unlinkTheme":console.log("TODO unlink the theme and apply copy as theme action");var um=microstrategy.updateManager,thmID=this.queryState("appliedThemeID"),docViewer=this.parentBone.parentBone,sel=this.parentBone.selections.items,selKeys=[];for(var id in sel){selKeys.push(id);}um.add([um.createActionObject(null,mstrUpdateManager.APPLY_THEME,docViewer.beanPath,["2048292","2048076","2048293"],[thmID,selKeys.join(mstrUpdateManager.ITEM_SEPARATOR),false])]);um.flushAndSubmitChanges();break;case"applyTheme":var docViewer=this.parentBone.parentBone;microstrategy.showApplyThemeEditor(false,false,function(thmID,isLink){var um=microstrategy.updateManager;um.add([um.createActionObject(null,mstrUpdateManager.APPLY_THEME,docViewer.beanPath,["2048292","2048076","2048293"],[thmID,"",isLink])]);um.flushAndSubmitChanges();});break;case"applyThemeOnNode":var docViewer=this.parentBone.parentBone,sel=this.parentBone.selections.items,selKeys=[];microstrategy.showApplyThemeEditor(true,this.queryState("appliedThemeAsLink"),function(thmID,isLink){var um=microstrategy.updateManager;for(var id in sel){selKeys.push(id);}um.add([um.createActionObject(null,mstrUpdateManager.APPLY_THEME,docViewer.beanPath,["2048292","2048076","2048293"],[thmID,selKeys.join(mstrUpdateManager.ITEM_SEPARATOR),isLink])]);um.flushAndSubmitChanges();});break;case"saveAsTheme":var docViewer=this.parentBone.parentBone,um=docViewer.updateManager;if(um.hasChangesToSubmit()||!!docViewer.isModified){docViewer.callbackOnReload=function(){microstrategy.showSaveAsThemeEditor();};um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);um.flushAndSubmitChanges();}else{microstrategy.showSaveAsThemeEditor();}break;case"insertSectionAbove":case"insertSectionBelow":this.exec("mngSections",cmdId=="insertSectionAbove"?"above":"below");break;case"mngSections":switch(cmdValue){case"above":case"left":var subBone=this.parentBone.selections.getSelectedSubsection();if(subBone){subBone.insertSubSectionAbove();}break;case"below":case"right":var subBone=this.parentBone.selections.getSelectedSubsection();if(subBone){subBone.insertSubSectionBelow();}break;case"delete":showMessage({contents:microstrategy.descriptors.getDescriptor("3316"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.parentBone.parentBone.id+"').doc.sections['"+this.parentBone.currentSection.id+"'].subsections['"+this.parentBone.currentSection.currentSubSection.id+"'].deleteSubSection();",type:mstrMsgBoxImpl.MSG_WARNING});break;}break;case"number":case"deltaDecimal":this.parentBone.selections.setNumberFormat(cmdId,cmdValue);this.parentBone.selections.syncUp();break;case"DocPropertyChanges":this.parentBone.processDocPropertyChanges(cmdValue);break;case"SyncSelections":if(this.parentBone.selections&&this.parentBone.selections.isActive()){this.parentBone.selections.syncUp();}break;case"addObj":this.parentBone.addObj("5","5",microstrategy.findBone(this.parentBone.selections.firstItem()),cmdValue,null,microstrategy.SNAP_OFF);break;case"addObjs":var subsection=microstrategy.findBone(this.queryState("selectedSection"));subsection.ondrop(subsection.elem,cmdValue);break;case"addObjsWithFormat":var subsection=microstrategy.findBone(this.queryState("selectedSection"));subsection.addObjsWithFormat(5,5-this.parentBone.parentBone.elem.scrollTop,cmdValue[0],subsection.elem,cmdValue[1],microstrategy.SNAP_OFF,null,false);break;case"addObjsAsLinked":var subsection=microstrategy.findBone(this.queryState("selectedSection"));subsection.addObjsWithFormat(5,5-this.parentBone.parentBone.elem.scrollTop,cmdValue[0],subsection.elem,cmdValue[1],microstrategy.SNAP_OFF,null,true);break;case"addasText":var sub=this.queryState("selectedSection");if(sub!=null){var x=getObjSumLeftScrolled(sub)+5;var y=getObjSumTopScrolled(sub)+5;var ac=new Array();var newItems=new Array();for(var i in cmdValue){ac=this.parentBone.addCtrl(new Rect(y,null,null,x),sub,ac,microstrategy.SUBOBJTYPE_DOC_TEXT,cmdValue[i].getAttribute("ds"),null,microstrategy.SNAP_OFF);x=x+getObjWidth(sub.lastChild)+10;newItems.push(sub.lastChild);}this.parentBone.selections.finishAddAllObjs(newItems,ac,false);this.parentBone.parentBone.updateManager.add(ac);}break;case"autotext":if(this.parentBone.parentBone.docViewsSize>1&&!this.parentBone.parentBone.defaultInsertMode){var fc="var rwb = microstrategy.bone('rwb_viewer').doc, p = document.getElementById('"+mstrMsgBoxImpl.MSG_PREF_WARNING_CHECKBOX_ID+"'), checked = p && p.checked;";var doExec="rwb.commands.exec('doAutotext','"+cmdValue+"');";var fok=fc+"rwb.visibleCurOnly=false;"+doExec+"if(checked)rwb.updateInsertMode(true);";var fcancel=fc+"rwb.visibleCurOnly=true;"+doExec+"if(checked) rwb.updateInsertMode(false);";fnShowMessageAdd(fok,fcancel);}else{this.exec("doAutotext",cmdValue);}break;case"doAutotext":if(this.parentBone.selections&&!this.parentBone.selections.isMulti()&&this.parentBone.selections.isActive()){var selection=this.parentBone.selections.firstItem();if(selection!=null){var objSubType=selection.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);var objType=selection.getAttribute(microstrategy.HTMLATTR_OBJTYPE);if(objSubType==microstrategy.SUBOBJTYPE_DOC_TEXT){this.parentBone.appendToTextField(this.parentBone.getAutoTextMacroCode(cmdValue),selection);this.parentBone.editText(null,selection);}else{if(objType==microstrategy.OBJTYPE_DOC_OBJECT&&objSubType==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var psBone=microstrategy.findBone(selection);selection=psBone.getCurrentPanel().elem;}else{if(objType!=microstrategy.OBJTYPE_DOC_SUBSECTION){selection=microstrategy.findAncestor(selection.parentNode);}}var rect=new Rect(getObjSumTopScrolled(selection)+1,null,null,getObjSumLeftScrolled(selection)+1);this.parentBone.addCtrl(rect,selection,null,microstrategy.SUBOBJTYPE_DOC_TEXT,this.parentBone.getAutoTextMacroCode(cmdValue));}}}break;case"addToTextField":this.parentBone.appendToTextField(cmdValue[0],cmdValue[1],cmdValue[2]);break;case"addToGrouping":var updateManager=this.parentBone.parentBone.updateManager;var ac=new Array();var items=cmdValue.getItems();for(var i=0;i<items.length;i++){var addToGroupBy=false;var dssType=items[i].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);var dssSubType=items[i].getAttribute(microstrategy.HTMLATTR_DSS_SUBTYPE);var dssId=items[i].getAttribute(microstrategy.HTMLATTR_DSS_ID);if(microstrategy.isValidGroupByType(dssType)){var groupByDssIds=this.parentBone.parentBone.commands.queryState("groupByDssIds");addToGroupBy=(groupByDssIds.indexOf("|"+dssId+"|")==-1);}if(addToGroupBy){ac.push(updateManager.createActionObject(this,mstrUpdateManager.ADD_GROUP,this.parentBone.parentBone.beanPath,["2048004","2048005","2048106","2048031"],[dssId,dssType,dssSubType,cmdValue.getDataSetId()],[]));}}updateManager.add(ac);updateManager.flushAndSubmitChanges();break;case"editTextField":this.parentBone.editText(null,cmdValue);break;case"maxZIndex":return this.parentBone.getMaxZIndex();break;case"edtColorPicker":var params=cmdValue.split("|");this.parentBone.openDialog("edtColorPicker",null,null,microstrategy.servletName+"."+microstrategy.pageName,{activeBoneID:params[0],activeControlID:params[1],currentColor:params[2]});this.parentBone.parentBone.updateManager.replaceURL("selectedTabOptions",params[3]);this.parentBone.parentBone.updateManager.flushAndSubmitChanges();break;case"graphEdtColorGradient":case"edtColorGradient":var params=cmdValue.split("|");var data="parentBoneID="+params[0]+"&controlID="+params[1]+"&activeViewKey="+params[2]+"&graphObjectID="+params[3]+"&graphSeriesID="+parseInt(params[4],10);if(params.length>6){data+="&color1="+params[5]+"&color2="+params[6]+"&transitionType="+params[7]+"&angle="+params[8]+"&xOffset="+params[9]+"&yOffset="+params[10];microstrategy.updateManager.replaceURL("selectedTabOptions",params[11]);}this.parentBone.openDialog("edtColorGradient",data,null,microstrategy.servletName+"."+microstrategy.pageName);microstrategy.updateManager.flushAndSubmitChanges();break;case"toggleSnap":microstrategy.SNAP_OFF=!microstrategy.SNAP_OFF;microstrategy.updateBrowserSetting("snapOff",microstrategy.SNAP_OFF);break;case"objBrowser":case"toggleAccordion":return microstrategy.toggleAccordion();case"groupBy":case"toggleGroupBy":return microstrategy.toggleEditor("pbb_GroupByStyle","pbb");case"docSelectedVisualization":var actionCollection=new Array();var params=cmdValue.split("|");this.parentBone.setVisualizationSettings(null,params[0],null,params[1],actionCollection,null,(this.parentBone.parentBone.isLayoutLevelVis)?"-1":null);this.parentBone.parentBone.updateManager.add(actionCollection);if(!this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS)){this.parentBone.parentBone.updateManager.flushAndSubmitChanges();}return true;case"setVisProps":var params=cmdValue.split("|");var ac=new Array();this.parentBone.setVisualizationSettings(null,null,null,null,ac,params[0],params[1],true);this.parentBone.parentBone.updateManager.add(ac,true);return true;case"createPanel":return this.parentBone.createPanel();case"secondaryDataSourcesEditor":if(oGrid){var id=oGrid.getAttribute("id");toggleShowBean("secondaryDataSourcesEditor",true,"activeViewID="+id+"&secondaryKeys="+cmdValue[0]+"&visEditorId="+cmdValue[1]);}break;case"visPropsEditor":var args="scope="+cmdValue[0]+"&selVis="+cmdValue[1];toggleShowBean("visPropsEditor",true,args);break;case"gridMode":case"graphMode":case"gridGraphMode":case"visualizationMode":case"tbanding":case"tOutline":case"toggleattforms":case"fittocontent":case"fittowindow":case"comboToggleButton":case"tsubtotals":case"checkMergeRowHeader":case"checkMergeColHeader":case"checkLockRowHeader":case"checkLockColHeader":case"ShowThreshold":case"quickThresholds":case"swapAxes":case"formatGridBulk":case"formatGraphBulk":case"autostyle":case"subtotalChanges":case"addQuickTotals":case"cancelGridFormatRequest":case"toggleHideNullsOrZeros":if(targetGrid&&targetGrid.commands){return targetGrid.commands.exec(cmdId,cmdValue);}return false;case"gridGraphMode":if(targetGrid&&targetGrid.commands){var ac=[];this.parentBone.formatSizeMode(microstrategy.createAssociativeArray(oGrid),"heightMode","0",ac);this.parentBone.formatSizeMode(microstrategy.createAssociativeArray(oGrid),"widthMode","0",ac);microstrategy.updateManager.add(ac);return targetGrid.commands.exec(cmdId,cmdValue);}case"gridSelectedVisualization":if(targetGrid&&targetGrid.commands){var res=targetGrid.commands.exec("selectedVisualization",cmdValue);this.parentBone.parentBone.observer.notifyAll("onselectionchange");return res;}return false;case"synchronizeGridSelections":if(this.parentBone.selections){this.parentBone.selections.fetchObjectFormatLevelFromGrid();}break;case"tbUnitSelector":if(this.queryEnabled("onepanelstack")){var lvl=null;if(cmdValue==1){lvl=0;}this.parentBone.selections.setObjectFormatLevel("Panels",this.parentBone.selections.resolvePanelsFormat(cmdValue,lvl));}else{if(cmdValue.indexOf("**grid")>-1){targetGrid.graphSelected=false;this.exec("tbGridUnitSelector",cmdValue.replace("**grid",""));}else{if(cmdValue.indexOf("**graph")>-1){targetGrid.commands.exec(cmdId,cmdValue);}else{this.exec("tbGridUnitSelector",cmdValue);}}}break;case"tbValueSelector":if(this.queryEnabled("onepanelstack")){this.parentBone.selections.setObjectFormatLevel("Panels",this.parentBone.selections.resolvePanelsFormat(null,cmdValue));}else{if(this.queryEnabled("onecontrol")){this.parentBone.selections.setObjectFormatLevel("Control",this.parentBone.selections.resolveControlFormat(null,cmdValue));}else{if(targetGrid.graphSelected){targetGrid.commands.exec(cmdId,cmdValue);}else{this.exec("tbGridValueSelector",cmdValue);}}}break;case"tbGridUnitSelector":case"tbGridValueSelector":var unit,level;if(cmdId=="tbGridUnitSelector"){unit=cmdValue;if(unit<microstrategy.GRID_OTHER){this.parentBone.selections.addToSelection(false,findTarget(targetGrid.elem,microstrategy.HTMLATTR_OBJTYPE));if(unit==microstrategy.GRID_UNIT_CONTAINER){level=1;}}}else{level=cmdValue;}this.parentBone.selections.setObjectFormatLevel(cmdId,this.parentBone.selections.resolveGridFormat(unit,level));return false;case"setUnitFormatLevels":var tType=(targetGrid)?"Grid":(targetPanelStack?"Panels":"Control");var unit,level;if(cmdValue.src=="edtUnitSelector"){unit=cmdValue.v;if(targetGrid){if(unit<microstrategy.GRID_OTHER){this.parentBone.selections.addToSelection(false,findTarget(targetGrid.elem,microstrategy.HTMLATTR_OBJTYPE));if(unit==microstrategy.GRID_UNIT_CONTAINER){level=1;}}}}else{level=cmdValue.v;}var newLevels=this.parentBone.selections["resolve"+tType+"Format"](unit,level);this.parentBone.selections.setObjectFormatLevel(tType,newLevels);this.parentBone.selections.verifyFormatLevels(cmdValue.t);break;case"resetObjectFormatLevel":if(this.parentBone&&this.parentBone.selections){this.parentBone.selections.resetObjectFormatLevel();}break;case"edtTabChange":this.parentBone.selections.verifyFormatLevels(cmdValue);break;case"formatMultiLevelBulk":for(var i=cmdValue.length-1;i>=0;i--){var arValues=cmdValue[i].split("|");if(arValues[0]==microstrategy.FORMAT_LEVEL_FLAG_DOC){var noUsed=cmdValue.splice(i,1)[0];this.exec(arValues[1],arValues[2]);}}break;case"MultiLevelPropertyChanges":for(var i=cmdValue.length-1;i>=0;i--){if(cmdValue[i].level==microstrategy.FORMAT_LEVEL_FLAG_DOC){var propChange=cmdValue.splice(i,1)[0];this.exec(propChange.cmdId,propChange);}}break;case"showFunctionBuilder":toggleShowBean("functionWizard",true,"formulaMode=2");break;case"drill":case"drillNW":this.parentBone.selections.performDrill(cmdValue,(cmdId=="drillNW"));break;case"execLink":this.execLink(cmdValue);break;case"cancelEdit":if(cmdValue){this.parentBone.parentBone.updateManager.undo(cmdValue);}if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.cancelPropertyEdit(cmdValue);}break;case"save":var um=this.parentBone.parentBone.updateManager;var ac=new Array();var fromDesignMode=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE)?"true":"false";var folderId=(this.parentBone.parentBone.saveFolderId)?this.parentBone.parentBone.saveFolderId:this.parentBone.parentBone.parentFolderID;ac.push(um.createActionObject(this.elem,mstrUpdateManager.RW_SAVE_AS,microstrategy.servletName,["3013","3014","3017"],["false",folderId,fromDesignMode],[]));um.add(ac);um.useIframe=false;um.flushAndSubmitChanges();break;case"ctrlJustAdded":if(!this.queryState("lock")){this.exec("cursor");}break;case"cursor":this.parentBone.parentBone.insertionControlLocked=false;this.exec("currentControl",cmdId);this.parentBone.parentBone.observer.notifyAll("insertionControlModified");break;case"lock":if(!this.queryState("cursor")){this.parentBone.parentBone.insertionControlLocked=!this.parentBone.parentBone.insertionControlLocked;}this.parentBone.parentBone.observer.notifyAll("insertionControlModified");break;case microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:cmdId=cmdId+"|false";case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|0":case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|1":cmdValue=cmdId.split("|")[1];cmdId=cmdId.split("|")[0];case microstrategy.GRAPH_CTL:case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|FP":case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|TC":case microstrategy.SUBOBJTYPE_DOC_TEXT:case microstrategy.BUTTON_CTL:this.parentBone[cmdId]=cmdValue;if((this.parentBone.currentControl==cmdId&&!this.isSubtypedCmd(cmdId))||(this.isSubtypedCmd(cmdId)&&cmdValue==this.parentBone.currentControlSubtype)){if(this.queryState("lock")){this.exec("cursor");break;}else{this.parentBone.parentBone.insertionControlLocked=true;}}else{if(this.queryState("lock")){this.parentBone.parentBone.insertionControlLocked=false;}}if(cmdId==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL&&cmdValue.indexOf(";")>=0){cmdId=microstrategy.SUBOBJTYPE_DOC_WIDGET;}this.exec("currentControl",this.isSubtypedCmd(cmdId)?cmdId+"|"+cmdValue:cmdId);this.parentBone.parentBone.observer.notifyAll("insertionControlModified");break;case"visFlashMode":case"visAjaxMode":case"autoArrange":if(targetGrid){targetGrid.commands.exec(cmdId,"0");}break;case"FontFamily":case"FontSize":case"Bold":case"Italic":case"Underline":case"FillColor":case"FontColor":if(targetGrid){if(this.parentBone.selections.gridUnitFormatX!=microstrategy.GRID_UNIT_CONTAINER||targetGrid.graphSelected){if(this.passToGrid(targetGrid,cmdId,cmdValue)){return true;}}else{microstrategy.formatType=this.parentBone.selections.gridValueFormatX;}}if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.setFormat(cmdId,cmdValue,allPanels);this.parentBone.selections.syncUp();}break;case"GridHorizontal":this.passToGrid(targetGrid,cmdId,cmdValue);break;case"IncreaseDecimal":case"DecreaseDecimal":if(!this.passToGrid(targetGrid,cmdId,cmdValue)){this.exec("deltaDecimal",(cmdId=="IncreaseDecimal")?"1":"-1");}break;case"Currency":case"IntlCurrency":if(!this.passToGrid(targetGrid,cmdId,cmdValue)){this.exec("number","1");}break;case"Percent":if(!this.passToGrid(targetGrid,cmdId,cmdValue)){this.exec("number","2");}break;case"Comma":if(!this.passToGrid(targetGrid,cmdId,cmdValue)){this.exec("number","3");}break;case"lnstyle":case"lncolor":case"LineColor":if(this.parentBone.selections.isGridContainerSelected()||!this.passToGrid(targetGrid,cmdId,cmdValue)){if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.setBorderFormat(cmdId,cmdValue);this.parentBone.selections.syncUp();}}break;case"borders":if(this.parentBone.selections.isGridContainerSelected()||!this.passToGrid(targetGrid,cmdId,cmdValue)){if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.enableBorders(cmdValue);this.parentBone.selections.syncUp();}}break;case"pivotButtons":var prefValue=this.parentBone.parentBone.isFeatureAvailable("check-show-pivot-buttons")?0:1;um=this.parentBone.parentBone.updateManager;var action=um.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.parentBone.beanPath,["5003","5004"],["showPivot",prefValue],[],null);um.add([action],true);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}um.flushAndSubmitChanges();break;case"sortButtons":prefValue=this.parentBone.parentBone.isFeatureAvailable("check-show-sort-buttons")?0:1;um=this.parentBone.parentBone.updateManager;action=um.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,this.parentBone.parentBone.beanPath,["5003","5004"],["sSrt",prefValue],[],null);um.add([action],true);if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);}um.flushAndSubmitChanges();break;case"createAutowireSelector":case"removeTargets":um=this.parentBone.parentBone.updateManager;var cx=microstrategy.activeCXMenu;var ty=cx.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)||microstrategy.DSSTYPE_METRIC;var id=cx.getAttribute(microstrategy.HTMLATTR_DSS_ID)||"";var gk=this.parentBone.selections.getSelectedGrid().getAttribute("id");if(cmdId=="createAutowireSelector"){var sub=this.parentBone.selections.getSelectedSubsection();var kArr=sub.getTargets({excludeTargets:[gk]}).keys;var action=um.createActionObject(null,mstrUpdateManager.ADD_CONTROL_TO_GRID,this.parentBone.parentBone.beanPath,["2048007","2048012","2048001","2048009","2048129","2048116"],[gk,"",id,ty,"",kArr.join(CLIPBOARD_ITEM_SEPARATOR)],[]);}else{var action=um.createActionObject(null,mstrUpdateManager.REMOVE_CONTROL_FROM_GRID,this.parentBone.parentBone.beanPath,["2048007","2048130","2048001","2048009"],[gk,"",id,ty],[],null);}um.add([action],true);um.flushAndSubmitChanges();break;case"disableAutowire":this.parentBone.processDocPropertyChanges([{cmdId:"Autowire",memo:{},value:false}]);break;case"mojoVisPropsEditor":if(mstr.utils.ISIE8){return showMessage({contents:"This page is not supported in your browser",elements:microstrategy.OK_BUTTON,buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("219")},type:mstrMsgBoxImpl.MSG_WARNING});}var me=this,docViewer=this.parentBone.parentBone;um=docViewer.updateManager,id="mstrVisPropsEditor",openVPE=function(){microstrategy.showWait(false);mstr.$obj("widgetBoneTranslator").set("mojoVisPropsChanged",false);var w=mstrmojo.insert({scriptClass:"mstrmojo.mstr.VisPropsEditor",id:id,nodeKey:me.parentBone.selections.getSelectionsKey()[0],messageID:docViewer.messageID,rwb:docViewer.updateManager.getRWBState(),executionMode:me.isDesignMode()?1:null,zIndex:microstrategy.getMaxZIndex()+1,visible:true,onClose:function(){this.destroy();},onOK:function(){mstr.$obj("widgetBoneTranslator").set("mojoVisPropsChanged",true);}});w.start();},loadWidget=function(){if(!window.mstrmojo||!mstrmojo.mstr.VisPropsEditor){microstrategy.showWait(true);microstrategy.mojoLoader.loadWidget({bundle:microstrategy.jsBundleDebug?"mojo-vis-props-debug.js":"mojo-vis-props.js",callback:openVPE});}else{openVPE();}};if(um.hasChangesToSubmit()||!!docViewer.isModified){docViewer.callbackOnReload=loadWidget;um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);um.flushAndSubmitChanges();}else{loadWidget();}break;case"transactionEdit":var docViewer=this.parentBone.parentBone,me=this;um=docViewer.updateManager,id="mstrTE",openTE=function(){if(!mstrmojo.all[id]){mstrmojo.insert(mstrmojo.txEditor.TransactionEditor);}var w=mstrmojo.all[id],messageID=docViewer.messageID,selections=me.parentBone.selections,table=selections.isOnlyOneTableSelected()&&selections.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK),nodeKey=table?table.getTransactionUnitKey():selections.getTransactionUnitKey(),filter=table&&table.queryState("TRXObjs"),DDICCB=function(teModel){var bone=microstrategy.findBone(document.getElementById(me.parentBone.prevSelectedId)),newTscObjs=teModel.rwTxs.tscObjs,rwb=microstrategy.bone("rwb_viewer"),ddicCtlSrc=[].concat(rwb.getAvailableAttributes()).concat(rwb.getAvailableMetrics()),ddic=rwb.ddic={},oldTsc=bone.tscObjs||[],tmpTscObjs=[].concat(newTscObjs);if(bone){var hashDDIC={};mstr.$A.forEach(oldTsc,function(obj){if(obj.ctl&&obj.ctl.ddic){hashDDIC[obj.ctl.ctlKey]=mstr.$H.deepClone(obj.ctl);}});mstr.$A.forEach(tmpTscObjs,function(tmp){if(tmp.ctl&&tmp.ctl.ddic){var ctl=hashDDIC[tmp.ctl.ctlKey],tmpDDIC=tmp.ctl.ddic,PROPS={trxsid:true,ctlSrc:true,autoSync:true,targetKeys:true},_ddic;if(ctl){_ddic=ctl.ddic;_ddic.trxsid=tmpDDIC.csid;}else{var trxsid=tmp.ctl.ddic.csid,ctlSrcs=mstr.$A.filter(ddicCtlSrc,{filter:function(ctlSrc){return ctlSrc.dssid.indexOf(trxsid)>=0;}},"filter");_ddic={trxsid:tmpDDIC.trxsid,ctlSrc:ctlSrcs.length>0?ctlSrcs[0].dssid:"",autoSync:false,targetKeys:""};}for(var prop in PROPS){if(PROPS[prop]){tmpDDIC[prop]=_ddic[prop];}}ddic[tmp.ctl.ctlKey]=tmp.ctl;}});mstr.$A.forEach(tmpTscObjs,function(tmp){var idx=mstr.$A.findByForm(oldTsc,tmp.key,"key");if(tmp.edt&&(idx<0||!oldTsc[idx].edt)){var node=document.getElementById(tmp.key);if(node){mstrmojo.css.addClass(node,"txttrx");}}});mstr.$A.forEach(oldTsc,function(old){var idx=mstr.$A.findByForm(tmpTscObjs,old.key,"key");if(idx<0||!tmpTscObjs[idx].edt){var node=document.getElementById(old.key);if(node){mstrmojo.css.removeClass(node,"txttrx");}}});bone.tscObjs=tmpTscObjs;}rwb.ddic=ddic;},saveCB=function(teModel,res){um.setRWStateInForm(res.rwb);if(table){var m=table.model;m.set("trxInfo",teModel.rwTxs);m.raiseEvent({name:"trxInfoChange"});}DDICCB(teModel,res);},cb={success:function(res){if(!res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{w.mappingTxModel.messageID=messageID;w.mappingTxModel.getNewCtlKey=function(){return microstrategy.OBJ_PREFIX+docViewer.getNextObjId();};w.mappingTxModel.onsave=saveCB;if(filter){var tscObjs=res.tscObjs,sz=(tscObjs&&tscObjs.length)||0,i=sz-1;for(;i>=0;i--){var o=tscObjs[i],f=filter[o.key];if(!f){tscObjs.splice(i,1);}else{o.n=f;}}}w.mappingTxModel.set("rwTxs",res);w.mappingTxModel.nodeKey=nodeKey;w.localTxModel.nodeKey=nodeKey.k;w.localTxModel.messageID=messageID;w.localTxModel.set("offTxs",res);w.localTxModel.onsave=function(model,res){um.setRWStateInForm(res.rwb);};w.open();}},failure:function(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}},params={taskId:"getRWTransactions",nodeKey:nodeKey.k,messageID:messageID};if(nodeKey.sk){params.sectionKey=nodeKey.sk;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,cb,params);},loadWidget=function(){if(!window.mstrmojo||!mstrmojo.all[id]){microstrategy.mojoLoader.loadWidget({bundle:"mojo-txe.js",callback:openTE});}else{openTE();}};if(um.hasChangesToSubmit()||!!docViewer.isModified){docViewer.callbackOnReload=loadWidget;um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);um.flushAndSubmitChanges();}else{loadWidget();}break;case"transactionCondition":var docViewer=this.parentBone.parentBone,me=this,um=docViewer.updateManager,id="mstrCTE",NODE_CONDITION=1,FIELD_CONDITION=2,CTL_CONDITION=4,saveCB=function(res){um.setRWStateInForm(res.rwb);},openCTE=function(){if(!mstrmojo.all[id]){mstrmojo.insert(mstrmojo.condTx.ConditionTransactionEditor);}var NODETYPE={ACTION_SELECTOR:0,TEXT_FIELD:1,TEMPLATE_UNIT_CONTROL:2},w=mstrmojo.all[id],messageID=docViewer.messageID,selections=me.parentBone.selections,params={taskId:"getRWTransactionSources",msgID:messageID},paramProps={nodeKey:true,ctlKey:true,fieldKey:true,bit:true,taskId:true,msgID:true},target={};if(selections.isOnlyOneGridSelected()){var unit=microstrategy.activeCXMenu,oid=unit&&unit.getAttribute(microstrategy.HTMLATTR_DSS_ID),g=microstrategy.findBone(selections.getSelectedGrid()),tscObjsAll=g&&g.tscObjs||[],len=tscObjsAll.length,i,tscObjs=[];for(i=0;i<len;++i){var tscObj=tscObjsAll[i];if(tscObj.edt){tscObj.ctlKey=tscObj.ctl&&tscObj.ctl.ctlKey;tscObjs.push(tscObj);}}target.nodeKey=selections.getSelectionsKey()[0];target.nodeType=NODETYPE.TEMPLATE_UNIT_CONTROL;target.txnObjs=tscObjs;target.bit=NODE_CONDITION;}else{if(me.queryState("isActionSelector")){var selectorBone=selections.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);target.ctlKey=selectorBone.ctlKey;target.nodeKey=selectorBone.nodeKey;target.nodeType=NODETYPE.ACTION_SELECTOR;target.bit=NODE_CONDITION|CTL_CONDITION;}else{var item=selections.firstItem(),bone=microstrategy.findBone(item),tscObjs=(bone&&bone.tscObjs)||[],fk=selections.getSelectionsKey()[0],idx=mstr.$A.findByForm(tscObjs,fk,"key"),ctl=idx>-1&&tscObjs[idx].ctl,ctlKey=ctl&&ctl.ctlKey;target.fieldKey=fk;target.nodeType=NODETYPE.TEXT_FIELD;target.nodeKey=selections.getTransactionUnitKey().k;target.bit=FIELD_CONDITION;if(ctlKey){target.ctlKey=ctlKey;target.bit|=CTL_CONDITION;}}}var cb={success:function(res){if(!res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{var source={fieldGroups:res.fieldGroups||[],templates:res.templates||[],bwElements:res.bwElements||{}};w.onsave=saveCB;w.set("messageID",messageID);w.set("source",source);w.set("target",target);w.set("model",{actions:res.exps,originNodeActionCount:res.ntc,originCtlActionCount:res.ctc,originFieldActionCount:res.ftc});w.open();}},failure:function(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}};for(var p in target){if(paramProps[p]){params[p]=target[p];}}if(target.nodeType===NODETYPE.ACTION_SELECTOR){params.nodeKey=params.ctlKey;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,cb,params);},loadWidget=function(){if(!window.mstrmojo||!mstrmojo.all[id]){microstrategy.mojoLoader.loadWidget({bundle:"mojo-ctxe.js",callback:openCTE});}else{openCTE();}};if(um.hasChangesToSubmit()||!!docViewer.isModified){docViewer.callbackOnReload=loadWidget;um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);um.flushAndSubmitChanges();}else{loadWidget();}break;case"docViewsEdit":var docViewer=this.parentBone.parentBone,me=this,um=docViewer.updateManager,id="mstrDVE";openDVE=function(){var w=mstrmojo.all[id],messageID=docViewer.messageID,cb={success:function(res){if(!res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{w.initModel(res);w.model.msgID=messageID;w.open();}},failure:function(res){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}},params={taskId:"getRWDocumentViews",msgID:messageID,includePreDefined:true};mstrmojo.xhr.request("POST",mstrConfig.taskURL,cb,params);};loadWidget=function(){if(!window.mstrmojo||!mstrmojo.all[id]){microstrategy.mojoLoader.loadWidget({scriptClass:"DocViewsEditor",id:id,bundle:"mojo-dve.js",callback:openDVE});}else{openDVE();}};if(um.hasChangesToSubmit()||!!docViewer.isModified){docViewer.callbackOnReload=loadWidget;um.add([um.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);um.flushAndSubmitChanges();}else{loadWidget();}break;default:if(targetGrid&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN&&targetGrid.exec(cmdId,cmdValue)){}else{if(this.parentBone.selections&&this.parentBone.selections.length>0){this.parentBone.selections.setFormat(cmdId,cmdValue,allPanels);this.parentBone.selections.syncUp();}}break;}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocCommandsImpl.syncGridWidth=function(tg){if(tg&&tg.commands){var tc=tg.commands;if(tc.queryState("gridMode")==microstrategy.DISPLAY_MODE_GRID&&!tg.isTemplateEmpty()&&tc.queryState("fittowindow")){tc.exec("setColWidthsMode",mstrGridReport.COL_WIDTH_FIT_TO_DISPLAY);if(tg.colWidths){tg.colWidths.syncCols();}}}};mstrDocCommandsImpl.prototype.execLink=function(cmdValue){var objId;var instanceId;var items;if(this.parentBone&&this.parentBone.selections){items=this.parentBone.selections.getItems();}if(cmdValue.ind!=null){instanceId=cmdValue.ind-1;}else{if(items&&items[0]){instanceId=items[0].getAttribute("ind");if(instanceId){instanceId=instanceId-1;}}}if(cmdValue.id!=null){objId=cmdValue.id;}else{if(items&&items[0]){objId=items[0].id;}}if(objId&&instanceId!=null){var docBone=microstrategy.bone("rwb_viewer");var objLinkInfo=docBone.webHyperLinks[objId];if(objLinkInfo!=null){var linkInfo=objLinkInfo[cmdValue.index];if(linkInfo!=null){if(linkInfo.url!=null){this.execUrlLink(linkInfo);}else{this.execDynamiclLink(linkInfo,instanceId);}}}}};mstrDocCommandsImpl.prototype.refreshOnWindowChange=function(items,targetGrid){var dv=this.parentBone.parentBone;return(targetGrid&&typeof (targetGrid.visualizationMode)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&this.parentBone.styleObj.getAttValue(items,microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&(this.parentBone.styleObj.getAttValue(items,microstrategy.HTMLATTR_DISPLAY_MODE)!=microstrategy.DISPLAY_MODE_GRID||this.parentBone.styleObj.getAttValue(items,microstrategy.HTMLATTR_QUICK_SWITCH)==microstrategy.TRUE)&&!(targetGrid.visualizationMode==50&&!dv.isEditableViewModeEplus()));};mstrDocCommandsImpl.prototype.execUrlLink=function(linkInfo){try{if(linkInfo.url&&linkInfo.url.indexOf("mailto:")===0){window.open(linkInfo.url);return ;}var oForm=createDynamicForm(microstrategy.addCSRFTokenToURL(linkInfo.url));if(linkInfo.onw){oForm.target="_blank";}microstrategy.submitForm(oForm);return ;}catch(err){}};mstrDocCommandsImpl.prototype.execDynamiclLink=function(linkInfo,instanceId){try{var xml=linkInfo.linkXml[instanceId];microstrategy.execDynamiclLink(linkInfo,xml,linkInfo.onw);}catch(err){microstrategy.errors.log(err);}};mstrDocCommandsImpl.prototype.passToGrid=function(grid,cmdId,cmdValue){try{if(!grid){return false;}grid.commands.exec(cmdId,cmdValue);return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocCommandsImpl.prototype.isSubtypedCmd=function(cmdId){switch(cmdId){case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.GRAPH_CTL:case microstrategy.BUTTON_CTL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:return true;default:return false;}};mstrDocCommandsImpl.prototype.queryEnabled=function(cmdId,cmdValue){try{var selections=this.parentBone.selections;var dv=this.parentBone.parentBone;if(cmdId&&cmdId.match(/currentControl;|widget;/)){return true;}if(cmdId&&(cmdId.indexOf("autotext;")!=-1)){return this.queryEnabled("autotext");}switch(cmdId){case"panelOverflowSpacingEnabled":return this.queryState("expandPanels")!=0&&this.queryState("ClipOnExport");case"enableGridFormat":return this.parentBone.parentBone.enableGridFormat;case"isUserMetricSelected":return this.isTypeSelectedInOB(microstrategy.DSSTYPE_USER_METRIC);case"isSummaryMetricSelected":return this.isTypeSelectedInOB(microstrategy.DSSTYPE_USER_SUMMARY_METRIC);case"editableViewMode":return(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE);case"edtSortRW":return !this.parentBone.parentBone.noDataset;case"docSelectedVisualization":return this.parentBone.parentBone.isVisualization;case"SupportedOrientations":case"ShowWidgetTitleBar":case"edtDocProps":case"edtPageSetup":case"selectAll":case"unit":case"visualizationsEditorRW":case"openPageSetupSectionsTab":case"openReplaceDataSetEditor":case"openSelectDatasetEditor":case"objBrowser":case"groupBy":case"grid":case"relatedReports":case"rulers":case"save":case"toggleSnap":case"shapesSubmenu":case"widgetsSubMenu":case"selectorSubMenu":case"graphSubMenu":case"buttonSubMenu":case"fontprops":case"numberprops":case"alignprops":case"colorprops":case"layoutColorTabEnabled":case"PaperType":case"PageWidth":case"PageHeight":case"PaperOrientation":case"Scaling":case"ScalePercentage":case"ScalePagesWide":case"ScalePagesTall":case"ScalePageHeaderFooter":case"SectionHorizontalOverflow":case"MarginLeft":case"MarginTop":case"MarginRight":case"MarginBottom":case"minimumPrintArea":case"LayoutFillColor":case"LayoutBorderStyle":case"LayoutAllStyle":case"LayoutAllColor":case"LayoutLeftStyle":case"LayoutLeftColor":case"LayoutTopStyle":case"LayoutTopColor":case"LayoutRightStyle":case"LayoutRightColor":case"LayoutBottomStyle":case"LayoutBottomColor":case"VisibleSections":case"EnableIncFetch":case"IncFetchLevel":case"IncFetchBlockSize":case"allowRemoveExtraColumn":case"showDisplayModes":case"DefaultGridStyle":case"AvailableViewModes":case"AvailableExportModes":case"DefaultViewMode":case"ExecutionFullScreenMode":case"ShowingBarsTemporarily":case"DefaultSelectorsAsFilter":case"PreserveTranslations":case"ShowFloatingToolbars":case"CtlAutoSubmit":case"Autowire":case"AppliedAutowire":case"CalculateDocWidth":case"ShowConditionalFormatting":case"DefaultPageByExportMode":case"ExportRange":case"ExcelGraphFormat":case"EmbeddedFonts":case"MobileDataView":case"UseOneSheetPerLayout":case"UseOneSheetPerGroupElement":case"PromptUserForPagebyExport":case"ExcelEmbedImages":case"IncludeBookmarks":case"ShowBookmarks":case"EmbedFonts":case"GraphFormat":case"GraphQualityDPI":case"isMultiLayout":case"multiLayoutMode":case"EnableToc":case"TOCTitle":case"TOCFontName":case"TOCFontBoldItalic":case"TOCFontSize":case"TOCFontStrikeout":case"TOCFontUnderline":case"TOCFontColor":case"TabLeader":case"WatermarkType":case"WatermarkText":case"WatermarkFontName":case"WatermarkFontBoldItalic":case"WatermarkFontSize":case"WatermarkFontStrikeout":case"WatermarkFontUnderline":case"WatermarkFontColor":case"AutoFontSize":case"TextWashout":case"TextOrientation":case"ImageSource":case"ImageScale":case"ShowTabsForSingleLayout":case"RemoveNullGroups":case"RemoveMissingUnits":case"SingleSourceGrid":case"RWLevelMCEJoin":case"TrimNoSectionData":case"incrFetchEnabled":case"FitPDFContentHeight":case"DisplayPageByBar":case"DisplayRePromptIcon":case"UseAsInfoWindow":case"incrFetchBlockCount":case"incrFetchLevels":case"PreLoadAllPanels":case"PSPreLoadAllPanels":case"gridIfEnabled":case"gridIfMaxRows":case"gridIfRowMode":case"layoutBarStyle":case"layoutBarPosition":case"enableGraphTooltips":case"UseAsInformationWindow":case"InformationWindowPlacement":case"InfoWindowMode":case"TabCloseToDismissInfoWindow":case"TextCopyMode":case"GridCellCopyMode":case"EnableHorizontalSwipeToChange":case"SwipePanelStyle":case"fpAutoSubmit":case"isFilterPanel":case"EnableExport":case"ExcelExportDocumentURL":case"PDFExportDocumentURL":case"TOCFillColor":case"TOCTitleAlignment":case"TOCTitleFontName":case"TOCTitleFontBoldItalic":case"TOCTitleFontSize":case"TOCTitleFontUnderline":case"TOCTitleFontStrikeout":case"TOCTitleFontColor":case"TOCTitleFillColor":case"TOCTitleEnableInherit":case"TOCLeftIndent":case"TOCRightIndent":case"TOCBorderStyle":case"TOCBorderColor":case"TOCBorderWeight":case"TOCTitleSetEnable":case"TOCBorderStyleEnable":case"cursor":case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|0":case microstrategy.SUBOBJTYPE_DOC_SHAPE+"|1":case microstrategy.GRAPH_CTL:case microstrategy.BUTTON_CTL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|FP":case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|TC":case microstrategy.SUBOBJTYPE_DOC_TEXT:case"IncludePageHeaderFooter":case"docViewsEdit":case"EnableZoom":case"ApplyGBToAllLayouts":case"RefreshDocument":case"RefreshFrequency":case"EnableCopyForText":case"EnableCopyForGridCell":case"DocumentThemeColor":case"EnableSwipingToSwitchLayout":case"SetBadgeToValueOnField":case"isNavigationDocument":case"SmartClientDoc":case"OfflineOnCube":case"ShowOfflineUCOnCubeConfig":case"MakePrivate":case"KeepControlTargetsConsistent":return true;case"pageTabEnabled":case"marginTabEnabled":case"layoutMobileTabEnabled":case"incrFetchTabEnabled":case"documentTabEnabled":case"exportTabEnabled":case"tocTabEnabled":case"docMobileTabEnabled":case"docAdvTabEnabled":case"deliveryTabEnabled":return !dv.IsNavigationDocument;case"InfoWindowPositionEnabled":return this.queryState("UseAsInformationWindow")&&(this.queryState("InfoWindowMode")==4);case"ViewModeInteractivityLevel":return this.queryState("ShowFloatingToolbars");case"lock":return this.parentBone.currentControl!="cursor";case"DataFilterModeEnabled":var src=this.queryState("EditSelectorSource"+(this.queryState("isMetricQualifier")?"Metrics":(this.queryState("isDDIC")?"DDIC":"")));src=src&&src.split("|");return(src&&src.length>2&&src[1]==microstrategy.DSSTYPE_ATTRIBUTE)||this.queryState("IsSelectorSourceNDE");case"watermarkTabEnabled":return dv.AllowWatermark&&!dv.IsNavigationDocument;case"layoutLayoutTabEnabled":return(this.parentBone.parentBone.isMultiLayout||this.queryState("ShowTabsForSingleLayout"))&&!dv.IsNavigationDocument;case"layoutIncTabEnabled":return false;case"selectorTabTitle":return true;case"BeforeLayout":case"visualizationsEditorRWLayout":return this.parentBone.parentBone.isMultiLayout;}if(!selections){return false;}if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(cmdId)){if(!selections||!selections.isOnlyOneGridSelected()){return false;}var g=microstrategy.findBone(selections.getSelectedGrid());g=(g instanceof mstrReportGraphImpl)?g:microstrategy.bone(g.id+"_graph");return(g&&g.commands)?g.commands.queryEnabled(cmdId):false;}switch(cmdId){case"editSelector":if(selections.isActive()&&!selections.isMulti()&&selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEMPLATE)){var gridBone=microstrategy.findBone(selections.firstItem());return(gridBone&&gridBone.commands&&gridBone.commands.queryEnabled(cmdId));}return false;case"isNotLinkedGrid":case"isNotLinkedGridOrNoGrid":case"isNotLinkedGraph":if(!this.queryEnabled(cmdId.indexOf("Grid")!=-1?"onegrid":"onegraph")){return true;}var g=microstrategy.findBone(selections.getSelectedGrid());return(g&&g.commands&&!g.commands.queryState("isLinkedTemplate"));case"gradientcolor":return true;case"isSelectionsPresent":return true;case"deleteq":if(dv.IsNavigationDocument){var bone=selections.length&&microstrategy.findBone(mstr.$H.firstItem(selections.items));if(bone&&bone.isNavigationBar){return false;}}case"copyq":case"copy":case"cutq":case"cut":case"delete":case"duplicate":case"objalign":case"alignGrid":case"objsize":case"sizeToGrid":case"controlIsSelected":return(selections.isActive()&&selections.isVisible&&selections.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_DOC_SUBSECTION);case"setCtrlDft":return(selections.isOnlyOneCtrlDftObjSelected())&&!this.queryState("isButton")&&!selections.atLeastOneTableSelected();case"applyCtrlDft":return(selections.atLeastOneCtrlDftObjSelected())&&!this.queryState("isButton")&&!selections.atLeastOneTableSelected();case"advformatmenu":return(selections.isActive()&&selections.isVisible);case"imgready":return(selections.isActive())?selections.isImageReady():false;case"oneNonLinkedGrid":return this.queryEnabled("onegrid")&&!this.queryEnabled("isLinkedGrid");case"graphMode":case"gridGraphMode":case"gridMode":case"graphMode":case"gridGraphMode":case"onegrid":return(selections.isActive())?selections.isOnlyOneGridSelected():false;case"oneTable":return(selections.isActive())?selections.isOnlyOneTableSelected():false;case"onepanelstack":return(selections.isActive())?selections.isOnlyOnePanelStackSelected():false;case"allpanelstack":return(selections.isActive())?selections.areAllSelectedPanelStacks():false;case"panelstackselected":return(selections.isActive())?selections.isPanelStackSelected():false;case"emptytemplate":return(selections.isActive())?selections.isEmptyTemplateSelected():false;case"onepanel":var onePanel=this.queryEnabled("onepanelstack");var src=microstrategy.activeCXMenu;if(src&&src.clickedElement){if(src.clickedElement.className&&src.clickedElement.className.indexOf("title_")>=0){onePanel=false;}}return onePanel;case"onegraph":return(selections.isActive())?selections.isOnlyOneGraphSelected():false;case"oneggrid":return(selections.isActive())?selections.isOnlyOneGGridSelected():false;case"roundShapesOnly":return(selections.isActive())?selections.isOnlyRoundedRectanglesSelected():false;case"shapesOnly":return(selections.isActive())?selections.isOnlyRectanglesSelected():false;case"squareShapesOnly":return(selections.isActive())?selections.isOnlySquareRectanglesSelected():false;case"anyrectangle":return(selections.isActive())?selections.atLeastOneRectangleSelected():false;case"anyRoundedRectangle":return(selections.isActive())?selections.atLeastOneRoundedRectangleSelected():false;case"anycontrol":return(selections.isActive())?selections.atLeastOneControlSelected():false;case"onecontrol":return(selections.isActive())?selections.atLeastOneControlSelected()&&!selections.isMulti():false;case"fmtGridCells":case"oneggridfmt":return microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.queryEnabled("oneggrid")&&!this.queryEnabled("isLinkedGrid")&&!this.queryEnabled("emptytemplate");case"openFormatGraph":case"onegraphfmt":return microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.queryEnabled("onegraph")&&!this.queryEnabled("isLinkedGrid")&&!this.queryEnabled("emptytemplate");case"multiselect":return(selections.isMulti());case"objalign2":case"objsize2":return(selections.isActive());case"toTallest":case"toShortest":return(selections.length-selections.nubmerOfLinesSelected(microstrategy.ORIENTATION_HORIZONTAL)>1);case"toWidest":case"toNarrowest":return(selections.length-selections.nubmerOfLinesSelected(microstrategy.ORIENTATION_VERTICAL)>1);case"Name":case"ToolTip":case"Link":case"IsLink":case"NewWin":case"Visible":case"VisibleHTML":case"LineOrientation":case"Source":case"Left":case"Locked":case"Top":case"Wmode":case"Width":case"LockAspectRatio":case"Length":case"Lmode":case"borderStyle":case"IsPortal":case"PortalState":case"PortalTitle":case"TitleBarDisplay":case"TopCornersOnly":case"HasDropShadow":case"DropShadow":case"HasRoundedCorners":case"HasAlpha":case"HTMLType":case"IFrameSource":case"ShowElementCount":case"ExportOptions":return microstrategy.isEnabled(selections.isVisible&&selections.items,this.qeMap[cmdId]);case"Wmode11":case"Wmode12":case"Wmode13":return this.queryEnabled("Wmode");case"Hmode11":case"Hmode12":case"Hmode13":return this.queryEnabled("Hmode");case"Wmode0":case"Hmode0":return this.queryEnabled(cmdId.substr(0,5));case"Wmode1":case"Hmode1":var enabled=this.queryEnabled(cmdId.substr(0,5));if(enabled){return selections.atLeastOneSubtypeSelected([101]);}return false;case"Wmode2":var enabled=this.queryEnabled(cmdId.substr(0,5));if(enabled){var selectedElem=this.parentBone.selections.getSelectedGrid();if(selectedElem){var bone=microstrategy.findBone(selectedElem);return(bone&&!bone.isGraph);}}return false;case"Hmode2":var enabled=this.queryEnabled(cmdId.substr(0,5));if(enabled){return selections.atLeastOneSubtypeSelected([106,111])||this.queryEnabled("Wmode2");}return false;case"Hmode":case"Height":if(microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){return microstrategy.isEnabled(selections.isVisible&&selections.items,this.qeMap[cmdId]);}else{var selectedElem;if(!(selectedElem=this.parentBone.selections.getSelectedGrid())){selectedElem=this.parentBone.selections.getSelectedPanelStack();}if(selectedElem){var bone=microstrategy.findBone(selectedElem);return bone.commands.queryEnabled(cmdId);}return true;}case"backgroundColor":if(selections.isOnlyOneGridSelected()){oGrid=this.parentBone.selections.getSelectedGrid();targetGrid=microstrategy.findBone(oGrid);if(targetGrid.gridUnitFormat==microstrategy.GRID_BORDERS){return false;}}case"fontWeight":case"fontStyle":case"textDecoration":case"TextDirection":case"fontFamily":case"fontSize":case"textAlign":case"Format":return microstrategy.isEnabled(selections.isVisible&&selections.items,cmdId);case"TextDirectionGrid":return microstrategy.isEnabled(selections.isVisible&&selections.items,"TextDirection");case"borderLeftColor":var b3d=this.queryState("enabled3d");var is3d=(b3d>0);return !is3d&&microstrategy.isEnabled(selections.isVisible&&selections.items,cmdId);case"color":return microstrategy.isEnabled(selections.isVisible&&selections.items,cmdId);case"lineColor":case"borderLeftStyle":case"lineStyle":var b3d=this.queryState("enabled3d");var is3d=(b3d>0);if(this.queryEnabled("onepanelstack")){return !is3d&&microstrategy.findBone(this.queryState("selectedPanelStack")).commands.queryEnabled(cmdId);}else{if(this.queryEnabled("onegrid")){return !is3d&&microstrategy.findBone(this.queryState("selectedGrid")).commands.queryEnabled(cmdId);}else{return !is3d&&microstrategy.isEnabled(selections.isVisible&&selections.items,cmdId)&&!this.queryEnabled("roundShapesOnly");}}case"AutoResize":case"SubWidth":case"ShrinkHorizontal":case"GrowHorizontal":case"MaxHeightWidth":case"SubHeight":case"Shrink":case"Grow":case"HideIfEmpty":case"MaxHeight":case"FitExcelRowHeight":case"Keep":case"Repeat":case"RepeatHoriz":case"NewPage":case"autotext":return(selections.isActive()&&!selections.isMulti());case"borders":if(!selections.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(selections.isOnlyOneGridSelected()){targetGrid=microstrategy.findBone(selections.getSelectedGrid());if(targetGrid&&targetGrid.graphSelected){return false;}if(!selections.isGridContainerSelected()||selections.gridValueFormatX==1){return targetGrid&&targetGrid.commands.queryEnabled(cmdId);}}if(selections.isOnlyOnePanelStackSelected()){return(selections.panelValueFormat!=1);}return(this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_IMAGE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER]));case"setSectionDefaults":return(selections.isActive()&&!selections.isMulti()&&(selections.getFirstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION));case"setCtrlDefaults":return(selections.isActive()&&!selections.isMulti()&&(selections.getFirstObjType()==microstrategy.OBJTYPE_DOC_OBJECT)||(selections.getFirstObjType()==microstrategy.OBJTYPE_DOC_SUBSECTION));case"links":if(selections.isActive()&&!selections.isMulti()&&(selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_IMAGE)||selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT))){var objId=null;var items=this.parentBone.selections.getItems();if(items&&items[0]){objId=items[0].id;}if(objId){var docBone=microstrategy.bone("rwb_viewer");var linkList=docBone.webHyperLinks[objId];return(linkList!=null);}}return false;case"WebHyperLinkEditor":case"showWebHyperLinkEditor":if(selections.isActive()&&!selections.isMulti()){if(selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_IMAGE)||(selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)&&!this.queryState("isButton"))){return true;}else{if(selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEMPLATE)){var gridBone=microstrategy.findBone(selections.firstItem());return(gridBone&&gridBone.commands&&gridBone.commands.queryEnabled(cmdId));}}}return false;case"FilterDetailsProperties":return((selections.length==0)||(selections.isActive()&&!selections.isMulti()&&selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT)))&&!this.queryState("isButton");case"ShowFilterDetailsProperties":return !this.queryState("isButton");case"SubType":return true;case"saveAsTheme":case"applyTheme":return true;case"pasteFormat":if(selections.isActive()&&selections.objCache.copyBuffer!=null&&selections.objCache.copyBuffer.length==1){var item=selections.firstItem();return(item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)!=microstrategy.OBJTYPE_DOC_SUBSECTION&&item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_TEMPLATE)&&!this.queryState("isButton");}return false;case"paste":return(selections.objCache.copyBuffer!=null&&selections.objCache.copyBuffer.length>0);case"edtProps":return selections.enablePropertiesEditor();case"subSectionIsSelected":return(selections.isActive()&&(selections.firstItem().getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION)||(selections.length>0&&selections.isSameSubSection()));case"ssRuler":if(!this.queryEnabled("subSectionIsSelected")){return false;}var b=microstrategy.findBone(selections.firstItem());return(b&&b.subsectionType==mstrSubSection.TYPE_FIXED);case"insertSectionAbove":case"insertSectionBelow":case"mngSections":if(this.queryEnabled("subSectionIsSelected")){var secBone=microstrategy.findBone(selections.firstItem());return(secBone&&secBone.subsectionType==mstrSubSection.TYPE_FIXED&&secBone.parentBone&&!secBone.parentBone.isDetails&&!secBone.isHorizontal);}return false;case"mngHorizontalSections":if(this.queryEnabled("subSectionIsSelected")){var secBone=microstrategy.findBone(this.parentBone.selections.firstItem()).parentBone;if(secBone!=null){return !secBone.isDetails&&secBone.isHorizontal;}}return false;case"edtDMetric":var targetGrid=microstrategy.findBone(selections.getSelectedGrid());if(targetGrid&&!targetGrid.isFeatureAvailable(microstrategy.FEATURE_INSERT_NEW_METRIC)){return false;}case"edtRename":var ob=microstrategy.bone("reportObjs_RWWorkingSetStyle");g=microstrategy.findBone(selections.getSelectedGrid());var notFlash=g&&g.commands.queryState("gridType")!="flash";return(notFlash&&selections.isGridSelected()&&(!selections.isEmptyTemplateSelected())&&!this.queryEnabled("isLinkedGrid"))||(ob&&ob.selections&&ob.selections.isActive());case"vfeRWGrid":return selections.isActive()&&selections.isOnlyOneGridSelected()&&(!dv.noDataset)&&!this.queryEnabled("isLinkedGrid");case"vfeRWView":if(this.queryEnabled("vfeRWGrid")&&selections&&selections.isOnlyOneGridSelected()){var targetGrid=microstrategy.findBone(selections.getSelectedGrid());return(targetGrid&&targetGrid.commands)?targetGrid.commands.queryEnabled(cmdId):false;}else{return false;}case"edtSort":var targetGrid=microstrategy.findBone(selections.getSelectedGrid());return(this.queryEnabled("vfeRWGrid")&&targetGrid&&targetGrid.isFeatureAvailable(microstrategy.FEATURE_EMBEDDED_TEMPLATE_NODE))||this.queryEnabled("edtSortRW");case"deleteSubsection":if(this.queryEnabled("subSectionIsSelected")){var s=microstrategy.findAncestorWithAtt(selections.firstItem(),microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION);var b=microstrategy.findBone(s);return(b&&b.getSubsectionCount()>1);}return false;case"groupProp":var subBone=this.parentBone.selections.getSelectedSubsection();if(subBone){return subBone.parentBone.groupID!=null;}return false;break;case"isSubsectionHorizontal":var subBone=this.parentBone.selections.getSelectedSubsection();if(subBone){return subBone.isHorizontal;}return false;break;case"showOrderCtxMenu":if(selections.isActive()&&!selections.isMulti()){var item=selections.firstItem();if(item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return false;}var s=microstrategy.findAncestorWithAtt(item,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);return(s&&s.childNodes.length>1);}return false;case"hasmetrics":case"comboToggleButton":case"tsubtotals":case"visualizationsEditor":case"visualizationMode":case"quickThresholds":case"openAdvThresholdEditor":case"edtSubtotalsOldIServer":case"addQuickTotals":case"edtSortGridMenu":case"edtSortGrid":case"graphZones":case"gridMode":case"isLinkedGrid":case"visFlashMode":case"visAjaxMode":case"toggleHideNullsOrZeros":if(selections&&selections.isOnlyOneGridSelected()){var targetGrid=microstrategy.findBone(selections.getSelectedGrid());return(targetGrid&&targetGrid.commands)?targetGrid.commands.queryEnabled(cmdId):false;}else{return false;}case"showInsertFunction":return(!this.parentBone.parentBone.noDataset&&!selections.isMulti());case"insertFunctionVisible":return !this.queryState("isButton");case"openConditionalFormattingForHiddenSections":if(!selections||selections.isActive()){return false;}if(!dv.isEditableViewModeEplus()){return false;}return(dv.documentHasMetrics)?dv.documentHasMetrics:false;case"openBasicConditionalFormatting":case"openAdvConditionalFormatting":if(!selections||!dv.isEditableViewModeEplus()){return false;}if(!selections.isActive()||selections.isMulti()){return false;}var item=selections.firstItem();var type=item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(type==null){type=item.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}switch(type){case microstrategy.SUBOBJTYPE_DOC_TEXT:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_SHAPE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:return !dv.noDataset;case microstrategy.OBJTYPE_DOC_SUBSECTION:if(item.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)==microstrategy.TRUE){return false;}return !dv.noDataset;default:return false;}case"showDrillSubmenu":var item=selections.firstItem();return(item&&microstrategy.styleObj.getAttValue(selections.firstItem(),microstrategy.HTMLATTR_OBJINDEX)!=null);case"showDrillPaths":var item=selections.firstItem();return(item&&v.indexOf(item.getAttribute("id")+"|"+item.getAttribute(microstrategy.HTMLATTR_OBJINDEX))>-1);case"showLinkPaths":return !!(selections.items[cmdValue]);case"edtSubtotals":case"edtResize":case"swapAxes":case"autostyle":case"tbanding":case"tOutline":case"ShowThreshold":case"toggleattforms":case"checkMergeColHeader":case"checkMergeRowHeader":case"checkLockColHeader":case"checkLockRowHeader":case"fittocontent":case"fittowindow":case"graphEditor":case"gridEditor":if(!selections.isOnlyOneGridSelected()){return false;}var grid=microstrategy.findBone(selections.firstItem());return(grid&&grid.commands&&grid.commands.queryEnabled(cmdId));case"openSimpleThresholdEditor":case"openAdvThresholdEditor":if(!selections.isOnlyOneGridSelected()){return false;}var grid=microstrategy.findBone(selections.firstItem());return(grid&&grid.commands&&grid.commands.queryEnabled(cmdId)&&!this.queryEnabled("isLinkedGrid"));case"autoArrange":if(this.parentBone.selections&&this.parentBone.selections.isOnlyOneGridSelected()){var targetGrid=microstrategy.findBone(this.parentBone.selections.getSelectedGrid());if(targetGrid&&targetGrid.isGraph){var graphBone=microstrategy.bone(targetGrid.id+"_gb");return(graphBone)?!graphBone.autoArrange:true;}else{return false;}}else{return false;}break;case"generalTabEnabled":case"layoutSectionsTabEnabled":return dv.isEditableViewModeEplus()&&!dv.IsNavigationDocument;case"layoutTabEnabled":return dv.isEditableViewModeEplus()&&!this.queryState("isNavBar")&&!selections.isItemInsideNavBar();case"buttonTabEnabled":return this.queryState("onlyButtons");case"themeTabEnabled":return !selections.isMulti();case"colorTabEnabled":if(this.queryState("appliedLinkedTheme")){return false;}if(this.queryState("isButton")){var buttons=selections.getSelectedButtons();for(var b in buttons){if(microstrategy.styleObj.getAttValue(buttons[b],microstrategy.HTMLATTR_DISPLAY_STYLE)==microstrategy.BUTTON_STYLE_CUSTOM){return false;}}}return this.parentBone.parentBone.gridGraphFormatting&&!selections.isItemInsideNavBar();case"fontTabEnabled":if(this.queryState("appliedLinkedTheme")){return false;}if(selections.isOnlyOnePanelStackSelected()){return selections.isOnlyOneTableSelected()?true:this.queryState("IsPortal");}else{if(this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE])){return this.queryState("IsPortal")||this.queryEnabled("fontAndAlignmentEnabled");}else{if(this.queryState("isButton")){var buttons=selections.getSelectedButtons();for(var b in buttons){var buttonStyle=microstrategy.styleObj.getAttValue(buttons[b],microstrategy.HTMLATTR_DISPLAY_STYLE);if(buttonStyle==microstrategy.BUTTON_STYLE_ICON_ONLY||buttonStyle==microstrategy.BUTTON_STYLE_CUSTOM){return false;}}}if(selections.isItemInsideNavBar()){return false;}return((this.parentBone.parentBone.gridGraphFormatting&&this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]))||this.queryEnabled("fontAndAlignmentEnabled"));}}case"fontAndAlignmentEnabled":var fEnabled=this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER]);return(fEnabled||this.queryEnabled("showGridFormatTabs"))&&this.parentBone.parentBone.gridGraphFormatting;case"alignmentTabEnabled":return !this.queryState("appliedLinkedTheme")&&this.queryEnabled("fontAndAlignmentEnabled")&&!this.queryState("isButton");case"numberTabEnabled":return(!this.queryState("appliedLinkedTheme")&&(this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT])||this.queryEnabled("showGridFormatTabs"))&&mstr.behaviors.featureResolver.featAvailable("number-formatting")&&!this.queryState("isButton"));case"imageTabEnabled":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_IMAGE]);case"lineTabEnabled":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"gridTabEnabled":return selections.isOnlyOneGridSelected();case"advancedTabEnabled":return dv.isEditableViewModeEplus()&&(selections.isOnlyOneGridSelected()||selections.isOnlyOnePanelStackSelected()||selections.isOnlyOneSelectorCtrlSelected())&&!this.queryState("isNavBar")&&!selections.atLeastOneTableSelected();case"flashTabEnabled":return dv.isEditableViewModeEplus()&&(this.queryEnabled("gridTabEnabled")||this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]));case"widgetTabEnabled":return dv.isEditableViewModeEplus()&&(this.queryEnabled("gridTabEnabled"));case"selectorTabEnabled":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL])||selections.isOnlyOneTableSelected()||this.queryState("isDDIC");case"effectsTabEnabled":return !this.queryState("appliedLinkedTheme")&&dv.isEditableViewModeEplus()&&!this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_SUBSECTION])&&this.parentBone.parentBone.gridGraphFormatting&&!this.queryState("isButton")&&!this.queryState("isNavBar")&&!selections.atLeastOneTableSelected();case"showGridFormatTabs":return(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE])&&this.queryEnabled("enableGridFormat")&&this.queryState("isOneGrid")&&selections.getSelectedGrid()&&microstrategy.findBone(selections.getSelectedGrid()).isGrid&&!this.queryEnabled("isLinkedGrid"));case"showGridSelectors":return(this.queryEnabled("showGridFormatTabs")&&this.queryState("isOneGrid"));case"showPanelSelector":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK])&&!this.queryState("isNavBar");case"Autostyle":if(!selections.isOnlyOneGridSelected()){return false;}var grid=microstrategy.findBone(selections.firstItem());return(grid&&grid.commands&&grid.commands.queryEnabled("autostyle"));case"AllStyle":case"AllColor":case"LeftStyle":case"LeftColor":case"RightStyle":case"RightColor":case"TopStyle":case"TopColor":case"BottomStyle":case"BottomColor":return !this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_SUBSECTION]);case"RwdUnits":return this.queryEnabled("isNotLinkedGraph");case"tbValueSelector":if(this.queryEnabled("onepanelstack")){return(this.queryState("IsPortal")&&selections.panelUnitFormat!=1);}case"tbGridValueSelector":if(selections.getSelectedGridProperty("isGraph")){return true;}switch(parseInt(selections.gridUnitFormatX,10)){case microstrategy.GRID_UNIT_CONTAINER:return this.queryState("IsPortal");case microstrategy.GRID_BORDERS:return false;default:return true;}case"Bold":case"Italic":case"Underline":case"FontFamily":case"FontSize":case"TextAlign":case"GridHorizontal":case"FontColor":case"Currency":case"IntlCurrency":case"Percent":case"Comma":case"IncreaseDecimal":case"DecreaseDecimal":if(!selections.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(!this.parentBone.selections.getSelectedGridProperty("graphSelected")){var isFormatCtrl=("|FontFamily|FontSize|Bold|Italic|Underline|TextAlign|GridHorizontal|FontColor|".indexOf("|"+cmdId+"|")>-1);var enabledObjTypes=[microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT];if(isFormatCtrl){enabledObjTypes.push(microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER);if(cmdId!="TextAlign"&&cmdId!="GridHorizontal"){enabledObjTypes.push(microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);}}if(this.ensureSelectedObjectTypes(enabledObjTypes)){return true;}var titleBarCtrls="|FontFamily|FontSize|Bold|Italic|Underline|FontColor|";if(selections.isOnlyOnePanelStackSelected()){if(selections.panelValueFormat==0){return false;}return(titleBarCtrls.indexOf("|"+cmdId+"|")>-1);}if(selections.isOnlyOneGridSelected()){if(selections.gridUnitFormatX==microstrategy.GRID_BORDERS){return false;}if(selections.isGridContainerSelected()){if(selections.gridValueFormatX==1){return false;}return((titleBarCtrls+"TextAlign|").indexOf("|"+cmdId+"|")>-1);}else{if(isFormatCtrl&&!this.queryState("areGridFormatsReady")){return false;}}}else{if(selections.isMulti()&&!!selections.getSelectedGrid()){return((titleBarCtrls+"TextAlign|Currency|IntlCurrency|Percent|Comma|IncreaseDecimal|DecreaseDecimal|").indexOf("|"+cmdId+"|")==-1);}}}targetGrid=microstrategy.findBone(selections.getSelectedGrid());if(!targetGrid){return false;}return targetGrid.commands.queryEnabled(cmdId,cmdValue);case"FillColor":if(!selections.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(selections.isOnlyOneGridSelected()){if(selections.isGridContainerSelected()){return true;}targetGrid=microstrategy.findBone(selections.getSelectedGrid());if(!targetGrid){return false;}return targetGrid.commands.queryEnabled(cmdId,cmdValue);}return(!this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]));case"showFlashOnlyForSelector":case"showFlashOnlyForFillColorSelector":return true;case"Borders":return(selections.isActive()&&!this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_SUBSECTION]));case"lnstyle":case"lncolor":if(!selections.isActive()||!this.queryEnabled("isNotLinkedGraph")||this.queryState("appliedLinkedTheme")){return false;}if(this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_SUBSECTION])||this.queryState("enabled3d")){return false;}if(selections.isOnlyOneGridSelected()){targetGrid=microstrategy.findBone(selections.getSelectedGrid());if(targetGrid&&targetGrid.graphSelected&&targetGrid.isGraph){return targetGrid.commands.queryEnabled(cmdId,cmdValue);}switch(parseInt(selections.gridUnitFormatX,10)){case microstrategy.GRID_UNIT_CONTAINER:return(selections.gridValueFormatX!=2);case microstrategy.GRID_BORDERS:return true;default:if(!targetGrid){return false;}return targetGrid.commands.queryEnabled(cmdId,cmdValue);}}if(selections.isOnlyOnePanelStackSelected()){return(selections.panelValueFormat!=1);}return true;case"AlignLeft":case"AlignCenter":case"AlignRight":return selections.isMulti()&&(selections.isSameSubSection()||!selections.hasHorizSections());case"AlignTop":case"AlignMiddle":case"AlignBottom":return selections.isMulti()&&(selections.isSameSubSection()||selections.hasHorizSections(true));case"DistHoriz":return selections.length>2&&(selections.isSameSubSection()||!selections.hasHorizSections());case"DistVert":return selections.length>2&&(selections.isSameSubSection()||selections.hasHorizSections(true));case"back":case"front":case"oneBack":case"oneFront":var sec=this.queryState("selectedSection");return(selections.isActive()&&!selections.isMulti()&&selections.getFirstObjType()!=microstrategy.OBJTYPE_DOC_SUBSECTION&&sec&&sec.childNodes&&sec.childNodes.length>1);case"b3dstyle":case"b3dweight":case"enabled3d":var selectedLines=selections.nubmerOfLinesSelected(microstrategy.ORIENTATION_HORIZONTAL)+selections.nubmerOfLinesSelected(microstrategy.ORIENTATION_VERTICAL);if(selections.length==selectedLines){return false;}return selections.isActive();case"Transparency":case"Blur":return microstrategy.isEnabled(selections.isVisible&&selections.items,"Transparency");case"gridSelectedVisualization":if(!selections||!selections.isOnlyOneGridSelected()){return false;}var g=microstrategy.findBone(selections.getSelectedGrid());return(g&&g.commands)?g.commands.queryEnabled("selectedVisualization"):false;case"transactionEdit":return(selections.getTransactionUnitKey()!=null&&!this.queryState("isButton"))||selections.isOnlyOneTableSelected();case"transactionCondition":if(selections&&selections.isOnlyOneGridSelected()){var g=microstrategy.findBone(selections.getSelectedGrid()),tscObjs=g&&g.tscObjs||[],len=tscObjs.length,i;for(i=0;i<len;++i){if(tscObjs[i].edt){return true;}}return false;}return(selections.getTransactionUnitKey()!=null&&!this.queryState("isButton")&&!selections.isOnlyOneGridSelected())||this.queryState("isActionSelector");case"DisplayInPartialScreen":case"InitialSlidingInWidth":case"InitialSlidingInHeight":case"ShowAsCollapsiblePanel":return microstrategy.isEnabled(selections.isVisible&&selections.items,cmdId);case"activeSelections":default:return selections.isActive();}}catch(err){microstrategy.errors.log(err);return false;}};mstrDocCommandsImpl.prototype.queryState=function(cmdId,allPanels){try{var b=null;var item=null;var name=null;var dv=this.parentBone.parentBone;var cnt,lp;var cmd=cmdId.split(";");if(cmd.length==2&&cmd[0]=="tc"){var tcbone=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());return tcbone&&tcbone.queryState&&tcbone.queryState(cmd[1]);}var adjustTableFormat=function(sel,tab){var uf=parseInt(sel.panelUnitFormat),vf=parseInt(sel.panelValueFormat);if(tab=="font"){if(uf<2||uf>3){sel.panelUnitFormat=2;}if(uf==2){sel.panelValueFormat=1;}if(uf==3&&(vf<1||vf>3)){sel.panelValueFormat=1;}}else{if(tab=="color"){sel.panelUnitFormat=0;sel.panelValueFormat=0;}}};switch(cmdId){case"showEditorSelector":return !this.queryState("isNavBar");case"controlInclude":var ctl=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());return ctl.include;case"allowRemoveExtraColumn":return this.parentBone.parentBone.isFeatureAvailable("grid-layout");case"objBrowser":b=microstrategy.bone("reportObjs_RWWorkingSetStyle");return(b&&isInDocument(b.elem));case"groupBy":b=microstrategy.bone("pbb_GroupByStyle");return(b&&isInDocument(b.elem));case"relatedReports":b=microstrategy.bone("relatedReports");return(b&&isInDocument(b.elem));case"grid":return this.parentBone.gridOn;case"rulers":return this.parentBone.rulerOn;case"panelTb":return(this.parentBone.currentControl=="cursor");case"PageWidth":case"PageHeight":case"MarginLeft":case"MarginTop":case"MarginRight":case"MarginBottom":case"minimumPrintArea":lp=(this.parentBone.docPropsMap[cmdId]&&this.parentBone.docPropsMap[cmdId].l)||cmdId;return microstrategy.number.toUserUnits(dv[lp]);case"Autowire":case"CtlAutoSubmit":lp=(this.parentBone.docPropsMap[cmdId]&&this.parentBone.docPropsMap[cmdId].l)||cmdId;return dv[lp];case"ScalePagesWide":case"ScalePagesTall":var v=dv[cmdId];if(v==0||v=="0"){v="";}return v;case"PaperType":case"PaperOrientation":case"Scaling":case"ScalePercentage":case"ScalePageHeaderFooter":case"SectionHorizontalOverflow":case"LayoutFillColor":case"LayoutLeftStyle":case"LayoutLeftColor":case"LayoutTopStyle":case"LayoutTopColor":case"LayoutRightStyle":case"LayoutRightColor":case"LayoutBottomStyle":case"LayoutBottomColor":case"RenderConditionalFormatting":case"DefaultGridStyle":case"showDisplayModes":case"ExecutionFullScreenMode":case"ShowingBarsTemporarily":case"DefaultSelectorsAsFilter":case"PreserveTranslations":case"ShowFloatingToolbars":case"ViewModeInteractivityLevel":case"CalculateDocWidth":case"DefaultViewMode":case"DefaultPageByExportMode":case"ExportRange":case"ExcelGraphFormat":case"EmbeddedFonts":case"MobileDataView":case"UseOneSheetPerLayout":case"UseOneSheetPerGroupElement":case"PromptUserForPagebyExport":case"ExcelEmbedImages":case"IncludeBookmarks":case"ShowBookmarks":case"EmbedFonts":case"GraphFormat":case"GraphQualityDPI":case"isMultiLayout":case"multiLayoutMode":case"EnableToc":case"BeforeLayout":case"BeforeLayoutItems":case"TOCTitle":case"TabLeader":case"TOCFontName":case"TOCFontSize":case"TOCFontStrikeout":case"TOCFontUnderline":case"TOCFontColor":case"WatermarkType":case"WatermarkText":case"WatermarkFontName":case"WatermarkFontSize":case"WatermarkFontStrikeout":case"WatermarkFontUnderline":case"WatermarkFontColor":case"AutoFontSize":case"TextWashout":case"TextOrientation":case"ImageSource":case"ImageScale":case"ShowTabsForSingleLayout":case"RemoveNullGroups":case"RemoveMissingUnits":case"SingleSourceGrid":case"RWLevelMCEJoin":case"TrimNoSectionData":case"PreLoadAllPanels":case"SupportedOrientations":case"FitPDFContentHeight":case"DisplayPageByBar":case"DisplayRePromptIcon":case"UseAsInfoWindow":case"layoutBarStyle":case"layoutBarPosition":case"enableGraphTooltips":case"IncludePageHeaderFooter":case"EnableExport":case"ExcelExportDocumentURL":case"PDFExportDocumentURL":case"EnableZoom":case"DocumentThemeColor":case"EnableSwipingToSwitchLayout":case"EnableInherit":case"TOCFillColor":case"TOCTitleAlignment":case"TOCTitleFontName":case"TOCTitleFontSize":case"TOCTitleFontUnderline":case"TOCTitleFontStrikeout":case"TOCTitleFontColor":case"TOCTitleFillColor":case"TOCTitleEnableInherit":case"TOCLeftIndent":case"TOCRightIndent":case"TOCBorderStyle":case"TOCBorderColor":case"TOCBorderWeight":case"EnableCopyForText":case"EnableCopyForGridCell":case"SmartClientDoc":case"OfflineOnCube":case"ShowOfflineUCOnCubeConfig":case"KeepControlTargetsConsistent":return dv[cmdId];case"isNavigationDocument":return !!dv.IsNavigationDocument;case"RefreshDocument":return dv[cmdId]!=undefined?dv[cmdId]:dv.RefreshFrequency>=1;case"RefreshFrequency":var rf=dv[cmdId];return rf>1?rf:(rf==-1?30:rf);case"ApplyGBToAllLayouts":return dv[cmdId]==2;case"WatermarkFontBoldItalic":var bi=0;if(dv.WatermarkFontBold){bi+=1;}if(dv.WatermarkFontItalic){bi+=2;}return bi;case"TOCFontBoldItalic":var bi=0;if(dv.TOCFontBold){bi+=1;}if(dv.TOCFontItalic){bi+=2;}return bi;case"TOCTitleFontBoldItalic":var bi=0;if(dv.TOCTitleFontBold){bi+=1;}if(dv.TOCTitleFontItalic){bi+=2;}return bi;case"TOCTitleSetEnable":return this.queryState("EnableToc")&&(!(this.queryState("TOCTitleEnableInherit")));case"TOCBorderStyleEnable":return this.queryState("EnableToc")&&(dv.TOCBorderStyle!="0");case"AvailableViewModeItems":case"AvailableDefaultRunModesItems":case"AvailableExportModeItems":return dv[cmdId];case"AvailableViewModes":case"AvailableExportModes":var modes=(cmdId=="AvailableViewModes")?[mstr.Enum.VIEWMEDIA.STATIC,mstr.Enum.VIEWMEDIA.INTERACTIVE,mstr.Enum.VIEWMEDIA.EDITABLE,mstr.Enum.VIEWMEDIA.FLASH]:[mstr.Enum.VIEWMEDIA.EXPORT_EXCEL,mstr.Enum.VIEWMEDIA.EXPORT_PDF,mstr.Enum.VIEWMEDIA.EXPORT_HTML,mstr.Enum.VIEWMEDIA.EXPORT_FLASH];var __result=[];var available=dv.AvailableViewModes;for(var i=0;i<modes.length;i++){if((modes[i]&available)>0){__result.push(modes[i]);}}return __result;case"MakePrivate":return(dv.AvailableViewModes&mstr.Enum.VIEWMEDIA.PRIVATE)>0;case"LayoutBorderStyle":var fn={viewer:dv,getValue:function(obj,prop){return this.viewer[prop];}};return this.parentBone.checkBorderProperties(null,fn,"Layout","Style","Color");case"LayoutAllStyle":return this.queryState("LayoutLeftStyle");case"LayoutAllColor":return this.queryState("LayoutLeftColor");case"sectionsList":var sections=dv[cmdId];var __result=new Array(sections.length);for(var i=0;i<sections.length;i++){__result[i]={dssid:sections[i].d,n:sections[i].n,v:sections[i].v};}return __result;case"dockableSectionsList":var sections=dv.sectionsList;var __result=[];for(var i=0;i<sections.length;i++){if(sections[i].t==6||sections[i].t==7){__result.push({dssid:sections[i].d,n:sections[i].n,v:sections[i].v});}}return __result;case"VisibleSections":var sections=dv.sectionsList;var __result=[];for(var i=0;i<sections.length;i++){if(sections[i].v){__result.push(sections[i].d);}}return __result;case"DockedSections":var sections=dv.sectionsList;var __result=[];for(var i=0;i<sections.length;i++){if(sections[i].dc&&(sections[i].t==6||sections[i].t==7)){__result.push(sections[i].d);}}return __result;case"showDisplayModes":return dv.isFeatureAvailable(microstrategy.FEATURE_CHECK_DESIGN_MODE)||dv.isFeatureAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE);case"incrFetchEnabled":return dv.ifSettings.enabled;case"incrFetchBlockCount":return dv.ifSettings.blockCount;case"incrFetchLevels":return dv.ifSettings.levels;case"incrFetchCurLevel":return dv.ifSettings.curLevel;case"cursor":return !this.parentBone.currentControl||this.parentBone.currentControl==cmdId;case"lock":return this.parentBone.parentBone.insertionControlLocked;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:case microstrategy.GRAPH_CTL:case microstrategy.BUTTON_CTL:case microstrategy.SUBOBJTYPE_DOC_WIDGET:case microstrategy.SUBOBJTYPE_DOC_SHAPE:return this.parentBone[cmdId];case microstrategy.SUBOBJTYPE_DOC_LINE:case microstrategy.SUBOBJTYPE_DOC_IMAGE:case microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER:case microstrategy.SUBOBJTYPE_DOC_TEXT:return this.parentBone.currentControl==cmdId;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:return this.parentBone.currentControl==cmdId&&!this.parentBone.currentControlSubtype;case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|FP":return this.parentBone.currentControl==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&this.parentBone.currentControlSubtype=="FP";case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK+"|TC":return this.parentBone.currentControl==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK&&this.parentBone.currentControlSubtype=="TC";case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:return this.parentBone.currentControl==cmdId.split("|")[0]&&this.parentBone.currentControlSubtype!="R";case microstrategy.SUBOBJTYPE_DOC_REPORT_TEMPLATE:return this.parentBone.currentControl==cmdId.split("|")[0]&&this.parentBone.currentControlSubtype==cmdId.split("|")[1];}if(!this.parentBone.selections){return null;}var selections=this.parentBone.selections;var selectedItems=selections.items;var grid=null;var formatType=(selections.useGridFormat(false))?selections.getGridFormatInfo(false):microstrategy.formatType;if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(cmdId)){if(!selections||!selections.isOnlyOneGridSelected()){return false;}var g=microstrategy.findBone(selections.getSelectedGrid());g=(g instanceof mstrReportGraphImpl)?g:microstrategy.bone(g.id+"_graph");if(cmdId=="seriesAreaFormatField_visible"){return(g&&g.commands)?g.commands.queryState(cmdId,allPanels):false;}return(g&&g.commands)?g.commands.queryState(cmdId):false;}switch(cmdId){case"showSelectionColor":for(var i in selectedItems){var item=selectedItems[i];var subType=item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(subType==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){if(item.lastChild){var ctlBone=microstrategy.bone(item.lastChild.id);if(ctlBone&&ctlBone.ctlStyle!=mstrRWControlImpl.CTL_STYLE_POOL_DOWN&&ctlBone.ctlStyle!=mstrRWControlImpl.CTL_STYLE_LIST_BOX&&ctlBone.ctlStyle!=mstrRWControlImpl.CTL_STYLE_LINK_ARRAY||ctlBone&&ctlBone.ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION||this.queryState("edtValueSelector").value==mstrRWControlImpl.FMT_TYPE_TITLE_BASE){return false;}}}else{if(subType==microstrategy.SUBOBJTYPE_DOC_TEMPLATE&&microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN){var g=microstrategy.findBone(selections.getSelectedGrid());if(!g||!g.isGrid||g.gridUnitFormat!=microstrategy.GRID_UNIT_CONTAINER){return false;}}else{return false;}}}return true;case"showFlashOnlyForSelector":case"showFlashOnlyForFillColorSelector":for(var i in selectedItems){var item=selectedItems[i];var subType=item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(subType!=microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL||this.queryState("edtValueSelector").value==mstrRWControlImpl.FMT_TYPE_TITLE_BASE){return false;}if(item.lastChild){var ctlBone=microstrategy.bone(item.lastChild.id);if(ctlBone&&ctlBone.ctlStyle!=mstrRWControlImpl.CTL_STYLE_POOL_DOWN&&(ctlBone.ctlStyle!=mstrRWControlImpl.CTL_STYLE_LIST_BOX||cmdId=="showFlashOnlyForFillColorSelector")){return false;}}}return true;case"selectedItems":return this.parentBone.selections.items;case"selectedTextField":if(this.parentBone.selections.isMulti()){return null;}item=this.parentBone.selections.firstItem();if(item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT){return item;}else{return null;}break;case"RwdUnits":var rwdUnits={items:[],value:""};if(!selections.isActive()||!selections.isVisible){rwdUnits.items.push({dssid:"",n:microstrategy.descriptors.getDescriptor("3520")});}else{if(selections.isMulti()){rwdUnits.items.push({dssid:"",n:microstrategy.descriptors.getDescriptor("3574")});}else{rwdUnits.value=selections.firstItem().getAttribute("id");}}var unsortedUnits=[];var pb=this.parentBone;for(var id in pb.formattingAttributes){var item=pb.formattingAttributes[id];if(item.nm==undefined||item.clip||item.deleted){continue;}var cont=false;if(item.ty==microstrategy.OBJTYPE_DOC_SUBSECTION){cont=true;for(var sec in pb.sections){var ss=pb.sections[sec].subsections;if(ss&&id in ss){cont=false;break;}}}if(cont){continue;}unsortedUnits.push({dssid:id,n:pb.formattingAttributes[id].nm,cssClass:"ToolbarList T"+item.ty});}unsortedUnits=unsortedUnits.sort(function(a,b){if(a.n<b.n){return -1;}if(a.n>b.n){return 1;}return 0;});rwdUnits.items=rwdUnits.items.concat(unsortedUnits);return rwdUnits;case"units":var units=new Object();for(var i in this.parentBone.formattingAttributes){if(document.getElementById(i)){units[i]=this.parentBone.formattingAttributes[i];}}return units;case"unit":var id=-1;var sty=null;var styst=null;if(!selections.isActive()||!selections.isVisible){name=microstrategy.descriptors.getDescriptor("3520");}else{if(selections.isMulti()){name=microstrategy.descriptors.getDescriptor("3574");}else{item=selections.firstItem();name=microstrategy.styleObj.getAttValue(item,microstrategy.HTMLATTR_NAME);id=item.id;if(item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){sty=microstrategy.OBJTYPE_DOC_SUBSECTION;}else{sty=item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}}}switch(sty){case microstrategy.SUBOBJTYPE_DOC_SHAPE:if(item.getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){styst=microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND;}break;case microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL:styst=microstrategy.styleObj.getAttValue(item,"styst");break;}return{name:name,id:id,sty:sty,styst:styst};case"selected":case"SubType":if(!selections.isActive()||!selections.isVisible){return microstrategy.descriptors.getDescriptor("3520");}if(selections.isMulti()){return microstrategy.descriptors.getDescriptor("3574");}item=selections.firstItem();if(item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return microstrategy.descriptors.getDescriptor("3580");}var subType=item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);switch(subType){case microstrategy.SUBOBJTYPE_DOC_TEMPLATE:var bone=microstrategy.findBone(item);if(bone&&bone.commands){return bone.commands.queryState("selected");}case microstrategy.SUBOBJTYPE_DOC_PANEL_STACK:var ifp=this.getCommonBoneProperty(selectedItems,"isFilterPanel",microstrategy.SUBOBJTYPE_DOC_PANEL_STACK),inb=this.getCommonBoneProperty(selectedItems,"isNavigationBar",microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(ifp){return microstrategy.descriptors.getDescriptor("8966");}else{if(inb){return microstrategy.descriptors.getDescriptor("8145");}else{return microstrategy.descriptors.getDescriptor(this.rwObjNameMap[microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]);}}case microstrategy.SUBOBJTYPE_DOC_TEXT:if(this.queryState("isButton")){return microstrategy.descriptors.getDescriptor("6457");}default:return microstrategy.descriptors.getDescriptor(this.rwObjNameMap[subType]);}case"Link":var href=this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_LINK_HREF,"link");if(href==null||href==""||href.length==0){href="http://";}return href;case"EditFieldTargetInfoWin":return this.getCommonAttValue(selectedItems,"ifw","InformationWindowTarget");case"IFrameSource":var iFrameSource=this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_HTML_SOURCE,"url");if(iFrameSource==null||iFrameSource==""||iFrameSource.length==0){iFrameSource="http://";}return iFrameSource;case"ToolTip":var tt=this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_TOOLTIP_FORMULA,"title");return(tt!=null)?tt:"";case"HTMLType":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_HTML_TYPE,"htmlType");case"IsPortal":var item=selections.firstItem();var tp=item.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var stp=item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(tp==microstrategy.OBJTYPE_DOC_OBJECT&&stp==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){return false;}return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,"showTitleBar")=="-1");case"ShowWidgetTitleBar":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_WIDGET_SHOW_WINDOW_TITLE,"ShowWidgetTitleBar")=="-1");case"UseAsInformationWindow":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_USE_AS_INFORMATION_WINDOW,"UseAsInformationWindow")=="-1");case"InformationWindowPlacement":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_INFO_WIN_PLACEMENT,"InformationWindowPlacement");case"InfoWindowMode":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_INFO_WIN_MODE,"InfoWindowMode");case"TabCloseToDismissInfoWindow":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_TAB_CLOSE_TO_DISMISS_INFOWIN,"TabCloseToDismissInfoWindow")=="-1");case"InfoWindowPosition":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_INFO_WIN_POSITION,"InfoWindowPosition");case"InfoWindowPositionEnabled":return this.queryState("UseAsInformationWindow")&&(this.queryState("InfoWindowMode")==4);case"TextCopyMode":case"GridCellCopyMode":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_IOS_COPY_MODE,"CopyMode");case"UseAsTableControl":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_USE_AS_TABLE_CONTROL,"UseAsTableControl")=="-1");case"ResetToFirstPanelWhenTargeted":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_RESET_TO_FIRST_PANEL_WHEN_TARGETED,"ResetToFirstPanelWhenTargeted")=="-1");case"EnableHorizontalSwipeToChange":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_HORIZONTAL_SWIPE_CHANGE,"EnableHorizontalSwipeToChange")=="-1");case"SwipePanelStyle":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_STYLE_FOR_SWIPE_PANEL,"StyleForSwitchingPanel");case"TitleBarDisplay":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY,"titleBarDisplay");case"panelCustomTitle":return this.queryState("IsPortal")&&this.queryState("TitleBarDisplay")=="1";case"PortalTitle":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_WINDOW_TITLE,"windowTitle");case"ShowElementCount":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_CTL_SHOW_ELEMENT_COUNT,"showElementCount")!="0";case"SetBadgeToValueOnField":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_SET_BADGE_TO_VALUE_ON_FIELD,"SetBadgeToValueOnField")=="-1";case"PortalState":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_WINDOW_STATE,"windowState");case"ExportOptions":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_EXPORT_OPTION,"exportOptions");case"IsLink":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_IS_LINK,"isLink")=="-1");case"HasDropShadow":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT,"dropShadowEffect")!="0";case"DropShadow":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_DROP_SHADOW,"dropShadowDepth");case"HasRoundedCorners":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_ROUNDED_CORNERS,"hasRoundedCorners")!="0";case"Radius":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_TOPLEFT_CORNER_RADIUS,"topLeftCornerRadius");case"TopCornersOnly":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_BOTTOMLEFT_CORNER_RADIUS,"bottomLeftCornerRadius")=="0";case"Alpha":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_ALPHA,"alphaOpacity");case"HasAlpha":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_ALPHA_EFFECT,"alphaEffect")!="0";case"Name":name=this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_NAME,"name");return(name!=null&&name.length>0)?name:microstrategy.descriptors.getDescriptor("3574");case"NewWin":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_NEW_WINDOW,"newWin")=="-1");case"Visible":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_VISIBLE,"visibility")=="-1");case"VisibleHTML":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_VISIBLE_HTML_VIEW_MODE,"showInHTMLViewMode")=="-1");case"LockAspectRatio":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_LOCK_ASPECT_RATIO,"lockAspectRatio")==microstrategy.TRUE;case"Category":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_NUMBER_FORMAT_CATEGORY,cmdId,null,formatType);case"DecimalPlaces":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_NUMBER_FORMAT_DECIMAL_PLACES,cmdId,null,formatType);case"ThousandSeparator":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_NUMBER_FORMAT_THOUSAND_SEPARATOR,cmdId,null,formatType);case"CurrencySymbol":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_SYMBOL,cmdId,null,formatType);case"CurrencyPosition":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_NUMBER_FORMAT_CURRENCY_POSITION,cmdId,null,formatType);case"NegativeNumbers":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_NUMBER_FORMAT_NEGATIVE_NUMBERS,"NegativeNumbers",null,formatType);case"enableRed":return !selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT);case"textfieldSelected":return !selections.isItemOfTypeSelected(microstrategy.SUBOBJTYPE_DOC_TEXT);case"Format":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_NUMBER_FORMAT_STRING,cmdId,null,formatType);case"Source":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_IMAGE_SOURCE,"src");case"Overflow":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_GRID_OVERFLOW,0);case"TextOverflow":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_TEXT_OVERFLOW,0);case"ExportOverflow":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_GRID_EXPORT_OVERFLOW,0);case"QuickSwitch":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE])&&this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_QUICK_SWITCH)==microstrategy.TRUE;case"SizeMode":return this.getCommonAttValue(selectedItems,"sm");case"LineOrientation":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_ORIENTATION,"orientation");case"selectionsKey":return selections&&selections.getSelectionsKey();case"selectedGrid":return selections&&selections.getSelectedGrid();case"selectedPanelStack":return selections&&selections.getSelectedPanelStack();case"userMetricSelected":var ob=microstrategy.bone("reportObjs_RWWorkingSetStyle");if(ob){var s=ob.selections;if(s.isActive()){var oUserMetric=s.firstItem();if(oUserMetric){return oUserMetric;}}}break;case"selectedContainer":if(selections.length==1){item=selections.firstItem();var tp=item.getAttribute(microstrategy.HTMLATTR_OBJTYPE);var stp=item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);if(tp==microstrategy.OBJTYPE_DOC_OBJECT&&stp==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK){var psBone=microstrategy.findBone(item);var panel=psBone.getCurrentPanel();return panel.elem;}}case"selectedSection":if(this.queryEnabled("subSectionIsSelected")){item=selections.firstItem();if(item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_SUBSECTION){return item;}else{if(selections.isSameSubSection()){return item.parentNode;}}}break;case"isOnGrid":case"getRowHeight":case"getGridWidthsObj":case"selectedGrid":case"tbanding":case"gridMode":case"graphMode":case"gridGraphMode":case"checkLockRowHeader":case"checkLockColHeader":case"checkMergeRowHeader":case"checkMergeColHeader":case"comboToggleButton":case"tsubtotals":case"checkSubtotals":case"tOutline":case"checkBanding":case"enableLegends":case"enableLabels":case"allowedGraphTypes":case"styleName":case"target":case"level":case"autostyle":case"ShowThreshold":case"toggleattforms":case"fittocontent":case"fittowindow":case"objBrowser":case"pageBy":case"reportFilter":case"viewFilter":case"formatToolbar":case"promptDetails":case"visualizationMode":case"RHS":case"RHM":case"RHL":case"CHS":case"CHM":case"CHL":case"Outline":case"Banding":case"AttForms":case"ShowThreshold":case"TitleOverlap":case"ShowDrillingOptions":case"DrillOptions":case"enableAttForms":case"enableThresholds":case"isShowHeadersAvailable":case"isMergeHeadersAvailable":case"isLockHeadersAvailable":case"isNonLinkedTemplate":case"isGridFormattingEnabled":case"XTabView":case"XTabViewDHTML":case"Shortcut":case"GraphExportOverflow":case"GraphExportOverflowSpacing":case"visFlashMode":case"visAjaxMode":case"HideNullsOrZeros":case"HideNullZeroValues":case"toggleHideNullsOrZeros":if(!selections||!selections.isOnlyOneGridSelected()){return false;}var g=microstrategy.findBone(selections.getSelectedGrid());return(g&&g.commands)?g.commands.queryState(cmdId):false;case"assoNodesDrill":if(!selections||!selections.isOnlyOneGridSelected()){return false;}var g=microstrategy.findBone(selections.getSelectedGrid()),_assoNKs=(g&&g.commands)?g.commands.queryState(cmdId):false,_syncAssos=[];var availNodes=this.queryState("availAssoNodes");if(_assoNKs){for(var i=0;i<_assoNKs.length;i++){var idx=mstr.utils.Arrays.findByForm(availNodes,_assoNKs[i],"dssid",false);if(idx>-1){_syncAssos.push(availNodes[idx]);}}}return _syncAssos;case"DataSource":if(!selections||!selections.isOnlyOneGridSelected()){return false;}var g=microstrategy.findBone(selections.getSelectedGrid()),_ds=(g&&g.commands)?g.commands.queryState(cmdId):false;return _ds;case"FillColor_vf":case"lncolor_vf":var orgVf=(cmdId=="FillColor_vf")?15:10;if(!selections||!selections.isOnlyOneGridSelected()){return orgVf;}g=microstrategy.findBone(selections.getSelectedGrid());return(g&&g.commands)?g.commands.queryState(cmdId):orgVf;case"hasNoTargets":if(!selections||!selections.isOnlyOneGridSelected()){return false;}g=microstrategy.findBone(selections.getSelectedGrid());var unitKey=microstrategy.activeCXMenu.getAttribute(microstrategy.HTMLATTR_DSS_ID)||"Metrics";return(g&&g.controlLinks&&(g.controlLinks[unitKey]))?false:true;case"isOLAP":var subDepth,axis,depth,unit,coordinates,d1=microstrategy.activeCXMenu.getAttribute("d1"),olap=microstrategy.activeCXMenu.getAttribute("olap"),grid=microstrategy.findBone(this.parentBone.selections.getSelectedGrid());if(olap=="1"){return true;}if(grid&&d1){coordinates=d1.split("A");if(coordinates&&coordinates.length>=2){axis=coordinates[0];depth=coordinates[1];subDepth=coordinates[2];unit=grid.gridStructureInfo.getUnit(axis,depth,subDepth);return unit&&unit.olap;}}return false;case"gridSelectedVisualization":if(!selections||!selections.isOnlyOneGridSelected()){return false;}var g=microstrategy.findBone(selections.getSelectedGrid());return(g&&g.commands)?g.commands.queryState("selectedVisualization"):false;case"Autostyle":if(!selections||!selections.isOnlyOneGridSelected()){return false;}var g=microstrategy.findBone(selections.getSelectedGrid());return(g&&g.commands)?g.commands.queryState(cmdId):false;case"getControlGroupByList":if(!selections||!(selections.isOnlyOneGridSelected()||selections.isOnlyOnePanelStackSelected()||selections.isOnlyOneSelectorCtrlSelected())){return false;}var selectedElem=selections.getSelectedGrid()||selections.getSelectedPanelStack()||selections.getSelectedSelectorControl();var g=microstrategy.findBone(selectedElem);return(g&&g.ControlGroupByList)?g.ControlGroupByList:false;case"visibleShortcut":return(dv.getAvailableDatasets().length>0);case"isCubeReportDataset":return dv.isCubeReportDataset;case"autoArrange":if(!selections||!selections.isOnlyOneGridSelected()){return false;}var targetGrid=microstrategy.findBone(selections.getSelectedGrid());if(!targetGrid){return false;}var graphBone=microstrategy.bone(targetGrid.id+"_gb");return(graphBone)?graphBone.autoArrange:false;break;case"controlSubtype":item=selections.firstItem();if(item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){b=microstrategy.bone(item.id+"_Ctl");if(b&&b.ctlStyle){return b.ctlStyle;}}return -1;case"controlOrientation":item=selections.firstItem();if(item.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&item.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL){b=microstrategy.bone(item.id+"_Ctl");if(b&&b.ctlOrientation){return b.ctlOrientation;}}return -1;case"ItemWidthMode":return(this.getCommonBoneProperty(selectedItems,"itemWidthMode",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0")=="0");case"DisplaySelectorDocked":return(this.getCommonBoneProperty(selectedItems,"DisplaySelectorDocked",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0")=="-1");case"ExportAsShownOnWeb":return this.getCommonBoneProperty(selectedItems,"aow",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"exportSelectorTriState":return this.queryState("ExportAsShownOnWeb");case"availableWidgets":if(selections.isOnlyOneGridSelected()){return[{dssid:"None",n:microstrategy.descriptors.getDescriptor("2057")}].concat(dv.getAvailableWidgets(microstrategy.SUBOBJTYPE_DOC_TEMPLATE));}else{if(this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL])){return[{dssid:"None",n:microstrategy.descriptors.getDescriptor("5028")}].concat(dv.getAvailableWidgets(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL));}}return[{dssid:"None",n:microstrategy.descriptors.getDescriptor("2057")}];case"XTabViewModes":var vm=[{dssid:"1",n:microstrategy.descriptors.getDescriptor("2975")},{dssid:"2",n:microstrategy.descriptors.getDescriptor("115")},{dssid:"3",n:microstrategy.descriptors.getDescriptor("2972")}];if(this.queryVisible("visFlashMode")){vm=vm.concat({dssid:"50",n:microstrategy.descriptors.getDescriptor("4921")});}return vm;case"EditSelectorMetricQualType":return"4";case"EditSelectorType":if(selections.isOnlyOneTableSelected()){return -1;}else{var ctlStyle=this.queryState("EditSelectorStyle");if(ctlStyle==="11"){return mstrRWControlImpl.CTL_TYPE_ATTR_QUAL;}return this.getCommonBoneProperty(selectedItems,"ctlType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");}case"UpdateFilterTarget":var res;if(this.queryState("isDDIC")){var scid=selections.firstItem()&&selections.firstItem().id;res=dv.formattingAttributes[scid]&&dv.formattingAttributes[scid]["adts"];}else{res=this.getCommonAttValue(selectedItems,"adts","ActionForDirectTargetSelectors")||"0";}return res;case"controlQualType":var ctl=mstrStaticDoc.getBone(this.parentBone.selections.firstItem());return ctl.mct;case"showControlIncludeMenu":var ctlType=this.queryState("EditSelectorType");var ctlStyle=this.queryState("EditSelectorStyle");return(this.queryState("EditSelectorType")==mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST&&"01234567".indexOf(ctlStyle)>-1)?true:false;case"showMetricConditionType":return this.queryState("isMetricQualifier");case"isMetricQualifier":var st=this.queryState("EditSelectorStyle");return st=="7"||st=="8";case"isMetricQualifierStyle":return this.queryState("EditSelectorStyle")=="8";case"isNormalSelector":return !this.queryState("isMetricQualifier")&&!this.queryState("isActionSelector")&&!this.queryState("showTableButtons")&&!this.queryState("isDDIC");case"DataFilterVisible":return this.queryState("isNormalSelector")&&!this.queryState("isDSAsTarget")&&!this.queryState("attrReplaceLCVisible")||this.queryState("isDDIC");case"selectorAutoSyncVisible":case"showTotalVisible":case"countVisible":return !this.queryState("isMetricQualifier")&&!this.queryState("isDSAsTarget")&&(cmdId==="selectorAutoSyncVisible"||!this.queryState("isDDIC"))&&!this.queryState("isAQSelector");case"selectionTypeVisible":return(this.queryState("EditSelectorType")==1||this.queryState("EditSelectorType")==7)&&!this.queryState("isDSAsTarget")&&!this.queryState("isDDIC");case"attrLCVisible":var st=this.queryState("EditSelectorType");return !(st==2||st==4||st==8)&&!this.queryState("isDSAsTarget");case"metricLCVisible":return(this.queryState("EditSelectorType")==2)&&!this.queryState("isDSAsTarget");case"datasetLCVisible":return !(this.queryState("EditSelectorType")==2)&&this.queryState("isDSAsTarget");case"attrReplaceLCVisible":return(this.queryState("EditSelectorType")==8)&&!this.queryState("isDSAsTarget");case"submissionLCVisible":return this.queryState("EditSelectorType")==4&&!this.queryState("isDSAsTarget");case"transactionEnabled":return this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_CONFIGURE_TRANSACTIONS);case"isActionSelector":return this.queryState("EditSelectorType")=="4";case"isPanelStackSelector":return this.queryState("EditSelectorType")=="3";case"isAQSelector":return this.queryState("EditSelectorType")=="7";case"isDDIC":var i=0,sels=this.parentBone.selections,items=this.parentBone.selections.items,itemTypes=sels.getTypes();for(i=0,cnt=itemTypes.length;i<cnt;i++){if(itemTypes[i]!==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT){return false;}}for(i in items){var item=items[i];if(!this.getDDICBoneProperty(selectedItems,"ddic",microstrategy.SUBOBJTYPE_DOC_TEXT,null)){return false;}}return true;case"runReportDocName":return this.getCommonBoneProperty(selectedItems,"execName",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"actionSelectorType":return this.getCommonBoneProperty(selectedItems,"ast",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"postSubmitOption":var pso=this.getCommonBoneProperty(selectedItems,"pso",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");return(pso==null)?"8":pso;case"DisplayText":return this.getCommonBoneProperty(selectedItems,"dpTxt",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"ShowSubmitMessage":return this.getCommonBoneProperty(selectedItems,"shSubMsg",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"SubmitMessage":return this.getCommonBoneProperty(selectedItems,"subMsg",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"OfflineSubmission":var isOS=this.getCommonBoneProperty(selectedItems,"os",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);return isOS===undefined?true:isOS;case"TXNSubmitInOrder":return this.getCommonBoneProperty(selectedItems,"sio",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"DisplayConfirmation":return this.getCommonBoneProperty(selectedItems,"dpCfm",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);case"InvalidateCache":case"ForceLiveExecution":case"AutoAnswerPrompt":case"TableSubmitText":var propsMap={runReportDocName:"execName",actionSelectorType:"ast",postSubmitOption:"pso",DisplayText:"dpTxt",ShowSubmitMessage:"shSubMsg",SubmitMessage:"subMsg",OfflineSubmission:"os",DisplayConfirmation:"dpCfm",InvalidateCache:"invCache",ForceLiveExecution:"fcLvExec",AutoAnswerPrompt:"aapm",TableSubmitText:"dpTxt",TXNSubmitInOrder:"sio"},vl;if(selections.isOnlyOneTableSelected()){var b=selections.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(b&&b.isTable){vl=b.querySelectorState(propsMap[cmdId],"submitBtn");}}else{vl=this.getCommonBoneProperty(selectedItems,propsMap[cmdId],microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);}if(cmdId=="postSubmitOption"){vl=(vl==null)?"8":vl;}return vl;case"TableCancelText":case"TableCancelConfirmation":var cancelPropsMap={TableCancelConfirmation:"dpCfm",TableCancelText:"dpTxt"},vl;if(selections.isOnlyOneTableSelected()){var b=selections.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(b&&b.isTable){vl=b.querySelectorState(cancelPropsMap[cmdId],"cancelBtn");}}return vl;case"TableCancelType":var mstr_desc=microstrategy.descriptors;return this.queryState("UseAsInformationWindow")?mstr_desc.getDescriptor("11174"):mstr_desc.getDescriptor("11175");case"showSelectorStyle":return this.queryState("isSelector")&&!this.queryState("isActionSelector")&&!this.queryState("isAQSelector");case"hasSelectorTitle":return this.queryState("isSelector")&&!this.queryState("isActionSelector");case"hasElemCount":return this.queryState("isSelector")&&!this.queryState("isAQSelector");case"EditSelectorStyleMetricQual":case"EditSelectorStyle":case"EditSelectorStyleSingleSelect":case"EditSelectorStyleAction":return this.getCommonBoneProperty(selectedItems,"ctlStyle",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"EditSelectorOrientation":return this.getCommonBoneProperty(selectedItems,"ctlOrientation",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0");case"EditSelectorMouseOverAction":return this.getCommonBoneProperty(selectedItems,"mouseOverAction",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorShowAll":return this.getCommonBoneProperty(selectedItems,"showAll",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorAllAlias":return this.getCommonBoneProperty(selectedItems,"allAlias",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"EditSelectorShowTotal":return this.getCommonBoneProperty(selectedItems,"showTotal",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorTotalPosition":return this.getCommonBoneProperty(selectedItems,"totalPosition",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorMultiSelect":return this.getCommonBoneProperty(selectedItems,"multiSelect",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);case"EditSelectorSearchOnServ":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_CTL_SEARCH_ON_SERVER,"SearchOnServer")=="-1");case"EditSelectorNoSelectionBehavior":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_CTL_NO_SELECTION_BEHAVIOR,"NoSelectionBehavior");case"MinSel":var min=this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_CTL_MIN_SELECTION_COUNT,"MinSelectionCount");return(min>=0?min:"");case"MaxSel":var max=this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_CTL_MAX_SELECTION_COUNT,"MaxSelectionCount");return(max>=0?max:"");case"EnableSelCount":var min=this.queryState("MinSel"),max=this.queryState("MaxSel");return(min!==""||max!=="");case"EditSelectorAutoSync":var autoSync=false;if(this.queryState("isDDIC")){autoSync=this.getDDICBoneProperty(selectedItems,"autoSync",microstrategy.SUBOBJTYPE_DOC_TEXT,false);}else{autoSync=this.getCommonBoneProperty(selectedItems,"autoSync",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,false);}return autoSync;case"EditSelectorSource":case"EditSelectorSourceMetrics":var ctlSrcId=this.getCommonBoneProperty(selectedItems,"ctlSrcId",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),ctlSrcType=this.getCommonBoneProperty(selectedItems,"ctlSrcType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),ctlSrcName=this.getCommonBoneProperty(selectedItems,"ctlSrcName",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);if(ctlSrcType==100||ctlSrcType==101){ctlSrcType=4;}if(ctlSrcName!=null){ctlSrcName=((ctlSrcName.indexOf("]")==ctlSrcName.length-1)?ctlSrcName.substring(0,ctlSrcName.length-1):ctlSrcName);ctlSrcName=((ctlSrcName.indexOf("[")==0)?ctlSrcName.substring(1,ctlSrcName.length):ctlSrcName);}return(ctlSrcId!=null&&ctlSrcType!=null&&ctlSrcName)?ctlSrcId+"|"+ctlSrcType+"|"+ctlSrcName:"";case"EditSelectorSourceAttributes":var replaceAttId=this.getCommonBoneProperty(selectedItems,"replaceAttId",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),replaceAttType=this.getCommonBoneProperty(selectedItems,"replaceAttType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),replaceAttName=this.getCommonBoneProperty(selectedItems,"replaceAttName",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);if(replaceAttType==100||replaceAttType==101){replaceAttType=4;}if(replaceAttName!=null){replaceAttName=((replaceAttName.indexOf("]")==replaceAttName.length-1)?replaceAttName.substring(0,replaceAttName.length-1):replaceAttName);replaceAttName=((replaceAttName.indexOf("[")==0)?replaceAttName.substring(1,replaceAttName.length):replaceAttName);}return(replaceAttId!=null&&replaceAttType!=null&&replaceAttName)?replaceAttId+"|"+replaceAttType+"|"+replaceAttName:"";case"IsSelectorSourceNDE":var ctlSrcType=this.getCommonBoneProperty(selectedItems,"ctlSrcType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null),ctlSrcSubtype=this.getCommonBoneProperty(selectedItems,"ctlSrcSubtype",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);return ctlSrcType==microstrategy.DSSTYPE_CONSOLIDATION&&ctlSrcSubtype=="12033";case"EditSelectorSourceDDIC":return this.getDDICBoneProperty(selectedItems,"ctlSrc",microstrategy.SUBOBJTYPE_DOC_TEXT,null)||"";case"EditFormDelimiter":return this.getCommonBoneProperty(selectedItems,"formDelimiter",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"EditDisplayForm":return this.getCommonBoneProperty(selectedItems,"displayFormType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"selectedAttrForms":return this.getCommonBoneProperty(selectedItems,"attrForms",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"sortAttrForm":return this.getCommonBoneProperty(selectedItems,"sortAttrForm",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"sortType":return this.getCommonBoneProperty(selectedItems,"sortType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"");case"EditSelectorSelectionType":return this.getCommonBoneProperty(selectedItems,"include",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");case"EditSelectorMetricConditionType":return this.getCommonBoneProperty(selectedItems,"mct",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"0")||0;case"availableTemplates":case"availableTemplatesNoSelectors":case"availableTemplatesNoPlaceholder":b=microstrategy.getBonesByType([microstrategy.OBJTYPE_GRID,microstrategy.OBJTYPE_GRAPH]);var isActionSelector=this.queryState("isActionSelector"),isMetricQualifier=this.queryState("isMetricQualifier"),isAttrQualifier=this.queryState("isAQSelector"),canTargetDDIC=!isActionSelector&&!isMetricQualifier&&(cmdId=="availableTemplates"||cmdId==="availableTemplatesNoPlaceholder"),canTargetPh=(cmdId=="availableTemplates"),objIdCache={},templates=[];for(i=0;i<b.length;i++){id=b[i].objId;if(!document.getElementById(id)){continue;}var nm=this.parentBone.styleObj.getAttValue(document.getElementById(id),microstrategy.HTMLATTR_NAME);if(!(id in objIdCache)){templates.push({dssid:id,n:nm});objIdCache[id]=true;}if(canTargetDDIC){var gridObjs={},gsi=b[i].gridStructureInfo,tscObjs=b[i].tscObjs;mstr.$A.forEach(gsi.allAxes,function(axisObj){mstr.$A.forEach(axisObj.units,function(unitInfo){if(unitInfo.dssId){gridObjs[unitInfo.dssId]=true;}});});if(tscObjs){mstr.$A.forEach(tscObjs,function(obj){if(obj.ctl&&obj.ctl.ddic&&gridObjs[obj.did]){templates.push({dssid:obj.ctl.ctlKey,n:nm+":"+obj.n});}});}}if(canTargetPh){var phs=b[i].phs,ph,pi,phid;for(pi=0;phs&&phs.length&&pi<phs.length;pi++){ph=phs[pi];phid=id+"_"+ph.idx;if(!(phid in objIdCache)){templates.push({dssid:phid,n:nm+":"+ph.n});objIdCache[phid]=true;}}}}var res=templates.concat(this.queryState("panelStackTargets"));if(canTargetDDIC){res=res.concat(this.queryState("panelStackTargetsDDIC"));}if(isActionSelector||isAttrQualifier||cmdId=="availableTemplatesNoSelectors"){return res;}else{return res.concat(this.queryState("availableSelectors"));}case"availAssoNodes":if(!selections||!selections.isOnlyOneGridSelected()){return false;}var objIdCache={};var g=microstrategy.findBone(selections.getSelectedGrid());objIdCache[g.RWUnitId]=true;b=microstrategy.getBonesByType([microstrategy.OBJTYPE_GRID,microstrategy.OBJTYPE_GRAPH]);var availNodes=[];for(i=0;i<b.length;i++){id=b[i].RWUnitId;if(!document.getElementById(id)||b[i].isOnClipBoard||(id in objIdCache)||(b[i].commands&&b[i].commands.queryState("Shortcut"))){continue;}availNodes.push({dssid:id,n:this.parentBone.styleObj.getAttValue(document.getElementById(id),microstrategy.HTMLATTR_NAME)});objIdCache[id]=true;}return availNodes;case"availableTemplatesDataset":var vb=microstrategy.getViewerBone();var datasets=[];for(var id in vb.documentDataSets){var isCube=vb.documentDataSetsIsCube[id],isAUCT=vb.datasetInfos[id].auct;if(isCube==false&&isAUCT){datasets.push({dssid:id,n:vb.documentDataSets[id]});}}return datasets;case"availablePanelStacks":return[{dssid:"",n:microstrategy.descriptors.getDescriptor("181")}].concat(this.queryState("panelStackTargets"));case"availableSelectors":b=microstrategy.getBonesByType([microstrategy.OBJTYPE_RW_CONTROL]);var selectors=[],canNotTargetPSSelector=this.queryState("isDDIC")||this.queryState("isMetricQualifier")||this.queryState("EditSelectorType")==1;for(i=0;i<b.length;i++){id=b[i].RWUnitId;if(!document.getElementById(id)||b[i].boneSelected||b[i].isOnClipBoard||b[i].ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION||(b[i].ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK&&canNotTargetPSSelector)||b[i].ctlStyle==mstrRWControlImpl.CTL_STYLE_ATTR_QUALIFICATION){continue;}selectors.push({dssid:id,n:this.parentBone.styleObj.getAttValue(document.getElementById(id),microstrategy.HTMLATTR_NAME)});}return selectors;case"selectorCurrentStateOptsUC":case"selectorCurrentStateOpts":var dfm=cmdId=="selectorCurrentStateOptsUC",res=[],l,se=!this.queryState("isSelectorUnset"),gds=microstrategy.descriptors;if(se){res[res.length]={dssid:"-1",n:gds.getDescriptor("7625")};}l=res.length;if(dfm){res[l]={dssid:"1",n:gds.getDescriptor("7622")};}else{if(se){res[res.length]={dssid:"-1",n:gds.getDescriptor("7625")};}l=res.length;res[l]={dssid:"2",n:gds.getDescriptor("7623")};res[l+1]={dssid:"4",n:gds.getDescriptor("7624")};}return res;case"isSelectorUnset":var scid=selections.firstItem()&&selections.firstItem().id,isUs=dv.formattingAttributes[scid]&&dv.formattingAttributes[scid]["isUs"];return isUs==undefined?true:isUs;case"selectorCurrentStateUC":return this.queryState("isSelectorUnset")?"1":"-1";case"selectorCurrentState":if(!this.queryState("isSelectorUnset")){return"-1";}else{var scid=selections.firstItem()&&selections.firstItem().id,ust=dv.formattingAttributes[scid]&&dv.formattingAttributes[scid]["ust"];if(ust==1){ust=2;}return ust||2;}case"selectorTabTitle":return selections.isOnlyOneTableSelected()?microstrategy.descriptors.getDescriptor("7821"):microstrategy.descriptors.getDescriptor("4728");case"UnsetCount":var scid=selections.firstItem()&&selections.firstItem().id;return dv.formattingAttributes[scid]&&dv.formattingAttributes[scid]["usc"];case"panelStackTargets":var panels=[],b=microstrategy.getBonesByType(microstrategy.OBJTYPE_PANEL_STACK);for(i=0;i<b.length;i++){id=b[i].id;if(!document.getElementById(id)||b[i].isOnClipBoard){continue;}panels.push({dssid:id,n:this.parentBone.styleObj.getAttValue(b[i].elem,microstrategy.HTMLATTR_NAME)});}return panels;case"panelStackTargetsDDIC":var that=this,res=[],srcCtlKey=selections.firstItem()&&selections.firstItem().getAttribute("trxctlkey"),b=microstrategy.getBonesByType(microstrategy.OBJTYPE_PANEL_STACK),isDDIC=this.queryState("isDDIC");for(i=0;i<b.length;i++){id=b[i].id;if(!document.getElementById(id)||b[i].isOnClipBoard){continue;}var panels=b[i].panels||[];mstr.$A.forEach(panels,function(pn){var tscObjs=pn.tscObjs;if(tscObjs){mstr.$A.forEach(tscObjs,function(tscObj){if(tscObj.ctl&&tscObj.ctl.ddic&&tscObj.ctl.ctlKey!=srcCtlKey&&document.getElementById(tscObj.key)){res.push({dssid:tscObj.ctl.ctlKey,n:that.parentBone.styleObj.formattingAttributes[tscObj.key]["nm"]});}});}});}return res;case"EditSelectorTargetsSingleSelect":var type=this.getCommonBoneProperty(selectedItems,"ctlType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");if(this.parentBone.parentBone.autoWire){if(type==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){var t=this.getCommonBoneProperty(selectedItems,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);return t;}else{var ss=microstrategy.findBone(this.queryState("selectedSection")),ps=ss&&ss.findObjects&&ss.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(ps&&ps.length==1){return ps[0].getAttribute("id");}else{return"";}}}else{if(type!=mstrRWControlImpl.CTL_TYPE_PANEL_STACK){return"";}else{var t=this.getCommonBoneProperty(selectedItems,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);return(t.length>0)?t[0]:"";}}case"EditSelectorTargetsMetrics":case"EditSelectorTargets":case"EditSelectorTargetsNoPlaceholder":case"EditSelectorTargetsAttributes":var type=this.getCommonBoneProperty(selectedItems,"ctlType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"1");var that=this;var targetOptions=[];var fn=function(targets,targetNames,filter){var keys,b,ph,grid,gridName;for(i=0;i<targets.length;i++){if(document.getElementById(targets[i])){if(!filter||!(that.parentBone.styleObj.getAttValue(document.getElementById(targets[i]),microstrategy.HTMLATTR_OBJTYPE) in filter)){targetOptions.push({dssid:targets[i],n:that.parentBone.styleObj.getAttValue(document.getElementById(targets[i]),microstrategy.HTMLATTR_NAME)});}}else{if(targets[i]&&targets[i].split("_").length===2){keys=targets[i].split("_");grid=document.getElementById(keys[0]);b=microstrategy.findBone(grid);if(b&&b.phs&&cmdId!=="EditSelectorTargetsNoPlaceholder"){var arrIdx=mstr.utils.Arrays.findByForm(b.phs,keys[1],"idx",false);if(arrIdx>=0){ph=b.phs[arrIdx];gridName=that.parentBone.styleObj.getAttValue(grid,microstrategy.HTMLATTR_NAME);targetOptions.push({dssid:targets[i],n:gridName+":"+ph.n});}}}else{if(targetNames&&targetNames[targets[i]]){targetOptions.push({dssid:targets[i],n:targetNames[targets[i]]});}}}}return targetOptions;};if(this.parentBone.parentBone.autoWire){if(type==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){var subSection=microstrategy.findBone(this.queryState("selectedSection"));var targets=subSection.findObjects(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);targets=targets.concat(subSection.findObjects(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK));var kArr=[];var map={};for(var i=0,len=targets.length;i<len;i++){var tb=microstrategy.findBone(targets[i]);var objId=tb.objId||tb.id;if(map[objId]!=true){kArr.push(objId);map[objId]=true;}}return fn(kArr);}else{var targets=that.getCommonBoneProperty(selectedItems,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);var targetNames=that.getCommonBoneProperty(selectedItems,"targetNames",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);return fn(targets,targetNames);}}else{if(type==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){return[];}else{var targets=that.getCommonBoneProperty(selectedItems,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);var targetNames=that.getCommonBoneProperty(selectedItems,"targetNames",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,{});if(this.queryState("isDDIC")){targets=targets.concat(that.getDDICBoneProperty(selectedItems,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,"").split(CLIPBOARD_ITEM_SEPARATOR));}var t=this.queryState("availableTemplates");targetNames=targetNames||{};for(var key in t){targetNames[t[key].dssid]=t[key].n;}return fn(targets,targetNames,(cmdId=="EditSelectorTargetsMetrics"||cmdId=="EditSelectorTargetsAttributes")?{111:true}:null);}}case"EditSelectorCandidateAttributes":return this.getCommonBoneProperty(selectedItems,"candidateAtts",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]);case"EditSelectorTargetsDataset":var targetOptions=[],targetKeys=this.getCommonBoneProperty(selectedItems,"targetKeys",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[]),vb=microstrategy.getViewerBone(),dataSets=vb.documentDataSets||[];for(var i=0,len=targetKeys.length;i<len;i++){var id=targetKeys[i];if(dataSets[id]&&vb.datasetInfos[id].auct){targetOptions.push({dssid:id,n:dataSets[id]});}}return targetOptions;case"isDSAsTarget":return(this.getCommonBoneProperty(selectedItems,"ctlTargetType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,[])==mstrRWControlImpl.CTL_TARGET_TYPE_DATASET);case"dsAsTgtChkVisible":var ctlSrcSubtype=parseInt(this.getCommonBoneProperty(selectedItems,"ctlSrcSubtype",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null)),ctlSrcType=this.getCommonBoneProperty(selectedItems,"ctlSrcType",microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,null);if(isNaN((ctlSrcSubtype))){ctlSrcSubtype=-1;}return(this.queryState("EditSelectorType")==1)&&ctlSrcType===microstrategy.DSSTYPE_ATTRIBUTE&&ctlSrcSubtype!==microstrategy.DSSSUB_TYPE_DERIVED_ATTRIBUTE;case"showTooltip":return this.queryEnabled("ToolTip");case"showNavigationProps":return this.queryEnabled("IsLink")&&!this.queryState("isButton");case"showVisibleInHTMLViewMode":var isVisible=this.queryEnabled("VisibleHTML");if(isVisible){for(id in selectedItems){var dt=selectedItems[id].getAttribute("dt");if(dt==-1||dt==-2){return false;}}}return isVisible;case"docked":if(this.queryState("isSection")){var currSecDef=this.getCurrentSectionDef();return currSecDef&&currSecDef.dc;}return false;case"showHTMLContainer":return this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_DOCUMENTS_DESIGN_MODE)&&this.parentBone.parentBone.isFeatureAvailable(microstrategy.FEATURE_CREATE_HTML_CONTAINER)&&this.queryEnabled("HTMLType");case"showPortal":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE]);case"showPanelStackTitle":if(this.queryState("isNavBar")){return false;}if(selections.atLeastOneTableSelected()){return false;}case"isPanelStack":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK]);case"showAdvanced":return !this.queryState("isActionSelector")&&!selections.isOnlyOneTableSelected()&&!this.queryState("attrReplaceLCVisible");case"showTableDisplayMode":case"showTableButtons":return selections.isOnlyOneTableSelected();case"showAutoWireMessage":return this.queryState("Autowire")&&!selections.isOnlyOneTableSelected()&&!this.queryState("isDSAsTarget");case"fpAutoSubmit":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_CTL_AUTO_SUBMIT,"CtlAutoSubmit")=="-1");case"isFilterPanel":return this.getCommonBoneProperty(selectedItems,"isFilterPanel",microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);case"showGridIf":var xtv=this.queryState("XTabView");return xtv==1||xtv==3;case"showTransition":return !this.queryState("isSelector");case"showFlushMsg":var um=microstrategy.updateManager;return um.commands.queryEnabled("apply");case"isSection":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_SUBSECTION]);case"showSize":return !this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_SUBSECTION,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"showPageBreak":return(this.queryState("isSection")&&selections.firstItem().getAttribute("dt")!="-3");case"isSelector":case"showItem":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL]);case"showFixedWidthOnly":return !this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])||this.queryState("IsPortal");case"showFixedHeightOnly":return !this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])||this.queryState("IsPortal")||this.queryState("isButton");case"showFixed100Width":case"showFixed100Height":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND]);case"showFixedFitWidth":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])&&!this.queryState("IsPortal");case"showFixedFitHeight":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_GRID_TEMPLATE])&&!this.queryState("IsPortal")&&!this.queryState("isButton");case"isOneGrid":return selections.isOnlyOneGridSelected();case"wasFullScreen":return this.parentBone.parentBone.curWgtId||false;case"isHorizontalSubsection":return this.queryEnabled("isSubsectionHorizontal");case"isImage":return this.queryEnabled("Source");case"isLine":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"showLockAspectRatio":if(this.queryState("onlyButtons")){return true;}return this.queryState("isImage");case"showTitleHeight":return(this.queryState("showPortal")||this.queryState("showPanelStackTitle")||this.queryState("isSelector"));case"setWidget":var fixedCS=this.getCommonAttValue(selectedItems,"twc","ClassName");switch(fixedCS){case"com.microstrategy.flex.viewer.HeatMapViewer":fixedCS="../swf/HeatMapWidget.swf";break;case"com.microstrategy.flex.viewer.GaugeContainer":fixedCS="../swf/GaugeWidget.swf";break;case"com.microstrategy.flex.viewer.InteractiveBubblePlotComponent":fixedCS="../swf/InteractiveBubbleWidget.swf";break;}return this.getCommonAttValue(selectedItems,"rsl","RSLPath")||fixedCS||"None";case"NonFlashRender":return this.getCommonAttValue(selectedItems,"nfr","NonFlashRender");case"setTransition":var tt=this.getCommonAttValue(selectedItems,"ttr","Transition");return tt!=""?tt:"None";case"setTransDuration":return this.getCommonAttValue(selectedItems,"tdr","Duration");case"PSPreLoadAllPanels":return this.getCommonAttValue(selectedItems,"plp","PSPreLoadAllPanels");case"ClipOnExport":return this.getCommonAttValue(selectedItems,"cone","IgnoreInExport")==microstrategy.FALSE;case"allowPanelsToSplitAcrossPages":return this.getCommonAttValue(selectedItems,"spcp","SplitPanelAcrossPages")==microstrategy.TRUE||this.queryState("expandPanels")==0;case"panelOverflowSpacing":return this.getCommonAttValue(selectedItems,"povfs","RepeatPanelSpacing");case"expandPanels":return this.getCommonAttValue(selectedItems,"ep","ExpandAllPanels");case"panelOverflowSpacingEnabled":return this.queryState("expandPanels")!=0&&this.queryState("ClipOnExport");case"gridIfEnabled":return this.getCommonAttValue(selectedItems,"gif","gridIfEnabled")!="0";case"gridIfMaxRows":return this.getCommonAttValue(selectedItems,"gmr","gridIfMaxRows");case"gridIfRowMode":return this.getCommonAttValue(selectedItems,"gifmd","gridIfRowMode");case"XTabPos":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_GRID_POS,"gridPosition");case"XTabPer":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_GRID_AREA_PCT,"gridArea");case"TitleHeight":if(!selections.isActive()){return"";}var formatType=2;if(selections.isSelectorControlSelected()){formatType=mstrRWControlImpl.FMT_TYPE_TITLE;}var tht=this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_HEIGHT,"height",false,formatType);return(tht&&tht.length>0)?microstrategy.number.toUserUnits(tht):"";case"showFillColor":return this.queryEnabled("backgroundColor")&&!this.queryState("onlyButtons");case"enableFillColor":return(!selections.isOnlyOneGridSelected()||selections.gridUnitFormatX!=microstrategy.GRID_BORDERS);case"showBorders":return selections.isOnlyOneTableSelected()?(selections.panelUnitFormat==0):(this.queryEnabled("AllColor")&&!this.queryState("isNavBar"));case"enableBorders":if(selections.isOnlyOneGridSelected()){return(!selections.isGridContainerSelected()||selections.gridValueFormatX==1);}else{if(selections.isOnlyOneTableSelected()){return true;}else{if(selections.isOnlyOnePanelStackSelected()){return(selections.panelValueFormat!=1);}else{if(selections.isSelectorControlSelected()){return(selections.controlValueFormat!=mstrRWControlImpl.FMT_TYPE_TITLE_BASE);}}}}return true;case"showLineColor":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE,microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE])||(selections.isOnlyOneTableSelected()&&selections.panelUnitFormat>0);case"isText":return this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT]);case"iOSOnlyCopyVisible":return this.queryState("isText")&&!this.queryState("isButton");case"isButton":for(var item in selections.items){if(microstrategy.styleObj.getAttValue(selections.items[item],microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_TEXT&&microstrategy.styleObj.getAttValue(selections.items[item],microstrategy.HTMLATTR_DISPLAY_STYLE)>0){return true;}}return false;case"ShowInfoWindowTargets":return this.queryState("isButton")||microstrategy.isEnabled(selections.isVisible&&selections.items,this.qeMap.InformationWindowTarget);case"ShowMobile":return this.queryState("isText")&&!this.queryState("isButton");case"onlyButtons":for(var item in selections.items){if(microstrategy.styleObj.getAttValue(selections.items[item],microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_DOC_TEXT||microstrategy.styleObj.getAttValue(selections.items[item],microstrategy.HTMLATTR_DISPLAY_STYLE)<1){return false;}}return true;case"multiButtons":return this.queryState("onlyButtons")&&selections.length>1;case"isNavBar":return selections.isOnlyOneNavBarSelected();case"showTextControl":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT])||this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_HTML_CONTAINER])||this.queryEnabled("showGridSelectors");case"showPadding":return this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEXT])||this.queryEnabled("showGridSelectors");case"showCorners":var justPanels=this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK])&&!selections.isOnlyOneTableSelected();var justRound=this.queryState("isRoundShape");return((justPanels&&!justRound)||(!justPanels&&justRound));case"isRoundShape":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_STYLE,"hasRoundedCorners")==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND);case"show3dBorders":return !this.searchForSelectedObjectType([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_LINE]);case"showTextOverflow":return this.queryState("isText")&&!this.queryState("isButton");case"showContentOverflow":return this.queryState("isPanelStack")&&!this.queryState("isNavBar")&&!selections.atLeastOneTableSelected();case"getCachedObjectFormatLevels":return this.parentBone.selections.getCachedObjectFormatLevels();case"areGridFormatsReady":return selections.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE).commands.queryState(cmdId);case"tbEmptySelector":return{items:[],value:""};case"tbPanelUnitSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4727")},{dssid:1,n:microstrategy.descriptors.getDescriptor("4758")}],value:selections.panelUnitFormat};case"tbTableUnitSelector":var mstr_desc=microstrategy.descriptors;var fontTab=allPanels=="font";tus=fontTab?[]:[{dssid:0,n:mstr_desc.getDescriptor("7755")}];fontTab&&tus.push({dssid:2,n:mstr_desc.getDescriptor("4024")});if(fontTab){tus.push({dssid:3,n:mstr_desc.getDescriptor("11176")});}return{items:tus,value:selections.panelUnitFormat};case"tbTableValueSelector":var mstr_desc=microstrategy.descriptors;var unit=parseInt(this.parentBone.selections.panelUnitFormat),isFont=allPanels=="font";if(isFont){if(unit==2){return{items:[{dssid:1,n:mstr_desc.getDescriptor("4756")}],enabled:false,value:selections.panelValueFormat};}else{if(unit==3){return{items:[{dssid:1,n:mstr_desc.getDescriptor("4756")},{dssid:3,n:mstr_desc.getDescriptor("527")}],value:selections.panelValueFormat};}}}else{if(unit==2){return{items:[{dssid:4,n:mstr_desc.getDescriptor("11177")}],formatEnabled:false,value:selections.panelValueFormat};}else{if(unit==0){return{items:[{dssid:0,n:mstr_desc.getDescriptor("4579")}],value:selections.panelValueFormat};}}}case"tbPanelValueSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4579")},{dssid:1,n:microstrategy.descriptors.getDescriptor("3297")}],value:selections.panelValueFormat};case"tbSelectorControlUnitSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4728")}],value:selections.controlUnitFormat};case"tbSelectorControlValueSelector":return{items:[{dssid:0,n:microstrategy.descriptors.getDescriptor("4579")},{dssid:mstrRWControlImpl.FMT_TYPE_TITLE_BASE,n:microstrategy.descriptors.getDescriptor("3297")}],value:selections.controlValueFormat};case"tbGridContainerValueSelector":return{items:[{dssid:1,n:microstrategy.descriptors.getDescriptor("4579")},{dssid:2,n:microstrategy.descriptors.getDescriptor("3297")}],value:selections.gridValueFormatX};case"tbUnitSelector":if(this.queryEnabled("onepanelstack")){return this.queryState("tbPanelUnitSelector");}case"tbGridUnitSelector":case"AllGridUnitSelector":grid=microstrategy.findBone(selections.getSelectedGrid());if(!grid){return this.queryState("tbEmptySelector");}var gUnits=grid.commands.queryState(cmdId)||{items:[],value:""};if(grid.isGrid){var items=[];if(gUnits.items.length&&gUnits.items[0].dssid==-1){items=[gUnits.items.shift()];}var suffix=(cmdId!="AllGridUnitSelector")?"**grid":"";items=items.concat([{dssid:microstrategy.GRID_UNIT_CONTAINER+suffix,n:microstrategy.descriptors.getDescriptor("4753"),cssClass:"ToolbarList UGC"},{dssid:microstrategy.GRID_BORDERS+suffix,n:microstrategy.descriptors.getDescriptor("3798"),cssClass:"ToolbarList UGB"}]).concat(gUnits.items);gUnits.items=items;}return gUnits;case"showEditorSelector":return !this.queryState("isNavBar");case"edtUnitSelector":var edtUnits={visible:false,enabled:true,items:[]};this.parentBone.selections.verifyFormatLevels(allPanels);if(selections.isOnlyOneGridSelected()&&allPanels){grid=selections.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(!grid){return this.queryState("tbEmptySelector");}var isOnlyGraph=grid.commands.queryState("graphMode");if(isOnlyGraph||microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE){edtUnits.value=microstrategy.GRID_UNIT_CONTAINER;}else{edtUnits=this.queryState(allPanels=="color"?"AllGridUnitSelector":"GridUnitSelector");}var isDesignModeColorTab=(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&allPanels=="color");if(allPanels=="font"||isDesignModeColorTab||isOnlyGraph){if(this.queryState("IsPortal")){edtUnits.items=[{dssid:microstrategy.GRID_UNIT_CONTAINER,n:microstrategy.descriptors.getDescriptor("4753"),cssClass:"ToolbarList UGC"}].concat(edtUnits.items);edtUnits.visible=true;}else{if(isDesignModeColorTab){edtUnits.visible=false;}else{edtUnits.visible=!isOnlyGraph;}}}else{edtUnits.visible=true;}edtUnits.enabled=true;}else{if(selections.isOnlyOneTableSelected()){adjustTableFormat(selections,allPanels);edtUnits=this.queryState("tbTableUnitSelector",allPanels);edtUnits.enabled=true;edtUnits.visible=(allPanels&&(allPanels=="color"||allPanels=="font"));}else{if(selections.isOnlyOnePanelStackSelected()){edtUnits=this.queryState("tbPanelUnitSelector");edtUnits.enabled=true;edtUnits.visible=(allPanels&&allPanels=="color");}else{if(selections.isSelectorControlSelected()){edtUnits=this.queryState("tbSelectorControlUnitSelector");edtUnits.enabled=true;edtUnits.visible=(allPanels&&(allPanels=="color"||allPanels=="font")&&this.queryState("IsPortal"));}}}}return edtUnits;case"edtValueSelector":var edtVals={visible:false,enabled:true};if(selections.isOnlyOneGridSelected()){if(selections.isGridContainerSelected()){if(allPanels&&(allPanels=="color"||allPanels=="font")){edtVals=this.queryState("tbGridContainerValueSelector");edtVals.visible=this.queryState("IsPortal");edtVals.enabled=(allPanels!="font");}}else{edtVals=this.queryState("AllGridUnitValueSelector");edtVals.visible=this.queryState("edtUnitSelector",allPanels).value>microstrategy.GRID_BORDERS;edtVals.enabled=true;}}else{if(selections.isOnlyOneTableSelected()){adjustTableFormat(selections,allPanels);edtVals=this.queryState("tbTableValueSelector",allPanels);edtVals.visible=(allPanels&&(allPanels=="color"||allPanels=="font"));}else{if(selections.isOnlyOnePanelStackSelected()){edtVals=this.queryState("tbPanelValueSelector");edtVals.visible=(allPanels&&allPanels=="color"&&this.parentBone.commands.queryState("IsPortal"));edtVals.enabled=(selections.panelUnitFormat==0);}else{if(selections.isSelectorControlSelected()){edtVals=this.queryState("tbSelectorControlValueSelector");edtVals.visible=this.parentBone.selections.areAllSameSubtypeSelected(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL)&&(allPanels&&(allPanels=="color"||allPanels=="font")&&this.parentBone.commands.queryState("IsPortal"));edtVals.enabled=(selections.controlUnitFormat==0);}}}}return edtVals;case"tbValueSelector":case"tbGridValueSelector":if(this.queryEnabled("onepanelstack")){return this.queryState("tbPanelValueSelector");}if(this.queryEnabled("onecontrol")){return this.queryState("tbSelectorControlValueSelector");}if(selections.isGridContainerSelected()&&!selections.getSelectedGridProperty("graphSelected")){selections.gridValueFormatX=Math.min(selections.gridValueFormatX,2);var valuesObj=this.queryState("tbGridContainerValueSelector");valuesObj.isFetching=false;return valuesObj;}case"GridUnitSelector":case"AllGridUnitValueSelector":case"GridUnitValueSelector":grid=microstrategy.findBone(selections.getSelectedGrid());return(grid&&grid.commands.queryState(cmdId))||{items:[],value:""};case"PanelUnitSelector":return selections.panelUnitFormat;case"PanelUnitValueSelector":return selections.panelValueFormat;case"appliedThemeID":var scid=selections.firstItem()&&selections.firstItem().id,thmid=scid&&dv.formattingAttributes[scid]&&dv.formattingAttributes[scid]["thmid"];return thmid;case"appliedThemeAsLink":var scid=selections.firstItem()&&selections.firstItem().id,thmlnk=scid&&dv.formattingAttributes[scid]&&dv.formattingAttributes[scid]["thmlnk"];return !!thmlnk;case"appliedLinkedTheme":return microstrategy.hasAppliedTheme(selections.firstItem(),true);case"appliedTheme":return microstrategy.hasAppliedTheme(selections.firstItem());case"appliedThemePath":var scid=selections.firstItem()&&selections.firstItem().id,thmpath=scid&&dv.formattingAttributes[scid]&&dv.formattingAttributes[scid]["thmpath"];return microstrategy.isDefaultTheme(thmid)?null:thmpath;case"appliedThemeType":var thmid=this.queryState("appliedThemeID");if(!thmid){return microstrategy.APPLIED_THEME_NONE;}else{if(microstrategy.isDefaultTheme(thmid)){return microstrategy.APPLIED_THEME_DEFAULT;}else{return microstrategy.APPLIED_THEME_CUSTOM;}}case"showAppliedThemeAsType":return this.queryState("appliedThemeType")!==microstrategy.APPLIED_THEME_NONE;case"showCustomThemePicker":return this.queryState("appliedThemeType")===microstrategy.APPLIED_THEME_CUSTOM;case"Bold":case"Italic":case"Underline":case"FontFamily":case"FontSize":case"FontColor":case"FillColor":case"lncolor":grid=selections.getSelectedControlBone(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);if(selections.isOnlyOneGridSelected()&&grid&&grid.graphSelected){return grid.commands.queryState(cmdId);}else{return selections.checkFormat(cmdId,allPanels);}case"showRepeatSection":return(this.queryState("isSection")&&selections.styleObj.getAttValue(selections.firstItem(),"rps")!="0");case"visibleShowInRptCp":if(this.queryState("isSection")||!selections.items){return false;}for(var i in selections.items){var s=microstrategy.findAncestorWithAtt(selections.items[i],microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);if(s){if(microstrategy.styleObj.getAttValue(s,microstrategy.HTMLATTR_REPEAT_SECTION)!="-1"){return false;}var dt=s.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION);if(dt=="-1"||dt=="-3"){return false;}}}return true;case"enableHorizontal":return microstrategy.isEnabled(selections.items,"textAlign");case"showSecondaryDataProviders":var widgets=this.parentBone.parentBone.getAvailableWidgets(microstrategy.SUBOBJTYPE_DOC_TEMPLATE);var currWidget=this.queryState("setWidget");for(var w in widgets){var wdgt=widgets[w];if(wdgt.dssid==currWidget){return wdgt.mnsp>0||wdgt.mxsp>0;}}return false;case"availableSecondaryDataProviders":var items=[];if(!this.queryState("isOneGrid")){return items;}var dpn=this.parentBone.parentBone.dataProviderNames;var gbyLevel=null;for(var id in dpn){if(id==selections.getSelectedGrid().id){gbyLevel=dpn[id][1];break;}}for(var id in dpn){if(id==selections.getSelectedGrid().id||dpn[id][1]>gbyLevel){continue;}items.push({dssid:id,n:dpn[id][0]});}items=items.sort(function(a,b){if(a.n<b.n){return -1;}if(a.n>b.n){return 1;}return 0;});return items;case"SecondaryDataProviders":var items=[];var selGridSDP=this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_SEC_DATA_PROVIDERS,"SecondaryDataProviders");selGridSDP=selGridSDP?selGridSDP.split(","):[];var allItems=this.queryState("availableSecondaryDataProviders");for(var dp in selGridSDP){for(var i in allItems){if(selGridSDP[dp]==allItems[i].dssid){items.push(allItems[i]);}}}return items;case"pivotButtons":return mstr.behaviors.featureResolver.featAvailable("check-show-pivot-buttons");case"sortButtons":return mstr.behaviors.featureResolver.featAvailable("check-show-sort-buttons");case"toggleSnap":return !microstrategy.SNAP_OFF;case"graphZones":var graphBone=microstrategy.findBone(selections.getSelectedGrid());return(graphBone.zonesEditor)?true:false;case"DataFilterMode":if(this.queryState("isMetricQualifier")){return 1;}if(!this.queryEnabled("DataFilterModeEnabled")){return 1;}var sctor=selections.firstItem();var dfm=dv.formattingAttributes[sctor.id]&&dv.formattingAttributes[sctor.id]["dfm"];return dfm==undefined?1:dfm;case"stateUCVisible":return this.queryState("DataFilterMode")==1||(this.queryState("isNormalSelector")&&this.queryState("isDSAsTarget"));case"isSlicingSelector":return this.queryState("DataFilterMode")==0||this.queryState("isPanelStackSelector");case"SelectionColor":return(microstrategy.styleObj.getAttValue(selections.firstItem(),microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE)=="1")?microstrategy.styleObj.getAttValue(selections.firstItem(),microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR):"automatic";case"widgetId":var layVis=this.parentBone.parentBone.curWgtId;if(layVis){return layVis;}if(selections&&selections.isOnlyOneGridSelected()){var g=microstrategy.findBone(selections.getSelectedGrid());if(g){if(g.curWgtId){return g.curWgtId;}}}return"";case"isPageHeaderSection":return this.queryState("isSection")&&this.belongsToSectionOfTypes([6]);case"isPageFooterSection":return this.queryState("isSection")&&this.belongsToSectionOfTypes([7]);case"isInFilterPanel":var s=microstrategy.findAncestorWithAtt(selections.firstItem(),microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);if(s&&s.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var b=microstrategy.findBone(s);return b&&b.isFilterPanel;}return false;case"isInsideNavBar":return selections.isItemInsideNavBar();case"showTranslucent":if(!this.ensureSelectedObjectTypes([microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_PANEL_STACK])){return false;}var iwm=this.queryState("InfoWindowMode");return this.queryState("UseAsInformationWindow")&&(iwm==="2"||iwm==="3"||iwm==="4");case"Transparency":return this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_PS_TRANSPARENCY,"Transparency");case"Blur":return(this.getCommonAttValue(selectedItems,microstrategy.HTMLATTR_PS_BLUR,"Blur")==="-1");case"optionAllVisible":case"allAliasVisible":return !this.queryState("isMetricQualifier")&&!this.queryState("isDDIC")&&!this.queryState("isAQSelector");case"DisplayInPartialScreen":return(this.getCommonAttValue(selectedItems,"dips","DisplayInPartialScreen")==="-1");case"InitialSlidingInWidthEnabled":var iwp=this.queryState("InfoWindowPosition");return this.queryState("UseAsInformationWindow")&&this.queryState("DisplayInPartialScreen")&&this.queryState("InfoWindowMode")==="4"&&(iwp==="3"||iwp==="4");case"InitialSlidingInHeightEnabled":var iwp=this.queryState("InfoWindowPosition");return this.queryState("UseAsInformationWindow")&&this.queryState("DisplayInPartialScreen")&&this.queryState("InfoWindowMode")==="4"&&(iwp==="1"||iwp==="2");case"ShowAsCollapsiblePanel":return(this.getCommonAttValue(selectedItems,"sacp","ShowAsCollapsiblePanel")==="-1");case"enableEmbeddedImages":return dv.EnableEmbeddedImages==="1";case"InitialSlidingInWidth":case"InitialSlidingInHeight":default:return selections.checkFormat(cmdId,allPanels);}}catch(err){microstrategy.errors.log(err);}return null;};mstrDocCommandsImpl.prototype.queryVisible=function(cmdId){var selections=this.parentBone.selections;if(mstrGridStaticScript&&mstrGridStatic.isGraphCommand(cmdId)){if(!selections||!selections.isOnlyOneGridSelected()){return false;}var g=microstrategy.findBone(selections.getSelectedGrid());if(!g){return false;}g=(g instanceof mstrReportGraphImpl)?g:microstrategy.bone(g.id+"_graph");return(g&&g.commands)?g.commands.queryVisible(cmdId):false;}try{var featSet,g;switch(cmdId){case"showCreatePanelSelector":return this.queryEnabled("onepanelstack")&&!this.queryEnabled("oneTable");case"tbUnitSelector":if(!this.queryEnabled("isNotLinkedGraph")){return false;}if(this.queryEnabled("onepanelstack")){return true;}return(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.queryEnabled("onegrid"));case"tbValueSelector":if(!this.queryEnabled("isNotLinkedGraph")){return false;}if(this.queryEnabled("onepanelstack")){return(this.queryState("IsPortal")&&this.parentBone.selections.panelUnitFormat!=1);}if(this.queryEnabled("onecontrol")){return(this.queryState("IsPortal")&&this.parentBone.selections.controlUnitFormat!=4);}if(!this.queryEnabled("onegrid")){return false;}if(this.parentBone.selections.isGridContainerSelected()){if(!this.queryState("IsPortal")){return false;}}else{if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE||this.parentBone.selections.gridUnitFormatX==microstrategy.GRID_BORDERS){return false;}}return true;case"TextAlign":return !(this.queryEnabled("onegrid")&&microstrategy.formatType!=2);case"GridHorizontal":return this.queryEnabled("onegrid")&&microstrategy.formatType!=2;case"visFlashMode":case"visAjaxMode":featSet="visualizations-supported;visualizations-available-for-rw-grids";if(!mstr.behaviors.featureResolver.resolveFeatSet(featSet,true)){return false;}if(!selections||!selections.isOnlyOneGridSelected()){return false;}g=microstrategy.findBone(selections.getSelectedGrid());return(g&&g.commands)?g.commands.queryVisible(cmdId):false;case"gridSelectedVisualization":featSet="visualizations-supported;visualizations-available-for-rw-grids";if(!mstr.behaviors.featureResolver.resolveFeatSet(featSet,true)){return false;}if(!selections||!selections.isOnlyOneGridSelected()){return false;}g=microstrategy.findBone(selections.getSelectedGrid());return(g&&g.commands)?g.commands.queryVisible("selectedVisualization"):false;case"tbLoading":return false;case"openBasicConditionalFormatting":featSet="rw-interactive-view-mode-eplus;use-basic-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(featSet,true)){return false;}return this.queryEnabled("openBasicConditionalFormatting");case"openAdvConditionalFormatting":featSet="rw-interactive-view-mode-eplus;use-advanced-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(featSet,true)){return false;}return this.queryEnabled("openAdvConditionalFormatting");case"openSimpleThresholdEditor":featSet="rw-interactive-view-mode-eplus;use-basic-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(featSet,true)){return false;}return !this.queryEnabled("openBasicConditionalFormatting");case"openAdvThresholdEditor":featSet="rw-interactive-view-mode-eplus;use-advanced-threshold-editor";if(!mstr.behaviors.featureResolver.resolveFeatSet(featSet,true)){return false;}return !this.queryEnabled("openAdvConditionalFormatting");case"showApplyThemeOnNode":case"showPropertiesAndFormatting":g=microstrategy.findBone(selections.getSelectedGrid());return mstr.behaviors.featureResolver.featAvailable(microstrategy.FEATURE_RW_EDITABLE_VIEW_MODE_EPLUS)||(mstr.behaviors.featureResolver.featAvailable("rw-interactive-view-mode")&&this.parentBone.selections.isOnlyOneGridSelected()&&g.commands.queryState("gridType")!="flash");default:return true;}}catch(err){}return false;};mstrDocCommandsImpl.prototype.searchForSelectedObjectType=function(types){try{if(types==null||types.length==0){return true;}var testTypes="~"+types.join("~")+"~";var testSubTypes="";var i=0;var cnt=0;var selections=this.parentBone.selections;var itemTypes=selections.getTypes();if(itemTypes==null||itemTypes.length==0){return false;}var templateSubTypes=testTypes.split(/obj.52\|/g);if(templateSubTypes.length>1){for(i=1,cnt=templateSubTypes.length;i<cnt;i++){testSubTypes+="~"+(parseInt(templateSubTypes[i].charAt(0))+1);}testSubTypes+="~";}var items=selections.getItems();for(i=0,cnt=itemTypes.length;i<cnt;i++){if(testSubTypes.length>0&&itemTypes[i]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var b=microstrategy.findBone(items[i]);if(testSubTypes.indexOf("~"+b.commands.queryState("effectiveView")+"~")>-1){return true;}}else{if(itemTypes[i]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE){if(testTypes.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE+"~")>-1){return true;}if(testTypes.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND+"~")>-1){if(items[i].getAttribute(microstrategy.HTMLATTR_STYLE)==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){return true;}}}else{if(testTypes.indexOf("~"+itemTypes[i]+"~")>-1){return true;}}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocCommandsImpl.prototype.ensureSelectedObjectTypes=function(types){try{if(types==null||types.length==0){return false;}var testTypes="~"+types.join("~")+"~";var testSubTypes="";var i=0;var cnt=0;var itemTypes=this.parentBone.selections.getTypes();if(itemTypes==null||itemTypes.length==0){return false;}var templateSubTypes=testTypes.split(/obj.52\|/g);if(templateSubTypes.length>1){for(i=1,cnt=templateSubTypes.length;i<cnt;i++){testSubTypes+="~"+(parseInt(templateSubTypes[i].charAt(0))+1);}testSubTypes+="~";}var items=this.parentBone.selections.getItems();for(i=0,cnt=itemTypes.length;i<cnt;i++){if(testSubTypes.length>0&&itemTypes[i]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_TEMPLATE){var b=microstrategy.findBone(items[i]);if(testSubTypes.indexOf("~"+b.commands.queryState("effectiveView")+"~")==-1){return false;}}else{if(itemTypes[i]==microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE){var shapeStyle=items[i].getAttribute(microstrategy.HTMLATTR_STYLE);if(shapeStyle==microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND){if(testTypes.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE_ROUND+"~")==-1){return false;}}else{if(testTypes.indexOf("~"+microstrategy.OBJTYPE_DOC_OBJECT+"."+microstrategy.SUBOBJTYPE_DOC_SHAPE+"~")==-1){return false;}}}else{if(!testTypes.match(new RegExp("~"+itemTypes[i]+"~"))){return false;}}}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocCommandsImpl.prototype.getCurrentSectionDef=function(){var s=microstrategy.findAncestorWithAtt(this.parentBone.selections.firstItem(),microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SECTION),b=microstrategy.findBone(s),dv=this.parentBone.parentBone,sectionsList=dv&&dv.sectionsList,currSecId=b.id,currSecDef=null;if(currSecId&&sectionsList){for(var i=0;i<sectionsList.length;i++){if(sectionsList[i].d===currSecId){currSecDef=sectionsList[i];break;}}}return currSecDef;};mstrDocCommandsImpl.prototype.belongsToSectionOfTypes=function(sectionsTypes){var currSecDef=this.getCurrentSectionDef();return currSecDef&&sectionsTypes&&(mstr.utils.Arrays.find(sectionsTypes,currSecDef.t)>-1);};mstrDocCommandsImpl.prototype.getCommonAttValue=function(items,att,prop,includeLine,formatType){try{var __result="";var dirty=false;if(typeof (includeLine)=="undefined"){includeLine=false;}for(var id in items){if(prop&&!microstrategy.isEnabledForItem(items[id],prop)){continue;}if(items[id].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_DOC_LINE&&includeLine==false){if(prop=="widthMode"||prop=="heightMode"||prop=="width"||prop=="height"){continue;}}var local=this.parentBone.styleObj.getAttValue(items[id],att,formatType);if(!dirty){__result=local;dirty=true;}if(local!=__result){return null;}}return __result;}catch(err){microstrategy.errors.log(err);return null;}};mstrDocCommandsImpl.prototype.getCommonBoneProperty=function(items,prop,sty,commonValue){try{for(var id in items){if(items[id].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&items[id].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==sty){var b=mstrStaticDoc.getBone(items[id]);if(b){if(b[prop]!=commonValue){return b[prop];}}}}}catch(err){microstrategy.errors.log(err);}return commonValue;};mstrDocCommandsImpl.prototype.getDDICBoneProperty=function(items,prop,sty,commonValue){try{for(var id in items){var item=items[id],b=mstrStaticDoc.getBone(item);while(item&&!b){item=item.parentElement;b=microstrategy.findBone(item);}if(b){var item=items[id],tscObjs=b.tscObjs;for(var j in tscObjs){var obj=tscObjs[j];if(obj.key===item.id){return obj[prop]||obj.ctl&&obj.ctl[prop]||obj.ctl&&obj.ctl.ddic&&obj.ctl.ddic[prop]||commonValue;}}}}}catch(err){microstrategy.errors.log(err);}return commonValue;};mstrDocCommandsImpl.prototype.setDDICBoneProperty=function(items,prop,value){try{for(var id in items){var item=items[id],b=mstrStaticDoc.getBone(item);while(item&&!b){item=item.parentElement;b=microstrategy.findBone(item);}if(b){var item=items[id],tscObjs=b.tscObjs;for(var j in tscObjs){var obj=tscObjs[j];if(obj.key===item.id){obj.ctl.ddic[prop]=value;}}}}}catch(err){microstrategy.errors.log(err);}};mstrDocCommandsImpl.prototype.isTypeSelectedInOB=function(type){try{var oObjBrowser=microstrategy.bone("reportObjs_RWWorkingSetStyle");if(oObjBrowser){var selections=oObjBrowser.selections;if(selections.length>0){var object=mstr.utils.Arrays.fromHashValues(selections.items)[0];if(object){if(object.getAttribute(microstrategy.HTMLATTR_DSS_TYPE)==type){return true;}}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrDocCommandsImpl.prototype.isDesignMode=function(){try{return microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE;}catch(err){microstrategy.errors.log(err);return false;}};function mstrDocCommandsImpl(){return this;}
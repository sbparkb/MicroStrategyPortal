mstrPanelStackScript=true;mstrPanelStack.prototype=new mstrRWUnitBoneImpl();mstrPanelStack.prototype.type=microstrategy.OBJTYPE_PANEL_STACK;mstrPanelStack.prototype.titleBars=null;mstrPanelStack.prototype.containers=null;mstrPanelStack.prototype.panels=null;mstrPanelStack.prototype.renderedPanels=null;mstrPanelStack.prototype.dirtyKeys=null;mstrPanelStack.prototype.panelMap=null;mstrPanelStack.prototype.docViewer=null;mstrPanelStack.prototype.currentPanelId=-1;mstrPanelStack.prototype.currentTbElem=null;mstrPanelStack.prototype.mouseTimer=null;mstrPanelStack.prototype.isTitleVisible=true;mstrPanelStack.prototype.titleBarDisplay=1;mstrPanelStack.prototype.customTitle="";mstrPanelStack.prototype.PREVIOUS_DIR=0;mstrPanelStack.prototype.NEXT_DIR=mstrPanelStack.CURRENT_PANEL;mstrPanelStack.prototype.disabled=false;mstrPanelStack.prototype.selectedTarget=null;mstrPanelStack.prototype.selectedLevel=null;mstrPanelStack.prototype.shadowContainer=null;mstrPanelStack.prototype.panelStackKeyContext="";mstrPanelStack.prototype.isFilterPanel=false;mstrPanelStack.prototype.commands=null;mstrPanelStack.prototype.elemTagName="span";mstrPanelStack.FMT_TYPE_TITLE="2";mstrPanelStack.heightAndWidthAttMap={hm:"heightMode",wm:"widthMode",ht:"height",wd:"width"};mstrPanelStack.CURRENT_PANEL=0;mstrPanelStack.CUSTOM_TITLE=1;mstrPanelStack.prototype.onload=function(){try{mstrRWUnitBoneImpl.prototype.onload.call(this);if(this.elem){this.resetDomObjects();this.panels=this.panels||[];this.panelMap=this.panelMap||{};var docViewer=this.getDocViewer();var doc=docViewer&&docViewer.doc;if(!doc){return ;}var docStyleObj=doc.styleObj;if(docStyleObj){this.isTitleVisible=docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE;this.titleBarDisplay=docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY);this.customTitle=(docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_WINDOW_TITLE))?docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_WINDOW_TITLE):"";this.isLocked=docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_LOCKED)==microstrategy.TRUE;this.isFilterPanel=docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_USE_AS_FILTER_PANEL)==microstrategy.TRUE;}this.toggleTitleBars();var p=this.containers[0].childNodes[0];while(p){this.registerPanel(p);p=p.nextSibling;}p=this.getCurrentPanel();this.setCurrentPanel(p.id);this.disabled=false;this.commands=new mstrPanelStackCommandsImpl(this);if(!this.itemFormats){this.itemFormats=new Object();this.itemFormats[mstrPanelStack.FMT_TYPE_TITLE]=docViewer.objProps.createFormatObject(microstrategy.SUBOBJTYPE_DOC_PANEL_STACK,mstrPanelStack.FMT_TYPE_TITLE);}this.resizeContent();this.synchronizeShadow();}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.onpostload=function(){try{if(this.isFilterPanel){for(var i=0;i<this.panels.length;i++){this.panels[i].onpostload();}}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.resetDomObjects=function(){this.titleBars=document.getElementsByName(this.id+"_toolbar");this.containers=document.getElementsByName(this.id+"_container");};mstrPanelStack.prototype.resetElement=function(){this.elem=document.getElementById(this.id);this.resetDomObjects();for(var i=0;i<this.panels.length;i++){this.panels[i].resetElement();}};mstrPanelStack.prototype.applyGradientOnTitle=function(){try{for(var i=0;i<this.titleBars.length;i++){var gradientSettings=(this.titleBars[i].getAttribute("gradientcolor"))?this.titleBars[i].getAttribute("gradientcolor").split(","):null;if(gradientSettings){gradientUtil.applyGradient(this.titleBars[i],gradientSettings[gradientUtil.GRADIENT_START_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_ANGLE_INDEX],gradientSettings[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientSettings[gradientUtil.GRADIENT_YOFFSET_INDEX]);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.synchronizeShadow=function(dropShadowEffect,dropShadowDepth){try{var docStyleObj=this.getDocViewer().doc.styleObj;dropShadowEffect=dropShadowEffect?dropShadowEffect:docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT);dropShadowDepth=dropShadowDepth!=undefined?dropShadowDepth:docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_DROP_SHADOW);var shadow=document.getElementById(this.elem.id+"_sh");if(shadow){shadow.parentNode.removeChild(shadow);}this.shadowContainer=null;if(dropShadowEffect=="1"){this.shadowContainer=this.elem.cloneNode(false);this.shadowContainer.setAttribute("sty","shw");this.shadowContainer.id=this.elem.id+"_sh";this.shadowContainer.setAttribute("name",this.elem.id+"_sh");this.elem.insertAdjacentElement("afterBegin",this.shadowContainer);this.shadowContainer.style.backgroundColor=docStyleObj.getValue(this.getCurrentPanel().elem,"backgroundColor");for(var i=0;i<this.elem.childNodes.length;i++){if(this.elem.childNodes[i].nodeType==1){this.elem.childNodes[i].style.zIndex=2;this.elem.childNodes[i].style.position="absolute";}}this.shadowContainer.style.zIndex=1;this.shadowContainer.style.left="-"+docStyleObj.getValue(this.elem,"borderLeftWidth",microstrategy.FORMAT_TYPE_MAIN);this.shadowContainer.style.top="-"+docStyleObj.getValue(this.elem,"borderTopWidth",microstrategy.FORMAT_TYPE_MAIN);var dropShadowInPixels=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,Math.round(dropShadowDepth*microstrategy.ZOOM_FACTOR/100));if(mstr.utils.ISDXIE){this.shadowContainer.style.filter="progid:DXImageTransform.Microsoft.dropshadow(Color='#66000000', Positive='true', OffX="+dropShadowInPixels+", OffY="+dropShadowInPixels+") ";}else{var cssShadow=mstr.utils.ISWK?"webkitBoxShadow":"boxShadow";this.shadowContainer.style[cssShadow]=dropShadowInPixels+"px "+dropShadowInPixels+"px 3px 0 #888";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.getItemFormats=function(){try{return this.itemFormats;}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.getAttValue=function(formatType,att){try{if(formatType==mstrPanelStack.FMT_TYPE_TITLE){if(this.titleBars&&this.titleBars.length>0){var o=microstrategy.styleObj.formattingAttributes[this.titleBars[0].getAttribute("id")];if(o!=null&&typeof (o[att])!="undefined"){return o[att];}return this.titleBars[0].getAttribute(att,0);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.setAttValue=function(formatType,att,value){try{this.itemFormats[formatType][att]=value;if(formatType==mstrPanelStack.FMT_TYPE_TITLE){if(this.titleBars&&this.titleBars.length>0){var id=this.titleBars[0].getAttribute("id");var o=microstrategy.styleObj.formattingAttributes[id];if(typeof (o)=="undefined"){microstrategy.styleObj.formattingAttributes[id]=new Object();microstrategy.styleObj.formattingAttributes[id][att]=value;}else{o[att]=value;}for(var i=0;i<this.titleBars.length;i++){this.titleBars[i].style[mstrPanelStack.heightAndWidthAttMap[att]]=mstrFormatObject.decodeValue(mstrPanelStack.heightAndWidthAttMap[att],value);}}}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.getFormatValue=function(formatType,prop){try{if(formatType!=microstrategy.FORMAT_TYPE_MAIN){formatType=mstrPanelStack.FMT_TYPE_TITLE;}if(prop=="gradientcolor"&&formatType==mstrPanelStack.FMT_TYPE_TITLE){if(this.titleBars&&this.titleBars.length>0){return this.titleBars[0].getAttribute(prop);}return null;}return this.itemFormats[formatType][prop];}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.setFormatValue=function(formatType,prop,value){try{if(!prop){return ;}this.itemFormats[formatType][prop]=value;if(formatType==mstrPanelStack.FMT_TYPE_TITLE){if(prop=="Gradient"){return ;}if(this.titleBars&&this.titleBars.length>0){for(var i=0;i<this.titleBars.length;i++){var el=this.titleBars[i];if(prop.indexOf("textDecoration")>-1){el=microstrategy.findChildWithAtt(el,"div",microstrategy.HTMLATTR_ID,"titleBar");}this.getDocViewer().doc.styleObj.formatElem(el,prop,value);if(prop&&prop.toLowerCase()=="backgroundcolor"){this.titleBars[i].setAttribute("bgstyle",(value=="transparent")?1:0);if(this.titleBars[i].getAttribute("gradientcolor")){this.titleBars[i].removeAttribute("gradientcolor");}}}}}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.applyGradientOnItem=function(formatType,prop,value,actionCollection,format){try{var titleBar;if(this.titleBars&&this.titleBars.length>0){titleBar=this.titleBars[0];}var oldData;var oldValue;if(titleBar&&formatType==mstrPanelStack.FMT_TYPE_TITLE){if(titleBar.getAttribute("gradientcolor")==null){oldData=titleBar.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR;oldValue=format.encodeValue("backgroundColor",this.getFormatValue(formatType,"backgroundColor"));}else{oldData=titleBar.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+"Gradient"+mstrUpdateManager.UNIT_SEPARATOR;oldValue=titleBar.getAttribute("gradientcolor");}var gradientSettings=value.split(",");var data_backStyle=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("backgroundStyle")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("backgroundStyle")+mstrUpdateManager.UNIT_SEPARATOR;var data_backColor=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR;var data_gradientColor=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("gradientColor")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("gradientColor")+mstrUpdateManager.UNIT_SEPARATOR;var data_gradientAngle=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("gradientAngle")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("gradientAngle")+mstrUpdateManager.UNIT_SEPARATOR;var data_gradientXOffset=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("gradientXOffset")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("gradientXOffset")+mstrUpdateManager.UNIT_SEPARATOR;var data_gradientYOffset=this.elem.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("gradientYOffset")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("gradientYOffset")+mstrUpdateManager.UNIT_SEPARATOR;if(actionCollection){actionCollection.push(microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.getDocViewer().beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data_backColor+format.encodeValue("backgroundColor",value)+mstrUpdateManager.ITEM_SEPARATOR+data_gradientColor+format.encodeValue("gradientColor",value)+mstrUpdateManager.ITEM_SEPARATOR+data_backStyle+format.encodeValue("backgroundStyle",value)+mstrUpdateManager.ITEM_SEPARATOR+data_gradientAngle+gradientSettings[3]+mstrUpdateManager.ITEM_SEPARATOR+data_gradientXOffset+gradientSettings[4]+mstrUpdateManager.ITEM_SEPARATOR+data_gradientYOffset+gradientSettings[5]+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,oldData+oldValue+mstrUpdateManager.ITEM_SEPARATOR]));}for(var i=0;i<this.titleBars.length;i++){this.titleBars[i].setAttribute("bgstyle","2");this.titleBars[i].setAttribute("gradientcolor",value);gradientUtil.applyGradient(this.titleBars[i],gradientSettings[gradientUtil.GRADIENT_START_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_ANGLE_INDEX],gradientSettings[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientSettings[gradientUtil.GRADIENT_YOFFSET_INDEX],this.getDocViewer().doc.styleObj);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.onApplyDefaultFormat=function(obj){try{var docViewer=this.getDocViewer();var docStyleObj=docViewer.doc.styleObj;var objProps=docViewer.objProps;var panelObj;var panel;for(var i=0;i<this.panels.length;i++){panelObj=this.panels[i];for(var j=0;j<panelObj.sibs.length;j++){panel=panelObj.sibs[j];objProps.initObjectFormat(panel,false,microstrategy.SUBOBJTYPE_DOC_PANEL);}}if(docStyleObj){this.elem.setAttribute(microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE));this.elem.setAttribute(microstrategy.HTMLATTR_TITLE_BAR_DISPLAY,docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY));this.isTitleVisible=docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE;this.titleBarDisplay=docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY);}this.toggleTitleBars();this.updatePortalTitle(this.customTitle);if(this.titleBars){for(var i=0;i<this.titleBars.length;i++){objProps.initObjectFormat(this.titleBars[i],false,microstrategy.SUBOBJTYPE_DOC_PANEL_STACK,mstrPanelStack.FMT_TYPE_TITLE);}}this.synchronizeSize();}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.onSetDefaultFormat=function(){try{var objProps=this.getDocViewer().objProps;objProps.setDefaultFormat(this.getCurrentPanel().elem);}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.toggleTitleBars=function(){try{for(var i=0;i<this.titleBars.length;i++){if(this.isTitleVisible){displayObj(this.titleBars[i]);}else{removeObj(this.titleBars[i]);}}if(this.isTitleVisible){this.applyGradientOnTitle();}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.onreload=function(e){try{if(this.disabled||!this.isBoneInPage()){microstrategy.unRegisterBone(this.id);}else{mstrRWUnitBoneImpl.prototype.onreload.call(this);this.onload();this.updateVerticalTextFields();}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.isBoneInPage=function(){try{var b=mstrBoneImpl.prototype.isBoneInPage.apply(this,arguments);if(b){var src=getElementById(this.id),st=microstrategy.subObjectType(src);b=(st==microstrategy.SUBOBJTYPE_DOC_PANEL_STACK);}return b;}catch(err){microstrategy.errors.log(err);return true;}};mstrPanelStack.prototype.updateVerticalTextFields=function(){var docViewer=this.getDocViewer(),tdUnits=docViewer&&docViewer.formattingAttributes&&docViewer.formattingAttributes.tdUnits;if(!bIsDXIE&&tdUnits&&this.elem){var panels=this.panels,updateNode=function(tdUnits,node){var styleObj=microstrategy.styleObj,rotation=0,childNodesCount;if(node){if(tdUnits.hasOwnProperty(node.id)){rotation=-parseInt(tdUnits[node.id],10);styleObj.changeTextFieldRotation(node,rotation);}else{if(node.hasChildNodes()){childNodesCount=node.childNodes.length;for(var i=0;i<childNodesCount;i++){updateNode(tdUnits,node.childNodes[i]);}}}}};for(var i=0;i<panels.length;++i){updateNode(tdUnits,panels[i].elem);}}};mstrPanelStack.prototype.syncToolbarElem=function(sn){try{mstrRWUnitBoneImpl.prototype.syncToolbarElem.call(this,sn);var childrenObjs=this.activeRWUnit.getElementsByTagName("div");for(var i=0;i<childrenObjs.length;i++){if(childrenObjs[i].getAttribute("scriptclass")){var bone=microstrategy.bone(childrenObjs[i].id);if(bone&&bone.hasToolbar){bone.syncToolbarElem(sn);}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.computeToolbarPos=function(){try{mstrRWUnitBoneImpl.prototype.computeToolbarPos.call(this);if(this.toolbar_pos_x+2<0||this.toolbar_pos_y<0){var panelElem=document.getElementById(this.getCurrentPanel().id);if(panelElem){this.toolbar_pos_x=getObjSumLeft(panelElem)-this.docViewer.doc.left;this.toolbar_pos_y=getObjSumTop(panelElem)-this.docViewer.doc.top;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.ondocobjectdrag=function(items,leftOffset,topOffset){try{for(var i=0;i<this.panels.length;i++){this.panels[i].hideMask();}for(var i in items){if(i==this.id){return ;}if(mstr.utils.Dom.containsElement(items[i],this.elem)){return ;}}this.getCurrentPanel().showMask(topOffset,leftOffset);}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.onmousedown=function(e){try{e=e||window.event;var src=findTarget(getEventTarget(e),microstrategy.HTMLATTR_CMD_ID);if(!src||src.getAttribute(microstrategy.HTMLATTR_CMD_ID)=="tb"){return ;}if((e.which==3)||(e.button==2)){return false;}if(src.getAttribute(microstrategy.HTMLATTR_CMD_ID)=="cm"){this.selectPanelStack(e);this.panelInsertMenu(e);}else{this.selectPanelStack();if(src.className.indexOf("Disabled")==-1){switch(src.getAttribute(microstrategy.HTMLATTR_CMD_ID)){case"ap":this.addPanel();break;case"dp":this.duplicatePanel();break;case"pp":this.moveCurrentPanel(this.PREVIOUS_DIR);break;case"np":this.moveCurrentPanel(this.NEXT_DIR);break;case"rp":this.removePanel();break;case"mpp":this.movePanel(this.PREVIOUS_DIR);break;case"mpn":this.movePanel(this.NEXT_DIR);break;case"rnp":this.renamePanel();break;case"pim":this.panelInsertMenu(e);break;}}}e.cancelBubble=true;return false;}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.selectPanelStack=function(e){try{var at=microstrategy.getViewerBone();var cmd="select";if(e&&e.ctrlKey){cmd=cmd+"_multiple";}var id=this.elem.id;var sty=this.elem.getAttribute("sty");at.commands.exec(cmd,(id+"|"+sty));}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.renamePanel=function(){try{var at=microstrategy.getViewerBone();at.commands.exec("rnp");}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.panelInsertMenu=function(e){try{var target=getEventTarget(e);var viewerBone=microstrategy.getViewerBone();if(target.getAttribute(microstrategy.HTMLATTR_CMD_ID)=="cm"){target=target.parentNode;}var x=getObjSumLeft(target)-getObjSumLeft(viewerBone.elem);var y=getObjSumTop(target)+getObjHeight(target)-getObjSumTop(viewerBone.elem);if(target.getClientRects||target.getBoundingClientRect){x+=viewerBone.elem.scrollLeft;}mstr.controllers.EventManager.notifyWindowListeners({name:"closeMenus"});microstrategy.setJLSCXMenuOpen(true);if(this.isFilterPanel){microstrategy.openBlockLoaderEditor("addToFilterPanelMenu","InsertMenuBlockLoader",null,{cssText:"position:absolute;top:"+y+"px;left:"+x+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",useFixedPosition:"false",contextMenuName:"insertSelector"},this,null,viewerBone.elem);}else{microstrategy.openBlockLoaderEditor("addToPanelMenu","InsertMenuBlockLoader",null,{cssText:"position:absolute;top:"+y+"px;left:"+x+"px;z-index:"+mstr.views.FloatingMenuBook.prototype.getZIndex()+";",useFixedPosition:"false",contextMenuName:"insertPanel"},this,null,viewerBone.elem);}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.removePanel=function(panel,addToUM,previousCurrentPanelId){try{var addToUpdateManager=true;var oldPanel=panel;if(!oldPanel){oldPanel=this.getCurrentPanel().elem;}if(addToUM!=null){addToUpdateManager=addToUM;}var panelId=oldPanel.getAttribute("id");var index=this.panelMap[panelId];var newIndex=(index==this.panels.length-1)?index-1:index;var i,cnt;for(i=0,cnt=this.containers.length;i<cnt;i++){this.containers[i].removeChild(this.containers[i].childNodes[index]);}var p=this.panels.splice(index,1);this.resetPanelMap();if(previousCurrentPanelId){this.setCurrentPanel(previousCurrentPanelId);}else{this.setCurrentPanel(this.panels[newIndex].id);}for(i=0,cnt=p.length;i<cnt;i++){p[i].deletePanel();}if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){microstrategy.eventManager.notifyOrphanBones("onRemovePanel",this.id,panelId,this.panels[newIndex].id);}if(addToUpdateManager){var ca=new Object();ca.panelStackId=this.id;ca.panelIndex=index;var um=this.docViewer.updateManager;um.add([um.createActionObject(oldPanel,mstrUpdateManager.REMOVE_PANEL,this.docViewer.beanPath,["2048018","2048012"],[mstrUpdateManager.UPDATE_LATER,panelId],[],ca)]);}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.PANEL_FORMATS=["backgroundColor"];mstrPanelStack.prototype.addPanel=function(oldPanel,addToUM,index){try{var dv=this.getDocViewer();if(!dv){return ;}var useExistingPanel=oldPanel?true:false;var addToUpdateManager=addToUM!=null?addToUM:true;var newPanel;if(useExistingPanel){newPanel=oldPanel;}else{newPanel=dv.commands.exec("createPanel");}var newIndex=index;if(!useExistingPanel){var curPanel=this.getCurrentPanel().elem;if(curPanel){var styleObj=this.getDocViewer().doc.styleObj;var val;for(var i in mstrPanelStack.PANEL_FORMATS){val=styleObj.getValue(curPanel,mstrPanelStack.PANEL_FORMATS[i]);styleObj.setValue(newPanel,mstrPanelStack.PANEL_FORMATS[i],val);}if(curPanel.getAttribute("gradientcolor")){newPanel.setAttribute("gradientcolor",curPanel.getAttribute("gradientcolor"));newPanel.setAttribute("bgstyle","2");}}}if((typeof (index)=="undefined")||index==null){for(var i=0;i<this.containers.length;i++){if(this.panelMap[this.currentPanelId]==this.containers[i].childNodes.length-1){this.containers[i].appendChild(newPanel);}else{newIndex=this.panelMap[this.currentPanelId]+1;this.containers[i].insertBefore(newPanel,this.containers[i].childNodes[newIndex]);}}}else{if(index==this.panels.length){for(var i=0;i<this.containers.length;i++){this.containers[i].appendChild(newPanel);}}else{for(var i=0;i<this.containers.length;i++){this.containers[i].insertBefore(newPanel,this.containers[i].childNodes[index]);}}}this.registerPanel(newPanel,newIndex);this.resetPanelMap();var oldPanelId=this.currentPanelId;if(this.renderedPanels){this.renderedPanels[newPanel.getAttribute("id")]=true;}this.setCurrentPanel(newPanel.getAttribute("id"));if(addToUpdateManager){var um=dv.updateManager;var ac=new Array();var ca=new Object();ca.panelStackId=this.id;ca.oldPanelId=oldPanelId;ac.push(um.createActionObject(newPanel,mstrUpdateManager.ADD_PANEL,dv.beanPath,["2048007","2048117","2048018"],[this.id,newPanel.getAttribute("id"),mstrUpdateManager.UPDATE_LATER],[],ca));um.add(ac);}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.duplicatePanel=function(){try{var dv=this.getDocViewer();if(!dv){return ;}var um=dv.updateManager;var ac=new Array();ac.push(um.createActionObject(this,mstrUpdateManager.DUPLICATE_PANEL,dv.beanPath,["2048117"],[this.currentPanelId],[],null));um.add(ac);um.flushAndSubmitChanges();}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.moveCurrentPanel=function(direction,addToUM,previousCurrentPanelId){try{var panelCount=this.panels.length;if(panelCount<=1){return ;}var dv=this.getDocViewer();if(!dv){return ;}var addToUpdateManager=true;if(addToUM!=null){addToUpdateManager=addToUM;}var oldPanelId=this.getCurrentPanel().id;var newPanelId=previousCurrentPanelId;if(!newPanelId){if(direction==this.PREVIOUS_DIR){newPanelId=this.panels[this.panelMap[oldPanelId]-1].id;}else{newPanelId=this.panels[this.panelMap[oldPanelId]+1].id;}}this.setCurrentPanel(newPanelId);if(addToUpdateManager){var um=dv.updateManager;var ac=new Array();var ca=new Object();ca.panelStackId=this.id;ca.oldPanelId=oldPanelId;ca.direction=direction;ac.push(um.createActionObject(oldPanelId,mstrUpdateManager.SET_CURRENT_PANEL,dv.beanPath,["2048007","2048117","2048137","2048018"],[this.id,newPanelId,this.panelStackKeyContext,mstrUpdateManager.UPDATE_LATER],[],ca));um.add(ac);}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.movePanel=function(direction,addToUM){try{var id=this.getCurrentPanel().id;var index=this.panelMap[id];var newIndex;if(direction==this.PREVIOUS_DIR){newIndex=index-1;for(var i=0;i<this.containers.length;i++){this.containers[i].insertBefore(this.containers[i].childNodes[index],this.containers[i].childNodes[newIndex]);}var p=this.panels.splice(index,1);this.panels.splice(index-1,0,p[0]);}else{newIndex=index+1;if(newIndex==this.panels.length-1){for(var i=0;i<this.containers.length;i++){var p=this.containers[i].removeChild(this.containers[i].childNodes[index]);this.containers[i].appendChild(p);}}else{for(var i=0;i<this.containers.length;i++){this.containers[i].insertBefore(this.containers[i].childNodes[index],this.containers[i].childNodes[newIndex]);}}var p=this.panels.splice(index,1);this.panels.splice(index+1,0,p[0]);}this.resetPanelMap();this.setCurrentPanel(id);var dv=this.getDocViewer();if(!dv){return ;}var addToUpdateManager=true;if(addToUM!=null){addToUpdateManager=addToUM;}if(addToUpdateManager){var um=dv.updateManager;var ac=new Array();var ca=new Object();ca.panelStackId=this.id;ca.direction=direction;ac.push(um.createActionObject(id,mstrUpdateManager.MOVE_PANEL,dv.beanPath,["2048007","2048117","2048018","2048118"],[this.id,id,mstrUpdateManager.UPDATE_LATER,direction],[],ca));um.add(ac);}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.createToolbar=function(){try{mstrRWUnitBoneImpl.prototype.createToolbar.call(this);this.toolbar.setAttribute(microstrategy.HTMLATTR_CMD_ID,"tb");this.toolbar.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e);");s=document.createElement("div");s.className="panelPrevious";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4717"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"pp");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelNext";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4718"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"np");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelAdd";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4719"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"ap");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelDuplicate";s.setAttribute("title",microstrategy.descriptors.getDescriptor("6048"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"dp");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelRemove";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4720"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"rp");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelMoveBack";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4721"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"mpp");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelMoveNext";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4722"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"mpn");this.toolbar.appendChild(s);s=document.createElement("div");s.className="panelRename";s.setAttribute("title",microstrategy.descriptors.getDescriptor("4795"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"rnp");this.toolbar.appendChild(s);if(this.getDocViewer().isFeatureAvailable(microstrategy.FEATURE_INSERT_INTO_PANEL)){s=document.createElement("div");s.className="panelInsertMenu";s.id="pim_"+this.id;s.setAttribute("title",microstrategy.descriptors.getDescriptor("2919"));s.setAttribute(microstrategy.HTMLATTR_CMD_ID,"pim");this.toolbar.appendChild(s);}this.setToolbarState();}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.setToolbarState=function(){try{if(this.toolbar==null){return ;}this.clearToolbarState();if(!this.containers[0]){return ;}for(var i=(this.containers[0].childNodes.length==1)?1:3;i<9;i++){if(this.toolbar.childNodes[i]){this.toolbar.childNodes[i].style.display=this.isLocked?"none":"block";}}if(this.containers[0].childNodes.length==1){if(this.toolbar.childNodes[1]){this.toolbar.childNodes[1].className+="Disabled";}if(this.toolbar.childNodes[2]){this.toolbar.childNodes[2].className+="Disabled";}if(this.toolbar.childNodes[5]){this.toolbar.childNodes[5].className+="Disabled";}if(this.toolbar.childNodes[6]){this.toolbar.childNodes[6].className+="Disabled";}if(this.toolbar.childNodes[7]){this.toolbar.childNodes[7].className+="Disabled";}return ;}var index=this.panelMap[this.getCurrentPanel().id];if(index==0){if(this.toolbar.childNodes[1]){this.toolbar.childNodes[1].className+="Disabled";}if(this.toolbar.childNodes[6]){this.toolbar.childNodes[6].className+="Disabled";}}if(index==this.panels.length-1){if(this.toolbar.childNodes[2]){this.toolbar.childNodes[2].className+="Disabled";}if(this.toolbar.childNodes[7]){this.toolbar.childNodes[7].className+="Disabled";}}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.clearToolbarState=function(){try{if(this.toolbar==null){return ;}var node=this.toolbar.childNodes[0];while(node){node.className=node.className.replace("Disabled","");node=node.nextSibling;}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.getDocViewer=function(){try{return microstrategy.getViewerBone();}catch(err){microstrategy.errors.log(err);}return null;};mstrPanelStack.prototype.registerPanel=function(p,index){try{var id=p.getAttribute("id");var bone;var newPanel=((typeof (index)=="undefined")||index==null||index==this.panels.length);if(!newPanel||(typeof (this.panelMap[id])=="undefined")){bone=new mstrPanel(id,this,"microstrategy.bone('"+this.id+"').getPanel('"+id+"')");bone.onload();if(newPanel){this.panelMap[id]=this.panels.length;this.panels.push(bone);var c=p.childNodes[0],rwbone=microstrategy.bone("rwb_viewer"),ddic=rwbone.ddic||{},dv=this.getDocViewer(),ddicCtlSrc=[].concat(dv.getAvailableAttributes?dv.getAvailableAttributes():[]).concat(dv.getAvailableMetrics?dv.getAvailableMetrics():[]);bone.tscObjs=[];while(c){if(c.getAttribute("trx")==="1"){var key=c.getAttribute("id"),tn=c.getAttribute("trxn"),tscObj={key:key,mapped:1,edt:1,tn:tn};if(c.getAttribute("trxctlkey")){var ctlkey=c.getAttribute("trxctlkey"),trxsid=c.getAttribute("trxsid"),tgs=c.getAttribute("trxtgs"),dfm=c.getAttribute("trxdfm"),autoSync=c.getAttribute("trxautosync"),isUs=c.getAttribute("trxisus"),ust=c.getAttribute("trxust"),adts=c.getAttribute("trxadts"),ctlSrc=mstr.$A.filter(ddicCtlSrc,{filter:function(ctlSrc){return ctlSrc.dssid.indexOf(trxsid)>=0;}},"filter");tscObj.ctl={ctlKey:ctlkey};if(trxsid){tscObj.ctl.ddic={trxsid:trxsid,targetKeys:tgs||"",ctlSrc:ctlSrc.length>0?ctlSrc[0].dssid:"",autoSync:autoSync==="true"};rwbone.doc.formattingAttributes[key].dfm=dfm;rwbone.doc.formattingAttributes[key].ust=ust;rwbone.doc.formattingAttributes[key].isUs=(isUs==="true");rwbone.doc.formattingAttributes[key].adts=adts;}}bone.tscObjs.push(tscObj);}c=c.nextSibling;}rwbone.ddic=ddic;}else{this.panelMap[id]=index;this.panels.splice(index,0,bone);}this.getDocViewer().doc.addPanelMask&&this.getDocViewer().doc.addPanelMask(bone);}else{if(typeof (this.panelMap[id])!="undefined"){if(this.currentPanelId==id){bone=this.panels[this.panelMap[id]];if(bone){bone.synchronizeSize();}}else{if(p.getAttribute("pu")=="1"){bone=this.panels[this.panelMap[id]];if(bone){bone.onload();}p.removeAttribute("pu");}}}}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.getPanel=function(id){try{return(id==-1)?this.panels[0]:this.panels[this.panelMap[id]];}catch(err){microstrategy.errors.log(err);}return null;};mstrPanelStack.prototype.getCurrentPanel=function(){try{return this.getPanel(this.currentPanelId);}catch(err){microstrategy.errors.log(err);}return null;};mstrPanelStack.prototype.setCurrentPanel=function(id,addToUpdateManager){try{var panels=document.getElementsByName(id);if(panels.length==0){return ;}var oldPanel=this.getCurrentPanel();var oldPanelId=this.currentPanelId;if(oldPanel&&oldPanel.id!=id){var oldPanels=document.getElementsByName(oldPanel.id);for(var i=0;i<oldPanels.length;i++){oldPanels[i].style.display="none";}}this.currentPanelId=id;this.elemSaved=this.elem;for(var i=0;i<panels.length;i++){panels[i].style.display="block";var p=panels[i];this.showPanel(p,id,oldPanelId);}this.elem=this.elemSaved;this.adjustTitle(panels[0]);this.setToolbarState();var keys="";if(this.renderedPanels&&!this.renderedPanels[id]){keys=id;this.renderedPanels[id]=true;}else{if(this.dirtyKeys&&this.dirtyKeys[id]){var addDelim=false;for(var k in this.dirtyKeys[id]){if(addDelim){keys+=",";}else{addDelim=true;}keys+=k;}this.dirtyKeys[id]=null;}}if(addToUpdateManager||keys){var dv=this.getDocViewer();var um=dv.updateManager;var ac=new Array();var ca=new Object();ca.panelStackId=this.id;ca.oldPanelId=oldPanelId;ac.push(um.createActionObject(oldPanelId,mstrUpdateManager.SET_CURRENT_PANEL,dv.beanPath,["2048007","2048117","2048137","2048018","2048178"],[this.id,id,this.panelStackKeyContext,mstrUpdateManager.UPDATE_LATER,keys],[],ca));um.add(ac);if(keys){if(!dv.hasStylesFor(id)){um.addURL("ruleCounter="+dv.ruleCounter);}um.flushAndSubmitChanges();}}microstrategy.eventManager.notifyOrphanBones("onpanelchange");}catch(err){microstrategy.errors.log(err);}return null;};mstrPanelStack.prototype.showPanel=function(p,id,oldPanelId){window.setTimeout(function(){var pb=microstrategy.findBone(p);if(pb.elem!=p||id!=oldPanelId){pb.onShowCalled=false;pb.elem=p;}pb.onShow();},0);};mstrPanelStack.prototype.switchToPanel=function(dir){var curElem=this.getCurrentPanel().elem;var newElem=dir==-1?curElem.previousSibling:curElem.nextSibling;if(newElem!=null){this.setCurrentPanel(newElem.id,true);curElem.style.display="none";newElem.style.display="block";this.updateIconStatus(this.titleBars[0],newElem);}};mstrPanelStack.prototype.updateIconStatus=function(titleBar,elem){var pst=microstrategy.findChildrenWithAtt(titleBar,"SPAN","ps","1");if(pst&&pst.length>0){var icons={previous:pst[0],next:pst[1]};for(var p in icons){var icon=icons[p];if(elem[p+"Sibling"]){icon.className=icon.className.replace(/ disabled/g,"");}else{icon.className+=" disabled";}}}};mstrPanelStack.prototype.addDirtyKey=function(panel,key){try{if(!this.dirtyKeys){this.dirtyKeys={};}if(!this.dirtyKeys[panel.id]){this.dirtyKeys[panel.id]={};}this.dirtyKeys[panel.id][key]=true;}catch(err){microstrategy.errors.log(err);}return null;};mstrPanelStack.prototype.updatePortalTitle=function(title){try{var toolbars=document.getElementsByName(this.id+"_toolbar");if(!title){title="";}if(this.titleBarDisplay==mstrPanelStack.CUSTOM_TITLE){for(var i=0;i<toolbars.length;i++){this.setTitle(toolbars[i],title);}}this.customTitle=title;}catch(err){}};mstrPanelStack.prototype.setTitle=function(obj,title){var titleText=microstrategy.findChildWithAtt(obj,"DIV",microstrategy.HTMLATTR_ID,"titleBar");titleText.innerHTML=encode(title);};mstrPanelStack.prototype.adjustTitle=function(panel){try{if(!panel){panel=this.getCurrentPanel().elem;}var docStyleObj=this.getDocViewer().doc.styleObj;var toolbars=document.getElementsByName(this.id+"_toolbar");for(var i=0;i<toolbars.length;i++){var title;if(this.titleBarDisplay==mstrPanelStack.CURRENT_PANEL){title=(docStyleObj.getAttValue(panel,microstrategy.HTMLATTR_WINDOW_TITLE))?docStyleObj.getAttValue(panel,microstrategy.HTMLATTR_WINDOW_TITLE):"";}else{title=this.customTitle;}this.setTitle(toolbars[i],title);}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.getPanelMap=function(){try{return this.panelMap;}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.resetPanelMap=function(){try{this.panelMap=new Object();for(var i=0;i<this.panels.length;i++){this.panelMap[this.panels[i].id]=i;}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.isPanelCurrent=function(id){try{return(this.getCurrentPanel().id==id);}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.synchronizeSize=function(){try{var docStyleObj=this.getDocViewer().doc.styleObj;var formatType=microstrategy.formatType;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;var w=parseInt(docStyleObj.getValue(this.elem,"width"));var h=parseInt(docStyleObj.getValue(this.elem,"height"));microstrategy.formatType=formatType;if(this.isTitleVisible&&h>getObjHeight(this.titleBars[0])){h-=getObjHeight(this.titleBars[0]);}if(!isNaN(h)&&!isNaN(w)){for(var i=0;i<this.panels.length;i++){this.panels[i].resize(h,w);}}this.resizeContent();this.synchronizeShadow();}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.resize=function(height,width){try{this.elem.style.height=height+"px";this.elem.style.width=width+"px";this.resizeContent();if(this.isTitleVisible){height-=getObjHeight(this.titleBars[0]);}for(var i=0;i<this.panels.length;i++){this.panels[i].resize(height,width);}this.synchronizeShadow();}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.resizeContent=function(){try{var docStyleObj=this.getDocViewer().doc.styleObj;var padding=parseInt(docStyleObj.getValue(this.elem,"padding"));padding=isNaN(padding)?1:padding;for(var i=0;i<this.containers.length;i++){this.containers[i].parentNode.style.height=this.elem.style.height?this.elem.style.height:Math.max(parseInt(docStyleObj.getValue(this.elem,"height",microstrategy.FORMAT_TYPE_MAIN))-(2*padding),0)+"px";}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.deleteStack=function(){try{this.disabled=true;for(var i=0;i<this.panels.length;i++){this.panels[i].deletePanel();}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.onPanelDeleted=function(id){try{if(id&&this.panelMap[id]){var parent=microstrategy.findAncestor(this.elem.parentNode);if(parent&&(parent.getAttribute("id")===id)){this.deleteStack();}}}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.onredo=function(action){try{var actionID=action.id;if(action.cachedArray&&action.cachedArray.panelStackId==this.id){switch(actionID){case mstrUpdateManager.ADD_PANEL:this.addPanel(action.elem,false,action.cachedArray.panelIndex);break;case mstrUpdateManager.REMOVE_PANEL:this.removePanel(action.elem,false);break;case mstrUpdateManager.SET_CURRENT_PANEL:this.moveCurrentPanel(action.cachedArray.direction,false,action.cachedArray.redoPanelId);break;case mstrUpdateManager.MOVE_PANEL:this.movePanel(action.cachedArray.direction,false);break;}}this.undoredo(action);}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.setControlGroupByList=function(value,ac){try{var updateManager=microstrategy.updateManager;var finalOrder="";for(var i=0;i<value.length;i++){finalOrder+=(i>0)?"!":"";finalOrder+=value[i].dssid;}ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.RW_REORDER_CONTROL_GROUP_BY,this.getDocViewer().beanPath,["2048012","2048173"],[this.id,finalOrder],[]));this.ControlGroupByList=value;}catch(err){microstrategy.errors.log(err);}};mstrPanelStack.prototype.onSubSectionShow=function(){try{if(this.isLoaded){this.resizeContent();}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.onundo=function(action){try{var actionID=action.id;if(action.cachedArray&&action.cachedArray.panelStackId==this.id){switch(actionID){case mstrUpdateManager.ADD_PANEL:this.removePanel(action.elem,false,action.cachedArray.oldPanelId);break;case mstrUpdateManager.REMOVE_PANEL:this.addPanel(action.elem,false,action.cachedArray.panelIndex);break;case mstrUpdateManager.SET_CURRENT_PANEL:action.cachedArray.redoPanelId=this.currentPanelId;this.moveCurrentPanel(direction,false,action.cachedArray.oldPanelId);break;case mstrUpdateManager.MOVE_PANEL:var direction=(action.cachedArray.direction==this.PREVIOUS_DIR)?this.NEXT_DIR:this.PREVIOUS_DIR;this.movePanel(direction,false);break;}}this.undoredo(action);}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStack.prototype.undoredo=function(action){try{var actionID=action.id;if(action.elem&&action.elem.getAttribute&&action.elem.getAttribute("id")==this.RWUnitId){switch(actionID){case mstrUpdateManager.EDIT_PROPS:var a=action.args[1].split(mstrUpdateManager.UNIT_SEPARATOR);if(a[1]=="Gradient"){return ;}var prop=a[1]&&a[2]&&mstrFormatObject[a[1]][a[2]]&&mstrFormatObject[a[1]][a[2]][mstrFormatObject.HTML_PROP_NAME];var value=a[3];value=(value.substr(value.length-1)==mstrUpdateManager.ITEM_SEPARATOR)?value.substr(0,value.length-1):value;value=mstrFormatObject.decodeValue(prop,value);if(a[1]=="FormattingView"){switch(prop){case"showTitleBar":this.isTitleVisible=value==microstrategy.TRUE;this.toggleTitleBars();break;case"titleBarDisplay":this.titleBarDisplay=value;break;case"windowTitle":value=(value=="null"||!value)?"":value;this.docViewer.doc.styleObj.setAttValue(this.elem,"wt",value);this.updatePortalTitle(value);this.adjustTitle();break;}}else{if(a[1]=="FormattingPosition"){switch(prop){case"locked":this.isLocked=value==microstrategy.TRUE;if(this.resetToolbar){this.resetToolbar();}break;}}}break;}}}catch(err){microstrategy.errors.log(err);return false;}};function mstrPanelStack(id){this.inherits=mstrRWUnitBoneImpl;this.inherits(id);delete this.inherits;return this;}mstrPanelStackCommandsImpl.prototype=new Object();mstrPanelStackCommandsImpl.prototype.exec=function(cmdId,cmdVal){try{}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStackCommandsImpl.prototype.queryEnabled=function(cmdId,allPanels){try{switch(cmdId){case"Hmode":return !(microstrategy.formatType==mstrPanelStack.FMT_TYPE_TITLE);case"Height":return(microstrategy.formatType==mstrPanelStack.FMT_TYPE_TITLE&&this.parentBone.isTitleVisible==true);case"number":case"deltaDecimal":case"align":return false;case"font":case"fsize":case"fstyle":case"color":return microstrategy.formatType==mstrPanelStack.FMT_TYPE_TITLE;case"lncolor":case"borders":case"lnstyle":case"lineColor":case"borderLeftStyle":case"lineStyle":return(microstrategy.formatType==microstrategy.FORMAT_TYPE_MAIN&&allPanels!=true);case"advColorPicker":case"major":case"minor":case"dValues":case"level":case"target":case"edtColorGradient":case"gradientcolor":case"b3dstyle":case"b3dweight":case"enabled3d":case"bgcolor":return true;}}catch(err){microstrategy.errors.log(err);return false;}};mstrPanelStackCommandsImpl.prototype.queryState=function(cmdId,allPanels){try{switch(cmdId){case"getControlGroupByList":return this.parentBone.ControlGroupByList;default:if(allPanels==true){return this.parentBone.docViewer.doc.commands.queryState(cmdId,allPanels);}else{return this.parentBone.docViewer.doc.commands.queryState(cmdId);}}}catch(err){microstrategy.errors.log(err);return false;}};function mstrPanelStackCommandsImpl(parentBone){this.parentBone=parentBone;return this;}
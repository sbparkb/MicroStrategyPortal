GradientUtilScript=true;var gradientUtil=new function(){};gradientUtil.prototype=new Object();gradientUtil.PIXEL_WIDTH=2;gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL=1;gradientUtil.GRADIENTSHADING_STYLE_VERTICAL=2;gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP=3;gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN=4;gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER=5;gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER=6;gradientUtil.GRADIENTSHADING_STYLE_CUSTOM=7;gradientUtil.GRADIENT_START_COLOR_INDEX=0;gradientUtil.GRADIENT_END_COLOR_INDEX=1;gradientUtil.GRADIENT_TRANSITION_TYPE_INDEX=2;gradientUtil.GRADIENT_ANGLE_INDEX=3;gradientUtil.GRADIENT_XOFFSET_INDEX=4;gradientUtil.GRADIENT_YOFFSET_INDEX=5;gradientUtil.GRADIENT_POSTFIX="_gradient";gradientUtil.getXCoordinate=function(pixelNum,width){try{return parseInt(pixelNum%(width/this.PIXEL_WIDTH));}catch(err){microstrategy.errors.log(err);return false;}};gradientUtil.getYCoordinate=function(pixelNum,height){try{return parseInt(pixelNum/(height/this.PIXEL_WIDTH));}catch(err){microstrategy.errors.log(err);return false;}};gradientUtil.getColorPercent=function(xx,yy,boxNum,width,shadingOption){try{switch(parseInt(shadingOption)){case gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:if(boxNum==1){return xx*gradientUtil.PIXEL_WIDTH/width;}else{if(boxNum==2){return 1-xx*gradientUtil.PIXEL_WIDTH/width;}else{if(boxNum==3){return 1-(((-2)*Math.abs(xx-(width/gradientUtil.PIXEL_WIDTH)/2))+(width/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/width;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_VERTICAL:if(boxNum==1){return yy*gradientUtil.PIXEL_WIDTH/width;}else{if(boxNum==2){return 1-yy*gradientUtil.PIXEL_WIDTH/width;}else{if(boxNum==3){return 1-(((-2)*Math.abs(yy-(width/gradientUtil.PIXEL_WIDTH)/2))+(width/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/width;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_DIAGONALUP:if(boxNum==1){return((xx+yy)*gradientUtil.PIXEL_WIDTH/width)/2;}else{if(boxNum==2){return 1-((xx+yy)*gradientUtil.PIXEL_WIDTH/width)/2;}else{if(boxNum==3){return 1-(((-1)*Math.abs((xx+yy)-(width/gradientUtil.PIXEL_WIDTH)))+(width/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/width;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_DIAGONALDOWN:if(boxNum==1){return 1-((xx+(width/gradientUtil.PIXEL_WIDTH)-yy)*gradientUtil.PIXEL_WIDTH/width)/2;}else{if(boxNum==2){return((xx+(width/gradientUtil.PIXEL_WIDTH)-yy)*gradientUtil.PIXEL_WIDTH/width)/2;}else{if(boxNum==3){return 1-(((-1)*Math.abs((xx+(width/gradientUtil.PIXEL_WIDTH)-yy)-(width/gradientUtil.PIXEL_WIDTH)))+(width/gradientUtil.PIXEL_WIDTH))*gradientUtil.PIXEL_WIDTH/width;}}}break;case gradientUtil.GRADIENTSHADING_STYLE_FROMCORNER:if(boxNum==1){return Math.max(xx,yy)*gradientUtil.PIXEL_WIDTH/width;}else{if(boxNum==2){return Math.max((width/gradientUtil.PIXEL_WIDTH)-xx,yy)*gradientUtil.PIXEL_WIDTH/width;}else{if(boxNum==3){return 1-Math.min(xx,yy)*gradientUtil.PIXEL_WIDTH/width;}else{if(boxNum==4){return 1-Math.min((width/gradientUtil.PIXEL_WIDTH)-xx,yy)*gradientUtil.PIXEL_WIDTH/width;}}}}break;case gradientUtil.GRADIENTSHADING_STYLE_FROMCENTER:var divisor=2*gradientUtil.PIXEL_WIDTH;if(boxNum==1){return 1-(2*Math.min(Math.min((width/gradientUtil.PIXEL_WIDTH)-xx,xx),Math.min((width/gradientUtil.PIXEL_WIDTH)-yy,yy)))*gradientUtil.PIXEL_WIDTH/width;}else{if(boxNum==2){return((Math.abs(xx-(width/divisor))/(width/divisor))+(Math.abs(yy-(width/divisor))/(width/divisor)))/2;}else{if(boxNum==3){return Math.sqrt((Math.pow(Math.abs(xx-(width/divisor)),2)+Math.pow(Math.abs(yy-(width/divisor)),2))/Math.pow((width/divisor),2));}}}break;}}catch(err){microstrategy.errors.log(err);}};gradientUtil.getRGBColor=function(color){try{if(color.indexOf("#")>=0){color=color.substring(color.indexOf("#")+1);}var _result=new Array();if(color.length==6){var r=parseInt(color.substring(0,2),16);var g=parseInt(color.substring(2,4),16);var b=parseInt(color.substring(4,6),16);_result.push(r);_result.push(g);_result.push(b);return _result;}else{return[0,0,0];}}catch(err){microstrategy.errors.log(err);return false;}};gradientUtil.createIntervalColors=function(color1,color2,totalWidth,intervalWidth){try{var intervalColors=new Array();var diff=(totalWidth-intervalWidth)/2;intervalColors[0]=gradientUtil.createIntervalColor(color1,color2,(totalWidth-diff)/totalWidth);intervalColors[1]=gradientUtil.createIntervalColor(color1,color2,diff/totalWidth);return intervalColors;}catch(err){microstrategy.errors.log(err);return false;}};gradientUtil.createIntervalColor=function(color1,color2,portion){try{var temp=gradientUtil.setColorHue(gradientUtil.longHexToDec(color1),portion,gradientUtil.longHexToDec(color2));return mstr.utils.Color.rgb2hex(temp[0],temp[1],temp[2]);}catch(err){microstrategy.errors.log(err);return false;}};gradientUtil.setColorHue=function(originColor,opacityPercent,maskRGB){try{var returnColor=new Array();for(var w=0;w<originColor.length;w++){returnColor[w]=Math.round(originColor[w]*opacityPercent)+Math.round(maskRGB[w]*(1-opacityPercent));returnColor[w]=returnColor[w]>255?255:returnColor[w];}return returnColor;}catch(err){microstrategy.errors.log(err);return false;}};gradientUtil.longHexToDec=function(longHex){try{return new Array(gradientUtil.toDec(longHex.substring(0,2)),gradientUtil.toDec(longHex.substring(2,4)),gradientUtil.toDec(longHex.substring(4,6)));}catch(err){microstrategy.errors.log(err);return false;}};gradientUtil.toDec=function(hex){try{return parseInt(hex,16);}catch(err){microstrategy.errors.log(err);return false;}};gradientUtil.applyGradientSettings=function(gradientBackground,gradientSettings,styleObj){gradientUtil.applyGradient(gradientBackground,gradientSettings[gradientUtil.GRADIENT_START_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_ANGLE_INDEX],gradientSettings[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientSettings[gradientUtil.GRADIENT_YOFFSET_INDEX],microstrategy.styleObj);};gradientUtil.applyGradient=function(gradientBackground,startColor,endColor,gradientAngle,gradientXOffset,gradientYOffset,styleObj){try{var gradientDirection=(gradientAngle==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;if((gradientDirection==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL&&gradientXOffset!=100)||(gradientDirection==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL&&gradientYOffset!=100)){gradientUtil.createGradient(gradientBackground,startColor,endColor,gradientDirection,styleObj,true);}else{gradientUtil.createGradient(gradientBackground,endColor,startColor,gradientDirection,styleObj,false);}}catch(err){microstrategy.errors.log(err);return false;}};gradientUtil.createGradient=function(gradientBackground,startColor,endColor,gradientDirection,styleObj,isStartColorFirst){try{var gradientType=(gradientDirection==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL)?1:0;if(bIsDXIE){var fromRules=false;var filterText=gradientBackground.style.filter;if((filterText==null||filterText.length==0)&&styleObj){filterText=styleObj.getFilter(gradientBackground);if(filterText&&filterText.length>0){fromRules=true;}}var gradientFilter=null;if(filterText!=null&&filterText.length>0){gradientFilter=gradientBackground.filters["DXImageTransform.Microsoft.Gradient"];}if((getObjInnerHeight(gradientBackground)<2&&gradientDirection==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL)||(getObjInnerWidth(gradientBackground)<2&&gradientDirection==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL)){if(gradientFilter){gradientFilter.enabled=false;}gradientBackground.style.backgroundColor="#"+startColor;return ;}if(gradientFilter!=null){gradientFilter.gradientType=gradientType;gradientFilter.startColorStr="#FF"+startColor;gradientFilter.endColorStr="#FF"+endColor;gradientFilter.enabled=true;}else{if(!fromRules){gradientBackground.style.filter+="progid:DXImageTransform.Microsoft.Gradient(GradientType="+gradientType+", StartColorStr='#"+startColor+"', EndColorStr='#"+endColor+"') ";}else{styleObj.objSheet.styleRules[styleObj.getId(gradientBackground)].style.filter+="progid:DXImageTransform.Microsoft.Gradient(GradientType="+gradientType+", StartColorStr='#"+startColor+"', EndColorStr='#"+endColor+"') ";}}gradientBackground.style.backgroundColor="transparent";}else{gradientBackground.style.backgroundColor="#"+((isStartColorFirst==true)?startColor:endColor);var sc="#"+startColor,ec="#"+endColor;if(mstr.utils.ISFF){gradientBackground.style.background="-moz-linear-gradient("+((gradientType===0)?"top":"left")+","+sc+","+ec+")";}else{if(mstr.utils.ISWK){gradientBackground.style.background="-webkit-gradient(linear,"+((gradientType===0)?"left top, left bottom":"left top, right top")+",from("+sc+"),to("+ec+"))";}else{if(mstr.utils.ISIE10||mstr.utils.ISW3CIE){gradientBackground.style.background="linear-gradient("+((gradientType===0)?"to bottom":"to right")+","+sc+","+ec+")";}}}}}catch(err){microstrategy.errors.log(err);return false;}};
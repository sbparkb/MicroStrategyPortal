mstrAdvancedOptionsImplScript=true;mstrAdvancedOptionsImpl.prototype=new mstrBoneImpl();mstrAdvancedOptionsImpl.prototype.parentBone=null;mstrAdvancedOptionsImpl.prototype.path=null;mstrAdvancedOptionsImpl.prototype.saveasForm=null;mstrAdvancedOptionsImpl.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.validateOptions();if(this.elem){this.elem.onclick=new Function("e","return "+this.path+".onclick(e);");}}catch(err){microstrategy.errors.log(err);return false;}};mstrAdvancedOptionsImpl.prototype.onclick=function(e){try{if(!e){e=window.event;}var src=getEventTarget(e);if(src){switch(src.id){case"saveAsAdvKeepPrompt10":this.changeNonStaticOptions(false);break;case"saveAsAdvKeepPrompt11":case"saveAsAdvFltTempPromptOptions10":case"saveAsAdvFltTempPromptOptions11":case"saveAsAdvFltTempPromptOptions12":case"saveAsKeepFilterShortcuts":case"saveAsKeepTemplateShortcuts":this.validateOptions();break;}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrAdvancedOptionsImpl.prototype.toggleAdvanced=function(bShow){this.elem.style.display=bShow?"block":"none";};mstrAdvancedOptionsImpl.prototype.validateOptions=function(){var oForm=this.saveasForm;if(oForm){var saveAsSimpleKeepLinked=document.getElementById("saveAsSimpleKeepLinked");var saveAsKeepTemplateShortcuts=document.getElementById("saveAsKeepTemplateShortcuts");var saveAsKeepFilterShortcuts=document.getElementById("saveAsKeepFilterShortcuts");var saveAsKeepFilterManipulations=document.getElementById("saveAsKeepFilterManipulations");var saveAsKeepPromptAnswers=document.getElementById("saveAsKeepPromptAnswers1");var saveAsAdvFltTempPromptOptions=null;var option0=document.getElementById("saveAsAdvFltTempPromptOptions10");var option1=document.getElementById("saveAsAdvFltTempPromptOptions11");var option2=document.getElementById("saveAsAdvFltTempPromptOptions12");var field=document.getElementsByName("saveAsAdvFltTempPromptOptions1");if(field){for(var b=0;b<field.length;b++){if(field[b].checked==true){saveAsAdvFltTempPromptOptions=field[b].value;}}}this.changeNonStaticOptions(true);if(saveAsKeepTemplateShortcuts||saveAsKeepFilterShortcuts){if(saveAsSimpleKeepLinked){if(saveAsKeepTemplateShortcuts&&saveAsKeepFilterShortcuts){if(saveAsKeepTemplateShortcuts.checked==true&&saveAsKeepFilterShortcuts.checked==true){saveAsSimpleKeepLinked.setAttribute("cmdval","1");saveAsSimpleKeepLinked.src=microstrategy.FOLDER_IMAGES+"check_on.gif";}else{if(saveAsKeepTemplateShortcuts.checked==false&&saveAsKeepFilterShortcuts.checked==false){saveAsSimpleKeepLinked.setAttribute("cmdval","0");saveAsSimpleKeepLinked.src=microstrategy.FOLDER_IMAGES+"check_off.gif";}else{saveAsSimpleKeepLinked.setAttribute("cmdval","-1");saveAsSimpleKeepLinked.src=microstrategy.FOLDER_IMAGES+"Check_conflict.gif";}}}else{if(saveAsKeepTemplateShortcuts){if(saveAsKeepTemplateShortcuts.checked==true){saveAsSimpleKeepLinked.setAttribute("cmdval","1");saveAsSimpleKeepLinked.src=microstrategy.FOLDER_IMAGES+"check_on.gif";}else{if(saveAsKeepTemplateShortcuts.checked==false){saveAsSimpleKeepLinked.setAttribute("cmdval","0");saveAsSimpleKeepLinked.src=microstrategy.FOLDER_IMAGES+"check_off.gif";}}}else{if(saveAsKeepFilterShortcuts){if(saveAsKeepFilterShortcuts.checked==true){saveAsSimpleKeepLinked.setAttribute("cmdval","1");saveAsSimpleKeepLinked.src=microstrategy.FOLDER_IMAGES+"check_on.gif";}else{if(saveAsKeepFilterShortcuts.checked==false){saveAsSimpleKeepLinked.setAttribute("cmdval","0");saveAsSimpleKeepLinked.src=microstrategy.FOLDER_IMAGES+"check_off.gif";}}}}}}if(saveAsKeepFilterManipulations&&saveAsKeepFilterShortcuts){if(saveAsKeepFilterShortcuts.checked==true){saveAsKeepFilterManipulations.checked=false;this.modifyOption("saveAsKeepFilterManipulations",false);}}if(saveAsAdvFltTempPromptOptions){if(saveAsKeepTemplateShortcuts&&saveAsKeepFilterShortcuts){if(saveAsKeepTemplateShortcuts.checked==true&&saveAsKeepFilterShortcuts.checked==true){if((option0&&option0.checked==true)||(option1&&option1.checked==true)){if(option2){option2.checked=true;}}this.modifyOption("saveAsAdvFltTempPromptOptions10",false);this.modifyOption("saveAsAdvFltTempPromptOptions11",false);document.getElementById("saveAsAdvKeepPrompt11").checked=true;this.modifyOption("saveAsAdvKeepPrompt10",false);this.synchSimplePromptOptions();}else{if(saveAsKeepTemplateShortcuts.checked==false&&saveAsKeepFilterShortcuts.checked==false){this.modifyOption("saveAsAdvFltTempPromptOptions10",true);this.modifyOption("saveAsAdvFltTempPromptOptions11",true);this.modifyOption("saveAsAdvFltTempPromptOptions12",true);this.modifyOption("saveAsAdvKeepPrompt10",true);this.synchSimplePromptOptions();}else{if(saveAsKeepTemplateShortcuts.checked==true&&saveAsKeepFilterShortcuts.checked==false){if(option0&&option0.checked==true){if(option2){option2.checked=true;}}this.modifyOption("saveAsAdvFltTempPromptOptions10",false);this.modifyOption("saveAsAdvFltTempPromptOptions11",true);document.getElementById("saveAsAdvKeepPrompt11").checked=true;this.modifyOption("saveAsAdvKeepPrompt10",false);this.synchSimplePromptOptions();}else{if(saveAsKeepTemplateShortcuts.checked==false&&saveAsKeepFilterShortcuts.checked==true){if(option1&&option1.checked==true){if(option2){option2.checked=true;}}this.modifyOption("saveAsAdvFltTempPromptOptions10",true);this.modifyOption("saveAsAdvFltTempPromptOptions11",false);document.getElementById("saveAsAdvKeepPrompt11").checked=true;this.modifyOption("saveAsAdvKeepPrompt10",false);this.synchSimplePromptOptions();}}}}}else{if(saveAsKeepTemplateShortcuts){if(saveAsKeepTemplateShortcuts.checked==false){this.modifyOption("saveAsAdvFltTempPromptOptions10",true);this.modifyOption("saveAsAdvFltTempPromptOptions11",true);this.modifyOption("saveAsAdvFltTempPromptOptions12",true);this.modifyOption("saveAsAdvKeepPrompt10",true);this.synchSimplePromptOptions();}else{if(saveAsKeepTemplateShortcuts.checked==true){if(option0&&option0.checked==true){if(option2){option2.checked=true;}}this.modifyOption("saveAsAdvFltTempPromptOptions10",false);this.modifyOption("saveAsAdvFltTempPromptOptions11",true);document.getElementById("saveAsAdvKeepPrompt11").checked=true;this.modifyOption("saveAsAdvKeepPrompt10",false);this.synchSimplePromptOptions();}}}else{if(saveAsKeepFilterShortcuts){if(saveAsKeepFilterShortcuts.checked==false){this.modifyOption("saveAsAdvFltTempPromptOptions10",true);this.modifyOption("saveAsAdvFltTempPromptOptions11",true);this.modifyOption("saveAsAdvFltTempPromptOptions12",true);this.modifyOption("saveAsAdvKeepPrompt10",true);this.synchSimplePromptOptions();}else{if(saveAsKeepFilterShortcuts.checked==true){if(option1&&option1.checked==true){if(option2){option2.checked=true;}}this.modifyOption("saveAsAdvFltTempPromptOptions10",true);this.modifyOption("saveAsAdvFltTempPromptOptions11",false);document.getElementById("saveAsAdvKeepPrompt11").checked=true;this.modifyOption("saveAsAdvKeepPrompt10",false);this.synchSimplePromptOptions();}}}}}}var promptOption=document.getElementById("saveAsAdvFltTempPromptOptions1");if(promptOption&&saveAsKeepFilterManipulations){if(promptOption.checked==true){this.saveAsKeepFilterManipulations.checked=false;this.modifyOption("saveAsKeepFilterManipulations",false);}}}if(typeof isDrilledReport!="undefined"&&isDrilledReport&&saveAsKeepFilterManipulations){var promptOption0=document.getElementById("saveAsAdvFltTempPromptOptions10");var promptOption2=document.getElementById("saveAsAdvFltTempPromptOptions12");if((promptOption0&&promptOption0.checked==true)||(promptOption2&&promptOption2.checked==true)){saveAsKeepFilterManipulations.checked=true;this.modifyOption("saveAsKeepFilterManipulations",false);}}var staticPromptOption=document.getElementById("saveAsAdvKeepPrompt10");if(staticPromptOption&&staticPromptOption.checked==true){this.changeNonStaticOptions(false);}this.synchSimplePromptOptions();}};mstrAdvancedOptionsImpl.prototype.changeNonStaticOptions=function(enable){if(enable==false){this.modifyOption("saveAsAdvFltTempPromptOptions10",false);this.modifyOption("saveAsAdvFltTempPromptOptions11",false);this.modifyOption("saveAsAdvFltTempPromptOptions12",false);this.modifyOption("saveAsKeepFilterManipulations",false);this.modifyOption("saveAsKeepPromptAnswers1",false);this.modifyOption("saveAsKeepTemplateShortcuts",false);this.modifyOption("saveAsKeepFilterShortcuts",false);}else{this.modifyOption("saveAsAdvFltTempPromptOptions10",true);this.modifyOption("saveAsAdvFltTempPromptOptions11",true);this.modifyOption("saveAsAdvFltTempPromptOptions12",true);this.modifyOption("saveAsKeepFilterManipulations",true);this.modifyOption("saveAsKeepPromptAnswers1",true);this.modifyOption("saveAsKeepTemplateShortcuts",true);this.modifyOption("saveAsKeepFilterShortcuts",true);}this.synchSimplePromptOptions();};mstrAdvancedOptionsImpl.prototype.validateSimpleOptions=function(object){var simplePromptOption=document.getElementById("saveAsSimpleKeepPrompt");var simpleLinkedOption=document.getElementById("saveAsSimpleKeepLinked");if(object.id=="saveAsSimpleKeepPrompt"&&simplePromptOption){var advPromptOption0=document.getElementById("saveAsAdvKeepPrompt10");var advPromptOption1=document.getElementById("saveAsAdvKeepPrompt11");if(simplePromptOption.checked==false){if(advPromptOption0){advPromptOption0.checked=true;}this.changeNonStaticOptions(false);}else{if(advPromptOption1){advPromptOption1.checked=true;}this.validateOptions();}}if(object.id=="saveAsSimpleKeepLinked"&&simpleLinkedOption){var saveAsKeepTemplateShortcuts=document.getElementById("saveAsKeepTemplateShortcuts");var saveAsKeepFilterShortcuts=document.getElementById("saveAsKeepFilterShortcuts");if(object.getAttribute("cmdval")=="-1"||object.getAttribute("cmdval")=="0"){if(saveAsKeepTemplateShortcuts){saveAsKeepTemplateShortcuts.checked=true;}if(saveAsKeepFilterShortcuts){saveAsKeepFilterShortcuts.checked=true;}object.setAttribute("cmdval","1");object.src=microstrategy.FOLDER_IMAGES+"check_on.gif";}else{if(object.getAttribute("cmdval")=="1"){if(saveAsKeepTemplateShortcuts){saveAsKeepTemplateShortcuts.checked=false;}if(saveAsKeepFilterShortcuts){saveAsKeepFilterShortcuts.checked=false;}object.setAttribute("cmdval","0");object.src=microstrategy.FOLDER_IMAGES+"check_off.gif";}}this.validateOptions();}};mstrAdvancedOptionsImpl.prototype.modifyOption=function(objId,enable){var obj=document.getElementById(objId);var objLabel=document.getElementById(objId+"_label");if(obj&&objLabel){if(enable==false){obj.disabled=true;objLabel.className="disabledLabel";}else{obj.disabled=false;objLabel.className="";}}};mstrAdvancedOptionsImpl.prototype.synchSimplePromptOptions=function(){var saveAsSimpleKeepPrompt=document.getElementById("saveAsSimpleKeepPrompt");if(saveAsSimpleKeepPrompt){if(document.getElementById("saveAsAdvKeepPrompt11").checked==true){saveAsSimpleKeepPrompt.checked=true;}else{saveAsSimpleKeepPrompt.checked=false;}if(document.getElementById("saveAsAdvKeepPrompt10").disabled==true||document.getElementById("saveAsAdvKeepPrompt11").disabled==true){saveAsSimpleKeepPrompt.disabled=true;document.getElementById("saveAsSimpleKeepPrompt_label").className="disabledLabel";}else{saveAsSimpleKeepPrompt.disabled=false;document.getElementById("saveAsSimpleKeepPrompt_label").className="";}}};mstrAdvancedOptionsImpl.prototype.setSaveasForm=function(oForm){this.saveasForm=oForm;};mstrAdvancedOptionsImpl.setRadioValue=function(value,name){var obj=document.getElementsByName(name);if(obj){for(i=0;i<obj.length;i++){if(obj[i].value==value){obj[i].checked=true;}}}};mstrAdvancedOptionsImpl.setCheckboxValue=function(value,name){var obj=document.getElementById(name);if(obj){if(value=="1"){obj.checked=true;}else{obj.checked=false;}}};mstrAdvancedOptionsImpl.getRadioValue=function(name){var obj=document.getElementsByName(name);var value="";if(obj){for(i=0;i<obj.length;i++){if(obj[i].checked==true){value=obj[i].value;}}}return value;};mstrAdvancedOptionsImpl.getCheckboxValue=function(name){var obj=document.getElementById(name);var value="";if(obj&&obj.checked==true){value=obj.value;}return value;};mstrAdvancedOptionsImpl.ifFound=function(oForm,name){var found=false;var oInputs=oForm.getElementsByTagName("input");for(i=0;i<oInputs.length;i++){found=(oInputs[i].name==name);if(found){found=true;break;}}return found;};function mstrAdvancedOptionsImpl(id){this.inherits=mstrBoneImpl;this.inherits(id);delete this.inherits;return this;}
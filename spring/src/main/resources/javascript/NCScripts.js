ncScript=true;function switchWidget(showId,hideId,addressTypeId,newAddressType){var oHide=getObj(hideId);var oShow=getObj(showId);var oAddressType=getObj(addressTypeId);if(oHide!=null&&oShow!=null){if(oHide.getAttribute("disabled")==null||oHide.disabled==false){setEnabledState(oHide,false);setEnabledState(oShow,true);if(oAddressType!=null){oAddressType.value=newAddressType;}fireResizeEvent();}}return false;}function showCcOrBcc(ccOrBccDivId,ccOrBccLinkSpanID){var oHide=getObj(ccOrBccLinkSpanID);var oShow=getObj(ccOrBccDivId);if(oHide!=null&&oShow!=null){if(oHide.getAttribute("disabled")==null||oHide.disabled==false){removeObj(oHide);displayObj(oShow);}}return false;}function ShowMessageTextInput(showId,hideId){removeObj(hideId);displayObj(showId);return false;}function CheckTextAreaMaxLengthForMessage(e,oTextArea,lMaxLength){var oStr=oTextArea.value;var evt=e||window.event;if(oStr.length>=lMaxLength&&(evt&&evt.keyCode!=46&&evt.keyCode!=8)){return false;}}function LimitTextAreaMaxLengthForMessage(oTextArea,lMaxLength){if(oTextArea.value.length>lMaxLength){oTextArea.value=oTextArea.value.substring(0,lMaxLength);}}function disableAddress(locationObj,addressID){var oAddressID=document.getElementById("DIV_"+addressID);var locationSelected=(locationObj&&locationObj.selectedIndex>=0)?locationObj.options[locationObj.selectedIndex]:null;if(oAddressID&&locationSelected){if(locationSelected.getAttribute("ADDRQD")=="true"){displayObj(oAddressID);}if(locationSelected.getAttribute("ADDRQD")=="false"){removeObj(oAddressID);}var addrInput=document.getElementById(addressID);if(addrInput){if(locationSelected.getAttribute("hasPath")=="true"&&addrInput.getAttribute(mstrHTMLAttributes.ATTR_NOZEROSTR)){addrInput.removeAttribute(mstrHTMLAttributes.ATTR_NOZEROSTR,0);}if(locationSelected.getAttribute("hasPath")=="false"){addrInput.setAttribute(mstrHTMLAttributes.ATTR_NOZEROSTR,"true");}}}}function disableSendPreview(triggerObj,sendNowID,expID){var oSendNowID=document.getElementById("DIV_"+sendNowID);var sendNowChkBox=document.getElementById(sendNowID);var expChkBox=document.getElementById(expID);var nameDiv=document.getElementById("DIV_SubName");if(oSendNowID&&sendNowChkBox&&expChkBox&&nameDiv){if(triggerObj.options[triggerObj.selectedIndex].getAttribute("SendNow")=="true"){sendNowChkBox.checked=true;oSendNowID.style.visibility="hidden";expChkBox.checked=false;expChkBox.onclick();expChkBox.disabled=true;nameDiv.style.display="none";}if(triggerObj.options[triggerObj.selectedIndex].getAttribute("SendNow")=="false"){if(oSendNowID.style.visibility=="hidden"){sendNowChkBox.checked=false;}oSendNowID.style.visibility="visible";expChkBox.disabled=false;nameDiv.style.display="block";}}}function updateAddressListsForNotification(oCheckBox,existingAddressListId,newAddressListId){if(!oCheckBox){return ;}if(typeof oCheckBox=="string"){oCheckBox=document.getElementById(oCheckBox);}var checked=oCheckBox.checked;var oExistingAddressDiv=document.getElementById(existingAddressListId);setEnabledState(oExistingAddressDiv,checked);if(!checked||oExistingAddressDiv==null){var oNewAddressDiv=document.getElementById(newAddressListId);setEnabledState(oNewAddressDiv,checked);}fireResizeEvent();}function setEnabledState(oDiv,bEnabled){if(!oDiv){return ;}var i=0;if(bEnabled){oDiv.disabled=false;displayObj(oDiv);}else{oDiv.disabled=true;removeObj(oDiv);}var oInputs=oDiv.getElementsByTagName("input");for(i=0;i<oInputs.length;i++){if(bEnabled){oInputs[i].disabled=false;}else{oInputs[i].disabled=true;}}var oLabels=oDiv.getElementsByTagName("label");for(i=0;i<oLabels.length;i++){if(bEnabled){oLabels[i].disabled=false;}else{oLabels[i].disabled=true;}}var oSelects=oDiv.getElementsByTagName("select");for(i=0;i<oSelects.length;i++){if(bEnabled){oSelects[i].disabled=false;}else{oSelects[i].disabled=true;}}var oAnchors=oDiv.getElementsByTagName("a");if(oAnchors){for(i=0;i<oAnchors.length;i++){if(bEnabled){oAnchors[i].style.cursor="pointer";}else{oAnchors[i].style.cursor="default";}}}return ;}function updateZipCheckBoxDiv(checkBox,checkBoxDiv,fileNameDiv,zipValue){if(!checkBoxDiv){return ;}if(zipValue==1){removeObj(checkBoxDiv);}else{if(zipValue==2){displayObj(checkBoxDiv);checkBoxDiv.style.display="inline";checkBox.disabled=false;if(fileNameDiv){displayObj(fileNameDiv);}}else{if(zipValue==4){displayObj(checkBoxDiv);checkBoxDiv.style.display="inline";checkBox.disabled=true;checkBox.checked=false;if(fileNameDiv){removeObj(fileNameDiv);}}else{if(zipValue==8){removeObj(checkBoxDiv);}else{displayObj(checkBoxDiv);checkBoxDiv.style.display="inline";checkBox.disabled=false;}}}}}function UpdateZipCheckboxandMessage(SelectID,checkBoxDivID,errorMessageID,checkBoxID,lReportView,fileNameDivID,zipFileNameID,advOptionZipCheckBoxID,advOptionZipFieldID){var oSelect=getObj(SelectID);if(!oSelect){return ;}if(oSelect.disabled){return ;}if(isNaN(parseInt(oSelect.selectedIndex))){return ;}if(oSelect.selectedIndex<0){return ;}var oCheckBox=document.getElementById(checkBoxID);var bDisplayError=false;var fileNameDiv=getObj(fileNameDivID);if(oCheckBox){updateZipCheckBoxDiv(oCheckBox,getObj(checkBoxDivID),fileNameDiv,parseInt(oSelect.options[oSelect.selectedIndex].getAttribute("ZIPVALUE")));}compressCheckBoxClicked(checkBoxID,zipFileNameID,advOptionZipCheckBoxID,advOptionZipFieldID);if(parseInt(lReportView)==3){if(parseInt(oSelect.options[oSelect.selectedIndex].getAttribute("SUPPORTEDVIEW"))!=3){bDisplayError=true;}}else{if(parseInt(lReportView)==2){if((parseInt(oSelect.options[oSelect.selectedIndex].getAttribute("SUPPORTEDVIEW"))!=3)&&(parseInt(oSelect.options[oSelect.selectedIndex].getAttribute("SUPPORTEDVIEW"))!=2)){bDisplayError=true;}}}if(bDisplayError){displayObj(errorMessageID);getObj(errorMessageID).style.display="";}else{removeObj(errorMessageID);}fireResizeEvent();return true;}function UpdatePageByCheckbox(SelectID,checkBoxDivID){var oSelect=getObj(SelectID);if(!oSelect){return ;}if(isNaN(parseInt(oSelect.selectedIndex))){return ;}if(oSelect.selectedIndex<0){return ;}var oCheckBoxDiv=document.getElementById(checkBoxDivID);if(!oCheckBoxDiv){return ;}var bEnable=parseInt(oSelect.options[oSelect.selectedIndex].getAttribute("PageBy"))==1;var oCheckBox=document.getElementById("fModeExAll");if(!oCheckBox){return ;}if(bEnable&&oCheckBox.useBurst){return ;}setEnabledState(oCheckBoxDiv,bEnable);return true;}function ToggleDelimiters(SelectID,delimitersDivID,delimiterSelectID){var oSelect=getObj(SelectID);if(!oSelect){return ;}if(isNaN(parseInt(oSelect.selectedIndex))){return ;}if(oSelect.selectedIndex<0){return ;}var delimitersDiv=document.getElementById(delimitersDivID);if(!delimitersDiv){return ;}var bShow=parseInt(oSelect.options[oSelect.selectedIndex].getAttribute("showDelimiters"))==1;delimitersDiv.style.display=bShow?"":"none";var delimiterSelect=document.getElementById(delimiterSelectID);if(!delimiterSelect){return ;}delimiterSelect.disabled=bShow?false:true;var otherDelimiter=document.getElementById("OtherDelimeter");if(!otherDelimiter){return ;}if(!bShow){otherDelimiter.disabled=true;}else{changeDelimiterOption(delimiterSelect);}}function toggleTriStateChkBox(triID,isDisable){var tri=document.getElementById(triID);if(tri&&tri.className){var base=tri.className.split("_");tri.className=base[0]+(isDisable?"_d":"_3");tri.setAttribute("tri_disabled",(isDisable?"true":"false"));}}function switchToDualState(elem,inputID,triID){var elem=getObj(elem);if(elem&&elem.getAttribute("tri_disabled")!="true"&&elem.getAttribute("dual")!="1"){var dual=document.getElementById(inputID+"_d");var inputs=document.getElementsByName(inputID);var vInput=null;var hInput=null;for(var i=0;i<inputs.length;i++){if(inputs[i].type=="checkbox"){vInput=inputs[i];}if(inputs[i].type=="hidden"){hInput=inputs[i];}}if(elem&&dual&&vInput&&hInput){elem.setAttribute("dual","1");elem.style.display="none";dual.style.display="";vInput.value="1";hInput.value="0";switchToDualState(triID+"_t",triID);}}}function UpdateExpandUseSeparateSheetsCheckbox(SelectID,PageByCheckID,checkBoxDivID){var oSelect=getObj(SelectID);var separate;if(oSelect){for(i=0;i<oSelect.length;i++){if(oSelect[i].type=="select"){oSelect=oSelect[i];continue;}}if(isNaN(parseInt(oSelect.selectedIndex))){return ;}separate=(parseInt(oSelect.options[oSelect.selectedIndex].getAttribute("Separate"))==1);}else{oSelect=getObj("static_"+SelectID);if(!oSelect){return ;}separate=(parseInt(oSelect.getAttribute("Separate"))==1);}var oPagebyCheck=getObj(PageByCheckID);if(!oPagebyCheck){return ;}for(i=0;i<oPagebyCheck.length;i++){if(oPagebyCheck[i].type=="checkbox"){oPagebyCheck=oPagebyCheck[i];continue;}}if(!oPagebyCheck){return ;}var oCheckBoxDiv=document.getElementById(checkBoxDivID);if(!oCheckBoxDiv){return ;}setEnabledState(oCheckBoxDiv,separate&&!oPagebyCheck.disabled&&oPagebyCheck.checked);fireResizeEvent();return true;}function compressCheckBoxClicked(checkBoxDivID,fileNameFieldID,advOptionZipCheckBoxID,advOptionZipTextFieldID){var checkBox=getCheckbox(checkBoxDivID);var fileNameDiv=getObj(fileNameFieldID);var advOptionZipCheckBox=getCheckbox(advOptionZipCheckBoxID);var advOptionZipTextField=getObj(advOptionZipTextFieldID);if(!checkBox||!checkBox.checked){if(fileNameDiv){fileNameDiv.disabled=true;}if(advOptionZipCheckBox){advOptionZipCheckBox.disabled=true;advOptionZipCheckBox.checked=false;}if(advOptionZipTextField){advOptionZipTextField.disabled=true;}}else{if(fileNameDiv){fileNameDiv.disabled=false;}if(advOptionZipCheckBox){advOptionZipCheckBox.disabled=false;}if(advOptionZipTextField){advOptionZipTextField.disabled=(advOptionZipTextField==null)||(advOptionZipCheckBox.checked==false);}}}function toggleSectionCommon(image,advOptionsDivID,showImgSrc,hideImgSrc,showAlt,hideAlt){if(!image){return ;}var advOptions=getObj(advOptionsDivID);if(!advOptions){return ;}if(advOptions.style.display=="none"){advOptions.style.display="";image.src=hideImgSrc;if(hideAlt){image.setAttribute("alt",hideAlt);image.setAttribute("title",hideAlt);}}else{advOptions.style.display="none";image.src=showImgSrc;if(showAlt){image.setAttribute("alt",showAlt);image.setAttribute("title",showAlt);}}fireResizeEvent();}function advancedOptionImageClicked(image,advOptionsDivID,showImgSrc,hideImgSrc,showAlt,hideAlt){toggleSectionCommon(image,advOptionsDivID,showImgSrc,hideImgSrc,showAlt,hideAlt);}function toggleSubscriptionPanel(image,subscriptionPanelID,showImgSrc,hideImgSrc,showAlt,hideAlt){toggleSectionCommon(image,subscriptionPanelID,showImgSrc,hideImgSrc,showAlt,hideAlt);}function fireResizeEvent(){if(mstr.utils.ISW3C){mstr.controllers.EventManager.notifyWindowListeners({name:"resize"});}}function changeSendToHistory(checkBoxIncLinkID,targetCheckBoxID){var checkBoxSource=getCheckbox(checkBoxIncLinkID);if(!checkBoxSource){return ;}var checkBoxTarget=getCheckbox(targetCheckBoxID);if(!checkBoxTarget){return ;}if(checkBoxSource.checked){checkBoxTarget.checked=true;checkBoxTarget.disabled=true;}else{checkBoxTarget.disabled=false;}}function toggleTextField(checkBoxID,textFieldID,containerDivID){var checkBox=getCheckbox(checkBoxID);if(!checkBox){return ;}var textField=getObj(textFieldID);if(!textField){return ;}textField.disabled=!checkBox.checked;if(!textField.disabled){var container=getObj(containerDivID);if(container&&container.style.display!="none"){textField.focus();}}}function toggleExpDate(checkBoxID,textFieldID,containerDivID,calendarId,enabledImg,disabledImg){toggleTextField(checkBoxID,textFieldID,containerDivID);var checkBox=document.getElementById(checkBoxID);var calendar=document.getElementById(calendarId);if(checkBox&&calendar){calendar.disabled=!checkBox.checked;calendar.setAttribute("src",calendar.disabled?disabledImg:enabledImg);}}function zipPwdTextClicked(advOptionZipTextFieldID){var advOptionZipTextField=getObj(advOptionZipTextFieldID);if(!advOptionZipTextField){return ;}if(!advOptionZipTextField.disabled){advOptionZipTextField.focus();}}function getCheckbox(option){oOption=getObj(option);if(!oOption){return null;}if(oOption.type=="checkbox"){return oOption;}for(var i=0;i<oOption.length;i++){if(oOption[i].type=="checkbox"){return oOption[i];}}return null;}function submitRemoveRecipientEvent(divID,contactID,addressID,locationKey,includeType){var div=getObj(divID);var enclosingForm=microstrategy.findParentWithTag(div,"form");if(enclosingForm){var hiddenInput=createHiddenInput(enclosingForm,"256015","1");hiddenInput.setAttribute("id","256015");hiddenInput=createHiddenInput(enclosingForm,"contactID",contactID);hiddenInput.setAttribute("id","contactID");hiddenInput=createHiddenInput(enclosingForm,"locationKey",locationKey);hiddenInput.setAttribute("id","locationKey");hiddenInput=createHiddenInput(enclosingForm,"addId",addressID);hiddenInput.setAttribute("id","addId");hiddenInput=createHiddenInput(enclosingForm,"emailDestinationType",includeType);hiddenInput.setAttribute("id","emailDestinationType");submitForm(enclosingForm,true);}}function updateAlertObjSelector(oRadio,bEnable){var oSpanContent=document.getElementById("contentName");var oBrowseButton=document.getElementById("alertsObjBrowse");if(bEnable){oBrowseButton.disabled=false;oSpanContent.className="alertContentNameSpanEnabled";}else{oBrowseButton.disabled=true;oSpanContent.className="alertContentNameSpanDisabled";}}function openAlertsObjSelector(oInput,sBeanNameArg,sBeanNameVal,sEventId){if(!oInput){return false;}var oParentForm=findTargetTag(oInput,"FORM");if(!oParentForm){return false;}updateDynamicInput(oParentForm,sBeanNameArg,sBeanNameVal);updateDynamicInput(oParentForm,sEventId,"1",[]);submitForm(oParentForm);return true;}function submitAlertsForm(oInput,confirmSubmit){if(!confirmSubmit){return false;}if(!oInput){return false;}var oParentForm=findTargetTag(oInput,"FORM");if(!oParentForm){return false;}submitForm(oParentForm);}function changeDelimiterOption(oSelect){if(!oSelect){return false;}var inputOtherDelimiter=document.getElementById("OtherDelimeter");if(oSelect.options[oSelect.selectedIndex].value=="Other"){inputOtherDelimiter.style.display="";inputOtherDelimiter.disabled=false;}else{if(inputOtherDelimiter.style.display!="none"){inputOtherDelimiter.style.display="none";inputOtherDelimiter.disabled=true;}}}function updatePageByDataAndHistoryList(selectId,optionValue){var oSelect=document.getElementById(selectId);if(oSelect){onChangeDataAndHistoryList(oSelect,optionValue);}}function onChangeDataAndHistoryList(oSelect,optionValue){if(oSelect.options[oSelect.selectedIndex].getAttribute("value")==optionValue){toggleRelatedComponent(true);}else{toggleRelatedComponent(false);}}function toggleRelatedComponent(isDisable){var componentsId=["fstate","zip","fileName","protectZipFile","zipPwd","compressedFileName","expLayouts","fModeExAll","delimiter","OtherDelimeter"];for(var id=0;id<componentsId.length;id++){var component=document.getElementById(componentsId[id]);if(component){component.disabled=(isDisable)?true:false;}if(componentsId[id]=="expLayouts"||componentsId[id]=="fModeExAll"){toggleTriStateChkBox(componentsId[id]+"_t",isDisable);}}if(!isDisable){var fstate=document.getElementById("fstate");var static_fstate=document.getElementById("static_fstate");var zipValue=2;if(static_fstate){zipValue=parseInt(static_fstate.getAttribute("ZIPVALUE"));}else{if(fstate&&fstate.selectedIndex>=0){zipValue=parseInt(fstate.options[fstate.selectedIndex].getAttribute("ZIPVALUE"));}}updateZipCheckBoxDiv(document.getElementById("zip"),document.getElementById("NCZIPFORMAT"),document.getElementById("DIV_fileName"),zipValue);compressCheckBoxClicked("zip","compressedFileName","protectZipFile","zipPwd");toggleTextField("protectZipFile","zipPwd","NCSADVOPTS");var delimitersDiv=document.getElementById("DelimitersDiv");disableOtherDelimiter(fstate,delimitersDiv);}}function disableOtherDelimiter(fstate,delimitersDiv){if(fstate==null){return ;}if(delimitersDiv==null){return ;}if(parseInt(fstate.selectedIndex)!=3&&delimitersDiv.style.display=="none"){document.getElementById("delimiter").disabled=true;if(document.getElementById("OtherDelimeter")!=null){document.getElementById("OtherDelimeter").disabled=true;}}}function openContactBrowser(obj,addrValuesId,addrSectionId){var fnRR=function(el,a){if(el&&el.getAttribute(a)){var t=el.getAttribute(a);el.removeAttribute(a,0);return t;}return null;};var addrValuesInput=document.getElementById(addrValuesId);var dty=fnRR(addrValuesInput,mstrHTMLAttributes.ATTR_DTY);var nonzero=fnRR(addrValuesInput,mstrHTMLAttributes.ATTR_NOZEROSTR);var addrSection=document.getElementById(addrSectionId);var hasAddr=fnRR(addrSection,"hasAddr");var oForm=microstrategy.findAncestorWithTag(obj,"FORM");if(oForm&&mstrEditorImpl.validateInputs(oForm,true)){if(oForm.onsubmit){oForm.onsubmit();}createHiddenInput(oForm,obj.id,obj.value);submitForm(oForm);}else{if(dty!=null){addrValuesInput.setAttribute(mstrHTMLAttributes.ATTR_DTY,dty);}if(nonzero!=null){addrValuesInput.setAttribute(mstrHTMLAttributes.ATTR_NOZEROSTR,nonzero);}if(hasAddr!=null){addrSection.setAttribute("hasAddr",hasAddr);}}}function togglePrintRange(bDisabled,rangeStartId,rangeEndId){var rangeStart=document.getElementById(rangeStartId);var rangeEnd=document.getElementById(rangeEndId);if(rangeStart){rangeStart.disabled=bDisabled;}if(rangeEnd){rangeEnd.disabled=bDisabled;}}function validateInputs(obj){var address=document.getElementById("DIV_Address");if(address&&address.getAttribute("hasAddr")=="0"&&address.getAttribute("ignoreAddr")!="true"){showMessage({contents:microstrategy.descriptors.getDescriptor(6036),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}var oForm=microstrategy.findAncestorWithTag(obj,"FORM");if(oForm&&mstrEditorImpl){return mstrEditorImpl.validateInputs(oForm,true);}else{return true;}}function checkForFlash(obj,beanPath,form){var fStateSelect=microstrategy.findChildWithAtt(form,"select","id","fstate");var vb=microstrategy.getViewerBone();var hasUC=vb&&vb.hasUCSelectors;if(hasUC&&fStateSelect&&fStateSelect.value&&fStateSelect.value.toLowerCase().indexOf("flash")>-1){showMessage({contents:microstrategy.descriptors.getDescriptor("7482"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"submitSubsForm(document.getElementById('"+obj.id+"'),'"+beanPath+"',true);",type:mstrMsgBoxImpl.MSG_WARNING});return true;}return false;}function updatePushNotifyField(){var isPushNotifyChk=document.getElementById("isPushNotify");var disabledValue=!isPushNotifyChk.checked;var msgTitleField=document.getElementById("msgTitle");var msgField=document.getElementById("cmsg");var sendDataRadio=new Array(2);sendDataRadio[0]=document.getElementsByName("alertSendDiffContent")[0];sendDataRadio[1]=document.getElementsByName("alertSendDiffContent")[1];if(msgTitleField){msgTitleField.disabled=disabledValue;}if(msgField){msgField.disabled=disabledValue;}if(sendDataRadio&&sendDataRadio[0]&&sendDataRadio[1]){sendDataRadio[0].disabled=sendDataRadio[1].disabled=disabledValue;if(sendDataRadio[1].checked){updateAlertObjSelector(null,!disabledValue);}}}function updateBadgeField(){var isUpdateBadgeChk=document.getElementById("isUpdateBadge");var disabledValue=!isUpdateBadgeChk.checked;var differentMetricList=document.getElementById("badgeMetricId");if(differentMetricList){differentMetricList.disabled=disabledValue;}}function submitSubsForm(obj,beanPath,flashChecked){var form=microstrategy.findAncestorWithTag(obj,"FORM");if(!flashChecked){if(checkForFlash(obj,beanPath,form)){return false;}}if(validateInputs(form)){var OK_EVENT_ID="17004";createHiddenInput(form,OK_EVENT_ID,OK_EVENT_ID);createHiddenInput(form,"defaultevtlist",OK_EVENT_ID);createHiddenInput(form,"evt",OK_EVENT_ID);createHiddenInput(form,"src",beanPath+"."+OK_EVENT_ID);return UpdateHelper.submitFormThroughXHR(obj);}else{return false;}}
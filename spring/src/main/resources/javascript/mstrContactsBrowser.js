mstrContactsBrowserImplScript=true;mstrContactsBrowserImpl.prototype=new mstrDialogImpl();mstrContactsBrowserImpl.prototype.initializing=false;mstrContactsBrowserImpl.prototype.available=null;mstrContactsBrowserImpl.prototype.selected=null;mstrContactsBrowserImpl.prototype.onload=function(){try{this.initializing=true;this.initDialog();this.initSettings();this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrContactsBrowserImpl.prototype.initSettings=function(){try{var cartBone=this.getCartBone();if(cartBone){if(this.getSelected()){this.getSelected().ondoubleclick=new Function("e","return microstrategy.bone('"+cartBone.id+"').remove('"+this.getSelected().id+"');");if(this.getAvailable()){this.getAvailable().ondoubleclick=new Function("e","return microstrategy.bone('"+cartBone.id+"').add('"+this.getSelected().id+"');");}}}this.searchBox=microstrategy.findChildWithAtt(this.elem,"input","id","searchString");var oInput=microstrategy.findChildWithAtt(this.elem,"input","name",new String(mstrUpdateManager.SEARCH_CONTACTS));if(oInput){oInput.onclick=new Function("e","return microstrategy.bone('"+this.id+"').submitSearch(e);");}this.clearDiv=microstrategy.findChildWithAtt(this.elem,"div","id","clearSearch");if(this.clearDiv){this.clearDiv.onclick=new Function("","return microstrategy.bone('"+this.id+"').clearSearch();");if(this.searchBox&&this.searchBox.value!=""){this.clearDiv.style.display="inline";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrContactsBrowserImpl.prototype.getCartBone=function(){try{return microstrategy.bone(this.id+"_cart");}catch(err){microstrategy.errors.log(err);return null;}};mstrContactsBrowserImpl.prototype.getAvailable=function(){try{return microstrategy.findChildWithAtt(this.elem,"div","id","available");}catch(err){microstrategy.errors.log(err);return null;}};mstrContactsBrowserImpl.prototype.getSelected=function(){try{return microstrategy.findChildWithAtt(this.elem,"div","id","selected");}catch(err){microstrategy.errors.log(err);return null;}};mstrContactsBrowserImpl.prototype.onIncrementalFetch=function(eventID){try{var cmdVal=this.getSelectedContacts();var action=microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.UPDATE_CONTACT_SELECTIONS,this.beanPath,["107001"],[cmdVal]);microstrategy.updateManager.add([action]);}catch(err){microstrategy.errors.log(err);return false;}};mstrContactsBrowserImpl.prototype.submitSearch=function(){try{var oInput=microstrategy.findChildWithAtt(this.elem,"input","name","searchString");var cmdVal=(oInput)?oInput.value:"";var action=microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.SEARCH_CONTACTS,this.beanPath,["100001"],[cmdVal]);microstrategy.updateManager.add([action]);cmdVal=this.getSelectedContacts();action=microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.UPDATE_CONTACT_SELECTIONS,this.beanPath,["107001"],[cmdVal]);microstrategy.updateManager.add([action]);microstrategy.updateManager.addURL("isSearchRequest=true");microstrategy.updateManager.flushAndSubmitChanges();}catch(err){microstrategy.errors.log(err);return false;}};mstrContactsBrowserImpl.prototype.clearSearch=function(){try{this.clearDiv.style.display="none";if(this.searchBox){this.searchBox.value="";}this.submitSearch();}catch(err){microstrategy.errors.log(err);return false;}};mstrContactsBrowserImpl.prototype.getSelectedContacts=function(){try{var contacts="";var oSelected=this.getSelected();if(oSelected!=null){contacts=this.getCartBone().getElementsFromList(oSelected);}}catch(err){microstrategy.errors.log(err);return"";}return contacts;};mstrContactsBrowserImpl.prototype.applyChanges=function(){try{var action=null;var cmdVal=this.getSelectedContacts();action=microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.UPDATE_CONTACT_SELECTIONS,this.beanPath,["107001"],[cmdVal]);microstrategy.updateManager.add([action]);action=microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.SAVE_CONTACT_SELECTIONS,this.beanPath,[],[]);microstrategy.updateManager.add([action]);}catch(err){microstrategy.errors.log(err);return false;}};function mstrContactsBrowserImpl(id){this.inherits=mstrDialogImpl;this.inherits(id);delete this.inherits;return this;}
mstrFixedPanel.prototype=new mstrSubSection();mstrFixedPanel.prototype.ruler=null;mstrFixedPanel.prototype.handle=null;mstrFixedPanel.prototype.rulerShade=null;mstrFixedPanel.prototype.nextSibling="";mstrFixedPanel.prototype.isCanGrowCanShrink=true;mstrFixedPanel.prototype.oldHeight=null;mstrFixedPanel.prototype.subsectionType=mstrSubSection.TYPE_FIXED;mstrFixedPanel.prototype.isHorizontal=false;mstrFixedPanel.prototype.isBeginHorizontal=false;mstrFixedPanel.prototype.isEndHorizontal=false;mstrFixedPanel.prototype.horizontalContainerBone=null;mstrFixedPanel.prototype.isCanGrowCanShrinkHorizontal=true;mstrFixedPanel.prototype.oldWidth=null;mstrFixedPanel.prototype.forceGrowOnResize=false;mstrFixedPanel.prototype.hasConditionalFormatting=false;mstrFixedPanel.prototype.onload=function(){try{mstrSubSection.prototype.onload.call(this);var so=microstrategy.styleObj;this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.isDetails=(this.elem.getAttribute(microstrategy.HTMLATTR_DETAILS_SECTION)==-1);this.isHorizontal=(so.getAttValue(this.elem,microstrategy.HTMLATTR_IS_HORIZONTAL)=="-1");if(this.isHorizontal){this.isBeginHorizontal=(so.getAttValue(this.elem,microstrategy.HTMLATTR_IS_BEGIN_HORIZONTAL)=="-1");this.isEndHorizontal=(so.getAttValue(this.elem,microstrategy.HTMLATTR_IS_END_HORIZONTAL)=="-1");}this.container=this.elem.parentNode;this.hasConditionalFormatting=(so.getAttValue(this.elem,microstrategy.HTMLATTR_HAS_CONDITIONAL_FORMATTING)=="-1");var cg=so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW);var cs=so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK);if(((cg==microstrategy.FALSE&&cs==microstrategy.FALSE)||microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE)){this.isCanGrowCanShrink=false;}var cgh=so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);var csh=so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);if(((cgh==microstrategy.FALSE&&csh==microstrategy.FALSE)||microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE)){this.isCanGrowCanShrinkHorizontal=false;}this.calcHasObjects();var viewerBone=this.doc.parentBone;if(viewerBone.isEditableViewModeEplus()){var vRulerObj=microstrategy.objectFind(this.container,["DIV"],microstrategy.OBJTYPE_RULER);if(vRulerObj&&vRulerObj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_VRULER){this.ruler=vRulerObj;this.rulerShade=microstrategy.subObjectFind(this.ruler,["DIV"],microstrategy.SUBOBJTYPE_VRULER_SHADE);}}if(viewerBone.layoutHeightMode!=1){this.adjustSubsectionHeight(false);}if(this.isHorizontal==false&&viewerBone.isEditableViewModeEplus()){for(var i=0;i<this.sibs.length;i++){viewerBone.totalHeight+=parseInt(so.getValue(this.sibs[i],"height"));}}if(this.isHorizontal){this.adjustSubsectionWidth(false);}this.applyGradient();}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.getOldHeight=function(){try{if(this.oldHeight==null){this.oldHeight=getObjHeight(this.elem);}return this.oldHeight;}catch(err){microstrategy.errors.log(err);return -1;}};mstrFixedPanel.prototype.getOldWidth=function(){try{if(this.oldWidth==null){this.oldWidth=getObjWidth(this.elem);}return this.oldWidth;}catch(err){microstrategy.errors.log(err);return -1;}};mstrFixedPanel.prototype.calcMaxContentHeight=function(){try{this.maxContentHeight=-1;this.maxContentWidth=-1;microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE){return ;}if(this.isHorizontal){if(!this.isCanGrowCanShrink&&!this.isCanGrowCanShrinkHorizontal){return ;}}else{if(!this.isCanGrowCanShrink){return ;}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){if(this.isCanGrowCanShrink){this.sibsHeight=new Array();}if(this.isCanGrowCanShrinkHorizontal&&this.isHorizontal){this.sibsWidth=new Array();}}var contentHeight=-1;var contentWidth=-1;var so=microstrategy.styleObj;var subsection=null;for(var i=0;i<this.sibs.length;i++){subsection=this.sibs[i];if(subsection!=null){var currentMaxContentHeight=-1;var currentMaxContentWidth=-1;if(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.RESIZE_EACH_SUBSECTION&&!this.containsDocObject(subsection)){continue;}for(var j=0;j<subsection.childNodes.length;j++){var child=subsection.childNodes[j];if(child.nodeType==1){if(this.isCanGrowCanShrinkHorizontal&&this.isHorizontal){contentWidth=getObjWidth(child);if(microstrategy.subObjectType(child)==microstrategy.SUBOBJTYPE_DOC_TEMPLATE){contentWidth=Math.max((child.scrollWidth?child.scrollWidth:0),contentWidth);}contentWidth+=parseInt(so.getValue(child,"left"));if(contentWidth>currentMaxContentWidth){currentMaxContentWidth=contentWidth;}}if(this.isCanGrowCanShrink){if(child.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT&&child.style.display!="none"){if(so.getAttValue(child,microstrategy.HTMLATTR_HEIGHT_MODE)){if(so.getAttValue(child,microstrategy.HTMLATTR_HEIGHT_MODE)!=microstrategy.HUNDRED_PERCENT_MODE){var h=getObjHeight(child);var ct=parseInt(so.getValue(child,"top"));contentHeight=(isNaN(ct)?0:ct)+h;}}else{contentHeight=parseInt(so.getValue(child,"top"))+getObjHeight(child);}if(contentHeight>currentMaxContentHeight){currentMaxContentHeight=contentHeight;}}}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){this.maxContentHeight=currentMaxContentHeight;this.maxContentWidth=currentMaxContentWidth;break;}else{if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){if(this.isCanGrowCanShrink){this.sibsHeight.push(currentMaxContentHeight);}if(this.isCanGrowCanShrinkHorizontal&&this.isHorizontal){this.sibsWidth.push(currentMaxContentWidth);}}}}window.setTimeout(this.path+".getOldHeight()",0);}catch(err){microstrategy.errors.log(err);return false;}};mstrFixedPanel.prototype.calcHasObjects=function(){try{for(var i=0;i<this.sibs.length;i++){if(this.containsDocObject(this.sibs[i])){return true;}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrFixedPanel.prototype.toggleSelected=function(){try{for(var i=0;i<this.sibs.length;i++){if(this.isHorizontal){var titleBar=this.sibs[i].parentNode.parentNode.previousSibling.firstChild;}else{var titleBar=this.sibs[i].parentNode.previousSibling;}if(titleBar){var oldClass=titleBar.className;var endIndex=oldClass.indexOf("selected");if(endIndex>-1){titleBar.className=oldClass.substring(0,endIndex);}else{titleBar.className+="selected";if(bIsFirefox){getObj("rwb_viewer").focus();}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrFixedPanel.prototype.isEndHorizontalSib=function(sibIndex){try{if(this.isDetails&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){return this.isEndHorizontal&&this.sibs.length-1==sibIndex;}else{return this.isEndHorizontal;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFixedPanel.prototype.isBeginHorizontalSib=function(sibIndex){try{if(this.isDetails&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE){return this.isBeginHorizontal&&sibIndex==0;}else{return this.isBeginHorizontal;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFixedPanel.prototype.toggleGrid=function(hide){try{for(var i=0;i<this.sibs.length;i++){this.sibs[i].style.backgroundImage=(hide)?"url(none)":"url("+microstrategy.FOLDER_IMAGES+microstrategy.GRID_IMAGE+")";}}catch(err){microstrategy.errors.log(err);return false;}};mstrFixedPanel.prototype.ondragstart=function(e){try{var so=microstrategy.styleObj;if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);if(this.isHorizontal){this.startX=lMouseX;this.oldWidth=getObjWidth(this.prevElem);this.oldCanGrowHorizontal=so.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);this.oldCanShrinkHorizontal=so.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);}else{this.startY=lMouseY;this.oldHeight=getObjHeight(this.prevElem);this.oldCanGrow=so.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_GROW);this.oldCanShrink=so.getAttValue(this.prevElem,microstrategy.HTMLATTR_CAN_SHRINK);}this.oldHideIfEmpty=so.getAttValue(this.prevElem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondrag");this.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".ondragend(e); }");}this.ondrag(e);}catch(err){microstrategy.errors.log(err);}return false;};mstrFixedPanel.prototype.ondrag=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);if(this.isHorizontal){var deltaX=lMouseX-this.startX;var newWidth=this.getOldWidth()+deltaX;if(newWidth>=0){if(this.ruler!=null){this.ruler.style.width=newWidth+"px";}this.prevElem.style.width=newWidth+"px";this.oldWidth=newWidth;this.startX=lMouseX;}}else{var deltaY=lMouseY-this.startY;var newHeight=this.getOldHeight()+deltaY;if(newHeight>=0){if(this.ruler!=null){this.ruler.style.height=newHeight+"px";}this.prevElem.style.height=newHeight+"px";this.oldHeight=newHeight;this.startY=lMouseY;}}}catch(err){microstrategy.errors.log(err);}return false;};mstrFixedPanel.prototype.ondragend=function(e){try{if(!e){e=window.event;}if(e.e){e=e.e;}getMouse(e);var fa=microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.parentBone.parentBone.parentBone.formattingAttributes;var id=this.id;if(this.isHorizontal){this.resizeWidth(parseInt(microstrategy.styleObj.getValue(this.prevElem,"width")),true,null);if(fa&&id){fa[id][microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL]=microstrategy.FALSE;fa[id][microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL]=microstrategy.FALSE;}}else{this.resize(parseInt(microstrategy.styleObj.getValue(this.prevElem,"height")),true,null);if(fa&&id){fa[id][microstrategy.HTMLATTR_CAN_SHRINK]=microstrategy.FALSE;fa[id][microstrategy.HTMLATTR_CAN_GROW]=microstrategy.FALSE;fa[id][microstrategy.HTMLATTR_HIDE_IF_EMPTY]=microstrategy.FALSE;}}this.onmouseup(e);if(this.isHorizontal){this.oldWidth=getObjWidth(this.elem);}else{this.oldHeight=getObjHeight(this.elem);}}catch(err){microstrategy.errors.log(err);}return false;};mstrFixedPanel.prototype.onmouseup=function(e){try{if(typeof (mstr)!="undefined"){this.detachWinListener(this,"mousemove");this.detachWinListener(this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(err){microstrategy.errors.log(err);}return false;};mstrFixedPanel.prototype.resizeEverySubSection=function(newHeight,subSection,lastSib,sibIndex,fromEditor){try{var newHeightValue=mstrFormatObject.encodeValue("height",newHeight);if(this.isHorizontal){this.updateHorizontalContainerHeight(subSection,newHeight);}else{subSection.style.height=newHeight+"px";this.parentBone.parentBone.resizeSubMaskForSib(this.parentBone.id,this.id,newHeight,sibIndex,"height");if(newHeight>0){this.parentBone.parentBone.hideSubMaskForSib(this.parentBone.id,this.id,false,sibIndex);}if(lastSib){if(fromEditor){microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT,newHeightValue);}this.oldHeight=getObjHeight(this.elem);if(this.resizeTimer){window.clearTimeout(this.resizeTimer);}this.resizeTimer=window.setTimeout(function(){microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");},0);}}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.resizeEverySubSectionWidth=function(newWidth,subSection,lastSib,sibIndex){try{var newWidthValue=mstrFormatObject.encodeValue("width",newWidth);subSection.style.width=newWidth+"px";if(microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){}this.parentBone.parentBone.resizeSubMaskForSib(this.parentBone.id,this.id,newWidth,sibIndex,"width");if(newWidth>0){this.parentBone.parentBone.hideSubMaskForSib(this.parentBone.id,this.id,false,sibIndex);}if(lastSib){microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_WIDTH,newWidthValue);this.oldwidth=getObjWidth(this.elem);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.simpleWidthResize=function(newWidth){try{var newWidthValue=mstrFormatObject.encodeValue("width",newWidth);for(var i=0;i<this.sibs.length;i++){this.sibs[i].style.width=newWidth+"px";}this.parentBone.parentBone.resizeSubMask(this.parentBone.id,this.id,newWidth-this.getOldWidth(),"width");if(newWidth>0){this.parentBone.parentBone.hideSubMask(this.parentBone.id,this.id,false);}microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_WIDTH,newWidthValue);this.oldWidth=getObjWidth(this.elem);this.parentBone.parentBone.parentBone.resize100WMObjects(this.id);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.updateHorizontalContainerHeight=function(subSection,newHeight){try{var horizontalContainerBone=null;var hcDiv=microstrategy.findAncestorWithAtt(subSection,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(hcDiv){hcDiv.style.height=newHeight+"px";horizontalContainerBone=microstrategy.findBone(hcDiv);}if(horizontalContainerBone){var h=Math.max(horizontalContainerBone.height,newHeight);horizontalContainerBone.height=h;hcTitle=microstrategy.findChildrenWithAtt(hcDiv,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_TITLEBAR);if(hcTitle){for(var i=0,cnt=hcTitle.length;i<cnt;i++){hcTitle[i].style.height=h+"px";if(mstr.utils.ISFF3_5){var span=hcTitle[i].firstChild;span.style.display="block";span.style.MozTransform="rotate(-90deg)";span.style.height=h+"px";span.style.width=h+"px";var fc=span.firstChild;if(fc&&fc.tagName&&fc.tagName.toLowerCase()=="img"){fc.setAttribute("style","float: right");fc.style.MozTransform="rotate(90deg)";}}}}if(mstr.utils.ISIE8){var ssh=microstrategy.findChildrenWithAtt(hcDiv,"div",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE);if(ssh){for(var i=0,cnt=ssh.length;i<cnt;i++){ssh[i].style.height=h+"px";}}}}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.simpleResize=function(newHeight){try{var newHeightValue=mstrFormatObject.encodeValue("height",newHeight);for(var i=0;i<this.sibs.length;i++){if(this.isHorizontal){this.updateHorizontalContainerHeight(this.sibs[i],newHeight);}else{this.sibs[i].style.height=newHeight+"px";this.sibs[i].parentNode.firstChild.style.height=newHeight+"px";}}if(!this.isHorizontal){this.doc.resizeSubMask(this.parentBone.id,this.id,newHeight-this.getOldHeight(),"height");if(newHeight>0){this.doc.hideSubMask(this.parentBone.id,this.id,false);}microstrategy.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT,newHeightValue);this.oldHeight=getObjHeight(this.elem);this.doc.parentBone.resize100HMObjects(this.id);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.resize=function(newHeight,update,ac){try{var f=mstrFormatObject;var so=microstrategy.styleObj;var newHeightValue=f.encodeValue("height",newHeight);var oldHeightValue=f.encodeValue("height",this.getOldHeight());if(this.isHorizontal){var hcDiv=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(hcDiv){var horizontalContainer=microstrategy.findBone(hcDiv);horizontalContainer.oldHeight=oldHeightValue;}}var cachedOldValue=[so.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT),so.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),so.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];this.simpleResize(newHeight);var passOut=(ac!=null);if(update||passOut){var updateManager=microstrategy.bones.rwb_viewer.updateManager;if(!passOut){var ac=new Array();}}if(ac){var cachedArray=new Object();cachedArray.subsectionHeight=true;var data=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+newHeightValue;var oldData=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+oldHeightValue;cachedArray.origValue=[so.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT),so.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),so.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];cachedArray.cachedOldValue=cachedOldValue;ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data],[mstrUpdateManager.UPDATE_LATER,oldData],cachedArray));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){data=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrow"+mstrUpdateManager.UNIT_SEPARATOR+"0";oldData=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrow"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanGrow;ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data],[mstrUpdateManager.UPDATE_LATER,oldData],cachedArray));data=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrink"+mstrUpdateManager.UNIT_SEPARATOR+"0";oldData=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrink"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanShrink;ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data],[mstrUpdateManager.UPDATE_LATER,oldData],cachedArray));data=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+"0";oldData=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+this.oldHideIfEmpty;ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data],[mstrUpdateManager.UPDATE_LATER,oldData],cachedArray));}if(!passOut&&update&&ac.length>0){updateManager.add(ac);}}this.applyGradient();return(passOut)?ac:null;}catch(err){microstrategy.errors.log(err);return ac;}};mstrFixedPanel.prototype.resizeWidth=function(newWidth,update,ac){try{var f=mstrFormatObject;var so=microstrategy.styleObj;var newWidthValue=f.encodeValue("width",newWidth);var oldWidthValue=f.encodeValue("width",this.getOldWidth());var cachedOldValue=[so.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH),so.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL),so.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];this.simpleWidthResize(newWidth);var passOut=(ac!=null);if(update||passOut){var updateManager=this.parentBone.parentBone.parentBone.updateManager;if(!passOut){var ac=new Array();}}this.parentBone.parentBone.updateLayoutWidth(ac,false);if(ac){var cachedArray=new Object();cachedArray.subsectionWidth=true;var data=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+newWidthValue;var oldData=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+oldWidthValue;cachedArray.origValue=[so.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH),so.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL),so.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];cachedArray.cachedOldValue=cachedOldValue;ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data],[mstrUpdateManager.UPDATE_LATER,oldData],cachedArray));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){data=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrowHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+"0";oldData=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanGrowHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanGrow;ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data],[mstrUpdateManager.UPDATE_LATER,oldData],cachedArray));data=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrinkHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+"0";oldData=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"CanShrinkHorizontal"+mstrUpdateManager.UNIT_SEPARATOR+this.oldCanShrink;ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data],[mstrUpdateManager.UPDATE_LATER,oldData],cachedArray));data=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+"0";oldData=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSection"+mstrUpdateManager.UNIT_SEPARATOR+"HideIfEmpty"+mstrUpdateManager.UNIT_SEPARATOR+this.oldHideIfEmpty;ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data],[mstrUpdateManager.UPDATE_LATER,oldData],cachedArray));}if(!passOut&&update&&ac.length>0){updateManager.add(ac);}}return(passOut)?ac:null;}catch(err){microstrategy.errors.log(err);return ac;}};mstrFixedPanel.prototype.changeSubHeight=function(newHeight,update,ac){try{var f=microstrategy.getFormatObject();var so=microstrategy.styleObj;var newHeightValue=f.encodeValue("height",newHeight);var oldHeightValue=f.encodeValue("height",this.getOldHeight());var cachedOldValue=[so.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT),so.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),so.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];if(this.isHorizontal){var hcDiv=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);if(hcDiv){var horizontalContainer=microstrategy.findBone(hcDiv);horizontalContainer.oldHeight=oldHeightValue;}}this.simpleResize(newHeight);var passOut=(ac!=null);if(update||passOut){var updateManager=this.parentBone.parentBone.parentBone.updateManager;if(!passOut){var ac=new Array();}}if(ac){var cachedArray=new Object();cachedArray.subsectionHeight=true;var data=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+newHeightValue;var oldData=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Height"+mstrUpdateManager.UNIT_SEPARATOR+oldHeightValue;var origValue=[newHeightValue,so.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK),so.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];cachedArray.origValue=origValue;cachedArray.cachedOldValue=cachedOldValue;ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data],[mstrUpdateManager.UPDATE_LATER,oldData],cachedArray));if(!passOut&&update&&ac.length>0){updateManager.add(ac);}}return(passOut)?ac:null;}catch(err){microstrategy.errors.log(err);return ac;}};mstrFixedPanel.prototype.changeSubWidth=function(newWidth,update,ac){try{var f=mstrFormatObject;var so=microstrategy.styleObj;var newWidthValue=f.encodeValue("width",newWidth);var oldWidthValue=f.encodeValue("width",this.getOldWidth());var cachedOldValue=[so.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH),so.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL),so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL),so.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY)];this.simpleWidthResize(newWidth);var passOut=(ac!=null);if(update||passOut){var updateManager=this.parentBone.parentBone.parentBone.updateManager;if(!passOut){var ac=new Array();}}this.parentBone.parentBone.updateLayoutWidth(ac);if(ac){var cachedArray=new Object();cachedArray.subsectionWidth=true;var data=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+newWidthValue;var oldData=this.id+mstrUpdateManager.UNIT_SEPARATOR+"FormattingSize"+mstrUpdateManager.UNIT_SEPARATOR+"Width"+mstrUpdateManager.UNIT_SEPARATOR+oldWidthValue;cachedArray.origValue=cachedOldValue;cachedArray.cachedOldValue=cachedOldValue;ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data],[mstrUpdateManager.UPDATE_LATER,oldData],cachedArray));if(!passOut&&update&&ac.length>0){updateManager.add(ac);}}this.applyGradient();return(passOut)?ac:null;}catch(err){microstrategy.errors.log(err);return ac;}};mstrFixedPanel.prototype.hide=function(){try{this.elem.style.display="none";this.container.style.display="none";if(this.parentBone.parentBone.parentBone.rulerOn&&this.ruler){this.ruler.style.display="none";}this.parentBone.parentBone.hideSubMask(this.parentBone.id,this.id,true);microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");}catch(err){microstrategy.errors.log(err);return false;}};mstrFixedPanel.prototype.show=function(){try{this.elem.style.display="block";this.container.style.display="block";if(this.parentBone.parentBone.parentBone.rulerOn){if(this.ruler){this.ruler.style.display="block";}}this.parentBone.parentBone.hideSubMask(this.parentBone.id,this.id,false);var panelStacks=microstrategy.findChildrenWithAtt(this.elem,"SPAN","sty",8);for(var i=0;i<panelStacks.length;i++){var panelStackBone=microstrategy.findBone(panelStacks[i]);if(panelStackBone&&panelStackBone.onSubSectionShow){panelStackBone.onSubSectionShow();}}microstrategy.eventManager.notifyOrphanBones("onSubSectionResize");this.applyGradient();}catch(err){microstrategy.errors.log(err);return false;}};mstrFixedPanel.prototype.turnOffRulerShade=function(){try{if(this.rulerShade){this.rulerShade.style.height="0px";this.rulerShade.style.left="0px";this.rulerShade.style.top="0px";}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.turnOnRulerShade=function(range){try{if(this.rulerShade){this.rulerShade.style.height=(range.bottom-range.top+3)+"px";this.rulerShade.style.left="0px";}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.dragRulerShade=function(y){try{if(this.rulerShade){this.rulerShade.style.top=y+"px";}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.insertSubSectionAbove=function(){try{var um=this.parentBone.parentBone.parentBone.updateManager;um.add([um.createActionObject(this.elem,mstrUpdateManager.ADD_SUBSECTION,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048007","2048101","2048102"],[mstrUpdateManager.UPDATE_LATER,this.parentBone.id,this.id,"before"],[])]);um.flushAndSubmitChanges();}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.resizeRuler=function(newHeight){try{if(this.ruler){this.ruler.style.height=newHeight+"px";}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.insertSubSectionBelow=function(){try{var um=this.parentBone.parentBone.parentBone.updateManager;um.add([um.createActionObject(this.elem,mstrUpdateManager.ADD_SUBSECTION,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048007","2048101","2048102"],[mstrUpdateManager.UPDATE_LATER,this.parentBone.id,this.id,"after"],[])]);um.flushAndSubmitChanges();}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.deleteSubSection=function(){try{var um=this.parentBone.parentBone.parentBone.updateManager;if(this.parentBone.getSubsectionCount()>1){um.add([um.createActionObject(this.elem,mstrUpdateManager.REMOVE_SUBSECTION,this.parentBone.parentBone.parentBone.beanPath,["2048018","2048041"],[mstrUpdateManager.UPDATE_LATER,this.id],[])]);um.flushAndSubmitChanges();}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.adjustSubsectionWidth=function(fromEditor){try{var f=mstrFormatObject;var so=microstrategy.styleObj;var width=parseFloat(f.decodeValue("width",so.getAttValue(this.elem,microstrategy.HTMLATTR_WIDTH)));var newWidth=width;if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){var he=so.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);if(microstrategy.RESIZE_SUBSECTIONS!=microstrategy.IGNORE_RESIZE){var csh=so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK_HORIZONTAL);var cgh=so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW_HORIZONTAL);var mw=parseInt(f.decodeValue("width",so.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_WIDTH)));this.isCanGrowCanShrinkHorizontal=true;if((cgh==microstrategy.FALSE&&csh==microstrategy.FALSE)||microstrategy.RESIZE_SUBSECTIONS==microstrategy.IGNORE_RESIZE){this.isCanGrowCanShrinkHorizontal=false;}if(this.needToUpdateMaxContentHeight){this.calcMaxContentHeight();this.setNeedToUpdateMaxContentHeight(false);}if(!this.isCanGrowCanShrinkHorizontal){if(fromEditor&&newWidth>=0){this.simpleWidthResize(newWidth);}return true;}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&he!=microstrategy.FALSE&&!this.calcHasObjects()){newWidth=0.001;this.simpleWidthResize(newWidth);return true;}var hasResizedEverySubSec=false;for(var i=0;i<this.sibs.length;i++){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION&&he!="0"&&!this.containsDocObject(this.sibs[i])){newWidth=0.001;this.resizeEverySubSectionWidth(newWidth,this.sibs[i],(i==this.sibs.length),i);hasResizedEverySubSec=true;continue;}var currentMaxWidth=(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION)?this.sibsWidth[i]:this.maxContentWidth;if(mw<width&&mw!="0"){mw=width;}if(currentMaxWidth==width){if(!fromEditor){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){return true;}else{continue;}}}else{if(cgh=="-1"&&currentMaxWidth>width){if(mw=="0"){newWidth=currentMaxWidth;}else{if(mw>currentMaxWidth){newWidth=currentMaxWidth;}else{newWidth=mw;}}}else{if(csh=="-1"){if((microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION&&!this.containsDocObject(this.sibs[i]))||(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&!this.calcHasObjects())){newWidth=0.001;}else{if(currentMaxWidth<width){newWidth=(currentMaxWidth==-1)?0.001:currentMaxWidth;}}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){break;}if(newWidth>=0&&microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_EACH_SUBSECTION){this.resizeEverySubSectionWidth(newWidth,this.sibs[i],i==this.sibs.length-1,i);hasResizedEverySubSec=true;}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){if(newWidth>=0){this.simpleWidthResize(newWidth);}}else{if(hasResizedEverySubSec){this.parentBone.parentBone.parentBone.resize100WMObjects(this.id);}}}else{if(newWidth>=0){this.simpleWidthResize(newWidth);}}}else{if(newWidth>=0){this.simpleWidthResize(newWidth);}}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.resizeSubsection=function(fromEditor){try{microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;this.setNeedToUpdateMaxContentHeight(true);this.adjustSubsectionHeight(false);if(this.isHorizontal){this.adjustSubsectionWidth(false);}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.adjustSubsectionHeight=function(fromEditor){try{var f=microstrategy.getFormatObject();var so=microstrategy.styleObj;var height=Math.round(parseFloat(f.decodeValue("height",so.getAttValue(this.elem,microstrategy.HTMLATTR_HEIGHT))));var newHeight=height;var currentHeight=parseInt(so.getValue(this.elem,"height"));if(microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE){var he=so.getAttValue(this.elem,microstrategy.HTMLATTR_HIDE_IF_EMPTY);if(microstrategy.bones.rwb_viewer.layoutHeightMode==0){var cs,cg;if(this.isHorizontal){var container=microstrategy.findAncestorWithAtt(this.elem,microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_HORIZONTAL_CONTAINER);cs=so.getAttValue(container,microstrategy.HTMLATTR_CAN_SHRINK);cg=so.getAttValue(container,microstrategy.HTMLATTR_CAN_GROW);}cs=cs!=undefined?cs:so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_SHRINK);cg=cg!=undefined?cg:so.getAttValue(this.elem,microstrategy.HTMLATTR_CAN_GROW);var mh=parseInt(f.decodeValue("height",microstrategy.styleObj.getAttValue(this.elem,microstrategy.HTMLATTR_MAX_HEIGHT)));this.isCanGrowCanShrink=true;if((cg==microstrategy.FALSE&&cs==microstrategy.FALSE&&he==microstrategy.FALSE)){this.isCanGrowCanShrink=false;}if(this.needToUpdateMaxContentHeight){this.calcMaxContentHeight();this.setNeedToUpdateMaxContentHeight(false);}if(!this.isCanGrowCanShrink||fromEditor){if((fromEditor&&newHeight>=0)||this.isHorizontal){this.simpleResize(newHeight);}return true;}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&he!=microstrategy.FALSE&&!this.calcHasObjects()){newHeight=0.001;this.simpleResize(newHeight);return true;}if(!this.isCanGrowCanShrink&&he==microstrategy.FALSE){if(fromEditor&&newHeight>=0&&newHeight!=currentHeight){this.simpleResize(newHeight);return true;}}var hasResizedEverySubSec=false;for(var i=0;i<this.sibs.length;i++){newHeight=height;if(microstrategy.bones.rwb_viewer.layoutHeightMode==0&&he!=microstrategy.FALSE&&!this.containsDocObject(this.sibs[i])){newHeight=0.001;this.resizeEverySubSection(newHeight,this.sibs[i],(i==this.sibs.length-1),i,fromEditor);hasResizedEverySubSec=true;continue;}var currentMaxHeight=(microstrategy.bones.rwb_viewer.layoutHeightMode==0&&this.sibsHeight)?this.sibsHeight[i]:this.maxContentHeight;if(mh<height&&mh!=microstrategy.FALSE){mh=height;}if(currentMaxHeight==height){if(!fromEditor){if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){return true;}else{if(this.isHorizontal&&i==this.sibs.length-1){this.simpleResize(newHeight);continue;}else{continue;}}}}else{if((cg==microstrategy.TRUE||(he==microstrategy.TRUE&&this.forceGrowOnResize))&&currentMaxHeight>height){if(mh==microstrategy.FALSE){newHeight=currentMaxHeight;}else{if(mh>currentMaxHeight){newHeight=currentMaxHeight;}else{newHeight=mh;}}}else{if(cs==microstrategy.TRUE){if((microstrategy.bones.rwb_viewer.layoutHeightMode==0&&!this.containsDocObject(this.sibs[i]))||(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION&&!this.calcHasObjects())){newHeight=0.001;}else{if(currentMaxHeight<height){newHeight=(currentMaxHeight==-1)?0.001:currentMaxHeight;}}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){break;}if(newHeight>=0&&microstrategy.bones.rwb_viewer.layoutHeightMode==0){if(newHeight!=height){this.resizeEverySubSection(newHeight,this.sibs[i],i==this.sibs.length-1,i,fromEditor);hasResizedEverySubSec=true;}else{if(this.isHorizontal){this.updateHorizontalContainerHeight(this.sibs[i],newHeight);}}}}if(microstrategy.RESIZE_SUBSECTIONS==microstrategy.RESIZE_TO_FIRST_SUBSECTION){if(newHeight>=0){this.simpleResize(newHeight);}}else{if(hasResizedEverySubSec){microstrategy.bones.rwb_viewer.resize100HMObjects(this.id);}}}else{if(newHeight>=0){this.simpleResize(newHeight);}}}else{if(newHeight>=0){this.simpleResize(newHeight);}}}catch(err){microstrategy.errors.log(err);}};mstrFixedPanel.prototype.getRightMostPos=function(){try{var rightX=0;var so=microstrategy.styleObj;if(this.elem&&this.elem.childNodes&&!this.isHorizontal){for(var i=0;i<this.elem.childNodes.length;i++){var child=this.elem.childNodes[i];if(child.nodeType==1){if(child.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_DOC_OBJECT){var mode=so.getAttValue(child,microstrategy.HTMLATTR_WIDTH_MODE);if(mode==microstrategy.FIX_MODE){var width=microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE?parseInt(so.getValue(child,"width",microstrategy.FORMAT_TYPE_MAIN)):child.scrollWidth;rightX=Math.max(parseInt(so.getValue(child,"left",microstrategy.FORMAT_TYPE_MAIN))+width,rightX);}else{if(mode==microstrategy.AUTO_MODE){var _display=child.style.display;child.style.display="block";rightX=Math.max(parseInt(so.getValue(child,"left",microstrategy.FORMAT_TYPE_MAIN))+child.scrollWidth,rightX);child.style.display=_display;}}}}}}return rightX;}catch(err){microstrategy.errors.log(err);return -1;}};mstrFixedPanel.prototype.checkForResize=function(src){try{var handle=microstrategy.findAncestorWithAtt(src,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_SUBSECTION_HANDLE);if(handle){var selectedSubSec=null;if(this.isHorizontal){this.prevElem=handle.parentNode.previousSibling.lastChild.lastChild;selectedSubSec=microstrategy.findChildWithAtt(handle.parentNode.nextSibling,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);}else{this.prevElem=handle.previousSibling.lastChild;selectedSubSec=microstrategy.findChildWithAtt(handle.nextSibling,"div",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_DOC_SUBSECTION);}if(typeof (mstr)!="undefined"){this.attachWinListener(this,"mousemove","ondragstart");this.attachWinListener(this,"mouseup","onmouseup");}else{document.onmousemove=new Function("e",this.verifiedPath+" { return "+this.path+".ondragstart(e); }");document.onmouseup=new Function("e",this.verifiedPath+" { return "+this.path+".onmouseup(e); }");}if(selectedSubSec){this.doc.selections.addSubSection(selectedSubSec);}}}catch(err){microstrategy.errors.log(err);return ac;}};function mstrFixedPanel(id){this.inherits=mstrSubSection;this.inherits(id);this.inherits=null;return this;}
promptFunctionsScript=true;var bDefault=new Array();var treeToList="";var treePos="";var promptJSAnswerName="";var promptJSListBoxName="";var promptJSDimensionName="";var promptJSMaxPin=-1;var sBeanPath="";var promptHeight="";var searchPrefix="";if(typeof (iframe)!="undefined"){iframe.isPromptedReport=true;}function gotoAnchor(sCurPin){var isNav,isIE;if((navigator!=null)&&(sCurPin>1)){if((navigator.appName!=null)&&(navigator.appVersion!=null)){isNav=(navigator.appName=="Netscape");isIE=(navigator.appName.indexOf("Internet Explorer")!=-1);if(isNav||(isIE&&parseInt(navigator.appVersion)>=4)){var promptAnchor=document.getElementById("CP"+sCurPin);if(promptAnchor){var promptsBody=document.getElementById("mstrPromptsBody");promptsBody.scrollTop=promptAnchor.offsetTop;window.scrollTo(0,promptsBody.parentNode.offsetTop+promptAnchor.offsetTop-promptsBody.scrollTop);}}}}}function checkAnchorsReady(sCurPin){var len=document.anchors.length;for(var i=0;i<len;i++){if(document.anchors.item(i).name==sCurPin){return true;}}return false;}function AddItemstoElementPickerTextBox(sFromList,sToTextBox){var oFromList=getObj(sFromList);var oToTextBox=getObj(sToTextBox);if(oToTextBox==null||oFromList==null){return ;}var lastSelection;var lLength=oFromList.options.length;if(!oFromList.multiple){oToTextBox.value=oFromList.options[oFromList.selectedIndex].value;lastSelection=oFromList.selectedIndex;oFromList.options[lastSelection].selected=false;}else{for(var i=0;i<lLength;i++){if((oFromList.options[i])&&(oFromList.options[i].selected==true)&&(oFromList.options[i].value!="-none-")){if(oToTextBox.value.length>0){oToTextBox.value+=";";}oToTextBox.value+=oFromList.options[i].value;oFromList.options[i].selected=false;lastSelection=i;}}}if(lastSelection!=lLength-1){oFromList.options[lastSelection+1].selected=true;}}function MoveItemsbyListObjectPrompt(sFromList,sToList,bRemoveFromItem,bAddToItem,bInsertBeforeCursor){try{var oForm=document.PromptForm;var i;var lLength;var bFlag=true;var oFromList=getObj(sFromList);var oToList=getObj(sToList);var lIndexSelected=-1;var lNumSelections=0;var oButtonBar=document.getElementById("mstrPromptsButtonBarBottom");var insertLocation=0;if(bRemoveFromItem==null){bRemoveFromItem=true;}if(bAddToItem==null){bAddToItem=true;}if(bInsertBeforeCursor==null){bInsertBeforeCursor=false;}oFromList.style.visibility="hidden";lLength=oFromList.options.length;insertLocation=oToList.options.length;if(bInsertBeforeCursor&&bAddToItem){for(i=0;i<insertLocation;i++){if(oToList.options[i].selected){insertLocation=i;break;}}}for(i=0;i<lLength;i++){if((oFromList.options[i])&&(oFromList.options[i].selected==true)&&(oFromList.options[i].value!="-none-")){var bAddItemToList=true;if(!bRemoveFromItem){if(isItemInList(oFromList.options[i],oToList)){bAddItemToList=false;}}if(bAddToItem&&bAddItemToList){var oOption=new Option(oFromList.options[i].text,oFromList.options[i].value,false,true);if((oToList.length==1)&&(oToList.options[0].value=="-none-")){oToList.options[0]=oOption;oToList.options[0].selected=false;}else{for(var j=oToList.length-1;j>=insertLocation;j--){var oOptionOld=new Option(oToList.options[j].text,oToList.options[j].value,false,false);oToList.options[j+1]=oOptionOld;}oToList.options[insertLocation]=oOption;oToList.options[insertLocation].selected=false;insertLocation=insertLocation+1;}}lIndexSelected=i;lNumSelections=lNumSelections+1;}}if(bRemoveFromItem){for(i=lLength-1;i>=0;i--){if(oFromList.options[i]&&(oFromList.options[i].selected==true)&&(oFromList.options[i].value!="-none-")){oFromList.options[i]=null;}}}if(oFromList.options.length==0){var oOption=new Option("--"+aDescriptor[18]+"--","-none-",false,false);oFromList.options[0]=oOption;oFromList.options[0].selected=false;}if(!bRemoveFromItem&&(oFromList.options.length>1)){if(lNumSelections>0){for(i=0;i<lIndexSelected;i++){oFromList.options[i].selected=false;}}if((lIndexSelected>=0)&&(oFromList.options[lIndexSelected+1]!=null)){oFromList.options[lIndexSelected].selected=false;oFromList.options[lIndexSelected+1].selected=true;}else{if(lIndexSelected==-1){oFromList.options[0].selected=true;}}}else{if((lIndexSelected>0)&&(oFromList.options.length>0)){if(lIndexSelected>=lNumSelections){if(oFromList.options.length>lIndexSelected-lNumSelections+1){oFromList.options[lIndexSelected-lNumSelections+1].selected=true;}else{oFromList.options[oFromList.options.length-1].selected=true;}}else{lNumSelections=lNumSelections-1;oFromList.options[lIndexSelected-lNumSelections].selected=true;}}else{oFromList.options[0].selected=true;}}if(oButtonBar){oButtonBar.style.visibility="hidden";oButtonBar.style.visibility="visible";}oFromList.style.visibility="visible";}catch(err){alert(err.value);}}function AddItemsbyListObjectForObjectPrompt(sFromList,sToList,bRemoveFromItem){var oForm=document.PromptForm;var i;var j;var lLength;var aSelArray=new Array();var lPosition;var lIndexSelected;var lNumSelections;var oFromList=getObj(sFromList);var oToList=getObj(sToList);if(bRemoveFromItem==null){bRemoveFromItem=true;}lNumSelections=0;lPosition=oToList.options.length;for(i=0;i<lPosition;i++){if(oToList.options[i].selected){lPosition=i;break;}}oFromList.style.visibility="hidden";lLength=oFromList.options.length;for(i=0;i<lLength;i++){if(oFromList.options[i].selected&&(oFromList.options[i].value!="-none-")){if(oToList.options.length==1){if(oToList.options[0].value=="-none-"){oToList.options[0]=null;if(lPosition>0){lPosition=lPosition-1;}}}var bAddItem=true;if(!bRemoveFromItem){if(isItemInList(oFromList.options[i],oToList)){bAddItem=false;}}if(bAddItem){for(j=oToList.length-1;j>=lPosition;j--){var oOption=new Option(oToList.options[j].text,oToList.options[j].value,false,false);oToList.options[j+1]=oOption;}var oOption=new Option(oFromList.options[i].text,oFromList.options[i].value,false,false);oToList.options[lPosition]=oOption;oToList.options[lPosition].selected=false;lPosition=lPosition+1;oOption=null;lIndexSelected=i;lNumSelections=lNumSelections+1;}}}if(bRemoveFromItem){for(i=lLength-1;i>=0;i--){if(oFromList.options[i].selected){oFromList.options[i].selected=false;aSelArray[aSelArray.length]=i;}}for(i=0;i<aSelArray.length;i++){oFromList.options[aSelArray[i]]=null;}}if(oFromList.options.length==0){var oOption=new Option("--"+aDescriptor[18]+"--","-none-",false,false);oFromList.options[oFromList.length]=oOption;oFromList.options[oFromList.length-1].selected=false;oOption=null;}if((lIndexSelected>0)&&(oFromList.options.length>0)){if(lIndexSelected>=lNumSelections){if(oFromList.options.length>lIndexSelected-lNumSelections+1){oFromList.options[lIndexSelected-lNumSelections+1].selected=true;}else{oFromList.options[oFromList.options.length-1].selected=true;}}else{lNumSelections=lNumSelections-1;oFromList.options[lIndexSelected-lNumSelections].selected=true;}}else{oFromList.options[0].selected=true;}oFromList.style.visibility="visible";}function isItemInList(option,oList){var bIsInList=false;for(j=oList.length-1;j>=0;j--){if(option.value==oList.options[j].value){bIsInList=true;break;}}return bIsInList;}function BuildUserSelections(){var i;var j;var lLength;var oOptions;var oListBox;var oAnswer;var oDimension;var oTree;var sAnswerName;var sListBoxName;var sDimensionName;var sTreeAuxName;for(i=0;i<promptJSMaxPin;i++){if(i>0){sAnswerName=promptJSAnswerName+"_"+parseInt(i);sListBoxName=promptJSListBoxName+"_"+parseInt(i);sDimensionName=promptJSDimensionName+"_"+parseInt(i);sOperatorName=promptJSFuncName+"_"+parseInt(i);sTreeAuxName=sTreeName+"_"+parseInt(i);}else{sAnswerName=promptJSAnswerName;sListBoxName=promptJSListBoxName;sDimensionName=promptJSDimensionName;sOperatorName=promptJSFuncName;sTreeAuxName=sTreeName;}if(sListBoxName!=null){oListBox=(document.getElementsByName(sListBoxName).length>0)?document.getElementsByName(sListBoxName)[0]:null;oAnswer=(document.getElementsByName(sAnswerName).length>0)?document.getElementsByName(sAnswerName)[0]:null;oDimension=(document.getElementsByName(sDimensionName).length>0)?document.getElementsByName(sDimensionName)[0]:null;oTree=(document.getElementsByName(sTreeAuxName).length>0)?document.getElementsByName(sTreeAuxName)[0]:null;if(oListBox!=null){oOptions=oListBox.options;lLength=oOptions.length;if(oAnswer!=null){oAnswer.value="";}if((oOptions[0].value!="-none-")&&(oOptions[0].value!="-default-")){for(j=0;j<lLength;j++){if(oOptions[j].value=="include"||oOptions[j].value=="exclude"){continue;}if(oDimension==null&&oTree==null){if(oAnswer.value!=""){oAnswer.value+=unescape(ANSWER_SEPARATOR);}oAnswer.value+=oOptions[j].value;}else{switch(CheckAttributeElementExpression(oOptions[j].value)){case 2:if(oAnswer.value.length>0){oAnswer.value+=unescape(ANSWER_SEPARATOR);}oAnswer.value+=oOptions[j].value;break;case 1:if(oAnswer.value.length>0){oAnswer.value+=unescape(ANSWER_SEPARATOR);}oAnswer.value+="22"+unescape(ITEM_SEPARATOR)+"1"+unescape(EXPRESSION_SEPARATOR)+oOptions[j].value+unescape(EXPRESSION_SEPARATOR);break;case 0:oAnswer.value+=oOptions[j].value+unescape(UNIT_SEPARATOR);}}}}}else{var oOperatorPullDown=getObj(sOperatorName);if(oOperatorPullDown){if(oOperatorPullDown.options){oOperatorPullDown.options[oOperatorPullDown.selectedIndex].value=AddOutputLevelToOperator(oOperatorPullDown.options[oOperatorPullDown.selectedIndex].value,i);}else{oOperatorPullDown.value=AddOutputLevelToOperator(oOperatorPullDown.value,i);}}var constantAnswer=checkConstantPromptAnswer(sAnswerName);if(constantAnswer.length>0){oAnswer.value=constantAnswer;}}}}return(true);}function checkConstantPromptAnswer(sAnswerName){var returnValue="";var oDateAnswer=getObj(sAnswerName+"_date");if(oDateAnswer!=null){returnValue=oDateAnswer.value;}var hourString="";var minString="";var secsString="";var timeSeparator=":";var oTimeHour=is24HourFormat()?getObj(sAnswerName+"_timeHour24"):getObj(sAnswerName+"_timeHour12");if(oTimeHour!=null){hourString=oTimeHour.value;}var oTimeMins=getObj(sAnswerName+"_timeMins");if(oTimeMins!=null){minString=oTimeMins.value;}var oTimeSecs=getObj(sAnswerName+"_timeSecs");if(oTimeSecs!=null){secsString=oTimeSecs.value;}var oTimeSeparator=getObj(sAnswerName+"_timeSep");if(oTimeSeparator!=null){timeSeparator=oTimeSeparator.value;}if(hourString.length>0){returnValue+=" "+hourString+timeSeparator+minString;}if(secsString.length>0){returnValue+=timeSeparator+secsString;}return returnValue;}function GetCurrentAttributeValue(oDropdownList){var value="";if(oDropdownList.options){var lLength=oDropdownList.options.length;for(var i=0;i<lLength;i++){if(oDropdownList.options[i].defaultSelected==true){value=oDropdownList.options[i].value;}}}else{value=oDropdownList.value;}return value;}function GetUnitType(sValue){var aUnit=sValue.split(ITEM_SEPARATOR);return(aUnit[1]);}function GetUnitName(sValue){var aUnit=sValue.split(ITEM_SEPARATOR);return(aUnit[2]);}function CheckAttributeExist(oToList,sCurrentAttributeValue){var lLength=oToList.options.length;for(var i=0;i<lLength;i++){if(isSameAttributeValue(oToList.options[i].value,sCurrentAttributeValue)){return(i+1);}}return(-1);}function CheckNextNonAttributeElement(oToList,currentPos){var lLength=oToList.options.length;for(var i=currentPos;i<lLength;i++){if(CheckAttributeElementExpression(oToList.options[i].value)!=0){return(i);}}return(-1);}function CheckAttributeElementExpression(sOptionValue){var reAttributeElement=":";var reExpression=EXPRESSION_SEPARATOR;var reAttribute=ITEM_SEPARATOR;var aCurrent=new Array();var aAttribute=new Array();var aElement=new Array();aCurrent=sOptionValue.split(reExpression);if(aCurrent.length>1){return(2);}aAttribute=aCurrent[0].split(reAttribute);aElement=aAttribute[0].split(reAttributeElement);if(aElement.length>1){return(0);}else{if(aCurrent[0]=="-default-"||aCurrent[0]=="-none-"){return(-1);}else{return(1);}}}function checkOneHierarchyRestriction(sDimensionId,sAttributeId,sAllowedObjectsId,sToListId,callBackStr){if(canAddAttribute(sDimensionId,sAttributeId,sAllowedObjectsId,sToListId)){return true;}showMessage({contents:microstrategy.descriptors.getDescriptor("5097"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"removeCurrentSelectionsForHierarchy('"+sAllowedObjectsId+"','"+sToListId+"');"+callBackStr,type:mstrMsgBoxImpl.MSG_WARNING});return false;}function canAddAttribute(sDimensionId,sAttributeId,sAllowedObjectsId,sToListId){var oAllowedObjects=getObj(sAllowedObjectsId);if(oAllowedObjects=="undefined"||oAllowedObjects==null){var promptForm=getObj("PromptForm");if(promptForm){oAllowedObjects=document.createElement("input");if(oAllowedObjects){oAllowedObjects.type="hidden";oAllowedObjects.id=sAllowedObjectsId;oAllowedObjects.name=sAllowedObjectsId;promptForm.insertAdjacentElement("beforeEnd",oAllowedObjects);oAllowedObjects.value=getExistingAttributeIdsFromList(sToListId);}}}var sValueStr=oAllowedObjects.value;if(sValueStr.length<=0||sValueStr.indexOf(sDimensionId)>=0||sValueStr.indexOf(sAttributeId)>=0){return true;}return false;}function addAllowedObjects(sObjectId,sAllowedObjectsId){var oAllowedObjects=getObj(sAllowedObjectsId);if(oAllowedObjects!=null){var sValueStr=oAllowedObjects.value;if(sValueStr.length<=0||sValueStr.indexOf(sObjectId)<0){oAllowedObjects.value=sValueStr+sObjectId+",";}}}function removeCurrentSelectionsForHierarchy(sAllowedObjectsId,sToList){var oAllowedObjects=getObj(sAllowedObjectsId);clearAllowedObjects(oAllowedObjects);var oList=getObj(sToList);for(var i=oList.options.length-1;i>=0;i--){oList.options[i]=null;}var oOption=new Option("--"+aDescriptor[18]+"--","-none-",false,false);oList.options[0]=oOption;oList.options[0].selected=false;oOption=null;}function clearAllowedObjects(sAllowedObjectsId){var oAllowedObjects=getObj(sAllowedObjectsId);if(!!oAllowedObjects){oAllowedObjects.value="";}}function getExistingAttributeIdsFromList(sToList){var result="";var oList=getObj(sToList);if(oList!=null){for(var i=oList.options.length-1;i>=0;i--){var attribId=getAttributeIdFromValue(oList.options[i].value);if(attribId.length>0){result+=attribId+",";}}}return result;}function getAttributeIdFromValue(sValue){var result="";var valueType=CheckAttributeElementExpression(sValue);if(valueType==2){result=sValue.split(EXPRESSION_SEPARATOR)[1];}else{if(valueType==1){result=sValue.split(ITEM_SEPARATOR)[0];}}return(result.length>0)?(result+ITEM_SEPARATOR+"12"):result;}function AddItemsbyListObjectForHI(sFromList,sToList,sDropdownList,sPin,bRemoveFromItem,sDrillButton){var oOption;var sCurrentAttributeValue;var aCurrent=new Array();var re=ITEM_SEPARATOR;var aSelArray=new Array();var sTemp="";var lPos;var lLength;var lResult;var lPin=parseInt(sPin);var oAndOr;if(bRemoveFromItem==null){bRemoveFromItem=true;}var oFromList=getObj(sFromList);var oToList=getObj(sToList);var oDropdownList=getObj(sDropdownList);var lIndexSelected=-1;var lNumSelections;lNumSelections=0;if(oFromList){oFromList.focus();sCurrentAttributeValue=GetCurrentAttributeValue(oDropdownList);lPos=CheckAttributeExist(oToList,sCurrentAttributeValue);lLength=oFromList.options.length;for(i=0;i<lLength;i++){if(oFromList.options[i].selected&&oFromList.options[i].value!="-none-"){var bAddItemToList=true;if(!bRemoveFromItem){if(isItemInList(oFromList.options[i],oToList)){bAddItemToList=false;}}if(bAddItemToList){if((oToList.options.length==1)&&((oToList.options[0].value=="-none-")||(oToList.options[0].value=="-default-"))){if(oToList.options[0].value=="-default-"){bDefault[lPin]=true;}else{bDefault[lPin]=false;}oToList.options[0]=null;}if(lPos==-1){oOption=new Option(GetUnitName(sCurrentAttributeValue)+":",sCurrentAttributeValue,false,false);oToList.options[oToList.length]=oOption;if(oToList.options[oToList.length-1]){oToList.options[oToList.length-1].selected=false;}oOption=null;}var oOption;if(bIsIE4){oOption=new Option(unescape("%a0")+unescape("%a0")+unescape("%a0")+oFromList.options[i].text,oFromList.options[i].value,false,false);}else{oOption=new Option("\u00A0\u00A0\u00A0"+oFromList.options[i].text,oFromList.options[i].value,false,false);}if(lPos>-1){var nextAttributePos=CheckNextNonAttributeElement(oToList,lPos);if(nextAttributePos==-1){lPos=oToList.options.length;}else{lPos=nextAttributePos;}}if(oOption){lPos=AddItem(sPin,oOption,lPos,oToList);var oDefaultMeaning=getObj("PROMPT_DEFAULT_MEANING_"+sPin);if((oDefaultMeaning!=null)&&(bDefault[lPin])){oDefaultMeaning.style.display="none";}lPos+=1;oOption=null;}}lIndexSelected=i;lNumSelections=lNumSelections+1;}}if(bRemoveFromItem){for(i=lLength-1;i>=0;i--){if(oFromList.options[i].selected){oFromList.options[i].selected=false;aSelArray[aSelArray.length]=i;}}}for(i=0;i<aSelArray.length;i++){oFromList.options[aSelArray[i]]=null;}if(oFromList.options.length==0){var oOption=new Option("--"+aDescriptor[18]+"--","-none-",false,false);oFromList.options[oFromList.length]=oOption;oFromList.options[oFromList.length-1].selected=false;oOption=null;}aSelArray=null;CleanList(oToList);if(!bRemoveFromItem&&(oFromList.options.length>1)){if(lNumSelections>0){for(i=0;i<lIndexSelected;i++){oFromList.options[i].selected=false;}}if((lIndexSelected>=0)&&(oFromList.options[lIndexSelected+1]!=null)){oFromList.options[lIndexSelected].selected=false;oFromList.options[lIndexSelected+1].selected=true;}else{if(lIndexSelected==-1){oFromList.options[0].selected=true;}}}else{if((lIndexSelected>0)&&(oFromList.options.length>0)){if(lIndexSelected>=lNumSelections){if(oFromList.options.length>lIndexSelected-lNumSelections+1){oFromList.options[lIndexSelected-lNumSelections+1].selected=true;}else{oFromList.options[oFromList.options.length-1].selected=true;}}else{lNumSelections=lNumSelections-1;oFromList.options[lIndexSelected-lNumSelections].selected=true;}}else{oFromList.options[0].selected=true;}}lLength=oToList.options.length;lResult=0;for(i=0;i<lLength;i++){sTemp=oToList.options[i].value;if(CheckAttributeElementExpression(sTemp)!=0){lResult+=1;}}if((getObj("ANDOR_"+sPin)!=null)&&(lResult>1)){displayObj("ANDOR_"+sPin);}}}function RemoveItemsByPin(oFromList,sPin){var aSelArray=new Array();var lLength=oFromList.options.length;var lPin=parseInt(sPin);for(var i=lLength-1;i>=0;i--){if(oFromList.options[i].selected){oFromList.options[i].selected=false;aSelArray[aSelArray.length]=i;}}for(i=0;i<aSelArray.length;i++){if((oFromList.options[aSelArray[i]].value=="-default-")||(oFromList.options[aSelArray[i]].text=="(default)")){bDefault[lPin]=false;}for(var j=aSelArray[i];j<oFromList.options.length-1;j++){oFromList.options[j].value=oFromList.options[j+1].value;oFromList.options[j].text=oFromList.options[j+1].text;}oFromList.options.length-=1;}if(oFromList.options.length==0){var oDefaultMeaning=getObj("PROMPT_DEFAULT_MEANING_"+sPin);if(bDefault[lPin]){var oOption=new Option("--- "+aDescriptor[19]+" ---","-default-",false,false);if(oDefaultMeaning!=null){oDefaultMeaning.style.display="block";}}else{var oOption=new Option("--"+aDescriptor[18]+"--","-none-",false,false);if(oDefaultMeaning!=null){oDefaultMeaning.style.display="none";var oAnswerOption=null;if(sPin=="0"){oAnswerOption=getObj("answerOptions");}else{oAnswerOption=getObj("answerOptions_"+sPin);}if(oAnswerOption!=null){oAnswerOption.value="2";}}}oFromList.options[oFromList.length]=oOption;oFromList.options[oFromList.length-1].selected=false;oOption=null;}aSelArray=null;}function RemoveItemsbyListObjectForHIInList(sFromList,sToList,sDropdownList,sPin,bRemoveFromItem,bAddItem,sDrillButton){var sAttributeValue;var sElementValue;var sCurrentAttributeValue="";var sText;var aCurrent=new Array();var sValue;var lResult;var sTemp;var bAllDimension=false;var reAttribute=ITEM_SEPARATOR;var oFromList=getObj(sFromList);var oToList=getObj(sToList);var oDropdownList=getObj(sDropdownList);var oAndOr;if(bRemoveFromItem==null){bRemoveFromItem=true;}if(bAddItem==null){bAddItem=true;}if(oDropdownList){sCurrentAttributeValue=GetCurrentAttributeValue(oDropdownList);}else{bAllDimension=true;}var lLength=oFromList.options.length;var bIsThereAnySelection=false;var elemIndexToSelect=-1;for(var lAttributeIndex=0;lAttributeIndex<lLength;lAttributeIndex++){if((oFromList.options[lAttributeIndex])&&(oFromList.options[lAttributeIndex].selected)){bIsThereAnySelection=true;elemIndexToSelect=lAttributeIndex;break;}}if(!bIsThereAnySelection&&(lLength>0)&&(oFromList.options[0])&&(oFromList.options[0].value!="-none")){oFromList.options[lLength-1].selected=true;}for(var lAttributeIndex=0;lAttributeIndex<lLength;lAttributeIndex++){sAttributeValue=oFromList.options[lAttributeIndex].value;if(CheckAttributeElementExpression(sAttributeValue)==1){bAttributeSelected=true;var lElementIndex=lAttributeIndex+1;sElementValue=oFromList.options[lElementIndex].value;while((lElementIndex<lLength)&&(CheckAttributeElementExpression(sElementValue)==0)){if(oFromList.options[lAttributeIndex].selected){oFromList.options[lElementIndex].selected=true;if((bAddItem)&&(isSameAttributeValue(sAttributeValue,sCurrentAttributeValue)||bAllDimension)){sText=oFromList.options[lElementIndex].text;var oElementOption=new Option(sText.substring(3,sText.length),oFromList.options[lElementIndex].value,false,false);AddItem(sPin,oElementOption,-1,oToList);}}else{if(oFromList.options[lElementIndex].selected==true){if((bAddItem)&&(isSameAttributeValue(sAttributeValue,sCurrentAttributeValue)||bAllDimension)){sText=oFromList.options[lElementIndex].text;var oElementOption=new Option(sText.substring(3,sText.length),oFromList.options[lElementIndex].value,false,false);AddItem(sPin,oElementOption,-1,oToList);}}else{bAttributeSelected=false;}}lElementIndex+=1;if(lElementIndex<lLength){sElementValue=oFromList.options[lElementIndex].value;}}oFromList.options[lAttributeIndex].selected=bAttributeSelected;lAttributeIndex=lElementIndex-1;}}if(bRemoveFromItem){RemoveItemsByPin(oFromList,sPin);CleanList(oFromList);}if(oFromList.length>1){if((elemIndexToSelect>0)&&(elemIndexToSelect<(oFromList.length-1))){if(CheckAttributeElementExpression(oFromList.options[elemIndexToSelect].value)!=0){elemIndexToSelect++;}}else{if(CheckAttributeElementExpression(oFromList.options[oFromList.length-1].value)!=1){elemIndexToSelect=oFromList.length-1;}else{if(CheckAttributeElementExpression(oFromList.options[oFromList.length-2].value)!=1){elemIndexToSelect=oFromList.length-2;}}}oFromList.options[elemIndexToSelect].selected=true;}lLength=oFromList.options.length;lResult=0;for(i=0;i<lLength;i++){sTemp=oFromList.options[i].value;if(CheckAttributeElementExpression(sTemp)!=0){lResult+=1;}}if(lResult<2){oAndOr=getObj("ANDOR_"+sPin);if(oAndOr!=null){oAndOr.style.display="none";}}}function RemoveItemsbyListObjectForHIInQual(sFromList,sOperatorList,sDropdownList,sPin,bRemoveFromItem){var sAttributeValue;var sElementValue;var sCurrentAttributeValue;var sText;var aCurrent=new Array();var sValue;var lResult;var sTemp;var lAttributeIndex;var lElementIndex;var sFirstValue="";var lType;var re=EXPRESSION_SEPARATOR;var reAttribute=ITEM_SEPARATOR;var oFromList=getObj(sFromList);var oOperatorList=getObj(sOperatorList);var oDropdownList=getObj(sDropdownList);var oAndOr;if(bRemoveFromItem==null){bRemoveFromItem=true;}var lLength=oFromList.options.length;for(lAttributeIndex=0;lAttributeIndex<lLength;lAttributeIndex++){sAttributeValue=oFromList.options[lAttributeIndex].value;lType=CheckAttributeElementExpression(sAttributeValue);if(lType==1){bAttributeSelected=true;lElementIndex=lAttributeIndex+1;sElementValue=oFromList.options[lElementIndex].value;while((lElementIndex<lLength)&&(CheckAttributeElementExpression(sElementValue)==0)){if(oFromList.options[lAttributeIndex].selected){oFromList.options[lElementIndex].selected=true;}else{if(oFromList.options[lElementIndex].selected==false){bAttributeSelected=false;}}lElementIndex+=1;if(lElementIndex<lLength){sElementValue=oFromList.options[lElementIndex].value;}}oFromList.options[lAttributeIndex].selected=bAttributeSelected;lAttributeIndex=lElementIndex-1;}if((lType==2)&&(sFirstValue=="")){sFirstValue=sAttributeValue;}}if(bRemoveFromItem){RemoveItemsByPin(oFromList,sPin);CleanList(oFromList);}lLength=oFromList.options.length;lResult=0;for(i=0;i<lLength;i++){sTemp=oFromList.options[i].value;if(CheckAttributeElementExpression(sTemp)!=0){lResult+=1;}}if(lResult<2){oAndOr=getObj("ANDOR_"+sPin);if(oAndOr!=null){oAndOr.style.display="none";}}if(oDropdownList){aCurrent=sFirstValue.split(re);lLength=oDropdownList.options.length;for(i=0;i<lLength;i++){if(oDropdownList.options[i].value==aCurrent[1]){oDropdownList.options[i].selected=true;break;}}}lLength=oOperatorList.options.length;for(i=0;i<lLength;i++){if(oOperatorList.options[i].value==aCurrent[0]){oOperatorList.options[i].selected=true;break;}}}function GetNodeAttributeValue(oTarget){var value="";if(oTarget){value=oTarget.getAttribute("val");}return value;}function GetNodeDimensionId(oTarget){var value="";if(oTarget){value=oTarget.getAttribute("dimensionId");}return value;}function AddAttributeQualificationExpressionForTree(sFromList,sDropdownList,sTextbox,sBeanPath,sBeanName,editorId){AddItemsbyListObjectForExpression(sFromList,sDropdownList,sTextbox,treeToList,treePos);ClosePromptEditor(sBeanPath,sBeanName,editorId);}function ClosePromptEditor(sBeanPath,sBeanName,editorId){var oEditor=document.getElementById(editorId);oEditor&&(oEditor.style.visibility="hidden");togglePulldowns(oEditor,true);toggleShowBean(sBeanName,false,"isTreeRequest=true&position="+treePos,true);}function AddItemsbyListObjectForHIInTree(sFromList,sToList,sPin,bAttributeQualSupported,sOperatorType,bAllowOneHierarchy){var oOption;var sCurrentAttributeValue;var aSelArray=new Array();var sTemp="";var lPos;var lLength=0;var lResult;var lPin=parseInt(sPin);var oAndOr;var oFromList=getObj(sFromList);var oToList=getObj(sToList);var lIndexSelected;var lNumSelections=0;var lastSelectedIndex=-1;var isSelectionAdded=false;var sAllowedObjectsId="";if(bAllowOneHierarchy){sAllowedObjectsId=(lPin>0)?"allowedObjects_"+lPin:"allowedObjects";}if(oFromList){var oLI=oFromList.getElementsByTagName("LI");if((oLI)&&(oLI.length)){lLength=oLI.length;}for(i=0;i<lLength;i++){if(oLI[i].getAttribute("sel")=="1"){if(oLI[i].getAttribute("tp")!="12"&&oLI[i].getAttribute("tp")!="14"&&oLI[i].getAttribute("tp")!="8"){if((oToList.options.length==1)&&((oToList.options[0].value=="-none-")||(oToList.options[0].value=="-default-"))){bDefault[lPin]=(oToList.options[0].value=="-default-")?true:false;oToList.options[0]=null;}sCurrentAttributeElmentValue=GetNodeAttributeValue(oLI[i]);lPos=CheckAttributeExist(oToList,sCurrentAttributeElmentValue);if(lPos==-1){sCurrentAttributeValue=GetNodeAttributeValue(oLI[i].parentNode.parentNode.previousSibling.childNodes[0]);lPos=CheckAttributeExist(oToList,sCurrentAttributeValue);if(lPos==-1){if(bAllowOneHierarchy){var currentDimensionIdValue=GetNodeDimensionId(oLI[i].parentNode.parentNode.previousSibling.childNodes[0]);var currentDimensionId=currentDimensionIdValue.split(ITEM_SEPARATOR)[0]+ITEM_SEPARATOR+"14";var attribId=sCurrentAttributeValue.split(ITEM_SEPARATOR)[0]+ITEM_SEPARATOR+"12";var callBackStr="AddItemsbyListObjectForHIInTree('"+sFromList+"','"+sToList+"','"+sPin+"','"+bAttributeQualSupported+"','"+sOperatorType+"','"+bAllowOneHierarchy+"')";if(!checkOneHierarchyRestriction(currentDimensionId,attribId,sAllowedObjectsId,sToList,callBackStr)){return ;}addAllowedObjects(currentDimensionId,sAllowedObjectsId);}oOption=new Option(GetUnitName(sCurrentAttributeValue)+":",sCurrentAttributeValue,false,false);oToList.options[oToList.length]=oOption;isSelectionAdded=true;if(oToList.options[oToList.length-1]){oToList.options[oToList.length-1].selected=false;}oOption=null;}if(lPos>-1){var nextAttributePos=CheckNextNonAttributeElement(oToList,lPos);if(nextAttributePos==-1){lPos=oToList.options.length;}else{lPos=nextAttributePos;}}var oOption=(bIsIE4)?new Option(unescape("%a0")+unescape("%a0")+unescape("%a0")+LTrim(oLI[i].innerText),oLI[i].getAttribute("val"),false,false):new Option("\u00A0\u00A0\u00A0"+LTrim(oLI[i].innerText),oLI[i].getAttribute("val"),false,false);if(oOption){lPos=AddItem(sPin,oOption,lPos,oToList);isSelectionAdded=true;var oDefaultMeaning=getObj("PROMPT_DEFAULT_MEANING_"+sPin);if((oDefaultMeaning!=null)&&(bDefault[lPin])){oDefaultMeaning.style.display="none";}lPos+=1;oOption=null;lIndexSelected=i;lNumSelections=lNumSelections+1;}}}else{if(oLI[i].getAttribute("tp")=="12"&&bAttributeQualSupported){if(bAllowOneHierarchy){sCurrentAttributeValue=GetNodeAttributeValue(oLI[i]);lPos=CheckAttributeExist(oToList,sCurrentAttributeValue);if(lPos==-1){var currentDimensionIdValue=GetNodeDimensionId(oLI[i]);var currentDimensionId=currentDimensionIdValue.split(ITEM_SEPARATOR)[0]+ITEM_SEPARATOR+"14";var attribId=sCurrentAttributeValue.split(ITEM_SEPARATOR)[0]+ITEM_SEPARATOR+"12";var callBackStr="AddItemsbyListObjectForHIInTree('"+sFromList+"','"+sToList+"','"+sPin+"','"+bAttributeQualSupported+"','"+sOperatorType+"','"+bAllowOneHierarchy+"')";if(!checkOneHierarchyRestriction(currentDimensionId,attribId,sAllowedObjectsId,sToList,callBackStr)){return ;}addAllowedObjects(currentDimensionId,sAllowedObjectsId);}}treeToList=sToList;treePos=sPin;var hiddenFormsArg="";if(oLI[i].getAttribute("hiddenForms")){hiddenFormsArg="&hiddenForms="+oLI[i].getAttribute("hiddenForms");}toggleShowBean("attFormsQual",true,"position="+sPin+"&isTreeRequest=true&attributeId="+oLI[i].getAttribute("did")+"&operatorType="+sOperatorType+hiddenFormsArg,true);}}oLI[i].setAttribute("sel","0");var oChild=util_getChildNode(oLI[i],"A");if(oChild){oChild.className="";}if(isSelectionAdded){lastSelectedIndex=i;}}}if(lastSelectedIndex!=-1){var lastSelectedItemType=oLI[lastSelectedIndex].getAttribute("tp");var lastSelectedItemDid=oLI[lastSelectedIndex].getAttribute("did");if(lastSelectedItemDid&&lastSelectedItemDid.indexOf(":")>0){lastSelectedItemDid=lastSelectedItemDid.substring(0,lastSelectedItemDid.indexOf(":"));}for(var i=lastSelectedIndex+1;i<lLength;i++){var currentItemType=oLI[i].getAttribute("tp");if(currentItemType&&currentItemType==lastSelectedItemType){var currentItemDid=oLI[i].getAttribute("did");if(currentItemDid&&currentItemDid.indexOf(":")>0){currentItemDid=currentItemDid.substring(0,currentItemDid.indexOf(":"));}if(currentItemDid&&currentItemDid==lastSelectedItemDid){util_markNodeAsSelected(oLI[i]);scrollItemIntoView(oLI[i],oFromList,false);break;}}}}CleanList(oToList);lLength=oToList.options.length;lResult=0;for(i=0;i<lLength;i++){sTemp=oToList.options[i].value;if(CheckAttributeElementExpression(sTemp)!=0){lResult+=1;}}if(lResult>1){displayObj("ANDOR_"+sPin);}}}function itemIsInView(elem,listDiv){var parentRect=new SimpleRect(listDiv);var items=elem.getElementsByTagName("A");if(items&&items.length>0){var listItemRect=new SimpleRect(items[0]);return(listItemRect.left>parentRect.left&&listItemRect.right<(parentRect.left+parseInt(getObjInnerWidth(listDiv)))&&listItemRect.top>parentRect.top&&listItemRect.bottom<(parentRect.top+parseInt(getObjInnerHeight(listDiv))));}return false;}function scrollItemIntoView(elem,listDiv,toTop){var parentRect=new SimpleRect(listDiv);var items=elem.getElementsByTagName("A");if(items&&items.length>0){var listItemRect=new SimpleRect(items[0]);var topDelta=(listItemRect.top>parentRect.top&&listItemRect.top<(parentRect.top+parseInt(getObjInnerHeight(listDiv))))?0:(parentRect.top-listItemRect.top);var bottomDelta=(listItemRect.bottom>parentRect.top&&listItemRect.bottom<(parentRect.top+parseInt(getObjInnerHeight(listDiv))))?0:(listItemRect.bottom-(parentRect.top+parseInt(getObjInnerHeight(listDiv))));if(toTop){if(topDelta>0){listDiv.scrollTop=listDiv.scrollTop+topDelta;}}else{if(bottomDelta>0){listDiv.scrollTop=listDiv.scrollTop+bottomDelta;}}}}function RemoveItemsbyListObjectForHIInTree(sFromList,sPin){var sAttributeValue;var sElementValue;var lResult;var sTemp;var oFromList=getObj(sFromList);var oAndOr;var elemIndexToSelect=-1;var lLength=oFromList.options.length;for(var lAttributeIndex=0;lAttributeIndex<lLength;lAttributeIndex++){sAttributeValue=oFromList.options[lAttributeIndex].value;if(CheckAttributeElementExpression(sAttributeValue)==1){bAttributeSelected=true;var lElementIndex=lAttributeIndex+1;sElementValue=oFromList.options[lElementIndex].value;while((lElementIndex<lLength)&&(CheckAttributeElementExpression(sElementValue)==0)){if(oFromList.options[lAttributeIndex].selected){oFromList.options[lElementIndex].selected=true;}else{if(oFromList.options[lElementIndex].selected==false){bAttributeSelected=false;}}lElementIndex+=1;if(lElementIndex<lLength){sElementValue=oFromList.options[lElementIndex].value;}}oFromList.options[lAttributeIndex].selected=bAttributeSelected;lAttributeIndex=lElementIndex-1;}}for(var i=lLength-1;i>=0;i--){if(oFromList.options[i].selected){elemIndexToSelect=i;break;}}RemoveItemsByPin(oFromList,sPin);CleanList(oFromList);if(oFromList.length>1){if((elemIndexToSelect>0)&&(elemIndexToSelect<(oFromList.length-1))){if(CheckAttributeElementExpression(oFromList.options[elemIndexToSelect].value)!=0){elemIndexToSelect++;}}else{if(CheckAttributeElementExpression(oFromList.options[oFromList.length-1].value)!=1){elemIndexToSelect=oFromList.length-1;}else{if(CheckAttributeElementExpression(oFromList.options[oFromList.length-2].value)!=1){elemIndexToSelect=oFromList.length-2;}}}oFromList.options[elemIndexToSelect].selected=true;}else{if(CheckAttributeElementExpression(oFromList.options[0].value)==-1){var lPin=parseInt(sPin);var sAllowedObjectsId=(lPin>0)?"allowedObjects_"+lPin:"allowedObjects";clearAllowedObjects(sAllowedObjectsId);}}lLength=oFromList.options.length;lResult=0;for(i=0;i<lLength;i++){sTemp=oFromList.options[i].value;if(CheckAttributeElementExpression(sTemp)!=0){lResult+=1;}}if(lResult<2){oAndOr=getObj("ANDOR_"+sPin);if(oAndOr!=null){oAndOr.style.display="none";}}}function AddItem(sPin,oOption,lPos,oToList){var lLength;var lPin=parseInt(sPin);if(oToList){if((oToList.options.length==1)&&((oToList.options[0].value=="-none-")||(oToList.options[0].value=="-default-")||(oToList.options[0].text=="(default)"))){if((oToList.options[0].value=="-default-")||(oToList.options[0].text=="(default)")){bDefault[lPin]=true;}else{bDefault[lPin]=false;}oToList.options[0]=null;}lLength=oToList.options.length;if(lPos==-1){lPos=lLength;}for(var i=lLength;i>lPos;i--){var oTempOption=new Option(oToList.options[i-1].text,oToList.options[i-1].value,false,false);oToList.options[i]=oTempOption;oToList.options[i].selected=false;oTempOption=null;}oToList.options[lPos]=oOption;oToList.options[lPos].selected=false;}return(lPos);}function AddItemsbyListObjectForExpression(sFromList,sDropdownList,sTextbox,sToList,sPin,sIncludeExclude){var oOption;var sCurrentAttributeValueText;var sCurrentAttributeValueValue;var sCurrentAttributeValueDatatype;var sCurrentOperator;var sInput;var sValue;var sText;var lLength;var lInputArrSize;var oAndOr;var lPin=parseInt(sPin);var oFromList=getObj(sFromList);var oToList=getObj(sToList);var oTextbox=getObj(sTextbox);var oDropdownList=getObj(sDropdownList);var sIncludeExcludeValue="";if(sIncludeExclude){var obj=document.getElementsByName(sIncludeExclude);if(obj&&obj.length>0){for(var i=0;i<obj.length;i++){if(obj[i].checked){sIncludeExcludeValue=obj[i].value;break;}}}}sCurrentAttributeValueValue=GetSelectedItemValue(oFromList);sCurrentAttributeValueText=GetSelectedItemText(oFromList);sCurrentAttributeValueDatatype=GetSelectedItemDatatype(oFromList);sCurrentOperator=GetSelectedItemValue(oDropdownList);sInput=oTextbox.value;if((sCurrentOperator=="17"+ITEM_SEPARATOR+"1")||(sCurrentOperator=="22"+ITEM_SEPARATOR+"1")||(sCurrentOperator=="57"+ITEM_SEPARATOR+"1")||(sCurrentOperator=="44"+ITEM_SEPARATOR+"1")){sInput=CleanInput(sInput,false);}lInputArrSize=sInput.split(";").length;if(sCurrentAttributeValueValue=="0"){DisplayError(aDescriptor[16],aDescriptor[15],sPin);return false;}else{if((sInput=="")&&!((sCurrentOperator=="54"+ITEM_SEPARATOR+"1")||(sCurrentOperator=="55"+ITEM_SEPARATOR+"1"))){DisplayError(aDescriptor[16],aDescriptor[12],sPin);return false;}else{if(sCurrentAttributeValueValue!=""&&sCurrentAttributeValueValue!="0"){var opKeys=sCurrentOperator.split(ITEM_SEPARATOR);if(opKeys[1]=="3"){sInput=CleanPercentageSign(sInput)+"%";}sText=BuildSelectTextForExpression(sCurrentAttributeValueText,sCurrentOperator,sInput,sCurrentAttributeValueDatatype,sPin);sCurrentOperator=AddOutputLevelToOperator(sCurrentOperator,sPin);if(sIncludeExcludeValue=="exclude"){sCurrentOperator+=ITEM_SEPARATOR+"exclude";}sValue=BuildSelectValueForExpression(sCurrentAttributeValueValue,sCurrentOperator,sInput,sIncludeExcludeValue);if(sText=="9"){DisplayError(aDescriptor[16],aDescriptor[9],sPin);return false;}else{if(sText=="21"){DisplayError(aDescriptor[16],aDescriptor[21],sPin);return false;}else{if(sText=="10"){DisplayError(aDescriptor[16],aDescriptor[10],sPin);return false;}else{if((sCurrentOperator=="M8"||sCurrentOperator=="M9"||sCurrentOperator=="M10"||sCurrentOperator=="M11")&&(lInputArrSize>1)){DisplayError(aDescriptor[16],aDescriptor[15],sPin);oTextbox.value="";return false;}else{if(sText!="0"){var positionToAdd=-1;if(sIncludeExcludeValue.length>0){if(bIsIE4){sText=unescape("%a0")+unescape("%a0")+unescape("%a0")+sText;}else{sText="\u00A0\u00A0\u00A0"+sText;}var currentOptionPos=CheckIncludeExcludePosition(oToList,sIncludeExcludeValue);if(sIncludeExcludeValue=="include"){if(currentOptionPos==-1){positionToAdd=AddIncludeOption(sPin,oToList);}else{var excludePos=CheckIncludeExcludePosition(oToList,"exclude");positionToAdd=excludePos;}}else{if(sIncludeExcludeValue=="exclude"){if(currentOptionPos==-1){positionToAdd=AddExcludeOption(sPin,oToList);}else{positionToAdd=-1;}}}}oOption=new Option(sText,sValue,false,false);oOption.setAttribute("unitId",sCurrentAttributeValueValue);oOption.setAttribute("opId",sCurrentOperator);oOption.setAttribute("val",sInput);AddItem(sPin,oOption,positionToAdd,oToList);oTextbox.value="";var oDefaultMeaning=getObj("PROMPT_DEFAULT_MEANING_"+sPin);if((oDefaultMeaning!=null)&&(bDefault[lPin])){oDefaultMeaning.style.display="none";}ClearError(sPin);}}}}}}}}lLength=oToList.options.length;if(lLength>1){oAndOr=getObj("ANDOR_"+sPin);if(oAndOr!=null){oAndOr.style.display="block";}}return true;}function updateExpressionFields(oExpFormattedValue,oOperatorsList,oValueTextbox,oToList,sCalendarObj,sIncludeExclude){var iUnitIdDatatype=-1;if(oExpFormattedValue){if(oToList&&oExpFormattedValue.getAttribute("unitId")){var unitId=oExpFormattedValue.getAttribute("unitId");if(unitId.length>0){for(var availCount=0;availCount<oToList.length;availCount++){if(oToList.options[availCount]){if(oToList.options[availCount].value.indexOf(unitId)>-1){oToList.options[availCount].selected=true;if(oToList.options[availCount].getAttribute("DATATYPE")){iUnitIdDatatype=oToList.options[availCount].getAttribute("DATATYPE");}}else{oToList.options[availCount].selected=false;}}}}}var opId=oExpFormattedValue.getAttribute("opId");if(oOperatorsList&&opId){if(opId.length>0){for(var opCount=0;opCount<oOperatorsList.length;opCount++){if(oOperatorsList.options[opCount]){if(opId.indexOf(oOperatorsList.options[opCount].value,0)==0){oOperatorsList.options[opCount].selected=true;}else{oOperatorsList.options[opCount].selected=false;}}}}}if((oValueTextbox!=null)&&(oExpFormattedValue.getAttribute("val")!=null)){oValueTextbox.value=oExpFormattedValue.getAttribute("val");if((opId!=null)&&(opId.length>0)){var oCalendarObj=getObj(sCalendarObj);if((opId.indexOf("54"+ITEM_SEPARATOR+"1",0)==0)||(opId.indexOf("55"+ITEM_SEPARATOR+"1",0)==0)){oValueTextbox.parentNode.style.visibility="hidden";if(((iUnitIdDatatype==15)||(iUnitIdDatatype==14))&&oCalendarObj){oCalendarObj.style.visibility="hidden";}}else{oValueTextbox.parentNode.style.visibility="visible";if(((iUnitIdDatatype==15)||(iUnitIdDatatype==14))&&oCalendarObj){oCalendarObj.style.visibility="visible";}}}}if(sIncludeExclude&&opId){var obj=document.getElementsByName(sIncludeExclude);var opKeys=opId.split(ITEM_SEPARATOR);var includeExcludeValue="include";if(opKeys.length>2){includeExcludeValue="exclude";}if(obj&&obj.length>0){for(var i=0;i<obj.length;i++){if(obj[i].value==includeExcludeValue){obj[i].checked=true;break;}}}}}}function hideExpressionValueTextbox(operatorPulldown,valueTextbox,calendarButton,availableList){var oOperator=getObj(operatorPulldown);var oValue=getObj(valueTextbox);if(oOperator&&oValue){var opKeys=oOperator.value.split(ITEM_SEPARATOR);var oAvailable=getObj(availableList);var oCalendar=getObj(calendarButton);var bToggleCalendar=false;if(oAvailable&&(oAvailable.options.length>0)&&oCalendar){var selIndex=oAvailable.options.selectedIndex;if((selIndex!=null)&&(selIndex>-1)){var dataType=oAvailable.options[selIndex].getAttribute("DATATYPE");if((dataType!=null)&&((dataType==15)||(dataType==14))){bToggleCalendar=true;}}}if((opKeys[0]=="54")||(opKeys[0]=="55")){if((oValue.parentNode!=null)&&(oValue.parentNode.nodeName=="DIV")){oValue.parentNode.style.visibility="hidden";}else{oValue.style.visibility="hidden";}if(bToggleCalendar&&oCalendar){oCalendar.style.visibility="hidden";}}else{if((oValue.parentNode!=null)&&(oValue.parentNode.nodeName=="DIV")){oValue.parentNode.style.visibility="visible";}else{oValue.style.visibility="visible";}if(bToggleCalendar&&oCalendar){oCalendar.style.visibility="visible";}}}}function RemoveItemsbyListObjectForExpression(sFromList,sDropdownList,sValueTextbox,sPin,sToList,sCalendarObj,sIncludeExclude){var oOption;var sCurrentAttributeValue;var sCurrentOperator;var sInput;var aCurrent=new Array();var aSelArray=new Array();var re=ANSWER_SEPARATOR;var reMetric=ITEM_SEPARATOR;var sText;var lPin=parseInt(sPin);var bInBlock;var aMetric;var aTempMetric;var sTempMetric;var sText;var oDropdownList=getObj(sDropdownList);var oValueTextbox=getObj(sValueTextbox);var oToList=getObj(sToList);var oFromList=getObj(sFromList);var lLength=oFromList.options.length;var hasIncludeExclude=isIncludeExcludeOption(oFromList.options[0]);var includePos=-1;var excludePos=-1;if(hasIncludeExclude){includePos=CheckIncludeExcludePosition(oFromList,"include");excludePos=CheckIncludeExcludePosition(oFromList,"exclude");}var bIsThereAnySelection=false;if(oFromList.selectedIndex!=-1){bIsThereAnySelection=true;}if(!bIsThereAnySelection&&(lLength>0)&&(oFromList.options[0])&&(oFromList.options[0].value!="-none")){oFromList.options[0].selected=true;}if(hasIncludeExclude){if(includePos==oFromList.selectedIndex){oFromList.selectedIndex=includePos+1;}else{if(excludePos==oFromList.selectedIndex){oFromList.selectedIndex=excludePos+1;}}if(includePos>=0){if((includePos==lLength-2)||(includePos==excludePos-2&&excludePos>oFromList.selectedIndex)){oFromList.options[includePos]=null;lLength=oFromList.options.length;}}if(excludePos>=0&&excludePos==lLength-2&&excludePos<oFromList.selectedIndex){oFromList.options[excludePos]=null;lLength=oFromList.options.length;}}if(!oFromList.multiple){aSelArray[aSelArray.length]=oFromList.selectedIndex;}else{for(var i=lLength-1;i>=0;i--){if(oFromList.options[i].selected){oFromList.options[i].selected=false;aSelArray[aSelArray.length]=i;}}}if(aSelArray.length!=0){for(i=0;i<aSelArray.length;i++){if((oFromList.options[aSelArray[i]].value=="-default-")||(oFromList.options[aSelArray[i]].text=="(default)")){bDefault[lPin]=false;}updateExpressionFields(oFromList.options[aSelArray[i]],oDropdownList,oValueTextbox,oToList,sCalendarObj,sIncludeExclude);oFromList.options[aSelArray[i]]=null;}if(oFromList.options.length==0){var oDefaultMeaning=getObj("PROMPT_DEFAULT_MEANING_"+sPin);if(bDefault[lPin]){var oOption=new Option("--- "+aDescriptor[19]+" ---","-default-",false,false);if(oDefaultMeaning!=null){oDefaultMeaning.style.display="block";}}else{var oOption=new Option("--"+aDescriptor[18]+"--","-none-",false,false);if(oDefaultMeaning!=null){oDefaultMeaning.style.display="none";var oAnswerOption=null;if(sPin=="0"){oAnswerOption=getObj("answerOptions");}else{oAnswerOption=getObj("answerOptions_"+sPin);}if(oAnswerOption!=null){oAnswerOption.value="2";}}}oFromList.options[oFromList.length]=oOption;oFromList.options[oFromList.length-1].selected=false;oOption=null;}lLength=oFromList.options.length;if(lLength<2&&document.all){if(sPin!=null||sPin!=""){var oAndOr=getObj("ANDOR_"+sPin);if(oAndOr!=null){oAndOr.style.display="none";}}}}}function isIncludeExcludeOption(oOption){if(oOption!=null&&(oOption.value=="include"||oOption.value=="exclude")){return true;}return false;}function CheckIncludeExcludePosition(oToList,sIncludeExcludeValue){var lLength=oToList.options.length;for(var i=0;i<lLength;i++){if(oToList.options[i].value==sIncludeExcludeValue){return(i);}}return(-1);}function AddIncludeOption(sPin,oToList){var oOption=new Option(aDescriptor[39],"include",false,false);AddItem(sPin,oOption,0,oToList);return(1);}function AddExcludeOption(sPin,oToList){var oOption=new Option(aDescriptor[40],"exclude",false,false);AddItem(sPin,oOption,-1,oToList);return(oToList.length);}function BuildSelectValueForExpression(sObject,sOperator,sInput,sIncludeExcludeValue){var sValue;var re=EXPRESSION_SEPARATOR;var aCurrent=new Array();var reInput;var opKeys=sOperator.split(ITEM_SEPARATOR);if(opKeys[0]=="22"){var reInput=new RegExp(",","g");sInput=sInput.replace(reInput,";");}sInput=CleanInput(sInput,false);sValue=sOperator+re+sObject+re+sInput;return(sValue);}function FindDelimeter(sValue){var aResult;aResult=sValue.match(";");if(aResult!=null){return(";");}else{aResult=sValue.match(",");if(aResult!=null){return(",");}else{return("");}}}function BuildSelectTextForExpression(sObjectText,sOperator,sInput,sInputDatatype,sPin){var sValue;var re=ITEM_SEPARATOR;var aCurrent=new Array();var sTemp;var lLength;var sDelimeter=FindDelimeter(sInput);sValue=sObjectText;var opKeys=sOperator.split(ITEM_SEPARATOR);if(opKeys[1]=="1"){sOperator="M"+opKeys[0];}else{if(opKeys[1]=="2"){sOperator="R"+opKeys[0];}else{if(opKeys[1]=="3"){sOperator="P"+opKeys[0];}}}var sOperatorSymbol=GetOperatorSymbol(sOperator);if(sOperator=="M17"){if(sDelimeter==";"){aCurrent=sInput.split(sDelimeter);}else{return("9");}lLength=aCurrent.length;if(sInputDatatype=="4"){for(lCount=0;lCount<lLength;lCount++){if(!isANumber(aCurrent[lCount])){return("21");}}}if(lLength==2){sValue=sValue+" "+aDescriptor[1]+" "+aCurrent[0]+" "+aDescriptor[8]+" "+aCurrent[1];}else{return("9");}}else{if(sOperator=="M44"){if(sDelimeter==";"){aCurrent=sInput.split(sDelimeter);}else{return("10");}lLength=aCurrent.length;if(sInputDatatype=="4"){for(lCount=0;lCount<lLength;lCount++){if(!isANumber(aCurrent[lCount])){return("21");}}}if(lLength==2){sValue=sValue+" "+aDescriptor[2]+" "+aCurrent[0]+" "+aDescriptor[8]+" "+aCurrent[1];}else{return("10");}}else{if(sOperator=="M22"){var reInput=new RegExp(",","g");sTemp=sInput.replace(reInput,";");sValue=sValue+" "+aDescriptor[7]+" ("+sTemp+")";}else{if(sOperator=="M57"){var reInput=new RegExp(",","g");sTemp=sInput.replace(reInput,";");sValue=sValue+" "+aDescriptor[20]+" ("+sTemp+")";}else{if(sOperator=="M18"){sValue=sValue+" "+aDescriptor[3]+" "+sInput;}else{if(sOperator=="M43"){sValue=sValue+" "+aDescriptor[4]+" "+sInput;}else{if(sOperator=="P1"){sValue=sValue+" "+aDescriptor[5]+" "+sInput;}else{if(sOperator=="P2"){sValue=sValue+" "+aDescriptor[6]+" "+sInput;}else{if(sOperator=="R1"){sValue=sValue+" "+aDescriptor[5]+" "+sInput;}else{if(sOperator=="R2"){sValue=sValue+" "+aDescriptor[6]+" "+sInput;}else{if(sOperator=="M76"){if(sInput.indexOf('"')<0){sValue=sValue+" "+aDescriptor[33]+' "'+sInput+'"';}else{sValue=sValue+" "+aDescriptor[33]+" "+sInput;}}else{if(sOperator=="M77"){if(sInput.indexOf('"')<0){sValue=sValue+" "+aDescriptor[34]+' "'+sInput+'"';}else{sValue=sValue+" "+aDescriptor[34]+" "+sInput;}}else{if(sOperator=="M78"){if(sInput.indexOf('"')<0){sValue=sValue+" "+aDescriptor[35]+' "'+sInput+'"';}else{sValue=sValue+" "+aDescriptor[35]+" "+sInput;}}else{if(sOperator=="M79"){if(sInput.indexOf('"')<0){sValue=sValue+" "+aDescriptor[30]+' "'+sInput+'"';}else{sValue=sValue+" "+aDescriptor[30]+" "+sInput;}}else{if(sOperator=="M80"){if(sInput.indexOf('"')<0){sValue=sValue+" "+aDescriptor[31]+' "'+sInput+'"';}else{sValue=sValue+" "+aDescriptor[31]+" "+sInput;}}else{if(sOperator=="M81"){if(sInput.indexOf('"')<0){sValue=sValue+" "+aDescriptor[32]+' "'+sInput+'"';}else{sValue=sValue+" "+aDescriptor[32]+" "+sInput;}}else{if(sOperator=="M54"){sValue=sValue+" "+aDescriptor[36];}else{if(sOperator=="M55"){sValue=sValue+" "+aDescriptor[37];}else{sValue=sValue+" "+sOperatorSymbol+" "+sInput;}}}}}}}}}}}}}}}}}}sValue=AddMQOutputLevelText(sValue,sPin);return(sValue);}function isANumber(sNum){var _result=false;if(promptDecimalSeparator!=null){sNum=sNum.replace(promptDecimalSeparator,".");if(!isNaN(sNum)){_result=true;}}return _result;}function GetOperatorSymbol(sOperator){if(sOperator=="M17"){return(aDescriptor[1]);}else{if(sOperator=="M44"){return(aDescriptor[2]);}else{if(sOperator=="M6"){return(aDescriptor[22]);}else{if(sOperator=="M7"){return(aDescriptor[27]);}else{if(sOperator=="M8"){return(aDescriptor[23]);}else{if(sOperator=="M10"){return(aDescriptor[24]);}else{if(sOperator=="M9"){return(aDescriptor[25]);}else{if(sOperator=="M11"){return(aDescriptor[26]);}else{if(sOperator=="M18"){return(aDescriptor[3]);}else{if(sOperator=="M43"){return(aDescriptor[4]);}else{if(sOperator=="M22"){return(aDescriptor[7]);}else{if(sOperator=="M57"){return(aDescriptor[20]);}else{if(sOperator=="R1"||sOperator=="P1"){return(aDescriptor[5]);}else{if(sOperator=="R2"||sOperator=="P2"){return(aDescriptor[6]);}else{return("=");}}}}}}}}}}}}}}}function GetSelectedItemValue(oList){var sValue;var lLength=oList.options.length;var iSelect=0;for(var i=0;i<lLength;i++){if(oList.options[i].selected){iSelect+=1;if(iSelect>1){return("1");}else{sValue=oList.options[i].value;}}}if(iSelect==0){return("0");}else{return(sValue);}}function GetSelectedItemText(oList){var sValue;var lLength=oList.options.length;var iSelect=0;for(var i=0;i<lLength;i++){if(oList.options[i].selected){iSelect+=1;if(iSelect>1){return("1");}else{sValue=oList.options[i].text;}}}if(iSelect==0){return("0");}else{return(sValue);}}function GetSelectedItemDatatype(oList){var sValue=GetCurrentAttributeValue(oList);if(sValue!=null){sValue=GetUnitType(sValue);}else{return"-1";}return sValue;}function CleanList(oList){var sValue;var lLength=oList.options.length;var iSelect=0;for(var i=lLength-1;i>=0;i--){sValue=oList.options[i].value;if(sValue==""){oList.options[i]=null;}}}function CleanInput(sInput,bTrimSpaces){var sCleanInput;var aInput;if(bTrimSpaces==null){bTrimSpaces=true;}aInput=sInput.split(";");sCleanInput=aInput[0];if(bTrimSpaces){sCleanInput=LTrim(aInput[0]);if(sCleanInput.length==0){sCleanInput=aInput[0];}}for(var lIndex=1;lIndex<aInput.length;lIndex++){if(aInput[lIndex]!=""){var sValue=aInput[lIndex];if(bTrimSpaces){sValue=LTrim(aInput[lIndex]);if(sValue.length==0){sValue=aInput[lIndex];}}sCleanInput=sCleanInput+";"+sValue;}}return(sCleanInput);}function CleanPercentageSign(sInput){var sCleanInput;sCleanInput=sInput;while(sCleanInput.length>0){if(sCleanInput.substring(sCleanInput.length-1,sCleanInput.length)=="%"){sCleanInput=sCleanInput.substring(0,sCleanInput.length-1);}else{break;}}return(sCleanInput);}function DisplayError(sGeneralErrorMssage,sDetailErrorMessage,sPin){var detailedError=getObj("DetailErrorDisplay_"+sPin);var sInnerHTML;if(detailedError!=null){sInnerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'promptError_white.gif" WIDTH="23" HEIGHT="23" BORDER="0" ALIGN=MIDDLE>';sInnerHTML=sInnerHTML+'<SPAN CLASS="prompt-error-description">';sInnerHTML=sInnerHTML+sDetailErrorMessage;sInnerHTML=sInnerHTML+"</SPAN>";writeToDiv(sInnerHTML,detailedError);displayObj(detailedError);}}function ClearError(sPin){1;var detailedError=getObj("DetailErrorDisplay_"+sPin);var sInnerHTML;if(detailedError!=null){sInnerHTML="";writeToDiv(sInnerHTML,detailedError);removeObj(detailedError);}}function selectInOperator(sOperatorList){var iSelectIndex;var oList;oList=window.document.PromptForm[sOperatorList];if(oList){if((oList.selecteIndex==-1)||((oList.selectedIndex>=0)&&(oList[oList.selectedIndex].value!=("22"+ITEM_SEPARATOR+"1"))&&(oList[oList.selectedIndex].value!=("57"+ITEM_SEPARATOR+"1")))){for(iSelectIndex=0;iSelectIndex<oList.length;iSelectIndex++){if(oList[iSelectIndex].value==("22"+ITEM_SEPARATOR+"1")){oList.selectedIndex=iSelectIndex;}}}}}function checkFileExtension(sTextFile){var sFileName;var sFileExtension;var oFile;oFile=window.document.PromptForm[sTextFile];if(oFile){sFileName=oFile.value;if(sFileName.length>0){sFileExtension=","+getFileExtension(sFileName)+",";if(sValidExtensions.indexOf(sFileExtension)==-1){alert(sInvalidFileMessage);return false;}}else{alert(sEmptyFileName);return false;}}return true;}function getFileExtension(sFileName){var sExtension="";var lastIndex=sFileName.lastIndexOf(".");if(lastIndex!=-1&&lastIndex<sFileName.length){sExtension=sFileName.substr(lastIndex+1);}return sExtension;}function SubmitPromptIndex(sExpression){var promptForm=getObj("PromptForm");if(promptForm){var oNewItem=document.createElement("INPUT");if(oNewItem){oNewItem.type="HIDDEN";oNewItem.name=sExpression+".x";promptForm.insertAdjacentElement("beforeEnd",oNewItem);promptForm.submit();}}}function SubmitPromptLink(anchorTag){var promptForm=getObj("PromptForm");if(promptForm){addURLAsHiddenInputsToForm(promptForm,anchorTag.href,true);promptForm.submit();}}function RTrim(str){var whitespace=new String(" \t\n\r");var s=new String(str);if(whitespace.indexOf(s.charAt(s.length-1))!=-1){var i=s.length-1;while(i>=0&&whitespace.indexOf(s.charAt(i))!=-1){i--;}s=s.substring(0,i+1);}return s;}function LTrim(str){var whitespace=new String(" \t\n\r");var s=new String(str);if(whitespace.indexOf(s.charAt(0))!=-1){var j=0,i=s.length;while(j<i&&whitespace.indexOf(s.charAt(j))!=-1){j++;}s=s.substring(j,i);}return s;}function showHideAttSelection(sOutputLevel){var oAttSelection=getObj("attributeSelection");if(sOutputLevel=="3"){if(oAttSelection){displayObj(oAttSelection);if(microstrategy){microstrategy.eventManager.notifyOrphanBones("processShowHideAttSelection",true);}var editor=microstrategy.findAncestorWithAtt(oAttSelection,"ty","editor");if(editor){togglePulldowns(editor,false);}}}else{if(oAttSelection){removeObj(oAttSelection);if(microstrategy){microstrategy.eventManager.notifyOrphanBones("processShowHideAttSelection",false);}var editor=microstrategy.findAncestorWithAtt(oAttSelection,"ty","editor");if(editor){togglePulldowns(editor,true);togglePulldowns(editor,false);}}}}function addAttributeToCartMQEditor(){var oInputAttID=getObj("mqLevelAttID");var oInputAttName=getObj("mqLevelAttName");var bPresentAlready=false;var i;if(oInputAttID&&oInputAttName){var oSelectedList=getObj("dimtyAttributes");if(oSelectedList){if(oInputAttID.value.length>0){for(i=0;i<oSelectedList.options.length;i++){if(oSelectedList.options[i].value.indexOf(oInputAttID.value)>=0){bPresentAlready=true;}}if(!bPresentAlready){if(oSelectedList.options.length==1){if(oSelectedList.options[0].value=="-none-"){oSelectedList.options[0]=null;}}var oOption=new Option(oInputAttName.value,oInputAttID.value+unescape(ITEM_SEPARATOR)+oInputAttName.value,false,false);oSelectedList.options[oSelectedList.length]=oOption;oOption=null;oInputAttName.value="";oInputAttID.value="";}}}}}function removeAttributeFromCartMQEditor(){var oSelectedList=getObj("dimtyAttributes");if(oSelectedList){if(!(oSelectedList.options[0].value=="")){if(oSelectedList.selectedIndex>=0){oSelectedList.options[oSelectedList.selectedIndex]=null;if(oSelectedList.options.length==0){var oOption=new Option("--"+aDescriptor[18]+"--","-none-",false,false);oSelectedList.options[0]=oOption;oSelectedList.options[0].selected=false;oOption=null;}}}}}function ProcessOKforMQEditor(promptPosition,sBeanName){var oSelectedList=getObj("dimtyAttributes");var oRadioButton=getObj("metricQualLevel_MetricQualLevelStyle_form").outputLevel;var oAttListLabel=getObj("outputLevelLabel_"+promptPosition);var oOutputLevelHidden=getObj("outputLevel_"+promptPosition);var i=0;if(oRadioButton){if(oRadioButton[3].checked){if(oSelectedList){if(oOutputLevelHidden){var oAttListHidden=getObj("attList_"+promptPosition);if(oAttListHidden){oAttListHidden.value="";if(oAttListLabel){if(oSelectedList.options[0].value!="-none-"){oAttListLabel.innerHTML=microstrategy.descriptors.getDescriptor("2790").replace(/##/g,"");}}for(i=0;i<oSelectedList.options.length;i++){if(oSelectedList.options[i].value!="-none-"){oOutputLevelHidden.value="3";if(i!=oSelectedList.options.length-1){oAttListHidden.value+=oSelectedList.options[i].value+unescape(UNIT_SEPARATOR);if(oAttListLabel){oAttListLabel.innerHTML+=oSelectedList.options[i].text+", ";}}else{oAttListHidden.value+=oSelectedList.options[i].value;if(oAttListLabel){oAttListLabel.innerHTML+=oSelectedList.options[i].text+": ";}}}}}}}}else{if(oOutputLevelHidden){if(oRadioButton[0].checked){oOutputLevelHidden.value="0";if(oAttListLabel){oAttListLabel.innerHTML=microstrategy.descriptors.getDescriptor("4389");}}if(oRadioButton[1].checked){oOutputLevelHidden.value="1";if(oAttListLabel){oAttListLabel.innerHTML=microstrategy.descriptors.getDescriptor("4388");}}if(oRadioButton[2].checked){oOutputLevelHidden.value="2";if(oAttListLabel){oAttListLabel.innerHTML=microstrategy.descriptors.getDescriptor("3275");}}}}}}function ProcessApplyElementPickerEditor(promptPosition,sBeanName){var sTextBoxName;if(promptPosition=="0"){sTextBoxName="unitsToAdd";}else{sTextBoxName="unitsToAdd_"+promptPosition;}var oTextBox=getObj(sTextBoxName);var oSelectedText=getObj("selectedText");if(oSelectedText){oTextBox.value=oSelectedText.value;}else{oFromList=getObj("AvailableItems");oTextBox.value=oFromList.options[oFromList.selectedIndex].value;}}function AddOutputLevelToOperator(sCurrentOperator,sPin){var oOutputLevelHidden=getObj("outputLevel_"+sPin);var oAttListLabel=getObj("outputLevelLabel_"+sPin);if(oOutputLevelHidden){var sValue=oOutputLevelHidden.value;sCurrentOperator+=unescape(UNIT_SEPARATOR)+sValue;switch(sValue){case"3":var oAttListHidden=getObj("attList_"+sPin);if(oAttListHidden){sCurrentOperator+=unescape(UNIT_SEPARATOR)+oAttListHidden.value;oAttListHidden.value="";}break;}oOutputLevelHidden.value="";}if(oAttListLabel){oAttListLabel.innerHTML=microstrategy.descriptors.getDescriptor("3274");}return sCurrentOperator;}function AddMQOutputLevelText(sValue,sPin){var oOutputLevelHidden=getObj("outputLevel_"+sPin);var sAttNames="";var oAttNameKeys;var lNumberAtts=0;if(oOutputLevelHidden){var sOutputLevelValue=oOutputLevelHidden.value;if(sOutputLevelValue=="3"){var oAttListHidden=getObj("attList_"+sPin);var sAttList=oAttListHidden.value;if(sAttList.length>32){var oAttKeys=sAttList.split(UNIT_SEPARATOR);lNumberAtts=oAttKeys.length;for(i=0;i<lNumberAtts;i++){oAttNameKeys=oAttKeys[i].split(ITEM_SEPARATOR);if(i==0){sAttNames+=oAttNameKeys[2];}else{sAttNames+=", "+oAttNameKeys[2];}}}if(lNumberAtts>1){sAttNames="( "+sAttNames+" )";}sValue=aDescriptor[28].replace(/##/g,sAttNames)+" "+aDescriptor[29].replace(/##/g,sValue);}}return(sValue);}function openMQLevelEditor(sBeanPath,sPin){var oOutputLevelHidden=getObj("outputLevel_"+sPin);var sOnClick="";var sURL="";sURL="isTreeRequest=true&promptPosition="+sPin;if(oOutputLevelHidden){var sOutputLevelValue=oOutputLevelHidden.value;if(sOutputLevelValue.length>0){if(sOutputLevelValue=="3"){var oAttListHidden=getObj("attList_"+sPin);if(oAttListHidden){var sAttList=oAttListHidden.value;sURL+="&outputLevel=3&dimtyAttributes="+sAttList;}}else{sURL+="&outputLevel="+sOutputLevelValue;}}else{sURL+="&outputLevel=0";}}toggleShowBean("metricQualLevel",true,sURL,true);}function openElementPicker(sBeanPath,sPin,sOperatorPulldown,sAvailableList,sTextBoxName){var sURL="";sURL="isTreeRequest=true&promptPosition="+sPin;var oOperatorPulldown=getObj(sOperatorPulldown);if(oOperatorPulldown&&oOperatorPulldown[oOperatorPulldown.selectedIndex]){sURL+="&operator="+oOperatorPulldown[oOperatorPulldown.selectedIndex].value;}var oAvailableList=getObj(sAvailableList);if(oAvailableList&&oAvailableList[oAvailableList.selectedIndex]){sURL+="&attributeId="+oAvailableList[oAvailableList.selectedIndex].value;}var oTextBox=getObj(sTextBoxName);if(oTextBox){sURL+="&selectedText="+oTextBox.value;}toggleShowBean("elementPicker",true,sURL,true);}function submitMQForm(oAnchor){var newOutputLevel=document.createElement("input");newOutputLevel.setAttribute("name","outputLevel");newOutputLevel.setAttribute("type","hidden");var newDimtyAttributes=document.createElement("input");newDimtyAttributes.setAttribute("name","dimtyAttributes");newDimtyAttributes.setAttribute("type","hidden");var sAttList="";var oForm=createDynamicForm(oAnchor.href+"&isTreeRequest=true");if(oForm){oForm.target="frameManager";var oOutputLevel=document.getElementsByName("outputLevel");if(oOutputLevel[3].checked){newOutputLevel.setAttribute("value",oOutputLevel[3].value);oForm.insertAdjacentElement("beforeEnd",newOutputLevel);var oDimtyAttributes=getObj("dimtyAttributes");if(oDimtyAttributes){for(i=0;i<oDimtyAttributes.options.length;i++){if(oDimtyAttributes.options[i].value!="-none-"){if(i!=oDimtyAttributes.options.length-1){sAttList+=oDimtyAttributes.options[i].value+unescape(UNIT_SEPARATOR);}else{sAttList+=oDimtyAttributes.options[i].value;}}}newDimtyAttributes.setAttribute("value",sAttList);oForm.insertAdjacentElement("beforeEnd",newDimtyAttributes);}}if(oOutputLevel[2].checked){newOutputLevel.setAttribute("value",oOutputLevel[2].value);oForm.insertAdjacentElement("beforeEnd",newOutputLevel);}if(oOutputLevel[1].checked){newOutputLevel.setAttribute("value",oOutputLevel[1].value);oForm.insertAdjacentElement("beforeEnd",newOutputLevel);}if(oOutputLevel[0].checked){newOutputLevel.setAttribute("value",oOutputLevel[0].value);oForm.insertAdjacentElement("beforeEnd",newOutputLevel);}submitForm(oForm,true);}return false;}function makeSelections(){var oDimtyAttributes=getObj("dimtyAttributes");var sValue="";if(oDimtyAttributes){for(i=0;i<oDimtyAttributes.options.length;i++){if(oDimtyAttributes.options[i].value!="-none-"){if(i!=oDimtyAttributes.options.length-1){sValue+=oDimtyAttributes.options[i].value+unescape(UNIT_SEPARATOR);}else{sValue+=oDimtyAttributes.options[i].value;}}}var oOption=new Option("",sValue,false,true);oDimtyAttributes.options[oDimtyAttributes.length]=oOption;}}function goUpFolderLevel(oSelect){makeSelections();processSelect(oSelect);}function resizePromptContent(){if(typeof (microstrategy)=="undefined"){return ;}if(typeof (microstrategy.cancelPromptResize)!="undefined"){if(microstrategy.cancelPromptResize){return ;}}fitPromptContentToWindow(false);if(bIsFirefox){if(this.timer){window.clearTimeout(this.timer);}this.timer=window.setTimeout("fitPromptContentToWindow(true)",200);}return ;}function fitPromptContentToWindow(bAfterResize){var oDivPromptItem=getObj("mstrPromptsIndex");var oDivPromptBody=getObj("mstrPromptsBody");var oDivPromptButtonBar=getObj("mstrPromptsButtonBarBottom");if(oDivPromptBody){var h=getAvailablePromptHeight(oDivPromptBody);if(h&&(!isNaN(h))){applyPromptHeight(oDivPromptBody,oDivPromptItem,oDivPromptButtonBar,h);}}return ;}function applyPromptHeight(divPromptBody,divPromptIndex,divPromptButtonBar,h){var MINIMUM_PROMPT_HEIGHT=SCROLLBAR_SIZE*3;if(h<MINIMUM_PROMPT_HEIGHT){h=MINIMUM_PROMPT_HEIGHT;}var MARGIN_PROMPTINDEX=5;if(bIsIE4){divPromptButtonBar&&(divPromptButtonBar.style.visibility="hidden");}var heightPromptRename=0;if(divPromptIndex){var oDivPromptRename=getObj("mstrPromptsRename");if(oDivPromptRename){heightPromptRename=getObjOuterHeight(oDivPromptRename);}divPromptIndex.style.height=(h-MARGIN_PROMPTINDEX*2)+"px";}if(divPromptBody){divPromptBody.style.height=(h-heightPromptRename-MARGIN_PROMPTINDEX*2)+"px";}var heightPromptsContent=getObjOuterHeight(divPromptBody.parentNode);adjustEnclosingTableHeight(heightPromptsContent);if(bIsIE4){divPromptButtonBar.style.visibility="visible";}}function adjustEnclosingTableHeight(height){var contentTable=getElementById("mstrWebContentTable");if(contentTable){contentTable.style.height=height+"px";}}function getAvailablePromptHeight(divPromptBody){try{if(!divPromptBody){return NaN;}var heightBrowser=mstr.utils.BoxModel.getBrowserWindowHeight(document);var heightPromptBody=getObjOuterHeight(divPromptBody);var heightPromptsContent=getObjOuterHeight(divPromptBody.parentNode);var topPromptBody=getObjSumTop(divPromptBody);var PROMPTMARGIN_BOTTOM=(bIsFirefox)?8:5;var heightAvailable=heightBrowser-topPromptBody-(heightPromptsContent-heightPromptBody)-PROMPTMARGIN_BOTTOM;return heightAvailable;}catch(err){return null;}}function ToggleDrillButton(sAttrElementsList,sDrillButton){try{var oAttrElementsList=getObj(sAttrElementsList);var oDrillButton=getObj(sDrillButton);if((oAttrElementsList!=null)&&(oDrillButton!=null)){if((oAttrElementsList.options.length==0)||((oAttrElementsList.options.length==1)&&(oAttrElementsList.options[0].value=="-none-"))){oDrillButton.disabled=true;}else{oDrillButton.disabled=false;}}}catch(err){return false;}return true;}function setTreeSearch(oTarget,position){if(oTarget==null){return ;}var searchName=searchPrefix;if(searchName==""){return ;}if(position>0){searchName=searchName+"_"+position;}var oTextBox=getObj(searchName);if(oTextBox){if(oTarget.getAttribute("tp")=="12"&&oTarget.getAttribute("searchLocked")!="1"){oTextBox.disabled=false;oTextBox.style.background="#ffffff";}else{oTextBox.disabled=true;oTextBox.style.background="#cccccc";}}}function clearTreeSearch(position,oATag){var oTree=getObj(util_getTreeName(position));var mainNode=util_getChildNodeById(oTree,"main");mainNode.style.display="block";var searchNode=util_getChildNodeById(oTree,"search");var attributeId=searchNode.getAttribute("attId");var dimensionId=searchNode.getAttribute("dimId");oTree.removeChild(searchNode);var clearSearch=getObj("clearSearch_"+position);clearSearch.style.display="none";var searchName=searchPrefix;if(position>0){searchName=searchName+"_"+position;}var oTextBox=getObj(searchName);if(oTextBox){oTextBox.value="";}if(oATag){var attributeName=attributeIdPrefix;if(position>0){attributeName=attributeName+"_"+position;}var dimensionName=dimensionIdPrefix;if(position>0){dimensionName=dimensionName+"_"+position;}oATag.href=replaceURLParameter(oATag.href,attributeName,attributeId);oATag.href=replaceURLParameter(oATag.href,dimensionName,dimensionId);util_submitForm(oATag);}return false;}function doTreeSearch(position,oATag){if(iframe.isTreeProcessing){event.returnValue=false;return ;}var oTree=getObj(util_getTreeName(position));var oLI=oTree.getElementsByTagName("LI");var selectedNode=null;if((oLI)&&(oLI.length)){var iLI=oLI.length;for(var i=0;i<iLI;i++){if(oLI[i].getAttribute("sel")=="1"){selectedNode=oLI[i];break;}}if(selectedNode&&selectedNode.getAttribute("tp")=="12"&&selectedNode.getAttribute("searchLocked")!="1"){var searchName=searchPrefix;if(position>0){searchName=searchName+"_"+position;}var oTextBox=getObj(searchName);if(oTextBox&&oTextBox.value.length>0){hideTreeWaitMessage();var searchNode=util_getChildNodeById(oTree,"search");if(searchNode){oTree.removeChild(searchNode);}var oTarget=util_findTargetTag(selectedNode,"DIV");var cloneNode=oTarget.cloneNode(true);util_setTreeTargetState(cloneNode,NODE_STATE_OPEN);var searchTree=util_createNode("UL","search");searchTree.style.display="block";searchTree.appendChild(cloneNode);searchTree.setAttribute("attId",selectedNode.getAttribute("val"));searchTree.setAttribute("dimId",selectedNode.getAttribute("dimensionId"));var mainNode=util_getChildNodeById(oTree,"main");mainNode.style.display="none";mainNode.insertAdjacentElement("afterEnd",searchTree);var clearSearch=getObj("clearSearch_"+position);clearSearch.style.display="block";showTreeWaitMessage(cloneNode,"afterEnd");var browsePath=getBrowsePath(oTree,oTarget);util_submitSearchForm(position,oATag,selectedNode.getAttribute("val"),selectedNode.getAttribute("dimensionId"),oTextBox.value,browsePath);}}}}function appendBrowsePathForIncrementalFetch(oIncFetchNode,position){var oTree=getObj(util_getTreeName(position));var browsePathName=browsePathPrefix;if(position>0){browsePathName=browsePathName+"_"+position;}var oTarget=findAttributeForIncrementalFetch(oIncFetchNode);if(oTarget){var oAnchor=util_getAnchor(oIncFetchNode);var browsePathValue=getBrowsePath(oTree,oTarget);if(browsePathValue&&browsePathValue.length>0){oAnchor.href+="&"+browsePathName+"="+encodeURIComponent(browsePathValue);}}return true;}function appendBrowsePath(oCurrentNode,position){var oTree=getObj(util_getTreeName(position));if(util_shouldSubmitForm(oCurrentNode,oTree)){var browsePathName=browsePathPrefix;if(position>0){browsePathName=browsePathName+"_"+position;}var oTarget=findAttributeForDrill(oCurrentNode);if(oTarget){var browsePathValue=getBrowsePath(oTree,oTarget);if(browsePathValue&&browsePathValue.length>0){var oAnchor=util_getAnchor(oCurrentNode);oAnchor.href+="&"+browsePathName+"="+encodeURIComponent(browsePathValue);}}}return true;}function findAttributeForIncrementalFetch(oIncFetch){var result=null;var oParentList=util_findTargetTag(oIncFetch,"UL");if(oParentList){if(oParentList.parentNode.tagName=="div"||oParentList.parentNode.tagName=="DIV"){var oDivTreeWait=oParentList.parentNode;if(oDivTreeWait){result=oDivTreeWait.previousSibling;}}else{if(oParentList.parentNode.tagName=="UL"){result=oParentList.previousSibling;}}}return result;}function findAttributeForDrill(oIncFetch){var oParentList=util_findTargetTag(oIncFetch,"DIV");return oParentList;}function getBrowsePath(oTree,oTarget){var oUL=oTarget.parentNode;var browsePath="";while(oUL&&oUL.id!="main"&&oUL.id!="search"){var oDiv=oUL.previousSibling;var value=getChildNodeValue(oDiv);browsePath=unescape(UNIT_SEPARATOR)+value+browsePath;oDiv=oDiv.parentNode.previousSibling;value=getChildNodeValue(oDiv);browsePath=unescape(EXPRESSION_SEPARATOR)+value+browsePath;oUL=oDiv.parentNode;}return browsePath.substr(1);}function getChildNodeValue(oTarget){var value="";if(oTarget&&oTarget.childNodes.length){value=oTarget.childNodes[0].getAttribute("val");}return value;}function util_submitSearchForm(position,oTarget,attributeValue,dimensionValue,searchString,browsePathValue){var oSearchForm=util_getNewTreeForm(oTarget.href);if(oSearchForm&&oSearchForm.childNodes.length>0){var searchName=searchPrefix;if(position>0){searchName=searchName+"_"+position;}var attributeName=attributeIdPrefix;if(position>0){attributeName=attributeName+"_"+position;}var dimensionName=dimensionIdPrefix;if(position>0){dimensionName=dimensionName+"_"+position;}var browsePathName=browsePathPrefix;if(position>0){browsePathName=browsePathName+"_"+position;}var matchCaseName=matchCasePrefix;if(position>0){matchCaseName=matchCaseName+"_"+position;}var removeCheckBox=false;var checkBoxHiddenInput=null;for(var i=0;i<oSearchForm.childNodes.length;i++){var oChildNode=oSearchForm.childNodes[i];if(oChildNode.name==searchName){oChildNode.value=searchString;}if(oChildNode.name==attributeName){oChildNode.value=attributeValue;}if(oChildNode.name==dimensionName){oChildNode.value=dimensionValue;}if(oChildNode.name==browsePathName){oChildNode.value=browsePathValue;}if(oChildNode.name==matchCaseName){checkBoxHiddenInput=oChildNode;checkBoxNode=getObj(matchCaseName);if(checkBoxNode&&checkBoxNode.checked==true){oChildNode.value="1";}else{removeCheckBox=true;}}}if(removeCheckBox==true){oSearchForm.removeChild(checkBoxHiddenInput);}submitForm(oSearchForm,true);}}function util_getChildNodeById(oTarget,id){if((oTarget)&&(oTarget.childNodes.length)){for(var i=0;i<oTarget.childNodes.length;i++){var oChildNode=oTarget.childNodes[i];if(oChildNode.id==id){return oChildNode;}}}return null;}function util_createNode(tagName,id){var oNode=document.createElement(tagName);oNode.id=id;return oNode;}function changeHierarchyForTree(selectBox,position){var oTree=getObj(util_getTreeName(position));if(oTree){hideTreeWaitMessage();var mainNode=util_getChildNodeById(oTree,"main");if(mainNode){oTree.removeChild(mainNode);}var searchNode=util_getChildNodeById(oTree,"search");if(searchNode){oTree.removeChild(searchNode);var clearSearch=getObj("clearSearch_"+position);clearSearch.style.display="none";var searchName=searchPrefix;if(position>0){searchName=searchName+"_"+position;}var oTextBox=getObj(searchName);if(oTextBox){oTextBox.value="";}}showTreeWaitMessage(oTree,"beforeEnd");submitChangeTreeHierarchyForm(selectBox.options[selectBox.selectedIndex].value,position,selectBox.getAttribute("eventURL"));}}function submitChangeTreeHierarchyForm(hierarchyValue,position,eventURL){var oForm=util_getNewTreeForm(eventURL);if(oForm&&oForm.childNodes.length>0){var hierarchyName=hierarchyPrefix;if(position>0){hierarchyName=hierarchyName+"_"+position;}for(var i=0;i<oForm.childNodes.length;i++){var oChildNode=oForm.childNodes[i];if(oChildNode.name==hierarchyName){oChildNode.value=hierarchyValue;}}submitForm(oForm,true);}}function util_getTreeName(position){var sTreeNamePrefix=TREE_NAME_PREFIX;if(position>0){sTreeNamePrefix+="_"+position;}return sTreeNamePrefix;}function promptSubmitSearchForEnterKey(oDiv,evt){var e=evt||window.event;if(e!=null&&e.keyCode==13){var oImage=microstrategy.findChildWithAtt(oDiv,"INPUT","type","image");if(oImage){oImage.click();}return false;}return true;}function isSameAttributeValue(attributeValue1,attributeValue2){var valueList1=attributeValue1.split(ITEM_SEPARATOR);var valueList2=attributeValue2.split(ITEM_SEPARATOR);return(valueList1[0]==valueList2[0]&&valueList1[2]==valueList2[2]);}function is24HourFormat(){var now=new Date();now.setTime(Date.parse("January, 01 2006 13:00:00"));var str=now.toLocaleString();return(str.indexOf("13")>=0);}function adjustTimeFormat(time12Hr,time24Hr){if(is24HourFormat()){var time24HrObj=getObj(time24Hr);if(time24HrObj!=null){time24HrObj.style.display="";}}else{var time12HrObj=getObj(time12Hr);if(time12HrObj!=null){time12HrObj.style.display="";}}}function MoveItemInListUp(sList){MoveItemInList(sList,-1);}function MoveItemInListDown(sList){MoveItemInList(sList,1);}function MoveItemInList(sList,offset){var oList=getObj(sList);var aPreSelected=new Array();if(oList){for(var i=0;i<oList.options.length;i++){if(oList.options[i].selected){if(i+offset>=0&&oList.options[i+offset]){aPreSelected[aPreSelected.length]=oList.options[i].text;var oTempOptionText=oList.options[i].text;var oTempOptionValue=oList.options[i].value;oList.options[i].text=oList.options[i+offset].text;oList.options[i].value=oList.options[i+offset].value;oList.options[i].selected=false;oList.options[i+offset].text=oTempOptionText;oList.options[i+offset].value=oTempOptionValue;}}}for(i=0;i<oList.options.length;i++){for(j=0;j<aPreSelected.length;j++){if(aPreSelected[j]==oList.options[i].text){oList.options[i].selected=true;}}}}}
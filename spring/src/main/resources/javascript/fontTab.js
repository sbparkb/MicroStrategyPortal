mstrFontTabImplScript=true;mstrFontTabImpl.prototype=new mstrTabImpl();mstrFontTabImpl.prototype.changeGridProperties=false;mstrFontTabImpl.prototype.initializing=false;mstrFontTabImpl.prototype.onload=function(){try{this.initializing=true;this.initEditor();this.initSettings();this.sample=microstrategy.subObjectFind(this.body,["DIV","SPAN"],microstrategy.SUBOBJTYPE_TAB_SAMPLE);this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);var at=this.getAppliesTo();this.initializing=true;this.changeGridProperties=(at&&at.commands.queryEnabled("onegrid"));this.initValues();this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.initSettings=function(){try{this.settings=new Array();this.settings[this.settings.length]=document.getElementById(this.id+"Name");this.settings[this.settings.length]=document.getElementById(this.id+"Size");this.settings[this.settings.length]=document.getElementById(this.id+"BoldItalic");this.settings[this.settings.length]=document.getElementById(this.id+"Underline");this.settings[this.settings.length]=document.getElementById(this.id+"Strikeout");this.settings[this.settings.length]=document.getElementById(this.id+"Color");}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.initValues=function(){try{var at=this.getAppliesTo();this.initializing=true;if(this.tabManager.targetAxis==0&&this.tabManager.targetLevel==1&&microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){microstrategy.formatType=mstrPanelStack.FMT_TYPE_TITLE;}if(this.tabManager.targetAxis==0&&this.tabManager.targetLevel==9&&microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){microstrategy.formatType=mstrGridReport.FMT_TYPE_TITLE;}this.changeGridProperties=(this.changeGridProperties&&!this.tabManager.isGridContainerSelected());if(this.changeGridProperties==false){this.initComboValue(at,"font",this.id+"Name","true","fontFamily");this.initComboValue(at,"fsize",this.id+"Size","true","fontSize");this.initComboValue(at,"fstyle",this.id+"BoldItalic","true","fontStyle");this.initColorPickerValue(at,"color",this.id+"Color","color");this.initCheckValue(at,"fstyle",this.id+"Underline","true","textDecoration");this.initCheckValue(at,"fstyle",this.id+"Strikeout","true","textDecoration2");}else{if(document.getElementById(this.id+"Color")){var colorPicker=document.getElementById(this.id+"Color");if(colorPicker.getAttribute(microstrategy.HTMLATTR_COLOR)){this.updateColorPicker(colorPicker,colorPicker.getAttribute(microstrategy.HTMLATTR_COLOR));}}if(document.getElementById(this.id+"Name")){document.getElementById(this.id+"Name").onchange();}if(document.getElementById(this.id+"Size")){document.getElementById(this.id+"Size").onchange();}if(document.getElementById(this.id+"BoldItalic")){document.getElementById(this.id+"BoldItalic").onchange();}if(document.getElementById(this.id+"Underline")){this.toggleCheck(document.getElementById(this.id+"Underline"));}if(document.getElementById(this.id+"Strikeout")){this.toggleCheck(document.getElementById(this.id+"Strikeout"));}}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.execPicker=function(picker,obj){try{var cmdId=picker.commandId;var newValue=obj.getAttribute("id").slice(3);if(newValue=="More"){var dropDown=document.getElementById(this.id+cmdId);var color=(dropDown&&dropDown.getElementsByTagName("span").length>0)?dropDown.getElementsByTagName("span")[0].style.backgroundColor:"";this.openAdvancedColorPicker(this.getAppliesTo(),cmdId,color);}else{var dropDown=document.getElementById(this.id+cmdId);if(dropDown){this.updateColorPicker(dropDown,newValue);}}return true;}catch(err){microstrategy.errors.log(err);}return false;};mstrFontTabImpl.prototype.toggleCheck=function(oCheck,useDefault){mstrTabImpl.prototype.toggleCheck.apply(this,arguments);if(this.sample){var td="";if(document.getElementById(this.id+"Underline").getAttribute("cv")==-1){td+="underline";}if(document.getElementById(this.id+"Strikeout").getAttribute("cv")==-1){td+=" line-through";}this.sample.style.textDecoration=td;}};mstrFontTabImpl.prototype.updateCheck=function(obj){try{if(obj&&this.sample){var newFormat="";var newCommandValue=0;var cmdId=obj.getAttribute(microstrategy.HTMLATTR_CMD_ID);switch(cmdId){case"Underline":if(this.sample.style.textDecoration.indexOf("line-through")>=0){newFormat="line-through ";}if(obj.checked){newFormat=newFormat+"underline";newCommandValue=4;}else{newCommandValue=-4;}this.sample.style.textDecoration=newFormat;break;case"Strikeout":if(this.sample.style.textDecoration.indexOf("underline")>=0){newFormat="underline ";}if(obj.checked){newFormat=newFormat+"line-through";newCommandValue=8;}else{newCommandValue=-8;}this.sample.style.textDecoration=newFormat;break;}if(!this.initializing){obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newCommandValue);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.reselectCheckBox=function(field,value){try{if(value=="4"||value=="8"){field.checked=true;}if(value=="-4"||value=="-8"){field.checked=false;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.matchesListValue=function(option,value,cmdId){try{switch(cmdId){case"Size":value=parseFloat(value);default:return(option==value);}}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.updateList=function(obj){try{if(obj&&this.sample){var newFormat="";var cmdId=obj.getAttribute(microstrategy.HTMLATTR_CMD_ID);var cmdValue=obj.value;switch(cmdId){case"BoldItalic":this.sample.style.fontWeight="normal";this.sample.style.fontStyle="normal";switch(parseInt(cmdValue)){case 3:this.sample.style.fontStyle="italic";case 1:this.sample.style.fontWeight="bold";break;case 2:this.sample.style.fontStyle="italic";break;}break;case"Size":if(cmdValue!="-2"){if(obj.value){cmdValue=obj.value+"pt";this.sample.style.fontSize=cmdValue;}}break;case"Name":if(cmdValue!="-2"){this.sample.style.fontFamily=cmdValue;}break;}this.centerSampleVertically(this.sample.parentNode);if(!this.initializing){var listScrollTop=obj.scrollTop;obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,cmdValue);if(!bIsIE4&&bIsW3C&&(listScrollTop!=null)){obj.scrollTop=listScrollTop;}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.centerSampleVertically=function(obj){try{if(obj&&obj.scrollHeight&&(!isNaN(obj.scrollTop))&&obj.offsetHeight){var lTop=parseInt((obj.scrollHeight-obj.offsetHeight)/2);if((!isNaN(lTop))&&(lTop>0)){obj.scrollTop=lTop;}else{obj.scrollTop=0;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.updateColorPicker=function(obj,value){try{mstrTabImpl.prototype.updateColorPicker.call(this,obj,value,this.initializing);if(value!="More"&&this.sample&&value!="-2"){this.sample.style.color=value;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.checkForFormatChanges=function(){try{var __result=false;var counter;for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(settingValue!=null){return true;}}return __result;}catch(err){microstrategy.errors.log(err);return false;}};mstrFontTabImpl.prototype.applyPropertyChanges=function(propertiesArray){};mstrFontTabImpl.prototype.applyFormatChanges=function(at,bulkChanges){try{var strikeoutUnderlineValue=0;var counter;var auxUnderlineStrikeout="";var auxBoldItalic=0;var formatBulkArray=bulkChanges;this.changeGridProperties=(this.changeGridProperties&&!this.tabManager.isGridContainerSelected());for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);var iSettingValue=parseInt(settingValue);if(settingValue!=null){settingValue=this.checkRGBColors(settingName,settingValue);if(this.changeGridProperties){switch(settingName){case"BoldItalic":if(iSettingValue=="0"){formatBulkArray.push("Bold|0");formatBulkArray.push("Italic|0");}if(iSettingValue=="1"){formatBulkArray.push("Bold|-1");formatBulkArray.push("Italic|0");}if(iSettingValue=="2"){formatBulkArray.push("Bold|0");formatBulkArray.push("Italic|-1");}if(iSettingValue=="3"){formatBulkArray.push("Bold|-1");formatBulkArray.push("Italic|-1");}break;default:formatBulkArray.push(settingName+"|"+settingValue);}}else{switch(settingName){case"BoldItalic":if(iSettingValue&1){formatBulkArray.push("fstyle|1");}else{formatBulkArray.push("fstyle|-1");}if(iSettingValue&2){formatBulkArray.push("fstyle|2");}else{formatBulkArray.push("fstyle|-2");}break;case"Underline":if(auxUnderlineStrikeout.length>0){auxUnderlineStrikeout=","+auxUnderlineStrikeout;}if(iSettingValue>0){auxUnderlineStrikeout="4"+auxUnderlineStrikeout;}else{auxUnderlineStrikeout="-4"+auxUnderlineStrikeout;}break;case"Strikeout":if(auxUnderlineStrikeout.length>0){auxUnderlineStrikeout=auxUnderlineStrikeout+",";}if(iSettingValue>0){auxUnderlineStrikeout=auxUnderlineStrikeout+"8";}else{auxUnderlineStrikeout=auxUnderlineStrikeout+"-8";}break;default:formatBulkArray.push(settingName+"|"+settingValue);}}if(!this.enforceSubmit){aSetting.removeAttribute(microstrategy.HTMLATTR_CMD_VALUE);}}}if(auxUnderlineStrikeout.length>0){formatBulkArray.push("fstyle|"+auxUnderlineStrikeout);}return formatBulkArray;}catch(err){microstrategy.errors.log(err);return bulkChanges;}};function mstrFontTabImpl(id){this.inherits=mstrTabImpl;this.inherits(id);delete this.inherits;return this;}
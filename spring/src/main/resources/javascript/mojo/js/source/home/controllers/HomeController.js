(function(){mstrmojo.requiresCls("mstrmojo.TextBoxWithLabel","mstrmojo.ui.menus.EditorConfig","mstrmojo.home.EnumHomeCards","mstrmojo.home.HomeModel","mstrmojo.home.ui.Card","mstrmojo.home.ui.FolderPicker","mstrmojo.home.views.HomeView","mstrmojo.home.controllers._CardActions");mstrmojo.requiresDescs();var ARR=mstrmojo.array;var CARDS=mstrmojo.home.EnumHomeCards,CARD_TYPES=CARDS.types,CARD_ITEMS=CARDS.items;var SAVE_WAIT_BOX_CONFIG={config:{waitBoxCfg:{message:mstrmojo.desc(10492,"Saving...")}}};mstrmojo.home.controllers.HomeController=mstrmojo.declare(mstrmojo.Obj,[mstrmojo.home.controllers._CardActions],{scriptClass:"mstrmojo.home.controllers.HomeController",model:null,view:null,start:function start(startParams){var model=new mstrmojo.home.HomeModel({modelData:startParams.modelData});model.controller=this;this.set("model",model);var view=this.view=new mstrmojo.home.views.HomeView({id:"homeView",controller:this,model:model,placeholder:startParams.placeholder});view.render();this.addDisposable([model,view]);},getDashboardSettingEditorConfig:function(data,fnOK){var checkValid=function(){return !mstrmojo.string.isEmpty(this.splashURL.value);};return new mstrmojo.ui.menus.EditorConfig({cssClass:"mstrmojo-CardMenuEditor-dashboard",data:data||{},contents:[{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"splashURL",label:mstrmojo.desc(4226,"Image Source:"),cssDisplay:"block",value:data.splashURL,onvalueChange:function(){if(this.parent.data){this.parent.data.set("splashURL",this.value);this.parent.data.set("valid",checkValid.call(this.parent));}}},{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"objectURL",label:mstrmojo.desc(8996,"Link to:"),cssDisplay:"block",value:data.objectURL,onvalueChange:function(){if(this.parent.data){this.parent.data.set("objectURL",this.value);}}}],bindings:{okEnabled:"this.valid",valid:function(){return this.data.valid;}},fnOk:fnOK});},getDashboardSettingTitleConfig:function getDashboardSettingTitleConfig(data,fnOK){var me=this;return new mstrmojo.ui.menus.EditorConfig({cssClass:"mstrmojo-CardMenuEditor-dashboard",data:data||{title:me.title},contents:[{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"lblTitle",label:mstrmojo.desc(3297,"Title:"),value:data.title,onvalueChange:function(){if(this.parent.data){this.parent.data.set("title",this.value);}}}],fnOk:fnOK});},getAddMenuCfg:function getAddMenuCfg(){var controller=this,view=this.view,menuCfg=new mstrmojo.ui.menus.MenuConfig();ARR.forEach(CARD_ITEMS,function(item){if(item.t===CARD_TYPES.HTML&&!mstrApp.features["create-html-container"]){return ;}switch(item.t){case CARD_TYPES.IMAGE:menuCfg.addPopupMenuItem(item.n,view.id,function(){return controller.getDashboardSettingEditorConfig({},function(data,editor){view.addCard({t:item.t,objectURL:data.objectURL,splashURL:data.splashURL});});});break;case CARD_TYPES.BROWSE:menuCfg.addPopupMenuItem(item.n,view.id,function(){var subMenuCfg=new mstrmojo.ui.menus.MenuConfig();ARR.forEach(item.items,function(subItem){switch(subItem.t){case CARD_TYPES.FOLDER:subMenuCfg.addMenuItem(subItem.n,"",function openOB(){(new mstrmojo.home.ui.FolderPicker({onOK:function(folder){view.addCard({t:subItem.t,n:folder.n,did:folder.did});}})).open();});break;default:subMenuCfg.addMenuItem(subItem.n,"",function(){view.addCard({t:subItem.t});});}});return subMenuCfg;});break;default:menuCfg.addMenuItem(item.n,"",function(){view.addCard({t:item.t});});}});return menuCfg;}});}());
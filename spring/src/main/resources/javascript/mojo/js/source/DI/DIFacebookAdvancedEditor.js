(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.date");mstrmojo.requiresDescs(1823,9374,9375,12680,12681,12682,12683,12684,12685,12686,12688);var $D=mstrmojo.date,$L=mstrmojo.locales,fbDateFormat="M/d/yyyy";mstrmojo.DI.DIFacebookAdvancedEditor=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DI.DIFacebookAdvancedEditor",cssClass:"mstrmojo-DI-facebook-advancedOptionsContent",advancedProperties:{},markupString:'<div id="{@id}" class="{@cssClass}" ></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{contentNode:function(){return this.domNode;}},postBuildRendering:function postBuildRendering(){var dateObj,localizedStr;if(this._super){this._super();}if(this.advancedProperties.hasOwnProperty("r")){this.rangeDropdown.dates.set("select",this.advancedProperties.r);}if(this.advancedProperties.hasOwnProperty("i")){this.rangeDropdown.dates.set("idx",this.advancedProperties.i);}if(this.advancedProperties.hasOwnProperty("n")){this.rangeDropdown.rangeBox.nValue.set("value",this.advancedProperties.n);}if(this.advancedProperties.hasOwnProperty("fD")){dateObj=$D.parseDate(this.advancedProperties.fD,false,fbDateFormat);if(!dateObj){dateObj=$D.parseDate(this.advancedProperties.fD);}localizedStr=dateObj?$D.formatDateInfo(dateObj,$L.datetime.DATEOUTPUTFORMAT):this.advancedProperties.fD;this.fromBox.fromDate.set("value",localizedStr);}else{this.fromBox.fromDate.set("value",$L.datetime.DATEOUTPUTFORMAT||"MM/DD/YYYY");}if(this.advancedProperties.hasOwnProperty("tD")){dateObj=$D.parseDate(this.advancedProperties.tD,false,fbDateFormat);if(!dateObj){dateObj=$D.parseDate(this.advancedProperties.fD);}localizedStr=dateObj?$D.formatDateInfo(dateObj,$L.datetime.DATEOUTPUTFORMAT):this.advancedProperties.tD;this.toBox.toDate.set("value",localizedStr);}else{this.toBox.toDate.set("value",$L.datetime.DATEOUTPUTFORMAT||"MM/DD/YYYY");}},children:[{slot:"contentNode",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-di-ga-dateLabel",text:mstrmojo.desc(12681,"Optional Time Parameters")},{scriptClass:"mstrmojo.HBox",slot:"contentNode",cssClass:"mstrmojo-DI-facebook-advancedOptions",alias:"rangeDropdown",children:[{scriptClass:"mstrmojo.DropDownList",title:"",alias:"dates",cssText:"height:23px; width:130px; margin-top: 5px;",select:true,idx:2,options:[{n:mstrmojo.desc(12682,"Last N Minutes"),v:0,range:"minutes"},{n:mstrmojo.desc(12683,"Last N Hours"),v:1,range:"hours"},{n:mstrmojo.desc(12684,"Last N Days"),v:2,range:"days"},{n:mstrmojo.desc(12685,"Last N Weeks"),v:3,range:"weeks"},{n:mstrmojo.desc(12686,"Last N Months"),v:4,range:"months"},{n:mstrmojo.desc(1823,"Custom"),v:5,range:"custom"}],updateSelection:function updateSelection(index){switch(index){case 5:this.parent.parent.fromBox.fromDate.set("disabled",false);this.parent.parent.toBox.toDate.set("disabled",false);this.parent.rangeBox.set("disabled",true);this.select=false;break;default:this.parent.parent.fromBox.fromDate.set("disabled",true);this.parent.parent.toBox.toDate.set("disabled",true);this.parent.rangeBox.set("disabled",false);this.select=true;break;}},postBuildRendering:function(){if(this._super){this._super();}this.updateSelection(this.idx);},onidxChange:function(){if(this.hasRendered===false){return ;}this.updateSelection(this.idx);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-DI-facebook-advancedOptionsInner",alias:"rangeBox",disabled:false,ondisabledChange:function ondisabledChange(evt){mstrmojo.css.toggleClass(this.domNode,"disabled",evt.value);},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12688,"where N = ")},{scriptClass:"mstrmojo.TextBox",alias:"nValue",cssText:"width:20px;",value:1}]}]},{scriptClass:"mstrmojo.HBox",slot:"contentNode",cssClass:"mstrmojo-DI-facebook-advancedOptions",alias:"fromBox",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-di-ga-dateLabel",text:mstrmojo.desc(9374,"Start Date")},{scriptClass:"mstrmojo.DI.DIDateTextBox2",cssClass:"DIDateTextBox2",alias:"fromDate",value:"MM/DD/YYYY",disabled:true,bindings:{toDate:function(){return this.parent.toDate.value;}},ondisabledChange:function ondisabledChange(evt){this.parent.handleDisableChange(evt.value);},postBuildRendering:function(){if(this._super){this._super();}this.parent.handleDisableChange(this.disabled);}}],handleDisableChange:function handleDisableChange(value){if(value===true){mstrmojo.css.addClass(this.domNode,"DIDateTextBox2 disabled");}else{mstrmojo.css.removeClass(this.domNode,"DIDateTextBox2 disabled");}}},{scriptClass:"mstrmojo.HBox",slot:"contentNode",cssClass:"mstrmojo-DI-facebook-advancedOptions",alias:"toBox",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-di-ga-dateLabel",text:mstrmojo.desc(9375,"End Date")},{scriptClass:"mstrmojo.DI.DIDateTextBox2",cssClass:"DIDateTextBox2",alias:"toDate",value:"MM/DD/YYYY",disabled:true,bindings:{fromDate:function(){return this.parent.fromDate.value;}},ondisabledChange:function ondisabledChange(evt){this.parent.handleDisableChange(evt.value);},postBuildRendering:function(){if(this._super){this._super();}this.parent.handleDisableChange(this.disabled);}}],handleDisableChange:function handleDisableChange(value){if(value===true){mstrmojo.css.addClass(this.domNode,"DIDateTextBox2 disabled");}else{mstrmojo.css.removeClass(this.domNode,"DIDateTextBox2 disabled");}}}],setAdvancedProperties:function setAdvancedProperties(range,idx,nValue,from,to,dRange){this.advancedProperties={r:range,i:idx,n:nValue,fD:from,tD:to,d:dRange,dateRange:function(from,to){return{since:from,until:to};},getProperties:function getProperties(){if(this.r===true){return this.dateRange(this.d,this.tD);}return this.dateRange(this.fD,this.tD);}};return true;},onOk:function onOk(){var range=this.rangeDropdown.dates.select,nValue=this.rangeDropdown.rangeBox.nValue.value,from,to,dateObj,dRange,idx=5;if(range===true){idx=this.rangeDropdown.dates.idx;dRange="-"+nValue+" "+this.rangeDropdown.dates.options[idx].range;}else{from=this.fromBox.fromDate.value;to=this.toBox.toDate.value;dateObj=$D.parseDate(from);if(dateObj){from=$D.formatDateInfo(dateObj,fbDateFormat);}dateObj=$D.parseDate(to);if(dateObj){to=$D.formatDateInfo(dateObj,fbDateFormat);}}return this.setAdvancedProperties(range,idx,nValue,from,to,dRange);}});}());
(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.string","mstrmojo.gm.GMEnums","mstrmojo.gm.GMUtility","mstrmojo.chart.enums.EnumFontStyle");var $GM=mstrmojo.gm,$ARR=mstrmojo.array,$CSS=mstrmojo.css,GMUTIL=$GM.GMUtility,ENUM_FONT_SYLTE=mstrmojo.chart.enums.EnumFontStyle,ENUM_XML_TAG=$GM.WidgetPropertyTag,ENUM_FORMAT_TAG=$GM.FormatingPropertyTag,ENUM_FILL_STYLE=$GM.ShapeFillType,PRP_FIT_TO=$GM.EnumFitTo,PRP_AXIS_SCALE=$GM.EnumAxisScale,PRP_SHAPE=$GM.EnumShape,PRP_SUBTYPE=$GM.EnumSubtype,PRP_DATA_LABELS=$GM.EnumDataLabels,PRP_DATA_LABELS_PLACEMENT=$GM.EnumDataLabelPlacements,PRP_LEGEND=$GM.EnumLegend,PRP_LEGEND_MODE=$GM.EnumLegendMode,PRP_TEXT_HALIGN=$GM.EnumTextAlignH,PRP_TEXT_VALIGN=$GM.EnumTextAlignV,PRP_MAX_SIZE_TYPE=$GM.EnumMaxSizeType,PRP_MIN_SIZE_TYPE=$GM.EnumMinSizeType,PRP_AXES=$GM.EnumAxes,PRP_MATRIX_LINES=$GM.EnumMatrixLines,PRP_GRID_LINES=$GM.EnumGridLines,PRP_LEGEND_SLOT=$GM.EnumLegendSlot;var MAP_FIT_TO={Content:1,Window:2,Compact:3},MAP_AXIS_SCALE={Global:0,PerRC:1,Local:2,Custom:3,Different:4},MAP_SHAPE={Area:0,Bar:1,Line:2,Circle:4,Square:6,Tick:7,Pie:10,Ring:11},MAP_SUBTYPE={Automatic:1,Absolute:2,Stacked:3,Clustered:4,Percent:5},MAP_DATA_LABEL={Hide:1,"Show only values":2,"Show only text":3},MAP_DATA_LABEL_PLACEMENT={Automatic:1,Generic:2,Reserved:3},MAP_MAX_SIZE_TYPE={Automatic:1,Manual:2,"Auto fit":3},MAP_MIN_SIZE_TYPE={Automatic:1,Manual:2,Proportional:3},MAP_AXES={"Show Both":1,"Show None":2,"Show Only X":3,"Show Only Y":4},MAP_MATRIX_LINE={"Show All":1,"Show None":2,"Show Only Horizontal":3,"Show Only Vertical":4},MAP_GRID_LINE={Automatic:1,Show:2,Hide:3};var RVS_MAP_FIT_TO=[null,"Content","Window","Compact"],RVS_MAP_AXIS_SCALE=["Global","PerRC","Local","Custom","Different"],RVS_MAP_SHAPE=["Area","Bar","Line","StepLine","Circle","Rectangle","Square","Tick","PieSlice","Polygon","Pie","Ring"],RVS_MAP_SUBTYPE=[null,"Automatic","Absolute","Stacked","Clustered","Percent"],RVS_MAP_DATA_LABEL=[null,"Hide","Show only values","Show only text"],RVS_MAP_DATA_LABEL_PLACEMENT=[null,"Automatic","Generic","Reserved"],RVS_MAP_MAX_SIZE_TYPE=[null,"Automatic","Manual","Auto fit"],RVS_MAP_MIN_SIZE_TYPE=[null,"Automatic","Manual","Proportional"],RVS_MAP_AXES=[null,"Show Both","Show None","Show Only X","Show Only Y"],RVS_MAP_MATRIX_LINE=[null,"Show All","Show None","Show Only Horizontal","Show Only Vertical"],RVS_MAP_GRID_LINE=[null,"Automatic","Show","Hide"];var PropNameMapping={allAxLnShw:"xAxLnShw:yAxLnShw",allAxLnClr:"xAxLnClr:yAxLnClr",allAxLnStyle:"xAxLnStyle:yAxLnStyle",allAxLnCmbStyle:"xAxLnCmbStyle:yAxLnCmbStyle",allAxLnThk:"xAxLnThk:yAxLnThk",allAxTtShw:"xAxTtShw:yAxTtShw",allAxTtCtt:"xAxTtCtt:yAxTtCtt",allAxTtFntClr:"xAxTtFntClr:yAxTtFntClr",allAxTtFntFml:"xAxTtFntFml:yAxTtFntFml",allAxTtFntStyle:"xAxTtFntStyle:yAxTtFntStyle",allAxTtFntSz:"xAxTtFntSz:yAxTtFntSz",allAxLbFntClr:"xAxLbFntClr:yAxLbFntClr",allAxLbFntSz:"xAxLbFntSz:yAxLbFntSz",allAxLbFntFml:"xAxLbFntFml:yAxLbFntFml",allAxLbFntStyle:"xAxLbFntStyle:yAxLbFntStyle",allAxLbRtt:"xAxLbRtt:yAxLbRtt",allAxLbShw:"xAxLbShw:yAxLbShw",allMatrixLnShw:"vMatrixLnShw:hMatrixLnShw",allMatrixLnClr:"vMatrixLnClr:hMatrixLnClr",allMatrixLnThk:"vMatrixLnThk:hMatrixLnThk",allMatrixLnStyle:"vMatrixLnStyle:hMatrixLnStyle",allMatrixLnCmbStyle:"vMatrixLnCmbStyle:hMatrixLnCmbStyle",allGridLnShw:"majorGridLnShw:minerGridLnShw",allGridLnClr:"majorGridLnClr:minerGridLnClr",allGridLnThk:"majorGridLnThk:minerGridLnThk",allGridLnStyle:"majorGridLnStyle:minerGridLnStyle",allGridLnCmbStyle:"majorGridLnCmbStyle:minerGridLnCmbStyle",allRwColShw:"rwHdrShw:colHdrShw:rwVlShw:colVlShw",allLnShw:"xAxLnShw:yAxLnShw:xAxOriLnShw:yAxOriLnShw",allLnClr:"xAxLnClr:yAxLnClr:xAxOriLnClr:yAxOriLnClr",allLnStyle:"xAxLnStyle:yAxLnStyle:xAxOriLnStyle:yAxOriLnStyle",allLnCmbStyle:"xAxLnCmbStyle:yAxLnCmbStyle:xAxOriLnCmbStyle:yAxOriLnCmbStyle",allLnThk:"xAxLnThk:yAxLnThk:xAxOriLnThk:yAxOriLnThk",allTxtFntClr:"rwHdrTxtFntClr:colHdrTxtFntClr:rwVlTxtFntClr:colVlTxtFntClr:lgdFntClr:dlFntClr:rfLnFntClr:xAxTtFntClr:xAxLbFntClr:yAxTtFntClr:yAxLbFntClr",allTxtFntSz:"rwHdrTxtFntSz:colHdrTxtFntSz:rwVlTxtFntSz:colVlTxtFntSz:lgdFntSz:dlFntSz:rfLnFntSz:xAxTtFntSz:xAxLbFntSz:yAxTtFntSz:yAxLbFntSz",allTxtFntFml:"rwHdrTxtFntFml:colHdrTxtFntFml:rwVlTxtFntFml:colVlTxtFntFml:lgdFntFml:dlFntFml:rfLnFntFml:xAxTtFntFml:xAxLbFntFml:yAxTtFntFml:yAxLbFntFml",allTxtFntStyle:"rwHdrTxtFntStyle:colHdrTxtFntStyle:rwVlTxtFntStyle:colVlTxtFntStyle:lgdFntStyle:dlFntStyle:rfLnFntStyle:xAxTtFntStyle:xAxLbFntStyle:yAxTtFntStyle:yAxLbFntStyle",allRwColTxtFntClr:"rwHdrTxtFntClr:colHdrTxtFntClr:rwVlTxtFntClr:colVlTxtFntClr",allRwColTxtFntSz:"rwHdrTxtFntSz:colHdrTxtFntSz:rwVlTxtFntSz:colVlTxtFntSz",allRwColTxtFntFml:"rwHdrTxtFntFml:colHdrTxtFntFml:rwVlTxtFntFml:colVlTxtFntFml",allRwColTxtFntStyle:"rwHdrTxtFntStyle:colHdrTxtFntStyle:rwVlTxtFntStyle:colVlTxtFntStyle",allRwColTxtAlignH:"rwHdrTxtAlignH:colHdrTxtAlignH:rwVlTxtAlignH:colVlTxtAlignH",allRwColTxtAlignV:"rwHdrTxtAlignV:colHdrTxtAlignV:rwVlTxtAlignV:colVlTxtAlignV",outBdrShw:"OutSideBorder",allFillClr:"bgFillClr:rwHdrFillClr:colHdrFillClr",allFillTrans:"bgFillTrans:rwHdrFillTrans:colHdrFillTrans",colTxtShw:"colHdrShw:colVlShw",rwTxtShw:"rwHdrShw:rwVlShw",rwTxtTxtFntClr:"rwHdrTxtFntClr:rwVlTxtFntClr",rwTxtTxtFntSz:"rwHdrTxtFntSz:rwVlTxtFntSz",rwTxtTxtFntFml:"rwHdrTxtFntFml:rwVlTxtFntFml",rwTxtTxtFntStyle:"rwHdrTxtFntStyle:rwVlTxtFntStyle",rwTxtTxtAlignH:"rwHdrTxtAlignH:rwVlTxtAlignH",rwTxtTxtAlignV:"rwHdrTxtAlignV:rwVlTxtAlignV",colTxtTxtFntClr:"colHdrTxtFntClr:colVlTxtFntClr",colTxtTxtFntSz:"colHdrTxtFntSz:colVlTxtFntSz",colTxtTxtFntFml:"colHdrTxtFntFml:colVlTxtFntFml",colTxtTxtFntStyle:"colHdrTxtFntStyle:colVlTxtFntStyle",colTxtTxtAlignH:"colHdrTxtAlignH:colVlTxtAlignH",colTxtTxtAlignV:"colHdrTxtAlignV:colVlTxtAlignV",axOriLnShw:"xAxOriLnShw:yAxOriLnShw",axOriLnClr:"xAxOriLnClr:yAxOriLnClr",axOriLnStyle:"xAxOriLnStyle:yAxOriLnStyle",axOriLnCmbStyle:"xAxOriLnCmbStyle:yAxOriLnCmbStyle",axOriLnThk:"xAxOriLnThk:yAxOriLnThk",autoGridLnClr:"majorGridLnClr",autoGridLnCmbStyle:"majorGridLnCmbStyle",autoGridLnThk:"majorGridLnThk",autoGridLnStyle:"majorGridLnStyle"};var xmlNodeToConvert={metricShapes:1,mtcLvlDataLabel:1,axisOrigin:1,AxisScale:1,fmtOnComb:1,yr:1,xr:1,y2r:1,x2r:1,rvr:1,chr:1,groupInfo:1};var stringDelimiter=/[{}\[\],"'_:;\s]/i;var prefix="@pLd";var prefix_reg=/@pLd/g;function getXMLDoc(str){var parser=new window.DOMParser();return parser.parseFromString(str,"text/xml");}function getCachedXMLDoc(){var xmlData=this.xmlData,xmlDoc=this.xmlDoc;if(!xmlDoc&&xmlData){this.xmlDoc=xmlDoc=getXMLDoc(xmlData);}return xmlDoc;}function convertFromReferenceFormat(propName,stringValue){if(!xmlNodeToConvert[propName]){return stringValue;}return stringValue.replace(prefix_reg,"");}function convertToReferenceFormat(propName,stringValue,templateObjectMapping){if(!xmlNodeToConvert[propName]){return stringValue;}var resultString="",startPos=0,endPos,subString,objectType;if(!stringValue||stringValue.length===0){return stringValue;}endPos=stringValue.search(stringDelimiter);while(endPos!==-1){if(endPos!==startPos){subString=stringValue.substring(startPos,endPos);if(subString.length===32){objectType=templateObjectMapping[subString];if(objectType!==undefined){resultString+=prefix+subString;}}else{resultString+=subString;}}resultString+=stringValue[endPos];stringValue=stringValue.substring(endPos+1);endPos=stringValue.search(stringDelimiter);}resultString+=stringValue;return resultString;}function serializeXMLDoc(doc){var serializer=new XMLSerializer();return serializer.serializeToString(doc);}function formXMLScaleString(ids,scales){var i,str="",n=scales.length;for(i=0;i<n;i++){if(i!==0){str+=",";}str+=ids[i]+":"+scales[i];}return str;}function parseHeaderScale(str){str=str||"";var i,tmp,arr=str.split(","),n=arr.length,rtn={};for(i=0;i<n;i++){tmp=arr[i].split(":");if(tmp.length===2){rtn[tmp[0]]=parseFloat(tmp[1]);}}return rtn;}function parseAxisScale(str){str=str||"";var arr=str.split(":"),rtn={};if(arr.length===2){rtn[arr[0]]=parseFloat(arr[1])||1;}return rtn;}function parseIntPair(str){str=str||"";var arr=str.split(",");return{first:parseInt(arr[0],10),second:parseInt(arr[1],10)};}mstrmojo.gm.GMProperty=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.gm.GMProperty",scales:null,generalProps:null,xmlDoc:null,xmlData:null,xmlDirty:false,jsonData:null,controller:null,rhIds:null,chIds:null,yIds:null,xIds:null,y2Ids:null,x2Ids:null,templateObjectMapping:null,isItemCached:null,readItemCache:null,init:function(props){if(this._super){this._super(props);}this.resetScales();this.resetGeneralProps();this.rhIds=[];this.chIds=[];if(!mstrmojo.gm.GMProperty.propertyMap){this.generatePropertyMap();}this.isItemCached={};this.readItemCache={};},generatePropertyMap:function(){var propName,propMap=mstrmojo.gm.GMProperty.propertyMap={};function addPropMap(name,mapName){if(!propMap[name]){propMap[name]=[mapName];}else{if(propMap[name].indexOf(mapName)<0){propMap[name].push(mapName);}}}function getAddPropMap(propName){return function(prop){addPropMap(prop,propName);};}for(propName in PropNameMapping){if(PropNameMapping.hasOwnProperty(propName)){propMap[propName]=PropNameMapping[propName].split(":");$ARR.forEach(propMap[propName],getAddPropMap(propName));}}},updateDefaults:function(defaultsObj,fmt){var modifiedDefaultFillClr=fmt[ENUM_FORMAT_TAG.MODIFIED_DEF_FILL_COLOR],manualColor;if(modifiedDefaultFillClr){if(modifiedDefaultFillClr==="transparent"){manualColor=modifiedDefaultFillClr;}else{if(modifiedDefaultFillClr==="default"){manualColor=undefined;}else{if(!isNaN(modifiedDefaultFillClr)){manualColor=parseInt(fmt[ENUM_FORMAT_TAG.MODIFIED_DEF_FILL_COLOR],10);}else{manualColor=JSON.parse(modifiedDefaultFillClr.replace(/'/g,'"'));}}}}if(manualColor!==undefined){defaultsObj[ENUM_FORMAT_TAG.SHAPE_FILL_COLOR]=manualColor;defaultsObj[ENUM_FORMAT_TAG.SHAPE_FILL_COLOR_DEFAULT]=false;}else{defaultsObj[ENUM_FORMAT_TAG.SHAPE_FILL_COLOR_DEFAULT]=true;}this.defaultsObj=defaultsObj;},resetScales:function(){this.scales={rh:[],ch:[],y:1,y2:1,x:1,x2:1,lgd:1,ctw:1,cth:1};},resetGeneralProps:function(){var props={};props.fitTo=PRP_FIT_TO.CONTENT;props.axisScale=PRP_AXIS_SCALE.GLOBAL;props.shape=PRP_SHAPE.LINE;props.subtype=PRP_SUBTYPE.AUTO;props.dataLabels=PRP_DATA_LABELS.HIDE;props.dataLabelPlacements=PRP_DATA_LABELS_PLACEMENT.AUTOMATIC;props.banding=true;props.legend=PRP_LEGEND.SHOW;props.legendMode=PRP_LEGEND_MODE.RESTORED;props.legendShow=true;props.colAlign=PRP_TEXT_HALIGN.CENTER;props.rowAlignH=PRP_TEXT_HALIGN.CENTER;props.rowAlignV=PRP_TEXT_VALIGN.CENTER;props.maxSizeType=PRP_MAX_SIZE_TYPE.AUTO;props.minSizeType=PRP_MIN_SIZE_TYPE.AUTO;props.maxSizeValue=0.9;props.minSizeValue=0.2;props.outBorder=true;props.axes=PRP_AXES.SHOW_BOTH;props.matrixLine=PRP_MATRIX_LINES.SHOW_ALL;props.gridLine=PRP_GRID_LINES.AUTO;props.legendSlot=PRP_LEGEND_SLOT.RIGHT_MIDDLE;this.generalProps=props;},getXMLString:function(){return this.xmlData;},isXMLDirty:function(){return this.xmlDirty;},resetXMLDirtyFlag:function(){this.xmlDirty=false;},initFromXML:function(xmlData){if(xmlData){if(this.xmlData&&this.xmlData!==xmlData){this.xmlDoc=null;}this.xmlData=xmlData;}var i,n,items=[ENUM_XML_TAG.FIT_TO,ENUM_XML_TAG.AXIS_SCALE,ENUM_XML_TAG.SHAPE,ENUM_XML_TAG.SUB_TYPE,ENUM_XML_TAG.DATA_LABEL,ENUM_XML_TAG.DATA_LABELS_PLACEMENT,ENUM_XML_TAG.BANDING,ENUM_XML_TAG.LEGEND_VISIBLE,ENUM_XML_TAG.COL_ALIGNMENT,ENUM_XML_TAG.ROW_ALIGNMENT,ENUM_XML_TAG.MAX_SIZE_TYPE,ENUM_XML_TAG.MAX_SIZE_VALUE,ENUM_XML_TAG.MIN_SIZE_TYPE,ENUM_XML_TAG.MIN_SIZE_VALUE,ENUM_XML_TAG.SELECTION_TYPE,ENUM_XML_TAG.SELECTIONS,ENUM_XML_TAG.OUTSIDE_BORDER,ENUM_XML_TAG.AXES,ENUM_XML_TAG.MATRIX_LINES,ENUM_XML_TAG.GRID_LINES,ENUM_XML_TAG.LEGEND_MODE,ENUM_XML_TAG.LEGEND_POSITION,ENUM_XML_TAG.SCALE_LEGEND_WIDTH,ENUM_XML_TAG.SCALE_CHART_WIDTH,ENUM_XML_TAG.SCALE_CHART_HEIGHT,ENUM_XML_TAG.METRIC_SHAPES,ENUM_XML_TAG.AXIS_ORIGIN,ENUM_XML_TAG.LOG_SCALE,ENUM_XML_TAG.TREND_LINE_DEF,ENUM_XML_TAG.TREND_BUBBLE_FORE_DEF,ENUM_XML_TAG.REF_LINE_DEF,ENUM_FORMAT_TAG.FORMATS_ON_COMBINATION,ENUM_FORMAT_TAG.ALL_SHAPE_FORMAT,ENUM_FORMAT_TAG.V_MATRIX_LINES_SHOW,ENUM_FORMAT_TAG.V_MATRIX_LINES_COLOR,ENUM_FORMAT_TAG.V_MATRIX_LINES_THICKNESS,ENUM_FORMAT_TAG.V_MATRIX_LINES_STYLE,ENUM_FORMAT_TAG.H_MATRIX_LINES_SHOW,ENUM_FORMAT_TAG.H_MATRIX_LINES_COLOR,ENUM_FORMAT_TAG.H_MATRIX_LINES_THICKNESS,ENUM_FORMAT_TAG.H_MATRIX_LINES_STYLE];for(i=0,n=items.length;i<n;i++){this.initItem(items[i]);}var props=this.generalProps;if(props.legendShow){props.legend=(props.legendMode===PRP_LEGEND_MODE.MINIMIZED)?PRP_LEGEND.MINIMIZED:PRP_LEGEND.SHOW;}else{props.legend=PRP_LEGEND.HIDE;}},initItem:function(propName){var i,n,num,pName,flag1,flag2,itemId,rhInfo,rhScales,chInfo,chScales,axisInfo,axisScales,rhIds=this.rhIds,chIds=this.chIds,controller=this.controller,scales=this.scales,props=this.generalProps,value;value=this.hGetPropValue(propName);switch(propName){case ENUM_XML_TAG.FIT_TO:props.fitTo=MAP_FIT_TO[value]||PRP_FIT_TO.PANEL;break;case ENUM_XML_TAG.AXIS_SCALE:props.axisScale=MAP_AXIS_SCALE[value]||PRP_AXIS_SCALE.GLOBAL;break;case ENUM_XML_TAG.SHAPE:num=MAP_SHAPE[value];props.shape=isNaN(num)?PRP_SHAPE.LINE:num;break;case ENUM_XML_TAG.METRIC_SHAPES:case ENUM_XML_TAG.METRIC_LEVEL_DATA_LABEL:case ENUM_XML_TAG.AXIS_ORIGIN:case ENUM_XML_TAG.LOG_SCALE:case ENUM_XML_TAG.TREND_LINE_DEF:case ENUM_XML_TAG.TREND_BUBBLE_FORE_DEF:case ENUM_XML_TAG.REF_LINE_DEF:case ENUM_XML_TAG.FORMATS_ON_COMBINATION:case ENUM_FORMAT_TAG.ALL_SHAPE_FORMAT:props[propName]=GMUTIL.stringToJSON(value);break;case ENUM_XML_TAG.SUB_TYPE:props.subtype=MAP_SUBTYPE[value]||PRP_SUBTYPE.AUTO;break;case ENUM_XML_TAG.DATA_LABEL:props.dataLabels=MAP_DATA_LABEL[value];break;case ENUM_XML_TAG.DATA_LABELS_PLACEMENT:props.dataLabelPlacements=MAP_DATA_LABEL_PLACEMENT[value];break;case ENUM_XML_TAG.BANDING:props.banding=value==="true";break;case ENUM_XML_TAG.LEGEND_VISIBLE:props.legendShow=value!=="Hide";break;case ENUM_XML_TAG.COL_ALIGNMENT:if(value!==undefined){num=parseInt(value,10);if(!isNaN(num)&&num>=0&&num<=2){this.updateItem(ENUM_FORMAT_TAG.COLUMN_HEADER_TEXT_ALIGNMENT_HORIZONTAL,num);this.updateItem(ENUM_FORMAT_TAG.COLUMN_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL,num);}}break;case ENUM_XML_TAG.ROW_ALIGNMENT:if(value!==undefined){num=parseIntPair(value).first;if(!isNaN(num)&&num>=0&&num<=2){this.updateItem(ENUM_FORMAT_TAG.ROW_HEADER_TEXT_ALIGNMENT_HORIZONTAL,num);this.updateItem(ENUM_FORMAT_TAG.ROW_VAVLUE_TEXT_ALIGNMENT_HORIZONTAL,num);}num=parseIntPair(value).second;if(!isNaN(num)&&num>=0&&num<=2){this.updateItem(ENUM_FORMAT_TAG.ROW_HEADER_TEXT_ALIGNMENT_VERTICAL,num);this.updateItem(ENUM_FORMAT_TAG.ROW_VAVLUE_TEXT_ALIGNMENT_VERTICAL,num);}}break;case ENUM_XML_TAG.MAX_SIZE_TYPE:props.maxSizeType=MAP_MAX_SIZE_TYPE[value]||PRP_MAX_SIZE_TYPE.AUTO;break;case ENUM_XML_TAG.MAX_SIZE_VALUE:num=parseFloat(value);props.maxSizeValue=isNaN(num)?0.9:num;break;case ENUM_XML_TAG.MIN_SIZE_TYPE:props.minSizeType=MAP_MIN_SIZE_TYPE[value]||PRP_MIN_SIZE_TYPE.PROPORTIONAL;break;case ENUM_XML_TAG.MIN_SIZE_VALUE:num=parseFloat(value);props.minSizeValue=isNaN(num)?0.2:num;break;case ENUM_XML_TAG.OUTSIDE_BORDER:props.outBorder=value!=="Hide";break;case ENUM_XML_TAG.AXES:if(value!==undefined){props.axes=MAP_AXES[value]||PRP_AXES.SHOW_BOTH;if(props.axes===PRP_AXES.SHOW_BOTH){flag1=flag2=true;}else{if(props.axes===PRP_AXES.SHOW_X){flag1=true;flag2=false;}else{if(props.axes===PRP_AXES.SHOW_Y){flag1=false;flag2=true;}else{flag1=flag2=false;}}}this.updateItem(ENUM_FORMAT_TAG.X_AXIS_LINE_SHOW,flag1);this.updateItem(ENUM_FORMAT_TAG.Y_AXIS_LINE_SHOW,flag2);}break;case ENUM_XML_TAG.MATRIX_LINES:if(value!==undefined){props.matrixLine=MAP_MATRIX_LINE[value]||PRP_MATRIX_LINES.SHOW_ALL;if(props.matrixLine===PRP_MATRIX_LINES.SHOW_ALL){flag1=flag2=true;}else{if(props.matrixLine===PRP_MATRIX_LINES.SHOW_HORIZONTAL){flag1=false;flag2=true;}else{if(props.matrixLine===PRP_MATRIX_LINES.SHOW_VERTICAL){flag1=true;flag2=false;}else{flag1=flag2=false;}}}this.updateItem(ENUM_FORMAT_TAG.V_MATRIX_LINES_SHOW,flag1);this.updateItem(ENUM_FORMAT_TAG.H_MATRIX_LINES_SHOW,flag2);}break;case ENUM_XML_TAG.GRID_LINES:props.gridLine=MAP_GRID_LINE[value]||PRP_GRID_LINES.AUTO;break;case ENUM_XML_TAG.LEGEND_MODE:props.legendMode=parseInt(value,10);break;case ENUM_XML_TAG.LEGEND_POSITION:props.legendSlot=parseInt(value,10)||PRP_LEGEND_SLOT.RIGHT_MIDDLE;break;case ENUM_XML_TAG.SCALE_LEGEND_WIDTH:scales.lgd=parseFloat(value)||undefined;break;case ENUM_XML_TAG.SCALE_CHART_WIDTH:scales.ctw=parseFloat(value)||1;break;case ENUM_XML_TAG.SCALE_CHART_HEIGHT:scales.cth=parseFloat(value)||1;break;case ENUM_XML_TAG.SCALE_ROW_HEADERS:rhIds.length=0;rhScales=parseHeaderScale(value);rhInfo=controller.getRowTitleInfo(true);n=rhInfo.items.length;for(i=0;i<n;i++){itemId=rhInfo.items[i].id;if(rhScales.hasOwnProperty(itemId)){scales.rh[i]=rhScales[itemId]||1;}else{scales.rh[i]=1;}rhIds.push(itemId);}break;case ENUM_XML_TAG.SCALE_COL_HEADERS:chIds.length=0;chScales=parseHeaderScale(value);chInfo=controller.getColTitleInfo(true);n=chInfo.items.length;for(i=0;i<n;i++){itemId=chInfo.items[i].id;if(chScales.hasOwnProperty(itemId)){scales.ch[i]=chScales[itemId]||1;}else{scales.ch[i]=1;}chIds.push(itemId);}break;case ENUM_XML_TAG.SCALE_Y:case ENUM_XML_TAG.SCALE_X:case ENUM_XML_TAG.SCALE_Y2:case ENUM_XML_TAG.SCALE_X2:if(propName===ENUM_XML_TAG.SCALE_Y){axisInfo=controller.getYAxisInfo(undefined,undefined,true,false);pName="y";}else{if(propName===ENUM_XML_TAG.SCALE_X){axisInfo=controller.getXAxisInfo(undefined,undefined,true,false);pName="x";}else{if(propName===ENUM_XML_TAG.SCALE_Y2){axisInfo=controller.getYAxisInfo(undefined,undefined,false,false);pName="y2";}else{if(propName===ENUM_XML_TAG.SCALE_X2){axisInfo=controller.getXAxisInfo(undefined,undefined,false,false);pName="x2";}}}}axisScales=parseAxisScale(value);n=axisInfo.ids.length;itemId="";for(i=0;i<n;i++){if(i!==0){itemId+=",";}itemId+=axisInfo.ids[i];}this[pName+"Ids"]=itemId;scales[pName]=axisScales[itemId]||1;break;}},readItem:function(propName,ignoreDefaults){var props=this.generalProps,scales=this.scales,value,itemValue;switch(propName){case ENUM_XML_TAG.FIT_TO:itemValue=props.fitTo;break;case ENUM_XML_TAG.AXIS_SCALE:itemValue=props.axisScale;break;case ENUM_XML_TAG.SHAPE:itemValue=props.shape;break;case ENUM_XML_TAG.SUB_TYPE:itemValue=props.subtype;break;case ENUM_XML_TAG.DATA_LABEL:itemValue=props.dataLabels;break;case ENUM_XML_TAG.DATA_LABELS_PLACEMENT:itemValue=props.dataLabelPlacements;break;case ENUM_XML_TAG.BANDING:itemValue=props.banding;break;case ENUM_XML_TAG.LEGEND_VISIBLE:itemValue=props.legendShow;break;case ENUM_XML_TAG.COL_ALIGNMENT:itemValue=props.colAlign;break;case ENUM_XML_TAG.ROW_ALIGNMENT:itemValue={};itemValue.h=props.rowAlignH;itemValue.v=props.rowAlignV;break;case ENUM_XML_TAG.MAX_SIZE_TYPE:itemValue=props.maxSizeType;break;case ENUM_XML_TAG.MAX_SIZE_VALUE:itemValue=props.maxSizeValue;break;case ENUM_XML_TAG.MIN_SIZE_TYPE:itemValue=props.minSizeType;break;case ENUM_XML_TAG.MIN_SIZE_VALUE:itemValue=props.minSizeValue;break;case ENUM_XML_TAG.OUTSIDE_BORDER:itemValue=props.outBorder;break;case ENUM_XML_TAG.AXES:itemValue=props.axes;break;case ENUM_XML_TAG.MATRIX_LINES:itemValue=props.matrixLine;break;case ENUM_XML_TAG.GRID_LINES:itemValue=props.gridLine;break;case ENUM_XML_TAG.LEGEND_MODE:itemValue=props.legendMode;break;case ENUM_XML_TAG.LEGEND_POSITION:itemValue=props.legendSlot;break;case ENUM_XML_TAG.SCALE_LEGEND_WIDTH:itemValue=scales.lgd;break;case ENUM_XML_TAG.SCALE_CHART_WIDTH:itemValue=scales.ctw;break;case ENUM_XML_TAG.SCALE_CHART_HEIGHT:itemValue=scales.cth;break;case ENUM_XML_TAG.SCALE_ROW_HEADERS:itemValue=scales.rh;break;case ENUM_XML_TAG.SCALE_COL_HEADERS:itemValue=scales.ch;break;case ENUM_XML_TAG.SCALE_Y:itemValue=scales.y;break;case ENUM_XML_TAG.SCALE_X:itemValue=scales.x;break;case ENUM_XML_TAG.SCALE_Y2:itemValue=scales.y2;break;case ENUM_XML_TAG.SCALE_X2:itemValue=scales.x2;break;case ENUM_XML_TAG.SCALE_ALL:itemValue=scales;break;default:itemValue=this.hGetPropValue(propName);break;}value=itemValue;switch(propName){case ENUM_FORMAT_TAG.LINE_MARKER_SHOW:case ENUM_FORMAT_TAG.LEGEND_BORDER_SHOW:case ENUM_FORMAT_TAG.X_AXIS_ORIGIN_LINE_SHOW:case ENUM_FORMAT_TAG.Y_AXIS_ORIGIN_LINE_SHOW:case ENUM_FORMAT_TAG.X_AXIS_LINE_SHOW:case ENUM_FORMAT_TAG.X_AXIS_TITLE_SHOW:case ENUM_FORMAT_TAG.X_AXIS_LABELS_SHOW:case ENUM_FORMAT_TAG.Y_AXIS_LINE_SHOW:case ENUM_FORMAT_TAG.Y_AXIS_TITLE_SHOW:case ENUM_FORMAT_TAG.Y_AXIS_LABELS_SHOW:case ENUM_FORMAT_TAG.V_MATRIX_LINES_SHOW:case ENUM_FORMAT_TAG.H_MATRIX_LINES_SHOW:case ENUM_FORMAT_TAG.ALL_ROW_COLUMN_SHOW:case ENUM_FORMAT_TAG.COLUMN_HEADER_SHOW:case ENUM_FORMAT_TAG.ROW_HEADER_SHOW:case ENUM_FORMAT_TAG.COLUMN_VALUES_SHOW:case ENUM_FORMAT_TAG.ROW_VALUES_SHOW:case ENUM_FORMAT_TAG.GRID_LINE_AUTO:case ENUM_XML_TAG.SORT_ORDER:if(value){itemValue=(value==="true"||value===true);}break;case ENUM_FORMAT_TAG.MAJOR_GRID_LINES_SHOW:if(value===undefined){value=props.gridLine;}itemValue=parseInt(value,10);break;case ENUM_FORMAT_TAG.MINOR_GRID_LINES_SHOW:if(value===undefined){value=props.gridLine;if(value===2){value=PRP_GRID_LINES.HIDE;}}itemValue=parseInt(value,10);break;case ENUM_FORMAT_TAG.X_AXIS_LABELS_ROTATION:if(value){itemValue=parseInt(value,10);}break;case ENUM_XML_TAG.SORT_INDEX:if(value){itemValue={};itemValue.row=parseIntPair(value).first;itemValue.col=parseIntPair(value).second;}break;case ENUM_XML_TAG.AXIS_SCALE_DATA:if(value){itemValue=GMUTIL.parseAxisScaleData(value);}break;case ENUM_XML_TAG.METRIC_SHAPES:case ENUM_XML_TAG.METRIC_LEVEL_DATA_LABEL:case ENUM_XML_TAG.AXIS_ORIGIN:case ENUM_XML_TAG.LOG_SCALE:case ENUM_XML_TAG.TREND_LINE_DEF:case ENUM_XML_TAG.TREND_BUBBLE_FORE_DEF:case ENUM_XML_TAG.REF_LINE_DEF:case ENUM_XML_TAG.SELECTIONS:case ENUM_XML_TAG.FORMATS_ON_COMBINATION:case ENUM_FORMAT_TAG.ALL_SHAPE_FORMAT:var iic=this.isItemCached;var ric=this.readItemCache;if(!iic[propName]){ric[propName]=GMUTIL.stringToJSON(itemValue);iic[propName]=true;}itemValue=ric[propName];break;case ENUM_XML_TAG.SCALE_V_EXTRA_LINE:itemValue=parseFloat(itemValue)||1;break;case ENUM_XML_TAG.MAX_SIZE_VALUE:case ENUM_XML_TAG.MIN_SIZE_VALUE:if(value){itemValue=parseFloat(value);}break;case ENUM_FORMAT_TAG.REF_LABELS_FONT_FAMILY:case ENUM_FORMAT_TAG.REF_LABELS_FONT_SIZE:case ENUM_FORMAT_TAG.REF_LABELS_FONT_STYLE:case ENUM_FORMAT_TAG.REF_LABELS_FONT_COLOR:if(value&&typeof value==="string"&&value.indexOf("{")>=0){itemValue=GMUTIL.stringToJSON(value);}break;default:break;}if(itemValue===undefined){if(!ignoreDefaults){itemValue=this.defaultsObj[propName];}}else{if(propName.slice(-3)==="Clr"&&typeof itemValue==="string"){if(itemValue!=="transparent"){if(isNaN(itemValue)){itemValue=GMUTIL.stringToJSON(itemValue);}else{itemValue=parseInt(itemValue,10);}}}}if(typeof itemValue==="string"&&!isNaN(itemValue)){itemValue=parseInt(itemValue,10);}return itemValue;},clearReadItemCache:function(){this.isItemCached={};},updateItem:function(propName,value){var scales=this.scales,props=this.generalProps,finalValue=GMUTIL.everythingToString(value);this.clearReadItemCache();switch(propName){case ENUM_XML_TAG.FIT_TO:props.fitTo=value;finalValue=RVS_MAP_FIT_TO[value];break;case ENUM_XML_TAG.AXIS_SCALE:props.axisScale=value;finalValue=RVS_MAP_AXIS_SCALE[value];break;case ENUM_XML_TAG.SHAPE:props.shape=value;finalValue=RVS_MAP_SHAPE[value];break;case ENUM_XML_TAG.SUB_TYPE:props.subtype=value;finalValue=RVS_MAP_SUBTYPE[value];break;case ENUM_XML_TAG.DATA_LABEL:props.dataLabels=value;finalValue=RVS_MAP_DATA_LABEL[value];break;case ENUM_XML_TAG.DATA_LABELS_PLACEMENT:props.dataLabelPlacements=value===true?1:2;finalValue=RVS_MAP_DATA_LABEL_PLACEMENT[props.dataLabelPlacements];break;case ENUM_XML_TAG.BANDING:props.banding=value;break;case ENUM_XML_TAG.LEGEND_VISIBLE:props.legendShow=value;finalValue=value?"Show":"Hide";break;case ENUM_XML_TAG.ROW_ALIGNMENT:props.rowAlignH=value.h;props.rowAlignV=value.v;finalValue=value.h+","+value.v;break;case ENUM_XML_TAG.COL_ALIGNMENT:props.colAlign=value;break;case ENUM_XML_TAG.MAX_SIZE_TYPE:props.maxSizeType=value;finalValue=RVS_MAP_MAX_SIZE_TYPE[value];break;case ENUM_XML_TAG.MAX_SIZE_VALUE:props.maxSizeValue=value;break;case ENUM_XML_TAG.MIN_SIZE_TYPE:props.minSizeType=value;finalValue=RVS_MAP_MIN_SIZE_TYPE[value];break;case ENUM_XML_TAG.MIN_SIZE_VALUE:props.minSizeValue=value;break;case ENUM_XML_TAG.OUTSIDE_BORDER:props.outBorder=value;finalValue=value?"Show":"Hide";break;case ENUM_XML_TAG.AXES:props.axes=value;finalValue=RVS_MAP_AXES[value];break;case ENUM_XML_TAG.MATRIX_LINES:props.matrixLine=value;finalValue=RVS_MAP_MATRIX_LINE[value];break;case ENUM_XML_TAG.GRID_LINES:props.gridLine=value;finalValue=RVS_MAP_GRID_LINE[value];break;case ENUM_XML_TAG.LEGEND_MODE:props.legendMode=value;break;case ENUM_XML_TAG.LEGEND_POSITION:props.legendSlot=value;break;case ENUM_XML_TAG.SCALE_LEGEND_WIDTH:scales.lgd=value;break;case ENUM_XML_TAG.SCALE_CHART_WIDTH:scales.ctw=value;break;case ENUM_XML_TAG.SCALE_CHART_HEIGHT:scales.cth=value;break;case ENUM_XML_TAG.SCALE_ROW_HEADERS:scales.rh=value;finalValue=formXMLScaleString(this.rhIds,scales.rh);break;case ENUM_XML_TAG.SCALE_COL_HEADERS:scales.ch=value;finalValue=formXMLScaleString(this.chIds,scales.ch);break;case ENUM_XML_TAG.SCALE_Y:scales.y=value;finalValue=this.yIds+":"+scales.y;break;case ENUM_XML_TAG.SCALE_X:scales.x=value;finalValue=this.xIds+":"+scales.x;break;case ENUM_XML_TAG.SCALE_Y2:scales.y2=value;finalValue=this.y2Ids+":"+scales.y2;break;case ENUM_XML_TAG.SCALE_X2:scales.x2=value;finalValue=this.x2Ids+":"+scales.x2;break;case ENUM_XML_TAG.SORT_INDEX:finalValue=value.row+","+value.col;break;default:break;}this.hSetPropValue(propName,finalValue);},removeItem:function(propName){this.hRemoveProp(propName);},updateItems:function(propNames,values){var i,n=propNames.length;for(i=0;i<n;i++){this.updateItem(propNames[i],values[i]);}},setController:function(controller){this.controller=controller;this.initItem(ENUM_XML_TAG.SCALE_ROW_HEADERS);this.initItem(ENUM_XML_TAG.SCALE_COL_HEADERS);this.initItem(ENUM_XML_TAG.SCALE_Y);this.initItem(ENUM_XML_TAG.SCALE_X);this.initItem(ENUM_XML_TAG.SCALE_Y2);this.initItem(ENUM_XML_TAG.SCALE_X2);},initHTML5Props:function(props){var fn=this.readItem,LEGEND=props.LEGEND={},BK=props.BK={},RH_BK=props.RH_BK={},CH_BK=props.CH_BK={},RH_TITLE=props.RH_TITLE={},RH=props.RH={},CH_TITLE=props.CH_TITLE={},CH=props.CH={},AXIS_LABEL_X=props.AXIS_LABEL_X={},AXIS_LABEL_Y=props.AXIS_LABEL_Y={},AXIS_TITLE_X=props.AXIS_TITLE_X={},AXIS_TITLE_Y=props.AXIS_TITLE_Y={},AXIS_LINE_X=props.AXIS_LINE_X={},AXIS_LINE_Y=props.AXIS_LINE_Y={},MATRIX_LINE_H=props.MATRIX_LINE_H={},MATRIX_LINE_V=props.MATRIX_LINE_V={},GRID_LINE_MAJOR=props.GRID_LINE_MAJOR={},GRID_LINE_MINOR=props.GRID_LINE_MINOR={},OUTSIDE_BORDER=props.OUTSIDE_BORDER={},processFill=function(obj,fillStyle,fillValue){if(fillStyle===ENUM_FILL_STYLE.Gradient){fillValue=GMUTIL.decodeColor(fillValue);var rtn=$CSS.buildGradient(fillValue.or,fillValue.c1,fillValue.c2);if(rtn){obj[rtn.n]=rtn.v;}}else{obj.backgroundColor=GMUTIL.decodeColor(fillValue);}},processFontStyle=function(obj,fs){obj.fontWeight=(fs&ENUM_FONT_SYLTE.FS_BOLD?"bold":"normal");obj.fontStyle=(fs&ENUM_FONT_SYLTE.FS_ITALIC?"italic":"normal");if((fs&ENUM_FONT_SYLTE.FS_STRIKETHROUGH)&&(fs&ENUM_FONT_SYLTE.FS_UNDERLINE)){obj.textDecoration="line-through underline";}else{if(fs&ENUM_FONT_SYLTE.FS_STRIKETHROUGH){obj.textDecoration="line-through";}else{if(fs&ENUM_FONT_SYLTE.FS_UNDERLINE){obj.textDecoration="underline";}else{obj.textDecoration="none";}}}},translateLineStyle=function(idx){var lsMap=["solid","dashed","dotted"];return lsMap[idx]||"none";};LEGEND.fontFamily=fn.call(this,ENUM_FORMAT_TAG.LEGEND_FONT_FAMILY);LEGEND.fontSize=fn.call(this,ENUM_FORMAT_TAG.LEGEND_FONT_SIZE);processFontStyle(LEGEND,fn.call(this,ENUM_FORMAT_TAG.LEGEND_FONT_STYLE));LEGEND.color=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.LEGEND_FONT_COLOR));processFill(LEGEND,fn.call(this,ENUM_FORMAT_TAG.LEGEND_BG_FILL_STYLE),fn.call(this,ENUM_FORMAT_TAG.LEGEND_BG_COLOR));LEGEND.opacity=fn.call(this,ENUM_FORMAT_TAG.LEGEND_BG_FILL_TRANSPARENCY)/100;if(fn.call(this,ENUM_FORMAT_TAG.LEGEND_BORDER_SHOW)){LEGEND.borderWidth=parseInt(fn.call(this,ENUM_FORMAT_TAG.LEGEND_BORDER_THICKNESS),10)+"px";LEGEND.borderStyle=translateLineStyle(fn.call(this,ENUM_FORMAT_TAG.LEGEND_BORDER_LINE_STYLE));LEGEND.borderColor=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.LEGEND_BORDER_COLOR));}processFill(BK,fn.call(this,ENUM_FORMAT_TAG.BG_FILL_STYLE),fn.call(this,ENUM_FORMAT_TAG.BG_COLOR));BK.opacity=fn.call(this,ENUM_FORMAT_TAG.BG_FILL_TRANSPARENCY)/100;processFill(RH_BK,fn.call(this,ENUM_FORMAT_TAG.ROW_HEADER_FILL_STYLE),fn.call(this,ENUM_FORMAT_TAG.ROW_HEADER_FILL_COLOR));RH_BK.opacity=fn.call(this,ENUM_FORMAT_TAG.ROW_HEADER_FILL_TRANSPARENCY)/100;processFill(CH_BK,fn.call(this,ENUM_FORMAT_TAG.COLUMN_HEADER_FILL_STYLE),fn.call(this,ENUM_FORMAT_TAG.COLUMN_HEADER_FILL_COLOR));CH_BK.opacity=fn.call(this,ENUM_FORMAT_TAG.COLUMN_HEADER_FILL_TRANSPARENCY)/100;RH_TITLE.fontFamily=fn.call(this,ENUM_FORMAT_TAG.ROW_HEADER_TEXT_FONT_FAMILY);RH_TITLE.fontSize=fn.call(this,ENUM_FORMAT_TAG.ROW_HEADER_TEXT_FONT_SIZE);processFontStyle(RH_TITLE,fn.call(this,ENUM_FORMAT_TAG.ROW_HEADER_TEXT_FONT_STYLE));RH_TITLE.color=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.ROW_HEADER_TEXT_FONT_COLOR));CH_TITLE.fontFamily=fn.call(this,ENUM_FORMAT_TAG.COLUMN_HEADER_TEXT_FONT_FAMILY);CH_TITLE.fontSize=fn.call(this,ENUM_FORMAT_TAG.COLUMN_HEADER_TEXT_FONT_SIZE);processFontStyle(CH_TITLE,fn.call(this,ENUM_FORMAT_TAG.COLUMN_HEADER_TEXT_FONT_STYLE));CH_TITLE.color=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.COLUMN_HEADER_TEXT_FONT_COLOR));RH.fontFamily=fn.call(this,ENUM_FORMAT_TAG.ROW_VAVLUE_TEXT_FONT_FAMILY);RH.fontSize=fn.call(this,ENUM_FORMAT_TAG.ROW_VAVLUE_TEXT_FONT_SIZE);processFontStyle(RH,fn.call(this,ENUM_FORMAT_TAG.ROW_VAVLUE_TEXT_FONT_STYLE));RH.color=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.ROW_VAVLUE_TEXT_FONT_COLOR));CH.fontFamily=fn.call(this,ENUM_FORMAT_TAG.COLUMN_VAVLUE_TEXT_FONT_FAMILY);CH.fontSize=fn.call(this,ENUM_FORMAT_TAG.COLUMN_VAVLUE_TEXT_FONT_SIZE);processFontStyle(CH,fn.call(this,ENUM_FORMAT_TAG.COLUMN_VAVLUE_TEXT_FONT_STYLE));CH.color=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.COLUMN_VAVLUE_TEXT_FONT_COLOR));AXIS_LABEL_Y.fontFamily=fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_LABELS_FONT_FAMILY);AXIS_LABEL_Y.fontSize=fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_LABELS_FONT_SIZE);processFontStyle(AXIS_LABEL_Y,fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_LABELS_FONT_STYLE));AXIS_LABEL_Y.color=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_LABELS_FONT_COLOR));AXIS_LABEL_X.fontFamily=fn.call(this,ENUM_FORMAT_TAG.X_AXIS_LABELS_FONT_FAMILY);AXIS_LABEL_X.fontSize=fn.call(this,ENUM_FORMAT_TAG.X_AXIS_LABELS_FONT_SIZE);processFontStyle(AXIS_LABEL_X,fn.call(this,ENUM_FORMAT_TAG.X_AXIS_LABELS_FONT_STYLE));AXIS_LABEL_X.color=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.X_AXIS_LABELS_FONT_COLOR));AXIS_TITLE_Y.fontFamily=fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_TITLE_FONT_FAMILY);AXIS_TITLE_Y.fontSize=fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_TITLE_FONT_SIZE);processFontStyle(AXIS_TITLE_Y,fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_TITLE_FONT_STYLE));AXIS_TITLE_Y.color=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_TITLE_FONT_COLOR));AXIS_TITLE_X.fontFamily=fn.call(this,ENUM_FORMAT_TAG.X_AXIS_TITLE_FONT_FAMILY);AXIS_TITLE_X.fontSize=fn.call(this,ENUM_FORMAT_TAG.X_AXIS_TITLE_FONT_SIZE);processFontStyle(AXIS_TITLE_X,fn.call(this,ENUM_FORMAT_TAG.X_AXIS_TITLE_FONT_STYLE));AXIS_TITLE_X.color=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.X_AXIS_TITLE_FONT_COLOR));AXIS_LINE_X.borderWidth=parseInt(fn.call(this,ENUM_FORMAT_TAG.X_AXIS_LINE_THICKNESS),10)+"px";AXIS_LINE_X.borderColor=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.X_AXIS_LINE_COLOR));AXIS_LINE_X.borderTopStyle=translateLineStyle(fn.call(this,ENUM_FORMAT_TAG.X_AXIS_LINE_STYLE));AXIS_LINE_Y.borderWidth=parseInt(fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_LINE_THICKNESS),10)+"px";AXIS_LINE_Y.borderColor=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_LINE_COLOR));AXIS_LINE_Y.borderLeftStyle=translateLineStyle(fn.call(this,ENUM_FORMAT_TAG.Y_AXIS_LINE_STYLE));MATRIX_LINE_H.borderWidth=parseInt(fn.call(this,ENUM_FORMAT_TAG.H_MATRIX_LINES_THICKNESS),10)+"px";MATRIX_LINE_H.borderColor=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.H_MATRIX_LINES_COLOR));MATRIX_LINE_H.borderTopStyle=translateLineStyle(fn.call(this,ENUM_FORMAT_TAG.H_MATRIX_LINES_STYLE));MATRIX_LINE_V.borderWidth=parseInt(fn.call(this,ENUM_FORMAT_TAG.V_MATRIX_LINES_THICKNESS),10)+"px";MATRIX_LINE_V.borderColor=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.V_MATRIX_LINES_COLOR));MATRIX_LINE_V.borderLeftStyle=translateLineStyle(fn.call(this,ENUM_FORMAT_TAG.V_MATRIX_LINES_STYLE));GRID_LINE_MAJOR.borderWidth=parseInt(fn.call(this,ENUM_FORMAT_TAG.MAJOR_GRID_LINES_THICKNESS),10)+"px";GRID_LINE_MAJOR.borderColor=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.MAJOR_GRID_LINES_COLOR));GRID_LINE_MAJOR.borderTopStyle=translateLineStyle(fn.call(this,ENUM_FORMAT_TAG.MAJOR_GRID_LINES_STYLE));GRID_LINE_MAJOR.borderLeftStyle=GRID_LINE_MAJOR.borderTopStyle;GRID_LINE_MINOR.borderWidth=parseInt(fn.call(this,ENUM_FORMAT_TAG.MINER_GRID_LINES_THICKNESS),10)+"px";GRID_LINE_MINOR.borderColor=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.MINER_GRID_LINES_COLOR));GRID_LINE_MINOR.borderTopStyle=translateLineStyle(fn.call(this,ENUM_FORMAT_TAG.MINER_GRID_LINES_STYLE));GRID_LINE_MINOR.borderLeftStyle=GRID_LINE_MINOR.borderTopStyle;OUTSIDE_BORDER.borderWidth=parseInt(fn.call(this,ENUM_FORMAT_TAG.OUTSIDE_BORDER_THICKNESS),10)+"px";OUTSIDE_BORDER.borderColor=GMUTIL.decodeColor(fn.call(this,ENUM_FORMAT_TAG.OUTSIDE_BORDER_COLOR));OUTSIDE_BORDER.borderLeftStyle=translateLineStyle(fn.call(this,ENUM_FORMAT_TAG.OUTSIDE_BORDER_STYLE));OUTSIDE_BORDER.borderTopStyle=translateLineStyle(fn.call(this,ENUM_FORMAT_TAG.OUTSIDE_BORDER_STYLE));},readItemDefault:function(propName,context){var rtn,transparency={CIRCLE:0.7,Bar:0.7,AREA:0.7,PIE:0.8,RING:0.8},thickness={CIRCLE:2,Bar:1,AREA:2,PIE:1,RING:1};switch(propName){case ENUM_FORMAT_TAG.X_AXIS_TITLE_SHOW:case ENUM_FORMAT_TAG.Y_AXIS_TITLE_SHOW:rtn=context.isMetric?true:false;break;case ENUM_FORMAT_TAG.SHAPE_FILL_TRANSPARENCY:rtn=transparency[context.shapeType];break;case ENUM_FORMAT_TAG.SHAPE_BORDER_THICKNESS:rtn=thickness[context.shapeType];break;}return rtn;},consumeJsonFmt:function(json){var item,props=[],values=[];for(item in json){if(json.hasOwnProperty(item)){props.push(item);json[item]=convertFromReferenceFormat(item,json[item],this.templateObjectMapping);values.push(json[item]);}}this.xmlData=this.makeDefaultPropXML(props,values);this.jsonData=json;},hSyncWithJson:function(propName,value,isRemove){var jsonData=this.jsonData;if(jsonData){if(isRemove){delete jsonData[propName];}else{jsonData[propName]=value;}}},hGetPropValue:function(propName){var xmlDoc,json=this.jsonData,value;if(json){return json[propName];}else{xmlDoc=getCachedXMLDoc.call(this);if(xmlDoc){var fmtNode=xmlDoc.getElementsByTagName("fmt")[0],elemNode=fmtNode.getElementsByTagName(propName)[0];if(elemNode){value=elemNode.getAttribute("value");return convertFromReferenceFormat(propName,value,this.templateObjectMapping);}}}return undefined;},hRemoveProp:function(propName){this.hSyncWithJson(propName,"",true);var xmlDoc=getCachedXMLDoc.call(this),fmtNode=xmlDoc.getElementsByTagName("fmt")[0],elemNode=fmtNode.getElementsByTagName(propName)[0];if(elemNode){elemNode.parentNode.removeChild(elemNode);this.xmlData=serializeXMLDoc(xmlDoc);this.xmlDirty=true;}return this.xmlData;},hSetPropValue:function(propName,value){if(typeof value==="undefined"){return this.hRemoveProp(propName);}if((typeof value)!=="string"){value=value.toString();}this.hSyncWithJson(propName,value);var xmlDoc=getCachedXMLDoc.call(this),fmtNode=xmlDoc.getElementsByTagName("fmt")[0],elemNode=fmtNode.getElementsByTagName(propName)[0];if(!elemNode){elemNode=xmlDoc.createElement(propName);fmtNode.appendChild(elemNode);}elemNode.setAttribute("value",convertToReferenceFormat(propName,value,this.templateObjectMapping));this.xmlData=serializeXMLDoc(xmlDoc);this.xmlDirty=true;return this.xmlData;},hSetPropValues:function(propNames,values){var i,elemNode,name,value,n=propNames.length,xmlDoc=getCachedXMLDoc.call(this),fmtNode=xmlDoc.getElementsByTagName("fmt")[0];for(i=0;i<n;i++){name=propNames[i];value=values[i];this.hSyncWithJson(name,value);elemNode=fmtNode.getElementsByTagName(name)[0];if(!elemNode){elemNode=xmlDoc.createElement(name);fmtNode.appendChild(elemNode);}elemNode.setAttribute("value",convertToReferenceFormat(name,value,this.templateObjectMapping));}this.xmlData=serializeXMLDoc(xmlDoc);this.xmlDirty=true;return this.xmlData;},clearCachedXMLDoc:function(){if(this.xmlDoc){delete this.xmlDoc;}},setTemplateObjectMapping:function(templateObjectMapping){this.templateObjectMapping=templateObjectMapping;},makeDefaultPropXML:function makeDefaultPropXML(props,values){var i,elemNode,n=props.length,domPS=new window.DOMParser(),xml="<props><widgetProps><fmt></fmt></widgetProps></props>",xmlDoc=domPS.parseFromString(xml,"text/xml"),fmtNode=xmlDoc.getElementsByTagName("fmt")[0];for(i=0;i<n;i++){elemNode=xmlDoc.createElement(props[i]);elemNode.setAttribute("value",convertToReferenceFormat(props[i],values[i],this.templateObjectMapping));fmtNode.appendChild(elemNode);}return serializeXMLDoc(xmlDoc);}});mstrmojo.gm.GMProperty.getUnderlyingPropertyNameWithAll=function(oriPropName){return(PropNameMapping[oriPropName]||oriPropName).split(":");};}());
(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi.ui._HasMask","mstrmojo.vi._MonitorsAppState","mstrmojo.EditableLabel","mstrmojo.vi.ui.rw.PanelSelectorList","mstrmojo.ui.menus.MenuConfig");mstrmojo.vi.ui.rw.DockedPanelSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi.ui._HasMask,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.rw.DockedPanelSelector",markupString:'<div id="{@id}" class="mstrmojo-DockedPanelSelector {@cssClass}" style="{@cssText}"><div class="panel-title"><div class="panel-name"></div><div class="panel-menu" mstrAttach:click>&nbsp;</div></div><div class="panel-list"></div><div class="panel-addBtn" mstrAttach:click></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{titleNode:function titleNode(){return this.domNode.firstChild.firstChild;},menuNode:function menuNode(){return this.domNode.firstChild.lastChild;},containerNode:function containerNode(){return this.domNode.childNodes[1];},addBtnNode:function addBtnNode(){return this.domNode.childNodes[2];},maskNode:function maskNode(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},children:[{scriptClass:"mstrmojo.EditableLabel",alias:"title",slot:"titleNode",editOnClick:false,editOnDoubleClick:true,onTextEditComplete:function onTextEditComplete(textChanged){if(textChanged){var selector=this.parent;selector.parent.renamePanel(selector.panels[selector.list.getSelectedItems()[0].idx],this.text);this.set("title",this.text);}}},{scriptClass:"mstrmojo.vi.ui.rw.PanelSelectorList",alias:"list",slot:"containerNode",postselectionChange:function postselectionChange(evt){var added=evt.added;if(added){var item=this.items[added[0]],panelSelector=this.parent;panelSelector.parent.selectPanel(item.id);panelSelector.title.set("text",item.n);panelSelector.title.set("title",item.n);}}}],init:function init(props){this._super(props);this.title.set("editOnDoubleClick",!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign());},panels:null,onAppStateChange:function onAppStateChange(evt){this._super(evt);this.set("isMasked",evt.value===mstrmojo.vi.VisualInsightApp.APP_STATES.SELECTOR_TARGETING);this.title.set("editOnDoubleClick",!mstrApp.isAppStatePresentation()&&mstrApp.allowWebDashboardDesign());},setPanels:function setPanels(panels,selectedIdx){this.panels=panels;this.set("visible",panels.length>1);var list=this.list;list.set("items",panels.map(function(panel,idx){return{n:panel.titleText,id:panel.k,idx:idx};}));list.singleSelect(selectedIdx);},onclick:function onclick(evt){var target=evt.getTarget(),panelStack=this.parent;if(target===this.addBtnNode){panelStack.addPanel();}else{if(target===this.menuNode){var menuCfg=new mstrmojo.ui.menus.MenuConfig(),corners=mstrmojo.ui.PopupConfig.ENUM_CORNERS;menuCfg.hostId=this.id;menuCfg.hostElement=this.menuNode;menuCfg.setAlignment(corners.TOP_LEFT,corners.BOTTOM_LEFT);var list=this.list,panelCnt=list.items.length,currentIdx=list.getSelectedItems()[0].idx,currentPanel=this.panels[currentIdx],lblTitle=this.title;menuCfg.addMenuItem(mstrmojo.desc(4719,"Add Panel"),"",function(){panelStack.addPanel();});menuCfg.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"dup",function(){panelStack.duplicatePanel(currentPanel);});if(currentIdx){menuCfg.addMenuItem(mstrmojo.desc(5362,"Move Left"),"lft",function(){panelStack.movePanel(currentIdx,currentIdx-1);});}if(currentIdx<panelCnt-1){menuCfg.addMenuItem(mstrmojo.desc(5363,"Move Right"),"rgt",function(){panelStack.movePanel(currentIdx,currentIdx+1);});}menuCfg.addSeparator();menuCfg.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){lblTitle.set("isEditing",true);});if(panelCnt>1){menuCfg.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){panelStack.deletePanel(currentPanel);});}this.openPopup(menuCfg.newInstance());}}}});}());
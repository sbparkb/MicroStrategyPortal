(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.fx.AnimateProp");var $CSS=mstrmojo.css;var scrollStep=10;function scrollTo(me,y,callback){me.pauseScrollRendering(true);var sbn=me.scrollboxNode,fx=me.animate?me.scrollEffect:null;if(fx&&fx.play){if(fx.isPlaying){fx.cancel();}fx.props={scrollTop:{start:sbn.scrollTop,stop:y,isStyle:false}};fx.onEnd=function(){me.pauseScrollRendering(false,null,callback);};fx.play();}else{sbn.scrollTop=y;me.pauseScrollRendering(false,null,callback);}}function centerByScroll(me,idx,counter){var LIMIT=4;if(!counter){counter=0;}var half=Math.round(me.renderBlockSize/2);me.fillAt(Math.max(0,idx-half),idx+half);var icn=me.itemsContainerNode,it=icn.childNodes[idx],itTop=me.listMapper.itemOffsetTop(me,icn,null,it),y=parseInt(me.scrollboxNode.clientHeight/2,10)-it.offsetHeight/2,yTo=Math.max(0,me.spacerMargin+itTop-y);if(Math.abs(me.scrollboxNode.scrollTop-yTo)>2){scrollTo(me,yTo,me.renderOnScroll?function(){if(counter<=LIMIT){centerByScroll(me,idx,counter++);}}:null);}else{var fx=me.animate?me.scrollEffect:null;if(fx&&fx.isPlaying&&fx.cancel){fx.cancel();me.pauseScrollRendering(false);}}}function getItemsHeight(me){var icn=me.itemsContainerNode,l=icn.lastChild,h=l?l.offsetTop+l.offsetHeight-icn.firstChild.offsetTop:0;return h;}function centerAll(me){var h=getItemsHeight(me),diff=Math.max(0,parseInt((me.scrollboxNode.clientHeight-h)/2,10));scrollTo(me,Math.max(0,me.spacerMargin-diff));}function centerItem(me){var idx=me.selectedIndex,has=idx>-1;me.set("hasSelection",has);if(!me.domNode){return ;}if(has){centerByScroll(me,idx);}else{centerAll(me);}}function updateUpDownArrowVis(me){var sb=me.scrollboxNode,h=getItemsHeight(me),vis=h>sb.clientHeight/2;$CSS.toggleClass(me.upArrowNode,["enabled"],vis);$CSS.toggleClass(me.downArrowNode,["enabled"],vis);}function jumpTo(me,p){var sb=me.scrollboxNode;sb.scrollTop=Math.min(Math.max(sb.scrollTop+p,0),sb.scrollHeight-sb.offsetHeight);}function fireJumps(me,up){if(!me._scrollInter){var p=scrollStep*(up?-1:1);me._scrollInter=window.setInterval(function(){jumpTo(me,p);},50);}}function stopJumps(me){if(me._scrollInter){window.clearInterval(me._scrollInter);me._scrollInter=null;}}mstrmojo._IsDial=mstrmojo.provide("mstrmojo._IsDial",{markupString:'<div id="{@id}" class="mstrmojo-Dial {@cssClass}" style="position:relative;"><div class="mstrmojo-Dial-uparrow"  onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], true)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], true)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"></div><div class="mstrmojo-Dial-scrollbox {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-Dial-spacer" style="{@spacerCssText}"><div class="mstrmojo-Dial-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div></div></div><div class="mstrmojo-Dial-dnarrow" onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], false)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], false)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.childNodes[1];},spacerNode:function(){return this.domNode.childNodes[1].firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},upArrowNode:function(){return this.domNode.childNodes[0];},downArrowNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){$CSS.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);}},animate:true,itemsEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:500,interval:25,slot:"itemsContainerNode",preStart:function(){var t=this.widget[this.slot],w=(t&&t.offsetWidth)||0;this.props=w?{left:{start:-w,stop:0,suffix:"px",isStyle:true}}:{};},revertOnCancel:false},scrollEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:250,interval:25,slot:"scrollboxNode",revertOnCancel:false},multiSelect:false,holdJumpOnly:true,audibles:{"*":true,hasSelection:false},initSpacer:function inSp(){var m=(this.cssText||"").match(/height:\s*(\d*)px/);if(m){this.spacerMargin=parseInt(Number(m[1])/2,10);var mg=this.spacerMargin+"px";this.spacerCssText="padding-top: "+mg+"; padding-bottom: "+mg+";";}else{this.spacerMargin=0;delete this.spacerCssText;}},center:function center(){centerItem(this);},preBuildRendering:function(){this.initSpacer();return this._super();},postBuildRendering:function pstBR(){this._super();this.center();updateUpDownArrowVis(this);},refreshScroll:function refresh(){this.center();updateUpDownArrowVis(this);},prechange:function pchg(evt){this._super(evt);if(this.hasRendered){if(!this.multiSelect||(evt&&evt.added&&evt.added.length)){this.center();}}},onclickarrow:function oca(win,evt,up){jumpTo(this,scrollStep*(up?-1:1));},onmouseoverarrow:function mov(win,evt,up){if(!this.holdJumpOnly){fireJumps(this,up);}},onmouseoutarrow:function mou(win,evt,up){stopJumps(this);},onmousedownarrow:function onmousedownarrow(win,evt,up){if(this.holdJumpOnly){fireJumps(this,up);}},onmouseuparrow:function onmouseuparrow(win,evt,up){stopJumps(this);}});}());
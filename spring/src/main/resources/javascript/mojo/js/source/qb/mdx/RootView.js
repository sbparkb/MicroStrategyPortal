(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo.ui.Splitter","mstrmojo.warehouse.WHPanel","mstrmojo.qb.mdx.CubeDropbox","mstrmojo.hash");mstrmojo.requiresDescs(531,12932,12923,12941);var $HASH=mstrmojo.hash;var FIRST_ITEM_SLOT="firstSplitNode",SECOND_ITEM_SLOT="secondSplitNode";var VIEW_MODE_FIXED_SIZE=1;mstrmojo.qb.mdx.RootView=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.qb.mdx.RootView",markupString:'<div id="{@id}" class="mstrmojo-qb {@cssClass}" style="{@cssText}"><div class="mstrmojo-qb-layout"></div><div></div></div>',markupSlots:{layout:function(){return this.domNode.firstChild;}},viewMode:VIEW_MODE_FIXED_SIZE,init:function init(props){this._super(props);var evtConfig={};evtConfig[this.id]={maxCubeError:this.onErrorDisplay};evtConfig[this.id].windowSizeChanged=this.adjustSize;mstrApp.getRootController().attachDataChangeListeners(evtConfig);var warehousePanel=this.main.whPanel;warehousePanel.topPanel.title=mstrmojo.desc(12923,"MDX Connections");warehousePanel.bottomPanel.title=mstrmojo.desc(12941,"Browse Catalog");warehousePanel.bottomPanel.dbTableTree.getDragAction=function getDragAction(context){var nodeAttributes=this.getNodeAttributes(context.src.node),nodeData=nodeAttributes&&this.getTreeItem(nodeAttributes.index);if(nodeData&&nodeData.cubetp){return"addCube";}};this.getBrowserDimensions=function getBrowserDimensions(){return{w:"1010px",h:"552px"};};var availableTablesPanel=warehousePanel.bottomPanel;availableTablesPanel.searchBox.widthOffset=21;var dbRoleSelector=this.getDBRoleSelector();dbRoleSelector.newDBBtn.set("text",mstrmojo.desc(531,"Add")+"...");availableTablesPanel.getLayoutOffsets=function(){return{h:32,w:0};};dbRoleSelector.getLayoutOffsets=function(){return{h:32,w:0};};availableTablesPanel.heightOffset=59;var dbTableTree=availableTablesPanel.dbTableTree,tablesTreeHooks=$HASH.clone(dbTableTree.tablesTreeHooks);tablesTreeHooks.isTable=function(itemData){return itemData&&itemData.cubetp;};dbTableTree.tablesTreeHooks=tablesTreeHooks;},getDBRoleSelector:function getDBRoleSelector(){return this.main.children[0].topPanel;},preBuildRendering:function preBuildRendering(){var rtn=true;if(this._super){rtn=this._super();}if(this.viewMode===VIEW_MODE_FIXED_SIZE){if(this._listenerProc){mstrmojo.dom.detachEvent(window,"resize",this._listenerProc);this._listenerProc=null;}}return rtn;},onErrorDisplay:function onErrorDisplay(evt){var errorMsg="";if(evt.name==="maxCubeError"){errorMsg=mstrmojo.desc(12932,"A dataset can have only a single OLAP cube. Please create another dataset to import the second OLAP cube.");}mstrmojo.qb.alert(errorMsg,null,null,null,this.alertCfg);},layoutConfig:{h:{layout:"100%"},w:{layout:"100%"}},children:[{scriptClass:"mstrmojo.ui.Splitter",cssClass:"mstrmojo-qb-es-whole-panel",config:{firstSplit:{v:"50%",min:"350px",max:undefined},secondSplit:{v:"50%",min:"300px",max:undefined},resizeHandle:{v:"2px"}},getLayoutOffsets:function getLayoutOffsets(){return{h:0,w:36};},slot:"layout",alias:"main",toggleDatabaseView:function toggleDatabaseView(show){this.toggleFirstItemVisibility(show);},children:[{scriptClass:"mstrmojo.warehouse.WHPanel",cssClass:"mstrmojo-qb-es-whpanel mdx-panel",alias:"whPanel",slot:FIRST_ITEM_SLOT,orientation:mstrmojo.ui.Splitter.ENUM_OR.HORIZONTAL,config:{firstSplit:{v:"50%",min:"200px"},secondSplit:{v:"50%",min:"200px"},resizeHandle:{v:"2px"}}},{scriptClass:"mstrmojo.qb.mdx.CubeDropbox",slot:SECOND_ITEM_SLOT}]}],toggleDatabaseView:function toggleDatabaseView(show){this.main.toggleDatabaseView(show);},adjustSize:function(evt){var size=evt.size,isCloud=mstrApp.isCloudPro,widthDelta=isCloud?40:0,heightDelta=isCloud?180:104;var width=parseInt(size.w,10)-widthDelta+"px",height=parseInt(size.h,10)-heightDelta+"px";if(this.height&&height!==this.height){this.set("height",height);}else{this.height=height;}if(this.width&&width!==this.width){this.set("width",width);}else{this.width=width;}return true;},postBuildRendering:function postBuildRendering(){if(this._super){this._super();}this.adjustSize({size:mstrApp.size});}});}());
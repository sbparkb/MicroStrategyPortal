(function(){mstrmojo.requiresClsP("mstrmojo.chart","ChartContext","GraphObject","FormatFont");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumCollectionType","EnumBoxStyle");var $C=mstrmojo.chart,$CHART_ENUMS=$C.enums,$CT=$CHART_ENUMS.EnumCollectionType,$BS=$CHART_ENUMS.EnumBoxStyle;mstrmojo.chart.GraphCollectionObject=mstrmojo.declare(mstrmojo.chart.GraphObject,null,{scriptClass:"mstrmojo.chart.GraphCollectionObject",mGraphObjectCollection:[],mFormatFillPtr:null,mFormatFontPtr:null,mCollectionType:$CT.CT_NO_COLLECTION,init:function init(props){props.hasLine=false;this._super(props);var chartCtx=this.mChartContextPtr,tid=this.mTripleId,colType=this.mCollectionType=props.CollectionType,shape=props.Shape;this.mGraphObjectCollection=[];switch(this.mCollectionType){case $CT.CT_LINE:this.mFormatLinePtr=chartCtx.GetFormatLine(tid,colType,shape);break;case $CT.CT_GENERAL_SHAPE:case $CT.CT_VERTICAL_AREA:case $CT.CT_VERTICAL_BAR:case $CT.CT_HORIZONTAL_AREA:case $CT.CT_HORIZONTAL_BAR:case $CT.CT_DEPTH_LINE_OR_LINE_MARKER:this.mFormatLinePtr=chartCtx.GetFormatLine(tid,colType,shape);this.mFormatFillPtr=chartCtx.GetFormatFill(tid,colType,shape);break;case $CT.CT_TEXT:this.mFormatFontPtr=chartCtx.GetFormatFont(tid);if(this.mFormatFontPtr.mFontBox!==$BS.BS_NOFRAME&&!chartCtx.mIsGraphMatrix){this.mFormatFillPtr=chartCtx.GetFormatFill(tid,colType);this.mFormatLinePtr=chartCtx.GetFormatLine(tid,colType,shape);}break;case $CT.CT_NO_FORMAT:break;default:break;}},AddGraphObject:function AddGraphObject(graphObjectPtr,shareFormat){if(shareFormat===undefined){shareFormat=true;}this.mGraphObjectCollection.push(graphObjectPtr);graphObjectPtr.mpParentObject=this;if(shareFormat){graphObjectPtr.getFormatFromParent();}},ClearCollection:function ClearCollection(){this.mGraphObjectCollection=[];},GetCollectionSize:function GetCollectionSize(){return this.mGraphObjectCollection.length;},GetObjectByIndex:function GetObjectByIndex(index){return this.mGraphObjectCollection[index];},SetFormatFill:function SetFormatFill(formatFill){this.mFormatFillPtr=formatFill;},SetFormatFont:function SetFormatFont(formatFont){this.mFormatFontPtr=formatFont;},GetFormatFill:function GetFormatFill(){return this.mFormatFillPtr;},GetFormatFont:function GetFormatFont(){return this.mFormatFontPtr;},Replace:function Replace(index,graphObject,iShareFormat){if(index>=0&&index<this.mGraphObjectCollection.length){if(iShareFormat===undefined){iShareFormat=true;}this.mGraphObjectCollection[index]=graphObject;graphObject.mpParentObject=this;if(iShareFormat){graphObject.getFormatFromParent();}}}});}());
(function(){mstrmojo.markup={apply:function apply(markup,obj){var s=(/mstrmarkup\:markup/).test(markup)?this.dhtml(markup):markup;return s.replace(this._REG_EXP_TOKENS,function tokenRepl(token,prop){return(prop in obj&&obj[prop]!==null)?obj[prop]:"";});},dhtml:function dhtml(markup){return(markup||"").replace(/^<mstrmarkup:markup[^\>]*?\>/,"").replace(/<\/mstrmarkup:markup\>/,"");},slots:function slots(node){var hash={};function getSlotNames(node){var names=node.getAttribute("mstrSlot");if(names){var arr=names.split(/\s*,\s*/);for(var i=0,len=arr.length;i<len;i++){hash[arr[i]]=node;}}}getSlotNames(node);var nodes=node.getElementsByTagName("*");for(var j=0,jLen=nodes&&nodes.length||0;j<jLen;j++){getSlotNames(nodes[j]);}return hash;},_REG_EXP_TOKENS:/\{\@([^\}]+)\}/gm,useCache:false,methods:function meths(markup){var c=this.useCache&&this._findCache(markup);if(c){return c;}var methods={lookup:{},sequence:[]};var root=markup&&markup.match(/<mstrmarkup\:markup(.*?)\>/);if(!root){return methods;}var s=root[1],matches;while((matches=s.match(/([^\s=]+)=\"([^\"]+)\"/m))){var n=matches[1];methods.lookup[n]=new Function(matches[2]);methods.sequence.push(n);s=s.substr(matches.index+matches[0].length);}if(this.useCache){this._writeCache(markup,methods);}return methods;},_cache:[],_writeCache:function(markup,data){this._cache.push({markup:markup,data:data});},_findCache:function(markup){var c=this._cache,match;for(var i=0,len=c.length;i<len;i++){if(c[i].markup==markup){match=c[i];break;}}return match&&match.data;}};})();
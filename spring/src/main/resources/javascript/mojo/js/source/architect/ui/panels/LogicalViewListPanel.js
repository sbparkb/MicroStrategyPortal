(function(){mstrmojo.requiresCls("mstrmojo.architect.EnumDataChangeEvents","mstrmojo.architect.ui.UnitList","mstrmojo.architect.ui.panels.BaseListPanel");var $A=mstrmojo.array,$H=mstrmojo.hash,$ENUM_DATA_CHANGE_EVENTS=mstrmojo.architect.EnumDataChangeEvents,STR_HIDE_VIEWS=mstrmojo.desc(12230,"Hide logical views"),STR_ADD_VIEWS=mstrmojo.desc(12251,"Add logical view"),STR_VIEWS=mstrmojo.desc(12217,"Logical views"),STR_VIEW="logical view",STR_DELETE_CONFIRM="Are you sure you want to delete $$ '##'?";function updateViewItems(evt){var views=[];$H.forEach(evt.views,function(view){views.push(view.getTableData());});this.contentWidget.set("items",views);this.viewId=evt.value||"";}function renameViewItems(evt){var index=$A.find(this.contentWidget.items,"did",evt.itemID),cw=this.contentWidget;if(index>=0){cw.items[index].n=evt.itemName;cw.refresh();}}mstrmojo.architect.ui.panels.LogicalViewListPanel=mstrmojo.declare(mstrmojo.architect.ui.panels.BaseListPanel,null,{scriptClass:"mstrmojo.architect.ui.panels.LogicalViewListPanel",title:STR_VIEWS,addTitle:STR_ADD_VIEWS,viewId:"",init:function init(props){props.showListBtnTitle=STR_HIDE_VIEWS;this._super(props);var evtConfig={},panelConfig=evtConfig[this.id]={};panelConfig[$ENUM_DATA_CHANGE_EVENTS.LOGICALVIEWS_CHANGED]=updateViewItems;panelConfig[$ENUM_DATA_CHANGE_EVENTS.VIEW_ITEM_RENAMED]=renameViewItems;mstrApp.getRootController().attachDataChangeListeners(evtConfig);},getContentWidget:function getContentWidget(){var $this=this,rootController=mstrApp.rootController;return{scriptClass:"mstrmojo.architect.ui.UnitList",singleSelect:function singleSelect(idx){var id=this.items[idx].did;if($this.viewId!==id){rootController.switchLogicalView(id);}},onItemDeleted:function onItemDeleted(listItem){mstrmojo.confirm(STR_DELETE_CONFIRM.replace("##",listItem.n).replace("$$",STR_VIEW),{confirmBtn:{fn:function(){if(rootController.model.currentLogicalViewID===listItem.did){rootController.closeViewObject();}rootController.deleteObject(listItem);}}});},onItemRenamed:function onItemRenamed(listItem,newName){var id=listItem.did;rootController.renameLogicalView(id,newName,{success:function success(){rootController.updateViewListItem(id,newName);}});}};},onItemAdd:function onItemAdd(){mstrApp.getRootController().addLogicalView(true,"");}});}());
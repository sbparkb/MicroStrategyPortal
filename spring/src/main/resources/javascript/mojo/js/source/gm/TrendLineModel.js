(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.VisUtility","mstrmojo.Obj","mstrmojo.chart.model.enums.EnumDSSGraphRegressionType","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.chart.enums.EnumLineStyle","mstrmojo.num","mstrmojo.string");mstrmojo.requiresClsP("mstrmojo.gm","GMUtility","GMEnums");mstrmojo.requiresCls("mstrmojo.chart.common.Utility");var $MOJO=mstrmojo,$GM=mstrmojo.gm,GMUTIL=$GM.GMUtility,$VISUTILS=$MOJO.VisUtility,$ARR=$MOJO.array,$CHART_TYPE=$MOJO.gm.EnumGraphType,$NUM=mstrmojo.num,$STR=mstrmojo.string,$RegType=$MOJO.chart.model.enums.EnumDSSGraphRegressionType,REF_TYPE=$GM.EnumRefLineModelType,IDEN_TYPE=$GM.EnumIdentityType,ENUM_XML_TAG=$GM.WidgetPropertyTag,$RLT=$GM.EnumTrendRefModelLabels,$DSSOBJ_TYPES=$MOJO.chart.model.enums.EnumDSSObjectType;var $C=mstrmojo.chart,CEUtility=$C.common.Utility;function sortAndMergeArray(arr1,arr2){var res=[],objArr=[],i,len=Math.min(arr1.length,arr2.length),sortBy=function(obj1,obj2){return obj1.x>obj2.x?1:-1;};for(i=0;i<len;i++){objArr.push({x:arr1[i],y:arr2[i]});}objArr.sort(sortBy);$ARR.forEach(objArr,function(obj){res.push(obj.x);res.push(obj.y);});return res;}function getForcastLabels(isForward,useCompact){var bbSectionModel,lbObjArr;if(this.isTrendLine===false){return undefined;}bbSectionModel=this.getBBSection();if(isForward){lbObjArr=bbSectionModel.fl||[];}else{lbObjArr=bbSectionModel.bl||[];}if(useCompact){var lbs=[];$ARR.forEach(lbObjArr,function(lbObj){lbs.push(lbObj.join());});return lbs;}return lbObjArr;}function toFixedAndTrimString(c,dig){var largeCeil=1000000000;if(c!==0&&(Math.abs(c)<0.001||Math.abs(c)>largeCeil)){return $NUM.format(6,3,"",c);}return parseFloat(c.toFixed(dig).replace(/0+$/,"")).toString();}function getTrendLineFunction(type,oriCoef,xvarName){var x=xvarName,res="",coef=[];$ARR.forEach(oriCoef,function(c){if(isNaN(c)){coef.push(c);}else{coef.push(toFixedAndTrimString(c,3));}});function getPolyFunction(localCoef){var i,localrRes="",len,c,numC,p;len=localCoef.length;for(i=len-1;i>=0;i--){c=localCoef[i];numC=parseFloat(c);p=i;if(numC===0){continue;}if(localrRes!==""){if(numC>0){localrRes+=" + ";}else{localrRes+=" - ";numC=-numC;c=c.slice(1);}}if(p!==0){if(p===1){localrRes+=c+x;}else{localrRes+=c+x+"^("+p+")";}}else{localrRes+=c;}}return localrRes;}if(type==="Linear"){res=getPolyFunction(coef);}else{if(type==="Exponential"){if(coef.length<2){return coef[0];}if(typeof coef[1]==="string"&&coef[1].slice(0,2)==="Ln"){res=coef[0]+"e^("+coef[1].slice(2)+x+")";}else{if(coef[1]>0){res=coef[1];}else{res="("+coef[1]+")";}res+="^("+x+")*"+coef[0];}}else{if(type==="Power"){if(coef.length<2){return coef[0];}res=x+"^("+coef[1]+")*"+coef[0];}else{if(type==="Poly"){res=getPolyFunction(coef);}else{if(type==="Log"){if(coef.length<2){return coef[0];}res=coef[1]+"ln("+x+")";if(coef[0]!==0){if(coef[0]>0){res+=" + ";res+=coef[0];}else{res+=" - ";res+=(-coef[0]);}}}}}}}return res;}function getTrendLineFunctionTokens(type,oriCoef,xvarName){var x=xvarName,res="",coef=[],exprArray=[];$ARR.forEach(oriCoef,function(c){if(isNaN(c)){coef.push(c);}else{coef.push(toFixedAndTrimString(c,3));}});function getPolyFunctionTokens(localCoef){var i,len,c,numC,p,localExprArray=[],exprStr;len=localCoef.length;for(i=len-1;i>=0;i--){c=localCoef[i];numC=parseFloat(c);p=i;if(numC===0){continue;}exprStr="";if(localExprArray.length){if(numC>0){exprStr+=" + ";}else{exprStr+=" - ";numC=-numC;c=c.slice(1);}}if(p!==0){if(p===1){exprStr+=c+x;localExprArray.push({v:exprStr});}else{exprStr+=c+x;localExprArray.push({v:exprStr});localExprArray.push({v:"("+p+")",isSuper:true});}}else{exprStr+=c;localExprArray.push({v:exprStr});}}return localExprArray;}if(type==="Linear"){exprArray=getPolyFunctionTokens(coef);}else{if(type==="Exponential"){if(coef.length<2){exprArray.push({v:coef[0]});return exprArray;}if(typeof coef[1]==="string"&&coef[1].slice(0,2)==="Ln"){exprArray.push({v:coef[0]+"e"});exprArray.push({v:"("+coef[1].slice(2)+x+")",isSuper:true});}else{if(coef[1]>0){exprArray.push({v:coef[1]});}else{exprArray.push({v:"("+coef[1]+")"});}exprArray.push({v:"("+x+")",isSuper:true});exprArray.push({v:"*"+coef[0]});}}else{if(type==="Power"){if(coef.length<2){exprArray.push({v:coef[0]});return exprArray;}exprArray.push({v:x});exprArray.push({v:"("+coef[1]+")",isSuper:true});exprArray.push({v:"*"+coef[0]});}else{if(type==="Poly"){exprArray=getPolyFunctionTokens(coef);}else{if(type==="Log"){if(coef.length<2){exprArray.push({v:coef[0]});return exprArray;}res=coef[1]+"ln("+x+")";if(coef[0]!==0){if(coef[0]>0){res+=" + ";res+=coef[0];}else{res+=" - ";res+=(-coef[0]);}}exprArray.push({v:res});}}}}}return exprArray;}function pushElements(array,value,times){var i;for(i=0;i<times;i++){array.push(value);}return array;}function hGetValidValueNum(valArray){var i,validValueNum=0;for(i=0;i<valArray.length;i++){if(valArray[i]!==null){validValueNum++;}}return validValueNum;}function getTrendLineTypeName(type){var name="";switch(type){case"Linear":name=mstrmojo.desc(4888,"Linear");break;case"Exponential":name=mstrmojo.desc(12022,"Exponential");break;case"Power":name=mstrmojo.desc(12023,"Power");break;case"Poly":name=mstrmojo.desc(12024,"Polynomial");break;case"Log":name=mstrmojo.desc(12021,"Logarithmic");break;}return name;}var TrendRefIdentity=mstrmojo.declare(mstrmojo.Base,null,{getTooltipContent:function(){var lb,arr,trendLineModel,tmData,mtxNms,dp,gmCtr,chtInfo,gmm,i,t,def,xvar,xvarType,xvarUnit,key,trendlineFunctionName,value,tp=this.objType,slm=this.lineModel,mtxIdxArr=[],xvarName="x",tooltipContent=[];if(slm){def=slm.def;}if(tp===IDEN_TYPE.TREND_LINE){trendLineModel=slm.trendLineModel;tmData=trendLineModel.tmData;dp=trendLineModel.dp;gmm=dp.lds.gmm;gmCtr=gmm.gmCtr;chtInfo=gmCtr.getChartInfo();mtxIdxArr.push(tmData.mid);if(chtInfo.tp===$CHART_TYPE.BUBBLE||chtInfo.tp===$CHART_TYPE.SCATTER){xvar=tmData["x-vars"];if(xvar!==undefined){mtxIdxArr.push(gmCtr.getMetricIndexFromID(tmData["x-vars"][0]));}}mtxNms=gmm.getMetricNamesFromIndex(mtxIdxArr);tooltipContent.push({n:mstrmojo.desc(14440,"Trendline of"),v:mtxNms.join(", ")});var incBB=false;if(def&&this.lineModel.def.incl===1){incBB=true;}if(chtInfo.isABL&&incBB){var bbAtts=gmCtr.getBreakByAttributes();var bbNms=[],bbElements=[];$ARR.forEach(bbAtts,function(bbA){bbNms.push(bbA.n);});if(bbNms.length>0){var bbSection=this.lineModel.getBBSection();if(bbSection){var bbes=bbSection.bbes;for(i=0;i<bbNms.length;i++){bbElements.push(bbAtts[i].es[bbes[i]].n);}tooltipContent.push({n:bbNms.join(", "),v:bbElements.join(", ")});}}}tooltipContent.push(null);var f=slm.getFormulas();if(f){f=f[0];xvar=tmData["x-vars"];xvarType=tmData["x-types"];if(xvar!==undefined){if(xvarType[0]===$DSSOBJ_TYPES.DssTypeAttribute){xvarUnit=gmCtr.getAttributeById(xvar[0]);if(xvarUnit&&xvarUnit.n){xvarName=xvarUnit.n;}}else{if(xvarType[0]===$DSSOBJ_TYPES.DssTypeMetric){xvarUnit=gmCtr.getMetricIndexFromID(xvar[0]);if(!isNaN(xvarUnit)){xvarUnit=gmm.getMetricNamesFromIndex([xvarUnit]);if(xvarUnit.length>0){xvarName=xvarUnit[0];}}}}}if(f.coefficients){trendlineFunctionName=getTrendLineFunctionTokens.call(this,f.type,f.coefficients,$STR.encodeHtmlString(xvarName,true));tooltipContent.push({n:mstrmojo.desc(14441,"Trendline function"),v:trendlineFunctionName,noTruncate:true,isTrendLineFuncToken:true,skipEncode:true});}for(key in f){if(f.hasOwnProperty(key)){if(key.indexOf("coefficients")<0){t=isNaN(f[key])?f[key]:toFixedAndTrimString(f[key],3);if(key.slice(-2)==="R2"&&(t===0||t==="0")){key=key.slice(0,key.length-2)+"R<sup>2</sup>";value=mstrmojo.desc(6098,"N/A");}else{if(key==="type"){key=mstrmojo.desc(8733,"Type");value=getTrendLineTypeName(f.type);}else{key=(key.slice(-2)==="R2")?key.slice(0,key.length-2)+"R<sup>2</sup>":key;value=GMUTIL.everythingToString(t);}}tooltipContent.push({n:key,v:value,skipEncode:true});}}}}return tooltipContent;}lb=slm.getReferenceLineLabel(false,true);arr=lb.split(":");if(arr.length>1){return[{n:arr[0],v:arr[1]}];}return[];}});var SingleTrendLineModel=mstrmojo.declare(mstrmojo.Base,null,{init:function init(props){this._super(props);var trendLineModel=this.trendLineModel,midx=trendLineModel.midx,mx=trendLineModel.mx,mdls,modc,modix,def;if(mx&&mx[midx]){mdls=mx[midx].mdls;if(mdls){modc=mdls.mod_c;modix=trendLineModel.tmData.modix;def=modc[modix-1];this.def=def;}}else{if(this.isTrendLine===false&&this.trendLineModel.refIsDefOnAxis){this.def=this.trendLineModel.defOnZone;}}},getSeasonalityType:function(){if(this.isTrendLine){return this.trendLineModel.dp.lds.gmm.gmCtr.firstRes.dz.sea;}return 0;},getLevel:function(){var def=this.def,clientDef=def&&def.clientDef;if(clientDef){if(this.isTrendLine){return clientDef.trdLvl;}return clientDef.refLvl;}return -1;},getLineThickness:function(){var def=this.def,clientDef=def&&def.clientDef;if(clientDef){return parseInt(clientDef.trdRefLnThk,10);}return 1;},getLineColor:function(){var def=this.def,clientDef=def&&def.clientDef,strColor;if(clientDef){strColor=clientDef.trdRefLnClr;if(typeof strColor==="string"&&strColor[0]==="#"){GMUTIL.encodeColor(strColor);}return parseInt(clientDef.trdRefLnClr,10);}return 16711680;},getLineRenderType:function(){var def=this.def,clientDef=def&&def.clientDef;if(clientDef){return parseInt(clientDef.trdRefLnStyle,10);}return mstrmojo.chart.enums.EnumLineStyle.LS_DASH;},getTrendLineValuesWithForecast:function(){var startingGroup=this.getTrendLineStartingGroup(),dp=this.trendLineModel.dp,chtInfo=dp.getChartInfo(),xVsForBubble=[],res=[],bwdData,fwdData,fwdXData,isBubble=false,bwdXData;bwdData=this.getBwdData();fwdData=this.getFwdData();if(chtInfo.tp===$CHART_TYPE.BUBBLE||chtInfo.tp===$CHART_TYPE.SCATTER){bwdXData=this.getBwdData(true);fwdXData=this.getFwdData(true);isBubble=true;}if(bwdData&&bwdData.length>0){res=res.concat(bwdData);if(isBubble){xVsForBubble=xVsForBubble.concat(bwdXData);}}else{if(!isBubble){pushElements(res,undefined,startingGroup);}}res=res.concat(this.getTrendLineValues());if(isBubble){xVsForBubble=xVsForBubble.concat(this.getTrendLineValues(true));}if(fwdData&&fwdData.length>0){res=res.concat(fwdData);if(isBubble){xVsForBubble=xVsForBubble.concat(fwdXData);}}else{if(dp.fwdEnabled){if(!isBubble){pushElements(res,undefined,dp.fwdSteps);}}}if(isBubble){return sortAndMergeArray(xVsForBubble,res);}return res;},getTrendLineStartingGroup:function(){var dp=this.trendLineModel.dp;if(dp.bwdEnabled){return dp.bwdSteps;}return 0;},getTrendLineValues:function(xValuesForBubble){if(this.isTrendLine===false){$VISUTILS.visPrint("this function is only for trend line only, for reference line, call getReferenceLineValue instead");return undefined;}var me=this,seriesId=me.seriesId,trendLineModel=me.trendLineModel,tmData=trendLineModel.tmData,trm=tmData.trm,dp=trendLineModel.dp,i,gcnt=dp.innerGetGroupCount(),gc,trVs=[],trV;for(i=0;i<gcnt;i++){gc=dp.innerGetGraphCell(seriesId,i);if(xValuesForBubble){trV=gc.getData(0);}else{trV=gc.getAssoDataWithMetricIndex(trm,true);}trVs.push(trV);}return trVs;},getReferenceLineLabelFont:function(){var def=this.def,fontRes={},clientDef=def&&def.clientDef;if(clientDef){["rfLnFntFml","rfLnFntSz","rfLnFntStyle","rfLnFntClr"].forEach(function(pn){if(pn!=="rfLnFntFml"){fontRes[pn]=parseInt(clientDef[pn],10);}else{fontRes[pn]=clientDef[pn];}});return fontRes;}return{rfLnFntFml:"Verdana",rfLnFntSz:"11pt",rfLnFntStyle:0,rfLnFntClr:0};},getReferenceLineLabel:function(useArr,forTooltip,axisCustomization){var me=this,condense=false,rawValue=this.getReferenceLineValue(),trendLineModel=me.trendLineModel,midx=trendLineModel.midx,mtxNm,dp=trendLineModel.dp,gmm=dp.lds.gmm,numFormat,formattedV,refType,refTypeIndex,ttipName,resText=[],definedOnAxis=!!this.trendLineModel.defOnZone;if(!definedOnAxis){numFormat=gmm.getMetricNumberFormat(midx);mtxNm=gmm.getMetricNamesFromIndex([midx])[0];}else{if(axisCustomization){if(axisCustomization.Condense){condense=true;}else{if(axisCustomization.NumberFormat){numFormat=axisCustomization.NumberFormat;}}}else{var isOnYAxis=trendLineModel.direction==="horizontal",isPrimary=true,r=dp.rowIndex,c=dp.colIndex,index=isOnYAxis?r:c,axisKey=(isOnYAxis?"y":"x")+(isPrimary?"1":"2");numFormat=gmm.gmCtr.axisFormats[axisKey][index];condense=numFormat==="Condensed";}}if(condense){formattedV=CEUtility.abbreviateNumber(rawValue,5);}else{if(numFormat){formattedV=$NUM.formatByMask(numFormat,rawValue);}else{formattedV=rawValue;}}var def=this.def,clientDef=def&&def.clientDef;refType="Average";refTypeIndex=REF_TYPE.AVG;if(!!(def&&def.tp)){refTypeIndex=def.tp;switch(refTypeIndex){case REF_TYPE.MAX:refType=mstrmojo.desc(2125,"Maximum");break;case REF_TYPE.MIN:refType=mstrmojo.desc(2127,"Minimum");break;case REF_TYPE.AVG:refType=mstrmojo.desc(2122,"Average");break;case REF_TYPE.MED:refType=mstrmojo.desc(2126,"Median");break;case REF_TYPE.FIRST:refType=mstrmojo.desc(4046,"First");break;case REF_TYPE.LAST:refType=mstrmojo.desc(4049,"Last");break;case REF_TYPE.CONST:refType=mstrmojo.desc(7194,"Constant");break;}}if(forTooltip===true){if(refTypeIndex===REF_TYPE.CONST&&clientDef&&!!clientDef[ENUM_XML_TAG.REF_LINE_NAME]){ttipName=clientDef[ENUM_XML_TAG.REF_LINE_NAME];}else{ttipName=definedOnAxis?(refType+" Axis"):(refType+" "+mtxNm);}return ttipName+": "+formattedV;}if(clientDef){var refLbShw=clientDef.refLbShw;if(!refLbShw){return"";}var refLbTp=clientDef.refLbTp;if(refLbTp&$RLT.DssModelLabelsType){resText.push(refType);}if(refLbTp&$RLT.DssModelLabelsMetric){if(!definedOnAxis){resText.push(mtxNm);}else{resText.push("Axis");}}if(refLbTp&$RLT.DssModelLabelsValue){resText.push(formattedV);}if(useArr){return resText;}return resText.join(" ");}var txtArr;if(definedOnAxis){txtArr=[refType,"Axis",formattedV];}else{txtArr=[refType,mtxNm,formattedV];}if(useArr){return txtArr;}return txtArr.join(" ");},getReferenceLineValue:function(){return this.trendLineModel.tmData.inChartModel[0].model;},getReferenceLineDirection:function(){return this.trendLineModel.direction;},getBBSection:function(){var me=this,bbIdx,bbSectionModel,trendLineModel=me.trendLineModel,tmData=trendLineModel.tmData,inChartModel=tmData.inChartModel;bbIdx=me.bbIdx;bbSectionModel=inChartModel[bbIdx];return bbSectionModel;},getForcastLabelDataPairs:function(isFwd,useCompact){if(!this.isTrendLine){return undefined;}if(useCompact===undefined){useCompact=true;}var lbs=isFwd?this.getFwdLabels(useCompact):this.getBwdLabels(useCompact),len=lbs.length,res=[],i,data=isFwd?this.getFwdData():this.getBwdData();for(i=0;i<len;i++){res.push({lb:lbs[i],v:data[i]});}return res;},getFwdLabels:function(useCompact){if(!this.isTrendLine){return undefined;}return getForcastLabels.call(this,true,useCompact);},getFormulas:function(){if(!this.isTrendLine){return undefined;}var bbSectionModel=this.getBBSection(),trendModel=bbSectionModel.model;return trendModel.formulas;},getCoefficients:function(extensive){extensive=extensive||false;var holder=this.getFormulas()[0],keywords=["coefficients","coefficients(seasonal)"];if(extensive){return(holder&&(holder[keywords[0]]||holder[[keywords[1]]]))||[];}return(holder&&holder[keywords[0]])||[];},getTrendLineType:function(){var strTypes=["Linear","Exponential","Power","Poly","Log"],enumTypes=[$RegType.DssGraphRegressionLinear,$RegType.DssGraphRegressionExp,$RegType.DssGraphRegressionPow,$RegType.DssGraphRegressionPoly,$RegType.DssGraphRegressionLog],fmls,type,idx;fmls=this.getFormulas();if(fmls){type=fmls[0].type;idx=strTypes.indexOf(type);if(idx>=0){return enumTypes[idx];}}return $RegType.DssGraphRegressionNone;},getFwdData:function(xValuesForBubble){if(!this.isTrendLine){return undefined;}var dp=this.trendLineModel.dp;if(!dp.fwdEnabled){return[];}var bbSectionModel=this.getBBSection(),xVs,chtInfo=dp.getChartInfo(),trendModel=bbSectionModel.model;if(xValuesForBubble){xVs=[];$ARR.forEach(trendModel.fwdins,function(idxArr){xVs.push(idxArr[0]);});return xVs;}if(!bbSectionModel.fse&&chtInfo.isABL){return[];}return trendModel.fwdfsts;},getBwdLabels:function(useCompact){if(!this.isTrendLine){return undefined;}return getForcastLabels.call(this,false,useCompact);},getBwdData:function(xValuesForBubble){if(!this.isTrendLine){return undefined;}var dp=this.trendLineModel.dp;if(!dp.bwdEnabled){return[];}var bbSectionModel=this.getBBSection(),xVs,chtInfo=dp.getChartInfo(),trendModel=bbSectionModel.model;if(xValuesForBubble){xVs=[];$ARR.forEach(trendModel.bwdins,function(idxArr){xVs.push(idxArr[0]);});return xVs;}if(!bbSectionModel.bse&&chtInfo.isABL){return[];}return trendModel.bwdfsts;},getRefLineLabelIdentity:function(){var props={objType:IDEN_TYPE.REF_LINE_LABEL,lineModel:this,tlOpt:this.trendLineOpt};return new TrendRefIdentity(props);},getIdentity:function(){var props={objType:this.isTrendLine?IDEN_TYPE.TREND_LINE:IDEN_TYPE.REF_LINE,lineModel:this,tlOpt:this.trendLineOpt};return new TrendRefIdentity(props);},testSingleTrendLineModel:function(){var seriesId=this.seriesId,trVs;if(this.isTrendLine){trVs=this.getTrendLineValues();$VISUTILS.visPrint("trend line values for seriers "+seriesId+" : "+JSON.stringify(trVs));$VISUTILS.visPrint("fwd info :"+JSON.stringify(this.getForcastLabelDataPairs(true,true)));$VISUTILS.visPrint("bwd info :"+JSON.stringify(this.getForcastLabelDataPairs(false,true)));$VISUTILS.visPrint("values including forecast: "+JSON.stringify(this.getTrendLineValuesWithForecast()));}else{trVs=this.getReferenceLineValue();$VISUTILS.visPrint("reference line  for "+this.getReferenceLineLabel()+" : "+JSON.stringify(trVs));$VISUTILS.visPrint("direction of reference line is "+this.getReferenceLineDirection());}$VISUTILS.visPrint("thickness: "+this.getLineThickness());$VISUTILS.visPrint("line color "+this.getLineColor());$VISUTILS.visPrint("line style "+this.getLineRenderType());$VISUTILS.visPrint("-------------------------------------------------------------------");}});mstrmojo.gm.TrendLineModel=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.gm.TrendLineModel",isTrendLine:undefined,init:function init(props){this._super(props);},getValidSeriesIndex:function(){var tmData=this.tmData,trm=tmData.trm,dp=this.dp,i,j,seriesIds=this.seriesIds,scnt=seriesIds.length,gcnt=dp.innerGetGroupCount(),trVs,gc,trV,seriesId;for(i=0;i<scnt;i++){seriesId=seriesIds[i];trVs=[];for(j=0;j<gcnt;j++){gc=dp.innerGetGraphCell(seriesId,j);trV=gc.getAssoDataWithMetricIndex(trm,true);trVs.push(trV);}if(hGetValidValueNum(trVs)>1){return i;}}return 0;},getSingleTrendLines:function(trendLineInfo){var me=this,modelDataFromJSON=this.tmData,seriesBBUnits=this.seriesBBUnits,seriesIds=this.seriesIds,i=0,inChartModel=modelDataFromJSON.inChartModel,singleLineModels=[],bbes,indexOfBBesInSeriesIds,sId;$ARR.forEach(inChartModel,function(singleBBModel){bbes=singleBBModel.bbes;if(bbes){indexOfBBesInSeriesIds=GMUTIL.indexOf(seriesBBUnits,bbes);}else{if(me.isTrendLine){indexOfBBesInSeriesIds=me.getValidSeriesIndex();}else{indexOfBBesInSeriesIds=0;}}sId=seriesIds[indexOfBBesInSeriesIds];singleBBModel.seriesId=sId;singleLineModels.push(new SingleTrendLineModel({trendLineModel:me,bbIdx:i,seriesId:sId,isTrendLine:me.isTrendLine,trendLineOpt:me.trendLineOpt}));i++;});if(me.isTrendLine&&trendLineInfo){$ARR.forEach(singleLineModels,function(sLine){var lineFwdLb=sLine.getFwdLabels(false);var lineBwdLb=sLine.getBwdLabels(false);if(trendLineInfo.fwdLbs===undefined||trendLineInfo.fwdLbs.length<lineFwdLb.length){trendLineInfo.fwdLbs=lineFwdLb;}if(trendLineInfo.bwdLbs===undefined||trendLineInfo.bwdLbs.length<lineBwdLb.length){trendLineInfo.bwdLbs=sLine.getBwdLabels(false);}});}return singleLineModels;}});}());
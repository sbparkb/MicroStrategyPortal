(function(){function transformAreaColorMap(areaColorMap){var colorAreaMap={};if(!areaColorMap){return null;}var state,color;for(state in areaColorMap){color=areaColorMap[state];if(colorAreaMap[color]){colorAreaMap[color]+=", '"+state+"'";}else{colorAreaMap[color]="'"+state+"'";}}return colorAreaMap;}mstrmojo._HasColorCodedArea=mstrmojo.provide("mstrmojo._HasColorCodedArea",{_mixinName:"mstrmojo._HasColorCodedArea",layer:null,highlightedLayer:null,areaColors:null,polyOptions:null,defaultPolyOption:null,areaCodeColumnName:null,totalColors:0,colorMap:null,createColorCodedArea:function createColorCodedArea(fusionTableId,geoColumnName,areaCodeColumnName,areaListToShow){var whereClause=areaListToShow.join(","),queryObject={select:geoColumnName,from:fusionTableId};if(whereClause.length>0){queryObject.where=areaCodeColumnName+" IN ("+whereClause+")";}this.layer=new window.google.maps.FusionTablesLayer({query:queryObject,suppressInfoWindows:true});this.highlightedLayer=new window.google.maps.FusionTablesLayer({query:{select:geoColumnName,from:fusionTableId},suppressInfoWindows:true});this.areaCodeColumnName=areaCodeColumnName;},addAreaColor:function addAreaColor(areaName,color){if(this.areaColors===null){this.areaColors={};this.colorMap={};}this.areaColors[areaName]=color;if(!this.colorMap[color]){this.colorMap[color]="'"+areaName+"'";this.totalColors++;}},resetAreaColors:function resetAreaColors(){this.areaColors={};this.colorMap={};this.totalColors=0;},getColorCount:function getColorCount(){return this.totalColors;},showColorCodedArea:function showColorCodedArea(map){if(this.layer===null){return ;}var stylesArr=[];if(this.defaultPolyOption===null){stylesArr[0]={polygonOptions:{fillColor:"#5a709c",fillOpacity:0.7,strokeColor:"#FFFFFF",strokeWeight:1}};}else{stylesArr[0]=this.defaultPolyOption;}var colorsMap=transformAreaColorMap(this.areaColors);if(colorsMap){var i=1,stateColor;for(stateColor in colorsMap){var polyOption={fillColor:stateColor,fillOpacity:0.7};stylesArr[i++]={where:this.areaCodeColumnName+" IN ("+colorsMap[stateColor]+")",polygonOptions:polyOption};}}this.layer.set("styles",stylesArr);this.layer.setMap(map);},addColorCodedAreaListener:function addColorCodedAreaListener(eventType,listenerFunction){if(!this.layer){return null;}var listenerIds=[];listenerIds[0]=window.google.maps.event.addListener(this.layer,eventType,listenerFunction);listenerIds[1]=window.google.maps.event.addListener(this.highlightedLayer,eventType,listenerFunction);return listenerIds;},removeColorCodedAreaListener:function removeColorCodedAreaListener(listenerIds){if(!listenerIds){return ;}window.google.maps.event.removeListener(listenerIds[0]);window.google.maps.event.removeListener(listenerIds[1]);},highlightArea:function highlightArea(areasToHighlight){this.highlightedLayer.setMap(null);if(!areasToHighlight||areasToHighlight.length===0){return ;}var areaList=areasToHighlight.join(",");this.highlightedLayer.query.where=this.areaCodeColumnName+" IN ("+areaList+")";this.highlightedLayer.setMap(this.map);}});}());
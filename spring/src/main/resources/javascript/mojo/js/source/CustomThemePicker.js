(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ObjectBrowser","mstrmojo.RadioListHoriz");mstrmojo.CustomThemePicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.CustomThemePicker",cssClass:"mstrmojo-CustomThemePicker",zIndex:9,title:mstrmojo.desc(14567,"Select Document Theme"),help:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:36,applyAsLink:false,showApplyAsOptions:true,item:null,onThemePicked:null,children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",closeable:false,browsableTypes:"8,14082",closeOnSelect:false,showCompletePath:false,searchVisible:false,multiSelect:false,upButtonVisible:true,scrollableIncFetch:true,bindings:{rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId"}},{scriptClass:"mstrmojo.RadioListHoriz",bindings:{selectedIndex:function(){return this.parent.applyAsLink?1:0;},visible:"this.parent.showApplyAsOptions"},items:[{n:mstrmojo.desc(14480,"apply as copy")},{n:mstrmojo.desc(14481,"apply as link")}],onchange:function onchange(){var idx=this.selectedIndex;this.parent.applyAsLink=(idx===1);}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btnHBox",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function onclick(){var editor=this.parent.parent,item=editor.item;this.parent.parent.close({item:item});var fn=editor.onThemePicked;if(fn&&item){fn(item.did,editor.applyAsLink,editor.getCurrentFolderPath()+item.n);}editor.set("item",null);},bindings:{enabled:function enabled(){return !!this.parent.parent.item;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancel"),onclick:function onclick(){var editor=this.parent.parent;this.parent.parent.close();editor.set("item",null);}}]}],preBuildRendering:function preBuildRendering(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];},onOpen:function onOpen(){if(this._super){this._super();}this.browse();},onOBSelect:function onOBSelect(item){this.set("item",item);},browse:function browse(){this.ob.browse();},getCurrentFolderPath:function getCurrentFolderPath(){var cf=this.ob.currentFolder,path="\\";while(cf){path="\\"+cf.n+path;cf=cf.anc&&cf.anc.items&&cf.anc.items[0];}return path;}});}());
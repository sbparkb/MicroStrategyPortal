(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.ACL.UserDataService","mstrmojo.onetier.vi.prefs.HostedDesktopConnectivityProxy","mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy","mstrmojo.func");function addErrorHandling(callback){return mstrmojo.func.wrapMethods(callback,{failure:function(res){mstrmojo.onetier.vi.prefs.handleErrorMessage(res);}});}mstrmojo.onetier.vi.acl.UserDataService=mstrmojo.provide("mstrmojo.onetier.vi.acl.UserDataService",{topgroups:null,userCandidates:null,getConnectivityProxy:function getConnectivityProxy(){return mstrApp.isSingleTier?new mstrmojo.onetier.vi.prefs.DesktopConnectivityProxy():new mstrmojo.onetier.vi.prefs.HostedDesktopConnectivityProxy();},getMembers:function(params,callbacks){var taskParams={blockBegin:params.blockBegin,blockCount:params.blockCount,userEntityID:params.data.did,userEntityName:params.data.n||"",incremental:"true",outputElements:params.outputElements||3,sessionState:this.oneTierConnectivity.sessionState,connectionId:this.oneTierConnectivity.connectionId};this.getConnectivityProxy().getUserEntityInfo(taskParams,addErrorHandling(callbacks));},getTopLevelGroups:function getTopLevelGroups(params,callbacks){var me=this;if(this.topgroups){callbacks.success({items:this.topgroups});return ;}callbacks.success=mstrmojo.func.composite([callbacks.success,function(res){me.topgroups=res.items;}]);this.getUsers({topGroupsOnly:"true"},callbacks);},searchUserCandidates:mstrmojo.ACL.UserDataService.searchUserCandidates,getUserCandidates:mstrmojo.ACL.UserDataService.getUserCandidates,getUsers:function getUsers(params,callbacks){params.connectionId=this.oneTierConnectivity.connectionId;params.sessionState=this.oneTierConnectivity.sessionState;this.getConnectivityProxy().getUserServices(params,addErrorHandling(callbacks));}});}());
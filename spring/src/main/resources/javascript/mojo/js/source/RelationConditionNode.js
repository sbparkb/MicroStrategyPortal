(function(){var _E=mstrmojo.expr,_ET=_E.ET,_C=mstrmojo.css,_D=mstrmojo.dom,getAttrSetText=function(me){var d=me.data,dmy=d.dmy&&d.dmy.uts||[],len=dmy.length,txt=[],i;for(i=0;i<len;i++){txt.push(dmy[i].n);}return'<span class="mstrmojo-text">'+txt.join(",")+"</span>";};mstrmojo.RelationConditionNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsExprNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.RelationConditionNode",markupString:'<div id="{@id}" class="mstrmojo-relation {@cssClass}"  style="position:relative;{@cssText}"><div class="mstrmojo-onhoverparent mstrmojo-relation-prefix {@cssClass}" mstrAttach:mousedown><span class="mstrmojo-textset mstrmojo-relation-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><img class="mstrmojo-outdent disable" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5896,"Ungroup conditions")+'" /><img class="mstrmojo-outdent" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5896,"Ungroup conditions")+'"onclick="mstrmojo.all[\'{@id}\'].out()" /><img class="mstrmojo-indent disable" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5895,"Group conditions")+'" /><img class="mstrmojo-indent" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5895,"Group conditions")+'"onclick="mstrmojo.all[\'{@id}\'].ind()" /></span></div><div class="mstrmojo-relationNode"><span class="mstrmojo-relationNode-inf"><span class="mstrmojo-relation-prefix-text">'+mstrmojo.desc(2790,"Set of").replace(/##/g,"")+'</span><span class="mstrmojo-textset"  mstrAttach:click></span><span class="mstrmojo-relation-postfix-text">'+mstrmojo.desc(2793,"Where").replace(/##/g,"")+'</span><span class="mstrmojo-relation-convert-text"  mstrAttach:click >'+mstrmojo.desc(null,"Convert to Condition")+'</span><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></span><div class="mstrmojo-relation-childTreeNode" style="position:relative;"></div></div></div>',markupSlots:{prefixNode:function(){return this.domNode.firstChild.firstChild;},relationNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1];},convertNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[3];},containerNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{onprefixedAndOrEditableChange:function(){_C.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){_C.toggleClass(this.relationNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=getAttrSetText(this);}},children:[{scriptClass:"mstrmojo.FilterExpr",alias:"ndsWdt",getItemConfig:function(item,idx,widget){var andor=(item.et===_ET.ANDOR),t=widget.tree||widget;return{data:item,tree:t,parent:widget,prefixedAndOrEditable:false,itemFunction:andor?widget.itemFunction:null,draggable:false,dropZone:false,allowDrop:false,allowCopy:false,editable:true,makeObservable:andor&&widget.makeObservable,onclick:t.onnodeclick,onmousedown:null,forbidRelation:true};},onnodeclick:function(evt){var t=this.tree.parent.tree;if(t.onnodeclick){evt.editor=t.editor;t.onnodeclick.call(this,evt);}}}],init:function(props){this._super(props);var d=this.data;if(d){delete this.data;this._set_data(null,d);}},_set_data:function(n,v){var vWas=this.data,chg=(vWas!==v);if(chg){this.data=v;if(v&&v.nds){this.ndsWdt.set("items",v.nds);}}return chg;},preclick:function pc(evt){var p=null,t=_D.eventTarget(evt.hWin,evt.e);if(_D.contains(this.prefixNode,t,true)){p="andor";}else{if(_D.contains(this.textNode,t,true)){p="createSet";}else{if(_D.contains(this.convertNode,t,true)){this.parent.removeSet(this);_D.stopPropogation(evt.hWin,evt.e);return false;}}}evt.part=p;},del:function del(){var p=this.parent;if(p&&p.remove&&this.data){p.remove(this.data);}}});})();
(function(){mstrmojo.requiresCls("mstrmojo.prompt.WebConstantPrompt","mstrmojo.prompt.WebGeoConstantPrompt","mstrmojo.prompt.WebElementsPrompt","mstrmojo.prompt.WebUnsupportedPrompt","mstrmojo.XMLBuilder");mstrmojo.prompt.WebPrompts=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.prompt.WebPrompts",lcl:1033,host:null,mergeGeoPrompts:true,init:function init(props){var rsl=props.rsl;delete props.rsl;this._super(props);this.populate(rsl);},get:function(index){var ps=this.prompts;if(ps&&index<ps.length){return ps[index];}alert("index is out of boundary.");},size:function size(){var ps=this.prompts;return(ps&&ps.length)||0;},isEmpty:function isEmpty(){return !this.prompts||!!this.prompts.length;},validate:function validate(){var ps=this.prompts,i;for(i=0;i<ps.length;i++){ps[i].validate();}return true;},populate:function populate(rsl){var prompts=rsl&&rsl.prompts,$T=mstrmojo.prompt.PromptTypes,mgp=this.mergeGeoPrompts,geo;this.lcl=(rsl&&rsl.lcl)||this.lcl;this.prompts=[];if(prompts){var i;for(i=0;i<prompts.length;i++){var p=prompts[i],pm;switch(p.ptp){case $T.CONSTANT_PROMPT:pm=new mstrmojo.prompt.WebConstantPrompt();pm.populate(p);if(mgp&&pm.prs&&pm.prs.DisplayStyle==="GeoLocation"){if(!geo){geo=new mstrmojo.prompt.WebGeoConstantPrompt();geo.title="Current Location";geo.add(pm);pm=geo;}else{geo.add(pm);continue;}}break;case $T.ELEMENTS_PROMPT:pm=new mstrmojo.prompt.WebElementsPrompt();pm.populate(p);break;default:pm=new mstrmojo.prompt.WebUnsupportedPrompt();pm.populate(p);}this.prompts.push(pm);}}},populateAnswers:function populateAnswers(answers){var prompts=this.prompts,i;for(i=0;i<answers.length;i++){prompts[i].populateAnswer(answers[i]);}},buildAnswerObject:function buildAnswerObject(){var ob=[],i;for(i=0;i<this.size();i++){var p=this.prompts[i];ob.push(p.buildAnswerObject());}return ob;},prepareAnswer:function(callbacks){var ps=this.prompts,prep=function(ps,i,callbacks){var len=ps.length;ps[i].prepareAnswer({success:function(){if(i<len-1){prep(ps,i+1,callbacks);}else{if(callbacks&&callbacks.success){callbacks.success();}}},failure:function(){if(callbacks&&callbacks.failure){callbacks.failure();}}});};if(ps&&ps.length>0){prep(this.prompts,0,callbacks);}},getAnswerXML:function getAnswerXML(){var buf=new mstrmojo.XMLBuilder();this.buildShortAnswerXML(buf);return buf.toString();},buildShortAnswerXML:function buildShortAnswerXML(builder){builder=builder||new mstrmojo.XMLBuilder();builder.addChild("rsl");builder.addAttribute("lcl",this.lcl);var i;for(i=0;i<this.size();i++){var p=this.prompts[i];p.buildShortPa(builder);}builder.closeElement();},hasSupported:function hasSupported(){var i;for(i=0;i<this.size();i++){var p=this.prompts[i];if(p.supported()){return true;}}return false;}});mstrmojo.prompt.PromptTypes={CONSTANT_PROMPT:1,CONSTANT_GEO_PROMPT:1.5,ELEMENTS_PROMPT:2,OBJECT_PROMPT:4};mstrmojo.Enum={};mstrmojo.Enum.Validation={};mstrmojo.Enum.Validation.STATUSCODE={VALID:0,INVALID_DATATYPE:1,EXCEEDS_MIN_VALUE:2,EXCEEDS_MAX_VALUE:3,EXCEEDS_MIN_LENGTH:4,EXCEEDS_MAX_LENGTH:5,EXCEEDS_MIN_COUNT:6,EXCEEDS_MAX_COUNT:7,INVALID_ANSWERS:8,NO_INPUT:9,NO_PERSONAL_ANSWER_NAME:10,INCOMPLETE_CONDITION:11,TRUNCATED:12,INCOMPLETE_CONDITION_ON_AUTO_NODE:13,INVALID_PERSONAL_ANSWER_NAME:14,DUPLICATED:15,INVALID:999};}());
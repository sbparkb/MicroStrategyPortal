(function(){mstrmojo.requiresCls("mstrmojo.DataGrid","mstrmojo.DI.DIConstants","mstrmojo.CheckBox","mstrmojo.Container","mstrmojo._HasOwnAvatar","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.HBox","mstrmojo.Label","mstrmojo.ui.SearchBox","mstrmojo.DI.DIMappingItem","mstrmojo.DI.DIAllObjectsMappingMenu");mstrmojo.requiresDescs(191,192,962,2461,3581,7755,11611,11805,12665,12666,14029);var $DOM=mstrmojo.dom,$CSS=mstrmojo.css,$ARR=mstrmojo.array,$HASH=mstrmojo.hash,constants=mstrmojo.DI.DIConstants,ACTION_ATTR_TO_METR="ConvertAttributeToMetric",ACTION_METR_TO_ATTR="ConvertMetricToAttribute",SEARCH_INDEX_COLUMN_ID=0,_MenuHelper=null,SELECTION_STATE={ALL:"select-all",NON:"unselect-all",PART:"select-some"},ObjectType={Attribute:"amps",Metric:"mtmps"},SearchIndexDataTypes=[3,11];function getColSrcNames(model,col){var source=model.findMappingSource(col);var names=[];$ARR.forEach(source,function getName(element){names.push(element.sourceInfo.name);});return names;}function getMappingItems(type){var mappings=mstrApp.getRootController().allObjectsController.getAllMappings();if(!mappings||!mappings.length){return null;}var objects=$ARR.filter(mappings,function isType(element){return element.type===type;});var i,obj;var items=[];for(i=0;i<objects.length;i++){obj=objects[i];items.push({n:obj.alias,tp:obj.tp,col:obj,idx:i,isLinked:obj.isLinked});}return items;}function getMenuHelper(){if(!_MenuHelper){_MenuHelper=new mstrmojo.DI.DIAllObjectsMappingMenu();}return _MenuHelper;}function getObjectColId(type){return type===ObjectType.Attribute?1:0;}function isIndexTypeAccepted(type){var idx=$ARR.indexOf(SearchIndexDataTypes,type);return idx===-1?false:true;}function setTripleState(select,unselect){if(unselect){this.set("state",SELECTION_STATE.NON);}else{if(select){this.set("state",SELECTION_STATE.ALL);}else{this.set("state",SELECTION_STATE.PART);}}}function initSidxes(model,items){var sidxes=model.cubeConfig.sidxes;var set_num=0,total=sidxes.length;var i,j,k;for(i=0;i<items.length;i++){if(set_num===total){break;}var at=items[i].col;if(!at.isMultiForm){at.indexOn=false;}for(j=0;j<sidxes.length;j++){if(at.id===sidxes[j].atid){if(!at.isMultiForm){at.indexOn=true;set_num++;break;}else{for(k=0;k<at.subColumns.length;k++){if(at.subColumns[k].fmid===sidxes[j].afid){at.subColumns[k].indexOn=true;set_num++;break;}}}}}}}function initMappingItem(props){this.data=props;this.type=props.tp;this.name=props.alias;this.tooltip=props.alias;this.georole=props.georole;this.timerole=props.timerole;if(props.isLinked){this.cssClass+=" linked";}this.setSubtype();}function createMappingItemColumn(col_w){var controller=this;var col={headerWidget:{scriptClass:"mstrmojo.DI.HeaderWidget",text:(this.type==="amps"?mstrmojo.desc(3581,"Attributes"):mstrmojo.desc(962,"Metrics")),menuController:controller,field:"n",cm:[{n:mstrmojo.desc(191,"Sort Ascending"),did:"ASC"},{n:mstrmojo.desc(192,"Sort Descending"),did:"DES"}]},colWidth:col_w,dataWidgetBuilder:function(d){var w=null;if(d.col.isMultiForm){var forms=d.col.subColumns;w={scriptClass:"mstrmojo.Box",cssClass:"multiform-attribute cf",at:d.col,children:[{scriptClass:"mstrmojo.Button",cssClass:"mfa-status-button",onclick:function onclick(){this.parent.toggleState();}},{scriptClass:"mstrmojo.DI.DIMappingItem",allowEdit:false,oncontextmenu:mstrmojo.emptyFn,postCreate:function(){var map=this.parent.at;initMappingItem.call(this,map);}},{scriptClass:"mstrmojo.ui.List",cssClass:"attribute-forms-list",items:forms,getItemDisplayName:function getItemDisplayName(item){return item.alias+"@"+item.fmn;},oncontextmenu:function(evt){$DOM.preventDefault(window,evt.e);this.onclick(evt);var src=$DOM.eventTarget(evt.hWin,evt.e);var menuHelper=getMenuHelper();var data=[this.selectedItem];menuHelper.target=this;menuHelper.data=data;menuHelper.type=constants.contextMenuType.ITEM_MENU;menuHelper.position=$DOM.position(this.domNode);var cfg=menuHelper.getMenuConfig(),menuHost=this.parent.dataGrid;cfg.hostId=menuHost.id;cfg.hostElement=src;cfg.isHostedWithin=false;menuHost.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:cfg}));},onchange:function onselectionChange(){this.parent.dataGrid.hightlightAttFormList=this;}}],onclick:function onclick(evt){var target=evt.target||$DOM.eventTarget(evt.hWin,evt.e);var w=$DOM.findWidget(target);if(w===this){this.collapse=!this.collapse;this.toggleState();}},toggleState:function(){this.collapse=!this.collapse;var rowNode=this.domNode.parentNode.parentNode;$CSS.toggleClass(rowNode,"collapse",this.collapse);}};}else{w={scriptClass:"mstrmojo.DI.DIMappingItem",cssClass:"sfa",allowEdit:false,oncontextmenu:mstrmojo.emptyFn,postCreate:function(){var map=this.parent.data.col;initMappingItem.call(this,map);}};}return w;}};return col;}function createSourceTableColumn(col_w){var col={headerText:mstrmojo.desc(7755,"Table"),colWidth:col_w,dataWidgetBuilder:function(d){var w=null,model=mstrApp.getRootController().model,srcNames,importSrcs=mstrApp.getRootController().allObjectsController.getAllImportSources();var srcTotalNum=$HASH.keyarray(importSrcs).length;if(importSrcs.length===0){return ;}if(d.col.isMultiForm){w={scriptClass:"mstrmojo.Box",cssClass:"multiform-attribute-src-box",children:[{scriptClass:"mstrmojo.DI.DIAllObjectsSourceLabel",cssClass:"attribute-form-label"},{scriptClass:"mstrmojo.Box",cssClass:"attribute-forms-src-list",alias:"srcTableCount",children:[]}]};var i,subCols=d.col.subColumns,mfaLabel=w.children[0],formsList=w.children[1];for(i=0;i<subCols.length;i++){srcNames=getColSrcNames(model,subCols[i]);formsList.children.push({scriptClass:"mstrmojo.DI.DIAllObjectsSourceLabel",cssClass:"attribute-form-label",text:srcNames.length+"/"+srcTotalNum,src:srcNames,total:srcTotalNum});if(subCols[i].isIdForm){mfaLabel.text=srcNames.length+"/"+srcTotalNum;mfaLabel.src=srcNames;mfaLabel.total=srcTotalNum;}}}else{srcNames=getColSrcNames(model,d.col);w={scriptClass:"mstrmojo.DI.DIAllObjectsSourceLabel",cssClass:"attribute-form-label",text:srcNames.length+"/"+srcTotalNum,src:srcNames,total:srcTotalNum};}return w;}};return col;}function createSearchIndexColumn(col_w){var grid=this;var col={colWidth:col_w,headerCss:"mstrmojo-di-samplefiles-col1header",headerWidget:{scriptClass:"mstrmojo.ImageCheckBox",label:mstrmojo.desc(12665,"Search Index"),state:SELECTION_STATE.NON,enabled:false,onclick:function(){if(this.state===SELECTION_STATE.ALL){this.set("state",SELECTION_STATE.NON);this.dataGrid.initSearchIndex(false);}else{this.set("state",SELECTION_STATE.ALL);this.dataGrid.initSearchIndex(true);}grid.raiseEvent({name:"searchIndexChange"});},onstateChange:function(){$CSS.removeClass(this.inputNode,[SELECTION_STATE.ALL,SELECTION_STATE.NON,SELECTION_STATE.PART]);$CSS.addClass(this.inputNode,this.state);},updateState:function(){var gridView=this.dataGrid;var items=gridView.items;var n=items.length;var i,select_all=true,select_non=true,state,cwCnt=0;for(i=0;i<n;i++){var cw=gridView.getCellWidget(i,SEARCH_INDEX_COLUMN_ID);if(cw){state=items[i].col.isMultiForm?cw.mfaIndexControl.state:cw.checked;if(state===SELECTION_STATE.ALL||state===true){select_non=false;}else{if(state===SELECTION_STATE.PART){select_non=false;select_all=false;}else{select_all=false;}}cwCnt=true;}}setTripleState.call(this,select_all,select_non);this.set("enabled",cwCnt>0);}},dataWidgetBuilder:function(d){var w=null;if(d.col.isMultiForm){w={scriptClass:"mstrmojo.Box",cssClass:"multiform-attribute-index-box",at:null,children:[{scriptClass:"mstrmojo.ImageCheckBox",markupString:'<span id="{@id}" class="mstrmojo-CheckBox mstrmojo-ImageCheckBox {@cssClass}" style="{@cssText}" title="{@tooltip}"><input id="{@id}_input" class="{@cssClass}" type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click tstid="{@tstid}"/><label for="{@id}_input">{@label}</label></span>',alias:"mfaIndexControl",bindings:{checked:"this.parent.data.col.indexOn"},state:SELECTION_STATE.NON,getHeaderCheckBox:function(){return this.parent.dataGrid._headerWidgets_[SEARCH_INDEX_COLUMN_ID];},oncheckedChange:function handleStatusChange(evt){this.parent.data.col.indexOn=evt.value;this.parent.dataGrid._headerWidgets[SEARCH_INDEX_COLUMN_ID].enabled=true;},onstateChange:function(){$CSS.removeClass(this.inputNode,[SELECTION_STATE.ALL,SELECTION_STATE.NON,SELECTION_STATE.PART]);$CSS.addClass(this.inputNode,this.state);var headerCheckBox=this.getHeaderCheckBox();headerCheckBox.updateState();},onclick:function onclick(){if(this.state===SELECTION_STATE.ALL){this.set("state",SELECTION_STATE.NON);this.set("checked",false);}else{this.set("state",SELECTION_STATE.ALL);this.set("checked",true);}var formsList=this.parent.formsList.children,checked=this.checked;$ARR.forEach(formsList,function updateStatus(childCheckbox){if(childCheckbox.enabled){childCheckbox.set("checked",checked);}});grid.raiseEvent({name:"searchIndexChange"});},updateByForms:function udpateByForms(){var formsList=this.parent.formsList.children,checked=false,allChecked=true,nonChecked=true;$ARR.forEach(formsList,function updateStatus(childCheckbox){if(childCheckbox.enabled){if(childCheckbox.checked){checked=true;nonChecked=false;}else{allChecked=false;}}});setTripleState.call(this,allChecked,nonChecked);this.set("checked",checked);}},{scriptClass:"mstrmojo.Box",cssClass:"attribute-forms-index-list",alias:"formsList",children:[]}]};var i,formsList=w.children[1],subCols=d.col.subColumns,indexEnable=false,allChecked=true,nonChecked=true,state;for(i=0;i<subCols.length;i++){formsList.children.push({scriptClass:"mstrmojo.ImageCheckBox",checked:subCols[i].indexOn,afidx:i,enabled:true,oncheckedChange:function handleStatusChange(evt){d.col.subColumns[this.afidx].indexOn=evt.value;},onclick:function onclick(){this.parent.parent.mfaIndexControl.updateByForms();grid.raiseEvent({name:"searchIndexChange"});}});if(!isIndexTypeAccepted(subCols[i].dtp)){formsList.children[i].cssText="visibility:hidden;";formsList.children[i].enabled=false;}else{indexEnable=true;if(subCols[i].indexOn){nonChecked=false;}else{allChecked=false;}}}if(nonChecked){state=SELECTION_STATE.NON;}else{if(allChecked){state=SELECTION_STATE.ALL;}else{state=SELECTION_STATE.PART;}}w.children[0].state=state;w.children[0].cssClass=state;if(!indexEnable){w.cssText="visibility:hidden;";w.children[0].enabled=false;}}else{if(isIndexTypeAccepted(d.col.dtp)){w={scriptClass:"mstrmojo.ImageCheckBox",bindings:{checked:"this.parent.data.col.indexOn"},getHeaderCheckBox:function(){return this.dataGrid._headerWidgets_&&this.dataGrid._headerWidgets_[SEARCH_INDEX_COLUMN_ID];},oncheckedChange:function handleStatusChange(evt){this.parent.data.col.indexOn=evt.value;this.dataGrid._headerWidgets[SEARCH_INDEX_COLUMN_ID].enabled=true;},onclick:function(){var headerCheckBox=this.getHeaderCheckBox();headerCheckBox.updateState();grid.raiseEvent({name:"searchIndexChange"});}};}}return w;},dataFunction:function(){return"";}};return col;}function shouldSearchIndexEnable(type){return type===ObjectType.Attribute&&mstrApp.getRootController().allObjectsController.isCubeConfigEnabled();}mstrmojo.DI.DIAllObjectsGrid=mstrmojo.declare(mstrmojo.DataGrid,[mstrmojo._HasOwnAvatar,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.DI.DIAllObjectsGrid",type:null,resizableColumns:false,lockHeader:true,multiSelect:true,selectionPolicy:"reselect",draggable:true,dropZone:true,allItems:null,sortFlag:true,markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,click><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',isDragValid:function isDragValid(){return true;},allowDrop:function allowDrop(context){var isAllow=false;if(context.action===ACTION_ATTR_TO_METR&&this.type===ObjectType.Metric){isAllow=true;}else{if(context.action===ACTION_METR_TO_ATTR&&this.type===ObjectType.Attribute){isAllow=true;}}return isAllow;},createAvatar:function createAvatar(sourceNode){var objColId=getObjectColId(this.type);var div=document.createElement("div");var item=$DOM.findAncestorByName(sourceNode,"tr",true,this.domNode);if(item){var selectedIndices=this.sortSelectedIndices(),rowNodes=this.domNode.getElementsByTagName("tr"),idx,rowNode;$ARR.forEach(selectedIndices,function(index){idx=1+parseInt(index,10);rowNode=rowNodes[idx];div.appendChild(rowNode.children[objColId].firstChild.cloneNode(true));});}var hintNode=document.createElement("div");div.appendChild(hintNode);div.className="mstrmojo-all-objects-avatar";hintNode.className="avatar-hint";return div;},createCols:function createCols(){var columns=[];if(shouldSearchIndexEnable(this.type)){columns.push(createSearchIndexColumn.call(this,30));}columns.push(createMappingItemColumn.call(this,50));columns.push(createSourceTableColumn.call(this,20));this.columns=columns;},filterItems:function filterItems(pattern){var me=this;if(pattern===undefined){pattern=this.searchPattern;}if(pattern===undefined){return ;}var items=$ARR.filter(this.allItems,function filterName(item){var name=item.n.toLowerCase();var p=pattern.toLowerCase();return ~name.indexOf(p);});this.set("searchPattern",pattern);this.set("items",items);this.sort("n",this.sortFlag);setTimeout(function(){if(me.type===ObjectType.Attribute&&me._headerWidgets_){me._headerWidgets_[SEARCH_INDEX_COLUMN_ID].updateState();}});},getAllItems:function getallItems(){return this.allItems;},getCellWidget:function getCell(i,j){var dataTable=this.itemsContainerNode.firstChild;var row=dataTable.rows[i];if(row){return mstrmojo.dom.findWidget(row.cells[j].firstChild);}},getDragAction:function getDragAction(){return this.type===ObjectType.Attribute?ACTION_ATTR_TO_METR:ACTION_METR_TO_ATTR;},getDragData:function getDragData(context){var el=$DOM.eventTarget(context.src.hWin,context.src.e);var idx=this.listMapper.findIndex(this,this.itemsContainerNode,el);if(idx>=0&&this.selectedIndices[idx]!==true){this.raiseEvent({name:"beginSelectionItem"});this.singleSelect(idx);}return this.getSelObjs();},getSearchIdxes:function getSearchIdxes(){var items=this.items;var n=items.length;var sidxes=[];var col,i,j;for(i=0;i<n;i++){col=items[i].col;if(!col.isMultiForm){if(col.indexOn){sidxes.push({atid:col.id,afid:col.fmid});}}else{for(j=0;j<col.subColumns.length;j++){if(col.subColumns[j].indexOn){sidxes.push({atid:col.id,afid:col.subColumns[j].fmid});}}}}$ARR.forEach($ARR.difference(this.allItems,this.items),function(item){var col=item.col;if(!col.isMultiForm){if(col.indexOn){sidxes.push({atid:col.id,afid:col.fmid});}}else{for(j=0;j<col.subColumns.length;j++){if(col.subColumns[j].indexOn){sidxes.push({atid:col.id,afid:col.subColumns[j].fmid});}}}});return sidxes;},getSelObjs:function getSelObjs(){var selectedItems=this.getSelectedItems();var data=[];$ARR.forEach(selectedItems,function(item){data.push(item.col);});return data;},init:function(props){if(this._super){this._super(props);}this.model=mstrApp.getRootController().model;this.createCols();this.updateItems();this.model.attachEventListener("CurrentSourceChanged",this.id,"updateItems");this.model.attachEventListener("MappingsFetched",this.id,"updateItems");},initSearchIndex:function initSearchIndex(value){var items=this.items;var n=items.length;var i,state;for(i=0;i<n;i++){var cw=this.getCellWidget(i,SEARCH_INDEX_COLUMN_ID);if(cw){if(items[i].col.isMultiForm){state=value?SELECTION_STATE.ALL:SELECTION_STATE.NON;cw.mfaIndexControl.set("state",state);$ARR.forEach(cw.formsList.children,function(sw){if(sw.enabled){sw.set("checked",value);}});cw.mfaIndexControl.set("checked",value);}else{cw.set("checked",value);}}}},itemFunction:function(item,idx,w){var c=this._super(item,idx,w);c.parent=w;return c;},oncontextmenu:function openContextMenu(evt){$DOM.preventDefault(window,evt.e);var menuHelper=getMenuHelper();var el=$DOM.eventTarget(evt.hWin,evt.e);var idx=this.listMapper.findIndex(this,this.itemsContainerNode,el);if(idx>=0&&this.selectedIndices[idx]!==true){this.raiseEvent({name:"beginSelectionItem"});this.singleSelect(idx);}var data=this.getSelObjs();var src=$DOM.eventTarget(evt.hWin,evt.e);var rowItem=$DOM.findAncestorByName(src,"tr",true,this.domNode);if(!rowItem){return ;}var objColId=getObjectColId(this.type);var targetNode=rowItem.children[objColId].firstChild;var target=$DOM.findWidget(targetNode);if(target.scriptClass==="mstrmojo.Box"){target=target.children[1];}menuHelper.target=target;menuHelper.data=data;menuHelper.type=constants.contextMenuType.ITEM_MENU;var cfg=menuHelper.getMenuConfig();cfg.hostId=this.id;cfg.hostElement=src;cfg.isHostedWithin=false;cfg.position=$DOM.getMousePosition(evt.e,evt.hWin);this.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:cfg}));},ondragenter:function ondragenter(context){if(this._super){this._super(context);}var srcWidget=context.src.widget;if(srcWidget&&srcWidget.updateAvatarHTML){srcWidget.updateAvatarHTML(context.action,this.type);}},ondragleave:function ondragleave(context){if(this._super){this._super(context);}var srcWidget=context.src.widget;srcWidget.avatar.lastChild.innerHTML="";},ondrop:function ondrop(context){var rootController=mstrApp.getRootController(),contextSrc=context.src;if(contextSrc&&contextSrc.data){var dragData=contextSrc.data;if(context.action===ACTION_ATTR_TO_METR&&this.type===ObjectType.Metric){rootController.toMetric(dragData);}else{if(context.action===ACTION_METR_TO_ATTR&&this.type===ObjectType.Attribute){rootController.toAttribute(dragData);}}var srcWidget=context.src.widget;srcWidget.clearSelect();}},onmousedown:function onmousedown(evt){var list=this.hightlightAttFormList;if(list){list.clearSelect();list=null;}var src=$DOM.eventTarget(evt.hWin,evt.e);var table=$DOM.findAncestorByName(src,"table",true,this.domNode);if(!table){this.clearSelect();}},postBuildRendering:function pbr(props){this._super(props);$DOM.attachMarkupEvent(this.id,this.domNode,"contextmenu");},premousedown:function pmd(evt){if(evt.e.button===2){var src=$DOM.eventTarget(evt.hWin,evt.e);var rowNode=$DOM.findAncestorByName(src,"tr",true,this.domNode);var rowWidget=$DOM.findWidget(rowNode);if(rowWidget.selected){return ;}}},preclick:function preclick(evt){if($DOM.isPrimaryMouseBtn(evt.e)){var hWin=evt.hWin,e=evt.e,el=$DOM.eventTarget(hWin,e),idx=this.listMapper.findIndex(this,this.itemsContainerNode,el);if(idx>-1){var m=this.multiSelect,c=$DOM.isMetaKey(hWin,e),s=$DOM.shiftKey(hWin,e);if(c||s){$DOM.clearBrowserHighlights(hWin);}this.raiseEvent({name:"beginSelectionItem"});if(m&&(c||(this.selectionPolicy==="toggle"))){this.toggleSelect(idx);}else{if(m&&s){this.rangeSelect(idx);}else{this.singleSelect(idx);}}}}},rangeSelect:function rangeSelect(idx,silent){var sIdx=this.selectedIndex,eIdx=idx,n=eIdx-sIdx,dir=1,idxs=[];if(eIdx<sIdx){dir=-1;n=-n;}while(n>=0){idxs.push(sIdx);sIdx=sIdx+dir;n--;}this.addSelect(idxs,silent);},sort:function sort(dataField,isAsc){var r=isAsc?1:-1;var items=this.items;items.sort(function sortObjects(a,b){if(a[dataField]>b[dataField]){return r;}return -r;});this.set("items",items.concat());},updateAvatarHTML:function updateAvatarHTML(action,targetType){var hint="";if(action===ACTION_ATTR_TO_METR&&targetType===ObjectType.Metric){hint=mstrmojo.desc(11805,"Convert to Metric");}else{if(action===ACTION_METR_TO_ATTR&&targetType===ObjectType.Attribute){hint=mstrmojo.desc(11611,"Convert to Attribute");}}this.avatar.lastChild.innerHTML=hint;},updateItems:function update(){var me=this,items=getMappingItems(this.type),controller=mstrApp.getRootController().allObjectsController;if(this.type===ObjectType.Attribute){initSidxes(this.model,items);}this.clearSelect();this.items=items;this.sort("n",this.sortFlag);this.set("allItems",items);setTimeout(function(){if(me.type===ObjectType.Attribute&&me._headerWidgets_){me._headerWidgets_[SEARCH_INDEX_COLUMN_ID].updateState();}});this.filterItems();controller.raiseEvent({name:"updateDistKey"});}});mstrmojo.DI.HeaderWidget=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.DI.HeaderWidget",field:"",text:"",cm:[],menuController:null,tooltip:"",markupString:'<div id="{@id}" class="mstrmojo-di-headerwidget {@cssClass}" style="{@cssText}"><div class="header-text"></div><div class="header-menu"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"table":"none";}},markupSlots:{textNode:function(){return this.domNode.children[0];},menuNode:function(){return this.domNode.children[1];}},onexecuteCommand:function(evt){var menuController=this.menuController;switch(evt.item.did){case"ASC":menuController.sort(this.field,true);menuController.sortFlag=true;break;case"DES":menuController.sort(this.field,false);menuController.sortFlag=false;break;default:break;}},children:[{slot:"textNode",alias:"text",scriptClass:"mstrmojo.Label",bindings:{text:"this.parent.text"}},{slot:"menuNode",alias:"menu",scriptClass:"mstrmojo.Button",onclick:function(){var src=this.parent;var menuHelper=new mstrmojo.DI.DIAllObjectsHeaderMenu();menuHelper.target=src;menuHelper.cm=src.cm;menuHelper.type=constants.contextMenuType.ITEM_MENU;menuHelper.position=$DOM.position(this.domNode,true);var cfg=menuHelper.getMenuConfig();cfg.hostId=src.id;cfg.hostElement=this.domNode;cfg.isHostedWithin=false;cfg.position=menuHelper.position;src.openPopup(new mstrmojo.ui.menus.Menu({popupConfig:cfg}));}}]});mstrmojo.DI.DIAllObjectsHeaderMenu=mstrmojo.declare(mstrmojo.DI.DIMappingMenu,null,{scriptClass:"mstrmojo.DI.DIAllObjectsHeaderMenu",queryVisible:function queryVisible(item){if(item.did==="ASC"||item.did==="DES"){return true;}else{return false;}},queryEnabled:function queryEnabled(item){if(item.did==="ASC"||item.did==="DES"){return true;}else{return false;}},queryChecked:function queryChecked(){return false;},executeCommand:function(item){this.target.raiseEvent({name:"executeCommand",src:this.target,item:item});}});mstrmojo.DI.DIAllObjectsSourceLabel=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.DI.DIAllObjectsSourceLabel",useRichTooltip:true,richTooltip:{cssClass:"vi-regular vi-tooltip-V",posType:mstrmojo.tooltip.POS_TOPLEFT,top:-32},src:null,total:0,postBuildRendering:function postBuildRendering(){var tooltipStr=mstrmojo.desc(14029,"Exists in #### of @@@@ tables");if(!this.src){return this._super();}tooltipStr=tooltipStr.replace("####",this.src.length).replace("@@@@",this.total);tooltipStr+="</br>";tooltipStr+=this.src.join("</br>");var richTooltip={cssClass:"vi-regular vi-tooltip-C",refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPLEFT,content:tooltipStr,top:-6,left:50};this.set("richTooltip",richTooltip);return this._super();}});}());
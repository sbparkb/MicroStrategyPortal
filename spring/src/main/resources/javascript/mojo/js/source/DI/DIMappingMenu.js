(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.dom","mstrmojo.DI.DIGeoRole","mstrmojo.DI.DITimeDimension","mstrmojo.ui.menus.EditorConfig","mstrmojo.DI.DIPartition","mstrmojo.DI.DIShowAllColumns","mstrmojo.DI.DIHelpers");mstrmojo.requiresDescs(967,1388,2052,2170,2265,3434,3544,4530,4699,8002,8118,8984,9920,9134,9614,9919,9921,9922,11611,11805,11909,12697,12698,12699,12700,12701,12703,12706,12707,12708,12709,12710,13023,13024,13036,13037,13038,13039,13131,13132,13280,13303,13366,12388,13526,14198,14199,14200);var constants=mstrmojo.DI.DIConstants;var menuItems=constants.menuItems,dataTypeMenuItems=constants.dataTypeMenuItems;var $A=mstrmojo.array,$HELPER=mstrmojo.DI.DIHelpers;var DATE=8,TIME=9,DATETIME=1;function isPartitionMenuEnabled(tableId,partitionMemberTables){var partitionTables;if(partitionMemberTables&&partitionMemberTables.length>0){return true;}partitionTables=mstrApp.getRootController().partitionController.getAllPartitionTables(tableId,partitionMemberTables);return partitionTables.length>0;}mstrmojo.DI.DIMappingMenu=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DI.DIMappingMenu",dynamicUpdate:true,type:null,cm:[{n:mstrmojo.desc(12697,"Create Multiform Attribute"),did:menuItems.CREATE_MULTIFORM_ATTRIBUTE},{n:mstrmojo.desc(12698,"Edit Multiform Attribute"),did:menuItems.EDIT_MULTIFORM_ATTRIBUTE},{n:mstrmojo.desc(12699,"Add To Multiform Attribute"),did:menuItems.ADDTO_MULTIFORM_ATTRIBUTE},{did:menuItems.SEPARATOR},{n:mstrmojo.desc(13303,"Unmap"),did:menuItems.UNLINK_ALL},{did:menuItems.SEPARATOR},{n:mstrmojo.desc(11909,"Change Data Type"),did:menuItems.CHANGE_DATA_TYPE,items:[{did:dataTypeMenuItems.NUMBER,ctp:constants.columnDataTypes.integer,n:mstrmojo.desc(9614,"Integer")},{did:dataTypeMenuItems.NUMBER,ctp:constants.columnDataTypes.nlong,n:mstrmojo.desc(13131,"Long")},{did:dataTypeMenuItems.NUMBER,ctp:constants.columnDataTypes.int64,n:mstrmojo.desc(13132,"Big Integer")},{did:dataTypeMenuItems.NUMBER,ctp:constants.columnDataTypes.dtfloat,n:mstrmojo.desc(8002,"Float")},{did:dataTypeMenuItems.NUMBER,ctp:constants.columnDataTypes.dtdouble,n:mstrmojo.desc(2265,"Double")},{did:dataTypeMenuItems.BIG_DECIMAL,ctp:constants.columnDataTypes.bigDecimal,n:mstrmojo.desc(9920,"Big Decimal")},{did:menuItems.SEPARATOR},{did:dataTypeMenuItems.DATE,n:mstrmojo.desc(2052,"Date")},{did:dataTypeMenuItems.DATE_TIME,n:mstrmojo.desc(9919,"DateTime")},{did:dataTypeMenuItems.TIME,n:mstrmojo.desc(2170,"Time")},{did:menuItems.SEPARATOR},{did:dataTypeMenuItems.TEXT,n:mstrmojo.desc(3544,"Text")},{did:dataTypeMenuItems.HTML_TAG,n:mstrmojo.desc(9921,"HTML Tag")},{did:dataTypeMenuItems.PHONE_NUMBER,n:mstrmojo.desc(8984,"Phone Number")},{did:dataTypeMenuItems.SYMBOL,n:mstrmojo.desc(4530,"Symbol")},{did:dataTypeMenuItems.URL,n:mstrmojo.desc(9922,"URL")},{did:dataTypeMenuItems.EMAIL,n:mstrmojo.desc(4699,"Email")}]},{did:menuItems.SEPARATOR},{n:mstrmojo.desc(13526,"Define Geography"),did:menuItems.MARK_GEO_ROLES,items:[],buildSubMenuConfig:function buildSubMenuConfig(){return this.buildGeoRoleMenuEditor();}},{n:mstrmojo.desc(12701,"Create Time Attributes"),did:menuItems.CREATE_TIME_ATTRIBUTES,items:[],buildSubMenuConfig:function buildSubMenuConfig(){return this.buildTimeRoleMenuEditor();}},{n:mstrmojo.desc(11611,"Convert to Attribute"),did:menuItems.TO_ATTRIBUTE},{n:mstrmojo.desc(11805,"Convert to Metric"),did:menuItems.TO_METRIC},{n:mstrmojo.desc(13036,"Do Not Import"),did:menuItems.DO_NOT_IMPORT},{n:mstrmojo.desc(8118,"Import"),did:menuItems.IMPORT},{n:mstrmojo.desc(1388,"Rename"),did:menuItems.ITEM_RENAME},{did:menuItems.SEPARATOR},{n:mstrmojo.desc(13037,"Map to Project Attribute"),did:menuItems.MAP_TO_PROJECT_ATTRIBUTE},{n:mstrmojo.desc(13038,"Unmap from Project Attribute"),did:menuItems.UNMAP},{n:mstrmojo.desc(12703,"Link ?"),did:constants.menuItems.LINK},{n:mstrmojo.desc(13849,"Edit Table"),did:menuItems.REFRESH_DATA},{n:mstrmojo.desc(1388,"Rename"),did:menuItems.TABLE_RENAME},{n:mstrmojo.desc(13039,"Delete"),did:menuItems.DELETE},{did:menuItems.SEPARATOR},{n:mstrmojo.desc(13026,"Parse..."),did:menuItems.PARSE},{n:mstrmojo.desc(13023,"Wrangle..."),did:menuItems.REFINE},{n:mstrmojo.desc(13024,"Delete Wrangle Operations"),did:menuItems.CANCEL_REFINE},{did:menuItems.SEPARATOR},{n:mstrmojo.desc(12706,"Define Relationships"),did:menuItems.DEFINE_RELATIONSHIPS},{n:mstrmojo.desc(12707,"Show All Attribute Forms"),did:menuItems.SHOW_ALL_ATTRIBUTE_FORMS},{n:mstrmojo.desc(12708,"Hide All Attribute Forms"),did:menuItems.HIDE_ALL_ATTRIBUTE_FORMS},{n:mstrmojo.desc(12709,"Show All Columns"),did:menuItems.SHOW_ALL_COLUMNS,items:[],buildSubMenuConfig:function buildSubMenuConfig(){return this.buildAllColumnsMenuEditor();}},{did:menuItems.SEPARATOR},{n:mstrmojo.desc(12710,"Group Partition"),did:menuItems.PARTITION,items:[],buildSubMenuConfig:function buildSubMenuConfig(){return this.buildPartitionMenuEditor();}}],queryEnabled:function queryEnabled(item){var enabled=true;var data=this.data[0];var source,sources,col=this.data[0],model=mstrApp.getRootController().getModel(),i,j;if(this.type!==constants.contextMenuType.TABLE_MENU){sources=model.findMappingSource(col);if(sources.length===0){return false;}source=sources[0];}else{if(this.type===constants.contextMenuType.TABLE_MENU){source=model.importSources[this.data[0].id];}}if(data.isMultiForm&&!data.isAttributeForm){data=data.subColumns[0];}switch(item.did){case menuItems.ITEM_RENAME:case menuItems.CHANGE_DATA_TYPE:enabled=(data.ipa!==1);break;case menuItems.MARK_GEO_ROLES:enabled=(data.ipa!==1)&&(source.type!==constants.sourceType.hadoop)&&!model.isDirectDataAccess;var rootController=mstrApp.getRootController();var m=rootController.model;var cols=m.findMappingItem(data);var column,subColumns;for(i=0;i<cols.length;i++){column=cols[i];subColumns=column.subColumns;if(column.isMultiForm){for(j=0;j<subColumns.length;j++){if(subColumns[j].fmn==="Latitude"||subColumns[j].fmn==="Longitude"){enabled=false;break;}}}}break;case menuItems.DO_NOT_IMPORT:if(data.tp===12){mstrmojo.array.forEach(sources,function(source){if(source.xdaType===constants.xdaType.querybuilder||source.xdaType===constants.xdaType.googleBigQuery||source.xdaType===constants.xdaType.dataImportCustomSQL||source.sourceInfo.hasAggFilter){enabled=false;item.title=mstrmojo.desc(14198,"Unmap to enable this option");return false;}});}break;case menuItems.CREATE_TIME_ATTRIBUTES:enabled=(data.ipa!==1)&&(source.type!==constants.sourceType.hadoop)&&((data.dtp===DATE)||(data.dtp===TIME)||(data.dtp===DATETIME))&&!model.isDirectDataAccess;break;case menuItems.PARSE:enabled=source&&(source.sourceInfo.isRefined===0&&source.sourceInfo.hasAggFilter===0)&&source.canAutoMappingAndDetectRelation();item.title=mstrmojo.desc(13902,"Edit table to enable this option.");break;case menuItems.REFINE:enabled=true;break;case menuItems.CANCEL_REFINE:enabled=source&&(source.canAutoMappingAndDetectRelation());break;case menuItems.SHOW_ALL_COLUMNS:enabled=true;if(model.operationMode===constants.operationMode.edit&&source&&!source.hasRefreshedData){enabled=false;item.title=mstrmojo.desc(13902,"Edit table to enable this option.");}if(source.xdaType===constants.xdaType.querybuilder||source.xdaType===constants.xdaType.dataImportCustomSQL||source.xdaType===constants.xdaType.googleBigQuery||source.xdaType===constants.xdaType.googleBigQueryFFSQL){enabled=false;item.title=mstrmojo.desc(14199,"This option is not applicable to Build Query and Type Query sources. Please use the 'edit table' operation to change the imported columns.");}break;case menuItems.PARTITION:enabled=isPartitionMenuEnabled(data.id,data.partition);item.title=enabled?"":mstrmojo.desc(12388,"No tables found with the same set of attributes and metrics.");break;case menuItems.REFRESH_DATA:enabled=model.isRefreshDataSupported(source.xdaType,source.sourceInfo&&source.sourceInfo.hnc);item.title=enabled?"":(source.sourceInfo.hnc?mstrmojo.desc(14392,"We do not have the credentials needed to get the data for this table. Please provide the credentials to proceed publishing this table."):mstrmojo.desc(13977,"HTTPS is required to edit this table"));if(source.type===constants.sourceType.file&&source.subtype===constants.sourceSubtype.url){enabled=mstrApp.diParams.EnableURLImport;}break;case menuItems.UNLINK:enabled=data.ipa!==1;break;default:enabled=true;break;}return enabled;},queryVisible:function queryVisible(item){var visible=true;var isMultiSelect=(this.data.length>1);var isMultiForm=false;var col=this.data[0],type=col.tp,doNotImport=(col.type==="cmps"),showLink=!item.showLink,isLinked=col.isLinked,source,isAttributeForm=col.isAttributeForm,isMetirc=(col.type==="mtmps"),model=mstrApp.getRootController().getModel(),isSAPHanaSingleTable;if(!isMultiSelect){isMultiForm=col.isMultiForm;}if(this.type!==constants.contextMenuType.TABLE_MENU){var sources=model.findMappingSource(col);if(sources.length===0){return false;}source=sources[0];}else{if(this.type===constants.contextMenuType.TABLE_MENU){source=model.importSources[this.data[0].id];}}isSAPHanaSingleTable=source&&(source.subtype===constants.sourceSubtype.hanaSingleTable);switch(item.did){case menuItems.SEPARATOR:visible=true;break;case menuItems.ITEM_RENAME:visible=(this.type!==constants.contextMenuType.TABLE_MENU)&&!isMultiSelect&&col.selected&&!isAttributeForm;break;case menuItems.TO_ATTRIBUTE:visible=(this.type!==constants.contextMenuType.TABLE_MENU)&&(type!==12||!col.selected)&&!isAttributeForm&&!isSAPHanaSingleTable;visible=visible&&!doNotImport;break;case menuItems.TO_METRIC:visible=(this.type!==constants.contextMenuType.TABLE_MENU)&&(type!==4||!col.selected)&&!isAttributeForm&&!isSAPHanaSingleTable;visible=visible&&!doNotImport;break;case menuItems.CREATE_MULTIFORM_ATTRIBUTE:visible=(type===12)&&mstrApp.getRootController().formsController.isVisible(constants.formsOptions.CREATE_MULTIFORM_ATTRIBUTE,this.data);break;case menuItems.EDIT_MULTIFORM_ATTRIBUTE:visible=(type===12)&&mstrApp.getRootController().formsController.isVisible(constants.formsOptions.EDIT_MULTIFORM_ATTRIBUTE,this.data);break;case menuItems.ADDTO_MULTIFORM_ATTRIBUTE:visible=(type===12)&&mstrApp.getRootController().formsController.isVisible(constants.formsOptions.ADDTO_MULTIFORM_ATTRIBUTE,this.data);break;case menuItems.MAP_TO_PROJECT_ATTRIBUTE:if(!isMultiSelect){visible=(this.type!==constants.contextMenuType.TABLE_MENU)&&(type===12)&&!isMultiSelect&&!mstrApp.isSingleTier&&!isAttributeForm&&(col.ipa!==1);visible=visible&&!doNotImport&&!(col.isMultiForm||model.isLinkedMFA(col));}else{visible=!mstrApp.isSingleTier;if(visible){$A.forEach(this.data,function(col){if(col.tp!==12||col.isAttributeForm||col.isMultiForm||model.isLinkedMFA(col)||col.ipa===1){visible=false;return false;}});}}break;case menuItems.MARK_GEO_ROLES:visible=(this.type!==constants.contextMenuType.TABLE_MENU)&&(type===12)&&!isMultiSelect&&!isAttributeForm;if(isMultiForm){var subColumns=col.subColumns;var allDate=true;mstrmojo.array.forEach(subColumns,function(item){var columnType=item.dtp;if(columnType!==1&&columnType!==8&&columnType!==9){allDate=false;}});if(allDate){visible=false;}}else{var columnType=col.dtp;if(columnType===1||columnType===8||columnType===9){visible=false;}}visible=visible&&!isSAPHanaSingleTable;visible=visible&&!doNotImport;break;case menuItems.CREATE_TIME_ATTRIBUTES:visible=false;break;case menuItems.CHANGE_DATA_TYPE:case dataTypeMenuItems.NUMBER:visible=(isAttributeForm||((this.type!==constants.contextMenuType.TABLE_MENU)&&!isMultiSelect&&!isMultiForm&&col.selected))&&!isSAPHanaSingleTable;if(item.ctp===constants.columnDataTypes.int64){visible=visible&&!isMetirc;}break;case dataTypeMenuItems.DATE_TIME:case dataTypeMenuItems.TEXT:case dataTypeMenuItems.DATE:case dataTypeMenuItems.TIME:visible=(isAttributeForm||((this.type!==constants.contextMenuType.TABLE_MENU)&&!isMultiSelect&&!isMultiForm&&col.selected))&&!isSAPHanaSingleTable;break;case dataTypeMenuItems.BIG_DECIMAL:visible=(isAttributeForm||((this.type!==constants.contextMenuType.TABLE_MENU)&&!isMultiSelect&&!isMultiForm&&col.selected))&&!isSAPHanaSingleTable;break;case dataTypeMenuItems.HTML_TAG:case dataTypeMenuItems.PHONE_NUMBER:case dataTypeMenuItems.SYMBOL:case dataTypeMenuItems.URL:case dataTypeMenuItems.EMAIL:visible=isAttributeForm||((this.type!==constants.contextMenuType.TABLE_MENU)&&!isMultiSelect&&!isMultiForm&&col.selected);visible=visible&&!isMetirc;break;case menuItems.UNMAP:visible=(this.type!==constants.contextMenuType.TABLE_MENU)&&(type===12)&&!isMultiSelect&&!mstrApp.isSingleTier&&!isAttributeForm&&(col.ipa===1);visible=visible&&!doNotImport;break;case menuItems.UNLINK:visible=showLink&&isLinked&&!isMultiSelect&&(type===12)&&(this.type===constants.contextMenuType.ITEM_MENU)&&!isAttributeForm;break;case menuItems.UNLINK_ALL:visible=false;$A.forEach(this.data,function(item){if(item.isLinked&&item.tp===12){visible=true;return false;}});break;case menuItems.IMPORT:visible=doNotImport;break;case menuItems.DO_NOT_IMPORT:if(isAttributeForm){return false;}source=model.importSources[this.data[0].tableId];if((this.type!==constants.contextMenuType.TABLE_MENU)&&source&&col.selected){if((source.xdaType===constants.xdaType.querybuilder||source.xdaType===constants.xdaType.dataImportCustomSQL||source.xdaType===constants.xdaType.googleBigQuery||source.xdaType===constants.xdaType.googleBigQueryFFSQL||source.sourceInfo.hasAggFilter)){visible=false;}}else{visible=false;}visible=visible&&!isSAPHanaSingleTable;break;case menuItems.CANCEL_REFINE:visible=(source.sourceInfo.isRefined&&this.type===constants.contextMenuType.TABLE_MENU)&&!isAttributeForm;break;case menuItems.REFINE:var support=source.canRefine();visible=(support&&this.type===constants.contextMenuType.TABLE_MENU)&&!isAttributeForm;break;case menuItems.PARSE:visible=(this.type===constants.contextMenuType.TABLE_MENU)&&(source.type===constants.sourceType.file||source.type===constants.sourceType.googleDrive||source.type===constants.sourceType.dropbox||source.type===constants.sourceType.hadoop);if(source.sourceInfo&&source.sourceInfo.des===constants.sourceInfoDesc.json){visible=false;}break;case menuItems.TABLE_RENAME:case menuItems.DELETE:case menuItems.DEFINE_RELATIONSHIPS:case menuItems.SHOW_ALL_COLUMNS:visible=(this.type===constants.contextMenuType.TABLE_MENU);break;case menuItems.PARTITION:visible=(this.type===constants.contextMenuType.TABLE_MENU&&!model.isDirectDataAccess)&&!isAttributeForm;break;case menuItems.SHOW_ALL_ATTRIBUTE_FORMS:visible=(this.type===constants.contextMenuType.TABLE_MENU)&&!this.target.isExpanded&&!isAttributeForm;break;case menuItems.HIDE_ALL_ATTRIBUTE_FORMS:visible=(this.type===constants.contextMenuType.TABLE_MENU)&&this.target.isExpanded&&!isAttributeForm;break;case menuItems.REFRESH_DATA:visible=(this.type===constants.contextMenuType.TABLE_MENU)&&!isAttributeForm&&model.hasRefreshDataPrivilegesForAllTables([source]);break;default:visible=false;break;}return visible;},queryChecked:function queryChecked(item){var r=false;var isMultiSelect=(this.data.length>1);if(this.data[0].dtp&&!isMultiSelect){if(item.ctp===undefined){r=item.did===this.data[0].dtp.toString();}else{r=(item.did===this.data[0].dtp.toString())&&item.ctp===this.data[0].ctp;}}return r;},executeCommand:function(item){var src=this;var tableID=this.data[0].id;var controller=mstrApp.getRootController();var source=controller.model.importSources[tableID];switch(item.did){case menuItems.ITEM_RENAME:mstrApp.getRootController().openRenameTextBox(constants.contextMenuType.ITEM_MENU,this.menuNode||src.target.textNode,src);break;case menuItems.IMPORT:mstrApp.getRootController().importItem(src.data[0]);break;case menuItems.DO_NOT_IMPORT:mstrApp.getRootController().toUnused(src);break;case menuItems.TO_ATTRIBUTE:mstrApp.getRootController().toAttribute(src.data);break;case menuItems.TO_METRIC:mstrApp.getRootController().toMetric(src.data);break;case menuItems.UNLINK:mstrApp.getRootController().openUnLinkDialog(src);break;case menuItems.UNLINK_ALL:mstrApp.getRootController().unlinkAll(src);break;case menuItems.MAP_TO_PROJECT_ATTRIBUTE:mstrApp.getRootController().toProjectAttribute(src);break;case menuItems.UNMAP:mstrApp.getRootController().unmap(src);break;case menuItems.PARSE:controller.showDialog(constants.dialogType.parseDataDialog,{model:controller.model,height:"726px",w:"1328px",id:"parseDataDialog"+source.tableID,tableID:source.tableID});break;case menuItems.CANCEL_REFINE:mstrApp.getRootController().cancelRefineStage(tableID);break;case menuItems.REFINE:if(source.canLaunchWrangler()){controller.launchWranglerDialog(source);}else{if(mstrmojo.DI.DIHelpers.isRefreshable(controller.model)){controller.model.isAddingNewTable=false;controller.model.refreshToWrangle=source.tableID;controller.refreshSourceTable(source.tableID);}else{controller.displayError(mstrmojo.desc(14200,"Administrator has disabled importing a file from a URL. Hence we cannot proceed to wrangle the table."));}}break;case menuItems.TABLE_RENAME:mstrApp.getRootController().openRenameTextBox(constants.contextMenuType.TABLE_MENU,src.target.titleNode,src);break;case menuItems.DELETE:mstrApp.getRootController().removeSourceTable(tableID);break;case menuItems.REFRESH_DATA:if($HELPER.isRefreshable(controller.model)){controller.model.isAddingNewTable=false;controller.model.refreshToWrangle=null;controller.refreshSourceTable(tableID);}else{controller.displayError(mstrmojo.desc(13280,"Administrator has disabled importing a file from a URL."));}break;case menuItems.DEFINE_RELATIONSHIPS:mstrApp.getRootController().openRelationsDefineEditor(tableID);break;case menuItems.SHOW_ALL_ATTRIBUTE_FORMS:case menuItems.HIDE_ALL_ATTRIBUTE_FORMS:this.target.expandAttrForms();break;case menuItems.CREATE_MULTIFORM_ATTRIBUTE:mstrApp.getRootController().formsController.onClick(constants.formsOptions.CREATE_MULTIFORM_ATTRIBUTE,this.data[0].tableId,this.data[this.data.length-1],this.data);break;case menuItems.EDIT_MULTIFORM_ATTRIBUTE:mstrApp.getRootController().formsController.onClick(constants.formsOptions.EDIT_MULTIFORM_ATTRIBUTE,this.data[0].tableId,this.data[this.data.length-1],this.data);break;case menuItems.ADDTO_MULTIFORM_ATTRIBUTE:mstrApp.getRootController().formsController.onClick(constants.formsOptions.ADDTO_MULTIFORM_ATTRIBUTE,this.data[0].tableId,null,this.data);break;case dataTypeMenuItems.NUMBER:case dataTypeMenuItems.DATE_TIME:case dataTypeMenuItems.TEXT:case dataTypeMenuItems.URL:case dataTypeMenuItems.EMAIL:case dataTypeMenuItems.HTML_TAG:case dataTypeMenuItems.DATE:case dataTypeMenuItems.TIME:case dataTypeMenuItems.SYMBOL:case dataTypeMenuItems.BIG_DECIMAL:case dataTypeMenuItems.PHONE_NUMBER:var dtp=parseInt(item.did,10);var ctp=parseInt(item.ctp,10);if(typeof ctp!=="number"){ctp=null;}mstrApp.getRootController().changeDataType(src,dtp,ctp);break;default:return false;}return true;},buildDataTypeMenuEditor:function buildDataTypeMenuEditor(){var cfgEditor=new mstrmojo.ui.menus.EditorConfig({cssClass:"geoRoleMenu",contents:new mstrmojo.DI.DIDataType({data:this.data[0]}),data:{}});cfgEditor.fnOk=function(data){cfgEditor.contents.onOK(data);};return cfgEditor;},buildGeoRoleMenuEditor:function buildGeoRoleMenuEditor(){var data=this.data[0];var model=mstrApp.getRootController().model;var linkedItems=model.findMappingItem(data);if(linkedItems.length>1){var i,j,k,item,isContained,subColumn,subColumns,tempSubColumns;for(i=0;i<linkedItems.length;i++){item=linkedItems[i];if(!item.isMultiForm){continue;}tempSubColumns=item.subColumns;if(!subColumns){subColumns=tempSubColumns.slice(0);}else{for(j=0;j<tempSubColumns.length;j++){subColumn=tempSubColumns[i];isContained=false;for(k=0;k<subColumns.length;k++){if(subColumn.fmn===subColumns[k].fmn){isContained=true;}}if(!isContained){subColumns.push(subColumn);}}}}if(subColumns){this.data[0].mergeSubColumns=subColumns;this.data[0].isSharedMultiForm=true;}}else{this.data[0].mergeSubColumns=this.data[0].subColumns;this.data[0].isSharedMultiForm=this.data[0].isMultiForm;}var cfgEditor=new mstrmojo.ui.menus.EditorConfig({cssClass:"geoRoleMenu",contents:new mstrmojo.DI.DIGeoRole({georole:data.georole,der:data.der,shapeKeys:model.shapeKeys,data:this.data[0]}),data:{}});cfgEditor.fnOk=function(data){cfgEditor.contents.onOK(data);};return cfgEditor;},buildTimeRoleMenuEditor:function buildTimeRoleMenuEditor(){var data=this.data[0];var cfgEditor=new mstrmojo.ui.menus.EditorConfig({cssClass:"timeRoleMenu",contents:new mstrmojo.DI.DITimeDimension({der:data.der,data:this.data[0]}),data:{}});cfgEditor.fnOk=function(data){cfgEditor.contents.onOK(data);};return cfgEditor;},buildPartitionMenuEditor:function buildPartitionMenuEditor(){var data=this.data[0],cfgEditor;cfgEditor=new mstrmojo.ui.menus.EditorConfig({cssClass:"partitionMenu",contents:new mstrmojo.DI.DIPartition({data:data}),data:{},cancelVisible:false});cfgEditor.fnOk=function(data){cfgEditor.contents.onOK(data);};return cfgEditor;},buildAllColumnsMenuEditor:function buildAllColumnsMenuEditor(){var data=this.data[0];var cfgEditor=new mstrmojo.ui.menus.EditorConfig({cssClass:"timeRoleMenu",contents:new mstrmojo.DI.DIShowAllColumns({der:data.der,data:this.data[0]}),data:{}});cfgEditor.fnOk=function(data){cfgEditor.contents.onOK(data);};return cfgEditor;},getMenuConfig:function getMenuConfig(menuItems){var menuCfg=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstrmojo-di-mapping-menu",useTooltip:true}),id=this.id,isSeparator,isSeparatorPending=false,firstNonSepItem=null,allAvailableMenuItems=menuItems||this.cm;$A.forEach(allAvailableMenuItems,function(menuItem){isSeparator=(menuItem.did===constants.menuItems.SEPARATOR);if(this.queryVisible(menuItem)){if(isSeparator){if(null!==firstNonSepItem){isSeparatorPending=true;}}else{if(null===firstNonSepItem){firstNonSepItem=menuItem;}else{if(isSeparatorPending){menuCfg.addSeparator();isSeparatorPending=false;}}var cssClasses=[menuItem.icn||""],execFn=function execFn(){this.executeCommand(menuItem);};if(this.queryEnabled(menuItem)===false){menuCfg.addDisabledMenuItem(menuItem.n,cssClasses.join(" "));if(menuItem.title){menuCfg.menus[menuCfg.menus.length-1].title=menuItem.title;}}else{if(menuItem.items){menuCfg.addSubMenuItem(menuItem.n,"",id,menuItem.buildSubMenuConfig||this.getMenuConfig,menuItem.items);}else{if(menuItem.hasEdt){menuCfg.addEditorMenuItem(menuItem.n,id,menuItem.buildSubMenuConfig);}else{menuCfg.addToggleMenuItem(menuItem.n||"",cssClasses.join(" "),execFn,execFn,id,this.queryChecked(menuItem));}}}}}},this);if(!menuCfg.hasMenuItems()){return new mstrmojo.ui.menus.MenuConfig({menuCssClass:"hidden"});}return menuCfg;},getCategoryMenuConfig:function(menuItems){var menuCfg=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstrmojo-di-mapping-menu category-menu"}),me=this,id=this.id,category,subItems,i,j;var div1l='<div class="category-menu-item cf"><div class="menu-category">',div1r="</div>",div2l='<div class="menu-item">',div2r="</div></div>",categoryText,itemText,menuText;function getExecFn(item){return function(){me.executeCommand(item);};}for(i=0;menuItems&&i<menuItems.length;i++){category=menuItems[i];subItems=category&&category.items;for(j=0;j<subItems.length;j++){var item=subItems[j];categoryText=(j===0)?(category.n||"&nbsp"):"&nbsp";itemText=item.n||"";menuText=div1l+categoryText+div1r+div2l+itemText+div2r;menuCfg.addToggleMenuItem(menuText,"",getExecFn(item),getExecFn(item),id,this.queryChecked(item));}if(i<menuItems.length-1){menuCfg.addDisabledMenuItem("","sep");}}return menuCfg;}});}());
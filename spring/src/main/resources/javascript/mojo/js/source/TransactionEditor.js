(function(){mstrmojo.requiresCls("mstrmojo._CanValidate","mstrmojo.Arr","mstrmojo.Model","mstrmojo.Editor","mstrmojo.CheckBox","mstrmojo.HBox","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.ObjectBrowser","mstrmojo.ListBox","mstrmojo.Container","mstrmojo.ValidationTextBox","mstrmojo.TristateCheckBox","mstrmojo.Table","mstrmojo.WidgetList","mstrmojo.Button","mstrmojo.Pulldown","mstrmojo.DateTextBox","mstrmojo.FieldSet","mstrmojo.HTMLButton","mstrmojo.Box","mstrmojo.Dialog");var _H=mstrmojo.hash,_V=mstrmojo.validation,_TR=_V.TRIGGER,_SC=_V.STATUSCODE,_DTP=mstrmojo.expr.DTP,_N=mstrmojo.num,_S=mstrmojo.string,_P=mstrmojo.date,STD_DATE_FORMAT="M/d/yyyy",STD_TIME_FORMAT="H:mm:ss",CTRL_TEXTFIELD=1,CTRL_SWITCH=2,CTRL_LIST=3,CTRL_SLIDER=4,CTRL_CALENDAR=5,CTRL_TIMEPICKER=6,CTRL_TOGGLE=7,CTRL_TEXTAREA=8,CTRL_SIG_CAPTURE=9,CTRL_RATING=10,CTRL_RANK=11,CTRL_STEPPER=12,CTRL_BARCODE=13,CTRL_LIKERTSCALE=14,CONTROL_NAMES={1:mstrmojo.desc(3575),2:mstrmojo.desc(7660),3:mstrmojo.desc(5292),4:mstrmojo.desc(7658),5:mstrmojo.desc(5443),6:mstrmojo.desc(8249),7:mstrmojo.desc(8248),8:mstrmojo.desc(8274),9:mstrmojo.desc(9274),10:mstrmojo.desc(9894),11:mstrmojo.desc(2789),12:mstrmojo.desc(7659),13:mstrmojo.desc(9895),14:mstrmojo.desc(9896)},CHANGE_TYPE_DEFAULT=1,CHANGE_TYPE_MARK_SELECTION=2,INPUT_VALUES_CALCULATED=0,INPUT_VALUES_MANUAL=1,INPUT_VALUES_DATASET=2,RW_UNIT_FIELDGROUP=51,RW_UNIT_GRIDGRAPH=52,DSSXML_ATTRIBUTE=12,INPUT_TYPES1=[{n:mstrmojo.desc(8261),v:INPUT_VALUES_CALCULATED},{n:mstrmojo.desc(8262),v:INPUT_VALUES_MANUAL}],INPUT_TYPES2=INPUT_TYPES1.concat({n:mstrmojo.desc(8502),v:INPUT_VALUES_DATASET}),LIST_TYPE_PULLDOWN=0,LIST_TYPE_RADIOLIST=1,LIST_TYPE_NAMES={0:mstrmojo.desc(5291),1:mstrmojo.desc(9897)},RATING_STYLE_1=0,RATING_STYLE_2=1,RATING_STYLE=[{v:RATING_STYLE_1,n:'<div class="mstrmojo-TransactionEditor-RatingStyle1"></div>'},{v:RATING_STYLE_2,n:'<div class="mstrmojo-TransactionEditor-RatingStyle2"></div>'}],NO_VALIDATION=0,PHONE_NO=1,EMAIL_ADDRESS=2,ZIP_CODE=3,SOCIAL_SECURITY_NO=4,REG_EXP=5,VALIDATION_METHODS_OTHER=[{n:mstrmojo.desc(1549),v:NO_VALIDATION},{n:mstrmojo.desc(8983),v:REG_EXP}],VALIDATION_METHODS_NUM=[{n:mstrmojo.desc(1549),v:NO_VALIDATION},{n:mstrmojo.desc(8984),v:PHONE_NO},{n:mstrmojo.desc(8985),v:ZIP_CODE},{n:mstrmojo.desc(8986),v:SOCIAL_SECURITY_NO},{n:mstrmojo.desc(8983),v:REG_EXP}],VALIDATION_METHODS_STR=[{n:mstrmojo.desc(1549),v:NO_VALIDATION},{n:mstrmojo.desc(8984),v:PHONE_NO},{n:mstrmojo.desc(8987),v:EMAIL_ADDRESS},{n:mstrmojo.desc(8985),v:ZIP_CODE},{n:mstrmojo.desc(8986),v:SOCIAL_SECURITY_NO},{n:mstrmojo.desc(8983),v:REG_EXP}],isStringType=function(dtp){return _V.isString(dtp);},isNumericType=function(dtp){return _V.isNumeric(dtp)||_V.isInt(dtp);};function _toLocaleUnits(v){return _N.convertToLocalUnits(v).replace(/0{1,}$/,"").replace(/\.$/,".0").replace(/,$/,",0");}function _toUSUnits(v){return _N.toString(_N.convertToUSUnits(v),true);}function _toUSDateString(v){if(v!=null){var dt=_P.parseDateAndOrTime(v);if(dt!=null){return(dt.date?_P.formatDateInfo(dt.date,STD_DATE_FORMAT):"")+(dt.date&&dt.time?" ":"")+(dt.time?_P.formatTimeInfo(dt.time,STD_TIME_FORMAT):"");}}return"";}function _toLocaleDateString(v){if(v!=null){var dt=_P.parseDateAndOrTime(v,STD_DATE_FORMAT,STD_TIME_FORMAT);if(dt!=null){return(dt.date?_P.formatDateInfo(dt.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT):"")+(dt.date&&dt.time?" ":"")+(dt.time?_P.formatTimeInfo(dt.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT):"");}}return"";}function slideProp(show,target,prop,start,stop,onEnd,ease,extraProps){var props={target:target,onEnd:function(){if(onEnd){onEnd();}},props:{}};props.props[prop]={ease:ease||mstrmojo.ease.sin,start:parseInt(start,10),stop:parseInt(stop,10),suffix:"px"};props=mstrmojo.hash.copy(extraProps,props);var fx=new mstrmojo.fx.AnimateProp(props);fx.play();}function showError(msg){var curtain=mstrmojo.all.mstrTE.curtain;curtain.set("visible",true);mstrmojo.alert(msg,function(){curtain.set("visible",false);});}var _reportSelectorJson={scriptClass:"mstrmojo.Table",rows:1,cols:4,children:[{slot:"0,0",scriptClass:"mstrmojo.Label",text:mstrmojo.desc(8241)+":"},{slot:"0,1",scriptClass:"mstrmojo.TextBox",cssText:"width: 270px; margin: 0 0 0 10px;",readOnly:true,bindings:{value:"mstrmojo.all.teModel.txRpt.nm"}},{slot:"0,2",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-TransactionEditor-DropDownButton",text:"...",title:mstrmojo.desc(1825,"Browse"),popupRef:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-TransactionEditor-ObjectBrowserPopup",slot:"popupNode",locksHover:true,onOpen:function(){this.objectBrowser.browse({browsableTypes:"778,8",onSelectCB:[this,"onSelect"],onCloseCB:[this,"close"]});this.objectBrowser.obSearchBox.objectTypes="778,8";this.objectBrowser.set("visible",true);},onSelect:function(item){if(item.did){mstrmojo.all.teModel.setTxReport(item.did,item.n,true);}},children:[{alias:"objectBrowser",cssText:"width: 200px",scriptClass:"mstrmojo.ObjectBrowser",folderLinksContextId:14,closeOnSelect:true,useAnimate:true,closeable:true,showCompletePath:false}]}},{slot:"0,3",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-TransactionEditor-RemoveAscBtn",title:mstrmojo.desc(8282),text:"x",onclick:function(){mstrmojo.all.teModel.set("txRpt",null);}}]};function _createPanel(ps){return _H.copy(ps,{scriptClass:"mstrmojo.Container",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',cssClass:"mstrmojo-TransactionEditor-Panel",markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}}});}function _onValChg(){var m=mstrmojo.all.teModel,cu=m&&m.currentTxInput;if(cu&&this.isActive()){this.updateModel(this.isValid()?this.value:null);}else{if(this.inputNode){this.clearValidation();}}}function _textInput(ps,n){return _H.copy(ps,{scriptClass:"mstrmojo.ValidationTextBox",cssClass:"mstrmojo-TransactionEditor-TextBox",required:true,constraints:{trigger:_TR.ALL,max:ps.max,min:ps.min},bindings:{value:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr[n];}},onValid:_onValChg,onInvalid:_onValChg,isActive:null,updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr[n]=v;}});}function _checkBox(ps,n,v){var v=v||[true,false];return _H.copy(ps,{scriptClass:"mstrmojo.TristateCheckBox",cssClass:"tristate mstrmojo-TransactionEditor-CheckBox",grayed:false,bindings:{checked:function(){var value=mstrmojo.all.teModel.currentTxInput.ctl.pr[n];return value==null?undefined:value==v[0];}},oncheckedChange:function(){if(this.checked!=null){mstrmojo.all.teModel.currentTxInput.ctl.pr[n]=this.checked?v[0]:v[1];}}});}function _requiredCheckBox(ps){return _H.copy(ps,{scriptClass:"mstrmojo.TristateCheckBox",cssClass:"tristate mstrmojo-TransactionEditor-CheckBox",text:mstrmojo.desc(9511),grayed:false,bindings:{checked:"mstrmojo.all.teModel.currentTxInput.req == 1"},oncheckedChange:function(){if(this.checked!=null){mstrmojo.all.teModel.currentTxInput.req=this.checked?1:0;}}});}function _label(ps,n){return _H.copy(ps,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-TransactionEditor-Label",text:n});}function _createVlsRadioButton(ps){var value=ps.value,len=value&&value.length||0,label=ps.label||"",group=ps.group||"RadioButton",children=[],cellArray=[];for(var i=0;i<len;i++){children.push({scriptClass:"mstrmojo.CheckBox",value:value[i],type:"radio",label:value[i]+"-"+label,name:group,slot:"0,"+i,bindings:{checked:function(){var vls=mstrmojo.all.teModel.currentTxInput.ctl.pr.vls;return vls.length===this.value;}},onclick:function(){var vls=[];for(var i=0;i<this.value;i++){vls.push({n:i+1,v:i+1});}mstrmojo.all.teModel.currentTxInput.ctl.pr.vls=vls;}});cellArray.push({});}return _H.copy(ps,{scriptClass:"mstrmojo.Table",layout:[{cells:cellArray}],children:children});}var _textFieldPropertiesPanel=_createPanel({alias:"textField",children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:3}]},{cells:[{},{},{}]},{cells:[{},{},{}]},{cells:[{},{colSpan:2}]},{cells:[{},{colSpan:2}]},{cells:[{},{colSpan:2}]},{cells:[{},{colSpan:2}]},{cells:[{colSpan:3}]}],children:[_requiredCheckBox({slot:"0,0"}),_label({slot:"1,0",bindings:{visible:function(){return isStringType(mstrmojo.all.teModel.currentTxInput.dtp);}}},mstrmojo.desc(8252)+":"),_textInput({slot:"1,1",size:7,dtp:_DTP.INTEGER,min:1,max:999999,isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_TEXTFIELD;},bindings:{visible:function(){return isStringType(mstrmojo.all.teModel.currentTxInput.dtp);},value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.ml",enabled:function(){var vm=parseInt(mstrmojo.all.teModel.currentTxInput.ctl.pr.vm),pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;if(vm===PHONE_NO||vm===ZIP_CODE||vm===SOCIAL_SECURITY_NO){pr.set("ml",256);return false;}return true;}}},"ml"),_label({slot:"1,2",bindings:{visible:function(){return isStringType(mstrmojo.all.teModel.currentTxInput.dtp);}}},mstrmojo.desc(8259)),_label({slot:"2,0",bindings:{visible:function(){return isStringType(mstrmojo.all.teModel.currentTxInput.dtp);}}},mstrmojo.desc(8988)+":"),_textInput({slot:"2,1",size:7,dtp:_DTP.INTEGER,min:0,max:999999,bindings:{visible:function(){return isStringType(mstrmojo.all.teModel.currentTxInput.dtp);},value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.mnl",enabled:function(){var vm=parseInt(mstrmojo.all.teModel.currentTxInput.ctl.pr.vm),pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;if(vm===PHONE_NO||vm===ZIP_CODE||vm===SOCIAL_SECURITY_NO){pr.set("mnl",0);return false;}return true;}},isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_TEXTFIELD;}},"mnl"),_label({slot:"2,2",bindings:{visible:function(){return isStringType(mstrmojo.all.teModel.currentTxInput.dtp);}}},mstrmojo.desc(8259)),_checkBox({slot:"3,0",text:mstrmojo.desc(2100),bindings:{visible:function(){return isNumericType(mstrmojo.all.teModel.currentTxInput.dtp);},checked:"mstrmojo.all.teModel.currentTxInput.ctl.pr.emin"},oncheckedChange:function(){if(this.checked!=null){mstrmojo.all.teModel.currentTxInput.ctl.pr.set("emin",this.checked);}}},"emin"),_textInput({slot:"3,1",size:7,dtp:_DTP.DOUBLE,bindings:{visible:function(){return isNumericType(mstrmojo.all.teModel.currentTxInput.dtp);},value:function(){return _N.toLocaleString(mstrmojo.all.teModel.currentTxInput.ctl.pr.min);},enabled:"mstrmojo.all.teModel.currentTxInput.ctl.pr.emin"},isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_TEXTFIELD;},updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr.min=(v==null?v:_N.toString(v,true));}},"min"),_checkBox({slot:"4,0",text:mstrmojo.desc(2099),bindings:{visible:function(){return isNumericType(mstrmojo.all.teModel.currentTxInput.dtp);},checked:"mstrmojo.all.teModel.currentTxInput.ctl.pr.emax"},oncheckedChange:function(){if(this.checked!=null){mstrmojo.all.teModel.currentTxInput.ctl.pr.set("emax",this.checked);}}},"emax"),_textInput({slot:"4,1",size:7,dtp:_DTP.DOUBLE,bindings:{visible:function(){return isNumericType(mstrmojo.all.teModel.currentTxInput.dtp);},value:function(){return _N.toLocaleString(mstrmojo.all.teModel.currentTxInput.ctl.pr.max);},enabled:"mstrmojo.all.teModel.currentTxInput.ctl.pr.emax"},isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_TEXTFIELD;},updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr.max=(v==null?v:_N.toString(v,true));}},"max"),_label({slot:"5,0"},"Validation: "),{slot:"5,1",scriptClass:"mstrmojo.Pulldown",cssText:"white-space: nowrap; width:130px;",popupToBody:true,popupZIndex:112,itemIdField:"v",defaultText:" ",defaultSelection:0,bindings:{items:function(){var dtp=mstrmojo.all.teModel.currentTxInput.dtp;return isNumericType(dtp)?VALIDATION_METHODS_NUM:(isStringType(dtp)?VALIDATION_METHODS_STR:VALIDATION_METHODS_OTHER);},value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.vm"},onvalueChange:function(){if(this.value!=null){mstrmojo.all.teModel.currentTxInput.ctl.pr.set("vm",this.value);}}},_label({slot:"6,0",bindings:{visible:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.vm==REG_EXP;}}},mstrmojo.desc(4449)+":"),_textInput({slot:"6,1",dtp:_DTP.VARCHAR,constraints:{trigger:_TR.ALL,validator:function(v){try{new RegExp(v);return{code:_SC.VALID};}catch(e){return{code:_SC.INVALID,msg:mstrmojo.desc(8998)};}}},bindings:{visible:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.vm==REG_EXP;},value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.rgx"},isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_TEXTFIELD;}},"rgx"),_checkBox({slot:"7,0",text:mstrmojo.desc(8330),bindings:{visible:function(){return mstrmojo.all.teModel.rwTxs.tp==RW_UNIT_FIELDGROUP;},checked:"mstrmojo.all.teModel.currentTxInput.ctl.pr.psw"}},"psw"),]}]});var _switchPropertiesPanel=_createPanel({alias:"switch1",children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:2}]},{cells:[{},{}]},{cells:[{},{}]},{cells:[{colSpan:2}]}],children:[_requiredCheckBox({slot:"0,0"}),_label({slot:"1,0"},mstrmojo.desc(7579)),_textInput({slot:"1,1",size:7,bindings:{dtp:"mstrmojo.all.teModel.currentTxInput.dtp",value:function(){return _N.toLocaleString(mstrmojo.all.teModel.currentTxInput.ctl.pr.vls[0].v);}},isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_SWITCH;},updateModel:function(v){var vl=mstrmojo.all.teModel.currentTxInput.ctl.pr.vls[0];vl.invalidFlag=(v==null)?1:0;vl.v=_N.toString(v,true);}}),_label({slot:"2,0"},mstrmojo.desc(7578)),_textInput({slot:"2,1",size:7,bindings:{dtp:"mstrmojo.all.teModel.currentTxInput.dtp",value:function(){return _N.toLocaleString(mstrmojo.all.teModel.currentTxInput.ctl.pr.vls[1].v);}},isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_SWITCH;},updateModel:function(v){var vl=mstrmojo.all.teModel.currentTxInput.ctl.pr.vls[1];vl.invalidFlag=(v==null)?1:0;vl.v=_N.toString(v,true);}}),_checkBox({slot:"3,0",text:mstrmojo.desc(9898),bindings:{checked:"mstrmojo.all.teModel.currentTxInput.ctl.pr.stl"}},"stl",[1,0]),]}]});function _createCalculatedPanel(cfg){var ctlIdx=cfg.ctlIdx;var ctlSubIdx=cfg.ctlSubIdx;var isActive=function(){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;return(pr.t==ctlIdx&&pr.st==ctlSubIdx&&pr.ipt==INPUT_VALUES_CALCULATED)||pr.t==CTRL_STEPPER;};return _createPanel({alias:"calculated",cssText:"margin: 5px 0 0",onvisibleChange:function(){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;if(!this.visible){pr.set("max",100);pr.set("min",0);pr.set("itv",10);}},children:[{scriptClass:"mstrmojo.Table",rows:3,cols:2,children:[_label({slot:"0,0"},mstrmojo.desc(2100)),_textInput({slot:"0,1",size:7,dtp:_DTP.DOUBLE,bindings:{value:function(){return _N.toLocaleString(mstrmojo.all.teModel.currentTxInput.ctl.pr.min);}},isActive:isActive,updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr.min=(v==null?v:_N.toString(v,true));}},"min"),_label({slot:"1,0"},mstrmojo.desc(2099)),_textInput({slot:"1,1",size:7,dtp:_DTP.DOUBLE,bindings:{value:function(){return _N.toLocaleString(mstrmojo.all.teModel.currentTxInput.ctl.pr.max);}},isActive:isActive,updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr.max=(v==null?v:_N.toString(v,true));}},"max"),_label({slot:"2,0"},mstrmojo.desc(7580)),_textInput({slot:"2,1",size:7,dtp:_DTP.DOUBLE,min:0,bindings:{value:function(){return _N.toLocaleString(mstrmojo.all.teModel.currentTxInput.ctl.pr.itv);}},isActive:isActive,updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr.itv=(v==null?v:_N.toString(v,true));}},"itv")]}]});}function _createManualPanel(cfg){var showRowHeader=(cfg.rowHeaders!=null),vt=showRowHeader?cfg.rowHeaders[0]:"",nt=showRowHeader?cfg.rowHeaders[1]:"",ct=cfg.colHeader||"",ctlIdx=cfg.ctlIdx,ctlSubIdx=cfg.ctlSubIdx;return _createPanel({alias:"manual",cssText:"margin: 5px 0 0 5px",children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{},{}]},{cells:[{cssText:"vertical-align:top"},{}]}],children:[{slot:"0,1",scriptClass:"mstrmojo.HBox",visible:showRowHeader,children:[{scriptClass:"mstrmojo.Label",cssText:"width:125px;",text:vt},{scriptClass:"mstrmojo.Label",cssText:"margin-left:10px;width:125px;",text:nt}]},_label({slot:"1,0",cssText:"margin-right:10px;"},ct),{slot:"1,1",scriptClass:"mstrmojo.WidgetList",renderOnScroll:false,maxID:1,itemIdField:"idx",makeObservable:true,bindings:{items:"mstrmojo.all.teModel.currentTxInput.ctl.pr.vls"},onitemsChange:function(){var cti=mstrmojo.all.teModel.currentTxInput,pr=cti&&cti.ctl.pr;if(pr&&pr.t==ctlIdx&&pr.st==ctlSubIdx){var vls=pr.vls;if(vls.length==0){this.add([{},{}],0);}if(ctlIdx==CTRL_TOGGLE||(ctlIdx==CTRL_LIST&&ctlSubIdx==LIST_TYPE_PULLDOWN)){if(!vls[0].unset){this.add([{n:pr.ust,unset:1}],0);}}}},itemFunction:function(item,idx,w){item.idx=w.maxID++;var dtp=mstrmojo.all.teModel.currentTxInput.dtp,inputWidget;if(item.unset){inputWidget={scriptClass:"mstrmojo.TextBox",cssText:"width:120px;",enabled:false,value:mstrmojo.desc(8329)};}else{inputWidget={scriptClass:"mstrmojo.ValidationTextBox",cssText:"width:120px",maxLength:256,dtp:dtp,constraints:{trigger:_TR.ONKEYUP},value:_N.toLocaleString(item.v||""),onValid:function(){this.parent.data.v=_N.toString(this.value||"",true);this.parent.data.invalidFlag=0;},onInvalid:function(){this.parent.data.invalidFlag=1;}};}return new mstrmojo.HBox({data:item,children:[inputWidget,{scriptClass:"mstrmojo.ValidationTextBox",cssClass:"mstrmojo-TransactionEditor-TextBox",cssText:"width:120px",dtp:_DTP.VARCHAR,maxLength:256,value:item.n,constraints:{trigger:_TR.ONKEYUP},onValid:function(){var data=this.parent.data;if(data.unset){mstrmojo.all.teModel.currentTxInput.ctl.pr.ust=this.value;}else{data.n=this.value;}},visible:!!nt},{scriptClass:"mstrmojo.Button",text:"",cssClass:"mstrmojo-TransactionEditor-ManualList-AddButton",onclick:function(){w.add([{}],w.itemIndex(this.parent.data)+1);}},{scriptClass:"mstrmojo.Button",text:"",cssClass:"mstrmojo-TransactionEditor-ManualList-RemoveButton",visible:idx>0,onclick:function(){w.remove(this.parent.data);}}]});}}]}]});}function _createDatasetPanel(cfg){var ctlIdx=cfg.ctlIdx,isBarcodeType=(ctlIdx===CTRL_BARCODE);return _createPanel({alias:"dataset",cssText:"margin: 0px; white-space: nowrap;",onvisibleChange:function(){var m=mstrmojo.all.teModel;if(this.visible){m.updateDDICSetting(m.currentTxInput);}else{m.currentTxInput.ctl.ddic=null;}},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{},{}]},{cells:[{},{}]},{cells:[{},{}]},{cells:[{},{}]},{cells:[{colSpan:2}]},{cells:[{},{}]}],children:[_label({slot:"0,0"},mstrmojo.desc(4190)),{slot:"0,1",alias:"dstPicker",scriptClass:"mstrmojo.Pulldown",popupToBody:true,popupZIndex:112,itemIdField:"dsid",defaultText:" ",defaultSelection:-1,bindings:{items:"mstrmojo.all.teModel.rwTxs.ds",value:"mstrmojo.all.teModel.currentTxInput.ctl.ddic.dsid"},onvalueChange:function(){if(this.value){var ddic=mstrmojo.all.teModel.currentTxInput.ctl.ddic;this.parent.attPicker.set("items",this.selectedItem.attrs);if(ddic.dsid!=this.value){ddic.dsid=this.value;ddic.dst=this.selectedItem.dst;ddic.set("csid",null);ddic.cst=null;if(isBarcodeType){ddic.set("mfid",null);this.parent.wmEqualCheck.set("checked",false);}ddic.set("wfid",null);ddic.set("dfid",1);}}}},_label({slot:"1,0"},mstrmojo.desc(2149)),{slot:"1,1",alias:"attPicker",scriptClass:"mstrmojo.Pulldown",popupToBody:true,popupZIndex:112,itemIdField:"did",defaultText:" ",defaultSelection:-1,items:[],bindings:{value:"mstrmojo.all.teModel.currentTxInput.ctl.ddic.csid"},onvalueChange:function(){if(this.value&&this.selectedItem){var ddic=mstrmojo.all.teModel.currentTxInput.ctl.ddic;this.parent.dfrmPicker.set("items",[{fid:"1",n:"Automatic"}].concat(this.selectedItem.frms));this.parent.wfrmPicker.set("items",this.selectedItem.frms);if(isBarcodeType){this.parent.mfrmPicker.set("items",this.selectedItem.frms);}if(ddic.csid!=this.value){ddic.csid=this.value;ddic.cst=this.selectedItem.tp;if(isBarcodeType){ddic.set("mfid",null);this.parent.wmEqualCheck.set("checked",false);}ddic.set("wfid",null);ddic.set("dfid","1");}}}},_label({slot:"2,0"},mstrmojo.desc(5247)),{slot:"2,1",alias:"dfrmPicker",scriptClass:"mstrmojo.Pulldown",popupToBody:true,popupZIndex:112,itemIdField:"fid",defaultText:" ",defaultSelection:-1,items:[],bindings:{value:"mstrmojo.all.teModel.currentTxInput.ctl.ddic.dfid"},onvalueChange:function(){if(this.value&&this.selectedItem){mstrmojo.all.teModel.currentTxInput.ctl.ddic.dfid=this.value;}}},_label({slot:"3,0",visible:isBarcodeType},mstrmojo.desc(9899)),{slot:"3,1",alias:"mfrmPicker",scriptClass:"mstrmojo.Pulldown",popupToBody:true,popupZIndex:112,itemIdField:"fid",defaultText:" ",defaultSelection:-1,visible:isBarcodeType,items:[],bindings:{value:"mstrmojo.all.teModel.currentTxInput.ctl.ddic.mfid"},onvalueChange:function(){if(this.value&&this.selectedItem){var ddic=mstrmojo.all.teModel.currentTxInput.ctl.ddic;ddic.mfid=this.value;if(this.parent.wmEqualCheck.checked===false){ddic.set("wfid",this.value);}}}},{slot:"4,0",alias:"wmEqualCheck",scriptClass:"mstrmojo.TristateCheckBox",cssClass:"tristate mstrmojo-TransactionEditor-CheckBox",grayed:false,text:mstrmojo.desc(9900),visible:isBarcodeType,bindings:{checked:function(){var ddic=mstrmojo.all.teModel.currentTxInput.ctl.ddic;return(isBarcodeType&&ddic.wfid!=ddic.mfid);}},oncheckedChange:function(){if(this.checked!=null){var ddic=mstrmojo.all.teModel.currentTxInput.ctl.ddic;if(!this.checked&&isBarcodeType){ddic.set("wfid",ddic.mfid);}}}},_label({slot:"5,0",bindings:{visible:function(){return !isBarcodeType||this.parent.wmEqualCheck.checked;}}},mstrmojo.desc(8501)),{slot:"5,1",alias:"wfrmPicker",scriptClass:"mstrmojo.Pulldown",popupToBody:true,popupZIndex:112,itemIdField:"fid",defaultText:" ",defaultSelection:-1,items:[],bindings:{value:"mstrmojo.all.teModel.currentTxInput.ctl.ddic.wfid",visible:function(){return !isBarcodeType||this.parent.wmEqualCheck.checked;}},onvalueChange:function(){if(this.value&&this.selectedItem){mstrmojo.all.teModel.currentTxInput.ctl.ddic.wfid=this.value;}}}]}]});}function _createValuesPropsPanel(cfg){var ctlIdx=cfg.ctlIdx;var ctlSubIdx=cfg.ctlSubIdx;return _createPanel({alias:cfg.alias,cssClass:"mstrmojo-TransactionEditor-DisplayStyleField",switchPanel:function(v){this.calculated.set("visible",v==INPUT_VALUES_CALCULATED);this.manual.set("visible",v==INPUT_VALUES_MANUAL);this.dataset.set("visible",v==INPUT_VALUES_DATASET);},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:3}]},{cells:[{},{},{}]},{cells:[{},{},{}]},{cells:[{},{colSpan:2}]}],children:[_checkBox({slot:"0,0",text:mstrmojo.desc(8260),visible:ctlIdx==CTRL_SLIDER||ctlSubIdx==LIST_TYPE_PULLDOWN,oncheckedChange:function(){if(this.checked!=null){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;if(this.visible&&pr.t==ctlIdx&&pr.st==ctlSubIdx){pr.set("dm",this.checked?1:0);pr.set("wm",this.checked?0:1);}}}},"dm",[1,0]),_label({slot:"1,0",visible:ctlIdx==CTRL_SLIDER||ctlSubIdx==LIST_TYPE_PULLDOWN},mstrmojo.desc(272)),_textInput({slot:"1,1",dtp:_DTP.DOUBLE,size:7,min:0,max:999999,visible:ctlIdx==CTRL_SLIDER||ctlSubIdx==LIST_TYPE_PULLDOWN,bindings:{enabled:"mstrmojo.all.teModel.currentTxInput.ctl.pr.wm == 1",value:function(){return _toLocaleUnits(mstrmojo.all.teModel.currentTxInput.ctl.pr.w);}},isActive:function(){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;return this.visible&&pr.t==ctlIdx&&pr.st==ctlSubIdx;},updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr.w=v?_toUSUnits(v):null;}},"w"),_label({slot:"1,2",visible:ctlIdx==CTRL_SLIDER||ctlSubIdx==LIST_TYPE_PULLDOWN},mstrApp.unitsLabel),_label({slot:"2,0",visible:ctlIdx==CTRL_SLIDER},mstrmojo.desc(8331)+":"),_textInput({slot:"2,1",dtp:_DTP.INTEGER,size:7,min:0,max:50,visible:ctlIdx==CTRL_SLIDER,bindings:{value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.ldw",enabled:"mstrmojo.all.teModel.currentTxInput.ctl.pr.dm == 1"},isActive:function(){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;return this.visible&&pr.t==ctlIdx&&pr.st==ctlSubIdx;}},"ldw"),_label({slot:"2,2",visible:ctlIdx==CTRL_SLIDER},mstrmojo.desc(8332)),_label({slot:"3,0"},mstrmojo.desc(8254)+":"),{slot:"3,1",scriptClass:"mstrmojo.Pulldown",cssText:"margin: 2px 0 2px 10px; width: 80px;",popupToBody:true,popupZIndex:112,itemIdField:"v",defaultText:" ",defaultSelection:-1,bindings:{items:function(){return(mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_LIST)?INPUT_TYPES2:INPUT_TYPES1;},value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.ipt"},onvalueChange:function(){if(this.value!=null){mstrmojo.all.teModel.currentTxInput.ctl.pr.ipt=this.value;this.parent.parent.switchPanel(this.value);}}}]},_createCalculatedPanel(cfg),_createManualPanel(cfg),_createDatasetPanel(cfg)]});}var _sliderPropertiesPanel=_createPanel({alias:"slider",children:[_requiredCheckBox(),_createValuesPropsPanel({ctlIdx:CTRL_SLIDER,colHeader:mstrmojo.desc(2175)+":"})]});var _likertScalePropertiesPanel=_createPanel({alias:"likertscale",children:[{scriptClass:"mstrmojo.Table",cssText:"margin: 3px; white-space: nowrap;",layout:[{cells:[{colSpan:2}]},{cells:[{},{}]},{cells:[{},{}]},{cells:[{},{}]}],children:[_requiredCheckBox({slot:"0,0"}),_label({slot:"1,0"},mstrmojo.desc(9901)),_createVlsRadioButton({value:[5,7,10],group:"likertScale",label:mstrmojo.desc(493),slot:"1,1"}),_label({slot:"2,0"},mstrmojo.desc(9902)),_textInput({slot:"2,1",size:14,dtp:_DTP.VARCHAR,required:false,isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_LIKERTSCALE;}},"mint"),_label({slot:"3,0"},mstrmojo.desc(9903)),_textInput({slot:"3,1",size:14,dtp:_DTP.VARCHAR,required:false,isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_LIKERTSCALE;}},"maxt")]}]});var _listPropertiesPanel=_createPanel({alias:"list",cssClass:"mstrmojo-TransactionEditor-Panel list",switchPanel:function(v){this.pulldown.set("visible",v==LIST_TYPE_PULLDOWN);this.radiolist.set("visible",v==LIST_TYPE_RADIOLIST);},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:3}]},{cells:[{},{colSpan:2}]},{cells:[{},{colSpan:2}]},{cells:[{},{},{}]}],children:[_requiredCheckBox({slot:"0,0"}),_label({slot:"1,0",cssText:"width: 80px"},mstrmojo.desc(5258)),{slot:"1,1",scriptClass:"mstrmojo.Pulldown",cssText:"margin: 0 0 0 10px; width: 90px; white-space: nowrap",popupToBody:true,popupZIndex:112,defaultText:" ",defaultSelection:-1,itemIdField:"st",bindings:{items:function(){var tp=mstrmojo.all.teModel.rwTxs.tp,dtp=mstrmojo.all.teModel.currentTxInput.dtp,items=[LIST_TYPE_PULLDOWN];if(tp==RW_UNIT_FIELDGROUP){items.push(LIST_TYPE_RADIOLIST);}for(var i=0;i<items.length;i++){items[i]={st:items[i],n:LIST_TYPE_NAMES[items[i]]};}return items;},value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.st"},onvalueChange:function(){if(null!=this.value){mstrmojo.all.teModel.currentTxInput.ctl.pr.set("st",this.value);this.parent.parent.switchPanel(this.value);}}},_label({slot:"2,0",cssText:"width: 80px",bindings:{visible:function(){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;return pr.t==CTRL_LIST&&pr.st==LIST_TYPE_RADIOLIST;}}},mstrmojo.desc(9904)),{slot:"2,1",scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",cssText:"margin: 5px 0 2px 10px; width: 90px; white-space: nowrap",popupToBody:true,popupZIndex:112,itemIdField:"v",items:[{n:mstrmojo.desc(2069),v:0},{n:mstrmojo.desc(3691),v:1}],bindings:{visible:function(){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;return pr.t==CTRL_LIST&&pr.st==LIST_TYPE_RADIOLIST;},value:function(){var ipr=mstrmojo.all.teModel.currentTxInput.ctl.pr.ipr;return((ipr===undefined)?null:(ipr===1?0:1));}},defaultText:" ",defaultSelection:-1,onvalueChange:function(){if(null!=this.value){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;pr.set("ipr",(this.value===0)?1:(pr.ipr===1?0:pr.ipr));}}},_label({slot:"3,0",cssText:"width: 80px",bindings:{visible:function(){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr,ipr=mstrmojo.all.teModel.currentTxInput.ctl.pr.ipr;return pr.t==CTRL_LIST&&pr.st==LIST_TYPE_RADIOLIST&&ipr!==1;}}},mstrmojo.desc(9905)),_textInput({slot:"3,1",size:14,dtp:_DTP.VARCHAR,required:false,min:2,max:999999,bindings:{visible:function(){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr,ipr=mstrmojo.all.teModel.currentTxInput.ctl.pr.ipr;return pr.t==CTRL_LIST&&pr.st==LIST_TYPE_RADIOLIST&&ipr!==1;},value:function(){var ipr=mstrmojo.all.teModel.currentTxInput.ctl.pr.ipr;return ipr?_N.parseInteger(ipr):"";}},constraints:{trigger:_TR.ALL,validator:function(v){if(v==""||(_N.isInt(v)&&_N.parseInteger(v)>=this.min&&_N.parseInteger(v)<=this.max)){return{code:_SC.VALID};}if(_N.isInt(v)){return{code:_SC.INVALID,msg:mstrmojo.desc(6079).replace("#","").replace("##",this.min).replace("###",this.max)};}return{code:_SC.INVALID,msg:mstrmojo.desc(7899).replace(/#/,mstrmojo.desc(6076))};}},isActive:function(){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;return this.visible&&pr.t==CTRL_LIST&&pr.st==LIST_TYPE_RADIOLIST;},updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr.ipr=(v=="")?0:v;}}),_label({slot:"3,2",cssText:"font-family: sans-serif",bindings:{visible:function(){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr,ipr=mstrmojo.all.teModel.currentTxInput.ctl.pr.ipr;return pr.t==CTRL_LIST&&pr.st==LIST_TYPE_RADIOLIST&&ipr!==1;}}},mstrmojo.desc(9906))]},_createValuesPropsPanel({ctlIdx:CTRL_LIST,ctlSubIdx:LIST_TYPE_PULLDOWN,alias:"pulldown",rowHeaders:[mstrmojo.desc(527),mstrmojo.desc(8263)]}),_createValuesPropsPanel({ctlIdx:CTRL_LIST,ctlSubIdx:LIST_TYPE_RADIOLIST,alias:"radiolist",rowHeaders:[mstrmojo.desc(527),mstrmojo.desc(8263)]}),]});var _togglePropertiesPanel=_createPanel({alias:"toggle",children:[_requiredCheckBox(),_createManualPanel({ctlIdx:CTRL_TOGGLE,rowHeaders:[mstrmojo.desc(527),mstrmojo.desc(3877)],colHeader:mstrmojo.desc(8255)+":"})]});var _calendarPropertiesPanel=_createPanel({alias:"calendar",children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:2}]},{cells:[{},{}]},{cells:[{},{}]},{cells:[{colSpan:2}]}],children:[_requiredCheckBox({slot:"0,0"}),_label({slot:"1,0"},mstrmojo.desc(2100)),{slot:"1,1",scriptClass:"mstrmojo.DateTextBox",cssClass:"mstrmojo-TransactionEditor-DateTextBox",width:120,autoFormat:false,bindings:{dtp:"mstrmojo.all.teModel.currentTxInput.dtp",value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.min"},required:false,constraints:{trigger:_TR.ALL},onValid:_onValChg,onInvalid:_onValChg,isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_CALENDAR;},updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr.min=v;},calendarToBody:true,calendarZIndex:112},_label({slot:"2,0"},mstrmojo.desc(2099)),{slot:"2,1",scriptClass:"mstrmojo.DateTextBox",cssClass:"mstrmojo-TransactionEditor-DateTextBox",width:120,autoFormat:false,bindings:{dtp:"mstrmojo.all.teModel.currentTxInput.dtp",value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.max"},required:false,constraints:{trigger:_TR.ALL},onValid:_onValChg,onInvalid:_onValChg,isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_CALENDAR;},updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr.max=v;},calendarToBody:true,calendarZIndex:112},_checkBox({slot:"3,0",text:mstrmojo.desc(8253)},"ict")]}]});var _timePickerPropertiesPanel=_createPanel({alias:"timePicker",children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:3}]},{cells:[{},{},{}]}],children:[_requiredCheckBox({slot:"0,0"}),_label({slot:"1,0"},mstrmojo.desc(7580)),_textInput({slot:"1,1",size:7,dtp:_DTP.INTEGER,constraints:{trigger:_TR.ALL,validator:function(v){if(60%v!=0){return{code:_SC.INVALID,msg:mstrmojo.desc(8277)};}return{code:_SC.VALID};}},isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_TIMEPICKER;}},"itv"),_label({slot:"1,2"},mstrmojo.desc(2699))]}]});var _textAreaPropertiesPanel=_createPanel({alias:"textArea",children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:3}]},{cells:[{colSpan:3}]},{cells:[{colSpan:3}]},{cells:[{},{},{}]},{cells:[{},{},{}]},{cells:[{},{},{}]},{cells:[{},{},{}]}],children:[_requiredCheckBox({slot:"0,0"}),_checkBox({slot:"1,0",text:mstrmojo.desc(8260),bindings:{visible:function(){return mstrmojo.all.teModel.rwTxs.tp==RW_UNIT_FIELDGROUP;},checked:"mstrmojo.all.teModel.currentTxInput.ctl.pr.dm == 1"},oncheckedChange:function(){if(this.checked!=null){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;if(pr.t==CTRL_TEXTAREA){pr.set("dm",this.checked?1:0);pr.set("wm",this.checked?0:1);if(this.checked){pr.set("siwc",false);}}}}},"dm",[1,0]),_checkBox({slot:"2,0",text:mstrmojo.desc(8251),bindings:{enabled:"mstrmojo.all.teModel.currentTxInput.ctl.pr.dm === 0",checked:"mstrmojo.all.teModel.currentTxInput.ctl.pr.siwc"},oncheckedChange:function(){if(this.checked!=null){var pr=mstrmojo.all.teModel.currentTxInput.ctl.pr;pr.set("siwc",this.checked);if(!this.checked){pr.set("sp",false);}}}},"siwc"),_checkBox({slot:"3,0",text:mstrmojo.desc(3389),cssText:"margin-left:15px;",bindings:{enabled:"mstrmojo.all.teModel.currentTxInput.ctl.pr.siwc",checked:"mstrmojo.all.teModel.currentTxInput.ctl.pr.sp"},oncheckedChange:function(){if(this.checked!=null){mstrmojo.all.teModel.currentTxInput.ctl.pr.set("sp",this.checked);}}},"sp"),_textInput({slot:"3,1",size:7,dtp:_DTP.INTEGER,min:1,max:999999,bindings:{enabled:"mstrmojo.all.teModel.currentTxInput.ctl.pr.sp",value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.pl"},isActive:function(){return this.enabled&&(mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_TEXTAREA);}},"pl"),_label({slot:"3,2"},mstrmojo.desc(8259)),_label({slot:"4,0"},mstrmojo.desc(272)),_textInput({slot:"4,1",size:7,dtp:_DTP.DOUBLE,min:0,max:999999,bindings:{enabled:"mstrmojo.all.teModel.currentTxInput.ctl.pr.wm == 1",value:function(){return _toLocaleUnits(mstrmojo.all.teModel.currentTxInput.ctl.pr.w);}},isActive:function(){return this.enabled&&(mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_TEXTAREA);},updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr.w=v?_toUSUnits(v):null;}}),_label({slot:"4,2"},mstrApp.unitsLabel),_label({slot:"5,0"},mstrmojo.desc(8252)+":"),_textInput({slot:"5,1",size:7,dtp:_DTP.INTEGER,min:1,max:999999,isActive:function(){return mstrmojo.all.teModel.currentTxInput.ctl.pr.t==CTRL_TEXTAREA;}},"ml"),_label({slot:"5,2"},mstrmojo.desc(8259))]}]});var _signatureCapturePropertiesPanel=_createPanel({alias:"sigCap",children:[_requiredCheckBox(),_checkBox({text:mstrmojo.desc(9273)},"sgl")]});var _ratingPropertiesPanel=_createPanel({alias:"rating",children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:2}]},{cells:[{},{}]},{cells:[{},{}]}],children:[_requiredCheckBox({slot:"0,0"}),_label({slot:"1,0"},mstrmojo.desc(9907)),_createVlsRadioButton({value:[3,5,10],group:"starRating",label:mstrmojo.desc(9908),slot:"1,1"}),_label({slot:"2,0"},mstrmojo.desc(5258)),{slot:"2,1",scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",cssText:"margin: 5px 0 0 10px; width: 100px; white-space: nowrap",popupToBody:true,popupZIndex:112,itemIdField:"v",items:RATING_STYLE,bindings:{value:"mstrmojo.all.teModel.currentTxInput.ctl.pr.stl"},defaultText:" ",defaultSelection:-1,onvalueChange:function(){if(this.value!=null){mstrmojo.all.teModel.currentTxInput.ctl.pr.stl=this.value;}}}]}]});var _stepperPropertiesPanel=_createPanel({alias:"stepper",children:[_requiredCheckBox(),_createCalculatedPanel({ctlIdx:CTRL_STEPPER})]});var _barcodePropertiesPanel=_createPanel({alias:"barcode",cssClass:"mstrmojo-TransactionEditor-Panel barcode",children:[_requiredCheckBox(),_checkBox({text:mstrmojo.desc(9909),cssText:"margin: 0 0 15px 0; white-space: nowrap",oncheckedChange:function(){if(this.checked!=null){mstrmojo.all.teModel.currentTxInput.ctl.pr.set("em",this.checked);mstrmojo.all.teModel.currentTxInput.ctl.pr.ipt=this.checked?INPUT_VALUES_DATASET:INPUT_VALUES_MANUAL;this.parent.dataset.set("visible",this.checked);}}},"em"),_createDatasetPanel({ctlIdx:CTRL_BARCODE})]});var _fieldsMapTableJson=(function(){var getLayout=function getLyt(inputs){var lyt=[],i,len,rw={cssText:"height:24px",cells:[{},{},{},{},{}]},rs={cells:[{colSpan:5,cssText:"vertical-align:top"}]},rc=inputs.length;lyt.push({cssText:"height:24px",cells:[{cssText:"width:130px"},{cssText:"width:140px"},{cssText:"width:60px"},{cssText:"width:120px"},{}]});for(i=0,len=rc;i<len;i++){lyt.push(rw);lyt.push(rs);}return lyt.concat(rs);},getChildren=function getChld(inputs){var as=[],i,j,len,rc=inputs.length,tix,panel=mstrmojo.all.ctrlPropPanel;as.push({slot:"0,0",scriptClass:"mstrmojo.Label",text:mstrmojo.desc(8244)},{slot:"0,1",scriptClass:"mstrmojo.Label",text:(mstrmojo.all.teModel.rwTxs.tp==RW_UNIT_FIELDGROUP)?mstrmojo.desc(8246):mstrmojo.desc(8245)},{slot:"0,2",scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4694)},{slot:"0,3",scriptClass:"mstrmojo.Label",text:mstrmojo.desc(8247)},{slot:"0,4",scriptClass:"mstrmojo.Label"});for(i=0,len=rc;i<len;i++){j=i*2+1;tix=inputs[i].tix;as.push({slot:j+",0",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-TransactionEditor-TransactionInput",cssText:"margin: 0px 10px 0 0",text:inputs[i].n},{slot:j+",1",txInput:inputs[i],scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",cssText:"margin: 0px 15px 0 0; white-space: nowrap",popupToBody:true,popupZIndex:112,itemIdField:"idx",itemField:"n",items:mstrmojo.all.teModel.rwTxs.tscObjs,itemCssClass:"Transactable-Object",value:inputs[i].toi,bindings:{value:"this.txInput.toi"},defaultText:" ",defaultSelection:-1,onvalueChange:function(evt){mstrmojo.all.teModel.updateTxMapping(this.txInput,this.value);if(this.value==null){this.set("selectedIndex",-1);}if(this.txInput.editing){panel.set("show",false);}},postCreate:function(){this.popupRef.children[0].itemMarkupFunction=function(item,idx,w){var opener=w.parent.opener;return'<div class="mstrmojo-Pulldown-listItem'+(opener.itemCssClass?" "+opener.itemCssClass:"")+(item.mapped?" mapped":"")+'"><div class="mstrmojo-text">'+item.n+"</div></div>";};}},{slot:j+",2",txInput:inputs[i],scriptClass:"mstrmojo.TristateCheckBox",cssText:"width: 20px; height: 15px; margin: 0 10px;",grayed:false,checked:inputs[i].edt==1,bindings:{enabled:function(){var toi=this.txInput.toi;return(toi>=0)&&!mstrmojo.all.teModel.rwTxs.tscObjs[toi].mo;},checked:"this.enabled && this.txInput.edt == 1"},oncheckedChange:function(){if(this.txInput.editing){panel.set("show",false);}this.txInput.set("edt",this.checked?1:0);}},{slot:j+",3",txInput:inputs[i],scriptClass:"mstrmojo.Pulldown",cssText:"margin: 0px 10px 0 0; white-space:nowrap; width:105px",popupToBody:true,popupZIndex:112,itemIdField:"t",items:mstrmojo.all.teModel.getControls(inputs[i].dtp),defaultText:" ",defaultSelection:-1,enabled:inputs[i].toi!=null&&inputs[i].edt==1,value:inputs[i].ctl&&inputs[i].ctl.pr.t,subValue:inputs[i].ctl&&inputs[i].ctl.pr.st,bindings:{enabled:"this.txInput.edt == 1",value:"this.txInput.ctl.pr.t",subValue:"this.txInput.ctl.pr.st"},onenabledChange:function(){this.set("value",this.enabled?this.items[0].t:null);},onvalueChange:function(){if(this.value){var idx=mstrmojo.array.find(this.items,"t",this.value);pr=_H.make(_H.clone(this.items[idx]),mstrmojo.Obj),ctl=_H.make({pr:pr,dirty:-1},mstrmojo.Obj);pr.dtp=this.txInput.dtp;this.txInput.set("ctl",ctl);}else{this.txInput.ctl=null;}if(this.txInput.editing){panel.set("panelIdx",this.value);}},onsubValueChange:function(){if(null!=this.subValue){var rwTxs=mstrmojo.all.teModel.rwTxs,subValue=this.subValue,dfv=mstrmojo.array.filter(rwTxs.dfvs,function(arr){return arr.t==CTRL_LIST&&arr.st==subValue;})[0],pr=_H.make(_H.clone(dfv),mstrmojo.Obj),ctl=_H.make({pr:pr,dirty:-1},mstrmojo.Obj);this.txInput.set("ctl",ctl);}}},{slot:j+",4",row:j,tix:tix,txInput:inputs[i],scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-TransactionEditor-ExpandButton",title:mstrmojo.desc(8250),bindings:{enabled:"this.txInput.edt == 1"},onclick:function(){var model=mstrmojo.all.teModel,me=this,show=!this.txInput.editing;if(model.isPropertiesValid()){if(panel.show&&!this.txInput.editing){model.currentTxInput.editing=false;panel.show=false;panel.playEffect("close",function(){me.onclick();});}else{if(show){model.set("currentTxInput",this.txInput);panel.set("panelIdx",this.txInput.ctl.pr.t);panel.targetDOM=this.parent[this.row+1+",0"];}panel.set("show",show);}}}});}return as;};return{scriptClass:"mstrmojo.FieldSet",cssClass:"mstrmojo-TransactionEditor-InputPropertiesField",legend:mstrmojo.desc(8243),bindings:{visible:"mstrmojo.all.teModel.txRpt != null"},children:[_createPanel({cssClass:"mstrmojo-TransactionEditor-scrollableInputPanel",children:[{scriptClass:"mstrmojo.Table",cellPadding:1,bindings:{items:"mstrmojo.all.teModel.txRpt.inputs"},onitemsChange:function(){this.destroyChildren();var items=this.items;if(items&&items.length>0){this.layout=getLayout(items);this.set("children",getChildren(items));this.refresh();mstrmojo.dom.center(mstrmojo.all.mstrTE.editorNode);}}}]})]};}());var _controlPropsPanelJson={id:"ctrlPropPanel",scriptClass:"mstrmojo.Box",targetDOM:null,panelIdx:0,cssText:"overflow:hidden;position:relative;",playEffect:function(type,callback){if(type=="open"){this.targetDOM.appendChild(this.containerNode);}var start,end,me=this;switch(type){case"open":start=0;end=this.containerNode.childNodes[0].clientHeight;break;case"close":start=this.containerNode.clientHeight;end=0;break;}slideProp(true,this.containerNode,"height",start,end,function(){if(type=="open"){me.containerNode.style.height="auto";}else{if(type=="close"){me.targetDOM.removeChild(me.containerNode);}}callback&&callback();},null);},onshowChange:function(){mstrmojo.all.teModel.currentTxInput.editing=this.show;this.playEffect(this.show?"open":"close");},onpanelIdxChange:function(){this.ctrlProps.display(this.panelIdx);},children:[{scriptClass:"mstrmojo.FieldSet",alias:"ctrlProps",legend:mstrmojo.desc(8250),cssClass:"mstrmojo-TransactionEditor-CtrlPropsPanel",display:function(t){var w={1:this.textField,2:this.switch1,3:this.list,4:this.slider,5:this.calendar,6:this.timePicker,7:this.toggle,8:this.textArea,9:this.sigCap,10:this.rating,12:this.stepper,13:this.barcode,14:this.likertscale}[t];for(var i=0,len=this.children.length;i<len;i++){this.children[i].set("visible",false);}if(w){w.set("visible",true);}},children:[_textFieldPropertiesPanel,_switchPropertiesPanel,_calendarPropertiesPanel,_timePickerPropertiesPanel,_sliderPropertiesPanel,_listPropertiesPanel,_togglePropertiesPanel,_textAreaPropertiesPanel,_signatureCapturePropertiesPanel,_ratingPropertiesPanel,_stepperPropertiesPanel,_barcodePropertiesPanel,_likertScalePropertiesPanel],postCreate:function(){for(var i=0,len=this.children.length;i<len;i++){this.children[i].visible=false;}}}]};function pollSavingStatus(callback){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(res){if(!res||res.status==2||res.status==3){showError(mstrmojo.desc(8256));mstrmojo.all.teModel.set("saving",false);}else{if(res.status==1||res.status==21){if(callback){callback();}mstrmojo.all.teModel.set("saving",false);}else{pollSavingStatus(callback);}}},failure:function(res){showError(mstrmojo.desc(8256));mstrmojo.all.teModel.set("saving",false);}},{taskId:"pollStatus",msgID:mstrmojo.all.teModel.messageID});}function saveData(callback){mstrmojo.all.teModel.set("saving",true);mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(res){if(callback){callback();}mstrmojo.all.teModel.set("saving",false);},failure:function(res){if(res.getResponseHeader("X-MSTR-TaskFailureMsg").indexOf("Task exceeded the maximum wait time")>-1){pollSavingStatus(callback);}else{showError(mstrmojo.desc(8256));mstrmojo.all.teModel.set("saving",false);}}},{taskId:"saveRWTransactions",msgID:mstrmojo.all.teModel.messageID,rwTransactionInfoXML:mstrmojo.all.teModel.getXML(),isEditExistingTXProperty:!mstrmojo.all.teModel.isNew});}var _advancedSettingsJson={scriptClass:"mstrmojo.FieldSet",cssClass:"mstrmojo-TransactionEditor-AdvancedField",legend:mstrmojo.desc(702),bindings:{visible:"mstrmojo.all.teModel.txRpt != null"},children:[{scriptClass:"mstrmojo.TristateCheckBox",grayed:false,text:mstrmojo.desc(8280),bindings:{checked:"mstrmojo.all.teModel.rwTxs.arc",visible:function(){return mstrmojo.all.teModel.rwTxs.tp==RW_UNIT_GRIDGRAPH;}},oncheckedChange:function(){if(this.checked!=null){mstrmojo.all.teModel.rwTxs.arc=this.checked;}}},{scriptClass:"mstrmojo.TristateCheckBox",grayed:false,text:mstrmojo.desc(8281),bindings:{checked:function(){return mstrmojo.all.teModel.rwTxs.ctp==CHANGE_TYPE_MARK_SELECTION;},visible:function(){return mstrmojo.all.teModel.rwTxs.tp==RW_UNIT_GRIDGRAPH;}},oncheckedChange:function(){if(this.checked!=null){mstrmojo.all.teModel.rwTxs.ctp=this.checked?CHANGE_TYPE_MARK_SELECTION:CHANGE_TYPE_DEFAULT;}}},{scriptClass:"mstrmojo.TristateCheckBox",grayed:false,bindings:{text:function(){return(mstrmojo.all.teModel.rwTxs.tp==RW_UNIT_GRIDGRAPH)?mstrmojo.desc(8309):mstrmojo.desc(8308);},checked:"mstrmojo.all.teModel.rwTxs.sci"},oncheckedChange:function(){if(this.checked!=null){mstrmojo.all.teModel.rwTxs.sci=this.checked;}}},{scriptClass:"mstrmojo.TristateCheckBox",grayed:false,bindings:{text:function(){return(mstrmojo.all.teModel.rwTxs.tp===RW_UNIT_GRIDGRAPH)?mstrmojo.desc(9910):mstrmojo.desc(9911);},checked:"!!mstrmojo.all.teModel.rwTxs.arn"},oncheckedChange:function(){if(this.checked!=null){mstrmojo.all.teModel.rwTxs.arn=this.checked?(mstrmojo.all.teModel.rwTxs.tp===RW_UNIT_GRIDGRAPH?-1:1):0;}}}]};var _buttonsBarJson={scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",cssText:mstrmojo.dom.isIE7?"float:none":"",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442),bindings:{text:'mstrmojo.all.teModel.saving? mstrmojo.desc(8298) + "..." : mstrmojo.desc(1442)'},onclick:function(evt){var model=mstrmojo.all.teModel;if(!model.saving&&(model.txRpt==null||(model.isPropertiesValid()&&model.isAllInputsMapped()))){var me=this;saveData(function(){if(model.onsave){model.onsave(model);}me.parent.parent.close();});}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(evt){if(!mstrmojo.all.teModel.saving){this.parent.parent.close();}}}]};var _disableCurtainJson={scriptClass:"mstrmojo.Label",alias:"curtain",slot:"editorNode",cssClass:"mstrmojo-TransactionEditor-disableCurtain",bindings:{visible:"mstrmojo.all.teModel.saving"},onvisibleChange:function(){mstrmojo.css.toggleClass(this.domNode,"saving",mstrmojo.all.teModel.saving);}};mstrmojo.txEditorModel={id:"teModel",scriptClass:"mstrmojo.Model",markMappedObjects:function(){var tscObjs=this.rwTxs.tscObjs,txInputs=this.txRpt.inputs;for(var i=0,len=tscObjs.length;i<len;i++){tscObjs[i].mapped=0;}for(var i=0,len=txInputs.length;i<len;i++){var toi=txInputs[i].toi;if(toi!=null){tscObjs[toi].mapped=1;}}},setTxReport:function(txRptId,txRptName,newFlag){var me=this;this.isNew=newFlag;this.rwTxs.txRptId=txRptId;if(this.rwTxs.ctp==null){this.rwTxs.ctp=CHANGE_TYPE_DEFAULT;}if(this.rwTxs.arn==null){this.rwTxs.arn=0;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(res){if(res){res.nm=txRptName;mstrmojo.all.teModel.set("txRpt",res);mstrmojo.all.teModel.markMappedObjects();}},failure:function(res){showError(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"getTransactionReportDefinition",transactionReportId:txRptId});},_set_rwTxs:function(n,v){var ls=v.tscObjs,len=ls.length,i;for(i=0;i<len;i++){ls[i].idx=i;}this.rwTxs=v;if(this.rwTxs.txRptId){this.setTxReport(this.rwTxs.txRptId,this.rwTxs.txRptName,false);}return true;},_set_txRpt:function(n,v){if(v){for(var i=0,l=v.inputs.length;i<l;i++){var ti=v.inputs[i];_H.make(ti,mstrmojo.Obj);ti.edt=0;ti.ctl=null;for(var j=0,ll=this.rwTxs.tscObjs.length;j<ll;j++){var tso=this.rwTxs.tscObjs[j];if(this.isNew){if(tso.did===ti.did&&tso.fid===ti.fid){ti.toi=tso.idx;break;}}else{if(tso.tix===ti.tix){ti.toi=tso.idx;ti.edt=tso.edt;ti.req=tso.req;ti.ctl=tso.ctl||null;if(ti.ctl!=null){var dfvs=this.rwTxs.dfvs,pr=ti.ctl.pr;if(ti.dtp===14||ti.dtp===15||ti.dtp===16){if(pr.t==CTRL_CALENDAR){pr.max=_toLocaleDateString(pr.max);pr.min=_toLocaleDateString(pr.min);}else{if(pr.vls!=null){var vls=pr.vls;for(var a=0,lll=vls.length;a<lll;a++){var vl=vls[a];vl.v=_toLocaleDateString(vl.v);}}}}pr.dtp=ti.dtp;for(var k=0,lll=dfvs.length;k<lll;k++){if(dfvs[k].t===pr.t&&(dfvs[k].st===pr.st||(pr.st===undefined&&dfvs[k].st===0))){ti.ctl.pr=_H.copy(pr,_H.clone(dfvs[k]));break;}}if(pr.t===CTRL_LIST&&pr.ipt===INPUT_VALUES_DATASET&&!ti.ctl.ddic){ti.ctl.ddic={};}_H.make(ti.ctl,mstrmojo.Obj);_H.make(ti.ctl.pr,mstrmojo.Obj);_H.make(ti.ctl.ddic,mstrmojo.Obj);}if(ti.edt==1&&ti.ctl==null){ti.edt=0;}break;}}}}}this.txRpt=v;return true;},_set_currentTxInput:function(n,v){if(v&&v.ctl){v.ctl.dirty=-1;}this.currentTxInput=v;return true;},updateTxMapping:function(txInput,idx){if(idx!=null){var tscObjs=this.rwTxs.tscObjs,inputs=this.txRpt.inputs;if(txInput.toi!=null){tscObjs[txInput.toi].mapped=0;}tscObjs[idx].mapped=1;for(var i=0,len=inputs.length;i<len;i++){if(inputs[i].toi===idx){inputs[i].set("toi",null);inputs[i].set("edt",0);inputs[i].set("ctl",null);break;}}txInput.set("toi",idx);}},updateDDICSetting:function(txInput){if(!txInput.ctl.ddic){var ddic=new mstrmojo.Obj(),rwTxs=mstrmojo.all.teModel.rwTxs,ds=rwTxs.ds,idx=mstrmojo.array.find(rwTxs.tscObjs,"idx",txInput.toi),to=rwTxs.tscObjs[idx];if(to.tp==DSSXML_ATTRIBUTE){for(var i=0,len=ds.length;i<len;i++){if(mstrmojo.array.find(ds[i].attrs,"did",to.did)>-1){ddic.dsid=ds[i].dsid;ddic.dst=ds[i].dst;break;}}ddic.cst=to.tp;ddic.csid=to.did;if(txInput.ctl.pr.t===CTRL_BARCODE){ddic.mfid=to.fid;}ddic.wfid=to.fid;ddic.dfid=1;}txInput.ctl.set("ddic",ddic);}},getControls:function(dtp){var ctrls;if(isNumericType(dtp)){ctrls=[CTRL_SLIDER,CTRL_TEXTFIELD,CTRL_TEXTAREA,CTRL_SWITCH,CTRL_LIST,CTRL_TOGGLE,CTRL_RATING,CTRL_STEPPER,CTRL_LIKERTSCALE,CTRL_BARCODE];}else{if(isStringType(dtp)){ctrls=[CTRL_TEXTFIELD,CTRL_TEXTAREA,CTRL_SWITCH,CTRL_LIST,CTRL_TOGGLE,CTRL_SIG_CAPTURE,CTRL_BARCODE];}else{if(dtp==14){ctrls=[CTRL_CALENDAR,CTRL_TEXTFIELD,CTRL_TEXTAREA,CTRL_LIST];}else{if(dtp==15){ctrls=[CTRL_TIMEPICKER,CTRL_TEXTFIELD,CTRL_TEXTAREA,CTRL_LIST];}else{if(dtp==16){ctrls=[CTRL_CALENDAR,CTRL_TIMEPICKER,CTRL_TEXTFIELD,CTRL_TEXTAREA,CTRL_LIST];}else{ctrls=[CTRL_TEXTFIELD,CTRL_TEXTAREA,CTRL_SWITCH,CTRL_LIST,CTRL_SLIDER,CTRL_CALENDAR,CTRL_TIMEPICKER,CTRL_TOGGLE];}}}}}for(var i=0;i<ctrls.length;i++){switch(ctrls[i]){case CTRL_LIST:ctrls[i]=mstrmojo.array.filter(this.rwTxs.dfvs,function(arr){return arr.t===CTRL_LIST&&arr.st===LIST_TYPE_PULLDOWN;})[0];break;default:ctrls[i]=this.rwTxs.dfvs[mstrmojo.array.find(this.rwTxs.dfvs,"t",ctrls[i])];}ctrls[i].n=CONTROL_NAMES[ctrls[i].t];}return ctrls;},isAllInputsMapped:function(){var txInputs=mstrmojo.all.teModel.txRpt.inputs;for(var i=0,len=txInputs.length;i<len;i++){if(txInputs[i].toi==null){showError(mstrmojo.desc(8257));return false;}}return true;},isPropertiesValid:function(){var cti=this.currentTxInput,pr=cti&&cti.editing&&cti.ctl.pr,errMsg="";if(pr){for(var i in pr){if(i=="vls"){for(var j=0;j<pr.vls.length;j++){var vl=pr.vls[j];if(vl.invalidFlag==1){errMsg=mstrmojo.desc(8258);break;}}}else{if(pr[i]==null){if(pr.ipt!==undefined&&pr.ipt!=INPUT_VALUES_CALCULATED&&(i=="min"||i=="max"||i=="itv")){}else{if(pr.t==CTRL_TEXTFIELD){if((isNumericType(cti.dtp)&&((i=="min"&&pr.emin)||(i=="max"&&pr.emax)))||(isStringType(cti.dtp)&&(i=="ml"||i=="mnl"))||(pr.vm==REG_EXP&&i=="rgx")){errMsg=mstrmojo.desc(8258);}}else{errMsg=mstrmojo.desc(8258);}}}}if(errMsg){break;}}if(!errMsg){switch(pr.t){case CTRL_TEXTFIELD:if(isNumericType(cti.dtp)){if(pr.emin&&pr.emax){if(parseFloat(pr.min)>parseFloat(pr.max)){errMsg=mstrmojo.desc(8283);}}}else{if(isStringType(cti.dtp)){if(parseInt(pr.mnl)>parseInt(pr.ml)){errMsg=mstrmojo.desc(8999);}}}break;case CTRL_CALENDAR:if(pr.min&&pr.max&&_P.compareDateAndOrTime(pr.min,pr.max)>0){errMsg=mstrmojo.desc(8278);}break;case CTRL_RATING:if(pr.vls.length==0){errMsg=mstrmojo.desc(8258);}break;case CTRL_SLIDER:case CTRL_LIST:case CTRL_STEPPER:case CTRL_BARCODE:if(pr.t==CTRL_STEPPER||pr.ipt==INPUT_VALUES_CALCULATED){var min=parseFloat(pr.min),max=parseFloat(pr.max),range=max-min,itv=parseFloat(pr.itv),esp=0.00001;if(range<=0){errMsg=mstrmojo.desc(8283);}else{if(itv-range>esp||Math.abs(Math.round(range/itv)*itv-range)>esp){errMsg=mstrmojo.desc(8284);}}break;}else{if(pr.t==CTRL_BARCODE||pr.ipt==INPUT_VALUES_DATASET){if(pr.t==CTRL_BARCODE&&pr.em==0){break;}var ddic=cti.ctl.ddic;if(!ddic.dsid||!ddic.csid||!ddic.wfid||!ddic.dfid){errMsg=mstrmojo.desc(8258);}if(pr.t==CTRL_BARCODE&&!ddic.mfid){errMsg=mstrmojo.desc(8258);}break;}}case CTRL_TOGGLE:var isListEmpty=true;for(var i=0;i<pr.vls.length;i++){var vl=pr.vls[i];if(!_S.isEmpty(vl.n)||!_S.isEmpty(vl.v)){isListEmpty=false;break;}}if(isListEmpty){errMsg=mstrmojo.desc(8279);}}}}if(errMsg){showError(errMsg);return false;}return true;},getXML:function(){if(this.txRpt==null){return _S.json2xml("rwTxs",{keyCtx:this.rwTxs.keyCtx},{isSerializable:function(){return true;}});}var inputs=this.txRpt.inputs,tscObjs=this.rwTxs.tscObjs,dirtyTscObjs=[],ctlKey;for(var i=0;i<inputs.length;i++){var input=inputs[i],tscObj=tscObjs[input.toi];if(this.isNew||tscObj.tix!=input.tix||tscObj.edt!=input.edt||(input.ctl&&input.ctl.dirty)){dirtyTscObjs.push(tscObj);}tscObj.tix=input.tix;tscObj.edt=input.edt;tscObj.req=input.req;ctlKey=tscObj.ctl&&tscObj.ctl.ctlKey;tscObj.ctl=input.ctl;if(tscObj.ctl!=null){tscObj.ctl.ctlKey=ctlKey||mstrmojo.all.teModel.getNewCtlKey();}tscObj.mark=-1;}for(var i=0;i<tscObjs.length;i++){var tscObj=tscObjs[i];if(!tscObj.mark&&tscObj.tix!=null){tscObj.edt=0;tscObj.req=0;tscObj.ctl=null;tscObj.tix=-1;dirtyTscObjs.push(tscObj);}tscObj.mark=0;}var cfg={isSerializable:function(nodeName,jsons,idx){switch(nodeName){case"keyCtx":case"txRptId":case"tp":case"ctp":case"arc":case"sci":case"arn":case"tscObjs":case"did":case"fid":case"key":case"edt":case"req":case"tix":case"ctl":case"ctlKey":case"ddic":case"dsid":case"dst":case"csid":case"cst":case"wfid":case"dfid":case"mfid":case"pr":case"ml":case"mnl":case"emax":case"emin":case"vm":case"rgx":case"siwc":case"sp":case"pl":case"w":case"wm":case"ict":case"ipt":case"itv":case"dm":case"t":case"ust":case"sgl":case"psw":case"ldw":case"st":case"mint":case"maxt":case"stl":case"em":case"ipr":return true;case"min":case"max":var pr=jsons[idx],t=pr.t,v=pr[nodeName];if(t==CTRL_CALENDAR){return{att:nodeName+'="'+_S.encodeXMLAttribute(_toUSDateString(v))+'"'};}else{return true;}case"vls":var pr=jsons[idx],t=pr.t,vls=pr.vls,dtp=pr.dtp,regExp=/(\^|\||\\)/g,as=[],ESC=function(n){if(n==null){n="";}return(typeof n=="string")?n.replace(regExp,"\\$1"):n;};if((t===CTRL_LIST||t===CTRL_SLIDER)&&pr.ipt!==INPUT_VALUES_MANUAL){return{att:'vls=""'};}for(var j=0;j<vls.length;j++){var vl=vls[j],s="";if(vl.unset){continue;}if(t==CTRL_TOGGLE||t==CTRL_LIST||t==CTRL_RATING||t==CTRL_LIKERTSCALE){s+=ESC(vl.n)+"^";}if(vl.v!=null){if(dtp==14||dtp==15||dtp==16){s+=ESC(_toUSDateString(vl.v));}else{s+=ESC(vl.v);}}if(s){as.push(s);}}return{att:'vls="'+_S.encodeXMLAttribute(as.join("|"))+'"'};}return false;},getArrItemName:function(n,v,i){if(n=="tscObjs"){return"tscObj";}},skipNull:true};var temp=this.rwTxs.tscObjs;this.rwTxs.tscObjs=dirtyTscObjs;var xml=_S.json2xml("rwTxs",this.rwTxs,cfg);this.rwTxs.tscObjs=temp;return xml;}};mstrmojo.TransactionEditor={id:"mstrTE",scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(8297),zIndex:112,cssClass:"mstrmojo-TransactionEditor",help:"configure_transactions_dialog_box.htm",model:mstrmojo.txEditorModel,isNew:false,txRptSelector:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(8264),cssClass:"mstrmojo-TranasactionPicker",cssText:"width: 210px",help:"Select_Transaction_dialog_box.htm",model:null,zIndex:112,teEditor:null,onOpen:function(){this.objectBrowser.browse({browsableTypes:"778,8",onSelectCB:[this,"onSelect"]});this.objectBrowser.obSearchBox.objectTypes="778,8";this.objectBrowser.set("visible",true);},onClose:function(isOK){if(isOK&&this.txRpt){this.opener.model.setTxReport(this.txRpt.did,this.txRpt.n,true);this.opener.open();}this.txRpt=null;},onSelect:function(item){if(item.did){this.set("txRpt",item);}},children:[{alias:"objectBrowser",scriptClass:"mstrmojo.ObjectBrowser",showCompletePath:false,folderLinksContextId:14,closeOnSelect:false,useAnimate:true,closeable:false},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442),bindings:{enabled:"this.parent.parent.txRpt != null"},onclick:function(evt){this.parent.parent.close(true);}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221),onclick:function(evt){this.parent.parent.close();}}]}]},open:function(){var m=this.model;if(m.rwTxs.txRptId==null){if(!this.txRptSelector.domNode){this.txRptSelector=mstrmojo.insert(this.txRptSelector);}this.txRptSelector.open(this);}else{mstrmojo.Editor.prototype.open.apply(this);}},onClose:function(){this.model.rwTxs=null;this.model.currentTxInput=null;mstrmojo.all.ctrlPropPanel.show=false;this.model.set("txRpt",null);},postCreate:function(props){this.model=mstrmojo.insert(this.model);mstrmojo.insert(_controlPropsPanelJson).render();},children:[_reportSelectorJson,_fieldsMapTableJson,_buttonsBarJson,_advancedSettingsJson,_disableCurtainJson]};})();
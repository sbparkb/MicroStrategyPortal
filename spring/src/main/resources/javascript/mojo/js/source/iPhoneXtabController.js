(function(){var USE_DEFAULT_ANSWER=8;function submitDataRequest(params){mstrApp.serverRequest(params);}function _cleanup(){var a=mstrmojo.all,i;for(i in a){mstrmojo.registry.remove(a[i]);}}var xmlencode=function(string){return string.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&apos;").replace(/\"/g,"&quot;");};var curXtabId="iRoot";var xtabProxy={data:null,controller:null,adjustSize:function(){var xt=mstrmojo.all[curXtabId];if(xt){xt._monitorWindow();}},getRWInfo:function(){var rw=mstrmojo.all[curXtabId].gridData.rw;return'<ifd tr="'+rw.tr+'" wmr="'+rw.wmr+'" tc="'+rw.tc+'" wmc="'+rw.wmc+'" wsr="'+rw.wsr+'" wsc="'+rw.wsc+'"/>';},getPBInfo:function(){var str="",gd=mstrmojo.all[curXtabId].gridData,phs=gd.ghs.phs,ci=gd.ci,n=gd.n||"";if(phs||ci||n){str='<report_info n="'+xmlencode(n)+'">';if(ci){str+='<ci cid="'+ci.cid+'" tp="'+ci.tp+'" utm="'+ci.utm+'"/>';}if(phs){str+="<pbe>";var cets=phs.cets;for(var i in cets){str+='<pb ei="'+xmlencode(cets[i].eid)+'"/>';}str+="</pbe>";}str+="</report_info>";}return str;},hasPageBy:function(){var phs=mstrmojo.all[curXtabId].gridData.ghs.phs;if(phs&&phs.cets){return"1";}return"0";},render:function(cacheMap){var imgCacheMap=cacheMap,xTabId=curXtabId,json=this.data;_cleanup();if(json&&json.eg){return json.eg;}var xtab=new mstrmojo.iXtab({id:xTabId,placeholder:curXtabId,defn:new mstrmojo.Model({fmts:{top:"0",left:"0",scrollarea:{y:459,x:319}}}),imgCacheMap:imgCacheMap,controller:this.controller});xtab.model=new mstrmojo.XtabModel({controller:this.controller});xtab.update({data:json});xtab.render();return ;},destroy:function(){var w=mstrmojo.all[curXtabId];if(w){var d=w.domNode,c=d.lastChild,length=d.childNodes.length,i=0;for(i=0;i<length;i++){window.setTimeout(function(){d.removeChild(d.lastChild);},0);}}}};function getXtabProxy(controller,data){xtabProxy.controller=controller;xtabProxy.data=data;return xtabProxy;}mstrmojo.iPhoneXtabController=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.iPhoneXtabController",setData:function(data){this.data=data;},getProxy:function(data){return getXtabProxy(this,data);},touchTap:function(){var params={cmd:"tap"};submitDataRequest(params);},swipe:function(params){submitDataRequest(params);},sortGrid:function sortGrid(view,action){var params={cmd:"sort",sortKey:action.sortKey,sortOrder:action.sortOrder,clearSort:1,subtotalPos:action.subTotalsPos};submitDataRequest(params);},pivotGrid:function pivotGrid(view,action){var params={cmd:"pivot",pos:action.pos,axis:action.axis,objectType:action.objectType};submitDataRequest(params);},onDrill:function onDrill(view,action){var elems=action.drillElements,params={cmd:"drl",dk:action.drillPathKey};if(elems){var arr=elems.split("A");params.a=arr[0];params.d=arr[1];params.o=arr[2];}submitDataRequest(params);},onLink:function onLink(view,action){if(action.link){action.linkAnswers=link.toXml();delete action.link;}var params=mstrmojo.hash.copy(action,{cmd:"lnk"});linkInfo=action.linkInfo,areAllAnswersDefault=(linkInfo.daMode==USE_DEFAULT_ANSWER);if(areAllAnswersDefault){var answers=linkInfo.ans;if(answers){for(i=0,cnt=answers.length;i<cnt;++i){if(answers[i].m!=USE_DEFAULT_ANSWER){areAllAnswersDefault=false;break;}}}}params.areAllAnswersDefault=areAllAnswersDefault?1:0;var target=linkInfo.target;params.tty=target&&target.t;delete params.linkInfo;delete params.linkTarget;delete params.srcMsgId;submitDataRequest(params);}});})();
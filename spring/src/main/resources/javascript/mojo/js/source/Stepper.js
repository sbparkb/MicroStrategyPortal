(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var $WIDGET=mstrmojo.Widget,$DOM=mstrmojo.dom,$DOC=mstrmojo.global.document,HOLD_INTERVAL=50,HOLD_THRESHOLD=500;mstrmojo.Stepper=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Stepper",orientation:"vertical",provider:null,title:"",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text">{@itemHtml}</div><div class="prev">-</div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},nextNode:function(){return this.domNode.children[1];},textNode:function(){return this.domNode.children[2];},prevNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:$WIDGET.visibleMarkupMethod,onheightChange:$WIDGET.heightMarkupMethod,onwidthChange:$WIDGET.widthMarkupMethod,onenabledChange:function onenabledChange(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},preBuildRendering:function preBuildRendering(){this.itemHtml=this.provider.renderItemAt();this._super();},processEvent:function processEvent(target){if($DOM.contains(this.textNode,target)||target===this.titleNode){return ;}var provider=this.provider,mthd=((target===this.nextNode)?"Next":"Prev");if(provider["has"+mthd]()){provider[mthd.toLowerCase()]();this.updateDisplayText();}},updateDisplayText:function updateDisplayText(){this.textNode.innerHTML=this.provider.renderItemAt();},startStepperInterval:function startStepperInterval(evt,fn){var me=this;this._holdTimer=setInterval(function(){me[fn](evt);},HOLD_INTERVAL);},stopStepperInterval:function stopStepperInterval(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}},onclick:function onclick(evt){this.processEvent(evt.e.target);},onmousedown:function onmousedown(evt){if(!this._holdTimer&&!this._startHoldTimer){var me=this;this._startHoldTimer=setTimeout(function(){delete me._startHoldTimer;me.startStepperInterval(evt,"onclick");},HOLD_THRESHOLD);$DOM.attachOneTimeEvent($DOC,"mouseup",function(){if(me._startHoldTimer){clearTimeout(me._startHoldTimer);delete me._startHoldTimer;}me.stopStepperInterval();},true);}},onselectstart:function onselectstart(){return false;}});}());
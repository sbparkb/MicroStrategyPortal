(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.chart.common.MapStructure");mstrmojo.requiresCls("mstrmojo.gm.GMEnums");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumNumberCategory","EnumLabelLevelOption","EnumSliceType","EnumDataSetStatus");mstrmojo.requiresClsP("mstrmojo.chart","ChartAdvFormat");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumShapeType");var $C=mstrmojo.chart,$HASH=mstrmojo.hash,$CHART_ENUMS=$C.enums,$MODEL_ENUMS=$C.model.enums,$NC=$CHART_ENUMS.EnumNumberCategory,$LLO=$CHART_ENUMS.EnumLabelLevelOption,$DATASET_STATUS=$CHART_ENUMS.EnumDataSetStatus,$SHP=$MODEL_ENUMS.EnumShapeType;var $GM=mstrmojo.gm,$FORMAT_TAG=$GM.FormatingPropertyTag;var kHidelabels=1,kDataLabelShowValue=2,kDataLabelShowText=3;var kLineAttributes={lineShape:[$FORMAT_TAG.SHAPE_LINE_COLOR,$FORMAT_TAG.SHAPE_LINE_STYLE,$FORMAT_TAG.SHAPE_LINE_THICKNESS],lineMarker:["lnMkBdrClr",$FORMAT_TAG.LINE_MARKER_STYLE,$FORMAT_TAG.LINE_MARKER_THICKNESS],shapeBorder:[$FORMAT_TAG.SHAPE_BORDER_COLOR,$FORMAT_TAG.SHAPE_BORDER_STYLE,$FORMAT_TAG.SHAPE_BORDER_THICKNESS]};function hMapToLineProperties(modelProperties,attributes){modelProperties=modelProperties||{};var result={mLineStyle:modelProperties[attributes[1]]||0,mAlpha:255,mLineThickness:modelProperties[attributes[2]]||null};if(result.mLineThickness!==null){result.mLineThickness=parseFloat(result.mLineThickness);}if(result.mLineThickness!==null&&result.mLineThickness!==undefined){result.mLineThicknessPt=75*result.mLineThickness;}var color=modelProperties[attributes[0]];if(color!==null&&color!==undefined){if(typeof color==="number"){result.mLineColor=color;}else{if(color.c1!==undefined&&typeof color.c1==="number"){result.mLineColor=color.c1;}}}if(result.mLineStyle===99){result.mAlpha=0;}return result;}function hGetShapeLineFormat(lineFormats,lineType){lineType=lineType||"all";var attributes,result={};switch(lineType){case"lineShape":attributes=kLineAttributes.lineShape;return $HASH.copyProps(attributes,lineFormats);case"targetLine":return result;case"lineMarker":attributes=kLineAttributes.lineMarker;return $HASH.copyProps(attributes,lineFormats);case"shapeBorder":case"pieSliceBorder":attributes=kLineAttributes.shapeBorder;return $HASH.copyProps(attributes,lineFormats,result);default:$HASH.copy(lineFormats,result);return result;}}function hParseValueToFormat(fmt,format){if(fmt===undefined){return ;}var general=9;if(fmt.nct!==undefined){format.mFormatType=fmt.nct;}if(format.mFormatType===undefined){format.mFormatType=general;}format.mDigits=fmt.ndp||0;if(fmt.nth!==undefined){format.mGrouping=fmt.nth;}if(format.mGrouping===undefined){format.mGrouping=3;}format.mPosCurr=fmt.ncp||0;if(fmt.nnn!==undefined){format.mNegFormat=fmt.nnn;}if(format.mNegFormat===undefined){format.mNegFormat=3;}format.mCurrency=((typeof fmt.ncs==="string")&&fmt.ncs)||"$";format.mCustomFormat=((typeof fmt.nfs==="string")&&fmt.nfs)||"General";}function hPopulateMetricInfo(){this.mHasMetrics=this.dataProvider.getMetricsCount()>0;return this.mHasMetrics;}function hIsUseZeroForNullValue(){return false;}function hPopulateByDataProvider(){var dataProvider=this.dataProvider;var thisRowSize=dataProvider.getDimensionSize(true),thisColumnSize=dataProvider.getDimensionSize(false);if(thisRowSize*thisColumnSize===0){return false;}this.SetDataGroup(dataProvider.getDataGroup());this.SetSeriesByColumn(dataProvider.getSeriesByColumn());this.dataLabelStyle=dataProvider.getDataLabelType();this.mDataGroup=dataProvider.getDataGroup();return true;}function hGetLabel(labelArray,option,sectional){if(!!labelArray===false){return"";}var start=0,length=labelArray.length;sectional=sectional||false;if(length<=0){return"";}if(option===$LLO.LLO_COMMON){length--;}else{if(option===$LLO.LLO_SPECIFIC){start=length-1;}}if(sectional){return labelArray;}if(labelArray.length===1){return labelArray[0].trim();}return labelArray.slice(start,length).join(" ").trim();}function hIsInsideSliceWindow(seriesIndex,groupIndex){if(this.useSliceWindow){var startSeries=this.startSeries;if(startSeries!==-1){if(!(seriesIndex>=startSeries&&seriesIndex<=this.endSeries)){return false;}}var startGroup=this.startGroup;if(startGroup!==-1){if(!(groupIndex>=startGroup&&groupIndex<=this.endGroup)){return false;}}}return true;}mstrmojo.chart.DataSetImpl=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.DataSetImpl",mpFormatManager:null,mDataGroup:1,mStatus:$DATASET_STATUS.DTST_OKAY,mSeriesByColumn:true,mSeriesSplit:null,mDiscreteSeries:null,dataLabelStyle:-1,mHasMetrics:false,useSliceWindow:false,startSeries:-1,startGroup:-1,endSeries:-1,endGroup:-1,gp:null,init:function init(props){this.InitFromDataProvider(props);this.reset();},reset:function reset(){this.resetDataWindow();this.genericFormats=undefined;this.gp={};},InitFromDataProvider:function InitFromDataProvider(props){if(props===null||props===undefined){return false;}this.mStatus=$DATASET_STATUS.DTST_INVALID;this.dataProvider=props.dataProvider;if(this.dataProvider===null||this.dataProvider.isValid===false){return false;}this.SetFormatManager(props.formatManager);var isOk=hPopulateByDataProvider.call(this);if(isOk===false){return false;}hPopulateMetricInfo.call(this);this.mStatus=$DATASET_STATUS.DTST_OKAY;return this.dataProvider.isValid;},IsInSlicedWindow:function IsInSlicedWindow(seriesId,groupId){return hIsInsideSliceWindow.call(this,seriesId,groupId);},SetDataGroup:function SetDataGroup(dataGroup){if(dataGroup>=1){this.mDataGroup=dataGroup;}},GetSeriesCount:function GetSeriesCount(){return this.dataProvider.getSeriesCount();},GetClusterSeriesCount:function GetClusterSeriesCount(){var barSeriesCount=this.GetSeriesByShape().Bar.length;if(barSeriesCount===0){barSeriesCount=this.GetSeriesCount();}return barSeriesCount;},GetGroupCount:function GetGroupCount(){return this.dataProvider.getGroupCount();},SeriesGroupIndexToRowColumnIndex:function SeriesGroupIndexToRowColumnIndex(seriesId,groupId,columnOffset,isConsiderSubtotal){columnOffset=columnOffset!==undefined?columnOffset:0;isConsiderSubtotal=isConsiderSubtotal||false;var rowIndex,columnIndex;rowIndex=this.dataProvider.getGraphCell(seriesId,groupId).getRowIndex(columnOffset);columnIndex=this.dataProvider.getGraphCell(seriesId,groupId).getColIndex(columnOffset);return{RowIndex:rowIndex,ColumnIndex:columnIndex};},ShouldTakeGroupCenter:function ShouldTakeGroupCenter(){return this.dataProvider.isClusteredBarSpecialCase();},GetClusterDataGroup:function GetClusterDataGroup(){return this.dataProvider.getClusterDataGroup();},GetOneSliceRangeSimple:function GetOneSliceRangeSimple(seriesIndex,groupIndex){var isOk,i,seriesCount,groupCount;isOk=false;seriesCount=this.GetSeriesCount();groupCount=this.GetGroupCount();for(i=0;i<seriesCount;++i){seriesIndex.push(i);}for(i=0;i<groupCount;++i){groupIndex.push(i);}return isOk;},GetSeriesLabel:function GetSeriesLabel(seriesId,columnOffset,option,sectional){columnOffset=columnOffset||0;option=option||$LLO.LLO_NORMAL;sectional=sectional||false;var labelArray=this.dataProvider.getGraphCell(seriesId,0).getSeriesLabel(columnOffset);return hGetLabel.call(this,labelArray,option,sectional);},GetGroupLabel:function GetGroupLabel(groupID,columnOffset,option,sectional){columnOffset=columnOffset!==undefined?columnOffset:0;option=option!==undefined?option:$LLO.LLO_NORMAL;sectional=sectional||false;var dp=this.dataProvider,gmCtr=dp.lds.gmm.gmCtr,scnt=dp.getSeriesCount(),s,gc,labelArray;if(gmCtr.clusteredBarSpecialCase){for(s=0;s<scnt;s++){gc=dp.getGraphCell(s,groupID);if(!gc.isFaked&&!!gc){labelArray=gc.getGroupLabel(columnOffset);break;}}}else{gc=dp.getGraphCell(0,groupID);if(!!gc){labelArray=gc.getGroupLabel(columnOffset);}}return hGetLabel.call(this,labelArray,option,sectional);},GetGroupLabelIdentities:function GetGroupLabelIdentities(index){var graphCell=this.dataProvider.getGraphCell(0,index);if(graphCell){return graphCell.getGroupLabelIdentities();}return[];},GetSeriesLabelIdentities:function GetSeriesLabelIdentities(index){var graphCell=this.dataProvider.getGraphCell(index,0);if(graphCell){return graphCell.getSeriesLabelIdentities();}return[];},GetMergedLabel:function GetMergedLabel(textParts,option){return hGetLabel.call(this,textParts,option,false);},GetDataGroup:function GetDataGroup(){return this.mDataGroup;},GetData:function GetData(seriesId,groupId,columnOffset){columnOffset=columnOffset!==undefined?columnOffset:0;var data=null;if(hIsInsideSliceWindow.call(this,seriesId,groupId)){data=this.dataProvider.getGraphCell(seriesId,groupId).getData(columnOffset);}if(!!this.hasMetricCell===false){if(!(data===null||data===undefined||isNaN(data))&&typeof data==="number"){this.hasMetricCell=true;}}if(isNaN(data)===true){return null;}return data;},GetSizeByData:function GetSizeByData(seriesId,groupId){return this.dataProvider.getGraphCell(seriesId,groupId).getSizeByData();},GetColorByData:function GetColorByData(seriesId,groupId,dataIndex,keepSource){keepSource=keepSource||false;dataIndex=(dataIndex!==undefined)?dataIndex:0;var graphCell=this.dataProvider.getGraphCell(seriesId,groupId);if(!!graphCell===false||graphCell.isFaked){return 0;}var oneColor=graphCell.getColorByData(dataIndex,false);if(!keepSource){if(oneColor&&oneColor.c1){oneColor=oneColor.c1;}else{if(oneColor==="transparent"){oneColor=0;}}}return oneColor;},GetDefaultShapeFillColor:function(){var dp=this.dataProvider,gmCtr=dp.lds.gmm.gmCtr;return gmCtr.property.defaultsObj.shpFillClr;},GetPieCountAtOneDataPoint:function GetPieCountAtOneDataPoint(seriesId,groupId){var gc=this.dataProvider.getGraphCell(seriesId,groupId);if(!!gc){if(gc.isFaked){gc=this.dataProvider.innerGetGraphCell(seriesId,groupId);}return gc.getSinglePieDPs().length;}return 0;},GetPieSliceCount:function GetPieSliceCount(seriesId,groupId,angleIndex){var gc=this.dataProvider.getGraphCell(seriesId,groupId);if(!!gc){if(gc.isFaked){gc=this.dataProvider.innerGetGraphCell(seriesId,groupId);}var PieDPS=gc.getSinglePieDPs();if(!!PieDPS){return PieDPS[angleIndex].getSliceCount();}}return 0;},GetSinglePieTotal:function GetSinglePieTotal(seriesId,groupId,angleIndex){var gc=this.dataProvider.getGraphCell(seriesId,groupId);if(!!gc){if(gc.isFaked){gc=this.dataProvider.innerGetGraphCell(seriesId,groupId);}var PieDPS=gc.getSinglePieDPs();if(!!PieDPS){return PieDPS[angleIndex].getTotalValue();}}return 100000;},GetPieSliceData:function GetPieSliceData(seriesId,groupId,angleIndex,sliceIndex){var gc=this.dataProvider.getGraphCell(seriesId,groupId);if(!!gc){if(gc.isFaked){gc=this.dataProvider.innerGetGraphCell(seriesId,groupId);}var PieDPS=gc.getSinglePieDPs(),data;if(!!PieDPS){data=PieDPS[angleIndex].getData(sliceIndex);if(!!this.hasMetricCell===false){if(!(data===null||data===undefined||isNaN(data))&&typeof data==="number"){this.hasMetricCell=true;}}return data;}}return null;},GetPieSliceColorByData:function GetPieSliceColorByData(seriesId,groupId,angleIndex,sliceIndex,keepSource){keepSource=keepSource||false;var gc=this.dataProvider.getGraphCell(seriesId,groupId);if(!!gc){if(gc.isFaked){gc=this.dataProvider.innerGetGraphCell(seriesId,groupId);}var PieDPS=gc.getSinglePieDPs();if(!!PieDPS){var oneColor=PieDPS[angleIndex].getColorByData(sliceIndex,false,false);if(!keepSource){if(oneColor&&oneColor.c1){oneColor=oneColor.c1;}else{if(oneColor==="transparent"){oneColor=0;}}}return oneColor;}}return null;},GetPieSlicePercentage:function GetPieSlicePercentage(seriesId,groupId,angleIndex,sliceIndex){var gc=this.dataProvider.getGraphCell(seriesId,groupId);if(!!gc){if(gc.isFaked){gc=this.dataProvider.innerGetGraphCell(seriesId,groupId);}var PieDPS=gc.getSinglePieDPs();if(!!PieDPS){return PieDPS[angleIndex].getPercentage(sliceIndex);}}return 0;},GetAngleNumber:function GetAngleNumber(){return this.GetPieCountAtOneDataPoint(0,0);},IsGridPieAngleBreakX:function IsGridPieAngleBreakX(){return this.dataProvider.isGridPieSplitAlongXAxis();},isBare:function isBare(isPie){if(this.hasOwnProperty("hasMetricCell")){return !this.hasMetricCell;}var i,j,m,n,data,seriesCount=this.GetSeriesCount(),groupCount=this.GetGroupCount(),sliceCount=1,angleCount=1;if(isPie){angleCount=this.GetAngleNumber();}for(i=0;i<seriesCount;i++){for(j=0;j<groupCount;j++){for(m=0;m<angleCount;m++){if(isPie){sliceCount=this.GetPieSliceCount(i,j,m);}for(n=0;n<sliceCount;n++){if(isPie){data=this.GetPieSliceData(i,j,m,n);}else{data=this.GetData(i,j);}if(!(data===null||data===undefined||isNaN(data))&&typeof data==="number"){this.hasMetricCell=true;return false;}}}}}this.hasMetricCell=false;return true;},getValueAxisNumberFormat:function getValueAxisNumberFormat(orFormat,list,resolved){list=list||null;resolved=resolved||false;var isConsistent,isFirst,index,rowUnitCount,colUnitCount,dataGroup=this.mDataGroup,isMetricsOnRowAxis=this.dataProvider.isMetricOnRowAxis(),seriesByColumn=this.mSeriesByColumn,dataProvider=this.dataProvider,currentFormat=new $C.ChartAdvFormat(),formatToCompare=new $C.ChartAdvFormat(),i,j,k;orFormat.mCustomFormat="General";orFormat.mFormatType=$NC.General;orFormat.mGrouping=0;if(!this.mHasMetrics||this.dataProvider===null||this.dataProvider===undefined){return false;}isConsistent=true;isFirst=true;if(resolved===false&&list&&list.length>0){this.GetMetricNumberFormat(currentFormat,list[0]);i=1;for(;i<list.length&&isConsistent;i++){index=list[i];this.GetMetricNumberFormat(formatToCompare,index);if((currentFormat.mFormatType!==formatToCompare.mFormatType)||(currentFormat.mFormatType===$NC.Currency&&(currentFormat.mCustomFormat.localeCompare(formatToCompare.mCustomFormat)!==0))){isConsistent=false;}}if(isConsistent){orFormat.reset(currentFormat);}return true;}index=0;isConsistent=true;isFirst=true;if(isMetricsOnRowAxis){rowUnitCount=!seriesByColumn?dataProvider.getSeriesCount():dataProvider.getGroupCount();colUnitCount=1;}else{rowUnitCount=1;colUnitCount=seriesByColumn?dataProvider.getSeriesCount():dataProvider.getGroupCount();}var indexSet;for(i=0;i<rowUnitCount&&isConsistent;++i){for(j=0;j<colUnitCount;++j){for(k=0;k<dataGroup;++k){indexSet={S:i,G:j,D:k};if(seriesByColumn){indexSet.S=j;indexSet.G=i;}if(isFirst){if(list&&list.length){index=this.getHostMetricIndex(indexSet.S,indexSet.G,indexSet.D);if(index===null){continue;}if(list.indexOf(index)!==-1){this.getChartAdvFormatForOneCell(indexSet,currentFormat,resolved);isFirst=false;}}else{this.getChartAdvFormatForOneCell(indexSet,currentFormat,resolved);isFirst=false;}}else{index=this.getHostMetricIndex(indexSet.S,indexSet.G,indexSet.D);if(index===null){continue;}if(list&&list.indexOf(index)!==-1){this.getChartAdvFormatForOneCell(indexSet,formatToCompare,resolved);if((currentFormat.mFormatType!==formatToCompare.mFormatType)||(currentFormat.mFormatType===$NC.Currency&&(currentFormat.mCustomFormat.localeCompare(formatToCompare.mCustomFormat)!==0))){isConsistent=false;}}}}}}if(isConsistent){orFormat.reset(currentFormat);}return true;},getGridDataFormat:function getGridDataFormat(orFormat,iSeriesId,iGroupId,iColumnOffset){orFormat.mCustomFormat="General";orFormat.mFormatType=$NC.General;orFormat.mGrouping=0;if(!this.mHasMetrics||this.dataProvider===null){return false;}this.getChartAdvFormatForOneCell({S:iSeriesId,G:iGroupId,D:iColumnOffset},orFormat,true);return true;},getGridDataFormatForPie:function getGridDataFormatForPie(format,pieSliceId){var seriesId=pieSliceId.mSeriesId,groupId=pieSliceId.mGroupId,angleById=pieSliceId.angleByIndex,sliceById=pieSliceId.sliceById,graphCell,sliceCount,formatObject;format.mCustomFormat="General";format.mFormatType=$NC.General;format.mGrouping=0;if(!this.mHasMetrics||this.dataProvider===null){return false;}graphCell=this.dataProvider.getGraphCell(seriesId,groupId).getSinglePieDPs();if(graphCell&&graphCell.length>0&&angleById<graphCell.length){graphCell=graphCell[angleById];if(graphCell){sliceCount=graphCell.getSliceCount();if(sliceById<sliceCount){formatObject=graphCell.getMetric(sliceById);if(formatObject&&formatObject.fullNf){hParseValueToFormat.call(this,formatObject.fullNf,format);return true;}}}}return false;},getSizeByDataFormat:function getSizeByDataFormat(orFormat,iSeriesId,iGroupId){var graphCell=this.dataProvider.getGraphCell(iSeriesId,iGroupId);if(graphCell){var formatObject=graphCell.getSizeByMetricFormat();if(formatObject.fullNf){hParseValueToFormat.call(this,formatObject.fullNf,orFormat);}}},getChartAdvFormatForOneCell:function getChartAdvFormatForOneCell(position,chartAdvFormat,resolved){position.D=position.D||0;resolved=resolved||false;var formatObject=this.dataProvider.getGraphCell(position.S,position.G).getFormat(position.D);if(formatObject.fullNf){hParseValueToFormat.call(this,formatObject.fullNf,chartAdvFormat);}},SetFormatManager:function SetFormatManager(formatManager){this.mpFormatManager=formatManager;},GetStatus:function GetStatus(){return this.mStatus;},SetSeriesByColumn:function SetSeriesByColumn(seriesByColumn){this.mSeriesByColumn=seriesByColumn;},GetSeriesByColumn:function GetSeriesByColumn(){return this.mSeriesByColumn;},getHostMetricIndex:function getHostMetricIndex(seriesId,groupId,dataIndex){dataIndex=dataIndex!==undefined?dataIndex:0;return this.dataProvider.getGraphCell(seriesId,groupId).getMetricIndex(dataIndex);},GetSliceGroupRange:function GetSliceGroupRange(){return{};},GetSliceFlag:function GetSliceFlag(){return false;},EnableSlices:function EnableSlices(){},GetThresholdFillColor:function GetThresholdFillColor(s,g,d){return this.dataProvider.getGraphCell(s,g).getThreshold(d).Color;},GetZoomScale:function GetZoomScale(){return 1;},IsHeaderEmpty:function IsHeaderEmpty(isRow){isRow=isRow||false;return false;},CountMetric:function CountMetric(){return this.dataProvider.getMetricsCount();},isMetricBySeries:function isMetricBySeries(){return((!this.dataProvider.isMetricOnRowAxis()&&this.mSeriesByColumn)||(this.dataProvider.isMetricOnRowAxis()&&!this.mSeriesByColumn));},GetOneMetricName:function GetOneMetricName(idx){return this.dataProvider.getOneMetricName(idx);},GetMetricNumberFormat:function GetMetricNumberFormat(format,metricIndex){var modelMetricFormat=this.dataProvider.getMetricFormat(metricIndex,true);hParseValueToFormat.call(this,modelMetricFormat.fullNf,format);},GetPeakValuesAcrossSeries:function GetPeakValuesAcrossSeries(a,b,c,d){},GetSeriesByShape:function GetSeriesByShape(shape){var useCache=true;if(useCache){this.seriesByShapeMap=this.seriesByShapeMap||{Tick:null,Line:null,Bar:null,Area:null,Circle:null,Square:null,Pie:null,All:null};var key=shape||"All";var result=this.seriesByShapeMap[key];if(result===null){if(key==="All"){result=result=this.seriesByShapeMap[key]=this.dataProvider.getSeriesByShape(shape);}else{result=this.seriesByShapeMap[key]=this.dataProvider.getSeriesByShape(shape).contact();}}return result;}else{return this.dataProvider.getSeriesByShape(shape);}},GetShapeBySeries:function GetShapeBySeries(idx){return this.dataProvider.getShapeBySeries(idx);},GetShapeByCell:function GetShapeByCell(seriesId,groupId){var gc=this.dataProvider.getGraphCell(seriesId,groupId);if(!!gc){return gc.getShape();}return -1;},GetValueAxisBySeries:function GetValueAxisBySeries(idx){return this.dataProvider.getValueAxisBySeries(idx);},GetSeriesByValueAxis:function GetSeriesByValueAxis(axisIndex){if(this.mSeriesSplit===null){this.mSeriesSplit=[];}var seriesSplit=this.mSeriesSplit;if(!!seriesSplit[axisIndex]===false){var array=this.dataProvider.getSeriesByValueAxis(axisIndex);seriesSplit[axisIndex]=array.slice(0);}return seriesSplit[axisIndex];},GetShapesDistributionByValueAxis:function GetShapesDistributionByValueAxis(axisIndex){if(axisIndex===undefined){axisIndex=2;}var distribution={},key,dist,oneShape,oneIndex,seriesCount=this.GetSeriesCount(),i;for(i=0;i<seriesCount;++i){if(axisIndex===0||axisIndex===2){distribution.Primary=distribution.Primary||{};}if(axisIndex===1||axisIndex===2){distribution.Secondary=distribution.Secondary||{};}oneIndex=this.GetValueAxisBySeries(i);oneShape=this.GetShapeBySeries(i);if(oneIndex===axisIndex||axisIndex===2){dist=oneIndex===0?distribution.Primary:distribution.Secondary;switch(oneShape){case 0:key="AREA";break;case 1:key="BAR";break;case 2:key="LINE";break;case 4:key="CIRCLE";break;case 5:key="RECTANGLE";break;case 6:key="SQUARE";break;case 7:key="TICK";break;case 10:key="PIE";break;default:key="Generic";break;}dist[key]=dist[key]||[];dist[key].push(oneIndex);}}return distribution;},GetTrendLinePropertiesBySeries:function GetTrendLinePropertiesBySeries(idx){idx=idx||0;return{};},GetTrendLinesOfChart:function GetTrendLinesOfChart(){return this.dataProvider.getTrendsOfChart();},GetTrendLineOfSeries:function GetTRendLineOfSeries(seriesId){var trendLines=this.dataProvider.getTrendsOfChart(),trendLine,result=null,i;if(trendLines&&trendLines.length){for(i=0;i<trendLines.length;++i){trendLine=trendLines[i];if(trendLine){if(trendLine.seriesId===seriesId){result=trendLine;break;}}}}return result;},GetReferenceLinesOfChart:function GetReferenceLinesOfChart(){return this.dataProvider.getRefsOfChart();},GetReferenceLinesOfSeries:function GetReferenceLinesOfSeries(seriesId){var refLines=this.dataProvider.getRefsOfChart(),refLine,result=[],i;if(refLines&&refLines.length){for(i=0;i<refLines.length;++i){refLine=refLines[i];if(refLine){if(refLine.seriesId===seriesId){result.push(refLine);}}}}return result;},GetTextLabel:function GetTextLabel(seriesId,groupId,angleId,sliceId){angleId=angleId||0;sliceId=sliceId||0;return this.dataProvider.getTextLabel(seriesId,groupId,angleId,sliceId);},GetBannerText:function GetBannerText(seriesId,groupId,helpId){return"Demo Demo Demo Demo Demo Demo Demo Demo Demo Demo";},GetDiscreteSeries:function GetDiscreteSeries(){if(this.mDiscreteSeries===null){this.mDiscreteSeries=this.dataProvider.GetDiscreteSeries().slice(0);}return this.mDiscreteSeries;},GetSeriesIndexByPriority:function GetSeriesIndexByPriority(){return this.dataProvider.getPrioritizedSeriesIndex();},updateDataWindow:function updateDataWindow(props){if(props.PartialRendering===true){this.useSliceWindow=true;var series=props.Series;if(series){this.startSeries=series.Min;this.startSeries=Math.max(0,this.startSeries);this.endSeries=series.Max;this.endSeries=Math.max(this.startSeries,this.endSeries);}var group=props.Group;if(group){this.startGroup=group.Min;this.startGroup=Math.max(0,this.startGroup);this.endGroup=group.Max;this.endGroup=Math.max(this.startGroup,this.endGroup);}}},resetDataWindow:function resetDataWindow(){this.useSliceWindow=false;this.startGroup=this.endGroup=-1;this.startSeries=this.endSeries=-1;},getBandNumber:function getBandNumber(){return 3;},getTargetNumber:function getTargetNumber(){return 1;},getBandsByGroup:function getBandsByGroup(groupIndex,valueAxisIndex){return{Divisions:{Ratios:null,Metrics:null},Descent:false,Colors:null};},getBandDivision:function getBandDivision(groupIndex,valueAxisIndex){return{Ratios:null,Metrics:null};},getDataLabelFontFormat:function getDataLabelFontFormat(){var returnVal=this.dataProvider.getDataLabelFontFormat(),format={mFontAlignment:null,mFontStyle:returnVal.dlFntStyle,mFontAlpha:255,mFontBox:0,mFontName:returnVal.dlFntFml,mFontSize:returnVal.dlFntSz};var color=returnVal.dlFntClr;if(color!==null&&color!==undefined){format.mFontColor=color;}return format;},showHideItemsOnAxis:function showHideItemsOnAxis(whichAxis){var result,showHide=this.dataProvider.getAxisFormats(whichAxis,"showHide");if(whichAxis==="x1"||whichAxis==="x2"||whichAxis==="X1"||whichAxis==="X2"){result={axisBody:showHide[$FORMAT_TAG.X_AXIS_LINE_SHOW]||false,axisLabels:showHide[$FORMAT_TAG.X_AXIS_LABELS_SHOW]||false,majorGrids:showHide[$FORMAT_TAG.MAJOR_GRID_LINES_SHOW]||false,minorGrids:showHide[$FORMAT_TAG.MINOR_GRID_LINES_SHOW]||false};}else{if(whichAxis==="y1"||whichAxis==="y2"||whichAxis==="Y1"||whichAxis==="Y2"){result={axisBody:showHide[$FORMAT_TAG.Y_AXIS_LINE_SHOW]||false,axisLabels:showHide[$FORMAT_TAG.Y_AXIS_LABELS_SHOW]||false,majorGrids:showHide[$FORMAT_TAG.MAJOR_GRID_LINES_SHOW]||false,minorGrids:showHide[$FORMAT_TAG.MINOR_GRID_LINES_SHOW]||false};}}return result;},showSeriesDatalabel:function showSeriesDatalabel(seriesId){if(this.dataLabelStyle===kHidelabels){return false;}var isPie,returnVal,cellIndex,graphCell=this.dataProvider.getGraphCell(seriesId,0,true);if(graphCell===null||graphCell.isFaked){cellIndex=this.findCell(false,seriesId,0);graphCell=this.dataProvider.getGraphCell(seriesId,cellIndex,true);}if(graphCell){isPie=graphCell.chtInfo&&graphCell.chtInfo.isPie;if(isPie){var i,sliceCount=graphCell.getSinglePieDPs()[0].getSliceCount();for(i=0;i<sliceCount;++i){if(this.showPieSliceDatalabel(seriesId,0,0,i)){return true;}}}else{returnVal=graphCell.getFormattingProperties();return returnVal&&(!!returnVal[$FORMAT_TAG.DATA_LABELS_SHOW]);}}return false;},showPieSliceDatalabel:function showPieSliceDatalabel(seriesId,groupId,angleId,sliceId){angleId=angleId||0;sliceId=sliceId||0;if(this.dataLabelStyle===kHidelabels){return false;}var returnVal,graphCell=this.dataProvider.getGraphCell(seriesId,groupId,true).getSinglePieDPs();if(graphCell&&graphCell.length>0){graphCell=graphCell[angleId];if(graphCell){returnVal=graphCell.getFormattingProperties(sliceId);return returnVal&&(!!returnVal[$FORMAT_TAG.DATA_LABELS_SHOW]);}return false;}return false;},showPieDatalabels:function showPieDatalabels(){if(this.dataLabelStyle===kHidelabels){return false;}if(this.gp.showDatalabels!==undefined){return this.gp.showDatalabels;}var i,j,angleCount=this.GetAngleNumber(),sliceCount=this.GetPieSliceCount(0,0,0);for(j=0;j<angleCount;++j){for(i=0;i<sliceCount;++i){if(this.showPieSliceDatalabel(0,0,j,i)){this.gp.showDatalabels=true;return true;}}}this.gp.showDatalabels=false;return false;},showDatalabels:function showDatalabels(){if(this.dataLabelStyle===kHidelabels){return false;}if(this.gp.showDatalabels!==undefined){return this.gp.showDatalabels;}var i,seriesCount=this.GetSeriesCount();for(i=0;i<seriesCount;++i){if(this.showSeriesDatalabel(i)){this.gp.showDatalabels=true;return true;}}this.gp.showDatalabels=false;return false;},onlyBarDataLabelEnabled:function onlyBarDataLabelEnabled(){var i,seriesCount=this.GetSeriesCount(),countOfBarSeriesWithDataLabel=0,shape;if(this.dataLabelStyle===kHidelabels){return false;}for(i=0;i<seriesCount;++i){if(this.showSeriesDatalabel(i)){shape=this.GetShapeBySeries(i);if(shape===$SHP._BAR){++countOfBarSeriesWithDataLabel;}else{return false;}}}return(countOfBarSeriesWithDataLabel>0);},getAllFormats:function getAllFormats(tripleId){this.genericFormats=this.genericFormats||{id:{},formats:{}};var genericFormats=this.genericFormats;for(var key in tripleId){if(genericFormats.id[key]!==tripleId[key]){return null;}}return genericFormats.formats;},setAllFormats:function getAllFormats(tripleId,formats){this.genericFormats=this.genericFormats||{id:{},formats:{}};var genericFormats=this.genericFormats;genericFormats.id=$HASH.copy(tripleId);genericFormats.formats=formats;},getGenericLineFormat:function getGenericLineFormat(seriesId,groupId,offsetId,subIndex,lineType){var graphCell,fmt,modelFmt;if(lineType==="pieSliceBorder"){offsetId=offsetId||0;var PieDPs=this.dataProvider.getGraphCell(seriesId,groupId).getSinglePieDPs();graphCell=PieDPs[offsetId];}else{graphCell=this.dataProvider.getGraphCell(seriesId,groupId);if(!!graphCell){if(graphCell.isFaked){graphCell=this.dataProvider.innerGetGraphCell(seriesId,groupId);}}}if(graphCell){modelFmt=graphCell.getFormattingProperties(subIndex);fmt=hGetShapeLineFormat(modelFmt,lineType);}var attributes;switch(lineType){case"lineShape":attributes=["shpLnClr","shpLnStyle","shpLnThk"];break;case"targetLine":break;case"lineMarker":attributes=["lnMkBdrClr",$FORMAT_TAG.LINE_MARKER_STYLE,$FORMAT_TAG.LINE_MARKER_THICKNESS];break;case"shapeBorder":case"pieSliceBorder":attributes=["shpBdrClr","shpBdrStyle","shpBdrThk"];break;default:attributes=["shpBdrClr","shpBdrStyle","shpBdrThk"];break;}return hMapToLineProperties.call(this,fmt||modelFmt,attributes);},getGenericFillFormat:function getGenericFillFormat(seriesId,groupId,offsetId,subIndex,fillType){var graphCell,modelFmt;if(fillType==="pieSlice"){offsetId=offsetId||0;var PieDPs=this.dataProvider.getGraphCell(seriesId,groupId).getSinglePieDPs();graphCell=PieDPs[offsetId];}else{graphCell=this.dataProvider.getGraphCell(seriesId,groupId);}if(graphCell){modelFmt=graphCell.getFormattingProperties(subIndex);}modelFmt=modelFmt||{};var attributes;switch(fillType){case"pieSlice":case"shape":attributes=["shpFillClr","shpFillStyle","shpFillTrans","shpFillEff"];break;case"lineMarker":attributes=["lnMkClr"];break;default:attributes=["shpFillClr","shpFillStyle","shpFillTrans","shpFillEff"];break;}var result={mSimpleColor:null,mAlpha:255,mFillType:0};if(attributes[1]&&modelFmt[attributes[1]]!==undefined){result.mFillType=modelFmt[attributes[1]];}if(attributes[2]&&modelFmt[attributes[2]]!==undefined){result.mAlpha=Math.round(255*modelFmt[attributes[2]]/100);}var color=modelFmt[attributes[0]];if(color!==null&&color!==undefined){var kSolid=0,kGradient=14;var gradientLinear=14,gradientCircular=9;if(typeof color==="string"&&color==="transparent"){result.mAlpha=0;return result;}switch(result.mFillType){case kSolid:result.mSimpleColor=color;break;case kGradient:if(typeof color==="object"){result.mFillGradient={startGraphColor:color.c1,endGraphColor:color.c2,angle:1-color.or,horizontalOffset:50,verticalOffset:50,gradientType:(fillType==="pieSlice"?gradientCircular:gradientLinear),endAlpha:255,intermediateColors:[],style:1};}break;default:result.mFillType=kSolid;if(typeof color==="number"){result.mSimpleColor=color;}break;}}return result;},getMarkerShapeInfoAt:function getMarkerShapeInfoAt(seriesId,groupId){var graphCell,modelFmt,markerSize=1,show=false,markerType=0;graphCell=this.dataProvider.getGraphCell(seriesId,groupId);if(graphCell&&!!graphCell.isFaked===false){modelFmt=graphCell.getFormattingProperties();show=modelFmt.lnMkShw;markerType=modelFmt.lnMkShp;markerSize=modelFmt.lnMkSz;}return{Show:show,Size:markerSize,Shape:markerType};},isLogScaleAxis:function isLogScaleAxis(whichAxis){return !!this.dataProvider.isLogScale(whichAxis);},isGradientABL:function isGradientABL(){return this.dataProvider.isGradientABL();},getAxisOriginFormat:function getAxisOriginFormat(whichAxis){var attributes,axisTickFormat=this.dataProvider.getAxisFormats(whichAxis,"axisOrigin");if(whichAxis==="x1"||whichAxis==="x2"||whichAxis==="X1"||whichAxis==="X2"){attributes=["xAxOriLnClr","xAxOriLnStyle","xAxOriLnThk","xAxOriLnShw"];}else{if(whichAxis==="y1"||whichAxis==="y2"||whichAxis==="Y1"||whichAxis==="Y2"){attributes=["yAxOriLnClr","yAxOriLnStyle","yAxOriLnThk","yAxOriLnShw"];}}var result=hMapToLineProperties.call(this,axisTickFormat,attributes);result.show=axisTickFormat[attributes[3]];result.number=this.dataProvider.getAxisOriginValue(whichAxis);return result;},getAxisTickFormat:function getAxisTickFormat(whichAxis,tickType){var attributes,axisTickFormat=this.dataProvider.getAxisFormats(whichAxis,tickType);if(tickType==="majorTick"){attributes=["majorGridLnClr","majorGridLnStyle","majorGridLnThk"];}else{attributes=["minorGridLnClr","minorGridLnStyle","minorGridLnThk"];}return hMapToLineProperties.call(this,axisTickFormat,attributes);},getAxisLineFormat:function getAxisLineFormat(whichAxis){var attributes,axisLineFormat=this.dataProvider.getAxisFormats(whichAxis,"body");if(whichAxis==="x1"||whichAxis==="x2"||whichAxis==="X1"||whichAxis==="X2"){attributes=[$FORMAT_TAG.X_AXIS_LINE_COLOR,$FORMAT_TAG.X_AXIS_LINE_STYLE,$FORMAT_TAG.X_AXIS_LINE_THICKNESS];}else{if(whichAxis==="y1"||whichAxis==="y2"||whichAxis==="Y1"||whichAxis==="Y2"){attributes=[$FORMAT_TAG.Y_AXIS_LINE_COLOR,$FORMAT_TAG.Y_AXIS_LINE_STYLE,$FORMAT_TAG.Y_AXIS_LINE_THICKNESS];}}return hMapToLineProperties.call(this,axisLineFormat,attributes);},findCell:function findCell(fromSeries,index,target){target=target||0;var total,i,cell,isIndividualFormat;if(fromSeries===false){total=this.dataProvider.getGroupCount();}else{total=this.dataProvider.getSeriesCount();}for(i=0;i<total;i++){if(fromSeries===false){cell=this.dataProvider.getGraphCell(index,i);}else{cell=this.dataProvider.getGraphCell(i,index);}if(!!cell===false||cell.isFaked){continue;}isIndividualFormat=cell.isIndividualFormatted();if(target===0){if(isIndividualFormat===false){return i;}}else{if(isIndividualFormat){return i;}}}return -1;},getUniformAxis:function getUniformAxis(whichAxis,isMirrored){return null;},finalize:function finalize(){this.dataProvider.resetDPCache();},allowDatalabelOverlap:function allowDatalabelOverlap(){var dataProvider=this.dataProvider;return dataProvider&&dataProvider.allowDatalabelOverlap();},getAxisLabelFontFormat:function getAxisLabelFontFormat(whichAxis){var attributes,fontRotation,color,axisLabelFormat=this.dataProvider.getAxisFormats(whichAxis,"axisLabel");if(whichAxis==="x1"||whichAxis==="x2"||whichAxis==="X1"||whichAxis==="X2"){attributes=[$FORMAT_TAG.X_AXIS_LABELS_FONT_SIZE,$FORMAT_TAG.X_AXIS_LABELS_FONT_FAMILY,$FORMAT_TAG.X_AXIS_LABELS_FONT_STYLE,$FORMAT_TAG.X_AXIS_LABELS_ROTATION,$FORMAT_TAG.X_AXIS_LABELS_FONT_COLOR];}else{if(whichAxis==="y1"||whichAxis==="y2"||whichAxis==="Y1"||whichAxis==="Y2"){attributes=[$FORMAT_TAG.Y_AXIS_LABELS_FONT_SIZE,$FORMAT_TAG.Y_AXIS_LABELS_FONT_FAMILY,$FORMAT_TAG.Y_AXIS_LABELS_FONT_STYLE,$FORMAT_TAG.Y_AXIS_LABELS_ROTATION,$FORMAT_TAG.Y_AXIS_LABELS_FONT_COLOR];}}fontRotation=axisLabelFormat[attributes[3]];if(fontRotation===-1){fontRotation=0;}color=axisLabelFormat[attributes[4]];return{mFontSize:parseInt(axisLabelFormat[attributes[0]],10),mFontName:axisLabelFormat[attributes[1]],mFontStyle:axisLabelFormat[attributes[2]],mFontRotation:fontRotation,mFontAlignment:1,mFontBox:0,mFontColor:color===undefined?null:color,mFontAlpha:255};},refresh:function refresh(dp){if(dp){this.dataProvider=dp;this.reset();}},getForecastCount:function getForecastCount(){var dataProvider=this.dataProvider;return(dataProvider.fwdSteps+dataProvider.bwdSteps);},saveShownLabels:function backupShowLables(valueAxis){var dp=this.dataProvider,mLabelList=valueAxis.mLabelList,len=mLabelList&&mLabelList.length,shownAxisTicks=[],i;for(i=0;i<len;i++){if(mLabelList[i].mIsShown){shownAxisTicks.push(mLabelList[i].mNumber);}}dp.backupTicks=dp.backupTicks||{};dp.backupTicks[valueAxis.Key]=shownAxisTicks;},fetchShownLabels:function fetchShownLables(savedInRow){var dp=this.dataProvider,model=dp.lds.gmm,gmCtr=model.gmCtr,newDp,backupTicks;var convertDP=function(){var newLdsIdx,newLds,newDps;newLdsIdx=gmCtr.mapFromChartToLDSIndex(this.rowIndex,this.colIndex);newLds=savedInRow?model.getLocalDataSet(newLdsIdx.r,0):model.getLocalDataSet(0,newLdsIdx.c);newDps=newLds.generateDataProvider();return newDps[newLdsIdx.dpIdx];};newDp=convertDP.call(dp);backupTicks=newDp.backupTicks;return backupTicks;}});}());
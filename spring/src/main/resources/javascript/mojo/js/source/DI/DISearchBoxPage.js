(function(){mstrmojo.requiresCls("mstrmojo.ui.Splitter","mstrmojo.DI.DIPreviewSimple","mstrmojo.DI.DISearchBox");mstrmojo.requiresDescs(10,12882);var FIRST_ITEM_SLOT="firstSplitNode",SECOND_ITEM_SLOT="secondSplitNode",updatedConfig={firstSplit:{v:"25%",min:"200px",max:undefined},secondSplit:{v:"75%",min:"150px",max:undefined},resizeHandle:{v:"2px"}};mstrmojo.DI.DISearchBoxPage=mstrmojo.declare(mstrmojo.ui.Splitter,null,{orientation:mstrmojo.ui.Splitter.ENUM_OR.VERTICAL,showOperators:true,showAdvancedOptions:false,showFetchOptions:false,tableID:"",searchPanel:undefined,previewPanel:undefined,advancedProperties:undefined,headerLabelText:mstrmojo.desc(10,"Search"),placeHolderText:mstrmojo.desc(10,"Search"),searchTerm:undefined,iconCssClass:"",noDataErrorString:mstrmojo.desc(12882,"No data was returned, please try another search string."),hideSignout:false,searchBoxHint:"",config:{firstSplit:{v:"100%",min:"200px",max:undefined},secondSplit:{v:"0%",min:"0px",max:undefined},resizeHandle:{v:"0px"}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},onSearchClick:function onSearchClick(query){if(this.searchPanel&&this.searchPanel.searchFieldNode){this.searchPanel.searchFieldNode.blur();}},handleSearchChange:function handleSearchChange(evt){this.searchText=this.searchPanel.getSearchQuery();if(evt.e.keyCode===13&&this.searchText!==""){this.onSearchClick(this.searchText);}},refreshSearch:function refreshSearch(){if(this.searchParam!==undefined){this.searchPanel.searchFieldNode.value=this.searchParam;}if(this.fetchNum){this.searchPanel.fetchNode.children[0].value=this.fetchNum;}},updatePageLayout:function updatePageLayout(){this.searchPanel.updateLayout();},toggleDataPreview:function toggleDataPreview(show){this.refreshConfig();this.updatePageLayout();this.toggleSecondItemVisibility(show);},children:[{scriptClass:"mstrmojo.DI.DISearchBox",alias:"searchPanel",bindings:{headerLabelText:function(){return this.parent.headerLabelText;},placeHolderText:function(){return this.parent.placeHolderText;},showOperators:function(){return this.parent.showOperators;},showFetchOptions:function(){return this.parent.showFetchOptions;},showAdvancedOptions:function(){return this.parent.showAdvancedOptions;},noDataErrorString:function(){return this.parent.noDataErrorString;},hideSignout:function(){return this.parent.hideSignout;},hint:function(){return this.parent.searchBoxHint;},iconCssClass:function(){return this.parent.iconCssClass;}},slot:FIRST_ITEM_SLOT},{scriptClass:"mstrmojo.DI.DIPreviewSimple",slot:SECOND_ITEM_SLOT,alias:"previewPanel"}],setDimensions:function setDimensions(h,w){var i,height=parseInt(h,10),width=parseInt(w,10);if(isNaN(height)||isNaN(width)){return ;}if(this._super){this._super(h,w);}this.set("height",h);this.set("weight",w);if(!this.children){return ;}for(i=0;i<this.children.length;i++){if(this.children[i].setDimensions){this.children[i].setDimensions(h,w);}else{this.children[i].set("height",h);this.children[i].set("weight",w);}}},browserResized:function(sWidth,sHeight){var width=parseInt(sWidth,10)+"px",height=parseInt(sHeight,10)+"px";if(this.height&&height!==this.height){this.set("height",height);}else{this.height=height;}if(this.width&&width!==this.width){this.set("width",width);}else{this.width=width;}return true;},updatePageConfig:function(config){var page=this;if(config&&config.properties){mstrmojo.hash.forEach(config.properties,function(value,key){page.set(key,value);});}},populate:function populate(evt){if(evt&&evt.targetPageId){if(evt.targetPageId!==this.id){return ;}}this.searchPanel.populate(evt);},postBuildRendering:function postBuildRendering(){if(this._super){this._super();}this.browserResized(this.domNode.parentNode.style.width,this.domNode.parentNode.style.height);mstrApp.getRootController().model.externalSources[this.sourceObjectsInfo.type].attachEventListener("oAuthReportsFetched",this.id,this.populate);},getTableId:function getTableId(){var tblID=this.tableID;if(tblID===""){tblID=this.searchPanel.previewTableId;}return tblID;},refreshConfig:function refreshConfig(){this.config=updatedConfig;}});}());
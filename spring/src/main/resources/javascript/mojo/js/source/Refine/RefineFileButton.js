(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.requiresDescs(1825);var _D=mstrmojo.dom;mstrmojo.Refine.RefineFileButton=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Refine.RefineFileButton",browseLabel:mstrmojo.desc(1825,"Browse")+"...",markupString:'<span class="refine-file-button" mstrAttach:click>{@browseLabel}<input type="file" mstrAttach:change/></span>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline-block":"none";}},markupSlots:{inputNode:function(){return this.domNode.lastChild;}},onclick:function(evt){if(mstrApp.isSingleTier){var text=window.FormWrapper.loadDWHistoryList();this.parent.textArea.set("value",text);this.parent.textArea.oninput();}else{var e=evt.e,t=_D.eventTarget(evt.hWin,e);if(t!==this.inputNode){this.inputNode.click();}}},onchange:function(){var fileToLoad=this.inputNode.files[0];var me=this;var fileReader=new FileReader();fileReader.onload=function(fileLoadedEvent){var textFromFileLoaded=fileLoadedEvent.target.result;me.parent.textArea.set("value",textFromFileLoaded);me.parent.textArea.oninput();};fileReader.readAsText(fileToLoad,"UTF-8");this.inputNode.value="";}});})();
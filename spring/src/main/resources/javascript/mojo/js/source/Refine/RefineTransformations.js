(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Refine.RefineSearchablePulldown","mstrmojo.Refine.RefineConstants");mstrmojo.requiresDescs(629,6052,6051,12316,12317,12318,12319,12320,12321,4728,14539,14540,14541,14542,12327,12328,12329,12330,12331,12332,12333,12334,12335,14268,14269,14270,12339,12340,12341,12342,12343,12344,12345,3627,12346,14274,1388,12347,12348,12349,13647,13884,13957,13958,12575,12577,190,14514,14515,14516);var constants=mstrmojo.Refine.RefineConstants;var _C=mstrmojo.css;var _D=mstrmojo.dom;var transformations=[{name:mstrmojo.desc(629,"Delete"),type:constants.transformationType.Delete,items:[{name:mstrmojo.desc(12575,"Delete Column"),subType:constants.transformationSubType.DeleteColumn},{name:mstrmojo.desc(12577,"Delete Row"),subType:constants.transformationSubType.DeleteRow},{name:mstrmojo.desc(12316,"Remove Duplicate Cells"),subType:constants.transformationSubType.RemoveDuplicateCells},{name:mstrmojo.desc(12317,"Remove Duplicate Rows"),subType:constants.transformationSubType.RemoveDuplicateRows,noColumn:true},{name:mstrmojo.desc(null,"Delete Row Included In Selectors"),subType:constants.transformationSubType.DeleteRowsInTheView},{name:mstrmojo.desc(null,"Delete Row Not-included In Selectors"),subType:constants.transformationSubType.DeleteRowsNotInTheView}]},{name:mstrmojo.desc(12318,"Extract"),type:constants.transformationType.Extract,items:[{name:mstrmojo.desc(12319,"Extract By Fixed Length"),subType:constants.transformationSubType.ExtractByFixedLength},{name:mstrmojo.desc(12320,"Extract Before Separator"),subType:constants.transformationSubType.ExtractBeforeSeparator},{name:mstrmojo.desc(12321,"Extract After Separator"),subType:constants.transformationSubType.ExtractAfterSeparator}]},{name:mstrmojo.desc(4728,"Selector"),type:constants.transformationType.Facet,items:[{name:mstrmojo.desc(14539,"Text Selector"),subType:constants.transformationSubType.TextFacet},{name:mstrmojo.desc(14540,"Numeric Selector"),subType:constants.transformationSubType.NumericFacet},{name:mstrmojo.desc(14541,"Timeline Selector"),subType:constants.transformationSubType.TimelineFacet},{name:mstrmojo.desc(14542,"Text Search"),subType:constants.transformationSubType.SearchFacet}]},{name:mstrmojo.desc(12327,"Find And Replace"),type:constants.transformationType.FindAndReplace,items:[{name:mstrmojo.desc(12328,"Find And Replace Characters In Cell"),subType:constants.transformationSubType.FindAndReplaceCharactersInCell},{name:mstrmojo.desc(12329,"Find And Replace Cell"),subType:constants.transformationSubType.FindAndReplaceCell}]},{name:mstrmojo.desc(190,"Remove"),type:constants.transformationType.RemoveText,items:[{name:mstrmojo.desc(14514,"Remove Characters"),subType:constants.transformationSubType.RemoveTheText},{name:mstrmojo.desc(14515,"Remove Characters Before"),subType:constants.transformationSubType.RemoveTheTextBefore},{name:mstrmojo.desc(14516,"Remove Characters After"),subType:constants.transformationSubType.RemoveTheTextAfter}]},{name:mstrmojo.desc(12330,"Split"),type:constants.transformationType.Split,items:[{name:mstrmojo.desc(12331,"Split By Fixed Length"),subType:constants.transformationSubType.SplitByFixedLength},{name:mstrmojo.desc(12332,"Split On Separator"),subType:constants.transformationSubType.SplitOnSeparator},{name:mstrmojo.desc(12333,"Split Before Separator"),subType:constants.transformationSubType.SplitBeforeSeparator},{name:mstrmojo.desc(12334,"Split After Separator"),subType:constants.transformationSubType.SplitAfterSeparator},{name:mstrmojo.desc(13884,"Split Cell Into Rows On Separator"),subType:constants.transformationSubType.SplitCellIntoRows}]},{name:mstrmojo.desc(12335,"Transform Cell"),type:constants.transformationType.TransformCell,items:[{name:mstrmojo.desc(14268,"To Title Case"),subType:constants.transformationSubType.Titlecase},{name:mstrmojo.desc(14269,"To Uppercase"),subType:constants.transformationSubType.Uppercase},{name:mstrmojo.desc(14270,"To Lowercase"),subType:constants.transformationSubType.Lowercase},{name:mstrmojo.desc(12339,"Unescape HTML"),subType:constants.transformationSubType.UnescapeHTML},{name:mstrmojo.desc(12340,"Change Data Type"),subType:constants.transformationSubType.ChangeDataType},{name:mstrmojo.desc(12341,"Fill Down"),subType:constants.transformationSubType.FillDown},{name:mstrmojo.desc(12342,"Blank Down"),subType:constants.transformationSubType.BlankDown},{name:mstrmojo.desc(13957,"Pad Before"),subType:constants.transformationSubType.PadBefore},{name:mstrmojo.desc(13958,"Pad After"),subType:constants.transformationSubType.PadAfter}]},{name:mstrmojo.desc(12343,"Whitespace"),type:constants.transformationType.Whitespace,items:[{name:mstrmojo.desc(12344,"Trim Leading And Trailing Whitespace"),subType:constants.transformationSubType.TrimLeadingTrailingWhitespace},{name:mstrmojo.desc(12345,"Collapse Consecutive Whitespace"),subType:constants.transformationSubType.CollapseConsecutiveWhitespace}]},{name:mstrmojo.desc(3627,"Other"),type:constants.transformationType.Other,items:[{name:mstrmojo.desc(12346,"Cluster And Edit"),subType:constants.transformationSubType.ClusterAndEdit},{name:mstrmojo.desc(14274,"Duplicate Column"),subType:constants.transformationSubType.Duplicate},{name:mstrmojo.desc(1388,"Rename"),subType:constants.transformationSubType.Rename},{name:mstrmojo.desc(12347,"Concatenate Columns"),subType:constants.transformationSubType.ConcatenateColumns},{name:mstrmojo.desc(13975,"Transpose Columns To Rows"),subType:constants.transformationSubType.TransposeColumnsToRows}]}];mstrmojo.Refine.RefineTransformations=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.Refine.RefineTransformations",alias:"RefineTransformations",markupString:'<div class="refine-transformations" mstrAttach:mousedown><div class="refine-transformations-top"><div class="refine-transformations-columns"></div><div class="refine-transformations-functions"></div><div class="refine-transformations-control"></div></div><div class="refine-transformations-suggestions"></div></div>',markupSlots:{transformationNode:function(){return this.domNode.children[0];},columnsNode:function(){return this.domNode.children[0].children[0];},functionNode:function(){return this.domNode.children[0].children[1];},controlNode:function(){return this.domNode.children[0].children[2];},suggestionsNode:function(){return this.domNode.children[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},setDimensions:function setDimensions(h,w){var height=parseInt(h,10);var width=parseInt(w,10);if(isNaN(height)||isNaN(width)){return ;}if(!this.layoutConfig){this.layoutConfig={h:{},w:{}};}var headerNodeHeight=44;_C.toggleClass(this.domNode,"selected",true);var contentWidth=Math.floor(width*0.65);if(contentWidth<980){_C.toggleClass(this.domNode,"short",true);}else{_C.toggleClass(this.domNode,"short",false);}contentWidth=Math.max(Math.floor(width*0.65),618);this.layoutConfig.h.transformationNode=headerNodeHeight+"px";this.layoutConfig.w.transformationNode=contentWidth+"px";this.layoutConfig.h.suggestionsNode=(height-headerNodeHeight-14)+"px";this.layoutConfig.w.suggestionsNode=(contentWidth-14)+"px";if(this._super){this._super(height+"px",contentWidth+"px");}},postBuildRendering:function postBuildRendering(){this.setDimensions(this.parent.domNode.style.height,this.parent.domNode.style.width);if(this._super){this._super();}},onmousedown:function(evt){var e=evt.e,t=_D.eventTarget(evt.hWin,e);if(t.className.indexOf("mstrmojo-scrollbar")===-1){this.controller.isClickedInTransformation=true;_D.stopPropogation(evt.hWin,evt.e);}},populate:function populate(data){var items=[],i;for(i=0;i<data.columns.length;i++){items.push({n:data.columns[i].name,name:data.columns[i].name,columnIndex:i,cellIndex:data.columns[i].cellIndex});}items.sort(function(a,b){return a.n.localeCompare(b.n);});this.columns.selectedIndex=null;this.columns.set("items",items);},handleColumnsChanged:function handleColumnsChanged(event){this.populate(event.value);},handleColumnSelected:function(event){var i,items=this.columns.list.items;for(i=0;i<items.length;i++){if(event.columnIndex===items[i].columnIndex){if(this.columns.list.selectedIndex!==i){this.columns.list.set("selectedIndex",i);}}}},handleColumnUnSelected:function(){this.columns.set("value",mstrmojo.desc(12348,"Select Column"));this.columns.set("text",mstrmojo.desc(12348,"Select Column"));this.columns.selectedIndex=undefined;this.columns.list.set("selectedIndex",null);_C.toggleClass(this.columns.domNode,"selected",false);this.transformationList.set("value",mstrmojo.desc(12349,"Select Function"));this.transformationList.set("text",mstrmojo.desc(12349,"Select Function"));this.transformationList.list.set("selectedIndex",null);this.transformationList.set("type",-1);this.transformationList.set("subType",-1);_C.toggleClass(this.transformationList.domNode,"selected",false);_C.toggleClass(this.transformationList.domNode,"disable",true);this.transformationList.selectedNode.title=mstrmojo.desc(13647,"Select a column for more functions");},children:[{slot:"columnsNode",scriptClass:"mstrmojo.Refine.RefineSearchablePulldown",hostedCSSClass:"refine-column-pulldown",cssClass:"refine-pulldown",alias:"columns",allowHTML:false,title:mstrmojo.desc(13647,"Select a column for more functions"),onitemSelected:function(item){_C.toggleClass(this.domNode,"selected",true);_C.toggleClass(this.parent.transformationList.domNode,"disable",false);this.parent.transformationList.selectedNode.title="";this.parent.controller.model.raiseEvent({name:"columnSelected",columnIndex:item.columnIndex,columnName:item.n,updateScrollLeft:true});if(this.parent.transformationList.subType===74){this.parent.transformationList.subType=-1;this.parent.transformationList.set("subType",74);}}},{scriptClass:"mstrmojo.Refine.RefineSearchablePulldown",hostedCSSClass:"refine-transformation-pulldown",cssClass:"refine-pulldown disable",slot:"functionNode",alias:"transformationList",type:-1,subType:-1,preBuildRendering:function(){this.setItems();},setItems:function(){var item,itemClass,big,small,items=[],transformationBig,transformationSmall,transformations2;var i,j,transformationsTemp;transformationsTemp=mstrmojo.hash.clone(transformations);if(mstrApp.getRootController().refineApp.isBDE){transformationsTemp[0].items=transformationsTemp[0].items.slice(0,2);transformationsTemp.splice(2,1);}for(i=0;i<transformationsTemp.length;i++){transformationBig=transformationsTemp[i];big=transformationBig.name;transformations2=transformationBig.items;item={};item.type=transformationBig.type;item.n=big;item.cls="refine-transformations-list-big";item.skipSearch=true;items.push(item);for(j=0;j<transformations2.length;j++){item={};transformationSmall=transformations2[j];small=transformationSmall.name;item.subType=transformationSmall.subType;item.type=transformationBig.type;itemClass="refine-transformations-list-small";if(transformationSmall.noColumn===true){item.noColumn=true;itemClass="refine-transformations-list-small noColumn";}if(transformationSmall.subType===constants.transformationSubType.DeleteRowsInTheView||transformationSmall.subType===constants.transformationSubType.DeleteRowsNotInTheView){var facetPanel=this.parent.controller.refinePanel.bottomPanal.splitter.facetPanel;if(!facetPanel.hasSelection()){item.disable=true;itemClass="refine-transformations-list-small disable";}else{item.noColumn=true;itemClass="refine-transformations-list-small noColumn";}}item.n=small;item.cls=itemClass;items.push(item);}}this.set("items",items);},onitemSelected:function(item){_C.toggleClass(this.domNode,"selected",true);this.set("noColumn",item.noColumn);this.set("subType",item.subType);this.set("type",item.type);},getPopupListConfig:function getpopupListConfig(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",selectionPolicy:"reselect",locksHover:true,listHooks:{select:function select(el,item,index){var transformation=this.parent.parent;var columnIdx=transformation.columns.selectedIndex;if((columnIdx===undefined&&item.noColumn!==true)||item.subType===undefined||item.disable===true){return true;}this.parent.set("selectedIndex",index);this.close();}},getItemProps:function getItemProps(item,idx){return mstrmojo._IsList.getItemProps.call(this,item,idx);}};}}]});}());
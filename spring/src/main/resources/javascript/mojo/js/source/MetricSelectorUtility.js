(function(){mstrmojo.requiresCls("mstrmojo.num","mstrmojo.hash","mstrmojo.string","mstrmojo.array");var $N=mstrmojo.num,$H=mstrmojo.hash,$S=mstrmojo.string,$A=mstrmojo.array;mstrmojo.MetricSelectorUtility=mstrmojo.provide("mstrmojo.MetricSelectorUtility",{_GENERIC:1,_RANK:2,_PERCENT:3,OP:{_EQUALS:0,_NOT_EQUALS:1,_GREATER:2,_GREATER_EQUAL:3,_LESS:4,_LESS_EQUAL:5,_BETWEEN:6,_NOT_BETWEEN:7,_IN:8,_NOT_IN:9,_IS_NULL:10,_IS_NOT_NULL:11},OP_NAMES:[{n:mstrmojo.desc(2795,"Equals"),v:0},{n:mstrmojo.desc(2796,"Does not equals"),v:1},{n:mstrmojo.desc(521,"Greater than"),v:2},{n:mstrmojo.desc(522,"Greater than or equal to"),v:3},{n:mstrmojo.desc(523,"Less than"),v:4},{n:mstrmojo.desc(524,"Less than or equal to"),v:5},{n:mstrmojo.desc(696,"Between"),v:6},{n:mstrmojo.desc(746,"Not between"),v:7},{n:mstrmojo.desc(587,"In"),v:8},{n:mstrmojo.desc(2204,"Not In"),v:9},{n:mstrmojo.desc(2202,"Is null"),v:10},{n:mstrmojo.desc(2203,"Is not null"),v:11}],RANK_OP_NAMES:[{n:mstrmojo.desc(529,"Highest"),v:1},{n:mstrmojo.desc(530,"Lowest"),v:2},{n:mstrmojo.desc(4407,"Highest %"),v:3},{n:mstrmojo.desc(4406,"Lowest %"),v:4}],Q:{_G:0,_RT:1,_RB:2,_PT:3,_PB:4},MRPFN:{TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23},FN:{EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000},F:[[6,7,8,10,9,11,17,44,22,57,54,55],[15,16,4,18,20,1,13,14,22,24],[7,8,5,17,19,2,3,6,21,23]],EnumNumberCategory:{Default:-2,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7,Special:8,General:9,FromGrid:10},typeHelperCls:{0:"MetricValueSliderHelper",defaultCls:"MetricRankSliderHelper"},ErrorType:{_GENERIC:mstrmojo.desc(11689,"Invalid Number"),_RANK:mstrmojo.desc(11856,"Please enter value between ## and ###.")},getQuaByFunc:function(f,ft){var $F=this.F,$Q=this.Q,_result=$Q._G,isTop=function(f){return $A.indexOf($F[1],f)!==-1;};if(isTop(f)){_result=(ft===this._RANK)?$Q._RT:$Q._PT;}else{_result=(ft===this._RANK)?$Q._RB:$Q._PB;}return _result;},getFuncInfo:function(operator,qualify){var funcInfo={},$Q=this.Q,$F=this.F;funcInfo[$Q._G]={ft:this._GENERIC,f:$F[0][operator]};funcInfo[$Q._RT]={ft:this._RANK,f:$F[1][operator]};funcInfo[$Q._RB]={ft:this._RANK,f:$F[2][operator]};funcInfo[$Q._PT]={ft:this._PERCENT,f:$F[1][operator]};funcInfo[$Q._PB]={ft:this._PERCENT,f:$F[2][operator]};return funcInfo[qualify]||{};},getOpIdxByfunc:function(f,ft){if(!f||!ft){return -1;}var $F=this.F,r=-1;switch(ft){case this._GENERIC:r=$A.indexOf($F[0],f);break;case this._RANK:case this._PERCENT:r=$A.indexOf($F[1],f);if(r===-1){r=$A.indexOf($F[2],f);}break;}return r;},getIncludeByOp:function(op){var $O=this.OP;return op===$O._EQUALS||op===$O._GREATER_EQUAL||op===$O._LESS_EQUAL||op===$O._BETWEEN||op===$O._IN;},formatNumber:function(qualifyOn,num,numFormats){var _result,$Q=this.Q,fm=numFormats.fm;if(!$N.validateFormat(fm)){fm="#,##0.00;(#,##0.00)";}if(qualifyOn===$Q._G){_result=(fm)?$N.formatByMask(fm,num):$N.format(numFormats.cat,numFormats.dp,numFormats.curr,num);}else{if(qualifyOn===$Q._RB||qualifyOn===$Q._RT){_result=String(parseInt(num,10));}else{if(qualifyOn===$Q._PB||qualifyOn===$Q._PT){_result=parseFloat(num)+"%";}}}return _result;},doValidation:function(v,widget,props){var qua=widget.qua,low=widget.low,high=widget.high,Q=this.Q,isRank=qua===Q._RT||qua===Q._RB,isPercent=qua===Q._PT||qua===Q._PB,errorCode="",errorArgs;if($S.isEmpty(v)){errorCode="emptyValueVIWarning";}else{if(!($N.isNumeric(v)||(isPercent&&String(v).match(/^\d+(\.\d+)?%$/)))){errorCode="invalidValueVIWarning";}else{if((qua===Q._PT||qua===Q._PB)&&$N.inNumericRange(parseFloat(v),low,high)){errorCode="outOfRangeVIWarning";errorArgs=isPercent?["0","100%"]:[low,high];}else{if(isRank&&!$N.isInt(v)){errorCode="notIntegerVIWarning";}}}}return $H.copy(props,{invalid:!!errorCode,errorCode:errorCode,args:errorArgs||[]});}});}());
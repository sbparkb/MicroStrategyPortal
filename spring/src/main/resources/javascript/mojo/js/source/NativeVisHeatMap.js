(function(){mstrmojo.requiresCls("mstrmojo.VisHeatMap","mstrmojo._VisSelectionAndLinkDrillHelper");var delStatus={dftUnDel:0,dftDel:1,usrDel:2};mstrmojo.NativeVisHeatMap=mstrmojo.declare(mstrmojo.VisHeatMap,[mstrmojo._VisSelectionAndLinkDrillHelper],{scriptClass:"mstrmojo.NativeVisHeatMap",render:function rnd(){mstrMobileTransport.beforeRenderStart();if(this._super){this._super();}mstrMobileTransport.onRenderComplete();},popupEditor:function(anchor){this.hideInfoBox();var heatmapId=this.id;var deleteTreeId=heatmapId+"-deleteTree";var editorId=heatmapId+"-editor";var that=this;var defaultSelectionStatus=0;if(this.props.delButtonEnabled){defaultSelectionStatus=1;}var strSettings=window.getLocaleString?window.getLocaleString("SETTINGS","Settings"):mstrmojo.desc(7831,"Settings"),strDeletedItems=window.getLocaleString?window.getLocaleString("DELETED_ITEMS","Deleted Items"):mstrmojo.desc(10081,"Deleted Items"),strRefresh=window.getLocaleString?window.getLocaleString("REFRESH_ALL_CAPITAL","REFRESH"):mstrmojo.desc(10378,"REFRESH"),strRTSC=window.getLocaleString?window.getLocaleString("HEATMAP_RTSC","Refresh to saved configuration"):mstrmojo.desc(10082,"Refresh to saved configuration"),strRTDC=window.getLocaleString?window.getLocaleString("HEATMAP_RTDC","Refresh to default configuration"):mstrmojo.desc(10083,"Refresh to default configuration"),strApply=window.getLocaleString?window.getLocaleString("CAPITAL_APPLY","APPLY"):mstrmojo.desc(10379,"APPLY"),strDelete=window.getLocaleString?window.getLocaleString("DELETE_ALL_CAPITAL","DELETE"):mstrmojo.desc(10380,"DELETE"),strEnableDelete=window.getLocaleString?window.getLocaleString("HEATMAP_ENABLE_DELETED_BUTTON","Enable Delete"):mstrmojo.desc(10085,"Enable Delete"),strRestore=window.getLocaleString?window.getLocaleString("PLEASE_SELECT_ELEMENTS_YOU_WANT_TO_RESTORE","Please select elements that you want to restore"):mstrmojo.desc(10084,"Please select elements that you want to restore"),strButtonCancel=window.getLocaleString?window.getLocaleString("IG_CANCEL_BUTTON_TEXT","Cancel"):mstrmojo.desc(221,"Cancel"),strButtonApply=window.getLocaleString?window.getLocaleString("HEATMAP_APPLY_BUTTON","Apply"):mstrmojo.desc(134,"Apply");var prop={anchor:this.editorButton,title:"Heat Map",id:editorId,anchorOrientation:"h",owner:this,width:this.LayoutProperties.EditorDialogWidth+"px",contentMaxHeight:this.LayoutProperties.DeletedListHeight,defaultIndex:this.props.navigatingIndex,panels:[{title:strSettings,scriptClass:"mstrmojo.VisHeatMapPopupPanel",width:"100%",height:"100%",children:[{scriptClass:"mstrmojo.Label",text:strRefresh,cssDisplay:"-webkit-box",cssClass:"heatmap-gray-label"},{scriptClass:"mstrmojo.VisHeatMapTree",showIndicators:false,isSelectable:false,cssClass:"simple-tree",cssText:"padding-left:15px;padding-right:15px;",buttonNodeCss:"",items:[{n:strRTSC,buttonNodeWidget:{scriptClass:"mstrmojo.Button",text:strApply,cssClass:"heatmap-apply-button",onclick:function(){that.isUsingSavedColorTheme=true;that.isUsingDefaultColorTheme=false;var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";that.hideInfoBox();that.hideLegendTooltip();that._scroller.offset.x.start=0;that._scroller.offset.x.end=0;that._scroller.offset.y.start=0;that._scroller.offset.y.end=0;that._scroller.scrollTo(0,0,0);var callback=function(){mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};setTimeout(function(){setTimeout(function(){that.useSavedColorTheme(callback);var object=mstrmojo.all[deleteTreeId];if(object){object.needRefresh=true;}},0);},0);}}},{n:strRTDC,buttonNodeWidget:{scriptClass:"mstrmojo.Button",text:strApply,cssClass:"heatmap-apply-button",onclick:function(){that.isUsingSavedColorTheme=false;that.isUsingDefaultColorTheme=true;var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";that.hideInfoBox();that.hideLegendTooltip();that._scroller.offset.x.start=0;that._scroller.offset.x.end=0;that._scroller.offset.y.start=0;that._scroller.offset.y.end=0;that._scroller.scrollTo(0,0,0);var callback=function(){mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};setTimeout(function(){setTimeout(function(){that.useDefaultColorTheme(callback);var object=mstrmojo.all[deleteTreeId];if(object){object.needRefresh=true;}},0);},0);}}}]},{scriptClass:"mstrmojo.Label",text:strDelete,cssDisplay:"-webkit-box",cssClass:"heatmap-gray-label"},{scriptClass:"mstrmojo.VisHeatMapTree",isSelectable:true,cssClass:"simple-tree",cssText:"margin-left:15px;margin-right:15px;",showIndicators:false,defaultSelectionStatus:defaultSelectionStatus,items:[{n:strEnableDelete,itemFunction:function(){that.toggleDeleteButton();}}]},]},{title:strDeletedItems,scriptClass:"mstrmojo.VisHeatMapPopupPanel",cssText:"position: relative",width:"100%",naviAction:function(){var object=mstrmojo.all[deleteTreeId];if(object){object.refresh();}},children:[{scriptClass:"mstrmojo.Box",cssText:"padding-left:16px;padding-right:16px; maxHeight:"+parseInt(this.LayoutProperties.DeletedListHeight*0.89)+"px",children:[{scriptClass:"mstrmojo.VisHeatMapTree",height:"100%",heightLimit:parseInt(this.LayoutProperties.DeletedListHeight*0.89),showIndicators:true,showScrollbars:true,id:deleteTreeId,itemDisplayField:"label",itemChildrenField:"entityChildren",draggable:true,showRoot:true,rootText:strRestore,itemIncludeFunction:function(item){if(item&&(item.deleted||item.hasChildDeleted)){return true;}else{return false;}},apply:function(callback){var itemFunction=function(){if(this.selectionStatus===1&&this.dataProvider&&this.dataProvider.deleted){this.dataProvider.deleted=false;var tempNode=this.dataProvider;if(!tempNode.entityChildren){var keyStack=[];while(tempNode.parentEntity){keyStack.push(that.getEntityDisplayName(tempNode));tempNode=tempNode.parentEntity;}var delDict=that.props.deletedList;while(keyStack.length>1){delDict=delDict[keyStack.pop()];}var key=keyStack.pop();if(delDict[key]===delStatus.dftDel){delDict[key]=delStatus.dftUnDel;}else{delete delDict[key];}}}};var iterator=function(item,itemFunction){itemFunction.apply(item);if(!item.childTree){return ;}for(var i=0;i<item.childTree.length;i++){var subItem=item.childTree[i];iterator(subItem,itemFunction);}};iterator(this,itemFunction);that.refreshWidget();var tree=this;window.setTimeout(function(){tree.needRefresh=true;tree.refresh();if(callback){callback();}},50);},dataProvider:that.root,owner:that}]},{scriptClass:"mstrmojo.Box",cssText:"background-color:whiteSmoke; position:relative; bottom:0px;font:12pt Roboto,Regular;text-align:center;vertical-align:middle;line-height:55px;border-top: 1px solid rgba(34, 34, 34, 0.18);",height:parseInt(this.LayoutProperties.DeletedListHeight*0.11)+"px",width:"100%",children:[{scriptClass:"mstrmojo.Button",text:strButtonCancel,cssClass:"heatmap-tree-button",cssDisplay:"inline-block",cssText:"border-right: 1px solid rgba(34, 34, 34, 0.18); position: absolute; left:0px; top: 0px; height:100%;",width:"49.5%",onclick:function(){var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});setTimeout(function(){mstrmojo.all[editorId].close();},100);}},{scriptClass:"mstrmojo.Button",text:strButtonApply,cssClass:"heatmap-tree-button",cssDisplay:"inline-block",cssText:"position: absolute; right:0px; top:0px; height: 100%",width:"50.5%",postBuildRendering:function(){mstrmojo.all[deleteTreeId].register(this);},notify:function(enabled){this.set("enabled",enabled);},onclick:function(){var node=this.domNode;node.style.backgroundColor="rgba(51, 181, 229, 0.6)";that.hideInfoBox();var callback=function(){mstrmojo.VisHeatMapAnimation.animate(node,"background",{r:51,g:181,b:229,a:0.6},{r:255,g:255,b:255,a:0});};setTimeout(function(){setTimeout(function(){mstrmojo.all[deleteTreeId].apply(callback);},0);},0);}}]}]}]};this.editorDialog=new mstrmojo.VisHeatMapPopup(prop);this.editorDialog.render();}});})();
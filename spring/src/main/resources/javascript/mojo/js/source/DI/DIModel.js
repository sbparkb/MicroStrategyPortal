(function(){mstrmojo.requiresCls("mstrmojo.warehouse.EnumDatabaseType","mstrmojo.DI.ImportSource","mstrmojo.DI.DIConstants","mstrmojo.DI.OAuthSource","mstrmojo.DI.OAuthAnalytics","mstrmojo.DI.DIHelpers","mstrmojo.DI.DIDatabaseHelper","mstrmojo.DI.model.HistoryList","mstrmojo.DI.model._ConnectLive","mstrmojo.DI.model._DISources","mstrmojo.DI.model.Schedule");mstrmojo.requiresDescs(218,219,3958,7151,8516,8520,8531,8545,8552,8553,8556,8558,8560,8561,9149,9214,9926,10056,10057,10058,10059,10060,10061,10062,10072,10171,10174,11108,11109,11164,12442,12444,12447,12448,12449,12451,12452,12454,12455,12456,12460,12461,12462,12463,12498,12542,12711,12712,12713,12748,12749,12750,12751,12752,12753,12754,12755,12756,12757,12758,12759,12760,12977,12978,12979,12980,12981,12982,12983,12984,12985,12986,12987,12988,12989,12990,12991,12992,12993,12994,12995,12996,12997,12998,13041,13223,13224,13225,13226,13227,13411,13412,13413,13414,13415,13416,13417,13418,13419,13420,13421,13422,13423,13424,13425,13426,13978,14039,14040,14041,14042,14043,14044,14045,14046,14047,14048,14049,14050,14051,14052,14053,14054,14201);var constants=mstrmojo.DI.DIConstants,$ENUM_DATABASE_TYPE=mstrmojo.warehouse.EnumDatabaseType,$ARR=mstrmojo.array,$HASH=mstrmojo.hash,$HELPER=mstrmojo.DI.DIHelpers;function extractAttributeGroup(res){var i,len=0,attributes={},groups=res.agis,attribute,group,atid,fms,maps;if(groups){len=groups.length;}for(i=0;i<len;i++){group=groups[i];atid=group.atid;fms=group.agi.fms;maps=group.agi.maps;attribute={fms:fms,maps:maps};attributes[atid]=attribute;}return attributes;}function makeKey(type,subtype,table_id){var key=type+"_"+subtype;if(table_id){key=table_id;}return key;}function importFactory(type,subtype,table_id){var importSource=new mstrmojo.DI.ImportSource();importSource.initialize(type,subtype,makeKey(type,subtype,table_id),table_id);return importSource;}function populatePartitionInfo(sourceInfo,partitionInfo){var partition={isPartition:false},ptabs,partitionTables=[],partitionTable;if(!partitionInfo){sourceInfo.set("partition",partition);return ;}partition.type=partitionInfo.tp;partition.isPartition=partition.type!==0;ptabs=partitionInfo.ptabs||[];$ARR.forEach(ptabs,function(table){partitionTable={};if(table.n){partitionTable.name=table.n;}if(table.hasOwnProperty("shnb")){partitionTable.sheetIndex=table.shnb;}partitionTables.push(partitionTable);});partition.tables=partitionTables;sourceInfo.set("partition",partition);}function createSourceInfo(source,data){var src=data.datap.srce,sourceInfo,file_description;if(source.sourceInfo){source.sourceInfo.destroy();}sourceInfo=source.sourceInfo=new mstrmojo.Obj();if(src.iurl){sourceInfo.set("name",src.url);}else{sourceInfo.set("name",mstrmojo.string.decodeHtmlString(src.tbn)||"");}if(src.tbal){sourceInfo.set("name",mstrmojo.string.decodeHtmlString(src.tbal)||"");}sourceInfo.set("dbTableName",src.tbn||"");if(src.xt===constants.xdaType.excel||src.xt===constants.xdaType.text||src.xt===constants.xdaType.dataImportOAuthDropbox||src.xt===constants.xdaType.dataImportOAuthGDrive){sourceInfo.set("sheetName",src.file_description.shn);sourceInfo.set("sheetIndex",src.file_description.shnb);sourceInfo.set("hasInsertedColumnHeaders",src.file_description.hnchs);}if(src.dbrid){sourceInfo.set("dbRoleId",src.dbrid);}if(src.des){sourceInfo.set("des",src.des);}if(src.ns){sourceInfo.set("dbNamespace",src.ns);}if(src.said){sourceInfo.set("said",src.said);}if(src.gbqp){sourceInfo.set("gbqp",src.gbqp);}populatePartitionInfo(sourceInfo,src.pti);file_description=src.file_description;if(file_description){if(file_description.url!==undefined){sourceInfo.set("url",file_description.url);}if(file_description.srcid){sourceInfo.set("sourceId",file_description.srcid);}if(file_description.oid){sourceInfo.set("objectId",file_description.oid);}if(file_description.odesc){sourceInfo.set("objectDesc",file_description.odesc);}if(file_description.rdtr){sourceInfo.set("delimiter",file_description.rdtr);}if(file_description.qt){sourceInfo.set("quotes",file_description.qt);}if(file_description.hasOwnProperty("chrn")){sourceInfo.set("skipRows",file_description.chrn);}if(file_description.hasOwnProperty("fil")){sourceInfo.set("fileStruct",file_description.fil);}if(file_description.hasOwnProperty("hnchs")){sourceInfo.set("hasNewHeaders",file_description.hnchs);}if(file_description.mimetype){sourceInfo.set("mimetype",file_description.mimetype);}if(file_description.maxr){source.set("fetchNum",file_description.maxr);}}sourceInfo.set("isRefined",src.irfd);sourceInfo.set("hasAggFilter",src.ifaa);sourceInfo.set("hnc",src.hnc);}function populateSourceInfo(data,tbid){if(!data){return null;}var src=data.datap.srce,tableID=data.datap.tbid||tbid,source,pos;if(!src){if(tbid){source=this.getImportSource(tbid);}else{source=null;}return source;}switch(src.xt){case constants.xdaType.text:case constants.xdaType.excel:if(src.txt===constants.xdaType.text){pos=data.datap.shts&&data.datap.shts[0].indexOf(":\\fakepath\\");if(pos&&pos>=0){data.datap.shts[0]=data.datap.shts[0].substr(pos+11);}}switch(src.dict){case constants.backendSourceSubtype.samplefile:source=this.importSources[makeKey(constants.sourceType.file,constants.sourceSubtype.samplefile,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.file,constants.sourceSubtype.samplefile,tableID);}break;case constants.backendSourceSubtype.publicData:source=this.importSources[makeKey(constants.sourceType.file,constants.sourceSubtype.publicData,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.file,constants.sourceSubtype.publicData,tableID);}break;case constants.backendSourceSubtype.url:source=this.importSources[makeKey(constants.sourceType.file,constants.sourceSubtype.url,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.file,constants.sourceSubtype.url,tableID);}break;case constants.backendSourceSubtype.localFile:source=this.importSources[makeKey(constants.sourceType.file,constants.sourceSubtype.localFile,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.file,constants.sourceSubtype.localFile,tableID);}break;case constants.backendSourceSubtype.clipboard:source=this.importSources[makeKey(constants.sourceType.file,constants.sourceSubtype.clipboard,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.file,constants.sourceSubtype.clipboard,tableID);}break;default:if(src.file_description&&src.file_description.url!==""){source=this.importSources[makeKey(constants.sourceType.file,constants.sourceSubtype.url,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.file,constants.sourceSubtype.url,tableID);}}else{if(src.tbn===""){source=this.importSources[makeKey(constants.sourceType.file,constants.sourceSubtype.clipboard,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.file,constants.sourceSubtype.clipboard,tableID);}else{source.set("type",constants.sourceType.file);source.set("subtype",constants.sourceSubtype.clipboard);}}else{source=this.importSources[makeKey(constants.sourceType.file,constants.sourceSubtype.localFile,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.file,constants.sourceSubtype.localFile,tableID);}}}break;}break;case constants.xdaType.refine:source=this.importSources[makeKey(constants.sourceType.file,constants.sourceSubtype.localFile,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.file,constants.sourceSubtype.localFile,tableID);}break;case constants.xdaType.dataImportOAuthGDrive:source=this.importSources[makeKey(constants.sourceType.googleDrive,constants.sourceSubtype.googleDrive,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.googleDrive,constants.sourceSubtype.googleDrive,tableID);}break;case constants.xdaType.dataImportOAuthDropbox:source=this.importSources[makeKey(constants.sourceType.dropbox,constants.sourceSubtype.dropbox,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.dropbox,constants.sourceSubtype.dropbox,tableID);}break;case constants.xdaType.salesforce:source=this.importSources[makeKey(constants.sourceType.salesforce,constants.sourceSubtype.salesforce,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.salesforce,constants.sourceSubtype.salesforce,tableID);}break;case constants.xdaType.dataImportOAuthGAnalytics:source=this.importSources[makeKey(constants.sourceType.googleAnalytics,constants.sourceSubtype.googleAnalytics,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.googleAnalytics,constants.sourceSubtype.googleAnalytics,tableID);}break;case constants.xdaType.dataImportOAuthGBigQuery:source=this.importSources[makeKey(constants.sourceType.googleBigQuery,constants.sourceSubtype.googleBigQuery,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.googleBigQuery,constants.sourceSubtype.googleBigQuery,tableID);}break;case constants.xdaType.dataImportOAuthGBigQueryFFSQL:source=this.importSources[makeKey(constants.sourceType.googleBigQuery,constants.sourceSubtype.googleBigQueryFFSQL,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.googleBigQuery,constants.sourceSubtype.googleBigQueryFFSQL,tableID);}break;case constants.xdaType.dataImportOAuthGBigQuerySingleTable:source=this.importSources[makeKey(constants.sourceType.googleBigQuery,constants.sourceSubtype.googleBigQuerySingleTable,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.googleBigQuery,constants.sourceSubtype.googleBigQuerySingleTable,tableID);}break;case constants.xdaType.mdx:source=this.importSources[makeKey(constants.sourceType.mdx,constants.sourceSubtype.mdx,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.mdx,constants.sourceSubtype.mdx,tableID);}break;case constants.xdaType.qbSingleTable:case constants.xdaType.ffsql:case constants.xdaType.querybuilder:var sourceType=constants.sourceType.querybuilder,sourceSubType=constants.sourceSubtype.querybuilder,dbtp,dbvs;if(src.dbvs===223){sourceType=constants.sourceType.bisource;sourceSubType=constants.sourceSubtype.bisource;}else{if(data.datap.srce.dbtp!==undefined){dbtp=data.datap.srce.dbtp;dbvs=src.dbvs;switch(dbtp){case $ENUM_DATABASE_TYPE.SearchEngineSOLR:case $ENUM_DATABASE_TYPE.SearchEngineSPLUNK:sourceSubType=constants.sourceSubtype.searchOnSource;break;case 4000:if(src.xt===constants.xdaType.qbSingleTable){sourceSubType=constants.sourceSubtype.hanaSingleTable;}break;default:sourceSubType=constants.sourceSubtype.querybuilder;break;}}}source=this.importSources[makeKey(sourceType,sourceSubType,tableID)];if(!source){source=this.selectImportSource(sourceType,sourceSubType,tableID);}source.xdaType=src.xt;source.databaseType=dbtp;source.databaseVersion=dbvs;source.dbrid=data.datap.srce.dbrid;break;case constants.xdaType.twitter:source=this.importSources[makeKey(constants.sourceType.twitter,constants.sourceSubtype.twitter,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.twitter,constants.sourceSubtype.twitter,tableID);}break;case constants.xdaType.facebook:source=this.importSources[makeKey(constants.sourceType.facebook,constants.sourceSubtype.facebook,tableID)];if(!source){source=this.selectImportSource(constants.sourceType.facebook,constants.sourceSubtype.facebook,tableID);}break;}if(src&&src.tbn){if($HELPER.strStartsWith(src.tbn,"hdfs://")){source.type=constants.sourceType.hadoop;source.subtype=constants.sourceSubtype.hadoop;}}source.xdaType=src.xt;if(data.datap.crt!==undefined){source.refreshType=data.datap.crt;source.origRefreshType=source.refreshType;}if(data.datap.bin!==undefined){source.binaryExists=(data.datap.bin!==1);}if(data.datap.ac!==undefined){source.executeAction=data.datap.ac;}if(data.datap.tbn!==undefined){source.dbTableName=data.datap.tbn;}if(data.datap.state){source.hasRefreshedData=data.datap.state.bin===1;if(data.datap.state.op!==undefined){source.tableState=data.datap.state.op;}}createSourceInfo(source,data);return source;}function getCurrentMapping(importSource){var transformations=importSource.currentTransformations;return(transformations&&transformations.xtab&&transformations.xtab.isCrosstab)?importSource.transformedMapping:importSource.currentMapping;}function checkGroupPartitionConditions(source1,mapping1,source2,mapping2){var xdaTypeConst=constants.xdaType,xdaType=source1.xdaType,sourceInfo1=source1.sourceInfo,sourceInfo2=source2.sourceInfo,canGroup=xdaType===source2.xdaType,srcTableID1,srcTableID2;if(source1.sourceInfo.isRefined||source2.sourceInfo.isRefined){return false;}switch(xdaType){case xdaTypeConst.excel:if(source1.subtype===constants.sourceSubtype.url&&source2.subtype===constants.sourceSubtype.url){canGroup=canGroup&&sourceInfo1.url===sourceInfo2.url;canGroup=canGroup&&sourceInfo1.fileStruct===sourceInfo2.fileStruct&&sourceInfo1.skipRows===sourceInfo2.skipRows;}else{if(source1.subtype===constants.sourceSubtype.localFile&&source2.subtype===constants.sourceSubtype.localFile){srcTableID1=source1.srcTableID||source1.tableID;srcTableID2=source2.srcTableID||source2.tableID;canGroup=canGroup&&srcTableID1===srcTableID2;canGroup=canGroup&&sourceInfo1.fileStruct===sourceInfo2.fileStruct&&sourceInfo1.skipRows===sourceInfo2.skipRows;}else{canGroup=false;}}break;case xdaTypeConst.text:canGroup=canGroup&&source1.subtype===constants.sourceSubtype.url&&source2.subtype===constants.sourceSubtype.url;canGroup=canGroup&&sourceInfo1.fileStruct===sourceInfo2.fileStruct&&sourceInfo1.delimiter===sourceInfo2.delimiter;canGroup=canGroup&&sourceInfo1.quotes===sourceInfo2.quotes&&sourceInfo1.skipRows===sourceInfo2.skipRows;break;case xdaTypeConst.qbSingleTable:canGroup=canGroup&&sourceInfo1.dbRoleId&&sourceInfo1.dbRoleId===sourceInfo2.dbRoleId;canGroup=canGroup&&((!sourceInfo1.dbNamespace&&!sourceInfo2.dbNamespace)||sourceInfo1.dbNamespace===sourceInfo2.dbNamespace);break;default:canGroup=false;}canGroup=canGroup&&mapping1&&mapping2&&mapping1.length===mapping2.length;if(!canGroup){return false;}$ARR.forEach(mapping1,function(column,i){if(!(column.ix===mapping2[i].ix&&column.tp===mapping2[i].tp&&column.id===mapping2[i].id&&(xdaType!==xdaTypeConst.qbSingleTable||column.n===mapping2[i].n))){canGroup=false;return false;}return true;});return canGroup;}function markCubeScheduleStatus(cubes){var cubeSchedStatus=constants.cubeSchedStatus,status;$ARR.forEach(cubes,function(cube){var subs=cube.subs,hasStatus=false,success=true,subStatus;subs=subs?[].concat(subs):[];if(subs.length>0){$ARR.forEach(subs,function(sub){subStatus=sub.status&&sub.status.length>0&&sub.status[sub.status.length-1];if(subStatus){hasStatus=true;success=success&&(subStatus.en===0);}});if(!hasStatus){status=cubeSchedStatus.unexecuted;}else{if(success){status=cubeSchedStatus.successful;}else{status=cubeSchedStatus.failed;}}}else{status=cubeSchedStatus.unscheduled;}cube.schedStatus=status;});return cubes;}mstrmojo.DI.DIModel=mstrmojo.declare(mstrmojo.Obj,[mstrmojo.DI.model._ConnectLive,mstrmojo.DI.model._DISources],{scriptClass:"mstrmojo.DI.DIModel",refresh_opt:1,folderID:"",cubeID:"",cubeName:"",cubesInfo:0,isManagedCube:false,cubeDesc:"",analysisID:"",currentSource:null,externalSources:{},importSources:null,operationMode:constants.operationMode.create,refineServerURL:null,dbObjectsDisplayOptions:17,subsInfo:null,subsStatus:null,isCubePublished:false,rawDataExistsInAE:false,attributeFormInfo:{},cubeConfig:{},xquerySources:{},cubeQuota:0,isAddingNewTable:false,datasets:null,publishedDatasets:null,currentDataset:null,hasMergedReportInstance:false,isCalledByFlex:false,cubePersisted:false,partitionGroups:null,isCubeSaved:false,reportDefinitionId:null,getHistoryList:function getHistoryList(){if(this._HL===undefined){this._HL=new mstrmojo.DI.model.HistoryList();}return this._HL;},getSchedule:function(){if(this._Schedule===undefined){this._Schedule=new mstrmojo.DI.model.Schedule();}return this._Schedule;},sampleFiles:{file:[{display:mstrmojo.desc(14039,"Airline Sample Data"),name:"airline-sample-data.xls",url:"http://mirror.microstrategy.com/datahub/samples/airline-sample-data.xls",desc:mstrmojo.desc(14040,"On-time and delayed flights for airlines operating in the three main Washington, DC-area airports"),size:6.5,iscrosstab:"false"},{display:mstrmojo.desc(14041,"Campaign Finance Data"),name:"campaign-finance-sample-data.xls",url:"http://mirror.microstrategy.com/datahub/samples/campaign-finance-sample-data.xls",desc:mstrmojo.desc(14042,"Financial data about campaigns for Senate, House of Representatives, and President of the United States"),size:1,iscrosstab:"false"},{display:mstrmojo.desc(14044,"Gaming Sample Data"),name:"gaming-sample-data.xls",url:"http://mirror.microstrategy.com/datahub/samples/gaming-sample-data.xls",desc:mstrmojo.desc(14043,"Slot machine data for casino floor analysis. Data available at the day and individual machine level"),size:15.1,iscrosstab:"false"},{display:mstrmojo.desc(14045,"Global Migration Data"),name:"global-migration.xls",url:"http://mirror.microstrategy.com/datahub/samples/global-migration.xls",desc:mstrmojo.desc(14046,"2000 global bilateral migration data from the World Bank"),size:0.1,iscrosstab:"false"},{display:mstrmojo.desc(14047,"Income Tax Return Data"),name:"income-tax-sample-data.xls",url:"http://mirror.microstrategy.com/datahub/samples/income-tax-sample-data.xls",desc:mstrmojo.desc(14048,"2007 income tax return data items classified by state and county"),size:0.4,iscrosstab:"false"},{display:mstrmojo.desc(14049,"Inventory Sample Data"),name:"Inventory-Sample-Data.xls",url:"http://mirror.microstrategy.com/datahub/samples/Inventory-Sample-Data.xls",desc:mstrmojo.desc(14050,"Data for inventory analysis at standalone, mall and strip mall locations"),size:0.6,iscrosstab:"false"},{display:mstrmojo.desc(14051,"Retail Sample Data"),name:"retail-sample-data.xls",url:"http://mirror.microstrategy.com/datahub/samples/retail-sample-data.xls",desc:mstrmojo.desc(14052,"Retail data for category management analysis. Metrics include cost, revenue, unit cost, units sold"),size:2.3,iscrosstab:"false"},{display:mstrmojo.desc(14053,"Worldwide CO2 Emissions"),name:"Worldwide-CO2-Emissions.xls",url:"http://mirror.microstrategy.com/datahub/samples/Worldwide-CO2-Emissions.xls",desc:mstrmojo.desc(14054,"Worldwide, energy-related carbon dioxide emissions for the 1990-2010 time period"),size:0.5,iscrosstab:"false"}]},initParams:function initParams(params){switch(params.StatusCode){case constants.statusCode.edit:this.set("operationMode",constants.operationMode.edit);break;case constants.statusCode.obtainSource:this.set("operationMode",constants.operationMode.refresh);break;case constants.statusCode.xformsError:case constants.statusCode.mappingError:this.set("operationMode",constants.operationMode.refresh);break;case constants.statusCode.republish:this.set("operationMode",constants.operationMode.refresh);break;case constants.statusCode.schedule:this.set("operationMode",constants.operationMode.subscribe);break;case constants.statusCode.enterCredentials:this.set("operationMode",constants.operationMode.enterCredentials);break;default:this.set("operationMode",constants.operationMode.create);break;}if(mstrApp.isSingleTier){this.refineServerURL="http://localhost:3333/";}else{this.refineServerURL="http://"+mstrConfig.serverName+":3333/";}this.cubeID=params.ReportId;this.cubeName=params.CubeName;this.folderID=params.FolderId||"";this.cubeDesc=params.CubeDesc;if(params.isDirectDataAccess){this.set("isDirectDataAccess",params.isDirectDataAccess);}if(params.SubsId){this.getSchedule().subsID=params.SubsId;}if(params.SubsName){this.getSchedule().subsName=params.SubsName;}if(params.DocumentID){this.analysisID=params.DocumentID;}else{if(params.AnalysisId){this.analysisID=params.AnalysisId;if(params.isManagedCube!==undefined&&this.cubeID){this.isManagedCube=params.isManagedCube;}else{if(!mstrApp.isSingleTier&&mstrApp.launchingApp&&mstrApp.launchingApp.pageName==="Html5Vi"){this.isManagedCube=true;}else{this.isManagedCube=false;}}}}if(params.isCalledByFlex){this.isCalledByFlex=params.isCalledByFlex;this.isManagedCube=false;}if(params.datasets){this.populateVIDatasets(params.datasets);if(mstrApp.refreshMultipleCubes){this.set("cubesInfo",params.datasets);}}if(params.documentModel){this.set("documentModel",$HELPER.createMSTRObjects(params.documentModel,["dbRole"]));}if(params.missingCredentialsData){this.set("missingCredentialsData",params.missingCredentialsData);}this.refreshMode=params.RefreshMode;this.importSources={};this.publishedDatasets=[];},updateDocumentCredentials:function updateDocumentCredentials(tableIDs,hasCredentials){var model=this;mstrmojo.array.forEach(tableIDs,function(tableID){mstrmojo.array.forEach(model.documentModel.datasets,function(dataset){mstrmojo.array.forEach(dataset.tables,function(table){if(table.did===tableID){table.set("credentialsFetched",hasCredentials);}});});});},selectImportSource:function selectImportSource(type,subtype,tableID){var importSource=this.importSources[makeKey(type,subtype,tableID)];if(!importSource){importSource=importFactory(type,subtype,tableID);this.importSources[importSource.key]=importSource;}this.raiseEvent({name:"ImportTypeChanged"});return importSource;},populateExternalSources:function populateExternalSources(){if(document.location.protocol.indexOf("https")>-1||mstrApp.isSingleTier){var dropbox=new mstrmojo.DI.OAuthSource({type:constants.sourceType.dropbox,subtype:constants.sourceSubtype.dropbox,name:"Dropbox",dbRoleID:"897B0012B9A24BF9AB297BA654F21482",scope:"",oauthVersion:"2.0",sourceID:"https://www.dropbox.com"});this.externalSources[constants.sourceType.dropbox]=dropbox;var googleDrive=new mstrmojo.DI.OAuthSource({type:constants.sourceType.googleDrive,subtype:constants.sourceSubtype.googleDrive,name:"Google Drive",dbRoleID:"4FC38D1FC0E140EB8FCD2CBAA235E1DE",scope:"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/drive.readonly",oauthVersion:"2.0",sourceID:"https://drive.google.com"});this.externalSources[constants.sourceType.googleDrive]=googleDrive;var googleAnalytics=new mstrmojo.DI.OAuthAnalytics({type:constants.sourceType.googleAnalytics,subtype:constants.sourceSubtype.googleAnalytics,name:"Google Analytics",dbRoleID:"1304214B5640429EBC5FA0820E64DEC4",oauthVersion:"2.0",scope:"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/analytics.readonly ",sourceID:"http://www.google.com/analytics/"});this.externalSources[constants.sourceType.googleAnalytics]=googleAnalytics;var googleBigQuery=new mstrmojo.DI.OAuthSource({type:constants.sourceType.googleBigQuery,subtype:constants.sourceSubtype.googleBigQuery,name:"Google BigQuery",dbRoleID:"021CDA5330A0437A8477B597796F2AC3",oauthVersion:"2.0",scope:"https://www.googleapis.com/auth/userinfo.profile https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/bigquery.readonly",step2:mstrmojo.desc(12461,"Make a query and get results"),step3:mstrmojo.desc(12462,"Publish cube to create documents"),sourceID:"https://developers.google.com/bigquery/"});this.externalSources[constants.sourceType.googleBigQuery]=googleBigQuery;var salesforce=new mstrmojo.DI.OAuthSource({type:constants.sourceType.salesforce,subtype:constants.sourceSubtype.salesforce,name:"Salesforce",step2:mstrmojo.desc(12463,"Select Your Report"),dbRoleID:"AC41E217C55342DC871C511E77EBE4D0",oauthVersion:"2.0",scope:"id api refresh_token web",sourceID:"https://www.salesforce.com"});this.externalSources[constants.sourceType.salesforce]=salesforce;var twitter=new mstrmojo.DI.OAuthSource({type:constants.sourceType.twitter,subtype:constants.sourceSubtype.twitter,name:"Twitter",dbRoleID:"7FADDA9B2CF44458A38DE40C786FD99D",oauthVersion:"1.0",sourceID:"https://www.twitter.com"});this.externalSources[constants.sourceType.twitter]=twitter;var facebook=new mstrmojo.DI.OAuthSource({type:constants.sourceType.facebook,subtype:constants.sourceSubtype.facebook,name:"Facebook",dbRoleID:"C4232C63F23D4932B75CFBAC950EADE7",oauthVersion:"2.0",scope:"email user_likes public_profile",sourceID:"https://www.facebook.com"});this.externalSources[constants.sourceType.facebook]=facebook;}},getTags:function(type){var tag=this.searchTags[type];if(tag){return tag;}},getDisplayOptionsByType:function(type){var tags=this.searchTags[type];var disp;if(tags){mstrmojo.array.forEach(tags,function(tag){if(tag==="Hadoop"){disp=16;}else{if(tag==="Database"){disp=1;}}});return disp;}},populateAllTables:function(data,requestFlags,silent){var model=this;var tableCnt=data.datap.length;var i;var servicedFlags=0;var d={},oldTableIds,newTableIdsMap={},isTableDeleted=false;oldTableIds=this.getAllTableID();if(data.rit){this.isCubePublished=(data.rit.pcube===1);this.rawDataExistsInAE=(data.rit.eprd===1);}if(data.prs&&data.prs.dda){this.connectLiveSupport=data.prs.dda;}if(this.operationMode!==constants.operationMode.create&&data.prs&&data.prs.ddam){this.isDirectDataAccess=(data.prs.ddam===2);}for(i=0;i<tableCnt;i++){d.datap=data.datap[i];d.btb=data.btb;d.forms=data.forms;d.prs=data.prs;servicedFlags|=this.populateEMMA(d,requestFlags,null,true);if(d.datap.tbid){newTableIdsMap[d.datap.tbid]=true;}}if(data.rit&&data.rit.ts&&data.rit.ts.length){$ARR.forEach(data.rit.ts,function(item){var source=model.getImportSource(item.tbid);if(source){source.forceRepublish=(item.ac===1);source.schemaChanged=(item.crt!==0);if(item.ac===1){source.refreshType=constants.cubeRefreshType.replaceTable;source.executeAction=constants.tableStatsExecutionAction.forceExecution;}}});}$ARR.forEach(oldTableIds,function(tableId){if(newTableIdsMap[tableId]!==true){isTableDeleted=true;this.resetImportSource(tableId);}},this);if(isTableDeleted){this.raiseEvent({name:"MappingsFetched"});}this.raiseEvent({name:"tableNamesChanged"});i=this.populateTablesPosition(data);if(i&&!silent){this.raiseEvent({name:"TablesPositionFetched"});}if((requestFlags&constants.requestFlag.sourceInfo)===constants.requestFlag.sourceInfo){if(!silent){this.raiseEvent({name:"SourceInfoFetched"});}}if((servicedFlags&constants.requestFlag.relationship)===constants.requestFlag.relationship){if(!silent){this.raiseEvent({name:"RelationshipFetched"});}}if((servicedFlags&constants.requestFlag.mapping)===constants.requestFlag.mapping){if(!silent){this.raiseEvent({name:"MappingsFetched"});}}return servicedFlags;},populateTablesPosition:function(data){var idx=-1,i,itcs,itc,btbs,id,source,r,ret=false;if(data.btb){btbs=[].concat(data.btb);}for(i=0;btbs&&i<btbs.length;i++){if(btbs[i].oi&&btbs[i].oi.tp===3){idx=i;break;}}if(idx<0){return ;}itcs=data.btb[idx].oi.def.em.sou.it_c;this.cubePersisted=data.btb[idx].oi.sta&256;if(!itcs){return ;}itcs=[].concat(itcs);for(i=0;i<itcs.length;i++){itc=itcs[i];id=itc.tb.did;source=this.getImportSource(id);if(source){r=source.populatePosition(itc.sqltf);ret=ret||r;}}return ret;},populate:function populate(data,requestFlags){if(data.btb&&data.btb[0]&&data.btb[0].oi&&data.btb[0].oi.def&&data.btb[0].oi.def.crpt){this.refresh_opt=data.btb[0].oi.def.crpt;}if(data.prs){this.connectLiveSupport=data.prs.dda;}var source;if((requestFlags&constants.requestFlag.sourceInfo)===constants.requestFlag.sourceInfo){source=populateSourceInfo.call(this,data);this.raiseEvent({name:"SourceInfoFetched"});}var servicedFlags=source.populate(data,requestFlags);if((servicedFlags&constants.requestFlag.preview)===constants.requestFlag.preview){this.raiseEvent({name:"PreviewFetched"});}if((servicedFlags&constants.requestFlag.transformedPreview)===constants.requestFlag.transformedPreview){this.raiseEvent({name:"TransformedPreviewFetched"});}if((servicedFlags&constants.requestFlag.mapping)===constants.requestFlag.mapping){this.raiseEvent({name:"MappingsFetched"});}else{if((requestFlags&constants.requestFlag.mapping)===constants.requestFlag.mapping){this.raiseEvent({name:"MappingsNotFetched"});}}if((servicedFlags&constants.requestFlag.sheets)===constants.requestFlag.sheets){this.raiseEvent({name:"SheetsFetched"});}if((servicedFlags&constants.requestFlag.transformations)===constants.requestFlag.transformations){this.raiseEvent({name:"TransformationsFetched"});}this.currentSource=source;return servicedFlags;},populateAttributeGroup:function populateAttributeGroup(data,tableID){this.attributeFormInfo[tableID]=extractAttributeGroup(data);},populateCubeConfig:function populateCubeConfig(data){var distInfo={},tbls=data.datap,tbl,cubeConfig={},sidxes=[];if(tbls[0]){tbl=tbls[0];}else{tbl=tbls;}var pa=tbl.pas?tbl.pas[0]:null;distInfo.keyId=pa?pa.atid:"";distInfo.pf=tbl.pf||0;if(data.sidxes){$ARR.forEach(data.sidxes,function(elem){sidxes.push({atid:elem.stat,afid:elem.stafid});});}cubeConfig.distInfo=distInfo;cubeConfig.sidxes=sidxes;cubeConfig.initialSet=$HASH.clone(cubeConfig);cubeConfig.autopa=tbl.autopa===1;if(tbl.autopa===1){cubeConfig.distInfo.keyId="autopa";}this.cubeConfig=cubeConfig;this.raiseEvent({name:"CubeConfigFetched"});},populateWikiSuggestions:function populateWikiSuggestions(data){this.set("wikiSuggestions",data[1]);},populateWikiSearchResults:function populateWikiSearchResults(data){this.wikiSearchResults=data;this.raiseEvent({name:"wikiSearchResultsFetched"});},populateEMMA:function populateEMMA(data,requestFlags,tableID,silent){var source,i,idx,btbs;if(data.rit){this.isCubePublished=(data.rit.pcube===1);this.rawDataExistsInAE=(data.rit.eprd===1);}if(data.prs&&data.prs.dda){this.connectLiveSupport=data.prs.dda;}if(this.operationMode!==constants.operationMode.create&&data.prs&&data.prs.ddam){this.isDirectDataAccess=(data.prs.ddam===2);}idx=-1;if(data.btb){btbs=[].concat(data.btb);for(i=0;btbs&&i<btbs.length;i++){if(btbs[i].oi&&btbs[i].oi.tp===3){idx=i;break;}}if(idx>-1){this.reportDefinitionId=data.btb[idx].oi.did;}}if(Object.prototype.toString.call(data.datap)==="[object Array]"){return this.populateAllTables(data,requestFlags,silent);}if((requestFlags&constants.requestFlag.sourceInfo)===constants.requestFlag.sourceInfo){source=populateSourceInfo.call(this,data,tableID);if(!silent){this.raiseEvent({name:"SourceInfoFetched"});}}if(!source){source=this.importSources[tableID];}var servicedFlags=source.populate(data,requestFlags,source.tableID);if((servicedFlags&constants.requestFlag.preview)===constants.requestFlag.preview){if(!silent){this.raiseEvent({name:"PreviewFetched"});}}else{if((requestFlags&constants.requestFlag.preview)===constants.requestFlag.preview){if(!silent){this.raiseEvent({name:"PreviewNotFetched"});}}}if((servicedFlags&constants.requestFlag.relationship)===constants.requestFlag.relationship){if(!silent){this.raiseEvent({name:"RelationshipFetched"});}}if((servicedFlags&constants.requestFlag.transformedPreview)===constants.requestFlag.transformedPreview){if(!silent){this.raiseEvent({name:"TransformedPreviewFetched"});}}if((servicedFlags&constants.requestFlag.mapping)===constants.requestFlag.mapping){this.getAllMappings();if(!silent){this.raiseEvent({name:"MappingsFetched"});}}else{if((requestFlags&constants.requestFlag.mapping)===constants.requestFlag.mapping){if(!silent){this.raiseEvent({name:"MappingsNotFetched"});}}}if((servicedFlags&constants.requestFlag.sheets)===constants.requestFlag.sheets){if(!silent){this.raiseEvent({name:"SheetsFetched"});}}if((servicedFlags&constants.requestFlag.transformations)===constants.requestFlag.transformations){if(!silent){this.raiseEvent({name:"TransformationsFetched"});}}return servicedFlags;},getAllMappings:function(){var i,j,source,map,maps;var allMaps=[];for(i in this.importSources){source=this.importSources[i];if(source.currentTransformations&&source.currentTransformations.xtab&&source.currentTransformations.xtab.isCrosstab){maps=source.transformedMapping;}else{maps=source.currentMapping;}if(maps){for(j=0;maps&&j<maps.length;j++){map=maps[j];map.isLinked=false;if(map.id){var index=mstrmojo.array.find(allMaps,"id",map.id);if(index<0){allMaps.push(map);}else{allMaps[index].isLinked=true;map.isLinked=true;}}else{allMaps.push(map);}}}}return allMaps;},getAllRelationships:function(){var i,j,k,source,RSs,RS;var allRSs=[];var repeated=false;for(i in this.importSources){source=this.importSources[i];RSs=source.relationship;if(RSs){for(j=0;j<RSs.length;j++){RS=RSs[j];repeated=false;for(k=0;k<allRSs.length;k++){if(allRSs[k].parent.id===RS.parent.id&&allRSs[k].child.id===RS.child.id&&allRSs[k].ert===RS.ert){repeated=true;break;}}if(!repeated){allRSs.push(RS);}}}}return allRSs;},findMappingSource:function(column){var sources=[];var i,j,source,map,maps;if(!column){return sources;}for(i in this.importSources){source=this.importSources[i];if(source.currentTransformations&&source.currentTransformations.xtab&&source.currentTransformations.xtab.isCrosstab){maps=source.transformedMapping;}else{maps=source.currentMapping;}if(maps){for(j=0;j<maps.length;j++){map=maps[j];if(column.id){if(map.id&&map.id===column.id){if(column.isAttributeForm){if(map.isMultiForm){var subCols=map.subColumns,index=mstrmojo.array.find(subCols,"afid",column.afid);if(index>=0){sources.push(source);break;}}else{if(map.afid===column.afid){sources.push(source);break;}}}else{sources.push(source);break;}}}else{if(column.oid){if(map.oid&&map.oid===column.oid){sources.push(source);break;}}else{if(map.did===column.did){sources.push(source);break;}}}}}}return sources;},findMappingItem:function(column,tableID){var ids=this.getAllTableID();var cols=[];var i,col;if(tableID){col=this.getImportSource(tableID).findMappingItem(column);if(col){cols.push(col);}}else{for(i=0;i<ids.length;i++){col=this.getImportSource(ids[i]).findMappingItem(column);if(col){cols.push(col);}}}return cols;},getAllMissingColumns:function(){var ids=this.getAllTableID();var ret=[];var i,missing,table;for(i=0;i<ids.length;i++){table=this.getImportSource(ids[i]);missing=table.getMissingColumns();if(missing&&missing.length>0){ret=ret.concat(missing);}}return ret;},createImportSource:function(type,subType,table_id){return this.selectImportSource(type,subType,table_id);},getImportSource:function(table_id){return this.importSources[table_id]||null;},getAllTableID:function(){var ret=[];var id,source;for(id in this.importSources){source=this.importSources[id];if(source&&source.tableID){ret.push(id);}}return ret;},selectSourceTable:function(tableID){if(this.currentSource&&this.currentSource.key===tableID){return ;}if(!this.currentSource&&(tableID===-1||tableID===null)){this.raiseEvent({name:"CurrentSourceChanged"});return ;}if(tableID===-1||tableID===null){this.currentSource=null;}else{this.currentSource=this.getImportSource(tableID);}this.raiseEvent({name:"CurrentSourceChanged"});},resetImportSource:function(tableID){if(tableID){if(this.sheetsInfo&&this.sheetsInfo[tableID]){delete this.sheetsInfo[tableID];}if(this.importSources[tableID]){if(this.importSources[tableID].sourceInfo){this.importSources[tableID].sourceInfo.destroy();}this.importSources[tableID].destroy();}delete this.importSources[tableID];if(this.currentSource&&this.currentSource.tableID===tableID){this.currentSource=null;this.raiseEvent({name:"CurrentSourceChanged"});}}else{if(this.currentSource!==null){this.currentSource=null;this.raiseEvent({name:"CurrentSourceChanged"});}this.importSources={};}},hasRelationship:function(tableID,parent,child){var source=this.getImportSource(tableID),rs=source.relationship||[],i,found=false;if(!tableID||!parent||!child){return found;}if(!source){return found;}for(i=0;i<rs.length;i++){if(rs[i].parent.id===parent.id&&rs[i].child.id===child.id){found=true;break;}}return found;},isEMMACube:function(){var ret;if(this.currentSource&&this.currentSource.tableID){return true;}ret=this.getAllTableID().length>0;return ret;},hasEMMAReportInstance:function(){return mstrApp.getRootController().dataService.messageID?true:false;},populateSubscriptions:function(res){var model=this;var cubeInfo=model.cubesInfo;var subs=(res&&res.items)||[];var cubes=cubeInfo&&cubeInfo.cubes&&cubeInfo.cubes.cube;var docs=cubeInfo&&cubeInfo.cubes&&cubeInfo.cubes.doc;var id;cubes=cubes&&[].concat(cubes);subs=[].concat(subs);$ARR.forEach(cubes,function(cube){id=cube.cube_id;cube.subs=$ARR.filter(subs,function(elem){return elem.contentID===id;});});cubes=markCubeScheduleStatus(cubes);$ARR.forEach(docs,function(doc){var managedCubes=doc.cube?[].concat(doc.cube):[];$ARR.forEach(managedCubes,function(cube){cube.subs=$ARR.filter(subs,function(elem){return elem.contentID===cube.cube_id;});});markCubeScheduleStatus(managedCubes);});model.set("subsInfo",subs);},populateScheduleStatus:function(res){var cubes=this.cubesInfo&&this.cubesInfo.cubes&&this.cubesInfo.cubes.cube;var docs=this.cubesInfo&&this.cubesInfo.cubes&&this.cubesInfo.cubes.doc;var subsID,cubeID,i,j,status;var subs=res.sesr&&res.sesr.subscription;var subsStatus={},tempStatus;function statusSortFn(a,b){return a.timestamp-b.timestamp;}function populateSchedStatusCubes(cubes,subs){subs=[].concat(subs);$ARR.forEach(subs,function(sub){subsID=sub.did;cubeID=sub.content_id;i=$ARR.find(cubes,"cube_id",cubeID);if(i>=0){j=$ARR.find(cubes[i].subs,"did",subsID);if(j>=0){status=[];$ARR.forEach(sub.exec_status&&[].concat(sub.exec_status),function(v){status.push({en:v.en,emsg:v.emsg,timestamp:new Date($HELPER.normalizeTimestamp(v.timestamp))});});status.sort(statusSortFn);cubes[i].subs[j].status=status;subsStatus[subsID]=status;}}});cubes=markCubeScheduleStatus(cubes);}if(!subs){return ;}populateSchedStatusCubes(cubes,subs);$ARR.forEach(docs,function(doc){var managedCubes=doc.cube?[].concat(doc.cube):[];populateSchedStatusCubes(managedCubes,subs);});tempStatus=mstrmojo.hash.copy(this.subsStatus,tempStatus);subsStatus=mstrmojo.hash.copy(subsStatus,tempStatus);this.set("subsStatus",subsStatus);},mapAttribute:function mapAttribute(obj,selections,callbacks,originalObjectId){var mdl=this,source=mdl.getImportSource(obj.tableId),mappings,did=obj.did,i,aid,fid=selections.dssid,len;if(source.currentTransformations&&source.currentTransformations.xtab&&source.currentTransformations.xtab.isCrosstab){mappings=source.transformedMapping;}else{mappings=source.currentMapping;}aid=selections.aid;for(i=0,len=mappings.length;i<len;i++){if(mappings[i].afid===(aid+fid)){if(callbacks&&callbacks.failure){callbacks.failure(mstrmojo.desc(9926,"The attribute form you select has been mapped. Please choose a different one."));}return false;}}var index=mstrmojo.array.find(mappings,"did",did),mapping=mappings[index],remap=function remap(){mstrApp.getRootController().changeEMMAMappings();};if(mapping.isIDForm&&mapping.multiForms&&!mapping.ipa){mstrmojo.confirm(mstrmojo.desc(11164,"All other forms of the attribute will be unmapped. Do you want to continue?"),{confirmBtn:{fn:function(){var changedMappings=[];mstrmojo.array.forEach(mappings,function(map){if(map.oid===originalObjectId&&map.did!==did){changedMappings.push({did:map.did,aid:"",ot:12});}});changedMappings.push({did:did,aid:aid,fid:fid});remap(changedMappings);}}});}else{remap();}},getAllPartitionTables:function getAllPartitionTables(groupSourceId,partitionMemberTables){var importSources=this.importSources,groupSource=importSources[groupSourceId],mapping,source,groupTables=[],memberTables=[],tableName,allTableIds;function compareTable(a,b){var value;if(a.n<b.n){value=-1;}else{if(a.n===b.n){value=0;}else{value=1;}}return value;}if(!groupSource){return[];}mapping=getCurrentMapping(groupSource);allTableIds=this.getAllTableID();$ARR.forEach(allTableIds,function(sourceId){if(sourceId!==groupSourceId){source=importSources[sourceId];if(checkGroupPartitionConditions(groupSource,mapping,source,getCurrentMapping(source))){tableName=source.sourceInfo&&source.sourceInfo.name;groupTables.push({n:tableName||"",isMember:false,sourceId:sourceId});}}});groupTables.sort(compareTable);$ARR.forEach(partitionMemberTables,function(table,i){tableName=table.name||"";memberTables.push({n:tableName,isMember:true,ptIndex:i+1});});memberTables.sort(compareTable);groupTables=memberTables.concat(groupTables);return groupTables;},detectPartitionGroups:function detectPartitionGroups(tableIds){var importSources=this.importSources,table,groups=[],mapping,curGroup,isFound,tableName,tableNames,newGroups=[];if(tableIds.length<=1){return groups;}$ARR.forEach(tableIds,function(tableId){table=importSources[tableId];if(!table){return ;}mapping=getCurrentMapping(table);if(!mapping||!mapping.length){return ;}curGroup={importSource:table,mapping:mapping};isFound=false;$ARR.forEach(groups,function(group){if(checkGroupPartitionConditions(curGroup.importSource,curGroup.mapping,group.importSource,group.mapping)){group.tableIds.push(tableId);isFound=true;return false;}return true;});if(!isFound){curGroup.tableIds=[tableId];groups.push(curGroup);}});$ARR.forEach(groups,function(group){if(group.tableIds.length<=1){return ;}tableNames=[];$ARR.forEach(group.tableIds,function(tableId){table=importSources[tableId];tableName=(table.sourceInfo&&table.sourceInfo.name)||"";tableNames.push(tableName);});newGroups.push({tableIds:group.tableIds,tableNames:tableNames});});return newGroups;},populateVIDatasets:function(datasets){var arr=[{name:mstrmojo.desc(14201,"A New Dataset"),did:-1}];datasets=$ARR.filter(datasets,function(dataset){var canAddTo=true,table=dataset.tables&&dataset.tables[0];if(dataset.dsm===2&&table&&table.dict===constants.backendSourceSubtype.url&&table.dbt===$ENUM_DATABASE_TYPE.BDE){canAddTo=false;}return canAddTo;});arr=arr.concat(datasets);this.set("datasets",arr);},selectDataset:function(dataset){var controller=mstrApp.getRootController();if(dataset&&dataset.did!==-1){this.set("isManagedCube",!!dataset.mngd);controller.rootView.showFooter({managedCheckbox:{enabled:false}});this.set("currentDataset",dataset||null);}else{this.set("currentDataset",null);controller.rootView.showFooter({managedCheckbox:{enabled:true}});this.set("isManagedCube",true);}},canSubscribe:function(){var tableIDs=this.getAllTableID(),ret=false,i;for(i=0;i<tableIDs.length;i++){ret|=this.getImportSource(tableIDs[i]).canSubscribe();}return ret;},isTableAliasUnique:function(alias){var unique=true,Ids=this.getAllTableID(),source,i;for(i=0;i<Ids.length;i++){source=this.getImportSource(Ids[i]);if(source&&source.sourceInfo&&alias===source.sourceInfo.name){unique=false;break;}}return unique;},hasPrivilegesForAllTables:function hasPrivilegesForAllTables(tables){var privilege=true,constantsXdaType=constants.xdaType;$ARR.forEach(tables,function(table){switch(table.xdaType){case constantsXdaType.text:case constantsXdaType.excel:case constantsXdaType.refine:case constantsXdaType.dataImportOAuthGDrive:case constantsXdaType.dataImportOAuthDropbox:if(!mstrApp.diParams.AccessDataFromFiles){privilege=false;return ;}break;case constantsXdaType.dataImportOAuthGBigQuery:case constantsXdaType.dataImportOAuthGBigQueryFFSQL:case constantsXdaType.dataImportOAuthGBigQuerySingleTable:case constantsXdaType.qbSingleTable:case constantsXdaType.ffsql:case constantsXdaType.querybuilder:case constantsXdaType.mdx:if(!mstrApp.diParams.ImportDatabase){privilege=false;return ;}break;case constantsXdaType.salesforce:case constantsXdaType.dataImportOAuthGAnalytics:case constantsXdaType.twitter:case constantsXdaType.facebook:if(!mstrApp.diParams.AccessDataFromCloudApp){privilege=false;return ;}break;}});return privilege;},hasRefreshDataPrivilegesForAllTables:function hasRefreshDataPrivilegesForAllTables(tables){var privilege=this.hasPrivilegesForAllTables(tables);return privilege||mstrApp.isSingleTier;},isRefreshDataSupported:function isOAuthSupported(xdaType,hnc){var constantsXdaType=constants.xdaType;switch(xdaType){case constantsXdaType.dataImportOAuthGDrive:case constantsXdaType.dataImportOAuthDropbox:case constantsXdaType.dataImportOAuthGBigQuery:case constantsXdaType.dataImportOAuthGBigQueryFFSQL:case constantsXdaType.dataImportOAuthGBigQuerySingleTable:case constantsXdaType.dataImportOAuthGAnalytics:case constantsXdaType.dataImportOAuthSalesforce:case constantsXdaType.twitter:case constantsXdaType.facebook:if(document.location.protocol.indexOf("https")<0&&!mstrApp.isSingleTier){return false;}else{return true;}break;default:return true&&!hnc;}},isRefined:function isRefined(tableID){var source=this.getImportSource(tableID);return source?source.isRefined():false;},isParsed:function isParsed(tableID){var source=this.getImportSource(tableID);return source?source.isParsed():false;},populateSourceListAdminConfig:function(resourceConfig,dbRoleConfig){var model=this,sources=model.sourceItems,unselectedSources=resourceConfig;$ARR.forEach(sources,function(item){var sid=item.sid,idx;if(resourceConfig){idx=$ARR.indexOf(unselectedSources,sid);item.selected=idx<0;}if(dbRoleConfig&&dbRoleConfig[sid]){item.dbRolesAdminConfig=dbRoleConfig[sid];}});},isLinkedMFA:function(col){var ret=false;var cols=this.findMappingItem(col);if(cols.length>1){$ARR.forEach(cols,function(item){if(item.isMultiForm){ret=true;return false;}});}return ret;},getUniqueAlias:function(type,alias){var valid=false,maps,cnt,idx;maps=this.getAllMappings();maps=$ARR.filter(maps,function(col){return col.tp===type;});cnt=1;while(!valid){valid=true;cnt++;if(alias.length>=250){alias=alias.substr(0,100)+"..."+alias.substr(alias.length-100,100);}idx=$ARR.find(maps,"alias",alias);if(idx>=0){valid=false;alias=alias+" ("+cnt+")";}}return alias;}});}());
(function(){mstrmojo.requiresCls("mstrmojo._HasLayout","mstrmojo.css","mstrmojo.dom","mstrmojo.home.ui.Card");mstrmojo.requiresDescs(629,1388,11477,11478,14354,11253,14509,14508,14507,14506,11252,11251,11250,11249,11247,11248);mstrmojo.home.ui.RecentsCard=mstrmojo.declare(mstrmojo.home.ui.Card,[],{scriptClass:"mstrmojo.home.ui.RecentsCard",title:mstrmojo.desc(14354,"Recents"),model:null,init:function init(props){this._super(props);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-RecentsCard");},preBuildRendering:function preBuildRendering(){var model=this.model;this.addChildren([{scriptClass:"mstrmojo.home.ui.RecentsList",alias:"list",items:model.getRecentObjects()}]);if(this._super()){this._super();}this.list.attachEventListener("ItemExecute",this.id,"handleExecution");},handleExecution:function handleExecution(evt){if(evt.item&&evt.item.url){this.parent.controller.executeLink(evt.item.url+"&"+mstrApp.name+"="+encodeURIComponent(mstrApp.servletState));}else{if(evt.item.html&&evt.item.info){}else{mstrApp.showWait({message:"Executing..."});}}}});mstrmojo.home.ui.RecentsList=mstrmojo.declare(mstrmojo.ui.List,[],{scriptClass:"mstrmojo.home.ui.RecentsList",init:function init(props){this._super(props);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-RecentsList");},buildRelativeTime:function buildRelativeTime(item){var time="";if(item.timestamp){var periods={minute:60,hour:60*60,day:24*60*60,week:7*24*60*60,month:30*24*60*60,year:365*24*60*60};var timestamp=parseInt(item.timestamp,10);var diff=Math.floor((new Date().getTime()-timestamp)/1000);var ago,suffix;if(Math.floor(diff/periods.year)){time=mstrmojo.desc(11253,"More than a year ago");}else{if(Math.floor(diff/periods.month)){ago=Math.floor(diff/periods.month);if(ago===1){time=mstrmojo.desc(14508,"About a month ago");}else{time=mstrmojo.desc(14509,"About # months ago").replace("#",ago);}}else{if(Math.floor(diff/periods.week)){ago=Math.floor(diff/periods.week);if(ago===1){time=mstrmojo.desc(14506,"About a week ago");}else{time=mstrmojo.desc(14507,"About # weeks ago").replace("#",ago);}}else{if(Math.floor(diff/periods.day)){ago=Math.floor(diff/periods.day);if(ago===1){time=mstrmojo.desc(11251,"About a day ago");}else{time=mstrmojo.desc(11252,"About # days ago").replace("#",ago);}}else{if(Math.floor(diff/periods.hour)){ago=Math.floor(diff/periods.hour);if(ago===1){time=mstrmojo.desc(11249,"About an hour ago");}else{time=mstrmojo.desc(11250,"About # hours ago").replace("#",ago);}}else{ago=Math.floor(diff/periods.minute);if(ago===1){time=mstrmojo.desc(11247,"About a minute ago");}else{time=mstrmojo.desc(11248,"About # minutes ago").replace("#",ago);}}}}}}}return time;},getItemProps:function getItemProps(item,idx){var itemProps=this._super(item,idx);itemProps.iconCls=item.iconCls;itemProps.url=item.url;if(mstrConfig.showPreviews){itemProps.src=item.imgData!==undefined?"data:image/png;base64,"+(item.imgData):"../images/1ptrans.gif";}else{itemProps.src="../images/1ptrans.gif";}if(item.html){itemProps.html=item.html;}itemProps.time=this.buildRelativeTime(item);itemProps.previewCssCls=!item.imgData&&!item.t?" sample p"+item.pos:"";if(item.overlayText){itemProps.overlayText=item.overlayText;}return itemProps;},getItemMarkup:function getItemMarkup(item,idx){var markup=this._super(item,idx);if(item.url&&!item.info){return markup.replace("{@en@n}",'<a href="{@url}">'+(item.imgData===undefined&&item.html!==undefined?"{@html}":'<img class="preview {@previewCssCls}" src="{@src}"/>')+'<div class="overlayText">{@overlayText}</div><div class="name-time"><span class="{@iconCls}"></span>{@en@n}<div class="time">{@time}</div></div></a>');}else{return markup.replace("{@en@n}","<div>{@html}</div>");}},onclick:function onclick(evt){evt.preventDefault();evt.cancel();this._super(evt);if(this.selectedItem){this.raiseEvent({name:"ItemExecute",item:this.selectedItem});}return false;},postBuildRendering:function(){this._super();this.carousel();var me=this;window.setTimeout(function(){me.refresh();},5*60*1000);},carousel:function carousel(){jQuery&&jQuery(this.itemsContainerNode).slick({slidesToShow:4,slidesToScroll:4,infinite:false,dots:false,lazyLoad:"ondemand",responsive:[{breakpoint:1640,settings:{slidesToShow:4,slidesToScroll:4}},{breakpoint:1224,settings:{slidesToShow:3,slidesToScroll:3}},{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:2}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}]});}});}());
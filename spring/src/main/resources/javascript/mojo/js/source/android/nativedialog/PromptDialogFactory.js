(function(){mstrmojo.requiresCls("mstrmojo.android.nativedialog.EditTextDialog","mstrmojo.android.nativedialog.ListDialog","mstrmojo.android.nativedialog.SliderDialog","mstrmojo.android.nativedialog.DateTimePickerDialog","mstrmojo.android.nativedialog.DatePickerDialog","mstrmojo.android.nativedialog.ElementPromptDialog","mstrmojo.android.nativedialog.MultiSelectDatePromptDialog","mstrmojo.array","mstrmojo.num");var $ARR=mstrmojo.array,$TYPES=mstrmojo.prompt.WebPrompt.TYPES,TEXTFIELD=1,LIST=2,SLIDER=5,CALENDAR=6,DATE_TIME_PICKER=7;function getTextValidator(promptItem){var validator={max:promptItem.max,min:promptItem.min};return validator;}function getPositiveButton(config){return config.buttons[1];}function setPositiveButtonOnClick(config,promptList,idx,promptItem){var positiveButton=config.buttons[1];var originalPositiveButtonOnClick=positiveButton.onclick;positiveButton.onclick=function(value){switch(promptItem._style){case DATE_TIME_PICKER:originalPositiveButtonOnClick(eval("("+value+")"));break;case LIST:promptList.setAnswer(promptItem,idx,[eval("("+value+")")]);break;case CALENDAR:var obj=eval("("+value+")");if(config.children[0].isMultiSelect){var result=[];$ARR.forEach(obj,function(item){result.push(mstrmojo.date.formatDateInfo(item,mstrmojo.locales.datetime.DATEOUTPUTFORMAT));});try{promptItem.setAnswerValue(result);}catch(e){mstrmojo.alert(e.message||e);return ;}promptItem.syncDateAnswer({success:function(){promptList.updateItem(idx);promptList.setAnswer(promptItem,idx,[result]);},failure:function(msg){window.setTimeout(function(){mstrmojo.alert(msg);},0);}});}else{originalPositiveButtonOnClick(obj);}break;default:promptList.setAnswer(promptItem,idx,[value]);break;}};}mstrmojo.android.nativedialog.PromptDialogFactory=mstrmojo.provide("mstrmojo.android.nativedialog.PromptDialogFactory",{createPromptDialog:function createPromptDialog(config,promptList,idx,promptItem){var clazz;switch(promptItem._style){case TEXTFIELD:config.validator=getTextValidator(promptItem);clazz=mstrmojo.android.nativedialog.EditTextDialog;break;case SLIDER:config.children=[config.children[2]];clazz=mstrmojo.android.nativedialog.SliderDialog;break;case DATE_TIME_PICKER:var picker=config.children[0];picker.dtValue=picker.value;clazz=mstrmojo.android.nativedialog.DateTimePickerDialog;break;case LIST:var picker=config.children[1],searchBar=config.children[0];if(!picker.multiSelect){config.onSelectionChange=function(value){promptList.setAnswer(promptItem,idx,[eval("("+value+")")]);this.close();};}config.children=[picker,searchBar,promptItem];clazz=mstrmojo.android.nativedialog.ElementPromptDialog;break;case CALENDAR:var datePicker=config.children[0];config.children=[datePicker,promptItem];if(datePicker.isMultiSelect){clazz=mstrmojo.android.nativedialog.MultiSelectDatePromptDialog;}else{datePicker.dtValue=datePicker.value;clazz=mstrmojo.android.nativedialog.DatePickerDialog;}break;}if(!!getPositiveButton(config)){setPositiveButtonOnClick(config,promptList,idx,promptItem);}return new clazz(config);},showDialog:function showDialog(config,promptList,idx,promptItem){this.createPromptDialog(config,promptList,idx,promptItem).show();}});}());
(function(){mstrmojo.requiresCls("mstrmojo.ui.MobileCheckList","mstrmojo._IsInputControl","mstrmojo.android._HasPreviewButton","mstrmojo.android._IsIncFetchList","mstrmojo.array");var BLOCK_SIZE=50;function createIncFetchDataHelper(){return{next:function(cb){var newEnd=Math.min(this.blockEnd+BLOCK_SIZE,this.totalSize);cb.success(null,this.items.slice(this.blockEnd,newEnd));this.blockEnd=newEnd;},init:function(begin,end,items){this.blockBegin=begin;this.blockEnd=end;this.totalSize=items.length;this.items=items;}};}mstrmojo.android.inputControls.PullDownDIC=mstrmojo.declare(mstrmojo.ui.MobileCheckList,[mstrmojo._IsInputControl,mstrmojo.android._HasPreviewButton,mstrmojo.android._IsIncFetchList],{scriptClass:"mstrmojo.android.inputControls.PullDownDIC",multiSelect:false,isElastic:true,supportsIncFetch:false,init:function init(props){this._super(props);this._items=this.getItems();if(this._items.length>BLOCK_SIZE){this.ifDataHelper=createIncFetchDataHelper();this.supportsIncFetch=true;}},postselectionChange:function postselectionChange(evt){var idx=evt.added[0];if(idx<this.items.length){this.set("value",this.items[idx].v);}},preBuildRendering:function preBuildRendering(){this._super();var value=this.value,ust=this.dic.ust||"",items=this._items,idx=mstrmojo.array.find(items,"v",value);if(idx===-1){items=[{n:ust,v:value}].concat(items);idx=0;}if(this.supportsIncFetch){this.ifDataHelper.init(0,BLOCK_SIZE,items);items=items.slice(0,BLOCK_SIZE);}this.items=items;this.set("selectedIndex",idx);},postBuildRendering:function postBuildRendering(){this._super();this._scroller.scrollTo(0,0);},renderPreview:function renderPreview(){var idx=mstrmojo.array.find(this._items,"v",this.value),label=(idx>=0)?this._items[idx].n:(this.dic.ust!==undefined?this.dic.ust:this.dv);this.renderPreviewButton(this.openerNode,this.dicChanged?label:this.dv);}});}());
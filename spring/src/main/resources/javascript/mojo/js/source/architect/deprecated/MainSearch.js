(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ObjectInputBox","mstrmojo.Button","mstrmojo._HasLayout");mstrmojo.Architect.MainSearch=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{markupString:'<div id={@id} class="mstrmojo-ArchitectMainSearch {@cssClass}" style="{@cssText}"><div></div><div></div><div style="clear:both;"></div></div>',markupSlots:{inputBox:function(){return this.domNode.firstChild;},searchButton:function(){return this.domNode.children[1];}},layoutConfig:{h:{inputBox:"25px",searchButton:"auto"},w:{inputBox:"100%",searchButton:"30px"}},children:[{scriptClass:"mstrmojo.ObjectInputBox",slot:"inputBox",alias:"SearchBox",item2textCss:function item2textCss(data){return data.t?(" mstrmojo-ArchitectListIconSuggest t"+data.t):"";},hideEditButton:function(d){return false;},browseItemVisible:false,dynamicVerify:false,emptyText:"Type here to input attribute or metric ...",postBuildRendering:function postBuildRendering(){if(this._super){this._super();}}},{scriptClass:"mstrmojo.Button",slot:"searchButton",iconClass:"mstrmojo-Architect-SearchBox-search",title:"Search",onclick:function(){var its=this.parent.SearchBox.getSelectedObjects(),len=its.length,model=mstrmojo.all.ArchModel,tr=mstrmojo.all.ProjTableTree,i,j,len2;if(len===0){tr.load();}else{var pair=[];for(i=0;i<len;i++){pair.push(its[i].did+","+its[i].t);}model.getObjectInBulk(pair,{success:function(res){var objectInfo=res.mi.es.oi;objectInfo=objectInfo.length?objectInfo:[objectInfo];for(i=0,len=objectInfo.length;i<len;i++){var object=objectInfo[i];if(object.tp===12&&!model.attrs[object.did]){var e=object.def.fms.fm_c.e,fms={};e=e.length?e:[e];for(j=0,len2=e.length;j<len2;j++){var bfm=e[j],cid=bfm.fm.did,n=model.frms[cid]?model.frms[cid].n:"";fms[bfm.bfi]={baseFrmID:bfm.bfi,fmcatid:cid,n:n};}model.attrs[object.did]={id:object.did,name:its[i].n,tbls:[],Forms:fms};}if(object.tp===13&&!model.fcts[object.did]){model.fcts[object.did]={id:object.did,name:its[i].n,tbls:object.ts,Sum:true,Count:false,Max:false,Min:false,Variance:false,Average:false};}}}});model.getTbl4Obj(pair,{success:function(res){var table;for(i=0,len2=res.length;i<len2;i++){table=res[i];res[i]={n:table.n,did:table.did,t:table.tp,isNew:false,prid:"",pdbr:{},secdbrs:{},relations:[],items:[],clns:[],FactInfos:{},AttrInfos:{}};model.tbls[table.did]=res[i];}tr.set("items",res);}});}}}]});}());
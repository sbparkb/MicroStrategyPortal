(function(){mstrmojo.requiresClsP("mstrmojo.chart","TripleId","CategoryPlot","MarkerObject","NumberObject","Point2D","SeriesRenderer","PolyLineObject","DataLabelManager");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumCollectionType","EnumDSSExtraGraphObject","EnumMajorGraphType","EnumLayout","EnumOrientation","EnumAttachedPointsStyle","EnumImageUsage","EnumGraphMatrixElementSizeMode","EnumValueAxis");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphMarkerShape","EnumDSSGraphObject","EnumShapeType","EnumDSSExtraGraphProperty");var $C=mstrmojo.chart,$CHART_ENUMS=$C.enums,$CT=$CHART_ENUMS.EnumCollectionType,$EGO=$CHART_ENUMS.EnumDSSExtraGraphObject,$MAJOR_GRAPH_TYPE=$CHART_ENUMS.EnumMajorGraphType,$LAYOUT=$CHART_ENUMS.EnumLayout,$OR=$CHART_ENUMS.EnumOrientation,$VA=$CHART_ENUMS.EnumValueAxis,$APS=$CHART_ENUMS.EnumAttachedPointsStyle,$IMG_USAGE=$CHART_ENUMS.EnumImageUsage,$GMESM=$CHART_ENUMS.EnumGraphMatrixElementSizeMode,$NULL_GROUP_ID=$C.gNullGroupId,$M=$C.model,$MODEL_ENUMS=$M.enums,$MS=$MODEL_ENUMS.EnumDSSGraphMarkerShape,$GO=$MODEL_ENUMS.EnumDSSGraphObject,$SHP=$MODEL_ENUMS.EnumShapeType;var perfCheckedTripleId=new $C.TripleId(),primordialPoint=new $C.Point2D(),kNullPoint=new $C.Point2D();primordialPoint.Reset(-2,-2);kNullPoint.Reset(-1,-1);primordialPoint.dangling=true;kNullPoint.isNull=true;mstrmojo.chart.LineSeriesOptions=mstrmojo.provide("mstrmojo.chart.LineSeriesOptions",{});function countLineSeries(){if(this.mExpectedLineCount===undefined){var series=this.mSeriesInfo,i,id,res=0,dataset=this.mDatasetPtr,len=series.length;for(i=0;i<len;i++){id=series[i].mSeriesId;if(dataset.GetShapeBySeries(id)===$SHP._LINE){res++;}}this.mExpectedLineCount=res;}return this.mExpectedLineCount;}function newLineSeriesOptions(){return{mShowStepLine:false,mShowMarkers:true,mMarkerShape:0,mMarkerSize:50};}function hGetGroupIdMapAtSeries(iInfoIndex){if(!this.mSupportDiscretePoints){return ;}var oneMap=[],accumulateIndex=0,point=new $C.Point2D(),mapVector=this.mVecGroupIdMapPerSeries,i,groupCount;if(this.discreteMatrix===undefined){this.discreteMatrix=[];}var discetePoints=[];mapVector.splice(0,mapVector.length);groupCount=this.mGroupCount;for(i=0;i<groupCount;++i){if(this.GetLinePoint(iInfoIndex,i,point)){oneMap[accumulateIndex]=i;accumulateIndex++;}else{if(oneMap.length>0){var temp=oneMap.concat();mapVector.push(temp);}oneMap.splice(0,oneMap.length);accumulateIndex=0;discetePoints.push(i);}}discetePoints.push(groupCount);this.discreteMatrix[iInfoIndex]=discetePoints;if(oneMap.length>0){mapVector.push(oneMap);}}function hIsLastFrame(){if(this.mChartContextPtr.mUseAnimation){return this.mProgress===1;}return true;}function hIsFirstFrame(){return true;}function hCalculateClusterPosition(infoIndex,groupIndex){var indexInColumns=-1,index,position,clusterInfo=this.clusterInfo,plotCtx=this.mpABLPlotContext,categoryAxis=plotCtx.mCategoryAxisPtr;index=this.mSeriesInfo[infoIndex].mDataIndex;if(clusterInfo.Circle){indexInColumns=clusterInfo.Circle.indexOf(index);}if(indexInColumns===-1&&clusterInfo.Tick){indexInColumns=clusterInfo.Tick.indexOf(index);}if(indexInColumns===-1&&clusterInfo.Square){indexInColumns=clusterInfo.Square.indexOf(index);}if(indexInColumns===-1){indexInColumns=index%clusterInfo.columns;}position=categoryAxis.getGroupStartPos(groupIndex)+0.5*clusterInfo.groupGap+(clusterInfo.unitWidth+clusterInfo.riserGap)*indexInColumns+0.5*clusterInfo.unitWidth;position=Math.floor(position+0.5);return position;}function hGetShapePosition(infoIndex,groupIndex,suggestPoint){var chartCtx=this.mChartContextPtr;if(chartCtx.RenderClusterShapes()&&this.mpABLPlotContext.takeGroupCenter===false){if(this.clusterInfo===undefined){var allShapes,columns=this.mDatasetPtr.GetClusterSeriesCount(),groupSize=this.mpABLPlot.mABLPlotContext.mCategoryAxisPtr.getGroupSize(),clusterInfo=this.evalBarStyleUnitWidth(groupSize,columns);this.clusterInfo=mstrmojo.hash.copy(clusterInfo);if(allShapes){var thisClusterInfo=this.clusterInfo;thisClusterInfo.Circle=allShapes.Circle.concat();thisClusterInfo.Tick=allShapes.Tick.concat();thisClusterInfo.Square=allShapes.Square.concat();}}var position=hCalculateClusterPosition.call(this,infoIndex,groupIndex),point=new $C.Point2D({Point2D:suggestPoint});if(this.mIsVertical){point.x=position;}else{point.y=position;}return point;}return suggestPoint;}function hRenderSinglePoints(result,infoIndex,linePointSet,groupId){var returnVal,valueAxis,i,j,Id,objectsInOnePoint,axisKey,checkClip=false,offsets,shape=result.shape,lowBoundary,highBoundary,points=linePointSet[groupId],chartCtx=this.mChartContextPtr,dataset=this.mDatasetPtr,singlePointObjects=this.mSinglePointObjects,gmCtx=chartCtx.GetGraphMatrixContext(),numberOfPoints,len;valueAxis=this.mpABLPlotContext.mValueAxis[this.mSeriesInfo[infoIndex].mValueAxis];if(valueAxis){checkClip=true;returnVal=valueAxis.GetMaxMinDataInputPosition();lowBoundary=returnVal.LowBoundary;highBoundary=returnVal.HighBoundary;axisKey="y1";var objectId=valueAxis.mTripleId.mObjectId;axisKey=chartCtx.getAxisKeyFromObjectId(objectId);offsets=this.mClippedMarkerSize[axisKey];}numberOfPoints=points.length;var position;var isDataLabelEnabled,oneObject,lowOffset,highOffset,shapeSize;for(i=0;i<numberOfPoints;++i){Id=new $C.TripleId({ObjectId:$GO.DssGraphRiser,SeriesId:this.mSeriesInfo[infoIndex].mSeriesId,GroupId:this.getCorrectGroupIdInSeriesPoints(i,groupId)});position=hGetShapePosition.call(this,infoIndex,Id.mGroupId,points[i]);objectsInOnePoint=this.drawSingleDataPoint(Id,position,shape);len=objectsInOnePoint.length;for(j=0;j<len;++j){if(objectsInOnePoint[j].Object){this.AddToMapAndList(objectsInOnePoint[j].Object);}}isDataLabelEnabled=dataset.showSeriesDatalabel(Id.mSeriesId);if(objectsInOnePoint.length>0){if(objectsInOnePoint[0].Object!==null&&objectsInOnePoint[0].Object!==undefined&&isDataLabelEnabled){singlePointObjects.push(objectsInOnePoint[0].Object);}result.AlreadyInMapAndList=true;result.Obj=objectsInOnePoint[0];if(checkClip){len=objectsInOnePoint.length;for(j=0;j<len;++j){oneObject=objectsInOnePoint[j];lowOffset=offsets.LowOffset;highOffset=offsets.HighOffset;shapeSize=oneObject.ShapeSize;if(shapeSize===undefined){if(oneObject.Object){shapeSize=oneObject.Object.getShapeSize();}else{shapeSize=0;}}returnVal=gmCtx.getClippedOffset(lowBoundary,highBoundary,shapeSize,points[i],!chartCtx.IsVertical(),lowOffset,highOffset);offsets.LowOffset=lowOffset=returnVal.LowOffset;offsets.HighOffset=highOffset=returnVal.HighOffset;}}}}result.AlreadyInMapAndList=true;result.Obj=null;return result;}function hDrawStandAlonePoint(seriesIndex){var chartCtx=this.mChartContextPtr,point,points=[];if(chartCtx.mIsGraphMatrix&&this.mGroupCount===1){point=new $C.Point2D();if(!this.GetLinePoint(seriesIndex,0,point)){return ;}points.push(point);var pointsSet=[];pointsSet.push(points);var result={};var shape=hGetShapeBySeries.call(this,seriesIndex);result.shape=shape;hRenderSinglePoints.call(this,result,seriesIndex,pointsSet,0);if(result.AlreadyInMapAndList===false){this.AddToMapAndList(result.Obj);}}}function hCheckSizeBy(seriesId,startGroupId,size){var i,value,first=true,last=0,performanceLimit=100;for(i=0;i<size;++i){value=this.mDatasetPtr.GetSizeByData(seriesId,startGroupId+i);if(value!==null){if(first){last=value;first=false;}else{if(last!==value){return true;}}}if(i>performanceLimit){return true;}}return false;}function hRenderLineByStroke(needGradient,linePointSet,groupId,infoIndex,lineWidth){var chartCtx=this.mChartContextPtr,points=linePointSet[groupId],tripleId=new $C.TripleId({ObjectId:$GO.DssGraphDataLine,SeriesId:this.mSeriesInfo[infoIndex].mSeriesId,GroupId:groupId}),lineObject,oldLineFormat,dataset=this.mDatasetPtr,numberOfPoints;tripleId.mGroupId=this.getCorrectGroupIdInSeriesPoints(0,tripleId.mGroupId);lineObject=new $C.PolyLineObject({TripleId:tripleId,GraphObjectManager:this,PolyLine:points,GraphCollectionObject:this.mLineCollections[infoIndex],Shape:$SHP._LINE});oldLineFormat=lineObject.mFormatLinePtr;lineObject.movePointsAgainstBorder();points=lineObject.mLinePoints;var needColorByGradient=needGradient&&this.mDatasetPtr.isGradientABL();if(needColorByGradient){var i,step,pointsCount=points.length,oneColor,props={Valid:true,Angle:chartCtx.IsVertical()?0:1,EndAlpha:255,Style:1,Colors:[],Start:{x:points[0].x,y:points[0].y},End:{x:points[pointsCount-1].x,y:points[pointsCount-1].y}};numberOfPoints=points.length;for(i=0;i<numberOfPoints;++i){step=i/(points.length-1);oneColor=dataset.GetColorByData(tripleId.mSeriesId,tripleId.mGroupId+i);props.Colors.push({Step:step,Color:oneColor});}lineObject.mFormatLinePtr=oldLineFormat.transformToGradient(props);this.AddToMapAndList(lineObject);}if(dataset.showSeriesDatalabel(tripleId.mSeriesId)){this.mPolyLineObjects.push(lineObject);}return{Obj:lineObject,AlreadyInMapAndList:needColorByGradient};}function hGetTwoPointsFromBasePointForGMTrapezoid(basePoint,maxSize,sizeRatio,point1,point2){var gmCtx=this.mChartContextPtr.GetGraphMatrixContext(),baseOffset=gmCtx.GetScaledSizeWithRatio(sizeRatio,maxSize)/2,tempPoint1=new $C.Point2D({Point2D:basePoint}),tempPoint2=new $C.Point2D({Point2D:basePoint});if(this.mIsVertical){tempPoint1.y-=baseOffset;tempPoint2.y+=baseOffset;}else{tempPoint1.x-=baseOffset;tempPoint2.x+=baseOffset;}point1.x=tempPoint1.x;point1.y=tempPoint1.y;point2.x=tempPoint2.x;point2.y=tempPoint2.y;}function hGetPolyGonFromPointsForGMTrapezoid(lineId,points,lineWidth){var gmCtx=this.mChartContextPtr.GetGraphMatrixContext(),minEleSizeMode=gmCtx.mElementsInfo.Min.Mode,onePoint,i,upperPoints=[],lowerPoints=[],ratio=0,returnVal,upperPoint,lowerPoint,result,numberOfPoints;numberOfPoints=points.length;for(i=0;i<numberOfPoints;++i){onePoint=points[i];returnVal=this.mDatasetPtr.GetSizeByData(lineId.mSeriesId,lineId.mGroupId+i);if(returnVal!==null){ratio=gmCtx.ToRatioEx(returnVal,(minEleSizeMode===$GMESM._PROPORTIONAL));if(ratio<0){ratio=0;}}upperPoint=new $C.Point2D();lowerPoint=new $C.Point2D();hGetTwoPointsFromBasePointForGMTrapezoid.call(this,onePoint,lineWidth,ratio,upperPoint,lowerPoint);upperPoints.push(upperPoint);lowerPoints.push(lowerPoint);}lowerPoints.reverse();result=upperPoints.concat(lowerPoints);return result;}function hRenderLineWithFill(needGradient,linePointSet,groupId,infoIndex,lineWidth){var dataset=this.mDatasetPtr,linePoints=linePointSet[groupId],i,fill,gradientFill,polygon,props,linePolygon=null,chartCtx=this.mChartContextPtr,seriesInfos=this.mSeriesInfo,gmCtx=chartCtx.GetGraphMatrixContext(),currentLineWidth=gmCtx.GetAdjustThicknessValue(lineWidth),tripleId=new $C.TripleId({ObjectId:$GO.DssGraphRiser,SeriesId:seriesInfos[infoIndex].mSeriesId,GroupId:groupId}),numberOfPoints,returnVal,lowBoundary,highBoundary,offsets,axisKey,objectId;tripleId.mGroupId=this.getCorrectGroupIdInSeriesPoints(0,tripleId.mGroupId);polygon=hGetPolyGonFromPointsForGMTrapezoid.call(this,tripleId,linePoints,currentLineWidth);if(chartCtx.mImageUsage===$IMG_USAGE.GENERAL){linePolygon=new $C.PolygonObject({TripleId:tripleId,GraphObjectManager:this,Polygon:polygon,Shape:$SHP._POLYGON});linePolygon.mPointsStyle=$APS.TOOLTIP_TRAPEZOID;}var valueAxis=this.mpABLPlotContext.mValueAxis[seriesInfos[infoIndex].mValueAxis];if(valueAxis){returnVal=valueAxis.GetMaxMinDataInputPosition();lowBoundary=returnVal.LowBoundary;highBoundary=returnVal.HighBoundary;objectId=valueAxis.mTripleId.mObjectId;axisKey=chartCtx.getAxisKeyFromObjectId(objectId);offsets=this.mClippedMarkerSize[axisKey];}if(needGradient&&linePolygon){fill=linePolygon.mFormatFillPtr;props=this.prepareTransitionalGradient(tripleId,linePoints);gradientFill=fill.transformToGradient(props);linePolygon.SetFormatFill(gradientFill);}numberOfPoints=polygon.length;var basePosition,extraPadding=2+2;for(i=0;i<numberOfPoints;++i){basePosition=this.mChartContextPtr.IsVertical()?polygon[i].y:polygon[i].x;if(this.mChartContextPtr.IsVertical()){if(basePosition<highBoundary){offsets.HighOffset=Math.max(offsets.HighOffset,highBoundary-basePosition);offsets.HighOffset=Math.max(offsets.HighOffset,extraPadding);}if(lowBoundary<basePosition){offsets.LowOffset=Math.max(offsets.LowOffset,basePosition-lowBoundary);offsets.LowOffset=Math.max(offsets.LowOffset,extraPadding);}}else{if(basePosition-highBoundary>0){offsets.HighOffset=Math.max(offsets.HighOffset,basePosition-highBoundary);offsets.HighOffset=Math.max(offsets.HighOffset,extraPadding);}if(lowBoundary-basePosition>0){offsets.LowOffset=Math.max(offsets.LowOffset,lowBoundary-basePosition);offsets.LowOffset=Math.max(offsets.LowOffset,extraPadding);}}}if(linePolygon){this.AddToMapAndList(linePolygon);if(dataset.showSeriesDatalabel(tripleId.mSeriesId)){this.mPolygonObjects.push(linePolygon);}}return{Obj:linePolygon,AlreadyInMapAndList:true};}function hRenderLineShape(infoIndex,groupId,linePointSet){var chartCtx=this.mChartContextPtr,maxLineWidthForStrokeOnly=4,gmCtx=chartCtx.GetGraphMatrixContext(),lineWidth=gmCtx.GetMaxElementSizeInLineChart(this.mIsVertical,this.mGroupCount,false,$MS.DssGraphMarkerShapeNone),needGradient=false,strokeOnly=true;if(this.mHasSizeBy){strokeOnly=(lineWidth<=maxLineWidthForStrokeOnly)&&!hCheckSizeBy.call(this,this.mSeriesInfo[infoIndex].mSeriesId,this.getCorrectGroupIdInSeriesPoints(0,groupId),linePointSet[groupId].length);if(gmCtx.mMaxSizeVal===gmCtx.mMinSizeVal){lineWidth=Math.max(gmCtx.mElementsInfo.Max.Size,gmCtx.mConstants.MinimalSize.Line);}}needGradient=needGradient||this.mHasColorBy;if(strokeOnly){return hRenderLineByStroke.call(this,needGradient,linePointSet,groupId,infoIndex,lineWidth);}return hRenderLineWithFill.call(this,needGradient,linePointSet,groupId,infoIndex,lineWidth);}function hGetShapeBySeries(idx){var chartCtx=this.mChartContextPtr,gmCtx=chartCtx.GetGraphMatrixContext(),shape,markerType=gmCtx.mMarkerShape;if(chartCtx.mIsGraphMatrix){if(chartCtx.isCombinationChart()){var dataset=this.mDatasetPtr;idx=this.mSeriesInfo[idx].mSeriesId;shape=dataset.GetShapeBySeries(idx);return shape;}switch(markerType){case $MS.DssGraphMarkerShapeCircle:return $SHP._CIRCLE;case $MS.DssGraphMarkerShapeRectangle:case $MS.DssGraphMarkerShapeSquare:return $SHP._SQUARE;case $MS.DssGraphMarkerShape2DPie:case $MS.DssGraphMarkerShape2DRingPie:return $SHP._PIE;case $MS.DssGraphMarkerShapeGMTick:return $SHP._TICKER;default:return $SHP._LINE;}}else{return 0;}}function hGetLineObject(infoIndex,groupId,linePointSet){var chartCtx=this.mChartContextPtr,tripleId,lineObj,isGraphMatrix=chartCtx.mIsGraphMatrix,result={Obj:null,AlreadyInMapAndList:false};if(isGraphMatrix){var shape=hGetShapeBySeries.call(this,infoIndex);result.shape=shape;if(linePointSet[groupId].length===1){if(this.mDatasetPtr.ShouldTakeGroupCenter()&&chartCtx.isCombinationChart()){if(result.shape===$SHP._LINE){result.shape=$SHP._CIRCLE;}}return hRenderSinglePoints.call(this,result,infoIndex,linePointSet,groupId);}switch(shape){case $SHP._CIRCLE:case $SHP._SQUARE:case $SHP._PIE:case $SHP._TICKER:case $SHP._COMBINED:return hRenderSinglePoints.call(this,result,infoIndex,linePointSet,groupId);default:return hRenderLineShape.call(this,infoIndex,groupId,linePointSet);}}tripleId=new $C.TripleId({ObjectId:$GO.DssGraphDataLine,SeriesId:this.mSeriesInfo[infoIndex].mSeriesId,GroupId:groupId});lineObj=new $C.PolyLineObject({TripleId:tripleId,GraphObjectManager:this,PolyLine:linePointSet[groupId],GraphCollectionObject:this.mLineCollections[infoIndex]});result.Obj=lineObj;return result;}function hGetCorrectLineObjectGroupIdInSeriesPoints(seriesIndex,groupId){var discreteMatrix=this.discreteMatrix,count=0,i,len,discretePoints;if(discreteMatrix&&discreteMatrix[seriesIndex]){discretePoints=discreteMatrix[seriesIndex];len=discretePoints.length;for(i=0;i<len;i++){if(groupId>=count&&groupId<discretePoints[i]){return i;}count=discretePoints[i];}}var linePointSet=[],numberOfPoints;count=0;this.GetLinePointSet(seriesIndex,linePointSet);numberOfPoints=linePointSet.length;for(i=0;i<numberOfPoints;++i){if(groupId>=count&&groupId<count+linePointSet[i].length){return groupId;}count+=linePointSet[i].length;}return groupId;}function hGetAccompanyPoints(isVertical,basePoint,offset){var result,highPoint=new $C.Point2D(),lowPoint=new $C.Point2D();highPoint.x=basePoint.x;highPoint.y=basePoint.y;lowPoint.x=basePoint.x;lowPoint.y=basePoint.y;result={HighPoint:highPoint,LowPoint:lowPoint};if(isVertical){lowPoint.y-=offset;highPoint.y+=offset;}else{lowPoint.x-=offset;highPoint.y+=offset;}return result;}function hGetAccompanyPointsRatio(basePoint,maxSize,sizeRatio){var gmCtx=this.mChartContextPtr.GetGraphMatrixContext(),baseOffset=gmCtx.GetScaledSizeWithRatio(sizeRatio,maxSize)/2;return hGetAccompanyPoints.call(this,this.mIsVertical,basePoint,baseOffset);}function hGetDataLabelCenterOffset(seriesIndex,groupIndex){var basePoint=new $C.Point2D(),depthValue,strokeOnly=true,gmCtx=this.mChartContextPtr.GetGraphMatrixContext(),minEleSizeMode=gmCtx.mElementsInfo.Min.Mode,tripleId,line,formatLine,offset=0,pointPair,ratio=1,value,groupId,retVal={};this.GetLinePoint(seriesIndex,groupIndex,basePoint);depthValue=gmCtx.GetMaxElementSizeInLineChart(this.mIsVertical,this.mGroupCount);if(gmCtx.mHasSizeBy){strokeOnly=false;if(gmCtx.mMaxSizeVal===gmCtx.mMinSizeVal){depthValue=Math.max(gmCtx.mElementsInfo.Max.Size,gmCtx.mConstants.MinimalSize.Line);strokeOnly=true;}}if(strokeOnly){groupId=hGetCorrectLineObjectGroupIdInSeriesPoints.call(this,seriesIndex,groupIndex);tripleId=new $C.TripleId({ObjectId:$GO.DssGraphDataLine,SeriesId:this.mSeriesInfo[seriesIndex].mSeriesId,GroupId:groupId});line=this.GetGraphObject(tripleId);if(line!==undefined&&line!==null){formatLine=line.mFormatLinePtr;depthValue=formatLine.mLineThickness;offset=depthValue/2;}pointPair=hGetAccompanyPoints.call(this,this.mIsVertical,basePoint,offset);}else{value=this.mDatasetPtr.GetData(this.mSeriesInfo[seriesIndex].mSeriesId,groupIndex,gmCtx.mSizeIndex,false);if(value!==null&&value!==undefined){ratio=gmCtx.ToRatioEx(value,(minEleSizeMode===$GMESM._PROPORTIONAL));if(ratio<0){ratio=0;}}pointPair=hGetAccompanyPointsRatio.call(this,basePoint,depthValue,ratio);}retVal.XCenterOffset=(pointPair.HighPoint.x-pointPair.LowPoint.x)/2;retVal.YCenterOffset=(pointPair.HighPoint.y-pointPair.LowPoint.y)/2;return retVal;}function hCalculateDataLabelBasePointAndOffset(dataLabel){var tripleId=new $C.TripleId({ObjectId:$GO.DssGraphRiser,SeriesId:dataLabel.SeriesId,GroupId:dataLabel.GroupId}),chartCtx=this.mChartContextPtr,gmCtx=chartCtx.GetGraphMatrixContext(),isIsolateDot=gmCtx.IsIsolatedDot(tripleId),dotShapeInLineChart,basePoint=new $C.Point2D(),dataLabelXCenterOffset=0,dataLabelYCenterOffset=0,marker,tempVal,dataset=this.mDatasetPtr,shape;if(this.GetLinePoint(dataLabel.SeriesInfo,dataLabel.GroupId,basePoint)){if(gmCtx.mMarkerShape===$MS.DssGraphMarkerShapeCombined){shape=dataset.GetShapeBySeries(dataLabel.SeriesId);dotShapeInLineChart=(shape===$SHP._CIRCLE||shape===$SHP._RECTANGLE||shape===$SHP._TICKER||shape===$SHP._SQUARE);}else{dotShapeInLineChart=(gmCtx.mMarkerShape===$MS.DssGraphMarkerShapeCircle||gmCtx.mMarkerShape===$MS.DssGraphMarkerShapeRectangle||gmCtx.mMarkerShape===$MS.DssGraphMarkerShapeGMTick||gmCtx.mMarkerShape===$MS.DssGraphMarkerShapeSquare);}if(isIsolateDot||dotShapeInLineChart){marker=this.GetGraphObject(tripleId);if(marker!==null&&marker!==undefined){if(marker.mMarkerSize!==undefined&&marker.mMarkerSize!==null&&marker.MarkerPosition!==undefined&&marker.MarkerPosition!==null){dataLabelXCenterOffset=marker.mMarkerSize;dataLabelYCenterOffset=dataLabelXCenterOffset;basePoint.x=marker.MarkerPosition.x;basePoint.y=marker.MarkerPosition.y;}else{if(marker instanceof mstrmojo.chart.RectangleObject&&marker.mRect!==undefined&&marker.mRect!==null){dataLabelXCenterOffset=marker.mRect.width/2;dataLabelYCenterOffset=marker.mRect.height/2;basePoint.x=marker.mRect.x+dataLabelXCenterOffset;basePoint.y=marker.mRect.y+dataLabelYCenterOffset;}else{if(marker instanceof mstrmojo.chart.StraightLineObject){basePoint.x=0.5*(marker.mDeviceStartPoint.x+marker.mDeviceEndPoint.x);basePoint.y=0.5*(marker.mDeviceStartPoint.y+marker.mDeviceEndPoint.y);}}}}}else{tempVal=hGetDataLabelCenterOffset.call(this,dataLabel.SeriesInfo,dataLabel.GroupId);if(tempVal!==null&&tempVal!==undefined){dataLabelXCenterOffset=tempVal.XCenterOffset;}dataLabelYCenterOffset=tempVal.YCenterOffset;}dataLabel.HostMarkerPoint=basePoint;dataLabel.CenterXOffset=dataLabelXCenterOffset;dataLabel.CenterYOffset=dataLabelYCenterOffset;return true;}return false;}function hPrepareDataLabelPositions(){var i,dataLabels=this.mDataLabels,len=dataLabels.length;for(i=0;i<len;++i){dataLabels[i].isValid=hCalculateDataLabelBasePointAndOffset.call(this,dataLabels[i]);}}function hInitDataLabelManager(){var dataLabelManager=this.mpABLPlot.dataLabelManager,chartCtx=this.mChartContextPtr,chartFrame=new $C.Rect2D({x:0,y:0,width:chartCtx.mGraphWidth,height:chartCtx.mGraphHeight});if(dataLabelManager===null||dataLabelManager===undefined){dataLabelManager=this.mpABLPlot.dataLabelManager=new $C.DataLabelManager({DataArea:chartFrame});dataLabelManager.ChartContext=chartCtx;}dataLabelManager.SinglePointObjects=dataLabelManager.SinglePointObjects.concat(this.mSinglePointObjects);dataLabelManager.PolyLineObjects=dataLabelManager.PolyLineObjects.concat(this.mPolyLineObjects);dataLabelManager.PolygonObjects=dataLabelManager.PolygonObjects.concat(this.mPolygonObjects);dataLabelManager.seriesOptions=this.mpABLPlotContext.mSeriesOptions;return dataLabelManager;}function hCreateDataMarkerForDataLabels(){var dataLabelNum=this.mDataLabels.length,groupId,dataLabel,i;for(i=0;i<dataLabelNum;++i){dataLabel=this.mDataLabels[i];if(dataLabel.display){groupId=dataLabel.GroupId;this.CreateOneDataMarker(dataLabel.SeriesInfo,dataLabel.GroupId,this.mMarkerCollections[dataLabel.SeriesInfo],dataLabel.HostMarkerPoint,groupId,true);}}}function hCreateGMSeriesDataLabels(shownDataLabels){var chartCtx=this.mChartContextPtr,dataset=this.mDatasetPtr,gmCtx=chartCtx.GetGraphMatrixContext(),isPieChart,isDataLabelForGMEnabled,ablPlot=this.mpABLPlot;if(chartCtx.mIsGraphMatrix){isDataLabelForGMEnabled=dataset.showDatalabels();isPieChart=(gmCtx.mMarkerShape===$MS.DssGraphMarkerShape2DPie||gmCtx.mMarkerShape===$MS.DssGraphMarkerShape2DRingPie);}if(isDataLabelForGMEnabled){var dataLabelManager=ablPlot.dataLabelManager;if(dataLabelManager===null||dataLabelManager===undefined){var chartFrame=new $C.Rect2D({x:0,y:0,width:chartCtx.mGraphWidth,height:chartCtx.mGraphHeight});dataLabelManager=ablPlot.dataLabelManager=new $C.DataLabelManager({DataArea:chartFrame});dataLabelManager.ChartContext=chartCtx;}if(isPieChart){var pieRenderer=this.mPieRenderer;pieRenderer.enableDataLabel(this.mpABLPlot.dataLabelManager,shownDataLabels);var i,labelList=pieRenderer.dataLabels,dataLabel,size=labelList.length;for(i=0;i<size;++i){dataLabel=labelList[i].Label;if(dataLabel.mIsShown){this.AddToMapAndList(dataLabel);}}}else{this.CreateAllDataLabels();hPrepareDataLabelPositions.call(this);dataLabelManager=hInitDataLabelManager.call(this);dataLabelManager.PlaceDataLabels(this.mDataLabels,shownDataLabels);hCreateDataMarkerForDataLabels.call(this);}}}mstrmojo.chart.LineSeriesRenderer=mstrmojo.declare(mstrmojo.chart.SeriesRenderer,null,{scriptClass:"mstrmojo.chart.LineSeriesRenderer",mLineCollections:null,mMarkerCollections:null,mVecSeriesPoints:null,mLineSeriesOptions:null,mDepth:0,mInitialized:false,mIsByValueAxis:false,mGroupIdMapPerSeries:null,mVecGroupIdMapPerSeries:null,mHasCreatedMarkers:false,mDataLabels:null,mSinglePointObjects:null,mPolyLineObjects:null,mPolygonObjects:null,init:function init(props){this._super(props);this.mDepth=this.mpABLPlot.unitLevelDepth;this.mLineCollections=[];this.mMarkerCollections=[];this.mVecSeriesPoints=[];this.mLineSeriesOptions=[];this.mGroupIdMapPerSeries=[];this.mVecGroupIdMapPerSeries=[];this.mSupportDiscretePoints=this.mChartContextPtr.mIsGraphMatrix;this.mDataLabels=[];this.mSinglePointObjects=[];this.mPolyLineObjects=[];this.mPolygonObjects=[];},GenerateMapAndList:function GenerateMapAndList(shownDataLabels){var chartCtx=this.mChartContextPtr,i,graphObjectAggregation,tripleId=mstrmojo.chart.RenderLayer2,seriesInfos=this.mSeriesInfo,lineSeriesOptions=this.mLineSeriesOptions;if(seriesInfos.length===0){return ;}for(i=0;i<seriesInfos.length;++i){lineSeriesOptions.push(newLineSeriesOptions());if(chartCtx.mIsGraphMatrix){lineSeriesOptions[this.mLineSeriesOptions.length-1].mShowMarkers=false;}this.loadSeriesProperties(i);}this.GenerateLineCollections();this.GenerateMarkerCollections();graphObjectAggregation=new $C.GraphObjectAggregation({TripleId:tripleId,GraphObjectManager:this});this.mGraphObjectList.push(graphObjectAggregation);this.GenerateInterpolationFrame(1);if(chartCtx.mUseAnimation){this.GenerateInterpolationFrame(0);}if(chartCtx.mImageUsage===$IMG_USAGE.GENERAL){this.CreateAllSeriesLabels(shownDataLabels);this.GenerateTrendLine();this.GenerateRefLine();this.populateRenderSequence();}},GenerateByValueAxis:function GenerateByValueAxis(valueAxis,graphObjectList){var seriesInfo=this.mSeriesInfo,i;if(seriesInfo.length===0){return ;}if(!this.mInitialized){for(i=0;i<seriesInfo.length;++i){this.mLineSeriesOptions.push(newLineSeriesOptions());this.loadSeriesProperties(i);}this.GenerateLineCollections();this.GenerateMarkerCollections();this.mInitialized=true;this.mIsByValueAxis=true;}this.mGraphObjectList.push(new $C.GraphObjectAggregation({TripleId:new $C.TripleId({ObjectId:$EGO.DssGraphRendererLayer,SeriesId:valueAxis,GroupId:$NULL_GROUP_ID}),GraphObjectManager:this}));this.GenerateInterpolationFrame(1);if(this.mChartContextPtr.mUseAnimation){this.GenerateInterpolationFrame(0);}if(valueAxis===$VA.VA_Y1){this.CreateAllSeriesLabels();}},loadSeriesProperties:function loadSeriesProperties(infoIndex){if(this.mChartContextPtr.mImageUsage!==0){return ;}},LoadStepLine:function LoadStepLine(infoIndex){this.mLineSeriesOptions[infoIndex].mShowStepLine=false;},GenerateMapAndListForSeries:function GenerateMapAndListForSeries(infoIndex){var chartCtx=this.mChartContextPtr,linePointSet=[],isLastFrame,i,lineId,lineObject,alreadyInMapAndList,returnVal,len;if(this.mGroupCount<2&&this.mSupportDiscretePoints){hDrawStandAlonePoint.call(this,infoIndex);return ;}hGetGroupIdMapAtSeries.call(this,infoIndex);this.GetLinePointSet(infoIndex,linePointSet);isLastFrame=hIsLastFrame.call(this);if(!this.mpABLPlotContext.mABLOptions.mUseDepth){var myGraphObjectList=this.mGraphObjectList,lineCollections=this.mLineCollections;if(linePointSet&&linePointSet.length){if(this.mpABLPlotContext.mABLOptions.mCurvedLines){len=linePointSet.length;for(i=0;i<len;++i){lineId=new $C.TripleId({ObjectId:$GO.DssGraphDataLine,SeriesId:this.mSeriesInfo[infoIndex].mSeriesId,GroupId:i});lineObject=null;if(lineObject){myGraphObjectList.push(lineObject);}if(isLastFrame){this.mGraphObjectMap.push(lineId,lineObject);lineCollections[infoIndex].AddGraphObject(lineObject);}}}else{len=linePointSet.length;for(i=0;i<len;++i){if(chartCtx.mIsGraphMatrix){this.mGroupIdMapPerSeries=this.mVecGroupIdMapPerSeries[i];}else{this.mGroupIdMapPerSeries.splice(0,this.mGroupIdMapPerSeries.length);}alreadyInMapAndList=false;returnVal=hGetLineObject.call(this,infoIndex,i,linePointSet);lineObject=returnVal.Obj;alreadyInMapAndList=returnVal.AlreadyInMapAndList;if(chartCtx.mIsTimeSeriesChart){lineObject.mIsDetectable=false;}if(!alreadyInMapAndList&&lineObject){myGraphObjectList.push(lineObject);if(isLastFrame){this.AddToMap(lineObject);lineCollections[infoIndex].AddGraphObject(lineObject);}}}}}}},GenerateByValueAxisAndGroup:function GenerateByValueAxisAndGroup(valueAxisIndex,groupId){var i,isReverseOrder,lineList=[],lineIndex=[],flag=[],index,startPoint,endPoint,sideDirection,len;if(this.mGroupCount<2){return ;}if((groupId===-1)||this.mHasNegativeValue){this.GenerateOrderedDepthLine(valueAxisIndex,groupId,false);}else{isReverseOrder=this.IsReverseSeriesOrder(valueAxisIndex);len=this.mSeriesInfo.length;for(i=0;i<len;++i){index=isReverseOrder?this.mSeriesInfo.length-i:i;if(this.mSeriesInfo[index].mValueAxis===valueAxisIndex){startPoint=new $C.Point2D();endPoint=new $C.Point2D();if(this.GetLinePoint(index,groupId-1,startPoint)&&this.GetLinePoint(index,groupId,endPoint)){lineList.push([startPoint,endPoint]);lineIndex.push(index);flag.push(true);}}}len=lineList.length;for(i=0;i+1<len;++i){sideDirection=new $C.Vector2D({x:lineList[i+1][0],y:lineList[i+1][1]});if(this.PriorToNextSeries(sideDirection,groupId)){this.GenerateDepthLine(lineIndex[i],groupId,lineList[i]);flag[i]=false;}}for(i=lineList.length-1;i>=0;--i){if(flag[i]){this.GenerateDepthLine(lineIndex[i],groupId,lineList[i]);}}}},GetLinePointSet:function GetLinePointSet(infoIndex,pointSet){var points=[],minNum=this.mSupportDiscretePoints?0:1,i,temp,point,groupCount=this.mGroupCount;for(i=0;i<groupCount;++i){point=new $C.Point2D();if(this.GetLinePoint(infoIndex,i,point)){points.push(point);}else{if(points.length>minNum){temp=points.slice(0);pointSet.push(temp);}points.length=0;}}if(points.length>minNum){pointSet.push(points);}},GetLinePoint:function GetLinePoint(infoIndex,groupIndex,linePoint){var chartCtx=this.mChartContextPtr,offsetX=0,offsetY=0,oldObjectManager,oldChartManager,oldPoint,isOldPointValid=false,oldRenderer,groupPosition,baseY,returnVal;if(!this.GetFinalLinePoint(infoIndex,groupIndex,linePoint,false)){return false;}if(this.mProgress===1){return true;}if(this.mUseDepth){returnVal=this.mpABLPlot.GetDepthOffset(this.mSeriesInfo[infoIndex].mSeriesIndex);offsetX=returnVal.OffsetX;offsetY=returnVal.OffsetY;}if(chartCtx.mOldChartManager!==null){oldChartManager=chartCtx.mOldChartManager;oldObjectManager=oldChartManager.GetGraphObjectManager(this.mTripleId,true);}oldPoint=new $C.Point2D({Point2D:linePoint});if(oldObjectManager!==null){oldRenderer=oldObjectManager;isOldPointValid=oldRenderer.GetFinalLinePoint(infoIndex,groupIndex,oldPoint,true);if(!isOldPointValid){groupPosition=oldRenderer.mpABLPlotContext.mCategoryAxisPtr.getGroupMiddlePos(groupIndex);if(this.mpABLPlotContext.mABLOptions.mOrientation===$OR.OR_HORIZONTAL){if(this.mDeviceDataArea){if(groupPosition>this.mDeviceDataArea.y+this.mDeviceDataArea.height){groupPosition=this.mDeviceDataArea.y+this.mDeviceDataArea.height;}if(groupPosition<this.mDeviceDataArea.y){groupPosition=this.mDeviceDataArea.y;}oldPoint.y=groupPosition+offsetY;}}else{if(this.mDeviceDataArea){if(groupPosition>this.mDeviceDataArea.x+this.mDeviceDataArea.width){groupPosition=this.mDeviceDataArea.x+this.mDeviceDataArea.width;}if(groupPosition<this.mDeviceDataArea.x){groupPosition=this.mDeviceDataArea.x;}oldPoint.x=groupPosition+offsetX;}}}}if(!isOldPointValid){baseY=this.mpABLPlotContext.mValueAxis[this.mSeriesInfo[infoIndex].mValueAxis].GetBasePosition();if(this.mpABLPlotContext.mABLOptions.mOrientation===$OR.OR_HORIZONTAL){oldPoint.x=baseY+offsetX;}else{oldPoint.y=baseY+offsetY;}}linePoint.x=oldPoint.x+(linePoint.x-oldPoint.x)*this.mProgress;linePoint.y=oldPoint.y+(linePoint.y-oldPoint.y)*this.mProgress;return true;},GetFinalLinePoint:function GetFinalLinePoint(infoIndex,groupIndex,linePoint,isOldRenderer){var seriesPoints,vecSeriesPoints=this.mVecSeriesPoints,ablPlotCtx=this.mpABLPlotContext,ablPlot=this.mpABLPlot,offsetX=0,offsetY=0,data,xMiddle,y,returnVal;if(isOldRenderer&&(infoIndex>=vecSeriesPoints.length||groupIndex>=vecSeriesPoints[infoIndex].length)){return false;}while(vecSeriesPoints.length<=infoIndex){seriesPoints=[];vecSeriesPoints.push(seriesPoints);}while(vecSeriesPoints[infoIndex].length<=groupIndex){vecSeriesPoints[infoIndex].push(primordialPoint);}var thisPoint=vecSeriesPoints[infoIndex][groupIndex];if(thisPoint.x!==-2&&!!thisPoint.dangling===false){if(thisPoint.x===-1&&thisPoint.isNull){return false;}linePoint.ResetPoint(thisPoint);return true;}if(isOldRenderer){return false;}vecSeriesPoints[infoIndex][groupIndex]=kNullPoint;if(this.mUseDepth){returnVal=this.mpABLPlot.GetDepthOffset(this.mSeriesInfo[infoIndex].mSeriesIndex);offsetX=returnVal.OffsetX;offsetY=returnVal.OffsetY;}data=this.GetData(infoIndex,groupIndex);if(data===null){return false;}perfCheckedTripleId.mSeriesId=this.mSeriesInfo[infoIndex].mSeriesId;perfCheckedTripleId.mGroupId=groupIndex;if(this.mDatasetPtr.GetShapeBySeries(perfCheckedTripleId.mSeriesId)===$SHP._LINE){if(this.mChartContextPtr.checkColorByAndSizeByValue(perfCheckedTripleId,this.mDatasetPtr,this.mHasColorBy,this.mHasSizeBy)===false){return false;}}xMiddle=Math.floor(ablPlotCtx.mCategoryAxisPtr.getGroupMiddlePos(groupIndex));y=ablPlotCtx.mValueAxis[this.mSeriesInfo[infoIndex].mValueAxis].GetPositionByValue(data);if(y===null){return false;}if(ablPlotCtx.mABLOptions.mOrientation===$OR.OR_HORIZONTAL){linePoint.x=y+offsetX;linePoint.y=xMiddle+offsetY;}else{linePoint.x=xMiddle+offsetX;linePoint.y=y+offsetY;}vecSeriesPoints[infoIndex][groupIndex]=new $C.Point2D({Point2D:linePoint});++ablPlot.DPCount;if(ablPlot.seriesDPCount[this.mSeriesInfo[infoIndex].mSeriesId]===undefined||ablPlot.seriesDPCount[this.mSeriesInfo[infoIndex].mSeriesId]===null){ablPlot.seriesDPCount[this.mSeriesInfo[infoIndex].mSeriesId]=1;}else{++(ablPlot.seriesDPCount[this.mSeriesInfo[infoIndex].mSeriesId]);}return true;},GenerateDepthLine:function GenerateDepthLine(infoIndex,groupId,linePair){},GenerateLineCollections:function GenerateLineCollections(){var chartCtx=this.mChartContextPtr,i,ctType,objectId,collectionCount,tripleId,seriesId,collection,gmCtx=chartCtx.GetGraphMatrixContext(),isGraphMatrix=chartCtx.mIsGraphMatrix;ctType=this.mUseDepth?$CT.CT_DEPTH_LINE_OR_LINE_MARKER:$CT.CT_LINE;objectId=this.mUseDepth?$GO.DssGraphRiser:$GO.DssGraphDataLine;collectionCount=this.mSeriesInfo.length;if(isGraphMatrix){if(chartCtx.isLegendByGroup()){collectionCount=this.mGroupCount;}ctType=$CT.CT_LINE;}for(i=0;i<collectionCount;++i){seriesId=this.mSeriesInfo[i].mSeriesId;tripleId=new $C.TripleId({ObjectId:objectId,SeriesId:seriesId});if(gmCtx.isCombinationChart()===false&&gmCtx.isPieOrRingShape()){collection=null;}else{collection=new $C.GraphCollectionObject({TripleId:tripleId,GraphObjectManager:this,CollectionType:ctType});}this.mLineCollections.push(collection);if(this.mpABLPlotContext.mABLOptions.mMajorGraphType!==$MAJOR_GRAPH_TYPE.MGT_PARETO||this.mUseDepth){if(!isGraphMatrix){this.AddLegendMarkerToCollection(i,this.mLineCollections[i],true,this.mLineSeriesOptions[i].mShowMarkers,this.mLineSeriesOptions[i].mMarkerShape,this.mpABLPlotContext.mABLOptions.mShowLines);}}}},GenerateMarkerCollections:function GenerateMarkerCollections(){var len,i,lineSeriesOptions=this.mLineSeriesOptions,graphObjectMap=this.mGraphObjectMap,markerCollections=this.mMarkerCollections,collectionId,collection;len=this.mSeriesInfo.length;for(i=0;i<len;++i){if(lineSeriesOptions[i].mShowMarkers&&(!this.mUseDepth)){collectionId=new $C.TripleId({ObjectId:$GO.DssGraphRiser,SeriesId:this.mSeriesInfo[i].mSeriesId});collection=new $C.GraphCollectionObject({TripleId:collectionId,GraphObjectManager:this,CollectionType:$CT.CT_DEPTH_LINE_OR_LINE_MARKER});graphObjectMap.push(collectionId,collection);markerCollections.push(collection);}else{markerCollections.push(null);}}},CreateSeriesMarkers:function CreateSeriesMarkers(infoIndex){var i,point,groupCount;groupCount=this.mGroupCount;for(i=0;i<groupCount;++i){point=new $C.Point2D();if(this.GetLinePoint(infoIndex,i,point)){this.CreateMarker(infoIndex,i,this.mMarkerCollections[infoIndex],point);}}},CreateAllSeriesLabels:function CreateAllSeriesLabels(shownDataLabels){var textCollectionId,textCollection,i,j,textObject,minPoint,maxPoint,textObjectY1,textObjectY2,upMostIndex,len,ablCtx=this.mpABLPlotContext,ablOptions=ablCtx.mABLOptions,seriesOptions=ablCtx.mSeriesOptions,groupCount=this.mGroupCount;if(this.mChartContextPtr.mIsGraphMatrix){hCreateGMSeriesDataLabels.call(this,shownDataLabels);return ;}len=this.mSeriesInfo.length;for(i=0;i<len;++i){if(seriesOptions[this.mSeriesInfo[i].mSeriesIndex].mShowDataLabels){textCollectionId=new $C.TripleId({ObjectId:$GO.DssGraphDataText,SeriesId:this.mSeriesInfo[i].mSeriesId});textCollection=new $C.GraphCollectionObject({TripleId:textCollectionId,GraphObjectManager:this,CollectionType:$CT.CT_TEXT});this.mTextCollection.push(textCollection);for(j=0;j<groupCount;++j){textObject=this.createRiserLabel(i,j,textCollection);if(textObject!==null){minPoint=new $C.Point2D();maxPoint=new $C.Point2D();this.GetMinMaxPoint(i,j,minPoint,maxPoint);this.MoveLabel(j,textObject,maxPoint,minPoint,i);}}}}if((ablOptions.mMajorGraphType===$MAJOR_GRAPH_TYPE.MGT_LINE)&&(ablOptions.mLayout===$LAYOUT.LO_STACKED)&&(!ablOptions.mShowCumulate)&&(ablOptions.mShowValue)&&(ablOptions.mShowTotal)){textCollectionId=new $C.TripleId({ObjectId:$GO.DssGraphDataTextStackTotal,SeriesId:this.mTripleId.mSeriesId});textCollection=new $C.GraphCollectionObject({TripleId:textCollectionId,GraphObjectManager:this,CollectionType:$CT.CT_TEXT});this.mTextCollection.push(textCollection);if(ablOptions.mDualAxes){for(i=0;i<groupCount;++i){textObjectY1=this.CreateTotalLabel($VA.VA_Y1,i,textCollection);textObjectY2=this.CreateTotalLabel($VA.VA_Y2,i,textCollection);if(textObjectY1!==null){minPoint=new $C.Point2D();maxPoint=new $C.Point2D();upMostIndex=this.GetUpmostIndexByValueAxisAndGroup($VA.VA_Y1,i);this.GetMinMaxPoint(upMostIndex,i,minPoint,maxPoint);this.MoveLabel(i,textObjectY1,maxPoint,minPoint,upMostIndex);}if(textObjectY2!==null){minPoint=new $C.Point2D();maxPoint=new $C.Point2D();upMostIndex=this.GetUpmostIndexByValueAxisAndGroup($VA.VA_Y2,i);this.GetMinMaxPoint(upMostIndex,i,minPoint,maxPoint);this.MoveLabel(i,textObjectY2,maxPoint,minPoint,upMostIndex);}}}else{for(i=0;i<groupCount;++i){textObject=this.CreateTotalLabel($VA.VA_Y1,i,textCollection);if(textObject!==null){minPoint=new $C.Point2D();maxPoint=new $C.Point2D();upMostIndex=this.GetUpmostIndexByValueAxisAndGroup($VA.VA_Y1,i);this.GetMinMaxPoint(upMostIndex,i,minPoint,maxPoint);this.MoveLabel(i,textObject,maxPoint,minPoint,upMostIndex);}}}}},CreateMarker:function CreateMarker(infoIndex,groupId,markerCollection,centerPoint){var chartCtx=this.mChartContextPtr,markerId,markerSize,markerObject;markerId=new $C.TripleId({ObjectId:$GO.DssGraphDataMarker,SeriesId:this.mSeriesInfo[infoIndex].mSeriesId,GroupId:groupId});if(chartCtx.mIsTimeSeriesChart){var ret1=this.GetData(infoIndex,groupId-1);var ret2=this.GetData(infoIndex,groupId+1);if((groupId>0&&ret1!==null)||(groupId<this.mGroupCount-1&&ret2!==null)){return ;}markerSize=4;markerObject=new $C.MarkerObject({TripleId:markerId,GraphObjectManager:this,MarkerPosition:centerPoint,MarkerShape:$MS.DssGraphMarkerShapeCircle,IsIsometric:true,MarkerSize:markerSize,GraphCollectionObject:markerCollection,IsDialogSize:false});markerCollection.AddGraphObject(markerObject);this.mGraphObjectList.push(markerObject);}else{if(chartCtx.mIsGraphMatrix){this.CreateOneDataMarker(infoIndex,groupId,markerCollection,centerPoint,groupId);}else{}}},GetMinMaxPoint:function GetMinMaxPoint(infoIndex,groupId,minPoint,maxPoint){var point,markerSize,isDescendingAxis;point=new $C.Point2D();if(!this.GetFinalLinePoint(infoIndex,groupId,point,false)){return ;}markerSize=this.mChartContextPtr.dialogSizeToPixelSize(this.mLineSeriesOptions[infoIndex].mMarkerSize);isDescendingAxis=this.mpABLPlotContext.mValueAxis[this.mSeriesInfo[infoIndex].mValueAxis].IsReverseOrder();if(this.mIsVertical){if(isDescendingAxis){minPoint.Reset(point.x,point.y-markerSize);maxPoint.Reset(point.x,point.y+markerSize);}else{minPoint.Reset(point.x,point.y+markerSize);maxPoint.Reset(point.x,point.y-markerSize);}}else{if(isDescendingAxis){minPoint.Reset(point.x+markerSize,point.y);maxPoint.Reset(point.x-markerSize,point.y);}else{minPoint.Reset(point.x-markerSize,point.y);maxPoint.Reset(point.x+markerSize,point.y);}}},GetPointPair:function GetPointPair(infoIndex,groupId,startPoint,endPoint){return this.GetLinePoint(infoIndex,groupId-1,startPoint)&&this.GetLinePoint(infoIndex,groupId,endPoint);},GenerateOrderedDepthLine:function GenerateOrderedDepthLine(valueAxisIndex,groupId,isStepLine){},GenerateInterpolationFrame:function GenerateInterpolationFrame(progress){var aggreCount,i,tempAggregation,graphObjectAggregation;this.mProgress=progress;aggreCount=this.mGraphObjectList.length;tempAggregation=this.mGraphObjectList.concat();this.mGraphObjectList.splice(0,aggreCount);for(i=0;i<aggreCount;++i){graphObjectAggregation=tempAggregation[i];if(this.mChartContextPtr.mUseAnimation&&!this.mUseDepth){graphObjectAggregation.SetAnimationEnable(true);}graphObjectAggregation.SetProgress(progress);this.GenerateFrameInOnePlot(graphObjectAggregation,progress<0.5);}this.mGraphObjectList=tempAggregation.concat();this._super(progress);},GenerateFrameInOnePlot:function GenerateFrameInOnePlot(graphObjectAggregation,forStartFrame){var chartCtx=this.mChartContextPtr,gmCtx=chartCtx.GetGraphMatrixContext(),ablCtx=this.mpABLPlotContext,ablOptions=ablCtx.mABLOptions,i,reverseGroupOrder,groupIndex,len,numOfObjects,groupCount=this.mGroupCount;if(this.mIsByValueAxis){var currentValueAxis=$VA.VA_BOTH;if(ablOptions.mLayout===$LAYOUT.LO_STACKED){if(ablOptions.mCurvedLines){this.GenerateByValueAxisAndGroup(currentValueAxis,-1);}else{reverseGroupOrder=this.IsReverseGroupOrder();for(i=1;i<this.mGroupCount;++i){groupIndex=reverseGroupOrder?groupCount-i:i;this.GenerateByValueAxisAndGroup(currentValueAxis,groupIndex);}}}else{var seriesInfo=this.mSeriesInfo,infoCount=this.mSeriesInfo.length;for(i=0;i<infoCount;++i){if(seriesInfo[i].mValueAxis===currentValueAxis){this.GenerateMapAndListForSeries(i);}}}}else{if(this.mpABLPlot.isAbsoluteOrCluster()||!this.mUseDepth){len=this.mSeriesInfo.length;for(i=0;i<len;++i){if(ablOptions.mShowLines){this.GenerateMapAndListForSeries(i);}if(!(chartCtx.mIsGraphMatrix&&gmCtx.isPieOrRingShape())){this.CreateSeriesMarkers(i);this.mHasCreatedMarkers=true;}}}else{if(ablOptions.mShowLines){if(ablOptions.mCurvedLines){this.GenerateByValueAxisAndGroup($VA.VA_Y2,-1);this.GenerateByValueAxisAndGroup($VA.VA_Y1,-1);}else{reverseGroupOrder=this.IsReverseGroupOrder();for(i=1;i<groupCount;++i){groupIndex=reverseGroupOrder?groupCount-i:i;this.GenerateByValueAxisAndGroup($VA.VA_Y2,groupIndex);}for(i=1;i<groupCount;++i){groupIndex=reverseGroupOrder?groupCount-i:i;this.GenerateByValueAxisAndGroup($VA.VA_Y1,groupIndex);}}}}}if(chartCtx.mIsGraphMatrix===false){if(!this.mHasCreatedMarkers){len=this.mSeriesInfo.length;for(i=0;i<len;++i){this.CreateSeriesMarkers(i);}}}numOfObjects=this.mGraphObjectList.length;for(i=0;i<numOfObjects;++i){graphObjectAggregation.AddGraphObject(this.mGraphObjectList[i],forStartFrame);}this.mGraphObjectList.splice(0,this.mGraphObjectList.length);}});}());
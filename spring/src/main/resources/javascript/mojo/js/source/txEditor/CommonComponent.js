(function(){mstrmojo.requiresCls("mstrmojo._CanValidate","mstrmojo.hash","mstrmojo.num","mstrmojo.date","mstrmojo.Container","mstrmojo.ValidationTextBox","mstrmojo.Table","mstrmojo.Label","mstrmojo.CheckBox","mstrmojo.DynamicClassFactory","mstrmojo.TristateCheckBox");mstrmojo.requiresDescs(2789,3575,5291,5292,5443,7658,7659,7660,8248,8249,8274,9274,9511,9894,9895,9896,9897);var _H=mstrmojo.hash,_V=mstrmojo.validation,_N=mstrmojo.num,_P=mstrmojo.date,_TR=_V.TRIGGER,STD_DATE_FORMAT="M/d/yyyy",STD_TIME_FORMAT="H:mm:ss";var _getVlsRBVis=function _getVlsRBVis(){var vls=mstrmojo.all.teModel.currentTxInput.ctl.pr.vls;this.set("checked",vls.length===this.value);return true;},_onVlsRBClick=function _onVlsRBClic(){var i,vls=[];for(i=0;i<this.value;i++){vls.push({n:i+1,v:i+1});}mstrmojo.all.teModel.currentTxInput.ctl.pr.vls=vls;};mstrmojo.txEditor.CommonComponent={CTRL_TYPES:{CTRL_TEXTFIELD:1,CTRL_SWITCH:2,CTRL_LIST:3,CTRL_SLIDER:4,CTRL_CALENDAR:5,CTRL_TIMEPICKER:6,CTRL_TOGGLE:7,CTRL_TEXTAREA:8,CTRL_SIG_CAPTURE:9,CTRL_RATING:10,CTRL_RANK:11,CTRL_STEPPER:12,CTRL_BARCODE:13,CTRL_LIKERTSCALE:14},CONTROL_NAMES:{1:mstrmojo.desc(3575),2:mstrmojo.desc(7660),3:mstrmojo.desc(5292),4:mstrmojo.desc(7658),5:mstrmojo.desc(5443),6:mstrmojo.desc(8249),7:mstrmojo.desc(8248),8:mstrmojo.desc(8274),9:mstrmojo.desc(9274),10:mstrmojo.desc(9894),11:mstrmojo.desc(2789),12:mstrmojo.desc(7659),13:mstrmojo.desc(9895),14:mstrmojo.desc(9896)},INPUT_VALUES:{INPUT_VALUES_CALCULATED:0,INPUT_VALUES_MANUAL:1,INPUT_VALUES_DATASET:2},CHANGE_TYPES:{CHANGE_TYPE_DEFAULT:1,CHANGE_TYPE_MARK_SELECTION:2},LIST_TYPES:{LIST_TYPE_PULLDOWN:0,LIST_TYPE_RADIOLIST:1},LIST_NAMES:{0:mstrmojo.desc(5291),1:mstrmojo.desc(9897)},RW_UNIT_TYPE:{RW_UNIT_FIELDGROUP:51,RW_UNIT_GRIDGRAPH:52},TAP_PANEL:{TNX_MAP:0,TNX_LOCL:1},STATEMENT_TYPE:{STATEMENT_UPDATE:0,STATEMENT_INSERT:1,STATEMENT_DELETE:2},CSI_KEYWORD_TYPE:{UPDATE:312,SET:313,INSERT:314,DELETE:315,WHERE:316,INTO:317,VALUES:318,FROM:319,FIELDUNIT:321},SAVING_PHASE:{MAPPING:1,LOCL:2,ALL:3},isStringType:function(dtp){return _V.isString(dtp);},isNumericType:function(dtp){return _V.isNumeric(dtp)||_V.isInt(dtp);},toLocaleUnits:function toLocaleUnits(v){return _N.convertToLocalUnits(v).replace(/0{1,}$/,"").replace(/\.$/,".0").replace(/,$/,",0");},toUSUnits:function toUSUnits(v){return _N.toString(_N.convertToUSUnits(v),true);},toUSDateString:function toUSDateString(v){if(v){var dt=_P.parseDateAndOrTime(v);if(dt){return(dt.date?_P.formatDateInfo(dt.date,STD_DATE_FORMAT):"")+(dt.date&&dt.time?" ":"")+(dt.time?_P.formatTimeInfo(dt.time,STD_TIME_FORMAT):"");}}return"";},toLocaleDateString:function toLocaleDateString(v){if(v){var dt=_P.parseDateAndOrTime(v,STD_DATE_FORMAT,STD_TIME_FORMAT);if(dt){return(dt.date?_P.formatDateInfo(dt.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT):"")+(dt.date&&dt.time?" ":"")+(dt.time?_P.formatTimeInfo(dt.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT):"");}}return"";},showError:function showError(msg){var curtain=mstrmojo.all.mstrTE.curtain;curtain.set("visible",true);mstrmojo.alert(msg,function(){curtain.set("visible",false);},null,1000,"mstrmojo-TransactionEditor-Alert");},setChildrenVisibility:function setChildrenVisibility(me,isVisible){var children=me.children,len=(children&&children.length)||0,child,i;for(i=0;i<len;i++){child=children[i];child.set("visible",(isVisible&&child.getVisibility)?child.getVisibility():isVisible);}},createPanel:function createPanel(ps){return _H.copy(ps,{scriptClass:"mstrmojo.txEditor.Container"});},getVis:function getVis(){var visibility=(!this._isVisible||this._isVisible())?true:false;if(visibility&&this._initValue){this._initValue();}return visibility;},onValChg:function onValChg(){var m=mstrmojo.all.teModel,cu=m&&m.currentTxInput;if(cu&&this.visible&&this.enabled){this.updateModel(this.isValid()?this.value:null);}else{if(this.inputNode){this.clearValidation();}}},createTextInput:function createTextInput(ps,n){var me=this;return _H.copy(ps,{scriptClass:"mstrmojo.ValidationTextBox",cssClass:"mstrmojo-TransactionEditor-TextBox",required:true,constraints:{trigger:_TR.ALL,max:ps.max,min:ps.min},onValid:me.onValChg,onInvalid:me.onValChg,getVisibility:me.getVis,_set_value:function(n,v){var vWas=this.value,bChanged=(vWas!==v);this.value=v;var t=this.constraints.trigger,cv=(t&_TR.VALUESET)>0;if(cv){this.validate(v);}return bChanged;},_initValue:function(){this.set("value",mstrmojo.all.teModel.currentTxInput.ctl.pr[n]);},updateModel:function(v){mstrmojo.all.teModel.currentTxInput.ctl.pr[n]=v;}});},createCheckBox:function createCheckBox(ps,n,cv){var v=cv||[true,false],me=this;return _H.copy(ps,{scriptClass:"mstrmojo.TristateCheckBox",cssClass:"tristate mstrmojo-TransactionEditor-CheckBox",grayed:false,getVisibility:me.getVis,_initValue:function(){var value=mstrmojo.all.teModel.currentTxInput.ctl.pr[n];this.set("checked",value===v[0]);},oncheckedChange:function(){mstrmojo.all.teModel.currentTxInput.ctl.pr[n]=this.checked?v[0]:v[1];}});},createRequiredCheckBox:function createRequiredCheckBox(ps){var me=this;return _H.copy(ps,{scriptClass:"mstrmojo.TristateCheckBox",cssClass:"tristate mstrmojo-TransactionEditor-CheckBox",text:mstrmojo.desc(9511),grayed:false,getVisibility:me.getVis,_initValue:function(){this.set("checked",mstrmojo.all.teModel.currentTxInput.req===1);},oncheckedChange:function(){mstrmojo.all.teModel.currentTxInput.req=this.checked?1:0;}});},createLabel:function createLabel(ps,n){return _H.copy(ps,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-TransactionEditor-Label",text:n});},createVlsRadioButton:function createVlsRadioButton(ps){var value=ps.value,len=(value&&value.length)||0,label=ps.label||"",group=ps.group||"RadioButton",children=[],cellArray=[],i;for(i=0;i<len;i++){children.push({scriptClass:"mstrmojo.CheckBox",value:value[i],type:"radio",label:value[i]+"-"+label,name:group,slot:"0,"+i,getVisibility:_getVlsRBVis,onclick:_onVlsRBClick});cellArray.push({});}return _H.copy(ps,{scriptClass:"mstrmojo.txEditor.Table",layout:[{cells:cellArray}],children:children});}};mstrmojo.txEditor.Table=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.txEditor.Table",postvisibleChange:function(){if(this._super){this._super();}mstrmojo.txEditor.CommonComponent.setChildrenVisibility(this,this.visible);}});mstrmojo.txEditor.Container=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.txEditor.Container",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',cssClass:"mstrmojo-TransactionEditor-Panel",markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";mstrmojo.txEditor.CommonComponent.setChildrenVisibility(this,this.visible);}}});}());
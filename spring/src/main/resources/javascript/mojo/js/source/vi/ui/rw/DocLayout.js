(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo.vi.ui._HasBoxLayout","mstrmojo.vi.ui._IsBoxLayoutChild","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.PageByPanel","mstrmojo.vi.ui.rw._SavesChildPositions","mstrmojo.vi.models.VIComponentMap");var $ENUM_VI_TYPES=mstrmojo.vi.models.VIComponentMap.TYPES,PAGE_BY_PANEL_HEIGHT="45",pageByAlias="pageByPanel",defaultSlot="containerNode";mstrmojo.vi.ui.rw.DocLayout=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo.vi.ui._HasBoxLayout,mstrmojo.vi.ui._IsBoxLayoutChild,mstrmojo.vi._MonitorsAppState,mstrmojo.vi.ui.rw._SavesChildPositions],{scriptClass:"mstrmojo.vi.ui.rw.DocLayout",markupString:'<div id="{@id}" class="mstrmojo-VIDocLayout"><div class="mstrmojo-VIDocLayout-content {@cssClass}" style="{@cssText}"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.lastChild;}},init:function init(props){this._super(props);var id=this.id;this.builder.getLayoutVIMap(this.k).attachEventListener("viCompBuilt",id,function(evt){if(evt.type===$ENUM_VI_TYPES.PAGEBY_STACK){this.pageByPanel.setPageByStack(evt.widget);}});},applyBoxSize:function applyBoxSize(height,width,top,left){this._super(height,width,top,left);if(!this.boxLayoutConfig){var boxCfg=this.boxLayoutConfig=new mstrmojo.vi.ui.BoxLayoutConfig({hostId:this.id,identifier:"id"});var rootBox=boxCfg.box=boxCfg.getNewRootBox(true),pageByPanel=this[pageByAlias],pageByStack=pageByPanel.pageByStack;if(pageByStack&&pageByStack.visible){boxCfg.addNewChild(rootBox,PAGE_BY_PANEL_HEIGHT,pageByPanel.id,true);}else{pageByPanel.visible=false;}boxCfg.addNewChild(rootBox,100,this.docSection.id);}this.buildBoxLayout();},alias:"docLayout",pageByPanel:null,docSection:null,dropZone:true,resizeOrReposition:mstrmojo.emptyFn,getIdentifier:function getIdentifier(){return"layout";},getSplitterHost:function getSplitterHost(){return this.containerNode;},children:[{scriptClass:"mstrmojo.vi.ui.PageByPanel",alias:pageByAlias,slot:defaultSlot,height:"30px",zIndex:2}],_set_children:function setCh(n,v,silent){if(v!==this.children){var component=this[pageByAlias];if(component){v.push(component);}}return this._super(n,v,silent);},getTargetDropZone:function getTargetDropZone(context){var boxPosition=context.boxCache[this.id];return context.tgt.pos.x-boxPosition.x<boxPosition.w/2?"Left":"Right";},getViPanel:function getViPanel(type){return(type==="pageByPanel")?this[pageByAlias]:null;},viPanelChangedVisibility:function viPanelChangedVisibility(panel){var boxCfg=this.boxLayoutConfig;if(panel.visible){boxCfg.addDropBox(this.docSection,"Top",{box:{boxId:String(panel.id),cfg:panel.getBoxConfiguration()}});}else{boxCfg.deleteBox(panel);}}});}());
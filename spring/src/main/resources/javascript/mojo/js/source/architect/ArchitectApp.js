(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.form","mstrmojo.Editor","mstrmojo.architect.ui.ArchitectPage","mstrmojo.architect.ArchitectModel","mstrmojo._IsWebApp","mstrmojo.architect.RootController");window.mstrApp=mstrApp;window.mstrConfig=mstrConfig;mstrmojo.architect.ArchitectApp=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsWebApp],{scriptClass:"mstrmojo.architect.ArchitectApp",enableWaitBox:true,start:function start(){var controller=this.rootController=new mstrmojo.architect.RootController();controller.model=new mstrmojo.architect.ArchitectModel();controller.rootView=new mstrmojo.architect.ui.ArchitectPage({placeholder:this.placeholder});controller.start();mstrmojo.dom.attachEvent(window,"beforeunload",controller.model.schemaInstanceHasChanged);mstrmojo.dom.attachEvent(window,"unload",controller.onCloseArchitect);},getRootController:function getRootController(){return this.rootController;},serverRequest:function serverRequest(callback,params,showWait){if(showWait){this.showWait();}if(this.sessionState){params.sessionState=this.sessionState;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,mstrmojo.func.wrapMethods(callback,{success:mstrmojo.emptyFn,complete:function complete(){mstrApp.hideWait();},failure:function failure(res){if(res.getResponseHeader("X-MSTR-TaskErrorCode")==="-2147080975"){mstrmojo.alert(res.getResponseHeader("X-MSTR-TaskFailureMsg"));}}}),params);},getSearchAutoCompleteDelay:mstrmojo.emptyFn,onerror:function onerror(ex){mstrmojo.alert(ex.message);},onSessionExpired:function onSessionExpired(){var app=mstrApp;mstrmojo.form.send({evt:5005,src:app.name+"."+app.pageName+".5005"});},isSingleTier:false,isArchitect:true});}());
(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.PopupList","mstrmojo.array","mstrmojo.css");var $CSS=mstrmojo.css,$ARR=mstrmojo.array;mstrmojo.ui.editors.controls.ListPreviewButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ListPreviewButton",init:function init(props){this._super(props);var list=this.getListCfg(),itemValueField=this.itemValueField;list.alias="list";list.locksHover=true;list.slot="widgetHostNode";list.listHooks={select:function select(el,item){this.parent.set("selectedValue",item[itemValueField]);this.close();}};list.setDimensions=mstrmojo.emptyFn;this.addChildren([list]);$CSS.addWidgetCssClass(this.list,"ctrl-popup-list");},getPopupWidget:function getPopupWidget(){return this.list;},items:null,onitemsChange:function onitemsChange(){var items=this.items;if(items){this.list.set("items",items);}},selectedValue:"",itemValueField:"n",onselectedValueChange:function onselectedValueChange(){var selectedValue=this.selectedValue,itemValueField=this.itemValueField,list=this.list;list.selectItems($ARR.filter(list.items||[],function(item){return item[itemValueField]===selectedValue;}),true);this.updatePreview();},updatePreview:function updatePreview(){throw new Error(this.scriptClass+" must implement updatePreview.");},getListCfg:function getListCfg(){return{scriptClass:"mstrmojo.ui.PopupList",selectionPolicy:"reselect"};},postBuildRendering:function postBuildRendering(){this.onitemsChange();this.onselectedValueChange();return this._super();}});}());
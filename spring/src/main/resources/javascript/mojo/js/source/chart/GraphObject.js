(function(){mstrmojo.requiresCls("mstrmojo.Base");mstrmojo.requiresClsP("mstrmojo.chart","TripleId","ChartContext","ImageMap");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumObjectShape","EnumCollectionType");var $C=mstrmojo.chart,$M=mstrmojo.chart.model,$CHART_ENUMS=$C.enums,$MODEL_ENUMS=$M.enums,$CT=$CHART_ENUMS.EnumCollectionType,$OBJ_SHAPE=$CHART_ENUMS.EnumObjectShape,$OBJ_SHAPE_RECT=$OBJ_SHAPE.OS_RECTANGLE,$GRAPH_OBJ=$MODEL_ENUMS.EnumDSSGraphObject,$NTID=$C.gNullTripleId,$NOID=$C.gNullObjectId,INT_MAX=2147483647;mstrmojo.chart.GraphObject=mstrmojo.declare(mstrmojo.Base,null,{scriptClass:"mstrmojo.chart.GraphObject",mpParentObject:null,mFormatLinePtr:null,mTripleId:$NTID,mChartContextPtr:null,mpManager:null,mIsDetectable:true,mIsAnimationEnabled:false,mIsVirtual:false,mShapeType:0,init:function init(props){this._super(props);this.mpParentObject=props.GraphCollectionObject||null;this.mTripleId=props.TripleId||$NTID;this.mpManager=props.GraphObjectManager||null;this.mChartContextPtr=this.mpManager?this.mpManager.mChartContextPtr:null;this.mIsDetectable=true;if(props.Shape){this.mShapeType=props.Shape;}if(props.hasLine&&this.mTripleId.mObjectId!==$NOID){this.mFormatLinePtr=(this.mpParentObject===null||this.mpParentObject===undefined)?this.mChartContextPtr.GetFormatLine(this.mTripleId,$CT.CT_NO_COLLECTION,this.mShapeType):this.mpParentObject.mFormatLinePtr;}this.mIsAnimationEnabled=false;},SetAnimationEnable:function SetAnimationEnable(isAnimationEnabled){this.mIsAnimationEnabled=isAnimationEnabled;this.SetProgress(0.1);},IsLayerObject:function IsLayerObject(){return false;},SetFormatLine:function SetFormatLine(formatLine){this.mFormatLinePtr=formatLine;},SetLineWidth:function SetLineWidth(){var lineWidth;lineWidth=this.mFormatLinePtr.mLineThickness;lineWidth=(lineWidth<1)?1:lineWidth;this.hSetLineWidth(lineWidth);},ApplyLineFormat:function ApplyLineFormat(){this.mFormatLinePtr.ApplyLineFormat(this.mChartContextPtr);},SetOutlineWidth:function SetOutlineWidth(){this.hSetLineWidth($C.gOutlineWhite.mLineThickness);},SetOutlineWidthEx:function SetOutlineWidthEx(width){if(width>0){this.hSetLineWidth(width);}},ApplyOutlineFormat:function ApplyOutlineFormat(){var chartCtx=this.mChartContextPtr;if(chartCtx.IsBackgroundBright()){$C.gStrokeForLightBackground.ApplyLineFormat(chartCtx);}else{$C.gStrokeForDarkBackground.ApplyLineFormat(chartCtx);}},MakePolygonClockwise:function MakePolygonClockwise(polygon){var numberOfEdges=polygon.length,leftTopIndex=0,i,tempIndex,vectorBA,vectorBC,point;if(numberOfEdges<3){return ;}for(i=1;i<numberOfEdges;++i){if(polygon[i].x<polygon[leftTopIndex].x||(polygon[i].x<=polygon[leftTopIndex].x&&polygon[i].y<polygon[leftTopIndex].y)){leftTopIndex=i;}}tempIndex=(leftTopIndex+numberOfEdges-1)%numberOfEdges;vectorBA=new $C.Vector2D({x:polygon[tempIndex].x-polygon[leftTopIndex].x,y:polygon[tempIndex].y-polygon[leftTopIndex].y});tempIndex=(leftTopIndex+1)%numberOfEdges;vectorBC=new $C.Vector2D({x:polygon[tempIndex].x-polygon[leftTopIndex].x,y:polygon[tempIndex].y-polygon[leftTopIndex].y});if(vectorBC.CrossProduct(vectorBA)<-$C.gModuleMain.mTolerance){for(i=0;i<Math.floor(numberOfEdges/2);++i){point=polygon[i];polygon[i]=polygon[numberOfEdges-i-1];polygon[numberOfEdges-i-1]=point;}}},DrawOutLine:function DrawOutLine(){this.SetOutlineWidth();this.mChartContextPtr.DrawPolygon(this.GetClockwisePolygon());this.ApplyOutlineFormat();},PointInObject:function PointInObject(point){if(!this.mIsDetectable){return false;}return point.IsInPolygon(this.GetClockwisePolygon());},hSetLineWidth:function hSetLineWidth(lineWidth){this.mChartContextPtr.SetLineWidth(lineWidth);this.mChartContextPtr.mIsLineWidthOdd=((lineWidth&1)===1);},GetChartAreaId:function GetChartAreaId(){var managerId=this.mpManager.mTripleId;switch(managerId.mObjectId){case $GRAPH_OBJ.DssGraphY1Body:case $GRAPH_OBJ.DssGraphY2Body:case $GRAPH_OBJ.DssGraphX2Body:case $GRAPH_OBJ.DssGraphO1Body:return this.mTripleId.mSeriesId;default:return this.mpManager.GetChartAreaId();}},GetBoundingRect:function GetBoundingRect(){var boundingRect=new $C.Rect2D();return boundingRect;},SetProgress:function SetProgress(progress){},DistanceToPoint:function DistanceToPoint(point){if(!this.mIsDetectable){return INT_MAX;}var boundingPolygon=this.GetClockwisePolygon();if(boundingPolygon.length<3){return INT_MAX;}return point.DistanceToPolygon(boundingPolygon);},GetAngularBisectorIntersectionPoint:function GetAngularBisectorIntersectionPoint(vectorA,vectorB,vectorC,depth,bisectorPoint){var lVectorBA={x:vectorA.x-vectorB.x,y:vectorA.y-vectorB.y};var lVectorBC={x:vectorC.x-vectorB.x,y:vectorC.y-vectorB.y};var lLengthBA=Math.sqrt(lVectorBA.x*lVectorBA.x+lVectorBA.y*lVectorBA.y);var lLengthBC=Math.sqrt(lVectorBC.x*lVectorBC.x+lVectorBC.y*lVectorBC.y);var lVectorUnitBA={x:lVectorBA.x/lLengthBA,y:lVectorBA.y/lLengthBA};var lVectorUnitBC={x:lVectorBC.x/lLengthBC,y:lVectorBC.y/lLengthBC};var lLength=0;if(Math.abs(lVectorUnitBA.x-lVectorUnitBC.x)<0.01){lLength=depth*(lVectorUnitBC.x+lVectorUnitBA.x)/(lVectorUnitBA.y-lVectorUnitBC.y);}else{lLength=depth*(lVectorUnitBC.y+lVectorUnitBA.y)/(lVectorUnitBC.x-lVectorUnitBA.x);}var oPointEnd={x:0,y:0};oPointEnd.x=vectorB.x+lLength*lVectorUnitBC.x;oPointEnd.y=vectorB.y+lLength*lVectorUnitBC.y;bisectorPoint.x=oPointEnd.x+depth*(-lVectorUnitBC.y);bisectorPoint.y=oPointEnd.y+depth*lVectorUnitBC.x;},getFormatFromParent:function getFormatFromParent(){this.mFormatLinePtr=this.mpParentObject.mFormatLinePtr;},getBoundingPoints:function getBoundingPoints(){var rect=this.GetBoundingRect(),vertexes=rect.ToPoints(false);return{Shape:0,Points:[vertexes.TopLeft,vertexes.TopRight,vertexes.BottomRight,vertexes.BottomLeft]};},getShapeSize:function getShapeSize(){return 0;},fallOut:function fallOut(entireOut){var fallOutValue=0,chartCtx=this.mChartContextPtr,vertex=this.getBoundingPoints(),points=vertex.Points,i,point;for(i=0;i<points.length;++i){point=points[i];if(point.x<0||point.y<0||point.x>chartCtx.mGraphWidth||point.y>chartCtx.mGraphHeight){fallOutValue++;}if(fallOutValue>0&&!entireOut){return true;}}return(fallOutValue===points.length);}});}());
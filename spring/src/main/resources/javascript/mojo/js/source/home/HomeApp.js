(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.css","mstrmojo.array","mstrmojo.dom","mstrmojo.locales","mstrmojo._IsWebApp","mstrmojo.home.controllers.HomeController");mstrmojo.requiresDescs();var DOM=mstrmojo.dom;function setupBackspaceHandler(){DOM.attachEvent(document,"keydown",function(e){var doPrevent=e.keyCode===8;e=e||window.event;if(doPrevent){var d=e.srcElement||e.target,tagName=d.tagName.toUpperCase(),inputType=tagName==="INPUT"&&d.type.toUpperCase();if(tagName==="TEXTAREA"||d.isContentEditable||(inputType==="TEXT"||inputType==="PASSWORD"||inputType==="NUMBER"||inputType==="FILE"||inputType==="EMAIL"||inputType==="SEARCH"||inputType==="DATE")){doPrevent=d.readOnly||d.disabled;}if(doPrevent){DOM.preventDefault(window,e);}}});}mstrmojo.home.HomeApp=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsWebApp],{scriptClass:"mstrmojo.home.HomeApp",pageName:"",homeCtrl:null,enableWaitBox:true,start:function start(){var homeCtrl=this.getController();this.addDisposable([homeCtrl]);homeCtrl.start({placeholder:this.placeholder,modelData:this.homeModelData});this.startSessionManager();setupBackspaceHandler();},getController:function getController(){this.homeCtrl=this.homeCtrl||new mstrmojo.home.controllers.HomeController();return this.homeCtrl;},onerror:function onerror(res,callback){if(!res||res.handledError){return ;}var msg=[],map={title:"",message:mstrmojo.desc(6828,"Error:")+" ",sourceURL:"Source URL: ",fileName:"File: ",lineNumber:"Line: ",line:"Line: "};mstrmojo.hash.forEach(map,function(v,n){if(res[n]!==undefined){msg.push(v+res[n]);if(n==="title"){msg.push("");}}});if(res.getResponseHeader){msg.push("XHR: "+res.getResponseHeader("X-MSTR-TaskFailureMsg"));}var message=msg.join("\n");if(message.length){mstrmojo.alert(message,callback);res.handledError=true;mstrmojo.dbg(res.stack||message);}},getWaitBoxPosition:function getWaitBoxPosition(){var view=this.homeCtrl.view;return{top:DOM.position(view.pathbarNode).h+2};},executeCommand:function executeCommand(cmdId,cmdValue){if(typeof this[cmdId]==="function"){this[cmdId](cmdValue);}else{this.homeCtrl.executeCommand(cmdId,cmdValue);}}});}());
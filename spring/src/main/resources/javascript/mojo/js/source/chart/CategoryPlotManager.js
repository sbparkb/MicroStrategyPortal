(function(){mstrmojo.requiresClsP("mstrmojo.chart","PlotManager","CategoryPlot","ABLPlot","Axis","CategoryAxis","ValueAxis","GraphObjectManager","TripleId");mstrmojo.requiresClsP("mstrmojo.chart.enums","EnumGraphMajorType","EnumDSSGraphObjectManager","EnumLayout","EnumOrientation","EnumValueAxis","EnumAxisLabelsLocation","EnumAxisDirection","EnumCollectionType");mstrmojo.requiresClsP("mstrmojo.chart.model.enums","EnumDSSGraphType","EnumDSSGraphProperty","EnumDSSExtraGraphProperty","EnumDSSGraphObject","EnumVariantBool");var $C=mstrmojo.chart,$CHART_ENUMS=$C.enums,$GMT=$CHART_ENUMS.EnumGraphMajorType,$GOM_DSSPLOT=$CHART_ENUMS.EnumDSSGraphObjectManager.DssPlot,$LAYOUT=$CHART_ENUMS.EnumLayout,$OR=$CHART_ENUMS.EnumOrientation,$VA=$CHART_ENUMS.EnumValueAxis,$AXIS_LABEL_LOC=$CHART_ENUMS.EnumAxisLabelsLocation,$AXIS_DIRECTION=$CHART_ENUMS.EnumAxisDirection,$NTID=$C.gNullTripleId,$M=mstrmojo.chart.model,$MODEL_ENUMS=$M.enums,$GT=$MODEL_ENUMS.EnumDSSGraphType,$GP=$MODEL_ENUMS.EnumDSSGraphProperty,$EGP=$MODEL_ENUMS.EnumDSSExtraGraphProperty,$GO=$MODEL_ENUMS.EnumDSSGraphObject,$VF=$MODEL_ENUMS.EnumVariantBool.VARIANT_FALSE;var perfTempRect1=new $C.Rect2D(),perfTempRect2=new $C.Rect2D(),perfInitDataArea=new $C.Rect2D(),perfCurrentDataArea=new $C.Rect2D(),perfTempDataArea=new $C.Rect2D(),perfDataAreaY2=new $C.Rect2D(),perfDataAreaY1=new $C.Rect2D();function layoutDatalabel(){var chartCtx=this.mChartContextPtr,dataset=this.mDatasetPtr,gmCtx=chartCtx.GetGraphMatrixContext(),isRotationInited=false,isNeedRotateDataLabel=false,value;if(chartCtx.mIsGraphMatrix&&this.mOrientation===$OR.OR_VERTICAL){var lABLPlot=this.mCategoryPlots[0];value=chartCtx.GetProperty($EGP.DssGraphMatrixInitedDataLabelRotation,$NTID);if(value){isRotationInited=value;}if(!isRotationInited){if(chartCtx.isCombinationChart()&&!dataset.onlyBarDataLabelEnabled()){chartCtx.PutGraphProperty($EGP.DssGraphMatrixInitedDataLabelRotation,$NTID,true);gmCtx.mIsNeedRotateDataLabel=false;chartCtx.PutGraphProperty($EGP.DSSGraphMatrixDataLabelRotated,$NTID,false);return ;}if(chartCtx.IsBarChart()||(chartCtx.isCombinationChart()&&dataset.onlyBarDataLabelEnabled())){isNeedRotateDataLabel=lABLPlot.ShouldRotateDataLabel();chartCtx.PutGraphProperty($EGP.DssGraphMatrixInitedDataLabelRotation,$NTID,true);gmCtx.mIsNeedRotateDataLabel=isNeedRotateDataLabel;chartCtx.PutGraphProperty($EGP.DSSGraphMatrixDataLabelRotated,$NTID,isNeedRotateDataLabel);}}}}function hReserverDataAreaWithAxis(plotArea,dataArea){var chartCtx=this.mChartContextPtr;if(chartCtx.mIsGraphMatrix){dataArea.Reset(plotArea.x,plotArea.y,plotArea.width,plotArea.height);return ;}var x,width,y,height,rect=new $C.Rect2D();hReserveAreaValueAxis.call(this,plotArea,rect);rect.width=Math.max(0,rect.width);rect.height=Math.max(0,rect.height);this.mLeftMargin+=rect.x-plotArea.x;this.mRightMargin+=plotArea.x+plotArea.width-(rect.x+rect.width);this.mTopMargin+=rect.y-plotArea.y;this.mBottomMargin+=plotArea.y+plotArea.height-(rect.y+rect.height);this.ReserveAreaCategoryAxis(rect,dataArea);if(dataArea.width<0){dataArea.width=0;}if(dataArea.height<0){dataArea.height=0;}if(this.mOrientation===$OR.OR_HORIZONTAL){x=plotArea.x+Math.max(rect.x-plotArea.x,dataArea.x-rect.x);width=plotArea.x+plotArea.width-Math.max(plotArea.x+plotArea.width-(rect.x+rect.width),rect.x+rect.width-(dataArea.x+dataArea.width))-x;dataArea.x=x;dataArea.width=width;}else{y=plotArea.y+Math.max(rect.y-plotArea.y,dataArea.y-rect.y);height=plotArea.y+plotArea.height-Math.max(plotArea.y+plotArea.height-(rect.y+rect.height),rect.y+rect.height-(dataArea.y+dataArea.height))-y;dataArea.y=y;dataArea.height=height;}}function hCreateCategoryPlot(chartAreaId){var chartCtx=this.mChartContextPtr,graphMajorType,tripleId;graphMajorType=chartCtx.GetGraphMajorType();if(chartCtx.mIsGraphMatrix){tripleId=$C.PlotId0;}else{tripleId=new $C.TripleId({ObjectId:$GOM_DSSPLOT,SeriesId:chartAreaId});}switch(graphMajorType){case $GMT.GMT_CATEGORY:return new $C.ABLPlot({TripleId:tripleId,GraphObjectManager:this,Area:$C.gEmptyRect});default:break;}return null;}function hReserveAreaValueAxis(dataArea,finalDataArea){var chartCtx=this.mChartContextPtr,rectVector=[],y1AxisCount=this.mVecY1Axis.length,i,lowMargin,highMargin,y1LowMargin,y2HighMargin,areaY1,areaY2,bottom,vecLength;for(i=0;i<y1AxisCount;++i){lowMargin=this.mOrientation===$OR.OR_VERTICAL?this.mBottomMargin:this.mLeftMargin;highMargin=this.mOrientation===$OR.OR_VERTICAL?this.mTopMargin:this.mRightMargin;y1LowMargin=lowMargin;if(chartCtx.mIsGraphMatrix){perfDataAreaY1.ResetRect(dataArea);perfDataAreaY2.ResetRect(dataArea);}else{perfDataAreaY2=new $C.Rect2D({Rect2D:dataArea});perfDataAreaY1=new $C.Rect2D({Rect2D:dataArea});}if(this.mDualAxes){y2HighMargin=highMargin;if(this.mSplitDualAxes){areaY1=new $C.Rect2D();areaY2=new $C.Rect2D();chartCtx.SplitRect(perfDataAreaY1,chartCtx.IsVertical(),this.mSplitAxisPosition,areaY1,areaY2);if(this.mOrientation===$OR.OR_VERTICAL){y2HighMargin+=areaY1.height;y1LowMargin+=areaY2.height;}else{y2HighMargin+=areaY1.width;y1LowMargin+=areaY2.width;}}this.mVecY2Axis[i].ReserveTitleAndLabels(perfDataAreaY2,lowMargin,y2HighMargin);if(!this.mSplitDualAxes){perfDataAreaY1.ResetRect(perfDataAreaY2);if(this.mOrientation===$OR.OR_VERTICAL){perfDataAreaY1.y=dataArea.y;perfDataAreaY1.height=dataArea.height;}else{perfDataAreaY1.x=dataArea.x;perfDataAreaY1.width=dataArea.width;}}if(this.mSplitDualAxes){if(this.mOrientation===$OR.OR_VERTICAL&&perfDataAreaY2.y>dataArea.y){bottom=perfDataAreaY2.y+perfDataAreaY2.height;perfDataAreaY2.y=dataArea.y+(perfDataAreaY2.y-dataArea.y)*100/this.mSplitAxisPosition;perfDataAreaY2.height=bottom-perfDataAreaY2.y;}if(this.mOrientation===$OR.OR_HORIZONTAL&&perfDataAreaY2.x+perfDataAreaY2.width<dataArea.x+dataArea.width){perfDataAreaY2.width=dataArea.width-(dataArea.x+dataArea.width-(perfDataAreaY2.x+perfDataAreaY2.width))*100/this.mSplitAxisPosition;}}}this.mVecY1Axis[i].ReserveTitleAndLabels(perfDataAreaY1,y1LowMargin,highMargin);if(this.mDualAxes&&this.mSplitDualAxes){if(this.mOrientation===$OR.OR_VERTICAL&&perfDataAreaY1.y+perfDataAreaY1.height<dataArea.y+dataArea.height){perfDataAreaY1.height=(dataArea.y+dataArea.height-(perfDataAreaY1.y+perfDataAreaY1.height))*100/this.mSplitAxisPosition;}if(this.mOrientation===$OR.OR_HORIZONTAL&&perfDataAreaY1.x>dataArea.x){var lRight=perfDataAreaY1.x+perfDataAreaY1.width;perfDataAreaY1.x=dataArea.x+(perfDataAreaY1.x-dataArea.x)*100/this.mSplitAxisPosition;perfDataAreaY1.width=lRight-perfDataAreaY1.x;}}if(this.mDualAxes&&!this.mSplitDualAxes){perfDataAreaY2.ResetRect(perfDataAreaY1);if(this.mOrientation===$OR.OR_VERTICAL){perfDataAreaY2.y=dataArea.y;perfDataAreaY2.height=dataArea.height;}else{perfDataAreaY2.x=dataArea.x;perfDataAreaY2.width=dataArea.width;}}this.mVecY1Axis[i].AdjustDeviceDataArea(perfDataAreaY1,false);rectVector.push(perfDataAreaY1);if(this.mDualAxes){this.mVecY2Axis[i].AdjustDeviceDataArea(perfDataAreaY2,false);rectVector.push(perfDataAreaY2);}}perfTempRect1.Reset(0,0,0,0);perfTempRect2.ResetRect(rectVector[0]);vecLength=rectVector.length;for(i=1;i<vecLength;++i){if(!this.RectangleIntersection(perfTempRect2,rectVector[i],perfTempRect1)){perfTempRect2.Reset(0,0,0,0);break;}perfTempRect2.ResetRect(perfTempRect1);}finalDataArea.ResetRect(perfTempRect2);}function hGetDataAreaForValueAxis(axisIndex,inputArea){var chartCtx=this.mChartContextPtr,uaContext=chartCtx.mUniformAxisContext,dataArea=new $C.Rect2D({Rect2D:inputArea});if(chartCtx.mIsGraphMatrix){var offset=0;if(chartCtx.IsVertical()){offset=uaContext.yDataLabelPadding||0;offset-=dataArea.y;if(offset){dataArea.y+=offset;dataArea.height-=offset;}}else{offset=uaContext.xDataLabelPadding||0;offset-=chartCtx.mGraphWidth-dataArea.x-dataArea.width;if(offset){dataArea.width-=offset;}}}return dataArea;}function hSetDataAreaValueAxis(chartArea,axisId){var chartCtx=this.mChartContextPtr,vecY1=this.mVecY1Axis,vecY2=this.mVecY2Axis,y1=vecY1[axisId],y2=vecY2[axisId],dataAreaY1,dataAreaY2,rect,areaWithTicks;if(this.mDualAxes&&this.mSplitDualAxes){rect=new $C.Rect2D({Rect2D:chartArea});dataAreaY1=new $C.Rect2D();dataAreaY2=new $C.Rect2D();chartCtx.SplitRect(rect,chartCtx.IsVertical(),this.mSplitAxisPosition,dataAreaY1,dataAreaY2);y1.SetDeviceDataArea(dataAreaY1);y1.AdjustDeviceDataArea(dataAreaY1,true);y1.UpdateTitleAndLabelArea(dataAreaY1);y2.SetDeviceDataArea(dataAreaY2);y2.AdjustDeviceDataArea(dataAreaY2,true);y2.UpdateTitleAndLabelArea(dataAreaY2);}else{if(this.mDualAxes){dataAreaY1=hGetDataAreaForValueAxis.call(this,0,chartArea);if(vecY1.length){y1.TrimDeviceDataArea(dataAreaY1);}y1.SetDeviceDataArea(dataAreaY1);y1.AdjustDeviceDataArea(dataAreaY1,true);dataAreaY2=hGetDataAreaForValueAxis.call(this,1,chartArea);if(vecY2.length){y2.TrimDeviceDataArea(dataAreaY2);}y2.SetDeviceDataArea(dataAreaY2);if(!chartCtx.mIsGraphMatrix){areaWithTicks=new $C.Rect2D({Rect2D:dataAreaY1});y2.AdjustDeviceDataArea(dataAreaY2,true);this.RectangleUnion(dataAreaY1,dataAreaY2,areaWithTicks);y1.UpdateTitleAndLabelArea(areaWithTicks);y2.UpdateTitleAndLabelArea(areaWithTicks);}}else{dataAreaY1=hGetDataAreaForValueAxis.call(this,0,chartArea);if(vecY1.length){y1.TrimDeviceDataArea(dataAreaY1);}y1.SetDeviceDataArea(dataAreaY1);if(!chartCtx.mIsGraphMatrix){y1.AdjustDeviceDataArea(dataAreaY1,true);areaWithTicks=new $C.Rect2D({Rect2D:dataAreaY1});y1.UpdateTitleAndLabelArea(areaWithTicks);}}}}function hGenerateAxisLines(){var graphObjList=this.mGraphObjectList,y1AxisCount,o1AxisCount,i;y1AxisCount=this.mVecY1Axis.length;for(i=0;i<y1AxisCount;++i){this.mVecY1Axis[i].generateAxisLine(graphObjList);if(this.mDualAxes){this.mVecY2Axis[i].generateAxisLine(graphObjList);}}o1AxisCount=this.mVecO1Axis.length;for(i=0;i<o1AxisCount;++i){this.mVecO1Axis[i].generateAxisLine(graphObjList);}}function hGenerateGridLines(chartAreas){var chartCtx=this.mChartContextPtr,graphObjList=this.mGraphObjectList,chartAreaOptions=this.mChartAreaOptions,chartAreaNumber=chartAreaOptions.chartAreaNumber,i,j,y1AxisCount,o1AxisCount,dataAreaY1,dataAreaY2;y1AxisCount=this.mVecY1Axis.length;for(i=0;i<y1AxisCount;++i){if(!this.isMutipleValueAxis()){for(j=0;j<chartAreaNumber;++j){if(this.mDualAxes&&this.mSplitDualAxes){dataAreaY1=new $C.Rect2D();dataAreaY2=new $C.Rect2D();chartCtx.SplitRect(chartAreas[j],chartCtx.IsVertical(),this.mSplitAxisPosition,dataAreaY1,dataAreaY2);this.mVecY1Axis[i].GenerateGridLines(dataAreaY1,j,graphObjList);this.mVecY2Axis[i].GenerateGridLines(dataAreaY2,j,graphObjList);}else{this.mVecY1Axis[i].GenerateGridLines(chartAreas[j],j,graphObjList);if(this.mDualAxes){this.mVecY2Axis[i].GenerateGridLines(chartAreas[j],j,graphObjList);}}}}else{if(this.mDualAxes&&this.mSplitDualAxes){dataAreaY1=new $C.Rect2D();dataAreaY2=new $C.Rect2D();chartCtx.SplitRect(chartAreas[i],chartCtx.IsVertical(),this.mSplitAxisPosition,dataAreaY1,dataAreaY2);this.mVecY1Axis[i].GenerateGridLines(dataAreaY1,i,graphObjList);this.mVecY2Axis[i].GenerateGridLines(dataAreaY2,i,graphObjList);}else{this.mVecY1Axis[i].GenerateGridLines(chartAreas[i],i,graphObjList);if(this.mDualAxes){this.mVecY2Axis[i].GenerateGridLines(chartAreas[i],i,graphObjList);}}}}o1AxisCount=this.mVecO1Axis.length;for(i=0;i<o1AxisCount;++i){if(this.isMutipleValueAxis()){for(j=0;j<chartAreaNumber;++j){this.mVecO1Axis[i].GenerateGridLines(chartAreas[j],j,graphObjList);}}else{this.mVecO1Axis[i].GenerateGridLines(chartAreas[i],i,graphObjList);}}}function hSetDataArea(dataArea,chartAreas){var chartCtx=this.mChartContextPtr,numberOfChartArea,i;perfCurrentDataArea.Reset(dataArea.x,dataArea.y,dataArea.width,dataArea.height);perfTempDataArea.Reset(dataArea.x,dataArea.y,dataArea.width,dataArea.height);if(!chartCtx.mIsGraphMatrix){if(chartCtx.mManualLayoutMode&&!this.mRecalculateFrame){perfCurrentDataArea.ResetRect(this.mPlotArea);}else{chartCtx.PutLocation($GP.DssGraphFrameLocationNEW,perfCurrentDataArea);}chartAreas.splice(0,chartAreas.length);this.CalculateChartAreas(perfCurrentDataArea,chartAreas);}else{chartAreas.splice(0,chartAreas.length);chartAreas.push(perfTempDataArea);}if(chartCtx.isUADataAreaOutput()){var uaContext=chartCtx.mUniformAxisContext;perfTempDataArea.x=uaContext.mDataAreaLeftMargin;perfTempDataArea.y=uaContext.mDataAreaTopMargin;perfTempDataArea.width=chartCtx.mGraphWidth-perfTempDataArea.x-uaContext.mDataAreaRightMargin;perfTempDataArea.height=chartCtx.mGraphHeight-perfTempDataArea.y-uaContext.mDataAreaBottomMargin;if(this.mVecO1Axis.length){this.mVecO1Axis[0].TrimAxisPadding(perfTempDataArea,false);}perfCurrentDataArea.ResetRect(perfTempDataArea);this.mCategoryPlots[0].SetDataArea(perfTempDataArea);if(this.isMutipleValueAxis()){this.mVecO1Axis[0].SetDeviceDataArea(perfCurrentDataArea);hSetDataAreaValueAxis.call(this,perfTempDataArea,0);}else{hSetDataAreaValueAxis.call(this,perfCurrentDataArea,0);this.mVecO1Axis[0].SetDeviceDataArea(perfTempDataArea);}return ;}numberOfChartArea=this.mChartAreaOptions.chartAreaNumber;for(i=0;i<numberOfChartArea;++i){this.mCategoryPlots[i].SetDataArea(chartAreas[i]);}if(this.isMutipleValueAxis()){this.mVecO1Axis[0].SetDeviceDataArea(perfCurrentDataArea);for(i=0;i<this.mChartAreaOptions.chartAreaNumber;++i){hSetDataAreaValueAxis.call(this,chartAreas[i],i);}}else{hSetDataAreaValueAxis.call(this,perfCurrentDataArea,0);for(i=0;i<this.mChartAreaOptions.chartAreaNumber;++i){this.mVecO1Axis[i].SetDeviceDataArea(chartAreas[i]);}}}function hPrepareDataAreaWithLabelRotation(dataArea,chartAreas){var chartCtx=this.mChartContextPtr,i;hSetDataArea.call(this,dataArea,chartAreas);var showDataLabels=this.mDatasetPtr.showDatalabels();if(showDataLabels){layoutDatalabel.call(this);if(!chartCtx.mIsGraphMatrix){var oldDataArea=new $C.Rect2D({Rect2D:dataArea}),categoryPlotsCount=this.mCategoryPlots.length;for(i=0;i<categoryPlotsCount;++i){this.mCategoryPlots[i].ReserveAreaForDataLabels(dataArea);}if(dataArea.width!==oldDataArea.width||dataArea.height!==oldDataArea.height){hSetDataArea.call(this,dataArea,chartAreas);}}else{this.ShouldRotateDataLabel();}}}function hCreateOneValueAxis(axisKey,min,max,numberOfChartAreas,shouldBeShown){var chartCtx=this.mChartContextPtr,axisTripleId=chartCtx.getAxisTripleId(axisKey),axisInfo=chartCtx.getUniformAxisInformation(axisTripleId.mObjectId),metrics=axisInfo.Metrics,valueAxisDirection=(this.mOrientation===$OR.OR_VERTICAL?$AXIS_DIRECTION.AD_Y:$AXIS_DIRECTION.AD_X),valueAxisPtr=new $C.ValueAxis({TripleId:axisTripleId,GraphObjectManager:this,Min:min,Max:max,PrimaryMetricIndex:metrics,LargerGridInterval:numberOfChartAreas!==1||(this.mDualAxes&&this.mSplitDualAxes),IsPercent:this.mLayout===$LAYOUT.LO_PERCENT,AxisDirection:valueAxisDirection,IsShown:shouldBeShown,Key:axisKey});if(chartCtx.mIsGraphMatrix&&valueAxisPtr.mIsUniformAxis===false){var condense=axisInfo.CondenseEnforced;valueAxisPtr.checkCondense(!!condense);}return valueAxisPtr;}mstrmojo.chart.CategoryPlotManager=mstrmojo.declare(mstrmojo.chart.PlotManager,null,{scriptClass:"mstrmojo.chart.CategoryPlotManager",mGraphType:$GT.DssGraphTypeVertical_Line_Absolute,mLayout:$LAYOUT.LO_ABSOLUTE,mOrientation:$OR.OR_VERTICAL,mUseDepth:false,mDualAxes:false,mSplitDualAxes:false,mDepth:200,mDepthDirection:45,mSplitAxisPosition:50,mDataAreaSplitX:50,mCategoryPlots:null,mVecO1Axis:null,mVecY1Axis:null,mVecY2Axis:null,init:function init(props){this._super(props);this.mCategoryPlots=[];this.mVecO1Axis=[];this.mVecY1Axis=[];this.mVecY2Axis=[];this.mChartContextPtr=props.GraphObjectManager.mChartContextPtr;},GenerateMapAndList:function GenerateMapAndList(){var chartAreaOptions=this.mChartAreaOptions,numberOfChartAreas=chartAreaOptions.chartAreaNumber,plotArea=this.mPlotArea,categoryPlots=this.mCategoryPlots,chartCtx=this.mChartContextPtr,graphObjMgrList=this.mGraphObjectManagerList,i,j,categoryPlotPtr,initY1,initY2,min,max,valueAxisY1Ptr,valueAxisY2Ptr,categoryAxisO1Ptr,o1AxisCount,y1AxisCount,y2AxisCount,chartAreas=[],numberOfCategoryPlots,returnVal,len;var axisKey="Y1",vecO1=this.mVecO1Axis,vecY1=this.mVecY1Axis,vecY2=this.mVecY2Axis;if(plotArea.width<=0||plotArea.height<=0){return ;}this.LoadProperties();for(i=0;i<numberOfChartAreas;++i){categoryPlotPtr=hCreateCategoryPlot.call(this,i);categoryPlotPtr.SetDataset(this.mDatasetPtr);categoryPlotPtr.mLegendPtr=this.mLegendPtr;categoryPlots.push(categoryPlotPtr);len=chartAreaOptions.seriesDistribution[i].length;for(j=0;j<len;++j){categoryPlots[i].AddSeries(chartAreaOptions.seriesDistribution[i][j]);}categoryPlotPtr.Init();}var categoryAxisTripleId;if(this.isMutipleValueAxis()){categoryAxisTripleId=chartCtx.getAxisTripleId("O1");var categoryAxisPtr=new $C.CategoryAxis({TripleId:categoryAxisTripleId,GraphObjectManager:this,AxisLabelsLocation:$AXIS_LABEL_LOC.ALL_BOTTOM,AxisDirection:(this.mOrientation===$OR.OR_VERTICAL?$AXIS_DIRECTION.AD_X:$AXIS_DIRECTION.AD_Y)});vecO1.push(categoryAxisPtr);for(i=0;i<numberOfChartAreas;++i){initY1=false;initY2=false;min=[0,0];max=[0,0];returnVal=categoryPlots[i].GetMinMaxValue($VA.VA_Y1,min[0],max[0],initY1);min[0]=returnVal.Min;max[0]=returnVal.Max;initY1=returnVal.AreInitialized;if(this.mDualAxes){returnVal=categoryPlots[i].GetMinMaxValue($VA.VA_Y2,min[1],max[1],initY2);min[1]=returnVal.Min;max[1]=returnVal.Max;initY2=returnVal.AreInitialized;}categoryPlots[i].SetCategoryAxis(categoryAxisPtr);if(chartCtx.mIsGraphMatrix&&this.mOrientation===$OR.OR_HORIZONTAL){axisKey="X1";}valueAxisY1Ptr=hCreateOneValueAxis.call(this,axisKey,min[0],max[0],numberOfChartAreas,initY1);vecY1.push(valueAxisY1Ptr);categoryPlots[i].AddValueAxis(valueAxisY1Ptr);if(this.mDualAxes){axisKey="Y2";if(chartCtx.mIsGraphMatrix&&this.mOrientation===$OR.OR_HORIZONTAL){axisKey="X2";}valueAxisY2Ptr=hCreateOneValueAxis.call(this,axisKey,min[1],max[1],numberOfChartAreas,initY2);vecY2.push(valueAxisY2Ptr);categoryPlots[i].AddValueAxis(valueAxisY2Ptr);}}}else{initY1=false;initY2=false;min=[0,0];max=[0,0];for(i=0;i<numberOfChartAreas;++i){returnVal=categoryPlots[i].GetMinMaxValue($VA.VA_Y1,min[0],max[0],initY1);min[0]=returnVal.Min;max[0]=returnVal.Max;initY1=returnVal.AreInitialized;if(this.mDualAxes){returnVal=categoryPlots[i].GetMinMaxValue($VA.VA_Y2,min[1],max[1],initY2);min[1]=returnVal.Min;max[1]=returnVal.Max;initY2=returnVal.AreInitialized;}categoryAxisTripleId=chartCtx.mIsGraphMatrix?chartCtx.getAxisTripleId("O1"):new $C.TripleId({ObjectId:$GO.DssGraphO1Body,SeriesId:i});categoryAxisO1Ptr=new $C.CategoryAxis({TripleId:categoryAxisTripleId,GraphObjectManager:this,AxisLabelsLocation:$AXIS_LABEL_LOC.ALL_BOTTOM,AxisDirection:(this.mOrientation===$OR.OR_VERTICAL?$AXIS_DIRECTION.AD_X:$AXIS_DIRECTION.AD_Y)});categoryPlots[i].SetCategoryAxis(categoryAxisO1Ptr);vecO1.push(categoryAxisO1Ptr);}if(chartCtx.mIsGraphMatrix&&this.mOrientation===$OR.OR_HORIZONTAL){axisKey="X1";}valueAxisY1Ptr=hCreateOneValueAxis.call(this,axisKey,min[0],max[0],numberOfChartAreas,initY1);vecY1.push(valueAxisY1Ptr);for(i=0;i<numberOfChartAreas;++i){categoryPlots[i].AddValueAxis(valueAxisY1Ptr);}if(this.mDualAxes){axisKey="Y2";if(chartCtx.mIsGraphMatrix&&this.mOrientation===$OR.OR_HORIZONTAL){axisKey="X2";}valueAxisY2Ptr=hCreateOneValueAxis.call(this,axisKey,min[1],max[1],numberOfChartAreas,initY2);vecY2.push(valueAxisY2Ptr);for(i=0;i<numberOfChartAreas;++i){categoryPlots[i].AddValueAxis(valueAxisY2Ptr);}}}o1AxisCount=this.mVecO1Axis.length;y1AxisCount=this.mVecY1Axis.length;y2AxisCount=this.mVecY2Axis.length;if(this.mUseDepth){for(i=0;i<o1AxisCount;++i){vecO1[i].SetDepthAndDirection(this.mDepth,this.mDepthDirection);}for(i=0;i<y1AxisCount;++i){vecY1[i].SetDepthAndDirection(this.mDepth,this.mDepthDirection);}for(i=0;i<y2AxisCount;++i){vecY2[i].SetDepthAndDirection(this.mDepth,this.mDepthDirection);}}len=vecO1.length;for(i=0;i<len;++i){vecO1[i].SetDataset(this.mDatasetPtr);}for(i=0;i<o1AxisCount;++i){graphObjMgrList.push(this.mVecO1Axis[i]);}for(i=0;i<y1AxisCount;++i){graphObjMgrList.push(this.mVecY1Axis[i]);if(this.mDualAxes){graphObjMgrList.push(this.mVecY2Axis[i]);}}perfInitDataArea.Reset(0,0,0,0);hReserverDataAreaWithAxis.call(this,plotArea,perfInitDataArea);hPrepareDataAreaWithLabelRotation.call(this,perfInitDataArea,chartAreas);numberOfCategoryPlots=categoryPlots.length;for(i=0;i<numberOfCategoryPlots;++i){graphObjMgrList.push(categoryPlots[i]);categoryPlots[i].GenerateMapAndList();}for(i=0;i<o1AxisCount;++i){vecY1[i].GenerateMapAndList();}for(i=0;i<y1AxisCount;++i){vecY1[i].GenerateMapAndList();if(this.mDualAxes){vecY2[i].GenerateMapAndList();}}var isGraphMatrix=chartCtx.mIsGraphMatrix,isUADataarea=chartCtx.isUADataAreaOutput();if(!(isGraphMatrix&&isUADataarea)){if(this.mUseDepth){hGenerateAxisLines.call(this);hGenerateGridLines.call(this,chartAreas);}else{hGenerateGridLines.call(this,chartAreas);hGenerateAxisLines.call(this);}}},LoadProperties:function LoadProperties(){var value,chartCtx=this.mChartContextPtr;this._super();var graphType=this.mGraphType=chartCtx.mGraphType;if(!(chartCtx.mIsTimeSeriesChart)){if(!chartCtx.mIsGraphMatrix){value=chartCtx.GetProperty($GP.DssGraphDepthMode,$NTID);if(value){this.mUseDepth=(value!==$VF);}value=chartCtx.GetProperty($GP.DssGraph2DDepth,$NTID);if(value){this.mDepth=value;}value=chartCtx.GetProperty($GP.DssGraph2DAngle,$NTID);if(value){this.mDepthDirection=value;}}this.mOrientation=chartCtx.IsVertical()?$OR.OR_VERTICAL:$OR.OR_HORIZONTAL;this.mDualAxes=chartCtx.IsDualAxis();}if((graphType>=$GT.DssGraphTypeVertical_Area_Percent)&&(graphType<=$GT.DssGraphTypeHorizontal_Line_Percent)&&(graphType%7===0)){this.mLayout=$LAYOUT.LO_PERCENT;}if(this.mLayout!==$LAYOUT.LO_PERCENT&&(graphType>=$GT.DssGraphTypeVertical_Bar_DualAxis_Percent&&graphType<=$GT.DssGraphTypeHorizontal_Area_DualAxis_Percent)){this.mLayout=$LAYOUT.LO_PERCENT;}},isMutipleValueAxis:function isMutipleValueAxis(){var chartAreaOptions=this.mChartAreaOptions;return(this.mOrientation===chartAreaOptions.mOrientation);},ReserveAreaCategoryAxis:function ReserveAreaCategoryAxis(dataArea,finalDataArea){var chartCtx=this.mChartContextPtr,rectVector=[],chartAreas=[],o1AxisCount,i,lowMargin,highMargin,xCoordinate,yCoordinate,width,height;if(!this.isMutipleValueAxis()){this.CalculateChartAreas(dataArea,chartAreas);}o1AxisCount=this.mVecO1Axis.length;for(i=0;i<o1AxisCount;++i){if(chartCtx.mIsGraphMatrix){perfTempRect2.ResetRect(this.isMutipleValueAxis()?dataArea:chartAreas[i]);}else{perfTempRect2=this.isMutipleValueAxis()?new $C.Rect2D({Rect2D:dataArea}):new $C.Rect2D({Rect2D:chartAreas[i]});}this.mVecO1Axis[i].AdjustTitleArea(perfTempRect2);if(chartCtx.mIsTimeSeriesChart){this.mVecO1Axis[i].AdjustDataArea(perfTempRect2,0,0,true);}else{lowMargin=this.mOrientation===$OR.OR_HORIZONTAL?this.mBottomMargin:this.mLeftMargin;highMargin=this.mOrientation===$OR.OR_HORIZONTAL?this.mTopMargin:this.mRightMargin;this.mVecO1Axis[i].AdjustDataArea(perfTempRect2,lowMargin,highMargin);}if(chartCtx.mRecalculateFrame){if(this.mOrientation===$OR.OR_VERTICAL){xCoordinate=dataArea.x;width=dataArea.width;if(i===0){if(perfTempRect2.x>dataArea.x){xCoordinate=perfTempRect2.x;width-=(perfTempRect2.x-dataArea.x);}}if(i===this.mVecO1Axis.length-1){if(dataArea.x+dataArea.width>perfTempRect2.x+perfTempRect2.width){width=perfTempRect2.x+perfTempRect2.width-xCoordinate;}}perfTempRect2.x=xCoordinate;perfTempRect2.width=width;}else{yCoordinate=dataArea.y;height=dataArea.height;if(i===0){if(perfTempRect2.y>dataArea.y){yCoordinate=perfTempRect2.y;height-=(perfTempRect2.y-dataArea.y);}}if(i===this.mVecO1Axis.length-1){if(dataArea.y+dataArea.height>perfTempRect2.y+perfTempRect2.height){height=perfTempRect2.y+perfTempRect2.height-yCoordinate;}}perfTempRect2.y=yCoordinate;perfTempRect2.height=height;}}rectVector.push(perfTempRect2);}perfTempRect2.ResetRect(rectVector[0]);for(i=1;i<rectVector.length;++i){if(!this.RectangleIntersection(perfTempRect2,rectVector[i],perfTempRect1)){perfTempRect2.Reset(0,0,0,0);break;}perfTempRect2.ResetRect(perfTempRect1);}finalDataArea.ResetRect(perfTempRect2);},Draw:function Draw(){var categoryPlots=this.mCategoryPlots,y1AxisCount,y2AxisCount,o1AxisCount,numberOfCategoryPlots,i;this._super();y1AxisCount=this.mVecY1Axis.length;for(i=0;i<y1AxisCount;++i){this.mVecY1Axis[i].Draw();}y2AxisCount=this.mVecY2Axis.length;for(i=0;i<y2AxisCount;++i){this.mVecY2Axis[i].Draw();}o1AxisCount=this.mVecO1Axis.length;for(i=0;i<o1AxisCount;++i){this.mVecO1Axis[i].Draw();}numberOfCategoryPlots=categoryPlots.length;for(i=0;i<numberOfCategoryPlots;++i){categoryPlots[i].Draw();}},ShouldRotateDataLabel:function ShouldRotateDataLabel(){var chartCtx=this.mChartContextPtr,dataset=this.mDatasetPtr,gmCtx=chartCtx.GetGraphMatrixContext(),isDataLabelEnabled=dataset.showDatalabels(),shouldRotateDataLabel=false,isRotationInited=false;if(isDataLabelEnabled&&chartCtx.mIsGraphMatrix&&dataset.onlyBarDataLabelEnabled()){var ablPlot=this.mCategoryPlots[0],value;if(this.mOrientation===$OR.OR_VERTICAL){value=chartCtx.GetProperty($EGP.DssGraphMatrixInitedDataLabelRotation,$C.gNullTripleId);if(value!==undefined&&value!==null){isRotationInited=value;}if(isRotationInited){value=chartCtx.GetProperty($EGP.DSSGraphMatrixDataLabelRotated,$C.gNullTripleId);if(value!==undefined&&value!==null){gmCtx.mIsNeedRotateDataLabel=value;return ;}}shouldRotateDataLabel=ablPlot.ShouldRotateDataLabel();gmCtx.mIsNeedRotateDataLabel=shouldRotateDataLabel;chartCtx.PutGraphProperty($EGP.DssGraphMatrixInitedDataLabelRotation,$C.gNullTripleId,true);chartCtx.PutGraphProperty($EGP.DSSGraphMatrixDataLabelRotated,$C.gNullTripleId,shouldRotateDataLabel);}}}});}());
(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._Formattable","mstrmojo._IsDocumentTemplate","mstrmojo.Label","mstrmojo.ui.menus.MenuConfig");mstrmojo.requiresClsP("mstrmojo.vi.viz","EnumVisualizationTemplates","EnumVizStyles","EnumWidgetTypes");var FMTS={top:"top",left:"left","z-index":"zIndex",width:"width",height:"height"};mstrmojo.AndroidVisBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._Formattable,mstrmojo._IsDocumentTemplate],{scriptClass:"mstrmojo.AndroidVisBase",updated:false,waitingForData:false,node:null,skipReRender:false,updateFormatsOnUpdate:true,setModel:function setModel(model){this.set("model",model);},destroy:function destroy(){var model=this.model;if(model&&model.destroy){model.destroy();delete this.model;}this._super();},resize:function resize(){var f=this.getFormats();if(parseInt(f.height,10)===0||parseInt(f.width,10)===0){this.domNode.style.display="none";}else{this.setDimensions(f.height,f.width);this.domNode.style.display="";}},setDimensions:function setDimensions(h,w){var dimensionChanged=this._super(h,w);if(dimensionChanged&&this.hasRendered&&!this.skipReRender){this.reRender();}return dimensionChanged;},reRender:function reRender(){this.unrender();this.render();},getWidth:function getWidth(){return parseInt(this.width,10);},getHeight:function getHeight(){return parseInt(this.height,10);},getLeft:function getLeft(){return parseInt(this.left,10);},getTop:function getTop(){return parseInt(this.top,10);},buildRendering:function bldRn(){this.height=this.getHeight();this.width=this.getWidth();this.left=this.getLeft();this.top=this.getTop();if(!this.updated){this.update();}this._super();},initFromVisProps:function initFromVisProps(){},postBuildRendering:function(){var isEmpty=this.isEmpty();this._super();this.raiseEvent({name:"toggleCtrlOverlay",visible:isEmpty,controls:this.getVisEmptyMsgControls()});return !isEmpty;},update:function update(node){node=node||this.node;if(node){var nodeData=node.data;if(nodeData){this.model.set("data",nodeData);}this.waitingForData=!!nodeData.nsj;if(this.waitingForData){var iveStyleName="ServerJsonRWDStyle";var model=this.model,ds=model.getDataService(),taskReq={host:this,nodes:[this.k]};if(nodeData.wid!==undefined){taskReq.slices=[nodeData.wid];}ds.retrieveServerJson(taskReq,mstrmojo.func.wrapMethods(model.docModel.getUpdateColorMapCallback(),model.docModel.getUpdateThemePaletteCallback(),model.controller._getXtabCallback(this)),{preserveUndo:true,style:{name:iveStyleName,params:{treesToRender:3}},params:{styleName:iveStyleName}});this.updated=true;return false;}if(this.updateFormatsOnUpdate){var fmts=node.defn.fmts||node.defn.units[this.model.k].fmts;if(fmts){for(var k in FMTS){if(FMTS.hasOwnProperty(k)){var v=FMTS[k];if(k in fmts){this[v]=fmts[k];}}}}}}if(this.model){var docModel=this.model&&this.model.docModel;this.initFromVisProps(this.model.vp);if(docModel&&docModel.getDocBuilder){var visName=docModel.getDocBuilder().getMojoVisName(node);if(visName){node.data.visName=visName;}}}this.updated=true;if(this._super){return this._super(node);}return true;},isEmpty:function isEmpty(){return false;},getVisEmptyMsgControls:function getVisEmptyMsgControls(){return[{scriptClass:"mstrmojo.Label",cssClass:"dropMsg",text:mstrmojo.desc(11668,"Drag objects here.")}];},getModel:function getModel(){return this.model;},getData:function getData(){return this.model.data;},getRowsAndCols:function(){var gts=this.model.data.gts;return(gts.row||[]).concat(gts.col||[]);},getExp:function(){var data=this.model.data,exp=data&&data.sc&&data.sc.exp;return exp;},getDocModel:function getDocModel(){return this.model&&this.model.docModel;},getTitleRMCPopup:mstrmojo.emptyFn,getMenuHandler:function getMenuHandler(){return mstrmojo.emptyFn;},renderErrorMessage:function renderErrorMessage(msg){this.domNode.innerHTML='<div class="mstrmojo-message">'+msg+"</div>";},getMessageID:function getMessageID(){return this.model.docModel.mid||this.model.mid;},performAction:function performAction(actionObj){var action=this.model.getAction(actionObj),handler=action&&action.h;if(handler&&this.controller[handler]){this.controller[handler](this,action.a);return true;}return false;},findSelectorControl:function findSelectorControl(){var data=this.getData(),v=data&&data.sc;if(v&&parseInt(v.ct,10)===6){this.selectorControl=v;this.isMultiSelect=true;}else{delete this.selectorControl;}return this.selectorControl;}});})();
(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.pathbar.PathPopup","mstrmojo.mstr._RecentObjectsHelper");function createRecentsPopup(parent,target){var menuItems=this.handleRecentObjects();var recentsPopup;parent.addDisposable(recentsPopup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrRecentsGenPopup",cssClass:"mstrShortcutsListPopup",targetNode:target,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function preclick(){this.parent.close();},items:menuItems,getItemMarkup:function(item){var imgMarkup="";if(mstrConfig.showPreviews){if(item.recoveryInfo!==undefined){var imgSrc=(item.recoveryInfo.imgData!==undefined)?"data:image/png;base64,"+item.recoveryInfo.imgData:"";if(imgSrc!==""){imgMarkup='<img class = "img-preview" src = "'+imgSrc+'" height="200" width="250" style="z-index: 100; position: absolute;">';}}}return'<span class="item mstrMenuItem {@itemCls}" style="{@cssText}"><span class="{@iconCls}"></span><a class="mstrLink" href="{@href}">{@n}'+imgMarkup+"</a></span>";},getItemProps:function getItemProps(item,idx){var isSelected=!!item.selected;return{sel:isSelected,iconCls:item.iconClass,itemCls:item.itemClass,cssText:item.cssText||"",cls:isSelected?"selected":"",newGroup:!!item.grp?"grp":"",n:item.recoveryName,idx:idx,href:item.recoveryURL,name:item.recoveryName,target:item.target||"_self"};},onclick:function(evt){var fnStopPropagation=function(){mstrmojo.dom.preventDefault(evt.hWin,evt.e);mstrmojo.dom.stopPropogation(evt.hWin,evt.e);};var oAnchor=evt.getTarget();if(oAnchor.getAttribute("href")){mstrmojo.form.sendLinkAsForm(oAnchor.href);}else{mstrmojo.form.sendLinkAsForm(oAnchor.parentElement.href);}fnStopPropagation();return false;}}]}));return recentsPopup;}function createPopup(){var me=this;this.addDisposable(this.popup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrSCList",cssClass:"mstrShortcutsListPopup",targetNode:this.domNode,offsetTop:2,recentsPopup:null,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function preclick(event){if(event.getTarget().getAttribute("name")!=="recentObjects"){this.parent.close();}},handleMouseOver:function handleMouseOver(event,selectedItem){if(event.getTarget().getAttribute("name")=="recentObjects"){this.handleClick(event,selectedItem);}else{if(this.parent.recentsPopup!=null){var mPopup=this.parent.recentsPopup;mPopup.close();}}return false;},handleClick:function handleClick(event,selectedItem){if(event.getTarget().getAttribute("name")=="recentObjects"){var target=event.getTarget();if(target.nodeName==="SPAN"){target=target.parentNode;}if(this.parent.recentsPopup==null){this.parent.recentsPopup=createRecentsPopup.call(me,this.parent,target);}var mPopup=this.parent.recentsPopup;mPopup.autoPosition=false;var rect=target.getBoundingClientRect();if(!mPopup.isOpen){mPopup.offsetTop=rect.top-rect.bottom;mPopup.offsetLeft=this.domNode.clientWidth-rect.left;mPopup.open();}return true;}return false;},items:mstrApp.pathInfo.sb,getItemMarkup:function(item){var cssclass="{@cls}";if(item.name==="recentObjects"){cssclass="";}return'<a name="{@name}" class="item {@name} '+cssclass+' {@newGroup}" idx="{@idx}" onclick="{@onclick}" href="#" target="{@target}"><span name="{@name}" class="icon"></span><span name="{@name}">{@n}</span></a>';},getItemProps:function getItemProps(item,idx){var isSelected=!!item.selected;return{sel:isSelected,cls:isSelected?"selected":"",newGroup:!!item.grp?"grp":"",n:item.n,idx:idx,href:item.href,name:item.name,onclick:item.onclick||"return true",target:item.target||"_self"};}}]}));}mstrmojo.ui.pathbar.PathStarBurst=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.mstr._RecentObjectsHelper],{scriptClass:"mstrmojo.ui.pathbar.PathStarBurst",markupString:'<a id="mstrStarburst {@id}" mstrAttach:click,mouseover,mouseout class="mstrLink" style="top:0"><div id="mstrLogo" class="mstrLogo path"></div><div id="mstrLogoMenu" class="mstrLogoMenu path mstrPullArrow"></div></a>',markupSlots:{logoNode:function(){return this.domNode.children[0];},logoMenuNode:function(){return this.domNode.children[1];}},popup:null,postBuildRendering:function postBuildRendering(){createPopup.call(this);this.domNode.setAttribute("href",mstrApp.name+"?evt=3010&src="+mstrApp.name+".3010");},onclick:function onclick(evt){var fnStopPropagation=function(){mstrmojo.dom.preventDefault(evt.hWin,evt.e);mstrmojo.dom.stopPropogation(evt.hWin,evt.e);};if(evt.getTarget()===this.logoMenuNode){var mPopup=this.popup;if(!mPopup.isOpen){mPopup.open();}fnStopPropagation();}else{mstrmojo.form.sendLinkAsForm(evt.src.domNode.href);fnStopPropagation();return false;}}});}());
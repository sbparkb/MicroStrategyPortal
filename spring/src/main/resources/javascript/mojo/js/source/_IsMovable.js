(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var $DOM=mstrmojo.dom;function isHandleMoving(context){return $DOM.contains(this.getMovingHandle(),context.src.node,true,document.body);}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function getMovingHandle(){return this.domNode;},getMovingTarget:function getMovingTarget(){return this.domNode;},isDragValid:function isDragValid(context){return isHandleMoving.call(this,context)||(this._super&&this._super(context))||false;},ondragstart:function ondragstart(context){if(isHandleMoving.call(this,context)){var handle=this.getMovingHandle(),targetStyle=this.getMovingTarget().style;this._leftPos=parseInt(targetStyle.left,10);this._topPos=parseInt(targetStyle.top,10);this._hWidth=handle.clientWidth;this._hHeight=handle.clientHeight;}if(this._super){this._super();}},ondragmove:function ondragmove(context){if(isHandleMoving.call(this,context)){var targetPosition=context.tgt.pos,srcPosition=context.src.pos,targetStyle=this.getMovingTarget().style,dm=$DOM.windowDim();targetStyle.left=this.left=Math.min(Math.max(this._leftPos+targetPosition.x-srcPosition.x,-this._hWidth+40),dm.w-40)+"px";targetStyle.top=this.top=Math.min(Math.max(this._topPos+targetPosition.y-srcPosition.y,-this._hHeight+20),dm.h-20)+"px";}if(this._super){this._super();}},ondragend:function ondragend(context){if(isHandleMoving.call(this,context)){delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}if(this._super){this._super();}}});}());
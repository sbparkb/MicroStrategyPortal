(function(){mstrmojo.requiresCls("mstrmojo.architect.ui.RelationPanelContent","mstrmojo.warehouse.ui.BasePanel","mstrmojo.architect.EnumDataChangeEvents");var $PX="px",$ENUM_DATA_CHANGE_EVENTS=mstrmojo.architect.EnumDataChangeEvents,EVT_LAYER_CHANGED=$ENUM_DATA_CHANGE_EVENTS.LAYER_CHANGE;mstrmojo.architect.ui.RelationPanel=mstrmojo.declare(mstrmojo.warehouse.ui.BasePanel,null,{scriptClass:"mstrmojo.architect.ui.RelationPanel",cssClass:"RelationPanel",title:mstrmojo.desc(11395,"Parent-Child Relationship"),init:function init(props){this._super(props);var relationPanel=this,rootController=mstrApp.getRootController();var evtConfig={},panelConfig=evtConfig[this.id]={},events=this.getRelationshipChangedEvents();events.forEach(function(evtName){panelConfig[evtName]=function(evt){if(relationPanel.shouldClearExistingRelations(evt)){evt.clear=true;}relationPanel.content.onRelationshipChange(evt);};});mstrApp.getRootController().attachDataChangeListeners(evtConfig);rootController.registerSaveCallback(function(){rootController.updateRelationPositions(relationPanel.content.getAttributePositions());});},postBuildRendering:function postBuildRendering(){this._super();this.onheightChange({value:this.height});},getRelationshipChangedEvents:function getRelationshipChangedEvents(){return[$ENUM_DATA_CHANGE_EVENTS.RELATIONSHIP_CHANGED,EVT_LAYER_CHANGED];},shouldClearExistingRelations:function shouldClearExistingRelations(evt){return(evt&&(evt.name===EVT_LAYER_CHANGED));},onheightChange:function onheightChange(evt){var h=parseInt(evt.value,10),headerHeight=this.headerHeight=this.headerHeight||(this.hasRendered?this.headerNode.clientHeight:36),contentHeight=(Math.max(parseInt(h,10)-headerHeight,0))+$PX;this.height=h+$PX;this.content.set("height",contentHeight);this.set("instructionsHeight",this.height);},onwidthChange:function onwidthChange(evt){var w=parseInt(evt.value,10),contentWidth=Math.max(w,0)+$PX;this.width=w+$PX;this.content.set("width",contentWidth);},children:[{scriptClass:"mstrmojo.architect.ui.RelationPanelContent",alias:"content"}]});}());
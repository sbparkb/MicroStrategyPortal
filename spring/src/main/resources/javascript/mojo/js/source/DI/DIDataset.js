(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Label","mstrmojo.RadioList","mstrmojo.DI.DIConstants","mstrmojo.DI.FileDragDropBox");mstrmojo.requiresDescs(14659,14660);var constants=mstrmojo.DI.DIConstants;function getExtensionType(extension){var ext=extension.toLowerCase(),type;if(ext===".xls"||ext===".xlsx"){type=constants.xdaType.excel;}else{if(ext===".txt"||ext===".csv"){type=constants.xdaType.text;}else{type=0;}}return type;}mstrmojo.DI.DIDataset=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DI.DIDataset",cssClass:"mstrmojo-di-dataset",markupString:'<div id="{@id}" class="{@cssClass}" ><div></div><div></div><div></div></div>',markupSlots:{containerNode:function(){return this.domNode;},titleNode:function(){return this.domNode.children[0];},fileDnDNode:function(){return this.domNode.children[1];},buttonNode:function(){return this.domNode.children[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{slot:"titleNode",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-di-dataset-title",text:"Specify the location of the file that you would like to upload"},{slot:"titleNode",scriptClass:"mstrmojo.RadioListHoriz",cssClass:"mstrmojo-FileDragDropBox-radioList",itemCssClass:"mstrmojo-FileDragDropBox-radioList-item",alias:"radioList",selectedIndex:0,onchange:function(){var controller=mstrApp.getRootController();},items:[{did:"0",n:"From my Computer/Network"},{did:"1",n:"From URL"},{did:"2",n:"From Clipboard"}]},{slot:"fileDnDNode",scriptClass:"mstrmojo.DI.FileDragDropBox",cssClass:"drag-drop-box",alias:"dnDBox",multiple:"multiple",markupMethods:{onvalueChange:function(){var controller=mstrApp.getRootController();if(this.value!==""){controller.sourceSelected(true);}else{controller.sourceSelected(false);}},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}}}],onNextButtonClick:function onNextButtonClick(){var m=this.model,i;var dndBox=this.dnDBox;var files=dndBox.files;var extension;var controller=mstrApp.getRootController();var showPreview=(this.model.operationMode===constants.operationMode.create)?true:this.showPrv.checked;var fSize;var fileName;for(i=0;i<files.length;i++){var file=files[i];fileName="C:\\fakepath\\"+file.name;extension=fileName.substring(fileName.lastIndexOf("."));if(getExtensionType(extension)===0){controller.displayError(mstrmojo.desc(14659,"The following file extension ## is not supported.").replace("##",extension),false);return ;}if(files!==undefined){if(files[i]!==undefined){fSize=files[i].size;}}else{var oas=new ActiveXObject("Scripting.FileSystemObject");var e=oas.getFile(files);fSize=e.Size;}if(fSize>(mstrApp.diParams.UploadSizeLimit*1024*1024)){extension=fileName.substring(fileName.lastIndexOf(".")+1);controller.displayError(mstrmojo.desc(14660,"The maximum file size for ## files is @@ MB.").replace("##",extension).replace("@@",mstrApp.diParams.UploadSizeLimit),false);return ;}}controller.importFileEMMA(dndBox,fileName,showPreview,true);}});}());
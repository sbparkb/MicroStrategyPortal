(function(){mstrmojo.requiresCls("mstrmojo.NumStepperContentProvider","mstrmojo.date");var $D=mstrmojo.date;mstrmojo.DateStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.DateStepperContentProvider",curVal:null,init:function(props){this._super(props);var item=this.item,intVal=item[this.intField],val=item[this.valField],minF=this.minField,maxF=this.maxField,min=item[minF],max=item[maxF];this.min=min&&$D.getDateFromDateInfo(min);this.max=max&&$D.getDateFromDateInfo(max);this.curVal=val?$D.getDateFromDateInfo(val):(this.min?new Date(this.min):new Date());this.createChildProviders();},createChildProviders:function(){var me=this;mstrmojo.array.forEach(["year","month","day"],function(n){me[n+"CP"]=new mstrmojo.NumStepperContentProvider({item:{interval:1},canLoop:true,updateConfig:function(v,max,min){this.curVal=v;this.max=max;this.min=min;},onTraverse:function(){me.traverse(n,this.curVal);}});});this.updateChildProviders();},updateChildProviders:function(){var max=this.max,min=this.min,year=this.curVal.getFullYear(),month=this.curVal.getMonth(),day=this.curVal.getDate(),atMaxYear=max&&(year===max.getFullYear()),atMinYear=min&&(year===min.getFullYear()),atMaxMonth=atMaxYear&&(month===max.getMonth()),atMinMonth=atMinYear&&(month===min.getMonth());this.yearCP.updateConfig(year,max?max.getFullYear():null,min?min.getFullYear():null);this.monthCP.updateConfig(month+1,atMaxYear?max.getMonth()+1:12,atMinYear?min.getMonth()+1:1);this.dayCP.updateConfig(day,atMaxMonth?max.getDate():mstrmojo.date.getDaysOfMonth(year,month+1),atMinMonth?min.getDate():1);},traverse:function(field,value){var v=this.curVal,y=(field==="year")?value:this.curVal.getFullYear(),m=(field==="month")?value:this.curVal.getMonth()+1,d=(field==="day")?value:this.curVal.getDate();d=Math.min(mstrmojo.date.getDaysOfMonth(y,m),d);v.setFullYear(y,m-1,d);if(this.max){v=Math.min(this.max,v);}if(this.min){v=Math.max(this.min,v);}this.curVal=new Date(v);this.updateChildProviders();if(this.onTraverse){this.onTraverse();}}});}());
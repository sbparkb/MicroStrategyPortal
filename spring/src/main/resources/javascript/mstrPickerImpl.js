mstrPickerImplScript=true;mstrPickerImpl.prototype=new mstrBoneImpl();mstrPickerImpl.prototype.pulldownName="";mstrPickerImpl.prototype.targetCombodown="";mstrPickerImpl.prototype.onload=function(){try{this.currentPicker=null;this.initPulldown();}catch(err){microstrategy.errors.log(err);return false;}};mstrPickerImpl.prototype.initPulldown=function(){var oncl=new Function("e","return microstrategy.bone('"+this.id+"').togglePicker(e);");var pulldown=document.getElementById(this.pulldownName);if(!pulldown){return ;}for(var i=0;i<pulldown.childNodes.length;i++){if(pulldown.childNodes[i].tagName&&pulldown.childNodes[i].tagName.toLowerCase()=="span"){pulldown.childNodes[i].onclick=oncl;}}};mstrPickerImpl.prototype.execPicker=function(picker,obj){try{var bClose=true;var at=this.getAppliesTo();var cmdVal=obj.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!cmdVal){cmdVal=picker.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);}var cmdId=obj.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!cmdId){cmdId=picker.getAttribute(microstrategy.HTMLATTR_CMD_ID);}if(at&&cmdId&&at.commands.queryEnabled(cmdId)){bClose=at.commands.exec(cmdId,cmdVal);}return bClose;}catch(err){microstrategy.errors.log(err);return false;}};mstrPickerImpl.prototype.getAppliesTo=function(bone){try{if(this.appliesTo){var bone=microstrategy.bone(this.appliesTo);return bone;}return null;}catch(err){microstrategy.errors.log(err);return false;}};mstrPickerImpl.prototype.togglePicker=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);var className="";if(obj.getAttribute(microstrategy.HTMLATTR_CMD_ID)==null){this.targetCombodown=findTarget(obj,microstrategy.HTMLATTR_CMD_ID);className=findTarget(obj,microstrategy.HTMLATTR_CMD_ID).className;}else{className=obj.className;}if(obj&&className.indexOf("disabled")==-1){var cmdPicker=obj.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);if(!cmdPicker){cmdPicker=obj.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);}var picker=document.getElementById(cmdPicker);if(obj.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){if(className.indexOf("Selected")==-1){this.targetCombodown.className="mstrCombodownSelected";}dropDown.togglePicker(true,cmdPicker,obj.parentNode,this);}else{this.execPicker(picker,obj);}}}catch(err){microstrategy.errors.log(err);}return false;};mstrPickerImpl.prototype.closePicker=function(e){try{dropDown.closePicker(e,this);this.targetCombodown.className="mstrCombodown";return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrPickerImpl.prototype.ondocumentclick=function(e){try{if(!e){e=window.event;}if(this.currentPicker){this.closePicker(e);}}catch(err){microstrategy.errors.log(err);alert(err);}};mstrPickerImpl.setPickerValues=function(selected,picker,filterValue){try{if(selected){selected="pkr"+selected;}var childNodes=picker.getElementsByTagName("span");for(var i=0,cnt=childNodes.length;i<cnt;i++){var c=childNodes[i];var v=true;if(filterValue){v=microstrategy.isValueInFilter(filterValue,c.getAttribute(microstrategy.HTMLATTR_FILTER_VALUE),c.getAttribute(microstrategy.HTMLATTR_FILTER_COMPARISON));var filterType=c.getAttribute(microstrategy.HTMLATTR_FILTER_TYPE);if(!filterType||filterType==0){c.style.display=(v)?"block":"none";}else{c.className=(v)?"":"disabled";}}if(v&&c.getAttribute("id")==selected){c.className="selected";picker.selected=c;}}}catch(err){microstrategy.errors.log(err);}};function mstrPickerImpl(id){this.inherits=mstrBoneImpl;this.inherits(id);this.inherits=null;return this;}
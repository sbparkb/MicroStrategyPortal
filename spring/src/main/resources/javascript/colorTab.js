mstrColorTabImplScript=true;mstrColorTabImpl.prototype=new mstrTabImpl();mstrColorTabImpl.prototype.initializing=false;mstrColorTabImpl.prototype.changeGridProperties=false;mstrColorTabImpl.prototype.isDocProps=false;mstrColorTabImpl.prototype.cmdLevel=microstrategy.FORMAT_LEVEL_FLAG_DOC;mstrColorTabImpl.prototype.onload=function(){try{this.initEditor();this.initSettings();}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.onpostswitch=function(){try{var oldInitializing=this.initializing;this.initializing=true;if(this.tabManager.targetAxis==0&&this.tabManager.targetLevel==1&&microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){microstrategy.formatType=mstrPanelStack.FMT_TYPE_TITLE;}if(this.tabManager.targetAxis==0&&this.tabManager.targetLevel==9&&microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){microstrategy.formatType=mstrGridReport.FMT_TYPE_TITLE;}this.initFillColorValues();microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;this.initializing=oldInitializing;}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);var at=this.getAppliesTo();this.changeGridProperties=(at&&at.commands.queryEnabled("onegrid")==true);this.changeGridProperties=(this.changeGridProperties&&!this.tabManager.isGridContainerSelected());this.isDocProps=((this.elem.getAttribute("isDocProp")!=null)&&(this.elem.getAttribute("isDocProp")=="true"));this.initValues();}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.initSettings=function(){try{this.settings=new Array();var props=new Array("FillColor","LeftStyle","LeftColor","TopStyle","TopColor","RightStyle","RightColor","BottomStyle","BottomColor","LineSettingStyle","LineSettingColor","LineSettingWeight");for(var i=0;i<props.length;i++){var elem=document.getElementById(this.id+props[i]);if(elem){this.settings.push(elem);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.restorePreviousSelections=function(prevSettings){try{var needToChangeBorderLevel=false;for(var settingName in prevSettings){var field=document.getElementById(this.id+settingName);if(field!=null){switch(settingName){case"LeftColor":case"TopColor":case"RightColor":case"BottomColor":needToChangeBorderLevel=true;case"LineSettingColor":case"FillColor":this.updateColorPicker(field,prevSettings[settingName]);break;case"LeftStyle":case"TopStyle":case"RightStyle":case"BottomStyle":needToChangeBorderLevel=true;case"LineSettingStyle":case"LineSettingWeight":this.updateFieldInfo(this.id+settingName,prevSettings[settingName],true);break;}}}var oldInitializing=this.initializing;this.initializing=true;if(needToChangeBorderLevel){this.initBorderLevel();}this.initializing=oldInitializing;}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.initValues=function(){try{this.initializing=true;if(this.tabManager.targetAxis==0&&this.tabManager.targetLevel==1&&microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){microstrategy.formatType=mstrPanelStack.FMT_TYPE_TITLE;}if(this.tabManager.targetAxis==0&&this.tabManager.targetLevel==9&&microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){microstrategy.formatType=mstrGridReport.FMT_TYPE_TITLE;}this.initFillColorValues();this.initBorderValues();this.initLineValues();microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.initFillColorValues=function(){try{var at=this.getAppliesTo();if(!this.changeGridProperties&&!this.isDocProps){var dropDown=document.getElementById(this.id+"FillColor");if(dropDown){if((this.isEnabled(at.commands.queryState("selectedItems"),"backgroundColor"))){this.initColorPickerValue(at,"bgcolor",this.id+"FillColor","backgroundColor");}else{this.disablePulldown(this.id+"FillColor");}}}else{if(this.changeGridProperties){var dropDown=document.getElementById(this.id+"FillColor");if(dropDown){var color=dropDown.getAttribute("color");if(color&&color.indexOf&&color.indexOf(",")>=0&&color.indexOf("rgb")<0){this.updateColorPickerGradient(dropDown.id+"|"+color);}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.handle3dUpdate=function(temp3dOn){try{this.initializing=true;this.initBorderLevel(temp3dOn);this.initLineValues(temp3dOn);this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.initBorderValues=function(){try{var at=this.getAppliesTo();var enableBorder=true;if(microstrategy.formatType!=microstrategy.FORMAT_TYPE_MAIN){enableBorder=at.commands.queryEnabled("borderLeftStyle");}var aBorders=new Array("Left","Top","Right","Bottom");if(!enableBorder){for(var i=0;i<aBorders.length;i++){this.disableObj(this.id+aBorders[i]+"Style");this.disableObj(this.id+aBorders[i]+"Color");}}else{if(!this.changeGridProperties&&!this.isDocProps){if(this.isEnabled(at.commands.queryState("selectedItems"),"borderLeftStyle")){for(var i=0;i<aBorders.length;i++){var styleObj=document.getElementById(this.id+aBorders[i]+"Style");var colorObj=document.getElementById(this.id+aBorders[i]+"Color");if(styleObj){this.initComboValue(at,aBorders[i]+"Style",this.id+aBorders[i]+"Style","true","border"+aBorders[i]+"Style");}if(colorObj){this.initColorPickerValue(at,aBorders[i]+"Color",this.id+aBorders[i]+"Color","border"+aBorders[i]+"Color");}}}}}this.initBorderLevel();}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.initLineValues=function(disableFor3d){try{var at=this.getAppliesTo();var b3d=at.commands.queryState("b3dstyle");var is3d=disableFor3d||((b3d>0)&&typeof (disableFor3d)=="undefined");var warning=document.getElementById(this.id+"_flashWarning");if(warning){warning.style.visibility=at.commands.queryEnabled("roundShapesOnly")?"visible":"hidden";}if(is3d||this.isDocProps){this.disableObj(this.id+"LineSettingStyle");this.disableObj(this.id+"LineSettingWeight");this.disablePulldown(this.id+"LineSettingColor");}else{if(!this.changeGridProperties&&!this.isDocProps&&this.isEnabled(at.commands.queryState("selectedItems"),"lineColor")){if(document.getElementById(this.id+"LineSettingColor")){this.enablePulldown(this.id+"LineSettingColor");}if(disableFor3d==null){this.initColorPickerValue(at,"LineSettingColor",this.id+"LineSettingColor","lineColor");}}else{this.disablePulldown(this.id+"LineSettingColor");}if(at.doc&&!this.changeGridProperties&&!this.isDocProps&&this.isEnabled(at.doc.selections.items,"lineWeight")){this.enableOptionAndLabel(document.getElementById(this.id+"LineSettingWeight"));}if(document.getElementById(this.id+"LineSettingWeight")&&(disableFor3d==null)){this.initTextValue(at,"LineSettingWeight",this.id+"LineSettingWeight","true","lineWeight");}if(at.doc&&!this.changeGridProperties&&!this.isDocProps&&this.isEnabled(at.doc.selections.items,"lineStyle")){this.enableOptionAndLabel(document.getElementById(this.id+"LineSettingStyle"));}var oLineStyle=document.getElementById(this.id+"LineSettingStyle");if((disableFor3d==null)&&oLineStyle){if(!at.commands.queryEnabled("squareShapesOnly")){if(at.commands.queryEnabled("anyRoundedRectangle")){for(var i=2;i<5;i++){var option=microstrategy.findChildWithAtt(oLineStyle,"option","value",i+"");if(option){oLineStyle.removeChild(option);}}}if(!at.commands.queryEnabled("shapesOnly")){var option=microstrategy.findChildWithAtt(oLineStyle,"option","value","0");if(option){oLineStyle.removeChild(option);}}}this.initComboValue(at,"LineSettingStyle",this.id+"LineSettingStyle","true","lineStyle");}}}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.disablePulldown=function(id){try{var obj=document.getElementById(id);if(obj){obj.disabled=true;if(obj.tagName.toLowerCase()!="select"){obj.className="mstrPulldowndisabled";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.enablePulldown=function(id){try{var obj=document.getElementById(id);if(obj){obj.disabled=false;if(obj.tagName.toLowerCase()!="select"){obj.className="mstrPulldown";}}}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.initBorderLevel=function(disableFor3d){try{var at=this.getAppliesTo();var obj=null;var enableBorder=true;if(microstrategy.formatType!=microstrategy.FORMAT_TYPE_MAIN){enableBorder=at.commands.queryEnabled("borderLeftStyle");}enableBorder=enableBorder&&!disableFor3d;var borderInputs=new Array();if(!this.isDocProps&&!this.changeGridProperties){if(!at.commands.queryEnabled("isSelectionsPresent")||!this.isEnabled(at.commands.queryState("selectedItems"),"borderLeftStyle")){borderInputs=new Array("border","border0","border1","border2","border3");}}var baseBorders=new Array("border","border0","border1","border2","border3",this.id+"AllStyle",this.id+"AllColor",this.id+"LeftStyle",this.id+"LeftColor",this.id+"TopStyle",this.id+"TopColor",this.id+"RightStyle",this.id+"RightColor",this.id+"BottomStyle",this.id+"BottomColor");if(!enableBorder){borderInputs=baseBorders;}for(var i=0;i<borderInputs.length;i++){obj=document.getElementById(borderInputs[i]);if(obj){if(borderInputs[i].indexOf("Style")>0||borderInputs[i].indexOf("Color")>0){this.disablePulldown(borderInputs[i]);}else{this.disableOptionAndLabel(obj);}}}if(borderInputs.length>0){return ;}borderInputs=baseBorders;for(var i=0;i<borderInputs.length;i++){obj=document.getElementById(borderInputs[i]);if(obj){if(borderInputs[i].indexOf("Style")>0||borderInputs[i].indexOf("Color")>0){this.enablePulldown(borderInputs[i]);}else{this.enableOptionAndLabel(obj);}}}var lStyle=((obj=document.getElementById(this.id+"LeftStyle"))!=null)?obj.value:"0";var rStyle=((obj=document.getElementById(this.id+"RightStyle"))!=null)?obj.value:"0";var tStyle=((obj=document.getElementById(this.id+"TopStyle"))!=null)?obj.value:"0";var bStyle=((obj=document.getElementById(this.id+"BottomStyle"))!=null)?obj.value:"0";var lColor=((obj=document.getElementById(this.id+"LeftColor"))!=null)?this.getColorPickerValue(obj):"#000000";if(lColor=="-2"){obj.value="#000000";}var rColor=((obj=document.getElementById(this.id+"RightColor"))!=null)?this.getColorPickerValue(obj):"#000000";if(rColor=="-2"){obj.value="#000000";}var tColor=((obj=document.getElementById(this.id+"TopColor"))!=null)?this.getColorPickerValue(obj):"#000000";if(tColor=="-2"){obj.value="#000000";}var bColor=((obj=document.getElementById(this.id+"BottomColor"))!=null)?this.getColorPickerValue(obj):"#000000";if(bColor=="-2"){obj.value="#000000";}if(document.getElementById("border0")!=null){obj=document.getElementById("border0");}else{if((lStyle==rStyle)&&(rStyle==tStyle)&&(tStyle==bStyle)&&(lColor==rColor)&&(rColor==tColor)&&(tColor==bColor)){if(lStyle!="0"){obj=document.getElementById("border2");this.updateFieldInfo(this.id+"AllStyle",document.getElementById(this.id+"LeftStyle").value);this.updateColorPicker(document.getElementById(this.id+"AllColor"),this.getColorPickerValue(document.getElementById(this.id+"LeftColor")),true);}else{obj=document.getElementById("border1");}}else{obj=document.getElementById("border3");}}if(obj!=null){obj.checked=true;this.updateBorderSelections(obj);this.showOptions(obj);}}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.updateColorPicker=function(obj,value){try{mstrTabImpl.prototype.updateColorPicker.call(this,obj,value,this.initializing);if(obj.getAttribute(microstrategy.HTMLATTR_CMD_ID)=="AllColor"){var allcolors=new Array("LeftColor","RightColor","TopColor","BottomColor");for(var i=0;i<allcolors.length;i++){mstrTabImpl.prototype.updateColorPicker.call(this,document.getElementById(this.id+allcolors[i]),value,this.initializing);}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.execPicker=function(picker,obj){try{var cmdId=picker.commandId;var newValue=obj.getAttribute("id").slice(3);if(newValue=="More"){var dropDown=document.getElementById(this.id+cmdId);var color=(dropDown&&dropDown.getElementsByTagName("span").length>0)?dropDown.getElementsByTagName("span")[0].style.backgroundColor:"";this.openAdvancedColorPicker(this.getAppliesTo(),cmdId,color);}else{if(newValue=="Gradients"){var dropDown=document.getElementById(this.id+cmdId);var color=dropDown.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!color){color=(dropDown&&dropDown.getElementsByTagName("span").length>0)?dropDown.getElementsByTagName("span")[0].getAttribute(microstrategy.HTMLATTR_CMD_VALUE):"";}if(!color&&this.getAppliesTo().commands&&this.getAppliesTo().commands.queryState){color=(this.getAppliesTo().commands.queryState("FillStyle")=="2")?this.getAppliesTo().commands.queryState("gradientcolor"):"";}if(!color){color=(dropDown&&dropDown.getElementsByTagName("span").length>0)?this.checkRGBColors("FillColor",dropDown.getElementsByTagName("span")[0].style.backgroundColor):"";}if(!color||color==null){color=(dropDown)?dropDown.getAttribute("color"):"";}if(color.indexOf(",")>=0){var gradientConfig=color.split(",");this.openGradientColorPicker(this.getAppliesTo(),cmdId,this.shouldRetrieveGradient(),gradientConfig[0],gradientConfig[1],gradientConfig[3],gradientConfig[4],gradientConfig[5]);}else{this.openGradientColorPicker(this.getAppliesTo(),cmdId,this.shouldRetrieveGradient(),(color<0||color=="transparent")?"#FFFFFF":color);}}else{var dropDown=document.getElementById(this.id+cmdId);if(dropDown){this.updateColorPicker(dropDown,newValue);}}}return true;}catch(err){microstrategy.errors.log(err);}return false;};mstrColorTabImpl.prototype.shouldRetrieveGradient=function(){try{if(!this.commandObj){if(microstrategy.bones.rwb_viewer){this.commandObj=microstrategy.bones.rwb_viewer.commands;}}return(this.commandObj&&this.commandObj.queryEnabled("gradientcolor")&&(!this.tabManager.isGridSelected()||this.tabManager.isGridContainerSelected()));}catch(err){microstrategy.errors.log(err);}return false;};mstrColorTabImpl.prototype.updateFieldInfo=function(fieldName,newValue,handleChange){try{var updObj=document.getElementById(fieldName);if(updObj){updObj.value=newValue;if(updObj.value!=newValue){updObj.selectedIndex=-1;}if(!this.initializing){updObj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,newValue);}if(handleChange){updObj.onchange();}}}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.getBaseColor=function(picker){try{var baseColor=null;if(picker){baseColor=picker.getAttribute("color");if(baseColor==null||baseColor.length==0){baseColor=picker.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);}if(baseColor==null||baseColor.length==0){baseColor=picker.firstChild.style.backgroundColor;}if(baseColor==null||baseColor.length==0){if(picker.firstChild.firstChild!=null){baseColor=picker.firstChild.firstChild.style.backgroundColor;baseColor=mstr.utils.Color.rgbStr2hex(baseColor);}}}if(baseColor!=null){var gradientProp=baseColor.split(",");if(gradientProp.length==6){baseColor=(gradientProp[4]==gradientProp[5])?gradientProp[0]:gradientProp[1];baseColor="#"+baseColor;}}return baseColor;}catch(err){microstrategy.errors.log(err);return null;}};mstrColorTabImpl.prototype.updateColorPickerGradient=function(value){try{mstrTabImpl.prototype.updateColorPickerGradient.call(this,value);microstrategy.eventManager.notifyOrphanBones("onfillcolorchange");}catch(err){microstrategy.errors.log(err);return null;}};mstrColorTabImpl.prototype.updateBorderSelections=function(obj){try{if(obj){var baseColor="#000000";var baseStyle="0";if(obj.value=="2"){var baseObj=document.getElementById(this.id+"LeftColor");baseColor=this.getBaseColor(baseObj);baseObj=document.getElementById(this.id+"LeftStyle");if(baseObj){baseStyle=baseObj.value;}}if(obj.value=="0"){if(document.getElementById(this.id+"LeftColor").value!="#000000"){baseColor=document.getElementById(this.id+"LeftColor").value;}else{baseColor="#000000";}if(document.getElementById(this.id+"LeftStyle").value!="0"){baseStyle=document.getElementById(this.id+"LeftStyle").value;}else{baseStyle="0";}}switch(obj.value){case"0":case"1":case"2":this.updateColorPicker(document.getElementById(this.id+"LeftColor"),baseColor);this.updateColorPicker(document.getElementById(this.id+"RightColor"),baseColor);this.updateColorPicker(document.getElementById(this.id+"TopColor"),baseColor);this.updateColorPicker(document.getElementById(this.id+"BottomColor"),baseColor);this.updateFieldInfo(this.id+"LeftStyle",baseStyle,true);this.updateFieldInfo(this.id+"RightStyle",baseStyle,true);this.updateFieldInfo(this.id+"TopStyle",baseStyle,true);this.updateFieldInfo(this.id+"BottomStyle",baseStyle,true);break;break;}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.updateList=function(obj){try{if(obj){var newFormat="";var cmdId=obj.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!this.initializing){obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,obj.value);}switch(cmdId){case"LeftStyle":this.updateFieldInfo(this.id+"AllStyle",obj.value);case"TopStyle":case"RightStyle":case"BottomStyle":if(!this.initializing){obj.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,obj.value);}break;case"AllStyle":this.updateFieldInfo(this.id+"LeftStyle",obj.value);this.updateFieldInfo(this.id+"RightStyle",obj.value);this.updateFieldInfo(this.id+"TopStyle",obj.value);this.updateFieldInfo(this.id+"BottomStyle",obj.value);break;case"LineSettingStyle":this.updateFieldInfo(this.id+"LineSettingStyle",obj.value);break;case"LineSettingWeight":this.updateFieldInfo(this.id+"LineSettingWeight",obj.value);break;default:var field=document.getElementById(this.id+cmdId);this.updateColorPicker(field,this.getColorPickerValue(obj));if(cmdId=="LeftColor"){field=document.getElementById(this.id+"AllColor");this.updateColorPicker(field,this.getColorPickerValue(obj));}break;}}}catch(err){microstrategy.errors.log(err);return false;}};function removeAttribute(objName,attrName){var obj=document.getElementById(objName);if(obj&&typeof (obj.attributes[attrName])!="undefined"){obj.attributes.removeNamedItem(attrName);}}mstrColorTabImpl.prototype.getChanges=function(){try{var __result="";var counter;for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(settingValue||(settingValue!=null&&settingName=="FillColor")){__result+='"'+settingName+'":"'+settingValue+'",';}}if(__result.length>0){__result=__result.substring(0,__result.length-1);}return __result;}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.checkForFormatChanges=function(){try{var __result=false;var counter;for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(settingValue||(settingValue!=null&&settingName=="FillColor")){return true;}}return __result;}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.cleanup=function(type){try{var dropDown=document.getElementById(this.id+"FillColor");if(dropDown){dropDown.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,null);}}catch(err){microstrategy.errors.log(err);return false;}};mstrColorTabImpl.prototype.applyFormatChanges=function(at,bulkChanges){try{var formatBulkArray=bulkChanges;var borderTop=new Array("","","");var borderBottom=new Array("","","");var borderLeft=new Array("","","");var borderRight=new Array("","","");for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(settingValue!=null){settingValue=this.checkRGBColors(settingName,settingValue);if(this.changeGridProperties==true){if(document.getElementById("border0")&&document.getElementById("border0").checked){if(settingName=="TopStyle"||settingName=="LeftStyle"||settingName=="BottomStyle"||settingName=="RightStyle"){settingValue="-2";}if(settingName=="TopColor"||settingName=="LeftColor"||settingName=="BottomColor"||settingName=="RightColor"){settingValue="-2";}}formatBulkArray.push(settingName+"|"+settingValue);if(!this.enforceSubmit){aSetting.removeAttribute(microstrategy.HTMLATTR_CMD_VALUE);}}else{switch(settingName){case"TopStyle":case"LeftStyle":case"RightStyle":case"BottomStyle":var varName="borderTop";if(settingName=="LeftStyle"){varName="borderLeft";}if(settingName=="RightStyle"){varName="borderRight";}if(settingName=="BottomStyle"){varName="borderBottom";}settingValue=mstrFormatObject.decodeValue("borderLeftStyle",settingValue);var tempValue=settingValue.split(" ");var width=tempValue[0];var style=tempValue[1];eval(varName+"[1] = width;");eval(varName+"[2] = style;");break;case"LineSettingStyle":settingValue=mstrFormatObject.decodeValue("lineStyle",settingValue);formatBulkArray.push(settingName+"|"+settingValue);break;case"LineSettingWeight":settingValue=mstrFormatObject.decodeValue("lineWeight",settingValue);formatBulkArray.push(settingName+"|"+settingValue);break;case"TopColor":case"LeftColor":case"RightColor":case"BottomColor":var varName="borderTop";if(settingName=="LeftColor"){varName="borderLeft";}if(settingName=="RightColor"){varName="borderRight";}if(settingName=="BottomColor"){varName="borderBottom";}eval(varName+"[0] = settingValue;");break;case"HasDropShadow":if(parseInt(settingValue)>0){formatBulkArray.push("dropShadowEffect|1");formatBulkArray.push("dropShadowDepth|"+settingValue);}else{formatBulkArray.push("dropShadowEffect|0");}break;default:formatBulkArray.push(settingName+"|"+settingValue);}if(!this.enforceSubmit){aSetting.removeAttribute(microstrategy.HTMLATTR_CMD_VALUE);}}}}if(this.changeGridProperties==false){if(borderTop.toString().length>2){formatBulkArray.push("borderTop|"+borderTop.toString());}if(borderBottom.toString().length>2){formatBulkArray.push("borderBottom|"+borderBottom.toString());}if(borderRight.toString().length>2){formatBulkArray.push("borderRight|"+borderRight.toString());}if(borderLeft.toString().length>2){formatBulkArray.push("borderLeft|"+borderLeft.toString());}}return formatBulkArray;}catch(err){microstrategy.errors.log(err);return bulkChanges;}};mstrColorTabImpl.prototype.applyPropertyChanges=function(propertiesArray){try{var borderTop=new Array("","","");var borderBottom=new Array("","","");var borderLeft=new Array("","","");var borderRight=new Array("","","");for(counter=0;counter<this.settings.length;counter++){var aSetting=this.settings[counter];var settingValue=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);var settingName=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_ID);var settingLevel=aSetting.getAttribute(microstrategy.HTMLATTR_CMD_LEVEL);if(!settingLevel){settingLevel=this.cmdLevel;}if(settingValue!=null){switch(settingName){case"TopStyle":case"LeftStyle":case"RightStyle":case"BottomStyle":var varName="borderTop";if(settingName=="LeftStyle"){varName="borderLeft";}if(settingName=="RightStyle"){varName="borderRight";}if(settingName=="BottomStyle"){varName="borderBottom";}settingValue=mstrFormatObject.decodeValue("borderLeftStyle",settingValue);var tempValue=settingValue.split(" ");var width=tempValue[0];var style=tempValue[1];eval(varName+"[1] = width;");eval(varName+"[2] = style;");break;case"TopColor":case"LeftColor":case"RightColor":case"BottomColor":settingValue=this.checkRGBColors(settingName,settingValue);var varName="borderTop";if(settingName=="LeftColor"){varName="borderLeft";}if(settingName=="RightColor"){varName="borderRight";}if(settingName=="BottomColor"){varName="borderBottom";}eval(varName+"[0] = settingValue;");break;case"FillColor":if(settingValue==""){settingValue="#ffffff";}default:var propChange=new this.propChangeObject(aSetting,settingName,settingValue,null,null,settingLevel);propertiesArray.push(propChange);break;}if(!this.enforceSubmit){}}}if(borderTop.toString().length>2){var propChange=new this.propChangeObject(null,"borderTop",borderTop.toString(),null,null,settingLevel);propertiesArray.push(propChange);}if(borderBottom.toString().length>2){var propChange=new this.propChangeObject(null,"borderBottom",borderBottom.toString(),null,null,settingLevel);propertiesArray.push(propChange);}if(borderRight.toString().length>2){var propChange=new this.propChangeObject(null,"borderRight",borderRight.toString(),null,null,settingLevel);propertiesArray.push(propChange);}if(borderLeft.toString().length>2){var propChange=new this.propChangeObject(null,"borderLeft",borderLeft.toString(),null,null,settingLevel);propertiesArray.push(propChange);}return propertiesArray;}catch(err){microstrategy.errors.log(err);return bulkChanges;}};function mstrColorTabImpl(id){this.inherits=mstrTabImpl;this.inherits(id);this.inherits=null;return this;}
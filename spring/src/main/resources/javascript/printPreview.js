var BROWSER_MARGIN_TOP_INCHES_DEFAULT=0.75;var BROWSER_MARGIN_BOTTOM_INCHES_DEFAULT=0.75;var BROWSER_MARGIN_LEFT_INCHES_DEFAULT=0.75;var BROWSER_MARGIN_RIGHT_INCHES_DEFAULT=0.75;var BROWSER_MARGIN_TOP_INCHES=0.75;var BROWSER_MARGIN_BOTTOM_INCHES=0.75;var BROWSER_MARGIN_LEFT_INCHES=0.75;var BROWSER_MARGIN_RIGHT_INCHES=0.75;var PAGE_HEIGHT_INCHES=11-BROWSER_MARGIN_TOP_INCHES-BROWSER_MARGIN_BOTTOM_INCHES;var PAGE_WIDTH_INCHES=8.5-BROWSER_MARGIN_LEFT_INCHES-BROWSER_MARGIN_RIGHT_INCHES;var INCLUDE_HEADER=0;var INCLUDE_FOOTER=0;var INCLUDE_COVER=0;var PAGE_ORDER_VERTICAL=1;var PAGE_MARGIN_TOP_INCHES=0.5;var PAGE_MARGIN_BOTTOM_INCHES=0.5;var PAGE_MARGIN_LEFT_INCHES=0;var PAGE_MARGIN_RIGHT_INCHES=0;var PAGE_MARGIN_TOP_INCHES_DEFAULT=0.5;var PAGE_MARGIN_BOTTOM_INCHES_DEFAULT=0.5;var PAGE_MARGIN_LEFT_INCHES_DEFAULT=0;var PAGE_MARGIN_RIGHT_INCHES_DEFAULT=0;var PADDING_PRINTAREA_X_INCHES=0.05;var PADDING_PRINTAREA_Y_INCHES=0.05;var PADDING_GRID_X_INCHES=0.25;var PADDING_GRID_Y_INCHES=0.33;var PADDING_BELOWHEADER_PIXELS=5;var MARGIN_OF_ERROR_INCHES=0.3;var REPEAT_COLUMNHEADERS=1;var REPEAT_ROWHEADERS=1;var MIN_DATA_WIDTH_INCHES=1;var MIN_DATA_HEIGHT_INCHES=1;var PIXELS_PER_INCH=72;var PIXELS_PER_INCH_MAXIMUM=96;var INDEX_FETCH_PREVIOUS=-1;var INDEX_FETCH_NEXT=-1;var INDEX_PAGEBY_NEXT=-1;var URL_FOR_FETCH_LINKS="";var DESC_LINK_NEXT="Next &gt;&gt;";var DESC_ERROR_UNABLE_TO_FIT="Unable to fit to page.  Maximum reduction will be used.";var DESC_ERROR_RENDERING="An error occurred while rendering the Preview display.  Results may not display accurately.";var GRAPH_AND_GRID_SAME_PAGE=0;var FIT_TO_PAGE_VERTICAL=0;var FIT_TO_PAGE_HORIZONTAL=0;var ZOOM_FONTS=100;var ZOOM_LIMIT=0.025;var DEFAULT_FONT_SIZE_EM=1;var COUNT_PREVIOUS_PAGES=1;var PREVIOUS_PAGES=0;var oTimer1=0;var oTimer2=0;var oTimer3=0;var oTimerCalcs=0;var oTimerRender=0;var oTimerRender2=0;var iTableCounter=0;var iCurrentPageCounter=0;var oForm=null;var oTRs=null;var rowPageBreaks,rowPageBreaksTop,colPageBreaks,colPageBreaksLeft,colHeaderPageBreaks;var rowIndexForColumnBreaks=0;var firstCellIndexForColumnBreaks=0;var aParameters=new Array;var iZoomFactorFTP=1;var STATUS_STEP_DOWNLOADREPORT=1;var STATUS_STEP_FITTOPAGE=2;var STATUS_STEP_COLBREAKS=3;var STATUS_STEP_ROWBREAKS=4;var STATUS_STEP_RENDERPAGES=5;var STATUS_STEP_FINISHED=6;function afterOnLoad(){window.print();return ;for(var i=1;i<=iCurrentPageCounter;i++){var oPageTable=getObj("table"+i);if(oPageTable){}}}function renderGraphPage(iPageNum,iTotalPagesCount,pxPageWidth,pxPageHeight,pxTopMargin,pxBottomMargin,pxLeftMargin,pxRightMargin,iPreviousPages){var bGridRendered=false;var pxOffset=pxPageHeight*iPreviousPages;var pxDivPageWidth=pxPageWidth-2*PADDING_PRINTAREA_X_INCHES*PIXELS_PER_INCH;var pxDivPageHeight=pxPageHeight-2*PADDING_PRINTAREA_Y_INCHES*PIXELS_PER_INCH;var HTML_DIV_PAGE='<DIV ID="divPage'+iTotalPagesCount+'" CLASS="pageImage" STYLE="position: absolute; overflow: hidden; width: '+pxDivPageWidth+"px; height: "+pxDivPageHeight+"px; top: "+(pxOffset+PADDING_PRINTAREA_Y_INCHES*PIXELS_PER_INCH)+"px; left: "+(PADDING_PRINTAREA_X_INCHES*PIXELS_PER_INCH)+'px;" >';var HTML_DIV_HEADER='<DIV ID="divHeader'+iTotalPagesCount+'" STYLE="width: '+(pxDivPageWidth-pxLeftMargin-pxRightMargin)+"px; height: "+pxTopMargin+'px; overflow: hidden;">';var HTML_DIV_GRID='<DIV ID="divGrid'+iTotalPagesCount+'" STYLE="width: '+(pxDivPageWidth-pxLeftMargin-pxRightMargin)+"px; height: "+(pxDivPageHeight-pxTopMargin-pxBottomMargin)+'px; overflow: hidden;">';var HTML_DIV_FOOTER='<DIV ID="divFooter'+iTotalPagesCount+'" STYLE="width: '+(pxDivPageWidth-pxLeftMargin-pxRightMargin)+"px; height: "+pxBottomMargin+'px; overflow: hidden;">';document.write(HTML_DIV_PAGE);if(pxTopMargin>0){var HTML_HEADER="";HTML_HEADER=replaceParameters(getObj("divPageHeader").innerHTML);document.write(HTML_DIV_HEADER);document.write("</DIV>");var oTemp=getObj("divHeader"+iTotalPagesCount);if(oTemp){oTemp.innerHTML=HTML_HEADER;}}document.write(HTML_DIV_GRID+" <CENTER>");var sGraphError=null;if((oForm.errorGraph)&&(oForm.errorGraph.value)){sGraphError=oForm.errorGraph.value;}if((sGraphError)&&(sGraphError!="")){document.write(sGraphError);}else{var pxGraphWidth=oForm.imageWidth;if(pxGraphWidth){pxGraphWidth=parseInt(pxGraphWidth.value);}var pxGraphHeight=oForm.imageHeight;if(pxGraphHeight){pxGraphHeight=parseInt(pxGraphHeight.value);}var sGraphURL=oForm.imageSrc;if(sGraphURL){sGraphURL=sGraphURL.value;}renderGraph(iPageNum,sGraphURL,pxGraphWidth,pxGraphHeight);if((GRAPH_AND_GRID_SAME_PAGE)&&(oTable)&&(pxGraphHeight)){if(fitToPage(1,1,pxDivPageWidth-pxRightMargin-pxLeftMargin,pxDivPageHeight-pxTopMargin-pxBottomMargin-pxGraphHeight-PADDING_GRID_Y_INCHES*PIXELS_PER_INCH-15,false)){document.write('<DIV STYLE="border: 0pt; height: 15px; visibility: hidden;"><IMG SRC="#" HEIGHT=15 WIDTH=1 ALT="" BORDER=0 ></DIV>');renderGridCopy();bGridRendered=true;}}}document.write("</CENTER> </DIV>");if(pxBottomMargin>0){var HTML_FOOTER="";HTML_FOOTER=replaceParameters(getObj("divPageFooter").innerHTML);document.write(HTML_DIV_FOOTER);document.write("</DIV>");var pxVerticalCutoff=getObjHeight("divPageFooter")-pxBottomMargin;if(pxVerticalCutoff>0){HTML_FOOTER='<DIV STYLE="position: relative; top: -'+pxVerticalCutoff+'px;">'+HTML_FOOTER+"</DIV>";}var oTemp=getObj("divFooter"+iTotalPagesCount);if(oTemp){oTemp.innerHTML=HTML_FOOTER;}}document.write("</DIV>");return(bGridRendered);}function renderGraph(iPage,sURL,pxWidth,pxHeight){document.write('<IMG SRC="'+sURL+'" WIDTH='+pxWidth+" HEIGHT="+pxHeight+' ALT="Graph" BORDER=1 >');return ;}function renderCoverPage(iTotalPagesCount,pxPageWidth,pxPageHeight,pxTopMargin,pxBottomMargin,pxLeftMargin,pxRightMargin){var pxOffset=0;var pxDivPageWidth=pxPageWidth-2*PADDING_PRINTAREA_X_INCHES*PIXELS_PER_INCH;var pxDivPageHeight=pxPageHeight-2*PADDING_PRINTAREA_Y_INCHES*PIXELS_PER_INCH;var HTML_DIV_PAGE='<DIV ID="divPage'+iTotalPagesCount+'" CLASS="pageImage" STYLE="position: absolute; overflow: hidden; width: '+pxDivPageWidth+"px; height: "+pxDivPageHeight+"px; top: "+(pxOffset+PADDING_PRINTAREA_Y_INCHES*PIXELS_PER_INCH)+"px; left: "+(PADDING_PRINTAREA_X_INCHES*PIXELS_PER_INCH)+'px;" >';var HTML_DIV_HEADER='<DIV ID="divHeader'+iTotalPagesCount+'" STYLE="width: '+(pxDivPageWidth-pxLeftMargin-pxRightMargin)+"px; height: "+pxTopMargin+'px; overflow: hidden;">';var HTML_DIV_GRID='<DIV ID="divGrid'+iTotalPagesCount+'" STYLE="width: '+(pxDivPageWidth-pxLeftMargin-pxRightMargin)+"px; height: "+(pxDivPageHeight-pxTopMargin-pxBottomMargin)+'px; overflow: hidden;">';var HTML_DIV_FOOTER='<DIV ID="divFooter'+iTotalPagesCount+'" STYLE="width: '+(pxDivPageWidth-pxLeftMargin-pxRightMargin)+"px; height: "+pxBottomMargin+'px; overflow: hidden;">';document.write(HTML_DIV_PAGE);if(pxTopMargin>0){var HTML_HEADER="";HTML_HEADER=replaceParameters(getObj("divPageHeader").innerHTML);document.write(HTML_DIV_HEADER);document.write("</DIV>");var oTemp=getObj("divHeader"+iTotalPagesCount);if(oTemp){oTemp.innerHTML=HTML_HEADER;}}document.write(HTML_DIV_GRID);var divCover=getObj("divCover");if((divCover)&&(divCover.innerHTML)){document.write(divCover.innerHTML);}document.write("</DIV>");if(pxBottomMargin>0){var HTML_FOOTER="";HTML_FOOTER=replaceParameters(getObj("divPageFooter").innerHTML);document.write(HTML_DIV_FOOTER);document.write("</DIV>");var pxVerticalCutoff=getObjHeight("divPageFooter")-pxBottomMargin;if(pxVerticalCutoff>0){HTML_FOOTER='<DIV STYLE="position: relative; top: -'+pxVerticalCutoff+'px;">'+HTML_FOOTER+"</DIV>";}var oTemp=getObj("divFooter"+iTotalPagesCount);if(oTemp){oTemp.innerHTML=HTML_FOOTER;}}document.write("</DIV>");return ;}function displayStatus(iStep,szDisplay){var IMAGE_IN_PROGRESS='<IMG SRC="images/stepInProgress.gif" WIDTH="20" HEIGHT="16" ALT="" BORDER="0" />';var IMAGE_DONE='<IMG SRC="images/stepDone.gif" WIDTH="20" HEIGHT="16" ALT="" BORDER="0" />';var oST=getObj("StatusTable");if(!oST){return ;}if(iStep==STATUS_STEP_FINISHED){oST=document.getElementById("StatusTable").style;oST.display="none";}else{oST.rows[iStep].childNodes[0].innerHTML=IMAGE_IN_PROGRESS;for(var row=iStep-1;row>0;row--){oST.rows[row].childNodes[0].innerHTML=IMAGE_DONE;}oST=document.getElementById("StatusTable").style;}return ;}function fitToPage(bHorizontal,bVertical,pxPageAreaWidth,pxPageAreaHeight,bUseMaximumReduction){var iZoomH=1;var iZoomV=1;var iZoom=1;var iOriginalWidth=0;var iOriginalHeight=0;var lOriginalColWidths=null;var lOriginalRowHeights=null;var bFit=true;iOriginalWidth=getObjWidth(oTable);iOriginalHeight=getObjHeight(oTable);if(bHorizontal){if(iOriginalWidth>pxPageAreaWidth){iZoomH=pxPageAreaWidth/iOriginalWidth;}}if(bVertical){if(iOriginalHeight>pxPageAreaHeight){iZoomV=pxPageAreaHeight/iOriginalHeight;}}if(iZoomV<iZoomH){iZoom=iZoomV;}else{iZoom=iZoomH;}if(iZoom>=1){return(bFit);}if(oTable.style.tableLayout=="fixed"){var oResults=switchToFixedLayout(oTable);lOriginalColWidths=oResults[0];lOriginalRowHeights=oResults[1];}var resultArray=fitToPageIterative(pxPageAreaWidth,pxPageAreaHeight,iZoom,iOriginalWidth,iOriginalHeight,lOriginalColWidths,lOriginalRowHeights,bHorizontal,bVertical);bFit=resultArray[0];iZoomFactorFTP=resultArray[1];if((!bFit)&&(!bUseMaximumReduction)){iZoomFactorFTP=ZOOM_FONTS/100;setZoom(ZOOM_FONTS,iOriginalWidth,iOriginalHeight,lOriginalColWidths,lOriginalRowHeights,ZOOM_FONTS);}return(bFit);}function fitToPageIterative(pxPageAreaWidth,pxPageAreaHeight,iStartZoomFactor,iOriginalWidth,iOriginalHeight,lOriginalColWidths,lOriginalRowHeights,bHorizontal,bVertical){var bFit=false;var iZoom=iStartZoomFactor*ZOOM_FONTS/100;if((iZoom>ZOOM_LIMIT)&&(iZoom<1)){do{setZoom(iZoom*100,iOriginalWidth,iOriginalHeight,lOriginalColWidths,lOriginalRowHeights,DEFAULT_FONT_SIZE_EM*100);bFit=true;if(bHorizontal){if(getObjWidth(oTable)>pxPageAreaWidth){bFit=false;}}if(bFit){if(bVertical){if(getObjHeight(oTable)>pxPageAreaHeight){bFit=false;}}}if(bFit){break;}if(iZoom<=ZOOM_LIMIT){break;}iZoom-=ZOOM_LIMIT;}while(iZoom>ZOOM_LIMIT);}return(Array(bFit,iZoom));}function outerHTML(oNode){var sResult="";var szNoWrap="";var szClassName="";var szBeginNOBR="";var szEndNOBR="";if(oNode){szClassName=oNode.className;if(!szClassName){szClassName="";}if(oNode.getAttribute("NOWRAP")){szNoWrap=' NOWRAP="1" ';szBeginNOBR="<NOBR>";szEndNOBR="</NOBR>";}}sResult="<TD "+szNoWrap+'CLASS="'+szClassName+'" ROWSPAN="'+util_parseRowSpan(oNode,1)+'" COLSPAN="'+util_parseSpan(oNode,1)+'" >';return(sResult+szBeginNOBR+oNode.innerHTML+szEndNOBR+"</TD>");}function setZoom(iZoom,iOriginalWidth,iOriginalHeight,lOriginalColWidths,lOriginalRowHeights,iOriginalZoom){if((!oTable)||(!(oTable.style))){return ;}oTable.style.fontSize=(iZoom/100)+"em";if((lOriginalColWidths)&&(lOriginalColWidths.length)){var oCOLTags=oTable.getElementsByTagName("COL");if(oCOLTags){for(var i=0;i<oCOLTags.length;i++){oCOLTags[i].style.width=lOriginalColWidths[i]*iZoom/iOriginalZoom;}}}if((lOriginalRowHeights)&&(lOriginalRowHeights.length)&&(oTable.rows)){var iRows=oTable.rows.length;for(var i=0;i<iRows;i++){oTable.rows[i].style.height=(lOriginalRowHeights[i]*iZoom/iOriginalZoom)+"px";}}oTable.style.width=(iOriginalWidth*iZoom/iOriginalZoom)+"px";var pxWidth=getObjWidth(oTable);oTable.style.height=(iOriginalHeight*pxWidth/iOriginalWidth)+"px";return ;}function main(){displayStatus(STATUS_STEP_FITTOPAGE,"");var bGridRendered=false;if((oForm.imageSrc)&&(oForm.imageSrc.value)){iCurrentPageCounter++;aParameters=[[/\&amp\;\[Page\]/g,iCurrentPageCounter+PREVIOUS_PAGES]];bGridRendered=renderGraphPage(iCurrentPageCounter,iCurrentPageCounter,PAGE_WIDTH_INCHES*PIXELS_PER_INCH,PAGE_HEIGHT_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_TOP_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_BOTTOM_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_LEFT_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_RIGHT_INCHES*PIXELS_PER_INCH,iCurrentPageCounter-1);}if((!oTable)||(bGridRendered)){return ;}var pxWidthLimit=PAGE_WIDTH_INCHES-PAGE_MARGIN_LEFT_INCHES-PAGE_MARGIN_RIGHT_INCHES-(PADDING_GRID_X_INCHES+PADDING_PRINTAREA_X_INCHES)*2;pxWidthLimit=pxWidthLimit*PIXELS_PER_INCH;var pxHeightLimit=PAGE_HEIGHT_INCHES-(PADDING_PRINTAREA_Y_INCHES+PADDING_GRID_Y_INCHES)*2;if(INCLUDE_HEADER){if(PAGE_MARGIN_TOP_INCHES>pxHeightLimit-MIN_DATA_HEIGHT_INCHES){PAGE_MARGIN_TOP_INCHES=pxHeightLimit-MIN_DATA_HEIGHT_INCHES;if(PAGE_MARGIN_TOP_INCHES<0){PAGE_MARGIN_TOP_INCHES=0;}}}if(INCLUDE_FOOTER){if(PAGE_MARGIN_BOTTOM_INCHES>pxHeightLimit-MIN_DATA_HEIGHT_INCHES){PAGE_MARGIN_BOTTOM_INCHES=pxHeightLimit-MIN_DATA_HEIGHT_INCHES;if(PAGE_MARGIN_BOTTOM_INCHES<0){PAGE_MARGIN_BOTTOM_INCHES=0;}}}if(INCLUDE_HEADER){pxHeightLimit-=PAGE_MARGIN_TOP_INCHES;}if(INCLUDE_FOOTER){pxHeightLimit-=PAGE_MARGIN_BOTTOM_INCHES;}if(pxHeightLimit<MIN_DATA_HEIGHT_INCHES){if(INCLUDE_HEADER&&INCLUDE_FOOTER){PAGE_MARGIN_TOP_INCHES-=(MIN_DATA_HEIGHT_INCHES-pxHeightLimit)/2;if(PAGE_MARGIN_TOP_INCHES<0){PAGE_MARGIN_TOP_INCHES=0;}PAGE_MARGIN_BOTTOM_INCHES-=(MIN_DATA_HEIGHT_INCHES-pxHeightLimit)/2;if(PAGE_MARGIN_BOTTOM_INCHES<0){PAGE_MARGIN_BOTTOM_INCHES=0;}}else{if(INCLUDE_HEADER){PAGE_MARGIN_TOP_INCHES-=MIN_DATA_HEIGHT_INCHES-pxHeightLimit;if(PAGE_MARGIN_TOP_INCHES<0){PAGE_MARGIN_TOP_INCHES=0;}}else{if(INCLUDE_FOOTER){PAGE_MARGIN_BOTTOM_INCHES-=MIN_DATA_HEIGHT_INCHES-pxHeightLimit;if(PAGE_MARGIN_BOTTOM_INCHES<0){PAGE_MARGIN_BOTTOM_INCHES=0;}}else{BROWSER_MARGIN_TOP_INCHES-=(MIN_DATA_HEIGHT_INCHES-pxHeightLimit)/2;if(BROWSER_MARGIN_TOP_INCHES<0){BROWSER_MARGIN_TOP_INCHES=0;}BROWSER_MARGIN_BOTTOM_INCHES-=(MIN_DATA_HEIGHT_INCHES-pxHeightLimit)/2;if(BROWSER_MARGIN_BOTTOM_INCHES<0){BROWSER_MARGIN_BOTTOM_INCHES=0;}}}}pxHeightLimit=MIN_DATA_HEIGHT_INCHES;}pxHeightLimit=pxHeightLimit*PIXELS_PER_INCH;var divReport=getObj("divReport");if(divReport){divReport.style.width=pxWidthLimit+"px";}if(ZOOM_FONTS!=DEFAULT_FONT_SIZE_EM*100){var iOriginalWidth=getObjWidth(oTable);var iOriginalHeight=getObjHeight(oTable);var lOriginalRowHeights=null;var lOriginalColWidths=null;if(oTable.style.tableLayout=="fixed"){var oResults=switchToFixedLayout(oTable);lOriginalColWidths=oResults[0];lOriginalRowHeights=oResults[1];}setZoom(ZOOM_FONTS,iOriginalWidth,iOriginalHeight,lOriginalColWidths,lOriginalRowHeights,DEFAULT_FONT_SIZE_EM*100);}if(!fitToPage(FIT_TO_PAGE_HORIZONTAL,FIT_TO_PAGE_VERTICAL,pxWidthLimit,pxHeightLimit,true)){alert(DESC_ERROR_UNABLE_TO_FIT);}else{if(FIT_TO_PAGE_HORIZONTAL){REPEAT_ROWHEADERS=0;}if(FIT_TO_PAGE_VERTICAL){REPEAT_COLUMNHEADERS=0;}}var iRepeatRows,iTotalRows,pxRepeatRowsHeight;var resultsArray=getRepeatRows();var iRealRepeatRows=resultsArray[0];iRepeatRows=resultsArray[0];iTotalRows=resultsArray[1];pxRepeatRowsHeight=resultsArray[2];var iRepeatCols,iTotalCols,pxRepeatColsWidth;resultsArray=getRepeatCols(iRepeatRows);iRepeatCols=resultsArray[0];iTotalCols=resultsArray[1];pxRepeatColsWidth=resultsArray[2];if(iRepeatRows==iTotalRows){REPEAT_COLUMNHEADERS=0;}if(iRepeatCols==iTotalCols){REPEAT_ROWHEADERS=0;}if(REPEAT_ROWHEADERS){pxWidthLimit-=pxRepeatColsWidth;if(pxWidthLimit<MIN_DATA_WIDTH_INCHES*PIXELS_PER_INCH){REPEAT_ROWHEADERS=0;pxWidthLimit+=pxRepeatColsWidth;pxRepeatColsWidth=0;}}displayStatus(STATUS_STEP_COLBREAKS,"");if(!getColumnBreaks(iRepeatRows,iTotalRows,iRepeatCols,iTotalCols,pxWidthLimit)){if(REPEAT_ROWHEADERS){pxWidthLimit+=pxRepeatColsWidth;REPEAT_ROWHEADERS=0;pxRepeatColsWidth=0;getColumnBreaks(iRepeatRows,iTotalRows,iRepeatCols,iTotalCols,pxWidthLimit);}}if(iRepeatRows>0){if(iRepeatRows<iTotalRows){pxRepeatRowsHeight=getObjSumTop(oTRs[iRepeatRows])-getObjSumTop(oTable);}else{pxRepeatRowsHeight=getObjHeight(oTable);}}if(REPEAT_COLUMNHEADERS){pxHeightLimit-=pxRepeatRowsHeight;if(pxHeightLimit<MIN_DATA_HEIGHT_INCHES*PIXELS_PER_INCH){REPEAT_COLUMNHEADERS=0;pxHeightLimit+=pxRepeatRowsHeight;pxRepeatRowsHeight=0;}}displayStatus(STATUS_STEP_ROWBREAKS,"");getRowBreaks(iRepeatRows,iRepeatCols,iTotalRows,iTotalCols,pxHeightLimit);var iAllPages=(rowPageBreaks.length-1)*(colPageBreaks.length-1);var bSkipBottomPages=false;if((INDEX_FETCH_NEXT>1)&&(rowPageBreaks.length>2)){INDEX_FETCH_NEXT-=iTotalRows-rowPageBreaks[rowPageBreaks.length-1];bSkipBottomPages=true;}switchToFixedLayout(oTable);displayStatus(STATUS_STEP_RENDERPAGES,"");var aDateTime=getLocaleDateTimeStrings();var pxFooterHeight=getObjHeight("divPageFooter");var htmlHeader=getObj("divPageHeader").innerHTML;var htmlFooter=getObj("divPageFooter").innerHTML;var pxTableHeight=getObjHeight(oTable);var pxTableWidth=getObjWidth(oTable);for(var i=1;i<=iAllPages;i++){if(bSkipBottomPages){if(PAGE_ORDER_VERTICAL){bSkip=(i%(rowPageBreaks.length-1)==0);}else{bSkip=(i>(rowPageBreaks.length-2)*(colPageBreaks.length-1));}}else{bSkip=false;}if(!bSkip){iCurrentPageCounter++;aParameters=[[/\&amp\;\[Page\]/g,iCurrentPageCounter+PREVIOUS_PAGES]];renderPage(i,iCurrentPageCounter,iRepeatRows,iRepeatCols,iTotalRows,iTotalCols,PAGE_WIDTH_INCHES*PIXELS_PER_INCH,PAGE_HEIGHT_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_TOP_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_BOTTOM_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_LEFT_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_RIGHT_INCHES*PIXELS_PER_INCH,iCurrentPageCounter-1,pxFooterHeight,htmlHeader,htmlFooter,pxTableHeight,pxTableWidth);}}return ;}function breakColumnHeaders(indexRow,indexCell,iRepeatRows,iRepeatCols,iTotalCols,px,bCheckForResize){var splitCounter=0;var splitCellRows=new Array;var colHeaderBreaks=new Array;var resultArray;var iStartRow=iRepeatRows-1;if(indexRow<iStartRow){iStartRow=indexRow-1;}for(var row=iStartRow;row>-1;row--){var col,lColumnCounterHeader,lColumnCounterCell;resultArray=columnHeaderIndexForCell(indexRow,indexCell,row,iTotalCols);col=resultArray[0];lColumnCounterHeader=resultArray[1];lColumnCounterCell=resultArray[2];if(col<0){alert(DESC_ERROR_RENDERING+"["+indexRow+","+indexCell+"]");break;}colHeaderBreaks[row]=col;if(lColumnCounterHeader<lColumnCounterCell){splitCounter++;splitCellRows[splitCounter]=row;splitCell(row,col,lColumnCounterCell-lColumnCounterHeader);colHeaderBreaks[row]++;if(bCheckForResize){if(getObjSumLeft(oTRs[row].childNodes[col+1])>px){for(var i=1;i<=splitCounter;i++){mergeCells(splitCellRows[i],colHeaderBreaks[splitCellRows[i]]-1);}indexCell-=lColumnCounterCell-lColumnCounterHeader;break;}}}}return(Array(indexCell,colHeaderBreaks));}function getColumnBreaks(iRepeatRows,iTotalRows,iRepeatCols,iTotalCols,pxWidthLimit){var iPage=1;var px=0;var resultArray;var indexRow=longestDataRowIndex(oTable,iRepeatRows,iTotalRows);var indexLastCell=oTRs[indexRow].childNodes.length-1;var indexFirstCell=0;if(iRepeatCols>0){if(indexRow>=iRepeatRows){indexFirstCell=firstNonRepeatCellInRow(indexRow,iRepeatCols,iTotalCols);}else{indexFirstCell=lastRepeatColHeaderInRow(oTable,indexRow)+1;}}var indexCell=indexFirstCell;colPageBreaks=new Array;colHeaderPageBreaks=new Array;colPageBreaksLeft=new Array;rowIndexForColumnBreaks=indexRow;if(REPEAT_ROWHEADERS){colPageBreaks[1]=0;}else{colPageBreaks[1]=-indexFirstCell;indexCell=0;}colPageBreaksLeft[0]=getObjSumLeft(oTable);colPageBreaksLeft[1]=null;if(colPageBreaks[1]+indexFirstCell>-1){if(colPageBreaks[1]+indexFirstCell<oTRs[indexRow].childNodes.length){colPageBreaksLeft[1]=getObjSumLeft(oTRs[indexRow].childNodes[colPageBreaks[1]+indexFirstCell]);}else{colPageBreaksLeft[1]=getObjWidth(oTable);}}colHeaderPageBreaks[1]=getFirstNonRepeatColumnHeaders(iRepeatRows,iRepeatCols,REPEAT_ROWHEADERS);do{px=getObjSumLeft(oTRs[indexRow].childNodes[indexCell])+pxWidthLimit;indexCell=firstCellBeyond(px,indexRow,indexCell+1,indexLastCell,true);if(indexCell<=colPageBreaks[iPage]+indexFirstCell){if(REPEAT_ROWHEADERS&&(iRepeatCols>0)&&(iPage==1)){return(false);}else{indexCell++;}}if(indexCell>indexLastCell){break;}iPage++;colPageBreaks[iPage]=indexCell-indexFirstCell;colPageBreaksLeft[iPage]=null;if(indexCell>-1){if(indexCell<oTRs[indexRow].childNodes.length){colPageBreaksLeft[iPage]=getObjSumLeft(oTRs[indexRow].childNodes[indexCell]);}else{colPageBreaksLeft[iPage]=getObjWidth(oTable);}}var colHeaderIndices;var bContinue=false;do{bContinue=false;if(indexCell>=indexFirstCell){resultArray=breakColumnHeaders(indexRow,indexCell,iRepeatRows,iRepeatCols,iTotalCols,px,true);}else{resultArray=splitRepeatCol(indexRow,indexCell,iRepeatRows,iRepeatCols,iTotalCols,px,true);}indexCell=resultArray[0];colHeaderIndices=resultArray[1];if(indexCell<colPageBreaks[iPage]+indexFirstCell){if(indexCell<=colPageBreaks[iPage-1]+indexFirstCell){indexCell=colPageBreaks[iPage]+indexFirstCell;if(indexCell>=indexFirstCell){resultArray=breakColumnHeaders(indexRow,indexCell,iRepeatRows,iRepeatCols,0,false);}else{resultArray=splitRepeatCol(indexRow,indexCell,iRepeatRows,iRepeatCols,iTotalCols,0,false);}indexCell=resultArray[0];colHeaderIndices=resultArray[1];}else{colPageBreaks[iPage]=indexCell-indexFirstCell;bContinue=true;}}}while(bContinue);colHeaderPageBreaks[iPage]=colHeaderIndices;colPageBreaksLeft[iPage]=null;if(indexCell>-1){if(indexCell<oTRs[indexRow].childNodes.length){colPageBreaksLeft[iPage]=getObjSumLeft(oTRs[indexRow].childNodes[indexCell]);}else{colPageBreaksLeft[iPage]=getObjWidth(oTable);}}}while(indexCell<=indexLastCell);return(true);}function supermain(){if(COUNT_PREVIOUS_PAGES){PREVIOUS_PAGES=getPreviousPageCount();}PIXELS_PER_INCH=getPixelsPerInch();ZOOM_FONTS=ZOOM_FONTS*DEFAULT_FONT_SIZE_EM;iZoomFactorFTP=ZOOM_FONTS/100;var aDateTime=getLocaleDateTimeStrings();if((PAGE_WIDTH_INCHES-PAGE_MARGIN_LEFT_INCHES-PAGE_MARGIN_RIGHT_INCHES-(PADDING_GRID_X_INCHES+PADDING_PRINTAREA_X_INCHES)*2)<=MIN_DATA_WIDTH_INCHES){PAGE_WIDTH_INCHES=PAGE_WIDTH_INCHES+BROWSER_MARGIN_LEFT_INCHES+BROWSER_MARGIN_RIGHT_INCHES;PAGE_MARGIN_LEFT_INCHES=PAGE_MARGIN_LEFT_INCHES_DEFAULT;PAGE_MARGIN_RIGHT_INCHES=PAGE_MARGIN_RIGHT_INCHES_DEFAULT;var maxBrowserMarginLeft=PAGE_WIDTH_INCHES-BROWSER_MARGIN_RIGHT_INCHES_DEFAULT-PAGE_MARGIN_LEFT_INCHES-PAGE_MARGIN_RIGHT_INCHES-(PADDING_GRID_X_INCHES+PADDING_PRINTAREA_X_INCHES)*2-MIN_DATA_WIDTH_INCHES;BROWSER_MARGIN_LEFT_INCHES=Math.min(BROWSER_MARGIN_LEFT_INCHES,maxBrowserMarginLeft);var maxBrowserMarginRight=maxBrowserMarginLeft-BROWSER_MARGIN_LEFT_INCHES;BROWSER_MARGIN_RIGHT_INCHES=Math.min(BROWSER_MARGIN_RIGHT_INCHES,maxBrowserMarginRight);PAGE_WIDTH_INCHES=PAGE_WIDTH_INCHES-BROWSER_MARGIN_LEFT_INCHES-BROWSER_MARGIN_RIGHT_INCHES;}var pxHeightAvailable=PAGE_HEIGHT_INCHES-(PADDING_PRINTAREA_Y_INCHES+PADDING_GRID_Y_INCHES)*2;if(pxHeightAvailable<=MIN_DATA_HEIGHT_INCHES){PAGE_HEIGHT_INCHES=PAGE_HEIGHT_INCHES+BROWSER_MARGIN_TOP_INCHES+BROWSER_MARGIN_BOTTOM_INCHES;BROWSER_MARGIN_TOP_INCHES=BROWSER_MARGIN_TOP_INCHES_DEFAULT;BROWSER_MARGIN_BOTTOM_INCHES=BROWSER_MARGIN_BOTTOM_INCHES_DEFAULT;PAGE_HEIGHT_INCHES=PAGE_HEIGHT_INCHES-BROWSER_MARGIN_TOP_INCHES-BROWSER_MARGIN_BOTTOM_INCHES;}var pxWidthLimit=PAGE_WIDTH_INCHES-PAGE_MARGIN_LEFT_INCHES-PAGE_MARGIN_RIGHT_INCHES-(PADDING_GRID_X_INCHES+PADDING_PRINTAREA_X_INCHES)*2;pxWidthLimit=pxWidthLimit*PIXELS_PER_INCH;if(INCLUDE_HEADER){var objH=getObj("divPageHeader");if(objH){objH.style.width=pxWidthLimit+"px";}aParameters=[[/\&amp\;\[Date\]/g,aDateTime[0]],[/\&amp\;\[Time\]/g,aDateTime[1]]];objH.innerHTML=replaceParameters(objH.innerHTML);var pxHH=getObjHeight("divPageHeader");if((pxHH)&&((pxHH+PADDING_BELOWHEADER_PIXELS)/PIXELS_PER_INCH<PAGE_MARGIN_TOP_INCHES)){PAGE_MARGIN_TOP_INCHES=(pxHH+PADDING_BELOWHEADER_PIXELS)/PIXELS_PER_INCH;}}else{PAGE_MARGIN_TOP_INCHES=0;}if(INCLUDE_FOOTER){var objF=getObj("divPageFooter");if(objF){objF.style.width=pxWidthLimit+"px";}aParameters=[[/\&amp\;\[Date\]/g,aDateTime[0]],[/\&amp\;\[Time\]/g,aDateTime[1]]];objF.innerHTML=replaceParameters(objF.innerHTML);var pxFH=getObjHeight("divPageFooter");if((pxFH)&&((pxFH/PIXELS_PER_INCH)<PAGE_MARGIN_BOTTOM_INCHES)){PAGE_MARGIN_BOTTOM_INCHES=(pxFH/PIXELS_PER_INCH);}}else{PAGE_MARGIN_BOTTOM_INCHES=0;}do{oTRs=null;oTable=null;oForm=null;iTableCounter++;oForm=eval("document.formReport"+iTableCounter);oTable=getObj("UniqueReportID"+iTableCounter);if(oTable){oTRs=oTable.rows;}if(oForm){if((iTableCounter==1)&&(INCLUDE_COVER)){iCurrentPageCounter++;aParameters=[[/\&amp\;\[Page\]/g,iCurrentPageCounter+PREVIOUS_PAGES]];renderCoverPage(iCurrentPageCounter,PAGE_WIDTH_INCHES*PIXELS_PER_INCH,PAGE_HEIGHT_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_TOP_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_BOTTOM_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_LEFT_INCHES*PIXELS_PER_INCH,PAGE_MARGIN_RIGHT_INCHES*PIXELS_PER_INCH);}main();}}while(oForm);renderFetchLinks(iCurrentPageCounter*PAGE_HEIGHT_INCHES*PIXELS_PER_INCH-30,PAGE_WIDTH_INCHES*PIXELS_PER_INCH+30,INDEX_FETCH_PREVIOUS,INDEX_FETCH_NEXT,INDEX_PAGEBY_NEXT,DESC_LINK_NEXT);renderFetchLinks(30,PAGE_WIDTH_INCHES*PIXELS_PER_INCH+30,INDEX_FETCH_PREVIOUS,INDEX_FETCH_NEXT,INDEX_PAGEBY_NEXT,DESC_LINK_NEXT);if((INCLUDE_FOOTER)||(INCLUDE_HEADER)){for(var i=1;i<=iCurrentPageCounter;i++){var sRE=/\&amp\;\[NPages\]/g;var oDiv=getObj("divHeader"+i);var sTotalPages=getTotalPagesCount(iCurrentPageCounter);if(oDiv){oDiv.innerHTML=getObj("divHeader"+i).innerHTML.replace(sRE,sTotalPages);}oDiv=getObj("divFooter"+i);if(oDiv){oDiv.innerHTML=getObj("divFooter"+i).innerHTML.replace(sRE,sTotalPages);}}}function setObjHeight(vObject,iHeight){var obj=getObj(vObject);var iNewHeight=parseInt(iHeight);if(obj&&!isNaN(iNewHeight)){obj.style.height=iNewHeight+"px";}}function setObjWidth(vObject,iWidth){var obj=getObj(vObject);var iNewWidth=parseInt(iWidth);if(obj&&!isNaN(iNewWidth)){obj.style.width=iNewWidth+"px";}}if((top)&&(top.bar)){top.bar(iCurrentPageCounter,PAGE_WIDTH_INCHES*PIXELS_PER_INCH,PAGE_HEIGHT_INCHES*PIXELS_PER_INCH,setObjHeight,setObjWidth);}return ;}function renderFetchLinks(pxTop,pxLeft,indexPrevious,indexNext,indexPageByNext,szNextLinkText){if(indexPrevious+indexNext==-2){return ;}document.write('<DIV CLASS="divFetchLinks" STYLE="position: absolute; top: '+pxTop+"px; left: "+pxLeft+'px;">');document.write('<TABLE BORDER="0" CELLSPACING="4"><TR>');if(indexPrevious>-1){document.write('<TD NOWRAP="1" CLASS="fetchLink3s">');document.write('<A HREF="#?index='+indexPrevious+'">&lt;&lt; Previous</A>&nbsp;&nbsp;</TD>');}var sURL="";if((URL_FOR_FETCH_LINKS)&&(URL_FOR_FETCH_LINKS!="")){sURL=updateParamInURL(URL_FOR_FETCH_LINKS,"startRow",indexNext);sURL=updateParamInURL(sURL,"ppg",iCurrentPageCounter+PREVIOUS_PAGES);}else{if((indexNext!=-1)||(indexPageByNext!=-1)){var sQS=document.location.search;if(indexNext!=-1){sQS=updateParamInURL(sQS,"startRow",indexNext);}if(indexPageByNext!=-1){sQS=updateParamInURL(sQS,"sPageByOrdinal",indexPageByNext);}sQS=updateParamInURL(sQS,"ppg",iCurrentPageCounter+PREVIOUS_PAGES);sURL=document.location.href;var indexQuestionMark=sURL.indexOf("?");if(indexQuestionMark>0){sURL=sURL.substring(0,indexQuestionMark);}sURL+=sQS;}}if(sURL!=""){document.write('<TD NOWRAP="1" CLASS="fetchLinks">');document.write('<FONT SIZE="2">');document.write('<A HREF="'+sURL+'">'+szNextLinkText+"</A></TD>");document.write("</FONT>");}document.write("</TR></TABLE></DIV>");return ;}function updateParamInURL(sQS,sParam,sNewValue){var sNewQS=sQS;var i=sQS.indexOf(sParam+"=");if(i>-1){var j=sQS.indexOf("&",i);sNewQS="";if(i>0){sNewQS+=sQS.substring(0,i);}sNewQS+=sParam+"="+sNewValue;if(j>-1){sNewQS+=sQS.substr(j);}}else{sNewQS=sQS+"&"+sParam+"="+sNewValue;}return(sNewQS);}function getPixelsPerInch(){var ppi=getObjWidth("divOneInch");if(PIXELS_PER_INCH_MAXIMUM&&(PIXELS_PER_INCH_MAXIMUM>0)&&(ppi>PIXELS_PER_INCH_MAXIMUM)){ppi=PIXELS_PER_INCH_MAXIMUM;}return ppi;}function replaceParameters(thisString){var result=thisString;for(var i=0;i<aParameters.length;i++){result=result.replace(aParameters[i][0],aParameters[i][1]);}return(result);}function renderPage(iPageNum,iTotalPagesCount,iRepeatRows,iRepeatCols,iTotalRows,iTotalCols,pxPageWidth,pxPageHeight,pxTopMargin,pxBottomMargin,pxLeftMargin,pxRightMargin,iPreviousPages,pxFooterHeight,htmlHeader,htmlFooter,pxTableHeight,pxTableWidth){var pxOffset=pxPageHeight*iPreviousPages;var szPageBreak="";var pxDivPageWidth=pxPageWidth-2*PADDING_PRINTAREA_X_INCHES*PIXELS_PER_INCH;var pxDivPageHeight=pxPageHeight-2*PADDING_PRINTAREA_Y_INCHES*PIXELS_PER_INCH;var HTML_DIV_PAGE='<DIV ID="divPage'+iTotalPagesCount+'" CLASS="pageImage" STYLE="position: absolute; overflow: hidden; width: '+pxDivPageWidth+"px; height: "+pxDivPageHeight+"px; top: "+(pxOffset+PADDING_PRINTAREA_Y_INCHES*PIXELS_PER_INCH)+"px; left: "+(PADDING_PRINTAREA_X_INCHES*PIXELS_PER_INCH)+'px;" >';var HTML_DIV_HEADER='<DIV ID="divHeader'+iTotalPagesCount+'" STYLE="width: '+(pxDivPageWidth-pxLeftMargin-pxRightMargin)+"px; height: "+pxTopMargin+'px; overflow: hidden;">';var HTML_DIV_GRID='<DIV ID="divGrid'+iTotalPagesCount+'" STYLE="width: '+(pxDivPageWidth-pxLeftMargin-pxRightMargin)+"px; height: "+(pxDivPageHeight-pxTopMargin-pxBottomMargin)+'px; overflow: hidden;">';var HTML_DIV_FOOTER='<DIV ID="divFooter'+iTotalPagesCount+'" STYLE="width: '+(pxDivPageWidth-pxLeftMargin-pxRightMargin)+"px; height: "+pxBottomMargin+'px; overflow: hidden;">';document.write(HTML_DIV_PAGE);if(pxTopMargin>0){var HTML_HEADER="";HTML_HEADER=replaceParameters(htmlHeader);document.write(HTML_DIV_HEADER);document.write("</DIV>");var oTemp=getObj("divHeader"+iTotalPagesCount);if(oTemp){oTemp.innerHTML=HTML_HEADER;}}document.write(HTML_DIV_GRID);renderGridPage(iPageNum,iRepeatRows,iRepeatCols,iTotalRows,iTotalCols,iTotalPagesCount,pxLeftMargin,pxTopMargin+pxOffset,pxTableHeight,pxTableWidth);document.write("</DIV>");if(pxBottomMargin>0){var HTML_FOOTER="";HTML_FOOTER=replaceParameters(htmlFooter);document.write(HTML_DIV_FOOTER);document.write("</DIV>");var pxVerticalCutoff=pxFooterHeight-pxBottomMargin;if(pxVerticalCutoff>0){HTML_FOOTER='<DIV STYLE="position: relative; top: -'+pxVerticalCutoff+'px;">'+HTML_FOOTER+"</DIV>";}var oTemp=getObj("divFooter"+iTotalPagesCount);if(oTemp){oTemp.innerHTML=HTML_FOOTER;}}document.write("</DIV>");return ;}function getLocaleDateTimeStrings(){var HRS_13_MINS_1_SEC_1_MS_1=((13*60+1)*60+1)*1000+1;var HRS_24=(24*60*60*1000);var szDate="";var szTime="";var d=new Date;var ds=d.toLocaleString();var aOriginal=ds.split(" ");var d2=new Date(d.valueOf()+HRS_13_MINS_1_SEC_1_MS_1);if(d2.getDate()!=d.getDate()){d2=new Date(d2.valueOf()-HRS_24);}var ds2=d2.toLocaleString();var aTest=ds2.split(" ");var j=-1;for(var i=1;i<aOriginal.length;i++){if(aOriginal[i]!=aTest[i]){j=i;break;}}if(j>0){for(var i=0;i<j-1;i++){szDate+=aOriginal[i]+" ";}szDate+=aOriginal[j-1];}if(j>-1){for(var i=j;i<aOriginal.length-1;i++){szTime+=aOriginal[i]+" ";}szTime+=aOriginal[aOriginal.length-1];}return(Array(szDate,szTime));}function switchToFixedLayout(oT){if(!((oT)&&(oT.rows)&&(oT.rows.length>0))){return ;}var iRows=oT.rows.length;var iColumns=getCols(oT);if((!iRows)||(!iColumns)){return ;}var oldHeights=new Array;for(var i=0;i<iRows;i++){oldHeights[i]=getObjHeight(oT.rows[i]);}var iFixedCols=getFixedCols(oT);var iFixedRows=getFixedRows(oT);var oCOLTags=oT.getElementsByTagName("COL");var oldWidths=new Array;oldWidths=getColumnWidthsArraySubtractive(oT,oCOLTags,iColumns,iFixedRows,iFixedCols);oT.style.tableLayout="fixed";oT.style.width="";if(oT.width){oT.width="";}for(var i=0;i<iRows;i++){oT.rows[i].style.height=oldHeights[i]+"px";}initCOLTags(oT,iColumns);oCOLTags=oT.getElementsByTagName("COL");if(oCOLTags){for(var i=0;i<oCOLTags.length;i++){oCOLTags[i].style.width=oldWidths[i];}}return([oldWidths,oldHeights]);}function getCols(oT){var iCols=0;if((oT.rows)&&(oT.rows.length>0)){var iCells=oT.rows[0].cells.length;if(iCells>0){iCols=sumColumnCountForCell(oT,0,iCells-1);}}return(iCols);}function getPreviousPageCount(){var iCount=0;var sQS=String(document.location.search);var iStartIndex=sQS.indexOf("?ppg=");if(iStartIndex<0){iStartIndex=sQS.indexOf("&ppg=");}if(iStartIndex>-1){var iEndIndex=sQS.indexOf("&",iStartIndex+1);if(iEndIndex>0){var iPPG=parseInt(sQS.substr(iStartIndex+5,iEndIndex-1));}else{var iPPG=parseInt(sQS.substr(iStartIndex+5));}if(!isNaN(iPPG)){iCount=iPPG;}}return(iCount);}function getTotalPagesCount(iPagesInCurrentBlock){switch(COUNT_PREVIOUS_PAGES){case (1):return(iPagesInCurrentBlock+PREVIOUS_PAGES);case (2):if(isFinalBlockOfPages()){return(iPagesInCurrentBlock+PREVIOUS_PAGES);}else{return("?");}default:return(iPagesInCurrentBlock);}}function isFinalBlockOfPages(){if((URL_FOR_FETCH_LINKS)&&(URL_FOR_FETCH_LINKS!="")){return(false);}else{if((INDEX_FETCH_NEXT!=-1)||(INDEX_PAGEBY_NEXT!=-1)){return(false);}}return(true);}
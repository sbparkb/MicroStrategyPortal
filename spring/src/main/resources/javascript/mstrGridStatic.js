mstrGridStaticScript=true;var mstrGrid=mstrGridStatic;mstrGridStatic.prototype=new mstrRWUnitBoneImpl();mstrGridStatic.prototype.useLockset=false;mstrGridStatic.prototype.lockSet=null;mstrGridStatic.prototype.commands=null;mstrGridStatic.prototype.isGridBone=true;mstrGridStatic.prototype.isGridPostLoaded=false;mstrGridStatic.prototype.hasResized=false;mstrGridStatic.prototype.emptyCase=false;mstrGridStatic.prototype.lockHeadersInitialized=false;mstrGridStatic.prototype.titleBarObj=null;mstrGridStatic.prototype.isTitleVisible=false;mstrGridStatic.prototype.wait=null;mstrGridStatic.prototype.isGridStatic=true;mstrGridStatic.prototype.onload=function(){try{mstrRWUnitBoneImpl.prototype.onload.call(this);if(!this.elem){return ;}this.wait=document.getElementById(this.id+"_wait");this.commands=new mstrGridStaticCommands(this);this.observer=microstrategy.observer||new mstrObserverImpl();microstrategy.observer=this.observer;var _tmp=this.isGridStatic&&this.initGrid();}catch(err){microstrategy.errors.log(err);}};mstrGridStatic.prototype.onpostload=function(){try{mstrRWUnitBoneImpl.prototype.onpostload.call(this);if(this.lockSet){this.onresize();}this.isGridPostLoaded=true;}catch(err){microstrategy.errors.log(err);}};mstrGridStatic.prototype.onresize=function(){try{this.resizeLockSet();if(this.isGridPostLoaded){this.hasResized=true;}}catch(err){microstrategy.errors.log(err);}};mstrGridStatic.prototype.initGrid=function(){try{if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var rwdObj=microstrategy.findAncestor(this.elem.parentNode);if(rwdObj!=null&&microstrategy.styleObj){this.gridPosition=parseInt(microstrategy.styleObj.getAttValue(rwdObj,microstrategy.HTMLATTR_GRID_POS));this.gridArea=parseInt(microstrategy.styleObj.getAttValue(rwdObj,microstrategy.HTMLATTR_GRID_AREA_PCT))/100;}}this.emptyCase=(this.elem.getAttribute("ept")=="-1");if(this.isGridBone&&!this.emptyCase){var me=this;window.setTimeout(function(){me.initLockHeaders();me.resizeLockSet();},100);if(bIsIE6){this.forcerepaint(document.getElementById("ReportFrame"));}}this.hasResized=false;if(bIsIE7){window.setTimeout("microstrategy.bone('"+this.id+"'). forcerepaint();",0);}}catch(err){microstrategy.errors.log(err);}};mstrGridStatic.prototype.initLockHeaders=function(){try{if(!this.useLockset){return ;}var prefix=this.id;var gridBox=document.getElementById(prefix);var divLock4=document.getElementById(prefix+"divLock4");if(gridBox&&divLock4){divLock4.style.overflow="visible";this.lockSet=new mstrLockSet(gridBox,divLock4,this);if(!this.lockSet.initialized){return ;}this.lockSet.addScrollEventHandler();divLock4.style.overflow="auto";}this.LockHeadersInitialized=true;window.setTimeout("microstrategy.repaintContent('"+this.id+"');",0);window.setTimeout("microstrategy.bone('"+this.id+"'). hideWait();",0);}catch(err){microstrategy.errors.log(err);}};mstrGridStatic.prototype.hideWait=function(){if(this.wait){this.wait.style.display="none";}};mstrGridStatic.prototype.showWait=function(){if(this.wait){this.wait.style.display="block";}};mstrGridStatic.prototype.forcerepaint=function(el){try{var i=document.createElement("img");el=el||this.elem;el.appendChild(i);i.parentNode.removeChild(i);}catch(err){microstrategy.errors.log(err);}};mstrGridStatic.prototype.resizeLockSet=function(replace){try{if(!this.lockSet){return ;}if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var containerNode=microstrategy.findAncestor(this.elem.parentNode),bm=mstr.utils.BoxModel;if(containerNode){var w=bm.getElementInnerWidth(containerNode)+((mstr.utils.ISIE8||mstr.utils.ISIE9||mstr.utils.ISIE10)?2:0),h=bm.getElementInnerHeight(containerNode)+(mstr.utils.ISIE?1:0);if(w<=0&&h<=0){return ;}w=Math.max(w,mstrLockSet.MINIMUM_GRID_WIDTH);h=Math.max(h,mstrLockSet.MINIMUM_GRID_HEIGHT);if(this.isGrid&&this.isGraph){if(this.gridPosition<2){h=Math.round(h*this.gridArea);}else{w=Math.round(w*this.gridArea);}}var titleHeight=(this.isGridStatic)?0:this.getTitleHeight(),finalHeight=Math.max((h-titleHeight-(this.incfetchvisible?26:0)),0);var heightMode=parseInt(microstrategy.styleObj.getAttValue(containerNode,microstrategy.HTMLATTR_HEIGHT_MODE));if(heightMode===microstrategy.AUTO_MODE){var divLock4=document.getElementById(this.id+"divLock4");if(divLock4){finalHeight+=Math.max(divLock4.scrollHeight-divLock4.clientHeight,0);window.setTimeout(function(){divLock4.style.height="auto";},0);}}this.lockSet.resize(replace,w,finalHeight);}else{this.lockSet.resize(replace,mstrLockSet.MINIMUM_GRID_WIDTH,mstrLockSet.MINIMUM_GRID_HEIGHT);}}else{this.lockSet.resize(replace);}}catch(err){microstrategy.errors.log(err);}};mstrGridStatic.prototype.getFixedRows=function(){try{return this.getFixedHeaders(0);}catch(err){microstrategy.errors.log(err);}return 0;};mstrGridStatic.prototype.getFixedColumns=function(){try{return this.getFixedHeaders(1);}catch(err){microstrategy.errors.log(err);}return 0;};mstrGridStatic.prototype.getFixedHeaders=function(whichHeader){try{var numFixedHeaders=0;var divLock4=document.getElementById(this.id+"divLock4");if(!divLock4){return numFixedHeaders;}var i,cnt;var rows=divLock4.getElementsByTagName("tbody")[0].rows;if(whichHeader==0){for(i=0,cnt=rows.length;i<cnt;i++){var tr=rows[i];if(tr.getAttribute("o")){break;}numFixedHeaders++;}}else{var cols=rows[0].cells;for(i=0,cnt=cols.length;i<cnt;i++){var td=cols[i];if(td.getAttribute("upt")||td.getAttribute("i")){break;}var colSpan=parseInt(td.getAttribute("colSpan"));numFixedHeaders+=colSpan||1;}}return numFixedHeaders;}catch(err){microstrategy.errors.log(err);return 0;}};mstrGridStatic.prototype.onstatechange=function(){if(this.observer){this.observer.notifyAll("onstatechange");}};mstrGridStatic.isGraphCommand=function(cmdId){switch(cmdId){case"majorPicker":case"minorPicker":case"major":case"minor":case"legend":case"dValues":case"seriesByColumn":case"seriesByRow":case"maxCategories":case"maxSeries":case"CategoriesSeries":case"FormatGraphUniversal":case"fmtSubTargets":case"numSubTargets":case"gfeField":case"majorType":case"minorType":case"curvedLines":case"mainCat":case"subCat":case"seriesLayout":case"seriesLabels":case"antiAliasing":case"roundedEffect":case"lockFontSize":case"showSubtotals":case"fontName":case"fontSize":case"textBoldItalic":case"textBold":case"textItalic":case"textUnderline":case"textStrikeout":case"fontColor":case"fillColor":case"lineColor":case"bevelType":case"areaAlpha":case"show":case"dataTextShow":case"titlePosition":case"titleContent":case"titleOriContent":case"tooltipsShow":case"tooltipsEditor":case"tooltipsEditor_ie":case"tooltipsEditor_ie_ScatterBubble":case"gridIntervalX":case"gridIntervalY1":case"gridIntervalY2":case"gridIntervalZ":case"maxScaleX":case"minScaleX":case"maxScaleY1":case"minScaleY1":case"maxScaleY2":case"minScaleY2":case"maxScaleZ":case"minScaleZ":case"maxScaleCKX":case"minScaleCKX":case"maxScaleCKY1":case"minScaleCKY1":case"maxScaleCKY2":case"minScaleCKY2":case"maxScaleCKZ":case"minScaleCKZ":case"gridIntervalCKX":case"gridIntervalCKY1":case"gridIntervalCKY2":case"gridIntervalCKZ":case"dualAxisAuto":case"dualOptionItems":case"seriesLabels":case"gfnCat":case"gfnTime":case"gfnFraction":case"gfnDate":case"gfnDecimalPlaces":case"gfnCurrencySymbol":case"gfnCurrencyPosition":case"gfnNegativeNumbers":case"gfnThousandSeparator":case"gfnFormat":case"gaugeStyle":case"gaugeNeedleStyle":case"gaugeBorderStyle":case"gaugeBorderThick":case"gaugeRangeThick":case"gaugeStartAngle":case"gaugeStopAngle":case"ResetGFEStatus":case"openGraphFormatter":case"getDefaultVal":case"tbGraphValueSelector":case"isGraphPropertiesReady":case"gaugeQBShow":case"seriesLineColor":case"seriesLineStyle":case"seriesLineThickness":case"lineAlpha":case"seriesLineAlpha":case"seriesLineAlphaText":case"markerShow":case"markerShape":case"markerBevelType":case"markerSize":case"markerColor":case"markerAlphaText":case"markerBorderColor":case"markerBorderStyle":case"markerBorderThickness":case"markerBorderAlpha":case"markerBorderAlphaText":case"maxBarSizeType":case"maxBarSizeValue":case"textFormatField_visible":case"seriesLineFormatField_visible":case"seriesAreaFormatField_visible":case"markerFormatField_visible":case"increfillColor":case"decreFillColor":case"increDecreColorField":case"isIncreDecreItem":return true;default:return false;}};mstrGridStatic.isGridGraphCommand=function(cmdId){switch(cmdId){case"font":case"FontFamily":case"fsize":case"FontSize":case"color":case"FontColor":case"fstyle":case"Bold":case"Italic":case"Underline":case"FillColor":case"bgcolor":case"lncolor":case"TextAlign":case"number":case"align":case"Currency":case"deltaDecimal":case"IncreaseDecimal":case"DecreaseDecimal":case"IntlCurrency":case"Percent":case"Comma":case"borders":case"lnstyle":case"FillColor_vf":case"lncolor_vf":return true;default:return false;}};mstrGridStatic.isMouseOverScrollBar=function(obj,lMouseX,lMouseY){try{var de=document.documentElement,deScrollLeft=de.scrollLeft,deScrollTop=de.scrollTop;var __result=false;if(!mstr.utils.ISW3C&&obj.componentFromPoint){return obj.componentFromPoint(lMouseX-deScrollLeft,lMouseY-deScrollTop).indexOf("scroll")>-1;}else{if((getObjOuterWidth(obj)-getObjInnerWidth(obj)>(SCROLLBAR_SIZE-2))||(getObjOuterHeight(obj)-getObjInnerHeight(obj)>(SCROLLBAR_SIZE-2))){var scrollTop=0,scrollLeft=0;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var docViewer=microstrategy.getViewerBone().elem;scrollTop=docViewer.scrollTop;scrollLeft=docViewer.scrollLeft;}else{var cn=document.getElementById("mstrWebContents"),scrollLeft=cn&&cn.scrollLeft||0;scrollTop=cn&&cn.scrollTop||0;}if((lMouseX>getObjSumLeft(obj)+getObjInnerWidth(obj)-scrollLeft)||(lMouseY>getObjSumTop(obj)+getObjInnerHeight(obj)-scrollTop)){return true;}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrGridStatic.prototype.getSelectionData=function(attId){var s=this.selectionData;if(!s||!s.attl){return ;}if(attId){return s.attl[attId];}for(var k in s.attl){return s.attl[k];}};mstrGridStatic.prototype.getAllSelectionData=function(){return this.selectionData;};mstrGridStatic.prototype.saveCustomProps=function(value){var ac=new Array();var um=microstrategy.updateManager;if(microstrategy.EXECUTION_SCOPE==microstrategy.RWD_EXECUTION){var mstrUpdateManager=window.parent.mstrUpdateManager;var propData=this.objId+mstrUpdateManager.UNIT_SEPARATOR+"Visualization"+mstrUpdateManager.UNIT_SEPARATOR+"CustomProps"+mstrUpdateManager.UNIT_SEPARATOR+value;ac.push(um.createActionObject(null,mstrUpdateManager.EDIT_PROPS,microstrategy.bone("rwb_viewer").beanPath,["2048018","2048035"],["false",propData],[]));}else{this.setReportProp("Visualization","CustomProps",value,ac);}um.add(ac);};mstrGridStatic.prototype.getCustomProperties=function(){return this.customProps;};mstrGridStatic.prototype.getVisProperties=function(){return this.visProps;};function mstrGridStatic(id){this.inherits=mstrRWUnitBoneImpl;this.inherits(id);delete this.inherits;this.primaryBone=true;return this;}mstrGridStaticCommands.prototype={};mstrGridStaticCommands.prototype.exec=function(cmdId,cmdVal1,cmdVal2,cmdVal3,cmdVal4){var um=microstrategy.updateManager;switch(cmdId){case"addToHistoryList":this.sendUMAction(um,um.createActionObject(null,mstrUpdateManager.ADD_HISTORY_LIST,this.parentBone.beanPath,[],[],[]));break;case"openReportFrameElement":this.sendUMAction(um,um.createActionObject(this.elem,mstrUpdateManager.OPEN_FRAME_ELEMENT,this.parentBone.beanPath,["6034"],[cmdVal1],[]));break;case"allObjects":microstrategy.toggleAccordion(microstrategy.ACCORDION_REPORT_ALL_OBJECT_PANEL);return true;case"objBrowser":microstrategy.toggleAccordion(microstrategy.ACCORDION_REPORT_RP_OBJECT_PANEL);return true;case"relatedReportsPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_REPORT_RELATED_RP_PANEL);return true;case"notesPanel":microstrategy.toggleAccordion(microstrategy.ACCORDION_REPORT_NOTES_PANEL);return true;case"reportDetails":microstrategy.toggleEditor("reportDetails_ReportDetailsPanelStyle","reportDetails");return true;case"new":this.sendUMAction(um,um.createActionObject(this.elem,mstrUpdateManager.REPORT_NEW,microstrategy.servletName,[],[],[]),true);break;case"ncSendNow":case"subs":case"mobileSubs":case"ncSubs":case"ncFileSubs":case"ncCacheSubs":case"ncFtpSubs":case"ncPrintSubs":toggleShowBean(cmdId,true);break;case"reset":this.sendUMAction(um,um.createActionObject(this.elem,mstrUpdateManager.REPORT_EVENT_RESET,this.parentBone.beanPath,[],[],[]));break;case"rerun":this.exec("refresh",false,true);break;case"refresh":cmdVal1=cmdVal1||false;cmdVal2=cmdVal2||false;this.sendUMAction(um,um.createActionObject(this.elem,mstrUpdateManager.REPORT_EVENT_REFRESH,this.parentBone.beanPath,["4136","4145"],[cmdVal1,cmdVal2],[]),cmdVal1);break;case"reprompt":this.exec("refresh",true,false);break;case"reportDetailsPage":var um=microstrategy.updateManager,sid=this.parentBone.stateID,mid=this.parentBone.messageID;mid=mid!=undefined?mid:microstrategy.bones.ReportFrame.reportProps.messageID;sid=sid!=undefined?sid:microstrategy.bones.ReportFrame.reportProps.stateID;this.sendUMAction(um,um.createActionObject(this.elem,mstrUpdateManager.REPORT_DETAILS_PAGE,microstrategy.servletName,["3015","3010","3016"],[sid,mid,"0"],[]),true);break;case"createPersonalView":toggleShowBean("pvsubs",true);break;case"ShowSharingEditor":var pb=this.parentBone,isBlank=pb.isReportBlank,state=pb.stateID,$ID="sharingEditor",sharingEditor=window.mstrmojo&&mstrmojo.all[$ID],isLinkDirty=!(sharingEditor&&sharingEditor.lastState===state),viewMode=-1,viewModeChanged=false;if(pb.isGrid&&pb.isGraph){viewMode=microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;}else{if(pb.isGrid){viewMode=microstrategy.DISPLAY_MODE_GRID;}else{if(pb.isGraph){viewMode=microstrategy.DISPLAY_MODE_GRAPH;}}}viewModeChanged=!(sharingEditor&&viewMode===sharingEditor.viewMode);isLinkDirty=isLinkDirty||viewModeChanged;if(isBlank){showMessage({contents:microstrategy.descriptors.getDescriptor("14120"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"mstr.$obj('"+this.parentBone.id+"').commands.exec('dmSaveAs', {origin:"+microstrategy.SAVE_AS_SHARE_EDITOR+"});",buttonLabels:{Ok:microstrategy.descriptors.getDescriptor("118")},type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.showSharingEditor(null,{viewMode:viewMode,lastState:state},isLinkDirty);}break;default:microstrategy.errors.log("cmdId: "+cmdId+" "+microstrategy.descriptors.getDescriptor("2950"));}};mstrGridStaticCommands.prototype.sendUMAction=function(um,action,notUseIframe){um.add([action]);um.useIframe=!notUseIframe;um.flushAndSubmitChanges();};mstrGridStaticCommands.prototype.queryEnabled=function(cmdId){try{switch(cmdId){case"relatedReportsPanel":case"notesPanel":case"new":case"reportDetails":case"refresh":case"reprompt":case"reset":case"reportDetailsPage":case"ShowSharingEditor":case"openHome":return true;case"rerun":return this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ENABLE_REEXECUTE);case"addToHistoryList":return mstr.behaviors.featureResolver.featAvailable("enable-add-history-list");case"createPersonalView":case"subs":return this.parentBone.isFeatureAvailable(microstrategy.FEATURE_ENABLE_SCHEDULING);case"subscribeToMenu":var fr=mstr.behaviors.featureResolver;return fr.featAvailable("nc-enabled")&&(fr.featAvailable("scheduling")||(fr.featAvailable("is-viewable-report")&&(fr.featAvailable("use-mobile")||fr.featAvailable("scheduled-email")||fr.featAvailable("scheduled-file-export-menu")||fr.featAvailable("scheduled-print-menu"))));default:return false;}}catch(err){microstrategy.errors.log(err);return false;}};mstrGridStaticCommands.prototype.queryState=function(cmdId,cmdValue){try{switch(cmdId){case"visualizationMode":case"XTabView":if(this.parentBone.isVisualization){return this.parentBone.visualizationMode;}case"XTabViewDHTML":var __result=microstrategy.DISPLAY_MODE_GRID;if(this.parentBone.effectiveView){__result=this.parentBone.effectiveView;}else{if(this.parentBone.isGrid&&this.parentBone.isGraph){__result=microstrategy.DISPLAY_MODE_GRID_AND_GRAPH;}else{if(this.parentBone.isGraph){__result=microstrategy.DISPLAY_MODE_GRAPH;}}}return __result;case"fixedRows":return this.parentBone.getFixedRows();case"fixedColumns":return this.parentBone.getFixedColumns();case"reportDetails":return !!microstrategy.bone("reportDetails_ReportDetailsPanelStyle");case"notesPanel":bone=microstrategy.bone("accordion_AccordionTabManagerStyle");return(bone&&bone.currentTabName==microstrategy.ACCORDION_REPORT_NOTES_PANEL);case"relatedReportsPanel":bone=microstrategy.bone("accordion_AccordionTabManagerStyle");return(bone&&bone.currentTabName==microstrategy.ACCORDION_REPORT_RELATED_RP_PANEL);}}catch(err){microstrategy.errors.log(err);}return"";};mstrGridStaticCommands.prototype.queryVisible=function(cmdId){switch(cmdId){case"tbLoading":return false;case"forwardPicker":case"backPicker":case"openPage":return microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE;case"subscribeToMenu":return this.queryEnabled(cmdId);default:return true;}};function mstrGridStaticCommands(parentBone){this.parentBone=parentBone;return this;}
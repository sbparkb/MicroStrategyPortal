mstrReportAllObjectsImplScript=true;mstrReportAllObjectsImpl.prototype=new mstrProjectBrowserImpl();mstrReportAllObjectsImpl.prototype.ancestorsID=null;mstrReportAllObjectsImpl.prototype.ancestorsList=null;mstrReportAllObjectsImpl.prototype.browseEventID=null;mstrReportAllObjectsImpl.prototype.searchEventID=null;mstrReportAllObjectsImpl.prototype.treeView=null;mstrReportAllObjectsImpl.prototype.treeDiv=null;mstrReportAllObjectsImpl.prototype.searchBox=null;mstrReportAllObjectsImpl.prototype.searchArg=null;mstrReportAllObjectsImpl.prototype.contentsArea=null;mstrReportAllObjectsImpl.prototype.searchNodeID=null;mstrReportAllObjectsImpl.prototype.canToggleDisplay=false;mstrReportAllObjectsImpl.prototype.onload=function(e){try{mstrProjectBrowserImpl.prototype.onload.call(this,e);this.adjustTopCotainer=false;this.treeDiv=microstrategy.subObjectFind(this.elem,["DIV"],microstrategy.SUBOBJTYPE_TREE_VIEW);this.selections=new mstrReportAllObjSelectionsImpl();this.selections.parentBone=this;this.selections.path="microstrategy.bone('"+this.id+"').selections";if(this.ancestorsID){this.ancestorsList=microstrategy.findChildWithAtt(this.elem,"select","name",this.ancestorsID);if(this.ancestorsList){if(this.treeDiv){this.ancestorsList.onchange=new Function("e","return microstrategy.bone('"+this.id+"').selectAncestor(e);");}else{this.ancestorsList.onchange=new Function("e","return microstrategy.bone('"+this.id+"').openAncestor(e);");}}}this.searchIcon=microstrategy.findChildWithAtt(this.elem,"input","id","search");this.searchArg=microstrategy.findChildWithAtt(this.elem,"input","id","searchArg");if(this.searchIcon){this.searchIcon.onclick=new Function("e","return microstrategy.bone('"+this.id+"').onsearch(e);");this.renderSearchSettings();}this.contentsArea=microstrategy.findChildWithAtt(this.elem,"div",microstrategy.HTMLATTR_SUBOBJTYPE,"fileList").firstChild;this.initTreeView();var accordionTabManager=microstrategy.findAncestorWithAtt(this.elem,"scriptClass","mstrAccordionTabManagerImpl");if(accordionTabManager){this.tabManager=microstrategy.findBone(accordionTabManager);}if(this.treeView){if(this.shouldScrollToSearchNode&&this.treeView.scrollSearchNodeIntoView){this.treeView.scrollSearchNodeIntoView();this.shouldScrollToSearchNode=false;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.onreload=function(){try{mstrBoneImpl.prototype.onreload.call(this);var ancestorsListDiv=this.ancestorsList.parentNode;if(ancestorsListDiv){var treeRequestInput=microstrategy.findChildWithAtt(ancestorsListDiv,"input","name","isTreeRequest");var searchEventInput=microstrategy.findChildWithAtt(ancestorsListDiv,"input",this.browseEventID,"1");if(treeRequestInput){ancestorsListDiv.removeChild(treeRequestInput);}if(searchEventInput){ancestorsListDiv.removeChild(searchEventInput);}}if(this.treeView&&this.treeView.onreload){this.treeView.onreload();if(this.shouldScrollToSearchNode&&this.treeView.scrollSearchNodeIntoView){this.treeView.scrollSearchNodeIntoView();this.shouldScrollToSearchNode=false;}}var scrollNode=document.getElementById("scrollNode");if(scrollNode){if(this.treeView){this.treeView.elem.parentNode.scrollTop=scrollNode.offsetTop;}scrollNode.id="";}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.renderSearchSettings=function(){try{if(this.searchIcon){this.elExcludeShortcut=microstrategy.findChildWithAtt(this.elem,"input","id","excludeShortcut");if(this.elExcludeShortcut){this.excludeShorcut=this.elExcludeShortcut.value;}var elSearchDiv=this.searchIcon.parentNode,elArrow=document.getElementById("search-setting-icon");if(!elArrow){elArrow=document.createElement("span");elArrow.id="search-setting-icon";elArrow.className="search-setting-icon";elArrow.onclick=new Function("e","return microstrategy.bone('"+this.id+"').toggleSearchPulldown(e);");elArrow.innerHTML='<div class="search-setting-pulldown"></div>';elSearchDiv.appendChild(elArrow);}this.elArrow=elArrow;this.elSearchPulldown=elArrow.firstChild;this.elSearchPulldown.innerHTML='<div class="search-setting-pulldown-item'+(this.excludeShorcut=="true"?" on":"")+'" t="ss">'+microstrategy.descriptors.getDescriptor(11754)+"</div>";this.elSearchPulldown.onclick=new Function("e","return microstrategy.bone('"+this.id+"').toggleSearchPulldownSelection(e);");this.searchSettingVisible=false;}}catch(err){microstrategy.errors.log(err);}};mstrReportAllObjectsImpl.prototype.toggleSearchPulldown=function(e){try{var el=getEventTarget(e);if(microstrategy.findAncestorWithAtt(el,"id","search-setting-icon")&&el.id!="search-setting-icon"){return false;}var el=this.elArrow;if(el){this.searchSettingVisible=!this.searchSettingVisible;el.className=el.className.replace(" on","")+(this.searchSettingVisible?" on":"");this.elSearchPulldown.style.width=this.searchArg.style.width;}}catch(err){microstrategy.errors.log(err);}};mstrReportAllObjectsImpl.prototype.toggleSearchPulldownSelection=function(e){try{var el=this.elSearchPulldown;if(el){var tgt=getEventTarget(e);if(tgt.getAttribute("t")!="ss"){tgt=tgt.parentNode;}if(tgt.getAttribute("t")=="ss"){var on=/ on/.test(tgt.className);tgt.className=tgt.className.replace(" on","")+(on?"":" on");this.elExcludeShortcut.value=!on;microstrategy.updateCookieSetting("exs",this.elExcludeShortcut.value);microstrategy.updateBrowserSetting("exs",this.elExcludeShortcut.value);if(mstr.utils.String.trim(this.searchArg.value).length>0){this.searchIcon.click();}}stopEventBubbling(e);cancelEvent(e);}}catch(err){microstrategy.errors.log(err);}};mstrReportAllObjectsImpl.prototype.ondocumentclick=function(e){try{mstrObjectBrowserImpl.prototype.ondocumentclick.call(this,e);e=e||window.event;if(this.searchSettingVisible){this.toggleSearchPulldown(e);}}catch(err){microstrategy.errors.log(err);}};mstrReportAllObjectsImpl.prototype.onforcerepaint=function(){try{var parent=microstrategy.findAncestor(this.elem);if(parent&&parent.parentNode){parent=parent.parentNode;var i=document.createElement("img");parent.appendChild(i);i.parentNode.removeChild(i);}if(this.treeView&&this.treeView.onforcerepaint){this.treeView.onforcerepaint();}}catch(err){microstrategy.errors.log(err);}};mstrReportAllObjectsImpl.prototype.openAncestor=function(e){submitForm(findTargetTag(this.createInput(this.browseEventID,"true"),"form"));};mstrReportAllObjectsImpl.prototype.selectAncestor=function(){try{if(this.ancestorsList!=null){var optionsAncestor=this.getOptionsPath();var node=this.getNodeBasedOnSelectedOption(optionsAncestor);if(node!=null){node.parentNode.id="scrollNode";if(this.treeView.util_unselectNodes){this.treeView.util_unselectNodes(node,this.treeDiv);}if(this.treeView.util_markNodeAsSelected){this.treeView.util_markNodeAsSelected(node);}if(this.treeView.util_processNode){this.treeView.hideTreeWaitMessage();this.treeView.util_processNode(node,this.treeView.elem);}if(!itemIsInView(node,this.contentsArea)){node.scrollIntoView();}}else{if(this.treeView.currentlySelectedNode){if(this.treeView.util_markNodeAsUnselected(this.treeView.currentlySelectedNode)){}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.getOptionsPath=function(){try{var selectedOption=this.ancestorsList.options[this.ancestorsList.selectedIndex];var optionsPath=new Array();while(selectedOption&&selectedOption.level>0){optionsPath.push(selectedOption);selectedOption=selectedOption.previousSibling;}if(selectedOption){optionsPath.push(selectedOption);}var optionsAncestor=new Array();for(var i=0;i<optionsPath.length;i++){var tempOption=new Object();tempOption.did=(optionsPath[i].isSearch)?this.searchNodeID:optionsPath[i].value;tempOption.isSysLink=optionsPath[i].getAttribute("isLink");optionsAncestor.push(tempOption);if(typeof (optionsPath[i].elementId)!="undefined"){var newOption=new Object();newOption.did=optionsPath[i].elementId;newOption.isSysLink=null;optionsAncestor.push(newOption);}}return optionsAncestor;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.getNodeBasedOnSelectedOption=function(optionsAncestor){try{var nodes=microstrategy.findChildrenWithAtt(this.treeDiv,"li","did",optionsAncestor[0].did);var node=null;for(var i=0;i<nodes.length;i++){var ancestors=this.treeView.findFolderPaths(nodes[i]);if(ancestors.length==optionsAncestor.length||ancestors.length==(optionsAncestor.length-1)){var sameAncestorPaths=true;for(var j=0;j<ancestors.length;j++){if((ancestors[j].getAttribute("did")!=optionsAncestor[j].did)||(ancestors[j].getAttribute("isSysLink")!=optionsAncestor[j].isSysLink)){sameAncestorPaths=false;break;}}if(sameAncestorPaths){node=nodes[i];break;}}}return node;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.createInput=function(name,value){var pNode=this.ancestorsList.parentNode;var newNode=document.createElement("input");newNode.setAttribute("id",name);newNode.setAttribute("name",name);newNode.setAttribute("value",value);newNode.setAttribute("type","hidden");pNode.appendChild(newNode);return newNode;};mstrReportAllObjectsImpl.prototype.initTreeView=function(){try{if(this.treeDiv!=null){this.treeView=new mstrAllObjectBrowserTreeImpl(this.treeDiv.getAttribute("id"));this.treeView.parentBone=this;this.treeView.path="microstrategy.bone('"+this.id+"').treeView";this.treeView.searchNodeID=this.searchNodeID;this.treeDiv.onclick=new Function("e","microstrategy.bone('"+this.id+"').onClickTree(e); return false;");if(this.treeView.onload){this.treeView.onload();}var selectedAnchor=microstrategy.findChildWithAtt(this.treeDiv,"a",(bIsW3C)?"class":"className","toBeMarked");if(selectedAnchor){this.treeView.util_markNodeAsSelected(selectedAnchor.parentNode.parentNode,false,true);}var searchLiTag=microstrategy.findChildWithAtt(this.elem,"li","did",this.searchNodeID);if(searchLiTag){this.treeView.searchNode=searchLiTag.parentNode;}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.onClickTree=function(e){try{if(!e){e=window.event;}if(e.ctrlKey){if(e.stopPropagation){e.stopPropagation();}e.cancelBubble=true;}e.shouldExpand=true;this.treeView.onClickTree(e);}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.onmousedown=function(e){try{if(!e){e=window.event;}var obj=getEventTarget(e);if(obj){if(obj.tagName.toLowerCase()=="li"){obj=obj.firstChild;}if(obj.tagName.toLowerCase()=="span"&&obj.getAttribute("id")){if(!this.isTargetingFilter||obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)!="hi"){return this.updateSelections(e,obj);}}else{if(obj.tagName.toLowerCase()=="a"||obj.tagName.toLowerCase()=="span"){if(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_FOLDER){this.openFolder(obj.getAttribute(microstrategy.HTMLATTR_DSS_ID));}else{var itemLeaf=microstrategy.findParentWithTag(obj,"li");if(itemLeaf){obj=itemLeaf.firstChild;}else{if(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)=="hi"){return this.updateSelections(e,obj);}else{obj=obj.parentNode;}}if(obj.tagName.toLowerCase()=="span"&&obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)&&obj.getAttribute("id")){if(!this.isTargetingFilter){return this.updateSelections(e,obj);}}else{if(obj.nextSibling&&obj.nextSibling.tagName&&obj.nextSibling.tagName.toLowerCase()=="span"){obj=obj.nextSibling;if(obj.getAttribute(microstrategy.HTMLATTR_OBJTYPE)&&obj.getAttribute("id")){if(!this.isTargetingFilter){return this.updateSelections(e,obj);}}}}}}else{if(obj.tagName.toLowerCase()=="div"&&this.isTypeElementOrAttribute(obj)){var spanObj=microstrategy.findChildWithAtt(obj,"span",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_ATTRIBUTE);if(spanObj==null){spanObj=microstrategy.findChildWithAtt(obj,"span",microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_ELEMENT);}if(spanObj!=null&&spanObj.getAttribute("id")){return this.updateSelections(e,spanObj);}}else{if(this.selections){if(e.ctrlKey&&bIsFirefox&&e.target&&e.target.nodeName=="scrollbar"){return false;}if(e.ctrlKey&&bIsIE4&&this.clickOnScrollBar(e)){return false;}this.selections.clear();}}}}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.clickOnScrollBar=function(e){try{if(this.contentsArea&&this.contentsArea.scrollHeight>this.contentsArea.offsetHeight){getMouse(e);var scrollBarHardCode=16;var relativeMouseX=lMouseX-this.contentsArea.clientLeft-this.contentsArea.clientWidth-getObjSumLeft(this.contentsArea);if(relativeMouseX>0&&relativeMouseX<scrollBarHardCode){return true;}else{return false;}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.checkForFormSubmit=function(e){try{if(!e){e=window.event;}if(e.keyCode==13){if(this.searchIcon){this.searchIcon.focus();this.searchIcon.click();}if(bIsIE4){window.event.cancelBubble=true;}return false;}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.onsearch=function(e){try{if(this.searchIcon){if(this.treeView){this.treeView.deleteSearchNode();if(this.searchArg.value==null||this.searchArg.value.length==0){return false;}}this.shouldScrollToSearchNode=true;var oForm=findTargetTag(this.searchIcon,"form");if(this.treeView){var selectedOption=this.ancestorsList.options[this.ancestorsList.selectedIndex];if(!selectedOption.browsePath){var mappedTreeNode=this.getNodeBasedOnSelectedOption(this.getOptionsPath());if(mappedTreeNode){this.treeView.util_preProcessAnchor(mappedTreeNode,mappedTreeNode.firstChild.childNodes[1]);}if(mappedTreeNode&&mappedTreeNode.getAttribute("browsePath")){selectedOption.href+="&browsePath="+mappedTreeNode.getAttribute("browsePath");selectedOption.browsePath=mappedTreeNode.getAttribute("browsePath");}}var selectedFolderId=selectedOption.value;var selectedFolderName=selectedOption.innerHTML;if(selectedOption.folderName){selectedFolderName=selectedOption.folderName;}if(selectedOption.getAttribute("folderName")){selectedFolderName=selectedOption.getAttribute("folderName");}this.treeView.addSearchNode(this.searchArg.value,selectedFolderId,selectedFolderName,selectedOption.href,selectedOption.browsePath);if(typeof (selectedOption.href)!="undefined"&&selectedOption.href&&selectedOption.href.length>0){var searchAnchorTag=document.createElement("a");searchAnchorTag.id="dataExplorerSearch";searchAnchorTag.href=selectedOption.href+"&searchPattern="+this.searchArg.value+"&isTreeRequest=true";searchAnchorTag.target="frameManager";submitLink(searchAnchorTag);return false;}else{this.createInput("isTreeRequest","true");this.createInput(this.searchEventID,"1");submitForm(oForm);return false;}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.adjustAncestorsList=function(newAncestors){try{if(!newAncestors||newAncestors.length==0){return ;}var currentOptions=this.ancestorsList.options;for(var i=currentOptions.length-1;i>0;i--){if(!currentOptions[i].getAttribute("isLink")&&!currentOptions[i].isSearch){this.ancestorsList.remove(i);}}if(newAncestors[0].getAttribute("did")==this.searchNodeID){if(currentOptions[currentOptions.length-1].isSearch){currentOptions[currentOptions.length-1].innerHTML=(typeof (newAncestors[0].innerText)!="undefined")?newAncestors[0].innerText:newAncestors[0].textContent;currentOptions[currentOptions.length-1].value=newAncestors[0].getAttribute("folderId");currentOptions[currentOptions.length-1].folderId=newAncestors[0].getAttribute("folderId");currentOptions[currentOptions.length-1].folderName=newAncestors[0].getAttribute("folderName");currentOptions[currentOptions.length-1].href=newAncestors[0].getAttribute("href");currentOptions[currentOptions.length-1].selected=true;return ;}else{var newOption=document.createElement("OPTION");this.ancestorsList.options.add(newOption);newOption.innerHTML=(typeof (newAncestors[0].innerText)!="undefined")?newAncestors[0].innerText:newAncestors[0].textContent;newOption.value=newAncestors[0].getAttribute("folderId");newOption.isSearch=true;newOption.folderId=newAncestors[0].getAttribute("folderId");newOption.folderName=newAncestors[0].getAttribute("folderName");newOption.href=newAncestors[0].getAttribute("href");newOption.level=0;newOption.selected=true;return ;}}var lastIndex=newAncestors.length-1;var startIndex=0;if(newAncestors[lastIndex].getAttribute("isSysLink")||(newAncestors[lastIndex].getAttribute("did")==this.searchNodeID&&lastIndex>0)){for(var i=1;i<currentOptions.length;i++){if((currentOptions[i].value==newAncestors[lastIndex].getAttribute("did"))||(currentOptions[i].isSearch&&newAncestors[lastIndex].getAttribute("did")==this.searchNodeID)){startIndex=i;break;}}newAncestors.pop();lastIndex--;}var preIndent="&nbsp;&nbsp;";var level=1;var elementId=null;for(var i=0;i<newAncestors.length;i++){var tempAncestor=newAncestors[newAncestors.length-1-i];if(this.shouldDisplayAncestor(tempAncestor)){var newOption=document.createElement("OPTION");this.ancestorsList.options.add(newOption,startIndex+level);newOption.value=tempAncestor.getAttribute("did");newOption.folderName=(typeof (tempAncestor.innerText)!="undefined")?tempAncestor.innerText:tempAncestor.textContent;newOption.innerHTML=preIndent+((typeof (tempAncestor.innerText)!="undefined")?tempAncestor.innerText:tempAncestor.textContent);newOption.level=level;preIndent+="&nbsp;&nbsp;";level++;if(elementId){newOption.elementId=elementId;elementId=null;}if("a"==tempAncestor.getAttribute(microstrategy.HTMLATTR_OBJTYPE)){var attributeAnchorTag=tempAncestor.firstChild.firstChild.nextSibling;newOption.href=attributeAnchorTag.href;}}else{elementId=tempAncestor.getAttribute("did");}}currentOptions[startIndex+level-1].selected=true;}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.shouldDisplayAncestor=function(ancestorNode){try{if(typeof (ancestorNode.getAttribute(microstrategy.HTMLATTR_OBJTYPE))!="undefined"){return("e"!=ancestorNode.getAttribute(microstrategy.HTMLATTR_OBJTYPE));}else{return true;}}catch(err){microstrategy.errors.log(err);return true;}};mstrReportAllObjectsImpl.prototype.adjustUpButton=function(){try{var selectedOption=this.ancestorsList.options[this.ancestorsList.selectedIndex];if(selectedOption.level>0){this.upFolder.parentNode.style.visibility="visible";}else{this.upFolder.parentNode.style.visibility="hidden";}}catch(err){microstrategy.errors.log(err);return false;}};mstrReportAllObjectsImpl.prototype.upOneLevel=function(e){try{var selectedOption=this.ancestorsList.options[this.ancestorsList.selectedIndex];var preOption=selectedOption.previousSibling;if(preOption){this.ancestorsList.remove(this.ancestorsList.selectedIndex);preOption.selected=true;this.selectAncestor();}}catch(err){microstrategy.errors.log(err);return false;}};function mstrReportAllObjectsImpl(id){this.inherits=mstrProjectBrowserImpl;this.inherits(id);delete this.inherits;return this;}mstrReportAllObjSelectionsImplScript=true;mstrReportAllObjSelectionsImpl.prototype=new mstrReportObjSelectionsImpl();mstrReportAllObjSelectionsImpl.prototype.needToClear=function(obj){var bone=findTarget(obj,microstrategy.HTMLATTR_SCRIPTCLASS);return(bone==null||(bone.getAttribute("id")!=this.parentBone.id&&!this.parentBone.canToggleDisplay));};mstrReportAllObjSelectionsImpl.prototype.onmousedown=function(e){try{var mstrSrc=microstrategy.eventManager.getSource(e);if(mstrSrc&&mstrSrc.button>1){for(var id in this.items){if(!this.items[id].getAttribute("cx")){return false;}}return false;}return mstrReportObjSelectionsImpl.prototype.onmousedown.call(this,e);}catch(err){microstrategy.errors.log(err);return false;}};function mstrReportAllObjSelectionsImpl(){this.inherits=mstrReportObjSelectionsImpl;this.inherits();delete this.inherits;return this;}
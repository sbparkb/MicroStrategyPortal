mstrFormatHelperScript=true;mstrFormatHelper.prototype={};mstrFormatHelper.prototype._values=null;mstrFormatHelper.prototype._originalValues=null;mstrFormatHelper.prototype.valueSeparator="!";mstrFormatHelper.prototype.propSeparator="\u001F";mstrFormatHelper.prototype.notEnabled="|onegrid|";mstrFormatHelper.prototype.FORMAT_PROP_CONVERSION={font:"ff",fsize:"fsz",color:"fc",DecimalPlaces:"ndp",NegativeNumbers:"nnn",CurrencySymbol:"ncs",CurrencyPosition:"ncp",Format:"nf",ThousandSeparator:"nts",Category:"nc",Horizontal:"aln",Vertical:"alv",bgcolor:"bc",gradientcolor:"gc",FillStyle:"pfs",GradientAngle:"pga",GradientXOffset:"pgxo",GradientYOffset:"pgyo",b3dstyle:"b3d",LeftStyle:"bls",LeftColor:"blc",TopStyle:"bts",TopColor:"btc",RightStyle:"brs",RightColor:"brc",BottomStyle:"bbs",BottomColor:"bbc",replaceOption:"type",replaceValue:"src",LineSettingColor:"lc",LineSettingStyle:"ls",LineSettingWeight:"lw",TextWrap:"atw",TextDirection:"atd",LeftPadding:"flp",RightPadding:"frp",TopPadding:"ftp",BottomPadding:"fbp"};mstrFormatHelper.prototype.PROPERTY_CONVERSION={ff:{ps:"FormattingFont",p:"Name"},fsz:{ps:"FormattingFont",p:"Size"},fw:{ps:"FormattingFont",p:"Bold"},fit:{ps:"FormattingFont",p:"Italic"},fun:{ps:"FormattingFont",p:"Underline"},fst:{ps:"FormattingFont",p:"Strikeout"},fc:{ps:"FormattingFont",p:"Color"},bc:{ps:"FormattingPatterns",p:"FillColor"},gc:{ps:"FormattingPatterns",p:"GradientColor"},pfs:{ps:"FormattingPatterns",p:"FillStyle"},pga:{ps:"FormattingPatterns",p:"GradientAngle"},pgxo:{ps:"FormattingPatterns",p:"GradientXOffset"},pgyo:{ps:"FormattingPatterns",p:"GradientYOffset"},aln:{ps:"FormattingAlignment",p:"Horizontal"},alv:{ps:"FormattingAlignment",p:"Vertical"},atw:{ps:"FormattingAlignment",p:"TextWrap"},atd:{ps:"FormattingAlignment",p:"TextDirection"},bts:{ps:"FormattingBorder",p:"TopStyle"},btc:{ps:"FormattingBorder",p:"TopColor"},brs:{ps:"FormattingBorder",p:"RightStyle"},brc:{ps:"FormattingBorder",p:"RightColor"},bbs:{ps:"FormattingBorder",p:"BottomStyle"},bbc:{ps:"FormattingBorder",p:"BottomColor"},bls:{ps:"FormattingBorder",p:"LeftStyle"},blc:{ps:"FormattingBorder",p:"LeftColor"},b3d:{ps:"FormattingBorder",p:"Border3DStyle"},ndp:{ps:"FormattingNumber",p:"DecimalPlaces"},nnn:{ps:"FormattingNumber",p:"NegativeNumbers"},ncs:{ps:"FormattingNumber",p:"CurrencySymbol"},ncp:{ps:"FormattingNumber",p:"CurrencyPosition"},nf:{ps:"FormattingNumber",p:"Format"},nts:{ps:"FormattingNumber",p:"ThousandSeparator"},nc:{ps:"FormattingNumber",p:"Category"},lc:{ps:"FormattingLine",p:"LineColor"},ls:{ps:"FormattingLine",p:"LineStyle"},lw:{ps:"FormattingLine",p:"LineWeight"},flp:{ps:"FormattingPadding",p:"LeftPadding"},frp:{ps:"FormattingPadding",p:"RightPadding"},ftp:{ps:"FormattingPadding",p:"TopPadding"},fbp:{ps:"FormattingPadding",p:"BottomPadding"}};mstrFormatHelper.prototype.set=function(name,value){try{if((name in this._values&&value!=this._values[name])){if(!this._originalValues){this._originalValues=new Object();}if(!this._originalValues[name]){this._originalValues[name]=this._values[name];}this._values[name]=value;}}catch(err){microstrategy.errors.log(err);}};mstrFormatHelper.prototype.isDirty=function(){return this._originalValues!=null;};mstrFormatHelper.prototype.buildUpdateString=function(){try{var __result="";if(this._originalValues){var delimiter="";for(var id in this._originalValues){__result+=delimiter+this.PROPERTY_CONVERSION[id].ps+this.valueSeparator+this.PROPERTY_CONVERSION[id].p+this.valueSeparator+this._values[id];delimiter=this.propSeparator;}if("bc" in this._originalValues){__result+=delimiter+this.PROPERTY_CONVERSION.pfs.ps+this.valueSeparator+this.PROPERTY_CONVERSION.pfs.p+this.valueSeparator+this._values.pfs;}this._originalValues=null;}return __result;}catch(err){microstrategy.errors.log(err);}};mstrFormatHelper.prototype.cancelChanges=function(){try{if(this._originalValues){for(var id in this._originalValues){this._values[id]=this._originalValues[id];}this._originalValues=null;}}catch(err){microstrategy.errors.log(err);}};mstrFormatHelper.prototype.exec=function(cmdId,cmdValue){try{switch(cmdId){case"formatBulk":for(var i=0;i<cmdValue.length;i++){var cmd=cmdValue[i].split("|");this.exec(cmd[0],cmd[1]);}break;case"Name":this.set("ff",cmdValue);break;case"fstyle":var fs=(cmdValue.indexOf(",")!=-1)?cmdValue.split(","):[cmdValue];for(var j=0;j<fs.length;j++){var n=parseInt(fs[j]);if(n&1){this.set("fw",(n>0)?-1:0);}else{if(n&2){this.set("fit",(n>0)?-1:0);}else{if(n&4){this.set("fun",(n>0)?-1:0);}else{if(n&8){this.set("fst",(n>0)?-1:0);}}}}}break;case"Size":this.set("fsz",parseInt(cmdValue));break;case"Color":case"FillColor":if(!cmdValue||cmdValue.length==0){this.set("pfs",1);}else{if(cmdValue.indexOf(",")<0){this.set((cmdId=="Color")?"fc":"bc",this.encodeValue("color",cmdValue));this.set("pfs",0);}else{var gradientValues=cmdValue.split(",");this.set("bc",this.encodeValue("backgroundColor",cmdValue));this.set("gc",this.encodeValue("gradientColor",cmdValue));this.set("pga",gradientValues[gradientUtil.GRADIENT_ANGLE_INDEX]);this.set("pgxo",gradientValues[gradientUtil.GRADIENT_XOFFSET_INDEX]);this.set("pgyo",gradientValues[gradientUtil.GRADIENT_YOFFSET_INDEX]);this.set("pfs",2);}}break;case"LineSettingColor":this.set(this.FORMAT_PROP_CONVERSION[cmdId],this.encodeValue("color",cmdValue));break;case"borderTop":case"borderRight":case"borderBottom":case"borderLeft":var bValues=cmdValue.split(",");var propName=cmdId.substr(6);this.set(this.FORMAT_PROP_CONVERSION[propName+"Color"],this.encodeValue(cmdId+"Color",bValues[0]));this.set(this.FORMAT_PROP_CONVERSION[propName+"Style"],this.encodeValue(cmdId+"Style",bValues[1]+" "+bValues[2]));break;case"LineSettingStyle":this.set(this.FORMAT_PROP_CONVERSION[cmdId],this.encodeValue("lineStyle",cmdValue));break;case"LineSettingWeight":this.set(this.FORMAT_PROP_CONVERSION[cmdId],parseInt(cmdValue));break;case"TextDirection":case"TextWrap":case"Horizontal":case"Vertical":case"Category":case"DecimalPlaces":case"CurrencySymbol":case"ThousandSeparator":case"CurrencyPosition":case"NegativeNumbers":case"Format":case"LeftPadding":case"TopPadding":case"RightPadding":case"BottomPadding":this.set(this.FORMAT_PROP_CONVERSION[cmdId],cmdValue);break;default:microstrategy.errors.log("Command Id: "+cmdId+" not implemented.");return false;}}catch(err){microstrategy.errors.log(err);}};mstrFormatHelper.prototype.queryState=function(cmdId){try{switch(cmdId){case"font":case"fsize":case"Horizontal":case"Vertical":case"LeftStyle":case"TopStyle":case"RightStyle":case"BottomStyle":case"replaceOption":case"replaceValue":case"Category":case"DecimalPlaces":case"CurrencySymbol":case"ThousandSeparator":case"CurrencyPosition":case"NegativeNumbers":case"Format":case"b3dstyle":case"LineSettingStyle":case"LineSettingWeight":case"TextWrap":case"TextDirection":case"FillStyle":case"GradientAngle":case"GradientXOffset":case"GradientYOffset":return this._values[this.FORMAT_PROP_CONVERSION[cmdId]];case"LeftPadding":case"TopPadding":case"RightPadding":case"BottomPadding":var paddingVal=this._values[this.FORMAT_PROP_CONVERSION[cmdId]];return microstrategy.number.toUserUnits((paddingVal/72).toFixed(4));case"fstyle":var s=(this._values.fw==-1)?1:0;s+=(this._values.fit==-1)?2:0;s+=(this._values.fun==-1)?4:0;s+=(this._values.fst==-1)?8:0;return s;case"bgcolor":if(this.queryState("FillStyle")==1){return"transparent";}case"gradientcolor":case"color":case"LeftColor":case"TopColor":case"RightColor":case"BottomColor":case"LineSettingColor":return this.decodeValue("color",this._values[this.FORMAT_PROP_CONVERSION[cmdId]]);case"gradient":if(this.queryState("FillStyle")==2){return this.queryState("bgcolor")+","+this.queryState("gradientcolor")+",14,"+this.queryState("GradientAngle")+","+this.queryState("GradientXOffset")+","+this.queryState("GradientYOffset");}break;default:microstrategy.errors.log("Command Id: "+cmdId+" not implemented.");}}catch(err){microstrategy.errors.log(err);}return null;};mstrFormatHelper.prototype.queryEnabled=function(cmdId){try{return(this.notEnabled.indexOf("|"+cmdId+"|")==-1);}catch(err){microstrategy.errors.log(err);}};function mstrFormatHelper(data){for(var p in mstrFormatObject){this[p]=mstrFormatObject[p];}this._values=data;return this;}
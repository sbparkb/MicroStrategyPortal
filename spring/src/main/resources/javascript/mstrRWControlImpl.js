mstrRWControlImplScript=true;mstrRWControlImpl.prototype=new mstrRWUnitBoneImpl();mstrRWControlImpl.prototype.updateManager=microstrategy.updateManager;mstrRWControlImpl.prototype.type=microstrategy.OBJTYPE_RW_CONTROL;mstrRWControlImpl.prototype.ctlKey="";mstrRWControlImpl.prototype.ctlType="";mstrRWControlImpl.prototype.targetKeys="";mstrRWControlImpl.prototype.extraKeys="";mstrRWControlImpl.prototype.ctlStyle="";mstrRWControlImpl.prototype.ctlOrientation="";mstrRWControlImpl.prototype.multiSelect=false;mstrRWControlImpl.prototype.mouseOverAction=false;mstrRWControlImpl.prototype.allAlias="";mstrRWControlImpl.prototype.showAll=false;mstrRWControlImpl.prototype.ctlSrcId="";mstrRWControlImpl.prototype.ctlSrcType="";mstrRWControlImpl.prototype.ctlSrcSubtype="";mstrRWControlImpl.prototype.ctlSrcName="";mstrRWControlImpl.prototype.styleHelper=null;mstrRWControlImpl.prototype.isInteractive=false;mstrRWControlImpl.prototype.itemWidthMode="1";mstrRWControlImpl.prototype.unitKeyContext="";mstrRWControlImpl.prototype.showTotal=false;mstrRWControlImpl.prototype.totalPosition=1;mstrRWControlImpl.prototype.formDelimiter=":";mstrRWControlImpl.prototype.displayFormType=1;mstrRWControlImpl.prototype.attrForms="";mstrRWControlImpl.prototype.sortAttrForm=1;mstrRWControlImpl.prototype.sortType=1;mstrRWControlImpl.prototype.aow=0;mstrRWControlImpl.prototype.candidateAtts="";mstrRWControlImpl.prototype.replaceAttId="";mstrRWControlImpl.prototype.replaceAttType="";mstrRWControlImpl.prototype.replaceAttName="";mstrRWControlImpl.prototype.selections=null;mstrRWControlImpl.prototype.isAllSelected=false;mstrRWControlImpl.prototype.autoSync=false;mstrRWControlImpl.prototype.include=true;mstrRWControlImpl.OPTION_ALL="u;";mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST="1";mstrRWControlImpl.CTL_TYPE_METRIC_LIST="2";mstrRWControlImpl.CTL_TYPE_PANEL_STACK="3";mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION="4";mstrRWControlImpl.CTL_TYPE_ATTR_QUAL="7";mstrRWControlImpl.CTL_TYPE_ATTR_LIST="8";mstrRWControlImpl.CTL_STYLE_POOL_DOWN="0";mstrRWControlImpl.CTL_STYLE_SCROLLER="1";mstrRWControlImpl.CTL_STYLE_LIST_BOX="2";mstrRWControlImpl.CTL_STYLE_RADIO_BUTTON="3";mstrRWControlImpl.CTL_STYLE_CHECKBOX="4";mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY="5";mstrRWControlImpl.CTL_STYLE_LINK_ARRAY="6";mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER="7";mstrRWControlImpl.CTL_STYLE_METRIC_QUALIFICATION="8";mstrRWControlImpl.CTL_STYLE_SEARCH_BOX="9";mstrRWControlImpl.CTL_STYLE_ATTR_QUALIFICATION="11";mstrRWControlImpl.ORIENTATION_VERTICAL="0";mstrRWControlImpl.ORIENTATION_HORIZONTAL="1";mstrRWControlImpl.FMT_TYPE_UNSELECTED="2";mstrRWControlImpl.FMT_TYPE_SELECTED="3";mstrRWControlImpl.FMT_TYPE_HIGHLIGHTED="4";mstrRWControlImpl.FMT_TYPE_TITLE=5;mstrRWControlImpl.FMT_TYPE_TITLE_BASE=4;mstrRWControlImpl.heightAndWidthAttMap={hm:"heightMode",wm:"widthMode",ht:"height",wd:"width"};mstrRWControlImpl.DFM_MIXED=-1;mstrRWControlImpl.DFM_SLICING=0;mstrRWControlImpl.DFM_UC=1;mstrRWControlImpl.DFM_UC_ON_DS=2;mstrRWControlImpl.CTL_SUBTYPE_UNSPECIFIED=0;mstrRWControlImpl.CTL_SUBTYPE_CONDITION_SELECTOR=1;mstrRWControlImpl.CTL_SUBTYPE_CONDITION_SELECTOR_ON_DS=2;mstrRWControlImpl.EVENT_SEPARATOR="\u001E";mstrRWControlImpl.CTL_TARGET_TYPE_DOCUMENT=0;mstrRWControlImpl.CTL_TARGET_TYPE_DATASET=1;mstrRWControlImpl.prototype.onload=function(ctlInfo){try{mstrRWUnitBoneImpl.prototype.onload.call(this);if(!this.getDocViewer()){return ;}if(ctlInfo){this.init(ctlInfo);}this.isInteractive=this.getDocViewer().isInteractiveViewModeEplus()&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&this.ctlType!=mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION;if(!this.sibElems){this.sibElems=document.getElementsByName(this.id);}this.createStyleHelper();if(this.styleHelper){this.styleHelper.onload();}this.isAllSelected=this.selections[mstrRWControlImpl.OPTION_ALL]!=null;if(!this.isInteractive){this.addSelectorCurtain();}this.updateTargetKeys();var docViewer=this.getDocViewer();if(!this.itemFormats){this.itemFormats=new Object();this.itemFormats[mstrRWControlImpl.FMT_TYPE_TITLE]=docViewer.objProps.createFormatObject(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,mstrRWControlImpl.FMT_TYPE_TITLE);this.itemFormats[microstrategy.FORMAT_TYPE_MAIN]=docViewer.objProps.createFormatObject(microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL,microstrategy.FORMAT_TYPE_MAIN);if(this.ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION){this.itemFormats[mstrRWControlImpl.FMT_TYPE_TITLE]["showTitleBar"]="0";}}if(this.itemFormats&&this.itemFormats[microstrategy.FORMAT_TYPE_MAIN]){this.aow=this.getFormatValue(microstrategy.FORMAT_TYPE_MAIN,"ExportAsShownOnWeb");}this.isTitleVisible=this.itemFormats[mstrRWControlImpl.FMT_TYPE_TITLE]["showTitleBar"]=="-1";this.titleBar=microstrategy.findChildWithAtt(this.elem.parentNode,"DIV",microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_CONTAINER_TITLEBAR);this.toggleTitleBars();this.elem.onmousedown=new Function("e","microstrategy.bone('"+this.id+"').onmousedown(e);");this.synchronizeShadow();if(this.ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION&&this.ast==null){this.ast=8;this.pso=8;}if(this.isInteractive&&this.ctlStyle==mstrRWControlImpl.CTL_STYLE_LIST_BOX){var styObj=microstrategy.styleObj,rules=styObj.objSheet.styleRules[styObj.getId(this.elem.parentNode)],textDesc=rules&&rules.style.textDecoration;if(rules){this.elem.parentNode.style.textDecoration="none";this.textDecoration=textDesc;}if(textDesc){this.cascadeFormatting(this.elem,"textDecoration",textDesc);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.onreload=function(e){try{mstrRWUnitBoneImpl.prototype.onreload.call(this);this.updateTargetKeys();}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.onbonedeleted=function(e){try{mstrRWUnitBoneImpl.prototype.onbonedeleted.apply(this,arguments);var deletedItemsArray=e.split("|"),deleteIndexes=[];for(var i=0;i<deletedItemsArray.length;i++){if(deletedItemsArray[i]!=""){for(var j in this.targetKeys){if(deletedItemsArray[i]==this.targetKeys[j]){deleteIndexes.push(j);}}}}for(i in deleteIndexes){delete this.targetKeys[deleteIndexes[i]];}}catch(err){microstrategy.errors.log(err);}};mstrRWControlImpl.prototype.updateTargetKeys=function(){var docViewer=microstrategy.getViewerBone();if(docViewer&&docViewer.targetGroupBys){if(this.groupByTargetKeys&&this.targetKeys&&(this.groupByTargetKeys.length!=this.targetKeys.length)){for(var i=0;i<this.groupByTargetKeys.length;i++){var targetKey=docViewer.targetGroupBys[this.groupByTargetKeys[i]];if(targetKey){var found=false;for(var j=0;j<this.targetKeys.length;j++){if(this.targetKeys[j]==targetKey){found=true;break;}}if(!found){this.targetKeys.push(targetKey);}}}}if(this.phGroupByTargetKeys&&this.targetKeys){for(var i=0;i<this.phGroupByTargetKeys.length;i++){var keys=this.phGroupByTargetKeys[i].split("_");var targetKey=docViewer.targetGroupBys[keys[0]];if(targetKey){var phTargetKey=targetKey+"_"+keys[1];var found=false;for(var j=0;j<this.targetKeys.length;j++){if(this.targetKeys[j]==phTargetKey){found=true;break;}}if(!found){this.targetKeys.push(phTargetKey);}}}}}};mstrRWControlImpl.prototype.synchronizeShadow=function(dropShadowEffect){try{if(!bIsFirefox&&this.ctlStyle==mstrRWControlImpl.CTL_STYLE_SCROLLER){var docStyleObj=this.getDocViewer().doc.styleObj;var baseObj=this.elem;dropShadowEffect=dropShadowEffect?dropShadowEffect:docStyleObj.getAttValue(baseObj,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT);if(dropShadowEffect==null){dropShadowEffect=docStyleObj.getAttValue(baseObj.parentNode,microstrategy.HTMLATTR_DROP_SHADOW_EFFECT);if(dropShadowEffect!=null){baseObj=baseObj.parentNode;}}var dropShadowDepth=docStyleObj.getAttValue(baseObj,microstrategy.HTMLATTR_DROP_SHADOW);var shadow=microstrategy.findChildWithAtt(baseObj,"span","sty","shw");if(shadow){shadow.parentNode.removeChild(shadow);}this.shadowContainer=null;if(dropShadowEffect=="1"){this.shadowContainer=baseObj.cloneNode(false);this.shadowContainer.setAttribute("sty","shw");this.shadowContainer.id=baseObj.id+"_sh";baseObj.insertAdjacentElement("afterBegin",this.shadowContainer);this.shadowContainer.style.backgroundColor=docStyleObj.getValue(baseObj,"backgroundColor");for(var i=0;i<baseObj.childNodes.length;i++){if(baseObj.childNodes[i].nodeType==1){baseObj.childNodes[i].style.zIndex=2;baseObj.childNodes[i].style.position="absolute";}}this.shadowContainer.style.zIndex=1;this.shadowContainer.style.left="-"+docStyleObj.getValue(baseObj,"borderLeftWidth");this.shadowContainer.style.top="-"+docStyleObj.getValue(baseObj,"borderTopWidth");var dropShadowInPixels=microstrategy.number.convertUnit(mstrNumber.UNIT_PT,mstrNumber.UNIT_PX,Math.round(dropShadowDepth*microstrategy.ZOOM_FACTOR/100));if(mstr.utils.ISDXIE){this.shadowContainer.style.filter="progid:DXImageTransform.Microsoft.dropshadow(Color='#66000000', Positive='true', OffX="+dropShadowInPixels+", OffY="+dropShadowInPixels+") ";}else{var cssShadow=mstr.utils.ISWK?"webkitBoxShadow":"boxShadow";this.shadowContainer.style[cssShadow]=dropShadowInPixels+"px "+dropShadowInPixels+"px 3px 0 #888";}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.onmousedown=function(e){try{e=e||window.event;getMouse(e);if(typeof (mstrGridStatic)!="undefined"&&mstrGridStatic.isMouseOverScrollBar(this.elem,lMouseX,lMouseY)){e.cancelBubble=true;stopEventBubbling(e);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.initNewUnit=function(unit){try{var ctlId=unit.id+"_Ctl";var ctlTag=microstrategy.findChildrenWithAtt(unit,"div","scriptClass","mstrRWControlImpl")[0];ctlTag.setAttribute("id",ctlId);ctlTag.setAttribute("name",ctlId);var bone=microstrategy.registerBone(ctlId,"mstrRWControlImplScript",{ctlKey:unit.id});bone.ctlType=this.ctlType;bone.targetKeys=this.targetKeys;bone.ctlStyle=this.ctlStyle;bone.ctlOrientation=this.ctlOrientation;bone.multiSelect=this.multiSelect;bone.showAll=this.showAll;bone.ctlSrcId=this.ctlSrcId;bone.ctlSrcType=this.ctlSrcType;bone.ctlSrcSubtype=this.ctlSrcSubtype;bone.ctlSrcName=this.ctlSrcName;bone.itemWidthMode=this.itemWidthMode;bone.itemFormats=this.getDocViewer().objProps.cloneFormats(this.itemFormats);bone.autoSync=this.autoSync;bone.onload();}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.onSectionChange=function(){try{this.onload();if(this.styleHelper&&this.ctlStyle==mstrRWControlImpl.CTL_STYLE_SCROLLER){for(var i=0;i<this.sibElems.length;i++){var scrollerBone=microstrategy.bone(this.id+"_scr_"+i);if(scrollerBone){scrollerBone.onload();}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.init=function(ctlInfo){try{if(ctlInfo!=null){this.ctlType=ctlInfo.ctlType;this.ctlStyle=ctlInfo.ctlStyle;this.ctlSrcId=ctlInfo.ctlSrcId;this.ctlSrcType=ctlInfo.ctlSrcType;if(ctlInfo.ctlSrcSubtype){this.ctlSrcSubtype=ctlInfo.ctlSrcSubtype;}this.ctlOrientation=ctlInfo.ctlOrientation;this.ctlSrcName=ctlInfo.ctlSrcName;if(ctlInfo.ctlTargetStr){this.targetKeys=ctlInfo.ctlTargetStr.split(CLIPBOARD_ITEM_SEPARATOR);}}this.multiSelect=this.ctlStyle!=mstrRWControlImpl.CTL_STYLE_POOL_DOWN&&this.ctlStyle!=this.CTL_STYLE_RADIO_BUTTON&&this.ctlStyle!=this.CTL_STYLE_SCROLLER;this.showAll=this.ctlType!=mstrRWControlImpl.CTL_TYPE_PANEL_STACK;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.applyGradientOnItem=function(formatType,prop,value,actionCollection,format){try{var titleBar=this.titleBar;var oldData;var oldValue;if(titleBar&&formatType==mstrRWControlImpl.FMT_TYPE_TITLE){if(titleBar.getAttribute("gradientcolor")==null){oldData=titleBar.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR;oldValue=format.encodeValue("backgroundColor",this.getFormatValue(formatType,"backgroundColor"));}else{oldData=titleBar.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+"Gradient"+mstrUpdateManager.UNIT_SEPARATOR;oldValue=titleBar.getAttribute("gradientcolor");}var gradientSettings=value.split(",");var el=this.elem.parentNode;var data_backStyle=el.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("backgroundStyle")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("backgroundStyle")+mstrUpdateManager.UNIT_SEPARATOR;var data_backColor=el.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("backgroundColor")+mstrUpdateManager.UNIT_SEPARATOR;var data_gradientColor=el.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("gradientColor")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("gradientColor")+mstrUpdateManager.UNIT_SEPARATOR;var data_gradientAngle=el.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("gradientAngle")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("gradientAngle")+mstrUpdateManager.UNIT_SEPARATOR;var data_gradientXOffset=el.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("gradientXOffset")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("gradientXOffset")+mstrUpdateManager.UNIT_SEPARATOR;var data_gradientYOffset=el.getAttribute("id")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertySetName("gradientYOffset")+mstrUpdateManager.UNIT_SEPARATOR+format.getPropertyName("gradientYOffset")+mstrUpdateManager.UNIT_SEPARATOR;if(actionCollection){actionCollection.push(microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.EDIT_PROPS,this.getDocViewer().beanPath,["2048018","2048035"],[mstrUpdateManager.UPDATE_LATER,data_backColor+format.encodeValue("backgroundColor",value)+mstrUpdateManager.ITEM_SEPARATOR+data_gradientColor+format.encodeValue("gradientColor",value)+mstrUpdateManager.ITEM_SEPARATOR+data_backStyle+format.encodeValue("backgroundStyle",value)+mstrUpdateManager.ITEM_SEPARATOR+data_gradientAngle+gradientSettings[3]+mstrUpdateManager.ITEM_SEPARATOR+data_gradientXOffset+gradientSettings[4]+mstrUpdateManager.ITEM_SEPARATOR+data_gradientYOffset+gradientSettings[5]+mstrUpdateManager.ITEM_SEPARATOR],[mstrUpdateManager.UPDATE_LATER,oldData+oldValue+mstrUpdateManager.ITEM_SEPARATOR]));}this.titleBar.setAttribute("bgstyle","2");this.titleBar.setAttribute("gradientcolor",value);gradientUtil.applyGradient(this.titleBar,gradientSettings[gradientUtil.GRADIENT_START_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_ANGLE_INDEX],gradientSettings[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientSettings[gradientUtil.GRADIENT_YOFFSET_INDEX],this.getDocViewer().doc.styleObj);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.onApplyDefaultFormat=function(obj){try{var docViewer=this.getDocViewer(),docStyleObj=docViewer.doc.styleObj,objProps=docViewer.objProps,panelObj,panel,showTitle,titleBarDisp;if(docStyleObj){this.elem.setAttribute(microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE));this.elem.setAttribute(microstrategy.HTMLATTR_TITLE_BAR_DISPLAY,docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY));this.isTitleVisible=docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE)==microstrategy.TRUE;this.titleBarDisplay=docStyleObj.getAttValue(this.elem,microstrategy.HTMLATTR_TITLE_BAR_DISPLAY);}this.toggleTitleBars();this.updatePortalTitle(this.title);if(this.titleBar){objProps.initObjectFormat(this.titleBar,false,this.activeRWUnit.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE),mstrRWControlImpl.FMT_TYPE_TITLE);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.applyGradientOnTitle=function(){try{var gradientSettings=(this.titleBar.getAttribute("gradientcolor"))?this.titleBar.getAttribute("gradientcolor").split(","):null;if(gradientSettings){gradientUtil.applyGradient(this.titleBar,gradientSettings[gradientUtil.GRADIENT_START_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_END_COLOR_INDEX],gradientSettings[gradientUtil.GRADIENT_ANGLE_INDEX],gradientSettings[gradientUtil.GRADIENT_XOFFSET_INDEX],gradientSettings[gradientUtil.GRADIENT_YOFFSET_INDEX]);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.setControlGroupByList=function(value,ac){try{var updateManager=microstrategy.updateManager;var finalOrder="";for(var i=0;i<value.length;i++){finalOrder+=(i>0)?"!":"";finalOrder+=value[i].dssid;}ac.push(updateManager.createActionObject(this.elem,mstrUpdateManager.RW_REORDER_CONTROL_GROUP_BY,this.getDocViewer().beanPath,["2048012","2048173"],[this.ctlKey,finalOrder],[]));this.ControlGroupByList=value;}catch(err){microstrategy.errors.log(err);}};mstrRWControlImpl.prototype.setTitle=function(obj,title){var titleText=microstrategy.findChildWithAtt(obj,"DIV",microstrategy.HTMLATTR_ID,"titleBar");titleText.innerHTML=encode(title);};mstrRWControlImpl.prototype.updatePortalTitle=function(title){try{if(!title){title=this.getDocViewer().formattingAttributes[this.RWUnitId].nm;title=this.ctlSrcName||title;title=this.getDocViewer().doc.styleObj.getAttValue(this.elem,microstrategy.HTMLATTR_WINDOW_TITLE)||title;}this.setTitle(this.titleBar,title);this.title=title;}catch(err){}};mstrRWControlImpl.prototype.toggleTitleBars=function(){try{if(this.titleBar){if(this.isTitleVisible){displayObj(this.titleBar);}else{removeObj(this.titleBar);}}else{if(this.isTitleVisible){this.titleBar=this.docViewer.doc.createTitleBar(null,"portal_"+this.id,(this.ctlStyle==7||this.ctlStyle==8)?{boneId:this.id,objKey:this.objId,isSelector:true}:{isSelectorControl:true});this.titleBar.style.height="auto";var ctlSpan=this.elem.parentNode;ctlSpan.insertBefore(this.titleBar,ctlSpan.firstChild);insertDynamicScript("mstrPortalImpl",javaScriptPath+"mstrPortalImpl.js");var bone=microstrategy.registerBone(this.titleBar.id,"mstrPortalImpl",null);bone.onload();this.updatePortalTitle(this.title);}}if(this.isTitleVisible){this.applyGradientOnTitle();}if(this.titleBar){var swt=this.isTitleVisible?"-1":"0";this.docViewer.doc.styleObj.setAttValue(this.titleBar,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,swt);this.docViewer.doc.styleObj.setAttValue(this.elem,microstrategy.HTMLATTR_SHOW_WINDOW_TITLE,swt);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.showControlOptions=function(e){try{var target=getEventTarget(e),cm=microstrategy.getContextMenuManager("RWM").getMenu("controlLocalDataMenu");if(!target.getAttribute("cx")){cm.registerTrigger(target,null);}displayContextMenu(target,e,true);}catch(err){microstrategy.errors.log(err);}};mstrRWControlImpl.prototype.setInclude=function(v){try{var cn=this.elem.className;this.elem.className=cn.replace(/ strikeout/g,"")+(v?"":" strikeout");var ov=this.include;this.include=v;if(ov!=v){this.swapFunction();var um=this.updateManager;if(um){um.add([um.createActionObject(null,mstrUpdateManager.CTRL_SET_INCLUDE,this.getDocViewer().beanPath,["2048130","2048224","2048001","2048009"],[this.ctlKey,this.include,this.ctlSrcId,this.ctlSrcType],[])]);}um.flushAndSubmitChanges();}}catch(err){microstrategy.errors.log(err);}};mstrRWControlImpl.prototype.setQualType=function(v){try{var oldFType=this.funcType,oldMct=this.mct;this.funcType=v[0];this.asc=v[1];this.mct=v[2];var um=this.updateManager;um.add([um.createEditPropsAction(this.elem.parentNode,this.elem.parentNode.id,this.getDocViewer().beanPath,["mct"],[this.mct],null,true)]);if(this.ctlStyle==8){this.styleHelper.generateSelectOptions();this.styleHelper.onSelectionChange();}else{if(this.ctlStyle==7){var um=microstrategy.updateManager;if(oldFType!=this.funcType){var args=!!this.unitKeyContext?["2048137"]:["2048130"],values=!!this.unitKeyContext?[this.unitKeyContext]:[this.ctlKey];um.add([um.createActionObject(null,mstrUpdateManager.REPORT_WRITER_EVENT_UNSET_SELECTOR_CONTROL,this.beanPath,args,values,[])]);um.flushAndSubmitChanges();}else{if(!this.unset){var f=mstr.Enum.Nodes.MRPFUNCTION;if(oldMct!=this.mct){switch(this.func){case f.EQUALSDESCENDING:this.func=f.EQUALSASCENDING;break;case f.NOTEQUALSDESCENDING:this.func=f.NOTEQUALSASCENDING;break;case f.GREATERTHANDESCENDING:this.func=f.GREATERTHANASCENDING;break;case f.GREATERTHANEQUALSDESCENDING:this.func=f.GREATERTHANEQUALSASCENDING;break;case f.LESSTHANDESCENDING:this.func=f.LESSTHANASCENDING;break;case f.LESSTHANEQUALSDESCENDING:this.func=f.LESSTHANEQUALSASCENDING;break;case f.BETWEENDESCENDING:this.func=f.BETWEENASCENDING;break;case f.NOTBETWEENDESCENDING:this.func=f[""];break;case f.INDESCENDING:this.func=f.INASCENDING;break;case f.NOTINDESCENDING:this.func=f.NOTINASCENDING;break;case f.EQUALSASCENDING:this.func=f.EQUALSDESCENDING;break;case f.NOTEQUALSASCENDING:this.func=f.NOTEQUALSDESCENDING;break;case f.GREATERTHANASCENDING:this.func=f.GREATERTHANDESCENDING;break;case f.GREATERTHANEQUALSASCENDING:this.func=f.GREATERTHANEQUALSDESCENDING;break;case f.LESSTHANASCENDING:this.func=f.LESSTHANDESCENDING;break;case f.LESSTHANEQUALSASCENDING:this.func=f.LESSTHANEQUALSDESCENDING;break;case f.BETWEENASCENDING:this.func=f.BETWEENDESCENDING;break;case f.NOTBETWEENASCENDING:this.func=f.NOTBETWEENDESCENDING;break;case f.INASCENDING:this.func=f.INDESCENDING;break;case f.NOTINASCENDING:this.func=f.NOTINDESCENDING;break;}this.onExpressionChanged();}}}}}}catch(err){microstrategy.errors.log(err);}};mstrRWControlImpl.prototype.getViewerOffsets=function(){var viewerElem=this.docViewer&&this.docViewer.elem;return{y:viewerElem?viewerElem.scrollTop:0,x:viewerElem?viewerElem.scrollLeft:0};};mstrRWControlImpl.prototype.computeToolbarPos=function(){try{mstrRWUnitBoneImpl.prototype.computeToolbarPos.call(this);if(this.toolbar_pos_x+2<0||this.toolbar_pos_y<0){var selectTags=this.activeRWUnit.getElementsByTagName("select");if(selectTags.length>0){this.toolbar_pos_x=getObjSumLeft(this.activeRWUnit)-this.docViewer.doc.left;this.toolbar_pos_y=getObjSumTop(this.activeRWUnit)-this.docViewer.doc.top+getObjOuterHeight(this.elem);}else{this.toolbar_pos_x=getObjSumLeft(this.activeRWUnit)-this.docViewer.doc.left;this.toolbar_pos_y=getObjSumTop(this.activeRWUnit)-this.docViewer.doc.top;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.addSelectorCurtain=function(){var curtain=document.createElement("div"),ctrlHeight=getObjHeight(this.elem);curtain.className="mstrSelectorCurtain";if(ctrlHeight>0){curtain.style.height=ctrlHeight+"px";}var sibElems=this.sibElems,len=(sibElems&&sibElems.length)||0,i;for(i=0;i<len;i++){sibElems[i].appendChild(curtain.cloneNode(false));}};mstrRWControlImpl.prototype.createStyleHelper=function(){switch(this.ctlStyle){case mstrRWControlImpl.CTL_STYLE_POOL_DOWN:this.styleHelper=new mstrRWPoolDownStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_SCROLLER:this.styleHelper=new mstrRWScrollerStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_LIST_BOX:case mstrRWControlImpl.CTL_STYLE_ATTR_QUALIFICATION:this.styleHelper=new mstrRWListBoxStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_RADIO_BUTTON:this.styleHelper=new mstrRWRadioStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_CHECKBOX:this.styleHelper=new mstrRWCheckStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY:this.styleHelper=new mstrRWButtonStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_LINK_ARRAY:this.styleHelper=new mstrRWLinkStyleHelper(this);var selColor=microstrategy.styleObj.getAttValue(this.elem.parentNode,microstrategy.HTMLATTR_SELECTOR_SELECTION_COLOR);this.setSelectionColor(selColor);break;case mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER:this.styleHelper=new mstrRWMetricScrollerStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_METRIC_QUALIFICATION:this.styleHelper=new mstrRWMetricQualificationStyleHelper(this);break;case mstrRWControlImpl.CTL_STYLE_SEARCH_BOX:this.styleHelper=new mstrRWSearchBoxStyleHelper(this);break;default:break;}};mstrRWControlImpl.prototype.setSelectionColor=function(color){if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_LINK_ARRAY){var so=microstrategy.styleObj;if(so.getAttValue(this.elem.parentNode,microstrategy.HTMLATTR_SELECTOR_SELECTION_STYLE)=="0"){var fillColor=so.getValue(this.elem.parentNode,"backgroundColor");if(fillColor=="transparent"||fillColor=="#FFFFFF"){this.styleHelper.bgSelectedColor=(color!="transparent")?color:null;}else{this.styleHelper.bgSelectedColor=null;}}else{this.styleHelper.bgSelectedColor=(color!="transparent")?color:null;}this.styleHelper.onload();}};mstrRWControlImpl.prototype.newSelections=function(){this.selections=new Object();this.isAllSelected=false;};mstrRWControlImpl.prototype.fixPercentConstants=function(consts){var conArr=consts.split(mstrRWMetricQualificationStyleHelper.ITEM_SEPARATOR),con,res=[],i,mn=microstrategy.number;for(i in conArr){con=conArr[i];if(!/%$/.test(con)){con=mn.toString(con,true);con=parseFloat(con);con=con/100;con=mn.toLocaleString(con);}res.push(con);}return res.join(mstrRWMetricQualificationStyleHelper.ITEM_SEPARATOR);};mstrRWControlImpl.prototype.exec=function(cmdId,cmdVal){try{switch(cmdId){case"setExpression":if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_METRIC_QUALIFICATION){var consts="",c2="",n=this.styleHelper.numOfInputs();if(n>0){consts=this.mcInput.value;if(this.funcType==mstr.Enum.Nodes.FUNCTIONTYPE.RANKPERCENT){consts=this.fixPercentConstants(consts);}if(n==2){c2=this.mcInput2.value;if(this.funcType==mstr.Enum.Nodes.FUNCTIONTYPE.RANKPERCENT){c2=this.fixPercentConstants(c2);}consts+=mstrRWMetricQualificationStyleHelper.ITEM_SEPARATOR+c2;}}consts=consts.replace(/;/g,mstrRWMetricQualificationStyleHelper.EVENT_ITEM_SEPARATOR);this.consts=consts;this.onExpressionChanged();}else{if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER){var f=mstr.Enum.Nodes.FUNCTION;switch(this.funcType){case 1:if(cmdVal!=null){var mn=microstrategy.number,vals=cmdVal.split("|"),rightUnset=vals[1]=="unset",leftUnset=vals[0]=="unset",min=mn.toString(vals[0],true),max=mn.toString(vals[1],true);if(rightUnset){this.consts=mn.toLocaleString(min);this.func=this.include?f.GREATERTHANEQUALS:f.LESSTHAN;}else{if(leftUnset){this.consts=mn.toLocaleString(max);this.func=this.include?f.LESSTHANEQUALS:f.GREATERTHAN;}else{if(max==min){this.consts=mn.toLocaleString(min);this.func=this.include?f.EQUALS:f.NOTEQUALS;}else{this.consts=mn.toLocaleString(Math.min(min,max))+mstrRWMetricQualificationStyleHelper.EVENT_ITEM_SEPARATOR+mn.toLocaleString(Math.max(min,max));this.func=this.include?f.BETWEEN:f.NOTBETWEEN;}}}}else{this.consts=null;this.func=this.include?f.BETWEEN:f.NOTBETWEEN;}break;case 3:if(cmdVal!=null){cmdVal=cmdVal.split("|");cmdVal[0]+="%";cmdVal[1]+="%";cmdVal=cmdVal.join("|");}case 2:if(cmdVal!=null){var vals=cmdVal.split("|"),rightUnset=vals[1].replace("%","")=="unset",leftUnset=vals[0].replace("%","")=="unset",asc=this.asc?"ASCENDING":"DESCENDING",fName;if(rightUnset){this.consts=vals[0];func=this.include?"GREATERTHANEQUALS":"LESSTHAN";}else{if(leftUnset){this.consts=vals[1];func=this.include?"LESSTHANEQUALS":"GREATERTHAN";}else{if(vals[0]==vals[1]){this.consts=vals[0];func=this.include?"EQUALS":"DIFFERENTFROM";}else{this.consts=vals.join(mstrRWMetricQualificationStyleHelper.EVENT_ITEM_SEPARATOR);func=this.include?"BETWEEN":"NOTBETWEEN";}}}fName=func+asc;this.func=mstr.Enum.Nodes.MRPFUNCTION[fName];}}this.onExpressionChanged();}}break;case"setElements_horizontal":case"setElements_vertical":info=cmdVal.split("|");var scroller=microstrategy.bone(this.id+"_scr_0");if(scroller){var start=parseInt(info[0]);var end=parseInt(info[1]);this.newSelections();if((this.showAll||!this.multiSelect)&&start==1&&end==scroller.maxUnits){this.selections[mstrRWControlImpl.OPTION_ALL]=mstrRWControlImpl.OPTION_ALL;}else{var dataValues=scroller.dataValues;for(var i=start;i<=end;i++){this.selections[dataValues[i-1]]=dataValues[i-1];}}this.onSelectionChanged();for(var i=0;i<this.sibElems.length;i++){var scrollerBone=microstrategy.bone(this.id+"_scr_"+i);if(scrollerBone&&scrollerBone.positionScroller){scrollerBone.positionScroller(start,end);}}}break;}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.swapFunction=function(){if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER){var f=mstr.Enum.Nodes.FUNCTION,fmrp=mstr.Enum.Nodes.MRPFUNCTION,fType=this.funcType,func=this.func;switch(fType){case 1:switch(func){case f.EQUALS:this.func=f.NOTEQUALS;break;case f.NOTEQUALS:this.func=f.EQUALS;break;case f.GREATERTHAN:this.func=f.LESSTHANEQUALS;break;case f.GREATERTHANEQUALS:this.func=f.LESSTHAN;break;case f.LESSTHAN:this.func=f.GREATERTHANEQUALS;break;case f.LESSTHANEQUALS:this.func=f.GREATERTHAN;break;case f.BETWEEN:this.func=f.NOTBETWEEN;break;case f.NOTBETWEEN:this.func=f.BETWEEN;break;case f.ISNULL:this.func=f.ISNOTNULL;break;case f.ISNOTNULL:this.func=f.ISNULL;break;case f.IN:this.func=f.NOTIN;break;case f.NOTIN:this.func=f.IN;break;}break;case 3:case 2:switch(func){case fmrp.TOP:this.func=fmrp.BOTTOM;break;case fmrp.BOTTOM:this.func=fmrp.TOP;break;case fmrp.BETWEEN:this.func=fmrp.NOTBETWEEN;break;case fmrp.EXCLUDETOP:this.func=fmrp.EXCLUDEBOTTOM;break;case fmrp.EXCLUDEBOTTOM:this.func=fmrp.EXCLUDETOP;break;case fmrp.NOTBETWEEN:this.func=fmrp.BETWEEN;break;case fmrp.EQUALS:this.func=fmrp.NOTEQUALS;break;case fmrp.DIFFERENTFROM:this.func=fmrp.DIFFERENTFROM;break;case fmrp.EQUALSDESCENDING:this.func=fmrp.NOTEQUALSDESCENDING;break;case fmrp.NOTEQUALSDESCENDING:this.func=fmrp.EQUALSDESCENDING;break;case fmrp.GREATERTHANDESCENDING:this.func=fmrp.LESSTHANEQUALSDESCENDING;break;case fmrp.GREATERTHANEQUALSDESCENDING:this.func=fmrp.LESSTHANDESCENDING;break;case fmrp.LESSTHANDESCENDING:this.func=fmrp.GREATERTHANEQUALSDESCENDING;break;case fmrp.LESSTHANEQUALSDESCENDING:this.func=fmrp.GREATERTHANDESCENDING;break;case fmrp.BETWEENDESCENDING:this.func=fmrp.NOTBETWEENDESCENDING;break;case fmrp.NOTBETWEENDESCENDING:this.func=fmrp.BETWEENDESCENDING;break;case fmrp.INDESCENDING:this.func=fmrp.NOTINDESCENDING;break;case fmrp.NOTINDESCENDING:this.func=fmrp.INDESCENDING;break;case fmrp.EQUALSASCENDING:this.func=fmrp.NOTEQUALSASCENDING;break;case fmrp.NOTEQUALSASCENDING:this.func=fmrp.EQUALSASCENDING;break;case fmrp.GREATERTHANASCENDING:this.func=fmrp.LESSTHANEQUALSASCENDING;break;case fmrp.GREATERTHANEQUALSASCENDING:this.func=fmrp.LESSTHANASCENDING;break;case fmrp.LESSTHANASCENDING:this.func=fmrp.GREATERTHANEQUALSASCENDING;break;case fmrp.LESSTHANEQUALSASCENDING:this.func=fmrp.GREATERTHANASCENDING;break;case fmrp.BETWEENASCENDING:this.func=fmrp.NOTBETWEENASCENDING;break;case fmrp.NOTBETWEENASCENDING:this.func=fmrp.BETWEENASCENDING;break;case fmrp.INASCENDING:this.func=fmrp.NOTINASCENDING;break;case fmrp.NOTINASCENDING:this.func=fmrp.INASCENDING;break;}break;}}};mstrRWControlImpl.prototype.onExpressionChanged=function(){try{var args=[],vals=[],f=this.func;ctdt=this.ctlDataType;dt=(Number(this.mct)==0&&(ctdt==14||ctdt==15||ctdt==16))?ctdt:5;if(f!=mstr.Enum.Nodes.FUNCTION.ISNOTNULL&&f!=mstr.Enum.Nodes.FUNCTION.ISNULL&&this.consts!=null){args=["2048221","2048222"];vals=[this.consts,dt];}args=args.concat(["2048138"]);vals=vals.concat(["1"]);var applyChanges=this.applyNow()?"1":"0";var pbb=microstrategy.bone("pbb_GroupByStyle");var usePartialUpdate=pbb&&pbb.hasAllSelected?"0":"1";var updateManager=this.updateManager;updateManager.add([updateManager.createActionObject(null,mstrUpdateManager.CTRL_SET_EXPRESSION,this.getDocViewer().beanPath,["2048001","2048009","2048130","2048220","2048223","2048018","2048138"].concat(args),[this.ctlSrcId,this.ctlSrcType,this.ctlKey,this.func,this.funcType,applyChanges,usePartialUpdate].concat(vals),[])]);if(this.applyNow()){microstrategy.bone(this.getDocViewer().id).commands.exec("setUnsetFalse",this.RWUnitId);updateManager.flushAndSubmitChanges();}}catch(err){microstrategy.errors.log(err);}};mstrRWControlImpl.prototype.cascadeFormatting=function(unitTag,prop,value){this.styleHelper.cascadeFormatting(unitTag,prop,value);};mstrRWControlImpl.prototype.initDefaultFormats=function(actionCollection){if(this.styleHelper.initDefaultFormats(actionCollection)){var observer=this.getDocViewer().observer;if(observer){observer.notifyAll("onselectionchange");}}};mstrRWControlImpl.prototype.getItemFormats=function(){try{return this.itemFormats;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.getAttValue=function(formatType,att){try{if(formatType==mstrRWControlImpl.FMT_TYPE_TITLE){if(this.titleBar){var o=microstrategy.styleObj.formattingAttributes[this.titleBar.getAttribute("id")];if(o!=null&&typeof (o[att])!="undefined"){return o[att];}return this.titleBar.getAttribute(att,0);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.setAttValue=function(formatType,att,value){try{this.itemFormats[formatType][att]=value;if(formatType==mstrRWControlImpl.FMT_TYPE_TITLE){if(this.titleBar){var id=this.titleBar.getAttribute("id");var o=microstrategy.styleObj.formattingAttributes[id];if(typeof (o)=="undefined"){microstrategy.styleObj.formattingAttributes[id]=new Object();microstrategy.styleObj.formattingAttributes[id][att]=value;}else{o[att]=value;}microstrategy.styleObj.formattingAttributes[this.id.split("_")[0]][(att=="ht"?"wth":att)]=value;this.titleBar.style[mstrRWControlImpl.heightAndWidthAttMap[att]]=mstrFormatObject.decodeValue(mstrRWControlImpl.heightAndWidthAttMap[att],value);}}}catch(err){microstrategy.errors.log(err);}};mstrRWControlImpl.prototype.getFormatValue=function(formatType,prop){try{if(formatType==2){formatType=mstrRWControlImpl.FMT_TYPE_TITLE;}if(prop=="gradientcolor"&&formatType==mstrRWControlImpl.FMT_TYPE_TITLE){if(this.titleBar){return this.titleBar.getAttribute(prop);}return null;}if(this.itemFormats[formatType]){return this.itemFormats[formatType][prop];}return null;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.setFormatValue=function(formatType,prop,value){try{this.itemFormats[formatType][prop]=value;if(formatType==mstrRWControlImpl.FMT_TYPE_TITLE){if(prop=="Gradient"){return ;}if(this.titleBar){var el=this.titleBar;if(prop.indexOf("textDecoration")>-1||prop.indexOf("textAlign")>-1){el=microstrategy.findChildWithAtt(el,"div",microstrategy.HTMLATTR_ID,"titleBar");}this.getDocViewer().doc.styleObj.formatElem(el,prop,value);if(prop&&prop.toLowerCase()=="backgroundcolor"){this.titleBar.setAttribute("bgstyle",(value=="transparent")?1:0);if(this.titleBar.getAttribute("gradientcolor")){this.titleBar.removeAttribute("gradientcolor");}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.setStyle=function(style,orientation,multiSelect){try{if(this.ctlStyle==style&&this.ctlOrientation==orientation&&this.multiSelect==multiSelect){return ;}var flushPreview=this.ctlStyle!=style||this.ctlStyle==mstrRWControlImpl.CTL_STYLE_SCROLLER||(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY&&this.ctlOrientation!=orientation);this.ctlStyle=style;this.ctlOrientation=orientation;this.multiSelect=multiSelect;this.createStyleHelper();this.initDefaultFormats(null);if(microstrategy.DISPLAY_MODE==microstrategy.DESIGN_MODE&&flushPreview){this.renderPreview();}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.renderPreview=function(){try{if(this.styleHelper){var ctlTag=this.elem;ctlTag.innerHTML="";var srcName="";if(this.ctlType==mstrRWControlImpl.CTL_TYPE_ATTR_LIST){srcName=this.replaceAttName?this.replaceAttName:this.getDefaultSourceDisplay(this.ctlType);}else{srcName=this.ctlSrcName?this.ctlSrcName:this.getDefaultSourceDisplay(this.ctlType);}this.styleHelper.renderPreview(ctlTag,srcName);this.addSelectorMask(ctlTag,srcName);this.updateDisplayText();}return ctlTag;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.addSelectorMask=function(ctlTag,srcName){var maskImg=document.createElement("img");maskImg.style.position="absolute";maskImg.style.top="0";maskImg.style.left="0";maskImg.style.zindex="10";maskImg.style.height="100%";maskImg.style.width="100%";maskImg.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";ctlTag.appendChild(maskImg);};mstrRWControlImpl.prototype.onRemovePanel=function(panelStackId,panelId,newCurPanelId){try{if(this.ctlType!=mstrRWControlImpl.CTL_TYPE_PANEL_STACK){return false;}if(this.targetKeys[0]!=panelStackId){return false;}if(!this.styleHelper){return false;}this.styleHelper.removeElement("v"+panelId+";");this.newSelections();this.styleHelper.select("v"+newCurPanelId+";");}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.onredo=function(action){try{this.undoredo(action);}catch(err){microstrategy.errors.log(err);}};mstrRWControlImpl.prototype.onundo=function(action){try{this.undoredo(action);}catch(err){microstrategy.errors.log(err);}};mstrRWControlImpl.prototype.undoredo=function(action){try{var actionID=action.id;if(action.elem&&action.elem.getAttribute&&action.elem.getAttribute("id")==this.RWUnitId){switch(actionID){case mstrUpdateManager.EDIT_PROPS:var aargs=action.args;if(aargs.length<2){break;}var a=aargs[1].split(mstrUpdateManager.UNIT_SEPARATOR),prop=a[1]&&a[2]&&mstrFormatObject[a[1]]&&mstrFormatObject[a[1]][a[2]]&&mstrFormatObject[a[1]][a[2]][mstrFormatObject.HTML_PROP_NAME],value=a[3];if(value!==undefined){value=(value.substr(value.length-1)==mstrUpdateManager.ITEM_SEPARATOR)?value.substr(0,value.length-1):value;value=mstrFormatObject.decodeValue(prop,value);}if(a[1]=="FormattingView"){switch(prop){case"showTitleBar":this.isTitleVisible=value==microstrategy.TRUE;this.toggleTitleBars();break;}}break;}}}catch(err){microstrategy.errors.log(err);}};mstrRWControlImpl.prototype.onSelectionChanged=function(){try{if(this.ctlType==mstrRWControlImpl.CTL_TYPE_PANEL_STACK){var targetKey=this.targetKeys[0];var bone=microstrategy.findBone(document.getElementById(targetKey));if(bone!=null){var id="";for(var i in this.selections){id=i;break;}bone.setCurrentPanel(id.substring(1,id.length-1),true);bone.updateIconStatus(bone.titleBars[0],bone.getCurrentPanel().elem);}}else{this.isAllSelected=this.selections[mstrRWControlImpl.OPTION_ALL]!=null;var ids="";for(var i in this.selections){if(ids.length>0){ids+=CLIPBOARD_ITEM_SEPARATOR;}ids+=i;}if(ids.length==0&&this.ctlType==mstrRWControlImpl.CTL_TYPE_METRIC_LIST){return ;}var updateManager=this.updateManager;if(updateManager){var keys="";var unit;for(var i in this.targetKeys){if(mstrDocImpl.shallRenderTarget(this.targetKeys[i])||this.ctlTargetType){if(keys.length>0){keys+=CLIPBOARD_ITEM_SEPARATOR;}keys+=this.targetKeys[i];}}if(this.extraKeys){for(var i in this.extraKeys){keys+=CLIPBOARD_ITEM_SEPARATOR;keys+=this.extraKeys[i];}}var applyChanges=this.applyNow()&&keys?"1":"0";var pbb=microstrategy.bone("pbb_GroupByStyle");var usePartialUpdate=((pbb&&pbb.hasAllSelected)||this.ctlTargetType==mstrRWControlImpl.CTL_TARGET_TYPE_DATASET)?"0":"1";updateManager.add([updateManager.createActionObject(null,mstrUpdateManager.SET_CUR_CTL_ELEMENTS,this.getDocViewer().beanPath,["2048130","2048127","2048137","2048138","2048224","2048018","2048260"],[this.ctlKey,ids,this.unitKeyContext,usePartialUpdate,this.include,applyChanges,this.ctlTargetType],[])]);if(this.applyNow()){if(keys){microstrategy.bone(this.getDocViewer().id).commands.exec("setUnsetFalse",this.RWUnitId);updateManager.flushAndSubmitChanges();}}else{var ctrlBtn=microstrategy.bones.controlSubmitButton;if(ctrlBtn){var msg=ctrlBtn.elem;var span=this.elem.parentNode;var x=getObjSumLeft(span)+getObjWidth(span)+1;var xEnd=x+getObjWidth(msg);if(xEnd>getClientWidth()){x-=(xEnd-getClientWidth());}if(x<0){x=0;}var y=getObjSumTopScrolled(span)-5;if(y<0){y=0;}msg.style.left=x+"px";msg.style.top=y+"px";showMessage({contents:"",elements:microstrategy.OK_BUTTON,okEval:"(function(){microstrategy.bone('"+this.getDocViewer().id+"').commands.exec('setUnsetFalse','"+this.RWUnitId+"'); microstrategy.bone('"+this.getDocViewer().id+"').commands.exec('doFlush');})();",type:mstrMsgBoxImpl.MSG_WARNING,messageBoxID:"controlSubmitButton",positionInMiddle:false});}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.applyNow=function(elementIds){return this.getDocViewer().ctlAutoSubmit;};mstrRWControlImpl.prototype.onwinresize=function(){if(this.mask){this.mask.onmaskedobjectresize();}};mstrRWControlImpl.prototype.setType=function(actionType,actionCollection){try{if(this.ctlType!=actionType){this.ctlType=actionType;var sourceDisplay=this.getDefaultSourceDisplay(actionType);this.changeSourceText(sourceDisplay);actionCollection.push(this.updateManager.createActionObject(this.elem,mstrUpdateManager.CTRL_SET_TYPE,this.getDocViewer().beanPath,["2048130","2048113"],[this.ctlKey,actionType],[]));}return actionCollection;}catch(err){microstrategy.errors.log(err);return ac;}};mstrRWControlImpl.prototype.setTargetType=function(newTargetType){if(this.ctlTargetType!=newTargetType){this.ctlTargetType=newTargetType;}};mstrRWControlImpl.prototype.getDefaultSourceDisplay=function(actionType){var sourceDisplay="Element";switch(actionType){case"1":sourceDisplay=microstrategy.descriptors.getDescriptor("4778");break;case"2":sourceDisplay=microstrategy.descriptors.getDescriptor("517");break;case"3":sourceDisplay=microstrategy.descriptors.getDescriptor("4780");break;case"8":sourceDisplay=microstrategy.descriptors.getDescriptor("518");break;default:sourceDisplay=microstrategy.descriptors.getDescriptor("4778");break;}return sourceDisplay;};mstrRWControlImpl.prototype.setSource=function(objID,objType,sourceText,ac){try{this.ctlSrcId=objID;this.ctlSrcType=objType;this.ctlSrcName=sourceText;this.setType(mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST,ac);this.changeSourceText(sourceText);if(ac){ac.push(this.updateManager.createActionObject(this.elem,mstrUpdateManager.CTRL_SET_SOURCE,this.getDocViewer().beanPath,["2048130","2048114","2048115"],[this.ctlKey,objID,objType],[]));}return ac;}catch(err){microstrategy.errors.log(err);return ac;}};mstrRWControlImpl.prototype.setReplaceAtt=function(objID,objType,attText,ac){try{this.replaceAttId=objID;this.replaceAttType=objType;this.replaceAttName=attText;this.setType(mstrRWControlImpl.CTL_TYPE_ATTR_LIST,ac);this.changeSourceText(attText?attText:this.getDefaultSourceDisplay(this.ctlType));if(ac){ac.push(this.updateManager.createActionObject(this.elem,mstrUpdateManager.CTRL_SET_SOURCE,this.getDocViewer().beanPath,["2048130","2048114","2048115"],[this.ctlKey,objID,objType],[]));}return ac;}catch(err){microstrategy.errors.log(err);return ac;}};mstrRWControlImpl.prototype.clearSource=function(){this.ctlSrcId="";this.ctlSrcType="";this.ctlSrcName="";};mstrRWControlImpl.prototype.clearReplaceAtt=function(){this.replaceAttId="";this.replaceAttType="";this.replaceAttName="";this.candidateAtts="";};mstrRWControlImpl.prototype.isDefinitionComplete=function(){return this.targetKeys&&(this.ctlType!=mstrRWControlImpl.CTL_TYPE_ELEMENT_LIST||(this.ctlSrcId&&this.ctlSrcType));};mstrRWControlImpl.prototype.changeSourceText=function(srcName){try{var itemListObj=null;if(microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&this.isDefinitionComplete()){return ;}switch(this.ctlStyle){case mstrRWControlImpl.CTL_STYLE_POOL_DOWN:case mstrRWControlImpl.CTL_STYLE_LIST_BOX:case mstrRWControlImpl.CTL_STYLE_SEARCH_BOX:case mstrRWControlImpl.CTL_STYLE_ATTR_QUALIFICATION:itemListObj=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SECTION_NAME,"itemList");break;case mstrRWControlImpl.CTL_STYLE_RADIO_BUTTON:case mstrRWControlImpl.CTL_STYLE_CHECKBOX:itemListObj=microstrategy.findChildrenWithAtt(this.elem,"label",microstrategy.HTMLATTR_SECTION_NAME,"itemList");break;case mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY:this.elem.getElementsByTagName("input")[0].value=srcName+"-1";break;case mstrRWControlImpl.CTL_STYLE_LINK_ARRAY:itemListObj=this.elem.getElementsByTagName("td");if((!itemListObj)||itemListObj.length==0){itemListObj=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SECTION_NAME,"itemList");}break;case mstrRWControlImpl.CTL_STYLE_SCROLLER:break;case mstrRWControlImpl.CTL_STYLE_METRIC_QUALIFICATION:case mstrRWControlImpl.CTL_STYLE_METRIC_SLIDER:break;default:alert("Invalid Style, Orientation selection");break;}if(itemListObj){for(var i=0;i<itemListObj.length;i++){itemListObj[i].innerHTML=srcName+"-"+i;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.updateDisplayText=function(){if(this.ctlType==mstrRWControlImpl.CTL_TYPE_TRANSACTION_ACTION){var text=this.dpTxt;if(!text){if(this.ast==8){text=microstrategy.descriptors.getDescriptor(5369);}else{if(this.ast==4){text=microstrategy.descriptors.getDescriptor(8233);}else{if(this.ast==16){text=microstrategy.descriptors.getDescriptor(8232);}}}}if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_BUTTON_ARRAY){this.elem.getElementsByTagName("input")[0].value=text;}else{if(this.ctlStyle==mstrRWControlImpl.CTL_STYLE_LINK_ARRAY){var itemListObj=this.elem.getElementsByTagName("td");if(!itemListObj||itemListObj.length==0){itemListObj=microstrategy.findChildrenWithAtt(this.elem,"div",microstrategy.HTMLATTR_SECTION_NAME,"itemList");}if(itemListObj&&itemListObj.length>0){itemListObj[0].innerHTML=text;}}}}};mstrRWControlImpl.prototype.onboneafterresize=function(resizedBoneIds){try{mstrRWUnitBoneImpl.prototype.onboneafterresize.call(this,resizedBoneIds);this.synchronizeShadow();}catch(err){microstrategy.errors.log(err);return false;}};mstrRWControlImpl.prototype.setDelimiter=function(delimiter,ac){this.formDelimiter=delimiter;var args=["2048137","2048245"],values=[this.unitKeyContext||this.ctlKey,this.encodeSpace(delimiter)];ac.push(this.updateManager.createActionObject(null,mstrUpdateManager.SET_CTL_FORM_DELIMITER,this.getDocViewer().beanPath,args,values,[]));};mstrRWControlImpl.prototype.encodeSpace=function(delimiter){return delimiter.replace(/ /g,"SPACE");};mstrRWControlImpl.prototype.setDisplayFormType=function(displayFormType,ac){this.displayFormType=displayFormType;var args=["2048137","2048244"],values=[this.unitKeyContext||this.ctlKey,displayFormType];ac.push(this.updateManager.createActionObject(null,mstrUpdateManager.SET_CTL_FORM_DISPLAY_TYPE,this.getDocViewer().beanPath,args,values,[]));};mstrRWControlImpl.prototype.setAttrForms=function(attrForms,ac){this.attrForms=attrForms;var formIDs="",len=attrForms.length,id,S=mstrRWControlImpl.EVENT_SEPARATOR;for(var i=0;i<len;i++){id=attrForms[i].dssid.split("|")[0];formIDs+=id+S;}var args=["2048137","2048243"],values=[this.unitKeyContext||this.ctlKey,formIDs];ac.push(this.updateManager.createActionObject(null,mstrUpdateManager.SET_CTL_FORMS,this.getDocViewer().beanPath,args,values,[]));};mstrRWControlImpl.prototype.setSortAttrForm=function(sort,ac){this.sortAttrForm=sort.form;this.sortType=sort.type||1;var curForm=this.sortAttrForm,formID="",attrID=curForm.attr.split("|")[0],attrType=curForm.attr.split("|")[1],S=mstrRWControlImpl.EVENT_SEPARATOR,ctlSorts="2"+S+"1"+S+attrID+S+attrType+S+formID,isDefault=(curForm.dssid===1);if(!isDefault){formID=curForm.dssid.split("|")[0];}var ctlSorts=(isDefault?"3":"2")+S+"1"+S+attrID+S+attrType+S+formID,args=["2048130","2048137","2048045","2048047","2048246"],values=[this.ctlKey,this.unitKeyContext||this.ctlKey,this.sortType,1,ctlSorts];ac.push(this.updateManager.createActionObject(null,mstrUpdateManager.SET_CTL_SORTS,this.getDocViewer().beanPath,args,values,[]));};function mstrRWControlImpl(id){this.inherits=mstrRWUnitBoneImpl;this.inherits(id);this.inherits=null;this.selections=new Object();return this;}mstrRWCtlStyleHelper.prototype=new Object();mstrRWCtlStyleHelper.prototype.ctlBone=null;mstrRWCtlStyleHelper.prototype.boneStr=function(){return"microstrategy.bone('"+this.ctlBone.id+"')";};mstrRWCtlStyleHelper.prototype.addRadioCheckboxSelector=function(selectorDiv,inputType,srcName){try{var table=selectorDiv.appendChild(document.createElement("table"));table.setAttribute("width","100%");table.setAttribute("height","100%");table.border=0;table.cellSpacing=0;table.cellPadding=0;var tr=table.insertRow(table.rows.length);for(var i=0;i<1;i++){var td=tr.insertCell(tr.cells.length);td.setAttribute("vAlign","top");td.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");td.setAttribute("nowrap","true");var controlInput=document.createElement("input");controlInput.setAttribute("type",inputType);controlInput.value=i;td.appendChild(controlInput);var inputSpan=td.appendChild(document.createElement("label"));inputSpan.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");inputSpan.style.whiteSpace="nowrap";inputSpan.appendChild(document.createTextNode(srcName+"-"+i));}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWCtlStyleHelper.prototype.adjustHeight=function(elem,searchNodeName,searchAtt,searchAttValue){var parentSpan=microstrategy.findAncestorWithAtt(elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);if(parentSpan){if(this.ctlBone.getDocViewer()){var docStyleObj=this.ctlBone.getDocViewer().doc.styleObj;if(docStyleObj){var newHeight=docStyleObj.getValue(parentSpan,"height");this.applyStyleValue(elem,searchNodeName,"height",newHeight,searchAtt,searchAttValue);}}}};mstrRWCtlStyleHelper.prototype.initDefaultFormats=function(actionCollection){return false;};mstrRWCtlStyleHelper.prototype.applyStyleValue=function(obj,nodeName,prop,value,att,attValue){try{var itemListObj=microstrategy.findChildrenWithAtt(obj,nodeName,att,attValue);if(itemListObj){for(var i=0;i<itemListObj.length;i++){itemListObj[i].style[prop]=value;}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWCtlStyleHelper.prototype.toggleSelectedCssClass=function(el,add){try{el.className=el.className.replace(/\s?selected/g,"")+(add?" selected":"");}catch(err){microstrategy.errors.log(err);return false;}};function mstrRWCtlStyleHelper(ctl){this.ctlBone=ctl;return this;}mstrRWSelectStyleHelper.prototype=new mstrRWCtlStyleHelper();mstrRWSelectStyleHelper.prototype.onload=function(){try{if(this.ctlBone.isInteractive){var onChangeHandler=new Function("e","return "+this.boneStr()+".styleHelper.onSelectionChange(e);");}for(var s=0;s<this.ctlBone.sibElems.length;s++){var unitTag=this.ctlBone.sibElems[s];this.adjustHeight(unitTag,"div","id","insetDiv");if(this.ctlBone.isInteractive){var selectElem=this.getSelect(unitTag);if(selectElem){selectElem.onchange=onChangeHandler;selectElem.style.cursor="pointer";if(s!=0){continue;}var options=selectElem.options;if(!options){continue;}var option;for(var i=0;i<options.length;i++){option=options[i];if(option.selected){this.ctlBone.selections[option.value]=option.value;}}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWSelectStyleHelper.prototype.applyStyleValue=function(obj,nodeName,prop,value,att,attValue){var applyStyleValue=mstrRWCtlStyleHelper.prototype.applyStyleValue;applyStyleValue.apply(this,[obj,nodeName,prop,value,att,attValue]);applyStyleValue.apply(this,[obj,"select",prop,value,"id",this.ctlBone.ctlKey+"_S"]);if(prop==="color"){this.currentTextColor=value;}};mstrRWSelectStyleHelper.prototype.getSelect=function(elem){try{return microstrategy.findChildWithAtt(elem,"select","id",this.ctlBone.ctlKey+"_Sl");}catch(err){microstrategy.errors.log(err);return false;}};mstrRWSelectStyleHelper.prototype.select=function(value){try{var oldAllSelected=false;this.ctlBone.newSelections();this.ctlBone.selections[value]=value;this.highlightSelectSiblings(this.ctlBone.sibElems[0],oldAllSelected);this.ctlBone.onSelectionChanged();return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWSelectStyleHelper.prototype.onSelectionChange=function(e){try{if(!e){e=window.event;}var src=getEventTarget(e);if(!src){return ;}var options=src.options;if(!options||options.length===0){return ;}var ctlBone=this.ctlBone;var oldAllSelected=ctlBone.isAllSelected,allIndex=-1;ctlBone.newSelections();var removeDummy=false;if(src.multiple){ctlBone.selectedIndices=[];var option,v;for(var i=0,len=options.length;i<len;i++){option=options[i];v=option.value;if(option.selected&&v){ctlBone.selections[v]=v;if(option.value==mstrRWControlImpl.OPTION_ALL){ctlBone.isAllSelected=true;allIndex=i;}ctlBone.selectedIndices.push(i);}}if(oldAllSelected&&ctlBone.isAllSelected&&options.length>ctlBone.selectedIndices.length&&ctlBone.selectedIndices.length!==1){ctlBone.isAllSelected=false;ctlBone.selectedIndices.splice(allIndex,1);options[allIndex].selected=false;delete ctlBone.selections[mstrRWControlImpl.OPTION_ALL];}}else{var opt=src.options[src.selectedIndex],value=opt&&opt.value;if(opt){ctlBone.selections[value]=value;if(src.selectedIndex>0&&src.options[0].getAttribute("dummy")){removeDummy=true;}}}this.highlightSelectSiblings(src,oldAllSelected,removeDummy);ctlBone.onSelectionChanged();return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWSelectStyleHelper.prototype.highlightSelectSiblings=function(src,oldAllSelected,removeDummy){try{var action="match";var ctlBone=this.ctlBone;if(src&&src.multiple){if(ctlBone.isAllSelected){action="selectAll";}}for(var i=0;i<ctlBone.sibElems.length;i++){var unitTag=ctlBone.sibElems[i];var selectElem=this.getSelect(unitTag);var options=selectElem.options;if(removeDummy&&options[0]&&options[0].getAttribute("dummy")){selectElem.remove(0);options=selectElem.options;}if(selectElem==src&&action=="match"){continue;}if(bIsIE7&&action=="selectAll"){selectCloned=selectElem.cloneNode(true);selectCloned.onchange=src.onchange;selectCloned.onscroll=src.onscroll;options=selectCloned.options;}var match=false;for(var j=0,len=options.length;j<len;j++){var option=options[j];if(action=="selectAll"){option.selected=true;ctlBone.selections[option.value]=option.value;}else{if(action=="unselectAll"){option.selected=false;}else{option.selected=ctlBone.selections[option.value]==option.value;match|=ctlBone.selections[option.value]==option.value;}}}if(bIsIE7&&action=="selectAll"){src.parentNode.replaceChild(selectCloned,src);window.setTimeout(function(){selectCloned.scrollTop=0;},10);}if(action=="match"&&!match){if(options[0]&&!options[0].getAttribute("dummy")){var dumOpt=new Option("","");dumOpt.setAttribute("dummy","1");dumOpt.setAttribute("selected",true);selectElem.insertBefore(dumOpt,selectElem.options[0]);}selectElem.options[0].setAttribute("selected",true);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWSelectStyleHelper.prototype.removeElement=function(elementId){try{for(var s=0;s<this.ctlBone.sibElems.length;s++){var unitTag=this.ctlBone.sibElems[s];var selectElem=this.getSelect(unitTag);var options=selectElem.options;if(options){var option;for(var i=options.length-1;i>=0;i--){option=options[i];if(option.value==elementId){selectElem.remove(i);}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWSelectStyleHelper.prototype.cascadeFormatting=function(unitTag,prop,value){try{if(prop!="backgroundColor"){var s=unitTag.getElementsByTagName("select");for(var i=0;i<s.length;i++){s[i].style[prop]=value;}}}catch(err){microstrategy.errors.log(err);return false;}};function mstrRWSelectStyleHelper(ctl){this.inherits=mstrRWCtlStyleHelper;this.inherits(ctl);this.inherits=null;return this;}mstrRWListBoxStyleHelper.prototype=new mstrRWSelectStyleHelper();mstrRWListBoxStyleHelper.prototype.onload=function(){try{var ctlBone=this.ctlBone;if(ctlBone.isInteractive&&!ctlBone.include&&!mstr.utils.ISFF){var cssClass=" strikeout "+(bIsIE7?"ie":"");ctlBone.elem.className=ctlBone.elem.className.replace(cssClass,"")+(ctlBone.include?"":cssClass);var elStrikeoutContainer=(this.elStrikeoutContainer=microstrategy.findChildWithAtt(ctlBone.elem,"div",mstr.utils.ISIE7?"className":"class","strikeoutContainer")),elSelect=this.getSelect(ctlBone.elem);if(elStrikeoutContainer&&elSelect&&elSelect.multiple){mstrRWListBoxStyleHelper.OH=mstr.utils.ISWK?17:(mstr.utils.ISIE9||mstr.utils.ISIE10?16.09:(mstr.utils.ISIE8?16:16.005));var fnSyncScroll=function(){elStrikeoutContainer.style.top=-(elSelect.scrollTop+mstrRWListBoxStyleHelper.OH/2)+"px";};elSelect.onscroll=fnSyncScroll;if(ctlBone.selectedIndices){ctlBone.selectedIndices=eval(ctlBone.selectedIndices);}else{ctlBone.selectedIndices=[];if(bIsIE7){var ops=elSelect.options;for(var i=0,len=ops.length;i<len;i++){if(ops[i].selected){ctlBone.selectedIndices.push(i);}}}else{ctlBone.selectedIndices=mstr.$A.findMultiple(elSelect.options,elSelect.selectedOptions).indices;}}this.toggleStrikeoutDiv(ctlBone.selectedIndices,true);fnSyncScroll();}}mstrRWSelectStyleHelper.prototype.onload.call(this);}catch(err){microstrategy.errors.log(err);}};mstrRWListBoxStyleHelper.prototype.onSelectionChange=function(e){try{this.toggleStrikeoutDiv(this.ctlBone.selectedIndices,false);mstrRWSelectStyleHelper.prototype.onSelectionChange.call(this,e);this.toggleStrikeoutDiv(this.ctlBone.selectedIndices,true);return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWListBoxStyleHelper.prototype.renderPreview=function(ctlTag,srcName){try{var inset1Div=document.createElement("div");inset1Div.className="controlListboxInset1";inset1Div.id="insetDiv";var textDiv=document.createElement("div");textDiv.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");textDiv.appendChild(document.createTextNode(srcName+"-"+0));inset1Div.appendChild(textDiv);ctlTag.appendChild(inset1Div);this.adjustHeight(ctlTag,"div",microstrategy.HTMLATTR_SECTION_NAME,"itemList");}catch(err){microstrategy.errors.log(err);return false;}};mstrRWListBoxStyleHelper.prototype.cascadeFormatting=function(unitTag,prop,value){try{if(prop=="height"){var titleBar=this.ctlBone.titleBar;value=(parseFloat(value)-((titleBar&&titleBar.offsetHeight)||0))+"px";}mstrRWSelectStyleHelper.prototype.cascadeFormatting.call(this,unitTag,prop,value);if(prop!="backgroundColor"){this.applyStyleValue(unitTag,"div",prop,value,microstrategy.HTMLATTR_SECTION_NAME,"itemList");}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWListBoxStyleHelper.prototype.toggleStrikeoutDiv=function(indices,on){try{var doStikeoutDiv=!this.ctlBone.include&&this.elStrikeoutContainer;if(doStikeoutDiv&&indices){var c=this.elStrikeoutContainer,cns=c&&c.childNodes;for(var i=0,len=indices.length;i<len;i++){var cn=cns[indices[i]];cn.className=cn.className.replace(/ selected/g,"")+(on?" selected":"");cn.style.top=(indices[i]+1)*mstrRWListBoxStyleHelper.OH+"px";}}}catch(err){microstrategy.errors.log(err);}};function mstrRWListBoxStyleHelper(ctl){this.inherits=mstrRWSelectStyleHelper;this.inherits(ctl);this.inherits=null;return this;}mstrRWPoolDownStyleHelper.prototype=new mstrRWSelectStyleHelper();mstrRWPoolDownStyleHelper.prototype.onload=function(){try{mstrRWSelectStyleHelper.prototype.onload.call(this);}catch(err){microstrategy.errors.log(err);return false;}};mstrRWPoolDownStyleHelper.prototype.renderPreview=function(ctlTag,srcName){try{var hMode=this.ctlBone.getFormatValue(microstrategy.FORMAT_TYPE_MAIN,"heightMode");if(hMode==="2"){ctlTag.parentElement.style.height="auto";}var pulldownTable=document.createElement("table");pulldownTable.cellSpacing=0;pulldownTable.cellPadding=0;pulldownTable.className="controlPulldownTable";var tr=pulldownTable.insertRow(pulldownTable.rows.length);tr.className="controlPulldown";var td=tr.insertCell(tr.cells.length);td.className="controlPulldownOptionCell";var optionDiv=document.createElement("div");optionDiv.className="controlPulldownOption";var optionDivInset=document.createElement("div");optionDivInset.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");optionDivInset.className="controlPulldownOptionInset";optionDivInset.appendChild(document.createTextNode(srcName+"-"+0));optionDiv.appendChild(optionDivInset);td.appendChild(optionDiv);td=tr.insertCell(tr.cells.length);td.className="controlPulldownButtonCell";var buttonDiv=document.createElement("div");buttonDiv.className="controlPulldownButton";var buttonInsetDiv=document.createElement("div");buttonInsetDiv.className="controlPulldownButtonInset";var maskImg=document.createElement("img");maskImg.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";buttonInsetDiv.appendChild(maskImg);buttonDiv.appendChild(buttonInsetDiv);td.appendChild(buttonDiv);ctlTag.appendChild(pulldownTable);}catch(err){microstrategy.errors.log(err);return false;}};mstrRWPoolDownStyleHelper.prototype.cascadeFormatting=function(unitTag,prop,value){try{mstrRWSelectStyleHelper.prototype.cascadeFormatting.call(this,unitTag,prop,value);if(prop!="width"&&prop!="height"&&prop!="backgroundColor"){this.applyStyleValue(unitTag,"div",prop,value,microstrategy.HTMLATTR_SECTION_NAME,"itemList");}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWPoolDownStyleHelper.prototype.adjustHeight=function(elem,searchNodeName,searchAtt,searchAttValue){};function mstrRWPoolDownStyleHelper(ctl){this.inherits=mstrRWSelectStyleHelper;this.inherits(ctl);this.inherits=null;return this;}mstrRWMultiTagStyleHelper.prototype=new mstrRWCtlStyleHelper();mstrRWMultiTagStyleHelper.SELECT=1;mstrRWMultiTagStyleHelper.UNSELECT=2;mstrRWMultiTagStyleHelper.HIGHLIGHT=3;mstrRWMultiTagStyleHelper.UNHIGHLIGHT=4;mstrRWMultiTagStyleHelper.prototype.doRebuild=true;mstrRWMultiTagStyleHelper.prototype.onload=function(){try{if(this.ctlBone.isInteractive){var eventHandlers=this.getEventHandlers();}for(var i=0;i<this.ctlBone.sibElems.length;i++){var unitTag=this.ctlBone.sibElems[i];var options=this.getOptions(unitTag);if(!options){break;}this.adjustHeight(unitTag,"input",microstrategy.HTMLATTR_ORIENTATION,"1");if(this.ctlBone.ctlOrientation==mstrRWControlImpl.ORIENTATION_HORIZONTAL&&this.ctlBone.itemWidthMode=="1"){this.adjustColWidths(unitTag);}if(this.ctlBone.isInteractive){for(var j=0;j<options.length;j++){var option=options[j];if(this.isSelected(option)){var value=this.getValue(option);this.ctlBone.selections[value]=value;}option.style.cursor="pointer";this.initOption(option,eventHandlers);}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMultiTagStyleHelper.prototype.initOption=function(option,eventHandlers){try{for(var k in eventHandlers){option[k]=eventHandlers[k];}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMultiTagStyleHelper.prototype.reHighlight=function(unitTag){try{if(!this.ctlBone.isInteractive){return ;}this.initHighlighting();var options=this.getOptions(unitTag);if(!options){return ;}for(var j=0;j<options.length;j++){var option=options[j];if(this.isSelected(option)){this.highlightOption(option,mstrRWMultiTagStyleHelper.SELECT);}else{this.highlightOption(option,mstrRWMultiTagStyleHelper.UNSELECT);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMultiTagStyleHelper.prototype.initHighlighting=function(){};mstrRWMultiTagStyleHelper.prototype.onSingleSelectChange=function(e){try{if(!e){e=window.event;}e.cancelBubble=true;var src=getEventTarget(e);var val=this.getValue(src);if(!this.ctlBone.selections[val]){if(src){for(var i in this.ctlBone.selections){this.unselect(i);}this.doRebuild=false;this.select(val);this.ctlBone.onSelectionChanged();}}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMultiTagStyleHelper.prototype.onMultiSelectChange=function(e){try{if(!e){e=window.event;}e.cancelBubble=true;var src=getEventTarget(e);if(src){this.doRebuild=true;var elemId=src.id;if(this.isSelected(src)){this.unselect(this.getValue(src));}else{this.select(this.getValue(src));}this.ctlBone.onSelectionChanged();}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMultiTagStyleHelper.prototype.select=function(value){try{var controlBone=this.ctlBone,shouldRebuild=false,isAll=controlBone.isAllSelected;if(isAll&&!controlBone.include){isAll=controlBone.isAllSelected=false;controlBone.newSelections();}else{if(value==mstrRWControlImpl.OPTION_ALL&&controlBone.multiSelect){controlBone.newSelections();isAll=controlBone.isAllSelected=true;shouldRebuild=!!controlBone.include;}else{shouldRebuild=!!this.doRebuild;}}if(shouldRebuild){controlBone.selections=[];var j=0,sibs=controlBone.sibElems,slen=sibs.length;for(;j<slen;j++){var options=this.getOptions(sibs[j]);for(var i=0,len=options.length;i<len;i++){var option=options[i],v=this.getValue(option);if(isAll||this.isSelected(option)||v===value){controlBone.selections[v]=v;}}}}else{controlBone.selections[value]=value;}this.highlightSiblings();}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMultiTagStyleHelper.prototype.unselect=function(value){try{this.ctlBone.isAllSelected=false;if(value==mstrRWControlImpl.OPTION_ALL&&this.ctlBone.multiSelect){this.ctlBone.newSelections();}else{delete this.ctlBone.selections[value];if(this.ctlBone.selections[mstrRWControlImpl.OPTION_ALL]!=null&&this.ctlBone.multiSelect){delete this.ctlBone.selections[mstrRWControlImpl.OPTION_ALL];}}this.highlightSiblings();}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMultiTagStyleHelper.prototype.highlightSiblings=function(){try{for(var i=0;i<this.ctlBone.sibElems.length;i++){var options=this.getOptions(this.ctlBone.sibElems[i]);if(!options){break;}for(var j=0;j<options.length;j++){var option=options[j];var action;if((this.ctlBone.isAllSelected&&this.ctlBone.include)||this.ctlBone.selections[this.getValue(option)]!=null){action=mstrRWMultiTagStyleHelper.SELECT;}else{action=mstrRWMultiTagStyleHelper.UNSELECT;}this.highlightOption(option,action);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMultiTagStyleHelper.prototype.removeElement=function(elementId){try{for(var s=0;s<this.ctlBone.sibElems.length;s++){var unitTag=this.ctlBone.sibElems[s];var options=this.getOptions(unitTag);if(options){var option;for(var i=options.length-1;i>=0;i--){option=options[i];if(this.getValue(option)==elementId){var table=findTargetTag(option,"table");if(this.ctlBone.ctlOrientation==mstrRWControlImpl.ORIENTATION_VERTICAL){table.deleteRow(i);}else{var cols=table.getElementsByTagName("col");if(cols){var col=cols[i];col.parentNode.removeChild(col);}table.rows[0].deleteCell(i);}}}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMultiTagStyleHelper.prototype.adjustColWidths=function(unitTag){var tables=unitTag.getElementsByTagName("table");if(tables.length>0){var table=tables[0];var cols=table.getElementsByTagName("col");var colCount=cols.length;var colWidths=util_getColumnWidthsArray(table,colCount,1,true);var totWidth=0;for(var i=0;i<colCount;i++){totWidth+=colWidths[i];}var colWPercent;if(totWidth!=0){for(var i=0;i<colCount;i++){colWPercent=colWidths[i]*100/totWidth;cols[i].style.width=colWPercent+"%";}if(mstr.utils.ISSAFARI){table.style.tableLayout="fixed";}}}};function mstrRWMultiTagStyleHelper(id){this.inherits=mstrRWCtlStyleHelper;this.inherits(id);this.inherits=null;return this;}mstrRWRadioStyleHelper.prototype=new mstrRWMultiTagStyleHelper();mstrRWRadioStyleHelper.prototype.getOptions=function(elem){try{return elem.getElementsByTagName("input");}catch(err){microstrategy.errors.log(err);return false;}};mstrRWRadioStyleHelper.prototype.getEventHandlers=function(){try{var res=new Object();res.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onSingleSelectChange(e);");return res;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWRadioStyleHelper.prototype.highlightOption=function(option,action){try{switch(action){case mstrRWMultiTagStyleHelper.SELECT:option.checked=true;break;case mstrRWMultiTagStyleHelper.UNSELECT:option.checked=false;break;}this.toggleSelectedCssClass(option.parentNode,option.checked);}catch(err){microstrategy.errors.log(err);return false;}};mstrRWRadioStyleHelper.prototype.getValue=function(option){try{return option.value;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWRadioStyleHelper.prototype.isSelected=function(option){try{return option.checked;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWRadioStyleHelper.prototype.renderPreview=function(ctlTag,srcName){this.addRadioCheckboxSelector(ctlTag,"radio",srcName);};mstrRWRadioStyleHelper.prototype.cascadeFormatting=function(unitTag,prop,value){try{if(prop!="width"||mstrStaticDoc.getBone(unitTag).ctlOrientation!=1){this.applyStyleValue(unitTag,"td",prop,value,microstrategy.HTMLATTR_SECTION_NAME,"itemList");this.applyStyleValue(unitTag,"label",prop,value,microstrategy.HTMLATTR_SECTION_NAME,"itemList");}}catch(err){microstrategy.errors.log(err);return false;}};function mstrRWRadioStyleHelper(ctl){this.inherits=mstrRWMultiTagStyleHelper;this.inherits(ctl);this.inherits=null;return this;}mstrRWCheckStyleHelper.prototype=new mstrRWMultiTagStyleHelper();mstrRWCheckStyleHelper.prototype.getOptions=function(elem){try{return elem.getElementsByTagName("input");}catch(err){microstrategy.errors.log(err);return false;}};mstrRWCheckStyleHelper.prototype.getEventHandlers=function(){try{var res=new Object();if(this.ctlBone.multiSelect){res.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onMultiSelectChange(e);");}else{res.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onSingleSelectChange(e);");}return res;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWCheckStyleHelper.prototype.onMultiSelectChange=function(e){try{if(!e){e=window.event;}var src=getEventTarget(e);if(src){var elemId=src.id;if(this.isSelected(src)){this.select(this.getValue(src));}else{this.unselect(this.getValue(src));}this.ctlBone.onSelectionChanged();}return true;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWCheckStyleHelper.prototype.highlightOption=function(option,action){try{switch(action){case mstrRWMultiTagStyleHelper.SELECT:option.checked=true;break;case mstrRWMultiTagStyleHelper.UNSELECT:option.checked=false;break;}this.toggleSelectedCssClass(option.parentNode,option.checked);}catch(err){microstrategy.errors.log(err);return false;}};mstrRWCheckStyleHelper.prototype.getValue=function(option){try{return option.value;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWCheckStyleHelper.prototype.isSelected=function(option){try{return option.checked;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWCheckStyleHelper.prototype.renderPreview=function(ctlTag,srcName){this.addRadioCheckboxSelector(ctlTag,"checkbox",srcName);};mstrRWCheckStyleHelper.prototype.cascadeFormatting=function(unitTag,prop,value){try{if(!(prop=="width"||prop=="left"||prop=="top")){this.applyStyleValue(unitTag,"td",prop,value,microstrategy.HTMLATTR_SECTION_NAME,"itemList");this.applyStyleValue(unitTag,"label",prop,value,microstrategy.HTMLATTR_SECTION_NAME,"itemList");}}catch(err){microstrategy.errors.log(err);return false;}};function mstrRWCheckStyleHelper(ctl){this.inherits=mstrRWMultiTagStyleHelper;this.inherits(ctl);this.inherits=null;return this;}mstrRWSearchBoxStyleHelper.prototype=new mstrRWListBoxStyleHelper();mstrRWSearchBoxStyleHelper.prototype.initDefaultFormats=function(actionCollection){var parentSpan=microstrategy.findAncestorWithAtt(this.ctlBone.elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL),items=[parentSpan],df=microstrategy.bone("rwb_viewer").defaultFormats[microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL][microstrategy.FORMAT_TYPE_MAIN]["FormattingFont"],resetFmts=[["FontSize",df.Size.defaultValue],["FontFamily",df.Name.defaultValue],["Bold",df.Bold.defaultValue=="-1"],["Italic",df.Italic.defaultValue=="-1"],["Underline",df.Underline.defaultValue=="-1"],["StrikeOut",df.Strikeout.defaultValue=="-1"],["Color",microstrategy.getFormatObject().decodeValue("color",df.Color.defaultValue)]],doc=this.ctlBone.getDocViewer().doc,selections=doc.selections,old_cvf=selections.controlValueFormat;resetFmt=actionCollection?false:true,ac=resetFmt?[]:actionCollection;selections.controlValueFormat=0;for(var i=0;i<resetFmts.length;i++){var fmt=microstrategy.setSingleFormat(resetFmts[i][0],resetFmts[i][1]);if("textDecoration"==fmt[0]){doc.formatUnderlineStrikeout(items,fmt[0],fmt[1].toString(),ac);}else{doc.formatItems(items,fmt[0],fmt[1],false,ac);}}selections.controlValueFormat=old_cvf;if(resetFmt){microstrategy.updateManager.add(ac);}return true;};function mstrRWSearchBoxStyleHelper(ctl){this.inherits=mstrRWListBoxStyleHelper;this.inherits(ctl);this.inherits=null;return this;}mstrRWButtonStyleHelper.prototype=new mstrRWMultiTagStyleHelper();mstrRWButtonStyleHelper.prototype.getOptions=function(elem){try{return microstrategy.findChildrenWithAtt(elem,"input","type","button");}catch(err){microstrategy.errors.log(err);return false;}};mstrRWButtonStyleHelper.prototype.getEventHandlers=function(){try{var res=new Object();if(this.ctlBone.multiSelect){res.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onMultiSelectChange(e);");}else{res.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onSingleSelectChange(e);");}return res;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWButtonStyleHelper.prototype.highlightOption=function(elem,action){try{switch(action){case mstrRWMultiTagStyleHelper.SELECT:elem.style.borderStyle="inset";if(mstr.utils.ISIE4){elem.style.borderColor="#ece9d8";}break;case mstrRWMultiTagStyleHelper.UNSELECT:elem.style.borderStyle="outset";if(mstr.utils.ISIE4){elem.style.cssText=elem.style.cssText.replace(/border-(left|right|bottom|top)-color\s?:\s?#[a-z0-9]{6}\s?;/gi,"");}break;}this.toggleSelectedCssClass(elem,action==mstrRWMultiTagStyleHelper.SELECT);}catch(err){microstrategy.errors.log(err);return false;}};mstrRWButtonStyleHelper.prototype.getValue=function(option){try{return option.id;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWButtonStyleHelper.prototype.isSelected=function(option){try{return option.style.borderStyle.indexOf("inset")>=0;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWButtonStyleHelper.prototype.renderPreview=function(ctlTag,srcName){var controlInput=document.createElement("input");controlInput.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");switch(this.ctlBone.ctlOrientation){case mstrRWControlImpl.ORIENTATION_VERTICAL:controlInput.style.width="100%";break;case mstrRWControlImpl.ORIENTATION_HORIZONTAL:if(ctlTag.parentNode){controlInput.style.height=ctlTag.parentNode.style.height;}controlInput.setAttribute(microstrategy.HTMLATTR_ORIENTATION,mstrRWControlImpl.ORIENTATION_HORIZONTAL);break;}controlInput.setAttribute("type","button");controlInput.value=srcName+"-0";var outerDiv=document.createElement("div");outerDiv.style.textAlign="left";outerDiv.appendChild(controlInput);ctlTag.appendChild(outerDiv);};mstrRWButtonStyleHelper.prototype.initDefaultFormats=function(actionCollection){var parentSpan=microstrategy.findAncestorWithAtt(this.ctlBone.elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);var items=[parentSpan];this.ctlBone.getDocViewer().doc.formatItems(items,"textAlign","center",true,actionCollection);return true;};mstrRWButtonStyleHelper.prototype.cascadeFormatting=function(unitTag,prop,value){try{if(prop=="backgroundColor"){return ;}if(this.cascadeToOptionsRequired(prop)){this.applyStyleValue(unitTag,"input",prop,value,"type","button");}if(prop=="height"){this.adjustHeight(unitTag,"input",microstrategy.HTMLATTR_ORIENTATION,mstrRWControlImpl.ORIENTATION_HORIZONTAL);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWButtonStyleHelper.prototype.cascadeToOptionsRequired=function(prop){return prop=="color"||prop=="fontFamily"||prop=="textDecoration"||prop=="fontStyle"||prop=="fontWeight"||prop=="textAlign"||prop=="fontSize";};function mstrRWButtonStyleHelper(id){this.inherits=mstrRWMultiTagStyleHelper;this.inherits(id);this.inherits=null;return this;}mstrRWLinkStyleHelper.prototype=new mstrRWMultiTagStyleHelper();mstrRWLinkStyleHelper.prototype.bgNormalColor=null;mstrRWLinkStyleHelper.prototype.bgSelectedColor=null;mstrRWLinkStyleHelper.prototype.bgHighlightedColor=null;mstrRWLinkStyleHelper.prototype.textNormalColor=null;mstrRWLinkStyleHelper.prototype.textSelectedColor=null;mstrRWLinkStyleHelper.prototype.textHighlightedColor=null;mstrRWLinkStyleHelper.SELECTED_COLOR=[127,206,255];mstrRWLinkStyleHelper.HIGHLIGHTED_COLOR=[216,230,239];mstrRWLinkStyleHelper.prototype.onload=function(){try{this.initHighlighting();mstrRWMultiTagStyleHelper.prototype.onload.call(this);}catch(err){microstrategy.errors.log(err);return false;}};mstrRWLinkStyleHelper.prototype.highlight=function(colorStr,highlightRgb){if(!colorStr||colorStr=="transparent"){colorStr="#FFFFFF";}var rgb=mstr.utils.Color.hex2rgb(colorStr);var r,g,b;if(!highlightRgb){r=Math.round((3/5)*parseInt(rgb[0])+110);g=Math.round((3/5)*parseInt(rgb[1])+110);b=Math.round((3/5)*parseInt(rgb[2])+110);}else{rgb=mstr.utils.Color.hex2rgb(colorStr);r=rgb[0]*highlightRgb[0]/255;g=rgb[1]*highlightRgb[1]/255;b=rgb[2]*highlightRgb[2]/255;var luminosity=rgb[0]*0.3+rgb[1]*0.59+rgb[2]*0.11;if(luminosity<85){r=r+(63*((85-luminosity)/85));if(r>255){r=255;}g=g+(63*((85-luminosity)/85));if(g>255){g=255;}b=b+(96*((85-luminosity)/85));if(b>255){b=255;}}}return"#"+mstr.utils.Color.rgb2hex(r,g,b);};mstrRWLinkStyleHelper.prototype.initHighlighting=function(){try{if(this.getOptions(this.ctlBone.elem).length==0){return ;}var parentSpan=microstrategy.findAncestorWithAtt(this.ctlBone.elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);if(!parentSpan){return ;}if(this.ctlBone.getDocViewer()){var docStyleObj=this.ctlBone.getDocViewer().doc.styleObj;if(docStyleObj){this.bgNormalColor=docStyleObj.getValue(parentSpan,"backgroundColor");if(this.bgSelectedColor==null){this.bgSelectedColor=this.highlight(this.bgNormalColor,mstrRWLinkStyleHelper.SELECTED_COLOR);this.bgHighlightedColor=this.highlight(this.bgNormalColor,mstrRWLinkStyleHelper.HIGHLIGHTED_COLOR);}else{this.bgHighlightedColor=this.highlight(this.bgSelectedColor);}this.textNormalColor=docStyleObj.getValue(parentSpan,"color");this.textSelectedColor=mstr.utils.Color.getContrastingColor(this.bgSelectedColor,["#ffffff","#000000"]);this.textHighlightedColor=mstr.utils.Color.getContrastingColor(this.bgHighlightedColor,["#ffffff","#000000"]);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWLinkStyleHelper.prototype.adjustHeight=function(elem,searchNodeName,searchAtt,searchAttValue){};mstrRWLinkStyleHelper.prototype.initOption=function(option,eventHandlers){try{mstrRWMultiTagStyleHelper.prototype.initOption.call(this,option,eventHandlers);if(this.isSelected(option)){this.highlightOption(option,mstrRWMultiTagStyleHelper.SELECT);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWLinkStyleHelper.prototype.getOptions=function(elem){try{return elem.getElementsByTagName("td");}catch(err){microstrategy.errors.log(err);return false;}};mstrRWLinkStyleHelper.prototype.getEventHandlers=function(){try{var res=new Object();if(this.ctlBone.multiSelect){res.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onMultiSelectChange(e);");}else{res.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onSingleSelectChange(e);");}res.onmouseover=new Function("e","return "+this.boneStr()+".styleHelper.onMouseOver(e);");res.onmouseout=new Function("e","return "+this.boneStr()+".styleHelper.onMouseOut(e);");return res;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWLinkStyleHelper.prototype.highlightOption=function(elem,action){try{switch(action){case mstrRWMultiTagStyleHelper.SELECT:elem.setAttribute("selected","1");elem.style.backgroundColor=this.bgSelectedColor;elem.style.color=this.textSelectedColor;this.toggleSelectedCssClass(elem,action==mstrRWMultiTagStyleHelper.SELECT);break;case mstrRWMultiTagStyleHelper.UNSELECT:elem.setAttribute("selected","0");elem.style.backgroundColor="transparent";elem.style.color=this.textNormalColor;this.toggleSelectedCssClass(elem,action==mstrRWMultiTagStyleHelper.SELECT);break;case mstrRWMultiTagStyleHelper.HIGHLIGHT:elem.style.backgroundColor=this.bgHighlightedColor;elem.style.color=this.textHighlightedColor;break;case mstrRWMultiTagStyleHelper.UNHIGHLIGHT:elem.style.backgroundColor="transparent";elem.style.color=this.textNormalColor;break;}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWLinkStyleHelper.prototype.onMouseOver=function(e){var src=getEventTarget(e);if(src){src.style.cursor="pointer";if(!this.isSelected(src)){this.highlightOption(src,mstrRWMultiTagStyleHelper.HIGHLIGHT);}}};mstrRWLinkStyleHelper.prototype.onMouseOut=function(e){var src=getEventTarget(e);if(src){src.style.cursor="auto";if(!this.isSelected(src)){this.highlightOption(src,mstrRWMultiTagStyleHelper.UNHIGHLIGHT);}}};mstrRWLinkStyleHelper.prototype.getValue=function(option){try{return option.id;}catch(err){microstrategy.errors.log(err);return false;}};mstrRWLinkStyleHelper.prototype.isSelected=function(option){try{return option.getAttribute("selected")=="1";}catch(err){microstrategy.errors.log(err);return false;}};mstrRWLinkStyleHelper.prototype.renderPreview=function(ctlTag,srcName){var ctl=document.createElement("div");ctl.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");switch(this.ctlBone.ctlOrientation){case mstrRWControlImpl.ORIENTATION_VERTICAL:ctl.style.width="100%";break;case mstrRWControlImpl.ORIENTATION_HORIZONTAL:if(ctlTag.parentNode){ctl.style.height=ctlTag.parentNode.style.height;}ctl.setAttribute(microstrategy.HTMLATTR_ORIENTATION,"1");ctl.style.textAlign="left";break;}var ctlText=document.createTextNode(srcName+"-0");ctl.appendChild(ctlText);ctlTag.appendChild(ctl);};mstrRWLinkStyleHelper.prototype.cascadeFormatting=function(unitTag,prop,value){try{if(this.cascadeToOptionsRequired(prop)){this.applyStyleValue(unitTag,"td",prop,value,"sn","itemList");}if(prop=="backgroundColor"){this.reHighlight(unitTag);}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWLinkStyleHelper.prototype.cascadeToOptionsRequired=function(prop){return prop=="color"||prop=="fontFamily"||prop=="textDecoration"||prop=="fontStyle"||prop=="fontWeight"||prop=="textAlign"||prop=="fontSize";};mstrRWLinkStyleHelper.prototype.initDefaultFormats=function(actionCollection){var parentSpan=microstrategy.findAncestorWithAtt(this.ctlBone.elem,microstrategy.HTMLATTR_SUBOBJTYPE,microstrategy.SUBOBJTYPE_DOC_SELECTOR_CONTROL);var items=[parentSpan];this.ctlBone.getDocViewer().doc.formatItems(items,"textAlign","center",true,actionCollection);return true;};function mstrRWLinkStyleHelper(id){this.inherits=mstrRWCtlStyleHelper;this.inherits(id);this.inherits=null;return this;}mstrRWScrollerStyleHelper.prototype=new mstrRWCtlStyleHelper();mstrRWScrollerStyleHelper.prototype.onload=function(){for(var s=0;s<this.ctlBone.sibElems.length;s++){var unitTag=this.ctlBone.sibElems[s];var scrollTds=unitTag.getElementsByTagName("td");if(scrollTds){for(var i=0;i<scrollTds.length;i++){scrollTds[i].style.cursor="pointer";}}var scrollDiv=microstrategy.findChildWithAtt(unitTag,"div","ty","sctrk");if(scrollDiv){scrollDiv.style.cursor="pointer";}}};mstrRWScrollerStyleHelper.prototype.cascadeFormatting=function(unitTag,prop,value){if(prop=="height"&&this.ctlBone.ctlOrientation==mstrRWControlImpl.ORIENTATION_VERTICAL||prop=="width"&&this.ctlBone.ctlOrientation==mstrRWControlImpl.ORIENTATION_HORIZONTAL){this.adjustHeight(unitTag,"div","id","scroller-background-ver");var scrollers=microstrategy.findChildrenWithAtt(unitTag,"div",microstrategy.HTMLATTR_SCRIPTCLASS,"mstrScrollerImpl");if(scrollers){for(var i=0;i<scrollers.length;i++){var scrollerBone=microstrategy.bone(scrollers[i].id);if(scrollerBone){scrollerBone.onafterresize();}}}}};mstrRWScrollerStyleHelper.prototype.renderPreview=function(ctlTag,srcName){var multiSelect=this.ctlBone.multiSelect;try{switch(this.ctlBone.ctlOrientation){case mstrRWControlImpl.ORIENTATION_VERTICAL:var scrollerDiv=document.createElement("div");scrollerDiv.style.height="100%";scrollerDiv.style.width="100%";var verDiv=document.createElement("div");verDiv.className="scroller-ver";var backDiv=document.createElement("div");backDiv.className="scroller-background-ver";backDiv.id="scroller-background-ver";backDiv.style.height="100%";var scrollerTable=document.createElement("table");scrollerTable.cellSpacing=0;scrollerTable.cellPadding=0;scrollerTable.className="scroller-container-ver";scrollerTable.style.top="0.0px";var tr=null;var td=null;if(multiSelect){tr=scrollerTable.insertRow(scrollerTable.rows.length);var td=tr.insertCell(tr.cells.length);td.className="scroller-top";}tr=scrollerTable.insertRow(scrollerTable.rows.length);td=tr.insertCell(tr.cells.length);if(multiSelect){td.className="scroller-selection-ver";}else{td.className="scroller-singleticker-ver";}td.style.height="27.0px";if(multiSelect){tr=scrollerTable.insertRow(scrollerTable.rows.length);td=tr.insertCell(tr.cells.length);td.className="scroller-bottom";}verDiv.appendChild(backDiv);verDiv.appendChild(scrollerTable);scrollerDiv.appendChild(verDiv);ctlTag.appendChild(scrollerDiv);this.adjustHeight(this.ctlBone.elem,"div","id","scroller-background-ver");break;case mstrRWControlImpl.ORIENTATION_HORIZONTAL:var scrollerDiv=document.createElement("div");scrollerDiv.style.width="100%";var horDiv=document.createElement("div");horDiv.className="scroller-hor";var backDiv=document.createElement("div");backDiv.className="scroller-background-hor";var scrollerTable=document.createElement("table");scrollerTable.cellSpacing=0;scrollerTable.cellPadding=0;scrollerTable.className="scroller-container-hor";scrollerTable.style.left="0.0px";var tr=scrollerTable.insertRow(scrollerTable.rows.length);var td=null;if(multiSelect){td=tr.insertCell(tr.cells.length);td.className="scroller-left";}td=tr.insertCell(tr.cells.length);if(multiSelect){td.className="scroller-selection-hor";}else{td.className="scroller-singleticker-hor";}td.style.width="27.0px";if(multiSelect){td=tr.insertCell(tr.cells.length);td.className="scroller-right";}horDiv.appendChild(backDiv);horDiv.appendChild(scrollerTable);scrollerDiv.appendChild(horDiv);ctlTag.appendChild(scrollerDiv);break;}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWScrollerStyleHelper.prototype.removeElement=function(elementId){try{for(var i=0;i<this.ctlBone.sibElems.length;i++){var scrollerBone=microstrategy.bone(this.ctlBone.id+"_scr_"+i);if(scrollerBone&&scrollerBone.removeSelectorElement){scrollerBone.removeSelectorElement(elementId);}}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWScrollerStyleHelper.prototype.select=function(value){};function mstrRWScrollerStyleHelper(ctl){this.inherits=mstrRWCtlStyleHelper;this.inherits(ctl);this.inherits=null;return this;}mstrRWMetricQualificationStyleHelper.prototype=new mstrRWSelectStyleHelper();mstrRWMetricQualificationStyleHelper.ITEM_SEPARATOR=";";mstrRWMetricQualificationStyleHelper.EVENT_ITEM_SEPARATOR="\u001E";mstrRWMetricQualificationStyleHelper.prototype.onload=function(){try{var ctlBone=this.ctlBone,elem=ctlBone.elem;if(ctlBone.ctlSrcId){ctlBone.mcSelect=this.getSelect(elem);ctlBone.mcInput=microstrategy.findChildWithAtt(elem,"input","mci","1");ctlBone.mcInput2=microstrategy.findChildWithAtt(elem,"input","mci","2");ctlBone.mcApply=microstrategy.findChildWithAtt(elem,"input","type","button");if(ctlBone.isInteractive){ctlBone.mcSelect.onchange=new Function("e","return "+this.boneStr()+".styleHelper.onSelectionChange(e);");ctlBone.mcApply.onclick=new Function("e","return "+this.boneStr()+".styleHelper.onMCQApply(e);");ctlBone.mcInput.onkeyup=new Function("e","return "+this.boneStr()+".styleHelper.onKeyup(e);");ctlBone.mcInput2.onkeyup=new Function("e","return "+this.boneStr()+".styleHelper.onKeyup(e);");this.validate();}}}catch(err){microstrategy.errors.log(err);}};mstrRWMetricQualificationStyleHelper.prototype.onMCQApply=function(){try{this.ctlBone.exec("setExpression");}catch(err){microstrategy.errors.log(err);}};mstrRWMetricQualificationStyleHelper.prototype.onKeyup=function(e){try{this.validate();e=e||window.event;if(e.keyCode==13){this.ctlBone.mcApply.click();}}catch(err){microstrategy.errors.log(err);}};mstrRWMetricQualificationStyleHelper.prototype.validate=function(inputs){try{var cb=this.ctlBone,elApply=this.ctlBone.mcApply,css=elApply.className,isDateFormat=Number(cb.mct)==0&&(cb.ctlDataType==14||cb.ctlDataType==15||cb.ctlDataType==16),fn=cb.func,allowMultiple=fn==21||fn==22||fn==23||fn==24||fn==57;if(!inputs){switch(this.numOfInputs()){case 0:inputs=[];break;case 1:inputs=[cb.mcInput];break;case 2:inputs=[cb.mcInput,cb.mcInput2];}}else{if(!(inputs instanceof Array)){inputs=[inputs];}}this.invalid=inputs.length;for(var j=0,n=inputs.length;j<n;j++){var input=inputs[j],vals=input.value.split(mstrRWMetricQualificationStyleHelper.ITEM_SEPARATOR),valid=vals.length==1||allowMultiple,validDate=true;for(var i=0,len=vals.length;i<len;i++){var v=vals[i];if(v.length>0){if(isDateFormat){if(!v.match(/^([0]?[1-9]|[1][0-2])\/([0]?[1-9]|[1|2][0-9]|[3][0|1])\/([0-9]{4}|[0-9]{2})(( [012]?[0-9]:[0-5]?[0-9]:[0-5][0-9]| [0-5]?[0-9]:[0-5][0-9])( ([Aa]|[Pp])[Mm])?)?$/)){validDate=false;}}if((!isDateFormat&&!mstr.utils.LocaleParser.isNumeric(v))||(isDateFormat&&!validDate)){valid=false;break;}else{input.style.color=this.currentTextColor?this.currentTextColor:"";}}else{valid=false;}}if(!valid){input.style.color="#ff0000";input.title=microstrategy.descriptors.getDescriptor(6103);}this.invalid+=valid?-1:1;if((""+v).length>6&&valid){if(valid){input.title=v;}}else{input.title="";}}this.setApplyStatus(this.invalid===0);}catch(err){microstrategy.errors.log(err);}};mstrRWMetricQualificationStyleHelper.prototype.setApplyStatus=function(enabled){try{var elApply=this.ctlBone.mcApply,css=elApply.className;elApply.disabled=enabled?"":"disabled";elApply.className=enabled?css.replace(/ disabled/g,""):css+" disabled";}catch(err){microstrategy.errors.log(err);}};mstrRWMetricQualificationStyleHelper.prototype.getFuncAndType=function(){try{var ITEM_SEPARATOR="~";var vals=this.ctlBone.mcSelect.value.split("~");return{func:vals[0],funcType:vals[1]};}catch(err){microstrategy.errors.log(err);}};mstrRWMetricQualificationStyleHelper.prototype.numOfInputs=function(){try{var n=1,func=this.ctlBone.func,funcType=this.ctlBone.funcType,F=mstr.Enum.Nodes.FUNCTION,MRPF=mstr.Enum.Nodes.MRPFUNCTION;if(funcType==1&&(func==F.BETWEEN||func==F.NOTBETWEEN)||funcType>=2&&(func==MRPF.BETWEENASCENDING||func==MRPF.NOTBETWEENASCENDING)||funcType>=2&&(func==MRPF.BETWEENDESCENDING||func==MRPF.NOTBETWEENDESCENDING)){n=2;}else{if(func==F.ISNULL||func==F.ISNOTNULL){n=0;}}return n;}catch(err){microstrategy.errors.log(err);}};mstrRWMetricQualificationStyleHelper.prototype.onSelectionChange=function(){try{var ctlBone=this.ctlBone;if(!ctlBone.mcSelect){return ;}ctlBone.func=this.getFuncAndType().func;ctlBone.funcType=this.getFuncAndType().funcType;var n=this.numOfInputs();d="";ctlBone.mcInput.parentNode.style.display=(n>0)?d:"none";ctlBone.mcInput2.parentNode.style.display=(n==2)?d:"none";this.validate();}catch(err){microstrategy.errors.log(err);}};mstrRWMetricQualificationStyleHelper.prototype.renderPreview=function(ctlTag,srcName){try{var operator=">=";var value="0";var pulldownTable=document.createElement("table");pulldownTable.cellSpacing=0;pulldownTable.cellPadding=0;pulldownTable.className="controlPulldownTable";var tr=pulldownTable.insertRow(pulldownTable.rows.length);tr.className="controlPulldown";var td=tr.insertCell(tr.cells.length);td.className="controlPulldownOptionCell";var optionDiv=document.createElement("div");optionDiv.className="controlPulldownOption";var optionDivInset=document.createElement("div");optionDivInset.setAttribute(microstrategy.HTMLATTR_SECTION_NAME,"itemList");optionDivInset.className="controlPulldownOptionInset";optionDivInset.appendChild(document.createTextNode(operator));optionDiv.appendChild(optionDivInset);td.appendChild(optionDiv);td=tr.insertCell(tr.cells.length);td.className="controlPulldownButtonCell";var buttonDiv=document.createElement("div");buttonDiv.className="controlPulldownButton";var buttonInsetDiv=document.createElement("div");buttonInsetDiv.className="controlPulldownButtonInset";var maskImg=document.createElement("img");maskImg.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";buttonInsetDiv.appendChild(maskImg);buttonDiv.appendChild(buttonInsetDiv);td.appendChild(buttonDiv);td=tr.insertCell(tr.cells.length);td.className="controlInputCell";var input=document.createElement("input");input.setAttribute("size",1);input.setAttribute("value",value);td.appendChild(input);ctlTag.appendChild(pulldownTable);}catch(err){microstrategy.errors.log(err);}};mstrRWMetricQualificationStyleHelper.prototype.getSelect=function(elem){try{var f=microstrategy.findChildWithAtt,sel=f(elem,"select","id",this.ctlBone.ctlKey+"_S");if(!sel){sel=f(elem,"select","mc","1");}return sel;}catch(err){microstrategy.errors.log(err);return null;}};mstrRWMetricQualificationStyleHelper.prototype.cascadeFormatting=function(unitTag,prop,value){try{if(prop!="width"&&prop!="height"&&prop!="backgroundColor"){this.applyStyleValue(unitTag,"input",prop,value,"type","text");}}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMetricQualificationStyleHelper.prototype.generateSelectOptions=function(){try{var ctlBone=this.ctlBone,elem=ctlBone.elem,func=ctlBone.func,ft=ctlBone.funcType,asc=ctlBone.asc,select=this.getSelect(elem,ft+","+asc);if(!select){return ;}var desc=function(id){return microstrategy.descriptors.getDescriptor(id);},updateSelectTag=function(funcType,func,descid,selected){var option=new Option(desc(descid),func+"~"+funcType);option.setAttribute("title",desc(descid));if(selected===true){option.setAttribute("selected",selected);}select.options[select.length++]=option;};select.length=0;var FT=mstr.Enum.Nodes.FUNCTIONTYPE;var F=ft==FT.DEFAULT?mstr.Enum.Nodes.FUNCTION:mstr.Enum.Nodes.MRPFUNCTION;var asc=ft==FT.DEFAULT?"":(asc==true?"ASCENDING":"DESCENDING");updateSelectTag(ft,F["EQUALS"+asc],2795);updateSelectTag(ft,F["NOTEQUALS"+asc],2796);updateSelectTag(ft,F["GREATERTHAN"+asc],521);updateSelectTag(ft,F["GREATERTHANEQUALS"+asc],522,true);updateSelectTag(ft,F["LESSTHAN"+asc],523);updateSelectTag(ft,F["LESSTHANEQUALS"+asc],524);updateSelectTag(ft,F["BETWEEN"+asc],519);updateSelectTag(ft,F["NOTBETWEEN"+asc],614);updateSelectTag(ft,F["IN"+asc],898);updateSelectTag(ft,F["NOTIN"+asc],2394);if(ft==FT.DEFAULT){updateSelectTag(ft,F.ISNULL,2202);updateSelectTag(ft,F.ISNOTNULL,2203);}}catch(err){microstrategy.errors.log(err);return false;}};function mstrRWMetricQualificationStyleHelper(ctl){this.inherits=mstrRWCtlStyleHelper;this.inherits(ctl);this.inherits=null;return this;}mstrRWMetricScrollerStyleHelper.prototype=new mstrRWScrollerStyleHelper();mstrRWMetricScrollerStyleHelper.prototype.onload=function(){mstrRWScrollerStyleHelper.prototype.onload.call(this);var b=this.ctlBone,el=b.elem;el.className=el.className.replace(/ strikeout/g,"")+(b.include?"":" strikeout");};mstrRWMetricScrollerStyleHelper.prototype.renderPreview=function(ctlTag,srcName){try{ctlTag.className+="mstrRWControl metricSlider fake";var scrollerDiv=document.createElement("div");scrollerDiv.style.width="100%";var horDiv=document.createElement("div");horDiv.className="scroller-hor";horDiv.style.marginRight="1px";var selDiv=document.createElement("div");selDiv.className="scroller-selection start";selDiv.style.cssText="top: 2px; left: 0pt; width: 10%;";horDiv.appendChild(selDiv);selDiv=document.createElement("div");selDiv.className="scroller-selection center";selDiv.style.cssText="top: 2px; left: 10%; width: 70%;";horDiv.appendChild(selDiv);selDiv=document.createElement("div");selDiv.className="scroller-selection end";selDiv.style.cssText="top: 2px; left: 80%; width: 20%;";horDiv.appendChild(selDiv);var scrollerConatiner=document.createElement("div");var thumbDiv=document.createElement("div");thumbDiv.className="scroller-left";thumbDiv.style.cssText="left: 10%;";scrollerConatiner.appendChild(thumbDiv);thumbDiv=document.createElement("div");thumbDiv.className="scroller-right";thumbDiv.style.cssText="left: 80%;";scrollerConatiner.appendChild(thumbDiv);horDiv.appendChild(scrollerConatiner);scrollerDiv.appendChild(horDiv);ctlTag.appendChild(scrollerDiv);}catch(err){microstrategy.errors.log(err);return false;}};mstrRWMetricScrollerStyleHelper.prototype.removeElement=function(elementId){};function mstrRWMetricScrollerStyleHelper(ctl){this.inherits=mstrRWScrollerStyleHelper;this.inherits(ctl);this.inherits=null;return this;}
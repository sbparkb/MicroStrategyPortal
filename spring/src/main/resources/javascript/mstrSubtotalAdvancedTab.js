mstrSubtotalAdvancedTabScript=true;mstrSubtotalAdvancedTab.prototype=new mstrTabImpl();mstrSubtotalAdvancedTab.prototype.path="";mstrSubtotalAdvancedTab.prototype.verifiedPath="";mstrSubtotalAdvancedTab.TOTAL_DROPDOWN="totalDropDown";mstrSubtotalAdvancedTab.ADVANCED_RADIO_BUTTON="advancedOption";mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN="positionDropDown";mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX="selectedUnitsCheckBoxes";mstrSubtotalAdvancedTab.prototype.onload=function(){try{this.initializing=true;this.path="microstrategy.bone('"+this.id+"')";this.verifiedPath=microstrategy.getEventHandlerString(this.path);this.initEditor();this.initSettings();this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.onreload=function(){try{this.settingsInitialzed=false;mstrTabImpl.prototype.onreload.call(this);if(!this.settingsInitialzed){this.initSettings();}}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.onpostload=function(){try{mstrBoneImpl.prototype.onpostload.call(this);var at=this.getAppliesTo();this.initializing=true;this.initValues();this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.initSharedObj=function(sharedObj){if(!sharedObj.initialized){mstrSubtotalsObjImpl.initSubtotalsArray(sharedObj);}};mstrSubtotalAdvancedTab.prototype.initSettings=function(){try{this.settings=new Object();var totalDropDown=microstrategy.findChildWithAtt(this.elem,"select","name",mstrSubtotalAdvancedTab.TOTAL_DROPDOWN);totalDropDown.onchange=new Function("e",this.verifiedPath+" { return "+this.path+".onchangeTotalDropDown(e); }");this.settings[mstrSubtotalAdvancedTab.TOTAL_DROPDOWN]=totalDropDown;var advancedOptions=microstrategy.findChildrenWithAtt(this.elem,"input","name",mstrSubtotalAdvancedTab.ADVANCED_RADIO_BUTTON);this.settings[mstrSubtotalAdvancedTab.ADVANCED_RADIO_BUTTON]=new Object();for(var i=0;i<advancedOptions.length;i++){advancedOptions[i].onclick=new Function("e",this.verifiedPath+" { return "+this.path+".onchangeAdvancedOptions(e); }");this.settings[mstrSubtotalAdvancedTab.ADVANCED_RADIO_BUTTON][advancedOptions[i].value]=advancedOptions[i];}var axisStyleDropDowns=microstrategy.findChildrenWithAtt(this.elem,"select","name",mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN);this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN]=new Object();for(var i=0;i<axisStyleDropDowns.length;i++){axisStyleDropDowns[i].onchange=new Function("e",this.verifiedPath+" { return "+this.path+".onchangeAxisStyleDropDown(e); }");this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN][axisStyleDropDowns[i].getAttribute("axis")]=axisStyleDropDowns[i];}var selectedUnitCheckBoxes=microstrategy.findChildrenWithAtt(this.elem,"input","name","selectedUnits");this.settings[mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX]=new Object();for(var i=0;i<selectedUnitCheckBoxes.length;i++){selectedUnitCheckBoxes[i].onclick=new Function("e",this.verifiedPath+" { return "+this.path+".onchangeSelectedUnitCheckBoxes(e); }");this.settings[mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX][selectedUnitCheckBoxes[i].getAttribute("oid")]=selectedUnitCheckBoxes[i];}this.settingsInitialzed=true;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.initValues=function(){try{var at=this.getAppliesTo();this.initializing=true;if(!this.tabManager.sharedObj){return false;}var subtotalIndex=this.tabManager.sharedObj.currentIndex;if(subtotalIndex==mstrSubtotalSimpleTab.SUBTOTAL_INDEX_NO_SUBTOTALS){subtotalIndex=this.settings[mstrSubtotalAdvancedTab.TOTAL_DROPDOWN].getElementsByTagName("option")[0].value;}this.initTotalDropDown(subtotalIndex);this.drawAllSettings(subtotalIndex);this.initializing=false;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.initTotalDropDown=function(subtotalIndexValue){try{var allOptions=this.settings[mstrSubtotalAdvancedTab.TOTAL_DROPDOWN].getElementsByTagName("option");for(var i in allOptions){if(allOptions[i].value==subtotalIndexValue){allOptions[i].selected=true;return ;}}return false;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.drawAllSettings=function(subtotalIndex){try{this.reset();var subtotals=(this.tabManager.sharedObj)?this.tabManager.sharedObj.subtotals:null;if(subtotals==null){return false;}var subtotalObj=subtotals[subtotalIndex];if(subtotalObj==null){return false;}var state=subtotalObj.getState();if(this.settings[mstrSubtotalAdvancedTab.ADVANCED_RADIO_BUTTON]&&this.settings[mstrSubtotalAdvancedTab.ADVANCED_RADIO_BUTTON][state]){this.enableAdvancedOption(state);if(state==mstrSubtotalsObjImpl.SUBTOTAL_STATE_BY_POSITION){for(var i in this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN]){var option=this.findOptionMatch(this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN][i],subtotalObj,i);option.selected=true;}}else{if(state==mstrSubtotalsObjImpl.SUBTOTAL_STATE_ACROSS_LEVEL){for(var i in this.settings[mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX]){this.settings[mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX][i].checked=(subtotalObj.selectedUnits&&subtotalObj.selectedUnits[i]!=null);}}}this.hideUndefinedSec();}else{if(subtotalObj.undefinedState){this.showUndefinedSec();}else{this.hideUndefinedSec();}}}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.enableAdvancedOption=function(state){try{if(this.settings[mstrSubtotalAdvancedTab.ADVANCED_RADIO_BUTTON][state]!=null){this.settings[mstrSubtotalAdvancedTab.ADVANCED_RADIO_BUTTON][state].checked=true;}this.toggleAxisStyleDropDowns(state==mstrSubtotalsObjImpl.SUBTOTAL_STATE_BY_POSITION);this.toggleSelectedUnitsCheckBoxes(state==mstrSubtotalsObjImpl.SUBTOTAL_STATE_ACROSS_LEVEL);}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.toggleAxisStyleDropDowns=function(enable){try{for(var i in this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN]){this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN][i].disabled=!enable;}}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.toggleSelectedUnitsCheckBoxes=function(enable){try{for(var i in this.settings[mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX]){this.settings[mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX][i].disabled=!enable;}}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.findOptionMatch=function(dropdown,subtotalObj,axis){try{var axisStyle=subtotalObj.getStyleByAxis(axis);var allOptions=dropdown.getElementsByTagName("option");for(var i in allOptions){if(allOptions[i].value==axisStyle){return allOptions[i];}}return null;}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.onchangeTotalDropDown=function(e){try{if(!e){e=window.event;}var src=getEventTarget(e);var subtotalIndex=src.options[src.selectedIndex].value;this.tabManager.sharedObj.currentIndex=subtotalIndex;this.drawAllSettings(subtotalIndex);}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.getCurrentSubtotalObj=function(){try{var subtotalIndex=this.settings[mstrSubtotalAdvancedTab.TOTAL_DROPDOWN].options[this.settings[mstrSubtotalAdvancedTab.TOTAL_DROPDOWN].selectedIndex].value;var subtotals=(this.tabManager.sharedObj)?this.tabManager.sharedObj.subtotals:null;if(subtotals==null){return null;}return subtotals[subtotalIndex];}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.onchangeAdvancedOptions=function(e){try{if(!e){e=window.event;}var src=getEventTarget(e);var state=src.value;this.enableAdvancedOption(state);var subtotalObj=this.getCurrentSubtotalObj();if(subtotalObj!=null){subtotalObj.clear();}this.hideUndefinedSec();if(state==mstrSubtotalsObjImpl.SUBTOTAL_STATE_BY_POSITION){var subtotalObj=this.getCurrentSubtotalObj();for(var i in this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN]){var dropDown=this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN][i];if(subtotalObj!=null&&dropDown){subtotalObj.setStyleByAxis(dropDown.getAttribute("axis"),dropDown.value);}}}else{if(state==mstrSubtotalsObjImpl.SUBTOTAL_STATE_ACROSS_LEVEL){var n=0;for(var i in this.settings[mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX]){var firstOption=this.settings[mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX][i];if(n==0){firstOption.checked=true;this.selectUnitCheckBox(firstOption);}else{firstOption.checked=false;}n++;}}}}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.onchangeAxisStyleDropDown=function(e){try{if(!e){e=window.event;}var src=getEventTarget(e);var axisName=src.getAttribute("axis");var style=src.options[src.selectedIndex].value;var subtotalObj=this.getCurrentSubtotalObj();if(subtotalObj!=null){subtotalObj.setStyleByAxis(axisName,style);}}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.onchangeSelectedUnitCheckBoxes=function(e){try{if(!e){e=window.event;}var src=getEventTarget(e);this.selectUnitCheckBox(src);}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.selectUnitCheckBox=function(option){try{var oid=option.getAttribute("oid");var otype=option.getAttribute("oty");var subtotalObj=this.getCurrentSubtotalObj();if(subtotalObj!=null){if(option.checked){subtotalObj.setSelectedUnit(oid,otype);}else{subtotalObj.removeSelectedUnit(oid);}}this.hideUndefinedSec();}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.reset=function(excludingAdvancedRadioOptions){try{if(!excludingAdvancedRadioOptions){for(var i in this.settings[mstrSubtotalAdvancedTab.ADVANCED_RADIO_BUTTON]){this.settings[mstrSubtotalAdvancedTab.ADVANCED_RADIO_BUTTON][i].checked=false;}this.enableAdvancedOption(mstrSubtotalsObjImpl.SUBTOTAL_STATE_IN_ACTIVE);}for(var i in this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN]){this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN][i].selectedIndex=this.settings[mstrSubtotalAdvancedTab.AXIS_STYLE_DROPDOWN][i].length-1;}for(var i in this.settings[mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX]){this.settings[mstrSubtotalAdvancedTab.SELECTED_UNITS_CHECKBOX][i].checked=false;}this.hideUndefinedSec();}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.onstatechange=function(){try{this.initValues();}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.applyPropertyChanges=function(propertiesArray){};mstrSubtotalAdvancedTab.prototype.hideUndefinedSec=function(){try{var undefinedSec=document.getElementById("undefinedAdvancedTab");if(undefinedSec){undefinedSec.style.visibility="hidden";}}catch(err){microstrategy.errors.log(err);return false;}};mstrSubtotalAdvancedTab.prototype.showUndefinedSec=function(){try{var undefinedSec=document.getElementById("undefinedAdvancedTab");if(undefinedSec){undefinedSec.style.visibility="visible";}}catch(err){microstrategy.errors.log(err);return false;}};function mstrSubtotalAdvancedTab(id){this.inherits=mstrTabImpl;this.inherits(id);delete this.inherits;return this;}
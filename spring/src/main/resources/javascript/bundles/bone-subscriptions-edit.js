var dropDown=new function(){};dropDown.prototype=new Object();dropDown.togglePicker=function(show,id,dropdown,bone){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.togglePicker",0);}var oldPicker=null;if(bone.currentPicker){oldPicker=bone.currentPicker;if(bone.currentPicker.selected){var item=bone.currentPicker.selected;if(item){item.className="";}bone.currentPicker.selected=null;bone.currentPicker.commandId=null;bone.currentPicker.toolId=null;}bone.currentPicker.style.display="none";bone.currentPicker=null;}if(show){bone.currentPicker=document.getElementById(id);if(!bone.currentPicker){microstrategy.errors.log(microstrategy.descriptors.getDescriptor("3623"));return false;}bone.currentPicker.style.zIndex=1000;var cmdId=dropdown.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!cmdId){cmdId=dropdown.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_ID);}bone.currentPicker.commandId=cmdId;var subtypeStyle=bone.currentPicker.getAttribute(microstrategy.HTMLATTR_STYLE);if(subtypeStyle!=null){this.adjustPickerElements(bone.currentPicker);}if(bone.selectPickerElement){bone.selectPickerElement(bone.currentPicker);}for(var i=0;i<bone.currentPicker.childNodes.length;i++){var oChild=bone.currentPicker.childNodes[i];auxStr=oChild.getAttribute("de");if(auxStr&&auxStr.length>0){oChild.className=(eval(auxStr))?" ":"disabled";}}var leftElem=mstr.utils.BoxModel.getElementSumOffsetLeftAccurately(dropdown,document.body);var bottomElem=mstr.utils.BoxModel.getElementSumOffsetTopAccurately(dropdown,document.body)+getObjHeight(dropdown);if(bone.dialogDiv&&bone.dialogDiv.getAttribute(mstrHTMLAttributes.ATTR_DIALOG)=="true"){leftElem-=getObjSumLeft(bone.dialogDiv);bottomElem-=getObjSumTop(bone.dialogDiv);}bone.currentPicker.style.visibility="hidden";bone.currentPicker.style.display="block";var lClientWidth=getClientWidth();var lPickerWidth=getObjWidth(bone.currentPicker);if(lPickerWidth+leftElem>lClientWidth+((bone.dialogDiv&&!mstr.utils.ISIE6)?bone.dialogDiv.scrollLeft:0)){leftElem=Math.max(leftElem-lPickerWidth+getObjWidth(dropdown),0);}moveObjTo(bone.currentPicker,leftElem,bottomElem);if(bIsIE6&&!bIsIE7&&bone.maxHeight){bone.currentPicker.style.height="auto";bone.currentPicker.style.height=(bone.currentPicker.clientHeight<parseInt(bone.maxHeight))?bone.currentPicker.clientHeight+"px":bone.maxHeight;}bone.currentPicker.style.visibility="visible";togglePulldowns(bone.currentPicker,false);}else{if(oldPicker){togglePulldowns(oldPicker,true);}}}catch(err){microstrategy.errors.log(err);}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.togglePicker",0);}}return false;};dropDown.closePicker=function(F,D){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.closePicker",0);}if(!F){F=window.event;}var E=getEventTarget(F);var C=true;if(E){if(!E.getAttribute("id")&&E.parentNode.nodeType==1){E=E.parentNode;}var B=false;if(D.currentPicker){B=(findTarget(E,"ty")==D.currentPicker)&&(E!=D.currentPicker)&&(E.className.indexOf("disabled")<0);C=(E.className.indexOf("disabled")<0)&&(E!=D.currentPicker);}if(B){if(D.execPicker){C=D.execPicker(D.currentPicker,E);}else{alert("Option '"+E.getAttribute("id")+"' was selected from picker '"+D.currentPicker.id+"'. Please make sure the bone '"+D.id+"' implements execPicker.");}}}if(C&&D.currentPicker){dropDown.togglePicker(false,D.currentPicker.id,null,D);}return true;}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.closePicker",0);}}};dropDown.adjustPickerElements=function(I){try{var E=I.getAttribute(microstrategy.HTMLATTR_STYLE);switch(E){case"color":var H=microstrategy.userPalette;if(H){var B=microstrategy.findChildWithAtt(I,"span","name","pkrCustom");if(!B){return ;}if(B.getElementsByTagName("img").length==0){var J=document.createElement("img");J.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";B.appendChild(J);}displayObj(B);if(!ISIE7){var F=microstrategy.findChildWithAtt(I,"span","name","pkrMore");if(F){F.style.marginTop="25px";}}H=H.split(",");var A=microstrategy.findChildrenWithAtt(I,"span","custom","1");if(A.length==H.length&&A.length==8){if(A[0].id=="pkr"+H[0]){return ;}}else{if(A.length==H.length){return ;}}for(var D=0;D<A.length;D++){I.removeChild(A[D]);}for(var D=(H.length-1);D>=0;D--){var G=document.createElement("span");G.setAttribute("custom","1");G.id="pkr"+H[D];G.setAttribute("name","pkr"+H[D]);G.setAttribute("title",H[D]);G.style.backgroundColor=H[D];B.insertAdjacentElement("afterEnd",G);}}break;}}catch(C){microstrategy.errors.log(C);return false;}};mstrToolbarImplScript=true;mstrToolbarImpl.prototype=new mstrEditorImpl();mstrToolbarImpl.CMD_TYPE_SIMPLE=0;mstrToolbarImpl.CMD_TYPE_RADIO=1;mstrToolbarImpl.CMD_TYPE_CHECK=2;mstrToolbarImpl.CMD_TYPE_PULLDOWN=3;mstrToolbarImpl.CMD_TYPE_COMBO=4;mstrToolbarImpl.CMD_TYPE_CAPTION=5;mstrToolbarImpl.CMD_TYPE_TEXT=6;mstrToolbarImpl.PULLDOWN_DISABLED="mstrPulldowndisabled";mstrToolbarImpl.COMBODOWN_DISABLED="mstrCombodowndisabled";mstrToolbarImpl.DISABLED="mstrIcon-tb disabled";mstrToolbarImpl.PULLDOWN_ENABLED="mstrPulldown";mstrToolbarImpl.COMBODOWN_ENABLED="mstrCombodown";mstrToolbarImpl.ENABLED="mstrIcon-tb selected";mstrToolbarImpl.ICON="mstrIcon-tb";mstrToolbarImpl.RADIO_DISABLED="mstrIcon-tb disabled";mstrToolbarImpl.prototype.onload=function(){try{this.initToolbar();}catch(A){microstrategy.errors.log(A);return false;}};mstrToolbarImpl.prototype.onunload=function(C){try{mstrEditorImpl.prototype.onunload.call(this,C);var B=this.getAppliesTo();if(B&&B.observer){B.observer.unregister(this.id);}}catch(A){microstrategy.errors.log(A);}return true;};mstrToolbarImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.ondblclick=function(B){try{return false;}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.onclick=function(J){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrToolbarImpl.onclick",mstrLogImpl.CLICK_TOOLBAR);}if(!J){J=window.event;}if(this.getAppliesTo()==null){return ;}var H=getEventTarget(J);if(H==null){return ;}var D=H;if(D.getAttribute(microstrategy.HTMLATTR_CMD_ID)==null){D=findTarget(H,microstrategy.HTMLATTR_CMD_ID);}if(D==null){return ;}var K=D.className;if(K.indexOf("disabled")!=-1){return ;}var L=D.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(L==null){return ;}var A=D.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);var C=D.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);var I=this.getCmdType(D);switch(I){case mstrToolbarImpl.CMD_TYPE_RADIO:if(H.className!=mstrToolbarImpl.ENABLED){var F=H.parentNode.childNodes;for(var G=0;G<F.length;G++){if(F[G].nodeType==1){F[G].className=(F[G]==H)?mstrToolbarImpl.ENABLED:mstrToolbarImpl.ICON;}}this.exec(L,A);}break;case mstrToolbarImpl.CMD_TYPE_CHECK:var B=(H.className.indexOf("selected")>=0);if(typeof (A)=="number"||Number(A)!=NaN){A=(B)?-A:A;}H.className=(B)?mstrToolbarImpl.ICON:mstrToolbarImpl.ENABLED;this.exec(L,A);break;case mstrToolbarImpl.CMD_TYPE_PULLDOWN:this.togglePicker(true,C,H);break;case mstrToolbarImpl.CMD_TYPE_COMBO:if(H.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){this.togglePicker(true,C,D);}else{this.exec(L,A);}break;default:this.exec(L,A);break;}}catch(E){microstrategy.errors.log(E);}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrToolbarImpl.onclick",mstrLogImpl.CLICK_TOOLBAR);}}return false;};mstrToolbarImpl.prototype.onselectionchange=function(A){return this.update(A);};mstrToolbarImpl.prototype.getQueryState=function(A,C){try{return A.commands.queryState(C.getAttribute(microstrategy.HTMLATTR_CMD_ID));}catch(B){microstrategy.errors.log(B);}return"";};mstrToolbarImpl.prototype.update=function(G){try{var B=this.getAppliesTo();if(B&&B.commands){for(var C in this.controls){var F=this.controls[C];var A=F.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(A){var D=B.commands.queryEnabled(A);if(D){F.className=mstrToolbarImpl.ICON;F.disabled=false;this.enable(F,this.getQueryState(B,F),B,A);}else{F.disabled=true;this.disableCtrl(F);}if(B.commands.customUpdate){B.commands.customUpdate(F);}}if(F.getAttribute(microstrategy.HTMLATTR_DYN_TITLE)!=null){F.setAttribute("title",B.commands.queryState(F.getAttribute(microstrategy.HTMLATTR_DYN_TITLE)));}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrToolbarImpl.prototype.getBeanName=function(){try{var A=this.elem.parentNode.id;if(A.indexOf("_")>0){A=A.substr(0,A.indexOf("_"));}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrToolbarImpl.prototype.onmouseover=function(C){try{var A=this.getButton(C);if(A==null){return ;}var D=A.className.toLowerCase();if(D.indexOf("disabled")>-1){return ;}if(A.className.indexOf(" highlighted")==-1){A.className+=" highlighted";}}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.onmouseout=function(C){try{var A=this.getButton(C);if(A==null){return ;}A.className=A.className.replace(" highlighted","");}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.togglePicker=function(A,D,B){try{dropDown.togglePicker(A,D,B,this);}catch(C){microstrategy.errors.log(C);}return false;};mstrToolbarImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrToolbarImpl.prototype.selectPickerElement=function(C){try{var B=C.commandId;var A=this.getAppliesTo();if(A){var D=A.commands.queryState(B);if(D!=null){var F=document.getElementById("pkr"+D);if(F){F.className=mstrToolbarImpl.ENABLED;C.selected=F;}}}}catch(E){microstrategy.errors.log(E);}};mstrToolbarImpl.prototype.exec=function(B,D){try{if(!B){return ;}var A=this.getAppliesTo();if(!A){return ;}if(!A.commands.queryEnabled(B)){return ;}A.commands.exec(B,D);return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrToolbarImpl.prototype.execPicker=function(C,G){try{var F=true;var B=C.commandId;var A=this.getAppliesTo();if(A&&B&&A.commands.queryEnabled(B)){F=A.commands.exec(B,G.getAttribute("id").slice(3));if(F){var E=this.getControlFromCmdId(B);if(this.getCmdType(E)==mstrToolbarImpl.CMD_TYPE_PULLDOWN){this.enable(E,this.getQueryState(A,E),A,B);}}}return F;}catch(D){microstrategy.errors.log(D);return false;}};mstrToolbarImpl.prototype.initToolbar=function(){try{this.initEditor();this.controls=new Object();this.currentPicker=null;if(this.elem){var D=this.appliesTo||this.elem.getAttribute("at");this.setAppliesTo(D);var J=this.elem.getAttribute("beanPath");if(J&&J.length>0){this.beanPath=J;}var K=new Function("e","return microstrategy.bone('"+this.id+"').onclick(e);");var H=new Function("e","return microstrategy.bone('"+this.id+"').ondblclick(e);");this.elem.onmouseover=new Function("e","if (typeof(microstrategy) != 'undefined' && microstrategy.bone('"+this.id+"') != null) { return microstrategy.bone('"+this.id+"').onmouseover(e); }");this.elem.onmouseout=new Function("e","if (typeof(microstrategy) != 'undefined' && microstrategy.bone('"+this.id+"') != null) { return microstrategy.bone('"+this.id+"').onmouseout(e); }");if(!this.body){return ;}function I(L){var M=getObj(L);if(typeof (M.innerText)!="undefined"){return M.innerText;}if(bIsW3C&&M.childNodes&&M.childNodes[0]&&(M.childNodes[0].nodeValue!=null)){if(M.childNodes[0].nodeValue!=M.innerHTML){microstrategy.err.log("Please forward the reproduction scenario to reproduce this error to either Mark or Yong.  Do not log a TQMS issue.");}return M.childNodes[0].nodeValue;}}var B=this.body.getElementsByTagName("div");for(var F=0;F<B.length;F++){if(B[F].getAttribute(microstrategy.HTMLATTR_OBJTYPE)==microstrategy.OBJTYPE_BTN_GROUP){for(var E=0;E<B[F].childNodes.length;E++){if(B[F].childNodes[E].nodeType==1){var G=B[F].childNodes[E];var A=G.getAttribute("id");if(G.getAttribute(microstrategy.HTMLATTR_CMD_ID)&&G.getAttribute(microstrategy.HTMLATTR_CMD_TYPE)!=mstrToolbarImpl.CMD_TYPE_TEXT&&G.tagName.toLowerCase()!="label"){G.onclick=K;G.ondblclick=H;}this.controls[A]=G;if(G.firstChild&&G.firstChild.tagName=="SPAN"){this.controls[A].origName=G.firstChild.innerHTML;}else{this.controls[A].origName=I(G);}}}}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrToolbarImpl.prototype.setAppliesTo=function(B){try{if(B==null){B=microstrategy.getViewerBone();}if(typeof (B)=="string"){B=microstrategy.bone(B);}if(B){this.appliesTo=B.id;if(B.observer){B.observer.register(this.id);}}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrToolbarImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo&&this.appliesTo.length>0){return microstrategy.bone(this.appliesTo);}return null;}catch(A){microstrategy.errors.log(A);return null;}};mstrToolbarImpl.prototype.getControlFromCmdId=function(A){try{for(var C in this.controls){if((this.controls[C])&&(this.controls[C].getAttribute(microstrategy.HTMLATTR_CMD_ID)==A)){return this.controls[C];break;}}return null;}catch(B){microstrategy.errors.log(B);return null;}};mstrToolbarImpl.prototype.getCmdType=function(A){try{if(A.getAttribute(microstrategy.HTMLATTR_CMD_TYPE)==null){return mstrToolbarImpl.CMD_TYPE_SIMPLE;}else{return parseInt(A.getAttribute(microstrategy.HTMLATTR_CMD_TYPE));}}catch(B){microstrategy.errors.log(B);return null;}};mstrToolbarImpl.prototype.getButton=function(C){try{if(!C){C=window.event;}var A=findTarget(getEventTarget(C),microstrategy.HTMLATTR_SUBOBJTYPE);if(A==null){return null;}if(A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){A=A.parentNode;}if(A.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)!=microstrategy.SUBOBJTYPE_BTN){return null;}return A;}catch(B){microstrategy.errors.log(B);return null;}};mstrToolbarImpl.prototype.updatePulldownDisplayValue=function(B,A,C){try{if(B.firstChild&&B.firstChild.tagName=="SPAN"){B.firstChild.innerHTML=(A.name)?A.name:A;if(C){B.firstChild.className=C;}}else{B.innerHTML=(A.name)?A.name:A;if(C){B.className=C;}}B.setAttribute("title",A);}catch(D){microstrategy.errors.log(D);return null;}};mstrToolbarImpl.prototype.addPickerOption=function(E,K,J,F,G,C){var H=null;try{if(typeof (K)!="undefined"&&E){H=document.createElement("span");H.setAttribute("name","pkr"+J);H.setAttribute("id","pkr"+J);H.displayName=K;var I=document.createElement("span");I.className="mstrIcon-tb";if(C===12){I.className+=" attr";}H.appendChild(I);H.appendChild(document.createTextNode(K));if(F){for(var A in F){var D=F[A];H.setAttribute(A,D);}}if(G){H.className=G;}E.appendChild(H);}}catch(B){microstrategy.errors.log(B);}return H;};mstrToolbarImpl.prototype.displayVisModeButton=function(B){try{var A=this.getAppliesTo();if(A){var C=A.commands.queryEnabled(B);for(var E in this.controls){if(this.controls[E]&&this.controls[E].getAttribute(microstrategy.HTMLATTR_CMD_ID)==B){if(C&&this.visAvailable(this.controls[E].getAttribute(microstrategy.HTMLATTR_CMD_VALUE))){displayObj(this.controls[E]);}else{removeObj(this.controls[E]);}}}}}catch(D){microstrategy.errors.log(D);}};mstrToolbarImpl.prototype.visAvailable=function(D){try{var A=this.getAppliesTo();if(A){var B;if(A.doc&&A.doc.selections&&A.doc.selections.getSelectedGrid()){var F=A.doc.selections.getSelectedGrid();if(F){targetGrid=microstrategy.findBone(F);if(targetGrid){B=targetGrid.visualizationList;}}}else{B=A.visualizationList;}if(B){for(var C=0;C<B.length;C++){if(B[C].vm==D){return true;}}}}}catch(E){microstrategy.errors.log(E);}return false;};mstrToolbarImpl.prototype.removePickerOption=function(A,D){try{if(A){for(var B=0;A.childNodes&&B<A.childNodes.length;B++){if(A.childNodes[B].getAttribute("id")=="pkr"+D){A.removeChild(A.childNodes[B]);}}}}catch(C){microstrategy.errors.log(C);}};mstrToolbarImpl.prototype.disablePulldownCtrl=function(C,A){try{C.className=mstrToolbarImpl.PULLDOWN_DISABLED;var D=true;if(A!=null&&A==false){D=false;}if(D){this.updatePulldownDisplayValue(C,C.origName);}}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.enablePulldownCtrl=function(C,B){try{C.className=mstrToolbarImpl.PULLDOWN_ENABLED;if(B==null){B=C.origName;}this.updatePulldownDisplayValue(C,B);}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.enableCtrl=function(B){try{B.className=mstrToolbarImpl.PULLDOWN_ENABLED;}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.populatePulldownCtrl=function(E,B){try{var A=document.getElementById(E.getAttribute(microstrategy.HTMLATTR_CMD_PICKER));if(!A){return ;}while(A.hasChildNodes()){A.removeChild(A.firstChild);}for(var C=0;C<B.length;C++){var F=B.get(C);this.addPickerOption(A,F.text,F.value,null,undefined,F.oty);}}catch(D){microstrategy.errors.log(D);}};mstrToolbarImpl.prototype.disableCtrl=function(C,A){try{switch(this.getCmdType(C)){case mstrToolbarImpl.CMD_TYPE_PULLDOWN:this.disablePulldownCtrl(C,A);break;case mstrToolbarImpl.CMD_TYPE_COMBO:C.className=mstrToolbarImpl.COMBODOWN_DISABLED;if("true"==C.childNodes[0].getAttribute("fillColorContent")){C.childNodes[0].childNodes[0].className=mstrToolbarImpl.DISABLED;}else{C.childNodes[0].className=mstrToolbarImpl.DISABLED;}break;case mstrToolbarImpl.CMD_TYPE_CAPTION:break;case mstrToolbarImpl.CMD_TYPE_RADIO:case mstrToolbarImpl.CMD_TYPE_CHECK:if(!C.className.match(mstrToolbarImpl.RADIO_DISABLED)){C.className=C.className+"  "+mstrToolbarImpl.RADIO_DISABLED;}break;default:if(C.tagName!="A"){C.className=C.className.replace(mstrToolbarImpl.DISABLED,"")+" "+mstrToolbarImpl.DISABLED;}}if(C.getAttribute("title")){C.setAttribute("dtitle",C.getAttribute("title"));C.setAttribute("title","");}}catch(B){microstrategy.errors.log(B);}};mstrToolbarImpl.prototype.deselectAllCtrls=function(){try{for(var C in this.controls){var B=this.controls[C];switch(this.getCmdType(B)){case mstrToolbarImpl.CMD_TYPE_CHECK:case mstrToolbarImpl.CMD_TYPE_RADIO:if(!B.className.match(mstrToolbarImpl.DISABLED)){B.className=mstrToolbarImpl.ICON;}break;case mstrToolbarImpl.CMD_TYPE_PULLDOWN:if(microstrategy.EXECUTION_SCOPE!=microstrategy.REPORT_EXECUTION){this.disablePulldownCtrl(B);}break;}}}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.enable=function(F,E,B,A){try{switch(this.getCmdType(F)){case mstrToolbarImpl.CMD_TYPE_CHECK:F.className=(E)?mstrToolbarImpl.ENABLED:mstrToolbarImpl.ICON;return ;case mstrToolbarImpl.CMD_TYPE_SIMPLE:case mstrToolbarImpl.CMD_TYPE_RADIO:F.className=(E==parseInt(F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE)))?mstrToolbarImpl.ENABLED:mstrToolbarImpl.ICON;break;case mstrToolbarImpl.CMD_TYPE_PULLDOWN:if(B.commands.queryEnabled(A)){if(E&&E.currentOptionValue){this.enablePulldownCtrl(F,E.currentOptionValue);this.populatePulldownCtrl(F,E);}else{this.enablePulldownCtrl(F,E);}}else{this.disablePulldownCtrl(F);}break;case mstrToolbarImpl.CMD_TYPE_COMBO:var C=B.commands.queryEnabled(A);F.className=C?mstrToolbarImpl.COMBODOWN_ENABLED:mstrToolbarImpl.COMBODOWN_DISABLED;if("true"==F.childNodes[0].getAttribute("fillColorContent")){F.childNodes[0].childNodes[0].className=C?mstrToolbarImpl.ICON:mstrToolbarImpl.DISABLED;}else{F.childNodes[0].className=C?mstrToolbarImpl.ICON:mstrToolbarImpl.DISABLED;}break;}if(F.getAttribute("dtitle")){F.setAttribute("title",F.getAttribute("dtitle"));F.setAttribute("dtitle","");}}catch(D){microstrategy.errors.log(D);}};mstrToolbarImpl.prototype.disableToolbar=function(){try{for(var C in this.controls){var B=this.controls[C];this.disableCtrl(B);}}catch(A){microstrategy.errors.log(A);}};mstrToolbarImpl.prototype.adjustVisualization=function(B,D,I){try{if(B){if(D){var H=document.getElementById(B.getAttribute(microstrategy.HTMLATTR_CMD_PICKER));if(H){if(D.visualizationList&&D.visualizationList.length>1&&D.isVisualization){while(H.hasChildNodes()){H.removeChild(H.firstChild);}for(var F=0;F<D.visualizationList.length;F++){var A=D.visualizationList[F].name;var J=D.visualizationList[F].desc;var C=D.visualizationList[F].vm;if(D.filterVisPulldown&&C!=D.visualizationMode){continue;}var G=document.createElement("span");G.setAttribute("id",A+"|"+C);G.setAttribute("name",A);G.setAttribute("value",A);G.innerHTML=J;if(A==D.selectedVisualization){I.updatePulldownDisplayValue(B,J);B.setAttribute("value",D.selectedVisualization);}H.appendChild(G);}displayObj(B);}else{removeObj(B);return ;}}}else{removeObj(B);return ;}}}catch(E){microstrategy.errors.log(E);}};function mstrToolbarImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);delete this.inherits;return this;}mstrPulldownOptions.prototype=new Object();mstrPulldownOptions.prototype.length=0;mstrPulldownOptions.prototype.currentOptionValue="";mstrPulldownOptions.prototype.options=null;mstrPulldownOptions.prototype.add=function(C,D,A,B){this.options[this.length++]={value:C,text:D,oty:B};if(A){this.currentOptionValue=D;}};mstrPulldownOptions.prototype.get=function(A){if(A in this.options){return this.options[A];}return{value:"null",text:"Index "+A+" not found."};};mstrPulldownOptions.prototype.setSelectedOption=function(B){for(var A=0;A<this.length;A++){var C=this.get(A);if(C.value==B){this.currentOptionValue=C.text;break;}}};function mstrPulldownOptions(){this.options=new Object();return this;}mstrObserverImpl.prototype=new Object();mstrObserverImpl.prototype.items=null;mstrObserverImpl.prototype.onload=function(){if(microstrategy.observerItems){this.items=microstrategy.observerItems;microstrategy.observerItems=null;}};mstrObserverImpl.prototype.onunload=function(){microstrategy.observerItems=this.items;};mstrObserverImpl.prototype.register=function(A){if(typeof (this.items[A])=="undefined"){this.items[A]=A;}return true;};mstrObserverImpl.prototype.unregister=function(A){if(typeof (this.items[A])!="undefined"){delete this.items[A];}return true;};mstrObserverImpl.prototype.notifyAll=function(A,D){try{for(var E in this.items){var C=mstr.$obj(E);if(C&&A in C){C[A](D);}}return true;}catch(B){microstrategy.errors.log(B);return false;}};function mstrObserverImpl(A){this.items=new Object();return this;}mstrSerializer.prototype=new Object;mstrSerializer.prototype.buffer="";mstrSerializer.prototype.needDelim=false;mstrSerializer.CH_ESCAPE="*";mstrSerializer.CH_DELIM=".";mstrSerializer.CH_BRA="-";mstrSerializer.CH_KET="_";mstrSerializer.CH_LESS="<";mstrSerializer.STR_NULL="*0";mstrSerializer.prototype.getState=function(){try{return this.buffer;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addStr=function(B){try{if(this.needDelim){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(B);this.needDelim=true;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addInt=function(B){try{this.addStr(B+"");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addBoolean=function(B){try{this.addStr(B?"1":"0");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addValues=function(A){try{this.buffer+=mstrSerializer.CH_BRA;for(var B=0;B<A.length;B++){if(B>0){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(A[B]);}this.buffer+=mstrSerializer.CH_KET;this.needDelim=false;}catch(C){microstrategy.errors.log(C);return false;}};mstrSerializer.prototype.appendValue=function(C){try{var A=new RegExp("[\\"+mstrSerializer.CH_ESCAPE+"\\"+mstrSerializer.CH_BRA+"\\"+mstrSerializer.CH_KET+"\\"+mstrSerializer.CH_DELIM+"\\"+mstrSerializer.CH_LESS+"]","g");var D=mstrSerializer.CH_ESCAPE+"$&";C=String(C).replace(A,D);this.buffer+=C;}catch(B){microstrategy.errors.log(B);return false;}};function mstrSerializer(){return this;}mstrUpdateManager.prototype=new Object;mstrUpdateManager.prototype.id="bonesUpdateManager";mstrUpdateManager.prototype.observer=null;mstrUpdateManager.prototype.actions={};mstrUpdateManager.prototype.redoActions=[];mstrUpdateManager.prototype.undoActions=[];mstrUpdateManager.prototype.staticActions=[];mstrUpdateManager.prototype.useIframe=false;mstrUpdateManager.prototype.newWindow=false;mstrUpdateManager.prototype.newWindowName="_blank";mstrUpdateManager.prototype.extraURL="";mstrUpdateManager.prototype.iframeTarget="frameManager";mstrUpdateManager.prototype.formAction="";mstrUpdateManager.prototype.OPTIMIZE_EVENTS=true;mstrUpdateManager.prototype.ADD_EVENT_IDS=null;mstrUpdateManager.prototype.optActions=[];mstrUpdateManager.prototype.lastPosArray=[];mstrUpdateManager.prototype.copyActions={};mstrUpdateManager.prototype.cachedActionCollection=null;mstrUpdateManager.prototype.queueActions=false;mstrUpdateManager.prototype.forceSubmitAfterQueue=false;mstrUpdateManager.prototype.ctlCurElementsPosition=null;mstrUpdateManager.prototype.currentPanelPosition=null;mstrUpdateManager.prototype.hiddenInputs=null;mstrUpdateManager.prototype.submittedForm=null;mstrUpdateManager.prototype.submittedXhr=false;mstrUpdateManager.prototype.newActions=false;mstrUpdateManager.prototype.sTimeOutID=null;mstrUpdateManager.prototype.callback=null;mstrUpdateManager.UNIT_SEPARATOR=",";mstrUpdateManager.ITEM_SEPARATOR=";";mstrUpdateManager.UPDATE_LATER="0";mstrUpdateManager.UPDATE_NOW="1";mstrUpdateManager.STATIC_ACTION=-1;mstrUpdateManager.ARG_KEY_SEPARATOR="_";mstrUpdateManager.addEvent=function(A){if(!mstrUpdateManager.actions){mstrUpdateManager.actions={};}for(var B in A){var C=A[B].i;mstrUpdateManager[B]=C;mstrUpdateManager.actions[C]={eventID:C,paramName:A[B].n,paramID:A[B].p};}mstrUpdateManager.newActions=true;};mstrUpdateManager.prototype.addSingleAction=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection.push(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getUseIFrame=function(){try{return this.useIframe;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setUseIFrame=function(B){try{this.useIframe=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getNewWindowSetting=function(){try{return this.newWindow;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setNewWindowSetting=function(B){try{this.newWindow=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.addActionCollection=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection=this.cachedActionCollection.concat(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.hasCachedActions=function(){try{return(this.cachedActionCollection&&this.cachedActionCollection.length>0);}catch(A){microstrategy.errors.log(A);}return false;};mstrUpdateManager.prototype.addCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.add(this.cachedActionCollection,false);this.cachedActionCollection=null;if(this.forceSubmitAfterQueue){this.flushAndSubmitChanges();}}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.killCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.cachedActionCollection=null;}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.add=function(C,A){try{if(this.queueActions){if(C.length){this.addActionCollection(C);}else{this.addSingleAction(C);}}else{if(A){this.staticActions.push(C);this.redoActions.unshift(mstrUpdateManager.STATIC_ACTION);this.newActions=true;}else{this.clearRedoActions();this.undoActions.push(C);this.newActions=true;}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","add",C);if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.addURL=function(A){try{if(A){if(this.extraURL.length>0){this.extraURL+="&"+A;}else{this.extraURL=A;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.replaceURL=function(A,D){try{if(this.extraURL.length>0){if(this.extraURL.indexOf(A)>-1){var E=this.extraURL.substring(0,this.extraURL.indexOf(A)-2);var C=this.extraURL.indexOf("&",this.extraURL.indexOf(A));if(E==null||E.length==0){E="";}else{E+="&";}if(C>this.extraURL.indexOf(A)){this.extraURL=E+this.extraURL.substring(C+1,this.extraURL.length)+"&"+A+"="+D;}else{this.extraURL=A+"="+D;}}else{this.extraURL+="&"+A+"="+D;}}else{this.extraURL=A+"="+D;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.processUndoRedo=function(C,D){try{while(C.length>0){var B=C.pop();D.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;}}}catch(A){microstrategy.errors.log(A);}return null;};mstrUpdateManager.prototype.broadcastUpdate=function(){try{while(source.length>0){var B=source.pop();target.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;break;}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.undo=function(C){try{var D=false;C=C||1;for(var A=0;A<C;A++){var F=this.processUndoRedo(this.undoActions,this.redoActions);if(F){for(var B=0;B<F.length;B++){microstrategy.eventManager.notifyOrphanBones("onundo",new mstrUndoObj(F[B]));}D=true;}}if(D){microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","undo");}if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.redo=function(){try{var C=this.processUndoRedo(this.redoActions,this.undoActions);if(C){for(var A=0;A<C.length;A++){microstrategy.eventManager.notifyOrphanBones("onredo",new mstrRedoObj(C[A]));}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","redo");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.getPendingEventsForTask=function(A){var E;var J;var B=0;var N=[];var D=A.split(".");var C=D[D.length-1];var F=this.optActions;this.optActions=[];if(this.OPTIMIZE_EVENTS){for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;this.createOptimizedArray(H);G.splice(M,1);M=M-1;}}}for(var I=0;I<this.optActions.length;I++){if(this.optActions[I].id!=null){N.push(this.createEventForAction(this.optActions[I]));}}this.postOptimizationCleanup();}else{for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;N.push(this.createEventForAction(H));G.splice(M,1);M=M-1;}}}}this.optActions=F;if(N.length>0){var L=new mstrSerializer();L.addValues(N);return L.getState();}else{return"";}};mstrUpdateManager.prototype.flushChanges=function(I){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){addURLAsHiddenInputsToForm(I,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){this.createOptimizedArray(D[H]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){J.push(this.createEventForAction(D[H]));}}}var G=new mstrSerializer();G.addValues(J);if(I.getAttribute("hasUpdateChanges")=="true"){updateDynamicInput(I,mstrUpdateManager.multipleEventArgName,G.getState());}else{this.submittedForm=I;this.hiddenInputs=[];this.createHiddenInput(I,mstrUpdateManager.multipleEventArgName,G.getState());this.createHiddenInput(I,"evt",mstrUpdateManager.multipleEventID);this.createHiddenInput(I,"src",mstrUpdateManager.multipleEventSrc);this.createHiddenInput(I,mstrUpdateManager.multipleEventID,"1");I.setAttribute("hasUpdateChanges","true");}if(this.newWindow){I.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.flushChangesAsParams=function(G){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){UpdateHelper.addURLToParams(G,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){this.createOptimizedArray(D[I]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){J.push(this.createEventForAction(D[I]));}}}var H=new mstrSerializer();H.addValues(J);if(G.hasUpdateChanges=="true"){G[mstrUpdateManager.multipleEventArgName]=H.getState();}else{this.submittedXhr=true;UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventArgName,H.getState());UpdateHelper.addAdditionalParam(G,"evt",mstrUpdateManager.multipleEventID);UpdateHelper.addAdditionalParam(G,"src",mstrUpdateManager.multipleEventSrc);UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventID,"1");G.hasUpdateChanges=="true";}if(this.newWindow){G.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.createHiddenInput=function(D,B,C){var A=createHiddenInput(D,B,C);this.hiddenInputs.push(A);};mstrUpdateManager.prototype.postOptimizationCleanup=function(A){if(this.fullScreenModePosition){delete this.fullScreenModePosition;}if(this.lTbarBrowserSettingPosition){delete this.lTbarBrowserSettingPosition;}if(this.ctlCurElementsPosition){delete this.ctlCurElementsPosition;}if(this.currentPanelPosition){delete this.currentPanelPosition;}if(this.widgetPropEdits){delete this.widgetPropEdits;}this.optActions=[];this.lastPosArray=[];};mstrUpdateManager.prototype.createEventForAction=function(G){try{var A=mstrUpdateManager.actions[G.id];var E=new mstrSerializer();E.addStr(A.eventID);E.addStr(G.beanPath+"."+A.eventID);var D="";for(var C=0;C<G.newArgs.length;C++){actionID=G.argID[C];for(var B=0;B<A.paramID.length;B++){if(A.paramID[B]==actionID){if(false){D+="<arg name='"+A.paramName[B]+"' v='"+G.newArgs[C]+"' />";}if(G.argKey==null){E.addStr(A.paramName[B]);}else{E.addStr(A.paramName[B]+mstrUpdateManager.ARG_KEY_SEPARATOR+G.argKey);}E.addStr(G.newArgs[C]);break;}}}if(false){alert(D);}return E.getState();}catch(F){microstrategy.errors.log(F);return false;}};mstrUpdateManager.prototype.flushAndSubmitChanges=function(C,H){this.callback=H||{};var B=this,G=this.callback.success,F=this.callback.noRefresh;this.callback.success=function(I){if(G){G(I);}if(!F&&I&&I.status=="6"){B.refreshPage();}};try{if(useXHR&&!C){mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var A=UpdateHelper.createParamsFromURL(this.getFormAction(),this.useIframe&&!this.newWindow);this.flushing=true;UpdateHelper.submitRequest(A);}else{mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var D=createDynamicForm(this.getFormAction());if(this.useIframe&&!this.newWindow){addURLAsHiddenInputsToForm(D,"iframe=true");D.target=this.iframeTarget;}this.flushing=true;submitForm(D,C);}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.acknowledgeRequest=function(){try{this.undoActions=[];this.redoActions=[];this.staticActions=[];this.optActions=[];this.lastPosArray=[];this.copyActions={};this.newWindow=false;microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}var B;if(this.submittedForm!=null){for(var A=0;A<this.hiddenInputs.length;A++){B=this.hiddenInputs[A];try{this.submittedForm.removeChild(B);}catch(C){if((C&&C.code!=8)&&(C.number&&C.number!=-2147024809)){throw (C);}}}this.submittedForm.setAttribute("hasUpdateChanges","false");this.submittedForm=null;this.hiddenInputs=null;this.flushing=false;}if(this.submittedXhr){this.submittedXhr=false;this.flushing=false;}}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.isFlushing=function(){return !!this.flushing;};mstrUpdateManager.prototype.acknowledgeReloadEnd=function(){if(this.observer){this.observer.notifyAll("acknowledgeReloadEnd");}};mstrUpdateManager.prototype.getFixStateActions=function(){try{var E=[];for(var B=0;B<this.staticActions.length;B++){var D=this.staticActions[B];for(var A=0;A<D.length;A++){E.push(D[A]);}}return E;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.hasChangesToSubmit=function(){try{return(this.undoActions.length>0||this.isRedoStatic()||(this.extraURL!=null&&this.extraURL.length>0));}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.hasNewChanges=function(){try{var A=this.newActions;this.newActions=false;return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.clearRedoActions=function(){try{while(this.redoActions.length>0){var B=this.redoActions.pop();if(B==mstrUpdateManager.STATIC_ACTION){this.undoActions.push(B);}}}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.getLastAction=function(){try{return this.undoActions.pop();}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.isRedoStatic=function(){try{var C=false;for(var A=0;A<this.redoActions.length;A++){if(this.redoActions[A]==mstrUpdateManager.STATIC_ACTION){C=true;break;}}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.anyNonStatic=function(B){try{var A=(B)?this.redoActions:this.undoActions;var E=false;for(var C=0;C<A.length;C++){if(A[C]!=mstrUpdateManager.STATIC_ACTION){E=true;break;}}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createActionObject=function(C,A,G,H,B,F,J,I){try{var E={};E.elem=C;E.id=A;E.beanPath=G;E.argID=H;E.newArgs=B;E.oldArgs=F;E.cachedArray=J;E.argKey=I;if(A==mstrUpdateManager.EDIT_PROPS){E.formatType=microstrategy.formatType;E.argID.push("2048131");E.newArgs.push(microstrategy.formatType);E.oldArgs.push(microstrategy.formatType);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createOptimizedArray=function(G){try{var I=G.id;if(!this.ADD_EVENT_IDS){this.ADD_EVENT_IDS=mstrUpdateManager.ADD_TEXT+"|"+mstrUpdateManager.ADD_LINE+"|"+mstrUpdateManager.ADD_SHAPE+"|"+mstrUpdateManager.ADD_TEMPLATE+"|"+mstrUpdateManager.ADD_DATASET_TEMPLATE+"|"+mstrUpdateManager.ADD_IMAGE+"|"+mstrUpdateManager.ADD_HTML_CONTAINER+"|"+mstrUpdateManager.ADD_PANEL_STACK+"|"+mstrUpdateManager.CTRL_ADD+"|";}var N=(G.elem)?G.elem.id:null;var B=N;if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="4146"){B=N+G.newArgs[K].split("!")[0]+G.newArgs[K].split("!")[1]+G.newArgs[K].split("!")[2];break;}}}var P;if(I==mstrUpdateManager.EDIT_PROPS){for(var K=0,D=G.argID.length;K<D;K++){if(G.argID[K]=="2048035"){var J=G.newArgs[K].split(mstrUpdateManager.UNIT_SEPARATOR);if(J[1]=="FormattingWidget"&&J[2]=="WidgetProps"){var C=this.widgetPropEdits||{};if(J[0] in C){this.optActions[C[J[0]]].id=null;}C[J[0]]=this.optActions.length;this.widgetPropEdits=C;}break;}}this.optActions.push(G);}else{if(I==mstrUpdateManager.COPY_TO_CLIPBOARD||I==mstrUpdateManager.CUT_TO_CLIPBOARD){P=G.newArgs[0].split(CLIPBOARD_ITEM_SEPARATOR);for(var K=0;K<P.length;K++){this.copyActions[P[K]]={};this.copyActions[P[K]].position=this.optActions.length;this.copyActions[P[K]].applied=false;}this.optActions.push(G);}else{if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES||I==mstrUpdateManager.EDIT_TEXT||I==mstrUpdateManager.SET_TOPLEFT_POSITION||I==mstrUpdateManager.CHANGE_BONE_PROPERTY){if(!this.lastPosArray[I]){this.lastPosArray[I]={};}if(this.copyActions[N]&&this.copyActions[N].applied==false){this.copyActions[N].applied=true;for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}else{if(this.lastPosArray[I][B]){var L=this.lastPosArray[I][B].position;var F=this.optActions[L];var H=mstr.$A.find(F.argID,"2048007");if(H==-1){H=null;}var M=mstr.$A.find(F.argID,"2048007");if(M==-1){H=null;}if(M==H){F.newArgs=G.newArgs;}else{this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}else{this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}}else{if(I==mstrUpdateManager.REMOVE_OBJECT){if(this.copyActions[N]){for(var K=this.copyActions[N].position;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N){this.optActions[K].id=null;}}delete this.copyActions[N];for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}}else{for(var K=0;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N&&!this.ADD_EVENT_IDS.contains(this.optActions[K].id,"|")){this.optActions[K].id=null;}}}this.optActions.push(G);}else{if(I==mstrUpdateManager.SWITCH_FULL_SCREEN_MODE){if(typeof (this.fullScreenModePosition)!="undefined"&&this.optActions[this.fullScreenModePosition]&&this.optActions[this.fullScreenModePosition].newArgs&&this.optActions[this.fullScreenModePosition].id==I){this.optActions[this.fullScreenModePosition].newArgs=G.newArgs;}else{this.fullScreenModePosition=this.optActions.length;this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING){if(G.argID[0]=="5005"&&G.newArgs[0]=="lTbar"){if(typeof (this.lTbarBrowserSettingPosition)!="undefined"&&this.optActions[this.lTbarBrowserSettingPosition]&&this.optActions[this.lTbarBrowserSettingPosition].newArgs){this.optActions[this.lTbarBrowserSettingPosition].newArgs=G.newArgs;}else{this.lTbarBrowserSettingPosition=this.optActions.length;this.optActions.push(G);}}else{this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_CUR_CTL_ELEMENTS){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="2048130"){this.ctlCurElementsPosition=this.ctlCurElementsPosition||{};var A=G.newArgs[K];if(A in this.ctlCurElementsPosition){this.optActions[this.ctlCurElementsPosition[A]].id=null;}this.ctlCurElementsPosition[A]=this.optActions.length;this.optActions.push(G);break;}}}else{if(I==mstrUpdateManager.SET_CURRENT_PANEL){var O=G.newArgs[0];if(!this.currentPanelPosition){this.currentPanelPosition={};}if(typeof (this.currentPanelPosition[O])!="undefined"){this.optActions.splice(this.currentPanelPosition[O],1);}this.currentPanelPosition[O]=this.optActions.length;this.optActions.push(G);}else{this.optActions.push(G);}}}}}}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.getFormAction=function(){if(!this.formAction){this.formAction=microstrategy.servletName;}return this.formAction;};mstrUpdateManager.prototype.setFormAction=function(A){this.formAction=A;};mstrUpdateManager.createPropertyEditString=function(C,B,G,A,H){try{var F=mstrFormatObject;if(!F){return"";}if(!A){G=F.encodeValue(B,G);}var D=C||"";if(D){D+=mstrUpdateManager.UNIT_SEPARATOR;}return D+(H||F.getPropertySetName(B))+mstrUpdateManager.UNIT_SEPARATOR+F.getPropertyName(B)+mstrUpdateManager.UNIT_SEPARATOR+G+mstrUpdateManager.ITEM_SEPARATOR;}catch(E){microstrategy.errors.log(E);return"";}};mstrUpdateManager.prototype.createEditPropsAction=function(F,J,S,I,Q,D,A,L,K,R){try{var E=(A)?mstrUpdateManager.UPDATE_NOW:mstrUpdateManager.UPDATE_LATER;var M=mstrUpdateManager.createPropertyEditString;var O=K?"1":"0";var H="",C="";for(var N=0;N<I.length;N++){H+=M(J,I[N],Q[N],R);if(D&&(N in D)){C+=M(J,I[N],D[N]);}}var B=K?["2048018","2048035","2048241"]:["2048018","2048035"],G=K?[E,H,O]:[E,H];return this.createActionObject(F,mstrUpdateManager.EDIT_PROPS,S,B,G,(C&&[E,C])||[],L);}catch(P){microstrategy.errors.log(err);return null;}};mstrUpdateManager.prototype.findRwbInputOnPageStateForm=function(){var C=getObj("pageStateForm");var B=C.getElementsByTagName("INPUT");for(i=0,cnt=B.length;i<cnt;i++){var A=B[i];if(A.name==="rwb"){return A;}}return null;};mstrUpdateManager.prototype.getRWBState=function(A){if(A){var B=this.findRwbInputOnPageStateForm();if(B){return B.value;}}else{if(pageState){var C=(pageState+"&").match(/rwb=(.*?)\&/);if(C!=-1){return C[1];}}}return"";};mstrUpdateManager.prototype.setRWStateInForm=function(A){var B=this.findRwbInputOnPageStateForm();if(B){B.value=A;}};mstrUpdateManager.prototype.refreshPage=function(){try{this.useIframe=false;var B=this.createActionObject(null,mstrUpdateManager.PAGE_REFRESH,microstrategy.servletName+"."+microstrategy.pageName,[],[],[],null);this.add([B],true);this.flushAndSubmitChanges();}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.submitPartialUpdate=function(C){try{microstrategy.puStatus=0;iframe.notifyParent(true);if(!this.partialUpdateModel){this.partialUpdateModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.partialUpdateModel);var A=this.partialUpdateModel&&this.partialUpdateModel&&this.partialUpdateModel.init();if(!("id" in this)||!mstr.$obj(this.id)){mstr.controllers.Factory.add(this);}this.partialUpdateModel.attachEventListener(this,"set_readyState","handleStateChange");}C.processorClass=mstr.http.PUProcessor;this.partialUpdateModel.execSubmit({params:C,callback:this.callback});}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.handleStateChange=function(evt){try{switch(evt.memo.value){case mstr.Enum.Widget.READYSTATE.TIMEOUT:case mstr.Enum.Widget.READYSTATE.ERROR:break;case mstr.Enum.Widget.READYSTATE.SUCCESS:var updateResult=evt.src.get("requestContext").response.data;if(updateResult){if(updateResult.status=="2"){iframe.showWaitPage();}else{iframe.hideWaitPage();}UpdateHelper.replaceComponents(updateResult.components);document.title=updateResult.title;if(updateResult.status=="2"){this.doRedirect(updateResult.redirectURL,updateResult.waitSeconds);}microstrategy.eventManager.executeFunction("microstrategy.eventManager.onreload()");if(updateResult.script){eval(updateResult.script);}microstrategy.puStatus=1;}else{if(window.document.readyState=="complete"){var sMarkup=evt.src.get("requestContext").response.text;if(bIsIE6&&!bIsIE7){document.write(sMarkup);}else{var oNewDoc=window.document.open("text/html");if(sMarkup.indexOf("<!DOCTYPE")==-1){oNewDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd " >');}oNewDoc.write(sMarkup);oNewDoc.close();}}}delete this.callback;break;}}catch(err){microstrategy.errors.log(err);}};mstrUpdateManager.prototype.doRedirect=function(C,A){try{this.sTimeOutID=window.setTimeout('microstrategy.updateManager.timedRedirect("'+C+'")',A*1000);}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.timedRedirect=function(C){try{window.clearTimeout(this.sTimeOutID);var A=UpdateHelper.createParamsFromURL(C);UpdateHelper.submitRequest(A);}catch(B){microstrategy.errors.log(B);}};function mstrUpdateManager(){this.commands=new UpdateManagerCommands(this);if(typeof (mstrObserverImpl)!="undefined"){this.observer=new mstrObserverImpl();}return this;}if(typeof (microstrategy)!="undefined"){microstrategy.updateManager=new mstrUpdateManager();}mstrUndoObj.prototype={};function mstrUndoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.oldArgs;this.cachedArray=A.cachedArray;return this;}mstrRedoObj.prototype={};function mstrRedoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.newArgs;this.cachedArray=A.cachedArray;return this;}function UpdateManagerCommands(A){this.queryVisible=function(B){return true;};this.queryEnabled=function(B){switch(B){case"redo":return A.anyNonStatic(true);case"undo":return A.anyNonStatic(false);case"apply":return A.hasChangesToSubmit();default:return false;}};this.queryState=function(B){return false;};this.exec=function(B,C){switch(B){case"redo":return A.redo();case"undo":return A.undo();case"apply":A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return A.flushAndSubmitChanges();default:return false;}};return this;}var UpdateHelper=new function(){};UpdateHelper.prototype=new Object();UpdateHelper.createParamsFromURL=function(B,G){var C={method:"post"};var H=B.indexOf("?")>0;var F=B.indexOf("#")>0;var E=(B.indexOf("iframe=true")>0||G);var D=((H)?B.substring(0,B.indexOf("?")):B);if(F){var A="";B=moveAnchor(B);A=B.substring(B.indexOf("#"));D=D.replace(A,"")+A;B=B.substring(0,B.indexOf("#"));}D=microstrategy.addJSessionID(D);if(H){UpdateHelper.addURLToParams(C,B);}C.iframe=(E)?"true":"false";C.action=D;return C;};UpdateHelper.createParamsFromForm=function(I,J,F,H){var G=getObj(I);var C=microstrategy.findChildrenWithAtt(G,["INPUT","SELECT","TEXTAREA"],"name");var B={action:G.action,method:G.method};if(typeof G.target!=undefined){B.target=G.target;}for(var D=0;D<C.length;D++){var A=C[D];if(H===true&&A.ps===true){continue;}if(A.type=="select-multiple"&&A.options&&A.options.length>0&&A.disabled!=true){for(var E=0;E<A.options.length;E++){if(UpdateHelper.shouldSubmit(A.options[E])){UpdateHelper.addAdditionalParam(B,A.name,A.options[E].value);}}}else{if(UpdateHelper.shouldSubmit(A)){UpdateHelper.addAdditionalParam(B,A.name,A.value);}}}if(J){B[J]=F;}return B;};UpdateHelper.shouldSubmit=function(A){if(A.disabled==true){return false;}if(A.type=="submit"||A.type=="button"||A.type=="image"||A.value=="undefined"){return false;}if(A.type=="radio"||A.type=="checkbox"){if(!A.getAttribute("agg")){return A.checked;}else{A.value=A.checked?"true":"false";return true;}}if(A.tagName.toLowerCase()=="option"){return A.selected;}return true;};UpdateHelper.addURLToParams=function(D,F,C){F=F.substring(F.indexOf("?")+1,F.length);var G=F.split("&");var I="";var E="";var A="";var H=/\+/g;for(var B=0;B<G.length;B++){I=G[B].split("=");E=I[0];A=I[1];if(A){A=decodeURIComponent(A.replace(H," "));}if(C){D[E]=A;}else{UpdateHelper.addAdditionalParam(D,E,A);}}return false;};UpdateHelper.addAdditionalParam=function(A,B,C){if(A[B]&&typeof A[B]!="object"){A[B]=[A[B],C];}else{if(A[B]&&A[B].push){A[B].push(C);}else{A[B]=C;}}};UpdateHelper.submitRequest=function(H){var N=getObj("pageStateForm");var E=null;var I=null;var G;var F;var C;var O;UpdateHelper.appendPageStateToParams(H);if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){var L=microstrategy.bones.rwb_viewer;H.docSelections=L.commands.queryState("selectionsKey");L.adjustScrollValues();H.viewerScroll=L.dScrollTop+","+L.dScrollLeft;H.isLocked=(L.insertionControlLocked)?1:0;var M=L.doc.currentControlSubtype?"|"+L.doc.currentControlSubtype:"";H.currentControl=L.doc.currentControl+M;}if(typeof (microstrategy)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){for(var A in microstrategy.bones){if(microstrategy.bones[A]!=null&&microstrategy.bones[A].type==microstrategy.OBJTYPE_GRID){var B=microstrategy.bones[A];if(B&&B.gridStructureInfo&&!B.gridStructureInfo.emptyCase&&!B.gridStructureInfo.isEmptyTemplate){if(B.isGrid){var K=B.commands.queryState("selections");if(K){H[B.id]=K;}}if(B.isGraph&&A.indexOf("_graph")==-1){H[B.id+"_gs"]=B.commands.queryState("graphSelections");}}}}}if(H.iframe=="true"){microstrategy.updateManager.submitPartialUpdate(H);}else{var J=UpdateHelper.createFormFromParams(H);UpdateHelper.appendPageSizeToParams(J);if(mstr.utils.ISSAFARI&&J.target=="_blank"){J.action+=(J.action.indexOf("?")==-1?"?":"&");J.action+="t="+new Date().getTime();}try{microstrategy.submitForm(J);}catch(D){if(J.target!=""&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){showMessage({contents:microstrategy.descriptors.getDescriptor("5877"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.errors.log(D);}}}return false;};UpdateHelper.createFormFromParams=function(A){var C=document.createElement("FORM");C.name="dynamic_form";C.method=A.method;delete A.method;C.action=A.action;delete A.action;if(typeof A.target!="undefined"){C.target=A.target;delete A.target;}C.setAttribute("hasUpdateChanges",A.hasUpdateChanges=="true");for(var D in A){if(A[D]){if(typeof A[D]=="object"){for(var B=0;B<A[D].length;B++){if(A[D][B]){createHiddenInput(C,D,A[D][B]);}}}else{createHiddenInput(C,D,A[D]);}}}document.body.insertAdjacentElement("beforeEnd",C);return C;};UpdateHelper.submitFormThroughXHR=function(B,D){if(D){if(!B){B=window.event;}var B=getEventTarget(B);if(!B){return false;}}var F=microstrategy.findAncestorWithTag(B,"FORM");var C=B.name;var A=B.value;if(typeof F=="undefined"||typeof C=="undefined"||typeof A=="undefined"){return false;}var E=UpdateHelper.createParamsFromForm(F,C,A,true);UpdateHelper.appendPageStateToParams(E);microstrategy.updateManager.submitPartialUpdate(E);return false;};UpdateHelper.appendPageStateToParams=function(A){var E=getObj("pageStateForm");var D=null;var B=(typeof (microstrategy)!="undefined")?microstrategy.updateManager:null;var C;if(B&&B.hasChangesToSubmit()){B.flushChangesAsParams(A);UpdateHelper.addEvtOrderToParams(A,mstrUpdateManager.multipleEventID);}if(E){if(A.method=="get"||A.method=="GET"){UpdateHelper.addURLToParams(A,pageState,true);}else{D=E.getElementsByTagName("INPUT");for(C=0;C<D.length;C++){A[D[C].name]=D[C].value;}}}};UpdateHelper.appendPageSizeToParams=function(A){createHiddenInput(A,"innerWidth",getClientWidth());createHiddenInput(A,"innerHeight",getClientHeight());};UpdateHelper.submitLink=function(F){var H;H=F.href;var C;C=F.target;var G=document.getElementById("cssAnalyzerToolbar");var A=(getCookie(ENABLE)=="true")&&(G!=null);if(A){return false;}window.mstrSubmitLink=true;if(C=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){var B=UpdateHelper.createParamsFromURL(H);if(C){B.target=C;}UpdateHelper.submitRequest(B);return false;}if(typeof (pageState)!="undefined"){var D=updateLink(H);D=moveAnchor(D);var E=null;if(bIsIE6&&F.childNodes&&(F.childNodes.length==1)&&F.childNodes[0].nodeType==3){E=F.innerHTML;}F.href=D;if(bIsIE6&&E!=null){F.innerHTML=E;}return true;}else{return true;}};UpdateHelper.addEvtOrderToParams=function(A,B,C){if(A.evtorder){if(A.evtorder.indexOf(B)<0){if(C){A.evtorder=A.evtorder+","+B;}else{A.evtorder=B+","+A.evtorder;}A[B]="1";}}else{A.evtorder=B;if(A.evt&&A.evt.length<3){for(j=0;j<A.evt.length;j++){A[A.evt[j]]="1";}}}};UpdateHelper.replaceComponents=function(A,G){try{if(!G){iframe.consolidatedStyles={};iframe.isProcessing=true;if(!bIsW3C){iframe.togglePulldownChildren(document.body,false);}}var C;for(C=0;C<A.length;C++){var F=A[C];if(F&&F.ISEMPTY!="true"){if(F.errBox!="true"||currentModalEditor.length==0){UpdateHelper.updateComponent(F,G);}else{var E=F.content;if(E.length>0){showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}}}}if(!G){for(var B in iframe.consolidatedStyles){updateStyleContainer(iframe.consolidatedStyles[B],B);}if(!bIsW3C){iframe.togglePulldownChildren(document.body,true);}iframe.targets=null;microstrategy.loadDynamicJS();microstrategy.registerNewBones();}}catch(D){microstrategy.errors.log(D);}};UpdateHelper.updateComponent=function(cB,parentId){try{var sReplaceHTML;var aScripts=null;var j;var oParentDiv;if(!cB.id){return ;}if(cB.components&&cB.components.length>1){UpdateHelper.replaceComponents(cB.components,cB.id);return ;}else{if(cB.components&&cB.components.length==1){return ;}}if(cB.slid){var slices=document.getElementsByName(cB.id);if(slices&&slices.length>0){for(var i=0,len=slices.length;i<len;i++){if(slices[i].getAttribute("slid")==cB.slid){oParentDiv=slices[i];break;}}}}if(!oParentDiv){var oParentDivs=document.getElementById(cB.id);if(!oParentDivs&&(cB.dialog||cB.css=="1")){iframe.createPlaceHolder(cB.id);oParentDivs=document.getElementById(cB.id);}if(oParentDivs){if(oParentDivs.length>1){for(var i=0;i<oParentDivs.length;i++){if(oParentDivs[i].tagName=="DIV"){oParentDiv=oParentDivs[i];break;}}}else{oParentDiv=oParentDivs;}}}if(oParentDiv){var sReplaceHTML=cB.content.replace(/'/g,"'");if(cB.message=="true"){showMessage({contents:sReplaceHTML,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}var scriptArray=[],chartArray=[];var oDivNode=iframe.createElementFromHTML(sReplaceHTML);if(!oDivNode){return ;}iframe.extractScript(oDivNode,scriptArray);iframe.extractImage(oDivNode,chartArray);if(cB.errorInfo){var errorHolder=document.getElementById("errorInfo");if(errorHolder){errorHolder.innerHTML+=cB.errorInfo;}}if(cB.css=="1"){var styleId=oDivNode.getAttribute("styleid");if(!iframe.consolidatedStyles[styleId]){iframe.consolidatedStyles[styleId]=[];}iframe.consolidatedStyles[styleId]=consolidateStyleSheets(oDivNode,iframe.consolidatedStyles[styleId],styleId);}else{if(oParentDiv.getAttribute(mstrHTMLAttributes.ATTR_MODAL)=="true"||(oParentDiv.popupMask)){togglePulldowns(oParentDiv,true);}if(cB.partialUpdate=="true"&&oParentDiv.childNodes.length>1){oParentDiv.innerHTML=oDivNode.innerHTML;}else{if(bIsW3C&&!bIsIE8&&!bIsIE9&&!bIsIE10&&!bIsSafari){iframe.setOuterHTML(oParentDiv,oDivNode);}else{if(oParentDiv&&oDivNode){if(cB.isFlashVis&&bIsIE8){var o=oParentDiv.getElementsByTagName("object");if(o&&o.length>0){for(var i=0;i<o.length;i++){o[i].parentNode.removeChild(o[i]);}}}oParentDiv.parentNode.replaceChild(oDivNode,oParentDiv);}if(chartArray.length>0){for(var j=0,cnt=chartArray.length;j<cnt;j++){chartArray[j].src=chartArray[j].getAttribute("dsrc");}}}}for(var i=0,len=scriptArray.length;i<len;i++){eval(scriptArray[i].toString());}}}}catch(err){microstrategy.errors.log(err);}};mstrContactsEditorImplScript=true;mstrContactsEditorImpl.prototype=new mstrEditorImpl();mstrContactsEditorImpl.prototype.searchBox=null;mstrContactsEditorImpl.prototype.addressName=null;mstrContactsEditorImpl.prototype.addressValue=null;mstrContactsEditorImpl.prototype.device=null;mstrContactsEditorImpl.prototype.searchBtn=null;mstrContactsEditorImpl.prototype.addToRecipientsBtn=null;mstrContactsEditorImpl.prototype.onload=function(){try{this.initializing=true;this.initEditor();this.initializing=false;this.searchBox=microstrategy.findChildWithAtt(this.elem,"input","id","searchName");this.searchBtn=microstrategy.findChildWithAtt(this.elem,"input","id","cartSearchButton");this.addressName=document.getElementById("addressName");this.addressValue=document.getElementById("addressValue");this.device=document.getElementById("device");this.addToRecipientsBtn=document.getElementById("addToRecipientsBtn");if(this.elem){this.elem.onkeydown=new Function("e","return microstrategy.bone('"+this.id+"').onKeyDown(e);");}if(this.searchBtn){this.searchBtn.onclick=new Function("e","return microstrategy.bone('"+this.id+"').onsearch(e);");}if(this.addToRecipientsBtn){this.addToRecipientsBtn.onclick=new Function("e","return microstrategy.bone('"+this.id+"').onAddToRecipients(e);");}}catch(A){microstrategy.errors.log(A);return false;}};mstrContactsEditorImpl.prototype.getCartBone=function(){try{return microstrategy.bone(this.id+"_cart");}catch(A){microstrategy.errors.log(A);return null;}};mstrContactsEditorImpl.prototype.onKeyDown=function(B){try{if(!B){B=window.event;}if(B.keyCode==13){var C=getEventTarget(B);if(C==this.searchBox&&this.onsearch){this.onsearch();}if((C==this.addressName||C==this.addressValue)&&this.onsearch){this.onAddToRecipients();}if(bIsIE4){stopEventBubbling(B);}return false;}}catch(A){microstrategy.errors.log(A);return false;}};mstrContactsEditorImpl.prototype.onsearch=function(C){try{if(this.searchBox){this.updateSelections();if(!this.searchBox.value){this.searchBox.value="";}this.searchBox.value=trim(this.searchBox.value);var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.CONTACT_BROWSER_SET_SEARCH,this.beanPath,["100001"],[this.searchBox.value],[],null)]);A.useIframe=(this.useIframe!=false);A.flushAndSubmitChanges(false,{noRefresh:true});return false;}}catch(B){microstrategy.errors.log(B);return false;}};mstrContactsEditorImpl.prototype.onAddNewPersonalRecipient=function(H,G){try{var E=document.getElementById(this.newAddrSecId);E=E||this.elem;if(!mstrEditorImpl.validateInputs(E,true)){return false;}this.updateSelections();var B=this.addressName.value;var A=this.addressValue.value;var C=this.device.options[this.device.selectedIndex].value;var D=microstrategy.updateManager;D.add([D.createActionObject(null,mstrUpdateManager.CONTACT_BROWSER_ADD_NEW_PERSONAL_RECIPIENT,this.beanPath,["106002","106003","106004","106005"],[B,A,C,G],[],null)]);D.useIframe=(this.useIframe!=false);D.flushAndSubmitChanges(false,{noRefresh:true});return false;}catch(F){microstrategy.errors.log(F);return false;}};mstrContactsEditorImpl.prototype.onAddToRecipients=function(A){return this.onAddNewPersonalRecipient(A,"1");};mstrContactsEditorImpl.prototype.getSelectedListType=function(A){switch(A){case"recipientsListTo":return"1";case"recipientsListCc":return"2";case"recipientsListBcc":return"4";}return"";};mstrContactsEditorImpl.prototype.updateSelections=function(){try{var H=this.getCartBone();var D="";if(H){var G=H.getSelectedListArray();if(G&&G.length>0){for(var B=0;B<G.length;B++){var C=H.getElementsFromList(G[B]);D+=this.updateSelection(C,this.getSelectedListType(G[B].id))+"!";}}if(D.length>0){D=D.substr(0,D.length-1);}var F=H.getDisplayMode();var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.CONTACT_BROWSER_UPDATE_SELECTIONS,this.beanPath,["106001"],[D],[],null)]);A.replaceURL("displayMode",F);}}catch(E){microstrategy.errors.log(E);return false;}};mstrContactsEditorImpl.prototype.onIncrementalFetch=function(A){try{if(!A){return ;}if(A==mstrUpdateManager.CONTACT_BROWSER_SET_INCREMENTAL_FETCH){this.updateSelections();}}catch(B){microstrategy.errors.log(B);return false;}};mstrContactsEditorImpl.prototype.updateSelection=function(D,C){try{var A="";if(D.length>0){A=C+"|~"+D;}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrContactsEditorImpl.prototype.validateSelections=function(){var C=this.getCartBone();if(C){if(C.atLeastOneSelectionRequired){var B=C.getSelectedListArray();if(B&&B.length>0){var A=C.getElementsFromList(B[0]);if(A==null||A.length==0){showMessage({contents:microstrategy.descriptors.getDescriptor("5865"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});return false;}}}}return true;};mstrContactsEditorImpl.prototype.processApply=function(){if(!this.validateSelections()){return false;}this.updateSelections();this.close();this.saveSelections();return false;};mstrContactsEditorImpl.prototype.saveSelections=function(){try{var A=microstrategy.updateManager;A.useIframe=(this.useIframe!=false);A.add([A.createActionObject(null,mstrUpdateManager.CONTACT_BROWSER_SAVE_SELECTIONS,this.beanPath,[],[],[],null)]);A.flushAndSubmitChanges(false,{noRefresh:true});}catch(B){microstrategy.errors.log(B);return false;}};function mstrContactsEditorImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);delete this.inherits;return this;}mstrSelectionsImpl.prototype={};mstrSelectionsImpl.prototype.length=0;mstrSelectionsImpl.prototype.path="";mstrSelectionsImpl.prototype.dragX=0;mstrSelectionsImpl.prototype.dragY=0;mstrSelectionsImpl.prototype.mousedownX=0;mstrSelectionsImpl.prototype.mousedownY=0;mstrSelectionsImpl.prototype.shiftKey=false;mstrSelectionsImpl.prototype.ctrlKey=false;mstrSelectionsImpl.prototype.clickedSrc=null;mstrSelectionsImpl.prototype.onload=function(A){};mstrSelectionsImpl.prototype.onmousedown=function(B){try{if(!B){B=window.event;}getMouse(B);this.mousedownX=lMouseX;this.mousedownY=lMouseY;}catch(A){microstrategy.errors.log(A);}};mstrSelectionsImpl.prototype.onmouseup=function(C,B){try{if(typeof (mstr)!="undefined"){this.parentBone.detachWinListener((B)?B:this,"mousemove");this.parentBone.detachWinListener((B)?B:this,"mouseup");}else{document.onmousemove=null;document.onmouseup=null;}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.ondeselect=function(B){try{if(B.e){B=B.e;}this.onmouseup(B);if(this.clickedSrc!=null){this.remove(this.clickedSrc);}return false;}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.ondragstart=function(C){try{if(!C){C=window.event;}if(C.e){C=C.e;}getMouse(C);if(Math.abs(lMouseX-this.mousedownX)>=3||Math.abs(lMouseY-this.mousedownY)>=3){microstrategy.eventManager.onnotifydrag(this.items,this.parentBone,this.getDssTypes());var A=microstrategy.getEventHandlerString(this.path);if(typeof (mstr)!="undefined"){this.parentBone.attachWinListener(this,"mousemove","ondrag");this.parentBone.attachWinListener(this,"mouseup","ondragend");}else{document.onmousemove=new Function("e",A+" { return "+this.path+".ondrag(e); }");document.onmouseup=new Function("e",A+" { return "+this.path+".ondragend(e); }");}this.ondrag(C);}}catch(B){microstrategy.errors.log(B);}return false;};mstrSelectionsImpl.prototype.ondrag=function(A){};mstrSelectionsImpl.prototype.ondragend=function(A){};mstrSelectionsImpl.prototype.add=function(B){try{this.items[B.getAttribute("id")]=B;this.length++;if(this.parentBone&&this.parentBone.onselectionchange){this.parentBone.onselectionchange();}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.remove=function(B){try{delete this.items[B.getAttribute("id")];this.length--;if(this.parentBone.onselectionchange){this.parentBone.onselectionchange();}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.clear=function(C,B){try{if(C==null){C=true;}this.items={};this.length=0;if(C&&this.parentBone&&this.parentBone.onselectionchange){this.parentBone.onselectionchange(B);}}catch(A){microstrategy.errors.log(A);}return false;};mstrSelectionsImpl.prototype.firstItem=function(){try{for(member in this.items){return this.items[member];break;}}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.isMulti=function(){try{return(this.length>1);}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.isSelected=function(B){try{return(typeof (this.items[B.getAttribute("id")])!="undefined");}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.isActive=function(){try{return(this.length>0);}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.getTypes=function(){try{var A=[];var B=0;for(var D in this.items){if(this.items[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)){A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_OBJTYPE)+"."+this.items[D].getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}else{A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_OBJTYPE);}}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.isSameType=function(){try{var A=this.getDssTypes();A.sort(function(D,C){return parseInt(D)-parseInt(C);});return(A[0]==A[A.length-1]);}catch(B){microstrategy.errors.log(B);return null;}};mstrSelectionsImpl.prototype.isOnlyMetrics=function(){try{for(var B in this.items){if(this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_METRIC&&this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_USER_METRIC&&this.items[B].getAttribute(microstrategy.HTMLATTR_DSS_TYPE)!=microstrategy.DSSTYPE_USER_SUMMARY_METRIC){return false;}}return true;}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getDssTypes=function(){try{var A=[];var B=0;for(var D in this.items){A[B++]=this.items[D].getAttribute(microstrategy.HTMLATTR_DSS_TYPE);}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.getSelectedIds=function(){try{var C="|";for(var B in this.items){C+=B+"|";}return C;}catch(A){microstrategy.errors.log(A);return false;}};mstrSelectionsImpl.prototype.getDataSetIDs=function(){try{var B=[];var C=0;for(var E in this.items){var A=new mstrObjectInfoImpl(this.items[E]);B[C++]=A.dSetId;}return B;}catch(D){microstrategy.errors.log(D);return null;}};mstrSelectionsImpl.prototype.getSelectionsKey=function(){try{var A=[];var B=0;for(var D in this.items){A[B++]=this.items[D].id;}return A;}catch(C){microstrategy.errors.log(C);return null;}};mstrSelectionsImpl.prototype.getFirstObjSubType=function(){try{var A=null;var C=this.firstItem();if(C){A=C.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrSelectionsImpl.prototype.getFirstObjType=function(){try{var A=null;var C=this.firstItem();if(C){A=C.getAttribute(microstrategy.HTMLATTR_OBJTYPE);}return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrSelectionsImpl.prototype.getChildren=function(B){try{return B.parentNode.parentNode.lastChild.getElementsByTagName("span");}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getItems=function(){try{return mstr.utils.Arrays.fromHashValues(this.items);}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getInnerRect=function(D){try{var C=microstrategy.styleObj;var B={};B.left=getObjSumLeft(D);B.top=getObjSumTop(D);if(bIsIE6){B.right=B.left+getObjWidth(D);B.bottom=B.top+getObjHeight(D);}else{B.left+=D.clientLeft;B.top+=D.clientTop;B.right=B.left+C.getInnerWidth(D);B.bottom=B.top+C.getInnerHeight(D);}if(B.right<(B.left+1)){B.right=B.left+1;}if(B.bottom<(B.top+1)){B.bottom=B.top+1;}return B;}catch(A){microstrategy.errors.log(A);return null;}};mstrSelectionsImpl.prototype.getOuterRect=function(D,A){try{var C={};if(D.getAttribute(microstrategy.HTMLATTR_OBJTYPE)==null){C.left=getObjSumLeft(D);C.top=getObjSumTop(D);}else{C.left=getObjSumLeftScrolled(D);C.top=getObjSumTopScrolled(D,A);}C.right=Math.max(C.left+getObjWidth(D),C.left+1);C.bottom=Math.max(C.top+getObjHeight(D),C.top+1);return C;}catch(B){microstrategy.errors.log(B);return null;}};function mstrSelectionsImpl(A){this.items={};this.parentBone=A;return this;}mstrTabImplScript=true;mstrTabImpl.prototype=new mstrEditorImpl();mstrTabImpl.prototype.settings=new Array();mstrTabImpl.prototype.settingsNameArray=new Array();mstrTabImpl.prototype.enforceSubmit=false;mstrTabImpl.prototype.currentPropertyName=null;mstrTabImpl.prototype.tabManager=null;mstrTabImpl.prototype.PIXEL_WIDTH=2;mstrTabImpl.prototype.cmdLevel=null;mstrTabImpl.prototype.appliesTo=null;mstrTabImpl.prototype.tabSwitch=null;mstrTabImpl.CMD_TYPE_DEFAULT=0;mstrTabImpl.CMD_TYPE_BITFLAG=1;mstrTabImpl.prototype.onload=function(){try{this.initEditor();if(this.elem&&this.elem.parentNode){var A=this.elem.parentNode.getAttribute("at");if(A&&A.length>0){this.appliesTo=A;}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.onunload=function(C){try{mstrEditorImpl.prototype.onunload.call(this,C);var B=this.getAppliesTo();if(B&&B.observer){B.observer.unregister(this.id);}}catch(A){microstrategy.errors.log(A);}return true;};mstrTabImpl.prototype.exec=function(A,H){try{switch(A){case"advColorPicker":var G=H.split("|");var F=document.getElementById(G[0]);if(F){this.updateColorPicker(F,G[1]);}break;case"edtColorGradient":var G=H.split("|");var F=document.getElementById(G[0]);var E=G[1].split(",");if(E.length>=2&&(E[0]==E[1])){if(F){this.updateColorPicker(F,E[0]);}break;}else{if(F){F.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);var C=F.getElementsByTagName("span");if(C.length>0){C[0].setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);}else{F.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);}var B=document.getElementById(this.id+F.getAttribute(microstrategy.HTMLATTR_CMD_ID));if(B){B.value=G[1];if(!this.initializing){B.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,G[1]);}}}this.updateColorPickerGradient(H);break;}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.showOptions=function(E){try{if(!E){return false;}var D=E.parentNode.getElementsByTagName(E.tagName);for(var B=0;B<D.length;B++){var A=D[B].id;if(A){A=document.getElementById("div"+A);}if(A){A.style.display=(D[B]==E)?"block":"none";}}return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);}};mstrTabImpl.prototype.togglePicker=function(A,D,B){try{if(B&&(!B.disabled)){dropDown.togglePicker(A,D,B,this);}}catch(C){microstrategy.errors.log(C);}return false;};mstrTabImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.checkForFormatChanges=function(){try{return false;}catch(A){microstrategy.errors.log(A);}};mstrTabImpl.prototype.applyFormatChanges=function(A,B){try{return B;}catch(C){microstrategy.errors.log(C);return B;}};mstrTabImpl.prototype.checkRGBColors=function(B,A){try{if((A!=null)&&(B.toLowerCase().indexOf("color")>-1)){A=mstr.utils.Color.rgbStr2hex(A);}return A;}catch(C){microstrategy.errors.log(C);return A;}};mstrTabImpl.prototype.applyPropertyChanges=function(G){try{for(counter=0;counter<this.settings.length;counter++){var C=this.settings[counter];var F=C.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(F!=null){var D=C.getAttribute(microstrategy.HTMLATTR_CMD_ID);var B=C.getAttribute(microstrategy.HTMLATTR_CMD_LEVEL);if(!B){B=this.cmdLevel;}var A=new this.propChangeObject(C,D,F,null,null,B);G.push(A);if(!this.enforceSubmit){C.removeAttribute(microstrategy.HTMLATTR_CMD_VALUE);}}}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrTabImpl.prototype.propChangeObject=function(E,B,G,D,A,C,F){this.obj=E;this.cmdId=B;this.value=G;this.performFormatChange=D;this.submitUpdateManager=A;this.level=(C!=null)?C:this.cmdLevel;this.formatType=(F!=null)?F:microstrategy.FORMAT_TYPE_MAIN;return this;};mstrTabImpl.prototype.simpleInitCheckValue=function(D,C,A){try{if(D&&D.tagName.toLowerCase()!="input"){if(C==0){D.src=microstrategy.FOLDER_IMAGES+"check_off.gif";D.setAttribute("cv","0");}else{D.src=microstrategy.FOLDER_IMAGES+"check_on.gif";D.setAttribute("cv","-1");}}else{if((C||typeof (C)=="boolean")&&D){if(C&D.value||C==D.value){D.checked=true;}else{D.checked=false;}}}if(D){if(A==null||A=="true"){D.onclick();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initCheckValue=function(B,A,H,C,F){try{var G=document.getElementById(H);if(!G||!B||!B.commands){return ;}if(F==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),F))){if(B.commands.queryEnabled()&&B.commands.queryEnabled(A)){var E=B.commands.queryState(A);this.simpleInitCheckValue(G,E,C);return ;}}this.disableObj(H);}catch(D){microstrategy.errors.log(D);}};mstrTabImpl.prototype.simpleInitTextValue=function(D,C,A){try{if((C||(C!=null&&C.length==0))&&D){D.value=C;if(A==null||A=="true"){D.onchange();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initTextValue=function(B,A,H,C,F){try{if(document.getElementById(H)){if(F==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),F))){if(B.commands&&B.commands.queryEnabled()){if(B.commands.queryEnabled(A)){var E=B.commands.queryState(A);var G=document.getElementById(H);this.simpleInitTextValue(G,E,C);}}}else{this.disableObj(H);}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.simpleInitRadioValue=function(D,C,A){try{if(D){D.checked=true;if(A==null||A=="true"){D.onclick();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initRadioValue=function(A,J,I,F,E){try{var B=document.getElementsByName(I);if(B){if(E==null||(A.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(A.commands.queryState("selectedItems"),E))){if(A.commands&&A.commands.queryEnabled()){if(A.commands.queryEnabled(J)){var H=A.commands.queryState(J);var G=document.getElementById(I+H);this.simpleInitRadioValue(G,H,F);}}}else{for(var D=0;D<B.length;D++){this.disableOptionAndLabel(B[D]);}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.simpleInitLabelValue=function(C,B){try{if(B&&C){C.innerHTML=B;}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.disableOptionAndLabel=function(A){try{if(A){A.disabled=true;A.className="disabled";if(document.getElementById(A.id+"_label")){document.getElementById(A.id+"_label").className="disabledLabel";}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.enableOptionAndLabel=function(A){try{if(A){A.disabled=false;A.className="";if(document.getElementById(A.id+"_label")){document.getElementById(A.id+"_label").className="";}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initLabelValue=function(B,A,F){try{if(B.commands&&B.commands.queryEnabled()){if(B.commands.queryEnabled(A)){var D=B.commands.queryState(A);var E=document.getElementById(F);this.simpleInitLabelValue(E,D);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.simpleInitComboValue=function(H,J,G){try{if(J!=null&&(J.toString()).length>0&&H!=null){var F=parseInt(H.getAttribute(microstrategy.HTMLATTR_CMD_TYPE));switch(F){case mstrTabImpl.CMD_TYPE_BITFLAG:var B=H.options;var E=-1;var I=parseInt(J);var A=0;for(var D=0;D<B.length;D++){var L=B.item(D);var K=parseInt(L.value);if((((I&K)||(K==A))&&(K>E))||(K==0==I)){E=K;I=I-K;A+=K;}if((I==0)&&(K==A)&&(E>-1)){break;}}if(E>-1){H.value=E;}break;default:H.value=J;}if(G==null||G=="true"){H.onchange();}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.initComboValue=function(B,A,H,C,F){try{if(F==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),F))){if(B.commands&&B.commands.queryEnabled()){if(B.commands.queryEnabled(A)){var E=B.commands.queryState(A);var G=document.getElementById(H);this.simpleInitComboValue(G,E,C);}}}else{this.disableObj(H);}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.initColorPickerValue=function(B,A,G,E){try{if(E==null||(B.commands.queryEnabled("isSelectionsPresent")&&this.isEnabled(B.commands.queryState("selectedItems"),E))){if(B.commands&&B.commands.queryEnabled()){var D;var F=document.getElementById(G);if(A=="bgcolor"){D=F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!D&&B.commands.queryEnabled("gradientcolor")){D=B.commands.queryState("gradientcolor");}}if(B.commands.queryEnabled(A)){if((A=="bgcolor"&&!D)||A!="bgcolor"){D=B.commands.queryState(A,this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}this.updateColorPicker(F,D);}}}else{if(document.getElementById(G)){document.getElementById(G).disabled=true;document.getElementById(G).className="mstrPulldowndisabled";}if(document.getElementById(G+"_label")){document.getElementById(G+"_label").className="disabledLabel";}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.setAppliesTo=function(B){if(B==null){return true;}try{if(!this.appliesTo){this.appliesTo=(typeof (B)=="string")?B:B.id;}B=microstrategy.bone(this.appliesTo);if(B.observer){B.observer.register(this.id);}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.isEnabled=function(A,D){try{var B=microstrategy.isEnabled(A,D);return B;}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.updateList=function(A){};mstrTabImpl.prototype.updateText=function(C,A){try{if(C&&(typeof (A)=="undefined"||!A)){C.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,C.value);}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.updateCheck=function(C){try{if(C){var B=(C.checked)?"-1":"0";C.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,B);}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.updateDropdown=function(E,C,D,A){try{if(E){E.innerHTML=C;if(typeof (A)=="undefined"||!A){E.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.updateColorPicker=function(E,D,A){try{if(D==null){D="transparent";}if(E&&(D!="-2")){var B=E.getElementsByTagName("span");if(D&&D.indexOf(",")>=0&&D.indexOf("rgb")<0){this.updateColorPickerGradient(E.id+"|"+D);}else{if(B.length>0){B[0].style.backgroundColor=D;if(!D||D=="transparent"){B[0].innerHTML=microstrategy.descriptors.getDescriptor(3779);}else{B[0].innerHTML="";}}else{E.style.backgroundColor=D;}}if(typeof (A)=="undefined"||!A){E.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.getColorPickerValue=function(E){try{var D="";if(E){var A=E.getElementsByTagName("span");var B=null;if(A.length>0){B=A[0];}else{B=E;}D=B.style.backgroundColor;}return D;}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.disableObj=function(A){try{if(document.getElementById(A)){this.disableOptionAndLabel(document.getElementById(A));}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.enableObj=function(A){try{if(document.getElementById(A)){this.enableOptionAndLabel(document.getElementById(A));}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.allSelectedItemsAreOfType=function(C){try{var G=true;var A=this.getAppliesTo();var B=A.commands.queryState("selectedItems");for(var E in B){var F=B[E].getAttribute("sty");if(F!=C){G=false;break;}}return G;}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.cleanup=function(A){};mstrTabImpl.prototype.getJSONProperty=function(A,E,D){try{var B="";if(A!=null&&E!=null){E=(D)?E:'"'+E+'"';E=E.replace(/%5C/g,"%5C%5C");E=E.replace(/%22/g,"%5C%22");B+='"'+A+'":'+E+",";}return B;}catch(C){microstrategy.errors.log(C);return"";}};mstrTabImpl.prototype.getChanges=function(){try{var C="";var B;for(B=0;B<this.settings.length;B++){var A=this.settings[B];var D=A.getAttribute(microstrategy.HTMLATTR_CMD_ID);var F=this.getChangedValue(A);C+=this.getJSONProperty(D,F);}if(C.length>0){C=C.substring(0,C.length-1);}return C;}catch(E){microstrategy.errors.log(E);return false;}};mstrTabImpl.prototype.getChangedValue=function(A){try{var C=A.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(C==null){if(A.nodeName.toLowerCase()=="input"&&A.type.toLowerCase()=="checkbox"){C=A.checked;}}return C;}catch(B){microstrategy.errors.log(B);return null;}};mstrTabImpl.prototype.saveTabSelections=function(){var C="{"+this.getChanges(true)+"}";var B=this.tabManager.selectedTabOptions||"";var A=B.length;if(A){B=B.substring(1,A-1)+",";}this.tabManager.selectedTabOptions="{"+B+'"'+this.id+'":'+C+"}";microstrategy.updateManager.replaceURL("selectedTabOptions",this.tabManager.selectedTabOptions);};mstrTabImpl.prototype.restorePreviousSelections=function(A){try{for(var B in A){var D=document.getElementById(this.id+B);if(D!=null&&A[B]!=null&&D.id==this.id+B){this.restoreEachSelection(D,B,A[B]);}else{if(D==null||D.getAttribute("name")==this.id+B){this.updateSpecialCases(B,A[B]);}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.restoreEachSelection=function(E,A,D){try{if(A.indexOf("Color")>-1){this.updateColorPicker(E,D);}else{var F=E.nodeName;switch(F.toLowerCase()){case"select":this.updateComboBox(E,D);this.updateList(E);break;case"input":var B=E.type.toLowerCase();switch(B){case"checkbox":this.reselectCheckBox(E,D);this.updateCheck(E);break;case"radio":this.updateRadioButton(E,D);break;case"text":this.updateText(E);break;}break;default:E.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.updateRadioButton=function(B,A){};mstrTabImpl.prototype.updateSpecialCases=function(A,B){};mstrTabImpl.prototype.reselectCheckBox=function(field,value){try{field.checked=eval(value);}catch(err){microstrategy.errors.log(err);return false;}};mstrTabImpl.prototype.updateComboBox=function(F,E){try{var B=F.childNodes;var A=-1;var G=0;for(var C=0;C<B.length;C++){if(B[C]!=null&&B[C].nodeName.toLowerCase()=="option"){if(this.matchesListValue(B[C].value,E,F.getAttribute(microstrategy.HTMLATTR_CMD_ID))){A=G;break;}G++;}}F.selectedIndex=A;F.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,E);}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.matchesListValue=function(B,D,A){try{return(B==D);}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.openAdvancedColorPicker=function(B,A,C){try{if(B&&B.commands){var E=mstr.utils.Color.rgbStr2hex(C);B.commands.exec("edtColorPicker",this.id+"|"+this.id+A+"|"+E+"|"+this.tabManager.getChangedTabOptions());}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.openColorGradientEditor=function(A,B){try{if(A&&A.commands){A.commands.exec("edtColorGradient",B+"|"+this.tabManager.getChangedTabOptions());}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.openColorGradientEditor=function(A,C,B){try{if(A&&A.commands){if(B==true){A.commands.exec("graphEdtColorGradient",C+"|"+this.tabManager.getChangedTabOptions());}else{this.tabManager.adjustFormatType();A.commands.exec("edtColorGradient",C+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}}catch(D){microstrategy.errors.log(D);return false;}};mstrTabImpl.prototype.openGradientColorPicker=function(B,J,I,H,C,D,G,E){try{if(B&&B.commands){this.tabManager.adjustFormatType();if(!C){B.commands.exec("edtColorGradient",this.id+"|"+this.id+J+"|"+0+"|"+I+"|"+H+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}else{var A=((D==0&&G==0)||(D==90&&E==0))?0:1;B.commands.exec("edtColorGradient",this.id+"|"+this.id+J+"|"+A+"|"+I+"|"+H+"|"+C+"|"+D+"|"+G+"|"+E+"|"+this.tabManager.getChangedTabOptions(),this.tabManager.isPanelStackSelected()&&this.tabManager.targetAxis==1);}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;}}catch(F){microstrategy.errors.log(F);return false;}};mstrTabImpl.prototype.updateColorPickerGradient=function(J){try{var N=J.split("|");var F=document.getElementById(N[0]);F.style.backgroundColor="transparent";var K=F.getElementsByTagName("span");if(K.length>0){F=K[0];}else{return false;}F.innerHTML="";var O=N[1].split(",");var H=getObjInnerWidth(F);var G=getObjInnerHeight(F);if(H%2==1){H=H-1;}if(G%2==1){G=G-1;}var S=gradientUtil.getRGBColor(O[0]);var A=gradientUtil.getRGBColor(O[1]);var Q=(O[3]==0)?gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL:gradientUtil.GRADIENTSHADING_STYLE_VERTICAL;var U=O[4];var D=O[5];var T=(Q==gradientUtil.GRADIENTSHADING_STYLE_HORIZONTAL&&U!=100)||(Q==gradientUtil.GRADIENTSHADING_STYLE_VERTICAL&&D!=100)?1:2;var R=(H/gradientUtil.PIXEL_WIDTH)*(G/gradientUtil.PIXEL_WIDTH);for(var L=0;L<R;L++){var B=document.createElement("div");B.className="pixel";var P=gradientUtil.getColorPercent(gradientUtil.getXCoordinate(L,H),gradientUtil.getYCoordinate(L,G),T,H,Q);var E=parseInt(P*(A[0]-S[0]))+S[0];var I=parseInt(P*(A[1]-S[1]))+S[1];var M=parseInt(P*(A[2]-S[2]))+S[2];B.style.backgroundColor="rgb("+E+", "+I+", "+M+")";F.appendChild(B);}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.initSettings=function(){try{if(this.settingsNameArray.length==0){return ;}this.settings=new Array();for(var A=0;A<this.settingsNameArray.length;A++){var C=document.getElementById(this.id+this.settingsNameArray[A]);if(C){this.settings.push(C);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrTabImpl.prototype.initCtrlValue=function(G,D){try{var B=this.getAppliesTo();if(!B){return ;}var A=G.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(B.commands&&B.commands.queryEnabled(A)){var F=B.commands.queryState(A);var C=G.type||G.getAttribute("type");switch(C){case"text":this.simpleInitTextValue(G,F,D);break;case"checkbox":this.simpleInitCheckValue(G,(F==true),D);break;case"colorpicker":this.updateColorPicker(G,F);break;case"picker":break;}}else{this.disableObj(fieldName);}}catch(E){microstrategy.errors.log(E);return false;}};mstrTabImpl.prototype.updateCtrl=function(B){try{if(!B){return ;}if(this.initializing){return ;}switch(B.type){case"text":B.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,B.value);break;case"checkbox":B.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,(B.checked)?microstrategy.TRUE:microstrategy.FALSE);break;}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.getSwitchMode=function(){try{if(!this.tabSwitch){if(this.tabManager){this.tabSwitch=microstrategy.findChildWithAtt(this.tabManager,"td","tab",this.id);}}if(this.tabSwitch){return this.tabSwitch.getAttribute(microstrategy.TAB_SWITCH_MODE);}return 0;}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.setSwitchMode=function(B){try{if(!this.tabSwitch){if(this.tabManager){this.tabSwitch=microstrategy.findChildWithAtt(this.tabManager,"td","tab",this.id);}}if(this.tabSwitch){this.tabSwitch.setAttribute(microstrategy.TAB_SWITCH_MODE,B);}}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.afterresize=function(){try{if(mstrEditorImpl.prototype.afterresize){mstrEditorImpl.prototype.afterresize.call(this);}var D=microstrategy.findChildrenWithAtt(this.elem,"div","ty");for(var B=0;B<D.length;B++){var A=microstrategy.findBone(D[B]);if(A&&A.afterresize){A.afterresize();}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.onwinresize=function(){try{if(mstrEditorImpl.prototype.onwinresize){mstrEditorImpl.prototype.onwinresize.call(this);}this.resize();}catch(A){microstrategy.errors.log(A);return false;}};mstrTabImpl.prototype.resize=function(){try{if(mstrEditorImpl.prototype.resize){mstrEditorImpl.prototype.resize.call(this);}var D=microstrategy.findChildrenWithAtt(this.elem,"div","ty");if(D){for(var B=0;B<D.length;B++){var A=microstrategy.findBone(D[B]);if(A&&A.resize){A.resize();}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrTabImpl.prototype.toggleCheck=function(C,A){if(this.initializing!=false){return false;}var D=parseInt(C.getAttribute("cv"),10)-1;if(D<-2){D=0;}var B="check_off.gif";if(D==-1){B="check_on.gif";}else{if(D==-2){if(A){B="Check_conflict.gif";}else{D=0;}}}C.src=microstrategy.FOLDER_IMAGES+B;C.setAttribute("cv",D);C.setAttribute(microstrategy.HTMLATTR_CMD_VALUE,D);return true;};mstrTabImpl.prototype.unregister=function(){try{var C=microstrategy.findChildrenWithAtt(this.elem,"div","ty");if(C){for(var A=0;A<C.length;A++){microstrategy.unRegisterBone(C[A].getAttribute("id"));}}}catch(B){microstrategy.errors.log(B);return false;}};function mstrTabImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);delete this.inherits;return this;}mstrFormatImplScript=true;mstrFormatImpl.prototype=new mstrEditorImpl();mstrFormatImpl.prototype.childrenTabs=new Array();mstrFormatImpl.prototype.changesApplied=0;mstrFormatImpl.prototype.currentTab=1;mstrFormatImpl.prototype.actionId=microstrategy.OPEN_EDITOR_ACTION_EDIT;mstrFormatImpl.prototype.selectedTabOptions="";mstrFormatImpl.prototype.autoSubmitJS=null;mstrFormatImpl.prototype.sharedObj=null;mstrFormatImpl.prototype.useDynamicTitle=false;mstrFormatImpl.prototype.titleContainer=null;mstrFormatImpl.prototype.targetAxis=null;mstrFormatImpl.prototype.targetLevel=null;mstrFormatImpl.prototype.targetUnit=null;mstrFormatImpl.prototype.targetPosition=null;mstrFormatImpl.prototype.submitUponTargetLevelChange=true;mstrFormatImpl.prototype.axisOptionId=null;mstrFormatImpl.prototype.levelOptionId=null;mstrFormatImpl.prototype.targetOptions=null;mstrFormatImpl.prototype.levelOptions=null;mstrFormatImpl.prototype.commands=null;mstrFormatImpl.prototype.helpButton=null;mstrFormatImpl.prototype.defaultHelpURL=null;mstrFormatImpl.panelStackOptionsMapDescriptors=[["4579","3297"],["512"]];mstrFormatImpl.gridContainerOptionsMapDescriptors=[["4579","3297"],["512"]];mstrFormatImpl.panelStackOptionsMap=[[{name:"",value:0},{name:"",value:1}],[{name:"",value:2}]];mstrFormatImpl.gridContainerOptionsMap=[[{name:"",value:8},{name:"",value:9}],[{name:"",value:8}]];mstrFormatImpl.prototype.onload=function(){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.onload",mstrLogImpl.LOAD_TABS);}mstrFormatImpl.initOptionsMap();this.initFormatManager();this.tabContainer=microstrategy.subObjectFind(this.body,["DIV"],microstrategy.SUBOBJTYPE_TAB_CONTAINER);this.commands=new mstrFormatImplCommandsImpl(this);}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.onload",mstrLogImpl.LOAD_TABS);}}};mstrFormatImpl.initOptionsMap=function(){try{if(mstrFormatImpl.panelStackOptionsMap[0][0].name!=""){return ;}else{for(var B=0;B<mstrFormatImpl.panelStackOptionsMap.length;B++){for(var A=0;A<mstrFormatImpl.panelStackOptionsMap[B].length;A++){mstrFormatImpl.panelStackOptionsMap[B][A].name=microstrategy.descriptors.getDescriptor(mstrFormatImpl.panelStackOptionsMapDescriptors[B][A]);}}for(var B=0;B<mstrFormatImpl.gridContainerOptionsMap.length;B++){for(var A=0;A<mstrFormatImpl.gridContainerOptionsMap[B].length;A++){mstrFormatImpl.gridContainerOptionsMap[B][A].name=microstrategy.descriptors.getDescriptor(mstrFormatImpl.gridContainerOptionsMapDescriptors[B][A]);}}}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.onreload=function(){try{mstrEditorImpl.prototype.onreload.call(this);var F=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab");if(!F){return false;}for(var C=0;C<F.length;C++){if(F[C].getAttribute("curTab")==this.currentTab){var E;var B=F[C].getAttribute("tab");if(B){E=getElementById(B);}if(E){this.updateDynamicInfo(F[C]);this.showTabSection(E);if(!microstrategy.bone(B)){var A=E.getAttribute("scriptClass");if(A){loadInit(A+"Script",'microstrategy.registerBone("'+B+'", "(true)", null);');this.setTimeout('microstrategy.bone("'+B+'")','microstrategy.bone("'+this.id+'").loadChildrenTab("'+B+'")',500);}}}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.onpostload=function(){try{mstrEditorImpl.prototype.onpostload.call(this);this.initChildrenTabs();this.initSelections();this.restorePreviousSelections();}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.onload",mstrLogImpl.LOAD_TABS);}}};mstrFormatImpl.prototype.onunload=function(C){try{mstrEditorImpl.prototype.onunload.call(this,C);this.unRegisterChildren();var B=this.getAppliesTo();if(B!=null&&B.observer){B.observer.unregister(this.id);}}catch(A){microstrategy.errors.log(A);}return true;};mstrFormatImpl.prototype.restorePreviousSelections=function(){try{if(this.selectedTabOptions!=null&&this.selectedTabOptions.length>0){eval("this.selectedTabOptions = "+this.selectedTabOptions);for(var id in this.selectedTabOptions){var tab=microstrategy.bone(id);if(tab!=null){var settings=this.selectedTabOptions[id];tab.restorePreviousSelections(settings);}}this.selectedTabOptions=null;}}catch(err){microstrategy.errors.log(err);return false;}};mstrFormatImpl.prototype.initFormatManager=function(){try{this.initEditor();this.changesApplied=0;if(this.elem){var A=this.elem.getAttribute("at");if(A&&A.length>0){this.setAppliesTo(A);}}if(this.axisOptionId&&this.levelOptionId){this.targetOptions=microstrategy.findChildWithAtt(this.elem,"SELECT","id",this.axisOptionId);this.levelOptions=microstrategy.findChildWithAtt(this.elem,"SELECT","id",this.levelOptionId);}this.adjustTargetLevelOptions();this.initHelpButton();}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.initHelpButton=function(){try{var B=microstrategy.findChildWithAtt(this.elem,"img",(bIsW3C)?"class":"className","mstrIcon-btn mstrIcon-btnHelp");if(B){this.help=B.parentNode;}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.isPanelStackSelected=function(){try{var A=this.getAppliesTo();return(A&&A.commands.queryEnabled("onepanelstack")==true);}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.areAllSelectedPanelStacks=function(){try{var A=this.getAppliesTo();return(A&&A.commands.queryEnabled("allpanelstack")==true&&A.commands.queryEnabled("onepanelstack")==false);}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.isGridSelected=function(){try{var A=this.getAppliesTo();return(A&&A.commands.queryEnabled("onegrid")==true);}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.isGridContainerSelected=function(){try{var A=this.getAppliesTo();return(this.isGridSelected()&&this.targetAxis==0&&(this.targetLevel==8||this.targetLevel==9));}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.adjustTargetLevelOptions=function(){try{var D;var J;var H;if(this.levelOptions){D=this.levelOptions.options;J=D.length;if(this.isGridContainerSelected()){if(D){H=D[this.levelOptions.selectedIndex].value;for(var G=0;G<J;G++){this.levelOptions.removeChild(D[0]);}}var C=microstrategy.findBone(this.getAppliesTo().commands.queryState("selectedGrid"));if(!C.showTitleBar()){this.targetLevel=8;B=1;this.levelOptions.disabled=true;}else{B=0;this.levelOptions.disabled=false;}for(var F=0;F<mstrFormatImpl.gridContainerOptionsMap[B].length;F++){var I=document.createElement("OPTION");this.levelOptions.options.add(I);I.text=mstrFormatImpl.gridContainerOptionsMap[B][F].name;I.value=mstrFormatImpl.gridContainerOptionsMap[B][F].value;I.selected=(F==0||I.value==H);}}if(this.isPanelStackSelected()){if(D){H=D[this.levelOptions.selectedIndex].value;for(var G=0;G<J;G++){this.levelOptions.removeChild(D[0]);}}var B=0;if(this.targetAxis==0){var A=microstrategy.findBone(this.getAppliesTo().commands.queryState("selectedPanelStack"));if(!A.isTitleVisible){this.targetLevel=0;B=1;this.levelOptions.disabled=true;}else{B=0;this.levelOptions.disabled=false;}}else{if(this.targetAxis==1){this.targetLevel=2;B=1;this.levelOptions.disabled=true;}}for(var F=0;F<mstrFormatImpl.panelStackOptionsMap[B].length;F++){var I=document.createElement("OPTION");this.levelOptions.options.add(I);I.text=mstrFormatImpl.panelStackOptionsMap[B][F].name;I.value=mstrFormatImpl.panelStackOptionsMap[B][F].value;I.selected=(F==0||I.value==H);}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrFormatImpl.prototype.enableChildrenTabs=function(){try{var G=microstrategy.objectListFind(this.body,["span"],microstrategy.OBJTYPE_TAB);var B=this.getAppliesTo();var I=false;var A=null;if(G&&G.length){for(var E=0;E<G.length;E++){var H=false;var C=G[E].getAttribute(microstrategy.HTMLATTR_CMD_ID);if(C&&C.length>0){if(!B.commands.queryEnabled(C)||!this.commands.queryEnabled(C)){H=true;}}if(A==null&&!H){A=E;}if((this.currentTab-1)==E&&H){I=true;}if(H){G[E].className="mstrTabSetTabdisabled";microstrategy.unRegisterBone(G[E].id);var F=G[E].getAttribute("tab");if(F){F=getElementById(F);}if(F){F.style.display="none";F.style.visibility="hidden";}}else{if(!this.submitUponTargetLevelChange){if(G[E].className&&G[E].className.indexOf("disabled")>=0){G[E].className=G[E].className.replace("disabled"," ");}}}}}if(I){this.setCurrentTab(G[A]);}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.initChildrenTabs=function(){try{this.childrenTabs=new Array();this.enableChildrenTabs();if(this.tabContainer){var C=microstrategy.subObjectListFind(this.tabContainer,["DIV"],microstrategy.SUBOBJTYPE_TAB_SECTION);if(C&&C.length){for(var B=0;B<C.length;B++){var A=microstrategy.bone(C[B].id);var E=microstrategy.findChildWithAtt(this.body,"SPAN","id",C[B].id+"_tab");if((E&&(E.className.indexOf("disabled")==-1))||C.length==1){if(!A){if(C[B].getAttribute("scriptClass")){loadInit(C[B].getAttribute("scriptClass")+"Script",'microstrategy.registerBone("'+C[B].id+'", "(true)", null);');this.setTimeout('microstrategy.bone("'+C[B].id+'")','microstrategy.bone("'+this.id+'").loadChildrenTab("'+C[B].id+'")',500);}}else{A.dialogDiv=this.elem;A.tabManager=this;this.childrenTabs[this.childrenTabs.length]=A;if(A.initValues){A.initValues();}}}this.setScheduleTab(A);this.setDeliveryTab(A);}}}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.loadChildrenTab=function(A){try{var C=microstrategy.bone(A);if(C){C.tabManager=this;C.setAppliesTo(this.getAppliesTo());if(A in this){for(var B in this[A]){C[B]=this[A][B];}}if(C.onload){C.onload();}C.dialogDiv=this.elem;if(C.initSharedObj){C.initSharedObj(this.sharedObj);}this.childrenTabs[this.childrenTabs.length]=C;if(C.onpostload){C.onpostload();}this.setScheduleTab(C);this.setDeliveryTab(C);this.resizePopUp(this.elem);}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.setScheduleTab=function(A){try{if(A&&A.scheduleType!=undefined){A.initScheduleInfo();this.scheduleTab=A;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.setDeliveryTab=function(A){try{if(A&&A.userType!=undefined){this.deliveryTab=A;}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.unRegisterChildren=function(){try{if(this.tabContainer){if(this.childrenTabs&&this.childrenTabs.length){var C=this.getAppliesTo();for(var A=0;A<this.childrenTabs.length;A++){if(C&&C.observer){C.observer.unregister(this.childrenTabs[A].id);}microstrategy.unRegisterBone(this.childrenTabs[A].id);}}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.initSelections=function(){try{if(this.titleBar){var A=this.getAppliesTo();if(A==null){return ;}var F=this.titleBar.getElementsByTagName("span");var E=this.titleBar;if(F.length>0){E=F[0];}var D=E.innerHTML;var B=D.indexOf(":");if(B<0){B=D.indexOf("\uFF1A");}if(B==D.length-1){D=D.substr(0,B+1);if(A.commands&&A.commands.queryEnabled("isUserMetricSelected")){D=D+" "+microstrategy.descriptors.getDescriptor("3865");}else{if(A.commands&&A.commands.queryEnabled("isSummaryMetricSelected")){D=D+" "+microstrategy.descriptors.getDescriptor("3866");}else{if(A.commands&&!A.commands.queryEnabled()&&!A.commands.queryEnabled("onegrid")){D=D+" "+microstrategy.descriptors.getDescriptor("3520");}else{if(A.commands){D=D+" "+A.commands.queryState("selected");}}}}}E.innerHTML=D;}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.setAppliesTo=function(B){try{if(!this.appliesTo){this.appliesTo=(typeof (B)=="string")?B:B.id;}B=microstrategy.bone(this.appliesTo);if(B&&B.observer){B.observer.register(this.id);}return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.cancelChanges=function(){try{var A=this.getAppliesTo();var C=A.updateManager||A.um;if(A&&C){while(this.changesApplied>0){C.undo();this.changesApplied--;}}this.changesApplied=0;for(var B=0;B<this.childrenTabs.length;B++){this.childrenTabs[B].cleanup();}this.actionId=null;this.closeEditor();return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.applyGraphFormatChanges=function(C){try{var A=this.getAppliesTo();if(!this.validateInputs()){return false;}if(C==null){C=new Array();}var B;if(C.length==0){for(B=0;B<this.childrenTabs.length;B++){var E=this.childrenTabs[B];C=E.applyFormatChanges(A,C);}}if(C.length>0){A.commands.exec("formatGraphBulk",C);}return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.applyFormatChanges=function(E){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}var C=this.getAppliesTo();var I=C.updateManager||C.um;if(E==null){E=new Array();}var A;if(!this.validateInputs()){return false;}this.changeGridProperties=(C&&C.commands.queryEnabled("onegrid")==true)?true:false;var L=this.isGridContainerSelected();var B=false;var H=null;if(this.isPanelStackSelected()){if(this.targetAxis==0&&this.targetLevel==1){microstrategy.formatType=mstrPanelStack.FMT_TYPE_TITLE;}}if(this.changeGridProperties&&L&&this.targetLevel==9){microstrategy.formatType=mstrGridReport.FMT_TYPE_TITLE;}if(E.length==0){for(A=0;A<this.childrenTabs.length;A++){var G=this.childrenTabs[A];if(this.changeGridProperties&&!L){G.enforceSubmit=true;}G.applyFormatChanges(C,E);B=B||G.enforceSubmit;if(typeof (G.isUserMetric)!="undefined"&&G.isUserMetric){this.formatUserMetric=true;H=G;}}this.getExtraFormatChanges(C,E);}if(E.length>0){if(this.formatUserMetric){var K=new Object();K.userMetricId=H.userMetricId;K.dataSetId=H.dataSetId;K.bulkChanges=E;C.commands.exec("formatUserMetric",K);}else{if(this.changeGridProperties==true&&this.targetAxis!=null){var J=C.commands.queryState("selectedGrid");var F=microstrategy.findBone(J);if(F==null){F=microstrategy.findBone(document.getElementById(J.id));}if(F){F.selectedAxis=this.targetAxis;F.selectedPosition=this.targetPosition;F.selectedLevel=this.targetLevel;F.selectedUnit=this.targetUnit;}if(L){C.commands.exec("formatBulk",E);if(B&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&I){I.flushAndSubmitChanges();}}else{C.commands.exec("formatGridBulk",E);}}else{C.commands.exec("formatBulk",E,this.isPanelStackSelected()&&this.targetAxis==1);if(B&&microstrategy.DISPLAY_MODE!=microstrategy.DESIGN_MODE&&I){I.flushAndSubmitChanges();}}}this.changesApplied++;}microstrategy.formatType=microstrategy.FORMAT_TYPE_MAIN;return true;}catch(D){microstrategy.errors.log(D);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.getExtraFormatChanges=function(A,B){try{}catch(C){microstrategy.errors.log(C);}return B;};mstrFormatImpl.prototype.applyMultiLevelFormatChanges=function(){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyMultiLevelFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}var B=this.getAppliesTo();if(!B){return ;}if(!this.validateInputs()){return false;}var D=microstrategy.updateManager;var C=new Array();var A=false;D.queueActions=true;for(var E=0;E<this.childrenTabs.length;E++){var G=this.childrenTabs[E];C=G.applyFormatChanges(B,C);A=A||G.enforceSubmit;}if(C.length==0){D.queueActions=false;return ;}B.commands.exec("formatMultiLevelBulk",C);D.addCachedActions();if(A){D.flushAndSubmitChanges();}this.changesApplied++;return true;}catch(F){microstrategy.errors.log(F);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyMultiLevelFormatChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.applyScheduleChanges=function(G){try{var B=this.scheduleTab;if(B){var A=this.getAppliesTo();var D=B.getScheduleType();var E=B.getScheduleList();if(D!=B.scheduleType||E!=B.scheduleList){var C=A.updateManager||A.um;C.add([C.createActionObject(A.elem,mstrUpdateManager.SAVE_REPORT_ASSOCIATED_SCHEDULES,A.beanPath,["4238","4239"],[D,E],[B.scheduleType,B.schedule])]);if(G){C&&C.flushAndSubmitChanges();}}return true;}}catch(F){microstrategy.errors.log(F);return false;}};mstrFormatImpl.prototype.applyUserChanges=function(H){try{var C=this.deliveryTab;if(C){var B=this.getAppliesTo(),D=C.getAssociatedUserInfo(),F=D.userType,A=D.users;if(F!=C.userTypeWas||A!=C.usersWas){var E=B.updateManager||B.um;E.add([E.createActionObject(B.elem,mstrUpdateManager.SAVE_REPORT_ASSOCIATED_USERS,B.beanPath,["4241","4242"],[D.allowType,A])]);if(H){E&&E.flushAndSubmitChanges();}C.userTypeWas=F;C.usersWas=A;}return true;}}catch(G){microstrategy.errors.log(G);return false;}};mstrFormatImpl.prototype.applyPropertyChanges=function(G,F){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}if(F==false||this.validateInputs(true)){var A=this.getAppliesTo();var D=new Array();for(var B=0;B<this.childrenTabs.length;B++){var E=this.childrenTabs[B];E.applyPropertyChanges(D);if(E.applySharedObjChanges){E.applySharedObjChanges(D);}}this.applyScheduleChanges(D.length==0);this.applyUserChanges(D.length==0);if(D.length>0){if(G&&G.length>0){A.commands.exec(G,D);}else{A.commands.exec("PropertyChanges",D);}}this.changesApplied++;return true;}else{return false;}}catch(C){microstrategy.errors.log(C);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.applyMultiLevelPropertyChanges=function(H){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("mstrFormatImpl.applyPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}var B=this.getAppliesTo();if(!B){return ;}if(H&&!this.validateInputs()){return false;}var D=microstrategy.updateManager;var C=new Array();var A=false;D.queueActions=true;for(var E=0;E<this.childrenTabs.length;E++){var G=this.childrenTabs[E];G.applyPropertyChanges(C);A=A||G.enforceSubmit;}if(C.length==0){D.queueActions=false;return ;}B.commands.exec("MultiLevelPropertyChanges",C);D.addCachedActions();if(A){D.flushAndSubmitChanges();}this.changesApplied++;return true;}catch(F){microstrategy.errors.log(F);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.ACTION_LEVEL|mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("mstrFormatImpl.applyMultiLevelPropertyChanges",mstrLogImpl.APPLY_EDITOR_CHANGES);}}};mstrFormatImpl.prototype.okPropertyChanges=function(E,D){try{var B=true;B=this.validateInputs(true);if(B){this.close();if(D){this.applyMultiLevelPropertyChanges(false);}else{this.applyPropertyChanges(E,false);}for(var A=0;A<this.childrenTabs.length;A++){this.childrenTabs[A].cleanup();}this.actionId=null;microstrategy.unRegisterBone(this.id);}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.okFormatChanges=function(B){try{B=(B==true);if(!this.validateInputs()){return false;}else{this.close();if(B){this.applyMultiLevelFormatChanges();}else{this.applyFormatChanges();}microstrategy.unRegisterBone(this.id);}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.okGraphFormatChanges=function(){try{if(!this.validateInputs()){return false;}else{this.close();this.applyGraphFormatChanges();microstrategy.unRegisterBone(this.id);}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.adjustFormatType=function(){try{if(this.changeGridProperties&&this.targetAxis==0&&this.targetLevel==9){microstrategy.formatType=mstrGridReport.FMT_TYPE_TITLE;}if(this.isPanelStackSelected()){if(this.targetAxis==0&&this.targetLevel==1){microstrategy.formatType=mstrPanelStack.FMT_TYPE_TITLE;}}}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.getHTMLElement=function(A){if(typeof (A)=="string"){A=getElementById(A);}return A;};mstrFormatImpl.prototype.hasChanges=function(){var A=false;var B;for(B=0;B<this.childrenTabs.length;B++){var C=this.childrenTabs[B];A=C.checkForFormatChanges();if(A){break;}}return A;};mstrFormatImpl.prototype.changeTarget=function(F,H){try{var A=this.getAppliesTo();var C=new Array();F=mstrFormatImpl.getHTMLElement(F);var G=A.updateManager||A.um;var D=this.hasChanges();if((typeof (H)=="undefined")&&D){showMessage({contents:microstrategy.descriptors.getDescriptor("3044"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').changeTarget('"+F.id+"',true);",cancelEval:"microstrategy.bone('"+this.id+"').changeTarget('"+F.id+"',false);",type:mstrMsgBoxImpl.MSG_WARNING});}else{var I=new Array();for(counter=0;counter<this.childrenTabs.length;counter++){var E=this.childrenTabs[counter];E.applyFormatChanges(A,C);}if((typeof (H)=="boolean")&&H&&(C.length>0)){if(this.applyFormatPropertyChanges){this.applyFormatPropertyChanges(C);}else{this.applyFormatChanges(C);}this.targetAxis=F.value;I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003"],[F.value]));G.add(I);if(this.submitUponTargetLevelChange){this.unRegisterChildren();}}else{this.targetAxis=F.value;if(A&&G){I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003"],[F.value]));G.add(I);if(this.submitUponTargetLevelChange){G.flushAndSubmitChanges();this.unRegisterChildren();}}}}if(!this.submitUponTargetLevelChange){this.adjustTargetLevelOptions();this.initChildrenTabs();}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.changePosition=function(F,H){try{var A=this.getAppliesTo();var C=new Array();F=mstrFormatImpl.getHTMLElement(F);var G=A.updateManager||A.um;var D=this.hasChanges();if((typeof (H)=="undefined")&&D){showMessage({contents:microstrategy.descriptors.getDescriptor("3044"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').changePosition('"+F.id+"',true);",cancelEval:"microstrategy.bone('"+this.id+"').changePosition('"+F.id+"',false);",type:mstrMsgBoxImpl.MSG_WARNING});}else{var I=new Array();for(counter=0;counter<this.childrenTabs.length;counter++){var E=this.childrenTabs[counter];C=E.applyFormatChanges(A,C);}if((typeof (H)=="boolean")&&H&&(C.length>0)){if(F.value=="0,-9"){I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003","72002"],[0,8]));}else{I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72001"],[F.value]));}G.add(I);this.applyFormatChanges(C);G.flushAndSubmitChanges();this.unRegisterChildren();}else{if(A&&G){if(F.value=="0,-9"){I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72003","72002"],[0,8]));}else{I.push(G.createActionObject(F,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72001"],[F.value]));}G.add(I);G.flushAndSubmitChanges();this.unRegisterChildren();}}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.changeLevel=function(G,F){try{var B=this.getAppliesTo();G=mstrFormatImpl.getHTMLElement(G);var D=B.updateManager||B.um;var A=this.hasChanges();if(typeof (F)=="undefined"&&A){showMessage({contents:microstrategy.descriptors.getDescriptor("3044"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"microstrategy.bone('"+this.id+"').changeLevel('"+G.id+"',true);",cancelEval:"microstrategy.bone('"+this.id+"').changeLevel('"+G.id+"',false);",type:mstrMsgBoxImpl.MSG_WARNING});return ;}if(F==true&&A){this.applyFormatChanges();}this.targetLevel=G.value;if(B&&D){if(this.submitUponTargetLevelChange==true||F==true){var C=new Array();C.push(D.createActionObject(G,mstrUpdateManager.CHANGE_FORMATTING_TARGET,this.beanPath,["72002"],[G.value]));D.add(C);}if(this.submitUponTargetLevelChange){D.flushAndSubmitChanges();this.unRegisterChildren();}else{this.initChildrenTabs();}}}catch(E){microstrategy.errors.log(E);return false;}};mstrFormatImpl.prototype.setCurTab=function(D){try{var B=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab");for(var A=0;A<B.length;A++){if(B[A].getAttribute("curTab")==D){this.setCurrentTab(B[A]);break;}}}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.setCurrentTab=function(G){try{if(!G){return false;}if(this.currentTab==G.getAttribute("curTab")){return false;}if((G.className.indexOf("disabled")>=0)||(!this.validateInputs())){return true;}var C=microstrategy.findChildrenWithAtt(this.elem,"span","ty","tab");var E=true;var H=null;for(var B=0;B<C.length;B++){var F=C[B].getAttribute("tab");if(F){F=getElementById(F);}if(C[B]==G){C[B].className="mstrTabSetTabSelected";this.currentTab=G.getAttribute("curTab");if(F&&G.getAttribute(microstrategy.TAB_SWITCH_MODE)==microstrategy.TAB_SWITCH_MODE_CACHED){this.updateDynamicInfo(G);this.showTabSection(F);H=microstrategy.findBone(F);E=false;for(var A=0;A<this.childrenTabs.length;A++){if(this.childrenTabs[A]&&this.childrenTabs[A].id==G.id.substring(0,G.id.indexOf("_tab"))&&this.childrenTabs[A].onpostswitch){this.childrenTabs[A].onpostswitch();break;}}}}else{if(C[B].className.indexOf("disabled")==-1){C[B].className="mstrTabSetTab";this.hideTabSection(F);}}}this.addSetTabEvent(E);if(E){microstrategy.updateManager.flushAndSubmitChanges();}else{if(this.adjustTabTable){this.adjustTabTable();if(H){if(H.resize){H.resize();}if(H.onSwitchToCurrent){H.onSwitchToCurrent();}}}}this.resizePopUp(this.elem);microstrategy.eventManager.notifyOrphanBones("onstatechange");return true;}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.findTabSectionContainer=function(B){try{return B;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.showTabSection=function(C){try{if(!C){return ;}var A=this.findTabSectionContainer(C);A.style.display="block";A.style.visibility="visible";}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.hideTabSection=function(C){try{if(!C){return ;}var A=this.findTabSectionContainer(C);A.style.display="none";A.style.visibility="hidden";}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.updateDynamicInfo=function(B){try{this.updateDynamicTitle(B);this.updateDynamicHelp(B);}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.updateDynamicTitle=function(C){try{var A=this.getTitleContainer();if(this.useDynamicTitle&&A){if(A.childNodes[0]){A.childNodes[0].nodeValue=(C.childNodes[0].childNodes[0])?C.childNodes[0].childNodes[0].nodeValue:C.childNodes[0].nodeValue;A.setAttribute("title",A.childNodes[0].nodeValue);}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.updateDynamicHelp=function(C){if(this.help){this.help.setAttribute("href",(C.getAttribute("helpUrl"))?C.getAttribute("helpUrl"):this.defaultHelpURL);if(this.help.childNodes[0]&&this.getTitleContainer()){var B=microstrategy.descriptors.getDescriptor("2409").replace("###",this.titleContainer.childNodes[0].nodeValue);this.help.childNodes[0].setAttribute("title",B);}}try{}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.addSetTabEvent=function(C){try{var B=microstrategy.updateManager;if(B){var A=new Array();A.push(B.createActionObject(null,mstrUpdateManager.SET_CURRENT_TAB,this.beanPath,["49001","49002"],[this.currentTab,C]));B.add(A,true);}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.getChangedTabOptions=function(){try{var B="";for(var A=0;A<this.childrenTabs.length;A++){var D=this.childrenTabs[A];var E=D.getChanges();if(E!=null&&E.length>0){B+='"'+D.id+'":{'+E+"},";}}if(B.length>0){B=B.substring(0,B.length-1);}B="{"+B+"}";return B;}catch(C){microstrategy.errors.log(C);return false;}};mstrFormatImpl.prototype.validateInputs=function(C){try{if(!mstrEditorImpl.prototype.validateInputs.call(this)){return false;}if(C){for(var A=0;A<this.childrenTabs.length;A++){var D=this.childrenTabs[A];if(!D.validateInputs()){return false;}}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.onmenusubmitform=function(){if(this.autoSubmitJS!=null){return eval(this.autoSubmitJS);}};mstrFormatImpl.prototype.applySortChanges=function(){try{var B=new Array();for(var A=0;A<this.childrenTabs.length;A++){var E=this.childrenTabs[A];E.getSortChanges(B);}var C=microstrategy.updateManager;if(B.length>0&&C){C.add(B,true);C.flushAndSubmitChanges();}}catch(D){microstrategy.errors.log(D);return false;}};mstrFormatImpl.prototype.okSortChanges=function(){try{this.close();this.applySortChanges();microstrategy.unRegisterBone(this.id);return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrFormatImpl.prototype.afterresize=function(){try{if(mstrEditorImpl.prototype.afterresize){mstrEditorImpl.prototype.afterresize.call(this);}for(var A=0;A<this.childrenTabs.length;A++){if(this.childrenTabs[A]&&this.childrenTabs[A].afterresize){this.childrenTabs[A].afterresize();}}}catch(B){microstrategy.errors.log(B);return false;}};mstrFormatImpl.prototype.getTitleContainer=function(){try{if(!this.titleContainer){this.titleContainer=microstrategy.findChildWithAtt(this.elem,"span",((bIsW3C)?"class":"className"),"mstrPanelTitle");}return this.titleContainer;}catch(A){microstrategy.errors.log(A);return false;}};function mstrFormatImpl(A){this.inherits=mstrEditorImpl;this.inherits(A);this.inherits=null;return this;}mstrFormatImplCommandsImpl.prototype=new Object();mstrFormatImplCommandsImpl.prototype.queryEnabled=function(A){try{switch(A){case"fontprops":if(this.parentBone.areAllSelectedPanelStacks()){return false;}if(this.parentBone.isPanelStackSelected()){if(this.parentBone.targetAxis==1){return false;}if(this.parentBone.targetLevel!=1){return false;}}else{if(this.parentBone.isGridSelected()){if((this.parentBone.targetPosition==-9&&this.parentBone.targetLevel==8)||(this.parentBone.targetPosition==-99)){return false;}}}break;case"numberprops":if(this.parentBone.areAllSelectedPanelStacks()){return false;}if(this.parentBone.isPanelStackSelected()){return false;}if(this.parentBone.isGridSelected()){if(this.parentBone.isGridContainerSelected()||(this.parentBone.targetPosition==-99)){return false;}}break;case"alignprops":if(this.parentBone.areAllSelectedPanelStacks()){return false;}if(this.parentBone.isPanelStackSelected()){return false;}if(this.parentBone.isGridSelected()){if(this.parentBone.isGridContainerSelected()||(this.parentBone.targetPosition==-99)){return false;}}break;case"dropShadowEffect":if(this.parentBone.isGridSelected()){if(this.parentBone.targetPosition==-99){return false;}}case"effectprops":if(this.parentBone.isPanelStackSelected()){if(this.parentBone.targetLevel==1){return false;}}else{if(this.parentBone.isGridSelected()){if((this.parentBone.targetPosition!=-9||this.parentBone.targetLevel!=8)&&(this.parentBone.targetPosition!=-99)){return false;}}}break;}return true;}catch(B){microstrategy.errors.log(B);return false;}};function mstrFormatImplCommandsImpl(A){this.parentBone=A;return this;}var mstrFormatObject={visibility:["FormattingAppearance","Visible",false,"101,102,105,106,107,52,53,4,8,111"],DisplayStyle:["FormattingAppearance","DisplayStyle",true,"106"],zoom:["RWDocumentProperties","ZoomFactor",false,"all"],borderBottomColor2:["FormattingBorder","Border3DBottomColor",false,"102,106,107,52,53,111,101,8,t,de"],GraphFormat:["FormattingPage","GraphFormat",true,"all"],FormattingNavigation:{Hyperlink:["link",true,"102,106","href"],OpenInNewWindow:["newWin",true,"102,106","nw"],IsHyperlink:["isLink",true,"102,106","isl"]},Autowire:["FormattingLayout","Autowire",true,"all"],textDecoration:["FormattingFont","Underline",false,"52,106,107,111,8,208,t,de,df"],SetBadgeToValueOnField:["FormattingTransactions","SetBadgeToValueOnField",true,"106"],MobileDataView:["Mobile","View",true,"all"],EnableHorizontalSwipeToChange:["FormattingView","EnableHorizontalSwipeToChange",true,"8"],topRightCornerRadius:["FormattingAppearance","TopRightCornerRadius",true,"101,8"],BlackAndWhite:["FormattingPage","BlackAndWhite",true,"all"],EmbedFonts:["FormattingPage","EmbedFonts",true,"all"],InitialSlidingInHeight:["FormattingView","InitialSlidingInHeight",true,"8"],AvailableViewModes:["FormattingPage","AvailableViewModes",true,"all"],FormattingPadding:{TopPadding:["paddingTop",false,"52,106,t,de"],LeftPadding:["paddingLeft",false,"52,106,t,de"],LineSpacing:["lineHeight",false,"106,t"],RightPadding:["paddingRight",false,"52,106,t,de"],BottomPadding:["paddingBottom",false,"52,106,t,de"]},PDFExportDocumentURL:["RWDocumentProperties","PDFExportDocumentURL",true,"all"],fontWeight:["FormattingFont","Bold",false,"52,106,107,111,8,t,de,df"],CalculateDocWidth:["RWDocumentProperties","CalculateDocWidth",true,"all"],titleBarDisplay:["FormattingView","TitleBarDisplay",true,"52,8"],LayoutWidth:["FormattingPage","Width",true,"all"],IPhoneVisualization:["Visualization","IPhoneVisualization",true,"52"],gridExportOverFlow:["FormattingCrosstab","ExportOverflowMode",true,"52"],SelectedVisualization:["Visualization","SelectedVisualization",true,"52"],gradientYOffset:["FormattingPatterns","GradientYOffset",true,"101,106,107,52,53,4,8,9,111,208"],TOCTitleFontItalic:["TableOfContents","TitleFontItalic",true,"all"],PaperType:["FormattingPage","PaperType",false,"all"],InfoWindowPosition:["FormattingView","InfoWindowPosition",true,"8"],SecondaryDataProviders:["FormattingWidget","SecondaryDataProviders",true,"52,111"],FilterDetailsFormat:["FilterDetailsFormatProperties","FilterDetailsFormat",true,"all"],left:["FormattingPosition","Left",false,"101,102,105,106,107,52,53,8,111"],showOnlyInRepeatingCopies:["FormattingAppearance","ShowOnlyInRepeatingCopies",true,"101,102,105,106,107,52,53,8,111"],paddingBottom:["FormattingPadding","BottomPadding",false,"52,106,t,de"],Blur:["FormattingAppearance","Blur",true,"8"],Orientation:["FormattingPage","Orientation",true,"all"],borderTopColor2:["FormattingBorder","Border3DTopColor",false,"102,106,107,52,53,111,101,8,t,de"],isLink:["FormattingNavigation","IsHyperlink",true,"102,106"],FilterDetailsFormatProperties:{FilterDetailsFormat:["FilterDetailsFormat",true,"all"]},gridOverFlow:["FormattingCrosstab","OverflowMode",true,"52"],DisplaySelectorDocked:["FormattingSelector","DisplaySelectorDocked",true,"111"],RSLPath:["FormattingWidget","RSLPath",true,"52,111"],listSeparators:{"2055":";","2064":";","2060":";","2052":",","3082":",","1046":";","1028":",","1036":";","1045":";","1049":";","4108":";","1033":",","1030":";","1031":";","1040":";","1041":",","1042":",","1043":";","1053":";","2057":","},canGrowHorizontal:["FormattingSize","CanGrowHorizontal",true,"4"],fontStyle:["FormattingFont","Italic",false,"52,106,107,111,8,t,de,df"],lockAspectRatio:["FormattingSize","LockAspectRatio",true,"102,106"],FormattingIncrementalFetch:{PreLoadAllPanels:["PSPreLoadAllPanels",true,"8","plp"],MaxRows:["gridIfMaxRows",true,"52","gmr"],RowIFMode:["gridIfRowMode",true,"52","gifmd"],EnableIFOnGrid:["gridIfEnabled",true,"52","gif"]},SupportedOrientations:["FormattingLayout","SupportedOrientations",true,"all"],APhoneVisualization:["Visualization","APhoneVisualization",true,"52"],textAlign2:["FormattingAlignment","Horizontal2",false,"52"],FormattingHTML:{HTMLType:["htmlType",true,"107","htype"],URL:["url",true,"107","hsrc"],HTMLText:["htmlText",true,"107","htxt"]},formatVersion:["FormattingAppearance","FormatVersion",true,"52"],OfflineSubmission:["FormattingSelector","OfflineSubmission",true,"111"],Enable:["FormattingWidget","Enable",true,"52,111"],ViewModeInteractivityLevel:["RWDocumentProperties","ViewModeInteractivityLevel",true,"all"],IPadVisualization:["Visualization","IPadVisualization",true,"52"],topCornersOnly:["FormattingAppearance","TopCornersOnly",true,"101,8"],backgroundColor:["FormattingPatterns","FillColor",false,"101,106,107,52,53,4,8,9,111,208,t,de"],borderLeftStyle:["FormattingBorder","LeftStyle",false,"102,106,107,52,53,111,8,t,de"],UseAsNavBar:["FormattingLayout","UseAsNavBar",true,"8"],ActionForDirectTargetSelectors:["FormattingSelector","ActionForDirectTargetSelectors",true,"111"],ShowFloatingToolbars:["RWDocumentProperties","ShowFloatingToolbars",true,"all"],MarginLeft:["FormattingPage","MarginLeft",true,"all"],TOCTitleFontBold:["TableOfContents","TitleFontBold",true,"all"],height:["FormattingSize","Height",false,"101,102,105,106,107,52,53,4,8,111,4"],PSPreLoadAllPanels:["FormattingIncrementalFetch","PreLoadAllPanels",true,"8"],borderRightColor2:["FormattingBorder","Border3DRightColor",false,"102,106,107,52,53,111,101,8,t,de"],decodeValue:function(A,H){try{if((A in mstrFormatObject)&&mstrFormatObject[A][mstrFormatObject.USE_VALUE]){return H;}var B=function(J,K){if(K!=undefined&&(J==null||J.length==0)){return K+"px";}else{if(J=="auto"||J=="100%"){return J;}else{return(parseFloat(microstrategy.number.toString(J))*microstrategy.DPI_CONVERSION*(microstrategy.ZOOM_FACTOR/100))+"px";}}};var E=function(J,K){if(K!=undefined&&(J==null||J.length==0)){J=K;}return parseFloat(J)*(microstrategy.ZOOM_FACTOR/100)+"pt";};var C=function(K,N){if(K==null||K.length==0){return(N!=undefined)?N:null;}if(K=="-1"){return"transparent";}else{if(K=="-2"){return -2;}else{var J=parseInt(K).toString(16);for(var M=0,L=J.length;M<6-L;M++){J="0"+J;}return"#"+J.substring(4)+J.substring(2,4)+J.substring(0,2);}}};var F={0:"0pt solid",8:"0pt none",3:"1pt dashed",4:"1pt dotted",5:"1.5pt solid",6:"2.5pt double",1:"1pt solid",7:"0.5pt solid"};var G=function(K){K=F[K]||"";if(K==null||K==""){return"";}var J=K.indexOf("pt");return(K.substring(0,J)*(microstrategy.ZOOM_FACTOR/100))+K.substring(J);};H=String(H);var I=H.toLowerCase();switch(A){case"top":return B(I);case"left":return B(I);case"width":return B(I);case"height":return B(I);case"oldWidth":case"oldHeight":case"heightMode":return I;case"widthMode":return I;case"maxHeight":return B(I);case"maxWidth":return B(I);case"TextOverflow":switch(I){case"-1":return"auto";case"0":return"hidden";}case"visibility":switch(I){case"-1":return"visible";case"0":return"hidden";}case"textAlign":switch(I){case"1":return"right";case"2":return"center";case"6":return"justify";default:return"left";}case"textAlign2":switch(I){case"4":return"right";case"3":return"center";case"6":return"justify";default:return"left";}case"verticalAlign":switch(I){case"1":return"middle";case"2":return"bottom";default:return"top";}case"verticalAlign2":switch(I){case"2":return"middle";case"3":return"bottom";default:return"top";}case"whiteSpace":switch(I){case"0":return"nowrap";default:return"normal";}case"fontSize":return E(I);case"color":return C(I,"");case"fontWeight":switch(I){case"-1":return"bold";default:return"normal";}case"fontStyle":switch(I){case"-1":return"italic";default:return"normal";}case"textDecoration":return(I==null||I.length==0||I=="0")?null:"underline";case"textDecoration2":return(I==null||I.length==0||I=="0")?null:"line-through";case"FontHighlightColor":return C(I);case"backgroundColor":return C(I,"");case"backgroundStyle":if(I==null||I.length==0){return null;}else{return(I=="1")?"transparent":"0";}case"gradientColor":return C(I);case"selectionColor":return C(I);case"BackgroundHighlightColor":return C(I);case"borderTopColor2":return C(I);case"borderRightColor2":return C(I);case"borderBottomColor2":return C(I);case"borderLeftColor2":return C(I);case"borderTopColor":return C(I);case"borderRightColor":return C(I);case"borderBottomColor":return C(I);case"borderLeftColor":return C(I);case"borderTopStyle":return G(I);case"borderRightStyle":return G(I);case"borderBottomStyle":return G(I);case"borderLeftStyle":return G(I);case"paddingLeft":return E(I);case"paddingRight":return E(I);case"paddingTop":return E(I);case"paddingBottom":return E(I);case"lineHeight":return(I==null||I.length==0||I=="0"||I=="")?"normal":parseFloat(I)+"in";case"lineStyle":switch(I){case"2":return"dashed";case"3":return"dotted";case"4":return"double";case"0":return"none";default:return"solid";}case"lineColor":return C(I,"");case"lineWeight":return E(I);case"orientation":switch(I){case"1":return"border-left";default:return"border-top";}case"PaperType":switch(I){case"1":return"2A,46.81,66.18";case"2":return"A0,33.11,46.81";case"3":return"A1,23.39,33.11";case"4":return"A2,16.54,23.39";case"5":return"A3,11.69,16.54";case"6":return"A4,8.27,11.69";case"7":return"A5,5.83,8.27";case"8":return"A6,4.13,5.83";case"9":return"A7,2.91,4.13";case"10":return"A8,2.09,2.91";case"11":return"C,17,22";case"12":return"D,22,34";case"13":return"E,34,44";case"14":return"Executive,7.25,10.5";case"15":return"F,28,40";case"16":return"Ledger,11,17";case"17":return"Legal,8.5,14";case"18":return"Letter,8.5,11";case"19":return"Super A3/B,13,19";case"20":return"Folio,8.5,13";default:return"Custom";}case"zoom":return parseFloat(microstrategy.number.toString(I));case"TabColor":return C(I,"");}}catch(D){microstrategy.errors.log(D);return H;}},mct:["FormattingSelector","MetricConditionType",true,"111"],maxWidth:["FormattingSize","MaxWidth",false,"4"],lengthMode:["FormattingSize","LengthMode",true,"105"],PromptUserForPagebyExport:["RWDocumentProperties","PromptUserForPagebyExport",true,"all"],whiteSpace:["FormattingAlignment","TextWrap",false,"52,106,107,t,de"],RemoveMissingUnits:["AnalyticalEngineProperties","RemoveMissingUnits",true,"all"],OfflineOnCube:["RWDocumentProperties","OfflineOnCube",true,"all"],TOCLeftIndent:["TableOfContents","LeftIndent",true,"all"],borderLeftColor:["FormattingBorder","LeftColor",false,"102,106,107,52,53,111,8,t,de"],SmartClientDoc:["RWDocumentProperties","SmartClientDoc",true,"all"],Transition:["FormattingTransitions","Transition",true,"8,52"],Scaling:["FormattingPage","Scaling",true,"all"],borderRightColor:["FormattingBorder","RightColor",false,"102,106,107,52,53,111,8,t,de"],zIndex:["FormattingOrder","ZIndex",true,"101,102,105,106,107,52,53,8,111"],ExpandAllPanels:["FormattingAppearance","ExpandAllPanels",true,"8"],FormattingOrder:{ZIndex:["zIndex",true,"101,102,105,106,107,52,53,8,111"]},FormattingSelector:{IndependentNodeSelector:["IndependentNodeSelector",true,"52"],Orientation:["ctlOrientation",true,"111"],MouseOverAction:["mouseOverAction",true,"111"],TXNSubmitInOrder:["TXNSubmitInOrder",true,"111"],DisplaySelectorDocked:["DisplaySelectorDocked",true,"111"],NoSelectionBehavior:["NoSelectionBehavior",true,"111","nsb"],MinSelectionCount:["MinSelectionCount",true,"111","misc"],Style:["Style",true,"111"],ActionForDirectTargetSelectors:["ActionForDirectTargetSelectors",true,"111","adts"],Multiselect:["Multiselect",true,"52,111"],InformationWindowTarget:["InformationWindowTarget",true,"102,106,111","ifw"],ShowElementCount:["showElementCount",true,"111","sec"],ItemWidthMode:["ItemWidthMode",true,"111"],ExportAsShownOnWeb:["ExportAsShownOnWeb",true,"111","aow"],MaxSelectionCount:["MaxSelectionCount",true,"111","masc"],ShowSummary:["ShowSummary",true,"111"],MetricConditionType:["mct",true,"111"],OfflineSubmission:["OfflineSubmission",true,"111"],SubmitMessage:["SubmitMessage",true,"111"],DisplayText:["DisplayText",true,"111"],SearchOnServer:["SearchOnServer",true,"111","sos"],Include:["Include",true,"111"],DisplayConfirmation:["DisplayConfirmation",true,"111"]},gridShowRH:["FormattingCrosstab","ShowRowHeaders",true,"52"],MaxSelectionCount:["FormattingSelector","MaxSelectionCount",true,"111"],TARGET:4,name:["FormattingAppearance","Name",true,"101,102,105,106,107,52,53,4,8,111"],textAlign:["FormattingAlignment","Horizontal",false,"106,111,107,t,de"],borderLeftColor2:["FormattingBorder","Border3DLeftColor",false,"102,106,107,52,53,111,101,8,t,de"],DisplayConfirmation:["FormattingSelector","DisplayConfirmation",true,"111"],TOCBorderColor:["TableOfContents","BorderColor",true,"all"],TXNSubmitInOrder:["FormattingSelector","TXNSubmitInOrder",true,"111"],NonFlashRender:["FormattingWidget","NonFlashRender",true,"52"],VisualizationList:["Visualization","VisualizationList",true,"52"],TOCFontName:["TableOfContents","FontName",true,"all"],TOCTitleFillColor:["TableOfContents","TitleFillColor",true,"all"],UseAsFilterPanel:["FormattingLayout","UseAsFilterPanel",true,"8"],forceNewPage:["FormattingSection","ForceNewPage",true,"4"],color:["FormattingFont","Color",false,"52,106,107,111,8,t,de,df"],RefreshFrequency:["Mobile","RefreshFrequency",true,"all"],windowState:["FormattingView","WindowState",true,"52,111"],TOCTitleFontColor:["TableOfContents","TitleFontColor",true,"all"],gridArea:["FormattingCrosstab","GridAreaPercent",true,"52"],lineHeight:["FormattingPadding","LineSpacing",false,"106,t"],PROP_SET:0,borderRightStyle:["FormattingBorder","RightStyle",false,"102,106,107,52,53,111,8,t,de"],exportOptions:["FormattingCrosstab","ShowExportOptions",true,"52"],CustomProps:["Visualization","CustomProps",true,"52"],FontHighlightColor:["FormattingFont","HighlightColor",false,"106"],ShowTabLeader:["TableOfContents","ShowTabLeader",true,"all"],autoResizeInDesign:["FormattingSize","AutoResizeInDesign",true,"106"],EnableExport:["Mobile","EnableExport",true,"all"],bottomRightCornerRadius:["FormattingAppearance","BottomRightCornerRadius",true,"101,8"],BeforeLayout:["TableOfContents","BeforeLayout",true,"all"],InformationWindowPlacement:["FormattingView","InformationWindowPlacement",true,"8"],orientation:["FormattingLine","LineOrientation",false,"105"],paddingTop:["FormattingPadding","TopPadding",false,"52,106,t,de"],FormattingFont:{Name:["fontFamily",true,"52,106,107,111,8,t,de,df"],Bold:["fontWeight",false,"52,106,107,111,8,t,de,df"],HighlightColor:["FontHighlightColor",false,"106","fhlc"],Underline:["textDecoration",false,"52,106,107,111,8,208,t,de,df"],Strikeout:["textDecoration2",false,"52,106,107,111,8,208,t,de,df"],Italic:["fontStyle",false,"52,106,107,111,8,t,de,df"],Color:["color",false,"52,106,107,111,8,t,de,df"],Size:["fontSize",false,"52,106,107,111,8,t,de,df"]},Visualization:{APhoneVisualization:["APhoneVisualization",true,"52","aphv"],IncludeMDProperties:["IncludeMDProperties",true,"52"],ATabletVisualization:["ATabletVisualization",true,"52","atv"],IPadVisualization:["IPadVisualization",true,"52","ipadv"],ViewMode:["ViewMode",true,"52"],IPhoneVisualization:["IPhoneVisualization",true,"52","iphv"],FileName:["FileName",true,"52"],VisualizationsEnabled:["VisualizationsEnabled",true,"52"],VisualizationList:["VisualizationList",true,"52"],SelectedVisualization:["SelectedVisualization",true,"52"],VisProps:["VisProps",true,"52"],CustomProps:["CustomProps",true,"52"]},fontSize:["FormattingFont","Size",false,"52,106,107,111,8,t,de,df"],paddingLeft:["FormattingPadding","LeftPadding",false,"52,106,t,de"],showTitleBar:["FormattingView","ShowTitleBar",true,"52,8,111"],BackgroundHighlightColor:["FormattingPatterns","HighlightColor",false,"8,106"],IgnoreInExport:["FormattingAppearance","IgnoreInExport",true,"8"],xTabView:["FormattingUnassigned","xTabView",true,"52"],oldWidth:["FormattingSize","OldWidth",false,"52"],SectionHorizontalOverflow:["FormattingPage","SectionHorizontalOverflow",true,"all"],EnableCopyForGridCell:["Mobile","EnableCopyForGridCell",true,"all"],SelectorBehavior:["RWDocumentProperties","SelectorBehavior",true,"all"],Multiselect:["FormattingSelector","Multiselect",true,"52,111"],ScalePagesTall:["FormattingPage","ScalePagesTall",true,"all"],ShowBookmarks:["FormattingPage","ShowBookmarks",true,"all"],ExportAsShownOnWeb:["FormattingSelector","ExportAsShownOnWeb",true,"111"],ExcelExportDocumentURL:["RWDocumentProperties","ExcelExportDocumentURL",true,"all"],WatermarkFontItalic:["WatermarkProperties","FontItalic",true,"all"],hideIfEmpty:["FormattingSection","HideIfEmpty",true,"4"],src:["FormattingUnassigned","src",true,"102"],FormattingPicture:{PictureAlignment:["pictureAlignment",true,"102"],NormalURL:["NormalURL",true,"106","nmurl"],HighlightURL:["HighlightURL",true,"106","hlurl"],PictureMode:["pictureMode",true,"102"]},ZoomType:["RWDocumentProperties","ZoomType",true,"all"],AnalysisSection:["FormattingAnalysis","AnalysisSection",true,"8,52"],NormalURL:["FormattingPicture","NormalURL",true,"106"],UseAsMasterPanel:["FormattingLayout","UseAsMasterPanel",true,"8"],"VLDB Select":{"MCE Join To Get Data Combination":["RWLevelMCEJoin",true,"all"]},FormattingLayout:{UseAsMasterPanel:["UseAsMasterPanel",true,"8","uamp"],UseAsTableControl:["UseAsTableControl",true,"8","uatc"],UseAsNavBar:["UseAsNavBar",true,"8","uanb"],UseMasterPageHeaderFooter:["TabMPHF",true,"all"],SupportedOrientations:["SupportedOrientations",true,"all"],UseAsFilterPanel:["UseAsFilterPanel",true,"8","uafp"],FitPDFContentHeight:["FitPDFContentHeight",true,"all"],ResetToFirstPanelWhenTargeted:["ResetToFirstPanelWhenTargeted",true,"all","rtfp"],Autowire:["Autowire",true,"all"],NavBarLayout:["NavBarLayout",true,"8","nbl"],UseSegments:["UseSegments",true,"all"],CtlAutoSubmit:["CtlAutoSubmit",true,"8","cas"],TabColor:["TabColor",false,"all"],DisplayPageByBar:["DisplayPageByBar",true,"all"],UseAsInfoWindow:["UseAsInfoWindow",true,"all"],DisplayRePromptIcon:["DisplayRePromptIcon",true,"all"],TableControlDefinition:["TableControlDefinition",true,"8","tcd"]},TARGET_VALUE_STYLE:1,TOCTitleFontStrikeout:["TableOfContents","TitleFontStrikeout",true,"all"],WatermarkFontStrikeout:["WatermarkProperties","FontStrikeout",true,"all"],TableControlDefinition:["FormattingLayout","TableControlDefinition",true,"8"],docked:["FormattingSection","DockSection",true,"dsec"],EditableViewMode:["FormattingPage","EditableViewMode",true,"all"],FormattingSection:{HideIfEmpty:["hideIfEmpty",true,"4","he"],FitExcelRowHeight:["fitExcelRowHeight",true,"4","ferh"],ForceNewPage:["forceNewPage",true,"4","fnp"],RepeatHorizontally:["repeatHorizontally",true,"4","rpth"],KeepSectionTogether:["keepSectionTogether",true,"4","kst"],RepeatSection:["repeatSection",true,"4","rpts"],ShowInHTMLViewMode:["showInHTMLViewMode",true,"4","shvm"],Expanded:["expanded",true,"none"],DockSection:["docked",true,"dsec","docked"]},TOCFontUnderline:["TableOfContents","FontUnderline",true,"all"],DocumentThemeColor:["Mobile","DocumentThemeColor",true,"all"],lineColor:["FormattingLine","LineColor",false,"101,105"],FormattingPage:{PageWidth:["PageWidth",true,"all"],PaperType:["PaperType",false,"all"],EditableViewMode:["EditableViewMode",true,"all"],GraphQualityDPI:["GraphQualityDPI",true,"all"],MarginTop:["MarginTop",true,"all"],DefaultGridStyle:["DefaultGridStyle",true,"all"],GraphFormat:["GraphFormat",true,"all"],ScalePagesTall:["ScalePagesTall",true,"all"],MarginLeft:["MarginLeft",true,"all"],ShowBookmarks:["ShowBookmarks",true,"all"],UsePageWidthAsLayoutWidth:["UsePageWidthAsLayoutWidth",true,"all"],ScalePageHeaderFooter:["ScalePageHeaderFooter",true,"all"],MarginBottom:["MarginBottom",true,"all"],PageHeight:["PageHeight",true,"all"],Width:["LayoutWidth",true,"all"],IncludeBookmarks:["IncludeBookmarks",true,"all"],BlackAndWhite:["BlackAndWhite",true,"all"],Orientation:["Orientation",true,"all"],EmbedFonts:["EmbedFonts",true,"all"],AvailableViewModes:["AvailableViewModes",true,"all"],MarginRight:["MarginRight",true,"all"],PrintHeaderOn:["PrintHeaderOn",true,"all"],UseOneSheetPerLayout:["UseOneSheetPerLayout",true,"all"],UseOneSheetPerGroupElement:["UseOneSheetPerGroupElement",true,"all"],ExpandToFit:["ExpandToFit",true,"all"],ScalePagesWide:["ScalePagesWide",true,"all"],PrintFooterOn:["PrintFooterOn",true,"all"],DefaultViewMode:["DefaultViewMode",true,"all"],ScalePercentage:["ScalePercentage",true,"all"],Scaling:["Scaling",true,"all"],SectionHorizontalOverflow:["SectionHorizontalOverflow",true,"all"]},DisplayText:["FormattingSelector","DisplayText",true,"111"],ShowTabsForSingleLayout:["RWDocumentProperties","ShowTabsForSingleLayout",true,"all"],CopyMode:["FormattingView","CopyMode",true,"106,52"],pictureAlignment:["FormattingPicture","PictureAlignment",true,"102"],DisplayInPartialScreen:["FormattingView","DisplayInPartialScreen",true,"8"],TOCTitleAlignment:["TableOfContents","TitleAlignment",true,"all"],pictureMode:["FormattingPicture","PictureMode",true,"102"],decimalSeparators:{"2055":".","2064":".","2060":",","2052":".","3082":",","1046":",","1028":".","1036":",","1045":",","1049":",","4108":".","1033":".","1030":",","1031":",","1040":",","1041":".","1042":".","1043":",","1053":",","2057":"."},AnalyticalEngineProperties:{TrimEmptySections:["TrimNoSectionData",true,"all"],RemoveNullGroups:["RemoveNullGroups",true,"all"],SingleSourceGrid:["SingleSourceGrid",true,"all"],KeepControlTargetsConsistent:["KeepControlTargetsConsistent",true,"all"],RemoveMissingUnits:["RemoveMissingUnits",true,"all"]},InformationWindowTarget:["FormattingSelector","InformationWindowTarget",true,"102,106,111"],backgroundStyle:["FormattingPatterns","FillStyle",false,"101,106,107,52,53,4,8,9,111,208"],lineWeight:["FormattingLine","LineWeight",false,"101,105"],ExpandToFit:["FormattingPage","ExpandToFit",true,"all"],TOCBorderStyle:["TableOfContents","BorderStyle",true,"all"],maxHeight:["FormattingSize","MaxHeight",false,"4"],IsNavigationDocument:["RWDocumentProperties","IsNavigationDocument",true,"all"],PROP_NAME:1,DatasetObjectsVisible:["FormattingAnalysis","DatasetObjectsVisible",true,"4"],CurrencySymbol:["FormattingNumber","CurrencySymbol",true,"100,106,52,t,de"],borderBottomColor:["FormattingBorder","BottomColor",false,"102,106,107,52,53,111,8,t,de"],ATTR_NAME:3,layoutBarStyle:["RWDocumentProperties","layoutBarStyle",true,"all"],AutoFontSize:["WatermarkProperties","AutoFontSize",true,"all"],ImageScale:["WatermarkProperties","ImageScale",true,"all"],heightMode:["FormattingSize","HeightMode",false,"101,102,105,106,107,52,53,111,8"],MarginTop:["FormattingPage","MarginTop",true,"all"],ExecutionFullScreenMode:["RWDocumentProperties","ExecutionFullScreenMode",true,"all"],FormattingCrosstab:{ShowExportOptions:["exportOptions",true,"52","seo"],ExportOverflowMode:["gridExportOverFlow",true,"52","xovf","2"],ShowRowHeaders:["gridShowRH",true,"52"],GridAreaPercent:["gridArea",true,"52"],ShowColHeaders:["gridShowCH",true,"52"],OverflowMode:["gridOverFlow",true,"52","ovf","2"],Prefetch:["quickSwitch",true,"52"],GridPosition:["gridPosition",true,"52"]},PageHeight:["FormattingPage","PageHeight",true,"all"],Include:["FormattingSelector","Include",true,"111"],CurrencyPosition:["FormattingNumber","CurrencyPosition",true,"100,106,52,t,de"],getAttrNameFromStyle:function(D){try{if(mstrFormatObject[D]){var C=mstrFormatObject[D][mstrFormatObject.PROP_SET];var A=mstrFormatObject[D][mstrFormatObject.PROP_NAME];if(C&&A){return mstrFormatObject[C][A][mstrFormatObject.ATTR_NAME];}}}catch(B){microstrategy.errors.log(err);}return null;},EnableTransition:["FormattingTransitions","Enable",true,"8,52"],NoSelectionBehavior:["FormattingSelector","NoSelectionBehavior",true,"111"],FormattingView:{DisplayInPartialScreen:["DisplayInPartialScreen",true,"8","dips"],TitleBarDisplay:["titleBarDisplay",true,"52,8","tbd"],ShowTitleBar:["showTitleBar",true,"52,8,111","swt"],InitialSlidingInHeight:["InitialSlidingInHeight",true,"8","isih"],InfoWindowPosition:["InfoWindowPosition",true,"8","iwp"],Title:["windowTitle",true,"52,8,9,111","wt"],WindowState:["windowState",true,"52,111","ws"],StyleForSwitchingPanel:["StyleForSwitchingPanel",true,"8","sfwp"],InitialSlidingInWidth:["InitialSlidingInWidth",true,"8","isiw"],InfoWindowMode:["InfoWindowMode",true,"8","iwm"],TabCloseToDismissInfoWindow:["TabCloseToDismissInfoWindow",true,"8","tctdiw"],UseAsInformationWindow:["UseAsInformationWindow",true,"8","uaiw"],EnableHorizontalSwipeToChange:["EnableHorizontalSwipeToChange",true,"8","ehstc"],ShowWidgetTitleBar:["ShowWidgetTitleBar",true,"52","swwt"],ShowAsCollapsiblePanel:["ShowAsCollapsiblePanel",true,"8","sacp"],CopyMode:["CopyMode",true,"106,52","mcm"],InformationWindowPlacement:["InformationWindowPlacement",true,"8","iwpl"]},FormattingUnassigned:{xTabView:["xTabView",true,"52","xTabView"],src:["src",true,"102","src"]},ShowChangeIndication:["FormattingTransactions","",true,"51,52"],enableGraphTooltips:["RWDocumentProperties","enableGraphTooltips",true,"all"],WatermarkFontSize:["WatermarkProperties","FontSize",true,"all"],UseAsInformationWindow:["FormattingView","UseAsInformationWindow",true,"8"],keepSectionTogether:["FormattingSection","KeepSectionTogether",true,"4"],Format:["FormattingNumber","Format",true,"100,106,52,t,de"],FormattingWidget:{WidgetProps:["WidgetProps",true,"52,111","wp"],SecondaryDataProviders:["SecondaryDataProviders",true,"52,111"],Enable:["Enable",true,"52,111"],RSLPath:["RSLPath",true,"52,111"],NonFlashRender:["NonFlashRender",true,"52","nfr","2"],ClassName:["ClassName",true,"52,111","twc","2"],IsApp:["IsApp",true,"52,111"],DhtmlRenderer:["DhtmlRenderer",true,"52","dr","2"]},DefaultGridStyle:["FormattingPage","DefaultGridStyle",true,"all"],getDecimalSeparator:function(B){try{return mstrFormatObject.decimalSeparators[B];}catch(A){microstrategy.errors.log(A);return".";}},TOCTitleFontUnderline:["TableOfContents","TitleFontUnderline",true,"all"],RepeatPanelSpacing:["FormattingAppearance","RepeatPanelSpacing",true,"8"],MarginBottom:["FormattingPage","MarginBottom",true,"all"],getPropertySetName:function(A){return mstrFormatObject[A][mstrFormatObject.PROP_SET];},DropZonesVisible:["FormattingAnalysis","DropZonesVisible",true,"8"],FormattingAlignment:{TextDirection:["TextDirection",true,"52,106,107,t,de","td","3"],Vertical2:["verticalAlign2",false,"52","vta2","3"],Vertical:["verticalAlign",false,"52,106,107,111,t,de","vta","3"],Horizontal2:["textAlign2",false,"52"],Horizontal:["textAlign",false,"106,111,107,t,de"],TextWrap:["whiteSpace",false,"52,106,107,t,de"]},TrimNoSectionData:["AnalyticalEngineProperties","TrimEmptySections",true,"all"],expanded:["FormattingSection","Expanded",true,"none"],ResetToFirstPanelWhenTargeted:["FormattingLayout","ResetToFirstPanelWhenTargeted",true,"all"],Collapsed:["FormattingAnalysis","Collapsed",true,"111"],DefaultPageByExportMode:["RWDocumentProperties","DefaultPageByExportMode",true,"all"],ExportRange:["RWDocumentProperties","ExportRange",true,"all"],topLeftCornerRadius:["FormattingAppearance","TopLeftCornerRadius",true,"101,8"],FormattingAppearance:{Transparency:["Transparency",true,"8","trpr"],Blur:["Blur",true,"8","blur"],TopCornersOnly:["topCornersOnly",true,"101,8","tco"],ExpandAllPanels:["ExpandAllPanels",true,"8","ep"],Visible:["visibility",false,"101,102,105,106,107,52,53,4,8,111","visible"],FormatVersion:["formatVersion",true,"52","fmtv"],DisplayStyle:["DisplayStyle",true,"106","dpst"],BottomRightCornerRadius:["bottomRightCornerRadius",true,"101,8","brcr"],ShowOnlyInRepeatingCopies:["showOnlyInRepeatingCopies",true,"101,102,105,106,107,52,53,8,111","sirc"],Name:["name",true,"101,102,105,106,107,52,53,4,8,111","nm"],IgnoreInExport:["IgnoreInExport",true,"8","cone"],DropShadowDepth:["dropShadowDepth",true,"101,102,105,106,107,53,8,111,52","dsw","3"],HasRoundedCorners:["hasRoundedCorners",true,"101,8","rc"],RepeatPanelSpacing:["RepeatPanelSpacing",true,"8","povfs"],Radius:["radius",true,"101,8","rd"],TooltipText:["title",true,"101,102,105,106,107,52,53,8,111","title"],TopRightCornerRadius:["topRightCornerRadius",true,"101,8","trcr"],BottomLeftCornerRadius:["bottomLeftCornerRadius",true,"101,8","blcr"],TopLeftCornerRadius:["topLeftCornerRadius",true,"101,8","tlcr"],DropShadowEffect:["dropShadowEffect",true,"101,102,105,106,107,53,8,111,52","dse","3"],SplitPanelAcrossPages:["SplitPanelAcrossPages",true,"8","spcp"]},ATabletVisualization:["Visualization","ATabletVisualization",true,"52"],FormattingSize:{MaxWidth:["maxWidth",false,"4","mw"],TextOverflow:["TextOverflow",false,"106,8","tovf"],AutoResizeInDesign:["autoResizeInDesign",true,"106","ard"],CanShrinkHorizontal:["canShrinkHorizontal",true,"4","csh"],CanShrink:["canShrink",true,"4","cs"],CanGrowHorizontal:["canGrowHorizontal",true,"4","cgh"],OldHeight:["oldHeight",false,"52","oldht","3"],Height:["height",false,"101,102,105,106,107,52,53,4,8,111,4","ht","3"],LockAspectRatio:["lockAspectRatio",true,"102,106"],LengthMode:["lengthMode",true,"105"],HeightMode:["heightMode",false,"101,102,105,106,107,52,53,111,8","hm"],MaxHeight:["maxHeight",false,"4","mh"],Length:["length",true,"105","cs"],Width:["width",false,"101,102,105,106,107,52,53,8,111,4","wd","3"],OldWidth:["oldWidth",false,"52","oldwd","3"],WidthMode:["widthMode",false,"101,102,105,106,107,52,53,8,111","wm"],CanGrow:["canGrow",true,"4","cg"]},lineStyle:["FormattingLine","LineStyle",false,"101,105"],getThousandsSeparator:function(B){try{return mstrFormatObject.thousandsSeparators[B];}catch(A){microstrategy.errors.log(A);return",";}},selectionStyle:["FormattingPatterns","SelectorSelectionFillStyle",true,"52,111"],FormattingGroup:{UseOneSheetPerPage:["UseOneSheetPerPage",true,"all"]},verticalAlign:["FormattingAlignment","Vertical",false,"52,106,107,111,t,de"],UsePageWidthAsLayoutWidth:["FormattingPage","UsePageWidthAsLayoutWidth",true,"all"],RWLevelMCEJoin:["VLDB Select","MCE Join To Get Data Combination",true,"all"],EnableSwipingToSwitchLayout:["Mobile","EnableSwipingToSwitchLayout",true,"all"],CtlAutoSubmit:["FormattingLayout","CtlAutoSubmit",true,"8"],fontFamily:["FormattingFont","Name",true,"52,106,107,111,8,t,de,df"],DisplayPageByBar:["FormattingLayout","DisplayPageByBar",true,"all"],PreLoadAllPanels:["RWDocumentProperties","PreLoadAllPanels",true,"all"],WatermarkFontBold:["WatermarkProperties","FontBold",true,"all"],layoutBarPosition:["RWDocumentProperties","layoutBarPosition",true,"all"],gridIfMaxRows:["FormattingIncrementalFetch","MaxRows",true,"52"],selectionColor:["FormattingPatterns","SelectorSelectionColor",false,"52,111"],Title:["TableOfContents","Title",true,"all"],paddingRight:["FormattingPadding","RightPadding",false,"52,106,t,de"],DropZonesWidth:["FormattingAnalysis","DropZonesWidth",true,"8"],FilterMode:["FormattingAnalysis","FilterMode",true,"8"],dropShadowDepth:["FormattingAppearance","DropShadowDepth",true,"101,102,105,106,107,53,8,111,52"],gridIfRowMode:["FormattingIncrementalFetch","RowIFMode",true,"52"],APPLIES_TO:3,borderBottomStyle:["FormattingBorder","BottomStyle",false,"102,106,107,52,53,111,8,t,de"],TextOverflow:["FormattingSize","TextOverflow",false,"106,8"],htmlType:["FormattingHTML","HTMLType",true,"107"],verticalAlign2:["FormattingAlignment","Vertical2",false,"52"],GraphQualityDPI:["FormattingPage","GraphQualityDPI",true,"all"],MinSelectionCount:["FormattingSelector","MinSelectionCount",true,"111"],FormattingPatterns:{SelectorSelectionColor:["selectionColor",false,"52,111","ssc"],GradientColor:["gradientColor",false,"101,106,107,52,53,4,8,9,111,208"],GradientXOffset:["gradientXOffset",true,"101,106,107,52,53,4,8,9,111,208"],FillColor:["backgroundColor",false,"101,106,107,52,53,4,8,9,111,208,t,de"],HighlightColor:["BackgroundHighlightColor",false,"8,106","bhlc"],SelectorSelectionFillStyle:["selectionStyle",true,"52,111","sstyle"],GradientYOffset:["gradientYOffset",true,"101,106,107,52,53,4,8,9,111,208"],GradientAngle:["gradientAngle",true,"101,106,107,52,53,4,8,9,111,208"],FillStyle:["backgroundStyle",false,"101,106,107,52,53,4,8,9,111,208","bgstyle","3"],FillEffect:["FillEffect",true,"106","fe"]},canShrink:["FormattingSize","CanShrink",true,"4"],gridIfEnabled:["FormattingIncrementalFetch","EnableIFOnGrid",true,"52"],WatermarkFontUnderline:["WatermarkProperties","FontUnderline",true,"all"],bottomLeftCornerRadius:["FormattingAppearance","BottomLeftCornerRadius",true,"101,8"],gridPosition:["FormattingCrosstab","GridPosition",true,"52"],EnableBookStylePagebyNavigation:["Mobile","EnableBookStylePagebyNavigation",true,"all"],ShowAsCollapsiblePanel:["FormattingView","ShowAsCollapsiblePanel",true,"8"],VisProps:["Visualization","VisProps",true,"52"],NegativeNumbers:["FormattingNumber","NegativeNumbers",true,"100,106,52,t,de"],TOCTitleFontName:["TableOfContents","TitleFontName",true,"all"],quickSwitch:["FormattingCrosstab","Prefetch",true,"52"],ViewMode:["Visualization","ViewMode",true,"52"],width:["FormattingSize","Width",false,"101,102,105,106,107,52,53,8,111,4"],showInHTMLViewMode:["FormattingSection","ShowInHTMLViewMode",true,"4"],MarginRight:["FormattingPage","MarginRight",true,"all"],TARGET_VALUE_ATTR:2,USE_VALUE:2,url:["FormattingHTML","URL",true,"107"],FitPDFContentHeight:["FormattingLayout","FitPDFContentHeight",true,"all"],ExcelGraphFormat:["RWDocumentProperties","ExcelGraphFormat",true,"all"],WatermarkProperties:{FontColor:["WatermarkFontColor",true,"all"],FontName:["WatermarkFontName",true,"all"],AutoFontSize:["AutoFontSize",true,"all"],ImageScale:["ImageScale",true,"all"],FontScript:["WatermarkFontScript",true,"all"],FontBold:["WatermarkFontBold",true,"all"],FontSize:["WatermarkFontSize",true,"all"],TextOrientation:["TextOrientation",true,"all"],ImageSource:["ImageSource",true,"all"],FontItalic:["WatermarkFontItalic",true,"all"],Text:["Text",true,"all"],WatermarkType:["WatermarkType",true,"all"],FontStrikeout:["WatermarkFontStrikeout",true,"all"],FontUnderline:["WatermarkFontUnderline",true,"all"],TextWashout:["TextWashout",true,"all"]},b3dstyle:["FormattingBorder","Border3DStyle",true,"102,106,107,52,53,111,112,101,8,t,de"],TabCloseToDismissInfoWindow:["FormattingView","TabCloseToDismissInfoWindow",true,"8"],PrintFooterOn:["FormattingPage","PrintFooterOn",true,"all"],ScalePercentage:["FormattingPage","ScalePercentage",true,"all"],Enabled:["TableOfContents","Enabled",true,"all"],thousandsSeparators:{"2055":"'","2064":"'","2060":".","2052":",","3082":".","1046":".","1028":",","1036":" ","1045":" ","1049":" ","4108":"'","1033":",","1030":".","1031":".","1040":".","1041":",","1042":",","1043":".","1053":" ","2057":","},ShowHiddenObjects:["RWDocumentProperties","ShowHiddenObjects",true,"all"],canGrow:["FormattingSize","CanGrow",true,"4"],RemoveNullGroups:["AnalyticalEngineProperties","RemoveNullGroups",true,"all"],RWDocumentProperties:{ShowHiddenObjects:["ShowHiddenObjects",true,"all"],layoutBarStyle:["layoutBarStyle",true,"all"],EmbeddedFonts:["EmbeddedFonts",true,"all"],ZoomFactor:["zoom",false,"all"],SelectorBehavior:["SelectorBehavior",true,"all"],ShowFloatingToolbars:["ShowFloatingToolbars",true,"all"],ApplyGBToAllLayouts:["ApplyGBToAllLayouts",true,"all"],ShowingBarsTemporarily:["ShowingBarsTemporarily",true,"all"],ExcelExportDocumentURL:["ExcelExportDocumentURL",true,"all"],ExecutionFullScreenMode:["ExecutionFullScreenMode",true,"all"],CtlAutoSubmit:["CtlAutoSubmit",true,"all"],ShowTabsForSingleLayout:["ShowTabsForSingleLayout",true,"all"],ZoomType:["ZoomType",true,"all"],PromptUserForPagebyExport:["PromptUserForPagebyExport",true,"all"],PreLoadAllPanels:["PreLoadAllPanels",true,"all"],ExcelEmbedImages:["ExcelEmbedImages",true,"all"],PreserveTranslations:["PreserveTranslations",true,"all"],OfflineOnCube:["OfflineOnCube",true,"all"],layoutBarPosition:["layoutBarPosition",true,"all"],DocumentVersion:["DocumentVersion",true,"all"],PDFExportDocumentURL:["PDFExportDocumentURL",true,"all"],CalculateDocWidth:["CalculateDocWidth",true,"all"],ExcelGraphFormat:["ExcelGraphFormat",true,"all"],enableGraphTooltips:["enableGraphTooltips",true,"all"],SmartClientDoc:["SmartClientDoc",true,"all"],ViewModeInteractivityLevel:["ViewModeInteractivityLevel",true,"all"],IsNavigationDocument:["IsNavigationDocument",true,"all"],DefaultPageByExportMode:["DefaultPageByExportMode",true,"all"],ExportRange:["ExportRange",true,"all"]},TOCFontBold:["TableOfContents","FontBold",true,"all"],TextDirection:["FormattingAlignment","TextDirection",true,"52,106,107,t,de"],WatermarkFontName:["WatermarkProperties","FontName",true,"all"],getPropertyName:function(A){return mstrFormatObject[A][mstrFormatObject.PROP_NAME];},windowTitle:["FormattingView","Title",true,"52,8,9,111"],Duration:["FormattingTransitions","Duration",true,"8,52"],top:["FormattingPosition","Top",false,"101,102,105,106,107,52,53,8,111"],EnableCopyForText:["Mobile","EnableCopyForText",true,"all"],WidgetProps:["FormattingWidget","WidgetProps",true,"52,111"],HTML_PROP_NAME:0,TOCFontSize:["TableOfContents","FontSize",true,"all"],Category:["FormattingNumber","Category",true,"100,106,52,t,de"],ShowSummary:["FormattingSelector","ShowSummary",true,"111"],SubmitMessage:["FormattingSelector","SubmitMessage",true,"111"],TOCFontStrikeout:["TableOfContents","FontStrikeout",true,"all"],InfoWindowMode:["FormattingView","InfoWindowMode",true,"8"],showElementCount:["FormattingSelector","ShowElementCount",true,"111"],FileName:["Visualization","FileName",true,"52"],ScalePagesWide:["FormattingPage","ScalePagesWide",true,"all"],getPxFromPt:function(A){return parseFloat(A)*(microstrategy.DPI_CONVERSION/72);},UseAsInfoWindow:["FormattingLayout","UseAsInfoWindow",true,"all"],WatermarkFontColor:["WatermarkProperties","FontColor",true,"all"],oldHeight:["FormattingSize","OldHeight",false,"52"],DisplayRePromptIcon:["FormattingLayout","DisplayRePromptIcon",true,"all"],WatermarkFontScript:["WatermarkProperties","FontScript",true,"all"],gradientColor:["FormattingPatterns","GradientColor",false,"101,106,107,52,53,4,8,9,111,208"],mouseOverAction:["FormattingSelector","MouseOverAction",true,"111"],canShrinkHorizontal:["FormattingSize","CanShrinkHorizontal",true,"4"],htmlText:["FormattingHTML","HTMLText",true,"107"],ClassName:["FormattingWidget","ClassName",true,"52,111"],gradientAngle:["FormattingPatterns","GradientAngle",true,"101,106,107,52,53,4,8,9,111,208"],IndependentNodeSelector:["FormattingSelector","IndependentNodeSelector",true,"52"],HTML_USE_VALUE:1,IsApp:["FormattingWidget","IsApp",true,"52,111"],DhtmlRenderer:["FormattingWidget","DhtmlRenderer",true,"52"],encodeValue:function(A,H){try{if((A in mstrFormatObject)&&mstrFormatObject[A][mstrFormatObject.USE_VALUE]){return H;}var B=function(J,K){if(K!=undefined&&(J==null||J.length==0)){return parseInt(K,10);}else{if(J=="auto"||J=="100%"){return J;}else{return microstrategy.number.toLocaleString(parseFloat(I)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100));}}};var F=function(J,K){if(K!=undefined&&(J==null||J.length==0)){J=K;}return parseFloat(microstrategy.number.toString(J,false))/(microstrategy.ZOOM_FACTOR/100);};var C=function(J,K){if(K!=undefined&&(J==null||J.length==0||J=="undefined")){J=K;}if(J=="transparent"){return -1;}else{if(J==-2){return -2;}else{return parseInt(J.substring(5)+J.substring(3,5)+J.substring(1,3),16);}}};var D=function(J,K){return(J!=null&&J.indexOf(K)>-1)?"-1":"0";};var G=function(K){K=K||"";if(K!=""){var J=K.indexOf("pt");K=((K.substring(0,J)/(microstrategy.ZOOM_FACTOR/100))+"").substring(0,Math.min(J,3))+K.substring(J);}switch(K){case"0pt solid":return"0";case"0pt none":return"8";case"1pt dashed":return"3";case"1pt dotted":return"4";case"1.5pt solid":return"5";case"2.5pt double":return"6";case"1pt solid":return"1";case"0.5pt solid":return"7";default:return"-1";}};H=String(H);var I=H.toLowerCase();switch(A){case"top":return B(I);case"left":return B(I);case"width":return B(I);case"height":return B(I);case"oldWidth":case"oldHeight":case"heightMode":return I;case"widthMode":return I;case"maxHeight":return B(I);case"maxWidth":return B(I);case"TextOverflow":switch(I){case"auto":return"-1";case"hidden":return"0";}case"visibility":switch(I){case"visible":return"-1";case"hidden":return"0";}case"textAlign":switch(I){case"right":return"1";case"center":return"2";case"justify":return"6";default:return"0";}case"textAlign2":switch(I){case"right":return"4";case"center":return"3";case"justify":return"6";default:return"2";}case"verticalAlign":switch(I){case"middle":return"1";case"bottom":return"2";default:return"0";}case"verticalAlign2":switch(I){case"middle":return"2";case"bottom":return"3";default:return"1";}case"whiteSpace":switch(I){case"nowrap":return"0";default:return"-1";}case"fontSize":return F(I);case"color":return C(I,"#000000");case"fontWeight":switch(I){case"bold":return"-1";default:return"0";}case"fontStyle":switch(I){case"italic":return"-1";default:return"0";}case"textDecoration":return D(I,"underline");case"textDecoration2":return D(I,"line-through");case"FontHighlightColor":return C(I,"#000000");case"backgroundColor":if(I&&I.indexOf(",")>0){I="#"+I.split(",")[0];}return C(I,"#FFFFFF");case"backgroundStyle":if(I&&I.indexOf(",")>0){return"2";}if(I=="gradient"){return"2";}if(I=="transparent"){return"1";}else{return"0";}case"gradientColor":if(I&&I.indexOf(",")>0){I="#"+I.split(",")[1];}return C(I,"#000000");case"selectionColor":return C(I,"#000000");case"BackgroundHighlightColor":return C(I,"#000000");case"borderTopColor2":return C(I,"#000000");case"borderRightColor2":return C(I,"#000000");case"borderBottomColor2":return C(I,"#000000");case"borderLeftColor2":return C(I,"#000000");case"borderTopColor":return C(I,"#000000");case"borderRightColor":return C(I,"#000000");case"borderBottomColor":return C(I,"#000000");case"borderLeftColor":return C(I,"#000000");case"borderTopStyle":return G(I);case"borderRightStyle":return G(I);case"borderBottomStyle":return G(I);case"borderLeftStyle":return G(I);case"paddingLeft":return F(I);case"paddingRight":return F(I);case"paddingTop":return F(I);case"paddingBottom":return F(I);case"lineHeight":return(I==null||I=="0"||I=="normal"||I=="")?"":parseFloat(I);case"lineStyle":switch(I){case"dashed":return"2";case"dotted":return"3";case"double":return"4";case"none":return"0";default:return"1";}case"lineColor":return C(I,"#000000");case"lineWeight":return F(I);case"orientation":switch(I){case"border-left":return"1";default:return"0";}case"PaperType":switch(I){case"2a,46.81,66.18":return"1";case"a0,33.11,46.81":return"2";case"a1,23.39,33.11":return"3";case"a2,16.54,23.39":return"4";case"a3,11.69,16.54":return"5";case"a4,8.27,11.69":return"6";case"a5,5.83,8.27":return"7";case"a6,4.13,5.83":return"8";case"a7,2.91,4.13":return"9";case"a8,2.09,2.91":return"10";case"c,17,22":return"11";case"d,22,34":return"12";case"e,34,44":return"13";case"executive,7.25,10.5":return"14";case"f,28,40":return"15";case"ledger,11,17":return"16";case"legal,8.5,14":return"17";case"letter,8.5,11":return"18";case"super a3/b,13,19":return"19";case"folio,8.5,13":return"20";default:return"0";}case"zoom":return microstrategy.number.toLocaleString(parseFloat(I));case"TabColor":return C(I,"#ffffff");case"colWidth":return Math.round(parseInt(I)/(microstrategy.DPI_CONVERSION*microstrategy.ZOOM_FACTOR/100)*microstrategy.BASE_DPI);}}catch(E){microstrategy.errors.log(E);return H;}},TableOfContents:{TitleFontItalic:["TOCTitleFontItalic",true,"all"],Enabled:["Enabled",true,"all"],FontColor:["TOCFontColor",true,"all"],TitleAlignment:["TOCTitleAlignment",true,"all"],TitleFontBold:["TOCTitleFontBold",true,"all"],BorderWeight:["TOCBorderWeight",true,"all"],TitleFontStrikeout:["TOCTitleFontStrikeout",true,"all"],UserSeparateStyleForTitle:["TOCTitleEnableInherit",true,"all"],FontSize:["TOCFontSize",true,"all"],RightIndent:["TOCRightIndent",true,"all"],FontItalic:["TOCFontItalic",true,"all"],TitleFontUnderline:["TOCTitleFontUnderline",true,"all"],ShowTabLeader:["ShowTabLeader",true,"all"],FillColor:["TOCFillColor",true,"all"],BeforeLayout:["BeforeLayout",true,"all"],LeftIndent:["TOCLeftIndent",true,"all"],TitleFontSize:["TOCTitleFontSize",true,"all"],FontName:["TOCFontName",true,"all"],TitleFontColor:["TOCTitleFontColor",true,"all"],BorderStyle:["TOCBorderStyle",true,"all"],TitleFillStyle:["TOCTitleFillStyle",true,"all"],FontBold:["TOCFontBold",true,"all"],FillStyle:["TOCFillStyle",true,"all"],Title:["Title",true,"all"],IncludePageHeaderFooter:["IncludePageHeaderFooter",true,"all"],BorderColor:["TOCBorderColor",true,"all"],TitleFillColor:["TOCTitleFillColor",true,"all"],FontUnderline:["TOCFontUnderline",true,"all"],FontStrikeout:["TOCFontStrikeout",true,"all"],TitleFontName:["TOCTitleFontName",true,"all"]},UseOneSheetPerGroupElement:["FormattingPage","UseOneSheetPerGroupElement",true,"all"],DecimalPlaces:["FormattingNumber","DecimalPlaces",true,"100,106,52,t,de"],radius:["FormattingAppearance","Radius",true,"101,8"],locked:["FormattingPosition","Locked",true,"101,102,105,106,107,52,53,8,111"],SplitPanelAcrossPages:["FormattingAppearance","SplitPanelAcrossPages",true,"8"],ctlOrientation:["FormattingSelector","Orientation",true,"111"],link:["FormattingNavigation","Hyperlink",true,"102,106"],FormattingNumber:{ThousandSeparator:["ThousandSeparator",true,"100,106,52,t,de","nth","2"],Category:["Category",true,"100,106,52,t,de","nct","2"],Format:["Format",true,"100,106,52,t,de","nfs","2"],DecimalPlaces:["DecimalPlaces",true,"100,106,52,t,de","ndp","2"],CurrencyPosition:["CurrencyPosition",true,"100,106,52,t,de","ncp","2"],CurrencySymbol:["CurrencySymbol",true,"100,106,52,t,de","ncs","2"],NegativeNumbers:["NegativeNumbers",true,"100,106,52,t,de","nnn","2"]},UseOneSheetPerPage:["FormattingGroup","UseOneSheetPerPage",true,"all"],repeatHorizontally:["FormattingSection","RepeatHorizontally",true,"4"],title:["FormattingAppearance","TooltipText",true,"101,102,105,106,107,52,53,8,111"],UseSegments:["FormattingLayout","UseSegments",true,"all"],ScalePageHeaderFooter:["FormattingPage","ScalePageHeaderFooter",true,"all"],length:["FormattingSize","Length",true,"105"],EnableZoom:["Mobile","EnableZoom",true,"all"],DatasetsSettings:["FormattingAnalysis","DatasetsSettings",true,"4"],Transparency:["FormattingAppearance","Transparency",true,"8"],TOCRightIndent:["TableOfContents","RightIndent",true,"all"],FormattingPosition:{Top:["top",false,"101,102,105,106,107,52,53,8,111"],Locked:["locked",true,"101,102,105,106,107,52,53,8,111","lck"],Left:["left",false,"101,102,105,106,107,52,53,8,111"]},ExcelEmbedImages:["RWDocumentProperties","ExcelEmbedImages",true,"all"],PreserveTranslations:["RWDocumentProperties","PreserveTranslations",true,"all"],gridShowCH:["FormattingCrosstab","ShowColHeaders",true,"52"],UseAsTableControl:["FormattingLayout","UseAsTableControl",true,"8"],DocumentVersion:["RWDocumentProperties","DocumentVersion",true,"all"],TOCBorderWeight:["TableOfContents","BorderWeight",true,"all"],SearchOnServer:["FormattingSelector","SearchOnServer",true,"111"],DefaultViewMode:["FormattingPage","DefaultViewMode",true,"all"],PageWidth:["FormattingPage","PageWidth",true,"all"],TabMPHF:["FormattingLayout","UseMasterPageHeaderFooter",true,"all"],DatasetObjectsWidth:["FormattingAnalysis","DatasetObjectsWidth",true,"4"],borderTopStyle:["FormattingBorder","TopStyle",false,"102,106,107,52,53,111,8,t,de"],FormattingTransactions:{"":["ShowChangeIndication",true,"51,52"],SetBadgeToValueOnField:["SetBadgeToValueOnField",true,"106"]},EmbeddedFonts:["RWDocumentProperties","EmbeddedFonts",true,"all"],Style:["FormattingSelector","Style",true,"111"],b3dweight:["FormattingBorder","Border3DWeight",true,"102,106,107,52,53,111,112,101,8,t,de"],ApplyGBToAllLayouts:["RWDocumentProperties","ApplyGBToAllLayouts",true,"all"],ItemWidthMode:["FormattingSelector","ItemWidthMode",true,"111"],ShowingBarsTemporarily:["RWDocumentProperties","ShowingBarsTemporarily",true,"all"],NavBarLayout:["FormattingLayout","NavBarLayout",true,"8"],TOCFillColor:["TableOfContents","FillColor",true,"all"],VisualizationsEnabled:["Visualization","VisualizationsEnabled",true,"52"],repeatSection:["FormattingSection","RepeatSection",true,"4"],Mobile:{EnableCopyForGridCell:["EnableCopyForGridCell",true,"all"],EnableCopyForText:["EnableCopyForText",true,"all"],View:["MobileDataView",true,"all"],EnableSwipingToSwitchLayout:["EnableSwipingToSwitchLayout",true,"all"],DocumentThemeColor:["DocumentThemeColor",true,"all"],EnableExport:["EnableExport",true,"all"],RefreshFrequency:["RefreshFrequency",true,"all"],EnableZoom:["EnableZoom",true,"all"],EnableBookStylePagebyNavigation:["EnableBookStylePagebyNavigation",true,"all"]},TabColor:["FormattingLayout","TabColor",false,"all"],FormattingAnalysis:{FilterMode:["FilterMode",true,"8"],DropZonesWidth:["DropZonesWidth",true,"8"],AnalysisSection:["AnalysisSection",true,"8,52"],FilterDisplay:["FilterDisplay",true,"8"],DatasetObjectsWidth:["DatasetObjectsWidth",true,"4"],Collapsed:["Collapsed",true,"111"],DropZonesVisible:["DropZonesVisible",true,"8"],DatasetsSettings:["DatasetsSettings",true,"4"],DatasetObjectsVisible:["DatasetObjectsVisible",true,"4"]},IncludeBookmarks:["FormattingPage","IncludeBookmarks",true,"all"],FillEffect:["FormattingPatterns","FillEffect",true,"106"],IncludeMDProperties:["Visualization","IncludeMDProperties",true,"52"],FilterDisplay:["FormattingAnalysis","FilterDisplay",true,"8"],textDecoration2:["FormattingFont","Strikeout",false,"52,106,107,111,8,208,t,de,df"],dropShadowEffect:["FormattingAppearance","DropShadowEffect",true,"101,102,105,106,107,53,8,111,52"],ImageSource:["WatermarkProperties","ImageSource",true,"all"],IncludePageHeaderFooter:["TableOfContents","IncludePageHeaderFooter",true,"all"],TOCTitleFontSize:["TableOfContents","TitleFontSize",true,"all"],TOCTitleEnableInherit:["TableOfContents","UserSeparateStyleForTitle",true,"all"],fitExcelRowHeight:["FormattingSection","FitExcelRowHeight",true,"4"],ShowWidgetTitleBar:["FormattingView","ShowWidgetTitleBar",true,"52"],FormattingTransitions:{Enable:["EnableTransition",true,"8,52"],Duration:["Duration",true,"8,52","tdr","2"],Transition:["Transition",true,"8,52","ttr","2"]},ThousandSeparator:["FormattingNumber","ThousandSeparator",true,"100,106,52,t,de"],FormattingBorder:{TopColor:["borderTopColor",false,"102,106,107,52,53,111,8,t,de","btc","3"],BottomStyle:["borderBottomStyle",false,"102,106,107,52,53,111,8,t,de","bbs","3"],Border3DWeight:["b3dweight",true,"102,106,107,52,53,111,112,101,8,t,de","b3dweight","3"],TopStyle:["borderTopStyle",false,"102,106,107,52,53,111,8,t,de","bts","3"],LeftColor:["borderLeftColor",false,"102,106,107,52,53,111,8,t,de","blc","3"],BottomColor:["borderBottomColor",false,"102,106,107,52,53,111,8,t,de","bbc","3"],Border3DRightColor:["borderRightColor2",false,"102,106,107,52,53,111,101,8,t,de","b3drc","3"],RightStyle:["borderRightStyle",false,"102,106,107,52,53,111,8,t,de","brs","3"],Border3DLeftColor:["borderLeftColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dlc","3"],Border3DBottomColor:["borderBottomColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dbc","3"],RightColor:["borderRightColor",false,"102,106,107,52,53,111,8,t,de","brc","3"],Border3DTopColor:["borderTopColor2",false,"102,106,107,52,53,111,101,8,t,de","b3dtc","3"],Border3DStyle:["b3dstyle",true,"102,106,107,52,53,111,112,101,8,t,de","b3dstyle","3"],LeftStyle:["borderLeftStyle",false,"102,106,107,52,53,111,8,t,de","bls","3"]},TOCFontColor:["TableOfContents","FontColor",true,"all"],StyleForSwitchingPanel:["FormattingView","StyleForSwitchingPanel",true,"8"],TOCTitleFillStyle:["TableOfContents","TitleFillStyle",true,"all"],newWin:["FormattingNavigation","OpenInNewWindow",true,"102,106"],TOCFillStyle:["TableOfContents","FillStyle",true,"all"],SingleSourceGrid:["AnalyticalEngineProperties","SingleSourceGrid",true,"all"],getListSeparator:function(B){try{return mstrFormatObject.listSeparators[B];}catch(A){microstrategy.errors.log(A);return",";}},gradientXOffset:["FormattingPatterns","GradientXOffset",true,"101,106,107,52,53,4,8,9,111,208"],isTargetStyleOrAttr:function(E){try{var B=mstrFormatObject.TARGET_VALUE_STYLE;if(!mstrFormatObject[E]){return B;}var D=mstrFormatObject.getPropertySetName(E);var A=mstrFormatObject.getPropertyName(E);if(mstrFormatObject.getAttrNameFromStyle(E)==null||mstrFormatObject.getAttrNameFromStyle(E).length==0){return B;}B=mstrFormatObject.TARGET_VALUE_ATTR;if(mstrFormatObject[D][A][mstrFormatObject.TARGET]&&(parseInt(mstrFormatObject[D][A][mstrFormatObject.TARGET])&(parseInt(mstrFormatObject.TARGET_VALUE_STYLE)+parseInt(mstrFormatObject.TARGET_VALUE_ATTR)))>0){B+=mstrFormatObject.TARGET_VALUE_STYLE;}return B;}catch(C){microstrategy.errors.log(err);}return null;},TextWashout:["WatermarkProperties","TextWashout",true,"all"],widthMode:["FormattingSize","WidthMode",false,"101,102,105,106,107,52,53,8,111"],borderTopColor:["FormattingBorder","TopColor",false,"102,106,107,52,53,111,8,t,de"],FormattingLine:{LineStyle:["lineStyle",false,"101,105","ls","3"],LineWeight:["lineWeight",false,"101,105","lw","3"],LineOrientation:["orientation",false,"105","or"],LineColor:["lineColor",false,"101,105","lc","3"]},TextOrientation:["WatermarkProperties","TextOrientation",true,"all"],PrintHeaderOn:["FormattingPage","PrintHeaderOn",true,"all"],KeepControlTargetsConsistent:["AnalyticalEngineProperties","KeepControlTargetsConsistent",true,"all"],UseOneSheetPerLayout:["FormattingPage","UseOneSheetPerLayout",true,"all"],Text:["WatermarkProperties","Text",true,"all"],InitialSlidingInWidth:["FormattingView","InitialSlidingInWidth",true,"8"],WatermarkType:["WatermarkProperties","WatermarkType",true,"all"],TOCFontItalic:["TableOfContents","FontItalic",true,"all"],hasRoundedCorners:["FormattingAppearance","HasRoundedCorners",true,"101,8"],HighlightURL:["FormattingPicture","HighlightURL",true,"106"]};mstrNumber.UNIT_CM="1";mstrNumber.UNIT_IN="2";mstrNumber.UNIT_MM="3";mstrNumber.UNIT_PT="4";mstrNumber.UNIT_PC="5";mstrNumber.UNIT_PX="6";mstrNumber.UNIT_EM="7";mstrNumber.prototype=new Object;mstrNumber.prototype.locale="1033";mstrNumber.prototype.units=mstrNumber.UNIT_IN;mstrNumber.prototype.unitsLabel="";mstrNumber.prototype.thousandSeparatorRegex=null;mstrNumber.prototype.toLocaleString=function(B){try{return(B+"").replace(".",mstr.Settings.Locale.DECIMALSEP);}catch(A){microstrategy.errors.log(A);return B;}};mstrNumber.prototype.toString=function(D,A){try{if(A==true){var C=this.getThousandSepRegex();if(C){D=String(D).replace(C,"");}}D=String(D).replace(mstr.Settings.Locale.DECIMALSEP,".");return D;}catch(B){microstrategy.errors.log(B);return D;}};mstrNumber.prototype.toUserUnits=function(C,B){try{return this.toLocalUnits(this.units,C,B);}catch(A){microstrategy.errors.log(A);}};mstrNumber.prototype.toLocalUnits=function(D,E,C){try{var A;switch(D){case mstrNumber.UNIT_CM:A=(parseFloat(this.toString(E))*2.54).toFixed(4)+"";break;case mstrNumber.UNIT_MM:A=(parseFloat(this.toString(E))*25.4).toFixed(4)+"";break;case mstrNumber.UNIT_PT:A=(parseFloat(this.toString(E))*72).toFixed(4)+"";break;case mstrNumber.UNIT_PC:A=(parseFloat(this.toString(E))*6).toFixed(4)+"";break;case mstrNumber.UNIT_PX:A=(parseFloat(this.toString(E))*microstrategy.DPI_CONVERSION)+"";break;case mstrNumber.UNIT_EM:A=(parseFloat(this.toString(E))*10.6666).toFixed(4)+"";break;default:A=parseFloat(this.toString(E)).toFixed(4)+"";}if(C){return A;}else{return this.toLocaleString(A);}}catch(B){microstrategy.errors.log(B);}};mstrNumber.prototype.toUSUnits=function(C,B){try{return this.convertToUSUnits(this.units,C,B);}catch(A){microstrategy.errors.log(A);}};mstrNumber.prototype.convertToUSUnits=function(D,E,C){try{var A=E;switch(D){case mstrNumber.UNIT_CM:A=parseFloat(this.toString(E))/2.54+"";break;case mstrNumber.UNIT_MM:A=parseFloat(this.toString(E))/25.4+"";break;case mstrNumber.UNIT_PT:A=parseFloat(this.toString(E))/72+"";break;case mstrNumber.UNIT_PC:A=parseFloat(this.toString(E))/6+"";break;case mstrNumber.UNIT_PX:A=parseFloat(this.toString(E))/microstrategy.DPI_CONVERSION+"";break;case mstrNumber.UNIT_EM:A=(parseFloat(this.toString(E))/10.6666)+"";break;}if(C){return A;}else{return this.toLocaleString(A);}}catch(B){microstrategy.errors.log(B);}};mstrNumber.prototype.convertUnit=function(B,C,A){return this.toLocalUnits(C,this.convertToUSUnits(B,A,true),true);};mstrNumber.prototype.getThousandSepRegex=function(){if(this.thousandSeparatorRegex==null){var A=mstr.Settings.Locale.THOUSANDSEP;A=A.replace(/(\W){1}/g,"\\$1");this.thousandSeparatorRegex=new RegExp(A,"g");}return this.thousandSeparatorRegex;};function mstrNumber(){return this;}microstrategy.number=new mstrNumber();CalendarScript=true;var Month;var Year;var textBoxID;var bIsSeen=false;var sOperator=null;var sDateFormat="DD/MM/YYYY";var imgID;var calendarOldMouseDownHandler=null;function isLeapYear(A){if(((A%4)==0)&&((A%100)!=0)||((A%400)==0)){return(true);}else{return(false);}}function getDaysOfMonth(B,A){var C;if(B==1||B==3||B==5||B==7||B==8||B==10||B==12){C=31;}else{if(B==4||B==6||B==9||B==11){C=30;}else{if(B==2){if(isLeapYear(A)){C=29;}else{C=28;}}}}return(C);}function showCalendar(F,I,A,E,G,C,D,J,H){var B=getFilterBone();if(B&&B.shouldOpenDynamicDateEditor&&B.shouldOpenDynamicDateEditor()){openDynamicDateEditor(F,I,A,E,G,C,D,J,H);return ;}if(bIsSeen){hideCalendar();if(imgID!=C){makeCalendar(F,I,A,E,G,D,J,H);bIsSeen=true;imgID=C;calendarOldMouseDownHandler=document.onmousedown;document.onmousedown=new Function("e","var rtVal = calendarOldMouseDownHandler && calendarOldMouseDownHandler(e); calendarOnMouseDown(e); return rtVal;");}}else{makeCalendar(F,I,A,E,G,D,J,H);bIsSeen=true;imgID=C;calendarOldMouseDownHandler=document.onmousedown;document.onmousedown=new Function("e","var rtVal = calendarOldMouseDownHandler && calendarOldMouseDownHandler(e); calendarOnMouseDown(e); return rtVal;");}}function getFilterBone(){return(!microstrategy.bone("promptTabMgr_PromptDialogStyle")&&(microstrategy.bone("rfe_pane")||microstrategy.bone("fexb_pane")));}function openDynamicDateEditor(I,M,C,G,J,E,F,N,L){var B=window.mstrmojo,A="mstrDDE",H=B&&B.all[A],K=getFilterBone().dd||getFilterBone()._dd||{tp:parseInt(getFilterBone().selectedDataType,10)},D=function(){B=mstrmojo;H=B.insert({scriptClass:"mstrmojo.DynamicDateEditor",id:A,ddeData:K,updatePopupConfig:function P(Q,R){this.set("left",Q.l+"px");this.set("top",Q.t+"px");},switchToStaticDatePicker:function O(){getFilterBone().showDynamicDatePicker=false;document.getElementById(C).name=C;showCalendar(I,M,C,G,J,E,F,N,L);this.close();},okCallback:function(Q){var R=document.getElementById(C);if(R.name!==C+"Txt"){R.name=C+"Txt";}var V=document.getElementById("feForm"),U=false,T;if(V){var S=V.getElementsByTagName("input");for(T=0;T<S.length;T++){U=(S[T].name===C);if(U){break;}}if(!U){createHiddenInput(V,C,R.value);}fillTextBoxOnOpt(S[T],Q.str);}fillTextBoxOnOpt(R,Q.dr);getFilterBone()._dd=this.ddeData;getFilterBone().showDynamicDatePicker=true;},onClose:function(Q){this.destroy();}});H.render();H.open(null,{l:G,t:J});};if(H){H.set("ddeData",K);H.open(null,{l:G,t:J});}else{microstrategy.mojoLoader.loadWidget({scriptClass:"DynamicDateEditor",bundle:"mojo-dde.js",callback:D});}}function calendarOnMouseDown(B){if(!bIsSeen){return true;}if(!B){B=window.event;}var A=getEventTarget(B);if(!findTarget(A,"id","CalendarTable")&&!findTarget(A,"id",imgID)&&!findTarget(A,"id","swtchToDDE")){hideCalendar();}}function adjustYear(A){if(sDateFormat.search("YYYY")==-1){if(A<10){A=2000+A;}else{if(A<200){A=1900+A;}}}return A;}function makeCalendar(H,M,C,G,I,E,N,J){N=N||"";J=J||"";if(isNaN(H)||isNaN(M)||(H==0&&M==0)){myDate=new Date();Year=myDate.getFullYear();Month=myDate.getMonth()+1;}else{if(H==0){Month=12;Year=M-1;}else{if(H>=13){Month=1;Year=M+1;}else{Month=H;Year=M;}}}Year=adjustYear(Year);textBoxID=getObj(C);var B=getRestDate(J);var A=getRestDate(N);smonth=asDescriptors[Month];var F;F='<table ID="CalendarTable" NAME="CalendarTable" class="inner" bgcolor="#eeeeee" cellpadding="1" cellspacing="0">';F=F+'<tr><td class="arrow" onClick="makeCalendar('+(Month-1)+","+Year+",'"+C+"',"+G+","+I+","+E+",'"+N+"', '"+J+'\');" ><IMG SRC="../images/arrow_left_cal.gif"></td>';F=F+'<td colspan="5" align="center" class="event">'+smonth+" "+Year+"</td>";F=F+'<td class="arrow" onClick="makeCalendar('+(Month+1)+","+Year+",'"+C+"',"+G+","+I+","+E+",'"+N+"', '"+J+'\');" ><IMG SRC="../images/arrow_right_cal.gif"></td></tr>';F=F+"<tr>";F=F+renderWeekBar(E,asDescriptors,13);F=F+"</tr><tr>";firstOfMonth=new Date(Year,Month-1,(1-E)+1);leave=firstOfMonth.getDay();for(i=0;i<leave;i++){F=F+"<td>&nbsp;</td>";}totalDays=getDaysOfMonth(Month,Year);for(day=1;day<=totalDays;day++){var L=validateMixMaxDate(A,B,Year,Month-1,day);if(L){F=F+'<td class="day" onClick="fillTextBox('+day+",'"+C+'\');" ><span class="norm">&nbsp;'+day+"&nbsp;</span></td>";}else{F=F+'<td class="day" onClick="hideCalendar();" ><span class="grayOut">&nbsp;'+day+"&nbsp;</span></td>";}i++;if(i%7==0){F=F+"</tr><tr>";}}if(i%7!=0){var K=7-i%7;for(day=1;day<=K;day++){F=F+"<td>&nbsp;</td>";}}F=F+"</tr></table>";if(getFilterBone()){F+="<div id='swtchToDDE' style='cursor:pointer;color:#12B;text-decoration:underline;background-color:#eee;border:1px solid #777;margin-top:-1px;padding:3px;'onclick=\"getFilterBone().showDynamicDatePicker=true;hideCalendar();openDynamicDateEditor("+Month+","+Year+",'"+C+"',"+G+","+I+",1,"+E+",'"+N+"', '"+J+"');\" >"+switchToDynamicLink+"</div>";}writeToDiv(F,"Calendar");moveObjTo("Calendar",G,I);var D=getObj("Calendar");if(D){D.style.position="absolute";D.style.zIndex=999;}displayObj("Calendar");showHidePulldowns(false,G,I);document.getElementById("CalendarTable").style.visibility="visible";}function getRestDate(E){var A=null;var C=getObj(E+"_year");var B=getObj(E+"_month");var D=getObj(E+"_day");if(C&&B&&D){A=new Date(C.value,B.value,D.value);}return A;}function validateMixMaxDate(H,A,D,E,C){var F=true;if(H){var G=H.getFullYear();if(G<10){G=2000+G;}else{if(G<100){G=1900+G;}}if((D>G)||((E>(H.getMonth()))&&(D==G))||((C>H.getDate())&&(E==(H.getMonth()))&&(D==G))){F=false;}}if(A){var B=A.getFullYear();if(B<10){B=2000+B;}else{if(B<100){B=1900+B;}}if((D<B)||((E<(A.getMonth()))&&(D==B))||((C<A.getDate())&&(E==(A.getMonth()))&&(D==B))){F=false;}}return F;}function renderWeekBar(D,F,A){var C=A+(D-1);var E="";var B;for(B=1;B<8;B++){if(C>=(A+7)){C=A;}E=E+'<td class="weekday">'+F[C]+"</td>";C++;}return E;}function fillTextBox(A,C){var B=sDateFormat;if(sDateFormat.search("YYYY")==-1){Year=Year%100;if(Year<10){Year="0"+Year;}B=B.replace("YY",Year);}else{B=B.replace("YYYY",Year);}if(sDateFormat.search("DD")==-1){B=B.replace("D",A);}else{if(A>=10){B=B.replace("DD",A);}else{B=B.replace("DD","0"+A);}}if(sDateFormat.search("MMM")>0){B=B.replace("MMM",Month_Names[Month-1]);}else{if(sDateFormat.search("MM")==-1){B=B.replace("M",Month);}else{if(Month>=10){B=B.replace("MM",Month);}else{B=B.replace("MM","0"+Month);}}}textBoxID=getObj(C);fillTextBoxOnOpt(textBoxID,B);if(textBoxID){if(textBoxID.onchange){textBoxID.onchange();}else{if(textBoxID.onkeyup){textBoxID.onkeyup();}}}hideCalendar();}function updateDateFormat(A){if(sDateFormat&&A&&(A.length>0)){sDateFormat=A;}}function fillTextBoxOnOpt(C,B){if(sOperator&&(sOperator.length>0)){var A=sOperator.split(ITEM_SEPARATOR);if(A[0]){sOperator=A[0];}}if(((sOperator==null)&&(C.value.search(";")>0))||(sOperator=="17")||(sOperator=="44")||(sOperator=="22")||(sOperator=="57")){if(C.value.length<1){C.value=B;}else{if((sOperator=="17")||(sOperator=="44")){if(C.value.search(";")<1){C.value=C.value+";"+B;}else{if(C.value.search(";")==(C.value.length-1)){C.value=C.value+B;}else{if(C.value.search("isDyn")>=0){C.value=C.value.substr(0,C.value.search(";")+1)+B;}else{C.value=B+C.value.substr(C.value.search(";"),C.value.length);}}}}else{if(C.value.search(";")==(C.value.length-1)){C.value=C.value+B;}else{C.value=C.value+";"+B;}}}}else{C.value=B;}}function showCalendarButton(A){document.getElementById(A).style.visibility="visible";}function hideCalendar(){var A=document.getElementById("CalendarTable");if(A){A.style.visibility="hidden";}var B=document.getElementById("Calendar");if(B){B.style.visibility="hidden";}showHidePulldowns(true,20,20);bIsSeen=false;if(calendarOldMouseDownHandler){document.onmousedown=calendarOldMouseDownHandler;}}function getMonth(C){var B=getObj(C);var A=B.value;if(A.search(";")!=-1){A=A.substr(0,A.search(";"));}return getDateFromFormat(A,sDateFormat,DATE_MONTH);}function getYear(C){var B=getObj(C);var A=B.value;if(A.search(";")!=-1){A=A.substr(0,A.search(";"));}return getDateFromFormat(A,sDateFormat,DATE_YEAR);}function showOrHideCalendarButton(B,E){var G=null;var F=null;var C=getObj(E);var D=getObj(B);if(C&&D){var A=-1;if(D.options){if(bIsW3C){for(count=0;count<D.options.length;count++){if(D.options[count].selected){A=count;break;}}}else{A=D.selectedIndex;}}else{if(D[0]){for(count=0;count<D.length;count++){if(D[count].checked){A=count;break;}}}}if(A>=0){if(D.options){F=D.options[A].getAttribute("DATATYPE");}else{F=D[A].getAttribute("DATATYPE");}}else{if(D.getAttribute("DATATYPE")){F=D.getAttribute("DATATYPE");}else{if(D.options){if(D.options[0]){F=D.options[0].getAttribute("DATATYPE");}}else{if(D[0]){F=D[0].getAttribute("DATATYPE");}}}}if((parseInt(F)==16)||(parseInt(F)==15)||(parseInt(F)==14)){C.style.visibility="visible";C.style.display="inline";}else{C.style.visibility="hidden";C.style.display="none";}}}function updateOperator(A){var B=getObj(A);if(B){sOperator=B.options[B.selectedIndex].value;}}function showHidePulldowns(A,D,B){var C=getObj("Calendar");if(C!=null){togglePulldowns(C,A);}}function getIntValue(F,D,E,C){for(var A=C;A>=E;A--){var B=F.substring(D,D+A);if(isAllNumeric(B)){return B;}else{if(!isNaN(parseInt(B))){return retVal=parseInt(B)+"";}}}return null;}function isAllNumeric(A){var C=new String(A);var B=/[^0-9]/;return !B.test(C);}function getMonthIntVal(B){for(var A=0;A<Month_Names.length;A++){if(B.toLowerCase()==Month_Names[A].toLowerCase()){return A+1;}}return 0;}var DATE_MONTH=1;var DATE_DAY=2;var DATE_YEAR=3;function getDateFromFormat(B,M,I){B=B+"";M=M+"";var D=0;var E=0;var H="";var C="";var L,K;var A=new Date();var G=A.getYear();var F=A.getMonth()+1;var J=1;if((B!=null)&&(B.length>5)){while(E<M.length){H=M.charAt(E);C="";while((M.charAt(E)==H)&&(E<M.length)){C+=M.charAt(E++);}if((C=="YYYY")||(C=="YY")||(C=="Y")){if(C=="YYYY"){L=4;K=4;}else{if(C=="YY"){L=2;K=2;}else{if(C=="Y"){L=2;K=4;}}}G=getIntValue(B,D,L,K);if(G==null||G.length<L||G.length>K){return 0;}D+=G.length;}else{if((C=="MM")||(C=="M")){F=getIntValue(B,D,C.length,2);if((F==null)||(F<1)||(F>12)){return 0;}D+=F.length;}else{if(C=="MMM"){F=getMonthIntVal(B.substring(D,D+C.length));D+=C.length;}else{if((C=="DD")||(C=="D")){J=getIntValue(B,D,C.length,2);if((J==null)||(J<1)||(J>31)){return 0;}D+=J.length;}else{if(B.substring(D,D+C.length)!=C){return 0;}else{D+=C.length;}}}}}}if(D<B.length){return 0;}}else{return 0;}switch(I){case DATE_YEAR:return G*1;break;case DATE_MONTH:return F*1;break;case DATE_DAY:return J*1;break;}}promptFunctionsScript=true;var bDefault=new Array();var treeToList="";var treePos="";var promptJSAnswerName="";var promptJSListBoxName="";var promptJSDimensionName="";var promptJSMaxPin=-1;var sBeanPath="";var promptHeight="";var searchPrefix="";if(typeof (iframe)!="undefined"){iframe.isPromptedReport=true;}function gotoAnchor(B){var C,D;if((navigator!=null)&&(B>1)){if((navigator.appName!=null)&&(navigator.appVersion!=null)){C=(navigator.appName=="Netscape");D=(navigator.appName.indexOf("Internet Explorer")!=-1);if(C||(D&&parseInt(navigator.appVersion)>=4)){var A=document.getElementById("CP"+B);if(A){var E=document.getElementById("mstrPromptsBody");E.scrollTop=A.offsetTop;window.scrollTo(0,E.parentNode.offsetTop+A.offsetTop-E.scrollTop);}}}}}function checkAnchorsReady(B){var A=document.anchors.length;for(var C=0;C<A;C++){if(document.anchors.item(C).name==B){return true;}}return false;}function AddItemstoElementPickerTextBox(F,B){var A=getObj(F);var G=getObj(B);if(G==null||A==null){return ;}var D;var C=A.options.length;if(!A.multiple){G.value=A.options[A.selectedIndex].value;D=A.selectedIndex;A.options[D].selected=false;}else{for(var E=0;E<C;E++){if((A.options[E])&&(A.options[E].selected==true)&&(A.options[E].value!="-none-")){if(G.value.length>0){G.value+=";";}G.value+=A.options[E].value;A.options[E].selected=false;D=E;}}}if(D!=C-1){A.options[D+1].selected=true;}}function MoveItemsbyListObjectPrompt(S,R,M,B,F){try{var P=document.PromptForm;var O;var C;var J=true;var T=getObj(S);var L=getObj(R);var A=-1;var D=0;var G=document.getElementById("mstrPromptsButtonBarBottom");var H=0;if(M==null){M=true;}if(B==null){B=true;}if(F==null){F=false;}T.style.visibility="hidden";C=T.options.length;H=L.options.length;if(F&&B){for(O=0;O<H;O++){if(L.options[O].selected){H=O;break;}}}for(O=0;O<C;O++){if((T.options[O])&&(T.options[O].selected==true)&&(T.options[O].value!="-none-")){var K=true;if(!M){if(isItemInList(T.options[O],L)){K=false;}}if(B&&K){var Q=new Option(T.options[O].text,T.options[O].value,false,true);if((L.length==1)&&(L.options[0].value=="-none-")){L.options[0]=Q;L.options[0].selected=false;}else{for(var N=L.length-1;N>=H;N--){var I=new Option(L.options[N].text,L.options[N].value,false,false);L.options[N+1]=I;}L.options[H]=Q;L.options[H].selected=false;H=H+1;}}A=O;D=D+1;}}if(M){for(O=C-1;O>=0;O--){if(T.options[O]&&(T.options[O].selected==true)&&(T.options[O].value!="-none-")){T.options[O]=null;}}}if(T.options.length==0){var Q=new Option("--"+aDescriptor[18]+"--","-none-",false,false);T.options[0]=Q;T.options[0].selected=false;}if(!M&&(T.options.length>1)){if(D>0){for(O=0;O<A;O++){T.options[O].selected=false;}}if((A>=0)&&(T.options[A+1]!=null)){T.options[A].selected=false;T.options[A+1].selected=true;}else{if(A==-1){T.options[0].selected=true;}}}else{if((A>0)&&(T.options.length>0)){if(A>=D){if(T.options.length>A-D+1){T.options[A-D+1].selected=true;}else{T.options[T.options.length-1].selected=true;}}else{D=D-1;T.options[A-D].selected=true;}}else{T.options[0].selected=true;}}if(G){G.style.visibility="hidden";G.style.visibility="visible";}T.style.visibility="visible";}catch(E){alert(E.value);}}function AddItemsbyListObjectForObjectPrompt(G,D,I){var J=document.PromptForm;var F;var E;var M;var A=new Array();var N;var L;var B;var O=getObj(G);var C=getObj(D);if(I==null){I=true;}B=0;N=C.options.length;for(F=0;F<N;F++){if(C.options[F].selected){N=F;break;}}O.style.visibility="hidden";M=O.options.length;for(F=0;F<M;F++){if(O.options[F].selected&&(O.options[F].value!="-none-")){if(C.options.length==1){if(C.options[0].value=="-none-"){C.options[0]=null;if(N>0){N=N-1;}}}var K=true;if(!I){if(isItemInList(O.options[F],C)){K=false;}}if(K){for(E=C.length-1;E>=N;E--){var H=new Option(C.options[E].text,C.options[E].value,false,false);C.options[E+1]=H;}var H=new Option(O.options[F].text,O.options[F].value,false,false);C.options[N]=H;C.options[N].selected=false;N=N+1;H=null;L=F;B=B+1;}}}if(I){for(F=M-1;F>=0;F--){if(O.options[F].selected){O.options[F].selected=false;A[A.length]=F;}}for(F=0;F<A.length;F++){O.options[A[F]]=null;}}if(O.options.length==0){var H=new Option("--"+aDescriptor[18]+"--","-none-",false,false);O.options[O.length]=H;O.options[O.length-1].selected=false;H=null;}if((L>0)&&(O.options.length>0)){if(L>=B){if(O.options.length>L-B+1){O.options[L-B+1].selected=true;}else{O.options[O.options.length-1].selected=true;}}else{B=B-1;O.options[L-B].selected=true;}}else{O.options[0].selected=true;}O.style.visibility="visible";}function isItemInList(A,C){var B=false;for(j=C.length-1;j>=0;j--){if(A.value==C.options[j].value){B=true;break;}}return B;}function BuildUserSelections(){var E;var D;var N;var L;var H;var B;var A;var J;var I;var K;var M;var C;for(E=0;E<promptJSMaxPin;E++){if(E>0){I=promptJSAnswerName+"_"+parseInt(E);K=promptJSListBoxName+"_"+parseInt(E);M=promptJSDimensionName+"_"+parseInt(E);sOperatorName=promptJSFuncName+"_"+parseInt(E);C=sTreeName+"_"+parseInt(E);}else{I=promptJSAnswerName;K=promptJSListBoxName;M=promptJSDimensionName;sOperatorName=promptJSFuncName;C=sTreeName;}if(K!=null){H=(document.getElementsByName(K).length>0)?document.getElementsByName(K)[0]:null;B=(document.getElementsByName(I).length>0)?document.getElementsByName(I)[0]:null;A=(document.getElementsByName(M).length>0)?document.getElementsByName(M)[0]:null;J=(document.getElementsByName(C).length>0)?document.getElementsByName(C)[0]:null;if(H!=null){L=H.options;N=L.length;if(B!=null){B.value="";}if((L[0].value!="-none-")&&(L[0].value!="-default-")){for(D=0;D<N;D++){if(L[D].value=="include"||L[D].value=="exclude"){continue;}if(A==null&&J==null){if(B.value!=""){B.value+=unescape(ANSWER_SEPARATOR);}B.value+=L[D].value;}else{switch(CheckAttributeElementExpression(L[D].value)){case 2:if(B.value.length>0){B.value+=unescape(ANSWER_SEPARATOR);}B.value+=L[D].value;break;case 1:if(B.value.length>0){B.value+=unescape(ANSWER_SEPARATOR);}B.value+="22"+unescape(ITEM_SEPARATOR)+"1"+unescape(EXPRESSION_SEPARATOR)+L[D].value+unescape(EXPRESSION_SEPARATOR);break;case 0:B.value+=L[D].value+unescape(UNIT_SEPARATOR);}}}}}else{var F=getObj(sOperatorName);if(F){if(F.options){F.options[F.selectedIndex].value=AddOutputLevelToOperator(F.options[F.selectedIndex].value,E);}else{F.value=AddOutputLevelToOperator(F.value,E);}}var G=checkConstantPromptAnswer(I);if(G.length>0){B.value=G;}}}}return(true);}function checkConstantPromptAnswer(G){var B="";var A=getObj(G+"_date");if(A!=null){B=A.value;}var E="";var I="";var D="";var J=":";var C=is24HourFormat()?getObj(G+"_timeHour24"):getObj(G+"_timeHour12");if(C!=null){E=C.value;}var K=getObj(G+"_timeMins");if(K!=null){I=K.value;}var F=getObj(G+"_timeSecs");if(F!=null){D=F.value;}var H=getObj(G+"_timeSep");if(H!=null){J=H.value;}if(E.length>0){B+=" "+E+J+I;}if(D.length>0){B+=J+D;}return B;}function GetCurrentAttributeValue(D){var C="";if(D.options){var A=D.options.length;for(var B=0;B<A;B++){if(D.options[B].defaultSelected==true){C=D.options[B].value;}}}else{C=D.value;}return C;}function GetUnitType(B){var A=B.split(ITEM_SEPARATOR);return(A[1]);}function GetUnitName(B){var A=B.split(ITEM_SEPARATOR);return(A[2]);}function CheckAttributeExist(B,A){var C=B.options.length;for(var D=0;D<C;D++){if(isSameAttributeValue(B.options[D].value,A)){return(D+1);}}return(-1);}function CheckNextNonAttributeElement(A,D){var B=A.options.length;for(var C=D;C<B;C++){if(CheckAttributeElementExpression(A.options[C].value)!=0){return(C);}}return(-1);}function CheckAttributeElementExpression(C){var B=":";var E=EXPRESSION_SEPARATOR;var D=ITEM_SEPARATOR;var A=new Array();var G=new Array();var F=new Array();A=C.split(E);if(A.length>1){return(2);}G=A[0].split(D);F=G[0].split(B);if(F.length>1){return(0);}else{if(A[0]=="-default-"||A[0]=="-none-"){return(-1);}else{return(1);}}}function checkOneHierarchyRestriction(D,A,B,E,C){if(canAddAttribute(D,A,B,E)){return true;}showMessage({contents:microstrategy.descriptors.getDescriptor("5097"),elements:microstrategy.OK_BUTTON+microstrategy.CANCEL_BUTTON,okEval:"removeCurrentSelectionsForHierarchy('"+B+"','"+E+"');"+C,type:mstrMsgBoxImpl.MSG_WARNING});return false;}function canAddAttribute(D,B,C,F){var E=getObj(C);if(E=="undefined"||E==null){var A=getObj("PromptForm");if(A){E=document.createElement("input");if(E){E.type="hidden";E.id=C;E.name=C;A.insertAdjacentElement("beforeEnd",E);E.value=getExistingAttributeIdsFromList(F);}}}var G=E.value;if(G.length<=0||G.indexOf(D)>=0||G.indexOf(B)>=0){return true;}return false;}function addAllowedObjects(D,A){var B=getObj(A);if(B!=null){var C=B.value;if(C.length<=0||C.indexOf(D)<0){B.value=C+D+",";}}}function removeCurrentSelectionsForHierarchy(A,F){var C=getObj(A);clearAllowedObjects(C);var E=getObj(F);for(var B=E.options.length-1;B>=0;B--){E.options[B]=null;}var D=new Option("--"+aDescriptor[18]+"--","-none-",false,false);E.options[0]=D;E.options[0].selected=false;D=null;}function clearAllowedObjects(A){var B=getObj(A);if(!!B){B.value="";}}function getExistingAttributeIdsFromList(E){var A="";var D=getObj(E);if(D!=null){for(var C=D.options.length-1;C>=0;C--){var B=getAttributeIdFromValue(D.options[C].value);if(B.length>0){A+=B+",";}}}return A;}function getAttributeIdFromValue(C){var A="";var B=CheckAttributeElementExpression(C);if(B==2){A=C.split(EXPRESSION_SEPARATOR)[1];}else{if(B==1){A=C.split(ITEM_SEPARATOR)[0];}}return(A.length>0)?(A+ITEM_SEPARATOR+"12"):A;}function AddItemsbyListObjectForHI(V,U,E,S,O,P){var T;var R;var L=new Array();var M=ITEM_SEPARATOR;var Y=new Array();var B="";var N;var C;var G;var Q=parseInt(S);var W;if(O==null){O=true;}var X=getObj(V);var K=getObj(U);var J=getObj(E);var A=-1;var D;D=0;if(X){X.focus();R=GetCurrentAttributeValue(J);N=CheckAttributeExist(K,R);C=X.options.length;for(i=0;i<C;i++){if(X.options[i].selected&&X.options[i].value!="-none-"){var I=true;if(!O){if(isItemInList(X.options[i],K)){I=false;}}if(I){if((K.options.length==1)&&((K.options[0].value=="-none-")||(K.options[0].value=="-default-"))){if(K.options[0].value=="-default-"){bDefault[Q]=true;}else{bDefault[Q]=false;}K.options[0]=null;}if(N==-1){T=new Option(GetUnitName(R)+":",R,false,false);K.options[K.length]=T;if(K.options[K.length-1]){K.options[K.length-1].selected=false;}T=null;}var T;if(bIsIE4){T=new Option(unescape("%a0")+unescape("%a0")+unescape("%a0")+X.options[i].text,X.options[i].value,false,false);}else{T=new Option("\u00A0\u00A0\u00A0"+X.options[i].text,X.options[i].value,false,false);}if(N>-1){var F=CheckNextNonAttributeElement(K,N);if(F==-1){N=K.options.length;}else{N=F;}}if(T){N=AddItem(S,T,N,K);var H=getObj("PROMPT_DEFAULT_MEANING_"+S);if((H!=null)&&(bDefault[Q])){H.style.display="none";}N+=1;T=null;}}A=i;D=D+1;}}if(O){for(i=C-1;i>=0;i--){if(X.options[i].selected){X.options[i].selected=false;Y[Y.length]=i;}}}for(i=0;i<Y.length;i++){X.options[Y[i]]=null;}if(X.options.length==0){var T=new Option("--"+aDescriptor[18]+"--","-none-",false,false);X.options[X.length]=T;X.options[X.length-1].selected=false;T=null;}Y=null;CleanList(K);if(!O&&(X.options.length>1)){if(D>0){for(i=0;i<A;i++){X.options[i].selected=false;}}if((A>=0)&&(X.options[A+1]!=null)){X.options[A].selected=false;X.options[A+1].selected=true;}else{if(A==-1){X.options[0].selected=true;}}}else{if((A>0)&&(X.options.length>0)){if(A>=D){if(X.options.length>A-D+1){X.options[A-D+1].selected=true;}else{X.options[X.options.length-1].selected=true;}}else{D=D-1;X.options[A-D].selected=true;}}else{X.options[0].selected=true;}}C=K.options.length;G=0;for(i=0;i<C;i++){B=K.options[i].value;if(CheckAttributeElementExpression(B)!=0){G+=1;}}if((getObj("ANDOR_"+S)!=null)&&(G>1)){displayObj("ANDOR_"+S);}}}function RemoveItemsByPin(J,B){var C=new Array();var G=J.options.length;var I=parseInt(B);for(var E=G-1;E>=0;E--){if(J.options[E].selected){J.options[E].selected=false;C[C.length]=E;}}for(E=0;E<C.length;E++){if((J.options[C[E]].value=="-default-")||(J.options[C[E]].text=="(default)")){bDefault[I]=false;}for(var D=C[E];D<J.options.length-1;D++){J.options[D].value=J.options[D+1].value;J.options[D].text=J.options[D+1].text;}J.options.length-=1;}if(J.options.length==0){var H=getObj("PROMPT_DEFAULT_MEANING_"+B);if(bDefault[I]){var F=new Option("--- "+aDescriptor[19]+" ---","-default-",false,false);if(H!=null){H.style.display="block";}}else{var F=new Option("--"+aDescriptor[18]+"--","-none-",false,false);if(H!=null){H.style.display="none";var A=null;if(B=="0"){A=getObj("answerOptions");}else{A=getObj("answerOptions_"+B);}if(A!=null){A.value="2";}}}J.options[J.length]=F;J.options[J.length-1].selected=false;F=null;}C=null;}function RemoveItemsbyListObjectForHIInList(Y,X,E,V,Q,U,S){var J;var H;var T="";var R;var O=new Array();var A;var I;var B;var D=false;var F=ITEM_SEPARATOR;var a=getObj(Y);var N=getObj(X);var M=getObj(E);var Z;if(Q==null){Q=true;}if(U==null){U=true;}if(M){T=GetCurrentAttributeValue(M);}else{D=true;}var C=a.options.length;var K=false;var W=-1;for(var P=0;P<C;P++){if((a.options[P])&&(a.options[P].selected)){K=true;W=P;break;}}if(!K&&(C>0)&&(a.options[0])&&(a.options[0].value!="-none")){a.options[C-1].selected=true;}for(var P=0;P<C;P++){J=a.options[P].value;if(CheckAttributeElementExpression(J)==1){bAttributeSelected=true;var G=P+1;H=a.options[G].value;while((G<C)&&(CheckAttributeElementExpression(H)==0)){if(a.options[P].selected){a.options[G].selected=true;if((U)&&(isSameAttributeValue(J,T)||D)){R=a.options[G].text;var L=new Option(R.substring(3,R.length),a.options[G].value,false,false);AddItem(V,L,-1,N);}}else{if(a.options[G].selected==true){if((U)&&(isSameAttributeValue(J,T)||D)){R=a.options[G].text;var L=new Option(R.substring(3,R.length),a.options[G].value,false,false);AddItem(V,L,-1,N);}}else{bAttributeSelected=false;}}G+=1;if(G<C){H=a.options[G].value;}}a.options[P].selected=bAttributeSelected;P=G-1;}}if(Q){RemoveItemsByPin(a,V);CleanList(a);}if(a.length>1){if((W>0)&&(W<(a.length-1))){if(CheckAttributeElementExpression(a.options[W].value)!=0){W++;}}else{if(CheckAttributeElementExpression(a.options[a.length-1].value)!=1){W=a.length-1;}else{if(CheckAttributeElementExpression(a.options[a.length-2].value)!=1){W=a.length-2;}}}a.options[W].selected=true;}C=a.options.length;I=0;for(i=0;i<C;i++){B=a.options[i].value;if(CheckAttributeElementExpression(B)!=0){I+=1;}}if(I<2){Z=getObj("ANDOR_"+V);if(Z!=null){Z.style.display="none";}}}function RemoveItemsbyListObjectForHIInQual(V,E,F,U,R){var L;var J;var T;var S;var O=new Array();var A;var K;var C;var Q;var H;var I="";var B;var P=EXPRESSION_SEPARATOR;var G=ITEM_SEPARATOR;var X=getObj(V);var M=getObj(E);var N=getObj(F);var W;if(R==null){R=true;}var D=X.options.length;for(Q=0;Q<D;Q++){L=X.options[Q].value;B=CheckAttributeElementExpression(L);if(B==1){bAttributeSelected=true;H=Q+1;J=X.options[H].value;while((H<D)&&(CheckAttributeElementExpression(J)==0)){if(X.options[Q].selected){X.options[H].selected=true;}else{if(X.options[H].selected==false){bAttributeSelected=false;}}H+=1;if(H<D){J=X.options[H].value;}}X.options[Q].selected=bAttributeSelected;Q=H-1;}if((B==2)&&(I=="")){I=L;}}if(R){RemoveItemsByPin(X,U);CleanList(X);}D=X.options.length;K=0;for(i=0;i<D;i++){C=X.options[i].value;if(CheckAttributeElementExpression(C)!=0){K+=1;}}if(K<2){W=getObj("ANDOR_"+U);if(W!=null){W.style.display="none";}}if(N){O=I.split(P);D=N.options.length;for(i=0;i<D;i++){if(N.options[i].value==O[1]){N.options[i].selected=true;break;}}}D=M.options.length;for(i=0;i<D;i++){if(M.options[i].value==O[0]){M.options[i].selected=true;break;}}}function GetNodeAttributeValue(A){var B="";if(A){B=A.getAttribute("val");}return B;}function GetNodeDimensionId(A){var B="";if(A){B=A.getAttribute("dimensionId");}return B;}function AddAttributeQualificationExpressionForTree(E,D,A,B,F,C){AddItemsbyListObjectForExpression(E,D,A,treeToList,treePos);ClosePromptEditor(B,F,C);}function ClosePromptEditor(A,D,B){var C=document.getElementById(B);C&&(C.style.visibility="hidden");togglePulldowns(C,true);toggleShowBean(D,false,"isTreeRequest=true&position="+treePos,true);}function AddItemsbyListObjectForHIInTree(M,R,N,E,K,L){var J;var k;var Z=new Array();var T="";var X;var C=0;var D;var Y=parseInt(N);var B;var f=getObj(M);var S=getObj(R);var A;var Q=0;var P=-1;var e=false;var d="";if(L){d=(Y>0)?"allowedObjects_"+Y:"allowedObjects";}if(f){var U=f.getElementsByTagName("LI");if((U)&&(U.length)){C=U.length;}for(h=0;h<C;h++){if(U[h].getAttribute("sel")=="1"){if(U[h].getAttribute("tp")!="12"&&U[h].getAttribute("tp")!="14"&&U[h].getAttribute("tp")!="8"){if((S.options.length==1)&&((S.options[0].value=="-none-")||(S.options[0].value=="-default-"))){bDefault[Y]=(S.options[0].value=="-default-")?true:false;S.options[0]=null;}sCurrentAttributeElmentValue=GetNodeAttributeValue(U[h]);X=CheckAttributeExist(S,sCurrentAttributeElmentValue);if(X==-1){k=GetNodeAttributeValue(U[h].parentNode.parentNode.previousSibling.childNodes[0]);X=CheckAttributeExist(S,k);if(X==-1){if(L){var a=GetNodeDimensionId(U[h].parentNode.parentNode.previousSibling.childNodes[0]);var g=a.split(ITEM_SEPARATOR)[0]+ITEM_SEPARATOR+"14";var I=k.split(ITEM_SEPARATOR)[0]+ITEM_SEPARATOR+"12";var G="AddItemsbyListObjectForHIInTree('"+M+"','"+R+"','"+N+"','"+E+"','"+K+"','"+L+"')";if(!checkOneHierarchyRestriction(g,I,d,R,G)){return ;}addAllowedObjects(g,d);}J=new Option(GetUnitName(k)+":",k,false,false);S.options[S.length]=J;e=true;if(S.options[S.length-1]){S.options[S.length-1].selected=false;}J=null;}if(X>-1){var O=CheckNextNonAttributeElement(S,X);if(O==-1){X=S.options.length;}else{X=O;}}var J=(bIsIE4)?new Option(unescape("%a0")+unescape("%a0")+unescape("%a0")+LTrim(U[h].innerText),U[h].getAttribute("val"),false,false):new Option("\u00A0\u00A0\u00A0"+LTrim(U[h].innerText),U[h].getAttribute("val"),false,false);if(J){X=AddItem(N,J,X,S);e=true;var c=getObj("PROMPT_DEFAULT_MEANING_"+N);if((c!=null)&&(bDefault[Y])){c.style.display="none";}X+=1;J=null;A=h;Q=Q+1;}}}else{if(U[h].getAttribute("tp")=="12"&&E){if(L){k=GetNodeAttributeValue(U[h]);X=CheckAttributeExist(S,k);if(X==-1){var a=GetNodeDimensionId(U[h]);var g=a.split(ITEM_SEPARATOR)[0]+ITEM_SEPARATOR+"14";var I=k.split(ITEM_SEPARATOR)[0]+ITEM_SEPARATOR+"12";var G="AddItemsbyListObjectForHIInTree('"+M+"','"+R+"','"+N+"','"+E+"','"+K+"','"+L+"')";if(!checkOneHierarchyRestriction(g,I,d,R,G)){return ;}addAllowedObjects(g,d);}}treeToList=R;treePos=N;var l="";if(U[h].getAttribute("hiddenForms")){l="&hiddenForms="+U[h].getAttribute("hiddenForms");}toggleShowBean("attFormsQual",true,"position="+N+"&isTreeRequest=true&attributeId="+U[h].getAttribute("did")+"&operatorType="+K+l,true);}}U[h].setAttribute("sel","0");var F=util_getChildNode(U[h],"A");if(F){F.className="";}if(e){P=h;}}}if(P!=-1){var W=U[P].getAttribute("tp");var V=U[P].getAttribute("did");if(V&&V.indexOf(":")>0){V=V.substring(0,V.indexOf(":"));}for(var h=P+1;h<C;h++){var b=U[h].getAttribute("tp");if(b&&b==W){var H=U[h].getAttribute("did");if(H&&H.indexOf(":")>0){H=H.substring(0,H.indexOf(":"));}if(H&&H==V){util_markNodeAsSelected(U[h]);scrollItemIntoView(U[h],f,false);break;}}}}CleanList(S);C=S.options.length;D=0;for(h=0;h<C;h++){T=S.options[h].value;if(CheckAttributeElementExpression(T)!=0){D+=1;}}if(D>1){displayObj("ANDOR_"+N);}}}function itemIsInView(D,B){var A=new SimpleRect(B);var C=D.getElementsByTagName("A");if(C&&C.length>0){var E=new SimpleRect(C[0]);return(E.left>A.left&&E.right<(A.left+parseInt(getObjInnerWidth(B)))&&E.top>A.top&&E.bottom<(A.top+parseInt(getObjInnerHeight(B))));}return false;}function scrollItemIntoView(F,C,E){var B=new SimpleRect(C);var D=F.getElementsByTagName("A");if(D&&D.length>0){var G=new SimpleRect(D[0]);var A=(G.top>B.top&&G.top<(B.top+parseInt(getObjInnerHeight(C))))?0:(B.top-G.top);var H=(G.bottom>B.top&&G.bottom<(B.top+parseInt(getObjInnerHeight(C))))?0:(G.bottom-(B.top+parseInt(getObjInnerHeight(C))));if(E){if(A>0){C.scrollTop=C.scrollTop+A;}}else{if(H>0){C.scrollTop=C.scrollTop+H;}}}}function RemoveItemsbyListObjectForHIInTree(I,A){var C;var B;var J;var E;var N=getObj(I);var O;var F=-1;var L=N.options.length;for(var H=0;H<L;H++){C=N.options[H].value;if(CheckAttributeElementExpression(C)==1){bAttributeSelected=true;var K=H+1;B=N.options[K].value;while((K<L)&&(CheckAttributeElementExpression(B)==0)){if(N.options[H].selected){N.options[K].selected=true;}else{if(N.options[K].selected==false){bAttributeSelected=false;}}K+=1;if(K<L){B=N.options[K].value;}}N.options[H].selected=bAttributeSelected;H=K-1;}}for(var G=L-1;G>=0;G--){if(N.options[G].selected){F=G;break;}}RemoveItemsByPin(N,A);CleanList(N);if(N.length>1){if((F>0)&&(F<(N.length-1))){if(CheckAttributeElementExpression(N.options[F].value)!=0){F++;}}else{if(CheckAttributeElementExpression(N.options[N.length-1].value)!=1){F=N.length-1;}else{if(CheckAttributeElementExpression(N.options[N.length-2].value)!=1){F=N.length-2;}}}N.options[F].selected=true;}else{if(CheckAttributeElementExpression(N.options[0].value)==-1){var M=parseInt(A);var D=(M>0)?"allowedObjects_"+M:"allowedObjects";clearAllowedObjects(D);}}L=N.options.length;J=0;for(G=0;G<L;G++){E=N.options[G].value;if(CheckAttributeElementExpression(E)!=0){J+=1;}}if(J<2){O=getObj("ANDOR_"+A);if(O!=null){O.style.display="none";}}}function AddItem(F,G,C,A){var B;var E=parseInt(F);if(A){if((A.options.length==1)&&((A.options[0].value=="-none-")||(A.options[0].value=="-default-")||(A.options[0].text=="(default)"))){if((A.options[0].value=="-default-")||(A.options[0].text=="(default)")){bDefault[E]=true;}else{bDefault[E]=false;}A.options[0]=null;}B=A.options.length;if(C==-1){C=B;}for(var D=B;D>C;D--){var H=new Option(A.options[D-1].text,A.options[D-1].value,false,false);A.options[D]=H;A.options[D].selected=false;H=null;}A.options[C]=G;A.options[C].selected=false;}return(C);}function AddItemsbyListObjectForExpression(Z,G,O,X,V,P){var W;var H;var b;var R;var F;var Y;var A;var S;var C;var d;var a;var T=parseInt(V);var c=getObj(Z);var N=getObj(X);var B=getObj(O);var M=getObj(G);var I="";if(P){var L=document.getElementsByName(P);if(L&&L.length>0){for(var U=0;U<L.length;U++){if(L[U].checked){I=L[U].value;break;}}}}b=GetSelectedItemValue(c);H=GetSelectedItemText(c);R=GetSelectedItemDatatype(c);F=GetSelectedItemValue(M);Y=B.value;if((F=="17"+ITEM_SEPARATOR+"1")||(F=="22"+ITEM_SEPARATOR+"1")||(F=="57"+ITEM_SEPARATOR+"1")||(F=="44"+ITEM_SEPARATOR+"1")){Y=CleanInput(Y,false);}d=Y.split(";").length;if(b=="0"){DisplayError(aDescriptor[16],aDescriptor[15],V);return false;}else{if((Y=="")&&!((F=="54"+ITEM_SEPARATOR+"1")||(F=="55"+ITEM_SEPARATOR+"1"))){DisplayError(aDescriptor[16],aDescriptor[12],V);return false;}else{if(b!=""&&b!="0"){var K=F.split(ITEM_SEPARATOR);if(K[1]=="3"){Y=CleanPercentageSign(Y)+"%";}S=BuildSelectTextForExpression(H,F,Y,R,V);F=AddOutputLevelToOperator(F,V);if(I=="exclude"){F+=ITEM_SEPARATOR+"exclude";}A=BuildSelectValueForExpression(b,F,Y,I);if(S=="9"){DisplayError(aDescriptor[16],aDescriptor[9],V);return false;}else{if(S=="21"){DisplayError(aDescriptor[16],aDescriptor[21],V);return false;}else{if(S=="10"){DisplayError(aDescriptor[16],aDescriptor[10],V);return false;}else{if((F=="M8"||F=="M9"||F=="M10"||F=="M11")&&(d>1)){DisplayError(aDescriptor[16],aDescriptor[15],V);B.value="";return false;}else{if(S!="0"){var Q=-1;if(I.length>0){if(bIsIE4){S=unescape("%a0")+unescape("%a0")+unescape("%a0")+S;}else{S="\u00A0\u00A0\u00A0"+S;}var E=CheckIncludeExcludePosition(N,I);if(I=="include"){if(E==-1){Q=AddIncludeOption(V,N);}else{var D=CheckIncludeExcludePosition(N,"exclude");Q=D;}}else{if(I=="exclude"){if(E==-1){Q=AddExcludeOption(V,N);}else{Q=-1;}}}}W=new Option(S,A,false,false);W.setAttribute("unitId",b);W.setAttribute("opId",F);W.setAttribute("val",Y);AddItem(V,W,Q,N);B.value="";var J=getObj("PROMPT_DEFAULT_MEANING_"+V);if((J!=null)&&(bDefault[T])){J.style.display="none";}ClearError(V);}}}}}}}}C=N.options.length;if(C>1){a=getObj("ANDOR_"+V);if(a!=null){a.style.display="block";}}return true;}function updateExpressionFields(N,M,A,E,B,K){var H=-1;if(N){if(E&&N.getAttribute("unitId")){var D=N.getAttribute("unitId");if(D.length>0){for(var P=0;P<E.length;P++){if(E.options[P]){if(E.options[P].value.indexOf(D)>-1){E.options[P].selected=true;if(E.options[P].getAttribute("DATATYPE")){H=E.options[P].getAttribute("DATATYPE");}}else{E.options[P].selected=false;}}}}}var J=N.getAttribute("opId");if(M&&J){if(J.length>0){for(var O=0;O<M.length;O++){if(M.options[O]){if(J.indexOf(M.options[O].value,0)==0){M.options[O].selected=true;}else{M.options[O].selected=false;}}}}}if((A!=null)&&(N.getAttribute("val")!=null)){A.value=N.getAttribute("val");if((J!=null)&&(J.length>0)){var L=getObj(B);if((J.indexOf("54"+ITEM_SEPARATOR+"1",0)==0)||(J.indexOf("55"+ITEM_SEPARATOR+"1",0)==0)){A.parentNode.style.visibility="hidden";if(((H==15)||(H==14))&&L){L.style.visibility="hidden";}}else{A.parentNode.style.visibility="visible";if(((H==15)||(H==14))&&L){L.style.visibility="visible";}}}}if(K&&J){var G=document.getElementsByName(K);var I=J.split(ITEM_SEPARATOR);var C="include";if(I.length>2){C="exclude";}if(G&&G.length>0){for(var F=0;F<G.length;F++){if(G[F].value==C){G[F].checked=true;break;}}}}}}function hideExpressionValueTextbox(C,E,L,K){var B=getObj(C);var I=getObj(E);if(B&&I){var H=B.value.split(ITEM_SEPARATOR);var A=getObj(K);var F=getObj(L);var D=false;if(A&&(A.options.length>0)&&F){var G=A.options.selectedIndex;if((G!=null)&&(G>-1)){var J=A.options[G].getAttribute("DATATYPE");if((J!=null)&&((J==15)||(J==14))){D=true;}}}if((H[0]=="54")||(H[0]=="55")){if((I.parentNode!=null)&&(I.parentNode.nodeName=="DIV")){I.parentNode.style.visibility="hidden";}else{I.style.visibility="hidden";}if(D&&F){F.style.visibility="hidden";}}else{if((I.parentNode!=null)&&(I.parentNode.nodeName=="DIV")){I.parentNode.style.visibility="visible";}else{I.style.visibility="visible";}if(D&&F){F.style.visibility="visible";}}}}function RemoveItemsbyListObjectForExpression(a,F,B,W,Y,G,P){var X;var T;var E;var Z;var O=new Array();var e=new Array();var Q=ANSWER_SEPARATOR;var h=ITEM_SEPARATOR;var R;var S=parseInt(W);var I;var H;var g;var V;var R;var M=getObj(F);var J=getObj(B);var N=getObj(Y);var d=getObj(a);var C=d.options.length;var c=isIncludeExcludeOption(d.options[0]);var A=-1;var D=-1;if(c){A=CheckIncludeExcludePosition(d,"include");D=CheckIncludeExcludePosition(d,"exclude");}var L=false;if(d.selectedIndex!=-1){L=true;}if(!L&&(C>0)&&(d.options[0])&&(d.options[0].value!="-none")){d.options[0].selected=true;}if(c){if(A==d.selectedIndex){d.selectedIndex=A+1;}else{if(D==d.selectedIndex){d.selectedIndex=D+1;}}if(A>=0){if((A==C-2)||(A==D-2&&D>d.selectedIndex)){d.options[A]=null;C=d.options.length;}}if(D>=0&&D==C-2&&D<d.selectedIndex){d.options[D]=null;C=d.options.length;}}if(!d.multiple){e[e.length]=d.selectedIndex;}else{for(var U=C-1;U>=0;U--){if(d.options[U].selected){d.options[U].selected=false;e[e.length]=U;}}}if(e.length!=0){for(U=0;U<e.length;U++){if((d.options[e[U]].value=="-default-")||(d.options[e[U]].text=="(default)")){bDefault[S]=false;}updateExpressionFields(d.options[e[U]],M,J,N,G,P);d.options[e[U]]=null;}if(d.options.length==0){var K=getObj("PROMPT_DEFAULT_MEANING_"+W);if(bDefault[S]){var X=new Option("--- "+aDescriptor[19]+" ---","-default-",false,false);if(K!=null){K.style.display="block";}}else{var X=new Option("--"+aDescriptor[18]+"--","-none-",false,false);if(K!=null){K.style.display="none";var f=null;if(W=="0"){f=getObj("answerOptions");}else{f=getObj("answerOptions_"+W);}if(f!=null){f.value="2";}}}d.options[d.length]=X;d.options[d.length-1].selected=false;X=null;}C=d.options.length;if(C<2&&document.all){if(W!=null||W!=""){var b=getObj("ANDOR_"+W);if(b!=null){b.style.display="none";}}}}}function isIncludeExcludeOption(A){if(A!=null&&(A.value=="include"||A.value=="exclude")){return true;}return false;}function CheckIncludeExcludePosition(A,C){var B=A.options.length;for(var D=0;D<B;D++){if(A.options[D].value==C){return(D);}}return(-1);}function AddIncludeOption(B,A){var C=new Option(aDescriptor[39],"include",false,false);AddItem(B,C,0,A);return(1);}function AddExcludeOption(B,A){var C=new Option(aDescriptor[40],"exclude",false,false);AddItem(B,C,-1,A);return(A.length);}function BuildSelectValueForExpression(F,G,D,A){var E;var H=EXPRESSION_SEPARATOR;var I=new Array();var B;var C=G.split(ITEM_SEPARATOR);if(C[0]=="22"){var B=new RegExp(",","g");D=D.replace(B,";");}D=CleanInput(D,false);E=G+H+F+H+D;return(E);}function FindDelimeter(B){var A;A=B.match(";");if(A!=null){return(";");}else{A=B.match(",");if(A!=null){return(",");}else{return("");}}}function BuildSelectTextForExpression(B,L,H,J,A){var K;var M=ITEM_SEPARATOR;var N=new Array();var C;var I;var G=FindDelimeter(H);K=B;var E=L.split(ITEM_SEPARATOR);if(E[1]=="1"){L="M"+E[0];}else{if(E[1]=="2"){L="R"+E[0];}else{if(E[1]=="3"){L="P"+E[0];}}}var F=GetOperatorSymbol(L);if(L=="M17"){if(G==";"){N=H.split(G);}else{return("9");}I=N.length;if(J=="4"){for(lCount=0;lCount<I;lCount++){if(!isANumber(N[lCount])){return("21");}}}if(I==2){K=K+" "+aDescriptor[1]+" "+N[0]+" "+aDescriptor[8]+" "+N[1];}else{return("9");}}else{if(L=="M44"){if(G==";"){N=H.split(G);}else{return("10");}I=N.length;if(J=="4"){for(lCount=0;lCount<I;lCount++){if(!isANumber(N[lCount])){return("21");}}}if(I==2){K=K+" "+aDescriptor[2]+" "+N[0]+" "+aDescriptor[8]+" "+N[1];}else{return("10");}}else{if(L=="M22"){var D=new RegExp(",","g");C=H.replace(D,";");K=K+" "+aDescriptor[7]+" ("+C+")";}else{if(L=="M57"){var D=new RegExp(",","g");C=H.replace(D,";");K=K+" "+aDescriptor[20]+" ("+C+")";}else{if(L=="M18"){K=K+" "+aDescriptor[3]+" "+H;}else{if(L=="M43"){K=K+" "+aDescriptor[4]+" "+H;}else{if(L=="P1"){K=K+" "+aDescriptor[5]+" "+H;}else{if(L=="P2"){K=K+" "+aDescriptor[6]+" "+H;}else{if(L=="R1"){K=K+" "+aDescriptor[5]+" "+H;}else{if(L=="R2"){K=K+" "+aDescriptor[6]+" "+H;}else{if(L=="M76"){if(H.indexOf('"')<0){K=K+" "+aDescriptor[33]+' "'+H+'"';}else{K=K+" "+aDescriptor[33]+" "+H;}}else{if(L=="M77"){if(H.indexOf('"')<0){K=K+" "+aDescriptor[34]+' "'+H+'"';}else{K=K+" "+aDescriptor[34]+" "+H;}}else{if(L=="M78"){if(H.indexOf('"')<0){K=K+" "+aDescriptor[35]+' "'+H+'"';}else{K=K+" "+aDescriptor[35]+" "+H;}}else{if(L=="M79"){if(H.indexOf('"')<0){K=K+" "+aDescriptor[30]+' "'+H+'"';}else{K=K+" "+aDescriptor[30]+" "+H;}}else{if(L=="M80"){if(H.indexOf('"')<0){K=K+" "+aDescriptor[31]+' "'+H+'"';}else{K=K+" "+aDescriptor[31]+" "+H;}}else{if(L=="M81"){if(H.indexOf('"')<0){K=K+" "+aDescriptor[32]+' "'+H+'"';}else{K=K+" "+aDescriptor[32]+" "+H;}}else{if(L=="M54"){K=K+" "+aDescriptor[36];}else{if(L=="M55"){K=K+" "+aDescriptor[37];}else{K=K+" "+F+" "+H;}}}}}}}}}}}}}}}}}}K=AddMQOutputLevelText(K,A);return(K);}function isANumber(B){var A=false;if(promptDecimalSeparator!=null){B=B.replace(promptDecimalSeparator,".");if(!isNaN(B)){A=true;}}return A;}function GetOperatorSymbol(A){if(A=="M17"){return(aDescriptor[1]);}else{if(A=="M44"){return(aDescriptor[2]);}else{if(A=="M6"){return(aDescriptor[22]);}else{if(A=="M7"){return(aDescriptor[27]);}else{if(A=="M8"){return(aDescriptor[23]);}else{if(A=="M10"){return(aDescriptor[24]);}else{if(A=="M9"){return(aDescriptor[25]);}else{if(A=="M11"){return(aDescriptor[26]);}else{if(A=="M18"){return(aDescriptor[3]);}else{if(A=="M43"){return(aDescriptor[4]);}else{if(A=="M22"){return(aDescriptor[7]);}else{if(A=="M57"){return(aDescriptor[20]);}else{if(A=="R1"||A=="P1"){return(aDescriptor[5]);}else{if(A=="R2"||A=="P2"){return(aDescriptor[6]);}else{return("=");}}}}}}}}}}}}}}}function GetSelectedItemValue(E){var D;var A=E.options.length;var C=0;for(var B=0;B<A;B++){if(E.options[B].selected){C+=1;if(C>1){return("1");}else{D=E.options[B].value;}}}if(C==0){return("0");}else{return(D);}}function GetSelectedItemText(E){var D;var A=E.options.length;var C=0;for(var B=0;B<A;B++){if(E.options[B].selected){C+=1;if(C>1){return("1");}else{D=E.options[B].text;}}}if(C==0){return("0");}else{return(D);}}function GetSelectedItemDatatype(B){var A=GetCurrentAttributeValue(B);if(A!=null){A=GetUnitType(A);}else{return"-1";}return A;}function CleanList(E){var D;var A=E.options.length;var C=0;for(var B=A-1;B>=0;B--){D=E.options[B].value;if(D==""){E.options[B]=null;}}}function CleanInput(E,C){var D;var A;if(C==null){C=true;}A=E.split(";");D=A[0];if(C){D=LTrim(A[0]);if(D.length==0){D=A[0];}}for(var B=1;B<A.length;B++){if(A[B]!=""){var F=A[B];if(C){F=LTrim(A[B]);if(F.length==0){F=A[B];}}D=D+";"+F;}}return(D);}function CleanPercentageSign(B){var A;A=B;while(A.length>0){if(A.substring(A.length-1,A.length)=="%"){A=A.substring(0,A.length-1);}else{break;}}return(A);}function DisplayError(D,A,C){var E=getObj("DetailErrorDisplay_"+C);var B;if(E!=null){B='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'promptError_white.gif" WIDTH="23" HEIGHT="23" BORDER="0" ALIGN=MIDDLE>';B=B+'<SPAN CLASS="prompt-error-description">';B=B+A;B=B+"</SPAN>";writeToDiv(B,E);displayObj(E);}}function ClearError(B){1;var C=getObj("DetailErrorDisplay_"+B);var A;if(C!=null){A="";writeToDiv(A,C);removeObj(C);}}function selectInOperator(A){var B;var C;C=window.document.PromptForm[A];if(C){if((C.selecteIndex==-1)||((C.selectedIndex>=0)&&(C[C.selectedIndex].value!=("22"+ITEM_SEPARATOR+"1"))&&(C[C.selectedIndex].value!=("57"+ITEM_SEPARATOR+"1")))){for(B=0;B<C.length;B++){if(C[B].value==("22"+ITEM_SEPARATOR+"1")){C.selectedIndex=B;}}}}}function checkFileExtension(B){var D;var A;var C;C=window.document.PromptForm[B];if(C){D=C.value;if(D.length>0){A=","+getFileExtension(D)+",";if(sValidExtensions.indexOf(A)==-1){alert(sInvalidFileMessage);return false;}}else{alert(sEmptyFileName);return false;}}return true;}function getFileExtension(B){var A="";var C=B.lastIndexOf(".");if(C!=-1&&C<B.length){A=B.substr(C+1);}return A;}function SubmitPromptIndex(B){var A=getObj("PromptForm");if(A){var C=document.createElement("INPUT");if(C){C.type="HIDDEN";C.name=B+".x";A.insertAdjacentElement("beforeEnd",C);A.submit();}}}function SubmitPromptLink(B){var A=getObj("PromptForm");if(A){addURLAsHiddenInputsToForm(A,B.href,true);A.submit();}}function RTrim(D){var A=new String(" \t\n\r");var C=new String(D);if(A.indexOf(C.charAt(C.length-1))!=-1){var B=C.length-1;while(B>=0&&A.indexOf(C.charAt(B))!=-1){B--;}C=C.substring(0,B+1);}return C;}function LTrim(E){var B=new String(" \t\n\r");var D=new String(E);if(B.indexOf(D.charAt(0))!=-1){var A=0,C=D.length;while(A<C&&B.indexOf(D.charAt(A))!=-1){A++;}D=D.substring(A,C);}return D;}function showHideAttSelection(C){var A=getObj("attributeSelection");if(C=="3"){if(A){displayObj(A);if(microstrategy){microstrategy.eventManager.notifyOrphanBones("processShowHideAttSelection",true);}var B=microstrategy.findAncestorWithAtt(A,"ty","editor");if(B){togglePulldowns(B,false);}}}else{if(A){removeObj(A);if(microstrategy){microstrategy.eventManager.notifyOrphanBones("processShowHideAttSelection",false);}var B=microstrategy.findAncestorWithAtt(A,"ty","editor");if(B){togglePulldowns(B,true);togglePulldowns(B,false);}}}}function addAttributeToCartMQEditor(){var E=getObj("mqLevelAttID");var B=getObj("mqLevelAttName");var A=false;var C;if(E&&B){var D=getObj("dimtyAttributes");if(D){if(E.value.length>0){for(C=0;C<D.options.length;C++){if(D.options[C].value.indexOf(E.value)>=0){A=true;}}if(!A){if(D.options.length==1){if(D.options[0].value=="-none-"){D.options[0]=null;}}var F=new Option(B.value,E.value+unescape(ITEM_SEPARATOR)+B.value,false,false);D.options[D.length]=F;F=null;B.value="";E.value="";}}}}}function removeAttributeFromCartMQEditor(){var A=getObj("dimtyAttributes");if(A){if(!(A.options[0].value=="")){if(A.selectedIndex>=0){A.options[A.selectedIndex]=null;if(A.options.length==0){var B=new Option("--"+aDescriptor[18]+"--","-none-",false,false);A.options[0]=B;A.options[0].selected=false;B=null;}}}}}function ProcessOKforMQEditor(F,G){var D=getObj("dimtyAttributes");var B=getObj("metricQualLevel_MetricQualLevelStyle_form").outputLevel;var C=getObj("outputLevelLabel_"+F);var E=getObj("outputLevel_"+F);var A=0;if(B){if(B[3].checked){if(D){if(E){var H=getObj("attList_"+F);if(H){H.value="";if(C){if(D.options[0].value!="-none-"){C.innerHTML=microstrategy.descriptors.getDescriptor("2790").replace(/##/g,"");}}for(A=0;A<D.options.length;A++){if(D.options[A].value!="-none-"){E.value="3";if(A!=D.options.length-1){H.value+=D.options[A].value+unescape(UNIT_SEPARATOR);if(C){C.innerHTML+=D.options[A].text+", ";}}else{H.value+=D.options[A].value;if(C){C.innerHTML+=D.options[A].text+": ";}}}}}}}}else{if(E){if(B[0].checked){E.value="0";if(C){C.innerHTML=microstrategy.descriptors.getDescriptor("4389");}}if(B[1].checked){E.value="1";if(C){C.innerHTML=microstrategy.descriptors.getDescriptor("4388");}}if(B[2].checked){E.value="2";if(C){C.innerHTML=microstrategy.descriptors.getDescriptor("3275");}}}}}}function ProcessApplyElementPickerEditor(B,E){var A;if(B=="0"){A="unitsToAdd";}else{A="unitsToAdd_"+B;}var D=getObj(A);var C=getObj("selectedText");if(C){D.value=C.value;}else{oFromList=getObj("AvailableItems");D.value=oFromList.options[oFromList.selectedIndex].value;}}function AddOutputLevelToOperator(A,B){var D=getObj("outputLevel_"+B);var C=getObj("outputLevelLabel_"+B);if(D){var F=D.value;A+=unescape(UNIT_SEPARATOR)+F;switch(F){case"3":var E=getObj("attList_"+B);if(E){A+=unescape(UNIT_SEPARATOR)+E.value;E.value="";}break;}D.value="";}if(C){C.innerHTML=microstrategy.descriptors.getDescriptor("3274");}return A;}function AddMQOutputLevelText(F,A){var H=getObj("outputLevel_"+A);var B="";var D;var J=0;if(H){var G=H.value;if(G=="3"){var E=getObj("attList_"+A);var I=E.value;if(I.length>32){var C=I.split(UNIT_SEPARATOR);J=C.length;for(i=0;i<J;i++){D=C[i].split(ITEM_SEPARATOR);if(i==0){B+=D[2];}else{B+=", "+D[2];}}}if(J>1){B="( "+B+" )";}F=aDescriptor[28].replace(/##/g,B)+" "+aDescriptor[29].replace(/##/g,F);}}return(F);}function openMQLevelEditor(C,D){var G=getObj("outputLevel_"+D);var F="";var E="";E="isTreeRequest=true&promptPosition="+D;if(G){var B=G.value;if(B.length>0){if(B=="3"){var H=getObj("attList_"+D);if(H){var A=H.value;E+="&outputLevel=3&dimtyAttributes="+A;}}else{E+="&outputLevel="+B;}}else{E+="&outputLevel=0";}}toggleShowBean("metricQualLevel",true,E,true);}function openElementPicker(B,A,H,G,D){var F="";F="isTreeRequest=true&promptPosition="+A;var C=getObj(H);if(C&&C[C.selectedIndex]){F+="&operator="+C[C.selectedIndex].value;}var I=getObj(G);if(I&&I[I.selectedIndex]){F+="&attributeId="+I[I.selectedIndex].value;}var E=getObj(D);if(E){F+="&selectedText="+E.value;}toggleShowBean("elementPicker",true,F,true);}function submitMQForm(E){var B=document.createElement("input");B.setAttribute("name","outputLevel");B.setAttribute("type","hidden");var D=document.createElement("input");D.setAttribute("name","dimtyAttributes");D.setAttribute("type","hidden");var A="";var G=createDynamicForm(E.href+"&isTreeRequest=true");if(G){G.target="frameManager";var C=document.getElementsByName("outputLevel");if(C[3].checked){B.setAttribute("value",C[3].value);G.insertAdjacentElement("beforeEnd",B);var F=getObj("dimtyAttributes");if(F){for(i=0;i<F.options.length;i++){if(F.options[i].value!="-none-"){if(i!=F.options.length-1){A+=F.options[i].value+unescape(UNIT_SEPARATOR);}else{A+=F.options[i].value;}}}D.setAttribute("value",A);G.insertAdjacentElement("beforeEnd",D);}}if(C[2].checked){B.setAttribute("value",C[2].value);G.insertAdjacentElement("beforeEnd",B);}if(C[1].checked){B.setAttribute("value",C[1].value);G.insertAdjacentElement("beforeEnd",B);}if(C[0].checked){B.setAttribute("value",C[0].value);G.insertAdjacentElement("beforeEnd",B);}submitForm(G,true);}return false;}function makeSelections(){var B=getObj("dimtyAttributes");var C="";if(B){for(i=0;i<B.options.length;i++){if(B.options[i].value!="-none-"){if(i!=B.options.length-1){C+=B.options[i].value+unescape(UNIT_SEPARATOR);}else{C+=B.options[i].value;}}}var A=new Option("",C,false,true);B.options[B.length]=A;}}function goUpFolderLevel(A){makeSelections();processSelect(A);}function resizePromptContent(){if(typeof (microstrategy)=="undefined"){return ;}if(typeof (microstrategy.cancelPromptResize)!="undefined"){if(microstrategy.cancelPromptResize){return ;}}fitPromptContentToWindow(false);if(bIsFirefox){if(this.timer){window.clearTimeout(this.timer);}this.timer=window.setTimeout("fitPromptContentToWindow(true)",200);}return ;}function fitPromptContentToWindow(D){var B=getObj("mstrPromptsIndex");var E=getObj("mstrPromptsBody");var C=getObj("mstrPromptsButtonBarBottom");if(E){var A=getAvailablePromptHeight(E);if(A&&(!isNaN(A))){applyPromptHeight(E,B,C,A);}}return ;}function applyPromptHeight(I,A,G,E){var H=SCROLLBAR_SIZE*3;if(E<H){E=H;}var D=5;if(bIsIE4){G&&(G.style.visibility="hidden");}var C=0;if(A){var F=getObj("mstrPromptsRename");if(F){C=getObjOuterHeight(F);}A.style.height=(E-D*2)+"px";}if(I){I.style.height=(E-C-D*2)+"px";}var B=getObjOuterHeight(I.parentNode);adjustEnclosingTableHeight(B);if(bIsIE4){G.style.visibility="visible";}}function adjustEnclosingTableHeight(A){var B=getElementById("mstrWebContentTable");if(B){B.style.height=A+"px";}}function getAvailablePromptHeight(C){try{if(!C){return NaN;}var E=mstr.utils.BoxModel.getBrowserWindowHeight(document);var G=getObjOuterHeight(C);var A=getObjOuterHeight(C.parentNode);var D=getObjSumTop(C);var H=(bIsFirefox)?8:5;var B=E-D-(A-G)-H;return B;}catch(F){return null;}}function ToggleDrillButton(D,E){try{var A=getObj(D);var B=getObj(E);if((A!=null)&&(B!=null)){if((A.options.length==0)||((A.options.length==1)&&(A.options[0].value=="-none-"))){B.disabled=true;}else{B.disabled=false;}}}catch(C){return false;}return true;}function setTreeSearch(C,A){if(C==null){return ;}var B=searchPrefix;if(B==""){return ;}if(A>0){B=B+"_"+A;}var D=getObj(B);if(D){if(C.getAttribute("tp")=="12"&&C.getAttribute("searchLocked")!="1"){D.disabled=false;D.style.background="#ffffff";}else{D.disabled=true;D.style.background="#cccccc";}}}function clearTreeSearch(E,D){var I=getObj(util_getTreeName(E));var B=util_getChildNodeById(I,"main");B.style.display="block";var C=util_getChildNodeById(I,"search");var H=C.getAttribute("attId");var L=C.getAttribute("dimId");I.removeChild(C);var J=getObj("clearSearch_"+E);J.style.display="none";var A=searchPrefix;if(E>0){A=A+"_"+E;}var F=getObj(A);if(F){F.value="";}if(D){var G=attributeIdPrefix;if(E>0){G=G+"_"+E;}var K=dimensionIdPrefix;if(E>0){K=K+"_"+E;}D.href=replaceURLParameter(D.href,G,H);D.href=replaceURLParameter(D.href,K,L);util_submitForm(D);}return false;}function doTreeSearch(I,G){if(iframe.isTreeProcessing){event.returnValue=false;return ;}var M=getObj(util_getTreeName(I));var K=M.getElementsByTagName("LI");var L=null;if((K)&&(K.length)){var E=K.length;for(var H=0;H<E;H++){if(K[H].getAttribute("sel")=="1"){L=K[H];break;}}if(L&&L.getAttribute("tp")=="12"&&L.getAttribute("searchLocked")!="1"){var A=searchPrefix;if(I>0){A=A+"_"+I;}var J=getObj(A);if(J&&J.value.length>0){hideTreeWaitMessage();var F=util_getChildNodeById(M,"search");if(F){M.removeChild(F);}var B=util_findTargetTag(L,"DIV");var D=B.cloneNode(true);util_setTreeTargetState(D,NODE_STATE_OPEN);var P=util_createNode("UL","search");P.style.display="block";P.appendChild(D);P.setAttribute("attId",L.getAttribute("val"));P.setAttribute("dimId",L.getAttribute("dimensionId"));var C=util_getChildNodeById(M,"main");C.style.display="none";C.insertAdjacentElement("afterEnd",P);var N=getObj("clearSearch_"+I);N.style.display="block";showTreeWaitMessage(D,"afterEnd");var O=getBrowsePath(M,B);util_submitSearchForm(I,G,L.getAttribute("val"),L.getAttribute("dimensionId"),J.value,O);}}}}function appendBrowsePathForIncrementalFetch(B,A){var E=getObj(util_getTreeName(A));var G=browsePathPrefix;if(A>0){G=G+"_"+A;}var C=findAttributeForIncrementalFetch(B);if(C){var F=util_getAnchor(B);var D=getBrowsePath(E,C);if(D&&D.length>0){F.href+="&"+G+"="+encodeURIComponent(D);}}return true;}function appendBrowsePath(C,A){var E=getObj(util_getTreeName(A));if(util_shouldSubmitForm(C,E)){var G=browsePathPrefix;if(A>0){G=G+"_"+A;}var B=findAttributeForDrill(C);if(B){var D=getBrowsePath(E,B);if(D&&D.length>0){var F=util_getAnchor(C);F.href+="&"+G+"="+encodeURIComponent(D);}}}return true;}function findAttributeForIncrementalFetch(D){var A=null;var B=util_findTargetTag(D,"UL");if(B){if(B.parentNode.tagName=="div"||B.parentNode.tagName=="DIV"){var C=B.parentNode;if(C){A=C.previousSibling;}}else{if(B.parentNode.tagName=="UL"){A=B.previousSibling;}}}return A;}function findAttributeForDrill(B){var A=util_findTargetTag(B,"DIV");return A;}function getBrowsePath(E,C){var A=C.parentNode;var B="";while(A&&A.id!="main"&&A.id!="search"){var D=A.previousSibling;var F=getChildNodeValue(D);B=unescape(UNIT_SEPARATOR)+F+B;D=D.parentNode.previousSibling;F=getChildNodeValue(D);B=unescape(EXPRESSION_SEPARATOR)+F+B;A=D.parentNode;}return B.substr(1);}function getChildNodeValue(A){var B="";if(A&&A.childNodes.length){B=A.childNodes[0].getAttribute("val");}return B;}function util_submitSearchForm(G,B,D,C,P,K){var N=util_getNewTreeForm(B.href);if(N&&N.childNodes.length>0){var A=searchPrefix;if(G>0){A=A+"_"+G;}var I=attributeIdPrefix;if(G>0){I=I+"_"+G;}var M=dimensionIdPrefix;if(G>0){M=M+"_"+G;}var F=browsePathPrefix;if(G>0){F=F+"_"+G;}var O=matchCasePrefix;if(G>0){O=O+"_"+G;}var J=false;var H=null;for(var E=0;E<N.childNodes.length;E++){var L=N.childNodes[E];if(L.name==A){L.value=P;}if(L.name==I){L.value=D;}if(L.name==M){L.value=C;}if(L.name==F){L.value=K;}if(L.name==O){H=L;checkBoxNode=getObj(O);if(checkBoxNode&&checkBoxNode.checked==true){L.value="1";}else{J=true;}}}if(J==true){N.removeChild(H);}submitForm(N,true);}}function util_getChildNodeById(A,D){if((A)&&(A.childNodes.length)){for(var B=0;B<A.childNodes.length;B++){var C=A.childNodes[B];if(C.id==D){return C;}}}return null;}function util_createNode(A,C){var B=document.createElement(A);B.id=C;return B;}function changeHierarchyForTree(F,B){var D=getObj(util_getTreeName(B));if(D){hideTreeWaitMessage();var A=util_getChildNodeById(D,"main");if(A){D.removeChild(A);}var E=util_getChildNodeById(D,"search");if(E){D.removeChild(E);var H=getObj("clearSearch_"+B);H.style.display="none";var C=searchPrefix;if(B>0){C=C+"_"+B;}var G=getObj(C);if(G){G.value="";}}showTreeWaitMessage(D,"beforeEnd");submitChangeTreeHierarchyForm(F.options[F.selectedIndex].value,B,F.getAttribute("eventURL"));}}function submitChangeTreeHierarchyForm(B,A,D){var G=util_getNewTreeForm(D);if(G&&G.childNodes.length>0){var C=hierarchyPrefix;if(A>0){C=C+"_"+A;}for(var E=0;E<G.childNodes.length;E++){var F=G.childNodes[E];if(F.name==C){F.value=B;}}submitForm(G,true);}}function util_getTreeName(A){var B=TREE_NAME_PREFIX;if(A>0){B+="_"+A;}return B;}function promptSubmitSearchForEnterKey(B,A){var D=A||window.event;if(D!=null&&D.keyCode==13){var C=microstrategy.findChildWithAtt(B,"INPUT","type","image");if(C){C.click();}return false;}return true;}function isSameAttributeValue(D,C){var B=D.split(ITEM_SEPARATOR);var A=C.split(ITEM_SEPARATOR);return(B[0]==A[0]&&B[2]==A[2]);}function is24HourFormat(){var A=new Date();A.setTime(Date.parse("January, 01 2006 13:00:00"));var B=A.toLocaleString();return(B.indexOf("13")>=0);}function adjustTimeFormat(D,C){if(is24HourFormat()){var B=getObj(C);if(B!=null){B.style.display="";}}else{var A=getObj(D);if(A!=null){A.style.display="";}}}function MoveItemInListUp(A){MoveItemInList(A,-1);}function MoveItemInListDown(A){MoveItemInList(A,1);}function MoveItemInList(B,F){var G=getObj(B);var E=new Array();if(G){for(var D=0;D<G.options.length;D++){if(G.options[D].selected){if(D+F>=0&&G.options[D+F]){E[E.length]=G.options[D].text;var A=G.options[D].text;var C=G.options[D].value;G.options[D].text=G.options[D+F].text;G.options[D].value=G.options[D+F].value;G.options[D].selected=false;G.options[D+F].text=A;G.options[D+F].value=C;}}}for(D=0;D<G.options.length;D++){for(j=0;j<E.length;j++){if(E[j]==G.options[D].text){G.options[D].selected=true;}}}}}mstrPathImplScript=true;mstrPathImpl.prototype=new mstrBoneImpl();mstrPathImpl.prototype.commands=null;mstrPathImpl.prototype.openHistoryPageEvent="";mstrPathImpl.prototype.openHistoryPageEventID="";mstrPathImpl.prototype.openHistoryPageEventArgumentID="";mstrPathImpl.prototype.openHistoryPageEventArgumentName="";mstrPathImpl.prototype.pathSize=0;mstrPathImpl.PINNED_CLASS="pinned";mstrPathImpl.PADDING=23;mstrPathImpl.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.updateAccountButton();this.commands=new mstrPathCommandsImpl(this);this.onwinresize();}catch(A){microstrategy.errors.log(A);}};mstrPathImpl.prototype.updateAccountButton=function(){var D=document.getElementById("mstrPathAccount"),B=microstrategy.servletName,A;if(D){if(microstrategy.hasSession&&!mstrApp.isAdminPage&&D.getAttribute("_isstatic")!="true"){D.href="#";var C=microstrategy.menuHover?"mouseover":"click";D["on"+C]=microstrategy.showAccountSCList;}}};mstrPathImpl.prototype.onwinresize=function(){try{if(window.mstrInterfacePlugin){if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){return ;}var A=this.id;this.pathBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_path");this.footerBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_footer");if(!this.pathBar&&!this.footerBar){return ;}if(mstr.utils.ISIE8&&this.pathBar){this.pathBar.className=this.pathBar.className.replace(/ ie8/,"")+" ie8";}this.pathText=this.findChildByCssClass(this.elem,"mstrPathText");if(this.pathText){if(!this.pathBar){this.pathText.onclick=function(D){microstrategy.bone(A).pinPath(D);};}this.pathAncestor=this.findChildByCssClass(this.pathText,"mstrPathTextAncestors");this.pathCurrent=this.findChildByCssClass(this.pathText,"mstrPathTextCurrent");this.pathAncestors=this.findChildByCssClass(this.pathText,"mstrPathAncestors");this.pathBreadCrumbs=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbs");this.pathBreadCrumbsParent=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsParent","span");this.pathBreadCrumbsAncestors=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");}this.closeIcon=this.findChildByCssClass(this.footerBar,"mstrFooterPathClose","div");if(this.closeIcon){this.closeIcon.onclick=function(D){microstrategy.bone(A).toggleFooterPath(D);};}var C=this;if(this.pathBar&&this.pathText&&this.pathAncestors&&this.pathBreadCrumbs){this.neededWidth=C.getNeededWidth(),this.availableWidth=C.getAvailWidth();if(this.neededWidth<this.availableWidth){C.hideBreadCrumbs();}else{C.showBreadCrumbs();}}else{window.setTimeout(function(){C.resizePathBar();},10);}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getNeededWidth=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,B=this.pathAncestor,C=this.pathCurrent;if(A&&E&&B&&C){A.className=A.className.replace(" hidden","");if(!this.hasClass(E,"hidden")){E.className=E.className+" hidden";}return B.scrollWidth+C.scrollWidth+40;}else{return 0;}}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.hideBreadCrumbs=function(){try{var A=this.pathAncestors,D=this.pathBreadCrumbs,B=this.pathBreadCrumbsAncestors;A.className=A.className.replace(" hidden","");if(!this.hasClass(D,"hidden")){D.className=D.className+" hidden";}if(!this.hasClass(B,"hidden")){B.className=B.className+" hidden";}if(A&&D){this.resizePathBar();}}catch(C){microstrategy.errors.log(C);}};mstrPathImpl.prototype.showBreadCrumbs=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,C=this.pathBreadCrumbsAncestors;if(!this.hasClass(A,"hidden")){A.className=A.className+" hidden";}E.className=E.className.replace(" hidden","");if(!this.hasClass(C,"hidden")){C.className=C.className+" hidden";}this.resizeBreadCrumbs();C.style.left=mstr.$BM.position(E,true).left+"px";var B=this.id;E.onclick=function(F){microstrategy.bone(B).toggleBreadCrumbsSelector(F);};}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.toggleBreadCrumbsSelector=function(){try{var A=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");if(A){if(this.hasClass(A,"hidden")){A.className=A.className.replace(" hidden","");}else{A.className=A.className+" hidden";}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getAvailWidth=function(){try{this.pathText.style.maxWidth="0px";if(mstr.utils.ISIE8){this.pathText.style.display="none";}var K=mstr.utils.BoxModel,C=document.body.clientWidth,F=this.pathBar||this.footerBar,M=microstrategy.findChildWithAtt(F,"div","id","mstrSearchSuggest"),D=microstrategy.findChildWithAtt(F,"div","id","mstrPathAccount"),E=this.findChildByCssClass(F,"mstrFooterPathClose","div"),L=M||D||E,J=Math.min(L?K.position(L).left:C,C),I=this.findChildByCssClass(F,"mstrPathIcons"),B=0;if(I){var A=K.position(I),H=A.left+A.width,B=J-H-20;}if(mstr.utils.ISIE8){this.pathText.style.display="block";}return Math.max(B,0);}catch(G){microstrategy.errors.log(G);return 0;}};mstrPathImpl.prototype.resizePathBar=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,J=this.pathAncestor,H=this.getAvailWidth();if(D){D.style.maxWidth=H+"px";}if(J){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-15;this.curWidth=Math.min(this.pathSize/2,C.offsetWidth);var G=this.pathSize-this.curWidth;var I=parseInt(mstr.utils.CSS.getStyleValue(J,"padding-right")),F=J.scrollWidth+I,B=G>F?G-F:0;G-=B;this.curWidth+=B;J.style.maxWidth=Math.max(0,G)+"px";if((bIsDXIE)&&this.pathBar){J.style.marginLeft=-G-20+"px";}if(this.pathBar){C.style.maxWidth=Math.max(0,this.pathSize-(this.isPinned(D)?G:0))+"px";}else{C.style.maxWidth=Math.max(0,this.pathSize-G)+"px";}}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.resizeBreadCrumbs=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,G=this.pathBreadCrumbsParent,F=this.pathAncestor,H=this.availableWidth;if(D){D.style.maxWidth=H+"px";G.style.maxWidth=H+"px";C.style.maxWidth=H+"px";F.style.maxWidth=H+"px";}if(G){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-50;this.curWidth=Math.min(this.pathSize/2,C.scrollWidth);var I=this.pathSize-this.curWidth;var B=I>G.scrollWidth?I-G.scrollWidth:0;I-=B;G.style.maxWidth=Math.max(0,I)+"px";C.style.maxWidth=Math.max(0,this.pathSize-I)+"px";F.style.maxWidth=Math.max(0,I+31)+"px";}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.pinPath=function(){try{var E=" "+mstrPathImpl.PINNED_CLASS,B=this.pathText,D=this.pathAncestor,H=this.pathCurrent;if(D&&B&&this.pathBar){var C=this.isPinned(B),G=this.pathSize;if(C){B.className=B.className.replace(E,"");var A=microstrategy.bones;if(A.leftToolbar){A.leftToolbar.resize();}window.setTimeout(function(){H.style.maxWidth=G+"px";},(bIsDXIE?0:300));}else{B.className+=E;H.style.maxWidth=Math.max(0,this.curWidth)+"px";}}}catch(F){microstrategy.errors.log(F);}};mstrPathImpl.prototype.findChildByCssClass=function(F,A,D){try{if(!F){return null;}if(F.getElementsByClassName){return F.getElementsByClassName(A)[0];}else{var D=D||"div",G=new RegExp("(^|\\s)"+A+"(\\s|$)","i");if(F.tagName!=null&&F.tagName.toLowerCase()==D.toLowerCase()&&G.test(F.className)){return F;}var H=F.getElementsByTagName(D),C=H&&H.length;if(C){for(var B=0;B<C;B++){if(G.test(H[B].className)){return H[B];}}}return null;}}catch(E){microstrategy.errors.log(E);return null;}};mstrPathImpl.prototype.hasClass=function(B,A){try{return(" "+B.className+" ").indexOf(" "+A+" ")>-1;}catch(C){microstrategy.errors.log(C);return null;}};mstrPathImpl.prototype.isPinned=function(A){try{return this.hasClass(A,mstrPathImpl.PINNED_CLASS);}catch(B){microstrategy.errors.log(B);return null;}};mstrPathImpl.prototype.toggleFooterPath=function(){var C=document.getElementById("mstrWeb_footer");if(C){C.style.bottom="-41px";var B=this.id;window.setTimeout(function(){C.innerHTML="";microstrategy.unRegisterBone(B);microstrategy.eventManager.ondialogresize();},500);}var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,microstrategy.servletName+"."+microstrategy.pageName,mstrUpdateManager.actions[mstrUpdateManager.SET_PREFERENCE].paramID,["showFooterPath",0])]);};function mstrPathImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrPathCommandsImpl.prototype=new Object();mstrPathCommandsImpl.prototype.item=null;mstrPathCommandsImpl.prototype.queryEnabled=function(A){try{return true;}catch(B){microstrategy.errors.log(B);}};mstrPathCommandsImpl.prototype.queryState=function(A){try{switch(A){case"openPage":return this.item;default:microstrategy.errors.log(A+" command id not implemented.");break;}}catch(B){microstrategy.errors.log(B);}return null;};mstrPathCommandsImpl.prototype.exec=function(A,F){try{switch(A){case"openPage":var C=microstrategy.updateManager;if(C){mstrUpdateManager.addEvent({OPEN_HISTORY_PAGE:{p:[this.parentBone.openHistoryPageEventArgumentID],n:[this.parentBone.openHistoryPageEventArgumentName],i:this.parentBone.openHistoryPageEventID}});C.useIframe=false;var B=new Array();B.push(C.createActionObject(this.elem,mstrUpdateManager.OPEN_HISTORY_PAGE,microstrategy.servletName+"."+microstrategy.pageName,[this.parentBone.openHistoryPageEventArgumentID],[F]));C.add(B,true);C.flushAndSubmitChanges();}else{var D=createDynamicForm(this.parentBone.openHistoryPageEvent+F);D.method="POST";D.submit();}break;default:microstrategy.errors.log(values[0]+" command id not implemented.");break;}return true;}catch(E){microstrategy.errors.log(E);}};function mstrPathCommandsImpl(A){this.parentBone=A;return this;}mstrPickerImplScript=true;mstrPickerImpl.prototype=new mstrBoneImpl();mstrPickerImpl.prototype.pulldownName="";mstrPickerImpl.prototype.targetCombodown="";mstrPickerImpl.prototype.onload=function(){try{this.currentPicker=null;this.initPulldown();}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.initPulldown=function(){var C=new Function("e","return microstrategy.bone('"+this.id+"').togglePicker(e);");var B=document.getElementById(this.pulldownName);if(!B){return ;}for(var A=0;A<B.childNodes.length;A++){if(B.childNodes[A].tagName&&B.childNodes[A].tagName.toLowerCase()=="span"){B.childNodes[A].onclick=C;}}};mstrPickerImpl.prototype.execPicker=function(C,F){try{var E=true;var B=this.getAppliesTo();var G=F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!G){G=C.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);}var A=F.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!A){A=C.getAttribute(microstrategy.HTMLATTR_CMD_ID);}if(B&&A&&B.commands.queryEnabled(A)){E=B.commands.exec(A,G);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrPickerImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.togglePicker=function(E){try{if(!E){E=window.event;}var D=getEventTarget(E);var B="";if(D.getAttribute(microstrategy.HTMLATTR_CMD_ID)==null){this.targetCombodown=findTarget(D,microstrategy.HTMLATTR_CMD_ID);B=findTarget(D,microstrategy.HTMLATTR_CMD_ID).className;}else{B=D.className;}if(D&&B.indexOf("disabled")==-1){var F=D.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);if(!F){F=D.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);}var A=document.getElementById(F);if(D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){if(B.indexOf("Selected")==-1){this.targetCombodown.className="mstrCombodownSelected";}dropDown.togglePicker(true,F,D.parentNode,this);}else{this.execPicker(A,D);}}}catch(C){microstrategy.errors.log(C);}return false;};mstrPickerImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);this.targetCombodown.className="mstrCombodown";return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);alert(A);}};mstrPickerImpl.setPickerValues=function(D,F,G){try{if(D){D="pkr"+D;}var J=F.getElementsByTagName("span");for(var E=0,B=J.length;E<B;E++){var H=J[E];var I=true;if(G){I=microstrategy.isValueInFilter(G,H.getAttribute(microstrategy.HTMLATTR_FILTER_VALUE),H.getAttribute(microstrategy.HTMLATTR_FILTER_COMPARISON));var A=H.getAttribute(microstrategy.HTMLATTR_FILTER_TYPE);if(!A||A==0){H.style.display=(I)?"block":"none";}else{H.className=(I)?"":"disabled";}}if(I&&H.getAttribute("id")==D){H.className="selected";F.selected=H;}}}catch(C){microstrategy.errors.log(C);}};function mstrPickerImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}menuScript=true;var oSubCTimer=null;var oSubPkrTimer=null;var bIsOverContext=false;var bDisplayLeft=false;var sQuote="\\'";var sQuoteSimple="'";var sQuoteDouble='"';var aOndemandMenuItems=null;var aMenuItems=null;var aMenuItemsName;var sDrillContextMenuExtraArg1;var currentPicker=null;var specialMenuLayers=null;mstrMenuObj.prototype=new Object();function mstrMenuObj(A){}mstrMenuObj.adjustMenuPositionForClient=function(I,H,B,D){if(B.getAttribute("origHeight")){B.style.height=B.getAttribute("origHeight")+"px";}if(B.getAttribute("origWidth")){B.style.width=B.getAttribute("origWidth")+"px";}var F=B.getAttribute("ty")=="cxt";var J=getObjWidth(F?B.firstChild:B);if(J+I<getClientWidth()+getDocumentScrollLeft()){if(bDisplayLeft&&D){I=D-J+2;}else{bDisplayLeft=false;}}else{bDisplayLeft=true;if(D){I=D-J+2;}else{I=I-J+10;}}var A=getClientHeight();var C=getObjHeight(F?B.firstChild:B);var G=getDocumentScrollTop();var E=(H+C)-(G+A);if(C>A){H=G+1;if(E>0){if(!B.getAttribute("origHeight")){B.setAttribute("origHeight",C);}if(!B.getAttribute("origWidth")){B.setAttribute("origWidth",J);}if(!F){B.style.height=Math.min(C,A)+"px";B.style.width=Math.min(J,J+B.offsetWidth-B.clientWidth)+"px";B.style.overflowY="auto";}}}else{if(E>0){H=G+A-C-2;}}if(F){B.style.height=Math.min(C,A)+"px";B.style.width=Math.min(J,J+B.offsetWidth-B.clientWidth)+"px";if(B.offsetHeight<C){if(bIsIE7){B.style.overflow="auto";}else{B.style.overflowY="auto";}}}moveObjTo(B,I,H);};function displayContextMenu(oTarget,e,moveMenu){var sMenu=oTarget.getAttribute("CX");if(sMenu.length==0){return true;}var menuDefTarget=findTarget(oTarget,"CXID");var aMenuElementsName=menuDefTarget.getAttribute("CXID");var aMenuElements=microstrategy.getContextMenuManager(aMenuElementsName).menu_items;if(!aMenuElements||aMenuElements.length==0){return false;}var sDrillExtraArgument1=oTarget.getAttribute("D1");var types=oTarget.getAttribute("cxty");if(typeof (microstrategy)!="undefined"){microstrategy.updateActiveCXProps(oTarget,e);}hideContextMenus();getMouse(e);aMenuItems=aMenuElements;aMenuItemsName=aMenuElementsName;sDrillContextMenuExtraArg1=sDrillExtraArgument1;var avMenu=eval(sMenu);buildContextMenu(avMenu,1,eval(types),oTarget,false,null);if(hasMenuItem(avMenu,eval(types))){var menuX,menuY;if(moveMenu){var tID=oTarget.id;var menuX=getObjSumLeftScrolled(tID)+3;var menuY=getObjSumTopScrolled(tID)+getObjHeight(tID)+4;oTarget.onmouseout=function(){OutContext();};}else{menuX=lMouseX-microstrategy.CURSOR_OFFSET;menuY=lMouseY-microstrategy.CURSOR_OFFSET;}positionContextMenu(menuX,menuY,aMenuItemsName+"1");if(bIsIE4){togglePulldowns(getObj(aMenuItemsName+"1"),false);}document.getElementById(aMenuItemsName+"1").style.visibility="visible";microstrategy.setContextMenuStatus(true);}return false;}function isMenuShown(menuItem,selectedTypes){var supportedTypes=menuItem[5];var showJS=menuItem[6];var displayMenuItem=true;var __result=true;if(supportedTypes&&supportedTypes.length>0&&selectedTypes&&selectedTypes.length>0){var supportedTypesArray=eval(supportedTypes);__result=false;for(var j=0;j<selectedTypes.length;j++){for(var i=0;i<supportedTypesArray.length;i++){if(selectedTypes[j]==supportedTypesArray[i]){__result=true;break;}}if(__result){break;}}}if(showJS&&showJS.length>0&&__result==true){if(showJS=="$check-subMenu-existence$"){var subs=eval(menuItem[4]);var n=subs.length;if(n>0){for(var i=0;i<n;i++){var sub=aMenuItems[subs[i]];if(sub){__result=isMenuShown(sub,selectedTypes);if(__result){break;}}}}else{__result=false;}}else{__result=eval(showJS)?true:false;}}return __result;}function getPicker(D){var E=document.getElementsByName(D);var A=null;var C=document.body.childNodes;for(var B=0;B<C.length;B++){if(C[B].id==D){A=C[B];break;}}if(E){if(!A){while(E.length>1){E[0].parentNode.removeChild(E[0]);}A=document.body.appendChild(E[0]);}}return A;}function showPicker(A,E,H,G,F){var C=getPicker(E);if(C){if(A){currentPicker=C;var B=aMenuItemsName+F;var D=getElementById(B);if(D){C.style.zIndex=D.style.zIndex+100;}C.style.visibility="hidden";C.style.display="block";mstrMenuObj.adjustMenuPositionForClient(H,G,C);if(bDisplayLeft){C.style.left=parseInt(C.style.left,10)-getObjWidth(D)+"px";}C.style.visibility="visible";}else{C.style.display="none";currentPicker=null;}}}function buildContextMenuRows(avItems,iMenu,types,oTarget,loadOndemandMenuItems,modelID){var sContent="";var lRowCount=0;var sRowID="";var sSubCommand="";var sOnClickLink="";var hasMenuItem=false;var enabled=true;if(!oTarget){oTarget=microstrategy.activeCXMenu;}var aMenuItemsLocal=null;if(loadOndemandMenuItems){aMenuItemsLocal=aOndemandMenuItems;lRowCount=getNumTagsInDiv(aMenuItemsName+iMenu,"tr");}else{aMenuItemsLocal=aMenuItems;}for(var iIndex=0;iIndex<avItems.length;iIndex++){if(aMenuItemsLocal[avItems[iIndex]][3]!=2){if(isMenuShown(aMenuItemsLocal[avItems[iIndex]],types)){hasMenuItem=true;var menuClass="menu-item";var menuClassWithSeparator="menu-item-with-separator";var separatorClass="menu-item-separator";enabled=true;var enableJS=aMenuItemsLocal[avItems[iIndex]][7];if(enableJS&&enableJS.length>0){enabled=eval(enableJS);}if(!enabled||aMenuItemsLocal[avItems[iIndex]][8]==1){menuClass="menu-item-disabled";menuClassWithSeparator="menu-item-disabled-with-separator";}sRowID="cm"+iMenu+"r"+lRowCount;sContent+='<TR ID="'+sRowID+'" HEIGHT="18" AC="true" ';var cmd=aMenuItemsLocal[avItems[iIndex]][1];if(menuClass=="menu-item"){cmd=replacePlaceholders(cmd,oTarget);if(aMenuItemsLocal[avItems[iIndex]][3]==1){var typesString=convertArrayToString(types);if(aMenuItemsLocal[avItems[iIndex]][10]!=null){var ondemandModelId=aMenuItemsLocal[avItems[iIndex]][10];var ondemandDynamicMenuKey=aMenuItemsLocal[avItems[iIndex]][11];var ondemandViewId=aMenuItemsLocal[avItems[iIndex]][12];sSubCommand="buildSubMenu("+aMenuItemsLocal[avItems[iIndex]][4]+", "+(iMenu+1)+", getObjSumTop("+sQuote+sRowID+sQuote+"), ["+typesString+"], "+loadOndemandMenuItems+", "+sQuote+ondemandModelId+sQuote+", "+sQuote+ondemandDynamicMenuKey+sQuote+", "+sQuote+ondemandViewId+sQuote+" );";}else{sSubCommand="buildSubMenu("+aMenuItemsLocal[avItems[iIndex]][4]+", "+(iMenu+1)+", getObjSumTopScrolled("+sQuote+sRowID+sQuote+"), ["+typesString+"], "+loadOndemandMenuItems+");";}sContent+="onMouseOver=\"clearTimeout(oSubCTimer); delaySubCMenus('"+sSubCommand+"'); menuOn(this);\" ";sContent+='onMouseOut="menuOff(this);" LI="sub" ';}else{if(aMenuItemsLocal[avItems[iIndex]][3]==3){sSubCommand="hideContextSubMenus("+iMenu+"); showPicker(true,"+sQuote+aMenuItemsLocal[avItems[iIndex]][4]+sQuote+",getObjWidth("+sQuote+sRowID+sQuote+") + getObjSumLeft("+sQuote+sRowID+sQuote+"), getObjSumTop("+sQuote+sRowID+sQuote+"),"+iMenu+");";sContent+="onMouseOver=\"clearTimeout(oSubCTimer); delaySubCMenus('"+sSubCommand+"'); menuOn(this);\"";sContent+='onMouseOut="menuOff(this);"';var pkr=getPicker(aMenuItemsLocal[avItems[iIndex]][4]);if(pkr){pkr.onmouseover=new Function("clearTimeout(oSubPkrTimer);");pkr.onmouseout=new Function("OutContext();");pkr.onmousedown=new Function("e","if (!e) {e=window.event;} eval("+cmd+");OutContext();");}}else{sContent+='onMouseOver="clearTimeout(oSubCTimer); menuOn(this);';sContent+=" hideContextSubMenus("+iMenu+");";sContent+='" onMouseOut="menuOff(this);" ';sOnClickLink=cmd;if(sOnClickLink.indexOf("DCM")!=-1){if(sDrillContextMenuExtraArg1==null){sOnClickLink=sOnClickLink.substr(0,sOnClickLink.indexOf(")"))+",'')";}else{sOnClickLink=sOnClickLink.substr(0,sOnClickLink.indexOf(")"))+",'"+sDrillContextMenuExtraArg1+"')";}}sContent+="onClick=\"menuClick(this, '"+aMenuItemsName+iMenu+'\');" LI="'+sOnClickLink+';" ';}}if(bIsW3C){sContent+='STYLE="cursor: pointer;"';}else{sContent+='STYLE="cursor: hand;"';}}var isNextMenuOptionASeparator=isNextMenuSeparator(aMenuItemsLocal,avItems,iIndex,types);sContent+=">\n";sContent+='<TD WIDTH="12" ALIGN="MIDDLE" CLASS="mstrContextMenuLeft"';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+=">";switch(aMenuItemsLocal[avItems[iIndex]][2]){case 0:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 1:var showCheck=true;var checkJS=aMenuItemsLocal[avItems[iIndex]][9];if(checkJS&&checkJS.length>0){showCheck=eval(checkJS);}if(showCheck){sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuCheck.gif" WIDTH="12" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';}break;case 2:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'CMenuRemove.gif" WIDTH="11" HEIGHT="11" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" /><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="1" HEIGHT="1" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 3:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'CMenuSubtotal.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 4:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillUp.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 5:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillDown.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 6:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillTemplate.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 7:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'drill.png" WIDTH="16" HEIGHT="16" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 8:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'treeLoading.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;}sContent+="</TD>";sContent+='<TD WIDTH="1"';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+='><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"></TD>';sContent+='<TD ALIGN="LEFT" NOWRAP="1" ';if(isNextMenuOptionASeparator){sContent+=" class="+menuClassWithSeparator+" ";}else{sContent+=" class="+menuClass+" ";}sContent+=">"+aMenuItemsLocal[avItems[iIndex]][0]+"&nbsp;&nbsp;<BR/></TD>";sContent+='<TD WIDTH="12" ALIGN="RIGHT" NOWRAP="1" ';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+=">";if(aMenuItemsLocal[avItems[iIndex]][3]==1||aMenuItemsLocal[avItems[iIndex]][3]==3){var expandImage=enabled?"MenuExpand.gif":"MenuExpand_off.gif";sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+expandImage+'" WIDTH="8" HEIGHT="9" ALT="" BORDER="0" /><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="2" HEIGHT="1" ALT="0" BORDER="0" />';}else{sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" ALT="0" BORDER="0" />';}sContent+="</TD></TR>\n";lRowCount++;}}}return sContent;}function replacePlaceholders(str,oTarget){var matched=false;var tempStr=str;if(tempStr.indexOf("%40")>-1){tempStr=unescape(tempStr);}if(tempStr.indexOf("@")>-1){tempStr=tempStr.replace(/@[^@]+@/g,function(token){matched=true;var attName=token.substring(1,token.length-1);if(attName.indexOf("__bone__")>-1){attName=attName.replace("__bone__","microstrategy.findBone(microstrategy.activeCXMenu)");return eval(attName);}else{return oTarget.getAttribute(attName)||"";}});}if(matched){return tempStr;}else{return str;}}function isNextMenuSeparator(E,A,D,C){for(var B=D+1;B<A.length;B++){if(isMenuShown(E[A[B]],C)){return(E[A[B]][3]==2);}}return false;}function getMenuDiv(B){var A=getObj(B);if(!A){A=document.createElement("DIV");A.setAttribute("id",B);A.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_CONTEXT_MENU);A.onmouseover=OverContext;A.onmouseout=OutContext;A.style.visibility="hidden";A.style.position="absolute";A.style.backgroundColor="#FFFFFF";A.style.border="1px #ddd solid";A.style.top="-999px";document.body.appendChild(A);}return A;}function buildContextMenu(B,H,E,C,F,G){var D="";D='<TABLE BORDER="0" CELLSPACING="0" CLASS="mstrContextMenuRight">\n';D+=buildContextMenuRows(B,H,E,C,F,G);D+="</TABLE>";var A=getMenuDiv(aMenuItemsName+H);A.innerHTML=D;}function hasMenuItem(A,B){for(var C=0;C<A.length;C++){if(aMenuItems[A[C]][3]!=2){if(isMenuShown(aMenuItems[A[C]],B)){return true;}}}return false;}function upClick(C){if(bIsW3C&&!C){return false;}var B=(bIsIE4)?(event.button==2||event.button==3):(C.button==3);if(B){var A=getEventTarget(C);A=findTarget(A,"CX");if(A){document.onmouseup=null;return false;}}}function OverContext(){bIsOverContext=true;}function OutContext(){clearTimeout(oSubCTimer);bIsOverContext=false;}function hideContextMenus(){if(typeof (aMenuItemsName)=="undefined"){return ;}if(!bIsOverContext){hideContextSubMenus(1);var A=getObj(aMenuItemsName+"1");if(A){A.style.visibility="hidden";A.style.top="-999px";microstrategy.setContextMenuStatus(false);A.innerHTML="";}if(bIsIE4){togglePulldowns(A,true);}}}function hideContextSubMenus(C){var B=1;for(var B=4;B>C;B--){var A=getObj(aMenuItemsName+B);if(A){A.style.visibility="hidden";A.innerHTML="";if(bIsIE4){togglePulldowns(A,true);}}}if(currentPicker!=null){currentPicker.style.display="none";currentPicker=null;}}function buildSubMenu(C,D,K,H,F,B,L,A){var G=aMenuItemsName+D;var I=getMenuDiv(G);I.modelID=B;if(bIsIE4){I.style.height="auto";I.style.width="auto";I.style.overflowY="visible";}I.style.zIndex=1000;buildContextMenu(C,D,H,null,F,B);addOndemandSubMenuItems(B,L,A,D);if(I.childNodes.length==0){return ;}var E=getObjLeft(aMenuItemsName+(D-1));var J=getObjWidth(aMenuItemsName+(D-1));positionContextMenu(E+J-2,K,G,E);if(bIsIE4){togglePulldowns(getObj(aMenuItemsName+D),false);}hideContextSubMenus(D);document.getElementById(aMenuItemsName+D).style.visibility="visible";}function delaySubCMenus(sExecuteText){clearTimeout(oSubCTimer);if(sExecuteText.length>0){if(bIsInPortal&&mstr.utils.ISFF3){eval(sExecuteText);}else{oSubCTimer=window.setTimeout(sExecuteText,250);}}}function positionContextMenu(E,C,D,B){if(bIsIE4){var A=D;if(typeof (A)=="string"){A=document.getElementById(D);}if(A){A.style.height="auto";A.style.width="auto";A.style.overflowY="visible";}}var A=getObj(D);A.style.zIndex=1000;mstrMenuObj.adjustMenuPositionForClient(E,C,A,B);}function generateLink(A){A+="&innerWidth="+getClientWidth()+"&innerHeight="+getClientHeight();return A;}function submitCM(D,B,E){if(B){D=D+"&iframe=true";}var A=true;if(microstrategy&&microstrategy.eventManager){A=microstrategy.eventManager.notifyOrphanBones("onmenusubmitform");}if(A){var C=createDynamicForm(D);if(B){C.target="frameManager";}if(E!=null){C.target=E;}}submitForm(C);}dropDownMenusScript=true;var oTimer=null;var bIsOver=false;var oSubTimer=null;var bMenuOpen=false;var bCompleted=false;var asBranch=new Array();var nBranchElements=0;var bClickStyle=false;function activateHeader(F,E,D){for(var B=0;B<iMainMenus;B++){var A=getObj("menuHeader"+B);if(A){var C=A.getAttribute("E")=="0";if(!C){if(B==F){A.className=E;}else{A.className=D;}}}}}function fixMenus(A){var B;for(i=0;i<A.length;i++){B=getObj(A[i][1]);if(B){B.setAttribute(A[i][2],A[i][3]);}}B=B=getObj("mb"+A[0][0]);if(B){B.setAttribute("C","0");}}function updateCheckedAndEnabledOptions(menuName){var menu=getObj(menuName);var TABLEs=menu.getElementsByTagName("TABLE");TABLEs[0].className="menu-block";var TRs=TABLEs[0].getElementsByTagName("TR");var menuUpdated=false;var newValue;var wasChecked;var wasEnabled;var wasShown;var baseBone;for(i=0;i<TRs.length;i++){baseBone=TRs[i].getAttribute("BB");wasChecked=TRs[i].getAttribute("H");wasEnabled=TRs[i].getAttribute("E");wasShown=(TRs[i].style.display!="none");if(baseBone&&baseBone.length>0&&!(microstrategy&&microstrategy.bone(baseBone))){continue;}var auxStr=TRs[i].getAttribute("DS");if(auxStr&&auxStr.length>0){newValue=eval(auxStr);if(newValue!=wasShown){menuUpdated=true;if(newValue){TRs[i].style.display="";}else{TRs[i].style.display="none";continue;}}}var auxStr=TRs[i].getAttribute("DC");if(auxStr&&auxStr.length>0){newValue=eval(auxStr)?"1":"0";if(newValue!=wasChecked){TRs[i].setAttribute("H",newValue);menuUpdated=true;}}auxStr=TRs[i].getAttribute("DE");if(auxStr&&auxStr.length>0){newValue=eval(auxStr)?"1":"0";if(newValue!=wasEnabled){TRs[i].setAttribute("E",newValue);menuUpdated=true;}}}if(menuUpdated){menu.setAttribute("C","0");}}function completeMenu(A){var E;var C;var F=getObj(A);var D=F.getElementsByTagName("TABLE");D[0].className="menu-block";var B=D[0].getElementsByTagName("TD");for(i=0;i<B.length;i++){if(B[i].id=="blank"){B[i].width="1";B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="1" HEIGTH="1">';}else{if(B[i].id=="mnI"){B[i].align="middle";if(B[i].parentNode.getAttribute("E")=="1"){B[i].className="menu-item-image";}else{B[i].className="menu-item-image-disabled";}if(B[i].parentNode.getAttribute("H")=="1"){B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuCheck.gif" style="width:12px;height:9px;">';}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif">';}}else{if(B[i].id=="mnT"||B[i].id=="mnS"){B[i].noWrap=true;C=(B[i].parentNode.getAttribute("E")=="1");if(C){B[i].className="menu-item";}else{B[i].className="menu-item-disabled";}if(B[i].parentNode.getAttribute("AS")=="1"){if(C){B[i].className="menu-top-separator";}else{B[i].className="menu-top-separator-disabled";}}}else{if(B[i].id=="mnE"){B[i].width="12";B[i].align="right";C=(B[i].parentNode.getAttribute("E")=="1");if(B[i].parentNode.getAttribute("AS")=="1"){if(C){B[i].className="menu-top-separator";}else{B[i].className="menu-top-separator-disabled";}}if(B[i].parentNode.getAttribute("SB")=="1"){if(C){B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuExpand.gif" WIDTH="8" HEIGTH="9">';}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuExpand_off.gif" WIDTH="8" HEIGTH="9">';}}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGTH="10">';}}}}}}F.setAttribute("C","1");bCompleted=true;}function ShowLayer(G,E){if(oTimer){clearTimeout(oTimer);}HideAllLayers();if(isNaN(G)){if(specialMenuLayers==null){specialMenuLayers=[];}specialMenuLayers.push(G);}var F=getObj("mb"+G);if(F.getAttribute("C")!="1"){completeMenu("mb"+G);}var B=(E)?E:("menuHeader"+G);var C=getObjSumTop(B)+getObjHeight(B);var D=getObjSumLeftScrolled(B);var A=getObj("mb"+G);A.style.zIndex=1000;positionContextMenu(D,C,A);if(bIsIE4){togglePulldowns(A,false);}asBranch[0]="mb"+G;nBranchElements=1;A.style.visibility="visible";bMenuOpen=true;}function hidePopupMenus(A){hideContextMenus();if(A||(bClickStyle&&bMenuOpen)){UnselectAllLayers();}}function UnselectAllLayers(){if(!bIsOver&&typeof (iMainMenus)!="undefined"){HideAllLayers();var B;for(var A=0;A<iMainMenus;A++){B=getObj("menuHeader"+A);if(B){if(B.getAttribute("E")=="0"){B.className=mstrMenuDisabledClass;}else{B.className=mstrMenuEnabledClass;}}}bMenuOpen=false;}}function HideAllLayers(){nBranchElements=0;if(!bIsOver&&typeof (iSubMenus)!="undefined"){for(var A=0;A<iSubMenus;A++){var B=document.getElementById("mb"+A);if(B){B.style.visibility="hidden";}}if(specialMenuLayers!=null){for(var A=0;A<=specialMenuLayers.length;A++){document.getElementById("mb"+specialMenuLayers[A]).style.visibility="hidden";}specialMenuLayers=null;}if(bIsIE4){togglePulldowns(null,true);}}bMenuOpen=false;}function OverLayer(){if(oTimer){clearTimeout(oTimer);}bIsOver=true;}function OutLayer(){if(oTimer){clearTimeout(oTimer);}bIsOver=false;if(!bClickStyle){oTimer=setTimeout("UnselectAllLayers()",300);}}function hideSubMenu(F,C,B){var E=false;var A=0;for(i=0;i<nBranchElements;i++){if(E){var D=document.getElementById(asBranch[i]);if(D){if(bIsIE4){togglePulldowns(D,true);}D.style.visibility="hidden";}asBranch[i]=0;}if(asBranch[i]==C){E=true;A=i+1;}}nBranchElements=A+1;asBranch[nBranchElements-1]=F;}function menuOn(A){if(A.className!="menuDisabled"){A.className="menu-row-selected";}}function menuOff(A){if(A.className!="menuDisabled"){A.className="menu-row";}}function menuClick(oMenuItem,sMenu){var oMenu=typeof (sMenu)=="string"?document.getElementById(sMenu):sMenu;if(oMenu.modelID){var model=mstr.$obj(oMenu.modelID);if(model){var state=model.get("readyState");if(state&&state===mstr.Enum.Widget.READYSTATE.WAITING){return ;}}}if(oMenuItem.className!="menuDisabled"){if(oMenuItem.getAttribute("AC")=="true"){var sLink=oMenuItem.getAttribute("LI");if(sLink.length>0){bIsOverContext=false;oMenu.style.visibility="hidden";hideContextMenus();window.mstrSubmitLink=true;eval(sLink);}}else{bIsOverContext=false;oMenu.style.visibility="hidden";HideAllLayers();hideContextMenus();}}}function onCl(A){onMv(A);ShowLayer(A.getAttribute("ndx"));}function onMv(C){var B=C.getAttribute("E")=="0";var A=C.getAttribute("ndx");updateCheckedAndEnabledOptions("mb"+A);if(getObj("mb"+A).getAttribute("C")!="1"){completeMenu("mb"+A);}if(!B){if(bMenuOpen){activateHeader(A,"menu-header-selected","menu-header");ShowLayer(A);}else{activateHeader(A,"menu-header-selected","menu-header");}}}function onMo(B){var A=B.getAttribute("E")=="0";if(!A){if(!bMenuOpen){B.className="menu-header";}else{OutLayer("menu-header","menu-header-disabled");}}}function convertArrayToString(A){var C="";if(A){for(var B=0;B<A.length;B++){if(A[B]){C=C+sQuote+A[B]+sQuote+", ";}else{C=C+"null, ";}}C=C.substr(0,C.length-2);}return C;}function buildWidgetSubMenu(C,J,Q,D){completeMenu(C);if(!D){D="currentControl";}var P=getObj(C);var L=P.getElementsByTagName("tbody")[0];var I=L.firstChild;var M=I.getAttribute("id");M=M.substr(0,M.length-1);var K=microstrategy.getViewerBone().widgets;var G=false;if(K){if(L.hasChildNodes()){for(var F=L.childNodes.length-1;F>=0;F--){if(J||L.childNodes[F].getAttribute("dyn_menu")){L.removeChild(L.childNodes[F]);}}}G=!J&&L.hasChildNodes();var E=false;for(var F=0;F<K.length;F++){var O=K[F];if(!Q||Q==O.scope){var B=I.getAttribute("id");var H=I.cloneNode(true);H.setAttribute("id",M+F);H.setAttribute("dyn_menu",true);H.className="ctrl"+O.tbClass;if(!E&&G){H.setAttribute("AS",1);E=true;}var N=microstrategy.SUBOBJTYPE_DOC_WIDGET+"|"+O.fqcn+";"+O.rslPath+";"+O.title+";"+O.previewImage+";"+O.isApp+";"+O.scope+";"+O.defaultDHTMLStyle;var A="microstrategy.bone('rwb_viewer').commands.exec('"+D+"', '"+N+"');";if(D=="currentControl"){A+="microstrategy.eventManager.notifyOrphanBones('requestCurrentControlChange', '"+N+"');";}H.setAttribute("JS",A);H.childNodes[2].innerHTML=O.title;L.appendChild(H);}}completeMenu(C);}}function addOndemandSubMenuItems(G,C,E,H){if(G){var B=mstr.$obj(G);if(!B){return ;}var A=mstr.$obj(E);if(C){B.setCurrentDynamicMenuKey(C);}var D="";if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){D="Report";}else{var F=microstrategy.findBone(microstrategy.activeCXMenu);D=F.objId;}B.setGridKey(D);A.setMenuLevel(H);A.setModel(B);B.execPopulate();}}function addDynamicMenus(E,D,B){setOndemandMenuItems(D);var C=buildContextMenuRows(B,E,null,null,true,null);var A=getMenuDiv(aMenuItemsName+E);if(C==""){if(A.childNodes[0].rows&&A.childNodes[0].rows.length==0){hideContextSubMenus(E-1);}}else{addToExistingDivTable(A,C);mstrMenuObj.adjustMenuPositionForClient(parseInt(A.style.left,10),parseInt(A.style.top,10),A);}}function addToExistingDivTable(E,C){var B=document.createElement("div");B.innerHTML="<TABLE>"+C+"</TABLE>\n";var D=B.childNodes[0];var A=E.childNodes[0];if(A!=null&&(A.tBodies==null||A.tBodies.length==0)){A.appendChild(document.createElement("tbody"));}while(D.rows.length>0&&(A!=undefined)){A.tBodies[0].appendChild(D.rows[0]);}}function getNumTagsInDiv(C,B){var D=getObj(C);var A=D.getElementsByTagName(B);if(A!=null){return A.length;}else{return 0;}}function setOndemandMenuItems(A){aOndemandMenuItems=A;}function removeProcessingMenuItem(D){var A=getMenuDiv(aMenuItemsName+D);var C=A.getElementsByTagName("tr");if(C!=null){var B=0;while(B<C.length){if(C[B]!=null&&"processing"==C[B].getAttribute("id")){C[B].parentNode.removeChild(C[B]);}B++;}}}function addProcessingMenuItem(E){var B=microstrategy.descriptors.getDescriptor("2901");var C="";var D="menu-item";C+='<TR ID="processing" name="processing" HEIGHT="18" AC="true" ';C+='onMouseOver="clearTimeout(oSubCTimer); menuOn(this);';C+=" hideContextSubMenus("+E+");";C+='" onMouseOut="menuOff(this);" ';if(bIsW3C){C+='STYLE="cursor: pointer;"';}else{C+='STYLE="cursor: hand;"';}C+=">\n";C+='<TD WIDTH="12" ALIGN="MIDDLE" CLASS="mstrContextMenuLeft">';C+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'treeLoading.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';C+="</TD>";C+='<TD WIDTH="1"><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"></TD>';C+='<TD ALIGN="LEFT" NOWRAP="1" ';C+=" class="+D+" ";C+=">"+B+"&nbsp;&nbsp;<BR/></TD>";C+='<TD WIDTH="12" ALIGN="RIGHT" NOWRAP="1" ';C+=">";C+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" ALT="0" BORDER="0" />';C+="</TD>";C+="</TR>";var A=getMenuDiv(aMenuItemsName+E);addToExistingDivTable(A,C);}mstrContextMenuManagerImpl.prototype=new Object();contextMenuManagerScript=true;mstrContextMenuManagerImpl.prototype.id=null;mstrContextMenuManagerImpl.prototype.dynamic_menus=new Array;mstrContextMenuManagerImpl.prototype.menu_items=new Array;microstrategy.contextMenuManagers=new Array;microstrategy.unloadContextMenuManager=function(B){for(var A=0;A<microstrategy.contextMenuManagers.length;A++){if(microstrategy.contextMenuManagers[A].id==B){microstrategy.contextMenuManagers.splice(A,1);}}};microstrategy.getContextMenuManager=function(B){for(var A=0;A<microstrategy.contextMenuManagers.length;A++){if(microstrategy.contextMenuManagers[A].id==B){return microstrategy.contextMenuManagers[A];}}var C=new mstrContextMenuManagerImpl(B);microstrategy.contextMenuManagers.push(C);return C;};mstrContextMenuManagerImpl.prototype.getMenu=function(D){var C,A;try{if(D){for(C=0;C<this.dynamic_menus.length;C++){if(this.dynamic_menus[C]!=null){if(this.dynamic_menus[C][0]==D){return new mstrContextMenuImpl(this.id,this.menu_items,this.dynamic_menus[C][1]);}}}}var B=this.dynamic_menus.length;this.dynamic_menus[B]=new Array;this.dynamic_menus[B][0]=D;this.dynamic_menus[B][1]=new Array;return new mstrContextMenuImpl(this.id,this.menu_items,this.dynamic_menus[B][1]);}catch(E){microstrategy.errors.log(E);return false;}};mstrContextMenuManagerImpl.prototype.findMenuItem=function(C,B){try{var A=new Array();if(B!=null){for(i=0;i<B.length;i++){if(this.menu_items[B[i]][0]==C){A.push(this.menu_items[B[i]]);}}}else{for(i=0;i<this.menu_items.length;i++){if(this.menu_items[i][0]==C){A.push(this.menu_items[i]);}}}return A;}catch(D){microstrategy.errors.log(D);return false;}};function mstrContextMenuManagerImpl(key){try{if(key){if(eval("(typeof("+key+") != 'undefined')")){this.menu_items=eval(key);}if(eval("(typeof("+key+"_dyn) != 'undefined')")){this.dynamic_menus=eval(key+"_dyn");}this.id=key;}return this;}catch(err){microstrategy.errors.log(err);return false;}}mstrContextMenuImpl.prototype=new Object();contextMenuScript=true;mstrContextMenuImpl.prototype.cmm_id=null;mstrContextMenuImpl.prototype.cmm_items=null;mstrContextMenuImpl.prototype.menu_items=null;mstrContextMenuImpl.prototype.length=0;mstrContextMenuImpl.IMG_EMPTY=0;mstrContextMenuImpl.IMG_CHECK=1;mstrContextMenuImpl.IMG_REMOVE=2;mstrContextMenuImpl.IMG_SUBTOTAL=3;mstrContextMenuImpl.IMG_DRILL_UP=4;mstrContextMenuImpl.IMG_DRILL_DOWN=5;mstrContextMenuImpl.IMG_DRILL_TEMPLATE=6;mstrContextMenuImpl.IMG_DRILL=7;mstrContextMenuImpl.IMG_LOADING=8;mstrContextMenuImpl.prototype.addItem=function(B,C,E,A,G){try{var F;if(!E){E=1;}if(!A){A=1;}if(!G){G=mstrContextMenuImpl.IMG_EMPTY;}if(typeof (C)=="string"){F=new Array(B,C,G,0,"","",A,E);}else{F=new Array(B,"",G,1,"["+C.menu_items.toString()+"]","",A,E);}return this.addItemDefinition(F);}catch(D){microstrategy.errors.log(D);return false;}};mstrContextMenuImpl.prototype.addSeparator=function(){try{var B=new Array("-","",0,2,"",1,1);return this.addItemDefinition(B);}catch(A){microstrategy.errors.log(A);return false;}};mstrContextMenuImpl.prototype.addItemDefinition=function(B){try{this.cmm_items.push(B);this.menu_items.push(this.cmm_items.length-1);this.length=this.menu_items.length;return B;}catch(A){microstrategy.errors.log(A);return false;}};mstrContextMenuImpl.prototype.registerTrigger=function(A,B){try{if(A){A.setAttribute("cx","["+this.menu_items.toString()+"]");A.setAttribute("cxid",this.cmm_id);if(B){A.setAttribute("cxty",B);}}return true;}catch(C){microstrategy.errors.log(C);return false;}};function mstrContextMenuImpl(A,C,B){this.cmm_id=A;this.cmm_items=C;this.menu_items=B;return this;}
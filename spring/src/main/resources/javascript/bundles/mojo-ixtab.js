mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"],BG:["background-color","fx"],RW:[]};J.RW=["z-index"].concat(J.T.concat(J.D));var D=mstrmojo.dom,O=mstrmojo.css;function N(T,V,S){var U=T[V]||[];U.push(S);T[V]=U;}function L(W,V){var U=((W&&W.fmts)||null);if(V){var Y=W.thresholds,T=Y&&Y[V];if(T){var X={},Z;for(Z in U){X[Z]=T[Z]||U[Z];}for(Z in T){var S=T[Z];X[Z]=(typeof S==="string")?(S+" !important"):S;}U=X;}}return U;}mstrmojo._Formattable=mstrmojo.provide("mstrmojo._Formattable",{_mixinName:"mstrmojo._Formattable",formatHandlers:null,thresholdId:null,getCacheKey:function E(){return"css_cache"+(this.thresholdId||"");},update:function G(T){var S=true;this.invisible=!!(T&&T.data&&T.data.invisible);if(this._super){S=this._super(T);}return S;},buildCSSFormatString:function H(U,d){var h=this.formatHandlers[U],k=h.src?d[h.src]:d;if(!k){return null;}var b=h.props||h;if(!b){return null;}var X=[],g=-1;var V=b.length-1;for(V;V>=0;V--){var j=b[V];var c=J[j]||[j];var a=c.length-1;for(a;a>=0;a--){j=c[a];var T=k[j];if(T!==undefined){if(j==="fx"){var Y=T,S={};var e=Y.gd;if(e){this.formatGradient(e,S);}var W=parseInt(Y.rt,10);if(W){if(W===1||W===3){this.formatTextRotation(Y.rt,S);}}if(Y.ds){this.formatDropShadow(Y,S);}var Z;for(Z in S){X[++g]=Z+":"+S[Z].join(" ");}}else{X[++g]=j+":"+T;}}}}if(this.invisible){X.push("visibility:hidden");}return X.join(";")+";";},applyCSSFormatToNode:function I(U,S){var V=this[U],T=V&&V.style;if(T){this.buildCSSFormatString(U,S).split(";").forEach(function(W){var X=W.split(":");T[O.convertCssToCamelCase(X[0])]=X[1];});}},clearSlotBackgroundCSS:function F(T){var U=this[T],S=U&&U.style;if(S){S.background="transparent none 0 0 no-repeat";S.filter="none";}},preBuildRendering:function B(){this._super();var V=this.formatHandlers,S=this.getFormats();if(V&&S){var W=this.defn=this.defn||{},X=this.getCacheKey(),U=W[X];if(!U){U=W[X]={};for(var T in V){var Z=T+"CssText";this[Z]=U[Z]=this.buildCSSFormatString(T,S)||"";}}else{var Y;for(Y in U){this[Y]=U[Y];}}}return true;},formatGradient:function P(S,U){var T=O.buildGradient(S.t,S.sc,S.ec);if(T){N(U,T.n,T.v);}},formatDropShadow:function K(W,U){if(D.supports(D.cssFeatures.DROP_SHADOW)){var V=W.ds;if(D.isDXIE){N(U,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+V+",OffY="+V+")");}else{var S=[V,V],T=parseInt(W.rt,10);if(T===1||T===3){S[((T===1)?1:0)]=-V;}N(U,(D.isWK?"-webkit-":"")+"box-shadow",S.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function C(T,S){if(D.supports(D.cssFeatures.TEXT_ROTATION)){if(D.isDXIE){N(S,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+T+")");}else{var U=(T===1)?90:-90;N(S,D.CSS3_PREFIX+"transform-origin","top left");N(S,D.CSS3_PREFIX+"transform","rotate("+U+"deg)");}}},getFormats:function R(){if(!this.fmts){this.fmts=L.call(this,this.defn,this.thresholdId);}return this.fmts;},clearFormats:function A(){this.fmts=undefined;},createEmptyFormats:function(){return(this.fmts=this.fmts||{});},clearCache:function Q(){delete this.defn[this.getCacheKey()];},unrender:function M(S){if(this.thresholdId){this.fmts=null;}this._super(S);}});mstrmojo._Formattable.getBorderWidths=function(W){var V=W.getFormats(),S=(V.border)?V.border.match(/(\d*|\d*\.\d*)pt/)[0]:V["border-width"],U=W.model,T=U.docModel;return O.getBorderWidths(S,(T&&T.dpi)||U.dpi);};}());(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var D=mstrmojo.EnumReadystate;var A=1200;var C=function(F,E){if(E){E.style.display=F?"block":"none";}};mstrmojo._HasWaitIcon={waitHandle:null,postBuildRendering:function B(){if(!this._rsl){var E=this.id;this._rsl=this.defn.attachEventListener("readyStateChange",E,function(G){if(!this.hasRendered){return ;}switch(G.value){case D.WAITING:if(!this.waitIcon&&this.domNode){var H=document.createElement("div");H.className="mojo-overlay-wait";H.innerHTML='<div class="overlay"></div><div class="icon"></div>';this.domNode.appendChild(H);this.addSlots({waitIcon:H});}var F=this.waitIcon;if(A){this.waitHandle=window.setTimeout(function(){if(mstrmojo.all[E]){mstrmojo.all[E].waitHandle=null;}C(true,F);},A);}else{C(true,F);}break;case D.IDLE:if(this.waitHandle){window.clearTimeout(this.waitHandle);this.waitHandle=null;}C(false,this.waitIcon);break;}});}return this._super();}};}());(function(){mstrmojo.markup={apply:function B(E,G){var F=(/mstrmarkup\:markup/).test(E)?this.dhtml(E):E;return F.replace(this._REG_EXP_TOKENS,function H(I,J){return(J in G&&G[J]!==null)?G[J]:"";});},dhtml:function D(E){return(E||"").replace(/^<mstrmarkup:markup[^\>]*?\>/,"").replace(/<\/mstrmarkup:markup\>/,"");},slots:function C(H){var J={};function G(N){var O=N.getAttribute("mstrSlot");if(O){var L=O.split(/\s*,\s*/);for(var M=0,K=L.length;M<K;M++){J[L[M]]=N;}}}G(H);var E=H.getElementsByTagName("*");for(var F=0,I=E&&E.length||0;F<I;F++){G(E[F]);}return J;},_REG_EXP_TOKENS:/\{\@([^\}]+)\}/gm,useCache:false,methods:function A(G){var K=this.useCache&&this._findCache(G);if(K){return K;}var F={lookup:{},sequence:[]};var E=G&&G.match(/<mstrmarkup\:markup(.*?)\>/);if(!E){return F;}var H=E[1],I;while((I=H.match(/([^\s=]+)=\"([^\"]+)\"/m))){var J=I[1];F.lookup[J]=new Function(I[2]);F.sequence.push(J);H=H.substr(I.index+I[0].length);}if(this.useCache){this._writeCache(G,F);}return F;},_cache:[],_writeCache:function(E,F){this._cache.push({markup:E,data:F});},_findCache:function(F){var I=this._cache,G;for(var H=0,E=I.length;H<E;H++){if(I[H].markup==F){G=I[H];break;}}return G&&G.data;}};})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");mstrmojo.touchManager=new mstrmojo.Obj({notify:function(r,s){return this.raiseEvent({name:"touchesBegin",srcId:r,touch:s});}});var V=mstrmojo.dom,o=V.attachEvent,p=V.detachEvent,B=Math,W=window.mstrConfig,Q=false,J=null,h=W&&W.allowDefaultTouches;var g=10,D=250,F=400,Y=100;var f="Begin",N="End",c="Move",S="Cancel";var l=1,m=2,C=3,P=4;var K={};K[l]="Select";K[m]="Swipe";K[C]="Multi";K[P]="Tap";o(document.body,V.TOUCHMOVE,function(r){if(!W||!W.allowDefaultTouches){if(r.preventDefault){r.preventDefault();return false;}}return true;});function X(r){var s=r.identifier;return(s===undefined)?1:s;}function j(u,v,t,s){if(Q){var r=s?X(s)+" ":"";window.console.log(u+":"+(t?" "+t.scriptClass+" "+t.id:"")+" "+r+(v||""));}}function k(r){return(J===r);}function T(r){if(!k(r)){return ;}j("detachWinEvts","",r);p(window,V.TOUCHMOVE,r._tmCallback,true);p(window,V.TOUCHEND,r._teCallback,true);p(window,V.TOUCHCANCEL,r._teCallback,true);J=null;}function U(r){if(k(r)){return ;}var s=J;if(s){j("forced deactivation","",s);T(s);}j("attachWinEvts","",r);o(window,V.TOUCHMOVE,r._tmCallback,true);o(window,V.TOUCHEND,r._teCallback,true);o(window,V.TOUCHCANCEL,r._teCallback,true);J=r;}function M(s,r){return"touch"+((r&&K[r])||"")+(s||"");}function Z(t,u,s){var r=M(u,s);return(t[r]!==undefined)?r:"";}function n(u,w,x,t,s){s=s||u.gestures[x.id];var v=(s&&s.bubbleTarget)||u,r=Z(v,w,t);if(r){j("fire",r,v);x.methodName=r;return v[r](x);}j("no handler",M(w,t),v);return true;}function d(z,AA,r,v){var w=r.pageX,u=r.pageY,x=z.timeStamp,s=X(r),AE={x:B.round(w-AA.pageX),y:B.round(u-AA.pageY)};var AD={id:s,evt:z,pageX:w,pageY:u,clientX:r.clientX,clientY:r.clientY,target:r.target,delta:AE,date:x,stop:function(){j("event stopped",s);z.stopPropagation();z.cancelBubble=true;}};if(v){var t=x-v.date,AC=v.delta,y={x:B.abs(AE.x-AC.x),y:B.abs(AE.y-AC.y)};AD.velocity={x:y.x/t,y:y.y/t};AD.isVertical=(y.y>y.x);AD.accelDelta=y;var AB=AD.direction={};if(w!==v.pageX){AB.x=(w<v.pageX);}else{if(w!==AA.pageX){AB.x=(w<AA.pageX);}}if(u!==v.pageY){AB.y=(u<v.pageY);}else{if(w!==AA.pageX){AB.y=(u<AA.pageY);}}}return AD;}function I(u,r,t,s){return{s:u,p1:r,p2:t,evt:s,target:s.target};}function L(s,r){if(s){s.gestures[r]=null;}}function a(s,r){T(s);n(s,N,r);}function G(r){if(r._selectHandle){window.clearTimeout(r._selectHandle);delete r._selectHandle;j("cancelSelect","",r);}}function H(x,z){var v=z.which;if(v&&v===3){j("ignore","right mouse click",x);return ;}var y=x.gestures,w=z.touches||[z],r=(z.changedTouches&&z.changedTouches[0])||z,AC=k(x),AD=d(z,r,r),AB=I(AD,AD,AD,z);j("touchBegin","",x,r);if(w.length>1){if(!AC){AD.stop();j("ignore","cross widget multitouch",x,r);var u=J;if(u&&u.onCrossWidgetMultitouch!==undefined){j("call onCrossWidgetMultitouch for","",u);u.onCrossWidgetMultitouch();}return false;}}else{if(AC){j("forced deactivation","",x,r);T(x);AC=false;}}if(x.singleNode&&r.target!==x._tn){j("ignore","target is not touch node",x,r);return ;}if(mstrmojo.touchManager.notify(x.id,AD).ignore){AD.stop();return ;}if(!AC){var t=AD.target.tagName;t=t&&t.toLowerCase();if(t==="select"||t==="input"){j("ignore","target is input or select",x,r);if(x.monitorInputs){n(x,null,AD,P);}return ;}}y[AD.id]=AB;if(AC){if(!x.multiTouch){G(x);var s=w[w.length-2],AA=y[X(s)];n(x,S,s,AA.action,AA);}else{AB.action=C;if(x._singleTouch){G(x);x._singleTouch.action=C;delete x._singleTouch.bubbleTarget;delete x._singleTouch;n(x,f,AD,C);}}AD.stop();return ;}if(!V.contains(x._tn,z.target,true,x.domNode)){delete y[AD.id];return ;}x._singleTouch=AB;if(n(x,f,AD)===false){return ;}AD.stop();if(Z(x,f,l)){x._selectHandle=window.setTimeout(function(){AB.action=l;if(n(x,f,AD,l)===false){a(x,AD);}delete x._selectHandle;},F);}U(x);}function q(v,w){var y=(w.changedTouches&&w.changedTouches[0])||w,s=v.gestures[X(y)];if(!s){return ;}var t=d(w,s.s,y,s.p2),u=s.action;s.p2=s.p1;s.p1=t;if(!u&&(B.abs(t.delta.x)>g||B.abs(t.delta.y)>g)){u=s.action=m;G(v);if(!Z(v,f,u)&&!Z(v,c,u)){t.methodName=M(f,u);return v.bubbleTouchEvent(t);}if(n(v,f,t,u)===false){a(v,t);return ;}}if(u){var r=s.lastMove||s.s.date,x=t.date-r;if(!mstrApp.isTouchApp()||x>=Y){s.lastMove=t.date;n(v,c,t,u);}}}function E(v,x){var r=(x.changedTouches&&x.changedTouches[0])||x,y=(x.touches&&x.touches.length)||0,w=v.gestures,AB=X(r),AA=w[AB];if(!AA){j("No gesture",AB,v,r);return ;}var u=AA.action,AC=d(x,AA.s,r,AA.p2);if(!u){G(v);if(!AA.wasMulti){u=P;}}if(y===0){T(v);v.gestures=[];j("gestures","clear all",v,r);}else{w[AB]=null;j("gestures","clear single",v,r);}L(AA.bubbleTarget,AB);switch(u){case m:case l:AC.stop();n(v,N,AC,u,AA);break;case C:if(y<2){n(v,N,AC,u,AA);if(y===1){var t=x.touches[0],z=d(x,t,t),s=I(z,z,z,x);s.wasMulti=true;w[X(t)]=s;v._singleTouch=s;}}if(y>0){return ;}break;case P:if(!Z(v,null,u)){break;}var AD=v._tapHandler;if(AD){window.clearTimeout(AD.h);}if(AC.date-AA.s.date<F){if(n(v,"Before",AC,u,AA)===false){break;}if(!v.multiTap){AC.count=1;n(v,null,AC,u,AA);}else{if(AD){AD.count++;}else{AD=v._tapHandler={count:1};}AD.h=window.setTimeout(function(){AC.count=AD.count;n(v,null,AC,u,AA);delete v._tapHandler;},D);}}else{delete v._tapHandler;}break;}n(v,N,AC,undefined,AA);}function b(s){var r=s._tn;if(!r){return ;}if(!s._tmCallback){s._tsCallback=function(t){H(s,t);};s._tmCallback=function(t){q(s,t);};s._teCallback=function(t){E(s,t);};}o(r,V.TOUCHSTART,s._tsCallback);}mstrmojo._TouchGestures=mstrmojo.provide("mstrmojo._TouchGestures",{_mixinName:"mstrmojo._TouchGestures",singleNode:false,multiTouch:false,touchNode:null,multiTap:false,monitorInputs:false,postBuildRendering:function O(){if(this._super){this._super();}this._tn=this.touchNode||this.domNode;this.gestures=[];b(this);},bubbleTouchEvent:function e(x){var u=x.methodName,r=x.id,s=this.gestures[r],t=this.parent;while(t){var w=t[u],v=t.touchBegin;if(w&&(!v||n(t,f,x)!==false)){x.methodName=u;L(s.bubbleTarget,r);s.bubbleTarget=t;t.gestures[r]=s;j("bubble",((this.k)?" "+this.k:"")+"] bubbled "+u+" to ["+t.scriptClass+((t.k)?" "+t.k:"")+"]",this,x);return w.call(t,x);}t=t.parent;}return false;},unrender:function A(s){if(k(this)){T(this);}var r=this._tn;if(r){V.detachEvent(r,V.TOUCHSTART,this._tsCallback);}this._super(s);},restoreDefaultTouches:function R(r){if(W){W.allowDefaultTouches=r&&h;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.dom","mstrmojo.array");var R=Math,U=mstrmojo.publisher.hasSubs,Q=mstrmojo.hash,F=Q.forEach,a=mstrmojo.dom;var S=0.15;var d=1,T=2;var B={y:{edge:["top","bottom"],size:0},x:{edge:["left","right"],size:0},clsName:"mstrmojo-touch-scroll-indicator",init:function Y(){var h=this.y,g=this.x;if(!h.i){var j=h.i=document.createElement("div");j.className=this.clsName;var k=g.i=j.cloneNode(false);document.body.appendChild(j);document.body.appendChild(k);}},setGradient:function Z(o,j,p,l){var n=o.i,h=o.edge[j?1:0];var m=R.min(R.round(R.min(R.abs(p)/200,1)*100),l/2),g="left top",k="left bottom";if(j){k=g;if(h==="bottom"){g="left bottom";}else{g="right top";}}else{if(h==="left"){k="right top";}}if(m!==o.size){n.style.background="-webkit-gradient(linear, "+g+", "+k+", from(rgba(39, 104, 162, .4)), to(rgba(39, 104, 162, 0)), color-stop("+(m/100)+", rgba(39, 104, 162, 0)))";o.size=m;}},scrollAxis:function D(k,t,m,r,j){var y=t-m,h=j[k]=(y!==0);if(!h){this.hide(k);return ;}var n=this[k],q=n.i,g=q.style,o=(k==="y"),p=(y>0),s=this.clsName+" "+n.edge[p?1:0];if(!n.size||q.className!==s){q.className=s;var u="px",z=3,v=r.y,l=r.x,w=100,x=r.w;if(o){if(p){v+=r.h-w-z;}}else{x=w;w=r.h;if(p){l+=r.w-x-z;}}g.top=v+u;g.left=l+u;g.width=x+u;g.height=w+u;g.display="block";}this.setGradient(n,p,y,o?r.h:r.w);},scroll:function D(k,j,n,m,q){var p=j.x,o=j.y;if(p!==n||o!==m){this.init();var l=this._widgetPosition;if(!l){var g=k.indicatorEl||q;l=mstrmojo.dom.position(g.parentNode);}var h=k._outOfBounds||{};this.scrollAxis("y",o,m,l,h);this.scrollAxis("x",p,n,l,h);this._widgetPosition=l;k._outOfBounds=h;}else{this.hideAll();delete k._outOfBounds;}},hide:function M(h){var g=this[h];if(g.size!==undefined){g.i.style.display="none";g.i.className=this.clsName;g.size=0;}},hideAll:function b(){this.hide("y");this.hide("x");delete this._widgetPosition;}};function W(g,h){return h?R.max(R.min(R.round(g),h.end),h.start):g;}function O(g,j,h){h.name=j;h.id=g.identifier;g.raiseEvent(h);}function G(){var h="scrollDone",g=this.origin;if(U(this.id,h)&&g){O(this,h,{x:g.x,y:g.y});}this.stopDeceleration();}function I(j,h,m){var l=j.scrollEl;if(!l){G.call(j);return ;}var k={x:h.x||0,y:h.y||0};F(j._scrollBarEls,function(y,s){var AD=(s==="x"),x=k[s],n=y.length,z=y.ratio,u=y.viewportSize,r=6/n,q=y["base"+(AD?"Left":"Top")],w=q+u-n,p=R.round(q+(z*x));if(p<q){p=q-x;n+=x;}else{if(p>w){var AC=(x-j.offset[s].end)*z;p=R.min(w+AC,u+q-6)-1;n-=AC;}}var AB=0,o=[AB,AB,AB],t=[1,1,1],AA=AD?0:1;o[AA]=(p-q);t[AA]=R.min(R.max(n/y.length,r),1);a.translate(y,o[0],o[1],o[2]," scale3d("+t.join(",")+")");});if(m){m+="ms";}if(j._isHosted){var g=l.parentNode;g.scrollTop=k.y;g.scrollLeft=k.x;}else{l.style[a.CSS3_TRANSITION_DURATION]=m||"0";a.translate(l,-k.x,-k.y,0,j.transform,j.useTranslate3d);}if(U(j.id,"scrollMoved")){O(j,"scrollMoved",{x:h.x,y:h.y});}}function J(g,h,j){return R.ceil(1+R.log(g/R.abs(h))/R.log(1-j));}function E(g,l,j,h,k){return g+(l*(j*(1-R.pow(1-k,h))/k));}function N(AD,AN,m,AJ,v,AI,r){var q=AD.offset[m];if(!q){return AN;}var l=AD._outOfBounds,h=l&&l[m],t=q.incFetch,u=AD.friction,p=q.start,o=q.end,AE=AJ?o:p;v=R.abs(v);if(h){AJ=(AN<p);AE=AJ?p:o;}var AM=AJ?1:-1;if(h&&(AJ||!t)){var s=S*3,AL=1/(1-u),k=s/R.pow((1-u),(R.log(1-R.abs(AN-AE)*(1-AL)/s)/R.log(AL))-1);var AB=R.round(E(AN,AM,k,AI,u));if(AJ?(AB>=AE):(AB<=AE)){G.call(AD);return AE;}return AB;}var AH=q.pageSize,AG=q.supportedEdges;var n=E(AN,AM,v,AI,u),w=(n<=p),j=(n>=o);if(w||j){if(t&&((w&&((AG&d)>0))||(j&&((AG&T)>0)))){if(n-o>=AH){n=o+AH;AE=n;}if(!AD.STATUS_INC_FETCH){AD.STATUS_INC_FETCH=true;O(AD,"incFetch",{edge:j?T:d});}}else{if(AD.bounces){var AK=u*2,x=AD.bounceVelocity,g=AD.bounceTime,AF=AD.bounceDistance;if(!AD.hasBounced){x[m]=R.abs(S/R.pow(1-u,r-AI-1));g[m]=J(S,x[m],AK);AF[m]=R.abs(E(n,AM,x[m],g[m],AK)-n);AD.raiseEvent({name:"bounceOut",id:AD.identifier,axis:m,direction:AJ,value:R.round(n)});AD.hasBounced=true;}var AA=Math.floor(AF[m]/2);var z=E(AE,AM,x[m],AI,AK),AC=R.abs(z-AE);if(R.abs(AC)<AA){return z;}if(R.abs(AC)>=AF[m]){G.call(AD);return AE;}var y=AA-(AC-AA);return R.round(AE-(AJ?-y:y));}n=AE;}}return R.round(n);}function P(h){var g=this._scrollListener;if(g){if(!h||h!==g.el){a.detachEvent(g.el,"scroll",g.fn);delete this._scrollListener;return true;}return false;}return true;}mstrmojo.TouchScroller=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.TouchScroller",scrollEl:null,identifier:"",hScroll:false,vScroll:false,offset:null,origin:null,transform:"",friction:0.0015,frameRate:60,bounces:true,hasBounced:false,bounceDistance:{},bounceTime:{},bounceVelocity:{},showScrollbars:false,showIndicators:true,useTranslate3d:true,STATUS_INC_FETCH:false,init:function Y(g){this._super(g);B.init();},initScroller:function X(h){Q.copy(h,this);var l=this.scrollEl;if(l){var k=this._isHosted=false;if(k){var g=l.parentNode;if(P.call(this,g)){g.style.overflow="auto";var m=this.id,j=this._scrollListener={el:g,fn:function(n){var o=mstrmojo.all[m].origin,p=n.target;o.x=p.scrollLeft;o.y=p.scrollTop;}};a.attachEvent(g,"scroll",j.fn);}this.showScrollbars=false;}}},canScroll:function L(){return this.vScroll||this.hScroll;},updateScrollBars:function H(o,k){var m=this.scrollEl;if(!this.showScrollbars||!m){return ;}var h=this._scrollBarEls;if(!h){var l=this;h=this._scrollBarEls={x:"hScroll",y:"vScroll"};F(h,function(p,q){if(l[p]){var r=document.createElement("div");r.className="mstrmojo-touch-scrollBar "+q+"Axis";(k||m.parentNode).appendChild(r);h[q]=r;}else{delete h[q];}});}if(!o){var g=this.scrollEl.parentNode;o={top:0,right:g.clientWidth,bottom:g.clientHeight,left:0};}var n=9,j={x:{left:o.left,top:o.bottom-n,x:o.right-o.left,d:"Width"},y:{left:o.right-n,top:o.top,x:o.bottom-o.top,d:"Height"}};F(h,function(u,r){var AA=u.style,y=j[r],s=y.d,t=u.parentNode,z=y.x;var q=y.left,w=y.top,v=z/m["offset"+s],p=Math.min(Math.round(z*v),z);u.baseLeft=q;u.baseTop=w;u.ratio=v;u.viewportSize=z;u.length=p;AA.left=q+"px";AA.top=w+"px";AA[s.toLowerCase()]=p+"px";});},toggleScrollBars:function C(g){F(this._scrollBarEls,function(h){h.style.opacity=g?1:0;});},scrollTo:function(h,m,k){if(!this.canScroll()&&!(h===0&&m===0)){I(this,{x:0,y:0});return ;}var l=this.offset,j=this.origin,g={x:(this.hScroll)?W(h,l.x):0,y:(this.vScroll)?W(m,l.y):0};I(this,g,k);j.x=g.x;j.y=g.y;},scrollToEnd:function(h,m,k){var j=this.origin,l=this.offset,g={x:0,y:0};if(j&&l){mstrmojo.array.forEach([h,m],function(o,n){var q=n?"y":"x",p=l[q];g[q]=o?(p&&p.end)||0:j[q];});}this.scrollTo(g.x,g.y,k);},scroll:function D(m){if(this._isHosted){return ;}var k=this.offset,t=this.scrollEl,v=m.delta,w=v.x,u=v.y;if(!t){return ;}if(!k&&this.showIndicators){B.scroll(this,{x:(this.noHScroll)?0:-w,y:(this.noVScroll)?0:-u},0,0,t);return ;}var s=this.origin,n={x:(this.hScroll)?R.round(s.x-w):0,y:(this.vScroll)?R.round(s.y-u):0},q=W(n.x,k.x),p=W(n.y,k.y);if(!k.scrollPast){if(this.showIndicators){B.scroll(this,n,q,p,t);}n.x=q;n.y=p;}else{var l=(q!==n.x),o=(p!==n.y),g=(l||o),j=this._outOfBounds,h="";if(j){if(l!==(j.x===true)||o!==(j.y===true)){h="scrollIn";}}else{if(g){h="scrollOut";}}if(h){if(U(this.id,h)){var r=m.direction;O(this,h,{x:{position:n.x,direction:r.x},y:{position:n.y,direction:r.y}});}if(g){this._outOfBounds={x:l,y:o};}else{delete this._outOfBounds;}}}I(this,n);},scrollEnd:function V(u){B.hideAll();if(!this.canScroll()||this._isHosted){return ;}var AC=this.id,v=this.friction,AK=1/(1-v),AD=this.origin,k=u.velocity,AI=u.direction,AB=new Date(),l=this._outOfBounds,r=this.offset,AJ={x:this.hScroll,y:this.vScroll},w={},AM={},AL={},s={},n={},t={},p={},o={},AF={},AH=function(AP){t[AP]=S;var AO=r[AP],AN=(l&&l[AP]),AQ=(AN&&(!AO||!r.scrollPast));AM[AP]=(AJ[AP]&&!AQ)?AD[AP]-u.delta[AP]:AD[AP];if(AO){p[AP]=AO.start;o[AP]=AO.end;if(AN){if(!AQ){AI[AP]=(AM[AP]<p[AP]);AF[AP]=(AI[AP])?p[AP]:o[AP];if(AI[AP]||!AO.incFetch){t[AP]=S*3;k[AP]=t[AP]/R.pow((1-v),(R.log(1-R.abs(AM[AP]-AF[AP])*(1-AK)/t[AP])/R.log(AK))-1);}}else{AM[AP]=W(AD[AP]-u.delta[AP],AO);}}}w[AP]=(AJ[AP]&&!AQ)?R.abs(k[AP]):0;AL[AP]=(AI[AP]||false)?1:-1;s[AP]=J(t[AP],w[AP],v);n[AP]=E(AM[AP],AL[AP],w[AP],s[AP],v);};AH("x");AH("y");AD.x=AM.x;AD.y=AM.y;var z=(w.x>0),y=(w.y>0);if(!r.scrollPast&&!z&&!y){G.call(this);var m,AE,x,j,AG;for(m in r){AE=r[m];AG=AE.supportedEdges;x=((AE.start===AM[m])&&((AG&d)>0));j=((AE.end===AM[m])&&((AG&T)>0));if(AE.incFetch&&(x||j)){this.STATUS_INC_FETCH=true;O(this,"incFetch",{edge:j?T:d});}}return ;}this.hasBounced=false;this.bounceDistance={};this.bounceTime={};this.bounceVelocity={};this.decelerating=true;var h=Math.round(1000/this.frameRate),q=AB,AA,g={x:z,y:y};this.decelerationTimer=window.setTimeout(function(){var AN=mstrmojo.all[AC],AO=AN.origin,AS=new Date(),AT=(AS-AB),AR;if(AN._halt){G.call(AN);return ;}AA=AS-q;q=AS;if(AA>(h+5)){h=h+R.round((AA-h)/2);}for(AR in g){if(g[AR]){var AQ=N(AN,AM[AR],AR,AI[AR],w[AR],AT,s[AR]);if(!isNaN(AQ)){AO[AR]=AQ;}}}I(AN,AO);var AP=(AT>s.x&&AT>s.y);if(!AP&&!AN.bounces){AP=true;mstrmojo.hash.forEach(r,function(AW,AV){var AU=AO[AV];if(AU!==AW.end&&AU!==AW.start){AP=false;return false;}});}if(AP){G.call(AN);}else{if(AN.decelerating){AN.decelerationTimer=window.setTimeout(arguments.callee,h);}}},h);},stopDeceleration:function A(){var g=!!this.decelerating;if(g){if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}delete this.decelerating;this.toggleScrollBars(false);}delete this._outOfBounds;delete this.hasBounced;delete this.bounceDistance;delete this.bounceTime;delete this.bounceVelocity;delete this._halt;return g;},haltScroller:function K(){this._halt=!!this.decelerating;},unrender:function c(){delete this.scrollEl;},destroy:function e(){this.stopDeceleration();P.call(this);this._super();}});mstrmojo.TouchScroller.getScrollPositionTotals=function f(l){var j=l.parent,g=l._scroller,h=mstrmojo.hash.copy((g&&g.origin)||{x:0,y:0});if(j){var k=mstrmojo.TouchScroller.getScrollPositionTotals(j);h.x+=k.x;h.y+=k.y;}return h;};mstrmojo.TouchScroller.ScrollIndicators=B;mstrmojo.TouchScroller.EnumIncFetchEdges={start:d,end:T};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo._TouchGestures","mstrmojo.TouchScroller");var L=mstrmojo.array.forEach,E=mstrmojo.hash.forEach,Z=mstrmojo.dom;function O(e,f){var d;for(d in e){Z.translate(e[d],f[0],f[1],f[2]);}}function R(e){var d=Math.abs;return{x:(d(e.accelDelta.x)<d(e.accelDelta.y)),y:(d(e.accelDelta.y)<d(e.accelDelta.x))};}function J(d,f){d.raiseEvent({name:"scrolledOut",value:f.value,axis:f.axis,direction:f.direction});}function Q(e,j,m,k,n,d,g,f){var l=new mstrmojo.TouchScroller({scrollEl:e,vScroll:m,hScroll:k,frameRate:n,showScrollbars:d,offset:j,origin:{x:0,y:0},bounces:false,useTranslate3d:false,indicatorEl:f});if(g){l.friction=g;}return l;}function B(d){var e;for(e in d){if(d[e].decelerating){d[e].stopDeceleration();}}}var S={x:false,y:false};function U(){var d=S;if(!d.x){return"x";}if(!d.y){return"y";}return null;}var P={x:false,y:false};function N(h,j){var f=U(),g=h.scrollerConfig.scrollPast;if(!f||!g){return !!f&&!g;}function e(l){var d=h.viewport,k=h._TSN[l],p=h._scroller[l],q=h.tPos[l],m=j[l],r=P[l],n=(l==="x")?"y":"x",t=h._scroller[n],s=P[n],o;if(!t[0].decelerating&&s){e(n);}if(q<=0&&m>0){if(!r){if(s){return false;}O(k,[0,0,0]);for(o in p){p[o].scrollEl=d;}P[l]=true;}}else{if(r){O([d],[0,0,0]);for(o in p){p[o].scrollEl=k[o];}P[l]=false;}}return true;}return e(f);}function F(l,d){var h=d.axis,g=l.scrollboxHeightFixed,k=d.name;if(l.ss){var j=l.zones._BR.getRowInfoByPosition(d[h]);j.position=d[h];l.ss.onMove(j);}l.tPos[h]=d[h];if(k==="scrollDone"){E(l._scroller,function(m){L(m,function(n){n.toggleScrollBars(false);});});if(!N(l,d)){return true;}}if(h==="y"){var f=function(m){if(!l._isDownloading&&(-m<=l._TMAX[h])){if(l.onScrolledToLastRow){l.onScrolledToLastRow();}}};if(k==="scrollDone"){delete l._isDecelerating;if(l._cachedDownload){l.dataDownloaded();}else{f(d.y);}if(g){var e=d.y;l.notifyScrollListeners({x:d.x,y:Math.max(e,0)});}}else{if(k==="scrollDecel"){l._isDecelerating=true;f(d.fY);if(g){l.notifyScrollListeners({x:d.fX,y:d.fY});}}else{if(k==="scrollOut"){l._isDecelerating=true;f(d.y.position);}}}}}function I(g,f){var d=Math.abs,h={};var e=h[f]={start:g._TMIN[f],end:d(g._TMAX[f])};h.scrollPast=g.scrollerConfig.scrollPast;if(f==="y"){if(g.useSeamlessIncFetch){e.incFetch=!g.endFetching;e.pageSize=g.scrollboxHeight-((parseInt(g.gridData.rh,10)||25)*4);}}return h;}function W(d){d._scroller={x:[],y:[]};var e=d._viewportCoords;E(d._TSN,function(h,j){var m=I(d,j),k=(j==="y"),l=(j==="x"),f=h.length;L(h,function(q,p){var o=Q(q,m,k,l,d.frameRate,(p===f-1)&&d.scrollerConfig.showScrollbars,d.scrollerFriction,d.domNode);o.updateScrollBars(e,d.domNode);d._scroller[j][p]=o;});var n=d._scroller[j][0],g=["scrollDone","scrollMoved"];if(n){if(k){g=g.concat(["scrollDecel","scrollOut"]);}L(g,function(o){n.attachEventListener(o,d.id,function(p){p.axis=j;F(d,p);});});}});}function A(e){if(this.hasRendered){this[e+"Limit"]=parseInt(this[e],10);if(this.zones){var d=this;window.setTimeout(function(){if(d.hasRendered){d.setOffsets(true);d.setupScrollers();}},0);}}}mstrmojo._HasXtabTouchScroll=mstrmojo.provide("mstrmojo._HasXtabTouchScroll",{noScrolling:false,useTouchScrolling:true,scrollerConfig:{showScrollbars:false,scrollPast:false},_TSN:null,tPos:{x:0,y:0},_TMIN:{x:0,y:0},setupTNs:function T(){this._TSN.x=this._TSN.y=[this.domNode];},touchBegin:function X(h){if(!this.noScrolling){h.stop();if(!this._isDownloading){if(this.toolbarMgr){this.toolbarMgr.closeToolbar();}var g=this._scroller,e=this._TMIN,d=this._TMAX;E(this.tPos,function(j,k){if(j>=e[k]&&j<=Math.abs(d[k])){B(g[k]);}});}var f=this._scroller.x;E(f,function(j){j.origin.x=f[0].origin.x;});}return true;},touchSwipeBegin:function V(k){if(this.noScrolling){return this.bubbleTouchEvent(k);}if(this._isDownloading){return false;}S=R(k);var f=S.y?"x":"y",d=this._scroller[f][0],h=d.offset,g=h[f][k.direction[f]?"end":"start"];if(!h.scrollPast&&g===d.origin[f]){var j=this.bubbleTouchEvent(k);if(j!==undefined){return j;}}var e=this._scroller;if(!N(this,k.delta)){return true;}if(!S.x){B(e.x);}if(!S.y){B(e.y);}E(this._scroller,function(m,l){if(!S[l]){L(m,function(n){n.toggleScrollBars(true);});}});return true;},touchSwipeMove:function D(e){if(!N(this,e.delta)){return true;}var d=this._scroller;L(["x","y"],function(f){if(!S[f]){E(d[f],function(g){g.scroll(e);});}});},touchSwipeEnd:function Y(k){var e=S,g=null,j=k.delta,h=k.direction;if(!e.x&&j.x!==0){g="x";h=h.x?"left":"right";}if(!e.y&&j.y!==0){g="y";h=h.y?"up":"down";}if(g){J(this,{axis:g,value:this.tPos[g],direction:h});var d=this._scroller[g],f;if(!e[g]){for(f in d){d[f].scrollEnd(k);}}}},gridPagesRendered:function C(){if(this._super){this._super();}this.setOffsets(true);},renderEmptyGrid:function G(){if(this._super){this._super();}this.noScrolling=true;},postBuildRendering:function b(){if(this._super){this._super();}if(this.zones&&!this.gridData.eg){var d=this;window.setTimeout(function(){if(d.hasRendered){d._TSN={x:[],y:[]};d.setupTNs();d.setupScrollers();}},0);}},setOffsets:function c(){var g=this,f=this.domNode,e=this.zones,j=e._TR,d=e._BL,h=(!this.isFullScreenWidget&&this.isDocXtab),k=this._viewportCoords={top:j?j.cp.rc*parseInt(this.gridData.rh,10):0,right:h?this.widthLimit:parseInt(this.width,10),bottom:h?this.heightLimit:parseInt(this.height,10),left:d?d.totalColWidth:0};E(this._scroller,function(m,l){L(m,function(n){n.offset=I(g,l);n.updateScrollBars(k,f);var o=n.origin;if(o){n.scrollTo(o.x,o.y);}});});},setupScrollers:function H(){var f=this.gridData,e=this._TMAX,d=this.noScrolling=((f&&f.co)||(!this.scrollerConfig.scrollPast&&e.x===0&&e.y===0));if(!d&&!this._scroller){P={x:false,y:false};O(this._TSN.x,[0,0,0]);O(this._TSN.y,[0,0,0]);W(this);}},onwidthChange:function M(){A.call(this,"width");if(this._super){this._super();}},onheightChange:function K(){A.call(this,"height");if(this._super){this._super();}},unrender:function a(d){E(this._scroller,function(e){L(e,function(f){f.destroy();});});delete this._scroller;if(this._super){this._super(d);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._RowRendTracker","mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSBaseFormType");var T="<tr>";var d=['<table cellspacing="0" cellpadding="0" style="table-layout:',null,";width:",null,';mstr-tablestyle-slot" ',null,">",null,"<tbody>"];var W="&nbsp;";var I="fsbp_1 ";var b="fsbp_2 ";var B="fsbp_3 ";var Z=1,a=2,F=3,f=4,L=5,V={1:" stack-top",2:" stack-middle",3:" stack-bottom",4:" stack-bottom-last",5:" no-stack",6:" stack-full"},O=1,A=3;var e=mstrmojo.css,Q=mstrmojo.array,c=mstrmojo.chart.model.enums.EnumDSSBaseFormType;var K=4;function E(k,j){for(var l=0,h=k.length;l<h;l++){var n=k[l];var m=j.rows[n.rows].cells[n.cells];if(m){mstrmojo.css.addClass(m,I);}}}function X(k){var m=k.indexOf('src="');if(m<0){return k;}var l=k.substring(m+5),j=l.indexOf('"'),n;l=l.substring(0,j);n=l;var h=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(h&&h.getImage){n=h.getImage(l);}return k.replace(l,n);}var R=(function(){var o=/\n/g,j="<br/>",y=/<a\s[^>]+>/gi,w="<a ",n='<a target="_blank" ',u="target=";var v='<a href="',t='" target="_blank">',r="</a>",q="<span>",l="</span>",p='<span rabtn class="raBtn ',k='"></span>',s="icon-expand",x="icon-collapse",m="<span>",h="</span>";return function(AI,AG){var AJ=(AI.v||AI.n||W).replace(o,j),AK=AI.ts===c.DssBaseFormUrl,AE=AI.ts===c.DssBaseFormHTMLTag,AB=AI.lv!==undefined;if(AK){AJ=v+AJ+t+AJ+r;}else{if(AE){(AJ.match(y)||[]).forEach(function(AL){if(AL.indexOf(u)===-1){AJ=AJ.replace(AL,AL.replace(w,n));}});}}if((AI.css&&AI.css.indexOf("hl")>-1)||AK){AJ=q+AJ+l;}if(AB){var AC=AI.lv,z="&nbsp;&nbsp;&nbsp;&nbsp;",AA="",AF="",AH="",AD;for(AD=0;AD<AC;AD++){AA+=z;}if(AI.hcd&&AI.fi===undefined){AH=p+(AI.epd?x:s)+k;}else{AA+=z;}if(AI.axis===1){AF=m+AA+h;}AJ=AF+AH+AJ;}return AJ;};}());mstrmojo.GridBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._RowRendTracker],{scriptClass:"mstrmojo.GridBase",markupString:'<span id="{@id}" class="mstrmojo-Grid {@cssClass}" style="{@cssText}"></span>',markupSlots:{gridContainerNode:function(){return this.domNode;}},autoFitWindow:false,tableLayout:null,numAutoHeightRows:0,cp:null,rc:0,cc:0,cws:null,rh:null,totalColWidth:0,start:0,end:0,forceFixedSizes:true,hiliteCellsMap:null,eiMap:null,init:function J(h){this._super(h);},numColumnCanMerge:0,preBuildRendering:function D(){var h=this.cp;if(!h){return ;}h.initContent();this.rc=h.rc||0;this.cws=h.colWidths||[];this.cc=this.cws.length;this.tdWidths=h.tdWidths||[];this.tdCnt=this.tdWidths?this.tdWidths.length:0;this.start=0;this.end=this.rc-1;this.numAutoHeightRows=h.getNumAutoHeightRows&&h.getNumAutoHeightRows()||0;this.hiliteCellsMap={};this.eiMap={};this.posMap=[];this.thPosMap=[];this.totalColWidth=0;},buildRendering:function H(j){var h=this._super(j);this.renderGrid();return h;},renderGrid:function U(j){var h=this.getGridContainer();this.preBuildGridTable();this.buildGridTable(h,j);this.postBuildGridTable();},getGridContainer:function g(){return this.gridContainerNode;},buildGridTable:function G(k,h){var j=this.getTableStartMarkup();var q=this.getTableEndMarkup();if(h){this.mergeHdrsAcrossBlks=true;}var o=this.buildTableRowsMarkup(this.start,this.end,j,q).join("");if(h){var m=document.createElement("div");m.innerHTML=o;var p=k.firstChild,r=p&&p.tBodies,l=m.firstChild.tBodies[0],n=this.matchedHdrsAcrossBlks;p.appendChild(l);if(n&&n.length>0){E(n,r[r.length-2]);}}else{k.innerHTML=o;}this.markPages(this.start,this.end);},getTableStartMarkup:function P(){var j=this._getGridWidths(),h=d;h[1]=j.tableLayout;h[3]=j.totalColWidths;h[5]=this.tableCssClass?"class="+this.tableCssClass:"";h[7]="<colgroup>"+j.colgroup+"</colgroup>";if(this.tbodyStyle){h[8]='<tbody style="'+this.tbodyStyle+'">';}return h.join("");},getTableEndMarkup:function N(){return"</tbody></table>";},_getGridWidths:function Y(){var q={};var m="",k=[],p="fixed",j=this.cws,n=j.length;if(n){m=0;k=[];for(var l=0;l<n;l++){if(j[l].w!==""){m+=parseInt(j[l].w,10);}}for(l=0;l<n;l++){var h=j[l];if(h.w!==""&&!this.autoFitWindow){var o=parseInt(h.w,10);if(mstrmojo.dom.isIE7){if(o===0){k.push('<col style="width:0%;display:none"></col>');}else{k.push('<col style="width:'+(o/m*100)+'%"></col>');}}else{if(mstrmojo.dom.isWK&&o===0){k.push('<col style="width:-1px"></col>');}else{k.push('<col style="width:'+h.w+'"></col>');}}}else{k.push("<col />");p="auto";}}this.totalColWidth=m;}q.colgroup=k.join("");p=this.tableLayout||p;if(this.autoFitWindow){p=this.tableLayout||p||"fixed";m="100%";}else{if(p==="fixed"){m+="px";}else{m="auto";}}q.totalColWidths=m;q.tableLayout=p;return q;},_CELL_MARKUP:['<td rowSpan="',null,'" colSpan="',null,'" class="',null,'" ei="',null,'" style="',null,'" r="',null,'">',null,"</td>"],buildTableRowsMarkup:function S(AS,AB,Az,s,AD){var Ai=[],Au=0;Ai[Au++]=Az||"<table><tbody>";var AV=this.cp,AE=this.acws,AU=this.rowMerge,z=this.headerOffset,o=this.mxPos,AH=!!AV.gemh,Ae=AV.getRowHeight(),As=this._CELL_MARKUP,Ah=Ae?'<tr style="height:'+(Ae?Ae+"px":"")+'">':T;var x=true,AQ=true,Ao=[],Ak;var Av=function Av(m){var j=-1;mstrmojo.array.forEach(AE,function(v,r){m=m-v;if(m<0){j=r;return false;}});return j;};var AA=function AA(r,m){var j=-1;mstrmojo.hash.forEach(AV.gemh,function(v,A0){if(r<=A0&&r+m>A0){j=A0;return false;}});return j;};var AJ=function AJ(A0,A1,v){var r="",m,j;j=A0.gemh&&A0.gemh[A1];if(j){m=Av(v);if(j[m]&&j[m].v===0||o===v){r+=I;}}j=A0.gsmh&&A0.gsmh[A1];if(j){m=Av(v);if(j[m]&&j[m].v===0||o===v){r+=B;}}return r;};var An,AO,AF,Ar=[],At,Aj,AC=0,k=0,p,u,Ab=AV.colWidths&&AV.colWidths.length,AX=0,n=0,h=AD||((Az&&Az.indexOf("table-layout:fixed;")!==-1)?"fixed":"auto");if(AE&&AH){for(At=0;At<AE.length-1;At++){n+=AE[At];}}n=n||this.numColumnCanMerge;if(h==="fixed"){An=[];for(AO=0,AF=this.cws.length;AO<AF;AO++){if(window.parseFloat(this.cws[AO].w)<=0){An[AO]=true;}else{An[AO]=false;}}}this.matchedHdrsAcrossBlks=[];for(var Al=AS;Al<=AB;Al++){AC=0;Ak=Au++;Ai[Ak]=Al<this.numAutoHeightRows?T:Ah;var AI=AV.getRowCells(Al);var Ag=AB+1-Al;var Af=0;u=AU;p="";if(!this.mergeHdrsAcrossBlks){if(x&&AS>0&&AI.length<AV.colWidths.length){var Ad=AV.getUnmergedCells(AS),AL;if(Ad){Af=Ad.length;}for(At=0,AF=Af;At<AF;At++){var AN=Ad[At],y=AN.rs;if(y>Ag){As[1]=Ag;As[5]=b+AN.css;}else{As[1]=y||1;As[5]=B+AN.css;}if(An&&An[k+AC]){As[5]+=" nwFixedWidth0 ";}if(y&&y>1){Ar.push(y);}AC+=AN.cs||1;if(AN.cet){As[5]+=" mstrmojo-selected-cell";this.addHilitePosition(AN.cet,Al,At);}if(AN._ei){this.addExtraInfoMap(AN._ei,Al,At);As[5]+=" pt";}As[9]="";As[13]=W;As[3]=AN.cs;if(AN._ei===undefined){AL=AV.getRowCells(AN.o+(AV.cps[0]&&AV.cps[0].rc||0));AN=Q.filterOne(AL,function(j){return j.dpt===AN.dpt&&j.idx===AN.idx;});}As[7]=AN._ei;As[11]=Al;if(AH){if(u){p=AJ(AV,Al-z,At);}if(!!p){As[5]=p+As[5];}else{u=false;}p=AJ(AV,AA(Al-z,As[1]),At);if(!!p){As[5]=I+As[5];u=true;}}Ai[Au++]=As.join("");}x=false;}}AX=Ab;AF=AI.length;var Ay;for(Ay=0;Ay<AF;Ay++){AX-=AI[Ay].cs||1;}for(Ay=0;Ay<AF;Ay++){var AZ=AI[Ay],Aa;AZ.colIx=AX;if(AZ.rs&&AZ.rs>Ag){As[1]=Ag;As[5]=I+AZ.css;if(AZ._ei){this.addExtraInfoMap(AZ._ei,Al,Ay);}}else{As[1]=AZ.rs||1;As[5]=AZ.css;}if(An&&An[k+AC]){if((AZ.cs==undefined)||((AZ.cs!=undefined)&&(AZ.cs==1))){As[5]+=" nwFixedWidth0 ";}}if(AZ.rs&&AZ.rs>1){Ar.push(AZ.rs);}AC+=AZ.cs||1;if(AZ.rowType!==Z){As[5]+=" xtab-td ";}if(AZ.cet){As[5]+="sc_"+this.parent.k;this.addHilitePosition(AZ.cet,Al,Ay);}if(AZ.lv){As[5]+=" ra ";}Aa=AZ.rowType;if(Aa){As[5]+=V[Aa]||"";var AG=AV.getRowHeight(Aa);if(AG){Ai[Ak]='<tr style="height:'+(AG?AG+"px":"")+'">';}}As[3]=AZ.cs||1;As[7]=AZ._ei!==undefined?AZ._ei:"";if(AZ.fs||AZ._e){this.addTitleHeaderPositionMap(Al,Ay+Af,AZ);}if(AZ._ei!=null){this.addPositionMap(AZ._ei,Al,Ay+Af);}As[11]=Al;if(AZ.ts===K){var AM=AZ.v;if(this.imgCacheMap){var Ap=this.imgCacheMap,Aj=AM&&AM.replace(/\\/g,"/");if(Ap.cachedImg[Aj]){AZ.v=AM=Ap.baseURL+Ap.cachedImg[Aj];}else{if(Aj&&!Ap.unCachedImg[Aj]){Ap.unCachedImg[Aj]=Aj;}}}else{var t=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(t&&t.getImage){AM=t.getImage(AM);}}if(AZ.rowType){var l=(AV.getRowHeight(AZ.rowType)||AV.rh||Ae),Am=l,AR=this.tdWidths,Ac=AZ.colIdx,AW=0,Aq=0;var Ax=AV.getPadding(O),AT=AV.getPadding(A);if(AZ.rowType===Z||AZ.rowType===f){Aq=l>(Ax+AT)?(l-Ax-AT):0;}else{if(AZ.rowType===a||AZ.rowType===F){Aq=l>2*AT?(l-2*AT):0;}else{if(AZ.rowType===L){Aq=l>(AT*2)?(l-AT*2):0;}}}if(Ac!=="undefined"&&Ac>-1&&AR&&AR.length>Ac){var AK=AR[Ac]&&AR[Ac].w;if(AK!=="undefined"){AW=parseInt(AK,10);}}var AP=AW>30?(AW-30):0;As[13]='<div><div style="top:'+(-parseInt(Am/2,10))+"px;height:"+(l-1)+"px;line-height:"+(l-1)+'px !important;">&nbsp;<img style="max-height:'+Aq+"px; max-width: "+AP+'px;" src="'+AM+'"></img></div></div>';}else{As[9]="";var Aw="",w=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model,q=w.getZoomFactor();if(q!=1){Aw='onload="this.style.height='+q+"*this.offsetHeight+'px';\"";}As[13]='<img src="'+AM+'" '+Aw+"></img>";if(AZ.css&&AZ.css.indexOf("hl")>-1){As[13]="<span>"+As[13]+"</span>";}}}else{As[9]="";if(mstrApp.useBinaryFormat&&AZ.v&&AZ.v.indexOf("img")>=0){AZ.v=X.call(this,AZ.v);}As[13]=R(AZ,AV);}if(Ay<n){if(Al===AS&&this.mergeHdrsAcrossBlks){var AY=this.rowHdsAcrossBlks;if(AQ&&AZ.v&&AY&&AY[Ay]){if(AZ.v===AY[Ay].v){As[1]=AZ.rs||1;As[5]=B+AZ.css;As[13]="";this.matchedHdrsAcrossBlks.push(AY[Ay]);}else{AQ=false;}}}if(AH){if(u){p=AJ(AV,Al-z,AX);if(!!p){As[5]=p+As[5];if(p.indexOf(B)>=0&&Al-z>1){As[13]=W;}}else{u=false;}p=AJ(AV,AA(Al-z,As[1]),AX);if(!!p){As[5]=I+As[5];u=true;}}}if(As[1]>=Ag&&AZ.v){Ao.push({rows:Al-AS,cells:Ay,v:AZ.v});}}AX+=AZ.cs||1;Ai[Au++]=As.join("");}Ai[Au++]="</tr>";for(Ay=Ar.length-1;Ay>=0;Ay--){Aj=Ar[Ay];if(Aj<=1){Ar.pop();}else{Ar[Ay]=--Aj;}}k=Ar.length;}Ai[Au++]=s||"</tbody></table>";this.rowHdsAcrossBlks=Ao;return Ai;},addHilitePosition:function(j,k,h){var l=this.hiliteCellsMap[j];if(!l){this.hiliteCellsMap[j]={pos:[],nodes:[]};}this.hiliteCellsMap[j].pos.push({row:k,cell:h,page:0});},addExtraInfoMap:function(j,h,k){if(!this.eiMap[j]){this.eiMap[j]=[];}this.eiMap[j].push({row:h,cell:k,page:0});},addPositionMap:function(j,h,k){if(!this.posMap[j]){this.posMap[j]={row:h,cell:k,page:0};}},addTitleHeaderPositionMap:function(h,k,j){this.thPosMap.push({row:h,cell:k,page:0,obj:j});},clearHilites:function(l){var p=this.hiliteCellsMap[l],n=p&&p.nodes,m=this.parent;if(n){if(n.length==0&&p.pos){n=this.getNodesByPositions(p.pos);}for(var k=0,j=n.length;k<j;k++){var o=n[k],h=m.getCellForNode(o);if(h){delete h.cet;}e.removeClass(o,"sc_"+m.k);}this.hiliteCellsMap[l].nodes=[];}},setHilites:function(j,k){e.addClass(k,"sc_"+this.parent.k);if(!this.hiliteCellsMap[j]){this.hiliteCellsMap[j]={pos:[],nodes:[]};}this.hiliteCellsMap[j].nodes.push(k);var h=this.parent.getCellForNode(k);if(h){h.cet=j;}},getNodesByPositions:function(m){var l=this.tableNode,h=[];for(var k in m){var j=m[k];h.push(l.tBodies[0].rows[j.row].cells[j.cell]);}return h;},preBuildGridTable:function C(){},postBuildGridTable:function M(){this.addSlots({tableNode:this.gridContainerNode&&this.gridContainerNode.firstChild});}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.css","mstrmojo.GridBase");var V=mstrmojo.css,M=mstrmojo.color,a=mstrmojo.css;function C(c,d){var e=c&&c.parent;while(e&&e.scriptClass.indexOf("DocPanelStack")===-1){if(d in e){return e;}e=e.parent;}return null;}function B(d){var c=document.createElement("img");d.appendChild(c);d.removeChild(c);}function E(c,d){var f=Math.floor(c/d.rowsPerPage),h=c%d.rowsPerPage,g=d.tableNode.tBodies[f],e=g.rows[h].cells;return e;}function H(){var c=this._renderTimer;if(c){self.clearInterval(c);delete this._renderTimer;this.renderingRows=false;}}mstrmojo.Grid=mstrmojo.declare(mstrmojo.GridBase,null,{scriptClass:"mstrmojo.Grid",rowsPerPage:0,effectiveRh:0,numPagesRendered:0,totalPages:0,pageStatus:null,_defaultPageHeight:0,renderPause:10,rhMin:14,defaultRowsPerPage:100,minRowsPerPage:50,init:function G(c){this._super(c);this.forceFixedSizes=true;},initPageSettings:function N(){var e=this.parent,c=this.defaultRowsPerPage,d=this.cp.getAvailableRowsCount();this.effectiveRh=this.rh||this.rhMin||1;this.effectiveRh=this.effectiveRh*e.model.docModel.getZoomFactor();if(e&&e.numRowFixed){c=d;}else{if(e&&e.scrollboxHeightFixed){c=Math.ceil(e.scrollboxHeight/this.effectiveRh);c=Math.max(c,this.minRowsPerPage);if(e.alwaysShowFirstBlockData&&d<c){c=d;this._shouldRenderNextPage=true;}}}this.pageStatus=[];this.rowsPerPage=c;this.initPageStatus(this.pageStatus);this._defaultPageHeight=this.rowsPerPage*this.effectiveRh;},initPageStatus:function Y(f){var e=this.rowsPerPage,c,h,d,g=function(l,m,j){var k=this;return function(){if(k._onDemand===undefined){k._onDemand=!l.isDataAvailable(m,j);}return k._onDemand;};};this.totalPages=(e&&Math.ceil(this.cp.rc/e))||0;f=f||this.pageStatus;for(c=0;c<this.totalPages;++c){h=c*e;d=h+e-1;if(!f[c]){f[c]={};}delete f[c]._onDemand;f[c].isOnDemand=g.call(f[c],this.cp,h,d);}},buildRendering:function F(){var c=false;if(this.renderMode==="vscroll"){this.initPageSettings();var g=this.pageStatus[0];c=g&&g.isOnDemand();this.start=0;this.end=-1;if(!c){this.end=Math.min(this.cp.rc,this.rowsPerPage)-1;}this.preRenderPages();this.preRenderPage(0,!c);}this._super();if(this.renderMode==="vscroll"){var f=this.parent,e=this,h=function(){e.gridContainerNode.style[a.MINHEIGHT]=(e.cp.rc*e.effectiveRh)+"px";};if(mstrmojo.dom.isIE7){this.gridContainerNode.style.zoom="1";window.setTimeout(h,10);}else{h();}if(!this.connectedScrollbox){if(f&&f.connectScrollbox){f.connectScrollbox(this);this.connectedScrollbox=true;}}this.postRenderPage(0,!c);this.postRenderPages();var d=f&&!f.scrollboxHeightFixed&&!f.numRowFixed;if(d&&this.numPagesRendered>=this.totalPages&&!c){this.postRenderingCleanup();}else{if(c||d||this._shouldRenderNextPage){this.onscroll();delete this._shouldRenderNextPage;}}}},preRenderPages:function Q(){},postRenderPages:function Z(){},configureActions:function L(){var c=this.parent;if(c&&c.configureActions){c.configureActions();}},preRenderPage:function O(c,d){this.pageNum=c;},postRenderPage:function J(d,f,g){if(d+1>this.numPagesRendered){this.numPagesRendered=d+1;}var c=this.pageStatus,e=c[d];if(!e){e=c[d]={};}if(f){e.filled=true;e.dirty=false;}var h=this.gridContainerNode.style;if(d===this.totalPages-1&&h){h[a.MINHEIGHT]="";}},invalidAllPages:function(){for(var c=0;c<this.totalPages;++c){var d=this.pageStatus[c];if(d.filled){d.dirty=true;}delete d._onDemand;d.filled=false;d.isDownloading=false;}this.thPosMap=[];this.posMap=[];},_startPageRenderThread:function b(c){var d=this.id;this.renderingRows=true;this._renderTimer=self.setInterval(function(){try{var g=mstrmojo.all[d];if(!g){return ;}var e=g.getPagesToRender(c);if(e.length>0){g.preRenderPages();g.renderPages(e);g.postRenderPages();g._postPagesClearup=true;}else{if(g._postPagesClearup){g.postRenderPagesCleanup();g.configureActions();g._postPagesClearup=false;}H.call(g);if(g.isRenderingComplete()){g.postRenderingCleanup();}}}catch(f){H.call(mstrmojo.all[d]);throw f;}},this.renderPause);},onscroll:function X(d,c){if(!this.renderingRows){if(d===true){var e=this.parent;if(e&&e.maskNode){V.addClass(e.maskNode,"wait");}}this._startPageRenderThread(c);}},isRenderingComplete:function P(){if(this.end>=this.cp.rc-1){for(var c=this.pageStatus,d=this.totalPages-1;d>-1;d--){if(!c[d]||!c[d].filled){return false;}}return true;}return false;},renderPages:function D(d){for(var e=0,c=d.length;e<c;++e){this.renderPage(d[e].idx,d[e].fill);}},renderPage:function W(l,e){var q=this.pageStatus,h=(this.numPagesRendered>=l+1);if(h){if(!e||(q[l]&&q[l].filled)){return ;}}var o=this.rowsPerPage,j=this.domNode;this.start=l*o;this.end=Math.min(this.start+o,this.cp.rc)-1;this.preRenderPage(l,e);var d=this.tempTable;if(!d){d=this.tempTable=j.ownerDocument.createElement("div");}var n=this.tableNode,m=this.start,f=this.end,k=e?this.buildTableRowsMarkup(m,f,'<table><tbody n="'+this.pageNum+'">',"</tbody></table>",n.style.tableLayout).join(""):'<table><tbody n="'+this.pageNum+'"><tr><td style="height:'+(this.effectiveRh*(this.end-this.start+1))+'px">&nbsp;</td></tr></tbody></table>';d.innerHTML=k;var g=d.firstChild.tBodies[0];if(!h){n.appendChild(g);}else{n.replaceChild(g,n.tBodies[l]);}if(e){this.markPages(m,f);}this.postRenderPage(l,e,g);var c=this.parent;if(c.onPageRendered){c.onPageRendered(g,l,h,e);}},getPagesToRender:function S(s){var q=[],u=this.parent,AE=this._defaultPageHeight,g=null,AF=this.pageStatus,AG=this;function l(j){var m=AF[j];if(m&&(m.filled||m.dirty)){if(!m.height){if(!g){g=AG.tableNode.tBodies;}m.height=g[j].offsetHeight;}return m.height;}else{return AE;}}var k=0,h=null,r=null,d=u.scrollboxTop;for(var AA=0,AB=this.totalPages,c=this.pageStatus;AA<AB;AA++){k+=l(AA);if(k>=d){h=AA;break;}}if(h===null){h=r=AB-1;}else{var t=u.scrollboxBottom;if(isNaN(t)&&u.numRowFixed){t=d;}for(var z=h+1;z<AB;z++){if(k>t){r=z-1;break;}k+=l(z);}}if(r===null){r=AB-1;}for(var v=this.numPagesRendered;v<h;++v){q.push({idx:v,fill:false});}var x=0,AC=this.rowsPerPage,o=false;for(var w=h;w<=r;++w){var AD=AF[w];if(!AD||!AD.filled){if(AD&&AD.isOnDemand()){o=true;if(!AD.isDownloading&&!this.isDownloading){x+=AC;AD.isDownloading=true;this.isDownloading=true;var f=w*AC,e=f+AC-1;this.cp.download(f,e,s);}q.push({idx:w,fill:false});}else{q.push({idx:w,fill:true});}}}if(o){this.parent.showDownloadStatus(x);}else{if(this.parent.closeDownloadStatus){this.parent.closeDownloadStatus();}}return q;},addHilitePosition:function(d,f,c){var g=this.hiliteCellsMap[d];if(!g){this.hiliteCellsMap[d]={pos:[],nodes:[]};}var e=f-(this.pageNum||0)*this.rowsPerPage;this.hiliteCellsMap[d].pos.push({row:e,cell:c,page:this.pageNum});},setHilites:function(f,g){var h=g.getAttribute("ei"),j=this.eiMap[h],c=this.getNodesByPositions(j);if(!c.length){this._super(f,g);return ;}for(var e=0,d=c.length;e<d;e++){this._super(f,c[e]);}},addExtraInfoMap:function(d,e,c){if(!this.eiMap[d]){this.eiMap[d]=[];}this.eiMap[d].push(this.getPosObj(e,c));},addPositionMap:function(d,e,c){if(!this.posMap[d]){this.posMap[d]=this.getPosObj(e,c);}},addTitleHeaderPositionMap:function(e,c,d){var f=this.getPosObj(e,c);f.obj=d;this.thPosMap.push(f);},getPosObj:function(e,g){var f=this.pageNum||0,d=this.rowsPerPage||0;return{row:e-f*d,cell:g,page:f};},getNodeByPosition:function(c){return this.tableNode.tBodies[c.page].rows[c.row].cells[c.cell];},getRowIdxByCell:function(c){var d=this.posMap[c._ei];return d.page*this.rowsPerPage+d.row;},getNodesByPositions:function(l){var h=[];for(var f in l){var n=l[f],e=(n&&n.page)||0,d=n&&n.row,j=n&&n.cell,g=this.tableNode.tBodies[e],k=g&&g.rows[d],m=k&&k.cells[j];if(m){h.push(m);}}return h;},getPageHeight:function R(c){var d=this.tableNode.tBodies;return(d&&d[c]&&d[c].offsetHeight)||0;},getTargetCell:function(l,k){var f=0,d=0,g;for(g=this.totalPages;d<g;d++){f+=this.getPageHeight(d);if(k<=f){break;}}var e=this.tableNode.tBodies[d];if(e){for(d=0,g=e.rows.length;d<g;d++){var o=e.rows[d];for(var c=0,n=o.cells.length;c<n;c++){var m=o.cells[c];if(m.offsetTop+m.offsetHeight>=k){if(l>=m.offsetLeft&&l<=m.offsetLeft+m.offsetWidth){return m;}}else{break;}}}}},postRenderPagesCleanup:function I(){var e=this.parent;if(e&&e.gridData&&e.gridData.afc){var d=this.tableNode;if(d&&(this.lastWidth!==d.offsetWidth)){if(e.onGridWidthChanged){e.onGridWidthChanged();}mstrmojo.array.forEach(this.pageStatus,function(f){delete f.height;});this.lastWidth=d.offsetWidth;}var c=C(e,"adjustAutoWidth");if(c){c.adjustAutoWidth(e);}}if(e.gridPagesRendered){e.gridPagesRendered();}if(mstrmojo.dom.isIE&&!mstrmojo.dom.isIE8){B(this.domNode);}if(e&&e.maskNode){V.removeClass(e.maskNode,"wait");}this.hightLightChangedCells();},hightLightChangedCells:function K(){var m=this.cp.getUpdatedRows(),h=this,l,d,k,n,f,g,j,e=[];if(m){mstrmojo.hash.forEach(m,function(o,c){j=parseInt(c,10);l=h.cp.getRowCells(j);d=E(j,h);k=d.length;n=l.length-1;if(n>=0){for(f=k-1;f>=0;f--){g=d[f];if(n<0){break;}if(l[f]._d){var q=g.style.backgroundColor,p=g.style.color;e.push({dom:g,bgcolor:q,ftcolor:p});g.style.backgroundColor=M.getHighlightColor(M.rgbStr2rgb(a.getStyleValue(g,"backgroundColor"),true));g.style.color=M.getContrastingColor(M.rgbStr2hex(a.getStyleValue(g,"backgroundColor")),"#ffffff","#000000");delete l[f]._d;}n--;}}});if(e.length>0){window.setTimeout(function(){mstrmojo.array.forEach(e,function(c){c.dom.style.backgroundColor=c.bgcolor;c.dom.style.color=c.ftcolor;});},300);}}},postRenderingCleanup:function A(){var d=this.parent;if(d&&this.connectedScrollbox){d.disconnectScrollbox(this);}this.connectedScrollbox=false;if(d&&!d.scrollboxHeightFixed){var e=C(d,"performCanGrowCanShrink");if(e){e.performCanGrowCanShrink([d],true);}}},getRowInfoByPosition:function(c){return this.cp.getRowCellInfo(c);},unrender:function U(c){H.call(this);if(this.connectedScrollbox){this.parent.disconnectScrollbox(this);this.connectedScrollbox=false;}this.numPagesRendered=0;this.lastWidth=0;this.isDownloading=false;this.unMarkAllPages();this._super(c);},dataDownloaded:function T(){this.isDownloading=false;this.initPageStatus();this.onscroll();}});})();(function(){mstrmojo.requiresCls("mstrmojo.GridBase","mstrmojo.Grid");mstrmojo.XtabZone=mstrmojo.declare(mstrmojo.Grid,null,{scriptClass:"mstrmojo.XtabZone",markupString:'<div id="{@id}" class="mstrmojo-XtabZone" style="position:relative;{@cssText}"></div>',markupSlots:{gridContainerNode:function(){return this.domNode;}}});}());(function(){mstrmojo.XtabCP=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.XtabCP",base:null,lookupBase:null,colWidths:null,forceAutoRowHeight:false,startIndexInContainer:0,updatedRows:null,preServeUpdatedRows:true,init:function K(L){mstrmojo.hash.copy(L,this);},initContent:function D(O){this.startIndexInContainer=O||this.startIndexInContainer||0;var N=this.base||[],M=N.show,L=N.items;this.rc=M&&L?L.length:0;this.colWidths=(M&&N.cws)||[];this.isDownloading=false;this.isDownloaded=true;this.invalidData=false;},isDataAvailable:function B(M,L){return !this.invalidData;},download:function A(N,M,L){if(!this.isDownloaded&&!this.isDownloading&&this.dataSource){this.isDownloading=true;this.dataSource.download(0,L);}},invalid:function E(){this.invalidData=true;this.isDownloading=false;this.isDownloaded=false;this.preServeUpdatedRows=true;if(this.gridData){this.oldGridData=this.gridData;this.oldBase=this.base;this.updatedRows={};}},getRowHeight:function C(){return this.gridData.rh;},getNumAutoHeightRows:function(){return this.forceAutoRowHeight?this.rc:0;},getAvailableRowsCount:function J(){return this.rc;},getUpdatedRows:function H(){return this.updatedRows;},getRowCells:function(d){var V=this.base||[],R=V.items||[],f=R[d]||[],T=f.items,h=this.lookupBase,Y=this.interactiveCellsArray,g=this.gridData.css,m=this.gridData.gsi,Z=m&&m.prop&&m.prop.cols&&m.prop.cols.mg,k=null,U,b,Q,j,o,P,c,O,S,N,a="-1";if(this.oldGridData){U=this.oldBase;b=U&&U.items;Q=b[d]&&b[d].items;}for(o=0,j=(T&&T.length)||0;o<j;o++){P=T[o];if(P){P.v=P.v||P.n;if(h&&!P._e){c=h[P.tui];O=P.fi;S=(c&&c.fs)||[];N=S[O]||S[0];P.ts=P.ts||N&&N.bftp;k=c&&c.es[P.idx];if(k){P.v=P.v||k.n;if(k.rv){P.rv=k.rv;}P._e=k;}}if(!P.css){var s=P.cni;if(s!==undefined){P.css=g[s].n;}else{P.css="";}}if(!P._d&&Q&&this.preServeUpdatedRows){var M=Q[o];if(!M||(M.rs!==P.rs)){this.preServeUpdatedRows=false;this.updatedRows={};}else{if((M.v&&P.v!==M.v)){var q={};if(P.v!==M.v){q.v=M.v;}if(P.css!==M.css){q.css=M.css;}P._d=q;this.updatedRows[this.startIndexInContainer+d]=true;}}}P._gd=this.gridData._bidx||0;if(Y){if(P._ei===undefined||Y[P._ei]!==P){P._ei=Y.push(P)-1;}}if(this.axis){P.axis=this.axis;}var l=P.pi,W=function W(r,e){var t=h&&h[r];return t&&t.es[e];},X=function X(t,r,u){var e=t[r].items[u];if(e&&e._e===undefined){e._e=W(e.tui,e.idx);}return e;};if(l){if(l.ri!==undefined&&l.ci!==undefined){if(P.axis===2&&Z!==a){P._p=R[l.ri].items[o];}else{P._p=R[l.ri].items[l.ci];}}else{var p=this.gridData.ghs,n=l.left,L=l.top;if(n){P._lp=X(p.rhs.items,n.ri,n.ci);}if(L){P._tp=X(p.chs.items,L.ri,L.ci);}}}}}return T;},getUnmergedCells:function F(M){var Q=[];rows=(this.base&&this.base.items)||[];if(M>rows.length-1||M<0){return Q;}var O=this.gridData.css,L=rows[M].items[0],R=L&&L.pi,P=R&&R.ri,S=R&&R.ci;while(R&&P>-1&&S>-1){L=L._p||rows[P].items[S];var N={};mstrmojo.hash.copy(L,N);if(!N.css){N.css=O[N.cni].n;}N.rs=L.rs-M+P;Q.splice(0,0,N);R=L&&L.pi;P=R&&R.ri;S=R&&R.ci;}return Q;},getIndentPadding:function I(L){return L*14;},getCell:function G(L,M){var N=this.base.items;return N[L].items[M];}});}());(function(){mstrmojo.XtabVACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabVACP",cps:[],initContent:function G(L){this.startIndexInContainer=L||0;this.rc=0;this.type=0;this.colWidths=[];var J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];K.initContent(this.startIndexInContainer+this.rc);this.rc+=K.rc;this.type|=K.type;var I=K.colWidths;if(I&&(I.length>this.colWidths.length)){this.colWidths=I;}}},getNumAutoHeightRows:function(){return this.cps[0].getNumAutoHeightRows();},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getRowCells(I);},getUnmergedCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getUnmergedCells(I);},getCell:function(I,K){var J=0,L=this.cps[J];while(I>=L.rc){I-=L.rc;L=this.cps[++J];}return L.getCell(I,K);},isDataAvailable:function D(L,K){var J=this._getCPs(L,K),I;for(I=0;I<J.length;++I){if(!J[I].isDataAvailable(L,K)){return false;}}return true;},getAvailableRowsCount:function F(){var K=0,I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(J.isDataAvailable()){K+=J.getAvailableRowsCount();}}return K;},_getCPs:function H(N,L){var J=0,M=this.cps[J],I=M&&M.startIndexInContainer,K=[];if(M){N-=I;L-=I;}while(M&&N>=M.rc){N-=M.rc;L-=M.rc;M=this.cps[++J];}while(M&&L>=M.rc){L-=M.rc;K.push(M);M=this.cps[++J];}if(M){K.push(M);}return K;},invalid:function E(){var I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var I={},J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];if(!K.preServeUpdatedRows){return{};}mstrmojo.hash.copy(K.getUpdatedRows(),I);}this.updatedRows=I;return I;},download:function B(N,M,I){var L=this._getCPs(N,M),J;for(J=0;J<L.length;++J){var K=L[J];K.download(N,M,I);}}});}());(function(){mstrmojo.XtabHACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabHACP",cps:[],initContent:function G(J){this.startIndexInContainer=J||0;this.type=0;this.colWidths=[];var I;for(I=0;I<this.cps.length;++I){this.cps[I].initContent(this.startIndexInContainer);this.type|=this.cps[I].type;var H=this.cps[I].colWidths;if(H){this.colWidths=this.colWidths.concat(H);}}this.rc=Math.max(this.cps[0].rc,this.cps[1].rc);},getNumAutoHeightRows:function(){return Math.max(this.cps[0].getNumAutoHeightRows(),this.cps[1].getNumAutoHeightRows());},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(I){var M=this.cps,J=[],H=M.length,L;for(L=0;L<H;L++){if(M[L].getAvailableRowsCount()>0&&M[L].rc>I){var K=M[L].getRowCells(I);if(K){J=J.concat(K);}}}return J;},getUnmergedCells:function(H){return this.cps[0].getUnmergedCells(H);},isDataAvailable:function D(I,H){return this.cps[1].isDataAvailable(I,H);},getAvailableRowsCount:function F(){return Math.max(this.cps[0].getAvailableRowsCount(),this.cps[1].getAvailableRowsCount());},invalid:function E(){var I,H,J;for(I=0,H=this.cps.length;I<H;++I){J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var H={},I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(!J.preServeUpdatedRows){return{};}mstrmojo.hash.copy(J.getUpdatedRows(),H);}this.updatedRows=H;return H;},download:function B(K,I,H){var J=this.cps[1];J.download(K,I,H);}});}());(function(){mstrmojo.XtabTitlesCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabTitlesCP",init:function F(I){this._super(I);},download:function B(K,J,I){},shouldClonedLastTitleCell:function H(){return(this.gridData.lhv!==0);},initContent:function E(Q){this.startIndexInContainer=0;if(!this.cts){this.cts=mstrmojo.hash.clone(this.gridData.gts.col);}var J=this.gridData.gts,L=J.row||[],I=J.col||[],S=J.show,P=J.rec,Y=this.cts||[],X=L.length,R=Y.length,V=this.gridData.css;this.base={items:[]};this.rc=(S&&Y.length)||0;if(this.rc===0&&S){this.rc=X>0?1:0;}this.colWidths=(S&&J.cws)||[];if(!this.rc){this.nRowSpan=this.nColSpan=0;return ;}var N={items:[]},T=0,K=1,U,W,a=this,M=a.base.items,Z=function(b,c){if(a.shouldClonedLastTitleCell()&&c>1){b.rs=1;U=mstrmojo.hash.clone(b,{});U.n="&nbsp;";b.cni=V.push({n:(V[b.cni].n||"")+" fsbp_1"})-1;}},O=function(d){var b=d;while(b-->1){if(a.shouldClonedLastTitleCell()){var c=mstrmojo.hash.clone(U,{});c.cni=V.push({n:(V[c.cni].n||"")+" fsbp_"+((b==1)?"3":"2")})-1;M.push({items:[c]});}else{M.push({items:[]});}}};for(W=0;W<X;++W){L[W].axis=1;L[W].ui=W;T+=L[W].cs||1;N.items.push(L[W]);}if(R>0){Y[0].axis=2;Y[0].ui=0;I[0].axis=2;I[0].ui=0;K=Y[0].rs||1;Z(Y[0],K);T+=Y[0].cs||1;N.items.push(Y[0]);}M.push(N);for(W=1;W<R;++W){if(K>1){O(K);}Y[W].axis=2;Y[W].ui=W;I[W].axis=2;I[W].ui=W;K=Y[W].rs||1;Z(Y[W],K);M.push({items:[Y[W]]});}this.rc=M.length;this.nRowSpan=this.rc+K-1;this.nColSpan=T;if(P){this._removeExtraColumn(L,Y);}},getAvailableRowsCount:function D(){return this.rc;},getSpanDimension:function A(){return{nRow:this.nRowSpan||0,nCol:this.nColSpan||0};},isDataAvailable:function C(J,I){return true;},_removeExtraColumn:function G(L,b){var Z=L&&L.length,Q=b&&b.length,I=this.gridData.gts,T=I.row||[],O=I.col||[],J=T.length,X=O.length;if(!Z||!Q){if(Q===1){var c=b[Q-1];if(c.otp==-1){if(X>0){O[X-1]._hid=true;}this.base.items=[];this.nRowSpan=this.nColSpan=this.rc=0;}}return ;}var K=L[Z-1],U=this.rc,M=this.base.items;if(K){if(K.otp==-1){if(J>0){T[J-1]._hid=true;}if(this.nColSpan){this.nColSpan-=K.cs||1;}M[0].items.splice(Z-1,1);}else{var R=U>1?U-1:0,S=M[R],a=S.items.length;if(a>0&&X>0){O[X-1]._hid=true;}var N=K.fix;if(N){var Y;for(Y=0;Y<N;Y++){S.items[a-1+Y]=L[Z-N+Y];}}else{S.items[a-1]=K;}for(var W=0,V=Q-1;W<V;W++){b[W].cs=N?N:K.cs;}var P=N?N:1;M[0].items.splice(Z-P,P);if(this.nColSpan){this.nColSpan-=1;}}}return ;}});})();(function(){mstrmojo.XtabOnDemandCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabOnDemandCP",blockNum:0,listeners:null,initContent:function E(F){if(F!==undefined){this.startIndexInContainer=F;}this.isDownloaded=(this.base!==null);this.isDownloading=false;if(this.base){this._super(this.startIndexInContainer);this.notifyListeners();}},addCPListener:function D(F){if(!this.listeners){this.listeners=[];}this.listeners.push(F);},notifyListeners:function C(){var F,H=this.listeners,G=(H&&H.length)||0;for(F=0;F<G;F++){if(H[F]&&H[F].onDemandDataReady){H[F].onDemandDataReady(this);}}},getAvailableRowsCount:function B(){return this.isDownloaded?this.rc:0;},download:function(F){if(!this.isDownloaded&&!this.isDownloading){this.isDownloading=true;this.dataSource.download(this.blockNum,F);}},invalid:function(){if(this._super){this._super();}this.isDownloaded=false;this.isDownloading=false;},isDataAvailable:function A(G,F){return this.isDownloaded;}});})();(function(){var a=1,e=2,n=4,W=8,g=1,h=2,G=3,c=4,m=5,U=6,M=7,k=8,X=4,F={},B={},I=4,R=1,J={TITLE:"ig-title",GROUPING:"iggroup",BANDING:"igbanding",RIGHT_ALIGN:"rtAlign",LEFT_ALIGN:"leftAlign",TOTAL_ROW:"total"},T=mstrmojo.hash,V=mstrmojo.array;function Z(s,q){var r=s[0],o=q.gts,p=o.cws.length;return(q.vp.gr==="1"&&(p>1));}function j(p,u){var s=function(v,w){if(w&&v&&v.css&&v.css.indexOf(w)<0){v.css+=" "+w;}};var r=u.type,q=u.col,t=(q&&q.cl)||0,o=(r===e||r===a);if(r===e||r===W){s(p,J.RIGHT_ALIGN);}else{if(r===a||r===n){s(p,J.LEFT_ALIGN);}}if(o){if(q&&q.tg&&t>1){if(!p._v){p._v=p.v;p.v="<span class='toggleHeader'>"+p.v+"</span>";}}s(p,J.TITLE);}V.forEach(u.extraCss,function(v){s(p,v);});}function A(o){return 0;}function l(s){var q,r=s.cg,o=r&&r.cgc,p=1;for(q=0;q<o;q++){if(r&&r[q]&&!r[q].tg&&r[q].cl>p){p=r[q].cl;}}return p;}function N(p,o){var q=m;if(o===2){if(p===0){q=g;}else{if(p===1){q=c;}}}else{if(o>2){if(p===0){q=g;}else{if(p===1){q=h;}else{if(p===o-1){q=c;}else{if(p<o-1&&p>1){q=G;}}}}}}return q;}function L(o,s,q,p){var u=p&&p.cols&&p.cols.cg,r,v=0,t=0;if(u){for(r=0;r<s;r++){if(o[r]){v+=o[r].length;}}v+=(q+1);for(r=0;r<u.cgc;r++){t+=u[r].cl;if(t>=v){return r;}}}return -1;}function P(v,r,p,o){var u=[],t,q,s,w;for(q=0,s=v.length;q<s;q++){if(v[q].length===1){t=v[q][0];t.rowType=(t.rowType!==k)?N(r,p):k;t.singleStack=(p>1);t=T.copy(t);if(t.ts===I){if(p===1){t.rowType=m;t.colIdx=L(v,q,r,o);}else{if(!r){t.colIdx=L(v,q,r,o);}else{delete t.ts;t.v="";}}}else{if(r){t.v="";}}}else{t=v[q][r];if(!t){w=v[q].length;t=T.copy(v[q][w-1],{});t.v="";if(t.hasOwnProperty("ts")){delete t.ts;}}else{if(t.ts===I){t.colIdx=L(v,q,r,o);}}t.rowType=(t.rowType!==k)?N(r,p):k;}u.push(t);}return u;}function Q(o){if(o===0){return 0;}var p=this.sectionMap[o-1]||0;return Math.floor((o-p)/this.stackLevels);}function D(v){var t,u,r=this.sectionInfo,o=r.length,q=this.srh,p=this.lastSectionIndex;u=r[p];if(v>=u.rs&&v<(u.rs+q)){return u;}if(v<u.rs){t=p-1;if(t<=0){this.lastSectionIndex=0;return null;}do{u=r[t];if(v>u.rs&&v<=(u.rs+q)){this.lastSectionIndex=t;return u;}}while(v<u.rs&&--t>0);this.lastSectionIndex=t;return u;}else{t=p+1;if(t>=o){this.lastSectionIndex=o-1;return null;}do{u=r[t];if(v>u.rs&&v<=(u.rs+q)){this.lastSectionIndex=t;return u;}}while(v>(u.rs+q)&&++t<o);this.lastSectionIndex=t-1;return null;}}function d(w,q,o,v){var u=w[0],s,t=w.length,p=u&&u.rowType,r={v:"",css:"empty-igcell",rowType:p};if(o!==undefined&&u&&(p===g||p===m||p===U)){r={v:'<div><div class="IG-ActionArrow-IMG" style="height:'+v+"px;top:-"+(0.5*F[p])+'px;"></div></div>',css:"IG-ActionArrow",_ei:o};}for(s=t-1;s>=t-q;s--){u=w&&w[s];if(u){u.css+=" IG-lastdatacolumn";}}w.push(r);}function S(AJ,AE,q){var AA=AJ.cols,AB=AA.cg,o=[{w:"0px"}];if(AA&&AE){var AK=AA.cws,p=[],AI=AK.length,AM=0,v=(parseInt(AJ.ar,10)===1)?(AE/AI):-1,z,r,y=false,s=0,AC=AE,AD=0,AH;for(AH=0;AH<AI;AH++){r=p[AH]=AK[AH];z=r.w;if(z===""){y=true;}else{if(r.xc){AM+=parseInt(z);AC-=AM;s++;}else{AD+=parseFloat(z,10);}}}if(y||AD<100){v=AC/(AI-s);}for(AH=0;AH<AI;AH++){r=AK[AH];if(r.xc){continue;}else{if(v===-1){z=parseInt(r.w,10)*AC/100;if(!z&&z!==0){z=parseInt(AC/AB.cgc,10);}}else{z=(parseInt(r.w,10)<0)?0:v;}}p[AH]={w:z+"px"};}if(q){return p;}var x=[],AG=0;for(AH=0;AH<AI;AH++){var AL=AB[AH],u=AL.tg?AL.cl:1,AF=0;for(AF=0;AF<u;AF++){var t="0px";if(AF===AL.cc){t=p[AH].w;}x[AG+AF]={w:t};}AG+=u;}return x.concat(o);}else{if(q){return null;}else{return cp.cws.concat(o);}}}function C(){delete this.lastStackCols;delete this.lastAttRow;delete this.lastMtxRow;}mstrmojo.InteractiveGridHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.InteractiveGridHACP",sectionMap:[],stackLevels:1,gridWidth:480,tdWidths:null,lastSectionIndex:0,adjustCPMaps:function O(){var x=this.cps,w=this.cps[0],AC=Math.max(x[0].rc,x[1].rc);if(w.type!==a){var AH=this.gridData,AB=function(AK,AN){var AJ=AK.base.items,AL=AK.lookupBase[0].es,AM=AJ[AN].items[0],AI=AL&&AL[AM.idx];return(AI&&AI.n)||((AM.pi&&AL[AM.pi.ri||0])||"");},AF,AE,o=1,u,p,z,r=0,q=-1,AA,AG,AD=0,y=this.groupEnabled;for(AA=0,AF=0,AG=w.cps?w.cps.length:1;AA<AG;AA++){var t=w.cps?w.cps[AA]:w,v=t.rc;r=q+1;q=r+v-1;if(t.isDataAvailable(r,q)){if(t.lastRow){AD=t.lastRow;p=t.lastSection;}else{AF=AD||0;for(AE=0,o=this.sectionMap[AF-1]||0;AE<v;AE++){var s=this.stackLevels;z=AB(t,AE);if(y&&z!==p){p=z;this.sectionInfo.push({sn:z,rs:this.srh*o+this.stackedRh*Math.floor((AF-o)/this.stackLevels)});this.sectionMap[AF]=++o;AF++;}while(s){this.sectionMap[AF]=o;s--;AF++;}}AD=t.lastRow=AF;t.lastSection=z;}}else{break;}}this.rc=(this.stackLevels>1?AC*this.stackLevels:AC)+(y?o:0);}},onDemandDataReady:function b(){this.adjustCPMaps();},initContent:function Y(x){var w=this.cps,AI=this.gridData=w[0].gridData||w[0].cps[0].gridData,AE=AI.vp=this.gridVp=this.gridVp||AI.vp,q=AE.daf&&AE.daf.split(":"),y=AE.cols,z=y.cg,AF=y.cws,v=w[A(z)],AC=AI.gts.row,p=AI.gts,AG=Z(w,AI),u=v.type!==a,AB,AD,s,o,AA,t,AH,r=(typeof (mstrMobileApp)!=="undefined"&&mstrMobileApp.getDeviceDPI)?mstrMobileApp.getDeviceDPI():160;if(r===160){F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}else{if(r===213){F={1:45,2:31,3:26,4:39,5:71,6:40,7:35,8:71};B={1:15,2:15,3:2,4:21,5:21};}else{if(r===240){F={1:50,2:34,3:30,4:44,5:80,6:40,7:40,8:80};B={1:16,2:16,3:2,4:24,5:24};}else{if(r===320){F={1:67,2:44,3:38,4:58,5:107,6:40,7:53,8:107};B={1:22,2:22,3:2,4:32,5:32};}else{F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}}}}if(u){if(AE.dafIdx===undefined&&q){for(AB=0;AB<AC.length;AB++){if(AC[AB].id===q[0]&&AC[AB].fid===q[1]){AE.dafIdx=AB;break;}}}}for(AB=0;AB<z.cgc;AB++){if(z[AB]&&z[AB].tg){break;}}if(AB===z.cgc){AI.gts.show=false;AI.ghs.chs.show=false;}this._super(x);this.colWidths=S(AE,this.gridWidth);this.tdWidths=S(AE,this.gridWidth,true);if(u){this.stackLevels=l(y);if(this.stackLevels>1){this.srh=F[M];this.rh=F[m];this.mrh=F[G];this.stackedRh=F[g]+(this.stackLevels-2)*F[h]+F[G];}else{this.srh=F[M];this.rh=this.stackedRh=this.mrh=F[m];}if(AG||this.stackLevels>1){this.sectionMap=[];this.sectionInfo=[];this.groupEnabled=AG;this.adjustCPMaps();o=this.cps[0].cps;if(o){AH=this;for(AB=0,AD=o.length;AB<AD;AB++){t=o[AB];if(t&&t.addCPListener){t.addCPListener(AH);}}}}}},getUnmergedCells:function(o){return ;},getResolvedGroupHeader:function(q,t){var p=this.gridData,s=p.gts.row[t].es,o=p.ghs.rhs.items[q].items[t];if(o){if(!o.css){o.css=p.css[o.cni].n+" iggroup";o.n=s[o.idx].n;}}else{return{css:" iggroup",n:""};}return o;},getRowCells:function(AG){var AB=this.cps,u=[],AU=this.gridData,AQ=AU.vp,AE=AQ.cols.cg,z=AB[A(AE)],AD=this.groupEnabled,q=AQ.bn==="1",AR=[],AF=Q.call(this,AG),v,r,AH=1,AA,o,x,AN,AM,AP,AT,y;if(AD&&(this.sectionMap[AG]!==this.sectionMap[AG-1])){var s=T.copy(z.getRowCells(AF)[0],{});s.cs=this.colWidths.length;s.rowType=M;j(s,{col:null,type:z.type,extraCss:[J.GROUPING]});return[s];}if(!AG){C.call(this);}this.lastAttRow=this.lastAttRow||(AB[0].rc?AB[0].getRowCells(AF):[]);this.lastMtxRow=this.lastMtxRow||(AB[1].rc?AB[1].getRowCells(AF):[]);x=this.lastAttRow;AP=x.length;if(AP>0&&x[0].stt){AA=true;for(AN=0;AN<AP;AN++){AT=x[AN];if(AT.stt===R){o=AT;break;}}}if(!this.lastStackCols){V.forEach([this.lastAttRow,this.lastMtxRow],function(p){for(AN=0;AN<p.length;AN++){if(p[AN]._ei!==undefined){if(AQ.dafIdx>=0){y=z.getRowCells(AF)[AQ.dafIdx];}v=(AQ.dafIdx>=0)?(y&&y._ei):"";return false;}}},this);var AL=function(p,AV){if(p&&(AV.type===a||AV.type===e)){if(AJ.tg===false){p.n=p.v="";}p.rowType=k;}j(p,{col:AJ,type:AV.type,extraCss:[((AV.type===W||AV.type===n)&&q&&(AF%2===1))?J.BANDING:null,AA?J.TOTAL_ROW:null]});if(p){p.cs=1;if(p._ei===undefined&&AQ.dafIdx!==undefined){p._ei=v;}}};this.lastRowIndex=0;for(AM=0;AM<AE.cgc;AM++){var AJ=AE[AM],AO=AJ["mix"+AJ.cc],t=AO!==undefined,w=AB[t?1:0],AK,AI,AC,AS={n:"",stt:R,css:"xtab-td"};arr=[];if(AJ.tg){for(var AN=0;AN<AJ.cl;AN++){arr=[];AC=t?AJ["mix"+AN]:AJ.attForms[AN].idx;var x=t?this.lastMtxRow:this.lastAttRow;AT=x[AC];if(AA){if(!AT){AT=AS;}else{if(AT&&AT.stt===R){AT=T.copy(o,AS);}else{AT=T.copy(AT,{});}}}else{AT=T.copy(AT,{});}AL(AT,w);arr.push(AT);AR.push(arr);}if(AM+1===AE.cgc){AH=AJ.cl;}}else{for(AK=0,AP=AJ.cl;AK<AP;AK++){if(t){AI=AJ["mix"+AK];if(AI!==undefined){AT=this.lastMtxRow[AI];}}else{AI=AJ.attForms[AK];if(AI){AT=this.lastAttRow[AI.idx];}if(AA&&!AT){AT=AS;}}AL(AT,w);arr.push(AT);}AR.push(arr);}}this.lastStackCols=AR;}u=P(this.lastStackCols,this.lastRowIndex++,this.stackLevels,AQ);if(this.lastRowIndex>=this.stackLevels){C.call(this);}return u;},getRowHeight:function E(p){var o=F[m];return F[p]||o;},getPadding:function K(o){return B[o]||B[X];},isDataAvailable:function f(p,o){if(!this.onDemandIF||!this.cps[1].cps){return true;}else{var r=this.sectionMap.length,q;if(!r){return this.cps[1].isDataAvailable(p,o);}if(o>r){if(p<r){q=Q.call(this,p);return this.cps[1].isDataAvailable(q,q+(o-p));}else{return false;}}else{return this.cps[1].isDataAvailable(Q.call(this,p),Q.call(this,o));}}},download:function H(u,r,v){var q=Q.call(this,u),o=q+Math.ceil((r-u)/this.stackLevels),s=this.cps[0],p,w,t=!s.cps?[s]:this.cps[0]._getCPs(q,o);for(p=0;p<t.length;++p){w=t[p];w.download(q,o,v);}},getRowCellInfo:function(r){var q=D.call(this,r+this.srh),o,p=this.lastSectionIndex;if(q){o=this.sectionInfo[p-1];return{rowStart:q.rs,isNextRowNewSection:true,sectionName:o&&o.sn};}else{return{isNextRowNewSection:false,sectionName:this.sectionInfo[p].sn};}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo.XtabZone","mstrmojo._ShowsStatus","mstrmojo.boxmodel","mstrmojo._IsLockableXtab","mstrmojo._IsDocumentTemplate","mstrmojo.hash","mstrmojo.dom","mstrmojo.chart.model.enums.EnumDSSBaseFormType");var Q=1,X=2,Y=0,C=1,x=2,N=3;var M=1;var z=2;var I=4;var g=8;var d=mstrmojo.dom,p;function AD(AF){var AG=null;if(AF&&AF.length>1){AG=new mstrmojo.XtabVACP();AG.cps=AF;}return AG;}function J(AG){if(!AG||this._onDemandCP){return null;}var AN=AG.bc,AL=AG.tc,AH=AL-AN,AM=Math.ceil(AH/AN),AI=[],AK=[],AJ;for(AJ=0;AJ<AM;++AJ){var AF=Math.min(AH,AN);AI.push(this.createOnDemandCP(AJ+1,AF,I));AK.push(this.createOnDemandCP(AJ+1,AF,g));AH-=AN;}this._onDemandCP={rhs:AI,vls:AK};return this._onDemandCP;}mstrmojo.XtabTitlesCP.prototype.shouldClonedLastTitleCell=function(){return false;};mstrmojo.XtabBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsLockableXtab,mstrmojo._HasScrollbox,mstrmojo._ShowsStatus,mstrmojo._IsDocumentTemplate],{scriptClass:"mstrmojo.XtabBase",dataRenderMode:"vscroll",shouldClipLockableXtab:true,alwaysShowFirstBlockData:false,handleClicks:function H(){return true;},markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-Xtab {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div style="display: none;{@msgNodeCssText}"><div class="text"><div class="warning-icon"></div><div>&nbsp;</div></div></div><div class="mstrmojo-Xtab-overlay"></div><div class="mstrmojo-Xtab-content {@cssDefault}" title="{@tooltip}" style="{@viewportCssText}" mstrAttach:click,selectstart><table cellspacing="0" cellpadding="0"><tr><td style="vertical-align:top;padding:0;"><div style="position: relative;"><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_scrollbox" style="position:relative;{@scrollboxNodeCssText};{@scrollboxNodeOverflow}"></div></div></td></tr></table></div></div>',markupSlots:{overlayNode:function(){return this.domNode;},msgNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.childNodes[1];},viewport:function(){return this.domNode.lastChild;},contentNode:function(){return this.domNode.lastChild.firstChild;},scrollboxNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.lastChild;},tableContainerNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild;},_STATUS:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild;},_STATUS_TXT:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.firstChild;},_TB_CELL:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},zone:null,lockHeadersCase:N,interactiveCellsArray:null,titlesCP:null,chsCP:null,rhsCP:null,valuesCP:null,onDemandIF:true,numRowFixed:false,heightLimit:0,height:0,widthLimit:0,width:0,useTouchScrolling:false,scrollInterval:0,selections:null,dataBlocks:null,getCellUnitIndex:function m(AF){return(AF.o!==undefined)?AF.o:AF._ei;},getCellTitleId:function e(AF){var AG="";if(AF.axis&&AF.ui!==undefined){AG=AF.axis+"A"+(AF.ui+1);}else{if(AF.mix!==undefined){AG="0A"+AF.mix;}}return AG;},update:function k(AG){this.set("gridData",AG.data[0]||AG.data);var AF=this.defn||AG.defn;this.sid=this.gridData.sid;this.treeType=(AF&&AF.tt)||1;this.interactiveCellsArray=[];if(this._super){return this._super(AG);}return true;},initCP:function F(AH,AG,AM,AJ,AL,AI,AK){var AF={gridData:AH,type:AM,interactiveCellsArray:AG,defn:this.defn};AF.base=AJ||AF.base;AF.lookupBase=AL||AF.lookupBase;AF.axis=AI||AF.axis;if(!AK){if(AM===M){AK=new mstrmojo.XtabTitlesCP(AF);}else{AK=new mstrmojo.XtabCP(AF);}}else{mstrmojo.hash.copy(AF,AK);}return AK;},preBuildRendering:function D(){var AH=this.gridData,AF=this.height,AG=this.width;this.lockHeadersCase=AH.lhv||Y;this.selections={};this.numRowFixed=!!(!AF&&AH.rw&&AH.rw.row&&(AH.rw.row.bc<AH.rw.row.tc));this.rw=AH.rw;this._onDemandCP=null;if(AG){this.widthLimit=parseInt(AG,10);}if(AF){this.heightLimit=parseInt(AF,10);}return this._super();},renderEmptyGrid:function q(){var AI=this.gridData,AG=this.msgNode,AH=AG.style,AF=this.viewport;AG.firstChild.childNodes[1].innerHTML=AI.eg;if(AI.eg!==""){AH.display="block";AH.overflow="hidden";AG.className="mstrmojo-message";AF.style.display="none";}return true;},postBuildRendering:function U(){var AK=this.gridData,AH=!!this.viewport&&AK,AG=this.msgNode,AF=this.viewport,AJ;if(AK.eg===undefined){if(AG.style.display==="block"){AG.style.display="none";AF.style.display="block";}}else{return this.renderEmptyGrid();}if(!this.interactiveCellsArray){this.interactiveCellsArray=[];}if(AH){AK.ghs=AK.ghs||[];AK.gts=AK.gts||[];this._setupZone(AK);this._setupCP(AK);var AM=this.zone;if(AM.parent!==this){this.addChildren(AM);}if(this.scrollboxNode){var AI=this.heightLimit;this.scrollboxHeightFixed=!isNaN(AI)&&(AI>0);if(this.scrollboxHeightFixed){this.scrollboxHeight=AI;}this.scrollboxLeft=this.scrollboxTop=0;this.connectScrollbox(this);}}this.renderChildren();if(this.controller&&this.controller.getScrollPosition){var AL=this.controller.getScrollPosition(this.gridData.datasetId+"."+this.gridData.k);if(AL){this.scrollTo(AL);}}AJ=this._super();if(this.numRowFixed){if(!this.height){this.heightLimit=this.zone.getPageHeight(0);this.height=this.heightLimit+"px";}else{this.heightLimit=parseInt(this.height,10);}}if(((AH&&this.scrollboxNode&&AK.afc)||this.numRowFixed)||(!AK.afc&&this.scrollboxNodeCssText.indexOf("width")<0)&&this.scrollboxNode.scrollWidth>this.scrollboxNode.clientWidth){this.resizeScrollBox();}this.onGridWidthChanged(true);this._onContainerGrowShrink(this.widthLimit,this.heightLimit);if(d.isIE7&&!this.scrollboxHeightFixed&&this.scrollboxNode&&this.scrollboxNode.scrollWidth>this.scrollboxNode.offsetWidth){this.scrollboxNode.style.height=this.scrollboxNode.offsetHeight+17+"px";}if(this.lockHeadersCase&&this.initLock){this.initLock({top:this.scrollboxTop,left:this.scrollboxLeft});}if(this.configureActions){this.configureActions();}return AJ;},onclick:function n(AG){var AI=mstrmojo.dom,AK=AG.getTarget(),AJ=AK&&AI.findAncestorByName(AK,"td",true,this.viewport);if(AK.nodeName.toLowerCase()==="a"&&AJ.getAttribute("ei")){try{var AH=this.interactiveCellsArray[parseInt(AJ.getAttribute("ei"),10)];if(AH&&AH.ts===mstrmojo.chart.model.enums.EnumDSSBaseFormType.DssBaseFormHTMLTag){AK.href=mstrmojo.addCSRFTokenToURL(AK.href);}}catch(AL){}}if(AJ){var AF=AI.findAncestorByName(AK,"span",true,AJ);if(AF&&!AG.shiftKey&&!AG.ctrlKey){this.defaultAction(AJ);}else{this.doSelection(AG.e,AG.hWin,AJ);}}if(this.isSelectingText){this.isSelectingText=false;}},ontouchend:function h(AG,AF){this.onclick(mstrmojo._HasMarkup.newDomEvent("click",AF,AG));},onselectstart:function r(){return false;},onscroll:function s(){this._alignHeaders();if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.gridData.datasetId+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}},resizeScrollBox:function K(){var AI=this.scrollboxNode,AH=AI&&AI.style,AG=this._TB_CELL;if(!AH||!AG){return ;}var AF=this.heightLimit;if(!AF){AH.height="auto";this.scrollboxHeightFixed=false;}else{if(AF>0){AH.height=AF+"px";this.scrollboxHeight=AF;this.scrollboxHeightFixed=true;}}this._resizeScrollBoxWidth();},_onContainerGrowShrink:function AE(AG,AJ){var AF=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection),AI=AG||null,AH=AJ||null;if(AI||AH){if(AF){AF.fixedSizeCanGrowShrink(this,AH,AI);}}else{if(AF){AF.performCanGrowCanShrink([this],true);}}},_resizeScrollBoxWidth:function V(){var AJ=this.scrollboxNode,AG=AJ&&AJ.style,AF=this._TB_CELL;if(this.useTouchScrolling||!AG||!AF){return ;}var AH=this.widthLimit;if(!AH){AG.width="auto";}var AI=function(){var AK=(mstrmojo.dom.isIE7?(AF.scrollWidth+1):(AF.scrollWidth+(AJ.offsetWidth-AJ.clientWidth)));if((AK&&(AK>0))&&(!AH||(AH&&(AK<AH)))&&(AJ.firstChild.firstChild.offsetWidth>=AJ.clientWidth)){AG.width=AK+"px";}};if(mstrmojo.dom.isIE7){window.setTimeout(AI,1);}else{AI();}},onGridWidthChanged:function c(AG){if(!AG){this._resizeScrollBoxWidth();}var AF=this.widthLimit;if(!AF){this.width=p;}this._onContainerGrowShrink(AF,null);},getGridDimension:function R(AI){var AG=1,AH=AI===AG?"Height":"Width",AJ=AH.toLowerCase(),AF=this[AJ+"Limit"];if(!AF&&(this[AJ]===p||this[AJ]===0)){AF=this.viewport["offset"+AH];this[AJ]=AF+"px";return AF;}return AF||parseInt(this[AJ],10);},_alignHeaders:function B(AF){var AH=this.scrollboxLeft,AG=this.scrollboxTop;if(this.lockHeadersCase&&this.alignLockNodes){this.alignLockNodes(AH,AG);}},defaultAction:function S(AK,AG){var AF=AG||this.getCellForNode(AK),AJ=AK&&AK.className.indexOf("sc_")>0;if(this.model&&this.model.data&&this.model.data.visName&&this.model.data.visName==="InteractiveGridAjaxVisualizationStyle"){AJ=this.isReselectedTD(AF);if(AJ&&this.hasSelectAll&&this.hasSelectAll(AF)){this.IGCurrentSelectedCell=null;}else{this.IGCurrentSelectedCell=AF;}}var AI=this.model.getAction(this.getActionCells(AF),AK,AJ),AH=AI&&AI.h;this._currentSelectedTD=AK;if(AH&&this.controller[AH]){this.controller[AH](this,AI.a);return true;}return false;},createZone:function l(AG){var AH=AG||{},AF=this._super&&this._super(AH);if(!AF){AF=new mstrmojo.XtabZone(AH);}return AF;},_setupZone:function t(AJ){this.zones={};if(!this.zone){this.zone=this.createZone({renderMode:this.dataRenderMode,cssText:"z-index: 1",slot:"scrollboxNode"});}var AF=this.zone;this.zones.origin=AF;AF.rh=AJ.rh;AF.autoFitWindow=!!AJ.afw;if(!this.isVIXtab){AF.tableCssClass="r-cssDefault"+(this.k?"_"+this.k:"");}AF.numColumnCanMerge=AJ.gts&&AJ.gts.cws?(AJ.gts.cws.length-1):0;var AK=[],AH=undefined,AL=null,AI,AG;mstrmojo.array.forEach(AJ.gts&&AJ.gts.row,function(AM){AI=AL&&AL.id===AM.id;if(AI){AK[AK.length-1]+=AM.fs&&AM.fs.length||1;}else{if(AM.otp===-1){AH=0;mstrmojo.array.forEach(AK,function(AN){AH+=AN;});}AK.push(AM.fs&&AM.fs.length||1);}AL=AM;});AF.acws=AK;AF.rowMerge=AJ.gsi&&AJ.gsi.prop&&AJ.gsi.prop.rows&&AJ.gsi.prop.rows.mg!=="0";AG=AJ.ghs&&AJ.ghs.chs;AF.headerOffset=AG&&(AG.show?(AG.items&&AG.items.length||1):0)-1;AF.mxPos=AH;},getHACP:function AC(){return(this._super&&this._super())||new mstrmojo.XtabHACP();},_setupCP:function W(AL){var AI=this.titlesCP=this.getTitleCP(AL),AK=this.chsCP=this.getColumnHeadersCP(AL),AG=this.rhsCP=this.getRowHeadersCP(AL),AH=this.valuesCP=this.getValuesCP(AL);AI.forceAutoRowHeight=AK.forceAutoRowHeight=AL.rh;var AO=new mstrmojo.XtabVACP();var AF=this.getHACP();AF.cps=[AI,AK];AO.cps=[AF];var AM=this.getHACP();AM.cps=[AG,AH];AO.cps.push(AM);var AN=AL.gmh&&AL.gmh.gmrh,AJ=AL.rw&&AL.rw.row;if(AN&&AJ){AO.gsmh={};AO.gemh={};AO.gsmh[AJ.bb]=AN.gsmh;AO.gemh[AJ.bb+AJ.bc-1]=AN.gemh;}this.zone.cp=AO;},ongridDataChange:function Z(){var AF=this.model;if(AF){AF.set("data",this.gridData);if(!this.dataBlocks){this.dataBlocks=[];}this.dataBlocks[0]=this.gridData;}},gridPagesRendered:function b(){if(this._super){this._super();}},getTitleCP:function G(AF){return this.initCP(AF,this.interactiveCellsArray,M);},getColumnHeadersCP:function y(AF){return this.initCP(AF,this.interactiveCellsArray,z,AF.ghs&&AF.ghs.chs,AF.gts&&AF.gts.col,X);},getRowHeadersCP:function AA(AF){var AG=this.initCP(AF,this.interactiveCellsArray,I,AF.ghs&&AF.ghs.rhs,AF.gts&&AF.gts.row,Q);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){J.call(this,this.rw&&this.rw.row);}this.rhsCPList=[AG].concat(this._onDemandCP.rhs);return AD(this.rhsCPList)||AG;}return AG;},getValuesCP:function a(AG){var AF=this.initCP(AG,this.interactiveCellsArray,g,AG.gvs,AG.gts&&AG.gts.col);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){J.call(this,this.rw&&this.rw.row);}this.valuesCPList=[AF].concat(this._onDemandCP.vls);return AD(this.valuesCPList)||AF;}return AF;},createOnDemandCP:function f(AG,AH,AF){var AI=new mstrmojo.XtabOnDemandCP();AI.dataSource=this;AI.blockNum=AG;AI.rc=AH;return AI;},dataDownloaded:function T(AG,AM){var AO=AM.blockNum,AF=this.rhsCPList[AO],AH=this.valuesCPList[AO],AN=AG.data,AK=this.gridData;AN._bidx=AO;this.dataBlocks[AO]=AN;if(!AF||!AH){return ;}this.initCP(AN,this.interactiveCellsArray,I,AN.ghs&&AN.ghs.rhs,AN.gts&&AN.gts.row,Q,AF);this.initCP(AN,this.interactiveCellsArray,g,AN.gvs,AK.gts&&AK.gts.col,null,AH);AF.initContent();AH.initContent();this.numRowsDownloaded+=parseInt(AF.rc,10);this.updateStatus(mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);var AJ=this.zone;if(AJ){var AL=AJ.cp;if(AL){var AP=AN.gmh&&AN.gmh.gmrh,AI=AN.rw&&AN.rw.row;if(AP&&AI){AL.gsmh[AI.bb]=AP.gsmh;AL.gemh[AI.bb+AI.bc-1]=AP.gemh;}}AJ.dataDownloaded();}},showDownloadStatus:function P(AF){if(!AF){return ;}if(this.showingStatus){this.numRowsToDownload+=AF;}else{this.numRowsToDownload=AF;this.numRowsDownloaded=0;}if(this.showStatus){this.showStatus(true,mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}},closeDownloadStatus:function j(){this.numRowsToDownload=0;if(this.showStatus){this.showStatus(false);}},download:function L(AI,AF){var AK=this.gridData.rw,AH=AK.row,AJ=AK.col,AG=AH.bc;this.rhsCPList[AI].isDownloading=this.valuesCPList[AI].isDownloading=true;if(AG){this.controller.onDownloadGridData(this,this.model.getDownloadAction(AI*AG+1,AG,AJ.bb,AJ.bc,this.id,{blockNum:AI},AF));}},unrender:function E(AF){this.width=this.widthLimit=this.height=this.heightLimit=0;this.disconnectScrollbox(this);this._super(AF);},getCellForNode:function w(AG){var AF=AG&&parseInt(AG.getAttribute("ei"),10);if(isNaN(AF)){return null;}return this.interactiveCellsArray[parseInt(AF,10)];},getActionCells:function O(AF){var AG=[],AI=this.selections;var AJ=AF.axis+"A"+(AF.ui+1),AK=AI[AJ],AH;if(AK&&AK[AF.o]){for(AH in AK){var AL=this.getCellForNode(AK[AH][0]);AG.push(AL);}}else{AG.push(AF);}return AG;},setModel:function AB(AF){this.model=AF;if(AF.data){this.set("gridData",AF.data);}},delegateGridAction:function A(AF,AG){if(this._shouldResponseToAction(AG)){AF(this.zone);}},_shouldResponseToAction:function u(AF){return AF!=="refreshOnDataDownloaded";},getTargetZone:function o(){return this.zone;},destroy:function v(){var AF=this.model;if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.gridData.datasetId+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}if(AF&&AF.destroy){AF.destroy();}this._super();}});mstrmojo.XtabBase.EnumLockedHeaders={OFF:Y,ROW:C,COL:x,BOTH:N};}());(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};}());(function(){mstrmojo.requiresCls("mstrmojo.prompt.WebPrompts");var D="mstrmojo._ResultSetXt",G=0,Q=1,F=2,N=3,H=4;var U=["promptsAnswerXML","elementsPromptAnswers","valuePromptAnswers","objectsPromptAnswers"];function A(X){if(X.linkAnswers){return true;}var V=U.length,W;for(W=0;W<V;W++){if(X[U[W]]){return true;}}return false;}function C(V){if((!V)||(V.status===undefined)||(isNaN(V.status))){return G;}switch(parseInt(V.status,10)){case 0:case 1:return Q;case 2:return N;case 3:return F;default:return H;}}function L(Z,V,c){var X=c.success;delete c.success;var b=mstrApp,a=!!Z.useRefreshProgress,Y=a?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:[],W;delete Z.useRefreshProgress;c.success=function(d,e){switch(C(d)){case Q:case N:case G:X(d,e);break;case F:c.failure(d);break;case H:var f;c.success=function(h,j){var g=C(h);switch(g){case Q:case N:X(h,j);break;case G:case H:W();break;default:h.message="Error checking the status of running report/document.";c.failure(h);break;}};W=function(){b.serverRequest({taskId:"pollStatus",msgID:d.id},c,{src:D+"::pollForResult"});};W();break;}};b.serverRequest(Z,c,{src:D+"::pollForResult",showProgress:V,hideProgress:!V,hideWait:!V,useRefreshProgress:a,progressStateText:Y});}function I(X,Z,V,Y){var W=this;L.call(this,X,V,{success:function(a){W.msgId=a.id;if(a.visName){W.visName=a.visName;}var b=C(a);if(b===N){if(Z.prompts){W.loadPrompts({success:Z.prompts,failure:Z.failure});}else{Z.failure({message:"Wrong status. Received Prompts while expected Result."});}}else{if(Z.execSuccess){Z.execSuccess(a);}if(Y&&Y.statusOnly){Z.success(a);}else{if(W.visName&&W.visName!==""){if(!Y){Y={};}Y.colsPerPage=-1;Y.rowsPerPage=-1;}W.getResults(Y,{success:Z.success,failure:Z.failure,complete:Z.complete||mstrmojo.emptyFn,canceled:Z.canceled||mstrmojo.emptyFn});}}},failure:Z.failure,complete:Z.complete||mstrmojo.emptyFn,canceled:Z.canceled||mstrmojo.emptyFn});}function B(W,X){var V=mstrApp.modelFactory;if(V){return V.newPromptsModel(W,X);}return mstrApp.viewFactory.newPrompts(W,X);}mstrmojo._ResultSetXt=mstrmojo.provide("mstrmojo._ResultSetXt",{_mixinName:"mstrmojo._ResultSetXt",msgId:null,execute:function J(X,Z,Y){if(X.link){X.linkAnswers=X.link.toXml();delete X.link;}var W=this,V=mstrmojo.func.addMethods(Z,{prompts:function(a){W.prompts=a;Z.prompts(a);},success:function(a){if(a.prompt){W.prompts=a.prompt;}Z.success(a);}});if(!W.prompts&&A(X)){V.success=function(a,b){delete b.config.hideWait;delete b.config.hideProgress;W.loadPrompts({success:function(c){if(c.prompts){W.prompts=c;W.answers=B(c).buildAnswerObject();}Z.success(a,b);},failure:Z.failure,complete:Z.complete||mstrmojo.emptyFn},{includeClosed:true});};}else{if(X.promptsAnswerXML){V.success=function(a,b){W.prompts=null;W.answers=null;W.loadPrompts({success:function(c){if(c.prompts){W.prompts=c;W.answers=B(c).buildAnswerObject();}Z.success(a,b);},failure:mstrmojo.emptyFn});};}}I.call(this,X,V,true,Y);},answerPrompts:function P(V,Y,X){if(mstrApp.useBinaryFormat){X.objectType=55;}X.taskId="answerPrompts";X.msgID=X.msgId||this.msgId;X.promptAnswerXML=V.getAnswerXML();var W=this;I.call(this,X,{success:function(Z){W.answers=V.buildAnswerObject();Y.success(Z);},prompts:Y.prompts,failure:Y.failure},true);},getResults:function R(V,W){V.messageID=V.msgId||this.msgId;L.apply(this,[V,false,W]);},loadPrompts:function O(W,V){V.taskId="getPrompts";V.msgID=V.msgID||this.msgId;L.apply(this,[V,false,W]);},linkToObject:function K(V,W){this.execute(V,W);},getPrompts:function E(){var V=this.prompts;if(V){return B(this.prompts,this.answers);}return undefined;},checkCache:function T(X,Y,W){var V=mstrmojo.hash.copy(W,{src:D+"::checkCache",override:false,silent:true});X.taskId="checkCache";mstrApp.serverRequest(X,Y,V);},checkCachedLinkTargets:function S(V,X){var W={taskId:"checkCachedLinkTargets",items:V};mstrApp.serverRequest(W,X,{src:D+"::checkCachedLinkTargets",override:false,silent:true});},urlLinkParams:function M(){return U;}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabBase2","mstrmojo.XtabZone","mstrmojo._TouchGestures","mstrmojo._HasXtabTouchScroll","mstrmojo._XtabSelections","mstrmojo.dom","mstrmojo.hash","mstrmojo.css","mstrmojo._HasMagnifier","mstrmojo.XtabMagnifierHelper");var d=mstrmojo.css,F=mstrmojo.dom;var I=0;var V=1;var Q=2;var e=3;function R(g,h){d.toggleClass(g.firstChild,"tx-active",h);}function C(g){if(g){g.domNode.style.pointerEvents="auto";}}function N(){if(mstrMobileApp.isOnline()){return ;}var m=this.controller,r,q,g,h,u,k,l,p,n=[],j=[],s;if(!m.getLinkRequest){return ;}for(r in this.zones){if(r==="_BL"||r==="_BR"){q=this.zones[r];g=q.getNodesByPositions(q.posMap);for(l=0;l<g.length;l++){h=g[l];u=this.getCellForNode(h);if(u&&u.at&&(u.at&4)){k=this.model.getAction(this.getActionCells(u),null);if(k){p=k.a;s=m.getLinkRequest(p);if(s){n.push(s);j.push(h);}}}}}}var o=n.length;if(o){var t=function(w){var v,x;for(v=0;v<o;v++){x=j[v];if(!w[v]){x.setAttribute("hl_d",true);d.addClass(x,"hl_d");}}};if(mstrApp.isHosted()){}else{this.model.getDataService().checkCachedLinkTargets(n,{success:t,failure:mstrmojo.emptyFn});}}}function a(){if(mstrMobileApp.isOnline()){var l,g,h,k,j;for(l in this.zones){if(l==="_BL"||l==="_BR"){g=this.zones[l];h=g.getNodesByPositions(g.posMap);for(j=0;j<h.length;j++){k=h[j];k.removeAttribute("hl_d");d.removeClass(k,"hl_d");}}}}else{N.call(this);}}mstrmojo.MobileXtab=mstrmojo.declare(mstrmojo.XtabBase2,[mstrmojo._TouchGestures,mstrmojo._HasXtabTouchScroll,mstrmojo._XtabSelections,mstrmojo._HasMagnifier],{scriptClass:"mstrmojo.MobileXtab",frameRate:30,enableMagnifier:true,useSeamlessIncFetch:false,allowToggleSelections:true,markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";},onheightChange:function(){this.domNode.style.height=this.height||"";},onwidthChange:function(){this.domNode.style.width=this.width||"";}},init:function X(g){this._super(g);this.magnifierHelper=new mstrmojo.XtabMagnifierHelper({xtab:this});this.disposables.push(this.magnifierHelper);},gridPagesRendered:function B(){this._super();N.call(this);},onRender:function G(){this._super();var g=this.interactiveCellsArray;if(g&&g.length>0&&this.controller.getLinkRequest){if(!this.subscr){var j=mstrmojo.publisher;this.subscr=j.subscribe(j.NO_SRC,j.CONNECTIVITY_CHANGED_EVENT,a,this.id);}if((mstrApp.useBinaryFormat||mstrApp.isHosted())&&!mstrMobileApp.isOnline()){var h=this;window.setTimeout(function(){try{N.call(h);}catch(k){}},100);}}},unrender:function Z(){if(this.subscr){mstrmojo.publisher.unsubscribe(this.subscr);delete this.subscr;}this._super();},getDataService:function J(g){return this.model.getDataService();},setData:function E(g){this.set("gridData",g);},createZone:function D(g){g=g||{};var h=this.getDataService();g.imgCacheMap=(h&&h.imgCache)||this.imgCacheMap;g.unCachedMap={};return this._super(g);},showDownloadStatus:function b(){},onclick:mstrmojo.emptyFn,setupTNs:function O(){var h=this.contentNode,g=h.rows[1].cells[1].lastChild,j=0;switch(this.lockHeadersCase){case I:this._TSN.x=[g.lastChild.lastChild];this._TSN.y=[g.firstChild];break;case Q:this._TSN.x=[h];this._TSN.y=[g.firstChild];break;case V:this._TSN.x=[g];this._TSN.y=[h];j=-1;break;case e:this._TSN.x=[h.rows[0].cells[1].lastChild,g.firstChild];this._TSN.y=[h.rows[1]];j=2;break;}if(j){this._TSN.x[0].style.zIndex=j;}this.setOffsets();this.attachEventListener("scrolledOut",this.id,this.scrolledOut);},useDomToCalculateOffsets:function P(){return(this.lockHeadersCase===I||(this._super&&this._super()));},setOffsets:function c(z){var t=0,h=0;var k=this.lockHeadersCase;if(this.useDomToCalculateOffsets()||z){var p=this._TSN,u=p.x[0],l=p.y[0],n=u.offsetLeft,w=l.offsetTop;if(z){if(!!(k&V)){n=0;}if(!!(k&Q)){w=0;}}t=n+u.offsetWidth+(!!(k&V)?this._BL.offsetWidth:0);h=w+l.offsetHeight+(!!(k&Q)?this._TR.offsetHeight:0);}else{var r=this.zones,q=(this.gridData.rh&&parseInt(this.gridData.rh,10))||0,g=r._TR?r._TR.cp.rc:0,j=r._BR.cp.rc,y=r._BL?r._BL.totalColWidth:0,v=r._BR.totalColWidth;h=((k===V)?j:g+j)*q;t=(k===Q)?v:y+v;}var s=1,m=2,o=this.getGridDimension(m)||0,x=this.getGridDimension(s)||0;this._TMAX={x:Math.min(o-t,0),y:Math.min(x-h,0)};if(this._super){this._super();}},touchTap:function Y(h){if(!this.magnifier){if(this._super){this._super();}if(this.performAction(h)===false){var g=this.controller;if(g&&g.viewTap){g.viewTap();}}}},performAction:function W(n){this.deselectCell();var m=F.findAncestorByAttr(n.target,"ei",true,this.domNode);if(!m||!m.value){return false;}var l=m.node,g=this.getCellForNode(l),k=g.at;if(this._super&&this._super(n)){return ;}if(!k){return false;}if((k&4)&&!l.getAttribute("hl_d")){var h=document.createElement("div"),j=h.style;id=this.id;h.className="activeLink on";j.left=l.offsetLeft+"px";j.top=l.offsetTop+"px";j.width=l.offsetWidth+"px";j.height=l.offsetHeight+"px";l.appendChild(h);window.setTimeout(function(){var o=mstrmojo.all[id];if(o&&o.hasRendered){F.attachOneTimeEvent(h,"webkitTransitionEnd",function(){l.removeChild(h);});d.removeClass(h,"on");}},200);}this.defaultAction(l);},selectCell:function L(g){var j=document.createElement("div"),h=j.style;j.className="overlay";h.top=g.offsetTop+"px";h.left=(g.offsetLeft+1)+"px";h.height=(g.clientHeight-2)+"px";h.width=(g.clientWidth-1)+"px";g.appendChild(j);},flagDirtyUnit:function f(g){R(g,true);},clearDirtyUnit:function M(g){R(g,false);},deselectCell:function U(){var g=this._selectedCell;if(g){g.removeChild(g.lastChild);delete this._selectedCell;}},touchSelectBegin:function A(j){if(this.enableMagnifier){var h=this.controller,g;if(h.getMagnifierConfig){g=h.getMagnifierConfig();}this.displayMagnifier(j,g);}},touchSelectMove:function H(h){if(this.enableMagnifier){var g=this;this.latestTouch=h;if(!this._moveMagnifierTimer){this._moveMagnifierTimer=setTimeout(function(){g.displayMagnifier(g.latestTouch);g._moveMagnifierTimer=null;},50);}}},touchSelectCancel:function T(g){C(this.magnifier);},touchSelectEnd:function S(g){C(this.magnifier);},getCaptureDimensions:function K(){var h=this.viewport,g=F.position(this.domNode,true);g.w=Math.min(h.offsetWidth,g.w);g.h=Math.min(h.offsetHeight,g.h);return g;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var K=mstrmojo.hash;var P=0;var F=[];var J={};var L=false;function I(T){var U=T.callback;if(U.submission){U.submission(T.id,this.userInteractionRequired(T),T);}this.submitRequest(T);}function G(){if(F.length&&!L){I.call(this,F.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function E(d,a,U,V){if(U){this.cancelRequests();}var X=this.id,Y=this.transport,T=mstrmojo.now()+a.taskId+P++,W=d.canceled||mstrmojo.emptyFn;d.canceled=function(e){W();d.complete(true);return Y.cancelRequest(e);};d=mstrmojo.func.wrapMethods(d,{complete:function(e){mstrmojo.all[X].deleteRequest(e);}});var Z=!K.isEmpty(this._requests),b=this.createRequest(T,d,a,V),c=(L||Z)&&!V.doNotHold;if(c){F.push(b);}else{I.call(this,b);}return T;},hasRequests:function O(){return !K.isEmpty(this._requests)||L;},createRequest:function Q(V,X,W,T){var U=this._requests;if(!U){U=this._requests={};}U[V]={id:V,callback:X,params:W,config:T};return U[V];},submitRequest:function M(T){this.transport.serverRequest(this.id,T.id,T);},cancelRequests:function S(){var T=false;K.forEach(this._requests,function(U){if(U.gotResponse===undefined){T|=U.callback.canceled(U.id);}});this._requests={};F=[];return T;},cancelRequest:function B(X){var U=false,W=this._requests[X],V,T=F.length;for(V=0;V<T;V++){if(F[V]===W){break;}}if(V<T){F.splice(V,1);delete this._requests[X];U|=W.callback.canceled(W.id);}return U;},response:function A(X,T,V){$MAPF(false,"AndroidServerTransport","transportRequest");var W=this.getRequest(X);if(W){W.gotResponse=true;var Y=W.callback,U=(T&&!V.mstrerr)?"success":"failure";try{if(Y[U]){Y[U](V,W);}}finally{Y.complete(X);}}G.call(this);},deleteRequest:function N(U){var T=this._requests;delete T[U];},getRequest:function H(U){var T=this._requests;return T&&T[U];},userInteractionRequired:function C(T){return false;},addLoadingGraph:function D(T){J[T]=true;L=true;},removeLoadingGraph:function R(T){delete J[T];if(K.isEmpty(J)){L=false;G.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.dom","mstrmojo.array","mstrmojo._ResultSetXt","mstrmojo._ReportDataService","mstrmojo._ImageHelper");function B(T,U,Q,R){var S=this;mstrApp.serverRequest(T,{success:function(V){S.msgId=V.id;S.visName=V.visName;S.getResults(R,U);},failure:function(V){if(U.failure){U.failure(V);}},canceled:function(){if(U.canceled){U.canceled();}}},Q);}function C(S,R){var Q={hideWait:!S,delay:true};Q["show"+(R?"Progress":"Wait")]=true;return Q;}var F={objectType:3};var G=mstrmojo.hash.copy,J=mstrmojo.array;function L(){var Q="MojoXtabStyle",S=this.visName;if(S){var R=mstrmojo.AndroidVisList.getVis(S);Q=(R&&R.s)||Q;}return Q;}mstrmojo.XtabDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._ResultSetXt,mstrmojo._ReportDataService,mstrmojo._ImageHelper],{scriptClass:"mstrmojo.XtabDataService",execute:function K(V,X,T){var W=this.id;var S=this.controller.ab;if(S){var U=S.split("|"),Q=mstrApp.isTablet()?"73^":"72^";J.forEach(U,function(b,Z,Y){var a=b.indexOf(Q);if(a>=0){mstrmojo.all[W].visName=b.substring(a+3);return false;}});}var R=mstrmojo.hash.copy(V,{});R.taskId=R.taskId||"reportExecute";R.reportID=R.reportID||this.dssId;R.styleName=mstrApp.isTablet()?"AndroidTabletMessageResultStyle":"AndroidMessageResultStyle";if(V){if(V.dssId){R.reportID=V.dssId;}}this.dssId=R.reportID;this._super(R,X,T);},getResults:function A(W,Y){var V=L.call(this),U=mstrMobileApp.getDeviceDPI(),Z=160;if(U<160){Z=80;}else{if(U>240){Z=230;}}var X={taskId:"iPhoneGetReportResults",styleName:V,zoomFactor:Z,deviceMode:mstrApp.isTablet?(mstrApp.isTablet()?73:72):0};if(W){var S=W.pbUnits,T=W.yPos,R=W.colsPerPage,Q=W.rowsPerPage;if(S){X.pageByKeys=this.pageByUnitsToKeys(S);}if(T){X.yPos=T;}if(R){X.colsPerPage=R;}if(Q){X.rowsPerPage=Q;}}this._super(X,Y);},answerPrompts:function I(Q,R){this._super(Q,R,G(F));},loadPrompts:function H(R,Q){this._super(R,G(F,Q));},drill2Grid:function D(R,S){var Q={taskId:"RWGridDrillToReport",msgID:R.srcMsgId,displayMode:-1,retainParent:3,retainThreshold:3,drillPathKey:R.drillPathKey,drillPathIndex:R.drillPathIndex,elementList:R.drillElements,nodeKey:R.nodeKey,rwGroupByElements:R.rwGroupByElements};if(R.sliceId){Q.sliceId=R.sliceId;}B.call(this,Q,S,C(true,true));},drillGrid:function P(Q,R){B.call(this,{taskId:"gridDrill",msgID:Q.srcMsgId,drillPathKey:Q.drillPathKey,drillPathIndex:Q.drillPathIndex,elementList:Q.drillElements},R,C(true,true));},pageBy:function M(R,T){var S=mstrApp,Q={taskId:"changePageBy",messageID:this.msgId,pageByKeys:this.pageByUnitsToKeys(R)};if(!S.useBinaryFormat){Q.taskId="iPhoneGetReportResults";Q.styleName=L.call(this);Q.zoomFactor=200;}mstrApp.serverRequest(Q,T,C());},sort:function E(Q,R){B.call(this,{taskId:"gridSort",msgID:this.msgId,sortKey:Q.sortKey,sortOrder:((Q.isAsc)?1:0),subtotalPos:Q.subTotalsPos,clearSorts:1},R,C());},pivot:function N(R,S){var Q={taskId:"gridPivot",msgID:this.msgId,objectId:R.objectId,pos:R.pos,objectType:R.objectType};if(R.axis){Q.axis=R.axis;}B.call(this,Q,S,C());},downloadGridData:function O(Q,R){mstrApp.serverRequest({taskId:"DocXtabIncrementalFetch",nodeKey:"",rowPosition:Q.rowPosition,maxRows:Q.maxRows,colPosition:-1,maxColumns:-1},R);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function E(G){if(G){return{w:G.innerWidth,h:G.innerHeight};}var F=C.windowDim(),H=(C.isFF||C.isWK)?0:2;return{w:Math.max(F.w,0)+"px",h:Math.max(F.h-H,0)+"px"};},preBuildRendering:function A(){var H=this._super(),G=this.getBrowserDimensions();if(!this.browserResized||this.browserResized(G)!==true){this.height=G.h;this.width=G.w;}if(!this._listenerProc){window._monitor=this;var I=this.id,F=this._listenerProc=function(K){var J=K||window.event;mstrmojo.all[I].monitorWindow(J);};C.attachEvent(window,"resize",F);}return H;},destroy:function B(F){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(F);},monitorWindow:function D(F){var I=F.currentTarget,H=this.getBrowserDimensions(),G={w:(I?I.innerWidth+"px":H.w),h:(I?I.innerHeight+"px":H.h)};if((G.h===this.height&&G.w===this.width)||parseInt(G.h,10)<=20||parseInt(G.w,10)<=20){return ;}if(!this.browserResized||this.browserResized(G,true)!==true){if(G.h!==this.height){this.set("height",G.h);}if(G.w!==this.width){this.set("width",G.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.MobileXtab","mstrmojo._HasMagnifier");var D="overflow:auto",N="overflow:hidden",J=mstrmojo.dom;function L(V,U){var Q=V.domNode;if(!Q){return false;}var T=U.toLowerCase(),P=V[T],R=parseInt(P,10),S=(U==="Width");Q.style[((S)?"left":"top")]=0;Q.style[T]=P;V.contentNode.parentNode.style[T]=P;V["scrollbox"+U]=R;return true;}function I(g){var X=[];X.push('<table style="border-spacing:0px 0px;background:white;border-collapse:collapse;table-layout:auto">');var Q=function(c,k,j){var h=function(n,m,l){if(n&&n.ts===4){X.push('<td  class="'+(n.css||"")+(l?" xtab-selected-cell":"")+'" ><img src="'+(n.n||n.v)+'"/></td>');}else{X.push('<td  class="'+(n.css||"")+(l?" xtab-selected-cell":"")+'" style="white-space:nowrap;'+m+'">'+(n.n||n.v||"&nbsp;")+"</td>");}};X.push("<tr>");h(c,"text-decoration:none;text-align:right !important");h(k,"text-decoration:none;text-align:left !important",j);X.push("</tr>");};var W=g.si,e=false,P=g.th.length;for(var V=0,Z=g.rh[0].length;V<Z;V++){var S=g.th[0][V];if(P>1&&V===Z-1){S=g.th[P-1][0];}if(V==W){Q(S,g.rh[0][V],true);e=true;break;}Q(S,g.rh[0][V]);}var d=null;if(!e){for(var U=0,f=g.ch.length;U<f;U++){var R=V;for(var T=0,b=g.ch[U].length;T<b;T++){var a=g.ch[U][T],Y=(a&&a.cs)||1;if((W>=R)&&(W<R+Y)){if(a.mix!==undefined){d=a;}else{Q(U==0?g.th[0][V-1]:g.th[U][0],a);}break;}R+=Y;}}Q(a,g.vs[0][W-V],true);}X.push("</table>");return X.join("");}function B(P){var Q=P.target;while(Q&&Q.tagName!="TD"){Q=Q.parentElement;}return Q;}mstrmojo.iXtab=mstrmojo.declare(mstrmojo.MobileXtab,[mstrmojo._FillsBrowser,mstrmojo._HasMagnifier],{scriptClass:"mstrmojo.iXtab",scrollboxHeightFixed:false,enableXtabInteractivity:false,rowAdjust:0,preBuildRendering:function O(){this.numRowFixed=true;this.scrollboxNodeOverflow=N;if(this.enableXtabInteractivity){mstrmojo.requiresCls("mstrmojo._iToolbarMgr");this.toolbarMgr="mstrmojo._iToolbarMgr";}return this._super();},postBuildRendering:function C(){var S=this._super();var P=this.msgNode,T=this.maskNode,U=J.CSS3_TRANSITION_END,V=mstrmojo.dom.attachEvent,Q=mstrmojo.css.parkAfterFade;P.style.height="auto";P.style.width="auto";V(T,U,Q);V(P,U,Q);var R=this;window.setTimeout(function(){T.style.opacity=0;R.clearTransitionCurtain();var W=R.imgCacheMap;if(W&&W.unCachedImg&&W.unCachedImg.length>0){if(R.model&&R.model.cacheImages){R.model.cacheImages(W.unCachedImg.join(",,,"));}}},400);if(this.enableXtabInteractivity){this.requiresContrib("toolbarMgr",true);}if(this.lockHeadersCase==LOCK_OFF||this.lockHeadersCase==LOCK_ROW){this.rowAdjust=this.chsCP.rc||0;}return S;},setTransitionCurtain:function K(P){if(P){P.style.zIndex=20;this.transitionCurtain=P;}},clearTransitionCurtain:function F(){var P=this.transitionCurtain;if(P){var Q=P.style;window.setTimeout(function(){Q.zIndex=-1;P.innerHTML="";},10);Q.opacity=0;}},performAction:function H(R){this.deselectCell();var Q=mstrmojo.dom.findAncestorByAttr(R.target,"ei",true,this.domNode);if(!Q||!Q.value){if(this.controller.touchTap){this.controller.touchTap();}return ;}var P=Q.node;this.defaultAction(P);},updateActionMenu:function A(P,Q){if(this.enableXtabInteractivity&&this.toolbarMgr){this.toolbarMgr.showToolbar(P,Q,this);return true;}else{return false;}},browserResized:function M(Q){if(this.height!==Q.h||this.width!==Q.w){this.height=Q.h;this.width=Q.w;var P=L(this,"Width"),R=L(this,"Height");if(P||R){this.setOffsets();}return true;}return false;},scrolledOut:function E(V){var Q=Math.abs,W={x:0,y:0},T=V.axis,R=(0.2*parseInt(T==="x"?this.width:this.height,10)),P=Q(this._TMAX[T]),S=this._TMIN[T],U=V.value;if(T=="y"&&this.useSeamlessIncFetch){return ;}if((U>(R+P))||(U<(S-R))){W[T]=U;this.controller.swipe({cmd:V.direction,offX:W.x,offY:W.y});}},createZone:function G(P){P=P||{};P.tbodyStyle="background-color:white;";return this._super(P);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var h=1,S=2;var E=2,K=4,D=5;var V=1,N=4;var f=mstrmojo.array;function H(j,k){return j[((k===h)?"row":"col")];}function B(j,l){var k=l.lm;return k&&k[j.mix||0];}function b(k,p,v){var t=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:2,aopam:p.daMode});var q=p.ans,u=q&&q.length;if(u){var r=t.prms=[],l=0;for(l=0;l<u;l++){var y=q[l];var m=y.pid,o=parseInt(y.m,10),x={id:m,am:o,pt:y.pt};r.push(x);if(y.po){x.orid=y.po.did;x.ortp=y.po.t;}switch(o){case t.DO_NOT_ANSWER:case t.CLOSE:case t.USE_DEFAULT_ANSWER:case t.SAME_PROMPT:break;case t.STATIC:var j=y.es,w=(j&&j.length)||0,s;x.pa={es:[]};for(s=w-1;s>=0;--s){var n=j[s];x.pa.es.push({ei:n.id,disp_n:n.n,emt:1});}break;case t.DYNAMIC:case t.ALL_VALID_UNITS:case t.CURRENT_UNIT:case t.DYNAMIC_OR_SAME_PROMPT:if(v.els){A.call(this,y,v,x,o,t);}else{J.call(this,y,v,x,o,t);}break;}}}return t;}function A(q,k,j,p,o){var n=q.dunits,l=k.els,m=j.pa={};f.forEach(l,function(r){if(f.find(n,"id",r.id)>=0){if(p!==o.DYNAMIC&&p!==o.DYNAMIC_OR_SAME_PROMPT){m.a={id:r.id,n:r.disp_n,dispForms:r.dfi};}if(q.pt===1){m.v=r.v;}else{m.es=[];m.es.push({ei:r.ei,emt:r.emt,disp_n:r.disp_n});}}});}function J(w,s,v,n,p,o){var q=w.dunits;if(q&&q.length&&s){var r=v.pa={};var m=s,l=(s.mix!==undefined)&&(s._lp||s._tp);if(l){m=s._lp||s._tp;}var k=parseInt(m.axis,10);while(m){var t=this.getPTitle(m,k);if(t&&f.find(q,"id",t.id)>=0){if(n!==p.DYNAMIC&&n!==p.DYNAMIC_OR_SAME_PROMPT){r.a={id:t.id,n:t.n,dispForms:t.dfi};}if(w.pt===1){r.v=m.v;break;}else{var j=m._e.id,u=m._e.n;r.es=[];r.es.push({ei:j,emt:1,disp_n:u});}if(n===p.CURRENT_UNIT){break;}}m=this.getPCellParentNode(m,k);if(l&&!m&&k===h){k=S;m=s._tp;}}}}function Q(l){var k=this.getCellTitleInfo(l[0]),n=[],p=function(q){if(q){if(mstrApp.useBinaryFormat){if(q._e){n.push(q.axis+"A"+(q.ui+1)+"A"+q._e.id);}p(q._p);}else{n.push(q.axis+"A"+(q.ui+1)+"A"+q.o);}}},m,j;if(!k.isSrcTitle){for(m=0,j=l.length;m<j;m++){var o=l[m];if(o.mix!==undefined&&(o._lp||o._tp)){p(o._lp);p(o._tp);}else{p(o);}}}return(mstrApp.useBinaryFormat)?n:n.join(",");}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function R(){return this.data.mid;},getCellTitleInfo:function c(k,n){var l=n?n.gts:this.data.gts;var m=null;if(k&&k.mix===undefined){m=H(l,k.axis)[k.tui||k.ui];}else{var j=function(q){var o=(q&&q.length)||0,p;for(p=o-1;p>=0;--p){if(parseInt(q[p].otp,10)===-1){return q[p];}}return null;};m=j(l.col)||j(l.row);}return{isSrcTitle:!!k&&(k.o===undefined)&&!((k.mix!==undefined)&&(k._lp||k._tp)),title:m};},getCellInfo:function I(k){var j=this.getCellTitleInfo(k),l={isTitle:false,isHeader:false,isMetric:false};if(k&&(k.hasOwnProperty("mix")||k.otp===-1)){l.isMetric=true;if(k._e){l.isHeader=true;}}if(j.isSrcTitle){l.isTitle=true;}return l;},getCellLinksInfo:function e(k,l){if(!l){var j=this.getCellTitleInfo(k);l=j&&j.title;}return B(k,l);},getAllDrillPathsForCell:function Z(k,l){if(!l){var j=this.getCellTitleInfo(k);l=j&&j.title;}return l.dp||[];},getCellDrillsInfo:function G(j,l){var k=this.getAllDrillPathsForCell(j,l);return k&&k[j.mix||0];},getLinkDrillAction:function O(j){return this.getActionObject(j);},getAction:function U(j){return this.getActionObject(j);},getActionObject:function L(k){var j=k[0]&&k[0].at,l=null;if(j){if((j&N)>0){l={h:"onLink",a:this.getLinkAction(k[0])};}else{if((j&V)>0){l={h:"onDrill",a:this.getDrillAction(k)};}}}return l;},getSortAction:function F(x,r){var n=this.getCellTitleInfo(x),u=n.title,w=this.data.gts[((x.axis===h)?"row":"col")+"SubPos"],k=[],m=u.axis,p,t,s,v,y;r=(r===null||r===undefined)?!(x&&x.so):r;if(n.isSrcTitle){p=E;t=u.id;s=u.otp;v=u.fid;}else{p=K;s=4;m=f.find(this.data.gts.col,"otp",-1)>-1?h:S;w=this.data.gts.rowSubPos;y=u.stt;var q,j;do{q=x._e;if(q){if(q.oid){t=q.oid;}else{j=q.id.replace(/;/g,"\\;");k.push(j);}}x=x._p;}while(x);}var o={sortType:p,axis:m,isAsc:r,unitID:t,unitType:s,elementList:k.join(";"),subTotalsPos:w};if(t){o.unitID=t;}if(v){o.formId=v;}if(y){o.sortType=D;o.stt=y;}var l;if((p===K)||(p===D)){l=["","",o.elementList||"",o.axis];}else{l=[o.formId,"21","",o.axis];}l=[o.unitType,o.unitID].concat(l);o.sortKey=l.join("!");return o;},getSubTotalsPos:function X(){var j=this.data.gts;if(j){return[j.rowSubPos,j.colSubPos];}return[0,0];},getPivotAction:function M(w,l){var u=false,x=w.hasOwnProperty("mix"),j=x?null:w.axis,v=(x?w.idx:w.ui)+1,k=(w.otp===-1);if(!isNaN(l)){j=parseInt(l,10);v=1;if(x){x=false;k=true;}}else{var p=(l==="u"||l==="l"||l==="b");if(!x){var o=H(this.data.gts,j),n=0,m={},r=false;mstrmojo.array.forEach(o,function(y){if(m[y.id]){m[y.id].frm++;}else{n++;m[y.id]={pos:n,frm:1};if(y.id===w.id){r=true;}else{if(r){return false;}}}});v=m[w.id].pos;var s=w.fix;if(s){if(!p||s>1){if(p||s!==m[w.id].frm){v=s;u=true;}}}}if(l==="b"){v=1;}else{v=v+(p?-1:1);}}var q={act:"pivot",unitPos:v};if(u){q.attFormId=w.fid;}else{if(!x){q.axis=j;}}if(!k){var t=x?w._e:w;if(!u){q.unitType=t.otp;}q.unitId=x?t.oid:w.id;}return q;},isPvtButtonVisible:function d(q,l){var n=q.axis,m=H(this.data.gts,n),p=q.ui,k=q.hasOwnProperty("mix");if(l==="b"&&p===0){return false;}if(!isNaN(l)){if(parseInt(l,10)===n){return false;}if(k){return !!m[q.ui]._hid;}return true;}var o=m[q.ui].es,j=k?o.length:m.length;if(j===1){return false;}if(n===(k?S:h)){if(l==="u"||l==="d"){return false;}}else{if(l==="l"||l==="r"){return false;}}if(k?q._e===o[0]:p===0){if(l==="l"||l==="u"){return false;}}if(k?q._e===o[j-1]:p===j-1){if(l==="r"||l==="d"){return false;}}return true;},getDrillAction:function C(j,l){var k=l||this.getCellDrillsInfo(j[0]);return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,isWithin:k.within,drillPathKey:k.k,drillPathIndex:k.dpi,drillElements:Q.call(this,j)};},isVis:function a(){if(this.xtab){return this.xtab.isVis&&this.xtab.isVis();}else{var j=this.controller&&this.controller.view;if(j&&j.isVis){return j.isVis();}}return false;},getPTitle:function g(l,k){var j;if(this.isVis()){j=l.titleInfo;}else{j=H(this.data.gts,k)[l.tui];}return j;},getPCellParentNode:function P(l,k){var j;if(this.isVis()){j=(k==h)?l._lp:l._tp;}else{j=l._p;}return j;},getLinkAction:function T(l,k){var j,m;if(this.isVis()){l=l.node;m=l.titleInfo;}else{j=this.getCellTitleInfo(l);m=j.title;}return this.getLinkActionImpl(l,m,k);},getLinkActionImpl:function Y(v,r,t){var l=B(v,r),s=l&&l.links,w=(l&&l.onw)?"_blank":"";if(t===null||t===undefined){t=(l&&l.di)||0;}var o=s&&s[t];if(!o){return null;}var m={linkInfo:o,linkTarget:w};var j=o.url;if(j){var n="&CurrentElement";if(v&&r&&j.indexOf(n)>-1){j=j.replace(n,v._e.id);}m.url=j;}else{var p=o.target,u,k;switch(parseInt(p&&p.t,10)){case 55:if(parseInt(p.st,10)===14081){if(p.dvm&(8192|2048)&&!((p.dvm&2048&&mstrApp.features["run-vi-flash"]))){u=3140;if(mstrmojo.dom.isIE6||mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(12187,"To work with HTML5 dashboards, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}}else{u=2048001;}k="objectID";}else{u=32001;k="documentID";}break;case 3:u=4001;k="reportID";m.reportViewMode=((parseInt(p.st,10)===769)?2:1);break;default:return null;}m.evt=u;m[k]=p.did;m.srcMsgId=this.getMessageId();var q=b.call(this,l,o,v);if(q){m.link=q;}return m;}},getDownloadAction:function W(m,k,o,l,n,j){return{xtabId:n,rowPosition:m,maxRows:k,colPosition:o,maxColumns:l,memo:j};}});}());(function(){var K=8;function F(L){mstrApp.serverRequest(L);}function B(){var L=mstrmojo.all,M;for(M in L){mstrmojo.registry.remove(L[M]);}}var D=function(L){return L.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\'/g,"&apos;").replace(/\"/g,"&quot;");};var G="iRoot";var C={data:null,controller:null,adjustSize:function(){var L=mstrmojo.all[G];if(L){L._monitorWindow();}},getRWInfo:function(){var L=mstrmojo.all[G].gridData.rw;return'<ifd tr="'+L.tr+'" wmr="'+L.wmr+'" tc="'+L.tc+'" wmc="'+L.wmc+'" wsr="'+L.wsr+'" wsc="'+L.wsc+'"/>';},getPBInfo:function(){var Q="",N=mstrmojo.all[G].gridData,O=N.ghs.phs,M=N.ci,R=N.n||"";if(O||M||R){Q='<report_info n="'+D(R)+'">';if(M){Q+='<ci cid="'+M.cid+'" tp="'+M.tp+'" utm="'+M.utm+'"/>';}if(O){Q+="<pbe>";var P=O.cets;for(var L in P){Q+='<pb ei="'+D(P[L].eid)+'"/>';}Q+="</pbe>";}Q+="</report_info>";}return Q;},hasPageBy:function(){var L=mstrmojo.all[G].gridData.ghs.phs;if(L&&L.cets){return"1";}return"0";},render:function(M){var P=M,L=G,N=this.data;B();if(N&&N.eg){return N.eg;}var O=new mstrmojo.iXtab({id:L,placeholder:G,defn:new mstrmojo.Model({fmts:{top:"0",left:"0",scrollarea:{y:459,x:319}}}),imgCacheMap:P,controller:this.controller});O.model=new mstrmojo.XtabModel({controller:this.controller});O.update({data:N});O.render();return ;},destroy:function(){var L=mstrmojo.all[G];if(L){var O=L.domNode,P=O.lastChild,N=O.childNodes.length,M=0;for(M=0;M<N;M++){window.setTimeout(function(){O.removeChild(O.lastChild);},0);}}}};function H(L,M){C.controller=L;C.data=M;return C;}mstrmojo.iPhoneXtabController=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.iPhoneXtabController",setData:function(L){this.data=L;},getProxy:function(L){return H(this,L);},touchTap:function(){var L={cmd:"tap"};F(L);},swipe:function(L){F(L);},sortGrid:function I(L,M){var N={cmd:"sort",sortKey:M.sortKey,sortOrder:M.sortOrder,clearSort:1,subtotalPos:M.subTotalsPos};F(N);},pivotGrid:function A(L,M){var N={cmd:"pivot",pos:M.pos,axis:M.axis,objectType:M.objectType};F(N);},onDrill:function J(M,O){var N=O.drillElements,P={cmd:"drl",dk:O.drillPathKey};if(N){var L=N.split("A");P.a=L[0];P.d=L[1];P.o=L[2];}F(P);},onLink:function E(L,M){if(M.link){M.linkAnswers=link.toXml();delete M.link;}var P=mstrmojo.hash.copy(M,{cmd:"lnk"});linkInfo=M.linkInfo,areAllAnswersDefault=(linkInfo.daMode==K);if(areAllAnswersDefault){var O=linkInfo.ans;if(O){for(i=0,cnt=O.length;i<cnt;++i){if(O[i].m!=K){areAllAnswersDefault=false;break;}}}}P.areAllAnswersDefault=areAllAnswersDefault?1:0;var N=linkInfo.target;P.tty=N&&N.t;delete P.linkInfo;delete P.linkTarget;delete P.srcMsgId;F(P);}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.form","mstrmojo.ServerProxy");mstrmojo.iPhoneServerTransport={serverRequest:function B(H,G,F){mstrmojo.form.send(F.params,null,"POST");}};mstrmojo.iPhoneApp=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.iPhoneApp",serverProxy:null,init:function E(F){this._super(F);if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.iPhoneServerTransport,_sessions:{}});}},setTarget:function D(F){this.data=F;},setSessionState:function(G,F,H,I){this.serverProxy._sessions[F]=this.sessionState=G;this.baseTaskUrl=I;this.projectId=F;this.hostUrl=H+"/";},getXtabProxy:function A(){if(this.controller){return this.controller.getProxy(this.data);}var F=this.controller=new mstrmojo.iPhoneXtabController();return F.getProxy(this.data);},getDocProxy:function C(){if(this.controller){return this.controller.getProxy(this.data);}var F=this.controller=new mstrmojo.iPhoneDocController();return F.getProxy(this.data);},serverRequest:function B(H){try{var G=this;window.setTimeout(function(){G.serverProxy.request({},H);},0);}catch(F){mstrmojo.err(F);}}});}());
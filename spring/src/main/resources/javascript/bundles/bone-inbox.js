mstrPathImplScript=true;mstrPathImpl.prototype=new mstrBoneImpl();mstrPathImpl.prototype.commands=null;mstrPathImpl.prototype.openHistoryPageEvent="";mstrPathImpl.prototype.openHistoryPageEventID="";mstrPathImpl.prototype.openHistoryPageEventArgumentID="";mstrPathImpl.prototype.openHistoryPageEventArgumentName="";mstrPathImpl.prototype.pathSize=0;mstrPathImpl.PINNED_CLASS="pinned";mstrPathImpl.PADDING=23;mstrPathImpl.prototype.onload=function(){try{mstrBoneImpl.prototype.onload.call(this);this.updateAccountButton();this.commands=new mstrPathCommandsImpl(this);this.onwinresize();}catch(A){microstrategy.errors.log(A);}};mstrPathImpl.prototype.updateAccountButton=function(){var D=document.getElementById("mstrPathAccount"),B=microstrategy.servletName,A;if(D){if(microstrategy.hasSession&&!mstrApp.isAdminPage&&D.getAttribute("_isstatic")!="true"){D.href="#";var C=microstrategy.menuHover?"mouseover":"click";D["on"+C]=microstrategy.showAccountSCList;}}};mstrPathImpl.prototype.onwinresize=function(){try{if(window.mstrInterfacePlugin){if(microstrategy.pageScreenMode==microstrategy.PAGE_FULL_SCREEN_MODE){return ;}var A=this.id;this.pathBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_path");this.footerBar=microstrategy.findAncestorWithAtt(this.elem,"id","mstrWeb_footer");if(!this.pathBar&&!this.footerBar){return ;}if(mstr.utils.ISIE8&&this.pathBar){this.pathBar.className=this.pathBar.className.replace(/ ie8/,"")+" ie8";}this.pathText=this.findChildByCssClass(this.elem,"mstrPathText");if(this.pathText){if(!this.pathBar){this.pathText.onclick=function(D){microstrategy.bone(A).pinPath(D);};}this.pathAncestor=this.findChildByCssClass(this.pathText,"mstrPathTextAncestors");this.pathCurrent=this.findChildByCssClass(this.pathText,"mstrPathTextCurrent");this.pathAncestors=this.findChildByCssClass(this.pathText,"mstrPathAncestors");this.pathBreadCrumbs=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbs");this.pathBreadCrumbsParent=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsParent","span");this.pathBreadCrumbsAncestors=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");}this.closeIcon=this.findChildByCssClass(this.footerBar,"mstrFooterPathClose","div");if(this.closeIcon){this.closeIcon.onclick=function(D){microstrategy.bone(A).toggleFooterPath(D);};}var C=this;if(this.pathBar&&this.pathText&&this.pathAncestors&&this.pathBreadCrumbs){this.neededWidth=C.getNeededWidth(),this.availableWidth=C.getAvailWidth();if(this.neededWidth<this.availableWidth){C.hideBreadCrumbs();}else{C.showBreadCrumbs();}}else{window.setTimeout(function(){C.resizePathBar();},10);}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getNeededWidth=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,B=this.pathAncestor,C=this.pathCurrent;if(A&&E&&B&&C){A.className=A.className.replace(" hidden","");if(!this.hasClass(E,"hidden")){E.className=E.className+" hidden";}return B.scrollWidth+C.scrollWidth+40;}else{return 0;}}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.hideBreadCrumbs=function(){try{var A=this.pathAncestors,D=this.pathBreadCrumbs,B=this.pathBreadCrumbsAncestors;A.className=A.className.replace(" hidden","");if(!this.hasClass(D,"hidden")){D.className=D.className+" hidden";}if(!this.hasClass(B,"hidden")){B.className=B.className+" hidden";}if(A&&D){this.resizePathBar();}}catch(C){microstrategy.errors.log(C);}};mstrPathImpl.prototype.showBreadCrumbs=function(){try{var A=this.pathAncestors,E=this.pathBreadCrumbs,C=this.pathBreadCrumbsAncestors;if(!this.hasClass(A,"hidden")){A.className=A.className+" hidden";}E.className=E.className.replace(" hidden","");if(!this.hasClass(C,"hidden")){C.className=C.className+" hidden";}this.resizeBreadCrumbs();C.style.left=mstr.$BM.position(E,true).left+"px";var B=this.id;E.onclick=function(F){microstrategy.bone(B).toggleBreadCrumbsSelector(F);};}catch(D){microstrategy.errors.log(D);}};mstrPathImpl.prototype.toggleBreadCrumbsSelector=function(){try{var A=this.findChildByCssClass(this.pathText,"mstrPathBreadCrumbsAncestors");if(A){if(this.hasClass(A,"hidden")){A.className=A.className.replace(" hidden","");}else{A.className=A.className+" hidden";}}}catch(B){microstrategy.errors.log(B);}};mstrPathImpl.prototype.getAvailWidth=function(){try{this.pathText.style.maxWidth="0px";if(mstr.utils.ISIE8){this.pathText.style.display="none";}var K=mstr.utils.BoxModel,C=document.body.clientWidth,F=this.pathBar||this.footerBar,M=microstrategy.findChildWithAtt(F,"div","id","mstrSearchSuggest"),D=microstrategy.findChildWithAtt(F,"div","id","mstrPathAccount"),E=this.findChildByCssClass(F,"mstrFooterPathClose","div"),L=M||D||E,J=Math.min(L?K.position(L).left:C,C),I=this.findChildByCssClass(F,"mstrPathIcons"),B=0;if(I){var A=K.position(I),H=A.left+A.width,B=J-H-20;}if(mstr.utils.ISIE8){this.pathText.style.display="block";}return Math.max(B,0);}catch(G){microstrategy.errors.log(G);return 0;}};mstrPathImpl.prototype.resizePathBar=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,J=this.pathAncestor,H=this.getAvailWidth();if(D){D.style.maxWidth=H+"px";}if(J){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-15;this.curWidth=Math.min(this.pathSize/2,C.offsetWidth);var G=this.pathSize-this.curWidth;var I=parseInt(mstr.utils.CSS.getStyleValue(J,"padding-right")),F=J.scrollWidth+I,B=G>F?G-F:0;G-=B;this.curWidth+=B;J.style.maxWidth=Math.max(0,G)+"px";if((bIsDXIE)&&this.pathBar){J.style.marginLeft=-G-20+"px";}if(this.pathBar){C.style.maxWidth=Math.max(0,this.pathSize-(this.isPinned(D)?G:0))+"px";}else{C.style.maxWidth=Math.max(0,this.pathSize-G)+"px";}}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.resizeBreadCrumbs=function(){try{var A=this.elem.parentNode;if(A){var C=this.pathCurrent,D=this.pathText,G=this.pathBreadCrumbsParent,F=this.pathAncestor,H=this.availableWidth;if(D){D.style.maxWidth=H+"px";G.style.maxWidth=H+"px";C.style.maxWidth=H+"px";F.style.maxWidth=H+"px";}if(G){this.pathSize=H-(this.pathBar?mstrPathImpl.PADDING:0)-50;this.curWidth=Math.min(this.pathSize/2,C.scrollWidth);var I=this.pathSize-this.curWidth;var B=I>G.scrollWidth?I-G.scrollWidth:0;I-=B;G.style.maxWidth=Math.max(0,I)+"px";C.style.maxWidth=Math.max(0,this.pathSize-I)+"px";F.style.maxWidth=Math.max(0,I+31)+"px";}if(this.hasClass(D,"hidden")){window.setTimeout(function(){D.className=D.className.replace(" hidden","");},300);}}}catch(E){microstrategy.errors.log(E);}};mstrPathImpl.prototype.pinPath=function(){try{var E=" "+mstrPathImpl.PINNED_CLASS,B=this.pathText,D=this.pathAncestor,H=this.pathCurrent;if(D&&B&&this.pathBar){var C=this.isPinned(B),G=this.pathSize;if(C){B.className=B.className.replace(E,"");var A=microstrategy.bones;if(A.leftToolbar){A.leftToolbar.resize();}window.setTimeout(function(){H.style.maxWidth=G+"px";},(bIsDXIE?0:300));}else{B.className+=E;H.style.maxWidth=Math.max(0,this.curWidth)+"px";}}}catch(F){microstrategy.errors.log(F);}};mstrPathImpl.prototype.findChildByCssClass=function(F,A,D){try{if(!F){return null;}if(F.getElementsByClassName){return F.getElementsByClassName(A)[0];}else{var D=D||"div",G=new RegExp("(^|\\s)"+A+"(\\s|$)","i");if(F.tagName!=null&&F.tagName.toLowerCase()==D.toLowerCase()&&G.test(F.className)){return F;}var H=F.getElementsByTagName(D),C=H&&H.length;if(C){for(var B=0;B<C;B++){if(G.test(H[B].className)){return H[B];}}}return null;}}catch(E){microstrategy.errors.log(E);return null;}};mstrPathImpl.prototype.hasClass=function(B,A){try{return(" "+B.className+" ").indexOf(" "+A+" ")>-1;}catch(C){microstrategy.errors.log(C);return null;}};mstrPathImpl.prototype.isPinned=function(A){try{return this.hasClass(A,mstrPathImpl.PINNED_CLASS);}catch(B){microstrategy.errors.log(B);return null;}};mstrPathImpl.prototype.toggleFooterPath=function(){var C=document.getElementById("mstrWeb_footer");if(C){C.style.bottom="-41px";var B=this.id;window.setTimeout(function(){C.innerHTML="";microstrategy.unRegisterBone(B);microstrategy.eventManager.ondialogresize();},500);}var A=microstrategy.updateManager;A.add([A.createActionObject(null,mstrUpdateManager.SET_PREFERENCE,microstrategy.servletName+"."+microstrategy.pageName,mstrUpdateManager.actions[mstrUpdateManager.SET_PREFERENCE].paramID,["showFooterPath",0])]);};function mstrPathImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrPathCommandsImpl.prototype=new Object();mstrPathCommandsImpl.prototype.item=null;mstrPathCommandsImpl.prototype.queryEnabled=function(A){try{return true;}catch(B){microstrategy.errors.log(B);}};mstrPathCommandsImpl.prototype.queryState=function(A){try{switch(A){case"openPage":return this.item;default:microstrategy.errors.log(A+" command id not implemented.");break;}}catch(B){microstrategy.errors.log(B);}return null;};mstrPathCommandsImpl.prototype.exec=function(A,F){try{switch(A){case"openPage":var C=microstrategy.updateManager;if(C){mstrUpdateManager.addEvent({OPEN_HISTORY_PAGE:{p:[this.parentBone.openHistoryPageEventArgumentID],n:[this.parentBone.openHistoryPageEventArgumentName],i:this.parentBone.openHistoryPageEventID}});C.useIframe=false;var B=new Array();B.push(C.createActionObject(this.elem,mstrUpdateManager.OPEN_HISTORY_PAGE,microstrategy.servletName+"."+microstrategy.pageName,[this.parentBone.openHistoryPageEventArgumentID],[F]));C.add(B,true);C.flushAndSubmitChanges();}else{var D=createDynamicForm(this.parentBone.openHistoryPageEvent+F);D.method="POST";D.submit();}break;default:microstrategy.errors.log(values[0]+" command id not implemented.");break;}return true;}catch(E){microstrategy.errors.log(E);}};function mstrPathCommandsImpl(A){this.parentBone=A;return this;}var dropDown=new function(){};dropDown.prototype=new Object();dropDown.togglePicker=function(show,id,dropdown,bone){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.togglePicker",0);}var oldPicker=null;if(bone.currentPicker){oldPicker=bone.currentPicker;if(bone.currentPicker.selected){var item=bone.currentPicker.selected;if(item){item.className="";}bone.currentPicker.selected=null;bone.currentPicker.commandId=null;bone.currentPicker.toolId=null;}bone.currentPicker.style.display="none";bone.currentPicker=null;}if(show){bone.currentPicker=document.getElementById(id);if(!bone.currentPicker){microstrategy.errors.log(microstrategy.descriptors.getDescriptor("3623"));return false;}bone.currentPicker.style.zIndex=1000;var cmdId=dropdown.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!cmdId){cmdId=dropdown.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_ID);}bone.currentPicker.commandId=cmdId;var subtypeStyle=bone.currentPicker.getAttribute(microstrategy.HTMLATTR_STYLE);if(subtypeStyle!=null){this.adjustPickerElements(bone.currentPicker);}if(bone.selectPickerElement){bone.selectPickerElement(bone.currentPicker);}for(var i=0;i<bone.currentPicker.childNodes.length;i++){var oChild=bone.currentPicker.childNodes[i];auxStr=oChild.getAttribute("de");if(auxStr&&auxStr.length>0){oChild.className=(eval(auxStr))?" ":"disabled";}}var leftElem=mstr.utils.BoxModel.getElementSumOffsetLeftAccurately(dropdown,document.body);var bottomElem=mstr.utils.BoxModel.getElementSumOffsetTopAccurately(dropdown,document.body)+getObjHeight(dropdown);if(bone.dialogDiv&&bone.dialogDiv.getAttribute(mstrHTMLAttributes.ATTR_DIALOG)=="true"){leftElem-=getObjSumLeft(bone.dialogDiv);bottomElem-=getObjSumTop(bone.dialogDiv);}bone.currentPicker.style.visibility="hidden";bone.currentPicker.style.display="block";var lClientWidth=getClientWidth();var lPickerWidth=getObjWidth(bone.currentPicker);if(lPickerWidth+leftElem>lClientWidth+((bone.dialogDiv&&!mstr.utils.ISIE6)?bone.dialogDiv.scrollLeft:0)){leftElem=Math.max(leftElem-lPickerWidth+getObjWidth(dropdown),0);}moveObjTo(bone.currentPicker,leftElem,bottomElem);if(bIsIE6&&!bIsIE7&&bone.maxHeight){bone.currentPicker.style.height="auto";bone.currentPicker.style.height=(bone.currentPicker.clientHeight<parseInt(bone.maxHeight))?bone.currentPicker.clientHeight+"px":bone.maxHeight;}bone.currentPicker.style.visibility="visible";togglePulldowns(bone.currentPicker,false);}else{if(oldPicker){togglePulldowns(oldPicker,true);}}}catch(err){microstrategy.errors.log(err);}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.togglePicker",0);}}return false;};dropDown.closePicker=function(F,D){try{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.start("dropDown.closePicker",0);}if(!F){F=window.event;}var E=getEventTarget(F);var C=true;if(E){if(!E.getAttribute("id")&&E.parentNode.nodeType==1){E=E.parentNode;}var B=false;if(D.currentPicker){B=(findTarget(E,"ty")==D.currentPicker)&&(E!=D.currentPicker)&&(E.className.indexOf("disabled")<0);C=(E.className.indexOf("disabled")<0)&&(E!=D.currentPicker);}if(B){if(D.execPicker){C=D.execPicker(D.currentPicker,E);}else{alert("Option '"+E.getAttribute("id")+"' was selected from picker '"+D.currentPicker.id+"'. Please make sure the bone '"+D.id+"' implements execPicker.");}}}if(C&&D.currentPicker){dropDown.togglePicker(false,D.currentPicker.id,null,D);}return true;}catch(A){microstrategy.errors.log(A);return false;}finally{if(typeof microstrategy.log!="undefined"&&microstrategy.log.shouldLog(mstrLogImpl.METHOD_LEVEL)){microstrategy.log.stop("dropDown.closePicker",0);}}};dropDown.adjustPickerElements=function(I){try{var E=I.getAttribute(microstrategy.HTMLATTR_STYLE);switch(E){case"color":var H=microstrategy.userPalette;if(H){var B=microstrategy.findChildWithAtt(I,"span","name","pkrCustom");if(!B){return ;}if(B.getElementsByTagName("img").length==0){var J=document.createElement("img");J.src=microstrategy.FOLDER_IMAGES+"1ptrans.gif";B.appendChild(J);}displayObj(B);if(!ISIE7){var F=microstrategy.findChildWithAtt(I,"span","name","pkrMore");if(F){F.style.marginTop="25px";}}H=H.split(",");var A=microstrategy.findChildrenWithAtt(I,"span","custom","1");if(A.length==H.length&&A.length==8){if(A[0].id=="pkr"+H[0]){return ;}}else{if(A.length==H.length){return ;}}for(var D=0;D<A.length;D++){I.removeChild(A[D]);}for(var D=(H.length-1);D>=0;D--){var G=document.createElement("span");G.setAttribute("custom","1");G.id="pkr"+H[D];G.setAttribute("name","pkr"+H[D]);G.setAttribute("title",H[D]);G.style.backgroundColor=H[D];B.insertAdjacentElement("afterEnd",G);}}break;}}catch(C){microstrategy.errors.log(C);return false;}};mstrPickerImplScript=true;mstrPickerImpl.prototype=new mstrBoneImpl();mstrPickerImpl.prototype.pulldownName="";mstrPickerImpl.prototype.targetCombodown="";mstrPickerImpl.prototype.onload=function(){try{this.currentPicker=null;this.initPulldown();}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.initPulldown=function(){var C=new Function("e","return microstrategy.bone('"+this.id+"').togglePicker(e);");var B=document.getElementById(this.pulldownName);if(!B){return ;}for(var A=0;A<B.childNodes.length;A++){if(B.childNodes[A].tagName&&B.childNodes[A].tagName.toLowerCase()=="span"){B.childNodes[A].onclick=C;}}};mstrPickerImpl.prototype.execPicker=function(C,F){try{var E=true;var B=this.getAppliesTo();var G=F.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);if(!G){G=C.getAttribute(microstrategy.HTMLATTR_CMD_VALUE);}var A=F.getAttribute(microstrategy.HTMLATTR_CMD_ID);if(!A){A=C.getAttribute(microstrategy.HTMLATTR_CMD_ID);}if(B&&A&&B.commands.queryEnabled(A)){E=B.commands.exec(A,G);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrPickerImpl.prototype.getAppliesTo=function(B){try{if(this.appliesTo){var B=microstrategy.bone(this.appliesTo);return B;}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.togglePicker=function(E){try{if(!E){E=window.event;}var D=getEventTarget(E);var B="";if(D.getAttribute(microstrategy.HTMLATTR_CMD_ID)==null){this.targetCombodown=findTarget(D,microstrategy.HTMLATTR_CMD_ID);B=findTarget(D,microstrategy.HTMLATTR_CMD_ID).className;}else{B=D.className;}if(D&&B.indexOf("disabled")==-1){var F=D.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);if(!F){F=D.parentNode.getAttribute(microstrategy.HTMLATTR_CMD_PICKER);}var A=document.getElementById(F);if(D.getAttribute(microstrategy.HTMLATTR_SUBOBJTYPE)==microstrategy.SUBOBJTYPE_BTN_HANDLE){if(B.indexOf("Selected")==-1){this.targetCombodown.className="mstrCombodownSelected";}dropDown.togglePicker(true,F,D.parentNode,this);}else{this.execPicker(A,D);}}}catch(C){microstrategy.errors.log(C);}return false;};mstrPickerImpl.prototype.closePicker=function(B){try{dropDown.closePicker(B,this);this.targetCombodown.className="mstrCombodown";return true;}catch(A){microstrategy.errors.log(A);return false;}};mstrPickerImpl.prototype.ondocumentclick=function(B){try{if(!B){B=window.event;}if(this.currentPicker){this.closePicker(B);}}catch(A){microstrategy.errors.log(A);alert(A);}};mstrPickerImpl.setPickerValues=function(D,F,G){try{if(D){D="pkr"+D;}var J=F.getElementsByTagName("span");for(var E=0,B=J.length;E<B;E++){var H=J[E];var I=true;if(G){I=microstrategy.isValueInFilter(G,H.getAttribute(microstrategy.HTMLATTR_FILTER_VALUE),H.getAttribute(microstrategy.HTMLATTR_FILTER_COMPARISON));var A=H.getAttribute(microstrategy.HTMLATTR_FILTER_TYPE);if(!A||A==0){H.style.display=(I)?"block":"none";}else{H.className=(I)?"":"disabled";}}if(I&&H.getAttribute("id")==D){H.className="selected";F.selected=H;}}}catch(C){microstrategy.errors.log(C);}};function mstrPickerImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);this.inherits=null;return this;}mstrSerializer.prototype=new Object;mstrSerializer.prototype.buffer="";mstrSerializer.prototype.needDelim=false;mstrSerializer.CH_ESCAPE="*";mstrSerializer.CH_DELIM=".";mstrSerializer.CH_BRA="-";mstrSerializer.CH_KET="_";mstrSerializer.CH_LESS="<";mstrSerializer.STR_NULL="*0";mstrSerializer.prototype.getState=function(){try{return this.buffer;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addStr=function(B){try{if(this.needDelim){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(B);this.needDelim=true;}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addInt=function(B){try{this.addStr(B+"");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addBoolean=function(B){try{this.addStr(B?"1":"0");}catch(A){microstrategy.errors.log(A);return false;}};mstrSerializer.prototype.addValues=function(A){try{this.buffer+=mstrSerializer.CH_BRA;for(var B=0;B<A.length;B++){if(B>0){this.buffer+=mstrSerializer.CH_DELIM;}this.appendValue(A[B]);}this.buffer+=mstrSerializer.CH_KET;this.needDelim=false;}catch(C){microstrategy.errors.log(C);return false;}};mstrSerializer.prototype.appendValue=function(C){try{var A=new RegExp("[\\"+mstrSerializer.CH_ESCAPE+"\\"+mstrSerializer.CH_BRA+"\\"+mstrSerializer.CH_KET+"\\"+mstrSerializer.CH_DELIM+"\\"+mstrSerializer.CH_LESS+"]","g");var D=mstrSerializer.CH_ESCAPE+"$&";C=String(C).replace(A,D);this.buffer+=C;}catch(B){microstrategy.errors.log(B);return false;}};function mstrSerializer(){return this;}mstrInboxImplScript=true;mstrInboxImpl.prototype=new mstrBoneImpl();mstrInboxImpl.prototype.editingMsgIndex=null;mstrInboxImpl.prototype.onload=function(){try{this.initBone();}catch(A){microstrategy.errors.log(A);return false;}};mstrInboxImpl.prototype.makeEditable=function(E,C){try{var H;var D=document.getElementById(C+E);D.disabled=false;if(this.editingMsgIndex&&this.editingMsgIndex!=E){this.makeNonEditable(this.editingMsgIndex,C);}this.editingMsgIndex=E;var A=document.getElementById("msgEditName"+E);var G=document.getElementById("msgName"+E);var B=document.getElementById("newName"+E);B.value=G.firstChild.innerText||G.firstChild.textContent;A.style.display="block";G.style.display="none";}catch(F){microstrategy.errors.log(F);return false;}};mstrInboxImpl.prototype.makeNonEditable=function(C,A){try{var E;var B=document.getElementById(A+C);this.editingMsgIndex=null;document.getElementById("msgEditName"+C).style.display="none";document.getElementById("msgName"+C).style.display="block";B.disabled=true;}catch(D){microstrategy.errors.log(D);return false;}};mstrInboxImpl.prototype.submitRename=function(D,C,F,A){try{var B=document.getElementById(A+D);document.getElementById(C).value=F;document.getElementById(A).value=B.value;B.disabled=true;}catch(E){microstrategy.errors.log(E);return false;}};mstrInboxImpl.prototype.exportReport=function(A,B,C,G,I){try{var H=["3001","3010","3005"];var F=[A,B,C];var J=mstrUpdateManager.FAST_EXPORT_REPORT;if(G){J=mstrUpdateManager.FAST_PDF_EXPORT_REPORT;}else{H.push("3030");F.push("export");}var E=microstrategy.updateManager.createActionObject(this.elem,J,microstrategy.servletName,H,F);microstrategy.updateManager.add([E]);this.submitUpdateManagerExport(I);}catch(D){microstrategy.errors.log(D);return false;}};mstrInboxImpl.prototype.submitUpdateManagerExport=function(D){try{var A=microstrategy.updateManager.newWindow;var B=microstrategy.updateManager.newWindowName;if(D){microstrategy.updateManager.newWindow=true;microstrategy.updateManager.newWindowName=D;}microstrategy.updateManager.flushAndSubmitChanges();if(D){microstrategy.updateManager.newWindow=A;microstrategy.updateManager.newWindowName=B;}}catch(C){microstrategy.errors.log(C);return false;}};mstrInboxImpl.prototype.exportRW=function(B,G,H,F){try{var A=["3001","3010","3115"];var D=[B,G,H];var E=microstrategy.updateManager.createActionObject(this.elem,mstrUpdateManager.FAST_EXPORT_RW,microstrategy.servletName,A,D);microstrategy.updateManager.add([E]);this.submitUpdateManagerExport(F);}catch(C){microstrategy.errors.log(C);return false;}};function mstrInboxImpl(A){this.inherits=mstrBoneImpl;this.inherits(A);delete this.inherits;return this;}mstrUpdateManager.prototype=new Object;mstrUpdateManager.prototype.id="bonesUpdateManager";mstrUpdateManager.prototype.observer=null;mstrUpdateManager.prototype.actions={};mstrUpdateManager.prototype.redoActions=[];mstrUpdateManager.prototype.undoActions=[];mstrUpdateManager.prototype.staticActions=[];mstrUpdateManager.prototype.useIframe=false;mstrUpdateManager.prototype.newWindow=false;mstrUpdateManager.prototype.newWindowName="_blank";mstrUpdateManager.prototype.extraURL="";mstrUpdateManager.prototype.iframeTarget="frameManager";mstrUpdateManager.prototype.formAction="";mstrUpdateManager.prototype.OPTIMIZE_EVENTS=true;mstrUpdateManager.prototype.ADD_EVENT_IDS=null;mstrUpdateManager.prototype.optActions=[];mstrUpdateManager.prototype.lastPosArray=[];mstrUpdateManager.prototype.copyActions={};mstrUpdateManager.prototype.cachedActionCollection=null;mstrUpdateManager.prototype.queueActions=false;mstrUpdateManager.prototype.forceSubmitAfterQueue=false;mstrUpdateManager.prototype.ctlCurElementsPosition=null;mstrUpdateManager.prototype.currentPanelPosition=null;mstrUpdateManager.prototype.hiddenInputs=null;mstrUpdateManager.prototype.submittedForm=null;mstrUpdateManager.prototype.submittedXhr=false;mstrUpdateManager.prototype.newActions=false;mstrUpdateManager.prototype.sTimeOutID=null;mstrUpdateManager.prototype.callback=null;mstrUpdateManager.UNIT_SEPARATOR=",";mstrUpdateManager.ITEM_SEPARATOR=";";mstrUpdateManager.UPDATE_LATER="0";mstrUpdateManager.UPDATE_NOW="1";mstrUpdateManager.STATIC_ACTION=-1;mstrUpdateManager.ARG_KEY_SEPARATOR="_";mstrUpdateManager.addEvent=function(A){if(!mstrUpdateManager.actions){mstrUpdateManager.actions={};}for(var B in A){var C=A[B].i;mstrUpdateManager[B]=C;mstrUpdateManager.actions[C]={eventID:C,paramName:A[B].n,paramID:A[B].p};}mstrUpdateManager.newActions=true;};mstrUpdateManager.prototype.addSingleAction=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection.push(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getUseIFrame=function(){try{return this.useIframe;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setUseIFrame=function(B){try{this.useIframe=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.getNewWindowSetting=function(){try{return this.newWindow;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.setNewWindowSetting=function(B){try{this.newWindow=B;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.addActionCollection=function(B){try{if(!this.cachedActionCollection){this.cachedActionCollection=[];}this.cachedActionCollection=this.cachedActionCollection.concat(B);this.newActions=true;}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.hasCachedActions=function(){try{return(this.cachedActionCollection&&this.cachedActionCollection.length>0);}catch(A){microstrategy.errors.log(A);}return false;};mstrUpdateManager.prototype.addCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.add(this.cachedActionCollection,false);this.cachedActionCollection=null;if(this.forceSubmitAfterQueue){this.flushAndSubmitChanges();}}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.killCachedActions=function(){try{if(this.cachedActionCollection){this.queueActions=false;this.cachedActionCollection=null;}}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.add=function(C,A){try{if(this.queueActions){if(C.length){this.addActionCollection(C);}else{this.addSingleAction(C);}}else{if(A){this.staticActions.push(C);this.redoActions.unshift(mstrUpdateManager.STATIC_ACTION);this.newActions=true;}else{this.clearRedoActions();this.undoActions.push(C);this.newActions=true;}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","add",C);if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.addURL=function(A){try{if(A){if(this.extraURL.length>0){this.extraURL+="&"+A;}else{this.extraURL=A;}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.replaceURL=function(A,D){try{if(this.extraURL.length>0){if(this.extraURL.indexOf(A)>-1){var E=this.extraURL.substring(0,this.extraURL.indexOf(A)-2);var C=this.extraURL.indexOf("&",this.extraURL.indexOf(A));if(E==null||E.length==0){E="";}else{E+="&";}if(C>this.extraURL.indexOf(A)){this.extraURL=E+this.extraURL.substring(C+1,this.extraURL.length)+"&"+A+"="+D;}else{this.extraURL=A+"="+D;}}else{this.extraURL+="&"+A+"="+D;}}else{this.extraURL=A+"="+D;}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.processUndoRedo=function(C,D){try{while(C.length>0){var B=C.pop();D.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;}}}catch(A){microstrategy.errors.log(A);}return null;};mstrUpdateManager.prototype.broadcastUpdate=function(){try{while(source.length>0){var B=source.pop();target.push(B);if(B!=mstrUpdateManager.STATIC_ACTION){return B;break;}}return null;}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.undo=function(C){try{var D=false;C=C||1;for(var A=0;A<C;A++){var F=this.processUndoRedo(this.undoActions,this.redoActions);if(F){for(var B=0;B<F.length;B++){microstrategy.eventManager.notifyOrphanBones("onundo",new mstrUndoObj(F[B]));}D=true;}}if(D){microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","undo");}if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.redo=function(){try{var C=this.processUndoRedo(this.redoActions,this.undoActions);if(C){for(var A=0;A<C.length;A++){microstrategy.eventManager.notifyOrphanBones("onredo",new mstrRedoObj(C[A]));}microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange","redo");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}}return true;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.getPendingEventsForTask=function(A){var E;var J;var B=0;var N=[];var D=A.split(".");var C=D[D.length-1];var F=this.optActions;this.optActions=[];if(this.OPTIMIZE_EVENTS){for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;this.createOptimizedArray(H);G.splice(M,1);M=M-1;}}}for(var I=0;I<this.optActions.length;I++){if(this.optActions[I].id!=null){N.push(this.createEventForAction(this.optActions[I]));}}this.postOptimizationCleanup();}else{for(var I=0;I<this.undoActions.length;I++){var G=this.undoActions[I];if(G==mstrUpdateManager.STATIC_ACTION){G=this.staticActions[B];B++;}for(var M=0;M<G.length;M++){var H=G[M];var K=H.beanPath;if(K&&K.indexOf(A)==0){H.beanPath=K.substring(K.indexOf(C));H.beanPath=microstrategy.servletName+"."+H.beanPath;N.push(this.createEventForAction(H));G.splice(M,1);M=M-1;}}}}this.optActions=F;if(N.length>0){var L=new mstrSerializer();L.addValues(N);return L.getState();}else{return"";}};mstrUpdateManager.prototype.flushChanges=function(I){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){addURLAsHiddenInputsToForm(I,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){this.createOptimizedArray(D[H]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var H=0;H<D.length;H++){J.push(this.createEventForAction(D[H]));}}}var G=new mstrSerializer();G.addValues(J);if(I.getAttribute("hasUpdateChanges")=="true"){updateDynamicInput(I,mstrUpdateManager.multipleEventArgName,G.getState());}else{this.submittedForm=I;this.hiddenInputs=[];this.createHiddenInput(I,mstrUpdateManager.multipleEventArgName,G.getState());this.createHiddenInput(I,"evt",mstrUpdateManager.multipleEventID);this.createHiddenInput(I,"src",mstrUpdateManager.multipleEventSrc);this.createHiddenInput(I,mstrUpdateManager.multipleEventID,"1");I.setAttribute("hasUpdateChanges","true");}if(this.newWindow){I.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.flushChangesAsParams=function(G){try{var B;var E;var A=0;var J=[];this.clearRedoActions();if(this.extraURL.length>0){UpdateHelper.addURLToParams(G,this.extraURL);this.extraURL="";}if(this.OPTIMIZE_EVENTS){for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){this.createOptimizedArray(D[I]);}}for(var F=0;F<this.optActions.length;F++){if(this.optActions[F].id!=null){J.push(this.createEventForAction(this.optActions[F]));}}this.postOptimizationCleanup();}else{for(var F=0;F<this.undoActions.length;F++){var D=this.undoActions[F];if(D==mstrUpdateManager.STATIC_ACTION){D=this.staticActions[A];A++;}for(var I=0;I<D.length;I++){J.push(this.createEventForAction(D[I]));}}}var H=new mstrSerializer();H.addValues(J);if(G.hasUpdateChanges=="true"){G[mstrUpdateManager.multipleEventArgName]=H.getState();}else{this.submittedXhr=true;UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventArgName,H.getState());UpdateHelper.addAdditionalParam(G,"evt",mstrUpdateManager.multipleEventID);UpdateHelper.addAdditionalParam(G,"src",mstrUpdateManager.multipleEventSrc);UpdateHelper.addAdditionalParam(G,mstrUpdateManager.multipleEventID,"1");G.hasUpdateChanges=="true";}if(this.newWindow){G.target=this.newWindowName;}this.newActions=false;return true;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.createHiddenInput=function(D,B,C){var A=createHiddenInput(D,B,C);this.hiddenInputs.push(A);};mstrUpdateManager.prototype.postOptimizationCleanup=function(A){if(this.fullScreenModePosition){delete this.fullScreenModePosition;}if(this.lTbarBrowserSettingPosition){delete this.lTbarBrowserSettingPosition;}if(this.ctlCurElementsPosition){delete this.ctlCurElementsPosition;}if(this.currentPanelPosition){delete this.currentPanelPosition;}if(this.widgetPropEdits){delete this.widgetPropEdits;}this.optActions=[];this.lastPosArray=[];};mstrUpdateManager.prototype.createEventForAction=function(G){try{var A=mstrUpdateManager.actions[G.id];var E=new mstrSerializer();E.addStr(A.eventID);E.addStr(G.beanPath+"."+A.eventID);var D="";for(var C=0;C<G.newArgs.length;C++){actionID=G.argID[C];for(var B=0;B<A.paramID.length;B++){if(A.paramID[B]==actionID){if(false){D+="<arg name='"+A.paramName[B]+"' v='"+G.newArgs[C]+"' />";}if(G.argKey==null){E.addStr(A.paramName[B]);}else{E.addStr(A.paramName[B]+mstrUpdateManager.ARG_KEY_SEPARATOR+G.argKey);}E.addStr(G.newArgs[C]);break;}}}if(false){alert(D);}return E.getState();}catch(F){microstrategy.errors.log(F);return false;}};mstrUpdateManager.prototype.flushAndSubmitChanges=function(C,H){this.callback=H||{};var B=this,G=this.callback.success,F=this.callback.noRefresh;this.callback.success=function(I){if(G){G(I);}if(!F&&I&&I.status=="6"){B.refreshPage();}};try{if(useXHR&&!C){mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var A=UpdateHelper.createParamsFromURL(this.getFormAction(),this.useIframe&&!this.newWindow);this.flushing=true;UpdateHelper.submitRequest(A);}else{mstrMsgBoxImpl.hideMessage(null,"controlSubmitButton");var D=createDynamicForm(this.getFormAction());if(this.useIframe&&!this.newWindow){addURLAsHiddenInputsToForm(D,"iframe=true");D.target=this.iframeTarget;}this.flushing=true;submitForm(D,C);}return true;}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.acknowledgeRequest=function(){try{this.undoActions=[];this.redoActions=[];this.staticActions=[];this.optActions=[];this.lastPosArray=[];this.copyActions={};this.newWindow=false;microstrategy.eventManager.notifyOrphanBones("onupdatemanagerchange");if(this.observer){this.observer.notifyAll("onupdatemanagerchange");}var B;if(this.submittedForm!=null){for(var A=0;A<this.hiddenInputs.length;A++){B=this.hiddenInputs[A];try{this.submittedForm.removeChild(B);}catch(C){if((C&&C.code!=8)&&(C.number&&C.number!=-2147024809)){throw (C);}}}this.submittedForm.setAttribute("hasUpdateChanges","false");this.submittedForm=null;this.hiddenInputs=null;this.flushing=false;}if(this.submittedXhr){this.submittedXhr=false;this.flushing=false;}}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.isFlushing=function(){return !!this.flushing;};mstrUpdateManager.prototype.acknowledgeReloadEnd=function(){if(this.observer){this.observer.notifyAll("acknowledgeReloadEnd");}};mstrUpdateManager.prototype.getFixStateActions=function(){try{var E=[];for(var B=0;B<this.staticActions.length;B++){var D=this.staticActions[B];for(var A=0;A<D.length;A++){E.push(D[A]);}}return E;}catch(C){microstrategy.errors.log(C);return false;}};mstrUpdateManager.prototype.hasChangesToSubmit=function(){try{return(this.undoActions.length>0||this.isRedoStatic()||(this.extraURL!=null&&this.extraURL.length>0));}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.hasNewChanges=function(){try{var A=this.newActions;this.newActions=false;return A;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.clearRedoActions=function(){try{while(this.redoActions.length>0){var B=this.redoActions.pop();if(B==mstrUpdateManager.STATIC_ACTION){this.undoActions.push(B);}}}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.getLastAction=function(){try{return this.undoActions.pop();}catch(A){microstrategy.errors.log(A);return false;}};mstrUpdateManager.prototype.isRedoStatic=function(){try{var C=false;for(var A=0;A<this.redoActions.length;A++){if(this.redoActions[A]==mstrUpdateManager.STATIC_ACTION){C=true;break;}}return C;}catch(B){microstrategy.errors.log(B);return false;}};mstrUpdateManager.prototype.anyNonStatic=function(B){try{var A=(B)?this.redoActions:this.undoActions;var E=false;for(var C=0;C<A.length;C++){if(A[C]!=mstrUpdateManager.STATIC_ACTION){E=true;break;}}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createActionObject=function(C,A,G,H,B,F,J,I){try{var E={};E.elem=C;E.id=A;E.beanPath=G;E.argID=H;E.newArgs=B;E.oldArgs=F;E.cachedArray=J;E.argKey=I;if(A==mstrUpdateManager.EDIT_PROPS){E.formatType=microstrategy.formatType;E.argID.push("2048131");E.newArgs.push(microstrategy.formatType);E.oldArgs.push(microstrategy.formatType);}return E;}catch(D){microstrategy.errors.log(D);return false;}};mstrUpdateManager.prototype.createOptimizedArray=function(G){try{var I=G.id;if(!this.ADD_EVENT_IDS){this.ADD_EVENT_IDS=mstrUpdateManager.ADD_TEXT+"|"+mstrUpdateManager.ADD_LINE+"|"+mstrUpdateManager.ADD_SHAPE+"|"+mstrUpdateManager.ADD_TEMPLATE+"|"+mstrUpdateManager.ADD_DATASET_TEMPLATE+"|"+mstrUpdateManager.ADD_IMAGE+"|"+mstrUpdateManager.ADD_HTML_CONTAINER+"|"+mstrUpdateManager.ADD_PANEL_STACK+"|"+mstrUpdateManager.CTRL_ADD+"|";}var N=(G.elem)?G.elem.id:null;var B=N;if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="4146"){B=N+G.newArgs[K].split("!")[0]+G.newArgs[K].split("!")[1]+G.newArgs[K].split("!")[2];break;}}}var P;if(I==mstrUpdateManager.EDIT_PROPS){for(var K=0,D=G.argID.length;K<D;K++){if(G.argID[K]=="2048035"){var J=G.newArgs[K].split(mstrUpdateManager.UNIT_SEPARATOR);if(J[1]=="FormattingWidget"&&J[2]=="WidgetProps"){var C=this.widgetPropEdits||{};if(J[0] in C){this.optActions[C[J[0]]].id=null;}C[J[0]]=this.optActions.length;this.widgetPropEdits=C;}break;}}this.optActions.push(G);}else{if(I==mstrUpdateManager.COPY_TO_CLIPBOARD||I==mstrUpdateManager.CUT_TO_CLIPBOARD){P=G.newArgs[0].split(CLIPBOARD_ITEM_SEPARATOR);for(var K=0;K<P.length;K++){this.copyActions[P[K]]={};this.copyActions[P[K]].position=this.optActions.length;this.copyActions[P[K]].applied=false;}this.optActions.push(G);}else{if(I==mstrUpdateManager.SET_REPORT_PROPERTY_VALUES||I==mstrUpdateManager.EDIT_TEXT||I==mstrUpdateManager.SET_TOPLEFT_POSITION||I==mstrUpdateManager.CHANGE_BONE_PROPERTY){if(!this.lastPosArray[I]){this.lastPosArray[I]={};}if(this.copyActions[N]&&this.copyActions[N].applied==false){this.copyActions[N].applied=true;for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}else{if(this.lastPosArray[I][B]){var L=this.lastPosArray[I][B].position;var F=this.optActions[L];var H=mstr.$A.find(F.argID,"2048007");if(H==-1){H=null;}var M=mstr.$A.find(F.argID,"2048007");if(M==-1){H=null;}if(M==H){F.newArgs=G.newArgs;}else{this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}else{this.lastPosArray[I][B]={};this.lastPosArray[I][B].position=this.optActions.length;this.optActions.push(G);}}}else{if(I==mstrUpdateManager.REMOVE_OBJECT){if(this.copyActions[N]){for(var K=this.copyActions[N].position;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N){this.optActions[K].id=null;}}delete this.copyActions[N];for(anItem in this.lastPosArray){delete this.lastPosArray[anItem][B];}}else{for(var K=0;K<this.optActions.length;K++){if(this.optActions[K].elem&&this.optActions[K].elem.id==N&&!this.ADD_EVENT_IDS.contains(this.optActions[K].id,"|")){this.optActions[K].id=null;}}}this.optActions.push(G);}else{if(I==mstrUpdateManager.SWITCH_FULL_SCREEN_MODE){if(typeof (this.fullScreenModePosition)!="undefined"&&this.optActions[this.fullScreenModePosition]&&this.optActions[this.fullScreenModePosition].newArgs&&this.optActions[this.fullScreenModePosition].id==I){this.optActions[this.fullScreenModePosition].newArgs=G.newArgs;}else{this.fullScreenModePosition=this.optActions.length;this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_PERMANENT_BROWSER_SETTING){if(G.argID[0]=="5005"&&G.newArgs[0]=="lTbar"){if(typeof (this.lTbarBrowserSettingPosition)!="undefined"&&this.optActions[this.lTbarBrowserSettingPosition]&&this.optActions[this.lTbarBrowserSettingPosition].newArgs){this.optActions[this.lTbarBrowserSettingPosition].newArgs=G.newArgs;}else{this.lTbarBrowserSettingPosition=this.optActions.length;this.optActions.push(G);}}else{this.optActions.push(G);}}else{if(I==mstrUpdateManager.SET_CUR_CTL_ELEMENTS){for(var K=0;K<G.argID.length;K++){if(G.argID[K]=="2048130"){this.ctlCurElementsPosition=this.ctlCurElementsPosition||{};var A=G.newArgs[K];if(A in this.ctlCurElementsPosition){this.optActions[this.ctlCurElementsPosition[A]].id=null;}this.ctlCurElementsPosition[A]=this.optActions.length;this.optActions.push(G);break;}}}else{if(I==mstrUpdateManager.SET_CURRENT_PANEL){var O=G.newArgs[0];if(!this.currentPanelPosition){this.currentPanelPosition={};}if(typeof (this.currentPanelPosition[O])!="undefined"){this.optActions.splice(this.currentPanelPosition[O],1);}this.currentPanelPosition[O]=this.optActions.length;this.optActions.push(G);}else{this.optActions.push(G);}}}}}}}}}catch(E){microstrategy.errors.log(E);return false;}};mstrUpdateManager.prototype.getFormAction=function(){if(!this.formAction){this.formAction=microstrategy.servletName;}return this.formAction;};mstrUpdateManager.prototype.setFormAction=function(A){this.formAction=A;};mstrUpdateManager.createPropertyEditString=function(C,B,G,A,H){try{var F=mstrFormatObject;if(!F){return"";}if(!A){G=F.encodeValue(B,G);}var D=C||"";if(D){D+=mstrUpdateManager.UNIT_SEPARATOR;}return D+(H||F.getPropertySetName(B))+mstrUpdateManager.UNIT_SEPARATOR+F.getPropertyName(B)+mstrUpdateManager.UNIT_SEPARATOR+G+mstrUpdateManager.ITEM_SEPARATOR;}catch(E){microstrategy.errors.log(E);return"";}};mstrUpdateManager.prototype.createEditPropsAction=function(F,J,S,I,Q,D,A,L,K,R){try{var E=(A)?mstrUpdateManager.UPDATE_NOW:mstrUpdateManager.UPDATE_LATER;var M=mstrUpdateManager.createPropertyEditString;var O=K?"1":"0";var H="",C="";for(var N=0;N<I.length;N++){H+=M(J,I[N],Q[N],R);if(D&&(N in D)){C+=M(J,I[N],D[N]);}}var B=K?["2048018","2048035","2048241"]:["2048018","2048035"],G=K?[E,H,O]:[E,H];return this.createActionObject(F,mstrUpdateManager.EDIT_PROPS,S,B,G,(C&&[E,C])||[],L);}catch(P){microstrategy.errors.log(err);return null;}};mstrUpdateManager.prototype.findRwbInputOnPageStateForm=function(){var C=getObj("pageStateForm");var B=C.getElementsByTagName("INPUT");for(i=0,cnt=B.length;i<cnt;i++){var A=B[i];if(A.name==="rwb"){return A;}}return null;};mstrUpdateManager.prototype.getRWBState=function(A){if(A){var B=this.findRwbInputOnPageStateForm();if(B){return B.value;}}else{if(pageState){var C=(pageState+"&").match(/rwb=(.*?)\&/);if(C!=-1){return C[1];}}}return"";};mstrUpdateManager.prototype.setRWStateInForm=function(A){var B=this.findRwbInputOnPageStateForm();if(B){B.value=A;}};mstrUpdateManager.prototype.refreshPage=function(){try{this.useIframe=false;var B=this.createActionObject(null,mstrUpdateManager.PAGE_REFRESH,microstrategy.servletName+"."+microstrategy.pageName,[],[],[],null);this.add([B],true);this.flushAndSubmitChanges();}catch(A){microstrategy.errors.log(A);}};mstrUpdateManager.prototype.submitPartialUpdate=function(C){try{microstrategy.puStatus=0;iframe.notifyParent(true);if(!this.partialUpdateModel){this.partialUpdateModel=new mstr.models.BooleanTaskModel({parent:this});mstr.controllers.Factory.add(this.partialUpdateModel);var A=this.partialUpdateModel&&this.partialUpdateModel&&this.partialUpdateModel.init();if(!("id" in this)||!mstr.$obj(this.id)){mstr.controllers.Factory.add(this);}this.partialUpdateModel.attachEventListener(this,"set_readyState","handleStateChange");}C.processorClass=mstr.http.PUProcessor;this.partialUpdateModel.execSubmit({params:C,callback:this.callback});}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.handleStateChange=function(evt){try{switch(evt.memo.value){case mstr.Enum.Widget.READYSTATE.TIMEOUT:case mstr.Enum.Widget.READYSTATE.ERROR:break;case mstr.Enum.Widget.READYSTATE.SUCCESS:var updateResult=evt.src.get("requestContext").response.data;if(updateResult){if(updateResult.status=="2"){iframe.showWaitPage();}else{iframe.hideWaitPage();}UpdateHelper.replaceComponents(updateResult.components);document.title=updateResult.title;if(updateResult.status=="2"){this.doRedirect(updateResult.redirectURL,updateResult.waitSeconds);}microstrategy.eventManager.executeFunction("microstrategy.eventManager.onreload()");if(updateResult.script){eval(updateResult.script);}microstrategy.puStatus=1;}else{if(window.document.readyState=="complete"){var sMarkup=evt.src.get("requestContext").response.text;if(bIsIE6&&!bIsIE7){document.write(sMarkup);}else{var oNewDoc=window.document.open("text/html");if(sMarkup.indexOf("<!DOCTYPE")==-1){oNewDoc.write('<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd " >');}oNewDoc.write(sMarkup);oNewDoc.close();}}}delete this.callback;break;}}catch(err){microstrategy.errors.log(err);}};mstrUpdateManager.prototype.doRedirect=function(C,A){try{this.sTimeOutID=window.setTimeout('microstrategy.updateManager.timedRedirect("'+C+'")',A*1000);}catch(B){microstrategy.errors.log(B);}};mstrUpdateManager.prototype.timedRedirect=function(C){try{window.clearTimeout(this.sTimeOutID);var A=UpdateHelper.createParamsFromURL(C);UpdateHelper.submitRequest(A);}catch(B){microstrategy.errors.log(B);}};function mstrUpdateManager(){this.commands=new UpdateManagerCommands(this);if(typeof (mstrObserverImpl)!="undefined"){this.observer=new mstrObserverImpl();}return this;}if(typeof (microstrategy)!="undefined"){microstrategy.updateManager=new mstrUpdateManager();}mstrUndoObj.prototype={};function mstrUndoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.oldArgs;this.cachedArray=A.cachedArray;return this;}mstrRedoObj.prototype={};function mstrRedoObj(A){this.elem=A.elem;this.id=A.id;this.args=A.newArgs;this.cachedArray=A.cachedArray;return this;}function UpdateManagerCommands(A){this.queryVisible=function(B){return true;};this.queryEnabled=function(B){switch(B){case"redo":return A.anyNonStatic(true);case"undo":return A.anyNonStatic(false);case"apply":return A.hasChangesToSubmit();default:return false;}};this.queryState=function(B){return false;};this.exec=function(B,C){switch(B){case"redo":return A.redo();case"undo":return A.undo();case"apply":A.add([A.createActionObject(null,mstrUpdateManager.APPLY_CHANGES,mstrUpdateManager.applyChangesBeanPath,[],[],[])]);return A.flushAndSubmitChanges();default:return false;}};return this;}var UpdateHelper=new function(){};UpdateHelper.prototype=new Object();UpdateHelper.createParamsFromURL=function(B,G){var C={method:"post"};var H=B.indexOf("?")>0;var F=B.indexOf("#")>0;var E=(B.indexOf("iframe=true")>0||G);var D=((H)?B.substring(0,B.indexOf("?")):B);if(F){var A="";B=moveAnchor(B);A=B.substring(B.indexOf("#"));D=D.replace(A,"")+A;B=B.substring(0,B.indexOf("#"));}D=microstrategy.addJSessionID(D);if(H){UpdateHelper.addURLToParams(C,B);}C.iframe=(E)?"true":"false";C.action=D;return C;};UpdateHelper.createParamsFromForm=function(I,J,F,H){var G=getObj(I);var C=microstrategy.findChildrenWithAtt(G,["INPUT","SELECT","TEXTAREA"],"name");var B={action:G.action,method:G.method};if(typeof G.target!=undefined){B.target=G.target;}for(var D=0;D<C.length;D++){var A=C[D];if(H===true&&A.ps===true){continue;}if(A.type=="select-multiple"&&A.options&&A.options.length>0&&A.disabled!=true){for(var E=0;E<A.options.length;E++){if(UpdateHelper.shouldSubmit(A.options[E])){UpdateHelper.addAdditionalParam(B,A.name,A.options[E].value);}}}else{if(UpdateHelper.shouldSubmit(A)){UpdateHelper.addAdditionalParam(B,A.name,A.value);}}}if(J){B[J]=F;}return B;};UpdateHelper.shouldSubmit=function(A){if(A.disabled==true){return false;}if(A.type=="submit"||A.type=="button"||A.type=="image"||A.value=="undefined"){return false;}if(A.type=="radio"||A.type=="checkbox"){if(!A.getAttribute("agg")){return A.checked;}else{A.value=A.checked?"true":"false";return true;}}if(A.tagName.toLowerCase()=="option"){return A.selected;}return true;};UpdateHelper.addURLToParams=function(D,F,C){F=F.substring(F.indexOf("?")+1,F.length);var G=F.split("&");var I="";var E="";var A="";var H=/\+/g;for(var B=0;B<G.length;B++){I=G[B].split("=");E=I[0];A=I[1];if(A){A=decodeURIComponent(A.replace(H," "));}if(C){D[E]=A;}else{UpdateHelper.addAdditionalParam(D,E,A);}}return false;};UpdateHelper.addAdditionalParam=function(A,B,C){if(A[B]&&typeof A[B]!="object"){A[B]=[A[B],C];}else{if(A[B]&&A[B].push){A[B].push(C);}else{A[B]=C;}}};UpdateHelper.submitRequest=function(H){var N=getObj("pageStateForm");var E=null;var I=null;var G;var F;var C;var O;UpdateHelper.appendPageStateToParams(H);if(typeof (microstrategy)!="undefined"&&typeof (microstrategy.bones.rwb_viewer)!="undefined"&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){var L=microstrategy.bones.rwb_viewer;H.docSelections=L.commands.queryState("selectionsKey");L.adjustScrollValues();H.viewerScroll=L.dScrollTop+","+L.dScrollLeft;H.isLocked=(L.insertionControlLocked)?1:0;var M=L.doc.currentControlSubtype?"|"+L.doc.currentControlSubtype:"";H.currentControl=L.doc.currentControl+M;}if(typeof (microstrategy)!="undefined"&&microstrategy.DISPLAY_MODE==microstrategy.VIEW_MODE&&microstrategy.EDIT_MODE==microstrategy.ALLOW_EDIT_MODE){for(var A in microstrategy.bones){if(microstrategy.bones[A]!=null&&microstrategy.bones[A].type==microstrategy.OBJTYPE_GRID){var B=microstrategy.bones[A];if(B&&B.gridStructureInfo&&!B.gridStructureInfo.emptyCase&&!B.gridStructureInfo.isEmptyTemplate){if(B.isGrid){var K=B.commands.queryState("selections");if(K){H[B.id]=K;}}if(B.isGraph&&A.indexOf("_graph")==-1){H[B.id+"_gs"]=B.commands.queryState("graphSelections");}}}}}if(H.iframe=="true"){microstrategy.updateManager.submitPartialUpdate(H);}else{var J=UpdateHelper.createFormFromParams(H);UpdateHelper.appendPageSizeToParams(J);if(mstr.utils.ISSAFARI&&J.target=="_blank"){J.action+=(J.action.indexOf("?")==-1?"?":"&");J.action+="t="+new Date().getTime();}try{microstrategy.submitForm(J);}catch(D){if(J.target!=""&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){showMessage({contents:microstrategy.descriptors.getDescriptor("5877"),elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}else{microstrategy.errors.log(D);}}}return false;};UpdateHelper.createFormFromParams=function(A){var C=document.createElement("FORM");C.name="dynamic_form";C.method=A.method;delete A.method;C.action=A.action;delete A.action;if(typeof A.target!="undefined"){C.target=A.target;delete A.target;}C.setAttribute("hasUpdateChanges",A.hasUpdateChanges=="true");for(var D in A){if(A[D]){if(typeof A[D]=="object"){for(var B=0;B<A[D].length;B++){if(A[D][B]){createHiddenInput(C,D,A[D][B]);}}}else{createHiddenInput(C,D,A[D]);}}}document.body.insertAdjacentElement("beforeEnd",C);return C;};UpdateHelper.submitFormThroughXHR=function(B,D){if(D){if(!B){B=window.event;}var B=getEventTarget(B);if(!B){return false;}}var F=microstrategy.findAncestorWithTag(B,"FORM");var C=B.name;var A=B.value;if(typeof F=="undefined"||typeof C=="undefined"||typeof A=="undefined"){return false;}var E=UpdateHelper.createParamsFromForm(F,C,A,true);UpdateHelper.appendPageStateToParams(E);microstrategy.updateManager.submitPartialUpdate(E);return false;};UpdateHelper.appendPageStateToParams=function(A){var E=getObj("pageStateForm");var D=null;var B=(typeof (microstrategy)!="undefined")?microstrategy.updateManager:null;var C;if(B&&B.hasChangesToSubmit()){B.flushChangesAsParams(A);UpdateHelper.addEvtOrderToParams(A,mstrUpdateManager.multipleEventID);}if(E){if(A.method=="get"||A.method=="GET"){UpdateHelper.addURLToParams(A,pageState,true);}else{D=E.getElementsByTagName("INPUT");for(C=0;C<D.length;C++){A[D[C].name]=D[C].value;}}}};UpdateHelper.appendPageSizeToParams=function(A){createHiddenInput(A,"innerWidth",getClientWidth());createHiddenInput(A,"innerHeight",getClientHeight());};UpdateHelper.submitLink=function(F){var H;H=F.href;var C;C=F.target;var G=document.getElementById("cssAnalyzerToolbar");var A=(getCookie(ENABLE)=="true")&&(G!=null);if(A){return false;}window.mstrSubmitLink=true;if(C=="frameManager"||(typeof (microstrategy)!="undefined"&&microstrategy.updateManager&&microstrategy.updateManager.hasChangesToSubmit())){var B=UpdateHelper.createParamsFromURL(H);if(C){B.target=C;}UpdateHelper.submitRequest(B);return false;}if(typeof (pageState)!="undefined"){var D=updateLink(H);D=moveAnchor(D);var E=null;if(bIsIE6&&F.childNodes&&(F.childNodes.length==1)&&F.childNodes[0].nodeType==3){E=F.innerHTML;}F.href=D;if(bIsIE6&&E!=null){F.innerHTML=E;}return true;}else{return true;}};UpdateHelper.addEvtOrderToParams=function(A,B,C){if(A.evtorder){if(A.evtorder.indexOf(B)<0){if(C){A.evtorder=A.evtorder+","+B;}else{A.evtorder=B+","+A.evtorder;}A[B]="1";}}else{A.evtorder=B;if(A.evt&&A.evt.length<3){for(j=0;j<A.evt.length;j++){A[A.evt[j]]="1";}}}};UpdateHelper.replaceComponents=function(A,G){try{if(!G){iframe.consolidatedStyles={};iframe.isProcessing=true;if(!bIsW3C){iframe.togglePulldownChildren(document.body,false);}}var C;for(C=0;C<A.length;C++){var F=A[C];if(F&&F.ISEMPTY!="true"){if(F.errBox!="true"||currentModalEditor.length==0){UpdateHelper.updateComponent(F,G);}else{var E=F.content;if(E.length>0){showMessage({contents:E,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_ERROR});}}}}if(!G){for(var B in iframe.consolidatedStyles){updateStyleContainer(iframe.consolidatedStyles[B],B);}if(!bIsW3C){iframe.togglePulldownChildren(document.body,true);}iframe.targets=null;microstrategy.loadDynamicJS();microstrategy.registerNewBones();}}catch(D){microstrategy.errors.log(D);}};UpdateHelper.updateComponent=function(cB,parentId){try{var sReplaceHTML;var aScripts=null;var j;var oParentDiv;if(!cB.id){return ;}if(cB.components&&cB.components.length>1){UpdateHelper.replaceComponents(cB.components,cB.id);return ;}else{if(cB.components&&cB.components.length==1){return ;}}if(cB.slid){var slices=document.getElementsByName(cB.id);if(slices&&slices.length>0){for(var i=0,len=slices.length;i<len;i++){if(slices[i].getAttribute("slid")==cB.slid){oParentDiv=slices[i];break;}}}}if(!oParentDiv){var oParentDivs=document.getElementById(cB.id);if(!oParentDivs&&(cB.dialog||cB.css=="1")){iframe.createPlaceHolder(cB.id);oParentDivs=document.getElementById(cB.id);}if(oParentDivs){if(oParentDivs.length>1){for(var i=0;i<oParentDivs.length;i++){if(oParentDivs[i].tagName=="DIV"){oParentDiv=oParentDivs[i];break;}}}else{oParentDiv=oParentDivs;}}}if(oParentDiv){var sReplaceHTML=cB.content.replace(/'/g,"'");if(cB.message=="true"){showMessage({contents:sReplaceHTML,elements:microstrategy.OK_BUTTON,type:mstrMsgBoxImpl.MSG_WARNING});}var scriptArray=[],chartArray=[];var oDivNode=iframe.createElementFromHTML(sReplaceHTML);if(!oDivNode){return ;}iframe.extractScript(oDivNode,scriptArray);iframe.extractImage(oDivNode,chartArray);if(cB.errorInfo){var errorHolder=document.getElementById("errorInfo");if(errorHolder){errorHolder.innerHTML+=cB.errorInfo;}}if(cB.css=="1"){var styleId=oDivNode.getAttribute("styleid");if(!iframe.consolidatedStyles[styleId]){iframe.consolidatedStyles[styleId]=[];}iframe.consolidatedStyles[styleId]=consolidateStyleSheets(oDivNode,iframe.consolidatedStyles[styleId],styleId);}else{if(oParentDiv.getAttribute(mstrHTMLAttributes.ATTR_MODAL)=="true"||(oParentDiv.popupMask)){togglePulldowns(oParentDiv,true);}if(cB.partialUpdate=="true"&&oParentDiv.childNodes.length>1){oParentDiv.innerHTML=oDivNode.innerHTML;}else{if(bIsW3C&&!bIsIE8&&!bIsIE9&&!bIsIE10&&!bIsSafari){iframe.setOuterHTML(oParentDiv,oDivNode);}else{if(oParentDiv&&oDivNode){if(cB.isFlashVis&&bIsIE8){var o=oParentDiv.getElementsByTagName("object");if(o&&o.length>0){for(var i=0;i<o.length;i++){o[i].parentNode.removeChild(o[i]);}}}oParentDiv.parentNode.replaceChild(oDivNode,oParentDiv);}if(chartArray.length>0){for(var j=0,cnt=chartArray.length;j<cnt;j++){chartArray[j].src=chartArray[j].getAttribute("dsrc");}}}}for(var i=0,len=scriptArray.length;i<len;i++){eval(scriptArray[i].toString());}}}}catch(err){microstrategy.errors.log(err);}};menuScript=true;var oSubCTimer=null;var oSubPkrTimer=null;var bIsOverContext=false;var bDisplayLeft=false;var sQuote="\\'";var sQuoteSimple="'";var sQuoteDouble='"';var aOndemandMenuItems=null;var aMenuItems=null;var aMenuItemsName;var sDrillContextMenuExtraArg1;var currentPicker=null;var specialMenuLayers=null;mstrMenuObj.prototype=new Object();function mstrMenuObj(A){}mstrMenuObj.adjustMenuPositionForClient=function(I,H,B,D){if(B.getAttribute("origHeight")){B.style.height=B.getAttribute("origHeight")+"px";}if(B.getAttribute("origWidth")){B.style.width=B.getAttribute("origWidth")+"px";}var F=B.getAttribute("ty")=="cxt";var J=getObjWidth(F?B.firstChild:B);if(J+I<getClientWidth()+getDocumentScrollLeft()){if(bDisplayLeft&&D){I=D-J+2;}else{bDisplayLeft=false;}}else{bDisplayLeft=true;if(D){I=D-J+2;}else{I=I-J+10;}}var A=getClientHeight();var C=getObjHeight(F?B.firstChild:B);var G=getDocumentScrollTop();var E=(H+C)-(G+A);if(C>A){H=G+1;if(E>0){if(!B.getAttribute("origHeight")){B.setAttribute("origHeight",C);}if(!B.getAttribute("origWidth")){B.setAttribute("origWidth",J);}if(!F){B.style.height=Math.min(C,A)+"px";B.style.width=Math.min(J,J+B.offsetWidth-B.clientWidth)+"px";B.style.overflowY="auto";}}}else{if(E>0){H=G+A-C-2;}}if(F){B.style.height=Math.min(C,A)+"px";B.style.width=Math.min(J,J+B.offsetWidth-B.clientWidth)+"px";if(B.offsetHeight<C){if(bIsIE7){B.style.overflow="auto";}else{B.style.overflowY="auto";}}}moveObjTo(B,I,H);};function displayContextMenu(oTarget,e,moveMenu){var sMenu=oTarget.getAttribute("CX");if(sMenu.length==0){return true;}var menuDefTarget=findTarget(oTarget,"CXID");var aMenuElementsName=menuDefTarget.getAttribute("CXID");var aMenuElements=microstrategy.getContextMenuManager(aMenuElementsName).menu_items;if(!aMenuElements||aMenuElements.length==0){return false;}var sDrillExtraArgument1=oTarget.getAttribute("D1");var types=oTarget.getAttribute("cxty");if(typeof (microstrategy)!="undefined"){microstrategy.updateActiveCXProps(oTarget,e);}hideContextMenus();getMouse(e);aMenuItems=aMenuElements;aMenuItemsName=aMenuElementsName;sDrillContextMenuExtraArg1=sDrillExtraArgument1;var avMenu=eval(sMenu);buildContextMenu(avMenu,1,eval(types),oTarget,false,null);if(hasMenuItem(avMenu,eval(types))){var menuX,menuY;if(moveMenu){var tID=oTarget.id;var menuX=getObjSumLeftScrolled(tID)+3;var menuY=getObjSumTopScrolled(tID)+getObjHeight(tID)+4;oTarget.onmouseout=function(){OutContext();};}else{menuX=lMouseX-microstrategy.CURSOR_OFFSET;menuY=lMouseY-microstrategy.CURSOR_OFFSET;}positionContextMenu(menuX,menuY,aMenuItemsName+"1");if(bIsIE4){togglePulldowns(getObj(aMenuItemsName+"1"),false);}document.getElementById(aMenuItemsName+"1").style.visibility="visible";microstrategy.setContextMenuStatus(true);}return false;}function isMenuShown(menuItem,selectedTypes){var supportedTypes=menuItem[5];var showJS=menuItem[6];var displayMenuItem=true;var __result=true;if(supportedTypes&&supportedTypes.length>0&&selectedTypes&&selectedTypes.length>0){var supportedTypesArray=eval(supportedTypes);__result=false;for(var j=0;j<selectedTypes.length;j++){for(var i=0;i<supportedTypesArray.length;i++){if(selectedTypes[j]==supportedTypesArray[i]){__result=true;break;}}if(__result){break;}}}if(showJS&&showJS.length>0&&__result==true){if(showJS=="$check-subMenu-existence$"){var subs=eval(menuItem[4]);var n=subs.length;if(n>0){for(var i=0;i<n;i++){var sub=aMenuItems[subs[i]];if(sub){__result=isMenuShown(sub,selectedTypes);if(__result){break;}}}}else{__result=false;}}else{__result=eval(showJS)?true:false;}}return __result;}function getPicker(D){var E=document.getElementsByName(D);var A=null;var C=document.body.childNodes;for(var B=0;B<C.length;B++){if(C[B].id==D){A=C[B];break;}}if(E){if(!A){while(E.length>1){E[0].parentNode.removeChild(E[0]);}A=document.body.appendChild(E[0]);}}return A;}function showPicker(A,E,H,G,F){var C=getPicker(E);if(C){if(A){currentPicker=C;var B=aMenuItemsName+F;var D=getElementById(B);if(D){C.style.zIndex=D.style.zIndex+100;}C.style.visibility="hidden";C.style.display="block";mstrMenuObj.adjustMenuPositionForClient(H,G,C);if(bDisplayLeft){C.style.left=parseInt(C.style.left,10)-getObjWidth(D)+"px";}C.style.visibility="visible";}else{C.style.display="none";currentPicker=null;}}}function buildContextMenuRows(avItems,iMenu,types,oTarget,loadOndemandMenuItems,modelID){var sContent="";var lRowCount=0;var sRowID="";var sSubCommand="";var sOnClickLink="";var hasMenuItem=false;var enabled=true;if(!oTarget){oTarget=microstrategy.activeCXMenu;}var aMenuItemsLocal=null;if(loadOndemandMenuItems){aMenuItemsLocal=aOndemandMenuItems;lRowCount=getNumTagsInDiv(aMenuItemsName+iMenu,"tr");}else{aMenuItemsLocal=aMenuItems;}for(var iIndex=0;iIndex<avItems.length;iIndex++){if(aMenuItemsLocal[avItems[iIndex]][3]!=2){if(isMenuShown(aMenuItemsLocal[avItems[iIndex]],types)){hasMenuItem=true;var menuClass="menu-item";var menuClassWithSeparator="menu-item-with-separator";var separatorClass="menu-item-separator";enabled=true;var enableJS=aMenuItemsLocal[avItems[iIndex]][7];if(enableJS&&enableJS.length>0){enabled=eval(enableJS);}if(!enabled||aMenuItemsLocal[avItems[iIndex]][8]==1){menuClass="menu-item-disabled";menuClassWithSeparator="menu-item-disabled-with-separator";}sRowID="cm"+iMenu+"r"+lRowCount;sContent+='<TR ID="'+sRowID+'" HEIGHT="18" AC="true" ';var cmd=aMenuItemsLocal[avItems[iIndex]][1];if(menuClass=="menu-item"){cmd=replacePlaceholders(cmd,oTarget);if(aMenuItemsLocal[avItems[iIndex]][3]==1){var typesString=convertArrayToString(types);if(aMenuItemsLocal[avItems[iIndex]][10]!=null){var ondemandModelId=aMenuItemsLocal[avItems[iIndex]][10];var ondemandDynamicMenuKey=aMenuItemsLocal[avItems[iIndex]][11];var ondemandViewId=aMenuItemsLocal[avItems[iIndex]][12];sSubCommand="buildSubMenu("+aMenuItemsLocal[avItems[iIndex]][4]+", "+(iMenu+1)+", getObjSumTop("+sQuote+sRowID+sQuote+"), ["+typesString+"], "+loadOndemandMenuItems+", "+sQuote+ondemandModelId+sQuote+", "+sQuote+ondemandDynamicMenuKey+sQuote+", "+sQuote+ondemandViewId+sQuote+" );";}else{sSubCommand="buildSubMenu("+aMenuItemsLocal[avItems[iIndex]][4]+", "+(iMenu+1)+", getObjSumTopScrolled("+sQuote+sRowID+sQuote+"), ["+typesString+"], "+loadOndemandMenuItems+");";}sContent+="onMouseOver=\"clearTimeout(oSubCTimer); delaySubCMenus('"+sSubCommand+"'); menuOn(this);\" ";sContent+='onMouseOut="menuOff(this);" LI="sub" ';}else{if(aMenuItemsLocal[avItems[iIndex]][3]==3){sSubCommand="hideContextSubMenus("+iMenu+"); showPicker(true,"+sQuote+aMenuItemsLocal[avItems[iIndex]][4]+sQuote+",getObjWidth("+sQuote+sRowID+sQuote+") + getObjSumLeft("+sQuote+sRowID+sQuote+"), getObjSumTop("+sQuote+sRowID+sQuote+"),"+iMenu+");";sContent+="onMouseOver=\"clearTimeout(oSubCTimer); delaySubCMenus('"+sSubCommand+"'); menuOn(this);\"";sContent+='onMouseOut="menuOff(this);"';var pkr=getPicker(aMenuItemsLocal[avItems[iIndex]][4]);if(pkr){pkr.onmouseover=new Function("clearTimeout(oSubPkrTimer);");pkr.onmouseout=new Function("OutContext();");pkr.onmousedown=new Function("e","if (!e) {e=window.event;} eval("+cmd+");OutContext();");}}else{sContent+='onMouseOver="clearTimeout(oSubCTimer); menuOn(this);';sContent+=" hideContextSubMenus("+iMenu+");";sContent+='" onMouseOut="menuOff(this);" ';sOnClickLink=cmd;if(sOnClickLink.indexOf("DCM")!=-1){if(sDrillContextMenuExtraArg1==null){sOnClickLink=sOnClickLink.substr(0,sOnClickLink.indexOf(")"))+",'')";}else{sOnClickLink=sOnClickLink.substr(0,sOnClickLink.indexOf(")"))+",'"+sDrillContextMenuExtraArg1+"')";}}sContent+="onClick=\"menuClick(this, '"+aMenuItemsName+iMenu+'\');" LI="'+sOnClickLink+';" ';}}if(bIsW3C){sContent+='STYLE="cursor: pointer;"';}else{sContent+='STYLE="cursor: hand;"';}}var isNextMenuOptionASeparator=isNextMenuSeparator(aMenuItemsLocal,avItems,iIndex,types);sContent+=">\n";sContent+='<TD WIDTH="12" ALIGN="MIDDLE" CLASS="mstrContextMenuLeft"';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+=">";switch(aMenuItemsLocal[avItems[iIndex]][2]){case 0:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 1:var showCheck=true;var checkJS=aMenuItemsLocal[avItems[iIndex]][9];if(checkJS&&checkJS.length>0){showCheck=eval(checkJS);}if(showCheck){sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuCheck.gif" WIDTH="12" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';}break;case 2:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'CMenuRemove.gif" WIDTH="11" HEIGHT="11" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" /><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="1" HEIGHT="1" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 3:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'CMenuSubtotal.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 4:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillUp.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 5:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillDown.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 6:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'arrow_DrillTemplate.gif" WIDTH="9" HEIGHT="9" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 7:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'drill.png" WIDTH="16" HEIGHT="16" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;case 8:sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'treeLoading.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';break;}sContent+="</TD>";sContent+='<TD WIDTH="1"';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+='><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"></TD>';sContent+='<TD ALIGN="LEFT" NOWRAP="1" ';if(isNextMenuOptionASeparator){sContent+=" class="+menuClassWithSeparator+" ";}else{sContent+=" class="+menuClass+" ";}sContent+=">"+aMenuItemsLocal[avItems[iIndex]][0]+"&nbsp;&nbsp;<BR/></TD>";sContent+='<TD WIDTH="12" ALIGN="RIGHT" NOWRAP="1" ';if(isNextMenuOptionASeparator){sContent+=" class="+separatorClass+" ";}sContent+=">";if(aMenuItemsLocal[avItems[iIndex]][3]==1||aMenuItemsLocal[avItems[iIndex]][3]==3){var expandImage=enabled?"MenuExpand.gif":"MenuExpand_off.gif";sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+expandImage+'" WIDTH="8" HEIGHT="9" ALT="" BORDER="0" /><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="2" HEIGHT="1" ALT="0" BORDER="0" />';}else{sContent+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" ALT="0" BORDER="0" />';}sContent+="</TD></TR>\n";lRowCount++;}}}return sContent;}function replacePlaceholders(str,oTarget){var matched=false;var tempStr=str;if(tempStr.indexOf("%40")>-1){tempStr=unescape(tempStr);}if(tempStr.indexOf("@")>-1){tempStr=tempStr.replace(/@[^@]+@/g,function(token){matched=true;var attName=token.substring(1,token.length-1);if(attName.indexOf("__bone__")>-1){attName=attName.replace("__bone__","microstrategy.findBone(microstrategy.activeCXMenu)");return eval(attName);}else{return oTarget.getAttribute(attName)||"";}});}if(matched){return tempStr;}else{return str;}}function isNextMenuSeparator(E,A,D,C){for(var B=D+1;B<A.length;B++){if(isMenuShown(E[A[B]],C)){return(E[A[B]][3]==2);}}return false;}function getMenuDiv(B){var A=getObj(B);if(!A){A=document.createElement("DIV");A.setAttribute("id",B);A.setAttribute(microstrategy.HTMLATTR_OBJTYPE,microstrategy.OBJTYPE_CONTEXT_MENU);A.onmouseover=OverContext;A.onmouseout=OutContext;A.style.visibility="hidden";A.style.position="absolute";A.style.backgroundColor="#FFFFFF";A.style.border="1px #ddd solid";A.style.top="-999px";document.body.appendChild(A);}return A;}function buildContextMenu(B,H,E,C,F,G){var D="";D='<TABLE BORDER="0" CELLSPACING="0" CLASS="mstrContextMenuRight">\n';D+=buildContextMenuRows(B,H,E,C,F,G);D+="</TABLE>";var A=getMenuDiv(aMenuItemsName+H);A.innerHTML=D;}function hasMenuItem(A,B){for(var C=0;C<A.length;C++){if(aMenuItems[A[C]][3]!=2){if(isMenuShown(aMenuItems[A[C]],B)){return true;}}}return false;}function upClick(C){if(bIsW3C&&!C){return false;}var B=(bIsIE4)?(event.button==2||event.button==3):(C.button==3);if(B){var A=getEventTarget(C);A=findTarget(A,"CX");if(A){document.onmouseup=null;return false;}}}function OverContext(){bIsOverContext=true;}function OutContext(){clearTimeout(oSubCTimer);bIsOverContext=false;}function hideContextMenus(){if(typeof (aMenuItemsName)=="undefined"){return ;}if(!bIsOverContext){hideContextSubMenus(1);var A=getObj(aMenuItemsName+"1");if(A){A.style.visibility="hidden";A.style.top="-999px";microstrategy.setContextMenuStatus(false);A.innerHTML="";}if(bIsIE4){togglePulldowns(A,true);}}}function hideContextSubMenus(C){var B=1;for(var B=4;B>C;B--){var A=getObj(aMenuItemsName+B);if(A){A.style.visibility="hidden";A.innerHTML="";if(bIsIE4){togglePulldowns(A,true);}}}if(currentPicker!=null){currentPicker.style.display="none";currentPicker=null;}}function buildSubMenu(C,D,K,H,F,B,L,A){var G=aMenuItemsName+D;var I=getMenuDiv(G);I.modelID=B;if(bIsIE4){I.style.height="auto";I.style.width="auto";I.style.overflowY="visible";}I.style.zIndex=1000;buildContextMenu(C,D,H,null,F,B);addOndemandSubMenuItems(B,L,A,D);if(I.childNodes.length==0){return ;}var E=getObjLeft(aMenuItemsName+(D-1));var J=getObjWidth(aMenuItemsName+(D-1));positionContextMenu(E+J-2,K,G,E);if(bIsIE4){togglePulldowns(getObj(aMenuItemsName+D),false);}hideContextSubMenus(D);document.getElementById(aMenuItemsName+D).style.visibility="visible";}function delaySubCMenus(sExecuteText){clearTimeout(oSubCTimer);if(sExecuteText.length>0){if(bIsInPortal&&mstr.utils.ISFF3){eval(sExecuteText);}else{oSubCTimer=window.setTimeout(sExecuteText,250);}}}function positionContextMenu(E,C,D,B){if(bIsIE4){var A=D;if(typeof (A)=="string"){A=document.getElementById(D);}if(A){A.style.height="auto";A.style.width="auto";A.style.overflowY="visible";}}var A=getObj(D);A.style.zIndex=1000;mstrMenuObj.adjustMenuPositionForClient(E,C,A,B);}function generateLink(A){A+="&innerWidth="+getClientWidth()+"&innerHeight="+getClientHeight();return A;}function submitCM(D,B,E){if(B){D=D+"&iframe=true";}var A=true;if(microstrategy&&microstrategy.eventManager){A=microstrategy.eventManager.notifyOrphanBones("onmenusubmitform");}if(A){var C=createDynamicForm(D);if(B){C.target="frameManager";}if(E!=null){C.target=E;}}submitForm(C);}dropDownMenusScript=true;var oTimer=null;var bIsOver=false;var oSubTimer=null;var bMenuOpen=false;var bCompleted=false;var asBranch=new Array();var nBranchElements=0;var bClickStyle=false;function activateHeader(F,E,D){for(var B=0;B<iMainMenus;B++){var A=getObj("menuHeader"+B);if(A){var C=A.getAttribute("E")=="0";if(!C){if(B==F){A.className=E;}else{A.className=D;}}}}}function fixMenus(A){var B;for(i=0;i<A.length;i++){B=getObj(A[i][1]);if(B){B.setAttribute(A[i][2],A[i][3]);}}B=B=getObj("mb"+A[0][0]);if(B){B.setAttribute("C","0");}}function updateCheckedAndEnabledOptions(menuName){var menu=getObj(menuName);var TABLEs=menu.getElementsByTagName("TABLE");TABLEs[0].className="menu-block";var TRs=TABLEs[0].getElementsByTagName("TR");var menuUpdated=false;var newValue;var wasChecked;var wasEnabled;var wasShown;var baseBone;for(i=0;i<TRs.length;i++){baseBone=TRs[i].getAttribute("BB");wasChecked=TRs[i].getAttribute("H");wasEnabled=TRs[i].getAttribute("E");wasShown=(TRs[i].style.display!="none");if(baseBone&&baseBone.length>0&&!(microstrategy&&microstrategy.bone(baseBone))){continue;}var auxStr=TRs[i].getAttribute("DS");if(auxStr&&auxStr.length>0){newValue=eval(auxStr);if(newValue!=wasShown){menuUpdated=true;if(newValue){TRs[i].style.display="";}else{TRs[i].style.display="none";continue;}}}var auxStr=TRs[i].getAttribute("DC");if(auxStr&&auxStr.length>0){newValue=eval(auxStr)?"1":"0";if(newValue!=wasChecked){TRs[i].setAttribute("H",newValue);menuUpdated=true;}}auxStr=TRs[i].getAttribute("DE");if(auxStr&&auxStr.length>0){newValue=eval(auxStr)?"1":"0";if(newValue!=wasEnabled){TRs[i].setAttribute("E",newValue);menuUpdated=true;}}}if(menuUpdated){menu.setAttribute("C","0");}}function completeMenu(A){var E;var C;var F=getObj(A);var D=F.getElementsByTagName("TABLE");D[0].className="menu-block";var B=D[0].getElementsByTagName("TD");for(i=0;i<B.length;i++){if(B[i].id=="blank"){B[i].width="1";B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="1" HEIGTH="1">';}else{if(B[i].id=="mnI"){B[i].align="middle";if(B[i].parentNode.getAttribute("E")=="1"){B[i].className="menu-item-image";}else{B[i].className="menu-item-image-disabled";}if(B[i].parentNode.getAttribute("H")=="1"){B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuCheck.gif" style="width:12px;height:9px;">';}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif">';}}else{if(B[i].id=="mnT"||B[i].id=="mnS"){B[i].noWrap=true;C=(B[i].parentNode.getAttribute("E")=="1");if(C){B[i].className="menu-item";}else{B[i].className="menu-item-disabled";}if(B[i].parentNode.getAttribute("AS")=="1"){if(C){B[i].className="menu-top-separator";}else{B[i].className="menu-top-separator-disabled";}}}else{if(B[i].id=="mnE"){B[i].width="12";B[i].align="right";C=(B[i].parentNode.getAttribute("E")=="1");if(B[i].parentNode.getAttribute("AS")=="1"){if(C){B[i].className="menu-top-separator";}else{B[i].className="menu-top-separator-disabled";}}if(B[i].parentNode.getAttribute("SB")=="1"){if(C){B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuExpand.gif" WIDTH="8" HEIGTH="9">';}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'MenuExpand_off.gif" WIDTH="8" HEIGTH="9">';}}else{B[i].innerHTML='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGTH="10">';}}}}}}F.setAttribute("C","1");bCompleted=true;}function ShowLayer(G,E){if(oTimer){clearTimeout(oTimer);}HideAllLayers();if(isNaN(G)){if(specialMenuLayers==null){specialMenuLayers=[];}specialMenuLayers.push(G);}var F=getObj("mb"+G);if(F.getAttribute("C")!="1"){completeMenu("mb"+G);}var B=(E)?E:("menuHeader"+G);var C=getObjSumTop(B)+getObjHeight(B);var D=getObjSumLeftScrolled(B);var A=getObj("mb"+G);A.style.zIndex=1000;positionContextMenu(D,C,A);if(bIsIE4){togglePulldowns(A,false);}asBranch[0]="mb"+G;nBranchElements=1;A.style.visibility="visible";bMenuOpen=true;}function hidePopupMenus(A){hideContextMenus();if(A||(bClickStyle&&bMenuOpen)){UnselectAllLayers();}}function UnselectAllLayers(){if(!bIsOver&&typeof (iMainMenus)!="undefined"){HideAllLayers();var B;for(var A=0;A<iMainMenus;A++){B=getObj("menuHeader"+A);if(B){if(B.getAttribute("E")=="0"){B.className=mstrMenuDisabledClass;}else{B.className=mstrMenuEnabledClass;}}}bMenuOpen=false;}}function HideAllLayers(){nBranchElements=0;if(!bIsOver&&typeof (iSubMenus)!="undefined"){for(var A=0;A<iSubMenus;A++){var B=document.getElementById("mb"+A);if(B){B.style.visibility="hidden";}}if(specialMenuLayers!=null){for(var A=0;A<=specialMenuLayers.length;A++){document.getElementById("mb"+specialMenuLayers[A]).style.visibility="hidden";}specialMenuLayers=null;}if(bIsIE4){togglePulldowns(null,true);}}bMenuOpen=false;}function OverLayer(){if(oTimer){clearTimeout(oTimer);}bIsOver=true;}function OutLayer(){if(oTimer){clearTimeout(oTimer);}bIsOver=false;if(!bClickStyle){oTimer=setTimeout("UnselectAllLayers()",300);}}function hideSubMenu(F,C,B){var E=false;var A=0;for(i=0;i<nBranchElements;i++){if(E){var D=document.getElementById(asBranch[i]);if(D){if(bIsIE4){togglePulldowns(D,true);}D.style.visibility="hidden";}asBranch[i]=0;}if(asBranch[i]==C){E=true;A=i+1;}}nBranchElements=A+1;asBranch[nBranchElements-1]=F;}function menuOn(A){if(A.className!="menuDisabled"){A.className="menu-row-selected";}}function menuOff(A){if(A.className!="menuDisabled"){A.className="menu-row";}}function menuClick(oMenuItem,sMenu){var oMenu=typeof (sMenu)=="string"?document.getElementById(sMenu):sMenu;if(oMenu.modelID){var model=mstr.$obj(oMenu.modelID);if(model){var state=model.get("readyState");if(state&&state===mstr.Enum.Widget.READYSTATE.WAITING){return ;}}}if(oMenuItem.className!="menuDisabled"){if(oMenuItem.getAttribute("AC")=="true"){var sLink=oMenuItem.getAttribute("LI");if(sLink.length>0){bIsOverContext=false;oMenu.style.visibility="hidden";hideContextMenus();window.mstrSubmitLink=true;eval(sLink);}}else{bIsOverContext=false;oMenu.style.visibility="hidden";HideAllLayers();hideContextMenus();}}}function onCl(A){onMv(A);ShowLayer(A.getAttribute("ndx"));}function onMv(C){var B=C.getAttribute("E")=="0";var A=C.getAttribute("ndx");updateCheckedAndEnabledOptions("mb"+A);if(getObj("mb"+A).getAttribute("C")!="1"){completeMenu("mb"+A);}if(!B){if(bMenuOpen){activateHeader(A,"menu-header-selected","menu-header");ShowLayer(A);}else{activateHeader(A,"menu-header-selected","menu-header");}}}function onMo(B){var A=B.getAttribute("E")=="0";if(!A){if(!bMenuOpen){B.className="menu-header";}else{OutLayer("menu-header","menu-header-disabled");}}}function convertArrayToString(A){var C="";if(A){for(var B=0;B<A.length;B++){if(A[B]){C=C+sQuote+A[B]+sQuote+", ";}else{C=C+"null, ";}}C=C.substr(0,C.length-2);}return C;}function buildWidgetSubMenu(C,J,Q,D){completeMenu(C);if(!D){D="currentControl";}var P=getObj(C);var L=P.getElementsByTagName("tbody")[0];var I=L.firstChild;var M=I.getAttribute("id");M=M.substr(0,M.length-1);var K=microstrategy.getViewerBone().widgets;var G=false;if(K){if(L.hasChildNodes()){for(var F=L.childNodes.length-1;F>=0;F--){if(J||L.childNodes[F].getAttribute("dyn_menu")){L.removeChild(L.childNodes[F]);}}}G=!J&&L.hasChildNodes();var E=false;for(var F=0;F<K.length;F++){var O=K[F];if(!Q||Q==O.scope){var B=I.getAttribute("id");var H=I.cloneNode(true);H.setAttribute("id",M+F);H.setAttribute("dyn_menu",true);H.className="ctrl"+O.tbClass;if(!E&&G){H.setAttribute("AS",1);E=true;}var N=microstrategy.SUBOBJTYPE_DOC_WIDGET+"|"+O.fqcn+";"+O.rslPath+";"+O.title+";"+O.previewImage+";"+O.isApp+";"+O.scope+";"+O.defaultDHTMLStyle;var A="microstrategy.bone('rwb_viewer').commands.exec('"+D+"', '"+N+"');";if(D=="currentControl"){A+="microstrategy.eventManager.notifyOrphanBones('requestCurrentControlChange', '"+N+"');";}H.setAttribute("JS",A);H.childNodes[2].innerHTML=O.title;L.appendChild(H);}}completeMenu(C);}}function addOndemandSubMenuItems(G,C,E,H){if(G){var B=mstr.$obj(G);if(!B){return ;}var A=mstr.$obj(E);if(C){B.setCurrentDynamicMenuKey(C);}var D="";if(microstrategy.EXECUTION_SCOPE==microstrategy.REPORT_EXECUTION){D="Report";}else{var F=microstrategy.findBone(microstrategy.activeCXMenu);D=F.objId;}B.setGridKey(D);A.setMenuLevel(H);A.setModel(B);B.execPopulate();}}function addDynamicMenus(E,D,B){setOndemandMenuItems(D);var C=buildContextMenuRows(B,E,null,null,true,null);var A=getMenuDiv(aMenuItemsName+E);if(C==""){if(A.childNodes[0].rows&&A.childNodes[0].rows.length==0){hideContextSubMenus(E-1);}}else{addToExistingDivTable(A,C);mstrMenuObj.adjustMenuPositionForClient(parseInt(A.style.left,10),parseInt(A.style.top,10),A);}}function addToExistingDivTable(E,C){var B=document.createElement("div");B.innerHTML="<TABLE>"+C+"</TABLE>\n";var D=B.childNodes[0];var A=E.childNodes[0];if(A!=null&&(A.tBodies==null||A.tBodies.length==0)){A.appendChild(document.createElement("tbody"));}while(D.rows.length>0&&(A!=undefined)){A.tBodies[0].appendChild(D.rows[0]);}}function getNumTagsInDiv(C,B){var D=getObj(C);var A=D.getElementsByTagName(B);if(A!=null){return A.length;}else{return 0;}}function setOndemandMenuItems(A){aOndemandMenuItems=A;}function removeProcessingMenuItem(D){var A=getMenuDiv(aMenuItemsName+D);var C=A.getElementsByTagName("tr");if(C!=null){var B=0;while(B<C.length){if(C[B]!=null&&"processing"==C[B].getAttribute("id")){C[B].parentNode.removeChild(C[B]);}B++;}}}function addProcessingMenuItem(E){var B=microstrategy.descriptors.getDescriptor("2901");var C="";var D="menu-item";C+='<TR ID="processing" name="processing" HEIGHT="18" AC="true" ';C+='onMouseOver="clearTimeout(oSubCTimer); menuOn(this);';C+=" hideContextSubMenus("+E+");";C+='" onMouseOut="menuOff(this);" ';if(bIsW3C){C+='STYLE="cursor: pointer;"';}else{C+='STYLE="cursor: hand;"';}C+=">\n";C+='<TD WIDTH="12" ALIGN="MIDDLE" CLASS="mstrContextMenuLeft">';C+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'treeLoading.gif" WIDTH="12" HEIGHT="12" HSPACE="0" VSPACE="0" ALT="" BORDER="0" ALIGN="ABSMIDDLE" />';C+="</TD>";C+='<TD WIDTH="1"><IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" HEIGHT="1" WIDTH="1" ALT="" BORDER="0"></TD>';C+='<TD ALIGN="LEFT" NOWRAP="1" ';C+=" class="+D+" ";C+=">"+B+"&nbsp;&nbsp;<BR/></TD>";C+='<TD WIDTH="12" ALIGN="RIGHT" NOWRAP="1" ';C+=">";C+='<IMG SRC="'+microstrategy.FOLDER_IMAGES+'1ptrans.gif" WIDTH="12" HEIGHT="1" ALT="0" BORDER="0" />';C+="</TD>";C+="</TR>";var A=getMenuDiv(aMenuItemsName+E);addToExistingDivTable(A,C);}mstrContextMenuManagerImpl.prototype=new Object();contextMenuManagerScript=true;mstrContextMenuManagerImpl.prototype.id=null;mstrContextMenuManagerImpl.prototype.dynamic_menus=new Array;mstrContextMenuManagerImpl.prototype.menu_items=new Array;microstrategy.contextMenuManagers=new Array;microstrategy.unloadContextMenuManager=function(B){for(var A=0;A<microstrategy.contextMenuManagers.length;A++){if(microstrategy.contextMenuManagers[A].id==B){microstrategy.contextMenuManagers.splice(A,1);}}};microstrategy.getContextMenuManager=function(B){for(var A=0;A<microstrategy.contextMenuManagers.length;A++){if(microstrategy.contextMenuManagers[A].id==B){return microstrategy.contextMenuManagers[A];}}var C=new mstrContextMenuManagerImpl(B);microstrategy.contextMenuManagers.push(C);return C;};mstrContextMenuManagerImpl.prototype.getMenu=function(D){var C,A;try{if(D){for(C=0;C<this.dynamic_menus.length;C++){if(this.dynamic_menus[C]!=null){if(this.dynamic_menus[C][0]==D){return new mstrContextMenuImpl(this.id,this.menu_items,this.dynamic_menus[C][1]);}}}}var B=this.dynamic_menus.length;this.dynamic_menus[B]=new Array;this.dynamic_menus[B][0]=D;this.dynamic_menus[B][1]=new Array;return new mstrContextMenuImpl(this.id,this.menu_items,this.dynamic_menus[B][1]);}catch(E){microstrategy.errors.log(E);return false;}};mstrContextMenuManagerImpl.prototype.findMenuItem=function(C,B){try{var A=new Array();if(B!=null){for(i=0;i<B.length;i++){if(this.menu_items[B[i]][0]==C){A.push(this.menu_items[B[i]]);}}}else{for(i=0;i<this.menu_items.length;i++){if(this.menu_items[i][0]==C){A.push(this.menu_items[i]);}}}return A;}catch(D){microstrategy.errors.log(D);return false;}};function mstrContextMenuManagerImpl(key){try{if(key){if(eval("(typeof("+key+") != 'undefined')")){this.menu_items=eval(key);}if(eval("(typeof("+key+"_dyn) != 'undefined')")){this.dynamic_menus=eval(key+"_dyn");}this.id=key;}return this;}catch(err){microstrategy.errors.log(err);return false;}}mstrContextMenuImpl.prototype=new Object();contextMenuScript=true;mstrContextMenuImpl.prototype.cmm_id=null;mstrContextMenuImpl.prototype.cmm_items=null;mstrContextMenuImpl.prototype.menu_items=null;mstrContextMenuImpl.prototype.length=0;mstrContextMenuImpl.IMG_EMPTY=0;mstrContextMenuImpl.IMG_CHECK=1;mstrContextMenuImpl.IMG_REMOVE=2;mstrContextMenuImpl.IMG_SUBTOTAL=3;mstrContextMenuImpl.IMG_DRILL_UP=4;mstrContextMenuImpl.IMG_DRILL_DOWN=5;mstrContextMenuImpl.IMG_DRILL_TEMPLATE=6;mstrContextMenuImpl.IMG_DRILL=7;mstrContextMenuImpl.IMG_LOADING=8;mstrContextMenuImpl.prototype.addItem=function(B,C,E,A,G){try{var F;if(!E){E=1;}if(!A){A=1;}if(!G){G=mstrContextMenuImpl.IMG_EMPTY;}if(typeof (C)=="string"){F=new Array(B,C,G,0,"","",A,E);}else{F=new Array(B,"",G,1,"["+C.menu_items.toString()+"]","",A,E);}return this.addItemDefinition(F);}catch(D){microstrategy.errors.log(D);return false;}};mstrContextMenuImpl.prototype.addSeparator=function(){try{var B=new Array("-","",0,2,"",1,1);return this.addItemDefinition(B);}catch(A){microstrategy.errors.log(A);return false;}};mstrContextMenuImpl.prototype.addItemDefinition=function(B){try{this.cmm_items.push(B);this.menu_items.push(this.cmm_items.length-1);this.length=this.menu_items.length;return B;}catch(A){microstrategy.errors.log(A);return false;}};mstrContextMenuImpl.prototype.registerTrigger=function(A,B){try{if(A){A.setAttribute("cx","["+this.menu_items.toString()+"]");A.setAttribute("cxid",this.cmm_id);if(B){A.setAttribute("cxty",B);}}return true;}catch(C){microstrategy.errors.log(C);return false;}};function mstrContextMenuImpl(A,C,B){this.cmm_id=A;this.cmm_items=C;this.menu_items=B;return this;}
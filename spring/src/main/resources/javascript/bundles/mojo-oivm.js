var xmjd=mstrmojo&&mstrmojo.descriptors;var mstrmojo={descriptors:xmjd||{},meta:{TP:"t",STP:"st"},emptyFn:function(){},tstid:function(B){var A;if(B){if(typeof (B)==="object"){A=B.tstid;}else{A=B;}}return A?'tstid="'+A+'"':"";},getMissingFn:function getMissingFn(){return function(){var C=this.scriptClass,A;try{for(A in this){if(this[A]===arguments.callee){C+="."+A;break;}}}catch(B){}throw new Error("Missing abstract method: "+C);};},now:function now(){return new Date().getTime();},usesFrames:false};(function(){mstrmojo.global=(function(){var F=function(){return this;};return F.call(null);}());mstrmojo.dbg=mstrmojo.emptyFn;mstrmojo.dbg_stack=mstrmojo.emptyFn;mstrmojo.dbg_xhr=mstrmojo.emptyFn;mstrmojo.dbg_profile=mstrmojo.emptyFn;mstrmojo.debugBundles=(function(){return(window.mstrConfig&&(mstrConfig.debugFlags!==undefined)&&((mstrConfig.debugFlags&4)>0));})();mstrmojo.platform={};mstrmojo.prompt={};mstrmojo.settings={};mstrmojo.models={datasets:{},template:{}};mstrmojo.ui={editors:{controls:{}},menus:{},pathbar:{}};mstrmojo.prefs={};mstrmojo.ACL={};mstrmojo.CMS={};mstrmojo.storage={};mstrmojo.maps={};mstrmojo.maps.androidmap={};mstrmojo.maps.jsmap={};mstrmojo.graph={};mstrmojo.IPA={};mstrmojo.IPA.Monitors={};mstrmojo.IPA.Alerts={};mstrmojo.IPA.Environment={};mstrmojo.IPA.Groups={};mstrmojo.IPA.Heartbeat={};mstrmojo.IPA.Managers={};mstrmojo.sm={};mstrmojo.sort={};mstrmojo.ME={};mstrmojo.architect={ui:{editors:{},panels:{},factories:{}},obj:{},menu:{},projectmanagement:{}};mstrmojo.warehouse={ui:{editors:{}},obj:{},dbroles:{},menu:{}};mstrmojo.plugins={};mstrmojo.gmaps={};mstrmojo.DI={controller:{},model:{},ui:{dialogs:{}}};mstrmojo.Refine={};mstrmojo.qb={bigquery:{},es:{},mdx:{},menu:{},thirdParty:{}};mstrmojo.WH={};mstrmojo.fe={};mstrmojo.txEditor={};mstrmojo.condTx={};mstrmojo.threshold={};mstrmojo.express={ui:{}};mstrmojo.rw={model:{},xtab:{}};mstrmojo.util={ui:{}};mstrmojo.android={controllers:{},factories:{},inputControls:{},large:{controllers:{},factories:{},ui:{}},medium:{controllers:{},factories:{},ui:{nativebar:{}}},selectors:{},ui:{},nativedialog:{}};mstrmojo.vi={controllers:{},factories:{},models:{editors:{}},enums:{},ui:{menus:{},editors:{},rw:{selectors:{},xtab:{}},tabs:{},toolbars:{},tutorial:{}},viz:{},util:{}};mstrmojo.onetier={controllers:{},vi:{acl:{},prefs:{model:{}},ui:{tutorial:{}}}};mstrmojo.config={vi:{},onetier:{}};mstrmojo.chart={common:{},enums:{},model:{enums:{}}};mstrmojo.gm={};mstrmojo.heatmap={vi:{}};mstrmojo.netviz={};mstrmojo.imagelayout={};mstrmojo.iphone={};mstrmojo.winphone={};mstrmojo.mstr={search:{}};mstrmojo.mstr.ui={};mstrmojo.gmaps={};mstrmojo.esrimap={};mstrmojo.examples={};mstrmojo.home={controllers:{},models:{},views:{},ui:{}};mstrmojo.err=function D(H){var G=H.name+': "'+H.message+'"';if(mstrmojo.debug){if(H.fileName){G+=" at\n    "+H.fileName;}if(H.hasOwnProperty("lineNumber")){G+=": "+H.lineNumber;}else{if(H.hasOwnProperty("line")&&H.sourceURL){var F=H.sourceURL.split("/");G+="("+F[F.length>1?F.length-1:0]+":"+H.line+")";}}}this.dbg(G);if(mstrmojo.Dialog){mstrmojo.error({longDesc:H.message},null,{title:H.name});}else{window.alert(G);}};mstrmojo.confirm=function B(F){return window.confirm(F);};mstrmojo.alert=function E(F){window.alert(F);};var C=!!(/return true/.test(String(function(){return true;})));mstrmojo.mixin=function A(J,H){if(J){H=H||{};var I=/this\.\_super/;var G=function(N,M){return function L(){var P=this._super;this._super=M;var O=N.apply(this,arguments||[]);this._super=P;return O;};};var F=J.__onmixin__;if(F){delete J.__onmixin__;}var K;for(K in J){if((typeof J[K]==="function")&&(!C||I.test(J[K]))){H[K]=G(J[K],H[K]);}else{H[K]=J[K];}}if(F){J.__onmixin__=F;}}return H;};}());(function(){var $XHR;var $MISSING={};var getApp=function(){return mstrmojo.global.mstrApp||{};},getJsRoot=function(){return getApp().jsRoot||"../javascript/";},getJsBundlesRoot=function(){return getJsRoot()+"bundles/";},getJsMojoRoot=function(){return getApp().jsMojoRoot||"../javascript/mojo/js/source/";},isIE=!!document.all;function getXHR(){$XHR=self.XMLHttpRequest?new XMLHttpRequest():(self.ActiveXObject?new ActiveXObject("Microsoft.XMLHTTP"):null);}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){if(params.hasOwnProperty(p)){url[++x]=p+"="+encodeURIComponent(params[p]);}}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function syncXHR(method,baseUrl,params){var result=null;method=method.toUpperCase();if(!$XHR){getXHR();}if($XHR){try{var m=null,app=window.mstrApp;if(window.microstrategy!==undefined&&microstrategy){m=microstrategy;}params.taskContentType=params.taskContentType||"json";params.taskEnv="xhr";params.xts=mstrmojo.now();params=mstrmojo.addCSRFTokenToTaskParams(params);var ptp=(app&&app.persistTaskParams)||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}$XHR.open(method,appendUrlParams(method,baseUrl,params),false);if(method!=="POST"){params=null;}else{params=encodeParams(params);$XHR.setRequestHeader("Content-type","application/x-www-form-urlencoded");}$XHR.send(params);result=$XHR.responseText||null;}catch(localerr){if(window.console){window.console.log(localerr);}}}return result;}function _jsGet(file,nullCheck){var js=mstrmojo.loadFileSync(file);if(js){try{eval(js);return nullCheck?!!eval(nullCheck):true;}catch(localerr){window.alert("JavaScript compile error:\n\nFile: "+file+"\n\nError: "+localerr.message);}}return false;}mstrmojo.requiresBundle=function reqBundle(bundleName){return _jsGet(getJsBundlesRoot()+bundleName);};mstrmojo.loadFileSync=function loadFileSync(file){var result=null;if(!$XHR){getXHR();}if($XHR){try{$XHR.open("GET",file+((window.mstrConfig&&mstrConfig.webVersion)?"?v="+mstrConfig.webVersion:""),false);$XHR.send(null);result=$XHR.responseText||null;}catch(localerr){}if(!isIE&&$XHR.abort){$XHR.abort();}}return result;};mstrmojo.insertCSSLinks=function insertCSSLinks(files){var css,firsthead;if(files&&files.length>0){firsthead=document.getElementsByTagName("head")[0];files.forEach(function(file){css=document.createElement("link");css.setAttribute("id",file.replace(/[^a-zA-Z0-9]/g,""));css.setAttribute("rel","stylesheet");css.setAttribute("type","text/css");css.setAttribute("href",file);firsthead.appendChild(css);});}};mstrmojo.loader={loaded:{mstrmojo:true,"mstrmojo.loader":true},isLoaded:function isLd(fqcn){var o;try{o=eval(fqcn);}catch(localerr){}if(o){this.loaded[fqcn]=true;}return !!o;},load:function ld(fqcn){if($MISSING[fqcn]){return false;}if(this.loaded[fqcn]||this.isLoaded(fqcn)){return true;}if(_jsGet(this.fqcnToFile(fqcn),fqcn)){this.loaded[fqcn]=true;return true;}$MISSING[fqcn]=true;return false;},fqcnToFile:function fqcnToFile(fqcn){if(fqcn.match(/^mstrmojo\.plugins\./)){var pluginName=fqcn.substring(17,fqcn.indexOf(".",17));fqcn="../plugins/"+pluginName+"/javascript/"+getJsMojoRoot()+fqcn.replace("mstrmojo.plugins."+pluginName+".","").replace(/\./gm,"/");}else{if(fqcn.match(/^mstrmojo\./)){fqcn=getJsMojoRoot()+fqcn.replace("mstrmojo.","").replace(/\./gm,"/");}else{fqcn=getJsRoot()+fqcn.replace(/\./gm,"/");}}return fqcn+".js";}};var $LOADER=mstrmojo.loader,isLoaded=$LOADER.loaded;var reqCache={},addPackagesToReqCache=function addPkg(n,ns){var ps=n.split("."),klen=ps.length,k;for(k=1;k<klen;k++){var s=ps.slice(0,k).join(".");if(!reqCache[s]){ns.push(s);reqCache[s]=true;}}},loadInputScripts=function loadInputScripts(ns){var jlen=ns.length,j;for(j=0;j<jlen;j++){if(!$LOADER.load(ns[j])){window.alert("Warning: Javascript class not found:\n"+ns[j]);break;}}};mstrmojo.requiresCls=function reqCls(){var argLen=arguments.length,ns=[],i,len;for(i=0,len=argLen;i<len;i++){var n=arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){addPackagesToReqCache(n,ns);}ns.push(n);reqCache[n]=true;}loadInputScripts(ns);return true;};mstrmojo.requiresClsP=function reqClsP(){var argLen=arguments.length,ns=[],pkgName=arguments[0],i,len;addPackagesToReqCache(pkgName,ns);for(i=1,len=argLen;i<len;i++){var n=pkgName+"."+arguments[i];if(!n||isLoaded[n]||$MISSING[n]){continue;}else{if(reqCache[n]){loadInputScripts([n]);reqCache[n]=false;continue;}}if(!n.match(/^mstrmojo\.plugins\./)){ns.push(n);reqCache[n]=true;}}loadInputScripts(ns);return true;};var $DESCRIPTORS=mstrmojo.descriptors,descPrefix="mstrWeb.";function populateDescriptors(ds){if(ds){var dlen=ds.length,di;for(di=0;di<dlen;di++){var d=ds[di];$DESCRIPTORS[d.key]=d.v;}}}mstrmojo.populateDescriptors=populateDescriptors;if(window.mstrConfig!==undefined){populateDescriptors(mstrConfig.mstrDescs&&mstrConfig.mstrDescs.descriptors);mstrConfig.mstrDescs=null;}if(window.mstrApp!==undefined){populateDescriptors(mstrApp.mstrDescs&&mstrApp.mstrDescs.descriptors);}var requestDescriptor=function(prefix,ids){var ns=[],len=ids.length,i;for(i=0;i<len;i++){var k=ids[i];if(k&&!($DESCRIPTORS.hasOwnProperty(prefix+k))){ns.push(k);}}if(ns.length>0){var response=syncXHR("POST",(window.mstrConfig&&mstrConfig.taskURL)||"taskProc",{taskId:"getDescriptors",keys:ns.join(","),prefix:prefix});if(response){var r=eval("("+response+")");populateDescriptors(r&&r.descriptors);}}};mstrmojo.requiresDescsWPrefix=function reqDescP(prefix){var args=[].slice.call(arguments);args[0]=null;requestDescriptor(prefix,args);};mstrmojo.requiresDescs=function reqDesc(){if(window.mstrConfig!==undefined&&!mstrConfig.onMobileDevice){requestDescriptor(descPrefix,arguments);}};mstrmojo.desc=function desc(descID,defText){if(descID!==null&&descID!==undefined){mstrmojo.requiresDescs(descID);if($DESCRIPTORS.hasOwnProperty(descPrefix+descID)){return $DESCRIPTORS[descPrefix+descID];}defText=defText||"No string descriptor found for descID="+descID;}var decDefText="["+defText+"]";$DESCRIPTORS[descPrefix+descID]=decDefText;return decDefText;};mstrmojo.descP=function descP(prefix,descID,defText){mstrmojo.requiresDescsWPrefix(prefix,descID);if($DESCRIPTORS.hasOwnProperty(prefix+descID)){return $DESCRIPTORS[prefix+descID];}defText=defText||"No string descriptor found for descID="+descID;var decDefText="*"+defText+"*";$DESCRIPTORS[prefix+descID]=decDefText;return decDefText;};mstrmojo.provide=function prv(fqcn,cls){isLoaded[fqcn]=!!cls;return cls;};mstrmojo.invalidateCls=function rel(fqcn){reqCache[fqcn]=false;isLoaded[fqcn]=false;eval(fqcn+" = null");};var mx=mstrmojo.mixin;mstrmojo.declare=function declare(SuperCls,mixins,config){function Constr(props){if((!props||!props.dontInit)&&this.init){this.init(props);}}if(SuperCls){Constr.prototype=new SuperCls({dontInit:true});Constr.prototype.constructor=Constr;}var proto=Constr.prototype;var cnt=(mixins&&mixins.length)||0,i;for(i=0;i<cnt;i++){mx(mixins[i],proto);}if(config){mx(config,proto);if(config.scriptClass){isLoaded[config.scriptClass]=true;}}return Constr;};mstrmojo.findAncestor=function findAncestor(src,property,value,limitClass){var ancestor=src&&src.parent;while(ancestor&&(!limitClass||!(ancestor instanceof limitClass))){var targetProperty=ancestor[property];if(targetProperty!==undefined){if(value!==undefined&&value!==null){if(targetProperty===value){return ancestor;}}else{return ancestor;}}ancestor=ancestor.parent;}return null;};mstrmojo.isDescendant=function isDescendant(parent,child){var ancestor;if(!child||!parent){return false;}ancestor=child.parent;while(ancestor){if(ancestor===parent){return true;}ancestor=ancestor.parent;}return false;};mstrmojo.getCSRFToken=function getCSRFToken(url){var tkn=null;try{if(url){if(url.indexOf("validateRandNum=")>=0){return tkn;}if(this.isUrlExternal(url)){return tkn;}}if(window.mstrApp&&mstrApp.validateRandNum){tkn=mstrApp.validateRandNum;}else{if(window.mstrConfig&&mstrConfig.validateRandNum){tkn=mstrConfig.validateRandNum;}else{if(window.microstrategy!==undefined&&microstrategy&&microstrategy.validateRandNum){tkn=microstrategy.validateRandNum;}}}}catch(err){}return tkn;};mstrmojo.addCSRFTokenToURL=function addCSRFTknToURL(url){if(!url){return"";}var tkn=mstrmojo.getCSRFToken(url);if(tkn&&tkn.length>0){if(url.indexOf("?")>-1){url+="&";}else{url+="?";}url+="validateRandNum="+tkn;}return url;};mstrmojo.addCSRFTokenToTaskParams=function addCSRFTknToTaskParams(params){if(params){var tkn=mstrmojo.getCSRFToken();if(tkn&&tkn.length>0){params.validateRandNum=tkn;}}return params;};mstrmojo.getInstance=function getInstance(config){var Clazz=mstrmojo.hash.walk(config.scriptClass,window);if(Clazz){return new Clazz(config);}return null;};mstrmojo.isUrlExternal=function isUrlExternal(url){var curURL=window.location.href;var servletName=window.mstrApp&&mstrApp.name,taskProcName=window.mstrConfig.taskURL&&mstrConfig.taskURL,isSameWebApp=(url.indexOf("?")===0||url.indexOf(servletName)===0||url.indexOf("./"+servletName)===0||url.indexOf(taskProcName)===0||url.indexOf("./"+taskProcName)===0||url.indexOf(curURL)===0||((curURL.indexOf("?")>0)&&(url.indexOf(curURL.substring(0,curURL.indexOf("?")))===0)));return !isSameWebApp;};mstrmojo.resolveFeature=function resolveFeature(feature){var features=mstrApp.features;return features&&features[feature];};mstrmojo.getStyleRoot=function getStyleRoot(){var c=mstrConfig||{},styleRoot=c.styleRoot||"../style";return styleRoot;};}());var isIE=(navigator.appVersion.indexOf("MSIE")!=-1)?true:false;var isWin=(navigator.appVersion.toLowerCase().indexOf("win")!=-1)?true:false;var isOpera=(navigator.userAgent.indexOf("Opera")!=-1)?true:false;function ControlVersion(){var A;var B;var C;try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");A=B.GetVariable("$version");}catch(C){}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");A="WIN 6,0,21,0";B.AllowScriptAccess="always";A=B.GetVariable("$version");}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A=B.GetVariable("$version");}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.3");A="WIN 3,0,18,0";}catch(C){}}if(!A){try{B=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");A="WIN 2,0,0,11";}catch(C){A=-1;}}return A;}function GetSwfVer(){var G=-1;if(navigator.plugins!=null&&navigator.plugins.length>0){if(navigator.plugins["Shockwave Flash 2.0"]||navigator.plugins["Shockwave Flash"]){var F=navigator.plugins["Shockwave Flash 2.0"]?" 2.0":"";var A=navigator.plugins["Shockwave Flash"+F].description;var E=A.split(" ");var C=E[2].split(".");var H=C[0];var B=C[1];if(E[3]!=""){tempArrayMinor=E[3].split("r");}else{tempArrayMinor=E[4].split("r");}var D=tempArrayMinor[1]>0?tempArrayMinor[1]:0;var G=H+"."+B+"."+D;}}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.6")!=-1){G=4;}else{if(navigator.userAgent.toLowerCase().indexOf("webtv/2.5")!=-1){G=3;}else{if(navigator.userAgent.toLowerCase().indexOf("webtv")!=-1){G=2;}else{if(isIE&&isWin&&!isOpera){G=ControlVersion();}}}}}return G;}function DetectFlashVer(F,D,C){versionStr=GetSwfVer();if(versionStr==-1){return false;}else{if(versionStr!=0){if(isIE&&isWin&&!isOpera&&(versionStr.indexOf(" ")!=-1)){tempArray=versionStr.split(" ");tempString=tempArray[1];versionArray=tempString.split(",");}else{versionArray=versionStr.split(".");}var E=versionArray[0];var A=versionArray[1];var B=versionArray[2];if(E>parseFloat(F)){return true;}else{if(E==parseFloat(F)){if(A>parseFloat(D)){return true;}else{if(A==parseFloat(D)){if(B>=parseFloat(C)){return true;}}}}}return false;}}}function AC_AddExtension(B,A){if(B.indexOf("?")!=-1){return B.replace(/\?/,A+"?");}else{return B+A;}}function AC_Generateobj(F,E,A,D){var C="";if(isIE&&isWin&&!isOpera){C+="<object ";for(var B in F){C+=B+'="'+F[B]+'" ';}for(var B in E){C+='><param name="'+B+'" value="'+E[B]+'" /> ';}C+="></object>";}else{C+="<embed ";for(var B in A){C+=B+'="'+A[B]+'" ';}C+="> </embed>";}if(typeof (D)!="undefined"){var G=(typeof D=="string")?document.getElementById(D):D;G.innerHTML=C;}else{document.write(C);}}function AC_FL_RunContent(){var B=".swf";if(typeof (microstrategy)!="undefined"){B+="?"+microstrategy.getVersion();}else{if(typeof (mstrmojo)!="undefined"&&mstrmojo.App){B+="?"+mstrmojo.App.getVersion();}}var A=AC_GetArgs(arguments,B,"movie","clsid:d27cdb6e-ae6d-11cf-96b8-444553540000","application/x-shockwave-flash");AC_Generateobj(A.objAttrs,A.params,A.embedAttrs,A.parentDiv);}function AC_GetArgs(B,E,G,D,H){var A=new Object();A.embedAttrs=new Object();A.params=new Object();A.objAttrs=new Object();for(var C=0;C<B.length;C=C+2){var F=B[C].toLowerCase();switch(F){case"classid":break;case"parentdiv":A.parentDiv=B[C+1];case"pluginspage":A.embedAttrs[B[C]]=B[C+1];break;case"src":case"movie":B[C+1]=AC_AddExtension(B[C+1],E);A.embedAttrs.src=B[C+1];A.params[G]=B[C+1];break;case"onafterupdate":case"onbeforeupdate":case"onblur":case"oncellchange":case"onclick":case"ondblClick":case"ondrag":case"ondragend":case"ondragenter":case"ondragleave":case"ondragover":case"ondrop":case"onfinish":case"onfocus":case"onhelp":case"onmousedown":case"onmouseup":case"onmouseover":case"onmousemove":case"onmouseout":case"onkeypress":case"onkeydown":case"onkeyup":case"onload":case"onlosecapture":case"onpropertychange":case"onreadystatechange":case"onrowsdelete":case"onrowenter":case"onrowexit":case"onrowsinserted":case"onstart":case"onscroll":case"onbeforeeditfocus":case"onactivate":case"onbeforedeactivate":case"ondeactivate":case"type":case"codebase":case"id":A.objAttrs[B[C]]=B[C+1];break;case"width":case"height":case"align":case"vspace":case"hspace":case"class":case"title":case"accesskey":case"name":case"tabindex":A.embedAttrs[B[C]]=A.objAttrs[B[C]]=B[C+1];break;default:A.embedAttrs[B[C]]=A.params[B[C]]=B[C+1];}}A.objAttrs.classid=D;if(H){A.embedAttrs.type=H;}return A;}AC_OETagsObj.prototype=new Object();function AC_OETagsObj(){}mstrmojo.mstr.EnumFunction={FunctionCustom:-1,FunctionReserved:0,FunctionPlus:1,FunctionMinus:2,FunctionTimes:3,FunctionDivide:4,FunctionUnaryMinus:5,FunctionEquals:6,FunctionNotEqual:7,FunctionGreater:8,FunctionLess:9,FunctionGreaterEqual:10,FunctionLessEqual:11,FunctionSum:12,FunctionCount:13,FunctionAvg:14,FunctionMin:15,FunctionMax:16,FunctionBetween:17,FunctionLike:18,FunctionAnd:19,FunctionOr:20,FunctionNot:21,FunctionIn:22,FunctionRank:23,FunctionAbs:24,FunctionRunningSum:25,FunctionRunningAvg:26,FunctionMovingSum:28,FunctionMovingAvg:27,FunctionProduct:29,FunctionMedian:30,FunctionMode:31,FunctionStdev:32,FunctionVar:33,FunctionGeomean:34,FunctionEqualEnhanced:35,FunctionNotEqualEnhanced:36,FunctionGreaterEqualEnhanced:37,FunctionLessEqualEnhanced:38,FunctionBetweenEnhanced:39,FunctionBanding:40,FunctionBandingC:41,FunctionBandingP:42,FunctionNotLike:43,FunctionNotBetween:44,FunctionIntersect:45,FunctionIntersectIn:46,FunctionNullToZero:47,FunctionZeroToNull:48,FunctionApplySimple:49,FunctionApplyAggregation:50,FunctionApplyLogic:51,FunctionApplyComparison:52,FunctionApplyRelative:53,FunctionIsNull:54,FunctionIsNotNull:55,FunctionUcase:56,FunctionNotIn:57,FunctionNTile:58,FunctionPercentile:59,FunctionMovingMax:60,FunctionMovingMin:61,FunctionMovingDifference:62,FunctionMovingStdev:63,FunctionExpWghMovingAvg:64,FunctionMovingCount:65,FunctionRunningMax:66,FunctionRunningMin:67,FunctionRunningStdev:68,FunctionRunningCount:69,FunctionExpWghRunningAvg:70,FunctionNotBetweenEnhanced:71,FunctionConcat:72,FunctionFirstInRange:73,FunctionLastInRange:74,FunctionValueSegment:75,FunctionContains:76,FunctionBeginsWith:77,FunctionEndsWith:78,FunctionNotContains:79,FunctionNotBeginsWith:80,FunctionNotEndsWith:81,FunctionCase:82,FunctionCaseV:83,FunctionStdevP:84,FunctionRunningStdevP:85,FunctionMovingStdevP:86,FunctionNTileS:87,FunctionNTileVS:88,FunctionVarP:89,FunctionCurrentDate:90,FunctionDayOfMonth:91,FunctionDayOfWeek:92,FunctionDayOfYear:93,FunctionWeek:94,FunctionMonth:95,FunctionQuarter:96,FunctionYear:97,FunctionCurrentDateTime:98,FunctionCurrentTime:99,FunctionHour:100,FunctionMinute:101,FunctionSecond:102,FunctionMilliSecond:103,FunctionConcatNoBlank:104,FunctionLength:105,FunctionLower:106,FunctionLTrim:107,FunctionPosition:108,FunctionRTrim:109,FunctionSubStr:110,FunctionInitCap:111,FunctionTrim:112,FunctionRightStr:113,FunctionLeftStr:114,FunctionGreatest:115,FunctionLeast:116,FunctionFirst:117,FunctionLast:118,FunctionAdd:134,FunctionAverage:135,FunctionMultiply:136,FunctionBandingM:137,FunctionOLAPSum:138,FunctionOLAPAvg:139,FunctionOLAPCount:140,FunctionOLAPMax:141,FunctionOLAPMin:142,FunctionLag:143,FunctionLead:144,FunctionPercentRank:166,FunctionTuple:1000};(function(){mstrmojo.models.template.Title=mstrmojo.declare(null,null,{init:function G(J){this.title=J.title;},getActionType:function(){return this.title.at;},getDrillPath:function(){return this.title.dp;},getHeaderValues:function B(){return this.title.es;},getHeaderName:function F(J){return this.title.es[J].n;},getHeaderId:function F(J){return this.title.es[J].id;},getForms:function E(){return this.title.fs;},getFormId:function D(){return this.title.fid;},getFormType:function I(){return this.title.ftp;},getUnitId:function H(){return this.title.id;},getLinkMap:function C(){return this.title.lm;},getName:function A(){return this.title.n;},getUnitDssType:function(){return this.title.otp;},getSelectorControl:function(){return this.title.sc;}});}());(function(){var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",G=String.fromCharCode;function D(H){H=H.replace(/\r\n/g,"\n");var I="";for(var K=0;K<H.length;K++){var J=H.charCodeAt(K);if(J<128){I+=G(J);}else{if((J>127)&&(J<2048)){I+=G((J>>6)|192);I+=G((J&63)|128);}else{I+=G((J>>12)|224);I+=G(((J>>6)&63)|128);I+=G((J&63)|128);}}}return I;}function F(L){var H="",J=0,M=0,K=0,I=0;while(J<L.length){M=L.charCodeAt(J);if(M<128){H+=G(M);J++;}else{if((M>191)&&(M<224)){K=L.charCodeAt(J+1);H+=G(((M&31)<<6)|(K&63));J+=2;}else{K=L.charCodeAt(J+1);I=L.charCodeAt(J+2);H+=G(((M&15)<<12)|((K&63)<<6)|(I&63));J+=3;}}}return H;}mstrmojo.base64=mstrmojo.provide("mstrmojo.base64",{decodeHttpHeader:function E(K){var I=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(K&&K.indexOf("=?UTF-8?B?")===0){var J="",H;while((H=I.exec(K))!==null){J+=mstrmojo.base64.decode(H[1]);}return J;}return K;},encode:function B(J){var H="";var Q,O,M,P,N,L,K;var I=0;J=D(J);while(I<J.length){Q=J.charCodeAt(I++);O=J.charCodeAt(I++);M=J.charCodeAt(I++);P=Q>>2;N=((Q&3)<<4)|(O>>4);L=((O&15)<<2)|(M>>6);K=M&63;if(isNaN(O)){L=K=64;}else{if(isNaN(M)){K=64;}}H+=A.charAt(P)+A.charAt(N)+A.charAt(L)+A.charAt(K);}return H;},decode:function C(J){var H="",I=0;var Q,O,M,P,N,L,K;J=J.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(I<J.length){P=A.indexOf(J.charAt(I++));N=A.indexOf(J.charAt(I++));L=A.indexOf(J.charAt(I++));K=A.indexOf(J.charAt(I++));Q=(P<<2)|(N>>4);O=((N&15)<<4)|(L>>2);M=((L&3)<<6)|K;H+=G(Q);if(L!==64){H+=G(O);}if(K!==64){H+=G(M);}}H=F(H);return H;}});})();(function(){function G(O,U,T,Q,S,P,R){if(U>P){return false;}return(!R)||(O===0)||((O<Q)&&(U>=S-(P-S)));}function M(R,O,V,U,Q,T,P,S){if(V>P){return false;}return(!S)||((O<Q)&&(V>=T-R.getHeight()));}function N(O,Q,P){O.renderMode="scroll";O.render();O.numChildrenRendered=0;Q.numChildrenRendered++;if(P&&!O.builtChildren){O.buildChildren();}}function E(){return this.useScrollBuffer?this.scrollBuffer:0;}mstrmojo._CanRenderDocOnScroll=mstrmojo.provide("mstrmojo._CanRenderDocOnScroll",{_mixinName:"mstrmojo._CanRenderDocOnScroll",renderMode:"scroll",scrollBuffer:0,preBuildRendering:function K(){if(!!mstrApp.features["ignore-incremental-rendering"]){this.renderMode=null;}if(this._super){this._super();}},postBuildRendering:function B(){if(this.renderMode===null){return this._super();}this.renderChildren();return true;},childRenderOnAddCheck:function(O){if(this.renderMode===null){return this._super(O);}return false;},renderChildren:function L(){var P;if(this.renderMode==="scroll"){var Q=this;while(Q){if(Q.scrollboxNode&&(Q.scrollboxWidthFixed||Q.scrollboxHeightFixed)&&Q.connectScrollbox){P=Q;break;}Q=Q.parent;}}if((this.renderMode!=="scroll")||!P){this._super();return ;}if(this.containerNode){this.scrollboxOwner=P;P.connectScrollbox(this);this.numChildrenRendered=0;var O=this.numChildren;if(O===undefined){this.numChildren=O=this._getModelChildNodes(this.node,false,0,0,true).total;}this.sectionsToRender=O;this.subsectionsToRender=0;if(O){this._startSubsectionThread(false);}}if(this.resizeOrReposition){this.resizeOrReposition();}},onscroll:function I(){if(!this.renderingSubsections){this.useScrollBuffer=true;this._startSubsectionThread(true);}},_startSubsectionThread:function A(R){var P=this;var Q=function(T,S){if(P[T]){if(S){self.clearTimeout(P[T]);}else{self.clearInterval(P[T]);}delete P[T];}};var O=function(T){P.renderingSubsections=false;var S=function(){Q("renderCtlsTimer");P.showRenderStatus(false);P.renderCtrlsInViewport();P.raiseEvent({name:"afterScroll"});P=null;};if(T){P.renderCtlsTimer=self.setTimeout(S,P.scrollboxOwner.scrollInterval+1);}else{S();}};Q("renderSubsTimer");Q("renderCtlsTimer",true);this.renderingSubsections=true;if((this.sectionsToRender||this.subsectionsToRender)&&!this._renderSubsectionsToScroll()){this.showRenderStatus(true);this.renderSubsTimer=self.setInterval(function(){if(P._renderSubsectionsToScroll()){Q("renderSubsTimer");O(R);}else{P.showRenderStatus(true);}},this.scrollboxOwner.scrollInterval);}else{O(R);}},showRenderStatus:function F(P,U){var T=this.parent;if(!T||!T.showStatus){return ;}var O=U,Q;if(P){var R=this.numChildrenRendered,S=this.numChildren;Q=S&&parseInt(100*R/S,10);O="*Rendering section "+R+" of "+S+".*";}T.showStatus(P,O,Q);},_renderSubsectionsToScroll:function J(){var Z=this.scrollboxOwner,a=Z.scrollboxTop,R=Z.scrollboxLeft,U=Z.scrollboxBottom+E.call(this),m=Z.scrollboxRight,b=U-a,X=0,W=0,V=null,c=null,Y,h;U+=1;function j(){V=W;c=V+b;}var O=this.numChildren,T=this.children||[],Q=this.model,f=this.node,e=false;for(h=0;h<O;h++){var l=T[h];if(!l){l=this.addChildren(this.builder.build(this._getModelChildNodes(f,false,h,1,true).nodes,Q))[0];T=this.children||[];}var P=e;e=!!l.defn.horiz;Y=(h>0&&l.node.data.bh);if((!e&&P)||(Y&&P)){X=0;W+=T[h-1].getHeight();if(W>U){return true;}if((c!==null)&&(W>c)){return false;}}if(!l.hasRendered){if(!G(X,W,R,m,a,U,e)){if(e){continue;}else{return true;}}this._renderSection(l,h);this.sectionsToRender--;this.subsectionsToRender+=(l.children&&l.children.length)||0;if(V===null){j();}}var S=l.children||[],g=null,d,k;for(d=0,k=S.length;d<k;d++){g=S[d];if(!g.hasRendered){if(!M(g,X,W,R,m,a,U,e)){if(e){break;}else{return true;}}N(g,l);this.subsectionsToRender--;if(V===null){j();}}if(e){X+=g.getWidth();if(X>m){break;}}else{W+=g.getHeight();if(W>U){return true;}if((c!==null)&&(W>c)){return false;}}}}return true;},_renderSection:function H(O,P){N(O,this,true);},_getModelChildNodes:function(Q,P,S,O,R){return this.model.getChildren(Q,P,S,O,R);},renderCtrlsInViewport:function D(){var X=this.scrollboxOwner,Z=X.scrollboxTop,P=X.scrollboxLeft,S=X.scrollboxBottom+E.call(this),n=X.scrollboxRight,U=0,T=0,e=false,R=this.children||[],O,V,h,Y;var d=function(c){if(e){U+=c.getWidth();}else{T+=c.getHeight();}};var l=function(u,c,t,w,r){var q=parseInt(c,10)||0,v=parseInt(t,10);return(isNaN(v))?(u+q<=r):mstrmojo.boxmodel.rangeIntersect(u+q,u+q+v,w,r);};for(h=0,Y=(R&&R.length)||0;h<Y;h++){var o=R[h];O=e;e=!!o.defn.horiz;V=(h>0&&o.node.data.bh);if((!e&&O)||(V&&O)){U=0;T+=R[h-1].getHeight();if(T>S){return ;}}if(!o.hasRendered){if(!e){return ;}continue;}var k=o.children,Q=(k&&k.length)||0,b,g;for(b=0;b<Q;b++){g=k[b];if(!g.hasRendered){break;}if(g.builtChildren&&(g.numChildrenRendered===((g.children&&g.children.length)||0))){d(g);}else{if((T+g.getHeight()>=Z)&&(!e||(U+g.getWidth()>=P))){var p=g.children,a=(p&&p.length)||0;if(!a&&!g.builtChildren){g.buildChildren();p=g.children;a=(p&&p.length)||0;}var f=[],j;for(j=0;j<a;j++){var m=p[j];if(m.hasRendered){continue;}var W=m.getFormats()||{};if(l(T,W.top,W.height,Z,S)&&l(U,W.left,W.width,P,n)){m.render();f.push(m);}}g.performCanGrowCanShrink(f,true);}d(g);}if((e&&U>n)||(!e&&T>S)){break;}}}},unrender:function C(P){var O=this.scrollboxOwner;if(O){O.disconnectScrollbox(this);}this._super(P);}});}());mstrmojo.mstr.EnumDataType={DataTypeUnknown:-1,DataTypeReserved:0,DataTypeInteger:1,DataTypeUnsigned:2,DataTypeNumeric:3,DataTypeDecimal:4,DataTypeReal:5,DataTypeDouble:6,DataTypeFloat:7,DataTypeChar:8,DataTypeVarChar:9,DataTypeLongVarChar:10,DataTypeBinary:11,DataTypeVarBin:12,DataTypeLongVarBin:13,DataTypeDate:14,DataTypeTime:15,DataTypeTimeStamp:16,DataTypeShort:21,DataTypeLong:22,DataTypeMBChar:23,DataTypeBool:24,DataTypePattern:25,DataTypeBigDecimal:30,DataTypeCellFormatData:31,DataTypeInt64:34};(function(){mstrmojo.FlexHelper=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.FlexHelper",getWidget:function C(D){var E=D.split("x");return mstrApp.docModel.getUnitInstance(E[0],E[1]);},getZoomFactor:function A(){return mstrApp.docModel.getZoomFactor()*100;}});var B=new mstrmojo.FlexHelper();window.getFlexHelper=function(){return B;};})();(function(){mstrmojo.boxmodel=mstrmojo.provide("mstrmojo.boxmodel",{rangeIntersect:function E(J,H,I,G){if(J<I){return I<=H;}if(J>I){return J<=G;}return true;},px2Inches:function C(H,G){G=parseInt(G,10);return mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep).format(parseFloat((G/H.zf/H.dpi).toFixed(4)));},offset:function F(I,H){var L=I,G=0,K=0;while(I){G+=I.offsetLeft;K+=I.offsetTop;I=I.offsetParent;if(I===H){break;}}var J;for(J=L&&L.parentNode;J&&J!==H;J=J.parentNode){if(J.scrollTop){K-=J.scrollTop;}if(J.scrollLeft){G-=J.scrollLeft;}}return{left:G,top:K};},convert2px:function D(K,I){if(!/px$/.test(I)){var H=document.createElement("img"),G=H.style,J;G.zIndex=-1;G.left=I;K.appendChild(H);J=G.pixelLeft;K.removeChild(H);return J+"px";}return I;},getEdgeQuadrantByPoint:function B(I,H){var G=H.x-I.x,M=H.y-I.y,J=I.w,L=I.h,K=[["Left","Bottom"],["Top","Right"]];if(M>L/J*G){K=K[0];}else{K=K[1];}return(M<-L/J*G+L)?K[0]:K[1];},isPtInPolygon:function A(I,K){var G=I.x,J=I.y,H=false;K.forEach(function(N,L){var M=K[L-1]||K[K.length-1];if((N.y>=J)!==(M.y>=J)){if((G<(M.x-N.x)*(J-N.y)/(M.y-N.y)+N.x)){H=!H;}}});return H;}});}());(function(){function X(a){var b=[].slice.call(a),c=b[b.length-1],d=function(f,e){return f===e;};if(/function|string/.test(typeof c)){d=typeof c==="function"?c:function(f,e){return f[c]===e[c];};b=b.slice(0,b.length-1);}return{sets:b,compareFunc:d};}mstrmojo.array=mstrmojo.provide("mstrmojo.array",{indexOf:function D(b,d){var a=(b&&b.length)||0,c;for(c=0;c<a;c++){if(b[c]==d){return c;}}return -1;},indexOfMulti:function T(a,b){var f=[],e={},d=0,c=this;c.forEach(a,function(h,g){c.forEach(b,function(j,k){var l=(j===h);if(l){f[k]=e[k]=g;d++;}return !l;});});return{indices:f.length?f:null,map:e,count:d};},forEach:function R(b,g,d){var a=(b&&b.length)||0,c;for(c=0;c<a;c++){var e=c===(a-1);if(d){if(g.call(d,b[c],c,b,e)===false){break;}}else{if(g(b[c],c,b,e)===false){break;}}}return b;},map:function Y(b,e){var a=(b&&b.length)||0,c=[],d;for(d=0;d<a;d++){c[d]=e(b[d],d);}return c;},filter:function I(c,d,e){var h=[],g=0,b=(c&&c.length)||0,a=(e&&e.max)||0,f;for(f=0;f<b;f++){if(d(c[f],f,c)){h[g]=c[f];g++;if(a&&g>=a){break;}}}return h;},filterOne:function L(a,b){var c=this.filter(a,b,{max:1});if(c.length){return c[0];}return null;},ensureArray:function P(a){return[].concat(a||[]);},find:function M(b,f,c){var a=(b&&b.length)||0,d;for(d=0;d<a;d++){var e=b[d];if(e&&e[f]==c){return d;}}return -1;},distinct:function B(b,f){if(b.reduce&&!f){return b.reduce(function(h,g){if(h.indexOf(g)<0){h.push(g);}return h;},[]);}var a=(b&&b.length)||0,c,e,d=[];for(c=0;c<a;c++){e=b[c];if((e!==undefined)&&((f&&this.find(d,f,e[f])<0)||(!f&&this.indexOf(d,e)<0))){d.push(e);}}return d;},findBin:function E(c,g,j,b){var f=(b||c.length)-1,d=0,a,e=g[j];while(f-d>1){if(c[a=f+d>>1][j]<e){d=a;}else{f=a;}}if(c[d][j]===e){return d;}return c[f][j]===e?f:-1;},search:function H(j,d,f){var e=j.length,c=-1,b,g=d.toUpperCase(),a=d.length;while(e-c>1){if(j[b=e+c>>1][f].substr(0,a).toUpperCase()<g){c=b;}else{e=b;}}return e;},findMulti:function Q(h,d,m){if(!m){return{indices:null,map:{},count:0};}var l=m.length,q=[],b={},o=0,f=(h&&h.length)||0,g;for(g=0;g<f;g++){var p=h[g][d],e;for(e=0;e<l;e++){if(m[e][d]===p){q[e]=g;b[e]=g;o++;break;}}}return{indices:q,map:b,count:o};},removeItem:function W(a,c){var b=this.indexOf(a,c);if(b>-1){this.removeIndices(a,b,1);}return b;},removeItems:function N(a,f,b){var c=this.findMulti(a,f,b);if(c.count){var e=c.indices.concat().sort(this.numSorter).slice(0,c.count),d;for(d=e.length-1;d>-1;d--){a.splice(e[d],1);}}},numSorter:function Z(d,c){return Number(d)-Number(c);},stringSorter:function J(e,d){var c=e.toLowerCase(),f=d.toLowerCase();if(c<f){return -1;}if(c>f){return 1;}return 0;},removeIndices:function O(a,c,b){a.splice(c,b);},insert:function F(b,a,c){if(!b){b=[];}if(a===null||a===undefined){a=b.length;}Array.prototype.splice.apply(b,[a,0].concat(c));return b;},hash:function C(b,d){d=d||{};var a=(b&&b.length)||0,c;for(c=0;c<a;c++){d[b[c]]=true;}return d;},get:function U(b,e){if(!e){return null;}var c=[],a=e.length,d;for(d=0;d<a;d++){c[d]=b[e[d]];}return c;},deepSortArr:function G(b,d,a,c){return b.sort(function(g,e){var h=g[a][d],f=e[a][d];if(!c){return(h<=f);}return(h>f)?-1:1;});},isArray:function(a){var b=Array.isArray;if(b){return b(a);}return Object.prototype.toString.call(a)==="[object Array]";},some:function K(b,c){if(!b){return false;}if(b.some){return b.some(c);}var a=false;this.forEach(b,function(e,d){a=c(e,d,b);return !a;});return a;},difference:function V(){if(arguments.length<2){throw new Error("difference should get at least 2 parameters");}var d=X(arguments),b=d.sets,c=d.compareFunc,e=b[0],a=[].concat.apply([],b.slice(1));return e.filter(function(f){return !a.some(function(g){return c(f,g);});});},intersection:function S(){if(arguments.length<2){throw new Error("intersection should get at least 2 parameters");}var e=X(arguments),c=e.sets,d=e.compareFunc,a=c[0],b=c.slice(1);b.forEach(function(f){a=a.filter(function(g){return f.some(function(h){return d(g,h);});});});return a;},fnReduceNumber:function A(a,b){return a+b;}});}());mstrmojo.chart.model.enums.EnumDSSObjectType={DssTypeUnknown:-1,DssTypeReserved:0,DssTypeGeneric:5,DssTypeFormatBAD:46,DssTypeFilter:1,DssTypeTemplate:2,DssTypeReportDefinition:3,DssTypeMetric:4,DssTypeStyle:6,DssTypeAggMetric:7,DssTypeFolder:8,DssTypeDevice:9,DssTypePrompt:10,DssTypeFunction:11,DssTypeAttribute:12,DssTypeFact:13,DssTypeDimension:14,DssTypeTable:15,DssTypeDatamartReport:16,DssTypeFactGroup:17,DssTypeShortcut:18,DssTypeResolution:19,DssTypeMonitor:20,DssTypeAttributeForm:21,DssTypeSchema:22,DssTypeFormat:23,DssTypeCatalog:24,DssTypeCatalogDefn:25,DssTypeColumn:26,DssTypePropertyGroup:27,DssTypePropertySet:28,DssTypeDBRole:29,DssTypeDBLogin:30,DssTypeDBConnection:31,DssTypeProject:32,DssTypeServerDef:33,DssTypeUser:34,DssTypeTransmitter:35,DssTypeConfiguration:36,DssTypeRequest:37,DssTypeScript:38,DssTypeSearch:39,DssTypeSearchFolder:40,DssTypeDatamart:41,DssTypeFunctionPackageDefinition:42,DssTypeRole:43,DssTypeSecurityRole:44,DssTypeLocale:45,DssTypeConsolidation:47,DssTypeConsolidationElement:48,DssTypeScheduleEvent:49,DssTypeScheduleObject:50,DssTypeScheduleTrigger:51,DssTypeLink:52,DssTypeDbTable:53,DssTypeTableSource:54,DssTypeDocumentDefinition:55,DssTypeDrillMap:56,DssTypeDBMS:57,DssTypeMDSecurityFilter:58,DssTypePromptAnswer:59,DssTypePromptAnswers:60,DssTypeGraphStyle:61,DssTypeChangeJournalSearch:62,DssTypeNCSObjects:255,DssTypeReservedLastOne:63};(function(){function E(H,G,F){return H>=G&&H<=F;}function A(G,F){return{start:G,end:F};}function C(I,G){var L=this.renderedRowsArr,K=B.call(this,I,1),J=K.index,H=L[J],F;if(!K.between){if(H&&I>H.end+1){J++;L.splice(J,0,A(I,G));}else{L.splice(J,0,A(I,G));}H=L[J];}else{H.end=Math.max(H.end,G);}while(J<L.length-1){J++;F=L[J];if(H.end+1>=F.start){H.end=Math.max(H.end,F.end);L.splice(J,1);J--;}else{break;}}}function B(G,L){var K=this.renderedRowsArr,H=0,I=K.length-1,F,J;while(H<=I){F=(H+I)/2|0;J=K[F];if(E(G,J.start,J.end+L||0)){return{between:true,index:F};}else{if(G<J.start){I=F-1;}else{H=F+1;}}}return{between:false,index:F};}mstrmojo._RowRendTracker=mstrmojo.provide("mstrmojo._RowRendTracker",{_mixinName:"mstrmojo._RowRendTracker",renderedRowsArr:undefined,init:function D(F){this._super(F);this.renderedRowsArr=[];},markPages:function(G,F){C.call(this,G,F);},searchRow:function(H){var G=B.call(this,H,0),F;if(G.between){F=this.renderedRowsArr[G.index];return{rendered:true,min:F.start,max:F.end};}return null;},unMarkAllPages:function(){this.renderedRowsArr.length=[];}});}());(function(){function Q(U,R,S){if(U.nodeType===3&&R){return U;}else{var T=(R&&U.nodeType===1&&U.lastChild)?U.lastChild:F(U,S);return T?D(T,S):null;}}function F(S,R){return(S===R)?null:(S.previousSibling||F(S.parentNode,R));}function D(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.lastChild){return D(S.lastChild);}else{return D(F(S,R));}}}function I(R){return R.textContent||R.nodeValue||R.innerText;}function M(U,R,S){if(U.nodeType===3&&R){return U;}else{var T=(R&&U.nodeType===1&&U.firstChild)?U.firstChild:B(U,S);return T?E(T,S):null;}}function B(S,R){return(S===R)?null:(S.nextSibling||B(S.parentNode,R));}function E(S,R){if(S===R){return null;}if(S.nodeType===3&&I(S)){return S;}else{if(S.nodeType===1&&S.firstChild){return E(S.firstChild);}else{return E(B(S,R));}}}mstrmojo.range=mstrmojo.provide("mstrmojo.range",{EDGE:{EDGE_BEGIN:1,EDGE_END:2,EDGE_MIDDLE:-1},getEdgeInfo:function P(T,U){var R=0,S;if(T.nodeType===1){if(window.getSelection){S=document.createRange();S.selectNode(T);R=S.toString().length;}else{S=document.body.createTextRange();S.moveToElementText(T);R=S.text.length;}}else{R=I(T).length;}return U===R?this.EDGE.EDGE_END:(U===0?this.EDGE.EDGE_BEGIN:this.EDGE.EDGE_MIDDLE);},collapseOnNode:function K(U,S){if(!U.offsetParent){return ;}var T=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(U);R.collapse(S);T.removeAllRanges();T.addRange(R);}else{R.moveToElementText(U);R.collapse(S);R.select();}},collapseOnTextNode:function L(U,V){var T=this.getSelection(),S=this.getRange();if(window.getSelection){var R=M(U,true);S.setStart(R,V);S.collapse(true);T.removeAllRanges();T.addRange(S);}else{S.moveToElementText(U);S.collapse(true);S.move("character",V);S.select();}},collapseOnTextNodeIE:function C(S,T){var U=M(S,true),R;while(U!==null){R=I(U).length;if(R>=T){this.collapseOnTextNode(U,T);break;}else{T-=R;U=M(U,false);}}},getRangeInfo:function J(X,e){var Z=null,k,c=this.getRange(),b;if(X&&X===c.startContainer){var g=c.startContainer.firstChild,U=g&&g.firstChild,d=U&&U.firstChild;if(d){c.setStart(d,c.startOffset);c.setEnd(d,c.endOffset);}}if(window.getSelection){var W=function(m,o,n){var l=m.cloneRange();l.collapse(n);l.setStartBefore(o);return l.toString().length;},S=c.startContainer,f=c.startOffset;if(S.nodeType===1){f=W(c,S,true);}Z={collapsed:c.collapsed,startContainer:S,startOffset:e?e.startOffset:f};if(!c.collapsed){var V=c.endContainer,R=c.endOffset;if(V.nodeType===1){R=W(c,V,false);}Z.endContainer=V;Z.endOffset=R;}Z.range=c;}else{var j,a,Y=function(o,p){var n=o.duplicate(),l=document.body.createTextRange(),m;n.collapse(p);m=n.parentElement();l.moveToElementText(m);l.setEndPoint("EndToStart",n);return{container:m,offset:l.text.length};},h=Y(c,true),T;Z={collapsed:(c.compareEndPoints("StartToEnd",c)===0),startContainer:h.container,startOffset:h.offset};if(!Z.collapsed){T=Y(c,false);Z.endContainer=T.container;Z.endOffset=T.offset;}}return Z;},collapse:function O(S){if(window.getSelection){var T=this.getSelection();if(S){T.collapseToStart();}else{T.collapseToEnd();}}else{var R=this.getRange();R.collapse(S);R.select();}},selectSingleNode:function H(T){var S=this.getSelection(),R=this.getRange();if(window.getSelection){R.selectNodeContents(T);S.removeAllRanges();S.addRange(R);}else{R.moveToElementText(T);R.select();}},selectMultipleNodes:function N(W,S,X,U){var V=this.getSelection(),T=this.getRange();if(window.getSelection){T.setStart(W,S);T.setEnd(X,U);V.removeAllRanges();V.addRange(T);}else{W=(W.nodeType===3)?W.parentNode:W;T.moveToElementText(W);T.move("character",S);X=(X.nodeType===3)?X.parentNode:X;var R=document.body.createTextRange();R.moveToElementText(X);R.move("character",U);T.setEndPoint("EndToStart",R);T.select();}},getSelection:function G(){if(window.getSelection){return window.getSelection();}else{return document.selection;}},getRange:function A(){if(window.getSelection){selection=window.getSelection();if(selection.rangeCount>0){return selection.getRangeAt(0);}else{return document.createRange();}}else{return document.selection.createRange();}}});}());(function(){mstrmojo._Fetchable=mstrmojo.provide("mstrmojo._Fetchable",{_mixinName:"mstrmojo._Fetchable",blockBegin:1,blockCount:-1,concat:false,items:null,size:function A(){var B=this.items;return(B&&B.length)||0;},next:function(B){if(this.hasNext()){this.getItems(this.blockBegin+this.blockCount,B);}},previous:function(B){if(this.hasPrevious()){var C=this.blockBegin-this.blockCount;C=C<0?0:C;this.getItems(C,B);}},getItems:function(G,E){E=E||{};var D=this,C=mstrmojo.emptyFn,B=E.success||C,F=E.failure||C,H=E.complete||C;this._retrieveItems(G,{success:function(I){D.blockBegin=G;D.set("items",(D.concat?(D.items||[]).concat(I.items||[]):(I.items||[])));if(I.totalSize){D.totalSize=I.totalSize;}B(I);},failure:function(I){F(I);},complete:function(I){H(I);}});},_retrieveItems:function(C,B){alert("Object which mixes in this mixin has not implemented this method - _retrieveItems().");},hasNext:function(){return(((this.concat?1:this.blockBegin)+((this.items&&this.items.length)||0))<(this.totalSize+1));},hasPrevious:function(){return this.blockBegin>1;}});}());mstrmojo.vi.models.EnumDragSources={DATASETS:1,VIZ_EDITOR:2,FILTERS:3,ALL_OBJECT_LIST:4,VIZ:5};(function(){mstrmojo.mstr.search._IconCssClassBuilder=mstrmojo.provide("mstrmojo.mstr.search._IconCssClassBuilder",{_mixinName:"mstrmojo.mstr.search._IconCssClassBuilder",getIconCssClass:function A(B){B=B||this.data;return"t"+B.t+(B.st?" st"+B.st:"")+(B.isc?" isc":"")+(B.dvm?" dvm"+B.dvm:"");}});}());(function(){mstrmojo.cookies={};var C="%26",E="%3D",B=mstrmojo.cookies,D=function(){var F=document.cookie;if(!F||!(typeof F==="string")||F.indexOf("bSet")<0){return false;}return true;},A=function(){var F=document.cookie;F=F.split(";");for(s in F){if(F[s].indexOf("bSet")>=0){return F[s];}}return null;};mstrmojo.cookies.updateCookieSetting=function(H,N,J){try{if(!D()&&!J){return ;}var K=document.cookie,M=H+E+N+C;if(K.indexOf(H)>=0){var F=H+E,G=F+(B.getCookieSetting(H)||0),I=F+N;if(I!=G){document.cookie=K.replace(G,I);}}else{if(K.indexOf("bSet")>=0){document.cookie=K.replace("bSet=","bSet="+M);}else{if(J){document.cookie="bSet="+M+";"+K;}}}}catch(L){mstrmojo.alert(L);return ;}};mstrmojo.cookies.getCookieSetting=function(F){try{return B.getCookieList()[F];}catch(G){mstrmojo.alert(G);return ;}};mstrmojo.cookies.getCookieList=function(){try{if(!D()){return[];}var G=A(),F={},H=null;G=G.replace("bSet=","").split(C);for(H in G){H=G[H].split(E);F[H[0]]=H[1];}return F;}catch(I){mstrmojo.alert(I);return ;}};mstrmojo.cookies.enabledCookieOnBrowser=function(){var F=document.cookie;if(!F||!(typeof F==="string")){return false;}return true;};})();mstrmojo.EnumAuthenticationModes={DEFAULT:0,STANDARD:1,NTCREDENTIAL:2,PASSTHRU:4,ANONYMOUS:8,LDAP:16,DATABASE:32,PLUGIN:64,INTEGRATED:128,USHER:256};(function(){mstrmojo._CanRenderChildrenOnShow=mstrmojo.provide("mstrmojo._CanRenderChildrenOnShow",{_subs_renderOnShow:null,childRenderCheck:function B(D){if(this.renderMode!=="onshow"){return this._super(D);}if(D.visible){return this._super(D);}var C=this._subs_renderOnShow;if(!C){C={};this._subs_renderOnShow=C;}if(!C[D.id]){C[D.id]=D.attachEventListener("visibleChange",this.id,"_on_child_visibleChange");}return false;},_on_child_visibleChange:function A(C){if(this.hasRendered){var E=C&&C.src;if(E&&this.childRenderCheck(E)){var D=this._subs_renderOnShow;if(D){E.detachEventListener(D[E.id]);delete D[E.id];}E.render();}}}});}());(function(){mstrmojo.func=mstrmojo.provide("mstrmojo.func",{composite:function D(E){if(!E||!E.length){return mstrmojo.emptyFn;}return function(){var F=E.length,G;for(G=0;G<F;G++){E[G].apply(this,arguments);}};},wrapMethods:function C(J,H){function I(L,K){K=K||{};mstrmojo.hash.forEach(L,function(M,N){K[N]=(K.hasOwnProperty(N)&&typeof M==="function")?mstrmojo.func.composite([M,K[N]]):M;});return K;}if(arguments.length<3){return I(J,H);}var F=arguments.length,G=[].slice.call(arguments,0,F-1).reverse(),E=arguments[F-1];mstrmojo.array.forEach(G,function(K){E=I(K,E);});return E;},override:function A(G,E){var F=function(J,I){return function H(){var L=this._super,K;this._super=I||mstrmojo.emptyFn;try{K=J.apply(this,arguments||[]);}finally{this._super=L;}return K;};};E=E||{};mstrmojo.hash.forEach(G,function(H,I){E[I]=F(H,E[I]);});return E;},throttle:function(G,I,E){var F,K,N,L=null,J=0,M=E||{};var H=function(){J=M.leading===false?0:mstrmojo.date.now();L=null;N=G.apply(F,K);F=K=null;};return function(){var O=mstrmojo.date.now();if(!J&&M.leading===false){J=O;}var P=I-(O-J);F=this;K=arguments;if(P<=0){clearTimeout(L);L=null;J=O;N=G.apply(F,K);F=K=null;}else{if(!L&&M.trailing!==false){L=setTimeout(H,P);}}return N;};},debounce:function(H,J,G){var M,L,F,K,N,E=mstrmojo.date.now;var I=function(){var O=E()-K;if(O<J){M=setTimeout(I,J-O);}else{M=null;if(!G){N=H.apply(F,L);F=L=null;}}};return function(){F=this;L=arguments;K=E();var O=G&&!M;if(!M){M=setTimeout(I,J);}if(O){N=H.apply(F,L);F=L=null;}return N;};},addMethods:function B(F,E){E=E||{};mstrmojo.hash.forEach(F,function(G,H){if(!E.hasOwnProperty(H)&&typeof G==="function"){E[H]=G;}});return E;}});}());mstrmojo.EnumRWUnitType={LAYOUT:0,HEADER:2,FOOTER:3,SUBSECTION:4,DETAILS:5,PAGEHEADER:6,PAGEFOOTER:7,PANELSTACK:8,PANEL:9,GRID:521,GRAPH:522,GRIDGRAPH:527,RECTANGLE:101,IMAGE:102,LINE:105,TEXTFIELD:106,HTMLCONTAINER:107,SELECTOR:111,ROUNDEDRECTANGLE:112,VISUALIZATION:114,MOJOVISUALIZATION:115};mstrmojo.mstr.EnumDSSXMLBaseFormType={DssXmlBaseFormReserved:0,DssXmlBaseFormHidden:-1,DssXmlBaseFormDateTime:1,DssXmlBaseFormNumber:2,DssXmlBaseFormText:3,DssXmlBaseFormPicture:4,DssXmlBaseFormUrl:5,DssXmlBaseFormEmail:6,DssXmlBaseFormHTMLTag:7,DssXmlBaseFormDate:8,DssXmlBaseFormTime:9,DssXmlBaseFormSymbol:10,DssXmlBaseFormBigDecimal:11,DssXmlBaseFormPhoneNumber:12};mstrmojo.mstr.EnumDSSXMLBaseFormType.convertDataType2BaseFormType=function(B){var A={0:2,1:2,2:2,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:2,12:2,13:2,14:8,15:9,16:1,17:3,18:3,21:2,22:2,23:3,30:11,31:2,33:3,34:2};return A[B]||0;};(function(){function A(C){return C.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&");}mstrmojo._ImageHelper=mstrmojo.provide("mstrmojo._ImageHelper",{getImage:function B(D){var E=mstrApp,C=E.getConfiguration();if(D){if(D.indexOf("\\")>=0){D=D.replace(/\\/g,"/");}D=A(D);if(D===decodeURI(D)){D=encodeURI(D);}}if(C&&D&&D.indexOf("://")===-1){D=C.getHostUrlByProject(E.getCurrentProjectId())+D;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(D)):D;}});}());(function(){mstrmojo._HasPopup=mstrmojo.provide("mstrmojo._HasPopup",{_mixinName:"mstrmojo._HasPopup",_lastOpened:null,openPopup:function A(G,E){var C=!!G&&(typeof G==="string")&&!G.match(/\./)&&!!this[G],D=mstrmojo.registry.ref(C?this[G]:G);if(D&&D.open){if(C){this[G]=D;}if(D.disposable!==false){this.addDisposable(D);}var J=D.slot&&this[D.slot];if(J){if(D.parent!==this){if(this.addChildren){this.addChildren([D]);}else{var I=false,F=D.domNode||D.placeholder;if(F&&typeof F==="string"){F=document.getElementById(F);}if(!F){I=true;F=document.createElement("span");D.placeholder=F;}if(I||(F.parentNode!==J)){J.appendChild(F);}}}}try{D.open(this,E);}catch(H){console.log("Error opening popup: "+H);}this._lastOpened=D;}},closePopup:function B(){var C=this._lastOpened;if(C&&C.visible&&C.close){C.close();delete this._lastOpened;}}});}());mstrmojo.warehouse.EnumObjectTypes={FILTER:1,METRIC:4,ATTRIBUTE:12,FACT:13,DIMENSION:14,TABLE:15,TABLE_LOGICAL_VIEW:151,TABLE_PARTITION:152,FORM:21,COLUMN:26,DBROLE:29,PROJECT:32,TRANSFORMATION:43,DBTABLE:53,LAYER:70,RELATIONSHIP:99,COMPOUND_FORM:1001,RELATIONSHIP_ATTRIBUTE:1002};(function(){mstrmojo.vi._MonitorsAppState=mstrmojo.provide("mstrmojo.vi._MonitorsAppState",{onAppStateChange:function(B){if(this._super){this._super(B);}},init:function A(B){this._super(B);if(mstrApp.attachEventListener){mstrApp.attachEventListener("appStateChange",this.id,"onAppStateChange");}}});}());mstrmojo.chart.model.enums.EnumDSSBaseFormType={DssBaseFormReserved:0,DssBaseFormDateTime:1,DssBaseFormNumber:2,DssBaseFormText:3,DssBaseFormPicture:4,DssBaseFormUrl:5,DssBaseFormEmail:6,DssBaseFormHTMLTag:7,DssBaseFormDate:8,DssBaseFormTime:9,DssBaseFormSymbol:10,DssBaseFormBigDecimal:11};(function(){mstrmojo.models.template.MetricValue=mstrmojo.declare(null,null,{init:function G(H){this.data=H.data;this.value=H.value;},getValue:function B(){return this.value.v;},getThresholdType:function D(){return this.value.ty;},getRawValue:function A(){return this.value.rv;},getCSS:function C(){return this.data.css[this.value.cni].n;},getThresholdValue:function F(H){if(this.value.ti===undefined){return H;}return this.data.th[this.value.ti].n;},getFillColor:function E(H){if(this.value.ci===undefined){return H;}return this.data.fc[this.value.ci].n;}});}());(function(){mstrmojo._IsGraphDataService=mstrmojo.provide("mstrmojo._IsGraphDataService",{handleUserSingleTap:function A(D,E,B,G,C,F){if(mstrApp.onMobileDevice()){mstrApp.serverRequest({taskId:"handleUserSingleTap",sliceID:D,nodekey:E,x:B,y:G,selectable:C},F);}}});}());(function(){var B=1,C=2,A=4;mstrmojo._IsThresholdConditionTarget=mstrmojo.provide("mstrmojo._IsThresholdConditionTarget",{_mixinName:"mstrmojo._IsThresholdConditionTarget",update:function D(G){var E=G.data.tta;var F=(E&B)>0,H=(E&C)>0;if(F&&this.preservedEnabled===undefined){this.preservedEnabled=!!this.enabled;}if(H&&this.preservedVisible===undefined){this.preservedVisible=!!this.visible;}this.set("enabled",F?false:this.preservedEnabled!==undefined?this.preservedEnabled:this.enabled);this.set("visible",H?false:this.preservedVisible!==undefined?this.preservedVisible:this.visible);this.set("required",(E&A)>0);if(this._super){this._super(G);}}});}());(function(){mstrmojo._HasDrillLinks=mstrmojo.provide("mstrmojo._HasDrillLinks",{_mixinName:"mstrmojo._HasDrillLinks",update:function A(E){this._super(E);var B=E.defn.dl,F=E.data.dl,D=this.drillLinkItems=((B&&B.items)||[]).concat((F&&F.items)||[]).sort(function(H,G){return H.index-G.index;}),C;for(C=D.length-1;C>=0;C--){if(C&&D[C].index===D[C-1].index){D.splice(C,1);}}if(B&&B.target){for(C=0;C<D.length;C++){D[C].target=B.target;}}}});}());mstrmojo.requiresDescs(5547,5217,5218,5219,5220,5221);var EnumWebPromptsList=[{n:"Hierarchy Qualification Prompt",desc:"Hierarchy Qualification prompt",descId:5547,value:"editPrompt",name:"hierarchyPrompt",params:{evt:3004,target:"editPrompt",promptType:3,promptExpressionType:16}},{n:"Attribute Qualification Prompt",desc:"Attribute Qualification prompt",descId:5217,name:"aqPrompt",value:"editPrompt",params:{evt:3004,target:"editPrompt",promptType:3,promptExpressionType:17}},{n:"Attribute Element List",desc:"Att Element List prompt",descId:5218,value:"editPrompt",name:"attributePrompt",params:{evt:3004,target:"editPrompt",promptType:2}},{n:"Metric Qualification Prompt",desc:"Metric Qualification prompt",descId:5219,value:"editPrompt",name:"mqPrompt",params:{evt:3004,target:"editPrompt",promptType:3,promptExpressionType:10}},{n:"Object Prompt",desc:"Object",descId:5220,value:"editPrompt",name:"objectPrompt",params:{evt:3004,target:"editPrompt",promptType:4,}},{n:"Value Prompt",desc:"Value",descId:5221,value:"editPrompt",name:"valuePrompt",params:{evt:3004,target:"editPrompt",promptType:1,constDataType:14}}];mstrmojo.mstr.ui.EnumWebPromptsList={get:function(){var A=mstrApp.servletName||mstrApp.name;return mstrmojo.array.map(EnumWebPromptsList,function(B){B.src=A+B.evt;return B;});}};mstrmojo.mstr.EnumNodeDimty={NodeDimtyReserved:0,NodeDimtyNone:1,NodeDimtyContinuation:2,NodeDimtyExclusiveContinuation:3,NodeDimtyOutputLevel:4,NodeDimtyBreakBy:5,NodeDimtyEmbedded:6,NodeDimtyUnspecified:7};mstrmojo.mstr.EnumDSSXMLDrillType={DssXmlDrillReserved:0,DssXmlDrillToParent:1,DssXmlDrillToChild:2,DssXmlDrillToUnit:3,DssXmlDrillToTemplate:4,DssXmlDrillToForm:5,DssXmlDrillToDetails:6,DssXmlDrillToMetric:7,DssXmlDrillFixTemplate:8,DssXmlDrillRemoveMetric:9,DssXmlDrillRemoveUnit:10,DssXmlDrillToGraphCoordinates:11};mstrmojo.LoadedExternalJSURLs={};function LoadScriptsExternalJSCallback(){mstrmojo.LoadedExternalJSURLs[mstrmojo._LoadsScript.esScripts.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(mstrmojo._LoadsScript.esScripts,mstrmojo._LoadsScript.callback,mstrmojo._LoadsScript.esScritsContext);mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=false;}mstrmojo._LoadsScript=mstrmojo.provide("mstrmojo._LoadsScript",{_meta_usesSuper:false,requiresMethod:function requiresMethod(B){if(!B){return false;}if(typeof this[B]==="function"){return true;}var A=this[B]||(this.methods&&(this.methods[B]||this.methods["*"]));if(typeof A==="string"){this.requiresCls(A);return typeof this[B]==="function";}return false;},requiresCls:function req(mixins,callback){if(mixins){if(typeof mixins==="string"){mixins=[mixins];}mstrmojo.requiresCls.apply(mstrmojo,mixins);var p=this.constructor.prototype,pm=p.mixins;if(!pm){p.mixins={};pm=p.mixins;}var mx=mstrmojo.mixin,i,len;for(i=0,len=mixins.length;i<len;i++){var fqcn=mixins[i];if(!pm[fqcn]){var m=eval(mixins[i]);mx(m,p);pm[fqcn]=true;if(m.__onmixin__){m.__onmixin__.apply(this,[]);}}}if(callback){callback.apply(this,[]);}}},requiresContrib:function reqCb(C,B){var A=this[C];if(A){var E,D=false;if(typeof A==="string"){E=mstrmojo.registry.ref(A);this[C]=E;D=true;}else{E=A;}if(E&&(D||B)){E.parent=this;if(E.startup){E.startup();}}return E;}return null;},requiresExternalScripts:function requiresExternalScripts(F,G,C){if(F&&F instanceof Array){if(F.length===0){if(G){G.call(C);}return false;}if(F[0]&&F[0].forceReload===false&&mstrmojo.LoadedExternalJSURLs[F[0].url]){F.splice(0,1);return this.requiresExternalScripts(F,G,C);}var A=document.createElement("script"),D=!!document.all,B=F[0].url;if(B.substr(0,7)==="file://"){B=B.substr(7);}else{if(mstrApp.isSingleTier&&B.substr(0,4)!=="http"){B="http:"+B;}}A.type="text/javascript";A.src=B;if(!F[0].callbackParamName){if(D){A.onreadystatechange=function(){if(A.readyState==="loaded"||A.readyState==="complete"){A.onreadystatechange=null;if(F.length>1){mstrmojo.LoadedExternalJSURLs[F.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(F,G);}else{if(F.length===1){mstrmojo.LoadedExternalJSURLs[F[0].url]=true;if(G){G.call(C);}}}}};}else{A.onload=function(){A.onload=null;if(F.length>1){mstrmojo.LoadedExternalJSURLs[F.splice(0,1)[0].url]=true;mstrmojo._LoadsScript.requiresExternalScripts(F,G);}else{if(F.length===1){mstrmojo.LoadedExternalJSURLs[F[0].url]=true;if(G){G.call(C);}}}};}}else{if(F[0].callbackParamName.length!==0){if(mstrmojo._LoadsScript.ExternalJSCallbackIsBusy&&mstrmojo._LoadsScript.ExternalJSCallbackIsBusy===true){var E=this;window.setTimeout(function(){E.requiresExternalScripts(F,G,C);},500);return ;}mstrmojo._LoadsScript.ExternalJSCallbackIsBusy=true;A.src+="&"+F[0].callbackParamName+"=LoadScriptsExternalJSCallback";mstrmojo._LoadsScript.esScripts=F;mstrmojo._LoadsScript.callback=G;mstrmojo._LoadsScript.esScritsContext=C;}}document.getElementsByTagName("head")[0].appendChild(A);}}});(function(){var B={NetworkVisualizationStyle:{vib:"vi-network.js",oivmb:"oivm-network.js",b:"vi-network.js",s:"VisualizationServerJsonDataStyle",c:"netviz.VisNetwork"},GraphMatrixVisualizationStyle:{vib:"vi-gm.js",oivmb:"oivm-gm.js",b:"vi-gm.js",s:"VisualizationServerJsonDataStyle",c:"gm.VisGraphMatrix"},SurveyVisualizationStyle:{s:"VisualizationDataStyle",c:"SurveyVis"},ReportTimelineAjaxVisualizationStyle:{s:"TimelineMojoVisualizationDataStyle",c:"VisTimeline"},VIHeatMapVisualizationStyle:{vib:"vi-heatmap.js",oivmb:"oivm-heatmap.js",b:"vi-heatmap.js",s:"VisualizationServerJsonDataStyle",c:"heatmap.vi.VisHeatMap"},visAjaxDatePicker:{s:"AjaxDatePickerReportStyle",c:"VisDateSelection"},ESRIMapVisualizationStyle:{b:"mojo-map.js",s:"MojoXtabMapStyle",c:"esrimap.ESRIMapOIVM"}};var E={"com.microstrategy.web.vf.viewer.DatePickerApplicationViewer":"visAjaxDatePicker","com.microstrategy.web.vf.viewer.EsriMapApplicationViewer":"ESRIMapVisualizationStyle","com.microstrategy.flex.viewer.NetViz":"NetworkVisualizationStyle","com.microstrategy.flex.viewer.GraphMatrixViewer":"GraphMatrixVisualizationStyle","com.microstrategy.web.vf.viewer.HeatMapApplicationViewer":"VIHeatMapVisualizationStyle"};mstrmojo.ExpressVisList=mstrmojo.provide("mstrmojo.ExpressVisList",{getVis:function D(F){return B[F]||(mstrConfig&&mstrConfig.pluginsVisList&&mstrConfig.pluginsVisList[F])||null;},findVisName:function(F){return E[F]||(mstrConfig&&mstrConfig.pluginsWidgetVisMap[F])||null;},findWidgetName:function C(H){var G;for(var F in E){if(E.hasOwnProperty(F)&&E[F]===H){G=F;break;}}if(!G&&mstrConfig&&mstrConfig.pluginsWidgetVisMap){for(var F in mstrConfig.pluginsWidgetVisMap){if(mstrConfig.pluginsWidgetVisMap.hasOwnProperty(F)&&mstrConfig.pluginsWidgetVisMap[F]===H){G=F;break;}}}return G;},getVisClass:function A(F,G){if(G.txi&&G.t===115){F=mstrmojo.DynamicClassFactory.newComponent(F,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab]);}return F;}});}());mstrmojo.mstr.EnumDSSXMLObjectTypes={Generic:-2,Unknown:-1,Reserved:0,Filter:1,Template:2,ReportDefinition:3,Metric:4,Style:6,AggMetric:7,Folder:8,SubscriptionDevice:9,Prompt:10,Function:11,Attribute:12,Fact:13,Dimension:14,Table:15,DatamartReport:16,FactGroup:17,Shortcut:18,Resolution:19,Monitor:20,AttributeForm:21,Schema:22,Format:23,Catalog:24,CatalogDefn:25,Column:26,PropertySet:28,DBRole:29,DBLogin:30,DBConnection:31,Project:32,ServerDef:33,User:34,Configuration:36,Request:37,Script:38,Search:39,SearchFolder:40,Datamart:41,FunctionPackageDefinition:42,Role:43,SecurityRole:44,Locale:45,Consolidation:47,ConsolidationElement:48,ScheduleEvent:49,ScheduleObject:50,ScheduleTrigger:51,Link:52,DbTable:53,TableSource:54,DocumentDefinition:55,DrillMap:56,DBMS:57,MDSecurityFilter:58,PromptAnswer:59,PromptAnswers:60,ObjectTag:65,ReservedLastOne:66};(function(){function B(J,E){if(!E.domNode){return 0;}var K="_fixed"+J;if(E[K]){return E[K];}var H=E.getFormats(),I=J.toLowerCase();if(H&&H.hasOwnProperty(I)){var F=H[I];if(F.charAt(F.length-1)!=="%"){var G=parseInt(F,10);if(!isNaN(G)){E[K]=G;return G;}}}return(E.domNode["client"+J]||0);}mstrmojo._ContainsDocObjects=mstrmojo.provide("mstrmojo._ContainsDocObjects",{getHeight:function D(){return B("Height",this);},getWidth:function A(){return B("Width",this);},getMaxZIndex:function C(){var F=0;mstrmojo.array.forEach(this.children,function E(G){F=Math.max(F,G.getFormats()["z-index"]);});return F;}});}());(function(){function A(C){return function B(H){if(!this.domNode){return 0;}var G=this.children;if(H!==undefined&&!isNaN(H)){G=(G&&[G[H-1]]);}var E=(G&&G.length)||0,D=0,F;for(F=0;F<E;F++){D+=G[F]["get"+C]();}return D;};}mstrmojo._CanMeasureChildren=mstrmojo.provide("mstrmojo._CanMeasureChildren",{getHeight:A("Height"),getWidth:A("Width")});}());(function(){var A={};mstrmojo.NumberFormat={getInstance:function B(F,G){var E=F+"--"+G;if(E in A){return A[E];}var C={parse:function(H){},format:function(H){}};if(F==="."&&G===","){C.parse=function(H){if(!H){return NaN;}var I=H.replace(/,/g,"");return Number(I);};C.format=function(H){return Number(H).toString();};}else{var D=new RegExp("\\"+G,"g");C.parse=function(I){if(!I){return NaN;}var H=I.replace(D,"").replace(F,".");return Number(H);};C.format=function(I){var H=Number(I).toString();return H.replace(".",F);};}A[E]=C;return C;}};})();(function(){mstrmojo._IsSelectorTarget=mstrmojo.provide("mstrmojo._IsSelectorTarget",{_mixinName:"mstrmojo._IsSelectorTarget",setDirty:function A(C){var D=(C?"add":"remove")+"DirtyKey",B=this.parent;if(B&&B[D]){this.parent[D](this.k);}}});}());(function(){mstrmojo.ui.editors._HostsControls=mstrmojo.provide("mstrmojo.ui.editors._HostsControls",{_mixinName:"mstrmojo.ui.editors._HostsControls",setFormatSource:function C(E){this.throwAbstractMethodError("setFormatSource");},syncControls:function A(E){var F=this._sync;this._sync=true;E.call(this);this._sync=F;},raiseFormatValueChange:function D(F,G,E){if(this._sync){return false;}this.onGroupValueChange(F,G,E);return true;},onGroupValueChange:function B(F,G,E){}});}());(function(){mstrmojo.hash=mstrmojo.provide("mstrmojo.hash",{copy:function B(S,R){if(S){R=R||{};var T;for(T in S){R[T]=S[T];}}return R;},copyProps:function C(T,V,R){R=R||{};if(V){var U=(T&&T.length)||0,S;for(S=0;S<U;S++){var W=T[S];if(V[W]!==undefined){R[W]=V[W];}}}return R;},forEach:function I(U,T,S){if(U){var R;for(R in U){if(S){if(T.call(S,U[R],R,U)===false){break;}}else{if(T(U[R],R,U)===false){break;}}}}return U;},walk:function P(V,S){if(!S){S=mstrmojo.global;}var U=V.split(".");if(U.length===1){return S[V];}var T=(U&&U.length)||0,R;for(R=0;R<T;R++){S=S[U[R]];if(!S){break;}}return S;},isEmpty:function F(S){if(!S){return true;}var R;for(R in S){if(S[R]!==null&&S[R]!==undefined){return false;}}return true;},clear:function G(S){if(S){var R;for(R in S){delete S[R];}}return S;},any:function J(U,V){var T;if(U){var S=this.keyarray(U);if(S.length>0){var R=S[0];T=V?R:U[R];}}return T;},clone:function M(V){if(!V){return null;}var X;if(V.constructor===Array){X=V.concat();var W=X[0];if(W&&typeof W==="object"){var R=X.length,U;for(U=0;U<R;U++){X[U]=this.clone(V[U]);}}}else{X={};var T;for(T in V){var S=V[T];if(S&&typeof S==="object"){X[T]=this.clone(S);}else{X[T]=S;}}}return X;},cloneArray:function E(S){var T=[],R=(S&&S.length)||0,U;for(U=0;U<R;U++){T[U]=this.clone(S[U]);}return T;},keyarray:function K(T,U){var R=[],S;if(T){if(Object.keys&&!U){R=Object.keys(T);}else{for(S in T){R.push(U?Number(S):S);}}}return R;},valarray:function L(T){var R=[];if(T){var S;for(S in T){R.push(T[S]);}}return R;},equals:function Q(Y,X){var S=mstrmojo.hash,W=(Y&&X)||(!Y&&!X&&(Y===X));if(W&&Y){W=(Y.constructor===X.constructor);if(W){if(Y.constructor===Array){var V=Y.length;W=(V===X.length);if(W&&V){var T;for(T=0;T<V;T++){W=W&&S.equals(Y[T],X[T]);}}}else{if(typeof Y==="object"){var Z=S.keyarray(Y),U=S.keyarray(X);W=Z.length===U.length;if(W){var R;for(R in Y){W=W&&(S.equals(Y[R],X[R]));}}}else{W=(Y===X);}}}}return W;},obj2array:function O(W){var X;for(X in W){var V=W[X];if(V&&typeof V==="object"){W[X]=this.obj2array(V);}}var S=W.isArray;if(S!==undefined&&S===true){var U=[],R=W.length,T;for(T=0;T<R;T++){U.push(W[T]);}return U;}return W;},min:function D(U,V,W){var R=null,T;if(U){for(T in U){var S=V?U[T]:T;if(W){S=Number(S);}if((R===null)||(S<R)){R=S;}}}return R;},max:function N(U,V,W){var R=null,T;if(U){for(T in U){var S=V?U[T]:T;if(W){S=Number(S);}if((R===null)||(S>R)){R=S;}}}return R;},make:function A(S,T,R){if(!S||!T){return null;}if(S.attachEventListener){return S;}if(T.makeObservable){S=T.makeObservable(S,R)||S;}else{this.copy(T.prototype,S);if(S.init){S=S.init(R)||S;}}return S;},mergeHashes:function H(R,S){R=this.clone(R)||{};if(S){mstrmojo.array.forEach(mstrmojo.array.distinct(this.keyarray(S).concat(this.keyarray(R))),function(T){var V=R[T],U=S[T];if(!V){R[T]=U;}else{if(V&&U){if(typeof V==="object"){if(V.constructor===Array){R[T]=V.concat(U);}else{R[T]=this.mergeHashes(V,U);}}else{R[T]=U;}}}},this);}return R;}});}());(function(){mstrmojo.StringBuffer=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.StringBuffer",append:function A(C){if(!this.buf){this.reset();}this.buf[++this.len]=C;return this;},reset:function B(){this.buf=[];this.len=-1;}});mstrmojo.StringBuffer.prototype.toString=function(D){var C=this.buf;return(C&&C.join(D||""))||"";};}());(function(){var C="xviPopopNode";function A(G){var H={};H[C]=G;return H;}mstrmojo.ui.menus._IsMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._IsMenuPopup",{init:function E(G){this._super(G);var J=this.popupConfig;if(!J){throw new Error("Cannot instantiate popup without supplying the popupConfig property.");}this.addDisposable(J);var H=mstrmojo.all[J.hostId],I=J.hostElement;if(J.isHostedWithin&&H&&I){H.addSlots(A(I));this.slot=C;}},closeAllMenus:function F(){var G=this.opener;if(G&&G.closePopup){G.closePopup();}if(G&&G.closeAllMenus){G.closeAllMenus();}},open:function B(H,G){if(this._super){this._super(H,G);}},close:function D(G){if(this.slot===C){this.opener.removeSlots(A(null));}if(this._super){this._super(G);}this.destroy();var H=mstrmojo.all[this.popupConfig.hostId];if(H){H.closePopup();}}});}());(function(){mstrmojo.requiresDescs(5774,2266,2287,2496,2495,2493,2267,2498,2500,2279,2491,2476,2271,2478,2268,2492,2273,2280,2490,2488,2494,2487,2269,2477,2499,2292,2489,2281,2484,2483,2480,2497,2274,2485,2486,2282,2481,2479,2482,2290,2293);var A=[{n:mstrmojo.desc(5774,"No Fill"),id:"transparent"},{n:mstrmojo.desc(2266,"Black"),id:"#000000"},{n:mstrmojo.desc(2287,"Brown"),id:"#993300"},{n:mstrmojo.desc(2496,"Olive Green"),id:"#333300"},{n:mstrmojo.desc(2495,"Dark Green"),id:"#003300"},{n:mstrmojo.desc(2493,"Dark Teal"),id:"#003366"},{n:mstrmojo.desc(2267,"Dark Blue"),id:"#000080"},{n:mstrmojo.desc(2498,"Indigo"),id:"#333399"},{n:mstrmojo.desc(2500,"Grey-80%"),id:"#333333"},{n:mstrmojo.desc(2279,"Dark Red"),id:"#800000"},{n:mstrmojo.desc(2491,"Orange"),id:"#ff6600"},{n:mstrmojo.desc(2476,"Dark Yellow"),id:"#808000"},{n:mstrmojo.desc(2271,"Green"),id:"#008000"},{n:mstrmojo.desc(2478,"Teal"),id:"#008080"},{n:mstrmojo.desc(2268,"Blue"),id:"#0000ff"},{n:mstrmojo.desc(2492,"Blue-Grey"),id:"#666699"},{n:mstrmojo.desc(2273,"Grey-50%"),id:"#808080"},{n:mstrmojo.desc(2280,"Red"),id:"#ff0000"},{n:mstrmojo.desc(2490,"Light Orange"),id:"#ff9900"},{n:mstrmojo.desc(2488,"Lime"),id:"#99cc00"},{n:mstrmojo.desc(2494,"Sea Green"),id:"#339966"},{n:mstrmojo.desc(2487,"Aqua"),id:"#33cccc"},{n:mstrmojo.desc(2269,"Light Blue"),id:"#3366ff"},{n:mstrmojo.desc(2477,"Violet"),id:"#800080"},{n:mstrmojo.desc(2499,"Grey-40%"),id:"#969696"},{n:mstrmojo.desc(2292,"Pink"),id:"#ff00ff"},{n:mstrmojo.desc(2489,"Gold"),id:"#ffcc00"},{n:mstrmojo.desc(2281,"Yellow"),id:"#ffff00"},{n:mstrmojo.desc(2484,"Bright Green"),id:"#00ff00"},{n:mstrmojo.desc(2483,"Turquoise"),id:"#00ffff"},{n:mstrmojo.desc(2480,"Sky Blue"),id:"#00ccff"},{n:mstrmojo.desc(2497,"Plum"),id:"#993366"},{n:mstrmojo.desc(2274,"Grey-25%"),id:"#c0c0c0"},{n:mstrmojo.desc(2485,"Rose"),id:"#ff99cc"},{n:mstrmojo.desc(2486,"Tan"),id:"#ffcc99"},{n:mstrmojo.desc(2282,"Light Yellow"),id:"#ffff99"},{n:mstrmojo.desc(2481,"Light Green"),id:"#ccffcc"},{n:mstrmojo.desc(2479,"Light Turquoise"),id:"#ccffff"},{n:mstrmojo.desc(2482,"Pale Blue"),id:"#99ccff"},{n:mstrmojo.desc(2290,"Lavender"),id:"#cc99ff"},{n:mstrmojo.desc(2293,"White"),id:"#ffffff"}];var E=[];mstrmojo.util.ui.ColorPicker={getBasicColors:function B(){return A.slice();},getCustomColors:function D(){return E.slice();},addCustomColor:function C(G){var F=function(H){return H.id===G;};if(!A.filter(F)[0]&&!E.filter(F)[0]){E.push({n:G,id:G});if(E.length>8){E.shift();}}}};}());(function(){function AI(Ao,Ap){return Ap||(Ao||window).event;}mstrmojo.PositionType=null;var Al=!!document.all,AG=document.documentMode,q=navigator.userAgent,j=false,g=false,e=false,d=false,R=false,t=false;if(Al){if(window.mstrConfig&&mstrConfig.isEdgeModeEnabled){j=!!q.match(/MSIE 6/);g=((!!q.match(/MSIE 7/)&&!AG)||AG===7);e=(AG===8);d=(AG===9);R=(AG===10);t=(!AG||AG<=9);}else{j=!!q.match(/MSIE 6/);g=!!q.match(/MSIE 7/);e=!!q.match(/MSIE 8/);d=!!q.match(/MSIE 9/);R=!!q.match(/MSIE 10/);t=!R;}}var c=!Al&&!!q.match(/Firefox/),l=0,r=!!q.match(/Android/),Ac=!!q.match(/iPad/),AM=!!q.match(/iPhone/),AU=!!document.createTouch||r,p=!!q.match(/PlayBook/),O=!!q.match(/Windows Phone/),Am=!Al&&!!q.match(/Trident.*rv/),b=c?"-moz-":(Al||Am)?"":"-webkit-",AH=c?"Moz":(R||Am)?"":Al?"ms":"webkit",AR=((R||Am)?"t":"T"),AL=AH+AR+"ransition";function Ag(){return AH+AR+"ransform";}function AE(){return AL+"Property";}function S(){return AL+"Duration";}function N(){return(R||c)?"transitionend":"webkitTransitionEnd";}function f(){return AH+"BoxShadow";}var Aj=Ag(),AZ=AE(),z=S(),A=N(),n=f();function AQ(){if(!l&&c){var Ao=q.match(/.*Firefox\/([\d|\.]*).*/);if(Ao){l=parseFloat(Ao[1]);}}return l;}function AW(){var Ap=0,At=0,Aq=window,Ar=document,Ao=Ar.body,As=Ar.documentElement;if(typeof Aq.pageYOffset==="number"){At=Aq.pageYOffset;Ap=Aq.pageXOffset;}else{if(Ao&&(Ao.scrollLeft||Ao.scrollTop)){At=Ao.scrollTop;Ap=Ao.scrollLeft;}else{if(As&&(As.scrollLeft||As.scrollTop)){At=As.scrollTop;Ap=As.scrollLeft;}}}return{x:Ap,y:At};}function AF(Ao){Ao=Ao||0;Ao=String(Ao);return((Ao.indexOf("%",0))!==-1)?Ao:(Ao+"px");}function AO(Aq,Au,At,As,Ar){if(!mstrmojo.dom.isWinPhone){As=(As||false||this.isHWAccelerated);}else{As=false;}var Ap=Ar+(As?"3d":"")+"(",Ao=As?(","+At+")"):")";return Ap+Aq+","+Au+Ao;}var Aa=2,V=3;function u(Au,At,Ax){var Aw=Au.style,Aq=Aw.display,As=this.windowDim(),Ar=AW();Aw.display="block";var Av=As.w-Au.clientWidth,Ay=Math.max(As.h-Au.clientHeight,0),Ao={4:0,5:Av,3:Av/2},Ap={1:0,3:Ay/2,2:Ay};Aw.left=Ao[At]+Ar.x+"px";Aw.top=Ap[Ax]+Ar.y+"px";Aw.display=Aq;}function m(Ar,Aq,As,Ao){if(Ar.addEventListener){return Ar.addEventListener(Aq,As,!!Ao);}As._id=As._id||m.guid++;Ar.events=Ar.events||{};var Ap=Ar.events[Aq];if(!Ap){Ap=Ar.events[Aq]={};if(Ar["on"+Aq]){Ap[0]=Ar["on"+Aq];}}Ap[As._id]=As;function At(Aw){Aw=Aw||window.event;var Av=this.events[Aw.type],Au;for(Au in Av){Av[Au].call(this,Aw);}}Ar["on"+Aq]=At;}m.guid=1;function h(Aq,Ap,Ar,Ao){if(!Aq){return ;}if(Aq.removeEventListener){Aq.removeEventListener(Ap,Ar,!!Ao);}else{if(Aq.events&&Aq.events[Ap]){delete Aq.events[Ap][Ar._id];}}}mstrmojo.Enum_Keys={BACKSPACE:8,TAB:9,ENTER:13,CTRL:17,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46};mstrmojo.dom=mstrmojo.provide("mstrmojo.dom",{userAgent:q,isIE:Al,isIE6:j,isIE7:g,isIE8:e,isIE9:d,isIE10:R,isIEW3C:Am,isNSIE:t,isDXIE:t,isFF:c,isWK:!!q.match(/AppleWebKit/),isSafari:!!q.match(/Safari/)&&!q.match(/Chrome/),isChrome:!!q.match(/AppleWebKit/)&&q.match(/Chrome/),isHWAccelerated:!r,isAndroid:r,isIPad:Ac,isPlayBook:p,isWinPhone:O,isMobile:Ac||AM||O||r,supportsTouches:AU,TOUCHSTART:AU?"touchstart":"mousedown",TOUCHMOVE:AU?"touchmove":"mousemove",TOUCHEND:AU?"touchend":"mouseup",TOUCHCANCEL:AU?"touchcancel":"",RESIZE:AU?"orientationchange":"resize",CSS3_PREFIX:b,CSS3_BOXSHADOW:n,CSS3_TRANSFORM:Aj,CSS3_TRANSITION:AL,CSS3_TRANSITION_PROPERTY:AZ,CSS3_TRANSITION_DURATION:z,CSS3_TRANSITION_END:A,cssFeatures:{GRADIENTS:"gd",ROUND_CORNERS:"rc",TEXT_ROTATION:"tr",DROP_SHADOW:"sh"},htmlFeatures:{FILE_READER:"fr"},MOUSE_BUTTON:{LEFT:1,RIGHT:2},supports:function B(Ao){var Ap=this.isFF&&AQ();switch(Ao){case this.cssFeatures.GRADIENTS:return(this.isIE||this.isIEW3C||this.isWK||Ap>=3.6||this.isWinPhone);case this.cssFeatures.ROUND_CORNERS:return(this.isWK||this.isFF||this.isWinPhone||this.isIE10);case this.cssFeatures.TEXT_ROTATION:case this.cssFeatures.DROP_SHADOW:return(this.isIE||this.isWK||Ap>=3.5||this.isWinPhone||this.isIE10||this.isIEW3C);case this.htmlFeatures.FILE_READER:return !!(window.FileReader);}return false;},getOSInfo:function AN(){var At="Unknown",Ap=navigator.appVersion,As=navigator.userAgent,Ar=At;var Ao=[{s:"Windows 3.11",r:/Win16/},{s:"Windows 95",r:/(Windows 95|Win95|Windows_95)/},{s:"Windows ME",r:/(Win 9x 4.90|Windows ME)/},{s:"Windows 98",r:/(Windows 98|Win98)/},{s:"Windows CE",r:/Windows CE/},{s:"Windows 2000",r:/(Windows NT 5.0|Windows 2000)/},{s:"Windows XP",r:/(Windows NT 5.1|Windows XP)/},{s:"Windows Server 2003",r:/Windows NT 5.2/},{s:"Windows Vista",r:/Windows NT 6.0/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows NT 4.0",r:/(Windows NT 4.0|WinNT4.0|WinNT|Windows NT)/},{s:"Windows ME",r:/Windows ME/},{s:"Android",r:/Android/},{s:"Open BSD",r:/OpenBSD/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/},{s:"QNX",r:/QNX/},{s:"UNIX",r:/UNIX/},{s:"BeOS",r:/BeOS/},{s:"OS/2",r:/OS\/2/},{s:"Search Bot",r:/(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\/Teoma|ia_archiver)/}];var Aq;for(Aq=0;Aq<Ao.length;Aq++){var Av=Ao[Aq];if(Av.r.test(As)){Ar=Av.s;break;}}var Au=At;if(/Windows/.test(Ar)){Au=/Windows (.*)/.exec(Ar)[1];Ar="Windows";}switch(Ar){case"Mac OS X":Au=/Mac OS X (10[\.\_\d]+)/.exec(As)[1];break;case"Android":Au=/Android ([\.\_\d]+)/.exec(As)[1];break;case"iOS":Au=/OS (\d+)_(\d+)_?(\d+)?/.exec(Ap);Au=Au[1]+"."+Au[2]+"."+(Au[3]|0);break;}return{name:Ar,version:Au};},transEndEvtNames:{WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"},replace:function o(Aq,Ao){if(Aq&&Ao){var Ap=Aq.parentNode;if(Ap){Ap.replaceChild(Ao,Aq);}}return Ao;},attachEvent:function X(Aq,Ap,Ar,Ao){if(Aq.addEventListener){return Aq.addEventListener(Ap,Ar,!!Ao);}return Aq.attachEvent("on"+Ap,Ar);},detachEvent:function AY(Aq,Ap,Ar,Ao){if(!Aq){return ;}if(Aq.removeEventListener){Aq.removeEventListener(Ap,Ar,!!Ao);}else{Aq.detachEvent("on"+Ap,Ar);}},attachMarkupEvent:function w(Ar,Aq,Ao){var Ap=function(As){mstrmojo.all[Ar].captureDomEvent(Ao,window,As);};this.attachEvent(Aq,Ao,Ap);return Ap;},attachOneTimeEvent:function W(Ar,Ap,As,Ao){var Aq=function(At){As(At);if(Ao){h(this,Ap,Aq);}else{mstrmojo.dom.detachEvent(this,Ap,Aq);}};if(Ao){m(Ar,Ap,Aq);}else{this.attachEvent(Ar,Ap,Aq);}Ar=null;return Aq;},attachMouseMoveEvents:function D(Ar,Ao){var Aq=this,Ap=function(As){if(Ao){Ao(As);}Aq.detachEvent(document,"mousemove",Ar);Aq.detachEvent(document,"mouseup",Ap);};Aq.attachEvent(document,"mousemove",Ar);Aq.attachEvent(document,"mouseup",Ap);},captureDomEvent:function AK(At,Ar,Ap,As,Aq){var Ao=mstrmojo.all[At];if(Ao){Ao.captureDomEvent(Ar,Ap,As,Aq);}},translate:function L(Aq,Ap,At,As,Ao,Ar){Ao=(Ao&&" "+Ao)||"";Aq.style[((mstrmojo.dom.isWinPhone||mstrmojo.dom.isIE9||mstrmojo.dom.isIE10)?"ms":"webkit")+"Transform"]=this.createTranslateString(Ap,At,As,Ar)+Ao;},createTranslateString:function P(Ao,Ar,Aq,Ap){Ao=AF(Ao);Ar=AF(Ar);Aq=AF(Aq);return AO(Ao,Ar,Aq,Ap,"translate");},createScaleString:function v(Ao,Ar,Aq,Ap){Ao=Ao||0;Ar=Ar||0;Aq=Aq||0;return AO(Ao,Ar,Aq,Ap,"scale");},_bufferSize:200,_bufferConnects:{},attachBufferedEvent:function C(Aq,Ao,Ar,At){var Ap=Aq.id+"-"+Ao,As=this._bufferConnects[Ap];if(!As){As=this._bufferConnects[Ap]={elId:Aq.id,eventName:Ao,timer:null,bufferSize:At,listeners:[],callback:function(Au){mstrmojo.dom._callback(Au,mstrmojo.global,Ap);return true;}};this.attachEvent(Aq,Ao,As.callback);}As.listeners.push(Ar);},_callback:function Af(As,Ao,Aq){var Ar=this._bufferConnects[Aq],At=Ar&&Ar.timer;if(Ar&&!At){var Ap=(Ar.bufferSize===null)?this._bufferSize:Ar.bufferSize;if(Ar.bufferSize){Ar.timer=Ao.setTimeout(function(){mstrmojo.dom.updateBuffers(Aq);},Ap);}else{mstrmojo.dom.updateBuffers(Aq);}}},updateBuffers:function H(Ar){var As=this._bufferConnects[Ar],Ap=As&&As.listeners,Ao=(Ap&&Ap.length)||0,Aq;for(Aq=0;Aq<Ao;Aq++){Ap[Aq]();}if(As&&As.timer){delete As.timer;}},detachBufferedEvent:function AC(Ap,At,Au){if(!Ap){return ;}var Aw=Ap.id+"-"+At,Aq=this._bufferConnects[Aw],As=Aq&&Aq.listeners,Av=(As&&As.length)||0,Ar;if(Av){for(Ar=Av-1;Ar>-1;Ar--){if(As[Ar]===Au){As.splice(Ar,1);}}if(!As.length){this.detachEvent(Ap,At,Aq.callback);delete this._bufferConnects[Aw];if(Aq.timer){var Ao=mstrmojo.global;Ao.clearTimeout(Aq.timer);}}}},eventTarget:function AA(Ao,Ap){Ap=AI(Ao,Ap);return Ap.target||Ap.srcElement;},isMac:function x(){return this.getOSInfo().name.toLowerCase().indexOf("mac")>=0;},isMetaKey:function J(Ao,Ar){var Aq=this.getOSInfo().name.toLowerCase().indexOf("mac")>=0,Ap=AI(Ao,Ar)||{};return(Ap.ctrlKey&&!Aq)||(Ap.metaKey&&Aq);},ctrlKey:function Ai(Ao,Ap){return(AI(Ao,Ap)||{}).ctrlKey;},shiftKey:function AB(Ao,Ap){return(AI(Ao,Ap)||{}).shiftKey;},metaKey:function Z(Ao,Ap){return(AI(Ao,Ap)||{}).metaKey;},getButton:function AS(Ao,Ap){return((Number(AI(Ao,Ap).button))===2)?2:1;},isPrimaryMouseBtn:function Ad(Ap,Ao){return this.getButton(Ao||window,Ap)===1;},getMousePosition:function k(Ar,Aq){Aq=Aq||window;var Ap,Au;if(mstrmojo.dom.isIE){Ar=Ar||Aq.event;var As=document,Ao=As.body,At=As.documentElement;Ap=Ar.clientX+Ao.scrollLeft+(At.scrollLeft||0);Au=Ar.clientY+Ao.scrollTop+(At.scrollTop||0);}else{Ap=Ar.pageX;Au=Ar.pageY;}return{x:Ap,y:Au};},position:function AT(Ap,Aq){var At={x:0,y:0,w:0,h:0};if(Ap&&Ap.getBoundingClientRect){try{At=Ap.getBoundingClientRect();}catch(As){At={left:0,top:0,right:0,bottom:0,height:0,width:0};}At={x:At.left,y:At.top,w:At.right-At.left,h:At.bottom-At.top};if(this.isIE6||this.isIE7){var Ao=Ap.ownerDocument;if(Ao){var Av=Ao.documentElement,Au=Av.getBoundingClientRect();At.x-=Au.left;At.y-=Au.top;}}}if(Aq){var Ar=AW();At.x+=Ar.x;At.y+=Ar.y;}return At;},delta:function F(Aq,Ao){Ao=Ao||document.body;var Ap=this.position(Aq),Ar=this.position(Ao);return{x:Math.round(Ap.x-Ar.x),y:Math.round(Ap.y-Ar.y)};},windowDim:function Q(){var Ao=0,Aq=0,Ar=window,As=document,At=As.documentElement,Ap=As.body;if(typeof (Ar.innerWidth)=="number"&&typeof (Ar.innerHeight)=="number"){Ao=Ar.innerWidth;Aq=Ar.innerHeight;}else{if(At&&(At.clientWidth||At.clientHeight)){Ao=At.clientWidth;Aq=At.clientHeight;}else{if(Ap&&(Ap.clientWidth||Ap.clientHeight)){Ao=Ap.clientWidth;Aq=Ap.clientHeight;}}}return{w:Ao,h:Aq};},center:function AJ(Ao){u.call(this,Ao,V,V);},bottomCenter:function E(Ao){u.call(this,Ao,V,Aa);},clearBrowserHighlights:function K(Ao){Ao=Ao||self;if(!Ao.getSelection){var Au=Ao.document,At=Au&&Au.selection,Ar=At&&At.empty;if(Ar){try{At.empty();}catch(Aq){}}}else{var Ap=Ao.getSelection,As=Ap&&Ao.getSelection();if(As&&!As.isCollapsed){if(As.empty){As.empty();}else{if(As.removeAllRanges){As.removeAllRanges();}}}}},findAncestorByAttr:function AP(As,Aq,Ap,Ao){var At=Ap?As:As&&As.parentNode;while(At&&(At!==Ao)){var Ar=At.getAttribute&&At.getAttribute(Aq);if(Ar!=null){return{node:At,value:Ar};}At=At.parentNode;}return null;},findAncestorByName:function Ah(Aq,At,Ap,Ao){At=At&&At.toLowerCase();var Ar=Ap?Aq:Aq&&Aq.parentNode;while(Ar&&(Ar!==Ao)){var As=Ar.nodeName;if(As&&(As.toLowerCase()===At)){return Ar;}Ar=Ar.parentNode;}return null;},contains:function I(Ar,As,Ap,Ao){var Aq=As;if(!Ap){Aq=Aq.parentNode;}while(Aq){if(Aq===Ar){return true;}if(Aq===Ao){break;}Aq=Aq.parentNode;}return false;},toggleSelection:function An(Ap,Ao){Ap.setAttribute("unselectable",Ao?"off":"on");mstrmojo.css.toggleClass(Ap,"unselectable",!Ao);Ap.onselectstart=function(){return Ao;};if(!Ao){this.clearBrowserHighlights();}},preventDefault:function U(Ao,Ap){Ap=Ap||Ao.event;if(Ap.preventDefault){Ap.preventDefault();}else{Ap.returnValue=false;}},stopPropogation:function M(Ao,Ap){Ap=Ap||Ao.event;if(Ap.stopPropagation){Ap.stopPropagation();}else{Ap.cancelBubble=true;}},firstTouch:function AV(Ao,Ap){return Ap&&Ap.touches&&Ap.touches.length?Ap.touches[0]:(Ap||Ao.event);},firstChangedTouch:function Ab(Ao,Ap){return Ap&&Ap.changedTouches&&Ap.changedTouches.length?Ap.changedTouches[0]:(Ap||Ao.event);},isLandscape:function T(){return !this.supportsTouches||(Math.abs(window.orientation)===90);},findWidget:function AX(Ao){while(Ao){var Ap=Ao.mstrmojoId;if(Ap!==null&&Ap!==undefined){return mstrmojo.all[Ap];}Ao=Ao.parentNode;}return null;},setCaret:function G(Ao,Aq){if(Ao.setSelectionRange){Ao.focus();Ao.setSelectionRange(Aq,Aq);}else{if(Ao.createTextRange){var Ap=Ao.createTextRange();Ap.move("character",Aq);Ap.select();}}},setInputSelection:function Y(Ao){if(Ao.select){Ao.focus();Ao.select();}else{if(Ao.createTextRange){Ao.createTextRange().select();}}},setElementSelection:function a(Aq){if(window.getSelection){var Ao=document.createRange(),Ap=window.getSelection();Ao.selectNodeContents(Aq);Ap.removeAllRanges();Ap.addRange(Ao);}else{if(document.body.createTextRange){var Ar=document.body.createTextRange();Ar.moveToElementText(Aq);Ar.select();}}},getHorizontalScroll:function Ak(){return AW().x;},getVerticalScroll:function AD(){return AW().y;},removeNode:function Ae(Aq){var Ap=document.getElementById(Aq),Ao=Ap&&Ap.parentNode;if(Ao){return Ao.removeChild(Ap);}}});}());(function(){function D(K){var J=this.h.idx;if(J!==-1){return this.t.es[J][K];}return"";}mstrmojo.models.template.Header=mstrmojo.declare(null,null,{init:function H(J){this.h=J.h;this.t=J.t;},getName:function A(){return D.call(this,"n");},getElementId:function I(){return D.call(this,"id");},getObjectId:function B(){return D.call(this,"oid");},getElementIndex:function G(){return this.h.idx;},getActionType:function F(){return this.h.at;},isTotal:function E(){return this.h.otr===1;},getFormIndex:function C(){return this.h.fi;}});}());(function(){var A=/^mstrmojo./;mstrmojo.DynamicClassFactory={newComponent:function(C,B,F){var H=C.prototype.scriptClass.replace(A,"");for(var E=0,D=B&&B.length||0;E<D;E++){if(!B[E]._mixinName){throw new Error('Mixins must have a "_mixinName" property to be used with DynamicClassFactory');}H+="_"+B[E]._mixinName.replace(A,"");}var G=mstrmojo[H];if(!G){G=mstrmojo.declare(C,B,F);mstrmojo[H]=G;}return G;}};}());mstrmojo.EnumReadystate={IDLE:1,WAITING:3,ERROR:4,SUCCESS:5,CANCELLED:6,TIMEOUT:7};mstrmojo._ShowsStatus=mstrmojo.provide("mstrmojo._ShowsStatus",{showStatus:function showStatus(A,G,D){var C=this._STATUS;if(!this.hasRendered||!C){return ;}var E=C.style;if(!A){if(this.showingStatus){E.display="none";}}else{if(C){var F=this._STATUS_TXT;if(F){F.innerHTML=G||"";}var B=this._STATUS_BAR;if(B){B.style.width=(D||0)+"%";}if(!this.isStatusBarPositioned){E.top=Math.max((this.scrollboxHeight||0)-50,12)+"px";this.isStatusBarPositioned=true;}if(!this.showingStatus){E.display="block";}}}this.showingStatus=A;},updateStatus:function updateStatus(A,B){this.showStatus(this.showingStatus,A,B);}});(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var C=mstrmojo.EnumReadystate;function E(G){return(G.getKey&&G.getKey())||G.k;}mstrmojo._IsDocController={_mixinName:"mstrmojo._IsDocController",_getXtabCallback:function(L,H){var G={},J=G[E(L)]=L.defn,K=this,I=K.model;return I.newCallback({submission:function(){if(J.set){J.set("readyState",C.WAITING);}},success:function(N){var M=N.pukeys,O=M&&M.split("\u001E");if(M){G=I.getUnitDefinitions(M);}I.partialUpdate(N.data,G,N.defn,O,N.puFilters);},failure:function(M){if(!(mstrApp.isSingleTier&&M.code===403)){mstrmojo.alert(M.code+": "+M.message);}},complete:function(){if(J.set){J.set("readyState",C.IDLE);}K.docRequestComplete();}});},_addNodeKeyToAction:function(G,H){H.nodeKey=E(G);return H;},onGridSelector:function(H,K){var G=this.model,J=[].concat(G.getTargetInfoWin(K.ifw)).concat(G.getTargetInfoWin(K.tks));if(J&&J.length){var I;for(I=0;I<J.length;I++){G.showInfoWin(J[I],K.anchor,"h",true);}}K.sid=H.sid;G.slice(K);},onVisSelector:function(H,J){if(J.anchor){var G=this.model,I=G.getTargetInfoWin(J.tks);if(I&&I.length){G.showInfoWin(I[0],J.anchor,"h",true);}}if(H.xtabModel&&H.xtabModel.docModel&&H.xtabModel.docModel.slice){H.xtabModel.docModel.slice(J);}},isInRequest:function D(){var G=!!this._inProcess;if(!G){this._inProcess=true;}return G;},docRequestComplete:function F(){this._inProcess=false;},nudgeWidget:mstrmojo.emptyFn,getGroupByElements:function B(I){var M=[],L;while(I){L=I.node&&I.node.data&&I.node.data.pbes;if(L){break;}I=I.parent;}if(L){var J=this.model.data.elems;var H=L.length,K;for(K=0;K<H;K++){var G=L[K];M.push(isNaN(G)?G:J&&J[G]);}}return M;},setData:function A(H,J){var G=this.view,I=J;if(J&&G&&G.unloadLayouts){G.unloadLayouts(null,false);I=false;}this.model.loadLayout(H,I);if(this.hasPageBy&&this.hasPageBy()){this.getPageByTree(true);}}};}());(function(){mstrmojo.requiresCls("mstrmojo.EnumReadystate");var D=mstrmojo.EnumReadystate;var A=1200;var C=function(F,E){if(E){E.style.display=F?"block":"none";}};mstrmojo._HasWaitIcon={waitHandle:null,postBuildRendering:function B(){if(!this._rsl){var E=this.id;this._rsl=this.defn.attachEventListener("readyStateChange",E,function(G){if(!this.hasRendered){return ;}switch(G.value){case D.WAITING:if(!this.waitIcon&&this.domNode){var H=document.createElement("div");H.className="mojo-overlay-wait";H.innerHTML='<div class="overlay"></div><div class="icon"></div>';this.domNode.appendChild(H);this.addSlots({waitIcon:H});}var F=this.waitIcon;if(A){this.waitHandle=window.setTimeout(function(){if(mstrmojo.all[E]){mstrmojo.all[E].waitHandle=null;}C(true,F);},A);}else{C(true,F);}break;case D.IDLE:if(this.waitHandle){window.clearTimeout(this.waitHandle);this.waitHandle=null;}C(false,this.waitIcon);break;}});}return this._super();}};}());(function(){mstrmojo.requiresCls("mstrmojo.models.template.Header");mstrmojo.models.template.Headers=mstrmojo.declare(null,null,{init:function D(K){var O=this.isRow=K.isRow,J=this.data=K.data,L=J.gts,G=J.ghs,F=this.hs=O?G.rhs:G.chs,M=this.i=K.i,N=0,I;this.titles=O?L.row:L.col;this.headers=F.items&&F.items[M]&&F.items[M].items;if(O&&this.headers){N=this.titles.length-this.headers.length;if(N){for(I=M-1;I>=0;I--){var E=F.items[I].items,H=E.length-this.headers.length;if(H>0){this.headers=E.slice(0,H).concat(this.headers);if(this.titles.length===this.headers.length){break;}}}}}},size:function B(){var E=this.headers;return(!E?0:E.length);},getHeader:function C(H){var F=this.headers,G=F&&F[H],E=H;if(G&&mstrApp&&mstrApp.isVI){E=isNaN(G.tui)?G.ui:G.tui;}return G&&new mstrmojo.models.template.Header({h:G,t:this.titles[this.isRow?E:this.i]});},getCSS:function A(F){var E=this.headers;return E&&this.data.css[E[F].cni].n;},getHeaderCell:function(F){var E=this.headers;return E&&E[F];}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");function G(J){return(J&&J.id);}mstrmojo._HasScrollbox=mstrmojo.provide("mstrmojo._HasScrollbox",{_mixinName:"mstrmojo._HasScrollbox",scrollListeners:null,scrollListenerCount:0,scrollInterval:50,scrollboxNode:undefined,scrollTo:function F(L,K){var J=this.scrollboxNode;J.scrollLeft=L.x;J.scrollTop=L.y;if(K){this.notifyScrollListeners(L);}},connectScrollbox:function E(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(!L){L={};this.scrollListeners=L;}if(!L[J]){L[J]=K;this.scrollListenerCount++;if(this.scrollListenerCount===1){this._attachScrollDom();}}},disconnectScrollbox:function D(K){if(!G(K)){return ;}var L=this.scrollListeners,J=K.id;if(L&&L.hasOwnProperty(J)){delete this.scrollListeners[J];this.scrollListenerCount--;if(!this.scrollListenerCount){this._detachScrollDom();}}},notifyScrollListeners:function C(K){var N=K||this.getScrollPos(),M=N.y,L=N.x;this.scrollboxTop=M;this.scrollboxLeft=L;this.scrollboxRight=L+this.scrollboxWidth;this.scrollboxBottom=M+this.scrollboxHeight;var J=this.scrollListeners,O;for(O in J){J[O].onscroll(this);}},getScrollPos:function H(){var J=this.scrollboxNode;return{x:J.scrollLeft,y:J.scrollTop};},_attachScrollDom:function A(){var M=this.scrollboxNode;if(M){var L=this.usesTouches;if(!L){if(!this.scrollCallback){var K=this.id;this.scrollCallback=function(){mstrmojo.all[K].notifyScrollListeners();};}mstrmojo.dom.attachBufferedEvent(M,"scroll",this.scrollCallback,this.scrollInterval);}if(this.scrollboxTop===null){this.scrollboxTop=L?0:M.scrollTop;}if(this.scrollboxLeft===null){this.scrollboxLeft=L?0:M.scrollLeft;}var J=function(P){var O=P.toLowerCase();var N=M.style[O];return(!isNaN(N)&&N.charAt(N.length-1)!=="%")?parseInt(N,10):M["client"+P];};if(this.scrollboxHeight===null){this.scrollboxHeight=J("Height");}if(this.scrollboxWidth===null){this.scrollboxWidth=J("Width");}this.scrollboxBottom=this.scrollboxTop+this.scrollboxHeight;this.scrollboxRight=this.scrollboxLeft+this.scrollboxWidth;this._attachedScrollbox=M;}},_detachScrollDom:function I(){var J=this._attachedScrollbox;if(J&&this.scrollCallback){mstrmojo.dom.detachBufferedEvent(J,"scroll",this.scrollCallback,this.scrollInterval);}delete this._attachedScrollbox;},scrollboxTop:null,scrollboxLeft:null,scrollboxHeight:null,scrollboxBottom:null,buildRendering:function B(){this._detachScrollDom();this._super();if(this.scrollListenerCount){this._attachScrollDom();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var E=mstrmojo.dom,M=mstrmojo.hash,B,I=mstrmojo.global.document,K="mousedown",P="mousemove",R="mouseup";function G(Y){if(E.isPrimaryMouseBtn(Y)){B.startDragCheck(self,Y);}}var V,Q,A="mstrmojo-dnd-avatar",U;function F(Z,Y){if(Y!==undefined&&Y!==null){Q.innerHTML=Y;}U.left=Z.x+"px";U.top=Z.y+"px";}function L(Z,Y){if(!V){V=I.createElement("div");U=V.style;V.className=A;V.innerHTML='<div class="'+A+'-inner"></div>';Q=V.firstChild;I.body.appendChild(V);}F(Z,Y);U.display="block";}function S(){if(U){U.display="none";}}function H(Y){var Z=++B.ctxt.moveCount;if(Z>=B.minMoves){B.stopDragCheck();if((Y.buttons===1||Y.buttons===undefined||E.isIE9)&&(Y.which===1||Y.button===0||E.isIE8)){B.startDrag(self,Y);}}}function O(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDragCheck();delete B.ctxt;}}function D(Y){B.onDragMove(self,Y);}function C(Y){if(E.isPrimaryMouseBtn(Y)){B.stopDrag(window,Y);}}function N(b){var Z=mstrmojo.hash.copy(b,{}),a=Z.hWin=Z.hWin||window,Y=Z.e=Z.e||a.event;Z.node=E.eventTarget(a,Y);Z.pos=E.getMousePosition(Y,a);return Z;}function J(Z){var Y=E.findWidget(Z);while(Y){if(Y.draggable){return Y;}Y=Y.parent;}return null;}function T(Y){var a=Y.src,Z=J(a.node);if(!Z){return null;}if(Z.getDragAction){Y.action=Z.getDragAction(Y);}a.widget=Z;a.data=Z.getDragData&&Z.getDragData(Y);if(Z.isDragValid){if(!Z.isDragValid(Y)){if(!Z.shouldDragBubble||Z.shouldDragBubble(Y)!==true){Y.src.node=Z.domNode.parentNode;return T(Y);}return null;}}if(Z.ondragstart){Z.ondragstart(Y);}return Z;}function X(a,Z){var Y=E.findWidget(a),b=Z.tgt&&Z.tgt.widget;while(Y){if(Y.dropZone){if(Y===b){return Y;}if(Y.allowDrop&&Y.allowDrop(Z)){return Y;}}Y=Y.parent;}return null;}function W(){if(this.set){this.set("allowingDrop",false);}}mstrmojo.dnd=mstrmojo.dnd||mstrmojo.provide("mstrmojo.dnd",{minMoves:3,enable:function(){if(!mstrmojo.dndEnabled){E.attachEvent(I,K,G);mstrmojo.dndEnabled=true;}},disable:function(){mstrmojo.dndEnabled=false;E.detachEvent(I,K,G);},startDragCheck:function(Y,Z){delete this.ctxt;var a=N({hWin:Y,e:Z});this.ctxt={src:a,moveCount:0,last:M.copy(a.pos),getDirection:function(b){return !!this.dir[b];},getCtxtDragData:function(){var b=this.src;return(b&&b.data)||{};},getCtxtDropData:function(){var b=this.tgt;return(b&&b.data)||{};}};if(this.minMoves){E.attachEvent(I,P,H);E.attachEvent(I,R,O);}else{this.startDrag(Y,Z);}},stopDragCheck:function(){E.detachEvent(I,P,H);E.detachEvent(I,R,O);},startDrag:function(Y,b){var Z=this.ctxt;Z.id=mstrmojo.now();var a=T(Z);if(!a){return ;}E.clearBrowserHighlights(Y);E.preventDefault(self,b);E.attachEvent(I,P,D);E.attachEvent(I,R,C);var d=window.mstrApp;if(d&&d.setInteractive){this._changeAppStatus=d.setInteractive(false);}if(!a.ownAvatar){var c=Z.src;L(c.pos,c.data&&c.data.html);}},stopDrag:function(Y,f){E.detachEvent(I,P,D);E.detachEvent(I,R,C);var b=this.ctxt,a=b.tgt||{},Z=N({hWin:Y,e:f,data:a.data}),d=X(Z.node,b);Z.widget=d;b.tgt=Z;if(d){if(d.ondrop){d.ondrop(b);}else{W.call(d);}}var c=b.src.widget;if(c&&c.ondragend){c.ondragend(b);}if(c&&!c.ownAvatar){S();}if(this._changeAppStatus){window.mstrApp.setInteractive(true);delete this._changeAppStatus;}},onDragMove:function(c,f){if(E.isSafari){E.clearBrowserHighlights();}var Y=this.ctxt,b=Y.tgt||{},Z=b.widget,d=N({hWin:c,e:f,data:b.data}),j=d.widget=X(d.node,Y),h=Y.last,a=d.pos;Y.dir={x:a.x>h.x,y:a.y>h.y};Y.last=M.copy(d.pos);Y.tgt=d;if(Z!==j){if(Z){if(Z.ondragleave){Z.ondragleave(Y);}else{W.call(Z);}}if(j){Y.tgt.data=(j.getDropData&&j.getDropData(Y))||{};if(j.ondragenter){j.ondragenter(Y);}else{if(j.set){j.set("allowingDrop",true);}}}}if(j){if(j.ondragover){j.ondragover(Y);}}var g=Y.src.widget;if(g&&g.ondragmove){g.ondragmove(Y);}if(g&&!g.ownAvatar){F(d.pos);}}});B=mstrmojo.dnd;B.enable();}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var E=mstrmojo.dom;var P=mstrmojo.dom;var O="mousedown";function S(U){var T=U[U.hotSlot||"domNode"];if(T){if(!U._closeCallback){var W=U.id,V=function(X){return function(Z){var Y=mstrmojo.all[W];if(Y&&!Y.ignoreHover){Y["auto"+X](Z,self);}};};U._uncloseCallback=V("Unclose");U._closeCallback=V("Close");}E.attachEvent(T,"mouseover",U._uncloseCallback);E.attachEvent(T,"mouseout",U._closeCallback);}}function B(U){if(U._closeCallback){var T=U[U.hotSlot||"domNode"];if(T){E.detachEvent(T,"mouseover",U._uncloseCallback);E.detachEvent(T,"mouseout",U._closeCallback);}}}function F(V,U){var T=V;while(T){if(T.open||T.openPopup){if(T.set){T.set("ignoreHover",U);}else{T.ignoreHover=U;}}T=T.opener||T.parent;if(T&&T.shouldPropagateLockHover&&!T.shouldPropagateLockHover()){break;}}}function D(){var T=this._lockHoverCallback;if(T){E.detachEvent(document.body,O,T,true);delete this._lockHoverCallback;}}mstrmojo._CanAutoClose=mstrmojo.provide("mstrmojo._CanAutoClose",{autoCloses:false,autoCloseDelay:100,locksHover:false,hotSlot:null,closeOnClick:false,curtainNode:null,postBuildRendering:function Q(){this._super();if(this.autoCloses){S(this);}this.oncloseOnClickChange();},onautoClosesChange:function L(){var T=(this.autoCloses)?S:B;T(this);},oncloseOnClickChange:function H(){if(!this.curtainNode){return ;}var V=this,U="click",T=(mstrApp&&mstrApp.isTouchApp&&mstrApp.isTouchApp());if(T){U="touchstart";}E.attachEvent(V.curtainNode,U,function(){V.close();if(T){mstrmojo.touchManager.notify([]);}});},autoUnclose:function G(){var T=this._autoCloseTimer;if(T){self.clearTimeout(T);delete this._autoCloseTimer;}},autoClose:function J(){if(this.ignoreHover){return ;}if(this._autoCloseTimer){self.clearTimeout(this._autoCloseTimer);}if(this.opener){if(this.autoCloseDelay){var T=this.opener.id;this._autoCloseTimer=self.setTimeout(function(){mstrmojo.all[T].closePopup();},this.autoCloseDelay);}else{this.opener.closePopup();}}},destroy:function R(T){D.call(this);this._super(T);},lockHover:function N(){F(this,true);if(!this._lockHoverCallback){var U=this.id,T=this._lockHoverCallback=function(V){mstrmojo.all[U]._unlockHoverCheck(V,self);};if((E.isIE7||E.isIE8)&&window.event&&(window.event.type===O)&&this.opener){this.opener._ignoreMousedown=true;}E.attachEvent(document.body,O,T,true);}},unlockHover:function M(){F(this,false);D.call(this);},_unlockHoverCheck:function C(X,T){var U=this.opener;if(U&&U._ignoreMousedown){delete U._ignoreMousedown;return ;}var W=E.eventTarget(T,X);if(!P.contains(this.domNode,W,true,document.body)){var V=P.findWidget(W);while(V){if(V===this){return ;}V=V.parent||V.opener;}if(U&&U.onPopupAutoClosed){U.onPopupAutoClosed(X,T);}this.close();}},open:function I(U,T){if(this.autoCloses){this.autoUnclose();}this._super(U,T);if(this.locksHover){this.lockHover();}},close:function K(T){if(this.locksHover){this.unlockHover();}this._super(T);},shouldPropagateLockHover:function A(){return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.StringBuffer");var G=mstrmojo.dom,T=mstrmojo.hash,P=mstrmojo.array;function X(){T.forEach(this.ifwMap,function(a){a.destroy();});this.ifwMap={};}function A(){var a=[],c=null,b=null;T.forEach(this.ifwMap,function(d){if(d.visible){a.push({psId:d.psId,psKey:d.psKey,autoCloseLocks:d.autoCloseLocks,lockInfoWinId:d.lockIW?d.lockIW.id:false,anchorPos:d.anchorPosition||G.position(d.anchor,true),anchorOrn:d.anchorOrientation});}});if(a.length>0){c=this.getSelectedLayoutWidget();b=c&&c.getScrollPos();}return{ifwRecords:a,docScrollRecord:b};}function O(e){var a=(e&&e.ifwRecords)||[],b=e&&e.docScrollRecord,c=this.getSelectedLayoutWidget(),d=this,f={};if(a.length>0){if(b&&c){c.scrollTo(b);}P.forEach(a,function(g){if(g.lockInfoWinId){f.lockInfoWinId=g.lockInfoWinId;}d.showInfoWindow(g.psId,g.psKey,f,null,g.anchorOrn,g.anchorPos,g.autoCloseLocks);});}}function K(){if(mstrmojo.DICPopup&&mstrmojo.DICPopup.cancel){mstrmojo.DICPopup.cancel();}}function S(){P.forEach(this.xtabStyleSheets,function(b){var a=b.parentNode;if(a){a.removeChild(b);}});}function Z(b,e){var c=this.getLayout(b),a=c.docGroupBy,d=this.controller;if(a){a.set("data",e.groupbys);c.gb=e;}if(d.getPageByTree){d.getPageByTree(true);}}mstrmojo._IsRwDocument=mstrmojo.provide("mstrmojo._IsRwDocument",{_mixinName:"mstrmojo._IsRwDocument",updateXtabStyles:function M(g,c){var n=this.xtabStyleSheets&&this.xtabStyleSheets[0],m=this.styleList||{},b=function(u,r){var t;for(t in r){var q=r[t].css||"";if(r[t].app){q=(u[t]||"")+q;}u[t]=q;}return u;},o=document;if(!m[g]){m[g]=b({},this.model.getSelectedXtabStyles(g));}b(m[g],c);if(!this.xtabStyleSheets){this.xtabStyleSheets=[];n=this.xtabStyleSheets[0]=o.getElementsByTagName("head")[0].appendChild(o.createElement("style"));}var p=new mstrmojo.StringBuffer(),e,f;for(e in m){for(f in m[e]){p.append(m[e][f]);}p.append("\n");}var d=p.toString();if(n&&d){n=n.styleSheet||n;if(G.isWK){var l=n.firstChild;if(l){l.nodeValue=d;}else{n.appendChild(o.createTextNode(d));}}else{if(G.isIE){n.cssText=d;var k,j,a,h;for(k=1;n.rules.length===4095&&o.styleSheets.length<31;k++){j=n.rules[4094];a=new RegExp(j.selectorText,"i");h=d.search(a);if(h===-1){break;}h=d.indexOf("}",h+1);d=d.slice(h+1);if(!this.xtabStyleSheets[k]){this.xtabStyleSheets[k]=o.getElementsByTagName("head")[0].appendChild(o.createElement("style"));}n=this.xtabStyleSheets[k].styleSheet;n.cssText=d;}}else{n.innerHTML=d;}}}this.styleList=m;},postBuildRendering:function W(){var a=document.getElementsByTagName("head")[0];P.forEach(this.xtabStyleSheets,function(b){a.appendChild(b);});return this._super();},buildChildren:function B(e){var j;try{var f=this.model;if(f){var g=this.buildSubs||{},p=f.id+"-partialUpdate",b=f.id+"-rebuildLayout",l=f.id+"-updateStyles",d=f.id+"-showInfoWin",c=this.id;var k=this,o=function(){P.forEach(k.getLayouts(),function(m){if(m.k!==f.currlaykey){m.defn.loaded=false;}});};if(g[p]===undefined){var n=function a(z){var t=this.model,r=t&&t.getLayoutDataCache(t.getCurrentLayoutKey()),q=z&&z.ids;if(T.isEmpty(r)||!q){return ;}P.forEach(z.tree.layouts,function(m){if(m.k===t.currlaykey){this.updateXtabStyles(m.k,m.xtabStyles);if(m.gbys){Z.call(this,m.k,m.gbys);}return false;}return true;},this);var v=T.forEach,AA=false,w={update:q.upd,refresh:q.tgts,adjustSectionSize:q.secs};v(q.ifws,function(AC,AB){var m=mstrmojo.all[AC+"_ifw"];if(m&&m.visible){this.updateInfoWindowPS(AC,AB);}},this);v(w,function(AB,m){v(AB,function(AE,AI){var AD=mstrmojo.all[AI],AH;if(AD&&AD[m]!==undefined){var AG=r[AI],AC=(m==="update"?AG:null),AF=m;if(m==="update"){if(AD.updateForPU){AF="updateForPU";}else{AD.node=AG;}}else{if(m==="refresh"&&AD.refreshForPU){AF="refreshForPU";}}AH=AD[AF](AC);if(m==="adjustSectionSize"&&AH){AA=AA||(!!AH.heightReduced);}}},this);},this);var u=this.getSelectedLayoutWidget();if(AA){u.notifyScrollListeners();}var x=u.docLayout;if(x){x.resizeOrReposition();}if(z&&z.unloadCache){o();}};g[p]=f.attachEventListener("partialUpdate",c,n);}g[b]=g[b]||f.attachEventListener("rebuildLayout",c,function(m){var r=m&&m.restoreIW,q;if(r){q=A.call(this);this.model.aws=null;}this.onLayoutRebuilt(this.rebuildLayout(m.src.currlaykey,this.getLayouts()));if(m&&m.unloadCache){o();}if(r){O.call(this,q);}});g[l]=g[l]||f.attachEventListener("updateStyles",c,function(m){this.updateXtabStyles(m.key,m.updatedStyles);});g[d]=g[d]||f.attachEventListener("showInfoWin",c,function(m){this.showInfoWindow(m.psId,m.psKey,m.anchor,m.invalidate,m.anchorOrientation,m.anchorPosition);});this.updateXtabStyles(f.getCurrentLayoutKey());f.attachEventListener("refresh",this.id,function(){this.refresh();});}j=this._super(e);}catch(h){mstrmojo.err(h);}return j;},updateInfoWindowPS:mstrmojo.emptyFn,showInfoWindow:function J(b,t,k,m,p,q,AC){var d=this.model,g=d.getLayoutDataCache(d.getCurrentLayoutKey()),w=this.builder,a=g[b]&&g[b].defn,f=a&&a.iwpl,v=b+"_ifw",AB=mstrmojo.all[v],x=this.domNode,c=mstrmojo.DocInfoWindow.PLACEMENT.FIXED,z=function(AD,AE,AF,AH,AG){if(f===c){if(AE){var AI=G.delta(AE,x);AD.popPosition={left:(AI&&AI.x)?AH+AI.x:AH,top:(AI&&AI.y)?AG+AI.y:AG};}else{if(AF){AD.popPosition={left:(AF.scrollboxLeft)?AH-AF.scrollboxLeft:AH,top:(AF.scrollboxTop)?AG-AF.scrollboxTop:AG};}else{AD.popPosition={left:AH,top:AG};}}}};var o=this.getLayout(d.getCurrentLayoutKey());if(AB){if(m){AB.refresh();}AB.anchorOrientation=p;AB.anchorPosition=q;if(f===c&&AB._ifwpdn.style.display==="none"){AB._ifwpdn=document.getElementById(AB._ifwpdn.id);}z(AB,AB._ifwpdn,o,AB._ifwfl,AB._ifwft);AB.open(this,{anchor:k,boundary:x});}else{var h={opener:this,anchor:k,anchorOrientation:p,boundary:x,parent:this,builder:w,model:this.model,psKey:t,psId:b,id:v,autoCloses:true,locksHover:true,closeOnClick:false,autoCloseLocks:AC,anchorPosition:q};if(f){f=parseInt(f,10);h.placement=f;if(f===c){var j=a.fmts,e=h._ifwfl=j&&j.left&&parseInt(j.left.replace("px",""),10),u=h._ifwft=j&&j.top&&parseInt(j.top.replace("px",""),10),l=g[b]&&g[b].p,r=l&&d.getUnitInstance(l.k,l.wid),n=h._ifwpdn=r&&r.domNode;z(h,n,o,e,u);}}AB=w.newInfoWindow(h);this.renderInfoWindow(AB);var AA=this.ifwMap=(this.ifwMap||{});AA[b]=AB;}},renderInfoWindow:function L(a){a.render();},_lockInfoWinContainer:function I(c){var f=this.ifwMap,b=function(g,h){return function(){g.releaseLock(h);};},a;for(a in f){var d=f[a],e=c.xtab;if(d&&e&&G.contains(d.infoNode,e.domNode,true,document.body)){d.registerLock(e);c.onClose=b(d,e);break;}}},unrender:function V(a){X.call(this);this._super(a);S.call(this);},getLayouts:function Q(){return this._layouts;},getLayout:function U(a){a=a||this.model.getCurrentLayoutKey();var b=this.getLayouts();return b[P.find(b,"k",a)];},getSelectedLayoutWidget:mstrmojo.emptyFn,needLoadLayout:function R(a,b){return a.defn&&(b&&b.reload||a.defn.loaded===false||(this.model.zt&&(window.mstrMobileApp!==undefined)&&(a.defn.lastOrientation!==mstrMobileApp.getOrientation())));},getNewLayout:function F(b,g,a,k,c){var f=this,d=f.model,j=b.layoutKey,e=g[P.find(g,"k",j)];if(this.needLoadLayout(e,b)){var h=k.success;k.success=function(l){d.replaceLayout(j,l,false);d.currlaykey=j;if(a){f.selectLayout(e,false,null,c);}var m=f.rebuildLayout(j,g);if(f.controller.getPageByTree){f.controller.getPageByTree(true);}h(m);};this.loadDocLayout(b,k,c);}else{if(a){this.selectLayout(e,true,{success:function(l){T.copyProps(["bs"],l,d);}},c);}if(!e.hasRendered){e=this.rebuildLayout(j,g);if(f.controller.getPageByTree){f.controller.getPageByTree(true);}}k.success(e);}},selectLayout:function E(d,e,g,f){var a=this.model,b=d.k,c=(b!==a.currlaykey);a.currlaykey=b;if(this.controller){this.controller.updateZoom();}this.restoreLayoutState(d);if(e&&c){this.setCurrentDocLayout(b,g,f);}else{if(g&&g.complete){g.complete();}}return d;},rebuildLayout:function C(b,h){var e=this.model,d=P.find,f=h[d(h,"k",b)],a=e.getChildren(this.node,false);var g=a[d(a,"k",b)];if(window.mstrMobileApp!==undefined){g.defn.lastOrientation=mstrMobileApp.getOrientation();}var j=this.replaceLayout(f,g);this.updateXtabStyles(b,e.getSelectedXtabStyles(b));X.call(this);K();return j;},destroy:function Y(){X.call(this);if(this._super){this._super();}S.call(this);},replaceLayout:mstrmojo.emptyFn,restoreLayoutState:mstrmojo.emptyFn,onLayoutRebuilt:mstrmojo.emptyFn,unloadGbLayuts:function H(c){var h=this.getLayouts(),e=this.model.getCurrentLayoutKey(),g,f,j,b,d,a;g=this.getLayout();b=g.gb&&g.gb.groupbys;for(d=0;d<b.length;d++){j=b[d];if(j.k===c){a=j.unit.target.did;break;}}for(f=0;f<h.length;f++){g=h[f];if(g.k===e){continue;}b=g.gb&&g.gb.groupbys;if(b&&b.length){for(d=0;d<b.length;d++){j=b[d];if(j.unit.target.did===a){g.defn.loaded=false;break;}}}}},loadDocLayout:function N(a,c,b){this.model.getDataService().loadDocLayout(a,c,b);},setCurrentDocLayout:function D(a,c,b){this.model.getDataService().setCurrentDocLayout(a,c,b);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var A=false,P=mstrmojo.dom,T=16;mstrmojo._HasContextMenu=mstrmojo.provide("mstrmojo._HasContextMenu",{cm:null,cmPos:null,itemField:"n",itemIdField:"did",itemChildrenField:"items",dynamicUpdate:false,queryChecked:function(U){return false;},queryEnabled:function(U){return true;},queryVisible:function(U){return true;},executeCommand:function O(U){},item2textCss:function E(U){return U.cssClass||U.cmdId||("cmd"+U[this.itemIdField]);},showContextMenu:function J(){if(!A){mstrmojo.requiresCls("mstrmojo.ContextMenu");A=true;}var a=this._subMenu,Y=this.getMenuPosition();if(!a){var c=(this.menuZIndex||this.zIndex||10)+1,W={left:Y.x+"px",top:Y.y+"px",zIndex:c,visible:false,dynamicUpdate:this.dynamicUpdate,itemField:this.itemField,itemIdField:this.itemIdField,itemChildrenField:this.itemChildrenField,_cmSource:this.getContextMenuSource(),items:this.getContextMenuItems(),cssClass:this.getContextMenuCssClass(),placeholder:document.body.appendChild(document.createElement("div")),parent:this};a=new mstrmojo.ContextMenu(W);a.render();this._subMenu=a;}else{a.set("left",Y.x+"px");a.set("top",Y.y+"px");}if(this.dynamicUpdate){var V=a.ctxtBuilder.itemWidgets,X=V&&V.length,U,Z,b=this.getContextMenuSource();for(U=0;U<X;U++){Z=V[U];if(b.queryVisible){Z.set("visible",b.queryVisible(Z.data));}if(b.queryChecked){Z.set("checked",b.queryChecked(Z.data));}if(b.queryEnabled){Z.set("enabled",b.queryEnabled(Z.data));}}}a.set("visible",true);this.callOnContextMenuOpen();this.adjustMenuPosition();this.attachMousedownEvent();},hideContextMenu:function I(){var U=this._subMenu;if(U&&U.visible){this._subMenu.set("visible",false);this.callOnContextMenuClose();}},adjustMenuPosition:function N(){var U=this._subMenu,X=this._subMenu.domNode,W=X.offsetHeight,V=X.offsetWidth,a=P.windowDim(),Z=P.position(X,false),Y=P.position(X,true);if((Z.x+V+T)>a.w){U.set("left",(a.w-V-T+(Y.x-Z.x))+"px");}if((Z.y+W+T)>a.h){U.set("top",(a.h-W-T+(Y.y-Z.y))+"px");}},attachMousedownEvent:function L(){var U=this;if(!this._close_handler){this._close_handler=function(V){U.closeMenuHandler(V);};}P.attachEvent(document.body,"mousedown",this._close_handler);},closeMenuHandler:function Q(U){if(!this.isOnMySubmenu(P.eventTarget(self,U))){this.closeMenuTree();}},isOnMySubmenu:function M(Y){var V=this._subMenu;if(!V){return false;}if(P.contains(V.domNode,Y,true,document.body)){return true;}var Z=V.ctxtBuilder.itemWidgets,U=Z&&Z.length,X,W;for(X=0;X<U;X++){W=Z[X];if(W.isOnMySubmenu(Y)){return true;}}return false;},callOnContextMenuOpen:function D(){if(this.onContextMenuOpen){this.onContextMenuOpen();}},callOnContextMenuClose:function C(){if(this.onContextMenuClose){this.onContextMenuClose();}},getContextMenuItems:function S(){return this.cm;},getContextMenuCssClass:function B(){return this.cmCssClass||"";},getContextMenuSource:function H(){return this;},getMenuPosition:function F(){if(this.cmPos){return this.cmPos;}var U=P.position(this.domNode,true);return{x:Math.round(U.x),y:Math.round(U.y+U.h)};},isSeparatorItem:function G(U){return U[this.itemIdField]===-1||U[this.itemField]==="-";},hasSubmenu:function K(U){return !!U[this.itemChildrenField];},closeMenuTree:function R(W){var V=this.activeMenuItem,U=this._cmSource||this;if(!V){if(W){this.activeMenuItem=W;}else{U.hideContextMenu();}return ;}if(V===W){return ;}if(W){this.activeMenuItem=W;if(W.parent.parent===V){return ;}if(W.parent===V.parent){V.hideContextMenu();return ;}}else{W=U;this.activeMenuItem=null;}V.hideContextMenu();while(V!==U){V=V.parent.parent;if(V!==W||U===W){V.hideContextMenu();if(U===W){P.detachEvent(document.body,"mousedown",this._close_handler);}}if(V.parent===W.parent){break;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;function D(J,I){var G=[];if(J){var F;for(F in J){var H=Number(F);if(H>=I){G.push(H);}}}G.sort(mstrmojo.array.numSorter);return G;}mstrmojo.ListSelector=mstrmojo.provide("mstrmojo.ListSelector",{premousedown:function E(L,F,N){if(C.isPrimaryMouseBtn(N.e)){var I=N.hWin,J=N.e,G=C.eventTarget(I,J),M=L.listMapper.findIndex(L,F,G);if(M>-1){var H=L.multiSelect,K=C.ctrlKey(I,J),O=C.shiftKey(I,J);if(K||O){C.clearBrowserHighlights(I);}if(H&&(K||(L.selectionPolicy==="toggle"))){L.toggleSelect(M);}else{if(H&&O){L.rangeSelect(M);}else{L.singleSelect(M);}}}}},premouseup:function B(H,K,G){var F=G.hWin,J=G.e,L=C.ctrlKey(F,J),I=C.shiftKey(F,J);if(L||I){C.clearBrowserHighlights(F);}},onadd:function A(I,H){var M=H&&H.value&&H.value.length;if(M){var G=H.index,K=I.selectedIndices,L=D(K,G),J;for(J=L.length-1;J>-1;J--){var F=L[J];K[F+M]=true;delete K[F];}if(I.selectedIndex>=G){I.selectedIndex+=M;}}},onremove:function A(Q,S){var O=S&&S.value&&S.value.length;if(O){var R=S.index,I=R+O-1,M=Q.selectedIndices,L=Q.selectedIndex,G=[],T=[],P=false;if(M){var H;for(H in M){var K=Number(H);if(K>I){G.push(K);}else{if(K>=R){T.push(K);P=true;}}}}G.sort(mstrmojo.array.numSorter);var J,N;for(J=0,N=G.length;J<N;J++){var F=G[J];M[F-O]=true;delete M[F];}if(L>I){Q.selectedIndex-=O;}if(P){Q.removeSelect(T);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;mstrmojo.ui._IsIncFetchList=mstrmojo.provide("mstrmojo.ui._IsIncFetchList",{_mixinName:"mstrmojo.ui._IsIncFetchList",ifDataHelper:null,supportsIncFetch:false,isFetching:false,initScroll:function A(){var G=this.ifDataHelper,F=this,E=this.scrollNode||this.domNode;this.supportsIncFetch=G&&G.hasNext();if(G&&this.supportsIncFetch){this._scroll=function D(){if(E.offsetHeight+E.scrollTop>=E.scrollHeight){F.raiseEvent({name:"incFetch",id:F.id});}};C.attachEvent(E,"scroll",this._scroll);this.attachEventListener("incFetch",this.id,function(H){if(!this.supportsIncFetch||this.isFetching){return ;}if(this.preNext){this.preNext();}this.set("isFetching",true);G.next({complete:function(I){if(F.postNext){F.postNext();}F.set("isFetching",false);},success:function(I){F.addItems(I.items);},failure:function(I){F.supportsIncFetch=false;mstrmojo.alert("Error in fetching next: "+I);}});});}},addItems:function B(D){if(this._super){this._super(D);}if(!this.ifDataHelper.hasNext()){this.supportsIncFetch=false;var E=this.scrollNode||this.domNode;C.detachEvent(E,"scroll",this._scroll);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");var D=mstrmojo.dom,L=mstrmojo.hash;var O=100;var F=D.supportsTouches?0.5:1;var G=1;var R=100;var P={onvscrollVisibleChange:function(){var U=this.vscrollNode,V=U&&U.style;if(!V){return ;}if(this.vscrollVisible){var T=this.maxPos,W=this.clientSize;V.height=Math.round(W.y*W.y/T.y)+"px";V.left=(W.x-5)+"px";V.display="block";V.opacity=0.5;}else{V.opacity=0;}},onhscrollVisibleChange:function(){var V=this.hscrollNode,U=V&&V.style;if(!U){return ;}if(this.hscrollVisible){var T=this.maxPos,W=this.clientSize;U.width=Math.round(W.x*W.x/T.x)+"px";U.top=(W.y-5)+"px";U.display="block";U.opacity=0.5;}else{U.opacity=0;}}};var M=L.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,W=0;if(this.scrollsVert){W=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style[D.CSS3_TRANSFORM]="translateY("+Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px)";}}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style[D.CSS3_TRANSFORM]="translateX("+Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px)";}}this.scrollChild.style[D.CSS3_TRANSFORM]="translate3d(-"+parseInt(T,10)+"px, -"+parseInt(W,10)+"px, 0px)";},ondeceleratingChange:function(){this.scrollChild.style[D.CSS3_TRANSITION]=this.decelerating?(D.CSS3_PREFIX+"transform 0.2s linear"):"";}},L.copy(P));var H=L.copy({onposChange:function(){var V=this.clientSize,U=this.maxPos,T=0,X=0,W=this.scrollboxNode;if(this.scrollsVert){X=this.pos.y;if(this.vscrollVisible){this.vscrollNode.style.top=Math.round((V.y-(V.y*V.y/U.y))*this.pos.y/U.y)+"px";}W.scrollTop=parseInt(X,10);}if(this.scrollsHoriz){T=this.pos.x;if(this.hscrollVisible){this.hscrollNode.style.left=Math.round((V.x-(V.y*V.x/U.x))*this.pos.x/U.x)+"px";}W.scrollLeft=parseInt(T,10);}}},L.copy(P));mstrmojo._TouchScrolling=mstrmojo.provide("mstrmojo._TouchScrolling",{FRICTION:0.65,BOUNCEFRICTION:0.5,usesTouches:false,bounces:true,scrollsHoriz:true,scrollsVert:true,pos:null,preBuildRendering:function N(){this.usesTouches=(mstrmojo.dom.supportsTouches&&this.usesTouches&&(this.scrollsHoriz||this.scrollsVert));if(this.usesTouches){this.pos={x:0,y:0};}if(this._super){this._super();}},postBuildRendering:function C(){if(this._super){this._super();}if(this.usesTouches){var W=this.scrollboxNode,V=this.itemsContainerNode||W.firstChild;if(W&&W!==V){this.scrollChild=V;var T=W.style;T.position="relative";T.overflow="hidden";var U=V.style;U.position="absolute";U.left=0;U.top=0;this.markupMethods=L.copy(D.isSafari?M:H,L.copy(this.markupMethods));this.attachTouchEvents();}}},unrender:function(T){if(this.usesTouches){this.detachTouchEvents();}this._super(T);},attachTouchEvents:function(){var U=this.touchNode||this.scrollboxNode;if(U){if(!this._tsCallback){var T=this;this._tsCallback=function(V){T.touchesBegin(self,V);};this._tmCallback=function(V){T.touchesMoved(self,V);};this._teCallback=function(V){T.touchesEnd(self,V);};}D.attachEvent(U,D.TOUCHSTART,this._tsCallback);this._tsNode=U;}},detachTouchEvents:function(){var T=this._tsNode;if(T){D.detachEvent(T,D.TOUCHSTART,this._tsCallback);delete this._tsNode;}},touchesBegin:function J(T,V){var U=V.target&&V.target.tagName;if(U&&(U==="SELECT"||U==="INPUT")){return ;}D.preventDefault(T,V);this.stopDeceleration();this.startTime=new Date();this.startTimePos={x:this.pos.x,y:this.pos.y};this.startTouchPos=D.getMousePosition(D.firstTouch(T,V),T);this.dragging=false;D.attachEvent(window,D.TOUCHMOVE,this._tmCallback);D.attachEvent(window,D.TOUCHEND,this._teCallback);},touchesMoved:function E(b,d){var Z=D.getMousePosition(D.firstTouch(b,d),b);D.preventDefault(b,d);if(!this.dragging){var T=5,h=Math.abs;if((this.scrollsHoriz&&h(Z.x-this.pos.x)>T)||(this.scrollsVert&&h(Z.y-this.pos.y)>T)){this.dragging=true;this.dragStartTime=new Date();this.startTouchPos=Z;var V=this.scrollboxNode,Y={x:V.clientWidth,y:V.clientHeight},f={x:V.scrollWidth,y:V.scrollHeight};this.clientSize=Y;this.scrollSize=f;this.maxPos={x:Math.max(f.x-Y.x,0),y:Math.max(f.y-Y.y,0)};this.showScroll();}}if(this.dragging){D.stopPropogation(b,d);var c=this.startTimePos,X=this.startTouchPos,a=this.maxPos;var W={x:this.scrollsHoriz?Math.max(Math.min(c.x-(Z.x-X.x),a.x),0):0,y:this.scrollsVert?Math.max(Math.min(c.y-(Z.y-X.y),a.y),0):0};this.set("pos",W);this.nextLastDragPos=this.lastDragPos;this.lastDragPos=Z;var U=new Date(),g=this.lastDragTime;this.nextLastDragTime=g;this.lastDragTime=U;if((U-g)>R){this.startTime=this.lastDragTime;this.dragStartTime=this.startTime;this.startTimePos={x:W.x,y:W.y};this.startTouchPos=Z;}}},touchesEnd:function I(T,U){D.preventDefault(T,U);D.detachEvent(window,D.TOUCHMOVE,this._tmCallback);D.detachEvent(window,D.TOUCHEND,this._teCallback);if(this.dragging){this.dragging=false;D.stopPropogation(T,U);if((new Date())-this.lastDragTime<=R){this.startDeceleration(T,U);}else{this.hideScroll();}}},startDeceleration:function B(Y,Z){var W=D.getMousePosition(D.firstChangedTouch(Y,Z),Y),c=((mstrmojo.dom.supportsTouches===null)?this.lastDragPos:this.nextLastDragPos)||W,b={x:W.x-c.x,y:W.y-c.y},T=((mstrmojo.dom.supportsTouches===null)?this.lastDragTime:this.nextLastDragTime),d=T?(new Date())-T:0,V={x:d?Number(b.x*O*F/d).toFixed(2):0,y:d?Number(b.y*O*F/d).toFixed(2):0};var a=this,U=function(e){return(a.scrollsHoriz&&Math.abs(e.x)>=G)||(a.scrollsVert&&Math.abs(e.y)>=G);};if(U(V)){this.velocity=V;this.friction={x:this.FRICTION,y:this.FRICTION};this.set("decelerating",true);var X=function(){a.decelerate();if(!U(a.velocity)){a.stopDeceleration();a=null;}};X();if(this.decelerating){this.decelerationTimer=window.setInterval(X,O);}}else{this.hideScroll();}},stopDeceleration:function A(){this.set("decelerating",false);delete this.velocity;if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}this.hideScroll();},decelerate:function S(){var W=this.pos,V=this.velocity,U=this.friction,Z=this.maxPos,X={x:W.x-V.x,y:W.y-V.y},b=this.bounces,T=this.BOUNCEFRICTION;var a=X.x;if(a<0||a>Z.x){X.x=(a<0)?0:Z.x;V.x*=b?-T:0;U.x=T;}var Y=X.y;if(Y<0||Y>Z.y){X.y=(Y<0)?0:Z.y;V.y*=b?-T:0;U.y=T;}this.set("pos",X);this.velocity={x:U.x*V.x,y:U.y*V.y};},hideScroll:function K(){this.set("vscrollVisible",false);this.set("hscrollVisible",false);},showScroll:function Q(){var T=this.maxPos;if(this.scrollsVert&&T.y&&this.vscrollNode){this.set("vscrollVisible",true);}if(this.scrollsHoriz&&T.x&&this.hscrollNode){this.set("hscrollVisible",true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var G=mstrmojo.dom,H=Math;var D=1,F=2,J=4,E=5,A=6;function B(q){var M=this.anchor;if(!M){return false;}var V=this.baseTipClass,W=this[this.tipNodeName];W.className=V+" top";var h=this[this.boundaryNodeName],v=this[this.popupNodeName],f=this.anchorOffset,t=this.anchorOrientation,p=this.hasScrollbars(),c=mstrmojo.hash.copy(this.anchorPosition||G.position(M,true)),P=G.position(h,true),AA=P.w,N=P.h,j=v.offsetWidth,R=v.offsetHeight,Z=j/2,K=R/2,b=G.position(W),n=H.min(b.h,b.w),T=H.max(b.h,b.w)/2,l=parseInt(this.placement,10);if(q){c=G.position(M,true);}if(p){AA-=15;N-=15;}var d=G.contains(h,v),o=d?0:P.y,z=AA/2-Z,U=N/2-K+o,u=-1000,AB=-1000,O,m=["borderBottomColor","borderTopColor","borderRightColor","borderLeftColor"],AC=0;if(d){c.x=c.x-P.x;c.y=c.y-P.y;}var k=c.y+c.h,Q=c.x+c.w,w=((Q+j)<AA),X=c.y>R,r=((k+R)<N),a=function(AD,AF,AE){return H.min(H.max(AD,AE),H.max(AF,0));},S=function(){if((c.x<AA)&&(r||X)){var AD=c.x+(c.w/2),AE=(l===J&&r)||!X;if(AE){O="top";AB=k;AC=0;U=k+n-f;}else{O="bottom";AB=c.y-n;AC=1;U=AB-R+f;}z=a(0,AA-j,AD-Z);u=a(c.x,Q,AD)-T;return true;}return false;},g=function(){if((c.y<N)&&(w||c.x>j)){var AD=c.y+(c.h/2),AE=!(l===E&&c.x>j)&&w;if(AE){O="left";u=Q;AC=2;z=Q+n-f;}else{O="right";u=c.x-n;AC=3;z=u-j+f;}U=a(o,N-R,AD-K);AB=a(c.y,k,AD)-T;return true;}return false;},Y=[S,g],x=0;if(l===F){U=this.popPosition.top;z=this.popPosition.left;AB=-1000;u=-1000;O=null;}else{if(l===E||l===A||(l===D&&t==="h")){Y.reverse();}for(x;x<2;x++){if(Y[x]()){break;}}U=H.round(U);z=H.round(z);AB=H.round(AB);u=H.round(u);}W.className=V+" "+(O||"hidden");var e=W.style,L=v.style;e.top=AB+"px";e.left=u+"px";if(this.tipNodeColor){mstrmojo.array.forEach(m,function(AD){e[AD]="";});e[m[AC]]=this.tipNodeColor;}L.top=U+"px";L.left=z+"px";return true;}mstrmojo._IsAnchorable={anchor:null,anchorPosition:null,boundaryNodeName:"curtainNode",popupNodeName:"editorNode",tipNodeName:"tipNode",baseTipClass:"mstrmojo-Editor-tip",anchorOffset:25,anchorOrientation:"v",placement:D,popPosition:null,hasScrollbars:function C(){return(!mstrApp.isTouchApp||!mstrApp.isTouchApp());},prepareAnchor:mstrmojo.emptyFn,positionDialog:function I(K){this.prepareAnchor();if(!B.apply(this,[K])){if(typeof this._super==="function"){this._super();}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var B="mstrmojo-floating-toolbar-lightbox";var G="mstrmojo-floating-toolbar";var M="mstrmojo-floating-toolbar-cell";var I="mstrmojo-fixed-toolbar-lightbox";var A="mstrmojo-fixed-toolbar";var N="mstrmojo-fixed-toolbar-cell";var H=" hasToolBar";var E="mstrmojo-Button mstrmojo-InteractiveButton mstrmojo-oivmSprite ";var D="mstrmojo-Button-text";var L=27;mstrmojo._HasToolbar=mstrmojo.provide("mstrmojo._HasToolbar",{_mixinName:"mstrmojo._HasToolbar",postBuildRendering:function C(){this._super();var O=this.getToolbarCfg();if(!O||this.defn.ttl){return ;}var S=this.containerNode;if(S){var Q=this._createToolbar(G,M);Q.className=B;S.className+=H;S.insertBefore(Q,S.firstChild);var P=this.domNode,R=mstrmojo.boxmodel.offset(P,this.parent&&this.parent.domNode);if(R.top<L){Q.style.top=(L-R.top)+"px";}}},_createToolbar:function F(V,a){var S=this.getToolbarCfg(),Y=this,W=document,P=W.createElement("div"),U=W.createElement("table"),X=W.createElement("tr"),R=W.createElement("td");P.appendChild(U);U.className=V;R.className=a;X.appendChild(R);U.appendChild(X);var Z=function(b){Y.onClick(b);},T;for(T in S){var O=W.createElement("div");O.className=E+S[T].css[0];var Q=W.createElement("div");Q.className=D;Q.nodeValue="&nbsp;";Q.setAttribute("ix",T);Q.setAttribute("cix","0");O.appendChild(Q);R.appendChild(O);O.onclick=Z;}return P;},renderToolbar:function K(Q){if(!this.getToolbarCfg()){return ;}var P=Q.firstChild,O=this._createToolbar(A,N);O.className=I;if(P){Q.insertBefore(O,P);}else{Q.appendChild(O);}},onClick:function J(U,P){var V=mstrmojo.dom,O=V.eventTarget(P,U),S=O.getAttribute("cix"),R=O.getAttribute("ix");var Q=this.toolbarCfg[R],T=Q.callback;if(T&&this[T]&&this[T]()){S=++S%Q.css.length;O.parentNode.className=E+Q.css[S];O.setAttribute("cix",S);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var I=1,C=2;function E(P){var Q=this.defn,R=Q.vc,S=Q.hc;if(!P||P.length===0||(!R&&!S)){return{};}return{v:!!R,h:!!S};}function B(P){return parseInt(this.getFormats()[(P===I)?"height":"width"],10);}function H(Q){var P=this.getFormats()["max-"+((Q===I)?"height":"width")];return P&&parseInt(P,10);}function G(T,S){var Q=this.defn,R=T&&(T.dimNode||T.domNode),P=Q.ck&&Q.ck[T&&(T.k||T.content.k)];if(R&&P&&(P&S)>0){return R;}return null;}function F(Q,T,S,Y){var P=parseInt(S.style[(T===I)?"top":"left"],10)||(Q.fmts&&parseInt(Q.fmts[(T===I)?"top":"left"],10))||0;if(!!Y){return P+Y;}var R=(Q.fmts&&Q.fmts.fx)||{},U=(!J.isIE7&&(R.rt===1||R.rt===3))?((T===I)?C:I):T,W=(U===I)?"Height":"Width";Y=S["offset"+W]+(R.ds||0);if(!J.isDXIE&&((T===I&&R.rt===3)||(T===C&&R.rt===1))){P=P-Y;}var V=P+Y;if(J.isIE7&&W==="Width"&&Q instanceof mstrmojo.XtabBase){var X=Q.contentNode.offsetWidth;if(V<X){V+=X;}}return V;}function L(P,Q,R){if(P>Q){if(R){P=Math.min(P,R);}return P;}return Q;}function D(V,T,U){var P=this.getCanGrowShrinkNode(),R=(V===I)?"Height":"Width",Q=R.toLowerCase(),S=parseInt(P.style[Q],10);if(T&&T!==S&&!(T<S&&!!U)){S=T;P.style[Q]=S+"px";this.afterCanGrowShrink();}this["_fixed"+R]=S;}function A(W,S,U){var V=H.call(this,S),X=B.call(this,S),T=W.length,Q;for(Q=0;Q<T;Q++){var P=W[Q],R=G.call(this,P,S);if(!R){continue;}X=L(F.call(this,P,S,R),X,V);if(X===V){break;}}D.call(this,S,X,U);}function O(U,T,Q,S){var R=G.call(this,U,T);if(!R){return ;}var P=F.call(this,U,T,R,Q);D.call(this,T,L(P,B.call(this,T),H.call(this,T)),S);}mstrmojo._CanGrowOrShrink=mstrmojo.provide("mstrmojo._CanGrowOrShrink",{getCanGrowShrinkNode:function N(){return this.domNode;},performCanGrowCanShrink:function M(Q,R){var P=E.call(this,Q);if(P.v){A.call(this,Q,I,R);}if(P.h){A.call(this,Q,C,R);}},fixedSizeCanGrowShrink:function K(V,P,T,U){var R=E.call(this,V&&[V]);var S=parseInt(P,10),Q=parseInt(T,10);if(R.v&&!isNaN(S)){O.call(this,V,I,S,U);}if(R.h&&!isNaN(Q)){O.call(this,V,C,Q,U);}},afterCanGrowShrink:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx={enabled:true};var E=mstrmojo.dom;mstrmojo.fx._Effect=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.fx._Effect",duration:500,interval:50,delay:null,target:null,getTarget:null,widget:null,slot:null,preStart:null,postStart:null,onCancel:null,onEnd:null,revertOnCancel:true,isPlaying:false,started:false,init:function R(W){mstrmojo.hash.copy(W,this);},play:function C(){this.isPlaying=true;this.started=false;if(this.delay){var W=this;this.delayTimer=window.setTimeout(function(){W._start();W=null;},this.delay);}else{this._start();}},pause:function H(){if(this.delayTimer){window.clearTimeout(this.delayTimer);delete this.delayTimer;}if(this.timer){window.clearInterval(this.timer);delete this.timer;}this.isPlaying=false;},cancel:function U(){this.pause();if(this.started){if(this.revertOnCancel){this.counter=0;this.exec();}if(this.onCancel){this.onCancel();}this.started=false;}},_start:function F(){this.started=true;this._doTarget();this.steps=Math.max(Math.ceil(this.duration/this.interval),1);var W=this.ease;if(typeof W==="string"){this.ease=mstrmojo.registry.ref(W);}if(this._doPreStart()===false){this.started=false;this.isPlaying=false;return ;}this.counter=0;this.exec();this.counter++;this._doPostStart();if(this.counter>=this.steps){this._end();}else{var X=this;if(this.timer){window.clearInterval(this.timer);}this.timer=window.setInterval(function Y(){if(X){X.exec();X.counter++;if(X.counter>=X.steps){X._end();X=null;}}},this.interval);}},exec:null,_end:function D(){this.pause();this.started=false;if(this.onEnd){this.onEnd();}},_doTarget:function T(){if(this.getTarget){this.target=this.getTarget();}else{if(this.widget){this.target=this.widget[this.slot||"domNode"];}else{if(this.target){var X=this.target;if(X&&this.slot&&X.scriptClass){var Y=X[this.slot];if(Y){this.widget=X;this.target=Y;}}}}}if(!this.target){var W=this;while(W=W.parent){if(!W||W.domNode){break;}}if(W){this.widget=W;this.target=W[this.slot||"domNode"];}}},_doPreStart:function N(){if(this.preStart){return this.preStart();}},_doPostStart:function S(){if(this.postStart){this.postStart();}}});function M(Z,a){var X=Z.children,W=(X&&X.length)||0,Y;for(Y=0;Y<W;Y++){X[Y][a]();}}mstrmojo.fx.Parallel=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Parallel",init:function R(Z){this._super(Z);var Y=this.children;mstrmojo.registry.refArray(Y);var W=(Y&&Y.length)||0,X;for(X=0;X<W;X++){Y[X].parent=this;}},_start:function F(){this.started=true;if(this.preStart){this.preStart();}M(this,"play");if(this.postStart){this.postStart();}},pause:function H(){M(this,"pause");},cancel:function U(){M(this,"cancel");}});mstrmojo.fx.AnimateProp=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.AnimateProp",props:null,_start:function O(){var Y=this.props,Z;for(Z in Y){var X=Y[Z],W=X.ease;if(typeof W==="string"){X.ease=mstrmojo.registry.ref(W,{dontInst:true});}}this._super();},exec:function P(){var Z=this.props,a;for(a in Z){var X=Z[a],W=(X.ease||mstrmojo.ease.sin)(this.counter,X.start,X.stop-X.start,this.steps-1);if(X.fn){W=X.fn(W);}if(X.suffix){W+=X.suffix;}var Y=X.isStyle===false?this.target:this.target.style;Y[a]=W;}}});mstrmojo.fx.Typewriter=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Typewriter",charGroupSize:1,srcProp:"text",_doPreStart:function(){this._super();this._dynStop=false;if(this.stop==null){var a=this.srcProp,Y;if(a){var W=this.widget||this.parent;Y=W&&W[a];if((Y!=null)&&(typeof (Y)!=="string")){Y=String(Y);}}this.stop=Y;this._dynStop=true;}if(this.stop==null){this.stop="";}var Z=this.target,b=null,X=1;if(Z){Z.innerHTML="";b=document.createTextNode("");Z.appendChild(b);X=Math.max(Math.floor(this.stop.length/this.steps),1);}this.targetTextNode=b;this.charGroupSize=X;},exec:function(){var X=this.targetTextNode;if(!X){return ;}var W;if(this.counter>=this.steps-1){W=this.stop;}else{if(this.counter===0){W="";}else{W=this.stop.substring(0,this.charGroupSize*this.counter)+"_";}}X.nodeValue=W;},_end:function D(){this._super();if(this._dynStop){this.stop=null;delete this._dynStop;}},cancel:function U(){if(this._dynStop){this.stop=null;delete this._dynStop;}}});mstrmojo.requiresCls("mstrmojo.dom");mstrmojo.fx.Fade=mstrmojo.declare(mstrmojo.fx._Effect,null,{scriptClass:"mstrmojo.fx.Fade",start:null,stop:null,ease:null,suffix:null,exec:function P(W){if(W==null){W=(this.ease||mstrmojo.ease.sin)(this.counter,this.start,this.stop-this.start,this.steps-1);}if(E.isIE&&!E.isWinPhone){this.target.style.filter="alpha(opacity="+parseInt(W*100,10)+")";}else{this.target.style.opacity=W;}}});mstrmojo.fx.FadeOut=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeOut",start:1,stop:0,revertOnCancel:true,cssDisplay:"block",_end:function D(){if(this.cssDisplay){this.target.style.display="none";this.exec(this.start);}this._super();},cancel:function U(){if(this.started&&this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();}});mstrmojo.fx.FadeIn=mstrmojo.declare(mstrmojo.fx.Fade,null,{scriptClass:"mstrmojo.fx.FadeIn",start:0,stop:1,revertOnCancel:true,cssDisplay:"block",_doPostStart:function V(){if(this.cssDisplay){this.target.style.display=this.cssDisplay;}this._super();},cancel:function(){if(this.started&&this.revertOnCancel&&this.cssDisplay){this.target.style.display="none";}this._super();}});function I(Y,X,Z){var W=Math.pow(10,Z||2);if(X){return parseInt(W*Y/X,10)/W;}return parseInt(W*Y,10)/W;}mstrmojo.ease={linear:function L(X,W,Z,Y){if(X===Y){return W+Z;}if(X===0){return W;}return W+Z*I(X,Y);},sin:function A(X,W,Z,Y){return W+Z*Math.sin((Math.PI/2)*X/Y);},cos:function B(X,W,Z,Y){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},sincos:function K(X,W,Z,Y){if(X>Y/2){return W+Z*Math.cos((Math.PI/2)*(1-X/Y));}return W+Z*Math.sin((Math.PI/2)*X/Y);},cossin:function Q(X,W,Z,Y){if(X>Y/2){return W+Z*Math.sin((Math.PI/2)*X/Y);}return W+Z*Math.cos((Math.PI/2)*(1-X/Y));},bounce:function G(X,W,Z,Y){if((X/=Y)<(1/2.75)){return Z*(7.5625*X*X)+W;}if(X<(2/2.75)){return Z*(7.5625*(X-=(1.5/2.75))*X+0.75)+W;}if(X<(2.5/2.75)){return Z*(7.5625*(X-=(2.25/2.75))*X+0.9375)+W;}return Z*(7.5625*(X-=(2.625/2.75))*X+0.984375)+W;},shake:function J(X,W,Z,Y){if(X<Y/2){return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*X/Y;}return W+Z*I(Math.sin(2*Math.PI*X/8),null,2)*2*(1-X/Y);}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var C=mstrmojo.dom;mstrmojo._FillsBrowser=mstrmojo.provide("mstrmojo._FillsBrowser",{_mixinName:"mstrmojo._FillsBrowser",getBrowserDimensions:function E(G){if(G){return{w:G.innerWidth,h:G.innerHeight};}var F=C.windowDim(),H=(C.isFF||C.isWK)?0:2;return{w:Math.max(F.w,0)+"px",h:Math.max(F.h-H,0)+"px"};},preBuildRendering:function A(){var H=this._super(),G=this.getBrowserDimensions();if(!this.browserResized||this.browserResized(G)!==true){this.height=G.h;this.width=G.w;}if(!this._listenerProc){window._monitor=this;var I=this.id,F=this._listenerProc=function(K){var J=K||window.event;mstrmojo.all[I].monitorWindow(J);};C.attachEvent(window,"resize",F);}return H;},destroy:function B(F){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(F);},monitorWindow:function D(F){var I=F.currentTarget,H=this.getBrowserDimensions(),G={w:(I?I.innerWidth+"px":H.w),h:(I?I.innerHeight+"px":H.h)};if((G.h===this.height&&G.w===this.width)||parseInt(G.h,10)<=20||parseInt(G.w,10)<=20){return ;}if(!this.browserResized||this.browserResized(G,true)!==true){if(G.h!==this.height){this.set("height",G.h);}if(G.w!==this.width){this.set("width",G.w);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array");var H=mstrmojo.array,G=mstrmojo.dom;mstrmojo._IsDocXtab={_mixinName:"mstrmojo._IsDocXtab",isDocXtab:true,formatHandlers:{domNode:["RW","T","font"],msgNode:["height","background-color"],viewport:["D","background-color","B","fx"]},preBuildRendering:function B(){var I=this.getFormats(),L="",K=function K(M){if(I[M]){var N=this[M]||I[M];this[M]=N;if(this.isFullScreenWidget){I[M]=N;}this[M+"Limit"]=parseInt(N,10);}};K.call(this,"height");K.call(this,"width");var J=function(P,O){var M=I[P];if(M&&M.charAt(M.length-1)!=="%"){var N=parseInt(M,10);if(!isNaN(N)){if(O){N-=O;}L+=P+":"+N+"px;";}}return null;};J("height",0);J("width",0);this.scrollboxNodeCssText=L;return this._super();},postBuildRendering:function D(){var J=this._super();var I=this.gridData;if((I.afw||I.afc)&&this.hasCustomScrollbar&&!this.node.data.eg&&this.scrollboxNode.firstChild){this.scrollboxNode.firstChild.style.width=this.getFormats().width;}return J;},resize:function A(){this.clearCache();var K=this.getFormats(),J=parseInt(K.height,10),I=parseInt(K.width,10);if(I>0&&J>0){if(!this.visible&&this.forcedHidden){this.set("visible",true);this.forcedHidden=false;}H.forEach([this.scrollboxNode,this.viewport],function(M){var L=M.style;L.height=J+"px";L.width=I+"px";});if(this.scrollboxNode){this.scrollboxHeightFixed=J&&(J!=="auto");if(this.scrollboxHeightFixed){this.scrollboxHeight=parseInt(J,10);this.scrollboxBottom=this.scrollboxTop+J;}if(this.lockHeadersCase){this.heightLimit=J;this.resizeScrollBox(G.isIE);}}this.delegateGridAction(function(L){if(L&&L.onscroll){L.onscroll();}},"scrollOnResize");if(!(this.gridData&&this.gridData.eg)){this.onGridWidthChanged();}if(this.lockHeadersCase){this._refreshClonedNodes();}}else{if(this.visible){this.set("visible",false);this.forcedHidden=true;}}},renderPortalState:function E(){this.clearCache();this.unrender();this.render();},unrender:function F(I){this.clearCache();if(this._super){this._super(I);}},defaultAction:function C(N,I){if(this._super(N,I)){var M=this.model.sti,L=M&&M.titleId,K=M&&M.deselectCurrent;this._currentSelectedTD=K?undefined:N;if(L){var J=this.zone;this.delegateGridAction(function(P){var O=P.domNode,Q=O&&O.firstChild;if(!J&&Q&&(N.offsetParent===Q||N.offsetParent===O)){J=P;}},"defaultClickAction");if(J){J.clearHilites(L);if(!K){J.setHilites(L,N);}J.hiliteKey=L;this.model.sti=null;}}return true;}return false;}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var B=mstrmojo.dom,E=100;function I(K,J){return function(L){mstrmojo.all[K][(J?"move":"show")+"Tooltip"](L,self);};}function A(){var K=this.tooltipNode||this.domNode,M=this.id,J,L="_ontooltip"+(this.isDynamicTooltip?"move":"over");if(!this._ontooltipout){this._ontooltipout=function(N){mstrmojo.all[M].hideTooltip(N,self);};}if(!this[L]){this[L]=I(M,this.isDynamicTooltip);}K=[].concat(K);for(J=0;J<K.length;J++){K[J].removeAttribute("title");B.attachEvent(K[J],(this.isDynamicTooltip?"mousemove":"mouseover"),this[L]);B.attachEvent(K[J],"mouseout",this._ontooltipout);}}mstrmojo._HasTooltip=mstrmojo.provide("mstrmojo._HasTooltip",{tooltip:"",richTooltip:null,useRichTooltip:false,isDynamicTooltip:false,tooltipNode:null,tooltipOpenDelay:700,hasOpenTooltip:false,postBuildRendering:function(){var J=this._super();if(this.useRichTooltip){A.call(this);}return J;},onuseRichTooltipChange:function H(){if(this.hasRendered){var K=this.tooltipNode||this.domNode,J;if(this.useRichTooltip){A.call(this);}else{if(this._ontooltipout){if(K&&K.constructor!==Array){K=[K];}for(J=0;J<K.length;J++){B.detachEvent(K[J],this.isDynamicTooltip?"mousemove":"mouseover",this["_ontooltip"+(this.isDynamicTooltip?"move":"over")]);B.detachEvent(K[J],"mouseout",this._ontooltipout);}}this.hideTooltip();}}},showTooltip:function G(M,L){var K=this;if(!K.hasOpenTooltip&&(!mstrApp.isInteractive||mstrApp.isInteractive&&mstrApp.isInteractive())){mstrmojo.requiresCls("mstrmojo.tooltip");if(this.updateTooltipConfig){this.updateTooltipConfig(M);}window.clearTimeout(this._tooltipTimeOut);if(mstrmojo.dom.isIE){var N={};for(var J in M){N[J]=M[J];}M=N;}var O=this.richTooltip?this.richTooltip.areaId:undefined;this._tooltipTimeOut=window.setTimeout(function(){if(K._closeTooltipTimeout){window.clearTimeout(K._closeTooltipTimeout);delete K._closeTooltipTimeout;}mstrmojo.tooltip.open(K,M,L);K.tooltip.onmouseover=function(){if(K.richTooltip&&K.richTooltip.enableHover){window.clearTimeout(K._closeTooltipTimeout);window.clearTimeout(K._deactivationTimeout);if(K.tooltip){K.tooltip.onmouseout=function(P){if(!B.contains(this.domNode,P.e.toElement||P.e.relatedTarget)){K.hideTooltip();}};}}};K.hasOpenTooltip=true;K._hasActiveArea=true;K._tooltipAreaId=O;window.clearTimeout(K._deactivationTimeout);delete K._deactivationTimeout;},(this._hasActiveArea&&O&&O===this._tooltipAreaId)?0:this.tooltipOpenDelay);}},moveTooltip:function C(J,L){if(this._tooltipTimeOut){window.clearTimeout(this._tooltipTimeOut);this._tooltipTimeOut=null;mstrmojo.tooltip.close();}var N=this,K=J,M=L;this._tooltipTimeOut=setTimeout(function(){mstrmojo.tooltip.open(N,K,M);},this.tooltipOpenDelay);},hideTooltip:function F(){var J=this;window.clearTimeout(this._tooltipTimeOut);if(this._closeTooltipTimeout){window.clearTimeout(this._closeTooltipTimeout);}if(this._hasActiveArea&&!this._deactivationTimeout){this._deactivationTimeout=window.setTimeout(function(){delete J._deactivationTimeout;delete J._hasActiveArea;delete J._tooltipAreaId;},100);}mstrmojo.requiresCls("mstrmojo.tooltip");if(J.richTooltip&&J.richTooltip.enableHover){this._closeTooltipTimeout=window.setTimeout(function(){mstrmojo.tooltip.close();delete J._closeTooltipTimeout;},E);}else{mstrmojo.tooltip.close();}this.hasOpenTooltip=false;},unrender:function D(M){var N=this.tooltipNode||this.domNode,L;if(N&&N.constructor!==Array){N=[N];}if(N){var O=this._ontooltipover,K=this._ontooltipout,J=this._ontooltipmove;for(L=0;L<N.length;L++){if(O){B.detachEvent(N[L],"mouseover",O);}if(K){B.detachEvent(N[L],"mouseout",K);}if(J){B.detachEvent(N[L],"mousemove",J);}}}this._super(M);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var B=mstrmojo.dom;mstrmojo.ui.pathbar._PreAppExit=mstrmojo.provide("mstrmojo.ui.pathbar._PreAppExit",{_mixinName:"mstrmojo.ui.pathbar._PreAppExit",onmouseover:function C(E){if(this._super){this._super(E);}if(this.handleMouseOver){var H=E.target||B.eventTarget(E.hWin,E.e),F=B.findAncestorByAttr(H,"idx",true,this.domNode),D=F&&parseInt(F.value,10),G=this.items[D];this.handleMouseOver(E,G);}},onclick:function A(E){var J=E.target||B.eventTarget(E.hWin,E.e),H=B.findAncestorByAttr(J,"idx",true,this.domNode),D=H&&parseInt(H.value,10),I=this.items[D];if(this.handleClick){var F=this.handleClick(E,I);if(F){E.cancel();return ;}}if(this._super){this._super(E);}if(!J.attributes.menu&&I&&I.en!==false){var G=function(){mstrmojo.form.sendLink(I.href,I.target);};if(mstrApp.onNavigateOut(I,G)!==true){G();}return false;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom");var J=mstrmojo.dom;var Y=5;var k=1;var V=2;var N=4;var j=0;var O=true;var I=0;var F=86400000;mstrmojo.VisChartUtils=mstrmojo.provide("mstrmojo.VisChartUtils",{getScreenZoomFactor:function Z(){if(I==0){if(mstrMobileApp){var o=mstrMobileApp.getDeviceDPI();console.log("dpi:"+o);I=o/160;}else{I=1;}}return I;},changeElementSize:function a(r,w,v){if(w=="fontSize"||w=="height"||w=="line-height"){var u=mstrmojo.css.getStyleValue(r,w);var q=Math.round(v*parseInt(u));r.style[w]=q+"px";}else{if(w=="font"){var t=mstrmojo.css.getStyleValue(r,"fontSize");var q=Math.round(v*parseInt(t));var p=mstrmojo.css.getStyleValue(r,"fontWeight");var o=mstrmojo.css.getStyleValue(r,"fontFamily");r.style.font=p+" "+q+"px "+o;}}},rgbaStr2rgba:function L(o){var q=null;o=o.replace(/ /g,"");var p=o.indexOf("rgba");if(p>=0){o=o.substring(p+5,o.length-1);q=o.split(",");}return q;},fillBackground:function b(r,o,AB,p,u){var t=p||r.context,q=o||r.canvas.width,x=AB||r.canvas.height,z=r.themeColor||"#000000",w=null,AA=u||1;if(!t){t=r.canvas.getContext("2d");if(!t){return ;}}t.save();if(r.noBackground){}else{if(!r.isAndroid&&!r.isTimeSeries){w=t.createLinearGradient(0,0,0,x/2);t.fillStyle=z;t.fillRect(0,0,q,x);t.globalAlpha=0.4;w.addColorStop(0,"#fff");w.addColorStop(0.1,"#fff");w.addColorStop(1,z);t.fillStyle=w;t.rect(0,0,q,x/2);t.fill();t.globalAlpha=0.1;t.fillStyle="#fff";t.fillRect(0,0,q,x/2);}else{if(r.isTimeSeries){var v=r.formatProp;w=t.createLinearGradient(0,0,0,x);t.globalAlpha=v.backgroundAlpha;t.fillStyle=this.rgb2rgbStr(v.backgroundClr)||"#000000";t.rect(0,0,q,x);t.fill();}else{t.globalAlpha=AA;t.fillStyle=z;t.fillRect(0,0,q,x);}}}t.restore();},rgb2rgbStr:function W(p,q){var o="";if(!p||p.length!=3){return o;}if(q||q==0){o="rgba("+p[0]+","+p[1]+","+p[2]+","+q+")";}else{o="rgb("+p[0]+","+p[1]+","+p[2]+")";}return o;},getRGBWithOpacity:function R(p,o,q){if(isNaN(o)){return ;}if(!q){q=[255,255,255];}var r=[];for(color in p){r[color]=parseInt(p[color]*(1-o)+q[color]*o);}return r;},fillMasterChartBackground:function S(w,p,o,r,AD,v,t){var x=t||w.context,u=r||w.canvas.width,AB=AD||w.canvas.height,AC=w.themeColor,AA=null;var z=w.formatProp;x.save();x.globalAlpha=z.backgroundAlpha;x.fillStyle=this.rgb2rgbStr(z.backgroundClr)||"#000000";x.fillRect(0,0,u,o+AD+v);x.globalAlpha=1;x.strokeStyle=this.rgb2rgbStr(w.formatProp.textClr,0.5);x.lineWidth=1;var q=o+0.5;this.drawLineSet(this,[{x:p,y:q},{x:p+u,y:q}],false,x);q=o+AB-0.5;this.drawLineSet(this,[{x:p,y:q},{x:p+u,y:q}],false,x);x.restore();},drawLineSetWithSplit:function(u,z,x,p,v){var q=z.length,w=Math.ceil(q/v),o,r;for(var t=0;t<w;t++){o=t*v;r=Math.min(o+v+1,q);this.drawLineSet(u,z.slice(o,r),x,p);}},drawLineSet:function M(t,AA,z,o){var u=null,q=AA.length,x=null;if(o){u=o;}else{u=t.context;}var v=null,p=false;u.beginPath();var r=0;while(r<q){if(AA[r]){u.moveTo(AA[r].x,AA[r].y);v=AA[r];p=true;r++;break;}r++;}var w=false;for(;r<q;r++){x=AA[r];if(x){if(!w){u.lineTo(x.x,x.y);p=false;}else{u.moveTo(x.x,x.y);p=true;v=x;w=false;}}else{if(!w){w=true;if(p){u.arc(v.x,v.y,1,0,Math.PI*2,false);}}}}if(z){u.closePath();u.fill();}else{u.stroke();}},getMinYPosition:function H(p,t,o){var r=t,q;while(r<=o){if(p[r]){q=p[r].y;break;}r++;}for(r=t;r<=o;r++){if(p[r]){q=Math.min(q,p[r].y);}}return q;},drawLineAreaWithSplit:function(v,AC,o,t,r,w,p,x){var q=t-o+1,AA=Math.ceil(q/x),AB,z;for(var u=0;u<AA;u++){AB=o+u*x;z=Math.min(AB+x,o+q-1);this.drawLineArea(v,AC,AB,z,r,w,p);}},drawLineArea:function M(u,o,x,t,w,AC,q){var AB=null,AF=o.length,AA=null,AG=0,z=0;if(q){AB=q;}else{AB=u.context;}var r=null,AE=false;AB.save();AB.lineWidth=0;AB.beginPath();var AH=x,v;while(AH<=t){if(o[AH]){AG=o[AH].x;AB.moveTo(AG,w);r=o[AH];AE=true;break;}AH++;}v=AH;var AD=false;for(;AH<=t;AH++){AA=o[AH];if(AA){if(!AD){AB.lineTo(AA.x,AA.y);AE=false;z=AA.x;}else{AG=AA.x;AB.moveTo(AG,w);if(AH+1<=t&&o[AH+1]){AB.lineTo(AA.x,AA.y);}r=AA;AD=false;v=AH;}}else{if(!AD){AD=true;if(!AE){AB.lineTo(z,w);AB.lineTo(AG,w);var p=this.getMinYPosition(o,v,AH)||0;AB.fillStyle=this.rgb2rgbStr(AC,1);AB.globalAlpha=0.65;AB.fill();}}}}if(!AE){AB.lineTo(z,w);AB.lineTo(AG,w);var p=this.getMinYPosition(o,v,t)||0;AB.closePath();AB.fillStyle=this.rgb2rgbStr(AC,1);AB.globalAlpha=0.65;AB.fill();}AB.restore();},drawRectangle:function l(u,o,z,q,t,v,r){var p=null;if(r){p=r;}else{p=u.context;}if(v){p.fillRect(o,z,q,t);}else{p.strokeRect(o,z,q,t);}},drawArc:function Q(r,z,w,u,v,p,q,AA,o){var t=null;if(o){t=o;}else{t=r.context;}t.beginPath();t.arc(z,w,u,v,p,q);if(AA){t.fill();}else{t.stroke();}},drawRoundRect:function K(q,o,z,p,t,u,v){u=Math.min(p/2,t/2,u);q.beginPath();q.moveTo(o+u,z);q.arcTo(o+p,z,o+p,z+t,u);q.arcTo(o+p,z+t,o,z+t,u);q.arcTo(o,z+t,o,z,u);q.arcTo(o,z,o+p,z,u);q.closePath();if(v){q.fill();}else{q.stroke();}},drawHalfRoundedRectangle:function n(q,z,v,AA,t,o,AB,p){var u=null;if(p){u=p;}else{u=q.context;}u.beginPath();u.moveTo(z+AA,v);u.lineTo(z+o,v);u.arcTo(z,v,z,v+o,o);u.lineTo(z,v+t-o);u.arcTo(z,v+t,z+o,v+t,o);u.lineTo(z+AA,v+t);if(AB){u.fill();}else{u.stroke();}},drawStartEndPoints:function X(w,AD,p,t){var q=AD.length;var x=null,o=w.startEndPointRadius;if(p){x=p;}else{x=w.context;}x.save();var AA="#f0f43e",z="#f0f43e",AB="#663300";if(w.startPointColor){AA=w.startPointColor;}if(w.endPointColor){z=w.endPointColor;}else{var AC=AD[0].y,v=AD[q-1].y;if(AC>v){z="#008000";}else{if(AC<v){z="#8d1616";}else{z=AA;}}}if(w.otherPointColor){AB=w.otherPointColor;}if(t&k&&AD[0]){x.strokeStyle=AA;x.fillStyle=AA;this.drawArc(this,AD[0].x,AD[0].y,o,0,Math.PI*2,true,true,x);}if(t&V&&AD[q-1]){x.strokeStyle=z;x.fillStyle=z;this.drawArc(this,AD[q-1].x,AD[q-1].y,o,0,Math.PI*2,true,true,x);}if(t&N){x.strokeStyle=AB;x.fillStyle=AB;for(var u=1;u<q-1;u++){if(AD[u]){this.drawArc(this,AD[u].x,AD[u].y,o,0,Math.PI*2,true,true,x);}}}x.restore();},getColor:function T(o){return(parseInt(o.themeColor.substr(1),16)>8388607)?"#000000":"#ffffff";},drawHighlightLine:function d(p,u){var o=p.context,t=p.margin,r=t.l,q=p.isTimeSeries?p.chartWidth+t.l:p.getWidth()-t.r;o.save();o.globalAlpha=1;o.strokeStyle=this.rgb2rgbStr(p.formatProp.textClr,0.35);o.lineWidth=1;o.lineCap="round";while(r<q){o.beginPath();o.moveTo(r,u);r+=2;o.lineTo(r,u);o.stroke();r+=3;}o.restore();},addLabel:function m(AG,AH,AF,AD,p,z,AA){var AC=document.createElement("div");AC.className="mstrmojo-Chart-lbl";AC.style.color=this.rgb2rgbStr(AG.formatProp.textClr,0.8);AC.innerHTML=AH;if(p){AC.style.width=p+"px";}var t=null;var AB=0;if(AG.isTimeSeries){if(AA.w>=0){t=AG.xdiv;AB=AG.animationCanvas.width;}else{t=AG.domNode.getElementsByClassName("mstrmojo-chart-ylbl-div")[0];if(!t){t=document.createElement("div");t.id="mstrmojo-chart-ylbl-div";t.className="mstrmojo-chart-ylbl-div";AG.domNode.appendChild(t);}t.style.width=AG.margin.l-1+"px";}}else{t=AG.domNode;AB=AG.getWidth();}t.appendChild(AC);var r=AC.offsetWidth||(AG.getTextWidth&&AG.getTextWidthByElem(AH,AC));var AE=AC.offsetHeight||22*(I||1);var q=p||r||100;var v=AG.xLabelPadding/2;var u=AG.yLabelPadding/2;if(AA.w>=0&&AG.isTimeSeries&&AG._scroller.origin){var AI=AF-AG._scroller.origin.x;if(AI<=0&&(AI+r/2>-AG.maxYLblWidth)){AG.needRedrawVerticalLine=true;t.removeChild(AC);return null;}var o=AI-AG.getChartWidthOnScreen();if((o-r/2)<=0&&o>=0){AG.needRedrawVerticalLine=true;t.removeChild(AC);return null;}}if(AA.w>=0){AF=AF-q/2;}if(AA.h>=0&&((AD>=AA.y-u&&AD<=AA.y+AA.h)||(AD+AE>=AA.y-u&&AD+AE<=AA.y+AA.h)||(AD+AE>=AG.canvas.height-AG.margin.b))){t.removeChild(AC);return null;}if(AA.w>=0&&(((AF>=AA.x&&AF<AA.x+AA.w+v))||AF<AA.x||AF<AG.margin.l||AF+q>AB)){t.removeChild(AC);return null;}if(AG.isTimeSeries&&AA.h>=0){t.style.top=(AG.margin.t-AE/2)+"px";t.style.height=(AG.canvas.height-AG.margin.t-AG.margin.b-1+AE/2)+"px";this.translateCSS(AF,(AD-AG.margin.t)+AE/2,z,AC);}else{this.translateCSS(AF,AD,z,AC);AC.style.maxHeight=AE+"px";}AA.x=AF;AA.y=AD;if(AA.h>=0){AA.h=AE;}if(AA.w>=0){AA.w=q;AC.style.textAlign="center";}return AC;},addDataLabel:function m(p,r,u,q){var o=(p.margin.l>p.margin.r)?Y:p.getWidth()-p.margin.r+Y,t=(p.margin.l>p.margin.r)?p.margin.l:p.margin.r;return this.addLabel(p,r,o,u-10,t-Y*2,false,q);},translateCSS:function f(o,t,p,r){var q="translate("+o+"px,"+t+"px)";if(p){q+=" rotate(45deg)";}r.style[J.CSS3_TRANSFORM]=q;},getTouchXYOnWidget:function B(p,o,t){var r=mstrmojo.TouchScroller,q=(r&&t.parent&&r.getScrollPositionTotals(t.parent))||{x:0,y:0};p=p-t.offsetLeft+q.x;o=o-t.offsetTop+q.y;return{touchX:p,touchY:o};},getYValue:function A(t,p){var o=t.canvas.height,r=t.margin,q=t.model.mvalues;return o-r.b-4-((parseFloat(p)-q[0])*t.RTY);},getMasterYValue:function e(r,p,t){var o=r.masterCanvas.height,q=r.model.mvalues;return o-t.b-3-((parseFloat(p)-q[0])*r.MRTY);},getSeriesIndexAndYValue:function C(x,o,z){var AA=x.model.series,r=AA.length,u=0;y=this.getYValue(x,AA[u].rv[o])||0;var v=z-y<0?-(z-y):z-y,p=v;for(var t=1;t<r;t++){var q=this.getYValue(x,AA[t].rv[o])||0;v=z-q<0?-(z-q):z-q;if(v<p){y=q;p=v;u=t;}}return{y:y,si:u};},getLabelWidthForMargin:function h(o,r){var q=document.createElement("div");q.className="mstrmojo-Chart-lbl";q.innerHTML=r;o.domNode.appendChild(q);var p=q.offsetWidth||60;o.domNode.removeChild(q);return p+Y*2;},animateLineSet:function U(AB,q,z,u){var AC=[],AA=AB.animationContext,r=z.length;AA.clearRect(0,0,AB.getWidth(),AB.canvas.height);if(!u.index){u.index=0;}else{if(u.index>=u.rate){this.drawLineSet(AB,z,false,AA);AB.drawLabels();if(AB.isFillLinesArea){this.fillLinesArea(AB,z.slice(0));}if(AB.isDrawStartEndPoints){this.drawStartEndPoints(AB,z,AA,AB.isDrawStartEndPoints);}return ;}}for(var t=0;t<r;t++){var p=z[t],o=q[t];AC[t]={x:(u.index*(p.x-o.x)/u.rate)+o.x,y:(u.index*(p.y-o.y)/u.rate)+o.y};}this.drawLineSet(AB,AC,false,AA);var v=this;u.index++;window.setTimeout(function(){v.animateLineSet(AB,q,z,u);},40);},fillLinesArea:function G(p,t){var q=p.canvas.height;t.push({x:p.getWidth()-p.margin.r,y:q-p.margin.b});t.push({x:p.margin.l,y:q-p.margin.b});var u=new Array();if(p.fillinColor){mstrmojo.requiresCls("mstrmojo.color");var r=mstrmojo.color.hex2rgb(p.fillinColor).join(",");u[0]="rgba("+r+", 0.8)";u[1]="rgba("+r+", 0.2)";}else{u=["rgba(255,128,0,0.8)","rgba(255,128,0,0.2)"];}var o=p.animationContext;var r=o.createLinearGradient(0,0,0,q);r.addColorStop(0,u[0]);r.addColorStop(0.75,u[1]);o.fillStyle=r;this.drawLineSet(p,t,true,o);},convertRawValueToMilliseconds:function g(q){var r=Number(q),o=r-((Date.UTC(1970,1,1)-Date.UTC(1899,12,30))/F)-j,p=new Date(o*F);return new Date(p.getUTCFullYear(),p.getUTCMonth(),p.getUTCDate()).getTime();},getAncestorBgColor:function D(q){var v=null,u=q,AA=u.modelData?u.modelData:u.model,z=null;if(u.hasOwnProperty("xtabModel")&&u.xtabModel.hasOwnProperty("docModel")){z=u.xtabModel.docModel;}if(z&&z.defn&&z.defn.layouts&&z.defn.layouts.length>0){var x=z.defn.layouts,r;var p;for(p in x){if(x[p].loaded){r=x[p];}}if(r&&r.hasOwnProperty("units")){var t=r.units;var w=AA.parent;while(w){var o=w.k||null;if(t[o]&&t[o].fmts&&t[o].fmts["background-color"]){v=t[o].fmts["background-color"];break;}else{w=w.parent||null;}}if(!v){if(r.fmts&&r.fmts["background-color"]){v=r.fmts["background-color"];}}}}return v;},isLightColor:function c(u){var p=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,v,o,w,AA,z,t=false;if(u){var AB,x;if(/^(rgba|RGBA)/.test(u)){x=u.replace(/rgba\(|RGBA\(/,"");x=x.replace(")","");AB=x.split(",");o=AB[0];w=AB[1];AA=AB[2];}else{if(/^(rgb|RGB)/.test(u)){x=u.replace(/rgb\(|RGB\(/,"");x=x.replace(")","");AB=x.split(",");o=AB[0];w=AB[1];AA=AB[2];}else{if(p.test(u)){if(u.length===4){AB="#";for(v=1;v<4;v++){AB+=u.slice(v,v+1).concat(u.slice(v,v+1));}u=AB;}var q=[];for(v=1;v<7;v+=2){q.push(parseInt("0x"+u.slice(v,v+2)));}o=q[0];w=q[1];AA=q[2];}}}z=(o*299+w*587+AA*114)/1000;if(z>150){t=true;}}return t;},getPointDistanceSquare:function E(p,o){return(p.x-o.x)*(p.x-o.x)+(p.y-o.y)*(p.y-o.y);},truncateTextToLine:function(p,AB,AF){AB.className=p.className;AB.style.whiteSpace="nowrap";var v=AB.innerHTML=p.innerHTML;var r=parseInt(p.offsetWidth)-parseInt(p.style.width);var AD=AF*parseInt(p.style.width)+r;var t=v;if(AB.offsetWidth>AD){var w=0,q=v.length-1;while(w<=q){var AA=Math.round((w+q)/2);var AE=v.substr(0,AA+1);var AC=v.substr(0,AA+2);AB.innerHTML=AE;var z=AB.offsetWidth;AB.innerHTML=AC;var u=AB.offsetWidth;if(z<=AD&&u>AD){break;}else{if(z>AD){q=AA-1;}else{if(u<=AD){w=AA+1;}}}}t=v.substr(0,AA+1);if(t.length<v.length){if(t.charAt(t.length-1)===" "){t=t.substr(0,t.length-1);}var x=t.lastIndexOf(" ");var o=t.length-1-x;if(o>=2&&o<=8){t=t.substr(0,t.length-o-1)+"...";}else{t=t.substr(0,t.length-3)+"...";}}}p.innerHTML=t;},getLen:function(r,q,p,o){q.innerHTML=r;var t=q.offsetWidth+p-o;return t;},splitWordIfTooLong:function(t,AE,AB,w,z){var AD=t.split(" ");var x=[];var AA=AD.length;var u=0;var r=0;for(u=0;u<AA;u++){var p=AD[u];while(true){var AF=this.getLen(p,AE,z,w);if(AF>AB){var AC=(AB/AF)*p.length;var o=Math.round(AC);while(o>0){var v=p.substr(0,o);var q=this.getLen(v,AE,z,w);if(q<=AB){x.push(v);break;}else{o--;}}p=p.substr(o,p.length-o);}else{x.push(p);break;}}}return x.join(" ");},truncateTextToLineWithWordWrap:function(AO,AK,AH){AK.className=AO.className;AK.style.whiteSpace="nowrap";var AG=7;var x=-1;if(AO.style&&AO.style.width&&AO.style.width.length>0){x=parseFloat(AO.style.width);}if(x<0){x=parseFloat(mstrmojo.css.getComputedStyle(AO).width);}var AI=AO.innerHTML;var AN=parseFloat(AO.offsetWidth)-x;AI=this.splitWordIfTooLong(AI,AK,x,AN,AG);var AA=AI.split(" ");var t=[];var AD=[];var AM=0;var o=0;var AF=AA.length;AK.innerHTML="&nbsp;";var AP=AK.offsetWidth-AN;AD.push(0);for(AM=0;AM<AF;AM++){var p=this.getLen(AA[AM],AK,AG,AN);if(p>x){var z=AA[AM];var AL=(x/p)*z.length;AA[AM]=z.substr(0,parseInt(AL));p=x;}t.push(p);o+=p;AD.push(o);if(AM!==AF-1){o+=AP;}}var AC=0,AJ=0;var AB=AH;for(;AJ<AD.length;){var w=AD[AJ]-AD[AC];if(AC>0&&AJ!=AC){w-=AP;}var v=AD[AJ+1]-AD[AC];if(AC>0&&AJ+1!=AC){v-=AP;}if(w<=x&&((AJ+1==AD.length)||(v>x))){AB--;if(AB==0||AJ===AF){break;}else{AC=AJ;AJ++;}}else{AJ++;}}if(AJ>AF){AJ=AF;}var AE=AD[AJ]-AD[AC];if(AC>0&&AJ!=AC){AE-=AP;}var AQ;if(AJ>=AF&&AE<x){AQ=AA.join(" ");}else{AQ=AA.slice(0,AJ).join(" ");var r=this.getLen("...",AK,AG,AN);if(AE+r<=x){AQ+="...";}else{if(AQ.charAt(AQ.length-1)===" "){AQ=AQ.substr(0,AQ.length-1);}var u=AQ.lastIndexOf(" ");var q=AQ.length-1-u;if(q===3){AQ=AQ.substr(0,AQ.length-3)+" ...";}else{AQ=AQ.substr(0,AQ.length-3)+"...";}}}AO.innerHTML=AQ;},getLen2:function(v,p,o){var q=o;var r=q.getContext("2d");r.font=p;r.textAlign="center";r.fillStyle="blue";var u=r.measureText(v);var t=u.width;return t;},splitWordIfTooLong2:function(u,AB,t,v){var AD=u.split(" ");var z=[];var AA=AD.length;var w=0;var r=0;for(w=0;w<AA;w++){var p=AD[w];while(true){var AE=this.getLen2(p,t,v);if(AE>AB){var AC=(AB/AE)*p.length;var o=Math.max(Math.round(AC),1);while(o>0){var x=p.substr(0,o);var q=this.getLen2(x,t,v);if(q<=AB||o==1){z.push(x);break;}else{o--;}}p=p.substr(o,p.length-o);}else{z.push(p);break;}}}return z.join(" ");},getComputedFontStyle:function P(o){var p=o.fontStyle+" "+o.fontWeight+" "+o.fontSize+"/"+o.fontVariant+" "+o.fontFamily;return p;},truncateTextToLineWithWordWrap2:function(AR,AK,AB,AJ){var AA=-1;if(AR.style&&AR.style.width&&AR.style.width.length>0){var AO=0;var AQ=mstrmojo.css.getComputedStyle(AR);if(AQ.paddingLeft){AO+=parseFloat(AQ.paddingLeft);}if(AQ.paddingRight){AO+=parseFloat(AQ.paddingRight);}var AP=AR.offsetWidth;AA=AP?AP-AO:parseInt(AR.style.width);}if(AA<0){AR.innerHTML="...";return ;}var w=mstrmojo.css.getComputedStyle(AR);var q=this.getComputedFontStyle(w);AK=this.splitWordIfTooLong2(AK,AA,q,AB);var AD=AK.split(" ");var u=[];var AG=[];var AN=0;var o=0;var AI=AD.length;var AS=this.getLen2(" ",q,AB);AG.push(0);for(AN=0;AN<AI;AN++){var p=this.getLen2(AD[AN],q,AB);if(p>AA){var AC=AD[AN];var AM=(AA/p)*AC.length;AD[AN]=AC.substr(0,parseInt(AM));p=AA;}u.push(p);o+=p;AG.push(o);if(AN!==AI-1){o+=AS;}}var AF=0,AL=0;var AE=AJ;for(;AL<AG.length;){var z=AG[AL]-AG[AF];if(AF>0&&AL!=AF){z-=AS;}var x=AG[AL+1]-AG[AF];if(AF>0&&AL+1!=AF){x-=AS;}if(z<=AA&&((AL+1==AG.length)||(x>AA))){AE--;if(AE==0||AL===AI){break;}else{AF=AL;AL++;}}else{AL++;}}if(AL>AI){AL=AI;}var AH=AG[AL]-AG[AF];if(AF>0&&AL!=AF){AH-=AS;}var AT;if(AL>=AI&&AH<AA){AT=AD.join(" ");}else{AT=AD.slice(0,AL).join(" ");var t=this.getLen2("...",q,AB);if(AH+t<=AA){AT+="...";}else{if(AT.charAt(AT.length-1)===" "){AT=AT.substr(0,AT.length-1);}var v=AT.lastIndexOf(" ");var r=AT.length-1-v;if(r===3){AT=AT.substr(0,AT.length-3)+" ...";}else{AT=AT.substr(0,AT.length-3)+"...";}}}AR.innerHTML=AT;return AT.indexOf("...")>-1;},truncateDivContent:function(u,z,q){z.innerHTML=u;if(z.offsetHeight>q){var v=0,p=u.length-1;while(v<=p){var AA=Math.round((v+p)/2);var AC=u.substr(0,AA+1);var AB=u.substr(0,AA+2);z.innerHTML=AC;var x=z.offsetHeight;z.innerHTML=AB;var t=z.offsetHeight;if(x<=q&&t>q){break;}else{if(x>q){p=AA-1;}else{if(t<=q){v=AA+1;}}}}var r=u.substr(0,AA+1);if(r.length<u.length){if(r.charAt(r.length-1)===" "){r=r.substr(0,r.length-1);}var w=r.lastIndexOf(" ");var o=r.length-1-w;if(o>=2&&o<=8){r=r.substr(0,r.length-o-1)+"...";}else{r=r.substr(0,r.length-3)+"...";}}return r;}else{return u;}},positionTooltip:function(AH,q,AM,w){if(!AH||!q||!AM){return ;}if(isNaN(w)){w=45;}var AJ=AM.offsetWidth,x=AM.offsetHeight,u=AH.offsetWidth,AG=AH.offsetHeight,AC=AH.style,z=0,AK=0;function v(){return u+w<q.x&&AG<x;}function r(){return AG+w<q.y&&u<AJ;}function t(){return q.x+w+u<AJ&&AG<x;}function AB(){return q.y+w+AG<x&&u<AJ;}function p(){return q.x>u/2&&(AJ-q.x)>u/2;}function o(){return q.y>AG/2&&(x-q.y)>AG/2;}function AL(){return r()&&v();}function AI(){return r()&&p();}function AF(){return r()&&t();}function AN(){return v()&&o();}function AE(){return AB()&&v();}function AO(){return t()&&o();}function AD(){return AB()&&p();}function AA(){return AB()&&t();}if(AL()){z=q.x-w-u;AK=q.y-w-AG;}else{if(AI()){z=q.x-u/2;AK=q.y-w-AG;}else{if(AF()){z=q.x+w;AK=q.y-w-AG;}else{if(AN()){z=q.x-w-u;AK=q.y-AG/2;}else{if(AE()){z=q.x-w-u;AK=q.y+w;}else{if(AO()){z=q.x+w;AK=q.y-AG/2;}else{if(AD()){z=q.x-u/2;AK=q.y+w;}else{if(AA()){z=q.x+w;AK=q.y+w;}}}}}}}}AC.left=z+"px";AC.top=AK+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var B={};var E={};mstrmojo.publisher=mstrmojo.provide("mstrmojo.publisher",{publish:function F(H,Q,L){var M=B[H]&&B[H][Q],O;if(!M){return ;}for(O in M){var J=null;if(O){J=mstrmojo.all[O];if(!J){delete M[O];continue;}}var R=M[O].methods;if(R){var P=J||mstrmojo.global,I;for(I in R){if(P[I]){P[I](L);}}}var N=M[O]&&M[O].functions,S=(N&&N.length)||0;if(S){var K;if(J){for(K=S-1;K>-1;K--){if(N[K]){N[K].apply(J,[L]);}}}else{for(K=S-1;K>-1;K--){if(N[K]){N[K](L);}}}}}},subscribe:function D(I,N,R,J){var S=B[I];if(!S){S={};B[I]=S;}var M=S[N];if(!M){M={};S[N]=M;}var K=M[J||""];if(!K){K={};M[J||""]=K;}if(typeof R==="function"){var L=K.functions;if(!L){L=[];K.functions=L;}L.push(R);}else{var H=K.methods;if(!H){H={};K.methods=H;}H[R]=true;}var Q=E,P=Q[J||""];if(!P){P={};Q[J||""]=P;}var O=P[I];if(!O){O={};P[I]=O;}O[N]=true;return{id:I,type:N,callback:R,listener:J,clear:function(){mstrmojo.publisher.unsubscribe(this);}};},unsubscribe:function C(I){var R=B[I.id],O=R&&R[I.type],L=O&&O[I.listener||""];if(!L){return ;}var K=mstrmojo.array,Q=mstrmojo.hash,P=typeof I.callback,M=false;if(P==="function"){var N=L.functions;if(N){K.removeItem(N,I.callback);if(!N.length){delete L.functions;if(Q.isEmpty(L.methods)){M=true;}}}}else{var J=L.methods;if(J){delete J[I.callback];if(Q.isEmpty(J)){delete L.methods;if(!L.functions||!L.functions.length){M=true;}}}}if(M){delete O[I.listener||""];if(Q.isEmpty(O)){delete R[I.type];}}},hasSubs:function G(K,J){var I=B[K],H=I&&I[J];return !!H;},clearSubscriptions:function A(I){if(!I){I="";}var P=B,M=mstrmojo.hash,H;if(P[I]){delete P[I];}var O=E[I];if(O){for(H in O){var N=P[H],L=O[H],K;if(!N){continue;}for(K in L){var J=N[K];if(!J){continue;}delete J[I];if(M.isEmpty(J)){delete N[K];}}}}delete E[I];}});mstrmojo.publisher.NO_SRC="NO_SRC";mstrmojo.publisher.CONNECTIVITY_CHANGED_EVENT="CONNECTIVITY_CHANGED";mstrmojo.publisher.RECONCILE_END_EVENT="RECONCILE_END";}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var B=mstrmojo.hash;mstrmojo.Base=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Base",init:function A(C){B.copy(C,this);if(this.postApplyProperties){this.postApplyProperties();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var O=/this\.([\w\.\[\]\'\"\-]+)/m,D=/this\./m,M=/mstrmojo\.all\[[\'\"]([\w]+)[\'\"]\]\.([\w\.\[\]\'\"\-]+)/m,R=/mstrmojo\.all\[/m,L=/mstrmojo\.all\.([\w]+)\.([\w\.\[\]\'\"\-]+)/m,B=/mstrmojo\.all\./m,C=/\[(\d+)\]/g,E=/\[\'([\w\-]+)\'\]/g,P=/\[\"([\w\-]+)\"\]/g,H=/([\[\]].*)/;mstrmojo.Binding=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.Binding",parent:null,source:null,destination:null,enabled:false,setter:"set",executing:0,init:function N(S){mstrmojo.hash.copy(S,this);mstrmojo.registry.add(this);},destroy:function F(){mstrmojo.publisher.clearSubscriptions(this.id);mstrmojo.registry.remove(this);},exec:function K(){this.executing++;var W=this._sourceFn;if(!W){var V=this.source;if(V!=null){if(typeof (V)=="string"){if(!(V.match("return "))&&!(V.match(/\;\s*\S/))){V="return "+V;}W=new Function(V);}else{if(typeof (V)=="function"){W=V;}}this._sourceFn=W;}}var S,X=this.parent;if(W){try{S=W.apply(X,[]);}catch(U){}}var T=this.setter,Y=this.destination;if(T==null){X[Y]=S;}else{if(typeof (T)=="string"){X[T](Y,S);}else{if(typeof (T)=="function"){T.apply(X,[Y,S]);}}}this.executing--;},enable:function A(){if(!this.enabled){this.exec();var T=this._chains;if(!T){this._parseChains();T=this._chains;}for(var S in T){this._attachChain(T[S]);}this.enabled=true;}},disable:function J(){if(this.enabled){var T=this._chains;if(T){for(var S in T){this._detachChain(T[S]);}}this.enabled=false;}},_chains:null,_parseChains:function(){this._chains={};var U=this._chains;var T=this.source;if(T&&(typeof (T)=="function")){T=T.toString&&T.toString();}if(!T){return ;}function S(b,e,V,X){var W=b,Z;while(Z=W.match(e)){var c=Z[0],a=c.length,d=true;c=c.replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"");for(var Y in U){if(Y.substr(0,a)===c){d=false;break;}else{if(c.indexOf(Y)===0){delete U[Y];}}}if(d){U[c]={host:(V==null)?null:Z[V],parts:Z[X].replace(C,".$1").replace(E,".$1").replace(P,".$1").replace(H,"").split(".")};}W=W.substr(Z.index+a);}}if(D.test(T)){S(T,O,null,1);}if(R.test(T)){S(T,M,1,2);}if(B.test(T)){S(T,L,1,2);}},_attachChain:function Q(S,U){if(!S.evt2idx){S.evt2idx={};}if(!S.idx2evt){S.idx2evt=[];}var d=S.evt2idx,g=S.idx2evt,Z=S.parts;var e=(U>=0)?U:0,b=this.id,W=mstrmojo.all,c=(U>0)?W[g[e-1].context][Z[e-1]]:(S.host?W[S.host]:this.parent),T=Z[e];var V=mstrmojo.array;while(c&&T){if(c.attachEventListener){var f=c[T+"_bindEvents"]||(T+"Change");if(typeof (f)=="string"){f=[f];}var Y=[];for(var a=0,X=f.length;a<X;a++){Y[a]=c.attachEventListener(f[a],b,"_callback");}for(var a=0;a<f.length;a++){d[c.id+"_"+f[a]]=e;}g[e]={context:c.id,evts:f,subs:Y};}c=c[T];T=S.parts[++e];}},_detachChain:function G(S,T){var U=mstrmojo.all,h=S.idx2evt,d=S.evt2idx,a=this.id;var Y=(T>-1)?T:0,b=h.length;if(Y<b){for(;Y<b;Y++){var Z=h[Y];if(!Z){break;}var W=Z.context,c=U[W],g=Z.evts;if(c&&c.detachEventListener){var k=Z.subs;for(var f=0,V=k.length;f<V;f++){c.detachEventListener(k[f]);}}h[Y]=null;for(var X=0,e=g.length;X<e;X++){delete d[W+"_"+g[X]];}}}},_callback:function I(T){this.exec();if(!T||!T.name||!T.src){return ;}var U=T.src.id+"_"+T.name,W=this._chains;for(var X in W){var V=W[X],S=V.evt2idx[U];if(S!=null){this._detachChain(V,S+1);this._attachChain(V,S+1);}}}});})();mstrmojo.DPIManager={classes:[],registerClass:function registerClass(B,C,D,A){this.classes.push({c:B,d:C,s:D,v:A});},setDPI:function(){var A=mstrMobileApp.getDeviceDPI();mstrmojo.array.forEach(this.classes,function(B){B.c.prototype.layoutConfig[B.d][B.s]=B.v[A]+"px";});this.classes=[];}};(function(){document.msCSSOMElementFloatMetrics=true;mstrmojo.requiresCls("mstrmojo.hash");var S=mstrmojo.hash,H="containerNode",G="auto",Q="px";var I={v:G,c:undefined,sv:G};function E(c,f,e){var g=this._layoutWidgets[f],k=c.slot||H,h=g.f,j=g.p,d=(h&&h[k]!==undefined),b=(j&&j[k]!==undefined);if(k&&((!e&&d)||b)){return d?h[k]:(g.x*parseInt(j[k],10)/100)+Q;}return c[(f==="h")?"height":"width"];}function K(g,d,b){if(g.ignoreLayout){return ;}var c=(d===G)||d==="NaNpx",f=(b===G)||b==="NaNpx";var e=g.getLayoutOffsets&&g.getLayoutOffsets();if(e){if(!c){d=(parseInt(d,10)-e.h)+Q;}if(!f){b=(parseInt(b,10)-e.w)+Q;}}if(g.setDimensions){g.setDimensions(d,b);}else{if(g.set){if(!c){g.set("height",d);}if(!f){g.set("width",b);}}}}function Z(e){var c=this.children,g,k;for(g=0,k=(c&&c.length)||0;g<k;g++){var d=c[g],l=d.slot||H;if(l){var j=E.call(this,d,"h",e),m=E.call(this,d,"w",e);this.setSlotDimensions(l,j,m);K(d,j,m);var b=E.call(this,d,"h",e),f=E.call(this,d,"w",e);if(b!==j||f!==m){K(d,b,f);}this.setSlotDimensions(l,b,f);}}this.afterLayout();}function B(){var c=this.children,b=this._layoutWidgets;S.forEach(this.slotNames,function(g,j){if(!g||this.skipsSlotLayout(j)){return ;}var f=(b.h&&b.h.getSlotSizeInfo(j,c))||I,d=(b.w&&b.w.getSlotSizeInfo(j,c))||I,e=f.c||d.c;mstrmojo.array.forEach(e,function(h){K(h,f.v,d.v);});this.setSlotDimensions(j,f.sv,d.sv);},this);this.afterLayout();}function D(c){var b=this.layoutConfig.xt?B:Z;b.call(this,c);}function T(j,e,g){var h=j.slot||H,f=e&&e.a;if(!f||f[h]===undefined){return ;}var b=this[h]["offset"+g],c=f[h];if(b===c){return ;}e.x-=(b-c);f[h]=b;}function J(b){this.beforeLayout();var c=this._layoutWidgets,d=b.src;T.call(this,d,c.h,"Height");T.call(this,d,c.w,"Width");D.call(this,true);}function O(d,g){if(!d){return null;}var b=this.children,q=g.toLowerCase(),h=parseInt(this[q],10),k=h,m={},o={},f={},c={},n={},j,l,e,r,p;for(p in d){if(!d.hasOwnProperty(p)){continue;}r=d[p];if(r.match(/px$/)){h-=parseInt(r,10);m[p]=r;}else{if(r.match(/%$/)){o[p]=r;}else{if(r.match(/all/)){n[p]=k;}else{f[p]=r;}}}}if(!S.isEmpty(f)&&!S.isEmpty(o)){for(j=0,l=(b&&b.length)||0;j<l;j++){e=b[j];p=e.slot||H;if(p&&f[p]&&!e.ignoreLayout){if(e.hasRendered){c[p]=this[p]["offset"+g];h-=c[p];}else{c[p]=0;e.attachEventListener((e instanceof mstrmojo.Container)?"childrenRendered":"renderComplete",this.id,J);}}}}return{f:S.isEmpty(m)?undefined:m,p:S.isEmpty(o)?undefined:o,a:S.isEmpty(c)?undefined:c,n:S.isEmpty(n)?undefined:n,x:h,getSlotSizeInfo:function(AB,v){if(!d[AB]){return I;}var u=mstrmojo.array.filter(v,function(AD){var AC=AD.slot;return AC===AB||(AB===H&&!AC);}),z,AA;var t=m[AB];if(t){AA=t;}var x=o[AB];if(x){AA=(this.x*parseInt(x,10)/100)+Q;}if(f[AB]){AA=c[AB];if(AA){AA+=Q;}else{AA=G;}z=G;}var w=n[AB];if(w){AA=z=w+Q;}AA=AA||"0px";return{v:AA,c:u,sv:z||AA};}};}function R(c){var b=this.domNode;if(!b||!this.layoutConfig){return ;}b.style[c]=this[c];this.doLayout();}mstrmojo._HasLayout=mstrmojo.provide("mstrmojo._HasLayout",{_mixinName:"mstrmojo._HasLayout",height:"auto",width:"auto",ignoreLayout:false,beforeLayout:mstrmojo.emptyFn,afterLayout:mstrmojo.emptyFn,layoutConfig:null,init:function V(b){this._super(b);this.layoutConfig=S.clone(this.layoutConfig);},preBuildRendering:function C(){var d=this.cssText||"";var b=this.height;if(b&&b!==G){d+="height:"+this.height+";";}var c=this.width;if(c&&c!==G){d+="width:"+this.width+";";}this.cssText=d;return(this._super)?this._super():true;},postBuildRendering:function W(){this.doLayout();return this._super();},modifyLayoutConfig:function Y(d,c){var b=this.layoutConfig=this.layoutConfig||{};b.h=S.copy(d,b.h);b.w=S.copy(c,b.w);this.doLayout();},getLayoutOffsets:mstrmojo.emptyFn,set:function P(d,b){var c=this._super(d,b);if(d==="visible"&&this._pendingLayoutOnVisible){delete this._pendingLayoutOnVisible;this.doLayout();}return c;},doLayout:function A(){var b=this.layoutConfig;if(!b||(this.height===G&&this.width===G)){return ;}if(b.xt){if(!this.visible){this._pendingLayoutOnVisible=true;return ;}}this.beforeLayout();this._layoutWidgets={h:O.call(this,b.h,"Height"),w:O.call(this,b.w,"Width")};D.call(this,false);this.widgetResized();},browserResized:function F(b){this.setDimensions(b.h,b.w);return true;},onwidthChange:function N(){R.call(this,"width");},onheightChange:function M(){R.call(this,"height");},skipsSlotLayout:function(b){return false;},adjustParentDimensions:function L(){var c=this.parent,b=c&&c._layoutWidgets;if(b){T.call(c,this,b.h,"Height");T.call(c,this,b.w,"Width");}},setDimensions:function U(e,c){var d=(e===G)||e==="NaNpx",f=(c===G)||c==="NaNpx";if((!d&&parseInt(this.height,10)!==parseInt(e,10))||(!f&&parseInt(this.width,10)!==parseInt(c,10))){if(!d){this.height=e;}if(!f){this.width=c;}var b=this.domNode,g=b&&b.style;if(g){if(!d){g.height=e;}if(!f){g.width=c;}this.doLayout();}return true;}return false;},setSlotDimensions:function X(e,d,c){var b=this[e]&&this[e].style;if(!b){return ;}if(d!==G&&d!==undefined&&d!=="NaNpx"&&b.height!==d&&parseInt(d)>=0){b.height=d;}if(c!==G&&c!==undefined&&c!=="NaNpx"&&b.width!==c&&parseInt(c)>=0){b.width=c;}}});mstrmojo._HasLayout.getSlotSize=function a(e,f){var c=e&&e.prototype.layoutConfig;if(c){var d=c.h,b=c.w;return{h:(d&&d[f])||undefined,w:(b&&b[f])||undefined};}return null;};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash,A=null;function B(D){return mstrmojo.DICFactory.createDIC(C.copy({dic:this.dic,owner:this.owner,group:this},D));}mstrmojo.DICFactory=mstrmojo.provide("mstrmojo.DICFactory",{createDIC:function(G){var E=G.dic,F=mstrmojo.DICConfig.getDICClass(E),D;if(F){if(G.k===undefined){G.k=G.opener&&G.opener.id;}G.showByDefault=mstrmojo.DICConfig.showDICByDefault(G.dic,G.openerType);G.hasPreview=mstrmojo.DICConfig.hasDICPreview(G.dic,G.openerType);G.canSlice=mstrmojo.DICConfig.canSlice(G.dic,G.openerType);D=new F(G);}return D;},createDICPopup:function(D,E){return mstrmojo.DICPopup.getInstance(D,E);},createDICGroup:function(F){var I=C.copy(F,{scriptClass:"mstrmojo.Widget",widgetsMap:{},dic:null,owner:null,groupMembers:{},postCreate:function(){var L=this.dic,K=this.openerType,J=mstrmojo.DICConfig;this.showByDefault=J.showDICByDefault(L,K);this.hasPreview=J.hasDICPreview(L,K);},addDIC:function D(J,K){this.groupMembers[J]=K;},showPopupDIC:function H(K){if(!this.showByDefault){var J=this.widgetsMap[K],L=this.groupMembers[K];if(!L){return ;}if(!J){J=this.widgetsMap[K]=B.call(this,L);}J.showInPopup();}},render:function G(){if(this.showByDefault||this.hasPreview){var L=this.groupMembers,K=this,J;C.forEach(L,function(N,M){if(!N.hasRendered){K.widgetsMap[M]=J=B.call(K,N);if(K.showByDefault){J.render();}else{if(K.hasPreview&&J.enabled){J.renderPreview();}}N.hasRendered=true;}});}},destroy:function E(){C.forEach(this.widgetsMap,function(J){J.destroy();});this.widgetsMap={};}});return mstrmojo.insert(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.requiresDescs(521,522,523,524,525,526,529,530,534,535,546,547,587,686,687,688,696,746,1101,1102,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,2171,2202,2203,2204,2219,2220,2784,2785,2786,2795,2796,3086,3344,3852,3853,3854,3855,3856,3857,3858,3859,3860,3861,3862,3863,3945,3946,4406,4407,5282,5283,5924,5925,6076,6077,6078,6079,6080,6081,6082,7899,7900,7901,7902,7903,9379,9380,9381,9382,9383,9384,9385,12298,13889,13890,13896,13897);mstrmojo.locales=mstrmojo.provide("mstrmojo.locales",{load:function(C){var A=this;if(this.isLoaded){C();C=null;}else{var B={taskId:"getLocaleInfo"};if(mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){B.sessionState=mstrApp.sessionState;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(D){A.update(D);C();C=null;if(mstrmojo.expr){mstrmojo.expr.onLocaleUpdated();}mstrmojo.locales.isLoaded=true;},failure:function(D){alert(D.getResponseHeader("X-MSTR-TaskFailureMsg"));}},B);}},update:function(A){if(A){mstrmojo.hash.copy(mstrmojo.hash.obj2array(A),this);}},isLoaded:false,datetime:{MONTHNAME_SHORT:[mstrmojo.desc(3852,"Jan"),mstrmojo.desc(3853,"Feb"),mstrmojo.desc(3854,"Mar"),mstrmojo.desc(3855,"Apr"),mstrmojo.desc(3856,"May"),mstrmojo.desc(3857,"Jun"),mstrmojo.desc(3858,"Jul"),mstrmojo.desc(3859,"Aug"),mstrmojo.desc(3860,"Sep"),mstrmojo.desc(3861,"Oct"),mstrmojo.desc(3862,"Nov"),mstrmojo.desc(3863,"Dec")],MONTHNAME_FULL:[mstrmojo.desc(1956,"January"),mstrmojo.desc(1957,"February"),mstrmojo.desc(1958,"March"),mstrmojo.desc(1959,"April"),mstrmojo.desc(1960,"May"),mstrmojo.desc(1961,"June"),mstrmojo.desc(1962,"July"),mstrmojo.desc(1963,"August"),mstrmojo.desc(1964,"September"),mstrmojo.desc(1965,"October"),mstrmojo.desc(1966,"November"),mstrmojo.desc(1967,"December")],dayShortNames:["S","M","T","W","T","F","S"],dayNames:[mstrmojo.desc(9379,"Sunday"),mstrmojo.desc(9380,"Monday"),mstrmojo.desc(9381,"Tuesday"),mstrmojo.desc(9382,"Wednesday"),mstrmojo.desc(9383,"Thursday"),mstrmojo.desc(9384,"Friday"),mstrmojo.desc(9385,"Saturday")],DATEINPUTFORMATS:["M/d/yy","M/d/yyyy","MMM d, yy"],TIMEINPUTFORMATS:["h:mm a","H:mm","h:mm:ss a","H:mm:ss","h:mm:ss a z"],DATEOUTPUTFORMAT:"M/d/yyyy",TIMEOUTPUTFORMAT:"h:mm:ss a",DATEDISPLAYFORMAT:"M/d/yy",TIMEDISPLAYFORMAT:"h:mm:ss",AM_NAME:"AM",PM_NAME:"PM",TWODIGITYEARSTART:"2029"},number:{NUMBERINPUTFORMATS:{"0":"#,##0.###"},INTEGERINPUTFORMATS:{"0":"#,##0"},NUMBEROUTPUTFORMAT:"#0.##########",INTEGEROUTPUTFORMAT:"#0",DECIMALSEPARATOR:".",THOUSANDSEPARATOR:","},expression:{METRICVALIDATIONLEVEL:"0",PRESERVEWHITESPACE:false,Include:[{did:"1",n:mstrmojo.desc(3945,"Include")},{did:"2",n:mstrmojo.desc(3946,"Exclude")}],BranchQual:[{did:"19",n:mstrmojo.desc(5282,"AND")},{did:"20",n:mstrmojo.desc(5283,"OR")},{did:"21",n:mstrmojo.desc(12298,"NOT")},{did:"19_21",n:mstrmojo.desc(5924,"AND NOT")},{did:"20_21",n:mstrmojo.desc(5925,"OR NOT")}],RootOperator:[{did:"19",n:mstrmojo.desc(534,"All selections")},{did:"20",n:mstrmojo.desc(535,"Any selection")}],ExprType:[{did:"2",n:mstrmojo.desc(546,"Qualify")},{did:"5",n:mstrmojo.desc(547,"Select")}],DimtyLevels:[{did:"1",n:mstrmojo.desc(2171,"Default")},{did:"2",n:mstrmojo.desc(3086,"Metric")},{did:"3",n:mstrmojo.desc(3344,"Report")}],Attribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,76",n:mstrmojo.desc(686,"Contains"),t:1,tp:1},{did:"1,79",n:mstrmojo.desc(2784,"Does not contain"),t:1,tp:1},{did:"1,77",n:mstrmojo.desc(687,"Begins with"),t:1,tp:1},{did:"1,80",n:mstrmojo.desc(2785,"Does not begin with"),t:1,tp:1},{did:"1,78",n:mstrmojo.desc(688,"Ends with"),t:1,tp:1},{did:"1,81",n:mstrmojo.desc(2786,"Does not end with"),t:1,tp:1},{did:"1,18",n:mstrmojo.desc(525,"Like"),t:1,tp:1},{did:"1,43",n:mstrmojo.desc(526,"Not Like"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],Metric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,54",n:mstrmojo.desc(2202,"Is Null"),t:1,tp:1},{did:"1,55",n:mstrmojo.desc(2203,"Is Not Null"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"2,1",n:mstrmojo.desc(529,"Highest"),t:2,tp:2},{did:"2,2",n:mstrmojo.desc(530,"Lowest"),t:2,tp:2},{did:"3,1",n:mstrmojo.desc(4407,"Highest %"),t:3,tp:3},{did:"3,2",n:mstrmojo.desc(4406,"Lowest %"),t:3,tp:3}],MetricRP:[{did:"2,13",n:mstrmojo.desc(13897,"Rank between highest"),t:2,tp:2},{did:"2,4",n:mstrmojo.desc(1101,"Exclude highest"),t:2,tp:2},{did:"2,3",n:mstrmojo.desc(13896,"Rank between lowest"),t:2,tp:2},{did:"2,5",n:mstrmojo.desc(1102,"Exclude lowest"),t:2,tp:2},{did:"3,13",n:mstrmojo.desc(13890,"Between highest")+"%",t:3,tp:3},{did:"3,4",n:mstrmojo.desc(1101,"Exclude highest")+"%",t:3,tp:3},{did:"3,3",n:mstrmojo.desc(13889,"Between lowest")+"%",t:3,tp:3},{did:"3,5",n:mstrmojo.desc(1102,"Exclude lowest")+"%",t:3,tp:3}],MDXAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1},{did:"1,44",n:mstrmojo.desc(746,"Not between"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1}],MDXMetric:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],SAPAttribute:[{did:"1,6",n:mstrmojo.desc(2795,"Equals"),t:1,tp:1},{did:"1,7",n:mstrmojo.desc(2796,"Does not equal"),t:1,tp:1},{did:"1,22",n:mstrmojo.desc(587,"In"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2204,"Not In"),t:1,tp:1},{did:"1,8",n:mstrmojo.desc(521,"Greater than"),t:1,tp:1},{did:"1,10",n:mstrmojo.desc(522,"Greater than or equal to"),t:1,tp:1},{did:"1,9",n:mstrmojo.desc(523,"Less than"),t:1,tp:1},{did:"1,11",n:mstrmojo.desc(524,"Less than or equal to"),t:1,tp:1},{did:"1,17",n:mstrmojo.desc(696,"Between"),t:1,tp:1}],Element:[{did:"1,22",n:mstrmojo.desc(2219,"In List"),t:1,tp:1},{did:"1,57",n:mstrmojo.desc(2220,"Not In List"),t:1,tp:1}]},validation:{requiredFieldError:mstrmojo.desc(6078,"This field is required."),invalidCharError:mstrmojo.desc(7899,"This field contains invalid characters for #."),invalidDateStringError:mstrmojo.desc(7900,"This field contains invalid date/time string."),invalidNumericFormatError:mstrmojo.desc(7901,"This field contains numeric value with incorrect format."),outofRangeError:mstrmojo.desc(6079,"This field should be # between ## and ###."),noLessMinError:mstrmojo.desc(6081,"This field should be # greater than or equal to ##."),noGreaterMaxError:mstrmojo.desc(6080,"This field should be # less than or equal to ###."),failRegexTestError:mstrmojo.desc(6082,"This field failed regular expression validation."),invalidValueInListError:mstrmojo.desc(7902,"One of the value (#) in this list is not valid."),integerDataType:mstrmojo.desc(6076,"an Integer value"),numericDataType:mstrmojo.desc(6077,"a Number value"),dateDataType:mstrmojo.desc(7903,"a Date/Time value")},color:{colors:[{n:"Black",v:"#000000"},{n:"Brown",v:"#993300"},{n:"Olive Green",v:"#333300"},{n:"Dark Green",v:"#003300"},{n:"Dark Teal",v:"#003366"},{n:"Dark Blue",v:"#000080"},{n:"Indigo",v:"#333399"},{n:"Grey-80%",v:"#333333"},{n:"Dark Red",v:"#800000"},{n:"Orange",v:"#FF6600"},{n:"Dark Yellow",v:"#808000"},{n:"Green",v:"#008000"},{n:"Teal",v:"#008080"},{n:"Blue",v:"#0000FF"},{n:"Blue-Grey",v:"#666699"},{n:"Grey-50%",v:"#808080"},{n:"Red",v:"#FF0000"},{n:"Light Orange",v:"#FF9900"},{n:"Lime",v:"#99CC00"},{n:"Sea Green",v:"#339966"},{n:"Aqua",v:"#33CCCC"},{n:"Light Blue",v:"#3366FF"},{n:"Violet",v:"#800080"},{n:"Grey-40%",v:"#969696"},{n:"Pink",v:"#FF00FF"},{n:"Gold",v:"#FFCC00"},{n:"Yellow",v:"#FFFF00"},{n:"Bright Green",v:"#00FF00"},{n:"Turquoise",v:"#00FFFF"},{n:"Sky Blue",v:"#00CCFF"},{n:"Plum",v:"#993366"},{n:"Grey-25%",v:"#C0C0C0"},{n:"Rose",v:"#FF99CC"},{n:"Tan",v:"#FFCC99"},{n:"Light Yellow",v:"#FFFF99"},{n:"Light Green",v:"#CCFFCC"},{n:"Light Turquoise",v:"#CCFFFF"},{n:"Pale Blue",v:"#99CCFF"},{n:"Lavender",v:"#CC99FF"},{n:"White",v:"#ffffff"}],userPalette:[{n:"#F00E0E",v:"#F00E0E"},{n:"#080000",v:"#080000"},{n:"#E81A1A",v:"#E81A1A"},{n:"#6E0909",v:"#6E0909"},{n:"#4F2828",v:"#4F2828"},{n:"#141212",v:"#141212"},{n:"#D60202",v:"#D60202"},{n:"#C40404",v:"#C40404"}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var I=mstrmojo.array,M=mstrmojo.hash;function J(U){if(U!==null){return(U.constructor!==Array)?[U]:U;}return null;}function F(e,c,Y){if(!c){return null;}var f=[],V=e.selectedIndices,U=e.allIdx,a=e.noneIdx;if(e.multiSelect&&(a>-1)&&(I.indexOf(c,a)>-1)){return f;}var X,Z,d=e.items,b=e.itemIdField,W=e.selectedItems,h;if(e.multiSelect&&(U>-1)&&(I.indexOf(c,e.allIdx)>-1)){for(X=0,Z=d.length;X<Z;X++){if(!V[X]){f.push(X);V[X]=true;e.selectedIndex=X;e.selectedItem=d[X];}}}else{for(X=0,Z=c.length;X<Z;X++){var g=c[X];if(!V[g]){V[g]=true;if(Y){f.push({idx:g,positions:Y});}else{f.push(g);}e.selectedIndex=g;h=e.selectedItem=d[g];if(W){W[h[b]]=h;}}}}return f;}function D(X,U){var W=[],Y=X.selectedIndices,Z=X.selectedItems,V;for(V in Y){delete Y[V];if(U){W.push({idx:parseInt(V,10),positions:U});}else{W.push(parseInt(V,10));}}X.selectedIndex=-1;X.selectedItem=null;if(Z){X.selectedItems={};}return W;}function T(e,d,Y){if(!d){return null;}var a=[],V=e.selectedIndices,g=I.indexOf,U=e.allIdx,b=e.noneIdx,c=e.itemIdField,W=e.selectedItems;if(e.multiSelect&&(((U>-1)&&(g(d,U)>-1))||((b>-1)&&(g(d,b)>-1)))){return D(e);}if(d.length>0&&V[U]){if(g(d,U)<0){d.push(U);}}var Z=d.length,X;for(X=0;X<Z;X++){var f=d[X];if(V[f]){delete V[f];if(Y){a.push({idx:f,positions:Y});}else{a.push(f);}if(W){delete W[e.items[f][c]];}if(e.selectedIndex===f){e.selectedIndex=-1;e.selectedItem=null;}}}return a;}function C(X,Y,V,U){if(U){return ;}if(this.raiseEvent){if((X&&X.length)||(Y&&Y.length)){try{this.raiseEvent({name:"selectionChange",added:X,removed:Y});}catch(W){T(this,X);F(this,Y);throw W;}}}}function B(V){var W=this.itemIdField,U=this.items;if(typeof V==="object"&&W){return I.find(U,W,V[W]);}return I.indexOf(U,V);}mstrmojo._ListSelections={multiSelect:false,allIdx:-1,noneIdx:-1,itemIdField:"",items:null,selectedIndices:null,selectedIndex:-1,selectedIndices_bindEvents:"selectionChange",selectedIndex_bindEvents:"selectionChange",selectedItem:null,selectedItem_bindEvts:"selectionChange",allowUnlistedValues:true,selectedItems:null,supportsIncFetch:false,init:function(U){this._super(U);if(this.supportsIncFetch&&this.itemIdField){this.selectedItems={};}if(!this.items){this.items=[];}if(!this.selectedIndices){this.selectedIndices={};if(this.selectedIndex>-1){this._set_selectedIndex("selectedIndex",this.selectedIndex,true);}else{if(this.selectedItem){this._set_selectedItem("selectedItem",this.selectedItem,true);}}}},addItems:function K(d){d=J(d);if(!d){return ;}var a=this.items,U=this.items.length,W=this.selectedItems,Y=[],V;a=this.items=a.concat(d);V=a.length;if(W){var Z=this.itemIdField,X,c;for(X=U;X<a.length;X++){c=a[X];if(W[c[Z]]){Y.push(X);}}}if(Y&&Y.length){F(this,Y);}if(V>U){var b=this.itemsContainerNode;if(b){b.innerHTML+=this._buildItemsMarkup(U,V-1).join("");}}},addSelectedItems:function S(U){this.selectItems(U,false);},setSelectedItems:function L(U){this.selectItems(U,true);},selectItems:function R(c,e){c=J(c);if(!c){return ;}if(e&&this.selectedItems){this.selectedItems={};}var W=this.selectedItems,a=this.itemIdField,U=[],Y=this.items.length,Z=[],V=this.allowUnlistedValues,d,b,X;for(X=0;X<c.length;X++){d=c[X];b=B.call(this,d);if(b<0){if(W===null){if(V){U.push(d);b=Y++;Z.push(b);}}else{W[d[a]]=d;}}else{Z.push(b);}}if(U.length>0){this.addItems(U);}if(Z.length>0){if(e){this.select(Z);}else{this.addSelect(Z);}}},unselectItems:function A(V){V=J(V);if(!V){return ;}var a=this.selectedItems,W=[],Z=this.itemIdField,Y,U,X;if(a===null){return ;}for(X=0;X<V.length;X++){Y=V[X];if(a){delete a[Y[Z]];}U=B.call(this,Y);if(U<0){W.push(U);}}if(W.length>0){this.removeSelect(W);}},getSelectedItems:function G(){if(this.selectedItems){return M.valarray(this.selectedItems);}return I.get(this.items,M.keyarray(this.selectedIndices,true));},singleSelect:function(V,W,U){if(V!==-1){this.select([V],W,U);}},singleSelectByField:function O(V,W,U){this.singleSelect(I.find(this.items,W,V),U);},toggleSelect:function Q(U){var W,V;if(this.selectedIndices[U]){V=T(this,[U]);}else{W=F(this,[U]);}C.call(this,W,V,[U]);},select:function(W,V,U){W=J(W);if(!W){return ;}var Y=D(this,U),a=F(this,W,U),X;if(this.selectionPolicy!=="reselect"){for(X=Y.length-1;X>=0;X--){var Z=I.indexOf(a,Y[X]);if(Z>-1){Y.splice(X,1);a.splice(Z,1);}}}C.call(this,a,Y,W,V);},rangeSelect:function H(V,U){var a=this.selectedIndex,Y=a,Z=this.allIdx,W=[],X;if(V===Z||this.selectedIndices[Z]){W.push(Z);}else{if(Y===-1&&this.selectedIndices){for(X in this.selectedIndices){Y=parseInt(X,10);break;}}Y=Y===-1?0:Y;if(Y>V){Y=V;V=a;}for(X=Y;X<=V;X++){W.push(X);}}this.select(W,U);this.selectedIndex=a;},clearSelect:function(U){C.call(this,null,D(this),[],U);if(!U){this.raiseEvent({name:"clearSelection"});}},addSelect:function(X,U,V){X=J(X);if(!X){return ;}var W=F(this,X,V),Z=null,Y=this.noneIdx;if(this.multiSelect&&(Y>-1&&I.indexOf(X,Y)>-1)){Z=T(this,X);}C.call(this,W,Z,X,U);},removeSelect:function(W,U,V){W=J(W);if(!W){return ;}C.call(this,null,T(this,W,V),W,U);},_set_selectedIndices:function P(W,c,U){if(this.selectedItems){this.selectedItems={};}var V=this.selectedIndices;if(V===c){return false;}if(!V){V={};this.selectedIndices=V;}if(!c){c={};}var a=this.selectedIndex,Z=[],b;for(b in V){if(!c[b]){b=parseInt(b,10);delete V[b];Z.push(b);if(a===b){this.selectedIndex=-1;this.selectedItem=null;}}}var f=[],d=this.items,Y=this.itemIdField,e;for(b in c){if(!V[b]){b=parseInt(b,10);V[b]=true;f.push(b);this.selectedIndex=b;e=this.selectedItem=d[b];if(this.selectedItems){this.selectedItems[e[Y]]=e;}}}if(U!==true){var X=[];for(b in c){if(V[b]){b=parseInt(b,10);X.push(b);}}C.call(this,f,Z,X);}return(f.length||Z.length);},_set_selectedIndex:function N(X,V,U){var W={};if(V>-1){W[V]=true;}return this._set_selectedIndices("selectedIndices",W,U);},_set_selectedItem:function E(X,W,V){var U=B.call(this,W);if((U<0)&&(W!==null&&W!==undefined)&&this.allowUnlistedValues&&this.items){this.set("items",this.items.concat(W));U=this.items.length-1;}return this._set_selectedIndex("selectedIndex",U,V);},_addSelections:function(U){return F(this,U);},_removeAll:function(){return D(this);}};}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash");var E=mstrmojo.func.wrapMethods;function B(L,I,K,H,J){return E({success:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("success",I.target,JSON.stringify(I.memo),JSON.stringify(M));}},complete:function(){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("complete",I.target,JSON.stringify(I.memo));}J.removeCallback(K,H);},failure:function(M){if(mstrMobileApp&&mstrMobileApp.sendCallback){mstrMobileApp.sendCallback("failure",I.target,JSON.stringify(I.memo),JSON.stringify(M));}}},L);}mstrmojo._CanProxyCallback=mstrmojo.provide("mstrmojo._CanProxyCallback",{_mixinName:"mstrmojo._CanProxyCallback",callbacks:null,isCallbackReceiver:false,newCallback:function D(O){return O;var K=this.callbacks,I=mstrmojo.hash.copy(O),P=(O.index!==undefined)?String(O.index):"index",N=arguments.callee.caller.arguments,L,J,M,H=O.method||"anonymous";if(!K){K=this.callbacks={};}if(!K[H]){K[H]={};}if(!this.isCallbackReceiver){for(J=0,M=N.length;J<M;J++){L=N[J];if(L&&L.target){I=B(I,L,H,P,this);break;}}}if(!O.method){I.proxy=this.getCallbackMemo();}K[H][P]=I;return I;},anonymous:function(J,K,I,H){if(!this.isCallbackReceiver){K=B(K,H,"anonymous","index",this);mstrApp.serverRequest(J,K,I);}},getCallback:function C(K,J){var H=J||"index",I=this.callbacks;return I&&I[K]&&I[K][H];},removeCallback:function G(K,J){var H=J||"index",I=this.callbacks;if(I&&I[K]){delete I[K][H];if(mstrmojo.hash.isEmpty(I[K])){delete I[K];}}},getCallbackMemo:function F(I,H){return{target:'mstrmojo.all["'+this.id+'"].receiveCallback',memo:{method:I||"anonymous",index:H||"index"}};},receiveCallback:function A(L,J,K){var M=J.method,I=J.index,H=this.getCallback(M,I);if(H&&L&&H[L]){H[L](K);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var C=mstrmojo.hash;mstrmojo._CanSupportTransaction={_mixinName:"mstrmojo._CanSupportTransaction",updatedCellsMap:null,getUpdates:mstrmojo.emptyFn,getUpdateObject:mstrmojo.emptyFn,getKeyContext:mstrmojo.emptyFn,autoRefresh:mstrmojo.emptyFn,editNext:mstrmojo.emptyFn,buildConditions:mstrmojo.emptyFn,dataChanged:function A(G,H,F,I,D){var E=this.updateValue(G,F);this.updatedCellsMap[G]={r:H,v:F};this.controller.onTransactionUpdates(this,this.getUpdateObject(),E,D);},postBuildRendering:function B(){if(this._super){this._super();}if(!this.txModel){this.txModel=this.model.docModel||this.model;}this.updatedCellsMap=this.updatedCellsMap||{};},updateValue:function(E,D){if(this.txModel.deltaUpdate){this.txModel.deltaUpdate(this);}return false;},getUpdatedValues:function(){var E=this.updatedCellsMap,F,D,G=[];for(F in E){if(E.hasOwnProperty(F)){D={};D.v=E[F].v.v;G.push(C.copy(this.getKeyContext(F),D));}}return G;},clear:function(){this.updatedCellsMap={};},registerTxWidget:function(){function E(F,H){var G=F.node.data.k;H.txWidgets=H.txWidgets||{};H.txWidgets[G]=F;return false;}var D=this.parent;while(D){if(D.isPanelStack===true){E(this,D);}D=D.parent;}}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.requiresDescs(2213,3326,3327,3329,4531,13283,13284,13285,13286);mstrmojo.ME.Enum={METRIC_ACTIONS:{ADD:"add",EDIT:"edit",EIDT_NEW:"editNew"},EDITOR_IDS:{ADVANCED:"mstrME",FORMULA:"mstrME",WIZARD:"mstrFE",SIMPLE:"mstrSME",SELECOTR:"mstrFSE"},EDITOR_TYPES:{ADVANCED:"ADVANCED",FUNCTION:"FUNCTION",SIMPLE:"SIMPLE",SELECTOR:"SELECTOR"},METRIC_EDIT_TYPES:{ADVANCED:65536,SIMPLE:131072,FUNCTION:196608},METRIC_TYPES:{65536:"ADVANCED",131072:"SIMPLE",196608:"FUNCTION"},NEW_METRIC_DEFINITION:{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}},getNewDefinition:function(){return{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}};},FBFlag:{Automatic:0,Manual:3},AFB:{Automatic:-1,False:0,True:1},SFB:{Automatic:-1,False:1,True:2},UI_OBJECT_TYPE:{Dimty:-1,Sub_Expression:-2,Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},UI_DATA_TYPE:{Sortby:-1,Breakby:-2,Level:-4,Condition:-5,Transformation:-6},SHORTCUT_FUNCTIONS:{Level:-4,Condition:-5,Transformation:-6,Row_Count:-7},DYNAMIC_DIMTY:{CODES:{auto:{n:mstrmojo.desc(4531,"Automatic"),did:"@auto",t:-1},page:{n:mstrmojo.desc(3329,"Grand Total"),did:"@p",t:-1},byCol:{n:mstrmojo.desc(3326,"By Columns"),did:"@cols",t:-1},byRow:{n:mstrmojo.desc(3327,"By Rows"),did:"@rows",t:-1},byCell:{n:mstrmojo.desc(13283,"By Cell"),did:"@cell",t:-1},byShape:{n:mstrmojo.desc(13284,"By Shape"),did:"@shape",t:-1},downCross:{n:mstrmojo.desc(13285,"Down, Then Across"),did:"@cr",t:-1},crossDown:{n:mstrmojo.desc(13286,"Across, Then Down"),did:"@rc",t:-1}},getItems:function D(G){var F=this.CODES,E=[];switch(G){case"breakby":E=[F.auto,A.copy({n:mstrmojo.desc(2057,"None")},A.copy(F.page)),A.copy({n:mstrmojo.desc(122,"Columns")},A.copy(F.byCol)),A.copy({n:mstrmojo.desc(2968,"Rows")},A.copy(F.byRow)),A.copy({n:mstrmojo.desc(13399,"Cell")},A.copy(F.byCell)),A.copy({n:mstrmojo.desc(2923,"Shape")},A.copy(F.byShape))];break;case"level":E=[F.auto,F.page,F.byCol,F.byRow,F.byCell,F.byShape];break;case"sortby":E=[F.auto,F.downCross,F.crossDown];}return E;},getAutomaticDimtyObject:function C(){return A.copy(this.CODES.auto);},getDimtyObject:function B(E,H){var F=null;var G=false;if(H){A.forEach(mstrmojo.ME.Enum.DYNAMIC_DIMTY.CODES,function(I){if(I.did===E){F=A.copy(I);G=true;return false;}});}if(!G){F={n:E,t:-1,dimty:true};}return F;}},NonExposableParams:["IsNewOLAP","OLAPPattern","OLAPHasWindow"]};mstrmojo.ME.Enum.DEFAULT_MPS={mps:{afb:mstrmojo.ME.Enum.AFB.False,sfb:mstrmojo.ME.Enum.SFB.False,fbf:mstrmojo.ME.Enum.FBFlag.Automatic}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var C=mstrmojo.hash,E=mstrmojo.array;function D(F){return function(G){F[G]=true;};}mstrmojo.rw.model.UpdateKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.UpdateKeysConfig",init:function B(){this.nodes=[];this.selectors={};this.objects={};}});mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig=function A(J){var F={},K={},G={},I={};E.forEach(J,function H(M){var L=M.partialUpdate;if(L){E.forEach(L.nodes,D(K));E.forEach(L.selectors,D(G));E.forEach(L.objects,function(N){if(!I[N.id]||N.flag>I[N.id].flag){I[N.id]=N;}});delete M.partialUpdate;}E.forEach(M.actions,H);});if(!C.isEmpty(K)){F.nodes=C.keyarray(K);}if(!C.isEmpty(G)){F.selectors=C.keyarray(G);}if(!C.isEmpty(I)){F.objects=C.valarray(I);}return F;};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var N=/\{\@(en@)?([^\}]+)\}/gm,J=/\</gm,R=/\>/gm,E=/\S/,Q=["$","^","=","!",":","/",".","*","+","?","|","(",")","[","]","{","}","\\"],F=new RegExp("(\\"+Q.join("|\\")+")","g"),S={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;",u0009:"&#x09;","\n":"&#x0A;","\r":"&#x0D;",'"':"&quot;"},C={"&":{k:"&(?!#?\\w+;)",v:"&amp;"},"<":"&lt;",">":"&gt;"," ":"&nbsp;","\n":"<br/>","\r":"&nbsp;&nbsp;&nbsp;&nbsp;","'":"&#039;",'"':"&quot;"},M={"&amp;":"&","&lt;":"<","&gt;":">","&nbsp;":" ","<br/>":"\n","&nbsp;&nbsp;&nbsp;&nbsp;":"\r","&#039;":"'","&quot;":'"'},D={"&":"&amp;","<":"&lt;",">":"&gt;","'":"&#039;",'"':"&quot;","\u20ac":"&#8364;"},K={"&amp;":"&","&lt;":"<","&gt;":">","&#039;":"'","&quot;":'"',"&#8364;":"\u20ac"};var L=function(V){if(V===null){return"null";}var W=typeof V;if(W!=="object"){return W;}if(V.length===undefined){return"object";}return"array";};var T={strictMode:false,key:["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q:{name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},parser:{strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}};mstrmojo.string=mstrmojo.provide("mstrmojo.string",{multiReplace:function G(W,Z,Y){var V;Y=Y||[];if(!W){return"";}var X=[];for(V in Z){if(mstrmojo.array.indexOf(Y,V)===-1){X.push(V.k||V);}}return W.replace(new RegExp(X.join("|"),"g"),function(a){var b=Z[a];return b.v||b;});},trim:function P(V){return(V&&V.replace)?V.replace(/^\s+/,"").replace(/\s+$/,""):V;},startsWith:function U(W,V){return W.length>=V.length&&W.substring(0,V.length)==V;},ellipsize:function A(X,W){var V=this.trim(X.substr(0,(W||1)-1));if(V!==X){V+="&hellip;";}return V;},isEmpty:function I(V){return(V===null)||(V===undefined)||!(E.test(V));},regEscape:function O(V){return V.replace(F,"\\$1");},encodeXMLAttribute:function(V){return mstrmojo.string.multiReplace(V,S);},encodeHtmlString:function(W,V,X){if(!W||!W.replace){return W;}if(X){return mstrmojo.string.multiReplace(W,D);}return mstrmojo.string.multiReplace(W,C,V?[" "]:[]);},decodeHtmlString:function(W,V){return V?mstrmojo.string.multiReplace(W,K):mstrmojo.string.multiReplace(W,M);},htmlAngles:function(V){if(!mstrmojo.string.isEmpty(V)){V=String(V);return V.replace(J,"&lt;").replace(R,"&gt;");}return V;},apply:function H(V,X){if(!V){return"";}var W=this;return V.replace(N,function Y(b,c,d){var Z;try{Z=mstrmojo.hash.walk(d,X);}catch(a){}Z=(Z===null||Z===undefined)?"":Z;return(!!c)?W.encodeHtmlString(Z,true):Z;});},json2xml:function(V,k,l){if(!(k instanceof Array)){k=[k];}var W=l&&l.isSerializable,j=(l.convertBoolean!==false),o=l&&l.skipFunctions,h,b;var d=[],Z=[],c,Y,a;for(h=0,b=k.length;h<b;h++){var g=k[h];for(c in g){if(o&&typeof g[c]==="function"){continue;}if(W){var m=W(c,k,h);if(m!==true){if(m===false){continue;}else{if(m.att){d.push(m.att);}if(m.child){Z.push(m.child);}continue;}}}Y=g[c];a=L(Y);switch(a){case"array":var e,f;Z.push("<"+c+">");for(e=0,f=Y.length;e<f;e++){var X=l.getArrItemName(c,Y,e)||e;Z.push(this.json2xml(X,Y[e],l));}Z.push("</"+c+">");break;case"object":Z.push(this.json2xml(c,Y,l));break;case"string":d.push(c+'="'+mstrmojo.string.encodeXMLAttribute(Y)+'"');break;case"boolean":d.push(c+'="'+(j?(Y?"-1":"0"):Y)+'"');break;case"null":if(!l.skipNull){d.push(c+'="'+l.nullValue+'"');}break;default:d.push(c+'="'+Y+'"');break;}}}return"<"+V+" "+d.join(" ")+">"+Z.join("")+"</"+V+">";},escape4HTMLText:function B(c){if(!c||!c.replace){return c;}var Z=/"/gm;var X="&quot;";var d=/&/gm;var b="&amp;";var a=/</gm;var V="&lt;";var Y=/>/gm;var W="&gt;";return c.replace(d,b).replace(Z,X).replace(a,V).replace(Y,W);},parseUri:function(Z,W){W=W||T;var V=W.parser[((W.strictMode)?"strict":"loose")].exec(Z),Y={},X=14;while(X--){Y[W.key[X]]=V[X]||"";}Y[W.q.name]={};Y[W.key[12]].replace(W.q.parser,function(b,a,c){if(a){Y[W.q.name][a]=c;}});return Y;},removeSpecialChars:function(V){return V.replace(/[^a-zA-Z0-9]/g,"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array,B=mstrmojo.hash;mstrmojo.models.datasets.DataInterface=mstrmojo.provide("mstrmojo.models.datasets.DataInterface",{getFormsByAttrId:function A(F,E){var D=[];E=E||[];B.forEach(E,function(G){C.forEach(G.att||[],function(H){if(H.did===F){D=D.concat(H.fs||[]);return false;}});});D=C.filter(D,function(G){return !!G.obf;});return C.distinct(D,"fid");}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");mstrmojo.vi.ui.rw.SelectionType={EMPTY:"empty",ATTS:"att",METRICS:"metric",COL_HEADERS:"col-headers",ROW_HEADERS:"row-headers",METRIC_VALUES:"metric-values"};var D=function(Z){var Y=(mstrApp.docModelData&&mstrApp.docModelData.mid)||"";return Z.k+"-"+Y;},M={},Q=mstrmojo.hash,V=mstrmojo.array,S=function(a){var Y=Q.keyarray(a).sort(),Z=[],b;V.forEach(Y,function(c){b=[];V.forEach(a[c],function(d){b.push(this.model.getNormalizedFormElementId(d.id));},this);Z.push(c+"-"+b.sort().join("@"));},this);return Z.join("#");},X=function(Y){var Z=S.call(this,Y);if(!this._viSelections[Z]){this._viSelections[Z]=Y;M[D(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}},C=function(Z){var a=S.call(this,Z),Y=this._viSelections[a];if(Y){delete this._viSelections[a];M[D(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};}return Y;},K=function(Z,Y,b){var a={};a[Z]=[{id:Y,n:b}];return a;},O=mstrmojo.vi.ui.rw.SelectionType;mstrmojo.vi.ui.rw._HasVisSelections=mstrmojo.provide("mstrmojo.vi.ui.rw._HasVisSelections",{_mixinName:"mstrmojo.vi.ui.rw._HasVisSelections",init:function(Y){if(this._super){this._super(Y);}this._viSelections={};},update:function F(Z){var Y=true;if(this._super){Y=this._super(Z);}Q.copy(M[D(this)],this);return Y;},onSelectionChange:function L(Y){if(this._super){this._super(Y);}},_viSelections:{},_selectionType:O.EMPTY,getSelectionType:function(){return this._selectionType;},isSingleAttrSelection:function(){var Z=null,Y;if(this.getSelectionType()===O.ATTS){Y=this.getSelections();if(Y.length>1){return !Y.some(function(a){if(!Z){Z=a[0].tid;return false;}return Z!=a[0].tid;},this);}return true;}return false;},isSingleSelection:function(){return(this._viSelections&&Q.keyarray(this._viSelections).length===1);},getSelectionSize:function U(){return(this._viSelections&&Q.keyarray(this._viSelections).length)||0;},getSelectionHash:function E(){return this._viSelections;},getSelections:function I(){var Y=[],Z;Q.forEach(this._viSelections,function(a){Z=[];Y.push(Z);Q.forEach(a,function(b,c){V.forEach(b,function(d){Z.push({tid:c,eid:d.id,v:d.n});});});});return Y;},isMetricValueSelected:function G(Y){return !!this._viSelections[S.call(this,Y)];},isAttSelected:function B(Z,Y){return this.isMetricValueSelected(K(Z,Y));},addAttributeSelection:function N(Z,Y,a){if(this._selectionType!==O.ATTS){this.clearSelections();this._selectionType=O.ATTS;}var b=K.call(this,Z,Y,a);X.call(this,b);return b[Z];},removeAttributeSelection:function W(Z,Y){return C.call(this,K.call(this,Z,Y));},addMetricValueSelection:function J(Y){if(this._selectionType!==O.METRICS){this.clearSelections();this._selectionType=O.METRICS;}X.call(this,Y);},removeMetricValueSelection:function R(Y){return C.call(this,Y);},clearSelections:function A(){if(this._super){this._super();}this._viSelections={};this._selectionType=O.EMPTY;},clearSelectionsCache:function H(){M={};},clearUnitSelections:function A(Z){if(this._super){this._super();}var Y={};Q.forEach(this._viSelections,function(b,a){if(Q.keyarray(b)[0]!==Z){Y[a]=b;}});this._viSelections=Y;},endSelections:function P(){M[D(this)]={_selectionType:this.getSelectionType(),_viSelections:this.getSelectionHash()};this.onSelectionChange(this.getSelectionHash());},addSelectionsFromExpression:function T(a){this.clearSelections();this._selectionType=a.type;var Y=this,Z=function(g){var h=20,e=19,f=function(j){return j.nds.length===1?h:j.fn;},d=function(j){return parseInt(j.et,10)===5||parseInt(f(j),10)===e;},b=function(j){V.forEach(j.es,function(k){Y.addAttributeSelection(j.a.did,k.v,k.n);});},c=function(l){var k={},j=function(m){V.forEach(m.es,function(n){Q.copy(K.call(Y,m.a.did,n.v,n.n),k);});};if(l.nds){V.forEach(l.nds,j);}else{if(l.es){j(l);}}Y.addMetricValueSelection(k);};if(d(g)){g={nds:[g]};}V.forEach(g.nds,function(j){if(d(j)){if(a.type===O.ATTS){b(j);}else{c(j);}}else{Z(j);}});};Z(a.data);}});mstrmojo.vi.ui.rw._HasVisSelections.VisSelectionType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var K=mstrmojo.array,D=mstrmojo.hash;function E(V,T){var W=[],Q=V.selectedIndices,P=V.allIdx;var R,S,U=V.items;if(V.multiSelect&&(P>-1)&&(K.indexOf(T,V.allIdx)>-1)){for(R=0,S=U.length;R<S;R++){if(!Q[R]){W.push(R);Q[R]=true;V.selectedIndex=R;V.selectedItem=U[R];}}}else{for(R=0,S=T.length;R<S;R++){var X=T[R];if(!Q[X]){Q[X]=true;W.push(X);V.selectedIndex=X;V.selectedItem=U[X];}}}return W;}function J(R){var Q=[],S=R.selectedIndices,P;for(P in S){delete S[P];Q.push(parseInt(P,10));}R.selectedIndex=-1;R.selectedItem=null;return Q;}function H(V,U){var S=[],Q=V.selectedIndices,X=K.indexOf,P=V.allIdx;if(V.multiSelect&&(P>-1)&&(X(U,P)>-1)){return J(V);}if(U.length>0&&Q[P]){if(X(U,P)<0){U.push(P);}}var T=U.length,R;for(R=0;R<T;R++){var W=U[R];if(Q[W]){delete Q[W];S.push(W);if(V.selectedIndex===W){V.selectedIndex=-1;V.selectedItem=null;}}}return S;}function A(S,R){var P=S.selectedIndices;if(!P){P={};S.selectedIndices=P;}if(!R){R={};}var U=S.selectedIndex,T=[],V,Q;for(Q in P){if(!R[Q]){V=parseInt(Q,10);delete P[Q];T.push(V);if(U===V){S.selectedIndex=-1;S.selectedItem=null;}}}var X=[],W=S.items;for(Q in R){if(!P[Q]){V=parseInt(Q,10);P[Q]=true;X.push(V);S.selectedIndex=V;S.selectedItem=W&&W[V];}}return{add:X,rmv:T};}function G(Q,P,R){if(Q.raiseEvent&&((P&&P.length)||(R&&R.length))){Q.raiseEvent({name:"change",added:P,removed:R});}}mstrmojo._ListBase2Selections=mstrmojo.provide("mstrmojo._ListBase2Selections",{multiSelect:false,selectedIndices:null,selectedIndex:-1,selectedItem:null,selectedIndices_bindEvents:"change",selectedIndex_bindEvents:"change",selectedItem_bindEvents:"change",allowUnlistedValues:true,insertUnlistedValuesAt:-1,allIdx:-1,singleSelect:function F(P,Q){if(!this.selectedIndices[P]||(this.selectionPolicy==="reselect")||(P!==this.allIdx&&this.selectedIndices[this.allIdx])){var R=J(this),S=E(this,[P]);if(Q!==true){G(this,S,R);}}},toggleSelect:function O(P,Q){var S,R;if(this.selectedIndices[P]){R=H(this,[P]);}else{S=E(this,[P]);}if(Q!==true){G(this,S,R);}},rangeSelect:function N(P,Q){this.singleSelect(P,Q);},clearSelect:function I(P){var Q=J(this);if(P!==true){G(this,null,Q);}},select:function L(R,P){var Q=A(this,K.hash(R));if((P!==true)&&(Q.add.length||Q.rmv.length)){G(this,Q.add,Q.rmv);}},addSelect:function B(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=E(this,R);if(P!==true){G(this,Q,null);}return Q;},removeSelect:function M(R,P){if(R===null||R===undefined){return null;}if(R.constructor!==Array){R=[R];}var Q=H(this,R);if(P!==true){G(this,null,Q);}return Q;},_set_selectedIndices:function(S,Q,P){if(this.selectedIndices===Q){return false;}var R=A(this,Q);if(R.add.length||R.rmv.length){if(P!==true){G(this,R.add,R.rmv);}}return false;},_set_selectedIndex:function(S,Q,P){var R={};if(Q>-1){R[Q]=true;}return this._set_selectedIndices(null,R,P);},_set_selectedItem:function(W,T,S){var R=T&&(typeof T==="object"),V=this.itemIdField,Q=-1,U=this.items;if(R&&V!=null){Q=K.find(U,V,T[V]);}else{if(T!=null){Q=K.indexOf(U,T);}}if((Q===-1)&&(T!=null)&&this.allowUnlistedValues){var P=this.insertUnlistedValuesAt;if(P==null||P<0){P=(U&&U.length)||0;}Q=P;this.add([T],Q);}return this._set_selectedIndex(null,Q,S);},initSelections:function C(T,Q,P,S,R){if(!this.selectedIndices){this.selectedIndices={};this.selectedIndex=-1;}if(T){this._set_selectedIndices(null,T,R);}else{if(Q){this.select(Q,R);}else{if(S){this._set_selectedItem(null,S,R);}else{if(P!==null&&P!==undefined){this._set_selectedIndex(null,P,R);}}}}},sortSelectedIndices:function(){return D.keyarray(this.selectedIndices,true).sort(K.numSorter);},removeSelectedItems:function(){var R=this.sortSelectedIndices(),P=R.length,S=R[P-1],Q=this.remove(R);S=Math.min(S+1-P,this.items.length-1);if(S>=0){this.singleSelect(S);}return Q;},getSelectedItems:function(){return K.get(this.items,this.sortSelectedIndices())||[];},setSelectedItems:function(Q,d){if(!Q||!Q.length){return ;}var S=this.items||[],t=this.itemIdField!=null?K.findMulti(S,this.itemIdField,Q):K.indexOfMulti(S,Q),V=Q.length,T=V-t.count,q=this.allowUnlistedValues,b=this.insertUnlistedValuesAt,X=(q&&(b>-1))?T:0;if(b<0){b=S.length;}var R=[],U=[],f=t.map;if(T&&q){var p=0,e;for(e=0;e<V;e++){if(f[e]==null){R.push(Q[e]);U.push(b+p++);}}this.add(R,b);}var W=[],h;for(h in f){var o=f[h];if(o>=b){o+=X;}W.push(o);}var r=W.concat(U),Y=this.addSelect(r,!d);if(!d){var Z=K.hash(Y),g=this.selectedIndices,a=[],l;for(l in g){if(!Z[l]){a.push(parseInt(l,10));}}var P=this.removeSelect(a,true);G(this,Y,P);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.base64","mstrmojo.func","mstrmojo.hash");mstrmojo.XhrCallbackType=null;function decodeHeader(value){var rEncoded=/\=\?UTF-8\?B\?(.+?)\?\=/g;if(value&&value.indexOf("=?UTF-8?B?")===0){var decMsg="",result;while((result=rEncoded.exec(value))!==null){decMsg+=mstrmojo.base64.decode(result[1]);}return decMsg;}return value;}function encodeParams(params){var x=-1,url=[],p;if(params){for(p in params){url[++x]=p+"="+encodeURIComponent(params[p]);}}return url.join("&");}function appendUrlParams(method,baseUrl,params){if(method!=="GET"||!params){return baseUrl;}return baseUrl+"?"+encodeParams(params);}function sendXhr(xhr,method,baseUrl,params){method=method.toUpperCase();var app=mstrApp,m=window.microstrategy;if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);params.taskContentType=params.taskContentType||"json";params.taskEnv=params.taskEnv||"xhr";params.xts=new Date().getTime();params[mstrApp.name]=mstrApp.servletState||"";baseUrl=baseUrl||mstrConfig.taskURL;}var ptp=app.persistTaskParams||(m&&m.persistParams);if(ptp){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.hash.copy(ptp,params);}xhr.open(method,appendUrlParams(method,baseUrl,params),this.async);if(method!=="POST"){xhr.send(null);}else{xhr.setRequestHeader("Content-type","application/x-www-form-urlencoded");xhr.send(encodeParams(params));}if(this.async===false){xhr.onreadystatechange();}}function createXhr(){var methods=[function(){return new XMLHttpRequest();},function(){return new ActiveXObject("Msxml2.XMLHTTP");},function(){return new ActiveXObject("Microsoft.XMLHTTP");}],cnt=methods.length,i;for(i=0;i<cnt;i++){var xhr;try{xhr=methods[i]();}catch(e){continue;}createXhr=methods[i];return xhr;}throw new Error("mstrmojo.SimpleXHR: Could not create an XHR object.");}function evalResponse(rt){var rtn=null;try{rtn=eval("("+rt+")");}catch(ex){rtn=rt&&mstrmojo.string.trim(rt);}return rtn;}var MSI_SERVER_NAME_NOT_INITIALIZED=2147760371,MSI_INVALID_SESSION_ID=2147760372,E_MSI_USERMGR_USER_NOTFOUND=2147758245,E_MSI_CONNECT_FAILED=2147759877;function isSessionExpiredError(res){var c=res&&res.getResponseHeader("X-MSTR-TaskErrorCode");c=(c<0)?(4294967296+parseInt(c,10)):c;switch(c){case MSI_SERVER_NAME_NOT_INITIALIZED:case MSI_INVALID_SESSION_ID:case E_MSI_USERMGR_USER_NOTFOUND:case E_MSI_CONNECT_FAILED:return true;}return false;}function xhrSupportsProgress(xhr){return !!(xhr&&xhr.upload&&xhr.upload.onprogress);}mstrmojo.SimpleXHR=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.SimpleXHR",isTask:true,async:true,init:function init(props){mstrmojo.hash.copy(props,this);},onreadystatechange:function onreadystatechange(xhr,callback,prevRequest){if(xhr.readyState!==4){return ;}if(typeof callback!=="object"){return ;}try{if((xhr.status===200)||(xhr.status===304)){this.response=callback.textResponse?xhr.responseText:evalResponse(xhr.responseText);if(typeof callback.success==="function"){callback.success(this.response);}}else{if(xhr.status!==0){var app=mstrApp,sessionExp=app&&app.onSessionExpired;if(sessionExp&&isSessionExpiredError(xhr)){sessionExp.call(app,prevRequest);}else{var orig=xhr.getResponseHeader;xhr.getResponseHeader=function(name){return decodeHeader(orig.apply?orig.apply(xhr,[name]):orig(name));};if(typeof callback.failure==="function"){callback.failure(xhr);}}}}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(typeof callback.complete==="function"){callback.complete();}if(!isSessionExpiredError(xhr)&&!prevRequest.params.notRestartSessionManager){var sm=mstrApp.sessionManager;if(sm&&sm.restart){sm.restart();}}}},cancel:function(){var didCancel=false;var xhr=this.xhr;if(xhr){delete xhr.onreadystatechange;xhr.isAborted=true;if(xhr.readyState<4){xhr.abort();didCancel=true;}this.xhr=null;}return didCancel;},request:function request(method,baseUrl,callback,params,webSvrUrl,useResFeed,webSrvParams){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{var xhr=createXhr();xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}this.xhr=xhr;sendXhr.call(this,xhr,method,baseUrl,params);}}});mstrmojo.QueuedXHR=mstrmojo.declare(mstrmojo.SimpleXHR,null,{scriptClass:"mstrmojo.QueuedXHR",queue:null,requestCount:0,retryDelay:1,lookup:null,cancel:function cancel(){var didCancel=this._super();while(this.queue.length){var x=this.queue.pop();var cb=x.callback;if(cb&&cb.complete){cb.complete();}}this.queue=[];this.requestCount--;return didCancel;},init:function init(){this.queue=[];this.lookup=[];},request:function request(method,baseUrl,callback,params,override,webSvrUrl,useResFeed,webSrvParams,useCache){if(webSvrUrl){if(useResFeed===true){if(!params){params={};}params.srcURL=appendUrlParams("POST",webSvrUrl,webSrvParams);this.request(method,baseUrl,callback,params);}else{mstrmojo.jsonp.request(webSvrUrl,params,callback);}}else{if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue();};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(this,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));if(xhrSupportsProgress(xhr)&&callback.progress){xhr.onprogress=(function(me,x,c){return function(evt){c.progress.call(me,evt);};}(this,xhr,callback));}sendXhr.call(this,xhr,method,baseUrl,params);}}}},upload:function upload(method,baseUrl,callback,params,data,config,override,webSrvParams,useCache){if(this.isTask){params=mstrmojo.addCSRFTokenToTaskParams(params);}if(this.requestCount>0&&!override){this.queue.push({method:method,baseUrl:baseUrl,callback:callback,params:params,data:data,config:config});}else{if(this.requestCount>0){this.cancel();}this.requestCount++;var lu=null,oriParams=null;if(useCache){lu=this._searchForCacheRequest(params);oriParams=mstrmojo.hash.copy(params);}if(lu){try{if(callback.success){window.setTimeout(function(){callback.success(lu.res);},10);}}catch(ex){mstrmojo.err(ex);throw ex;}finally{if(callback.complete){callback.complete();}this.advanceQueue();}}else{var xhr=this.xhr=createXhr();var self=this;callback=mstrmojo.func.wrapMethods(callback,{complete:(function(ths){return function(){ths.advanceQueue.call(ths);};}(this)),success:(function(ths){return function(){if(useCache){ths.lookup.push({params:oriParams,res:ths.response});}};}(this))});var handleProgress=function(event){callback.progress(event,config);};var url=baseUrl;xhr.open("POST",url,false);var formData=new FormData();var a;for(a in params){formData.append(a,params[a]);}if(data){if(params.fileName){formData.append("myFile",data,params.fileName);}else{formData.append("myFile",data);}}if(xhrSupportsProgress(xhr)&&callback.progress){xhr.upload.onprogress=handleProgress;}xhr.onreadystatechange=(function(me,x,c,pr){return function(){me.onreadystatechange(x,c,pr);};}(self,xhr,callback,{method:method,baseUrl:baseUrl,callback:callback,params:params}));xhr.send(formData);}}},advanceQueue:function advanceQueue(){this.requestCount--;if(this.queue.length===0){this.requestCount=0;return ;}var req=this.queue.shift();if(req.params.taskId==="importFile"){this.upload(req.method,req.baseUrl,req.callback,req.params,req.data,req.config);}else{this.request(req.method,req.baseUrl,req.callback,req.params,true);}},_searchForCacheRequest:function _searchForCacheRequest(params){var i;for(i in this.lookup){if(mstrmojo.hash.equals(params,this.lookup[i].params)){return this.lookup[i];}}return null;},hasRequests:function hasRequests(){return this.requestCount>0||mstrmojo.jsonp.hasRequests();}});mstrmojo.xhr=new mstrmojo.QueuedXHR();mstrmojo.jsonp={jsc:new Date().getTime(),timeToWait:20000,requestCount:0,request:function(url,params,callback){var head=document.getElementsByTagName("head")[0]||document.documentElement,jsonp="jsonp"+(this.jsc++),script=document.createElement("script");params.jsonp=jsonp+"(@R@);";params.taskContentType="jsonp";params.taskEnv="jsonp";params.xts=new Date().getTime();window[jsonp]=function(response){mstrmojo.jsonp.requestCount--;if(!response){if(callback.timeout){callback.timeout();}}else{if(response.status===200){callback.success(response.content);}else{var res={status:response.status,getResponseHeader:function(name){switch(name){case"X-MSTR-TaskFailureMsg":return response.errorMsg;case"X-MSTR-TaskErrorCode":return response.errorCode;}}};if(mstrApp.onSessionExpired&&isSessionExpiredError(res)){if(callback.onSessionExpired){callback.onSessionExpired();}else{mstrApp.onSessionExpired();}}else{callback.failure(res);}}}if(window[jsonp]){if(callback.complete){callback.complete();}window[jsonp]=undefined;try{delete window[jsonp];}catch(e){}head.removeChild(script);}};head.insertBefore(script,head.firstChild);this.requestCount++;script.src=appendUrlParams("GET",url,params);setTimeout(function(){var fn=window[jsonp];if(fn){fn();}},this.timeToWait);},hasRequests:function(){return this.requestCount>0;}};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var C=mstrmojo.array;function A(E){var D=(E&&E.gts&&E.gts.col)||[],G=(E&&E.gts&&E.gts.row)||[];var F=C.filter(D.concat(G),function(H){return H.otp===-1;})[0];return{tpltProp:E.prop,mxProp:C.map((F&&F.es)||[],function(H){var I={};I[H.oid]=mstrmojo.hash.copy(H.prop,{n:H.n,t:H.otp});return I;})};}mstrmojo._IsDocumentTemplate=mstrmojo.provide("mstrmojo._IsDocumentTemplate",{_mixinName:"mstrmojo._IsDocumentTemplate",gridInfo:null,tmsProps:null,update:function B(D){if(D&&D.data){this.gridInfo=D.data.gsi;this.tmsProps=A(D.data);}if(this._super){return this._super(D);}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash");mstrmojo.all={};var E=mstrmojo.all,G=mstrmojo.hash;var A=0;function D(){var I;while(!I){var H="mstr"+(A++);if(!E[H]){I=H;}}return I;}mstrmojo.registry=mstrmojo.provide("mstrmojo.registry",{add:function F(H){if(!H){return ;}var I=H.id;if(!I){H.id=I=D();}else{if(E[I]){throw new Error("Tried to register 2 objects with same id: "+I);}}E[I]=H;},remove:function C(H){if(H&&H.id){delete E[H.id];}},dumpAll:function(){var H;for(H in E){var I=E[H].id;if(I){mstrmojo.dbg(I+"("+(E[H].scriptClass||"[unknown class]")+")");}}},ref:function B(I,H){H=H||{};if(I){var L=I;while(L){switch(typeof L){case"string":if(H.skipLoadChecks!==true){mstrmojo.requiresCls(L);}L=G.walk(L,window);break;case"function":return(H.dontInst!==true)?new L():L;case"object":if(L.constructor===Object){var K=L.scriptClass;if(K){if(H.skipLoadChecks!==true){mstrmojo.requiresCls(K);}var J=G.walk(K,window);if(J){return new J((H.clone===true)?G.clone(L):L);}return null;}return L;}return L;default:return null;}}}return null;}});mstrmojo.insert=mstrmojo.registry.ref;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash");var I=mstrmojo.array,B=mstrmojo.hash,D="u;",C="-1";mstrmojo.elementHelper=mstrmojo.provide("mstrmojo.elementHelper",{buildElemsTerseID:function F(P,O,R){var N,M;for(M in P){N=P[M];if(N.v){var Q=N.v.split(";");if(Q&&Q.length>1){Q[1]=O;if(R&&Q.length>2){Q.pop();}N.v=Q.join(";");}}}return P;},buildElemsCountStr:function K(P,N){P=(!P||!P.length)?[]:P;N=(!N||!N.length)?[]:N;var O=P.length,M=N.length;if(I.find(N,"v",D)>-1){M-=1;}if(I.find(N,"v",C)>-1){M-=1;}if(I.find(P,"v",D)>-1||I.indexOf(P,D)>-1){O=M;}return this.buildElemsCountStrByNum(O,M);},buildElemsCountStrByNum:function K(N,M){if(N===M){if(M===0){return"";}return M.toString();}else{if(M===0){return N+" "+mstrmojo.desc(514);}else{if(N>M){return"("+M+")";}}}return mstrmojo.desc(4891,"").replace("##",String(N)).replace("###",String(M));},browseElements:function G(O,P,N){var M={doNotHold:!(N&&mstrApp.serverProxy),silent:true};mstrApp.serverRequest(mstrmojo.hash.copy(N,P),O,M);},getIdPresentation:function J(P){if(!!P){var O=P.charAt(0),M,N,Q;if((O>="g"&&O<="w")||(O>="V"&&O<="Z")){N=false;for(Q=1;Q<P.length;++Q){if(N){N=false;}else{switch(P.charAt(Q)){case";":return"terseLong";case"\\":N=true;break;}}}return"terse";}if(O>="B"&&O<="Q"){if(P.length>2){M=P.charAt(1);if(M>="A"&&M<="Q"){if(P.charAt(2)===":"){return"oldLong";}}}}if(P.length>=33&&P.charAt(32)===":"){return"old";}}return null;},isNullElem:function H(M){if(!M){return true;}var P=this.getIdPresentation(M),N=false,O;switch(P){case"terse":case"terseLong":O=M.substring(1,M.length).split(";");N=O[0].indexOf(this.TERSE_NULL)>-1;break;case"old":case"oldLong":N=M.indexOf(this.OLD_NULL)>-1;break;}return N;},isNonGroupNull:function(O){var M=O.eid||(O._e&&O._e.id),N=M&&M.split(":")[0];return N&&N===this.NON_GROUP_NULL;},getAttributeId:function L(O){var N,M;if(O){M=O.split(";");N=M[1];}return N;},getElementValue:function A(N){var O,M;if(N){M=N.split(";");if(M.length>2){O=M[0]+" "+M[2];}else{O=M[0];}}return O;},isAttributeIdsLinked:function E(N,M,O){var Q=false,P=B.keyarray(O);I.forEach(P,function(R){if(R===N){I.forEach(O[R],function(S){if(S===M){Q=true;return false;}});}if(Q){return false;}});return Q;},ELEM_ALL_ID:"u;",ELEM_DUMMY_ID:"-1",ELEM_SEPARATOR:"\u001E",OLD_NULL:"~!@@~~!@@~",TERSE_NULL:"\\N",NON_GROUP_NULL:"n00000000000000000000000000000000"});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array");var H=mstrmojo.array,B=mstrmojo.hash,J=B.isEmpty;var G=1;function D(Q){return(typeof Q==="object")?Q:{};}function E(R,Q){B.forEach(Q,function(S,V){var T=R[V];if(T===undefined){delete Q[V];return true;}S=Q[V]=D(S);T=R[V]=D(T);if(J(S)&&J(T)){throw (G);}else{if(J(T)){delete R[V];if(J(R[V])){E(R,Q);}}else{if(J(S)){delete R[V];if(J(R[V])){E(R,Q);}}else{try{E(R[V],Q[V]);}catch(U){switch(U){case G:R[V]=Q[V]={};break;}}}}}});}function I(Q){B.forEach(Q,function(R){B.forEach(R,function(U,S){var T=U.include,W=U.exclude;if(J(T)||J(W)){return true;}if(!J(T)&&!J(W)){try{E(W,T);}catch(V){switch(V){case G:R[S]={};break;}}}});});return Q;}function F(S,R,Q){B.forEach(S,function(U,T){if(U===true||J(U)){Q.push(R+T);}else{F(U,R+T+".",Q);}});return Q;}function P(Q){B.forEach(Q,function(R){B.forEach(R,function(U,S){var T=[];F(U.include,"",T);F(U.exclude,"!",T);R[S]=T.join(";");});});return Q;}function K(Q,R){B.forEach(Q,function(S,U){var T=R[U];if(T!==undefined){if(S!==true&&T!==true){K(S,T);}else{if(S===true&&T!==true){R[U]=true;}else{if(S!==true&&T===true){Q[U]=true;}}}}});}function L(R,S){var Q=true;B.forEach(R,function(Y,T){var W=S[T];if(W){var U=Y.include,Z=Y.exclude,X=W.include,V=W.exclude;if(!J(V)&&!J(Z)){Q=false;return Q;}if(!J(X)&&!J(U)){K(X,U);}}return Q;});return Q;}function C(S,Q){Q=Q||{};if(S){var R=Q;H.forEach(S.split("."),function(W,U,T,V){R[W]=V?true:{};R=R[W];});}return Q;}mstrmojo.rw.model.RetrievalKeysConfig=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.rw.model.RetrievalKeysConfig",init:function M(){this.nodes=[];this.filters={};},addNode:function A(R,T){var S=this.filters,Q=S[R];if(!Q){this.nodes.push(R);Q=S[R]={data:{},defn:{}};}if(T){if(L(Q,T)){S[R]=B.mergeHashes(Q,T);}else{throw ("The new filters for node key ## cannot be merged with the filters currently defined".replace("##",R));}}return this;}});mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig=function O(T){var Q={},U={},S={};H.forEach(T,function R(W){var V=W.partialRetrieval;if(V){H.forEach(V.nodes,function(X){U[X]=true;});S=B.mergeHashes(S,V.filters);delete W.partialRetrieval;}H.forEach(W.actions,R);});if(!J(U)){Q.nodes=B.keyarray(U);}if(!J(S)){Q.filters=P(I(S));}return Q;};mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters=function N(R){var Q=function(T){var S={};B.forEach(T,function(W,V){var U=S[V]={serialized:W,include:{},exclude:{}};H.forEach(W.split(";"),function(Y){var X=Y.indexOf("!")===0;Y=X?Y.slice(1):Y;C(Y,X?U.exclude:U.include);});});return S;};return{data:Q(R.data),defn:Q(R.defn)};};}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ACL.UserDataService=mstrmojo.provide("mstrmojo.ACL.UserDataService",{topgroups:null,userCandidates:null,getMembers:function(G,E){var F={taskId:"getUserEntityInfo",blockBegin:G.blockBegin,blockCount:G.blockCount,userEntityID:G.data.did,userEntityName:G.data.n||"",incremental:true,outputElements:G.outputElements||3};mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);},getTopLevelGroups:function D(G,F){var E=this;if(this.topgroups){F.success({items:this.topgroups});return ;}F.success=mstrmojo.func.composite([F.success,function(H){E.topgroups=H.items;}]);this.getUsers({topGroupsOnly:true},F);},searchUserCandidates:function C(F,I,G,E){var H={blockBegin:1,blockCount:G,searchPattern:F,nameWildcards:I?1:2};this.getUsers(H,E);},getUserCandidates:function B(H,G){if(this.userCandidates){G.success(this.userCandidates);return ;}var E=G.success,F=this;G.success=function(J){F.userCandidates={items:J.items,isComplete:(parseInt(J.bc,10)===-1||(J.bb+J.bc>J.sz))};E(F.userCandidates);};var I={blockBegin:1,blockCount:H,nameWildcards:1};this.getUsers(I,G);},getUsers:function A(G,E){var F={taskId:"getUserServices"};mstrmojo.hash.copy(G,F);mstrmojo.xhr.request("POST",mstrConfig.taskURL,E,F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.cookies");mstrmojo.requiresDescs(14356,11866);mstrmojo.mstr._RecentObjectsHelper=mstrmojo.provide("mstrmojo.mstr._RecentObjectsHelper",{_mixinName:"mstrmojo.mstr._RecentObjectsHelper",handleRecentObjects:function B(){var F=this.recentObjects();var D=Math.min(F.length,10);var C=-1;for(i=0;i<D;i++){if(F[i].lastRecovered!==undefined&&F[i].lastRecovered===true){F[i].iconClass="mstrIcon-lv mstrIcon-recover";F[i].recoveryName=mstrmojo.desc(11866,"Recover #").replace("#",F[i].recoveryName);F[i].itemClass="mstr-recent-item";C=i;}else{F[i].itemClass="mstr-recent-item";F[i].iconClass="mstrIcon-lv "+F[i].iconClass;}}if(C!=-1){F[C].cssText="border-bottom: 1px solid #D6D6D6;";}var E={};if(D==0){E.recoveryURL="";E.recoveryName=mstrmojo.desc(14356,"No recent items");E.iconClass="";E.lastRecovered=false;F.push(E);}return F;},recentObjects:function A(){try{var J=window.localStorage,P=window.sessionStorage;if(!J||!window.JSON){return ;}var E=[];var N=function(U){var V="";switch(U){case 3:V="reportID=";break;case 55:V="documentID=";break;default:V="messageID=";break;}return V;};var H=function(Y){var X=Y.ty;var U="";switch(X){case 55:var W=Y.vm;switch(W){case 8192:case 2048:U="mstrIcon-lv-rw avm";break;case 1:default:U="mstrIcon-lv-rw";break;}break;case 3:var V=Y.viewMode;switch(V){case 1:U="mstrIcon-lv-g";break;case 2:U="mstrIcon-lv-gp";break;case 3:U="mstrIcon-lv-gpgs";break;default:U="";break;}break;}return U;};var T=JSON.parse(J.getItem("recentObjects"+mstrConfig.lastMsgKey));try{var S=mstrConfig.lastMsgKey,D="lastMsgID"+S,G=(JSON.parse(decodeURIComponent(mstrmojo.cookies.getCookieSetting("lastMsgID")||"{}")))[S],I=function(U){return U&&(U.length===32)&&/^[A-Z0-9]{32}$/.test(U);};}catch(R){}if(I(G)){var K={};var O="lastMsgRecoveryInfo"+S,C=J.getItem(O);if(C){var C=JSON.parse(C);K.recoveryInfo=C;K.recoveryURL=mstrmojo.addCSRFTokenToURL("?"+C.url.replace(/messageID.*/,"messageID="+G)),K.recoveryName=C.n;K.recoveryType=C.ty;K.did=C.did;K.iconClass=H(C);K.lastRecovered=true;E.push(K);}}for(var Q in T){var L=T[Q];if(L===""){continue;}var K={};var C=JSON.parse(L);K.recoveryInfo=C;K.recoveryURL=mstrmojo.addCSRFTokenToURL("?"+C.url.replace(/messageID.*/,N(C.ty)+C.did));K.recoveryName=C.n;K.recoveryType=C.ty;K.did=C.did;K.iconClass=H(C);K.lastRecovered=false;var M=mstrmojo.array.find(E,"did",K.did);if(M===-1){E.push(K);}else{E[M].recoveryInfo.imgData=K.recoveryInfo.imgData;}}return E;}catch(F){mstrmojo.errors.log(F);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources");function D(H){this.cleanUpAfterTarget(H);var G=H.tgtData;if(G){delete H.tgtData;}var I=this.getContextDragData(H);if(I&&I.setAvatarClass){I.setAvatarClass("");}}mstrmojo.vi.ui._IsDropTarget=mstrmojo.provide("mstrmojo.vi.ui._IsDropTarget",{_mixinName:"mstrmojo.vi.ui._IsDropTarget",dropZone:true,getDropAvatarIcon:function B(G){return"add";},getContextDragData:function F(G){return G.getCtxtDragData();},cleanUpAfterTarget:mstrmojo.emptyFn,ondragenter:function A(G){var H=this.getContextDragData(G);if(H&&H.setAvatarClass){H.setAvatarClass(this.getDropAvatarIcon(G));}if(this._super){this._super(G);}},ondragleave:function E(G){D.call(this,G);if(this._super){this._super(G);}},ondrop:function C(G){D.call(this,G);if(this._super){this._super(G);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E="*",A=".",C="-",J="_",H="<";var M=new RegExp("[\\"+E+"\\"+A+"\\"+C+"\\"+J+"\\"+H+"]","g"),G=E+"$&";mstrmojo.Serializer={scriptClass:"mstrmojo.Serializer",serializeValueGroup:function F(B){mstrmojo.array.forEach(B,function(D,K){B[K]=mstrmojo.Serializer.serializeValues(D);});return C+this.serializeValues(B)+J;},serializeValues:function I(D){var B=[];mstrmojo.array.forEach(D,function(K){if(typeof K==="Boolean"){K=K?"1":"0";}B.push(String(K).replace(M,G));});return B.join(A);}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;mstrmojo._HasConditionLogicDIC=mstrmojo.provide("mstrmojo._HasConditionLogicDIC",{_mixinName:"mstrmojo._HasConditionLogicDIC",target:null,owner:null,applyChanges:function(){this._super&&this._super();var F=this.target||[],D=F.length,E;for(E=0;E<D;E++){F[E].triggerValidateCondition();}},onvisibleChange:function(){this._super&&this._super();var F=this.target||[],D=F.length,E;for(E=0;E<D;E++){F[E].triggerValidateCondition();}},updateCellsMap:function(E){var I="",G=this.getCurValue?this.getCurValue():this.value,H=this.getDisplayValue?this.getDisplayValue():G,F=this.k,D=this.owner;if(E){D.updatedCellsMap[F]={r:I,v:{dv:H,v:G}};}else{if(D.updatedCellsMap[F]){delete D.updatedCellsMap[F];}}}});mstrmojo._CanRespondConditionChange=mstrmojo.provide("mstrmojo._CanRespondConditionChange",{_mixinName:"mstrmojo._CanRespondConditionChange",src:null,childDICs:null,owner:null,postBuildRendering:function(){var D=this.owner;if(D){D.buildConditions(this);}if(this.src){this.childDICs=[];A.call(this,this.childDICs);this.triggerValidateCondition();}this._super();},onvisibleChange:function(){this._super&&this._super();var J=this.childDICs||[],F=J.length,E,H,G,D,I;for(I=0;I<F;I++){E=J[I].owner.dics;H=J[I].k;D=B.find(E,"k",H);if(D>-1){G=E[D].mdf;if(G){J[I].updateCellsMap(this.visible);}}J[I].set("visible",this.visible);}},triggerValidateCondition:function(){var D=true;B.forEach(this.src,function(E){if(!C(E)){D=false;}});this.applyConditionAction(D);},applyConditionAction:mstrmojo.emptyFn});function A(G){var F=this.children||[],D=F.length,E;for(E=0;E<D;E++){if(F[E].dic){G.push(F[E]);}else{A.call(F[E],G);}}}function C(H){var M=H.dic,D=M.value,J=M.visible,F=H.logic,I=[],G,E,L=null;try{if(F[0]==="/"){I=F.split("/");G=I.pop();I.shift();E=I.join("/");L=new RegExp(E,G);}else{L=new RegExp(F);}if(!J||!L.test(D)){return false;}}catch(K){return false;}return true;}})();(function(){mstrmojo.requiresCls("mstrmojo.array");var B=mstrmojo.array;function A(C){if(C.parent){if(C.parent.shouldEllipsizeChildren===undefined){mstrmojo.mixin(mstrmojo._HasEllipsis,C.parent);}C.parent.set("shouldEllipsizeChildren",true);}}mstrmojo._HasEllipsis=mstrmojo.provide("mstrmojo._HasEllipsis",{shouldEllipsize:false,shouldEllipsizeChildren:false,doEllipsize:function(){if(this.shouldEllipsizeChildren){B.forEach(this.children,function(D,C){if(D.hasRendered&&D.doEllipsize){D.doEllipsize();}});}},onshouldEllipsizeChange:function(){this._onEllipsizeFlagChange(this.shouldEllipsize,this.shouldEllipsizeChildren);},onshouldEllipsizeChildrenChange:function(){this._onEllipsizeFlagChange(this.shouldEllipsizeChildren,this.shouldEllipsize);},_onEllipsizeFlagChange:function(D,C){if(D&&!C){A(this);this.markupMethods=mstrmojo.mixin({onvisibleChange:function(){if(this._super){this._super();}if(this.visible&&this.hasRendered){this.doEllipsize();}}},mstrmojo.hash.copy(this.markupMethods));}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var A=mstrmojo.array;mstrmojo.fe._IsRelationTreeNode=mstrmojo.provide("mstrmojo.fe._IsRelationTreeNode",{createSetHtml:'<span class="mstrmojo-textset mstrmojo-create-set-text" mstrAttach:click >'+mstrmojo.desc(12034,"Create a Set")+"</span>",syncRootOperator:function(){var F=this.parent,H=function(){var J=this.parent,I=[];if(J){I=J.ctxtBuilder.itemWidgets;}return I;},E,D,B,C,G;if(F){E=H.call(this);B=E.length;D=A.find(E,"noRelationOperator",true)!==-1;for(C=0;C<B;C++){G=E[C];G&&G.set("noRelationOperator",D);}this.set("noRelationOperator",D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");function C(G,H,E){var F=G.createElement("input");F.name=H;F.type="hidden";F.value=E;return F;}function B(K,J){J=J.substring(J.indexOf("?")+1,J.length);var M=J.split("&"),L="",H="";var N=/\+/g,I,F;for(I=0,F=M.length;I<F;I++){var E=M[I].split("=");L=E[0];H=E[1];if(H){H=decodeURIComponent(H.replace(N," "));}var G=document.createElement("INPUT");G.type="HIDDEN";G.name=L;G.value=H;K.appendChild(G);}return false;}mstrmojo.form={createDynamicForm:function A(E){var F=document.createElement("FORM"),G=E.indexOf("?")>0;F.name="dynamic_form";F.method="POST";F.action=(G?E.substring(0,E.indexOf("?")):E);if(G){B(F,E);}document.body.appendChild(F);return F;},sendLinkAsForm:function(E,G){var F=this.createDynamicForm(E);this.send({},F.action,F.method,G,null,null,F);},sendLink:function(E,F){if(!mstrmojo.isUrlExternal(E)){mstrmojo.form.sendLinkAsForm(E,F);}else{if(mstrmojo.array.indexOf(["_new","_blank"],F)>-1){window.open(E);}else{window.location.href=E;}}},send:function D(K,L,E,N,I,G,F){var P=((I&&I.hWin)||window).document,M=F||P.createElement("form"),J=mstrApp;K=mstrmojo.addCSRFTokenToTaskParams(K);M.method=E||"POST";if(N){M.target=N;}M.action=L||J.name;G=(G!==undefined)?G:!(M.action&&M.action.indexOf("aspx")>0)&&mstrConfig.addTimeStampToPreventCaching;if(!!J.addJSessionIdToURL&&J.httpSessionId){M.action+=";jsessionid="+J.httpSessionId;}if(G){M.action+=";uxts"+mstrmojo.now();}M.appendChild(C(P,"xts",String(mstrmojo.now())));var Q;for(Q in J.persistTaskParams){K[Q]=J.persistTaskParams[Q];}if(J.servletState&&J.name){K[J.name]=J.servletState;}if(K){var H;for(H in K){if(K[H].constructor===Array){mstrmojo.array.forEach(K[H],function(R){M.appendChild(C(P,H,R));});}else{M.appendChild(C(P,H,K[H]));}}}P.body.appendChild(M);try{M.submit();}catch(O){if(N&&O.result===2147500037&&!window.open("","","width=1,height=1,left=0,top=0,scrollbars=no")){mstrmojo.alert("*This action requires popups to be allowed in the browser.*");}else{mstrmojo.err("Form submission failed for an unknown reason.");}}P.body.removeChild(M);},addURLAsHiddenInputsToForm:B};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var H="#000000",E=Math.round;function N(X){return("0"+parseInt(X,10).toString(16)).slice(-2);}mstrmojo.color=mstrmojo.provide("mstrmojo.color",{rgbStr2rgb:function V(X){return X.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i).slice(1);},rgbStr2hex:function F(X){if(X.indexOf("rgb")>=0){var Y=this.rgbStr2rgb(X);return"#"+this.rgb2hex(Y[0],Y[1],Y[2]);}return X;},rgb2hex:function B(Z,Y,X){return N(Z)+N(Y)+N(X);},rgb2hsv:function U(X,e,j){var a=Math.min(X,e,j),k=Math.max(X,e,j),c=0,n,m;m=k/255;n=(k!==0)?(parseFloat(k)-parseFloat(a))/parseFloat(k):0;if(n===0){c=0;}else{var f=k-a,Y=(k-X)/f,Z=(k-e)/f,l=(k-j)/f;if(X===k){c=l-Z;}else{if(e===k){c=2+Y-l;}else{c=4+Z-Y;}}c=c/6;if(c<0){c=c+1;}}return[E(c*360),E(n*100),E(m*100)];},rgb2hsl:function D(X,c,d){X/=255;c/=255;d/=255;var e=Math.max(X,c,d),Z=Math.min(X,c,d),Y=(e+Z)/2,a,j;if(e===Z){a=j=0;}else{var f=e-Z;j=Y>0.5?f/(2-e-Z):f/(e+Z);switch(e){case X:a=(c-d)/f+(c<d?6:0);break;case c:a=(d-X)/f+2;break;case d:a=(X-c)/f+4;break;}a/=6;}return[a,j,Y];},hsl2rgb:function C(d,j,c){var a=function a(h,g,b){if(b<0){b+=1;}if(b>1){b-=1;}if(b<1/6){return h+(g-h)*6*b;}if(b<1/2){return g;}if(b<2/3){return h+(g-h)*(2/3-b)*6;}return h;},X,e,f;if(j===0){X=e=f=c;}else{var Y=c<0.5?c*(1+j):c+j-c*j,Z=2*c-Y;X=a(Z,Y,d+1/3);e=a(Z,Y,d);f=a(Z,Y,d-1/3);}return[E(X*255),E(e*255),E(f*255)];},hsl2hex:function I(Z,Y,X){return"#"+mstrmojo.array.map(this.hsl2rgb(Z,Y,X),function(a){return N(a);}).join("");},hex2rgb:function P(a){var X=this.fixFullHexValue("#"+a.replace("#","")),Y=[],Z;X=X.replace("#","");for(Z=0;Z<3;Z++){Y.push(parseInt(X.substr(Z*2,2),16));}return Y;},hex2bgr:function K(X){return this.hex2rgb(X).reverse();},hex2hsv:function S(Y){var X=this.hex2rgb(Y);return this.rgb2hsv(X[0],X[1],X[2]);},hex2hsl:function W(X){return this.rgb2hsl.apply(this,this.hex2rgb(X));},hsv2rgb:function G(f,o,m){f=f/360;o=o/100;m=m/100;var X,j,l;if(o===0){X=m*255;j=m*255;l=m*255;}else{var a=f*6;if(a===6){a=0;}var e=Math.floor(a);var Z=m*(1-o);var Y=m*(1-o*(a-e));var n=m*(1-o*(1-(a-e)));var k,c,d;switch(e){case 0:k=m;c=n;d=Z;break;case 1:k=Y;c=m;d=Z;break;case 2:k=Z;c=m;d=n;break;case 3:k=Z;c=Y;d=m;break;case 4:k=n;c=Z;d=m;break;default:k=m;c=Z;d=Y;break;}X=k*255;j=c*255;l=d*255;}return[E(X),E(j),E(l)];},hsv2hex:function L(a,Z,X){var Y=this.hsv2rgb(a,Z,X);return this.rgb2hex(Y[0],Y[1],Y[2]);},getContrastingColor:function M(a,Y,X){var Z=this.hex2rgb(a);return(((Z[0]*299)+(Z[1]*587)+(Z[2]*114))/1000<125)?Y:X;},getHighlightColor:function R(f,d){var X,e,h,j,k=this.hex2rgb(!d?"#FFCE7F":"#EFE6D8"),c=parseInt(f[0],10),Z=parseInt(f[1],10),m=parseInt(f[2],10),a=parseInt(k[0],10),Y=parseInt(k[1],10),l=parseInt(k[2],10);X=(c*a)/255;e=(Z*Y)/255;h=(m*l)/255;j=c*0.3+Z*0.59+m*0.11;if(j<85){X=X+(63*(85-j)/85);X=X>255?255:X;e=e+(63*(85-j)/85);e=e>255?255:e;h=h+(63*(85-j)/85);h=h>255?255:h;}return"#"+this.rgb2hex(E(X),E(e),E(h));},get3DBorderColor:function Q(Z,d){var Y=parseInt(Z[0],10)*0.3+parseInt(Z[1],10)*0.59+parseInt(Z[2],10)*0.11;var c=parseInt(Z[0],10);var a=parseInt(Z[1],10);var X=parseInt(Z[2],10);switch(d){case"light":if(Y>150){c=c*0.9;a=a*0.9;X=X*0.9;}else{c=c*0.6+102;a=a*0.6+102;X=X*0.6+102;}break;case"dark":if(Y>10){c=c*0.4;a=a*0.4;X=X*0.4;}else{c=c*0.8+30;a=a*0.8+30;X=X*0.8+30;}break;}return"#"+this.rgb2hex(E(c),E(a),E(X));},encodeColor:function J(X,Y){if(Y!==undefined&&(X===null||X.length===0||X==="undefined")){X=Y;}if(X==="transparent"){return -1;}if(parseInt(X,10)===-2){return -2;}if(X.substring(0,1)==="#"){X=X.substring(1);}return parseInt(X.substring(4)+X.substring(2,4)+X.substring(0,2),16);},decodeColor:function A(X){X=parseInt(X,10);if(X===0){return H;}var Y=16777216+(X&255)*65536+(X&65280)+(X&16711680)/65536;return"#"+Y.toString(16).substring(1).toUpperCase();},fixFullHexValue:function T(X){if(X&&X.length===4){return X.replace(/([0-9a-f])/ig,"$1$1");}return X;},findMidColorHex:function O(a,Z){var b=this.hex2rgb(a),X=this.hex2rgb(Z),Y=[];b.forEach(function(c,d){Y.push(parseInt((c+X[d])/2,10));});return("#"+this.rgb2hex(Y[0],Y[1],Y[2]));}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array,E=mstrmojo.desc(2412,"Default"),H=mstrmojo.desc(3433,"Font"),B=mstrmojo.desc(3434,"Number"),C=mstrmojo.desc(3435,"Alignment"),A=mstrmojo.desc(2886,"Borders"),F=mstrmojo.desc(3905,"Background");var L=[{n:E,v:"pru"}];G.forEach(["Arial","Arial Black","Arial Narrow","Arial Unicode MS","Batang","Book Antiqua","Bookman Old Style","Comic Sans MS","Courier New","Garamond","Haettenschweiler","Helvetica","Impact","Lucida Console","Lucida Sans Unicode","Map Symbols","Marlett","Monotype Corsiva","Monotype Sorts","MS Gothic","MS Outlook","Microsoft Sans Serif","MT Extra","Symbol","Tahoma","Times New Roman","Trebuchet MS","Verdana","Webdings","Wingdings"],function(M){L.push({n:M,v:M});});function K(N,M,O){return(M&&M>=N)?K(N,M-O,O).concat(M):[];}var J=K(2,12,1);J=J.concat(K(14,24,2));J=J.concat(K(36,48,12));J=J.concat(K(72,72,1));var D=[{n:E,v:"pru"}];G.forEach(J,function(M){D.push({n:String(M),v:String(M)});});mstrmojo._FormatDefinition={Formats:[{n:H},{n:B},{n:C},{n:mstrmojo.desc(3436,"Color and Lines")}],FormatTarget:[{n:mstrmojo.desc(7942,"Element Header"),v:1,p:"header_format"},{n:mstrmojo.desc(7943,"Element Value"),v:2,p:"grid_format"},{n:mstrmojo.desc(7944,"Individual Items Header"),v:3,p:"child_header_format"},{n:mstrmojo.desc(7945,"Individual Items Value"),v:4,p:"child_grid_format"}],MetricFormatTarget:[{n:mstrmojo.desc(9710,"Metric Headers"),v:1,p:"header_format"},{n:mstrmojo.desc(9711,"Metric Values"),v:2,p:"grid_format"}],MetricValueFormats:[{n:B},{n:C},{n:H},{n:A},{n:F}],MetricHeaderFormats:[{n:B},{n:C},{n:H},{n:A},{n:F},{n:mstrmojo.desc(12139,"Chart")}],NumberFormatCategory:{Automatic:-3,Default:-2,General:9,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7},DefaultFormat:{FormattingAlignment:{Horizontal:"1",Vertical:"1",TextWrap:"0",TextDirection:"0"},FormattingBorder:{HInsideStyle:"1",VInsideStyle:"1",TopStyle:"1",LeftStyle:"1",BottomStyle:"1",RightStyle:"1",HInsideColor:"0",VInsideColor:"0",TopColor:"0",LeftColor:"0",BottomColor:"0",RightColor:"0",Border3DStyle:"0",Border3DWeight:"0",Border3DBottomColor:"0",Border3DLeftColor:"0",Border3DRightColor:"0",Border3DTopColor:"0"},FormattingFont:{Name:"Arial",Bold:"0",Italic:"0",Size:"10",Strikeout:"0",Underline:"0",Color:"0",Script:"0"},FormattingNumber:{Category:"9",DecimalPlaces:"0",ThousandSeparator:"-1",CurrencySymbol:"$",CurrencyPosition:"0",Format:"General",NegativeNumbers:"3"},FormattingPadding:{LeftPadding:"1",RightPadding:"1",TopPadding:"1",BottomPadding:"1",LineSpacing:"0"},FormattingPatterns:{FillColor:"16777215",PatternColor:"8650752",PatternStyle:"1",FillStyle:"0",ApplyToGraphThreshold:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0",SelectorSelectionColor:"16167264",SelectorSelectionFillStyle:"0",SeriesFillColor:"pru",SeriesPatternColor:"8650752",SeriesPatternStyle:"1",SeriesFillStyle:"0",SeriesApplyToGraphThreshold:"0",SeriesGradientColor:"16777215",SeriesGradientAngle:"0",SeriesGradientXOffset:"0",SeriesGradientYOffset:"0",SeriesSelectorSelectionColor:"16167264",SeriesSelectorSelectionFillStyle:"0"}},Families:L,Sizes:D,SizesInVI:D.slice(7,19),Styles:[{n:E,v:"pru"},{n:mstrmojo.desc(3440,"Regular"),v:"0,0"},{n:mstrmojo.desc(2718,"Bold"),v:"-1,0",v2:"-1,"},{n:mstrmojo.desc(2719,"Italic"),v:"0,-1",v2:",-1"},{n:mstrmojo.desc(3441,"Bold Italic"),v:"-1,-1"}],Effects:[{n:"Underline",v:0},{n:"Strike",v:1}],Category:[{n:E,v:-2},{n:mstrmojo.desc(2378,"General"),v:9},{n:mstrmojo.desc(2050,"Fixed"),v:0},{n:mstrmojo.desc(2051,"Currency"),v:1},{n:mstrmojo.desc(2052,"Date"),v:2},{n:mstrmojo.desc(2170,"Time"),v:3},{n:mstrmojo.desc(2053,"Percentage"),v:4},{n:mstrmojo.desc(2054,"Fraction"),v:5},{n:mstrmojo.desc(2055,"Scientific"),v:6},{n:mstrmojo.desc(2056,"Custom"),v:7}],MaxNegativeDidigts:30,FixedNegative:[{n:"-1,234.12",v:1,f:"#,##0.00"},{n:"-1,234.12",r:true,v:5,f:"#,##0.00;[RED]-#,##0.00"},{n:"1,234.12",r:true,v:2,f:"#,##0.00;[RED]#,##0.00"},{n:"(1,234.12)",v:3,f:"#,##0.00;(#,##0.00)"},{n:"(1,234.12)",r:true,v:4,f:"#,##0.00;[RED](#,##0.00)"}],CurrencyNegative:[{n:"-$1,234.12",v:1,f:'"$"#,##0.00'},{n:"-$1,234.12",r:true,v:5,f:'"$"#,##0.00;[RED]-"$"#,##0.00'},{n:"$1,234.12",r:true,v:2,f:'"$"#,##0.00;[RED]"$"#,##0.00'},{n:"($1,234.12)",v:3,f:'"$"#,##0.00;("$"#,##0.00)'},{n:"($1,234.12)",r:true,v:4,f:'"$"#,##0.00;[RED]("$"#,##0.00)'}],CurrencyPosition:[{n:mstrmojo.desc(2194,"Left"),v:0},{n:mstrmojo.desc(2195,"Right"),v:1},{n:mstrmojo.desc(2183,"Left with space"),v:2},{n:mstrmojo.desc(2182,"Right with space"),v:3}],Date:[{n:mstrmojo.desc(2231,"4/7"),v:"m/d"},{n:mstrmojo.desc(2232,"04/07"),v:"mm/dd"},{n:mstrmojo.desc(2233,"4/7/98"),v:"m/d/yy"},{n:mstrmojo.desc(2234,"04/07/98"),v:"mm/dd/yy"},{n:mstrmojo.desc(2235,"04/07/1998"),v:"mm/dd/yyyy"},{n:mstrmojo.desc(2236,"7-Apr"),v:"d-mmm"},{n:mstrmojo.desc(2237,"7-Apr-98"),v:"d-mmm-yy"},{n:mstrmojo.desc(2238,"Apr-98"),v:"mmm-yy"},{n:mstrmojo.desc(2239,"Apr '98"),v:"mmm 'yy"},{n:mstrmojo.desc(2240,"April 1998"),v:"mmmm yyyy"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2243,"April 7, 1998"),v:"mmmm d, yyyy"}],Time:[{n:mstrmojo.desc(2244,"15:41"),v:"h:mm"},{n:mstrmojo.desc(2245,"3:41 PM"),v:"h:mm AM/PM"},{n:mstrmojo.desc(2246,"15:41:46"),v:"h:mm:ss"},{n:mstrmojo.desc(2247,"3:41:46 PM"),v:"h:mm:ss AM/PM"},{n:mstrmojo.desc(2241,"4/7/98 15:41"),v:"m/d/yy h:mm"},{n:mstrmojo.desc(2242,"4/7/98 3:41 PM"),v:"m/d/yy h:mm AM/PM"},{n:mstrmojo.desc(2250,"04/07/98 15:41"),v:"mm/dd/yy h:mm"},{n:mstrmojo.desc(2248,"04/07/98 3:41 PM"),v:"mm/dd/yy h:mm AM/PM"}],PercentNegative:[{n:"-12.12%",v:1,f:"0.00%"},{n:"-12.12%",r:true,v:5,f:"0.00%;[RED]-0.00%"},{n:"12.12%",r:true,v:2,f:"0.00%;[RED]0.00%"},{n:"(12.12%)",v:3,f:"0.00%;(0.00%)"},{n:"(12.12%)",r:true,v:4,f:"0.00%;[RED](0.00%)"}],Fraction:[{n:"12 1/3",v:"# ?/?"},{n:"37/3",v:"?/?"},{n:"12 26/81",v:"# ??/??"},{n:"998/81",v:"??/??"}],TextDirection:[{n:E,v:"pru"},{n:mstrmojo.desc(4601,"Horizontal"),v:0},{n:mstrmojo.desc(5156,"-90 Degree"),v:-90}],Horizontal:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2378,"General"),v:1},{n:mstrmojo.desc(2194,"Left"),v:2},{n:mstrmojo.desc(2193,"Center"),v:3},{n:mstrmojo.desc(2195,"Right"),v:4},{n:mstrmojo.desc(2068,"Justify"),v:6}],Vertical:[{n:mstrmojo.desc(2296,"Use Default"),v:"pru"},{n:mstrmojo.desc(2256,"Top"),v:1},{n:mstrmojo.desc(2067,"Center"),v:2},{n:mstrmojo.desc(2257,"Bottom"),v:3}],TextWrap:[{v:0},{v:-1}],BorderStyles:[{n:E,v:"pru"},{n:mstrmojo.desc(2258,"None"),v:0},{n:mstrmojo.desc(2259,"Dashed"),v:3},{n:mstrmojo.desc(2260,"Dotted"),v:4},{n:mstrmojo.desc(2261,"Hair"),v:7},{n:mstrmojo.desc(2262,"Thin"),v:1},{n:mstrmojo.desc(2264,"Thick"),v:5},{n:mstrmojo.desc(2265,"Double"),v:6}],extractModel:function(O,Q,N){var S=N||this.DefaultFormat,R;for(R in O){var M=O[R];if(!M.attachEventListener){if(!mstrmojo.hash.isEmpty(M)){Q[R]=M;}}else{var P;for(P in M){if(S[R]&&S[R][P]){if(!Q[R]){Q[R]={};}Q[R][P]=M[P];}}}}},getAvailableFonts:function I(){var M={success:function(O){if(O.name==="fontPicker"){var N=[{n:E,v:"pru"}];mstrmojo.array.forEach(O.shortcuts,function(P){N.push({n:P.attributes[1].value,v:P.attributes[1].value});});mstrmojo._FormatDefinition.Families=N;}}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,M,{taskId:"getSystemPickerJson",name:"fontPicker"},false,null,true);},getStandardFormat:function(N,M){var P=mstrmojo.hash.clone(M||this.DefaultFormat),O;N=N||{};for(O in P){N[O]=N[O]||{};}for(O in N){if(!N[O].attachEventListener){N[O]=mstrmojo.hash.make(N[O],mstrmojo.Obj);}}return N;},saveFormatModel:function(Q,W,N,X){var V=X||this.DefaultFormat,S,M;for(S=0;S<N.length;S++){var R=N[S],P=W[R]||null,U=Q[R];if(U===undefined){delete W[R];continue;}for(M in V){var T=V[M],O;if((!P&&!U)||(P&&!P[M]&&!U[M])){continue;}for(O in T){if(U[M]===undefined||U[M]===""||U[M][O]==="pru"||U[M][O]===undefined){if(P&&P[M]&&(P[M][O]!==undefined&&P[M][O]!==null&&P[M][O]!=="pru")){P[M][O]="pru";}}else{P=P||{};P[M]=P[M]||{};P[M][O]=U[M][O];}}}if(P){W[R]=P;}}}};}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E=mstrmojo.array;mstrmojo._BindTargetChildren=mstrmojo.provide("mstrmojo._BindTargetChildren",{target:null,targetProps:null,addTabButtons:null,removeTabButtons:null,clearButtons:null,ontargetChange:function D(L){var M=L&&L.valueWas;if(M){var J=this._targetSubs;if(J){M.detachEventListener(J.add);M.detachEventListener(J.rem);M.detachEventListener(J.sel);}this.clearButtons();}var N=this.target;if(N){var I=this.targetProps,H=(I&&I.children)||"children",F=N[H];this.addTabButtons(F,0);this._onTargetSelChg();if(N.attachEventListener){var G=this.id,K="attachEventListener";this._targetSubs={add:N[K]("addChild",G,"_onTargetAddChild"),rem:N[K]("removeChild",G,"_onTargetRemoveChild"),sel:N[K]("selectedChange",G,"_onTargetSelChg")};}}this._ontargetChange();},_ontargetChange:mstrmojo.emptyFn,_onTargetAddChild:function A(F){var G=F&&F.value;if(G&&G.length){this.addTabButtons(G,F.index);}this._postTargetAddChild();},_postTargetAddChild:mstrmojo.emptyFn,_onTargetRemoveChild:function B(G){var F=G&&G.value,H;for(H=((F&&F.length)||0)-1;H>-1;H--){this.removeTabButton(F[H]);}this._postTargetRemoveChild();},_postTargetRemoveChild:mstrmojo.emptyFn,_onTargetSelChg:function C(L){var G=this.targetProps||{},F=this[G.names||"children"],J=function(O,P){if(O.set){O.set("selected",P);}else{O.selected=P;}};if(L){var H=L.valueWas,K=H?E.find(F,"target",H):-1;if(K>-1){J(F[K],false);}}var M=this.target,N=M&&M.selected,I=N?E.find(F,"target",N):-1;if(I>-1){J(F[I],true);}this._postTargetSelChg();},_postTargetSelChg:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var E=mstrmojo.array;mstrmojo._IsPanelStack=mstrmojo.provide("mstrmojo._IsPanelStack",{_mixinName:"mstrmojo._IsPanelStack",TTL_SRC_PANEL:0,model:null,selectedIdx:undefined,init:function J(O){this._super(O);var N=this.defn;if(!N){N=this.defn=this.node&&this.node.defn;this.titleSrc=this.titleSrc||N.ttlSrc;}var M=this.selectedKey=this.defn.selKey=this.node.data.selKey;this.set("selectedIdx",E.find(this.node.data.panels,"k",M));N.attachEventListener("selKeyChange",this.id,function(P){this.set("selectedKey",P.value);});},addChildren:function L(O,U,S){var T=this.getFormats(),Q=T&&T.overflow,P=O.length,R;for(R=0;R<P;R++){var N=O[R],V=N.k;if(V){N.selected=N.visible=V===this.selectedKey;if(Q){var M=N.getFormats()||N.createEmptyFormats();if(M){M.overflow=Q;}}}}return this._super(O,U,S);},refresh:function F(){if(this.hasRendered){var M=this.defn.newSelKey||this.selectedKey;E.forEach(this.children,function(O){var N=O.k;if(N){O._delayRefresh=(N!==M);if(!O._delayRefresh){O.refresh();}}});}delete this.defn.newSelKey;},selectPanel:function B(N,O,M){var P=this.model.getDataService(),Q=P.newUpdateWithoutCmd();this.selectPanelDeferred(Q,N,O,M);if(Q.actions&&Q.actions.length>0){P.addSuppressData(Q.extras);Q.submit();}},selectPanelDeferred:function(P,N,O,M){if(N!==this.selectedKey){this.defn.set("selKeyChange",N);this.model.selectPanelDeferred(P,this.k,N,this.node.data.wid,O,M);}},onselectedKeyChange:function K(N){var O=0,R,M,P;E.forEach(this.children,function(T,S){var U=T.k;if(U){if(N.value===U){M=T;P=S-O;T.set("visible",true);T.set("selected",true);}else{if(N.valueWas===U){R=T;T.set("selected",false);T.set("visible",false);}}if(M&&R){return false;}}else{O++;}return true;});if(this.titleSrc===this.TTL_SRC_PANEL&&this.title){var Q=M&&M.title;this.set("title",Q);this.defn.ttl=Q;}this.prevSelectIdx=this.selectedIdx;this.set("selectedIdx",P);this.raiseEvent({name:"panelSelected",key:M.k});return{on:M,off:R};},getSelectedPanel:function D(){var M=0,N=this.selectedIdx,O;E.forEach(this.children,function(Q,P){if(Q.k){if(P-M===N){O=Q;return false;}}else{M++;}return true;});return O;},setDirtyChildren:function H(M){var N=this.selectedKey;E.forEach(this.children,function(P){var O=P.k;if(O){P[((M||O!==N)?"add":"remove")+"DirtyKey"](O);}});},clearDirtyChild:function I(O){var N=this.children,M=N[E.find(N,"k",O)];if(M){M.removeDirtyKey(M.k);}},isPanelStack:true,checkRequiredObjects:function C(){var M=this.txWidgets||{},N=true,O;for(O in M){N&=!!M[O].checkRequiredObjects();}return N;},updateSelectedIdx:mstrmojo.emptyFn,unrender:function G(M){delete this.defn.newSelKey;this._super(M);},switchToPanel:function A(M,N){if(N!==undefined){this.set("selectedIdx",N);}else{this.updateSelectedIdx(M);}this.children[this.selectedIdx]&&this.selectPanel(this.children[this.selectedIdx].k);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array");var G=mstrmojo.array;function B(){var H=this.buildConfig=this.buildConfig||{};H.pk=this.k;H.fgk=this.defn&&this.defn.fgk;return H;}mstrmojo._HasBuilder={builder:null,postBuildRendering:function D(){if(!this.builtChildren){this.buildChildren();}return this._super();},getChildren:function F(){return this.model.getChildren(this.node,false);},buildChildren:function E(H){if(!this.builder||!this.model){return false;}var J=this.children;if(J&&J.length){this.set("children",[]);}var I=this.builder.build(this.getChildren(),this.model,B.call(this));if(!H){this.addChildren(I);}this.builtChildren=true;return H?I:true;},rebuildChildren:function C(K){var H=this.children.slice(0),I=this.model,J=[];K=K||H.slice(0);K.forEach(function(P){var N=G.indexOf(H,P),O=P.k;if(N===-1){throw new Error("Invalid child requested rebuild in mstrmojo._HasBuilder::rebuildChild.");}this.removeChildren(P);P.destroy();J.push(O);},this);var L=I.getChildrenByKey(this.node,false,J);var M=this.builder.build(L,I,B.call(this));this.addChildren(M);return M;},rebuildChild:function A(H){return this.rebuildChildren([H])[0];}};}());(function(){mstrmojo.requiresCls("mstrmojo.models.template.Title");mstrmojo.models.template.Titles=mstrmojo.declare(null,null,{init:function D(G){var F=this.gridData=G.data,E=F.gts;this.titles=G.isRow?E.row:E.col;},size:function C(){return this.titles.length;},getTitle:function B(E){return new mstrmojo.models.template.Title({title:this.titles[E]});},getCSS:function A(E){return this.gridData.css[this.titles[E].cni].n;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.string","mstrmojo.models.template.Titles","mstrmojo.models.template.MetricValue","mstrmojo.models.template.Headers","mstrmojo.models.datasets.DataInterface");var O=mstrmojo.array,U=mstrmojo.hash,D=mstrmojo.string,E=mstrmojo.models.datasets.DataInterface,g=D.decodeHtmlString;var G=-1,F=1,W=2,P=3;var N=1,H=2,c=3;function b(k){var l={};U.forEach(k,function(o,n){var m=[];O.forEach(o,function(p){m.push({fillColor:p.fillclr,text:p.n});});l[n]=m;});return l;}function j(n){var z=this.getTotalRows(),p=this.data,t=[],v=p.gts.col[0],m=v?v.es:[],x=m.length,q=0;n=U.copy(n,{minAttribute:1,minMetric:1});if(z<n.minAttribute||x<n.minMetric){throw"Error";}do{var l=this.getRowHeaders(q),o,k={},u=l.size();for(o=0;o<u;o++){while(o<u&&l.getHeader(o).getFormIndex()!==undefined){o++;}if(o<u){var r=l.getHeader(o);k[r.t.n]=r.getName();}}for(o=0;o<m.length;o++){var w=this.getMetricValue(q,o).value;k[m[o].n]={v:w.v,rv:w.rv};}t.push(k);q++;}while(q<z);return t;}function K(l){var k=[],m=this.data.gts.row;O.forEach(m,function(o,n){O.forEach(l,function(p){if(o.id===p.id){k[n]=true;}});});return k;}function Q(AO){var v=this.getTotalRows(),AQ=this.data,u=[],x=AQ.gts.col[0],p=x?x.es:[],AF=p.length,t,AJ=0;AO=U.copy(AO,{minAttribute:1,minMetric:1,colorByInfo:[],hasTitleName:false,hasSelection:false,needDecode:false});if(v<AO.minAttribute||AF<AO.minMetric){throw"Error";}var k=AO.needDecode,AL=AO.hasTitleName,AK=AO.hasSelection,AR=AO.hasThreshold,AD=AO.colorByInfo;var AP=AR?b(AQ.th):undefined;t=K.call(this,AD);do{var m=this.getRowHeaders(AJ),o={},AH,AG=[],AN=AD.length,l={headers:[],values:[],colorInfo:[]};for(AH=0;AH<m.size();AH++){var AI=m.getHeader(AH),AA=AI.getName(),AT=AI.t,r={name:k?g(AA):AA};if(AL){var AS=AT&&AT.n;r.tname=k?g(AS):AS;}if(AK){var AC=AT&&AT.id,w=AI.getElementId();r.attributeSelector={n:AA,tid:AC,eid:w,isSelectAttr:true};o[AC]=[{n:AA,id:w}];}if(AN&&t[AH]===true){var z=AI.getElementId();AG.push(z);}l.headers.push(r);}if(AN){l.colorInfo=AG;}for(AH=0;AH<p.length;AH++){var AE=this.getMetricValue(AJ,AH).value,AM={v:AE.v,rv:AE.rv};if(AR){var q=AP[AH],n=q&&q[AE.ti];if(n){AM.threshold=n;}}if(AL){var AB=this.getColTitles().titles[0].es[AH].n;AM.name=k?g(AB):AB;}l.values.push(AM);}if(AK){l.metricSelector=o;}u.push(l);AJ++;}while(AJ<v);return u;}function A(AE){var AH=this.data,o=this.getTotalRows(),p=AH.gts.col[0],m=p?p.es:[],t=m.length,u={},v=[],x,z=0,w;AE=U.copy(AE,{minAttribute:1,minMetric:1,descKey:"name",childrenKey:"children",hasTitleName:false,hasSelection:false,needDecode:false,nestedLevel:undefined,colorByInfo:[]});if(o<AE.minAttribute||t<AE.minMetric){throw"Error";}var n=AE.descKey,q=AE.childrenKey,k=AE.needDecode,AB=AE.hasTitleName,AA=AE.hasSelection,l=AE.nestedLevel||0,AG=AE.hasThreshold,r=AE.colorByInfo,AC=r.length;var AF=AG?b(AH.th):undefined;u[n]="root";x=K.call(this,r);var AD=function(AZ,AJ,AQ,AS,AM){var AN=(AZ[q]=AZ[q]||[]),Aa=AJ.getHeader(AQ),Ac=Aa&&Aa.t,AX=Ac&&Ac.id,AV=Aa&&Aa.getName(),AR=AJ&&AJ.headers&&AJ.headers.length||0,Ab,AU=Aa&&Aa.getElementId(),AI=O.filterOne(AN,function(Ae){return(Ae._eid===AU);});Ab=O.some(x,function(Af,Ae){return Af&&((AQ-Ae)%AR===0);});if(AC&&Ab){v.push(AU);}if(!AI||(AQ===l-1)){AI={_eid:AU};var AP=(Aa!==undefined);if(AP){AI[n]=k?g(AV):AV;}if(AB&&AP){var Ad=Ac&&Ac.n;AI.tname=k?g(Ad):Ad;}if(AA&&AP){AI.attributeSelector={n:AV,tid:AX,eid:AU,isSelectAttr:true};}AN.push(AI);}if(AA&&AP){AM[AX]=[{n:AV,id:AU}];}if(AQ<AJ.size()-1&&(!l||(AQ<l-1))){AD.call(this,AI,AJ,AQ+1,AS,AM);}else{var AT=this.getMetricValue(AS,0).value;if(AT){AI.value=AT.rv;AI.formattedValue=AT.v;}if(AC){AI.colorInfo=v;v=[];}AI.values=[];for(w=0;w<m.length;w++){var AY=this.getMetricValue(AS,w).value,AK={v:AY.v,rv:AY.rv};if(AG){var AO=AF[w],AL=AO&&AO[AY.ti];if(AL){AK.threshold=AL;}}if(AB){var AW=this.getColTitles().titles[0].es[w].n;AK[n]=k?g(AW):AW;}AI.values.push(AK);}if(AA){AI.metricSelector=AM;}}};do{AD.call(this,u,this.getRowHeaders(z),0,z,{});z++;}while(z<o);return u;}function C(k,l){var m=[];O.forEach((k.row||[]).concat(k.col||[]),function(n){if((n.id===l)&&(n.fs)){m=m.concat(n.fs);}});return m;}mstrmojo.models.template.DataInterface=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.models.template.DataInterface",data:null,init:function(k){this.data=k;},getRowTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:true});},getColTitles:function(){return new mstrmojo.models.template.Titles({data:this.data,isRow:false});},getTotalRows:function V(){if(this.data.eg){return 0;}var m=this.data,l=m&&m.ghs,k=l&&l.rhs,n=k&&k.items;return(n&&n.length)||0;},getTotalColHeaderRows:function T(){var k=this.data.ghs.chs.items;return(k&&k.length)||0;},getTotalCols:function Y(){return this.getColHeaders(0).size();},getRowHeaders:function J(k){return new mstrmojo.models.template.Headers({data:this.data,i:k,isRow:true});},getColHeaders:function a(k){return new mstrmojo.models.template.Headers({data:this.data,i:k,isRow:false});},getMetricValue:function I(m,k){var l=this.data;return new mstrmojo.models.template.MetricValue({data:l,value:l.gvs.items&&l.gvs.items[m].items[k]});},getColumnHeaderCount:function M(){var k=this.data.gvs.items;return k?k[0].items.length:0;},getCSSString:function f(){return this.data.cssString;},isEmpty:function S(){var k=this.data.gsi;return !k||(!k.rows.length&&!k.cols.length&&!k.mx.length);},getAggregatePadding:function e(){var l=this.data.gsi&&this.data.gsi.fmts,m=function(o,n){return o+n;},k=function(o){var n=0;return["ch","rh","va"].map(function(p){var q=false;return o.map(function(r){if(l[p]&&l[p].hasOwnProperty(r)){if(!q){q=true;n++;}return l[p][r];}return 0;}).reduce(m)/o.length;}).reduce(m)/(n||1);};if(!l){return null;}return{v:k(["tp","bp"]),h:k(["rp","lp"])};},getColResizeScenario:function B(){var k=this.data;if(k.afw){return F;}else{if(k.afc===false){return P;}else{return W;}}},getColResizeInfo:function L(p){var q=this.data,n={v:this.getColResizeScenario(),widths:null};var r=q.gsi,l=q.gts||{},v=[],o=q.twm||{},t=o.top||[],u=o.bottom||[],m=0,k=function(x,w){if(r){r[x].every(function(AA){var AB=AA.did,AC=C(l,AB),z=E.getFormsByAttrId(AB,p);(AC.length?AC:[]).forEach(function(AF,AE){var AG=z[O.find(z,"fid",AF.id)],AD=(u&&u[m])||{};v.push({n:AA.n+(z.length?(" - "+AG.fnm):""),did:AB,depth:AE+1,t:AA.t||4,width:parseInt(AD.w||0,10),widthModel:{top:(t&&t[m])||{},bottom:AD}});m++;});return !w;});}};k("rows",false);k("mx",r.tma===1);n.widths=v;return n;},getRowResizeScenario:function R(){return !!this.data.rh?P:W;},getRowResizeInfo:function X(){var l=this.data,k=l.rh;return{v:this.getRowResizeScenario(),height:(k===undefined||k==="")?l.xrh:k};},getColumnHeaderData:function h(){var q=this.data,w=q.gts,v=q.gts.rec,x=[],l=[],t=w.row;O.forEach(t,function(AA){var z=AA.fs,AB=AA.otp===G;if(z&&z.length>1){O.forEach(z,function(){x.push(AA);});}else{x.push(AA);}if(AB){l=AA.es;}});var p=w.col;if(p&&p.length>0){var o=q.ghs,m=o.chs,k=m.items,u=k[k.length-1].items,n=function n(z){var AA=z.pi,AB=AA&&AA.ci,AC=AA&&AA.ri;if(z.mix!==undefined){return z;}if(AC===undefined||AB===undefined){return ;}return n(k[AC].items[AB]);};O.forEach(p,function(z){var AA=z.otp===G;if((AA&&(!v||t.length===0))){x.push(z);}if(AA){l=z.es;}});var r=x.length;O.forEach(u,function(z){delete z._ridx;});if(l.length>0){O.forEach(u,function(AC){var z=n(AC);var AD=z?z.mix:(AC.pi?0:AC.idx),AB=l[AD]||l[0];var AA=AB._ridx=AB._ridx||[];if(AA.length===0){O.forEach(u,function(AF,AG){var AE=n(AF);if(!z||AE.mix===AD){AA.push(r+AG);}});}x.push(AB);});}}else{if(l.length>0){x.push(l[0]);}}return x;},getUnitById:function Z(m){var l=this.data.gsi,k=null;[l.rows,l.cols,l.mx].some(function(n,o){if(o===2){o=-2;}n.some(function(p,q){if(p.did===m){k={axis:o+1,depth:q+1,unit:p};}return !!k;});return !!k;});return k;},getRawData:function d(k,l){switch(k){case H:return j.call(this,l);case c:return Q.call(this,l);}return A.call(this,l);}});mstrmojo.models.template.DataInterface.inflateGridData=function(m){var n=m.gvs,l=m.ghs;if(m.egt===undefined&&(m.eg===undefined||m.eg===null)&&!!n&&U.isEmpty(n)){var k={v:"",rv:""},o={items:(l.chs.cws||[0]).map(function(){return k;})};n.items=l.rhs.items?l.rhs.items.map(function(){return o;}):[];n.show=true;}};mstrmojo.models.template.DataInterface.ENUM_GRID_RESIZE={FIT_TO_WINDOW:F,FIT_TO_CONTENTS:W,FIXED:P};mstrmojo.models.template.DataInterface.ENUM_RAW_DATA_FORMAT={TREE:N,ROWS:H,ROWS_ADV:c};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.form");var DOM=mstrmojo.dom;var FORM=mstrmojo.form;function findChildWithAtt(el,tagName,att,value){var nodes=el.getElementsByTagName(tagName);var found=mstrmojo.array.filter(nodes,function(node){return node.getAttribute(att)===value;});return found[0];}function uploadDashboardFile(formId){var form=document.getElementById(formId),myFileInput=findChildWithAtt(form,"input","name","myFile"),file=myFileInput.value,resetFileInput=function(){if(DOM.isIE){var fm=document.createElement("form");myFileInput.parentNode.insertBefore(fm,myFileInput);fm.appendChild(myFileInput);fm.reset();fm.removeNode(false);}};if(file===""){return ;}else{if(/\.mstr$/.test(file.toLowerCase())){mstrApp.showWait(true);FORM.addURLAsHiddenInputsToForm(form,mstrmojo.addCSRFTokenToURL(mstrApp.name+"="+encodeURIComponent(mstrApp.servletState)));if(mstrApp.currentFolderId){var folderIDInput=document.getElementById("import_folderID");folderIDInput.value=mstrApp.currentFolderId;}if(!findChildWithAtt(form,"input","name","formId")){var formInput=document.createElement("input");formInput.type="hidden";formInput.name="formId";formInput.value=form.id;form.appendChild(formInput);}form.submit();form.reset();}else{mstrmojo.alert(mstrmojo.desc(11227),null,mstrmojo.desc(11226));}}resetFileInput();}function uploadCallback(res){var success=res.status===200,resContent=res.content,sn=mstrApp.name,updateAndSubmitForm=function(params){mstrApp.showWait();var form=document.getElementById(resContent.formId||"import_form"),newInputsAdded=[],i=0,formInput;mstrmojo.hash.forEach(params,function(value,key){if(key==="folderId"){if(DOM.isIE8){var folder_id=document.getElementById("import_folderID");if(folder_id){folder_id.value=value;}}}else{formInput=document.createElement("input");formInput.type="hidden";formInput.name=key;formInput.value=value;form.appendChild(formInput);newInputsAdded[i++]=formInput;}});window.setTimeout(function(){form.submit();for(var i=0;i<newInputsAdded.length;i++){form.removeChild(newInputsAdded[i]);}},0);};if(resContent&&resContent.messageID){var folderId=(resContent.fdid?resContent.fdid:"");if(resContent.isConflict){var replaceFn=function(){updateAndSubmitForm({messageID:resContent.messageID,resume:true});},saveAsFn=function(){var renameEditor=mstrmojo.insert({scriptClass:"mstrmojo.ui.editors.RenameEditor",renameText:resContent.n,title:mstrmojo.desc(13052,"Upload"),zIndex:1002,onRename:function(newName){if(mstrmojo.string.isEmpty(newName)){mstrmojo.alert("Please enter a valid name",null,null,1004);return false;}else{updateAndSubmitForm({messageID:resContent.messageID,resume:true,dashboardName:newName});var conflictDialog=mstrmojo.all.ImportNameConflictDialog;if(conflictDialog){conflictDialog.destroy();}}}});renameEditor.open();return false;},closeFn=function(){mstrApp.hideWait();};closeFn();mstrmojo.confirm(mstrmojo.desc(8134,"The Dashboard ## already exists. Do you want to replace the existing Dashboard?").replace("##",("<strong>"+resContent.n+"</strong>")),null,{id:"ImportNameConflictDialog",title:mstrmojo.desc(13052,"Upload"),allowHTML:true,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(219,"Yes"),replaceFn,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3167,"Save As"),saveAsFn,true),mstrmojo.Button.newWebButton(mstrmojo.desc(3416,"Cancel"),closeFn)],onPreClose:function(){closeFn();return true;}});}else{updateAndSubmitForm({messageID:resContent.messageID,folderId:folderId});}}else{if(success){var okUrl=mstrmojo.addCSRFTokenToURL(sn+"?evt=2001&src="+sn+".2001"+((resContent&&resContent.fdid)?("&folderID="+resContent.fdid):"&systemFolder=20")),dashboarUrl=getExecuteDashboardUrl(resContent.did),closeAndLoadUrl=function(url){if(this.parent===null&&this.close){this.close();}else{this.parent.parent.close();}if(url){eval(url);}},viewDashboardFn=mstrmojo.emptyFn,shareDashboardFn=function(){mstrmojo.mstr._ObjectActions.openSharingEditor(resContent.servletPath+dashboarUrl,{objectName:resContent.n,objId:resContent.did,objType:"55",mid:-1},false,{showLinkOnOpen:true});};if(!mstrmojo.resolveFeature("flashvi")&&(DOM.isIE8)){viewDashboardFn=function(){closeAndLoadUrl.call(this);mstrmojo.alert(mstrmojo.desc(12187));};}else{viewDashboardFn=function(){closeAndLoadUrl.call(this,"location.href = '"+dashboarUrl+"'");};}var currentFolderName=mstrApp.currentFolderName&&mstrApp.currentFolderName();var uploadResultEditor=mstrmojo.insert({scriptClass:"mstrmojo.onetier.vi.ui.UploadResultEditor",folderName:currentFolderName||"My Reports",dashboardName:resContent.n,okFn:function(){closeAndLoadUrl.call(this,currentFolderName&&"location.href = '"+okUrl+"'");},viewDashboardFn:viewDashboardFn,shareDashboardFn:shareDashboardFn});uploadResultEditor.open();}else{mstrmojo.error({longDesc:res.errorMsg});}mstrApp.hideWait(true);}}function getExecuteDashboardUrl(documentId){var servletName=mstrApp.name,eventId,params;if(mstrmojo.resolveFeature("flashvi")){eventId=2048001;params={visMode:0};}else{eventId=3140;params={};}params.documentID=documentId;params.evt=eventId;params.src=servletName+"."+eventId;var paramArray=[];for(var k in params){if(!params.hasOwnProperty(k)){continue;}paramArray.push(encodeURIComponent(k)+"="+encodeURIComponent(params[k]));}return mstrmojo.addCSRFTokenToURL(servletName+"?"+paramArray.join("&"));}mstrmojo.mstr.ui.MstrFileUploadHelper={uploadDashboardFile:uploadDashboardFile,uploadCallback:uploadCallback};}());(function(){mstrmojo.requiresCls("mstrmojo.registry");mstrmojo._PagingList=mstrmojo.provide("mstrmojo._PagingList",{usePaging:false,page:0,totalPages:1,_set_page:function(B,A){if(this.page!==A&&this.usePaging){if(A>=0&&A<this.totalPages){this.page=A;}return true;}return false;},_inScroll:false,_inPaging:false,onscroll:function(){if(this.usePaging&&!this._inPaging){this._inScroll=true;this.set("page",this.listMapper.whichPage(this));this._inScroll=false;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.array","mstrmojo.publisher");var D=mstrmojo.registry,K=mstrmojo.array,I=mstrmojo.publisher;function G(Q,R){if(R){R.parent=Q;var P=D.ref(R);if(R!==P){delete R.parent;}return P;}return null;}function L(Q,R){var P=R.alias;if(P!==null&&P!==""){Q[P]=R;}}function N(Q,R){var P=R.alias;if(R.parent===Q){delete R.parent;}if((P!==null&&P!=="")&&(Q[P]===R)){delete Q[P];}}function A(T,Q){var P=Q&&Q.length,S,R;if(P){S=[];for(R=0;R<P;R++){var U=G(T,Q[R]);if(!U){continue;}S.push(U);L(T,U);}}return S;}mstrmojo._HasChildren=mstrmojo.provide("mstrmojo._HasChildren",{_meta_usesSuper:false,children:null,postCreateChildren:mstrmojo.emptyFn,onaddChild:null,onremoveChild:null,initChildren:function F(){var P="children",Q=this[P];if(!Q){return ;}this[P]=null;this._set_children(P,Q,true);this.postCreateChildren();},_set_children:function E(S,Q,P){var R=this.children;if(Q!==R){if(R){this.removeChildren(null,P);}this.addChildren(Q,0,P);}return false;},destroyChildren:function C(S){var R=this.children,P=(R&&R.length)||0,Q;if(P){for(Q=P-1;Q>-1;Q--){var T=R[Q];if(T&&T.destroy){T.destroy(S);if(!S){N(this,T);}}}if(!S){R.length=0;}}},invalidateChildren:function B(){mstrmojo.array.forEach(this.children,function(P){P.invalidate();});},invalidate:function H(){this.invalidateChildren();},addChildren:function O(U,Q,R){if(!U){return U;}var T=U.constructor===Array,P=A(this,T?U:[U]);if(P&&P.length){var S=this.children||[];if(Q===null||Q===undefined){Q=S.length;}this.children=K.insert(S,Q,P);if(!R&&(this.onaddChild||I.hasSubs(this.id,"addChild"))){this.raiseEvent({name:"addChild",value:P,index:Q});}}return T?P:(P&&P[0]);},removeChildren:function J(V,R){var T=this.children,U=V?[V]:(this.children||[]).concat(),Q=U.length,P=-1,S;if(Q){for(S=Q-1;S>-1;S--){N(this,U[S]);}if(V){P=K.removeItem(T,V);}else{if(T){T.length=0;P=0;}}if(!R&&(this.onremoveChild||I.hasSubs(this.id,"removeChild"))){this.raiseEvent({name:"removeChild",value:U,index:P});}}return P;},removeAndDestroyChild:function M(R,P,Q){if(R){if(R.parent!==this){throw"Unable to remove an object that is not in the children collection.";}this.removeChildren(R,P);R.destroy(Q);}}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasDrillLinks","mstrmojo.registry","mstrmojo.hash","mstrmojo.dom");var C=mstrmojo.dom;var A="openDrillLinkMenu";mstrmojo._HasHoverButton=mstrmojo.provide("mstrmojo._HasHoverButton",mstrmojo.hash.copy(mstrmojo._HasDrillLinks,{_mixinName:"mstrmojo._HasHoverButton",buttonNodeMarkup:'<div class="mstrmojo-LinkInfo-buttonNode"></div>',init:function D(E){this._super(E);this.markupSlots.buttonNode=function(){return this.domNode.lastChild;};},hoverBtn:null,postBuildRendering:function B(){if(!this.hoverBtn){this.addChildren(mstrmojo.registry.ref({scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"hoverBtn",onclick:function H(){this.openPopup();},openPopup:function E(){var J=mstrmojo.findAncestor(this,A);if(J){J.openDrillLinkMenu({openerButton:this,drillLinkItems:this.parent.drillLinkItems,cmPos:this.cmPos});}},closePopup:function F(){var J=mstrmojo.findAncestor(this,A);if(J){J.closePopup();}}}));}var G=this._super();var I=this.id;C.attachEvent(this.domNode,"contextmenu",function(J){mstrmojo.all[I].oncontextmenu(J,self);});return G;},oncontextmenu:function(G,E){var F=this.hoverBtn;F.cmPos=C.getMousePosition(G,E);F.openPopup();F.cmPos=null;C.preventDefault(E,G);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.hash");var A=false,D="mstrmojo.Binding",I="bindings",H=mstrmojo.registry;function B(K){var L;for(L in K){var J=K[L];if(J&&J.disable){J.destroy();}}}function C(K,M){if(!A){mstrmojo.requiresCls(D);A=true;}var N;for(N in K){var J=K[N];if(J===null||J===undefined){continue;}var L=typeof J;if(L==="string"||L==="function"){J={destination:N,source:J,scriptClass:D};}J.parent=M;J=H.ref(J,{skipLoadChecks:true});K[N]=J;J.enable();}}mstrmojo._HasBindings=mstrmojo.provide("mstrmojo._HasBindings",{_meta_usesSuper:false,initBindings:function E(){this.hasInitBindings=true;var K=mstrmojo.hash.copy(this[I]);if(K){delete this[I];this._set_bindings(I,K);if(this.postCreateBindings){this.postCreateBindings();}}var M=this.children,J=(M&&M.length)||0;if(J){var L;for(L=0;L<J;L++){var N=M[L];if(N&&N.initBindings){N.initBindings();}}}},destroyBindings:function G(){var J=this.bindings;if(J){B(J);delete this.bindings;}},_set_bindings:function F(L,J){var K=this[I];if(J!==K){if(K){B(K);}this[I]=J;if(J){C(J,this);}return true;}return false;}});}());(function(){var D={};var B="XHRServerTransport";mstrmojo.XHRServerTransport={serverRequest:function A(I,G,F){var E=mstrmojo.all[I],H=D[G]=new mstrmojo.SimpleXHR();$MAPF(true,B,"transportRequest");if(F.params&&!F.params.sessionState&&mstrConfig&&mstrConfig.isAddSessionState&&mstrApp&&mstrApp.sessionState){F.params.sessionState=mstrApp.sessionState;}H.request(F.config.method||"POST",F.taskURL||mstrConfig.taskURL,{success:function(J){if(J.mstrerr){J.code=J.mstrerr.code;J.message=J.mstrerr.message;}E.response(G,true,J);},failure:function(J){E.response(G,false,{code:J.getResponseHeader("X-MSTR-TaskErrorCode"),message:J.getResponseHeader("X-MSTR-TaskFailureMsg")});},complete:function(){delete D[G];},textResponse:F.callback.textResponse},F.params);},cancelRequest:function C(F){var G=D[F],E=false;if(G){E=G.cancel();delete D[F];}$MAPF(false,B,"transportRequest");return E;}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.QueuedXHR");var F=mstrmojo.hash;function J(K,L){return function(){if(K[L]){K[L]();}};}var B=[];function H(L){var K;switch(L.cacheLevel){case mstrmojo.AjaxCall.CACHELEVEL_LOCAL:if(L._cache==null){L._cache=[];}K=L._cache;break;default:if(B==null){B=[];}K=B;break;}return K;}function E(N){var M=H(N);var P={cache:M,idx:-1},O=N.params;if("xts" in O){delete O.xts;}for(var L=0,K=M.length;L<K;L++){var Q=M[L];if(Q&&F.equals(Q.url,N.url)&&F.equals(Q.params,O)){P.idx=L;break;}}return P;}function C(L){var K=H(L),M=F.copy(L.params);delete M.xts;K.push({url:L.url,params:M,res:F.copy(L.response)});}function D(K){var L=E(K);if(L&&L.idx>=0){K.response=L.cache[L.idx].res;return true;}return false;}mstrmojo.AjaxCall=mstrmojo.declare(mstrmojo.QueuedXHR,null,{scriptClass:"mstrmojo.AjaxCall",method:"POST",url:"",params:null,onsuccess:null,onerr:null,oncomplete:null,oncancel:null,readCache:false,writeCache:false,cacheLevel:"",_cache:null,useQueue:false,init:function I(K){this._super(K);F.copy(K,this);},send:function A(){var K=this;if(this.readCache&&D(this)){this.onsuccess();return ;}this.request(this.method,this.url,{success:function(){if(K.writeCache){C(K);}if(K&&K.onsuccess){K.onsuccess();}},failure:J(K,"onerr"),complete:J(K,"oncomplete")},this.params,!this.useQueue);},cancel:function G(){this._super();if(this.oncancel){this.oncancel();}}});mstrmojo.AjaxCall.CACHELEVEL_GLOBAL="global";mstrmojo.AjaxCall.CACHELEVEL_LOCAL="local";})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.string");var T=mstrmojo.dom,K=mstrmojo.string,X=mstrmojo.array;mstrmojo.css=mstrmojo.provide("mstrmojo.css",{DISPLAY_TABLE:T.isNSIE?"block":"table",DISPLAY_CELL:T.isNSIE?"block":"table-cell",MINHEIGHT:T.isIE6?"height":"minHeight",addClass:function L(e,d){if(e){if(d.constructor!==Array){d=[d];}var Z=e.className||"",g=" "+Z+" ",a=false,Y=d.length,b;for(b=0;b<Y;b++){var f=d[b];if(!g.match(new RegExp("\\s"+f+"\\s"))){Z+=" "+f;a=true;}}if(a){e.className=K.trim(Z);}}return e;},removeClass:function N(c,b){if(!c){return ;}if(b.constructor!==Array){b=[b];}var Z=" "+(c.className||"")+" ",Y=b.length,a;for(a=0;a<Y;a++){Z=Z.replace(new RegExp("\\s"+b[a]+"\\s","g")," ");}c.className=K.trim(Z);},addWidgetCssClass:function M(d,b){var Z=d.cssClass,c=(Z&&Z.split(" "))||[],a;b=[].concat(b);for(a=0;a<b.length;a++){var Y=b[a];if(X.indexOf(c,Y)===-1){c.push(Y);}}d.cssClass=c.join(" ");},removeWidgetCssClass:function F(e,c){var Z=e.cssClass,d=(Z&&Z.split(" "))||[],b;c=[].concat(c);for(b=0;b<c.length;b++){var Y=c[b];var a=X.indexOf(d,Y);if(a!==-1){d.splice(a,1);}}e.cssClass=d.join(" ");},toggleClass:function S(a,Z,Y){if(Y){this.addClass(a,Z);}else{this.removeClass(a,Z);}},applyShadow:function G(c,d,b,a,Y){var Z=c.style;if(T.isDXIE){Z.filter+="progid:DXImageTransform.Microsoft.dropshadow(OffX="+d+"px, OffY="+b+"px, Color='"+Y+"')";}else{if(T.isFF||T.isWK||T.isIE10){Z[T.CSS3_BOXSHADOW]=d+"px "+b+"px "+a+"px "+Y;}}},removeShadow:function B(Z){var Y=Z.style;if(T.isFF||T.isWK||T.isIE10){Y[T.CSS3_BOXSHADOW]="";}},setOpacity:function U(Z,b){if(T.isDXIE&&!T.isIE9){var c=Z.currentStyle.filter;var Y=null;if(c.length>0){Y=Z.filters["DXImageTransform.Microsoft.Alpha"];}if(Y){Y.opacity=b;Y.enabled=(b!==100);}else{if(b<100){var a="progid:DXImageTransform.Microsoft.Alpha(Opacity="+b+")";Z.style.filter=(c||"")+" "+a;}}}else{Z.style.opacity=b/100-(T.isIE9?0.00001:0);}},buildGradient:function O(Z,b,Y){if(T.supports(T.cssFeatures.GRADIENTS)){var a={};if(T.isDXIE){a.n="filter";a.v="progid:DXImageTransform.Microsoft.Gradient(GradientType="+Z+",StartColorStr='"+b+"',EndColorStr='"+Y+"')";}else{if(T.isFF){a.n="background-image";a.v="-moz-linear-gradient("+((Z===0)?"top":"left")+","+b+","+Y+")";}else{if(T.isWK){a.n="background";a.v="-webkit-gradient(linear,"+((Z===0)?"left top, left bottom":"left top, right top")+",from("+b+"),to("+Y+"))";}else{if(T.isIE10||T.isIEW3C){a.n="background";a.v="linear-gradient("+((Z===0)?"to bottom":"to right")+","+b+","+Y+")";}}}}return a;}return null;},buildRoundCorners:function Q(d,c){if(T.supports(T.cssFeatures.ROUND_CORNERS)){var Z=d+"px";var f=Z+(c?" "+Z+" 0 0":"")+";";if(T.isFF||T.isWinPhone||T.isIE10){return"border-radius:"+f;}if(T.isWK){if(!c){return"-webkit-border-radius:"+Z+";";}var e=["left","right"],b=[],Y=-1,a;for(a=0;a<2;a++){b[++Y]="-webkit-border-top-"+e[a]+"-radius:"+Z;b[++Y]="-webkit-border-bottom-"+e[a]+"-radius:0";}return b.join(";");}}return"";},getBorderWidthsOrPaddings:function D(Z,e){var f={t:0,r:0,b:0,l:0,h:0,w:0};if(!Z){return f;}var c=Z.split(" "),Y=c.length,d;for(d=0;d<Y;d++){c[d]=Math.round(e*parseFloat(c[d])/72);}if(Y<4){if(Y===1){c[1]=c[2]=c[3]=c[0];}else{c[3]=c[1];if(Y===2){c[2]=c[0];}}}f.t=c[0];f.r=c[1];f.b=c[2];f.l=c[3];f.h=f.t+f.b;f.w=f.l+f.r;return f;},getBorderWidths:function H(Z,Y){return this.getBorderWidthsOrPaddings(Z,Y);},getPaddings:function C(Z,Y){return this.getBorderWidthsOrPaddings(Z,Y);},parkAfterFade:function A(Y){var Z=Y.target.style;if(Z.opacity===0){Z.left="-10000px";window.setTimeout(function(){Z.opacity=0.99;},0);return true;}return false;},getStyleValue:function I(Y,c){var a=(c==="float"),b;if(Y.currentStyle){c=a?"styleFloat":c;b=Y.currentStyle[c];}else{if(document.defaultView&&document.defaultView.getComputedStyle){c=a?"cssFloat":c;var Z=document.defaultView.getComputedStyle(Y,null);b=Z?Z[c]:null;}}return b;},getComputedStyle:function R(Y,a){var Z=(window.getComputedStyle)?function(b,c){return window.getComputedStyle(b,c||null);}:function(b){return b.currentStyle||{};};mstrmojo.css.getComputedStyle=Z;return Z(Y,a);},getCssTextFromObj:function E(a){var Z="",Y;for(Y in a){Z+=Y+":"+a[Y]+";";}return Z;},onTransitionEnd:function W(a,Y){var Z="transition",b=window.Modernizr;if(b.testProp(Z)){T.attachOneTimeEvent(a,T.transEndEvtNames[b.prefixed(Z)],Y);}else{window.setTimeout(Y,0);}},flashClass:function P(Z,Y,b){this.toggleClass(Z,Y,true);var a=this;window.setTimeout(function(){a.toggleClass(Z,Y,false);},b);},convertCssToCamelCase:function J(Y){return Y.replace(/\-([a-z])/gi,function(Z,a){return a.toUpperCase();});},printCSSInfo:function V(c){var g=document.styleSheets,l=g.length,d,e;for(e=0;e<l;e++){var f=g[e],h=f.cssRules,a=h?h.length:0,k=0;for(d=0;d<a;d++){var Y=h[d].selectorText;if(Y){try{k+=Y.split(",").length;}catch(b){}}}var Z=f.href;if(!c||(Z&&X.indexOf(Z,c)>-1)){console.log("Stylesheet: "+Z||"Inline CSS Block");console.log("Total rules: "+a);console.log("Total selectors: "+k);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.string","mstrmojo.array");var N=mstrmojo.locales,I=mstrmojo.string,Q=window.mstrConfig,F=mstrmojo.array,K=function(){return mstrmojo.locales.number.THOUSANDSEPARATOR;},R=function(){return mstrmojo.locales.number.DECIMALSEPARATOR;},C=Q.units,T={CM:1,IN:2,MM:3,PT:4,PC:5,PX:6},A={1:"cm",2:"in",3:"mm",4:"pt",5:"pc",6:"px"},E={DEFAULT:-2,FIXED:0,CURR:1,PERCENT:4,FRACTION:5,SCIENTIFIC:6,GENERAL:9};var G=96;String.prototype.reverse=function(){var W="",V;for(V=this.length;V>0;--V){W+=this.charAt(V-1);}return W;};function M(V,X){V=V||"";X=X||V.match(/\".+?\"/g)||[];for(var W=0;W<X.length;W++){V=V.replace(X[W],X[W].substring(1,X[W].length-1).replace(/\$/g,"$$$$"));}return V;}function U(a){var V=86400000,Z=new Date(1900,0,1,0,0,0,0),W=Math.floor(a)-1,Y=a-W-1;if(a>=59){W--;}var X=new Date(Z.getTime()+(W*V));X.setTime(X.getTime()+Y*V+500);return X;}function H(Z,g,j){var a={"d+":Z.getDate(),"h+|H":Z.getHours(),"s+":Z.getSeconds()},V=N.datetime,b;if(/(y+)/.test(g)){var Y=Z.getFullYear().toString(),f=RegExp.$1,X=f.length===2,W=Y.length;g=g.replace(f,Y.substr(X?W-2:0,X?2:W));}if(/(^\[h\])/.test(g)&&j){g=g.replace(RegExp.$1,""+(Math.floor(j*24)));}if(/(\"?:\"?mm)/.test(g)){var c=Z.getMinutes();g=g.replace(RegExp.$1,":"+(RegExp.$1.length===1?c:("00"+c).substr(c.toString().length)));}if(/(AM\/PM)/.test(g)){var h=a["h+"],d=h>11;a["h+"]=h-(d?12:0);g=g.replace(RegExp.$1,d?"PM":"AM");}for(b in a){if(new RegExp("("+b+")").test(g)){g=g.replace(RegExp.$1,RegExp.$1.length===1?a[b]:("00"+a[b]).substr((a[b].toString()).length));}}if(/(mmmm)/.test(g)){g=g.replace(RegExp.$1,V.MONTHNAME_FULL[Z.getMonth()]);}else{if(/(mmm)/.test(g)){g=g.replace(RegExp.$1,V.MONTHNAME_SHORT[Z.getMonth()].substr(0,3));}else{if(/((m|M)+)/.test(g)){var e=(Z.getMonth()+1).toString();g=g.replace(RegExp.$1,RegExp.$1.length===1?e:("00"+e).substr(e.length));}}}return M(g);}function O(W,Z){var X=0,V=Z.length,Y=0;for(;X<V;X++){if(Z[X]==="0"){Y++;}else{if(Z[X]==="#"){if(Y<W){Y++;}}else{continue;}}}return Y;}mstrmojo.num=mstrmojo.provide("mstrmojo.num",{isInt:function D(V){var Y=K(),X=new RegExp("^(-)?[0-9]{1,3}(\\"+Y+"[0-9]{3})*$"),W=new RegExp("^(-)?[0-9]+$");return(String(V).indexOf(Y)&&X.test(V))||W.test(V);},isNumeric:function P(Y,Z){var X=R(),a=K(),W=new RegExp("^(-)?[0-9]{1,3}(\\"+a+"[0-9]{3})*(\\"+X+"[0-9]+)?$"),V=new RegExp("^(-)?[0-9]*(\\"+X+")?[0-9]+$");return(String(Y).indexOf(a)&&W.test(Y))||V.test(Y);},parseInteger:function L(V,W){if(!this.isInt(V)){return Number.NaN;}return parseInt(this.toString(V,true),W);},parseNumeric:function B(V){if(!this.isNumeric(V)){return Number.NaN;}return parseFloat(this.toString(V,true));},inNumericRange:function S(W,X,V){W=this.parseNumeric(W);V=(V!=null)?this.parseNumeric(String(V)):Number.NaN;X=(X!=null)?this.parseNumeric(String(X)):Number.NaN;if(V!=Number.NaN&&(W>V||isNaN(W))){return 1;}if(X!=Number.NaN&&(W<X||isNaN(W))){return -1;}return 0;},convertToUSUnits:function(Y,X,W){var V=Y;X=X||C;switch(parseInt(X,10)){case T.CM:V=parseFloat(this.toString(Y))/2.54+"";break;case T.MM:V=parseFloat(this.toString(Y))/25.4+"";break;case T.PT:V=parseFloat(this.toString(Y))/72+"";break;case T.PC:V=parseFloat(this.toString(Y))/6+"";break;case T.PX:V=parseFloat(this.toString(Y))/G+"";break;}return W?V:this.toLocaleString(V);},convertToLocalUnits:function(Y,X,W){var V;X=X||C;switch(parseInt(X,10)){case T.CM:V=(parseFloat(this.toString(Y))*2.54).toFixed(4)+"";break;case T.MM:V=(parseFloat(this.toString(Y))*25.4).toFixed(4)+"";break;case T.PT:V=(parseFloat(this.toString(Y))*72).toFixed(4)+"";break;case T.PC:V=(parseFloat(this.toString(Y))*6).toFixed(4)+"";break;case T.PX:V=(parseFloat(this.toString(Y))*G)+"";break;default:V=parseFloat(this.toString(Y)).toFixed(4)+"";}return W?V:this.toLocaleString(V);},convertUnits:function(W,X,V){return this.convertToLocalUnits(this.convertToUSUnits(V,W,true),X,true);},toLocaleString:function(V){return(V+"").replace(".",R());},toString:function(X,V){if(V===true){var W=this.getThousandSepRegex();if(W){X=String(X).replace(W,"");}}return String(X).replace(R(),".");},getThousandSepRegex:function(){if(this.thousandSeparatorRegex==null){this.thousandSeparatorRegex=new RegExp(K().replace(/(\W){1}/g,"\\$1"),"g");}return this.thousandSeparatorRegex;},addSeparators:function(X,W){var V=W;if(W=="."||W=="*"||W=="\\"){V="\\"+W;}return X.reverse().replace(/(\d{3})/g,"$1"+W).reverse().replace(new RegExp("^(-)?"+V),"$1");},format:function(Z,Y,c,V){var b="",a=(Y>0)?".":"",W=[];c=(c)?c:"";for(var X=0;X<Y;X++){W.push("0");}W=W.join("");switch(Z){case E.GENERAL:b="0.00";break;case E.PERCENT:b="0"+a+W+"%";break;case E.SCIENTIFIC:b="0"+a+W+"E+00";break;default:b='"'+c+'"#,##0'+a+W;}return this.formatByMask(b,V);},getDecimalLength:function J(X){var V=X.indexOf("."),Y=0;if(V!==-1){var W=X.substr(V+1,X.length).match(/\d+/);if(W&&W.length>0){Y=W[0].length;}}return Y;},formatByMask:function(AD,AT){var AA,r;if(isNaN(AT)){AA=new Date(AT);if(isNaN(AA)){return AT;}r=true;}if(AD==="General"){return String(parseFloat(AT).toFixed(2));}var q=String(AD).split(";"),l="",Y=q[0],h="\u00A4",AM=/"[^"]*"/g,k=(AD&&AD.replace(AM,h).replace(/\[.*\]/g,h))||"",AS=["m","y","d","h","s"],AI=false;F.forEach(AS,function(j){AI=AI||k.indexOf(j,0)!==-1;});if(AI){if(window.SSF){l=window.SSF.format(AD,AT);}if(l!==""){return l;}else{return H(r?AA:U(AT),AD,AT);}}var AH=Y.indexOf("E+"),e=Y.indexOf("%"),w=Y.match(/\".+?\"/g),x=Y.indexOf("?/?")>-1,AB=(AH!=-1)?E.SCIENTIFIC:((e!=-1)?E.PERCENT:((w)?E.CURR:x?E.FRACTION:E.FIXED)),p="",AO="",n=false,W=new String(AT),d=this.parseNumeric(AT)||parseFloat(AT);if(w){if(Y.match(/\[\$.+?\]/g)){for(var f=0;f<w.length;f++){Y=Y.replace(w[f],w[f].substring(1,w[f].length-1));if(w[f].match(/\[\$.+?\]/g)){w[f]=w[f].replace(/\[\$.+?\]/g,w[f][w[f].indexOf("[$")+2]);}}Y=Y.replace(/\[\$.+?\]/g,'"#"'.replace("#",Y[Y.indexOf("[$")+2]));}p=M(Y,w);p=p.replace(Y.replace(/\".+?\"/g,""),h);}if(d<0){W=W.substring(1,W.length);d=-d,n=true;if(q.length>1){var b=q[1].replace(/\[.*\]/,"");AO=M(b.replace(q[0],h));}}var c=function(m,j){return(j)?j.replace(h,m):"-"+m;};if(AB==E.FRACTION){var AL,AK,AR,o=10,z,u=0,AF,AN,Z,X=false,AC;if(AD.indexOf("# ")>-1){X=true;}for(AL=5;AL>0;AL--){AC="/";for(AK=0;AK<AL;AK++){AC+="?";}if(AD.indexOf(AC)>-1){for(AK=1;AK<AL;AK++){o*=10;}break;}}if(X){u=Math.floor(Number(d));d-=u;}AN=o/2;AR=-1;AF=d*o;for(AL=o-1;AL>=2;AL--){Z=(AF*AL)/o;Z=Z-Math.floor(Z);Z=Z*o;if(Math.abs(Z-o)<Z){Z=Math.abs(Z-o);}Z=Z/AL;if(Z<AN){AN=Z;AR=AL;}else{if((Z==AN)&&(Z==0)){AN=Z;AR=AL;}}}z=Math.round(AR*AF/o);for(AL=AR;AL>=2;AL--){if((z%AL==0)&&(AR%AL==0)){z=z/AL;AR=AR/AL;break;}}if(AR==o){AR=1;z=0;}if(z==0){AR=1;}if(z==AR){if(X){l=""+(u+1);}else{l="1";}}else{if(X&&u>0){if(z==0){l=u;}else{l=u+" "+z+"/"+AR;}}else{if(z==0){l="0";}else{l=z+"/"+AR;}}}if(n){l=c(l,AO);}}else{if(AB==E.SCIENTIFIC){if(d!=0){var AU=Math.floor(Math.log(d)/Math.LN10),AJ=d/Math.pow(10,AU),AV=Y.substring(0,AH),g=AV.indexOf("."),AE=Y.length-Y.indexOf("E+")-(""+Math.abs(AU)).length-2,AL,V=AU<0;AU=Math.abs(AU);for(AL=0;AL<AE;AL++){AU="0"+AU;}l+=Number(AJ).toFixed((g!=-1)?AV.length-g-1:0);l=((n)?c(l,AO):l)+"E"+(V?"-":"+")+AU;}else{l="0";}}else{if(AB==E.PERCENT){Y=Y.substring(0,Y.length-1);W=String(d*100);}var g=Y.indexOf("."),a=0,AQ,t=g>=0?Y.substring(0,g):Y;if(t.match(/[#0\?],$/)){d/=1000;W=String(d);}AQ=this.getDecimalLength(W);if(g!=-1){a=O(AQ,Y.substr(g+1,Y.length));}l=String(parseFloat(W).toFixed(Math.min(a,20)));var AP=l.split(".");var AG=Y.replace(/"[^"]*"/g,"").match(/[#\d]+[^\.\d#]+[#\d]+/);if(AG!==null){AP[0]=this.addSeparators(AP[0],K());}l=AP.join(R());if(AB==E.CURR){l=p.replace(h,l);if(l===p&&window.SSF){l=window.SSF.format(AD,AT);}}if(AB==E.PERCENT){l+="%";}if(n){l=c(l,AO);}}}return l;},validateFormat:function(V){var W=true,X=String(V).split(";");if(X[1]&&X[1].indexOf(X[0])<0){W=false;}return W;},generateUniqueID:function(V){var X="0123456789ABCDEF".split(""),Y=[];for(var W=0;W<V;W++){Y[W]=X[0|Math.random()*16];}return Y.join("");},countOfDecimals:function(W,X){var V=String(W);return V.length-(V.indexOf(X!==undefined?X:R())+1);}});mstrmojo.num.UNIT=T;mstrmojo.num.UNIT_SYMBOL=A;})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.hash");var M=mstrmojo.string,L=mstrmojo.hash,E=mstrmojo.dom;var R=mstrmojo.usesFrames?null:document.createElement("span");var J=/mstrAttach:([\w,]+)/g;var Q;function U(a){if(Q===undefined){Q=(mstrApp!==undefined&&mstrApp.isTouchApp&&mstrApp.isTouchApp())||false;}return a.replace(J,function Z(g,j){var c=j.split(","),d=[],b=c.length,f;for(f=0;f<b;f++){var h=c[f];if(h){if(Q){if(h.indexOf("mouse")>-1){continue;}else{if(h==="click"){h="touchend";}}}d.push("on"+h+"=\"mstrmojo.dom.captureDomEvent('{@id}','"+h+"', self, event)\"");}}return d.join(" ");});}var N="preBuildRendering",C="buildRendering",B="postBuildRendering";function X(b){var a=b.markupString;if(a.match(/mstrAttach:/)){a=U(a);if(b.markupString===b.constructor.prototype.markupString){b.constructor.prototype.markupString=a;}}var Z=M.apply(a,b);if(Z){if(mstrmojo.usesFrames){var c=(b.domNode&&b.domNode.ownerDocument)||window.document;if(!R||R.ownerDocument!==c){R=c.createElement("span");}}R.innerHTML=Z;var e=R.removeChild(R.firstChild);e.mstrmojoId=b.id;return e;}return null;}function A(b){var a=b.markupSlots,Z,c;if(a){Z={};for(c in a){Z[c]=a[c].call(b);}}return Z;}mstrmojo._HasMarkup=mstrmojo.provide("mstrmojo._HasMarkup",{markupString:null,markupMethods:null,markupSlots:null,onRender:mstrmojo.emptyFn,onUnRender:mstrmojo.emptyFn,render:function Y(){if((this[N]&&this[N]()===false)||(this[C]()===false)||(this[B]&&this[B]()===false)){return false;}this.hasRendered=!!this.domNode;this.onRender();var Z="renderComplete";if(mstrmojo.publisher.hasSubs(this.id,Z)){this.raiseEvent({name:Z});}return true;},buildDom:function T(){return X(this);},postBuildDom:null,preBuildRendering:mstrmojo.emptyFn,buildRendering:function F(){var Z=this.domNode,a=this.buildDom();this.domNode=a;if(this.postBuildDom){this.postBuildDom();}if(this.slotNames){this.removeSlots(this.slotNames);}this.addSlots(A(this));this.paint();if(a){var d=Z;if(!d){d=this.placeholder;if(d){if(typeof d==="string"){d=document.getElementById(d);}delete this.placeholder;}}if(d){E.replace(d,a);}}var b="onchildRenderingChange",c=this.parent;if(c&&c[b]){c[b](this);}return true;},postBuildRendering:mstrmojo.emptyFn,unrender:function S(b){if(this.hasRendered){if(!b){try{var Z=this.domNode;if(Z.parentNode){Z.parentNode.removeChild(Z);}if(mstrmojo.dom.isIE&&Z.outerHTML!=="undefined"){Z.outerHTML="";}}catch(a){}}this.domNode=null;this.removeSlots(this.slotNames);this.hasRendered=false;this.onUnRender();}},paint:function K(){var a=this.markupMethods;if(!a){return ;}var d=this,e=function(j){var h=a[j];if(h){try{h.apply(d,[true]);}catch(g){throw new Error(["Error in markup method.","Script class: "+d.scriptClass,"Widget id: "+d.id,"Method name: "+j,"Err: "+g.message].join("\n\n"));}}};var c=a.sequence,Z,b,f;if(c){Z=c.length||0;for(b=0;b<Z;b++){e(c[b]);}}else{for(f in a){e(f);}}},redraw:function P(){return false;},refresh:function D(Z){if(this.hasRendered){if(this.redraw()!==true){var a=this.domNode;this.unrender(true);this.placeholder=a;if(Z){Z();}this.render();}}},set:function I(c,Z){this._super(c,Z);if(this.domNode){var a=this.markupMethods,b=a&&a["on"+c+"Change"];if(b){b.apply(this);}}return this;},slotNames:null,addSlots:function G(a){var Z=this.slotNames,b;if(!Z){Z={};this.slotNames=Z;}for(b in a){this[b]=a[b];Z[b]=true;}},removeSlots:function H(Z){if(Z){var a=this.slotNames,b;for(b in Z){delete this[b];if(a){delete a[b];}}}},captureDomEvent:function W(b,Z,c,a){if(this.enabled!==false){this.raiseEvent(mstrmojo._HasMarkup.newDomEvent(b,Z,c||Z.event,a));}},playEffect:function V(a){var Z=this[a];if(Z&&Z.constructor===Object){Z=mstrmojo.insert(mstrmojo.hash.clone(Z));Z.widget=this;this[a]=Z;}if(Z){Z.play();}}});mstrmojo._HasMarkup.addMarkupMethods=function O(a,Z){a.prototype.markupMethods=L.copy(Z,L.copy(a.prototype.markupMethods));};mstrmojo._HasMarkup.MSTRDomEventType=null;mstrmojo._HasMarkup.newDomEvent=function(c,Z,b,a){return{name:c,hWin:Z,e:b,config:a,ctrlKey:E.ctrlKey(Z,b),shiftKey:E.shiftKey(Z,b),metaKey:E.isMetaKey(Z,b),cancel:function(){E.stopPropogation(Z,b);},preventDefault:function(){E.preventDefault(Z,b);},getTarget:function(){return E.eventTarget(Z,b);}};};}());(function(){mstrmojo.requiresCls("mstrmojo.string");var D=mstrmojo.string,F=1;mstrmojo.ListBuilder=mstrmojo.provide("mstrmojo.ListBuilder",{newContext:function E(G){var I=G.itemMarkupFunction;if(!I){var H=G.itemMarkup||(G.itemField&&'<div class="mstrmojo-text">{@'+G.itemField+"}</div>");I=H?function(K,J,L){return D.apply(H,K);}:null;}return{itemStatus:[],itemFunc:I};},build:function A(I,H,J,G){H.itemStatus[G]=F;return H.itemFunc(J,G,I);},onadd:function B(I,G,H){if(G){mstrmojo.array.insert(G.itemStatus,H.index,new Array(H.value.length));}},onremove:function C(I,G,H){if(G){G.itemStatus.splice(H.index,H.value.length);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales");var X=function(){return mstrmojo.locales.datetime;},L=mstrmojo.string;mstrmojo.date=mstrmojo.provide("mstrmojo.date",{monthNumbers:{Jan:1,Feb:2,Mar:3,Apr:4,May:5,Jun:6,Jul:7,Aug:8,Sep:9,Oct:10,Nov:11,Dec:12},REGEXPS:{DATES:{},TIMES:{}},CACHE:{PARSEDATE:{CONTAINS:{},EQUALS:{}},PARSETIME:{CONTAINS:{},EQUALS:{}}},now:Date.now||function D(){return new Date().getTime();},isDate:function Y(b,f,a){var d=this.parseDate(b,a);var e=!!(d&&this.doesDateExist(d.month,d.day,d.year));if(f){if(e){var c=this.formatDateInfo(d,X().DATEOUTPUTFORMAT);if(a){return{match:d.match,formatted:c};}return c;}return null;}return !!e;},formatDateInfo:function R(d,f){if(!f){return"";}var a=d.day,e=d.month,c=d.year;var b=f.replace(/dd/g,this.formatInteger(a,2)).replace(/d/g,Number(a)).replace(/yyyy/g,Number(c)).replace(/yy/g,this.formatInteger(Number(c)%100,2)).replace(/MMM/g,"~~~~").replace(/MM/g,"@@").replace(/M/g,"^").replace(/MMMM/g,X().MONTHNAME_FULL[Number(e)-1]).replace(/\~\~\~\~/g,X().MONTHNAME_SHORT[Number(e)-1]).replace(/\@\@/g,this.formatInteger(e,2)).replace(/\^/g,Number(d.month));return b;},parseDate:function Z(l,f,j){if(l==null){return false;}if(typeof l!=="string"){l=String(l);}l=L.trim(l);var a=this.CACHE.PARSEDATE[f?"CONTAINS":"EQUALS"],c=a[l];if(c||(c===null)){return c;}var b=null;var h;if(j){h=[j];}else{h=[].concat(X().DATEINPUTFORMATS);h.unshift(X().DATEOUTPUTFORMAT);}var d,e;for(d=0,e=h.length;d<e;d++){var g=this._buildRegExp4DateFormat(h[d]),k=g&&l.match(f?g.reContains:g.reEquals);if(k){b={match:k[0],year:g.yearIndex&&this.fourDigitYear(k[g.yearIndex]),day:g.dayIndex&&parseInt(Number(k[g.dayIndex]),10),month:g.monthIndex&&this.numericMonth(k[g.monthIndex])};break;}}a[l]=b;return b;},isTime:function I(b,e,a){var f=this.parseTime(b,a);var d=!!(f&&this.doesTimeExist(f.hour,f.min,f.sec));if(e){if(d){var c=this.formatTimeInfo(f,X().TIMEOUTPUTFORMAT);if(a){return{match:f.match,formatted:c};}return c;}return null;}return !!d;},parseTime:function J(m,f,k){if(m==null){return false;}if(typeof m!=="string"){m=String(m);}m=L.trim(m);var a=this.CACHE.PARSETIME[f?"CONTAINS":"EQUALS"],c=a[m];if(c||(c===null)){return c;}var b=null;var j;if(k){j=[k];}else{j=[].concat(X().TIMEINPUTFORMATS);j.unshift(X().TIMEOUTPUTFORMAT);}var d,e;for(d=0,e=j.length;d<e;d++){var h=this._buildRegExp4TimeFormat(j[d]),l=h&&m.match(f?h.reContains:h.reEquals);if(l){var g=h.ampmIndex&&l[h.ampmIndex];b={match:l[0],hour:h.hourIndex&&this.capitalHour(l[h.hourIndex],g),min:h.minIndex&&parseInt(Number(l[h.minIndex]),10),sec:h.secIndex&&parseInt(Number(l[h.secIndex]),10)};break;}}a[m]=b;return b;},formatTimeInfo:function S(d,b){if(!b){return"";}var c=!(Number(d.hour)%12)?12:(Number(d.hour)%12),a=b.replace(/HH/g,this.formatInteger(d.hour,2)).replace(/H/g,Number(d.hour)).replace(/hh/g,this.formatInteger(c,2)).replace(/h/g,c).replace(/mm/g,this.formatInteger(Number(d.min)||0,2)).replace(/m/g,Number(d.min)||0).replace(/ss/g,this.formatInteger(Number(d.sec)||0,2)).replace(/s/g,Number(d.sec)||0).replace(/a/g,(Number(d.hour)<12)?X().AM_NAME:X().PM_NAME).replace(/tt/g,(Number(d.hour)<12)?X().AM_NAME:X().PM_NAME).replace(/AM\/PM/g,(Number(d.hour)<12)?X().AM_NAME:X().PM_NAME);return a;},doesTimeExist:function G(f,b,e){var d=parseInt(f,10);if(d>=0&&d<=23){var a=parseInt(b,10);if(a>=0&&a<=59){if(!e){return true;}var c=parseInt(e,10);if(c>=0&&c<=59){return true;}}}return false;},capitalHour:function C(a,b){a=parseInt(Number(a),10);if(b&&(b.match(X().AM_NAME)||b.match(/AM/i))){return a%12;}if(b&&(b.match(X().PM_NAME)||b.match(/PM/i))){return 12+(a%12);}return a;},getTimeStamp:function O(){var b=new Date();var a=[b.getMonth()+1,b.getDate(),b.getFullYear()];var e=[b.getHours(),b.getMinutes(),b.getSeconds()];var d=(e[0]<12)?"AM":"PM";e[0]=(e[0]<12)?e[0]:e[0]-12;e[0]=e[0]||12;for(var c=1;c<3;c++){if(e[c]<10){e[c]="0"+e[c];}}return a.join("-")+" "+e.join(":")+" "+d;},isDateAndOrTime:function V(a,b){return this.isDateTime(a,b)||this.isDate(a,b)||this.isTime(a,b);},isDateTime:function B(k,a){var e=this.parseDateAndOrTime(k),h=e&&e.date,d=e&&e.time,g=!!h&&!!d&&this.doesDateExist(h.month,h.day,h.year)&&this.doesTimeExist(d.hour,d.min,d.sec);if(a){if(g){var b=this.formatDateInfo(h,X().DATEOUTPUTFORMAT),c=this.formatTimeInfo(d,X().TIMEOUTPUTFORMAT),j=k.indexOf(h.match),f=k.indexOf(d.match);return(f<j)?c+" "+b:b+" "+c;}return null;}return !!g;},parseDateAndOrTime:function Q(b,a,f){var c=this.parseDate(b,true,a);var d=L.trim((c&&c.match)?b.replace(c.match,""):b),e=this.parseTime(d,false,f);if(!c&&!e){return null;}return{date:c,time:e};},inDateTimeRange:function P(c,e,h){var b=this.parseDateAndOrTime(c),f=b&&b.date,j=b&&b.time;if(!f&&!j){return 0;}if(e!=null){var d=this.parseDateAndOrTime(e);if(f&&d&&d.date){var k=this.compareDate(f,d.date);if(k<0){return -1;}if(k==0){if(j&&d.time&&(this.compareTime(j,d.time)<0)){return -1;}}}}if(h!=null){var a=this.parseDateAndOrTime(h);if(f&&a&&a.date){var g=this.compareDate(f,a.date);if(g>0){return 1;}if(g==0){if(j&&a.time&&(this.compareTime(j,a.time)>0)){return 1;}}}}return 0;},compareDate:function A(c,a){if(c===a){return 0;}var d=typeof c==="string"?this.parseDate(c):c,b=typeof a==="string"?this.parseDate(a):a;if(!d){return -1;}if(!b){return 1;}return(d.year-b.year)||(d.month-b.month)||(d.day-b.day)||0;},compareTime:function K(b,a){if(b===a){return 0;}var d=typeof b==="string"?this.parseTime(b):b,c=typeof a==="string"?this.parseTime(a):a;if(!d){return -1;}if(!c){return 1;}return(d.hour-c.hour)||(d.min-c.min)||(d.sec-c.sec)||0;},compareDateTime:function U(b,a){return this.compareDate(b,a)||this.compareTime(b,a);},compareDateAndOrTime:function E(h,f){if(h===f){return 0;}var b=typeof h==="string"?this.parseDateAndOrTime(h):h,a=typeof f==="string"?this.parseDateAndOrTime(f):f;if(!b){return -1;}if(!a){return 1;}var g=b.date,e=a.date,d=b.time,c=a.time;return this.compareDate(g,e)||this.compareTime(d,c);},_buildRegExp4DateFormat:function N(c){if(!c){return null;}var e=this.REGEXPS.DATES[c];if(!e){if(!this.REGEXPS.MONTHNAME_FULL){this.REGEXPS.MONTHNAME_FULL=X().MONTHNAME_FULL.join("|");this.REGEXPS.MONTHNAME_SHORT=X().MONTHNAME_SHORT.join("|");}e=this.REGEXPS.DATES[c]={};e.formatStr=c;var b=e.reStr=c.replace(/([^M|d|y|\s])/g,"\\$1").replace(/dd/g,"~~~~").replace(/d/g,"(\\d{1,2})").replace(/\~\~\~\~/g,"(\\d\\d)").replace(/yyyy/g,"(\\d\\d\\d\\d)").replace(/yy/g,"(\\d\\d)").replace(/MMMM/g,"@@@@").replace(/MMM/g,"@@@").replace(/MM/g,"(\\d\\d)").replace(/M/g,"(\\d{1,2})").replace("@@@@","("+this.REGEXPS.MONTHNAME_FULL+")").replace("@@@","("+this.REGEXPS.MONTHNAME_SHORT+")");e.reEquals=new RegExp("^"+b+"$");e.reContains=new RegExp("^"+b+"\\b");var f=[{key:"monthIndex",index:c.indexOf("M")},{key:"dayIndex",index:c.indexOf("d")},{key:"yearIndex",index:c.indexOf("y")}];f.sort(function(h,g){return h.index-g.index;});var a=1,d;for(d=0;d<3;d++){e[f[d].key]=f[d].index>-1?a++:null;}}return e;},_buildRegExp4TimeFormat:function F(d){if(!d){return null;}var f=this.REGEXPS.TIMES[d];if(!f){if(!this.REGEXPSTR_AMPM){this.REGEXPSTR_AMPM=[X().AM_NAME,X().PM_NAME,String(X().AM_NAME).toLowerCase(),String(X().PM_NAME).toLowerCase()].join("|");}f=this.REGEXPS.TIMES[d]={};f.formatStr=d;var c=d.replace(/\'\'/g,'"');var g=c.match(/\'(.+?)\'/g);c.replace(/\'(.+?)\'/g,"*");c=c.replace(/([^H|h|m|s|z|Z|a|t|\s|A|P|M|\/])/g,"\\$1").replace(/HH|hh/g,"(\\d\\d)").replace(/H|h/g,"(\\d{1,2})").replace(/mm/g,"(\\d\\d)").replace(/m/g,"(\\d{1,2})").replace(/ss/g,"(\\d\\d)").replace(/s/g,"(\\d{1,2})").replace(/a/g,"("+this.REGEXPSTR_AMPM+")").replace(/AM\/PM/,"("+this.REGEXPSTR_AMPM+")").replace(/tt/g,"("+this.REGEXPSTR_AMPM+")").replace(/z|Z/g,"(.+?)");var e,a;for(e=1,a=(g&&g.length)||0;e<a;e++){c=c.replace(/\*/,g[e]);}c=c.replace(/\"/g,"'");f.reEquals=new RegExp("^"+c+"$");f.reContains=new RegExp(c);var h=[{key:"hourIndex",index:d.search(/h|H/)},{key:"minIndex",index:d.indexOf("m")},{key:"secIndex",index:d.indexOf("s")},{key:"ampmIndex",index:d.search(/tt|a|AM\/PM/)},{key:"zoneIndex",index:d.search(/z|Z/)}];h.sort(function(k,j){return k.index-j.index;});var b=1;for(e=0;e<5;e++){f[h[e].key]=h[e].index>-1?b++:null;}}return f;},doesDateExist:function M(d,a,b){var c=new Date(b,d-1,a);return b==c.getFullYear()&&d==c.getMonth()+1&&a==c.getDate();},fourDigitYear:function T(b){b=parseInt(Number(b),10);if(!isNaN(b)){var a=(X().TWODIGITYEARSTART%100)||0;if(b>=0&&b<=a){b=2000+b;}else{if(b>a&&b<100){b=1900+b;}}}return b;},numericMonth:function W(e){var d=parseInt(Number(e),10),c=mstrmojo.array;if(!isNaN(d)){return d;}var a=(e&&e.length)||0,b=-1;if(a){if(a<=3){b=c.indexOf(X().MONTHNAME_SHORT,e);}if(b===-1){b=c.indexOf(X().MONTHNAME_FULL,e);}}return b+1;},formatInteger:function H(c,b){var f=String(c),e=Math.max(b-f.length,0);if(e>0){var a=[f],d;for(d=1;d<=e;d++){a.push("0");}f=a.reverse().join("");}return f;},getFirstDateOfMonth:function(b,a){return new Date(b,a-1,1);},getDateObject:function(g,a,f,c,e,b){g=g||0;a=a||1;f=f||1;c=c||0;e=e||0;b=b||0;return new Date(g,a-1,f,c,e,b);},getDateFromDateInfo:function(a){return this.getDateObject(a.date&&a.date.year,a.date&&a.date.month,a.date&&a.date.day,a.time&&a.time.hour,a.time&&a.time.min,a.time&&a.time.sec);},getDateJson:function(a){return{year:a.getFullYear(),month:a.getMonth()+1,day:a.getDate(),hour:a.getHours(),min:a.getMinutes(),sec:a.getSeconds()};},isLeapYear:function(a){return !(a%400)||(!(a%4)&&!!(a%100));},getDaysOfMonth:function(c,a){var b=[31,28,31,30,31,30,31,31,30,31,30,31];if(a==2&&this.isLeapYear(c)){return 29;}return b[a-1];},getPreMonth:function(b,a){if(a===1){return{y:b-1,m:12};}return{y:b,m:a-1};},getNextMonth:function(b,a){if(a===12){return{y:b+1,m:1};}return{y:b,m:a+1};}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.locales");var c=mstrmojo.array,P=mstrmojo.meta.TP,G=mstrmojo.meta.STP,O=mstrmojo.hash,F={ANDOR:14,MQ:10,MC:12,AQ:2,AL:6,AC:9,AE:5,F:13,R:21,B:20,XML:1,RLS:15},B={};var W;for(W in F){B[F[W]]=true;}var a={};a[F.AQ]="a";a[F.AL]="a";a[F.AC]="a";a[F.AE]="a";a[F.MQ]="m";a[F.MC]="m";a[F.F]="f";a[F.R]="r";a[F.XML]="p";var K={};K[F.MQ]=["not","m","fn","fnt","cs","dmy","idcsi"];K[F.MC]=["not","m","fn","fnt","m2","m3","p","dmy","idcsi"];K[F.AE]=["not","a","fn","es","a2","fm2","p"];K[F.AQ]=["not","a","fm","fn","cs"];K[F.AL]=["not","a","fm","fn","cs"];K[F.AC]=["not","a","fm","a2","fm2","a3","fm3","fn","cs"];K[F.R]=["not","r"];K[F.F]=["not","f"];K[F.XML]=["not","n","p"];var M={};M[F.MQ]="METRIC_FNS";M[F.MC]="METRIC_FNS";M[F.AQ]="FORM_FNS";M[F.AL]="FORM_FNS";M[F.AC]="FORM_FNS";M[F.AE]="ELEM_FNS";var N={FILTER:1,REPORT:3,METRIC:4,FOLDER:8,PROMPT:10,FUNCTION:11,ATTR:12,FACT:13,DIM:14,FORM:21,ROLE:43,CONS:47},b={FILTER:256,CUSTOMGROUP:257,PROMPT:2560,PROMPT_BOOLEAN:2561,PROMPT_LONG:2562,PROMPT_STRING:2563,PROMPT_DOUBLE:2564,PROMPT_DATE:2565,PROMPT_OBJECTS:2566,PROMPT_ELEMENTS:2567,PROMPT_EXPRESSION:2568,PROMPT_EXPRESSION_DRAFT:2569,PROMPT_DIMTY:2570,PROMPT_BIGDECIMAL:2571,REPORT_GRID:768,REPORT_GRAPH:769,REPORT_ENGINE:770,REPORT_TEXT:771,REPORT_DATAMART:772,REPORT_BASE:773,REPORT_GRIDGRAPH:774,REPORT_NONINTERACTIVE:775,REPORT_CUBE:776,REPORT_EMMACUBE:779,CONS:12032,NDE:12033},T={a:N.ATTR,a2:N.ATTR,m:N.METRIC,m2:N.METRIC,r:N.REPORT,f:N.FILTER,p:N.PROMPT},U={f:b.FILTER};var V={};V[F.MQ]=N.METRIC;V[F.MC]=N.METRIC;V[F.AQ]=N.ATTR;V[F.AL]=N.ATTR;V[F.AC]=N.ATTR;V[F.AE]=N.ATTR;V[F.F]=N.FILTER;V[F.R]=N.REPORT;var J=function(d){var H=d.length,g={},e;for(e=0;e<H;e++){var h=d[e];g[h.did]=h.n;}return g;},E=function(e){var H=e.length,f;for(f=0;f<H;f++){var d=e[f];if("tp" in d){d.t=d.tp;}}return e;},X=function(e,g){var H=e.length,f;for(f=0;f<H;f++){var d=e[f];if("tp" in d){if(g){d.t=g;}else{delete d.t;}}}return e;},Z=function(d,f){if(!f){f=[];}f.length=0;var e,H;for(e=0,H=d.length;e<H;e++){f[e]=d[e];}return f;},L={0:[{did:"1,76"},{did:"1,79"},{did:"1,77"},{did:"1,80"},{did:"1,78"},{did:"1,81"},{did:"1,18"},{did:"1,43"}],1:[{did:"2,1"},{did:"2,2"},{did:"3,1"},{did:"3,2"}]};var R={0:[{did:"1,22"},{did:"1,57"}]};mstrmojo.expr=mstrmojo.provide("mstrmojo.expr",{ET:F,ETs:B,ET2TGT:a,ET2COND:K,ET2TP:V,FN:{EQUAL:6,NOT_EQUAL:7,GREATER:8,LESS:9,GREATER_EQUAL:10,LESS_EQUAL:11,IN_LIST:22,NOT_IN_LIST:57,BETWEEN:17,NOT_BETWEEN:44,IS_NULL:54,IS_NOT_NULL:55,AND:19,OR:20,NOT:21,SEARCH:158},FN_MRP:{BETWEEN:3,EXCLUDE_TOP:4,EXCLUDE_BOTTOM:5,BETWEEN_DESCENDING:13},FNT:{DEF:1,RANK:2,PER:3},FN_SEP:",",TP:N,STP:b,DMY_TP:{ATTR:-1,DIM:-2},DTP:{UNKNOWN:-1,INTEGER:1,UNSIGNED:2,NUMERIC:3,DECIMAL:4,REAL:5,DOUBLE:6,FLOAT:7,CHAR:8,VARCHAR:9,LONGVARCHAR:10,BINARY:11,VARBIN:12,LONGVARBIN:13,DATE:14,TIME:15,TIMESTAMP:16,SHORT:21,LONG:22,MBCHAR:23,BOOLEAN:24,PATTERN:25,BIGDECIMAL:30},BFTP:{RESERVED:0,HIDDEN:-1,DATETIME:1,NUMBER:2,TEXT:3,PICTURE:4,URL:5,EMAIL:6,TAG:7,DATE:8,TIME:9,SYMBOL:10,BIGDECIMAL:11,PHONENUMBER:12},METRIC_DTP:3,FN_DTP:{NUM:0,CHAR:1,DATE:2},DTP2PROMPT_STP:{"-1":b.PROMPT,1:b.PROMPT_LONG,2:b.PROMPT_LONG,3:b.PROMPT_LONG,4:b.PROMPT_DOUBLE,5:b.PROMPT_DOUBLE,6:b.PROMPT_DOUBLE,7:b.PROMPT_DOUBLE,8:b.PROMPT_STRING,9:b.PROMPT_STRING,10:b.PROMPT_STRING,14:b.PROMPT_DATE,15:b.PROMPT_DATE,16:b.PROMPT_DATE,21:b.PROMPT_LONG,22:b.PROMPT_LONG,23:b.PROMPT_STRING,24:b.PROMPT_BOOLEAN,30:b.PROMPT_BIGDECIMAL},DTP2FN_DTP:{"-1":0,1:0,2:0,3:0,4:0,5:0,6:0,7:0,8:1,9:1,10:1,11:0,12:0,13:0,14:0,15:0,16:0,21:0,22:0,23:1,24:0,25:1,30:0,34:0},fnCstCount:function A(e,d){var g=this.FN,h=this.FN_MRP,H=this.FNT;if(d===H.DEF||d===undefined){switch(e){case g.BETWEEN:case g.NOT_BETWEEN:return 2;case g.IS_NULL:case g.IS_NOT_NULL:return 0;}}else{if(d===H.PER||d===H.RANK){switch(e){case h.BETWEEN:case h.BETWEEN_DESCENDING:return 2;}}}return 1;},fn_List:function S(d,H){var e=this.FN;return d==e.IN_LIST||d==e.NOT_IN_LIST;},fn_AC_MC:function Y(d,H){var e=this.FN;return(d==e.EQUAL)||(d==e.NOT_EQUAL)||(d==e.GREATER)||(d==e.LESS)||(d==e.GREATER_EQUAL)||(d==e.LESS_EQUAL);},fnName:function Q(h,g,d,f){var H=this[M[h]];if(H&&H.constructor===Object){H=H[this.DTP2FN_DTP[f]]||H["*"];}if(h===F.MQ){H=H.concat(mstrmojo.locales.expression.MetricRP);}var e=c.find(H,"did",(d||1)+this.FN_SEP+g);if(e>-1){return H[e].n;}return"";},findTargets:function I(n,f,p){if(!p){p={};}if(n){var m;for(m in T){var z=n[m];if(z){if(!z[P]){z[P]=T[m];}if(!z[G]&&U[m]){z[G]=U[m];}p[z[f]]=z;}}if(n.dmy){var j=this.TP.ATTR,q=this.DMY_TP.ATTR,e=n.dmy.uts,x,d;for(x=0,d=(e&&e.length)||0;x<d;x++){var l=e[x];if(l&&l.utp===q){var g=l.utgt;if(!g.t){g.t=j;}p[g[f]]=g;}}}var H=n.nds,o,v;for(o=0,v=(H&&H.length)||0;o<v;o++){this.findTargets(H[o],f,p);}var r=n.cs,w=r&&r.length;if(w){for(o=0;o<w;o++){this.findTargets(r[o],f,p);}}}return p;},onLocaleUpdated:function(){var d=mstrmojo.locales.expression,H=mstrmojo.expr;H.BRANCH_FNS=O.copy(J(d.BranchQual),H.BRANCH_FNS);H.ELEM_FNS=Z(X(d.Element,"fn"),H.ELEM_FNS);H.METRIC_FNS={"*":X(c.filter(d.Metric.concat(d.MetricRP),function(e){return e.did&&(c.find(R["0"],"did",e.did)<0);}))};H.FORM_FNS={0:X(c.filter(d.Attribute,function(e){return e.did&&(c.find(L["0"],"did",e.did)<0);})),1:X(c.filter(d.Attribute,function(e){return e.did&&(c.find(L["1"],"did",e.did)<0);})),2:X(c.filter(d.Attribute,function(e){return e.did&&(c.find(L["0"],"did",e.did)<0)&&(c.find(L["1"],"did",e.did)<0);}))};H.DIMTYLEVELS=Z(X(d.DimtyLevels),H.DIMTYLEVELS);},getSortedObjectsByTypeGroup:function D(f){var H=0,d=1,e=2;function g(h){switch(h.t){case N.METRIC:return d;case N.ATTR:case N.DIM:case N.CONS:return H;case N.FILTER:return h.st===b.CUSTOMGROUP?H:e;default:return e;}}return f.slice(0).sort(function(m,l){var n=g(m)-g(l);if(n){return n;}var k=m.n.toUpperCase(),j=l.n.toUpperCase(),h=k.localeCompare(j);if(h){return h;}return m.n.localeCompare(l.n);});},mapBaseFormTypeToDataType:function C(e){e=parseInt(e);if(e===NaN){return -1;}var d=this.BFTP,H=this.DTP;switch(e){case d.DATETIME:return H.TIMESTAMP;case d.DATE:return H.DATE;case d.TIME:return H.TIME;case d.NUMBER:return H.REAL;case d.TEXT:return H.CHAR;case d.BIGDECIMAL:return H.BIGDECIMAL;default:return H.CHAR;}}});mstrmojo.expr.onLocaleUpdated();}());(function(){mstrmojo.requiresCls("mstrmojo.publisher");var C=mstrmojo.publisher;mstrmojo._Provider=mstrmojo.provide("mstrmojo._Provider",{_meta_usesSuper:false,audibles:{"*":true},set:function F(N,H){var G=false,K=this["_set_"+N],I=this[N];if(K){G=K.apply(this,arguments);}else{this[N]=H;G=(I!==H);}if(G){var L=N+"Change",M=this.audibles||{},J=(M[N]===true)||((M[N]!==false)&&(M["*"]!==false));if(J&&(this["pre"+L]||this["on"+L]||this["post"+L]||C.hasSubs(this.id,L))){this.raiseEvent({name:L,prop:N,value:H,valueWas:I});}}return this;},raiseEvent:function B(H){var M=H&&H.name;if(!M){return null;}H.src=this;this.preHandleEvent(H);var K=["pre","on","post"],L=false,I,G;for(I=0,G=K.length;I<G;I++){var J=K[I]+M;if(this[J]){if(this[J](H)===false){L=true;break;}}}if(!L){this.postHandleEvent(H);C.publish(this.id,M,H);}return H;},preHandleEvent:mstrmojo.emptyFn,postHandleEvent:mstrmojo.emptyFn,attachEventListener:function A(G,H,I){return C.subscribe(this.id,G,I,H);},detachEventListener:function E(G){C.unsubscribe(G);},destroy:function D(){C.clearSubscriptions(this.id);if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ListSelector");var A=mstrmojo.dom;mstrmojo.TreeBrowserSelector=mstrmojo.provide("mstrmojo.TreeBrowserSelector",mstrmojo.hash.copy({premousedown:function B(F,I,E){if(A.isPrimaryMouseBtn(E.e)){var D=E.hWin,H=E.e,G=A.eventTarget(D,H),C=F.listMapper.findIndex(F,I,G);if(C>-1){F.toggleSelect(C);}}}},mstrmojo.hash.copy(mstrmojo.ListSelector)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.dom","mstrmojo.ListSelector");var C=mstrmojo.dom,B=C.isIE;mstrmojo.TreeNodeSelector=mstrmojo.provide("mstrmojo.TreeNodeSelector",mstrmojo.mixin({premousedown:function A(E,I,D){var G=(E&&E.tree)||E,H=D&&D.e;if(!H){return false;}var F=G.lastMouseDown;if(F){if((F.e===H)||(B&&((new Date())-F.dt<50))){return false;}}this._super(E,I,D);if(G){if(G.onnodemousedown){G.onnodemousedown(D);}G.lastMouseDown={e:H,dt:new Date()};}return true;}},mstrmojo.hash.copy(mstrmojo.ListSelector)));}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.dnd");var E=mstrmojo.dom;function B(I){return E.contains(this.getMovingHandle(),I.src.node,true,document.body);}mstrmojo._IsMovable=mstrmojo.provide("mstrmojo._IsMovable",{draggable:true,ownAvatar:true,getMovingHandle:function G(){return this.domNode;},getMovingTarget:function H(){return this.domNode;},isDragValid:function A(I){return B.call(this,I)||(this._super&&this._super(I))||false;},ondragstart:function C(J){if(B.call(this,J)){var K=this.getMovingHandle(),I=this.getMovingTarget().style;this._leftPos=parseInt(I.left,10);this._topPos=parseInt(I.top,10);this._hWidth=K.clientWidth;this._hHeight=K.clientHeight;}if(this._super){this._super();}},ondragmove:function F(L){if(B.call(this,L)){var M=L.tgt.pos,J=L.src.pos,K=this.getMovingTarget().style,I=E.windowDim();K.left=this.left=Math.min(Math.max(this._leftPos+M.x-J.x,-this._hWidth+40),I.w-40)+"px";K.top=this.top=Math.min(Math.max(this._topPos+M.y-J.y,-this._hHeight+20),I.h-20)+"px";}if(this._super){this._super();}},ondragend:function D(I){if(B.call(this,I)){delete this._leftPos;delete this._topPos;delete this._hWidth;delete this._hHeight;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Base","mstrmojo.registry","mstrmojo._Provider","mstrmojo.array");var B=mstrmojo.registry,F=mstrmojo.array;mstrmojo.Obj=mstrmojo.declare(mstrmojo.Base,[mstrmojo._Provider],{scriptClass:"mstrmojo.Obj",id:"",init:function I(J){this.disposables=[];this._super(J);B.add(this);if(this.postCreate){this.postCreate();}},addDisposable:function G(M){var K=this.disposables,L,J;if(M.constructor===Array){for(L=0,J=M.length;L<J;L++){K.push(M[L]);}}else{K.push(M);}return M;},destroyDisposables:function D(J){F.forEach(this.disposables,function(K){if(K.destroy){K.destroy(J);}else{if(K.clear){K.clear();}}});this.disposables=[];},throwAbstractMethodError:function A(J){throw new Error(this.scriptClass+" must implement "+J+".");},destroy:function H(J){if(this.destroyed){return ;}this._super(J);this.destroyDisposables(J);B.remove(this);delete this.parent;this.destroyed=true;}});var C=mstrmojo.Obj;C.free=function E(J){if(J instanceof C){J.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.publisher","mstrmojo._Provider");var G=mstrmojo.hash,A=mstrmojo.array,B=mstrmojo.registry,D=mstrmojo.publisher;mstrmojo.Arr=mstrmojo.declare(null,[mstrmojo._Provider],{scriptClass:"mstrmojo.Arr",postApplyProperties:null,postCreate:null,length_bindEvents:["add","remove"],init:function H(K){var J;if(K&&K.data){J=K.data;delete K.data;}else{if(K){J=K;K=null;}}if(!J||J.constructor!==Array){J=[];}G.copy(mstrmojo.Arr.prototype,J);if(K){G.copy(K,J);}if(J.postApplyProperties){J.postApplyProperties();}B.add(J);if(J.postCreate){J.postCreate();}return J;},destroy:function E(){D.clearSubscriptions(this.id);B.remove(this);},add:function I(L,J,K){var M=L&&L.length;if(M){if(J==null){J=this.length;}A.insert(this,J,L);if(!K&&(this.onadd||D.hasSubs(this.id,"add"))){this.raiseEvent({name:"add",value:L,index:J});}}},remove:function F(J,L,K){if(L==null){L=1;}if((J!=null)&&L){var M=this.splice(J,L);if(!K&&(this.onremove||D.hasSubs(this.id,"remove"))){this.raiseEvent({name:"remove",value:M,index:J});}}}});mstrmojo.Arr.makeObservable=function C(J,K){if(!J){return ;}if(!K){K={};}K.data=J;return this.prototype.init(K);};})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.expr","mstrmojo.css");var G=mstrmojo.array,F=mstrmojo.expr,H=mstrmojo.css;mstrmojo._IsExprNode=mstrmojo.provide("mstrmojo._IsExprNode",{ind:function B(){var L=this.parent;if(L&&L.indent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.indent(K);}}},out:function D(){var L=this.parent;if(L&&L.outdent){var K=this.childIndex();K=(K>-1&&(K>0))?[K,K-1]:null;if(K){L.outdent(K);}}},andOrTxt:function A(){var M=this.parent,K=M&&M.data,L="",N=this.data;if(K&&(K.et===F.ET.ANDOR)&&K.fn){L=K.fn+(N&&N.not?"_"+F.FN.NOT:"");L=F.BRANCH_FNS[L];}return'<span class="mstrmojo-text mstrmojo-andor">'+L+"</span>";},getPrefixAndOrToolsMarkup:function(){return('<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()" mstrAttach:mouseover,mouseout>'+mstrmojo.desc(5896,"Ungroup Conditions")+"</span>");},premousedown:function J(K){var L=mstrmojo.dom.eventTarget(K.hWin,K.e);if(this.prefixHoverNode&&mstrmojo.dom.contains(this.prefixHoverNode,L,false)){mstrmojo.dom.stopPropogation(K.hWin,K.e);return ;}if(this._super){this._super(K);}},isSelectableArea:function E(K){return true;},childIndex:function I(){var M=this.parent,K=M&&M.data,L=K&&K.nds,N=this.data;if(L&&N){return G.indexOf(L,N);}return -1;},toggleGroupBorder:function C(K){H.toggleClass(this.parent.itemsContainerNode.childNodes[this.childIndex()-1].firstChild,"upgroup",K);H.toggleClass(this.domNode,"downgroup",K);}});}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.expr","mstrmojo.date","mstrmojo.num","mstrmojo.string");mstrmojo.validation={STATUSCODE:{UNKNOWN:-1,VALID:0,INVALID:1,INVALID_EMPTY:2,INVALID_CHAR:3,INVALID_OUTOFRANGE:4,INVALID_REGEX:5,INVALID_VALIDATOR:6,INVALID_BAD_NUMERICFORMAT:7,INVALID_BAD_DATESTRING:8},TRIGGER:{NONE:0,ONBLUR:1,ONKEYUP:2,VALUESET:4,ALL:7},REGEXP:{US_ZIP:/^\d{5}([\- ]?\d{4})?$/,EMAIL_ADDRESS:/^([a-zA-Z0-9_\.\-])+@(([a-zA-Z0-9\-])+[\.])+([a-zA-Z0-9]{2,4})+$/,SOCIAL_SECURITY_NUMBER:/^((?!000)(?!666)\d{3})(\s|\-)?((?!00)\d{2})\2((?!0000)\d{4})$/,PHONE_NUMBER:/^(?!-)[ \d\-\(\)\.\+]+$/,FILE_NAME:new RegExp('^[^:*?"<>|/\\\\()]+$'),FOLDER_PATH_WIN:new RegExp('^([a-zA-Z]:|\\\\\\\\[^:*?"<>|/\\\\]+|[^:*?"<>|/\\\\]*)(\\\\[^:*?"<>|/\\\\]+)*(\\\\){0,1}$'),FOLDER_PATH_UNIX:new RegExp('^(/){0,1}([^:*?"<>|/\\\\]+/)*([^:*?"<>|/\\\\]+){0,1}$'),PRINTER_PATH_SINGLE:new RegExp('^[^$%:*?"<>|/\\\\]*$'),PRINTER_PATH_MULTIPLE:new RegExp('^((/|\\\\\\\\)[^$%:*?"<>|/\\\\]+)((/|\\\\)[^$%:*?"<>|/\\\\]+)*(/|\\\\){0,1}$')}};var H=mstrmojo.validation,B=H.TRIGGER,b=H.STATUSCODE,A={"-1":-1,1:1,2:1,3:2,4:2,5:2,6:2,7:2,8:3,9:3,10:3,11:4,12:4,13:4,14:6,15:6,16:6,17:3,18:3,21:2,22:2,23:3,24:4,25:3,30:5,34:5};H.VALIDATOR={DEMO:function N(e){var d=parseInt(e,10),f=mstrmojo.validation.STATUSCODE;if(d===0||d===1||d>10){return{code:f.VALID};}return{code:f.INVALID,msg:"This field must be either 0, 1 or greater than 10"};},VALIDATE_PHONENO:function I(d){var e=String(d).replace(/[^\d]/g,"");if(e.length<10){return{code:b.INVALID,msg:mstrmojo.desc(9203,"A telephone number must contain at least 10 digits.")};}if(!H.REGEXP.PHONE_NUMBER.test(d)){return{code:b.INVALID,msg:mstrmojo.desc(9204,"The telephone number contains invalid characters.")};}return{code:b.VALID};},VALIDATE_ZIPCODE:function G(d){var f="",e=this.dtp;if(!H.REGEXP.US_ZIP.test(d)){if(H.isNumeric(e)||H.isInt(e)){f=mstrmojo.desc(9208,"A zip code must be 5 digits or 5+4 digits.");}else{if(H.isString(e)){f=mstrmojo.desc(9206,"The zip code is invalid");}}return{code:b.INVALID,msg:f};}return{code:b.VALID};},VALIDATE_EMAIL:function T(d){var e=d.indexOf("@");if(e===-1){return{code:b.INVALID,msg:mstrmojo.desc(9197,"The email address is missing an at sign (@).")};}if(d.substring(e).indexOf(".")===-1){return{code:b.INVALID,msg:mstrmojo.desc(9198,"The email address is missing a period on the domain.")};}return H.REGEXP.EMAIL_ADDRESS.test(d)?{code:b.VALID}:{code:b.INVALID,msg:mstrmojo.desc(9207,"The email address is invalid.")};},VALIDATE_SSN:function Q(d){var f=this.dtp,e;if(H.isNumeric(f)||H.isInt(f)){e=String(d).replace(/[^\d]/g,"");if(e.length!==9){return{code:b.INVALID,msg:mstrmojo.desc(9209,"A Social Security Number must be 9 digits.")};}}if(!H.REGEXP.SOCIAL_SECURITY_NUMBER.test(d)){return{code:b.INVALID,msg:mstrmojo.desc(9210,"The Social Security Number is invalid.")};}return{code:b.VALID};}};H.isInt=function D(d){return A[d]===1;};H.isNumeric=function Y(d){return A[d]===2||A[d]===5;};H.isString=function J(d){return A[d]===3;};var C=window.mstrConfig,L=C.listSep,S=mstrmojo.expr,M=S.DTP,Z=mstrmojo.num,U=mstrmojo.string,F=mstrmojo.date;function P(l,m){var h=l.dtp,k=l.constraints,o=k.allowedFormatChars||"",g=(A[h]===1),d=(A[h]===2),e=(A[h]===6),n=mstrmojo.locales.number.THOUSANDSEPARATOR,f=mstrmojo.locales.number.DECIMALSEPARATOR,j;if(g){if(!l._intRegExp){o+="0-9-"+(l.isList?L:"")+n;l._intRegExp=new RegExp("[^"+o+"]");}j=l._intRegExp;}if(d){if(!l._numericRegExp){o+="0-9-"+(l.isList?L:"")+f+n;l._numericRegExp=new RegExp("[^"+o+"]");}j=l._numericRegExp;}return !!j&&j.test(m);}function c(l,n){var h=l.dtp,k=l.constraints,g=(A[h]===1),d=(A[h]===2),e=(A[h]===6),f=k.min,m=k.max,j;if(f===undefined&&m===undefined){return false;}if(g||d){return Z.inNumericRange(n,f,m)!==0;}if(e){return F.inDateTimeRange(n,f,m)!==0;}return false;}function K(e,d){return !Z.isNumeric(d);}function R(g,e){var f=(g.dtp===M.DATE),d=(g.dtp===M.TIME);return(f?!F.isDate(e):(d?!F.isTime(e):!F.isDateAndOrTime(e)));}mstrmojo._CanValidate=mstrmojo.provide("mstrmojo._CanValidate",{constraints:null,required:false,dtp:M.INTEGER,isList:false,autoFormat:false,validationStatus:null,init:function W(d){this._super(d);if(!this.constraints){this.constraints={};}var e=this.constraints;if(!e.hasOwnProperty("trigger")){e.trigger=B.NONE;}},_set_value:function(j,f){var g=this.value,e=(g!==f);if(e){this.value=f;var h=this.constraints.trigger,d=(h&B.VALUESET)>0;if(d){this.validate(f);}}return e;},validate:function O(){var f=(this.value!==null&&this.value!==undefined)?this.value:"",j=this.isList?f.split(L):[f],h,e,k,d=j.length,g;for(g=0;g<d;g++){h=this.doValidation(j[g]);e=(h.code>b.VALID);if(e){if(d>1){h.msg=mstrmojo.locales.validation.invalidValueInListError.replace("#",j[g]||" ");}break;}}k=e?"onInvalid":"onValid";if(!e&&this.autoFormat){this.format();}this.set("validationStatus",h);if(this[k]){this[k](h);}},format:function X(){var j=this.dtp,f=(A[j]===6);if(!f){return ;}var l=mstrConfig.listSep,o=this.value||"",e=this.isList?o.split(l):[o],n=j===14,m=[],d,g=mstrmojo.locales.datetime,k=e.length,h;for(h=0;h<k;h++){o=e[h];d=F.parseDateAndOrTime(o);if(d){if(n&&d.date){m.push(F.formatDateInfo(d.date,g.DATEOUTPUTFORMAT));}else{m.push((d.date?F.formatDateInfo(d.date,g.DATEOUTPUTFORMAT):"")+" "+(d.time?F.formatTimeInfo(d.time,g.TIMEOUTPUTFORMAT):""));}}}this.set("value",m.join(l));},isValid:function V(){var d=this.validationStatus;if(!d){this.validate();}return this.validationStatus.code===b.VALID;},clearValidation:function a(){this.set("validationStatus",{code:b.VALID});if(this.onClearValidation){this.onClearValidation();}},doValidation:function E(q){var n=this.constraints,o=n.regExp,f=n.validator,d={id:this.id,code:b.VALID,msg:""},m=this.dtp,l=(A[m]===1),e=(A[m]===2||A[m]===5),g=(A[m]===3),h=(A[m]===6),k=U.isEmpty(q),p=String(q).length,j="",u=mstrmojo.locales.validation;if(this.required&&k){d.code=b.INVALID_EMPTY;d.msg=u.requiredFieldError;return d;}q=U.trim(q);if(!k&&P(this,q)){if(l){j=u.integerDataType;}if(e){j=u.numericDataType;}if(h){j=u.dateDataType;}d.code=b.INVALID_CHAR;d.msg=u.invalidCharError.replace("#",j);return d;}if(!k&&h&&R(this,q)){d.code=b.INVALID_BAD_DATESTRING;d.msg=u.invalidDateStringError;return d;}if(!k&&(e||l)&&K(this,q)){d.code=b.INVALID_BAD_NUMERICFORMAT;d.msg=u.invalidNumericFormatError;return d;}if(!k&&(l||e||h)&&c(this,q)){d.code=b.INVALID_OUTOFRANGE;if(n.min!==null&&n.max!==null){j=u.outofRangeError.replace("# ","").replace("##",n.min).replace("###",n.max);}else{if(n.min!==null){j=u.noLessMinError.replace("##",n.min).replace("# ","");}else{if(n.max!==null){j=u.noGreaterMaxError.replace("###",n.max).replace("# ","");}}}d.msg=j;return d;}if(g&&n.minLen!==null&&n.maxLen!==null){if(p<n.minLen||p>n.maxLen){d.code=b.INVALID;d.msg=mstrmojo.desc(9211).replace(/#/,n.minLen).replace(/##/,n.maxLen);return d;}}if(o&&!o.test(q)){d.code=b.INVALID_REGEX;d.msg=mstrmojo.desc(9205);return d;}var t=f&&f.apply(this,[q]);if(t){d.code=t.code;d.msg=t.msg;return d;}return d;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.registry","mstrmojo.ListBuilder");var H=mstrmojo.hash,E=mstrmojo.registry,G=1;mstrmojo.WidgetListBuilder=mstrmojo.provide("mstrmojo.WidgetListBuilder",mstrmojo.mixin({newContext:function F(J){var K=J.itemFunction;if(!K){var I=J.itemConfig;K=I?function(M,L,N){var O=H.clone(I);O.data=M;O.parent=N;return E.ref(O);}:null;}return{itemStatus:[],itemWidgets:[],itemFunc:K};},build:function A(K,J,N,I){var L=J.itemFunc(N,I,K);if(L){J.itemStatus[I]=G;J.itemWidgets[I]=L;if(L.set){var M=K.selectedIndices;if(M&&M[I]){L.set("selected",true);}}}return L;},onadd:function C(K,I,J){if(I){mstrmojo.array.insert(I.itemWidgets,J.index,new Array(J.value.length));}this._super(K,I,J);},onremove:function D(L,J,K){if(J){var O=J.itemWidgets.splice(K.index,K.value.length),N,I;for(N=0,I=O.length;N<I;N++){var M=O[N];if(M&&M.destroy){delete M.parent;M.destroy();}}}this._super(L,J,K);},onchange:function B(S,J,P,T){if(T){var N=P.itemWidgets,L,O,I,R;for(O=0,I=T.removed,R=I&&I.length;O<R;O++){L=N[I[O]];if(L&&L.set){L.set("selected",false);}}var M,Q,K;for(M=0,Q=T.added,K=Q&&Q.length;M<K;M++){L=N[Q[M]];if(L&&L.set){L.set("selected",true);}}}}},H.copy(mstrmojo.ListBuilder)));}());(function(){mstrmojo.requiresCls("mstrmojo.num","mstrmojo.hash","mstrmojo.string","mstrmojo.array");var A=mstrmojo.num,D=mstrmojo.hash,C=mstrmojo.string,B=mstrmojo.array;mstrmojo.MetricSelectorUtility=mstrmojo.provide("mstrmojo.MetricSelectorUtility",{_GENERIC:1,_RANK:2,_PERCENT:3,OP:{_EQUALS:0,_NOT_EQUALS:1,_GREATER:2,_GREATER_EQUAL:3,_LESS:4,_LESS_EQUAL:5,_BETWEEN:6,_NOT_BETWEEN:7,_IN:8,_NOT_IN:9,_IS_NULL:10,_IS_NOT_NULL:11},OP_NAMES:[{n:mstrmojo.desc(2795,"Equals"),v:0},{n:mstrmojo.desc(2796,"Does not equals"),v:1},{n:mstrmojo.desc(521,"Greater than"),v:2},{n:mstrmojo.desc(522,"Greater than or equal to"),v:3},{n:mstrmojo.desc(523,"Less than"),v:4},{n:mstrmojo.desc(524,"Less than or equal to"),v:5},{n:mstrmojo.desc(696,"Between"),v:6},{n:mstrmojo.desc(746,"Not between"),v:7},{n:mstrmojo.desc(587,"In"),v:8},{n:mstrmojo.desc(2204,"Not In"),v:9},{n:mstrmojo.desc(2202,"Is null"),v:10},{n:mstrmojo.desc(2203,"Is not null"),v:11}],RANK_OP_NAMES:[{n:mstrmojo.desc(529,"Highest"),v:1},{n:mstrmojo.desc(530,"Lowest"),v:2},{n:mstrmojo.desc(4407,"Highest %"),v:3},{n:mstrmojo.desc(4406,"Lowest %"),v:4}],Q:{_G:0,_RT:1,_RB:2,_PT:3,_PB:4},MRPFN:{TOP:1,BOTTOM:2,BETWEEN:3,EXCLUDETOP:4,EXCLUDEBOTTOM:5,NOTBETWEEN:6,EQUALS:7,DIFFERENTFROM:8,EQUALSDESCENDING:15,NOTEQUALSDESCENDING:16,GREATERTHANDESCENDING:4,GREATERTHANEQUALSDESCENDING:18,LESSTHANDESCENDING:20,LESSTHANEQUALSDESCENDING:1,BETWEENDESCENDING:13,NOTBETWEENDESCENDING:14,INDESCENDING:22,NOTINDESCENDING:24,EQUALSASCENDING:7,NOTEQUALSASCENDING:8,GREATERTHANASCENDING:5,GREATERTHANEQUALSASCENDING:17,LESSTHANASCENDING:19,LESSTHANEQUALSASCENDING:2,BETWEENASCENDING:3,NOTBETWEENASCENDING:6,INASCENDING:21,NOTINASCENDING:23},FN:{EQUALS:6,NOTEQUALS:7,GREATERTHAN:8,GREATERTHANEQUALS:10,LESSTHAN:9,LESSTHANEQUALS:11,BETWEEN:17,NOTBETWEEN:44,ISNULL:54,ISNOTNULL:55,IN:22,NOTIN:57,CONTAINS:76,NOTCONTAINS:79,BEGINSWITH:77,NOTBEGINSWITH:80,ENDSWITH:78,NOTENDSWITH:81,LIKE:18,NOTLIKE:43,AND:19,OR:20,NOT:21,RANK:23,RANKPERCENT:59,TUPLE:1000},F:[[6,7,8,10,9,11,17,44,22,57,54,55],[15,16,4,18,20,1,13,14,22,24],[7,8,5,17,19,2,3,6,21,23]],EnumNumberCategory:{Default:-2,Fixed:0,Currency:1,Date:2,Time:3,Percentage:4,Fraction:5,Scientific:6,Custom:7,Special:8,General:9,FromGrid:10},typeHelperCls:{0:"MetricValueSliderHelper",defaultCls:"MetricRankSliderHelper"},ErrorType:{_GENERIC:mstrmojo.desc(11689,"Invalid Number"),_RANK:mstrmojo.desc(11856,"Please enter value between ## and ###.")},getQuaByFunc:function(I,J){var F=this.F,E=this.Q,H=E._G,G=function(K){return B.indexOf(F[1],K)!==-1;};if(G(I)){H=(J===this._RANK)?E._RT:E._PT;}else{H=(J===this._RANK)?E._RB:E._PB;}return H;},getFuncInfo:function(H,I){var G={},F=this.Q,E=this.F;G[F._G]={ft:this._GENERIC,f:E[0][H]};G[F._RT]={ft:this._RANK,f:E[1][H]};G[F._RB]={ft:this._RANK,f:E[2][H]};G[F._PT]={ft:this._PERCENT,f:E[1][H]};G[F._PB]={ft:this._PERCENT,f:E[2][H]};return G[I]||{};},getOpIdxByfunc:function(G,H){if(!G||!H){return -1;}var E=this.F,F=-1;switch(H){case this._GENERIC:F=B.indexOf(E[0],G);break;case this._RANK:case this._PERCENT:F=B.indexOf(E[1],G);if(F===-1){F=B.indexOf(E[2],G);}break;}return F;},getIncludeByOp:function(F){var E=this.OP;return F===E._EQUALS||F===E._GREATER_EQUAL||F===E._LESS_EQUAL||F===E._BETWEEN||F===E._IN;},formatNumber:function(F,H,E){var I,G=this.Q,J=E.fm;if(!A.validateFormat(J)){J="#,##0.00;(#,##0.00)";}if(F===G._G){I=(J)?A.formatByMask(J,H):A.format(E.cat,E.dp,E.curr,H);}else{if(F===G._RB||F===G._RT){I=String(parseInt(H,10));}else{if(F===G._PB||F===G._PT){I=parseFloat(H)+"%";}}}return I;},doValidation:function(N,H,K){var J=H.qua,L=H.low,G=H.high,I=this.Q,O=J===I._RT||J===I._RB,E=J===I._PT||J===I._PB,M="",F;if(C.isEmpty(N)){M="emptyValueVIWarning";}else{if(!(A.isNumeric(N)||(E&&String(N).match(/^\d+(\.\d+)?%$/)))){M="invalidValueVIWarning";}else{if((J===I._PT||J===I._PB)&&A.inNumericRange(parseFloat(N),L,G)){M="outOfRangeVIWarning";F=E?["0","100%"]:[L,G];}else{if(O&&!A.isInt(N)){M="notIntegerVIWarning";}}}}return D.copy(K,{invalid:!!M,errorCode:M,args:F||[]});}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.num","mstrmojo.array","mstrmojo.DICFactory");var F=1,J=0,L=1,N=2,G=".",I=mstrmojo.dom,K=mstrmojo.css,E=mstrmojo.hash,D=mstrmojo.Enum_Keys.TAB,H=function(Q){return(Q>=1&&Q<=7)||Q==21||Q==22||Q==30;},C=function(T,R){if(I.isIE&&!/px$/.test(R)){var Q=document.createElement("img"),S;Q.style.zIndex=-1;Q.style.left=R;T.appendChild(Q);S=Q.style.pixelLeft;T.removeChild(Q);return S+"px";}return R;},B=function(Q,R){return parseInt(C(Q,K.getStyleValue(Q,R)),10)||0;},M=function(Q){return{lp:B(Q,"paddingLeft"),rp:B(Q,"paddingRight"),tp:B(Q,"paddingTop"),bp:B(Q,"paddingBottom")};},P=function(R){var Q=K.getComputedStyle(R)||R.currentStyle;return{fontFamily:Q.fontFamily,fontSize:C(R,Q.fontSize),fontStyle:Q.fontStyle,fontVariant:Q.fontVariant,fontWeight:Q.fontWeight,textAlign:Q.textAlign};},O=function(S,Q){var R=mstrmojo.findAncestor(S,"scriptClass","mstrmojo.DocInfoWindow");if(!!R){R[Q?"registerLock":"releaseLock"](this);}};mstrmojo._IsInputControl={_mixinName:"_IsInputControl",dic:null,owner:null,openerNode:null,popupStyle:J,items:null,applyOnEnter:true,lv:null,init:function(T){if(this._super){this._super(T);}var V=this.dic,U=V.dt,S=mstrmojo.expr.DTP,R,Q=[];if(mstrApp.useBinaryFormat){if(U==S.DATE||U==S.TIME||U==S.TIMESTAMP){R=mstrmojo.date.parseDateAndOrTime(this.value);if(R){if(U!=S.TIME){Q.push(mstrmojo.date.formatDateInfo(R.date,mstrmojo.locales.datetime.DATEOUTPUTFORMAT));}if(U!=S.DATE){Q.push(mstrmojo.date.formatTimeInfo(R.time,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT));}this.value=Q.join(" ");}}}this.lv=this.value;if(V.wm&&V.w===undefined){V.wm=0;}},showByDefault:false,hasPreview:false,getItems:function(){var X=this.dic,R=[],V,T,Q=0,U=String(X.itv),S=U&&U.indexOf(G),W=H(X.dt);if(S>=0){Q=U.substring(S+1).length;}if(parseInt(X.ipt,10)===0){for(V=0,T=X.min;T<X.max+0.00001;V++,T+=X.itv){R[V]={n:mstrmojo.num.toLocaleString(Q>0?T.toFixed(Q):T),v:T};}}else{R=X.vls;mstrmojo.array.forEach(R,function(Y){if(Y.n===undefined){Y.n=W?mstrmojo.num.toLocaleString(Y.v):Y.v;}});}return R;},font:null,onfontChange:function(){if(this.getInputNode){var Q=this.getInputNode(),R=this.font;E.forEach(R,function(T,S){Q.style[S]=T;});}},getOpenerNodeStyle:function(){var Q=this.group&&this.group.ons,R=this.openerNode;if(!Q){Q=M(R);Q.hp=Q.lp+Q.rp;Q.vp=Q.tp+Q.bp;Q.iw=Math.max(0,R.clientWidth-Q.hp);Q.ih=Math.max(0,R.clientHeight-Q.vp);if(this.group){this.group.ons=Q;}}return Q;},onvalueChange:function(){if(this._super){this._super();}this.dicChanged=true;if(this.showByDefault&&(!this.isDicWidgetReady||this.isDicWidgetReady())){this.applyChanges();}else{if(this.popupStyle!==J&&this.popup&&this.popup.enableApply){this.popup.enableApply();}}},preBuildRendering:function(){if(this._super){this._super();}this.openerNode=this.openerNode||this.owner.domNode;if(this.showByDefault){this.openerStyle=this.getOpenerNodeStyle();if(this.inlineExtraCssText){this.cssText+=" "+this.inlineExtraCssText;}}if(!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}},postBuildRendering:function(){var T=this.openerNode;if(this._super){this._super();}if(!mstrmojo.isDescendant(this.owner,this)){if(this.showByDefault){var S=this.domNode;if(!(this.handleDisable()||this.enabled)){var Q=document.createElement("div"),R=document.createElement("div");Q.className="DIC-Container";R.className="curtain";Q.appendChild(S);Q.appendChild(R);S=Q;}T.innerHTML="";T.appendChild(S);}this.set("font",P(T));}if(mstrmojo.DICConfig.isKeyNavigable(this.dic)){this.registerKeyEvents(this.domNode);}},applyChanges:function(){var W=this.lv,Q=this.getCurValue?this.getCurValue():this.value,V=this.openerNode,S=this.getDisplayValue?this.getDisplayValue():Q,U=this.dic.dt,R=mstrmojo.expr.DTP,T=mstrmojo.locales.datetime;if(String(Q)!==String(W)){if(mstrApp.useBinaryFormat){if(U==R.TIME||U==R.TIMESTAMP){Q=Q.replace(new RegExp(T.AM_NAME),"AM").replace(new RegExp(T.PM_NAME),"PM");}}this.lv=Q;this.dv=S;if(this.owner&&this.owner.dataChanged){this.owner.dataChanged(this.k,W,{dv:S,v:Q},V,this.dic.k);}}return true;},cancelChanges:function A(){this.value=this.lv;},showInPopup:function(){this.popup=mstrmojo.DICFactory.createDICPopup(this.owner,this);if(this.focus&&!mstrApp.useBinaryFormat){this.focus();}this.setInfoWindowLock(true);},lockPopup:function(){this.setInfoWindowLock(false);},renderPreview:null,onTabDown:function(Q){mstrmojo.dom.preventDefault(window,Q);if(this.applyChanges()!==false){if(this.popup){this.popup.close();}this.owner.editNext(this.k);this.cleanup();}},cleanup:mstrmojo.emptyFn,registerKeyEvents:function(R){var Q=this;I.attachEvent(R,"keydown",function(S){var T=S||window.event;if(T.keyCode===D){Q.onTabDown(S);}});if(I.isIE){I.attachEvent(R,"keyup",function(S){var T=S||window.event;if(T.keyCode===D){Q.focus();}});}},setInfoWindowLock:function(Q){O.call(this,this.owner,Q);},handleDisable:function(){return true;}};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.color","mstrmojo.hash","mstrmojo.array");var AC=mstrmojo.color,V=mstrmojo.hash,BF=mstrmojo.array,BB=mstrmojo.css,d=mstrmojo.num;var BD=1,Al=2,Am=3,Az=4,AT=5,AU=6;var BK="FormattingFont",I="FormattingAppearance",X="FormattingAlignment",Aa="FormattingSize",Q="FormattingPatterns",F="FormattingBorder",Ay="FormattingOrder",E="FormattingView",O="FormattingSelector",Ao="Template Formatting",L="FormattingPadding",Aj="AnalyticalEngineProperties",Ar="RWDocumentProperties",A8="FormattingPage",N="Mobile",T="VLDB Select";var Ai=1;var g="n",M="h",BG="w",AA="wm",A5="pw",W="ml",A6="mr",r="upwalw",o="ff",Ad="fsz",A9="fw",AB="fit",BA="fun",l="fst",q="fc",U="alh",p="alv",AX="atw",AH="atd",a="textOverflow",Ah="bc",D="bgs",H="btc",Ag="brc",AQ="bbc",n="blc",j="bts",BI="brs",A0="bbs",AW="bls",AN="borderColor",Av="borderStyle",c="zIndex",AO="showTitleBar",h="title",Au="ctrlStyle",u="ctrlOrientation",At="ctrlOrientationBehavior",f="ctrlMultiselect",C="ciwm",A7="cmcy",Aw="sec",m="easow",AG="layoutXml",J="lockAspectRatio",Af="ism",e="shw",Ax="mg",BH="lhv",Y="gridVPadding",Ac="gridHPadding",Ab="ln",AF="sar",B="hnv",AZ="iw",AV="ih",AJ="tsp",AR="visible",R="rf",BJ="jad",Ak="jdc",A1="fs",A4="ssc",b="sstyle",z="hgl";function P(BL){return BL;}function AL(BL){return parseInt(BL,10);}var x={name:"encode",_def:P};x[Am]=function(BL){return BL?1:0;};x[Al]=function(BL){if(BL==="transparent"){return -1;}if(BL.length===4){BL=BL.replace(/([0-9a-f])/ig,"$1$1");}BL=AC.rgbStr2hex(BL);return parseInt(BL.substring(5)+BL.substring(3,5)+BL.substring(1,3),16);};x[Az]=AL;x[BD]=function(BL){if(typeof BL==="number"){return d.toLocaleString(BL);}return P(BL);};x[AU]=function(BN){if(BN==="none"){return 0;}var BM=BN.match(/([0-9]+[,\.]?[0-9]*pt)/)[0],BL=BN.match(/pt ([\w\W]*)/)[1];if(BM==="2pt"){return 5;}switch(BL){case"solid":return 1;case"dashed":return 3;case"dotted":return 4;default:throw new Error("Invalid border style value in FormatModel::encodeValue.");}};var BE={name:"decode",_def:P};BE[Am]=function(BL){return parseInt(BL,10)===1;};BE[Al]=function(BL){if(BL===-1){return"transparent";}if(typeof BL==="number"){return AC.decodeColor(BL);}if(BL.length===4){return BL.replace(/([0-9a-f])/ig,"$1$1");}return AC.rgbStr2hex(BL);};BE[Az]=AL;BE[AU]=function(BN){if(BN===undefined||BN===0){return"none";}var BM="1pt",BL="solid";if(BN===5){BM="2pt";}if(BN===3){BL="dashed";}else{if(BN===4){BL="dotted";}}return BM+" "+BL;};function A2(){return this.pn.toLowerCase();}function AI(BL,BN,BO){var BM=document.createElement("div");BM.style[BO||BN]=BL[BN];return BM;}function G(BL){return function(){return AC.rgbStr2hex(BL.apply(this,arguments));};}function Ae(){var BL=A2.call(this);return BL==="underline"?BL:"line-through";}var Aq={name:"extract"},S=Aq._def=function(BL,BN,BO){var BM=AI(BL,BN||this.getFormatBlockName(),BO);return BM.style[this.getCssName()];};Aq[Al]=G(S);function t(BL){return S.call(this,BL,this.getFormatBlockName())===A2.call(this);}function A(BL){var BM=S.call(this,BL,this.getFormatBlockName(),this.getCssName());return BM.indexOf(Ae.call(this))>-1;}function Ap(BL){var BM=this.getFormatBlockName();return AC.rgbStr2hex(S.call(this,BL,BM,BM+this.pn));}var BC={name:"resolve"},Z=BC._def=function(BL,BO,BN,BP){BN=BN||this.getFormatBlockName();var BM=AI(BL,BN);BM.style[BP||this.getCssName()]=BO;return BM.style[BB.convertCssToCamelCase(BN)];};BC[Al]=function(BL,BN,BM,BO){if(BN.or!==undefined){return BN;}return AC.rgbStr2hex(Z.call(this,BL,BN,BM,BO));};function AP(BL,BM){return Z.call(this,BL,BM?A2.call(this):"normal");}function AM(BM,BO){var BN=(BM[this.getFormatBlockName()]||"").split(" "),BL=Ae.call(this);if(BO){if(BN.indexOf(BL)===-1){BN.push(BL);}}else{BN=BN.filter(function(BP){return BP!==BL;});}return Z.call(this,BM,BN.join(" "));}var AY={name:"update"},A3=AY._def=function(BL,BM){BL[this.getFormatBlockName()]=this.resolve(BL,BM);return BL;};var AK={};AK[g]={ps:I,pn:"Name",pt:BD};AK[M]={ps:Aa,pn:"Height",pt:BD};AK[BG]={ps:Aa,pn:"Width",pt:BD};AK[AA]={ps:Aa,pn:"WidthMode",pt:Az};AK[A5]={ps:A8,pn:"PageWidth",pt:BD};AK[W]={ps:A8,pn:"MarginLeft",pt:BD,fn:"margin-left"};AK[A6]={ps:A8,pn:"MarginRight",pt:BD,fn:"margin-right"};AK[r]={ps:A8,pn:"UsePageWidthAsLayoutWidth",pt:Am};AK[o]={ps:BK,pn:"Name",pt:BD,fn:"font",cn:"fontFamily",extract:function(){return S.apply(this,arguments).replace(/['"]/g,"");}};AK[Ad]={ps:BK,pn:"Size",pt:Az,fn:"font",cn:"fontSize"};AK[A9]={ps:BK,pn:"Bold",pt:Am,fn:"font",cn:"fontWeight",extract:t,resolve:AP};AK[AB]={ps:BK,pn:"Italic",pt:Am,fn:"font",cn:"fontStyle",extract:t,resolve:AP};AK[BA]={ps:BK,pn:"Underline",pt:Am,fn:"text-decoration",extract:A,resolve:AM};AK[l]={ps:BK,pn:"Strikeout",pt:Am,fn:"text-decoration",extract:A,resolve:AM};AK[q]={ps:BK,pn:"Color",pt:Al};AK[U]={ps:X,pn:"Horizontal",pt:Az,fn:"text-align"};AK[AX]={ps:X,pn:"TextWrap",pt:Am,fn:"white-space"};AK[AH]={ps:X,pn:"TextDirection",pt:Az};AK[p]={ps:X,pn:"Vertical",pt:Az};AK[a]={ps:Aa,pn:"TextOverflow",pt:Am};AK[Ah]={ps:Q,pn:"FillColor",pt:Al,x:Ai,fn:"background-color",update:function(BL,BN){var BM=BL.fx;if(BN.or!==undefined){if(!BM){BM=BL.fx={};}var BO=BM.gd=BM.gd||{};BO.ec=BN.c2;BO.sc=BN.c1;BO.t=BN.or;delete BL[this.getFormatBlockName()];BL.fx=BM;}else{if(BM){delete BM.gd;}A3.call(this,BL,BN);}return BL;}};AK[D]={ps:Q,pn:"FillStyle",pt:Az};AK[A4]={ps:Q,pn:"SelectorSelectionColor",pt:Al};AK[b]={ps:Q,pn:"SelectorSelectionFillStyle",pt:Az};AK[H]={ps:F,pn:"TopColor",pt:Al,fn:"border",extract:Ap};AK[Ag]={ps:F,pn:"RightColor",pt:Al,fn:"border",extract:Ap};AK[AQ]={ps:F,pn:"BottomColor",pt:Al,fn:"border",extract:Ap};AK[n]={ps:F,pn:"LeftColor",pt:Al,fn:"border",extract:Ap};AK[AN]={ps:F,pn:["TopColor","RightColor","BottomColor","LeftColor"],pt:Al,fn:"border",extract:Ap,resolve:G(function(BL,BN){var BO=this.getFormatBlockName(),BM=Z.call(this,BL,BN,BO,BO+"Color"),BP=BM.indexOf("rgb");if(BP>-1){BM=BM.slice(0,BP)+AC.rgbStr2hex(BM.slice(BP));}return BM;})};AK[Av]={ps:F,pn:["TopStyle","RightStyle","BottomStyle","LeftStyle"],pt:AU,fn:"border",extract:Ap,resolve:function(BL,BO){var BM=BO.split(" "),BP=this.getFormatBlockName();BL[BP]=Z.call(this,BL,BM[0],BP,BP+"Width");var BN=Z.call(this,BL,BM[1]||"none",BP,BP+"Style"),BQ=BN.indexOf("rgb");if(BQ>-1){BN=BN.slice(0,BQ)+AC.rgbStr2hex(BN.slice(BQ));}if(BN.indexOf("#")===-1&&BN.indexOf("transparent")===-1){BN+=" transparent";}return BN;}};AK[j]={ps:F,pn:"TopStyle",pt:AU,fn:"border",extract:Ap};AK[BI]={ps:F,pn:"RightStyle",pt:AU,fn:"border"};AK[A0]={ps:F,pn:"BottomStyle",pt:AU,fn:"border",extract:Ap};AK[AW]={ps:F,pn:"LeftStyle",pt:AU,fn:"border",extract:Ap};AK[c]={ps:Ay,pn:"ZIndex",pt:Az,fn:"z-index"};AK[AO]={ps:E,pn:"ShowTitleBar",pt:Am};AK[h]={ps:E,pn:"Title",pt:BD};AK[Au]={ps:O,pn:"Style",pt:Az};AK[u]={ps:O,pn:"Orientation",pt:Az};AK[At]={ps:O,pn:"OrientationBehavior",pt:Az};AK[f]={ps:O,pn:"Multiselect",pt:Am};AK[C]={ps:O,pn:"ItemWidthMode",pt:Az};AK[A7]={ps:O,pn:"MetricConditionType",pt:Az};AK[Aw]={ps:O,pn:"ShowElementCount",pt:Az};AK[m]={ps:O,pn:"ExportAsShownOnWeb",pt:Az};AK[AG]={ps:Aa,pn:"LayoutXML",pt:AT};AK[J]={ps:Aa,pn:"LockAspectRatio",pt:Am};AK[Af]={ps:Aa,pn:"ImageSizeMode",pt:Az};AK[AV]={ps:Aa,pn:"ImageHeight",pt:BD};AK[AZ]={ps:Aa,pn:"ImageWidth",pt:BD};AK[AJ]={ps:Ar,pn:"layoutBarPosition",pt:Am};AK[A1]={ps:Ar,pn:"ExecutionFullScreenMode",pt:Am};AK[AR]={ps:I,pn:"Visible",pt:Am};AK[Ab]={ps:Ao,pn:"LongNames",pt:BD};AK[AF]={ps:Aj,pn:"ShowAllRows",pt:BD};AK[B]={ps:Aj,pn:"HideNullZeroValues",pt:BD};AK[Ac]={ps:L,pn:["LeftPadding","RightPadding"],pt:BD};AK[Y]={ps:L,pn:["TopPadding","BottomPadding"],pt:BD};AK.rowsshw={ps:Ao,pn:"ShowRowHeaders",pt:BD};AK.rowsmg={ps:Ao,pn:"MergeCells",pt:BD};AK.rowslhv={ps:Ao,pn:"LockRowHeaders",pt:BD};AK.colsshw={ps:Ao,pn:"ShowColumnHeaders",pt:BD};AK.colsmg={ps:Ao,pn:"MergeColumnCells",pt:BD};AK.colslhv={ps:Ao,pn:"LockColumnHeaders",pt:BD};AK[R]={ps:N,pn:"RefreshFrequency",pt:Az};AK[BJ]={ps:T,pn:"Join Across Datasets",pt:Az};AK[Ak]={ps:T,pn:"MCE Join To Get Data Combination",pt:Az};AK[z]={ps:I,pn:"Highlight",pt:Az};BF.forEach(V.keyarray(AK),function(BL){var BM=AK[BL];BM.getFormatBlockName=function(){var BO=this.fn;if(!BO){var BN=this.pn;BO=BN.charAt(0).toLowerCase()+BN.substr(1);}return BO;};BM.getCssName=function(){var BN=this.getFormatBlockName.call(this),BO=this.cn;if(!BO){BO=BB.convertCssToCamelCase(BN);}return BO;};BF.forEach([x,BE,Aq,BC,AY],function(BN){var BO=BN.name;BM[BO]=BM[BO]||BN[BM.pt]||BN._def;});});function As(BO,BN,BL){var BM=BL[BO.ps]=BL[BO.ps]||{};BN=BO.encode(BN);BF.forEach([].concat(BO.pn),function(BP){BM[BP]=BN;});return BL;}function AE(BR,BQ,BL){var BP=BR.x;if(BP){if((BP&Ai)>0){var BO=!!BQ.c1,BN=0;if(BO){As(BR,BQ.c1,BL);var BM=BL[Q];BM.GradientColor=BR.encode(BQ.c2);BM.GradientAngle=BQ.or?0:90;BM.GradientXOffset=0;BM.GradientYOffset=0;BN=2;}else{if(BR.encode(BQ)===-1){BN=1;}else{As(BR,BQ,BL);}}return As(AK[D],BN,BL);}}return null;}mstrmojo.models.FormatModel={getFormatUpdate:function AS(BM,BP,BL){var BO=AK[BM];if(!BO){throw new Error("Invalid property "+BM+" in FormatModel::getFormatUpdate.");}BL=BL||{};var BN=AE.call(this,BO,BP,BL);if(BN){return BN;}return As(BO,BP,BL);},getFormatPropertyInfo:function k(BL){return AK[BL];},getValueFromUpdate:function K(BM,BN){var BP=AK[BM],BL=null;try{BL=BN[BP.ps][BP.pn];}catch(BO){}return BL;},getGradientValues:function AD(BM){var BL=BM.fx&&BM.fx.gd;if(BL){var BO={c1:BL.sc,c2:BL.ec,or:BL.t};return BO;}if(BM[D]===2){var BN={c1:BM.bc,c2:BM.gdc,or:BM.gda===90?0:1};return BN;}return null;},decodeValue:function w(BL,BM){return AK[BL].decode(BM);},updateFormatBlock:function An(BL,BM,BN){return AK[BM].update(BL,BN);},getFormatBlockValue:function v(BL,BM){return AK[BM].extract(BL);},GradientType:null,FormatObjectType:null,PROPERTY_INFO_TYPE:null,ENUM_PROPERTY_NAMES:{NAME:g,HEIGHT:M,WIDTH:BG,WIDTH_MODE:AA,PAGE_WIDTH:A5,MARGIN_LEFT:W,MARGIN_RIGHT:A6,USE_PAGE_WIDTH_AS_LAYOUT_WIDTH:r,FONT_FAMILY:o,FONT_SIZE:Ad,FONT_WEIGHT:A9,FONT_STYLE:AB,UNDERLINE:BA,LINE_THROUGH:l,COLOR:q,TEXT_ALIGN:U,VERTICAL_ALIGN:p,TEXT_WRAP:AX,TEXT_DIRECTION:AH,TEXT_OVERFLOW:a,BACKGROUND_COLOR:Ah,FILL_STYLE:D,BORDER_TOP_COLOR:H,BORDER_RIGHT_COLOR:Ag,BORDER_BOTTOM_COLOR:AQ,BORDER_LEFT_COLOR:n,BORDER_TOP_STYLE:j,BORDER_RIGHT_STYLE:BI,BORDER_BOTTOM_STYLE:A0,BORDER_LEFT_STYLE:AW,BORDER_COLOR:AN,BORDER_STYLE:Av,Z_INDEX:c,SHOW_TITLE_BAR:AO,TITLE:h,CONTROL_STYLE:Au,CONTROL_ORIENTATION:u,CONTROL_ORIENTATION_BEHAVIOR:At,CONTROL_MULTISELECT:f,CONTROL_ITEM_WIDTH_MODE:C,CONTROL_METRIC_CONDITION_TYPE:A7,CONTROL_SHOW_ELEMENT_COUNT:Aw,CONTROL_EXPORT_AS_SHOWN_ON_WEB:m,LAYOUT_XML:AG,LOCK_ASPECT_RATIO:J,IMAGE_SIZE_MODE:Af,SHOW_HEADER:e,MERGE_HEADER:Ax,LOCK_HEADER:BH,LONG_NAME:Ab,SHOW_ALL_ROWS:AF,HIDE_NULL:B,IMAGE_WIDTH:AZ,IMAGE_HEIGHT:AV,VISIBLE:AR,LAYOUT_TAB_POSITION:AJ,GRID_VERTICAL_PADDING:Y,GRID_HORIZONTAL_PADDING:Ac,REFRESH:R,JOIN_ACROSS_DATASET:BJ,MCE_JOIN_TO_GET_DATA_COMBINATION:Ak,FULL_SCREEN_MODE:A1,SELECTOR_SELECTION_COLOR:A4,SELECTOR_SELECTION_FILL_STYLE:b,VIZ_HIGHLIGHTING:z}};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom");var D=mstrmojo.dom,H=D.position,I=Math;function F(U,P,N){var O=this._ellTestNodes||{},K=O[U],M=mstrmojo.css.getComputedStyle(P),J=["width","height"];if(N){J.reverse();}var S=J[0],Q=J[1];if(!K||!D.contains(this.domNode,K.n,true,document.body)){var L=P.cloneNode(true);L.removeAttribute("id");L.removeAttribute("onclick");var T=L.style;T.position="absolute";T.top="-10000px";T.maxHeight=T.maxWidth="none";T[S]="auto";P.parentNode.appendChild(L);var R=parseInt(M["max-"+S],10);if(isNaN(R)){R=parseInt(M[S],10);}K=O[U]={n:L,m:R,d:S.substr(0,1)};if(K.m>0){this._ellTestNodes=O;}}else{K.n.innerHTML=P.innerHTML;}K.n.style[Q]=M[Q];return K;}function B(K,L){var M=this.ellipsisText;switch(this.ellipsisPosition){case"middle":var J=I.floor(L/2);return K.slice(0,J).join("")+M+K.slice(-J).join("");case"end":return K.slice(0,L).join("")+M;default:return K.join("");}}var G=4;mstrmojo._SupportsEllipsisText=mstrmojo.provide("mstrmojo._SupportsEllipsisText",{_mixinName:"mstrmojo._SupportsEllipsisText",ellipsisText:"\u2026",ellipsisPosition:"end",ellipsize:function A(U,P,O){var V=P.innerHTML;if(!V){return false;}var K=F.call(this,U,P,O),M=function(){var W=H(K.n)[K.d];return(W<=K.m);};if(M()){return false;}var L=K.n,J=V.split(""),R=0,N=J.length,Q,S;while(R<N){var T=I.floor((R+N)/2);V=L.innerHTML=B.call(this,J,T);if(M()){R=T+1;}else{N=T-1;}if(N-R<G){for(S=R-1;S<N+1;S++){V=L.innerHTML=B.call(this,J,S);if(!M()){break;}Q=V;}}if(Q){P.innerHTML=Q;break;}}return true;},ellipsizeElements:function C(T,O,N){var L=F.apply(this,arguments),M=function(){var U=H(L.n)[L.d];return(U<=L.m);};if(M()){return false;}var Q=this.ellipsisText;var P=this;var K=document.createElement("span");K.innerHTML=Q;var J=function(Y,X){var U=Y.slice(0,X).concat([K]);var W=document.createElement("div");for(var V=0;V<U.length;V++){W.appendChild(U[V]);}return W.innerHTML;};var S=function(V,Z,Y,U){var b=0,W=Z.length,a,e,c;var X=function(f){while(f.hasChildNodes()){f.removeChild(f.lastChild);}};while(b<W){var d=I.floor((b+W)/2);if(U){e=Y.call(P,Z,d);V.nodeValue=e;}else{X(V);e=Y.call(P,Z,d);V.innerHTML=e;}if(M()){b=d+1;}else{W=d-1;}if(W-b<G){c=b==0?0:b-1;for(;c<W+1;c++){if(U){e=Y.call(P,Z,c);V.nodeValue=e;}else{X(V);e=Y.call(P,Z,c+1);V.innerHTML=e;}if(!M()){if(!U){V.removeChild(V.lastChild);a=e=V.innerHTML;}break;}if(!U){V.removeChild(V.lastChild);e=V.innerHTML;}a=e;}}if(a){if(U){V.nodeValue=a;}else{V.innerHTML=a;}break;}}};var R=function(X){if(X.nodeType==3){var Y=X.nodeValue;if(!Y){return false;}S(X,Y.split(""),B,true);return true;}else{var V=X.childNodes;if(!V||V.length===0){return false;}var W=[];for(var U=0;U<V.length;U++){W[U]=V[U];}if(W.length!=1||W[0].nodeType!=3){S(X,W,J,false);}return R(X.lastChild);}};O.style.visibility="visible";L.n.style.visibility="hidden";R(L.n);O.style.visibility="hidden";L.n.style.visibility="visible";return true;},unrender:function E(J){delete this._ellTestNodes;this._super(J);}});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array");var G=mstrmojo.dom,J=mstrmojo.css,H="selected";function B(S,T,U,R,W){var V=W.listHooks[S];if(V&&V.call(W,T,U,R)){return ;}J.toggleClass(T,H,S==="select");}function I(U,T,S){var V=this[U],R=V?V.split(T):[];this[U]=mstrmojo.array.distinct(R.concat(S.split(T))).join(T);}mstrmojo._IsList=mstrmojo.provide("mstrmojo._IsList",{_mixinName:"mstrmojo._IsList",listHooks:{},useListModKeys:false,init:function Q(R){this._super(R);this._shiftStartIndex=-1;},getItemMarkup:function O(S,R){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@en@n}</{@tag}>';},getItemDisplayName:function E(R){return R.n||"";},getItemProps:function K(V,R){var S=!!this.selectedIndices[R],W={tag:"div",sel:S,cls:"",n:this.getItemDisplayName(V),style:"",idx:R,addCls:function T(Y){I.call(this,"cls"," ",Y);},addStyle:function U(Y){I.call(this,"style",";",Y);},title:V.title||""};if(S){W.addCls(H);}var X=V.cls;if(X){W.addCls(X);}return W;},itemRenderer:{render:function A(S,R,T){S._renderIdx=R;return mstrmojo.string.apply(T.getItemMarkup(S,R),T.getItemProps(S,R));},select:function L(S,T,R,U){B("select",S,T,R,U);},unselect:function D(S,T,R,U){B("unselect",S,T,R,U);}},onclick:function P(R){try{var T=this.getItemFromTarget(R.getTarget());if(T){R.cancel();this.doItemSelect(T,R||{});}}catch(S){mstrApp.onerror(S);}},doItemSelect:function F(j,b){var R=b.hWin,h=b.e,c=j._renderIdx,W=j._positionIdx,S=G.isMetaKey(R,h),Z=G.shiftKey(R,h),Y=this.multiSelect,U=this.useListModKeys,d=this._shiftStartIndex,X=this.selectedIndices;if(Y&&U&&Z&&d>-1){var g=[],T=[],V=Math.min(d,c),k=Math.max(d,c),f;for(f=0;f<this.items.length;f++){if(V<=f&&f<=k){if(!X[f]){g.push(f);}}else{if(X[f]){T.push(f);}}}this.addSelect(g);this.removeSelect(T);}else{if(Y&&(!U||S)){var a=(X[c])?"remove":"add";this[a+"Select"](c,false,W);}else{this.singleSelect(c,false,W);}this._shiftStartIndex=c;}},onclearSelection:function N(){this._shiftStartIndex=-1;},getItemNodeFromTarget:function C(S){var R=G.findAncestorByAttr(S,"idx",true,this.domNode);return(R&&R.node)||null;},getItemFromTarget:function M(T){var S=this.getItemNodeFromTarget(T),R=S&&parseInt(S.getAttribute("idx"),10);if(R!==null&&!isNaN(R)&&this.items){return this.items[R];}return undefined;}});mstrmojo._IsList.SELECTED_CLS=H;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.string","mstrmojo.DICFactory");var N=3,A=8,U=2,W=2,S=mstrmojo.css,B="********",Q=mstrmojo.hash;var K=null;function H(a,Z){if(a){var X=this.dicWidget;if(X&&X.setDirtyFlag){X.setDirtyFlag(a,Z);}else{if(a.className!=="flag-container"){var Y=document.createElement("div");Y.className="flag-container";Y.style.right="10px";Y.innerHTML='<div class="dirty-cell"/>';Z.insertBefore(Y,a);}}}}function R(Y,X){if(Y.className==="flag-container"){X.removeChild(Y);}}function E(a,Y,Z,X){return'<rwf rw_tree_type="'+this.tt+'" rw_node_key="'+this.fgk+'" rw_field_key="'+this.k+'" key="'+this.key+'" columns="'+this.cls+'" types="'+Z+'" '+Y+X+' dt="'+a.dt+'" />';}mstrmojo._IsEditableTextfield={_mixinName:"mstrmojo._IsEditableTextfield",preBuildRendering:function T(){if(!this.edb){var Z=this.node.data,X=this.node.defn,Y=Z.dic||X.txi.dic,a=(this.rv==="")?this.value:this.rv;if(Y.psw){this.v=B;a=this.rv="";}if(Y.ipt===W){Y.vls=this.vls||[];this.dk=Y.k;this.ddic=true;}this.dt=Y.dt;this.dicWidget=mstrmojo.DICFactory.createDIC({dic:Q.copy(Y,{req:this.req}),enabled:!!this.enabled,owner:this,k:0,dv:this.value,value:a,openerType:U,popupTitle:X.n});if(this.shouldReplaceValueNode()){if(!K){K=Q.clone(this.formatHandlers);}this.formatHandlers.domNode=["T","z-index","D","B","F","P","text-align","background-color","fx","white-space","overflow"];delete this.formatHandlers.valueNode;}}this.set("cssClass",this.edb?"":"editable-field");this._super();},shouldReplaceValueNode:function P(){return this.dicWidget.showByDefault||this.dicWidget.hasPreview;},postBuildRendering:function L(){this._super();if(this.edb){return ;}var X=this.dicWidget,Z=this.valueNode.innerHTML;if(mstrmojo.string.isEmpty(Z)){this.valueNode.innerHTML=Z+"1";this.valueNode.style.height=this.valueNode.clientHeight+"px";this.valueNode.innerHTML=Z;}if(X.showByDefault){X.render();}else{if(this.enabled){if(X.hasPreview){X.openerNode=this.domNode;X.renderPreview(this.value);}else{X.openerNode=this.valueNode;}mstrmojo.dom.attachEvent(X.openerNode,mstrApp.isMobile?mstrmojo.dom.TOUCHEND:"click",function(){X.showInPopup();});}else{S.addClass(this.domNode,"disabled");return ;}}if(this.shouldReplaceValueNode()){Q.copy(K,this.formatHandlers);}this.registerTxWidget();this.addToTraversalList();if(this.mdf&&this.sci){var Y=this.domNode;H.call(this,Y.firstChild,Y);}},getKeyContext:function F(){return{dt:this.dt||0,k:this.dk||undefined};},getUpdates:function D(){var c=this.getUpdatedValues()[0],X=mstrmojo.array.find(this.vls,"v",c.v),Y=this.dicWidget,b=this.ddic&&(X===-1),Z,a="";if(Y.canSlice||b){a=E.call(this,c,"",A,"");}if(!b){Z=c.k?('rw_control_key="'+c.k+'" element_id="'+this.vls[X].eid+'" '):"";a+=E.call(this,c,Z,N,'value="'+mstrmojo.string.encodeXMLAttribute(String(c.v))+'"');}return a;},updateValue:function M(e,Y){if(this._super){this._super(e,Y);}var g=this.valueNode,b=this.domNode,c=this.dicWidget,f=Y.v,X=Y.dv,a=mstrmojo.array.find(this.vls,"v",f),Z=this.ddic&&(a===-1);if(this.rv!==f){if(this.req){S.removeClass(b,"required");}this.rv=f;this.v=X;this.mdf=Z?0:1;if(!c.showByDefault){if(c.hasPreview){c.renderPreview();}else{g[g.innerText!==undefined?"innerText":"textContent"]=this.psw?B:(!X?"\u00a0":mstrmojo.string.decodeHtmlString(X,false));}}if(this.req){S.removeClass(b,"required");}if(this.sci&&!Z){H.call(this,b.firstChild,b);}else{R.call(this,b.firstChild,b);}}if(this.txar){return true;}return false;},applyPasswordMask:function O(){this.psw=true;this.v=B;this.rv="";},getUpdateObject:function I(){var Z={fieldKey:this.k,wid:this.wid,newValue:mstrmojo.string.encodeXMLAttribute(String(this.rv)),dataType:this.dt},X=-1,Y=this.getUpdatedValues()[0];if(Y.k!==undefined){Z.controlKey=Y.k;X=mstrmojo.array.find(this.vls,"v",Y.v);Z.elementId=X>=0?this.vls[X].eid:"";}return{nodeKey:this.fgk,cells:[Z],retrieveData:false,autoRefresh:false};},autoRefresh:function(X){this.model.sendTransactionUpdates(X);},update:function J(X){if(this._super){this._super(X);}var Z=X.data,Y=X.defn;if(Z.vls){this.vls=Z.vls;}else{delete this.vls;}this.cell=X.data;this.value=Z.v||"";this.rv=(Z.rv===undefined)?this.value:Z.rv;this.tca=Z.tca||0;this.dt=Z.dt;this.key=Z.key||"";this.cls=Z.cls||"";this.wid=Z.wid;this.edb=Z.edb;this.mdf=Z.mdf;this.sci=Y.txi.sci;this.req=this.required||Y.txi.dic.req;this.tt=Y.tt;this.fgk=Y.fgk;this.txar=Y.txi.txar;this.txck=Y.txi.dic.ckey;},addToTraversalList:function V(){if(mstrmojo.DICConfig.isKeyNavigable(this.dicWidget.dic)){var X=this.parent.traversalList,Y=this.domNode;if(!X){X=this.parent.traversalList=[];}X.push({x:Y.offsetLeft,y:Y.offsetTop,h:Y.offsetHeight,refField:this});}},editNext:function G(){var c=this.parent.traversalList,a,X,Z,b=0;if(!c){return false;}if(!c.isSorted){for(a=0,X=c.length;a<X;a++){b+=c[a].h;}Z=b/X;c.sort(function(f,d){var g=Math.floor(f.y/Z),e=Math.floor(d.y/Z);if(g<e){return -1;}if(g>e){return 1;}if(f.x<d.x){return -1;}if(f.x>d.x){return 1;}return(f.y<d.y)?-1:1;});c.isSorted=true;}for(a=0,X=c.length;a<X;a++){if(c[a].refField.k===this.k){break;}}if(a<X){do{a++;if(a>=X){a%=X;}if(a===parseInt(this.k,10)){return false;}var Y=c[a].refField.dicWidget;if(Y){if(!Y.showByDefault){Y.showInPopup();}else{Y.focus();}return true;}}while(true);}},checkRequiredObjects:function C(){if(this.req&&!this.mdf&&!this.edb){S.addClass(this.domNode,"required");return false;}return true;}};}());(function(){mstrmojo.requiresCls("mstrmojo.css");var F=mstrmojo.css,E="px",J="hasOwnAvatar",I={x:0,y:0};function B(L){var K=this.createAvatar(L.src.node,L);if(K){F.addClass(K,[this.avatarCssClass,J]);this.avatar=L.avatar=document.body.appendChild(K);}}function C(){var K=this.avatar;if(K){K.parentNode.removeChild(K);delete this.avatar;F.removeClass(K,[this.avatarCssClass,J]);}}mstrmojo._HasOwnAvatar=mstrmojo.provide("mstrmojo._HasOwnAvatar",{_mixinName:"mstrmojo._HasOwnAvatar",draggable:true,ownAvatar:true,avatarCssClass:"",restrictedToAxis:undefined,isDragValid:function H(K){if(this._super){return this._super(K);}return false;},ondragstart:function D(K){B.call(this,K);this.positionAvatar(K.src.pos,K);if(this._super){this._super(K);}},ondragmove:function A(K){this.positionAvatar(K.tgt.pos,K);if(this._super){this._super(K);}},ondragend:function A(K){C.call(this);if(this._super){this._super(K);}},createAvatar:mstrmojo.emptyFn,positionAvatar:function G(O,L){var N=this.avatar.style,M=this.restrictedToAxis,K=(L&&L.dragOffsets)||I;if(M!=="y"){N.left=O.x+K.x+E;}if(M!=="x"){N.top=O.y+K.y+E;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var V=mstrmojo.dom,U=mstrmojo.hash,W=mstrmojo.array,J=function J(t,q){var r=this.getCellForNode(t),p=this.getCellForNode(q);return !r||!p||r.hasOwnProperty("mix")===p.hasOwnProperty("mix");},k=function k(r,t,u){var p=r.childNodes.length,q;for(q=0;q<p;q++){if(r.childNodes[q]===t){return q+(u||0);}}return -1;},G=function G(t){var r=[],p=this.zone.tableNode.tBodies,q;W.forEach(p,function(u){for(q=0;q<u.childNodes.length;q++){r.push(u.childNodes[q]);}if(t&&u.childNodes.length<this.zone.rowsPerPage){r.push.apply(r,new Array(this.zone.rowsPerPage-u.childNodes.length));}},this);return r;},R=function R(){var q=0,p=this.zone.tableNode.tBodies;W.forEach(p,function(r){q+=r.childNodes.length;},this);return q;},C=function C(q,t){var r=G.call(this,true)[t],p;for(p=0;p<r.childNodes.length;p++){if(j.call(this,r.childNodes[p])>q){return null;}if(j.call(this,r.childNodes[p])===q){return r.childNodes[p];}}},Q=function Q(p){var q=this.getCellForNode(p);return q&&q.o+Z.call(this)||0;},j=function j(p){var q=this.getCellForNode(p);return q&&q.colIx||0;},A={REPLACE_ALL:1,REMOVE:2,APPEND:3,TOGGLE:4},f={CONTROL:"Ctrl",SHIFT:"Shft",SINGLE:"Single"},Z=function Z(){return this.rhsCP.startIndexInContainer;},L=function L(q,r){var p=this.rhsCP.getUnmergedCells(q)||[];if(p.length>r){return p[r];}else{return this.rhsCP.getCell(q,r-p.length);}},P=function P(AB,w,p){var v=AB.o,q=v,t=AB._gd,AA=AB._e&&AB._e.id,z,x=this.zone.searchRow(v+w),u,r=AB.colIx;if(x!==null){u=p===1?x.max-w:x.min;while(Math.abs(v-u)>0){z=L.call(this,v+p,r);if(!z||AA!==(z._e&&z._e.id)||(q!==z.o&&t===z._gd)){break;}v+=p;}return v+w;}else{return null;}},Y=function(p){var t=this.model.getCellDataUnion(p),q={},r;W.forEach(t,function(u){r=u.v;if(q[u.tid]&&q[u.tid][0]&&q[u.tid][0].n){r=q[u.tid][0].n+":"+u.v;}q[u.tid]=[{id:u.eid,n:r}];});return q;},d=function d(q){if(!q){return null;}if(!this.selectSiblings(q)){return[q];}var u=[],AC=this.getCellForNode(q),AI=this.gridData,AH=AI.gsi,w,AG,v,AB,AD,z,r,AF,x,p,t,AE=function(AK,AJ){var AL=true;if(AK.length===AJ.length){W.forEach((AK||[]),function(AM){AL=AL&&W.find(AJ,"id",AM.id)!==-1;return AL;});return AL;}return false;},AA=this.model.getCellInfo(AC);if(AA.isMetric){if(AH.tma===2){w=q.parentNode.childNodes;for(AG=0;AG<w.length;AG++){x=true;v=this.getCellForNode(w[AG]);if(v&&v.hasOwnProperty("mix")){p=Y.call(this,v);t=Y.call(this,AC);r=U.keyarray(p);AF=U.keyarray(t);if(!!r.length&&r.length===AF.length){W.forEach((r||[]),function(AJ){x=x&&AE(p[AJ],t[AJ]);return x;},this);}else{x=false;}if(x){u.push(w[AG]);}}}}else{u.push(q);}}else{if(this.isSelectAllCell(q)){u.push(q);}else{if(AC&&AC._e&&AC.axis===1){AB=G.call(this,false);W.forEach((AB||[]),function(AJ){for(AG=0;AG<=AJ.childNodes.length;AG++){z=AJ.childNodes[AG];v=this.getCellForNode(z);if(v&&v._e){if(this.model.compareElementsId(AC._e.id,v._e.id)){u.push(z);}}}},this);}else{if(AC&&AC._e&&AC.axis===2){w=q.parentNode.childNodes;for(AG=0;AG<w.length;AG++){x=true;v=this.getCellForNode(w[AG]);if(v&&v._e){if(AC._e.id===v._e.id){u.push(w[AG]);}}}}}}}return u;},a=function a(){this.selCells=[];this.clearSelections();},S=function S(r){var q=this,p=q.getCellForNode(r);this.selCells=W.filter(this.selCells,function(u){var t=q.getCellForNode(u);return t&&p&&(t.tui||t.ui)!==(p.tui||p.ui);});this.clearUnitSelections(this.model.data.gts[p.axis===1?"row":"col"][p.tui||p.ui].id);},n=function n(r){var q=this.isSelectAllCell(r),t=this.getCellForNode(r),u=this.model.getCellInfo(t),p=this.model.getCellTitleInfo(t);if(!q){if(W.indexOf(this.selCells,r)===-1){this.selCells.push(r);}}else{if(!t.hasOwnProperty("mix")){var v=u.isMetric?"Metrics":(p.title&&p.title.id),x=this.model.scm,w=v&&x&&x[v];if(w&&(w.all||w.showall)){this.addAttributeSelection(p.title.id,"OA:(All)","all");}}return ;}if(t.hasOwnProperty("mix")){this.addMetricValueSelection(Y.call(this,t));}else{this.addAttributeSelection(p.title.id,t._e.id,t._e.n);}},H=function H(p){var r=this.selCells.indexOf(p),q=this.getCellForNode(p);this.selCells.splice(r,1);if(q.hasOwnProperty("mix")){this.removeMetricValueSelection(Y.call(this,q));}else{this.removeAttributeSelection(this.model.getCellTitleInfo(q).title.id,q._e.id);}},B=function B(p){return W.some(this.model.getCellDataUnion(this.getCellForNode(p)),function(q){return q.isSubtotal;});},T=function T(r,u,q){var t,p,v=this;if(U.isEmpty(r)&&(!q&&this.clearAllSelections&&this.clearAllSelections())){a.call(this);}r=W.filter((r||[]),function(w){return !B.call(v,w);});W.forEach(r,function(w){p=u;t=~W.indexOf(this.selCells,w);if(A.TOGGLE===p){p=t?A.REMOVE:A.APPEND;}if(A.REPLACE_ALL===p){if(q){S.call(this,w);}else{a.call(this);}u=p=A.APPEND;}switch(p){case A.APPEND:n.call(this,w);break;case A.REMOVE:H.call(this,w);break;}},this);},I=function I(v,w,q,t){var r=Math.min(w,t),u=Math.min(v,q),AD=Math.max(w,t),p=Math.max(v,q),AA,z,AC=[],AB=function(x,AE){W.forEach((AE||[]),function(AF){if(W.indexOf(x,AF)===-1){x.push(AF);}});};for(AA=u;AA<=p;AA++){for(z=r;z<=AD;z++){AB(AC,d.call(this,C.call(this,AA,z)));}}T.call(this,AC,A.APPEND);},X=function X(p,w){var x,u=this.selectorControl&&this.selectorControl.showall,z=!!this.defn.msuc,q=this.isSelectAllCell(w),AA=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),r=!this.selectorControl&&(AA&&AA.length>0),AB,t,AD,v,AC=this.parent&&this.parent.defn&&this.parent.defn.t===527;if(AC){z=!!this.parent.defn.msuc;}if(r){if(!z){p=f.SINGLE;}AD=this.getCellForNode(w);t=AD&&AD.id;v=W.find(AA,"did",t);if(v>=0){AB=AA[v].sc;u=AB.showall||AB.all;}}if(w.attributes.getNamedItem("ei")!==null&&(r||(!B.call(this,w)&&(u||!q)))){x=this.getSelectionHash();if(U.isEmpty(x)){this.selCells=[];}if(p===f.SINGLE&&w.className.indexOf(this.CELL_HIGHLIGHT)!==-1&&this.selCells.length>0){if(g.call(this,w)){p=f.CONTROL;this.xTabHiddenTextArea.blur();}}this.clearHighlights();this["on"+p+"Select"](w,r);this.lastSelectedCell=w;if(p!==f.SHIFT){this.shiftInfo={lastCell:w,selCells:[].concat(this.selCells)};}this.markSelections();this.endSelections();}},g=function g(w){var r=this.selCells,u=true;if(this.selectSiblings(w)){var q=this.getCellForNode(r[0]),p=this.model.getCellInfo(q).isMetric,t=p?q._ei:q._e&&q._e.id,v=p?q._tp&&q._tp._e&&q._tp._e.id:undefined;u=!W.some(r,function(x){x=this.getCellForNode(x);if(p){return x._tp._e.id===v&&x._ei!==t;}else{return x._e&&x._e.id!==t;}}.bind(this));}else{if(r.length>1){u=false;}}return u;};mstrmojo.vi.ui.rw._IsMultiselectXtab=mstrmojo.provide("mstrmojo.vi.ui.rw._IsMultiselectXtab",{_mixinName:"mstrmojo.vi.ui.rw._IsMultiselectXtab",selCells:[],lastSelectedCell:null,isMultiSelect:false,getLastSelectedCell:function F(){return this.lastSelectedCell;},onCtrlSelect:function b(p,q){T.call(this,d.call(this,p),A.TOGGLE,q);},onShftSelect:function o(AG,r){if(r){return this.onSingleSelect(AG,r);}var q=this.shiftInfo.lastCell;if(J.call(this,AG,q)){this.selCells=[].concat(this.shiftInfo.selCells);var AB=Z.call(this),AC,u,z,t,AA,AE,AD=j.call(this,q),x=j.call(this,AG),p=parseInt(q.getAttribute("r"),10),AF=parseInt(AG.getAttribute("r"),10),w=this.model.getCellInfo(this.getCellForNode(AG));if(w.isMetric){AC=p;u=AF;}else{if(AD===x){AA=this.getCellForNode(q);AE=this.getCellForNode(AG);}else{var v=Math.min(AD,x);AA=L.call(this,p-AB,v);AE=L.call(this,AF-AB,v);if(this.zone.searchRow(AA.o+AB)===null){AA=this.getCellForNode(q);}if(this.zone.searchRow(AE.o+AB)===null){AE=this.getCellForNode(AG);}}z=(AA.o<AE.o)?AA:AE;AC=P.call(this,z,AB,-1);t=(AA.o>AE.o)?AA:AE;u=P.call(this,t,AB,1);}I.call(this,AD,AC,x,u);}},onSingleSelect:function O(p,q){T.call(this,d.call(this,p),A.REPLACE_ALL,q);},handleSelection:function E(v,p,u){var t=u&&V.findAncestorByName(u,"td",true,this.viewport),r=J.call(this,t,this.lastSelectedCell),w,q=v.button===2||V.isMac()&&V.ctrlKey(p,v)&&v.button===0;if(!(this.isSelected(t)&&q)){if(V.isMetaKey(p,v)&&r){w=f.CONTROL;}else{if(V.shiftKey(p,v)&&r){w=f.SHIFT;}else{w=f.SINGLE;}}X.call(this,w,t);}},markSelections:function D(){this.highlightCells(this.selCells);},handlesMultiSelection:function e(p){return(this._super&&this._super(p))||this.isMultiSelect;},isSelected:function m(p){return W.indexOf(this.selCells,p)!==-1;},addSelection:function N(p){if(!this.isSelected(p)){X.call(this,f.CONTROL,p);}},onclick:function c(q){V.clearBrowserHighlights();var t=q.getTarget&&q.getTarget();if(this.handlesMultiSelection(q)){if(mstrApp.isExpress){var r=t&&V.findAncestorByName(t,"td",true,this.viewport),p=V.findAncestorByName(t,"span",true,r);if(p){this.handleSelection(q.e,q.hWin,t);}}else{this.handleSelection(q.e,q.hWin,t);}}else{this._super(q);}},singleUnitSelect:function h(){var q=this.lastSelectedCell,p=this.getCellForNode(q);this.defaultAction(q,p);},getActionCells:function K(p){var r=this,q=W.map(W.filter(this.selCells,function(u){var t=r.getCellForNode(u);return t&&p&&(t.tui||t.ui)===(p.tui||p.ui);}),function(t){return r.getCellForNode(t);});if((q.length===0)||!this.model.getCellTitleInfo(p).isSrcTitle){q=this._super(p);}return q;},openXtabCellMenu:function M(r){var p=mstrmojo.findAncestor(this,"openXtabCellMenu");if(p){if(r.evt){if(V.isMetaKey(r.hWin,r.evt)){var q=r.td&&V.findAncestorByName(r.td,"td",true,this.viewport);this.addSelection(q);}}p.openXtabCellMenu(r);if(this.parent&&this.parent.selectVIUnit){this.parent.selectVIUnit();}}},highlightCells:function(q,p){if(this._super){this._super(q,p);}if(p){this.selCells=q;}},selectSiblings:function(){return true;},isSelectAllCell:function l(r){var p=this.getCellForNode(r),q=p&&this.model.getCellDataUnion(p);return !!p&&(q.length===0||(q.length===1&&!q[0].eid));}});}());(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.hash","mstrmojo.css");var F=mstrmojo.hash,C=mstrmojo.css;var D="open";function E(G){return G?G.popupConfig.hostElement:null;}mstrmojo.ui.menus._HasMenuPopup=mstrmojo.provide("mstrmojo.ui.menus._HasMenuPopup",F.copy(mstrmojo._HasPopup));mstrmojo.ui.menus._HasMenuPopup.openPopup=function A(I,G){var H=this._lastOpened;if(H){this.closePopup();}mstrmojo._HasPopup.openPopup.call(this,I,G);C.addClass(E(I),D);};mstrmojo.ui.menus._HasMenuPopup.closePopup=function B(){C.removeClass(E(this._lastOpened),D);mstrmojo._HasPopup.closePopup.call(this);};}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.css");var A=1,K="mstrmojo-itemwrap",J="&nbsp;",I=mstrmojo.array;function B(V){if(!V.pageSize||V.pageSize<=0){var W=V.scrollboxNode;V.pageSize=W&&W.clientHeight||0;}return V.pageSize;}function T(V,W){if(V.usePaging){V.totalPages=1;var Y=V.itemsContainerNode,X=B(V);if(V.usePaging&&Y&&X){V.totalPages=Math.ceil((Y.clientHeight-parseInt(Y.style&&Y.style.paddingBottom||0,10))/X);}if(Y){V.itemsContainerNode.style.paddingBottom=X+"px";}}}mstrmojo.ListMapper=mstrmojo.provide("mstrmojo.ListMapper",{markupPrefix:"",markupSuffix:"",itemWrapperPrefix:function(V){return'<div class="'+this.getWrapperCss(V)+'">';},itemWrapperSuffix:"</div>",itemWrapperPrefill:"&nbsp",wrapperNodes:function C(V){return V.childNodes;},wrapperParentNode:function D(V){return V;},createWrapperNode:function G(V){var W=V.ownerDocument,X=W.createElement("div");return X;},findScrollRange:function N(k,Z,j,n,W,c,o,m){if(!Z){return{start:0,end:0};}var e=this.wrapperNodes(k),g=parseInt(Z/2,10),Y=parseInt(Math.log(Z)/Math.log(2),10),X=0,V=Z-1,f=j+n,d=e[0].offsetTop,b;for(var l=1;l<=Y;l++){b=e[g].offsetTop-d+m;if(b<j){X=g;}else{if(b>f){V=g;}}var a=Math.round(Z/Math.pow(2,l+1));g+=(b>j)?-a:a;g=Math.min(Math.max(0,g),Z-1);}return{start:X,end:V};},findWrapper:function L(X,V){var W=this.wrapperNodes(X);return W&&W[V];},findIndex:function F(V,Y,X){var W=this._nd2iw(V,Y,X);return W?this._iw2idx(V,Y,W):-1;},itemOffsetTop:function U(W,a,V,Y){if(!Y){var X=this.wrapperNodes(a);Y=X&&X[V];if(!Y){return 0;}}var Z=a.firstChild;if(!Z||(Z===Y)){return 0;}else{return Y.offsetTop-Z.offsetTop;}},whereDrop:function S(c,V,X,b,W){var Y=this._nd2iw(c,V,X),d,a,e;if(Y){a=this._iw2idx(c,V,Y);d=a;e=this.itemOffsetTop(c,V,null,Y);var Z=Y.offsetHeight;if(b.y>W.top+e+Z/2){d++;e+=Z;}}else{return c.dropCuePos;}return{left:0,top:e,idx:d,idxActual:a};},getWrapperCss:function(V){return K;},postBuildRendering:function(Z,Y,X,W,V){T(W,this);},buildItemWrappers:function P(e,b,h,d,a,l){var m=this.itemWrapperPrefix(h),g=this.itemWrapperSuffix,Z=m+this.itemWrapperPrefill+g,Y=[this.markupPrefix],W=1,V=h.selectedIndices||{},o=function n(k,j){for(var p=k;p<j;p++){Y[W++]=m;var q=b.build(h,d,e[p],p);if(V[p]){q=q.replace(/class\=\"([^\"]*)\"/,'class="$1 selected"');}Y[W++]=q;Y[W++]=g;}};var c=(e&&e.length)||0;a=a&&b?Math.min(a,c):0;if(a){o(0,a);}l=l&&b?Math.min(l,c-a):0;var f=c-l;for(var X=a;X<f;X++){Y[W++]=Z;}if(l){o(f,c);}Y.push(this.markupSuffix);return Y;},fillItemWrappers:function H(X,g,d,m,f,W,b,l){var e=(g&&g.length)||0,j=this.wrapperNodes(X),n=f.itemStatus,V=mstrmojo.css,Z=m.selectedIndices||{};for(var c=W,h=Math.min(b+1,e),a=0;c<h;c++){if(n[c]!==A){j[c].innerHTML=d.build(m,f,g[c],c);if(Z[c]){var Y=j[c].firstChild;if(Y){V.addClass(Y,["selected"]);}}a++;if(a===l){break;}}}return a;},onadd:function O(e,V,Z,f){if(V&&f){var a=f.value.length,b=this.wrapperNodes(V),d=b[f.index],Y=this.getWrapperCss(e);for(var X=0;X<a;X++){var W=this.createWrapperNode(V);W.className=Y;W.innerHTML=J;if(d){this.wrapperParentNode(V).insertBefore(W,d);}else{this.wrapperParentNode(V).appendChild(W);}}T(e,this);}},onremove:function Q(Y,b,V,X){if(b&&X){var a=this.wrapperNodes(b);if(a){var d=X.value.length;for(var Z=X.index+d-1,W=X.index;Z>=W;Z--){this.wrapperParentNode(b).removeChild(a[Z]);}}T(Y,this);}},onchange:function R(g,X,c,k){if(X&&k){var d=this.wrapperNodes(X);if(d){var W=mstrmojo.css,l=c.itemStatus,h;for(var b=0,V=k.removed,f=V&&V.length;b<f;b++){h=V[b];if(l[h]){W.removeClass(d[h].firstChild,["selected"]);}}for(var Z=0,e=k.added,Y=e&&e.length;Z<Y;Z++){h=e[Z];if(l[h]){W.addClass(d[h].firstChild,["selected"]);}}}}},_nd2iw:function E(W,Z,Y){Z=this.wrapperParentNode(Z);if(Z&&Y&&Z!==Y){var V=W.domNode,X=Y.parentNode;while(X){if(X===Z){return Y;}if(X===V){break;}Y=X;X=Y.parentNode;}}return null;},_iw2idx:function M(X,b,a){var W=X.items&&X.items.length,Y=this.wrapperNodes(b),V=I.findBin(Y,a,"offsetTop",W);for(var Z=V;Z<W;Z++){if(Y[Z].offsetHeight){return Z;}}return -1;},toPage:function(V,X){var W=V.scrollboxNode;if(V.usePaging&&W){W.scrollTop=X*B(V);}else{mstrmojo.alert("paging is not setup, can not perform paging.");}},whichPage:function(V){var W=V.scrollboxNode,X=B(V);return Math.round((W&&X&&W.scrollTop/X)||0);},toItem:function(Z,a){var X=Z&&Z.itemsContainerNode,e=Z.scrollboxNode,V=this.itemOffsetTop(Z,X,a),b=this.wrapperNodes(X)[a].clientHeight,W=e.clientHeight,d=e.scrollTop,Y=d;if(V<d){Y=V;}else{if(d+W-b<V){Y=Math.min(V,V-W+b);}}e.scrollTop=Y;}});})();(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.css");var E=null;function D(H){var G=1;if(H.tstp===769){G=2;}else{if(H.tstp===774){G=3;}}return G;}function B(K){var G=mstrApp.name,J=G+"?",H=-1,I=function(M,L){J+=M+"="+L+"&";};if(!!K){switch(K.ttp){case 3:I("evt","4001");I("reportID",K.tid);H=D(K);if(H!==-1){I("reportViewMode",H);}break;case 55:if(K.tstp===14080){I("evt","32001");I("documentID",K.tid);}else{if(K.tvmd&(8192|2048)&&!((K.tvmd&2048&&mstrApp.features["run-vi-flash"]))){I("evt","3140");I("documentID",K.tid);if(mstrmojo.dom.isIE6||mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(12187,"To work with HTML5 dashboards, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}}else{I("evt","2048001");I("objectID",K.tid);I("visMode","0");}}break;}}return J;}mstrmojo._HasDocLink=mstrmojo.provide("mstrmojo._HasDocLink",{_mixinName:"mstrmojo._HasDocLink",url:"",target:"",linkEnabled:true,ifw:"",update:function F(G){var H=G.defn;this.url=G.data.url||H.url;if(H.target){this.target=H.target;}if(H.ifw){this.ifw=H.ifw;}this._super(G);},postBuildRendering:function A(){if(this.url||this.ifw){mstrmojo.css.addClass(this.domNode,"hasLink");}var H=this.controller&&this.controller.view,G=H&&H.getCurrentLayout&&H.getCurrentLayout();if(G&&G.addLinkInfo){G.addLinkInfo(this.id,{url:this.url,target:this.target,src:this});}return this._super();},setLinkEnabled:function C(K){this.linkEnabled=K;var J=this.domNode;if(!J){return ;}var L=J.childNodes,I=L[L.length-1],G=this.id+"_mask",H=(I.id===G)?I:null;if(K){if(H){J.removeChild(H);delete this._mask;}}else{if(!H){H=document.createElement("div");H.className="mstrmojo-DocLinkMask";H.id=G;H.innerHTML="&nbsp;";J.appendChild(H);}}},cancelDocLink:false,onclick:function(){if(E===null){var H=this,G=function(){if(H.linkEnabled&&!H.isEditing){var K=H.drillLinkItems,I=K&&K[0],J=H.url||(I&&I.url);if(H.ifw){H.model.showInfoWin(H.ifw,(H.getAnchor&&H.getAnchor())||H.domNode,"v",true);}else{if(J){H.model.executeLink(J,H.target,H);}else{if(H.node&&H.node.data&&H.node.data.tid){J=B(H.node.data);if(!!J){H.model.executeLink(J,H.target,H);}}}}}};E=window.setTimeout(function(){if(!H.cancelDocLink){G();}H.cancelDocLink=false;E=null;},200);}},hasActiveLink:function(){var I=false;if(this.linkEnabled){var J=this.drillLinkItems,G=J&&J[0],H=this.url||(G&&G.url);if(this.node&&this.node.data&&this.node.data.tid){I=true;}else{if(H){I=true;}}}return I;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash");var K=1,B=2;function N(Q,P){return D(Q,P)&&Q.o===P.o;}function D(Q,P){return Q&&P&&Q.ui===P.ui&&Q.axis===P.axis&&Q.mix===P.mix;}function A(T,Q,R){var S=R.getCellTitleId(Q),P=R.getCellUnitIndex(Q);R.selections[S]=R.selections[S]||{};R.selections[S][P]=R.selections[S][P]||[];R.selections[S][P].push(T);M(T,Q,R);}function M(T,Q,R){if(Q){var S=R.getCellTitleId(Q),P=R.getCellUnitIndex(Q);if(!R.selectionsForCopy){R.selectionsForCopy={};}R.selectionsForCopy[S]=R.selectionsForCopy[S]||{};R.selectionsForCopy[S][P]=R.selectionsForCopy[S][P]||[];R.selectionsForCopy[S][P].push(T);C(T);}}function O(Q){var U=Q.selectionsForCopy;for(var T in U){for(var S in U[T]){for(var R=0,P=U[T][S].length;R<P;R++){J(U[T][S][R]);}}}Q.selections={};Q.selectionsForCopy={};}function C(P){mstrmojo.css.setOpacity(P,50);if(P.nodeName.toLowerCase()==="td"&&mstrmojo.dom.isIE8){mstrmojo.css.addClass(P,"showGridBorder");}}function J(P){mstrmojo.css.setOpacity(P,100);if(P.nodeName.toLowerCase()==="td"&&mstrmojo.dom.isIE8){mstrmojo.css.addClass(P,"showGridBorder");}}function F(R,S){if(R.mix===undefined){var V=S.gridData.gts[R.axis===K?"row":"col"],Q=V[R.tui||R.ui],U=0;for(var T=0,P=V.length;T<P;T++){if(V[T].id===Q.id){U++;}}return U;}return 0;}function H(){var Q="_xtabSelectionsHiddenField",P;P=document.getElementById(Q);if(!P){P=document.createElement("textarea");P.id=Q;P.style.opacity=0;P.style.position="absolute";P.style.top=0;P.style.height=0;P.style.width=0;document.body.appendChild(P);}return P;}function G(){var W="",Y={},R,b=[],f=[],Q={},S={},P=this.selectionsForCopy,V=mstrmojo.hash,X=mstrmojo.array,d=function(g,h){if(g.hasOwnProperty("mix")){return h.es[g.mix].n;}else{return h.n;}},T,Z,U,e,c,a=0;V.forEach(P,function(h,g){V.forEach(h,function(j){X.forEach(j,function(k){a++;Z=k.offsetLeft;U=k.offsetTop;if(!Y[Z]){Y[Z]={};}R=Y[Z];R[U]=k.innerText;if(X.indexOf(b,Z)==-1){b.push(Z);}if(X.indexOf(b,U)==-1){f.push(U);}e=this.getCellForNode(k);c=this.model.getCellTitleInfo(e).title;if((!c.id&&c.axis==K)||(c.id&&c.axis==B)){S[U]=d.call(this,e,c);}else{Q[Z]=d.call(this,e,c);}},this);},this);},this);b.sort(function(h,g){return h-g;});f.sort(function(h,g){return h-g;});if(a>1&&!V.isEmpty(S)){W="\t";}if(a>1&&!V.isEmpty(Q)){X.forEach(b,function(g){W+=(Q[g]||"")+"\t";});W+="\n";}X.forEach(f,function(g){if(a>1&&!V.isEmpty(S)){W+=(S[g]||"")+"\t";}X.forEach(b,function(h){W+=(Y[h][g]||"")+(a>1?"\t":"");});if(a>1){W+="\n";}});T=H();T.value=W;T.focus();T.select();}mstrmojo._XtabSelections={lastSelectedTD:null,singleSelectForCopy:function I(P){var U=this.getCellForNode(P),b,c,Z,a=U&&U.mix!=undefined,S=function(e,d){d=d||{};e=e||{};if(a){return e.mix==d.mix;}else{return e.mix==d.mix&&e.ui==d.ui;}};Z=mstrmojo.dom.findAncestorByName(P,"table",false);c=Z.rows;for(var V=0,W=c.length;V<W;V++){var Y=c[V].cells;for(var T=0,R=Y.length;T<R;T++){var Q=Y[T],X=this.getCellForNode(Q);if(Q!=P&&S(X,U)){M(Q,X,this);}}}},singleSelect:function E(Q,Y){var W=this.getCellForNode(Q),f=Q.parentNode;if(Y){var V=this.getCellTitleId(W),b=this.getCellUnitIndex(W);selectedTitle=this.selections[V];selectedUnit=selectedTitle&&selectedTitle[b];if(selectedUnit){for(var X=0,Z=selectedUnit.length;X<Z;X++){J(selectedUnit[X]);}delete selectedTitle[b];return ;}}var U=F(W,this);if(W.axis===K){for(var X=0,P=0,Z=f.cells.length;X<Z&&P<U;X++){var S=f.cells[X],a=this.getCellForNode(S);if(N(a,W)){A(S,a,this);P++;}}}else{if(W.axis===B){var d=mstrmojo.dom.findAncestorByName(Q,"table",false),e=d.rows;for(var X=0,P=0,Z=e.length;X<Z&&P<U;X++){var c=e[X].cells;for(var T=0,R=c.length;T<R;T++){var S=c[T],a=this.getCellForNode(S);if(N(a,W)){A(S,a,this);P++;break;}}}}else{A(Q,W,this);}}},rangeSelect:function L(h,k){var e=this.getCellForNode(h),P=this.getCellForNode(k);if(D(e,P)){if(e.o>P.o||e._ei>P._ei){var n=h;h=k;e=this.getCellForNode(h);k=n;P=this.getCellForNode(k);}var a=F(e,this),Q=e.axis,l=mstrmojo.dom.findAncestorByName(h,"table",false),X=l.rows,f=h.parentNode,o=f.rowIndex,Z=f.cells,c=k.parentNode.rowIndex;if(Q===K){for(var d=o;d<=c;d++){var R=X[d].cells,S=false;for(var b=0,g=R.length,T=0;b<g&&T<a;b++){var V=R[b],Y=this.getCellForNode(V);if(D(Y,e)){A(V,Y,this);T++;}}}}else{if(Q===B){for(var d=0,g=X.length,m=0;d<g&&m<a;d++){var R=X[d].cells,W=false;for(var b=0,U=R.length;b<U;b++){var V=R[b],Y=this.getCellForNode(V);if(N(Y,e)){W=true;}if(W){A(V,Y,this);}if(N(Y,P)){break;}}if(W){m++;}}}else{if(o==c){for(var d=h.cellIndex,g=k.cellIndex;d<=g;d++){var V=Z[d],Y=this.getCellForNode(V);A(V,Y,this);}}else{for(var d=o,g=c;d<=g;d++){var R=X[d].cells;for(var b=0,U=R.length;b<U;b++){var V=R[b],Y=this.getCellForNode(V);if(D(Y,e)){A(V,Y,this);break;}}}}}}}},doSelection:function(W,V,T){var X=mstrmojo.dom,P=X.ctrlKey(V,W),Q=X.shiftKey(V,W);if(!P){O(this);}var U=this.getCellForNode(T);var R=U&&(U.mix===undefined&&U.o!==undefined),S=U&&(U.mix!==undefined&&(U._lp||U._tp));if(R||S){if(Q){this.rangeSelect(this.lastSelectedTD,T);}else{this.singleSelect(T,P);this.lastSelectedTD=T;}}else{this.singleSelectForCopy(T,P);}G.call(this);}};})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.fx.AnimateProp");var S=mstrmojo.css;var Q=10;function C(W,Z,Y){W.pauseScrollRendering(true);var X=W.scrollboxNode,V=W.animate?W.scrollEffect:null;if(V&&V.play){if(V.isPlaying){V.cancel();}V.props={scrollTop:{start:X.scrollTop,stop:Z,isStyle:false}};V.onEnd=function(){W.pauseScrollRendering(false,null,Y);};V.play();}else{X.scrollTop=Z;W.pauseScrollRendering(false,null,Y);}}function K(c,e,V){var W=4;if(!V){V=0;}var f=Math.round(c.renderBlockSize/2);c.fillAt(Math.max(0,e-f),e+f);var b=c.itemsContainerNode,a=b.childNodes[e],Z=c.listMapper.itemOffsetTop(c,b,null,a),d=parseInt(c.scrollboxNode.clientHeight/2,10)-a.offsetHeight/2,X=Math.max(0,c.spacerMargin+Z-d);if(Math.abs(c.scrollboxNode.scrollTop-X)>2){C(c,X,c.renderOnScroll?function(){if(V<=W){K(c,e,V++);}}:null);}else{var Y=c.animate?c.scrollEffect:null;if(Y&&Y.isPlaying&&Y.cancel){Y.cancel();c.pauseScrollRendering(false);}}}function J(X){var Y=X.itemsContainerNode,V=Y.lastChild,W=V?V.offsetTop+V.offsetHeight-Y.firstChild.offsetTop:0;return W;}function U(W){var V=J(W),X=Math.max(0,parseInt((W.scrollboxNode.clientHeight-V)/2,10));C(W,Math.max(0,W.spacerMargin-X));}function H(X){var V=X.selectedIndex,W=V>-1;X.set("hasSelection",W);if(!X.domNode){return ;}if(W){K(X,V);}else{U(X);}}function E(W){var Y=W.scrollboxNode,V=J(W),X=V>Y.clientHeight/2;S.toggleClass(W.upArrowNode,["enabled"],X);S.toggleClass(W.downArrowNode,["enabled"],X);}function N(V,W){var X=V.scrollboxNode;X.scrollTop=Math.min(Math.max(X.scrollTop+W,0),X.scrollHeight-X.offsetHeight);}function B(W,V){if(!W._scrollInter){var X=Q*(V?-1:1);W._scrollInter=window.setInterval(function(){N(W,X);},50);}}function R(V){if(V._scrollInter){window.clearInterval(V._scrollInter);V._scrollInter=null;}}mstrmojo._IsDial=mstrmojo.provide("mstrmojo._IsDial",{markupString:'<div id="{@id}" class="mstrmojo-Dial {@cssClass}" style="position:relative;"><div class="mstrmojo-Dial-uparrow"  onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], true)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], true)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"></div><div class="mstrmojo-Dial-scrollbox {@cssClass}" style="position:relative;{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-Dial-spacer" style="{@spacerCssText}"><div class="mstrmojo-Dial-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div></div></div><div class="mstrmojo-Dial-dnarrow" onmouseover="mstrmojo.all.{@id}.onmouseoverarrow(self, arguments[0], false)" onmouseout="mstrmojo.all.{@id}.onmouseoutarrow(self, arguments[0], false)" onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.childNodes[1];},spacerNode:function(){return this.domNode.childNodes[1].firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1].firstChild.firstChild;},upArrowNode:function(){return this.domNode.childNodes[0];},downArrowNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){S.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);}},animate:true,itemsEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:500,interval:25,slot:"itemsContainerNode",preStart:function(){var W=this.widget[this.slot],V=(W&&W.offsetWidth)||0;this.props=V?{left:{start:-V,stop:0,suffix:"px",isStyle:true}}:{};},revertOnCancel:false},scrollEffect:{scriptClass:"mstrmojo.fx.AnimateProp",duration:250,interval:25,slot:"scrollboxNode",revertOnCancel:false},multiSelect:false,holdJumpOnly:true,audibles:{"*":true,hasSelection:false},initSpacer:function I(){var V=(this.cssText||"").match(/height:\s*(\d*)px/);if(V){this.spacerMargin=parseInt(Number(V[1])/2,10);var W=this.spacerMargin+"px";this.spacerCssText="padding-top: "+W+"; padding-bottom: "+W+";";}else{this.spacerMargin=0;delete this.spacerCssText;}},center:function T(){H(this);},preBuildRendering:function(){this.initSpacer();return this._super();},postBuildRendering:function D(){this._super();this.center();E(this);},refreshScroll:function G(){this.center();E(this);},prechange:function O(V){this._super(V);if(this.hasRendered){if(!this.multiSelect||(V&&V.added&&V.added.length)){this.center();}}},onclickarrow:function A(X,W,V){N(this,Q*(V?-1:1));},onmouseoverarrow:function L(X,W,V){if(!this.holdJumpOnly){B(this,V);}},onmouseoutarrow:function M(X,W,V){R(this);},onmousedownarrow:function F(X,W,V){if(this.holdJumpOnly){B(this,V);}},onmouseuparrow:function P(X,W,V){R(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css");var A=mstrmojo.css;mstrmojo.ui._HasUITheme=mstrmojo.provide("mstrmojo.ui._HasUITheme",{_mixinName:"mstrmojo.ui._HasUITheme",themeClassName:"",postBuildRendering:function B(){var D=this.themeClassName;if(D){this.onthemeClassNameChange({value:D});}return this._super();},onthemeClassNameChange:function C(D){var F=this.domNode;if(F){var G=D.value,E=D.valueWas;if(G){A.addClass(F,D.value);}if(E){A.removeClass(F,D.valueWas);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.string","mstrmojo.css");var K=mstrmojo.css,N=mstrmojo.string,H=mstrmojo.dom,L=13,C=27;function I(S){if(this._editComplete){return ;}var W,Q=false,V=this.text,T=false;if(S===C){W=V;T=true;Q=true;}if(!S||(!this.allowNewLine&&S===L)){var R=this[this.editableSlot],U=R.innerText||R.textContent||"";if(!this.allowNewLine){W=U.replace(/\n/g,"");}else{W=U;}Q=true;if(!this.allowEmptyText&&W.length===0){W=V;T=true;}}if(Q){this._editComplete=true;W=W.replace(/\u00A0/g,"\u0020");this.text=W;this.set("isEditing",false);this.onTextEditComplete(W!==V,V);delete this._editComplete;}if(T){this.refresh();}}function E(Q){var R={dblclick:"editOnDoubleClick",click:"editOnClick"};if(this[R[Q.name]]&&Q.getTarget()===this[this.editableSlot]){this.set("isEditing",true);}}function F(S,R,Q){if(typeof R["on"+Q]!=="function"){H.attachMarkupEvent(S,R,Q);}}mstrmojo._HasEditableText=mstrmojo.provide("mstrmojo._HasEditableText",{_mixinName:"mstrmojo._HasEditableText",editableSlot:"domNode",editButtonSlot:null,isEditing:false,editOnClick:true,allowEmptyText:false,allowNewLine:false,editOnDoubleClick:false,onTextEditComplete:mstrmojo.emptyFn,postBuildRendering:function A(){this._super();var S=this.editableSlot,Q=this[S],T=this[this.editButtonSlot||S];K.addClass(Q,"hasEditableText");this.text=this.text||Q.innerText||Q.textContent||"";Q.innerHTML=N.encodeHtmlString(this.text,true).replace(/ (?= )/g,"&nbsp;");var R=this.id;if(this.editOnClick){F(R,T,"click");}F(R,T,"dblclick");F(R,Q,"blur");F(R,Q,"keyup");F(R,Q,"keydown");},onclick:function P(Q){E.call(this,Q);if(this._super){this._super(Q);}},ondblclick:function G(Q){E.call(this,Q);},onblur:function M(){I.call(this);},onkeyup:function B(R){var Q=window.event||R.e;I.call(this,Q.keyCode);},onkeydown:function J(R){var Q=window.event||R.e;if(Q.keyCode===L){I.call(this,Q.keyCode);R.cancel();}},_set_text:function D(S,Q){var R=this.text;this.text=Q;if(this.hasRendered){this[this.editableSlot].innerHTML=N.encodeHtmlString(Q||"",true);}return(R!==Q);},onisEditingChange:function O(){if(this.hasRendered){var Q=this[this.editableSlot],R=!!this.isEditing;Q.contentEditable=R;Q.spellcheck=false;K.toggleClass(Q,"editable",R);if(R){Q.focus();H.setElementSelection(Q);}else{Q.blur();Q.scrollLeft=0;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css");var J={T:["top","left"],D:["height","width"],B:["border","border-color","border-style","border-width"],F:["font","color","text-decoration"],P:["padding"],BG:["background-color","fx"],RW:[]};J.RW=["z-index"].concat(J.T.concat(J.D));var D=mstrmojo.dom,O=mstrmojo.css;function N(T,V,S){var U=T[V]||[];U.push(S);T[V]=U;}function L(W,V){var U=((W&&W.fmts)||null);if(V){var Y=W.thresholds,T=Y&&Y[V];if(T){var X={},Z;for(Z in U){X[Z]=T[Z]||U[Z];}for(Z in T){var S=T[Z];X[Z]=(typeof S==="string")?(S+" !important"):S;}U=X;}}return U;}mstrmojo._Formattable=mstrmojo.provide("mstrmojo._Formattable",{_mixinName:"mstrmojo._Formattable",formatHandlers:null,thresholdId:null,getCacheKey:function E(){return"css_cache"+(this.thresholdId||"");},update:function G(T){var S=true;this.invisible=!!(T&&T.data&&T.data.invisible);if(this._super){S=this._super(T);}return S;},buildCSSFormatString:function H(U,d){var h=this.formatHandlers[U],k=h.src?d[h.src]:d;if(!k){return null;}var b=h.props||h;if(!b){return null;}var X=[],g=-1;var V=b.length-1;for(V;V>=0;V--){var j=b[V];var c=J[j]||[j];var a=c.length-1;for(a;a>=0;a--){j=c[a];var T=k[j];if(T!==undefined){if(j==="fx"){var Y=T,S={};var e=Y.gd;if(e){this.formatGradient(e,S);}var W=parseInt(Y.rt,10);if(W){if(W===1||W===3){this.formatTextRotation(Y.rt,S);}}if(Y.ds){this.formatDropShadow(Y,S);}var Z;for(Z in S){X[++g]=Z+":"+S[Z].join(" ");}}else{X[++g]=j+":"+T;}}}}if(this.invisible){X.push("visibility:hidden");}return X.join(";")+";";},applyCSSFormatToNode:function I(U,S){var V=this[U],T=V&&V.style;if(T){this.buildCSSFormatString(U,S).split(";").forEach(function(W){var X=W.split(":");T[O.convertCssToCamelCase(X[0])]=X[1];});}},clearSlotBackgroundCSS:function F(T){var U=this[T],S=U&&U.style;if(S){S.background="transparent none 0 0 no-repeat";S.filter="none";}},preBuildRendering:function B(){this._super();var V=this.formatHandlers,S=this.getFormats();if(V&&S){var W=this.defn=this.defn||{},X=this.getCacheKey(),U=W[X];if(!U){U=W[X]={};for(var T in V){var Z=T+"CssText";this[Z]=U[Z]=this.buildCSSFormatString(T,S)||"";}}else{var Y;for(Y in U){this[Y]=U[Y];}}}return true;},formatGradient:function P(S,U){var T=O.buildGradient(S.t,S.sc,S.ec);if(T){N(U,T.n,T.v);}},formatDropShadow:function K(W,U){if(D.supports(D.cssFeatures.DROP_SHADOW)){var V=W.ds;if(D.isDXIE){N(U,"filter","progid:DXImageTransform.Microsoft.DropShadow(Color='#66000000',Positive='true',OffX="+V+",OffY="+V+")");}else{var S=[V,V],T=parseInt(W.rt,10);if(T===1||T===3){S[((T===1)?1:0)]=-V;}N(U,(D.isWK?"-webkit-":"")+"box-shadow",S.join("px ")+"px 3px 0px #888");}}},formatTextRotation:function C(T,S){if(D.supports(D.cssFeatures.TEXT_ROTATION)){if(D.isDXIE){N(S,"filter","progid:DXImageTransform.Microsoft.BasicImage(rotation="+T+")");}else{var U=(T===1)?90:-90;N(S,D.CSS3_PREFIX+"transform-origin","top left");N(S,D.CSS3_PREFIX+"transform","rotate("+U+"deg)");}}},getFormats:function R(){if(!this.fmts){this.fmts=L.call(this,this.defn,this.thresholdId);}return this.fmts;},clearFormats:function A(){this.fmts=undefined;},createEmptyFormats:function(){return(this.fmts=this.fmts||{});},clearCache:function Q(){delete this.defn[this.getCacheKey()];},unrender:function M(S){if(this.thresholdId){this.fmts=null;}this._super(S);}});mstrmojo._Formattable.getBorderWidths=function(W){var V=W.getFormats(),S=(V.border)?V.border.match(/(\d*|\d*\.\d*)pt/)[0]:V["border-width"],U=W.model,T=U.docModel;return O.getBorderWidths(S,(T&&T.dpi)||U.dpi);};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.fx");var Y=mstrmojo.css,H=mstrmojo.dom,O=mstrmojo.array,K={v:{styleDim:"height",styleDir:"top",dimension:"h",position:"y",scroll:"scrollTop",scrollDimension:"scrollHeight",cls:"vertical",hostCls:"hasVertical",scrollNodeCls:"hasVertical"},h:{styleDim:"width",styleDir:"left",dimension:"w",position:"x",scroll:"scrollLeft",scrollDimension:"scrollWidth",cls:"horizontal",hostCls:"hasHorizontal",scrollNodeCls:"hasHorizontal"}},W="scrollingMode",R="scrolling",b=3;var L=H.getOSInfo().name.toLowerCase().indexOf("mac")>=0;function J(){return(this.scrollbarHostNode||(this.scrollNode&&this.scrollNode.parentNode));}function P(d,c){var j=H.eventTarget(c,d),g=this.scrollNode,f=H.position(g),h=this.scrollTrackNodes,e=this.scrollBarNodes,k=function k(t){var q=j===h[t];if(q){var u=K[t],l=e[t],v=H.position(l),n=H.getMousePosition(d,c)[u.position],o=n-v[u.position],m=o>0?1:-1,r=g[u.scrollDimension],w=Math.abs(o-(v.h/2))*(r/f[u.dimension]),p={};p[u.scroll]={isStyle:false,start:g[u.scroll],stop:g[u.scroll]+(m*Math.min(r/3,500,w)),ease:mstrmojo.ease.linear};(new mstrmojo.fx.AnimateProp({props:p,duration:200,interval:10,target:g})).play();}};k.call(this,"h");k.call(this,"v");}function B(d,c){var g=this.scrollNode,f=d.type==="mousewheel",e=f?-1:1;mstrmojo.array.forEach(["h","v"],function(o){var m=K[o],j=f?"wheelDelta":"delta",l=d[j+{h:"X",v:"Y"}[o]]*e,k=Math.abs(l),h=l/k,n=k===3&&H.isFF&&!L;g[m.scroll]+=n?h*40:l;});H.stopPropogation(c,d);H.preventDefault(c,d);}function a(h){var g=K[h],f=this.scrollNode,e=H.position(f),d=e[g.dimension],j=f[g.scrollDimension],c=Math.ceil(d)/j;return A(c,d,j);}function A(d,c,e){return(!isNaN(d)&&d<1)&&(Math.abs(c-e)>b);}function C(AA){var r="px",l=K[AA],e=this.scrollNode,m=J.call(this),AB=H.position(e),n=AB[l.dimension],u=e[l.scrollDimension],d=Math.ceil(n)/u,z=this.scrollBarNodes,j=z[AA],p=this.scrollTrackNodes,q=p[AA],w=A(d,n,u),f=l.cls;if(!j){q=p[AA]=document.createElement("div");var g=this,o=function(AD){P.call(g,AD);},k=function(AD){B.call(g,AD);},v=function(AF,AD,AE){H.attachEvent(AF,AD,AE);g.installedEventListeners.push({e:AF,evt:AD,fn:AE});};v(q,"click",o);q.className="mstrmojo-scrolltrack "+f;j=z[AA]=document.createElement("div");j.className="mstrmojo-scrollbar "+f;q.appendChild(j);m.appendChild(q);var x=mstrApp.isSingleTier?"mousewheel":"wheel";v(q,x,k);v(j,x,k);}var AC=j.style,h=(e[l.scroll]/e[l.scrollDimension]),c=H.delta(e,J.call(this))[l.position],t=q.style;if(w){t[l.styleDir]=c+r;AC[l.styleDim]=(d*n)+r;AC[l.styleDir]=(n*h)+r;}Y.toggleClass(m,l.hostCls,w);Y.toggleClass(e,l.scrollNodeCls,w);return w;}function G(){return !(mstrApp.isSingleTier&&L);}mstrmojo.ui._HasScroller=mstrmojo.provide("mstrmojo.ui._HasScroller",{_mixinName:"mstrmojo.ui._HasScroller",hasCustomScrollbar:null,draggable:true,ownAvatar:true,scrollNode:undefined,scrollbarHostNode:undefined,scrollBarNodes:undefined,setupScrollNodes:mstrmojo.emptyFn,installedEventListeners:null,init:function T(c){this._super(c);if(this.hasCustomScrollbar===null){this.hasCustomScrollbar=G();}this.installedEventListeners=[];},onRender:function I(){if(this._super){this._super();}this.updateScrollbars();this.addScrollNodeProperties();},addScrollNodeProperties:function F(){var d=this.scrollNode;if(d){var c=H.attachMarkupEvent(this.id,d,"scroll");this.installedEventListeners.push({e:d,evt:"scroll",fn:c});}if(!this.hasCustomScrollbar){Y.addClass(d,"mstrmojo-sb-show-default");return ;}if(d){Y.addClass(J.call(this),"mstrmojo-scrollbar-host");Y.addClass(d,"mstrmojo-scrollNode");}},updateScrollbars:function Z(){if(!this.hasRendered){return ;}this.setupScrollNodes();if(!this.hasCustomScrollbar){if(this.scrollNode){this.scrollNode.style.overflowX=a.call(this,"h")?"scroll":"hidden";}return ;}if(this.scrollNode){this.scrollBarNodes=this.scrollBarNodes||{};this.scrollTrackNodes=this.scrollTrackNodes||{};var c=this.scrollNode.style;c.overflowY=C.call(this,"v")?"scroll":"hidden";c.overflowX=C.call(this,"h")?"scroll":"hidden";}},onscroll:function V(){var k=this.scrollNode;if(k&&this.hasCustomScrollbar){var g=function g(l){var m=parseInt(l);return m===null||isNaN(m)?0:m;},h=H.position(k),j=h.h-g(Y.getStyleValue(k,"padding-bottom")),d=h.w-g(Y.getStyleValue(k,"padding-right")),f=this.scrollBarNodes,e=f.v,c=f.h;if(k.scrollHeight-j>0){e.style.top=((j-H.position(e).h)*(k.scrollTop/(k.scrollHeight-j)))+"px";}if(k.scrollWidth-d>0){c.style.left=((d-H.position(c).w)*(k.scrollLeft/(k.scrollWidth-d)))+"px";}}if(this._super){this._super();}if(this.onScrollEnd){this.onScrollEnd();}},getDragData:function E(d){var g=this.scrollNode,f=H.position(g),e=d.src.node,c=this.scrollBarNodes;if(this.isDraggingScrollBar(d)){return{isScrollBar:true,direction:e===c.v?"v":"h",scrollTop:g.scrollTop,scrollLeft:g.scrollLeft,conversionRatio:{y:g.scrollHeight/f.h,x:g.scrollWidth/f.w}};}return(this._super&&this._super(d));},isDragValid:function D(c){return this.isDraggingScrollBar(c)||(this._super&&this._super(c))||false;},isDraggingScrollBar:function S(d){var e=d.src.node,c=this.scrollBarNodes;return !!c&&(e===c.v||e===c.h);},ondragstart:function X(c){if(this.isDraggingScrollBar(c)){Y.addClass(c.src.node,R);Y.addClass(J.call(this),W);}if(this._super){this._super(c);}},shouldDragBubble:function Q(c){var d=c.src.node,e=this.scrollTrackNodes;return !!e&&(d===e.v||d===e.h);},ondragmove:function N(d){if(this.isDraggingScrollBar(d)){var m=d.tgt,c=d.src,n=m.pos,e=c.pos,j=c.node,h=this.scrollNode,l=this.scrollBarNodes,k=c.data,g={y:(n.y-e.y),x:(n.x-e.x)},f=k.conversionRatio;if(j===l.v){h.scrollTop=k.scrollTop+(g.y*f.y);}else{h.scrollLeft=k.scrollLeft+(g.x*f.x);}}if(this._super){this._super(d);}},ondragend:function N(c){if(this.isDraggingScrollBar(c)){Y.toggleClass(c.src.node,R,false);Y.toggleClass(J.call(this),W,false);}if(this._super){this._super(c);}},widgetResized:function M(){if(this._super){this._super();}this.updateScrollbars();},unrender:function U(c){O.forEach(this.installedEventListeners,function(d){H.detachEvent(d.e,d.evt,d.fn);});delete this.scrollNode;delete this.scrollbarHostNode;delete this.scrollBarNodes;delete this.scrollTrackNodes;this._super(c);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo.css","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.elementHelper");var R=mstrmojo.css,O=mstrmojo.hash,G=mstrmojo.dom,L=mstrmojo.array,A=mstrmojo.chart.model.enums.EnumDSSObjectType,Q=mstrmojo.elementHelper,S={cssClass:"grpHlt",top:"grpT",bottom:"grpB",left:"grpL",right:"grpR",midHoriz:"grpMidH",midVert:"grpMidV"},F=function(Y,X){var V=this.zone;X=X||(V&&V.tableNode);if(X){var W=[],Z=X.tBodies,a=function(d,c){var f=d.length,b=-1,e;while(f-b>1){if(d[e=f+b>>1].getAttribute("ei")<c){b=e;}else{f=e;}}return(d[f]&&parseInt(d[f].getAttribute("ei"),10)===c)?d[f]:null;};L.forEach(Y,function(c){var f=c._ei,d;for(d=0;d<Z.length;d++){var b=Z[d],e=a(b.getElementsByClassName(c.css),f);if(e){W.push(e);}}});return W;}return[];},E=function(V){var X=this.model.getCellDataUnion(V),W={};L.forEach(X,function(Y){W[Y.tid]=[{id:Y.eid,n:Y.v}];});return W;},T=function(a){var Z=a[O.keyarray(a)[0]],V=O.keyarray(Z),X,Y=this,W=this.model,b={};return F.call(this,L.filter(this.interactiveCellsArray,function(d){if(d.hasOwnProperty("mix")){var e=E.call(Y,d);X=L.filter(V,function(f){var g=W.getLinkedAttributes(f),h=false;if(!!e[f]){b[f]=f;h=true;}else{L.forEach(g,function(j){if(!!e[j]){b[f]=j;h=true;return false;}});}return h;});var c=false;O.forEach(a,function(f){L.forEach(X,function(g){if(!W.compareElementsId(e[b[g]][0].id,f[g][0].id)){c=false;return false;}c=true;});if(c){return false;}});return c;}return false;}));},C=function(Z,d){var e=(function(){var g=[];O.forEach(Z,function(h){O.forEach(h,function(j,k){L.forEach(j,function(l){g.push([k,l.id]);});});});return g;}()),c,a=this,V=L.filter(this.interactiveCellsArray,function(h){c=false;var j=!h.hasOwnProperty("mix")&&h._e&&h.fi===undefined,g=!j&&E.call(a,h);if(j){L.forEach(e,function(k){if((!d||a.model.getCellTitleInfo(h).title.id===k[0])){c=a.model.compareElementsId(h._e.id,k[1]);}if(c){return false;}});}else{if(!d&&g){O.forEach(g,function(k){L.forEach(e,function(l){L.forEach((k||[]),function(m){if(m.id){c=a.model.compareElementsId(m.id,l[1]);}});if(c){return false;}});if(c){return false;}});}}return c;}),b=F.call(this,V),f=[],Y,X,W;if(d){f=b;}else{L.forEach(b,function(g){Y=V[L.find(V,"_ei",g.getAttribute("ei"))];if(Y.axis===1){var k=0,j=g.rowSpan||1,h=g.parentNode;do{W=h.childNodes;for(X=0;X<W.length;X++){f.push(W[X]);}}while((++k<j)&&(h=h.nextSibling));}else{f.push(g);}});}return f;},K=function(V){if(!this.getFormatTargetFromCell){return[];}var W=this.id;return F.call(this,L.filter(this.interactiveCellsArray,function(X){return mstrmojo.all[W].getFormatTargetFromCell(X)===V;}));},J=function(){var X=[],Y;if(this.getFormatTargetFromCell){L.forEach(this.interactiveCellsArray,function(Z){if(this.getFormatTargetFromCell(Z)!==2){return false;}X.push(Z);return true;},this);}var W=this.xtabClonedNodes;if(W){var V=L.filterOne(W,function(Z){return Z.lockType===2;});if(V){Y=V.domNode.getElementsByTagName("table")[0];}}return F.call(this,X,Y);},H=function(V,W,Y){var X=["xtabSel"].concat(G.isIE||G.isIEW3C?"ie":[],"sc_"+this.k);if(!W||Y){X.push("range");}if(!W){X=X.concat(O.valarray(S));}R.toggleClass(V,X,W);};mstrmojo.vi.ui.rw._XtabHighlights=mstrmojo.provide("mstrmojo.vi.ui.rw._XtabHighlights",{_mixinName:"mstrmojo.vi.ui.rw._XtabHighlights",highlights:null,highlight:function I(X,Z,V){if(this._super){this._super.apply(this,arguments);}var Y=mstrmojo.vi.ui.rw.SelectionType,W=[];this.clearHighlights();switch(X){case Y.METRICS:W=T.call(this,Z);break;case Y.ATTS:W=C.call(this,Z,V);break;}this.highlightCells(W,V);},highlightRange:function U(W,Z){var X=mstrmojo.vi.ui.rw.SelectionType,Y=Z?this.highlights.slice():null,V=[];this.clearHighlights();switch(W){case X.COL_HEADERS:V=J.call(this);break;case X.ROW_HEADERS:V=K.call(this,3);break;case X.METRIC_VALUES:V=K.call(this,4);break;}L.forEach(V,function(c){var b=true;if(Y){var a=L.indexOf(Y,c);b=a===-1;if(!b){Y.splice(a,1);}}H.call(this,c,true,b);},this);this.highlights=V;},clearSelections:function D(){if(this._super){this._super();}this.clearHighlights();},clearHighlights:function B(){L.forEach(this.highlights,function(a){H.call(this,a,false);},this);this.highlights=[];try{var W=this.getCellForNode(this.lastSelectedCell),Z=W&&this.gridData.gts[W.axis===1?"row":"col"],V=Z&&Z[W.tui||W.ui],X=V&&V.id;if(X){this.zone.clearHilites(X);}}catch(Y){}},highlightCellsById:function N(a,Z,Y){var X=this.model,V=function(b,c,d){return b[c]&&b[c]._e&&b[c]._e[d]===a;},W=F.call(this,L.filter(this.interactiveCellsArray,function(c){var b=false;if(Z===A.DssTypeMetric){b=V(c,"_tp","oid")||V(c,"_lp","oid");}else{if(Z===A.DssTypeAttribute){if(Y){b=V(c,"_tp","id")||V(c,"_lp","id");}else{if(X&&X.getNormalizedFormElementId&&c._e&&c._e.id){b=Q.getAttributeId(X.getNormalizedFormElementId(c._e.id))===a;}}}}return b;}));this.clearHighlights();this.highlightCells(W);},highlightCells:function(W,V){if(this._super){this._super(W,V);}L.forEach(W,function(X){H.call(this,X,true);},this);this.highlights=W;},configureActions:function M(){if(this._super){this._super();}if(!!this.selectorControl){this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}},highlightGroupCells:function P(W,V){var X=[];L.forEach(W,function(Z){var d=Z[0]&&Z[0].axis||1,e=(d===1),a=this[e?"clonedRowHeader":"clonedColHeader"],c=(a?a.getTableNode():this.zone.tableNode),b=F.call(this,Z,c),Y=b.length;X=X.concat(b);L.forEach(b,function(j,f){var h=S,g=[h.cssClass];if(Y>1){if(e){g.push(f>0?(f<Y-1?h.midVert:h.bottom):h.top);}else{g.push(f>0?(f<Y-1?h.midHoriz:h.right):h.left);}}R.addClass(j,g);},this);},this);this.highlights=X;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var D=1,B="mstrmojo-itemwrap";mstrmojo.ListMapperHoriz=mstrmojo.provide("mstrmojo.ListMapperHoriz",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table" cellspacing="0" cellpadding="0"><tbody><tr>',markupSuffix:"</tr></tbody></table>",itemWrapperPrefix:function(H){return'<td class="'+this.getWrapperCss(H)+'">';},getWrapperCss:function(H){return"mstrmojo-itemwrap-td";},itemWrapperPrefill:"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",itemWrapperSuffix:"</td>",wrapperNodes:function G(H){return this.wrapperParentNode(H).cells;},wrapperParentNode:function F(H){return H.firstChild.rows[0];},createWrapperNode:function E(H){var I=H.ownerDocument,J=I.createElement("td");return J;},findScrollRange:function C(U,L,S,X,I,P,Y,W){var Q=this.wrapperNodes(U),R=parseInt(L/2,10),K=parseInt(Math.log(L)/Math.log(2),10),J=0,H=L-1,T=I+P,M=Q[0].offsetLeft,O;for(var V=1;V<=K;V++){O=Q[R].offsetLeft-M+Y;if(O<=I){J=R;}else{if(O>=T){H=R;}}var N=Math.round(L/Math.pow(2,V+1));R+=(O>I)?-N:N;R=Math.min(Math.max(0,R),L-1);}return{start:J,end:H};},findIndex:function A(I,M,K){if(M&&K){var H=I.domNode,L=this.wrapperParentNode(M),J=K.parentNode;while(J){if(J===L){return mstrmojo.array.findBin(this.wrapperNodes(M),K,"offsetLeft",I.items&&I.items.length);}else{if(J===H){break;}}K=J;J=K.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.WidgetListBuilder");mstrmojo.WidgetTreeBuilder=mstrmojo.provide("mstrmojo.WidgetTreeBuilder",mstrmojo.mixin({newContext:function A(B){var D=this._super(B);if(!B.itemFunction&&D.itemFunc){var C=D.itemFunc;D.itemFunc=function(G,F,H){var E=C(G,F,H);if(E){E.tree=H.tree||H;}return E;};}return D;}},mstrmojo.hash.copy(mstrmojo.WidgetListBuilder)));})();(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.dom","mstrmojo.array");var R=Math,U=mstrmojo.publisher.hasSubs,Q=mstrmojo.hash,F=Q.forEach,a=mstrmojo.dom;var S=0.15;var d=1,T=2;var B={y:{edge:["top","bottom"],size:0},x:{edge:["left","right"],size:0},clsName:"mstrmojo-touch-scroll-indicator",init:function Y(){var h=this.y,g=this.x;if(!h.i){var j=h.i=document.createElement("div");j.className=this.clsName;var k=g.i=j.cloneNode(false);document.body.appendChild(j);document.body.appendChild(k);}},setGradient:function Z(o,j,p,l){var n=o.i,h=o.edge[j?1:0];var m=R.min(R.round(R.min(R.abs(p)/200,1)*100),l/2),g="left top",k="left bottom";if(j){k=g;if(h==="bottom"){g="left bottom";}else{g="right top";}}else{if(h==="left"){k="right top";}}if(m!==o.size){n.style.background="-webkit-gradient(linear, "+g+", "+k+", from(rgba(39, 104, 162, .4)), to(rgba(39, 104, 162, 0)), color-stop("+(m/100)+", rgba(39, 104, 162, 0)))";o.size=m;}},scrollAxis:function D(k,u,m,r,j){var AA=u-m,h=j[k]=(AA!==0);if(!h){this.hide(k);return ;}var n=this[k],q=n.i,g=q.style,o=(k==="y"),p=(AA>0),t=this.clsName+" "+n.edge[p?1:0];if(!n.size||q.className!==t){q.className=t;var v="px",AB=3,w=r.y,l=r.x,x=100,z=r.w;if(o){if(p){w+=r.h-x-AB;}}else{z=x;x=r.h;if(p){l+=r.w-z-AB;}}g.top=w+v;g.left=l+v;g.width=z+v;g.height=x+v;g.display="block";}this.setGradient(n,p,AA,o?r.h:r.w);},scroll:function D(k,j,n,m,q){var p=j.x,o=j.y;if(p!==n||o!==m){this.init();var l=this._widgetPosition;if(!l){var g=k.indicatorEl||q;l=mstrmojo.dom.position(g.parentNode);}var h=k._outOfBounds||{};this.scrollAxis("y",o,m,l,h);this.scrollAxis("x",p,n,l,h);this._widgetPosition=l;k._outOfBounds=h;}else{this.hideAll();delete k._outOfBounds;}},hide:function M(h){var g=this[h];if(g.size!==undefined){g.i.style.display="none";g.i.className=this.clsName;g.size=0;}},hideAll:function b(){this.hide("y");this.hide("x");delete this._widgetPosition;}};function W(g,h){return h?R.max(R.min(R.round(g),h.end),h.start):g;}function O(g,j,h){h.name=j;h.id=g.identifier;g.raiseEvent(h);}function G(){var h="scrollDone",g=this.origin;if(U(this.id,h)&&g){O(this,h,{x:g.x,y:g.y});}this.stopDeceleration();}function I(j,h,m){var l=j.scrollEl;if(!l){G.call(j);return ;}var k={x:h.x||0,y:h.y||0};F(j._scrollBarEls,function(AA,t){var AF=(t==="x"),z=k[t],n=AA.length,AB=AA.ratio,w=AA.viewportSize,r=6/n,q=AA["base"+(AF?"Left":"Top")],x=q+w-n,p=R.round(q+(AB*z));if(p<q){p=q-z;n+=z;}else{if(p>x){var AE=(z-j.offset[t].end)*AB;p=R.min(x+AE,w+q-6)-1;n-=AE;}}var AD=0,o=[AD,AD,AD],u=[1,1,1],AC=AF?0:1;o[AC]=(p-q);u[AC]=R.min(R.max(n/AA.length,r),1);a.translate(AA,o[0],o[1],o[2]," scale3d("+u.join(",")+")");});if(m){m+="ms";}if(j._isHosted){var g=l.parentNode;g.scrollTop=k.y;g.scrollLeft=k.x;}else{l.style[a.CSS3_TRANSITION_DURATION]=m||"0";a.translate(l,-k.x,-k.y,0,j.transform,j.useTranslate3d);}if(U(j.id,"scrollMoved")){O(j,"scrollMoved",{x:h.x,y:h.y});}}function J(g,h,j){return R.ceil(1+R.log(g/R.abs(h))/R.log(1-j));}function E(g,l,j,h,k){return g+(l*(j*(1-R.pow(1-k,h))/k));}function N(AF,AP,m,AL,w,AK,r){var q=AF.offset[m];if(!q){return AP;}var l=AF._outOfBounds,h=l&&l[m],u=q.incFetch,v=AF.friction,p=q.start,o=q.end,AG=AL?o:p;w=R.abs(w);if(h){AL=(AP<p);AG=AL?p:o;}var AO=AL?1:-1;if(h&&(AL||!u)){var t=S*3,AN=1/(1-v),k=t/R.pow((1-v),(R.log(1-R.abs(AP-AG)*(1-AN)/t)/R.log(AN))-1);var AD=R.round(E(AP,AO,k,AK,v));if(AL?(AD>=AG):(AD<=AG)){G.call(AF);return AG;}return AD;}var AJ=q.pageSize,AI=q.supportedEdges;var n=E(AP,AO,w,AK,v),x=(n<=p),j=(n>=o);if(x||j){if(u&&((x&&((AI&d)>0))||(j&&((AI&T)>0)))){if(n-o>=AJ){n=o+AJ;AG=n;}if(!AF.STATUS_INC_FETCH){AF.STATUS_INC_FETCH=true;O(AF,"incFetch",{edge:j?T:d});}}else{if(AF.bounces){var AM=v*2,z=AF.bounceVelocity,g=AF.bounceTime,AH=AF.bounceDistance;if(!AF.hasBounced){z[m]=R.abs(S/R.pow(1-v,r-AK-1));g[m]=J(S,z[m],AM);AH[m]=R.abs(E(n,AO,z[m],g[m],AM)-n);AF.raiseEvent({name:"bounceOut",id:AF.identifier,axis:m,direction:AL,value:R.round(n)});AF.hasBounced=true;}var AC=Math.floor(AH[m]/2);var AB=E(AG,AO,z[m],AK,AM),AE=R.abs(AB-AG);if(R.abs(AE)<AC){return AB;}if(R.abs(AE)>=AH[m]){G.call(AF);return AG;}var AA=AC-(AE-AC);return R.round(AG-(AL?-AA:AA));}n=AG;}}return R.round(n);}function P(h){var g=this._scrollListener;if(g){if(!h||h!==g.el){a.detachEvent(g.el,"scroll",g.fn);delete this._scrollListener;return true;}return false;}return true;}mstrmojo.TouchScroller=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.TouchScroller",scrollEl:null,identifier:"",hScroll:false,vScroll:false,offset:null,origin:null,transform:"",friction:0.0015,frameRate:60,bounces:true,hasBounced:false,bounceDistance:{},bounceTime:{},bounceVelocity:{},showScrollbars:false,showIndicators:true,useTranslate3d:true,STATUS_INC_FETCH:false,init:function Y(g){this._super(g);B.init();},initScroller:function X(h){Q.copy(h,this);var l=this.scrollEl;if(l){var k=this._isHosted=false;if(k){var g=l.parentNode;if(P.call(this,g)){g.style.overflow="auto";var m=this.id,j=this._scrollListener={el:g,fn:function(n){var o=mstrmojo.all[m].origin,p=n.target;o.x=p.scrollLeft;o.y=p.scrollTop;}};a.attachEvent(g,"scroll",j.fn);}this.showScrollbars=false;}}},canScroll:function L(){return this.vScroll||this.hScroll;},updateScrollBars:function H(o,k){var m=this.scrollEl;if(!this.showScrollbars||!m){return ;}var h=this._scrollBarEls;if(!h){var l=this;h=this._scrollBarEls={x:"hScroll",y:"vScroll"};F(h,function(p,q){if(l[p]){var r=document.createElement("div");r.className="mstrmojo-touch-scrollBar "+q+"Axis";(k||m.parentNode).appendChild(r);h[q]=r;}else{delete h[q];}});}if(!o){var g=this.scrollEl.parentNode;o={top:0,right:g.clientWidth,bottom:g.clientHeight,left:0};}var n=9,j={x:{left:o.left,top:o.bottom-n,x:o.right-o.left,d:"Width"},y:{left:o.right-n,top:o.top,x:o.bottom-o.top,d:"Height"}};F(h,function(v,r){var AC=v.style,AA=j[r],t=AA.d,u=v.parentNode,AB=AA.x;var q=AA.left,z=AA.top,w=AB/m["offset"+t],p=Math.min(Math.round(AB*w),AB);v.baseLeft=q;v.baseTop=z;v.ratio=w;v.viewportSize=AB;v.length=p;AC.left=q+"px";AC.top=z+"px";AC[t.toLowerCase()]=p+"px";});},toggleScrollBars:function C(g){F(this._scrollBarEls,function(h){h.style.opacity=g?1:0;});},scrollTo:function(h,m,k){if(!this.canScroll()&&!(h===0&&m===0)){I(this,{x:0,y:0});return ;}var l=this.offset,j=this.origin,g={x:(this.hScroll)?W(h,l.x):0,y:(this.vScroll)?W(m,l.y):0};I(this,g,k);j.x=g.x;j.y=g.y;},scrollToEnd:function(h,m,k){var j=this.origin,l=this.offset,g={x:0,y:0};if(j&&l){mstrmojo.array.forEach([h,m],function(o,n){var q=n?"y":"x",p=l[q];g[q]=o?(p&&p.end)||0:j[q];});}this.scrollTo(g.x,g.y,k);},scroll:function D(m){if(this._isHosted){return ;}var k=this.offset,u=this.scrollEl,w=m.delta,x=w.x,v=w.y;if(!u){return ;}if(!k&&this.showIndicators){B.scroll(this,{x:(this.noHScroll)?0:-x,y:(this.noVScroll)?0:-v},0,0,u);return ;}var t=this.origin,n={x:(this.hScroll)?R.round(t.x-x):0,y:(this.vScroll)?R.round(t.y-v):0},q=W(n.x,k.x),p=W(n.y,k.y);if(!k.scrollPast){if(this.showIndicators){B.scroll(this,n,q,p,u);}n.x=q;n.y=p;}else{var l=(q!==n.x),o=(p!==n.y),g=(l||o),j=this._outOfBounds,h="";if(j){if(l!==(j.x===true)||o!==(j.y===true)){h="scrollIn";}}else{if(g){h="scrollOut";}}if(h){if(U(this.id,h)){var r=m.direction;O(this,h,{x:{position:n.x,direction:r.x},y:{position:n.y,direction:r.y}});}if(g){this._outOfBounds={x:l,y:o};}else{delete this._outOfBounds;}}}I(this,n);},scrollEnd:function V(v){B.hideAll();if(!this.canScroll()||this._isHosted){return ;}var AE=this.id,w=this.friction,AM=1/(1-w),AF=this.origin,k=v.velocity,AK=v.direction,AD=new Date(),l=this._outOfBounds,r=this.offset,AL={x:this.hScroll,y:this.vScroll},x={},AO={},AN={},t={},n={},u={},p={},o={},AH={},AJ=function(AR){u[AR]=S;var AQ=r[AR],AP=(l&&l[AR]),AS=(AP&&(!AQ||!r.scrollPast));AO[AR]=(AL[AR]&&!AS)?AF[AR]-v.delta[AR]:AF[AR];if(AQ){p[AR]=AQ.start;o[AR]=AQ.end;if(AP){if(!AS){AK[AR]=(AO[AR]<p[AR]);AH[AR]=(AK[AR])?p[AR]:o[AR];if(AK[AR]||!AQ.incFetch){u[AR]=S*3;k[AR]=u[AR]/R.pow((1-w),(R.log(1-R.abs(AO[AR]-AH[AR])*(1-AM)/u[AR])/R.log(AM))-1);}}else{AO[AR]=W(AF[AR]-v.delta[AR],AQ);}}}x[AR]=(AL[AR]&&!AS)?R.abs(k[AR]):0;AN[AR]=(AK[AR]||false)?1:-1;t[AR]=J(u[AR],x[AR],w);n[AR]=E(AO[AR],AN[AR],x[AR],t[AR],w);};AJ("x");AJ("y");AF.x=AO.x;AF.y=AO.y;var AB=(x.x>0),AA=(x.y>0);if(!r.scrollPast&&!AB&&!AA){G.call(this);var m,AG,z,j,AI;for(m in r){AG=r[m];AI=AG.supportedEdges;z=((AG.start===AO[m])&&((AI&d)>0));j=((AG.end===AO[m])&&((AI&T)>0));if(AG.incFetch&&(z||j)){this.STATUS_INC_FETCH=true;O(this,"incFetch",{edge:j?T:d});}}return ;}this.hasBounced=false;this.bounceDistance={};this.bounceTime={};this.bounceVelocity={};this.decelerating=true;var h=Math.round(1000/this.frameRate),q=AD,AC,g={x:AB,y:AA};this.decelerationTimer=window.setTimeout(function(){var AP=mstrmojo.all[AE],AQ=AP.origin,AU=new Date(),AV=(AU-AD),AT;if(AP._halt){G.call(AP);return ;}AC=AU-q;q=AU;if(AC>(h+5)){h=h+R.round((AC-h)/2);}for(AT in g){if(g[AT]){var AS=N(AP,AO[AT],AT,AK[AT],x[AT],AV,t[AT]);if(!isNaN(AS)){AQ[AT]=AS;}}}I(AP,AQ);var AR=(AV>t.x&&AV>t.y);if(!AR&&!AP.bounces){AR=true;mstrmojo.hash.forEach(r,function(AY,AX){var AW=AQ[AX];if(AW!==AY.end&&AW!==AY.start){AR=false;return false;}});}if(AR){G.call(AP);}else{if(AP.decelerating){AP.decelerationTimer=window.setTimeout(arguments.callee,h);}}},h);},stopDeceleration:function A(){var g=!!this.decelerating;if(g){if(this.decelerationTimer){window.clearTimeout(this.decelerationTimer);delete this.decelerationTimer;}delete this.decelerating;this.toggleScrollBars(false);}delete this._outOfBounds;delete this.hasBounced;delete this.bounceDistance;delete this.bounceTime;delete this.bounceVelocity;delete this._halt;return g;},haltScroller:function K(){this._halt=!!this.decelerating;},unrender:function c(){delete this.scrollEl;},destroy:function e(){this.stopDeceleration();P.call(this);this._super();}});mstrmojo.TouchScroller.getScrollPositionTotals=function f(l){var j=l.parent,g=l._scroller,h=mstrmojo.hash.copy((g&&g.origin)||{x:0,y:0});if(j){var k=mstrmojo.TouchScroller.getScrollPositionTotals(j);h.x+=k.x;h.y+=k.y;}return h;};mstrmojo.TouchScroller.ScrollIndicators=B;mstrmojo.TouchScroller.EnumIncFetchEdges={start:d,end:T};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo._HasChildren","mstrmojo.Binding","mstrmojo._HasBindings");mstrmojo.Model=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasChildren,mstrmojo._HasBindings],{scriptClass:"mstrmojo.Model",init:function A(C){this._super(C);if(this.children){this.initChildren();}if(!this.parent){this.initBindings();}},destroy:function B(C){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(C);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Obj","mstrmojo.string","mstrmojo.hash","mstrmojo.expr","mstrmojo.mstr.EnumNodeDimty");var D=mstrmojo.array,P=mstrmojo.expr,J=P.ET,I=P.TP,K=mstrmojo.mstr.EnumNodeDimty,N=P.ET2TGT,M=P.ET2COND,B=mstrmojo.meta.TP;function O(S,A){var R=(A&&A.did)?A.did.split(P.FN_SEP):null,E=R&&parseInt(R[0],10),Q=R&&parseInt(R[1],10),T=S.et;S.fnt=E;S.fn=Q;if(T!=J.AE&&P.fn_List(Q,E)){S.et=J.AL;S.a2=null;S.cs=null;}else{if(T==J.AL&&!P.fn_List(Q,E)){S.et=J.AQ;S.cs=null;}else{if(T==J.MC&&!P.fn_AC_MC(Q,E)){S.et=J.MQ;S.m2=null;}else{if(T==J.AC&&!P.fn_AC_MC(Q,E)){S.et=J.AQ;S.a2=null;}}}}switch(Q){case P.FN.IS_NULL:case P.FN.IS_NOT_NULL:S.a2=null;S.a3=null;S.fm2=null;S.fm3=null;S.m2=null;S.m3=null;S.cs=null;break;case P.FN.BETWEEN:case P.FN.NOT_BETWEEN:break;default:S.a3=null;S.fm3=null;S.m3=null;while(S.cs&&S.cs.length>1){S.cs.pop();}}}function F(W,X,Y){var E=true,A=2+X;switch(Y.t){case I.PROMPT:var U=W.cs,V;if(!U){U=[];W.cs=U;}U[X]={};V=U[X];V.p=Y;W["a"+A]=null;W["m"+A]=null;switch(W.et){case J.AC:W.et=J.AQ;break;case J.MC:W.et=J.MQ;break;}break;case I.METRIC:W["a"+A]=null;W.cs=null;W.et=J.MC;W["m"+A]=Y;break;case I.ATTR:W["m"+A]=null;W.cs=null;W.et=J.AC;W["a"+A]=Y;W["fm"+A]=null;break;default:W["a"+A]=null;W["m"+A]=null;var U=W.cs;if(!U){U=[];W.cs=U;}if("did" in Y){W["a"+A]=null;W["fm"+A]=null;W["m"+A]=null;if(U[X]&&U[X].p){U[X].p=null;}}else{if(Y&&Y.v!=null){U[X]=Y;}else{if(U[X]){U=U.splice(X,1);}}E=false;}if(!Y.skipET){switch(W.et){case J.MC:W.et=J.MQ;break;case J.AC:W.et=J.AQ;break;case J.AL:if(!("did" in Y)&&Y.v){var Q,S=Y.dtp,U=[];Q=Y.v.split(mstrConfig.listSep);for(var R=0,T=Q.length;R<T;R++){U.push({v:mstrmojo.string.trim(Q[R]),dtp:S});}W.cs=U;}break;}}}return E;}var H={};H[J.AQ]={target:1,fm:1,fn:1,cs:1};H[J.AL]={target:1,fm:1,fn:1,cs:1};H[J.AE]={target:1,fn:1,es:1};H[J.AC]={target:1,a2:1,a3:1,fm:1,fm2:1,fm3:1,fn:1};H[J.MQ]={target:1,fn:1,cs:1,dmy:1};H[J.MC]={target:1,fn:1,m2:1,m3:1,dmy:1};H[J.F]={target:1};H[J.R]=H[J.F];H[J.XML]={target:1};var G=function(A){return A!==null&&A!==undefined;};var L=function(W){if(!W||!G(W.et)){return false;}var V=true,A=H[W.et],T=W.cs,S;V=V&&(!A.target||W[N[W.et]]);V=V&&(!A.fm||W.fm);V=V&&(!A.fn||G(W.fn));var R=P.fnCstCount(W.fn,W.fnt);if(V&&A.cs){for(S=0;S<R;S++){V=V&&T&&G(T[S]);}}if(V){var U=[N[W.et],"fm"];for(var E=0;E<2;E++){for(S=0;S<R;S++){var X=U[E]+(2+S);V=V&&(!A[X]||W[X]);}}}V=V&&(!A.es||W.es&&(W.es.length>0));var Q=W.dimtyTypes;V=V&&(!A.dmy||Q[K.NodeDimtyUnspecified]||Q[K.NodeDimtyNone]||(Q[K.NodeDimtyOutputLevel]&&W.dmy&&W.dmy.uts&&(W.dmy.uts.length>0)));return V;};mstrmojo.ConditionModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ConditionModel",completed:false,init:function(A){if(this._super){this._super(A);}this._updateCompleted();},edit:function(l,Y){var S=this[l],k=true;this.etWas=this.et;switch(l){case"not":Y=!!(Y&&Y.did===P.FN.NOT);S=!!this.not;if(Y===S){return ;}this.not=!!Y||null;break;case"target":var AC=this.et;if(Y){switch(Y[B]){case I.ATTR:case I.CONS:S=this.a;if(AC!==J.AQ&&AC!==J.AE){this.et=J.AQ;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}if(AC!==J.AE){this.fn=null;this.fnt=null;}this.fm=null;this.fm2=null;this.fm3=null;this.cs=null;break;case I.METRIC:S=this.m;if((AC!==J.MQ)&&(AC!==J.MC)){this.et=J.MQ;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.r=null;this.f=null;this.cs=null;this.dmt=K.NodeDimtyUnspecified;}this.m2=null;break;case I.REPORT:S=this.r;if(AC!==J.R){this.et=J.R;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.f=null;}break;case I.FILTER:S=this.f;if(AC!==J.F){this.et=J.F;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;}break;case I.PROMPT:S=this.prms&&this.prms[0];if(AC!==J.XML){this.et=J.XML;this.fm=null;this.fm2=null;this.fm3=null;this.fn=null;this.fnt=null;this.a=null;this.a2=null;this.a3=null;this.m=null;this.m2=null;this.m3=null;this.r=null;this.f=null;}break;}}this.es=null;this[N[this.et]]=Y;break;case"fm":if(Y&&Y[B]==="fn"){this.et=J.AE;this.fm=null;O(this,Y);}else{this.fm=Y;if(Y&&(this.et==J.AE)){this.et=J.AQ;}this.fnt=null;this.fn=null;this.cs=null;this.a2=null;this.fm2=null;}break;case"fm2":case"fm3":this[l]=Y;break;case"fn":O(this,Y);break;case"es":var AF=this.es;if(Y&&Y.removed&&AF){D.removeItems(AF,Y.itemIdField,Y.removed);}if(Y&&Y.added){if(!AF){AF=Y.added.concat();this.es=AF;}else{D.insert(AF,AF.length,Y.added);}}break;case"c0":k=F(this,0,Y);break;case"c1":k=F(this,1,Y);break;case"dmy":var z=this.dmy;if(!z){z={cc:true,fres:true,uts:[]};this.dmy=z;}var t=z&&z.uts;if(!t){t=[];z.uts=t;this.dmt=K.NodeDimtyOutputLevel;}var Q={};Q[P.TP.ATTR]=true;Q[P.TP.DIM]=true;if(Y&&Y.removed){var f=[],A=false,W=[],R=false;for(var j=0,T=Y.removed,E=T.length;j<E;j++){var V=T[j],AB=V[B] in Q;if(AB){R=true;}else{A=true;}var h=AB?W:f;h.push(V);}if(A){D.removeItems(t,"did",f);}if(R){var AE={};for(var d=0,Z=t&&t.length;d<Z;d++){var X=t[d];if(X&&X.utgt){AE[X.utgt.did]=d;}}var U=[];for(var AA=0,x=W.length;AA<x;AA++){var g=AE[W[AA].did];if(g>-1){U.push(g);}}U.sort(D.numSorter);for(var q=U.length-1;q>-1;q--){t.splice(U[q],1);}}}if(Y&&Y.added){var AG=[],m=P.DMY_TP.DIM,p=P.DMY_TP.ATTR;for(var AD=0,w=Y.added,e=w.length;AD<e;AD++){var o=w[AD];AG.push((o[B] in Q)?{utgt:o,utp:o[B]===I.DIM?m:p,agg:1,flt:2,gb:true,rps:0,n:o.n}:o);}D.insert(t,t.length,AG);}break;}this._updateCompleted();if(k){this.raiseEvent({name:"edit",prop:l,value:Y,valueWas:S});}},get:function C(){var A=M[this.et]||[];A.push("et");return mstrmojo.hash.copyProps(A,this);},_updateCompleted:function(){this.set("completed",L(this));}});})();(function(){mstrmojo.requiresCls("mstrmojo.Obj");var B={TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_RIGHT:3,BOTTOM_LEFT:4};mstrmojo.ui.PopupConfig=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ui.PopupConfig",ENUM_CORNERS:B,isHostedWithin:true,position:null,hostProxyCssClass:"",hostId:"",hostElement:null,anchorElement:null,popupHandlers:null,alignment:null,alignWithAnchor:false,useTooltip:false,init:function E(F){this.clear();this._super(F);},setAlignment:function C(F,G){this.alignment={host:F,popup:G};},addPopupHandlers:function D(F,H,G){this.popupHandlers[F]={open:H,close:G};},clear:function A(){this.popupHandlers={};var F=this.ENUM_CORNERS;this.alignment={host:F.BOTTOM_LEFT,popup:F.TOP_LEFT};}});mstrmojo.ui.PopupConfig.ENUM_CORNERS=B;}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash");mstrmojo.touchManager=new mstrmojo.Obj({notify:function(r,t){return this.raiseEvent({name:"touchesBegin",srcId:r,touch:t});}});var V=mstrmojo.dom,o=V.attachEvent,p=V.detachEvent,B=Math,W=window.mstrConfig,Q=false,J=null,h=W&&W.allowDefaultTouches;var g=10,D=250,F=400,Y=100;var f="Begin",N="End",c="Move",S="Cancel";var l=1,m=2,C=3,P=4;var K={};K[l]="Select";K[m]="Swipe";K[C]="Multi";K[P]="Tap";o(document.body,V.TOUCHMOVE,function(r){if(!W||!W.allowDefaultTouches){if(r.preventDefault){r.preventDefault();return false;}}return true;});function X(r){var t=r.identifier;return(t===undefined)?1:t;}function j(v,w,u,t){if(Q){var r=t?X(t)+" ":"";window.console.log(v+":"+(u?" "+u.scriptClass+" "+u.id:"")+" "+r+(w||""));}}function k(r){return(J===r);}function T(r){if(!k(r)){return ;}j("detachWinEvts","",r);p(window,V.TOUCHMOVE,r._tmCallback,true);p(window,V.TOUCHEND,r._teCallback,true);p(window,V.TOUCHCANCEL,r._teCallback,true);J=null;}function U(r){if(k(r)){return ;}var t=J;if(t){j("forced deactivation","",t);T(t);}j("attachWinEvts","",r);o(window,V.TOUCHMOVE,r._tmCallback,true);o(window,V.TOUCHEND,r._teCallback,true);o(window,V.TOUCHCANCEL,r._teCallback,true);J=r;}function M(t,r){return"touch"+((r&&K[r])||"")+(t||"");}function Z(u,v,t){var r=M(v,t);return(u[r]!==undefined)?r:"";}function n(v,x,z,u,t){t=t||v.gestures[z.id];var w=(t&&t.bubbleTarget)||v,r=Z(w,x,u);if(r){j("fire",r,w);z.methodName=r;return w[r](z);}j("no handler",M(x,u),w);return true;}function d(AB,AC,r,w){var x=r.pageX,v=r.pageY,z=AB.timeStamp,t=X(r),AG={x:B.round(x-AC.pageX),y:B.round(v-AC.pageY)};var AF={id:t,evt:AB,pageX:x,pageY:v,clientX:r.clientX,clientY:r.clientY,target:r.target,delta:AG,date:z,stop:function(){j("event stopped",t);AB.stopPropagation();AB.cancelBubble=true;}};if(w){var u=z-w.date,AE=w.delta,AA={x:B.abs(AG.x-AE.x),y:B.abs(AG.y-AE.y)};AF.velocity={x:AA.x/u,y:AA.y/u};AF.isVertical=(AA.y>AA.x);AF.accelDelta=AA;var AD=AF.direction={};if(x!==w.pageX){AD.x=(x<w.pageX);}else{if(x!==AC.pageX){AD.x=(x<AC.pageX);}}if(v!==w.pageY){AD.y=(v<w.pageY);}else{if(x!==AC.pageX){AD.y=(v<AC.pageY);}}}return AF;}function I(v,r,u,t){return{s:v,p1:r,p2:u,evt:t,target:t.target};}function L(t,r){if(t){t.gestures[r]=null;}}function a(t,r){T(t);n(t,N,r);}function G(r){if(r._selectHandle){window.clearTimeout(r._selectHandle);delete r._selectHandle;j("cancelSelect","",r);}}function H(z,AB){var w=AB.which;if(w&&w===3){j("ignore","right mouse click",z);return ;}var AA=z.gestures,x=AB.touches||[AB],r=(AB.changedTouches&&AB.changedTouches[0])||AB,AE=k(z),AF=d(AB,r,r),AD=I(AF,AF,AF,AB);j("touchBegin","",z,r);if(x.length>1){if(!AE){AF.stop();j("ignore","cross widget multitouch",z,r);var v=J;if(v&&v.onCrossWidgetMultitouch!==undefined){j("call onCrossWidgetMultitouch for","",v);v.onCrossWidgetMultitouch();}return false;}}else{if(AE){j("forced deactivation","",z,r);T(z);AE=false;}}if(z.singleNode&&r.target!==z._tn){j("ignore","target is not touch node",z,r);return ;}if(mstrmojo.touchManager.notify(z.id,AF).ignore){AF.stop();return ;}if(!AE){var u=AF.target.tagName;u=u&&u.toLowerCase();if(u==="select"||u==="input"){j("ignore","target is input or select",z,r);if(z.monitorInputs){n(z,null,AF,P);}return ;}}AA[AF.id]=AD;if(AE){if(!z.multiTouch){G(z);var t=x[x.length-2],AC=AA[X(t)];n(z,S,t,AC.action,AC);}else{AD.action=C;if(z._singleTouch){G(z);z._singleTouch.action=C;delete z._singleTouch.bubbleTarget;delete z._singleTouch;n(z,f,AF,C);}}AF.stop();return ;}if(!V.contains(z._tn,AB.target,true,z.domNode)){delete AA[AF.id];return ;}z._singleTouch=AD;if(n(z,f,AF)===false){return ;}AF.stop();if(Z(z,f,l)){z._selectHandle=window.setTimeout(function(){AD.action=l;if(n(z,f,AF,l)===false){a(z,AF);}delete z._selectHandle;},F);}U(z);}function q(w,x){var AA=(x.changedTouches&&x.changedTouches[0])||x,t=w.gestures[X(AA)];if(!t){return ;}var u=d(x,t.s,AA,t.p2),v=t.action;t.p2=t.p1;t.p1=u;if(!v&&(B.abs(u.delta.x)>g||B.abs(u.delta.y)>g)){v=t.action=m;G(w);if(!Z(w,f,v)&&!Z(w,c,v)){u.methodName=M(f,v);return w.bubbleTouchEvent(u);}if(n(w,f,u,v)===false){a(w,u);return ;}}if(v){var r=t.lastMove||t.s.date,z=u.date-r;if(!mstrApp.isTouchApp()||z>=Y){t.lastMove=u.date;n(w,c,u,v);}}}function E(w,z){var r=(z.changedTouches&&z.changedTouches[0])||z,AA=(z.touches&&z.touches.length)||0,x=w.gestures,AD=X(r),AC=x[AD];if(!AC){j("No gesture",AD,w,r);return ;}var v=AC.action,AE=d(z,AC.s,r,AC.p2);if(!v){G(w);if(!AC.wasMulti){v=P;}}if(AA===0){T(w);w.gestures=[];j("gestures","clear all",w,r);}else{x[AD]=null;j("gestures","clear single",w,r);}L(AC.bubbleTarget,AD);switch(v){case m:case l:AE.stop();n(w,N,AE,v,AC);break;case C:if(AA<2){n(w,N,AE,v,AC);if(AA===1){var u=z.touches[0],AB=d(z,u,u),t=I(AB,AB,AB,z);t.wasMulti=true;x[X(u)]=t;w._singleTouch=t;}}if(AA>0){return ;}break;case P:if(!Z(w,null,v)){break;}var AF=w._tapHandler;if(AF){window.clearTimeout(AF.h);}if(AE.date-AC.s.date<F){if(n(w,"Before",AE,v,AC)===false){break;}if(!w.multiTap){AE.count=1;n(w,null,AE,v,AC);}else{if(AF){AF.count++;}else{AF=w._tapHandler={count:1};}AF.h=window.setTimeout(function(){AE.count=AF.count;n(w,null,AE,v,AC);delete w._tapHandler;},D);}}else{delete w._tapHandler;}break;}n(w,N,AE,undefined,AC);}function b(t){var r=t._tn;if(!r){return ;}if(!t._tmCallback){t._tsCallback=function(u){H(t,u);};t._tmCallback=function(u){q(t,u);};t._teCallback=function(u){E(t,u);};}o(r,V.TOUCHSTART,t._tsCallback);}mstrmojo._TouchGestures=mstrmojo.provide("mstrmojo._TouchGestures",{_mixinName:"mstrmojo._TouchGestures",singleNode:false,multiTouch:false,touchNode:null,multiTap:false,monitorInputs:false,postBuildRendering:function O(){if(this._super){this._super();}this._tn=this.touchNode||this.domNode;this.gestures=[];b(this);},bubbleTouchEvent:function e(z){var v=z.methodName,r=z.id,t=this.gestures[r],u=this.parent;while(u){var x=u[v],w=u.touchBegin;if(x&&(!w||n(u,f,z)!==false)){z.methodName=v;L(t.bubbleTarget,r);t.bubbleTarget=u;u.gestures[r]=t;j("bubble",((this.k)?" "+this.k:"")+"] bubbled "+v+" to ["+u.scriptClass+((u.k)?" "+u.k:"")+"]",this,z);return x.call(u,z);}u=u.parent;}return false;},unrender:function A(t){if(k(this)){T(this);}var r=this._tn;if(r){V.detachEvent(r,V.TOUCHSTART,this._tsCallback);}this._super(t);},restoreDefaultTouches:function R(r){if(W){W.allowDefaultTouches=r&&h;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.color","mstrmojo.hash","mstrmojo.num","mstrmojo.array");var e=1,c=2,l=3,G=4,W=5,f=6,d=7,A=-1,H=-2,F=mstrmojo.color,K=mstrmojo.hash,Z=mstrmojo.array,E=mstrmojo.num,I,V;function k(u,t){return u.every(function(v){return t(v);});}function a(v,u,t){return k(v,function(w){return w.ttp===u||w.ttp===t;});}function Y(u){var t=u.toFixed(2);return parseFloat(t);}function j(t){this.raiseEvent(K.copy(t,{name:"modelEdit"}));}function n(t){this.raiseEvent(K.copy(t,{name:"selectedThresholdsChange"}));}function P(){var t=this.basedOnId||this.metricId;return Z.filterOne(this.data.gsi.mx,function(u){return u.did===t;});}function g(w){var t=w.expr.nds,u=t.length;if(u!==1){return false;}var v=t[0],AG=v.cs;if(!v.m||!AG){return false;}var AF=v.fnt,AA=v.fn,AE=AG[0],AC=AG[1],z=AE&&AE.v,x=AC&&AC.v,AD=E.parseNumeric(z)||parseFloat(z),AB=E.parseNumeric(x)||parseFloat(x);switch(AF){case 2:case 3:switch(AA){case 1:case 2:w.flr=AF===2?-Infinity:0;w.ceil=AD;w.ttp=AF===2?(AA===1?W:G):(AA===1?c:e);break;case 3:case 4:case 5:case 13:w.flr=AD;w.ceil=isNaN(AB)?(AF===2?Infinity:100):AB;w.ttp=AF===2?(AA===4?W:(AA===5?G:f)):(AA===4?c:(AA===5?e:l));break;default:return false;}break;default:switch(AA){case 11:w.flr=-Infinity;w.ceil=AD;w.ttp=d;break;case 17:case 10:w.flr=AD;w.ceil=isNaN(AB)?Infinity:AB;w.ttp=d;break;default:return false;}}return true;}mstrmojo.threshold.MetricThresholdData=null;mstrmojo.threshold.ThresholdModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.ThresholdModel",data:undefined,thresholds:undefined,orgThresholds:undefined,selectedThresholds:[],metricId:undefined,basedOnId:undefined,editorMode:0,init:function m(u){this._super(u);var t=mstrApp.customization.getCustomThresholds();I=I||t.color;V=V||t.image;},ondataChange:function h(){this.thresholds=this.data.gsi.thresholds;this.saveOriginalData();},isAdvanced:function D(x){var u=this.thresholds;if(u){var AB=u[x]||[],AP=false,AO,AI,AM="The expression is not supported by the Simple Threshold Exception Parser.";if(AB.length===0){return false;}if(AB.some(function(AV){if(AV.ttp===A){return true;}try{if(!g(AV)){throw AM;}AI=AV.expr.nds[0].m.did;}catch(AU){return true;}if(AO&&AO!==AI){return true;}AO=AI;var AT=AV.rtp;if(AT===3||AT===10){return true;}var AQ=AV.scope;if(AQ&&AQ!==1){return true;}var AS=AV.fmt||{};for(var AR in AS){if(AR!=="bc"&&AR!=="bgs"){return true;}else{AP=true;}}return false;})){return true;}if(AP&&!k(AB,function(AQ){return AQ.fmt&&(AQ.fmt.bc||AQ.fmt.bgs);})){return true;}this.basedOnId=AO;var AJ=false,AH=this.getSimpleThresholdType(x),AA=AB.length;if(AA>0&&AH!==H){var AL,AD,AF;for(AL=0;AL<AA-1;AL++){AD=AB[AL];AF=AB[AL+1];if(AD.ceil!==AF.flr&&AD.flr!==AF.ceil){AJ=true;break;}}if(!AJ){var t=AB[0],v=AB[AA-1],AE=t.flr,AK=v.ceil,w=t.ceil,z=v.flr,AC=this.getMetricsCount(),AG=this.getMetricsMinValue(),AN=this.getMetricsMaxValue();switch(AH){case W:case G:AJ=!(((AE===0||AE===-Infinity)&&(AK===AC||AK===Infinity))||((w===AC||w===Infinity)&&(z===0||z===-Infinity)));break;case c:case e:AJ=!((parseInt(AE,10)===0&&parseInt(AK,10)===100)||(parseInt(w,10)===100&&parseInt(z,10)===0));break;case d:AJ=!(((AE===AG||AE===-Infinity)&&(AK===AN||AK===Infinity))||((w===AN||w===Infinity)&&(z===AG||z===-Infinity)));break;}}return AJ;}else{return true;}}return false;},getSimpleThresholdType:function(u){var v=this.thresholds&&this.thresholds[u],t=H;if(v){if(a(v,l,c)){t=c;}else{if(a(v,l,e)){t=e;}else{if(a(v,f,G)){t=G;}else{if(a(v,f,W)){t=W;}else{if(a(v,d)){t=d;}}}}}}return t;},isImageBasedType:function L(t){var u=this.thresholds&&this.thresholds[t];return u&&!u.some(function(v){return v.rtp!==4;});},getMetricsMaxValue:function(){var t=P.call(this).max;return t===undefined?3000000:t;},getMetricsMinValue:function(){var t=P.call(this).min;return t===undefined?-3000000:t;},getMetricsCount:function(){var t=P.call(this).cnt;return t===undefined?100:t;},getFormatString:function(){var v=this.data.nf,u=this,t=Z.filterOne(v,function(w){return w.id===u.basedOnId;})||{};return t.nfs||"";},getDefaultColors:function q(){return I;},getDefaultImages:function J(){return V;},getNormalizedValue:function(w,u){var t=null;if(u===l||u===c||u===e){t=w/100;}if(u===f||u===W||u===G){t=w/(this.getMetricsCount());}if(u===d){t=(w-this.getMetricsMinValue())/(this.getMetricsMaxValue()-this.getMetricsMinValue());}if(t<0){t=0;}if(t>1){t=1;}return t;},getRealValue:function(u,t){if(t===l||t===c||t===e){return Y(u*100);}if(t===f||t===W||t===G){return Y(u*this.getMetricsCount());}if(t===d){return this.getMetricsMinValue()+u*(this.getMetricsMaxValue()-this.getMetricsMinValue());}return null;},getColorScheme:function(u){var t="custom",v,w,x;I.forEach(function(z){x=z.bands;w=u.length;if(w!==x.length){return ;}for(var AA=0;AA<w;AA++){v=mstrmojo.color.fixFullHexValue(u[AA]);if(x[AA].bc!==v&&x[w-AA-1].bc!==v){return ;}}t=z.id;});return t;},getImageSetName:function U(x){var w=V[0].id,t,v=function(z){return z===t.bands[0].url;};for(var u=0;u<V.length;u++){t=V[u];if(x.some(v)){w=t.id;break;}}return w;},getGridValueFormat:function M(){return this.data.gsi.fmts.va;},isMapReversed:function N(v,t,x){var w=(x?V:I).filter(function(z){return z.id===v;})[0],u=t[0];if(!x){u=F.fixFullHexValue(u);}return w&&w.bands[0][x?"url":"bc"]!==u;},setConditionData:function Q(w,u){var v=w.data,t=v.isNew;K.copy(u,K.clear(v));delete v.isNew;w.paint();w.tree.onConditionEdit(w,t);},hasSelectedThresholds:function p(){return this.selectedThresholds.length>0;},isThresholdSelected:function b(t){return this.selectedThresholds.indexOf(t)!==-1;},toggleThresholdSelected:function X(t,v){var AA=this.selectedThresholds,z=AA.indexOf(t),u=z!==-1,x=this.thresholds[this.metricId],w=x.indexOf(t)!==-1;if(w){if(v&&!u){AA.push(t);}else{if(!v&&u){AA.splice(z,1);}}n.call(this);}},addThresholds:function T(t){var u=this.thresholds[this.metricId];this.thresholds[this.metricId]=(u||[]).concat(t);j.call(this);},duplicateThreshold:function o(u){var w=this.thresholds[this.metricId],t=w[u],v=K.clone(t);w.push(v);if(this.isThresholdSelected(t)){this.toggleThresholdSelected(v,true);}j.call(this);},deleteThreshold:function r(t){var v=this.thresholds[this.metricId];var u=v.indexOf(t);if(u!==-1){this.toggleThresholdSelected(t,false);v.splice(u,1);}j.call(this);},moveThreshold:function C(u,w){var v=this.thresholds[this.metricId],t=v.splice(u,1);this.thresholds[this.metricId]=v.slice(0,w).concat(t,v.slice(w,v.length));j.call(this);},cleanUp:function O(){this.selectedThresholds=[];this.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.AUTO;},clearData:function S(){var t=this.thresholds;if(t){t[this.metricId]=undefined;}},saveOriginalData:function R(){this.orgThresholds=K.clone(this.thresholds);},setAttIdToNDE:function B(v){if(!(v instanceof Array)){v=[v];}var u,AB,w,t,AA,x=function(AC){AC.att.forEach(function(AD){if(AD.did===AA.did){AA.attId=AD.attId;}});},z=function(AC){AC.conid=AA.did;};for(u=0;u<v.length;u++){t=v[u];for(AB in t){AA=t[AB];if(typeof AA==="function"||!(AA instanceof Object)){continue;}else{if(AB==="a"){if(AA.t===47&&AA.st===12033){K.forEach(this.controller.datasets,x);w=t.fn;if(w===22||w===57){(t.es||[]).forEach(z);}}}else{this.setAttIdToNDE(t[AB]);}}}}}});mstrmojo.threshold.ThresholdModel.SLIDER_MODE={COLOR_BASED:0,IMAGE_BASED:1};mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL=[{n:"&#9679;",v:"1"},{n:"&#9632;",v:"2"},{n:"&#9830;",v:"3"},{n:"&#9670;",v:"4"},{n:"&#10070;",v:"5"},{n:"&#9784;",v:"6"},{n:"&#10047;",v:"7"},{n:"&#8984;",v:"8"},{n:"&#8680;",v:"29"},{n:"&#8679;",v:"30"},{n:"&#8681;",v:"31"}];mstrmojo.threshold.ThresholdModel.FEATURES={SHOW_ADVANCED_EDITOR:1,SHOW_BASED_ON:2,SHOW_IMAGE:3,SHOW_VALUE_ITEM:4};mstrmojo.threshold.ThresholdModel.EDITOR_TYPES={AUTO:0,ADVANCED_EDITOR:1,SIMPLE_EDITOR:2};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");mstrmojo.StepperContentProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.StepperContentProvider",item:null,renderer:null,min:null,max:null,interval:1,minField:"min",maxField:"max",valField:"value",intField:"interval",canLoop:false,next:mstrmojo.emptyFn,prev:mstrmojo.emptyFn,hasPrev:mstrmojo.emptyFn,hasNext:mstrmojo.emptyFn,renderItemAt:mstrmojo.emptyFn,setVal:mstrmojo.emptyFn,getVal:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj");function B(J,I){this.raiseEvent({name:"viCompBuilt",type:J,widget:I});}mstrmojo.vi.models.VIComponentMap=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.models.VIComponentMap",init:function G(I){this._super(I);this.relativePanels={};this.comps={};},addRelativePanel:function H(I){this.relativePanels[I]=true;},isRelativePanel:function F(I){return !!this.relativePanels[I];},isComponent:function C(J,I){return this.getComponentKey(J)===I;},getComponent:function A(I){return this.comps[I];},getComponentKey:function D(J){var I=this.getComponent(J);return(I&&I.k)||"";},createComponent:function E(L,K,J){B.call(this,L);var I=new K(J);this.comps[L]=I;B.call(this,L,I);return I;}});mstrmojo.vi.models.VIComponentMap.TYPES={FILTER_STACK:1,FILTER_PANEL:2,PAGEBY_STACK:3,PAGEBY_PANEL:4,VIZ_CONTENT:5,MAIN_CONTENT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._LoadsScript","mstrmojo.Binding","mstrmojo._HasBindings","mstrmojo._HasMarkup","mstrmojo._HasTooltip","mstrmojo.css");mstrmojo.Widget=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._LoadsScript,mstrmojo._HasBindings,mstrmojo._HasMarkup,mstrmojo._HasTooltip],{scriptClass:"mstrmojo.Widget",domNode:null,hasRendered:false,visible:true,enabled:true,tooltip:"",cssClass:"",cssText:"",cssDisplay:"block",slot:"",alias:"",parent:null,init:function A(C){this._super(C);var D=this.parent;if(!D||D.hasInitBindings){this.initBindings();}},destroy:function B(C){if(this.hasRendered){this.unrender(C);}if(this.bindings){this.destroyBindings();}this._super();},invalidate:mstrmojo.emptyFn,widgetResized:mstrmojo.emptyFn});mstrmojo.Widget.cssTextMarkupMethod=function(){this.domNode.style.cssText=this.cssText||"";};mstrmojo.Widget.visibleMarkupMethod=function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";};mstrmojo.Widget.topMarkupMethod=function(){var C=this.top;if(C){this.domNode.style.top=C;}};mstrmojo.Widget.leftMarkupMethod=function(){var C=this.left;if(C){this.domNode.style.left=C;}};mstrmojo.Widget.heightMarkupMethod=function(){var C=this.height;if(C){this.domNode.style.height=C;}this.widgetResized();};mstrmojo.Widget.widthMarkupMethod=function(){var C=this.width;if(C){this.domNode.style.width=C;}this.widgetResized();};mstrmojo.Widget.enabledMarkupMethod=function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo._Fetchable");mstrmojo.mstr.DocElementDataHelper=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._Fetchable],{scriptClass:"mstrmojo.mstr.DocElementDataHelper",source:null,items:null,browseConfig:null,concat:true,init:function(A){var B=A&&A.browseConfig;this.blockBegin=(B&&B.blockBegin)||1;this.blockCount=(B&&B.blockCount)||mstrApp.elementsBlockCount||30;if(this._super){this._super(A);}},getBrowseConfig:function(){if(!this.browseConfig){this.browseConfig={blockBegin:this.blockBegin,blockCount:this.blockCount};}return this.browseConfig;},_retrieveItems:function(C,B){var A=this.getBrowseConfig();A.blockBegin=C;mstrmojo.func.override({success:function(D){if(this._super){this._super(mstrmojo.hash.copy(D,{items:D.es,totalSize:D.sz}));}}},B);this.source.browseElements(A,B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.StringBuffer","mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo._IsGraphDataService","mstrmojo.func","mstrmojo._ImageHelper","mstrmojo.rw.model.RetrievalKeysConfig","mstrmojo.rw.model.UpdateKeysConfig");var a=mstrmojo.hash,A=a.copy,R=mstrmojo.array,AO=mstrmojo.dom,r=mstrmojo.func,AG=[mstrmojo.desc(8445,"Loading")],Ah=mstrmojo.array.ensureArray,N=0;function T(BF){BF=BF||{};BF.preserveUndo=true;return BF;}function Ae(BJ,BK,BF){if(this.blockRequests){throw ("The data service is currently ignoring all requests to the server.");}var BG=N++,BI=this.getTxUpdates(BG);BF=BF||{};BF.src=Ae.caller.name;if(!mstrmojo.string.isEmpty(BI)){BJ.updateChanges=BI;}BJ.zoomFactor=this.model.getZoomFactor();var BH=this.cmdMgr;if(!BF.preserveUndo&&BH){BH.onSubmitUpdates();}mstrApp.serverRequest(BJ,this.wrapCallback(BK,BG),BF);}function L(BH,BG,BF){a.copy({unitType:BG.defn&&BG.defn.t,unitKey:BG.k},BH);if(BF.layoutKey){a.copy({toKey:BF.layoutKey,analysisSectionType:BF.analysisSectionType},BH);}else{a.copy({toKey:BF.parentKey},BH);}return BH;}function Aj(BG){BG=BG||{};var BF=window.mstrMobileApp?this.model.controller.getContentDimensions():mstrApp.getContentDimensions();if(BF){BG.styleName="RWDocumentMobileStyle";BG.availableWidth=BF.w;BG.availableHeight=BF.h;}else{BG.innerWidth=mstrmojo.dom.windowDim().w;BG.innerHeight=mstrmojo.dom.windowDim().h;}return BG;}function BA(BG){var BF=BG&&BG.style,BH=BF&&BF.params;return BH&&BH.treesToRender;}function B(BF,BG){return{act:"moveUnit",toKey:BF,unitType:BG};}function Ai(BF){return BF.split("\u001E")[2];}function K(BG,BK){if(BG!==mstrmojo.DocDataService.UNDO_KEY){return BG;}if(!this.undoSectionKey){var BJ=this.undoSectionKey=this.model.getNextKey(),BH=this.undoFGKey=this.model.getNextKey();BK.addActions({act:"addUndoSection",cbKey:this.cbKey,nodeKey:BJ,fgKey:BH});var BI=this;BK.addCallbacks({failure:function BF(){delete BI.undoSectionKey;}});}return this.undoSectionKey;}function Ad(BH,BG){var BF={dsid:BH.dsid,formula:BH.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BH.tokenStreamXML),name:BH.alias,afb:BH.afb,sfb:BH.sfb};if(BG){BF.Ids=["$GUID_135"];}return this.getAddDerivedMetricToDatasetAction(BF);}function AF(BI,BL,BG,BM,BF,BH){var BJ=[this.getNodeKeyFromKeyContext(BL)];if(!BH){BJ=Ah(BM).concat(BJ);}var BK={act:BI,keyContext:BL,tgtKey:BG,partialRetrieval:{nodes:BJ}};if(!BF){BK.partialUpdate={selectors:[Ai(BL)]};}return BK;}mstrmojo.DocDataService=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsGraphDataService,mstrmojo._ImageHelper],{scriptClass:"mstrmojo.DocDataService",defaultStyle:{params:{treesToRender:2}},cmdMgr:null,stid:-1,blockRequests:false,init:function Ab(BF){this._super(BF);this.cmdMgr=this.model.controller.cmdMgr;},wrapCallback:function AU(BJ,BG){var BH=this;return r.wrapMethods({success:function BI(BK){if(BK){BH.model.bs=BH.rwb=BK.bs||BH.rwb;BH.msgId=BK.mid||BH.msgId;BH.cbKey=BK.cbKey||BH.cbKey;if(BK.stid!==undefined){BH.stid=BK.stid;}}BH.clearTxUpdates(BG);},failure:function BF(){BH.resetTxUpdates(BG);}},BJ);},getNodeKeyFromKeyContext:function V(BF){return BF.split("\u001E")[1];},refresh:function Ao(BH,BI){var BG=!!BH.useRefreshProgress,BF=BG?[mstrmojo.desc(10078,"Refreshing data. Please wait.")]:AG;delete BH.useRefreshProgress;BH=Aj(BH);Ae.call(this,A(BH,{taskId:"docRefresh",rwb:this.rwb,rePrompt:false,fresh:false,regenerate:false}),BI,{showProgress:true,hideProgress:true,progressStateText:BF,useRefreshProgress:BG});},saveRW:function Ar(BF,BG){Ae.call(this,A(BF,{taskId:"saveRW",msgID:this.msgId}),BG);},saveThresholds:function e(BG,BH,BF){Ae.call(this,A(BG,{taskId:"saveThresholds"}),BH,BF);},getThresholds:function A4(BG,BH,BF){Ae.call(this,A(BG,{taskId:"getThresholds"}),BH,BF);},browseElements:function AC(BF,BG){Ae.call(this,A(BF,{taskId:"browseElements",styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30}),BG);},removeUnit:function U(BG,BH){var BF=A(BG,{act:"removeUnit"});this.submitTemplateUpdates(BF.nodeKey,BF,BH);},removeLayout:function AJ(BG,BF,BH){this.submitUpdates({act:"removeLayout",unitKey:BG,isCurrent:BF},BH);},moveLayout:function p(BH,BF,BG){this.submitUpdates(this.getMoveNodeAction(BH,BF,BG),mstrmojo.DocDataService.EMPTY_CALLBACK,mstrmojo.DocDataService.SUPPRESS_DATA);},getMacroCopyNodeAction:function Af(BG,BF,BI){var BH={act:"macroCopyUnit",newKey:BI,partialRetrieval:this.newRetrievalKeysConfig().addNode(BI)};L(BH,BG,BF);return BH;},getMacroMoveNodeAction:function x(BG,BF){var BH={act:"macroMoveUnit",partialRetrieval:this.newRetrievalKeysConfig().addNode(BG.k)};L(BH,BG,BF);return BH;},getMoveNodeAction:function l(BJ,BF,BG){var BI=BJ.defn,BH=BI?BI.t:mstrmojo.EnumRWUnitType.LAYOUT;var BK=B(BF,BH);BK.unitKey=BJ.k;if(BG!==undefined){BK.index=BG;}return BK;},getMoveControlAction:function Z(BI,BG,BF){var BH=B(BG,mstrmojo.EnumRWUnitType.SELECTOR);BH.keyContext=BI;if(BF){BH.partialRetrieval={nodes:Ah(BF)};}return BH;},addMoveControlAction:function H(BI,BH,BG,BF){BI.addActions(this.getMoveControlAction(BH,K.call(this,BG,BI),BF));},getSetCtrlSourceAction:function AD(BG,BH,BF){return{act:"setControlSource",keyContext:BG,unitId:BH,unitType:BF,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BG)),partialUpdate:{selectors:[Ai(BG)]}};},getRemoveCtrlTargetAction:function F(BH,BG,BI,BF){return AF.call(this,"removeControlTarget",BH,BG,BI,BF);},getClearCtrlTargetAction:function A0(BF){return{act:"clearControlTarget",keyContext:BF};},getAddCtrlTargetAction:function Am(BJ,BG,BK,BL,BF,BH){var BI=AF.call(this,"addControlTarget",BJ,BG,BK,BF,BH);BI.isUC=!BL;return BI;},getAddCtrlTargetDatasetAction:function Ax(BG,BF){return{act:"addControlTargetDataset",keyContext:BG,tgtDid:BF};},getRemoveCtrlTargetDatasetAction:function d(BG,BF){return{act:"removeControlTargetDataset",keyContext:BG,tgtDid:BF};},getClearCtrlTargetDatasetAction:function AI(BF){return{act:"clearControlTargetDataset",keyContext:BF};},getChangeControlElementSource:function A9(BG,BF){return{act:"changeControlElementSource",keyContext:BG,ctlElementSrc:BF};},getSetAttributesJoinTypeAction:function AY(BF,BG){return{act:"setAttributesJoinType",nodeKey:BF,value:BG,partialRetrieval:this.newRetrievalKeysConfig().addNode(BF)};},getSetMetricJoinTypeAction:function AQ(BH,BJ,BF,BG,BI){return{act:"setMetricJoinType",nodeKey:BH,unitId:BJ,dataType:BF,unitType:BG,value:BI,partialRetrieval:this.newRetrievalKeysConfig().addNode(BH)};},getTxUpdates:function AN(BG){var BF=this.model;return BF&&BF.getTransactionUpdates&&BF.getTransactionUpdates(BG);},clearTxUpdates:function Ac(BG){var BF=this.model;if(BF&&BF.clearTransactionUpdates){BF.clearTransactionUpdates(BG);}},resetTxUpdates:function C(BG){var BF=this.model;if(BF&&BF.resetTransactionUpdates){BF.resetTransactionUpdates(BG);}},loadDocLayout:function J(BH,BJ,BI){var BG={act:"setCurrentLayout",unitKey:BH.layoutKey,disablePU:true},BF={style:{params:{treesToRender:3}},params:Aj.call(this)};if(BI){BI.add(BG,BJ,BF);}else{this.submitUpdates(BG,BJ,BF);}},checkMissingCredentials:function t(BF,BG){Ae.call(this,A(BF,{taskId:"checkMissingCredentials"}),BG);},setCurrentDocLayout:function Al(BF,BJ,BI){var BH={act:"setCurrentLayout",unitKey:BF},BG={config:{silent:(BJ===null)}};BJ=BJ||null;if(BI){BI.add(BH,BJ,BG);}else{this.submitUpdates(BH,BJ,BG);}if(window.mstrMobileApp!==undefined){mstrMobileApp.clearWebViewCache(false);}},fetchDocPage:function A1(BF,BG){Ae.call(this,{taskId:"fetchDocPage",rwb:this.rwb,pos:BF},BG);},requestPanelChangeDeferred:function A8(BL,BK,BF,BG,BI,BJ){var BH={act:"setCurrentPanel",unitKey:BK};if(BF){BH.partialRetrieval={nodes:BF.split(",")};}BL.add(BH,BJ,{config:{showProgress:BI,hideProgress:BI,progressStateText:AG},style:{params:{treesToRender:BG?3:0}}});},getGraphSelectionAction:function D(BJ,BF,BH,BM,BL,BG){var BK=this.model.getCurrentLayoutDef(),BN=(BK&&BK.dzf)||1,BI={act:"graphSelector",nodeKey:BJ,sliceID:BH,x:Math.round(BM/BN),y:Math.round(BL/BN)};if(BG){BI.usePartialUpdate="0";}else{BI.partialUpdate={selectors:BF.split("\u001E")};}return BI;},getSelectorElementsAction:function m(BH){var BG={act:"setSelectorElements",keyContext:BH.ck,ctlKey:BH.ctlKey,elemList:mstrmojo.string.decodeHtmlString(BH.eid),isVisualization:!!BH.isDocVis},BF=BH.include;if(BF!==undefined){BG.include=!!BF;}if(BH.tks){BG.tks=BH.tks;}if(BH.disablePU){BG.usePartialUpdate="0";}else{if(BH.ignoreTargetData){BG.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BH.ck));}else{BG.partialUpdate={selectors:BH.ctlKey.split("\u001F")};}}return BG;},getUpdateTransactionAction:function BD(BG){var BF={act:"updateTransaction"};if(BG){if(BG.ctlKey){BF.partialUpdate={selectors:[BG.ctlKey]};}}return BF;},getSelectorFromGMAction:function j(BG){var BF={act:"setSelectorFromGM",keyContext:BG.ck,ctlKey:BG.ctlKey,keepOnly:!!BG.keepOnly,selectorObjects:BG.selectorObjects,isVisualization:!!BG.isDocVis,include:!!BG.include};if(BG.tks){BF.tks=BG.tks;}if(BG.disablePU){BF.usePartialUpdate="0";}else{BF.partialUpdate={selectors:[BG.ctlKey]};}return BF;},getGMViewFilterAction:function AB(BG){var BF={act:"keepOnlyGM",selectorObjects:BG.selectorObjects,isVisualization:!!BG.isDocVis,keepOnly:!!BG.keepOnly};if(BG.tks){BF.tks=BG.tks;}if(BG.disablePU){BF.usePartialUpdate="0";}else{BF.partialUpdate={selectors:[BG.ctlKey]};}return BF;},setMultiDocSelectorElements:function z(BF,BG,BI){var BH={taskId:"setMultiDocSelectorElements",rwb:this.rwb,multiSelect:BG,selectorObjects:BF};Ae.call(this,BH,BI,{showWait:true,hideWait:true,delay:true});},setDocSelectorTexts:function Q(BK,BM,BO,BL,BN,BG,BF,BH,BJ){var BI={taskId:"setDocSelectorTexts",rwb:this.rwb,unitKeyContext:BK,ctlTexts:BM,ctlKey:BO,zoomFactor:BG};if(AO.isAndroid||BF){BI.taskId="androidSetDocSelectorElements";}if(BL!==null&&BL!==undefined){BI.include=BL;}if(BH!==null&&BH!==undefined){BI.usePartDisplay=BH;}if(BJ!==null&&BJ!==undefined){BI.treesToRender=BJ;}Ae.call(this,BI,BN);},getSelectorExpressionAction:function n(BH){var BG={act:"setSelectorExpression",keyContext:BH.ck,ctlType:BH.type,objId:BH.srcid,objType:BH.srct,expFunction:BH.f,expFunctionType:BH.ft,include:!!BH.include,qt:BH.qt,unset:!!BH.unset};if(BH.disablePU){BG.usePartialUpdate="0";}else{BG.partialUpdate={selectors:[BH.ckey]};}if(BH.changeQual){BG.changeQual=BH.changeQual;}var BF=BH.cs;if(BF!==null&&BF!==undefined){BG.expConstants=BF;BG.dataType=BH.dtp;}if(BH.fid){BG.fid=BH.fid;}return BG;},getMultiUnitSelectorAction:function A6(BF){return{act:"multiUnitSelection",keyContext:BF.ck,sels:BF.selections,partialUpdate:{selectors:[BF.ctlKey]}};},getRemoveCtrlAction:function Ag(BG,BF){return{act:"removeControl",key:BG,partialUpdate:{selectors:[BG]},partialRetrieval:{nodes:Ah(BF)}};},getAddCtrlAction:function AX(BM,BK,BG,BL,BH,BN,BF,BI,BO){if(isNaN(BO)){BO=1;}var BJ={act:"addControl",parentKey:BM,nodeKey:BK,ctlKey:BG,isUC:!!BH,unitType:BN||-1,unitId:BF||"",targetKeys:Ah(BI),ctlType:BO,gpType:BO,partialRetrieval:{nodes:Ah(BL)}};if(!BJ.isUC){BJ.partialUpdate={selectors:[BG]};}return BJ;},getSaveGraphPropertiesAction:function h(BF,BG){return{act:"saveGraphProperties",nodeKey:BF,properties:BG};},getSelectorIncludeAction:function At(BG){var BF=BG.ckey;return{act:"setSelectorInclude",keyContext:BG.ck,ctlKey:BF,ctlType:BG.type,include:BG.include,partialUpdate:{selectors:[BF]}};},getSelectorShowAllAction:function O(BF){return{act:"setSelectorShowAll",keyContext:BF.ck,ctlKey:BF.ckey,ctlType:BF.type,showAll:BF.showAll,partialRetrieval:this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BF.ck))};},getUnsetSelectorAction:function c(BI){var BH=BI.ckey,BF=BI.ck,BG={act:"unsetSelector",keyContext:BF,ctlKey:BH,ctlType:BI.type};if(BI.ignoreTargetData){BG.partialRetrieval=this.newRetrievalKeysConfig().addNode(this.getNodeKeyFromKeyContext(BF));}else{BG.partialUpdate={selectors:[BH]};}return BG;},getChangeFilteringAction:function Aq(BF,BI,BH,BG){return{act:"changeFiltering",nodeKey:BF,filterMode:BI,isUC:BH,partialRetrieval:{nodes:(BG?Ah(BG):[])}};},getAddDerivedMetricToDatasetAction:function Aw(BF){return{act:"addDerivedMetricToDataset",dsid:BF.dsid,formula:BF.formula,isTokenStream:BF.isTokenStream,name:BF.name,newObjectIds:BF.Ids,afb:BF.afb,sfb:BF.sfb};},getEditDocUnitPropAction:function w(BF){return{act:"editDocUnitProp",dsid:BF.dsid,formId:BF.formId,unitId:BF.unitId,unitType:BF.unitType,prop:BF.prop,value:BF.value};},getRWGraphImage:function BC(BJ,BN){var BI=mstrApp,BF=this.id,BG={taskId:"getRWGraphImage",taskEnv:"xhr",imgType:4,messageID:this.msgId,nodeKey:BJ.k,sliceID:parseInt(BJ.sid,10),width:parseInt(BJ.w,10),height:parseInt(BJ.h,10)};if(BI.onMobileDevice()&&BI.useBinaryFormat){window.setTimeout(function(){Ae.call(mstrmojo.all[BF],BG,BN,T());},0);}else{if(BJ.encodeImage){BG.taskContentEncoding="base64";delete BG.taskEnv;Ae.call(this,BG,{success:function BO(BP){BN.success("data:image/png;base64,"+BP);},failure:function BH(BP){(BN.failure||BI.onerror)(BP);}},T());}else{var BL=BI.getConfiguration(),BK=BI.getCurrentProjectId(),BM=new mstrmojo.StringBuffer();BG.__ts__=new Date().getTime();BG.sessionState=BI.getSessionState(BK);a.forEach(BG,function(BP,BQ){BM.append(BQ+"="+encodeURIComponent(BP));});BN.success(BL.getTaskUrlByProject(BK)+"?"+BM.toString("&"));}}},getImage:function BB(BG){var BH=mstrApp,BF=BH.getConfiguration();if(BF&&BG&&BG.indexOf("://")===-1){BG=BF.getHostUrlByProject(BH.getCurrentProjectId())+BG;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(BG)):BG;},setGridDisplayMode:function o(BH,BG,BI,BF){a.copy({params:{suppressData:true}},BF);this.submitUpdates({act:"setGridDisplayMode",unitKey:BH,displayMode:BG},BI,BF);},setDocZoom:function G(BF,BG){this.submitUpdates(A(BF,{act:"setDocZoom",disablePU:true}),BG,{style:{params:{treesToRender:3}}});},sortGrid:function AH(BF,BG){this.submitTemplateUpdates(BF.nodeKey,A({act:"sort"},BF),BG);},getAdvSortData:function Aa(BF,BG){this.rwExecute(A(BF,{styleName:"RWGridStyle"}),BG);},rwExecute:function A3(BF,BG){Ae.call(this,A(BF,{taskId:"RWExecute",rwb:this.rwb,messageID:this.msgId}),BG);},pivot:function k(BF,BG){this.submitTemplateUpdates(BF.nodeKey,{act:"pivot",unitId:BF.unitId,unitType:BF.unitType,attFormId:BF.attFormId,axis:BF.axis,unitPos:BF.unitPos},BG);},resizeXtabColumn:function Az(BF,BG){this.submitUpdates([this.getUpdateTemplateAction(BF.nodeKey,BF),{act:"format",unitType:52,unitKey:BF.nodeKey,formatType:1,format:{FormattingSize:{WidthMode:2}}}],BG);},showTotals:function S(BF,BG){this.submitTemplateUpdates(BF.nodeKey,{act:"showTotals",unitId:BF.unitId,unitType:BF.unitType,subtotalType:BF.subtotalType,clearSubtotalType:BF.clearSubtotalType},BG);},drillGrid:function AE(BF,BG){this.submitUpdates(this.getDrillGridAction(BF),BG,{config:{showProgress:true,hideProgress:true,progressStateText:AG,delay:true}});},getDrillGridAction:function A5(BG){var BF={act:"gridDrillWithin",messageID:this.msgId,nodeKey:BG.nodeKey,sliceId:BG.sliceId,drillPathIndex:BG.drillPathIndex,drillPathKey:BG.drillPathKey,elementList:BG.drillElements,retainParent:BG.retainParent,partialUpdate:{nodes:[BG.nodeKey]}};if(BG.x){BF.x=BG.x;BF.y=BG.y;}return BF;},changeDocGroupBy:function M(BH,BI,BF){var BG={act:"changeDocGroupBy",disablePU:true};if(BH.flags){BG.flags=BH.flags;}if(BH.groupbyKey){BG.gbKey=BH.groupbyKey;BG.elemId=BH.elementId;}else{BG.gbUnits=BH.gbUnits;}this.submitUpdates(BG,BI,{config:BF,style:{params:{treesToRender:3}},params:Aj.call(this)});},retrieveServerJson:function b(BH,BQ,BI){var BK=this.model,BL=BK.controller,BO={},BF,BG,BM;var BN=BH.nodes;if(BN){BO.partialRetrieval=BN;}var BP=BH.slices;if(BP){BO.slices=BP;}if(BI){BF=BI.style;BG=BI.config;BM=BI.params;}if(!BG){BG={showProgress:true,hideProgress:true,progressStateText:AG};}var BR=BH.style=a.clone(this.defaultStyle);A(BF.params,BR.params);var BJ={taskId:"getServerJSONResults",styleName:"ServerJsonRWDStyle",compress:1,rwb:this.rwb,messageID:this.msgId,stateID:-1,params:JSON.stringify(BO),treesToRender:BR.params.treesToRender};A(BM,BJ);BG.preserveUndo=(BI&&BI.preserveUndo)||false;Ae.call(this,BJ,BQ,BG);},downloadGridData:function I(BG,BH){var BF={act:"gridIncrementalFetch",nodeKey:BG.nodeKey,rowPosition:BG.rowPosition,maxRows:BG.maxRows,colPosition:BG.colPosition,sliceId:BG.sliceId,maxColumns:BG.maxColumns,partialRetrieval:this.newRetrievalKeysConfig().addNode(BG.nodeKey)};if(BG.partialUpdate){BF.partialUpdate=BG.partialUpdate;}this.submitUpdates(BF,BH,a.copy(T(),{noUpdate:true,config:{silent:true}}));},txMarkRows:function AM(BF,BG){Ae.call(this,{taskId:"markRow",rwb:this.rwb,nodeKey:BF.nodeKey,sliceId:BF.sliceId,rowOrdinal:BF.rowOrdinal,actionType:BF.actionType},BG);},txChangeData:function q(BF,BG){Ae.call(this,{taskId:"changeData",rwb:this.rwb,nodeKey:BF.nodeKey,sliceId:BF.sliceId,cells:BF.cells,autoRefresh:BF.autoRefresh},BG);},sendTransactionActions:function Y(BG,BH){var BF={taskId:"DocTransaction",rwb:this.rwb,keyContext:BG.keyContext,actions:BG.actions,messageID:this.msgId};if(BG.txrcd){BF.isPending=BG.txrcd.pending;BF.timestamp=BG.txrcd.timestamp;}Ae.call(this,BF,BH,{silent:!!BH});},newUpdate:function Av(BH,BG){var BF=new mstrmojo.DocDataService.Update(BG);BF.ds=this;BF.cmd=BH;return BF;},newUpdateWithoutCmd:function g(BG){var BF=new mstrmojo.DocDataService.Update(BG);BF.ds=this;return BF;},newRetrievalKeysConfig:function AW(){return new mstrmojo.rw.model.RetrievalKeysConfig();},newUpdateKeysConfig:function P(){return new mstrmojo.rw.model.UpdateKeysConfig();},submitCmd:function A2(BG,BF){this.newUpdate(BG,BF).submit();},submitUpdates:function AZ(BO,BT,BL){BO=Ah(BO);var BK={actions:BO},BF,BI,BQ,BH=false;R.forEach(BO,function BN(BV){if(BV.disablePU){BH=true;delete BV.disablePU;}R.forEach(BV.actions,BN);return !BH;});if(!BH){var BG=mstrmojo.rw.model.RetrievalKeysConfig.getConsolidatedConfig(BO),BS=mstrmojo.rw.model.UpdateKeysConfig.getConsolidatedConfig(BO);if(!a.isEmpty(BG)){BK.partialRetrieval=BG;}if(!a.isEmpty(BS)){BK.partialUpdate=BS;}}if(BL){BF=BL.style;BI=BL.config;BQ=BL.params;}if(!BI){BI={showProgress:true,hideProgress:true,progressStateText:AG};}if(!BF){BK.style=this.defaultStyle;}else{var BU=BK.style=a.clone(this.defaultStyle);A(BF.params,BU.params);}BK.style.name=(BF&&BF.name)||mstrApp.styleName;var BM={taskId:"mojoRWManipulation",rwb:this.rwb,messageID:this.msgId,stateID:-1,params:JSON.stringify(BK)};A(BQ,BM);BI.preserveUndo=(BL&&BL.noUpdate)||false;var BP=this,BR=true,BJ=r.override({success:function(BV,BW){if(BV.status===2){BR=false;BP.submitUpdates([],BT,BL);}else{BR=true;return this._super(BV,BW);}},complete:function(){if(this._super&&BR){this._super();}}},A(BT));if(!(BL&&BL.hideCancel)){BI.waitBoxCfg=a.copy({showCancel:true},BI.waitBoxCfg);}if(BL&&BL.message){BI.waitBoxCfg=a.copy({message:BL.message},BI.waitBoxCfg);}Ae.call(this,BM,BJ,BI);},submitTemplateUpdates:function u(BF,BH,BI,BG){this.submitUpdates(this.getUpdateTemplateAction(BF,BH),BI,BG);},getUpdateTemplateAction:function AT(BF,BH,BG){return{act:"updateTemplate",keyContext:BF,partialRetrieval:this.newRetrievalKeysConfig().addNode(BF,BG),actions:Ah(BH)};},addUpdateTemplateAction:function A7(BH,BF,BG){BH.addActions(this.getUpdateTemplateAction(BF,BG));},applySegment:function AK(BG,BF,BH){Ae.call(this,{taskId:"applySegment",rwb:this.rwb,segmentID:BG,nodeKey:BF},BH);},getPageByTree:function AL(BF){mstrApp.serverRequest({taskId:"getPageByTree",msgID:this.msgId},BF);},getUserDICubeInfo:function W(BF,BG){Ae.call(this,{taskId:"getUserDICubeInfo",cubeIds:BF.join(",")},BG);},applySorts:function Au(BG,BH,BF,BI){Ae.call(this,{taskId:"applySorts",key:BG,sortType:BH,sortList:BF},BI,mstrmojo.DocDataService.PROGRESS_CONFIG);},getAddNewDerivedMetricToDatasetSubmitFunc:function As(BG){var BF=this;return function(BJ){var BK=BF.model,BI=BK.controller,BH=a.copy(BJ,BG),BL=[Ad.call(BF,BH,false)],BM=BK.getDatasetsUpdateCallback();BI.submitUndoRedoUpdates(BL,null,BM,{style:{params:{treesToRender:1}}});};},getAddNewDerivedMetricToXtabSubmitFunc:function Ak(BG){var BF=this;return function(BK){var BL=BF.model,BJ=BL.controller,BI=a.copy(BK,BG),BH=BI.idx,BN=[],BO=r.wrapMethods(BL.getDatasetsUpdateCallback(),BJ._getXtabCallback(BI.host));BN.push(Ad.call(BF,BI,true));if(BI.replace){BN.push(BF.getUpdateTemplateAction(BI.nodeKey,[BI.host.model.getRemoveTemplateUnitAction({did:BI.replace.did,t:BI.replace.t})]));}else{BH++;}var BM=BF.getUpdateTemplateAction(BI.nodeKey,[BI.host.model.getAddTemplateUnitAction({did:"$GUID_135",t:4},BI.dsid,BI.zoneid,BH),{act:"renameUnit",id:"$GUID_135",type:4,name:BI.alias,isDynamicAlias:true}]);BN.push(BM);BJ.submitUndoRedoUpdates(BN,null,BO);};},getAddNewDerivedMetricToDropzoneSubmitFunc:function AA(BG){var BF=this;return function(BM){var BN=BF.model,BO=BN.controller,BQ=a.copy(BM,BG),BS=BQ.host.zonesModel,BT=BQ.idx,BL=[],BH=[],BR={id:BQ.zoneid},BP={did:"$GUID_135",t:4},BU=r.wrapMethods(BN.getDatasetsUpdateCallback(),BO._getXtabCallback(BQ.host));BL.push(Ad.call(BF,BQ,true));if(BQ.replace){var BJ={did:BQ.replace.did,t:BQ.replace.t};BH.push(BS.getRemoveDropZoneUnitAction(BR,BJ));}else{BT++;}BH.push(BS.getAddDropZoneUnitAction(BR,BP,BT,{datasetId:BQ.dsid}));var BI=(BG.zoneid===4)?1:2,BK=BS.getAddMetricNameAction(BG.host,BI);if(BK){BL.push(BK);}if(!BQ.replace&&BS.gmZones){BK=BS.gmZones.getUpdateGroupInfoActionForNewMetric(BG.zoneid,BT,true);if(BK){BL.push(BK);}}BS.checkAndAddThresholdAction(BQ.zoneid,BP,BH);BL.push(BF.getUpdateTemplateAction(BQ.nodeKey,BH));BO.submitUndoRedoUpdates(BL,null,BU);};},getEditDerivedMetricSubmitFunc:function f(BG){var BF=this;return function(BJ){var BL=BF.model,BI=BL.controller,BH=a.copy(BJ,BG),BK=BG.nodeKey,BM={act:"editDM",formula:BH.tokenStreamXML,isTokenStream:!mstrmojo.string.isEmpty(BH.tokenStreamXML),afb:BG.afb,sfb:BG.sfb,dsid:BH.dsid||"",did:BH.did},BN=[BL.addUpdateObjects(BM,{id:BH.did,type:4,flag:mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS.DATA_CHANGE})],BO=r.wrapMethods(BL.getDatasetsUpdateCallback(),BI.getPartialUpdateCallback());if(BK){BN.push(BF.getUpdateTemplateAction(BK,[{act:"renameUnit",id:BH.did,type:4,name:BH.alias,isDynamicAlias:true}]));}else{BM.name=BH.alias;}BI.submitUndoRedoUpdates(BN,null,BO);};},resetSelections:function Ay(BG,BF,BH){Ae.call(this,{taskId:"resetSelections",rwb:this.rwb,unitKeyContext:BG||"",usePartDisplay:BF?"0":"1",treesToRender:BF?3:2},BH);},setPreference:function E(BF,BG){Ae.call(this,{taskId:"setPreference",prefs:BF},BG);},getObjectInfo:function AR(BF,BG){Ae.call(this,A(BF,{taskId:"getObjectInfo"}),BG,T());},addSuppressData:function An(BF){if(BA(BF)===mstrmojo.DocDataService.EnumTreesToRender.NONE){a.copy({params:{suppressData:true}},BF);}},uploadImageToServer:function(BH,BI){var BG={taskId:"importImage",imageFieldName:"imageData",isEdit:1,fieldKey:BH.fieldKey,fieldName:BH.fieldName,imageName:encodeURIComponent(BH.imageName),imageSize:BH.imageSize,nodeKey:BH.nodeKey,sectionKey:BH.sectionKey};if(mstrApp.isSingleTier){var BF=";base64,";BG.rwNodeKey=BH.fieldGroupKey;BG.imageData=BH.base64Str.split(BF)[1]||BH.base64Str;mstrApp.serverRequest(BG,BI);}else{BG.msgID=this.msgId;BG.imageData=BH.imageData;mstrmojo.xhr.upload("POST",mstrConfig.taskURL,BI,BG);}}});mstrmojo.DocDataService.Update=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DocDataService.Update",actions:null,callback:null,extras:null,init:function Ab(BF){A(BF,this);this.actions=this.actions||[];this.callback=this.callback||{};this.extras=this.extras||{};},addActions:function AV(BF){this.actions=this.actions.concat(Ah(BF));},addCallbacks:function Ap(BF){this.callback=r.wrapMethods(this.callback,BF);},addExtras:function AP(BG){var BF=BA(BG),BH=BA(this.extras);this.extras=A(BG,this.extras);if(BF!==undefined&&BH!==undefined){this.extras.style.params.treesToRender|=BH;}},addUpdate:function AS(BF){this.add(BF.actions,BF.callback,BF.extras);},setTreesToRender:function BE(BF){if(BF){this.addExtras({style:{params:{treesToRender:BF}}});}return this.extras.style.params.treesToRender;},add:function X(BG,BH,BF){if(BG){this.addActions(BG);}if(BH){this.addCallbacks(BH);}if(BF){this.addExtras(BF);}},submit:function v(){var BG=this.actions,BH=this.callback,BF=this.extras;if(this.cmd){this.cmd.submit(BG,BH,BF);}else{this.ds.submitUpdates(BG,BH,BF);}}});mstrmojo.DocDataService.PUInfoType=null;mstrmojo.DocDataService.ExtrasType=null;mstrmojo.DocDataService.PROGRESS_CONFIG={showProgress:true,hideProgress:true,progressStateText:AG,delay:true};mstrmojo.DocDataService.UNDO_KEY="undo";mstrmojo.DocDataService.REQUEST_DEFN_DATA={style:{params:{treesToRender:3}}};mstrmojo.DocDataService.REQUEST_ONLY_DEFINITION={style:{params:{treesToRender:1}}};mstrmojo.DocDataService.REQUEST_ONLY_DATASETS={style:{params:{treesToRender:0}}};mstrmojo.DocDataService.SUPPRESS_DATA={params:{suppressData:true}};mstrmojo.DocDataService.EMPTY_CALLBACK={success:mstrmojo.emptyFn};mstrmojo.DocDataService.CopyMoveDestinationType=null;mstrmojo.DocDataService.PARTIAL_UPDATE_FLAGS={FORMAT_CHANGE:1,DATA_CHANGE:2};mstrmojo.DocDataService.EnumTreesToRender={NONE:0,DEFN:1,DATA:2,BOTH:3};}());(function(){mstrmojo.requiresCls("mstrmojo.func");mstrmojo.ResSetLink=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ResSetLink",SAME_PROMPT:1,DO_NOT_ANSWER:2,CLOSE:3,DYNAMIC:4,STATIC:5,CURRENT_UNIT:6,ALL_VALID_UNITS:7,USE_DEFAULT_ANSWER:8,DYNAMIC_OR_SAME_PROMPT:9,toXml:function A(){var K=this,D=function(Q,R){return" "+Q+'="'+R+'"';},C=function(Q,R){return D(Q,mstrmojo.string.encodeXMLAttribute(R));},G=new mstrmojo.StringBuffer(),E=function(R,S){var Q=mstrmojo.string.multiReplace(S.disp_n,{"&nbsp;":" "});R.append("<e"+C("ei",S.ei)+C("disp_n",Q)+D("emt",S.emt)+"/>");};var I=this.prms,B=I&&I.length;if(B||K.aopam!=K.DO_NOT_ANSWER){G.append("<hl"+D("mid",K.mid)+D("srct",K.srct)+D("aopam",K.aopam)+">");if(B){G.append("<prms>");for(var F=0;F<B;F++){var P=I[F];G.append("<prm"+D("id",P.id)+D("am",P.am)+D("pt",P.pt));if(P.orid){G.append(D("orid",P.orid)+D("ortp",P.ortp));}G.append(">");switch(P.am){case K.DO_NOT_ANSWER:case K.CLOSE:case K.USE_DEFAULT_ANSWER:case K.SAME_PROMPT:break;case K.STATIC:G.append('<pa ia="1"><es>');var O=P.pa.es,N=O&&O.length||0;for(var J=N-1;J>=0;--J){var H=O[J];E(G,H);}G.append("</es></pa>");break;case K.DYNAMIC:case K.ALL_VALID_UNITS:case K.CURRENT_UNIT:case K.DYNAMIC_OR_SAME_PROMPT:var M=P.pa;if(M){G.append('<pa ia="1">');var L=M.a;if(L){G.append("<a"+D("id",L.id)+C("n",L.n)+">");}if(P.pt===1){G.append(mstrmojo.string.encodeXMLAttribute(M.v));}else{G.append("<es"+D("dispForms",L&&L.dispForms>=0?L.dispForms:"")+">");var O=M.es;N=O&&O.length||0;for(var J=N-1;J>=0;--J){var H=O[J];E(G,H);}G.append("</es>");if(L){G.append("</a>");}}G.append("</pa>");}break;}G.append("</prm>");}G.append("</prms>");}G.append("</hl>");}return G.toString();}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.func","mstrmojo.Obj");var K=mstrmojo.hash;var P=0;var F=[];var J={};var L=false;function I(T){var U=T.callback;if(U.submission){U.submission(T.id,this.userInteractionRequired(T),T);}this.submitRequest(T);}function G(){if(F.length&&!L){I.call(this,F.shift());}}mstrmojo.ServerProxy=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ServerProxy",transport:null,cnt:0,request:function E(d,a,U,V){if(U){this.cancelRequests();}var X=this.id,Y=this.transport,T=mstrmojo.now()+a.taskId+P++,W=d.canceled||mstrmojo.emptyFn;d.canceled=function(e){W();d.complete(true);return Y.cancelRequest(e);};d=mstrmojo.func.wrapMethods(d,{complete:function(e){mstrmojo.all[X].deleteRequest(e);}});var Z=!K.isEmpty(this._requests),b=this.createRequest(T,d,a,V),c=(L||Z)&&!V.doNotHold;if(c){F.push(b);}else{I.call(this,b);}return T;},hasRequests:function O(){return !K.isEmpty(this._requests)||L;},createRequest:function Q(V,X,W,T){var U=this._requests;if(!U){U=this._requests={};}U[V]={id:V,callback:X,params:W,config:T};return U[V];},submitRequest:function M(T){this.transport.serverRequest(this.id,T.id,T);},cancelRequests:function S(){var T=false;K.forEach(this._requests,function(U){if(U.gotResponse===undefined){T|=U.callback.canceled(U.id);}});this._requests={};F=[];return T;},cancelRequest:function B(X){var U=false,W=this._requests[X],V,T=F.length;for(V=0;V<T;V++){if(F[V]===W){break;}}if(V<T){F.splice(V,1);delete this._requests[X];U|=W.callback.canceled(W.id);}return U;},response:function A(X,T,V){$MAPF(false,"AndroidServerTransport","transportRequest");var W=this.getRequest(X);if(W){W.gotResponse=true;var Y=W.callback,U=(T&&!V.mstrerr)?"success":"failure";try{if(Y[U]){Y[U](V,W);}}finally{Y.complete(X);}}G.call(this);},deleteRequest:function N(U){var T=this._requests;delete T[U];},getRequest:function H(U){var T=this._requests;return T&&T[U];},userInteractionRequired:function C(T){return false;},addLoadingGraph:function D(T){J[T]=true;L=true;},removeLoadingGraph:function R(T){delete J[T];if(K.isEmpty(J)){L=false;G.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array");var B=mstrmojo.array;mstrmojo.ObjectBrowserDataProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.ObjectBrowserDataProvider",path:mstrConfig.taskURL,serverRequest:function(C,D){if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(C,D,{silent:true});}else{mstrmojo.xhr.request("POST",this.path,D,C,undefined,this.XServer,this.baseParams);}},fetchFolderContents:function(C,D,G){var E=C.blockCount,F={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockCount:E,includeAncestorInfo:"true",includeObjectDesc:C.includeObjectDesc};if(C.folderLinksContextId){F.folderLinksContextId=C.folderLinksContextId;}if(C.sId){F.sessionState=C.sId;}if(D.fid){F.rootFolderID=D.fid;}else{if(D.fty){F.rootFolderType=D.fty;}}if(C.browsableTypes){F.objectType=C.browsableTypes;}if(D.blockBegin){F.blockBegin=D.blockBegin;}if(D.searchPattern){if(C.enableQuickSearch){F.quickSearch=C.enableQuickSearch;}F.searchPattern=D.searchPattern;if(D.recursive){F.recursive=D.recursive;}}this.serverRequest(F,G);},newFolder:function(F,G,E,C){var D={taskId:"createFolder",taskContentType:"json",folderID:F,name:G,description:E};this.serverRequest(D,C);},loadObjects:function A(G,H,C,F){var D=[],E=[];B.forEach(G,function(I){D.push(I.did);E.push(I.t);});if(G.length>0&&F){this.serverRequest({taskId:"getObjectInfo",objectIDs:D.join(","),objectTypes:E.join(","),includeDetails:true},H,C);}else{H.success();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash");var E=mstrmojo.hash;mstrmojo.threshold.PropertyModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.PropertyModel",threshold:undefined,gridValueFormat:undefined,submitChange:function F(){this.raiseEvent({name:"propertyModelChange",threshold:this.threshold});},updateControl:function D(H){var G=this.threshold,I=E.copy(G.fmt,this.gridValueFormat);H.textGroup.setFormatSource(G);H.charGroup.setFormatSource(I);H.containerGroup.setFormatSource(I);},changeFormatProperty:function B(H,I,K){var G=this.threshold,J=H==="threshold"?G:G.fmt;if(!J&&H==="fmt"){J=G.fmt={};}J[I]=K;},getReplaceTypeName:function A(){return"rtp";},getReplaceTextName:function C(){return"rtxt";}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.hash","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport");var BasicAggMap={"8107C31BDD9911D3B98100C04F2233EA":"Sum","548C68A0F60811D3ACC300C04F0423DE":"StdevP","8107C31FDD9911D3B98100C04F2233EA":"Max","8107C331DD9911D3B98100C04F2233EA":"GeoMean",B2C0FA4220C711D6AD1400C04F0423DE:"First","8107C32CDD9911D3B98100C04F2233EA":"Product",B2C0FA4020C711D6AD1400C04F0423DE:"Greatest","8107C330DD9911D3B98100C04F2233EA":"Var","8107C32FDD9911D3B98100C04F2233EA":"Stdev","8107C32DDD9911D3B98100C04F2233EA":"Median",B2C0FA4320C711D6AD1400C04F0423DE:"Last","8107C31CDD9911D3B98100C04F2233EA":"Count","8107C31DDD9911D3B98100C04F2233EA":"Avg","8107C31EDD9911D3B98100C04F2233EA":"Min","8107C32EDD9911D3B98100C04F2233EA":"Mode",D64F1B10F6C011D3ACC300C04F0423DE:"VarP",B2C0FA4120C711D6AD1400C04F0423DE:"Least"},RankMap={"8107C326DD9911D3B98100C04F2233EA":"Rank"},OLAPAggMap={D221F90EB35540E3A1204ED6CC9A8267:"Avg",D221F90FB35540E3A1204ED6CC9A8267:"Count",D221F910B35540E3A1204ED6CC9A8267:"Max",D221F911B35540E3A1204ED6CC9A8267:"Min",D221F90DB35540E3A1204ED6CC9A8267:"Sum"},MovingAggMap={"8107C32ADD9911D3B98100C04F2233EA":"Avg","8107C350DD9911D3B98100C04F2233EA":"Count","8107C34BDD9911D3B98100C04F2233EA":"Max","8107C34CDD9911D3B98100C04F2233EA":"Min","8107C32BDD9911D3B98100C04F2233EA":"Sum"},RunningAggMap={"8107C329DD9911D3B98100C04F2233EA":"Avg","8107C354DD9911D3B98100C04F2233EA":"Count","8107C351DD9911D3B98100C04F2233EA":"Max","8107C352DD9911D3B98100C04F2233EA":"Min","8107C328DD9911D3B98100C04F2233EA":"Sum"},BandingMap={"8107C337DD9911D3B98100C04F2233EA":"Banding","8107C338DD9911D3B98100C04F2233EA":"BandingC","8107C339DD9911D3B98100C04F2233EA":"BandingP"};function _sortFunctions(fcts){var fs=function(a,b){return mstrmojo.array.stringSorter(a.n,b.n);},i,len;fcts=fcts.sort(fs);for(i=0,len=fcts.length;i<len;i++){fcts[i].fns=fcts[i].fns.sort(fs);}return fcts;}function getFuncCatIndex(fcts,funcDid){var len=fcts.length,ci;for(ci=0;ci<len;ci++){var fns=fcts[ci].fns;if(mstrmojo.array.find(fns,"did",funcDid)>-1){return ci;}}return -1;}function buildTaskParams(params){var qse=mstrApp&&mstrApp.useQuickSearch&&mstrApp.useQuickSearch();params=mstrmojo.hash.copy(params,{taskId:"searchMetadata",recursive:true,styleName:"MojoFolderStyle",includeObjectDesc:true,includeAncestorInfo:false});if(qse){params.quickSearch=qse;params.nameWildcards=16;params.sortKey=-1;}return params;}function serverRequest(callback,taskParams){if(mstrApp.serverRequest){mstrApp.serverRequest(taskParams,callback);}else{window.$MAPF=function(){return false;};this.getServerProxy().request(callback,taskParams,false,{});}}mstrmojo.ME.MetricDataService=mstrmojo.provide("mstrmojo.ME.MetricDataService",{rootFolderTypes:{ALL:39,FILTERS:4,METRICS:5,FACTS:29,SCHEMA:24,ATTRIBUTES:26,TRANSFORMATIONS:38},blockCount:10,suggestCount:10,suggestDelay:200,noCache:true,functions:null,metricComponents:null,functionsDetails:null,getServerProxy:function getServerProxy(){if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}return this.serverProxy;},getMetricDefintion:function getMetricDefintion(params,callbacks){var taskParams={taskId:"getMetricDefinition",metricId:params.id,outputFlags:65599};if(params.msgID){taskParams.msgID=params.msgID;}serverRequest.call(this,callbacks,taskParams);},validateMetric:function validateMetric(params,callbacks){var taskParams={taskId:"validateMetric",metricId:params.metricId,tokenStreamXML:params.tokenStreamXML,metricXML:params.metricXML,outputFlags:327695};if(mstrmojo.string.isEmpty(params.metricId)){taskParams.isNew=true;}if(params.msgID){taskParams.msgID=params.msgID;}if(params.formID){taskParams.frmid=params.formID;}if(params.isIDForm){taskParams.isIDForm=params.isIDForm;}if(params.objectType){taskParams.objectType=params.objectType;}serverRequest.call(this,callbacks,taskParams);},getMetricComponents:function getMetricComponents(params,callbacks){var me=this,mc=this.metricComponents;if(!this.noCache&&mc&&mc.items.length==mc.sz){callbacks.success(mc);return ;}callbacks.success=mstrmojo.func.composite([callbacks.success,function(res){if(me.metricComponents&&me.metricComponents.items){me.metricComponents.items.push(res.items);}else{me.metricComponents=res;}}]);var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||24,objectType:params.objectType||"12,13,43"});serverRequest.call(this,callbacks,taskParams);},getAttributes:function getAttributes(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||26,objectType:12});serverRequest.call(this,callbacks,taskParams);},getFacts:function getFacts(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||29,objectType:13});serverRequest.call(this,callbacks,taskParams);},getMetrics:function getMetrics(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||5,objectType:4});if(params.isVerify){taskParams.nameWildcards=2;}serverRequest.call(this,callbacks,taskParams);},getFunctions:function getFunctions(callbacks){var me=this,wss=window.sessionStorage,fcts=this.functions||(wss&&wss.getItem("functions")),localeId=wss&&wss.getItem("mstrLocaleId"),cLocaleId=mstrApp&&mstrApp.localeId;if(fcts&&localeId==cLocaleId){fcts=_sortFunctions(eval("("+fcts+")").fncs);callbacks.success(fcts);}else{var cb={failure:callbacks.failure,textResponse:true},taskParams={taskId:"getSystemFunctions",includeFunctionDetails:true,functionFlags:2|2147483648,includeFunctionHelpTopic:true};cb.success=function(res){if(typeof res==="string"||!mstrApp.isSingleTier){if(wss){wss.setItem("functions",res);wss.setItem("mstrLocaleId",cLocaleId);}me.functions=res;fcts=_sortFunctions(eval("("+res+")").fncs);}else{fcts=_sortFunctions(res.fncs);me.functions=JSON.stringify(res);}callbacks.success(fcts);};serverRequest.call(this,cb,taskParams);}},getAggFunctions:function getAggFunctions(){if(this._aggFunctions){return this._aggFunctions;}var fcts=this.functions||(window.sessionStorage&&window.sessionStorage.getItem("functions"));if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.array.filter(fcts[this.getBasicCategoryIndex(fcts)].fns,function(item){var did=item.did,retVal;if(did!=="B2C0FA4020C711D6AD1400C04F0423DE"&&did!=="B2C0FA4120C711D6AD1400C04F0423DE"){retVal=BasicAggMap[did];}return retVal;});return fcts;},getOLAPAggFunctions:function getOLAPAggFunctions(type){var fcts=this.functions||(window.sessionStorage&&window.sessionStorage.getItem("functions"));if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.array.filter(fcts[this.getOLAPCategoryIndex(fcts)].fns,function(item){switch(type){case"moving":return MovingAggMap[item.did];case"running":return RunningAggMap[item.did];case"olap":default:return OLAPAggMap[item.did];}return false;});return fcts;},getFunctionCatList:function getFunctionCatList(){if(this._functionCatList){return this._functionCatList;}var fcts=this.functions||(window.sessionStorage&&window.sessionStorage.getItem("functions"));if(!fcts){mstrmojo.alert("We shall not reach this point!");}fcts=_sortFunctions(eval("("+fcts+")").fncs);fcts=mstrmojo.hash.make(fcts,mstrmojo.Arr);this._functionCatList=fcts;return fcts;},getCategoryIndex:function getCategoryIndex(funcDid,fcts){return getFuncCatIndex(fcts||this.getFunctionCatList(),funcDid);},getBasicCategoryIndex:function getBasicCategoryIndex(fcts){var Agg_Func_Greatest="B2C0FA4020C711D6AD1400C04F0423DE";return getFuncCatIndex(fcts||this.getFunctionCatList(),Agg_Func_Greatest);},getDataMiningCatIndex:function getDataMiningCatIndex(fcts){var DataMining_Func_MiningModel="F17CD4F3FF134D91B80DDAB9CA73C919";return getFuncCatIndex(fcts||this.getFunctionCatList(),DataMining_Func_MiningModel);},getDateTimeCategoryIndex:function getDateTimeCategoryIndex(fcts){var DateTime_Func_Date="C50F2A4F75AE49D6B20E00224967B500";return getFuncCatIndex(fcts||this.getFunctionCatList(),DateTime_Func_Date);},getStringCategoryIndex:function getStringCategoryIndex(fcts){var String_Func_Concat="6F7DF5FF449111D5BEA300B0D01A55EF";return getFuncCatIndex(fcts||this.getFunctionCatList(),String_Func_Concat);},getOLAPCategoryIndex:function getBasicCategoryIndex(fcts){var OLAP_Func_Avg="D221F90EB35540E3A1204ED6CC9A8267";return getFuncCatIndex(fcts||this.getFunctionCatList(),OLAP_Func_Avg);},getInternalCategoryIndex:function getInternalCategoryIndex(fcts){var INTER_Func_Band="8107C337DD9911D3B98100C04F2233EA";return getFuncCatIndex(fcts||this.getFunctionCatList(),INTER_Func_Band);},getFunctionDetails:function getFunctionDetails(params,callbacks){var taskParams={taskId:"getSystemFunctions",functionId:params.did,includeFunctionDetails:true,includeFunctionHelpTopic:true};serverRequest.call(this,callbacks,taskParams);},getTransformations:function getTransformations(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||38,objectType:43});serverRequest.call(this,callbacks,taskParams);},getFilters:function getFilters(params,callbacks){var taskParams=buildTaskParams({blockBegin:params.blockBegin,blockCount:params.blockCount,searchPattern:params.pattern,rootFolderType:params.rootFolderType||4,objectType:1});serverRequest.call(this,callbacks,taskParams);},getAttributeForms:function getAttributeForms(params,callbacks){var taskParams={taskId:"getAttributeForms",attributeID:params.attributeID,displayedForms:params.displayedForms,styleName:"WidgetElementListStyle"};serverRequest.call(this,callbacks,taskParams);},getSubtotalFunctions:function getSubTotalFunctions(params,callbacks){var taskParams=buildTaskParams({objectType:"1025,1026",searchPattern:""});serverRequest.call(this,callbacks,taskParams);},isBasicAggMap:function isBasicAggMap(did){var retVal=!!BasicAggMap[did];if(did==="B2C0FA4020C711D6AD1400C04F0423DE"||did==="B2C0FA4120C711D6AD1400C04F0423DE"){retVal=false;}return retVal;},isOLAPAgg:function isOLAPAgg(did){return !!OLAPAggMap[did];},isMovingAgg:function isMovingAgg(did){return !!MovingAggMap[did];},isRunningAgg:function isRunningAgg(did){return !!RunningAggMap[did];},isBanding:function isBanding(did){return !!BandingMap[did];},isOLAP:function isOLAP(did){var fcts=this.getFunctionCatList(),olapFns=fcts[this.getOLAPCategoryIndex(fcts)].fns;return mstrmojo.array.find(olapFns,"did",did)>-1;},isRank:function isRank(did){return !!RankMap[did];},isScalar:function isScalar(fctOi){return(fctOi||{}).sqt===3;},getFunctionHelpTopic:function getFunctionHelpTopic(h){return'<a href="'+((mstrApp.helpUrl||"../help/")+"FunctionsRef/index.html?context=functionsref&topic="+(h||""))+'" target="_new">'+mstrmojo.desc(5811,"Details ...")+"</a>";},sortFunctions:function sortFunctions(functions){var allfuncs={},fs=function(a,b){return mstrmojo.array.stringSorter(a.n,b.n);};mstrmojo.array.forEach(functions,function(funcs){mstrmojo.array.forEach(funcs&&funcs.fns,function(func){if(func&&func.did){allfuncs[func.did]=func;}});});return mstrmojo.hash.valarray(allfuncs).sort(fs);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.array","mstrmojo.StringBuffer","mstrmojo.ResSetLink");var h=1,S=2;var E=2,K=4,D=5;var V=1,N=4;var f=mstrmojo.array;function H(j,k){return j[((k===h)?"row":"col")];}function B(j,l){var k=l.lm;return k&&k[j.mix||0];}function b(k,p,w){var u=new mstrmojo.ResSetLink({mid:this.getMessageId(),srct:2,aopam:p.daMode});var q=p.ans,v=q&&q.length;if(v){var r=u.prms=[],l=0;for(l=0;l<v;l++){var AB=q[l];var m=AB.pid,o=parseInt(AB.m,10),AA={id:m,am:o,pt:AB.pt};r.push(AA);if(AB.po){AA.orid=AB.po.did;AA.ortp=AB.po.t;}switch(o){case u.DO_NOT_ANSWER:case u.CLOSE:case u.USE_DEFAULT_ANSWER:case u.SAME_PROMPT:break;case u.STATIC:var j=AB.es,x=(j&&j.length)||0,t;AA.pa={es:[]};for(t=x-1;t>=0;--t){var n=j[t];AA.pa.es.push({ei:n.id,disp_n:n.n,emt:1});}break;case u.DYNAMIC:case u.ALL_VALID_UNITS:case u.CURRENT_UNIT:case u.DYNAMIC_OR_SAME_PROMPT:if(w.els){A.call(this,AB,w,AA,o,u);}else{J.call(this,AB,w,AA,o,u);}break;}}}return u;}function A(q,k,j,p,o){var n=q.dunits,l=k.els,m=j.pa={};f.forEach(l,function(r){if(f.find(n,"id",r.id)>=0){if(p!==o.DYNAMIC&&p!==o.DYNAMIC_OR_SAME_PROMPT){m.a={id:r.id,n:r.disp_n,dispForms:r.dfi};}if(q.pt===1){m.v=r.v;}else{m.es=[];m.es.push({ei:r.ei,emt:r.emt,disp_n:r.disp_n});}}});}function J(x,t,w,n,p,o){var q=x.dunits;if(q&&q.length&&t){var r=w.pa={};var m=t,l=(t.mix!==undefined)&&(t._lp||t._tp);if(l){m=t._lp||t._tp;}var k=parseInt(m.axis,10);while(m){var u=this.getPTitle(m,k);if(u&&f.find(q,"id",u.id)>=0){if(n!==p.DYNAMIC&&n!==p.DYNAMIC_OR_SAME_PROMPT){r.a={id:u.id,n:u.n,dispForms:u.dfi};}if(x.pt===1){r.v=m.v;break;}else{var j=m._e.id,v=m._e.n;r.es=[];r.es.push({ei:j,emt:1,disp_n:v});}if(n===p.CURRENT_UNIT){break;}}m=this.getPCellParentNode(m,k);if(l&&!m&&k===h){k=S;m=t._tp;}}}}function Q(l){var k=this.getCellTitleInfo(l[0]),n=[],p=function(q){if(q){if(mstrApp.useBinaryFormat){if(q._e){n.push(q.axis+"A"+(q.ui+1)+"A"+q._e.id);}p(q._p);}else{n.push(q.axis+"A"+(q.ui+1)+"A"+q.o);}}},m,j;if(!k.isSrcTitle){for(m=0,j=l.length;m<j;m++){var o=l[m];if(o.mix!==undefined&&(o._lp||o._tp)){p(o._lp);p(o._tp);}else{p(o);}}}return(mstrApp.useBinaryFormat)?n:n.join(",");}mstrmojo.XtabModel=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabModel",getMessageId:function R(){return this.data.mid;},getCellTitleInfo:function c(k,n){var l=n?n.gts:this.data.gts;var m=null;if(k&&k.mix===undefined){m=H(l,k.axis)[k.tui||k.ui];}else{var j=function(q){var o=(q&&q.length)||0,p;for(p=o-1;p>=0;--p){if(parseInt(q[p].otp,10)===-1){return q[p];}}return null;};m=j(l.col)||j(l.row);}return{isSrcTitle:!!k&&(k.o===undefined)&&!((k.mix!==undefined)&&(k._lp||k._tp)),title:m};},getCellInfo:function I(k){var j=this.getCellTitleInfo(k),l={isTitle:false,isHeader:false,isMetric:false};if(k&&(k.hasOwnProperty("mix")||k.otp===-1)){l.isMetric=true;if(k._e){l.isHeader=true;}}if(j.isSrcTitle){l.isTitle=true;}return l;},getCellLinksInfo:function e(k,l){if(!l){var j=this.getCellTitleInfo(k);l=j&&j.title;}return B(k,l);},getAllDrillPathsForCell:function Z(k,l){if(!l){var j=this.getCellTitleInfo(k);l=j&&j.title;}return l.dp||[];},getCellDrillsInfo:function G(j,l){var k=this.getAllDrillPathsForCell(j,l);return k&&k[j.mix||0];},getLinkDrillAction:function O(j){return this.getActionObject(j);},getAction:function U(j){return this.getActionObject(j);},getActionObject:function L(k){var j=k[0]&&k[0].at,l=null;if(j){if((j&N)>0){l={h:"onLink",a:this.getLinkAction(k[0])};}else{if((j&V)>0){l={h:"onDrill",a:this.getDrillAction(k)};}}}return l;},getSortAction:function F(z,r){var n=this.getCellTitleInfo(z),v=n.title,x=this.data.gts[((z.axis===h)?"row":"col")+"SubPos"],k=[],m=v.axis,p,u,t,w,AA;r=(r===null||r===undefined)?!(z&&z.so):r;if(n.isSrcTitle){p=E;u=v.id;t=v.otp;w=v.fid;}else{p=K;t=4;m=f.find(this.data.gts.col,"otp",-1)>-1?h:S;x=this.data.gts.rowSubPos;AA=v.stt;var q,j;do{q=z._e;if(q){if(q.oid){u=q.oid;}else{j=q.id.replace(/;/g,"\\;");k.push(j);}}z=z._p;}while(z);}var o={sortType:p,axis:m,isAsc:r,unitID:u,unitType:t,elementList:k.join(";"),subTotalsPos:x};if(u){o.unitID=u;}if(w){o.formId=w;}if(AA){o.sortType=D;o.stt=AA;}var l;if((p===K)||(p===D)){l=["","",o.elementList||"",o.axis];}else{l=[o.formId,"21","",o.axis];}l=[o.unitType,o.unitID].concat(l);o.sortKey=l.join("!");return o;},getSubTotalsPos:function X(){var j=this.data.gts;if(j){return[j.rowSubPos,j.colSubPos];}return[0,0];},getPivotAction:function M(x,l){var v=false,z=x.hasOwnProperty("mix"),j=z?null:x.axis,w=(z?x.idx:x.ui)+1,k=(x.otp===-1);if(!isNaN(l)){j=parseInt(l,10);w=1;if(z){z=false;k=true;}}else{var p=(l==="u"||l==="l"||l==="b");if(!z){var o=H(this.data.gts,j),n=0,m={},r=false;mstrmojo.array.forEach(o,function(AA){if(m[AA.id]){m[AA.id].frm++;}else{n++;m[AA.id]={pos:n,frm:1};if(AA.id===x.id){r=true;}else{if(r){return false;}}}});w=m[x.id].pos;var t=x.fix;if(t){if(!p||t>1){if(p||t!==m[x.id].frm){w=t;v=true;}}}}if(l==="b"){w=1;}else{w=w+(p?-1:1);}}var q={act:"pivot",unitPos:w};if(v){q.attFormId=x.fid;}else{if(!z){q.axis=j;}}if(!k){var u=z?x._e:x;if(!v){q.unitType=u.otp;}q.unitId=z?u.oid:x.id;}return q;},isPvtButtonVisible:function d(q,l){var n=q.axis,m=H(this.data.gts,n),p=q.ui,k=q.hasOwnProperty("mix");if(l==="b"&&p===0){return false;}if(!isNaN(l)){if(parseInt(l,10)===n){return false;}if(k){return !!m[q.ui]._hid;}return true;}var o=m[q.ui].es,j=k?o.length:m.length;if(j===1){return false;}if(n===(k?S:h)){if(l==="u"||l==="d"){return false;}}else{if(l==="l"||l==="r"){return false;}}if(k?q._e===o[0]:p===0){if(l==="l"||l==="u"){return false;}}if(k?q._e===o[j-1]:p===j-1){if(l==="r"||l==="d"){return false;}}return true;},getDrillAction:function C(j,l){var k=l||this.getCellDrillsInfo(j[0]);return{srcMsgId:this.data.mid,sliceId:this.xtab.sid,isWithin:k.within,drillPathKey:k.k,drillPathIndex:k.dpi,drillElements:Q.call(this,j)};},isVis:function a(){if(this.xtab){return this.xtab.isVis&&this.xtab.isVis();}else{var j=this.controller&&this.controller.view;if(j&&j.isVis){return j.isVis();}}return false;},getPTitle:function g(l,k){var j;if(this.isVis()){j=l.titleInfo;}else{j=H(this.data.gts,k)[l.tui];}return j;},getPCellParentNode:function P(l,k){var j;if(this.isVis()){j=(k==h)?l._lp:l._tp;}else{j=l._p;}return j;},getLinkAction:function T(l,k){var j,m;if(this.isVis()){l=l.node;m=l.titleInfo;}else{j=this.getCellTitleInfo(l);m=j.title;}return this.getLinkActionImpl(l,m,k);},getLinkActionImpl:function Y(w,r,u){var l=B(w,r),t=l&&l.links,x=(l&&l.onw)?"_blank":"";if(u===null||u===undefined){u=(l&&l.di)||0;}var o=t&&t[u];if(!o){return null;}var m={linkInfo:o,linkTarget:x};var j=o.url;if(j){var n="&CurrentElement";if(w&&r&&j.indexOf(n)>-1){j=j.replace(n,w._e.id);}m.url=j;}else{var p=o.target,v,k;switch(parseInt(p&&p.t,10)){case 55:if(parseInt(p.st,10)===14081){if(p.dvm&(8192|2048)&&!((p.dvm&2048&&mstrApp.features["run-vi-flash"]))){v=3140;if(mstrmojo.dom.isIE6||mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(12187,"To work with HTML5 dashboards, please turn off your browser Compatibility View or update your browser to one of the following browser versions: Chrome, Firefox, Safari, Internet Explorer 9 or above."));return null;}}else{v=2048001;}k="objectID";}else{v=32001;k="documentID";}break;case 3:v=4001;k="reportID";m.reportViewMode=((parseInt(p.st,10)===769)?2:1);break;default:return null;}m.evt=v;m[k]=p.did;m.srcMsgId=this.getMessageId();var q=b.call(this,l,o,w);if(q){m.link=q;}return m;}},getDownloadAction:function W(m,k,o,l,n,j){return{xtabId:n,rowPosition:m,maxRows:k,colPosition:o,maxColumns:l,memo:j};}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.func","mstrmojo.DocDataService");var R=mstrmojo.hash.copy,c=mstrmojo.array.forEach,l=mstrmojo.func,I=l.wrapMethods;var F=2,U=1,f=1,j=2,a=3;var A={FIRST:1,MIDDLE:2,LAST:3};var k={BUSY:1,INTERIM:2,DONE:3,SILENT:4,CANCELED:5};var S=R(mstrmojo.DocDataService.SUPPRESS_DATA,{preserveUndo:true,config:{silent:true}});function G(){c(this._delayRemovedCmds,function(t){t.discard();});this._delayRemovedCmds=null;}function V(){this.cmds=this.cmds.concat(this._delayRemovedCmds);this._delayRemovedCmds=null;}function J(u){var t=this.cmds,v=this.pos;this._delayRemovedCmds=t.splice(v+1);if(v>=this.size-1){t.shift().discard();}t.push(u);this.pos=t.length-1;}function q(t,u){t.reset();throw new Error(u||"Invalid state.");}mstrmojo.vi.controllers.UICmdMgr=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmdMgr",cmds:null,pos:-1,size:20,_delayRemovedCmds:null,controller:null,dataService:null,model:null,state:U,STATE:{EXECUTING:F,IDLE:U},CMD_PHASE:A,init:function m(t){R(t,this);this.cmds=[];},execute:function d(v){if(this.state===F){q(this);}try{v=R(v,{mgr:this,undoUIState:this.model.getUIState(),action:j});var t=this.curCmd=new mstrmojo.vi.controllers.UICmd(v);J.call(this,t);this.state=F;t.execute();}catch(u){this.reset();throw u;}},getInterimCmd:function B(){if(this.state===F){var t=this.cmds[this.pos];if(t.state===k.INTERIM){return t;}}return null;},undo:function T(v){if(this.canUndo()){this.state=F;try{var t=this.curCmd=this.cmds[this.pos--];t.action=f;t.redoUIState=this.model.getUIState();t.undoRedo(v);}catch(u){this.reset();throw u;}}},redo:function H(){if(this.canRedo()){this.state=F;try{var t=this.curCmd=this.cmds[++this.pos];t.action=a;t.undoUIState=this.model.getUIState();t.undoRedo();}catch(u){this.reset();throw u;}}},onSuccess:function b(t){if(this.state===U){q(this);}if(t!==this.curCmd){q(this,"Wrong command");}this.state=U;G.call(this);this.controller.onCmdMgrChanged();},onFailure:function p(){G.call(this);this.reset();},onCancel:function Z(u,v){this.state=U;var t=!!u.submitCount;if(t){this.undo(v);}else{this.pos--;}this.cmds.pop();u.discard();if(t){G.call(this);}else{V.call(this);}this.controller.onCmdMgrChanged();},reset:function e(){c(this.cmds,function(t){t.discard();});this.cmds.length=0;this.pos=-1;this.state=U;this.controller.onCmdMgrChanged();},resetState:function Y(){this.state=U;},canUndo:function X(){return this.state===U&&this.pos>=0;},canRedo:function L(){return this.state===U&&this.pos<this.cmds.length-1;},onSubmitUpdates:function P(){if(this.state===U){this.cmds.splice(this.pos+1);this.controller.onCmdMgrChanged();}},isUndoRedo:function C(){var t=this.curCmd||{};if(this.state===F&&(t.action===f||t.action===a)){return true;}return false;}});function W(t,v,u){if(v.stid==="undefined"){u.submission=function(AA,w,x){var AB=x.params,z=JSON.parse(AB.params);z.actions[0].stid=t.action===f?t.undoStateId:t.redoStateId;AB.params=JSON.stringify(z);};}return u;}function E(u,z){var v=u.mgr;z.disablePU=true;var x=W(u,z,{success:function w(){u.state=k.DONE;},failure:function t(){v.onFailure();}});u.state=k.SILENT;v.dataService.submitUpdates(z,x,S);v.onSuccess(u);}function g(AE,z){var AD=AE.urInfo,AC=AD.puKeys,AJ=AD.puObjs,AA=AD.puFilters,AF=AE.mgr,AB=AF.model,AG=AF.dataService;if(AC||AJ){if(AC){z.partialRetrieval={nodes:AC,filters:AA};}if(AJ){AB.addUpdateObjects(z,AJ);}}else{z.disablePU=true;}var w=W(AE,z,{success:function AI(){AE.state=k.DONE;AF.onSuccess(AE);AB.restoreUIState(AE.action===f?AE.undoUIState:AE.redoUIState);},failure:function v(){AF.onFailure();},complete:function u(){AF.resetState();}}),t=AD.callback||AB.getRebuildCallback(),AH=I(t,w),x=R(AD.extras);if(z.act==="undo"&&x!==undefined){x.hideCancel=true;if(z.killJob){x.message=mstrmojo.desc(14586,"Canceling...");}}AE.state=k.BUSY;AG.submitUpdates(z,AH,x);}function N(w){var t=w.urInfo,u=w.mgr.model;if(!t.extras){var v=(t.treesToRender!==undefined)?t.treesToRender:w._treesFromRes;if(!t.disablePU&&!w._hasFullUpdate&&(!t.puKeys||!t.puKeys.length)){v=0;t.callback=I(u.getDatasetsUpdateCallback(),t.callback);}t.extras={style:{params:{treesToRender:v}}};}}mstrmojo.vi.controllers.UICmd=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.vi.controllers.UICmd",mgr:null,redoStateId:null,undoStateId:null,execute:mstrmojo.getMissingFn(),discard:mstrmojo.emptyFn,action:null,state:k.INTERIM,urInfo:null,getStateValue:function Q(u,t){return this.action===f?t:u;},init:function m(t){R(t,this);this._treesFromRes=0;this.urInfo=this.urInfo||{};this.submitCount=0;},undoRedo:function h(AA){var v=this,x,u=this.urInfo,t=u.silent,AB,w=this.mgr,z=w.dataService;if(v.action===a){x={act:"redo",stid:v.redoStateId};AB=u.redo;}else{if(v.action===f){x={act:"undo",stid:v.undoStateId,killJob:AA};AB=u.undo;}else{q(this.mgr);}}if(AB){z.blockRequests=true;try{t=!!AB.call(v)||t;}finally{z.blockRequests=false;}}if(t){E(v,x);}else{g(v,x);}},submitUpdate:function O(u,t){this.submit(u.actions,u.callback,u.extras,t);},submit:function M(x,AI,w,AG){var AD=this,AE=AD.mgr,AA=AE.model,AF=AE.dataService,AC=mstrmojo.array.ensureArray(x);AI=AI?R(AI):AA.getRebuildCallback();AD.state=k.BUSY;function z(AJ,AK){return !(AJ&&AJ[AK]&&AJ[AK].length);}if(AD._hasFullUpdate||AC.some(function(AJ){return AJ.disablePU;})||AC.every(function(AK){var AL=AK.partialRetrieval,AJ=AK.partialUpdate;return z(AL,"nodes")&&z(AJ,"nodes")&&z(AJ,"selectors")&&z(AJ,"objects");})){AD._hasFullUpdate=true;}l.override({submission:function v(){if(AD.submitCount===0){AD.undoStateId=AF.stid;}AD.submitCount++;},success:function AH(AN,AO){if(AD.action!==j){q(AE);}AD.redoStateId=AN.stid;var AM=!AG||AG===A.LAST;if(AM){AD.state=k.DONE;}else{AD.state=k.INTERIM;}var AL=AD.urInfo;if(!AL.disablePU){var AJ=AL.puKeys||[],AP=AN.pukeys&&AN.pukeys.split("\u001E");if(AP&&AP.length){AJ=AJ.concat(AP);var AK=AL.extraPuKeys;if(AK){AJ=AJ.concat(AK);delete AL.extraPuKeys;}}if(AJ.length){AL.puKeys=AJ;}}AD._treesFromRes|=(AN.defn?1:0)|(AN.data?2:0);if(this._super){this._super(AN,AO);}if(AM){AD.completeSubmit();}},failure:function u(AJ,AM){var AL=(w&&w.skipUICmdMgrOnFailure)||[],AK=parseInt(AJ.code||(AJ.getResponseHeader&&AJ.getResponseHeader("X-MSTR-TaskErrorCode"),10));if(AL.indexOf(AK)===-1&&AL.indexOf(mstrmojo.mstr.EnumWebAPIErrorCodes.E_UNUSED)===-1){AE.onFailure();}if(this._super){this._super(AJ,AM);}},canceled:function AB(AJ){if(this._super){this._super(AJ);}window.setTimeout(function(){AD.cancel(true);},0);},complete:function t(){if(!AG||AG===A.LAST){AE.resetState();}if(this._super){this._super();}}},AI);AF.submitUpdates(x,AI,w);},submitInterim:function o(u,v,t){this.submit(u,v,t,A.MIDDLE);},resetCmdMgrOnComplete:function n(){this._resetMgr=true;},completeSubmit:function K(){var u=this,v=u.mgr,t=v.model;if(!u.completed){u.completed=true;u.state=k.DONE;v.onSuccess(u);N(u);u.redoUIState=t.getUIState();if(u._resetMgr){v.reset();}}},cancel:function D(t){this.state=k.CANCELED;N(this);this.mgr.onCancel(this,t);},submitSilent:function r(v){var x=this,z=x.mgr,w=z.model,AA=z.dataService;x.state=k.SILENT;z.onSuccess(x);x.redoUIState=w.getUIState();var AB={submission:function u(){x.undoStateId=AA.stid;x.submitCount++;},success:function AC(AD){x.state=k.DONE;x.redoStateId=AD.stid;},failure:function t(){z.onFailure();}};AA.submitUpdates(v,AB,S);}});mstrmojo.vi.controllers.UICmd.CMD_PHASE=A;mstrmojo.vi.controllers.UICmd.STATES={BUSY:F,IDLE:U};}());(function(){mstrmojo.requiresCls("mstrmojo.DocDataService");mstrmojo.OIVMViewFactory=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.OIVMViewFactory",newDocDataService:function A(B){return new mstrmojo.DocDataService(B);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._RowRendTracker","mstrmojo.array","mstrmojo.chart.model.enums.EnumDSSBaseFormType");var T="<tr>";var d=['<table cellspacing="0" cellpadding="0" style="table-layout:',null,";width:",null,';mstr-tablestyle-slot" ',null,">",null,"<tbody>"];var W="&nbsp;";var I="fsbp_1 ";var b="fsbp_2 ";var B="fsbp_3 ";var Z=1,a=2,F=3,f=4,L=5,V={1:" stack-top",2:" stack-middle",3:" stack-bottom",4:" stack-bottom-last",5:" no-stack",6:" stack-full"},O=1,A=3;var e=mstrmojo.css,Q=mstrmojo.array,c=mstrmojo.chart.model.enums.EnumDSSBaseFormType;var K=4;function E(k,j){for(var l=0,h=k.length;l<h;l++){var n=k[l];var m=j.rows[n.rows].cells[n.cells];if(m){mstrmojo.css.addClass(m,I);}}}function X(k){var m=k.indexOf('src="');if(m<0){return k;}var l=k.substring(m+5),j=l.indexOf('"'),n;l=l.substring(0,j);n=l;var h=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(h&&h.getImage){n=h.getImage(l);}return k.replace(l,n);}var R=(function(){var o=/\n/g,j="<br/>",AA=/<a\s[^>]+>/gi,x="<a ",n='<a target="_blank" ',v="target=";var w='<a href="',u='" target="_blank">',r="</a>",q="<span>",l="</span>",p='<span rabtn class="raBtn ',k='"></span>',t="icon-expand",z="icon-collapse",m="<span>",h="</span>";return function(AK,AI){var AL=(AK.v||AK.n||W).replace(o,j),AM=AK.ts===c.DssBaseFormUrl,AG=AK.ts===c.DssBaseFormHTMLTag,AD=AK.lv!==undefined;if(AM){AL=w+AL+u+AL+r;}else{if(AG){(AL.match(AA)||[]).forEach(function(AN){if(AN.indexOf(v)===-1){AL=AL.replace(AN,AN.replace(x,n));}});}}if((AK.css&&AK.css.indexOf("hl")>-1)||AM){AL=q+AL+l;}if(AD){var AE=AK.lv,AB="&nbsp;&nbsp;&nbsp;&nbsp;",AC="",AH="",AJ="",AF;for(AF=0;AF<AE;AF++){AC+=AB;}if(AK.hcd&&AK.fi===undefined){AJ=p+(AK.epd?z:t)+k;}else{AC+=AB;}if(AK.axis===1){AH=m+AC+h;}AL=AH+AJ+AL;}return AL;};}());mstrmojo.GridBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._RowRendTracker],{scriptClass:"mstrmojo.GridBase",markupString:'<span id="{@id}" class="mstrmojo-Grid {@cssClass}" style="{@cssText}"></span>',markupSlots:{gridContainerNode:function(){return this.domNode;}},autoFitWindow:false,tableLayout:null,numAutoHeightRows:0,cp:null,rc:0,cc:0,cws:null,rh:null,totalColWidth:0,start:0,end:0,forceFixedSizes:true,hiliteCellsMap:null,eiMap:null,init:function J(h){this._super(h);},numColumnCanMerge:0,preBuildRendering:function D(){var h=this.cp;if(!h){return ;}h.initContent();this.rc=h.rc||0;this.cws=h.colWidths||[];this.cc=this.cws.length;this.tdWidths=h.tdWidths||[];this.tdCnt=this.tdWidths?this.tdWidths.length:0;this.start=0;this.end=this.rc-1;this.numAutoHeightRows=h.getNumAutoHeightRows&&h.getNumAutoHeightRows()||0;this.hiliteCellsMap={};this.eiMap={};this.posMap=[];this.thPosMap=[];this.totalColWidth=0;},buildRendering:function H(j){var h=this._super(j);this.renderGrid();return h;},renderGrid:function U(j){var h=this.getGridContainer();this.preBuildGridTable();this.buildGridTable(h,j);this.postBuildGridTable();},getGridContainer:function g(){return this.gridContainerNode;},buildGridTable:function G(k,h){var j=this.getTableStartMarkup();var q=this.getTableEndMarkup();if(h){this.mergeHdrsAcrossBlks=true;}var o=this.buildTableRowsMarkup(this.start,this.end,j,q).join("");if(h){var m=document.createElement("div");m.innerHTML=o;var p=k.firstChild,r=p&&p.tBodies,l=m.firstChild.tBodies[0],n=this.matchedHdrsAcrossBlks;p.appendChild(l);if(n&&n.length>0){E(n,r[r.length-2]);}}else{k.innerHTML=o;}this.markPages(this.start,this.end);},getTableStartMarkup:function P(){var j=this._getGridWidths(),h=d;h[1]=j.tableLayout;h[3]=j.totalColWidths;h[5]=this.tableCssClass?"class="+this.tableCssClass:"";h[7]="<colgroup>"+j.colgroup+"</colgroup>";if(this.tbodyStyle){h[8]='<tbody style="'+this.tbodyStyle+'">';}return h.join("");},getTableEndMarkup:function N(){return"</tbody></table>";},_getGridWidths:function Y(){var q={};var m="",k=[],p="fixed",j=this.cws,n=j.length;if(n){m=0;k=[];for(var l=0;l<n;l++){if(j[l].w!==""){m+=parseInt(j[l].w,10);}}for(l=0;l<n;l++){var h=j[l];if(h.w!==""&&!this.autoFitWindow){var o=parseInt(h.w,10);if(mstrmojo.dom.isIE7){if(o===0){k.push('<col style="width:0%;display:none"></col>');}else{k.push('<col style="width:'+(o/m*100)+'%"></col>');}}else{if(mstrmojo.dom.isWK&&o===0){k.push('<col style="width:-1px"></col>');}else{k.push('<col style="width:'+h.w+'"></col>');}}}else{k.push("<col />");p="auto";}}this.totalColWidth=m;}q.colgroup=k.join("");p=this.tableLayout||p;if(this.autoFitWindow){p=this.tableLayout||p||"fixed";m="100%";}else{if(p==="fixed"){m+="px";}else{m="auto";}}q.totalColWidths=m;q.tableLayout=p;return q;},_CELL_MARKUP:['<td rowSpan="',null,'" colSpan="',null,'" class="',null,'" ei="',null,'" style="',null,'" r="',null,'">',null,"</td>"],buildTableRowsMarkup:function S(AU,AD,A1,t,AF){var Ak=[],Aw=0;Ak[Aw++]=A1||"<table><tbody>";var AX=this.cp,AG=this.acws,AW=this.rowMerge,AB=this.headerOffset,o=this.mxPos,AJ=!!AX.gemh,Ag=AX.getRowHeight(),Au=this._CELL_MARKUP,Aj=Ag?'<tr style="height:'+(Ag?Ag+"px":"")+'">':T;var z=true,AS=true,Aq=[],Am;var Ax=function Ax(m){var j=-1;mstrmojo.array.forEach(AG,function(v,r){m=m-v;if(m<0){j=r;return false;}});return j;};var AC=function AC(r,m){var j=-1;mstrmojo.hash.forEach(AX.gemh,function(v,A2){if(r<=A2&&r+m>A2){j=A2;return false;}});return j;};var AL=function AL(A2,A3,v){var r="",m,j;j=A2.gemh&&A2.gemh[A3];if(j){m=Ax(v);if(j[m]&&j[m].v===0||o===v){r+=I;}}j=A2.gsmh&&A2.gsmh[A3];if(j){m=Ax(v);if(j[m]&&j[m].v===0||o===v){r+=B;}}return r;};var Ap,AQ,AH,At=[],Av,Al,AE=0,k=0,p,w,Ad=AX.colWidths&&AX.colWidths.length,AZ=0,n=0,h=AF||((A1&&A1.indexOf("table-layout:fixed;")!==-1)?"fixed":"auto");if(AG&&AJ){for(Av=0;Av<AG.length-1;Av++){n+=AG[Av];}}n=n||this.numColumnCanMerge;if(h==="fixed"){Ap=[];for(AQ=0,AH=this.cws.length;AQ<AH;AQ++){if(window.parseFloat(this.cws[AQ].w)<=0){Ap[AQ]=true;}else{Ap[AQ]=false;}}}this.matchedHdrsAcrossBlks=[];for(var An=AU;An<=AD;An++){AE=0;Am=Aw++;Ak[Am]=An<this.numAutoHeightRows?T:Aj;var AK=AX.getRowCells(An);var Ai=AD+1-An;var Ah=0;w=AW;p="";if(!this.mergeHdrsAcrossBlks){if(z&&AU>0&&AK.length<AX.colWidths.length){var Af=AX.getUnmergedCells(AU),AN;if(Af){Ah=Af.length;}for(Av=0,AH=Ah;Av<AH;Av++){var AP=Af[Av],AA=AP.rs;if(AA>Ai){Au[1]=Ai;Au[5]=b+AP.css;}else{Au[1]=AA||1;Au[5]=B+AP.css;}if(Ap&&Ap[k+AE]){Au[5]+=" nwFixedWidth0 ";}if(AA&&AA>1){At.push(AA);}AE+=AP.cs||1;if(AP.cet){Au[5]+=" mstrmojo-selected-cell";this.addHilitePosition(AP.cet,An,Av);}if(AP._ei){this.addExtraInfoMap(AP._ei,An,Av);Au[5]+=" pt";}Au[9]="";Au[13]=W;Au[3]=AP.cs;if(AP._ei===undefined){AN=AX.getRowCells(AP.o+(AX.cps[0]&&AX.cps[0].rc||0));AP=Q.filterOne(AN,function(j){return j.dpt===AP.dpt&&j.idx===AP.idx;});}Au[7]=AP._ei;Au[11]=An;if(AJ){if(w){p=AL(AX,An-AB,Av);}if(!!p){Au[5]=p+Au[5];}else{w=false;}p=AL(AX,AC(An-AB,Au[1]),Av);if(!!p){Au[5]=I+Au[5];w=true;}}Ak[Aw++]=Au.join("");}z=false;}}AZ=Ad;AH=AK.length;var A0;for(A0=0;A0<AH;A0++){AZ-=AK[A0].cs||1;}for(A0=0;A0<AH;A0++){var Ab=AK[A0],Ac;Ab.colIx=AZ;if(Ab.rs&&Ab.rs>Ai){Au[1]=Ai;Au[5]=I+Ab.css;if(Ab._ei){this.addExtraInfoMap(Ab._ei,An,A0);}}else{Au[1]=Ab.rs||1;Au[5]=Ab.css;}if(Ap&&Ap[k+AE]){if((Ab.cs==undefined)||((Ab.cs!=undefined)&&(Ab.cs==1))){Au[5]+=" nwFixedWidth0 ";}}if(Ab.rs&&Ab.rs>1){At.push(Ab.rs);}AE+=Ab.cs||1;if(Ab.rowType!==Z){Au[5]+=" xtab-td ";}if(Ab.cet){Au[5]+="sc_"+this.parent.k;this.addHilitePosition(Ab.cet,An,A0);}if(Ab.lv){Au[5]+=" ra ";}Ac=Ab.rowType;if(Ac){Au[5]+=V[Ac]||"";var AI=AX.getRowHeight(Ac);if(AI){Ak[Am]='<tr style="height:'+(AI?AI+"px":"")+'">';}}Au[3]=Ab.cs||1;Au[7]=Ab._ei!==undefined?Ab._ei:"";if(Ab.fs||Ab._e){this.addTitleHeaderPositionMap(An,A0+Ah,Ab);}if(Ab._ei!=null){this.addPositionMap(Ab._ei,An,A0+Ah);}Au[11]=An;if(Ab.ts===K){var AO=Ab.v;if(this.imgCacheMap){var Ar=this.imgCacheMap,Al=AO&&AO.replace(/\\/g,"/");if(Ar.cachedImg[Al]){Ab.v=AO=Ar.baseURL+Ar.cachedImg[Al];}else{if(Al&&!Ar.unCachedImg[Al]){Ar.unCachedImg[Al]=Al;}}}else{var u=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model.dataService;if(u&&u.getImage){AO=u.getImage(AO);}}if(Ab.rowType){var l=(AX.getRowHeight(Ab.rowType)||AX.rh||Ag),Ao=l,AT=this.tdWidths,Ae=Ab.colIdx,AY=0,As=0;var Az=AX.getPadding(O),AV=AX.getPadding(A);if(Ab.rowType===Z||Ab.rowType===f){As=l>(Az+AV)?(l-Az-AV):0;}else{if(Ab.rowType===a||Ab.rowType===F){As=l>2*AV?(l-2*AV):0;}else{if(Ab.rowType===L){As=l>(AV*2)?(l-AV*2):0;}}}if(Ae!=="undefined"&&Ae>-1&&AT&&AT.length>Ae){var AM=AT[Ae]&&AT[Ae].w;if(AM!=="undefined"){AY=parseInt(AM,10);}}var AR=AY>30?(AY-30):0;Au[13]='<div><div style="top:'+(-parseInt(Ao/2,10))+"px;height:"+(l-1)+"px;line-height:"+(l-1)+'px !important;">&nbsp;<img style="max-height:'+As+"px; max-width: "+AR+'px;" src="'+AO+'"></img></div></div>';}else{Au[9]="";var Ay="",x=this.parent&&this.parent.controller&&this.parent.controller.model&&this.parent.controller.model,q=x.getZoomFactor();if(q!=1){Ay='onload="this.style.height='+q+"*this.offsetHeight+'px';\"";}Au[13]='<img src="'+AO+'" '+Ay+"></img>";if(Ab.css&&Ab.css.indexOf("hl")>-1){Au[13]="<span>"+Au[13]+"</span>";}}}else{Au[9]="";if(mstrApp.useBinaryFormat&&Ab.v&&Ab.v.indexOf("img")>=0){Ab.v=X.call(this,Ab.v);}Au[13]=R(Ab,AX);}if(A0<n){if(An===AU&&this.mergeHdrsAcrossBlks){var Aa=this.rowHdsAcrossBlks;if(AS&&Ab.v&&Aa&&Aa[A0]){if(Ab.v===Aa[A0].v){Au[1]=Ab.rs||1;Au[5]=B+Ab.css;Au[13]="";this.matchedHdrsAcrossBlks.push(Aa[A0]);}else{AS=false;}}}if(AJ){if(w){p=AL(AX,An-AB,AZ);if(!!p){Au[5]=p+Au[5];if(p.indexOf(B)>=0&&An-AB>1){Au[13]=W;}}else{w=false;}p=AL(AX,AC(An-AB,Au[1]),AZ);if(!!p){Au[5]=I+Au[5];w=true;}}}if(Au[1]>=Ai&&Ab.v){Aq.push({rows:An-AU,cells:A0,v:Ab.v});}}AZ+=Ab.cs||1;Ak[Aw++]=Au.join("");}Ak[Aw++]="</tr>";for(A0=At.length-1;A0>=0;A0--){Al=At[A0];if(Al<=1){At.pop();}else{At[A0]=--Al;}}k=At.length;}Ak[Aw++]=t||"</tbody></table>";this.rowHdsAcrossBlks=Aq;return Ak;},addHilitePosition:function(j,k,h){var l=this.hiliteCellsMap[j];if(!l){this.hiliteCellsMap[j]={pos:[],nodes:[]};}this.hiliteCellsMap[j].pos.push({row:k,cell:h,page:0});},addExtraInfoMap:function(j,h,k){if(!this.eiMap[j]){this.eiMap[j]=[];}this.eiMap[j].push({row:h,cell:k,page:0});},addPositionMap:function(j,h,k){if(!this.posMap[j]){this.posMap[j]={row:h,cell:k,page:0};}},addTitleHeaderPositionMap:function(h,k,j){this.thPosMap.push({row:h,cell:k,page:0,obj:j});},clearHilites:function(l){var p=this.hiliteCellsMap[l],n=p&&p.nodes,m=this.parent;if(n){if(n.length==0&&p.pos){n=this.getNodesByPositions(p.pos);}for(var k=0,j=n.length;k<j;k++){var o=n[k],h=m.getCellForNode(o);if(h){delete h.cet;}e.removeClass(o,"sc_"+m.k);}this.hiliteCellsMap[l].nodes=[];}},setHilites:function(j,k){e.addClass(k,"sc_"+this.parent.k);if(!this.hiliteCellsMap[j]){this.hiliteCellsMap[j]={pos:[],nodes:[]};}this.hiliteCellsMap[j].nodes.push(k);var h=this.parent.getCellForNode(k);if(h){h.cet=j;}},getNodesByPositions:function(m){var l=this.tableNode,h=[];for(var k in m){var j=m[k];h.push(l.tBodies[0].rows[j.row].cells[j.cell]);}return h;},preBuildGridTable:function C(){},postBuildGridTable:function M(){this.addSlots({tableNode:this.gridContainerNode&&this.gridContainerNode.firstChild});}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Widget");var A=mstrmojo.css;mstrmojo.TabButton=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.TabButton",markupString:'<span id="{@id}" class="mstrmojo-TabButton {@cssClass}" style="{@cssText}" mstrAttach:click></span>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},ontitleChange:function(){this.domNode.innerHTML=this.title||"";},onbackgroundColorChange:function(){this.domNode.style.backgroundColor=this.backgroundColor||"";},onselectedChange:function(){A.toggleClass(this.domNode,["selected"],!!this.selected);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocLine=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocLine",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocLine" title="{@tooltip}" style="{@domNodeCssText}"></div>',formatHandlers:{domNode:["RW","border-top","border-left","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}},getFormats:function A(){var C=this._super();if(C&&parseInt(C.height,10)===0){C.height="1px";}return C;}});}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl");mstrmojo.DefaultDIC=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DefaultDIC",isDummy:true,showInPopup:function(){mstrmojo.alert("The control style has not been supported yet.");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css","mstrmojo.string");function C(H,D,E){var K=[];var G=H.optionRenderer,I=G&&G.render;if(I&&typeof I==="function"){var L=H.options,J=Math.min(E,((L&&L.length)||0)),F;for(F=D;F<J;F++){K.push(I(L[F],F,H));}}return K.join("");}mstrmojo.DropDownList=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.DropDownList",title:"",selectCssClass:"",tooltip:"",cssDisplay:"inline",value:"",unset:false,options:null,optionValueField:"v",optionNameField:"n",idx:-1,renderedOptions:"",markupString:'<span id="{@id}"  class="mstrmojo-DropDownList {@cssClass}">{@title}<select id="{@id}_select" class="mstrmojo-DropDownList-select {@selectCssClass}"  style="{@cssText}" title="{@tooltip}"onchange="mstrmojo.all[\'{@id}\'].set(\'selected\', this.options[this.selectedIndex].value);">{@renderedOptions}</select><div class = "strikeoutContainer"></div></span>',markupSlots:{selectNode:function(){return this.domNode.getElementsByTagName("select")[0];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onidxChange:function(){var D=this.domNode.getElementsByTagName("select");if(D&&D.length){D[0].selectedIndex=this.idx;}},onvalueChange:function(){var I=this.selectNode,G=I.options,F=this.value,E,H;for(H=0;H<G.length;H++){var D=G[H].value.toString()===F;if(D){E=H;if(F!==""){mstrmojo.css.toggleClass(G[H],"selected",D);}break;}}if(I.length>0&&E>0&&this.unset){if(this.options[0].v==="-1"){I.remove(0);E--;}this.unset=false;}this.set("idx",E);},onwidthChange:function(){var D=this.width;if(D>=0){this.selectNode.style.width=D+"px";}}},_set_selected:function(G,D){var E=this.selectNode,F=this[G]!==D;this[G]=D;if(E){this.set("value",D);}return F;},preBuildRendering:function A(){var F=this;if(F.unset){F.idx=0;}var E=F.options,D=(E&&E.length)||0;if(D){F.renderedOptions=C(F,0,D);}return this._super();},optionRenderer:{render:function(E,D,F){return mstrmojo.string.apply(F.getOptionMarkup(E),F.getOptionProps(E,D));}},getOptionMarkup:function(D){return'<option value="{@en@v}" class="{@cls}" style="{@style}" {@sel}>{@en@n}</option>';},getOptionProps:function B(F,D){var G=this,H=F[G.optionValueField],E=D===parseInt(G.idx,10);G.selected=G.value=E?H.toString():G.value;return{cls:E?"selected":"",v:H===undefined?"":H,n:F[G.optionNameField]||"",style:"",sel:E?"selected":""};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css,G=mstrmojo.array;function F(H,J){var I={searchMetadata:{taskId:"searchMetadata",styleName:this.searchStyleName,rootFolderID:this.rootID,searchPattern:this.searchPattern+"*",nameWildcards:(this.qse?16:1),quickSearch:this.qse,sortKey:(this.qse?-1:6),blockBegin:this.blockBegin||1,blockCount:this.blockCount,recursive:1,folderBrowserStyle:0,includeAncestorInfo:"true",includeObjectDesc:this.includeObjectDesc,searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseFolder:{taskId:"searchMetadata",rootFolderID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,recursive:this.hierarchical?0:(this.searchXML?"":1),folderBrowserStyle:this.hierarchical?1:0,includeAncestorInfo:String(!!this.hierarchical),searchXML:this.searchXML||"",dataSourcesXML:this.dataSources||"",objectType:this.objectTypes},browseElements:{taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:this.rootID,blockBegin:this.blockBegin,blockCount:this.blockCount,filterXML:this.filterXML||"",searchPattern:this.searchPattern||"",matchCase:!!this.matchCase,dataSourcesXML:this.dataSourcesXML||"",includeFormNames:!!this.collectForms,includeFormValues:!!this.bIncludeFormValues,displayedForms:this.displayedForms||1,dimensionID:this.dimensionId||""}}[H]||{};if(typeof J==="object"){mstrmojo.hash.copy(J,I);}return I;}var B="##searchPattern";mstrmojo.SearchBox2=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchBox2",taskId:"searchMetadata",rootID:null,searchStyleName:"MojoFolderStyle",objectTypes:"3,14,256,257,1024,1027,2048,3072,10",token:{searchMetadata:/\//,browseElements:/(^-)|(,)|( OR )|( AND)|([<>]=?)|(&)|( )|(["\[\]\/])/},blockCount:50,blockBegin:1,minSearchLength:2,matchCase:false,enableMatchCase:true,supportIncFetch:true,quickSearch:false,searchAfterSearchPatternRestored:false,includeObjectDesc:true,forceResetCache:false,onUpdateSearchParams:mstrmojo.emptyFn,markupString:'<table id={@id} cellspacing=0 cellpadding=0 class="mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" mstrAttach:keyup,blur /></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}sbSearch" mstrAttach:click ></div></div></td><td><div class="mstrmojo-SearchBox-options" style="{@cssTextShowMC}"><input id="{@id}sbMatchCase" type="checkbox" mstrAttach:click /><label for="{@id}sbMatchCase">'+mstrmojo.desc(4326,"Case Sensitive")+"</label></div></td></tr></table>",markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},searchNode:function(){return this.domNode.rows[0].cells[1].firstChild.firstChild;},optionNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},preBuildRendering:function(){this.cssTextShowMC=this.enableMatchCase?"":"display: none";},postBuildRendering:function(){if(this._super){this._super();}this.matchCase=this.optionNode.checked;},onkeyup:function E(H){var J=this;var I=J.searchTimer;if(I){window.clearTimeout(I);}J.searchTimer=window.setTimeout(function(){J.onkeyupDelayed(H);delete J._searchTimer;},parseInt(H.e.keyCode||H.e.charCode,10)===13?0:J.searchDelay);},onkeyupDelayed:function A(I){var H=I.hWin,K=I.e||H.event;var J=mstrmojo.string.trim(this.inputNode.value);if(this.searchNode){C.toggleClass(this.searchNode,["clear"],J.length>0);}this.showTaskError=false;this.click2Search=false;if(J.length==0||this.autoSubmit||this.onEnter&&K.keyCode===13){this._onsearch();}},onEnter:function(){this._onsearch();},onclick:function(I){var H=I.hWin,K=I.e||H.event,M=K.target||K.srcElement,L=M&&M.id;switch(L.replace(this.id,"")){case"sbDown":if(this.enableMatchCase){var J=this.optionNode.parentNode.style;J.display=J.display=="block"?"none":"block";}break;case"sbSearch":if(this.inputNode.value.length>0){this.clearSearch();}break;case"sbMatchCase":this.set("matchCase",this.optionNode.checked);break;case"sbSpinner":break;}},clearSearch:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);var I=this.searchCache,H=this.rootID;if(I&&I[H]){I[H][B]="";}this._onsearch(true);},onmatchCaseChange:function(){this.matchCaseChanged=true;this._onsearch();},onrootIDChange:function(){this.rootChanged=true;this._setupCache(this.forceResetCache);var I=this.searchCache[this.rootID];if(I){var H=I[B]||"";this.inputNode.value=H;if(H.length>0){if(H.length>=this.minSearchLength&&this.searchAfterSearchPatternRestored){this._onsearch();}}}},getRootID:function(){},contentWidget:null,_notifyContentWidget:function(I){var H=this.contentWidget||this;H.set("items",I[0]);if(this.supportIncFetch){var J=I[1],L=I[2],K=this.blockCount;H.set("ifs",{np:Math.floor(J/K)+((J%K>0)?1:0),cp:Math.floor(L/K)+((L%K>0)?1:0)});}},_onsearch:function(H){this.getRootID();this._setupCache();var K=mstrmojo.string.trim(this.inputNode.value);if(K.length===0){H=true;}var L=this.token[this.taskId];if(L.test(K)){}if(this.searchPattern==K&&!this.rootChanged&&!this.matchCaseChanged&&!this.click2Search){return ;}var M=this.rootID,J=this.searchCache[M];if((K.length<this.minSearchLength&&!this.click2Search)&&!H){if(this.searchPattern&&this.searchPattern.length>=this.minSearchLength){this._notifyContentWidget(J[M]);this.searchPattern=K;}}else{this.searchPattern=K;J[B]=this.searchPattern;var I=this.filterCache(K,J,H);if((this.click2Search||I===null)&&!H){this.blockBegin=1;this.fetch();return ;}else{this._notifyContentWidget(I);}}J[B]=K;},_setupCache:function(J){var K=this.searchCache,I=this.rootID;if(K&&(J||!K[I])){K[I]=K[I]||{};var H=this.contentWidget&&this.contentWidget.items||this.rootCacheItems||[];K[I][I]=[H,this.totalSize||0,this.blockBegin||1].concat();}},taskCallId:0,path:mstrConfig.taskURL,method:"POST",serverRequest:function D(H,I){mstrmojo.xhr.request("POST",this.path,I,H,undefined,this.XServer,this.baseParams);},fetch:function(){this.rootChanged=false;this.matchCaseChanged=false;if(this.spinnerNode){this.spinnerNode.style.display="block";}if(this.preFetch){this.preFetch();}var H=this,I=F.apply(this,[this.taskId]);I.searchPattern=this.searchPattern;this.onUpdateSearchParams(I);var J={success:function(K){var L=K.items||K.es||[];L=[L,K.totalSize||K.sz||0,K.blockBegin||K.bb];mstrmojo.all[H.id].searchCache[H.rootID][(I.searchPattern.length==0?H.rootID:H.buildIndex(I.searchPattern))]=L;H._notifyContentWidget(L);},failure:function(K){if(H.showTaskError){mstrmojo.alert(mstrmojo.desc(8117,"Data request failed:")+" \n"+K.getResponseHeader("X-MSTR-TaskFailureMsg"));}},complete:function(){if(H.spinnerNode){H.spinnerNode.style.display="none";}if(H.postFetch){H.postFetch();}}};this.serverRequest(I,J);},fetchPage:function(H){this.blockBegin=H*this.blockCount+1;this.fetch();},filterCache:function(J,M,I){var H=M&&M[I?this.rootID:this.buildIndex(J)];if(H){return H;}var K=this.token[this.taskId];if(K.test(J)||this.totalSize>this.blockCount){return null;}var O=J.replace(/.$/,"");H=M&&M[this.buildIndex(O)];while(H===undefined&&(O=O.replace(/.$/,"")).length>0){H=M&&M[this.buildIndex(O)];}if(H!==undefined){if(H[1]>this.blockCount){return null;}var L=H[0],N=[];G.forEach(L,function(P){if(P.n.search(new RegExp(J,this.matchCase?"":"i"))>-1){N.push(P);}});this.totalSize=N.length;return(M[this.buildIndex(J)]=[N,N.length,this.blockBegin].concat());}return null;},buildIndex:function(H){if(H.replace(/^\s|\s$/g,"").length===0){return"";}return !this.matchCase?H.toUpperCase():H+"::0";},init:function(H){if(this._super){this._super(H);}this.qse=mstrApp.useQuickSearch&&mstrApp.useQuickSearch()||0;this.autoSubmit=this.quickSearch&&(mstrApp.searchAutoComplete&&mstrApp.searchAutoComplete()||false);this.searchDelay=mstrApp.searchAutoCompleteDelay&&mstrApp.searchAutoCompleteDelay()||0;this.xhr=new mstrmojo.SimpleXHR();this.searchCache=this.searchCache||{};},clear:function(){this.inputNode.value="";C.removeClass(this.searchNode,["clear"]);}});})();(function(){mstrmojo.requiresCls("mstrmojo.boxmodel","mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Widget","mstrmojo.Arr","mstrmojo._HasLayout","mstrmojo._ListBase2Selections","mstrmojo.ListSelector","mstrmojo._TouchScrolling","mstrmojo._PagingList");var a=mstrmojo.hash,f=mstrmojo.array,e=mstrmojo.boxmodel,c=mstrmojo.dom;function A(j,l,h){var k=j.listSelector;if(k){k[l](j,j.itemsContainerNode,h);}}function L(j,h){var k=j.lastPagePos;if(!k||k.dragId!==h){k=e.offset(j.itemsContainerNode);k.dragId=h;j.lastPagePos=k;var l=j.scrollboxNode;j.lastScrollPos={left:l.scrollLeft,top:l.scrollTop,width:l.clientWidth,height:l.clientHeight};}}function O(l,o,j){var k=o&&o.node;if(k===l.dropCueNode||k===l.dropCueNode.firstChild){return l.dropCuePos;}var m=l.listMapper;var h=m&&m.whereDrop(l,l.itemsContainerNode,k,o.pos,{left:l.lastPagePos.left-l.lastScrollPos.left,top:l.lastPagePos.top-l.lastScrollPos.top,width:l.lastScrollPos.width,height:l.lastScrollPos.height});var n=l.dropCuePos;return((j!==false)&&n&&h&&(n.idx===h.idx)&&(n.left===h.left)&&(n.top===h.top))?n:h;}var g="attachEventListener";function D(j,h){if(j.makeObservable){h=h||[];if(!h[g]){mstrmojo.hash.make(h,j.itemsScriptClass||mstrmojo.Arr);}}return h;}function H(j,h){if(h&&h[g]){j._sub_its=h;j._sub_add=h[g]("add",j.id,"preadd");j._sub_rmv=h[g]("remove",j.id,"preremove");}}function G(h){if(h._sub_its){var j=mstrmojo.publisher;j.unsubscribe(h._sub_add);j.unsubscribe(h._sub_rmv);delete h._sub_add;delete h._sub_rmv;delete h._sub_its;}}mstrmojo.ListBase2=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListBase2Selections,mstrmojo._TouchScrolling,mstrmojo._PagingList,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ListBase2",items:null,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keyup,keypress,mousedown,mouseup,dblclick><div class="mstrmojo-ListBase2-itemsContainer" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode;},itemsContainerNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},ondropCuePosChange:function(){var j=this.dropCueNode,h=j&&j.style;if(!h){return ;}var l=this.dropCuePos,k=!!l;if(k){h.left=l.left+"px";h.top=l.top+"px";}h.display=k?"block":"none";},onpageChange:function(){if(this.usePaging&&!this._inScroll){this._inPaging=true;this.listMapper.toPage(this,this.page);this._inPaging=false;}},onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}}},autoHide:false,renderOnScroll:false,firstRenderBlockSize:50,renderBlockSize:50,listMapper:null,listBuilder:null,listSelector:mstrmojo.ListSelector,animate:false,itemsEffect:null,containerResizable:true,init:function Z(m){this._super(m);this.items=this.initItems(this.items);var l=this.selectedIndices,j=this.selectedIndicesList,k=this.selectedIndex,n=this.selectedItem;this.selectedIndices={};this.selectedIndex=-1;delete this.selectedIndicesList;delete this.selectedItem;if(l||j||(k>-1)||n){this.initSelections(l,j,k,n);}if(this.postInitItems){this.postInitItems();}},initItems:function I(h){return D(this,h);},preBuildRendering:function W(){var m=this.listBuilder,p=m.newContext(this);this.ctxtBuilder=p;var j=this.markupSlots,l=!!(this.renderOnScroll&&this.renderBlockSize&&j&&j.scrollboxNode),k=this.items,h=(k&&k.length)||0,n=l?this.firstRenderBlockSize:h,o=l?this.firstRenderBlockSize:0;this._eros=l;this.paused=false;this.itemsHtml=this.listMapper.buildItemWrappers(k,m,this,p,n,o).join("");this.itemsContainerCssText="visibility: hidden";if(this._super){this._super();}},postBuildRendering:function E(){delete this.itemsHtml;var m=this.listMapper;if(m&&m.postBuildRendering){m.postBuildRendering(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder);}H(this,this.items);if(this._eros||this.usePaging){if(!this._cb_scroll){var p=this.id;this._cb_scroll=function(){var n=mstrmojo.all[p];n.onscroll();};}mstrmojo.dom.attachEvent(this.scrollboxNode,"scroll",this._cb_scroll);this.onscroll();}if(this.animate){for(var k=0,j=["itemsEffect","scrollEffect"],h=j.length;k<h;k++){var o=j[k],l=this[o];if(l&&l.constructor===Object){l=mstrmojo.insert(mstrmojo.hash.clone(l));l.widget=this;this[o]=l;}}if(this.itemsEffect){this.itemsEffect.play();}}this.itemsContainerNode.style.visibility="inherit";if(this.containerResizable&&this.itemsContainerNode.scrollWidth<this.domNode.scrollWidth){this.itemsContainerNode.style.width=this.domNode.scrollWidth+"px";}if(this._super){this._super();}},unrender:function X(l){G(this);if(this._eros){mstrmojo.dom.detachEvent(this.scrollboxNode,"scroll",this._cb_scroll);delete this._cb_scroll;}for(var j=0,k=["itemsEffect","scrollEffect"],h=k.length;j<h;j++){var m=this[k[j]];if(m&&m.isPlaying){m.cancel();}}this._super(l);},pauseScrollRendering:function P(k,h,j){if(k!==false){k=true;}if(this.paused===!!k){return ;}this.paused=!!k;if(k){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}}else{this.fill(h,j);}},onscroll:function K(){if(this.paused){return ;}if(this._eros){if(!this._fillTmr){var h=this;this._fillTmr=self.setTimeout(function(){h.fill();h=null;},50);}}if(this._super){this._super();}},fill:function b(h,m){if(this._fillTmr){window.clearTimeout(this._fillTmr);delete this._fillTmr;}var n=(this.items&&this.items.length)||0;if(!n){if(m){m();}}else{var k=this.scrollboxNode,o=this.itemsContainerNode,l=mstrmojo.boxmodel.offset(o,k),q=this.listMapper,p=q.findScrollRange(o,n,(this.usesTouches&&this.pos&&parseInt(this.pos.y,10))||k.scrollTop,k.clientHeight,(this.usesTouches&&this.pos&&parseInt(this.pos.x,10))||k.scrollLeft,k.clientWidth,l.left,l.top);if(this.fillAt(p.start,p.end)){if(h){h();}var j=this.id;this._fillTmr=window.setTimeout(function(){mstrmojo.all[j].fill(h,m);},100);}else{if(m){m();}}}},fillAt:function M(k,j){var h=this.listMapper;if(h){return h.fillItemWrappers(this.itemsContainerNode,this.items,this.listBuilder,this,this.ctxtBuilder,k,j,this.renderBlockSize);}else{return false;}},add:function R(j,h){if(!j||!j.length){return -1;}var k=this.items;if(h==null){h=a.min(this.selectedIndices,false,true);if(h!==null&&h!==undefined){h++;}}if(h==null||h===-1){h=(k&&k.length)||0;}if(k&&k.add){k.add(j,h);}else{this.set("items",k?f.insert(k.concat(),h,j):j);}return h;},preadd:function B(k){if(this.hasRendered){var n=this.listMapper;if(n){n.onadd(this,this.itemsContainerNode,this.ctxtBuilder,k);}var m=this.listBuilder;if(m){m.onadd(this,this.ctxtBuilder,k);}var j=this.listSelector;if(j){j.onadd(this,k);}if(this._eros){this.onscroll();}else{var l=k.index,h=k.value.length;this.fillAt(l,l+h-1);}}if(this.onadd){this.onadd(k);}if(this._super){this._super(k);}},remove:function U(h){if(h==null){return -1;}if(h.constructor!==Array){return this._remove(h);}var k=this.items;if(k){var j;if(k.remove){for(j=h.length-1;j>-1;j--){k.remove(h[j],1);}}else{k=k.concat();for(j=h.length-1;j>-1;j--){k.splice(h[j],1);}this.set("items",k);}return h[0];}return -1;},_remove:function U(k){var j=this.items;if(!j||(k==null)){return -1;}var h;if(!isNaN(k)){h=k;}else{h=this.itemIndex(k);}if(h>-1){if(j.remove){j.remove(h,1);}else{j=j.concat();j.splice(h,1);this.set("items",j);}}return h;},duplicate:function Y(n,j,k){var l=this.items,h=-1;if(!l||(n==null)){return -1;}if(!isNaN(n)){if(j===null||j===undefined){j=n+1;}n=l[n];}else{if(j===null||j===undefined){j=this.itemIndex(n)+1;}}if(n){var m;m=a.copy(k,a.clone(n));h=this.add([m],j);}return h;},preremove:function N(j){if(this.hasRendered){var l=this.listMapper;if(l){l.onremove(this,this.itemsContainerNode,this.ctxtBuilder,j);}var k=this.listBuilder;if(k){k.onremove(this,this.ctxtBuilder,j);}var h=this.listSelector;if(h){h.onremove(this,j);}if(this._eros){this.onscroll();}}if(this.onremove){this.onremove(j);}if(this._super){this._super(j);}},move:function S(l,r){function p(u,t){u=parseInt(u,10);return t===1||(r>=u&&r<u+t);}var q=(this.items&&this.items.length)||0;if(r===-1||r==null||isNaN(r)){r=q;}else{r=Math.min(r,q);}var k,h,n,m;if(l.constructor===Array){h=l;n=l;m=(h&&h.length)||0;if(p(l[0],l.length)){return false;}k=f.get(this.items,l);}else{if(typeof (l)==="object"){k=[l];m=1;h=this.itemIndex(k[0]);n=[h];if(p(h,1)){return false;}}else{h=l;n=[l];m=1;if(p(h,1)){return false;}k=[this.items[h]];}}var o=0;for(var j=0;j<m;j++){if(n[j]<=r){r--;o++;}}if(o==n.length){r++;}if(k[0]!=null){this.remove(h);this.add(k,r);}return true;},itemIndex:function F(h){if(h==null){return -1;}var j=this.itemIdField;return j?f.find(this.items,j,h[j]):f.indexOf(this.items,h);},prechange:function T(k){if(this.hasRendered){var j=[this.listBuilder,this.listMapper];for(var l=0,h=j.length;l<h;l++){var m=j[l];if(m&&m.onchange){m.onchange(this,this.itemsContainerNode,this.ctxtBuilder,k);}}}},makeObservable:false,_set_items:function J(o,h){var m=this.items;h=this.initItems(h);this.items=h;if(m!==h){var l=this,k=function(){if(l.autoHide){l.set("visible",!!(h&&h.length));}l=null;},j=this.hasRendered;if(j){this.refresh(k);}else{k();}}return m!==h;},premousedown:function d(h){A(this,"premousedown",h);},premouseup:function Q(h){A(this,"premouseup",h);},scrollTo:function V(j){var h,k=this.listMapper;if(k&&k.toItem){if(!isNaN(j)){h=j;}else{h=this.itemIndex(j);}if(h>=0){k.toItem(this,h);}}},draggable:false,getDragData:function(m){L(this,m.id);var k=O(this,m.src),j=k&&k.idxActual;if((j>-1)&&this.selectedIndices[j]){var l=this.sortSelectedIndices(),h=f.get(this.items,l)||[];switch(h.length){case 1:return a.copy({html:h[0][this.itemDisplayField],index:l[0]},a.copy(h[0]));case 0:return null;default:return a.copy({html:h.length+" selections",indices:l},h);}}},dropZone:false,ondragenter:function(h){L(this,h.id);this.set("dropCuePos",O(this,h.tgt));},ondragover:function(h){this.set("dropCuePos",O(this,h.tgt));},ondragleave:function(h){this.set("dropCuePos",null);},isDragValid:function C(h){return h&&h.src&&h.src.data;},ondragstart:function(h){if(!(h&&h.src&&h.src.data)){return false;}},allowCopy:false,ondragend:function(l){var j=l&&l.tgt,h=j&&j.widget;if(h===this){}else{if(this.tree&&h&&h.tree===this.tree){if(!this.allowCopy||!c.ctrlKey(j.hWin,j.e)){var k=l.src&&l.src.data;if(k&&(k.indices||(k.index!==null))){this.remove(k.indices||k.index);}}}}},ondrop:function(q){var u=q&&q.src,p=u&&u.data;if(p){var k=O(this,q.tgt,false),r=k&&k.idx,l=(p&&p.constructor===Array),j=this.sortSelectedIndices();var n=this.items;r=Math.min(r,n&&n.length)||0;var t=true;if(u.widget===this){t=this.move(j,r);f.forEach(j,function(v){if(v<=r){r--;}});}else{this.add(l?p:[p],r);}if(t){var o=l?p.length:1,h={};for(var m=0;m<o;m++){h[r+m]=true;}this.set("selectedIndices",h);}}this.set("dropCuePos",null);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");var C=mstrmojo.css,A="selected";mstrmojo.ButtonSwitch=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ButtonSwitch",markupString:'<div id="{@id}" class="mstrmojo-ButtonSwitch {@cssClass}" style="{@cssText}" mstrAttach:click><div class="left selected" > {@label1} </div><div class="right"> {@label2} </div></div>',markupSlots:{left:function(){return this.domNode.children[0];},right:function(){return this.domNode.children[1];}},switchFn:mstrmojo.emptyFn,onselectedChange:function(){var D;for(D=0;D<2;D++){C.toggleClass(this.domNode.children[D],A,this.selected===D);}this.switchFn();},onclick:function B(D){this.set("selected",(D.getTarget()===this.left)?0:1);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget");var E=mstrmojo.Widget;mstrmojo.ui._IsPulldown=mstrmojo.provide("mstrmojo.ui._IsPulldown",{scriptClass:"mstrmojo.ui._IsPulldown",markupString:'<div id="{@id}" style="{@cssText}" class="mstrmojo-ui-Pulldown {@cssClass}" mstrAttach:mousedown,click><div class="mstrmojo-ui-Pulldown-text {@cssTextClass}" title="{@title}" style="{@labelCssText}">{@value}</div><div class="container"></div></div>',markupSlots:{selectedNode:function D(){return this.domNode.firstChild;},containerNode:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:E.visibleMarkupMethod,onheightChange:E.heightMarkupMethod,onwidthChange:E.widthMarkupMethod,onvalueChange:function F(){this.selectedNode.innerHTML=this.value||"";},onenabledChange:mstrmojo.Widget.enabledMarkupMethod},getPopupList:mstrmojo.emptyFn,anchorSlot:"selectedNode",postBuildRendering:function B(){this._super();this.getPopupList().set("items",this.items);var G=this.selectedIndex,H=this.selectedIndices;if(G!==undefined){this.set("selectedIndex",G);}if(H!==undefined){this.set("selectedIndices",mstrmojo.hash.copy(H||{}));}},onitemsChange:function C(){var G=this.getPopupList();if(G){G.set("items",this.items);}},onPopupWidgetOpened:function(){var G=this.getPopupList();if(G&&(!G.items||G.items.length===0)){G.close();}}});}());(function(){var regExH=/"height", "[0-9.]+"/g;var regExW=/"width", "[0-9.]+"/g;var regExH1=/height="?[0-9.]+"?/g;var regExW1=/width="?[0-9.]+"?/g;mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable","mstrmojo._IsSelectorTarget");mstrmojo.DocVisualization=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocVisualization",markupString:'<div id={@id} class="mstrmojo-docvisualization" title="{@tooltip}" style="{@domNodeCssText}">{@htmlText}</div>',formatHandlers:{domNode:["RW","T","B","fx"]},update:function update(node){if(this._super){this._super(node);}var d=node.data;this.htmlText=d.htmlText;this.jsText=d.jsText;this.selData=d.selData;this.ctrLink=d.ctrLink;this.vp=d.vp;this.eg=d.eg;if(this.eg){this.htmlText=this.eg;}},preBuildRendering:function(){if(this._super){this._super();}var fmts=this.getFormats();if(!fmts){return ;}var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(this.jsText){this.jsText=this.jsText.replace(regExH,'"height", "'+h+'"').replace(regExW,'"width", "'+w+'"');}},postBuildRendering:function pstBldRnd(){if(this._super){this._super();}eval(this.jsText);},resize:function(){if(this.eg){return ;}var embedNode=this.domNode.firstChild.firstChild.firstChild;if(!embedNode){return ;}var fmts=this.getFormats();var h=fmts.height;if(h){h=h.replace("px","");}var w=fmts.width;if(w){w=w.replace("px","");}if(mstrmojo.dom.isIE){embedNode.firstChild.setAttribute("height",h);embedNode.firstChild.setAttribute("width",w);}else{embedNode.innerHTML=embedNode.innerHTML.replace(regExH1,'height="'+h+'"').replace(regExW1,'width="'+w+'"');}},makeSelections:function(selections){var shuffledData={},i,j,attId,e;for(i=0;i<selections.length;i++){var attIdI=selections[i].attId;if(!shuffledData[attIdI]){shuffledData[attIdI]=[];}shuffledData[attIdI]=shuffledData[attIdI].concat(selections[i].values);}var sep="\u001E",sep1="\u001F";var ckJoined="",eidJoined="",cklJoined="";var tksArray=[];for(attId in shuffledData){var sd=this.getSelectionData(attId);if(!sd){continue;}var ctrLink=this.ctrLink[attId];var values=shuffledData[attId];if(sd&&values&&values.length>0){sd.sel=values;sd.ias=false;for(e in values){if(e==="u;"){sd.ias=true;break;}}}if(ctrLink.gbTargets){var t=ctrLink.targets=[],gbt=ctrLink.gbTargets,cgbmap=this.model.getCGBMap();for(j=0;j<gbt.length;j++){var targetKey=cgbmap[gbt[j]];if(targetKey){t.push(targetKey);}}delete ctrLink.gbTargets;}ckJoined+=ctrLink.ctxt+sep1;eidJoined+=values.join(sep)+sep1;cklJoined+=ctrLink.ck+sep1;tksArray=tksArray.concat(ctrLink.targets);}ckJoined=ckJoined.substring(0,ckJoined.length-1);eidJoined=eidJoined.substring(0,eidJoined.length-1);cklJoined=cklJoined.substring(0,cklJoined.length-1);if(tksArray.length===0){return ;}var evt={ck:ckJoined,eid:eidJoined,src:this.k,tks:tksArray.join(sep),type:this.defn.t,ctlKey:cklJoined,include:true,isDocVis:true};this.model.slice(evt);},getAllSelectionData:function(){return this.selData;},getSelectionData:function(attId){var selData=this.selData,k;if(selData&&selData.attl){var attl=selData.attl;if(attId){return attl[attId];}return attl[attl.keys()[0]];}},saveVisProps:function(widgetPropsXml){mstrApp.docModel.updateUnitFormat(this,1,{FormattingWidget:{WidgetProps:widgetPropsXml}},{success:function(){}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var F=mstrmojo.array,C=mstrmojo.css,G=mstrmojo.string,B=mstrmojo.dom,A="unselected",D="inline-block";function H(L){var K=mstrApp.getConfiguration();if(L===decodeURI(L)){L=encodeURI(L);}if(K&&L&&L.indexOf("://")===-1){L=K.getHostUrlByProject(mstrApp.getCurrentProjectId())+L;}return(mstrApp.useBinaryFormat)?String(mstrMobileApp.getImage(L)):L;}mstrmojo.ImageToggle=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ImageToggle",unset:null,useAnimation:true,markupString:'<div class="mstrmojo-ImageToggle {@cssClass}" style="{@cssText}" tabindex="{@tabIndex}"  mstrAttach:click,blur,keydown ></div>',tabIndex:0,markupMethods:{onimageListChange:function(){var P=this.imageList&&this.imageList.slice(),M=this,N=this.unset,L,O,K;if(!G.isEmpty(N)&&P){P.push({n:N,v:N,_ust:true});}if(this.domNode&&P){M.domNode.innerHTML="";M.domNode.style.minHeight=Math.min(20,M.height)+"px";M.domNode.style.minWidth=Math.min(20,M.width)+"px";M._loadedImgs=P.length;mstrmojo.array.forEach(P,function(R,Q){O=document.createElement("div");O.style.cssText="display:none;font-size:0px !important;line-height:"+M.height+"px !important;";K=document.createElement("img");K.alt=K.title=R.v;K.style.verticalAlign="middle";K.style.maxHeight=M.height+"px";K.style.maxWidth=(M.width-1)+"px";if(!mstrmojo.dom.isIE){K.onerror=function(){this.src="../images/image_not_found.jpg";};}O.appendChild(K);M.domNode.appendChild(O);K.src=(R.n&&H(R.n))||"../images/image_not_found.jpg";if(R._ust){M.ustImgIdx=Q;}M._imgs[Q]=O;});this._setSelectedValue();}},onvalueChange:function(){this._setSelectedValue();}},imageList:null,value:null,selectedIndex:-1,preBuildRendering:function E(){if(this._super){this._super();}this._imgs=[];},_setSelectedValue:function I(){var M=this,L=this.selectedIndex,O=this.imageList;if(O){if(O[L]){M._imgs[L].style.display="none";}F.forEach(this.imageList,function(P,Q){if(P.v==M.value){C.removeClass(M.domNode,A);M.selectedIndex=Q;M._imgs[Q].style.display=D;return ;}});if(this.selectedIndex===-1){if(!this.unset){C.addClass(this.domNode,A);}else{var N=this._imgs[this.ustImgIdx],K=N.lastChild;K.alt=K.title=this.value;N.style.display=D;}}}},onclick:function J(){var M=this.imageList,N=M&&M.length,O=300,U=this.selectedIndex,L=U,K=this.domNode,S,R,Q,T,P=this;Q=(U===-1&&this.ustImgIdx!==null)?this._imgs[this.ustImgIdx]:this._imgs[U];U=(U+1)%N;T=this._imgs[U];C.removeClass(K,A);this.selectedIndex=U;if(this.useAnimation){R=new mstrmojo.fx.FadeIn({duration:O,interval:(B.isIE8?(O/3):(O/10)),target:T,preStart:function(){this.target.style.display=D;}});S=new mstrmojo.fx.FadeOut({duration:O,interval:(B.isIE8?(O/3):(O/10)),target:Q,onEnd:function(){Q.style.display="none";if(L===-1){P._imgs.splice(P.ustImgIdx,1);K.removeChild(Q);delete P.ustImgIdx;}R.play();}});if(Q){S.play();}else{R.play();}}else{if(Q){Q.style.display="none";if(L===-1){P._imgs.splice(P.ustImgIdx,1);K.removeChild(Q);delete P.ustImgIdx;}}T.style.display=D;}this.value=this.imageList[U].v;},onkeydown:function(L){var K=L.hWin,M=L.e||K.event;if(M.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(K,M);this.onclick();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.css","mstrmojo.string","mstrmojo._IsExprNode","mstrmojo._HasPopup","mstrmojo.Widget");var O=mstrmojo.dom,B=mstrmojo.css,E=mstrmojo.string.htmlAngles,M=mstrmojo.expr,N=M.ET,K=M.FN,A=M.BRANCH_FNS[K.NOT],D={};D[K.BETWEEN]=1;D[K.NOT_BETWEEN]=1;var C={"*":function(Q,P){return Q?('<span class="mstrmojo-unknown">'+(E(Q.n||Q.xml)||"...")+"</span>"):null;}};function H(Q,P,S,R){return S&&((R?'<span class="mstrmojo-ListIcon t'+R+'"></span>':"")+'<span class="mstrmojo-text mstrmojo-embedobj">'+E(S)+"</span>");}C[N.R]=function(Q,P){return H(Q,P,Q.r&&Q.r.n,Q.r&&Q.r.t);};C[N.F]=function(Q,P){return H(Q,P,Q.f&&Q.f.n,Q.f&&Q.f.t);};C[N.XML]=function(Q,P){return H(Q,P,Q.n||Q.p&&Q.p.n||Q.xml,Q.p&&Q.p.t);};C[N.AE]=function(V,S){var R=[];if(V&&V.a&&V.a.n){R.push('<span class="mstrmojo-text mstrmojo-attr">'+E(V.a.n)+"</span>");if(V.fn!==M.FN.IN_LIST){R.push('<span class="mstrmojo-text mstrmojo-fn">'+E(M.fnName(V.et,V.fn,V.fnt))+"</span>");}var U=V.es,P=U&&U.length||0;if(P){R.push('<span class="mstrmojo-elems">');var Q=R.length;for(var T=0;T<P;T++){R[Q++]='<span class="mstrmojo-text mstrmojo-elem">';R[Q++]=E(U[T].n);if(T<P-1){R[Q++]=", ";}R[Q++]="</span>";}R[Q++]="</span>";}else{R.push('<span class="mstrmojo-text mstrmojo-emptyelems">(Empty)</span>');}}return R.join("");};C[N.AQ]=function(W,X){var T=[];if(W&&W.a&&W.a.n){T.push('<span class="mstrmojo-text mstrmojo-attr">'+E(W.a.n)+"</span>");if(W.fm&&W.fm.n){T.push('<span class="mstrmojo-text mstrmojo-form">'+E(W.fm.n)+"</span>");if(W.fn!=null){T.push('<span class="mstrmojo-text mstrmojo-fn">'+E(M.fnName(W.et,W.fn,W.fnt,W.fm.dtp))+"</span>");var P=M.fnCstCount(W.fn,W.fnt);if(W.et===N.AC){if(P>=1){if(W.a2&&W.a2.n){T.push('<span class="mstrmojo-text mstrmojo-attr2">'+E(W.a2.n)+"</span>");if(W.fm2&&W.fm2.n){T.push('<span class="mstrmojo-text mstrmojo-form2">'+E(W.fm2.n)+"</span>");}}if(P>1){T.push('<span class="mstrmojo-text mstrmojo-btwn">'+X.betweenText+"</span>");if(W.a3&&W.a3.n){T.push('<span class="mstrmojo-text mstrmojo-attr3">'+E(W.a3.n)+"</span>");if(W.fm3&&W.fm3.n){T.push('<span class="mstrmojo-text mstrmojo-form3">'+E(W.fm3.n)+"</span>");}}}}}else{if(W.et===N.AL){var U=W.cs,Y=[];for(var R=0,V=U.length;R<V;R++){Y.push(U[R].v);}T.push('<span class="mstrmojo-text mstrmojo-c1">'+Y.join(mstrConfig.listSep)+"</span>");}else{if(P>=1){var U=W.cs,S=U&&U[0];T.push('<span class="mstrmojo-text mstrmojo-c1">'+E(S&&S.p&&S.p.n||S&&S.v)+"</span>");if(P>1){var Q=U&&U[1];T.push('<span class="mstrmojo-text mstrmojo-btwn">'+X.betweenText+"</span>");T.push('<span class="mstrmojo-text mstrmojo-c1">'+E(Q&&Q.p&&Q.p.n||Q&&Q.v)+"</span>");}}}}}}}return T.join("");};C[N.AC]=C[N.AQ];C[N.AL]=C[N.AQ];C[N.MQ]=function(f,g){var e=[],Z=f&&f.m,k=Z&&Z.n;if(k){var Q=f.fnt,U=M.FNT.PER,c=M.FNT.RANK;k=Q===U?mstrmojo.desc(2787,"Percentage of ##").replace("##",k):Q===c?mstrmojo.desc(2788,"Rank of ##").replace("##",k):k;e.push('<span class="mstrmojo-text mstrmojo-metric">'+E(k)+"</span>");if(f.fn!=null){e.push('<span class="mstrmojo-text mstrmojo-fn">'+E(M.fnName(f.et,f.fn,Q,M.DTP.REAL))+"</span>");var X=M.fnCstCount(f.fn,Q);if(f.et==M.ET.MC){if(X>=1){var j=(f.m2&&f.m2.n)||"?";e.push('<span class="mstrmojo-text mstrmojo-m2">'+E(j)+"</span>");if(X>1){e.push('<span class="mstrmojo-text mstrmojo-btwn">'+g.betweenText+"</span>");var S=(f.m3&&f.m3.n)||"?";e.push('<span class="mstrmojo-text mstrmojo-m3">'+E(S)+"</span>");}}}else{if(X>=1){var R=f.cs,a=R&&R[0];var P=function(h){var d=h.v;if(f.fnt==U){if(d.replace){h.v=d.replace(/%$/,"");}d=h.v+"%";}return d;};e.push('<span class="mstrmojo-text mstrmojo-c1">'+E(a&&a.p&&a.p.n||a&&a.v&&P(a))+"</span>");if(X>1){var Y=R&&R[1];e.push('<span class="mstrmojo-text mstrmojo-btwn">'+g.betweenText+"</span>");e.push('<span class="mstrmojo-text mstrmojo-c2">'+E(Y&&Y.p&&Y.p.n||Y&&Y.v&&P(Y))+"</span>");}}}var b=f.dmy&&f.dmy.uts,W=b&&b.length;if(W){e.push('<span class="mstrmojo-text mstrmojo-at">'+g.atText+"</span>");e.push('<span class="mstrmojo-dmy">');for(var V=0;V<W;V++){var T=b[V];e.push('<span class="mstrmojo-text mstrmojo-dmyunit">');e.push(E(T.utgt?T.utgt.n:T.n));if(V<W-1){e.push(",");}e.push("</span>");}e.push("</span>");}}}return e.join("");};C[N.MC]=C[N.MQ];function G(P){var Q=P.data;if(Q.not){return'<span class="mstrmojo-text mstrmojo-not">'+A+"</span>";}return"";}function F(P){var R=P.data,Q=C[R&&R.et]||C["*"];return G(P)+((Q&&Q(R,P))||('<span class="mstrmojo-text">'+P.emptyText+"</span>"));}mstrmojo.ConditionNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){B.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},oneditableChange:function(){B.toggleClass(this.textNode,["editable"],this.editable);},onselectedChange:function(){B.toggleClass(this.condNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=F(this);this.textPostfixNode.innerHTML=this.getConditionTextPostfix();}},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),emptyText:mstrmojo.desc(7930,"Empty condition"),init:function L(P){this._super(P);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());},getConditionTextPostfix:function(){return"";},del:function J(){var P=this.parent;if(P&&P.remove&&this.data){P.remove(this.data);}},isEmpty:function(){var Q=this.data,P=Q&&Q.et,R=P&&mstrmojo.expr.ET2TGT[P];return !(R&&Q[R]);},isSelectableArea:function(P){return O.contains(this.condNode,P,true);},preclick:function I(P){var R=null,Q=O.eventTarget(P.hWin,P.e);if(O.contains(this.prefixNode,Q,true)){R="andor";}else{if(O.contains(this.textNode,Q,true)){R="condition";}else{if(O.contains(this.textPostfixNode,Q,true)){O.stopPropogation(P.hWin,P.e);return false;}}}P.part=R;}});mstrmojo.ConditionNode.getFunctionNode=F;})();(function(){mstrmojo.requiresCls("mstrmojo.Widget");mstrmojo.WaitIcon=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.WaitIcon",cssFloat:"left",visible:false,markupString:'<div id="{@id}" class="mstrmojo-WaitIcon {@cssClass}" style="float:{@cssFloat};{@cssText};"></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},markupSlots:{}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.css","mstrmojo.string");function A(C,B){return mstrmojo.hash.copy(B,{label:"",tabIndex:"",cssDisplay:"inline",name:null,markupString:'<span id="{@id}" class="'+C+' {@cssClass}" style="{@cssText}" title="{@tooltip}"><input id="{@id}_input"  type="{@type}" name="{@name}" value="{@value}" tabIndex="{@tabIndex}" mstrAttach:click tstid="{@tstid}"/><label for="{@id}_input">{@label}</label></span>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},labelNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?this.cssDisplay:"none";},onenabledChange:function(){this.inputNode.disabled=!this.enabled;mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,"disabled");},onlabelChange:function(){this.labelNode.innerHTML=mstrmojo.string.encodeHtmlString(this.label);},oncheckedChange:function(){this.inputNode.checked=this.checked;}},checked:false,preclick:function(){this.set("checked",this.inputNode.checked);},isChecked:function(){return this.inputNode.checked;}});}mstrmojo.CheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox",{scriptClass:"mstrmojo.CheckBox",type:"checkbox"}));mstrmojo.ImageCheckBox=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-CheckBox mstrmojo-ImageCheckBox",{scriptClass:"mstrmojo.CheckBox",type:"image",cssDisplay:"block",preclick:function(){this.set("checked",!this.checked);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.oncheckedChange=function(){mstrmojo.css.toggleClass(this.inputNode,["checked"],this.checked);};},postBuildRendering:function(){this.inputNode.src=this.src||"../images/1ptrans.gif";if(this._super){return this._super();}return true;}}));mstrmojo.RadioButton=mstrmojo.declare(mstrmojo.Widget,null,A("mstrmojo-RadioButton",{scriptClass:"mstrmojo.RadioButton",type:"radio",postBuildRendering:function(){if(mstrmojo.dom.isIE){this.inputNode.checked=this.checked;}}}));}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.css");var G=mstrmojo.css,E={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"},C="sbClear",K="sbSearch";mstrmojo.SearchWidget=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.SearchWidget",quickSearch:false,placeholderText:"",markupString:'<table id={@id} cellspacing="0" cellpadding="0" class="mstrmojo-SearchWidget mstrmojo-SearchBox-Wrapper {@cssClass}" style="{@cssText};"><tr><td><div class="mstrmojo-SearchBox" mstrAttach:click ><input class="mstrmojo-SearchBox-input" type="text" style="width:{@width};" placeholder="{@placeholderText}" mstrAttach:keyup,blur/></div></td><td><div class="mstrmojo-SearchBox-clear" id="{@id}'+C+'" mstrAttach:click></div></td><td><div class="mstrmojo-SearchBox-bg"><div class="mstrmojo-SearchBox-search" id="{@id}'+K+'" mstrAttach:click ></div></div></td></tr></table>',markupSlots:{inputNode:function(){return this.domNode.rows[0].cells[0].firstChild.firstChild;},clearNode:function(){return this.domNode.rows[0].cells[1].firstChild;},searchNode:function(){return this.domNode.rows[0].cells[2].firstChild.firstChild;}},markupMethods:{onquickSearchChange:function(){G.toggleClass(this.domNode,"quick-search",this.quickSearch);},onwidthChange:function(){if(this.inputNode&&this.inputNode.style&&this.inputNode.style.width){this.inputNode.style.width=this.width;}}},clearNode:null,searchNode:null,onsearch:mstrmojo.emptyFn,onclear:mstrmojo.emptyFn,prekeyup:function J(M){var L=M.hWin,Q=M.e||L.event;var O=this.getSearchPattern(),N=(O.length===0),P=this.quickSearch;G.toggleClass(this.clearNode,"show",!N&&!P);G.toggleClass(this.searchNode,"clear",!N&&P);if(P){this[N?"clearSearch":"onsearch"](O);}var R=E[Q.keyCode];if(this["on"+R]){this["on"+R](M);}},onEnter:function B(L){this.onsearch(this.getSearchPattern());},onEsc:function A(L){this.clearSearch();},getSearchPattern:function H(){return mstrmojo.string.trim(this.inputNode.value);},preclick:function F(L){var N=L.getTarget(),M=N&&N.id;switch(M.replace(this.id,"")){case K:if(this.quickSearch){this.clearSearch();}else{this.onsearch(this.getSearchPattern());}break;case C:this.clearSearch();break;}},clearSearch:function I(){var L=this.getSearchPattern();this.reset();this.onclear(L);},reset:function D(){this.inputNode.value="";G.removeClass(this.clearNode,"show");G.removeClass(this.searchNode,"clear");}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.css");var C=mstrmojo.Widget;mstrmojo.ui.Checkbox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.Checkbox",markupString:'<div id="{@id}" class="mstrmojo-ui-Checkbox {@cssClass}" mstrAttach:click></div>',markupMethods:{onvisibleChange:C.visibleMarkupMethod,oncheckedChange:function B(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},onenabledChange:C.enabledMarkupMethod},checked:false,onclick:function A(){this.set("checked",!this.checked);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Widget");var B=mstrmojo.dom;mstrmojo.InlineEditBox=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.InlineEditBox",text:null,editMode:false,allowEdit:true,okSave:false,emptyHint:"Enter your text here.",markupString:'<div id="{@id}" class="mstrmojo-InlineEditBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-InlineEditBox-text"></div><div class="mstrmojo-InlineEditBox-edit"><input type="text" class="mstrmojo-InlineEditBox-input" mstrAttach:keyup/><img class="mstrmojo-InlineEditBox-ok" src="../images/1ptrans.gif" title="Save"/><img class="mstrmojo-InlineEditBox-cancel" src="../images/1ptrans.gif" title="Cancel"/></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.lastChild;},inputNode:function(){return this.domNode.lastChild.firstChild;},okNode:function(){return this.domNode.lastChild.childNodes[1];},cancelNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text||this.emptyHint||"");},oneditModeChange:function(){var H=this.editMode,E=this.domNode,D=this.textNode,G=this.editNode;mstrmojo.css.toggleClass(E,["edit"],H);if(H){D.style.display="none";G.style.display="block";D=this.inputNode;var F=D.style;D.value=this.text||"";F.width=(E.clientWidth-(this.okSave?(this.okNode.offsetWidth+this.cancelNode.offsetWidth):0))+"px";F.height=E.clientHeight+"px";D.focus();if(D.createTextRange){var I=D.createTextRange(),C=D.value.length;I.move("character",C);I.select();}}else{D.style.display="block";G.style.display="none";}},onokSaveChange:function(){var C=this.okSave?"inline":"none";this.okNode.style.display=C;this.cancelNode.style.display=C;},onallowEditChange:function(){mstrmojo.css.toggleClass(this.domNode,["disable"],!this.allowEdit);}},onvisibleChange:function A(){if(this.domNode){this.domNode.style.display=(this.visible?"block":"none");}},preclick:function(C){var E=C.e,D=B.eventTarget(C.hWin,E);if(D===this.okNode){this.save();}else{if(D===this.cancelNode){this.cancel();}else{if(this.editMode!==this.allowEdit){this.set("editMode",this.allowEdit);}}}},prekeyup:function(C){var E=C.e,D=E.keyCode||E.charCode;if(D===mstrmojo.Enum_Keys.ENTER){this.save();}else{if(D===mstrmojo.Enum_Keys.ESCAPE){this.cancel();}}},_attachEvents:function(){var C=this;if(this.editMode){if(!this._save_handler){this._save_handler=function(){var D=B.eventTarget(self,arguments[0]);if(!B.contains(C.domNode,D,true,document.body)){C.save();}};}B.attachEvent(document.body,"mousedown",this._save_handler);}else{if(this._save_handler){B.detachEvent(document.body,"mousedown",this._save_handler);}}},postBuildRendering:function(){if(this._super){this._super();}this._em_sub=this.attachEventListener("editModeChange",this.id,"_attachEvents");},destroy:function(){this.detachEventListener(this._em_sub);if(this._super){this._super();}},save:function(){this.set("text",this.inputNode.value);this.set("editMode",false);if(this.onSave){this.onSave();}},cancel:function(){this.set("editMode",false);if(this.onCancel){this.onCancel();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.array","mstrmojo._HasChildren");var G=mstrmojo.array;function E(P){if(!this.shouldPropagateEnabled){return ;}var O=this._disabledChildren;G.forEach(P,function(Q){if(Q.enabled){O.push(Q.id);Q.set("enabled",false);}});}function J(){G.forEach(this._disabledChildren,function(O){var P=mstrmojo.all[O];if(P&&P.parent===this){P.set("enabled",true);}},this);this._disabledChildren=[];}mstrmojo.Container=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasChildren],{scriptClass:"mstrmojo.Container",defaultChildSlot:"containerNode",containerNode:null,preserveChildDomOrder:true,shouldPropagateEnabled:false,init:function M(P){this._super(P);this._disabledChildren=[];this.attachEventListener("addChild",this.id,function(Q){if(this.shouldPropagateEnabled&&!this.enabled){E.call(this,Q.value);}});if(this.children){this.initChildren();}var O=this.parent;if(!O||O.hasInitBindings){this.initBindings();}},destroy:function H(O){if(this.children){this.destroyChildren(true);}if(this.bindings){this.destroyBindings();}this._super(O);},unrender:function I(Q){var R=this.children,O=(R&&R.length)||0,P;for(P=O-1;P>-1;P--){R[P].unrender(true);}this._super(Q);},postBuildRendering:function A(){if(this._super()!==false){this.renderChildren();return true;}return false;},renderChildren:function L(){var Q=this.children,O=(Q&&Q.length)||0,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}}},childRenderCheck:function D(P){if(P&&!P.hasRendered){var O=P.slot||this.defaultChildSlot;return !!this[O];}return false;},addChildren:function N(R,P,Q){var O=this._super(R,P,Q);if(O){this.childRenderOnAddCheck(O);}return O;},removeChildren:function F(V,R){var U=V?[V]:(this.children||[]),O=U.length,S;for(S=O-1;S>-1;S--){var Q=U[S],P=Q&&Q.domNode;if(P){var T=this[(Q.slot||this.defaultChildSlot)];if(P.parentNode===T){T.removeChild(P);}}}return this._super(V,R);},childRenderOnAddCheck:function B(Q){if(this.hasRendered&&Q){var O=Q.length,P;for(P=0;P<O;P++){var R=Q[P];if(this.childRenderCheck(R)){R.render();}else{if(R&&R.hasRendered){this.onchildRenderingChange(R);}}}}},onchildRenderingChange:function K(O){var W=O&&O.domNode;if(!W){return ;}var P=this.defaultChildSlot,V=O.slot||P,Y=this[V],Q=this.children;if(!Y){if(W.parentNode){W.parentNode.removeChild(W);}}else{if(W.parentNode===Y){return ;}if(!this.preserveChildDomOrder){Y.appendChild(W);}else{var R,U;for(U=Q.length-1;U>=0;U--){var X=Q[U];if(X===O){break;}if(V===(X.slot||P)){var Z=X.domNode;if(Z&&Z.parentNode===Y){R=Z;}}}if(R){Y.insertBefore(W,R);}else{Y.appendChild(W);}}}if(mstrmojo.publisher.hasSubs(this.id,"childrenRendered")){var S=Q.length,T;for(T=0;T<S;T++){if(!Q[T].domNode){return ;}}this.raiseEvent({name:"childrenRendered"});}},propagateChildProps:function C(S){var R=this[S],Q=this.children||[],O=Q.length,P;for(P=0;P<O;P++){Q[P].set(S,R);}}});mstrmojo.Container.enabledMarkupMethod=function(){mstrmojo.Widget.enabledMarkupMethod.apply(this,arguments);if(this.shouldPropagateEnabled){if(this.enabled){J.call(this);}else{E.call(this,this.children);}}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.registry","mstrmojo._HasContextMenu","mstrmojo.Widget");var F=mstrmojo.dom,K=mstrmojo.css,N=16;mstrmojo.ContextMenuItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasContextMenu],{scriptClass:"mstrmojo.ContextMenuItem",SUBMENU_SHIFT:3,visible:true,checked:false,enabled:true,buildDom:function(){var U=document.createElement("tr"),V=this.data,Y=this._cmSource,R,S;U.id=this.id;U.className="mstrmojo-ContextMenuItem "+(Y.isSeparatorItem(V)?"separator":Y.item2textCss(V));var W=this,X=function(){W.handleMouseOver();},T=function(){W.handleMouseOut();},Q=function(){W.handleClick();};F.attachEvent(U,"mouseover",X);F.attachEvent(U,"mouseout",T);F.attachEvent(U,"click",Q);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-left";S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-text";if(Y.isSeparatorItem(V)){S=document.createElement("img");S.src="../images/1ptrans.gif";}else{S=document.createElement("div");S.className="mstrmojo-CMI-content";R.innerHTML=V.itemWidget?"&nbsp":V[this.itemField];}R.appendChild(S);R=document.createElement("td");U.appendChild(R);R.className="mstrmojo-CMI-right "+(this.hasSubmenu?"sm":"");S=document.createElement("img");S.src="../images/1ptrans.gif";R.appendChild(S);return U;},buildRendering:function L(){this._super();var Q=this.data.itemWidget;if(Q){Q.placeholder=this.domNode.cells[1].children[0];Q.data=this.data;Q=mstrmojo.insert(Q);Q.render();Q.parent=this;this.itemWidget=Q;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"":"none";},oncheckedChange:function(){K.toggleClass(this.domNode,["checked"],this.checked);},onenabledChange:function(){K.toggleClass(this.domNode,["disabled"],!this.enabled);}},getMenuPosition:function I(){var Q=F.position(this.domNode,true);return{x:Math.round(Q.x+Q.w-this.SUBMENU_SHIFT),y:Math.round(Q.y)};},getContextMenuItems:function B(){return this.data[this.itemChildrenField];},getContextMenuCssClass:function D(){return this.data.cmCssClass||"";},callOnContextMenuOpen:function M(){var Q=this.data;if(Q.onContextMenuOpen){Q.onContextMenuOpen.apply(this,[]);}},callOnContextMenuClose:function A(){var Q=this.data;if(Q.onContextMenuClose){Q.onContextMenuClose.apply(this,[]);}},attachMousedownEvent:function J(){},getContextMenuSource:function P(){return this._cmSource;},adjustMenuPosition:function G(){var Q=this._subMenu,T=this._subMenu.domNode,S=T.offsetHeight,R=T.offsetWidth,W=F.windowDim(),V=F.position(T,false),U=F.position(T,true);if((V.x+R+N)>W.w){Q.set("left",(F.position(this.domNode,true).x-R)+"px");}if((V.y+S+N)>W.h){Q.set("top",(W.h-S-N+(U.y-V.y))+"px");}},handleMouseOver:function O(){var Q=this,R=function(){if(Q.hasSubmenu){Q.showContextMenu();}Q._cmSource.closeMenuTree(Q);Q._mouseOverTimer=null;};if(this._cmSource.activeMenuItem!==this){this._mouseOverTimer=window.setTimeout(R,80);}},handleMouseOut:function H(){if(this._mouseOverTimer){window.clearTimeout(this._mouseOverTimer);this._mouseOverTimer=null;}},closeMenuTree:function C(){this._cmSource.closeMenuTree();},handleClick:function E(){if(this.hasSubmenu){return ;}var Q=this._cmSource,R=this.data;if(!this.itemWidget){if(!Q.isSeparatorItem(R)&&Q.queryEnabled(R)){if(Q.executeCommand){Q.executeCommand(this.data);}Q.closeMenuTree();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRoundRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRoundRectangle",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocRoundRectangle" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocRoundRectangle-l1" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@tCornersCssText}{@tCornersCssGradText}"></div><div style="{@rectNodeCssText}{@rectNodeGradCssText}"></div><div class="mstrmojo-DocRoundRectangle-l3" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l2" style="{@bCornersCssText}{@bCornersCssGradText}"></div><div class="mstrmojo-DocRoundRectangle-l1" style="{@bCornersCssText}{@bCornersCssGradText}"></div></div>',markupSlots:{rectNode:function(){return this.domNode.childNodes[3];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["top","left","width","z-index","fx"],rectNode:["height","background-color"],tCorners:["background-color"],bCorners:["background-color"]},update:function C(D){if(this.thresholdId||D.data.tid){delete this.fmts;}this.thresholdId=D.data.tid;this.set("visible",!D.data.hidden);},preBuildRendering:function B(){var F=this._super();var G=this.getFormats(),D=!!this.defn.topc,I=D?4:8,H="(\\d*px)",E=Math.max(parseInt(G.height,10)-I,0);if(G.height==="100%"){H="(100%)";E=this.parent.getHeight()-I;}this.rectNodeCssText=this.rectNodeCssText.replace(new RegExp("(.*height:)"+H+"(.*)"),"$1"+E+"px$3");if(D){this.bCornersCssText="display:none;";}return F;},formatGradient:function A(E,H){var F=mstrmojo.css.buildGradient(E.t,E.sc,E.ec);if(!F){return ;}var D=F.n+":"+F.v+";",G="background-color:";this.rectNodeGradCssText=D;if(E.t===0){this.tCornersCssGradText=G+E.sc+";";this.bCornersCssGradText=G+E.ec+";";}else{this.tCornersCssGradText=this.bCornersCssGradText=D;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget","mstrmojo._ListSelections");var E=mstrmojo.dom;mstrmojo.ListBase=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBase",selectionPolicy:null,itemRenderer:null,icnCssText:"",icnCss:"",markupString:'<div id="{@id}" tstid="{@tstid}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',markupSlots:{itemsContainerNode:function G(){return this.domNode.firstChild;},scrollboxNode:function A(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod},autoHide:false,itemsContainerNode:null,_markupPrefix:null,_markupSuffix:null,_itemPrefix:null,_itemSuffix:null,init:function J(K){this._super(K);if(this.autoHide){this.visible=!!(this.items&&this.items.length);}},buildRendering:function D(){this.itemsHtml="";var K=(this.renderOnScroll?this.items&&((this.renderIndex+1)*this.renderBlockSize):this.items&&this.items.length);if(K){this.itemsHtml=this._buildItemsMarkup(0,K-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");}this._super();delete this.itemsHtml;this.addSlots({itemsNode:this.itemsContainerNode.firstChild});},_buildItemsMarkup:function B(K,N,U,L,V,M){var W=[],Q=0;W[Q++]=U||"";var P=this.itemRenderer,T=P&&P.render;if(T&&typeof T==="function"){var R=this.items,S=Math.min(N+1,((R&&R.length)||0)),O;for(O=K;O<S;O++){W[Q++]=V||"";W[Q++]=T(R[O],O,this);W[Q++]=M||"";}}W[Q+1]=L||"";return W;},onselectionChange:function H(V){if(!V){return ;}var S=this.itemRenderer;if(!S){return ;}var O=S.unselect,R=this.items||[],W=V.removed,N,M,L,P,X;if(O&&W){for(P=0,X=W.length;P<X;P++){N=W[P];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){O(L,R[N],M,this);}}}var K=S.select,U=V.added,Q,T;if(K&&U){for(Q=0,T=U.length;Q<T;Q++){N=U[Q];if(typeof (N)==="object"){M=(N.idx==0)?0:N.positions;N=N.idx;}else{M=N;}L=this._getItemNode(M);if(L){K(L,R[N],M,this);}}}if(this.onchange){this.onchange({added:V.added,removed:V.removed});}},_set_items:function C(N,K){this.renderIndex=0;if(this.autoHide){this.set("visible",!!(K&&K.length));}var M=this.items;this.items=K;if(M!==K){var L=this.hasRendered;if(L){this.unrender(false);}this.clearSelect();if(L){this.render();}return true;}return false;},onItemContextMenu:mstrmojo.emptyFn,oncontextmenu:function F(K){E.preventDefault(window,K.e);var M=K.getTarget(),L=this.getItemFromTarget&&this.getItemFromTarget(M);if(L){if(this.onItemContextMenu(L,K)){K.cancel();}}},_getItemNode:function I(K){var L=this.itemsContainerNode;return(L&&L.childNodes[K])||null;},renderOnScroll:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var C=mstrmojo.dom,B=mstrmojo.hash,E=mstrmojo.css;mstrmojo.Button=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Button",iconClass:"",innerIconClass:"",title:"",text:"&nbsp;",enabled:true,selected:false,markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:function(){E.toggleClass(this.domNode,"disabled",!this.enabled);},onselectedChange:function(){E.toggleClass(this.domNode,"selected",this.selected);},ontextChange:function(){this.textNode.innerHTML=this.text;},ontitleChange:function(){this.domNode.title=this.title;},onwidthChange:mstrmojo.Widget.widthMarkupMethod},oniconClassChange:function D(J){var K=this.domNode;if(this.hasRendered&&K){K.className=K.className.replace(J.valueWas,"")+" "+J.value;}},onclick:mstrmojo.emptyFn,ontouchend:function I(J){this.onclick(J);}});mstrmojo.Button.newIconButton=function H(L,O,M,J,N){var K={scriptClass:"mstrmojo.Button",title:L,cssClass:O,text:"",onclick:M};if(J){K.bindings=J;}B.copy(N,K);return K;};function F(M,N,J,P){var L=[];if(J){L.push(J);}var O=P&&P.cssClass;if(O){L.push(O);delete P.cssClass;}var K={scriptClass:"mstrmojo.Button",cssClass:L.join(" "),text:M};if(N){K.onclick=N;}return B.copy(P,K);}mstrmojo.Button.newInteractiveButton=function G(M,N,P,O){var L={glowClass:"glow"};if(P&&(C.isFF||C.isWK)){B.copy({onmousedown:function J(){E.applyShadow(this.domNode,0,0,10,P);},onmouseup:function K(){E.removeShadow(this.domNode);}},L);}return F(M,N,"mstrmojo-InteractiveButton",B.copy(O,L));};mstrmojo.Button.newWebButton=function A(K,J,M,L){return F(K,J,"mstrmojo-WebButton"+(M?" hot":""),L);};mstrmojo.Button.newActionButton=function(K,L,M){var J=mstrmojo.Button.newWebButton(K,L,false,M);J.cssClass=J.cssClass+" action-button";return J;};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.string","mstrmojo.Widget");var R=["(",")","{","}","-","+","*","/","<",">","|","~",","],G={" ":true,"@":true},Q=null;function J(V){if(!Q){Q={};var U,T;for(U=0,T=R.length;U<T;U++){Q[R[U]]=true;}}return Q.hasOwnProperty(V);}function S(V){if(!V){return false;}var T=V.length,U,W;for(U=0;U<T;U++){W=V.charAt(U);if(J(W)||G[W]){return true;}}return false;}function A(T){return S(T)?"["+T+"]":T;}var M={8:true,9:true,10:true};var C=function(U,T){return M[U]&&!/^\".*\"$/.test(T)?'"'+T+'"':T;};var D=function(U,T,V){var W=typeof V==="undefined"?true:M[V];return U.tp===261&&T.length>=2&&W?(/^\s+$/.test(T.substr(1,T.length-2))?T:T.substr(1,T.length-2)):T;};mstrmojo.ME.MetricToken=mstrmojo.declare(mstrmojo.Widget,null,{data:null,markupString:'<span id={@id} class="mstrmojo-token {@cssClass}"></span>',active:false,markupMethods:{ondataChange:function(){var U=this.data,T=mstrmojo.string.encodeHtmlString(String(U.v));if(U.v===","){this.domNode.innerHTML=T+"&nbsp;";}else{if(U.tp===259&&U.v==="Desc"){this.domNode.innerHTML="&nbsp;"+T;}else{this.domNode.innerHTML=T;}}mstrmojo.css.toggleClass(this.domNode,["mstr"],this.isMstrO());mstrmojo.css.toggleClass(this.domNode,["nfn"],!this.isFunction());mstrmojo.css.toggleClass(this.domNode,["invalid"],U.sta===-1);},onactiveChange:function(){mstrmojo.css.toggleClass(this.domNode,["active"],this.active);}},isMstrO:function P(){return !!this.data.oi||!!this.data.rfd;},isFunction:function B(){return this.isMstrO()&&(this.data.oi&&this.data.oi.t==11);},brackets:A,length:function E(){return this.data.v.toString().length;},isDelimiter:function O(){return this.data.isDelimiter||(this.length()===1&&J(this.data.v));},split2Tokens:function H(W){var V=this.data,U=V&&V.v.toString(),X=U.substring(0,W),T=U.substring(W);return[{v:X,isNew:true},{v:T,isNew:true}];},mergeTo:function I(U){var W=this.data,V=W&&W.v.toString(),T=U.data.v.toString();return{v:V+T,isNew:true};},brackets:A,setItemInfo:function N(T){var U=this.data;U.v=this.brackets(T.n);U.oi=T;U.sta=1;U.isNew=true;this.set("data",U);this.paint();},spliceContent:function K(Z,X,U){var Y=this.data,W=Y&&Y.v.toString(),a=W.substring(0,Z);X=(X===null||X===undefined)?(W.length-Z):X;var T=W.substring(Z+X),V=a+(U||"")+T;Y.v=V;Y.isNew=true;Y.sta=1;Y.ift=(this.isAttributeToken()||Y.at)&&(Y.v.indexOf("@")>=0);if(Y.ift){Y.at=Y.oi||Y.at;}else{delete Y.at;}delete Y.oi;delete Y.exv;delete Y.extp;delete Y.tp;this.set("data",Y);this.paint();},isAttributeToken:function F(){return this.data&&this.data.oi&&this.data.oi.t===12;},setFormInfo:function L(U){var V=this.data,T=V.oi||V.at;V.v=this.brackets(T.n)+"@"+this.brackets(U.n);V.exv=U.did;V.extp=8;V.sta=1;V.isNew=true;V.oi=V.at;delete V.at;this.set("data",V);this.paint();}});mstrmojo.ME.MetricToken.isDelimiter=J;mstrmojo.ME.MetricToken.brackets=A;mstrmojo.ME.MetricToken.quotes=C;mstrmojo.ME.MetricToken.unquotes=D;mstrmojo.ME.MetricToken.QUOTABLE_DATATYPES=M;mstrmojo.ME.MetricToken.argDelimiter={".":",",",":";"}[mstrConfig&&mstrConfig.decimalSep]||",";})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocHTMLContainer=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocHTMLContainer",scrolling:"auto",markupString:'<iframe id="{@id}" k="{@k}" class="mstrmojo-DocHTMLContainer" title="{@tooltip}" style="{@domNodeCssText}" src="{@v}" scrolling="{@scrolling}"></iframe>',formatHandlers:{domNode:["RW","B","F","background-color","text-align","white-space","fx"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function A(B){this.v=B.data.v;if(mstrApp&&mstrApp.isTouchApp()){this.scrolling="no";}if(this.thresholdId||B.data.tid){delete this.fmts;}this.thresholdId=B.data.tid;this.set("visible",!B.data.hidden);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var B="mstrmojo-Image";mstrmojo.Image=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Image",markupString:'<div id="{@id}" class="'+B+' {@cssClass}" style="{@cssText}" mstrAttach:click><image src="{@src}" mstrAttach:load /></div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onsrcChange:function(){var C=this.imgNode;if(C){C.src=this.src||"../javascript/mojo/css/images/1ptrans.gif";}},oncssClassChange:function(){var C=this.domNode;if(C){C.className=this.cssClass||B;}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},src:"",getImageSize:function A(){var C=this.imgNode;return{w:C.clientWidth,h:C.clientHeight};}});mstrmojo.Image.baseCssClass=B;}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui._HasScroller","mstrmojo.css");var C=mstrmojo.css,E=mstrmojo.desc(14058,"Show Details"),A=mstrmojo.desc(14059,"Hide Details"),F=mstrmojo.desc(14060,"We are sorry for the inconvenience. Please {contact} your administrator for help.").replace("{",'<span class="dyn-link">').replace("}","</span>");mstrmojo.ui.editors.ErrorDialogContent=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",markupString:'<div class="mstrmojo-error-content" mstrAttach:click><div class="scroll-container"><div>{@shortDesc}</div><div>'+F+'</div><div class="toggle-details-link" >'+E+'</div><div class="error-details">{@en@longDesc}</div></div></div>',markupSlots:{scrollNode:function(){return this.domNode.firstChild;},contactNode:function(){return this.domNode.firstChild.children[1].getElementsByClassName("dyn-link")[0];},toggleDetailsNode:function(){return this.domNode.firstChild.children[2];}},markupMethods:{onshowDetailsChange:function(){var H=this.showDetails;this.toggleDetailsNode.innerHTML=H?A:E;C.toggleClass(this.domNode,"show-details",H);this.updateScrollbars();}},shortDesc:undefined,longDesc:undefined,showDetails:false,init:function G(H){this._super(H);this.shortDesc=this.shortDesc||mstrmojo.desc(14061,"An error has occurred");},onclick:function B(H){var J=H.getTarget(),I,K=this.longDesc;if(J===this.contactNode){I="mailto:?subject="+encodeURI("Issue: "+this.shortDesc)+(K?("&body="+encodeURI("Detail:\r\n"+K)):"");mstrApp.openPage(I,"_self");}else{if(J===this.toggleDetailsNode){this.set("showDetails",!this.showDetails);}}},setupScrollNodes:function D(){this.scrollNode=this.scrollNode;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.dom");var H=mstrmojo.color,F=mstrmojo.dom;var G=68.5,I=77.5,C=83;function A(L,K){var J=F.getMousePosition(L,window);return{x:J.x-K.x-I,y:J.y-K.y-I};}function B(L){var K=this._hsl,J=K[0],N=K[1],P=K[2],Q=J*2*Math.PI;var M=this.hueHandleNode.style;M.left=Math.round(Math.sin(Q)*G+I)+"px";M.top=Math.round(-Math.cos(Q)*G+I)+"px";var O=this.slHandleNode.style;O.left=Math.round(C*(0.5-N)+I)+"px";O.top=Math.round(C*(0.5-P)+I)+"px";this.slNode.style.backgroundColor=H.hsl2hex(J,1,0.5);if(!L){this.onColorPicked(H.hsl2hex(J,N,P));}}mstrmojo.ui.editors.controls.ColorWheel=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",markupString:'<div id="{@id}" class="mstrmojo-ui-ColorWheel {@cssClass}" style="{@cssText}" mstrAttach:mousedown><div class="cwHue"></div><div class="cwColorField"></div><div class="cwHandle"><div></div></div><div class="cwHandle"><div></div></div></div>',markupSlots:{slNode:function(){return this.domNode.childNodes[1];},hueHandleNode:function(){return this.domNode.childNodes[2];},slHandleNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,oncolorChange:function(){this._hsl=H.hex2hsl(this.color);B.call(this,true);}},slNode:null,hueHandleNode:null,slHandleNode:null,color:"#ffffff",onColorPicked:function E(J){},onmousedown:function D(M){var O=this,J=F.position(this.domNode),P=this._hsl,L=M.e,N=A(L,J),Q=Math.max(Math.abs(N.x),Math.abs(N.y))*2>C,K=function(S){var V=A(S,J),R=P[0],T=P[1],U=P[2];if(Q){R=Math.atan2(V.x,-V.y)/(2*Math.PI);if(R<0){R+=1;}}else{T=Math.max(0,Math.min(1,-(V.x/C)+0.5));U=Math.max(0,Math.min(1,-(V.y/C)+0.5));}O._hsl=[R,T,U];B.call(O);F.stopPropogation(window,S);return false;};F.attachMouseMoveEvents(K);K(L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash");function A(H,E,G,F){var D=mstrmojo.hash.copy(F,{props:{left:{isStyle:true,start:H,stop:E,suffix:"px",ease:mstrmojo.ease.linear}},duration:G});(new mstrmojo.fx.AnimateProp(D)).play();}function B(K,N,G,L){var I=K.domNode,M=I.offsetWidth,D=K.scrollableIncFetch;var E=K.hasAnimation&&(!(/Firefox[\/\s](\d+\.\d+)/.test(navigator.userAgent))||Number(RegExp.$1)>3.5),J=L?1:-1,F=parseInt(M,10)*J,H=E?500:0;A(0,-F,H,{target:G,duration:H,preStart:function(){this.target.style.overflowY="hidden";},onEnd:function(){this.target.style.display="none";}});A(F,0,H,{target:N,preStart:function(){this.target.style.display="block";this.target.style.overflowY=(D?"visible":"auto");}});if(K.waiting){A(0,-F,H,{widget:K,slot:"loaderNode",onEnd:function(){this.widget.waiting=false;}});}}var C=function(D){var E=D.currentPage;if(E===D.p1Node){E=D.p2Node;}else{E=D.p1Node;}D.currentPage=E;};mstrmojo.Booklet=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Booklet",pageClass:"mstrmojo-BookletPage",markupString:'<div id="{@id}" class="mstrmojo-Booklet {@cssClass}" style="{@cssText}"><div id="{@id}_p1" class="mstrmojo-BookletPage" ></div><div id="{@id}_p2" class="mstrmojo-BookletPage" style="left:-100%;"></div><div id="{@id}_ldr" class="mstrmojo-BookletLoader" ></div></div>',markupSlots:{containerNode:function(){return this.domNode;},p1Node:function(){return this.domNode.firstChild;},p2Node:function(){return this.domNode.childNodes[1];},loaderNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onnextChange:function(){var G=this.next;if(!G){return ;}var D=this.currentPage,F=this.p1Node,E=this.currentPage=(D==F)?this.p2Node:F;if(!(G instanceof mstrmojo.Obj)){G=this.next=mstrmojo.insert(G);}if(!G.hasRendered){G.placeholder=E.appendChild(document.createElement("span"));G.render();}else{if(E.firstChild){E.replaceChild(G.domNode,E.firstChild);}else{E.appendChild(G.domNode);}}this.set("waiting",false);if(E&&D){B(this,E,D,this.turnDirFwd);}else{if(this.scrollableIncFetch){E.style.overflowY="visible";}}},onwaitingChange:function(D){this.loaderNode.style.left=(this.waiting)?0:"-100%";},onheightChange:function(D){if(this.height){this.domNode.style.height=this.height;}},onwidthChange:function(D){if(this.width){this.domNode.style.width=this.width;}}},enabled:true,waiting:false,next:null,currentPage:null,turnDirFwd:true,hasAnimation:true,scrollableIncFetch:false,FORWARD:true,REVERSE:false,turnFwd:function(D){this.turn(D,this.FORWARD);},turnBack:function(D){this.turn(D,this.REVERSE);},turn:function(D,E){this.set("turnDirFwd",E);this.set("next",D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._Formattable");mstrmojo.DocRectangle=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocRectangle",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocRectangle" title="{@tooltip}" style="{@domNodeCssText}"></div>',markupMethods:{onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";}},onwidthChange:function(){if(this.width){this.domNode.style.width=this.width+"px";}},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["RW","B","background-color","fx"]},preBuildRendering:function A(){var D=this._super(),C=this.defn;if(C.r){this.domNodeCssText+=mstrmojo.css.buildRoundCorners(C.r,C.topc);}return D;},postBuildRendering:function(){var E=this._super();var D=this.fmts;if(D){var C=D.border||D["border-width"],F=C&&(parseInt(C,10)/72*this.model.dpi);if(F){if(D.height==="100%"){this.set("height",this.domNode.clientHeight-2*F);}if(D.width==="100%"){this.set("width",this.domNode.clientWidth-2*F);}}}return E;},update:function B(C){if(this.thresholdId||C.data.tid){delete this.fmts;}this.thresholdId=C.data.tid;this.set("visible",!C.data.hidden);if(this._super){this._super(C);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasEditableText","mstrmojo.css","mstrmojo.string","mstrmojo.dom");var C=mstrmojo.css,A=mstrmojo.dom,F=mstrmojo.string,E=function(H){this._super&&this._super(H);A.stopPropogation(H.hWin,H.e);},G=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.DynamicNode=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasEditableText],{scriptClass:"mstrmojo.fe.DynamicNode",markupString:'<div id="{@id}" class="mstrmojo-dynamic {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-dynamic-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-dynamic-prefix-text"  mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">'+G+'<span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-onhoverparent mstrmojo-dynamicNode" title="'+mstrmojo.desc(13229,"Add this condition to the target list of a selector.")+'"><span class="mstrmojo-dynamicNode-info"><span class="mstrmojo-textset"></span></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" ></img></span><span class="mstrmojo-textset mstrmojo-rename-text" mstrAttach:click >'+mstrmojo.desc(1388,"Rename")+"</span>"+G+"</div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},dynamicNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.lastChild.firstChild.lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},createSetNode:function(){return this.domNode.lastChild.lastChild;},renameNode:function(){return this.domNode.lastChild.childNodes[2];}},markupMethods:{onprefixedAndOrEditableChange:function(){C.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){C.toggleClass(this.dynamicNode,["selected"],this.selected);},onisEditingChange:function(){C.toggleClass(this.domNode,["renaming"],this.isEditing);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=this.data.ph.n;},onglowChange:function(){var H=this;C.toggleClass(H.dynamicNode,["glow"],this.glow);if(this.glow){setTimeout(function(){C.toggleClass(H.dynamicNode,["glow"],false);H.glow=false;},1000);}},onnoRelationOperatorChange:function(){C.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){C.toggleClass(this.dynamicNode,["noRelation"],this.noRelation);}},editableSlot:"textNode",editButtonSlot:"renameNode",init:function(H){var J=H.data;if(J){var I=H.tree.nameFactory;if(J.ph.n){I.setName(J.ph.n,this);}else{J.ph.n=I.getNewName(this,mstrmojo.desc(12033,"Dynamic Condition")+" ");}}this._super(H);},_set_data:function(K,H){var I=this.data,J=(I!==H);if(J){this.data=H;this.text=H.ph.n;}return J;},preclick:function D(H){var J=null,I=A.eventTarget(H.hWin,H.e);if(A.contains(this.prefixNode,I,true)){J="andor";}else{if(A.contains(this.createSetOptNode,I,true)&&!this.noRelationOperator&&!this.noRelation){J="createSetOpt";}else{if(A.contains(this.createSetNode,I,true)&&!this.noRelation){J="createSet";}else{if(A.contains(this.renameNode,I,true)){this.set("isEditing",true);}}}}H.part=J;},isEmpty:function(){var I=this.data,H=I&&I.ph;return !(H&&H.n);},del:function B(){var I=this.parent,H=this.tree.nameFactory;if(I&&I.remove&&this.data){I.remove(this.data);H.removeName(this.data.ph.n);}},onkeyup:E,onkeydown:E,onTextEditComplete:function(){var J=this.tree,K=J.nameFactory,H=F.trim(this.text||""),I=this.data.ph.n;if(H&&H!==I){if(K.isNameExist(H)){K.names[H].set("glow",true);this.set("isEditing",true);}else{K.changeName(I,H,this);this.data.ph.n=H;}}},isSelectableArea:function(H){return mstrmojo.dom.contains(this.dynamicNode,H,true);},avatarCssCls:"mstrmojo-FE mstrmojo-dynamicNode",getAvatarNode:function(){return this.dynamicNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string");var B=mstrmojo.string;mstrmojo.Label=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.Label",allowHTML:false,text:"",title:"",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" title="{@title} "mstrAttach:click></div>',markupMethods:{ontitleChange:function(){this.domNode.title=this.title;},ontextChange:function(){var C=this.text;C=B.isEmpty(C)?"":C.toString();this.domNode.innerHTML=this.allowHTML?C:B.encodeHtmlString(C,true);},oncssTextChange:mstrmojo.Widget.cssTextMarkupMethod,onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Widget.enabledMarkupMethod},autoHide:false,_set_text:function A(E,C){if(this.autoHide){this.set("visible",(C!==null)&&(C!=="")&&(C!==undefined));}var D=this.text;this.text=C;return(D!==C);}});}());mstrmojo.ToolSeparator=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.ToolSeparator",markupString:'<div class="mstrmojo-ToolSeparator {@cssClass}" style="{@cssText}"></div>',markupSlots:{},markupMethods:{}});(function(){mstrmojo.requiresCls("mstrmojo.StepperContentProvider","mstrmojo.num");var A=mstrmojo.num;function B(G,F){var H=F?G.max:G.min,D=F?G.min:G.max,E=G.getVal(F?1:-1);return(H===null||(F?(E<=H):(E>=H))||(D!==null&&G.canLoop));}function C(H,G){var F=H.min,D=H.max,E=H.getVal(G?1:-1);if((G&&D!==null&&E>D)||(!G&&F!==null&&(E<F))){if(H.canLoop){E=((E-F)%(D-F+1))+F;E=(E>=F)?E:E+(D-F+1);}else{return ;}}H.item[H.valField]=H.curVal=E;H.onTraverse();}mstrmojo.NumStepperContentProvider=mstrmojo.declare(mstrmojo.StepperContentProvider,null,{scriptClass:"mstrmojo.NumStepperContentProvider",curVal:null,init:function(E){this._super(E);var F=this.item,D=function(I){var H=I&&F[I];return(H===null||H===undefined);},G=function(I,K,H){var J=H&&D.call(this,K)?null:F[K];if(J!==null&&J!==undefined){this[I]=J;}};G.call(this,"min",this.minField,true);G.call(this,"max",this.maxField,true);G.call(this,"interval",this.intField);this._initCurrent();},_initCurrent:function(){var E=this.item,F=this.curVal=E[this.valField];if(F===null||F===undefined){var D=this.min;this.curVal=D!==null?D:0;}},next:function(){C(this,true);},prev:function(){C(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},renderItemAt:function(F){var E=this.getVal(F),D=this.renderer;return D?D.render(E,this):E;},getVal:function(D){return this.curVal+(this.interval*(D||0));},setVal:function(F){var G=this.min,D=this.max,E=this.getVal();if(typeof F!=="number"||isNaN(F)||F===E||A.inNumericRange(F,G,D)!==0){return ;}this.item[this.valField]=this.curVal=F;this.onTraverse();},onTraverse:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom");function Z(a,c){if(!mstrmojo.DocInfoWindow){return ;}var b=a;while(b){if(b instanceof mstrmojo.DocInfoWindow){b[c?"registerScrollLock":"releaseScrollLock"](this);break;}b=b.parent;}}var L=mstrmojo.array,C=mstrmojo.dom,P=mstrmojo.hash,W=mstrmojo.css,F="px";var B=false;function K(a,c){if(!mstrmojo.DocInfoWindow){return ;}var b=a;while(b){if(b instanceof mstrmojo.DocInfoWindow){b[c?"registerLock":"releaseLock"](this);this.lockIW=c?b:null;break;}b=b.parent;}}var A=mstrmojo.ui.PopupConfig.ENUM_CORNERS,T=A.TOP_LEFT,R=A.TOP_RIGHT,H=A.BOTTOM_RIGHT,G=A.BOTTOM_LEFT;function I(a){return(a===G||a===T);}function X(a){return(a===R||a===H);}function N(a){return(a===H||a===G);}function Q(a){return(a===R||a===T);}function U(h,c,o,u){var x=o.x,w=o.y,t=o.w||0,k=o.h||0,b=u.w,p=u.h,r=h.alignment,f=r.popup,e=r.host,v=X(e),z=N(e),q=false,m=false,d=false,n=false;if(I(f)){var g=x+b+(v?t:0);q=c.w<g;}if(Q(f)){var l=w+p+(z?k:0);m=c.h<l;}if(X(f)){var j=x-b+(v?t:0);d=j<0;}if(N(f)){var a=w-p+(z?k:0);n=a<0;}return{top:n,bottom:m,left:d,right:q};}function E(b){var a=this.popupConfig;if(a){P.forEach(a.popupHandlers,function(d,e){var c=d[b?"open":"close"];if(c){c.call(mstrmojo.all[e]||c,!!b);}});}}function J(b){var a=this.popupConfig;if(a&&!a.isHostedWithin){var c=this.hostProxy;if(c){c.style.display=b?"":"none";}}}function Y(a){return a!==undefined&&a!==null&&!isNaN(a);}mstrmojo._IsPopup={visible:false,lockIWForScroll:false,disposable:true,opener:null,onOpen:mstrmojo.emptyFn,onClose:mstrmojo.emptyFn,popupConfig:null,hostProxy:undefined,open:function M(c,a){E.call(this,true);if(this.updatePopupConfig){this.updatePopupConfig(a,c);}else{P.forEach(a,function(f,e){this.set(e,f);},this);}var b="popup-mid-render";this.set("opener",c);if(!this.hasRendered){var d=this.visible;this.visible=false;this.render();W.addClass(this.domNode,b);this.set("visible",d);}if(this.nudge){this.domNode.style.top="-10000px";}J.call(this,true);this.set("visible",true);if(this.lockIWForScroll){Z.call(this,this.opener,true);}if(a&&a.lockIW){K.call(this,a.lockIW,true);}if(this.nudge){this.nudge();}this.adjustCornersForPopupOverflow();this.onOpen();W.removeClass(this.domNode,b);},adjustCornersForPopupOverflow:function V(){var l=this.popupConfig;if(!l){return false;}var AJ=(l.includeScroll!==undefined)?l.includeScroll:true;var o=l.position||C.position(l.anchorElement||l.hostElement,AJ);if(!l.isHostedWithin){var z=this.hostProxy,r=this.hostProxy=document.createElement("div");document.body.appendChild(r);r.appendChild(this.domNode);if(z){z.parentNode.removeChild(z);}var e=r.style,t={x:"left",y:"top",w:"width"};r.className=l.hostProxyCssClass;e.position="absolute";e.background="none";e.height="0";L.forEach(["x","y","w"],function(AM){var AL=o[AM];if(Y(AL)){e[t[AM]]=AL+F;}});}var AG=l.ENUM_CORNERS,w=AG.BOTTOM_LEFT,j=AG.BOTTOM_RIGHT,h=AG.TOP_RIGHT,AC=AG.TOP_LEFT;var AD=U(l,C.position(document.body),o,C.position(this.domNode)),x=AD.right,p=AD.bottom,d=AD.left,v=AD.top,AB=l.alignment,q=AB.popup,AK=AB.host,g=q,c=AK;if(x||d){if(I(c)){c=Q(c)?h:j;}else{if(X(c)){c=Q(c)?AC:w;}}if(x&&I(g)){g=Q(g)?h:j;}else{if(d&&X(g)){g=Q(g)?AC:w;}}}if(p||v){if(I(c)){c=Q(c)?w:AC;}else{if(X(c)){c=Q(c)?j:h;}}if(p&&Q(g)){g=I(g)?w:j;}else{if(v&&N(g)){g=I(g)?AC:h;}}}if(v||x||p||d){if(B){console.log("Overflow directions: "+JSON.stringify(AD));}this._orgalgn={host:AK,popup:q};l.setAlignment(c,g);}if(!l.isHostedWithin){if(Y(o.y)&&Y(o.h)){this.hostProxy.style.top=(o.y+(N(g)?(l.alignWithAnchor===true?o.h:0):(l.alignWithAnchor===true?0:o.h)))+F;}}var AA=N(c),AF=X(c),AE=N(g),n=X(g),k="auto",b="100%",a="0";var u=k,AH=k,m=k,f=k;if(AE){m=AA?a:b;}else{u=AA?b:a;}if(n){AH=AF?a:b;}else{f=AF?b:a;}var AI=this.domNode.style;AI.top=u;AI.right=AH;AI.bottom=m;AI.left=f;return true;},close:function O(b){if(this.onClose){this.onClose(b);}J.call(this,false);if(this.lockIWForScroll){Z.call(this,this.opener,false);}this.set("visible",false);this.set("opener",null);if(this.lockIW){K.call(this,this.lockIW,false);}E.call(this,false);var a=this._orgalgn;if(a){this.popupConfig.setAlignment(a.host,a.popup);}},buildRendering:function D(){var a=this._super();if(a){if(!this.parent&&!this.domNode.parentElement){document.body.appendChild(this.domNode);}}return a;},unrender:function S(a){if(this.popupConfig&&!this.popupConfig.isHostedWithin&&this.hostProxy){document.body.removeChild(this.hostProxy);delete this.hostProxy;}this._super(a);}};}());(function(){mstrmojo.ToolBarModel=mstrmojo.declare(mstrmojo.Model,null,{scriptClass:"mstrmojo.ToolBarModel",getChildren:function A(C,B){return(C||this.n||this).items;}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.boxmodel","mstrmojo.Model","mstrmojo._CanProxyCallback","mstrmojo.EnumRWUnitType","mstrmojo.models.template.DataInterface","mstrmojo.StringBuffer","mstrmojo.EnumReadystate");var Ai=mstrmojo.EnumRWUnitType,K=mstrmojo.EnumReadystate,R=mstrmojo.hash,Av=R.forEach,At=mstrmojo.func.wrapMethods,Ar=mstrmojo.Obj.free,M=mstrmojo.array,AI=mstrmojo.boxmodel,C=mstrmojo.mixin,b="\u001E";var F={},T={},N=[11826975,1381846,1810715,950271,12407690,2276796,13614615,8355711,15255470,9869567,9101208,7912447,14004421,9296859,15063710,13092807];mstrmojo.MultiRWUnitFormatEventsType=null;var AJ={isObservable:function(A3){var A2=A3&&A3.t;if((!A2&&A2!==Ai.LAYOUT)||!this.hasOwnProperty(A2)||A3.scriptClass){return false;}return(A2!==Ai.SUBSECTION||!A3.dt);},makeObservable:function(A2){var A3=A2.audibles=this[A2.t]||{};if(A3.hasOwnProperty("readyState")){A2.readyState=K.IDLE;}return new mstrmojo.Model(A2);}};AJ[Ai.PANELSTACK]={"*":false,selKey:true,readyState:true};AJ[Ai.GRID]={"*":false,readyState:true,ds:true};AJ[Ai.GRAPH]={"*":false,readyState:true,ds:true};AJ[Ai.GRIDGRAPH]={"*":false,qsm:true,ds:true};AJ[Ai.SUBSECTION]={"*":false,resize:true,adjustSize:true};AJ[Ai.VISUALIZATION]={"*":false,ds:true};AJ[Ai.SELECTOR]={"*":false,cek:true,ds:true,readyState:true};AJ[Ai.MOJOVISUALIZATION]={"*":false,ds:true};AJ[Ai.LAYOUT]={"*":false,readyState:true};var Ad={};function Ak(A2){return Ad[A2]||Ad["*"];}Ad["*"]={update:function l(A3,A4,A2,A5){R.copy(A2,A4);}};Ad[Ai.PANEL]=C({update:function l(A3,A4,A2,A5){delete A4.layoutXML;this._super(A3,A4,A2);}},Ad["*"]);function f(A7,A8){var A3=A7.layoutMap&&A7.layoutMap[A8];if(A3){if(!A3.t){A3.t=Ai.LAYOUT;}if(AJ.isObservable(A3)){A3=A7.layoutMap[A8]=this.addDisposable(AJ.makeObservable(A3));}return A3;}var A2=A7.layouts,A6=(A2&&A2.length)||0,A5;for(A5=0;A5<A6;A5++){if(A2[A5].k===A8){var A4=A2[A5];if(!A4.t){A4.t=Ai.LAYOUT;}if(AJ.isObservable(A4)){A2[A5]=this.addDisposable(AJ.makeObservable(A4));}return A2[A5];}}return null;}function z(A5,A7,A4,A3){var A2=f.call(this,A5,A7);if(A4===A7){A2._lkz=A7;return A2;}if(A2){var A6=A2.units[A4];if(A6){if(parseInt(A6.t,10)===Ai.GRIDGRAPH){if(!A2.units[A4+"_0"]){A2.units[A4+"_0"]={ck:A6.ck,fmts:A6.fmts.gd,txi:A6.txi,t:Ai.GRID};A2.units[A4+"_1"]={ck:A6.ck,fmts:A6.fmts.gp,t:Ai.GRAPH};}}if(!A3&&AJ.isObservable(A6)){A6=A2.units[A4]=AJ.makeObservable(A6);this.disposables.push(A6);}A6._lkz=A7;}}return A2&&A2.units[A4];}function AP(A6,A5,A4,A2){var A3=this.getChildren(A6,A5,0);return(mstrApp.isMobile?(M.filter(A3,function(A9){var A7=A4&&A4.indexOf(A9.defn.t),A8=A9.defn.dk;return A2?(A7>-1&&A8===-1):(A7<0||A8!==-1);})):(A2?[]:A3));}var I=function(A2,A3){var A4=new mstrmojo.StringBuffer();if(A3){A4.append("*l"+A3);}A4.append("*k"+A2.k);if(A2.hasOwnProperty("wid")){A4.append("*x"+A2.wid);}A4.append("*t"+this.buildTime);return A4.toString();};function AF(A4){var A3,A2,A7=this.delta,A5=this.pendingUpdate=this.pendingUpdate||{},A6=[];if(!R.isEmpty(A7)){A6.push("<updates>");for(A3 in A7){if(A7.hasOwnProperty(A3)){A2=A7[A3];A6.push(A2.getUpdates());}}A5[A4]=A7;this.delta={};A6.push("</updates>");}return A6.join("");}function Ay(A7,A3){var A6;if(A7){var A2=M.isArray(A7)?A7:A7.split(A3||b),A5=A2.length,A4;for(A4=0;A4<A5;A4++){A6=A6||{};A6[A2[A4]]=z.call(this,this.defn,this.currlaykey,A2[A4]);}}return A6;}function o(A2,A3){return mstrmojo.all[I.call(this,{k:A2,wid:A3},this.currlaykey)];}function Ae(A3,A2){var A4=this.getLayoutUnitDefn(A3,A2);return(A4&&A4.t===Ai.PANELSTACK&&A4.ifw);}function Ag(A3,A2){return !A2||(A3.wid===A2);}function e(A6,BE){var A9=this,BF=A9.getSliceCallback(BE),A4=BF.shared,BG=BE.tks,A3=BE.eid,BC=A9.getDataService();if(!BG){return ;}var BB=z.call(A9,A9.defn,A9.currlaykey,A3);if(!BB){return ;}var A8=A3,BA=A4.tgtDefs[BG],A2=function(){BA.set("selKey",A3);},A5;BA.newSelKey=A3;if(BB.l){var A7=BB.dirtyKeys;if(!!A7){A8=R.keyarray(A7).join(",");A4.orignalTargetDefs=A4.tgtDefs=Ay.call(A9,A8,",");A5=function(){A2();Av(A4.dataCacheUpdate.upd,function(BH,BI){var BJ=mstrmojo.all[BI];if(BJ&&BJ.setDirty){BJ.setDirty(false);}});};}else{if(BE.skipServerCall){A2();return ;}BC.requestPanelChangeDeferred(A6,A3,null,false,false,A9.newCallback({method:"slice",success:A2}));return ;}}else{A5=function(){A2();BB.l=true;};}var BD=BF.success;BF.success=function(BI){if(!A9.checkStatus(BI)){return ;}A9.updateDefnCache(BI.defn,[A3]);BD(BI);A5();var BH=o.call(A9,BE.tks,0);if(BH){BH.clearDirtyChild(A3);}};BC.requestPanelChangeDeferred(A6,A3,A8,true,!BE.hasLoader,BF);}function W(A3,A2){if(A3.defn&&A3.defn.t>=Ai.GRID){mstrmojo.models.template.DataInterface.inflateGridData(A3.data);}A2[A3.id]=A3;return A3;}function AM(BL,BB,A2,A8){var BE=this.currlaykey,A5;if(BL){A5=BL.defn;BE=(A5&&A5._lkz)||BL.k;}var BW=this.getLayoutDataCache(BE),BM=(!A2&&!R.isEmpty(BW)),BS;if(!BL){BS=this.data;}else{var BA=BL.data||BL;if(BM){BS=BW[I.call(this,BA,BE)];BS=(BS&&BS.data)||BS||BA;}else{BS=BA;}}if(!!BS.sections){this._buildingLayoutKey=BS.k;}var A3=BS?this.extractChildren(BS):[],BG=[];var BP=(A3&&A3.length)||0;if(BP){A5=this.defn;var BI=!BL,BD=BL?BE:null,A7=(BL&&((BL.defn)?BL.defn.t:z.call(this,A5,BD,BL.k).t));var A4=(A7===Ai.GRIDGRAPH),BQ=(A7===Ai.DETAILS),BO,BN;A3=BB(A3);for(BO=0,BN=A3.length;BO<BN;BO++){var BU=A3[BO];if(A4){BU.k=BL.k;BU.wid=BL.data.wid;}var BY=BU.k,BK=I.call(this,BU,BD),BT;if(!BI&&!A2&&Ae.call(this,BY,BD)){var BR=this.getLayoutUnitDefn(BY),BH=W({data:BU,defn:BR,id:BK,k:BY,p:BS},BW);if(!this.infoWinByKey||!this.infoWinByKey[BY]){var A6=this.infoWindows=this.infoWindows||{};var BV=this.infoWinByKey=this.infoWinByKey||{};A6[BR.n]=BV[BY]=BH;}continue;}if(A4){BK+="_"+BO;BT=z.call(this,A5,BD,BU.k+"_"+BO);}else{BT=z.call(this,A5,BD||BU.k,BU.k);}if(BQ){BT.dt=true;}if(BW===null&&(BT.t===Ai.LAYOUT)){BW=this.getLayoutDataCache(BU.k);}var BX;if(BT.t===Ai.PANEL&&BW[BK]&&BM){var A9=this.extractChildren(BU)||[],BF=this.extractChildren(BW[BK].data)||[],BC=false;if(A9.length!=BF.length){M.forEach(BF,function(Ba){var BZ=M.find(A9,"k",Ba.k);if(BZ>-1){A9[BZ]=Ba;BC=true;}});if(BC){BF.splice(0,BF.length);M.forEach(A9,function(BZ){BF.push(BZ);});}}BX=BU;}else{BX=BM?(BW[BK]&&BW[BK].data)||BU:BU;}var BJ={k:BU.k,id:BK,defn:BT,data:BX};if(!BW[BK]){W(BJ,BW);}BG.push(BJ);}}return A8?{nodes:BG,total:BP}:BG;}function Az(A8,A3,A7){var A2=AI.px2Inches,A4=this.getZoomProps(),A6=1,A5=2;if((A7&A6)>0){A8.FormattingPosition={Left:A2(A4,A3.x||0),Top:A2(A4,A3.y||0)};}if((A7&A5)>0){A8.FormattingSize={Height:A2(A4,A3.h||0),Width:A2(A4,A3.w||0)};}}function t(A3){function A2(A5,A4){return A5<A4?-1:(A5>A4?1:0);}A3.sort(function(A5,A4){var A6=A2(A5.levelID,A4.levelID);return A6!==0?A6:A2(A5.elemID,A4.elemID);});return A3;}function Aw(A2,A3){return A2.map(function(A4){return A4[A3];}).join(b);}function J(A2){return Aw(A2,"levelID");}function Ax(A2){return Aw(A2,"elemID");}function AG(A3){if(A3){T={};}F={};var A2=this.defn.epm;if(A2){A2.forEach(function(A4){A4.epmv.forEach(function(A5){var A7=t(A5.k.chn.map(function(BA){var A9=BA.emt!==2;return{levelID:A9?BA.at.did:"-1",elemID:A9?BA.ei:BA.mt.did};})),A8=J(A7),A6=Ax(A7);if(!F[A8]){F[A8]={};}F[A8][A6]=JSON.parse(A5.v.vv);});});}}function a(A2){if(A2){A2=mstrmojo.rw.model.RetrievalKeysConfig.parseResponseFilters(A2);}return A2;}function AC(){var A3=this.data&&this.data.layouts,A2=A3[M.find(A3,"k",this.getCurrentLayoutKey())],A5=A2&&A2.gbys&&A2.gbys.groupbys,A4=false;M.forEach(A5,function(A6){if(A6.unit&&A6.unit.elms&&A6.unit.elms[A6.unit.idx].v==="u;"){A4=true;return false;}});return A4;}mstrmojo.DocModel=mstrmojo.declare(mstrmojo.Model,[mstrmojo._CanProxyCallback],{scriptClass:"mstrmojo.DocModel",audibles:{"*":false,data:true,tsp:true},features:null,dataCache:null,searchElemsCache:null,controller:null,sdp:null,dpi:96,keySeed:0,currlaykey:"",init:function AR(A2){this._super(A2);if(!this.features){this.features=new mstrmojo.Model();this.disposables.push(this.features);}this.ondefnChange();AG.call(this);this.buildTime=mstrmojo.now();},hasFeatures:function AO(A6){var A4=this.features;if(!A4){return false;}var A3=A6.split(","),A2=A3.length,A5;for(A5=0;A5<A2;A5++){var A7=A3[A5],A8=A7.match(/^!/);if(A8){A7=A7.replace("!","");}if(!!A8===!!A4[A7]){return false;}}return true;},makeObservable:function AQ(A2){return AJ.makeObservable(A2);},checkStatus:function As(A2){if(parseInt(A2.status,10)===4){A2.message=mstrmojo.desc(5781,"Request timed out.");mstrmojo.err(A2);return false;}return true;},getDataService:function Ab(){var A3=this.dataService;if(!A3){var A2={rwb:this.bs,msgId:this.mid,stid:this.stid,cbKey:this.cbKey,model:this};if(mstrApp.modelFactory){A3=mstrApp.modelFactory.newDataService("Document",A2);}else{A3=mstrApp.viewFactory.newDocDataService(A2);}this.dataService=A3;this.disposables.push(A3);}return A3;},getNextKey:function Aj(){return"W"+this.keySeed++;},resetKeySeed:function D(A2){this.keySeed=A2;},getWidgetId:function H(A2,A3){return I.call(this,A2,A3||this.getCurrentLayoutKey());},getUIState:function S(){return{};},ondefnChange:function u(){var A7=this.defn,A4=A7&&A7.layouts,A3={};if(A7){A7.layoutMap=A3;var A6=(A4&&A4.length)||0,A5;for(A5=0;A5<A6;A5++){var A2=A4[A5];A3[A2.k]=A2;}}},extractChildren:function v(A2){return(A2.sections||A2.subsections||A2.objects||A2.panels||A2.layouts||A2.children);},getChildren:function O(A4,A3,A7,A2,A6){A7=A7||0;var A5=function(A8){return A8.slice(A7,A7+(A2||A8.length));};return AM.call(this,A4,A5,A3,A6);},getChildrenByKey:function AL(A4,A3,A2,A6){var A5=function(A8){var A7=[],A9;M.forEach(A2,function(BA){A9=M.find(A8,"k",BA);if(A9!==-1){A7.push(A8[A9]);}});return A7;};return AM.call(this,A4,A5,A3,A6);},getTargetDefn:function AK(A2){return Ay.call(this,A2);},getUnitDefinitions:function(A3,A2){return Ay.call(this,A3,A2);},getUnitInstance:function q(A2,A3){return mstrmojo.all[I.call(this,{k:A2,wid:A3},this.currlaykey)];},getFirstUnitInstanceByName:function w(A5){var A2=f.call(this,this.defn,this.currlaykey);if(A2){var A3=A2.units,A4;for(A4 in A3){var A6=A3[A4];if(A6.n===A5){return this.getUnitInstance(A4,1);}}}return null;},getLayoutUnitDefn:function B(A3,A2){return z.call(this,this.defn,A2||this.currlaykey,A3);},getRawLayoutUnitDefn:function U(A3,A4,A2){return z.call(this,A4||this.defn,A2||this.currlaykey,A3,true);},getSelectedKey:function An(A2){return(!A2&&this.currlaykey)||null;},getCurrentLayoutKey:function p(){return this.currlaykey;},getLayoutDefn:function AT(A2){var A3=this.defn,A4=A3&&A3.layouts;return A4&&A4[M.find(A4,"k",A2)];},getCurrentLayoutDef:function AW(){return this.getLayoutDefn(this.getCurrentLayoutKey());},replaceLayout:function Au(BA,A3,BB){var A7=this.defn,A6=this.data,A4=A3&&A3.defn,A2=A3&&A3.data,BC=this.dataCache;if(BC&&BC[BA]){BC[BA]={};}var A9=(A6&&A6.layouts)||(A7&&A7.layouts),A5,A8=false;for(A5=(A9&&A9.length-1)||0;A5>=0;A5--){if(A9[A5].k===BA){break;}}if(BB&&A5<0){A5=M.find(A2.layouts||A4.layouts,"k",BA);A8=true;}this.bs=A3.bs;if(A2){if(A8){M.insert(A6.layouts,A5,[A2.layouts[A5]]);}else{A6.layouts[A5]=A2.layouts[A5];}A6.elems=A2.elems;}if(A4){if(A8){M.insert(A7.layouts,A5,[A4.layouts[A5]]);}else{A7.layouts[A5]=A4.layouts[A5];}this.ondefnChange();}},loadLayout:function Z(A2,A4,A3){this.replaceLayout(A2.currlaykey,A2);this.raiseEvent({name:"rebuildLayout",unloadCache:!!A4,restoreIW:!!A3});},getLayoutDataNode:function A0(A3){var A2=this.data&&this.data.layouts;return M.filterOne(A2,function(A4){return A4.k===A3;});},getLayoutDataCache:function m(A3){if(!A3){return null;}var A2=this.dataCache;if(!A2){A2=this.dataCache={};}if(!A2[A3]){A2[A3]={};}return A2[A3];},saveRW:function Al(A3,A5){var A4=mstrmojo.desc,A2=this.getDataService();A2.saveRW({objName:A3||this.n,folderID:this.pfid,saveAsFlags:1},A5||{success:function(A6){mstrmojo.alert(A4(3819,"Document Saved")+": "+A6.n);}});},saveAsRW:function A1(A4,A3){var A2=this,A5=mstrmojo.hash.copy(A4,{evt:3102,applyChanges:false,executionMode:2,parentFolderID:mstrApp.saveFolderId||A2.sfid||A2.pfid,saveFromDesignMode:false,rwb:A2.bs});if(A3){A5.target=A3;A5.saveAsOrigin=13;}mstrmojo.form.send(A5,null,"post");},saveDocProps:function AE(A2,A3,A4,A8){var A7=this.getDataService(),A6=A4?null:mstrmojo.DocDataService.SUPPRESS_DATA,A5=[{act:"setDocumentProperties",props:A2}];R.forEach(A2.RWDocumentProperties,function(BA,A9,BB){BB[A9]=String(BA);});if(A3){this.controller.cmdMgr.execute({execute:function(){this.submit(A5,A8||{},A6);},urInfo:A3});}else{A7.submitUpdates(A5,A8||{},R.copy(A6,{preserveUndo:true}));}},partialUpdate:function AA(A7,A2,A5,A4,A3){if(A5){this.updateDefnCache(A5,A4,A3);}if(A7){var A6=this.updateDataCache(A7,A2,undefined,A3);this.raiseEvent({name:"partialUpdate",tree:A7,ids:A6});return A6;}},refreshDefinition:function Y(A5,A4,A3,A6){var A2=this.getLayoutUnitDefn(A5,A3||this.getCurrentLayoutKey());if(!A2){return ;}Ak(A2.t).update(this,A2,A4,A6);},loadPartialData:function x(A7,A3){var A5={};A5[A3]=z.call(this,this.defn,this.currlaykey,A3);var A4=this.updateDataCache(A7,A5),A2=this.getLayoutDataCache(this.getCurrentLayoutKey()),A6=this;M.forEach(A7.layouts,function(A8){var A9=A8&&A8.xtabStyles;if(A9){A6.raiseEvent({name:"updateStyles",key:A8.k,updatedStyles:A9});}});Av(A4,function(A9,A8){if(A8==="upd"){Av(A9,function(BB,BC){var BA=mstrmojo.all[BC];if(BA&&BA.update){BA.update(A2[BC]);}});}});},updateDefnCache:function A(A3,A9,A6){var BC=this.currlaykey,A5=f.call(this,A3,BC),BE=f.call(this,this.defn,BC),BA=function(BF,BG){var BH;for(BH in BG){if(BF[BH]===undefined){BF[BH]=BG[BH];}}},BD=A5&&A5.units,BB=BE&&BE.units,A4=A5&&A5.cgbMap,A2=BE&&BE.cgbMap,A7=A6&&a(A6).defn,A8=this;M.forEach(A9,function(BF){A8.refreshDefinition(BF,BD[BF],null,A7&&A7[BF]);});if(BD){BA(BB,BD);}if(A4){BA(A2,A4);this.raiseEvent({name:"CGBMapChange",cgbMap:A2});}},deleteDataCache:function P(A3){var A2=this.getLayoutDataCache(this.getCurrentLayoutKey());if(A2[A3]){delete A2[A3];}},updateDataCache:function AS(BB,BA,A2,A6){var A4=this.getLayoutDataCache(this.getCurrentLayoutKey()),A3=A6&&a(A6).data,BC={ifws:{},upd:{},tgts:{},def:{},secs:{}},A7=function(BI,BD){var BH=A4[BI];if(A3){var BG=mstrmojo.all[BI];if(BG){var BE=BH.k,BF=A3[BE];if(BF){if(!R.isEmpty(BF.exclude)){R.copy(BD.data,BH.data);}else{BD.data=R.copyProps(BF.serialized.split(";"),BD.data,BH.data);}}}}W(BD,A4);};function A9(BR,BW,BE,BH){var BJ=false,BO=this.getChildren(BR,true),BN;if(!BO.length){return ;}if(BE){BN=mstrmojo.all[BR.id];BJ=!BR.id||!!BN;}var BI=BR.defn,BF=BR.data,BT;if(BI&&BI.t===Ai.PANELSTACK&&BI.od){BT=BF.selKey;}var BS,BM,BX=function(BY){return(BY.k===BM);};for(BS in BO){var BP=BO[BS],BQ=BP.id,BG=null,BU;BM=BP.k;if(BW){var BK=this.extractChildren(BW);if(BK){BU=M.filterOne(BK,BX);if(!BU){BK.push(R.clone(BP.data));}}else{R.copy(R.clone(BR.data),BW);}}if(mstrmojo.all[BQ]){BJ=true;}if(BA.hasOwnProperty(BM)){if(Ae.call(this,BM)&&Ag(BP.data,A2)){A7(BQ,BP);if(!BH){BC.ifws[BM]=this.infoWinByKey[BM].id;}}BG=BM;if(BJ){if(BT&&BT!==BM){continue;}if(!BH){BC.tgts[BQ]=true;}var BD=BN&&BN.defn,BV=BD&&BD.t,BL=BD&&BD.ck;if(BV===Ai.SUBSECTION&&(BL&&BL.hasOwnProperty(BM))){BC.secs[BN.id]=true;}}}if((BH||BG)&&(!BT||BT===BM)){A7(BQ,BP);BC.def[BM]=true;if(BJ){BC.upd[BQ]=true;}}A9.call(this,BP,BU,BJ,BH||BG);}}if(BB&&BB.layouts&&BA){var A5=M.filterOne(BB.layouts,function(BD){return(BD.loaded);}),A8=this.data.layouts;if(A5){A9.call(this,A5,A8[M.find(A8,"k",A5.k)],true);}}return BC;},getDimensionAndPositionAction:function Q(A3,A2,A5){var A4=this.getUnitFormatAction(A3,null,null,A5);Az.call(this,A4.format,A2,3);return A4;},getDimensionAction:function Q(A3,A2,A5){var A4=this.getUnitFormatAction(A3,null,null,A5);Az.call(this,A4.format,A2,2);return A4;},getUnitFormatAction:function d(BA,A3,A9,A5){var A7=BA.defn,BB=A7.t||1,A8=BA.k,A6=[A8];var A2={act:"format",unitKey:A8,unitType:BB===115?521:BB,formatType:A3||1,format:A9||{}};if(!A5){A2.partialRetrieval={nodes:A6};}if(BB===Ai.SELECTOR){var BC=A7.ck;A2.keyContext=BC;A6[0]=this.getDataService().getNodeKeyFromKeyContext(BC);}if(BB===Ai.TEXTFIELD||BB===Ai.IMAGE||BB===Ai.HTMLCONTAINER){var A4=BA.nk||A7.fgk;A2.fieldKey=A8;A2.nodeKey=A4;A2.keyContext=BB+b+A4+b+A8;A6[0]=A4;}return A2;},updateUnitFormat:function Ah(A3,A5,A6,A7,A2){var A4=this.getUnitFormatAction(A3,A5,A6);this.getDataService().submitUpdates(A4,A7,A2);},selectPanelDeferred:function(A7,A6,A5,A4,A3,A2){e.call(this,A7,{type:3,tks:A6,eid:A5,sid:A4||1,ck:A6,hasLoader:A3,skipServerCall:A2});},getSearchElemsCache:function Aq(){var A2=this.searchElemsCache;if(!A2){A2=this.searchElemsCache={};}return A2;},getCGBMap:function AY(){var A2=f.call(this,this.defn,this.currlaykey);return A2&&A2.cgbMap;},getSliceCallback:function AD(A2){var A5=this,A6={};A6.dataCacheUpdate=null;A6.tgtDefs=A2.tks?Ay.call(this,A2.tks):null;A6.orignalTargetDefs=A6.tgtDefs;var A4=A6.tgtDefs,A3=function(A9){var BA=A4;if(A2.disablePU){BA=Ay.call(A5,A5.currlaykey);}Av(BA,function(BB){if(BB&&BB.set){BB.set("readyState",A9);}});},A8=this.newCallback({method:"slice",shared:A6,submission:function(){A3(K.WAITING);},success:function(BA){if(!A5.checkStatus(BA)){return ;}if(A2.disablePU){A5.loadLayout(BA,A2.isUConDS,A2.restoreIW);return ;}if(BA.pukeys){A6.tgtDefs=Ay.call(A5,BA.pukeys);}A6.dataCacheUpdate=A5.updateDataCache(BA.data,A6.tgtDefs,A2&&A2.sid,BA.puFilters);if(typeof BA==="object"){R.copyProps(["bs","exopt","dty"],BA,A5);}var A9={name:"partialUpdate",tree:BA.data,ids:A6.dataCacheUpdate,unloadCache:A2.isUConDS};if(!mstrmojo.hash.isEmpty(A9.ids.ifws)){if(A2&&!A2.suppressIW&&(A2.type===Ai.GRID||A2.type===Ai.GRAPH)){A9.anchor=A2.anchor;}else{A9.ids.ifws={};}}A5.raiseEvent(A9);},complete:function(){A3(K.IDLE);}}),A7={success:function(){Av(A6.orignalTargetDefs,function(BJ,BH){var BI=o.call(A5,BH,1);if(!BI){if(!!A5.sdp&&!!A5.sdp[BH]){var BG=A5.getLayoutDataCache(A5.getCurrentLayoutKey());var BK=I.call(A5,{k:BH,wid:1},A5.currlaykey);A5.raiseEvent({name:"secondaryDataSliced",key:BH,data:BG[BK].data});}return ;}if(A6.dataCacheUpdate&&!A6.dataCacheUpdate.def.hasOwnProperty(BH)){if(BI.setDirty){BI.setDirty(true);}}else{if(parseInt(BJ.t,10)===Ai.PANELSTACK){BI.setDirtyChildren();}}});var A9=o.call(A5,A2.ctlKey,1);if(A9&&A6.dataCacheUpdate&&!A6.dataCacheUpdate.upd.hasOwnProperty(A9.id)){var BE=(A9.children&&A9.children[0].selectedIndices)||{},BC=A9.node.data,BF=mstrmojo.DocSelector.STYLES,BD=[];if(A9.style===BF.SEARCH_BOX){var BA=(A9.children&&A9.children[0].items)||[];M.forEach(BA,function(BG){BD.push(R.clone(BG));});}else{R.forEach(BE,function(BH,BG){if(BH){BD.push(BC.elms[BG]);}});}var BB=M.find(BD,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(BB>-1){BD=[BD[BB]];}BC.ces=BD;A9.selIdx=BE;}}};if(A2.isUConDS||(parseInt(A2.type,10)===Ai.GRAPH&&A2.tty===1)){A8.success=function(A9){A5.controller.setData(A9,true);};return A8;}if((parseInt(A2.type,10)===3)){return A8;}return At(A8,A7);},slice:function X(A2){var A3=this.getDataService(),A4=A3.newUpdateWithoutCmd();this.sliceDeferred(A4,A2);if(A4.actions&&A4.actions.length>0){A3.addSuppressData(A4.extras);A4.submit();}},sliceDeferred:function(A5,BE){var A2={};try{if(!BE||(!mstrmojo.dom.isAndroid&&!BE.tks&&!BE.multiSelect&&(BE.type===3||(BE.type===Ai.GRAPH&&parseInt(BE.tty,10)!==1)))){return A2;}var BF=this.getSliceCallback(BE),BB=this,BD=this.getDataService();var BH=parseInt(BE.type,10);if(BH===3){e.call(BB,A5,BE);return ;}if(BE.multiSelect){if(BE.selectorObjects.length>0){BD.setMultiDocSelectorElements(BE.selectorObjects,BE.multiSelect,BF);}return ;}if(BH===Ai.GRAPH){A5.add(BD.getGraphSelectionAction(BE.src,BE.cks,BE.sid,BE.x,BE.y,(BE.tty===1)),BF);if(!!BE.showLoadingIcon){A5.addExtras({config:mstrmojo.DocDataService.PROGRESS_CONFIG});}return ;}var BG=BE.events||{K0:BE},A4=[],A7,A3={config:mstrmojo.DocDataService.PROGRESS_CONFIG},BA=A3.params={},A6,A9={},BC=function(BJ,BI){if(BJ){A9[BI]=BJ.visName;}};for(A6 in BG){BE=BG[A6];if(!BE){break;}if(BE.hasOwnProperty("eid")){if(BE.isUConDS){BE.disablePU=true;}if(AC.call(this)){BE.disablePU=true;BE.restoreIW=true;}A7=BD.getSelectorElementsAction(BE);if(BB.sdp){A9={};Av(BB.sdp,BC);BA.sdpKeys=JSON.stringify(A9);}if(BE.disablePU){BA.disablePU=true;}}else{if(BE.fromGM){A7=BD.getSelectorFromGMAction(BE);}else{if(parseInt(BE.srct,10)===4||BE.fid){if(BE.fid&&AC.call(this)){BE.disablePU=true;}A7=BD.getSelectorExpressionAction(BE);}else{if(BE.unset){A7=BD.getUnsetSelectorAction(BE);}else{if(parseInt(BE.ct,10)===6){A7=BD.getMultiUnitSelectorAction(BE);BB.hasUnitSelector=BE.selections&&BE.selections.hasElements;}else{A7=BD.getSelectorIncludeAction(BE);}}}}}A4.push(A7);}A5.add(A4,BF,A3);}catch(A8){mstrmojo.err(A8);}},getInfoWindow:function r(A3){var A2=this.infoWindows;return A2&&A2[A3];},getTargetInfoWin:function(A3){var A2=[],A4=Ay.call(this,A3);if(A4){var A5;for(A5 in A4){if(A4[A5]&&A4[A5].ifw){A2.push(A5);}}}return A2;},showInfoWin:function n(A5,A4,A2,A6,A7){var A3=this.infoWinByKey&&this.infoWinByKey[A5];if(A3===undefined){return ;}this.raiseEvent({name:"showInfoWin",psId:A3.id,psKey:A3.k,anchor:A4,anchorOrientation:A2,anchorPosition:A7,invalidate:A6});},getSelectedXtabStyles:function k(A4){var A3=A4||this.currlaykey;var A6={};var A2=this.data&&this.data.layouts,A5;for(A5 in A2){if(A2[A5].k===A3){A6=A2[A5].xtabStyles;break;}}return A6;},downloadGridData:function E(A6){var A4=this,A3=A6.xtabId,A2=A6.memo,A5=mstrmojo.all[A3];this.getDataService().downloadGridData(A6,this.newCallback({success:function(BE){function A7(BI,BK){var BL=A4.getChildren(BI,true),BJ=BL.length,BH;for(BH=0;BH<BJ;BH++){var BM=BL[BH];if(BK===BM.id){return BM;}var BG=A7(BM,BK);if(BG){return BG;}}return null;}var BB=BE.data&&f.call(A4,BE.data,A4.currlaykey);if(BB){var BA=A7(BB,A3);if(BA){mstrmojo.models.template.DataInterface.inflateGridData(BA.data);if(A5){A5.dataDownloaded(BA,A2);}}var BD=BB.xtabStyles;if(BD){A4.raiseEvent({name:"updateStyles",key:BB.k,updatedStyles:BD});}}var BC=z.call(A4,A4.defn,A4.currlaykey,A6.nodeKey);if(BC&&BC.t===Ai.GRIDGRAPH&&A2.recalculating){var A9=A5.parent,BF=A9&&A9.getGraphWidget();if(BF&&A9.updateGraph){A9.updateGraph(A7(BB,BF.id));}}if(BE.pukeys){var A8=Ay.call(A4,BE.pukeys);delete A8[A6.nodeKey];if(!R.isEmpty(A8)){A4.partialUpdate(BE.data,A8);}}},failure:A5.dataDownloadErr||mstrmojo.emptyFn}));},clearDisposables:function AX(){var A2=[];M.forEach(this.disposables,function(A3){if(A3._lkz){Ar(A3);}else{A2.push(A3);}});this.disposables=A2;},getFixedHeaders:function(A3,A2){return AP.call(this,A3,A2,[Ai.PAGEHEADER],true);},getFixedFooters:function(A3,A2){return AP.call(this,A3,A2,[Ai.PAGEFOOTER],true);},getNonFixedSections:function(A3,A2){return AP.call(this,A3,A2,[Ai.PAGEHEADER,Ai.PAGEFOOTER],false);},addAutoWidthID:function g(A4){var A3=this.aws||{},A2=A3[this.currlaykey]||[];A2.push(A4);A3[this.currlaykey]=A2;this.aws=A3;},getAutoWidthIDs:function L(){var A4=this.aws,A2=this.currlaykey;var A3=A4&&A4[A2];if(A3){delete A4[A2];}return A3;},getTransactionUpdates:function j(A2){return this.txDiscardTargets?"":AF.call(this,A2);},clearTransactionUpdates:function AH(A2){this.clearTxDeltaUpdate(A2);},resetTransactionUpdates:function Ac(A2){var A3=this.pendingUpdate,A4=this.delta;if(A3&&A3[A2]){Av(A3[A2],function(A5,A6){if(A4&&!A4[A6]){A4[A6]=A5;}});delete A3[A2];}},transactionUpdate:function Ap(A4,A3){if(!A4.data){return null;}var A6;if(A3&&A3.tks){A6=Ay.call(this,A3.tks);}if(A4.pukeys){A6=Ay.call(this,A4.pukeys);var A7;for(A7 in A6){if(A6[A7]&&A6[A7].cek){A6[A7].cek=null;}}}if(A4.txrcd){this.txrcd=A4.txrcd;}else{delete this.txrcd;}var A5=this.updateDataCache(A4.data,A6,A3&&A3.sid),A2={name:"partialUpdate",tree:A4.data,ids:A5};if(!R.isEmpty(A5.ifws)){if(A3&&A3.type===Ai.GRID){A2.anchor=A3.anchor;}else{A5.ifws={};}}this.raiseEvent(A2);return A5;},deltaUpdate:function Aa(A2){var A3=this.delta;if(!A3){A3=this.delta={};}A3[A2.id]=A2;},clearTxDeltaUpdate:function V(A3){var A6=this.txDiscardTargets,A2=!A6,A5=this.pendingUpdate,A4=this;if(!A2){Av(A6,function(A7,A8){if(A4.delta&&A4.delta[A8]){A4.delta[A8].clear();delete A4.delta[A8];}});}if(A5&&A5[A3]){Av(A5[A3],function(A7){A7.clear();});delete this.pendingUpdate[A3];}},sendTransactionActions:function G(A3,A2,A5){var A4=this;if(!A5){A5={success:function(A6){A4.transactionUpdate(A6);}};}A4.getDataService().sendTransactionActions({keyContext:A3,actions:A2,txrcd:this.txrcd},A5);},sendTransactionUpdates:function AV(A2){var A4=this.getSliceCallback(A2),A3=this.getDataService();A3.submitUpdates([A3.getUpdateTransactionAction(A2)],A4);},addSDP:function Am(A3,A2){if(!A3||!A2){return ;}if(!this.sdp){this.sdp={};}this.sdp[A3]={k:A2.k,visName:A2.visName};},removeSDP:function Af(A2){if(!A2||!this.sdp[A2]){return ;}delete this.sdp[A2];},getUpdateColorMapCallback:function c(){var A2=this;return{success:function(A3){A2.defn.epm=A3.defn&&A3.defn.epm;AG.call(A2);A2.raiseEvent({name:"colorMapChanged"});}};},getUpdateThemePaletteCallback:function AZ(A2){var A3=this;return{success:function(A4){A3.thm=A4.thm;A3.plt=A4.plt;A3.defmts=A4.defmts;AG.call(A3,!A2);}};},getCurrentPaletteColors:function AN(){return(this.plt&&this.plt.colors)||N;},getColorBy:function(A8,A2){var A6=A2.map(function(BA,A9){return{levelID:A8[A9].toString(),elemID:BA};});if(A6&&A6.length>1){t(A6);}var A7=J(A6),A5=Ax(A6),A4=T[A7];if(!A4){A4=T[A7]={_currentColorIdx:0};}if(!A4[A5]){var A3=this.getCurrentPaletteColors();A4[A5]=A3[A4._currentColorIdx];A4._currentColorIdx=(A4._currentColorIdx+1)%A3.length;}if(F[A7]&&F[A7][A5]){return{color:F[A7][A5].color,isManual:true};}return{color:A4[A5],isManual:false};},getZoomFactor:function AB(){return this.getCurrentLayoutDef().zf||1;},getZoomProps:function AU(){return{dpi:this.dpi,zf:this.getZoomFactor()};},executeLink:function h(A2,A4,A5){if(A2.indexOf("prevMsgID")>0){var A3="prevMsgID="+this.mid;A2=A2.replace(/prevMsgID=0($|&)/g,function(A6,A7){if(A7==="&"){return(A3+"&");}return A3;});if(mstrmojo.dom.isIE){A2+="&cb"+mstrmojo.now()+"=1";}}A2=mstrmojo.addCSRFTokenToURL(A2);this.controller.onLink(this,{url:A2,target:A4,src:A5||null,submitAsPost:!mstrmojo.isUrlExternal(A2)});},getDatasetUnits:function Ao(A3,A2,A5,A7){var A6=this.datasets,A4=[];R.keyarray(A6).forEach(function(A9){if(!A5||A9===A5){var BA=A6[A9],A8=BA,BB=[];A3.forEach(function(BC){if(A7!==undefined){A8=BA.tables[A7];}(A8[BC]||[]).forEach(function(BD){if(!A2||A2(BD)){BB.push(BD);}});});A4=A4.concat(BB.map(function(BC){return mstrmojo.hash.copyProps(["did","n","t","st","formType","dt","f","hide","usedInDropZones","card","lock","fs"],BC,{ds:BA.name,dsId:A9,dm:!!BC.um,da:!!BC.da,de:!!BC.de});}));}});return A4;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Model","mstrmojo._HasPopup","mstrmojo.string");var D=mstrmojo.dom,B=mstrmojo.string;var L=1,C=2,J=4,T=8,S=16,K=512;function N(Z,V){var Y=Z.getCellForNode(V),U=Y&&Y.at,X=0;if(U){X=(U&C)||(U&J)||(U&L);}if(X===J){var c=Z.model.getCellLinksInfo(Y);if(!c||isNaN(c.di)){return"";}var b=c.links[c.di];return b.n;}if(X===L){var a=Z.model.getCellDrillsInfo(Y);return a&&(mstrmojo.desc(183,"Drill to")+" "+a.n)||"";}if(Y){var W=("mix" in Y)?Y._e:Y;if(W&&W.desc){return B.decodeHtmlString(W.desc);}}return Z.tooltip||"";}function I(Z,b){var W=Z.getCellForNode(b),V=W&&W.at;if((V&T)>0||(V&S)>0||(V&K)>0){return true;}var a=0;if((V&L)>0){return true;}if((V&J)>0){a++;}if((V&C)>0){a++;}if(a>1){return true;}if((V&J)>0){var Y=Z.model.getCellLinksInfo(W),X=Y&&Y.links;var U=(X&&X.length)||0;if(Y&&!isNaN(Y.di)){U--;}if(U>0){return true;}}return false;}function H(U){return U.viewport.clientWidth-(U.scrollboxNode.offsetWidth-U.scrollboxNode.clientWidth);}mstrmojo._XtabCellHoverMgr=mstrmojo.declare(mstrmojo.Model,null,{scriptClass:"mstrmojo._XtabCellHoverMgr",parent:null,td:null,audibles:{"*":false},startup:function E(){var V=this.parent;if(V&&V.getCellForNode){var U=V.zones,W;for(W in U){this.addMgrElement(W);}if(!this._sub_ihc){this._sub_ihc=V.attachEventListener("ignoreHoverChange",this.id,"onChangeIgnoreHover");}window.setTimeout(function(){V._pl=H(V);},0);}},addMgrElement:function P(W){var Z=this.parent,Y=this,a=Z&&Z.zones[W].tableNode;if(a&&Z&&Z.getCellForNode){if(!this.fCtxMenu){this.fCtxMenu=function(b){Y.oncontextmenu(b,self);};}if(!this.fOver){this.fOver=function(b){Y.onhover(b,self);};}if(!this.fOut){this.fOut=function(b){Y.onunhover(b,self);};}var X=this.fCtxMenu,V=this.fOver,U=this.fOut;D.attachEvent(a,"mouseover",V);D.attachEvent(a,"mouseout",U);D.attachEvent(a,"contextmenu",X);}},shutdown:function A(){var V=this.parent&&this.parent.zones,W;for(W in V){var U=V[W].tableNode;if(U){D.detachEvent(U,"mouseover",this.fOver);D.detachEvent(U,"mouseout",this.fOut);D.detachEvent(U,"contextmenu",this.fCtxMenu);}}},onXtabWidthChanged:function(){var U=this.parent;U._pl=H(U);},onChangeIgnoreHover:function(){var U=this.parent;if(!U.ignoreHover&&this._ignored){this.onhover(null,null,this._ignored);}},onhover:function F(X,U,W){if(this.parent.ignoreHover){this._ignored=D.eventTarget(U,X);return ;}var V=this.parent,Y=this.getEvtTargetCell(X,U,V,W);if(Y&&V){Y.title=N(V,Y);}if(this.showHvrBtn(V,Y)){this.td=Y;if(!V._pl){V._pl=H(V);}V.openPopup("cellHoverPopupRef",{xtab:V,td:Y});}else{this.onunhover(X,U,W);}},onunhover:function M(){if(this.parent.ignoreHover){return ;}var V=this.parent,U=V._lastOpened;if(!U){return ;}if(U.autoCloses){U.autoClose();}else{V.closePopup();}},getEvtTargetCell:function G(Y,U,X,W){var V=W||D.eventTarget(U,Y);return V&&D.findAncestorByName(V,"td",true,X.viewport);},oncontextmenu:function O(X,U,W){var V=this.parent,Y=this.getEvtTargetCell(X,U,V,W);this.processRightClick(X,U,Y);if(Y&&this.shouldShowPopup(V,Y,true)){V.openPopup("cellHoverPopupRef",{xtab:V,td:Y,cmPos:D.getMousePosition(X,U)});V.cellHoverPopupRef.btn.openPopup();V.closePopup();D.preventDefault(U,X);D.stopPropogation(U,X);}},processRightClick:mstrmojo.emptyFn,shouldShowPopup:function R(W,X,V){var U=X.mstrShowPopup;if(U!==undefined){return U;}U=I(W,X);X.mstrShowPopup=U;return U;},showHvrBtn:function Q(U,V){return this.shouldShowPopup(U,V,false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TouchScroller","mstrmojo.hash");var H=mstrmojo.hash;mstrmojo._HasTouchScroller=mstrmojo.provide("mstrmojo._HasTouchScroller",{_meta_usesSuper:true,scrollerConfig:{},allowTouchBubble:true,scrollerSetupDelay:undefined,init:function M(S){this._super(S);this.scrollerConfig=H.clone(this.scrollerConfig);},updateScrollerConfig:function P(){return this.scrollerConfig;},updateScroller:function F(V,W){var S=this._scroller;if(S){var T=this.updateScrollerConfig();S.initScroller(T);if(!V){var U=T.origin;if(U){S.scrollTo(U.x,U.y,W);}}S.updateScrollBars();}},initScroller:mstrmojo.emptyFn,useSelectScroll:false,postBuildRendering:function Q(){var S=this._scroller;if(!S){S=this._scroller=new mstrmojo.TouchScroller();this.initScroller(S);}else{S.haltScroller();}if(!this.layoutConfig){var U=this.id,T=this.scrollerSetupDelay;if(!isNaN(T)){window.setTimeout(function(){mstrmojo.all[U].updateScroller();},T);}else{this.updateScroller();}}this._super();},afterLayout:function G(){this._super();this.updateScroller();},getScrollPos:function A(){return H.copy(this._scroller.origin||{x:0,y:0});},shouldTouchBubble:function I(V){if(!this.allowTouchBubble){return false;}var S=this._scroller,U=V.isVertical,T=U?"y":"x";return(!S[(U?"v":"h")+"Scroll"]||S.offset[T][V.direction[T]?"end":"start"]===S.origin[T]);},touchBegin:function L(S){this._scroller.haltScroller();return(this._super&&this._super(S))||true;},touchSwipeBegin:function J(S){if(this.shouldTouchBubble(S)){if(this.bubbleTouchEvent(S)===false){this._touchCanceled=true;}return ;}if(this._super){this._super(S);}this._scroller.toggleScrollBars(true);},touchSelectBegin:function B(S){if(this._super){this._super(S);}if(this.useSelectScroll){this.touchSwipeBegin(S);}},touchSwipeMove:function C(S){if(!this._touchCanceled){if(this._super){this._super(S);}}this._scroller.scroll(S);},touchSelectMove:function E(S){if(!this._touchCanceled){if(this._super){this._super(S);}}if(this.useSelectScroll){this.touchSwipeMove(S);}},touchSwipeEnd:function N(S){S.evt.handled=true;if(!this._touchCanceled){if(this._super){this._super(S);}}this._scroller.scrollEnd(S);},touchSelectEnd:function K(S){if(this._touchCanceled){return ;}if(this._super){this._super(S);}if(this.useSelectScroll){this.touchSwipeEnd(S);}},touchEnd:function D(S){if(this._touchCanceled){delete this._touchCanceled;return ;}if(this._super){this._super(S);}},unrender:function O(T){var S=this._scroller;if(S){S.unrender();}delete this.scrollerConfig.scrollEl;this._super(T);},destroy:function R(){if(this._scroller){this._scroller.destroy();delete this._scroller;}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");var C=1;mstrmojo._hasWidgetListMapper={buildItemWrappers:function A(H,G,F,E,J,I){E.first=J;E.last=I;return this._super(H,G,F,E,0,0);},postBuildRendering:function B(K,I,H,G,F){var J=F.first;if(J){this.fillItemWrappers(K,I,H,G,F,0,J);}if(F.last){var E=I&&I.length||0,L=Math.max(Math.max(0,E-F.last),J);this.fillItemWrappers(K,I,H,G,F,L,E);}if(this._super){this._super(K,I,H,G,F);}},fillItemWrappers:function D(F,N,K,R,M,E,I,Q){var L=(N&&N.length)||0,P=this.wrapperNodes(F),S=M.itemStatus;for(var J=E,O=Math.min(I+1,L),H=0;J<O;J++){if(S[J]!==C){var G=K.build(R,M,N[J],J);if(G){G.placeholder=P[J].firstChild;G.render();}H++;if(H===Q){break;}}}return H;},onchange:null};mstrmojo.WidgetListMapper=mstrmojo.provide("mstrmojo.WidgetListMapper",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.WidgetListMapper.RENDERED=C;mstrmojo.requiresCls("mstrmojo.ListMapperHoriz");mstrmojo.WidgetListMapperHoriz=mstrmojo.provide("mstrmojo.WidgetListMapperHoriz",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperHoriz)));})();(function(){mstrmojo.requiresCls("mstrmojo.ListMapper");mstrmojo.ListMapperTable=mstrmojo.provide("mstrmojo.ListMapperTable",mstrmojo.hash.copy({markupPrefix:'<table class="mstrmojo-itemwrap-table">',markupSuffix:"</table>",itemWrapperPrefix:function(E){return'<tbody class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"<tr><td>&nbsp;</td></tr>",itemWrapperSuffix:"</tbody>",wrapperNodes:function D(E){return this.wrapperParentNode(E).tBodies;},wrapperParentNode:function C(E){return E.getElementsByTagName("table")[0];},createWrapperNode:function B(E){var F=E.ownerDocument,G=F.createElement("tbody");return G;},findIndex:function A(G,J,I){if(J&&I){var F=G.domNode,E=this.wrapperParentNode(J),H=I.parentNode;while(H){if(H===E){return mstrmojo.array.findBin(this.wrapperNodes(J),I,"offsetTop",G.items&&G.items.length);}else{if(H===F){break;}}I=H;H=I.parentNode;}}return -1;}},mstrmojo.hash.copy(mstrmojo.ListMapper)));mstrmojo.requiresCls("mstrmojo.WidgetListMapper");mstrmojo.WidgetListMapperTable=mstrmojo.provide("mstrmojo.WidgetListMapperTable",mstrmojo.mixin(mstrmojo._hasWidgetListMapper,mstrmojo.hash.copy(mstrmojo.ListMapperTable)));})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.dom","mstrmojo._IsPopup","mstrmojo._CanAutoClose");var C=mstrmojo.dom;mstrmojo.ui.PopupWidget=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.PopupWidget",markupString:'<div id="{@id}" class="mstrmojo-ui-PopupWidget {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="pw-content"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},autoCloses:true,locksHover:true,closeOnClick:true,visible:true,onclick:function B(D){C.stopPropogation(null,D.e);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.Container","mstrmojo._IsPopup","mstrmojo.boxmodel","mstrmojo.dom","mstrmojo.ui._HasScroller");var L=mstrmojo.boxmodel,I=mstrmojo.dom,M=mstrmojo.css,O="mstrmojo-Tooltip",A="mstrmojo-scrollNode",E=20;function C(S,T,R){var U="connectScrollbox";if(R){U="dis"+U;}var Q=S&&S.parent;while(Q){if(Q[U]){Q[U](T);}Q=Q.parent;}}function G(){if(!this._paintHandle){var R=this.id,Q=function(V){var Z=mstrmojo.all[R];if(!Z){return ;}delete Z._paintHandle;var T=[O],a=Z.cssClass;if(a){T.push(a);}var S=mstrApp.getThemeClassName&&mstrApp.getThemeClassName(),X=Z.opener;if(X&&X.getTooltipThemeClass){S=X.getTooltipThemeClass();}T.push(S);Z.domNode.className=T.join(" ");var Y=Z.content,U=Z.contentNode,W=Z.arrowNode;U.className=(O+"-content "+A+" "+Z.contentNodeCssClass);U.style.cssText=Z.contentNodeCssText;U.innerHTML=Y;W.style.cssText="";Z.domNode.style.visibility=!!Y?"visible":"hidden";Z.updatePosition();if(!V&&Z.optimizePos){Z.optimizePos();}Z.updateScrollbars();};if(!this._hasPaint){Q(true);this._hasPaint=true;}else{this._paintHandle=window.setTimeout(Q,0);}}}function B(h,c,a,Y){var T=c&&(c.richTooltip||c.tooltip),f=a?I.getMousePosition(a,Y||self):null,Q=T&&(typeof T==="string");var U="",g="",d="",Z=T,X=null,W=mstrmojo.tooltip.POS_TOPLEFT,S=null,b=null;var V=false,R=false;if(T&&!Q){g=T.cssClass||g;U=T.contentNodeCssClass||U;d=T.contentNodeCssText||d;Z=T.content||"";X=T.refNode||X;W=T.posType||W;S=T.left||0;b=T.top||0;V=T.keepArrowXPos||V;R=T.keepArrowYPos||R;}h.set("contentNodeCssClass",U);h.set("cssClass",g);h.set("contentNodeCssText",d);h.set("content",Z);h.set("refNode",X);h.set("posType",W);h.set("left",Q?((f&&f.x)||h.left):S);h.set("top",(Q||!T)?((f&&(f.y+E))||h.top):b);h.set("keepArrowXPos",V);h.set("keepArrowYPos",R);}mstrmojo.Tooltip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.Tooltip",content:null,top:null,left:null,refNode:null,keepArrowXPos:false,keepArrowYPos:false,posType:"TL",markupString:'<div id="{@id}" class="'+O+' {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout><div class="'+O+'-shadow {@shadowNodeCssClass}"></div><div class="'+O+'-contentWrapper"><div class="'+O+"-content "+A+' {@contentNodeCssClass}" style="{@contentNodeCssText}"></div></div><div class="'+O+'-arrow"></div></div>',markupSlots:{containerNode:function(){return this.domNode.children[1];},contentNode:function(){return this.domNode.children[1].firstChild;},shadowNode:function(){return this.domNode.firstChild;},arrowNode:function(){return this.domNode.children[2];}},setupScrollNodes:function D(){this.scrollNode=this.contentNode;this.scrollbarHostNode=this.containerNode;},_previousVisible:false,markupMethods:{onvisibleChange:function(){var R=this.domNode.style,Q=!!this.visible;if(this._previousVisible!==Q){R.visibility="hidden";}R.display=Q?"block":"none";this._previousVisible=Q;if(Q){this.updatePosition();if(this.content){G.call(this);}}},onleftChange:G,ontopChange:G,onrefNodeChange:G,onposTypeChange:G,oncontentNodeCssClassChange:G,oncontentNodeCssTextChange:G,oncontentChange:G,oncssClassChange:G},preBuildRendering:function N(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}return this._super();},updatePosition:function H(V){if(!this.visible&&!V){return ;}var U=this.refNode,T=U?L.offset(U,document.body):{left:I.getHorizontalScroll(),top:I.getVerticalScroll()},l=this.domNode.style,e=this.containerNode,g=e.offsetWidth,Y=e.offsetHeight,R=this.posType,b=R.indexOf("R")>-1,W=R.indexOf("B")>-1,a=this.top!==null?parseInt(this.top,10)+T.top-(W?Y:0):null,S=this.left!==null?parseInt(this.left,10)+T.left-(b?g:((R.indexOf("C")>-1)?Math.floor(g/2):0)):null,j=false,Z=false,c,X,h=I.windowDim(),f=I.getHorizontalScroll()+h.w,Q=I.getVerticalScroll()+h.h,d=this.arrowNode,k=null;if(S!==null){c=Math.min(Math.max(S,0),f-g);l.left=c+"px";j=S!==c;}if(a!==null){X=Math.min(Math.max(a,0),Q-Y);l.top=X+"px";Z=a!==X;}if(j||Z){if((this.keepArrowXPos&&j)||(this.keepArrowYPos&&Z)){k=M.getComputedStyle(d);}if(this.keepArrowXPos&&j){d.style.left=(parseInt(k.left,10)+S-c)+"px";}if(this.keepArrowYPos&&Z){d.style.top=(parseInt(k.top,10)+a-X)+"px";}}M.toggleClass(this.domNode,"offset",j||Z);},_on_tooltip_change:function(Q){B(this,Q&&Q.src);},_set_opener:function(T,S){var R=this.opener,Q=S!==R;if(Q){if(S){C(S,this);}if(R){C(S,this,true);}if(R&&R.detachEventListener){R.detachEventListener(this._richSubs);R.detachEventListener(this._ttpSubs);}if(S&&S.attachEventListener){this._richSubs=S.attachEventListener("richTooltipChange",this.id,"_on_tooltip_change");this._ttpSubs=S.attachEventListener("tooltipChange",this.id,"_on_tooltip_change");}this.opener=S;}return Q;},updatePopupConfig:function(Q,R){B(this,R,Q&&Q.e,Q&&Q.win);},onscroll:function K(){if(this.visible&&this.nudge){this.nudge();}this._super();},onmouseover:mstrmojo.emptyFn,onmouseout:mstrmojo.emptyFn});var J=null;mstrmojo.tooltip={POS_TOPLEFT:"TL",POS_BOTTOMLEFT:"BL",POS_TOPRIGHT:"TR",POS_BOTTOMRIGHT:"BR",POS_BOTTOMCENTER:"BC",POS_TOPCENTER:"TC",open:function F(R,T,S,Q){if(!J||!mstrmojo.all[J.id]){J=new mstrmojo.Tooltip();}Q=Q||{};Q.e=T;Q.win=S;J.open(R,Q);R.tooltip=J;},close:function P(){if(J){if(J.opener){J.opener.tooltip=null;}J.close();}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsPopup","mstrmojo._CanAutoClose");function A(B){return function(){this.domNode.style[B]=this[B]||"";};}mstrmojo.Popup=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.Popup",shadowNodeCssClass:"mstrmojo-popup-shadow",titleNodeCssClass:"mstrmojo-popup-title",contentNodeCssClass:"mstrmojo-popup-content",cssDisplay:"block",markupString:'<div id="{@id}" class="mstrmojo-Popup {@cssClass}" style="{@cssText}"><div class="mstrmojo-Popup-shadow {@shadowNodeCssClass}"></div><div class="mstrmojo-Popup-title {@titleNodeCssClass}">{@title}</div><div class="mstrmojo-Popup-content {@contentNodeCssClass}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onleftChange:A("left"),ontopChange:A("top"),onzIndexChange:A("zIndex")}});}());(function(){mstrmojo.requiresCls("mstrmojo.NumStepperContentProvider","mstrmojo.num","mstrmojo.array");var A=mstrmojo.num,E=mstrmojo.array;var C="?";function B(H,G){var J=G?H.max:H.min,F=G?H.min:H.max,I=H.getValGroup(G?1:-1);return(J===null||(G?(I.every(function(K){return K<=J;})):(I.every(function(K){return K>=J;})))||(F!==null&&H.canLoop));}function D(I,H){var G=I.min,F=I.max,J=I.getValGroup(H?1:-1)||[];if((H&&F!==null&&J.some(function(K){return K>F;})||(!H&&G!==null&&J.some(function(K){return K<G;})))){if(I.canLoop){J.forEach(function(L,K){L=((L-G)%(F-G+1))+G;L=(L>=G)?L:L+(F-G+1);J[K]=L;});}else{return ;}}I.item[I.valField]=I.curValGroup=J;I.onTraverse();}mstrmojo.NumGroupStepperContentProvider=mstrmojo.declare(mstrmojo.NumStepperContentProvider,null,{scriptClass:"mstrmojo.NumGroupStepperContentProvider",curValGroup:null,init:function(F){this._super(F);},_initCurrent:function(){var H=this.item,F=this.curValGroup=H[this.valField];if(F===null||F===undefined){var G=this.min;this.curValGroup=G!==null?[G]:0;}this.curValGroup=E.ensureArray(this.curValGroup);},next:function(){D(this,true);},prev:function(){D(this,false);},hasPrev:function(){return B(this,false);},hasNext:function(){return B(this,true);},getValGroup:function(I){var F=this.curValGroup,G=this.interval,H=[];(F||[]).forEach(function(K,J){H[J]=F[J]+(G*(I||0));});return H;},getVal:function(){var F=null;(this.curValGroup||[]).forEach(function(G){if(F===null){F=G;}else{if(F!==C&&G!==F){F=C;}}});return F;},setVal:function(H){var I=this.min,G=this.max,F=this.curValGroup;if(typeof H!=="number"||isNaN(H)||A.inNumericRange(H,I,G)!==0){return ;}(F||[]).forEach(function(K,J){F[J]=H;});this.onTraverse();},_set_curValGroup:function(J,I){var H=this.min,G=this.max,F=this.getValGroup();if(I.some(function(K){return typeof K!=="number";})||I.some(function(K){return isNaN(K);})||I.every(function(L,K){return L===F[K];})||I.every(function(K){return A.inNumericRange(K,H,G)!==0;})){return false;}this.item[this.valField]=this.curValGroup=I;return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo._HasEditableText","mstrmojo.css");var B=mstrmojo.css;mstrmojo.EditableLabel=mstrmojo.declare(mstrmojo.Label,[mstrmojo._HasEditableText],{scriptClass:"mstrmojo.EditableLabel",autoApplyDelay:-1,markupString:'<div id="{@id}" class="mstrmojo-EditableLabel {@cssClass}" title="{@title}" contenteditable="{@isEditing}" style="{@cssText}" mstrAttach:click,mousedown,blur,keydown,keyup></div>',onkeyup:function C(D){this._super(D);if(this._autoApplyTimer){window.clearTimeout(this._autoApplyTimer);}if(this.autoApplyDelay!==-1){var E=this;this._autoApplyTimer=window.setTimeout(function(){E.set("isEditing",false);},this.autoApplyDelay);}},selectable:true});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.EditableLabel,{onselectableChange:function A(){var E=this[this.editableSlot],D=!!this.selectable;E.selectable=D;E.setAttribute("unselectable",!D?"on":"off");B.toggleClass(E,"unselectable",!D);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.css","mstrmojo.hash");mstrmojo.TristateCheckBox=mstrmojo.declare(mstrmojo.Label,null,{scriptClass:"mstrmojo.TristateCheckBox",grayed:true,checked:true,cssClass:"tristate",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);}else{this.set("checked",!this.checked);}},markupMethods:mstrmojo.hash.copy({oncheckedChange:function(){mstrmojo.css.toggleClass(this.domNode,"checked",this.checked);},ongrayedChange:function(){mstrmojo.css.toggleClass(this.domNode,"grayed",this.grayed);},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},mstrmojo.hash.copy(mstrmojo.Label.prototype.markupMethods))});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasMarkup","mstrmojo.Image");mstrmojo.threshold.ImageBand=mstrmojo.declare(mstrmojo.Image,null,{scriptClass:"mstrmojo.threshold.ImageBand",cssClass:"mstrmojo-Image color-band"});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.threshold.ImageBand,{onwidthChange:mstrmojo.Widget.widthMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.MenuItem=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.MenuItem",markupString:'<div id="{@id}" class="mstrmojo-MenuItem {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-MenuItem-text"></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Button");mstrmojo.HTMLButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.HTMLButton",markupString:'<input id="{@id}" type="button" class="mstrmojo-text mstrmojo-HTMLButton mstrButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" mstrAttach:click />',markupSlots:{inputNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onselectedChange:function(){mstrmojo.css[this.selected?"addClass":"removeClass"](this.domNode,["selected"]);},ontextChange:function(){this.inputNode.value=this.text!=null?this.text:"";},oniconClassChange:function(){this.domNode.className="mstrmojo-text mstrmojo-HTMLButton mstrButton "+this.cssClass+" "+this.iconClass+(this.enabled?"":" disabled");}}});})();(function(){mstrmojo.requiresCls("mstrmojo.EnumRWUnitType","mstrmojo.hash","mstrmojo.Button","mstrmojo.css");var A=mstrmojo.EnumRWUnitType,N=mstrmojo.hash,B={},P=mstrmojo.Button.newWebButton,K=mstrmojo.array;B[A.HEADER]=B[A.FOOTER]=B[A.PAGEHEADER]=B[A.PAGEFOOTER]=B[A.DETAILS]={n:"Section"};B[A.HTMLCONTAINER]={n:"HTMLContainer"};B[A.SELECTOR]={n:"Selector"};B[A.GRID]={n:"Xtab"};B[A.MOJOVISUALIZATION]={n:"MojoVisualization"};function C(W){return(W&&W.t)||mstrmojo.EnumRWUnitType.LAYOUT;}mstrmojo.DocBuilder=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocBuilder",visList:null,selectorFactory:null,classMap:null,init:function R(W){this._super(W);var X=this.selectorFactory=this.createSelectorFactory();this.addDisposable(X);this.classMap=this.createClassMap();},createSelectorFactory:function V(){this.throwAbstractMethodError("getSelectorFactory");},createClassMap:function E(){return N.copy(B);},getMojoVisName:function S(Z){var a="",Y=Z.data,W=C(Z.defn),X=Y&&Y.vis;if(X&&(W===A.GRID||W===A.GRAPH||W===A.GRIDGRAPH)){if(X.vn&&X.ve&&X.vm===51){a=X.vn;}else{if(X.we&&X.wcn){a=this.visList.findVisName(X.wcn);}}}return a;},build:function M(W,d,m){var k=this.classMap,e=[],g=((W&&W.length)||0),c,Z,a,X,b,Y,j,h,l;for(c=0;c<g;c++){Z=W[c];a=Z&&Z.defn;X=Z&&Z.data;b=C(a);Y=k[b];if(b===A.TEXTFIELD&&((a&&a.dpst))){Y=k[b+"B"];}j=X&&(X.visName||X.vis&&this.getMojoVisName(Z));if(j){X.visName=j;Y=B[A.MOJOVISUALIZATION];}h=(Y&&Y.n)?"new"+Y.n:"";l=undefined;if(this[h]){l=this[h](d,Z,Y,m);}else{if(Y&&Y.scriptClass){var f=Y.cls;if(!f){f=N.walk(Y.scriptClass,window);}if(f){l=this.newRWUnitInstance(d,Z,f);}}}if(l){l.k=Z.k;l.builder=this;l.tooltip=X.tooltip||a.tooltip||"";if(!l.defn){l.defn=a;l.disposables.push(l.defn);}if(l.update){l.update(Z);}if(this.isPortlet(a)){l=this.createPortlet(b,Z,l,m);}if(!this.extractWidget(l,Z)){e.push(l);}}}return e;},createPortlet:function G(X,Y,W,Z){return W;},newRWUnitInstance:function Q(W,Y,Z,X){return new Z(N.copy(X||{},{id:Y.id,node:Y,controller:this.parent.controller,model:W}));},newSection:function T(W,X){this.throwAbstractMethodError("newSection");},newSelector:function J(Y,Z,X,a){var W=this.selectorFactory.newDocSelector(Y,Z,X,a);W.controller=this.parent.controller;return W;},isPortlet:function O(W){return !!((W.t!==A.PANEL&&W.ttl!==undefined)||W.qsm);},extractWidget:function L(X,W){return !X;},getDefaultMojoVisModel:function H(){this.throwAbstractMethodError("getDefaultMojoVisModel");},newMojoVisualization:function(c,k){var m=this.visList,X=k.data,l=m.getVis(X.visName),q=l&&((l.dc!==undefined)?l.dc:l.c),r=this;if(!l){var a=X.className,t=false;if(!a){if(!this.widgetNotFound){this.widgetNotFound=[];}K.forEach(this.widgetNotFound,function(v){if(v.key===X.k){t=true;}});if(!t){this.widgetNotFound.push({key:X.k,name:X.visName});}else{this.widgetNotFound=[];this.widgetNotFound.push({key:X.k,name:X.visName});}var Z=this.widgetNotFound.length,b=Z>1?14642:14643,o=Z>1?"The following custom visualization plug-ins are missing and will be displayed as grids: ##.":"The following custom visualization plug-in is missing and will be displayed as a grid: ##.";if(!j){var j=window.setTimeout(function(){var v=[];K.forEach(this.widgetNotFound,function(w){v.push(w.name);});mstrmojo.warn(mstrmojo.desc(b,o).replace("##",v),{},{buttons:[P(mstrmojo.desc(1442,"OK"),function(){})]});}.bind(this),0);}var u=this.newXtab(c,k);u.cssDefault=!!u.cssDefault?u.cssDefault+" noVis":"noVis";return u;}l={dc:a};}var Y="mstrmojo."+q,g=l.b;if(mstrApp.isVI&&l.vib){g=l.vib;}else{if(mstrApp.isExpress&&l.oivmb){g=l.oivmb;}}if(g&&!mstrmojo.loader.isLoaded(Y)){mstrmojo.requiresBundle(g);}mstrmojo.requiresCls(Y);var W=this.visList.getVis(k.data.visName).m,h=N.walk(q,mstrmojo),p=W?N.walk(W,mstrmojo):this.getDefaultMojoVisModel();if(!h||!p){throw new Error("Missing visualization class.");}h=m.getVisClass(h,k.defn);var f=new h(N.copy(X.extProps,{id:k.id,node:k,n:k.defn.title,controller:this.parent.controller,gb:X.gbys}));var d=new p({xtab:f,controller:this.parent.controller,docModel:c});f.setModel(d);d.set("data",X);if(!!k.data.sdp){var n;for(n in k.data.sdp){k.data.sdp[n].defn={};var e=this.newXtab(c,k.data.sdp[n]);e.setModel(new p({xtab:e,controller:this.parent.controller,docModel:c,data:k.data.sdp[n]}));e.k=n;}}return f;},getEditableXtab:function F(W){this.throwAbstractMethodError("getEditableXtab");},getDefaultXtab:function D(W){this.throwAbstractMethodError("getDefaultXtab");},newXtab:function I(X,Y,W,a){var Z=mstrmojo.all[Y.id];if(!Z){Z=this.newRWUnitInstance(X,Y,Y.defn.txi?this.getEditableXtab(Y):this.getDefaultXtab(a));Z.model=this.newXtabModel({xtab:Z,docModel:X});}else{Z.set("node",Y);Z.model.set("docModel",X);}return Z;},newXtabModel:function U(W){this.throwAbstractMethodError("newXtabModel");}});mstrmojo.DocBuilder.ClassMapItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.css");var B=mstrmojo.css;var A;var D;mstrmojo.ui.ButtonBar=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.ButtonBar",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenabledChange:function G(){B.toggleClass(this.domNode,"disabled",!this.enabled);}},cssDisplay:"table",icnCssText:"display:table-row;",items:null,showIcon:true,init:function F(I){this._super(I);var H=["mstrmojo-ui-ButtonBar"];if(!this.showIcon){H.push("btn-text");}B.addWidgetCssClass(this,H);},getItemMarkup:function E(H){if(!D){D=this._super(H);}if(!A){A=D.replace(">{@en@n}<",'title="{@en@n}"><div>&nbsp;</div><');}return this.showIcon?A:D;},getItemProps:function C(J,H){var I=this._super(J,H);var K=J.css;if(K){I.addCls(K);}I.n=J.n||"";return I;}});mstrmojo.ui.ButtonBar.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase");mstrmojo.SelectBox=mstrmojo.declare(mstrmojo.ListBase,null,{scriptClass:"mstrmojo.SelectBox",size:10,cssDisplay:"inline",markupString:'<select id="{@id}" class="mstrmojo-SelectBox {@cssClass}" style="{@cssText}" size="{@size}" {@multipleHtml} mstrAttach:keyup,change tstid="{@tstid}">{@itemsHtml}</select>',markupSlots:{itemsContainerNode:function(){return this.domNode;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onenabledChange:function(){this.domNode.disabled=!this.enabled;}},itemCssClass:"mstrmojo-selectbox-item",itemDisplayField:"n",itemIdField:"v",showItemTooltip:false,itemRenderer:{render:function(E,D,F){var G=mstrmojo.string.htmlAngles((F.getItemName)?F.getItemName(E,D):(F.itemDisplayField&&E[F.itemDisplayField]));return'<option class="'+F.itemCssClass+'" value="'+((F.getItemValue)?F.getItemValue(E,D):(F.itemIdField&&E[F.itemIdField]))+'" '+((F.selectedIndices[D])?'selected="true" ':"")+((F.showItemTooltip)?'title="'+mstrmojo.string.encodeXMLAttribute(G)+'"':"")+">"+G+"</option>";},select:function(E,F,D,G){E.selected=true;},unselect:function(E,F,D,G){E.selected=false;}},buildRendering:function C(){this.multipleHtml=this.multiSelect?' multiple="true" ':"";this._super();delete this.multipleHtml;},_getItemNode:function(D){var E=this.scrollboxNode;return E&&E.options[D];},prechange:function A(E){if(this._syncDom){return ;}this._syncDom=true;var H=this.scrollboxNode;if(this.multiSelect){var I=H.options,F=[];for(var G=0,D=I.length;G<D;G++){if(I[G].selected){F.push(G);}}this.select(F);}else{this.singleSelect(H.selectedIndex);}delete this._syncDom;},prekeyup:function(E){var H=this.scrollboxNode,F=false;if(this.multiSelect){var I=H.options;for(var G=0,D=I.length;G<D;G++){if(I[G].selected!==!!this.selectedIndices[G]){F=true;break;}}}else{if(H.selectedIndex!==this.selectedIndex){F=true;}}if(F){var J=E;J.name="change";this.raiseEvent(E);}},onselectionChange:function B(D){if(!this._syncDom){this._super(D);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var D=mstrmojo.dom,F=mstrmojo.array,E=mstrmojo.hash;var A;mstrmojo.SuggestionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.SuggestionList",itemField:"n",getItemMarkup:function(H,G){if(!A){var I=this.itemField;A=this._super(H).replace(">{@en@n}<",' title="{@en@'+I+'}">{@en@'+I+"}<");}return A;},getItemProps:function C(I,G){var H=this._super(I,G),J=this.itemField;H[J]=I[J];return H;},onclick:function B(G){if(this.disableClick){return false;}var L=this,I=this.parent,K=I.opener,H=D.isMetaKey(G.hWin,G.e);if(H&&!this.multiSelect){this.multiSelect=K.parent.defn.multi;if(this.multiSelect){D.attachOneTimeEvent(document.documentElement,"keyup",function(){var N=L.selectedIndices;if(K){K.suggestionShown=false;if(N&&!E.isEmpty(N)){var M=[];E.forEach(L.selectedIndices,function(P,O){M.push(L.items[O]);});K.handleSuggestionItemSelect(M);}I.close();}L.multiSelect=false;});}}this._super(G);if(!this.multiSelect){K.suggestionShown=false;var J=this.selectedItem;if(J){K.handleSuggestionItemSelect(J);}I.close();}},bindings:{itemField:"this.parent.opener.itemField",items:"this.parent.opener.suggestionItems",disableClick:"this.parent.opener.disableClick"}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");mstrmojo.ui.List=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.List",postselectionChange:function C(D){var G=D.added||[],F=G.length,I=D.removed||[],E=I.length;if(E){this.selectionRemoved({added:G,removed:I,isReselect:false});}if(F){var H=function(J){return[].concat(J).sort().join(",");};this.selectionAdded({added:G,removed:I,isReselect:H(G)===H(I)});}},selectionAdded:function A(D){},selectionRemoved:function B(D){}});mstrmojo.ui.List.SelectionChangeEvtType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.string");mstrmojo.DivItemRenderer={render:function(E,C,F){var D=mstrmojo.string.encodeHtmlString((F.getItemName?F.getItemName(E,C):(F.itemDisplayField&&E[F.itemDisplayField])));return'<div mstridx="'+C+'" class="'+F.itemCssClass+(F.selectedIndices[C]?" "+F.itemSelectedCssClass:"")+(E.cssClass?" "+E.cssClass:"")+'" style="'+F.itemCssText+'">'+D+"</div>";},select:function(D,E,C,F){D.className+=" selected";},unselect:function(D,E,C,F){D.className=D.className.replace(/selected/g,"");},rowHeight:21};mstrmojo._RendersItemDivs={tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"mstrmojo-ListBox-cell",cellCssText:"",itemCssClass:"mstrmojo-ListBox-item",itemSelectedCssClass:"selected",itemDisplayField:"n",itemRenderer:mstrmojo.DivItemRenderer,rangeSelected:false,_findMatch:function(C,D){return mstrmojo.dom.findAncestorByAttr(mstrmojo.dom.eventTarget(C,D),"mstridx",true,this.itemsNode);},premousedown:function A(C){if(mstrmojo.dom.shiftKey(C.hWin,C.e)){mstrmojo.dom.preventDefault(C.hWin,C.e);}},preclick:function B(L){var H=L.hWin,I=L.e,G=this._findMatch(H,I);if(G){var E=G.node,K=parseInt(G.value,10),J=mstrmojo.dom,C=J.ctrlKey(H,I),D=J.shiftKey(H,I);if(C||D){J.clearBrowserHighlights(H);}if(this.multiSelect&&(this.selectionPolicy==="toggle"||C)){var F=this.rangeSelected||this.selectedIndex===-1;this.toggleSelect(K);if(F&&K<this.items.length&&this.selectedIndices[K+1]){K++;}this.selectedIndex=K;this.rangeSelected=false;}else{if(this.multiSelect&&D){this.rangeSelected=true;this.rangeSelect(K);}else{this.singleSelect(K);this.rangeSelected=false;}}}}};mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._RendersItemDivs");mstrmojo.ListBoxBase=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._RendersItemDivs],{scriptClass:"mstrmojo.ListBoxBase",cssClass:"mstrmojo-ListBox",itemCssClass:"mstrmojo-ListBox-item",_markupPrefix:function(){var C=this.itemRenderer;return(C&&C.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="0" cellpadding="0"><tbody>');},_markupSuffix:function(){var C=this.itemRenderer;return(C&&C.markupSuffix)||"</tbody></table>";},_itemPrefix:function(){var C=this.itemRenderer;return(C&&C.itemPrefix)||('<tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'"><td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var C=this.itemRenderer;return(C&&C.itemSuffix)||"</td></tr>";},_getItemNode:function(C){var E=this.itemsNode,D=E&&E.rows,F=D&&D[C];return F&&F.cells[0].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList");var A;mstrmojo.ui.editors.controls.ColorList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.ui.editors.controls.ColorList",init:function D(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ColorList");},getItemMarkup:function C(F,E){if(!A){A=this._super(F,E).replace(">{@en@n}<",">{@en@msg}<");}return A;},getItemProps:function B(G,E){var F=this._super(G,E);if(G.id==="transparent"){F.msg=mstrmojo.desc(5774,"No Fill");F.addCls("noFill");}else{F.msg="";G.title=G.n;F.addStyle("background-color:"+G.id);}return F;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder","mstrmojo._SupportsEllipsisText","mstrmojo._HasEllipsis","mstrmojo.css","mstrmojo.array");var V=mstrmojo.css,U=mstrmojo.array;var R=2;function D(Z,X,Y){var a=Z.parent.parent;if(a&&a instanceof mstrmojo.DocPanel){a[X+"DirtyKey"](Y);}}function O(Y,X,Z){if(Y===X.k){mstrmojo.array.forEach(X.children,function(a){if(a.setDirtyChildren){a.setDirtyChildren(Z);}});}}function I(X){return X._isFP()&&!X.parent.defn.od;}mstrmojo.DocPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder,mstrmojo._SupportsEllipsisText,mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.DocPanel",visible:false,selected:false,k:"",cssDisplay:"block",subPanelCssText:"height:100%;width:100%;position:absolute;",topStart:R,contentWidth:0,markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocPanel {@cssClass}" style="{@cssText}{@domNodeCssText}"><div class="mstrmojo-DocSubPanel-content" style="{@containerNodeCssText}{@subPanelCssText}"></div></div>',markupMethods:{onvisibleChange:function(){var Y=this.domNode.style,X=this.visible;if(I(this)){Y.visibility=(X?"":"hidden");Y.zIndex=(X?10:1);}else{Y.display=(X?this.cssDisplay:"none");}}},markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{containerNode:["background-color","fx","overflow"]},title:"",init:function Q(X){this._super(X);if(!this.title){this.title=this.node.defn.ttl||"";}if(this._isSearchBoxPanel()){this.isSbp=true;this.set("canApplySbp",false);}},childRenderCheck:function L(X){return(this._super(X)&&(this.selected||I(this)));},postBuildRendering:function T(){if(!this.defn.l&&!this._forceRender){V.addClass(this.domNode,"placeholder");}var Y=this._super();if(this.isSbp){var X=this.addChildren({scriptClass:"mstrmojo.Button",cssClass:"sbp-apply",title:mstrmojo.desc(134,"Apply"),cssText:"top:"+((parseInt(this.parent.fmts.height,10)||0)-28)/2+"px",bindings:{enabled:"this.parent.canApplySbp&&this.parent.parent.applyEnabled"},onclick:function(){this.parent.parent.applyBufferedSlices();}});X.render();}if(this._isFSP()){this.set("shouldEllipsize",true);}if(mstrApp.isOIVM&&mstrApp.isOIVM()&&mstrmojo.dom.isChrome){var a=this.containerNode.style.overflow;this.containerNode.style.overflow="hidden";var Z=this;window.setTimeout(function(){if(Z.containerNode&&Z.containerNode.style&&Z.containerNode.style.overflow){Z.containerNode.style.overflow=a;}},2000);}return Y;},onselectedChange:function M(X){if(X.value){this.renderChildren();}this.model&&this.model.raiseEvent({name:"panelSelected",panelId:this.id,panelVisible:!!X.value});},updateForPU:function S(X){this.node=X;this.update(X);},refreshForPU:function A(){this._isPartial=true;this.refresh();this._isPartial=false;},_isPartial:false,refresh:function E(){if(!this.hasRendered){return ;}this._inRendering=true;var Z=[].concat(this.getPanelChildren()||[]),Y=[].concat(this.getChildren(this._isPartial)),X;U.removeItems(Z,"k",Y);U.removeItems(Y,"k",this.getPanelChildren());if(Z.length!==0){U.forEach(Z,function(a){this.removeChildren(a);a.destroy();},this);}if(Y.length!==0){U.forEach(Y,function(c){var b=c.id&&mstrmojo.all[c.id];var a=b&&b.defn;if(a){a._isDeleted=true;}if(b&&b.destroy){b.destroy();}},this);this.addChildren(this.builder.build(Y,this.model,this.buildConfig));}Z=[].concat(this.getPanelChildren()||[]);for(X=Z.length-1;X>=0;X--){Z[X].refresh();}if(this._isFP()&&this.selected){this.refreshFP();}if(this._isFSP()){this.set("richTooltip",{content:this.containerNode.innerHTML,contentNodeCssClass:"sp-tooltip",left:-20,top:20,refNode:this.domNode});this.ellipsizeElements("div",this.containerNode,true);}this._inRendering=false;},setDirty:function N(X){this[(X?"add":"remove")+"DirtyKey"](this.k);},addDirtyKey:function H(X){var Z=this.defn,Y=Z.dirtyKeys||{};Y[X]=true;Z.dirtyKeys=Y;if(X===this.k){mstrmojo.array.forEach(this.children,function(a){if(a.setDirtyChildren){a.setDirtyChildren(true);}});}O(X,this,true);D(this,"add",X);},removeDirtyKey:function K(Y){D(this,"remove",Y);O(Y,this,false);if(Y===this.k){mstrmojo.array.forEach(this.children,function(a){if(a.setDirtyChildren){a.setDirtyChildren(false);}});}var Z=this.defn,X=Z.dirtyKeys;if(!X){return ;}delete X[Y];if(!mstrmojo.hash.isEmpty(X)){return ;}delete Z.dirtyKeys;},getPanelChildren:function G(){return U.filter(this.children||[],function(X){return X.scriptClass!=="mstrmojo.Button";});},preBuildRendering:function(){if(this._isFSP()){this.useRichTooltip=true;}if(this._super){this._super();}},renderChildren:function J(){this._inRendering=true;var d=this.children;if(d&&(this._isFP()||this._isFSP())){U.forEach(d,function(g){g.getFormats();});}if(this.isSbp){V.addClass(this.domNode,"mstrmojo-sbp");}if(this._isFP()){V.addClass(this.parent.domNode,"fpgb");if(d){var e=this.domNode.clientWidth-2*R,b,X;this.topStart=R+1;for(b=0,X=(d&&d.length)||0;b<X;b++){var Z=this.domNode.clientWidth-2*R;this.contentWidth=(Z>0)?Z:0;if(Z!==e){this.topStart=R+1;var a;for(a=0;a<b;a++){var Y=d[a];Y.refresh();if(Y.getContainerHeight){this.topStart+=Y.getContainerHeight()+R+1;}}}var f=d[b];if(this.childRenderCheck(f)){f.render(null);if(f.getContainerHeight){this.topStart+=f.getContainerHeight()+R+1;}}}}}else{this._super();}if(this._isFSP()){this.set("richTooltip",{content:this.containerNode.innerHTML,contentNodeCssClass:"sp-tooltip",left:-20,top:20,refNode:this.domNode});this.ellipsizeElements("div",this.containerNode,true);}this._inRendering=false;},refreshFP:function F(){if(!this.hasRendered){return ;}var a=this.children,X=(a&&a.length)||0,Z;this.topStart=R+1;var Y=this.domNode.clientWidth-2*R;this.contentWidth=(Y>0)?Y:0;for(Z=0;Z<X;Z++){var b=a[Z];if(b.relocate){b.relocate(this.topStart,this.contentWidth);}if(b.updateContentHeight){b.updateContentHeight();}if(b.getContainerHeight){this.topStart+=b.getContainerHeight()+R+1;}}},getChildren:function C(a){var Z=this.model.getChildren(this.node,a);if(this._isFP()||this._isFSP()){var X=(Z&&Z.length)||0,Y;for(Y=0;Y<X;Y++){var b=Z[Y];if(this._isFP()&&!b.defn.iifp){b.defn.iifp=true;}if(this._isFSP()&&!b.defn.iifs){b.defn.iifs=true;}}}Z=U.filter(Z||[],function(c){if(typeof c.defn.ifw==="boolean"){return !c.defn.ifw;}return true;});return Z;},onchildRenderingChange:function B(X){this._super(X);if(this._isFSP()&&!this._inRendering){this.ellipsizeElements("div",this.containerNode,true);}},_isFP:function W(){return !!this.parent.defn.ifp;},_isFSP:function P(){return !!this.parent.defn.ifsp;},_isSearchBoxPanel:function(){return false;},canApplySearchBoxPanel:function(){var Y=this.model.getChildren(this.node,false),X;for(X=0;X<Y.length;X++){var a=Y[X],Z=mstrmojo.all[a.id];if(Z&&Z.canApply&&!Z.canApply()){return false;}}return true;},doEllipsize:function(){if(this.shouldEllipsize){this.ellipsizeElements("div",this.containerNode,true);}if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable");var D=function D(F){return F.data.dl||F.defn.dl;};mstrmojo.DocImage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocImage",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocImage" title="{@tooltip}" style="{@domNodeCssText}"><div style="{@shadowNodeCssText}"><img src="{@v}" style="{@imgNodeCssText}" mstrAttach:click></div>{@buttonNodeMarkup}</div>',markupSlots:{imgNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function E(H){var I=this.model.getDataService(),F=H.data.v,G=D(H);this.origV=F;this.v=(I&&I.getImage&&I.getImage(F))||F;this.oid=H.defn.oid;if(G){this.tooltip=G.items[0].n;}if(this.thresholdId||H.data.tid){delete this.fmts;}this.thresholdId=H.data.tid;this.set("visible",!H.data.hidden);if(this._super){this._super(H);}},formatHandlers:{domNode:["left","top","z-index"],shadowNode:["width","height","B","fx"],imgNode:["height","width"]},preBuildRendering:function B(){this._super();if(mstrApp.isMobile&&mstrApp.useBinaryFormat){var F=this.v,I=mstrMobileApp.isOnline(),H=this.model.getDataService();if((!I&&F.indexOf("http")===0)||(I&&F.indexOf("http")!==0)){this.v=(H&&H.getDocImage&&H.getDocImage(this.origV))||F;}}var G=mstrmojo.string;if(this.node.data.ut===4){this.v=mstrConfig.taskURL+"?taskId=getRWEmbeddedImage&msgID="+this.model.mid+"&oid="+G.decodeHtmlString(this.v,true);}this.updateDimensionsFromFormats();},updateDimensionsFromFormats:function C(){if(!mstrmojo.dom.isIE7){var F=this.getFormats(),I=(F.fx&&F.fx.ds)||0,G=mstrmojo._Formattable.getBorderWidths(this),H=1;if((mstrmojo.dom.isIE||mstrmojo.dom.isIEW3C)&&this.model.getZoomFactor){H=this.model.getZoomFactor()>1?this.model.getZoomFactor():1;G.w=Math.ceil(G.w*H);G.h=Math.ceil(G.h*H);}this.domNodeCssText+="width:"+((parseInt(F.width,10)||0)+I+G.w)+"px; height: "+((parseInt(F.height,10)||0)+I+G.h)+"px;";}},getAnchor:function A(){return this.imgNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo._ContainsDocObjects","mstrmojo._HasBuilder");mstrmojo.rw.DocSubsection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._ContainsDocObjects,mstrmojo._HasBuilder],{scriptClass:"mstrmojo.rw.DocSubsection",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSubsection" style="{@domNodeCssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},formatHandlers:{domNode:["D","B","background-color","fx"]},update:function C(E){var D=E.data.tid;if(this.thresholdId||D){delete this.fmts;}this.thresholdId=D;if(this._super){this._super(E);}},postBuildRendering:function B(){return(this.renderMode!=="scroll")?this._super():true;},childRenderOnAddCheck:function A(D){return(this.renderMode!=="scroll")?this._super(D):false;},preserveChildDomOrder:false,performCanGrowCanShrink:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css");var F="",B="row-",E=mstrmojo.css.DISPLAY_TABLE;mstrmojo.Table=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Table",cellCssClass:"",rows:-1,cols:-1,_trows:-1,cellPadding:0,cellSpacing:0,layout:null,markupString:'<table id="{@id}" class="mstrmojo-Table {@cssClass}" style="{@cssText}" cellpadding="{@cellPadding}" cellspacing="{@cellSpacing}">{@tableHtml}</table>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?E:"none";}},preBuildRendering:function G(){var I=[],P=this.cellCssClass;if(this.layout){var Q=this._trows=this.layout.length;for(var K=0;K<Q;K++){var H=this.layout[K],R=H.cells,O=R.length,L=[];for(var J=0;J<O;J++){var N=R[J],M="";M+=((N.cssClass||P)?' class="'+(N.cssClass||P)+'"':"");M+=(N.cssText?' style="'+N.cssText+'"':"");M+=(N.rowSpan?' rowspan="'+N.rowSpan+'"':"");M+=(N.colSpan?' colspan="'+N.colSpan+'"':"");L[J]="<td"+M+"></td>";}var S="";S+=(H.cssClass?' class="'+H.cssClass+'"':"");S+=(H.cssText?' style="'+H.cssText+'"':"");I[K]="<tr"+S+">"+L.join("")+"</tr>";}}else{this._trows=this.rows;var M=(P?' class="'+P+'"':""),L=[];for(var K=0;K<this.rows;K++){for(var J=0;J<this.cols;J++){L[J]="<td"+M+"></td>";}I[K]="<tr>"+L.join("")+"</tr>";}}this.tableHtml=I.join("");if(this._super){this._super();}},postBuildRendering:function C(){if(this._trows){var M={},I=this.containerNode.rows,N=I.length;for(var L=0;L<N;L++){var K=I[L].cells,H=K.length;M[B+L]=I[L];for(var J=0;J<H;J++){M[F+L+","+J]=K[J];}}this.addSlots(M);}this._super();},childRenderCheck:function D(I){if(I&&!I.hasRendered){var H=I.slot||this.defaultChildSlot;return !!this[H]||H.match(/^([\d]+),([\d]+)$/);}return false;},on_child_change_rendering:function A(L){var H=(L&&L.src)||L,O=H&&H.domNode;if(O){var U=H.slot;if(!this[U]){var M=U&&U.match(/^([\d]+),([\d]+)$/);if(M){var R=parseInt(M[1],10),V=parseInt(M[2],10),Q=this.containerNode,T=this[(B+R)],N=[];if(!T){var J=Q.rows,S=J&&J.length||0;for(var K=S;K<=R;K++){N[B+K]=Q.insertRow();}T=N[B+R];}var P=T.cells&&T.cells.length||0;for(var K=P;K<=V;K++){var I=T.insertCell(K);N[F+R+","+K]=I;if(this.cellCssClass){I.className=this.cellCssClass;}}this.addSlots(N);}}}this._super(L);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout");var D=' style="display:inline-block;vertical-align:middle;"';mstrmojo.ui.editors.controls.TwoColumnContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-vi-TwoColumnProp {@cssClass}" style="{@cssText}"><div class="vi-col1"'+D+'></div><div class="divider"'+D+'></div><div class="vi-col2"'+D+"></div></div>",markupSlots:{col1Node:function C(){return this.domNode.firstChild;},dividerNode:function B(){return this.domNode.childNodes[1];},col2Node:function A(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onenabledChange:mstrmojo.Container.enabledMarkupMethod},layoutConfig:{w:{col1Node:"40%",dividerNode:"5px",col2Node:"60%"},xt:true},shouldPropagateEnabled:true,col1Width:"40%",dividerWidth:"5px",col2Width:"60%",init:function F(G){this._super(G);var H=this.layoutConfig=JSON.parse(JSON.stringify(this.layoutConfig)),I=H.w;I.col1Node=this.col1Width;I.dividerNode=this.dividerWidth;I.col2Node=this.col2Width;},getControl:function E(G){return(this.children||[]).filter(function(H){return H.slot==="col"+G+"Node";})[0];}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.CheckBox","mstrmojo.array");var E=mstrmojo.hash,A=mstrmojo._FormatDefinition,F=mstrmojo.array;var D=function(G){return mstrmojo.hash.copy(G,{scriptClass:"mstrmojo.TextBox",alias:"decimalPlaces",bindings:{m:G.modelBinding,value:function(){return this.m.DecimalPlaces||"2";},category:function(){var H=this.m.Category;this.onkeyup();}},onkeyup:function(H){if(/^\d{1,2}$/.test(this.value)){var O=this.m.DecimalPlaces,J=this.value;this.m.DecimalPlaces=J;if(O!=J&&this.negative){var K=this.parent[this.negative],M;if(K&&K.refreshFormatList){K.refreshFormatList();}else{M=mstrmojo.hash.clone(A[this.negative]);if(M){var N=J>0?".":"",I=N,L;for(L=0;L<Math.min(J,A.MaxNegativeDidigts);L++){N+=L%9;I+="0";}for(L=0;L<M.length;L++){M[L].n=M[L].n.replace(/\.\d{2}/g,N);M[L].f=M[L].f.replace(/\.\d{2}/g,I);}K.set("items",M);}}}}}});},B=function(G){return mstrmojo.hash.copy(G,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList",itemMarkupFunction:function(J,H,K){var I=J.r?"color: red":"";return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text" style="'+I+'">'+J.n+"</div></div>";},selectionPolicy:"reselect",bindings:{m:G.modelBinding,selectedIndex:function(){var H=F.find(this.items,"v",this.m.NegativeNumbers);if(H===-1){H=F.find(this.items,"f",this.m.Format);}this.singleSelect(H);return H==-1?3:H;},category:function(){var H=this.m.Category;this.onchange();}},onchange:function(H){if(this.parent.idx===F.find(A.Category,"v",this.m.Category)&&this.selectedItem){this.m.NegativeNumbers=this.selectedItem.v;this.m.set("Format",this.selectedItem.f||this.selectedItem.v);}},onmChange:function(H){if(this.m){var M=this.m.DecimalPlaces;if(M!=2){var K=mstrmojo.hash.clone(A[this.alias]);if(K){var L=M>0?".":"",I=L,J;for(J=0;J<Math.min(M,A.MaxNegativeDidigts);J++){L+=J%9;I+="0";}for(J=0;J<K.length;J++){K[J].n=K[J].n.replace(/\.\d{2}/g,L);K[J].f=K[J].f.replace(/\.\d{2}/g,I);}this.set("items",K);}}}},postCreate:function(){this.onmChange();}});},C=function(G){return mstrmojo.hash.copy(G,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList "+G.alias,itemMarkupFunction:function(I,H,J){return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">'+I.n+"</div></div>";},selectedIndex:0,bindings:{m:G.modelBinding,selectedIndex:function(I){var H=F.find(this.items,"v",this.m.Format);return H===-1?0:H;},category:function(){var H=this.m.Category;this.onchange();}},onchange:function(H){if(this.parent.idx===F.find(A.Category,"v",this.m.Category)){this.m.set("Format",this.selectedItem.f||this.selectedItem.v);}}});};mstrmojo.NumberFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.NumberFormatter",cssClass:"mstrmojo-NumberFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){E.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{colSpan:2}]},{cells:[{},{}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7940),cssClass:"category",cssText:"font-weight: bold"},{slot:"1,0",scriptClass:"mstrmojo.List",alias:"numberCategory",cssClass:"mstrmojo-FormatEditor-numberCategory",items:A.Category,selectionPolicy:"reselect",bindings:{m:"this.parent.parent.model",selectedIndex:function(){var H=this.m.Category,G=F.find(this.items,"v",(H==="pru"?-2:H));return(G===-1)?0:G;}},onchange:function(G){if(this.m){this.m.set("Category",this.selectedIndex===0?"pru":this.selectedItem.v);}}},{slot:"1,1",scriptClass:"mstrmojo.Container",alias:"numberSubpanelContainer",width:"300px",markupString:'<div id={@id} class="mstrmojo-FormatEditor-numberPanel-subpanel {@cssClass}"><div class="mstrmojo-FormatEditor-numberPanel-subpanel-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},postBuildRendering:function(){var G=mstrmojo.Container.prototype.postBuildRendering.apply(this);this.parent.numberCategory.singleSelect(this.parent.numberCategory.selectedIndex);return G;},children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item",idx:0,rows:1,cols:1,children:[{scriptClass:"mstrmojo.Label",text:" ",slot:"0,0"}],bindings:{visible:'this.parent.parent.parent.model.Category=="pru"',category:function(){var H=this.parent.parent.parent.model,G=this.parent.parent.parent.model.Category;if(H&&this.idx===F.find(A.Category,"v",G)){H.set("Format","");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item",idx:1,rows:1,cols:1,children:[{scriptClass:"mstrmojo.Label",text:" ",slot:"0,0"}],bindings:{visible:"this.parent.parent.parent.model.Category==9",category:function(){var H=this.parent.parent.parent.model,G=this.parent.parent.parent.model.Category;if(H&&this.idx===F.find(A.Category,"v",G)){H.set("Format","");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item fixed",idx:2,rows:3,cols:2,layout:[{cells:[{},{}]},{cells:[{},{}]},{cells:[{colSpan:2}]}],bindings:{visible:"this.parent.parent.parent.model.Category==0"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({modelBinding:"this.parent.parent.parent.parent.model",negative:"FixedNegative",alias:"FixedDecimalPlaces",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044),slot:"1,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:A.FixedNegative,refreshFormatList:function(){var H=this.parent,K=H&&H.FixedDecimalPlaces,N=H&&H.ThousandSeparator;if(!K||!N){return ;}var I=K.value||0,R=mstrmojo.hash.clone(A.FixedNegative),G=N.checked,Q=I>0?".":"",P=Q,O,M,L;for(M=0,L=Math.min(I,A.MaxNegativeDidigts);M<L;M++){Q+=M%9;P+="0";}var J;for(J=0;J<R.length;J++){O=R[J].n.replace(/\.\d{2}/g,Q);if(!G){O=O.replace("1,234","1234");}R[J].n=O;O=R[J].f.replace(/\.\d{2}/g,P);if(!G){O=O.replace(/#,##/g,"###");}R[J].f=O;}this.set("items",R);},alias:"FixedNegative",slot:"1,1"}),{scriptClass:"mstrmojo.ImageCheckBox",alias:"ThousandSeparator",label:mstrmojo.desc(2049),cssText:"width:auto;",bindings:{m:"this.parent.parent.parent.parent.model",checked:function(){var G=this.m.ThousandSeparator;if(G==null){G=-1;}return parseInt(G,10)!==0;}},oncheckedChange:function(){if(this.m&&this.parent.idx===F.find(A.Category,"v",this.m.Category)){this.m.ThousandSeparator=this.checked?-1:0;this.parent.FixedNegative.refreshFormatList();}},slot:"2,0"}]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item currency",idx:3,rows:4,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==1"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({modelBinding:"this.parent.parent.parent.parent.model",negative:"CurrencyNegative",alias:"currencyDecimal",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2047),slot:"1,0"},{scriptClass:"mstrmojo.TextBox",alias:"currencySymbol",maxLength:5,bindings:{m:"this.parent.parent.parent.parent.model",value:function(){return this.m.CurrencySymbol||mstrmojo.desc("2369");},category:function(){var G=this.m.Category;this.onkeyup();}},onkeyup:function(G){this._update();},onvalueChange:function(){this._update();},_update:function(){if(this.m){var H=this.m.CurrencySymbol;this.m.CurrencySymbol=this.value;var G=this.parent.CurrencyNegative;if(G&&(H!=this.value)){G.refreshFormatList();}}},slot:"1,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2048),slot:"2,0"},{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-numberFormatList",alias:"CurrencyPosition",items:A.CurrencyPosition,itemMarkupFunction:function(H,G,I){return'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">'+H.n+"</div></div>";},bindings:{m:"this.parent.parent.parent.parent.model",selectedIndex:function(){var G=F.find(A.CurrencyPosition,"v",this.m.CurrencyPosition);return(G===-1?0:G);},category:function(){var G=this.m.Category;this.onchange();}},onchange:function(G){if(this.m){this.m.CurrencyPosition=this.selectedItem.v;var H=this.parent.CurrencyNegative;if(H){H.refreshFormatList();}}},slot:"2,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044),slot:"3,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:A.CurrencyNegative,refreshFormatList:function(){var O=this.parent,J=O&&O.currencyDecimal,N=O&&O.CurrencyPosition,K=O&&O.currencySymbol;if(!J||!N||!K){return ;}var M=J.value||0,I=parseInt(N.selectedIndex,10)||0,H=K.value||"",L=mstrmojo.hash.clone(A.CurrencyNegative),Y=M>0?".":"",W=Y,Q,X,U;H=(I===2?H+" ":(I===3?" "+H:H));for(X=0,U=Math.min(M,A.MaxNegativeDidigts);X<U;X++){Y+=X%9;W+="0";}var P=mstrConfig.decimalSep,G=mstrConfig.thousandsSep,T;for(T=0;T<L.length;T++){var R=L[T].n,V=L[T].f,S;if(I===1||I===3){Q=V.split(";");for(S=0,U=Q.length;S<U;S++){Q[S]=Q[S].replace(/(\"\$\")(.*)/g,"$2$1");}R=R.replace(/(\$)(.*)/g,"$2$1");V=Q.join(";");}R=R.replace(/\$/g,H).replace(/\.\d{2}/g,Y);V=V.replace(/\$/g,H).replace(/\.\d{2}/g,W);L[T].n=R.replace(/,/,G).replace(/(\d{2,3})\./,"$1"+P);L[T].f=V.replace(/,/,G).replace(/(\d{2,3})\./,"$1"+P);}this.set("items",L);},alias:"CurrencyNegative",slot:"3,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Date",idx:4,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==2"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",items:A.Date,alias:"Date",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Time",idx:5,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==3"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",items:A.Time,alias:"Time",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item percentage",idx:6,rows:2,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==4"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({modelBinding:"this.parent.parent.parent.parent.model",negative:"PercentNegative",slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2044,"Negative numbers"),slot:"1,0"},B({modelBinding:"this.parent.parent.parent.parent.model",items:A.PercentNegative,alias:"PercentNegative",slot:"1,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item Fraction",idx:7,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==5"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2869),slot:"0,0"},C({modelBinding:"this.parent.parent.parent.parent.model",items:A.Fraction,alias:"Fraction",slot:"0,1"})]},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item scientific",idx:8,rows:1,cols:2,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2046),slot:"0,0"},D({slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"})],bindings:{m:"this.parent.parent.parent.model",visible:"this.m.Category==6",category:function(){if(this.m&&this.idx===F.find(A.Category,"v",this.m.Category)){this.m.set("Format","0.00E+00");}}}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-FormatEditor-numberPanel-subpanel-item custom",idx:9,rows:1,cols:2,bindings:{visible:"this.parent.parent.parent.model.Category==7"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2133),slot:"0,0"},{scriptClass:"mstrmojo.TextBox",alias:"custom",value:"",bindings:{m:"this.parent.parent.parent.parent.model",value:function(){return this.m.Format;}},onvalueChange:function(){if(this.m&&this.parent.idx===F.find(A.Category,"v",this.m.Category)){this.m.Format=this.value;}},slot:"0,1"}]}]}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.FieldSet=mstrmojo.declare(mstrmojo.Container,null,{legend:null,scriptClass:"mstrmojo.FieldSet",markupString:'<fieldset id="{@id}" class="mstrmojo-FieldSet {@cssClass}" style="{@cssText}"><legend class="{@cssClass}-legend">{@legend}</legend></fieldset>',markupSlots:{legendNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode;}},markupMethods:{onlegendChange:function(){this.legendNode.innerHTML=mstrmojo.string.encodeHtmlString((this.legend!=null)?this.legend:"");},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.DropDownList");function D(){var E=new mstrmojo.WaitIcon(),H=function(K){this.controller.onGroupBy(this,{groupbyKey:K.src.k,elementId:K.value},function(L){E.set("visible",L);});};for(var G=0,F=this.data.length;G<F;G++){var I=this.data[G];var J=this.addChildren(new mstrmojo.DropDownList({k:I.k,title:I.unit.target.n+":",idx:I.unit.idx,cssClass:"mstrmojo-DocGroupBy-unit",selectCssClass:"mstrmojo-DocGroupBy-unit-select"}));J.options=I.unit.elms;J.attachEventListener("selectedChange",this.id,H);}this.addChildren(E);}function B(){var H=this.data,G=this.children;if(H.length===G.length-1){for(var F=0,E=H.length;F<E;F++){var I=H[F].unit,J=G[F];J.idx=I.idx;J.options=I.elms;J.refresh();}}}mstrmojo.DocGroupBy=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DocGroupBy",markupString:'<div id="{@id}" class="mstrmojo-DocGroupBy {@cssClass}"><div style="padding-top: 5px;"></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},init:function C(E){this._super(E);this.ondataChange();},ondataChange:function A(){if(!this.data||!this.data.length){return ;}if(!this.hasRendered){D.apply(this);}else{B.apply(this);}},areUnitsSetToAll:function(){var E=true;mstrmojo.array.forEach(this.data,function(F){if(F.unit.elms[F.unit.idx].v!=="u;"){E=false;return false;}});return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var B=mstrmojo.func,C=mstrmojo.dom,F="mstrmojo-popup-widget-hosted";mstrmojo.ui.PopupButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ui.PopupButton",onPopupWidgetClosed:mstrmojo.emptyFn,onPopupWidgetOpened:mstrmojo.emptyFn,anchorSlot:"domNode",isHostedWithin:true,hostedCSSClass:"",destroy:function H(L){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);}this._super(L);},getPopupWidget:mstrmojo.emptyFn,postCreateChildren:function D(){var L=this.getPopupWidget();if(!L||L._pbCfg){return ;}var M=function M(O,N){return function(){O.apply(N,arguments);};};L.onOpen=B.composite([M(this.onPopupWidgetOpened,this),L.onOpen||mstrmojo.emptyFn]);L.onClose=B.composite([M(this.onPopupWidgetClosed,this),L.onClose||mstrmojo.emptyFn]);L._pbCfg=true;},onclick:function K(L){var N=L.getTarget();if(N===this[this.anchorSlot]||N.parentNode===this[this.anchorSlot]){var M=this.getPopupWidget();if(!M.visible){this.openPopup(M);}else{this.closePopup();}}},onPopupAutoClosed:function I(M,L){if(C.contains(this[this.anchorSlot],C.eventTarget(L,M),true)){return false;}},getPopupHostNode:function J(){return this.containerNode;},getPopupConfig:function G(){var M=[F],L=this.hostedCSSClass;if(L){M.push(L);}return new mstrmojo.ui.PopupConfig({hostId:this.id,hostElement:this.getPopupHostNode(),anchorElement:this[this.anchorSlot],isHostedWithin:this.isHostedWithin,hostProxyCssClass:M.join(" ")});},unrender:function E(L){if(this._listenerProc){C.detachEvent(window,"resize",this._listenerProc);delete this._listenerProc;}this._super(L);},postBuildRendering:function A(){var P=this.getPopupWidget();if(P){var R=this.getPopupConfig();if(!R.isHostedWithin){var N=this.parent||this.opener,M=R.hostProxyCssClass.split(" ");M.push(this.domNode.className);while(N){var Q=N.themeClassName;if(Q){M.push(Q);break;}N=N.parent||N.opener;}R.hostProxyCssClass=M.join(" ");}P.popupConfig=P.addDisposable(R);}var L=P.id,O=this._listenerProc=function(){var S=mstrmojo.all[L];if(S&&S.visible&&S.adjustCornersForPopupOverflow){S.adjustCornersForPopupOverflow();}};if(this.isHostedWithin===false){C.attachEvent(window,"resize",O);}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout");function A(){var D=this._resizeHandler;if(D){window.clearInterval(D);delete this._resizeHandler;}}mstrmojo.OIVMPage=mstrmojo.declare(mstrmojo.Container,[mstrmojo._FillsBrowser,mstrmojo._HasLayout],{scriptClass:"mstrmojo.OIVMPage",markupString:'<div id="{@id}" class="mstrmojo-OIVMPage {@cssClass} {@themeClassName}" style="{@cssText}"><div class="mstrmojo-OIVMPage-pathbar"></div><div class="mstrmojo-OIVMPage-layout"></div></div>',markupSlots:{pathbarNode:function(){return this.domNode.childNodes[0];},layout:function(){return this.domNode.lastChild;}},layoutConfig:{h:{pathbarNode:"42px",layout:"100%"},w:{pathbarNode:"100%",layout:"100%"}},onError:function(F){var H=F.detail,G=mstrApp,E="#666",I=F.code;if(I){var D=mstrmojo.Button.newInteractiveButton;switch(I){case -2147468986:case -2147467618:F.btns=[D(mstrmojo.desc(3758,"Re-run Document"),function(){mstrmojo.form.send({evt:2048001,src:G.name+"."+G.pageName+".2048001",documentID:H.dssid,currentViewMedia:1});},E),D(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.form.send({evt:3010,src:mstrApp.name});},E)];break;default:F.btns=[D(mstrmojo.desc(212,"Continue"),function(){mstrmojo.form.send({evt:3026,src:G.name+"."+G.pageName+".3026"});},E)];}}},renderPageLoadError:function(){var D=this.error;this.onError(D);if(!D.btns||!D.btns.length){mstrmojo.alert(D.message,null,D.title);}else{mstrmojo.confirm(D.message,null,{buttons:D.btns,title:D.title});}},render:function C(){if(this.error){this.renderPageLoadError();}else{this._super();}},browserResized:function B(D,G){var F=this._super(D),E=this;if(G){A.call(this);this._resizeHandler=window.setInterval(function(){var I=E.pathbar,K=I.dc,J=K&&K.zoom,H=K.view.zoomValue;if(J){A.call(E);J.call(K,H&&H.dssid);}},300);}return F;},destroy:function(D){A.call(this);this._super(D);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.TabStripBase=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TabStripBase",target:null,targetProps:null,isStrip:true,ontargetChange:function A(I){var J=I&&I.valueWas;if(J){var G=this._targetSubs;if(G){J.detachEventListener(G.add);J.detachEventListener(G.rem);J.detachEventListener(G.sel);}this.removeChildren();}var K=this.target;if(K){var E=this.targetProps,D=(E&&E.children)||"children",B=K[D];this.addTabButtons(B,0);var H="attachEventListener",C=this.id,F;if(K[H]){this._targetSubs={add:K[H]("addChild",C,function(L){var M=L&&L.value;if(M&&M.length){this.addTabButtons(M,L.index);}}),rem:K[H]("removeChild",C,function(M){var L=M&&M.value;for(F=((L&&L.length)||0)-1;F>-1;F--){this.removeTabButton(L[F]);}}),sel:K[H]("selectedChange",C,function(L){this.selectionChange(L);})};}}},addTabButtons:mstrmojo.emptyFn,removeTabButton:mstrmojo.emptyFn,selectionChange:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.color","mstrmojo.dom","mstrmojo.css","mstrmojo._HasOwnAvatar","mstrmojo.Container","mstrmojo.threshold.ThresholdModel");var Q=mstrmojo.color,F=mstrmojo.dom,I=mstrmojo.css;function G(T){var S=this.parent,R=S.width,U=Math.min(Math.max(T.last.x-F.position(this.domNode).x,0),R-1);return U/R;}mstrmojo.threshold.MarkersNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.threshold.MarkersNode",cssClass:"markers",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"  mstrAttach:click,mousedown,mouseover,mouseout></div>',markupSlots:{containerNode:function D(){return this.domNode;}},dropZone:true,draggable:true,avatarCssClass:"marker-drag-avatar",addMarker:function J(R){this.parent.parent.switchToCustomScheme();var V=this.parent,T=F.position(this.containerNode).w,S=V.getPalette(),X=V.addMarkerToMap(R/T),U=S.length;if(U===(X+1)){X--;}var Y=S[X+1],W=X===-1?Y:S[X];S.splice(X+1,0,Q.findMidColorHex(W,Y));V.update();},remove:function H(T){var S=this.parent.getComp(),R=this.parent.getPalette();S.splice(T,1);R.splice(T+1,1);},onclick:function O(S){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED&&S.getTarget()===this.domNode){var T=F.position(this.containerNode),R=S.e.clientX-T.x;this.addMarker(R);}},premousedown:function N(){this.parent.unselectAll();},createAvatar:function B(U,T){var S;for(S=0;S<this.children.length;S++){if(this.children[S].id===U.id){T.tgtNode=this.children[S];T.i=S;}}var R=U.cloneNode(true),V=document.createElement("div");I.addClass(V,"bar");R.appendChild(V);return R;},positionAvatar:function L(X){var R=this.avatar,T=R.style,V=this.restrictedToAxis,S=F.position(this.domNode),U=S.y;if(R){if(V!=="y"){var W=X.x;if(W<S.x){W=S.x;}if(W>S.x+S.w){W=S.x+S.w-1;}T.left=W-2+"px";}if(V!=="x"){T.top=U+"px";}}},isDragValid:function K(R){return R.src.node!==this.domNode;},ondragstart:function C(S){this._super(S);var R=this.parent.getComp();this.removeChildren(this.children[S.i]);R.splice(S.i,1);},ondragmove:function A(R){this._super(R);this.parent.editableBubble.showBubble(G.call(this,R));},ondragend:function E(T){var S=this.parent,R=S.addMarkerToMap(G.call(this,T));S.update();this.children[R].set("selected",true);this._super(T);},onmouseover:function P(S){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED&&!this._cursorAvatar){var V=document,U=this.domNode,T=this._cursorAvatar=V.createElement("div"),R=this._mouseMoveHandler=function(Z){var Y=F.eventTarget(self,Z),X=F.getMousePosition(Z,self),W=T.style;W.top=X.y+12+"px";W.left=X.x+12+"px";W.display=(Y===U&&mstrApp.isInteractive())?"block":"none";};V.body.appendChild(T);I.addClass(T,"mstrmojo-SimpleThresholdEditor add-cursor");F.attachEvent(U,"mousemove",R);}if(this._super){return this._super(S);}},onmouseout:function M(R){if(this.parent.sliderMode===mstrmojo.threshold.ThresholdModel.SLIDER_MODE.COLOR_BASED){F.detachEvent(this.domNode,"mousemove",this._mouseMoveHandler);var S=this._cursorAvatar;S.parentNode.removeChild(S);delete this._cursorAvatar;delete this._mouseMoveHandler;}if(this._super){return this._super(R);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");mstrmojo.VBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.VBox",markupString:'<table id="{@id}" class="mstrmojo-VBox {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo._Formattable","mstrmojo._HasToolbar");var B="\u001E";var F=1;var H=2;var I={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3,vert:["height","width","top"],horiz:["width","height","left"],updateStyle:function(K){var N=K.defn.qsm;if(!N){return ;}if(K.getFormats().width){return ;}var O=null;if(N==F){O=K.containerNode.firstChild;}else{O=K.containerNode.lastChild;}if(!O){return ;}var L=O.clientHeight+"px";var J=O.clientWidth+"px";var M=K.domNode.style;M.height=L;M.width=J;if(K.parent.updateStyle){K.parent.updateStyle(L,J);}},repositionChildren:function(P){if(!P.children){return ;}var O=P.getFormats(),N=parseInt(O.height,10),S=parseInt(O.width,10);var J=P.children,M=J[0].getFormats(),U=J[1].getFormats();var K=(P.defn.gp<this.LEFT),R=K?N:S,Q=K?S:N,T=this[(K?"vert":"horiz")];var L=Math.round(R*(P.defn.ga/100));M[T[0]]=L+"px";M[T[1]]=Q+"px";U[T[0]]=(R-L)+"px";U[T[1]]=Q+"px";if((P.defn.gp%2)===0){U[T[2]]=L+"px";}else{M[T[2]]=(R-L)+"px";}this.resizeChildren(J[0],J[1]);},stackChildren:function(J){var M=J.children,N=J.getFormats(),L;var K;for(K=M.length-1;K>=0;K--){L=M[K].getFormats();L.width=N.width;L.height=N.height;}this.resizeChildren(M[0],M[1]);},resizeChildren:function(L,J){L.renderPortalState();var K=J.getFormats();J.resizeForDisplayState(parseInt(K.height,10),parseInt(K.width,10),true);},changeVisibility:function(L,J){var O=L.children,N=L.defn.qsm,K=J&&(!N||L.viewMode===F),M=J&&(!N||L.viewMode===H);if(O&&O.length>0){if(O[0].visible!==K){O[0].set("visible",K);}if(O[1].visible!==M){O[1].set("visible",M);}}L.visible=J;},setViewMode:function G(K){var L=K.children,M=K.visible;if(K.defn.qsm&&L&&L.length>0){var J=K.viewMode;L[0].set("visible",(J==F)&&M);L[1].set("visible",(J==H)&&M);}},clearFormatCache:function C(K){var M=K.children;for(var L=0,J=M&&M.length||0;L<J;L++){M[L].clearCache();}}};mstrmojo.DocGridGraph=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._Formattable,mstrmojo._IsSelectorTarget],{scriptClass:"mstrmojo.DocGridGraph",markupString:'<div id="{@id}" k="{@k}" title="{@tooltip}" class="mstrmojo-DocGridGraph" style="{@domNodeCssText}"><div class="mstrmojo-DocGridGraph-msg"></div><div class="mstrmojo-DocGridGraph-container"></div></div>',markupSlots:{msgNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.lastChild;}},formatHandlers:{domNode:["RW","B","background-color","fx","font"]},viewMode:null,visible:true,resize:function D(){this.clearCache();I.clearFormatCache(this);var L=this.getFormats(),J=parseInt(L.width,10),K=parseInt(L.height,10);if(J>0&&K>0){I.changeVisibility(this,true);if(!this.defn.qsm){I.repositionChildren(this);}else{I.stackChildren(this);}}else{I.changeVisibility(this,false);}},postBuildRendering:function A(){this._super();var L=this.node.data.eg;if(L===undefined){this.msgNode.style.display="none";this.containerNode.style.display="block";}else{this.msgNode.innerHTML=L;this.msgNode.style.display="block";this.containerNode.style.display="none";}var K=this.defn.qsm;if(!this.viewMode&&K){this.viewMode=K;}var J=this.node.defn;J.attachEventListener("qsmChange",this.id,function(M){this.viewMode=M.value;I.setViewMode(this);this.model.getDataService().setGridDisplayMode(this.k,this.viewMode,null,{cpmfig:{silent:true}});I.updateStyle(this);});I.setViewMode(this);I.updateStyle(this);},getGridWidget:function(){return this.children[0];},getGraphWidget:function(){return this.children[1];},updateGraph:function(K){var J=this.getGraphWidget();if(J){J.update(K);J.refresh();}},quickSwitch:function E(){var J=this.viewMode!=H;this.defn.set("qsm",(J?H:F));return true;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container");var A=mstrmojo.Widget;mstrmojo.Box=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Box",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:A.visibleMarkupMethod,onheightChange:A.heightMarkupMethod,onwidthChange:A.widthMarkupMethod}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.Container","mstrmojo._Formattable","mstrmojo._IsThresholdConditionTarget","mstrmojo.EnumRWUnitType");var TP_HTML_CONTAINER=mstrmojo.EnumRWUnitType.HTMLCONTAINER;var $DOM=mstrmojo.dom,$HASH=mstrmojo.hash;mstrmojo.DocTextfield=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsThresholdConditionTarget],{scriptClass:"mstrmojo.DocTextfield",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocTextfield {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click >{@v}</div>{@buttonNodeMarkup}</div>',markupSlots:{valueNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["T","z-index"],valueNode:["D","B","F","P","background-color","fx","text-align","white-space","overflow"]},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},update:function update(node){var d=node.data,v=d.v||"";if(node.defn.t===TP_HTML_CONTAINER){var div=document.createElement("div");div.innerHTML="<textarea>"+v+"</textarea>";v='<div style="display:none">&nbsp;</div>'+div.firstChild.value;div=null;}this.v=v;this.tooltip=d.tooltip||this.tooltip;if(this.thresholdId||d.tid){delete this.fmts;}this.thresholdId=d.tid;this.set("visible",!node.data.hidden);if(this._super){this._super(node);}},init:function(props){this._super(props);},postBuildRendering:function postBuildRendering(){var i,len;this.handleRotatedText();if(this.defn.t===TP_HTML_CONTAINER){var scripts=this.domNode.getElementsByTagName("script");for(i=0,len=scripts.length;i<len;i++){try{eval(scripts[i].innerHTML);}catch(err){console.log(err);}}}return this._super();},isTextFieldRotated:function isTextFieldRotated(){var formats=this.getFormats();return(formats.fx&&formats.fx.rt&&!$DOM.isDXIE&&$DOM.supports($DOM.cssFeatures.TEXT_ROTATION));},handleRotatedText:function handleRotatedText(){var formats=this.getFormats(),rotateValue=formats.fx&&formats.fx.rt;if(this.isTextFieldRotated()){var domNode=this.domNode,domNodeStyle=domNode.style;switch(rotateValue){case 1:domNodeStyle.left=(parseInt(formats.left,10)+domNode.offsetHeight)+"px";break;case 3:domNodeStyle.top=(parseInt(formats.top,10)+domNode.offsetWidth)+"px";break;}}},getAnchor:function getAnchor(){return this.valueNode;}});mstrmojo.DocSummaryTextfield=mstrmojo.declare(mstrmojo.DocTextfield,null,{scriptClass:"mstrmojo.DocSummaryTextfield",markupString:'<span id="{@id}" class="mstrmojo-DocSumTextfield {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><span class="mstrmojo-DocTextfield-valueNode" style="{@valueNodeCssText}" mstrAttach:click >{@openLink}{@v}{@closeLink}</span>{@buttonNodeMarkup}</span>',formatHandlers:{domNode:["T","z-index"],valueNode:["D","B","F","background-color","fx","text-align","white-space","overflow"]},update:function update(node){this._super(node);if(this.v){var v=this.v,p1=new RegExp("&lt;bold&gt;","g"),p2=new RegExp("&lt;/bold&gt;","g");if(v.indexOf("&lt;empty/&gt;")>-1){this.v="";return ;}v=v.replace(p1,"<b>");v=v.replace(p2,"</b>");this.v=v;}},preBuildRendering:function preBuildRendering(){if(this._super){this._super();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.Container","mstrmojo._HasPopup");var D=function(){var F=this.opener;if(F.direction.toLowerCase()==="up"){this.domNode.style.top=-F.domNode.offsetHeight+"px";}};mstrmojo.DropDownButton=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DropDownButton",height:"19px",text:"",direction:"down",enabled:true,title:"",markupString:'<div id="{@id}" class="mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode">{@text}</div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.firstChild.firstChild;},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onheightChange:function(){this.boxNode.style.height=this.height||"";},ontextChange:function(){this.iconNode.innerHTML=this.text;},ontitleChange:function(){this.boxNode.title=this.title;},onenabledChange:function(){mstrmojo.css[this.enabled?"removeClass":"addClass"](this.domNode,["disabled"]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},preBuildRendering:function B(){if(this._super){this._super();}var F=this.popupRef;if(F){if(F.nudge){F.nudge=mstrmojo.func.composite([F.nudge,D]);}else{if(this.direction.toLowerCase()!=="down"){F.nudge=D;}}}},popupRef:null,popupOpenConfig:null,destroy:function C(F){var G=this.popupRef;if(G&&G.hasRendered){G.destroy(false);}if(this._super){this._super(F);}},togglePopup:function E(){var F=this._lastOpened;if(F&&F.visible){this.closePopup();}else{this.openPopup("popupRef",this.popupOpenConfig);}},premousedown:function A(F){this.togglePopup();}});}());mstrmojo.requiresCls("mstrmojo.Container");mstrmojo.TBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TBox",markupString:'<table id="{@id}" class="mstrmojo-TBox {@cssClass}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}" style="{@cssText}"><tbody><tr><td></td></tr></tbody></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0];}},cellSpacing:0,cellPadding:0});(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo._HasLayout","mstrmojo._ShowsStatus");function E(J){var I=this.domNode,H=parseInt(this[J.toLowerCase()],10);return(isNaN(H))?I["offset"+J]:H;}mstrmojo.DocLayoutViewer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._HasScrollbox,mstrmojo._HasLayout,mstrmojo._ShowsStatus],{scriptClass:"mstrmojo.DocLayoutViewer",markupString:'<div id="{@id}" class="mstrmojo-DocLayoutViewer {@cssClass}" style="{@domNodeCssText}"><div></div><div><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_fh"></div><div id="{@id}_scrollboxNode" class="mstrmojo-DocLayoutViewer-layout" style="{@_scrollCssText}"></div><div id="{@id}_ff"></div></div><div></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}}},markupSlots:{groupBy:function(){return this.domNode.firstChild;},layout:function(){return this.domNode.childNodes[1].childNodes[2];},scrollboxNode:function(){return this.domNode.childNodes[1].childNodes[2];},containerNode:function(){return this.domNode.childNodes[1].childNodes[2];},incFetchNode:function(){return this.domNode.lastChild;},fixedHeaderNode:function(){return this.domNode.childNodes[1].childNodes[1];},fixedFooterNode:function(){return this.domNode.childNodes[1].childNodes[3];},_STATUS:function(){return this.domNode.childNodes[1].firstChild;},_STATUS_TXT:function(){return this.domNode.childNodes[1].firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.childNodes[1].firstChild.firstChild.firstChild;}},layoutConfig:{h:{groupBy:"auto",fixedHeaderNode:"auto",layout:"100%",fixedFooterNode:"auto",incFetchNode:"auto"},w:{layout:"100%"}},k:null,scrollboxHeightFixed:true,scrollboxWidthFixed:true,getHeight:function G(){return E.call(this,"Height");},getWidth:function B(){return E.call(this,"Width");},afterLayout:function A(){this._super();this.notifyScrollListeners();},preBuildRendering:function D(){if(this.parent){var J=this.parent[this.slot].style,I=this.height,H=this.width;this.height=(I!=="auto")?I:J.height;this.width=(H!=="auto")?H:J.width;}this.bs=this.model.bs;return this._super();},setSlotDimensions:function F(J,I,H){if(J==="layout"){this.scrollboxHeight=parseInt(I,10);this.scrollboxWidth=parseInt(H,10);}this._super(J,I,H);},onaddChild:function C(H){if(!isNaN(H.index)){var I=this.children[H.index];if(I&&I.slot==="groupBy"){this.docGroupBy=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.Container");var D="slot";mstrmojo.HBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.HBox",cellCssClass:"",cellSpacing:0,cellPadding:0,markupString:'<table id="{@id}" class="mstrmojo-HBox {@cssClass}" style="{@cssText}" cellspacing="{@cellSpacing}" cellpadding="{@cellPadding}">{@colHTML}<tr>{@tableHtml}</tr></table>',colHTML:"",markupSlots:{containerNode:function(){return this.domNode.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildRendering:function B(){this.tableHtml="";var N=[],F=this.children,K=(F&&F.length)||0,I;if(K){var G=0,J=this.cellCssClass?' class="mstrmojo-HBox-cell '+this.cellCssClass+'" ':"",M="<td "+J+"></td>";for(I=0;I<K;I++){N[G++]=M;F[I].slot=D+I;}this.tableHtml=N.join("");}this._super();if(K){var L={},H=this.containerNode.cells;for(I=0;I<K;I++){L["slot"+I]=H[I];}this.addSlots(L);}},addChildren:function E(K,F,G){if(!K){return K;}if(F===undefined||isNaN(F)||F<0){var J=this.children;F=(J&&J.length)||0;}var I=0,H;if(K.constructor===Array){for(I=0,H=K.length;I<H;I++){K[I].slot=D+(F+I);}}else{K.slot=D+F;}return this._super(K,F,G);},childRenderCheck:function C(G){if(G&&!G.hasRendered){var F=G.slot||this.defaultChildSlot;return !!this[F]||F.match(/^slot[\d]+$/);}return false;},onchildRenderingChange:function A(I){var F=(I&&I.src)||I,L=F&&F.domNode;if(L){var Q=F.slot;if(!this[Q]){var J=Q&&Q.match(/^slot([\d]+)$/);if(J){var O=parseInt(J[1],10),N=this.containerNode,P=N.cells,M=(P&&P.length)||0,K={};for(var H=M;H<=O;H++){var G=N.insertCell(H);K["slot"+H]=G;if(this.cellCssClass){G.className=this.cellCssClass;}}this.addSlots(K);}}}this._super(I);}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Widget","mstrmojo.css","mstrmojo.dom");var Y=mstrmojo.css,F=mstrmojo.dom;var Z={9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};function A(){var c=this.value,b=this.inputNode,d=b.value,a=(c!==null&&c!==undefined)?String(c):"";if(a!==d&&(!this.keepEmpty||d!==this.emptyText)){b.value=a;}if(b.mstrmojoEmpty){Y.removeClass(b,[this.emptyClass]);b.mstrmojoEmpty=null;}}function X(){var a=this.inputNode;a.value=this.emptyText||"";Y.addClass(a,[this.emptyClass]);a.mstrmojoEmpty=true;}function N(){var a=this.inputNode;if(a){this.readingDom=true;this.set("value",a.value);this.readingDom=false;}}function U(a){var b=this;if(a===-1){N.call(this);}else{if(this._lastTimeoutId){window.clearTimeout(this._lastTimeoutId);}this._lastTimeoutId=window.setTimeout(function(){delete b._lastTimeoutId;N.call(b);},a||100);}}mstrmojo.TextBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TextBox",value:"",type:"text",hint:"",readOnly:false,size:"",maxLength:"",cssDisplay:"inline",tabIndex:"",emptyText:"",keepEmpty:false,emptyClass:"mstrmojo-empty",valueChangeDelay:-1,textValid:true,autoComplete:true,autoCorrect:true,autoCapitalize:true,markupString:'<input id="{@id}" class="mstrmojo-TextBox {@cssClass}"  style="{@cssText}" title="{@tooltip}" type="{@type}" value="" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}"min="{@min}" max="{@max}" placeholder="{@hint}" mstrAttach:focus,keyup,blur,paste,cut,input,click,keydown  tstid="{@tstid}"/>',markupSlots:{inputNode:function D(){return this.domNode;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,oncssClassChange:function S(){this.inputNode.className="mstrmojo-TextBox "+(this.cssClass||"");},onhintChange:function O(){this.inputNode.setAttribute("placeholder",this.hint);},onenabledChange:function E(){var a=this.inputNode;a.disabled=!this.enabled;Y.toggleClass(a,"disabled",!this.enabled);},onvalueChange:function P(){var a=this.value,b=(a===undefined)||(a===null)||(a==="");if(b){if(!this.hasFocus){X.call(this);}else{this.inputNode.value="";}}else{A.call(this);}if(F.isIE9){this.inputNode.type=b?"text":this.type;}},ontooltipChange:function R(){this.domNode.title=this.tooltip;},onreadOnlyChange:function H(){this.inputNode.readOnly=this.readOnly;},ontextValidChange:function B(){Y.toggleClass(this.inputNode,["err"],!this.textValid);}},postBuildRendering:function V(){this._super();var a=this.inputNode;a.setAttribute("autocomplete",this.autoComplete?"on":"off");a.setAttribute("autocorrect",this.autoCorrect?"on":"off");a.setAttribute("autocapitalize",this.autoCapitalize?"on":"off");},focus:function Q(){if(this.inputNode&&this.inputNode.offsetParent){try{this.inputNode.focus();}catch(a){}}},prefocus:function M(){this.hasFocus=true;A.call(this);},blur:function T(){this.inputNode.blur();},preblur:function W(){window.setTimeout(function(){},200);this.hasFocus=false;N.call(this);var a=this.value;if(((a===null||a==="")&&this.emptyText)||(this.keepEmpty&&a===this.emptyText)){X.call(this);}},prekeyup:function I(b){var a=b.hWin,c=b.e||a.event;U.call(this,this.valueChangeDelay);var d=Z[c.keyCode];if(this["on"+d]){this["on"+d](b);}},preinput:function J(){U.call(this,this.valueChangeDelay);},prepaste:function K(){U.call(this);},precut:function G(){U.call(this);},setInvalidState:function C(a){this.set("textValid",true);if(a){this.domNode.setAttribute("title",a);}},cleanUp:function L(){this.inputNode.value="";this.set("textValid",false);this.domNode.setAttribute("title",this.tooltip);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren","mstrmojo._CanRenderDocOnScroll","mstrmojo._FillsBrowser");var D=29;function A(){var I=this.domNode,F=this.containerNode,L=F.style,K=F.clientWidth||parseInt(L.width,10),H=I.clientWidth||parseInt(I.style.width,10),E=I.parentNode,J=F.clientHeight||parseInt(L.height,10),G=E.clientHeight||parseInt(E.style.height,10);if(K<H){L.left=(H-K)/2+"px";}if(J<G){L.top=(G-J)/2+"px";}}mstrmojo.rw.DocLayout=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren,mstrmojo._CanRenderDocOnScroll,mstrmojo._FillsBrowser],{scriptClass:"mstrmojo.rw.DocLayout",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},popupNode:function(){return this.domNode.firstChild;}},alias:"docLayout",getHeight:mstrmojo.emptyFn,getWidth:mstrmojo.emptyFn,resizeOrReposition:mstrmojo.emptyFn,preserveChildDomOrder:false,postBuildRendering:function C(){var E=this._super(),F=this;if(mstrApp.features["is-document-center-align"]){window.setTimeout(function(){A.call(F);},10);}return E;},browserResized:function B(){if(this.hasRendered&&mstrApp.features["is-document-center-align"]){A.call(this);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.dom");var M=mstrmojo.Widget,G=mstrmojo.dom,N=mstrmojo.global.document,C=50,B=500;mstrmojo.Stepper=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Stepper",orientation:"vertical",provider:null,title:"",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text">{@itemHtml}</div><div class="prev">-</div></div>',markupSlots:{titleNode:function(){return this.domNode.firstChild;},nextNode:function(){return this.domNode.children[1];},textNode:function(){return this.domNode.children[2];},prevNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:M.visibleMarkupMethod,onheightChange:M.heightMarkupMethod,onwidthChange:M.widthMarkupMethod,onenabledChange:function I(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);}},preBuildRendering:function J(){this.itemHtml=this.provider.renderItemAt();this._super();},processEvent:function A(O){if(G.contains(this.textNode,O)||O===this.titleNode){return ;}var Q=this.provider,P=((O===this.nextNode)?"Next":"Prev");if(Q["has"+P]()){Q[P.toLowerCase()]();this.updateDisplayText();}},updateDisplayText:function E(){this.textNode.innerHTML=this.provider.renderItemAt();},startStepperInterval:function F(O,P){var Q=this;this._holdTimer=setInterval(function(){Q[P](O);},C);},stopStepperInterval:function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}},onclick:function L(O){this.processEvent(O.e.target);},onmousedown:function D(O){if(!this._holdTimer&&!this._startHoldTimer){var P=this;this._startHoldTimer=setTimeout(function(){delete P._startHoldTimer;P.startStepperInterval(O,"onclick");},B);G.attachOneTimeEvent(N,"mouseup",function(){if(P._startHoldTimer){clearTimeout(P._startHoldTimer);delete P._startHoldTimer;}P.stopStepperInterval();},true);}},onselectstart:function K(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._CanRenderChildrenOnShow");var A=mstrmojo.array;mstrmojo.StackContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._CanRenderChildrenOnShow],{scriptClass:"mstrmojo.StackContainer",isStack:true,markupString:'<div id="{@id}" class="mstrmojo-StackContainer {@cssClass}" style="{@cssText}"></div>',markupMethods:{onwidthChange:function(){if(!isNaN(parseInt(this.width))){this.domNode.style.width=this.width;}},onheightChange:function(){if(!isNaN(parseInt(this.height))){this.domNode.style.height=this.height;}},onborderChange:function(){this.domNode.style.border=this.border||"";},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{containerNode:function(){return this.domNode;}},_set_selected:function D(H,F){var G=this.selected;if(G===F){return false;}if(G){G.set("visible",false);}this.selected=F;if(F){F.set("visible",true);}return true;},addChildren:function B(J,G,H){var K=this.selected,L;for(var I=0,F=(J&&J.length)||0;I<F;I++){L=J[I];if(L&&L.set){L.set("visible",L===K);}}return this._super(J,G,H);},removeChildren:function C(H,F){var G=this._super(H,F);if(!H||(H===this.selected)){this.set("selected",null);}return G;},destroy:function E(F){this._super(F);this.selected=null;},renderMode:"onshow"});})();(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.dom");var B=mstrmojo.dom;mstrmojo.threshold.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,null,{scriptClass:"mstrmojo.threshold.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),cssClass:"adv-threshold",avatarCssCls:"mstrmojo-thresholdRow",markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass} mstrAttach:mousedown"><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span></div></div>",markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},preclick:function A(C){var F=null,E=B.eventTarget(C.hWin,C.e),D=this._super(C);if(B.contains(this.addConditionNode,E,true)){F="addCondition";}C.part=F||C.part;return D;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ConditionNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.dom","mstrmojo.css");var A=mstrmojo.dom,B=mstrmojo.css,D=mstrmojo.fe._IsRelationTreeNode.createSetHtml;mstrmojo.fe.ConditionNode=mstrmojo.declare(mstrmojo.ConditionNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.ConditionNode",emptyText:mstrmojo.desc(5893,"New Condition"),markupString:'<div id="{@id}" class="mstrmojo-cond mstrmojo-ConditionNode {@cssClass}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-cond-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-onhoverparent mstrmojo-cond-contents {@cssClass}"><span class="mstrmojo-textset mstrmojo-cond-text {@cssClass}" mstrAttach:click></span><span class="mstrmojo-cond-text-postfix {@cssClass}"></span><span class="mstrmojo-rel mstrmojo-cond-popupNode {@cssClass}"></span><span class="mstrmojo-onhover-bl mstrmojo-abs mstrmojo-topright mstrmojo-cond-tools {@cssClass}"><img class="mstrmojo-del" src="../images/1ptrans.gif" tooltip="'+mstrmojo.desc(7931,"Delete condition")+'" onclick="mstrmojo.all[\'{@id}\'].del()" /></span><span class="mstrmojo-add-cond" mstrAttach:click>'+mstrmojo.desc(1994,"Add Condition")+"</span>"+D+"</div></div>",getPrefixAndOrToolsMarkup:function(){return(D+this._super());},markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},condNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.childNodes[1].firstChild;},textPostfixNode:function(){return this.domNode.childNodes[1].childNodes[1];},popupNode:function(){return this.domNode.childNodes[1].childNodes[2];},createSetNode:function(){return this.domNode.childNodes[1].lastChild;},createSetOptNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;},addConditionNode:function(){return this.domNode.childNodes[1].childNodes[4];}},markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){B.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);},onnoRelationChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noRelation);},onnoCreateSetChange:function(){B.toggleClass(this.condNode,["noRelation"],this.noCreateSet);}},mstrmojo.hash.copy(mstrmojo.ConditionNode.prototype.markupMethods)),init:function(E){if(this._super){this._super(E);}var F=this.data&&this.data.et;if(F){this.set("noCreateSet",F===10||F===12);}},preclick:function C(E){var H=null,G=A.eventTarget(E.hWin,E.e),F=this._super(E);if(A.contains(this.createSetOptNode,G,true)&&!this.noRelationOperator&&!this.noRelation){H="createSetOpt";}else{if(A.contains(this.createSetNode,G,true)&&!this.noRelation){H="createSet";}else{if(A.contains(this.addConditionNode,G,true)){H="addCondition";}}}E.part=H||E.part;return F;},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.ImageToggle","mstrmojo._IsInputControl");mstrmojo.ToggleDIC=mstrmojo.declare(mstrmojo.ImageToggle,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ToggleDIC",init:function(A){this._super(A);this.unset=this.dic.ust;},focus:function(){this.domNode.focus();},onvalueChange:function(){},onblur:function(B){var A=B.e||B,C=this.domNode,D=mstrmojo.boxmodel.offset(C,document.body);if(A.clientX>D.left&&A.clientX<D.left+C.offsetWidth&&A.clientY>D.top&&A.clientY<D.top+C.offsetHeight){this.domNode.focus();}else{this.applyChanges();}},postBuildRendering:function(){if(this._super){this._super();}if(this.showByDefault){var A=this.openerStyle;this.width=A.iw;this.height=A.ih;this.set("imageList",this.dic.vls);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapperHoriz","mstrmojo.ListBuilder");mstrmojo.ListHoriz=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.ListHoriz",renderOnScroll:true,listMapper:mstrmojo.ListMapperHoriz,listBuilder:mstrmojo.ListBuilder,itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2");function B(E){var I=E.ctxtBuilder;if(I){var H=I.itemWidgets,G;for(G=H.length-1;G>-1;G--){var F=H[G];if(F){F.destroy(true);}}}}mstrmojo.WidgetListBase=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.WidgetListBase",unrender:function C(G){var I=this.ctxtBuilder;if(I){var H=I.itemWidgets,F;for(F=H.length-1;F>-1;F--){var E=H[F];if(E&&E.hasRendered){E.unrender(true);}}}this._super(G);},refresh:function A(E){B(this);if(this._super){this._super(E);}},destroy:function D(E){B(this);this._super(E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase2","mstrmojo.ListMapper","mstrmojo.ListBuilder","mstrmojo.ListSelector");mstrmojo.List=mstrmojo.declare(mstrmojo.ListBase2,null,{scriptClass:"mstrmojo.List",renderOnScroll:true,listMapper:mstrmojo.ListMapper,listBuilder:mstrmojo.ListBuilder,listSelector:mstrmojo.ListSelector,itemIdField:"dssid",itemField:"n",itemMarkup:null,itemMarkupFunction:null});})();(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.color","mstrmojo.css","mstrmojo.GridBase");var V=mstrmojo.css,M=mstrmojo.color,a=mstrmojo.css;function C(c,d){var e=c&&c.parent;while(e&&e.scriptClass.indexOf("DocPanelStack")===-1){if(d in e){return e;}e=e.parent;}return null;}function B(d){var c=document.createElement("img");d.appendChild(c);d.removeChild(c);}function E(c,d){var f=Math.floor(c/d.rowsPerPage),h=c%d.rowsPerPage,g=d.tableNode.tBodies[f],e=g.rows[h].cells;return e;}function H(){var c=this._renderTimer;if(c){self.clearInterval(c);delete this._renderTimer;this.renderingRows=false;}}mstrmojo.Grid=mstrmojo.declare(mstrmojo.GridBase,null,{scriptClass:"mstrmojo.Grid",rowsPerPage:0,effectiveRh:0,numPagesRendered:0,totalPages:0,pageStatus:null,_defaultPageHeight:0,renderPause:10,rhMin:14,defaultRowsPerPage:100,minRowsPerPage:50,init:function G(c){this._super(c);this.forceFixedSizes=true;},initPageSettings:function N(){var e=this.parent,c=this.defaultRowsPerPage,d=this.cp.getAvailableRowsCount();this.effectiveRh=this.rh||this.rhMin||1;this.effectiveRh=this.effectiveRh*e.model.docModel.getZoomFactor();if(e&&e.numRowFixed){c=d;}else{if(e&&e.scrollboxHeightFixed){c=Math.ceil(e.scrollboxHeight/this.effectiveRh);c=Math.max(c,this.minRowsPerPage);if(e.alwaysShowFirstBlockData&&d<c){c=d;this._shouldRenderNextPage=true;}}}this.pageStatus=[];this.rowsPerPage=c;this.initPageStatus(this.pageStatus);this._defaultPageHeight=this.rowsPerPage*this.effectiveRh;},initPageStatus:function Y(f){var e=this.rowsPerPage,c,h,d,g=function(l,m,j){var k=this;return function(){if(k._onDemand===undefined){k._onDemand=!l.isDataAvailable(m,j);}return k._onDemand;};};this.totalPages=(e&&Math.ceil(this.cp.rc/e))||0;f=f||this.pageStatus;for(c=0;c<this.totalPages;++c){h=c*e;d=h+e-1;if(!f[c]){f[c]={};}delete f[c]._onDemand;f[c].isOnDemand=g.call(f[c],this.cp,h,d);}},buildRendering:function F(){var c=false;if(this.renderMode==="vscroll"){this.initPageSettings();var g=this.pageStatus[0];c=g&&g.isOnDemand();this.start=0;this.end=-1;if(!c){this.end=Math.min(this.cp.rc,this.rowsPerPage)-1;}this.preRenderPages();this.preRenderPage(0,!c);}this._super();if(this.renderMode==="vscroll"){var f=this.parent,e=this,h=function(){e.gridContainerNode.style[a.MINHEIGHT]=(e.cp.rc*e.effectiveRh)+"px";};if(mstrmojo.dom.isIE7){this.gridContainerNode.style.zoom="1";window.setTimeout(h,10);}else{h();}if(!this.connectedScrollbox){if(f&&f.connectScrollbox){f.connectScrollbox(this);this.connectedScrollbox=true;}}this.postRenderPage(0,!c);this.postRenderPages();var d=f&&!f.scrollboxHeightFixed&&!f.numRowFixed;if(d&&this.numPagesRendered>=this.totalPages&&!c){this.postRenderingCleanup();}else{if(c||d||this._shouldRenderNextPage){this.onscroll();delete this._shouldRenderNextPage;}}}},preRenderPages:function Q(){},postRenderPages:function Z(){},configureActions:function L(){var c=this.parent;if(c&&c.configureActions){c.configureActions();}},preRenderPage:function O(c,d){this.pageNum=c;},postRenderPage:function J(d,f,g){if(d+1>this.numPagesRendered){this.numPagesRendered=d+1;}var c=this.pageStatus,e=c[d];if(!e){e=c[d]={};}if(f){e.filled=true;e.dirty=false;}var h=this.gridContainerNode.style;if(d===this.totalPages-1&&h){h[a.MINHEIGHT]="";}},invalidAllPages:function(){for(var c=0;c<this.totalPages;++c){var d=this.pageStatus[c];if(d.filled){d.dirty=true;}delete d._onDemand;d.filled=false;d.isDownloading=false;}this.thPosMap=[];this.posMap=[];},_startPageRenderThread:function b(c){var d=this.id;this.renderingRows=true;this._renderTimer=self.setInterval(function(){try{var g=mstrmojo.all[d];if(!g){return ;}var e=g.getPagesToRender(c);if(e.length>0){g.preRenderPages();g.renderPages(e);g.postRenderPages();g._postPagesClearup=true;}else{if(g._postPagesClearup){g.postRenderPagesCleanup();g.configureActions();g._postPagesClearup=false;}H.call(g);if(g.isRenderingComplete()){g.postRenderingCleanup();}}}catch(f){H.call(mstrmojo.all[d]);throw f;}},this.renderPause);},onscroll:function X(d,c){if(!this.renderingRows){if(d===true){var e=this.parent;if(e&&e.maskNode){V.addClass(e.maskNode,"wait");}}this._startPageRenderThread(c);}},isRenderingComplete:function P(){if(this.end>=this.cp.rc-1){for(var c=this.pageStatus,d=this.totalPages-1;d>-1;d--){if(!c[d]||!c[d].filled){return false;}}return true;}return false;},renderPages:function D(d){for(var e=0,c=d.length;e<c;++e){this.renderPage(d[e].idx,d[e].fill);}},renderPage:function W(l,e){var q=this.pageStatus,h=(this.numPagesRendered>=l+1);if(h){if(!e||(q[l]&&q[l].filled)){return ;}}var o=this.rowsPerPage,j=this.domNode;this.start=l*o;this.end=Math.min(this.start+o,this.cp.rc)-1;this.preRenderPage(l,e);var d=this.tempTable;if(!d){d=this.tempTable=j.ownerDocument.createElement("div");}var n=this.tableNode,m=this.start,f=this.end,k=e?this.buildTableRowsMarkup(m,f,'<table><tbody n="'+this.pageNum+'">',"</tbody></table>",n.style.tableLayout).join(""):'<table><tbody n="'+this.pageNum+'"><tr><td style="height:'+(this.effectiveRh*(this.end-this.start+1))+'px">&nbsp;</td></tr></tbody></table>';d.innerHTML=k;var g=d.firstChild.tBodies[0];if(!h){n.appendChild(g);}else{n.replaceChild(g,n.tBodies[l]);}if(e){this.markPages(m,f);}this.postRenderPage(l,e,g);var c=this.parent;if(c.onPageRendered){c.onPageRendered(g,l,h,e);}},getPagesToRender:function S(t){var q=[],v=this.parent,AF=this._defaultPageHeight,g=null,AG=this.pageStatus,AH=this;function l(j){var m=AG[j];if(m&&(m.filled||m.dirty)){if(!m.height){if(!g){g=AH.tableNode.tBodies;}m.height=g[j].offsetHeight;}return m.height;}else{return AF;}}var k=0,h=null,r=null,d=v.scrollboxTop;for(var AB=0,AC=this.totalPages,c=this.pageStatus;AB<AC;AB++){k+=l(AB);if(k>=d){h=AB;break;}}if(h===null){h=r=AC-1;}else{var u=v.scrollboxBottom;if(isNaN(u)&&v.numRowFixed){u=d;}for(var AA=h+1;AA<AC;AA++){if(k>u){r=AA-1;break;}k+=l(AA);}}if(r===null){r=AC-1;}for(var w=this.numPagesRendered;w<h;++w){q.push({idx:w,fill:false});}var z=0,AD=this.rowsPerPage,o=false;for(var x=h;x<=r;++x){var AE=AG[x];if(!AE||!AE.filled){if(AE&&AE.isOnDemand()){o=true;if(!AE.isDownloading&&!this.isDownloading){z+=AD;AE.isDownloading=true;this.isDownloading=true;var f=x*AD,e=f+AD-1;this.cp.download(f,e,t);}q.push({idx:x,fill:false});}else{q.push({idx:x,fill:true});}}}if(o){this.parent.showDownloadStatus(z);}else{if(this.parent.closeDownloadStatus){this.parent.closeDownloadStatus();}}return q;},addHilitePosition:function(d,f,c){var g=this.hiliteCellsMap[d];if(!g){this.hiliteCellsMap[d]={pos:[],nodes:[]};}var e=f-(this.pageNum||0)*this.rowsPerPage;this.hiliteCellsMap[d].pos.push({row:e,cell:c,page:this.pageNum});},setHilites:function(f,g){var h=g.getAttribute("ei"),j=this.eiMap[h],c=this.getNodesByPositions(j);if(!c.length){this._super(f,g);return ;}for(var e=0,d=c.length;e<d;e++){this._super(f,c[e]);}},addExtraInfoMap:function(d,e,c){if(!this.eiMap[d]){this.eiMap[d]=[];}this.eiMap[d].push(this.getPosObj(e,c));},addPositionMap:function(d,e,c){if(!this.posMap[d]){this.posMap[d]=this.getPosObj(e,c);}},addTitleHeaderPositionMap:function(e,c,d){var f=this.getPosObj(e,c);f.obj=d;this.thPosMap.push(f);},getPosObj:function(e,g){var f=this.pageNum||0,d=this.rowsPerPage||0;return{row:e-f*d,cell:g,page:f};},getNodeByPosition:function(c){return this.tableNode.tBodies[c.page].rows[c.row].cells[c.cell];},getRowIdxByCell:function(c){var d=this.posMap[c._ei];return d.page*this.rowsPerPage+d.row;},getNodesByPositions:function(l){var h=[];for(var f in l){var n=l[f],e=(n&&n.page)||0,d=n&&n.row,j=n&&n.cell,g=this.tableNode.tBodies[e],k=g&&g.rows[d],m=k&&k.cells[j];if(m){h.push(m);}}return h;},getPageHeight:function R(c){var d=this.tableNode.tBodies;return(d&&d[c]&&d[c].offsetHeight)||0;},getTargetCell:function(l,k){var f=0,d=0,g;for(g=this.totalPages;d<g;d++){f+=this.getPageHeight(d);if(k<=f){break;}}var e=this.tableNode.tBodies[d];if(e){for(d=0,g=e.rows.length;d<g;d++){var o=e.rows[d];for(var c=0,n=o.cells.length;c<n;c++){var m=o.cells[c];if(m.offsetTop+m.offsetHeight>=k){if(l>=m.offsetLeft&&l<=m.offsetLeft+m.offsetWidth){return m;}}else{break;}}}}},postRenderPagesCleanup:function I(){var e=this.parent;if(e&&e.gridData&&e.gridData.afc){var d=this.tableNode;if(d&&(this.lastWidth!==d.offsetWidth)){if(e.onGridWidthChanged){e.onGridWidthChanged();}mstrmojo.array.forEach(this.pageStatus,function(f){delete f.height;});this.lastWidth=d.offsetWidth;}var c=C(e,"adjustAutoWidth");if(c){c.adjustAutoWidth(e);}}if(e.gridPagesRendered){e.gridPagesRendered();}if(mstrmojo.dom.isIE&&!mstrmojo.dom.isIE8){B(this.domNode);}if(e&&e.maskNode){V.removeClass(e.maskNode,"wait");}this.hightLightChangedCells();},hightLightChangedCells:function K(){var m=this.cp.getUpdatedRows(),h=this,l,d,k,n,f,g,j,e=[];if(m){mstrmojo.hash.forEach(m,function(o,c){j=parseInt(c,10);l=h.cp.getRowCells(j);d=E(j,h);k=d.length;n=l.length-1;if(n>=0){for(f=k-1;f>=0;f--){g=d[f];if(n<0){break;}if(l[f]._d){var q=g.style.backgroundColor,p=g.style.color;e.push({dom:g,bgcolor:q,ftcolor:p});g.style.backgroundColor=M.getHighlightColor(M.rgbStr2rgb(a.getStyleValue(g,"backgroundColor"),true));g.style.color=M.getContrastingColor(M.rgbStr2hex(a.getStyleValue(g,"backgroundColor")),"#ffffff","#000000");delete l[f]._d;}n--;}}});if(e.length>0){window.setTimeout(function(){mstrmojo.array.forEach(e,function(c){c.dom.style.backgroundColor=c.bgcolor;c.dom.style.color=c.ftcolor;});},300);}}},postRenderingCleanup:function A(){var d=this.parent;if(d&&this.connectedScrollbox){d.disconnectScrollbox(this);}this.connectedScrollbox=false;if(d&&!d.scrollboxHeightFixed){var e=C(d,"performCanGrowCanShrink");if(e){e.performCanGrowCanShrink([d],true);}}},getRowInfoByPosition:function(c){return this.cp.getRowCellInfo(c);},unrender:function U(c){H.call(this);if(this.connectedScrollbox){this.parent.disconnectScrollbox(this);this.connectedScrollbox=false;}this.numPagesRendered=0;this.lastWidth=0;this.isDownloading=false;this.unMarkAllPages();this._super(c);},dataDownloaded:function T(){this.isDownloading=false;this.initPageStatus();this.onscroll();}});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.dom","mstrmojo.func","mstrmojo.vi.controllers.UICmdMgr");var R=mstrmojo.func,N=mstrmojo.hash,K=mstrmojo.array,H=mstrmojo.vi.controllers.UICmd.STATES,F={SHARED:0,SEPARATE:1},I={AND:19,OR:20},X=function X(b,a){var Y={},Z=function(e,d){var c=[];if(!d){return e;}K.forEach((d||[]),function(f){c.push(f);});K.forEach((e||[]),function(g){var f=K.find(d,"id",g.id);if(!~f){c.push(g);}});return c;};N.forEach(a,function(c,d){Y[d]=c;});N.forEach(b,function(c,d){Y[d]=Z(c,a[d]);});return Y;},D=function D(Y){var Z=[];N.forEach(Y,function(a){Z.push({ft:I.AND,d:a});});return Z;},G=function(Z){var Y={},a=function(b){var c=N.keyarray(b)[0];return{id:c,d:b[c][0]};};N.forEach(Z,function(e){var d={},b=a(e),c=d[b.id];if(b.id){if(!c){d[b.id]=c=[];}c.push(b.d);}Y=X(Y,d);},this);return[{ft:I.OR,d:Y}];},C=function C(e){var a=this.model,d,c=[],Z=this.getSelectionType(),Y=mstrmojo.vi.ui.rw.SelectionType,f=true,b=false;if(!N.isEmpty(e)){if(Z===Y.METRICS){d=D.call(this,e);}else{d=G.call(this,e);}}N.forEach(d,function(g){f=false;var h=[];N.forEach(g.d,function(j,n){if(a.supportsViewFilterActions(n)){b=true;var k=[],m={id:n,elems:k},l=a.getObjectInfo(n);if(l){m.t=l.t;m.st=l.st;if(l.st===12033){m.attId=l.attId;}}K.forEach((j||[]),function(o){k.push(o.id);});h.push(m);}});if(h.length){c.push({ft:g.ft,d:h});}});c.hasElements=b;c.clearSelections=f;return c;},U=function U(b){var c=this.selectorControl,Z,Y,a=this;if(c){if(b.clearSelections||b.hasElements){Z=this.controller;c.exp=null;if(Z.onGridSelector){Y=function(){Z.onGridSelector(a,{type:mstrmojo.EnumRWUnitType.GRID,ck:c.ck,tks:c.tks,ctlKey:c.ckey,sliceId:this.sid,isUConDS:c.isUConDS,ct:c.ct,selections:b});};if(this.multiUnitCtrlInterval){window.clearInterval(this.multiUnitCtrlInterval);this.multiUnitCtrlInterval=null;}if(Z.cmdMgr.state===H.BUSY){this.multiUnitCtrlInterval=window.setInterval(function(){if(Z.cmdMgr.state!==H.BUSY){window.clearInterval(a.multiUnitCtrlInterval);if(!a.destroyed){a.multiUnitCtrlInterval=null;Y();}}},1000);}else{Y();}}}}},B=function B(a){var Y={type:mstrmojo.vi.ui.rw.SelectionType.ATTS,data:a},Z=function(b,c){if(parseInt(b.fn,10)===22&&parseInt(c,10)===19){Y.type=mstrmojo.vi.ui.rw.SelectionType.METRICS;}K.forEach((b.nds||[]),function(d){Z(d,b.fn);});};Z(a,null);return Y;},V=function V(){return this.parent.model.getCurrentLayoutDef().cgbMap;},J=function J(){var Y=V.call(this),Z=[];N.forEach(Y,function(b,a){if(this.k===b){Z.push(a);}},this);return Z;},W=function W(){var Y=this.controller&&this.controller.cmdMgr;if(Y&&Y.isUndoRedo()){return true;}return false;};mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",{_mixinName:"mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl",selectorControl:null,multiUnitCtrlInterval:null,postBuildRendering:function S(){this._super&&this._super();var Y=this.findSelectorControl();if(W.call(this)){this.clearSelections();}if(Y&&!N.isEmpty(Y.exp)&&this.addSelectionsFromExpression){this.addSelectionsFromExpression(B(Y.exp));if(this.highlight){this.highlight(this.getSelectionType(),this.getSelectionHash(),true);}}},findSelectorControl:function Q(){if(this._super){return this._super();}else{this.throwAbstractMethodError("findSelectorControl");}},handlesMultiSelection:function E(Y){return(this._super&&this._super(Y))||!!this.selectorControl;},onSelectionChange:function L(Z){var b=(this.model.getSelectorControlMapInfo?this.model.getSelectorControlMapInfo():[]),a=false;if(this._super){a=this._super(Z);}if(b.length>0){this.singleUnitSelect();a=true;}else{if(!!this.selectorControl){var Y=C.call(this,Z);U.call(this,Y);return true;}}return a;},singleUnitSelect:function A(){if(this._super){this._super();}},clearAllSelections:function P(){return this.selectorControl&&this.selectorControl.showall;},onClearBrushing:function T(Y){if(this.selectorControl){return true;}if(this._super){return this._super(Y);}return false;},getFilterType:function M(){return this.defn.ins||F.SHARED;},switchFilterType:function O(j){var f=this,h,g=f.getFilterType(),d=f.parent.model,c,b={actions:[]},k,a=V.call(f),Y,e=false;if(g!==j){h=J.call(f);if(h.length>0&&g===F.SHARED){k=h[0];c=d.getSourceControls(f.parent,k);K.forEach(c,function(m,n){if(n!==0){Y=d.getNextKey();a[Y]=f.k;b.actions.push(d.redoFilterAssociations(true,m.control.ckey,m.sourceKey,f.k,k,Y));e=true;}}.bind(f));}else{var Z;K.forEach(h,function(m,n){c=d.getSourceControls(f.parent,m);if(n===0){Z=m;}else{delete a[m];b.actions.push(d.redoFilterAssociations(false,c[0].control.ckey,c[0].sourceKey,f.k,m,Z));e=true;}}.bind(f));}b.actions.push(d.getUnitFormatAction(f,1,{FormattingSelector:{IndependentNodeSelector:j}},true));var l=false;b.callback=({success:function(){f.defn.ins=l?g:j;l=!l;}});if(e){b.callback=R.wrapMethods(b.callback,d.getRebuildCallback());}}b.extras={style:{params:{treesToRender:3}}};return b;}});}());(function(){mstrmojo.requiresCls("mstrmojo.XtabModel","mstrmojo.array","mstrmojo.func","mstrmojo.hash","mstrmojo.elementHelper");var q="Metrics",E=2,Z=mstrmojo.array,H=mstrmojo.hash,T=mstrmojo.elementHelper;function P(AE){if(!AE){return false;}var AC=this.scm,x="\u001E",AA,w,AB,z,v,AD=false;for(w in AC){AB=AC[w];z=AB.cgb;for(AA in z){v=AE[z[AA]];if(v){if(!AB.tks){AB.tks=v;AD=true;}else{if(AB.tks&&(AB.tks.indexOf(v)<0)){AB.tks+=x+v;AD=true;}}}}}return AD;}function d(){var w=this.data,v=w.gts;if(!v){return ;}var x;Z.forEach([v.row,v.col],function(z){Z.forEach(z,function(AA){if(AA.sc){x=x||{};x[AA.id||q]=AA.sc;if(AA.fid){x[AA.id+"_"+AA.fid]=AA.sc;}}});});this.scm=x;P.call(this,this.docModel.getCGBMap());}function u(v,w){var x=this.getDataService();x[v].apply(x,w);}function R(AC,AD,AL){var AB=AD||T.getIdPresentation(AC),AK,AI;switch(AB){case"terse":case"terseLong":AK=AC.substring(1,AC.length).split(";");return"h"+AK[0]+";"+AK[1]+(AL?";"+AL:"");case"old":AC=AC.replace(/\*:/g,"*COLON*");AK=AC.split(":");return("h"+AK[1]+(AK[2]?":"+AK[2]:"")+";"+AK[0]+(AL?";"+AL:"")).replace(/\*COLON\*/g,"*:");case"oldLong":var AF=0,v,AJ,AH=[],AE=[],AA,z,x,AG=function AG(){if(AF<0){return null;}var AO=false,AM=-1,AP,AN=null;for(AA=AF;AA<AC.length;AA++){AP=AC.charAt(AA);if(AP==="*"&&!AO){AO=true;}else{if(AP===":"&&!AO){AM=AA;break;}else{AO=false;}}}if(AM===-1){AN=AC.substring(AF);AF=-1;}else{AN=AC.substring(AF,AM);AF=AM+1;}return AN;};x=AG();if(x!=="BB"&&x!=="BF"){return AC;}AI=AG();if(x==="BF"){AI=AG();}v=parseInt(AG(),10);AJ=parseInt(AG(),10);for(z=0;z<AJ;z++){AE[z]=parseInt(AG(),10);AG();}for(z=0;z<AJ;z++){var w=AG();if(AE[z]<v&&AE[z]>=0){AH[AE[z]]=w;}}return"h"+AH.join(":")+";"+AI+(AL?";"+AL:"");}return AC;}mstrmojo.DocXtabModel=mstrmojo.declare(mstrmojo.XtabModel,null,{scriptClass:"mstrmojo.DocXtabModel",docModel:null,init:function m(v){this._super(v);var w=this;this.docModel.attachEventListener("CGBMapChange",this.id,function(x){if(w.xtab.onCBGMapChange){w.xtab.onCGBMapChange(x);}});},ondataChange:function g(){d.call(this);},getMessageId:function F(){return this.docModel.mid;},getDataService:function G(){return this.docModel.getDataService();},getAction:function X(AK,AA,AF){var AI=AK[0],w=AI&&AI.at;var z;if(w){if((w&E)>0){var x=this.getCellTitleInfo(AI),AG=x&&x.title,v=AG&&AG.id,AH=this.scm;this.sti={titleId:v||q};var AE=(v&&AH[v])||AH[q],AD=function(){var AL=[];Z.forEach(AK,function(AM){if(AM._e&&AM._e.id){AL.push(AM._e.id);}});return AL.join("\u001E");};if(AE){var AJ=this.xtab,AB=(AJ.allowToggleSelections&&AE.all&&AF),AC=(x.isSrcTitle||AB);this.sti.deselectCurrent=AB;z={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:AA,ck:AE.ck,tks:AE.tks,eid:AC?"OA:(All)":AD(),ctlKey:AE.ckey,sliceId:AJ.sid,isUConDS:AE.isUConDS,ifw:AE.ifw}};}}}if(!z){z=this._super(AK);}if(z&&z.a){z.a.sliceId=this.xtab.sid;}return z;},getDownloadAction:function k(AA,x,AC,z,AB,w,v){var AD=this._super(AA,x,AC,z,AB,w);AD.sliceId=this.xtab.sid;if(v&&v.name==="TransactionUpdates"){if(AD.partialUpdate){if(AD.partialUpdate.selectors){AD.partialUpdate.selectors.push(v.ctlKey);}else{AD.partialUpdate.selectors=[v.ctlKey];}}else{AD.partialUpdate={selectors:[v.ctlKey]};}}return AD;},getDrillAction:function f(w,z){var x=this._super(w,z),v=this.getCellTitleInfo(w[0]);if(x&&x.isWithin){x.attrObj=v.title;}x.srcMsgId=this.docModel.mid;return x;},sort:function o(w,x){var v=this.xtab;w.stp=w.stp||this.getSubTotalsPos();w.subTotalsPos=w.stp;w.nodeKey=v.k;w.treeType=v.treeType||1;u.call(this,"sortGrid",arguments);},getAdvSortData:function Q(v,w){u.call(this,"getAdvSortData",arguments);},pivot:function I(v,w){u.call(this,"pivot",arguments);},removeUnit:function O(v,w){u.call(this,"removeUnit",arguments);},getTotalsAction:function J(v,z,w){var x=this.getPivotAction(v);x.act="showTotals";x.subtotalType=z;x.clearSubtotalType=w;return x;},getRemoveAxisTotalsAction:function b(w,v){return{act:"removeAxisTotals",axis:v,subtotalType:w};},showTotals:function B(v,w){u.call(this,"showTotals",arguments);},drillGrid:function W(v,w){u.call(this,"drillGrid",arguments);},downloadGridData:function c(v,w){u.call(this,"downloadGridData",arguments);},loadLayout:function a(v){this.docModel.loadLayout(v);},resizeXtabColumn:function L(v,w){u.call(this,"resizeXtabColumn",arguments);},submitTemplateActions:function n(v,w,x){u.call(this,"submitTemplateUpdates",arguments);},getDerivedMetricAction:function h(v,w){return{did:v._e.oid,um:v.um,alias:v._e.n,n:v._e.n,v:v.um?v.formula:v._e.v,mix:v.mix,cmd:w,model:this};},getAddTemplateUnitAction:function C(AA,AC,x,v){var w=AA.t,AB=this.data.gsi,z={act:"addUnit",unitId:AA.did,unitType:w,unitPos:++v,dsId:AC,isFirst:!AB||(AB.cols.length===0&&AB.rows.length===0)};if(w!==4||!AB||!AB.mx.length){z.axis=x;}return z;},getRemoveTemplateUnitAction:function l(v){return{act:"removeUnit",unitId:v.did||v.id,unitType:v.t||4};},getRenameTemplateUnitAction:function l(AA,x,v,w){var z={act:"renameUnit",id:AA,type:x,name:v};if(w){z.isDynamicAlias=true;}return z;},doesNameExistOnTemplate:function A(x,AC,AA,w){var AB=x.node.data.gsi,v=AA===4,z=v?AB.mx:AB.rows.concat(AB.cols);return z.some(function(AD){return AD.did!==AC&&(v||AD.t===AA)&&AD.n===w;});},getPivotUnitAction:function M(x,v,z,w){v++;return{act:"pivot",unitId:String(z||""),unitType:w||"",axis:x,unitPos:v};},getShowTotalsUnitAction:function U(z,w,x,v){return{act:"showTotals",unitId:String(z||""),unitType:w||"",subtotalType:x,clearSubtotalType:v};},getSortGridAction:function p(z,w,x,v){return{sortKey:w,subTotalsPos:z,axis:x,isAsc:v};},getColumnResizeAction:function N(z,v,w,x,AA){return{act:"changeXtabColumnWidth",unitId:z,unitType:v,width:w||0,depth:x||1,ec:AA};},getNormalizedFormElementId:function t(w,v){return R(w,null,v);},compareNormalizedElementsId:function j(w,v){if(w===v){return true;}else{if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}if(T.isAttributeIdsLinked(T.getAttributeId(w),T.getAttributeId(v),this.docModel.als&&this.docModel.als.idLinks||{})){return T.getElementValue(w)===T.getElementValue(v);}}return false;},compareElementsId:function S(AA,z){if(!this.docModel.als){return this.compareElementsIdInSingleGrid(AA,z);}var x=T.getIdPresentation(AA),w=T.getIdPresentation(z),v=R(AA,x),AB=R(z,w);return this.compareNormalizedElementsId(v,AB);},compareElementsIdInSingleGrid:function Y(z,x){var w=T.getIdPresentation(z),v=T.getIdPresentation(x);if(w!==v||w==="oldLong"||w==="terseLong"){return R(z,w)===R(x,v);}return z===x;},getLinkedAttributes:function e(v){var w=[],x;if(this.docModel.populateAttributeIdLinkInfo){this.docModel.populateAttributeIdLinkInfo();}x=this.docModel.als&&this.docModel.als.idLinks||{};return x[v];},getCellDataUnion:function V(x){var z=this,w=x.hasOwnProperty("mix"),AA=[],AB,v=function v(AD){var AC=z.getCellTitleInfo(AD),AF=AC.title,AE=AF&&AF.id;if(AE){AB={};if(AD.stt){AB.isSubtotal=true;}AA.push(H.copy(AB,{tid:AE,eid:AD._e&&AD._e.id,v:AD.v}));}};if(x){if(!w){v(x);}else{Z.forEach([x._lp,x._tp],function(AC){var AD=AC;while(AD&&AD!==AD._p){v(AD);AD=AD._p;}});}}return AA;},getObjectInfo:function D(v){var w;Z.forEach((this.data.gsi.cols||[]).concat(this.data.gsi.rows||[]),function(x){if(x.did===v){w=x;}});return w;},supportsViewFilterActions:function K(v){if(this.data&&this.data.gsi){var w=this.getObjectInfo(v);return w&&!w.de&&(w.t!==1)&&(w.t!==47||w.st===12033);}return false;},getSelectorControlMapInfo:function r(){var w=[],z=this.data.gsi,x=[],v;if(this.scm){H.forEach(z,function(AA){if(AA instanceof Array){x=x.concat(AA);}});H.forEach(this.scm,function(AB,AA){v=Z.find(x,"did",AA);if(v!==-1){w.push({did:AA,n:x[v].n,sc:AB});}});}return w;},getShowDefinedSubtotalsAction:function(){return{act:"showDefinedSubtotals"};}});}());(function(){mstrmojo.requiresCls("mstrmojo.GridBase","mstrmojo.Grid");mstrmojo.XtabZone=mstrmojo.declare(mstrmojo.Grid,null,{scriptClass:"mstrmojo.XtabZone",markupString:'<div id="{@id}" class="mstrmojo-XtabZone" style="position:relative;{@cssText}"></div>',markupSlots:{gridContainerNode:function(){return this.domNode;}}});}());(function(){mstrmojo.XtabCP=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.XtabCP",base:null,lookupBase:null,colWidths:null,forceAutoRowHeight:false,startIndexInContainer:0,updatedRows:null,preServeUpdatedRows:true,init:function K(L){mstrmojo.hash.copy(L,this);},initContent:function D(O){this.startIndexInContainer=O||this.startIndexInContainer||0;var N=this.base||[],M=N.show,L=N.items;this.rc=M&&L?L.length:0;this.colWidths=(M&&N.cws)||[];this.isDownloading=false;this.isDownloaded=true;this.invalidData=false;},isDataAvailable:function B(M,L){return !this.invalidData;},download:function A(N,M,L){if(!this.isDownloaded&&!this.isDownloading&&this.dataSource){this.isDownloading=true;this.dataSource.download(0,L);}},invalid:function E(){this.invalidData=true;this.isDownloading=false;this.isDownloaded=false;this.preServeUpdatedRows=true;if(this.gridData){this.oldGridData=this.gridData;this.oldBase=this.base;this.updatedRows={};}},getRowHeight:function C(){return this.gridData.rh;},getNumAutoHeightRows:function(){return this.forceAutoRowHeight?this.rc:0;},getAvailableRowsCount:function J(){return this.rc;},getUpdatedRows:function H(){return this.updatedRows;},getRowCells:function(d){var V=this.base||[],R=V.items||[],f=R[d]||[],T=f.items,h=this.lookupBase,Y=this.interactiveCellsArray,g=this.gridData.css,m=this.gridData.gsi,Z=m&&m.prop&&m.prop.cols&&m.prop.cols.mg,k=null,U,b,Q,j,o,P,c,O,S,N,a="-1";if(this.oldGridData){U=this.oldBase;b=U&&U.items;Q=b[d]&&b[d].items;}for(o=0,j=(T&&T.length)||0;o<j;o++){P=T[o];if(P){P.v=P.v||P.n;if(h&&!P._e){c=h[P.tui];O=P.fi;S=(c&&c.fs)||[];N=S[O]||S[0];P.ts=P.ts||N&&N.bftp;k=c&&c.es[P.idx];if(k){P.v=P.v||k.n;if(k.rv){P.rv=k.rv;}P._e=k;}}if(!P.css){var t=P.cni;if(t!==undefined){P.css=g[t].n;}else{P.css="";}}if(!P._d&&Q&&this.preServeUpdatedRows){var M=Q[o];if(!M||(M.rs!==P.rs)){this.preServeUpdatedRows=false;this.updatedRows={};}else{if((M.v&&P.v!==M.v)){var q={};if(P.v!==M.v){q.v=M.v;}if(P.css!==M.css){q.css=M.css;}P._d=q;this.updatedRows[this.startIndexInContainer+d]=true;}}}P._gd=this.gridData._bidx||0;if(Y){if(P._ei===undefined||Y[P._ei]!==P){P._ei=Y.push(P)-1;}}if(this.axis){P.axis=this.axis;}var l=P.pi,W=function W(r,e){var u=h&&h[r];return u&&u.es[e];},X=function X(u,r,v){var e=u[r].items[v];if(e&&e._e===undefined){e._e=W(e.tui,e.idx);}return e;};if(l){if(l.ri!==undefined&&l.ci!==undefined){if(P.axis===2&&Z!==a){P._p=R[l.ri].items[o];}else{P._p=R[l.ri].items[l.ci];}}else{var p=this.gridData.ghs,n=l.left,L=l.top;if(n){P._lp=X(p.rhs.items,n.ri,n.ci);}if(L){P._tp=X(p.chs.items,L.ri,L.ci);}}}}}return T;},getUnmergedCells:function F(M){var Q=[];rows=(this.base&&this.base.items)||[];if(M>rows.length-1||M<0){return Q;}var O=this.gridData.css,L=rows[M].items[0],R=L&&L.pi,P=R&&R.ri,S=R&&R.ci;while(R&&P>-1&&S>-1){L=L._p||rows[P].items[S];var N={};mstrmojo.hash.copy(L,N);if(!N.css){N.css=O[N.cni].n;}N.rs=L.rs-M+P;Q.splice(0,0,N);R=L&&L.pi;P=R&&R.ri;S=R&&R.ci;}return Q;},getIndentPadding:function I(L){return L*14;},getCell:function G(L,M){var N=this.base.items;return N[L].items[M];}});}());(function(){mstrmojo.XtabVACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabVACP",cps:[],initContent:function G(L){this.startIndexInContainer=L||0;this.rc=0;this.type=0;this.colWidths=[];var J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];K.initContent(this.startIndexInContainer+this.rc);this.rc+=K.rc;this.type|=K.type;var I=K.colWidths;if(I&&(I.length>this.colWidths.length)){this.colWidths=I;}}},getNumAutoHeightRows:function(){return this.cps[0].getNumAutoHeightRows();},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getRowCells(I);},getUnmergedCells:function(I){var J=0,K=this.cps[J];while(I>=K.rc){I-=K.rc;K=this.cps[++J];}return K.getUnmergedCells(I);},getCell:function(I,K){var J=0,L=this.cps[J];while(I>=L.rc){I-=L.rc;L=this.cps[++J];}return L.getCell(I,K);},isDataAvailable:function D(L,K){var J=this._getCPs(L,K),I;for(I=0;I<J.length;++I){if(!J[I].isDataAvailable(L,K)){return false;}}return true;},getAvailableRowsCount:function F(){var K=0,I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(J.isDataAvailable()){K+=J.getAvailableRowsCount();}}return K;},_getCPs:function H(N,L){var J=0,M=this.cps[J],I=M&&M.startIndexInContainer,K=[];if(M){N-=I;L-=I;}while(M&&N>=M.rc){N-=M.rc;L-=M.rc;M=this.cps[++J];}while(M&&L>=M.rc){L-=M.rc;K.push(M);M=this.cps[++J];}if(M){K.push(M);}return K;},invalid:function E(){var I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var I={},J;for(J=0;J<this.cps.length;++J){var K=this.cps[J];if(!K.preServeUpdatedRows){return{};}mstrmojo.hash.copy(K.getUpdatedRows(),I);}this.updatedRows=I;return I;},download:function B(N,M,I){var L=this._getCPs(N,M),J;for(J=0;J<L.length;++J){var K=L[J];K.download(N,M,I);}}});}());(function(){mstrmojo.XtabHACP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabHACP",cps:[],initContent:function G(J){this.startIndexInContainer=J||0;this.type=0;this.colWidths=[];var I;for(I=0;I<this.cps.length;++I){this.cps[I].initContent(this.startIndexInContainer);this.type|=this.cps[I].type;var H=this.cps[I].colWidths;if(H){this.colWidths=this.colWidths.concat(H);}}this.rc=Math.max(this.cps[0].rc,this.cps[1].rc);},getNumAutoHeightRows:function(){return Math.max(this.cps[0].getNumAutoHeightRows(),this.cps[1].getNumAutoHeightRows());},getRowHeight:function C(){return this.cps[0].getRowHeight();},getRowCells:function(I){var M=this.cps,J=[],H=M.length,L;for(L=0;L<H;L++){if(M[L].getAvailableRowsCount()>0&&M[L].rc>I){var K=M[L].getRowCells(I);if(K){J=J.concat(K);}}}return J;},getUnmergedCells:function(H){return this.cps[0].getUnmergedCells(H);},isDataAvailable:function D(I,H){return this.cps[1].isDataAvailable(I,H);},getAvailableRowsCount:function F(){return Math.max(this.cps[0].getAvailableRowsCount(),this.cps[1].getAvailableRowsCount());},invalid:function E(){var I,H,J;for(I=0,H=this.cps.length;I<H;++I){J=this.cps[I];J.invalid();}this.updatedRows={};},getUpdatedRows:function A(){var H={},I;for(I=0;I<this.cps.length;++I){var J=this.cps[I];if(!J.preServeUpdatedRows){return{};}mstrmojo.hash.copy(J.getUpdatedRows(),H);}this.updatedRows=H;return H;},download:function B(K,I,H){var J=this.cps[1];J.download(K,I,H);}});}());(function(){mstrmojo.XtabTitlesCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabTitlesCP",init:function F(I){this._super(I);},download:function B(K,J,I){},shouldClonedLastTitleCell:function H(){return(this.gridData.lhv!==0);},initContent:function E(Q){this.startIndexInContainer=0;if(!this.cts){this.cts=mstrmojo.hash.clone(this.gridData.gts.col);}var J=this.gridData.gts,L=J.row||[],I=J.col||[],S=J.show,P=J.rec,Y=this.cts||[],X=L.length,R=Y.length,V=this.gridData.css;this.base={items:[]};this.rc=(S&&Y.length)||0;if(this.rc===0&&S){this.rc=X>0?1:0;}this.colWidths=(S&&J.cws)||[];if(!this.rc){this.nRowSpan=this.nColSpan=0;return ;}var N={items:[]},T=0,K=1,U,W,a=this,M=a.base.items,Z=function(b,c){if(a.shouldClonedLastTitleCell()&&c>1){b.rs=1;U=mstrmojo.hash.clone(b,{});U.n="&nbsp;";b.cni=V.push({n:(V[b.cni].n||"")+" fsbp_1"})-1;}},O=function(d){var b=d;while(b-->1){if(a.shouldClonedLastTitleCell()){var c=mstrmojo.hash.clone(U,{});c.cni=V.push({n:(V[c.cni].n||"")+" fsbp_"+((b==1)?"3":"2")})-1;M.push({items:[c]});}else{M.push({items:[]});}}};for(W=0;W<X;++W){L[W].axis=1;L[W].ui=W;T+=L[W].cs||1;N.items.push(L[W]);}if(R>0){Y[0].axis=2;Y[0].ui=0;I[0].axis=2;I[0].ui=0;K=Y[0].rs||1;Z(Y[0],K);T+=Y[0].cs||1;N.items.push(Y[0]);}M.push(N);for(W=1;W<R;++W){if(K>1){O(K);}Y[W].axis=2;Y[W].ui=W;I[W].axis=2;I[W].ui=W;K=Y[W].rs||1;Z(Y[W],K);M.push({items:[Y[W]]});}this.rc=M.length;this.nRowSpan=this.rc+K-1;this.nColSpan=T;if(P){this._removeExtraColumn(L,Y);}},getAvailableRowsCount:function D(){return this.rc;},getSpanDimension:function A(){return{nRow:this.nRowSpan||0,nCol:this.nColSpan||0};},isDataAvailable:function C(J,I){return true;},_removeExtraColumn:function G(L,b){var Z=L&&L.length,Q=b&&b.length,I=this.gridData.gts,T=I.row||[],O=I.col||[],J=T.length,X=O.length;if(!Z||!Q){if(Q===1){var c=b[Q-1];if(c.otp==-1){if(X>0){O[X-1]._hid=true;}this.base.items=[];this.nRowSpan=this.nColSpan=this.rc=0;}}return ;}var K=L[Z-1],U=this.rc,M=this.base.items;if(K){if(K.otp==-1){if(J>0){T[J-1]._hid=true;}if(this.nColSpan){this.nColSpan-=K.cs||1;}M[0].items.splice(Z-1,1);}else{var R=U>1?U-1:0,S=M[R],a=S.items.length;if(a>0&&X>0){O[X-1]._hid=true;}var N=K.fix;if(N){var Y;for(Y=0;Y<N;Y++){S.items[a-1+Y]=L[Z-N+Y];}}else{S.items[a-1]=K;}for(var W=0,V=Q-1;W<V;W++){b[W].cs=N?N:K.cs;}var P=N?N:1;M[0].items.splice(Z-P,P);if(this.nColSpan){this.nColSpan-=1;}}}return ;}});})();(function(){mstrmojo.XtabOnDemandCP=mstrmojo.declare(mstrmojo.XtabCP,null,{scriptClass:"mstrmojo.XtabOnDemandCP",blockNum:0,listeners:null,initContent:function E(F){if(F!==undefined){this.startIndexInContainer=F;}this.isDownloaded=(this.base!==null);this.isDownloading=false;if(this.base){this._super(this.startIndexInContainer);this.notifyListeners();}},addCPListener:function D(F){if(!this.listeners){this.listeners=[];}this.listeners.push(F);},notifyListeners:function C(){var F,H=this.listeners,G=(H&&H.length)||0;for(F=0;F<G;F++){if(H[F]&&H[F].onDemandDataReady){H[F].onDemandDataReady(this);}}},getAvailableRowsCount:function B(){return this.isDownloaded?this.rc:0;},download:function(F){if(!this.isDownloaded&&!this.isDownloading){this.isDownloading=true;this.dataSource.download(this.blockNum,F);}},invalid:function(){if(this._super){this._super();}this.isDownloaded=false;this.isDownloading=false;},isDataAvailable:function A(G,F){return this.isDownloaded;}});})();(function(){var a=1,e=2,n=4,W=8,g=1,h=2,G=3,c=4,m=5,U=6,M=7,k=8,X=4,F={},B={},I=4,R=1,J={TITLE:"ig-title",GROUPING:"iggroup",BANDING:"igbanding",RIGHT_ALIGN:"rtAlign",LEFT_ALIGN:"leftAlign",TOTAL_ROW:"total"},T=mstrmojo.hash,V=mstrmojo.array;function Z(t,q){var r=t[0],o=q.gts,p=o.cws.length;return(q.vp.gr==="1"&&(p>1));}function j(p,v){var t=function(w,x){if(x&&w&&w.css&&w.css.indexOf(x)<0){w.css+=" "+x;}};var r=v.type,q=v.col,u=(q&&q.cl)||0,o=(r===e||r===a);if(r===e||r===W){t(p,J.RIGHT_ALIGN);}else{if(r===a||r===n){t(p,J.LEFT_ALIGN);}}if(o){if(q&&q.tg&&u>1){if(!p._v){p._v=p.v;p.v="<span class='toggleHeader'>"+p.v+"</span>";}}t(p,J.TITLE);}V.forEach(v.extraCss,function(w){t(p,w);});}function A(o){return 0;}function l(t){var q,r=t.cg,o=r&&r.cgc,p=1;for(q=0;q<o;q++){if(r&&r[q]&&!r[q].tg&&r[q].cl>p){p=r[q].cl;}}return p;}function N(p,o){var q=m;if(o===2){if(p===0){q=g;}else{if(p===1){q=c;}}}else{if(o>2){if(p===0){q=g;}else{if(p===1){q=h;}else{if(p===o-1){q=c;}else{if(p<o-1&&p>1){q=G;}}}}}}return q;}function L(o,t,q,p){var v=p&&p.cols&&p.cols.cg,r,w=0,u=0;if(v){for(r=0;r<t;r++){if(o[r]){w+=o[r].length;}}w+=(q+1);for(r=0;r<v.cgc;r++){u+=v[r].cl;if(u>=w){return r;}}}return -1;}function P(w,r,p,o){var v=[],u,q,t,x;for(q=0,t=w.length;q<t;q++){if(w[q].length===1){u=w[q][0];u.rowType=(u.rowType!==k)?N(r,p):k;u.singleStack=(p>1);u=T.copy(u);if(u.ts===I){if(p===1){u.rowType=m;u.colIdx=L(w,q,r,o);}else{if(!r){u.colIdx=L(w,q,r,o);}else{delete u.ts;u.v="";}}}else{if(r){u.v="";}}}else{u=w[q][r];if(!u){x=w[q].length;u=T.copy(w[q][x-1],{});u.v="";if(u.hasOwnProperty("ts")){delete u.ts;}}else{if(u.ts===I){u.colIdx=L(w,q,r,o);}}u.rowType=(u.rowType!==k)?N(r,p):k;}v.push(u);}return v;}function Q(o){if(o===0){return 0;}var p=this.sectionMap[o-1]||0;return Math.floor((o-p)/this.stackLevels);}function D(v){var t,u,r=this.sectionInfo,o=r.length,q=this.srh,p=this.lastSectionIndex;u=r[p];if(v>=u.rs&&v<(u.rs+q)){return u;}if(v<u.rs){t=p-1;if(t<=0){this.lastSectionIndex=0;return null;}do{u=r[t];if(v>u.rs&&v<=(u.rs+q)){this.lastSectionIndex=t;return u;}}while(v<u.rs&&--t>0);this.lastSectionIndex=t;return u;}else{t=p+1;if(t>=o){this.lastSectionIndex=o-1;return null;}do{u=r[t];if(v>u.rs&&v<=(u.rs+q)){this.lastSectionIndex=t;return u;}}while(v>(u.rs+q)&&++t<o);this.lastSectionIndex=t-1;return null;}}function d(x,q,o,w){var v=x[0],t,u=x.length,p=v&&v.rowType,r={v:"",css:"empty-igcell",rowType:p};if(o!==undefined&&v&&(p===g||p===m||p===U)){r={v:'<div><div class="IG-ActionArrow-IMG" style="height:'+w+"px;top:-"+(0.5*F[p])+'px;"></div></div>',css:"IG-ActionArrow",_ei:o};}for(t=u-1;t>=u-q;t--){v=x&&x[t];if(v){v.css+=" IG-lastdatacolumn";}}x.push(r);}function S(AL,AG,q){var AC=AL.cols,AD=AC.cg,o=[{w:"0px"}];if(AC&&AG){var AM=AC.cws,p=[],AK=AM.length,AO=0,x=(parseInt(AL.ar,10)===1)?(AG/AK):-1,AB,r,AA=false,t=0,AE=AG,AF=0,AJ;for(AJ=0;AJ<AK;AJ++){r=p[AJ]=AM[AJ];AB=r.w;if(AB===""){AA=true;}else{if(r.xc){AO+=parseInt(AB);AE-=AO;t++;}else{AF+=parseFloat(AB,10);}}}if(AA||AF<100){x=AE/(AK-t);}for(AJ=0;AJ<AK;AJ++){r=AM[AJ];if(r.xc){continue;}else{if(x===-1){AB=parseInt(r.w,10)*AE/100;if(!AB&&AB!==0){AB=parseInt(AE/AD.cgc,10);}}else{AB=(parseInt(r.w,10)<0)?0:x;}}p[AJ]={w:AB+"px"};}if(q){return p;}var z=[],AI=0;for(AJ=0;AJ<AK;AJ++){var AN=AD[AJ],v=AN.tg?AN.cl:1,AH=0;for(AH=0;AH<v;AH++){var u="0px";if(AH===AN.cc){u=p[AJ].w;}z[AI+AH]={w:u};}AI+=v;}return z.concat(o);}else{if(q){return null;}else{return cp.cws.concat(o);}}}function C(){delete this.lastStackCols;delete this.lastAttRow;delete this.lastMtxRow;}mstrmojo.InteractiveGridHACP=mstrmojo.declare(mstrmojo.XtabHACP,null,{scriptClass:"mstrmojo.InteractiveGridHACP",sectionMap:[],stackLevels:1,gridWidth:480,tdWidths:null,lastSectionIndex:0,adjustCPMaps:function O(){var z=this.cps,x=this.cps[0],AE=Math.max(z[0].rc,z[1].rc);if(x.type!==a){var AJ=this.gridData,AD=function(AM,AP){var AL=AM.base.items,AN=AM.lookupBase[0].es,AO=AL[AP].items[0],AK=AN&&AN[AO.idx];return(AK&&AK.n)||((AO.pi&&AN[AO.pi.ri||0])||"");},AH,AG,o=1,v,p,AB,r=0,q=-1,AC,AI,AF=0,AA=this.groupEnabled;for(AC=0,AH=0,AI=x.cps?x.cps.length:1;AC<AI;AC++){var u=x.cps?x.cps[AC]:x,w=u.rc;r=q+1;q=r+w-1;if(u.isDataAvailable(r,q)){if(u.lastRow){AF=u.lastRow;p=u.lastSection;}else{AH=AF||0;for(AG=0,o=this.sectionMap[AH-1]||0;AG<w;AG++){var t=this.stackLevels;AB=AD(u,AG);if(AA&&AB!==p){p=AB;this.sectionInfo.push({sn:AB,rs:this.srh*o+this.stackedRh*Math.floor((AH-o)/this.stackLevels)});this.sectionMap[AH]=++o;AH++;}while(t){this.sectionMap[AH]=o;t--;AH++;}}AF=u.lastRow=AH;u.lastSection=AB;}}else{break;}}this.rc=(this.stackLevels>1?AE*this.stackLevels:AE)+(AA?o:0);}},onDemandDataReady:function b(){this.adjustCPMaps();},initContent:function Y(z){var x=this.cps,AK=this.gridData=x[0].gridData||x[0].cps[0].gridData,AG=AK.vp=this.gridVp=this.gridVp||AK.vp,q=AG.daf&&AG.daf.split(":"),AA=AG.cols,AB=AA.cg,AH=AA.cws,w=x[A(AB)],AE=AK.gts.row,p=AK.gts,AI=Z(x,AK),v=w.type!==a,AD,AF,t,o,AC,u,AJ,r=(typeof (mstrMobileApp)!=="undefined"&&mstrMobileApp.getDeviceDPI)?mstrMobileApp.getDeviceDPI():160;if(r===160){F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}else{if(r===213){F={1:45,2:31,3:26,4:39,5:71,6:40,7:35,8:71};B={1:15,2:15,3:2,4:21,5:21};}else{if(r===240){F={1:50,2:34,3:30,4:44,5:80,6:40,7:40,8:80};B={1:16,2:16,3:2,4:24,5:24};}else{if(r===320){F={1:67,2:44,3:38,4:58,5:107,6:40,7:53,8:107};B={1:22,2:22,3:2,4:32,5:32};}else{F={1:33,2:22,3:20,4:30,5:53,6:40,7:27,8:53};B={1:11,2:11,3:1,4:16,5:16};}}}}if(v){if(AG.dafIdx===undefined&&q){for(AD=0;AD<AE.length;AD++){if(AE[AD].id===q[0]&&AE[AD].fid===q[1]){AG.dafIdx=AD;break;}}}}for(AD=0;AD<AB.cgc;AD++){if(AB[AD]&&AB[AD].tg){break;}}if(AD===AB.cgc){AK.gts.show=false;AK.ghs.chs.show=false;}this._super(z);this.colWidths=S(AG,this.gridWidth);this.tdWidths=S(AG,this.gridWidth,true);if(v){this.stackLevels=l(AA);if(this.stackLevels>1){this.srh=F[M];this.rh=F[m];this.mrh=F[G];this.stackedRh=F[g]+(this.stackLevels-2)*F[h]+F[G];}else{this.srh=F[M];this.rh=this.stackedRh=this.mrh=F[m];}if(AI||this.stackLevels>1){this.sectionMap=[];this.sectionInfo=[];this.groupEnabled=AI;this.adjustCPMaps();o=this.cps[0].cps;if(o){AJ=this;for(AD=0,AF=o.length;AD<AF;AD++){u=o[AD];if(u&&u.addCPListener){u.addCPListener(AJ);}}}}}},getUnmergedCells:function(o){return ;},getResolvedGroupHeader:function(q,u){var p=this.gridData,t=p.gts.row[u].es,o=p.ghs.rhs.items[q].items[u];if(o){if(!o.css){o.css=p.css[o.cni].n+" iggroup";o.n=t[o.idx].n;}}else{return{css:" iggroup",n:""};}return o;},getRowCells:function(AI){var AD=this.cps,v=[],AW=this.gridData,AS=AW.vp,AG=AS.cols.cg,AB=AD[A(AG)],AF=this.groupEnabled,q=AS.bn==="1",AT=[],AH=Q.call(this,AI),w,r,AJ=1,AC,o,z,AP,AO,AR,AV,AA;if(AF&&(this.sectionMap[AI]!==this.sectionMap[AI-1])){var t=T.copy(AB.getRowCells(AH)[0],{});t.cs=this.colWidths.length;t.rowType=M;j(t,{col:null,type:AB.type,extraCss:[J.GROUPING]});return[t];}if(!AI){C.call(this);}this.lastAttRow=this.lastAttRow||(AD[0].rc?AD[0].getRowCells(AH):[]);this.lastMtxRow=this.lastMtxRow||(AD[1].rc?AD[1].getRowCells(AH):[]);z=this.lastAttRow;AR=z.length;if(AR>0&&z[0].stt){AC=true;for(AP=0;AP<AR;AP++){AV=z[AP];if(AV.stt===R){o=AV;break;}}}if(!this.lastStackCols){V.forEach([this.lastAttRow,this.lastMtxRow],function(p){for(AP=0;AP<p.length;AP++){if(p[AP]._ei!==undefined){if(AS.dafIdx>=0){AA=AB.getRowCells(AH)[AS.dafIdx];}w=(AS.dafIdx>=0)?(AA&&AA._ei):"";return false;}}},this);var AN=function(p,AX){if(p&&(AX.type===a||AX.type===e)){if(AL.tg===false){p.n=p.v="";}p.rowType=k;}j(p,{col:AL,type:AX.type,extraCss:[((AX.type===W||AX.type===n)&&q&&(AH%2===1))?J.BANDING:null,AC?J.TOTAL_ROW:null]});if(p){p.cs=1;if(p._ei===undefined&&AS.dafIdx!==undefined){p._ei=w;}}};this.lastRowIndex=0;for(AO=0;AO<AG.cgc;AO++){var AL=AG[AO],AQ=AL["mix"+AL.cc],u=AQ!==undefined,x=AD[u?1:0],AM,AK,AE,AU={n:"",stt:R,css:"xtab-td"};arr=[];if(AL.tg){for(var AP=0;AP<AL.cl;AP++){arr=[];AE=u?AL["mix"+AP]:AL.attForms[AP].idx;var z=u?this.lastMtxRow:this.lastAttRow;AV=z[AE];if(AC){if(!AV){AV=AU;}else{if(AV&&AV.stt===R){AV=T.copy(o,AU);}else{AV=T.copy(AV,{});}}}else{AV=T.copy(AV,{});}AN(AV,x);arr.push(AV);AT.push(arr);}if(AO+1===AG.cgc){AJ=AL.cl;}}else{for(AM=0,AR=AL.cl;AM<AR;AM++){if(u){AK=AL["mix"+AM];if(AK!==undefined){AV=this.lastMtxRow[AK];}}else{AK=AL.attForms[AM];if(AK){AV=this.lastAttRow[AK.idx];}if(AC&&!AV){AV=AU;}}AN(AV,x);arr.push(AV);}AT.push(arr);}}this.lastStackCols=AT;}v=P(this.lastStackCols,this.lastRowIndex++,this.stackLevels,AS);if(this.lastRowIndex>=this.stackLevels){C.call(this);}return v;},getRowHeight:function E(p){var o=F[m];return F[p]||o;},getPadding:function K(o){return B[o]||B[X];},isDataAvailable:function f(p,o){if(!this.onDemandIF||!this.cps[1].cps){return true;}else{var r=this.sectionMap.length,q;if(!r){return this.cps[1].isDataAvailable(p,o);}if(o>r){if(p<r){q=Q.call(this,p);return this.cps[1].isDataAvailable(q,q+(o-p));}else{return false;}}else{return this.cps[1].isDataAvailable(Q.call(this,p),Q.call(this,o));}}},download:function H(v,r,w){var q=Q.call(this,v),o=q+Math.ceil((r-v)/this.stackLevels),t=this.cps[0],p,x,u=!t.cps?[t]:this.cps[0]._getCPs(q,o);for(p=0;p<u.length;++p){x=u[p];x.download(q,o,w);}},getRowCellInfo:function(r){var q=D.call(this,r+this.srh),o,p=this.lastSectionIndex;if(q){o=this.sectionInfo[p-1];return{rowStart:q.rs,isNextRowNewSection:true,sectionName:o&&o.sn};}else{return{isNextRowNewSection:false,sectionName:this.sectionInfo[p].sn};}}});}());(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo._IsDial");mstrmojo.Dial=mstrmojo.declare(mstrmojo.List,[mstrmojo._IsDial],{scriptClass:"mstrmojo.Dial",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onhasSelectionChange:function(){mstrmojo.css.toggleClass(this.domNode,["hasSelection"],!!this.hasSelection);},hideIfEmpty:function(){this.onadd();}},hideIfEmpty:false,onadd:function(A){if(this._super){this._super(A);}if(this.hideIfEmpty){if(this.domNode){this.domNode.style.display=(!this.items||this.items.length==0)?"none":"block";}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo._BindTargetChildren","mstrmojo.List");mstrmojo.TabNameList=mstrmojo.declare(mstrmojo.List,[mstrmojo._BindTargetChildren],{scriptClass:"mstrmojo.TabNameList",isStrip:true,targetProps:{names:"items"},makeObservable:true,postchange:function A(){var E=this.selectedIndex,F=this.target;if(F&&E!=null&&parseInt(E,10)!==-1){F.set("selected",F.children[E]);}},addTabButtons:function B(E,M){var J=this.targetProps||{},Q=J.childTitle||"n",G=this.itemIdField||"v",F=this.itemField||"n",P=[],I=(this.items)?this.items.length:0,L=(E&&E.length)||0,K;for(K=0;K<L;K++,I++){var O=E[K],H=O[Q];if(H){var N={target:O};N[F]=H;N[G]=I;P.push(N);}}if(P.length){this.add(P,M);}},removeTabButton:function D(F){var E=mstrmojo.array.filter(this.items,function(G){return(G.target===F);},{max:1});if(E&&E[0]){this.remove(E[0]);}},clearButtons:function C(){this.remove(this.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.List");var B=mstrmojo.dom,E=mstrmojo.array,C=mstrmojo.css,G=",";function F(){var K,I,J=this.items,L=[];for(K=0,I=J.length;K<I;K++){L.push(J[K].v);}this.set("value",L.join(G));}function H(){var I=this.itemsContainerNode;if(I){E.forEach(I.children,function(J){if(J&&J.firstChild){C.removeClass(J.firstChild,"selected");}});}}mstrmojo.RankDIC=mstrmojo.declare(mstrmojo.List,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.RankDIC",cssClass:"mstrmojo-RankDIC",draggable:true,dropZone:true,allowCopy:false,multiSelect:false,renderOnScroll:false,itemDisplayField:"n",itemIdField:"v",containerResizable:false,itemMarkupFunction:function(M,J,K){var I=J===0,O=J===K.items.length-1,L='<div class="moveup '+(!I?"":"disabled")+'" or="1" idx="'+J+'">&nbsp;</div>',N='<div class="movedown '+(!O?"":"disabled")+'" or="-1" idx="'+J+'">&nbsp;</div>';return'<div class="mstrmojo-RankOption'+(I?" first":(O?" last":""))+'"><div class="index" contentEditable="true" onfocus="return mstrmojo.all[\''+K.id+"'].selectText(this);\" onblur=\"return mstrmojo.all['"+K.id+"'].indexChanged(this, "+J+');" onkeyup="return mstrmojo.all[\''+K.id+"'].keyPressed(event, this, "+J+');">'+J+'</div><div class="text">'+M.n+"</div>"+N+L+"</div>";},allowDrop:function(K){var J=K&&K.src,I=J&&J.widget;return(I===this);},ondrop:function(L){var J=this.domNode.parentNode,K=J.style,I=false;if(!K.height){K.height=J.offsetHeight+"px";I=true;}this._super(L);H.call(this);F.call(this);if(I){K.height="";}},selectText:function D(K){var I=document.createRange();I.selectNodeContents(K);var J=window.getSelection();J.removeAllRanges();J.addRange(I);},indexChanged:function(M,J){var L=parseInt(M[M.innerText!==undefined?"innerText":"textContent"],10),K=parseInt(J,10),I=this.items.length;if(isNaN(L)){M[M.innerText!==undefined?"innerText":"textContent"]=J;return false;}L=Math.min(Math.max(0,L),I);if(L!==K){this.move([K],L);F.call(this);return true;}else{return true;}},keyPressed:function A(J,K,I){if(J.keyCode===mstrmojo.Enum_Keys.ESCAPE){K[K.innerText!==undefined?"innerText":"textContent"]=I;if(K.blur){K.blur();}}else{if(J.keyCode===mstrmojo.Enum_Keys.ENTER){this.indexChanged(K,I);}}return true;},onmouseup:function(L){var M=B.eventTarget(L.hWin,L.e),K=parseInt(M.getAttribute("or"),10),J=M&&parseInt(M.getAttribute("idx"),10),I=this.items.length;if(K===1&&J!==0){this.move([J],0);F.call(this);return true;}else{if(K===-1&&J!==(I-1)){this.move([J],I);F.call(this);return true;}else{mstrmojo.dom.preventDefault(window,L.e);return true;}}},init:function(I){this._super(I);this.items=this.getItems();}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");var B=mstrmojo.dom;mstrmojo.Pulldown=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-Pulldown",items:null,itemIdField:"dssid",itemField:"n",itemCSS:"css",itemTitleField:null,defaultSelection:0,defaultText:null,title:"",value:null,popupToBody:false,popupCssClass:"",popupZIndex:null,fixWidth:false,fixHeight:false,_set_items:function(H,F){var G=this.items;this.items=F||[];return G!==this.items;},markupMethods:mstrmojo.hash.copy({onvalueChange:function(){var G=this.value,F=this.selectedIndex,I=this.items||[],J,H;if(F===undefined||(G!==null&&(F===-1||(F!==-1&&I[F]&&I[F][this.itemIdField]!==G)))){F=mstrmojo.array.find(I,this.itemIdField,G);F=(F>-1)?F:this.defaultSelection;this.selectedIndex=F;}else{if(G===null){this.selectedIndex=this.defaultSelection;}}this.selectedItem=J=I[this.selectedIndex];if(J){H=J[this.itemField];}else{H=this.defaultText||"";}this.set("text",H);}},mstrmojo.hash.copy(mstrmojo.DropDownButton.prototype.markupMethods)),prevalueChange:function D(){var G=this.value,F=-1;if(G!==null){F=mstrmojo.array.find(this.items,this.itemIdField,G);}if(F>-1){this.selectedItem=this.items[F];this.selectedIndex=F;}},togglePopup:function E(){if(this.popupToBody){var I=B.position(this.popupNode,true),H=this.popupRef,F={left:Math.round(I.x)+"px",top:Math.round(I.y)+"px"};if(!H.hasRendered){delete H.slot;F.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(F,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this._super){this._super();}var G=this.popupRef.domNode;if(G){if(this.fixWidth){G.style.width=(this.domNode.offsetWidth-2)+"px";}else{G.style.minWidth=(this.domNode.offsetWidth-2)+"px";}}},premousedown:function A(F){if(B.getButton(F.hWin,F.e)===B.MOUSE_BUTTON.LEFT){this.togglePopup();}},unrender:function C(F){var G=this.popupRef;if(this.popupToBody&&G.hasRendered){G.unrender(false);}if(this._super){this._super(F);}},itemName:function(H,F,G){return mstrmojo.string.encodeHtmlString(H[G.itemField]);},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Pulldown-Popup",autoCloses:false,modal:false,autoClose:true,locksHover:true,onOpen:function(){var H=this.opener,G=H&&H.popupZIndex,I=(H&&H.popupCssClass)||"",F=this.domNode;if(G){F.style.zIndex=G;}if(I){mstrmojo.css.addClass(F,[I]);}if(H&&H.fixWidth){mstrmojo.css.addClass(F,["fix-width"]);}if(H&&H.fixHeight){mstrmojo.css.addClass(F,["fix-height"]);}},children:[{scriptClass:"mstrmojo.List",alias:"list",itemMarkupFunction:function(I,F,G){var H=I[G.itemCSS]||G.parent.opener.item2textCss&&G.parent.opener.item2textCss(I)||"",J=G.parent.opener.itemName;return'<div class="mstrmojo-Pulldown-listItem"><div class="mstrmojo-text '+H+'" title="'+I[G.itemTitleField||G.itemField]+'">'+(J(I,F,G)||"&nbsp;")+"</div></div>";},renderOnScroll:false,bindings:{itemIdField:"this.parent.opener.itemIdField",itemField:"this.parent.opener.itemField",itemCSS:"this.parent.opener.itemCSS",itemTitleField:"this.parent.opener.itemTitleField",items:"this.parent.opener.items",selectionPolicy:"this.parent.opener.selectionPolicy",selectedIndex:"this.parent.opener.selectedIndex"},onmousedown:function(){this.parent.close();},onchange:function(){var H=this.parent,I=H.visible,F=H.opener,G=this.selectedItem;if(!F||!G||!I){return ;}F.set("value",G[this.itemIdField]);}}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListSelector","mstrmojo.List","mstrmojo.string");mstrmojo.OBList=mstrmojo.declare(mstrmojo.List,null,{scriptClass:"mstrmojo.OBList",cssClass:"mstrmojo-OBList",itemClass:"mstrmojo-OBListItem",iconClass:"mstrmojo-OBListItemIcon",textClass:"mstrmojo-OBListItemText",iconCssPrefx:"mstrmojo-OBIcon_",itemMarkupFunction:function(C,A,B){return'<div class="'+B.itemClass+(C[B.itemType]?" t_"+C[B.itemType]:"")+(C[B.itemSubType]?" st_"+C[B.itemSubType]:"")+(C[this.itemISC]?" isc":"")+(C[B.itemViewMedia]?" vm_"+C[B.itemViewMedia]:"")+'"><table cellspacing="0" cellpadding="0"><tbody><tr><td>'+B.getIcon(C)+'</td><td><div class="'+B.textClass+'" title="'+B.getTooltip(C)+'">'+mstrmojo.string.htmlAngles(C.n)+"</div></td></tr></tbody></table></div>";},getIcon:function(F){var E=F[this.itemType],D=F[this.itemSubType],B=" t"+E,C=(parseInt(E,10)===1||parseInt(E,10)===3||parseInt(D,10)===14082)?" st"+D:"",G=F[this.itemISC]?'class="mstrmojo-ListIcon isc"':"",A=(F[this.itemViewMedia]===2048||F[this.itemViewMedia]===8192)?" hvi":"";return'<span class="mstrmojo-ListIcon '+B+C+A+'"><span '+G+"></span></span>";},getTooltip:function(C){var D="",F=C.anc&&C.anc.items,A=F&&F.length,B;if(A>0){for(B=0;B<A-1;B++){D+=F[B].n+" > ";}D+=F[A-1].n;}var E=C.desc,G=128;if(E){D+="\r\n\r\n"+E.substring(0,G)+(E.length>G?"...":"");}return D;},listSelector:mstrmojo.ListSelector,selectionPolicy:"reselect",itemType:"t",itemSubType:"st",itemISC:"isc",itemViewMedia:"dvm",useDblSelect:false});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.HTMLButton","mstrmojo.CheckBox","mstrmojo.HBox","mstrmojo.VBox","mstrmojo.Box","mstrmojo.Popup","mstrmojo.List","mstrmojo.DropDownButton");var A=function(E){E.attachEventListener("pfChange",E.id,"positionChange");E.boxes.left.flat.attachEventListener("checkedChange",E.id,"flatChange");var D={pf:"this.boxes.left.pf.value",flat:"!this.boxes.left.flat.checked",agg:function(){return this.boxes.left.agg.checked?"2":"1";},rfi:"this.boxes.left.rfi.value"};E.set("bindings",D);},C=function(E){var D=E.boxes.left;D.pf.set("value",E.pf);D.flat.set("checked",!E.flat);D.agg.set("checked",E.agg==2);D.rfi.set("value",E.rfi);};function B(M,I,E,F,L,D,H,K){var J={target:I,onEnd:function(){if(D){D();}},props:{}};J.props[E]={ease:H||mstrmojo.ease.sin,start:parseInt(F,10),stop:parseInt(L,10),suffix:"px"};J=mstrmojo.hash.copy(K,J);var G=new mstrmojo.fx.AnimateProp(J);G.play();}mstrmojo.CGEOptions=mstrmojo.declare(mstrmojo.VBox,null,{scriptClass:"mstrmojo.CGEOptions",children:[{scriptClass:"mstrmojo.HBox",alias:"boxes",cellCssClass:"cell",children:[{alias:"left",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-CGEOptions-options",children:[{scriptClass:"mstrmojo.ImageCheckBox",alias:"flat",cssClass:"row",label:mstrmojo.desc(7954,"Enable hierarchical display")},{scriptClass:"mstrmojo.ImageCheckBox",alias:"agg",cssClass:"row",label:mstrmojo.desc(7955,"Enable subtotals display")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7956,"Position parent header:"),cssClass:"row"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",alias:"pf",cssClass:"CGE-parent-header mstrmojo-FormatEditor-DropDownButton",items:[{n:mstrmojo.desc(7957,"Above child items"),v:true},{n:mstrmojo.desc(7958,"Below child items"),v:false}],bindings:{value:"this.parent.parent.parent.pf"}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7959,"Interaction with report filter:"),cssClass:"row"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",alias:"rfi",cssClass:"CGE-report-filter mstrmojo-FormatEditor-DropDownButton",items:[{n:mstrmojo.desc(7960,"Default (Database Instance level)"),v:-1},{n:mstrmojo.desc(7961,"No interaction"),v:0},{n:mstrmojo.desc(2398,"Apply"),v:1},{n:mstrmojo.desc(7962,"Apply but ignore related elements"),v:2}],bindings:{value:function(){var D=this.parent.parent.parent.rfi,D=D==undefined?"-1":D;return D;}}}]},{scriptClass:"mstrmojo.Box",alias:"preview",cssClass:"mstrmojo-CGEOptions-preview",children:[{scriptClass:"mstrmojo.Label",cssClass:"title",text:mstrmojo.desc(3389,"Preview")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7963,"Element Header 1"),alias:"g1t"},{scriptClass:"mstrmojo.Box",alias:"e1",cssClass:"e",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7965,"Item 1-1")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7966,"Item 1-2")}],onflatChange:function(){mstrmojo.css.toggleClass(this.domNode,["flat"],this.flat);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7963,"Element Header 1"),cssText:"margin-bottom:10px;",alias:"g1b"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7964,"Element Header 2"),cssText:"margin-top:10px;",alias:"g2t"},{scriptClass:"mstrmojo.Box",alias:"e2",cssClass:"e",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7967,"Item 2-1")},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7968,"Item 2-2")}],onflatChange:function(){mstrmojo.css.toggleClass(this.domNode,["flat"],this.flat);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7964,"Element Header 2"),alias:"g2b"}]}]},{scriptClass:"mstrmojo.HBox",alias:"btns",cssClass:"mstrmojo-Editor-buttonBar",cssText:"margin-top: 10px;",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(2397,"OK"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.save();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(2399,"Cancel"),cssClass:"mstrmojo-Editor-button",onclick:function(){this.parent.parent.cancel();}}]}],pf:true,flat:false,agg:"1",rfi:"-1",postBuildRendering:function(){if(this._super){this._super();}A(this);this.preview();},open:function(E,F){var D=E.cgp;this.pp=D;this.set("pf",D.pf);this.set("flat",D.flat);this.set("agg",D.agg);this.set("rfi",D.rfi);C(this);for(var G in F){this[G]=F[G];}this.set("visible",true);if(!this.hasRendered){this.render();}},cancel:function(){var D=this.closeCB;if(D){D[0][D[1]]();}},save:function(){this.pp.pf=this.pf;this.pp.flat=this.flat;this.pp.agg=this.agg;this.pp.rfi=this.rfi;this.cancel();},positionChange:function(D){this.preview(D.value,null);},flatChange:function(D){this.preview(null,!D.value);},preview:function(G,E){G=!!G?String(G)==="true":!(String(this.pf)==="false");E=(E==null?this.flat:E);var F=!!G,D=this.boxes.preview;D.g1t.set("visible",F);D.g1b.set("visible",!F);D.g2t.set("visible",F);D.g2b.set("visible",!F);D.e1.set("flat",E);D.e2.set("flat",E);}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetListBase","mstrmojo.WidgetListMapper","mstrmojo.WidgetListBuilder");mstrmojo.WidgetList=mstrmojo.declare(mstrmojo.WidgetListBase,null,{scriptClass:"mstrmojo.WidgetList",renderOnScroll:true,listMapper:mstrmojo.WidgetListMapper,listBuilder:mstrmojo.WidgetListBuilder,itemConfig:null,itemFunction:null,initBindings:function(){this._super();var E=this.ctxtBuilder,D=E&&E.itemWidgets;if(D){for(var C=0,A=D.length;C<A;C++){var B=D[C];if(B&&B.initBindings){B.initBindings();}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListHoriz","mstrmojo.fx");mstrmojo.FishEye=mstrmojo.declare(mstrmojo.ListHoriz,null,{scriptClass:"mstrmojo.FishEye",width:16,size:10,step:16,speed:2,cssClass:"mstrmojo-FishEye",cssClassItem:"mstrmojo-dot",itemMarkupFunction:function(B,A,C){return'<div class="mstrmojo-fisheye-item '+C.cssClassItem+'" title="'+B.n+'" idx="'+A+'" did="'+B.did+'">&nbsp;</div>';},onchange:function(){this.scroll2();this.parent.set("selectedIndex",this.selectedIndex);},as:new mstrmojo.fx.AnimateProp(),onitemsChange:function(){if(this._super){this._super();}this.last=this.items.length-1;this.first=Math.max(0,this.last-this.size);if(this.items.length>this.size){this.scroll("left",this.width);}},scroll2:function(){var A=this.selectedIndex-this.last;if(this.selectedIndex==this.first&&this.first>0){this.scroll("right",this.width);}else{if(this.selectedIndex==this.last&&this.last<this.items.length-1){this.scroll("left",this.width);}else{if(this.selectedIndex>this.last){A=this.selectedIndex-this.last;this.scroll("left",this.width*A,A);this.last=Math.min(this.items.length-1,this.last+A);}else{if(this.selectedIndex<this.first){A=this.first-this.selectedIndex;this.scroll("right",this.width*A,A);this.first=Math.max(0,this.first-A);}}}}},scroll:function(C,F,E){var B=this.itemsContainerNode,I=B&&B.style;var D=this.as,H=parseInt(mstrmojo.css.getStyleValue(B,{left:"right",right:"left"}[C]),10),H=isNaN(H)?0:H,A=parseInt(I.left,10)||0,G=A+(C=="left"?-1:1)*(F||(Math.min(this.step,(-1)*H)));D.target=B;D.props={left:{start:A,stop:G,duration:100,interval:10,suffix:"px"}};D.play();E=E===undefined?1:E;this.first+=(C=="left"?1:-1)*E;this.last=this.first+this.size-1;this.parent.set("scrollable",this.last<this.items.length-1);this.parent.set("rightScrollable",this.first>0);return G;},srcId:null,postBuildRendering:function(){if(this._super){this._super();}this.hasRendered=!!this.domNode;var E=this.itemsContainerNode,A=E&&E.firstChild,B=A&&A.rows&&A.rows[0],D=B&&B.cells&&B.cells[0];this.first=0;this.last=this.size-1;var C=this.srcId;if(C&&mstrmojo.all[C]&&mstrmojo.all[C].attachEventListener){mstrmojo.all[C].attachEventListener("change",this.id,function(F){if(this.items[this.items.length-1]!=F.src.selectedItem){this.items.add([mstrmojo.hash.copy(F.src.selectedItem)]);this.set("selectedIndex",this.items.length-1);}if(this.items.length>this.size){this.set("rightScrollable",this.items.length>this.size);this.scroll("left",this.width*(this.selectedIndex-this.last),(this.selectedIndex-this.last));}});}this.itemsContainerNode.style.left=Math.min(0,(this.size-this.items.length+1))*this.width+"px";}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.StackContainer");mstrmojo.TabContainer=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.TabContainer",markupString:'<div id="{@id}" class="mstrmojo-tabcontainer {@cssClass}"><div class="mstrmojo-tabcontainer-tabs"></div><div class="mstrmojo-tabcontainer-stack"></div><div></div></div>',markupMethods:{onborderChange:function(){if(this.border){this.domNode.style.border=this.border;}},onbackgroundChange:function(){this.domNode.style.background=this.background||"";}},markupSlots:{top:function(){return this.domNode.childNodes[0];},stack:function(){return this.domNode.childNodes[1];},containerNode:function(){return this.domNode.childNodes[1];},bottom:function(){return this.domNode.childNodes[2];}},addChildren:function A(D,K,H){var G=this._super(D,K,H);var B=this.children,F=B.length;if(F>=2){var L,I,E;for(E=0;E<F;E++){var C=B[E],J=C&&C.slot;if(!L&&C.isStrip){L=C;}else{if(!I&&(!J||J==="stack")){I=C;}}if(L&&I){L.set("target",I);break;}}}return G;}});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.DocLayout","mstrmojo._Formattable","mstrmojo._HasWaitIcon","mstrmojo.dom");mstrmojo.DocLayout=mstrmojo.declare(mstrmojo.rw.DocLayout,[mstrmojo._Formattable,mstrmojo._HasWaitIcon],{scriptClass:"mstrmojo.DocLayout",formatHandlers:{domNode:["B","background-color","D","min-height","width"]},markupMethods:{onminHeightChange:function(){var N=this.minHeight;if(!N){var M=this.getFormats();N=M&&M["min-height"];}if(N){this.containerNode.style[mstrmojo.css.MINHEIGHT]=N;}}},getHeight:function E(){var M=0;mstrmojo.array.forEach(this.children,function(N){M+=N.getHeight();});return M||this.containerNode.offsetHeight;},getWidth:function I(){var M=this.children;return(M&&M.length)?M[0].getWidth():this.containerNode.offsetWidth;},preBuildRendering:function K(){var M=this.getFormats();if(M&&M["min-width"]!==undefined){M.width=M["min-width"];}this._super();},renderChildren:function L(){this._super();this.resizeOrReposition();},resizeOrReposition:function D(){var O=this.containerNode;if(!!this.defn.aw){var U=this.model.getAutoWidthIDs(),S=(U&&U.length)||0,Y=0,X=mstrmojo.all,P;if(!S){return ;}for(P=0;P<S;P++){Y=Math.max(this._getWidgetRightMostPosition(X[U[P]]),Y);}Y=Math.max(this.getLayoutMinWidth(),Y);if(Y>parseInt(this.getFormats().width,10)){O.style.width=Y+"px";}}var W=this.model.zt;if(mstrApp.isMobile&&W){var M=this.parent.domNode;if(M){var Q=this.model.controller,N=!!Q.orientation,Z=0,V=this.parent,R=V.getHeight()-V.fixedHeaderNode.clientHeight-V.fixedFooterNode.clientHeight;if(W===2){if(!Q.toolBarDelegated){R-=Q.getBottomToolBarHeight();}Z=Math.round(N?Math.max((R-this.getHeight()),0)/2:0)+"px";}O.style.margin=Z+" auto";var T=this;window.setTimeout(function(){Q.nudgeWidget(T.id,{left:O.offsetLeft,top:O.offsetTop});},0);}}},getLayoutMinWidth:function F(){return 0;},_getWidgetRightMostPosition:function F(M){return parseInt(M.getFormats().left,10)+((M.getDim&&M.getDim().w)||M.domNode.offsetWidth);},renderCtrlsInViewport:function C(){this._super();this.resizeOrReposition();},adjustAutoWidth:function H(M){if(!this.defn.aw||!M){return ;}var O=this.containerNode.style,N=parseInt(O.width,10)||0;var P=this;window.setTimeout(function(){var Q=P._getWidgetRightMostPosition(M);if(Q>N){O.width=Q+"px";}},1);},_getModelChildNodes:function B(P,O,S,N,R){var Q=this.model.getNonFixedSections(P,O);var M=Q.length;N=isNaN(N)?M:N;S=S||0;if(S>0||N<M){Q=Q.slice(S,S+N);}return R?{nodes:Q,total:M}:Q;},getChildren:function G(O,N,Q,M,P){return this._getModelChildNodes(O||this.node,N||false,Q,M,P);},getCaptureDimensions:function J(){var N=this.domNode,M;if(!this.domNode){return null;}M=mstrmojo.dom.position(N);M.w=Math.min(N.offsetWidth,M.w);M.h=Math.min(N.offsetHeight,M.h);return M;},preserveChildDomOrder:false,postBuildRendering:function A(){if(window.mstrMobileApp!==undefined){this.defn.lastOrientation=mstrMobileApp.getOrientation();}this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.dom","mstrmojo.TextBox");var A=mstrmojo.css,C=mstrmojo.dom;mstrmojo.TextArea=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextArea",markupString:'<textarea id="{@id}" class="mstrmojo-TextArea {@cssClass}"  style="{@cssText}" title="{@tooltip}" placeholder="{@placeholderText}" rows="{@rows}" cols="{@cols}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keydown,keyup,blur></textarea>',maxLength:256,onkeydown:function B(K){var I=this.inputNode,J=this.value,E=this.maxLength,F=(J&&J.length)||0,M=K.e,L=M.keyCode;this.isDeleteKeys=L===8||L===46;this.isArrowKeys=L===37||L===38||L===39||L===40;if(E!==undefined&&E<=F){var G=I.selectionEnd,H=(G!==undefined)?(G-I.selectionStart)>0:document.selection.createRange().text.length>0;if(!this.isDeleteKeys&&!this.isArrowKeys&&!H){if(C.isIE7||C.isIE8||C.isIE9){I.blur();window.setTimeout(function(){I.focus();},1);}C.preventDefault(window,M);return false;}}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.TextArea,{oncssClassChange:function D(){A.addClass(this.domNode,this.cssClass||"");}});})();(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo.hash");var A="mstrmojo-TextBoxWithLabel";mstrmojo.TextBoxWithLabel=mstrmojo.declare(mstrmojo.TextBox,null,{scriptClass:"mstrmojo.TextBoxWithLabel",label:"",rightLabel:"",cssDisplay:"inline",type:"text",markupString:'<div class="'+A+' {@cssClass}" style="{@cssText}"><span class="mstrmojo-TextBox-label">{@label}</span><input id="{@id}" class="mstrmojo-TextBox {@inputNodeCssClass}"  style="{@inputNodeCssText}" title="{@tooltip}" type="{@type}" value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur/><span class="mstrmojo-TextBox-label-right">{@rightLabel}</span></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild.nextSibling;},lblNode:function(){return this.domNode.firstChild;}}});mstrmojo.TextBoxWithLabel.prototype.markupMethods=mstrmojo.hash.copy({oncssClassChange:function(){var B=this.cssClass;this.domNode.className=A+(B?" "+B:"");},onlabelChange:function(){this.lblNode.innerText=this.label||"";}},mstrmojo.hash.copy(mstrmojo.TextBoxWithLabel.prototype.markupMethods));}());(function(){mstrmojo.requiresCls("mstrmojo.css");mstrmojo.PickerButton=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.PickerButton",cssClass:"mstrmojo-PickerButton",cellCssClass:"mstrmojo-PickerButton-cell",enabled:true,postCreate:function(){var A=function(B){var C=B.parent,E=C&&C.items&&C.items[C.selectedIndex],D=E&&E.cssClass||null;if(D){mstrmojo.css.removeClass(B.domNode,B.selectedItemCssClass);mstrmojo.css.addClass(B.domNode,B.selectedItemCssClass=D);}};this.children=[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-InteractiveButton",selectedItemCssClass:"",bindings:{title:"this.parent.title",iconClass:"this.parent.iconClass",selectedIndex:"this.parent.selectedIndex",enabled:"this.parent.enabled"},onclick:function(){this.parent.onchange();},onselectedIndexChange:function(){A(this);},onRender:function(){A(this);}},{scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-PickerButton-DropDownButton",bindings:{enabled:"this.parent.enabled"},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-Menu",shadowNodeCssClass:"mstrmojo-Menu-shadow",contentNodeCssClass:"mstrmojo-Menu-content",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.ListBox",itemCssClass:"mstrmojo-ListBox-item mstrmojo-InteractiveText",bindings:{itemDisplayField:"this.parent.opener.parent.itemDisplayField",itemIdField:"this.parent.opener.parent.itemIdField",items:"this.parent.opener.parent.items"},onchange:function(){if(this._closing){return ;}var C=this.selectedIndex,B=this.parent.opener;if((C>-1)&&B){this._closing=true;B.closePopup();B.parent.selectedItem=this.selectedItem;B.parent.set("selectedIndex",C);B.parent.onchange();this._closing=false;}}}]}}];}});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.func","mstrmojo.array","mstrmojo.Button","mstrmojo.HBox","mstrmojo.dom","mstrmojo.Box");var D=mstrmojo.dom;mstrmojo.Dialog=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Dialog",title:"",buttons:null,alignment:"center",btnAlignment:"right",zIndex:10,modal:true,markupString:'<div id="{@id}" class="mstrmojo-Dialog {@cssClass}" style="z-index: 1100;" tabindex="0" mstrAttach:click><div class="win mstrmojo-Editor" style="{@cssText}"><div class="mstrmojo-Editor-titlebar"><div class="mstrmojo-Editor-title">{@title}</div></div><div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div><div class="mstrmojo-Editor-tip"></div></div>',markupSlots:{editorNode:function(){return this.domNode.firstChild;},curtainNode:function(){return this.domNode.childNodes[1];},titleNode:function(){return this.domNode.firstChild.firstChild;},containerNode:function(){return this.domNode.firstChild.childNodes[1];},buttonNode:function(){return this.domNode.firstChild.lastChild;},tipNode:function(){return this.domNode.lastChild;}},editorNode:null,btnHbox:null,markupMethods:{onzIndexChange:function(){this.editorNode.style.zIndex=this.zIndex;this.curtainNode.style.zIndex=this.zIndex-1;},onwidthChange:function(){this.editorNode.style.width=this.width||"auto";},onvisibleChange:function(L){if(L){return ;}var J=this.visible,K=J?"block":"none";this.editorNode.style.display=K;if(this.modal){this.curtainNode.style.display=K;}},onleftChange:function(){this.editorNode.style.left=this.left||"";},ontopChange:function(){this.editorNode.style.top=this.top||"";},ontitleChange:function(){this.titleNode.firstChild.innerHTML=this.title||"";}},preBuildRendering:function F(){var J;var K=this.buttons;if(K&&!this.btnHbox){for(J in K){K[J].cssClass=(K[J].cssClass||"")+(this.noButtonCls?"":" mstrmojo-Editor-button");}this.addChildren([{scriptClass:"mstrmojo.HBox",cssText:"float:"+this.btnAlignment,slot:"buttonNode",alias:"btnHbox",children:K},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-clearMe",slot:"buttonNode"}]);}if(this.modal){this.cssClass+=" modal";}return this._super();},buildRendering:function B(){var J=this.placeholder;if(this._super()){if(!this.parent&&!J){document.body.appendChild(this.domNode);}return true;}return false;},getResizeHandler:function E(){var J=this.id;return function(){var K=mstrmojo.all[J];K.resizeDialog();K.positionDialog();};},postBuildRendering:function A(){this._super();if(this.modal&&this.visible){this.curtainNode.style.display="block";}if(!this._resizeHandler){var K=this._resizeHandler=this.getResizeHandler();D.attachEvent(window,"resize",K);}this.resizeDialog();this.positionDialog();try{this.domNode.focus();}catch(J){}return true;},resizeDialog:function G(){if(this.modal){this.resizeCurtain();}},resizeCurtain:function C(){var K=this,O=K.curtainNode,J=document.body,M=document.documentElement,N=O.style,L=K.curtainPosition;N.width=Math.max(J.clientWidth,M.scrollWidth)+"px";if(L&&L.h){N.height=L.h+"px";}else{N.height=Math.max(J.clientHeight,M.scrollHeight)+"px";}if(L&&L.y){N.top=L.y+"px";}K.raiseEvent({name:"resizeCurtain"});},positionDialog:function H(){var K=this.editorNode,M=this.left,L=this.top;if(!M||!L){D.center(K);var J=K.style;if(this.alignment==="top"){J.top="10px";}if(M){J.left=M;}if(L){J.top=L;}}},destroy:function(K){var J=this._resizeHandler;if(J){D.detachEvent(window,"resize",J);}this._super(K);}});mstrmojo.toast=function I(O,M,Q,J){var P="mojoToast9",N,L=M||3000;if(J&&J.id){P=J.id+"-"+P;}try{mstrmojo.all[P].destroy();}catch(K){}mstrmojo.insert({id:P,scriptClass:"mstrmojo.Label",cssClass:(J&&J.cssClass)?J.cssClass:"toastCss",text:O}).render();N=mstrmojo.all[P].domNode;if(J&&J.dom){J.dom.appendChild(N);}else{document.body.appendChild(N);D.bottomCenter(N);}window.setTimeout(function(){if(Q){Q();}try{mstrmojo.all[P].destroy();}catch(R){}},L);};mstrmojo.mask={show:function(){var J=mstrmojo.mask.win=mstrmojo.insert({scriptClass:"mstrmojo.Box",cssClass:"fullscreen-mask"});J.render();document.body.appendChild(J.domNode);},hide:function(){mstrmojo.mask.win.destroy();}};}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.registry","mstrmojo.tooltip","mstrmojo.HBox");var B=mstrmojo.dom,C=mstrmojo.css,A=1,G=2,F=3,E=function(I){var H=C.getStyleValue(I,"verticalAlign");return{top:A,bottom:F,middle:G}[H]||A;};mstrmojo.SliderBox=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.SliderBox",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" tabindex="{@tabIndex}" ><div class="valuePart" style="{@valueCssText}"><span class="valueLabel">{@valueLabel}</span><span class="valueText">{@valueText}</span></div><table class="sliderPart" style="{@sliderCssText}"><tbody><tr><td class="minText">{@min}</td><td class="sliderWrapper"></td><td class="maxText">{@max}</td></tr></tbody></table></div>',markupSlots:{valuePartNode:function(){return this.domNode.firstChild;},valueLabelNode:function(){return this.domNode.firstChild.firstChild;},valueTextNode:function(){return this.domNode.firstChild.lastChild;},sliderPartNode:function(){return this.domNode.lastChild;},minTextNode:function(){return this.domNode.lastChild.rows[0].cells[0];},maxTextNode:function(){return this.domNode.lastChild.rows[0].cells[2];},sliderNode:function(){return this.domNode.lastChild.rows[0].cells[1];}},markupMethods:{onmaxChange:function(){this.maxTextNode.innerHTML=this.max;},onminChange:function(){this.minTextNode.innerHTML=this.min;},onvalueTextChange:function(){this.valueTextNode.innerHTML=this.valueText;},onunsetChange:function(){var H=this.sliderBar.domNode;if(H){mstrmojo.css.toggleClass(H,"unset",this.unset);}}},tabIndex:-1,sliderRef:null,valueLabel:mstrmojo.desc(4104,"Value:"),valueText:"",min:"",max:"",interval:0,isSequential:false,unset:false,cssClass:"mstrmojo-SliderGroup",postCreate:function D(){if(!this.sliderRef){this.sliderRef={scriptClass:"mstrmojo.Slider",isHoriz:true,ontitleChange:function(){if(this.domNode&&this.title){this.domNode.setAttribute("title",this.title);}},onselectionChange:function(){if(!this.hasRendered){return ;}var I=this.items[this.selectedIndex]&&this.items[this.selectedIndex].n,H=this.parent;if(H.unset){H.unset=false;C.removeClass(this.domNode,"unset");}H.set("valueText",I);H.set("value",I);this.typeHelper.updateThumb();}};}this.sliderRef.slot="sliderNode";this.sliderRef.alias="sliderBar";this.addChildren(this.sliderRef);},preBuildRendering:function(){this._super();var M=this.min,I=this.max,K=mstrmojo.num.parseNumeric(this.value),J=this.items,H,L=this.sliderBar;if(this.isSequential){H=Math.floor((Math.max(Math.min(K,I),M)-M)/this.interval);if(isNaN(K)||K<M||K>I){this.unset=true;}}else{H=mstrmojo.array.find(J,"v",String(K));if(H==-1){this.unset=true;H=0;}}L.set("items",J);L.select(H||0);},postBuildRendering:function(){this._super();if(this.unset){C.addClass(this.sliderBar.domNode,"unset");}},alignSlider:function(K,H){var J=E(K),I,L;if(!this.valuePartNode){L=this.valueCssText||"";I=this.sliderCssText||"";if(J===A){this.valueCssText="top:0;"+L;this.sliderCssText="top:0;"+I;}else{if(J===F){this.valueCssText="bottom:0;"+L;this.sliderCssText="bottom:0;"+I;}else{this.valueCssText="height: 100%; line-height: "+H+"px;"+L;this.sliderCssText="height: 100%;"+I;}}}else{I=this.sliderPartNode.style;L=this.valuePartNode.style;if(J){if(J===A){I.top=L.top="0";}else{if(J===F){I.bottom=L.bottom="0";}else{L.height=I.height="100%";L.lineHeight=inlineHeight+"px";}}}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasBuilder");mstrmojo.ToolBar=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder],{scriptClass:"mstrmojo.ToolBar",cellCssClass:"mstrmojo-ToolBar-cell",markupString:'<table id="{@id}" class="mstrmojo-ToolBar {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-ToolBar-outercell"><table class="mstrmojo-ToolBar-innertable" cellspacing="0" cellpadding="0"><tr>{@tableHtml}</tr></table></td></tr></table>',markupSlots:{containerNode:function(){return this.domNode.rows[0].cells[0].firstChild.rows[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},buildChildren:function A(){var B=this.buildConfig;if(!B){this.buildConfig={};B=this.buildConfig;}B.target=this.target;return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.date","mstrmojo.dom","mstrmojo.HBox","mstrmojo.VBox");var Q=mstrmojo.date,J=mstrmojo.dom,L=mstrmojo.boxmodel,I=function(){return mstrmojo.locales.datetime;},D=Math.PI/6,O=1,P=2,M=3,A=I().AM_NAME,N=I().PM_NAME;function E(S,R){if(S===0){return"00";}if(S<10){return R?S.toString():"0"+S;}return S.toString();}function G(U){if(!U){return null;}var S=Q.parseTime(U),T=/.*\ [a|p]m/i.test(U);if(!S){var R=Q.parseDateAndOrTime(U);S=R&&R.time;if(!S){return null;}}if(T){S.h12=/.*\ am/i.test(U)?A:N;}return S;}function C(e,T){var c=this,S=L.offset(T,document.body),Y=(c._hh%12)*(Math.PI/6)+(Math.PI/360)*c._mm,Z=(Math.PI/30)*c._mm,a=0,b=0,W=S.left+80,V=S.top+80,U=0,X=0,R=function(k,h,f,n){var l=0,m=0,j=f-k,g=h-n;if(g===0){if(j>=0){m=Math.PI/2;}else{m=3*Math.PI/2;}}else{if(j===0){if(g>=0){m=0;}else{m=Math.PI/2;}}else{l=j/g;if(l>0&&j>0){m=Math.atan(l);}else{if(l>0&&j<0){m=Math.PI+Math.atan(l);}else{if(l<0&&j>0){m=Math.PI+Math.atan(l);}else{m=2*Math.PI+Math.atan(l);}}}}}return m;},d=function(g){var h=R(W,V,g.pageX,g.pageY),f;if(X===O){f=c._hh;c._hh=Math.floor(h*6/Math.PI);if(c._hh===0){if(f===23){c._hh=0;}else{if(f===11||f===12){c._hh=12;}else{if(f>12){c._hh+=12;}}}}else{if(c._hh===11){if(f===0){c._hh=23;}else{if(f===13||f===12){c._hh=11;}else{if(f>12){c._hh+=12;}}}}else{if(f>=12){c._hh+=12;}}}c._updateValue();}else{f=c._mm;c._mm=Math.floor(h*30/Math.PI);if(c._mm<15&&f>45){if(c._hh===23){c._hh=-1;}c._hh+=1;}else{if(c._mm>45&&f<15){if(c._hh===0){c._hh=24;}c._hh-=1;}}c._updateValue();}};U=R(W,V,e.pageX,e.pageY);a=Math.abs(Y-U);a=Math.min(a,2*Math.PI-a);b=Math.abs(Z-U);b=Math.min(b,2*Math.PI-b);if(a<D||b<D){if(b<a){X=P;c.active=P;}else{X=O;c.active=O;}J.attachEvent(T,"mousemove",d);J.attachEvent(T,"mouseup",function(f){J.detachEvent(T,"mousemove",d);});}}function F(V,S){var R=S.getContext("2d"),U=V.hour,T=V.min;R.save();R.clearRect(0,0,160,160);if(V.h12){R.save();R.fillStyle=U<12?"rgba(191, 223, 255, 1)":"rgba(246, 200, 126, .5)";R.fillRect(68,100,26,14);R.font="bold 14px sans-serif";R.fillStyle="black";R.fillText(U<12?"AM":"PM",70,112);R.restore();}R.translate(80,80);R.scale(0.3,0.3);R.rotate(-Math.PI/2);R.fillStyle="rgb(90, 158, 198)";R.save();R.rotate(U*(Math.PI/6)+(Math.PI/360)*T);R.lineWidth=12;R.beginPath();R.moveTo(-28,0);R.lineTo(105,0);R.stroke();R.restore();R.save();R.rotate((Math.PI/30)*T);R.lineWidth=10;R.beginPath();R.moveTo(-35,0);R.lineTo(162,0);R.stroke();R.restore();R.restore();}function H(T,S){var V=L.offset(S,document.body),R=V.left,U=V.top;if(T.pageX<R+68||T.pageX>R+94||T.pageY<U+100||T.pageY>U+114){return false;}return true;}mstrmojo.TimePicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.TimePicker",markupString:'<div class="mstrmojo-TimePicker {@cssClass}" style="{@cssText}"><div></div><div class="mstrmojo-Clock-time"><canvas width="157" height="157"></canvas></div></div>',cssText:"width:158px; height:"+(J.isIE?28:180)+"px",markupSlots:{hbNode:function(){return this.domNode.firstChild;},canvasNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onintervalChange:function(){this.interval=parseInt(this.interval,10);},onvalueChange:function(){if(this.domNode){var R,T;R=G(this.value);if(!R){var U=new Date(),S=Q.getDateJson(U);this.set("value",Q.formatTimeInfo(S,I().TIMEINPUTFORMATS[0]));return ;}this._hh=R.hour;this._mm=R.min;T=this.ctn.hb&&this.ctn.hb.tf;if(R.h12){T.set("visible",true);this.set("_tf",R.h12);this.set("_HH",E(R.hour>12?R.hour-12:(R.hour===0?12:R.hour),true));}else{T.set("visible",false);this.set("_HH",E(R.hour,true));}this.set("_MM",E(R.min));if(!J.isIE){F(R,this.canvasNode.firstChild);}}}},active:P,value:null,_hh:null,_HH:null,_mm:null,_MM:null,_tf:null,interval:5,children:[{scriptClass:"mstrmojo.HBox",alias:"ctn",slot:"hbNode",children:[{scriptClass:"mstrmojo.HBox",alias:"hb",cssText:"border: 1px solid #CECBCE;margin-left: 5px;background-color:#FFFFCC;",children:[{scriptClass:"mstrmojo.TextBox",alias:"hh",width:"20px",cssText:"border:none;text-align:right;",bindings:{value:"this.parent.parent.parent._HH"},onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=O;},onkeyup:function(){var R=parseInt(this.value,10);if(parseInt(this.ov,10)!==R&&R>=0&&R<=23){this.parent.parent.parent.updateHours(this.value);this.ov=this.value;}},onblur:function(){var R=parseInt(this.value,10);if(R<0||R>23){this.set("value",this.ov);}}},{scriptClass:"mstrmojo.Label",cssText:"width:5px;",text:":"},{scriptClass:"mstrmojo.TextBox",alias:"mm",width:"20px",cssText:"border:none;",bindings:{value:"this.parent.parent.parent._MM"},onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=P;},onkeyup:function(){var R=parseInt(this.value,10);if(parseInt(this.ov,10)!==R&&R>=0&&R<=60){this.parent.parent.parent.updateMinutes(this.value);this.ov=this.value;}},onblur:function(){var R=parseInt(this.value,10);if(R<0||R>60){this.set("value",this.ov);}}},{scriptClass:"mstrmojo.TextBox",width:"24px",cssText:"padding-right:2px;border:none;",alias:"tf",visible:false,onfocus:function(){this.ov=this.value;this.domNode.select();this.parent.parent.parent.active=M;},onkeyup:function(){var R=this.value&&this.value.toUpperCase(),S=this.parent.parent.parent;if((R===I().AM_NAME||R===I().PM_NAME)&&(R!==this.ov)){S._hh+=S._hh<12?12:-12;this.value=this.ov=R;S._updateValue();}},onblur:function(){var R=this.value&&this.value.toUpperCase();if(R!==I().AM_NAME&&R!==I().PM_NAME){this.set("value",this.ov);}},value:"AM",bindings:{value:"this.parent.parent.parent._tf"}}]},{scriptClass:"mstrmojo.VBox",alias:"stepper",slot:"stepperNode",cssText:"padding-left: 2px; padding-top: 0px;",children:[{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(8314,"Increase"),cssClass:"stepper up",text:"",onclick:function(){this.parent.parent.parent.incr();},onmousedown:function(){var R=this;this.tmr=window.setInterval(function(){R.parent.parent.parent.incr();},200);},onmouseup:function(){if(this.tmr){window.clearInterval(this.tmr);delete this.tmr;}}},{scriptClass:"mstrmojo.Button",title:mstrmojo.desc(8315,"Decrease"),cssClass:"stepper down",text:"",onclick:function(){this.parent.parent.parent.decr();},onmousedown:function(){var R=this;this.tmr=window.setInterval(function(){R.parent.parent.parent.decr();},200);},onmouseup:function(){if(this.tmr){window.clearInterval(this.tmr);delete this.tmr;}}}]}]}],init:function(R){if(this._super){this._super(R);}this._hh=0;this._HH="";this._mm=0;this._MM="";},focus:function B(){var R=this.ctn,S=R&&R.hb;if(!S||!this.visible){return ;}if(this.active===O){S.hh.focus();}else{if(this.active===M){S.tf.focus();}else{S.mm.focus();}}},postBuildRendering:function K(){var S=this.canvasNode.firstChild,R=this;if(this._super){this._super();}if(!this.value){this.value="12:00 AM";}if(J.isIE){this.canvasNode.style.display="none";}else{F({hour:this._hh,min:this._mm},S);S.onmousedown=function(T){C.call(R,T,S);};S.onclick=function(T){if(!H(T,S)){return ;}R.active=M;R._hh+=R._hh<12?12:-12;R._updateValue();};}},_updateValue:function(){var R;if(this._tf){R=I().TIMEINPUTFORMATS[0];}else{R=I().TIMEINPUTFORMATS[1];}this.set("value",Q.formatTimeInfo({hour:this._hh,min:this._mm},R));},incr:function(){var R;if(this.active===O){R=this._hh;if(R===23){R=-1;}this._hh=R+1;}else{if(this.active===M){if(this._hh>12){this._hh-=12;}else{this._hh+=12;}}else{R=parseInt(this._mm,10)+this.interval;if(R>=60){if(this._hh===23){this._hh=-1;}this._hh+=1;R=R-60;}this._mm=R;}}this._updateValue();},decr:function(){var R;if(this.active===O){R=this._hh;R=(R===0)?24:R;this._hh=R-1;}else{if(this.active===M){if(this._hh>12){this._hh-=12;}else{this._hh+=12;}}else{R=parseInt(this._mm,10)-this.interval;if(R<0){if(this._hh===0){this._hh=24;}this._hh-=1;R+=60;}this._mm=R;}}this._updateValue();},updateHours:function(S){var R=parseInt(S,10);if(this._tf){if(this._hh>=12&&R<12){this._hh=R+12;}else{this._hh=R;}}else{this._hh=R;}this._updateValue();},updateMinutes:function(R){this._mm=parseInt(R,10);this._updateValue();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.HBox","mstrmojo._HasBuilder","mstrmojo._CanMeasureChildren");function D(){return(this.renderMode!=="scroll")?this._super():true;}function C(){if(!this.hasRendered){return ;}var F=this.children||[],E=F.length-1;for(E;E>=0;E--){if(F[E].refresh){F[E].refresh();}}}mstrmojo.DocSection=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSection",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSection" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},postBuildRendering:D,childRenderOnAddCheck:D,refresh:C,getWidth:function A(){return this._super(1);}});mstrmojo.DocSectionHoriz=mstrmojo.declare(mstrmojo.HBox,[mstrmojo._HasBuilder,mstrmojo._CanMeasureChildren],{scriptClass:"mstrmojo.DocSectionHoriz",postBuildRendering:D,childRenderOnAddCheck:D,refresh:C,getHeight:function B(){return this._super(1);}});}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.num","mstrmojo.HBox","mstrmojo.Container");var E=mstrmojo.expr.DTP,P="mstrmojo.Button",G=mstrmojo.num,N=mstrmojo.validation.TRIGGER,D=50,B=500,L=10;function F(Q){var R=this;this._holdTimer=setInterval(function(){R.onclick(Q);},D);}function H(){if(this._holdTimer){clearInterval(this._holdTimer);delete this._holdTimer;}}function K(Q){var R=this;if(!this._holdTimer&&!this._startHoldTimer){this._startHoldTimer=setTimeout(function(){delete R._startHoldTimer;F.call(R,Q);},B);}}function A(){if(this._startHoldTimer){clearTimeout(this._startHoldTimer);delete this._startHoldTimer;}H.call(this);}function M(Q){A.call(this);}function C(Q){return Q?parseFloat(Q.toFixed(L)):Q;}function I(T){var Q=T.max,S=T.min,R=T.itv;return{scriptClass:"mstrmojo.HBox",alias:"hBox",children:[{scriptClass:P,alias:"minus",cssClass:"mstrmojo-StepperDIC-Operator",bindings:{enabled:function(){var W=this.parent.parent,V=W.numericValue;if(V<=S||!W.enabled){A.call(this);return false;}return true;}},onclick:function(V){var X=this.parent.parent,W=X.numericValue;if(!isNaN(W)){if(Q!==undefined&&W-R>Q){X.set("numericValue",Q);}else{if(S===undefined||W-R>=S){X.set("numericValue",C(W-R));}else{if(W>S&&W-R<S){X.set("numericValue",S);}}}}},onmouseup:M,onmousedown:K,text:"-"},{scriptClass:"mstrmojo.ValidationTextBox",cssClass:"mstrmojo-DataInputControl",dtp:E.DOUBLE,required:true,alias:"textInput",cssDisplay:"block",constraints:{trigger:N.ONKEYUP|N.ONBLUR,max:Q,min:S},bindings:{value:"this.parent.parent.numericValue",enabled:"!!this.parent.parent.enabled"},onValid:function(){this.parent.parent.set("numericValue",parseFloat(this.value));},onblur:function U(V){var X=this,W=this.parent.parent,Y=G.parseNumeric(this.value);if(!W.active&&!isNaN(Y)&&Y>=S&&Y<=Q){W.set("value",G.toLocaleString(W.numericValue));}if(this._super){this._super(V);}}},{scriptClass:P,alias:"plus",cssClass:"mstrmojo-StepperDIC-Operator",bindings:{enabled:function(){var W=this.parent.parent,V=W.numericValue;if(V>=Q||!W.enabled){A.call(this);return false;}return true;}},onclick:function(V){var X=this.parent.parent,W=X.numericValue;if(!isNaN(W)){if(S!==undefined&&W+R<S){X.set("numericValue",S);}else{if(Q===undefined||W+R<=Q){X.set("numericValue",C(W+R));}else{if(W<Q&&W+R>Q){X.set("numericValue",Q);}}}}},onmouseup:M,onmousedown:K,text:"+"}]};}mstrmojo.StepperDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.StepperDIC",cssClass:"mstrmojo-StepperDIC",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" mstrAttach:mouseup,mousedown></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},init:function O(R){if(this._super){this._super(R);}var Q=parseFloat(this.value);this.set("numericValue",isNaN(Q)?(this.dic.min||0):Q);this.set("children",I(this.dic));this.textInput=this.hBox&&this.hBox.textInput;this.plus=this.hBox&&this.hBox.plus;this.minus=this.hBox&&this.hBox.minus;},onmousedown:function(Q){this.active=true;},onmouseup:function(Q){this.active=false;this.textInput&&this.textInput.domNode.focus();},unrender:function J(Q){this.plus&&A.call(this.plus);this.minus&&A.call(this.minus);this._super(Q);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocLayoutViewer","mstrmojo._Formattable","mstrmojo._TouchGestures","mstrmojo._HasTouchScroller","mstrmojo.dom");function J(e){var f,V=this._newLinks,d=mstrmojo.hash.copy(V,this._allLinks),f=e?d:V;this._newLinks={};if(mstrMobileApp.isOnline()){return ;}var X=this.controller,W,a,Y=[],g=[],b;for(W in f){a=f[W];b=X.getLinkRequest(a);if(b){Y.push(b);g.push(a);}}var Z=Y.length;if(Z){var c=function(h){for(W=0;W<Z;W++){a=g[W];a.src.setLinkEnabled(h[W]);}};if(mstrApp.isHosted()){}else{this.model.getDataService().checkCachedLinkTargets(Y,{success:c,failure:mstrmojo.emptyFn});}}}function D(){var X=this.children,W,V;for(W=0,V=(X&&X.length)||0;W<V;W++){var Z=X[W],Y=Z.slot;if(Y){this.setSlotDimensions(Y,Z.height,Z.width);}}}mstrmojo.MobileDocLayoutViewer=mstrmojo.declare(mstrmojo.DocLayoutViewer,[mstrmojo._TouchGestures,mstrmojo._HasTouchScroller],{scriptClass:"mstrmojo.MobileDocLayoutViewer",layoutConfig:{h:{groupBy:"0",fixedHeaderNode:"auto",layout:"100%",fixedFooterNode:"auto",incFetchNode:"0"},w:{layout:"100%"}},formatHandlers:{domNode:["background-color"]},scrollerConfig:{vScroll:false,hScroll:false,bounces:false,showScrollbars:false},usesTouches:true,init:function O(V){this._super(V);this._newLinks={};this._allLinks={};},postBuildRendering:function T(){this._super();if(this.fixedFooterNode.clientHeight>0){D.call(this);}},preBuildRendering:function B(){this._super();this._scrollCssText="overflow:"+((!mstrmojo.dom.isWinPhone)?"hidden":"auto");var W=this.id,V=this.updateScroller;if(!this.afterScrollSubscr){this.afterScrollSubscr=this.docLayout.attachEventListener("afterScroll",W,function(){this.updateScroller();J.call(this);});this.model.attachEventListener("partialUpdate",W,V);}},mapID:null,setMapID:function I(V){this.mapID=V;},beforeViewHidden:function E(V){if(!this.mapID){return ;}var W=mstrmojo.all[this.mapID];if(W&&W.beforeViewHidden){W.beforeViewHidden(V);}this.mapID=null;},updateScrollerConfig:function R(){var W=this.scrollerConfig,Y=this.docLayout.containerNode;if(Y){var a=this.docLayout,X={start:0,end:Math.max(a.getWidth()-this.scrollboxWidth,0)},c={start:0,end:Math.max(a.getHeight()-this.scrollboxHeight,0)},V=(c.start!==c.end),Z=(X.start!==X.end),b;if(V||Z){b={x:X,y:c};}else{W.origin={x:0,y:0};}mstrmojo.hash.copy({scrollEl:this.scrollboxNode.firstChild,offset:b,vScroll:V,hScroll:Z,showScrollbars:false},W);if(!W.origin){W.origin=this._origin={x:0,y:0};}a.scrollBuffer=parseInt(mstrApp.rootView.getContentDimensions().h,10);}return this._super();},initScroller:function M(V){this._super(V);V.attachEventListener("scrollDone",this.id,function(W){this._origin={x:W.x,y:W.y};this.notifyScrollListeners(W);});},touchBegin:function N(W){var V=this.parent;if(V&&V.isAnimating&&V.isAnimating()){W.stop();return false;}return this._super(W);},shouldTouchBubble:function K(V){if(mstrmojo.dom.contains(this.scrollboxNode,V.target,true,this.domNode)){return this._super(V);}return true;},touchSwipeBegin:function L(X){if(this.shouldTouchBubble(X)){var W=this.parent,V=W.canScroll&&W.canScroll(X);if(V){this._parentScrolling=true;W.beginScroll(X);}return V;}this._super(X);},touchSwipeMove:function A(V){if(this._parentScrolling){this.parent.scroll(V);return ;}this._super(V);},touchSwipeEnd:function P(V){V.evt.handled=true;if(this._parentScrolling){delete this._parentScrolling;this.parent.endScroll(V);return ;}this._super(V);},touchTap:function S(){var V=this.controller;if(V&&V.viewTap){V.viewTap();}},renderChildren:function F(){this._super();this.updateScroller();},unrender:function Q(){delete this.scrollerConfig.origin;var V=this._scroller;if(V){delete V.origin;}if(this.subscr){mstrmojo.publisher.unsubscribe(this.subscr);delete this.subscr;}if(this.afterScrollSubscr){mstrmojo.publisher.unsubscribe(this.afterScrollSubscr);delete this.afterScrollSubscr;}this._super();},addLinkInfo:function H(W,V){this._newLinks[W]=V;},onRender:function C(){this._super();if(!this.subscr){var W=mstrmojo.publisher;this.subscr=W.subscribe(W.NO_SRC,W.CONNECTIVITY_CHANGED_EVENT,function(a){if(a){var X=this._allLinks,Y,Z;for(Y in X){Z=X[Y].src;if(!Z.linkEnabled){Z.setLinkEnabled(true);}}}else{J.call(this,true);}},this.id);}if((mstrApp.useBinaryFormat||mstrApp.isHosted())&&!mstrMobileApp.isOnline()){var V=this;window.setTimeout(function(){J.call(V);},100);}},setSlotDimensions:function U(c,b,Y){if(c==="layout"){var X=parseInt(this.height,10),W=this.fixedHeaderNode.clientHeight,a=this.fixedFooterNode.clientHeight,V=parseInt(b,10),Z=X-W-a;if(W+a>=X){b=0;}else{if(V!=Z){b=Z+"px";}}}this._super(c,b,Y);},getCaptureDimensions:function G(){return this.docLayout.getCaptureDimensions();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.Button","mstrmojo.DropDownButton","mstrmojo.Label","mstrmojo.WaitIcon");mstrmojo.IncFetch=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.IncFetch",markupString:'<div id="{@id}" class="mstrmojo-IncFetch {@cssClass}" style="{@cssText}"><div class="mstrmojo-IncFetch-content"></div><div class="mstrmojo-clearMe"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},preBuildRendering:function A(){var J=[],F=this.ds,M=this.cp,P=this.np,C=this.ps,E=this.id,G=2;var L=function(){mstrmojo.all[E].set("cp",this.text);};var H={f:1,p:Math.max(M-1,1),n:Math.min(M+1,P),l:P};for(var O in H){J.push(new mstrmojo.Button({iconClass:"arrow "+O,title:F[O],enabled:(H[O]!==M),text:H[O],onclick:L}));}var D=Math.max(Math.min(M-2,P-4),1),I=Math.min(D+4,P);for(var K=D;K<=I;K++){var N;if(K===M){if(I-D===4&&P!==5){N=new mstrmojo.DropDownButton({height:"13px",title:F.a?F.a:"",text:K,direction:"up",popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"goto",autoCloses:false,locksHover:true,children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.Label",cssText:"float:left;",text:F.gt},{scriptClass:"mstrmojo.TextBox",cssText:"float:left;",size:3,maxLength:String(P).length,onEnter:function(){var R=this.inputNode.value,T=this.parent.parent;if(R===""){T.close();return ;}var Q=parseInt(R,10),S=!(isNaN(Q)||Q<1||Q>P);if(S){mstrmojo.all[E].set("cp",Q);T.close();}else{this.setInvalidState(F.v.replace("###",P).replace("##",1).replace(" #",""));}}},{scriptClass:"mstrmojo.Button",cssText:"float:left",iconClass:"apply",title:F.ap?F.ap:"",onclick:function(){this.parent.children[1].onEnter();}}]}],onOpen:function(){mstrmojo.css.addClass(this.parent.domNode,["open"]);var Q=this.children[0].children[1].inputNode;window.setTimeout(function(){Q.focus();},0);},onClose:function(){mstrmojo.css.removeClass(this.parent.domNode,["open"]);this.children[0].children[1].cleanUp();}}});}else{N=new mstrmojo.Button({iconClass:"pg on",text:K});}}else{N=new mstrmojo.Button({iconClass:"pg",text:K,onclick:L});}J.splice(G++,0,N);}J.splice(G++,0,new mstrmojo.Label({text:F.pgs.replace("###",P).replace("##",""),cssText:"float:left;margin:1px 1px 1px 3px;"}));this._iWait=new mstrmojo.WaitIcon({cssText:"margin-top:-2px;"});J.push(this._iWait);this.addChildren(J);return this._super?this._super():true;},_set_cp:function B(D,C){if(parseInt(C,10)!==this.cp){this.raiseEvent({name:"fetch",v:C,iWait:this._iWait});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.DocTextfield");var I=mstrmojo.dom,K=mstrmojo.css,L=1,Q=2,A=3,N=4,P=5,E=6,B=1,D=["","CaptionOnly","IconOnly","IconLeft","IconRight","IconTop","Custom"];var M=[];M[L]=M[Q]=M[E]={minsp:0,mincs:0};M[A]=M[N]={minsp:10,mincs:5};M[P]={minsp:4,mincs:5};function F(V,S,X,R,T){var Y=I.position(V),U=I.position(V.parentElement),W=V.style;R=R||{};R={t:R.t||0,r:R.r||0,b:R.b||0,l:R.l||0};R.h=U.h-R.t-R.b;R.w=U.w-R.l-R.r;if(T){if(Y.h>R.h){W.height=R.h+"px";}if(Y.w>R.w){W.width=R.w+"px";}Y=I.position(V);}if(S){W.top=((R.h-Y.h)/2+R.t)+"px";}if(X){W.left=((R.w-Y.w)/2+R.l)+"px";}}function J(V,W,T){var S=document.createElement("img"),R=S.style;V.appendChild(S);I.attachEvent(S,"load",function(){var X=R.display;R.display="block";F(S,true,true);R.display=X;},true);S.className=T;var U=this.model.getDataService();S.src=(U&&U.getDocImage&&U.getDocImage(W))||W;}mstrmojo.DocButton=mstrmojo.declare(mstrmojo.DocTextfield,null,{scriptClass:"mstrmojo.DocButton",pressed:false,markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocButton {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div class="mstrmojo-DocButton-Container" mstrAttach:click,mousedown><div class="mstrmojo-DocButton-IconNode"></div><div class="mstrmojo-DocButton-ValueNode" style="{@valueNodeCssText}">{@v}</div></div><div class="mstrmojo-DocButton-EffectOverlay"></div>{@buttonNodeMarkup}</div>',markupSlots:{iconNode:function(){return this.domNode.firstChild.firstChild;},valueNode:function(){return this.domNode.firstChild.lastChild;},buttonContainerNode:function(){return this.domNode.firstChild;}},markupMethods:{onpressedChange:function(){var R=!!this.pressed,U=this.defn,T=this.domNode,S=this.fmts;K.toggleClass(T,"pressed",R);this.setBackgroundColor();this.valueNode.style.color=R?U.fhlc:(S.color||"");},onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},formatHandlers:{domNode:["T","z-index","D","B","P","background-color"],valueNode:["font","fx","color","white-space","overflow"]},setBackgroundColor:function H(){this.domNode.style.backgroundColor=(!!this.pressed)?this.defn.bhlc:(this.fmts["background-color"]||"");},getAnchor:function O(){return this.domNode;},getDPI:function C(){return this.model.dpi;},buildRendering:function G(){this._super();var S=this.defn,j=this.domNode,V=this.buttonContainerNode,g=this.iconNode,m=this.valueNode,d=parseInt((S&&S.dpst)||1,10),e="px";K.toggleClass(j,D[d],true);j.onselectstart=j.ondragstart=function(){return false;};var b=this.getFormats(),X=parseInt(K.getComputedStyle(V).borderWidth,10)*2;if(isNaN(X)){X=0;}var Z=parseFloat(b.width)-X,k=parseFloat(b.height)-X,W=M[d],a=W.minsp,o=W.mincs,c,Y=g.style,f=m.style;function U(p,q){Y.width=p+e;Y.height=q+e;}var n=V.style;n.height=k+e;n.width=Z+e;switch(d){case P:var T=this.getDPI(),R=k+K.getBorderWidths(b["border-width"],T).h+K.getPaddings(b.padding,T).h;c=Math.max(0,Math.min(k-a-o,R*0.6));U(Z,c);F(g,false,true);F(m,true,false,{t:c+a},true);break;case A:case N:c=Math.max(0,Math.min(k,Z-a-o));U(c,c);F(g,true,false);f[(d===A)?"left":"right"]=(c+a)+e;F(m,true,false);break;case L:F(m,true,false);break;case Q:case E:break;}if(B===parseInt(S.fe,10)){K.addClass(j,"gloss");}J.call(this,g,S.nmurl,"normal");J.call(this,g,S.hlurl||S.nmurl,"hilight");var l=document.createElement("div");K.addClass(l,"mstrmojo-DocButton-IconMaskNode");g.appendChild(l);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.dom");var E=mstrmojo.dom,G=mstrmojo.css,D=mstrmojo.Button.newIconButton,A="mstrmojo-oivmSprite ",F=0,K=1,L=2,I={0:"inline",1:"above",2:"below"};function B(M){var N=mstrmojo.boxmodel.offset(M,document.body);return{left:N.left,top:N.top,width:M.offsetWidth,height:M.offsetHeight};}mstrmojo.OIVMDICPopup=mstrmojo.declare(mstrmojo.Popup,null,{scriptClass:"mstrmojo.OIVMDICPopup",autoCloses:false,cssClass:"inline",markupString:'<div dic="1" id={@id} class="mstrmojo-OIVMDICPopup {@cssClass}" style="{@cssText}" mstrAttach:keydown><div class="toolbar"></div><div class="dataInputControl"></div><div class="boxtip"></div></div>',markupSlots:{toolbarNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.children[1];},tipNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onheightChange:function(){this.domNode.style.height=this.height||"";},onwidthChange:function(){this.domNode.style.width=this.width||"";},ontopChange:function(){this.domNode.style.top=this.top||"";},onleftChange:function(){this.domNode.style.left=this.left||"";},oncssClassChange:function(){this.domNode.className="mstrmojo-OIVMDICPopup "+this.cssClass;}},setStyle:function(){var U=this.widget,b=U.dic,N=U.popupStyle,W=B(U.openerNode),V=this.domNode,Q=V.style,X=U.domNode.style,M=this.tipNode,O=b.wm?b.w:W.width,a=b.hm?b.h:W.height,T;this.set("cssClass",I[N]);if(N===F){for(T in W){Q[T]=W[T]+"px";}U.set("width",O-2);X.width=(O-8)+"px";X.height=(a>8)?(a-8)+"px":"auto";}else{if(N===K){var Z=O,R=W.left+W.width/2-21,Y=W.top,S=Y<76;Y=S?Y+W.height+15:Y-76;M.className=S?"boxtip up":"boxtip";Q.left=R+"px";Q.top=Y+"px";Q.width=U.domNode.scrollWidth+"px";Q.height="44px";Z=Z>100?(Z+70):200;var P=document.body.offsetWidth-R-Z-parseInt(G.getStyleValue(V,"paddingLeft"),10)-parseInt(G.getStyleValue(V,"paddingRight"),10);P=P>0?0:P;Q.left=R+P+"px";M.style.left=15-P+"px";}else{if(N===L){Q.top=W.top+"px";Q.left=W.left+"px";Q.height=X.height;Q.width=X.width;}}}},onOpen:function C(){var M=this.widget,O=this.lastwidget;if(O!=M){if(O){this.removeChildren(O);}this.lastwidget=M;}if(M.hasRendered){M.unrender();}this.addChildren([M]);this.setStyle();var N=this;this.md=this.md||function(Q){var R=E.eventTarget(self,Q),P=E.findAncestorByAttr(R,"dic",true);if(!P&&!mstrmojo.all.mojoAlertx9){N.onBlur();E.preventDefault(self,Q);}};this.mw=this.mw||function(P){N.onBlur();};E.attachEvent(document,"mousedown",this.md);E.attachEvent(document,E.isFF?"DOMMouseScroll":"mousewheel",this.mw);},onBlur:function(){if(this.widget.popupStyle===F){this.onApply();}else{this.onCancel();}},onClose:function(){E.detachEvent(document,"mousedown",this.md);E.detachEvent(document,E.isFF?"DOMMouseScroll":"mousewheel",this.mw);this.toolbar.apply.set("enabled",false);this.set("hasInvalidData",false);if(this.widget&&this.widget.hasRendered){this.widget.lockPopup();}},onApply:function(){if(this.widget.applyChanges()!==false){this.close();}},onCancel:function(){if(this.widget&&this.widget.hasRendered){this.widget.cancelChanges();}this.close();},onkeydown:function J(N){var M=N.hWin,O=N.e||M.event;if(this.widget.applyOnEnter&&O.keyCode===13){this.onApply();}else{if(O.keyCode===27){this.onCancel();}}},enableApply:function(){this.toolbar.apply.set("enabled",true);},preBuildRendering:function H(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));}if(this._super){return this._super();}else{return true;}},onhasInvalidDataChange:function(){var M=this.invalidCurtain;if(!M){M=this.invalidCurtain=document.createElement("div");M.className="mstrmojo-fullscreen-curtain";document.body.appendChild(M);}M.style.display=this.hasInvalidData?"block":"none";},children:[{scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"toolbar",children:[D(mstrmojo.desc(134,"Apply"),A+"tbApply greyed",function(){this.parent.parent.onApply();},null,{enabled:false,alias:"apply",onenabledChange:function(){G.toggleClass(this.domNode,"greyed",!this.enabled);}}),D(mstrmojo.desc(221,"Cancel"),A+"tbCancel",function(){this.parent.parent.onCancel();})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo._HasOwnAvatar","mstrmojo.css","mstrmojo.dom");var E=mstrmojo.css,D=mstrmojo.dom;function F(K){var L=K.src.node,M=this.children.filter(function(N){return D.contains(N.domNode,L,true,this.domNode);});return M[0];}function J(K){var N=K.tgt,V=this.children,R=D.getMousePosition(N.e,N.hWin),Q,S,U,M,T,P,L=R.y;for(var O=V.length-1;O>=0;O--){U=V[O];Q=D.position(U.domNode);T=Q.h;M=Q.y;P=M+T/2;if(P<L&&(O===V.length-1||L<=M+T)){S=O;break;}else{if((O===0||M<L)&&L<=P){S=O-1;break;}}}return S;}function I(K){return K===-1?"top":"bottom";}mstrmojo.threshold.ThresholdRowPanel=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.threshold.ThresholdRowPanel",dropZone:true,draggable:true,restrictedToAxis:"y",avatarCssClass:"threshold-drag-avatar",getDragData:function H(K){return{row:F.call(this,K)};},createAvatar:function B(M,L){var K=L.src.data.row.domNode.cloneNode(true);K.style.left=D.position(this.domNode).x+"px";return K;},isDragValid:function G(K){var L=K.getCtxtDragData().row;return !(this.children.length===1||!L||L.draggableNode!==K.src.node)||this._super(K);},ondragstart:function(K){this._super(K);this.removeChildren(K.getCtxtDragData().row);},ondragmove:function A(M){var O=M.getCtxtDragData(),N=this.children,L=J.call(this,M);var K=O.lastRowIdx;if(K!==L){if(K!==undefined){E.removeClass(N[Math.max(K,0)].domNode,I(K));}E.addClass(N[Math.max(L,0)].domNode,I(L));O.lastRowIdx=L;}this._super(M);},ondragend:function C(L){var M=L.src.data,K=M.lastRowIdx;if(K!==undefined){E.removeClass(this.children[Math.max(K,0)].domNode,I(K));}this._super(L);this.parent.parent.model.moveThreshold(L.getCtxtDragData().row.idx,K+1);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.ME.Enum");mstrmojo.requiresDescs();var M=mstrmojo.dom,B=mstrmojo.string,D=mstrmojo.Widget;var H=/\r?\n?----\r?\n?/;function F(N){var O=B.decodeHtmlString((N||{}).desc||"",true).split(H);return{desc:O[0],example:O.length===2?O[1]:""};}mstrmojo.ME.FunctionInfo=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.FunctionInfo",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="mstrmojo-FunctionInfo-container"><div class="mstrmojo-FunctionInfo-syntax"></div><div class="mstrmojo-FunctionInfo-desc"></div><div class="mstrmojo-FunctionInfo-eg"><span class="icon" t="icon"></span><span class="text"></span></div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},syntaxNode:function(){return this.domNode.firstChild.firstChild;},descNode:function(){return this.domNode.firstChild.childNodes[1];},egNode:function(){return this.domNode.firstChild.lastChild;},egTextNode:function(){return this.domNode.firstChild.lastChild.lastChild;}},markupMethods:{onvisibleChange:D.visibleMarkupMethod,onfoiChange:function(){this.syntaxNode.innerHTML=B.htmlAngles(this.syntax)||"";this.descNode.innerHTML=this.desc;this.egTextNode.innerHTML=this.example;this.egNode.style.display=this.example?"block":"none";this.updateScrollbars();}},foi:{},syntax:"",desc:"",example:"",init:function L(N){this._super(N);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-FunctionInfo");},setupScrollNodes:function C(){if(!mstrmojo.dom.ISIE8){this.scrollNode=this.containerNode;}},onfoiChange:function A(){this.set("syntax",this.getFunctionSyntax());this.set("desc",this.getDesc()+" "+this.getHelpTopic());this.set("example",this.getExample());},getFunctionSyntax:function K(R){var T=R||this.foi;if(!T){return"";}if(T.did<0){return T.n;}var Q=T.pars,S=T.pros,O=[],P,N;O.push(T.n);S=mstrmojo.hash.clone(S)||[];if(T.ios){S.push({n:"SortBy"});}if(T.sqt===5){S.push({n:"BreakBy"});}if(this.showFullSyntax){if(S.length>0){O.push("<");for(P=0,N=S.length;P<N;P++){if(mstrmojo.array.indexOf(mstrmojo.ME.Enum.NonExposableParams,S[P].n)===-1){O.push(S[P].n);O.push(", ");}}O.pop();O.push(">");}}O.push("(");for(P=0,N=Q.length;P<N;P++){O.push(Q[P].n);if(P!==(N-1)){O.push(", ");}}O.push(")");return O.join("");},getDesc:function E(){return F(this.foi).desc;},getExample:function J(){return F(this.foi).example;},getHelpTopic:function G(N){var O=N||this.foi;if(!O||O.did===mstrmojo.ME.Enum.SHORTCUT_FUNCTIONS.Row_Count){return"";}return mstrmojo.ME.MetricDataService.getFunctionHelpTopic(O.h);},useRichTooltip:true,showTooltip:function I(N,Q){var P=M.eventTarget(Q,N),O=this.foi;if(P&&P.getAttribute("t")==="icon"){this.richTooltip=this.getTooltip(O,P);if(this.richTooltip){this._super(N,Q);}}},getTooltip:function(Q,R){var O=M.position(R),P=R.egTip||"";var N={areaId:Q._renderIdx+"text",cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:P,top:O.y-75,left:O.x+O.w-30,enableHover:false};return N;}});mstrmojo.ME.FunctionInfo.getDescAndExample=F;}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Box","mstrmojo.hash");var C=mstrmojo.css,F=mstrmojo.hash,B="mstrmojo-st-removeFilter";mstrmojo.express.ui.SubmenuEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.express.ui.SubmenuEditor",contentScriptClass:"mstrmojo.Box",contentConfig:null,menuItemNode:undefined,contentNode:undefined,init:function E(G){this.children[1].scriptClass=G.contentScriptClass;F.copy(G.contentConfig||{},this.children[1]);this._super(G);this.children[0].text=this.text;this.contentNode.onSubmenuOpen=this.contentNode.onSubmenuOpen||mstrmojo.emptyFn;C.addWidgetCssClass(this,"mstrmojo-SubmenuEditor");},_set_xtab:function(H,G){this.contentNode.xtab=G;return true;},_set_cell:function(H,G){this.contentNode.cell=G;return true;},_set_visible:function(H,G){this.menuItemNode.set("visible",G);this.contentNode.set("visible",false);return true;},children:[{scriptClass:"mstrmojo.Widget",alias:"menuItemNode",markupString:'<div class="mstrmojo-MenuItem-text" mstrAttach:click><div class="mstrmojo-MenuItem-textNode">{@text}</div><div class="mstrmojo-MenuItem-arw"></div></div>',onclick:function(){var G=this.parent.contentNode;G.set("visible",!G.visible);}},{scriptClass:"mstrmojo.Box",alias:"contentNode",cssClass:"mstrmojo-SubmenuItem-content",visible:false,onSubmenuClosed:function D(){this.set("visible",false);mstrmojo.all[this.parent.parentID].close();},onvisibleChange:function A(){var G=this.visible;if(G){this.onSubmenuOpen();}C.toggleClass(document.getElementById(this.parent.parentID),B,G);}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.string","mstrmojo.ListBase","mstrmojo._IsList");var G=",",F=mstrmojo.string;mstrmojo.TableLayoutList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.TableLayoutList",cssClass:"mstrmojo-TableLayoutList",styleCssClass:"",itemIdField:"v",allowUnlistedValues:false,tableLayoutCssStyle:"auto",multiSelect:false,titleItems:null,items:null,itemsPerRow:0,getLeftEndTitle:function E(H){return"";},getRightEndTitle:function D(H){return"";},getTitleRowMarkup:function A(){var L=this.titleItems;if(L){var K='<tr><td class="left_text">'+this.getLeftEndTitle(-1)+"</td>",H=L.length,J=0,I;for(J;J<H;J++){I=L[J];K+='<td class="item_title" title="'+I+'">'+I+"</td>";}K+='<td class="left_text">'+this.getRightEndTitle(-1)+"</td></tr>";return K;}return"";},_markupPrefix:function(){return'<table class="tableLayoutList" style="table-layout:'+this.tableLayoutCssStyle+'" cellspacing="0" cellpadding="0"><tbody>'+this.getTitleRowMarkup();},_markupSuffix:function(){return"</tbody></table>";},getItemMarkup:function(L,I){var K='<{@tag} class="item {@cls}" idx="{@idx}" title="{@en@n}" style="{@style}">{@en@n}</{@tag}>',H=this.getLeftEndTitle(I),J=this.getRightEndTitle(I),M=this.itemsPerRow;H='<td class="left_text" title="'+H+'">'+H+"</id>";J='<td class="right_text" title="'+J+'">'+J+"</id>";if(M>0){K=(I%M===0?"<tr>"+H:"")+"<td>"+K+"</td>"+((I+1)%M===0?J+"</tr>":"");}else{K='<td><div class="item_wrapper" idx="'+I+'">'+K+"</div></td>";if(!I){K="<tr>"+H+K;}else{if(I===this.items.length-1){K=K+J+"</tr>";}}}return K;},_getItemNode:function(H){var I=this.itemsNode,K=this.itemsPerRow,J=(this.titleItems?1:0)+((K>0)?parseInt(H/K,10):0),L=1+((K>0)?(H%K):H);return I.rows[J].cells[L].firstChild;},init:function(H){this._super(H);mstrmojo.css.addWidgetCssClass(this,this.styleCssClass);},onchange:function B(){var J,I=[];if(!this.multiSelect){J=this.selectedItem.v;}else{var H;for(H in this.selectedIndices){I.push(this.items[H].v);}J=I.join(this.delim||G);}this.set("value",J);},postBuildRendering:function C(){this._super();var H=[];if(this.multiSelect){var J=this.value.split(G),I;for(I=0;I<J.length;I++){H.push({v:J[I]});}}else{H.push({v:this.value});}this.setSelectedItems(H);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui.editors._HostsControls","mstrmojo._HasLayout","mstrmojo.css");mstrmojo.ui.editors.controls.ControlGroup=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.editors._HostsControls,mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.ControlGroup",layoutConfig:{w:{containerNode:"100%"},xt:true},shouldPropagateEnabled:true,init:function A(B){this._super(B);mstrmojo.css.addWidgetCssClass(this,"ctrl-group");}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ui.editors.controls.ControlGroup,{onenabledChange:mstrmojo.Container.enabledMarkupMethod});}());(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.ui._HasScroller","mstrmojo.css");var B=mstrmojo.css;mstrmojo.ui.ColumnContainer=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ColumnContainer",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnContainer {@cssClass}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;},scrollNode:function(){return this.domNode.firstChild;}},markupMethods:{onnextChange:function A(){B.toggleClass(this.domNode,"hasNext",!!this.next);}},active:false,next:null,idx:undefined,updateColumnContainer:function D(){var E=this.next;if(E){E.updateColumnContainer();}},onactiveChange:function C(){B.toggleClass(this.domNode,"active",this.active);var E=this.next;if(E){E.updateColumnContainer();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Container","mstrmojo._BindTargetChildren","mstrmojo.TabButton","mstrmojo.TabStripBase");var E=mstrmojo.array;function D(G,F){if(G.autoHide){G.set("visible",F);}}mstrmojo.TabStrip=mstrmojo.declare(mstrmojo.TabStripBase,[mstrmojo._BindTargetChildren],{scriptClass:"mstrmojo.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-TabStrip {@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},autoHide:true,tabButtonClass:"TabButton",init:function C(F){if(F&&F.autoHide){F.visible=false;}this._super(F);},addTabButtons:function B(G,N){var J=this.targetProps||{},S=J.childTitle||"n",O=J.childColor||"tbc",R=this.tabButtonClass,K=[],Q=this.target,F=function(T){Q.set("selected",this.target);};mstrmojo.requiresCls("mstrmojo."+R);for(var L=0,M=(G&&G.length)||0;L<M;L++){var P=G[L],I=P[S];if(I){var H=mstrmojo.insert({scriptClass:"mstrmojo."+R,title:I,backgroundColor:P[O],target:P,onclick:F});K.push(H);}}if(K.length){D(this,K.length);this.addChildren(K,N);}this.selectionChange();},removeTabButton:function A(G){var F=mstrmojo.array.filter(this.children,function(H){return(H.target===G);},{max:1});if(F&&F[0]){D(this,F.length-1);this.removeChildren(F[0]);F[0].destroy();}},clearButtons:function(){this.removeChildren();}});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo._HasLayout");mstrmojo.ui.editors.controls.PreviewButton=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.PreviewButton",markupString:'<div id="{@id}" class="mstrmojo-ui-PreviewButton {@cssClass}" style="{@cssText}"><div class="cf" mstrAttach:click><div class="preview"></div><div class="btn">&nbsp;</div></div><div class="host"></div></div>',markupSlots:{previewNode:function(){return this.domNode.firstChild.firstChild;},btnNode:function(){return this.domNode.firstChild.lastChild;},widgetHostNode:function(){return this.domNode.lastChild;},clickableNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},layoutConfig:{h:{previewNode:"100%",btnNode:"100%",widgetHostNode:"0px"},w:{previewNode:"100%",btnNode:"20px",widgetHostNode:"all"},xt:true},isHostedWithin:false,getLayoutOffsets:function B(){return{h:2,w:2};},anchorSlot:"clickableNode",updatePreview:function C(){throw new Error(this.scriptClass+" must implement updatePreview.");},getPopupHostNode:function A(){return this.widgetHostNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.FieldSet","mstrmojo.Table");var D=mstrmojo.hash,B=mstrmojo.num;var C=function(F){return D.copy(F,{scriptClass:"mstrmojo.ValidationTextBox",maxLength:6,dtp:4,min:0,max:100,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP},bindings:{m:F.modelBinding,value:function(){var G=this.m[this.pr];return G==null?"":this._PT2UserUnits(G).replace(/([\.,][1-9]{1,})0{1,}$/,"$1").replace(/\.$/,".0").replace(/,$/,",0");}},postCreate:function(){this.markupMethods=D.copy({onvalueChange:function(){this.inputNode.value=this.value;}},D.copy(this.markupMethods));},onValid:function(){this.m[this.pr]=this._UserUnits2PT(this.value);},_PT2UserUnits:function(G){return B.toLocaleString(B.convertToLocalUnits(B.toString(G),mstrApp.units));},_UserUnits2PT:function(G){return B.toLocaleString(B.toString(B.convertToUSUnits(G,mstrApp.units)));}});};var A=function(F,G){return{scriptClass:"mstrmojo.Label",text:F,slot:G};};mstrmojo.PaddingFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.PaddingFormatter",cssClass:"mstrmojo-PaddingFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){D.make(this.model,mstrmojo.Obj);}},init:function E(F){var G=mstrConfig.unitsLabel||mstrApp.unitsLabel;this.children=[{scriptClass:"mstrmojo.FieldSet",alias:"padding",cssClass:"mstrmojo-FormatEditor-padding",legend:mstrmojo.desc(2883),children:[{scriptClass:"mstrmojo.HBox",cssClass:"paddingBox",children:[{scriptClass:"mstrmojo.Table",rows:2,cols:3,children:[A(mstrmojo.desc(3528),"0,0"),C({pr:"LeftPadding",slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"0,2"),A(mstrmojo.desc(3526),"1,0"),C({pr:"TopPadding",slot:"1,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"1,2")]},{scriptClass:"mstrmojo.Table",rows:2,cols:3,children:[A(mstrmojo.desc(3529),"0,0"),C({pr:"RightPadding",slot:"0,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"0,2"),A(mstrmojo.desc(3527),"1,0"),C({pr:"BottomPadding",slot:"1,1",modelBinding:"this.parent.parent.parent.parent.model"}),A(G,"1,2")]}]}]}];this._super(F);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Container","mstrmojo._FormatDefinition","mstrmojo.TristateCheckBox","mstrmojo.FieldSet","mstrmojo.Table");var A=mstrmojo.hash,B=mstrmojo._FormatDefinition;mstrmojo.AlignmentFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.AlignmentFormatter",cssClass:"mstrmojo-AlignmentFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){A.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"textAlignment",cssClass:"mstrmojo-FormatEditor-textAlignment",legend:mstrmojo.desc(2065),children:[{scriptClass:"mstrmojo.Table",rows:2,cols:2,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3691),slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.Horizontal,bindings:{m:"this.parent.parent.parent.model",value:"this.m.Horizontal"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.Horizontal=this.value;}},slot:"0,1"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3692),slot:"1,0"},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.Vertical,bindings:{m:"this.parent.parent.parent.model",value:"this.m.Vertical"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.Vertical=this.value;}},slot:"1,1"}]}]},{scriptClass:"mstrmojo.FieldSet",alias:"textControl",cssClass:"mstrmojo-FormatEditor-textControl",legend:mstrmojo.desc(2884),children:[{alias:"TextWrap",scriptClass:"mstrmojo.TristateCheckBox",text:mstrmojo.desc(2070),checked:false,grayed:false,pr:"TextWrap",bindings:{m:"this.parent.parent.model",checked:function(){return this.m[this.pr]==-1;},grayed:function(){return(typeof this.m[this.pr]=="undefined")||this.m[this.pr]=="pru";}},oncheckedChange:function(C){if(this.m){this.m.set(this.pr,this.checked?-1:0);}}},{scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(5159)},{scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:B.TextDirection,bindings:{m:"this.parent.parent.parent.model",value:"this.m.TextDirection"},onvalueChange:function(){if(this.m&&this.value!=null){this.m.TextDirection=this.value;}},slot:"1,1"}]}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Table","mstrmojo.SelectBox","mstrmojo._CanValidate","mstrmojo.MetricSelectorUtility");var D=mstrmojo.MetricSelectorUtility,K=mstrmojo.validation,G=mstrmojo.expr,E=mstrmojo.num,N=D.OP,F=[{n:mstrmojo.desc(2795,"Equals"),v:N._EQUALS},{n:mstrmojo.desc(2796,"Does not equals"),v:N._NOT_EQUALS},{n:mstrmojo.desc(521,"Greater than"),v:N._GREATER},{n:mstrmojo.desc(522,"Greater than or equal to"),v:N._GREATER_EQUAL},{n:mstrmojo.desc(523,"Less than"),v:N._LESS},{n:mstrmojo.desc(524,"Less than or equal to"),v:N._LESS_EQUAL},{n:mstrmojo.desc(519,"Between (enter value1;value2)"),v:N._BETWEEN},{n:mstrmojo.desc(614,"Not between (enter value1;value2)"),v:N._NOT_BETWEEN},{n:mstrmojo.desc(898,"In (enter value1;value2; ...;valueN)"),v:N._IN},{n:mstrmojo.desc(2394,"Not In (enter value1;value2; ...;valueN)"),v:N._NOT_IN},{n:mstrmojo.desc(2202,"Is null"),v:N._IS_NULL},{n:mstrmojo.desc(2203,"Is not null"),v:N._IS_NOT_NULL}],L=F.slice(0,10),J="padding:2px 2px 2px 2px",H=F.slice(10,12);var C=function(Z,S,T,V,U){var W;if(U===2){return S;}var a=String(Z).split(";"),X=K.STATUSCODE.INVALID_VALIDATOR,R=K.STATUSCODE.VALID;if(V&&a&&a.length>1){S.code=X;}else{for(W=0;W<a.length;W++){var Y=parseFloat(a[W],10);if(isNaN(Y)||(T&&((a[W].match(/^\d+(\.\d+)?%$/)===null&&a[W].match(/^\d+(\.\d+)?$/)==null)||Y<0||Y>100))||(!T&&a[W].match(/\d+$/)===null)){S.code=X;}if(S.code!==R){break;}}}if(S.code!==R){S.msg=mstrmojo.desc(6103,"Please fix any invalid data");}return S;};var M=function(R){R=parseFloat(R);return isNaN(R)?"54px":((R*72/16)+"pt;");},Q=function(T){if(T.hasRendered){var S=T.domNode.style;S.font=T.font;S.width=M(S.fontSize);}else{var R=T.font.match(/[^\s]*?pt/)||[];T.cssText=T.cssText+" font:"+T.font+"; width:"+M(R[0]);}},I=function(R){if((R>=8&&R<=16)||(R>=23&&R<=25)){return false;}return true;};mstrmojo.MetricQualification=mstrmojo.declare(mstrmojo.Table,null,{scriptClass:"mstrmojo.MetricQualification",cssClass:"qs",cssText:"width:100%",markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?mstrmojo.css.DISPLAY_TABLE:"none";}},getClientHeight:function P(){return this.domNode.clientHeight+2;},rows:1,cols:4,layout:[{cells:[{cssText:"width:100%"},{cssText:"width:56px"},{cssText:"width:56px"},{cssText:"width:18px"}]}],init:function(R){if(this._super){this._super(R);}this._init();},_init:function(T){var S;switch(this.qua){case 0:this.low=(this.da&&this.da.low)||0;this.high=(this.da&&this.da.high)||0;break;case 1:case 2:this.low=1;this.high=(this.da&&this.da.cnt)||0;break;case 3:case 4:this.low=0;this.high=100;break;}if(T){this.cs=[];this.f=this.ft=null;}var V=D.getOpIdxByfunc(this.f,this.ft),U=I(this.dt)?N._GREATER_EQUAL:N._IS_NULL;this.set("opId",(V==-1)?U:V);var R=(this.cs&&this.cs.length>0)?E.toLocaleString(this.cs[0].v):"";if(this.opId===N._IN||this.opId===N._NOT_IN){for(S=1;S<this.cs.length;S++){R+=";"+E.toLocaleString(String(this.cs[S].v));}}else{this.set("cs2",(this.cs&&this.cs.length>1)?E.toLocaleString(this.cs[1].v):"");}this.set("cs1",R);this.vldTbL.validate();this.vldTbH.validate();this.changeQual=false;},updateData:function B(R,S){this.da=R;this.updateExpr(S);},updateExpr:function A(R){if(R){this.cs=R.cs;this.f=R.f;this.ft=R.ft;this.qua=R.qua;}this._init();},onquaChange:function O(R){this._init(true);this.func.items=(this.qua!==0)?L:I(this.parent.dt)?F:H;this.func.refresh();this.changeQual=true;this.onchange();},children:[{slot:"0,0",alias:"func",scriptClass:"mstrmojo.SelectBox",cssText:"width:100%",size:1,bindings:{sv:"this.parent.opId",font:"this.parent.font"},onfontChange:function(){if(this.hasRendered){this.domNode.style.font=this.font;}else{this.cssText="width:100%;font:"+this.font;}},onsvChange:function(){if(this.sv!==null&&this.sv!==undefined){this.set("selectedItem",{v:this.sv});}},postCreate:function(){if(mstrmojo.dom.isIE){this.itemDisplayField="n";this.showItemTooltip=true;}this.items=(this.parent.qua!==0)?L:I(this.parent.dt)?F:H;},onchange:function(){var S=this.parent,T=this.selectedItem;if(T&&T.v!==null&&T.v!==undefined){var R=D.getIncludeByOp(T.v);S.include=R;if(S.parent&&R!==S.parent.include){S.changeInclude=true;}else{S.changeInclude=false;}S.set("opId",T.v);}if(mstrApp.isMobile&&(T.v===N._IS_NULL||T.v===N._IS_NOT_NULL)){if(S.onchange){S.onchange();}}}},{slot:"0,1",alias:"vldTbL",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(R){var S={id:this.id,code:K.STATUSCODE.VALID,msg:""},T=this.parent;C(R,S,(T.qua===3||T.qua===4),(T.opId!==8&&T.opId!==9),(T.numFmts&&T.numFmts.cat));return S;}},bindings:{visible:"this.parent.opId!=10&&this.parent.opId!=11",value:"this.parent.cs1",font:"this.parent.font"},onfontChange:function(){Q(this);},onValid:function(){var S=this.parent,R=this.domNode;S.set("cs1",this.value);if(R&&R.value.length>6){R.title=R.value;}else{if(R){R.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs1","");}},onkeyup:function(S){var R=S.hWin,V=S.e||R.event,U=this.parent,T=S.src.domNode;if(V.keyCode===13&&U.apply&&U.apply.enabled){U.apply.onclick();}}},{slot:"0,2",alias:"vldTbH",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:G.DTP.VARCHAR,constraints:{trigger:K.TRIGGER.ALL,validator:function(R){var S={id:this.id,code:K.STATUSCODE.VALID,msg:""},T=this.parent;C(R,S,(T.qua===3||T.qua===4),(T.opId!==8&&T.opId!==9),(T.numFmts&&T.numFmts.cat));return S;}},bindings:{visible:"this.parent.opId ==7 ||this.parent.opId ==6",value:"this.parent.cs2",font:"this.parent.font"},onfontChange:function(){Q(this);},onValid:function(){this.parent.set("cs2",this.value);var R=this.domNode;if(R&&R.value.length>6){R.title=R.value;}else{if(R){R.title="";}}},onvisibleChange:function(){if(!this.visible){this.parent.set("cs2","");}},onkeyup:function(S){var R=S.hWin,U=S.e||R.event,T=this.parent;if(U.keyCode===13&&T.apply&&T.apply.enabled){T.apply.onclick();}}},{slot:"0,3",alias:"apply",title:mstrmojo.desc(2164,"Apply"),scriptClass:"mstrmojo.Button",cssClass:"icn apply",bindings:{enabled:"(!this.parent.vldTbL.visible ||!this.parent.vldTbL.validationStatus.code)&& (!this.parent.vldTbH.visible||!this.parent.vldTbH.validationStatus.code)"},onclick:function(){var T=this.parent,W=(T.qua===D.Q._PT||T.qua===D.Q._PB),R;T.cs=[];var U=function(X){return X+((W&&!String(X).match(/^\d+%$/))?"%":"");};var S=function(X,Y){return((X===2||X===3)&&Y===0)?14:5;};if(T.opId===N._IN||T.opId===N._NOT_IN){var V=String(T.cs1).split(";");for(R=0;R<V.length;R++){if(!mstrmojo.string.isEmpty(V[R])){T.cs.push({dtp:5,v:U(V[R])});}}}else{if(T.vldTbL.visible){T.cs.push({dtp:S((T.numFmts&&T.numFmts.cat),T.qua),v:U(T.cs1)});}if(T.vldTbH.visible){T.cs.push({dtp:S((T.numFmts&&T.numFmts.cat),T.qua),v:U(T.cs2)});}}if(T.onchange){T.onchange();}if(T.makeSelection){T.makeSelection();}}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.DocSubsection","mstrmojo._CanGrowOrShrink","mstrmojo.boxmodel");mstrmojo.DocSubsection=mstrmojo.declare(mstrmojo.rw.DocSubsection,[mstrmojo._CanGrowOrShrink],{scriptClass:"mstrmojo.DocSubsection",postBuildRendering:function D(){var H=this.defn;if(H.hc||H.vc){var F=this.domNode,J=this.getFormats(),K=this.id,I=J.height,G=J.width;H.attachEventListener("resized",K,function(){var M=J.height,L=J.width;if(M){F.style.height=M;}if(L){F.style.width=L;}});H.attachEventListener("adjustSize",K,function(N){var M=F.style,L=M.height;if(H.hc&&M.width!==G){M.width=G;}if(H.vc&&M.height!==I){M.height=I;}this.performCanGrowCanShrink(this.children);N.heightReduced=(parseInt(L,10)>parseInt(M.height,10));});}return this._super();},onchildRenderingChange:function B(H){this._super(H);if(this.renderMode!=="scroll"){var F=this.parent.slot,G=F==="fixedHeaderNode"||F==="fixedFooterNode";this.performCanGrowCanShrink([(H&&H.src)||H],G);}},portalMaximized:function C(){var I=this.defn,J=I.vc,G=I.hc;if(!G&&!J){return{};}delete I.vc;delete I.hc;delete I.ck;var H=this.getFormats(),F=this.model,N=this.domNode,K=this;var L={HideIfEmpty:-1};var M=function(R,P,Q){var S=R.toLowerCase(),O=parseInt(N.style[S],10);P=((P===undefined)?O:Math.max(parseInt(P,10),O))+"px";if(H[S]!==P){H[S]=P;L[R]=mstrmojo.boxmodel.px2Inches(F.getZoomProps(),P);delete K["_fixed"+R];}Q=Q||"";L["Max"+R]=0;L["CanGrow"+Q]=0;L["CanShrink"+Q]=0;};if(J){M("Height",H.normHeight);}if(G){M("Width",H.normWidth,"Horizontal");}I.raiseEvent({name:"resized"});return L;},adjustSectionSize:function A(){var F=this.defn;if(F.vc||F.hc){return F.raiseEvent({name:"adjustSize"});}return null;},refresh:function E(){if(!this.hasRendered){return ;}var G=this.children||[],F=G.length-1;for(F;F>=0;F--){if(G[F].refresh){G[F].refresh();}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocPanel","mstrmojo.css");var B=mstrmojo.css;mstrmojo.ExpressDocPanel=mstrmojo.declare(mstrmojo.DocPanel,null,{scriptClass:"mstrmojo.ExpressDocPanel",preBuildRendering:function A(){if(this.getFormats().overflow==="auto"){B.addWidgetCssClass(this,"scroll");}return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBoxBase","mstrmojo._HasScrollbox");mstrmojo.ListBox=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._HasScrollbox],{scriptClass:"mstrmojo.ListBox",renderAllItems:false,renderPause:10,numPagesRendered:0,pageStatus:null,_rc:null,_totalPages:null,_rh:null,_rhMin:8,_rowsPerPage:null,_defaultRowsPerPage:100,_minRowsPerPage:100,_pageHeight:null,buildRendering:function K(){if(this.renderAllItems===true){this._super();return true;}this._initPageSettings();var L=this.items;this.items=this._rc?this.items.slice(0,Math.min(this._rowsPerPage,this._rc)):[];this._super();this.items=L;this.postRenderPage(0,true);if(this._rc>this._rowsPerPage){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]=(this._rh*this._rc)+"px";if(!this.connectedScrollbox){this.connectScrollbox(this);this.connectedScrollbox=true;}}else{this.postRenderingCleanup();}},_initPageSettings:function E(){var L=this.items;this._rc=(L&&L.length)||0;var N=this.itemRenderer;this._rh=(N&&N.rowHeight)||this._rhMin||3;var M=this._defaultRowsPerPage;if(!isNaN(this.scrollboxHeight)){M=Math.ceil(this.scrollboxHeight/this._rh);M=Math.max(M,this._minRowsPerPage);}this._rowsPerPage=M;this._totalPages=Math.ceil(this._rc/this._rowsPerPage);this._pageHeight=this._rh*this._rowsPerPage;this._pageStatus=new Array(this._totalPages);this._numPagesRendered=0;},onscroll:function J(){if(!this._renderingRows){this._startPageRenderThread();}},_startPageRenderThread:function F(){this.renderingRows=true;var M=this,L=this._renderTimer=self.setInterval(function(){if(!M){self.clearInterval(L);return ;}var N=M.getPagesToRender();if(N.length>0){M.renderPages(N);}else{M.renderingRows=false;self.clearInterval(M._renderTimer);delete M._renderTimer;if(M.isRenderingComplete()){M.postRenderingCleanup();}M=null;}},this.renderPause);},getPagesToRender:function I(){var P=[],Z=this._pageHeight,b=null,W=this._pageStatus,Y=this;function R(c){var d=W[c];if(d&&d.filled){if(!d.height){if(!b){b=Y.itemsNode.tBodies;}d.height=b[c].offsetHeight;}return d.height;}else{return Z;}}var a=0,S=null,O=null,M=this.scrollboxTop;for(var V=0,X=this._totalPages;V<X;V++){a+=R(V);if(a>=M){S=V;break;}}if(S==null){S=O=X-1;}else{var L=this.scrollboxBottom;for(var T=S+1;T<X;T++){if(a>=L){O=T-1;break;}a+=R(T);}}if(O==null){O=X-1;}for(var N=this._numPagesRendered;N<S;++N){P.push({idx:N,fill:false});}for(var Q=S;Q<=O;++Q){var U=W[Q];if(!U||!U.filled){P.push({idx:Q,fill:true});}}return P;},renderPages:function D(M){for(var N=0,L=M.length;N<L;++N){this.renderPage(M[N].idx,M[N].fill);}},renderPage:function B(R,M){var V=this._pageStatus,P=(this._numPagesRendered>=R+1);if(P){if(!M||(V[R]&&V[R].filled)){return ;}}var U=this._rowsPerPage,L=R*U,N=Math.min(L+U,this._rc)-1;var T=this.tempTableCont;if(!T){T=this.tempTableCont=this.domNode.ownerDocument.createElement("div");}var Q=M?this._buildItemsMarkup(L,N,'<table><tbody idx="'+R+'">',"</tbody></table>",this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join(""):'<table><tbody idx="'+R+'"><tr><td style="height:'+this._pageHeight+'px">&nbsp;</td></tr></tbody></table>';T.innerHTML=Q;var O=T.firstChild.tBodies[0],S=this.itemsNode;if(!P){S.appendChild(O);}else{S.replaceChild(O,S.tBodies[R]);}this.postRenderPage(R,M);},postRenderPage:function G(M,O){if(M+1>this._numPagesRendered){this._numPagesRendered=M+1;}var L=this._pageStatus,N=L[M];if(!N){N=L[M]={};}if(O){N.filled=true;}if(M>0&&M==this._totalPages-1){this.itemsContainerNode.style[mstrmojo.css.MINHEIGHT]="";}},isRenderingComplete:function C(){if(this._numPagesRendered==this._totalPages){for(var L=this._pageStatus,M=this._totalPages-1;M>-1;M--){if(!L[M]||!L[M].filled){return false;}}return true;}return false;},postRenderingCleanup:function A(){if(this.connectedScrollbox){this.disconnectScrollbox(this);this.connectedScrollbox=false;}},unrender:function(L){this.postRenderingCleanup();this._super(L);},refresh:function H(){if(!this.hasRendered){return ;}var N=this.domNode,L=N&&N.parentNode;if(!this.parent&&L){var M=N.ownerDocument.createElement("span");L.insertBefore(M,N);}this.unrender();if(!this.parent&&L){this.domNode=M;}this.render();if(this.defn&&this.defn.set){this.defn.set("readyState",mstrmojo.EnumReadystate.IDLE);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._ListSelections");mstrmojo.ListBoxHoriz=mstrmojo.declare(mstrmojo.ListBoxBase,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.ListBoxHoriz",cssClass:"mstrmojo-ListBoxHoriz",tableCssClass:"mstrmojo-ListBox-table",tableCssText:"",rowCssClass:"",rowCssText:"",cellCssClass:"",cellCssText:"",cellSpacing:0,cellPadding:0,_markupPrefix:function(){var A=this.itemRenderer;return(A&&A.markupPrefix)||('<table class="'+this.tableCssClass+'" style="'+this.tableCssText+'" cellspacing="'+this.cellSpacing+'" cellpadding="'+this.cellPadding+'"><tbody><tr class="'+this.rowCssClass+'" style="'+this.rowCssText+'">');},_markupSuffix:function(){var A=this.itemRenderer;return(A&&A.markupSuffix)||"</tr></tbody></table>";},_itemPrefix:function(){var A=this.itemRenderer;return(A&&A.itemPrefix)||('<td class="'+this.cellCssClass+'" style="'+this.cellCssText+'">');},_itemSuffix:function(){var A=this.itemRenderer;return(A&&A.itemSuffix)||"</td>";},_getItemNode:function(A){if(A<0){return null;}var B=this.itemsNode,C=B&&B.rows[0];return C&&C.cells[A].firstChild;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller","mstrmojo.css");var F=mstrmojo.css;var C;mstrmojo.ui.CheckList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.CheckList",markupString:'<div id="{@id}" class="mstrmojo-ui-CheckList {@cssClass}" style="{@cssText}" mstrAttach:click,contextmenu><div class="scroll-container"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{scrollboxNode:function A(){return this.domNode.firstChild;},itemsContainerNode:function I(){return this.domNode.firstChild.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onorientationChange:function L(){F.toggleClass(this.domNode,"horizontal",this.orientation!=="v");},onmultiSelectChange:function J(){F.toggleClass(this.domNode,"radio",!this.multiSelect);},onenabledChange:function H(){F.toggleClass(this.domNode,"disabled",!this.enabled);}},multiSelect:true,orientation:"v",minimumSelectCnt:0,icnCss:"icn",items:null,getItemMarkup:function K(M){if(!C){C=this._super(M).replace(">{@en@n}<",'title="{@tt}"><span>{@en@n}</span><');}return C;},getItemProps:function G(O,M){var N=this._super(O,M);var P=O.css;if(P){N.addCls(P);}N.tt=O.tt||"";N.n=O.n||" ";return N;},setupScrollNodes:function D(){this.scrollNode=this.scrollboxNode;},preselectionChange:function B(N){var O=this.minimumSelectCnt,M=this.getSelectedItems().length,P=N.removed;if(P&&O){if(M<O){this.select(P,true);return false;}}F.toggleClass(this.itemsContainerNode,"disableSelected",M<=O);return true;},buildRendering:function E(){this._super();F.toggleClass(this.itemsContainerNode,"disableSelected",this.getSelectedItems().length<=this.minimumSelectCnt);}});mstrmojo.ui.CheckList.ItemType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.List","mstrmojo.ui._HasScroller");mstrmojo.ui.ScrollableList=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableList",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mousedown,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function C(){return this.domNode.firstChild.firstChild;},scrollboxNode:function D(){return this.domNode.firstChild;},scrollNode:function E(){return this.domNode.firstChild;}},postBuildRendering:function B(){if(this.renderOnScroll){if(!this.onScrollEnd){var G=this.id;this.onScrollEnd=function F(){var H=mstrmojo.all[G];H.doScroll();H.updateScrollbars();};}}if(this._super){this._super();}},renderBlockSize:150,renderIndex:0,onScrollEnd:undefined,doScroll:function A(){if(this.renderOnScroll){var G,H=this.scrollNode,F=(this.renderIndex+1)*this.renderBlockSize;if(F>=this.items.length){return ;}if(mstrmojo.dom.position(H).h===H.scrollHeight){G=this.domNode;}else{G=H;}if((mstrmojo.dom.position(G).h+G.scrollTop)>=G.scrollHeight){this.renderIndex++;var I=this._buildItemsMarkup(this.renderIndex*this.renderBlockSize,((this.renderIndex+1)*this.renderBlockSize)-1,this._markupPrefix&&this._markupPrefix(),this._markupSuffix&&this._markupSuffix(),this._itemPrefix&&this._itemPrefix(),this._itemSuffix&&this._itemSuffix()).join("");G.innerHTML+=I;this.itemsContainerNode.innerHTML+=I;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.SuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var C=function(S,U,T){var R=S.parent.opener,J=R&&R.showDesc,Q=R&&R.showPath,I=U[S.itemField];var P=mstrmojo.string.escape4HTMLText,V="";if(Q){var M=U.anc&&U.anc.items,O=M&&M.length;if(O>0){for(var L=0;L<O-1;L++){V+=M[L].n+" > ";}V+=P(M[O-1].n);}else{if(U.path){V+=U.path;}}}if(!T){V+=(V.length===0?"":" > ")+P(I);}if(J){var N=U[S.itemDescField],K=120;if(N){V+="\r\n\r\n<br>"+P(N.substring(0,K)+(N.length>K?"...":""));}}return V;};var A=function(I,J,K){I.path=null;if(!J||!K||K.path){if(K&&K.path){I.set("path",K.path);}return ;}window.clearTimeout(this.pathTmr);this.pathTmr=window.setTimeout(function(){var L=J.path||J.getAttribute("path");if(L){I.set("path",K.path);return ;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(M){var N=H(M.toString())||"";K.path=N;I.set("path",N);}},{taskId:"getObjectDetails",objectID:K.did,objectType:K.t},undefined);},200);};var H=function(K){var N;if(window.DOMParser){N=(new DOMParser()).parseFromString(K,"text/xml");}else{N=new ActiveXObject("Microsoft.XMLDOM");N.async="false";N.loadXML(K);}var P=N.getElementsByTagName("path")[0],L=P.childNodes,O="";if(L){for(var J=0,I=L.length;J<I;J++){var M=L[J].childNodes&&L[J].childNodes[0];if(M){O+=mstrmojo.string.escape4HTMLText(M.nodeValue)+(J<I-1?"> ":"");}}}return O;};mstrmojo.LegacySuggestionList=mstrmojo.declare(mstrmojo.SuggestionList,null,{scriptClass:"mstrmojo.LegacySuggestionList",useRichTooltip:false,itemDescField:"desc",getItemMarkup:function(K,I){var J=this.parent.opener,L=this.useRichTooltip?"":this.buildTooltip(K);return'<div class="mstrmojo-suggest-text '+((J&&J.item2textCss(K))||"")+'" idx="'+I+'" title="'+L+'">'+J.getHighlightedText(J.getSearchPattern(),mstrmojo.string.escape4HTMLText(K[this.itemField]))+"</div>";},getItemProps:function E(){return{};},onmouseover:function(J){var M=this.parent.opener;if(M&&M.showPath){var K=mstrmojo.dom.eventTarget(J.hWin,J.e),I=K.getAttribute("idx"),L=I!=null?this.items[I]:null;if(L&&L.t>-1){this.targetEl=K;this.targetItem=L;this.requestPath(K,L);}}},requestPath:function D(I,K){var J=this.parent.opener;if(K.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function&&J.showFunctionSyntaxAsPath){this.buildFunctionSyntax(K);}else{A(this,I,K);}},buildFunctionSyntax:function G(J){var K=J.path;if(!K&&J.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){var I=function I(P){if(P.did<0){return P.n;}var O=P.pars,M=[],N,L;M.push(P.n);if(O){M.push("(");for(N=0,L=O.length;N<L;N++){M.push(O[N].n);if(N!==(L-1)){M.push(", ");}}M.push(")");}return M.join("");};J.path=I(J);}this.set("path",{path:J.path,excludeSelf:true});},buildTooltip:function B(I,J){return C(this,I,J);},onpathChange:function F(){var I=this.targetEl;I.path=1;var J=this.buildTooltip(this.targetItem,this.path.excludeSelf);if(this.useRichTooltip){this.useRichTooltip=true;this.hasOpenTooltip=false;if(!I.ttp){I.ttp=J;this.showTooltip();}}else{I.title=J;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.Popup","mstrmojo.MenuItem");var G="mstrFilterPanelMenu",L="mstrmojo.Box",E="mstrmojo-Menu-Box";var B=function(){var N=mstrmojo.all[G],M=N.fps;M.clearAllFilter();M.applyBufferedSlices();N.close();};var C=function(){var N=mstrmojo.all[G],M=N.fps;if(M&&M.applyBufferedSlices){M.applyBufferedSlices();}N.close();};var F=function(){H(false);};var I=function(){H(true);};var A=function(){var O=mstrmojo.all[G],N=O.fps,M=!O.autoSubmit;N.applyBufferedSlices();N.model.updateUnitFormat(N,1,{FormattingLayout:{CtlAutoSubmit:(M?1:0)}},{success:function(){var P=N.parent;O.set("autoSubmit",M);O.fps.defn.set("cas",M);P.buttonbar.applyNow.set("visible",!M);P.buttonbar.resetBtn.set("visible",!M);P.adjustFPHeight2Fit();mstrmojo.css.toggleClass(P.buttonbarNode,"hide",M);mstrmojo.css.toggleClass(P.toolbarNode,["cas"],!M);}},{params:{suppressData:true}});O.close();};function H(O){var P=mstrmojo.all[G],N=P.fps,U=mstrmojo.DocPortlet,M=O?U.ST_RESTORE:U.ST_MIN;if(!N||!N.children){return ;}var T=N.model,R=[];for(var S in N.children){var V=N.children[S];if(!V.children||!V.selected){continue;}for(var Q in V.children){var W=V.children[Q];if(typeof (W.defn.ttl)!=="undefined"){R.push(W.changeWindowState(M));}}}if(R.length){T.getDataService().submitUpdates(R,{},{preserveUndo:true,params:{suppressData:true}});}P.close();}function J(P,N,M){var O={scriptClass:"mstrmojo.MenuItem",text:P,cssClass:"mstrmojo-InteractiveButton",onclick:N,bindings:M};return O;}function K(P,N,M){M=M||{};M.pressed="mstrmojo.all['"+G+"'].autoSubmit";M.iconClass="this.pressed?'pressed':''";var O=J(P,N,M);O.onpressedChange=function(){if(this.domNode){mstrmojo.css.toggleClass(this.domNode,"pressed",this.pressed);}};return O;}mstrmojo.FilterPanelMenu=mstrmojo.registry.ref({id:G,slot:"popupNode",scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-Menu",shadowNodeCssClass:"mstrmojo-Menu-shadow",contentNodeCssClass:"mstrmojo-Menu-content",locksHover:true,autoSubmit:true,onOpen:function D(){var R=this.opener,Z=R&&R[this.slot],Y=mstrmojo.dom.position(Z),a=Y.y||0,T=this.cmPos,V,S,X;if(T){V=T.x;S=T.y-a;}else{var N=this.openerButton.domNode;X=mstrmojo.boxmodel.offset(N,Z);V=X.left;S=X.top+((N&&N.offsetHeight)||0);}var Q=mstrmojo.dom.windowDim(),O=this.domNode;var P=O.offsetHeight,U=Q.h-a;X=Math.max(0,S+P-U);this.set("top",S-X+"px");var W=O.offsetWidth,M=Q.w;X=Math.max(0,V+W-M);this.set("left",V-X+"px");this.set("autoSubmit",this.fps.defn.cas);},children:[{scriptClass:L,bindings:{},cssClass:E,children:[J(mstrmojo.desc(8974,"Clear all filters"),B,{}),J("Apply Now",C,{visible:"!mstrmojo.all['"+G+"'].autoSubmit",enabled:"mstrmojo.all['"+G+"'].fps.applyEnabled"})]},{scriptClass:L,cssClass:E,bindings:{},children:[J(mstrmojo.desc(8970,"Expand all"),I,{}),J(mstrmojo.desc(8971,"Collapse all"),F,{})]},{scriptClass:L,cssClass:E,bindings:{},children:[K(mstrmojo.desc(1996,"Auto-Apply changes"),A,{})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.TristateCheckBox","mstrmojo._IsInputControl");mstrmojo.CheckBoxDIC=mstrmojo.declare(mstrmojo.TristateCheckBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.CheckBoxDIC",markupString:'<div id="{@id}" class="mstrmojo-Label {@cssClass}" style="{@cssText}" tabindex="1" mstrAttach:click,keydown></div>',cssText:"width: 0; margin:0 auto; max-height: 18px; cursor: pointer;",onclick:function(){if(this.grayed){this.set("grayed",!this.grayed);this.set("checked",true);}else{this.set("checked",!this.checked);}},oncheckedChange:function(A){this.set("value",this[this.checked?"onValue":"offValue"]);},preBuildRendering:function(){this._super();var A=this.dic.vls;this.offValue=A[0].v;this.onValue=A[1].v;this.grayed=(this.onValue!==this.value)&&(this.offValue!==this.value);this.checked=(this.onValue===this.value);},postBuildRendering:function(){var B=this.domNode,D=B.style,C=this.openerStyle,A;this._super();D.height=C.ih+"px";if(C.iw){A=Math.floor((C.iw-B.clientWidth)/2);D.marginLeft=D.marginRight=A>0?A+"px":"auto";}},onkeydown:function(B){var A=B.hWin,C=B.e||A.event;if(C.keyCode===mstrmojo.Enum_Keys.SPACE){mstrmojo.dom.preventDefault(A,C);this.onclick();}},focus:function(){this.domNode.focus();}});})();(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo.dom");var B=mstrmojo.dom;var A="openXtabCellMenu";mstrmojo.XtabCellHoverPopup={cssClass:"mstrXtabCellHoverPopup",scriptClass:"mstrmojo.Popup",slot:"overlayNode",autoCloses:true,children:[{scriptClass:"mstrmojo.Button",alias:"btn",onmousedown:function(D){this.openPopup(true,D);B.stopPropogation(D.hWin,D.e);B.preventDefault(D.hWin,D.e);return false;},openPopup:function(F,D){var E=this.xtab[A]?this.xtab:mstrmojo.findAncestor(this.xtab,A);if(E){E.openXtabCellMenu({xtab:this.xtab,td:this.td,btn:this,cmPos:this.cmPos,lockIW:this.xtab,singleCellClick:F===true,evt:D});}this.domNode.oncontextmenu=function(G){B.stopPropogation(window,G);B.preventDefault(window,G);return false;};},closePopup:function(){var D=mstrmojo.findAncestor(this.xtab,A);if(D){D.closePopup();}}}],updatePopupConfig:function C(F){var G=F&&F.td,N=F&&F.xtab,D=this.btn;var H=this._lastTd;if(H!==G){D.closePopup();this._lastTd=G;}D.xtab=N;D.td=G;D.cmPos=F&&F.cmPos;if(!G||!N){return ;}var I=B.findAncestorByName(G.parentNode,"table",false,N.viewport),J=N.zones,M="",E;if(I){for(E in J){var K=J[E];if(K&&K.tableNode===I){M=K.slot;break;}}}var L=mstrmojo.boxmodel.offset(G,N.overlayNode);this.set("location",{left:0,top:L.top,width:Math.min(G.offsetWidth+L.left,N._pl),height:G.offsetHeight});},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onlocationChange:function(){var D=this.location;if(!D){return ;}var E=this.domNode.style;E.left=(D.left+Math.max(D.width-18,0))+"px";E.top=D.top+(D.height?Math.round(D.height/2)-7:0)+"px";}}};}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo._HasBuilder","mstrmojo._IsAnchorable","mstrmojo.hash","mstrmojo.array","mstrmojo.dom");var M="mstrmojo-DocInfoWindow-tip",G=1,E=mstrmojo.dom,O=mstrmojo.hash,I=mstrmojo.array;$D=mstrmojo.dom,$A=mstrmojo.array;function H(U){var T=this.anchor,S=E.findWidget(T)||(T&&T.w),U=U||{};U.lockIW=S;return U;}function R(T){var S=T.model;return S.getLayoutDataCache(S.getCurrentLayoutKey())[T.psId];}mstrmojo.DocInfoWindow=mstrmojo.declare(mstrmojo.Popup,[mstrmojo._HasBuilder,mstrmojo._IsAnchorable,mstrmojo._HasPopup],{scriptClass:"mstrmojo.DocInfoWindow",markupString:'<div class="mstrmojo-DocInfoWindow-wrapper @{waitState}"><div id="{@id}" class="mstrmojo-DocInfoWindow"></div><div class="'+M+' top"></div><div class="mstrmojo-DocInfoWindow-curtain" mstrAttach:click></div></div>',markupSlots:{infoNode:function(){return this.domNode.firstChild;},tipNode:function(){return this.domNode.childNodes[1];},curtainNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.firstChild;}},boundaryNodeName:"boundary",popupNodeName:"infoNode",baseTipClass:M,anchorOffset:1,anchorOrientation:"h",anchor:null,boundary:null,closeOnClick:true,autoCloseLocks:null,autoScrollCloseLocks:null,tipNodeColor:"",ontouchstart:function J(){this.close();},close:function N(){if(this.isAutoCloseLocked()){return ;}this.model.raiseEvent({name:"infoWindowClosed",psKey:this.psKey});if(this._super){this._super();}if(this.anchor&&this.anchor.lockInfoWinId&&mstrmojo.all[this.anchor.lockInfoWinId]){mstrmojo.all[this.anchor.lockInfoWinId].releaseLock(this);}this.clearAnchorHilites();E.detachEvent(document,E.isFF?"DOMMouseScroll":"mousewheel",this.mw);E.detachEvent(document,"scroll",this.mw);E.detachEvent(window,"resize",this._resizeHandler);},clearAnchorHilites:function C(){var S=mstrmojo.dom.findWidget(this.anchor);if(S&&S.clearHilites){S.clearHilites(S.hiliteKey);delete S.hiliteKey;}},prepareAnchor:function A(){if(this.children&&this.children[0]){var T=this.infoNode.style,U=this.children[0],V=U.dimNode||U.domNode,W=V.offsetWidth,S=V.offsetHeight;T.width=(W+2*G)+"px";T.height=(S+2*G)+"px";}},nudge:function L(){this.positionDialog();this.model.raiseEvent({name:"infoWindowRendered",id:this.id});},onRender:function F(){this.open(this.opener);},open:function K(Z,U){var S=mstrmojo.all[this.psId];if(S){var W=S.defn.sfp,b=S.selectedIdx;if(W&&b!==0){S.switchToPanel(0,0);S.children[b].set("selected",false);}}if(this._super){this._super(Z,H.call(this,U));}var V=function V(c){if(!c){return ;}if(c.defn&&c.defn.ifp){c.refresh();}I.forEach(c.children||[],function(d){V(d);});};V(S);if(mstrApp.isTablet&&mstrApp.isTablet()){var a=mstrmojo.touchManager,T=this.id,Y=this.domNode;this._tchHandler=a.attachEventListener("touchesBegin",T,function(e){if(this.isAutoCloseLocked()){return ;}var d=mstrmojo.dom.contains(Y,e.touch.target,true);var g=document.getElementsByClassName("heatmap-infobox"),c=(g&&g.length)||0,f,j=e.touch.target,h=false;for(f=0;f<c;f++){if(mstrmojo.dom.contains(g[f],j,true)){h=true;break;}}if(!d&&!mstrApp.hasOpenDialog()&&!h){this.closeOnTablet();}});}var X=this;X.mw=X.mw||function(c){if(X.isAutoScrollCloseLocked()){return ;}if(X.autoCloses&&!E.contains(X.domNode,E.eventTarget(self,c),true,document.body)){X.close();}};X._resizeHandler=function(c){X.positionDialog(true);};E.attachEvent(document,E.isFF?"DOMMouseScroll":"mousewheel",X.mw);E.attachEvent(document,"scroll",X.mw);E.attachEvent(window,"resize",X._resizeHandler);},getChildren:function D(){return[R(this)];},preBuildRendering:function B(){var U=R(this),T=U.defn.fmts;T.left=G+"px";T.top=G+"px";if(T.border){var S=T.border.split(" ");if(S.length>=3){this.tipNodeColor=S[2];}}if(this._super){this._super();}},postBuildRendering:function Q(){this.set("visible",true);if(this._super){this._super();}if(!this.closeOnClick){this.curtainNode.style.display="none";}},closeOnTablet:function P(){this.close();if(this._tchHandler){this._tchHandler.clear();}},postwaitStateChange:function(){var S=this.children[0],T=S.dimNode||S.domNode;if(!this.waitState&&!T){this.refresh();}},renderChildren:function(){if(!this.waitState){this._super();}},registerLock:function(S){var T=this.autoCloseLocks||[];if(I.indexOf(T,S.id)===-1){T.push(S.id);this.autoCloseLocks=T;}},releaseLock:function(S){I.removeItem(this.autoCloseLocks,S.id);},isAutoCloseLocked:function(){this.autoCloseLocks=I.filter(this.autoCloseLocks,function(S){return !!mstrmojo.all[S];});return this.autoCloseLocks.length>0;},openPopupMenu:function(T,S){this.openPopup(T,S);},registerScrollLock:function(S){var T=this.autoScrollCloseLocks||[];if($A.indexOf(T,S.id)===-1){T.push(S.id);this.autoScrollCloseLocks=T;}},releaseScrollLock:function(S){$A.removeItem(this.autoScrollCloseLocks,S.id);},isAutoScrollCloseLocked:function(){this.autoScrollCloseLocks=$A.filter(this.autoScrollCloseLocks,function(S){return !!mstrmojo.all[S];});return this.autoScrollCloseLocks.length>0;}});mstrmojo.DocInfoWindow.PLACEMENT={AUTO:1,FIXED:2,ABOVE:3,BELOW:4,LEFT:5,RIGHT:6};}());(function(){mstrmojo.requiresCls("mstrmojo.Popup","mstrmojo.css");mstrmojo.ui.pathbar.PathPopup=mstrmojo.declare(mstrmojo.Popup,null,{scriptClass:"mstrmojo.ui.pathbar.PathPopup",autoCloses:true,locksHover:true,markupMethods:{onvisibleChange:function(){if(this.isOpen){mstrmojo.css.toggleClass(this.domNode,"open",this.visible);}},onleftChange:mstrmojo.Widget.leftMarkupMethod,ontopChange:mstrmojo.Widget.topMarkupMethod},cssClass:null,targetNode:null,offsetTop:0,offsetLeft:0,onOpen:function B(){var D=this,C=D.domNode,E=mstrmojo.dom.position(D.targetNode);C.style.top=(E.y+E.h+D.offsetTop)+"px";C.style.left=(E.x+D.offsetLeft)+"px";D.set("visible",false);D.isOpen=true;window.setTimeout(function(){D.set("visible",true);},100);mstrmojo.css.toggleClass(D.targetNode,"opened",true);},onClose:function A(){var C=this;window.setTimeout(function(){delete C.isOpen;mstrmojo.css.toggleClass(C.targetNode,"opened",false);},500);C.domNode.style.left="";},children:null});}());(function(){mstrmojo.requiresCls("mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.tooltip");var E=mstrmojo.dom,D=mstrmojo.string,F=mstrmojo.hash,H=mstrmojo.array,C=mstrmojo.tooltip;mstrmojo.ui._HasListTooltip=mstrmojo.provide("mstrmojo.ui._HasListTooltip",{_mixinName:"mstrmojo.ui._HasListTooltip",tooltipOrientation:"horizontal",tooltipOffset:8,tooltipMarkup:'<div class="content" style="{@style}">{@c}</div>',tooltipCss:{},tooltipContrast:false,getTooltipText:function A(I){return I&&(I.ttp||I.n);},showTooltip:function G(W,M){var O=this;if(!O.hasOpenTooltip&&!(O._lastOpened&&O._lastOpened.visible)){var b=E.eventTarget(M,W),X=O.getItemFromTarget(b),R=O.getItemNodeFromTarget(b),d=O.getTooltipText(X),N=O.tooltipCss;if(!d){return ;}var c=E.position(R),V,P,L,T="",U=O.tooltipOffset;if(this.tooltipOrientation==="vertical"){V=c.x+c.w/2;L=C.POS_TOPCENTER;P=c.y+c.h+U;O.tooltipCss=F.copy({cssClass:"vi-regular vi-tooltip-A A-center"},N);}else{var K=E.windowDim(),S=40,Y=c.x+c.w+U,J=c.x-U,a=J-S,I=K.w-(Y+S),Z="vi-regular vi-tooltip-",Q;P=c.y;if(I>=a){V=Y;Q=I;L=C.POS_TOPLEFT;N.cssClass=Z+"C  "+N.rightCssClass;}else{V=J;Q=a;L=C.POS_TOPRIGHT;N.cssClass=Z+"D  "+N.leftCssClass;}T="max-width: "+Q+"px;";}if(O.tooltipContrast){N.cssClass=N.cssClass+" contrast";}if(N&&N.getItemCssClass){N.cssClass=H.filter([N.cssClass,N.getItemCssClass(X)],function(e){return !!e;}).join(" ");}O.richTooltip=F.copy(O.tooltipCss,{content:D.apply(O.tooltipMarkup,{c:d,style:T}),top:P,left:V,posType:L});O.richTooltip.keepArrowXPos=!!O.keepArrowXPos;O.richTooltip.keepArrowYPos=!!O.keepArrowYPos;this._super(W,M);}},onclick:function B(I){var J=this;window.setTimeout(function(){if(J.hasOpenTooltip){J.hideTooltip();}window.clearTimeout(J._tooltipTimeOut);},0);this._super(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Widget","mstrmojo.tooltip","mstrmojo.string","mstrmojo.array");var O=0,I=mstrmojo.array,B=mstrmojo.string;function P(){var U=this.textNode,W=this.imgNode;if(this.eg!=null){W.style.display="none";U.innerHTML=this.eg||"";U.style.display="block";}else{U.style.display="none";W.style.display="block";if(this.tooltip){W.setAttribute("ttl",this.tooltip);}var V=this.getFormats();this.retrieveGraphSrc(V.height,V.width);}}var T={6:"poly",7:"rect",100:"circle"};function H(){var d=this.as,Z=d&&d.length;if(!Z){return ;}var Y=this.id,c=Y+"_map"+O++,W=[],b=-1,X;for(X=0;X<Z;X++){var V=d[X];V.id=Y;V.aid=X;V.tooltip=B.multiReplace(V.tooltip||"",{"&#13":"<br />","&#32":" ",'"':"&quot;"});if(!isNaN(V.shape)){V.shape=this.getAreaShapeName(V.shape);}if(V.tks||V.tks===""||V.tty===1){V.extra=' href="#" ';}W[++b]=B.apply(this.areaMarkup,V);}var a='<map id="'+c+'" name="'+c+'">'+W.join("")+"</map>";if(!this.domNode){this.att='usemap="#'+c+'" ';this.map=a;}else{var U=document.createElement("div");U.innerHTML=a;if(this.mapNode){U=U.firstChild;this.mapNode.innerHTML=U.innerHTML;}else{this.imgNode.setAttribute("usemap","#"+c);this.mapNode=this.domNode.appendChild(U.firstChild);}}}var A=mstrmojo.GraphBase=mstrmojo.declare(mstrmojo.Widget,null,{scriptClass:"mstrmojo.GraphBase",cssClassPrefix:"mstrmojo-GraphBase",markupString:'<div id="{@id}" class="{@cssClassPrefix} {@cssClass}" title="{@tooltip}" style="{@domNodeCssText};"><div class="{@cssClassPrefix}-txt"></div><img {@att}src="../images/1ptrans.gif" class="{@cssClassPrefix} {@cssImageClass}" hidefocus="true" />{@map}</div>',att:"",map:"",cAreaIdx:-1,useRichTooltip:true,markupSlots:{imgNode:function J(){return this.domNode.childNodes[1];},mapNode:function F(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function M(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function K(){this.domNode.style.display=(this.visible)?"block":"none";}},preBuildRendering:function C(){H.call(this);return this._super();},postBuildRendering:function Q(){P.call(this);return this._super();},setModel:function L(U){this.model=U;},updatingTooltipHelper:function R(Y,h,b){var V=Y&&Y.getAttribute("aid"),U=Y&&Y.getAttribute("ttl"),X=Y.getAttribute("SC"),a={refNode:this.domNode,posType:mstrmojo.tooltip.POS_BOTTOMLEFT,contentNodeCssClass:"gp-tooltip"},g=(this.model.getZoomFactor?this.model.getZoomFactor():(this.model.docModel?this.model.docModel.getZoomFactor():1))+"em";if(V==this.cAreaIdx){return ;}this.cAreaIdx=V;a.content=U||this.defaultTooltip;var W="font-size:"+g+";";if(X){W+="border-color:#"+X;}a.contentNodeCssText=W;var d=Y.getAttribute("coords"),f=99999,e=99999;if(!b){if(d&&d.length>0){d=d.split(",");var Z=0;while(Z+1<d.length){f=Math.min(f,parseInt(d[Z++],10));e=Math.min(e,parseInt(d[Z++],10));}}}if(f===99999){f=h.x;}if(e===99999){e=h.y;}a.top=e;a.left=f;this.richTooltip=null;this.set("richTooltip",a);},redraw:function N(){if(!this.hasRendered){return false;}P.call(this);var U=this.getFormats();if(this.as&&U.height&&U.width){this.refreshMap();}return true;},refreshMap:function G(){if(this.as){H.call(this);}},getAreaShapeName:function D(U){return T[parseInt(U,10)]||"default";}});var S=A.tooltipCLS="mstrmojo-mobileGraph-Tooltip-content",E=A.canvasCLS="mobile-graph-highlight-canvas";A.hideTooltips=function(){I.forEach(document.getElementsByClassName(S),function(U){U.style.display="none";});I.forEach(document.getElementsByClassName(E),function(U){U.getContext("2d").clearRect(0,0,U.width,U.height);U.width=U.width;});};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._ListSelections","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var H=mstrmojo.dom,c=mstrmojo.css,R=mstrmojo.hash,I=mstrmojo.all,K="px";function C(g){if(this.dragging){return ;}this._moveCnt++;if(this._moveCnt>this.mousemoveBuffer){var f=document.body;H.detachEvent(f,"mousemove",this._mousemoveCallback);H.detachEvent(f,"mouseup",this._cancelCallback);this.initDrag(g);}}function N(h){var f=document.body;H.detachEvent(f,"mousemove",this._mousemoveCallback);H.detachEvent(f,"mouseup",this._cancelCallback);var g=this.afterDragCancel;if(g){g.call(this.target,h);}}function d(h){H.preventDefault(window,h);if(this.dragging){return true;}var f=this.target.id,g=document.body;if(!this._mousemoveCallback){this._mousemoveCallback=function(j){C.call(I[f].dnd,j);return true;};}this._moveCnt=0;this.startE=R.copy(h);H.attachEvent(g,"mousemove",this._mousemoveCallback);if(!this._cancelCallback){this._cancelCallback=function(j){N.call(I[f].dnd,j);return true;};}H.attachEvent(g,"mouseup",this._cancelCallback);return false;}function B(g){var f=this.duringDrag;if(f){f.call(this.target,g);}return true;}function A(h){this.dragging=false;var f=document.body;H.detachEvent(f,"mousemove",this._dragCallback);H.detachEvent(f,"mouseup",this._dragEndCallback);var g=this.afterDragEnd;if(g){g.call(this.target,h);}return true;}function M(){if(this._mousemoveCallback){H.detachEvent(document.body,"mousemove",this._mousemoveCallback);delete this._mousemoveCallback;}if(this._cancelCallback){H.detachEvent(document.body,"mouseup",this._cancelCallback);delete this._cancelCallback;}if(this._dragCallback){H.detachEvent(document.body,"mousemove",this._dragCallback);delete this._dragCallback;}if(this._dragEndCallback){H.detachEvent(document.body,"mouseup",this._dragEndCallback);delete this._dragEndCallback;}}mstrmojo.DnDComponent=mstrmojo.declare(null,null,{scriptClass:"mstrmojo.DnDComponent",isDragging:false,initD:null,startE:null,afterDragStart:null,duringDrag:null,afterDragEnd:null,target:null,mousemoveBuffer:1,init:function P(e){R.copy(e,this);},initDrag:function X(k){this.dragging=true;var g=this.target.id,j=document.body;var l=this._dragCallback;if(!l){l=this._dragCallback=function(m){return B.call(I[g].dnd,m);};}H.attachEvent(j,"mousemove",l);var f=this._dragEndCallback;if(!f){f=this._dragEndCallback=function(m){return A.call(I[g].dnd,m);};}H.attachEvent(j,"mouseup",f);var h=this.afterDragStart;if(h){h.call(this.target,k);}this._dragCallback(k);}});function F(e){this.getUnit=function f(){var g=e.items.length;return g>1?e._effLen/(g-1):1;};this.calcMinMax=function(h,g){var j=Math.round((h/e.unit+g/e.unit)/2);return{min:j,max:j};};this.preUpdateThumb=function(){e.start=Math.min(e.min*e.unit,e._effLen)+K;e.sdCssText=e.orCfg.posCssP+":"+e.start+";";};this.updateThumb=function(){e.containerNode.style[e.orCfg.posCssP]=e.start=Math.min(Math.round(e.min*e.unit),e._effLen)+K;};return this;}function T(e){this.getUnit=function(){return e._effLen/e.items.length;};this.calcMinMax=function(h,g){return{min:Math.floor(h/e.unit+0.5),max:Math.floor(g/e.unit-0.5)};};function f(){var g=e.min,j=e.unit;var k=e.start=(g*j)+K;var h=e.length=Math.max(Math.round((e.max-g+1)*j-e.gap),0)+K;return{st:k,len:h};}this.preUpdateThumb=function(){var h=e.orCfg,g=f();e.sdCssText=h.posCssP+":"+g.st+";"+h.lenCssP+":"+g.len+";";};this.updateThumb=function(){var h=e.orCfg,g=f(),j=e.containerNode.style;j[h.posCssP]=g.st;j[h.lenCssP]=g.len;};return this;}var b="<span>{@content}</span>";mstrmojo.Slider=mstrmojo.declare(mstrmojo.Container,[mstrmojo._ListSelections],{scriptClass:"mstrmojo.Slider",markupString:'<div id="{@id}" class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont"><div class="bk" style="{@bkCssText}"></div><div class="sdc" style="position:absolute;{@sdcCssText}" mstrAttach:mouseout><div class="sd" style="{@sdCssText}"><div class="t1"></div><div class="t2"></div><div class="t3"></div></div></div></div></div>',sdCssText:"",cssClass:"sc",clsType:"sc2",clsOrientation:"sc-v",orCfg:null,typeHelper:null,_tooltip_pos:"TL",useRichTooltip:true,init:function W(e){this._super(e);if(e.isHoriz){this.orCfg={posCssP:"left",marginCssP:"marginLeft",lenCssP:"width",lenP:"clientWidth",opPosCssP:"top",thickP:"clientHeight",offsetP:"x"};this.clsOrientation=" sc-h";this._tooltip_pos=mstrmojo.tooltip.POS_BOTTOMLEFT;}else{this.orCfg={posCssP:"top",marginCssP:"marginTop",lenCssP:"height",lenP:"clientHeight",opPosCssP:"left",thickP:"clientWidth",offsetP:"y"};this._tooltip_pos=mstrmojo.tooltip.POS_TOPRIGHT;this.titleHeight=(e.docSelector.fmts.ttl&&e.docSelector.fmts.ttl.height)?parseInt(e.docSelector.fmts.ttl.height,10):0;}this._exRoom=this.thumbWidth;if(this.multiSelect){this._exRoom*=2;}if(e.multiSelect){this.typeHelper=new T(this);}else{this.clsType="sc1";this.typeHelper=new F(this);}},markupSlots:{dndNode:function(){return this.domNode.firstChild;},bgNode:function(){return this.domNode.firstChild.firstChild;},sdcNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.lastChild.firstChild;},frontNode:function(){return this.domNode.firstChild.lastChild.firstChild.firstChild;},thumbNode:function(){return this.domNode.firstChild.lastChild.firstChild.childNodes[1];},endNode:function(){return this.domNode.firstChild.lastChild.firstChild.lastChild;},tooltipNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onwidthChange:function(){this.synchronizeSlider();}},start:"50px",length:"30px",min:0,max:0,gap:1,ghost:null,thumbWidth:11,cssBkBW:1,dndNode:null,synchronizeSlider:function O(){var l=this.orCfg,k=l.lenCssP,g=this[k],e=parseInt(g,10),p=this.hasRendered,n=this.titleHeight||0;var h=this._effLen=isNaN(e)?0:(e-this._exRoom-n);if(g){var o={};o[k]=Math.max(parseInt(g,10)-(2*this.cssBkBW),0)-n+K;var j={};j[k]=h+K;j[l.posCssP]=Math.round(this._exRoom/2)+K;j[l.opPosCssP]="0"+K;if(p){R.copy(o,this.bgNode.style);R.copy(j,this.sdcNode.style);}else{this.bkCssText=c.getCssTextFromObj(o);this.sdcCssText=c.getCssTextFromObj(j);}}var q=this.selectedIndices;if(!R.isEmpty(q)){this.min=this.items.length-1;this.max=0;var m;for(m in q){if(q[m]){this.min=Math.min(this.min,m);this.max=Math.max(this.max,m);}}}var f=this.typeHelper;this.unit=f.getUnit();if(p){f.updateThumb();}else{f.preUpdateThumb();}},preBuildRendering:function E(){this.synchronizeSlider();},postBuildRendering:function Z(){this._super();if(this.items.length>1){var e=this.dnd=new mstrmojo.DnDComponent({target:this});var f=this.id;this.__mouseDownEvt=function(g){H.stopPropogation(window,g);d.call(I[f].dnd,g);return true;};H.attachEvent(this.dndNode,"mousedown",this.__mouseDownEvt);e.afterDragStart=this.initDrag;e.duringDrag=this.ondrag;e.afterDragEnd=this.ondrop;e.afterDragCancel=this.cancelDrag;}},initDrag:function X(l,f){f=f||window;var k=this.configureGhost(true),g=this.orCfg,j=this.dnd,h=j.startE;j.initD={tP:parseInt(this.start,10),sL:this._effLen,contL:k.containerNode[g.lenP],offset:H.getMousePosition(h,f)[g.offsetP],td:H.eventTarget(f,h)};},configureGhost:function V(f){var h=this.ghost;if(!h){var k=this.containerNode.cloneNode(true),j=k.childNodes;c.addClass(k,"gh");k.style.display="none";h=this.ghost={containerNode:k,frontNode:j[0],thumbNode:j[1],endNode:j[2]};this.sdcNode.appendChild(k);}var g=this.ghost.containerNode.style,e=this.orCfg;R.copyProps([e.posCssP,e.lenCssP],this.containerNode.style,g);if(f){g.display="block";}return h;},ondrag:function J(o,n){n=n||window;var p=this.dnd.initD,k=this.ghost.containerNode,u,h,f,m=this.min,q=this.max,l=this.orCfg,g=l.lenCssP,t=l.posCssP;var r=H.getMousePosition(o,n)[l.offsetP]-p.offset;switch(p.td){case this.thumbNode:u=Math.max(Math.min(p.tP+r,p.sL-p.contL),0);h=u+p.contL;k.style[t]=u+K;var j=this.typeHelper.calcMinMax(u,h);m=j.min;q=j.max;break;case this.frontNode:u=Math.max(Math.min(p.tP+r,p.tP+p.contL),0);f=Math.max(Math.min(p.contL-r,p.tP+p.contL),0);k.style[t]=u+K;k.style[g]=f+K;m=Math.min(Math.floor(u/this.unit+0.5),this.max);break;case this.endNode:f=Math.max(Math.min(p.contL+r,p.sL-p.tP),0);h=p.tP+f;k.style[g]=f+K;q=Math.max(Math.floor(h/this.unit-0.5),this.min);break;default:return ;}if(m!==this.min||q!==this.max){this.min=m;this.max=q;this.typeHelper.updateThumb();}this._updateTooltip();},ondrop:function a(){this.typeHelper.updateThumb();var j=this.ghost;if(j){j.containerNode.style.display="none";}this.hideTooltip();var k=this.dnd&&this.dnd.initD;if(this.makeSelection&&k){this.makeSelection({selItem:k.td});}var e=this.items;if(e&&e.length){var g=[],f;for(f=this.min;f<=this.max;f++){var h=e[f];if(h){g.push(f);}}this.select(g);}this.dnd.initD=null;},cancelDrag:function U(g,f){if(this.makeSelection){this.makeSelection({selItem:H.eventTarget(f||window,this.dnd.startE)});}},showTooltip:function G(g,f){this.configureGhost(false);this._updateTooltip(g,f);this._super(g,f);},hideTooltip:function L(g,f){if(this.dnd&&this.dnd.dragging){return ;}this._super(g,f);},_updateTooltip:function S(){var m=this.orCfg,n={contentNodeCssClass:"sc-tooltip",refNode:this.domNode,posType:this._tooltip_pos},f=(this.ghost)?this.ghost.containerNode:this.containerNode;n[m.opPosCssP]=0;n[m.posCssP]=f.style[m.posCssP];n.content="";var k=this.items,h=k.length;if(k&&h){var e=(k[this.min]||k[0]),g=this.getItemTooltip(e),j=g;if(this.min!==this.max){var l=(k[this.max]||k[h-1]);j=mstrmojo.desc(146,"From:")+" '"+g+"' "+mstrmojo.desc(147,"To:")+" '"+this.getItemTooltip(l)+"'";}n.content=b.replace(/\{@content\}/g,j);}this.set("richTooltip",n);},getItemTooltip:function D(e){var f=e?e.n:"";return"'"+(f.length>20?f.slice(0,20)+"...":f)+"'";},unrender:function Y(e){this.ghost=null;this.hideTooltip();this.min=0;this.max=(this.items&&this.items.length-1)||0;var f=this.dndNode,g=this.__mouseDownEvt;if(g&&f){H.detachEvent(f,"mousedown",g);}M.call(this);this._super(e);},onselectionChange:function Q(){var e=this.selectedIndices,f=R.isEmpty(e);if(e){this.set("max",f?this.items.length-1:R.max(e,false,true));this.set("min",f?0:R.min(e,false,true));if(this.typeHelper){this.typeHelper.updateThumb();}}if(this.onchange){this.onchange();}}});mstrmojo.Slider.SINGLE_HANDLE_WIDTH=11;mstrmojo.Slider.SCROLLHANDLEWIDTH=11;}());(function(){mstrmojo.requiresCls("mstrmojo.locales","mstrmojo.tooltip","mstrmojo.dom","mstrmojo.css","mstrmojo.array","mstrmojo.hash","mstrmojo.string");mstrmojo.requiresDescs(11038,11935,11936,11937,11856,11938,13138,13230,13260,14633,14636);var C=mstrmojo.hash.copy,P=mstrmojo.css,J=mstrmojo.dom,N=mstrmojo.array,E=mstrmojo.string,Q=function Q(V,T){if(!V){return ;}var S=T&&T.length||0,U;for(U=S;U>0;U--){V=V.replace(new Array(U+2).join("#"),T[U-1]);}return V;},L=function L(T){if(!T){return ;}var Z=this,V=J.position(T.refNode||Z.refNode),Y=J.position(Z.domNode),X=T.position||R.RIGHT,U=0,a=0,S=9+(T.margin!==undefined?T.margin:0),W=" ";switch(X){case R.TOP:a=-Y.h-S;W+="t";break;case R.BOTTOM:a=V.h+S;W+="b";break;case R.LEFT:U=-Y.w-S;W+="l";break;case R.RIGHT:U=V.w+S;W+="r";break;}mstrmojo.hash.forEach(C(T,{left:U,top:a,contentNodeCssClass:W,visible:false}),function(b,c){this[c]=b;},this);this.set("visible",T.invalid);},A=function A(S){var W=this,U,V=S.errorCode,X=S.errorMsg,T=S.args,Y=mstrmojo.vi.ui.rw.selectors.EnumWarningMessages;if(S.invalid){U={content:V!==null?(W.generateContentHTML(Q(Y[V],T))||Y["*"]):X};}return U;};mstrmojo.vi.ui.rw.selectors.EnumWarningMessages=C(mstrmojo.locales.validation,{"*":mstrmojo.desc(11038,"Invalid"),invalidValueVIWarning:mstrmojo.desc(11935,"Invalid characters"),emptyValueVIWarning:mstrmojo.desc(11936,"Please enter a number"),notIntegerVIWarning:mstrmojo.desc(11937,"Please enter an integer"),outOfRangeVIWarning:mstrmojo.desc(11856,"Please enter value between ## and ###."),noMultiSelectionVIWaring:mstrmojo.desc(11938,"This selector does not support multiple selections."),continuousSelectionVIWaring:mstrmojo.desc(13138,"This selector does not support non-continuous selections."),bigDecimalMetricSliderVIWaring:mstrmojo.desc(13230,"Cannot qualify on big decimal value. Please change qualification type to Rank"),unableDisplaySelectionVIWarning:mstrmojo.desc(13260,"Filter cannot display actual selections."),imageSizeExceedLimitVIWarning:mstrmojo.desc(14633,"Cannot embed an image larger than ##MB. Your image is still ###MB after compression. Enter a URL to the image instead."),imageFileTypeNotSupportedVIWarning:mstrmojo.desc(14636,"Invalid image format. Please use .png, .jpg, .jpeg, .gif or .bmp."),imageOverSizeNoCompessionVIWarning:mstrmojo.desc(14665,"Cannot embed an image larger than ##MB. Enter a URL to the image instead.")});mstrmojo.vi.ui.rw.selectors.EnumWarningPosition={TOP:1,BOTTOM:2,LEFT:3,RIGHT:4};var R=mstrmojo.vi.ui.rw.selectors.EnumWarningPosition;mstrmojo.vi.ui.rw.selectors._HasWarningMessage=mstrmojo.provide("mstrmojo.vi.ui.rw.selectors._HasWarningMessage",{_mixinName:"mstrmojo.vi.ui.rw.selectors._HasWarningMessage",warningSlotName:"warning",showWarning:function G(U){var Y=this,a=Y.warningSlotName,c=Y[a],S=U&&U.lasting||6000,X=U.refNode||this.domNode,T=U.highlight!==false,b=U.closeOnClick===false?false:true,Z;if(!c){c=new mstrmojo.Tooltip({refNode:X,highlight:T,closeOnClick:b,updatePopupConfig:null,cssClass:"vi-warning vi-tooltip-V"});Y.addDisposable(c);Y[a]=c;Z=Y.closeOnClick=Y.getCloseOnClickListener();J.attachEvent(document.body,"click",Z);}var W=U.position||R.TOP,V="vi-warning vi-tooltip-";switch(W){case R.TOP:c.cssClass=V+"V";break;case R.BOTTOM:c.cssClass=V+"A";break;case R.LEFT:c.cssClass=V+"D";break;case R.RIGHT:c.cssClass=V+"C";break;}c.open(Y,A.call(Y,U));this.adjustPosition(U);if(T){P.toggleClass(c.refNode,"mstrmojo-Warning",true);}window.clearTimeout(Y._warningTimeOut);Y._warningTimeOut=window.setTimeout(function(){Y.hideWarning();},S);},hideWarning:function H(){var T=this,S=T[T.warningSlotName];if(S&&S.visible&&S.close){if(S.highlight){P.toggleClass(S.refNode,"mstrmojo-Warning",false);}S.close();window.clearTimeout(T._warningTimeOut);delete T._warningTimeOut;}},getCloseOnClickListener:function I(){var S=this;return function(){var T=S[S.warningSlotName];if(T.closeOnClick){S.hideWarning();}};},adjustPosition:function M(S){var T=this;L.call(T[T.warningSlotName],S);},generateContentHTML:function D(S){return E.encodeHtmlString(S,true);},bindWarningHandler:function F(){N.forEach(arguments,function S(U){if(!U||!U.attachEventListener){return ;}var V=U._validationEventListener,T;if(V){U.detachEventListener(V);delete U._validationEventListener;}T=this.getValidationEvtListener();if(T){U._validationEventListener=U.attachEventListener("validationChange",this.id,T);}},this);},getValidationEvtListener:function B(){var T=this;return function S(U){var V=U.value;T[(V&&V.invalid?"show":"hide")+"Warning"](V);};},unrender:function K(S){var T=this[this.warningSlotName];if(T){T.unrender();}this._super(S);},destroy:function O(S){J.detachEvent(document.body,"click",this.closeOnClick);return this._super(S);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupWidget","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.css");mstrmojo.ui.menus.MenuPopup=mstrmojo.declare(mstrmojo.ui.PopupWidget,[mstrmojo.ui.menus._IsMenuPopup],{scriptClass:"mstrmojo.ui.menus.MenuPopup",popupConfig:null,init:function B(D){this._super(D);var C=this.popupConfig;if(!C.contents){throw new Error("Cannot open popup without contents.");}this.cssClass=C.cssClass||"";this.addChildren(C.contents);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-MenuPopup");},shouldPropagateLockHover:function A(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.MenuPopup");mstrmojo.ui.menus.PopupConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.PopupConfig",cssClass:"",contents:null,clear:function A(){this._super();this.contents=null;},close:function C(){([].concat(this.contents)[0]).parent.closeAllMenus();},newInstance:function B(){return new mstrmojo.ui.menus.MenuPopup({popupConfig:this});}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.MenuPopup","mstrmojo.Button","mstrmojo.dom");mstrmojo.requiresDescs(1442,2140);var E=mstrmojo.dom,G=mstrmojo.array;function B(I,K){var H=2140,M="Cancel",L="this.parent.popupConfig."+(I?"ok":"cancel"),J=K&&K[(I?"ok":"cancel")+"BtnText"];if(I){H=1442;M="Ok";}return mstrmojo.Button.newWebButton(J||mstrmojo.desc(H,M),function(O){var P=this.parent,N=P.popupConfig;P.closeAllMenus();N["fn"+M](N.data,P);E.stopPropogation(O.hWin,O.e);},I,{slot:"btnNode",bindings:{enabled:L+"Enabled",visible:L+"Visible"},cssDisplay:"inline-block"});}mstrmojo.ui.menus.MenuEditor=mstrmojo.declare(mstrmojo.ui.menus.MenuPopup,null,{scriptClass:"mstrmojo.ui.menus.MenuEditor",markupString:'<div id="{@id}" class="mstrmojo-ui-MenuEditor {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout,click><div class="me-content"></div><div class="me-buttons"></div><div class="me-bottom"></div></div>',markupSlots:{containerNode:function A(){return this.domNode.firstChild;},btnNode:function D(){return this.domNode.children[1];},bottomNode:function D(){return this.domNode.children[2];}},popupConfig:null,init:function F(J){this._super(J);var I=this.popupConfig,H=I.bottomNode;this.data=I.data||{};if(I.onOpen){this.onOpen=I.onOpen;}this.addChildren([B(true,I),B(false)]);if(H){H.slot="bottomNode";this.addChildren(H);}},onOpen:function C(){G.forEach(this.children,function(H){if(H.scriptClass==="mstrmojo.ui.ScrollableContainer"&&H.onOpen){H.onOpen();}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.TextBox","mstrmojo._CanValidate","mstrmojo.css","mstrmojo.validation","mstrmojo.vi.ui.rw.selectors._HasWarningMessage");var H=mstrmojo.css,E=mstrmojo.validation,G=E.TRIGGER,J=E.STATUSCODE;function F(L){if((this.constraints.trigger&L)>0){this.validate();}}mstrmojo.ValidationTextBox=mstrmojo.declare(mstrmojo.TextBox,[mstrmojo._CanValidate,mstrmojo.vi.ui.rw.selectors._HasWarningMessage],{scriptClass:"mstrmojo.ValidationTextBox",validationDelay:500,getInvalidMsg:function K(L){return(L&&L.msg?L.msg:"");},postBuildRendering:function A(){this._super();this._original_tooltip=this.inputNode.title;},prekeyup:function I(L){this._super(L);var P=(this.constraints.trigger&G.ONKEYUP)>0;if(P){var M=this.validationDelay;if(M){this.clearValDelayTimer();var O=this._validateHandler;if(!O){var N=this;this._validateHandler=O=function(){N.validate();if(N._valDelayTimer){window.clearTimeout(N._valDelayTimer);delete N._valDelayTimer;}};}this._valDelayTimer=window.setTimeout(O,M);}else{this.validate();}}},preinput:function D(L){this._super(L);F.call(this,G.ONKEYUP);},preblur:function B(L){this._super(L);F.call(this,G.ONBLUR);},clearValidation:function C(){this._super();var L=this.inputNode;H.removeClass(L,this.constraints.invalidCssClass||"mstrmojo-TextBox-ErrValidation");L.title=this._original_tooltip;},clearValDelayTimer:function(){var L=this._valDelayTimer;if(L){window.clearTimeout(L);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ValidationTextBox,{onvalidationStatusChange:function(){var P=this.validationStatus;if(!P){return ;}var N=this.inputNode,L=(P.code>J.VALID),M=this.constraints.invalidCssClass;H.toggleClass(N,M||"mstrmojo-TextBox-ErrValidation",L);var O=L?this.getInvalidMsg(P):this._original_tooltip;if(!this.useRichTooltip&&O!==undefined&&O!==null){N.setAttribute("title",O);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.css","mstrmojo.hash");var D=mstrmojo.dom,C=mstrmojo.css,G=mstrmojo.hash,B=9,F="px";mstrmojo.AttributeSlider=mstrmojo.declare(mstrmojo.Slider,null,{scriptClass:"mstrmojo.AttributeSlider",thumbWidth:7,synchronizeSlider:function A(){if(this.isHoriz){var N=this.orCfg,M=N.lenCssP,J=this[M],H=parseInt(J,10),Q=this.hasRendered;var K=this._effLen=isNaN(H)?0:(H-this._exRoom-(2*B));if(J){var P={};P[M]=Math.max(parseInt(J,10)-(2*this.cssBkBW),0)-(2*B)+F;var L={};L[M]=K+F;L[N.posCssP]=Math.round(this._exRoom/2)+B+F;L[N.opPosCssP]="0"+F;if(Q){G.copy(P,this.bgNode.style);G.copy(L,this.sdcNode.style);}else{this.bkCssText=C.getCssTextFromObj(P);this.sdcCssText=C.getCssTextFromObj(L);}}var R=this.selectedIndices;if(!G.isEmpty(R)){this.min=this.items.length-1;this.max=0;var O;for(O in R){if(R[O]){this.min=Math.min(this.min,O);this.max=Math.max(this.max,O);}}}var I=this.typeHelper;this.unit=I.getUnit();if(Q){I.updateThumb();}else{I.preUpdateThumb();}}else{this._super();}},postBuildRendering:function E(){this._super();C.addClass(this.containerNode,["attslider"]);C.addClass(this.frontNode,["attslider"]);C.addClass(this.thumbNode,["attslider"]);C.addClass(this.endNode,["attslider"]);C.addClass(this.bgNode,["attslider"]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ui.menus._HasMenuPopup","mstrmojo._CanAutoClose","mstrmojo._IsPopup","mstrmojo.ui.menus._IsMenuPopup","mstrmojo.ui.PopupConfig","mstrmojo.ui._HasScroller","mstrmojo.ui._HasUITheme","mstrmojo.dom","mstrmojo.css","mstrmojo.ui._HasListTooltip");var D=mstrmojo.dom,P=mstrmojo.css,I=mstrmojo.ui.PopupConfig.directionCfg;var Q={};var K=false;function F(V,W){if(V.pop){if(W&&V.ax){window.clearTimeout(this._popupAxTimeout);V.actionFn();this.closeAllMenus();}else{var T=V.fn.call(mstrmojo.all[V.scope],V.ctxt);var U=T.ENUM_CORNERS;T.setAlignment(U.TOP_RIGHT,U.TOP_LEFT);T.hostId=this.id;T.hostElement=this._getItemNode(V._renderIdx);this.openPopup(T.newInstance());}}else{if(V.dsbld!==true){if(V.fn(V,this)!==false){this.closeAllMenus();}}}}function G(T){var U=parseInt(T);return U===null||isNaN(U)?0:U;}mstrmojo.ui.menus.Menu=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.menus._HasMenuPopup,mstrmojo._IsPopup,mstrmojo.ui.menus._IsMenuPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip,mstrmojo.ui._HasScroller,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.ui.menus.Menu",selectionPolicy:"reselect",locksHover:true,closeOnClick:true,themeClassName:"mojo-theme-dark",icnCss:"mstrmojo-ui-Menu-item-container",popupConfig:null,tooltipCss:{leftCssClass:"menuTooltip",rightCssClass:"menuTooltip"},setupScrollNodes:function(){if(this.popupConfig&&this.popupConfig.supportsScroll){this.scrollNode=this.itemsContainerNode;this.scrollbarHostNode=this.domNode;}},updateScrollbars:function(){this._super();if(this.popupConfig&&this.popupConfig.supportsScroll&&this.hasCustomScrollbar){var V=this.scrollNode;if(!V){return ;}var T=(getComputedStyle&&getComputedStyle(V,null))||V.currentStyle,U=V.offsetWidth-G(T.borderLeftWidth)-G(T.borderRightWidth)-V.clientWidth;V.style.marginRight=-U+"px";V.style.paddingRight=0;}},onscroll:function(){this.closePopup();this._super();},init:function L(V){this._super(V);var T=this.popupConfig;this.items=T.getMenuItems();var U=["mstrmojo-ui-Menu","unselectable"],W=T.menuCssClass;if(W){U.push(W);}P.addWidgetCssClass(this,U);if(T&&T.supportsScroll&&T.maxHeight>0){this.icnCssText=(this.icnCssText||"")+";max-height:"+T.maxHeight+"px";}this.useRichTooltip=!!T.useTooltip;this.tstid=T.tstid;},markupMethods:{onvisibleChange:function J(){var T=this.visible;if(!K||T){P.toggleClass(this.domNode,"visible",T);}}},getItemMarkup:function C(X,T){if(X.getItemMarkup){return X.getItemMarkup.apply(this,[X,T]);}var V=!!X.pop,W=V?"submenu":"item",U=Q[W];if(!U){U=this._super(X,T).replace("{@en@n}",'<div class="micn"></div>{@en@n}');if(V){U=U.replace("{@en@n}",'{@en@n}<div class="arw"></div>');}Q[W]=U;}if(X.tstid){U=U.replace("{@tag}","{@tag} "+mstrmojo.tstid(X)+" ");}return U;},getItemProps:function R(V,T){var U=this._super(V,T);U.tag="a";U.addCls("mstrmojo-ui-Menu-item");U.addCls(V.cls);return U;},adjustCornersForPopupOverflow:function O(){var V=this._super(),Z=this.domNode,Y,X,T,U,W;if(V){Y=D.position(Z);T=Y.y;X=Z.style;U=this.popupConfig;W=U.position||D.position(U.hostElement);if(T<0||(T+Y.h>D.position(document.body).h)){X.top=(-W.y+5)+"px";X.bottom="auto";}}return V;},onmouseover:function E(T){var Y=T.getTarget(),X=this.getItemFromTarget(Y),W=this,V=W._lastOpened,a=V&&this.getItemFromTarget(V.popupConfig.hostElement)._renderIdx,Z=this.getItemNodeFromTarget(Y),U=(a!==undefined&&D.contains(this._getItemNode(a),Y,true,this.domNode));if(X){this._lastHoverIx=X._renderIdx;window.clearTimeout(this._popupTimeOut);window.clearTimeout(this._popupAxTimeout);if(this._lastHoverIx!==a&&!U){this._popupTimeOut=window.setTimeout(function(){if(W._lastOpened&&W._lastOpened.visible){W.closePopup();}if(W.visible&&X.pop){if(X.ax){W._popupAxTimeout=window.setTimeout(function(){P.removeClass(Z,"hlt-ax");F.call(W,X);},0);}else{F.call(W,X);}}},400);if(X.pop&&X.ax){P.addClass(Z,"hlt-ax");}}}},onclick:function S(T){this._evtTarget=T.getTarget();this._super(T);T.cancel();},postselectionChange:function H(T){var U=T.added;if(U){var V=this.items[U[0]];F.call(this,V,!(V.ax&&this._evtTarget.className==="arw"));delete this._evtTarget;}},oncontextmenu:function M(T){D.preventDefault(window,T.e);return false;},postBuildRendering:function N(T){this._super(T);if(this.popupConfig.supportsScroll){var U=this;window.setTimeout(function(){U.updateScrollbars();},10);}},showTooltip:function B(X,W){var V=D.eventTarget(W,X),U=this.getItemNodeFromTarget(V),T=this.getItemFromTarget(V);if(U&&((T&&T.ttp)||(U.scrollWidth>U.clientWidth))){this._super(X,W);}},onClose:function A(T){if(this._super){this._super(T);}this.closePopup();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.ScrollableList","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.ui._HasListTooltip");mstrmojo.ui.PopupList=mstrmojo.declare(mstrmojo.ui.ScrollableList,[mstrmojo._IsPopup,mstrmojo._CanAutoClose,mstrmojo.ui._HasListTooltip],{scriptClass:"mstrmojo.ui.PopupList",autoCloses:true,locksHover:true,closeOnClick:true,parentDomNode:undefined,markupString:'<div id="{@id}" class="mstrmojo-PopupList {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu><div class="mstrmojo-popupList-scrollBar"><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function D(){return this.domNode.firstChild.firstChild;},scrollboxNode:function F(){return this.domNode.firstChild;}},setupScrollNodes:function E(){this.scrollNode=this.scrollboxNode;},onOpen:function B(){this._super();this.updateScrollbars();},postBuildRendering:function C(){var H=this._super();if(!this.parent){var G=this.parentDomNode=this.parentDomNode||document.body;G.appendChild(this.domNode);}return H;},closePopup:function A(){this.set("visible",false);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.pathbar.PathPopup","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.pathbar._PreAppExit");function A(){this.addDisposable(this.breadCrumbs=new mstrmojo.ui.pathbar.PathPopup({id:"mojoPathBreadCrumbs",cssClass:"mojoPathPicker",offsetLeft:0,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"breadCrumbsItems",preclick:function I(){this.parent.close();},items:null,getItemMarkup:function(){return'<a href="#" idx="{@idx}"><span>{@en@n}</span></a>';},getItemProps:function J(L,K){return{n:mstrmojo.string.decodeHtmlString(L.n),idx:K,href:L.href};}}]}));}var D=mstrmojo.css,G=mstrmojo.dom;mstrmojo.ui.pathbar.PathAncestors=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.pathbar._PreAppExit],{scriptClass:"mstrmojo.ui.pathbar.PathAncestors",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout><div class="pathText"><div class="pathBreadCrumbs"><span class="pathBreadCrumbsParent"><a href="{@pathParentLink}">{@pathParentName}</a></span><span class="pathBreadCrumbsPullArrow"></span><span class="pathDelim">{@delimiter}</span></div><div class="pathAncestor hidden">{@itemsHtml}</div><div class="pathCurrent"><span>{@pathCurrent}</span></div></div></div>',markupSlots:{breadCrumbsNode:function(){return this.domNode.firstChild.children[0];},breadCrumbsParentNode:function(){return this.domNode.firstChild.children[0].firstChild;},breadCrumbsArrowNode:function(){return this.domNode.firstChild.children[0].children[1];},ancestorNode:function(){return this.domNode.firstChild.children[1];},currentNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.firstChild.children[1];}},markupMethods:{onwidthChange:function(){var K=this,I=K.ancestorNode,J=K.breadCrumbsNode;if(K.getNeededWidth()>K.getAvailWidth()){D.toggleClass(J,"hidden",false);D.toggleClass(I,"hidden",true);K.resizeBreadCrumbs();}else{K.resizePathBar();}}},delimiter:">",pathCurrent:null,pathFirst:null,pathParent:null,breadCrumbs:null,reversedItems:null,init:function H(J){this._super(J);var I=this.items;this.pathCurrent=I[I.length-1].n;this.pathFirstLink=I[0].href;this.pathFirstName=I[0].n;if(I.length>1){this.pathParentLink=I[I.length-2].en!=true?"#":I[I.length-2].href;this.pathParentName=I[I.length-2].n;}I.splice(I.length-1,1);this.reversedItems=[].concat(I).reverse();A.call(this);},resizePathBar:function(){var P=this,M=P.ancestorNode,I=P.currentNode,K=P.breadCrumbsNode,R=M.style,J=I.style,Q=G.position(P.domNode).w-23-20,O,N,L;O=Math.min(Q/2,G.position(I).w);N=Q-O;L=N>M.scrollWidth?N-M.scrollWidth:0;N-=L;R.maxWidth=Math.max(0,N)+"px";J.maxWidth=Math.max(0,Q-N)+"px";},resizeBreadCrumbs:function(){var N=this,I=N.currentNode,O=N.breadCrumbsParentNode,J=I.style,L=O.style,P=G.position(N.domNode).w-60,M,Q,K;L.maxWidth=Math.max(0,P)+"px";J.maxWidth=Math.max(0,P)+"px";M=Math.min(P/2,G.position(I,true).w);Q=P-M;K=Q>O.scrollWidth?Q-O.scrollWidth:0;Q-=K;L.maxWidth=Math.max(0,Q)+"px";J.maxWidth=Math.max(0,P-Q)+"px";},onclick:function C(I){var J=this.breadCrumbs;if(!this._super(I)){return false;}var K=I.getTarget();if(K==this.breadCrumbsArrowNode){J.set("targetNode",this.breadCrumbsNode);J.breadCrumbsItems.set("items",this.reversedItems.slice(1));if(!J.isOpen){J.open();}}},getItemMarkup:function(){return'<span idx="{@idx}"><a href="#">{@n}</a></span><span class="pathDelim">{@dl}</span>';},getItemProps:function E(J,I){return{n:J.n,href:J.href,dl:this.delimiter,idx:I};},getNeededWidth:function B(){var L=this.breadCrumbsNode,I=this.ancestorNode,K=this.currentNode,J=this.breadCrumbs;D.toggleClass(L,"hidden",true);D.toggleClass(I,"hidden",false);if(J.isOpen){J.close();}return I.scrollWidth+K.scrollWidth+30;},getAvailWidth:function F(){var I=this;return G.position(I.domNode).w-23-20;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.pathbar.PathPopup","mstrmojo.mstr._RecentObjectsHelper");function D(H,I){var G=this.handleRecentObjects();var J;H.addDisposable(J=new mstrmojo.ui.pathbar.PathPopup({id:"mstrRecentsGenPopup",cssClass:"mstrShortcutsListPopup",targetNode:I,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function E(){this.parent.close();},items:G,getItemMarkup:function(M){var K="";if(mstrConfig.showPreviews){if(M.recoveryInfo!==undefined){var L=(M.recoveryInfo.imgData!==undefined)?"data:image/png;base64,"+M.recoveryInfo.imgData:"";if(L!==""){K='<img class = "img-preview" src = "'+L+'" height="200" width="250" style="z-index: 100; position: absolute;">';}}}return'<span class="item mstrMenuItem {@itemCls}" style="{@cssText}"><span class="{@iconCls}"></span><a class="mstrLink" href="{@href}">{@n}'+K+"</a></span>";},getItemProps:function F(M,K){var L=!!M.selected;return{sel:L,iconCls:M.iconClass,itemCls:M.itemClass,cssText:M.cssText||"",cls:L?"selected":"",newGroup:!!M.grp?"grp":"",n:M.recoveryName,idx:K,href:M.recoveryURL,name:M.recoveryName,target:M.target||"_self"};},onclick:function(K){var M=function(){mstrmojo.dom.preventDefault(K.hWin,K.e);mstrmojo.dom.stopPropogation(K.hWin,K.e);};var L=K.getTarget();if(L.getAttribute("href")){mstrmojo.form.sendLinkAsForm(L.href);}else{mstrmojo.form.sendLinkAsForm(L.parentElement.href);}M();return false;}}]}));return J;}function A(){var I=this;this.addDisposable(this.popup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrSCList",cssClass:"mstrShortcutsListPopup",targetNode:this.domNode,offsetTop:2,recentsPopup:null,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function E(J){if(J.getTarget().getAttribute("name")!=="recentObjects"){this.parent.close();}},handleMouseOver:function H(J,K){if(J.getTarget().getAttribute("name")=="recentObjects"){this.handleClick(J,K);}else{if(this.parent.recentsPopup!=null){var L=this.parent.recentsPopup;L.close();}}return false;},handleClick:function F(K,L){if(K.getTarget().getAttribute("name")=="recentObjects"){var M=K.getTarget();if(M.nodeName==="SPAN"){M=M.parentNode;}if(this.parent.recentsPopup==null){this.parent.recentsPopup=D.call(I,this.parent,M);}var N=this.parent.recentsPopup;N.autoPosition=false;var J=M.getBoundingClientRect();if(!N.isOpen){N.offsetTop=J.top-J.bottom;N.offsetLeft=this.domNode.clientWidth-J.left;N.open();}return true;}return false;},items:mstrApp.pathInfo.sb,getItemMarkup:function(K){var J="{@cls}";if(K.name==="recentObjects"){J="";}return'<a name="{@name}" class="item {@name} '+J+' {@newGroup}" idx="{@idx}" onclick="{@onclick}" href="#" target="{@target}"><span name="{@name}" class="icon"></span><span name="{@name}">{@n}</span></a>';},getItemProps:function G(L,J){var K=!!L.selected;return{sel:K,cls:K?"selected":"",newGroup:!!L.grp?"grp":"",n:L.n,idx:J,href:L.href,name:L.name,onclick:L.onclick||"return true",target:L.target||"_self"};}}]}));}mstrmojo.ui.pathbar.PathStarBurst=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.mstr._RecentObjectsHelper],{scriptClass:"mstrmojo.ui.pathbar.PathStarBurst",markupString:'<a id="mstrStarburst {@id}" mstrAttach:click,mouseover,mouseout class="mstrLink" style="top:0"><div id="mstrLogo" class="mstrLogo path"></div><div id="mstrLogoMenu" class="mstrLogoMenu path mstrPullArrow"></div></a>',markupSlots:{logoNode:function(){return this.domNode.children[0];},logoMenuNode:function(){return this.domNode.children[1];}},popup:null,postBuildRendering:function C(){A.call(this);this.domNode.setAttribute("href",mstrApp.name+"?evt=3010&src="+mstrApp.name+".3010");},onclick:function B(E){var F=function(){mstrmojo.dom.preventDefault(E.hWin,E.e);mstrmojo.dom.stopPropogation(E.hWin,E.e);};if(E.getTarget()===this.logoMenuNode){var G=this.popup;if(!G.isOpen){G.open();}F();}else{mstrmojo.form.sendLinkAsForm(E.src.domNode.href);F();return false;}}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.pathbar.PathPopup","mstrmojo.dom","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.ui.pathbar._PreAppExit");var D=mstrmojo.dom;function C(){this.addDisposable(this.pickerMenu=new mstrmojo.ui.pathbar.PathPopup({id:"mojoPathPickerMenu",cssClass:"mojoPathPicker",offsetLeft:-23,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function F(){this.parent.close();},items:null,getItemMarkup:function(){return'<a href="#" idx="{@idx}"><span>{@en@n}</span></a>';},getItemProps:function G(I,H){return{n:I.n,idx:H,href:I.href};}}]}));}mstrmojo.ui.pathbar.PathNavigation=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.pathbar._PreAppExit],{scriptClass:"mstrmojo.ui.pathbar.PathNavigation",icnCss:"pathNavigationRight",pickerMenu:null,init:function E(F){this._super(F);C.call(this);},onclick:function A(G){var H=this.pickerMenu;if(!this._super(G)){return false;}var K=G.target||D.eventTarget(G.hWin,G.e),I=D.findAncestorByAttr(K,"idx",true,this.domNode),F=I&&parseInt(I.value,10),J=this.items[F];if(J&&J.en&&J.items){if(H.targetNode!==I.node){H.set("targetNode",I.node);H.menuItems.set("items",J.items);}if(!H.isOpen){H.open();}}},getItemMarkup:function(F){if(F.items){return'<span class="tb{@n} mstrComboDown" idx="{@idx}"><a class="tb{@n}0 mstrIcon-tb {@en}" title="{@desc}" href="#"></a><span class="tb{@n}1 mstrPullArrow {@en}" title="{@desc}" menu="true"></span></span>';}if(F.visible===false){return"";}return'<a href="#" idx="{@idx}"><span title="{@desc}" class="tb{@n} mstrIcon-tb {@en}"></span></a>';},getItemProps:function B(G,F){return{n:G.n,idx:F,href:G.href,desc:G.desc,en:G.en?"":"disabled"};}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.pathbar.PathPopup","mstrmojo.dom","mstrmojo.css");function D(){var N=this,J=N.domNode,Q=mstrmojo.dom.position(N.targetNode),L=mstrmojo.dom.windowDim();J.style.top=(Q.y+Q.h+N.offsetTop)+"px";var P=Q.x+Q.w,M=L.w-P-J.offsetWidth;if(P+J.offsetWidth>L.w){M=L.w-Q.x;if(M+J.offsetWidth>L.w){M=0;}}if(N.id==="mstrToolbarList"){M=M-Q.w*0.75;}J.style.right=M+"px";N.set("visible",false);N.isOpen=true;N.set("visible",true);var O=parseInt(J.style.top,10);if(O+J.offsetHeight>L.h){var K=O-J.offsetHeight+Q.h;J.style.top=(K>0?K:0)+"px";}mstrmojo.css.toggleClass(N.targetNode,"opened",true);}function B(){var J=this.popup,M=J.containerNode.childNodes[0].childNodes[0].childNodes[J.zoomChildIndex].lastChild,L=M.textContent||M.innerText,K=J.dc.view.zoomValue;L=L.substr(0,L.indexOf("("));M.innerHTML=L+"("+K.n+")";}function C(N){var O=N.selectedItem;if(O===null){return ;}var S=N.containerNode.firstChild.firstChild,J=N.dc.view.zoomValue,Q=O.getAttribute("dssid");if(Q===J.dssid){return ;}mstrmojo.css.removeClass(O,"selected");var M=S.childNodes,R=M.length,P=0,K=-1,L;for(P=0;P<R;P++){L=M[P];if(L.getAttribute("dssid")===J.dssid){K=P;break;}}if(K===-1){var T=N.children[0];T.addItems([J]);L=S.childNodes[T.items.length-1];}mstrmojo.css.addClass(L,"selected");N.selectedItem=L;}function F(J,Q,M){var L;Q.addDisposable(L=new mstrmojo.ui.pathbar.PathPopup({id:"mstrZoomPopup",cssClass:"mstrShortcutsListPopup",targetNode:M,dc:Q.dc,slectedIndex:-1,selectedItem:null,onOpen:function K(){D.call(this);},onClose:function P(){delete this.isOpen;mstrmojo.css.toggleClass(this.targetNode,"opened",false);this.domNode.style.top="-10000px";},children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function N(){this.parent.close();},items:J,getItemMarkup:function(){return'<a class="item {@cls}" dssid="{@dssid}"><span class="icon"></span><span>{@name}</span></a>';},getItemProps:function O(V,S){var T=V.dssid===this.parent.dc.view.zoomValue.dssid,U="";if(T){this.parent.selectedIndex=S;U="selected";}return{cls:U,dssid:V.dssid,name:V.n};},onclick:function R(a){var Z=this.parent,U=mstrmojo.dom.findAncestorByAttr(a.getTarget(),"dssid",true,Z.domNode),Y=U.node,W=Y.getAttribute("dssid"),T=Z.targetNode.getAttribute("cmdid"),b=Z.dc,S=b.view.zoomValue,V=S.dssid;if(W!==V){b[T](W);var X=Z.targetNode.lastChild.textContent||Z.targetNode.lastChild.innerText;Z.targetNode.lastChild.innerHTML=X.replace(S.n,Y.lastChild.textContent||Y.lastChild.innerText);if(Z.selectedItem===null){Z.selectedItem=this.domNode.firstChild.childNodes[Z.selectedIndex];}mstrmojo.css.removeClass(Z.selectedItem,"selected");mstrmojo.css.addClass(Y,"selected");Z.selectedItem=Y;}}}]}));return L;}function E(J,P,L){var Q;P.addDisposable(Q=new mstrmojo.ui.pathbar.PathPopup({id:"mstrExportPopup",cssClass:"mstrShortcutsListPopup",targetNode:L,dc:P.dc,onOpen:function K(){D.call(this);},onClose:function O(){delete this.isOpen;mstrmojo.css.toggleClass(this.targetNode,"opened",false);this.domNode.style.top="-10000px";},children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",preclick:function M(){this.parent.close();},items:J,getItemMarkup:function(){return'<a class="item" dssid="{@dssid}"><span class="icon" style="display:none;"></span><span>{@name}</span></a>';},getItemProps:function N(S){return{cls:S.cssClass,dssid:S.dssid,name:S.n};},onclick:function R(T){var V=mstrmojo.dom.findAncestorByAttr(T.getTarget(),"dssid",true,this.parent.domNode),W=V.node,U=W.getAttribute("dssid"),S=this.parent.dc;S.exportCmd(U);}}]}));return Q;}function G(){this.addDisposable(this.popup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrToolbarList",cssClass:"mstrShortcutsListPopup",targetNode:this.domNode,offsetTop:0,zoomChildIndex:null,onOpen:function K(){D.call(this);},children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",items:mstrApp.pathInfo.tbModelData.n.items,getItemMarkup:function(){return'<a class="item {@cls}" cmdId="{@cmdid}" idx="{@idx}"><span class="icon" style="display:none;"></span><span>{@name}</span></a>';},getItemProps:function M(R,O){var Q=!!R.selected,S=R.cmdid,P=R.tooltip||R.title||S;if(S==="zoom"){P+=" ("+this.parent.dc.view.zoomValue.n+")";this.parent.zoomChildIndex=O;}return{sel:Q,idx:O,cls:S,n:S,cmdid:S,name:P};},closePopup:function J(O){if(O){O.close();}},onmouseover:function N(S){var R=mstrmojo.dom.findAncestorByAttr(S.getTarget(),"cmdid",true,document.getElementById("mstrToolbarList")),T=R&&R.value,Q=this.parent,P=Q.exportPopup,O=Q.zoomPopup;if(T==="export"){this.onclick(S,R);this.closePopup(O);}else{if(T==="zoom"){this.onclick(S,R);this.closePopup(P);}else{if(T){this.closePopup(P);this.closePopup(O);}}}return false;},onclick:function L(P,T){P.cancel();var R=T||mstrmojo.dom.findAncestorByAttr(P.getTarget(),"cmdid",true,document.getElementById("mstrToolbarList")),V=R.node,Y=V.getAttribute("idx"),Q=R&&R.value,X=this.parent,Z=X.dc,O=[],W=null;if(Q==="export"){if(!X.exportPopup){O=this.items[Y].items;X.exportPopup=E(O,X,V);}var U=X.exportPopup;U.autoPosition=false;W=V.getBoundingClientRect();if(!U.isOpen){U.offsetTop=-(W.height||V.offsetHeight);U.open();}}else{if(Q==="zoom"){if(!X.zoomPopup){O=this.items[Y].items;X.zoomPopup=F(O,X,V);}var S=X.zoomPopup;S.autoPosition=false;W=V.getBoundingClientRect();if(!S.isOpen){S.offsetTop=-(W.height||V.offsetHeight);if(S.hasRendered){C.call(this,S);}S.open();}}else{if(Z[Q]){Z[Q]();X.close();}}}}}]}));}mstrmojo.ui.pathbar.PathHamburger=mstrmojo.declare(mstrmojo.Widget,null,{userName:null,init:function I(J){this._super(J);},scriptClass:"mstrmojo.ui.pathbar.PathHamburger",markupString:'<div id="mstrHamburger" mstrAttach:click class="mstrHamburgerButton" style="top:0"><div class="mstrHamburger path"></div></div>',popup:null,postBuildRendering:function A(){G.call(this);},onclick:function H(){var J=this.popup;if(!J.dc){J.dc=this.parent.dc;}if(!J.isOpen){if(J.hasRendered){B.call(this);}J.open();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.pathbar.PathPopup");function D(F){return(F!=="myPage");}function A(){this.addDisposable(this.popup=new mstrmojo.ui.pathbar.PathPopup({id:"mstrAccountSCList",cssClass:"mstrShortcutsListPopup mstrAccountSCListPopup",targetNode:this.domNode,offsetTop:0,children:[{scriptClass:"mstrmojo.ui.pathbar.List",alias:"menuItems",useRichTooltip:true,postclick:function H(){if(D(this.selectedItem.name)){this.parent.close();}},items:mstrApp.pathInfo.el,getTooltipText:function F(I){if(I&&I.name==="save"){return mstrmojo.desc("14684","Publish current layout as default layout for other users");}else{return null;}},getItemMarkup:function(){return'<a class="item {@name} {@cls} {@newGroup}" idx="{@idx}" onclick="{@onclick}" href="#" target="{@target}"><span class="icon"></span><span>{@n}</span></a>';},getItemProps:function G(K,I){var J=!!K.selected;return{sel:J,cls:J?"selected":"",newGroup:!!K.grp?"grp":"",n:K.n,idx:I,href:K.href,name:K.name,onclick:K.onclick||"return false;",target:K.target||"_self"};}}]}));}mstrmojo.ui.pathbar.PathExtraLinks=mstrmojo.declare(mstrmojo.Widget,null,{userName:null,init:function E(G){var H=this;this._super(G);var F=this.items;this.userName=F[0].user;mstrmojo.array.forEach(this.items,function(I){if(I.name==="save"){I.onclick="mstrmojo.all."+H.id+".raiseEvent({name:'saveDefaultCard'})";I.en=false;}if(I.name==="load"){I.onclick="mstrmojo.all."+H.id+".raiseEvent({name:'loadDefaultCard'})";I.en=false;}if(I.name==="myPage"){I.en=false;}});F.splice(0,1);},scriptClass:"mstrmojo.ui.pathbar.PathExtraLinks",markupString:'<div id="mstrPathAccount" mstrAttach:click class="mstrLink" style="cursor:pointer;"><span class="mstrAccountName" title="{@userName}">{@userName}</span><div id="mstrAccountMenu" class="mstrAccountMenu path"></div></div>',popup:null,postBuildRendering:function C(){A.call(this);},onclick:function B(){var F=this.popup;if(!F.isOpen){F.open();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.CheckBoxDIC");var B=mstrmojo.css,A=mstrmojo.dom;mstrmojo.MarkRowDIC=mstrmojo.declare(mstrmojo.CheckBoxDIC,null,{scriptClass:"mstrmojo.MarkRowDIC",cssClass:"mstrmojo-MarkRowDIC",onclick:function(){if(this.grayed){this.set("grayed",false);}this.set("checked",!this.checked);var E=this.group&&this.group.widgetsMap,D,C;if(this.markAll){for(D in E){if(E.hasOwnProperty(D)){C=E[D];if(C.checked!==this.checked){C.set("checked",this.checked);}}}}else{for(D in E){C=E[D];if(C.markAll&&C.checked!==this.checked){C.set("grayed",true);break;}}}},postBuildRendering:function(){if(this._super){this._super();}var C=this.openerNode;if(!this.markAll){A.attachEvent(this.domNode,"mouseover",function(D){B.addClass(C.parentNode,"markSelection");});A.attachEvent(this.domNode,"mouseout",function(D){B.removeClass(C.parentNode,"markSelection");});}}});})();(function(){mstrmojo.requiresCls("mstrmojo.LegacySuggestionList","mstrmojo.ui._HasScroller");var C=mstrmojo.dom;mstrmojo.ui.ScrollableSuggestionList=mstrmojo.declare(mstrmojo.LegacySuggestionList,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-scrollable-suggestlist {@cssClass}" style="{@cssText}" mstrAttach:click,dblclick,mouseover,mouseout,contextmenu><div class="list-content"><div class="items-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div></div>',markupSlots:{itemsContainerNode:function B(){return this.domNode.firstChild.firstChild;},scrollboxNode:function E(){return this.domNode.firstChild;},scrollNode:function H(){return this.domNode.firstChild;}},onclick:function A(I){var J=this.getItemFromTarget(I.getTarget());if(J){this._super(I);}},onitemsChange:function D(){var I=this;window.setTimeout(function(){I.hideTooltip();I.updateScrollbars();},0);},updateScrollbars:function F(){this._super();var K=this,M=K.scrollNode,I=M.clientWidth,L=K.itemsContainerNode,J=L.clientWidth;L.style.width="auto";window.setTimeout(function(){if(I>J){L.style.width=J+(I-J)+"px";}},10);},useRichTooltip:true,getItemTooltip:function(L,M){var J=C.position(M),K=M.ttp;var I={areaId:L._renderIdx+"text",cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:"",content:K,top:J.y,left:J.x+J.w+6,enableHover:false};return I;},showTooltip:function G(I,L){var K=this.targetEl,J=this.targetItem;if(K&&K.ttp){this.richTooltip=this.getItemTooltip(J,K);if(this.richTooltip){this._super(I,L);}}}});}());(function(){mstrmojo.requiresClsP("mstrmojo","ListBase","_IsList");mstrmojo.requiresCls("mstrmojo.ui.CheckList");mstrmojo.requiresDescs(2121,2122,2125,2127,2123,2124,2126,2128,2129,2130);var D=mstrmojo.desc,C=mstrmojo.array;mstrmojo.express.ui.SubtotalsWidget=mstrmojo.declare(mstrmojo.ui.CheckList,null,{scriptClass:"mstrmojo.express.ui.SubtotalsWidget",prevSelection:{},itemField:"v",selectionPolicy:"toggle",multiSelect:true,init:function B(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-vi-subtotals");},_set_selectedItems:function(H,F){var E=[],G=this.prevSelection={};C.forEach((F||[]),function(I){E.push(I.t);});C.forEach(E,function(I){G[I]=true;});this.setSelectedItems(C.filter(this.items,function(I){return C.indexOf(E,I.v)>-1;}));},getSubtotalTypes:function A(){var G=this.items,H=this.selectedIndices,J=this.prevSelection,F=G.filter(function(L,K){return H[K]&&!J[L.v];}),I=G.filter(function(L,K){return !H[K]&&J[L.v];}),E=function(K){return K.v;};return[F.map(E),I.map(E)];},items:[{n:D(2121,"Total"),v:-10},{n:D(2122,"Average"),v:-12},{n:D(2125,"Maximum"),v:-14},{n:D(2127,"Minimum"),v:-13},{n:D(2123,"Count"),v:-11},{n:D(2124,"Geometric Mean"),v:-20},{n:D(2126,"Median"),v:-16},{n:D(2128,"Mode"),v:-17},{n:D(2129,"Product"),v:-15},{n:D(2130,"Standard Deviation"),v:-18},{n:D(2132,"Variance"),v:-19}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxBase");mstrmojo.ButtonItemRenderer=mstrmojo.hash.copy(mstrmojo.DivItemRenderer);mstrmojo.ButtonItemRenderer.render=function(D,A,E){var B=D.v!=="u;"?" nAll":"",C=(E.enabled===false);return'<input mstridx="'+A+'" class="'+E.itemCssClass+(E.selectedIndices[A]?" "+E.itemSelectedCssClass:"")+" "+(D.css||"")+B+'" style="'+E.itemCssText+'" type="button"  value="'+D[E.itemDisplayField]+'" '+(C?"disabled ":"")+"/>";};mstrmojo._RendersItemButtons=mstrmojo.hash.copy(mstrmojo._RendersItemDivs);mstrmojo._RendersItemButtons.itemRenderer=mstrmojo.ButtonItemRenderer;mstrmojo.ButtonList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonList",cssClass:"mstrmojo-ButtonList",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.ButtonListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemButtons],{scriptClass:"mstrmojo.ButtonListHoriz",cssClass:"mstrmojo-ButtonListHoriz",itemCssClass:"mstrmojo-ButtonItem",selectionPolicy:"toggle"});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.color");var C=[127,206,255];var D=[216,230,239];var B=function(H,K){if(!H||H==="transparent"){H="#FFFFFF";}var G=mstrmojo.color.hex2rgb(H),J,I,E;if(!K){J=Math.round((3/5)*parseInt(G[0])+110);I=Math.round((3/5)*parseInt(G[1])+110);E=Math.round((3/5)*parseInt(G[2])+110);}else{J=G[0]*K[0]/255;I=G[1]*K[1]/255;E=G[2]*K[2]/255;var F=G[0]*0.3+G[1]*0.59+G[2]*0.11;if(F<85){J=J+(63*((85-F)/85));if(J>255){J=255;}I=I+(63*((85-F)/85));if(I>255){I=255;}E=E+(96*((85-F)/85));if(E>255){E=255;}}}return"#"+mstrmojo.color.rgb2hex(J,I,E);};var A=function(F,G,E){if(F&&F.style){F.style.backgroundColor=G["bg"+E+"Color"]||"";F.style.color=G["text"+E+"Color"]||"";}};mstrmojo.LinkItemRenderer=mstrmojo.hash.copy({render:function(G,E,H){var F=G.v!=="u;"?" nAll":"";return'<input mstridx="'+E+'" class="'+H.itemCssClass+(H.selectedIndices[E]?" "+H.itemSelectedCssClass:"")+F+'" style="'+H.itemCssText+" color:"+(H.selectedIndices[E]?H.textSelectedColor:H.textNormalColor)+"; background-color:"+(H.selectedIndices[E]?H.bgSelectedColor:H.bgNormalColor)+';" type="button"  value="'+G[H.itemDisplayField]+'"  onmouseover="mstrmojo.all.'+H.id+".onmouseover(self, "+E+')" onmouseout="mstrmojo.all.'+H.id+".onmouseout(self, "+E+')"/>';},select:function(F,G,E,H){F.className+=" selected";A(F,H,"Selected");},unselect:function(F,G,E,H){F.className=F.className.replace(/selected/g,"");A(F,H,"Normal");},highlight:function(G,H,E,I){var F=I.selectedIndices[E]?"Selected":"Highlighted";A(G,I,F);},unhighlight:function(G,H,E,I){var F=I.selectedIndices[E]?"Selected":"Normal";A(G,I,F);}},mstrmojo.hash.copy(mstrmojo.DivItemRenderer));mstrmojo._RendersItemLinks=mstrmojo.hash.copy({onmouseover:function(G,E){if(isNaN(E)||E<0){return ;}var F=this._getItemNode(E);this.itemRenderer.highlight(F,this.items[E],E,this);},onmouseout:function(G,E){if(isNaN(E)||E<0){return ;}var F=this._getItemNode(E);this.itemRenderer.unhighlight(F,this.items[E],E,this);},preBuildRendering:function(){this.bgNormalColor=this["background-color"]||this.parent&&this.parent["background-color"];this.bgSelectedColor=this.parent&&this.parent.defn&&this.parent.defn.ssc;if(this.bgSelectedColor!=null){if(this.bgSelectedColor==="transparent"){this.bgHighlightedColor=mstrmojo.LinkList.dftTrptBgHltColor;}else{this.bgHighlightedColor=B(this.bgSelectedColor);}}else{this.bgSelectedColor=B(this.bgNormalColor,C);this.bgHighlightedColor=B(this.bgNormalColor,D);}this.textSelectedColor=(this.bgSelectedColor==="transparent")?mstrmojo.LinkList.dftTrptTxSelColor:mstrmojo.color.getContrastingColor(this.bgSelectedColor,"#ffffff","#000000");this.textHighlightedColor=(this.bgSelectedColor==="transparent")?mstrmojo.LinkList.dftTrptTxHltColor:mstrmojo.color.getContrastingColor(this.bgHighlightedColor,"#ffffff","#000000");this.textNormalColor=this.color;if(this._super){this._super();}}},mstrmojo.hash.copy(mstrmojo._RendersItemDivs));mstrmojo._RendersItemLinks.itemRenderer=mstrmojo.LinkItemRenderer;mstrmojo.requiresCls("mstrmojo.ListBox");mstrmojo.LinkList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersItemLinks],{scriptClass:"mstrmojo.LinkList",cssClass:"mstrmojo-LinkList",itemCssClass:"mstrmojo-LinkList-item",selectionPolicy:"toggle"});mstrmojo.LinkList.dftTrptBgHltColor="#FFFFFF";mstrmojo.LinkList.dftTrptTxSelColor="#FFFFFF";mstrmojo.LinkList.dftTrptTxHltColor="#000000";mstrmojo.requiresCls("mstrmojo.ListBoxHoriz");mstrmojo.LinkListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersItemLinks],{scriptClass:"mstrmojo.LinkListHoriz",cssClass:"mstrmojo-LinkListHoriz",itemCssClass:"mstrmojo-LinkListHoriz-item",selectionPolicy:"toggle"});})();(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.ListBoxHoriz");var A={render:function(F,B,G){var H=(G.htmlName+B),D=G.selectedIndices[B]?"checked ":"",E=D?" selected":"",C=F.v!=="u;"?" nAll":"";return'<div class="'+G.itemCssClass+E+C+'"><input type="'+G.inputType+'" name="'+G.htmlName+'" id="'+H+'" value="'+B+'" '+D+'/><label for="'+H+'" title="'+(F[G.itemTitleField]||"")+'" style="'+G.labelCssText+'">'+F[G.itemDisplayField||"n"]+"</label></div>";},select:function(D,E,B,F){var C=D&&D.firstChild;if(C&&!C.checked){C.checked=true;}mstrmojo.css.toggleClass(D,"selected",C.checked);},unselect:function(D,E,B,F){var C=D&&D.firstChild;if(C&&C.checked){C.checked=false;}mstrmojo.css.toggleClass(D,"selected",C.checked);},rowHeight:23};mstrmojo._RendersInputItems=mstrmojo.provide("mstrmojo._RendersInputItems",{inputType:null,htmlName:null,itemRenderer:A,init:function(B){this._super(B);if(!this.htmlName){this.htmlName=this.id;}},preclick:function(E){var D=E.hWin,G=E.e,F=mstrmojo.dom.eventTarget(D,G);if(F&&F.nodeName.match(/input/i)){var C=parseInt(F.value,10);if(this.inputType&&this.inputType.match(/radio/i)){this.singleSelect(C);}else{var B=(F.checked)?"add":"remove";this[B+"Select"](C);}}}});mstrmojo._InputList=mstrmojo.declare(mstrmojo.ListBox,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputList"});mstrmojo._InputListHoriz=mstrmojo.declare(mstrmojo.ListBoxHoriz,[mstrmojo._RendersInputItems],{scriptClass:"mstrmojo._InputListHoriz"});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ListSelectorItemRenderer=A.clone(mstrmojo.DivItemRenderer);mstrmojo.ListSelectorItemRenderer.render=function(D,B,E){var C=D.v!="u;"?" nAll":"";return'<div mstridx="'+B+'" class="'+E.itemCssClass+(E.selectedIndices[B]?" "+E.itemSelectedCssClass:"")+C+'" style="'+E.itemCssText+'">'+(E.getItemName?E.getItemName(D,B):(E.itemDisplayField&&D[E.itemDisplayField]))+"</div>";};mstrmojo.ListBoxSelector=mstrmojo.declare(mstrmojo.ListBox,null,{itemRenderer:mstrmojo.ListSelectorItemRenderer});})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.Container","mstrmojo.TabStrip");mstrmojo.ScrollingTabStrip=mstrmojo.declare(mstrmojo.TabStrip,null,{scriptClass:"mstrmojo.ScrollingTabStrip",markupString:'<div id="{@id}" class="mstrmojo-TabStrip mstrmojo-ScrollingTabStrip {@cssClass}" style="{@cssText}"><span></span><div class="c" style="position:relative; display:inline-block;"><div style="position:absolute;"></div></div><span></span></div>',markupSlots:{containerNode:function(){return this.domNode.childNodes[1].firstChild;},scrollNode:function(){return this.domNode.childNodes[1];},stripNode:function(){return this.domNode.childNodes[1].firstChild;},btnLeftNode:function(){return this.domNode.childNodes[0];},btnRightNode:function(){return this.domNode.childNodes[2];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(this.visible){this.set("width",parseInt(this.width,10));}},onleftChange:function(){if(this.stripNode&&this.left!=null){this.stripNode.style.left=this.left+"px";}},onwidthChange:function(C){var E=this.scrollNode,B=this.stripNode;if(E&&B){var D=this,A=parseInt(this.width,10);if(isNaN(A)){return ;}window.setTimeout(function(){if(A<B.clientWidth){D.createScrBtn();A-=(D.btnsWidth||0);}D.updateScrBtn();if(mstrmojo.dom.isIE7&&B.clientWidth>0){B.style.width=B.clientWidth+7+"px";}E.style.width=A+"px";},0);}}},step:50,scroll:function(B){B=B||1;var D=this.scrollNode,A=this.stripNode,E=Math.abs(parseInt(this.left,10)||0),C=Math.max(A.clientWidth-E-D.clientWidth,0),F=Math.min(this.step,(B==-1?C:E));this.set("right",C);this.set("left",-(E-B*F));this.updateScrBtn();},createScrBtn:function(){if(this.btnLeft&&this.btnRight){return ;}var A=this;this.addChildren([{scriptClass:"mstrmojo.Button",cssClass:"l",alias:"btnLeft",visible:false,enabled:false,scrollInterval:null,onmousedown:function(){var B=this;this.scrollInterval=window.setInterval(function(D,C){A.scroll(1);if(A.left>=0){clearInterval(B.scrollInterval);}},60);},onmouseup:function(){clearInterval(this.scrollInterval);},slot:"btnLeftNode"},{scriptClass:"mstrmojo.Button",cssClass:"r",alias:"btnRight",visible:false,enabled:false,onmousedown:function(){var B=this;this.scrollInterval=window.setInterval(function(D,C){A.scroll(-1);if(A.right<=0){clearInterval(B.scrollInterval);}},60);},onmouseup:function(){clearInterval(this.scrollInterval);},slot:"btnRightNode"}]);this.renderChildren();this.btnsWidth=50;},updateScrBtn:function(){var F=this.scrollNode,B=this.stripNode,D=this.btnLeft,E=this.btnRight;if(F&&B&&D&&E){var H=Math.abs(parseInt(this.left,10)||0),G=B.clientWidth;E.set("enabled",G-H>F.clientWidth);D.set("enabled",H>0);var A=parseInt(this.width,10),C=A<G;this.btnLeft.set("visible",C);this.btnRight.set("visible",C);if(!C){this.set("left",0);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo.Box","mstrmojo.array","mstrmojo._HasLayout","mstrmojo.ui.ColumnContainer");var E=mstrmojo.dom,G=mstrmojo.hash,C=mstrmojo.array;mstrmojo.ui.ColumnWalk=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.ColumnWalk",markupString:'<div id="{@id}" class="mstrmojo-ui-ColumnWalk cf {@cssClass}" mstrAttach:click></div>',layoutConfig:{h:{containerNode:"100%"},xt:true},currentColumn:-1,addNextColumn:function B(K){var J=this.children||[],L=J.length,I=J[L-1];var M=this.addChildren([G.copy(K,{scriptClass:"mstrmojo.ui.ColumnContainer",idx:L})])[0];if(I){I.set("next",M);}},onclick:function A(I){var K=I.getTarget();if(K){var J=this.children;C.forEach(J,function(M,L){if(E.contains(M.domNode,K,true,M.domNode)){this.set("currentColumn",L);}},this);}},oncurrentColumnChange:function D(I){var K=this.children,M=K[I.valueWas],J=K[this.currentColumn],L="active";if(M){M.set(L,false);}J.set(L,true);},removeTrailingContainer:function H(K){var J=this,I=this.children;if(!I||K>=I.length-1){return ;}C.forEach(I.slice(K+1),function(L){J.removeAndDestroyChild(L);});if(K>=0){I[K].set("next",null);}},insertAndRemoveTrailing:function F(J,I){this.removeTrailingContainer(J);this.addNextColumn(I);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList");mstrmojo._IsTableLayoutListDIC=mstrmojo.provide("mstrmojo._IsTableLayoutListDIC",{_mixinName:"mstrmojo._IsTableLayoutListDIC",icnCss:"dicContainer",tableLayoutCssStyle:"fixed",setDirtyFlag:function(D,C){if(D.className!=="flag-container"){var B=document.createElement("div"),A=this.itemsNode&&this.itemsNode.clientWidth-8;B.className="flag-container";B.style.left=(A>0?A:0)+"px";B.innerHTML='<div class="dirty-cell"/>';C.insertBefore(B,D);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.DocButton");var B=mstrmojo.dom;mstrmojo.express.ui.DocButton=mstrmojo.declare(mstrmojo.DocButton,null,{scriptClass:"mstrmojo.express.ui.DocButton",premousedown:function A(C){if(B.getButton(C.hWin,C.e)===1){var E=this.id,D="pressed";this.set(D,true);B.attachOneTimeEvent(document,"mouseup",function(){var F=mstrmojo.all[E];if(F){F.set(D,false);}},true);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.Container","mstrmojo.Box","mstrmojo.List","mstrmojo.SearchBox2","mstrmojo.WaitIcon","mstrmojo.IncFetch");var A=mstrmojo.array,B=mstrmojo.hash;mstrmojo.ElementsBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ElementsBrowser",cssClass:"mstrmojo-ElementBrowser",rootCached:null,attributeID:null,onOK:null,onUpdateBrowseElementsParams:mstrmojo.emptyFn,init:function(C){this._super(C);this.rootCached={};},postBuildRendering:function(){if(this._super){this._super();}var E=this.ebIncFetch,C=this.ebSearchBox,D=this.ebList;E.attachEventListener("fetch",C.id,function(F){E.cp=F.v;E.children=null;E.refresh();this.fetchPage(F.v-1);});C.attachEventListener("ifsChange",E.id,function(F){var G=this.np;B.copy(F.value,this);if(this.np>1){this.children=null;this.refresh();}if(G<=1&&this.np>1||G>1&&this.np<=1||G===0&&this.np>0){this.set("visible",this.np>1);}});C.attachEventListener("itemsChange",D.id,function(F){this.set("items",F.value||[]);});},initBrowser:function(){var C=this.ebSearchBox,D=this.attributeID;C.set("rootID",D);C.clear();C.searchPattern="";if(D&&!this.rootCached[D]){C.set("items",[]);C.blockBegin=1;C.fetch();this.rootCached[D]=true;}else{if(D){C._notifyContentWidget(C.searchCache[D][D]);this.ebList.updateSelections();}}},children:[{alias:"ebSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-ElementsBrowser-SearchBox",taskId:"browseElements",quickSearch:true,getRootID:function(){this.rootID=this.parent.attributeID;},onUpdateSearchParams:function(C){this.parent.onUpdateBrowseElementsParams(C);}},{alias:"ebList",scriptClass:"mstrmojo.List",cssClass:"mstrmojo-ELementsBrowser-List",itemIdField:"v",allowUnlistedValues:false,itemMarkup:'<div class="mstrmojo-bullet"><div class="mstrmojo-ebIcons ae"><div class="mstrmojo-text">{@n}</div></div></div>',updateSelections:function(){var C=this.parent,D=C.selectedItems;if(D){this.initializing=true;this.clearSelect(false);this.setSelectedItems(D,false);this.initializing=false;}},onitemsChange:function(){this.updateSelections();},onchange:function(N){if(this.initializing){return ;}var I=this.items,J=this.parent,D=J.selectedItems,G,M;for(var H=0,C=N.removed,L=C&&C.length;H<L;H++){G=I[C[H]];M=A.find(D,this.itemIdField,G[this.itemIdField]);if(M>-1){D.splice(M,1);}}for(var F=0,K=N.added,E=K&&K.length;F<E;F++){G=B.clone(I[K[F]]);D.push(G);}},multiSelect:true,selectionPolicy:"toggle"},{alias:"ebIncFetch",scriptClass:"mstrmojo.IncFetch",cssClass:"mstrmojo-ElementsBrowser-IncFetch",height:"20px",np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onvisibleChange:function(C){this.domNode.style.display=C.value?"block":"none";}}]});})();(function(){mstrmojo.requiresCls("mstrmojo.MobileDocLayoutViewer");var B=mstrmojo.DynamicClassFactory.newComponent;mstrmojo.maps.MobileMapInfoWindowLayoutViewer=mstrmojo.declare(mstrmojo.MobileDocLayoutViewer,null,{scriptClass:"mstrmojo.maps.MobileMapInfoWindowLayoutViewer",preBuildRendering:function A(){this.setDimensions(this.height,this.width);this.set("visible",true);return this._super?this._super():true;}});mstrmojo.maps.MapInfoWindowLayoutViewer=mstrmojo.declare(mstrmojo.MobileDocLayoutViewer,null,{scriptClass:"mstrmojo.maps.MapInfoWindowLayoutViewer",preBuildRendering:function A(){this.set("visible",true);return this._super?this._super():true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.TimePicker","mstrmojo._IsInputControl");var A=2,B=mstrmojo.date;mstrmojo.TimePickerDIC=mstrmojo.declare(mstrmojo.TimePicker,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TimePickerDIC",popupStyle:2,init:function(C){if(this._super){this._super(C);}this.set("interval",this.dic.itv);this.set("active",A);},getCurValue:function(){if(this.dic.dt==mstrmojo.expr.DTP.TIMESTAMP){var F=B.parseDateAndOrTime(this.value),G=F&&F.time,D=F&&F.date,C,E;if(G&&!D){C=B.parseDateAndOrTime(this.lv),D=C&&C.date;if(!D){E=new Date();D={day:E.getDate(),month:E.getMonth()+1,year:E.getFullYear()};}return B.formatDateInfo(D,mstrmojo.locales.datetime.DATEOUTPUTFORMAT)+" "+B.formatTimeInfo(G,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}}return this.value;},handleDisable:function(){return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ToolBar","mstrmojo.boxmodel","mstrmojo.array","mstrmojo.EnumRWUnitType","mstrmojo.dom","mstrmojo.css");var Q=["background-color","border","border-color","border-left","border-style","border-top","border-width","filter","top","left","z-index","fx","normWidth","normHeight","normZIndex","normTop","normLeft","tbborder","lrborder","ttl"],X=["width","height"],o="p_fmts";var l="px";var j={getContentHeight:function(r,u){var t=u.ttl&&u.ttl.height;if(r&&t&&!this.floatingToolbar){return Math.max(parseInt(r,10)-parseInt(t,10),0)+l;}return"";},getPortletMinHeight:function(r){return r.ttl.height;},adjustTitleCss:function(){return ;}};var f={getContentHeight:function(r){return r;},getPortletMinHeight:function(){return 0;},adjustTitleCss:function(r){r.titlebarNodeClass+=" floating";return ;}};function A(v,t){var u=this.parent,r=v+"DirtyKey";if(u[r]){u[r](t);}}function P(){this.toolbarTitleTextNode.innerHTML=this.title+(this.count?" ("+this.count+")":"");}function h(){var t=this.parent,v=t&&t.defn;if(v&&parseInt(v.t,10)===mstrmojo.EnumRWUnitType.PANEL){var r=t.parent,u=r.defn;if(u&&u.ifp){return r;}}return null;}var R=mstrmojo.hash,G=2;mstrmojo.DocPortlet=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable],{scriptClass:"mstrmojo.DocPortlet",floatingTitle:false,floatingTitleHeight:30,n:"",buttonWidth:17,markupString:'<div class="mstrmojo-portlet {@borderCss}" nm="{@n}" style="{@portletNodeCssText}"><div class="mstrmojo-portlet-slot-shadow" style="{@shadowNodeCssText}"></div><div class="mstrmojo-portlet-container" style="{@portletContainerNodeCssText}"><div class="mstrmojo-portlet-titlebar {@titlebarNodeClass}" style="{@titlebarNodeCssText}"><table style="height:100%;width:100%" class="mstrmojo-portlet-titlebar-table" cellspacing="0" cellpadding="0"><tr><td class="mstrmojo-portlet-slot-toolbar-left {@leftToolbarNodeClass}" style="{@leftToolbarNodeCssText}"></td><td class="mstrmojo-portlet-title" style="{@titleNodeCssText}"><div style="overflow: hidden;"></div></td><td class="mstrmojo-portlet-slot-toolbar {@toolbarNodeClass}" style="{@rightToolbarNodeCssText}"></td></tr></table></div><div class="mstrmojo-portlet-buttonbar {@buttonbarNodeClass}" style="{@buttonbarNodeCssText}"></div><div class="mstrmojo-portlet-slot-content" style="{@contentNodeCssText}"></div></div></div>',rightToolbarNodeCssText:"",leftToolbarNodeCssText:"",titleNodeCssText:"",titlebarNodeClass:"",titlebarNodeCssText:"",contentNodeCssText:"",borderCss:"no-border",buttonbarNodeClass:"",buttonbarNodeCssText:"",markupSlots:{containerNode:function(){return this.domNode.lastChild;},portletNode:function(){return this.domNode;},portletContainerNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},shadowNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.lastChild.childNodes[0];},buttonbarNode:function(){return this.domNode.lastChild.childNodes[1];},toolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[2];},toolbarTitleTextNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[1].firstChild;},leftToolbarNode:function(){return this.domNode.lastChild.firstChild.childNodes[0].rows[0].cells[0];},contentNode:function(){return this.domNode.lastChild.lastChild;}},markupMethods:{ontitleChange:function(){P.call(this);},oncountChange:function(){P.call(this);},onfcChange:function(){if(this.fc&&this.content){this.updateContentHeight();}}},formatHandlers:{portletContainerNode:["RW","B","fx","background-color"],shadowNode:["RW","B","fx","background-color"],buttonbarNode:{src:"ttl",props:["background-color"]},titlebarNode:{src:"ttl",props:["F","B","background-color","height","fx","text-align","vertical-align"]},titleNode:{src:"ttl",props:["vertical-align","P","text-decoration"]}},updateServer:true,fc:false,content:null,rightToolbar:null,leftToolbar:null,floatingToolbar:false,_ts:j,getCacheKey:function F(){return this._super()+"-portlet";},getFormats:function M(){var t=this.content,r=t&&t.getFormats();return r&&r[o];},updateContentHeight:function d(w){var r=this.getFormats(),t=this.content,v=t.dimNode||t.domNode,u=((r.ttl&&parseInt(r.ttl.height,10))||0);if(v){if(!w){u+=((this.fc||this.isInFilterPanel())?v.offsetHeight:(r.height?parseInt(r.height,10):0));}this.containerNode.style.height=u+l;this.shadowNode.style.height=u+l;}},init:function p(r){this._super(r);var t=this.content;this.n=(r&&r.defn&&r.defn.n)||"";if(t&&t.getFormats()&&!this.getFormats()){this._createFormats();}},preBuildRendering:function B(){var t=this._ts=(this.floatingTitle)?f:j;if(this.isInFilterPanel()){var u=R.clone(this.formatHandlers);u.portletContainerNode=["z-index","height","B","backgroud-color"];u.shadowNode=["z-index","height","B","fx","background-color"];this.formatHandlers=u;}this._super();t.adjustTitleCss(this);var r="display:none;";if(!this.leftToolbar){this.leftToolbarNodeCssText+=r;}if(!this.toolbar){this.toolbarNodeCssText+=r;}var v=mstrmojo._Formattable.getBorderWidths(this);if(v.l||v.t||v.r){this.borderCss="has-border";}},postBuildRendering:function Y(){var v=mstrmojo.dom,AD=this.titleNode,AC=this.onclicktitle;if(this.floatingTitle&&this.titleNode){document.body.appendChild(this.titleNode);var w=mstrmojo.css,z=this.contentNode,AA=this;if(!this._onhover){this._onhovertt=function(){w.addClass(AA.titleNode,["visible"]);AA._onflt=true;return true;};this._onhoverofftt=function(){w.removeClass(AA.titleNode,["visible"]);AA._onflt=false;return true;};this._onhover=function(){var AE=AA.titleNode;w.addClass(AE,["visible"]);var AF=v.position(AA.contentNode,true);AE.style.top=(AF.y-AE.clientHeight+2)+l;AE.style.left=AF.x+l;return true;};this._onhoveroff=function(){w.removeClass(AA.titleNode,["visible"]);return true;};}v.attachEvent(z,"mouseover",this._onhover);v.attachEvent(z,"mouseout",this._onhoveroff);v.attachEvent(AD,"mouseover",this._onhovertt);v.attachEvent(AD,"mouseout",this._onhoverofftt);}if(AD&&AC){v.attachEvent(AD,"click",AC);}if(this._super){this._super();}var x=this.getFormats();this.set("fc",x&&!x.height);if(this.isInFilterPanel()&&!this.isHorizFP()){var r=this.portletContainerNode.style,u=this.shadowNode.style,AB=this.parent;r.width=u.width="99%";r.top=u.top=AB.topStart+l;r.left=u.left=G+l;}else{if(this.isInFilterPanel()&&this.isHorizFP()){G=8;this.portletContainerNode.style.left=this.shadowNode.style.left=parseInt(x.left,10)+G*this.orgPos+l;}else{if(this.defn.ifp){this.adjustFPHeight2Fit();}}}if(this.buttonbarNode.clientHeight>0){this.buttonbarNode.style.height=this.buttonbarNode.clientHeight*this.model.getZoomFactor()+"px";}},adjustFPHeight2Fit:function(){var u=mstrmojo.dom,r=u.position(this.titleNode),t=u.position(this.contentNode).y-r.y-r.h;this.content.domNode.style.height=parseInt(this.defn.fmts.height,10)-t+"px";},unrender:function E(u){if(this.floatingTitle&&this.titleNode){var w=this.domNode,r=this.titleNode,v=mstrmojo.dom;if(w&&this._onhover){v.detachEvent(w,"mouseover",this._onhover);}if(w&&this._onhoveroff){v.detachEvent(w,"mouseout",this._onhoveroff);}if(r&&this._onhovertt){v.detachEvent(r,"mouseover",this._onhovertt);}if(r&&this._onhoverofftt){v.detachEvent(r,"mouseout",this._onhoverofftt);}if(r){document.body.removeChild(r);}}if(this._super){this._super(u);}},updateStyle:function(t,r){var v=this.shadowNode.style,u=this.containerNode.style;v.height=u.height=t;v.width=u.width=r;},_createFormats:function V(){var x=this.content&&this.content.getFormats(),v;v=x.p_fmts={};var r,w;for(r in Q){w=Q[r];if(x[w]!==undefined){v[w]=x[w];delete x[w];}}for(r in X){w=X[r];if(x[w]!==undefined){v[w]=x[w];}}x.height=this._ts.getContentHeight(x.height,v);if(mstrmojo.dom.isIE&&v.fx&&v.fx.ds&&!v["background-color"]){v["background-color"]="#ffffff";}var u=v.ttl,t=u&&u["background-color"];if(t){this.titlebarNodeClass=mstrmojo.color.getContrastingColor(t,"light","dark");}},refresh:function q(){if(!this.hasRendered){return ;}var t=this.children,r;for(r=t.length-1;r>=0;r--){t[r].refresh();}},isInFilterPanel:function L(){return(h.call(this)!==null);},isHorizFP:function(){if(this.isInFilterPanel()){var r=this.getFilterPanel();return r&&r.defn&&parseInt(r.defn.fds,10)===2;}return false;},getFilterPanel:function H(){return h.call(this);},getContainerHeight:function c(){return this.containerNode.clientHeight;},relocate:function C(r){if(this.isInFilterPanel()&&!this.isHorizFP()){this.portletContainerNode.style.top=this.shadowNode.style.top=r+l;}},setInfoWindowDimensions:function n(w){var t=this.domNode.style,r=this.shadowNode.style,u=this.portletContainerNode.style,v=mstrmojo._Formattable.getBorderWidths(this);w.h-=v.h;w.w-=v.w;r.height=u.height=t.height=w.h+l;r.width=u.width=t.width=w.w+l;w.h-=this.titleNode.offsetHeight;this.toolbarNode.style.display="none";},addDirtyKey:function K(r){A.call(this,"add",r);},removeDirtyKey:function J(r){A.call(this,"remove",r);},setDirtyChildren:function Z(){var r=this.content;if(r&&r.setDirtyChildren){r.setDirtyChildren.apply(r,arguments);}}});var W=0,O=1,k=2;function N(r){var t=this.content.defn;if(t){t.set("ds",r);}}function m(r){return{FormattingOrder:{ZIndex:this.getFormats()["z-index"]},FormattingView:{WindowState:r}};}function a(AF,AD,r,AG){var AC=this.content,AE=AC.k,AB=mstrmojo.boxmodel.px2Inches,u=AC.model.docModel||AC.model,AI=u.getZoomProps(),x=this.getFormats(),t=AD!==undefined&&r!==undefined,AH={},z=this,AA=m.call(this,AF);if(t){AA.FormattingSize={OldHeight:AB(AI,AD),OldWidth:AB(AI,r),Height:AB(AI,parseInt(x.height,10)),Width:AB(AI,parseInt(x.width,10))};}AH.success=function(v){var w=v&&v.data;if(w){u.loadPartialData(w,AE);}N.call(z,AF);var AJ=z.parent;if(AJ.adjustSectionSize&&t){AJ.adjustSectionSize();}};u.updateUnitFormat(AC,1,AA,AH,{params:{suppressData:true},config:t?null:{silent:true},preserveUndo:true});if(!t&&!(AG&&AG.all)){u.saveRWProps(AE,props,1,this.loadDataOnResize,AH,true);}}function T(){var z=this.content;if(!z){return ;}var w=function(AD){mstrmojo.array.forEach(AD,function(AE){if(AE.ds!==undefined){AE.set("visible",(AE.ds!==z.defn.ds));}});},AA;if(this.isInFilterPanel()){var u=(parseInt(this.defn.ds,10)===W);z.set("visible",u);this.updateContentHeight(!u);AA=this.leftToolbar;w(AA&&AA.children);var v=this.parent;if(v.refreshFP){v.refreshFP();}}else{var r=z.getFormats(),AB=this.getFormats(),t=this.portletContainerNode.style,AC=this.shadowNode.style,x=this.contentNode.firstChild.style;x.height=r.height;x.width=r.width;AC.height=t.height=AB.height;AC.width=t.width=AB.width;AC.top=t.top=AB.top;AC.left=t.left=AB.left;if(AB["z-index"]!==undefined){AC.zIndex=t.zIndex=AB["z-index"];}AA=this.rightToolbar;w(AA&&AA.children);if(z.resize){z.resize();}}}mstrmojo.DocResizablePortlet=mstrmojo.declare(mstrmojo.DocPortlet,null,{scriptClass:"mstrmojo.DocResizablePortlet",loadDataOnResize:false,_createFormats:function V(){this._super();var t=this.getFormats();var r=parseInt(this.defn.ds,10);if(r===W){t.normHeight=t.height;t.normWidth=t.width;if(t["z-index"]!==null&&t["z-index"]!==undefined){t.normZIndex=t["z-index"];}}if(r!==k){t.normTop=t.top;t.normLeft=t.left;}},onmaximize:function e(){var v=this.parent,z=this.content,x=z&&z.getFormats(),u=this.getFormats(),t=u.height,r=u.width,w=mstrmojo._Formattable.getBorderWidths(this);this.clearCache();z.clearCache();u.height=(parseInt(v.getHeight(),10)-w.h)+l;x.height=this._ts.getContentHeight(u.height,u);u.width=x.width=(v.getWidth()-w.w)+l;u.top=u.left=0;u["z-index"]=v.getMaxZIndex()+1;a.call(this,k,t,r);},onminimize:function b(){var x=this.content,t=x.dimNode||x.domNode,w=x&&x.getFormats(),v=this.getFormats(),u=v.height||t.offsetHeight,r=v.width;this.clearCache();x.clearCache();v.width=w.width=v.normWidth;v.top=v.normTop;v.left=v.normLeft;if(v.normZIndex!==null&&v.normZIndex!==undefined){v["z-index"]=v.normZIndex;}w.height=0;v.height=this._ts.getPortletMinHeight(v);a.call(this,O,u,r);},onrestore:function S(){var w=this.content,v=w&&w.getFormats(),u=this.getFormats(),t=u.height,r=u.width;this.clearCache();w.clearCache();u.height=u.normHeight;v.height=this._ts.getContentHeight(u.height,u);u.width=v.width=u.normWidth;u.top=u.normTop;u.left=u.normLeft;if(u.normZIndex!==null&&u.normZIndex!==undefined){u["z-index"]=u.normZIndex;}a.call(this,W,t,r);},changeWindowState:function I(u){N.call(this,u);var t=this.content,v=m.call(t,u),r=t.model.docModel||t.model;return r.getUnitFormatAction(t,1,v);},oncollapse:function U(r){a.call(this,O,undefined,undefined,r);},onexpand:function D(r){a.call(this,W,undefined,undefined,r);},adjustFP:function g(){var t=(parseInt(this.defn.ds,10)===W);this.content.set("visible",t);this.updateContentHeight(!t);var r=this.parent;if(r.refreshFP){r.refreshFP();}},postBuildRendering:function Y(){if(!this._sub_dsChange){this._sub_dsChange=this.defn.attachEventListener("dsChange",this.id,T);}this._super();if(this.isInFilterPanel()){var r=(parseInt(this.defn.ds,10)===W);this.updateContentHeight(!r);}}});mstrmojo.DocPortlet.ST_RESTORE=W;mstrmojo.DocPortlet.ST_MAX=k;mstrmojo.DocPortlet.ST_MIN=O;}());(function(){mstrmojo.requiresCls("mstrmojo.SliderBox","mstrmojo._IsInputControl","mstrmojo.Box","mstrmojo.hash");var C=mstrmojo.css,B=mstrmojo.dom,D=mstrmojo.hash,A=1;mstrmojo.SliderDIC=mstrmojo.declare(mstrmojo.SliderBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.SliderDIC",popupStyle:1,tabIndex:0,markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}" tabindex="{@tabIndex}" ><div class="valuePart" style="{@valueCssText}"><span class="valueLabel">{@valueLabel}</span><span class="valueText">{@valueText}</span></div><table class="sliderPart" style="{@sliderCssText}"><tbody><tr><td class="minText">{@min}</td><td class="sliderWrapper"></td><td class="maxText">{@max}</td></tr></tbody></table><div class="curtain"></div></div>',markupSlots:D.copy({sliderPartNode:function(){return this.domNode.children[1];},minTextNode:function(){return this.domNode.children[1].rows[0].cells[0];},maxTextNode:function(){return this.domNode.children[1].rows[0].cells[2];},sliderNode:function(){return this.domNode.children[1].rows[0].cells[1];},disableCurtainNode:function(){return this.domNode.lastChild;}},D.copy(mstrmojo.SliderBox.prototype.markupSlots)),init:function(E){if(this._super){this._super(E);}this.cssClass=this.showByDefault?"mstrmojo-SliderGroup":"mstrmojo-PopupSlider";this.items=this.getItems();if(this.dic.ipt!==A){this.isSequential=true;this.max=this.dic.max;this.min=this.dic.min;this.interval=this.dic.itv;}},focus:function(){if(mstrmojo.dom.isIE){var E=this;setTimeout(function(){E.domNode.focus();},10);}else{this.domNode.focus();}},preBuildRendering:function(){this._super();var H=this.dic,E=(H.ldw!=null)?H.ldw/100:0.4,F,G=this.openerStyle;if(this.showByDefault){F=G.iw*(1-E)-G.rp-3;this.alignSlider(this.openerNode,G.ih);}else{F=H.w;}this.sliderBar.set("width",F);this.valueText=this.showByDefault?this.dv:this.value;if(!this.showByDefault&&this.unset&&this.isSequential){this.valueText+=" "+mstrmojo.desc(8316,"(out of range)");}},handleDisable:function(){return !!this.showByDefault;},postBuildRendering:function(){if(this._super){this._super();}if(this.showByDefault){var J=this.dic,G=this.value,E=(J.ldw!=null)?J.ldw:40,I=this.openerStyle,F=I.ih;this.domNode.style.width=I.iw+"px";this.domNode.style.height=I.ih+"px";this.valuePartNode.style.width=this.sliderPartNode.style.left=E+"%";if(this.isSequential){this.sliderBar.set("title",mstrmojo.desc(5441,"Minimum value")+": "+this.min+"   "+mstrmojo.desc(5442,"Maximum value")+": "+this.max);}}if(this.handleDisable()){C.toggleClass(this.disableCurtainNode,"disabled",!!this.enabled);if(!this.enabled){var H={height:this.sliderPartNode.clientHeight+"px",width:(this.sliderPartNode.clientWidth+this.valuePartNode.clientWidth)+"px"};D.copy(H,this.disableCurtainNode.style);}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.fx","mstrmojo.Dialog","mstrmojo.Label","mstrmojo._IsPopup","mstrmojo._HasPopup","mstrmojo._IsMovable","mstrmojo.ui._HasUITheme","mstrmojo.Button","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.tooltip","mstrmojo.ui.editors.ErrorDialogContent");var h=mstrmojo.func.composite,M=mstrmojo.dom,Z=mstrmojo.Button.newWebButton,C=mstrmojo.css,Y=mstrmojo.all,N=mstrmojo.hash,W=mstrmojo.array;function V(o){if(!this.modal){return ;}var p=window.mstrApp;if(p&&p.modalEditorChange){p.modalEditorChange(this.id,o);}}mstrmojo.Editor=mstrmojo.declare(mstrmojo.Dialog,[mstrmojo._IsPopup,mstrmojo._HasPopup,mstrmojo._IsMovable,mstrmojo.ui._HasUITheme],{scriptClass:"mstrmojo.Editor",title:"",help:"",autoClose:false,showTitle:true,openEffect:null,themeClassName:"mojo-theme-light",useRichTooltip:true,closeEffect:null,markupString:'<div id="{@id}" class="mstrmojo-Editor-wrapper"><div class="mstrmojo-Editor {@cssClass}" style="z-index:{@zIndex};{@cssText}" mstrAttach:mouseup,mousedown,click,contextmenu>{@titlebarHTML}<div class="mstrmojo-Editor-content"></div><div class="mstrmojo-Editor-buttons"></div></div><div class="mstrmojo-Editor-curtain"></div></div>',titleMarkupString:'<div class="mstrmojo-Editor-title-container"><div class="mstrmojo-Editor-title"></div><div class="edt-title-btn mstrmojo-Editor-help" tooltip="'+mstrmojo.desc(1143,"help")+'"></div><div class="edt-title-btn mstrmojo-Editor-close" tooltip="'+mstrmojo.desc(2102,"Close")+'"></div></div><div class="mstrmojo-Editor-titleSpacer"></div>',markupSlots:{editorNode:function X(){return this.domNode.firstChild;},titlebarNode:function k(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},titleNode:function R(){return this.showTitle?this.domNode.firstChild.firstChild.firstChild:null;},helpNode:function l(){return this.showTitle?this.domNode.firstChild.firstChild.children[1]:null;},closeNode:function E(){return this.showTitle?this.domNode.firstChild.firstChild.lastChild:null;},containerNode:function S(){return this.domNode.firstChild.childNodes[2];},buttonNode:function I(){return this.domNode.firstChild.childNodes[3];},curtainNode:function m(){return this.domNode.lastChild;}},markupMethods:{ontitleChange:function(){if(this.showTitle){this.titleNode.innerHTML=this.title;}},onzIndexChange:function(){var o=this.zIndex;this.editorNode.style.zIndex=o;this.curtainNode.style.zIndex=o-1;},onvisibleChange:function(r){if(r){return ;}var q=this.visible,p="closeEffect",o="none";if(q){p="openEffect";o="block";}if(this[p]){this.playEffect(p);}else{this.editorNode.style.display=o;if(this.modal){this.curtainNode.style.display=o;}}},onhelpChange:function d(){if(this.showTitle){var p=this.help,o=this.helpNode;if(!p){o.style.display="none";}else{o.style.display="block";}}},onleftChange:function F(){this.editorNode.style.left=this.left||"";},ontopChange:function H(){this.editorNode.style.top=this.top||"";}},open:function Q(p,o){this._super(p,o);V.call(this,true);},close:function f(o){this._super(o);V.call(this,false);},unrender:function B(o){this._super(o);V.call(this,false);},destroy:function g(o){this._super(o);V.call(this,false);},preBuildRendering:function A(){if(!this.slot&&!this.placeholder){this.placeholder=document.body.appendChild(document.createElement("div"));this._curtain_to_body=true;V.call(this,true);}this.titlebarHTML=(this.showTitle)?this.titleMarkupString:"<div></div><div></div>";return this._super();},getMovingHandle:function j(){return this.titlebarNode;},getMovingTarget:function U(){return this.editorNode;},onPreClose:function G(){this.hideTooltip();return true;},premousedown:function P(o){var p=o.getTarget();if(p===this.closeNode||p===this.helpNode){C.toggleClass(p,"active",true);}},premouseup:function O(o){var p=o.getTarget();if(p===this.closeNode||p===this.helpNode){C.toggleClass(p,"active",false);}if(o.getTarget()===this.closeNode&&this.onPreClose()){this.close();}},onclick:function c(p){if(p.getTarget()===this.helpNode){if(mstrApp.showHelpTopic){mstrApp.showHelpTopic(this.help);}else{var o=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm#");window.open(o+(this.help||""),"_blank");return false;}}},_set_visible:function b(u,q){var p=(this[u]!==q);if(p){this[u]=q;var t=this._close_handler;if(q){if(this._curtain_to_body){this.resizeDialog();this.positionDialog();}if(this.autoClose){var r=this;t=this._close_handler=t||function(v){var w=M.eventTarget(self,v);if(w&&w.parentNode&&!M.contains(r.editorNode,w,true,document.body)){r.close();}};M.attachEvent(document.body,"mousedown",t);}}else{var o=this._curtain_handler;if(o){M.detachEvent(window,"resize",o);}if(t){M.detachEvent(document.body,"mousedown",t);}}}return p;},showTooltip:function n(v,u){var r=this,p=M.findAncestorByAttr(M.eventTarget(u,v),"tooltip",true,this.domNode),q=p&&p.value;if(!r.hasOpenTooltip&&q){var o=M.position(p.node);r.richTooltip={cssClass:"vi-regular A-center vi-tooltip-A",content:q,top:Math.max(o.y+40,0),left:Math.max(o.x+4,0),posType:mstrmojo.tooltip.POS_TOPCENTER};this._super(v,u);}}});mstrmojo.Editor.openEffect_fadeIn={scriptClass:"mstrmojo.fx.AnimateProp",slot:"curtainNode",props:{backgroundColor:{start:255,stop:0,fn:function(o){o=Math.round(o);return["rgb(",o,",",o,",",o,")"].join("");}}},preStart:function(){var p=this.target,o=this.widget;o.editorNode.style.display="block";if(!o.modal){return false;}p.style.display="block";C.setOpacity(p,60);return true;}};mstrmojo.Editor.closeEffect_fadeOut={scriptClass:"mstrmojo.fx.FadeOut",slot:"curtainNode",start:0.6,stop:0,preStart:function(){var o=this.widget;o.editorNode.style.display="none";return !!o.modal;}};function D(o){return function(){Y[o].destroy();};}function J(p,x,z,AA){var o=x.id||"mojoAlertx9",u,w=x.buttons;W.forEach(w,function(AC){var AB=AC.onclick;AC.onclick=function(AD){var AE=Y[o];if(AB&&AB.call(AC,AD)===false){return ;}AE.destroy();AE=null;};});try{Y[o].destroy();}catch(v){}var q=x.cssClass,r=[];if(q){r.push(q);delete x.cssClass;}if(AA){r.push(AA);}r.push("mstrmojo-alert");u={scriptClass:"mstrmojo.Editor",id:o,width:"475px",zIndex:1000,title:z||mstrmojo.desc(11812,"Notification"),cssClass:r.join(" "),children:[{scriptClass:"mstrmojo.Label",cssClass:"alert-content",text:p,allowHTML:x.allowHTML}],visible:true};var t=new mstrmojo.Editor(N.copy(x,u));t.render();return t;}if(window.mstrConfig&&!window.mstrConfig.simpleDialog){mstrmojo.notify=function L(p,w,q){q=q||{};var x=q.forceClose,v=q.callback||mstrmojo.emptyFn,u=N.copy(w||{},{buttons:x?[mstrmojo.Button.newActionButton((q.buttonText||mstrmojo.desc(8607,"Dismiss")),v)]:null,showTitle:false,modal:false,top:"42px"}),r=q.duration||6000;var t=J(p,u,"",x?"ed-notify":"ed-toast"),o=t.id;if(!x){window.setTimeout(h([v,D(o)]),r);}else{window.setTimeout(function(){if(Y[o]){Y[o].editorNode.style.opacity=0.75;}},6000);}return t;};mstrmojo.confirm=function e(u,p,t){p=p||{};var o=p.confirmBtn||{},r=p.cancelBtn||{},q=[Z(o.t||mstrmojo.desc(219,"Yes"),o.fn,true),Z(r.t||mstrmojo.desc(218,"No"),r.fn)];return J(u,N.copy(t||{},{buttons:q,onPreClose:function(){if(r&&r.fn){r.fn();}return true;}}));};mstrmojo.warn=function K(q,o,p){p=p||{};p.cssClass=(p.cssClass||"")+" mstrmojo-warning";mstrmojo.confirm(q,o,p);};mstrmojo.alert=function a(u,q,t,v,o,r){var p={title:t,zIndex:v,cssClass:o,buttons:[Z(mstrmojo.desc(1442,"OK"),q,true)],onPreClose:function(){if(q){q();}return true;}};N.forEach(p,function(x,w){if(!x){delete p[w];}});return J(u,N.copy(r,p));};mstrmojo.error=function T(t,o,r){var p=t||{};var q=mstrmojo.desc(96,"Error");if(r){q=(r.title)?r.title:mstrmojo.desc(96,"Error");}J("",N.copy(r||{},{buttons:[Z(mstrmojo.desc(1442,"OK"),o,true)],children:[{scriptClass:"mstrmojo.ui.editors.ErrorDialogContent",shortDesc:p.shortDesc,longDesc:p.longDesc}]}),q);};}mstrmojo.Editor.ButtonConfigType=null;}());(function(){var BUILDER_METHOD={BUTTON:"newButton",PICKERBUTTON:"newPickerButton",LIST:"newList",SEPARATOR:"newSeparator",TEXT:"newCustom"};function cmdMethodName(cmdid){return(cmdid==="export")?cmdid+"Cmd":cmdid;}function bindEnabled(enabledFeatures){var arr=enabledFeatures.split(","),txt=[],i,len;for(i=0,len=arr.length;i<len;i++){var s=arr[i],neg=s.match(/^\!/);if(neg){s=s.replace("!","");}txt.push((neg?"!":"")+"this.target.model.features['"+s+"']");}return txt.join(" && ");}function bindItems(cmdid){return"var t = this.target.view, c = this.cmdid; if (t && c) {return this.target.view."+cmdid+"Options;}";}function bindSelectedItem(cmdid){return"var x = this.items; var t = this.target.view, c = this.cmdid; if (t && c){return this.target.view."+cmdid+"Value;}";}function openLink(json){var link=json.link,h=link&&link.href,t=link&&link.target,xtraUrl=json["extra-url"];if(!link||!h){return ;}if(xtraUrl){h+="&"+xtraUrl;}if(link["use-window-open"]){t="_blank";}window.open(h,t?t:"_self");}mstrmojo.ToolBarBuilder={scriptClass:"mstrmojo.ToolBarBuilder",build:function build(nodes,model,config){var arr=[],i,len;for(i=0,len=(nodes&&nodes.length)||0;i<len;i++){var json=nodes[i],n=BUILDER_METHOD[(json&&json.type)||"SEPARATOR"],w=this[n]&&this[n](json,config);if(w){arr.push(w);}}return arr;},newButton:function nwBtn(json,config){if(json["on-click"]||json.link){return this.newCustom(json,config);}var c=cmdMethodName(json.cmdid);return new mstrmojo.Button({title:json.tooltip,iconClass:json.id,cssClass:"mstrmojo-InteractiveButton",target:config&&config.target,cmdid:c,onclick:function(e){var t=this.target,ci=this.cmdid;t[ci](e);},bindings:json.enabledFeatures?{enabled:bindEnabled(json.enabledFeatures)}:null});},newPickerButton:function nwPkrBtn(json,config){var c=cmdMethodName(json.cmdid);var bs;if(!json.items){bs={};bs.items=bindItems(c);}if(json.enabledFeatures){bs=bs||{};bs.enabled=bindEnabled(json.enabledFeatures);}function oc(){var t=this.target,ci=this.cmdid,its=this.items,idx=this.selectedIndex;t[ci](its[idx].dssid);}return new mstrmojo.PickerButton({title:json.title||"",iconClass:json.id,items:json.items,itemDisplayField:"n",itemIdField:"dssid",autoHide:true,size:1,selectedIndex:parseInt(json.selectedIndicesList,10)||0,target:config&&config.target,cmdid:c,onchange:oc,bindings:bs});},newList:function nwLst(json,config){var c=cmdMethodName(json.cmdid),bs={selectedItem:bindSelectedItem(c)};if(!json.items){bs.items=bindItems(c);}if(json.enabledFeatures){bs.enabledFeatures=bindEnabled(json.enabledFeatures);}return new mstrmojo.SelectBox({id:json.cmdid,size:1,tooltip:json.title||"",iconClass:json.id,cmdid:c,target:config&&config.target,itemDisplayField:"n",itemIdField:"dssid",autoHide:true,onchange:function(){var t=this.target,ci=this.cmdid,itm=this.selectedItem;t[ci](itm&&itm.dssid);},items:json.items,bindings:bs});},newSeparator:function nwSep(json,config){return new mstrmojo.ToolSeparator(json);},newCustom:function newCstm(json,config){var b=new mstrmojo.Button({markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass}" title="{@title}" style="{@cssText}" mstrAttach:click,mousedown,mouseup><div id="{@iconClass}" class="mstrmojo-Button-text"></div></div>',title:json.tooltip,cssClass:"mstrmojo-InteractiveButton",onclick:function(){if(json.link){openLink(json);}if(json["on-click"]){eval(json["on-click"]);}},bindings:json.enabledFeatures?{enabled:bindEnabled(json.enabledFeatures)}:null}),v=json.value;b.text=v||"";b.cssText=v?"width:auto;margin-top:4px;":"";b.title=json.tooltip||"";b.iconClass=json.id||"";return b;}};}());(function(){mstrmojo.requiresCls("mstrmojo.TextArea","mstrmojo.Button","mstrmojo.Label","mstrmojo.Box","mstrmojo.fx","mstrmojo.css","mstrmojo.DropDownButton");var D=1,K=2,B=null,A=null,E=mstrmojo.dom,F=mstrmojo.css;var C=400;function G(U,Q,M,N,T,L,P,S){var R={duration:C,target:Q,onEnd:function(){if(L){L();}},props:{}};R.props[M]={ease:P||mstrmojo.ease.sin,start:parseInt(N,10),stop:parseInt(T,10),suffix:"px"};R=mstrmojo.hash.copy(S,R);var O=new mstrmojo.fx.AnimateProp(R);O.play();return O;}mstrmojo.ElasticTextArea=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.ElasticTextArea",markupString:'<div id="{@id}" class="mstrmojo-ElasticTextArea {@cssClass}" style="{@cssText}" mstrAttach:blur ><div class="mstrmojo-ElasticTextAreaContent " style="height: 100%;"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvalueChange:function(){if(this.textNode&&this.value!==this.textNode.textArea.value){this.textNode.textArea.set("value",this.value);this.adjustStatusBar();}},onvisibleChange:function(){this.domNode.style.display=this.visible?"inline":"none";},onwidthChange:function(){if(this.domNode&&this.width){this.domNode.style.width=this.width+"px";}},ontopChange:function(){if(this.domNode&&this.top){this.domNode.style.top=this.top+"px";}},onleftChange:function(){if(this.domNode&&this.left){this.domNode.style.left=this.left+"px";}}},width:200,resize:"none",maxLength:256,value:"",enabled:true,minTextNodeHeight:15,postCreate:function(){var M=this,L=this.minTextNodeHeight;this.children=[{scriptClass:"mstrmojo.Box",alias:"textNode",cssText:"width:100%;",height:L+"px",onheightChange:function(O){var P=Math.max(L,parseInt(O.valueWas,10)||0),N=Math.max(L,parseInt(O.value,10));if(P!==N){if(E.isIE7){this.textArea.domNode.style.height=this.domNode.style.height=N+"px";}else{if(this._slidingFx&&this._slidingFx.isPlaying){this._slidingFx.props.height.stop=N;}else{this._slidingFx=G(true,this.domNode,"height",P,N);}}}},children:[{scriptClass:"mstrmojo.TextArea",alias:"textArea",cssClass:"eta-text",cssText:"width:100%;height:100%;line-height:inherit;box-sizing:content-box;",rows:1,bindings:{maxLength:"this.parent.parent.maxLength",enabled:"!!this.parent.parent.enabled"},onblur:function(N){if(M.onblur){M.onblur(N);}},onkeyup:function(P){var Q=this.maxLength,N=this.value.length;if(Q<N){if(E.isIE7||E.isIE8||E.isIE9){this.value=this.domNode.value=this.value.substr(0,Math.min(N,Q));}}var O=this.parent.parent;O.set("value",this.value);O.adjustStatusBar();}},{scriptClass:"mstrmojo.Label",cssClass:"eta-text ghost",alias:"ghost",cssText:"visibility: hidden; z-index:-1; position:absolute;left:0; top:0; text-align:"+(E.isIE?"left":"start")+"; word-wrap:break-word; border:1px solid red; none; margin:0; padding:2; width:100%;",bindings:{text:"this.parent.parent.value"},_setHeight:function(O){var N=Math.max(parseInt(O,10)||0,this.domNode.clientHeight);this.parent.set("height",N);},postCreate:function(){this.markupMethods=mstrmojo.hash.copy(this.markupMethods);this.markupMethods.ontextChange=function(N){if(this.domNode&&this.text){this.domNode.innerHTML=this.text.replace(/<br \/>&nbsp;/,"<br />").replace(/<|>/g," ").replace(/&/g,"&amp;").replace(/\n/g,"<br />&nbsp;");}else{if(this.domNode){this.domNode.innerHTML="&nbsp;";}}this._setHeight();};},postBuildRendering:function(N){if(this._super){this._super(N);}this._setHeight(this.parent.parent.height);}}]},{scriptClass:"mstrmojo.Label",alias:"statusBar",cssClass:"eta-bar",text:""},{scriptClass:"mstrmojo.Label",alias:"msgBoxTip",cssClass:"eta-tip",cssText:E.isIE8?"bottom: -4px;":""}];},postBuildRendering:function I(){if(this._super){this._super();}this.textNode.textArea.set("value",this.value);this.adjustStatusBar();},onmaxLengthChange:function(L){if(L.value){this.adjustStatusBar();}},onfontChange:function(L){var O=this.textNode.textArea,N=this.textNode.ghost,M;for(M in this.font){this.domNode.style[M]=this.font[M];if(E.isIE7){O.domNode.style[M]=this.font[M];N.domNode.style[M]=this.font[M];this.statusBar.domNode.style[M]=this.font[M];}}if(E.isIE9){O.refresh();}N._setHeight();},adjustStatusBar:function(){if(!this.msgBoxTip.domNode){return ;}var O=this,R=this.maxLength,S=this.textNode.textArea,Q=(S.value&&S.value.length)||0,P=Q/R,M=this.statusBar,L=this.msgBoxTip;var N=P*this.width;L.domNode.style.left=Math.min(Math.ceil(N-L.domNode.offsetWidth/2),this.width-3)+"px";M.set("text",mstrmojo.desc(4891,Q+" of "+R).replace("##",Q).replace("###",R));},focus:function(){E.setCaret(this.textNode.textArea.domNode,((this.value&&this.value.length)||0));}});mstrmojo.ElasticTextAreaButton=mstrmojo.declare(mstrmojo.DropDownButton,null,{scriptClass:"mstrmojo.ElasticTextAreaButton",cssClass:"mstrmojo-ElasticTextAreaButton",popupToBody:false,popupWidth:200,maxLength:256,enabled:true,lockAutoClose:mstrmojo.emptyFn,unlockAutoClose:mstrmojo.emptyFn,unrender:function H(L){var M=this.popupRef;if(this.popupToBody&&M.hasRendered){M.unrender(false);}if(this._super){this._super(L);}},postBuildRendering:function I(){if(this._super){this._super();}if(this.value&&this.value.length>0){F.addClass(this.domNode,"filled");}},premousedown:function J(M){if(this.popupToBody){var P=E.position(this.popupNode,true),O=this.popupRef,L={left:Math.round(P.x)+"px",top:Math.round(P.y)+"px"};if(!O.hasRendered){delete O.slot;L.placeholder=document.body.appendChild(document.createElement("div"));}this.popupOpenConfig=this.popupOpenConfig||{};mstrmojo.hash.copy(L,this.popupOpenConfig);}else{this.popupRef.slot="popupNode";}if(this.popupRef.eta){this.popupRef.eta.set("value",this.value);}else{this.popupRef.children[0].value=this.value;}if(this._super){this._super();}var N=this.popupRef.domNode;if(N){N.style.minWidth=(this.domNode.offsetWidth-2)+"px";}},openPopup:function(M,L){this._super(M,L);this.lockAutoClose();},popupRef:{scriptClass:"mstrmojo.Popup",slot:"popupNode",cssClass:"mstrmojo-ElasticTextAreaPopup",shadowNodeCssClass:"mstrmojo-ElasticTextAreaPopup-shadow",contentNodeCssClass:"mstrmojo-ElasticTextAreaPopup-content",autoCloses:false,locksHover:true,visible:true,onOpen:function(){var M=this.eta,N=M.domNode.firstChild,O=0,L;this.eta.set("font",this.opener.font);N.parentNode.style.display="block";F.addClass(this.opener.domNode,"editing");N.parentNode.style.overflow="hidden";L=this._h||(N.offsetHeight);G(false,N,"height",O,L,function(){N.style.height="100%";N.parentNode.style.overflow="visible";M.focus();});},onClose:function(){this.visible=false;var N=this.eta.domNode,M=N.firstChild,O=M.offsetHeight,L=0;this.opener.unlockAutoClose();this._h=O;this.opener.set("value",this.eta.value);F.removeClass(this.opener.domNode,"editing");M.style.height=M.offsetHeight+"px";N.style.overflow="hidden";G(false,M,"height",O,L,function(){N.style.display="none";});},children:[{scriptClass:"mstrmojo.ElasticTextArea",alias:"eta",bindings:{width:function(){return this.parent.opener.popupWidth;},maxLength:function(){return this.parent.opener.maxLength;},enabled:function(){return this.parent.opener.enabled;}}}]}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocLayout");function F(P){var N=-1,O=P.children,M,L,K,I,J=[],H=function(){var R;for(R in J){var Q=J[R];if(Q._fixedHeight!==N){Q._fixedHeight=N;if(Q.domNode){Q.domNode.style.height=N+"px";}}}N=-1;J=[];};for(L in O){M=O[L];if(M&&M.node&&M.node.data&&M.node.data.bh&&N>-1){H();}if(M&&M.defn&&M.defn.horiz){for(K in M.children){I=M.children[K];N=Math.max(I._fixedHeight||0,N);J[J.length]=I;}}}H();}mstrmojo.DocLayoutHoriz=mstrmojo.declare(mstrmojo.DocLayout,null,{scriptClass:"mstrmojo.DocLayoutHoriz",markupString:'<div id="{@id}"><div class="mstrmojo-DocLayout {@cssClass}" style="{@domNodeCssText}"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},getWidth:function A(){return this.containerNode.offsetWidth;},getHeight:function G(){return this.containerNode.offsetHeight;},_renderSection:function C(L,I){if(L.node.data.bh||(L.defn.horiz&&!this._horizOpen)){this._horizOpen=true;var M=document.createElement("div");M.className="mstrmojo-DocLayout-HBox";var J=document.createElement("table");J.className="mstrmojo-DocLayout-HBox-HorizContainerTable";this._hRow=J.insertRow(-1);M.appendChild(J);this.containerNode.appendChild(M);}if(L.defn.horiz){var H="hi"+I;L.slot=H;var N=this._hRow.insertCell(-1);N.vAlign="top";var K={};K[H]=N;this.addSlots(K);}else{if(this._horizOpen){this._horizOpen=false;}}this._super(L,I);},getLayoutMinWidth:function B(){var I=0,Q=0,J=this.children,P=J.length,N,M;for(N=0;N<P;N++){var O=J[N],L=O&&O.node,H=L&&L.data,K=H&&(String(H.bh)==="true"||String(H.bv)==="true");if(K){I=Math.max(I,Q);Q=0;}if(O.children){for(M in O.children){Q+=O.children[M].getWidth();}}else{Q+=10;break;}}return Math.max(I,Q);},resizeOrReposition:function E(){if(this._super){this._super();}F(this);},renderCtrlsInViewport:function D(){this._super();F(this);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TabContainer");mstrmojo.TabListContainer=mstrmojo.declare(mstrmojo.TabContainer,null,{scriptClass:"mstrmojo.TabListContainer",markupString:'<table id="{@id}" class="mstrmojo-tabcontainer {@cssClass}"><tr><td class="mstrmojo-tabcontainer-tabs {@listCssClass}"></td><td class="mstrmojo-tabcontainer-stack {@containerCssClass}"></td><td class="{@bottomCssClass}"></td></tr></table>',markupSlots:{top:function(){return this.domNode.firstChild.childNodes[0].childNodes[0];},stack:function(){return this.domNode.firstChild.childNodes[0].childNodes[1];},containerNode:function(){return this.domNode.firstChild.childNodes[0].childNodes[1];},bottom:function(){return this.domNode.firstChild.childNodes[0].childNodes[2];}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Arr","mstrmojo.Button","mstrmojo.HBox","mstrmojo.FishEye");var A=function(B){return mstrmojo.hash.copy(B,{scriptClass:"mstrmojo.Button",text:"",enabled:false,dir:"left",cssClass:"mstrmojo-icon left",onclick:function(){var D=this.parent.fishEyeList,C=D&&D.scroll(this.dir,D.step);}});};mstrmojo.FishEyeContainer=mstrmojo.declare(mstrmojo.HBox,null,{scriptClass:"mstrmojo.FishEyeContainer",cssClass:"mstrmojo-FishEyeContainer",selectedIndex:-1,setItems:function(B){this.fishEyeList.set("items",B);},setSelectedIndex:function(B){this.fishEyeList.set("selectedIndex",B);},scrollable:false,rightScrollbale:false,children:[A({bindings:{enabled:"!!this.parent.scrollable"}}),({scriptClass:"mstrmojo.FishEye",alias:"fishEyeList",items:mstrmojo.Arr.makeObservable([]),srcId:"obList"}),A({alias:"feScrollRight",cssClass:"mstrmojo-icon right",dir:"right",bindings:{enabled:"!!this.parent.rightScrollable"}})]});mstrmojo.css=mstrmojo.hash.copy({getStyleValue:function(D,E){var B=null;if(D.currentStyle){E=(E==="float"?"styleFloat":E);B=D.currentStyle[E];}if(document.defaultView&&document.defaultView.getComputedStyle){E=(E==="float"?"cssFloat":E);var C=document.defaultView.getComputedStyle(D,null);B=C?C[E]:null;}return B;},setStyleValue:function(D,F,E){var B=function(G){return !!(G&&(typeof G==="object")&&(typeof G.length==="number"));};if(B(F)&&B(E)){var C;for(C in F){D.style[F[C]]=E[C];}}else{D.style[F]=E;}}},mstrmojo.css);}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo._IsDial");mstrmojo.WidgetDial=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._IsDial],{scriptClass:"mstrmojo.WidgetDial"});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.ContextMenuItem","mstrmojo.WidgetList","mstrmojo.ListMapperTable");var H=false,B=20;function G(J,K){var L=J.itemsContainerNode;L.scrollTop=Math.min(Math.max(L.scrollTop+K,0),L.scrollHeight-L.offsetHeight);}function I(K,J){if(!K._scrollInter){var L=B*(J?-1:1);K._scrollInter=window.setInterval(function(){G(K,L);},50);}}function E(J){if(J._scrollInter){window.clearInterval(J._scrollInter);J._scrollInter=null;}}mstrmojo.ContextMenu=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.ContextMenu",zIndex:100,visible:true,makeObservable:true,markupString:'<div id={@id} class="mstrmojo-ContextMenu {@cssClass}" style="z-index: {@zIndex};{@cssText}"><div class="mstrmojo-CM-scrollup" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], true)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], true)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], true)" ></div><div class="mstrmojo-CM-itemsContainer">{@itemsHtml}</div><div class="mstrmojo-CM-scrolldown" onmousedown="mstrmojo.all.{@id}.onmousedownarrow(self, arguments[0], false)" onmouseup="mstrmojo.all.{@id}.onmouseuparrow(self, arguments[0], false)"onclick="mstrmojo.all.{@id}.onclickarrow(self, arguments[0], false)" ></div></div>',markupSlots:{scrollupNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.childNodes[1];},scrolldownNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){var K=this.domNode,P=this.itemsContainerNode,N=this.scrollupNode,M=this.scrolldownNode;K.style.display=this.visible?"block":"none";if(this.visible){N.style.display="none";M.style.display="none";P.style.overflow="auto";P.style.height="auto";var J=mstrmojo.dom.windowDim().h,O=K.offsetHeight,L=K.offsetWidth;if(J<O){N.style.display="block";N.style.minWidth=L+"px";M.style.display="block";M.style.minWidth=L+"px";P.style.overflow="hidden";P.style.height=(J-42)+"px";}}},onleftChange:function(){this.domNode.style.left=(this.left!=null)?this.left:"";},ontopChange:function(){this.domNode.style.top=(this.top!=null)?this.top:"";}},listMapper:mstrmojo.WidgetListMapperTable,itemFunction:function C(N,J,L){if(!H){mstrmojo.requiresCls("mstrmojo.ContextMenuItem");H=true;}var K={data:N,parent:L,hasSubmenu:L._cmSource.hasSubmenu(N),dynamicUpdate:L.dynamicUpdate,_cmSource:L._cmSource,zIndex:L.zIndex,itemIdField:L.itemIdField,itemField:L.itemField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction},M=new mstrmojo.ContextMenuItem(K);return M;},onmousedownarrow:function A(L,K,J){I(this,J);},onclickarrow:function F(L,K,J){G(this,B*(J?-1:1));},onmouseuparrow:function D(L,K,J){E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.dom","mstrmojo.TreeNodeSelector");var B=mstrmojo.dom,A={0:"closed",1:"opened",2:"leaf"};mstrmojo.TreeNode=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.TreeNode",markupString:'<li id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseover><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><ul class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</ul></li>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},textNode:function(){return this.domNode.firstChild.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild;}},markupMethods:{ontextChange:function(){this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);},onstateChange:function(){this.stateNode.className="mstrmojo-TreeNode-state "+(A[this.state]||"closed");this.itemsContainerNode.style.display=(this.state===1)?"block":"none";},onselectedChange:function(){var D=this.selected?"addClass":"removeClass";mstrmojo.css[D](this.domNode.firstChild,["selected"]);},ondropCuePosChange:mstrmojo.WidgetList.prototype.markupMethods.ondropCuePosChange},renderOnScroll:false,listSelector:mstrmojo.TreeNodeSelector,premousedown:function C(D){var E=this._super(D),F=B.eventTarget(D.hWin,D.e);if(F===this.stateNode){if(this.state!==2){this.set("state",this.state===1?0:1);}}return E;},preclick:function(D){mstrmojo.dom.stopPropogation(D.hWin,D.e);},prechange:function(D){var E=this._super(D);if(E!==false){var F=this.tree;if(F&&F.onnodechange){F.onnodechange(D);}}return E;}});}());(function(){mstrmojo.requiresCls("mstrmojo.dnd","mstrmojo.ui._HasScroller");function Z(f){var h=document.createElement("div"),g=h.style,e=f.domNode;h.className="mstrmojo-DataGrid-avatar";g.height=e.clientHeight+"px";e.appendChild(h);f.avatar=h;return h;}function Q(e){var f=mstrmojo.dom.position(e.domNode,true);return f.x;}function O(e){return'<div class="mstrmojo-DataGrid-resizeHandle" unselectable="on" onselectstart="return false" rh="'+e+'"></div>';}function b(g){var f=g.getAttribute("rh"),e=f&&parseInt(f,10);return e;}function Y(f,j,e){var h=e.src,k=h&&h.data,g=k&&k.resizingIdx;if(!(g&&g>0)){return j&&j.apply(f,[e]);}}mstrmojo.RESIZE_NEXT_COLUMN_MODE={getRange:function G(h,g){var e=h.colSizeArray;var f=[-e[g-1]+h.minColWidth,(g==e.length-1)?e[g]-h.resizeHandleWidth-h.minColWidth:e[g]-h.minColWidth];return f;},updateSize:function F(h,g,f){var e=h.colSizeArray;e[g-1]=e[g-1]+f;e[g]=e[g]-f;},updateColumnWidth:function T(h,f,j,g){var e=h.colSizeArray;f[g-1].style.width=e[g-1]+"px";j[g-1].style.width=e[g-1]+"px";f[g].style.width=e[g]+"px";j[g].style.width=e[g]+"px";}};mstrmojo.RESIZE_ALL_COLUMN_MODE={getRange:function G(k,j){var l=k.minColWidth+k.resizeHandleWidth,e=k.colSizeArray,g=0;for(var h=j;h<e.length;++h){g+=e[h]-l;}var f=[-e[j-1]+l,g];return f;},updateSize:function F(h,m,f){var l=h.minColWidth+h.resizeHandleWidth,j=h.colSizeArray;j[m-1]=j[m-1]+f;var e=[];for(var g=0;g<j.length-m;++g){e[g]=m+g;}e.sort(function(o,p){return j[o]-j[p];});for(var g=0;g<e.length;++g){var n=f/(e.length-g);var k=j[e[g]];f-=(k>=n+l)?n:k-l;j[e[g]]=(k>=n+l)?k-n:l;}},updateColumnWidth:function T(j,f,k,h){var e=j.colSizeArray;for(var g=h-1;g<e.length;++g){f[g].style.width=e[g]+"px";k[g].style.width=e[g]+"px";}}};mstrmojo._CanResizeColumn=mstrmojo.provide("mstrmojo._CanResizeColumn",{draggable:true,dropZone:false,avatar:null,colSizeArray:null,resizableColumns:true,resizeHandleWidth:10,minColWidth:5,resizeColumnBehavior:mstrmojo.RESIZE_NEXT_COLUMN_MODE,createColSizeArray:function c(){var f,k,h,g,j,e;k=this.headerContainerNode;h=k&&k.getElementsByTagName("table")[0];g=h.rows[0].cells;f=[];for(j=0,e=g.length;j<e;j++){f.push(g[j].offsetWidth);}return f;},postBuildRendering:function V(){if(this._super){this._super();}if(this.avatar){this.domNode.appendChild(this.avatar);}this.colSizeArray=null;},getDragData:function E(e){var g=e.src,h=g.node,f=b(h);if(f&&f>0){return{resizingIdx:f,startingX:g.pos.x,baseX:Q(this)};}if(this._super){return this.dropZone&&this._super(e);}return null;},allowDrop:function K(e){var g=e.src,h=g&&g.data,f=h&&h.resizingIdx;if(f&&f>0){return true;}return this.dropZone;},ondragenter:function R(e){Y(this,this._super,e);},ondragover:function S(e){Y(this,this._super,e);},ondragleave:function B(e){Y(this,this._super,e);},ondrop:function W(e){Y(this,this._super,e);},isDragValid:function C(e){var g=e.src,h=g&&g.data,f=h&&h.resizingIdx;if(f&&f>0){return true;}if(this._super){return this._super(e);}return false;},ondragstart:function X(e){var h=e.src,j=h&&h.data,g=j&&j.resizingIdx;if(g&&g>0){var f=this.avatar||Z(this);this.ownAvatar=true;f.style.left=(j.startingX-j.baseX)+"px";f.style.display="block";document.body.style.cursor="col-resize";if(!this.colSizeArray){this.colSizeArray=this.createColSizeArray();this._firstTimeResize=true;}j.resizingRange=this.resizeColumnBehavior.getRange(this,g);return ;}if(this._super){this._super(e);}},ondragmove:function P(f){var n=f.src,g=n&&n.data,l=g&&g.resizingIdx;if(l&&l>0){var m=f.tgt,h=this.avatar,k=g.resizingRange,j=m.pos.x-g.startingX,e=Math.min(k[1],Math.max(j,k[0]));g.deltaX=e;if(h){h.style.left=(g.startingX-g.baseX+e)+"px";}}else{if(this._super){this._super(f);}}},ondragend:function L(j){var q=j.src,k=q&&q.data,o=k&&k.resizingIdx;if(o&&o>0){var e=this.titleColGroup,p=e&&e.childNodes,m=this.dataColGroup,n=m&&m.childNodes,h=p.length,l=this.colSizeArray,f=k.deltaX;this.resizeColumnBehavior.updateSize(this,o,f);if(this._firstTimeResize){var g;for(g=0;g<h;g++){p[g].style.width=l[g]+"px";n[g].style.width=l[g]+"px";}this._firstTimeResize=false;}else{this.resizeColumnBehavior.updateColumnWidth(this,p,n,o);}this.avatar.style.display="none";document.body.style.cursor="";this.ownAvatar=false;}else{if(this._super){this._super(j);}}}});mstrmojo.requiresCls("mstrmojo._CanResizeColumn","mstrmojo.ListMapperTable","mstrmojo.WidgetList");function J(g){var k=document.createElement("colgroup"),e=g.length,f,j;for(j=0;j<e;j++){var h=document.createElement("col");f=g[j];if(f.colWidth){h.style.width=f.colWidth+"px";}h.className=f.colCss||("col"+j);k.appendChild(h);}return k;}function I(f){var g=f._headerWidgets_,e=g&&g.length;if(e>0){var h;for(h=0;h<e;h++){g[h].destroy(true);}}}function A(j,e,h,l,f){var g=[],k=j.headerWidget;h=h?(" "+h):"";l=l||this._headerWidgets;f=f?(" "+f):' w="1"';g.push("<td"+h+">");if(e>0&&this.resizableColumns){g.push(O(e));}g.push('<div class="mstrmojo-DataGrid-headerText');g.push(j.headerCss?" "+j.headerCss:"");if(k){l.push(mstrmojo.hash.copy(k));g.push('"'+f+">");}else{g.push('">');}g.push(j.headerText||"&nbsp");g.push("</div>");g.push("</td>");return g.join("");}function a(e,m){var g,k,l,f,n,j,h=[];e=e||"_headerWidgets";m=m||"1";g=this[e];k=g.length;if(k>0){l=this.headerContainerNode.getElementsByTagName("div");f=mstrmojo.array.filter(l,function(o){return o.getAttribute("w")==m;});for(j=0;j<k;j++){g[j].placeholder=f[j].firstChild;g[j].dataGrid=this;n=mstrmojo.registry.ref(g[j]);n.render();h.push(n);}}this[e+"_"]=h;}mstrmojo.DataGrid=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._CanResizeColumn,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.DataGrid",banding:true,resizableColumns:true,columns:null,items:null,listMapper:mstrmojo.WidgetListMapperTable,lockHeader:false,contentWidth:"",renderHook:{},markupString:'<div id="{@id}" class="mstrmojo-DataGrid {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup><div class="mstrmojo-DataGrid-headerContainer">{@headerHtml}</div><div class="mstrmojo-DataGrid-itemsScrollBox" style="position:relative;"><div class="mstrmojo-DataGrid-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.lastChild;},itemsContainerNode:function(){return this.domNode.lastChild.firstChild;},dropCueNode:function(){return this.domNode.lastChild.lastChild;},headerContainerNode:function(){return this.domNode.firstChild;}},markupMethods:{oncontentWidthChange:function(){var f=this.contentWidth,g=this.headerContainerNode,e=this.itemsContainerNode;if(f&&g&&e){g.style.width=f;e.style.width=f;}},onlockHeaderChange:function(){mstrmojo.css.toggleClass(this.domNode,"lockHeader",this.lockHeader);},onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";}},setupScrollNodes:function M(){this.scrollNode=this.scrollboxNode;},itemFunction:function(g,e,f){var h=new mstrmojo.DataRow({columns:f.columns,data:g,idx:e,dataGrid:f,parent:f});return h;},preBuildRendering:function D(){var k=this.renderHook;if(k&&k.pre){k.pre.apply(this,[A]);}else{var f=this.columns,e=f.length,g=['<table class="mstrmojo-DataGrid-headerTable" cellspacing="0" cellpadding="0"><tr>'],j;this._headerWidgets=[];var h;for(h=0;h<e;h++){j=A.apply(this,[f[h],h]);g.push(j);}g.push("</tr></table>");this.headerHtml=g.join("");}if(this._super){this._super();}},postBuildRendering:function V(){if(this._super){this._super();}var g=this.renderHook;if(g&&g.post){g.post.apply(this,[J,a]);}else{a.apply(this);this.titleColGroup=J(this.columns);}var e=this.titleColGroup,m=e.cloneNode(true),j=this.headerContainerNode,l=j&&j.getElementsByTagName("table")[0],n=this.itemsContainerNode,k=this.scrollboxNode,h=this.domNode,f=n&&n.getElementsByTagName("table")[0];this.dataColGroup=m;if(l&&f){l.insertBefore(e,l.firstChild);f.insertBefore(m,f.firstChild);}if(this.lockHeader){k.style.height=h.offsetHeight-j.offsetHeight+"px";mstrmojo.dom.attachEvent(k,"scroll",function(o){j.style.left=-k.scrollLeft+"px";});}},refresh:function H(e){I(this);if(this._super){this._super(e);}},destroy:function d(e){I(this);this._super(e);},unrender:function U(j){var g=this._headerWidgets_,f=g&&g.length,e;if(f>0){var h;for(h=0;h<f;h++){e=g[h];if(e&&e.hasRendered){e.unrender(true);}}}this._super(j);}});mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Container");mstrmojo.DataRow=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.DataRow",cssClass:"mstrmojo-DataRow",columns:null,markupMethods:{onselectedChange:function(){mstrmojo.css.toggleClass(this.domNode,"selected",this.selected);}},buildDom:function(){this.children=[];var k=document.createElement("tr"),o=this.data,r=this.idx,f=this.dataGrid,l=this.cssClass,u=this.columns,e=this.children,g,p=-1,t,q;k.setAttribute("id",this.id);if(f.banding){l+=(r%2==1)?" odd":" even";}k.className=l+(mstrmojo.string.isEmpty(o[f.itemDisplayField||"n"])?" empty-row":"")+(" "+o[f.itemCSSField||"itemCss"]||"");var j,n;for(j=0,n=u.length;j<n;j++){t=u[j];q=(t.dataWidgetBuilder&&t.dataWidgetBuilder(o))||t.dataWidget;g=document.createElement("td");if(t.applyStyle2Cell&&t.colCss){g.setAttribute("class",t.colCss);}k.appendChild(g);if(q){g.setAttribute("w","1");p++;e.push(mstrmojo.hash.copy(q,{slot:"slot"+p,data:o,idx:r,dataGrid:f}));}else{if(t.dataFunction){g.innerHTML=t.dataFunction(o,r,f);}else{var h=mstrmojo.string.htmlAngles(o[t.dataField||"n"])||"&nbsp",m=t.tooltip?' title="'+h+'"':"";g.innerHTML='<div class="mstrmojo-DataRow-text" '+m+">"+h+"</div>";}}}this.initChildren();k.mstrmojoId=this.id;return k;},buildRendering:function N(){this._super();var j=this.domNode.childNodes,e=j.length,h={},g=0,k,f;for(f=0;f<e;f++){k=j[f];if(k.getAttribute("w")=="1"){h["slot"+g]=k;g++;}}this.addSlots(h);}});}());(function(){mstrmojo.requiresCls("mstrmojo.OBList","mstrmojo.ui._IsIncFetchList","mstrmojo.ui._HasScroller");var F=mstrmojo.array,A=mstrmojo.chart.model.enums.EnumDSSObjectType;function D(G){return{browseConfig:null,parent:G,next:function(J){var I=this.browseConfig;if(!I){return ;}I.blockBegin+=I.blockCount;var H={taskId:"searchMetadata",styleName:"MojoFolderStyle",blockBegin:I.blockBegin,blockCount:I.blockCount,includeAncestorInfo:true};if(I.folderLinksContextId){H.folderLinksContextId=I.folderLinksContextId;}if(I.includeObjectDesc){H.includeObjectDesc=I.includeObjectDesc;}if(I.rootFolderID){H.rootFolderID=I.rootFolderID;}else{if(I.rootFolderType){H.rootFolderType=I.rootFolderType;}}if(I.browsableTypes){H.objectType=I.browsableTypes;}if(I.searchPattern){H.searchPattern=I.searchPattern;if(I.recursive){H.recursive=I.recursive;}}this.parent.set("waiting",true);if(I.dataProvider){I.dataProvider.serverRequest(H,J);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,J,H);}},hasNext:function(){var H=this.browseConfig;return(H.blockBegin+H.blockCount-1)<H.totalSize;}};}mstrmojo.mstr.ui.IncFetchOBList=mstrmojo.declare(mstrmojo.OBList,[mstrmojo.ui._IsIncFetchList,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.mstr.ui.IncFetchOBList",cssClass:"mstrmojo-OBList mstrmojo-IF-OBList",makeObservable:true,renderOnScroll:false,waiting:false,markupString:'<div id="{@id}" class="mstrmojo-ListBase2 {@cssClass}" style="position:relative;{@cssText}" mstrAttach:keypress,mousedown,mouseup,dblclick><div class="scroll-box" style="{@scrollBoxCssText}"><div class="mstrmojo-ListBase2-itemsContainer" style="{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div></div>',markupSlots:{scrollboxNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild.firstChild;},dropCueNode:function(){return this.domNode.firstChild.lastChild;}},markupMethods:{onwaitingChange:function(){this.onwaitingChange();}},init:function E(G){if(this._super){this._super(G);}this.ifDataHelper=D(this);if(G.browseConfig){this.ifDataHelper.browseConfig=G.browseConfig;}},onwaitingChange:mstrmojo.emptyFn,addItems:function B(G){var H=this.browseConfig.browsableViewMedias;if(G&&H){var I={};F.forEach(H.split(","),function(J){I[parseInt(J,10)]=true;});G=F.filter(G,function(J){return(J.t!==A.DssTypeDocumentDefinition)||I[J.dvm];});}this.add(G,-1);this.set("waiting",false);if(this._super){this._super(G);}if(this.scrollNode){this.updateScrollbars();}},setupScrollNodes:function C(){this.scrollNode=this.scrollboxNode;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Pulldown");var C={ENTER:13,LEFT:37,UP:38,TAB:9,RIGHT:39,DOWN:40,ESC:27};function D(L,M){var G,J,F,H=[],I,N;try{I=new RegExp(L,"i");}catch(K){I=new RegExp(mstrmojo.string.regEscape(L));}for(G=0,J=M.length;G<J;G++){if(I.test(M[G][this.itemField])){H.push(M[G]);}}return H;}function B(F){return !(F<0||F===undefined||F===null);}mstrmojo.SearchablePulldown=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchablePulldown",popupCssClass:"mstrmojo-SearchablePulldown-Popup",searchEnabled:false,allowCustomInput:false,useItemCssOnInput:false,lastSearchPattern:"",isEditing:false,allItems:null,markupString:'<div id="{@id}" class="mstrmojo-SearchablePulldown mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-SearchablePulldown-boxNode mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}" mstrAttach:mousedown><input class="mstrmojo-SearchablePulldown-inputNode" value="{@text}" mstrAttach:keyup,blur/><div class="mstrmojo-SearchablePulldown-iconNode mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mouseover,mouseout></div></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:{boxNode:function(){return this.domNode.firstChild;},inputNode:function(){return this.domNode.firstChild.firstChild;},iconNode:function(){return this.domNode.firstChild.children[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:mstrmojo.hash.copy({ontextChange:function(){if(this.inputNode.value!==this.text){this.inputNode.value=this.text;}},onheightChange:function(){this.domNode.style.height=this.height||"";this.boxNode.style.height=this.height||"";},onsearchEnabledChange:function(){this.inputNode.readOnly=this.searchEnabled?false:true;this.items=this.allItems||this.items;},onallowCustomInputChange:function(){if(this.allowCustomInput){this.set("searchEnabled",true);}},onvalueChange:function E(){if(this.useItemCssOnInput&&this.selectedItem){this.inputNode.className="mstrmojo-SearchablePulldown-inputNode "+(this.selectedItem[this.itemCSS]||"");}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),prevalueChange:function(){this.synchronize();},synchronize:function(){var G=this.value,H=this.items||[],I=H[this.selectedIndex],F=-1;if(I&&G===I[this.itemIdField]){this.selectedItem=I;this.set("text",I[this.itemField]);return ;}F=mstrmojo.array.find(this.items,this.itemIdField,G);if(!B(F)&&this.allowCustomInput){this.selectedItem=undefined;this.selectedIndex=undefined;return ;}this.selectedIndex=B(F)?F:this.defaultSelection;this.selectedItem=I=this.items[this.selectedIndex];this.value=I?I[this.itemIdField]:undefined;this.set("text",I?I[this.itemField]:(this.defaultText||""));},preBuildRendering:function A(){if(this._super){this._super();}this.allItems=this.allItems||this.items;this.synchronize();},premousedown:function(F){if(this.searchEnabled&&F.getTarget()===this.iconNode){this.set("items",this.allItems);}this._super(F);},onkeyup:function(M){var J=mstrmojo.string.trim(this.inputNode.value),I=M.e,N=I.keyCode||I.which,L=B(this.selectedIndex)?this.selectedIndex:-1,F=this.allowCustomInput,H=this.items.length;this.isEditing=true;switch(N){case C.ENTER:if(H>0&&!F){this.set("selectedIndex",L===-1?0:L);this.synchronize();}this.closePopup();break;case C.ESC:this.closePopup();this.synchronize();break;case C.UP:if(this.popupRef.visible&&H>0){this.set("selectedIndex",(L+H-1)%H);this.synchronize();}break;case C.DOWN:if(!this.popupRef.visible&&H>0){this.togglePopup();}this.set("selectedIndex",(L+1)%H);this.synchronize();break;default:if(J===this.lastSearchPattern){return ;}var K=[];if(J&&J.length>0&&J.indexOf(this.lastSearchPattern)>-1){K=D.apply(this,[J,this.items]);}else{K=D.apply(this,[J,this.allItems]);}this.set("items",K);if(K.length===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}this.set("selectedIndex",undefined);if(J&&J.length){var G=mstrmojo.array.find(K,this.itemField,J);if(G!==-1){this.set("selectedIndex",G);}}}if(F&&!B(this.selectedIndex)){this.set("value",this.inputNode.value);}this.lastSearchPattern=J;},onblur:function(F){this.isEditing=false;if(!this.searchEnabled){return ;}if(!this.allowCustomInput){this.items=this.allItems;this.synchronize();}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo._HasPopup","mstrmojo.string","mstrmojo.Pulldown","mstrmojo.Container");var C=mstrmojo.css;mstrmojo.CustomGroupEl=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.CustomGroupEl",markupString:'<div id="{@id}" class="mstrmojo-onhoverparent mstrmojo-CustomGroupEl {@cssClass}" style="{@cssText}" mstrAttach:mouseover><div class="mstrmojo-CustomGroupEl-title {@cssClass}" mstrAttach:click><img class="mstrmojo-CustomGroupEl-state {@cssClass}" src="../images/1ptrans.gif" align="absmiddle" onclick="var w = mstrmojo.all[\'{@id}\']; w.set(\'state\', !w.state)" /><span class="mstrmojo-text"></span></div><div class="mstrmojo-onhover mstrmojo-abs mstrmojo-topright mstrmojo-CustomGroupEl-tools {@cssClass}"><img class="mstrmojo-dup" src="../images/1ptrans.gif" title="'+mstrmojo.desc(3397,"Duplicate")+'" onclick="mstrmojo.all[\'{@id}\'].dup()" /><img class="mstrmojo-ops" src="../images/1ptrans.gif"onclick="var w = mstrmojo.all[\'{@id}\'].showOps();" title="'+mstrmojo.desc(7932,"Element display options")+'" /><img class="mstrmojo-del" src="../images/1ptrans.gif" onclick="mstrmojo.all[\'{@id}\'].del()" title="'+mstrmojo.desc(7933,"Delete element")+'"/></div><div class="mstrmojo-CustomGroupEl-details {@cssClass}"><div class="mstrmojo-CustomGroupEl-expr {@cssClass}"></div><div class="mstrmojo-CustomGroupEl-expr-tools {@cssClass}"></div></div></div>',markupSlots:{stateNode:function(){return this.domNode.firstChild.firstChild;},titleNode:function(){return this.domNode.firstChild.lastChild;},detailsNode:function(){return this.domNode.lastChild;},exprNode:function(){return this.domNode.lastChild.firstChild;},exprToolsNode:function(){return this.domNode.lastChild.lastChild;},titlebarNode:function(){return this.domNode.firstChild;}},markupMethods:{ondataChange:function(){var G=this.data,F=G&&G.n;this.titleNode.innerHTML=(F!=null)?mstrmojo.string.encodeHtmlString(F):"";},onstateChange:function(){var F=this.stateNode;F.className="mstrmojo-CustomGroupEl-state "+(this.state?"opened":"closed");this.detailsNode.style.display=this.state?"block":"none";},onselectedChange:function(){C.toggleClass(this.domNode,["selected"],this.selected);},onshowaddChange:function(){this.exprToolsNode.style.display=this.showadd?"block":"none";}},_set_data:function A(H,F){var G=this.data;this.data=F;this.set("expr",F&&F.expr);return G!==F;},optionsRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(7934,"Element Options"),contentNodeCssClass:"mstrmojo-balloon",cssClass:"mstrmojo-CGEOptionsEditor",help:"element_options_dialog_box.htm",ce:false,isp:false,onOpen:function(){var F=this.opener.data,G=this.ops.dsplb.dspl;G.set("value",F.ce?2:(F.isp?1:0));},save:function(){var F=this.ops.dsplb.dspl.value,G=this.opener.data;G.ce=(F==2);G.isp=(F==1);this.close();},children:[{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-ElementOptions",alias:"ops",children:[{scriptClass:"mstrmojo.HBox",alias:"dsplb",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(168,"Display:"),cssText:"margin: 0 5px;"},{alias:"dspl",scriptClass:"mstrmojo.Pulldown",itemIdField:"v",items:[{n:mstrmojo.desc(7935,"Display element name only (Default)"),v:0},{n:mstrmojo.desc(7936,"Display individual items only"),v:1},{n:mstrmojo.desc(7937,"Display element name and individual items"),v:2}]}]},{scriptClass:"mstrmojo.HBox",alias:"btns",cssText:"float:right;width:150px;margin:5px;",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(118,"Save"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;",onclick:function(){this.parent.parent.parent.save();}},{scriptClass:"mstrmojo.HTMLButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;margin: 5px;",onclick:function(){this.parent.parent.parent.close();}}]}]}]},showOps:function(){var G=this.titlebarNode,F=mstrmojo.dom.position(G,true);this.openPopup("optionsRef",{zIndex:30,left:Math.round(F.x+F.w-300)+"px",top:Math.round(F.y+F.h)+"px"});},init:function E(F){this._super(F);var G=this.data;if(G){delete this.data;this._set_data(null,G);}},del:function B(){var F=this.parent;if(F&&F.remove){F.remove(this.data);}},dup:function D(){var F=this.parent;if(F&&F.duplicate){var K=this.data,L=F.items,N=K.did,M=1,O=new RegExp(K.n+"_(\\d+)");for(var I=0,J=L.length;I<J;I++){var H=L[I],G=H.n&&H.n.match(O);if(G){M=Math.max(M,G[1]);}N=Math.max(N,parseInt(H.did,10));}F.duplicate(this.data,null,{n:mstrmojo.desc(3651,"Copy of ##").replace("##",K.n),did:F.getNextId(),state:1});}},onmouseover:function(F){this.set("showadd",this.state?true:false);}});})();(function(){var F=mstrmojo.string;function H(Q,R,K){var L,O,J,M=[],N,S;try{N=new RegExp(mstrmojo.string.regEscape(Q),"i");}catch(P){return M;}for(L=0,O=R.length;L<O;L++){J=R[L][K];N.lastIndex=0;if(N.test(J)){M.push(R[L]);}}return M;}function C(){if(this.searchEnabled){this.iconNode.style.display="none";this.inputBar.style.display="";if(this.autofocus){this.inputNode.focus();this.inputNode.select();}}else{this.hideInputNode();if(this.autofocus){if(mstrmojo.dom.isIE7||mstrmojo.dom.isIE8){var J=this;window.setTimeout(function(){try{J.iconNode.focus();}catch(K){}},100);}else{this.iconNode.focus();}}}}var G={8:"BackSpace",9:"Tab",13:"Enter",27:"Esc",38:"ArrowUp",40:"ArrowDown"};mstrmojo.SearchableDropDownList=mstrmojo.declare(mstrmojo.Pulldown,null,{scriptClass:"mstrmojo.SearchableDropDownList",markupString:'<div id="{@id}" class="mstrmojo-SearchableDropDownList mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}"><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" tabindex="0" mstrAttach:mousedown,keyup>{@text}</div><table class="mstrmojo-InputNodeBar"><colgroup><col class="inputCol"/><col class="iconCol"/></colgroup><tr><td><input class="mstrmojo-SearchableDropDownList-inputNode" value="{@text}" placeholder="{@placeholderText}" mstrAttach:keyup,blur,click/></td><td><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mousedown></div></td></tr></table></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div></div>',markupSlots:mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupSlots,{inputBar:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.firstChild.lastChild.rows[0].cells[0].firstChild;}}),markupMethods:mstrmojo.hash.copy({ontextChange:function(){this.iconNode.innerHTML=F.decodeHtmlString(this.text);this.inputNode.value=this.text;},onheightChange:function(){var J=parseInt(this.height,10);if(J>=0){this.domNode.style.height=J+"px";this.inputBar.style.height=J+"px";}}},mstrmojo.hash.copy(mstrmojo.Pulldown.prototype.markupMethods)),popupToBody:true,searchEnabled:false,selectedIndex:-1,placeholderText:"",allItems:null,autofocus:true,focus:function(){C.call(this);},hideInputNode:function B(){this.inputBar.style.display="none";this.iconNode.style.display="block";},postBuildRendering:function A(){if(!this.allItems){this.allItems=this.items;}this._super();C.call(this);},clickInput2pop:false,onclick:function I(J){if(this.clickInput2pop){this.togglePopup();}},prekeyup:function E(R){var K=this.getSearchPattern(),P=[],M,Q=this.inputNode,O=R.e,J,L,N=this.items.length;if(G[O.keyCode]==="Enter"){if(this.items.length>0){this.set("selectedIndex",this.selectedIndex===-1?0:this.selectedIndex);}this.onEnter&&this.onEnter();this.closePopup();return ;}else{if(G[O.keyCode]==="Esc"){this.onEsc&&this.onEsc();if(this.popupRef.visible){this.popupRef.close();}return ;}else{if(G[O.keyCode]==="ArrowDown"){if(!this.popupRef.visible){this.togglePopup();}this.set("selectedIndex",(this.selectedIndex+1)%N);}else{if(G[O.keyCode]==="ArrowUp"){if(this.popupRef.visible&&N>0){this.set("selectedIndex",(this.selectedIndex+N-1)%N);}}else{if(this.searchEnabled){if(K&&K.length>0&&K.indexOf(this.lastSearchPattern)>-1){P=H(K,this.items,this.itemField);}else{P=H(K,this.allItems,this.itemField);}this.set("selectedIndex",-1);this.set("items",P);N=P.length;if(N===0){this.closePopup();}else{if(!this.popupRef.visible){this.togglePopup();}}if(K&&K.length>0){this.set("selectedIndex",mstrmojo.array.find(P,this.itemField,Q.value));}}}}}}this.lastSearchPattern=K;},getSearchPattern:function D(){return F.trim(this.inputNode.value);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.XtabZone","mstrmojo.css","mstrmojo.hash","mstrmojo.dom");var b=0,A=1,z=2,J=3,k={1:"_BL",2:"_TR",3:"_TL"},AH=1,u=2,n={position:"absolute",overflow:"hidden",width:"auto"},q={position:"absolute",top:0,left:0},E=mstrmojo.css,d=mstrmojo.hash,h=mstrmojo.dom;function L(AL,AK,AI,AJ){if(AJ){AL.replaceChild(AK,AL.tBodies[AI]);}else{AL.appendChild(AK);}}function I(AI){AI.offsetCellNode=null;AI.fstValueCellValidation=null;}function S(){var AM={x:0,y:0};if(this.lockHeadersCase&&!this.offsetCellNode&&!this.fstValueCellValidation){var AN=this.titlesCP.getSpanDimension(),AI=AN.nRow,AL=AN.nCol,AU=this.scrollboxNode.firstChild.firstChild,AR=AU&&AU.rows[AI];if(AI===0||AL===0){this.lockHeadersCase=b;return null;}if(!AU.rows.length){return null;}if(!AR){this.fstValueCellValidation|=AH;this.lockHeadersCase&=AH;AR=AU.rows[0];}var AT=AR&&AR.cells,AQ=(AT&&AT.length)||0,AK,AO,AP;for(AO=AP=0;AO<AQ&&AP<AL;AO++){AP+=AT[AO].colSpan||1;}AK=AT&&AT[AO];if(!AK){this.fstValueCellValidation|=u;this.lockHeadersCase&=u;this.offsetCellNode=AT&&AT[0];}else{this.offsetCellNode=AK;}}if(this.lockHeadersCase){var AS=h.position(this.offsetCellNode),AJ=h.position(this.scrollboxNode.firstChild);AM.x=AS.x-AJ.x;AM.y=AS.y-AJ.y;}return AM;}function O(AK,AI,AJ,AO){if(this.parent.isAutoTableLayout()&&this.isRendered()){if(!this.fragment){this.fragment=document.createDocumentFragment();}if(AO){var AL=AK.cloneNode(true);if(!this.renderedPages){p.call(this);}if(AJ&&this.renderedPages[AI]){var AN=this.renderedPages[AI],AM=this.getTableNode();if(AN.parentNode===AM){AM.replaceChild(AL,AN);}else{this.fragment.replaceChild(AL,AN);}}else{this.fragment.appendChild(AL);}this.renderedPages[AI]=AL;}}}function AC(AJ,AI){for(var AK in AJ){if(AJ[AK]!=AI[AK]){return false;}}return true;}function r(){var AI=this.fragment;if(AI&&AI.childNodes.length>0&&this.isRendered()){var AJ=this.getTableNode();AJ.appendChild(AI);}}function o(){var AJ=this.xtabClonedNodes,AN=this.cellHoverMgr,AL,AM,AI,AK;if(!AN){return ;}for(AI in AJ){AL=AJ[AI];AK=AL.getID();AM=AL.isRendered();if(!this.zones[AK]&&AM){this.zones[AK]={tableNode:AL.getTableNode()};if(typeof (AN)!="string"){AN.addMgrElement(AK);}}}}function N(AJ,AI){var AK=this.parent,AL=AK&&AK.zone;if(AI&&AL&&AL.addCoverTable){AL.addCoverTable(AJ,AI);}}function l(AJ,AI,AK){AJ.width=((AK&&AK.width<AI.right)?AK.width:AI.right)+"px";AJ.height=((AK&&AK.height<AI.bottom)?AK.height:AI.bottom)+"px";}function p(){this.renderedPages={};var AN=this.getTableNode(),AJ=AN.tBodies,AK=this.fragment,AP=AK&&AK.children,AM=this.renderedPages,AI,AL,AO=function(AQ){var AR=AQ.getAttribute("n")||0;AM[AR]=AQ;};for(AL=0,AI=AJ.length;AL<AI;++AL){AO(AJ[AL]);}for(AL=0,AI=(AP&&AP.length)||0;AL<AI;++AL){AO(AP[AL]);}}function K(AM,AI,AJ){var AK=AI&&AI.rows[AM.row],AL=AK&&AK.cells[AM.cell];if(AL&&AJ!==AL){AK.replaceChild(AJ.cloneNode(true),AL);}}function R(AJ,AI){if(this.isRendered()){if(!this.renderedPages){p.call(this);}K(AJ,this.renderedPages[AJ.page||0],AI);}}mstrmojo.XtabZoneWithClonedCover=mstrmojo.declare(mstrmojo.XtabZone,null,{scriptClass:"mstrmojo.XtabZoneWithClonedCover",isAutoTBLayout:null,addCoverTable:function M(AI,AJ){if(!this.coverTableNodes){this.coverTableNodes={};}this.coverTableNodes[k[AI]]=AJ;},getClonedNodesByPositions:function Q(AQ){var AP=this.coverTableNodes,AJ=AP&&AP[k[J]],AS=AP&&AP[k[z]],AM=AP&&AP[k[A]],AL=[AJ,AS,AM],AI,AT,AO=[],AK=function(AV,AX){var AU=AV&&AV.tBodies[AX.page||0],AW=AU&&AU.rows[AX.row];return AW&&AW.cells[AX.cell];};for(var AN in AQ){AI=AQ[AN];if(AI.page&&AM){AT=AK(AM,AI);AT&&AO.push(AT);}else{for(var AR in AL){if(AL[AR]){AT=AK(AL[AR],AI);AT&&AO.push(AT);}}}}return AO;},setHilites:function T(AS,AM){var AN=AM.getAttribute("ei"),AR=this.eiMap[AN]||(this.posMap[AN]&&[this.posMap[AN]])||[],AP=this.hiliteCellsMap,AL=this.parent,AJ=this.getNodesByPositions(AR),AI=function(AT){E.addClass(AT,"sc_"+AL.k);};if(!AP[AS]){AP[AS]={pos:[],nodes:[]};}if(!AJ.length){AI(AM);AP[AS].nodes.push(AM);}else{if(AR.length!==0){var AK=this.getClonedNodesByPositions(AR),AQ=AP[AS].pos;AJ=AK.concat(AJ);for(var AO in AJ){AI(AJ[AO]);}AP[AS].pos=AQ.concat(AR);}}},clearHilites:function C(AJ){var AM=this.hiliteCellsMap[AJ],AK=AM&&AM.nodes,AN=(AK&&AK.length===0&&AM.pos)||[],AL=this.parent;if(AN.length!==0){AK=this.getNodesByPositions(AN);AK=AK.concat(this.getClonedNodesByPositions(AN));}for(var AI in AK){E.removeClass(AK[AI],"sc_"+AL.k);}this.hiliteCellsMap[AJ]={nodes:[],pos:[]};},isAutoTableLayout:function AA(){if(this.isAutoTBLayout===null&&this.tableNode){this.isAutoTBLayout=(this.tableNode.style.tableLayout!=="fixed");}return this.isAutoTBLayout;},unrender:function B(AI){this.coverTableNodes={};this.isAutoTBLayout=null;this._super(AI);}});mstrmojo.XtabClonedNode=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.XtabClonedNode",domNode:null,left:0,top:0,lockType:b,scrollDM:mstrmojo.emptyFn,refreshNode:mstrmojo.emptyFn,createDomNode:function a(){var AI=this._getClonedFragment();this.containerNode.appendChild(AI);N.call(this,this.lockType,this.getTableNode());},getID:function U(){return this.id;},getTableSize:function Y(){var AJ=this.parent.zone.tableNode,AI=this.parent.hasCustomScrollbar?"offset":"client";return{width:AJ[AI+"Width"],height:AJ[AI+"Height"]};},isRendered:function H(){return !!this.domNode;},getTableNode:function AF(){return this.isRendered()?this.domNode.firstChild.firstChild:null;},destroy:function v(AI){if(this.isRendered()){this.unrender(true);}this._super(AI);},unrender:function B(AI){this.domNode=null;this.lastClipRect=null;this._super&&this._super(AI);},insertPage:function AG(AK,AI,AJ,AL){if(this.isRendered()){L(this.getTableNode(),AK.cloneNode(true),AI,AJ);}},_getClipStr:function Z(AI){this.lastClipRect=AI;return"rect("+AI.top+"px, "+AI.right+"px, "+AI.bottom+"px, "+AI.left+"px)";},adjustClip:function c(AK){var AI=this._getClipRect&&this._getClipRect(AK);if(this.isRendered()){if(this.getTableNode().offsetHeight>this.domNode.offsetHeight){this.domNode.style.height=this.getTableNode().offsetHeight+"px";}if(AI&&!(this.lastClipRect&&AC(AI,this.lastClipRect))){this.domNode.style.clip=this._getClipStr(AI);var AJ={};l(AJ,AI,this.getTableSize());d.copy(AJ,this.curtainNode.style);}}this.offset=AK;}});mstrmojo.XtabClonedRowHeader=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedRowHeader",lockType:A,interactiveCellsArray:[],interactivePosArray:[],dicGroupKey:[],init:function AD(AI){this._super(AI);if((this.lockHeadersCase&A)&&this.left){this.createDomNode();}},_getClipRect:function D(AJ){var AI=this.parent.hasCustomScrollbar?"offset":"client";AJ=AJ||this.offset;return{top:0,right:AJ.x||0,bottom:this.toCloneNode[AI+"Height"],left:0};},_clearLocalData:function G(){this.interactiveCellsArray=[];this.interactivePosArray=[];this.dicGroupKey=[];},_getClonedFragment:function X(){var AI=document.createDocumentFragment(),AM=this.toCloneNode.cloneNode(true),AL=document.createElement("div"),AK=d.clone(n),AN=d.clone(q),AJ=this._getClipRect();AK.clip=this._getClipStr(AJ);AK.zIndex=2;if(this.parent.zone&&this.parent.zone.autoFitWindow){AK.width="100%";}AM.id=this.getID();d.copy(AK,AM.style);d.copy({top:-this.top+"px"},AM.firstChild.style);this.domNode=AM;l(AN,AJ,this.getTableSize());AN.zIndex=1;d.copy(AN,AL.style);this.curtainNode=AL;AI.appendChild(AM);AI.appendChild(AL);return AI;},scrollDM:function f(AJ,AO,AQ){var AK=this.parent.shouldClipLockableXtab,AL;if(this.lockHeadersCase&A){if(this.left!==AJ&&!this.isRendered()){this.top=AO;this.createDomNode();this.domNode.style.width="100%";this.domNode.style.height="100%";var AN=this;setTimeout(function(){AN._updateDICGroup();},10);}else{if(this.isRendered()){var AP=this.domNode.firstChild,AI=AP.style;AI.top=-AO+"px";this.top=AO;if(AK){if(AI.position!=="absolute"){AI.position="absolute";AI.width="100%";}if(this.lockHeadersCase&z){AL={top:this.offset.y+AO,right:this.offset.x,bottom:AP.offsetHeight,left:0};AI.clip=this._getClipStr(AL);}}}}if(AK&&this.isRendered()){var AS=this.getTableNode();AL={top:0,right:Math.max(AS.offsetWidth,AQ.offsetWidth),bottom:Math.max(AS.offsetHeight,AQ.offsetHeight),left:this.offset.x+AJ};var AM=AQ.style,AR=AQ.parentNode.style;if(AM.position!=="absolute"){if(isNaN(parseInt(AR.width,10))){AR.width=AQ.parentNode.offsetWidth+"px";}if(isNaN(parseInt(AR.height,10))){AR.height=AQ.parentNode.offsetHeight+"px";}AM.position="absolute";AM.width="100%";if(isNaN(parseInt(AR.width,10))){AR.width=AL.right+"px";}}AM.clip=this._getClipStr(AL);}}},_updateDICGroup:function j(){var AI=this.parent;if(this.interactivePosArray.length&&this.interactiveCellsArray.length){AI.destroyDICGroup(this.dicGroupKey);AI.configureCellsAction(this.interactiveCellsArray,0,this.interactivePosArray,true);}this._clearLocalData();},addTempDICInfo:function AB(AI,AJ){if(!this.isRendered()){this.interactiveCellsArray.push(AI);this.interactivePosArray.push(AJ);}},addGroupKey:function AE(AI){if(!this.isRendered()){this.dicGroupKey.push(AI);}},onCellUpdated:function t(AN,AK){if(this.isRendered()){var AI=this.getTableNode(),AJ=AI&&AI.tBodies[AN.page||0],AL=AJ&&AJ.rows[AN.row],AM=AL&&AL.cells[AN.cell];if(AM&&AK!==AM){AL.replaceChild(AK.cloneNode(true),AM);}}},unrender:function B(AI){this._clearLocalData();this._super&&this._super(AI);}});mstrmojo.XtabClonedColHeader=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedColHeader",lockType:z,init:function AD(AI){this._super(AI);if(this.lockHeadersCase&z){this.createDomNode();}},_getClipRect:function D(AJ){var AI=this.parent.hasCustomScrollbar?"offset":"client";AJ=AJ||this.offset;return{top:0,right:this.toCloneNode[AI+"Width"],bottom:AJ.y||0,left:0};},_getClonedFragment:function X(){var AI=document.createDocumentFragment(),AM=this.toCloneNode.cloneNode(true),AL=document.createElement("div"),AK=d.clone(n),AN=d.clone(q),AJ=this._getClipRect();AK.clip=this._getClipStr(AJ);AK.zIndex=4;if(this.parent.zone&&this.parent.zone.autoFitWindow){AK.width="100%";}AM.id=this.getID();d.copy(AK,AM.style);d.copy({left:-this.left+"px"},AM.firstChild.style);this.domNode=AM;l(AN,AJ,this.getTableSize());AN.zIndex=3;d.copy(AN,AL.style);this.curtainNode=AL;AI.appendChild(AM);AI.appendChild(AL);return AI;},scrollDM:function f(AJ,AO,AQ){var AK=this.parent.shouldClipLockableXtab,AL;if(this.lockHeadersCase&z){var AN=!!this.parent.hasLeftScrollNode,AS=this.getTableNode();var AP=this.domNode.firstChild,AI=AP.style;this.domNode.style.width="100%";this.domNode.style.height="100%";if(this.left!==AJ||AN){AI.left=-AJ+"px";this.left=AJ;if(AK){if(AI.position!=="absolute"){AI.position="absolute";AI.width="100%";}if(this.lockHeadersCase&A){AL=this._getClipRect();AL.left=AJ+this.offset.x;AL.right=Math.max(AP.offsetWidth,AS.offsetWidth);AI.clip=this._getClipStr(AL);}}}if(AK){AL={top:this.offset.y+AQ.parentElement.scrollTop,right:Math.max(AS.offsetWidth,AQ.offsetWidth),bottom:Math.max(AS.offsetHeight,AQ.offsetHeight),left:0};if(this.lockHeadersCase&A&&AN){AL.left=this.offset.x+AJ;}var AM=AQ.style,AR=AQ.parentNode.style;if(AM.position!=="absolute"){if(isNaN(parseInt(AR.width,10))){AR.width=AS.offsetWidth+"px";}if(isNaN(parseInt(AR.height,10))){AR.height=AQ.parentNode.offsetHeight+"px";}AM.position="absolute";AM.width="100%";if(isNaN(parseInt(AR.width,10))){AR.width=AS.offsetWidth+"px";}}AM.clip=this._getClipStr(AL);}}},insertPage:O,refreshNode:r,onCellUpdated:R,unrender:function B(AI){this._super(AI);this.fragment=null;this.renderedPages=null;}});mstrmojo.XtabClonedTitle=mstrmojo.declare(mstrmojo.XtabClonedNode,null,{scriptClass:"mstrmojo.XtabClonedTitle",_getClipRect:function D(AI){AI=AI||this.offset;return{top:0,right:AI.x||0,bottom:AI.y||0,left:0};},init:function AD(AI){this._super(AI);if(this.lockHeadersCase===J&&this.left){this.createDomNode();}},_getClonedFragment:function X(){var AI=document.createDocumentFragment(),AM=this.toCloneNode.cloneNode(true),AL=document.createElement("div"),AK=d.clone(n),AN=d.copy(q),AJ=this._getClipRect();AK.clip=this._getClipStr(AJ);AK.zIndex=6;if(this.parent.zone&&this.parent.zone.autoFitWindow){AK.width="100%";}d.copy(AK,AM.style);AM.firstChild.style.left=0;AM.id=this.getID();this.domNode=AM;l(AN,AJ,this.getTableSize());AN.zIndex=5;d.copy(AN,AL.style);this.curtainNode=AL;AI.appendChild(AM);AI.appendChild(AL);return AI;},scrollDM:function f(AL,AK,AJ){if(this.lockHeadersCase===J&&AL&&!this.isRendered()){this.createDomNode();this.domNode.style.width="100%";this.domNode.style.height="100%";this.parent.hasLeftScrollNode=true;}if(this.parent.shouldClipLockableXtab&&this.isRendered()){var AI=this.domNode.firstChild.style;if(AI.position!=="absolute"){AI.position="absolute";AI.width="100%";}AI.clip=this._getClipStr(this._getClipRect());}},insertPage:O,refreshNode:r,onCellUpdated:R,unrender:function B(AI){this._super(AI);this.fragment=null;this.renderedPages=null;}});mstrmojo._IsLockableXtab={_mixinName:"mstrmojo._IsLockableXtab",initLock:function x(AQ){var AM=S.call(this),AP=this.scrollboxNode;if(this.lockHeadersCase&&AP&&AM){var AO=document.createElement("div"),AI=d.copy(AQ,{containerNode:AO,toCloneNode:AP,offset:AM,lockHeadersCase:this.lockHeadersCase,parent:this});if(!this.xtabClonedNodes){this.xtabClonedNodes=[];}if(this.lockHeadersCase&A){if(!this.clonedRowHeader){this.clonedRowHeader=this.addDisposable(new mstrmojo.XtabClonedRowHeader(AI));this.xtabClonedNodes.push(this.clonedRowHeader);}}if(this.lockHeadersCase&z){if(!this.clonedColHeader){this.clonedColHeader=this.addDisposable(new mstrmojo.XtabClonedColHeader(AI));this.xtabClonedNodes.push(this.clonedColHeader);}}if(this.lockHeadersCase===J){if(!this.clonedTitle){var AK=this.clonedColHeader,AN=AK.domNode,AJ=AK.fragment;AI.toCloneNode=AN||AI.toCloneNode;AI.fragment=AJ&&AJ.cloneNode();this.clonedTitle=this.addDisposable(new mstrmojo.XtabClonedTitle(AI));this.xtabClonedNodes.push(this.clonedTitle);}}var AL=this.hasCustomScrollbar?"offset":"client",AR={top:0,left:0,position:"absolute",overflow:"hidden",width:AP[AL+"Width"]+"px",height:AP[AL+"Height"]+"px"};d.copy(AR,AO.style);this.tableContainerNode.appendChild(AO);this.lockFragment=AO;o.call(this);}},getColClonedZone:function F(){return this.clonedColHeader&&this.clonedColHeader.domNode.firstChild;},createZone:function m(AI){return new mstrmojo.XtabZoneWithClonedCover(AI||{});},getStickedTableNodes:function W(){var AJ=this.xtabClonedNodes,AK=[];if(AJ instanceof Array){for(var AI in AJ){var AL=AJ[AI];if(AL.isRendered()){AK.push(AL.getTableNode());}}}return AK;},_adjustClipSize:function g(){if(this.lockHeadersCase){var AJ=this.xtabClonedNodes;if(AJ&&AJ.length){var AK=S.call(this);this.lockFragment.style.width=this.scrollboxNode.clientWidth+"px";this.lockFragment.style.height=this.scrollboxNode.clientHeight+"px";for(var AI in AJ){AJ[AI].adjustClip(AK);}}}},_refreshClonedNodes:function V(){var AL=this.xtabClonedNodes,AR=this.scrollboxNode.firstChild.firstChild,AI=this.titlesCP.getSpanDimension().nRow,AQ=AR&&(AR.rows[AI]||AR.rows[0]),AP=AQ&&AQ.cells,AJ=AP&&AP.length,AM=[],AO=!this.lastCellsRBOffsetLeft,AN;for(AN=0;AN<AJ;++AN){var AK=AP[AN].offsetWidth;AM.push(AK);if(!AO){AO=(this.lastCellsRBOffsetLeft[AN]!=AK);}}this.lastCellsRBOffsetLeft=AM;if(AO){for(AN in AL){AL[AN].refreshNode();}this._adjustClipSize();this.alignLockNodes(this.scrollboxLeft,this.scrollboxTop);}},alignLockNodes:function w(AL,AK){var AJ=this.xtabClonedNodes;if(AJ&&AJ.length){for(var AI in AJ){AJ[AI].scrollDM(AL,AK,this.scrollboxNode.firstChild);}o.call(this);}},isAutoTableLayout:function AA(){return this.zone.isAutoTableLayout();},onPageRendered:function P(AL,AI,AJ,AN){this._super&&this._super(AL,AI,AJ,AN);if(AJ&&AI===0){I(this);}var AK=this.xtabClonedNodes;if(AK&&AK.length){for(var AM in AK){AK[AM].insertPage(AL,AI,AJ,AN);}}},gridPagesRendered:function e(){this._super&&this._super();if(!this.lockHeadersCase){return ;}if(!this.xtabClonedNodes){this.initLock();}else{if(this.isAutoTableLayout()){this._refreshClonedNodes();}}},onCellUpdated:function t(AI,AL){var AM=this.zone,AN=AM.posMap[AI._ei],AJ=AM.tableNode.tBodies[AN.page||0],AK=this.xtabClonedNodes;K(AN,AJ,AL);for(idx in AK){AK[idx].onCellUpdated(AN,AL);}if(this.isAutoTableLayout()){this._refreshClonedNodes();}},unrender:function B(AK){var AJ=this.xtabClonedNodes,AI;if(AJ&&AJ.length){for(AI in AJ){AJ[AI].unrender(true);}}this.zones=null;I(this);this.lockFragment=null;this.xtabClonedNodes=null;this.clonedColHeader=null;this.clonedRowHeader=null;this.clonedTitle=null;this.lastCellsRBOffsetLeft=null;this._super(AK);}};})();(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.XtabZone","mstrmojo.DICFactory","mstrmojo.DynamicClassFactory");var AN=102,R=1,K=2,F=1,AK=4,p=mstrmojo.css,n=mstrmojo.dom,h=mstrmojo.hash,u=mstrmojo.array,d=mstrmojo.DynamicClassFactory.newComponent,L=1,AP=2,I=4,e=2,W=1,C=2,AL=1,H=2,z=1,w=2,c=2,j=1,AR=6,AC=7,J=function(AT){if(AT){return AT.tui>=0?("h_"+AT.tui+"_"+AT.fi+"_"+AT.axis):("m_"+AT.mix);}return"";};function x(AZ,AV,AW){var AY=this.nm[AV],AU=AW.v,AX=AW.dv;AZ.rv=AU;AZ.v=AX;AZ.mdf=1;if(AZ._src){AZ._src.rv=AU;AZ._src.v=AX;AZ._src.mdf=1;}var AT=this.dicGroupMap[J(AZ)].widgetsMap[AZ._ei];if(!AT.showByDefault){if(AT.hasPreview){AT.renderPreview();}else{if(n.isIE7&&mstrmojo.string.isEmpty(AU)){AU=" ";}AY[AY.innerText!==undefined?"innerText":"textContent"]=(!AU?"\u00a0":AU);}}return AY;}function a(AW,AX,AT){if(AT[AX]===0){return true;}if(AW&&AT[AX]===undefined){try{var AU=AW.getRowCells(AX),AY=AU&&AU[0];if(AY&&AY.o===AX){if(AY.sst){AT[AX]=0;}return !!AY.stt;}if(AY&&AY.o){return a(AW,AX+AX-AY.o,AT);}return false;}catch(AV){return false;}}else{return false;}}function M(AU,AT){u.forEach(AU,function(AV){AT[AV.o]=1;});}function AO(AT){if(AT.mgh&&(AT.mgh&R)){this.mghMarks={};}}function AA(AV,AX){var AU=AX.bb-1,AT=Math.min(AU+AX.bc,AX.tc),AW;h.forEach(AV,function(AZ,AY){AW=Number(AY);if(!isNaN(AW)&&AW>=AU&&AW<AT){delete AV[AY];}});}function AF(AW,AV){var AT=this.editing?1:(AW.rs||1),AU;for(AU=0;AU<AT;AU++){this.dirtyRows[AV+AU]=1;}}function AS(AT){return AT&&parseInt(AT.ipt,10)===c;}function AM(AT){var AU;this.delegateGridAction(function(AV){if(!AU&&AV.posMap&&AV.posMap[AT._ei]){AU=AV;}},"getRowIndex");return AU.getRowIdxByCell(AT);}function k(AT){var AZ=AT.thPosMap,Ab=AT.slot,AY=AZ&&AZ.length||0,Ad=this.lastHeaderIndexs[Ab]||0,AX=[AT.tableNode],Aa,AV,Ac,AW;if(this.getStickedTableNodes){AX=AX.concat(this.getStickedTableNodes());}for(AW=Ad;AW<AY;++AW){Aa=AZ[AW],Ac=Aa.obj;if(this.isEditableHeader(Ac)){for(var AU in AX){AJ(AX[AU],Aa);}}}this.lastHeaderIndexs[Ab]=AW;}function AJ(AT,AV){var AU=AT.tBodies[AV.page].rows[AV.row].cells[AV.cell];AU.innerHTML='<div class="editable-column">'+AU.innerHTML+"</div>";}function l(AV){var AX=true,AU=AV||[];for(var AW=0,AT=AU.length;AW<AT;AW++){if(AU[AW]&&(AU[AW].w==="")){AX=false;break;}}return AX?"40px":"";}function t(AT){return !AT.tav||!(AT.tav&F);}mstrmojo._IsEditableGridCP={_mixinName:"mstrmojo._IsEditableGridCP",initContent:function AH(AW){this._super(AW);var Ac=this.gridData,AU=Ac&&Ac.vp,Aa,AZ,Ab,Ae,AT,Ad,AV,AY;if(((this.type===L)||(this.type===I))&&AU&&AU.cols&&!AU._adjusted){AT=AU.cols.cg;AV=AU.cols.cws;if(AT&&AT.cgc>0){for(Aa=AT.cgc;Aa>0;Aa--){AT[Aa]=h.copy(AT[Aa-1],{});Ad=AT[Aa];var AX=Ad.attForms;if(AX){for(AZ=0,Ae=AX.length;AZ<Ae;AZ++){Ab=AX[AZ];Ab.idx+=1;}}}AT[0]={tg:false,cc:0,cl:1,attForms:[{n:"",idx:0}]};AT.cgc+=1;}if(AV){AV.splice(0,0,{w:"60px",xc:true});}if(AU.dafIdx!==undefined){AU.dafIdx+=1;}AY=Ac.gts.row;for(Aa=0,Ae=AY.length;Aa<Ae;Aa++){AY[Aa].ci=Aa+1;}AU._adjusted=true;}this.colWidths=[{w:l(this.colWidths)}].concat(this.colWidths);this.unmergedCells=[];},getUnmergedCells:function Z(){return null;},getRowCells:function AD(Ad){var AV=this._super(Ad),AT=AV[0],Ah=(AT&&AT.o)||0,Ae=(this.tp===L),AY=this.interactiveCellsArray,Ag={css:"",v:""},Ak=[],AU=[],Al,Am;if(!Ae){var Aa=this.base.items,Aj=this.lookupBase,Ai=this.gridData.css,Ap=AT&&AT.pi,Af=Ap&&Ap.ri,Ao=Ap&&Ap.ci,Ab=AT.stt>0;while(Ap&&Af>-1&&Ao>-1){AT=AT._p||Aa[Af].items[Ao];var AW=h.copy(AT,{});AW._src=AT;if(!AW.css){AW.css=Ai[AW.cni].n;}var Ac=Aj[AT.tui],An=Ac&&Ac.es[AT.idx];if(An){AW.v=AT.v||An.n;AW._e=An;}AW.rs=1;if(Ab){AW.at&=~32;}if(Ah>-1){AW.o=Ah;}if(!AW.axis&&this.axis){AW.axis=this.axis;}AW._ei=AY.push(AW)-1;Ak.splice(0,0,AW);Ap=AT&&AT.pi;Af=Ap&&Ap.ri;Ao=Ap&&Ap.ci;}for(Al=0,Am=AV.length;Al<Am;Al++){var AX=AV[Al];if(AX.rs>1){var AZ=h.copy(AX,{});AZ.rs=1;AX=AZ;}AU.push(AX);}}else{AU=AV;if(Ad>0){return AV;}}if(AU[0]){Ag=h.copy(AU[0],{});Ag.rv=Ag.v="";if(this.tp===L){Ag.n=Ag.v="";Ag.markAll=true;}else{Ag.n="";}Ag._ei=AY.push(Ag)-1;Ag.at=32;Ag.cs=1;Ag.mark=true;Ag.mix="x";Ag.css=(Ak[0]&&Ak[0].css)||Ag.css;delete Ag.ui;delete Ag.tui;delete Ag.fs;delete Ag.mdf;}return[Ag].concat(Ak.concat(AU));}};mstrmojo._IsEditableXtab=mstrmojo.provide("mstrmojo._IsEditableXtab",{_mixinName:"mstrmojo._IsEditableXtab",update:function AB(AV){var AT,AU=AV.data;if(this._super){this._super(AV);}this.kc={};this.rs={};this.rsDelta={};AO.call(this,AU);if(AU.eg!==undefined){return ;}AT=AV.data.marked;if(AT){M(AT,this.rs);}if(!AU.rw){var AW=AU.gvs.items.length;AU.rw={row:{bb:1,bc:AW,tc:AW},col:{bb:-1,bc:-1,tc:0}};}},initCP:function E(AV,AU,Aa,AX,AZ,AW,AY){var AT={gridData:AV,type:Aa,interactiveCellsArray:AU};AT.base=AX||AT.base;AT.lookupBase=AZ||AT.lookupBase;AT.axis=AW||AT.axis;AT.dataSource=this;if(!AY){if(this.tca===K&&this.editing){if(Aa===L){mstrmojo.EditableXtabTitlesCP=d(mstrmojo.XtabTitlesCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabTitlesCP",tp:L});AY=new mstrmojo.EditableXtabTitlesCP(AT);}else{if(Aa===I){mstrmojo.EditableXtabCP=d(mstrmojo.XtabCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabCP"});AY=new mstrmojo.EditableXtabCP(AT);}else{AY=new mstrmojo.XtabCP(AT);}}}else{if(Aa===L){AY=new mstrmojo.XtabTitlesCP(AT);}else{AY=new mstrmojo.XtabCP(AT);}}}else{h.copy(AT,AY);}return AY;},createOnDemandCP:function o(AU,AV,AT){var AW;if(this.tca===K&&this.editing&&AT===I){mstrmojo.EditableXtabOnDemandCP=d(mstrmojo.XtabOnDemandCP,[mstrmojo._IsEditableGridCP],{scriptClass:"mstrmojo.EditableXtabOnDemandCP"});AW=new mstrmojo.EditableXtabOnDemandCP();}else{AW=new mstrmojo.XtabOnDemandCP();}AW.dataSource=this;AW.blockNum=AU;AW.rc=AV;return AW;},preBuildRendering:function B(){var AT=this.defn.txi;if(this._super){this._super();}this.txar=AT.txar;this.sci=AT.sci;this.tca=AT.tca;if(this.tca!==K){this.editing=false;}else{if(mstrApp.isMobile){this.editing=this.alwaysEditing=true;}}this.nm={};this.ko={};this.dirtyRows={};this.requiredCellsMap={};this.dicGroupMap={};this.lastIndex=0;this.lastHeaderIndexs={};this.columnNames={};},postBuildRendering:function Y(){if(this._super){this._super();}if(this.tca===K&&this.gridData.eg===undefined){var AV=Math.max(-16,-this.domNode.offsetTop),AW=this;if(!this.alwaysEditing){var AT=mstrmojo.Button.newIconButton(mstrmojo.desc(8324,"Mark rows"),"mstrmojo-EditButton",function(){if(!AW.recalculating){AW.editing=!AW.editing;AW.refresh();}}),AU=new mstrmojo.Button(mstrmojo.hash.copy({cssText:"top:"+AV+"px;"},AT));AU.render();this.domNode.appendChild(AU.domNode);if(this.editing){this.domNode.style.zIndex=1000;p.addClass(AU.domNode,"close");}else{p.removeClass(AU.domNode,"close");}}}},dataDownloadErr:function N(){if(this.txar&&this.recalculating){this.delegateGridAction(function(AT){AT.isDownloading=false;},"isDownloading");this.rhsCP.initContent();this.valuesCP.initContent();p.removeClass(this.maskNode,"wait");this.recalculating=false;}},dataDownloaded:function U(AW,AU){var AV=AW.data;if(this.txar){var AT=AU.blockNum,AX;if(this.recalculating){AU.recalculating=true;this.interactiveCellsArray=[];this.requiredCellsMap={};this.dirtyRows={};this.lastIndex=0;this.lastHeaderIndexs={};this.kc={};this.nm={};this.updatedCellsMap={};this.recalculating=false;this.destroyDICs();}else{AU.recalculating=false;}if(AT===0){this.gridData=AV;}if(AV.eg){this.refresh();return ;}AX=this.interactiveCellsArray;this.initCP(AV,AX,L,null,null,null,this.titlesCP);this.initCP(AV,AX,AP,AV.ghs.chs,AV.gts.col,e,this.chsCP);this.titlesCP.initContent();this.chsCP.initContent();this.delegateGridAction(function(AY){if(AX&&AX.length===0){grid.refresh();}},"refreshOnDataDownloaded");}if(this._super){this._super(AW,AU);}AO.call(this,AV);AA(this.rs,AV.rw.row);if(AV.marked){M(AV.marked,this.rs);this.rsDelta={};}},closeDownloadStatus:function X(){if(this._super){this._super();}mstrmojo.css.removeClass(this._STATUS,"recalculate");},kc:null,ko:null,nm:null,rs:null,dicGroupMap:null,lastIndex:0,lastHeaderIndexs:{},columnNames:null,getDataInputInfo:function g(AT,AW){var Ab=AT._ei,Aa,AV=this.node.defn,Aj=this.gridData;if(AT.mark){Aa=AT.o;if(AT.stt){this.rs[Aa]=0;return ;}this.ko[Aa]=Ab;AT.rv=AT.v=this.rs[Aa]||-1;this.kc[Ab]={rowop:true};return{key:Ab,t:AN,vls:[{v:-1},{v:1}],wm:1,w:22,hm:1,h:16,dm:1};}var Ae=this.model.getCellTitleInfo(AT,this.dataBlocks[AT._gd]),Ak=Ae&&Ae.title,Ag=Ak&&Ak.es,AZ=(AT.mti!==undefined)?AT.mti:AT.mix,AX=(AT.mix!==undefined),Ah=AV.txi.dic,Ad;Ad=h.copy(!AX?Ah.att&&Ak&&Ah.att[Ak.id]&&Ah.att[Ak.id][Ak.fs[AT.fi].id]:Ah.mtx&&Ah.mtx[Ag[AZ].oid],{});if(!Ad){return null;}if(this.columnNames[AW]===undefined){this.columnNames[AW]=!AX?Ak.n:Ag[AZ].n;}if(AS(Ad)){Ad.vls=(Aj.dcv&&Aj.dcv[Ad.k])||[];}if(Aj.tcs&&Aj.tcs[Ad.k]){var Ac=Aj.tcs[Ad.k];if(Ac&F){Ad.disabled=true;}if(Ac&AK){Ad.req=1;}}if(Ab>=0&&!this.kc[Ab]){var Ai=!AT.axis,AY={isMv:Ai};if(Ai){var Af=AT.pi,AU=Af&&Af.top;AY.co=(AU&&AU.ci)||0;AY.metric_id=Ag[AZ].oid;AT.o=AY.o=(AT._lp&&AT._lp.o)||0;AY.tp=C;}else{AY.ax=AT.axis;AY.atid=Ak.id;AY.form_id=Ak.fs[AT.fi].id;AY.o=AT.o;AY.tp=W;AY.fi=AT.fi;AY.ui=AT.ui;AY.tui=AT.tui;AY.rs=AT.rs;}AY.dt=Ad.dt;if(AS(Ad)){AY.vls=Ad.vls;AY.k=Ad.k;}this.kc[Ab]=AY;}Ad.key=Ab;if(Ad.dm){Ad.dm=parseInt(Ad.dm,10);}return Ad;},isEditableHeader:function G(AT){var AU=this.node.defn,AV=AU.txi.dic;if(AT.sst||!AV){return false;}if(AT.id!==undefined&&AV.att){return !!(AV.att[AT.id]&&(AT.fix?AV.att[AT.id][AT.fid]:AV.att[AT.id]));}if(AT.tui!==undefined&&AT.mix!==undefined&&AV.mtx){return !!(AV.mtx[AT._e.oid]);}return false;},dataChanged:function Q(AV,AW,AU,AX,AT){if(!this.recalculating){if(AX){this.nm[AV]=AX;}if(this._super){this._super(AV,AW,AU,AX,AT);}}},updateValue:function f(AW,AU){if(this._super){this._super(AW,AU);}var Aa=this.interactiveCellsArray[AW],Ae=AU.v,Af,AT=AM.call(this,Aa);this.lmr=null;Af=x.call(this,Aa,AW,AU);if(Aa.r!==Ae){if(!Aa.mark){Aa.mdf=1;mstrmojo.css.removeClass(Af,"required");AF.apply(this,[Aa,AT]);this.flagDirtyUnit(Af);}}else{this.clearDirtyUnit(Af);}if(this.onCellUpdated){this.onCellUpdated(Aa,Af);}if(this.tca===K){if(Aa.mark){var AY=Aa.markAll?-1:Aa.o,Ac=this.rsDelta;this.rs[AY]=Ae;this.lmr={r:AY,v:Ae};if(Aa.markAll){Ac=this.rsDelta={};Ac[AY]=Ae;this.mghMarks={};}else{if(Ac[AY]&&Ac[AY]!==Ae){delete Ac[AY];}else{if(Ac[-1]!==Ae){Ac[AY]=Ae;}}}}else{if(this.rs[Aa.o]!==0){this.rs[Aa.o]=1;}if(!this.editing&&this.mghMarks&&(Aa.mix===undefined)){if(!this.mghMarks[Aa.o]||this.mghMarks[Aa.o].rs<Aa.rs){this.mghMarks[Aa.o]={o:Aa.o,rs:Aa.rs,k:AW};}var AX,Ab,AZ=this;h.forEach(this.rsDelta,function(Ag,Ah){AX=parseInt(Ah,10);Ab=parseInt(Aa.o,10);if(AX>=Ab&&AX<=(Ab+Aa.rs)){delete AZ.rsDelta[Ah];}});}else{this.rsDelta[Aa.o]=1;}if(!this.editing&&Aa.rs>1){var AV=Aa.o+1;while(AV-Aa.o<Aa.rs){if(!a(this.rhsCP,AV,this.rs)){this.rs[AV]=1;}AV+=1;}}if(this.editing){var Ad=this.dicGroupMap.m_x.widgetsMap[this.ko[Aa.o]];if(Ad){Ad.set("checked",true);}}}}if(this.txar&&!Aa.mark){return true;}return false;},autoRefresh:function AE(AT){this.delegateGridAction(function(AU){AU.invalidAllPages();},"invalidAllPages");this.rhsCP.invalid();this.valuesCP.invalid();p.addClass(this._STATUS,"recalculate");this.delegateGridAction(function(AU){AU.onscroll(true,AT);},"scrollOnAutoRefresh");this.recalculating=true;},getKeyContext:function P(AT){return this.kc[AT];},getUpdateObject:function S(){var AY=[],AW,AZ,Aa,AU=this.lmr,AV,AX={};if(AU){this.lmr=null;return{manipulation:AL,actionType:(AU.v===-1)?z:w,rowOrdinal:AU.r,nodeKey:this.k,sliceId:this.sid};}AZ=this.getUpdatedValues();for(AW=0;AW<(AZ&&AZ.length);AW++){if(!AZ[AW].rowop){Aa=AZ[AW];break;}}if(Aa){AV=mstrmojo.string.encodeXMLAttribute(String(Aa.v));if(Aa.k!==undefined&&Aa.vls){var AT=u.find(Aa.vls,"v",Aa.v);if(AT!==-1){AX={controlKey:Aa.k,elementId:Aa.vls[AT].eid};}}if(!!Aa.isMv){AY.push(h.copy(AX,{rowOrdinal:Aa.o,colOrdinal:Aa.co,newValue:AV,dataType:Aa.dt}));}else{AY.push(h.copy(AX,{rowOrdinal:Aa.o,attId:Aa.atid,formId:Aa.form_id,unitIndex:Aa.tui||Aa.ui,newValue:AV,dataType:Aa.dt}));}}return{manipulation:H,nodeKey:this.k,sliceId:this.sid,cells:AY,autoRefresh:this.txar};},getUpdates:function T(){var Ad=this,AY,AZ,AT=Ad.getUpdatedValues(),AW=this.rsDelta,AX=[],Ac=[],Aa=false,AV="";AX.push('<gr rw_tree_type="'+Ad.treeType+'" rw_node_key="'+Ad.k+'" slice_id="'+Ad.sid+'">');for(AY in AT){if(AT.hasOwnProperty(AY)){AZ=AT[AY];if(!AZ.rowop){var Ae=mstrmojo.string.encodeXMLAttribute(String(AZ.v)),AU=u.find(AZ.vls,"v",AZ.v);if(AZ.k&&AZ.vls&&AU===-1){if(!!AZ.isMv){Ac.push('<cli cordinal="'+AZ.co+'" metric_id="'+AZ.metric_id+'"><updt types="'+AC+'" rordinal="'+AZ.o+'" rw_control_key="'+AZ.k+'"/></cli>');}else{Ac.push('<cli ax="'+AZ.ax+'" attribute_id="'+AZ.atid+'" form_id="'+AZ.form_id+'"><updt types="'+AR+'" ordinal="'+AZ.o+'" rw_control_key="'+AZ.k+'" flags="1"/></cli>');}}else{if(AZ.k&&AZ.vls&&AU!==-1){AV='rw_control_key="'+AZ.k+'" element_id="'+AZ.vls[AU].eid+'" ';}if(!!AZ.isMv){Ac.push('<cli cordinal="'+AZ.co+'" metric_id="'+AZ.metric_id+'"><updt types="'+AZ.tp+'" rordinal="'+AZ.o+'" '+AV+'value="'+Ae+'" dt="'+AZ.dt+'"/></cli>');}else{Ac.push('<cli ax="'+AZ.ax+'" attribute_id="'+AZ.atid+'" form_id="'+AZ.form_id+'"><updt types="'+AZ.tp+'" ordinal="'+AZ.o+'" '+AV+'value="'+Ae+'" dt="'+AZ.dt+'"'+(this.mghMarks?' flags="1"':"")+"/></cli>");}}Aa=true;}}}if(!h.isEmpty(this.mghMarks)){var Ab=this;h.forEach(this.mghMarks,function(Af,Ag){AV=Ab.getKeyContext(Af.k);Ac.push('<mark rordinal="'+Ag+'" types="4" flags="1" attribute_id="'+AV.atid+'" form_id="'+AV.form_id+'"/>');});}if(AW&&!h.isEmpty(AW)){Aa=true;u.forEach(h.keyarray(AW).sort(),function(Af){if(AW[Af]===1){Ac.push('<mark rordinal="'+Af+'" types="4"/>');}else{Ac.push('<mark rordinal="'+Af+'" types="5"/>');}});}AX.push(Ac.join(""));AX.push("</gr>");if(!Aa){AX=[];}return AX.join("");},flagDirtyUnit:function b(AU){if(AU&&this.sci){if(this._super){this._super(AU);return ;}var AT=document.createElement("div"),AY,AV=false,AX=p.getStyleValue(this.domNode,n.CSS3_TRANSFORM),AW;AT.className="flag-container";AT.innerHTML='<div class="dirty-cell"/>';if(AU.insertBefore){AU.insertBefore(AT,AU.firstChild);AW=(AT.offsetParent===AU);}AV=mstrmojo.string.isEmpty(AX)||AX==="none";AY=AT.firstChild;AY.style.top=((!AV||AW)?(-AT.offsetTop):(AU.offsetTop-AT.offsetTop))+"px";AY.style.left=(AU.clientWidth+((!AV||AW)?(-AT.offsetLeft):(AU.offsetLeft-AT.offsetLeft))-8)+"px";}},clearDirtyUnit:function AQ(AT){if(this._super){this._super(AT);return ;}var AU=AT.firstChild;if(AT){if(AU&&AU.className&&AU.className==="flag-container"){AT.removeChild(AU);}}},onvisibleChange:function r(){if(this.visible===true){var AT=this;setTimeout(function(){AT.configureActions();},10);}},configureActions:function V(){if(this.visible===false){return ;}this.configureCellsAction();this.lastIndex=this.interactiveCellsArray.length;var AT=this;this.delegateGridAction(function(AU){k.call(AT,AU);},"markEditableColHeaders");this.registerTxWidget();if(this._super){this._super();}},configureCellsAction:function AG(Ao,Ab,Al,Aa){var A0=this,AT=this.getTargetZone(),Al=Al||AT.posMap,Af=Ao||this.interactiveCellsArray,Ab=(Ab===undefined?this.lastIndex:Ab),Ap=this.dicGroupMap,An=[],AX,Au,At,As,AV,Ad,Aq,Ac,AU,Az,Ay,Ax,Aw,Am=function(){var A1=[];this.delegateGridAction(function(A2){A1.push(A2);},"configureActions");return A1;},AZ=Am.call(this),Ag=(AZ.length>1),Ah=function(A1){var A3=A1.length,A2;for(A2=0;A2<A3;A2++){A0.flagDirtyUnit(A1[A2]);}};for(AX=Ab,Au=Af.length;Af[AX]&&AX<Au;AX++){AV=Af[AX];Ad=Al&&Al[AX];if(!Ad&&Ag){AT=(AZ[0]===AT)?AZ[1]:AZ[0];Al=AT&&AT.posMap;Ad=Al&&Al[AX];}if(Ad&&((AV.at&32)>0)){AV.at=32;if(AV.rv==null){AV.rv=isNaN(AV.mix)?AV._e.n:AV.v;}Ac=J(AV);Ay=this.getDataInputInfo(AV,Ac);Ax=Ap[Ac];if(AV.axis===1&&this.clonedRowHeader){if(this.clonedRowHeader.isRendered()){Aw=this.clonedRowHeader.getTableNode();}else{Aw=AT.tableNode;if(Ay&&!Ax){this.clonedRowHeader.addGroupKey(Ac);}this.clonedRowHeader.addTempDICInfo(AV,Ad);}}else{if(AV.axis===2&&this.clonedColHeader&&this.clonedColHeader.isRendered()){Aw=this.clonedColHeader.getTableNode();}else{Aw=AT.tableNode;}}Aq=Aw.tBodies[Ad.page].rows[Ad.row].cells[Ad.cell];if(Ay){if(!Ax){Ax=Ap[Ac]=mstrmojo.DICFactory.createDICGroup({gk:Ac,dic:Ay,owner:this,openerType:j});}var AW=!t(AV)||Ay.disabled;var Ar={value:(AV.rv===undefined)?(AV.v||AV.n):(typeof AV.rv==="string"?mstrmojo.string.decodeHtmlString(AV.rv):AV.rv),dv:AV.v||AV.n,ts:AV.ts,markAll:AV.markAll,openerNode:Aq,k:AV._ei,ownerCell:AV,enabled:!AW,popupTitle:this.columnNames[Ac]},AY=AT.cp.stackedRh;if(AY&&AV.singleStack&&(mstrmojo.DICConfig.showDICByDefault(Ay,1)||mstrmojo.DICConfig.hasDICPreview(Ay,1))){var Aj=Aq.offsetHeight;Aq.className+=" igDIC";Aq.style.cssText="height:"+Aj+"px;";if(Ax.showByDefault){Aq.className+=" sbd";}mstrmojo.hash.copy({inlineExtraCssText:"position:absolute;top:"+parseInt(AY/2-Aj/2+1,10)+"px;"},Ar);}Ax.addDIC(AV._ei,Ar);AU=Ad.page*AT.rowsPerPage+Ad.row;if(Ay.req){for(As=0;As<(this.editing?1:(AV.rs||1));As++){Az=this.requiredCellsMap[AU+As];if(!Az){this.requiredCellsMap[AU+As]=Az=[];}Az.push(AV);}}if(AV.mdf&&!Aa){An.push(Aq);AF.apply(this,[AV,AU]);}if(AW&&!mstrmojo.DICConfig.showDICByDefault(Ay,1)){var Ai=document.createElement("div"),Av=document.createElement("span"),Ak=Aq.currentStyle||document.defaultView.getComputedStyle(Aq,null),Ae={marginLeft:"-"+Ak.paddingLeft,paddingLeft:Ak.paddingLeft,marginRight:"-"+Ak.paddingRight,paddingRight:Ak.paddingRight,marginTop:"-"+Ak.paddingTop,paddingTop:Ak.paddingTop,marginBottom:"-"+Ak.paddingBottom,paddingBottom:Ak.paddingBottom};Ai.className="xtab-dic-disabled";h.copy(Ae,Ai.style);Av.appendChild(Aq.firstChild);Ai.appendChild(Av);Aq.appendChild(Ai);}}}}this.lastIndex=AX;for(Ac in Ap){Ap[Ac].render();}setTimeout(function(){Ah(An);},25);},destroyDICGroup:function q(AU){var AV=this.dicGroupMap,AT,AW,AX;if(AV&&(AU instanceof Array)){for(AT in AU){AW=AU[AT];AX=AV[AW];if(AX){AX.destroy();delete AV[AW];}}}},showPopupDIC:function A(AW){var AU=AW&&n.findAncestorByAttr(AW,"ei",true,this.viewport);if(AU){var AX=AU.node,AT=this.getCellForNode(AX),AV=this.dicGroupMap[J(AT)];if(AV&&!AV.dic.disabled&&!(AT.tav&&(AT.tav&F))){AV.showPopupDIC(AT._ei);return true;}}return false;},onclick:function AI(AU){var AT=mstrmojo.dom.eventTarget(window,AU.e);if(!this.showPopupDIC(AT)&&this._super){this._super(AU);}},unrender:function D(){if(this._super){this._super();}this.destroyDICs();},destroyDICs:function v(){var AT=this.dicGroupMap;this.dicGroupMap={};setTimeout(function(){var AU;for(AU in AT){AT[AU].destroy();}},10);},checkRequiredObjects:function O(){if(this.hasRendered&&!(this.isInteractiveGrid&&this.isInteractiveGrid())&&!this.gridData.eg){var AV=this.getTargetZone(),AX=AV.posMap,AZ,AW=this,AU=this.rs,AT=true,AY=function(Af,Ab){var Ae=true,Ac=AW.requiredCellsMap[Af],Aa=(Ac&&Ac.length)||0,Ad;for(Ad=0;Ad<Aa;Ad++){if(!Ac[Ad].mdf){p.toggleClass(AV.getNodeByPosition(AX[Ac[Ad]._ei]),"required",Ab);Ae=!Ab;}}return Ae;};if(this.tca===K){for(AZ in AU){AT=AY(parseInt(AZ,10)+1,AU[AZ]>0)&&AT;}}else{for(AZ in this.dirtyRows){AT=AY(AZ,true)&&AT;}}return AT;}return true;},editNext:function m(AV){if(this.recalculating){return false;}var AW=this.interactiveCellsArray,AT=AW.length,AX=AV+1,AY,AU;do{if(AX>=AT){AX%=AT;}if(AX===AV){return false;}AY=AW[AX];var AZ=this.dicGroupMap[J(AY)];if(AZ&&!AZ.dic.disabled&&t(AY)){if(mstrmojo.DICConfig.isKeyNavigable(AZ.dic)){if(!AZ.showByDefault){AZ.showPopupDIC(AX);}else{AU=AZ.widgetsMap[AX];AU.focus();}return true;}}AX++;}while(true);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasScrollbox","mstrmojo.XtabZone","mstrmojo._ShowsStatus","mstrmojo.boxmodel","mstrmojo._IsLockableXtab","mstrmojo._IsDocumentTemplate","mstrmojo.hash","mstrmojo.dom","mstrmojo.chart.model.enums.EnumDSSBaseFormType");var Q=1,X=2,Y=0,C=1,z=2,N=3;var M=1;var AB=2;var I=4;var g=8;var d=mstrmojo.dom,p;function AF(AH){var AI=null;if(AH&&AH.length>1){AI=new mstrmojo.XtabVACP();AI.cps=AH;}return AI;}function J(AI){if(!AI||this._onDemandCP){return null;}var AP=AI.bc,AN=AI.tc,AJ=AN-AP,AO=Math.ceil(AJ/AP),AK=[],AM=[],AL;for(AL=0;AL<AO;++AL){var AH=Math.min(AJ,AP);AK.push(this.createOnDemandCP(AL+1,AH,I));AM.push(this.createOnDemandCP(AL+1,AH,g));AJ-=AP;}this._onDemandCP={rhs:AK,vls:AM};return this._onDemandCP;}mstrmojo.XtabTitlesCP.prototype.shouldClonedLastTitleCell=function(){return false;};mstrmojo.XtabBase=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsLockableXtab,mstrmojo._HasScrollbox,mstrmojo._ShowsStatus,mstrmojo._IsDocumentTemplate],{scriptClass:"mstrmojo.XtabBase",dataRenderMode:"vscroll",shouldClipLockableXtab:true,alwaysShowFirstBlockData:false,handleClicks:function H(){return true;},markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-Xtab {@cssClass}" title="{@tooltip}" style="{@domNodeCssText}"><div style="display: none;{@msgNodeCssText}"><div class="text"><div class="warning-icon"></div><div>&nbsp;</div></div></div><div class="mstrmojo-Xtab-overlay"></div><div class="mstrmojo-Xtab-content {@cssDefault}" title="{@tooltip}" style="{@viewportCssText}" mstrAttach:click,selectstart><table cellspacing="0" cellpadding="0"><tr><td style="vertical-align:top;padding:0;"><div style="position: relative;"><div class="mstrmojo-progress" style="display:none"><div class="mstrmojo-progress-barbg"><div class="mstrmojo-progress-bar"></div></div><div class="mstrmojo-progress-text"></div></div><div id="{@id}_scrollbox" style="position:relative;{@scrollboxNodeCssText};{@scrollboxNodeOverflow}"></div></div></td></tr></table></div></div>',markupSlots:{overlayNode:function(){return this.domNode;},msgNode:function(){return this.domNode.firstChild;},maskNode:function(){return this.domNode.childNodes[1];},viewport:function(){return this.domNode.lastChild;},contentNode:function(){return this.domNode.lastChild.firstChild;},scrollboxNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.lastChild;},tableContainerNode:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild;},_STATUS:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild;},_STATUS_TXT:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.lastChild;},_STATUS_BAR:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0].firstChild.firstChild.firstChild;},_TB_CELL:function(){return this.domNode.lastChild.firstChild.rows[0].cells[0];}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},zone:null,lockHeadersCase:N,interactiveCellsArray:null,titlesCP:null,chsCP:null,rhsCP:null,valuesCP:null,onDemandIF:true,numRowFixed:false,heightLimit:0,height:0,widthLimit:0,width:0,useTouchScrolling:false,scrollInterval:0,selections:null,dataBlocks:null,getCellUnitIndex:function m(AH){return(AH.o!==undefined)?AH.o:AH._ei;},getCellTitleId:function e(AH){var AI="";if(AH.axis&&AH.ui!==undefined){AI=AH.axis+"A"+(AH.ui+1);}else{if(AH.mix!==undefined){AI="0A"+AH.mix;}}return AI;},update:function k(AI){this.set("gridData",AI.data[0]||AI.data);var AH=this.defn||AI.defn;this.sid=this.gridData.sid;this.treeType=(AH&&AH.tt)||1;this.interactiveCellsArray=[];if(this._super){return this._super(AI);}return true;},initCP:function F(AJ,AI,AO,AL,AN,AK,AM){var AH={gridData:AJ,type:AO,interactiveCellsArray:AI,defn:this.defn};AH.base=AL||AH.base;AH.lookupBase=AN||AH.lookupBase;AH.axis=AK||AH.axis;if(!AM){if(AO===M){AM=new mstrmojo.XtabTitlesCP(AH);}else{AM=new mstrmojo.XtabCP(AH);}}else{mstrmojo.hash.copy(AH,AM);}return AM;},preBuildRendering:function D(){var AJ=this.gridData,AH=this.height,AI=this.width;this.lockHeadersCase=AJ.lhv||Y;this.selections={};this.numRowFixed=!!(!AH&&AJ.rw&&AJ.rw.row&&(AJ.rw.row.bc<AJ.rw.row.tc));this.rw=AJ.rw;this._onDemandCP=null;if(AI){this.widthLimit=parseInt(AI,10);}if(AH){this.heightLimit=parseInt(AH,10);}return this._super();},renderEmptyGrid:function q(){var AK=this.gridData,AI=this.msgNode,AJ=AI.style,AH=this.viewport;AI.firstChild.childNodes[1].innerHTML=AK.eg;if(AK.eg!==""){AJ.display="block";AJ.overflow="hidden";AI.className="mstrmojo-message";AH.style.display="none";}return true;},postBuildRendering:function U(){var AM=this.gridData,AJ=!!this.viewport&&AM,AI=this.msgNode,AH=this.viewport,AL;if(AM.eg===undefined){if(AI.style.display==="block"){AI.style.display="none";AH.style.display="block";}}else{return this.renderEmptyGrid();}if(!this.interactiveCellsArray){this.interactiveCellsArray=[];}if(AJ){AM.ghs=AM.ghs||[];AM.gts=AM.gts||[];this._setupZone(AM);this._setupCP(AM);var AO=this.zone;if(AO.parent!==this){this.addChildren(AO);}if(this.scrollboxNode){var AK=this.heightLimit;this.scrollboxHeightFixed=!isNaN(AK)&&(AK>0);if(this.scrollboxHeightFixed){this.scrollboxHeight=AK;}this.scrollboxLeft=this.scrollboxTop=0;this.connectScrollbox(this);}}this.renderChildren();if(this.controller&&this.controller.getScrollPosition){var AN=this.controller.getScrollPosition(this.gridData.datasetId+"."+this.gridData.k);if(AN){this.scrollTo(AN);}}AL=this._super();if(this.numRowFixed){if(!this.height){this.heightLimit=this.zone.getPageHeight(0);this.height=this.heightLimit+"px";}else{this.heightLimit=parseInt(this.height,10);}}if(((AJ&&this.scrollboxNode&&AM.afc)||this.numRowFixed)||(!AM.afc&&this.scrollboxNodeCssText.indexOf("width")<0)&&this.scrollboxNode.scrollWidth>this.scrollboxNode.clientWidth){this.resizeScrollBox();}this.onGridWidthChanged(true);this._onContainerGrowShrink(this.widthLimit,this.heightLimit);if(d.isIE7&&!this.scrollboxHeightFixed&&this.scrollboxNode&&this.scrollboxNode.scrollWidth>this.scrollboxNode.offsetWidth){this.scrollboxNode.style.height=this.scrollboxNode.offsetHeight+17+"px";}if(this.lockHeadersCase&&this.initLock){this.initLock({top:this.scrollboxTop,left:this.scrollboxLeft});}if(this.configureActions){this.configureActions();}return AL;},onclick:function n(AI){var AK=mstrmojo.dom,AM=AI.getTarget(),AL=AM&&AK.findAncestorByName(AM,"td",true,this.viewport);if(AM.nodeName.toLowerCase()==="a"&&AL.getAttribute("ei")){try{var AJ=this.interactiveCellsArray[parseInt(AL.getAttribute("ei"),10)];if(AJ&&AJ.ts===mstrmojo.chart.model.enums.EnumDSSBaseFormType.DssBaseFormHTMLTag){AM.href=mstrmojo.addCSRFTokenToURL(AM.href);}}catch(AN){}}if(AL){var AH=AK.findAncestorByName(AM,"span",true,AL);if(AH&&!AI.shiftKey&&!AI.ctrlKey){this.defaultAction(AL);}else{this.doSelection(AI.e,AI.hWin,AL);}}if(this.isSelectingText){this.isSelectingText=false;}},ontouchend:function h(AI,AH){this.onclick(mstrmojo._HasMarkup.newDomEvent("click",AH,AI));},onselectstart:function r(){return false;},onscroll:function t(){this._alignHeaders();if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.gridData.datasetId+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}},resizeScrollBox:function K(){var AK=this.scrollboxNode,AJ=AK&&AK.style,AI=this._TB_CELL;if(!AJ||!AI){return ;}var AH=this.heightLimit;if(!AH){AJ.height="auto";this.scrollboxHeightFixed=false;}else{if(AH>0){AJ.height=AH+"px";this.scrollboxHeight=AH;this.scrollboxHeightFixed=true;}}this._resizeScrollBoxWidth();},_onContainerGrowShrink:function AG(AI,AL){var AH=mstrmojo.findAncestor(this,"fixedSizeCanGrowShrink",null,mstrmojo.DocSection),AK=AI||null,AJ=AL||null;if(AK||AJ){if(AH){AH.fixedSizeCanGrowShrink(this,AJ,AK);}}else{if(AH){AH.performCanGrowCanShrink([this],true);}}},_resizeScrollBoxWidth:function V(){var AL=this.scrollboxNode,AI=AL&&AL.style,AH=this._TB_CELL;if(this.useTouchScrolling||!AI||!AH){return ;}var AJ=this.widthLimit;if(!AJ){AI.width="auto";}var AK=function(){var AM=(mstrmojo.dom.isIE7?(AH.scrollWidth+1):(AH.scrollWidth+(AL.offsetWidth-AL.clientWidth)));if((AM&&(AM>0))&&(!AJ||(AJ&&(AM<AJ)))&&(AL.firstChild.firstChild.offsetWidth>=AL.clientWidth)){AI.width=AM+"px";}};if(mstrmojo.dom.isIE7){window.setTimeout(AK,1);}else{AK();}},onGridWidthChanged:function c(AI){if(!AI){this._resizeScrollBoxWidth();}var AH=this.widthLimit;if(!AH){this.width=p;}this._onContainerGrowShrink(AH,null);},getGridDimension:function R(AK){var AI=1,AJ=AK===AI?"Height":"Width",AL=AJ.toLowerCase(),AH=this[AL+"Limit"];if(!AH&&(this[AL]===p||this[AL]===0)){AH=this.viewport["offset"+AJ];this[AL]=AH+"px";return AH;}return AH||parseInt(this[AL],10);},_alignHeaders:function B(AH){var AJ=this.scrollboxLeft,AI=this.scrollboxTop;if(this.lockHeadersCase&&this.alignLockNodes){this.alignLockNodes(AJ,AI);}},defaultAction:function S(AM,AI){var AH=AI||this.getCellForNode(AM),AL=AM&&AM.className.indexOf("sc_")>0;if(this.model&&this.model.data&&this.model.data.visName&&this.model.data.visName==="InteractiveGridAjaxVisualizationStyle"){AL=this.isReselectedTD(AH);if(AL&&this.hasSelectAll&&this.hasSelectAll(AH)){this.IGCurrentSelectedCell=null;}else{this.IGCurrentSelectedCell=AH;}}var AK=this.model.getAction(this.getActionCells(AH),AM,AL),AJ=AK&&AK.h;this._currentSelectedTD=AM;if(AJ&&this.controller[AJ]){this.controller[AJ](this,AK.a);return true;}return false;},createZone:function l(AI){var AJ=AI||{},AH=this._super&&this._super(AJ);if(!AH){AH=new mstrmojo.XtabZone(AJ);}return AH;},_setupZone:function u(AL){this.zones={};if(!this.zone){this.zone=this.createZone({renderMode:this.dataRenderMode,cssText:"z-index: 1",slot:"scrollboxNode"});}var AH=this.zone;this.zones.origin=AH;AH.rh=AL.rh;AH.autoFitWindow=!!AL.afw;if(!this.isVIXtab){AH.tableCssClass="r-cssDefault"+(this.k?"_"+this.k:"");}AH.numColumnCanMerge=AL.gts&&AL.gts.cws?(AL.gts.cws.length-1):0;var AM=[],AJ=undefined,AN=null,AK,AI;mstrmojo.array.forEach(AL.gts&&AL.gts.row,function(AO){AK=AN&&AN.id===AO.id;if(AK){AM[AM.length-1]+=AO.fs&&AO.fs.length||1;}else{if(AO.otp===-1){AJ=0;mstrmojo.array.forEach(AM,function(AP){AJ+=AP;});}AM.push(AO.fs&&AO.fs.length||1);}AN=AO;});AH.acws=AM;AH.rowMerge=AL.gsi&&AL.gsi.prop&&AL.gsi.prop.rows&&AL.gsi.prop.rows.mg!=="0";AI=AL.ghs&&AL.ghs.chs;AH.headerOffset=AI&&(AI.show?(AI.items&&AI.items.length||1):0)-1;AH.mxPos=AJ;},getHACP:function AE(){return(this._super&&this._super())||new mstrmojo.XtabHACP();},_setupCP:function W(AN){var AK=this.titlesCP=this.getTitleCP(AN),AM=this.chsCP=this.getColumnHeadersCP(AN),AI=this.rhsCP=this.getRowHeadersCP(AN),AJ=this.valuesCP=this.getValuesCP(AN);AK.forceAutoRowHeight=AM.forceAutoRowHeight=AN.rh;var AQ=new mstrmojo.XtabVACP();var AH=this.getHACP();AH.cps=[AK,AM];AQ.cps=[AH];var AO=this.getHACP();AO.cps=[AI,AJ];AQ.cps.push(AO);var AP=AN.gmh&&AN.gmh.gmrh,AL=AN.rw&&AN.rw.row;if(AP&&AL){AQ.gsmh={};AQ.gemh={};AQ.gsmh[AL.bb]=AP.gsmh;AQ.gemh[AL.bb+AL.bc-1]=AP.gemh;}this.zone.cp=AQ;},ongridDataChange:function Z(){var AH=this.model;if(AH){AH.set("data",this.gridData);if(!this.dataBlocks){this.dataBlocks=[];}this.dataBlocks[0]=this.gridData;}},gridPagesRendered:function b(){if(this._super){this._super();}},getTitleCP:function G(AH){return this.initCP(AH,this.interactiveCellsArray,M);},getColumnHeadersCP:function AA(AH){return this.initCP(AH,this.interactiveCellsArray,AB,AH.ghs&&AH.ghs.chs,AH.gts&&AH.gts.col,X);},getRowHeadersCP:function AC(AH){var AI=this.initCP(AH,this.interactiveCellsArray,I,AH.ghs&&AH.ghs.rhs,AH.gts&&AH.gts.row,Q);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){J.call(this,this.rw&&this.rw.row);}this.rhsCPList=[AI].concat(this._onDemandCP.rhs);return AF(this.rhsCPList)||AI;}return AI;},getValuesCP:function a(AI){var AH=this.initCP(AI,this.interactiveCellsArray,g,AI.gvs,AI.gts&&AI.gts.col);if(this.onDemandIF&&this.rw){if(!this._onDemandCP){J.call(this,this.rw&&this.rw.row);}this.valuesCPList=[AH].concat(this._onDemandCP.vls);return AF(this.valuesCPList)||AH;}return AH;},createOnDemandCP:function f(AI,AJ,AH){var AK=new mstrmojo.XtabOnDemandCP();AK.dataSource=this;AK.blockNum=AI;AK.rc=AJ;return AK;},dataDownloaded:function T(AI,AO){var AQ=AO.blockNum,AH=this.rhsCPList[AQ],AJ=this.valuesCPList[AQ],AP=AI.data,AM=this.gridData;AP._bidx=AQ;this.dataBlocks[AQ]=AP;if(!AH||!AJ){return ;}this.initCP(AP,this.interactiveCellsArray,I,AP.ghs&&AP.ghs.rhs,AP.gts&&AP.gts.row,Q,AH);this.initCP(AP,this.interactiveCellsArray,g,AP.gvs,AM.gts&&AM.gts.col,null,AJ);AH.initContent();AJ.initContent();this.numRowsDownloaded+=parseInt(AH.rc,10);this.updateStatus(mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);var AL=this.zone;if(AL){var AN=AL.cp;if(AN){var AR=AP.gmh&&AP.gmh.gmrh,AK=AP.rw&&AP.rw.row;if(AR&&AK){AN.gsmh[AK.bb]=AR.gsmh;AN.gemh[AK.bb+AK.bc-1]=AR.gemh;}}AL.dataDownloaded();}},showDownloadStatus:function P(AH){if(!AH){return ;}if(this.showingStatus){this.numRowsToDownload+=AH;}else{this.numRowsToDownload=AH;this.numRowsDownloaded=0;}if(this.showStatus){this.showStatus(true,mstrmojo.desc(8301,"Retrieving Data ..."),this.numRowsDownloaded*100/this.numRowsToDownload);}},closeDownloadStatus:function j(){this.numRowsToDownload=0;if(this.showStatus){this.showStatus(false);}},download:function L(AK,AH){var AM=this.gridData.rw,AJ=AM.row,AL=AM.col,AI=AJ.bc;this.rhsCPList[AK].isDownloading=this.valuesCPList[AK].isDownloading=true;if(AI){this.controller.onDownloadGridData(this,this.model.getDownloadAction(AK*AI+1,AI,AL.bb,AL.bc,this.id,{blockNum:AK},AH));}},unrender:function E(AH){this.width=this.widthLimit=this.height=this.heightLimit=0;this.disconnectScrollbox(this);this._super(AH);},getCellForNode:function x(AI){var AH=AI&&parseInt(AI.getAttribute("ei"),10);if(isNaN(AH)){return null;}return this.interactiveCellsArray[parseInt(AH,10)];},getActionCells:function O(AH){var AI=[],AK=this.selections;var AL=AH.axis+"A"+(AH.ui+1),AM=AK[AL],AJ;if(AM&&AM[AH.o]){for(AJ in AM){var AN=this.getCellForNode(AM[AJ][0]);AI.push(AN);}}else{AI.push(AH);}return AI;},setModel:function AD(AH){this.model=AH;if(AH.data){this.set("gridData",AH.data);}},delegateGridAction:function A(AH,AI){if(this._shouldResponseToAction(AI)){AH(this.zone);}},_shouldResponseToAction:function v(AH){return AH!=="refreshOnDataDownloaded";},getTargetZone:function o(){return this.zone;},destroy:function w(){var AH=this.model;if(this.controller&&this.controller.addScrollPosition){this.controller.addScrollPosition(this.gridData.datasetId+"."+this.gridData.k,this.scrollboxLeft,this.scrollboxTop);}if(AH&&AH.destroy){AH.destroy();}this._super();}});mstrmojo.XtabBase.EnumLockedHeaders={OFF:Y,ROW:C,COL:z,BOTH:N};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.SearchableDropDownList","mstrmojo._IsTableLayoutListDIC","mstrmojo.TableLayoutList","mstrmojo._IsInputControl","mstrmojo.DynamicClassFactory");var M=mstrmojo.DynamicClassFactory.newComponent,G=mstrmojo.hash,J=mstrmojo.css,I=mstrmojo.dom,E=2,D=0,H=1,O=2;mstrmojo.SearchableDropDownListForListDIC=mstrmojo.declare(mstrmojo.SearchableDropDownList,null,{scriptClass:"mstrmojo.SearchableDropDownListForListDIC",markupString:'<div id="{@id}" class="mstrmojo-SearchableDropDownList mstrmojo-DropDownButton {@cssClass} {@direction}" style="{@cssText}"><div class="mstrmojo-DropDownButton-boxNode {@cssClass}-boxNode" title="{@title}"><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" tabindex="0" mstrAttach:mousedown,keyup>{@text}</div><table class="mstrmojo-InputNodeBar"><colgroup><col class="inputCol"/><col class="iconCol"/></colgroup><tr><td><input class="mstrmojo-SearchableDropDownList-inputNode" value="{@text}" placeholder="{@placeholderText}" mstrAttach:keyup,blur,click/></td><td><div class="mstrmojo-DropDownButton-iconNode {@cssClass}-iconNode" mstrAttach:mousedown></div></td></tr></table></div><div class="mstrmojo-DropDownButton-popupNode {@cssClass}-popupNode"></div><div class="curtain"></div></div>',markupSlots:G.copy({popupNode:function(){return this.domNode.children[1];},disableCurtainNode:function(){return this.domNode.lastChild;}},G.copy(mstrmojo.SearchableDropDownList.prototype.markupSlots)),markupMethods:G.copy({onenabledChange:function(){J.toggleClass(this.disableCurtainNode,"disabled",!!this.enabled);}},G.copy(mstrmojo.SearchableDropDownList.prototype.markupMethods)),init:function N(P){this._super(P);this.popupRef.children[0].onmousedown=function(){var R=this.parent,Q=R.opener;R.close();if(Q){Q.onPopupClosed();}};},postBuildRendering:function(){this.autofocus=false;this._super();},focus:function(){this.autofocus=true;this._super&&this._super();},onmousedown:function C(P){this._super&&this._super(P);if(I.isIE||I.isIEW3C){this.focus();}},openPopup:function(R,P){var Q=this.parent.showByDefault;this[R].popupConfig=new mstrmojo.ui.PopupConfig({hostElement:this.popupNode,isHostedWithin:false});this._super(R,P);if(Q){this.parent.setInfoWindowLock(true);}},popupRef:G.copy({onClose:function(){var P=this.opener.parent.showByDefault;if(P){this.opener.parent.setInfoWindowLock(false);}}},G.clone(mstrmojo.SearchableDropDownList.prototype.popupRef)),onPopupClosed:mstrmojo.emptyFn});function L(Q){var P=[];mstrmojo.array.forEach(Q,function(R){P.push(R.n);});return P;}mstrmojo.TableLayoutListForListDIC=M(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC],{scriptClass:"mstrmojo.TableLayoutListForListDIC",postBuildRendering:function A(){this._super&&this._super();J.toggleClass(this.domNode,"disabled",!this.enabled);}});function K(T,U,Q,S){var V=U.ipr||0,R=U.mint||"",P=U.maxt||"";return{0:{scriptClass:"mstrmojo.SearchableDropDownListForListDIC",cssDisplay:"block",searchEnabled:Q.length>=10,itemIdField:"v",fixWidth:true,fixHeight:true,postCreate:function(){var Y=this.value,X=U.ipt||D,Z=X===H?U.ust||"":"",W=mstrmojo.array.find(Q,"v",Y);if(W===-1||S){Y=(W===-1)?Y:undefined;Q=[{n:Z,v:Y}].concat(Q);W+=1;if(W===0){this.unset=true;}}this.items=Q;this.selectedIndex=W;this.set("value",Q[W].v);if(this.parent.showByDefault&&this.searchEnabled){this.applyChange=function(){if(this.value!=this.parent.value){this.parent.set("value",this.value);}else{this.items=this.allItems;this.set("text",this.text);}};this.onvalueChange=function(){};if(I.isIE||I.isIEW3C){this.onPopupClosed=function(){this.applyChange&&this.applyChange();};}}},onblur:function(W){this.applyChange&&this.applyChange();},onEnter:function(){this.applyChange&&this.applyChange();},onEsc:function(){this.items=this.allItems;this.set("value",this.parent.value);},getDisplayValue:function(){return this.items.length&&this.items[this.selectedIndex===-1?0:this.selectedIndex].n;},isPopupClosed:function(){return !(this.popupRef&&this.popupRef.visible);},bindings:{enabled:"this.parent.enabled"}},1:{scriptClass:"mstrmojo.TableLayoutListForListDIC",styleCssClass:"radio",itemsPerRow:V,items:Q,getDisplayValue:function(){return this.items[this.selectedIndex].n;},bindings:{enabled:"this.parent.enabled"}},2:{scriptClass:"mstrmojo.TableLayoutListForListDIC",styleCssClass:"check",delim:",",multiSelect:true,itemsPerRow:V,items:Q,getDisplayValue:function(){return"";},bindings:{enabled:"this.parent.enabled"}}}[T||0];}mstrmojo.ListDIC=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.ListDIC",tabIndex:0,markupString:'<div class="mstrmojo-ListDIC {@cssClass}" tabIndex="{@tabIndex}" mstrAttach:focus></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onwidthChange:function(){if(this.dicWidget&&this.width){this.dicWidget.set("width",this.width);}},onheightChange:function(){if(this.dicWidget&&this.height){this.dicWidget.set("height",this.height);}}},init:function(P){this._super(P);this.style=this.dic.st;this.items=this.getItems();this.set("children",[mstrmojo.hash.copy(K(this.style,this.dic,this.items,this.dic.ipt===E),{alias:"dicWidget",value:this.value,onvalueChange:function(){if(this.value!=this.parent.value){this.parent.set("value",this.value);}}})]);if(this.dicWidget.setDirtyFlag){this.setDirtyFlag=function(R,Q){this.dicWidget.setDirtyFlag(R,Q);};}},getDisplayValue:function F(){var P=this.dicWidget.getDisplayValue();return(P!=null)?P:this.dv;},onfocus:function(P){this.focus();},focus:function(){var P=this;if(mstrmojo.dom.isIE){setTimeout(function(){P.dicWidget.focus&&P.dicWidget.focus();},10);}else{P.dicWidget.focus&&P.dicWidget.focus();}},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.dicWidget.set("height",(this.openerStyle.ih||0)+"px");this.dicWidget.set("width",(this.openerStyle.iw||0)+"px");}},applyChanges:function(){var P=this._super();if(this.canSlice){var R={type:parseInt(this.dic.ct,10),src:this.dic.k,ctlKey:this.dic.ckey,include:this.dic.include,tks:this.dic.tks,ck:this.dic.ck,disablePU:false};var Q=this;window.setTimeout(function(){Q.owner.model.sendTransactionUpdates(R);},0);}return this.style?P:this.dicWidget.isPopupClosed();},cleanup:function B(){if(!this.style){this.dicWidget.closePopup();}},isDicWidgetReady:function(){return this.dicWidget;}});})();(function(){mstrmojo.requiresCls("mstrmojo.TreeNode","mstrmojo._IsExprNode","mstrmojo.array","mstrmojo.dom","mstrmojo.css","mstrmojo.expr","mstrmojo._HasOwnAvatar");var F=mstrmojo.array,M=mstrmojo.expr,P=mstrmojo.dom,A=mstrmojo.css;function J(R,Q){var T=R.data,S=T&&T.nds;if(!S){return null;}if(Q){Q.sort(F.numSorter);}else{Q=R.sortSelectedIndices();}if(!Q.length){return null;}return{idxs:Q,nds:F.get(S,Q)};}function N(S){var R=S.ctxtBuilder,U=R&&R.itemWidgets,Q=U&&U[0],T=Q&&Q.data;if(T&&T.not&&(U.length>0)){delete T.not;Q.paint();}}mstrmojo.AndOrNode=mstrmojo.declare(mstrmojo.TreeNode,[mstrmojo._IsExprNode,mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.AndOrNode",data:null,editable:false,prefixedAndOrEditable:false,markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},prefixAndOrToolsNode:function(){return this.domNode.firstChild.childNodes[1];},itemsContainerPrefix:function(){return this.domNode.childNodes[1];},itemsContainerNode:function(){return this.domNode.childNodes[2].firstChild;},dropCueNode:function(){return this.domNode.childNodes[2].lastChild;},itemsContainerSuffix:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode;}},markupMethods:{onitemCntChange:function(){A.toggleClass(this.itemsContainerNode,["multi"],this.itemCnt>2);},onprefixedAndOrEditableChange:function(){A.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();},ondropCuePosChange:mstrmojo.TreeNode.prototype.markupMethods.ondropCuePosChange},multiSelect:true,itemIdField:null,init:function(Q){this._super(Q);this.markupString=this.markupString.replace("{@_prefixAndOrToolsMarkup}",this.getPrefixAndOrToolsMarkup());var R=this.data;if(R){delete this.data;this._set_data(null,R);}},itemCnt:0,postBuildRendering:function(){var Q;this.set("itemCnt",this.items.length);if(this._super){Q=this._super();}N(this);return Q;},preadd:function L(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},preremove:function O(Q){if(this._super){this._super(Q);}this.set("itemCnt",this.items.length);N(this);},_set_data:function(T,Q){var R=this.data,S=(R!==Q);if(S){this.data=Q;if(Q&&!Q.nds){Q.nds=[];}this.set("items",Q&&Q.nds);}return S;},isDragValid:function K(){return true;},isSelectableArea:function(Q){return false;},getDragData:function(Q){var S=this._super(Q);if(S&&!S.html){var R=S.et&&M.ET2TGT[S.et];S.html=R?S[R]&&S[R].n||"":S.n||"";}return S;},remove:function I(R,S){var Q=this._super(R);if(Q>-1){var T=S||this.suppressConsolidation;if(!T){this.consolidate(false);}}return Q;},move:function(R,Q){this.suppressConsolidation=true;var S;if(this._super){S=this._super(R,Q);}this.suppressConsolidation=false;return S;},consolidate:function E(){var U=this.parent;if(!U||!U.remove){return ;}var S=this.items,R=S&&S.length;if(R<2){var T=R?S[0]:null,Q=this.childIndex();if(T){U.add([T],Q);}U.remove(this.data);}},indent:function G(S,Q){var R=J(this,S);if(!R){return ;}this.remove(R.idxs,true);var W=R.nds,V=Q&&Q.fn||this.data&&this.data.fn,U={et:M.ET.ANDOR,nds:W,fn:V};if(W.length===2&&W[0].not){if(W[1].not){delete W[0].not;delete W[1].not;U.not=true;U.fn=(V===M.FN.AND?M.FN.OR:M.FN.AND);}else{var T=W[0];W[0]=W[1];W[1]=T;}}this.add([U],R.idxs[0]);this.consolidate(false);},outdent:function C(R){var S=this.parent,Q=S&&S.data;if(!Q||Q.et!==M.ET.ANDOR){return ;}var T=J(this,R);if(!T){return ;}this.remove(T.idxs,true);if(this.data.not){T.nds[0].not=true;}S.add(T.nds,this.childIndex());this.consolidate(false);},edit:function D(Z,a,S){if(!Z){return ;}var Y=this.data,X=Y&&Y.fn,R=Z.data,f=R&&R.not;if(!R){R={};Z.data=R;}R.not=!!S;if(X!==a){var Q=Y.nds;if(Q&&Q.length>2){var e=Z.childIndex();if(e>0){this.indent([e-1,e],{fn:a});}}else{Y.fn=a;var V=this.ctxtBuilder,U=V&&V.itemWidgets;for(var T=0,W=(U&&U.length)||0;T<W;T++){var b=U[T];if(b){b.paint();}}}}else{Z.paint();}},preclick:function H(Q){var S=null,R=P.eventTarget(Q.hWin,Q.e);if(R===this.prefixNode){}else{if(P.contains(this.prefixNode,R,true)){S="andor";}}Q.part=S;},createAvatar:function B(S){var R=document.createElement("div"),T=P.findWidget(S),Q=T.getAvatarNode&&T.getAvatarNode();if(!Q){Q=T.condNode.cloneNode(true);Q.style.boxSizing="border-box";Q.style.width=T.condNode.offsetWidth+"px";}R.appendChild(Q);A.addClass(R,T.avatarCssCls||"mstrmojo-FE mstrmojo-ConditionNode");R.style.zIndex=20;return R;},_ndsToMove:J});})();(function(){mstrmojo.requiresCls("mstrmojo.WidgetList","mstrmojo.WidgetTreeBuilder","mstrmojo.TreeNodeSelector");var E=false;mstrmojo.WidgetTree=mstrmojo.declare(mstrmojo.WidgetList,null,{scriptClass:"mstrmojo.WidgetTree",listBuilder:mstrmojo.WidgetTreeBuilder,listSelector:mstrmojo.TreeNodeSelector,renderOnScroll:true,itemIdField:"dssid",itemDisplayField:"n",itemIconField:"tp",itemChildrenField:"items",itemFunction:function D(L,I,J){if(!E){mstrmojo.requiresCls("mstrmojo.TreeNode");E=true;}var H=J.tree||J,K=new mstrmojo.TreeNode({data:L,state:0,parent:J,tree:H,multiSelect:J.multiSelect,text:L[J.itemDisplayField],textCssClass:H.item2textCss(L),items:L[J.itemChildrenField],itemIdField:J.itemIdField,itemDisplayField:J.itemDisplayField,itemIconField:J.itemIconField,itemChildrenField:J.itemChildrenField,itemFunction:J.itemFunction,listSelector:J.listSelector});return K;},item2textCss:function B(H){return H[this.itemIconField];},selectionParentNode:null,init:function F(H){this._super(H);this.selectionParentNode=this;this.tree=this;},clearTreeSelect:function A(){(this.selectionParentNode||this).clearSelect();},prechange:function G(H){var I=this._super(H);this.onnodechange(H);return I;},onnodechange:function C(I){if(!I){return ;}var J=mstrmojo.hash,M=this.selectionParentNode,L=I.src;if(L===M){if(J.isEmpty(L.selectedIndices)){L=this;this.selectionParentNode=this;}this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:I.removed});}else{if(I.added&&I.added.length){var K=[];if(!J.isEmpty(M.selectedIndices)){K=mstrmojo.hash.keyarray(M.selectedIndices,true);M.clearSelect();}this.selectionParentNode=L;this.raiseEvent({name:"selectionChange",parentNode:L,parentNodeWas:M,added:I.added,removed:K});}else{}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.css","mstrmojo.hash","mstrmojo.fx","mstrmojo.TreeNode");var K=mstrmojo.dom,E={0:"closed",1:"opened",2:"leaf"},I=function(R,Q){var N=R.style,M,P,L,S,O;N.display="block";N.height="auto";M=R.offsetHeight;P=Q?M:0;L=Q?0:M;S=Q?"block":"none";N.overflow="hidden";O=new mstrmojo.fx.AnimateProp({target:R,props:{height:{start:L,stop:P,suffix:"px",fn:Math.round,ease:mstrmojo.ease.linear}},onEnd:function(){N.height="auto";N.display=S;},interval:30,duration:300});O.play();};mstrmojo.TreeBrowserNode=mstrmojo.declare(mstrmojo.TreeNode,null,{scriptClass:"mstrmojo.TreeBrowserNode",markupString:'<div id="{@id}" class="mstrmojo-TreeNode {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,click,dblclick><div class="mstrmojo-TreeNode-div"><img class="mstrmojo-TreeNode-state" src="../images/1ptrans.gif" /><img class="mstrmojo-TreeNode-checkBox" src="../images/1ptrans.gif" /><span class="mstrmojo-TreeNode-text {@textCssClass}"></span></div><div class="mstrmojo-TreeNode-itemsContainer">{@itemsHtml}</div></div>',markupSlots:mstrmojo.hash.copy({displayNode:function(){return this.domNode.firstChild;},checkBoxNode:function(){return this.domNode.firstChild.childNodes[1];}},mstrmojo.TreeNode.prototype.markupSlots),markupMethods:mstrmojo.hash.copy({onstateChange:function(L){this.stateNode.className="mstrmojo-TreeNode-state "+(E[this.state]||"closed");if(this.tree.anim&&this.contentRetrieved&&!L){I(this.itemsContainerNode,this.state===1);}else{this.itemsContainerNode.style.display=(this.state===1)?"block":"none";}}},mstrmojo.TreeNode.prototype.markupMethods),blockBegin:1,allowUnlistedValues:false,contentRetrieved:false,_set_items:function(N,M){var L=this._super(N,M);if(L&&this.tree.anim){I(this.itemsContainerNode,true);}return L;},onstateChange:function J(){var L=this.tree;if(!this.contentRetrieved&&(this.state==1)){this.set("items",[L.loadingItemCreaterFunc()]);L.getContent(this,this.blockBegin);}else{if((this.state==1)&&L.onNodeExpand){L.onNodeExpand(this);}if((this.state==0)&&L.onNodeCollapse){L.onNodeCollapse(this);}}},toggleState:function G(){if(this.state!==2){this.set("state",this.state===1?0:1);}},preclick:function H(L){K.clearBrowserHighlights(L.hWin);return false;},predblclick:function D(L){K.clearBrowserHighlights(L.hWin);return false;},premousedown:function B(M){var R=mstrmojo.dom,O=mstrmojo.dom.eventTarget(M.hWin,M.e),L=this.tree,N=(this.state==2),Q=R.contains(this.itemsContainerNode,R.eventTarget(M.hWin,M.e),true,this.domNode),P=(L.branchClickPolicy==mstrmojo.TreeBrowserEnum.BRANCH_POLICY_TOGGLE);if((this.isSpecialNode()||!(O==this.checkBoxNode||((O==this.textNode||O==this.displayNode)&&(N||!P))))&&!this.draggable){R.stopPropogation(M.hWin,M.e);}if((O==this.stateNode)||((O==this.textNode||O==this.displayNode)&&!N&&P)){if(!N){this.toggleState();}}else{if(O==this.checkBoxNode||Q){if(this._super){this._super(M);}}else{this.handleNodeClicked();}}},isSpecialNode:function C(){var L=this.data&&this.data.st;return(L<0);},handleNodeClicked:function F(){var L=this.tree,M=this.parent,N=this.data;switch(N&&N.st){case"-4":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin-L.blockCount);break;case"-3":mstrmojo.css.addClass(this.textNode,["loading"]);L.getContent(M,M.blockBegin+L.blockCount);break;case"-1":case"-2":break;default:if(L.handleNodeClicked){L.handleNodeClicked(N);}}},init:function(L){this._super(L);this.set("state",this.tree.isBranch(this.data)?0:2);},postBuildRendering:function A(){if(this._super){this._super();}var L=function(M){K.preventDefault(window,M||window.event);return false;};K.attachEvent(this.domNode,"mousedown",L);if(this.isSpecialNode()||this.tree.noCheckBox){this.checkBoxNode.style.display="none";}}});})();(function(){mstrmojo.requiresCls("mstrmojo.HTMLButton","mstrmojo._HasContextMenu","mstrmojo.ContextMenu");mstrmojo.MenuButton=mstrmojo.declare(mstrmojo.Button,[mstrmojo._HasContextMenu],{preclick:function A(B){this.showContextMenu();},openPopupMenu:function(){this.showContextMenu();}});})();(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.Box","mstrmojo.ElasticTextArea","mstrmojo.hash","mstrmojo.css");var G=4,F=5,E=6,C=7,B=10;var D=mstrmojo.hash,A=mstrmojo.css;mstrmojo.TextAreaDIC=mstrmojo.declare(mstrmojo.Box,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TextAreaDIC",applyOnEnter:false,onfontChange:function(){var H=this.font;if(this.etab){this.etab.set("font",H);}else{if(this.eta){this.eta.set("font",H);}}},focus:function(){if(this.eta){this.eta.focus();}else{if(this.etab){this.etab.premousedown();}}},init:function(J){if(this._super){this._super(J);}if(this.showByDefault){var I,K=this.dic;if(K.siwc){I={cssText:"position:relative;min-height:18px;",ontextChange:function(){this.preview.set("text",this.text);},onvalueChange:function(){if(K.sp){var L=this.value,M=this.dv||"",O="",N="";switch(this.ts){case E:N="mailto:";case F:O=L.substring(0,K.pl);this.dv=O=M.replace(/(.*href=['"])(.*)(['"].*>)(.*)(<.*)/i,"$1"+N+L+"$3"+O+"$5");break;default:O=M.substring(0,K.pl);break;}this.preview.set("text",(K.pl>0&&M.length>K.pl)?O+"...   ":(K.pl>0&&O.length>0)?O:"");}if(this.etab.domNode){if(this.value&&this.value.length!==0){A.addClass(this.etab.domNode,"filled");}else{A.removeClass(this.etab.domNode,"filled");}}this.etab.value=this.value;this.applyChanges();},onpopupwidthChange:function(){this.etab.set("popupWidth",this.popupwidth||200);},onheightChange:function(){if(this.height){this.domNode.style.height=this.height+"px";}}};}else{I={cssText:"position:relative",onpopupwidthChange:function(){this.eta.set("width",(this.popupwidth-4)||200);},onheightChange:function(){if(this.domNode&&this.height){this.domNode.style.height=this.height+"px";this.eta.set("height",this.height-4);}}};}D.copy(I,this);if(K.siwc){this.addChildren([{alias:"preview",scriptClass:"mstrmojo.Label"},{alias:"etab",popupToBody:true,maxLength:K.ml||250,cssText:"position:absolute;right:0;top:0px",bindings:{enabled:"this.parent.enabled"},onvalueChange:function(){if(this.value!==this.parent.value){var M=this.parent,L="";switch(M.ts){case E:L="mailto:";case F:if(!M.dv){M.dv='<a href="mailto:"></a>';}var N=/(.*href=['"])(.*)(['"].*>)(.*)(<.*)/i;M.set("dv",M.dv.replace(N,"$1"+L+this.value+"$3"+this.value+"$5"));break;default:M.set("dv",this.value);break;}M.set("value",this.value);}},lockAutoClose:function(){var L=this.parent.showByDefault;if(L){this.parent.setInfoWindowLock(true);}},unlockAutoClose:function(){var L=this.parent.showByDefault;if(L){this.parent.setInfoWindowLock(false);}},premousedown:function(){var M=!this.popupRef.hasRendered;mstrmojo.ElasticTextAreaButton.prototype.premousedown.apply(this,arguments);if(M){var L=this.popupRef,N=this.parent;mstrmojo.dom.attachEvent(L.domNode,"keydown",function(O){var P=O||window.event;if(P.keyCode==9){L.close();N.onTabDown(O);}});}},scriptClass:"mstrmojo.ElasticTextAreaButton"}]);}else{var H=K.vm?{scriptClass:"mstrmojo.TextAreaValidation",dic:K}:{scriptClass:"mstrmojo.TextArea"};this.addChildren(D.copy(H,{alias:"eta",maxLength:K.ml||250,onheightChange:function(){if(this.hasRendered&&this.height){this.domNode.style.height=this.height+"px";}},onfontChange:function(){if(this.hasRendered&&this.font){D.copy(this.font,this.domNode.style);}},onblur:function(){if(!this.validate){this.parent.set("value",this.value);}else{this.validate();if(!this.isValid()){this.handleInvalid();}else{this.parent.set("value",this.value);}}},onwidthChange:function(){if(this.hasRendered&&this.width){this.domNode.style.width=this.width+"px";}},placeholderText:this.placeholderText,bindings:{value:"this.parent.value",enabled:"this.parent.enabled"}}));}this.onvalueChange();}else{this.addChildren({alias:"eta",scriptClass:"mstrmojo.ElasticTextArea",maxLength:this.dic.ml,value:this.value,onvalueChange:function(){this.parent.set("value",this.value);},bindings:{enabled:"this.parent.enabled"}});this.onpopupwidthChange=function(){this.eta.set("width",(this.popupwidth-4)||200);};}},postBuildRendering:function(){this._super();var H=this.dic;if(!mstrmojo.isDescendant(this.owner,this)){if(this.showByDefault&&!H.siwc){this.set("height",this.openerStyle.ih);this.set("popupwidth",this.openerStyle.iw);}else{if(H.wm&&H.w){this.set("popupwidth",H.w);}}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor");function C(E,F){var D=this;if(mstrApp&&mstrApp.serverRequest){mstrApp.serverRequest(E,F,{silent:true});}else{mstrmojo.xhr.request("POST",D.path,F,E,undefined,D.XServer,D.baseParams);}}function A(H,I,G,D){var E=this,F={taskId:"createFolder",taskContentType:"json",folderID:H,name:I,description:G};C.call(E,F,D);}function B(E,I,F){if(!E){mstrmojo.alert(mstrmojo.desc(3380));return false;}var G=this,H=G.fId,D={success:function(J){G.contPanel.name.set("value","");G.contPanel.desc.set("value","");if(G.okFn){G.okFn(J,F);}},failure:function(J){if(J.getResponseHeader){mstrmojo.alert(J.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};if(mstrApp.isSingleTier&&this.dp){this.dp.newFolder(H,E,I,D);}else{A.call(G,H,E,I,D);}}mstrmojo.NewFolderEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.NewFolderEditor",cssClass:"mstrmojo-NewFolderEditor",title:mstrmojo.desc(663,"Create Folder"),help:"Create_a_new_folder.htm",navigateAfter:false,okFn:mstrmojo.emptyFn,path:mstrConfig.taskURL,fId:null,children:[{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"btns",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",alias:"ok",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent,G=E&&E.opener,D=E.contPanel.name.value,F=E.contPanel.desc.value;if(!B.call(E,D,F,E.navigateAfter)){E.close();}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.string","mstrmojo._HasPopup","mstrmojo.ListBase","mstrmojo.Popup","mstrmojo.Editor","mstrmojo.SuggestionList");function D(Y){var X=this.list,V=X.selectedIndex,U=X.items.length,W=Y?U-1:0;if(V===W){X.clearSelect();return ;}if(V===null||V<0){V=Y?0:U-1;}else{V+=Y?1:-1;}X.singleSelect(V);}mstrmojo._HasSuggestion=mstrmojo.provide("mstrmojo._HasSuggestion",mstrmojo.hash.copy(mstrmojo._HasPopup,{blockBegin:1,blockCount:-1,suggestCount:15,autoSelect:true,itemField:"n",candidates:null,suggestionShown:false,suggestionItems:null,_last_hit:null,_request_pattern:null,browseItemVisible:false,folderLinksContextId:25,browsableTypes:"1,8",REQUEST_THRESHOLD:20,noCache:false,disableClick:false,getCandidatesThroughTaskCall:mstrmojo.emptyFn,onSuggestionItemSelect:function J(U){this.hideSuggestion();},getSearchPattern:function T(){return"";},getSuggestionPos:function N(){return{left:"100px",top:"100px"};},getSuggestionTarget:function G(){return this;},showSuggestion:function B(V){var U=this.getSuggestion(V);if(!this.noCache&&U!==-1){this.updateSuggestion(U);}},hideSuggestion:function C(){this.suggestionShown=false;if(this.suggestionPopup.visible){this.suggestionPopup.close();}},getSelected:function M(){return(this.suggestionShown)?this._lastOpened.getSelected():null;},nextHighlight:function E(){if(this.suggestionShown){this._lastOpened.nextHighlight();}},preHighlight:function H(){if(this.suggestionShown){this._lastOpened.preHighlight();}},getSuggestion:function S(h){var d=this.candidates,a=d&&d.items,X=d&&d.isComplete,g=this._last_hit;if(!this.noCache&&(d||g)){var f=this.filterCandidates(a,h,this.REQUEST_THRESHOLD),b=f.length,e=this.suggestCount,U=false;if(!X&&b<e){var V=g&&g.pattern;if(g&&V&&(h.indexOf(V)>-1)){U=true;var k=this.filterCandidates(g.items,h,this.REQUEST_THRESHOLD),Y=k&&k.length,W=mstrmojo.array,j=this.itemField,Z;for(Z=0;Z<Y;Z++){if(W.find(f,j,k[Z][j])===-1){f.push(k[Z]);}}b=f.length;}}if(!X&&((h.length>2&&b<this.REQUEST_THRESHOLD)||(b<e))){this.requestCandidates(h);return -1;}return(b<e)?f:f.slice(0,e);}this.requestCandidates(h);return -1;},requestCandidates:function A(U){this._request_pattern=U;var X=this,V=this.getSuggestionTarget(),W={success:function(e){if(!e){return ;}var d=X.getSuggestionTarget();if(!d||(V!==d)){return ;}var j=d.getSearchPattern(),a=e.items;X._last_hit={items:a,pattern:U};X.sz=e.sz;if(!X.noCache&&a){var f=(X.candidates&&X.candidates.items)||[],g=[].concat(a),b=a.length,Z;for(Z=0;Z<b;Z++){var Y=g[Z];if(mstrmojo.array.indexOf(f,Y)>-1){mstrmojo.array.removeItem(a,Y);}}if(X.candidates){X.candidates.items=f.concat(a);}}if(j&&j.indexOf(U)>-1){var h=X.filterCandidates(a,j);X.updateSuggestion(h);}},failure:function(Y){if(Y.getResponseHeader){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};this.getCandidatesThroughTaskCall({pattern:U,blockBegin:this.blockBegin,blockCount:this.blockCount,isSuggest:true},W);},filterCandidates:function Q(X,W,U){U=U||this.suggestCount;W=mstrmojo.string.regEscape(W);var Y=this.itemField,V=mstrmojo.array.filter(X,function(Z){return(new RegExp("\\s"+W+"|^"+W,"i")).test(Z[Y]);},{max:U});return V;},getHighlightedText:function P(W,Z){if(!this.highlightPattern||mstrmojo.string.isEmpty(W)){return Z;}try{if(!this.nameWildcards||mstr.$A.find([2,32],parseInt(this.nameWildcards,10))>-1){Z=Z.replace(new RegExp("(^|\\s)("+W+")","gi"),"$1<b>$2</b>");}else{var Y=W.split(" "),V,U;for(V=0,U=Y.length;V<U;V++){if(Y[V]!==""){Z=Z.replace(new RegExp("("+Y[V]+")","gi"),"<b>$1</b>");}}}}catch(X){}return Z;},updateSuggestion:function O(X){var V=X&&X.length,U=this.browseItemVisible;if(V||U){if(U){X=X||[];X.push({n:"Browse...",t:-99,cssClass:(V?"br":"bro")});}this.set("suggestionItems",X);if(this.suggestionShown){var W=this._lastOpened;if(W&&W.nudge){W.nudge();}if(this.autoSelect&&W){W.list.singleSelect(0);}}else{this.openPopup("suggestionPopup",this.getSuggestionPos());this.suggestionShown=true;}}else{this.hideSuggestion();}},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",onClose:function(){var U=this.opener;if(U&&U.onBrowserClose){U.onBrowserClose();}},onOpen:function(){var U=this.opener;if(U&&U.onBrowserOpen){U.onBrowserOpen();}},children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},onBrowserClose:function L(){this.browserShown=false;},handleSuggestionItemSelect:function K(U,V){if(this.browseItemVisible&&U.t===-99){this.hideSuggestion();mstrmojo.requiresCls("mstrmojo.ObjectBrowser");var W=this.zIndex;this.openPopup("ob",{zIndex:(W&&(W+10))||110});this.ob.browser.browse(mstrmojo.hash.copy(V,{folderLinksContextId:this.folderLinksContextId,onSelectCB:[this,"onSuggestionItemSelect"],browsableTypes:this.browsableTypes}));this.browserShown=true;}else{this.onSuggestionItemSelect(U);}},highlightPattern:true,suggestionPopupCssClss:"",suggestionPopup:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-ObjectInputBox-suggest",autoClose:true,locksHover:true,nextHighlight:function(){D.call(this,true);},preHighlight:function(){D.call(this,false);},getSelected:function M(){var U=this.list;return U.items[U.selectedIndex];},onOpen:function I(){var U=this.opener;if(U){mstrmojo.css.addClass(this.domNode,U.suggestionPopupCssClss||"");if(U.autoSelect){this.list.singleSelect(0);}if(U.nudge){U.nudge(this);}}},onClose:function F(){this.list.clearSelect();var U=this.opener;if(U){U.suggestionShown=false;mstrmojo.css.removeClass(this.domNode,U.suggestionPopupCssClss||"");}}},suggestionListClass:"mstrmojo.SuggestionList",postApplyProperties:function R(){this.suggestionPopup.children=[{scriptClass:this.suggestionListClass,alias:"list",cssClass:"mstrmojo-suggest-list"}];}}));}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Editor","mstrmojo.Box","mstrmojo.CheckBox","mstrmojo.Label","mstrmojo.Button");mstrmojo.requiresDescs(4531,8262,12437,12438,12439);var D=mstrmojo.hash;var E={Automatic:0,Manual:3};var I={Automatic:-1,False:0,True:1};var H={Automatic:-1,False:1,True:2};var F={mps:{afb:I.False,sfb:H.False,fbf:E.Automatic}};var B=["mps"],K=function(P,N){var O=this.parent.parent,L=O.cloneModel,M=L.mps||{};if(M[P]!==N){M[P]=N;O.set("dirty",true);}};mstrmojo.ME.DerivedMetricOptions=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.DerivedMetricOptions",cssClass:"mstrmojo-DerivedMetricOptions",dirty:false,init:function J(L){this._super(L);mstrmojo.css.addWidgetCssClass(this,"dme");},updateModel:function C(){var M=this.model,L=this.cloneModel,N=L.mps;if(N.fbf===E.Automatic){N.afb=I.Automatic;N.sfb=H.Automatic;}N.dirty=true;M.mps=L.mps;},onOpen:function A(){var N=this.cloneModel||{};D.make(N,mstrmojo.Obj);var M=mstrmojo.hash.copy(this.model,mstrmojo.hash.copy(F)),O,L;for(O=0,L=B.length;O<L;O++){N.set(B[O],D.clone(M[B[O]]));}this.cloneModel=null;this.set("cloneModel",N);},onClose:function G(){this.set("dirty",false);delete this.cloneModel;},children:[{scriptClass:"mstrmojo.HBox",alias:"fbFlagBox",cssClass:"mstrmojo-DerivedMetricOptions-aggBox",children:[{scriptClass:"mstrmojo.Label",cssText:"white-space: nowrap; margin-right: 8px; vertical-align: top;",text:mstrmojo.desc(12437,"Aggregation And Subtotal Behavior:")},{scriptClass:"mstrmojo.Pulldown",alias:"fbFlag",cssText:"min-width: 100px;",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",itemIdField:"v",items:[{n:mstrmojo.desc(4531,"Automatic"),v:E.Automatic},{n:mstrmojo.desc(8262,"Manual"),v:E.Manual}],bindings:{value:function(){return this.parent.parent.cloneModel.mps.fbf||E.Automatic;}},onvalueChange:function(L){if(L.value!==undefined&&L.valueWas!==undefined){K.call(this,"fbf",L.value);}}}]},{scriptClass:"mstrmojo.Box",cssText:"height: 30px",cssClass:"mstrmojo-DerivedMetricOptions-afbBox",children:[{scriptClass:"mstrmojo.CheckBox",alias:"afb",cssDisplay:"inline-block",label:mstrmojo.desc(12438,"Aggregate From Base"),bindings:{visible:function(){return this.parent.parent.fbFlagBox.fbFlag.value===E.Manual;},checked:function(){return this.parent.parent.cloneModel.mps.afb===I.True;}},onclick:function(L){var M=this.parent.parent.fbFlagBox.fbFlag.value;K.call(this,"afb",M===E.Automatic?I.Automatic:(this.checked?I.True:I.False));}},{scriptClass:"mstrmojo.CheckBox",alias:"sfb",cssDisplay:"inline-block",label:mstrmojo.desc(12439,"Subtotals From Base"),oncheckedChange:function(L){var M=this.parent.afb;if(L.value){M.checked=I.True;M.onclick();if(M.inputNode){M.inputNode.checked=true;M.inputNode.disabled=true;}}else{if(M.inputNode){M.inputNode.disabled=false;}}},bindings:{visible:function(){return this.parent.parent.fbFlagBox.fbFlag.value===E.Manual;},checked:function(){return this.parent.parent.cloneModel.mps.sfb===H.True;}},onclick:function(){var L=this.parent.parent.fbFlagBox.fbFlag.value;K.call(this,"sfb",L===E.Automatic?H.Automatic:(this.checked?H.True:H.False));}}]},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"saveokButton",text:mstrmojo.desc(2397,"OK"),bindings:{enabled:function(){return this.parent.parent.dirty;}},onclick:function(){var L=this.parent.parent;L.updateModel();if(L.onOK){L.onOK();}L.close();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancel"),onclick:function(){var L=this.parent.parent;L.close();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo._IsInputControl","mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo.dom","mstrmojo.hash","mstrmojo.css");var A=mstrmojo.dom,B=mstrmojo.css,D=mstrmojo.hash,C={0:"default",1:"stars_dots"};mstrmojo.RatingDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.RatingDIC",styleCssClass:"rate",markupString:'<div id="{@id}" class="mstrmojo-ListBase {@cssClass}" style="{@cssText}" mstrAttach:click,mouseover,mouseout><div class="{@icnCss}" style="{@icnCssText}">{@itemsHtml}</div></div>',lastIdx:null,init:function(E){this._super(E);this.items=this.getItems();this.starCount=this.items&&this.items.length;B.addWidgetCssClass(this,C[this.dic.stl||0]);},setRating:function(E){var G=0,H=this.starCount,F="less_equal";if(this.lastIdx==undefined||this.lastIdx!=E){for(G;G<H;G++){if(G<=E){B.addClass(this._getItemNode(G),F);}else{B.removeClass(this._getItemNode(G),F);}}this.lastIdx=E;}},onvalueChange:function(){this._super&&this._super();var E=mstrmojo.array.find(this.items,"v",this.value);this.setRating(E);},onmouseover:function(F){this._super&&this._super(F);var G=F.target||A.eventTarget(F.hWin,F.e),E=G&&G.getAttribute("idx");if(E!=undefined){this.setRating(E);}},onmouseout:function(F){this._super&&this._super(F);var E=mstrmojo.array.find(this.items,"v",this.value);this.setRating(E);},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}var E=mstrmojo.array.find(this.items,"v",this.value);if(E>-1){this.setRating(E);}B.toggleClass(this.domNode,"disabled",!this.enabled);}});}());(function(){mstrmojo.requiresCls("mstrmojo.TableLayoutList","mstrmojo._IsTableLayoutListDIC","mstrmojo._IsInputControl","mstrmojo.css");function A(F){var E=[];mstrmojo.array.forEach(F,function(G){E.push(G.n);});return E;}var C=mstrmojo.css;mstrmojo.LikertScaleDIC=mstrmojo.declare(mstrmojo.TableLayoutList,[mstrmojo._IsTableLayoutListDIC,mstrmojo._IsInputControl],{scriptClass:"mstrmojo.LikertScaleDIC",styleCssClass:"scale",init:function(E){this._super(E);this.items=this.getItems();this.titleItems=A(this.items);},getDisplayValue:function B(){return(this.selectedIndex>=0)?this.items[this.selectedIndex].n:this.dv;},getLeftEndTitle:function D(E){return E>=0?(this.dic.mint||""):"";},getRightEndTitle:function(E){return E>=0?(this.dic.maxt||""):"";},postBuildRendering:function(){this._super();if(!mstrmojo.isDescendant(this.owner,this)&&this.showByDefault){this.set("height",(this.openerStyle.ih||0)+"px");this.set("width",(this.openerStyle.iw||0)+"px");}C.toggleClass(this.domNode,"disabled",!this.enabled);}});}());(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz","mstrmojo.hash");mstrmojo.CheckList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.CheckList",inputType:"checkbox",cssClass:"mstrmojo-CheckList",itemCssClass:"mstrmojo-CheckList-item"});mstrmojo.requiresCls("mstrmojo._InputListHoriz");mstrmojo.CheckListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.CheckListHoriz",inputType:"checkbox",cssClass:"mstrmojo-CheckListHoriz",itemCssClass:"mstrmojo-CheckListHoriz-item"});})();(function(){mstrmojo.requiresCls("mstrmojo._InputList","mstrmojo._InputListHoriz");mstrmojo.RadioList=mstrmojo.declare(mstrmojo._InputList,null,{scriptClass:"mstrmojo.RadioList",inputType:"radio",cssClass:"mstrmojo-RadioList",itemCssClass:"mstrmojo-RadioList-item",onenabledChange:function A(B){for(var C=0;C<this.items.length;C++){this._getItemNode(C).firstChild.disabled=!B.value;}}});mstrmojo.RadioListHoriz=mstrmojo.declare(mstrmojo._InputListHoriz,null,{scriptClass:"mstrmojo.RadioListHoriz",inputType:"radio",cssClass:"mstrmojo-RadioListHoriz",itemCssClass:"mstrmojo-RadioListHoriz-item"});})();(function(){mstrmojo.requiresClsP("mstrmojo","hash","Button","Box","express.ui.SubtotalsWidget");var B=mstrmojo.hash;mstrmojo.express.ui.SubtotalMenuEditor=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.express.ui.SubtotalMenuEditor",checkList:undefined,btnContainer:undefined,onSubmenuOpen:function A(){this.checkList.set("selectedItems",this.cell.ast);},children:[{scriptClass:"mstrmojo.express.ui.SubtotalsWidget",alias:"checkList"},{scriptClass:"mstrmojo.Box",alias:"btnContainer",cssClass:"mstrmojo-subtotals-button cf",cancelBtn:undefined,children:[{scriptClass:"mstrmojo.Button",alias:"cancelBtn",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.onSubmenuClosed();}},{scriptClass:"mstrmojo.Button",alias:"okBtn",text:mstrmojo.desc(1442,"OK"),onclick:function(){var H=this.parent.parent,K=H.cell,L=H.xtab,C=[],J=[],E=H.checkList.selectedIndices,G=K.ast,I=[],F,D;B.forEach(E,function(P,O){var R=H.checkList.items[O].v,Q=true;C.push(R);if(G){for(F=0;F<G.length;F++){if(R===G[F].t){Q=false;break;}}if(Q){J.push(R);}}});if(G){for(F=0;F<G.length;F++){var M=G[F].t,N=false;for(D=0;D<C.length;D++){if(C[D]===M){N=true;}}if(!N){I.push(M);}}}L.showTotal(K,G?J:C,I);H.onSubmenuClosed();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.PopupList","mstrmojo.array","mstrmojo.css");var F=mstrmojo.css,E=mstrmojo.array;mstrmojo.ui.editors.controls.ListPreviewButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ListPreviewButton",init:function G(L){this._super(L);var M=this.getListCfg(),K=this.itemValueField;M.alias="list";M.locksHover=true;M.slot="widgetHostNode";M.listHooks={select:function J(N,O){this.parent.set("selectedValue",O[K]);this.close();}};M.setDimensions=mstrmojo.emptyFn;this.addChildren([M]);F.addWidgetCssClass(this.list,"ctrl-popup-list");},getPopupWidget:function D(){return this.list;},items:null,onitemsChange:function H(){var J=this.items;if(J){this.list.set("items",J);}},selectedValue:"",itemValueField:"n",onselectedValueChange:function C(){var K=this.selectedValue,J=this.itemValueField,L=this.list;L.selectItems(E.filter(L.items||[],function(M){return M[J]===K;}),true);this.updatePreview();},updatePreview:function B(){throw new Error(this.scriptClass+" must implement updatePreview.");},getListCfg:function I(){return{scriptClass:"mstrmojo.ui.PopupList",selectionPolicy:"reselect"};},postBuildRendering:function A(){this.onitemsChange();this.onselectedValueChange();return this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupButton","mstrmojo.ui._IsPulldown","mstrmojo.ui.PopupList","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.array");var I=mstrmojo.css,G=mstrmojo.array,F=mstrmojo.dom;mstrmojo.ui.Pulldown=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.ui._IsPulldown],{scriptClass:"mstrmojo.ui.Pulldown",onitemSelected:mstrmojo.emptyFn,allowHTML:true,init:function N(O){this._super(O);I.addWidgetCssClass(this.list,"ctrl-popup-list");},initChildren:function E(){this.children=this.getPopupListConfig();this._super();},getSelectedItem:function H(){var O=this.items;return O&&O[this.selectedIndex];},selectItemByField:function J(P,O){this.set("selectedIndex",G.find(this.items||[],P,O));},getPopupWidget:function D(){return this.list;},getPopupList:function K(){return this.list;},_set_items:function B(R,O){var Q=this.items;this.items=O;delete this.selectedIndex;if(Q!==O){var P=this.hasRendered;if(P){this.refresh();}return true;}return false;},onclick:function M(O){this._super(O);var Q=this,P=Q.getPopupWidget();Q.mw=Q.mw||function(R){if(!F.contains(P.domNode,F.eventTarget(self,R),true,document.body)){P.close();F.detachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Q.mw);}};F.attachEvent(document,F.isFF?"DOMMouseScroll":"mousewheel",Q.mw);},_set_selectedIndex:function A(T,R){if((R!==0&&!R)||R<0){return false;}var P=this.selectedIndex=R,O=this.getPopupList(),Q=O.items,S=this.selectedNode;O.set("selectedIndex",P);if(S&&Q&&Q[P]){S.innerHTML=this.allowHTML?Q[P].n:mstrmojo.string.encodeHtmlString(Q[P].n);S.title=Q[P].title||"";}this.onitemSelected(Q[P],P);return true;},getPopupListConfig:function C(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",selectionPolicy:"reselect",locksHover:true,listHooks:{select:function O(R,S,Q){this.parent.set("selectedIndex",Q);this.close();}},getItemProps:function P(S,Q){var R=mstrmojo._IsList.getItemProps.call(this,S,Q);R.style=this.parent.itemCssText||"";return R;}};},children:[]});mstrmojo.ui.Pulldown.newPulldown=function L(P,T,O,S,R){S=S||{};S.items=P;var Q;if(R===true){Q=mstrmojo.hash.copy({scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:O||0},S);}else{Q=new mstrmojo.ui.Pulldown(S);if(O!==undefined){Q.set("selectedIndex",O);}}Q.postselectedIndexChange=function(U){var X=U.value,W=U.valueWas;if(X!==W){var V=this.items;T.call(this,V[X],V[W]);}};return Q;};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.PopupConfig","mstrmojo.ui.menus.Menu","mstrmojo.hash","mstrmojo.array");mstrmojo.ui.menus.MenuItemType=null;var U="separator";mstrmojo.ui.menus.MenuConfig=mstrmojo.declare(mstrmojo.ui.PopupConfig,null,{scriptClass:"mstrmojo.ui.menus.MenuConfig",menus:null,menuCssClass:"",supportsScroll:false,maxHeight:0,hasMenuItems:function Q(){return !!this.menus.length;},getMenuItems:function E(V){return mstrmojo.array.filter(this.menus.slice().reverse(),function(Z,Y,X){var W=X[Y+1];return V||Z.cls!==U||(Y&&W&&W.cls!==U);}).reverse();},getMenuItem:function C(Y){var X=this.menus,V;if(X!==null){for(V=0;V<X.length;V++){var W=X[V];if(W.cls===Y){return W;}}}return null;},absorbMenuItems:function S(V){this.menus=this.menus.concat(V.menus);},addMenuItem:function I(c,Y,a,W,Z){var b,X,V;if(!c||typeof c==="string"){b=c;}else{b=c.n;X=c.ttp;}V={n:b,ttp:X,cls:Y,fn:a,ctxt:W};if(isNaN(Z)||Z>=this.menus.length){this.menus.push(V);}else{this.menus.splice(Z,0,V);}return V;},addCustomMenuItem:function T(a,X,Z,W,V){var Y=this.addMenuItem(a,X,Z,V);Y.getItemMarkup=W;return Y;},addDisabledMenuItem:function O(W,V){this.addNonInteractiveMenuItem(W,V,true);},addNonInteractiveMenuItem:function M(Z,W,V){var X=["non-int"];if(W){X.push(W);}if(V){X.push("disabled");}var Y=this.addMenuItem(Z,X.join(" "),mstrmojo.emptyFn);Y.dsbld=true;},addSeparator:function D(){this.addMenuItem("",U,function(){return false;});},addPopupMenuItem:function R(c,X,b,Y,W,Z){var a=["pop "];if(Y){a.push(Y);}var V=this.addMenuItem(c,a.join(" "),b,W,Z);V.pop=true;V.scope=X;return V;},addActionPopupMenuItem:function L(c,W,a,b,X,V,Z){var Y=this.addPopupMenuItem(c,W,b,(X||"")+" ax",V,Z);Y.actionFn=a;Y.ax=true;},addSubMenuItem:function K(Z,X,W,Y,V){this.addPopupMenuItem(Z,W,Y,X,V);},addEditorMenuItem:function P(Z,W,Y,V,X){this.addPopupMenuItem(Z,W,Y,"",V,X);},getToggleItemStates:function F(d,f,V,b,X,a){var Y,Z,W,c;if(typeof d==="string"){Y=Z=d;W=c="";}else{Y=d.on||"";Z=d.off||"";W=d.ttpOn||"";c=d.ttpOff||"";}var e=[{n:Y,ttp:W,cls:f+" on",fn:b,ctxt:a},{n:Z,ttp:c,cls:f,fn:V,ctxt:a}];if(!X){e.reverse();}return e;},addToggleMenuItem:function J(c,Y,a,X,W,b,V){var Z=this.getToggleItemStates(c,Y,a,X,b,V);return this.addDualStateItem(W,Z[0],Z[1]);},addDualStateItem:function G(W,V,X){return this.addMenuItem({n:V.n,ttp:V.ttp},V.cls,this.getDualStateHandler(W,V,X),V.ctxt);},getDualStateHandler:function H(W,V,X){return function(Z,a){var Y=[V,X];if(Z.cls===V.cls){Y.reverse();}Y[1].fn.call(mstrmojo.all[W],Z,a);Z.n=Y[0].n;Z.ttp=Y[0].ttp;Z.cls=Y[0].cls;};},addRadioMenuGroup:function B(X,c,Y,W,V,b,a){var Z=[];Y.forEach(function(g,d){if(g.separator){this.addSeparator();return ;}var j=g.text,h=(W||"")+" "+(g.cls||"")+(b?"":" radio")+(g.value===X?" on":""),f=function(){if(c.call(this.ctxt,g.value,X,g)===false){return false;}X=g.value;Z.forEach(function(k){k.cls=k.cls.replace(/ on$/,"")+(k.radioValue===X?" on":"");});return true;},e=a?this.addCustomMenuItem(j,h,f,a(g,d),V):this.addMenuItem(j,h,f,V);e.radioValue=g.value;Z.push(e);},this);},clear:function N(){this._super();this.menus=[];},newInstance:function A(V){return new mstrmojo.ui.menus.Menu(mstrmojo.hash.copy({popupConfig:this},V));}});}());(function(){mstrmojo.requiresCls("mstrmojo.Slider","mstrmojo.MetricSelectorUtility","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.array","mstrmojo._FormatDefinition.NumberFormatCategory","mstrmojo.hash");mstrmojo.requiresDescs(8153,8154,8155,8156,8157,8158,8159,8160,8161,8162,8163,8164,8165,8166,8167,8168,8169,8170,7839,587,2204,2202,2203,7576,7575,7622);var U=mstrmojo.dom,N=mstrmojo.hash,S=mstrmojo.MetricSelectorUtility,j=mstrmojo._FormatDefinition.NumberFormatCategory,J=mstrmojo.desc,V=mstrmojo.css,X=mstrmojo.num,B=Math,b=B.max,H=B.min,d=B.floor,W=B.round,Z=9;function M(AB,AA,x,w){var z="px",q=AB._length,o=AB.handleSize,n=AB.orCfg,AF=n.posCssP,r=n.lenCssP,t=false;x=b(x,-1);w=H(w+Z,q);if(x>w){t=true;}var AC=H(x,w),AD=b(x,w),AE=AD-AC-(t?0:o+Z),u=b(parseInt(AB[r],10)-(2*AB.cssBkBW)-(AD+o),0)-Z;if(AB.hasRendered){AA.handle1Node.style[AF]=x+z;AA.handle2Node.style[AF]=(w-Z)+z;var m=AA.lowerRange.style,v=AA.thumbNode.style,p=AA.upperRange.style;m[AF]=0;v[AF]=(AC+(t?0:o))+z;p[AF]=(AD+o-Z)+z;m[r]=b(AC,0)+z;v[r]=AE+z;p[r]=u+z;}else{z+=";";AF+=":";r+=":";AB.handle1CssText=AF+x+z;AB.handel2CssText=AF+(w-Z)+z;AB.lowerRangeCssText=r+b(AC,0)+z;AB.thumbCssText=AF+(AC+o)+z+r+AE+z;AB.upperRangeCssText=AF+(AD+o-Z)+z+r+u+z;}return{handle1:x,handle2:w};}function O(m){this.getUnit=function(){return m._length/b((m.items.length-1),1);};this.calcMinMax=function(p,o){var q=m.unit;return{min:d(p/q+0.5),max:d(o/q+0.5)};};this.calcPxIdx=function(o){return d(o/m.unit+0.5);};this.getStep=function(){var p=m.high-m.low,o=parseInt(m.numFmts.cat,10),q=(o===4)?2:(o===5)?4:0;p=(p===0)?1:p;if(p>1){return(p>(m._length-2))?Number(Number(p/(m._length-2)).toFixed(m.numFmts.dp+q)):1;}return p/(m._length-2);};this.getIdx=function(o){return H(b(W((o-m.low)/m.step),0),m.items.length-1);};this.initialMetricSlider=function n(){var t=function(AH){return AH!==undefined&&AH!==null;},q=function(AH){return(t(AH.da)&&t(AH.da.low)&&t(AH.da.high)&&t(AH.da.cnt)&&t(AH.f)&&t(AH.ft)&&t(AH.qua));},p=function(AH){var AL=true,AK=true,AI=parseInt(AH.ft,10),AJ=parseInt(AH.f,10);if(AI===S._GENERIC){AL=AJ!==S.FN.ISNULL&&AJ!==S.FN.ISNOTNULL&&AJ!==S.FN.NOTIN&&AJ!==S.FN.IN;}else{if(AI===S._PERCENT||AI===S._RANK){AK=AJ!==S.MRPFN.INASCENDING&&AJ!==S.MRPFN.INDESCENDING&&AJ!==S.MRPFN.NOTINDESCENDING&&AJ!==S.MRPFN.NOTINASCENDING;}}return !AL||!AK;},AE=0;m.include=m.parent.include;m.clsType="scm ";m.staticStatus=!(t(m.da)&&t(m.da.low)&&t(m.da.high)&&t(m.da.cnt)&&t(m.qua));if(m.staticStatus){m.da.low=1;m.da.high=7;m.ft=S._GENERIC;m.f=S.FN.BETWEEN;m.qua=S.Q._G;m.cs=[{n:"",v:1},{n:"",v:7}];m.numFmts={cat:9,dp:0,fm:""};}switch(m.qua){case 0:var AD=parseInt(m.numFmts.cat,10);AE=AD===4?2:AD===5?4:0;m.low=Number(Number(m.da.low).toFixed(m.numFmts.dp+AE));m.high=Number(Number(m.da.high).toFixed(m.numFmts.dp+AE));break;case 1:case 2:m.low=1;m.high=m.da.cnt;break;case 3:case 4:m.low=0;m.high=100;break;}var AG=!m.staticStatus&&!m.da.nov;m.set("lowText",AG?m.formatNumber(m.low):"");m.set("highText",AG?m.formatNumber(m.high):"");m.step=(m.qua===1||m.qua===2)?1:this.getStep();m.low-=m.step;m.high+=m.step;m.cs1Vl=m.low;m.cs2Vl=m.high;var r=m.low,z=m.high,AF=[],AB=0;if(t(r)&&t(z)){var v=r,x;for(x=0;v<=z;x++,v+=m.step){AF[x]={n:S.formatNumber(m.qua,v,m.numFmts),v:Number(Number(v).toFixed(m.numFmts.dp+AE))};}AB=AF.length;if(AB>0&&AF[AB-1].v!==z){AF[AB-1]={n:S.formatNumber(m.qua,z,m.numFmts),v:z};}}m.items=AF;var o=S.OP,AA=m.cs,w=(AA&&AA.length>0)?X.parseNumeric(String(AA[0].v).replace("%","")):r,u=(AA&&AA.length>1)?X.parseNumeric(String(AA[1].v).replace("%","")):z;if(w<m.low){m.frtUst=true;}if(u>m.high){m.ndUst=true;}m.opId=(m.f!==null&&m.ft!==null)?S.getOpIdxByfunc(m.f,m.ft):o._BETWEEN;switch(m.opId){case o._EQUALS:case o._NOT_EQUALS:m.cs1Vl=m.cs2Vl=w;break;case o._LESS_EQUAL:case o._GREATER:m.cs1Vl=r;m.cs2Vl=w;break;case o._GREATER_EQUAL:case o._LESS:m.cs1Vl=w;m.cs2Vl=z;break;case o._IN:case o._NOT_IN:case o._IS_NULL:case o._IS_NOT_NULL:break;default:m.cs1Vl=w;m.cs2Vl=u;break;}m.cs1Idx=this.getIdx(m.cs1Vl);m.cs2Idx=this.getIdx(m.cs2Vl);var AC=parseInt(m.dt,10);m.cs1Nm=t(m.cs1Vl)?S.formatNumber(m.qua,m.cs1Vl,m.numFmts):m.items[m.cs1Idx].n;m.cs2Nm=t(m.cs2Vl)?S.formatNumber(m.qua,m.cs2Vl,m.numFmts):m.items[m.cs2Idx].n;m.unit=this.getUnit();m.set("unSet",(!q(m)||p(m)||(!m.cs||m.cs.length===0))&&!m.staticStatus);};this.updateOpCs=function(){var r=(m.cs1Vl>m.cs2Vl)?m.cs2Vl:m.cs1Vl,x=(m.cs1Vl>m.cs2Vl)?m.cs1Vl:m.cs2Vl,q=m.low,u=m.high,w=m.include,o=S.OP,t=parseInt(m.qua,10),p=(t===S.Q._PT||t===S.Q._PB),z,v=[];if((r>=q&&x<=u)||r<q||x>u){m.opId=w?o._BETWEEN:o._NOT_BETWEEN;}if(r===x){m.opId=w?o._EQUALS:o._NOT_EQUALS;}if(r===q&&x<u){m.opId=w?o._LESS_EQUAL:o._GREATER;}if(r>q&&x===u){m.opId=w?o._GREATER_EQUAL:o._LESS;}z=q==r&&x==u;if(!z){switch(m.opId){case o._BETWEEN:case o._NOT_BETWEEN:v.push({dtp:5,v:X.toLocaleString(r)+(p?"%":"")});case o._EQUALS:case o._NOT_EQUALS:v.push({dtp:5,v:X.toLocaleString(x)+(p?"%":"")});break;default:if(r>q){v.push({dtp:5,v:X.toLocaleString(r)+(p?"%":"")});}if(x<u){v.push({dtp:5,v:X.toLocaleString(x)+(p?"%":"")});}}}m.cs=v;m.parent.node.data.cs=v;m.set("unSet",z);};this.updateThumb=function(){var o=m.cs1Idx,r=m.cs2Idx;if(o!==undefined&&r!==undefined){var p=m.unit,q=m.gap;N.copy(M(m,m,W(o*p-q),W(r*p-q)),m);}};this.joinConst=function(){var q=m.cs;if(q){var o=[],p;for(p in q){o.push(q[p].v);}return o.join(",");}};}var E="<span {@ttpCssText}>{@content}</span>";function D(){if(this.staticStatus){return null;}var p=this.ghost;if(!p){var t=this.containerNode.cloneNode(true),r=t.childNodes;V.addClass(t,["gh"]);p=this.ghost={containerNode:t,lowerRange:r[0],handle1Node:r[1],thumbNode:r[2],handle2Node:r[3],upperRange:r[4]};this.sdcNode.appendChild(t);}var n=this.orCfg,m=n.posCssP,o=n.lenCssP,q=this.id;mstrmojo.array.forEach(["lowerRange","containerNode","thumbNode","upperRange"],function(z,u){var x=mstrmojo.all[q],w=x[z].style,v=p[z].style;if(u){v[m]=w[m];}v[o]=w[o];});p.containerNode.style.display="block";return p;}mstrmojo.MetricSlider=mstrmojo.declare(mstrmojo.Slider,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricSlider",markupString:'<div><div class="mstrmojo-Slider-summary"></div><div class="mstrmojo-Slider {@cssClass} {@clsType} {@clsOrientation}" style="{@cssText}" ><div class="cont" style=""><div class="sdc" style="position:absolute;{@sdcCssText}"><div class="sd" style="{@sdCssText}"><div class="bk left" style="{@lowerRangeCssText}"></div><div class="t1" style="{@handle1CssText}" mstrAttach:mouseover,mouseout,click></div><div class="t2 bk" style="{@thumbCssText}"></div><div class="t3" style="{@handel2CssText}" mstrAttach:mouseover,mouseout,click></div><div class="bk right" style="{@upperRangeCssText}"></div></div></div><div class="mstrmojo-Label" style="margin-top:9px;float:left;"></div><div class="mstrmojo-Label" style="margin-top:9px;float:right;"></div></div></div></div>',markupSlots:{summaryNode:function(){return this.domNode.childNodes[0];},sliderNode:function(){return this.domNode.childNodes[1];},dndNode:function(){return this.domNode.childNodes[1].childNodes[0];},sdcNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},containerNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0];},lowerRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[0];},handle1Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[1];},thumbNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[2];},handle2Node:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[3];},upperRange:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0].childNodes[0].childNodes[4];},tooltipNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[0];},lowNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[1];},highNode:function(){return this.domNode.childNodes[1].childNodes[0].childNodes[2];},editValueNode:function(){return this.domNode;}},markupMethods:{onlowTextChange:function(){this.lowNode.innerHTML=this.lowText||"";},onhighTextChange:function(){this.highNode.innerHTML=this.highText||"";},onfontChange:function(){this.lowNode.style.font=this.highNode.style.font=String(this.font);}},init:function f(m){this._super(m);this.handleSize=mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH;this.clsType="scm";this.typeHelper=new O(this);this.useRichTooltip=false;},typeHelper:null,unSet:false,preBuildRendering:function A(){var p=this.orCfg,o=this.isHoriz;p.cPosCssP=o?"right":"bottom";p.cLenCssP=o?"height":"width";var t=p.lenCssP,r=this[t],q=parseInt(r,10),n=this.handleSize;var m=this._length=(isNaN(q))?0:(q-n-Z);if(m<=0){m=this._length=mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH-n;}if(r){this.bkCssText=t+":"+b(q-(2*this.cssBkBW),0)+"px;";this.sdcCssText=p.posCssP+":"+Z+"px;"+t+":"+m+"px;"+p.opPosCssP+":0px;";}this.typeHelper.initialMetricSlider();this.typeHelper.updateThumb();},postBuildRendering:function R(){this._super();if(!this.staticStatus&&!this.da.nov){var n=this.lowNode,m=parseInt(n.style.fontSize,10);if(isNaN(m)){n.style.fontSize=8*this.parent.model.getZoomFactor()+"pt";}this.updateSummary();}this.lowNode.style.marginLeft=Z+"px";this.highNode.style.marginRight=Z+"px";this.sliderNode.style.height="0px";},onmouseover:function G(m){this.showTooltip(m.e,self);},onmouseout:function e(m){this.hideTooltip(m.e,self);},summaryLabels:{db:J(8153,"Between ## and ###"),dnb:J(8154,"Not between ## and ###"),din:J(587,"In"),dnin:J(2204,"Not in"),dnull:J(2202,"Is Null"),dnnull:J(2203,"Is not Null"),req:J(8155,"Rank ="),rneq:J(8156,"Rank <>").replace("<>",String.fromCharCode(8800)),rexb:J(8157,"Rank exclude bottom"),rext:J(8158,"Rank exclude top"),rb:J(8159,"Rank bottom"),rt:J(8160,"Rank top"),rbt:J(8161,"Rank between ## and ###"),rnbt:J(8162,"Rank not between ## and ###"),rin:J(8163,"Rank in"),rnin:J(8164,"Rank not in"),peq:J(8165,"Percent ="),pneq:J(8166,"Percent <>").replace("<>",String.fromCharCode(8800)),pexb:J(8167,"Exclude bottom"),pext:J(8168,"Exclude top"),pb:J(7576,"Bottom"),pt:J(7575,"Top"),pbt:J(8153,"Between ## and ###"),pnbt:J(8154,"Not between ## and ###"),pin:J(8169,"Percent in"),pnin:J(8170,"Percent not in")},formatNumber:function g(t){var o=this,z=Math.abs(t),x=o.numFmts.cat,n=1000,AA=["K","M","B","T","P","E","Z","Y"],u=AA.length,r;if(z>=n&&(x===j.Default||x===j.Fixed||x===j.General||x===j.Currency)){for(r=0;r<u;r++,n*=1000){if(z<n*1000){var m=z/n,p=(m*10).toFixed(0)%10>0?1:0,w=m.toFixed(p)+AA[r];return t<0?"("+w+")":w;}}}return S.formatNumber(o.qua,t,o.numFmts);},updateSummary:function L(){if(this.summaryNode&&!this.staticStatus){var AG=this.f,o=this.ft,AF=S,AA=S.FN,n=S.MRPFN,w="",AD=(this.cs1Vl<this.cs2Vl)?this.cs1Vl:this.cs2Vl,AB=(this.cs1Vl>this.cs2Vl)?this.cs1Vl:this.cs2Vl,u=this.formatNumber(AD),t=this.formatNumber(AB),q=this.typeHelper,v=this.summaryLabels,m=parseInt(o,10),p=parseInt(AG,10),AC=(m===AF._GENERIC&&(p===AA.ISNULL||p===AA.ISNOTNULL||p===AA.NOTIN||p===AA.IN))||((m===AF._PERCENT||m===AF._RANK)&&(p===n.INASCENDING||p===n.INDESCENDING||p===n.NOTINDESCENDING||p===n.NOTINASCENDING));if(this.unSet||AD<=this.low&&AB>=this.high&&this.include){w=mstrmojo.desc(2058,"All");}if(!this.unSet||AC){switch(o){case AF._GENERIC:switch(AG){case AA.EQUALS:w="= "+u;break;case AA.NOTEQUALS:w=String.fromCharCode(8800)+" "+u;break;case AA.GREATERTHAN:w="> "+t;break;case AA.GREATERTHANEQUALS:w=String.fromCharCode(8805)+" "+u;break;case AA.LESSTHAN:w="< "+u;break;case AA.LESSTHANEQUALS:w=String.fromCharCode(8804)+" "+t;break;case AA.BETWEEN:w=u+" - "+t;break;case AA.NOTBETWEEN:w=mstrmojo.desc(1099)+" "+u+" - "+t;break;case AA.ISNULL:w=v.dnull;break;case AA.ISNOTNULL:w=v.dnnull;break;case AA.IN:w=v.din+" "+q.joinConst();break;case AA.NOTIN:w=v.dnin+" "+q.joinConst();break;}break;case AF._PERCENT:case AF._RANK:var AE="r";if(parseInt(o,10)===AF._PERCENT){AE="p";}switch(AG){case n.EQUALSDESCENDING:case n.EQUALSASCENDING:w=v[AE+"eq"]+" "+u;break;case n.NOTEQUALSDESCENDING:case n.NOTEQUALSASCENDING:w=v[AE+"neq"]+" "+u;break;case n.GREATERTHANEQUALSASCENDING:w=v[AE+"exb"]+" "+u;break;case n.GREATERTHANASCENDING:w=v[AE+"exb"]+" "+t;break;case n.GREATERTHANEQUALSDESCENDING:w=v[AE+"ext"]+" "+u;break;case n.GREATERTHANDESCENDING:w=v[AE+"ext"]+" "+t;break;case n.LESSTHANASCENDING:w=v[AE+"b"]+" "+u;break;case n.LESSTHANEQUALSASCENDING:w=v[AE+"b"]+" "+t;break;case n.LESSTHANDESCENDING:w=v[AE+"t"]+" "+u;break;case n.LESSTHANEQUALSDESCENDING:w=v[AE+"t"]+" "+t;break;case n.BETWEENDESCENDING:case n.BETWEENASCENDING:w=v[AE+"bt"].replace("##",u).replace("###",t);break;case n.NOTBETWEENASCENDING:case n.NOTBETWEENDESCENDING:w=v[AE+"nbt"].replace("##",u).replace("###",t);break;case n.INASCENDING:case n.INDESCENDING:w=v[AE+"in"]+" "+q.joinConst();break;case n.NOTINDESCENDING:case n.NOTINASCENDING:w="";w=v[AE+"nin"]+" "+q.joinConst();break;}break;}}var x=this.summaryNode,z=(w!=="")?"":0;x.innerHTML=w;x.style.margin=z;}},getClientHeight:function T(){return this.dndNode.clientHeight+this.summaryNode.clientHeight+15;},initDrag:function k(q,m){if(!this.staticStatus&&!this.da.nov){m=m||window;var r=U.eventTarget(m,this.dnd.startE);if(r===this.handle1Node||r===this.handle2Node){var p=D.call(this),n=this.orCfg,o=this.dnd;o.initD={handle1:parseFloat(this.handle1,10),handle2:parseFloat(this.handle2,10)-Z,length:this._length,contL:p.containerNode[n.lenP],offset:U.getMousePosition(this.dnd.startE,m)[n.offsetP]};o.initD.td=r;V.removeClass(this.domNode.childNodes[1],["invalid"]);}}},ondrag:function K(t,r){if(!this.staticStatus){r=r||window;var v=this.dnd.initD;if(v){var AC=this.ghost,AD=v.handle1,p=v.handle2,q=this.cs1Idx,o=this.cs2Idx,AA=this.unit,x=this.gap,n=v.length;var z=U.getMousePosition(t,r)[this.orCfg.offsetP]-v.offset;switch(v.td){case this.handle1Node:AD=b(H(b(v.handle1+z,0),n)-x,-1);q=b(d(AD/AA+0.5),0);break;case this.handle2Node:p=b(H(b(v.handle2+z,0),n)-x,-1);o=b(B.ceil(p/AA+0.5),0);break;default:return ;}M(this,AC,AD,p);var u=this.items,m=(u&&u.length)||0;if(m&&q>=0&&q<m&&o>=0&&o<m){var AB=false,w;if(q!==this.cs1Idx){this.cs1Idx=q;w=this.items[q];this.cs1Vl=w.v;this.cs1Nm=w.n;AB=true;}if(o!==this.cs2Idx){this.cs2Idx=o;w=this.items[o];this.cs2Vl=w.v;this.cs2Nm=w.n;AB=true;}if(AB){this.typeHelper.updateThumb();this._updateTooltip(v.td);}}}}},ondrop:function Y(n){if(!this.staticStatus&&!this.da.nov){this.typeHelper.updateThumb();var m=this.ghost;if(m){m.containerNode.style.display="none";}this.hideTooltip(n,self);var o=this.dnd&&this.dnd.initD;if(this.makeSelection&&o){this.makeSelection({selItem:o.td});}if(this.items&&this.items.length&&this.ghost){this[(U.eventTarget(self,n)===this.ghost.handle1Node)?"frtUst":"ndUst"]=false;this.selectRange();}this.dnd.initD=null;}},selectRange:function Q(){var m=this.typeHelper,o=this.cs1Vl,n=this.cs2Vl,t=this.qua,r=this.numFmts;this.cs1Idx=m.getIdx(o);this.cs2Idx=m.getIdx(n);var p=function(q,v){var u=v||[];q=parseInt(q,10);return q===0||q===u.length-1;};this.cs1Nm=S.formatNumber(t,o,r);this.cs2Nm=S.formatNumber(t,n,r);m.updateOpCs();this.onselectionChange();this.updateSummary();},onincludeChange:function C(){if(!this.staticStatus){this.changeInclude=true;this.selectRange();}},showTooltip:function l(n,m){var o=U.eventTarget(m,n);this._updateTooltip(o);mstrmojo.tooltip.open(this,n,m);},_updateTooltip:function P(q){var n=this.orCfg,p=n.posCssP,m,o={contentNodeCssClass:"scm-tooltip",refNode:this.domNode.childNodes[1],posType:this._tooltip_pos};o[n.opPosCssP]=-parseInt(this.font,10)/2;o[p]=q.style[p];m=String((q===this.handle1Node)?this.cs1Nm:this.cs2Nm);o.content=E.replace(/\{@content\}/g,m);this.set("richTooltip",o);},onclick:function a(m){if(!this.staticStatus&&!this.da.nov){var n=U.eventTarget(m.hWin||window,m.e);this.hideTooltip(m.e,self);this.dnd.initD={makeMetricSilderSelectionByClick:true,td:((n===this.handle1Node)?this.handle1Node:((n===this.handle2Node)?this.handle2Node:null))};this.openEditValue({isfrt:(n===this.handle1Node),tgt:n});if(this._onThumb){this._onThumb(m);}}},onselectionChange:function I(m){this._super(m);if(this.dnd.initD&&this.dnd.initD.makeMetricSilderSelectionByClick){this.dnd.initD=null;}},onquaChange:function c(m){var o=S.getFuncInfo(this.opId,m.valueWas),p=S.getFuncInfo(this.opId,m.value),n;if(o.ft!==p.ft){if(!this.staticStatus){this.items=[];this.cs=[];this.f=this.ft=null;this.refresh();n=true;}}else{this.f=S.getFuncInfo(this.opId,m.value).f;n=false;}this.unSet=n||this.unSet;this.changeQual=true;this.selectRange();},updateData:function F(m,n){this.da=m;this.updateExpr(n);},updateExpr:function h(m){if(m){this.cs=m.cs;this.f=m.f;this.ft=m.ft;this.qua=m.qua;}this.refresh();},editValueRef:{cssClass:"edvl",slot:"editValueNode",scriptClass:"mstrmojo.Popup",locksHover:true,onOpen:function(){if(this.tgt){this.set("left",H(b(parseInt(this.tgt.style.left,10),0),parseInt(this.opener.width,10)-90)+"px");this.set("top",this.tgt.style.top);}var o=this.opener,n=this.children[0];if(o){var m=this.isfrt?o.cs1Vl:o.cs2Vl;n.edt.set("value",X.toLocaleString(m));}},children:[{scriptClass:"mstrmojo.Table",rows:1,cols:2,layout:[{cells:[{cssText:"width: 40px; padding: 3px;"},{cssText:"width: 16px;padding: 3px;"}]}],children:[{slot:"0,0",scriptClass:"mstrmojo.ValidationTextBox",alias:"edt",cssText:"color:black",dtp:mstrmojo.expr.DTP.NUMERIC,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:function(){if(this.parent.apply){this.parent.apply.set("enabled",String(this.value).length!==0);}},onInvalid:function(){if(this.parent.apply){this.parent.apply.set("enabled",false);}},onkeyup:function(n){if(this.parent.apply.enabled){var m=n.hWin,o=n.e||m.event;if(o.keyCode===13){this.parent.apply.onclick();}}}},{slot:"0,1",scriptClass:"mstrmojo.Button",cssClass:"icn apply",alias:"apply",onclick:function(){var n=this.parent.parent,o=n.opener,m=this.parent.edt.value;if(n&&o&&String(m).length>0){o[n.isfrt?"cs1Nm":"cs2Nm"]=m;m=X.parseNumeric(m);o[n.isfrt?"cs1Vl":"cs2Vl"]=m;}o[n.isfrt?"frtUst":"ndUst"]=true;o.selectRange();o.typeHelper.updateThumb();n.close();}}]}]},openEditValue:function(m){this.openPopup("editValueRef",m);}});mstrmojo.MetricSlider.METRICSLIDERTHUMBWIDTH=14;mstrmojo.MetricSlider.METRICSLIDERDEFAULTWIDTH=95;}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.hash");var A=mstrmojo.hash;mstrmojo.ui.editors.controls.ValidationTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,null,{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",errRevert:true,dtp:null,validationDelay:3000,orignText:null,trigger:mstrmojo.validation.TRIGGER.ONKEYUP,init:function(B){B=B||{};B.constraints=B.constraints||{};B.constraints.trigger=this.trigger;this._super(B);},prekeyup:function(B){if(B.e.keyCode===13){this.blur();return ;}this._super(B);},onfocus:function(){this.orignText=this.value;},onblur:function(){if(this.value!==this.orignText){this.validate();}},validate:function(){this._super();this.orignText=this.value;this.clearValDelayTimer();},preinput:mstrmojo.emptyFn,postinput:function(){var B=this.doValidation(this.value);if(B.code<=mstrmojo.validation.STATUSCODE.VALID){this.clearValidation();if(!this.errRevert){this.hideTooltip();}}},updateTooltipConfig:function(){this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onInvalid:function(){if(!this.errRevert){this.hideTooltip();this.showTooltip();}else{this.clearValidation();this.set("value",this.orignText);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.Box","mstrmojo.Label","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.Dialog","mstrmojo.cookies");mstrmojo.requiresDescs(17,18,221,9772,11773,14028,14136,14137,14138,14139,14140,14149,14522,14523,14524,14525,14526,14527);var CSS=mstrmojo.css,DOM=mstrmojo.dom,HASH=mstrmojo.hash;var _VAL=mstrmojo.validation,_SC=_VAL.STATUSCODE,_TR=_VAL.TRIGGER,_VALIDATOR=_VAL.VALIDATOR,DTP=mstrmojo.expr.DTP;var usherProps={intervalCtr:0,qrLoaded:false,maxPollingAttempts:80,timeDelay:3000};var DEFAULT_BADGE={mini_badge:"#ddd",mini_badge_icon:"https://uvs-v2.usher.com/assets/images/img_badge_placeholder.png",t_color:"#797979",appName:"",name:""};var userInfo={firstName:"",badgeId:""};var notificationTimer={duration:undefined,elem:undefined,callback:undefined,timerInterval:null,init:function(duration,elem,callback){this.duration=duration;this.elem=elem;this.callback=callback;},startTimer:function(){this.stopTimer();var start=Date.now(),diff,minutes,seconds;var me=this;function timer(){diff=me.duration-(((Date.now()-start)/1000)|0);minutes=(diff/60)|0;seconds=(diff%60)|0;minutes=minutes<10?"0"+minutes:minutes;seconds=seconds<10?"0"+seconds:seconds;me.elem.set("text",minutes+":"+seconds);if(diff<=0){start=Date.now()+1000;me.callback();me.stopTimer();}}timer();this.timerInterval=setInterval(timer,1000);},stopTimer:function(){if(this.timerInterval){clearInterval(this.timerInterval);}}};function addExtraParams(params){params.sn=this.serverName||mstrConfig.serverName;params.sp=this.serverPort||mstrConfig.serverPort;params.connectionId=this.connectionId||"";return params;}function disableQRCode(){this.set("expired",true);this.usherProps.qrLoaded=false;}function checkForUsherScan(){try{var widgetUsherProps=this.usherProps;var me=this;if(widgetUsherProps.qrLoaded){if(widgetUsherProps.intervalCtr>widgetUsherProps.maxPollingAttempts){disableQRCode.call(me);}else{clearTimeout(this.pullTimeout);this.pullTimeout=setTimeout(function(){widgetUsherProps.intervalCtr+=1;if(!me.stopPolling){usherPollForScan.call(me);}},widgetUsherProps.timeDelay);}}}catch(e){}}function serverRequest(params,callbacks,config){if(mstrApp.serverRequest){mstrApp.serverRequest(params,callbacks,config);}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,callbacks,params);}}function usherPollForScan(){var me=this,widgetUsherProps=this.usherProps,params={taskId:"usherLoginWeb",pollOnly:"true",server:this.serverName||mstrConfig.serverName,port:this.serverPort||mstrConfig.serverPort,project:this.projectName||mstrConfig.projectName,connectionId:this.connectionId},callbacks={success:function(res){try{if(res.status=="invalid"){checkForUsherScan.call(me);}else{if(res.status=="success"){function doUsherLogin(res){me.onUsherLogin(res);widgetUsherProps.qrLoaded=false;}if(me.rememberMe===true){var callbacks={success:function(res){doUsherLogin(res);},failure:function(res){me.onUsherError(res);}};var params={taskId:"usherRememberMe"};params.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";serverRequest(params,callbacks,{doNotHold:true});}else{doUsherLogin(res);}}}}catch(e){mstrmojo.alert("usherPollForScan:\n "+e.messsage);}},failure:function(res){disableQRCode.call(me);me.onUsherError(res);}};serverRequest(params,callbacks,{doNotHold:true});}function updateUserDetails(msg){this.userDetails.set("text",msg||"");}function toggleLoginNotification(show){var me=this;me.loginButton.set("visible",show);me.loginNotificationBox.set("visible",!show);}function submitLogin(){var widgetUsherProps=this.usherProps;var notificationTimer=this.notificationTimer;var me=this,callbacks={success:function(res){try{if(res.status==1){function callback(){toggleLoginNotification.call(me,true);}function submitForPolling(){if(me.pullTimeout){clearTimeout(me.pullTimeout);}me.usherProps.intervalCtr=0;widgetUsherProps.qrLoaded=true;checkForUsherScan.call(me);}var fiveMinutes=60*5;notificationTimer.init(fiveMinutes,me.loginNotificationBox.timer,callback);notificationTimer.startTimer();toggleLoginNotification.call(me,false);submitForPolling();}else{me.onUsherError(res);}}catch(e){mstrmojo.alert("Error:\n"+e.message);}},failure:function(res){me.onUsherError(res);}},params={taskId:"usherNotifyMe"};params.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";serverRequest(addExtraParams.call(this,params),callbacks,{doNotHold:true});}function forgetMe(){var me=this,callbacks={success:function(res){try{me.set("notificationMode",false);me.reloadQR();}catch(e){mstrmojo.alert("Error:\n"+e.messsage);}},failure:function(res){me.onUsherError(res);}},params={taskId:"usherRememberMe",rememberMe:false};if(me.userInfo.badgeId!==""){params.badgeId=me.userInfo.badgeId;}params.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";serverRequest(addExtraParams.call(this,params),callbacks,{doNotHold:true});}function getQRCode(ignoreNotificationMode){if(this.notificationMode==true&&!ignoreNotificationMode){return ;}var widgetUsherProps=this.usherProps;this.showQRLoading(true);var me=this,callbacks={success:function(res){try{if(res.img){me.set("notificationMode",false);me.updateQRCode(res.img);me.set("badge",res.badgeInfo&&res.badgeInfo[0]);widgetUsherProps.intervalCtr=0;widgetUsherProps.qrLoaded=true;this.stopPolling=false;checkForUsherScan.call(me);}else{var data=JSON.parse(res.data);var pn=data.pnEnabled||data.isPNEnabled;me.set("isPnEnabled",pn);if(data.code||data.proximityBasedLogin){me.set("notificationMode",false);if(data.proximityBasedLogin&&!ignoreNotificationMode){me.updateQRCodeProximity();me.set("proximityMode",true);}else{me.updateQRCode(data.code);me.set("proximityMode",false);}me.set("badge",res.badgeInfo&&res.badgeInfo[0]);widgetUsherProps.intervalCtr=0;widgetUsherProps.qrLoaded=true;this.stopPolling=false;mstrmojo.cookies.updateCookieSetting("usher_sso_device",res.device_id);checkForUsherScan.call(me);}else{me.set("proximityMode",false);me.set("notificationMode",true);me.refresh.set("visible",false);if(me.userInfoNode){me.userInfoNode.src="data:image/png;base64,"+data.photoData;}me.userInfo.firstName=data.firstName;me.userInfo.badgeId=data.badgeId;toggleLoginNotification.call(me,true);me.set("badge",res.badgeInfo&&res.badgeInfo[0]);}}}catch(e){mstrmojo.alert("getQRCode:\n "+e.messsage);}},failure:function(res){me.handleQRCodeError(res);disableQRCode.call(me);me.onUsherError(res);},complete:function(){me.showQRLoading(false);}},params={taskId:"usherQRWeb"};params.deviceId=mstrmojo.cookies.getCookieSetting("usher_sso_device")?mstrmojo.cookies.getCookieSetting("usher_sso_device"):"";serverRequest(addExtraParams.call(this,params),callbacks,{doNotHold:true});}function registerHandler(){var me=this,regBtn=this.registerButton,dotsNode=this.parent.badgeNode.childNodes[1];if(regBtn.enabled){regBtn.set("enabled",false);CSS.addClass(dotsNode,["anim"]);var regMsg={},callbacks={success:function(res){var successful=res&&res.name==me.user.value;regMsg={msg:successful?mstrmojo.desc(14139,"You've successfully registered. Please check your email to continue.")+" "+mstrmojo.desc(14177,"Or perform an Usher badge recovery."):res.getResponseHeader("X-MSTR-TaskFailureMsg"),successful:successful};},failure:function(res){regMsg={msg:res.getResponseHeader("X-MSTR-TaskFailureMsg"),successful:false};},complete:function(){regBtn.set("enabled",true);CSS.removeClass(dotsNode,["anim"]);me.set("regMsg",regMsg);}},params={taskId:"usherRegUsr",server:this.serverName||mstrConfig.serverName,project:mstrConfig.projectName,port:this.serverPort||mstrConfig.serverPort,email:this.email.value,userid:this.user.value,password:this.pwd.value};serverRequest(params,callbacks);}}function getTextBoxJson(props){return mstrmojo.hash.copy(props,{scriptClass:"mstrmojo.ValidationTextBox",cssDisplay:"block",postCreate:function(){if(DOM.isIE9||DOM.isIE8||DOM.isIE7){this.emptyText=this.hint;}},onEnter:function(){registerHandler.call(this.parent);}});}mstrmojo.UsherLogin=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.UsherLogin",markupString:'<div id="{@id}" class="mstrmojo-UsherLogin-Container {@cssClass}" style="{@cssText}" ><div class="mstrmojo-UsherLogin-badge"><div class="icn"><img src="../images/1ptrans.gif"/></div><div class="dots"><div class="dot1"></div><div class="dot2"></div><div class="dot3"></div></div><div class="app"><img src="../style/mstr/images/badge-app.png"/></div></div><div class="mstrmojo-UsherLogin-badgeLabel"><div class="app-name"></div><div class="badge-name"></div></div><div class="mstrmojo-UsherLogin"><div class="mstrmojo-UsherLogin-QR mode"><img class="QR" src="../images/1ptrans.gif" alt="" /></div><div class="mstrmojo-UsherLogin-register mode"></div></div><div class="mstrmojo-UsherLogin-userInfo mode"><img class="userInfo" src="../images/1ptrans.gif" alt="" /></div><div class="mstrmojo-UsherLogin-notification"></div><div class="mstrmojo-UsherLogin-remember-setting"><div class = "mstrmojo-UsherLogin-remember"></div><div class = "mstrmojo-UsherLogin-forget"></div></div><div class="mstrmojo-UsherLogin-link"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},badgeNode:function(){return this.domNode.firstChild;},badgeIconNode:function(){return this.domNode.firstChild.firstChild.firstChild;},badgeLabelNode:function(){return this.domNode.childNodes[1];},usherNode:function(){return this.domNode.childNodes[2];},qrNode:function(){return this.domNode.childNodes[2].firstChild;},qrCodeNode:function(){return this.domNode.childNodes[2].firstChild.firstChild;},refreshNode:function(){return this.domNode.childNodes[2].firstChild.lastChild;},registerNode:function(){return this.domNode.childNodes[2].lastChild;},userNode:function(){return this.domNode.childNodes[3];},userInfoNode:function(){return this.domNode.childNodes[3].firstChild;},notificationNode:function(){return this.domNode.childNodes[4];},rememberSettingsNode:function(){return this.domNode.childNodes[5];},rememberNode:function(){return this.domNode.childNodes[5].firstChild;},forgetNode:function(){return this.domNode.childNodes[5].lastChild;},linksNode:function(){return this.domNode.lastChild;}},markupMethods:{onqrCodeChange:function(){if(this.qrCodeNode){this.qrCodeNode.src=this.qrCode;}},onbadgeChange:function(){var badge=this.badge||DEFAULT_BADGE,badgeFormat=badge.badgeFormat,fmt=badgeFormat&&(window.JSON?JSON.parse(badgeFormat):eval("("+badgeFormat+")"))||{isnull:true},labelNode=this.badgeLabelNode,iconNode=this.badgeIconNode,domNode=this.domNode;if(this.showBadgeBackgroundImage){domNode.style.backgroundColor=fmt.mini_badge;if(fmt.bg_4){domNode.style.backgroundImage="url("+fmt.bg_4+")";}}iconNode.src=fmt.mini_badge_icon||DEFAULT_BADGE.mini_badge_icon;if(!fmt.isnull&&!fmt.mini_badge_icon){CSS.addClass(iconNode.parentNode,"default");}labelNode.firstChild.innerHTML=badge.appName||DEFAULT_BADGE.appName;labelNode.lastChild.innerHTML=badge.name||DEFAULT_BADGE.name;labelNode.lastChild.title=badge.name||DEFAULT_BADGE.name;labelNode.style.color=fmt.t_color||DEFAULT_BADGE.t_color;this.linksNode.style.color=fmt.t_color||DEFAULT_BADGE.t_color;},onexpiredChange:function(){CSS.toggleClass(this.usherNode,"expired",this.expired);},onloadingChange:function(){CSS.toggleClass(this.usherNode,"loading",this.loading);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(this.visible&&this.canRequestQR()&&!this._lastVisible){getQRCode.call(this);}this.stopPolling=!this.visible;this._lastVisible=this.visible;},onnotificationModeChange:function(evt){CSS.toggleClass(this.containerNode,"notificationMode",this.notificationMode);},onproximityModeChange:function(evt){CSS.toggleClass(this.containerNode,"proximityMode",this.proximityMode);},onisPnEnabledChange:function(){this.hideRememberMe(!this.isPnEnabled);}},qrCode:"../images/1ptrans.gif",badge:DEFAULT_BADGE,expired:false,onUsherLogin:mstrmojo.emptyFn,onUsherError:mstrmojo.emptyFn,showBadgeBackgroundImage:true,usherProps:null,serverName:null,serverPort:null,rememberMe:false,userInfo:null,notificationTimer:null,loadQR:false,notificationMode:false,isPnEnabled:false,init:function init(props){if(this._super){this._super(props);}CSS.addWidgetCssClass(this,"");this.usherProps=this.usherProps?HASH.copy(this.usherProps,HASH.clone(usherProps)):HASH.clone(usherProps);this.userInfo=this.userInfo?HASH.copy(this.userInfo,HASH.clone(userInfo)):HASH.clone(userInfo);this.notificationTimer=this.notificationTimer?HASH.copy(this.notificationTimer,HASH.clone(notificationTimer)):HASH.clone(notificationTimer);},destroy:function destroy(ignoreDOM){this.stopPolling=true;clearTimeout(this.pullTimeout);this._super(ignoreDOM);},canRequestQR:function(){return this.usherProps&&(this.loadQR||(this.serverName||mstrConfig.serverName));},showUserInfo:function(res){this.refresh.set("visible",false);this.refresh.set("visible",false);},updateQRCode:function(res){this.set("qrCode","data:image/png;base64,"+res);this.set("expired",false);this.refresh.set("visible",false);},updateQRCodeProximity:function(){this.set("qrCode","../images/WaitUsherRadar.gif");this.set("expired",false);this.refresh.set("visible",false);},handleQRCodeError:function(){this.set("qrCode","../style/mstr/images/msgError.gif");this.set("expired",true);this.refresh.set("visible",true);},showQRLoading:function showQRLoading(show){this.set("loading",show);if(show){this.refresh.set("visible",false);}},postBuildRendering:function(){this._super();this.registerForm.set("tabIndex",-1);},toggleRegister:function(force){this.registerVisible=(force!==undefined)?force:!this.registerVisible;CSS.toggleClass(this.usherNode,"show-register",this.registerVisible);this.registerLink.set("text",this.registerLink.texts[this.registerVisible?1:0]);if(this.isPnEnabled===true){this.hideRememberMe(this.registerVisible&&this.isPnEnabled);}},hideRememberMe:function(force){CSS.toggleClass(this.rememberSettingsNode,"hide-rememeber",force);},reloadQR:function(){if(this.canRequestQR()){if(this.pullTimeout){clearTimeout(this.pullTimeout);}this.usherProps.intervalCtr=0;this.usherProps.qrLoaded=false;if(this.visible){getQRCode.call(this);}}},children:[{scriptClass:"mstrmojo.Label",slot:"qrNode",alias:"refresh",cssClass:"refresh",text:mstrmojo.desc(14028,"Refresh QR Code"),visible:false,onclick:function(){getQRCode.call(this.parent);}},{scriptClass:"mstrmojo.Box",slot:"registerNode",alias:"registerForm",regMsg:null,children:[getTextBoxJson({alias:"user",cssClass:"login-username",cssDisplay:"block",hint:mstrmojo.desc(17,"User name")}),getTextBoxJson({alias:"pwd",cssClass:"login-pwd",hint:mstrmojo.desc(18,"Password"),type:"password"}),getTextBoxJson({alias:"email",cssClass:"login-email",dtp:DTP.VARCHAR,constraints:{validator:_VALIDATOR.VALIDATE_EMAIL,trigger:mstrmojo.validation.TRIGGER.ONKEYUP},bindings:{visible:"this.parent.parent.usherRegistrationOption > 2"},hint:mstrmojo.desc(9772,"Email")}),getTextBoxJson({alias:"confirmEmail",cssClass:"login-email",bindings:{visible:function(){return this.parent.parent.usherRegistrationOption>2;}},hint:mstrmojo.desc(14149,"Confirm Email"),onpaste:function(evt){DOM.preventDefault(evt.hWin,evt.e||evt.hWin.event);}}),{scriptClass:"mstrmojo.Box",alias:"regMsg",cssClass:"register-msg",bindings:{regMsg:function(){return this.parent.regMsg;},visible:function(){return this.parent.regMsg;}},onregMsgChange:function(){if(this.domNode){this.domNode.style.color=this.regMsg&&this.regMsg.successful?"#42C31E":"#f00";}},children:[{scriptClass:"mstrmojo.Label",alias:"msg",cssClass:"register-msg-txt",bindings:{text:function(){return this.parent.regMsg.msg;}}},{scriptClass:"mstrmojo.Label",alias:"icn",cssClass:"register-msg-icn",onclick:function(){this.parent.parent.parent.toggleRegister();this.parent.parent.set("regMsg",null);}}]},{scriptClass:"mstrmojo.Button",alias:"registerButton",cssClass:"register mstrmojo-WebButton hot",cssDisplay:"inline-block",text:mstrmojo.desc(11773,"Register"),bindings:{enabled:function(){var username=this.parent.user.value,email=this.parent.email.value,confirmEmail=this.parent.confirmEmail.value;var registerStatus=username.length>0;if(registerStatus){if(this.parent.parent.usherRegistrationOption>1){var emailStatus=email.length>=3&&confirmEmail.length>=3&&email.toUpperCase()===confirmEmail.toUpperCase()&&this.parent.email.validationStatus.code===_SC.VALID;if(emailStatus){if(this.parent.parent.usherRegistrationOption==7){var restrictedDomains=this.parent.parent.usherRegistrationDomain.toUpperCase();var emailDomain=email.substr(email.indexOf("@")+1).toUpperCase();return restrictedDomains.indexOf(emailDomain)>=0;}}return emailStatus;}}return registerStatus;}},onclick:function(){registerHandler.call(this.parent);}},{scriptClass:"mstrmojo.Button",alias:"registerCancelButton",cssClass:"register-cancel",cssDisplay:"inline-block",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var p=this.parent;p.parent.toggleRegister();p.set("regMsg",null);p.user.set("value","");p.pwd.set("value","");p.email.set("value","");p.confirmEmail.set("value","");p.user.domNode.focus();}}]},{scriptClass:"mstrmojo.CheckBox",slot:"rememberNode",alias:"remember-me",label:mstrmojo.desc(14522,"Remember me"),onclick:function onclick(){this.parent.set("rememberMe",this.checked);}},{scriptClass:"mstrmojo.Label",slot:"forgetNode",allowHTML:true,text:mstrmojo.desc(14527,"Forget me/Switch user"),onclick:function(){forgetMe.call(this.parent);}},{scriptClass:"mstrmojo.Label",slot:"linksNode",allowHTML:true,text:'<a id="proximityProblems" href="#">Login via Phone</a>',onclick:function(evt){getQRCode.call(this.parent,true);return false;},bindings:{visible:"this.parent.proximityMode"},},{scriptClass:"mstrmojo.Label",slot:"linksNode",allowHTML:true,text:mstrmojo.desc(14136,"Use your ###Usher## app to scan the QR Code.").replace("###",'<a href="https://itunes.apple.com/us/app/usher-identity/id776079205" target="_blank">').replace("##","</a>"),},{scriptClass:"mstrmojo.Label",slot:"linksNode",alias:"registerLink",cssClass:"register-label",allowHTML:true,bindings:{visible:"this.parent.usherRegistrationOption > 0"},text:"",texts:[mstrmojo.desc(14137,"Don't have an Usher Badge? Click ###here## to register."),mstrmojo.desc(14140,"Display your ###QR Code##.")],postCreate:function(){this.set("text",this.texts[0]);},ontextChange:function(){this.text=this.text.replace("###",'<a href="#" onclick="mstrmojo.all.'+this.parent.id+'.toggleRegister(); return false;">').replace("##","</a>");}},{scriptClass:"mstrmojo.Label",alias:"userDetails",cssClass:"user-details",slot:"userNode"},{scriptClass:"mstrmojo.Button",alias:"loginButton",cssClass:"mstrmojo-WebButton login-button .mstrButton",cssDisplay:"inline-block",text:mstrmojo.desc(14525,"Login with Usher"),slot:"notificationNode",visible:false,onclick:function(){submitLogin.call(this.parent);},onvisibleChange:function(){var node=this.parent,msg=mstrmojo.desc(14523,"Hi ")+" "+node.userInfo.firstName;this.visible?msg+="!":msg+=mstrmojo.desc(14524,", please approve on your device.");updateUserDetails.call(node,msg);}},{scriptClass:"mstrmojo.Box",alias:"loginNotificationBox",cssClass:"login-notification",slot:"notificationNode",visible:false,children:[{scriptClass:"mstrmojo.Label",alias:"timer",cssClass:"notification-timer"},{scriptClass:"mstrmojo.Label",alias:"notificationFailure",cssClass:"notification-failure",text:mstrmojo.desc(14526,"Did not get notification"),onclick:function(){toggleLoginNotification.call(this.parent.parent,true);}}]},]});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.List","mstrmojo.Button","mstrmojo.color","mstrmojo.Model","mstrmojo.Table","mstrmojo._CanValidate","mstrmojo.ValidationTextBox");var L=mstrmojo.color,C=mstrmojo.hash;function H(V,R,N,O,U,M,Q,T){var S={target:R,onEnd:function(){if(M){M();}},props:{}};S.props[N]={ease:Q,start:parseInt(O,10),stop:parseInt(U,10),suffix:"px"};S=C.copy(T,S);var P=new mstrmojo.fx.AnimateProp(S);P.play();}var D=function(Q){if(Q===null){return ;}var P=mstrmojo.locales.color.userPalette,M=P.length;if(M===8){P.remove(M-1,1);}P.add([{n:Q,v:Q}],0);var N="",O;for(O=0;O<8;O++){if(P[O]&&P[O].v){N+=P[O].v+",";}}N=N.replace(/,$/,"");mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(R){},failure:function(R){mstrmojo.alert(R.getResponseHeader("X-MSTR-TaskFailureMsg"));}},{taskId:"setPreference",prefs:"userPalette\u001E"+N});};var I=function(M,N,O){return{scriptClass:"mstrmojo.Label",text:M+":",cssClass:N,slot:O};};var K=function(M,P,O,N){return C.copy(N||{},{scriptClass:"mstrmojo.ValidationTextBox",cssDisplay:"block",cssText:"padding: "+(mstrmojo.dom.isIE7?"0":"1px"),bindings:{value:function(){return this.parent.parent.colorModel[O]||"0";}},onValid:function(){this.parent.parent.colorModel.set(O,this.value);},min:0,max:255,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,validator:function(R){var S=this.min,Q=this.max;R=parseInt(R,10);if(R>=S&&R<=Q){return{code:mstrmojo.validation.STATUSCODE.VALID};}return{code:mstrmojo.validation.STATUSCODE.INVALID,msg:mstrmojo.desc(7883,"Please enter an integer between ## and ###").replace("##",S).replace("###",Q)};}},slot:P});};var G=function(M){return C.copy({scriptClass:"mstrmojo.Slider",alias:M+"Slider",cssClass:"sc "+M,isHoriz:true,width:130,cssBkBW:0,items:[],getItemTooltip:function(){return this.items[this.min].n;},postCreate:function(){var N;for(N=0;N<{r:256,g:256,b:256,s:101,v:101,h:360}[M];N++){this.items.push({n:N,v:N});}},bindings:{selectedIndex:function(){return this.parent.parent.colorModel[M]||"0";}},onselectedIndexChange:function(){this.parent.parent.colorModel.set(M,this.selectedIndex);if(this.domNode){this.min=this.max=this.selectedIndex;this.typeHelper.updateThumb();}},select:function(N){this.set("selectedIndex",N);},slot:"1,3"});};var A=function(N,M,O){return'<div mstridx="'+M+'" class="mstrmojo-ColorPicker-item '+O.itemCssClas+'" style="background-color:'+N.v+';" type="button" title="'+N.n+'"></div>';};var F=C.copy({findIndex:function(M,O,N){return N.getAttribute("mstridx")||-1;}},C.copy(mstrmojo.ListMapper));var B=function(M,N){return C.copy(N,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-ColorPicker-list",itemMarkupFunction:A,listMapper:F,onchange:null,_onchange:function(){this.set("selectedColor",this.selectedItem.v);M.set("selectedColor",this.selectedItem.v);if((M.isSimple||!M.expanded)&&M.onChange){M.onChange();}},onselectedColorChange:function(){M.colorModel.set("hex",this.selectedColor);}});};mstrmojo.ColorPicker=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ColorPicker",markupString:'<div id={@id} class="mstrmojo-ColorPicker {@cssClass} {@shadowCssClass}" style="height:{@height}; width:{@width};{@cssText}"><div class="mstrmojo-ColorPicker-box"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onexpandedChange:function(){this.domNode.className=this.domNode.className.replace(/ expanded/,"")+(this.expanded?" expanded":"");}},useAnimate:true,useShadow:true,isSimple:false,showNoColor:true,showMoreColors:true,showGradients:true,showUserPalette:true,height:"168px",fullHeight:"326px",width:"158px",fullWidth:"366x",expanded:false,onexpandedChange:function(N){var Q=this.domNode,M=parseInt(this.height,10),P=parseInt(this.width,10),O=parseInt(this.fullHeight,10),R=Math.max(parseInt(this.fullWidth,10),Q.scrollWidth);if(this.useAnimate!==false){if(N.value){H(true,Q,"width",P,R);H(true,Q,"height",M,O);}else{H(true,Q,"width",R,P);H(true,Q,"height",O,M);}}else{if(N.value){Q.style.width=R+"px";Q.style.height=O+"px";}else{Q.style.width=P+"px";Q.style.height=M+"px";}}},selectedColor:null,onChange:null,_updateSelection:function(N){var O=(this.isSimple)?this:this.layout.cp;if(N){var M=mstrmojo.array.find(O.basicColors.items,"v",N);if(M>-1){O.basicColors.set("selectedIndex",M);}else{M=mstrmojo.array.find(O.userPalette.items,"v",N);if(M>-1){O.userPalette.set("selectedIndex",M);}}}},visible:false,onvisibleChange:function(){if(this.visible){this.selectedColor=(this.selectedColor&&this.selectedColor.replace(/transparent/,"#FFFFFF"))||"#FFFFFF";this.colorModel.set("hex",this.selectedColor);this._updateSelection(this.selectedColor);}},onselectedColorChange:function(){this._updateSelection(this.selectedColor);},init:function(M){var N=this;this.colorModel=new mstrmojo.Model({h:0,s:0,v:100,_hsvChange:function(){this.hex="#"+L.hsv2hex(this.h,this.s,this.v);var O=L.hsv2rgb(this.h,this.s,this.v);this.r=O[0];this.g=O[1];this.b=O[2];N.set("colorModel",C.copy(this,{}));},_rgbChange:function(){this.hex="#"+L.rgb2hex(this.r,this.g,this.b);var O=L.rgb2hsv(this.r,this.g,this.b);this.h=O[0];this.s=O[1];this.v=O[2];N.set("colorModel",C.copy(this,{}));},onhChange:function(){this._hsvChange();},onsChange:function(){this._hsvChange();},onvChange:function(){this._hsvChange();},onrChange:function(){this._rgbChange();},ongChange:function(){this._rgbChange();},onbChange:function(){this._rgbChange();},onhexChange:function(){var P=L.hex2rgb(this.hex);this.r=P[0];this.g=P[1];this.b=P[2];var O=L.hex2hsv(this.hex);this.h=O[0];this.s=O[1];this.v=O[2];N.set("colorModel",C.copy(this,{}));}});this._super(M);},postBuildRendering:function(){if(this._super){this._super();}this.colorModel.set("hex",this.selectedColor||"#FFFFFF");this.colorModel.set("s",50);},preBuildRendering:function(){if(this._super){this._super();}var P=this.isSimple?100:124;if(this.showNoColor){P+=20;}if(this.showUserPalette){P+=25;}this.height=P+"px";if(this.isSimple){this.width="155px";}this.shadowCssClass=this.useShadow?"shadow":"";var Q=this,M={scriptClass:"mstrmojo.Button",cssClass:"nocolor",text:mstrmojo.desc(959,"Default"),visible:this.showNoColor,onclick:function(){Q.set("selectedColor","transparent");if(Q.onChange){Q.onChange();}}},O=B(this,{alias:"basicColors",items:mstrmojo.locales.color.colors,onchange:function(){if(this.selectedIndex>-1){this.parent.userPalette.set("selectedIndex",-1);this._onchange();}}}),R=B(this,{alias:"userPalette",cssClass:"mstrmojo-ColorPicker-list userPalette",makeObservable:true,visible:this.showUserPalette,bindings:{items:function(){return Q.showUserPalette!==false?mstrmojo.locales.color.userPalette:[];}},onchange:function(){if(Q.visible){if(this.selectedIndex>-1){this.parent.basicColors.set("selectedIndex",-1);this._onchange();}}},onadd:function(){this.refresh();if(Q.visible){this.parent.basicColors.set("selectedIndex",-1);this.set("selectedIndex",0);}}});if(this.isSimple){if(this.showNoColor){this.addChildren(M,0);}this.addChildren(O);this.addChildren(R);return ;}var N={scriptClass:"mstrmojo.Table",alias:"layout",rows:2,cols:5,layout:[{cells:[{colSpan:2},{colSpan:2},{}]},{cells:[{},{},{},{},{}]}],children:[{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-ColorPicker-palette shadow",alias:"cp",children:[M,O,R],slot:"0,0"},{scriptClass:"mstrmojo.Container",cssClass:"sbSlider",markupString:'<div class="{@cssClass}" style="position:relative; {@cssText}" mstrAttach:click,mouseover,mousemove,mousedown,mouseup,mouseout><div class="sbThumb"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},thumbNode:function(){return this.domNode.firstChild;}},markupMethods:{onbgColorChange:function(){this.domNode.style.backgroundColor=this.bgColor;}},hex:null,bindings:{hex:"this.parent.parent.colorModel.hex",bgColor:function(){return"#"+L.hsv2hex(this.parent.parent.colorModel.h,100,100);}},onhexChange:function(){if(this.domNode){this.thumbNode.style.left=this.parent.parent.colorModel.s/100*160-3+"px";this.thumbNode.style.top=(1-this.parent.parent.colorModel.v/100)*160-3+"px";}},onmousedown:function(){var T=this.domNode.getBoundingClientRect();this.mouseX0=T.left;this.mouseY0=T.top;this.onmousemove=this._update;var S=this;this.onmouseup=function(){S.onmousemove=null;mstrmojo.dom.detachEvent(document.body,"mouseup",S.onmouseup);};mstrmojo.dom.attachEvent(document.body,"mouseup",this.onmouseup);},onclick:function(S){this._update(S);},_update:function(S){var V={x:S.e.clientX,y:S.e.clientY},U=Math.min(Math.max(0,V.x-this.mouseX0),160),T=Math.min(Math.max(0,V.y-this.mouseY0),160);this.thumbNode.style.left=(U-3)+"px";this.thumbNode.style.top=(T-3)+"px";this.parent.parent.colorModel.s=Math.floor(100*U/160);this.parent.parent.colorModel.set("v",Math.floor(100*(1-T/160)));},slot:"0,1"},{scriptClass:"mstrmojo.Container",cssClass:"hueSlider",markupString:'<div class="{@cssClass}" style="position:relative; {@cssText}" mstrAttach:click,mouseover,mousedown,mouseup,mousemove,mouseout><div class="hThumb"></div></div>',markupSlots:{containerNode:function(){return this.domNode;},thumbNode:function(){return this.domNode.firstChild;}},bindings:{hex:"this.parent.parent.colorModel.hex",h:"this.parent.parent.colorModel.h"},onhexChange:function(){this._moveThumb();},onhChange:function(){this._moveThumb();},_moveThumb:function(){if(this.thumbNode){this.thumbNode.style.top=(1-this.parent.parent.colorModel.h/360)*160-1+"px";}},onmousedown:function(){this.mouseY0=this.domNode.getBoundingClientRect().top;this.onmousemove=this._update;var S=this;this.onmouseup=function(){S.onmousemove=null;mstrmojo.dom.detachEvent(document.body,"mouseup",S.onmouseup);};mstrmojo.dom.attachEvent(document.body,"mouseup",S.onmouseup);},onclick:function(S){this._update(S);},_update:function(S){var U={x:S.e.clientX,y:S.e.clientY},T=Math.min(Math.max(0,U.y-this.mouseY0),160);this.thumbNode.style.top=(T-1)+"px";this.parent.parent.colorModel.set("h",Math.max(0,Math.floor(360*(1-T/160))));},slot:"0,2"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-ColorPicker-preview",markupMethods:{onbgColorChange:function(){this.domNode.style.backgroundColor=this.bgColor;}},bindings:{bgColor:"this.parent.parent.colorModel.hex"},onclick:function(){if(Q.showUserPalette){D(this.bgColor);}},slot:"1,0"},I(mstrmojo.desc(7848,"Hex"),"Hex","1,0"),K(mstrmojo.desc(7848,"Hex"),"1,0","hex",{cssClass:"hex",cssDisplay:"block",inputNodeCssClass:"hex",dtp:25,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,validator:function(S){if(/^#[0-9a-fA-F]{6}$/.test(S)){return{code:mstrmojo.validation.STATUSCODE.VALID};}return{code:mstrmojo.validation.STATUSCODE.INVALID,msg:mstrmojo.desc(7882,"Please enter a 6-digit HEX color value in format: #xxxxxx")};}}}),I(mstrmojo.desc(3604,"Red"),"Red","1,1"),I(mstrmojo.desc(3606,"Green"),"Green","1,1"),I(mstrmojo.desc(3608,"Blue"),"Blue","1,1"),I(mstrmojo.desc(3605,"Hue"),"Hue","1,1"),I(mstrmojo.desc(3607,"Saturation"),"Saturation","1,1"),I(mstrmojo.desc(3609,"Brightness"),"Brightness","1,1"),K(mstrmojo.desc(3604,"Red"),"1,2","r"),G("r"),K(mstrmojo.desc(3606,"Green"),"1,2","g"),G("g"),K(mstrmojo.desc(3608,"Blue"),"1,2","b"),G("b"),K(mstrmojo.desc(3695,"Hue"),"1,2","h",{cssClass:"h",max:360}),G("h"),K(mstrmojo.desc(3607,"Saturation"),"1,2","s",{max:100}),G("s"),K(mstrmojo.desc(3609,"Brightness"),"1,2","v",{max:100}),G("v")]};if(this.showMoreColors){N.children.push({scriptClass:"mstrmojo.Button",cssClass:"more",alias:"more",title:mstrmojo.desc(7833,"More >>>"),onclick:function(){var S=this.parent.parent;S.set("expanded",!S.expanded);this.domNode.setAttribute("title",S.expanded?mstrmojo.desc(7834,"Less Colors"):mstrmojo.desc(7833,"More Colors"));this.domNode.className=S.expanded?"less":"more";},slot:"0,0"});}if(this.showGradients){N.children.push({scriptClass:"mstrmojo.Button",alias:"showGradients",cssClass:"ge",text:mstrmojo.desc(4786,"Gradients..."),title:mstrmojo.desc(7970,"Open Graident Editor"),onclick:function(){var S=this.parent.parent;S.set("show",false);S.parent.ge.set("show",true);},slot:"0,0"});}this.addChildren(N);this.addChildren({scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-ColorPicker-buttonBar",children:[mstrmojo.Button.newInteractiveButton(mstrmojo.desc(1442,"Ok"),function(){var S=this.parent.parent;if(!S.useAnimate){S.set("visible",false);}var T=S.colorModel.hex;if(S.showUserPalette){D(T);}S.set("selectedColor",T);if(S.onOK){S.onOK();}},"#999",{alias:"ok",cssClass:"mstrmojo-Editor-button"}),mstrmojo.Button.newInteractiveButton(mstrmojo.desc(221,"Cancel"),function(){var S=this.parent.parent;if(!S.useAnimate){S.set("visible",false);}if(S.onCancel){S.onCancel();}},"#999",{alias:"cancel",cssClass:"mstrmojo-Editor-button"})]});}});var J={scriptClass:"mstrmojo.Popup",slot:"popupNode",contentNodeCssClass:"mstrmojo-ColorPicker-popup-content",autoCloses:false,locksHover:true,colorPicker:null,onOpen:function(){this.colorPicker.set("selectedColor",this.opener.fillColor);var N=this;var M=function(){N.lastOpener=N.lastOpener||N.opener;if(N.opener!==N.lastOpener){N.opener.popupNode.appendChild(N.lastOpener.popupRef.domNode);N.lastOpener=N.opener;}N.colorPicker.set("show",true);};window.setTimeout(function(){M();},100);},onClose:function(){this.colorPicker.set("show",false);if(this.ge){this.ge.set("show",false);}},postCreate:function(){this.markupMethods=C.copy(this.markupMethods);this.markupMethods.onvisibleChange=null;},preBuildRendering:function(){if(this.showGradients||this.colorPicker.showGradients){this.addChildren(this.gradientRef);}},gradientRef:{scriptClass:"mstrmojo.GradientEditor",alias:"ge",cssText:"height:0; display:none; position:absolute; z-index: 4;",left:"0px",top:"0px",visible:false,showTitle:false,height:245,_resizeHandler:function(){},onOK:function(){this.parent.opener.set("gradient",this.gradient);this.parent.opener.set("gradientCss",this.gradient.css);this.set("show",false);},onCancel:function(){this.set("show",false);},onshowChange:function(O){var N=O.value,M=parseInt(this.height,10);var R=this.domNode.firstChild;if(N){this.set("model",this.parent.opener.gradient);R.style.display="block";}if(this.useAnimate!==false){var S=N?0:M,P=M-S,Q=this;R.style.overflow="hidden";if(N){R.style.display="block";}H(N,R,"height",S,P,function(){if(!N){R.style.display="none";var T=Q.parent.opener;if(T){T.closePopup();}}else{R.style.overflow="visible";}});}else{R.style.height=N?M+"px":0;R.style.display=N?"block":"none";}},postCreate:function(){this.bindings={useAnimate:"this.parent.opener.useAnimate"};}},children:[{scriptClass:"mstrmojo.ColorPicker",alias:"colorPicker",onChange:function(){if(!this.parent.opener){return ;}this.parent.opener.set("fillColor",this.selectedColor);this.set("show",false);this.parent.opener.closePopup();},onOK:function(){this.onApply();this._closePopup();},onApply:function(){this.parent.opener.set("fillColor",this.selectedColor);},onCancel:function(){this._closePopup();},_closePopup:function(){this.set("show",false);if(!this.showGradients||!this.parent.ge||(this.parent.ge&&!this.parent.ge.show)){this.parent.opener.closePopup();}},show:false,onEnd:function(){this.set("visible",this.show);},onshowChange:function(){var M=parseInt(this.expanded?this.fullHeight:this.height,10);if(this.useAnimate!==false){var Q=this.show?0:M,O=M-Q,P=this,N=(!this.show?function(){P.onEnd();}:null);if(this.show){this.set("visible",true);}H(this.show,this.domNode,"height",Q,O,N);}else{this.set("visible",this.show);this.domNode.style.height=M+"px";}},postCreate:function(){this.showGradients=this.parent.showGradients;this.bindings={showUserPalette:function(){return this.parent.opener?this.parent.opener.showUserPalette:this.showUserPalette;},useAnimate:function(){return this.parent.opener?this.parent.opener.useAnimate:this.useAnimate;},isSimple:function(){return this.parent.opener?this.parent.opener.isSimple:this.isSimple;},showNoColor:function(){return this.parent.opener?this.parent.opener.showNoColor:this.showNoColor;}};}}]};mstrmojo.colorPickerPopupRef=mstrmojo.insert(J);mstrmojo.simpleColorPickerPopupRef=mstrmojo.insert(C.copy({isSimple:true},C.copy(J)));mstrmojo.gradientColorPickerPopupRef=mstrmojo.insert(C.copy({showGradients:true},C.copy(J)));mstrmojo.ColorPicker.createDropDown=function E(O,N){O=O||{};var M=mstrmojo.colorPickerPopupRef;if(N){if(N.isSimple){M=mstrmojo.simpleColorPickerPopupRef;O.isSimple=N.isSimple;}else{if(N.showGradients){M=mstrmojo.gradientColorPickerPopupRef;O.showGradients=N.showGradients;}}}else{if(O){if(O.isSimple){M=mstrmojo.simpleColorPickerPopupRef;}else{if(O.showGradients){M=mstrmojo.gradientColorPickerPopupRef;}}}}return C.copy(O,{scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-ColorPicker-DropDownButton",markupMethods:{onfillColorChange:function(){if(this.boxNode&&this.fillColor){this.boxNode.style.cssText="background-color: "+this.fillColor;this.gradient=null;this.gradientCss=null;}},ongradientCssChange:function(){if(this.boxNode&&this.gradientCss){this.boxNode.style.cssText=this.gradientCss;this.fillColor=null;}}},popupRef:M,showUserPalette:true,useAnimate:true,showGradients:false,isSimple:false,fillColor:undefined});};}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo._IsInputControl","mstrmojo.dom","mstrmojo.num");var J=mstrmojo.validation,C=J.STATUSCODE,F=J.VALIDATOR,D=mstrmojo.expr.DTP,B=0,A=1,I=2,H=3,G=4,E=5;mstrmojo.DICAutoFocusButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.DICAutoFocusButton",markupString:'<div id="{@id}" class="mstrmojo-Button {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}" tabindex="1" mstrAttach:touchstart,click,mousedown,mouseup><div class="mstrmojo-Button-text {@innerIconClass}"></div></div>',postBuildRendering:function(){this._super();var K=this;setTimeout(function(){K.domNode.focus();},200);}});mstrmojo.TextFieldDIC=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.TextFieldDIC",cssClass:"mstrmojo-TextFieldDIC",dtp:D.VARCHAR,validationDelay:0,getInputNode:function(){return this.inputNode;},focus:function(){this.validate();mstrmojo.dom.setCaret(this.domNode,(this.value&&this.value.length||0));},init:function(K){if(this._super){this._super(K);}this.constraints=mstrmojo.hash.copy();var M=K.dic,N=this.constraints={trigger:mstrmojo.validation.TRIGGER.ONKEYUP},L=M.dt;if(M.ml){this.maxLength=M.ml;}if(M.psw){this.type="password";this.value=this.lv="";this.owner.applyPasswordMask&&this.owner.applyPasswordMask();}if(J.isNumeric(L)||J.isInt(L)||J.isString(L)){this.dtp=L;}switch(M.vm){case A:N.validator=F.VALIDATE_PHONENO;break;case I:N.validator=F.VALIDATE_EMAIL;break;case H:N.validator=F.VALIDATE_ZIPCODE;break;case G:N.validator=F.VALIDATE_SSN;break;case E:N.regExp=new RegExp("^"+M.rgx+"$");break;}N.min=M.emin?M.min:null;N.max=M.emax?M.max:null;N.maxLen=(M.ml!==undefined)?M.ml:null;N.minLen=(M.mnl!==undefined)?M.mnl:null;if(M.req){this.required=true;}},onInvalid:function(){if(this.popup){this.popup.set("hasInvalidData",true);}},onValid:function(){if(this.popup){this.popup.set("hasInvalidData",false);}},_set_value:function(L,K){if(this.value===undefined&&K===""){return ;}this._super(L,K);},applyChanges:function(){this.validate();if(this.isValid()){this._super();}else{if(!this.showByDefault){this.handleInvalid();return false;}}return true;},handleInvalid:function(){if(mstrmojo.all.mojoConfirmx9){return ;}var K=this;mstrmojo.confirm(this.validationStatus.msg+"\n("+mstrmojo.desc(9199)+")",null,{buttons:[{scriptClass:"mstrmojo.DICAutoFocusButton",text:mstrmojo.desc(1442),onclick:function(){K.focus();}},{scriptClass:"mstrmojo.Button",text:mstrmojo.desc(221),onclick:function(){if(K.popup){K.popup.onCancel();}else{K.undoValidate&&K.undoValidate();}}}],title:mstrmojo.desc(7548),cssClass:"mstrmojo-TextFieldDIC-ValidationError"});},cancelChanges:function(){this.inputNode.blur();this.value=this.lv;this.clearValidation();}});})();(function(){mstrmojo.requiresCls("mstrmojo.ui.menus.PopupConfig","mstrmojo.ui.menus.MenuEditor");mstrmojo.ui.menus.EditorConfig=mstrmojo.declare(mstrmojo.ui.menus.PopupConfig,[mstrmojo._HasBindings],{scriptClass:"mstrmojo.ui.menus.EditorConfig",data:null,fnOk:null,fnCancel:null,okEnabled:true,cancelEnabled:true,okVisible:true,cancelVisible:true,init:function D(E){this._super(E);if(this.data&&!mstrmojo.all[this.data.id]){mstrmojo.hash.make(this.data,mstrmojo.Obj);}this.initBindings();},clear:function A(){this._super();this.data=null;this.fnOk=this.fnCancel=mstrmojo.emptyFn;},newInstance:function C(){return new mstrmojo.ui.menus.MenuEditor({popupConfig:this});},destroy:function B(){if(this.data){this.data.destroy();}this.destroyBindings();this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.ui.menus.EditorConfig","mstrmojo.express.ui.SubtotalsWidget","mstrmojo.dom","mstrmojo.mstr.EnumDSSXMLDrillType");var K=mstrmojo.hash,G=mstrmojo.array,E=mstrmojo.mstr.EnumDSSXMLDrillType,M={STATIC:0,DRILLING:1,SELECTOR_CONTROL:2,HYPERLINK:4,SORT:8,PIVOT:16,EDIT:32,GROUP:64,CALCULATION:128,GROUP_EDIT:256,KEEP_ONLY:512,TOTAL_HEADER:1024};function D(T){return mstrmojo.resolveFeature("web-sort")&&!!(T&&(T.mix!==undefined&&T._e&&T._e.otp===4));}function P(U){var Y=new mstrmojo.ui.menus.MenuConfig(),X=U.data,T=U.cfg,W=[{n:mstrmojo.desc(1893,"Left"),btp:"l"},{n:mstrmojo.desc(1894,"Right"),btp:"r"},{n:mstrmojo.desc(13834,"To Beginning"),btp:"b"}],V=this.delegateActionToXtab;if(!T.tabularGrid){W.push({n:mstrmojo.desc(152,"Up"),btp:"u"},{n:mstrmojo.desc(153,"Down"),btp:"d"},{n:mstrmojo.desc(1891,"To Columns"),btp:"2"},{n:mstrmojo.desc(1890,"To Rows"),btp:"1"});}G.forEach(W,function(Z){if(U.xtab.model.isPvtButtonVisible(X,Z.btp)){Y.addMenuItem(Z.n,"xt",function(){V(U,"pivot",[Z.btp]);});}});return Y;}function B(W){var V=W.onDemandDrillItems;var U=W.onDemandDrillDynamicItems;if(!W.onDemandDrillItems&&!W.loadingDCM){W.loadingDCM=true;var Y=new mstrmojo.SimpleXHR({async:false});Y.request("POST",mstrConfig.taskURL,{success:function X(a){var Z=a.dynamicMenus[0];U=Z.items;V=a.menuItems;W.onDemandDrillItems=V;W.onDemandDrillDynamicItems=U;delete W.loadingDCM;}},{taskId:"RWOnDemandDrill",styleName:"OndemandDrillContextMenusStyle",viewMode:1,usePartDisplay:1,docGridKey:W.k,rwb:mstrApp.docModel.bs});}var T=[];G.forEach(U,function(d){var Z=d.idx,a=V[Z],c=JSON.parse(a.subMenuIndices||"[]");if(c.length>0){var b=[];G.forEach(c,function(e){b.push(V[e]);});a.items=b;}T.push(a);});return T;}function Q(U){var T="";switch(U){case E.DssXmlDrillToChild:T="drillDown";break;case E.DssXmlDrillToParent:T="drillUp";break;case E.DssXmlDrillToTemplate:T="drillTemplate";break;}return T;}function S(U,T){var W=parseInt(U.dt,10),V=parseInt(T.dt,10);if(W>V){return 1;}if(V>W){return -1;}return(U.n<T.n?-1:1);}function I(U){var T=G.filter(U,function(V){return[E.DssXmlDrillToChild,E.DssXmlDrillToParent].indexOf(V.dt)>-1;});return T.length>0?"drill":"";}mstrmojo.rw.xtab.XtabMenuConfig=mstrmojo.declare(mstrmojo.ui.menus.MenuConfig,null,{scriptClass:"mstrmojo.rw.xtab.XtabMenuConfig",xtab:undefined,data:undefined,isActionAvailable:function H(U,T){return((((U&&U.at)||0)&T)>0);},delegateActionToXtab:function J(T,W,U){var V=T.xtab;V[W].apply(V,[T.data].concat(U||[]));},buildXtabMenuConfig:function A(Y){var d=this.xtab=Y.xtab,W=d.id,X=this.selectedData=Y.data=Y.data||(d&&Y.td&&d.getCellForNode(Y.td)),a=d.model.getCellTitleInfo(X),Z={xtab:d,data:X,cfg:Y},c=this.delegateActionToXtab;this.selectedNode=Y.td;if(Y.onClose){this.addPopupHandlers(W,mstrmojo.emptyFn,Y.onClose);}var e=d.model.getCellLinksInfo(X)||{},V=e.links||[],T=this.isActionAvailable(X,M.HYPERLINK)&&V.length>0,U=this.isActionAvailable(X,M.DRILLING)&&(X.sdm==undefined),b=(X&&X.mix===undefined&&a.isSrcTitle&&X.otp!==-1);if(U){U=this.addDrillMenuItem(Z)?true:false;}if(T){V.forEach(function(g,f){this.addMenuItem(g.n||g.url||(g.target&&(g.target.n||g.target.did)),"",function(){c(Z,"link",[f]);});},this);}if(U||T){this.addSeparator();}this.addPivotMenuItem(Z);this.addSortMenuItem(Z);if(b){this.addSeparator();this.addShowTotalMenuItem(Z);}this.addRemoveMenuItem(Z);},addPivotMenuItem:function F(T){if(this.isActionAvailable(T.data,M.PIVOT)){var U=P.call(this,T);if(U.menus.length){this.addSubMenuItem(mstrmojo.desc(1889,"Move"),"",this.id,function(){return U;},T);this.addSeparator();}}},addDrillMenuItem:function N(T,V){var a=T.xtab,Z=T.data,U=this.delegateActionToXtab,Y=function(b){b.onDemandDrillItems=null;b.onDemandDrillDynamicItems=null;};var X=V?[V]:a.model.getAllDrillPathsForCell(Z);var W=B(a);if(X.length<1&&W.length<1){return ;}this.addPopupMenuItem(mstrmojo.desc(145,"Drill"),this.id,function(){var b=new mstrmojo.ui.menus.MenuConfig({menuCssClass:I(X),isHostedWithin:false,supportsScroll:true,alignWithAnchor:true,maxHeight:mstrmojo.dom.windowDim().h-50});X=X.sort(S);G.forEach(X,function(c){if(c&&c.k){b.addMenuItem(c.n||"",Q(c.dt),function(){U(T,"drill",[c]);Y(a);});}});G.forEach(W,function(c){b.addPopupMenuItem(c.n,"",function(){var d=new mstrmojo.ui.menus.MenuConfig({supportsScroll:true,maxHeight:350,isHostedWithin:false,alignWithAnchor:true,menuCssClass:I(c.items)});G.forEach(c.items,function(e){d.addMenuItem(e.n,Q(e.dt),function(){U(T,"drill",[e]);Y(a);});});return d;});});return b;});},addRemoveMenuItem:function L(T){if(T.data._e){if(T.data._e.otp!==4){return ;}}if(T.data.otp===-1){return ;}this.addSeparator();this.addMenuItem(mstrmojo.desc(190,"Remove"),"xt",this.delegateActionToXtab.bind(this,T,"removeUnit"),T);},addSortMenuItem:function R(T){var V=T.data,U=this.delegateActionToXtab,W=this.isActionAvailable(V,M.SORT);if(W){this.addMenuItem(mstrmojo.desc(7974,"Sort Ascending"),"xt",function(){U(T,"sort",[true]);},T);this.addMenuItem(mstrmojo.desc(7975,"Sort Descending"),"xt",function(){U(T,"sort",[false]);},T);}if(!T.cfg.hideAdvancedSort&&(W||D(V))){this.addMenuItem(mstrmojo.desc(11099,"Advanced Sort..."),"xt",function(){U(T,"advSort",[V.axis]);},T);}},addShowTotalMenuItem:function C(T){this.addEditorMenuItem(mstrmojo.desc(6193,"Show Totals"),this.id,this.getSubtotalEditorConfig,K.copy(T,{isTotals:true}));},getSubtotalEditorConfig:function O(U){var V=U.data,X=U.xtab,T=X.getBasicSubtotalEditorConfig(V.ast);T.fnOk=function W(){var Z=T.contents.getSubtotalTypes(),Y=X.model;X.controller.onShowTotals(X,Y.getShowTotalsUnitAction(V.id,V.otp,Z[0],Z[1]));};return T;}});mstrmojo.rw.xtab.XtabMenuConfig.ACTION_TYPES=M;mstrmojo.rw.xtab.XtabCellMenuItemContextType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.XtabBase","mstrmojo._Formattable","mstrmojo._IsSelectorTarget","mstrmojo._IsDocXtab","mstrmojo._XtabSelections","mstrmojo._XtabCellHoverMgr","mstrmojo.XtabCellHoverPopup","mstrmojo._HasPopup","mstrmojo.dom");var S=0,W="overflow:auto",V="overflow:hidden",K=mstrmojo.dom,g="mstrmojo.DocPanelStack",k="px",D=mstrmojo.DocDataService.SUPPRESS_DATA,c=mstrmojo.models.template.DataInterface,H=c.ENUM_GRID_RESIZE,f=H.FIXED,M=H.FIT_TO_WINDOW,G=H.FIT_TO_CONTENTS;var Y=function J(m,n){var o=m&&m.parent;while(o&&o.scriptClass!==g){if(o.scriptClass===n){return o;}o=o.parent;}return o;};mstrmojo.Xtab=mstrmojo.declare(mstrmojo.XtabBase,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo._IsDocXtab,mstrmojo._XtabSelections,mstrmojo._HasPopup],{scriptClass:"mstrmojo.Xtab",cellHoverMgr:"mstrmojo._XtabCellHoverMgr",cellHoverPopupRef:"mstrmojo.XtabCellHoverPopup",preBuildRendering:function A(){var o=this._super();var n=this.gridData;var m=this.lockHeadersCase===S&&n.co;this.scrollboxNodeOverflow=m&&!this.numRowFixed?V:W;var p=this.getFormats();if(mstrmojo.dom.isIE8&&!n.co&&this.lockHeadersCase===S&&(!n.rw||(n.rw&&(n.rw.row.bc>=n.rw.row.tc)))&&mstrmojo.string.isEmpty(p.height)&&mstrmojo.string.isEmpty(p.width)){this.scrollboxNodeOverflow="";}this._useFilter=this._useFilter||n.cssflt||false;return o;},postBuildRendering:function Z(){var o=this.gridData,n=this._super();if(this.supportsContextMenu()){var r=this;if(this.viewport){this.viewport.onmouseover=function(){r.addDisposable(r.requiresContrib("cellHoverMgr",true));r.viewport.onmouseover=null;};}}if(!this.getFormats().width&&this.model.docModel.addAutoWidthID&&(this.parent&&this.parent.scriptClass!=="mstrmojo.ExpressDocPanel")){this.model.docModel.addAutoWidthID(this.id);o=this.gridData;var m=o&&o.afc;if(m&&mstrmojo.dom.isIE7){var q=Y(this,g);if(q&&q.scriptClass===g){this.viewport.style.width=this.contentNode.offsetWidth+(this.scrollboxNode.offsetWidth-this.scrollboxNode.clientWidth)+"px";}}}if(K.isIE&&!K.isIE8&&this._useFilter){var t=this.scrollboxNode;window.setTimeout(function(){var p=document.createElement("img");t.appendChild(p);t.removeChild(p);},0);}return n;},supportsContextMenu:function L(){return !K.supportsTouches;},onCGBMapChange:function(m){if(this._resolveCGBToTKS(m.cgbMap)&&this._currentSelectedTD){this.defaultAction(this._currentSelectedTD);}},_resolveCGBToTKS:function e(v){if(!v){return false;}var t=this.model.scm,o="\u001E",q,n,r,p,m,u=false;for(n in t){r=t[n];p=r.cgb;for(q in p){m=v[p[q]];if(m){if(!r.tks){r.tks=m;u=true;}else{if(r.tks&&(r.tks.indexOf(m)<0)){r.tks+=o+m;u=true;}}}}}return u;},onGridWidthChanged:function U(m){if(this._super){this._super(m);}if(this.cellHoverMgr.onXtabWidthChanged){this.cellHoverMgr.onXtabWidthChanged();}},getDim:function(){var m=this.contentNode;return{w:m.scrollWidth,h:m.scrollHeight};},unrender:function B(m){var n=this.cellHoverMgr;if(n&&n.shutdown){n.shutdown();}this._super(m);},link:function E(n,m){this.controller.onLink(this,this.model.getLinkAction(n,m));},sort:function j(m,n){this.controller.onSort(this,this.model.getSortAction(m,n));},advSort:function O(m,n){this.controller.onGetAdvSortData(this,n,m._e&&m._e.otp);},pivot:function N(m,n){this.controller.onPivot(this,this.model.getPivotAction(m,n));},drill:function h(m,n){this.controller.onDrill(this,this.model.getDrillAction(this.getActionCells(m),n));},removeUnit:function Q(m){this.controller.onRemoveUnit(this,this.model.getRemoveTemplateUnitAction({id:m._e?m._e.oid:m.id,t:m._e?m._e.otp:m.otp}));},showTotal:function I(m,o,n){this.controller.onShowTotals(this,this.model.getTotalsAction(m,o,n));},derivedMetric:function d(m,r){var n,q=m._e.oid,o={did:q,alias:m._e.n,n:m._e.n,v:m.um?m.formula:m._e.v,idx:m.mix,host:this,nodeKey:this.k,dsid:this.controller.model.findDatasetIdFromUnit(q)||this.model.data.datasetId},t;if(r==="edit"){n={metricId:o.did,action:{cmd:"edit",n:o.n,alias:o.alias}};t=this.controller.model.getDataService().getEditDerivedMetricSubmitFunc(o);}else{n={metricId:"",action:{cmd:"editNew",refOi:{did:o.did,n:o.n}}};t=this.controller.model.getDataService().getAddNewDerivedMetricToXtabSubmitFunc(o);}var p=this.controller.model;if(p.isFromSolrCube&&p.isFromSolrCube(o.did)||p.isFromMDXCube(o.did)){n.disableAFB=true;}this.controller.openDME(this,n,t);},findSelectorControl:function C(){var m=this.gridData.sc;if(m&&parseInt(m.ct,10)===6){this.selectorControl=m;}else{delete this.selectorControl;}return this.selectorControl;},handlesMultiSelection:function b(n){var m=this.getCellForNode(K.findAncestorByName(n.getTarget(),"td",true,this.viewport)),p=m&&this.model.data.gts[m.axis===1?"row":"col"][m.tui||m.ui],o=p&&p.id&&p.sc;return !!(this.findSelectorControl()||o);},getBasicSubtotalEditorConfig:function X(o){var m=new mstrmojo.ui.menus.EditorConfig({contents:new mstrmojo.express.ui.SubtotalsWidget({onchange:function n(){var p=this.getSubtotalTypes(),q=p[0].length>0||p[1].length>0;m.set("okEnabled",q);}}),data:{},okEnabled:false});if(!this.model.data.gsi.hidesb){m.contents.set("selectedItems",o||[]);}return m;},updateRelatedColWidths:function P(n){var q=(new mstrmojo.models.template.DataInterface(this.gridData)).getColumnHeaderData(),p=this.gridData.twm||{},o=p.bottom,m=p.top;(n||[]).forEach(function(t){var u=q[t.colIndex],r=u._ridx||[];if(r.length>1){r.forEach(function(v){m[v].w=o[v].w=t.value;});}else{m[t.colIndex].w=o[t.colIndex].w=t.value;}});this.refresh();},updateScenario:function F(n){var m=this.gridData;m.afc=n===G;m.afw=n===M;if(n!==f){this.setAllXtabWidths("");}this.refresh();},setAllXtabWidths:function l(m){},changeResizeScenario:function a(v,AB,AC,w){var AE=new mstrmojo.models.template.DataInterface(this.gridData),o=this.gridData.twm||{},p=o.bottom,m=AE.getColumnHeaderData(),x=this,t=this.model,n=this.id,AD=this.k,q=[],r=[],u=1,AA=[];if(AB){q.push({act:"changeXtabColWidthScenario",value:v});m.forEach(function(AG,AF){var AJ=AG.oid||AG.id,AI=function(AK){return AK.unitId===AJ&&AK.depth===u;};if(!(AG.fs&&AG.fs.length>0)){u=1;}var AH=AJ===(AC&&AC.did)&&u===AC.depth;if(!AA.some(AI)){AA.push({unitId:AJ,depth:u});r.push({colIndex:AF,value:AH?AC.width+k:p[AF].w});if(v===f){q.push(t.getColumnResizeAction(AJ,AG.otp,AH?AC.width:parseInt((p[AF].w)||0,10),u,AH?AC.isExtra:false));}}u++;});var z=function z(AF,AH){var AG=mstrmojo.all[n];if(AF===f){x.updateRelatedColWidths(AH);}x.updateScenario(AF);};z(v,r);x.submitColumnWidthChange(q,w);}return w?q:undefined;},submitColumnWidthChange:function T(o,m){if(!m){this.model.getDataService().submitTemplateUpdates(this.k,o,{success:function n(){}},D);}},changeColumnWidth:function R(q,z,n,AA,o,v){var AC=new mstrmojo.models.template.DataInterface(this.gridData),m=AC.getColumnHeaderData(),t=this.model,p=[],x=this,r=[],u=1,w=-1,AB=[];if(AC.getColResizeScenario()!==f){p=this.changeResizeScenario(f,true,{did:q,t:z,width:n,depth:AA,isExtra:o},v);return v?p:undefined;}if(q==="all"){m.forEach(function(AE,AD){var AH=AE.oid||AE.id,AG=function(AI){return AI.unitId===AH&&AI.depth===u;},AF=m[AD-1];if(!(AE.fs&&AE.fs.length>0)||(AF&&AH!==(AF.oid||AF.id))){u=1;}if(!AB.some(AG)){AB.push({unitId:AH,depth:u});r.push({colIndex:AD,value:n+k});p.push(t.getColumnResizeAction(AH,AE.otp,n,u,false));}u++;});}else{m.every(function(AE,AD){var AF=(AE.oid===q||AE.id===q);if(AF){w=AD+AA-1;}return !AF;});if(w>=0){r.push({colIndex:w,value:n+k});p.push(t.getColumnResizeAction(q,z,n,AA,o));}}x.updateRelatedColWidths(r);x.submitColumnWidthChange(p,v);return v?p:undefined;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.FieldSet","mstrmojo._FormatDefinition","mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ColorPicker");var C=mstrmojo.hash,A=mstrmojo.color,D=mstrmojo._FormatDefinition;var B=function(F,I,E){var H=["Left","Right","Top","Bottom"];for(var G=0;G<3;G++){F[H[G]+I]=E;}F.set(H[3]+I,E);};mstrmojo.BorderFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.BorderFormatter",cssClass:"mstrmojo-BorderFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){C.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"borders",cssClass:"mstrmojo-FormatEditor-border",legend:mstrmojo.desc(2886),children:[{scriptClass:"mstrmojo.Table",alias:"borderTable",cssText:"width:100%;",rows:1,cols:2,children:[{scriptClass:"mstrmojo.List",alias:"borderTypes",selectedIndex:0,cssClass:"borderTypes",items:[{n:'<img border="0" align="absmiddle" src="../images/borders_none.gif" alt=""> '+mstrmojo.desc(2057),v:1},{n:'<img border="0" align="absmiddle" src="../images/borders_all.gif" alt=""> '+mstrmojo.desc(2058),v:2},{n:'<img border="0" align="absmiddle" src="../images/borders_custom.gif" alt=""> '+mstrmojo.desc(2056),v:3}],slot:"0,0",bindings:{m:"this.parent.parent.parent.model",selectedIndex:function(){var E=this.m;if(C.isEmpty(E)){return 0;}if(E.LeftStyle==0&&E.TopStyle==0&&E.RightStyle==0&&E.BottomStyle==0){return 0;}else{if(E.LeftStyle==E.TopStyle&&E.LeftStyle==E.RightStyle&&E.LeftStyle==E.BottomStyle){return 1;}}return 2;}},onchange:function(E){if(this.m){var G=this.parent.borderAndColor;if(!G){return ;}if(this.selectedIndex===0){var H=["Left","Right","Top","Bottom"];for(var F=0;F<4;F++){this.m.set(H[F]+"Style","0");this.m.set(H[F]+"Color","0");}}}}},{scriptClass:"mstrmojo.Container",alias:"borderAndColor",markupString:'<div class="borderStyles"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.Container",alias:"allBordersContainer",markupString:'<div class="mstrmojo-FormatEditor-ColorLine-borders"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},bindings:{visible:"this.parent.parent.borderTypes.selectedIndex==1"},children:[{scriptClass:"mstrmojo.Table",alias:"allBorders",rows:1,cols:3,onshowChange:function(){if(this.show){B(this.m,"Style",this.styles.value);B(this.m,"Color",A.encodeColor(this.colors.fillColor));}},bindings:{m:"this.parent.parent.parent.parent.parent.model"},postCreate:function(){var F=["Left","Right","Top","Bottom"];var E=[{scriptClass:"mstrmojo.Pulldown",alias:"styles",items:D.BorderStyles,itemIdField:"v",bindings:{m:"this.parent.m",value:function(){var I=this.m.LeftStyle,K=this.m.RightStyle,J=this.m.TopStyle,H=this.m.BottomStyle;var G=0;if(I==K&&K==H&&H==J){G=mstrmojo.array.find(D.BorderStyles,"v",I);}G=G==-1?0:G;return this.items[G][this.itemIdField];}},onvalueChange:function(){if(this.parent.parent.visible){B(this.m,"Style",this.value);}},slot:"0,1"},mstrmojo.ColorPicker.createDropDown({alias:"colors",bindings:{m:"this.parent.m",fillColor:function(){var H=this.m.LeftColor,K=this.m.RightColor,J=this.m.TopColor,G=this.m.BottomColor;if(H==K&&K==G&&G==J){var I=H;}if(typeof (I)!="undefined"&&/^\d{1,8}$/.test(I)){return A.decodeColor(I);}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.visible){B(this.m,"Color",this.fillColor=="transparent"?"pru":A.encodeColor(this.fillColor));}},slot:"0,2"})];this.addChildren(E);}}]},{scriptClass:"mstrmojo.Container",alias:"customBordersContainer",markupString:'<div class="mstrmojo-FormatEditor-ColorLine-borders"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},bindings:{visible:"this.parent.parent.borderTypes.selectedIndex==2"},children:[{scriptClass:"mstrmojo.Table",alias:"customBorders",rows:1,cols:3,bindings:{m:"this.parent.parent.parent.parent.parent.model"},postCreate:function(){var H=["Left","Right","Top","Bottom"];var G=[];for(var F=0;F<H.length;F++){var E=H[F];G.push({scriptClass:"mstrmojo.Label",text:mstrmojo.desc({Left:3528,Right:3529,Top:3526,Bottom:3527}[E]),alias:E,slot:"0,0"},{scriptClass:"mstrmojo.Pulldown",items:D.BorderStyles,itemIdField:"v",pr:E+"Style",bindings:{m:"this.parent.m",value:function(){var K=this.m.LeftStyle,M=this.m.RightStyle,L=this.m.TopStyle,J=this.m.BottomStyle;var I=mstrmojo.array.find(D.BorderStyles,"v",this.m[this.pr]);I=I==-1?0:I;return this.items[I][this.itemIdField];}},onvalueChange:function(){if(this.parent.parent.visible){this.m.set(this.pr,this.value);}},slot:"0,1"},mstrmojo.ColorPicker.createDropDown({cssClassx:"mstrmojo-FormatEditor-colorPicker",alias:E+"Color",pr:E+"Color",bindings:{m:"this.parent.m",fillColor:function(){var J=this.m.LeftColor,M=this.m.RightColor,L=this.m.TopColor,I=this.m.BottomColor;var K=this.m[this.pr];if(typeof (K)!="undefined"&&/^\d{1,8}$/.test(K)){return A.decodeColor(K);}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.visible){this.m.set(this.pr,this.fillColor=="transparent"?"pru":A.encodeColor(this.fillColor));}},slot:"0,2"}));}this.addChildren(G);}}]}],slot:"0,1"}]},{scriptClass:"mstrmojo.Label",cssClass:"borderPreview",text:mstrmojo.desc(7941),bindings:{m:"this.parent.parent.model",cssText:function(){var G={0:"None",3:"Dashed",4:"Dotted",6:"Double",7:"Solid"},E={1:"Thin",5:"Thick",6:"medium"};var F=this.parent.borderTable.borderTypes.selectedIndex;return";border-left-style: "+(G[this.m.LeftStyle]||"solid")+";border-right-style: "+(G[this.m.RightStyle]||"solid")+";border-top-style: "+(G[this.m.TopStyle]||"solid")+";border-bottom-style: "+(G[this.m.BottomStyle]||"solid")+";border-left-color: "+A.decodeColor(this.m.LeftColor||"0")+";border-right-color: "+A.decodeColor(this.m.RightColor||"0")+";border-top-color: "+A.decodeColor(this.m.TopColor||"0")+";border-bottom-color: "+A.decodeColor(this.m.BottomColor||"0")+";border-left-width: "+(E[this.m.LeftStyle]||"thin")+";border-right-width: "+(E[this.m.RightStyle]||"thin")+";border-top-width: "+(E[this.m.TopStyle]||"thin")+";border-bottom-width: "+(E[this.m.BottomStyle]||"thin");}}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.FieldSet","mstrmojo.Label","mstrmojo.ColorPicker");var A=mstrmojo.hash,B=mstrmojo.color;mstrmojo.FillFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.FillFormatter",cssClass:"mstrmojo-FillFormatter",isChart:false,markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){A.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.FieldSet",alias:"fill",cssClass:"mstrmojo-FormatEditor-fill",legend:mstrmojo.desc(2885,"Fill"),bindings:{legend:"this.parent.isChart ? mstrmojo.desc(3902, 'Series Colors') : mstrmojo.desc(2885, 'Fill')"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2060,"Color"),cssClass:"label"},mstrmojo.ColorPicker.createDropDown({bindings:{m:"this.parent.parent.model",fillStyle:function(){var H=this.m,J=parseInt(H.FillStyle,10);if(J===2){var E=parseInt(H.GradientAngle,10),I=E===0?1:0,D=B.decodeColor(H.FillColor),K=B.decodeColor(H.GradientColor),C=parseInt(H["Gradient"+(E===0?"X":"Y")+"Offset"],10)===100?1:0,G=(C!==1)?mstrmojo.css.buildGradient(I,D,K):mstrmojo.css.buildGradient(I,K,D);this.set("gradientCss",G.n+":"+G.v);this._updateGradientInfo();}else{var F=this.m.FillColor;if(F!==undefined&&/^\d{1,8}$/.test(F)){F=B.decodeColor(F);}else{F="transparent";}this.set("fillColor",F);}return J||0;}},_updateGradientInfo:function(){var C=this.m;this.gradient=mstrmojo.hash.copy({FillColor:B.decodeColor(C.FillColor),GradientColor:B.decodeColor(C.GradientColor)},A.copy(C));},onfillColorChange:function(){this.m.FillColor=(this.fillColor==="transparent"?"pru":B.encodeColor(this.fillColor));this.m.FillStyle=0;},ongradientChange:function(C){var F=["FillStyle","FillColor","GradientColor","GradientXOffset","GradientYOffset","GradientAngle"],E;for(E=0;E<F.length;E++){var D=C.value[F[E]];this.m[F[E]]=/Color$/.test(F[E])?B.encodeColor(D):D;}this.m.FillStyle=2;}},{showGradients:true})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo._FormatDefinition","mstrmojo.Table","mstrmojo._HasLayout","mstrmojo.color","mstrmojo.ColorPicker");var D=mstrmojo.hash,C=mstrmojo.array,F=mstrmojo._FormatDefinition,B=mstrmojo.color;var A=function(G){var H={scriptClass:"mstrmojo.List",cssClass:"mstrmojo-FormatEditor-fontFamily",itemCssClass:"mstrmojo-FormatEditor-bullet",selectedIndex:0,itemIdField:"v",itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>'};return D.copy(G,H);};var E=function(I){var H=I.alias,G=I.label,J=I.pr;return{alias:H,scriptClass:"mstrmojo.TristateCheckBox",text:G,checked:false,grayed:false,bindings:{m:I.modelBinding,checked:function(){return this.m[J]==-1;},grayed:function(){return(typeof this.m[J]=="undefined")||this.m[J]=="pru";}},oncheckedChange:function(K){if(this.m){this.m.set(J,this.checked?-1:0);}}};};mstrmojo.FontFormatter=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.FontFormatter",cssClass:"mstrmojo-FontFormatter",markupString:'<div id={@id} class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},postCreate:function(){this.onmodelChange();},onmodelChange:function(){if(this.model&&!this.model.scriptClass){D.make(this.model,mstrmojo.Obj);}},children:[{scriptClass:"mstrmojo.Table",layout:[{cells:[{},{},{}]},{cells:[{},{colSpan:2}]}],children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2172),slot:"0,0"},A({items:F.Families,itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text" style="font-family:{@n}">{@n}</div></div>',pr:"Name",bindings:{selectedIndex:function(){var H=this.parent.parent.model;if(H){var I=H.Name,G=C.find(this.items,this.itemIdField,I);return G==-1?0:G;}}},onchange:function(){var G=this.parent.parent.model;if(G){G.set("Name",this.selectedItem.v);}},slot:"0,0"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3059),slot:"0,1"},A({items:F.Styles,cssClass:"mstrmojo-FormatEditor-fontStyle",bindings:{selectedIndex:function(){var K=this.parent.parent.model;if(K){var I=K.Bold||"",H=K.Italic||"",J=I==""&&H==""?"":I+","+H,G=mstrmojo.array.find(this.items,this.itemIdField,J);G=G==-1?mstrmojo.array.find(this.items,"v2",J):G;return(G==-1?0:G);}}},onchange:function(){var I=this.parent.parent.model;if(I&&this.selectedItem){var H=this.selectedItem.v.split(","),G=italic="pru";if(H[0]!="pru"){G=H[0]=="-1"?"-1":"0";italic=H[1]=="-1"?"-1":"0";}I.set("Bold",G);I.set("Italic",italic);}},slot:"0,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2178),slot:"0,2"},A({items:F.Sizes,cssClass:"mstrmojo-FormatEditor-fontSize",bindings:{selectedIndex:function(){var H=this.parent.parent.model;if(H){var I=H.Size,G=C.find(this.items,this.itemIdField,I);return G==-1?0:G;}}},onchange:function(){var G=this.parent.parent.model;if(G){G.set("Size",this.selectedItem.v);}},slot:"0,2"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3060),slot:"1,0"},{scriptClass:"mstrmojo.VBox",cssClass:"mstrmojo-FormatEditor-fontEffect",postCreate:function(){this.addChildren(E({alias:"Underline",label:mstrmojo.desc(3061),pr:"Underline",modelBinding:"this.parent.parent.parent.model"}));this.addChildren(E({alias:"Strikeout",label:mstrmojo.desc(3062),pr:"Strikeout",modelBinding:"this.parent.parent.parent.model"}));},slot:"1,0"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(3063),slot:"1,1"},mstrmojo.ColorPicker.createDropDown({pr:"Color",bindings:{fillColor:function(){var G=this.parent.parent.model;if(G){var H=G[this.pr];if(typeof (H)!="undefined"&&/^\d{1,8}$/.test(H)){return B.decodeColor(H);}}return"transparent";}},onfillColorChange:function(){if(this.parent.parent.model){this.parent.parent.model.set(this.pr,this.fillColor=="transparent"?"pru":B.encodeColor(this.fillColor));}},slot:"1,1"}),{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2036),slot:"1,1"},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FormatEditor-fontPreview",text:mstrmojo.desc(2037),bindings:{m:"this.parent.parent.model",cssText:function(){var H=this.m.Color,J=this.m.Size,K=this.m.Name,I=this.m.Bold,G=this.m.Italic,M=this.m.Underline,L=this.m.Strikeout;H=/^\d{1,8}$/.test(H)?B.decodeColor(H):B.decodeColor(F.DefaultFormat.FormattingFont.Color);J=J||F.DefaultFormat.FormattingFont.Size;K=K||F.DefaultFormat.FormattingFont.Name;I=I=="-1"?"bold":"normal";G=G=="-1"?"italic":"normal";M=parseInt(M)==-1;L=parseInt(L)==-1;return";font-family:"+K+";font-style:"+G+";font-weight:"+I+";font-size:"+J+"pt;color:"+H+";text-decoration:"+(M?" underline ":"")+(L?" line-through ":"");}},slot:"1,1"}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.TextBox","mstrmojo.Button","mstrmojo.HBox","mstrmojo.EnumAuthenticationModes","mstrmojo.UsherLogin","mstrmojo.string","mstrmojo.cookies");mstrmojo.requiresDescs(17,18,221,11804,11863);var E=mstrmojo.EnumAuthenticationModes,D={};D[E.LDAP]=mstrmojo.desc(1947,"LDAP Authentication");D[E.DATABASE]=mstrmojo.desc(1948,"Database Authentication");var K={LIVE_OR_HL:0,PERSISTED:1};function B(){return(JSON.parse(decodeURIComponent(mstrmojo.cookies.getCookieSetting("lastMsgID")||"{}")))[mstrConfig.lastMsgKey];}function C(){var P=this,Q=P.stdLoginInfo,N=Q.user.value,M=Q.tsvCode.value,R=Q.pwd.value,S={taskId:"login",server:mstrConfig.serverName,project:mstrmojo.string.decodeHtmlString(mstrConfig.projectName),port:mstrConfig.serverPort,authMode:mstrConfig.authMode,setAsActiveSession:true};var O=B();if(O){S.msgID=O;}if((this.authMode&(E.STANDARD|E.LDAP|E.DATABASE))>0){S.userid=N;S.password=R;S.tsvCode=M;}mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(V){if(V&&V.sessionState){mstrApp.updateSessionState(V.sessionState);if(mstrApp.sessionManager){mstrApp.sessionManager.restart();}var X=V;var U=V.resCode;if(U==K.LIVE_OR_HL&&(mstrApp.isVI||mstrApp.scriptClass==="mstrmojo.OIVMApp"||mstrApp.analysisID)){mstrmojo.xhr.request("post",mstrConfig.taskURL,{success:function(){var Y=P.config.callback,Z=Y.success;if(Z){Z(X);}},failure:function(){mstrmojo.form.send({evt:3010,src:mstrApp.name+".3010"},null,"POST");}},{taskId:"docXMLResults",sessionState:V.sessionState,msgID:V.msgID,resultFlags:33554432});}else{var T=P.config.callback,W=T.success;if(W){W(X);}}}P.destroy();},failure:function(T){mstrmojo.alert(T.getResponseHeader("X-MSTR-TaskFailureMsg"),null,null,P.zIndex);}},S);}function L(){if(mstrApp.sessionManager){mstrApp.sessionManager.gotoLogoutPage();}}mstrmojo.LoginEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.LoginEditor",cssClass:"mstrmojo-LoginEditor",title:mstrmojo.desc(11804,"Log in to"),btnAlignment:"right",help:"login_box",config:{callback:{},taskParams:{}},authMode:E.STANDARD,usherEnabled:false,init:function J(M){this._super(M);this.title+=" "+mstrApp.projectName;this.set("authMode",parseInt(mstrConfig.authMode,10));if(this.isUsherLogin()){mstrmojo.css.addWidgetCssClass(this,"usher");}},isUsherLogin:function(){return this.authMode===E.USHER;},onvisibleChange:function I(){if(this.visible&&(mstrmojo.dom.isFF||mstrmojo.dom.isWK)){var M=this.stdLoginInfo.user;window.setTimeout(function(){M.focus();},50);}},onClose:function F(){L();},destroy:function H(){mstrmojo.dom.detachEvent(document.body,"mousedown",this.stopPropagation,true);this._super();},postBuildRendering:function A(){if(this.authMode===mstrmojo.EnumAuthenticationModes.NTCREDENTIAL){C.call(this);return ;}else{var M=this._super();this.stopPropagation=function(N){N.stopPropagation();};mstrmojo.dom.attachEvent(document.body,"mousedown",this.stopPropagation,true);return M;}},preBuildRendering:function G(){if(this.isUsherLogin()){var N=this,M=mstrmojo.insert({scriptClass:"mstrmojo.UsherLogin",alias:"usherLogin",onUsherLogin:function(){mstrConfig.authMode=E.USHER;C.call(N);}});this.addChildren([M],1);}return this._super();},children:[{scriptClass:"mstrmojo.Label",cssText:"margin-bottom: 20px; line-height: 1.5em;",text:mstrmojo.desc(11863,"Your user session has timed out due to inactivity, and you have been automatically logged out. Please log in again.")},{scriptClass:"mstrmojo.Box",alias:"stdLoginInfo",cssClass:"std-login-container",bindings:{visible:function(){return this.parent.authMode!==E.USHER;}},children:[{scriptClass:"mstrmojo.TextBox",alias:"user",cssClass:"login-username",cssDisplay:"block",hint:mstrmojo.desc(17,"User name"),postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(17,"User name");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.TextBox",alias:"pwd",cssClass:"login-pwd",cssDisplay:"block",hint:mstrmojo.desc(18,"Password"),type:"password",postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(18,"Password");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.TextBox",alias:"tsvCode",cssClass:"login-tsvCode",cssDisplay:"block",hint:mstrmojo.desc(13825,"Usher code"),bindings:{visible:function(){return mstrConfig.features["is-two-step-verification-required"];}},postCreate:function(){if(mstrmojo.dom.isIE9||mstrmojo.dom.isIE8||mstrmojo.dom.isIE7){this.emptyText=mstrmojo.desc(13825,"Usher code");}},onEnter:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-LoginEditor-authMode",bindings:{visible:function(){return this.parent.parent.authMode===E.LDAP||this.parent.parent.authMode===E.DATABASE;},text:function(){return D[this.parent.parent.authMode]||"";}}}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btns",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:mstrmojo.desc(26,"Login"),bindings:{enabled:"this.parent.parent.stdLoginInfo.user.value.length > 0",visible:function(){return this.parent.parent.authMode!==E.USHER;}},onclick:function(){C.call(this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){L();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Stepper","mstrmojo._HasLayout","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.expr","mstrmojo.css");var C=mstrmojo.expr.DTP,B=mstrmojo.css,A="mstrmojo-Stepper-ErrValidation";mstrmojo.ui.editors.controls.Stepper=mstrmojo.declare(mstrmojo.Stepper,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.editors.controls.Stepper",markupString:'<div id="{@id}" class="mstrmojo-Stepper {@orientation} {@cssClass}" mstrAttach:click,mousedown,mouseup,mousemove,selectstart><div class="title">{@title}</div><div class="next">+</div><div class="text"></div><div class="prev">-</div></div>',layoutConfig:{w:{textNode:"100%"},xt:true},textInput:null,init:function E(F){var G=F.provider;this.children=[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"textInput",slot:"textNode",dtp:G.dtp||C.INTEGER,constraints:{validator:G.validator,max:G.max,min:G.min},onValid:function(){var H=this.parent;B.removeClass(H.domNode,A);G.setVal(parseInt(this.value,10)||0);H.updateDisplayText();}}];this._super(F);this.addDisposable(G);B.addWidgetCssClass(this,"mstrmojo-ui-ctrl-Stepper");},postBuildRendering:function(){this.updateDisplayText();this._super();},updateDisplayText:function D(){this.textInput.set("value",this.provider.getVal());}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.ui.editors.controls.ValidationTextBox","mstrmojo.EditableLabel");var A=mstrmojo.css,E=mstrmojo.validation.STATUSCODE;mstrmojo.ui.editors.controls.ComboBox=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",markupMethods:{onenabledChange:function D(){this.txtLabel.set("editOnClick",this.enabled);A.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function B(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-ComboBox");},updatePreview:function C(){this.txtLabel.set("value",this.selectedValue||"");},updateSelection:function(){this.set("selectedValue",this.txtLabel.value);},validateTextInput:function(F){return true;},txtLabel:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ValidationTextBox",alias:"txtLabel",slot:"previewNode",constraints:{validator:function(){if(!this.parent.validateTextInput(this.value)){return{id:this.id,code:E.INVALID,msg:""};}}},onValid:function(){this.parent.updateSelection();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.string","mstrmojo.dom","mstrmojo.css","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.ui.menus.MenuConfig");var D=mstrmojo.string,A=mstrmojo.dom,E=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function B(){var K=this,J=K.statusList,F=J&&J.length||0,G=K.statusConfig||new mstrmojo.ui.menus.MenuConfig(),L=function(M){return function(N){K.set("status",M);K.onStatusClick(M);};};if(!G.hasMenuItems()&&F){for(var H=0;H<F;H++){var I=J[H];G.addMenuItem(I.n,I.cls||"",L(I),K);}}else{}if(G.hasMenuItems()){G.alignment=K.alignment||{host:E.BOTTOM_LEFT,popup:E.TOP_LEFT};G.hostId=K.id;G.hostElement=K[K.hostElementName]||K.domNode;K.openPopup(G.newInstance());}}function C(){var F=this.statusConfig||this.statusList&&this.statusList.length>1;this.menuButtonNode.style.display=F?"":"none";}mstrmojo.ui.StatusButton=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.ui.StatusButton",markupString:'<div id="{@id}" class="mstrmojo-StatusButton {@cssClass} {@iconClass}" title="{@title}" style="{@cssText}"><div class="mstrmojo-Button {@innerIconClass}"  mstrAttach:click><span class="mstrmojo-text"></span></div><div class="menuButton" mstrAttach:click></div></div>',markupSlots:{textNode:function(){return this.domNode.firstChild;},textSpanNode:function(){return this.domNode.firstChild.firstChild;},menuButtonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onstatusChange:function(){this.textSpanNode.innerHTML=D.encodeHtmlString(this.status&&this.status.n||"");},onstatusListChange:function(){C.call(this);},onstatusConfigChange:function(){C.call(this);}},status:null,statusList:null,statusConfig:null,onclick:function(F){var G=A.eventTarget(F.hWin,F.e);if(A.contains(this.menuButtonNode,G,true)){B.call(this);}else{if(A.contains(this.textNode,G,true)){this.onButtonClick(this.status,F);}}},onButtonClick:mstrmojo.emptyFn,onStatusClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.GraphBase","mstrmojo._Formattable","mstrmojo._IsSelectorTarget","mstrmojo.tooltip");var P=mstrmojo.dom,K=mstrmojo.array,I=mstrmojo.mstr.EnumDSSXMLDrillType;function B(W){var X=W.getFormats();if(!X.width&&"gp" in X){X=X.gp;}W.resizeForDisplayState(parseInt(X.height,10),parseInt(X.width,10),false);}function R(X){var W="";switch(X){case I.DssXmlDrillToChild:W="drillDown";break;case I.DssXmlDrillToParent:W="drillUp";break;case I.DssXmlDrillToTemplate:W="drillTemplate";break;}return W;}function L(X,Z){var W=Z.offsetX,a=Z.offsetY,Y=X.coords.split(",");switch(X.shape){case"rect":case"poly":break;case"circle":W=Y[0];a=Y[1];}return{x:W,y:a};}function U(X,W){var Z=parseInt(X.tp,10),Y=parseInt(W.tp,10);if(Z>Y){return 1;}if(Y>Z){return -1;}return(X.n<W.n?-1:1);}function E(X){var W=P.position(this.domNode),Y=P.getMousePosition(X);return{x:Y.x-Math.floor(W.x),y:Y.y-Math.floor(W.y)};}function H(d,b){var Y=P.eventTarget(b,d),a=Y&&Y.parentNode,f=a&&a.children,W=[],Z=Y.getAttribute("coords");if(f&&!!Z){for(var X=0;X<f.length;++X){if(f[X]&&f[X].getAttribute&&f[X].getAttribute("coords")==Z){W.push(f[X]);}}}return W;}function D(Z,a,Y,X,W){return function(){var c={taskId:"getElementFromGraph",msgID:Z.model.docModel.mid,nodeKey:Z.node.k,sliceID:Z.node.data.sid,x:a.layerX,y:a.layerY},b={success:function(e){var d={mix:X,els:e.els},f=Z.model.getLinkActionImpl(d,Y,W);Z.controller.onLink(Z,f);},failure:function(d){}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,b,c);};}mstrmojo.DocXtabGraph=mstrmojo.declare(mstrmojo.GraphBase,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.DocXtabGraph",cssClassPrefix:"mstrmojo-DocXtabGraph",areaMarkup:'<area shape="{@shape}" coords="{@coords}" ttl="{@tooltip}" aid="{@aid}" onclick="mstrmojo.all[\'{@id}\'].onClickArea(this, event);" oncontextmenu="mstrmojo.all[\'{@id}\'].onContextMenu(this, event);" onmousemove="mstrmojo.all[\'{@id}\']._updateTooltip(event, self);" {@extra}/>',_att:"",markupSlots:{imgNode:function(){return this.domNode.childNodes[1];},mapNode:function(){return this.domNode.childNodes.length>2?this.domNode.childNodes[2]:null;},textNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","background-color","fx"]},markupMethods:{onvisibleChange:function(){this.domNode.style.display=(this.visible)?"block":"none";}},onClickArea:function Q(Y,a){a=a||window.event;var g=E.apply(this,[a]),b=this.defn,W=P.position(this.domNode),X=this.as[Y.getAttribute("aid")],f=this.k,d=g.x,c=g.y,Z={getBoundingClientRect:function(){var h=W.x+d,e=W.y+c;return{left:h,top:e,right:h+1,bottom:e+1};},w:this};this.showInfoWin(X.ifw,X.tks,Z);this.model.docModel.slice({type:parseInt(b.t,10)||mstrmojo.EnumRWUnitType.GRAPH,src:f,ck:b.ck,gk:f,tks:X.tks,cks:X.cks,sid:this.node.data.sid,x:d,y:c,anchor:Z,tty:X.tty});},onContextMenu:function O(Z,f){f=f||window.event;var h=this,l=this.getFormats(),W=parseInt(l.height,10),c=parseInt(l.width,10),Y=this.as[Z.getAttribute("aid")],g=Y.lm||[],b=Y.dp||[];mstrmojo.dom.preventDefault(window,f);var d=new mstrmojo.ui.menus.MenuConfig({hostId:this.id,isHostedWithin:false,hostElement:this,position:{x:f.pageX,y:f.pageY}});if(g.length!==0){d.addPopupMenuItem(mstrmojo.desc(5752,"Links"),this.id,function(){var o=new mstrmojo.ui.menus.MenuConfig();for(var n=0;n<g.length;n++){var e=g[n].links;for(var m=0;m<e.length;m++){o.addMenuItem(e[m].n||e[m].url||(e[m].target&&(e[m].target.n||e[m].target.did)),"",D(h,f,Y,n,m));}}return o;});}var k=function k(o){var n=o.onDemandDrillItems;var m=o.onDemandDrillDynamicItems;if(!o.onDemandDrillItems&&!o.loadingDCM){o.loadingDCM=true;var q=new mstrmojo.SimpleXHR({async:false});q.request("POST",mstrConfig.taskURL,{success:function p(t){var r=t.dynamicMenus[0];if(r&&r.items){m=r.items;}n=t.menuItems;o.onDemandDrillItems=n||[];o.onDemandDrillDynamicItems=m||[];delete o.loadingDCM;}},{taskId:"RWOnDemandDrill",styleName:"OndemandDrillContextMenusStyle",viewMode:2,docGridKey:o.k,rwb:mstrApp.docModel.bs});}var e=[];K.forEach(m,function(w){var r=w.idx,t=n[r],v=JSON.parse(t.subMenuIndices||"[]");if(v.length>0){var u=[];mstrmojo.array.forEach(v,function(x){u.push(n[x]);});t.items=u;}e.push(t);});return e;};var a=k(this.model.xtab);if((b.length>0)||(a.length>0)){b=b.sort(U);var j=L(Y,f);d.addPopupMenuItem(mstrmojo.desc(145,"Drill"),this.id,function(){var p=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"drill",isHostedWithin:false,supportsScroll:true,maxHeight:mstrmojo.dom.windowDim().h-50});for(var m=0;m<b.length;m++){var o=b[m];p.addMenuItem(o.n,R(o.tp),function e(){h.controller.onDrillGraph(h,{displayType:2,drillPathKey:this.ctxt.key,x:j.x,y:j.y,graphHeight:W,graphWidth:c,n:this.ctxt.n,isWithin:this.ctxt.dwi},{});},o);}var n=function(){h.model.xtab.onDemandDrillItems=null;h.model.xtab.onDemandDrillDynamicItems=null;};K.forEach(a,function(q){p.addPopupMenuItem(q.n,"",function(){var r=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"drill",isHostedWithin:false,supportsScroll:true,maxHeight:350});K.forEach(q.items,function(t){r.addMenuItem(t.n,R(t.dt),function(){var u=this.ctxt;h.controller.onDrillGraph(h,{displayType:2,drillPathKey:u.k,x:j.x,y:j.y,graphHeight:W,graphWidth:c,n:this.ctxt.n,isWithin:u.within},{});n();},t);});return r;});});return p;});}d.addMenuItem(mstrmojo.desc(6089,"Sort graph"),this.id,function(){h.controller.onGetAdvSortData(h,1,-1);});var X=d.newInstance();if(this._lastOpened){mstrmojo.css.removeClass(this._lastOpened?this._lastOpened.popupConfig.hostElement:null,"open");mstrmojo._HasPopup.closePopup.call(this);}mstrmojo._HasPopup.openPopup.call(this,X);mstrmojo.css.addClass(X?X.popupConfig.hostElement:null,"open");return false;},showInfoWin:function N(a,b,X){var W=this.model.docModel,Z=[].concat(W.getTargetInfoWin(a)).concat(W.getTargetInfoWin(b));if(Z&&Z.length){for(var Y=0;Y<Z.length;Y++){W.showInfoWin(Z[Y],X,"h");}}},showTooltip:function C(Y,X){this._updateTooltip(Y,X);var W=H(Y,X);if(W&&W.length>1){mstrmojo.DocXtabGraph.multiTooltip.open(this,Y,X,W);}else{this._super(Y,X);}},_updateTooltip:function M(W,X){this.updatingTooltipHelper(P.eventTarget(X,W),E.apply(this,[W]));},hideTooltip:function G(Z,Y){var X=P.eventTarget(Y,Z);if(X.getAttribute("aid")===this.cAreaIdx){this.cAreaIdx=-1;var W=H(Z,Y);if(W&&W.length>1){mstrmojo.DocXtabGraph.multiTooltip.close(this,Z,Y,W);}else{this._super(Z,Y);}}},update:function J(W){this.node.data=W.data;this.as=W.data.as;var l="\u001E",Y=this.model.docModel,f=Y.getCGBMap&&Y.getCGBMap(),X=this.as||[],d,b;for(d=0;d<X.length;d++){var g=X[d],c=g&&g.tgbs;if(c){var e=c.split(l);var h={};for(b=0;b<e.length;b++){var Z=f&&f[e[b]];if(Z){h[Z]=true;}else{h[e[b]]=true;}}g.tks=mstrmojo.hash.keyarray(h).join(l);}}this.eg=W.data.eg;this.gridInfo=W.data.gsi;if(W.defn&&W.defn.tooltip){this.defaultTooltip=W.defn.tooltip;}var Y=this.model;if(Y){Y.set("data",W.data);}},retrieveGraphSrc:function F(X,W){var Z=mstrConfig.taskURL+"?taskId=getRWGraphImage&taskEnv=xhr&__ts__="+(new Date().getTime())+"&messageID="+this.model.docModel.mid+"&nodeKey="+this.k+"&sliceID="+parseInt(this.node.data.sid,10)+"&imgType=4&width="+parseInt(W,10)+"&height="+parseInt(X,10),Y=this.imgNode;if(Y.src!==Z){Y.src=Z;}},resize:function(){B(this);},resizeForDisplayState:function V(Y,X,b){var a=this.getFormats(),Z=this.imgNode;if(b){var W=this.domNode.style;W.top=a.top;W.left=a.left;W.height=a.height;W.width=a.width;}if(Z){Z.style.height=Y+"px";}if(!this.eg){if(Y){this.retrieveGraphSrc(Y,X);this.refreshMap();}}}});function T(W){var X=W&&W.getAttribute&&W.getAttribute("coords");X=(X&&X.split(","))||[];switch(X.length){case 3:return X[2]*2;case 4:return X[2]-X[0];default:return 10;}}function A(Y){var X=[],c=document.body.offsetWidth,W=document.body.offsetHeight,d=0,a=0,f=S[0]&&S[0].domNode?S[0].domNode.offsetLeft:0,e=S[0]&&S[0].domNode?S[0].domNode.offsetTop:0,j=Math.ceil(S.length/2),Z=5,h=function(l,k){if(l+Y+k+Z>c){return c-Y-k-Z;}else{if(S.length>1&&l-k-Z<0){return k+Z;}}return l;},g=function(n,l,k){n+=l;var m=k==1?l:(k*l+(k-1)*Z)/2;if(m>n){return 0;}else{if(m+n>W){return W-m*2;}else{return n-m;}}};for(var b=0;b<S.length;++b){d=Math.max(d,S[b].containerNode.offsetWidth);a=Math.max(a,S[b].containerNode.offsetHeight);}f=h(f,d);e=g(e,a,j);for(var b=0;b<S.length;++b){if(b%2==0){X.push({l:f+Y+Z,t:e});}else{X.push({l:f-S[b].containerNode.offsetWidth-Z,t:e});e+=a+Z;}}return X;}var S=[];mstrmojo.DocXtabGraph.multiTooltip={_posMultiTp:function(X){for(var W=0;W<S.length;++W){S[W].domNode.style.left=X[W].l+"px";S[W].domNode.style.top=X[W].t+"px";}},open:function(g,c,b,X,W){if(!W){W={};}W.e=c;W.win=b;var Z=0;if(X&&X.length){Z=T(X[0]);}for(var Y=0;Y<X.length;++Y){var f=S[Y];if(!f||!mstrmojo.all[f.id]){f=new mstrmojo.Tooltip();var a=0,d=this;f.optimizePos=function(){a++;if(a>=S.length){a=0;d._posMultiTp(A(Z));}};S.push(f);}g.richTooltip.content=X[Y]&&X[Y].getAttribute("ttl");f.open(g,W);}},close:function(){for(var W=S.length-1;W>=0;--W){S[W].close();}S=[];}};}());(function(){mstrmojo.requiresClsP("mstrmojo","Widget","css","dom");var E=mstrmojo.css,F=mstrmojo.dom;mstrmojo.threshold.ColorMarker=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ColorMarker",markupString:'<div class = "marker {@cssClass}" id="{@id}" style="{@cssText}" mstrAttach:contextmenu,mousedown,mouseover,mouseout></div>',markupMethods:{onleftChange:mstrmojo.Widget.leftMarkupMethod},hovered:false,selected:false,index:undefined,select:function(){this.set("selected",true);},unselect:function(){this.set("selected",false);},onselectedChange:function B(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onMarkerSelected(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onMarkerUnselected(this.index);}this.parent.onMarkerUnhovered(this.index);},oncontextmenu:function H(J){F.preventDefault(window,J.e);var I=this,K=I.parent.parent;var L=new mstrmojo.ui.menus.MenuConfig({position:F.getMousePosition(J.e,J.hWin),isHostedWithin:false});L.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){K.bands.remove(I.index);K.update();});this.openPopup(L.newInstance());},onmousedown:function A(){this.set("selected",!this.selected);},onmouseover:function G(){this.set("hovered",true);},onmouseout:function D(){this.set("hovered",false);},onhoveredChange:function C(I){if(!this.selected){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onMarkerHovered(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onMarkerUnhovered(this.index);}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo._HasOwnAvatar","mstrmojo.vi.ui._IsDropTarget","mstrmojo.EditableLabel","mstrmojo.ui.menus.MenuConfig","mstrmojo.css");var b=mstrmojo.css,N=1,L=2,F=4,c=8,K=16;function E(e){return function(){b.toggleClass(this.menuBtnNode,"active",e);};}function H(f){var k=new mstrmojo.ui.menus.MenuConfig(),j=this.getMenuActions(),e=this.index,l=this.id,g=this.total;if((j&K)>0){this.addNewTabMenuItem(k);}if((j&F)>0){k.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"dup",function(){mstrmojo.all[l].tabDuplicated();});}if((j&L)>0){if(e){k.addMenuItem(mstrmojo.desc(5362,"Move Left"),"lft",function(){mstrmojo.all[l].tabMoved(true);});}if(e<g-1){k.addMenuItem(mstrmojo.desc(5363,"Move Right"),"rgt",function(){mstrmojo.all[l].tabMoved(false);});}}k.addSeparator();if((j&N)>0){k.addMenuItem(mstrmojo.desc(1388,"Rename"),"rnm",function(){mstrmojo.all[l].lbl.set("isEditing",true);});}if((j&c)>0){if(g>1){k.addMenuItem(mstrmojo.desc(629,"Delete"),"cls",function(){mstrmojo.all[l].tabDeleted();});}}var h=this.getCustomMenu();if(h&&h.hasMenuItems()){k.addSeparator();k.absorbMenuItems(h);}k.addPopupHandlers(this.id,E(true),E(false));this.showTabMenu(this.updateMenuCfg(k),f);}mstrmojo.vi.ui.tabs.Tab=mstrmojo.declare(mstrmojo.Container,[mstrmojo.ui.menus._HasMenuPopup,mstrmojo._HasOwnAvatar,mstrmojo.vi.ui._IsDropTarget,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.tabs.Tab",markupString:'<div id="{@id}" class="mstrmojo-VITab unselectable {@cssClass}" style="{@cssText}" unselectable="on" mstrAttach:click><div><div class="mstrmojo-VITab-tab"></div><div class="mstrmojo-VITab-menu"></div></div></div>',markupSlots:{containerNode:function W(){return this.domNode.firstChild.firstChild;},menuBtnNode:function a(){return this.domNode.firstChild.lastChild;}},markupMethods:{ontitleChange:function Z(){this.lbl.set("text",this.title);},onisSelectedChange:function V(){mstrmojo.css.toggleClass(this.domNode,"selected",this.isSelected);},onzIndexChange:function D(){this.domNode.style.zIndex=this.zIndex;}},zIndex:1,menuBtnNode:null,lbl:null,title:"",index:-1,total:-1,isSelected:false,children:[{scriptClass:"mstrmojo.EditableLabel",alias:"lbl",editOnClick:false,onTextEditComplete:function Q(f,e){if(f){this.parent.titleEdited(this.text,e);}}}],postBuildRendering:function X(){if(mstrApp.isAppStatePresentation&&mstrApp.isAppStatePresentation()){this.draggable=false;}this._super();},onclick:function d(e){var f=e.getTarget();if(f===this.menuBtnNode){H.call(this,f);}else{if(!this.isSelected){this.tabSelected();}}},getMenuActions:function I(){return 0;},getCustomMenu:function B(){return null;},isDragValid:function A(){return this.parent.children.length>1&&!this.lbl.isEditing;},createAvatar:function S(){var e=document.createElement("div");e.appendChild(this.domNode.cloneNode(true));e.style.margin="-5px 0 0 10px";return e;},allowDrop:function G(e){var f=e.src.widget;return f&&f.parent===this.parent;},ondrop:function Y(e){var f=e.src.data;this.parent.moveTab(f.idx,this.index,f.fromIdx);this._super(e);},ondragenter:function P(f){this._super(f);var g=f.src.data,e=this.index;this.parent.moveTab(g.idx,e);g.idx=e;},ondragover:function T(g){var e=g.tgt.node,f=g.tgtData,h=f&&f.node;if(!f||h!==e){g.tgtData={node:e};if(h){h.style.borderColor="";}}e.style.borderColor="#0fe88f";},getDragData:function C(){var g=this.id,e=this.index;return{setAvatarClass:function f(h){var l=mstrmojo.all[g],j=l.avatar;if(j){var k=[l.avatarCssClass,"hasOwnAvatar",h];j.className=k.join(" ");}},fromIdx:e,idx:e};},getDropAvatarIcon:function R(){return"pivot";},cleanUpAfterTarget:function J(f){var e=f.tgtData&&f.tgtData.node;if(e){e.style.borderColor="";}this._super(f);},onAppStateChange:function U(e){var f=this.lbl,g=e.value===mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION;f.set("isEditing",false);f.set("editOnDoubleClick",!g);this.draggable=!g;},addNewTabMenuItem:function O(e){this.throwAbstractMethodError("addNewTabMenuItem");},tabSelected:mstrmojo.emptyFn,titleEdited:mstrmojo.emptyFn,tabMoved:mstrmojo.emptyFn,tabDeleted:mstrmojo.emptyFn,tabDuplicated:mstrmojo.emptyFn,showTabMenu:mstrmojo.emptyFn,updateMenuCfg:function M(e){return e;}});mstrmojo.vi.ui.tabs.Tab.ACTIONS={NEW_TAB:K,RENAME:N,MOVE:L,DUPLICATE:F,DELETE:c};}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.array","mstrmojo.threshold.ThresholdModel");var G=mstrmojo.array;var I=[{n:mstrmojo.desc(5999,"Replace Text"),v:3},{n:mstrmojo.desc(6000,"Quick Symbol"),v:10},{n:mstrmojo.desc(11898,"Replace With Image"),v:4}];var F=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL;function B(N,O,M){this.parent.raiseFormatValueChange(N,O,M);}function E(O){var N=this.parent.model,M=N.threshold;this.replaceType.set("enabled",O);this.replaceText.set("enabled",O);this.replaceSymbol.set("enabled",O);if(!O){delete M[N.getReplaceTypeName()];delete M[N.getReplaceTextName()];}}mstrmojo.threshold.TextGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.threshold.TextGroup",nameRow:undefined,replaceRow:undefined,replaceType:undefined,replaceText:undefined,replaceSymbol:undefined,preBuildRendering:function K(){this._sync=true;if(this._super){this._super();}},postBuildRendering:function A(){if(this._super){this._super();}this._sync=false;},children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"replaceRow",col1Width:"10%",col2Width:"90%",replaceChk:undefined,children:[{scriptClass:"mstrmojo.ui.Checkbox",slot:"col1Node",alias:"replaceChk",oncheckedChange:function D(){E.call(this.parent.parent,this.checked);}},{scriptClass:"mstrmojo.Label",slot:"col2Node",text:mstrmojo.desc(11888,"Enable Data Replace")}]},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceType",selectedIndex:0,enabled:false,items:I,onenabledChange:function H(){if(this.enabled){B.call(this,"rtp",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(O){var S=O.value,P=O.valueWas,N=this.parent,M=N.replaceText,R=N.replaceSymbol;if(S!==P){var Q=S===1;M.set("visible",!Q);M.set("hint",S===2?mstrmojo.desc(11889,"Image URL"):"");R.set("visible",Q);B.call(this,"rtp",this.items[S].v);}}},{scriptClass:"mstrmojo.TextBox",alias:"replaceText",enabled:false,onenabledChange:function H(){if(this.enabled){B.call(this,"rtxt",this.value);}},onvalueChange:function J(){B.call(this,"rtxt",this.value);var M=this.parent,N=M.replaceType;if(!M.parent.model.threshold.rtp){B.call(this,"rtp",N.items[N.selectedIndex]);}}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"replaceSymbol",selectedIndex:0,isHostedWithin:false,enabled:false,visible:false,items:F,getPopupListConfig:function C(){var M=mstrmojo.ui.Pulldown.prototype.getPopupListConfig();M.getItemMarkup=function N(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}">{@n}</{@tag}>';};return M;},onenabledChange:function H(){if(this.enabled){B.call(this,"rtxt",this.items[this.selectedIndex].v);}},postselectedIndexChange:function(M){var O=M.value,N=M.valueWas;if(O!==N){B.call(this,"rtxt",this.items[O].v);}}}],setFormatSource:function L(M){var N=this,O=N.parent.model;this.syncControls(function(){var P=M[O.getReplaceTextName()],S=M[O.getReplaceTypeName()];N.replaceRow.replaceChk.set("checked",!!P);var Q=G.find(I,"v",S);N.replaceType.set("selectedIndex",Q===-1?0:Q);if(S!==10){N.replaceText.set("value",P||"");N.replaceSymbol.set("selectedIndex",0);}else{var R=Math.max(G.find(F,"v",P),0);N.replaceSymbol.set("selectedIndex",R);N.replaceText.set("value","");}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.hash","mstrmojo._HasEditableText","mstrmojo.ui.Pulldown");var H=mstrmojo.array,C=mstrmojo.hash,B=19,J=13,D=27;mstrmojo.ui.SearchablePulldown=mstrmojo.declare(mstrmojo.ui.Pulldown,[mstrmojo._HasEditableText],{scriptClass:"mstrmojo.ui.SearchablePulldown",editableSlot:"selectedNode",allowCustomText:false,isSearching:false,editOnClick:false,init:function K(P){this._super(P);var M=this.getPopupList();M.renderOnScroll=this.renderOnScroll||M.renderOnScroll;M.renderBlockSize=this.renderBlockSize||M.renderBlockSize;mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-SearchablePulldown");var O=M.constructor.prototype,N=M.getItemProps?M.getItemProps:O.getItemProps,Q=M.getItemMarkup?M.getItemMarkup:O.getItemMarkup;M.getItemProps=function(V,R){var S=this._spft||"",W=V.n,T=W.toUpperCase().indexOf(S);if(T===-1){S="";}var U=N.call(this,V,R);U.before=W.slice(0,T);U.input=W.substring(T,T+S.length);U.after=W.slice(T+S.length,W.length);return U;};M.getItemMarkup=function(S,R){return Q.call(this,S,R).replace("{@en@n}","{@en@before}<span class='sp-highlight'>{@en@input}</span>{@en@after}");};},onclick:function L(M){var P=this.selectedNode,Q=M.getTarget(),R=M.e.offsetX>=(P.offsetWidth-B),O=this.getPopupWidget(),N=O.visible;if(Q===P&&(!N||(N&&R))){this.set("isEditing",!N);this._super(M);}},onPopupWidgetClosed:function F(){this.set("isEditing",false);var P=this.getPopupList(),Q=P._oldItems,N=this.text;delete P._oldItems;if(Q){var M=H.find(Q,"n",N);if(M===-1&&!this.allowCustomText){var O=P.items[0]||Q[0];M=H.find(Q,"n",O.n);}P.set("items",Q);this.set("selectedIndex",M);}},_set_selectedIndex:function E(O,M){if(this.allowCustomText&&M===-1){this.selectedIndex=-1;this.onitemSelected(null,M);}else{this.isSearching=false;this._super(O,M);if(this.hasRendered){var N=this.selectedNode;this.text=N.innerText?N.innerText:N.textContent;}}return true;},onkeydown:function G(N){this._super(N);var M=window.event||N.e;if(M.keyCode===J){this.getPopupList().close();}},onkeyup:function A(O){this._super(O);var M=window.event||O.e,P=M.keyCode,N=this.getPopupList();if(P===D||P===J){N.close();}else{this.processSearch();}},processSearch:function I(){this.isSearching=true;this.hideTooltip();var M=[],O=this.getPopupList(),P=this.selectedNode.innerHTML,Q=O._oldItems||O.items,N=P.toUpperCase();N=N.replace(/<BR>/,"");if(N.length>0){H.forEach(Q,function(R){if(R.n.toUpperCase().indexOf(N)>-1){M.push(C.clone(R));}},this);}else{M=Q;}O._spft=N;if(this.customizeSearchResult){this.customizeSearchResult(M);}O.set("items",M);O.adjustCornersForPopupOverflow();delete O._spft;O._oldItems=Q;O.set("visible",M.length!==0);}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Box","Button","RadioList","Label","array");mstrmojo.requiresClsP("mstrmojo.ui","Pulldown");var G=mstrmojo.desc,Q=mstrmojo.css,J=mstrmojo.array;function O(){Q.addClass(this.list.domNode,"AdvancedSort-PopupList");this.parent.isActive(true);}mstrmojo.SortRow=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.SortRow",markupString:'<div id="{@id}" class="mstrmojo-SortRow {@cssClass}" style="{@cssText}" mstrAttach:click><div></div><div class="mstrmojo-sort-rule-delete"></div><div style="clear:both;"></div></div>',markupSlots:{containerNode:function N(){return this.domNode.firstChild;},deleteNode:function I(){return this.domNode.children[1];}},sortRule:undefined,sortOrder:undefined,rank:undefined,isActive:function K(T){this.parent.pulldownActive(T);},onclick:function R(T){if(T.getTarget()===this.deleteNode){this.parent.deleteSortRule(this);}},isAscending:function S(){return this.sortOrder.value===0;},getSortKey:function E(){return this.sortRule.value;},setPulldownOptions:function P(U){var T=this.sortRule;T.set("items",T.items.concat(U));},resetPulldownOptions:function D(){this.sortRule.set("selectedIndex",0);this.sortRule.set("items",[{v:"",n:" ",cls:"firstItem"}]);},setSelected:function L(W,U,V){var T=J.find(this.sortRule.items,"v",W);if(T===-1){if(!V){this.sortRule.set("selectedIndex",0);this.sortOrder.set("selectedIndex",0);return ;}else{this.sortRule.set("items",this.sortRule.items.concat([{v:W,n:V}]));T=J.find(this.sortRule.items,"v",W);}}this.sortRule.set("selectedIndex",T);this.sortOrder.set("selectedIndex",(U===0?1:0));},setRank:function B(T){this.rank.set("number",T);},getRank:function F(){return this.rank.number;},children:[{scriptClass:"mstrmojo.Widget",alias:"rank",number:0,markupString:'<div class="order-column"><div class="draggable-icon"></div><div class="order">{@number}</div></div>',markupMethods:{onnumberChange:function C(){this.domNode.children[1].innerText=this.number;this.refresh();}}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"sortRule",cssClass:"mstrmojo-sort-rule-pulldown",selectedIndex:0,value:"",items:[{v:"",n:" ",cls:"firstItem"}],bindings:{enabled:"this.items && this.items.length > 1"},isHostedWithin:false,onPopupWidgetOpened:function M(){O.call(this);},onPopupWidgetClosed:function A(){this.parent.isActive(false);},onitemSelected:function H(T){this.value=T.v;this.parent.parent.itemSelected();}},{scriptClass:"mstrmojo.ui.Pulldown",alias:"sortOrder",cssClass:"mstrmojo-sort-rule-order",value:0,selectedIndex:0,bindings:{enabled:"this.parent.sortRule.items && this.parent.sortRule.items.length > 1"},isHostedWithin:false,onPopupWidgetOpened:function M(){O.call(this);},onPopupWidgetClosed:function A(){this.parent.isActive(false);},onitemSelected:function H(T){this.value=T.v;},items:[{n:G(1885,"Ascending"),v:0},{n:G(1886,"Descending"),v:1}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ui.Pulldown");var B={DATA_SOURCES:0,CATALOGS:1,CUBES:2};function D(F,G){return mstrmojo.array.map(F,function(H){H.lv=G;return H;});}mstrmojo.mstr.MDXCubeBrowser=mstrmojo.declare(mstrmojo.Editor,null,{title:mstrmojo.desc(4380,"Select MDX Cube"),help:"Select_MDX_Cube_dialog_box.htm",items:null,selectedItem:null,loadMDXData:function(G){G=G||{};var F=G.item||{};mstrmojo.xhr.request("GET",mstrConfig.taskURL,{success:function(H){G.success(H);},failure:function(H){mstrmojo.alert(H);}},{taskId:"browseMDX",level:F.lv||B.DATA_SOURCES,unitId:F.did||"",roleId:F.roleId||""});},init:function E(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-MDXCubeBrowser");},children:[{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-MDXCubeBrowser-sources",alias:"mdxPulldown",selectedIndex:0,makeObservable:true,items:[{n:mstrmojo.desc(4381,"Data Sources"),did:"",lv:B.DATA_SOURCES}],getPopupListConfig:function(){var G=this;var F=mstrmojo.ui.Pulldown.prototype.getPopupListConfig();F.postclick=function(){G.handleSelection();};return F;},handleSelection:function(){var H=this,F=H.parent;H.set("items",this.items.slice(0,this.selectedIndex+1));H.set("selectedIndex",this.items.length-1);var G=this.selectedItem||this.items[this.selectedIndex];F.set("items",G.items);F.set("selectedItem",null);},addItem:function(F){F.cls="lv-"+F.lv;this.set("items",this.items.concat(F));this.set("selectedIndex",this.items.length-1);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up mstrmojo-MDXCubeBrowser-sources-btn",bindings:{enabled:function(){return this.parent.mdxPulldown.selectedIndex>0;}},onenabledChange:function(){mstrmojo.css.toggleClass(this.domNode,"disabled",!this.enabled);},onclick:function(){var F=this.parent.mdxPulldown;F.set("selectedIndex",F.selectedIndex-1);F.handleSelection();}},{scriptClass:"mstrmojo.ui.List",cssClass:"mstrmojo-MDXCubeBrowser-cubes",alias:"cubeList",bindings:{items:function(){return this.setCssClass(this.parent.items);}},setCssClass:function(F){var G=this;return mstrmojo.array.map(F,function(H){H.cls=G.getItemCssClass(H);return H;});},selectionAdded:function(F){if(!F.isReselect){var J=this,H=J.parent,I=J.items[F.added];if(I.lv===B.CUBES+1){H.set("selectedItem",I);return ;}var G=this.parent.mdxPulldown;H.loadMDXData({item:I,success:function(L){var K=L.items;if(I.lv==B.CATALOGS){mstrmojo.array.map(K,function(M){M.roleId=I.did;return M;});}H.set("items",D(K,I.lv+1));I.items=K;G.addItem(I);}});}},getItemMarkup:function C(G,F){return'<{@tag} class="item" idx="{@idx}" style="{@style}" title="{@title}"><span class="{@cls}"></span>{@en@n}</{@tag}>';},getItemCssClass:function(F){return"mstrIcon-lv mstrIcon-lv-"+{"1048583":"fDataSource","1048584":"fCatalog","1048585":"qc"}[F.dt];}},{scriptClass:"mstrmojo.Label",bindings:{text:function(){return mstrmojo.desc(2107,"## items found").replace("##",(this.parent.items&&this.parent.items.length)||0);}}},{scriptClass:"mstrmojo.HBox",alias:"btnHBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[mstrmojo.Button.newWebButton(mstrmojo.desc(547,"Select"),function A(){var F=this.parent.parent;F.close();F.onOK(F.selectedItem);},true,{bindings:{enabled:function(){return this.parent.parent.selectedItem.lv===3;}}}),mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function A(){this.parent.parent.close();})]}],postBuildRendering:function(){var G=this;this._super();var F=this.mdxPulldown;this.loadMDXData({success:function(H){G.set("items",D(H.items,B.CATALOGS));F.items[0].items=G.items;}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.hash","mstrmojo.util.ui.ColorPicker","mstrmojo.ui.editors.controls.ColorList","mstrmojo.ui.editors.controls.ColorWheel","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.TextBoxWithLabel","mstrmojo.ui.ButtonBar","mstrmojo.Button","mstrmojo.css");var G=1,Q=2,X=mstrmojo.css,L=mstrmojo.array,I=mstrmojo.util.ui.ColorPicker,B=G,V=0,E=1,K=2,H="txtColor",U="automatic";var D=[{n:mstrmojo.desc(12071,"Color fill"),id:V},{n:mstrmojo.desc(12072,"No fill"),id:E},{n:mstrmojo.desc(12073,"Gradient"),id:K}];function F(){return this.color!==U?this.color:this.autoPreviewColor;}function b(e,d,c){return mstrmojo.Button.newWebButton(e,c,d,{slot:"buttonNode",cssDisplay:"inline-block"});}function M(c){return{scriptClass:"mstrmojo.ui.editors.controls.ColorList",items:c,postselectionChange:function(d){var g=d.added;if(g){var f=this.parent,e=this.items[g[0]].id;f.set("color",e);f.colorChanged(e);}}};}function a(c){return"#"+c.replace("#","");}function N(){var c=this.txtColor1,f=this.txtColor2,d=this.color,e=false,g=this.colorStyle;switch(g.items[g.selectedIndex].id){case V:d=a(c.value);break;case E:d="transparent";break;case K:d={or:this.gradientOrientation.getSelectedItems()[0].id,c1:a(c.value),c2:a(f.value)};e=true;break;}X.toggleClass(this.containerNode,"grad",e);this.set("color",d);}function J(c){this.set("activeColor",c);var d=this[c];L.forEach([1,2],function(f){var e=this[H+f];X.toggleClass(e.domNode,"on",e===d);},this);this.colorWheel.set("color",a(d.value));}function O(c,d,e,f){if(typeof e==="string"){if(e==="transparent"){e="#ffffff";}}else{if(e.c1){e=e["c"+c];}}return{scriptClass:"mstrmojo.TextBoxWithLabel",alias:H+c,cssDisplay:"block",label:d,autoCorrect:false,maxLength:6,size:6,value:e.replace("#",""),bindings:f,onfocus:function(){J.call(this.parent,this.alias);},onvalueChange:function(g){if(!/^[0-9a-fA-F]{0,6}$/.test(g.value)){this.value=g.valueWas;}else{if(this.value.length===6){var h=this.parent;h.colorWheel.set("color",a(this.value));N.call(h);}}}};}function S(){var c=F.call(this),g="this.parent.colorStyle.items[ this.parent.colorStyle.selectedIndex ].id",j=g+" === "+K,f=g+" !== "+E,d=(this.showNoFill&&c==="transparent")?1:0,e=D.slice(0,this.showGradient?3:2),h=0;if(!this.showNoFill){e.splice(1,1);}if(c.c1){d=L.find(e,"id",K);h=c.or?0:1;}this.addChildren([{scriptClass:"mstrmojo.ui.Pulldown",alias:"colorStyle",selectedIndex:d,items:e,onitemSelected:function(){N.call(this.parent);}},{scriptClass:"mstrmojo.ui.ButtonBar",alias:"gradientOrientation",items:[{n:mstrmojo.desc(2066,"Horizontal"),id:1,css:"h"},{n:mstrmojo.desc(2069,"Vertical"),id:0,css:"v"}],selectedIndex:h,bindings:{visible:j},postselectionChange:function(k){if(k.added){N.call(this.parent);}}},{scriptClass:"mstrmojo.Button",cssClass:"simpleButton",text:mstrmojo.desc(11658,"Swap"),bindings:{visible:j},onclick:function(){var m=this.parent,l=m.txtColor1,n=m.txtColor2,k=l.value;l.set("value",n.value);n.set("value",k);N.call(m);}},O(1,mstrmojo.desc(12074,"Color HEX:"),c,{visible:f,label:g+" === "+K+' ? "'+mstrmojo.desc(12075,"Color 1 HEX:")+'" : "'+mstrmojo.desc(12074,"Color HEX:")+'";'}),O(2,mstrmojo.desc(12076,"Color 2 HEX:"),c,{visible:j}),{scriptClass:"mstrmojo.ui.editors.controls.ColorWheel",alias:"colorWheel",color:c.c1||c,onColorPicked:function(k){var l=this.parent;l[l.activeColor].set("value",k.replace("#",""));},bindings:{visible:f}},b(mstrmojo.desc(1442,"Ok"),true,function(){var l=this.parent,k=l.color;if(!k.c1){I.addCustomColor(k);}l.colorChanged(k);}),b(mstrmojo.desc(2140,"Cancel"),false,function(){this.parent.colorCanceled();})]);J.call(this,H+"1");}function T(){var d=F.call(this),c=this.sampleNode.style;if(d){if(d.c1){var e=X.buildGradient(d.or,d.c1,d.c2);c[X.convertCssToCamelCase(e.n)]=e.v;}else{c.background=d;}}}mstrmojo.ui.editors.controls.AdvancedColorPicker=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPicker",markupString:'<div id="{@id}" class="mstrmojo-ui-AdvColorPicker {@cssClass}" style="{@cssText}" mstrAttach:click><div class="acpToolbar"><div class="acpBtn acpSwatchBtn"></div><div class="acpBtn acpPaletteBtn"></div><div class="acpColor"></div></div><div class="acpContent" ></div><div class="acpButtons" ></div></div>',markupSlots:{swatchBtnNode:function(){return this.domNode.firstChild.firstChild;},paletteBtnNode:function(){return this.domNode.firstChild.childNodes[1];},sampleNode:function(){return this.domNode.firstChild.lastChild;},containerNode:function(){return this.domNode.firstChild.nextSibling;},buttonNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onpickerModeChange:function P(){B=this.pickerMode;this.renderContent();},oncolorChange:function A(){T.call(this);},onautoPreviewColorChange:function C(){T.call(this);}},color:"#000fff",showGradient:true,showNoFill:true,showAutomatic:false,autoPreviewColor:null,activeColor:H+"1",swatchBtnNode:null,paletteBtnNode:null,colorStyle:null,gradientOrientation:null,txtColor1:null,txtColor2:null,colorWheel:null,pickerMode:G,init:function R(c){this._super(c);this.pickerMode=B;},renderContent:function W(){this.showPickerForCurrentMode();},showPickerForCurrentMode:function Y(){var e=this;this.removeChildren();var f=B===G;if(f){var d=I.getBasicColors();if(!this.showNoFill){d.shift();}if(this.showAutomatic&&this.color!==U){this.addChildren([{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4531,"Automatic"),cssClass:"AutomaticOption",onclick:function c(){e.set("color",U);e.colorChanged(U);}}]);}this.addChildren([mstrmojo.hash.copy({alias:"basicColors"},M(d)),M((mstrApp&&mstrApp.getPreferredColors)?L.map(mstrApp.getPreferredColors(),function(g){return{n:g,id:g};}):[]),M(I.getCustomColors())]);}else{S.call(this);}X.toggleClass(this.swatchBtnNode,"on",f);X.toggleClass(this.paletteBtnNode,"on",!f);this.buttonNode.style.display=f?"none":"block";},colorChanged:mstrmojo.emptyFn,colorCanceled:mstrmojo.emptyFn,onclick:function Z(c){var d=c.getTarget(),e=this.pickerMode;if(d===this.swatchBtnNode){e=G;this.set("pickerMode",e);}else{if(d===this.paletteBtnNode){e=Q;this.set("pickerMode",e);}}}});mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC=U;}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Button","mstrmojo.ui.Pulldown","mstrmojo.ui.CheckList");var F=mstrmojo.hash,E=mstrmojo.Button.newWebButton;function C(G){var H=this.parent,I=this.list;if(G){H.set("selectedIndices",F.copy(I.selectedIndices));H.submitSelections();}else{I.selectedIndices=F.copy(H.selectedIndices);}this.close();}mstrmojo.ui.PulldownCheckList=mstrmojo.declare(mstrmojo.ui.PopupWidget,null,{scriptClass:"mstrmojo.ui.PulldownCheckList",visible:false,onOpen:function B(){var G=this.list;G.updateScrollbars();},onClose:function A(){this.list.refresh();},children:[{scriptClass:"mstrmojo.ui.CheckList",alias:"list",postselectionChange:function D(G){var H=this.items,L=G.added||[],M=G.removed||[],K=this.selectedIndices,J=this.parent.parent.allIdx,I=false;if(J===L[0]){H.forEach(function(O,N){if(!K[N]){I=K[N]=true;}});}else{if(J===M[0]){K={};I=true;}else{if(K[J]){delete K[J];I=true;}}}if(I){this.set("selectedIndices",F.copy(K));this.refresh();}}},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Buttons",children:[E(mstrmojo.desc(1442,"Ok"),function(){C.call(this.parent.parent,true);},true,{cssDisplay:"inline-block"}),E(mstrmojo.desc(2140,"Cancel"),function(){C.call(this.parent.parent,false);},false,{cssDisplay:"inline-block"})]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ListPreviewButton","mstrmojo.css");var C,D=mstrmojo.css;var J=mstrmojo.declare(mstrmojo.ui.PopupList,null,{getItemMarkup:function G(K){if(!C){C=this._super(K).replace(">{@en@n}<","><div>{@en@n}</div><");}return C;},getItemProps:function F(M,K){var L=this._super(M,K);L.addCls("bst"+K);if(K){L.title=M.n;L.n="";}else{L.tt="";}return L;}});mstrmojo.ui.editors.controls.LineStyleButton=mstrmojo.declare(mstrmojo.ui.editors.controls.ListPreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",itemValueField:"id",showThickOption:true,markupMethods:{onenabledChange:function E(){D.toggleClass(this.domNode,"disabled",!this.enabled);}},init:function H(L){this._super(L);var K=["mstrmojo-ui-LineStyle"];if(!this.showThickOption){K.push("no-thick");}D.addWidgetCssClass(this,K);},getListCfg:function I(){return new J({selectionPolicy:"reselect",items:[{n:mstrmojo.desc(2258,"None"),id:"none"},{n:mstrmojo.desc(2259,"Dashed"),id:"1pt dashed"},{n:mstrmojo.desc(2260,"Dotted"),id:"1pt dotted"},{n:mstrmojo.desc(2262,"Thin"),id:"1pt solid"},{n:mstrmojo.desc(2264,"Thick"),id:"2pt solid"}]});},postBuildRendering:function A(){this.borderStyleNode=this.previewNode.appendChild(document.createElement("div"));return this._super();},updatePreview:function B(){var N=this.borderStyleNode,L=this.selectedValue.split(" "),K=this.selectedValue==="conflict";D.toggleClass(this.previewNode,"conflict",K);if(N&&!K){var M=N.style;if(L.length===1){M.borderTopStyle=L[0];}else{M.borderTopWidth=L[0];M.borderTopStyle=L[1];}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.registry","mstrmojo.boxmodel","mstrmojo.Popup","mstrmojo.MenuItem","mstrmojo.Box");mstrmojo.requiresClsP("mstrmojo.express.ui","SubmenuEditor","SubtotalMenuEditor");mstrmojo.requiresDescs(1018);var F="mstrXtabCellMenu",Q="mstrmojo.all['"+F+"'].selectedData",G="mstrmojo.all['"+F+"'].xtab",H="mstrmojo-InteractiveButton",J="mstrmojo.Box",B="mstrmojo-Menu-Box",I="mstrmojo.MenuItem";function M(V,S){var U=mstrmojo.all[F],T=U.xtab,R=[U.selectedData].concat(S||[]);U.close();T[V].apply(T,R);}function L(){M("link",[this.index]);}function A(T,V,U,R){var S={scriptClass:I,text:T,iconClass:"mstrmojo-oivmSprite "+V,cssClass:H,onclick:U};if(R){S.bindings=R;}return S;}function C(S,U,T){var R=A(S,"tbPivot"+U,function(){M("pivot",[T]);});R.bid=T;return R;}function K(S,T,R){return A(S,"tbSort"+T,function(){M("sort",[(R==="true")]);},{selected:"mstrmojo.all['"+F+"Sort'].so === "+R});}function P(U,T,S){if(!U){return null;}var R=T.model.getCellDrillsInfo(S);if(!R||!R.k){return null;}return A(mstrmojo.desc(183,"Drill to")+" "+(R.n||""),"tbDrill",function(){M("drill");});}function O(R,T,S){return A(R,"tbDerivedMetric"+T,function(){M("derivedMetric",[S]);});}mstrmojo.XtabCellMenu=mstrmojo.registry.ref({id:F,slot:"popupNode",scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-Menu",shadowNodeCssClass:mstrmojo.dom.isIE7||mstrmojo.dom.isIE8?"mstrmojo-Menu-shadow":"",contentNodeCssClass:"mstrmojo-Menu-content",autoCloses:false,locksHover:true,disposable:false,derivedMetricOptions:null,updatePopupConfig:function E(X){X=X||{};var d=this.xtab=X.xtab,g;this.selectedNode=X.td;var U=this.selectedData=X.data||(d&&X.td&&d.getCellForNode(X.td));this.onClose=X.onClose;var a=this.sortOptions,R=((U&&U.at)||0)&8,V=U&&(U.mix!==undefined&&U._e&&U._e.otp===4);a.set("visible",R||V);a.children[0].set("visible",R);a.children[1].set("visible",R);a.children[2].set("visible",R||V);a.set("so",U&&U.so);a.children[2].set("onclick",function(){M("advSort",[U.axis]);});a=this.pivotOptions;var f=((U&&U.at)||0)&16;if(f){var T;for(T=0;T<a.children.length;T++){var Y=a.children[T];Y.set("visible",d.model.isPvtButtonVisible(U,Y.bid));}}a.set("visible",f);a=this.linkOptions;g=d.model.getCellLinksInfo(U);a.set("visible",(((U&&U.at)||0)&4)&&(g&&g.links&&g.links.length>0));a=this.drillOptions;var b=((U&&U.at)||0)&1,e=P(b,d,U);a.set("visible",b&&e);a.set("children",[e]);a=this.derivedMetricOptions;var W=mstrApp.isVI&&U&&U.hasOwnProperty("mix");if(W){a.children[0].set("visible",W);a.children[1].set("visible",U.um);}a.set("visible",W);a=this.subtotalsOptions;var Z=d.model.getCellTitleInfo(U),S=U&&!U.hasOwnProperty("mix")&&Z.isSrcTitle&&U.otp!==-1;a.set("visible",S);if(S){a.set("children",[this.getSubtotalMenuCfg(mstrmojo.desc(6193,"Show Totals"))]);a.showSubtotalsBtn.set("xtab",d);a.showSubtotalsBtn.set("cell",this.selectedData);}this.cfg=X;},getSubtotalMenuCfg:function N(R){return{scriptClass:"mstrmojo.express.ui.SubmenuEditor",text:R,cssClass:H,alias:"showSubtotalsBtn",contentScriptClass:"mstrmojo.express.ui.SubtotalMenuEditor",parentID:F};},nudge:function D(){var X=this.cfg,W=X.opener,e=W&&W.domNode&&mstrmojo.dom.position(W.domNode),f=e.y||0,Z=X.cmPos,b,Y,d;if(Z){b=Z.x;Y=Z.y-f;}else{var S=X.el||(X.btn&&X.btn.domNode);d=mstrmojo.boxmodel.offset(S,W&&W[this.slot]);b=d.left;Y=d.top+((S&&S.offsetHeight)||0);}var V=mstrmojo.dom.windowDim(),T=this.domNode;var U=T.offsetHeight,a=V.h-f;d=Math.max(0,Y+U-a);this.set("top",Y-d+"px");var c=T.offsetWidth,R=V.w;d=Math.max(0,b+c-R);this.set("left",b-d+"px");},subtotalsOptions:null,children:[{id:F+"Links",alias:"linkOptions",scriptClass:J,cssClass:B,visible:false,children:[{scriptClass:"mstrmojo.WidgetList",autoHide:true,itemFunction:function(S,R){if(R===0){mstrmojo.requiresCls(I);}return new mstrmojo.MenuItem({text:S.n||S.url||(S.target&&(S.target.n||S.target.did)),cssClass:H,cssText:(R===this.itemsInfo&&this.itemsInfo.di)?"font-weight: bold":"",index:R,onclick:L});},bindings:{itemsInfo:"this.parent.parent.visible ? "+G+".model.getCellLinksInfo("+Q+") : null",items:"this.itemsInfo.links"}}]},{id:F+"Drill",alias:"drillOptions",scriptClass:J,cssClass:B,visible:false},{id:F+"Sort",alias:"sortOptions",scriptClass:J,cssClass:B,children:[K(mstrmojo.desc(7974,"Sort Ascending"),"Asc","true"),K(mstrmojo.desc(7975,"Sort Descending"),"Desc","false"),A(mstrmojo.desc(11099,"Advanced Sort ..."),"tbAdvSort",mstrmojo.emptyFn)]},{id:F+"Pivot",alias:"pivotOptions",scriptClass:J,cssClass:B,children:[C(mstrmojo.desc(11110,"Move to Beginning"),"Beginning","b"),C(mstrmojo.desc(5362,"Move Left"),"Left","l"),C(mstrmojo.desc(5363,"Move Right"),"Right","r"),C(mstrmojo.desc(7978,"Move Up"),"Up","u"),C(mstrmojo.desc(7979,"Move Down"),"Down","d"),C(mstrmojo.desc(7976,"Move to Columns"),"Cols","2"),C(mstrmojo.desc(7977,"Move to Rows"),"Rows","1")]},{id:F+"DerivedMetric",alias:"derivedMetricOptions",scriptClass:J,cssClass:B,children:[O(mstrmojo.desc(11649,"Add Derived Metric"),"Add","add"),O(mstrmojo.desc(11648,"Edit Derived Metric"),"Edit","edit")]},{id:F+"Subtotals",alias:"subtotalsOptions",scriptClass:J,cssClass:B,visible:true}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ME.MetricDataService","mstrmojo.ME.DerivedMetricOptions");mstrmojo.requiresDescs(2140);var B=mstrmojo.array;mstrmojo.ME._DerivedMetricEditorHelper=mstrmojo.provide("mstrmojo.ME._DerivedMetricEditorHelper",{isDME:true,noCache:false,closeLabel:mstrmojo.desc(2140,"Cancel"),saveAsEnabled:false,tbBrowsable:false,init:function C(D){this._super(D);},onApplyMetricCallback:mstrmojo.emptyFn,optionPopupRef:{scriptClass:"mstrmojo.ME.DerivedMetricOptions",title:mstrmojo.desc(13035,"Metric Options"),help:"Metric_Options_dialog_box.htm",width:300},replaceAttributeWithForms:function A(E){var D=[];B.forEach(E,function(F){if(F.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Attribute&&F.fs){B.forEach(F.fs,function(G){if(G.obf||F.da){D.push({n:F.n+"@"+G.fnm,did:F.did+"@"+G.fid,fmdid:G.fid,fnm:G.fnm,t:G.t,frm:G,oi:F,path:F.path});}});}else{D.push(F);}});return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.range","mstrmojo.Widget","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo._HasSuggestion","mstrmojo.ME.MetricToken","mstrmojo.ME.MetricDataService","mstrmojo.ui.ScrollableSuggestionList","mstrmojo.mstr.EnumDSSXMLObjectTypes");var M=mstrmojo.dom,O=mstrmojo.css,z=mstrmojo.Enum_Keys,D=mstrmojo.range,c=D.EDGE,q=mstrmojo.ME.MetricToken.isDelimiter,L=mstrmojo.expr,h=mstrmojo.array,H=mstrmojo.hash;function AG(E){return E.ctrlKey||M.isMetaKey(window,E);}mstrmojo.ME.SpanListMapper=mstrmojo.provide("mstrmojo.SpanListMapper",mstrmojo.mixin({itemWrapperPrefix:function(E){return'<span class="'+this.getWrapperCss(E)+'">';},itemWrapperPrefill:"&nbsp;",itemWrapperSuffix:"</span>",createWrapperNode:function N(E){var AH=E.ownerDocument,AI=AH.createElement("span");return AI;},_iw2idx:function P(AH,AK,AJ){var AI=this.wrapperNodes(AK),E=mstrmojo.array.indexOf(AI,AJ);return E===-1?AI.length:E;},itemOffsetLeft:function a(AH,AL,E,AJ){if(!AJ){var AI=this.wrapperNodes(AL);AJ=AI&&AI[E];if(!AJ){return 0;}}var AK=AL.firstChild;if(!AK||(AK===AJ)){return 0;}return AJ.offsetLeft-AK.offsetLeft;},whereDrop:function AF(AP,E,AJ,AO,AH){var AL=this._nd2iw(AP,E,AJ),AQ,AN,AK,AM,AI;if(AL){AN=this._iw2idx(AP,E,AL);AQ=AN;AK=this.itemOffsetLeft(AP,E,null,AL);AM=AL.offsetTop;AI=AL.offsetWidth;if(AO.x>AH.left+AK+AI/2){AQ++;AK+=AI;}}else{return AP.dropCuePos;}return{left:AK,top:AM,idx:AQ,idxActual:AN};}},mstrmojo.hash.copy(mstrmojo.WidgetListMapper)));mstrmojo.ME.TokenInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._HasSuggestion],{scriptClass:"mstrmojo.ME.TokenInputBox",containerResizable:false,dropZone:true,suggestionPopupCssClss:"mstrmojo-ME-TokenInputBox-suggest",allowDrop:function C(E){var AH=E.src.data;return !!AH;},ondrop:function(E){E.src.data={v:mstrmojo.ME.MetricToken.brackets(E.src.data.item.n),oi:H.copyProps(["did","n","t"],E.src.data.item),isNew:true};if(this.prepareDropItem){this.prepareDropItem(E);}this.insertTokens([E.src.data]);this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");},ondragenter:function F(E){this.dragdata=E.src.data;this._super(E);this.set("dropCuePos",{left:0,top:0});mstrmojo.css.addClass(this.domNode,"unselectable");},ondragleave:function Q(){this.set("dropCuePos",null);mstrmojo.css.removeClass(this.domNode,"unselectable");},ondropCuePosChange:function S(AH){var AI=AH.value,E=this.dragdata;if(E&&E.setAvatarClass){if(AI){E.setAvatarClass("add");}else{E.setInvalidAvatarClass();}}},makeObservable:true,showDesc:true,showPath:true,showFunctionSyntaxAsPath:true,blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,markupString:'<div id={@id} class="mstrmojo-TokenInputBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-TokenInputBox-edit" contenteditable="true" tabindex="1" spellcheck="false"ondragstart = "return false;" oncontextmenu = "document.oncontextmenu =  mstrmojo.all.{@id}.fnContextMenu;" onkeydown = "return mstrmojo.all.{@id}.handlekeydown(event);" onkeypress = "return mstrmojo.all.{@id}.handlekeypress(event);" onkeyup = "return mstrmojo.all.{@id}.handlekeyup(event);" onmouseup = "return mstrmojo.all.{@id}.handlemouseup(event);" onpaste = "return mstrmojo.all.{@id}.handlepasteDirect(event);" >{@itemsHtml}</div><textarea class = "mstrmojo-TokenInputBox-clipboard" onkeyup = "return mstrmojo.all.{@id}.handlepaste(event);"></textarea><div class="mstrmojo-ListBase2-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},itemsContainerNode:function(){return this.domNode.firstChild;},clipboardNode:function(){return this.domNode.childNodes[1];},scrollboxNode:function(){return this.domNode.firstChild;},dropCueNode:function(){return this.domNode.lastChild;}},suggestionListClass:"mstrmojo.ui.ScrollableSuggestionList",items:null,itemFunction:function G(AI,E,AH){return new mstrmojo.ME.MetricToken({data:AI,parent:AH});},listMapper:mstrmojo.ME.SpanListMapper,_set_items:function R(AH,E){if(this._super){this._super(AH,E);}if(!this.tokensCacheInitilized){this.pretokensModify();this.tokensCacheInitilized=true;}},tokensCache:[],tokensCachePointer:0,isDelimiter:q,postBuildRendering:function X(){if(this._super){this._super();}this._eros=false;if(M.isFF){document.body.spellCheck=false;}},fnContextMenu:function I(E){if(E){E.cancelBubble=true;E.returnValue=false;}return false;},handlekeydown:function V(AM){AM=AM||window.event;var AK=AM.keyCode||AM.charCode,AI=false,AN=D.getRangeInfo();if((AG(AM)||AK===z.LEFT_ARROW||AK===z.RIGHT_ARROW)&&this.doubleByte){this.doubleByte=false;var AL=this.prev_rInfo,AH=AN,AO=AH.startContainer.data.slice(AL.startOffset,AN.startOffset);this.widgetHandleImeInput(AL,AO);return ;}switch(AK){case z.DELETE:if(!this.doubleByte){try{this.widgetHandleDelete(AN);this.startTokenSuggestion();this.raiseChangeEvent({type:"delete"});}catch(AJ){}AI=true;}break;case z.BACKSPACE:if(!this.doubleByte){try{this.widgetHandleBackspace(AN);this.raiseChangeEvent({type:"backspace"});this.startTokenSuggestion();this.editNode.focus();}catch(E){}AI=true;}break;case z.ENTER:if(this.breakOnEnterKeyDown&&this.breakOnEnterKeyDown()){break;}case z.TAB:this._startDebug=true;if(this.suggestionShown){this.handleSuggestionItemSelect(this.getSelected());}else{this.startTokenSuggestion();}AI=true;break;case z.ESCAPE:this.endTokenSuggestion();AI=true;break;case 86:if(AG(AM)){this._saveRangeInfo=D.getRangeInfo();if(!this._saveRangeInfo.collapsed){this.widgetHandleDelete(this._saveRangeInfo);this._saveRangeInfo=D.getRangeInfo();}this.clipboardNode.focus();AI=false;}break;case 89:if(AG(AM)){this.widgetHandleUndoRedo("redo");AI=true;}break;case 90:if(AG(AM)){this.widgetHandleUndoRedo("undo");AI=true;}break;case 229:if(!this.doubleByte){this.doubleByte=true;this.prev_rInfo=AN;this.prev_items=this.items;}break;default:}if(AI){M.stopPropogation(window,AM);M.preventDefault(window,AM);return false;}return true;},getCharacter:function AB(AH){var E=(M.isIE&&!M.isIE9)?AH.keyCode:AH.charCode;return(E>0)?String.fromCharCode(E):null;},handlekeypress:function A(AJ){AJ=AJ||window.event;var AK=this.getCharacter(AJ),AH=false;if(AK&&!((AK==="c"||AK==="a")&&AG(AJ))){try{this.widgetHandleInput(D.getRangeInfo(),AK);this.raiseChangeEvent({type:"input",character:AK});if(!this.isDelimiter(AK)){if(this.useKeyDelay){var AI=this;window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){AI.startTokenSuggestion();},mstrmojo.ME.MetricDataService.suggestDelay);}else{this.startTokenSuggestion();}}else{this.endTokenSuggestion(true);}}catch(E){}AH=true;}if(AH){M.stopPropogation(window,AJ);M.preventDefault(window,AJ);return false;}return true;},handlekeyup:function Y(AI){var E=AI.keyCode||AI.charCode,AH;if(E===z.LEFT_ARROW||E===z.RIGHT_ARROW){AH=this.findObjectToken();if(AH&&AH===this._saveActiveToken){this.startTokenSuggestion(AH);}else{this.endTokenSuggestion();}}else{if(E===z.UP_ARROW){this.preHighlight();}else{if(E===z.DOWN_ARROW){this.nextHighlight();}}}this._saveRangeInfo=D.getRangeInfo();},handlemouseup:function g(AM){if(this.dropCuePos){return false;}var AI=this.findObjectToken();if(AI&&AI===this._saveActiveToken){this.startTokenSuggestion(AI);}else{this.endTokenSuggestion();}var AK=D.getRangeInfo();if(this.doubleByte){this.doubleByte=false;var AL=this.prev_rInfo,AJ=this._saveRangeInfo,AH=AJ.startContainer.data.slice(AL.startOffset,AJ.startOffset+1);if(AH!==""){var E=this.widgetHandleImeInput(AL,AH);this.prev_items=this.items;AI=M.findWidget(AK.startContainer);if(AI){this._delaySetTextCaretPos(AI.domNode,AK.startOffset);}else{this._delaySetTextCaretPos(E.domNode,AK.startOffset-1);}}this.prev_rInfo=AK;}this._saveRangeInfo=AK;},handlepasteDirect:function v(E){this.clipboardNode.value=E.clipboardData.getData("Text");this.handlepaste(E);M.stopPropogation(window,E);M.preventDefault(window,E);return false;},handlepaste:function e(AL){var AH=this.clipboardNode.value;this.clipboardNode.value="";var AK=[],E=AH&&AH.length,AJ,AI="",AM;if(E>0){for(AJ=0;AJ<E;AJ++){AM=AH.charAt(AJ);if(this.isDelimiter(AM)){if(!mstrmojo.string.isEmpty(AI)){AK.push({v:AI,isNew:true});AI="";}AK.push({v:AM,isDelimiter:true,isNew:true});}else{AI=AI+AM;}}if(!mstrmojo.string.isEmpty(AI)){AK.push({v:AI,isNew:true});AI="";}this.insertTokens(AK);}},raiseChangeEvent:function(E){E.name="tokensModify";this.raiseEvent(E);},getTokensAsString:function AE(){var AH=[],AJ=this.items,AI,E;for(AI=0,E=AJ.length;AI<E;AI++){AH[AI]=AJ[AI].v;}return AH.join("| ");},replaceErrorToken:function j(AJ){var AI=this.items||[],AK=mstrmojo.array.find(AI,"sta",-1),AH,AL=function(AR,AP,AS){var AO=(AR&&AR.items)||[],AN=h.find(AO,"did",AP),AM,AQ;if(AN>-1){AM=AO[AN].fs;AQ=h.filterOne(AM,function(AT){return AT.fnm&&AT.fnm.toUpperCase()===AS.toUpperCase();});}return AQ;},E=function(AR,AP,AQ){var AM={v:AP.n,oi:AP,isNew:true},AO=AR.v&&AR.v.split("@"),AN;if(AO&&AO.length>1){AN=AL(AQ,AP.did,AO[1]);if(AN){AM.exv=AN.fmdid||AN.fid;AM.extp=8;AM.v=mstrmojo.ME.MetricToken.brackets(AP.n)+"@"+AN.fnm;}}return AM;};if(AK>-1){AH=E(AI[AK],AJ,this.candidates);this.remove(AK);this.add([AH],AK);}},widgetHandleDelete:function Z(AK){if(AK.collapsed){var AJ,AI,E,AL=AK.startOffset,AH=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AK.startContainer,false,document.body)){D.collapseOnNode(this.editNode,false);return ;}AJ=D.getEdgeInfo(AK.startContainer,AK.startOffset);AI=M.findWidget(AK.startContainer);E=this.itemIndex(AI.data);if(AJ===c.EDGE_END){E++;AI=AH[E];AL=0;}if(!AI){D.collapseOnNode(this.editNode,false);return ;}if(AI.length()===1){this.remove(E);AI=AH[E];if(AI){D.collapseOnNode(AI.domNode,true);}else{D.collapseOnNode(this.editNode,false);}this.checkMergeTwoTokens(E-1,E);}else{AI.spliceContent(AL,1);D.collapseOnTextNode(AI.domNode,AL);}}else{this.widgetDeleteTokens(AK);}},widgetHandleBackspace:function p(AK){if(AK.collapsed){var AJ,AI,E,AL=AK.startOffset,AH=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AK.startContainer,false,document.body)){if(AK.startOffset>0&&M.isFF){AI=AH[this.items.length-1];D.collapseOnNode(AI.domNode,false);AK=D.getRangeInfo();AJ=D.getEdgeInfo(AK.startContainer,AK.startOffset);}else{D.collapseOnNode(this.editNode,true);return ;}}AJ=D.getEdgeInfo(AK.startContainer,AK.startOffset);AI=M.findWidget(AK.startContainer);E=this.itemIndex(AI.data);if(AJ===c.EDGE_BEGIN){E--;AI=AH[E];AL=AI.length();}if(!AI){D.collapseOnNode(this.editNode,true);return ;}if(AI.length()===1){this.remove(E);AI=AH[E-1];if(AI){D.collapseOnNode(AI.domNode,false);this.checkMergeTwoTokens(E-1,E);AI=AH[E-1];}else{D.collapseOnNode(this.editNode,true);}}else{AI.spliceContent(AL-1,1);D.collapseOnTextNode(AI.domNode,AL-1);}}else{this.widgetDeleteTokens(AK);}},widgetHandleInput:function r(AL,AM){if(!AL.collapsed){this.widgetDeleteTokens(AL);AL=D.getRangeInfo();}var AI,AN,AO,AP,E,AH,AJ=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AL.startContainer,false,document.body)){this.add([{v:AM,isDelimiter:this.isDelimiter(AM),isNew:true}],0);AN=AJ[0];D.collapseOnTextNode(AN.domNode,1);return ;}AI=D.getEdgeInfo(AL.startContainer,AL.startOffset);AN=M.findWidget(AL.startContainer);AO=this.itemIndex(AN.data);if(this.isDelimiter(AM)){AP={v:AM,isDelimiter:true,isNew:true};if(AI===c.EDGE_MIDDLE){var AK=AN.split2Tokens(AL.startOffset);this.remove(AO);this.add([AK[0],AP,AK[1]],AO);AO=AO+1;}else{AO=(AI===c.EDGE_BEGIN)?AO:AO+1;this.add([AP],AO);}AN=AJ[AO];D.collapseOnNode(AN.domNode,false);}else{AH=AL.startOffset;if(AN.isDelimiter()){E=AJ[(AI===c.EDGE_BEGIN)?AO-1:AO+1];if(E&&!E.isDelimiter()){AN=E;AH=(AI===c.EDGE_BEGIN)?AN.length():0;}}if(!AN.isDelimiter()){AN.spliceContent(AH,0,AM);D.collapseOnTextNode(AN.domNode,AH+1);}else{this.add([{v:AM,isNew:true}],(AI===c.EDGE_BEGIN)?AO:AO+1);AN=AJ[(AI===c.EDGE_BEGIN)?AO:AO+1];D.collapseOnNode(AN.domNode,false);}}},widgetHandleImeInput:function r(AK,AL){if(!AK.collapsed){this.widgetDeleteTokens(AK);AK=D.getRangeInfo();}var AI,AM,AN,AO,E,AH,AJ=this.ctxtBuilder.itemWidgets;if(!M.contains(this.editNode,AK.startContainer,false,document.body)){this.clearTokens();this.add([{v:AL,isDelimiter:this.isDelimiter(AL),isNew:true}],0);AJ=this.ctxtBuilder.itemWidgets;AM=AJ[0];D.collapseOnTextNode(AM.domNode,1);this._delaySetCaretPos(AM.domNode,false);return ;}AI=D.getEdgeInfo(AK.startContainer,AK.startOffset);AM=M.findWidget(AK.startContainer);AN=this.itemIndex(AM.data);AH=AK.startOffset;if(AM.isDelimiter()){this.clearTokens();this.set("items",this.prev_items);AJ=this.ctxtBuilder.itemWidgets;E=AJ[(AI===c.EDGE_BEGIN)?AN-1:AN+1];if(E&&!E.isDelimiter()){AM=E;AH=(AI===c.EDGE_BEGIN)?AM.length():0;}}if(!AM.isDelimiter()){AM.spliceContent(AH,0,AL);this._delaySetTextCaretPos(AM.domNode,AH+AL.length);}else{this.add([{v:AL,isNew:true}],(AI===c.EDGE_BEGIN)?AN:AN+1);AM=AJ[(AI===c.EDGE_BEGIN)?AN:AN+1];this._delaySetCaretPos(AM.domNode,false);}this.startTokenSuggestion();return AM;},findObjectToken:function B(){var AK=D.getRangeInfo(),AI=M.findWidget(AK.startContainer);if(!M.contains(this.editNode,AK.startContainer,false,document.body)){return null;}if(!AI||AI===this||!AI.isDelimiter){return null;}if(AI&&!AI.isDelimiter()){return AI;}var AJ=D.getEdgeInfo(AK.startContainer,AK.startOffset),AH=this.ctxtBuilder.itemWidgets,E=this.itemIndex(AI.data);AI=AH[(AJ===c.EDGE_BEGIN)?E-1:E+1];if(AI&&!AI.isDelimiter()){return AI;}return null;},checkMergeTwoTokens:function n(AK,AI){var AJ=this.ctxtBuilder.itemWidgets,AH=AJ[AK],E=AJ[AI];if((AH&&!AH.isDelimiter())&&(E&&!E.isDelimiter())){this.remove([AK,AI]);this.add([AH.mergeTo(E)],AK);D.collapseOnTextNode(AJ[AK].domNode,AH.length());}},insertTokens:function u(AN){var E=0,AH=this.editNode;var AM=this._saveRangeInfo||D.getRangeInfo();if(!AM||!M.contains(AH,AM.startContainer,false,document.body)){this.add(AN);E=this.items.length-1;this._delaySetTextCaretPos(AH,(AH.innerText||AH.textContent).length);}else{var AL=D.getEdgeInfo(AM.startContainer,AM.startOffset),AI=M.findWidget(AM.startContainer);E=this.itemIndex(AI.data);if(AL===c.EDGE_MIDDLE){var AK=AI.split2Tokens(AM.startOffset);this.remove(E);AN.unshift(AK[0]);AN.push(AK[1]);this.add(AN,E);}else{E=(AL===c.EDGE_BEGIN?E:E+1);this.add(AN,E);}E=E+AN.length-1;AI=this.ctxtBuilder.itemWidgets[E];this._delaySetCaretPos(AI.domNode,false);}this.raiseChangeEvent({type:"insert"});var AJ=this;window.setTimeout(function(){AJ._saveRangeInfo=D.getRangeInfo();},50);return E;},insertParenthesisTokens:function x(AH){var E=this;window.setTimeout(function(){var AI=E.insertTokens([{v:"(",isDelimiter:true,isNew:true},{v:")",isDelimiter:true,isNew:true}]);E._delaySetTextCaretPos(E.itemsContainerNode.childNodes[AI]);},AH||50);},clearTokens:function m(E){this.set("items",E||[]);this._saveRangeInfo=null;this._delaySetCaretPos(this.editNode,false);},focus:function t(){var AH=this.ctxtBuilder.itemWidgets,E=AH.length;this._delaySetCaretPos(E>0?AH[E-1].domNode:this.editNode,false);},startTokenSuggestion:function AA(E){this.endTokenSuggestion();if(!E){E=this.findObjectToken();}if(E&&!E.isDelimiter()){E.set("active",true);this._saveActiveToken=E;this.showSuggestion(this.getSearchPattern());}if(!E||this.getSearchPattern().length===0){this.hideSuggestion();}},browseItemVisible:true,folderLinksContextId:25,browsableTypes:[L.TP.FOLDER,L.TP.FACT,L.TP.ATTR,L.TP.FUNCTION,L.TP.FILTER,L.STP.PROMPT_OBJECTS,L.TP.ATTR,L.TP.DIM,L.TP.METRIC,L.TP.ROLE].join(","),getSearchPattern:function U(){var AH=this._saveActiveToken,AJ=AH&&AH.data.v,E=AJ&&AJ.length;if(E>2){if(AJ.charAt(0)==="["){AJ=AJ.substring(1);}if(AJ.charAt(AJ.length-1)==="]"){AJ=AJ.substring(0,AJ.length-1);}}if(AH&&AH.data.ift){var AI=AH.data.v,AK=AI&&AI.indexOf("@");if(AK>=0){AJ=AI.substring(AK);}}return AJ||"";},getSuggestionPos:function b(){var E=this._saveActiveToken,AH=null,AJ,AI;if(E){AJ=E.data&&E.data.ift;AI=mstrmojo.dom.position(E.domNode,true);AH={left:Math.round(AI.x+(AJ?AI.w:0))+"px",top:Math.round(AI.y+AI.h)+"px",zIndex:100};}return AH;},item2textCss:function J(AH){var E=(this._super&&this._super(AH))||{4:"m",11:"fx",12:"a",13:"fc",43:"tr",21:"afm","-99":"br"}[AH.t]||"";E+=AH.da?" da":"";E+=(AH.dm||AH.um)?" dm":"";E+=AH.de?" de":"";E+=AH.fs&&AH.fs.length&&AH.fs.some(function(AI){return AI.fgr>0;})?" g":"";return E;},onBrowserOpen:function o(){this.editNode.blur();},onSuggestionItemSelect:function w(AH){var E=this._saveActiveToken;this.endTokenSuggestion();if(E){if(E.data.ift&&AH.t===21){E.setFormInfo(AH);}else{E.setItemInfo(AH);if(AH.t===mstrmojo.mstr.EnumDSSXMLObjectTypes.Function){this.insertParenthesisTokens();}}this._delaySetCaretPos(E.domNode,false);}this.closePopup();},_delaySetCaretPos:function AC(E,AI){var AH=this.editNode,AJ=this,AK=function(){AH.focus();AH.focus();D.collapseOnNode(E,AI);AJ._saveRangeInfo=D.getRangeInfo();};window.setTimeout(AK,0);},_delaySetTextCaretPos:function AC(E,AK){var AH=this.editNode,AI=this,AJ=function(){AH.focus();AH.focus();D.collapseOnTextNode(E,AK);AI._saveRangeInfo=D.getRangeInfo();};window.setTimeout(AJ,0);},getCandidatesThroughTaskCall:function W(AH,E){AH.objectType="11,12,13,43,4";AH.rootFolderType=39;AH.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(AH,E);},filterCandidates:function l(AK,AJ,E){var AH=this._saveActiveToken,AL=AH&&(AH.data.oi||AH.data.at),AI;if(AL&&AH.data.ift){E=E||this.suggestCount;AJ=mstrmojo.string.regEscape(AJ);AI=h.filter(AK,function(AM){return AM.t===21&&AM.attid===AL.did&&(new RegExp("^"+AJ,"i")).test("@"+AM.n);},{max:E});}else{AI=h.filter(AK,function(AM){return AM.t!==21;});AI=this._super(AI,AJ,E);}return AI;},endTokenSuggestion:function AD(AH){var E=this._saveActiveToken;if(E){if(AH){this.hideSuggestion();}E.set("active",false);this._saveActiveToken=null;}},widgetDeleteTokens:function f(AP){var AH=AP.startOffset,E=AP.endOffset,AS=M.findWidget(AP.startContainer),AQ=M.findWidget(AP.endContainer),AL=this.itemIndex(AS.data),AJ=this.itemIndex(AQ.data),AM=[],AN=D.getEdgeInfo(AP.startContainer,AH),AR=D.getEdgeInfo(AP.endContainer,E),AO=(AN===c.EDGE_BEGIN?AL:AL+1),AI=(AR===c.EDGE_END?AJ:AJ-1),AK;if(AS===AQ){if((AN===c.EDGE_BEGIN)&&(AR===c.EDGE_END)){this.remove(AL);AQ=this.ctxtBuilder.itemWidgets[AL===0?AL:AL-1];if(AQ){D.collapseOnNode(AQ.domNode,AL===0);}else{D.collapseOnNode(this.editNode,true);}}else{AS.spliceContent(AH,E-AH);D.collapseOnTextNode(AQ.domNode,AH);}}else{for(AK=AO;AK<=AI;AK++){AM.push(AK);}this.remove(AM);if(AN===c.EDGE_MIDDLE){AS.spliceContent(AH);}if(AR===c.EDGE_MIDDLE){AQ.spliceContent(0,E);}if(AN===c.EDGE_BEGIN){AS=this.ctxtBuilder.itemWidgets[AL===0?AL:AL-1];}if(AS){D.collapseOnNode(AS.domNode,AL===0);}else{D.collapseOnNode(this.editNode,false);}AL=(AN===c.EDGE_BEGIN)?AL-1:AL;this.checkMergeTwoTokens(AL,AL+1);}this.editNode.focus();},oncandidatesChange:function k(){var AH=this.candidates,E=(AH&&AH.items)||[];if(!this.noCache&&AH&&AH.isComplete){this.suggestCount=this.REQUEST_THRESHOLD=E.length;}else{this.suggestCount=mstrmojo.ME.MetricDataService.suggestCount;this.REQUEST_THRESHOLD=20;}},nudge:function(E){var AH=this.getSuggestionPos();if(AH){E.set("left",AH.left);E.set("top",AH.top);}},pretokensModify:function K(){this.tokensCache=this.tokensCache.slice(0,this.tokensCachePointer);var E=this.findObjectToken();this.tokensCache.push({items:H.clone(this.items),rInfo:D.getRangeInfo(),idx:E!==null?this.itemIndex(E.data):-1});this.tokensCachePointer=this.tokensCache.length;},widgetHandleUndoRedo:function d(AI){var AJ,E,AH=function(AL){if(!AL){return ;}AL=AL||{};this.set("items",H.clone(AL.items));var AO=this.ctxtBuilder.itemWidgets,AK=AO[AL.idx],AN=AK&&AK.domNode||this.editNode,AM=AL.rInfo;this._delaySetTextCaretPos(AN,AM&&AM.startOffset||0);};switch(AI){case"undo":AJ=--this.tokensCachePointer;if(AJ>-1){E=this.tokensCache[AJ-1];AH.call(this,E);}else{this.tokensCachePointer=1;}break;case"redo":AJ=this.tokensCachePointer++;if(AJ>-1&&AJ<this.tokensCache.length){E=this.tokensCache[AJ];AH.call(this,E);}else{this.tokensCachePointer=Math.min(Math.max(this.tokensCachePointer,1),this.tokensCache.length);}break;}},resetTokensCache:function T(){this.tokensCache=[];this.tokensCachePointer=-1;this.tokensCacheInitilized=false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ListBase","mstrmojo._IsList","mstrmojo._HasSuggestion","mstrmojo.Enum_Keys","mstrmojo.hash","mstrmojo.dom");var F=mstrmojo.dom,B=mstrmojo.Enum_Keys,I=200,P;var O={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};var Q="mstrmojo-SimpleObjectInputBox-del";function K(){var Y=this.inputBox,Z=Y.value;if(Z!==this._lastPattern&&Z!==""){this.showSuggestion(Z);}this._lastPattern=Z;delete this._timerHandle;}function X(){var Y=this._timerHandle;if(Y){window.clearTimeout(Y);delete this._timerHandle;}}mstrmojo.SimpleObjectInputBox=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo._HasSuggestion,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.SimpleObjectInputBox",markupString:'<div id="{@id}" class="mstrmojo-ListBase mstrmojo-SimpleObjectInputBox {@cssClass}" style="{@cssText}" mstrAttach:click><div class="mstrmojo-SimpleObjectInputBox-container {@icnCss}" style="{@icnCssText}">{@itemsHtml}<input type="text" mstrAttach:keydown,keyup,blur style="display: none;" /></div><div class="mstrmojo-SimpleObjectInputBox-empty"><div>{@emptyText}</div></div></div>',markupSlots:{itemsContainerNode:function(){return this.domNode.firstChild;},emptyTextNode:function(){return this.domNode.childNodes[1];},inputBox:function(){return this.domNode.firstChild.lastChild;},scrollboxNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onmaxItemWidthChange:function T(){var Y=this.maxItemWidth;if(!isNaN(Y)&&Y>0){this.emptyTextNode.style.maxWidth=Y+"px";}}},itemField:"n",emptyText:"",state:0,maxItemWidth:"none",useKeyDelay:false,maxObjectCount:null,useRichTooltip:true,showTooltip:function D(Z,c){var b=Z.target||F.eventTarget(Z.hWin,Z.e),a=this.getItemFromTarget(b);if(a&&a.n){var d=this.getItemNodeFromTarget(b).firstChild,Y=F.position(d);this.richTooltip={posType:mstrmojo.tooltip.POS_TOPCENTER,cssClass:"vi-regular vi-tooltip-A A-center",refNode:d,content:mstrmojo.string.encodeHtmlString(a.n),top:Y.h+11,left:Y.w/2};this._super(Z,c);}},getItemMarkup:function(Y){if(!P){var Z=this.itemField;P=this._super(Y).replace(">{@en@n}<",'"><div class="elem">{@'+Z+'}<div class="'+Q+'"></div></div><');}return P;},getItemProps:function U(b,Y){var Z=this._super(b,Y),c=this.itemField;Z[c]=b[c];var a=this.maxItemWidth;if(!isNaN(a)&&a>0){a=(a-24)+"px";}Z.addStyle("max-width:"+a);return Z;},getSuggestionPos:function N(){var Y=this._inputPos;return{target:this.inputBox,left:Y.x+"px",top:Y.y+Y.h+"px",zIndex:100};},getSearchPattern:function W(){return this.inputBox.value;},onSuggestionItemSelect:function G(Y){X.call(this);this.set("items",this.items.concat(Y));this._super();var Z=this.id;window.setTimeout(function(){var a=mstrmojo.all[Z];if(parseInt(a.state,10)!==O.FULL){a.set("state",O.ADDING);}},0);},onstateChange:function A(Z){var a=Z.value;this.emptyTextNode.style.display=(a===O.EMPTY)?"block":"none";this.itemsContainerNode.style.display=(a===O.EMPTY)?"none":"block";var Y=this.inputBox,b=Y.style;if(a===O.ADDING){b.display="";this.updateScrollbars();Y.focus();this._inputPos=F.position(Y,true);}else{X.call(this);b.display="none";Y.value="";this._lastPattern="";this.updateScrollbars();}},postBuildRendering:function R(){I=mstrApp.getSearchAutoCompleteDelay&&mstrApp.getSearchAutoCompleteDelay()||I;this.state=0;this.setDefaultState();return this._super();},preitemsChange:function M(){this.setDefaultState();},onclick:function V(Z){var c=F.eventTarget(Z.hWin,Z.e);if(c&&c.className===Q){var b=F.findAncestorByAttr(c,"idx",true,this.domNode),Y=b&&parseInt(b.value,10);this.hideTooltip();if(Y!==null&&!isNaN(Y)){var a=this.items.concat();a.splice(Y,1);this.set("items",a);}return ;}if(parseInt(this.state,10)!==O.FULL){this.set("state",O.ADDING);}},onblur:function E(){X.call(this);if(!this.suggestionShown){this.setDefaultState();}},prekeydown:function C(Y){var b=Y.e;switch(parseInt(b.keyCode||b.charCode,10)){case B.DOWN_ARROW:this.nextHighlight();break;case B.UP_ARROW:this.preHighlight();break;case B.TAB:case B.ENTER:F.preventDefault(Y.hWin,b);var a=this.getSelected();if(a){this.handleSuggestionItemSelect(a);}else{this.hideSuggestion();this.setDefaultState();}break;case B.ESCAPE:X.call(this);this.hideSuggestion();this.setDefaultState();break;case B.BACKSPACE:if(!this.getSearchPattern()){F.preventDefault(Y.hWin,b);var Z=this.items&&this.items.concat();if(Z&&Z.length){Z.splice(Z.length-1,1);mstrApp.ignoreBackSpace=true;this.set("items",Z);var c=this.id;window.setTimeout(function(){mstrmojo.all[c].set("state",O.ADDING);mstrApp.ignoreBackSpace=false;},0);}}break;}},prekeyup:function H(Y){if(!this.getSearchPattern()){F.preventDefault(Y.hWin,Y.e);this.hideSuggestion();}if(this.useKeyDelay){var Z=this.id;if(!this._timerHandle){this._timerHandle=window.setTimeout(function(){K.call(mstrmojo.all[Z]);},I);}}else{K.call(this);}},widgetResized:function L(){if(this.hasRendered){var Z=parseInt(this.width,10),a=this.items.length,b=this.itemsContainerNode.childNodes;if(a<=b&&b.length){for(var Y=0;Y<a;Y++){b[Y].style.maxWidth=Z-24+"px";}}if(this.emptyTextNode){this.emptyTextNode.style.maxWidth=Z+"px";}this.updateScrollbars();}},setupScrollNodes:function J(){this.scrollNode=this.scrollboxNode;},setDefaultState:function S(){var a=this.maxObjectCount,Y=(this.items&&this.items.length)||0,Z=(a!==null&&a!==undefined&&Y>=a);this.set("state",!Y?O.EMPTY:(Z?O.FULL:O.DEFAULT));}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo._HasSuggestion");var F=-1,E=0,D=1;mstrmojo._ValidateSuggestions=mstrmojo.provide("mstrmojo._ValidateSuggestions",mstrmojo.hash.copy(mstrmojo._HasSuggestion,{_mixinName:"mstrmojo._ValidateSuggestions",itemValidationField:"did",verifyObject:function C(J,H){var M=this.candidates,L;if(M){var I=M.items,G=mstrmojo.array.find(I,this.itemValidationField,H.data[this.itemValidationField]);G=G>-1?G:mstrmojo.array.find(I,this.itemField,J);if(G>-1){H.updateData(I[G]);L=E;}else{if(M.isComplete){L=D;}}}if(L!==undefined){return L;}var K=this._vqueue=this._vqueue||[];K.push({pattern:J,id:H.data[this.itemIdField]});if(!this._vInProgress){this.verifyNextCandidate();}return F;},verifyNextCandidate:function B(){var G=this._vqueue;if(!G||G.length===0){this._vInProgress=false;return ;}this.verifyCandidate(G.shift());},verifyCandidate:function A(H){var G=this;this._vInProgress=true;this.getCandidatesThroughTaskCall({pattern:H.pattern,blockBegin:1,blockCount:G.noCache?-1:this.suggestCount,isVerify:true},{success:function(N){var K=G.ctxtBuilder.itemWidgets,J=K&&K.length,O,M;for(M=0;M<J;M++){if(K[M].data[G.itemIdField]===H.id){O=K[M];break;}}if(!O){return ;}var L=N.items;if(L&&L.length===1){O.updateData(L[0]);}else{if(L&&L.length>1){var I=mstrmojo.array.find(L,"did",O.data.did);if(I>-1){O.updateData(L[I]);}else{O.set("state",D);}}else{O.set("state",D);}}},failure:function(I){mstrmojo.alert(I.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){G.verifyNextCandidate();}});}}));mstrmojo._ValidateSuggestions.ENUM_STATES={UNDETERMINED:F,VALID:E,INVALID:D};}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.WidgetTree","mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowserSelector");mstrmojo.TreeBrowserEnum={};var I=mstrmojo.TreeBrowserEnum;I.BRANCH_POLICY_TOGGLE="toggle";I.BRANCH_POLICY_SELECT="select";mstrmojo.TreeBrowser=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.TreeBrowser",cssClass:"mstrmojo-TreeBrowser",browserNodeClass:mstrmojo.TreeBrowserNode,blockCount:30,noCheckBox:false,selectionAcrossBranch:true,branchClickPolicy:I.BRANCH_POLICY_TOGGLE,contentRetrieved:false,listSelector:mstrmojo.TreeBrowserSelector,handleNodeClicked:function(J){},getContentThroughTaskCall:function H(K,J){},isBranch:function F(J){},item2textCss:function C(J){return{"-1":"failed","-2":"loading","-3":"next","-4":"prev"}[J.st]||"";},failItemCreaterFunc:function(){return{n:"Loading Failed!",did:"-1",tp:"-1",st:"-1"};},loadingItemCreaterFunc:function(){return{n:mstrmojo.desc(5674,"Loading..."),did:"-2",tp:"-2",st:"-2"};},nextItemCreaterFunc:function(J){return{n:mstrmojo.desc(4507,"Next ##  item(s)...").replace("##",J?Math.min(J,this.blockCount):this.blockCount),did:"-3",tp:"-3",st:"-3"};},prevItemCreaterFunc:function(){return{n:mstrmojo.desc(4508,"Previous ##  item(s)...").replace("##",this.blockCount),did:"-4",tp:"-4",st:"-4"};},updateTreeContent:function(K,M){K.contentRetrieved=true;var L=M[K.itemChildrenField]||[],J=K.tree||K,O=M.bc,N=M.sz,P=M.bb;if(O!==-1){if(P+O<N){L.push(J.nextItemCreaterFunc(N-P-O+1));}if((P-O)>-1){L.unshift(J.prevItemCreaterFunc());}}K.blockBegin=P;J.initializing=true;K.clearSelect(false);K.set("items",L);K.setSelectedItems(J.getTotalSelections(),true);J.initializing=false;if(J.onNodeExpand){J.onNodeExpand(K);}},getContent:function(K,O){var L=(K===this),J=this,P=function(Q){if(L){mstrmojo.css.removeClass(J.domNode,["loading"]);}J.updateTreeContent(K,Q);},M=function(Q){K.contentRetrieved=true;K.set("items",[J.failItemCreaterFunc()]);},N={success:P,failure:M};if(L){mstrmojo.css.addClass(J.domNode,["loading"]);}this.getContentThroughTaskCall({isRoot:L,data:K.data,blockBegin:L?0:(O||K.blockBegin),blockCount:J.blockCount},N);},postBuildRendering:function A(){this._super();if(!this.contentRetrieved){var J=this;setTimeout(function(){J.getContent(J);},0);}},itemFunction:function G(N,K,L){var J=L.tree||L,M=new J.browserNodeClass({data:N,state:0,parent:L,tree:J,multiSelect:L.multiSelect,text:N[L.itemDisplayField],textCssClass:J.item2textCss(N),items:N[L.itemChildrenField],itemIdField:L.itemIdField,itemDisplayField:L.itemDisplayField,itemIconField:L.itemIconField,itemChildrenField:L.itemChildrenField,itemFunction:L.itemFunction,listSelector:L.listSelector});return M;},clearTreeSelect:function E(){if(!this.selectionAcrossBranch){this._super();}else{var L=this._selectionParentNode,J=L&&L.length,K;for(K=0;K<J;K++){L[K].clearSelect();}this._selectionParentNode=null;this._totalSelections=null;}},onnodechange:function D(T){if(this.initializing){return ;}if(!this.selectionAcrossBranch){this._super(T);}else{this._totalSelections=this._totalSelections||[];this._selectionParentNode=this._selectionParentNode||[];var R=this._totalSelections,J=this._selectionParentNode,S=T.added,P=T.removed,Q=[],L=[],K=T.src,N,M,O,U;J.push(K);for(N=0,O=P&&P.length;N<O;N++){L.push(K.items[P[N]]);}mstrmojo.array.removeItems(R,"did",L);for(M=0,U=S&&S.length;M<U;M++){Q.push(K.items[S[M]]);}this._totalSelections=R.concat(Q);}},getTotalSelections:function B(){if(this.selectionAcrossBranch){return this._totalSelections||[];}var J=this.selectionParentNode;return J&&J.getSelectedItems();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.hash","mstrmojo.func","mstrmojo.css","mstrmojo.HBox","mstrmojo.Box","mstrmojo.DropDownButton","mstrmojo.Popup","mstrmojo.WidgetTree","mstrmojo.ObjectBrowserDataProvider","mstrmojo.OBList","mstrmojo.FishEyeContainer","mstrmojo.SearchBox2","mstrmojo.Booklet","mstrmojo.IncFetch","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.mstr.ui.IncFetchOBList");var O=mstrmojo.hash,W=mstrmojo.func,L=mstrmojo.meta.TP,F="5CECE58CC1D549F890EB61C4DB2156A3",T="E0CCB9CF22104A489CBE78D974AFD19E",Q=mstrmojo.chart.model.enums.EnumDSSObjectType,K=mstrmojo.array,D=mstrmojo.dom,X=function(f,g,a){var d=f.scrollableIncFetch,c=d?"mstrmojo.mstr.ui.IncFetchOBList":"mstrmojo.OBList",e={scriptClass:c,items:g.items,multiSelect:a};if(d){e.browseConfig={blockBegin:g.bb,blockCount:g.bc,totalSize:g.sz,folderLinksContextId:f.folderLinksContextId,rootFolderID:g.did,browsableTypes:f.browsableTypes,browsableViewMedias:f.browsableViewMedias,dataProvider:f.dataProvider};e.onwaitingChange=function(){if(f.booklet){f.booklet.set("waiting",this.waiting);}};}var b=mstrmojo.insert(e);b.render();return b;},A=function(c,d,a){var b=mstrmojo.ObjectBrowser.widgetHandler||X;return b(c,d,a);},N={success:function(c){var d=this.ob,b=c.items,e=d.pageCache[d.currentPage],a=e._w;e.items=b;a.set("items",b);this.ob=null;this.item=null;window.clearTimeout(d._btm);d.booklet.set("waiting",false);if(d.scrollableIncFetch&&a.scrollNode){a.initScroll();a.updateScrollbars();}},failure:function(a){window.alert(a.getResponseHeader("X-MSTR-TaskFailureMsg"));this.ob.booklet.set("waiting",false);}},S=function(f,e,c){var d=c?-1:1,b=f.pageCache.length,g;for(g=f.currentPage+d;g<b&&g>=0;g+=d){var a=f.pageCache[g];if(a._k===e.k){return{steps:g-f.currentPage,cache:a};}}return null;},C=function(e,d,c,f){var g=e.currentPage+1,b=e.pageCache.length,a;for(a=g;a<b;a++){e.pageCache[a]._w.destroy();delete e.pageCache[a].items;}e.pageCache=e.pageCache.slice(0,g);f._w=c;f._k=d.k;e.pageCache[g]=f;e.cacheChange();},H=function(b){var a=mstrmojo.hash.walk("anc.items.0.items",b);this.set("canGoUp",!(!b.pf||!a));},I=function(e,d,f,c,b){delete e._btm;var a;if(!c){a=A(e,f,e.multiSelect);a.attachEventListener("change",e.id,"navigate");if(e.useDblSelect||e.useBothSglDblSelect){a.attachEventListener("dblclick",e.id,"dblselect");}}else{a=f._w;}e.obList=a;e.booklet.turn(a,b>0);window.setTimeout(function(){e.onBrowsing=false;},300);if(!c){C(e,d,a,f);}e.set("currentFolder",f);e.set("currentPage",e.currentPage+b);e.updateUpButton(f);if(e.scrollableIncFetch&&a.scrollNode){a.initScroll();a.updateScrollbars();}},P=function(c,b,a){var d=S(c,b,false);d=d||S(c,b,true);if(!d){window.clearTimeout(c._btm);c._btm=window.setTimeout(function(){c.booklet.set("waiting",true);},300);a.ob=c;a.item=b;c.getDataProvider().fetchFolderContents(c,b,a);}else{I(c,b,d.cache,true,d.steps);}},B=function(b,c,d,a){P(b,{fid:b.pageCache[b.currentPage].did,blockBegin:c,searchPattern:d,recursive:a},N);},J={success:function(b){var c=this.ob;if(c){window.clearTimeout(c._btm);if(!b.items){b.items=[{did:"empty",n:"("+mstrmojo.desc(2210)+")",t:"e"}];}var a=function e(f){var j=f.length,g;for(g=0;g<j;g++){var h=f[g];if(h.did===F||h.did===T){h.n=(h.did===F)?mstrmojo.desc(8112):mstrmojo.desc(9277);}if(h.items){a(h.items);}}};if(b.did===F||b.did===T){b.n=(b.did===F)?mstrmojo.desc(8112):mstrmojo.desc(9277);if(b.anc&&b.anc.items){a(b.anc.items);}}if(b&&b.items&&c.browsableViewMedias){var d={};K.forEach(c.browsableViewMedias.split(","),function(f){d[parseInt(f,10)]=true;});b.items=K.filter(b.items,function(f){return(f.t!==Q.DssTypeDocumentDefinition)||d[f.dvm];});}if(b&&b.items&&mstrApp&&mstrApp.isSingleTier){b.items=K.filter(b.items,function(f){return(f.st!==772);});}if(b.did&&this.item.k!==b.did){this.item.k=b.did;}I(c,this.item,b,false,1);this.ob=null;this.item=null;}},failure:function(a){this.ob.booklet.set("waiting",false);if(this.ob.onError){this.ob.onError(a);}else{if(a.getResponseHeader){mstrmojo.alert(a.getResponseHeader("X-MSTR-TaskFailureMsg"));}else{mstrmojo.alert(a.message);}}},complete:function(){if(this.ob){this.ob.onBrowsing=false;}}},Z=function(c){var b=c.pageCache.length,a;for(a=0;a<b;a++){c.pageCache[a]._w.destroy();}c.pageCache=[];c.currentPage=-1;c.cacheChange();},M=function(d,c,e){var a=d.onBrowseFolder;if(a){a[0][a[1]](c);}if(c&&parseInt(c.acg,10)===33){return ;}var b={};if(c){b.k=c.did;b.fid=c.did;}else{if(d.rootFolderID){b.k=d.rootFolderID;b.fid=d.rootFolderID;}else{if(d.rootFolderType){b.k=d.rootFolderType;b.fty=d.rootFolderType;}else{if(d.folderLinksContextId){b.k=d.folderLinksContextId;}}}}P(d,b,W.wrapMethods(e,O.copy(J)));},V=function(f,a,c){if(!c){return a;}var d=f.showCompletePath,h=a[0],e,b;while(h){var g;for(g=c.length-1;g>=0;g--){if(h.did===c[g].did){c.splice(g,1);h._isSc=true;}}b=h;h._open=true;h=h.items;h=h&&h[0];if(!h){b.lastLeaf=true;}}if(!d){h=a[0];while(h){if(h._isSc){a[0]=h;break;}h=h.items;h=h&&h[0];}}return a.concat(c);},U=function(b,a,c){b._naviInfo=V(b,a,c);};mstrmojo.ObjectBrowser=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.ObjectBrowser",rootFolderType:null,rootFolderID:null,sId:null,closeOnSelect:true,browsableTypes:null,browsableViewMedias:null,includeObjectDesc:false,closeable:true,fishEyeVisible:false,searchVisible:true,upButtonVisible:false,currentFolder:null,pageCache:[],currentPage:-1,blockCount:50,canGoUp:true,folderLinksContextId:null,minSearchLength:2,showCompletePath:true,multiSelect:false,onCloseCB:null,onSelectCB:null,onBrowseFolder:null,scrollableIncFetch:false,useBothSglDblSelect:false,displaySaveLabel:false,useOldSearch:false,getDataProvider:function(){if(!this.dataProvider){this.dataProvider=mstrmojo.insert({scriptClass:"mstrmojo.ObjectBrowserDataProvider"});}return this.dataProvider;},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},children:[{scriptClass:"mstrmojo.HBox",alias:"titleBar",cssClass:"mstrmojo-OB-titleTable",children:[{alias:"saveLabel",scriptClass:"mstrmojo.Label",cssClass:"msrmojo-save-label",text:mstrmojo.desc(3178,"Save in:"),bindings:{visible:"this.parent.parent.displaySaveLabel"}},{alias:"title",scriptClass:"mstrmojo.DropDownButton",cssClass:"mstrmojo-FormatEditor-DropDownButton",cssText:"margin:0px;",popupRef:{scriptClass:"mstrmojo.Popup",contentNodeCssClass:"mstrmojo-OBNavigatorPopup",cssText:"position:relative;",slot:"popupNode",locksHover:true,onOpen:function(){var a=this.opener.parent.parent,d=this.tree,c=a._naviInfo,b=this.parent.parent.parent.extraDDItems;if(d.items!==c){d._pup=this;this.ob=a;if(b){K.forEach(b,function(e){e.isExtra=true;});c=c.concat(b);}d.set("items",c);}},children:[{alias:"tree",scriptClass:"mstrmojo.WidgetTree",itemIdField:"did",itemFunction:function(e,a,b){var d=mstrmojo.WidgetTree.prototype.itemFunction(e,a,b);if(e.isExtra){if(e.cssClass){d.cssClass=e.cssClass;}d.onmousedown=e.onmousedown||mstrmojo.emptyFn;return d;}if(e._open){d.state=1;}d._ll=!!e.lastLeaf;d._pup=b._pup;d.onmousedown=function(f){var g=mstrmojo.dom.eventTarget(f.hWin,f.e),h=this._pup;if(g===this.domNode||g===this.textNode){if(!this._ll){M(h.ob,this.data);}h.close();}};d.markupMethods=O.copy(d.markupMethods);d.markupMethods.onstateChange=function(){var f=this.data.items?this.state:0;this.stateNode.className="mstrmojo-TreeNode-state "+({0:"closed",1:"opened",2:"leaf"}[f]||"closed");this.itemsContainerNode.style.display=(f===1)?"block":"none";};d.useRichTooltip=true;var c=d.postBuildRendering;d.postBuildRendering=function(){if(c){c.call(d);}if(d.textNode.parentNode.clientWidth){d.textNode.style.width=(d.textNode.parentNode.clientWidth-20)+"px";}};d.premouseover=function(h){if(this.useRichTooltip){var g=this.textNode;if(g.clientWidth<g.scrollWidth){var f=D.position(g);this.richTooltip={areaId:this.id,cssClass:"vi-regular vi-tooltip-C",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_TOPLEFT,content:this.data[this.itemDisplayField],top:f.y-2,left:f.x+f.w+6};}else{this.richTooltip=null;}mstrmojo.dom.stopPropogation(h.hWin,h.e);}return true;};return d;}}]}},{alias:"upButton",scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-OBListItemIcon up",title:mstrmojo.desc(1152,"Up One Level"),onclick:function(){this.parent.parent.goUp();},bindings:{enabled:"this.parent.parent.canGoUp",visible:"this.parent.parent.upButtonVisible"}},{alias:"closebtn",scriptClass:"mstrmojo.Button",iconClass:"mstrmojo-OBCloseButton",title:mstrmojo.desc(2102,"Close"),bindings:{visible:"this.parent.parent.closeable"},onclick:function(){this.parent.parent.close();}}]},{alias:"fishEye",scriptClass:"mstrmojo.FishEyeContainer",cssText:"width:100%",bindings:{visible:"this.parent.fishEyeVisible"}},{alias:"searchUpBar",scriptClass:"mstrmojo.HBox",cssClass:"searchBox",children:[{alias:"obSearchBox",scriptClass:"mstrmojo.SearchBox2",cssClass:"mstrmojo-charcoalbox mstrmojo-dxsprite",cssText:"margin: 3px 0; ",contentWidget:mstrmojo.all.obList,taskId:"searchMetadata",searchIncFetch:true,enableMatchCase:false,forceResetCache:true,bindings:{minSearchLength:"this.parent.parent.minSearchLength",quickSearch:"this.parent.parent.quickSearch"},serverRequest:function(a,b){this.parent.parent.getDataProvider().serverRequest(a,b);},preFetch:function(){this.objectTypes=this.parent.parent.browsableTypes||this.objectTypes;this.parent.parent.booklet.set("waiting",true);},postFetch:function(){this.parent.parent.booklet.set("waiting",false);},onUpdateSearchParams:function G(c){var b=this.parent.parent,a=b.sId;if(a){c.sessionState=a;}if(b.useOldSearch){c.quickSearch=0;c.nameWildcards=1;c.sortKey=6;}}}],bindings:{visible:"this.parent.searchVisible"}},{scriptClass:"mstrmojo.Booklet",cssClass:"mstrmojo-OB-booklet",alias:"booklet",hasAnimation:false,bindings:{scrollableIncFetch:"this.parent.scrollableIncFetch"}},{alias:"obIncFetch",scriptClass:"mstrmojo.IncFetch",height:"17px",cssText:"height:0px;overflow:hidden;",visible:false,np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onvisibleChange:function(b){var d=parseInt(this.height,10),a=this.np>1,c={target:this.domNode,props:{height:{start:(a?0:d),stop:(a?d:0),suffix:"px"}},onEnd:function(){if(a){this.target.style.overflow="visible";}}},e=new mstrmojo.fx.AnimateProp(c);this.domNode.style.overflow="hidden";mstrmojo.css.toggleClass(this.parent.domNode,"show-inc-fetch",this.visible);e.play();},onifsChange:function(a){var b=this.np;mstrmojo.hash.copy(a.value,this);if(this.np>1){this.children=null;this.refresh();}if((b<=1&&this.np>1)||(b>1&&this.np<=1)||(b===0&&this.np>0)){this.set("visible",this.np>1);}this.cssText="";}}],destroy:function Y(){Z(this);if(this._super){this._super();}},postBuildRendering:function(){if(this._super){this._super();}if(this.fishEye&&this.fishEyeVisible){this.fishEye.attachEventListener("selectedIndexChange",this.id,"onFishEyeChange");}var c=this.searchUpBar;if(c&&c.obSearchBox&&this.searchVisible){this.obSearchBox=this.searchUpBar.obSearchBox;this.obSearchBox.attachEventListener("itemsChange",this.id,"onSearchItemsChange");var a=this.obSearchBox.contentWidget||this.obSearchBox;if(!this.scrollableIncFetch){a.attachEventListener("ifsChange",this.id,function(d){if(!this.scrollableIncFetch){this.obIncFetch.set("ifs",d.value);}});}}if(!this.scrollableIncFetch&&this.obIncFetch){var b=this.obIncFetch;b.attachEventListener("fetch",this.id,function(d){b.cp=d.v;b.children=null;b.refresh();B(this,(d.v-1)*this.blockCount+1,this.searchVisible?this.obSearchBox.inputNode.value:"",1);});}mstrmojo.css.addClass(this.domNode,"mstrmojo-ObjectBrowser");},onSearchItemsChange:function(b){var c=b.value,a=this.pageCache[this.currentPage]._w;if(!c||c.length===0){c=[{did:"empty",n:"("+mstrmojo.desc(2210,"")+")",t:"e"}];}else{if(this.browsableViewMedias){var d={};K.forEach(this.browsableViewMedias.split(","),function(e){d[parseInt(e,10)]=true;});c=K.filter(c,function(e){return(e.t!==Q.DssTypeDocumentDefinition)||d[e.dvm];});}}a.set("items",c);},navigate:function(h){var a=h.src,j=a.selectedItem,c=this.multiSelect,f=c&&a.getSelectedItems(),g=this,b=h.added&&h.added.length,e=h.removed&&h.removed.length,d=c?f.length===1&&(!e||b):!!j;if(d&&j.did==="empty"){return ;}if(d&&parseInt(j[L],10)===8){if(!this.onBrowsing){this.onBrowsing=true;M(this,j);}}else{if((j&&(!this.useDblSelect||this.useBothSglDblSelect))||f){this.select(c?f:j);}}},browseFolder:function(a,b){M(this,{did:a,n:b});},onFishEyeChange:function(a){this.goToPage(a.value);},goToPage:function(a){if(a<this.pageCache.length&&a!==this.currentPage){var c=a>this.currentPage,b=this.pageCache[a];this.set("currentPage",a);this.booklet.turn(b._w,c);this.set("currentFolder",b);H.call(this,b);}},oncurrentPageChange:function(a){if(this.fishEye){this.fishEye.setSelectedIndex(a.value);}var b=this.pageCache[this.currentPage];this.titleBar.title.set("text",mstrmojo.string.encodeHtmlString(b.n));if(this.searchVisible&&this.obSearchBox){this.obSearchBox.set("rootCacheItems",b.items||[]);this.obSearchBox.set("totalSize",b.sz);this.obSearchBox.set("rootID",b.did);this.obSearchBox.clearSearch();}if(!this.scrollableIncFetch&&this.obIncFetch){this.obIncFetch.set("ifs",{np:Math.floor(b.sz/b.bc)+((b.sz%b.bc>0)?1:0),cp:Math.floor(b.bb/b.bc)+((b.bb%b.bc>0)?1:0)});}},cacheChange:function(){if(this.fishEye&&this.fishEyeVisible){this.fishEye.setItems(this.pageCache);}},browse:function(b,a){O.copy(b,this);if(this.searchVisible&&this.obSearchBox){this.obSearchBox.clear();}Z(this);M(this,undefined,a);},close:function(){var b=this.ctx||this,a=b.onCloseCB;if(a){a[0][a[1]]();}b.set("visible",false);},select:function(b){var a=this.onSelectCB;if(a){a[0][a[1]](b);}if(this.closeOnSelect){this.close();}},dblselect:function R(b){var c=b&&b.src.selectedItem;if(!c||(c&&c.did==="empty")||c[L]===8){return ;}if(this.useBothSglDblSelect){var a=this.onDblSelectCB;if(a){a[0][a[1]](c);}if(this.closeOnSelect){this.close();}}else{this.select(c);}},goUp:function(){if(this.canGoUp){M(this,{did:this.currentFolder.pf});}},updateUpButton:function E(a){H.call(this,a);},oncurrentFolderChange:function(a){var b=a.value;U(this,b.anc.items,b.sc);},refreshContent:function(a){B(this,a);},onError:null,onheightChange:function(){var a=["titleBar","fishEye","searchUpBar","obIncFetch"],c=0,b;for(b in a){c+=parseInt(this[a[b]].domNode.offsetHeight,10);}this.booklet.set("height",parseInt(this.height,10)-c+"px");}});}());(function(){mstrmojo.requiresCls("mstrmojo.WidgetTree","mstrmojo.expr","mstrmojo.AndOrNode","mstrmojo.ConditionNode");var F=mstrmojo.expr,B=F.ET;function A(G){var I=G&&G.src,J=I&&I.data,H=J&&J.et;return(H in F.ETs);}mstrmojo.FilterExpr=mstrmojo.declare(mstrmojo.WidgetTree,null,{scriptClass:"mstrmojo.FilterExpr",allowDrop:A,renderOnScroll:false,itemIdField:null,nodeClassMap:{14:mstrmojo.AndOrNode,"*":mstrmojo.ConditionNode},onBlankClick:function(G){this.clearTreeSelect();},onnodemousedown:function(H){var I=mstrmojo.dom.eventTarget(H.hWin,H.e),J=H.src,G=J.listMapper.findIndex(J,J.itemsContainerNode,I),K=G>=0?J.ctxtBuilder.itemWidgets[G]:null;if(!K||(K.isSelectableArea&&!K.isSelectableArea(I))){this.onBlankClick(H);}},getItemIdentityProp:function(G){return G.et;},itemFunction:function(L,I,M){var H=M.tree,J=H.getItemConfig(L,I,M),K=H.nodeClassMap,G=K[H.getItemIdentityProp(L)]||K["*"];return G&&(new G(J));},getItemConfig:function(J,G,K){var H=(J.et===B.ANDOR),I=K.tree||K;return{data:J,tree:I,parent:K,bindings:{prefixedAndOrEditable:"this.parent.editable"},itemFunction:(H)?K.itemFunction:null,draggable:H?I.draggable:false,dropZone:H?I.dropZone:false,allowDrop:H&&I.dropZone?I.allowDrop:null,allowCopy:H?I.allowCopy:false,editable:I.isEditable?I.isEditable(J):I.editable,makeObservable:H&&K.makeObservable,onclick:I.onnodeclick,onadd:I.onnodeadd,onremove:I.onnoderemove};},getDragData:function(G){var I=this._super(G);if(I&&!I.html){var H=I.et&&F.ET2TGT[I.et];I.html=H?I[H]&&I[H].n||"":I.n||"";}return I;},newCondition:function E(K){K=K||{et:B.AQ};var J=this.selectionParentNode,G;J=(J&&J.hasRendered)?J:this;if(J!==this){G=J.add([K]);}else{var I=this.addCondition([K],null,true);G=I.index;J=I.widget;}var H={widget:J,index:G,data:K};if(this.onNew){this.onNew(H);}return H;},addCondition:function D(I,K){var L=this.items,H=L&&L.length,N=I&&I.length;if(!N){return null;}var J,G;if(H&&L[0].et===B.ANDOR){J=this.ctxtBuilder.itemWidgets[0];G=J.add(I,null);}else{if(!H&&(N===1)){J=this;G=0;this.add(I,0);}else{if(H){var M=L[0];this.remove(M);I.unshift(M);}this.add([{et:B.ANDOR,fn:F.FN.AND,nds:I}],0);J=this.ctxtBuilder.itemWidgets[0];G=H?1:0;}}return{widget:J,index:G};},addSingleCondition:function C(H,G){var I=this.addCondition([H],G);return I.widget.ctxtBuilder.itemWidgets[I.index];},ondrop:function(J){if(this._super){this._super(J);}var H=this.items,G=H&&H.length,I=H.concat();if(G>1){if(H.remove){H.remove(0,H.length);}else{this.set("items",null);}this.add([{et:B.ANDOR,fn:F.FN.AND,nds:I}],0);}}});})();(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode");mstrmojo.threshold.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,null,{scriptClass:"mstrmojo.threshold.AndOrNode",cssClass:"adv-threshold",avatarCssCls:"mstrmojo-thresholdRow",onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);},consolidate:function A(){if(this.parent!==this.tree||this.itemCnt===0){this._super();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.AndOrNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo.expr","mstrmojo.dom","mstrmojo.array","mstrmojo.css");var L=mstrmojo.expr,N=mstrmojo.dom,C=mstrmojo.array,A=mstrmojo.css,F=mstrmojo.fe._IsRelationTreeNode.createSetHtml;var M=function(){var T="noRelationOperator",P=this[T],R=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],S=mstrmojo.array.filter(R,function(U){return U&&U[T]!==P&&U.data.et!==L.ET.RLS;}),O=S.length;for(var Q=0;Q<O;Q++){S[Q].set(T,P);}};mstrmojo.fe.AndOrNode=mstrmojo.declare(mstrmojo.AndOrNode,[mstrmojo.fe._IsRelationTreeNode],{scriptClass:"mstrmojo.fe.AndOrNode",markupString:'<div id="{@id}" class="mstrmojo-andor mstrmojo-AndOrNode {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-andor-prefix" mstrAttach:click><span class="mstrmojo-textset mstrmojo-andor-prefix-text"></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}">{@_prefixAndOrToolsMarkup}</span></div><div class="mstrmojo-andor-top"></div><div class="mstrmojo-andor-contentsWrapper" style="position:relative"><div class="mstrmojo-andor-contents" style="position:relative;{@itemsContainerCssText}">{@itemsHtml}</div><div class="mstrmojo-ListBase2-dropCue mstrmojo-AndOrNode-dropCue {@cssClass}"><div class="mstrmojo-ListBase2-dropCue-inner mstrmojo-AndOrNode-dropCue-inner"></div></div></div><div class="mstrmojo-andor-bottom"></div></div>',getPrefixAndOrToolsMarkup:function(){return(F+this._super());},markupSlots:mstrmojo.hash.copy({createSetNode:function(){return this.domNode.firstChild.childNodes[1].firstChild;}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupSlots)),markupMethods:mstrmojo.hash.copy({onnoRelationOperatorChange:function(){A.toggleClass(this.prefixHoverNode,["noRelation"],this.noRelationOperator);}},mstrmojo.hash.copy(mstrmojo.AndOrNode.prototype.markupMethods)),removeSet:function G(P){var O=P.childIndex(),Q=P.data,R=[Q];if(O>=0){this.remove(O,true);if(Q.nds&&Q.nds.length>0){R=Q.nds;if(Q.not){R[0].not=true;}}else{delete Q.dmy;delete Q.relation;delete Q.applySubExpr;delete Q.relation;delete Q.useSchema;delete Q.dmt;}this.add(R,O);this.consolidate(false);}},createSet:function E(Q,O){var P=this._ndsToMove(this,Q);if(!P){return ;}this.remove(P.idxs,true);var U=P.nds,T;if(U){if(U.length>1){var S={et:L.ET.ANDOR,nds:U};S.fn=this.data.fn;U=[S];T=S.nds[0].not;}else{var V=U[0];if(V&&V.not&&V.et===L.ET.ANDOR){T=V.not;delete V.not;}}}if(O&&O.rq){var R;if(O.isMetric){R=O.cq;mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],O.rq,R);}else{R=O.rq;R.nds=U;if(T){R.not=T;}}this.add([R],P.idxs[0]);}this.consolidate(false);},preclick:function H(O){var R=null,Q=N.eventTarget(O.hWin,O.e),P=this._super(O);if(N.contains(this.createSetNode,Q,true)&&!this.noRelationOperator){R="createSetOpt";}O.part=R||O.part;return P;},preadd:function I(O){if(this._super){this._super(O);}this.updateRelationOperator();},preremove:function K(O){if(this._super){this._super(O);}this.updateRelationOperator();},consolidate:function B(){this._super();this.updateRelationOperator();},postBuildRendering:function J(){var O=this._super();this.updateRelationOperator();return O;},updateRelationOperator:function D(){var O=this.ctxtBuilder&&this.ctxtBuilder.itemWidgets||[],P=!!C.filterOne(O,function(R){return R&&(R.data.et===L.ET.RLS||(R.data.et===L.ET.ANDOR&&R.noRelationOperator));}),Q=this.parent;this.set("noRelationOperator",P);M.call(this);if(Q&&Q.hasRendered&&Q.updateRelationOperator){Q.updateRelationOperator();}},onmouseover:function(){this.toggleGroupBorder(true);},onmouseout:function(){this.toggleGroupBorder(false);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.num","mstrmojo._HasOwnAvatar","mstrmojo.XtabBase","mstrmojo.models.template.DataInterface");var V=mstrmojo.array,E=mstrmojo.dom,P=mstrmojo.num,T=mstrConfig,H="px",B="xrsz",L=3,Q=mstrmojo.XtabBase.EnumLockedHeaders,S=Q.ROW,X=Q.BOTH;function I(){var Y=this.gridData.gts;return Y.row.concat(Y.col);}function M(){var q=this.gridData,d=this.lockHeadersCase,b=q.gts,j=q.ghs,Y=j.rhs||[],n=j.chs||[],m=Y.cws||[],r=(b.cws||[]).concat(n.cws||[]),l=q.gvs||[],k=m.concat(l.cws||[]),p=this.zone.domNode.getElementsByTagName("tr"),o=p&&p[p.length-1],e=false;if(o){var Z=o.getElementsByTagName("td")[0];q.xrh=(Z&&Z.offsetHeight)||0;}e=V.some(m,function(t){return t.w==="";});if(q.afw||q.afc||e){var h=this.rszmap;if(h.length){var c={left:0};V.forEach(h,function(u,t){if(r[t]){r[t].w=k[t].w=(u.left-c.left)+H;}c=u;});}else{var a=Math.max(r.length,k.length);V.forEach(p,function(t){var u=t.childNodes;if(u.length===a){V.forEach(t.getElementsByTagName("td"),function(w,v){if(r[v]){r[v].w=E.position(w).w+H;}if(k[v]){k[v].w=E.position(w).w+H;}});return false;}});}}else{if(d===S||d===X){var g=m.length;k[g].clr=r[g].clr=true;}}if(k.length!==r.length){var f=I.call(this);V.forEach(f,function(x,t){var u=x.fs,z=(u&&u.length)||0;if(z>1){var v=r[t],w;for(w=0;w<z-1;w++){r.splice(t+w+1,0,v);}}});if(k.length>r.length){r.push(k[k.length-1]);}}return{top:r,bottom:k};}function R(){var d=this.rszmap=[],a=0,c=0,b=this.gridData.twm=M.call(this),Z=b.bottom,Y=new mstrmojo.models.template.DataInterface(this.gridData),e=Y.getColumnHeaderData().length;V.forEach(Z,function(h,f){if(f>=e){return false;}var g=parseInt(h.w,10);c=h.clr?0:c;a+=g;c+=g;if((E.isChrome||E.isSafari)&&f===e-1){a=a-1;c=c-1;}d.push({left:a,offsetLeft:c});});V.forEach(d,function(n,f){var j=d[f+1],h=(j&&j.left),g=(h-n.left),m=[this.zone.domNode],k=this.getColClonedZone&&this.getColClonedZone();if(k){m.push(k);}if(!j||(g>(L*2))){V.forEach(m,function l(p){var r=document.createElement("div"),o=r.style,q=this;r.setAttribute("idx",String(f));r.className=B+((f>0&&d[f-1].skipped)?" zero":"");o.left=isNaN(n.offsetLeft)?"":((n.offsetLeft-L)+H);p.appendChild(r);r.ondblclick=function(t){q.onHandleDblClick(t);};},this);}else{n.skipped=true;}},this);}mstrmojo.rw.xtab._XtabColResize=mstrmojo.provide("mstrmojo.rw.xtab._XtabColResize",{_mixinName:"mstrmojo.rw.xtab._XtabColResize",rszmap:undefined,preWidth:0,onRender:function G(){if(this._super){this._super();}if(this.gridData.eg!==undefined){return ;}var Y=this;window.setTimeout(function(){if(!Y.hasRendered){return ;}R.call(Y);Y.raiseEvent({name:"xtabColsMeasured"});},0);E.attachMarkupEvent(this.id,this.domNode,"mousedown");},unrender:function U(Z){E.detachEvent(this.domNode,"mousedown",mstrmojo.emptyFn);if(this.scrollboxNode&&this.scrollboxNode.style&&this.scrollboxNode.style.width){var Y=this.scrollboxNode.style.width;this.preWidth=Y.indexOf("px")>0?parseInt(Y,10):0;}this._super(Z);},gridPagesRendered:function A(){if(this._super){this._super();}},isColResizeNode:function O(Y){return(Y.className||"").indexOf(B)>=0;},isDragValid:function C(Y){return this.isColResizeNode(Y.src.node)||(this._super&&this._super(Y))||false;},ondragstart:function W(b){if(this.isColResizeNode(b.src.node)){var a=E.position(this.domNode),d=E.findAncestorByAttr(b.src.node,"idx",true,this.domNode),Z=d&&parseInt(d.value,10),e=this.rszmap,f=e[Z].left-(Z>0?e[Z-1].left:0),c=Math.max(a.x,(b.src.pos.x-f)),Y=new mstrmojo.models.template.DataInterface(this.gridData);this.rszData={idx:Z,originalWidth:f,min:c,max:a.x+a.w,colName:Y.getColumnHeaderData()[Z].n};}if(this._super){this._super(b);}this.ignoreHover=true;},ondragmove:function K(a){if(this.rszData){var Z=this.rszData,Y=a.src.pos,b=Math.max((Z.originalWidth+(a.tgt.pos.x-Y.x)),0);this.avatar.firstChild.innerHTML=Z.colName+" "+((P.UNIT.PX==T.units)?b:parseFloat(P.convertUnits(P.UNIT.PX,T.units,b)).toFixed(2))+" "+T.unitsLabel;}this._super(a);},ondragend:function F(c){if(this.rszData){var b=this.gridData,a=this.rszData.idx,e=(new mstrmojo.models.template.DataInterface(b)).getColumnHeaderData(),f=e[a],Z=f.fs,Y=f.fix||1;if(Z&&Z.length>0){Y=a-V.find(e,"id",f.id)+1;}var d=f.oid||f.id;this.changeColumnWidth(d,f.otp,Math.max((parseInt(M.call(this).bottom[a].w,10)+(c.tgt.pos.x-c.src.pos.x)),0),Y,(d===""&&f.axis===2));delete this.rszData;}this._super(c);this.ignoreHover=false;},createAvatar:function N(c){var e=document.createElement("div"),Z=e.style,Y=E.position(c),b=E.position(this.domNode);if(this.isColResizeNode(c)){this.avatarCssClass=B;Z.top=b.y+H;Z.left=Y.x+H;Z.height=b.h+H;var d=document.createElement("div");d.className=B+"-ttp";var a=document.createElement("div");a.className=B+"-anchr";e.appendChild(d);e.appendChild(a);}else{delete this.avatarCssClass;}return e;},positionAvatar:function J(c,a){if(this.rszData){var Z=this.avatar,b=Z.style,Y=this.rszData;if(!this.avatar||!this.rszData){return ;}b.left=Math.min(Math.max(c.x,Y.min),Y.max)+"px";}else{this._super(c,a);}},preBuildRendering:function D(){if(!this.widthLimit&&this.preWidth){this.widthLimit=this.preWidth;}this._super();if(this.scrollboxNodeCssText.indexOf("width")===-1&&this.preWidth>0){this.scrollboxNodeCssText+="width:"+this.preWidth+"px;";}},onHandleDblClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._IsExprNode","mstrmojo.fe._IsRelationTreeNode","mstrmojo._HasPopup","mstrmojo.fe.AndOrNode","mstrmojo.fe.DynamicNode","mstrmojo.ConditionNode","mstrmojo.css","mstrmojo.string","mstrmojo.dom","mstrmojo.hash","mstrmojo.expr");var D=mstrmojo.css,A=mstrmojo.dom,G=mstrmojo.hash,C=function(L){var M=L.data,K=M.dmy&&M.dmy.uts||[],I=K.length,H=[],J;for(J=0;J<I;J++){H.push(K[J].n);}return'<span class="mstrmojo-text">'+H.join(", ")+"</span>";};mstrmojo.fe.RelationNode=mstrmojo.declare(mstrmojo.Container,[mstrmojo._IsExprNode,mstrmojo.fe._IsRelationTreeNode,mstrmojo._HasPopup],{scriptClass:"mstrmojo.fe.RelationNode",markupString:'<div id="{@id}" class="mstrmojo-relation {@cssClass}"  style="position:relative;{@cssText}" mstrAttach:mousedown><div class="mstrmojo-onhoverparent mstrmojo-relation-prefix {@cssClass}"><span class="mstrmojo-textset mstrmojo-relation-prefix-text" mstrAttach:click></span><span class="mstrmojo-onhover-in mstrmojo-andor-tools {@cssClass}"><span class="mstrmojo-indent" onclick="mstrmojo.all[\'{@id}\'].ind()">'+mstrmojo.desc(5895,"Group conditions")+'</span><span class="mstrmojo-outdent" onclick="mstrmojo.all[\'{@id}\'].out()">'+mstrmojo.desc(5896,"Ungroup Conditions")+'</span></span></div><div class="mstrmojo-relationNode"><span class="mstrmojo-relationNode-inf"><span class="mstrmojo-relation-prefix-text">'+mstrmojo.desc(2790,"Set of").replace(/##/g,"")+'</span><span class="mstrmojo-textset"  mstrAttach:click></span><span class="mstrmojo-relation-postfix-text">'+mstrmojo.desc(2793,"Where").replace(/##/g,"")+'</span><span class="mstrmojo-relation-convert-text"  mstrAttach:click >'+mstrmojo.desc(null,"Convert to Condition")+'</span><img class="mstrmojo-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(7931,"Delete condition")+'"onclick="mstrmojo.all[\'{@id}\'].del()" /></span><div class="mstrmojo-relation-childTreeNode" style="position:relative;"></div></div></div>',markupSlots:{prefixHoverNode:function(){return this.domNode.firstChild;},prefixNode:function(){return this.domNode.firstChild.firstChild;},relationNode:function(){return this.domNode.lastChild;},textNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1];},convertNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[3];},containerNode:function(){return this.domNode.childNodes[1].childNodes[1];}},markupMethods:{onprefixedAndOrEditableChange:function(){D.toggleClass(this.prefixNode,["editable"],this.prefixedAndOrEditable);},onselectedChange:function(){D.toggleClass(this.relationNode,["selected"],this.selected);},ondataChange:function(){this.prefixNode.innerHTML=this.andOrTxt();this.textNode.innerHTML=C(this);}},noRelationOperator:true,children:[{scriptClass:"mstrmojo.fe.RelationFilterExprTree",alias:"childTree",ignoreLayout:true,dropZone:false,draggable:false,nodeClassMap:{14:mstrmojo.fe.AndOrNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},onNew:function(H){this.parent.tree.onNew(H);},getItemConfig:function(K,H,L){var I=mstrmojo.fe.RelationFilterExprTree.prototype.getItemConfig.call(this,K,H,L),J=L.tree||L;return G.copy({tree:J,rootTree:this.parent.tree,noRelation:true,inRelation:true},I);},prenodeclick:function(H){if(!H||!H.part){return ;}var I=this.rootTree;if(I&&I.onnodeclick&&this.editable){H.editor=I.editor;I.onnodeclick.call(this,H);}}}],premousedown:function(H){if(this._super){this._super(H);}var I=A.eventTarget(H.hWin,H.e);if(!A.contains(this.childTree.domNode,I,true)){this.childTree.clearTreeSelect();}},preselectedChange:function(H){if(!H.value){this.childTree.clearTreeSelect();}},init:function(H){this._super(H);var I=this.data;if(I){delete this.data;this._set_data(null,I);}},_set_data:function(K,H){var I=this.data,J=(I!==H);if(J){this.data=H;if(H){this.childTree.set("items",H.nds||[H]);}}return J;},isSelectableArea:function(H){return mstrmojo.dom.contains(this.relationNode,H,true);},preclick:function E(H){var J=null,I=A.eventTarget(H.hWin,H.e);if(A.contains(this.prefixNode,I,true)){J="andor";}else{if(A.contains(this.textNode,I,true)){J="createSet";}else{if(A.contains(this.convertNode,I,true)){this.parent.removeSet(this);return false;}}}H.part=J;},del:function B(){var H=this.parent;if(H&&H.remove&&this.data){H.remove(this.data);}},newCondition:function F(H){this.childTree.newCondition(H);},avatarCssCls:"mstrmojo-FE mstrmojo-relationNode",getAvatarNode:function(){return this.relationNode.cloneNode(true);}});})();(function(){mstrmojo.requiresCls("mstrmojo.FilterExpr","mstrmojo.threshold.AndOrNode","mstrmojo.threshold.ConditionNode","mstrmojo.expr");var G=mstrmojo.expr,F=G.ET;mstrmojo.threshold.ThresholdExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.threshold.ThresholdExprTree",cssClass:"mstrmojo-ThresholdExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,supportRelation:true,nodeClassMap:{14:mstrmojo.threshold.AndOrNode,"*":mstrmojo.threshold.ConditionNode},onConditionEdit:mstrmojo.emptyFn,editor:undefined,isEditable:function C(H){if(!this.editable){return false;}if(H&&H.et===F.XML){return !H.xml;}return true;},onNew:function E(H){H.data.isNew=true;this.editor.openConditionWalk(H.data,H.widget.ctxtBuilder.itemWidgets[H.index]);},onnodeclick:function D(H){var I=H.part;if(!H||!I){return ;}var K=I==="andor",J=this.tree.editor;if(!((K&&this.prefixedAndOrEditable)||(!K&&this.editable))){return ;}if(!this.editable){return ;}if(K){J.openAndORPopup(this,H.getTarget());return ;}else{if(I==="addCondition"){this.tree.newCondition(null);return ;}}J.openConditionWalk(this.data,this);},allowDrop:function B(H){var M=H&&H.src,L=M&&M.data,J=L&&L.et,K=this.tree,I=M&&M.widget&&M.widget.tree;return J&&(this===K?(I!==K):true);},remove:function A(I){var H=this._super(I);if(this.items.length===0&&I.et===F.ANDOR&&I.nds.length===0&&this.parent.removeFromModel){this.parent.removeFromModel();}return H;}});}());(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.hash","mstrmojo.FilterExpr");var D=mstrmojo.hash,B=mstrmojo.expr.ET;mstrmojo.fe.FilterExprTree=mstrmojo.declare(mstrmojo.FilterExpr,null,{scriptClass:"mstrmojo.fe.FilterExprTree",allowCopy:false,containerResizable:false,draggable:true,dropZone:true,editable:true,makeObservable:true,onConditionEdit:mstrmojo.emptyFn,modifyConditionNode:function(G,F){var H=G.data,E=H.isNew;D.copy(D.clone(F),D.clear(H));delete H.isNew;G.paint();if(H.et===B.MQ||H.et===B.MC){G.set("noCreateSet",true);}if(G.tree.onConditionEdit){G.tree.onConditionEdit(G,E);}},getItemConfig:function(H,E,I){var F=this._super(H,E,I),G=I.tree;return D.copy({onclick:G.prenodeclick,containerResizable:G.containerResizable,ondragend:G.ondragend,ondrop:G.ondrop},F);},ondragenter:function A(E){this.dropCuePos={left:0,top:0,idx:0,idxActual:0};this._super(E);},ondragend:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondragend.call(this,E);}},ondrop:function(E){if(this===this.tree){return this._super(E);}else{return this.constructor.prototype.ondrop.call(this,E);}},isEditable:function C(F){if(!this.editable){return false;}var E=false;switch(F&&F.et){case B.R:case B.F:E=false;break;case B.ANDOR:case B.MQ:case B.AQ:case B.AL:case B.AC:case B.MC:case B.AE:E=true;break;case B.XML:E=!F.xml||!!F.ph;}return E;},prenodeclick:function(E){if(!E||!E.part){return ;}if(E.part!=="createSet"&&E.part!=="createSetOpt"&&!(E.part==="andor"?this.prefixedAndOrEditable:this.editable)){return ;}var F=this.tree;if(F.onnodeclick){F.onnodeclick.call(this,E);}},getSelectedItemWidget:function(){var E=function(K){var I=K&&K.ctxtBuilder&&K.ctxtBuilder.itemWidgets,G=K.selectedIndex,F=I&&I.length||0;if(!I){return ;}if(G===-1){for(var H=0;H<F;H++){var J=E(I[H]);if(J){return J;}}}else{return I[G];}};return E(this);}});})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.Label","mstrmojo.Obj","mstrmojo.ui.Checkbox","mstrmojo.ui.CheckList","mstrmojo.warehouse.EnumObjectTypes");var G=mstrmojo.expr,C=G.ET,B=mstrmojo.array,E=mstrmojo.string,F=mstrmojo.warehouse.EnumObjectTypes,D=mstrmojo.mstr.EnumNodeDimty;mstrmojo.fe.CreateSetEditor=mstrmojo.declare(mstrmojo.Editor,null,{onOpen:function(){var M=this.model,P=this.condition.data,N=!P.m,J=this.attrsBox.attrsList,H=this.relBox.relPd,Q=[{n:mstrmojo.desc(12037,"System Default"),t:-1,did:"default"}].concat(M.metrics),I=this.appQual;J.set("items",M.attrs);mstrmojo.array.forEach(["relBox","appQual"],function(R){this[R].set("visible",N);},this);if(P.dmt===4&&P.dmy.uts){var K={};B.forEach(P.dmy.uts,function(S){var R=B.find(M.attrs,"did",S.utgt.did);if(R>=0){K[R]=true;}});J.set("selectedIndices",K);}if(N){H.set("items",Q);if(P.relation&&P.relation.guide){var L=P.relation.guide,O=B.find(Q,"did",L.did);H.set("selectedIndex",O>=0?O:0);}else{H.set("selectedIndex",0);}I.set("checked",!!P.applySubExpr);}},onOK:function(){var O=this.model,R=this.condition,T=this.condition.data,L=this.attrsBox.attrsList,H=this.relBox.relPd,J=this.appQual;var V=L.getSelectedItems(),I=[];B.forEach(V,function(X){I.push({utgt:{n:X.n,did:X.did},utp:G.DMY_TP.ATTR,agg:1,flt:2,gb:true,rps:0,n:X.n});});var U;if(H.selectedIndex>0){var M=H.items[H.selectedIndex];U={n:M.n,did:M.did,t:F.METRIC,st:1024};}var K;if(T.et===15){T.dmt=D.NodeDimtyOutputLevel;T.dmy=T.dmy||{};T.dmy.uts=I;K=T.relation=T.relation||{};if(U){K.guide=U;T.useSchema=false;}else{delete K.guide;delete K.rsTp;delete K.joTp;delete K.paTp;delete K.erTp;T.useSchema=true;}T.applySubExpr=J.checked;R.set("data",T);}else{var S={et:15};S.dmt=D.NodeDimtyOutputLevel;S.dmy={};S.dmy.uts=I;K=S.relation={};if(U){K.guide=U;}else{S.useSchema=true;}S.applySubExpr=J.checked;var N=R,P={rq:S,cq:T},Q=[R.childIndex()];if(T.et===C.ANDOR){if(T.nds&&T.nds.length>2){var W=O.childIdx;Q=[W,W-1];}else{N=R.parent;}}else{N=R.parent;P.isMetric=!!T.m;}N.createSet(Q,P);}},children:[{scriptClass:"mstrmojo.Box",alias:"attrsBox",cssClass:"Attributes-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14613,"Select attributes to create the set"),cssClass:"Label"},{scriptClass:"mstrmojo.ui.CheckList",alias:"attrsList",cssClass:"CheckList"}]},{scriptClass:"mstrmojo.Box",alias:"relBox",cssClass:"RelatedBy-Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12036,"Related by"),cssClass:"Label",cssDisplay:"inline-block"},{scriptClass:"mstrmojo.ui.Pulldown",alias:"relPd",cssClass:"Pulldown",cssDisplay:"inline-block",onitemSelected:function A(H){}}]},{scriptClass:"mstrmojo.ui.Checkbox",alias:"appQual",cssClass:"AppQual-CheckBox",postBuildRendering:function(){this.domNode.innerHTML=E.encodeHtmlString(mstrmojo.desc(12038,"Apply this qualification independently of the relationship filter"));}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float: right; border-collapse: separate; display: table;",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(2397,"OK"),onclick:function(){var H=this.editor;H.onOK();H.close();},bindings:{enabled:function(){var I=this.parent.parent.attrsBox.attrsList,H=this.parent.parent.attrsBox.attrsList.selectedIndices;return I.getSelectedItems().length>0;},editor:"this.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.editor.close();},bindings:{editor:"this.parent.parent"}}]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.ObjectBrowser");var H=mstrmojo.array;var E=[257,1024,3072,12032];mstrmojo.vi.ui.editors.ObjectPicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.ObjectPicker",cssClass:"mstrmojo-vi-ObjectPicker",zIndex:9,title:mstrmojo.desc(11496,"Select Object"),help:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:4,supportedTypes:H.hash(E),item:null,OKFn:null,children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",closeable:false,browsableTypes:"8,"+E.join(","),closeOnSelect:false,showCompletePath:false,searchVisible:false,scrollableIncFetch:true,bindings:{rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId"}},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",alias:"btnHBox",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(1442,"OK"),onclick:function C(){var J=this.parent.parent;this.parent.parent.close({item:J.item});var I=J.OKFn;if(I){I(J.item);}J.set("item",null);},bindings:{enabled:function B(){return !!this.parent.parent.item;}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(2399,"Cancle"),onclick:function C(){var I=this.parent.parent;this.parent.parent.close();I.set("item",null);}}]}],preBuildRendering:function A(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];},postBuildRendering:function D(){if(this._super){this._super();}this.browse();},onOBSelect:function F(I){this.set("item",((this.supportedTypes[I.t]||this.supportedTypes[I.st])?I:null));},browse:function G(){this.ob.browse();}});}());(function(){mstrmojo.requiresCls("mstrmojo.VBox","mstrmojo.ObjectBrowser","mstrmojo.HTMLButton");mstrmojo.requiresDescs(1059,1441,3413,3414,4996,7972,9893);var A={768:true,769:true,774:true,776:true,779:true};mstrmojo.IVEDatasetPicker=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.IVEDatasetPicker",cssClass:"mstrmojo-vi-dataset-picker",title:mstrmojo.desc(11940,"Select Existing Dataset"),help:"select_dataset_from_scratch_dialog_box.htm",startingFolder:null,item:null,multiSelect:false,selectedItems:null,children:[{alias:"newLabel",scriptClass:"mstrmojo.FieldSet",legend:mstrmojo.desc(4996,"New"),cssClass:"mstrmojo-ive-fs"},{alias:"btnImport",scriptClass:"mstrmojo.Button",text:mstrmojo.desc(13550,"Access External Data"),cssClass:"mstrmojo-ive-import",onclick:function(){this.parent.close({action:"import"});}},{alias:"useExistingLabel",scriptClass:"mstrmojo.FieldSet",legend:mstrmojo.desc(9893,"Use Existing"),cssClass:"mstrmojo-ive-fs"},{scriptClass:"mstrmojo.ObjectBrowser",alias:"ob",cssText:"border-width:1px;border-color:#DDDDDD;",closeable:false,browsableTypes:"8,768,769,774,776,779",closeOnSelect:false,showCompletePath:false,searchVisible:true,upButtonVisible:true,folderLinksContextId:1,bindings:{rootFolderID:function(){return this.parent.startingFolder;},multiSelect:"this.parent.multiSelect"}},{scriptClass:"mstrmojo.HBox",alias:"btnHBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1059,"Next"),onclick:function(){this.parent.parent.close({item:this.parent.parent.item});},bindings:{enabled:function(){return !!(this.parent.parent.multiSelect?this.parent.parent.selectedItem.length:this.parent.parent.item);}}}]}],preBuildRendering:function(){if(this._super){this._super();}this.ob.onSelectCB=[this,"onOBSelect"];this.ob.onBrowseFolder=[this,"onOBBrowseFolder"];this.ob.booklet.set("animates",false);this.ob.rootFolderID=this.startingFolder;},postBuildRendering:function(){if(this._super){this._super();}this.ob.browse();},onOBSelect:function(B){if(this.multiSelect){this.set("selectedItems",mstrmojo.array.filter(B,function(C){return A[C.st];}));}else{this.set("item",(A[B.st]?B:null));}},onOBBrowseFolder:function(B){if(this.multiSelect){this.set("selectedItems",null);}else{this.set("item",null);}},onstartingFolderChange:function(){this.ob.rootFolderID=this.startingFolder;this.ob.browse();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.TextBox","mstrmojo.TextArea","mstrmojo.Table","mstrmojo.HBox","mstrmojo.Editor","mstrmojo.ObjectBrowser","mstrmojo.NewFolderEditor");function B(){var E={alias:"newFolder",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-createfolder",text:mstrmojo.desc(3245,"Create New Folder"),onclick:function(){var G=this.parent.parent,F={zIndex:G.zIndex+10,navigateAfter:false,fId:G.ob.currentFolder.did,okFn:function(H,I){G.ob.refreshContent();if(I){G.ob.browseFolder(H.fid,G.newFolder);}}};if(G.ob.dataProvider){F.dp=G.ob.dataProvider;}G.openPopup("newFolder",F);},postCreate:function(){this.set("visible",mstrmojo.resolveFeature("create-folder"));}},D=mstrmojo.hash.clone(mstrmojo.ObjectBrowser.prototype.children);D.push(E);return D;}mstrmojo.SaveAsObjectBrowser=mstrmojo.declare(mstrmojo.ObjectBrowser,null,{scriptClass:"mstrmojo.SaveAsObjectBrowser",cssClass:"mstrmojo-SaveAs-OB",children:B()});var A={success:function(D){var E=this.parent;if(E.onObjectSaved){E.onObjectSaved({name:E.name,did:D.did,desc:E.desc});}mstrmojo.alert(mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",E.typeDesc||"Object").replace("###",E.name),null,mstrmojo.desc(7984,"Object Saved"));E.ob.refreshContent();E.close();},failure:function(E){var D=parseInt(E.getResponseHeader("X-MSTR-TaskErrorCode"),10)+4294967296,F=this.parent;if(D==2147749923){mstrmojo.confirm(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",F&&F.typeDesc||"Object").replace("'###'",F&&F.name?'"'+F.name+'"':""),{confirmBtn:{fn:function(){F.saveAs(true);}}},{title:mstrmojo.desc(3179),zIndex:F&&F.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+E.getResponseHeader("X-MSTR-TaskFailureMsg"));}}};mstrmojo.SaveAsEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SaveAsEditor",cssClass:"mstrmojo-SaveAsEditor",title:mstrmojo.desc(3167,"Save As"),sId:null,rootFolderID:null,rootFolderType:null,folderLinksContextId:null,browsableTypes:null,showCompletePath:true,desc:"",name:"",help:"Save_As_dialog_box.htm",displaySaveLabel:true,searchVisible:true,upButtonVisible:true,children:[{scriptClass:"mstrmojo.SaveAsObjectBrowser",alias:"ob",closeable:false,closeOnSelect:false,fishEyeVisible:false,bindings:{showCompletePath:"this.parent.showCompletePath",rootFolderID:"this.parent.rootFolderID",rootFolderType:"this.parent.rootFolderType",folderLinksContextId:"this.parent.folderLinksContextId",browsableTypes:"this.parent.browsableTypes",displaySaveLabel:"this.parent.displaySaveLabel",searchVisible:"this.parent.searchVisible",upButtonVisible:"this.parent.upButtonVisible",sId:"this.parent.sId"},postCreate:function(){this.onSelectCB=[this.parent,"onOBSelect"];this.onBrowseFolder=[this.parent,"onOBBrowseFolder"];}},{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-Input-Panel",rows:2,cols:2,alias:"contPanel",children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Name-Label",slot:"0,0",text:mstrmojo.desc(2211,"Name:")},{scriptClass:"mstrmojo.TextBox",slot:"0,1",value:mstrmojo.desc(8116,"New Folder"),alias:"name",cssClass:"mstrmojo-SaveAsEditor-nameInput",bindings:{value:"this.parent.parent.name"}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Desc-Label",slot:"1,0",text:mstrmojo.desc(1154,"Description:")},{scriptClass:"mstrmojo.TextArea",cssClass:"mstrmojo-SaveAsEditor-descInput",slot:"1,1",alias:"desc",bindings:{value:"this.parent.parent.desc"},rows:5}]},{scriptClass:"mstrmojo.HBox",alias:"buttonBox",slot:"buttonNode",cssClass:"mstrmojo-Editor-buttonBar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot okButton",alias:"ok",text:mstrmojo.desc(2400,"Save"),onclick:function(){this.parent.parent.saveAs();}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",alias:"cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]}],newFolder:{scriptClass:"mstrmojo.NewFolderEditor"},onOpen:function(){this.ob.browse();},onOBBrowseFolder:mstrmojo.emptyFn,onOBSelect:function(D){this.set("name",D.n);},saveAsCallback:function C(){return A;},saveAs:function(F){var E=this.contPanel;this.name=E.name.value;this.desc=E.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var G=this.saveParams||{};G.folderID=this.ob.currentFolder.did;G.description=this.desc||"";G.name=this.name||"";G.saveAsOverwrite=!!F;var D=this.saveAsCallback();D.parent=this;mstrmojo.xhr.request("POST",mstrConfig.taskURL,D,G);}});mstrmojo.SaveAsEditor.SAVEAS_CALLBACK=A;})();(function(){mstrmojo.requiresCls("mstrmojo.TreeBrowserNode","mstrmojo.TreeBrowser","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserTreeBrowser=mstrmojo.declare(mstrmojo.TreeBrowser,null,{scriptClass:"mstrmojo.ACL.UserTreeBrowser",itemIdField:"did",branchClickPolicy:mstrmojo.TreeBrowserEnum.BRANCH_POLICY_SELECT,getACLUserDataService:function D(){return mstrmojo.ACL.UserDataService;},getContentThroughTaskCall:function C(G,E){var F=this.getACLUserDataService();E.failure=mstrmojo.func.composite([function(H){if(H.getResponseHeader){mstrmojo.alert(H.getResponseHeader("X-MSTR-TaskFailureMsg"));}},E.failure]);if(G.isRoot){F.getTopLevelGroups(G,E);}else{F.getMembers(G,E);}},isBranch:function B(E){return E.isGroup;},item2textCss:function A(E){return(this._super&&this._super(E))||"mstrmojo-ACLInputBox-user "+{8704:"u",8705:"ug"}[E.st];}});})();(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.hash","mstrmojo._ValidateSuggestions","mstrmojo.WidgetList","mstrmojo.Editor","mstrmojo.LegacySuggestionList");mstrmojo.Enum_OIB_States=mstrmojo.hash.copy(mstrmojo._ValidateSuggestions.ENUM_STATES,{EDITING:2,ADDING:3,EMPTY:4});mstrmojo.Enum_OIB_States_CSS=(function(){var AD=mstrmojo.Enum_OIB_States,AC={},AE;for(AE in AD){if(AD.hasOwnProperty(AE)){AC[String(AD[AE])]=AE;}}return AC;}());var Q=mstrmojo.dom,S=mstrmojo.hash,Z=mstrmojo.Enum_OIB_States,I=0,b="_did_",x=mstrmojo.Enum_Keys,AA=80,U=200;function P(){return I++;}function g(AC){return(AC&&AC.state===Z.ADDING);}function p(AC){var AD={n:AC||"",state:Z.EMPTY};AD[b]=-2;return AD;}function O(AC){return(AC&&AC.state===Z.EMPTY);}function u(AD){var AE=AD.items,AC=AE&&AE.length;if(!AC){return true;}return(AC===1&&g(AE[0]))||(AC===2&&O(AE[0])&&g(AE[1]));}function l(){var AD=this.ctxtBuilder.itemWidgets,AC=AD[AD.length-1];if(AC&&AC.isAdding){var AE=this;Q.attachEvent(AC.domNode,"click",function(){AE.editingIdx=null;});return AC;}return null;}function L(){var AC=this.editingIdx;if(AC!==null){return this.ctxtBuilder.itemWidgets[AC];}return l.call(this);}function D(){this.isActive=false;var AD=this.emptyText||"",AE=this.items;if(u(this)&&!O(AE[0])&&(AD.length>0)){this.add([p(AD)],0);var AF=this.ctxtBuilder.itemWidgets[0];AF.set("shouldEllipsize",true);AF.doEllipsize();}var AC=L.call(this);if(AC){if(g(AC)&&this.showEmptyItem){AC.domNode.style.display="none";}this.scrollTo(this.items[0]);AC.blur();}Q.detachEvent(document.body,"mousedown",this._mousedownHandler);if(this.tabNavigable){Q.detachEvent(AC.inputNode,"keydown",this._tabKeyHander);}}function N(){if(!this.enabled){return ;}this.isActive=true;if(O(this.items[0])){this.remove(0);}var AC=L.call(this);if(AC){if(g(AC)&&!this.isFull){AC.domNode.style.display="block";}this.scrollTo(AC.data);AC.focus();}Q.attachEvent(document.body,"mousedown",this._mousedownHandler);if(this.tabNavigable){Q.attachEvent(AC.inputNode,"keydown",this._tabKeyHander);}}mstrmojo.ObjectInputBox=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo._ValidateSuggestions],{scriptClass:"mstrmojo.ObjectInputBox",cssClass:"mstrmojo-ObjectInputBox",emptyText:"",showEmptyItem:true,items:null,itemField:"n",dynamicVerify:true,suggestCount:10,candidates:null,makeObservable:true,renderOnScroll:false,editingIdx:null,isActive:false,maxObjectCount:null,isFull:false,suggestionListClass:"mstrmojo.LegacySuggestionList",acptSugItemOnly:false,useKeyDelay:false,showSuggestionOnEdit:true,tabNavigable:false,getSearchPattern:function(){var AC=L.call(this);if(AC){return AC.getSearchPattern();}return"";},getSuggestionTarget:function m(){return this.suggestTarget;},onsuggestTargetChanged:function o(AC){this._request_pattern=null;},getSuggestionPos:function c(){return this._pop_cfg;},onSuggestionItemSelect:function v(AC){if(this.suggestTarget){this.suggestTarget.setItem(AC[this.itemField],AC,false);}this.hideSuggestion();this.closePopup();},hideEditButton:function(AC){return !!this.noEditButton;},_set_items:function k(AH,AE){AE=mstrmojo.hash.clone(AE)||[];var AG=this.maxObjectCount;this.set("isFull",(AG&&AE.length>=AG));if(AE.length===0){var AD=this.emptyText||"";if(AD.length>0){AE.push(p(AD));}}var AF={n:"",state:Z.ADDING};AF[b]=-1;AE.push(AF);var AC=AE[AE.length-1];if(AC&&g(AC)&&this.maxObjectCount&&(this.getSelectedObjects().length>=this.maxObjectCount)){this.set("isFull",true);}this.itemIdField=b;return this._super(AH,AE);},add:function E(AD,AC){var AE=l.call(this);if(!this.maxObjectCount||this.getSelectedObjects().length<this.maxObjectCount){this._super(AD,AC);}if(!u(this)&&O(this.items[0])){this.remove(0);}if(AE){AE.adjustInputWidth();if(this.maxObjectCount&&(this.getSelectedObjects().length===this.maxObjectCount)){this.set("isFull",true);AE.domNode.style.display="none";}else{AE.domNode.style.display=this.showEmptyItem?"none":"";}}},remove:function a(AC){this._super(AC);var AD=l.call(this);if(AD){if(this.maxObjectCount&&(this.getSelectedObjects().length<this.maxObjectCount)){this.set("isFull",false);}AD.adjustInputWidth();}},preBuildRendering:function(){if(this.items==null||this.items.length==0){this.set("items",[]);}if(this._super){this._super();}},postBuildRendering:function Y(){this._super();var AD=this,AC=l.call(AD);if(AC&&(this.showEmptyItem||this.isFull)){AC.domNode.style.display="none";}this._clickHandler=function(){N.call(AD);};this._mousedownHandler=function(AE){if(!AD.isActive||AD.browserShown){return ;}var AF=Q.eventTarget(self,AE);if(AF&&AF.parentNode&&!Q.contains(L.call(AD).domNode,AF,false,document.body)&&!Q.contains(AD.suggestionPopup.domNode,AF,false,document.body)){D.call(AD);}};if(this.tabNavigable){this._tabKeyHander=function(AE){var AF=parseInt(AE.keyCode||AE.charCode,10);if(AF===x.TAB){if(!AD.isActive||AD.browserShown){return ;}D.call(AD);}};}Q.attachEvent(this.domNode,"click",this._clickHandler);},nextId:P,item2textCss:function M(AC){return AC.cssClass||"";},itemFunction:function G(AE,AC,AD){AE[AD.itemIdField]=P();var AF=new mstrmojo.ObjectItem({parent:AD,itemField:AD.itemField,cssClass:AD.item2textCss(AE),data:AE,showSuggestionOnEdit:this.showSuggestionOnEdit,enabled:AD.enabled});AD.attachEventListener4ItemWidget(AF,AD);return AF;},attachEventListener4ItemWidget:function h(AG,AE){var AD=["ItemEditBegin","ItemEditEnd","ItemDeletePrev","ItemDelete","ItemAdd","SuggestionOn","SuggestionOff","ItemEditing"],AC=AD.length,AF;for(AF=0;AF<AC;AF++){AG.attachEventListener(AD[AF],AE.id,"_itemChangeHandler");}return AG;},getSelectedObjects:function j(){if(u(this)){return[];}var AC=this.items,AD=AC.length-1;if((AD>-1)&&g(AC[AD])){return AC.slice(0,AD);}return AC.concat();},isValid:function C(){var AD=this.ctxtBuilder.itemWidgets,AC=AD&&AD.length,AE;for(AE=0;AE<AC;AE++){if(!AD[AE].isValid()){return false;}}return true;},isEmpty:function V(){return u(this);},_itemChangeHandler:function(AF){var AH=AF.name,AI=AF.d,AD,AC=this.items.length,AE;switch(AH){case"ItemEditBegin":if(this.editingIdx!==null){AE=L.call(this);if(AE){AE.blur();}}AD=this.itemIndex(AI);this.editingIdx=AD;N.call(this);break;case"ItemEditEnd":this.editingIdx=null;if(AF.deactivate){D.call(this);}else{N.call(this);}AE=l.call(this);if(AE){AE.adjustInputWidth();}break;case"ItemDelete":if(this.editingIdx!==null){AE=L.call(this);if(AE){AE.blur();}this.editingIdx=null;}AD=this.itemIndex(AI);this.remove(AD);if(!AF.deactivate){this.editingIdx=null;N.call(this);}else{if(!this.isActive){D.call(this);}else{N.call(this);}}break;case"ItemDeletePrev":if(AC>1){this.remove(AC-2);}break;case"ItemAdd":var AG=S.copy(AF.d);this.add([AG],AC-1);if(AF.deactivate){D.call(this);}else{N.call(this);}break;case"SuggestionOn":this.set("suggestTarget",AF.target);this._pop_cfg={target:AF.target,left:AF.l,top:AF.t,zIndex:this.zIndex?this.zIndex:100};this.showSuggestion(AF.pattern);break;case"SuggestionOff":this.set("suggestTarget",null);this.hideSuggestion();break;}if(this.onitemchange&&(AH==="ItemEditEnd"||AH==="ItemAdd"||AH==="ItemDelete"||AH==="ItemDeletePrev"||AH==="ItemEditing")){this.onitemchange();}},unrender:function B(AD){var AC=this.suggestionPopup;if(AC.hasRendered){AC.unrender(false);}if(this._super){this._super(AD);}},destroy:function t(AD){var AC=this.suggestionPopup;if(AC&&AC.hasRendered){AC.destroy(false);}if(this._super){this._super(AD);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.ObjectInputBox,{onenabledChange:mstrmojo.Widget.enabledMarkupMethod});mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasEllipsis");var q="mstrmojo-ObjectItem-text";mstrmojo.ObjectItem=mstrmojo.declare(mstrmojo.Widget,[mstrmojo._HasEllipsis],{scriptClass:"mstrmojo.ObjectItem",markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode"><span title=" {@title}" class="'+q+' {@cssClass}"></span><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])"/></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" mstrAttach:keyup,keydown/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},editButtonNode:function(){return this.domNode.firstChild.childNodes[1];},delButonNode:function(){return this.domNode.firstChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},markupMethods:{oncssClassChange:function(){this.textNode.className=q+" "+this.cssClass;},onstateChange:function(){var AF=this.state,AE=mstrmojo.Enum_OIB_States_CSS[AF],AD=this.domNode;if(AF===Z.EMPTY){AD.innerHTML=this.enabled?'<div class="mstrmojo-ObjectItem-emptyText">'+this.text+"</div>":"";}else{if(AF===Z.EDITING){var AC=Math.round(this.displayNode.clientWidth);this.editNode.style.width=AC-4+"px";this.inputNode.style.width=AC-9+"px";}}AD.className="mstrmojo-ObjectItem "+AE;this.updateButtonsVisibility(this.data);},ontextChange:function(){this.inputNode.value=this.text;this.textNode.innerHTML=mstrmojo.string.encodeHtmlString(this.text);}},updateButtonsVisibility:function AB(){if(this.parent.hideEditButton(this.data)){this.editButtonNode.style.display="none";}},state:Z.VALID,onstateChange:function e(AC){this.data.state=this.state;},ontextChange:function H(AC){this.data[this.itemField]=this.text;},updateData:function F(AC){S.copy(AC,this.data);this.set("state",Z.VALID);this.set("text",this.data[this.itemField]);this.set("cssClass",this.parent.item2textCss(this.data));},init:function w(AD){this._super(AD);var AF=this.data,AC=AF.state,AE=this.parent;AC=this.initState();this.cssClass=AE.item2textCss(AF);this.text=AF[this.itemField];this.state=AC;this.isAdding=g(AF);this.useRichTooltip=true;this.title=this.text;},initState:function K(){var AD=this.parent,AE=this.data,AC=AE.state;if(AE&&AE.did){AE.state=Z.VALID;return AE.state;}if(typeof AC==="undefined"){AC=AD.dynamicVerify?AD.verifyObject(AE[this.itemField],this):Z.UNDETERMINED;AE.state=AC;}return AC;},isValid:function C(){var AC=parseInt(this.state,10);return(AC!==Z.INVALID&&AC!==Z.UNDETERMINED);},adjustInputWidth:function A(){if(this.isAdding){var AF=this.inputNode.style;AF.width=AA+"px";var AE=this.domNode.parentNode,AC=AE.parentNode.offsetWidth,AD=Math.max(AC-AE.offsetLeft-20,AA);if(!isNaN(AD)){AF.width=AD+"px";}}},blur:function T(){this.hideSuggestion();if(!this.isActive){return ;}this.isActive=false;var AE=this.inputNode,AC=AE.value,AD=this.parent;window.setTimeout(function(){try{AE.blur();}catch(AF){}},0);if(!AC){return ;}if(AD.acptSugItemOnly&&this._tWas_){this.set("text",AC);this.set("text","");this._tWas_=null;return ;}this.setItem(AC,null,true);},focus:function r(){var AD=this.inputNode,AC=this.isActive;window.setTimeout(function(){try{AD.focus();if(AD.createTextRange&&!AC){var AF=AD.createTextRange(),AE=AD.value.length;AF.move("character",AE);AF.select();}else{if(AD.setSelectionRange&&!AC){var AE=AD.value.length;AD.setSelectionRange(AE,AE);}}}catch(AG){}},0);this.isActive=true;},prekeydown:function J(AC){var AE=this.inputNode.value,AD=parseInt(AC.e.keyCode||AC.e.charCode,10),AG=this.parent;if(!AE){return ;}if(AD===x.TAB||AD===x.ENTER){if(AD===x.ENTER){Q.preventDefault(AC.hWin,AC.e);}var AF=AG.getSelected();if(AF&&AF.did){AG.handleSuggestionItemSelect(AF);}else{this.hideSuggestion();if(!AG.acptSugItemOnly){this.setItem(AE,null,false);}else{this.set("text",AE);this.set("text","");}}}else{if(AD===x.DOWN_ARROW){if(!AG.noCache&&!AG.suggestionShown){this.showSuggestion(AE);AG.preHighlight();}AG.nextHighlight();}else{if(AD===x.UP_ARROW){AG.preHighlight();}}}},prekeyup:function z(AC){var AE=this.inputNode.value,AD=parseInt(AC.e.keyCode||AC.e.charCode,10),AH=this.isAdding,AG=this.parent;if(!AE){if(AH){if(AD===x.BACKSPACE&&!this._tWas_){this.raiseEvent({name:"ItemDeletePrev"});Q.preventDefault(AC.hWin,AC.e);}this._tWas_=null;}else{this.raiseEvent({name:"ItemDelete",d:this.data});}this.hideSuggestion();return ;}if(AD===x.ESCAPE||AD===x.TAB){this.hideSuggestion();if(AG.acptSugItemOnly){this.set("text",AE);this.set("text","");this._tWas_=null;return ;}}else{if(this._tWas_!==AE){this.textChanged=true;this.raiseEvent({name:"ItemEditing",d:this.data});if(AG.useKeyDelay){window.clearTimeout(this._timerID);var AF=this;this._timerID=window.setTimeout(function(){var AI=AF.inputNode.value;if(AI){AF.showSuggestion(AI);}AF._timerID=null;},U);}else{this.showSuggestion(AE);}}}this._tWas_=AE;},setItem:function(AC,AE,AD){var AF=this.isAdding;AD=AD||false;this.set("text",AC);if(AF){this.setItem_Adding(AC,AE,AD);}else{this.setItem_Editing(AC,AE,AD);}this._tWas_=null;},setItem_Adding:function(AC,AE,AD){this.set("text","");if(!AE){AE={};AE[this.itemField]=AC;}else{AE.state=Z.VALID;}this.raiseEvent({name:"ItemAdd",d:AE,deactivate:AD});},setItem_Editing:function(AC,AE,AD){var AF=this.parent;this.set("text",AC);if(AE){this.updateData(AE);}else{if(this.textChanged){var AG={};AG[b]=this.data[b];delete this.data.did;this.data=AG;this.textChanged=false;}this.set("state",AF.verifyObject(AC,this));this.set("cssClass",AF.item2textCss(this.data));}this.isActive=false;this.raiseEvent({name:"ItemEditEnd",d:AE,deactivate:AD});},getSearchPattern:function W(){return this.inputNode.value;},showSuggestion:function n(AC){var AD=mstrmojo.dom.position(this.domNode,true);this.raiseEvent({name:"SuggestionOn",l:Math.round(AD.x)+"px",t:Math.round(AD.y+AD.h)+"px",pattern:AC,target:this});},hideSuggestion:function f(){this.raiseEvent({name:"SuggestionOff"});},del:function R(AC){AC=AC||self.event;Q.stopPropogation(self,AC);this.raiseEvent({name:"ItemDelete",d:this.data,deactivate:true});if(this.useRichTooltip&&this.hideTooltip){this.hideTooltip();}},edit:function X(){this.set("state",Z.EDITING);this.raiseEvent({name:"ItemEditBegin",d:this.data});if(this.showSuggestionOnEdit){this.showSuggestion(this.text);}},doEllipsize:function d(){if(!this.shouldEllipsize){return ;}var AD=this.maxItemWidth,AC;if(AD){this.domNode.style.maxWidth=AD;switch(parseInt(this.state,10)){case Z.VALID:case Z.UNDETERMINED:case Z.INVALID:AC=this.textNode;break;case Z.EMPTY:AC=this.domNode.firstChild;break;}if(AC){this.set("richTooltip",{content:this.text,contentNodeCssClass:"sp-tooltip",posType:mstrmojo.tooltip.POS_TOPLEFT,left:0,top:30,refNode:this.domNode});mstrmojo.css.addClass(AC,"truncated");}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.elementHelper","mstrmojo.SimpleObjectInputBox");var M=mstrmojo.array,G=mstrmojo.dom,B=mstrmojo.Enum_Keys,N=mstrConfig.thousandsSep;if(N===undefined){N=",";}var J=2147762227,T=2147762262,H=2147762269,K=140,I=-100,S=-101;var Q;mstrmojo.SearchBoxSelectorList=mstrmojo.declare(mstrmojo.SuggestionList,null,{getItemMarkup:function(X,W){if(!Q){Q=this._super(X,W).replace(">{@"+this.itemField+"}<",">{@"+this.itemField+"}{@weight}<");}return Q;},getItemProps:function V(Y,W){var X=this._super(Y,W),Z=Y.wt;X.weight=Z?"<em>("+mstrmojo.num.addSeparators(Z,N)+" "+this.parent.opener.wtStr+")</em>":"";return X;},onclick:function(X){var a=this.parent.opener.suggestionItems,W=a.length;this._super(X);if(W<=1){return ;}var Y=M.find(a,"t",I),Z=this.getItemFromTarget(X.getTarget());if(Z&&Z.t&&Z.t===I){M.forEach(a,function(b,c){if(!this.selectedIndices[c]){this.doItemSelect(b,{});}},this);}else{if(this.selectedIndices[Y]){this.doItemSelect(a[Y],{});}}}});mstrmojo.SearchBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{scriptClass:"mstrmojo.SearchBoxSelector",cssClass:"mstrmojo-SearchBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",wtStr:"likes",suggestionListClass:"mstrmojo.SearchBoxSelectorList",useRichTooltip:false,postCreate:function A(){var W=this.suggestionPopup;W.cssClass="mstrmojo-SearchBoxSelector-suggest";W.nudge=function(){var d=this.domNode;if(!d){return ;}var X=Math.min(d.offsetHeight,(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||K),Z=d.offsetWidth,c=G.windowDim(),b=parseInt(this.left,10),a=parseInt(this.top,10);if(a+X>=c.h){a=Math.max(a-X,0);}if(b+Z>=c.w){b=Math.max(b-Z,0);}var Y=d.style;Y.top=a+"px";Y.left=b+"px";};},preBuildRendering:function C(){var W=this.parent.contentNode.offsetWidth||this.parent.width;this.set("maxItemWidth",parseInt(W,10));this._super();},postBuildRendering:function R(){var W=this.parent.defn.fmts;if(!W.height){this.domNode.style.height="auto";}return this._super();},filterCandidates:function U(X,a,W){var b=X,Y=this.suggestCount;if(!this.noCache){W=W||Y;if(a==="*"){a="";}else{a=mstrmojo.string.regEscape(a);}var c=this.itemField,Z=new RegExp(a,"i");b=M.filter(X,function(d){return Z.test(d[c]);},{max:W});}if(b.length){M.forEach(this.items,function(e){var d=M.find(b,"v",e.v);if(d>-1){b.splice(d,1);}});}if(b.length>=Y){b=b.slice(0,Y);}return b;},getCandidatesThroughTaskCall:function F(m,p){var h=this.id,b=this.getSuggestionTarget(),f=m.pattern||"",e=f,c=this.parent,k=this.srcid;var d=f;f=d;if(d===""){return ;}if(k){var o={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:k,dataSourcesXML:this.dsrc||"",blockCount:this.REQUEST_THRESHOLD,searchPattern:f,rawInput:e,browseFlags:1},g=null;var Y=c.defn;if(Y.dsid){g={};g.datasetID=Y.dsid;g.messageID=c.model.mid;g.ctlKey=c.ckey;}if(Y.sfs){var l="",Z="";M.forEach(Y.sfs,function(q){l+=Z+q.did;Z=";";});o.searchForms=l;if(c.model.isnew){var n="",W="",a=c.model,j=M.filterOne(a.getDatasetUnits(["att"]),function(q){return q.did===k;}),X=j.fs||[];M.forEach(Y.sfs,function(q){var r=M.filterOne(X,function(t){return t.fid===q.did;});n+=W+q.did+":"+(r&&r.bftp)||0;W=";";});o.clientFormPatterns=n;}}p.success=function(u){var w=mstrmojo.all[h];if(u&&u.es){var x=w.getSuggestionTarget(),q=u.es.length;if(!u||!x||(b!==x)){return ;}var t=x.getSearchPattern(),r=u.es;if(k){r=mstrmojo.elementHelper.buildElemsTerseID(r,k,true);}var v=m.pattern;w._last_hit={items:r,pattern:v};if(t&&t.indexOf(v)>-1){w.updateSuggestion(w.filterCandidates(r,t));}}else{w.updateSuggestion([]);}};p.failure=function(r){var q=parseInt(r.code,10)+4294967296;if(q!==J&&q!==T&&q!==H){mstrmojo.alert(r.message);}};mstrmojo.elementHelper.browseElements(p,o,g);}},onsuggestionItemsChange:function E(){var b=this.suggestionItems,Y=this.suggestionPopup,X=Y.editorNode,Z=b&&(b.length>8),W="",a="";if(Z){W=(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||K;a="px";}if(X){X.style.maxHeight=W+a;}else{if(Z){a+=";";Y.cssText=(Y.cssText||"")+"max-height:"+W+a;}}},getSuggestionPos:function O(){var W=this._super();if(W){W.lockIW=this;}return W;},updateSuggestion:function P(X){var W=X&&X.length;this.autoSelect=true;this.set("disableClick",false);if(this.parent.defn.multi&&W&&W>1){X=M.filter(X,function(Y){return Y.v!=="u;"&&Y.t!==14;});X.unshift({n:mstrmojo.desc(13976,"(All search results)"),t:I});this.autoSelect=false;}if(!W){X=[{n:mstrmojo.desc(13779,"No elements match your search"),t:S,cls:"nomatch"}];this.autoSelect=false;this.set("disableClick",true);}this._super(X);},handleSuggestionItemSelect:function L(X,Y){if(M.isArray(X)||X.t===I){X=M.ensureArray(X);var W=M.filter(X,function(Z){return Z.t!==I;});if(W.length<X.length){W=M.filter(this.suggestionItems,function(Z){return Z.t!==I;});}this.onSuggestionItemSelect(W);}else{this._super(X,Y);}},prekeydown:function D(f){this._super(f);var b=f.e,g=(mstrApp&&mstrApp.MAX_SUGGESTION_POPUP_HEIGHT)||K,Z=8,X=g/Z;var Y=this.getSelected();if(Y){var a=Y._renderIdx,W=(a-Z+1)*X,d=(a-1)*X,c=this.suggestionPopup.domNode.scrollTop;switch(parseInt(b.keyCode||b.charCode,10)){case B.DOWN_ARROW:if(c<=W){this.suggestionPopup.domNode.scrollTop=W;}else{if(c>d){this.suggestionPopup.domNode.scrollTop=d;}}break;case B.UP_ARROW:if(c<=W||c>d){this.suggestionPopup.domNode.scrollTop=d;}break;}}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.string","mstrmojo.Enum_Keys","mstrmojo.SimpleObjectInputBox");var D=mstrmojo.array,B=mstrmojo.dom,E=mstrmojo.Enum_Keys,A=mstrConfig.thousandsSep;var H={DEFAULT:1,ADDING:2,EMPTY:3,FULL:4};if(A===undefined){A=",";}var I;mstrmojo.TextBoxSelector=mstrmojo.declare(mstrmojo.SimpleObjectInputBox,null,{cssClass:"mstrmojo-TextBoxSelector",srcid:null,dataSourcesXML:null,maxItemWidth:"",preBuildRendering:function G(){this.set("maxItemWidth",parseInt(this.parent.contentNode.style.width,10));this._super();},prekeydown:function C(J){var L=J.e;switch(parseInt(L.keyCode||L.charCode,10)){case E.TAB:case E.ENTER:B.preventDefault(J.hWin,L);var M=this.inputBox.value;if(M){if(D.find(this.items,"v",M)===-1){this.onSuggestionItemSelect({n:M,v:M});}else{this.setDefaultState();}}break;case E.ESCAPE:this.setDefaultState();break;case E.BACKSPACE:if(!this.getSearchPattern()){B.preventDefault(J.hWin,L);var K=this.items&&this.items.concat();if(K&&K.length){K.splice(K.length-1,1);this.set("items",K);var N=this.id;window.setTimeout(function(){mstrmojo.all[N].set("state",H.ADDING);},0);}}break;}},prekeyup:function F(J){}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.ME.TokenInputBox");mstrmojo.requiresDescs(13542,13543);var B=mstrmojo.array;var L={VALID:0,UNKNOWN:1,VALIDATING:2,ERROR:3,AMBIGUITY:4},G={0:"valid",1:"unknown",2:"validating",3:"error",4:"ambiguity"},H={0:mstrmojo.desc(9565,"Valid Metric Formula."),1:mstrmojo.desc(9106,"Require Validation?"),2:mstrmojo.desc(9566,"Validation in Progress..."),3:mstrmojo.desc(9567,"Validation Failed with Syntax Error!"),4:mstrmojo.desc(9568,"Validation Failed with Object Ambiguity!")};function D(O){if(!O){return L.VALID;}return{"-2147214845":L.ERROR,"-2147214846":L.AMBIGUITY}[O]||L.ERROR;}mstrmojo.ME.MetricEditBox=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.MetricEditBox",vStatus:L.VALID,iStatus:"",showStatus:true,browseItemVisible:true,absorbAmbiguity:true,isObjectVisible:function(O){return true;},markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-MEBox-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{editNode:function(){return this.domNode.firstChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;}},markupMethods:{onvStatusChange:function(){var P=this.vStatus,O=this.vStatusNode;O.className="mstrmojo-MEBox-vStatus "+G[P];O.innerHTML=(this.getStatusDesc&&this.getStatusDesc(P))||H[P]||"";},oniStatusChange:function(){this.iStatusNode.innerHTML=this.iStatus;this.iStatusNode.title=this.iStatus;}},children:[{scriptClass:"mstrmojo.ME.TokenInputBox",alias:"inputBox",slot:"editNode",renderOnScroll:false,renderBlockSize:0,bindings:{browseItemVisible:"this.parent.browseItemVisible",candidates:"this.parent.candidates"}}],init:function N(O){if(this._super){this._super(O);}this.statusCssClass=this.showStatus?"":"hidden";},getSearchPattern:function M(){return this.inputBox.getSearchPattern();},getHighlightedText:function I(P,O){return this.inputBox.getHighlightedText(P,O);},item2textCss:function F(O){return{4:"m",7:"am",11:"fx",12:"a",13:"fc",43:"tr",47:"cs"}[O.t]||"";},handleSuggestionItemSelect:function E(O){var P=this.abiguityDialog;if(O){P.onItemSelect(O);}P.close();},showDesc:true,showPath:true,abiguityDialog:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-ME-ambiguityDialog",onOpen:function(){this.set("title",mstrmojo.desc(13542,"Object Ambiguity - ##").replace("##",this.ambiguousName));this.list.clearSelect();this.list.set("items",this.items);this.list.singleSelect(0);this.label.set("text",mstrmojo.desc(13543,"More than one object with the name '##' were found.").replace("##",this.ambiguousName));},children:[{scriptClass:"mstrmojo.Label",alias:"label",text:""},{scriptClass:"mstrmojo.ui.ScrollableSuggestionList",alias:"list",cssClass:"mstrmojo-ME-ambiguityList",bindings:{items:"this.parent.opener.suggestionItems"},onclick:function(O){mstrmojo._IsList.onclick.call(this,O);}}],buttons:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton hot",text:mstrmojo.desc(547,"Select"),onclick:function(){var O=this.parent.parent;O.opener.handleSuggestionItemSelect(O.list.selectedItem);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.close();}}]},defaultOnTokensModify:function(){this.set("vStatus",L.UNKNOWN);this.set("iStatus","");},postBuildRendering:function A(){this._super();this.inputBox.attachEventListener("tokensModify",this.id,"defaultOnTokensModify");this.inputBox.attachEventListener("tokensModify",this.id,"ontokensModify");},updateInputBoxItems:function K(O){this.inputBox.set("items",O.items);},replaceErrorToken:function C(O){this.inputBox.replaceErrorToken(O);},handleValidation:function J(O){if(!O){this.set("vStatus",L.ERROR);return ;}O.vs=D(O.rjec);this.set("vStatus",O.vs);this.set("iStatus",O.rjed||"");this.updateInputBoxItems(O);this.inputBox.focus();if(O.vs===L.AMBIGUITY){var W=this,T=O.items,S=B.find(T,"sta",-1),P=T[S].v,U=function(X){W.replaceErrorToken(X);W.set("iStatus","");W.set("vStatus",L.UNKNOWN);if(W.continueValidataion){W.continueValidataion();}};var Q=B.filter(O.srfd.items,this.isObjectVisible);var V=this.parent.candidates,R=V&&V.items;if(R){B.forEach(Q,function(Y){var X=B.find(R,"did",Y.did);if(X===-1){if(this.absorbAmbiguity){R.push(Y);}}else{Y.path=R[X].path;}});}if(Q.length===1){U(Q[0]);return ;}this.openPopup("abiguityDialog",{zIndex:100,items:Q,ambiguousName:P,onItemSelect:U});}else{if(this.postHandleValidation){this.postHandleValidation();}}}});mstrmojo.ME.MetricEditBox.VALIDATION_STATUS=L;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.hash","mstrmojo.ui.PopupButton","mstrmojo.ui.PulldownCheckList");var G=mstrmojo.css,D=mstrmojo.hash,E={0:true};function B(){var O=this.selectedIndices=D.copy(this.getPopupList().selectedIndices),K=this.items,N=[],M=this.allIdx,L=this.noneIdx;if(K){if(O[M]){N.push(K[M].n);}else{if(O[L]){N.push(K[L].n);}else{mstrmojo.array.forEach(K,function(Q,P){if(O[P]){N.push(Q.n);}});}}}this.set("value",N.join(", "));}mstrmojo.ui.MultiSelectPulldown=mstrmojo.declare(mstrmojo.ui.PopupButton,[mstrmojo.ui._IsPulldown],{scriptClass:"mstrmojo.ui.MultiSelectPulldown",isHostedWithin:false,popupWidget:undefined,init:function J(K){this._super(K);G.addWidgetCssClass(this,"multi");this.hostedCSSClass=this.hostedCSSClass+" multi";},submitSelections:function A(){B.call(this);this.onchange();},_set_selectedIndices:function F(M,K){var L=this.selectedIndices=D.copy(K||this.selectedIndices||E);this.getPopupList().set("selectedIndices",L);B.call(this);return true;},select:function H(K){this.getPopupList().select(K);},getPopupWidget:function C(){return this.popupWidget;},getPopupList:function I(){return this.popupWidget.list;},children:[{scriptClass:"mstrmojo.ui.PulldownCheckList",alias:"popupWidget"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo._IsPopup","mstrmojo._CanAutoClose","mstrmojo.hash","mstrmojo.css");var A=mstrmojo.hash.copy;mstrmojo.ui.editors.controls.AdvancedColorPickerPopup=mstrmojo.declare(mstrmojo.ui.editors.controls.AdvancedColorPicker,[mstrmojo._IsPopup,mstrmojo._CanAutoClose],{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",locksHover:true,init:function E(F){this._super(F);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-AdvColorPickerPopup");},showPickerForCurrentMode:function D(){this._super();var G=this,F=function F(){if(G.visible){G.adjustCornersForPopupOverflow();}};if(this.pickerMode===2){this.colorStyle.markupMethods=A({onselectedIndexChange:F},A(this.colorStyle.markupMethods));}F();},onOpen:function C(){var F=this.parent;this.set("color",F?F.selectedValue:this.color);this.renderContent();this._super();},colorCanceled:function B(){this.close();}});}());(function(){mstrmojo.requiresClsP("mstrmojo","Editor","HBox","HTMLButton","Label","SortRow","ButtonSwitch","CheckBox","_HasOwnAvatar");mstrmojo.requiresCls("mstrmojo.ui._HasScroller","mstrmojo.mstr.EnumDSSXMLObjectTypes");mstrmojo.requiresDescs(11591,3095,11592,2968,122,221,1442,13153);var I=mstrmojo.desc,Q=mstrmojo.array,E=mstrmojo.dom,a=mstrmojo.css,K=0,c="top",R="bottom",b;mstrmojo.AdvancedSortData=null;function A(f,e){var g=new mstrmojo.SortRow(),d=mstrmojo.all[b];g.setPulldownOptions(e===K?d.sortData.rows:d.sortData.cols);g.setRank(f.children.length+1);f.addChildren([g]);}function O(n,e,k){var g,f,l,d=n.children,h=mstrmojo.all[b],m=function(){var u,t,r,q,v,p=(k===K?h.sortData.rows:h.sortData.cols),o=[];for(u=0,t=e.length;u<t;u++){v=e[u];for(r=0,q=p.length;r<q;r++){if(v.value===p[r].v){o.push(v);break;}}}return o;};if(!h.isDesignMode){e=m();}for(g=0,f=0;g<d.length&&f<e.length;g++,f++){l=e[f];d[g].setSelected(l.value,l.isAsc,l.n);}for(;g<d.length;g++){d[g].setSelected("",1);}for(;f<e.length;f++){l=e[f];A(n,k);d[f].setSelected(l.value,l.isAsc,l.n);}}function J(){var d=this.children;if(d[d.length-1].getSortKey()===""){return ;}A(this,this.type);}function F(){var d,e=this.children;for(d=0;d<e.length;d++){var f=e[d];if(f.getRank()!==d+1){f.setRank(d+1);}}}function N(){var g,f,e,k=[],l=mstrmojo.all[b],n=["appliedRows","appliedCols"],d=[];d.push(l.tabContainer.children[0].children);d.push(l.tabContainer.children[1].children);for(f=0;f<2;f++){var p=[];for(g=0;g<d[f].length;g++){e=d[f][g].getSortKey();if(e&&e!==" "){p.push({key:e,isAsc:d[f][g].isAscending()});}}if(p.length===0){if(l.sortData[n[f]].length===0){p=null;}}k.push(p);}var o=l.sortData.hierarchicalSort,m=l.hrlSortBox.checked?o.stt:null,h=l.resHrlBox.checked?"1":"0";l.controller.onAdvancedSort(l.xtab,k,null,m,h);}mstrmojo.AdvancedSortEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.AdvancedSortEditor",help:"advanced_sort_editor.htm",cssClass:"mstrmojo-AdvancedSortEditor",title:I(11591,"Advanced Sort"),tabSwitcher:undefined,tabContainer:undefined,hrlSortBox:undefined,sortData:undefined,sourceAxis:1,init:function W(d){this._super(d);b=this.id;},onOpen:function H(){var d=this.sortData,f,g=["appliedRows","appliedCols"],e=this.sourceAxis-1;Q.forEach(this.tabContainer.children,function(h,j){f=d[g[j]];Q.forEach(h.children,function(k){k.setPulldownOptions(d[j===K?"rows":"cols"]);});O(h,f,j);J.call(h);F.call(h);});if(this.sourceType===mstrmojo.mstr.EnumDSSXMLObjectTypes.Metric){e^=1;}this.tabSwitcher.set("selected",e);this.tabContainer.updateScrollbars();this.updateUseHierarchicalSort(e);},onClose:function(){Q.forEach(this.tabContainer.children,function(d){Q.forEach(d.children,function(e){e.resetPulldownOptions();});});},onTabChange:function(e){var d=this.tabContainer;d.children[e].set("visible",true);d.children[1-e].set("visible",false);d.set("selected",e);d.updateScrollbars();this.updateUseHierarchicalSort(e);},updateUseHierarchicalSort:function S(j){var h=(j===K)?"rows":"cols",o=(j===K)?"appliedRows":"appliedCols",e=this.sortData,m=e.hierarchicalSort,k=m.pref,p=m.rp,g=m.isOutlineMode,l=m.isRA,n=e[o],f=this.hrlSortBox,d=this.resHrlBox;f.set("visible",k==="1");f.set("checked",g||(k==="1"&&(n.length===0||l)));d.set("visible",false);d.set("checked",p);},updateTooltipConfig:function X(){if(E.isIE8){this.richTooltip.cssClass+=" ie8";X.repaint=!!!X.repaint;this.richTooltip.cssClass+=(X.repaint?" repaint":"");}},postBuildRendering:function Y(){this._super();this.tabContainer.domNode.onselectstart=function(){return false;};},children:[{scriptClass:"mstrmojo.ButtonSwitch",alias:"tabSwitcher",label1:I(2968,"Rows"),label2:I(122,"Columns"),switchFn:function V(){this.parent.onTabChange(this.selected);}},{scriptClass:"mstrmojo.Widget",markupString:"<div class='rulesTitles'><div>"+I(3095,"Order")+"</div><div>"+I(11592,"Sort by")+"</div></div>"},{scriptClass:"mstrmojo.SortRulesPanelContainer",alias:"tabContainer",cssClass:"mstrmojo-AdvancedSortEditor-RulesPanelContainer"},{scriptClass:"mstrmojo.CheckBox",alias:"hrlSortBox",cssClass:"hrlSortBox",oncheckedChange:function(){if(E.isIE8){a[this.checked?"addClass":"removeClass"](this.labelNode,"checked");}},postBuildRendering:function Y(){if(E.isIE8){var e=this,d=this.labelNode;E.attachEvent(d,"click",function(){e.set("checked",!e.checked);});}},label:I(13153,"Sort metrics hierarchically")},{scriptClass:"mstrmojo.CheckBox",alias:"resHrlBox",cssClass:"resHrlBox",oncheckedChange:function(){if(E.isIE8){a[this.checked?"addClass":"removeClass"](this.labelNode,"checked");}},postBuildRendering:function Y(){if(E.isIE8){var e=this,d=this.labelNode;E.attachEvent(d,"click",function(){e.set("checked",!e.checked);});}},label:I(12420,"Respect Hierarchy")},{scriptClass:"mstrmojo.Button",slot:"buttonNode",cssClass:"mstrmojo-WebButton Advanced-Sort-Editor-Button",text:I(221,"Cancel"),onclick:function(){mstrmojo.all[b].close();}},{scriptClass:"mstrmojo.Button",slot:"buttonNode",cssClass:"mstrmojo-WebButton Advanced-Sort-Editor-Button",iconClass:"hot",text:I(1442,"OK"),onclick:function(){N();mstrmojo.all[b].close();}}]});function U(f,e){var d=Math.floor((f-e.y0-E.getVerticalScroll())/e.h);if(d<0){d=0;}else{if(d>=this.children.length){d=this.children.length-1;}}return d;}function B(h,f){var e=c,g=(Math.floor(h-f.y0)%f.h)/f.h,d=U.call(this,h,f);if(d===this.children.length-1){if(g>0.5||Math.floor((h-f.y0)/f.h)>d){e=R;}}else{if(g>0.5){if(d<this.children.length-1){d+=1;}}}return{edge:e,idx:d};}mstrmojo.SortRulesPanelContainer=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.SortRulesPanelContainer",selected:undefined,setupScrollNodes:function M(){var d=this.children[this.selected||0];this.scrollNode=d.domNode;if(!d.hasEventListener){a.addClass(this.scrollNode,"mstrmojo-scrollNode");E.attachMarkupEvent(this.id,this.scrollNode,"scroll");d.set("hasEventListener",true);}},onscroll:function Z(){if(this._super){this._super();}var d;Q.forEach(this.children,function(e){if(!d){Q.forEach(e.children,function(h){if(!d){var g=h.sortRule.list,f=h.sortOrder.list;if(g.visible){d=g;}else{if(f.visible){d=f;}}}});}});if(d){d.set("visible",false);}},children:[{scriptClass:"mstrmojo.SortRulesPanel",cssClass:"mstrmojo-AdvancedSortEditor-RulesPanel",type:0},{scriptClass:"mstrmojo.SortRulesPanel",cssClass:"mstrmojo-AdvancedSortEditor-RulesPanel",type:1}]});mstrmojo.SortRulesPanel=mstrmojo.declare(mstrmojo.Box,[mstrmojo._HasOwnAvatar],{scriptClass:"mstrmojo.SortRulesPanel",dropZone:true,draggable:true,avatarCssClass:"sort-rule-drag-avatar",type:undefined,hasEventListener:undefined,getDragData:function D(){return{};},createAvatar:function T(g,f){var h=f.src.data;h.y0=E.position(this.domNode).y;h.h=E.position(this.children[0].domNode).h;h.left=E.position(this.children[0].domNode).x;var e=U.call(this,f.src.pos.y,h),d=this.children[e].domNode.cloneNode(true);h.index=e;h.node=this.children[e];return d;},positionAvatar:function L(e,d){e.x=d.src.data.left+10;this._super(e,d);},isDragValid:function C(d){if(this.children.length===1){return false;}var e=this.domNode,g=this.children[Math.floor((d.src.pos.y-E.position(e).y-E.getVerticalScroll())/E.position(this.children[0].domNode).h)],f=d.src.e.target;return !(E.contains(g.sortRule.domNode,f,true,e)||E.contains(g.sortOrder.domNode,f,true,e));},ondragstart:function(d){this._super(d);var e=d.src.data;this.removeChildren(this.children[e.index]);e.y0=E.position(this.domNode).y;},ondragmove:function P(d){var k=d.src.data,l=d.last.y,j=k.tgtIdx,g=k.tgtEdge,h=B.call(this,l,k),f=h.idx,e=h.edge;if(j!==f||g!==e){if(j!==undefined){a.removeClass(this.children[j].domNode,g);}a.addClass(this.children[f].domNode,e);k.tgtIdx=f;k.tgtEdge=e;}this._super(d);},ondragend:function G(e){var f=e.src.data,d=f.tgtIdx;if(d!==undefined){a.removeClass(this.children[d].domNode,f.tgtEdge);}if(f.tgtEdge===R){d++;}this.addChildren([f.node],d);this.updatePanel();this._super(e);},pulldownActive:function(d){mstrmojo.css.toggleClass(mstrmojo.all[b].tabContainer.domNode,"disableScroller",d);},updatePanel:function(){F.call(this);J.call(this);mstrmojo.all[b].tabContainer.updateScrollbars();},deleteSortRule:function(d){this.removeChildren(d);this.updatePanel();},itemSelected:function(){this.updatePanel();},children:[{scriptClass:"mstrmojo.SortRow"},{scriptClass:"mstrmojo.SortRow"},{scriptClass:"mstrmojo.SortRow"}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.array","mstrmojo.Button","mstrmojo.css","mstrmojo.hash","mstrmojo.Label","mstrmojo.Box","mstrmojo.ui.Pulldown","mstrmojo.ui.SearchablePulldown","mstrmojo.func");mstrmojo.requiresDescs(221,1442,2751,2891,11949,11950,11951,11942,13397,13398,14640,14648);var R=mstrmojo.array,U=mstrmojo.css,N=mstrmojo.hash,O=mstrmojo.func,M=mstrmojo.Button.newWebButton,P=mstrmojo.dom,T="mstrmojo-link-validation",Q="mstrmojo-link-vt",F=function F(V){if(V.old){this.removedLinks.push(V);}this.links.removeChildren(V);},S=function S(){var t=this.dsMap,p=this.docModel,Y=p.datasets,v=function v(j,w,a){var k={n:a||"",did:w||null,parent:j||null,lv:(j?j.lv+1:-1),children:[]};if(j){j.children.push(k);}return k;},e=v(),X,W,V,g,Z,q,l,u,r,o,n,m,c,b,d,h,f;N.forEach(Y,function(a){if(p.isMDXDataset(a)){Z=a.tables;for(o=0,b=Z.length;o<b;o++){q=Z[o];X=v(e,q.did,q.n);X.isMDX=true;for(n=0,d=q.dimensions.length;n<d;n++){l=q.dimensions[n];W=v(X,l.did,l.n);for(m=0,h=l.hierarchies.length;m<h;m++){u=l.hierarchies[m];V=v(W,u.did,u.n);for(c=0,f=u.att.length;c<f;c++){r=u.att[c];g=v(V,r.did,r.n);g.att=r;t[q.did+":"+r.did]=g;}}}}}else{X=v(e,a.did,a.name);X.isMDX=false;R.forEach(a.att,function(j){g=v(X,j.did,j.n);g.att=j;t[a.did+":"+j.did]=g;});}});return e;},B=function B(b,c){b=R.ensureArray(b);var a=this,Z=this.attribute.did,d=this.docModel,X=d.findDatasetIdFromUnit(Z),W="\u001F",V={success:function(f){var h=f.als,e=(d.als&&d.als.links)||{},g=a.dsTree;R.forEach(b,function(q,l){var r={},j={},k=[],m={},p=Z+" "+q,n=R.filter(h[l].ats,function(t){return !d.isInDataset(X,t.at,["att"]);}),o=function o(t,u){if(!m[t]){m[t]={};}if(!m[t][u]){m[t][u]=true;}};R.forEach(n,function(v){var t=v.at,u=v.fms;r[t]=true;if(u){R.forEach(u,function(w){o(t,w.fm);});}});N.keyarray(e).forEach(function(t){if(t===p){R.forEach(e[t],function(u){u=u.split(" ");r[u[0]]=true;o(u[0],u[1]);});}});if(N.keyarray(r).length>0){R.forEach(g.children,function(u){var t=function(v){var w;if(!v.att){return ;}v=v.att;if(r[v.did]){if(!j[v.n]){j[v.n]={};}if(!j[v.n][v.did]){j[v.n][v.did]=[];}j[v.n][v.did].push(u.n);w=N.copy(v,w);w.dsId=u.did;k.push(w);}};if(u.isMDX){R.forEach(u.children,function(v){R.forEach(v.children,function(w){R.forEach(w.children,t);});});}else{R.forEach(u.children,t);}});}a.tgtAttrs[q]=k;a.tgtForms[q]=m;a.namesHash[q]=j;});}},Y={taskId:"validateDocumentLinks",msgID:d.mid,action:1,attributeList:Z,attributeFormList:b.join(W)};mstrApp.serverRequest(Y,O.wrapMethods(V,c));},E=function(Y,a,W,Z){Y.richTooltip=null;if(!Y.isSearching){var X=a&&a.scrollWidth>a.clientWidth;W=X?mstrmojo.desc(14648,"## from ###").replace("##",W):"";if(Z){if(!X){W=mstrmojo.desc(14640,"From ###");}W=W.replace("###",Z);}var V=mstrmojo.dom.position(a);Y.richTooltip={cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,content:W,top:V.y-6,left:V.x};}},D=function D(c){var d=this,f=function(n){var l=n.fs,o=n.de,m=[];(l||[]).forEach(function(p){if(p.obf&&(!o||p.idf)){m.push({n:p.fnm,v:p.fid,idf:p.idf});}});return m;},g=f(this.attribute),Z=function(o,m){var l=f(o);var p=(d.tgtForms[m]&&d.tgtForms[m][o.did])||{};var n=[];R.forEach(l,function(q){if(p[q.v]){n.push(q);}});return n;},b=function b(m){var l=[];R.forEach(d.tgtAttrs[m],function(n){if(Z(n,m||d.idFormId).length>0){var p=d.namesHash[m],o=n.n;if(p[n.n]&&N.keyarray(p[n.n]).length>1){o=o+" ("+p[n.n][n.did].join(",")+")";}l.push({n:n.n,v:n,tt:o});}});if(l.length===0){l.push({n:mstrmojo.desc(13398,"No valid object"),v:{did:null},cls:"nvo",t:1});}return l;},h=b((c&&c.srcFormId)||this.idFormId),j=function(l,m){return R.find(l.fs,m?"fid":"idf",m||true);},k=function(m){var l=-1;h.forEach(function(o,n){if(o.v.did===m){l=n;}});return l;},W=function(m){var l=h[m];if(!l){return mstrmojo.desc(13397,"Select an attribute");}else{return l.n;}},X=function(m){var n=m.items,l=m.selectedIndex;if(l>=0){if(n[l].idf){return ;}}n.forEach(function(p,o){if(p.idf){m.set("selectedIndex",o);}});};this.links.addChildren({scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linkRow",slot:"containerNode",old:!!c,oldMeta:c,getMeta:function(){var l=this.linkFromForm,n=this.linkToAtt,m=this.linkToForm;return{srcAttrId:d.attribute.did,srcFormId:l.items[l.selectedIndex].v,tgtAttrId:n.items[n.selectedIndex]&&n.items[n.selectedIndex].v.did,tgtFormId:m.items[m.selectedIndex]&&m.items[m.selectedIndex].v};},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-attName",text:d.attribute.n,useRichTooltip:true,updateTooltipConfig:function(p){var o=p.target,l=this.text,m=d.datasetId,n=m?d.docModel.datasets[m].name:"";E(this,o,l,n);}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormFromPD",alias:"linkFromForm",value:"ID",isHostedWithin:true,items:g,selectedIndex:j(d.attribute,c&&c.srcFormId),onitemSelected:function(m){var l=this,n=function(){var p=l.parent.linkToAtt;h=b(m.v);p.set("items",h);p.set("selectedIndex",-1);p.set("text",mstrmojo.desc(13397,"Select an attribute"));U.addClass(p.selectedNode,"nvo");},o={success:n};if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!m.idf){X(this.parent.linkToForm);if(!d.tgtForms[m.v]){B.call(d,m.v,o);return ;}}n();}}},{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-linksToLabel",text:mstrmojo.desc(11949,"links to")},{scriptClass:"mstrmojo.ui.SearchablePulldown",cssClass:"mstrmojo-linkToAtt",alias:"linkToAtt",useRichTooltip:true,isHostedWithin:false,items:h,text:W(k(c&&c.tgtAttrId)),selectedIndex:k(c&&c.tgtAttrId),allowCustomText:true,allowEmptyText:true,updateTooltipConfig:function(q){var p=q.target,l=p.getAttribute("tt"),n=this.getSelectedItem(),m=n?n.v.dsId:null,o=m?d.docModel.datasets[m].name:"";if(this.selectedNode===p&&n){l=n.tt;}E(this,p,l,o);},onitemSelected:function(p){if(!p||p.v.did===null){return ;}var o=this.parent.linkToForm,n=this.parent.linkFromForm,m=Z(p.v,n.items[n.selectedIndex].v),q=function q(r,u){var t=R.find(r,u?"v":"idf",u||true);if(t===-1&&r.length>0){t=0;}return t;},l;R.forEach(m,function(r){if(r.idf){l=false;return false;}});if(l){K.call(d,true);}o.set("items",m);o.set("selectedIndex",q(m,!this.hasRendered&&c&&c.tgtFormId));if(this.hasRendered&&this.parent.old){this.parent.oldUpdated=true;}J.call(d);},onPopupWidgetOpened:function a(){if(this.selectedIndex===-1){this.set("text","");}U.removeClass(this.selectedNode,"nvo");},onPopupWidgetClosed:function e(){mstrmojo.ui.SearchablePulldown.prototype.onPopupWidgetClosed.call(this);if(this.selectedIndex===-1&&this.text===""){this.set("text",mstrmojo.desc(13397,"Select an attribute"));U.addClass(this.selectedNode,"nvo");}else{U.removeClass(this.selectedNode,"nvo");}this.hideTooltip();R.forEach(d.collapseTargets,function(l){l.className="arrow-b";U.removeClass(l.parentNode.parentNode,"collapse");});R.forEach(d.collapseTreeNodes,function(l){delete l.collapse;});R.forEach(this.list.itemsContainerNode.childNodes,function(l){l.style.display="";});},postBuildRendering:function V(){mstrmojo.ui.SearchablePulldown.prototype.postBuildRendering.call(this);if(this.selectedIndex===-1){U.addClass(this.selectedNode,"nvo");}this.list.popupConfig.clear();},getPopupListConfig:function Y(){return{scriptClass:"mstrmojo.ui.PopupList",alias:"list",width:"170px",tooltipOrientation:"vertical",selectionPolicy:"reselect",useRichTooltip:true,locksHover:true,listHooks:{select:function l(r,t,q){this.parent.set("selectedIndex",q);this.close();}},onclick:function m(AA){try{var r=AA.getTarget(),AB=this.getItemFromTarget(r),w=P.findAncestorByAttr(r,"idx",true,this.domNode);if(AB){AA.cancel();if(r.className==="arrow-b"||r.className==="arrow-r"){var v=this.items,q=this.itemsContainerNode.childNodes,u=function u(AD){var AC;while(AD){AC=AD.className||"";if(AC.indexOf("lv")===0){return window.parseInt(AC.substring(2),10);}AD=AD.firstChild;}return null;},z=function z(AC,AF){var AE=d.dsMap,AD=AE[AC.dsId+":"+AC.did];while(AD){if(AD.lv===AF){return AD;}AD=AD.parent;}return null;},x=function x(){var AL=(r.className==="arrow-b"),AF=r.parentNode.parentNode,AC=u(AF),AG=AB._renderIdx,AD=z(AB.v,AC),AJ=v.length,AI,AE,AH,AK,AN,AM;r.className=AL?"arrow-r":"arrow-b";if(!d.collapseTargets){d.collapseTargets=[];}d.collapseTargets.push(r);U.toggleClass(AF,"collapse",AL);AD.collapse=AL;if(!d.collapseTreeNodes){d.collapseTreeNodes=[];}d.collapseTreeNodes.push(AD);for(AI=AG+1;AI<AJ;AI++){AE=q[AI];AH=u(AE);if(AH<=AC){break;}AK=z(v[AI].v,AH);AN=AK.parent;AM=true;while(AN){if(AN.collapse){AM=false;break;}AN=AN.parent;}AE.style.display=(AM?"":"none");}};x();}else{if(w&&w.node.className.indexOf("item")!==-1){this.doItemSelect(AB,AA||{});}}}}catch(t){mstrApp.onerror(t);}},getItemProps:function n(t,q){var r=mstrmojo._IsList.getItemProps.call(this,t,q);var u=t.cls;if(u){r.addCls(u);}return r;},getItemMarkup:function p(AC,AB){if(AC.v.did===null){return'<{@tag} class="item {@cls}" did="'+AC.v.did+'" idx="{@idx}" style="{@style}">{@n}</{@tag}>';}var AD=[],z=AC.v.did,t=AC.v.dsId,u=t?d.docModel.datasets[t]:null,r=u?u.name:"",AA=AB>0&&this.items[AB-1].v,w=d.dsMap,v=w[AC.v.dsId+":"+z],q=w[(AA&&(AA.dsId+":"+AA.did))];AD.push("</div>");while(v){if(v.lv===-1){break;}if(v.att){var x=v.att.da?"derived-attr":"attr";AD.push('<div class="lv'+v.lv+' dim item {@cls}" tt="'+AC.tt+'" did="'+z+'" dsName="'+r+'" idx="{@idx}" style="{@style}"><div><div class="'+x+'"></div></div>{@n}</div>');}else{if(v!==q){AD.push('<div class="lv'+v.lv+' dim" dtt="'+v.n+'" idx="{@idx}"><div><div class="arrow-b"></div></div>'+v.n+"</div>");}else{break;}}v=v.parent;q=(q&&q.parent)||null;}AD.push("<div>");return AD.reverse().join("");},updateTooltipConfig:function o(w){var v=w.target,t=v.getAttribute("tt"),r=v.getAttribute("dtt"),u=v.getAttribute("dsName"),q=t||r;if(q){E(this,v,q,u);}}};}},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"mstrmojo-linkFormToPD",alias:"linkToForm",value:"ID",isHostedWithin:true,items:[],onitemSelected:function(l){if(this.hasRendered){if(this.parent.old){this.parent.oldUpdated=true;}if(!l.idf){X(this.parent.linkFromForm);}}}},M("",function(){F.call(d,this.parent);},false,{cssClass:"mstrmojo-removeLink"})]});this.links.renderChildren();},K=function(V){U.toggleClass(this.editorNode,"mstrmojo-advanced",V);},L=function(Y){var W=this,Z=T,V;try{mstrmojo.all[Z].destroy();}catch(X){}V={scriptClass:"mstrmojo.Editor",id:Z,title:mstrmojo.desc(2751,"Message"),cssClass:"mstrmojo-alert",buttons:[M(mstrmojo.desc(1442,"Ok"),function(){mstrmojo.all[Z].destroy();H.call(W);},true)],children:[{scriptClass:"mstrmojo.Label",text:Y}],visible:true,zIndex:1000};mstrmojo.insert(V).render();},H=function(){var X=this,W=this.illLinks,V=this.links.children,Y=Q;R.forEach(W,function(Z){Z=Z.al;R.forEach(V||[],function(b){var d=b.getMeta(),e=b.linkToAtt,a,c;if(d.srcAttrId===Z.alaid1&&d.tgtAttrId===Z.alaid2){if(!mstrmojo.all[Y]){c=new mstrmojo.Tooltip({id:Y,cssClass:X.themeClassName+" vi-warning vi-tooltip-V",contentNodeCssClass:"regular-unitlist-tooltips",posType:mstrmojo.tooltip.POS_BOTTOMLEFT,updatePopupConfig:null});P.attachEvent(X.editorNode,"click",function(){c.close();U.toggleClass(e.selectedNode,"mstrmojo-Warning",false);});}else{c=mstrmojo.all[Y];}c.close();a=mstrmojo.dom.position(e.selectedNode);c.set("top",a.y-6);c.set("left",a.x);c.set("content",Z.alstmsg);U.toggleClass(e.selectedNode,"mstrmojo-Warning",true);c.open();return false;}});});},A=function(){var V=mstrmojo.all[Q];if(V){V.close();}},J=function J(){this.buttons[0].enabled=true;if(this.btnHbox){this.btnHbox.children[0].set("enabled",true);}},G=function G(){var V=this,W=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-toolBox",alias:"tools",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-addLink",text:mstrmojo.desc(11950,"Add A Link"),title:mstrmojo.desc(11950,"Add A Link"),onclick:function(){D.call(V);A.call(V);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-showForms",text:mstrmojo.desc(2891,"Show Attribute Forms"),title:mstrmojo.desc(2891,"Show Attribute Forms"),onclick:function(){K.call(V,true);A.call(V);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebHoverButton mstrmojo-hideForms",text:mstrmojo.desc(11951,"Hide Attribute Forms"),title:mstrmojo.desc(11951,"Hide Attribute Forms"),onclick:function(){K.call(V,false);A.call(V);}}],slot:"containerNode"},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-linksBox mstrmojo-advanced",alias:"links",slot:"containerNode"}];this.addChildren(W);};mstrmojo.vi.ui.editors.AttributeLinkEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",title:mstrmojo.desc(11942,"Link Attributes"),cssClass:"mstrmojo-att-link",btnAlignment:"right",buttons:null,modal:true,visible:false,help:"link_attributes_editor.htm",attribute:null,tgtAttrs:null,tgtForms:null,docModel:null,datasetId:null,namesHash:null,removedLinks:null,preBuildRendering:function C(){var Y=this,W=this.docModel,X=function(){var Z=(W.als&&W.als.links)||{},a=[];N.keyarray(Z).forEach(function(b){if(b.indexOf(Y.attribute.did+" ")===0){Z[b].forEach(function(c){a.push({srcAttrId:b.split(" ")[0],srcFormId:b.split(" ")[1],tgtAttrId:c.split(" ")[0],tgtFormId:c.split(" ")[1]});});}});return a;},V;this.set("buttons",[M(mstrmojo.desc(1442,"OK"),function(){var g=[],a=Y.links.children,Z=function(){var h=W.controller,j=W.controller.getRefreshCallback();if(g.length>0){h.cmdMgr.execute({execute:function(){this.submit(g,j);},urInfo:{callback:j}});}Y.close();},f=false,c,d;Y.removedLinks.forEach(function(h){c=N.copy(h.oldMeta,{act:"applyAttributeLinking",unlink:true});g.push(c);});(a||[]).forEach(function(h){if(h.old&&h.oldUpdated){c=N.copy(h.oldMeta,{act:"applyAttributeLinking",unlink:true});g.push(c);}if(!h.old||(h.old&&h.oldUpdated)){d=h.getMeta();if(!d.tgtAttrId){return ;}c=N.copy(d,{act:"applyAttributeLinking",unlink:false});g.push(c);}});R.forEach(g,function(h){if(!h.unlink){f=true;return false;}});if(!f){Z();return ;}var e={taskId:"validateDocumentLinks",msgID:W.mid,action:2,manipulationList:'{"ml":'+JSON.stringify(g)+"}"},b={success:function(h){if(h.als&&h.als.length>0){var j="";R.forEach(h.als,function(k){j+=k.al.alstmsg+"\n";});Y.illLinks=h.als;L.call(Y,j);return ;}Z();}};mstrApp.serverRequest(e,b);},true,{enabled:false}),M(mstrmojo.desc(221,"Cancel"),function(){Y.close();})]);G.call(this);V=X(this.attribute.did);if(V.length>0){V.forEach(function(Z){D.call(Y,Z);});J.call(this);}else{D.call(this);}this._super();},close:function I(){A.call(this);this.destroy();}});mstrmojo.vi.ui.editors.AttributeLinkEditor.open=function(b){var W=mstrmojo.insert(N.copy(b,{scriptClass:"mstrmojo.vi.ui.editors.AttributeLinkEditor",tgtAttrs:{},tgtForms:{},namesHash:{},removedLinks:[]})),Z=W.attribute,c=Z.did,V=W.docModel,Y=(V.als&&V.als.links)||{},X=[],a={success:function(){W.set("visible",true);W.render();}};R.forEach(Z.fs,function(d){if(d.idf){W.idFormId=d.fid;return false;}});N.keyarray(Y).forEach(function(e){var d=e.split(" ");if(d[0]===c){X.push(d[1]);}});if(R.indexOf(X,W.idFormId)===-1){X.push(W.idFormId);}W.dsMap={};W.dsTree=S.call(W);B.call(W,X,a);};}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.vi._MonitorsAppState","mstrmojo.vi.ui.tabs.Tab","mstrmojo.dom","mstrmojo.css");var G=mstrmojo.dom,R=mstrmojo.array,d=mstrmojo.css,c="animate",W="31px";function X(){var j=window.Modernizr,h="transition";if(j.testProp(h)){return G.transEndEvtNames[j.prefixed(h)];}return null;}function D(h){return function(){this.menuNode.style.display=h?"block":"none";};}function I(h){return Math.min(h.offsetWidth-h.firstChild.offsetWidth,0);}function S(h){return h.isAlignRight?"right":"left";}function e(h,j){return parseInt(h.style[S(j)],10)||0;}function O(){var j=this.tabContainerNode,k=false,h=false;if(I(j)<0){var m=G.position(j),l=G.position(j.firstChild);k=(l.x<m.x);h=(l.x+l.w>m.x+m.w+0.1);}this.downBtnNode.style.display=k?"block":"none";this.upBtnNode.style.display=h?"block":"none";}function T(h,j){h=(h||[]);if(!h.filter){return R.filter(h,j);}return h.filter(j);}function Q(h,j){h=(h||[]);if(!h.map){return R.map(h,j);}return h.map(j);}function J(z,k){if(this.isStatic){return ;}var w=this.tabContainerNode,v=T(this.children,function(AA){return AA.isSelected;})[0],r=v&&v.domNode;if(!w||!r){return ;}var l=G.position(w),p=w.firstChild,x=I(w),m=e(p,this),j=Math.max(m,x);if(z){if(x<0){var o=G.position(r),q=o.x-l.x,u=o.x+o.w-(l.x+l.w),t=this.isAlignRight,h=function(AA){j=t?j+AA:j-AA;};if(q<0){h(q);}else{if(u>0){h(u);}}}}if(j!==m){var n=X();if(k&&n){d.addClass(p,c);G.attachOneTimeEvent(p,n,function(){d.removeClass(p,c);});}p.style[S(this)]=Math.max(x,Math.min(j,0))+"px";}O.call(this);}function K(h){return h.hasOwnProperty("index");}function H(){var h=this.children,j=0;(h||[]).every(function(l,k){if(!K(l)){return false;}j++;l.index=k;return true;});(h||[]).every(function(k){if(!K(k)){return false;}k.total=j;return true;});}function B(m,j){var q=m.ENUM_CORNERS,n=[q.TOP_RIGHT,q.BOTTOM_RIGHT],o=this.parent;if(o.position!=="bottom"){n.reverse();}m.setAlignment(n[0],n[1]);var l=G.position(o.domNode),h=G.position(j),k=o.menuNode;var p=k.style;p.top=(h.y-l.y)+"px";p.left=(h.x-l.x)+"px";m.addPopupHandlers(o.id,D(true),D(false));m.hostId=o.id;m.hostElement=k;m.isHostedWithin=false;o.openPopup(m.newInstance());}function Y(h){h.raiseEvent({name:"TabsChange"});}mstrmojo.vi.ui.tabs.TabStrip=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo.ui.menus._HasMenuPopup,mstrmojo.vi._MonitorsAppState],{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",markupString:'<div id="{@id}" class="mstrmojo-VITabStrip {@cssClass}" style="{@cssText}" ><div class="mstrmojo-VITabStrip-tabs"><div style="display:table"><div style="display:table-row"></div></div></div><div class="mstrmojo-VITabStrip-addBtn" mstrAttach:click><div></div></div><div class="mstrmojo-VITabStrip-downBtn" mstrAttach:click,mousedown><div></div></div><div class="mstrmojo-VITabStrip-upBtn" mstrAttach:click,mousedown><div></div></div><div class="mstrmojo-VITabStrip-menuHost"></div><div class="mstrmojo-VIDND-mask"></div></div>',markupSlots:{tabContainerNode:function(){return this.domNode.firstChild;},containerNode:function(){return this.domNode.firstChild.firstChild.firstChild;},addBtnNode:function(){return this.domNode.childNodes[1];},addBtnImgNode:function(){return this.domNode.childNodes[1].firstChild;},downBtnNode:function(){return this.domNode.childNodes[2];},upBtnNode:function(){return this.domNode.childNodes[3];},menuNode:function(){return this.domNode.childNodes[4];},maskNode:function(){return this.domNode.lastChild;}},isStatic:false,isAlignRight:true,tabContainerNode:null,downBtnNode:null,upBtnNode:null,menuNode:null,position:"bottom",layoutConfig:{w:{tabContainerNode:"100%",addBtnNode:W},xt:true},onAppStateChange:function V(j){var h=mstrmojo.vi.VisualInsightApp.APP_STATES.PRESENTATION;if(j.value===h||j.valueWas===h){this.layoutConfig.w.addBtnNode=mstrApp.appState===h?"0px":W;this.doLayout();}},setStatic:function U(h,j){this.isStatic=h;if(!h){J.call(this,true,j);}},setTabs:function C(k,h){this.removeChildren();var l=this,j=k.length;this.addChildren(Q(k,function(o,m){var n=o.k;return l.getTabCfg(k,o,{scriptClass:"mstrmojo.vi.ui.tabs.Tab",index:m,total:j,draggable:!!j,dropZone:!!j,k:n,isSelected:n===h,showTabMenu:B,tabMoved:function(q){var p=this.index;this.parent.moveTab(p,p+(q?-1:1),p);}});}));J.call(this,true);Y(this);},getTabs:function N(){return T(this.children,K);},getTabCfg:function F(j,k,h){return h;},deleteTab:function P(h){var o=this.id,n=this.children[h],m=X(),l=function(){var p=mstrmojo.all[o];p.removeChildren(n);n.destroy();H.call(p);O.call(p);Y(p);};if(m){var k=n.domNode.firstChild,j=k.style;j.width=k.offsetWidth+"px";window.setTimeout(function(){d.addClass(k,c);G.attachOneTimeEvent(k,m,l);j.width=0;},0);}else{l();}},buildRendering:function E(){this._super();d.toggleClass(this.domNode,"alignLeft",!this.isAlignRight);},postBuildRendering:function Z(){var h=this._super();J.call(this,true);return h;},doLayout:function A(){this._super();J.call(this);},setSelectedTab:function b(h){(this.children||[]).forEach(function(j){j.set("isSelected",j.k===h);});Y(this);},getSelectedTab:function M(){var k=null,j=this.children||[],h;for(h=0;h<j.length;h++){if(j[h].isSelected){k=j[h];break;}}return k;},onclick:function g(h){if(h.getTarget()===this.addBtnImgNode){this.addTab();}},addTab:mstrmojo.emptyFn,onmousedown:function f(u){var p=u.getTarget().parentNode,v=(p===this.downBtnNode);if(v||p===this.upBtnNode){var t=this.tabContainerNode,o=t.firstChild,j=I(t),l=e(o,this),n=this.isAlignRight?(v?-10:10):(v?10:-10),k=this.id,q=this,m;if(mstrApp.setInteractive){mstrApp.setInteractive(false);}d.addClass(p,"active");var r=function(){window.clearInterval(m);d.removeClass(p,"active");O.call(mstrmojo.all[k]);if(mstrApp.setInteractive){mstrApp.setInteractive(true);}};G.attachOneTimeEvent(document.body,"mouseup",r);m=window.setInterval(function(){l=Math.min(Math.max(j,l+n),0);o.style[S(q)]=l+"px";if(l===j||l===0){r();}},33);}},moveTab:function L(h,q,o,n){var j=this.children,r=j.splice(h,1)[0];j.splice(q,0,r);H.call(this);var k=this.containerNode,l=k.childNodes,p=k.removeChild(l[h]),m=l[q];if(m){k.insertBefore(p,m);}else{k.appendChild(p);}if(r.isSelected){J.call(this,true,true);}if(!n&&o!==undefined&&o!==q){this.commitTabMove(o,q);Y(this);}},commitTabMove:function a(h,j){throw new Error(this.scriptClass+" must implement commitTabMove.");}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabGraph");var B=mstrmojo.dom;mstrmojo.OIVMDocXtabGraph=mstrmojo.declare(mstrmojo.DocXtabGraph,null,{scriptClass:"mstrmojo.OIVMDocXtabGraph",unrender:function D(){this.clearCache();this._super();},postBuildRendering:function C(){if(!this.preLoader){this.preLoader=document.createElement("img");}return this._super();},retrieveGraphSrc:function A(K,N){if(parseInt(K,10)===0||parseInt(N,10)===0){return ;}if(isNaN(parseInt(this.node.data.sid,10))){return ;}var E=mstrConfig.taskURL+"?taskId=getRWGraphImage&taskEnv=xhr&__ts__="+(new Date().getTime())+"&messageID="+this.model.docModel.mid+"&nodeKey="+this.k+"&sliceID="+parseInt(this.node.data.sid,10)+"&imgType=4&width="+parseInt(N,10)+"&height="+parseInt(K,10),P=this.preLoader,Q=this.imgNode,F=this.id;E=mstrmojo.addCSRFTokenToURL(E);if(P.dsrc!==E){P.dsrc=E;var J=function(){mstrApp.removeLoadingGraph(F);},O="load",I="error",M,H,L,G;H=B.attachOneTimeEvent(P,O,function(){G=B.attachOneTimeEvent(Q,O,function(){J();Q.style.background="none";mstrmojo.all[F].defn.set("readyState",mstrmojo.EnumReadystate.IDLE);B.detachEvent(Q,I,L);},true);L=B.attachOneTimeEvent(Q,I,function(){J();B.detachEvent(Q,O,G);},true);B.detachEvent(P,I,M);Q.src=P.src;},true);M=B.attachOneTimeEvent(P,"error",function(){J();B.detachEvent(P,O,H);},true);this.model.docModel.dataService.getRWGraphImage({k:this.k,sid:parseInt(this.node.data.sid,10),w:N,h:K,encodeImage:true},{success:function(R){P.src=R;},failure:function(){M();}});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.num","mstrmojo.date","mstrmojo.Container","mstrmojo.VBox","mstrmojo.Button","mstrmojo.locales","mstrmojo._FormatDefinition","mstrmojo.mstr.EnumFunction","mstrmojo.ui.editors.controls.ComboBox");var K=mstrmojo.hash,Z=mstrmojo.array,F=mstrmojo.num,H=mstrmojo._FormatDefinition,A=mstrmojo.css,X=mstrmojo.mstr.EnumFunction,J=mstrmojo.locales,G=mstrmojo.Button.newIconButton,M=mstrmojo.date,D=H.NumberFormatCategory,m=H.FixedNegative,E=H.CurrencyNegative,c=H.PercentNegative,I=H.DefaultFormat.FormattingNumber,W,R,b=function b(p,o){return{cls:this.value===p.v?"selected":"",v:p.v||"",n:p.n||"",style:p.r?"color:red;":"color:#fff;",sel:parseInt(this.idx,10)===o?"selected":""};},l={RIGHT:1,LEFT_WITH_SPACE:2,RIGHT_WITH_SPACE:3};var Q=[{n:mstrmojo.desc(4531,"Automatic"),v:-3}].concat(H.Category.slice(2)),a=[{n:"$"},{n:""},{n:""},{n:""},{n:"fr."}];function C(q,p){var o=Z.find(q,"v",p);return o===-1?"":q[o].f;}function L(o){var q=this.parent.parent.parent.myData,p=o.v;q.set("format",C(this.items,p));q.set("negativeNumbers",p);A.toggleClass(this.selectedNode,"red",o.r);}function V(q,r,o){return{scriptClass:"mstrmojo.ui.Pulldown",items:q,onitemSelected:function p(t){var u=this.parent;while(u&&(!u.data||typeof u.data[r]==="undefined")){u=u.parent;}if(u){u.data.set(r,t.v);if(o){u.children[0].preview.preview_label.set("text",t.n);}}}};}function f(z,t,r,AB,x){var AA=K.clone(z),o=t>0?".":"",p=o,q=H.DefaultFormat.FormattingNumber,v;for(v=0;v<t;v++){o+=v%9;p+="0";}for(v=0;v<AA.length;v++){var w=AA[v];if(r){w.n=w.n.replace(/,/g,"");w.f=w.f.replace(/,/g,"");}if(AB&&AB!==q.CurrencyPosition){switch(AB){case l.RIGHT:w.n=w.n.replace(/\$/g,"").replace(/\.\d{2}/g,".12$");w.f=w.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00"$"');break;case l.LEFT_WITH_SPACE:w.n=w.n.replace(/\$/g,"$ ");w.f=w.f.replace(/\$/g,"$ ");break;case l.RIGHT_WITH_SPACE:w.n=w.n.replace(/\$/g,"").replace(/\.\d{2}/g,".12 $");w.f=w.f.replace(/"\$"/g,"").replace(/\.\d{2}/g,'.00" $"');break;default:}}w.n=w.n.replace(/\.\d{2}/g,o);w.f=w.f.replace(/\.\d{2}/g,p);if(x&&x!==q.CurrencySymbol){var u=x.replace(/\$/g,"$$$$");w.n=w.n.replace(/\$/g,u);w.f=w.f.replace(/\$/g,u);}w.cls=w.r?"red":null;}return AA;}function T(q){var o="1"+(q>0?".":"").toString(),r="0"+(q>0?".":"").toString(),p;for(p=0;p<q;p++){o+=p%10;r+="0";}return[o+"E+03",r+"E+0#"];}function P(AD,AF){var w="\u00A4",AB=/"[^"]*"/g,q=AD.match(AB),AG="\u0091",AC=/\[[^\]]*\]/g,o=AD.match(AC),AA,AE;AA=AD.replace(AB,w);AA=AA.replace(AC,AG);var t=AD.indexOf("."),z=F.getDecimalLength(AD),v=Math.max(0,z+AF),r=AD.match(/\d(?!((\d)|(,\d)))/g),p=t!==-1?AD.charAt(t-1):r&&r[0],x=(p||"0")+(v>0?".":"").toString();for(var u=0;u<v;u++){x+="0";}AA=AA.replace(z===0?/\d(?!((\d)|(,\d)))/g:/\d\.\d+/g,x);AA=AA.split(w);AE=AA[0];Z.forEach(q,function(AI,AH){AE+=AI+AA[AH+1];});AA=AE.split(AG);AE=AA[0];Z.forEach(o,function(AI,AH){AE+=AI+AA[AH+1];});return AE;}function N(w,o,v,u,q,p){var t=w.parent.parent.parent,r=f(o,v.decimalPlaces,u,q,p);v.set("format",C(r,v.negativeNumbers.toString()));w.set("items",r);w.set("selectedIndex",Z.find(r,"v",v.negativeNumbers.toString()));t.preview.preview_label.set("text",S(t.myData.format));}function h(){var x=this.parent.parent,AC=x.myData,r=x.formatterContainer,p=Q[x.categoryPicker.selectedIndex].v,AF=this.funcType===X.FunctionLeftStr?1:-1,u=null,w=null,t=false,AE=0,z=null,q=false,AB;switch(p){case D.Fixed:u=r.fixed_hBox.negativeDDL;w=m;t=!AC.thousandSeparator;break;case D.Currency:u=r.currency_hBox2.negativeDDL;w=E;AE=AC.currencyPosition;z=AC.currencySymbol;break;case D.Percentage:u=r.percentage_hBox.negativeDDL;w=c;break;case D.Scientific:q=true;break;case D.Custom:AB=true;break;default:return ;}if(AB){var AD=P(AC.format,AF);x.preview.preview_label.set("text",S(AD));x.formatterContainer.custom_text.set("value",AD);return ;}var v=AC.decimalPlaces,o=v+AF;o=Math.max(0,o);o=Math.min(H.MaxNegativeDidigts,o);AC.set("decimalPlaces",o);if(q){var AA=T(o);AC.set("format",AA[1]);x.preview.preview_label.set("text",AA[0]);}else{N(u,w,AC,t,AE,z);}}function S(AA){var q="\u00A4",v=/"[^"]*"/g,p=AA.match(v),u=AA.replace(v,q),z=["m","y","d","h","s"],x=false,o=new Date(),w=o.getFullYear(),t=o.getMonth(),r=o.getDay(),AC=J.datetime,AB;Z.forEach(z,function(AD){x=x||u.indexOf(AD,0)!==-1;});if(x){u=u.replace(/y{3,}/g,w).replace(/y{1,2}/g,w.toString().slice(2,4));u=u.replace(/m{4,}/g,AC.MONTHNAME_FULL[t-1]).replace(/m{3}/g,AC.MONTHNAME_SHORT[t-1]).replace(/mm/g,"07").replace(/m/g,"7").replace(/7ber/g,"mber");u=u.replace(/d{4,}/g,AC.dayNames[r-1]).replace(/d{3}/g,"Mon").replace(/dd/g,"10").replace(/d/g,"1").replace(/1ay/g,"day");u=u.replace(/hh/g,"08").replace(/h/g,"8");u=u.replace(/ss/g,"04").replace(/s/g,"4");u=u.split(q);AB=u[0];Z.forEach(p,function(AE,AD){AB+=AE+u[AD+1];});return AB;}return F.formatByMask(AA,1234.12);}function n(o,p){return Math.max(Z.find(o,"v",p),0);}function B(q){var p=this.parent.parent.categoryPicker,o=Q.map(function(r){return r.v;}).indexOf(q);p.set("selectedIndex",o);}function k(o,p,r,q){return G(undefined,o,p,undefined,K.copy(q,{useRichTooltip:true,updateTooltipConfig:function(){this.richTooltip={cssClass:"vi-regular vi-tooltip-A A-center",content:r,refNode:this.domNode,posType:mstrmojo.tooltip.POS_TOPCENTER,left:15,top:33};}}));}function Y(){if(mstrApp.isSingleTier){var u=this.formatterContainer,t=J.datetime,o={day:7,month:4,year:1998},q={hour:15,min:41,sec:46},r=t&&t.DATEINPUTFORMATS,p=t&&t.TIMEINPUTFORMATS;W=[];R=[];r.forEach(function(v){W.push({v:v,n:M.formatDateInfo(o,v)});});p.forEach(function(v){R.push({v:v,n:M.formatTimeInfo(q,v)});});u.date_ddl.set("items",W);u.time_ddl.set("items",R);}else{W=H.Date;R=H.Time;}}mstrmojo.vi.ui.NumberFormatter=mstrmojo.declare(mstrmojo.VBox,null,{scriptClass:"mstrmojo.vi.ui.NumberFormatter",cssClass:"NumberFormatter-content",formatValue:null,myData:null,oldData:null,categoryPicker:null,formatterContainer:null,preview:null,shortcutRow:null,adjustAfterCategoryChange:mstrmojo.emptyFn,preBuildRendering:function(){if(this._super){this._super();}Y.call(this);var o=this.formatterContainer;if(this.formatValue){o.currency_hBox1.currency_symbol.selectedValue=this.formatValue.currencySymbol;o.fixed_btn.checked=!!this.formatValue.thousandSeparator;A.addWidgetCssClass(o.fraction_ddl,c[Z.find(c,"v",this.formatValue.negativeNumbers)].r?" red":"");}},postBuildRendering:function O(){if(this._super){this._super();}if(this.formatValue){this.categoryPicker.set("selectedIndex",n(this.categoryPicker.items,this.formatValue.category.toString()));}},children:[K.copy({alias:"categoryPicker",cssClass:"nf-category",onitemSelected:function j(AC){if(!this.hasRendered){return ;}var w=this,AA=w.parent,q=AA.formatterContainer,o=AA.shortcutRow,AB=AA.preview.preview_label,z=AC.v,t=z===D.Automatic,p=[],v=AA.myData;Z.forEach(q.children,function(AD){AD.set("visible",false);});AA.border.set("visible",!t);AA.preview.set("visible",!t);["border","moveLeftBtn","moveRightBtn"].forEach(function(AD){o[AD].set("visible",!t);});v.set("category",z);v.set("thousandSeparator",z?I.ThousandSeparator:AA.formatValue.thousandSeparator);switch(z){case D.Currency:N(q.currency_hBox2.negativeDDL,E,v,false,v.currencyPosition,v.currencySymbol);q.currency_hBox1.currency_position.set("selectedIndex",n(H.CurrencyPosition,v.currencyPosition.toString()));p=["currency_hBox1","currency_hBox2"];break;case D.Date:q.date_ddl.set("selectedIndex",n(W,v.format));p=["date_ddl"];break;case D.Time:q.time_ddl.set("selectedIndex",n(R,v.format));p=["time_ddl"];break;case D.Percentage:N(q.percentage_hBox.negativeDDL,c,v,false,0,null);p=["percentage_hBox"];break;case D.Fraction:q.fraction_ddl.set("selectedIndex",n(H.Fraction,v.format));p=["fraction_ddl"];break;case D.Scientific:var u=T(v.decimalPlaces||0);v.set("format",u[1]);AB.set("text",u[0]);break;case D.Custom:var r=v.customText||v.format,x=q.custom_text;v.set("format",r);x.value=r;x.refresh();AB.set("text",S(r));p=["custom_condense","custom_text"];break;case D.Fixed:N(q.fixed_hBox.negativeDDL,m,v,!v.thousandSeparator,0,null);p=["fixed_hBox","fixed_btn"];break;}Z.forEach(p,function(AD){q[AD].set("visible",true);});AA.adjustAfterCategoryChange();}},V(Q,"category")),{scriptClass:"mstrmojo.Box",cssClass:"nf-MiddleRow nf-shortcut",alias:"shortcutRow",border:null,moveLeftBtn:null,moveRightBtn:null,children:[k("nf-shortcut-currency",function e(){B.call(this,D.Currency);},mstrmojo.desc(2051,"Currency"),undefined),k("nf-shortcut-percentage",function e(){B.call(this,D.Percentage);},mstrmojo.desc(2053,"Percentage"),undefined),k("nf-shortcut-fixed",function e(){B.call(this,D.Fixed);this.parent.parent.formatterContainer.fixed_btn.set("checked",true);},mstrmojo.desc(2050,"Fixed"),undefined),{scriptClass:"mstrmojo.Label",cssClass:"shortcut-border",alias:"border"},k("nf-MoveDecimalPoint left",function e(){h.call(this);},mstrmojo.desc(2189,"Increase Decimal"),{funcType:X.FunctionLeftStr,alias:"moveLeftBtn"}),k("nf-MoveDecimalPoint right",function e(){h.call(this);},mstrmojo.desc(2188,"Decrease Decimal"),{funcType:X.FunctionRightStr,alias:"moveRightBtn"})]},{scriptClass:"mstrmojo.Label",alias:"border",cssClass:"nf-border"},{scriptClass:"mstrmojo.Container",alias:"formatterContainer",cssClass:"nf-buttons",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',fixed_hBox:null,fixed_btn:null,currency_hBox1:null,currency_hBox2:null,date_ddl:null,time_ddl:null,percentage_hBox:null,fraction_ddl:null,custom_condense:null,custom_text:null,markupSlots:{containerNode:function U(){return this.domNode;}},children:[{scriptClass:"mstrmojo.HBox",alias:"fixed_hBox",cssClass:"nf-MiddleRow",negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},K.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:b,onitemSelected:function j(o){L.call(this,o);}},V([],"format"))]},{scriptClass:"mstrmojo.CheckBox",alias:"fixed_btn",cssClass:"nf-MiddleRow",label:mstrmojo.desc(13898,"Use 1000 Separator(#)").replace("#",J.number.THOUSANDSEPARATOR),onclick:function e(){var o=this.parent.parent;o.myData.set("thousandSeparator",this.checked?-1:0);N(this.parent.fixed_hBox.negativeDDL,m,o.myData,!this.checked,0,null);}},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox1",cssClass:"nf-MiddleRow",visible:true,currency_symbol:null,currency_position:null,children:[{scriptClass:"mstrmojo.ui.editors.controls.ComboBox",alias:"currency_symbol",cssClass:"nf-CurrencySymbol",selectedValue:"$",items:a,postselectedValueChange:function g(o){var u=this,t=u.parent.parent.parent,r=o.value,q=t.myData;q.set("currencySymbol",r);N(this.parent.parent.currency_hBox2.negativeDDL,E,q,false,parseInt(q.currencyPosition,10),r);}},K.copy({cssClass:"nf-CurrencyPosition align-right",alias:"currency_position",onitemSelected:function j(o){var t=this,r=t.parent.parent.parent,q=o.v;r.myData.set("currencyPosition",parseInt(q,10));N(this.parent.parent.currency_hBox2.negativeDDL,E,r.myData,false,parseInt(q,10),r.myData.currencySymbol);}},V(H.CurrencyPosition,"currencyPosition"))]},{scriptClass:"mstrmojo.HBox",alias:"currency_hBox2",cssClass:"nf-MiddleRow",negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},K.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:b,onitemSelected:function j(o){L.call(this,o);}},V([],"format"))]},K.copy({alias:"date_ddl",cssClass:"nf-MiddleRow"},V(H.Date,"format",true)),K.copy({alias:"time_ddl",cssClass:"nf-MiddleRow"},V(H.Time,"format",true)),{scriptClass:"mstrmojo.HBox",alias:"percentage_hBox",cssClass:"nf-MiddleRow",negativeDDL:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"negative-label",text:mstrmojo.desc(13891,"Negative:")},K.copy({alias:"negativeDDL",cssClass:"nf-NegativePullDown",getOptionProps:b,onitemSelected:function j(o){L.call(this,o);}},V([],"format"))]},K.copy({alias:"fraction_ddl",cssClass:"nf-MiddleRow"},V(H.Fraction,"format",true)),mstrmojo.Button.newWebButton(mstrmojo.desc(13893,"Condense (e.g.10M)"),function(){this.parent.custom_text.set("value",'[>=1000000]#,##0,,"M";[>=1000]#,##0,"K";0');},false,{cssClass:"nf-condense",alias:"custom_condense"}),{scriptClass:"mstrmojo.TextBox",alias:"custom_text",cssClass:"nf-custom",onvalueChange:function d(){var r=this,q=r.parent.parent,o=r.value;q.myData.set("format",o);q.myData.set("customText",o);r.parent.parent.preview.preview_label.set("text",S(o).replace(/\s/g,"&nbsp;"));}}]},{scriptClass:"mstrmojo.HBox",alias:"preview",cssClass:"nf-MiddleRow",preview_label:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"preview_lable",text:mstrmojo.desc(13892,"Preview:")},{scriptClass:"mstrmojo.Label",cssClass:"align-right",alias:"preview_label"}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.publisher","mstrmojo.Widget","mstrmojo.fx","mstrmojo.locales","mstrmojo.expr","mstrmojo.Button","mstrmojo.date","mstrmojo.ui.editors.controls.Stepper","mstrmojo.css");var AD=function(){return mstrmojo.locales.datetime;},j=mstrmojo.dom,h=mstrmojo.expr,AA=h.DTP,Z=mstrmojo.date,J=mstrmojo.publisher,e=mstrmojo.hash,l=mstrmojo.array,N=l.removeIndices,k=mstrmojo.css;var AC=0,C=3,M=4,o=5,Q=6;var AE="month",c="day",V="year",X="hour",AH="minute",w="second";var G='<table border="0" cellpadding="0" cellspacing="0">',v="</table>";function O(AI){return'<table border="0" cellpadding="0" cellspacing="0" style="'+AI+'">';}function H(AL,AI,AJ){var AK=Z.getFirstDateOfMonth(AL,AI);return(AK.getDay()-AJ+8)%7;}function m(AL){var AK=Z.parseDateAndOrTime(AL),AM,AI,AJ;if(AK){AJ={};AM=AK.date;AI=AK.time;if(AM){e.copy(AM,AJ);}if(AI){e.copy(AI,AJ);}}return AJ;}function F(AJ,AM,AL,AK,AI){var AN=Z.formatDateInfo({day:AJ,month:AM,year:AL},AD().DATEOUTPUTFORMAT);return Z.inDateTimeRange(AN,AK,AI)===0;}function T(AM,AL,AK){var AJ=AM.decreaseButton,AI=AM.increaseButton,AN="mstrmojo-Calendar";AJ.className=(AN+"-decrease");AI.className=(AN+"-increase");}function W(AM,AJ,AO,AL){var AK=0,AI=AM.length,AN;for(AK=0;AK<AI;AK++){AN=AM[AK];if(AN&&AN.day===AJ&&AN.month===AO&&AN.year===AL){return AK;}}return -1;}function p(AI,AK,AJ){var AL=new Date();return(AL.getFullYear()===AJ)&&((AL.getMonth()+1)===AK)&&(AL.getDate()===AI);}function u(AP,AQ){var AU=AP.dayView.getElementsByTagName("div"),AS=AP.selectedDates,AK=AS[AQ],AT=AP.browseYear,AJ=AP.browseMonth,AM=Z.getDaysOfMonth(AT,AJ),AL=Z.getPreMonth(AT,AJ),AO=Z.getDaysOfMonth(AL.y,AL.m),AI=H(AT,AJ,AP.firstDayOfWeek),AN=((AK.month===AJ)?AK.day+AI-1:(AK.month>AJ?AK.day+AI+AM-1:AI-AO+AK.day-1)),AR=AU[AN];if(AR){b(AR,AP,false);}N(AS,AQ,1);}function B(AI){var AJ=AI.selectedDates;while(AJ.length){u(AI,0);}}function AG(AK,AI){var AJ=K(AK,AI),AL=AK.selectedDates;AL.push({day:AJ.d,month:AJ.m,year:AJ.y});b(AI,AK,true);}function n(AK,AL){if(!AL||!AL.length){return null;}var AN=AK.selectedDates;for(var AJ=0,AI=AL.length;AJ<AI;AJ++){var AM=AL[AJ],AO=q(AK,AM);AN.push({day:AM.d,month:AM.m,year:AM.y});if(AO){b(AO,AK,true);}}}function q(AQ,AS){var AU=AQ.dayView.getElementsByTagName("div"),AL=AU.length,AT=AQ.browseYear,AJ=AQ.browseMonth,AM=Z.getPreMonth(AT,AJ),AN=Z.getDaysOfMonth(AM.y,AM.m),AY=Z.getNextMonth(AT,AJ),AK=Z.getDaysOfMonth(AT,AJ),AI=H(AT,AJ,AQ.firstDayOfWeek);var AO=AI>0?{y:AM.y,m:AM.m,d:AU[0].innerHTML}:{y:AT,m:AJ,d:AU[0].innerHTML},AW=(AU.length-AK-AI)>0?{y:AY.y,m:AY.m,d:AU[AL-1].innerHTML}:{y:AT,m:AJ,d:AU[AL-1].innerHTML},AX=S(AO,AS),AP=S(AS,AW),AR=null;if(AX>=0&&AP>=0){var AV=0;if(AX<AI){AV=-1;}if(AP<(AU.length-AI-AK)){AV=1;}AR=((AV===0)?AS.d+AI-1:(AV===1?AS.d+AI+AK-1:AI-AN+AS.d-1));return AU[AR];}else{return null;}}function f(AQ,AI){var AS=AQ.selectedDates,AK=AS.length;if(!AK){return null;}var AJ=AS[AK-1],AL=K(AQ,AI),AV=S({y:AJ.year,m:AJ.month,d:AJ.day},AL),AW=[],AN=AV>0,AT=Math.abs(AV);for(var AP=0;AP<=AT;AP++){var AO=new Date(AL.y,AL.m-1,AL.d);AO.setDate(AO.getDate()+(AN?-AP:AP));var AU=AO.getFullYear(),AM=AO.getMonth()+1,AR=AO.getDate();if(AQ.isDateDisabled(AR,AM,AU,AQ.min,AQ.max)&&!AQ.canSelectDisabledDate){continue;}AW.push({y:AU,m:AM,d:AR});}return AW;}function S(AL,AK){var AI=new Date(AL.y,AL.m-1,AL.d),AJ=new Date(AK.y,AK.m-1,AK.d);return(AJ-AI)/1000/3600/24;}function K(AK,AI){var AL=AK.browseYear,AN=AK.browseMonth,AM=parseInt(AI.innerHTML,10),AO=parseInt(AI.getAttribute("m"),10),AJ=null;AJ=(AO===0)?{y:AL,m:AN}:(AO===1?Z.getNextMonth(AL,AN):Z.getPreMonth(AL,AN));AJ.d=AM;return AJ;}function g(AI){var AK=AI.selectedDates,AJ=AK.length;return(AJ===0)?null:AK[AJ-1];}function b(AJ,AK,AI){var AL=AK.selectedColor;k.toggleClass(AJ,["selected",AK.selectedCssStyle],AI);AJ.parentNode.style.backgroundColor=AI?AL:"";AJ.style.backgroundColor=AI?AL:"";}function z(AI){return AI.selectedColor?('style="background-color:'+AI.selectedColor+';"'):"";}function P(AI){return(AI.tagName.toLowerCase()==="td")?AI.firstChild:AI;}function R(AJ,AK){var AL=Z.getDateJson(AJ),AI=Z.formatDateInfo(AL,mstrmojo.locales.datetime.DATEOUTPUTFORMAT);if(AK===AA.TIMESTAMP){AI+=" "+Z.formatTimeInfo(this.timeVal,mstrmojo.locales.datetime.TIMEOUTPUTFORMAT);}return AI;}function r(AN,AK){var AI=this.advancedValues,AJ=null;AI.set(AN,AK);switch(AI.baseDate){case C:AJ=new Date();break;case M:break;case o:break;case Q:break;default:return ;}var AL=AI.monthsToAdjust;if(AL>0){AJ.setMonth(AJ.getMonth()+(AI.toAddMonths?AL:-AL));}var AM=AI.daysToAdjust;if(AM>0){AJ.setDate(AJ.getDate()+(AI.toAddDays?AM:-AM));}this.set("value",R.call(this,AJ,this.dtp));}function U(){var AI=this.advancedValues,AJ=["isDyn"];if(AI.baseDate===AC){return null;}AJ.push(AI.baseDate);AJ.push(AI.toAddDays?AI.daysToAdjust:-AI.daysToAdjust);AJ.push(AI.toAddMonths?AI.monthsToAdjust:-AI.monthsToAdjust);AJ.push(0);AJ.push(0);AJ.push(0);AJ.push(0);AJ.push(this.value);AJ.push(this.timeVal.hour);AJ.push(this.timeVal.min);AJ.push(this.timeVal.sec);return AJ.join("::");}function AF(AI){if(AI.value!==undefined&&this.hasRendered){this.updateSelectedDate();}}function I(AK,AJ){var AL=this,AI=function(AM){return AM[0].toUpperCase()+AM.substring(1);};return{scriptClass:"mstrmojo.HBox",cssClass:"dateAdjustBox",alias:AK+"AdjustBox",children:[{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:AJ>=0?0:1,onitemSelected:function(AN,AM){r.call(AL,"toAdd"+AI(AK),AM===0);},items:[{did:0,n:mstrmojo.desc(9424,"plus")},{did:1,n:mstrmojo.desc(9425,"minus")}]},{scriptClass:"mstrmojo.ui.editors.controls.Stepper",width:null,height:null,provider:new mstrmojo.NumStepperContentProvider({item:{interval:1,min:0,value:Math.abs(AJ)},onTraverse:function(){r.call(AL,AK+"ToAdjust",this.curVal);}})},{scriptClass:"mstrmojo.Label",text:AK==="days"?mstrmojo.desc(707,"Days"):mstrmojo.desc(710,"Months")}]};}function Y(){this.buttonsNode.style.display=(this.wasAdvanced||this.changeValueOnOK||(this.showAdvanced&&this.isAdvanced)?"block":"none");this.advancedNode.style.display=this.showAdvanced?"block":"none";}mstrmojo.Calendar=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.Calendar",cssPrefix:"",browseMonth:null,browseYear:null,yearRangStart:null,selectedDates:null,selectedColor:"",isMultiSelect:false,hilightToday:false,yearViewSize:5,cssTextDay:"",cssTextMonth:"",cssTextYear:"",cssTextWeekDay:"",cssTextHeader:"",cssTextMonthYearLabel:"",forceNonEmptySelection:false,showCurMonthDatesOnly:false,currentView:c,duration:600,timeDelimiter:":",dtp:AA.DATE,value:"",firstDayOfWeek:1,changeValueOnOK:false,wasAdvanced:false,showAdvanced:false,isAdvanced:false,dynDateValue:null,canSelectDisabledDate:false,monthNames:function(AI){return AD().MONTHNAME_SHORT[AI];},dayNames:function(AI){return AD().dayShortNames[AI];},min:null,max:null,supportedViews:{day:true,month:true,year:true,hour:true,minute:true,second:true},sDirMatrix:{day:{month:"down",year:"down",hour:"up",minute:"up",second:"up"},month:{day:"up",year:"left",hour:"up",minute:"up",second:"up"},year:{day:"up",month:"right",hour:"up",minute:"up",second:"up"},hour:{day:"down",month:"down",year:"down",minute:"left",second:"left"},minute:{day:"down",month:"down",year:"down",hour:"right",second:"left"},second:{day:"down",month:"down",year:"down",hour:"right",minute:"right"}},markupString:'<div id="{@id}" class="{@cssPrefix} mstrmojo-Calendar {@cssClass}" style="{@cssText}" mstrAttach:mousedown,mouseup,mouseover,mouseout><div class="mstrmojo-Calendar-header" style="{@cssTextHeader}"><div class="mstrmojo-Calendar-decrease"></div><div class="mstrmojo-Calendar-increase"></div><div class="mstrmojo-Calendar-title"><span class="mstrmojo-Calendar-monthLabel" style="{@cssTextMonthYearLabel}">{@browseMonth}</span><span class="mstrmojo-Calendar-yearLabel" style="{@cssTextMonthYearLabel}">{@browseYear}</span></div></div><div class="mstrmojo-Calendar-body" style="{@cssTextBody}"><div class="mstrmojo-Calendar-dayView"></div></div><div class="mstrmojo-Calendar-timePart"><span class="mstrmojo-Calendar-hourLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-minuteLabel">00</span><span class="mstrmojo-Calendar-timeDelimiter">{@timeDelimiter}</span><span class="mstrmojo-Calendar-secondLabel">00</span><span class="mstrmojo-Calendar-AMPMLabel">AM</span></div><div class="mstrmojo-Calendar-advanced"></div><div class="mstrmojo-Calendar-buttons cf"></div></div>',markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";},onbrowseMonthChange:function(){this.monthLabel.innerHTML=this.monthNames(this.browseMonth-1);},onbrowseYearChange:function(){this.yearLabel.innerHTML=this.browseYear;},ondtpChange:function(){this.timePart.style.display=(this.dtp===AA.TIMESTAMP||this.dtp===AA.TIME)?"block":"none";this.advancedNode.style.display=this.showAdvanced?"block":"none";},onvalueChange:function(){if(this.lastValue===undefined||this.value!==this.lastValue){this.updateSelectedDate();}},onchangeValueOnOKChange:Y,onisAdvancedChange:Y},markupSlots:{monthLabel:function(){return this.domNode.firstChild.lastChild.firstChild;},yearLabel:function(){return this.domNode.firstChild.lastChild.lastChild;},decreaseButton:function(){return this.domNode.firstChild.firstChild;},increaseButton:function(){return this.domNode.firstChild.childNodes[1];},bodyContainer:function(){return this.domNode.childNodes[1];},dayView:function(){return this.domNode.childNodes[1].firstChild;},monthView:function(){return this.domNode.childNodes[1].firstChild;},yearView:function(){return this.domNode.childNodes[1].firstChild;},hourView:function(){return this.domNode.childNodes[1].firstChild;},minuteView:function(){return this.domNode.childNodes[1].firstChild;},secondView:function(){return this.domNode.childNodes[1].firstChild;},timePart:function(){return this.domNode.childNodes[2];},hourLabel:function(){return this.domNode.childNodes[2].firstChild;},minuteLabel:function(){return this.domNode.childNodes[2].childNodes[2];},secondLabel:function(){return this.domNode.childNodes[2].childNodes[4];},AMPMLabel:function(){return this.domNode.childNodes[2].childNodes[5];},advancedNode:function(){return this.domNode.childNodes[3];},buttonsNode:function(){return this.domNode.childNodes[4];}},init:function AB(AI){if(this._super){this._super(AI);}if(this.duration<1){this.duration=1;}if(!this.selectedDates){this.selectedDates=[];}this.timeVal={hour:0,min:0,sec:0};},ondynDateValueChange:function t(AI){if(AI.value!==undefined&&this.hasRendered){this.updateSelectedDate();this.buildChildren();}},onminChange:AF,onmaxChange:AF,buildChildren:function a(){var AO=this;if(this.showAdvanced){var AL=this.dynDateValue,AK=this.advancedValues||this.addDisposable(new mstrmojo.Model({})),AR=AL&&AL.split("::")||[],AN=AR[1]||AC,AJ=AR[2]||0,AS=AR[3]||0,AP=function AP(){if(AO.isAdvanced){AO.wasAdvanced=true;AO.changeValueOnOK=true;}AO.set("isAdvanced",!AO.isAdvanced);mstrmojo.css.toggleClass(AO.markupSlots.dayView.call(AO),["ddSelected"],AO.isAdvanced);r.call(AO,"baseDate",AO.isAdvanced?3:0);if(AO.parent&&AO.parent.nudge&&AO.isAdvanced){AO.parent.nudge();}};this.advancedValues=AK;AK.baseDate=parseInt(AN);AK.toAddDays=AJ>=0;AK.daysToAdjust=Math.abs(AJ);AK.toAddMonths=AS>=0;AK.monthsToAdjust=Math.abs(AS);this.isAdvanced=!!this.dynDateValue;if(this.domNode){mstrmojo.css.toggleClass(this.markupSlots.dayView.call(this),["ddSelected"],this.isAdvanced);}if(this.isAdvanced&&this.value){var AI=m(this.value),AM=this.timeVal;if(AI&&AI.hour!==undefined){AM.hour=AI.hour;AM.min=AI.min;AM.sec=AI.sec;}}r.call(AO,"baseDate",this.isAdvanced?3:0);this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.HBox",alias:"checkLabel",slot:"advancedNode",children:[{scriptClass:"mstrmojo.ui.Checkbox",alias:"checkbox",checked:!!AO.isAdvanced,oncheckedChange:AP},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13844,"Dynamic Date"),onclick:function AQ(){this.parent.checkbox.onclick();}}]},{scriptClass:"mstrmojo.Box",alias:"advancedPanel",slot:"advancedNode",bindings:{visible:"this.parent.isAdvanced"},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9423,"Today"),cssClass:"tdLabel"},I.call(this,"days",AJ),I.call(this,"months",AS)]},]);}else{this.destroyChildren(false);}this.addChildren([mstrmojo.Button.newWebButton(mstrmojo.desc(2140,"Cancel"),function(){AO.parent.close();},false,{slot:"buttonsNode"}),mstrmojo.Button.newWebButton(mstrmojo.desc(1442,"OK"),function(){if(AO.changeValueOnOK||AO.isAdvanced||AO.wasAdvanced){AO.updateValue(true);}},true,{slot:"buttonsNode"})]);},preBuildRendering:function A(){this.buildChildren();return this._super();},getSelectedDatesAsString:function E(AJ){var AI=[];l.forEach(this.selectedDates,function(AK){AI.push(Z.formatDateInfo(AK,AJ||AD().DATEOUTPUTFORMAT));});return AI;},updateSelectedDate:function L(AM){var AI=this.value,AJ=this.timeVal,AL=this.selectedDates,AK,AN=function(AP,AO){AP.set("browseYear",AO.year);AP.set("browseMonth",AO.month);AP.updateTimePart();AP.updateView(AP.currentView);if(!AP.changeValueOnOK&&AP.hasRendered&&AP.closeOnValueChange!=true){AP.updateValue();}};if(this.wasAdvanced){this.wasAdvanced=false;this.changeValueOnOK=false;}if(AI){AK=m(AI);if(AK&&AK.hour!==undefined){AJ.hour=AK.hour;AJ.min=AK.min;AJ.sec=AK.sec;}}if((AK&&!this.isMultiSelect)||AM){B(this);}if(AL.length===0){if(!AK){if(this.parent.opener&&this.parent.opener.defaultDate){AK=m(this.parent.opener.defaultDate);}else{AK=Z.getDateJson(new Date());}}if(!this.canSelectDisabledDate&&this.isDateDisabled(AK.day,AK.month,AK.year,this.min,this.max)){if(this.min&&Z.compareDate(AK,this.min)<0){AK=m(this.min);}else{if(this.max&&Z.compareDate(AK,this.max)>0){AK=m(this.max);}}}AL.push(AK);AN(this,AK);}else{AK=AL[0];if(!this.value){AN(this,AK);}}},updateValue:function d(AI){var AK=g(this),AJ="";if(AK){AJ=Z.formatDateInfo(AK,AD().DATEOUTPUTFORMAT);if(this.dtp!==AA.DATE){AJ+=" "+Z.formatTimeInfo(this.timeVal,AD().TIMEOUTPUTFORMAT);}}this.lastValue=AJ;this.set("value",AJ);if(this.showAdvanced){this.set("dynDateValue",AI?U.call(this):null);}if(this.onValueUpdate){this.onValueUpdate();}},updateTimePart:function x(){var AJ=this.timeVal,AI=AJ.hour||0,AK=(AI%12===0)?12:(AI%12);this.hourLabel.innerHTML=AK;this.minuteLabel.innerHTML=Z.formatInteger(AJ.min||0,2);this.secondLabel.innerHTML=Z.formatInteger(AJ.sec||0,2);this.AMPMLabel.innerHTML=AI<12?" "+AD().AM_NAME:" "+AD().PM_NAME;},premousedown:function(AI){var AK=AI.e,AJ=j.eventTarget(AI.hWin,AK);if(AJ===this.decreaseButton||AJ===this.increaseButton){if(j.isFF){j.stopPropogation(window,AK);}return true;}else{return this.processEvent(AJ,AK);}},premouseup:function(AI){var AK=AI.e;if(AK.ctrlKey||AK.shiftKey){j.clearBrowserHighlights();}var AJ=j.eventTarget(AI.hWin,AK);if(AJ===this.decreaseButton&&!AJ.disabled){this.decrease();return true;}if(AJ===this.increaseButton&&!AJ.disabled){this.increase();return true;}},processEvent:function(AT,Aa){var AL=this.currentView,AM=this.selectedDates,AQ,AV,Ab,AI,AS;if(AT===this.monthLabel){if(AL!==AE){this.switchViewTo(AE);}return true;}if(AT===this.yearLabel){if(AL!==V){this.adjustYearStart();this.switchViewTo(V);return true;}}if(AT===this.hourLabel){if(AL!==X){this.switchViewTo(X);}return true;}if(AT===this.minuteLabel){if(AL!==AH){this.switchViewTo(AH);}return true;}if(AT===this.secondLabel){if(AL!==w){this.switchViewTo(w);}return true;}if(AT===this.AMPMLabel){if(AL!==X){this.switchViewTo(X);}return true;}if(AL===X){var AO=AT.getAttribute("h");AS=parseInt(AT.innerHTML,10);if(!isNaN(AO)&&!isNaN(AS)){AO=parseInt(AO,10);this.timeVal.hour=AS%12+AO*12;this.updateTimePart();this.switchViewTo(c);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AL===AH){AS=parseInt(AT.innerHTML,10);if(!isNaN(AS)){this.timeVal.min=AS;this.updateTimePart();this.switchViewTo(c);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AL===w){AS=parseInt(AT.innerHTML,10);if(!isNaN(AS)){this.timeVal.sec=AS;this.updateTimePart();this.switchViewTo(c);if(!this.changeValueOnOK){this.updateValue();}}return true;}if(AL===c){var AZ=this.browseYear,AJ=this.browseMonth,AK;AT=P(AT);Ab=parseInt(AT.innerHTML,10);AI=parseInt(AT.getAttribute("m"),10);if(!isNaN(Ab)&&!isNaN(AI)){AK=(AI===0)?{y:AZ,m:AJ}:(AI===1?Z.getNextMonth(AZ,AJ):Z.getPreMonth(AZ,AJ));if((!this.canSelectDisabledDate&&this.isDateDisabled(Ab,AK.m,AK.y,this.min,this.max))||Aa.button===2){return true;}if(this.isAdvanced){return true;}var AW=W(AM,Ab,AJ,AZ),AU=AM.length>1,AR=this.forceNonEmptySelection,AX=this.isMultiSelect,AP=AX&&Aa.ctrlKey,AY=AX&&Aa.shiftKey,AN=null;if(AY){AN=f(this,AT);B(this);n(this,AN);}else{if(AP){if(AW===-1){AG(this,AT);}else{if(!AR||AU){u(this,AW);}}}else{B(this);if(AU||AW===-1||AR){AG(this,AT);}}}if(this.onselect||J.hasSubs(this.id,"select")){this.raiseEvent({name:"select",value:this.selectedDates});}if(AI===1){this.increase();}else{if(AI===-1){this.decrease();}}if(!this.changeValueOnOK){this.updateValue();}else{if(this.showAdvanced){this.checkLabel.checkbox.set("checked",false);r.call(this,"baseDate",0);}}}return true;}if(AL===AE){AT=P(AT);AV=parseInt(AT.getAttribute("m"),10);if(!isNaN(AV)){this.set("browseMonth",AV+1);this.switchViewTo(c);}return true;}if(AL===V){AT=P(AT);AQ=parseInt(AT.innerHTML,10);if(!isNaN(AQ)){this.set("browseYear",AQ);this.switchViewTo(c);}return true;}return true;},decrease:function(){var AK=this.currentView,AN=AK,AM=this.browseYear,AI=this.browseMonth,AJ=this.yearRangStart,AL;switch(AK){case c:AL=Z.getPreMonth(AM,AI);this.set("browseMonth",AL.m);this.set("browseYear",AL.y);break;case AE:this.set("browseYear",AM-1);break;case V:this.yearRangStart=AJ-this.yearViewSize*this.yearViewSize;break;case X:AN=w;break;case AH:AN=X;break;case w:AN=AH;break;}this.switchViewTo(AN,"right");},increase:function(){var AK=this.currentView,AN=AK,AM=this.browseYear,AI=this.browseMonth,AJ=this.yearRangStart,AL;switch(AK){case c:AL=Z.getNextMonth(AM,AI);this.set("browseMonth",AL.m);this.set("browseYear",AL.y);break;case AE:this.set("browseYear",AM+1);break;case V:this.yearRangStart=AJ+this.yearViewSize*this.yearViewSize;break;case X:AN=AH;break;case AH:AN=w;break;case w:AN=X;break;}this.switchViewTo(AN,"left");},updateView:function(AI){var AJ=this[AI+"ViewHTML"]();this[AI+"View"].innerHTML=AJ;},adjustYearStart:function(){this.yearRangStart=this.browseYear-10-this.browseYear%5;},switchViewTo:function(AJ,AL){var AP="mstrmojo-Calendar-"+AJ+"View",AO=document.createElement("div"),AI=this[this.currentView+"View"],AM=AJ+"ViewHTML",AN=this[this.currentView+"Label"],AK=this[AJ+"Label"];if(!this.supportedViews[AJ]){return ;}if(!AL){AL=this.sDirMatrix[this.currentView][AJ];}AO.className=AP;AO.innerHTML=this[AM]();this.currentView=AJ;this[AJ+"View"]=AO;mstrmojo.css.toggleClass(AO,["ddSelected"],this.isAdvanced);this._slideIntoView(AI,AO,AL);},_slideIntoView:function(AM,AQ,AK){var AI=this.bodyContainer,AO=(AK==="left"||AK==="right")?AM.offsetWidth:AM.offsetHeight,AJ=(AK==="left"||AK==="right")?"left":"top",AP=(AK==="left"||AK==="up")?AO:-AO,AN=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AM,onEnd:function(){AI.removeChild(AM);}}),AL=new mstrmojo.fx.AnimateProp({props:{},duration:this.duration,interval:this.duration/10,target:AQ});AQ.style[AJ]=AP+"px";AI.appendChild(AQ);AN.props[AJ]={start:0,stop:-AP,suffix:"px"};AL.props[AJ]={start:AP,stop:0,suffix:"px"};AN.play();AL.play();},dayViewHTML:function(){var AN=this.browseYear,AQ=this.browseMonth,AV=Z.getDaysOfMonth(AN,AQ),AZ=Z.getPreMonth(AN,AQ),AK=Z.getDaysOfMonth(AZ.y,AZ.m),AJ=Z.getNextMonth(AN,AQ),AR=H(AN,AQ,this.firstDayOfWeek),AO=[],AL=z(this),Ab=0,AI=this.selectedDates,AT=this.min,AX=this.max,Ac,AU,AY,AW,Aa=this.showCurMonthDatesOnly?'style="visibility:hidden;"':"";T(this,{d:AK,m:AZ.m,y:AZ.y},{d:1,m:AJ.m,y:AJ.y});AO.push(O(this.cssTextDay));AO.push(this._dayViewTHead());AO.push("<tr>");for(AY=0;AY<AR;AY++){Ac=AK-AR+AY+1;AU=this.isDateDisabled(Ac,AZ.m,AZ.y,AT,AX)?"disabled":"";AO.push("<td "+Aa+'><div class="mstrmojo-Calendar-day-pre '+AU+'" m="-1">');AO.push(Ac);AO.push("</div></td>");Ab++;}for(AY=0;AY<AV;AY++){Ac=AY+1;AU=this.isDateDisabled(Ac,AQ,AN,AT,AX)?" disabled":"";var AM=p(Ac,AQ,AN),AP=AM?" today":"",AS=W(AI,Ac,AQ,AN)!==-1;AP=(this.hilightToday&&AM)?" hilightToday":AP;AO.push("<td "+(AM?('class="'+AP+'" '):" ")+(AS?AL:"")+'><div class="mstrmojo-Calendar-day-cur'+(AS?(" selected "):"")+AU+'" m="0"'+(AS?AL:"")+">");AO.push(AY+1);AO.push("</div></td>");if((++Ab)%7===0){AO.push("</tr><tr>");}}for(AW=Ab;AW<42;AW++){Ac=Ab-AV-AR+1;AU=this.isDateDisabled(Ac,AJ.m,AJ.y,AT,AX)?"disabled":"";AO.push("<td "+Aa+'><div class="mstrmojo-Calendar-day-next '+AU+'" m="1">');AO.push(Ac);AO.push("</div></td>");if((++Ab)%7===0&&Ab!==42){AO.push("</tr><tr>");}}AO.push("</tr>");AO.push(v);return AO.join("");},_dayViewTHead:function(){var AL=[],AM='<thead><tr class="mstrmojo-Calendar-thead" style="'+this.cssTextWeekDay+';">',AK="</tr></thead>",AJ=this.firstDayOfWeek-1,AN=this.dayNames,AI;AL.push(AM);for(AI=AJ;AI<AJ+7;AI++){AL.push("<td>");AL.push(AN(AI%7));AL.push("</td>");}AL.push(AK);return AL.join("");},monthViewHTML:function(){var AJ=[],AL=this.browseMonth-1,AK=this.browseYear,AI;T(this,{d:31,m:12,y:AK-1},{d:1,m:1,y:AK+1});AJ.push(O(this.cssTextMonth));AJ.push("<tr>");for(AI=0;AI<12;AI++){AJ.push("<td "+((AI===AL)?z(this):"")+'><div class="mstrmojo-Calendar-month'+((AI===AL)?" selected":"")+'" m="');AJ.push(String(AI));AJ.push('">');AJ.push(this.monthNames(AI));AJ.push("</div></td>");if(AI%3===2){AJ.push("</tr><tr>");}}AJ.pop();AJ.push("</tr>");AJ.push(v);return AJ.join("");},yearViewHTML:function(){var AN=this.yearRangStart,AJ=[],AL=this.browseYear,AM,AI,AK=this.yearViewSize;T(this,{d:31,m:12,y:AN-1},{d:1,m:1,y:AN+AK*AK});AJ.push(O(this.cssTextYear));AJ.push("<tr>");for(AI=0;AI<AK*AK;AI++){AM=AN+AI;AJ.push("<td "+((AL===AM)?z(this):"")+'><div class="mstrmojo-Calendar-year'+((AL===AM)?" selected":"")+'">');AJ.push(AM);AJ.push("</div></td>");if(AI%AK===(AK-1)){AJ.push("</tr><tr>");}}AJ.pop();AJ.push("</tr>");AJ.push(v);return AJ.join("");},hourViewHTML:function(){var AK=[],AJ=this.timeVal.hour,AI;AK.push(G);AK.push('<tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AK.push(AD().AM_NAME);AK.push("</div></td></tr>");for(AI=0;AI<12;AI++){AK.push('<td><div class="mstrmojo-Calendar-hour'+((AI===AJ)?" selected":"")+'" h="0">');AK.push((AI===0)?12:AI);AK.push("</div></td>");if(AI===5){AK.push("</tr><tr>");}}AK.push('</tr><tr><td colspan="6"><div class="mstrmojo-Calendar-hourTitle">');AK.push(AD().PM_NAME);AK.push("</div></td></tr>");for(AI=0;AI<12;AI++){AK.push('<td><div class="mstrmojo-Calendar-hour'+(((12+AI)===AJ)?" selected":"")+'" h="1">');AK.push((AI===0)?12:AI);AK.push("</div></td>");if(AI===5){AK.push("</tr><tr>");}}AK.push("</tr>");AK.push(v);return AK.join("");},minuteViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.min,"mstrmojo-Calendar-minute");},secondViewHTML:function(){return this._minuteSecondViewHTML(this.timeVal.sec,"mstrmojo-Calendar-second");},_minuteSecondViewHTML:function(AK,AL){var AJ=[],AI;AJ.push(G);AJ.push("<tr>");for(AI=0;AI<60;AI++){AJ.push('<td><div class="');AJ.push(AL);AJ.push((AI===AK)?' selected">':'">');AJ.push(AI);AJ.push("</div></td>");if(AI%10===9){AJ.push("</tr><tr>");}}AJ.pop();AJ.push("</tr>");AJ.push(v);return AJ.join("");},isDateDisabled:function(AI,AK,AJ){return !F(AI,AK,AJ,this.min,this.max);},unrender:function D(AI){delete this.lastValue;this._super(AI);}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.Dialog","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.Label","mstrmojo.form","mstrmojo.LoginEditor");mstrmojo.requiresDescs(2699,7773,11812,11865,13380,13381,13382);var D=mstrmojo.desc(13382,"Your user session will time out due to inactivity in # ##."),S=60,M=false,G=null,A=null,H=null;function N(){return mstrApp.sessionState||microstrategy.sessionState;}function K(V,U){if(mstrApp.is508){for(var T in U){V.setAttribute(T,U[T]);}}}mstrmojo.SessionManager=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SessionManager",cssClass:"mstrmojo-SessionManager",width:"370px",title:mstrmojo.desc(11812,"Notification"),msgInterval:1,checkSessionInterval:20,zIndex:10000,maxSessionIdleTime:600,timeBeforeSessionTimeoutWarning:60,remainingTime:60,sessionTimedout:false,buttons:[mstrmojo.Button.newWebButton(mstrmojo.desc(13381,"Stay logged in"),function(){var T=this.parent.parent;if(A){T.keepSessionAlive();}T.hideMessage();},true,{onRender:function(){K(this.domNode,{tabindex:0,role:"button","aria-label":mstrmojo.desc(13381,"Stay logged in")});}}),mstrmojo.Button.newWebButton(mstrmojo.desc(13380,"Log out"),function(){this.parent.parent.hideMessage();mstrmojo.form.send({evt:3019,src:mstrApp.name+".3019"});},null,{onRender:function(){K(this.domNode,{tabindex:0,role:"button","aria-label":mstrmojo.desc(13380,"Log out")});}})],children:[{scriptClass:"mstrmojo.Label",alias:"message",cssClass:"mstrmojo-SessionManager-msg",text:"",allowHTML:true,ontextChange:function(){if(mstrApp.is508){this.refresh();var T=this.domNode;K(T,{tabindex:-1,role:"alert"});window.setTimeout(function(){T.focus();},0);}}}],postBuildRendering:function(){this._super();if(mstrApp.is508){this.msgInterval=10;K(this.editorNode,{role:"alertdialog",tabindex:-1});}},updateMsg:function B(U){var T;if(U>60){T=D.replace("##",mstrmojo.desc(2699,"minutes")).replace("#","<b>"+Math.ceil(U/S)+"</b>");}else{if(U>-1){T=D.replace("##",mstrmojo.desc(7773,"seconds")).replace("#","<b>"+U+"</b>");}else{T=mstrmojo.desc(11865,"Your session is expired.");}}this.message.text="";this.message.set("text",T);this.remainingTime=U;},showMessage:function F(T){this.updateMsg(T);this.set("visible",true);M=true;},hideMessage:function I(){if(A){window.clearInterval(A);A=null;window.clearInterval(H);H=null;}this.set("visible",false);M=false;},popupTimeoutWarning:function L(X){if(M){return ;}var V=this,W=(typeof X==="number")?X:V.timeBeforeSessionTimeoutWarning,T=W,U=mstrmojo.now();if(mstrApp.enableWarningSessionTimeout){if(!this.hasRendered){this.render();}this.showMessage(T);}window.clearInterval(A);A=window.setInterval(function(){if(T<1){window.clearInterval(A);A=null;window.setTimeout(function(){if(mstrApp.enableWarningSessionTimeout){V.gotoLogoutPage();}else{V.sessionTimedout=true;V.closeSession();}},200);}var Y=Math.round((mstrmojo.now()-U)/1000);T=W-Y;V.updateMsg(T);},this.msgInterval*1000);window.clearInterval(H);H=window.setInterval(function(){V.isSessionAlive();},this.checkSessionInterval*1000);},warningTimeoutTimer:function Q(T){var U=this;window.clearTimeout(G);G=window.setTimeout(function(){G=null;U.isSessionAlive();},(T-this.timeBeforeSessionTimeoutWarning)*1000);},isSessionAlive:function E(){var T=this,V={success:function(W){var X=parseInt(W,10);if(X!==-1){if(X>T.remainingTime){T.hideMessage();}if(X>T.timeBeforeSessionTimeoutWarning){T.warningTimeoutTimer(X);}else{T.popupTimeoutWarning(X);}}else{window.clearInterval(H);T.popupTimeoutWarning(0);}},failure:function(){mstrmojo.alert("Problems encountered during checking for whether session is alive. Connection is down or session already time out.");}},U={taskId:"isSessionAlive",notRestartSessionManager:true};mstrmojo.xhr.request("POST",mstrConfig.taskURL,V,U);},keepSessionAlive:function R(){var T=this,V={success:function(W){if(W){T.warningTimeoutTimer(T.maxSessionIdleTime);}else{T.sessionTimedout=true;mstrmojo.alert("Your session is expired.");}},failure:function(){mstrmojo.alert("Problems encountered during activating session. Connection is down or session already time out.");}},U={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,V,U);},closeSession:function J(){var T=this;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){T.sessionTimedout=true;}},{taskId:"closeSessions",sessionStates:N(),notRestartSessionManager:true});},restart:function(){this.sessionTimedout=false;this.hideMessage();if(this.maxSessionIdleTime>this.timeBeforeSessionTimeoutWarning){this.warningTimeoutTimer(this.maxSessionIdleTime);}},start:function C(){var V=mstrConfig.lastMsgKey;if(this.maxSessionIdleTime>this.timeBeforeSessionTimeoutWarning){this.warningTimeoutTimer(this.maxSessionIdleTime);}var U=function(){window.localStorage.setItem("msg_recovery_notify"+V,1);};if(window.addEventListener){window.addEventListener("beforeunload",U);}else{window.attachEvent("onbeforeunload",U);}var T=window.sessionStorage;if(T){T.setItem("msg_browser_not_closed"+V,1);T.setItem("msg_user_login",0);}},openLoginEditor:function P(V){var U="LoginEditor",T=mstrmojo.all[U];if(!T){T=mstrmojo.insert({id:U,scriptClass:"mstrmojo.LoginEditor",config:{callback:{}},zIndex:10000});}T.config.callback=V;T.open();},gotoLogoutPage:function O(){mstrmojo.form.send({evt:3008,src:mstrApp.name+".3008",autoLoggedout:true,Server:mstrConfig.serverName,Port:mstrConfig.serverPort,Project:mstrConfig.projectName,loginReq:true},null,"POST");}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.fx","mstrmojo.Box","mstrmojo.Editor","mstrmojo.Button","mstrmojo._FormatDefinition","mstrmojo.TabListContainer","mstrmojo.TabNameList","mstrmojo.StackContainer","mstrmojo.FontFormatter","mstrmojo.NumberFormatter","mstrmojo.AlignmentFormatter","mstrmojo.PaddingFormatter","mstrmojo.FillFormatter","mstrmojo.BorderFormatter");var C=mstrmojo.array,M=mstrmojo.hash,F=mstrmojo._FormatDefinition,B=mstrmojo.Button,L=F.MetricFormatTarget;var G="#999",E="mstrmojo-Editor-button mstrButton",H=M.clone(F.DefaultFormat);H.FormattingPatternsChart={FillColor:"16777215",FillStyle:"0",GradientColor:"16777215",GradientAngle:"0",GradientXOffset:"0",GradientYOffset:"0"};H.FormattingPatterns=M.clone(H.FormattingPatternsChart);var I={n:mstrmojo.desc(3434,"Number"),scriptClass:"mstrmojo.NumberFormatter",visible:false,pr:"FormattingNumber"},K={n:mstrmojo.desc(3435),scriptClass:"mstrmojo.Box",visible:false,pr:["FormattingAlignment","FormattingPadding"],cssClass:"alignmentPanel",children:[{scriptClass:"mstrmojo.AlignmentFormatter",bindings:{model:"this.parent.FormattingAlignment"}},{scriptClass:"mstrmojo.PaddingFormatter",bindings:{model:"this.parent.FormattingPadding"}}]},N={n:mstrmojo.desc(3433,"Font"),scriptClass:"mstrmojo.FontFormatter",visible:false,pr:"FormattingFont",cssClass:"mstrmojo-FormatEditor-fontTable",cellPadding:5},D={n:mstrmojo.desc(2886,"Borders"),scriptClass:"mstrmojo.BorderFormatter",visible:false,pr:"FormattingBorder"},A={n:mstrmojo.desc(3905,"Background"),scriptClass:"mstrmojo.FillFormatter",visible:false,pr:"FormattingPatterns"},J={n:mstrmojo.desc(3479,"Graph"),scriptClass:"mstrmojo.FillFormatter",visible:false,isChart:true,pr:"FormattingPatternsChart"};mstrmojo.ME.MetricFormatEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.ME.MetricFormatEditor",cssClass:"mstrmojo-FormatEditor",title:mstrmojo.desc(2116,"Format"),model:null,obModel:null,_initModel:function(){if(!this.model){this.model={};for(var O=0;O<L.length;O++){this.model[L[O].p]={};}}if(!this.obModel){this.obModel=new mstrmojo.Model({onlevelNameChange:function(P){var Q=P.valueWas;if(Q){this._updateModel(Q);}this._setCurrentFormat();},onmodelChange:function(){return this.model?this._setCurrentFormat():false;},_updateModel:function(Q){var R=M.copy(this.currentFormat),Q=Q||this.levelName,P=this.model[Q];if(!P){P=this.model[Q]={};}F.extractModel(R,P,H);this.model.set(Q,P);},_setCurrentFormat:function(){var P=this.model?M.copy(this.model[this.levelName||L[0].p]):{};P=F.getStandardFormat(P,H);this.set("currentFormat",P);}});}},init:function(O){this._initModel();this._super(O);},onmodelChange:function(){this._initModel();var Q=this.obModel,O=M.clone(this.model)||{};if(O){var P={};if(O&&O[L[0].p]){var R=O[L[0].p].FormattingPatterns;if(R){for(pr in R){if(pr.match(/^Series\w+/gi)){P[pr.substring(6,pr.length)]=R[pr];}}}O[L[0].p].FormattingPatternsChart=P;}}if(O&&!O.attachEventListener){M.make(O,mstrmojo.Obj);}Q.set("model",O);Q.set("levelName",Q.levelName||L[0].p);},promptOnClearFormatRef:{scriptClass:"mstrmojo.Editor",cssText:"width:350px;",title:"",showTitle:false,children:[{scriptClass:"mstrmojo.Label",cssText:"margin:5px 5px 20px;",bindings:{text:function(){return mstrmojo.desc(9564,"Clear all formatting?");}}},{scriptClass:"mstrmojo.HBox",cssText:"float:right; margin-bottom:5px;",alias:"buttonBar",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"Ok"),onclick:function(){var O=this.parent.parent;O.opener.onClearFormat();O.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var O=this.parent.parent;O.close();}}]}]},prompt2ClearFormat:function(){this.openPopup("promptOnClearFormatRef",{zIndex:this.zIndex+1});},onClearFormat:function(){var P=this.obModel;for(var O=0;O<L.length;O++){delete P.model[L[O].p];}P._setCurrentFormat();},onOK:function(){var Q=this.obModel;Q._updateModel();var R=Q.model[L[0].p];if(R){var P=R.FormattingPatterns,O=R.FormattingPatternsChart;if(O){for(pr in H.FormattingPatternsChart){if(O[pr]!=null){P["Series"+pr]=O[pr];}}delete O;}}var S=mstrmojo.hash.clone(this.model);F.saveFormatModel(Q.model,this.model,[L[0].p,L[1].p],F.DefaultFormat);this.model.dirty=!mstrmojo.hash.equals(S,this.model);},children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.HBox",alias:"btns",children:[{scriptClass:"mstrmojo.Pulldown",alias:"which",items:L,itemIdField:"v",bindings:{value:function(){var O=C.find(this.items,"p",this.parent.parent.parent.obModel.levelName);return this.items[O!=-1?O:0][this.itemIdField];}},cssClass:" mstrmojo-FormatEditor-DropDownButton",popupZIndex:100,value:L[0].v,onvalueChange:function(){var R=this.parent.parent.parent,P=this.parent.parent.formatPanels,S=P&&P.stck,Q=this.selectedItem;if(R&&R.obModel&&S){R.obModel.set("levelName",Q?Q.p:L[0].p);var O=C.find(S.children,"pr",J.pr);if(Q==null||Q.p==L[0].p){if(O==-1){S.addChildren(J);S.onchildRenderingChange(J);}}else{S.removeChildren(S.children[O]||[]);}}}},new B.newInteractiveButton(mstrmojo.desc(5976),function(O){var P=this.parent.parent.parent;P.prompt2ClearFormat();},G,{alias:"btnClear",cssClass:E+" clear"})]},{scriptClass:"mstrmojo.TabListContainer",alias:"formatPanels",listCssClass:"mstrmojo-FormatEditor-leftPanel",bindings:{currentModel:"this.parent.parent.obModel.currentFormat"},oncurrentModelChange:function(){this.parent.btns.which.onvalueChange();var O=this.lst;if(O.selectedIndex==0){O.onchange();}else{O.set("selectedIndex",0);}},children:[{scriptClass:"mstrmojo.TabNameList",alias:"lst",slot:"top",cssClass:"mstrmojo-FormatEditor-formatList",itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>',onchange:function(){var R=this.parent,S=this.selectedIndex;if(R.stck&&S!=null&&S!=-1){var Q=this.items[S],O=Q&&Q.target;var T=O&&O.pr;if(T){if(T.constructor===Array){for(var P=0;P<T.length;P++){O.set(T[P],R.currentModel[T[P]]);}}else{O.set("model",R.currentModel[T]);}}}}},{scriptClass:"mstrmojo.StackContainer",cssClass:"mstrmojo-FormatEditor-rightPanel-container mstrmojo-FormatEditor-rightPanel",alias:"stck",slot:"stack",children:[I,K,N,D,A,J]}]}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",children:[new B.newInteractiveButton(mstrmojo.desc(2397),function(){var O=this.parent.parent;O.close();O.onOK&&O.onOK();},G,{alias:"btnOk",cssClass:E}),new B.newInteractiveButton(mstrmojo.desc(2399),function(){var O=this.parent.parent;O.close();},G,{alias:"btnCancel",cssClass:E})]}]});})();(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.Editor","mstrmojo._FormatDefinition","mstrmojo.FontFormatter","mstrmojo.NumberFormatter","mstrmojo.AlignmentFormatter","mstrmojo.PaddingFormatter","mstrmojo.FillFormatter","mstrmojo.BorderFormatter");var B=mstrmojo.hash,C=mstrmojo._FormatDefinition;var A=["header_format","grid_format","child_header_format","child_grid_format"];mstrmojo.CGFormatEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.CGFormatEditor",cssClass:"mstrmojo-FormatEditor",title:mstrmojo.desc(2116),model:null,obModel:null,_initModel:function(){if(!this.obModel){var D=this;this.obModel=new mstrmojo.Model({level1Index:A[0],onlevel0IndexChange:function(E){if(E.valueWas>-1){this._updateModel(E.valueWas,this.level1Index);}this._setCurrentFormat();},onlevel1IndexChange:function(E){if(E.valueWas!=undefined){this._updateModel(this.level0Index,E.valueWas);}this._setCurrentFormat();},onmodelChange:function(){return this.model.items.length>0?this._setCurrentFormat():false;},_updateModel:function(H,F){H=(typeof H!="undefined")?H:this.level0Index;F=F||this.level1Index;var G=mstrmojo.hash.copy(this.currentFormat);var E=this.model.items[H][F]||{};C.extractModel(G,E);this.model.items[H].set(F,E);},_setCurrentFormat:function(){var E=mstrmojo.hash.copy(this.model.items[this.level0Index||0][this.level1Index]);E=C.getStandardFormat(E);this.set("currentFormat",E);}});}},init:function(D){this._initModel();this._super(D);},onmodelChange:function(){this._initModel();var E=this.obModel;E.level0Index=E.level0Index||0;E.set("model",mstrmojo.hash.clone(this.model));var D=E.model.selectedIndex;E.set("level0Index",(D==-1?0:D));},onClearFormat:function(){var D=this.obModel.currentFormat;for(var G in D){delete D[G];}for(var F=0;F<A.length;F++){var E=this.obModel;delete E.model.items[E.level0Index][A[F]];}this.obModel._setCurrentFormat();},onOK:function(){this.obModel._updateModel();var D=this.obModel.model;for(var E=0;E<D.items.length;E++){C.saveFormatModel(D.items[E],this.model.items[E],A);}},postBuildRendering:function(){if(this._super){this._super();}var D=this.obModel.model.selectedIndex;this.obModel.set("level0Index",(D==-1?0:D));},children:[{scriptClass:"mstrmojo.VBox",children:[{scriptClass:"mstrmojo.HBox",alias:"btns",children:[{scriptClass:"mstrmojo.Pulldown",itemIdField:"did",bindings:{items:function(){return this.parent.parent.parent.obModel.model.items||[];},value:function(){var D=this.parent.parent.parent.obModel.level0Index;D=(D==-1?0:D);return this.items[D][this.itemIdField];}},cssClass:" mstrmojo-FormatEditor-DropDownButton",popupZIndex:100,value:1,onvalueChange:function(){var D=this.parent.parent.parent;if(D&&D.obModel){D.obModel.set("level0Index",this.selectedIndex);}}},{scriptClass:"mstrmojo.Pulldown",alias:"targetSelector",itemIdField:"v",cssClass:" mstrmojo-FormatEditor-DropDownButton",popupZIndex:100,value:1,items:C.FormatTarget,onvalueChange:function(){var D=this.parent.parent.parent;if(D&&D.obModel){D.obModel.set("level1Index",this.selectedItem.p);}}},new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(5976),function(D){var E=this.parent.parent.parent;if(E.onClearFormat){E.onClearFormat();}},"#999",{alias:"btnClear",cssClass:"mstrmojo-Editor-button mstrButton clear"})]},{scriptClass:"mstrmojo.HBox",alias:"formatPanels",cssClass:"mstrmojo-FormatEditor-box",bindings:{currentModel:"this.parent.parent.obModel.currentFormat"},children:[{scriptClass:"mstrmojo.VBox",alias:"formatList",cssClass:"mstrmojo-FormatEditor-leftPanel",children:[{scriptClass:"mstrmojo.List",alias:"feFMTList",cssClass:"mstrmojo-FormatEditor-formatList",items:C.Formats,selectedIndex:0,itemMarkup:'<div class="mstrmojo-FormatEditor-bullet"><div class="mstrmojo-text">{@n}</div></div>',height:"200px"}]},{scriptClass:"mstrmojo.Container",alias:"rightPanelContainer",cssClass:"mstrmojo-FormatEditor-rightPanel-container mstrmojo-FormatEditor-rightPanel",markupString:'<div id={@id} class="{@cssClass}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},children:[{scriptClass:"mstrmojo.FontFormatter",cssClass:"mstrmojo-FormatEditor-fontTable",cellPadding:5,bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==0",model:"this.parent.parent.currentModel.FormattingFont"}},{scriptClass:"mstrmojo.NumberFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==1",model:"this.parent.parent.currentModel.FormattingNumber"}},{scriptClass:"mstrmojo.AlignmentFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==2",model:"this.parent.parent.currentModel.FormattingAlignment"}},{scriptClass:"mstrmojo.PaddingFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==2",model:"this.parent.parent.currentModel.FormattingPadding"}},{scriptClass:"mstrmojo.FillFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==3",model:"this.parent.parent.currentModel.FormattingPatterns"}},{scriptClass:"mstrmojo.BorderFormatter",bindings:{visible:"this.parent.parent.formatList.feFMTList.selectedIndex==3",model:"this.parent.parent.currentModel.FormattingBorder"}}]}]}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",children:[new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(2397),function(){var D=this.parent.parent;D.close();if(D.onOK){D.onOK();}},"#999",{alias:"btnOk",cssClass:"mstrmojo-Editor-button mstrButton"}),new mstrmojo.Button.newInteractiveButton(mstrmojo.desc(2399),function(){var D=this.parent.parent;D.close();},"#999",{alias:"btnCancel",cssClass:"mstrmojo-Editor-button mstrButton"})]}]});})();(function(){mstrmojo.requiresCls("mstrmojo._HasPopup","mstrmojo.rw.xtab.XtabMenuConfig","mstrmojo.dom","mstrmojo.hash");var F=mstrmojo.dom;function B(H,G){if(G){G.opener=this;}this.openPopup(H,G);}mstrmojo.express.ui._IsDocumentView=mstrmojo.provide("mstrmojo.express.ui._IsDocumentView",mstrmojo.hash.copy(mstrmojo._HasPopup,{_mixinName:"mstrmojo.express.ui._IsDocumentView",openXtabCellMenu:function A(G){var H=this.getXtabCellMenuConfig({isHostedWithin:false,position:G.cmPos||F.position(G.btn.domNode),hostId:this.id});H.buildXtabMenuConfig(G);if(H.hasMenuItems()){B.call(this,H.newInstance(),G);}},getXtabCellMenuConfig:function(G){return new mstrmojo.rw.xtab.XtabMenuConfig(G);},drillLinkMenuRef:"mstrmojo.DrillLinkMenu",openDrillLinkMenu:function D(G){B.call(this,"drillLinkMenuRef",G);},goToLink:function C(G){if(G){window.open(G.url,(G.target||"_self"));}},openPopupMenu:function E(H,G){B.call(this,H,G);}}));}());(function(){mstrmojo.requiresCls("mstrmojo.StackContainer","mstrmojo._IsRwDocument","mstrmojo._HasBuilder","mstrmojo._HasLayout","mstrmojo.express.ui._IsDocumentView","mstrmojo.array");mstrmojo.Doc=mstrmojo.declare(mstrmojo.StackContainer,[mstrmojo._HasBuilder,mstrmojo._IsRwDocument,mstrmojo._HasLayout,mstrmojo.express.ui._IsDocumentView],{scriptClass:"mstrmojo.Doc",cssClass:"mstrmojo-Doc",markupSlots:{containerNode:function(){return this.domNode;},popupNode:function(){return this.domNode;},drillLinkMenuNode:function(){return this.domNode;}},layoutConfig:{h:{containerNode:"100%"},w:{containerNode:"100%"}},getLayouts:function(){return this.children;},buildChildren:function D(H){if(this._super(false)){var G=this.model.getSelectedKey(this.node),I=(G!==null)?mstrmojo.array.find(this.children,"k",G):-1,J=(I>-1)?this.children[I]:null;if(J){this.set("selected",J);}return true;}return false;},restoreLayoutState:function B(H){this._super(H);var G=H.defn.zf;if((this.zf!==G||this.model.getZoomFactor()!==G)&&this.updateZoom){this.zf=G;this.updateZoom();}},_set_selected:function F(K,I){if(!this.selected){return this._super(K,I);}if(I){var H=this,G=this._super,J=I.k;this.getNewLayout({layoutKey:J},this.children,(J!==this.model.currlaykey),{success:function(M){var L=H.selected;G.call(H,K,M);H.raiseEvent({name:"selectedChange",prop:"selected",value:M,valueWas:L});}});}return true;},onLayoutRebuilt:function E(G){this._set_selected("selected",G);},replaceLayout:function C(I,H){var G=this.removeChildren(I);I.destroy();var J=this.builder.build([H],this.model);this.addChildren(J,G);return J[0];},getSelectedLayoutWidget:function A(){return this.selected;},selectorMenuRef:"mstrmojo.SelectorMenu",fpMenuRef:"mstrmojo.FilterPanelMenu"});}());(function(){mstrmojo.requiresCls("mstrmojo.func","mstrmojo.dom","mstrmojo.ServerProxy","mstrmojo.XHRServerTransport","mstrmojo.LoginEditor","mstrmojo.SessionManager");function O(b,Z){var a=(Z?"add":"remove")+"LoadingGraph";this.serverProxy[a](b);}var K=true,N="waitBox";mstrmojo._IsWebApp=mstrmojo.provide("mstrmojo._IsWebApp",{_mixinName:"mstrmojo._IsWebApp",serverProxy:null,init:function T(Z){this._super(Z);if(!this.serverProxy){this.serverProxy=new mstrmojo.ServerProxy({transport:mstrmojo.XHRServerTransport});}},start:mstrmojo.emptyFn,styleName:"RWDocumentMojoStyle",modelFactory:null,enableWaitBox:false,onMobileDevice:function D(){return false;},isTouchApp:function G(){return false;},getContentDimensions:function X(Z){return null;},getConfiguration:mstrmojo.emptyFn,setInteractive:function J(Z){if(K!==Z){K=Z;mstrmojo.dom.toggleSelection(window.document.body,Z);return true;}return false;},isInteractive:function W(){return K;},addLoadingGraph:function E(Z){O.call(this,Z,true);},removeLoadingGraph:function U(Z){O.call(this,Z);},serverRequest:function R(f,g,a){try{g=g||{};a=a||{};var c=a.src||(arguments.callee&&arguments.callee.caller.name),Z=!this.enableWaitBox||a.silent,e=a.hideFailureErr,d=this;f.styleName=f.styleName||this.styleName;g=mstrmojo.func.wrapMethods(g,{submission:function(h){if(!Z){mstrmojo.all[N].requestId=h;}},failure:function(h){if(!Z){h.method=c;if(!(mstrApp.isSingleTier&&h.code===403)&&!e){mstrmojo.err(typeof h.mstrerr==="object"?h.mstrerr:h);}}},complete:function(){if(!Z){if(mstrmojo.all[N]){delete mstrmojo.all[N].requestId;}d.hideWait();}}});if(!Z){this.showWait(a&&a.waitBoxCfg);}window.setTimeout(function(){d.serverProxy.request(g,f,!!a.override,a);},0);}catch(b){mstrmojo.err(b);}},hasRequests:function Q(){return this.serverProxy.hasRequests();},getWaitBoxPosition:function(){return null;},isWaiting:function B(){var Z=mstrmojo.all[N];return !!(Z&&Z.visible);},showWait:function F(a){var c=this,d=mstrmojo.all[N]||mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:N,cssClass:"mstrWaitBox",draggable:false,showTitle:false,zIndex:99999,counter:0,displayMsg:null,position:null,ondisplayMsgChange:function b(){this.msgfield.set("text",this.displayMsg);},oncounterChange:function Z(){var f=this.counter,j=this.visible;if(f===0&&j){this.close();}else{if(f>0&&!j){this.open();mstrmojo.dom.center(this.editorNode);var e=this.position||c.getWaitBoxPosition();if(e){var h=e.top,g=e.left;if(h!==undefined){this.set("top",h+"px");}if(g!==undefined){this.set("left",g+"px");}}}}},children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrIcon-wait",alias:"icon"},{scriptClass:"mstrmojo.Label",cssClass:"mstrWaitMsg",alias:"msgfield"},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Button mstrmojo-WebButton mstrWaitCancel",alias:"cancelBtn",text:mstrmojo.desc(2140,"Cancel")}]});d.cancelBtn.set("visible",!!(a&&a.showCancel));d.cancelBtn.onclick=function(){c.serverProxy.cancelRequests();};if(a&&a.position){d.position=a.position;}else{d.position=null;}d.set("displayMsg",(a&&a.message)||mstrmojo.desc(11960,"Loading Data..."));if(!this._waitUserLogin){d.set("counter",d.counter+1);}else{this._waitCounter=this._waitCounter+1;}return d;},hideWait:function L(Z){var a=mstrmojo.all[N];if(a){a.set("counter",Z?0:Math.max(0,a.counter-1));}},startSessionManager:function S(a){var b=mstrApp,Z=b.enableAutomaticSessionRecovery&&b.maxSessionIdleTime;b.sessionManager=b.addDisposable(new mstrmojo.SessionManager(mstrmojo.hash.copy(a,Z?{timeBeforeSessionTimeoutWarning:mstrApp.timeBeforeSessionTimeoutWarning,maxSessionIdleTime:b.maxSessionIdleTime}:{})));if(Z){b.sessionManager.start();}},isSessionExpiredError:function Y(e){var d=2147760371,b=2147760372,a=2147758245,Z=2147759877;e=(e<0)?(4294967296+parseInt(e,10)):e;switch(e){case d:case b:case a:case Z:return true;}return false;},onSessionExpired:function V(b){if(mstrApp.authMode==mstrmojo.EnumAuthenticationModes.INTEGRATED){var e={evt:5005,src:mstrApp.name+"."+mstrApp.pageName+".5005"},a=(mstrApp.docModel&&mstrApp.docModel.bs)||(mstrApp.rootCtrl&&mstrApp.rootCtrl.docCtrl&&mstrApp.rootCtrl.docCtrl.model&&mstrApp.rootCtrl.docCtrl.model.bs)||(mstrApp.docModelData&&mstrApp.docModelData.bs);if(a){e.rwb=a;}mstrmojo.form.send(e);return ;}if(mstrApp.sessionManager){var d=mstrmojo.all[N],Z=d&&d.counter>0,c=this;this._waitCounter=-1;if(Z){this._waitCounter=d.counter-1;c.hideWait(true);}this._waitUserLogin=true;mstrApp.sessionManager.openLoginEditor({success:function(f){c._waitUserLogin=false;if(f&&f.sessionState){if(b){if(b.params.sessionState){b.params.sessionState=f.sessionState;}if(Z){d.counter=c._waitCounter;c.showWait();}mstrmojo.xhr.request(b.method,b.baseUrl,b.callback,b.params);}}},cancelRequests:function(){mstrApp.serverProxy.cancelRequests();}});}},updateSessionState:function M(Z){this.sessionState=Z;},onNavigateOut:mstrmojo.emptyFn,showHelpTopic:function A(a){var Z=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/"+(mstrApp.userHelpPage||"MicroStrategy_Web_Help.htm#");if(a&&typeof a==="string"){Z+=a;}if(mstrApp.isSingleTier){window.FormWrapper.openPage(Z);}else{mstrApp.openPage(Z);}return false;},getSearchAutoCompleteDelay:function P(){return parseInt(mstrConfig&&mstrConfig.searchAutoCompleteDelay,10)||200;},getThemeClassName:function C(){return"mojo-theme-light";},openPage:function I(Z,a){window.open(Z,a);},modalEditorChange:function H(a,Z){}});window.$MAPF=function(){return false;};}());(function(){mstrmojo.requiresCls("mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.Popup","mstrmojo._HasPopup","mstrmojo.locales","mstrmojo.date","mstrmojo.string");var B=mstrmojo.ValidationTextBox.prototype.markupMethods,D=mstrmojo.string,A=function(){return mstrmojo.locales.datetime;},C=mstrmojo.date;mstrmojo.DateTextBox=mstrmojo.declare(mstrmojo.ValidationTextBox,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.DateTextBox",calendarToBody:false,calendarZIndex:100,changeValueOnOK:false,dynDateValue:null,showAdvanced:false,canSelectDisabledDate:false,isList:false,dtp:14,defaultDate:null,autoFormat:true,enabled:true,min:"",max:"",markupString:'<div id="{@id}" class="mstrmojo-DateTextBox {@cssClass}" style="{@cssText}"><input class="mstrmojo-DateTextBox-input" type="text" title="{@tooltip}"value="{@value}" size="{@size}" maxlength="{@maxLength}" index="{@tabIndex}" mstrAttach:focus,keyup,blur /><div class="mstrmojo-DateTextBox-icon" mstrAttach:click> </div><div class="mstrmojo-DateTextBox-popup"></div></div>',markupSlots:{inputNode:function(){return this.domNode.firstChild;},iconNode:function(){return this.domNode.childNodes[1];},popupNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?this.cssDisplay:"none";},onwidthChange:function(){if(this.width){this.inputNode.style.width=(this.width-20)+"px";this.iconNode.style.left=(this.width-18)+"px";this.domNode.style.width=this.width+"px";}},onvalueChange:B.onvalueChange,onenabledChange:B.onenabledChange,onvalidationStatusChange:B.onvalidationStatusChange},calConfig:null,calendar:{scriptClass:"mstrmojo.Popup",cssClass:"mstrmojo-DateTextBox-calendar",locksHover:true,slot:"popupNode",onOpen:function(){var H=this.opener,G=H&&H.calendarZIndex,I=this.cal,E=H&&H.calConfig;if(G){this.domNode.style.zIndex=G;}for(var F in E){I.set(F,E[F]);}},children:[{scriptClass:"mstrmojo.Calendar",alias:"cal",forceNonEmptySelection:true,bindings:{showAdvanced:"this.parent.opener.showAdvanced",dtp:"this.parent.opener.dtp",value:"this.parent.opener.value",dynDateValue:"this.parent.opener.dynDateValue",enabled:"this.parent.opener.enabled",min:"this.parent.opener.min",max:"this.parent.opener.max",canSelectDisabledDate:"this.parent.opener.canSelectDisabledDate",changeValueOnOK:function(){var F=this.parent.opener.dtp,E=this.parent.opener.changeValueOnOK;return F===15||F===16||E;}},closeOnValueChange:true,onValueUpdate:function(F){var I=this.parent&&this.parent.opener;if(I){var G=I.value,E=window.mstrConfig&&window.mstrConfig.listSep||";",H=I.dtp===15?C.formatTimeInfo(this.timeVal,A().TIMEOUTPUTFORMAT):this.value;if(I.isList&&!D.isEmpty(G)){I.set("value",I.value+E+H);}else{I.set("dynDateValue",this.dynDateValue);I.set("value",H);}I.closePopup();}}}]},onclick:function(E){var F=this._lastOpened,G=this._calendarConfig;if(!G){G={};if(this.calendarToBody){delete this.calendar.slot;G.placeholder=document.body.appendChild(document.createElement("div"));G.nudge=function(){var M=this.opener;if(M){var H=mstrmojo.dom.position(M.popupNode,true),L=this.domNode,P=L.offsetHeight,I=L.offsetWidth,J=mstrmojo.dom.windowDim(),K=H.x,N=H.y;if(N+P>=J.h){N=Math.max(N-P,0);}if(K+I>=J.w){K=Math.max(K-I,0);}var O=L.style;O.top=N+"px";O.left=K+"px";}};}this._calendarConfig=G;}G.lockIW=this;if(F&&F.visible){this.closePopup();}else{this.openPopup("calendar",G);this.calendar.cal.updateSelectedDate(true);}},unrender:function(){this._super();if(this.calendarToBody&&this._calendarConfig){delete this._calendarConfig;}if(this.calendar.hasRendered){this.calendar.unrender();}},_set_value:function(H,F){var G=this.value,E=(G!==F);if(E){this.value=F;this.validate(F);}if(this.showAdvanced&&this.dynDateChanged){this.dynDateChanged=false;E=true;}return E;},_set_dynDateValue:function(H,F){var G=this.dynDateValue,E=(G!==F);if(E){this.dynDateValue=F;this.dynDateChanged=true;}return E;}});})();(function(){mstrmojo.requiresCls("mstrmojo.vi.ui.tabs.TabStrip","mstrmojo.vi.ui.tabs.Tab","mstrmojo.ME.MetricEditBox","mstrmojo.array","mstrmojo.hash");var Z=mstrmojo.array,M=mstrmojo.hash,K=mstrmojo.ME.MetricToken.brackets,L=mstrmojo.dom,B=mstrmojo.css,Q=mstrmojo.vi.ui.tabs.Tab.ACTIONS,g=Q.DELETE+Q.RENAME,j=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,D=mstrmojo.string,l="This@ID",T="45C11FA478E745FEA08D781CEA190FE5";function G(p){return{n:p,k:p,ftk:[],vs:1,is:""};}function O(v,w,p,t){var r=v.forms[w]||{},u=v.forms[p],q=v.inputBox;if(w!==p){r.vs=v.vStatus;r.is=v.iStatus;r.ftk=q.items;v.set("vStatus",j.UNKNOWN);}v.set("vStatus",u.vs);v.set("iStatus",u.is);v.updateInputBoxItems({items:u.ftk});if(v.curFormIdx!==p){v.curFormIdx=p;v.tabstrip.setSelectedTab(u.k);}v.raiseEvent({name:"tabSwitch",tks:u.ftk,vs:u.vs,is:u.is,oidx:w,nidx:p,toNewTab:t});}function N(q){var p=q.forms[q.curFormIdx];if(p){p.ftk=q.inputBox.items;p.vs=q.vStatus;p.is=q.iStatus;}}var e=0;function W(p){e=Math.max(p.length-1,e);}function V(){e=0;}function m(p){var q="DESC"+(e?" "+e:"");e++;if(Z.find(p,"n",q)>=0){return m(p);}return q;}function I(u){var r={v:K(u.n),oi:u,isNew:true},q,p;if(u.t===12){q=Z.filter(u.fs,function(t){return t.obf||u.da;}).length;if(q===1){p=u.fs[0];r=M.copy({v:K(u.n)+"@"+K(p.fnm),ift:true,exv:p.fid,extp:8},r);}else{r=M.copy({v:K(u.n)+"@",ift:true},r);}}return r;}function E(q,p){q.set("enabled",!p);var r="mstrmojo-InlineWaitIcon";if(q.iconClass){q.set("iconClass",q.iconClass.replace(new RegExp(r),"")+" "+(p?r:""));}else{mstrmojo.css.toggleClass(q.domNode,r,p);}}var U=function(z){var t=z.items,u=t.length,v=t[t.length-1],r,q,x=[],p="",w;if(t[0]&&t[0].tp!==33){x.push({v:"!",tp:33,lv:4,sta:2});}for(r=0;r<u;r++){q=t[r];if(q.isNew&&!q.oi){p+=q.v;}else{if(!D.isEmpty(p)){x.push({v:p,tp:2,lv:1});p="";}if(q.v&&q.v.indexOf(l)>=0){q.v=q.v.replace("["+l+"]",l);q.exv=T;q.extp=8;delete q.oi;}x.push(q);}}if(!D.isEmpty(p)){x.push({v:p,tp:2,lv:1});p="";}if(v&&v.tp!==-1){x.push({v:"",tp:-1,lv:4,sta:2});}return{items:x};},a=function(r){var p=r.items||[],q=p[p.length-1];if(q&&q.tp===-1){p.pop();}if(p[0]&&(p[0].tp===33||p[0].tp===37)){p.splice(0,1);}Z.forEach(p,function(t){if(t.v&&t.v.indexOf(l)>=0){M.copy({extp:8,exv:T,oi:{n:"This",did:"This",t:12}},t);}});},Y=function(p){if(!p){return j.VALID;}return{"-2147214845":j.ERROR,"-2147214846":j.AMBIGUITY}[p]||j.ERROR;},R=function(r){r=U(r);var q={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true,vtp:true},p={getArrItemName:function(){return"tkn";},isSerializable:function(t){return(q[t])?true:false;}};return D.json2xml("tknstrm",r,p);},F=function(r,v,u,q){var t=R(v),w=function(x){if(x&&x.tks){var z=x.tks;a(z);z.vs=Y(z.rjec);z.tokenXML=t;if(q){q(z);}}},p=function(x){mstrmojo.alert(x.message||x.getResponseHeader&&x.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:t,localSymbolFolderXML:"",metricXML:"",metricId:r||"",isNew:true,objectType:12,isIDForm:u,msgID:mstrApp.getMsgID()},{success:w,failure:p});};mstrmojo.ME.DerivedAttributeFormTab=mstrmojo.declare(mstrmojo.vi.ui.tabs.Tab,null,{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",valid:true,editable:true,postBuildRendering:function S(){if(this._super){this._super();}var p=this,q=p.lbl;q.editOnDoubleClick=this.editable;q.onTextEditComplete=function(t,r){if(p.validate(q.text)){p.titleEdited(q.text,r);}};},onclick:function d(p){var q=mstrmojo.dom.eventTarget(p.hWin,p.e);if(q===this.menuBtnNode){this.tabDeleted();}else{if(!this.isSelected){this.tabSelected();}}},validate:function(p){var q=!/[\[\]\"\\]/g.test(p);if(!q){this.lbl.set("isEditing",true);}this.set("valid",q);return q;},showErrTooltip:function o(u,r){var p=mstrmojo.dom.position(this.domNode),q=this,t=q.errTooltip;if(!t){q.errTooltip=t=new mstrmojo.Tooltip({contentNodeCssClass:"me-tooltip-content up me-err",updatePopupConfig:null});this.addDisposable(t);}t.set("top",p.y+p.h+2);t.set("left",p.x+p.w/2-r);t.set("content",'<div class="content"><span>'+u+"</span></div>");t.open();window.setTimeout(function(){t.close();},2500);},onvalidChange:function(){if(this.valid){this.hideTooltip();}else{this.showErrTooltip(mstrmojo.desc(11569,"Input contains invalid character"),95);}}});function f(t,u,v){var r=Z.find(u,"k",v.k);return{scriptClass:"mstrmojo.ME.DerivedAttributeFormTab",title:v.n,draggable:false,editable:r!==0,cssClass:"mstrmojo-AEB-Tab "+(r===0?"mstrmojo-AEB-IDTab":""),getMenuActions:function(){return g;},tabSelected:function(){O(t,t.curFormIdx,r);},titleEdited:function q(x,w){if(x!==w){if(Z.find(t.forms,"n",x)>=0){this.showErrTooltip(mstrmojo.desc(7209,"Name already exists"),69);}var z=t.forms[r];z.n=x;}},tabDeleted:function p(){var w=t.forms.length,AA=(t.curFormIdx===w-1)?0:t.curFormIdx,x=t.forms.slice(0),z=x[r];if(z&&z.did){t.delForms.push({n:z.n,did:z.did});}x.splice(r,1);t.curFormIdx=AA;t.set("forms",x);O(t,-1,AA);t.set("dirty",true);}};}mstrmojo.ME.AttributeEditBox=mstrmojo.declare(mstrmojo.ME.MetricEditBox,null,{scriptClass:"mstrmojo.ME.AttributeEditBox",markupString:'<div id="{@id}" class="mstrmojo-MEBox {@cssClass}" style="{@cssText}"><div class="mstrmojo-AEB-TabStrip"></div><div class="mstrmojo-MEBox-edit mstrmojo-AEB-edit"></div><div class="mstrmojo-MEBox-status {@statusCssClass}"><div class="mstrmojo-MEBox-vStatus"></div><div class="mstrmojo-MEBox-iStatus"></div></div></div>',markupSlots:{tabstripNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},statusNode:function(){return this.domNode.lastChild;},iStatusNode:function(){return this.domNode.lastChild.lastChild;},vStatusNode:function(){return this.domNode.lastChild.firstChild;}},forms:null,delForms:[],curFormIdx:0,attrid:null,absorbAmbiguity:false,init:function k(r){var t=this;t.children=[{scriptClass:"mstrmojo.vi.ui.tabs.TabStrip",alias:"tabstrip",position:"top",slot:"tabstripNode",isAlignRight:false,getTabCfg:function q(w,x,v){return M.copy(f(t,w,x),v);},addTab:function u(){var x=t.forms,v=x.length,z=m(x),w=x.slice(0);w.push(G(z));t.set("forms",w);O(t,t.curFormIdx,v,true);t.set("dirty",true);},clear:function p(){Z.forEach(this.children,function(v){v.hideTooltip();});}},{scriptClass:"mstrmojo.Button",alias:"clearBtn",slot:"tabstripNode",text:mstrmojo.desc(1763,"Clear All"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-clearAll",onclick:function(){t.inputBox.clearTokens([]);}},{scriptClass:"mstrmojo.Button",alias:"validateBtn",slot:"tabstripNode",text:mstrmojo.desc(11897,"Validate"),cssClass:"mstrmojo-WebHoverButton mstrmojo-AEB-validate",onclick:function(){t.validateCurrentForm();}}].concat(this.children);this._super(r);},item2textCss:function J(p){return this._super(p)||{21:"afm"}[p.t]||"";},onformsChange:function X(){var p=this.forms,q=p[this.curFormIdx].k;Z.forEach(p,function(r){a({items:r.ftk});});this.tabstrip.setTabs(p,q);W(p);},selectFormTab:function A(p){O(this,this.curFormIdx,p);},postBuildRendering:function S(){if(this._super){this._super();}this.clear();var p=this;this.inputBox.ondrop=function(z){if(!z.src.data||!z.src.data.item){return ;}var x=p.inputBox,u=x.ctxtBuilder.itemWidgets,v=M.copyProps(["did","n","t","fs"],z.src.data.item),t=I(v),w,q,r;z.src.data=t;mstrmojo.ListBase2.prototype.ondrop.call(this,z);if(p.ontokensModify){p.ontokensModify();}w=this.selectedIndices;if(v.t===12&&t.ift&&!t.exv){for(q in w){r=u[q];if(r){x.startTokenSuggestion(r);}}}x.clearSelect(true);B.removeClass(x.domNode,"unselectable");};},clear:function c(){this.curFormIdx=0;this.delForms=[];this.attrid=null;V();this.set("forms",[G("ID")]);this.inputBox.set("items",[]);this.inputBox.resetTokensCache();this.set("vStatus",j.UNKNOWN);this.set("iStatus","");this.tabstrip.clear();},validateCurrentForm:function C(q){var r=this,t=this.validateBtn,p=function(u){E(t,false);r.set("vStatus",u.vs);r.set("iStatus",u.rjed||"");r.updateInputBoxItems({items:u.items});r.statusNode.style.display="block";r.handleValidation(u);if(q){q(u.items,u.vs===j.VALID);}};r.set("vStatus",j.VALIDATING);E(t,true);F(this.attrid,{items:this.inputBox.items},r.curFormIdx===0,p);},validateAllForms:function n(r){var t=this,q=t.forms,p=0,u=function(x){var w=(p===0);if(x){var v=q[p-1];v.ftk=x.items;v.vs=x.vs;v.is=x.rjed||"";v.tokenXML=R({items:x.items});if(x.vs!==j.VALID){t.selectFormTab(p-1);t.handleValidation(x);if(r){r(null,false);}return ;}}if(p===q.length){if(r){r(q,true);}return ;}F(t.attrid,{items:q[p++].ftk},w,u);};N(t);u();},continueValidataion:function P(){this.validateCurrentForm();},getStatusDesc:function b(p){return{0:mstrmojo.desc(11655,"Valid Formula.")}[p];},onvStatusChange:function h(){this.statusNode.style.display=this.vStatus>=j.VALIDATING?"block":"none";},onObjectInsert:function H(t){var u=this.inputBox,r=I(t),p=u.insertTokens([r]),q;if(t.t===12&&r.ift&&!r.exv){q=u.ctxtBuilder.itemWidgets[p];if(q){u.startTokenSuggestion(q);}}}});mstrmojo.ME.AttributeEditBox.preprocessTokenStream=a;mstrmojo.ME.AttributeEditBox.postprocessTokenStream=U;mstrmojo.ME.AttributeEditBox.mapErrorCode=Y;mstrmojo.ME.AttributeEditBox.getTokenStreamXML=R;mstrmojo.ME.AttributeEditBox.validateSyntax=F;mstrmojo.ME.AttributeEditBox.prepareInsertToken=I;}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.PreviewButton","mstrmojo.ui.editors.controls.AdvancedColorPicker","mstrmojo.ui.editors.controls.AdvancedColorPickerPopup","mstrmojo.css");var F=mstrmojo.css,E=Math.round;function I(N){var O=this.previewNode,M=O.offsetWidth,P=O.offsetHeight,Q=Math.sqrt(M*M+P*P),L=Math.atan2(P,M)*(-180)/Math.PI;O.style.backgroundColor="#FFFFFF";N.display="block";N.top=E(P/2)+"px";N.left=E((M-Q)/2)+"px";N.width=E(Q)+"px";N[mstrmojo.dom.CSS3_TRANSFORM]="rotate("+E(L)+"deg)";}mstrmojo.ui.editors.controls.ColorPickerButton=mstrmojo.declare(mstrmojo.ui.editors.controls.PreviewButton,null,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onselectedValueChange:function(){this.updatePreview();this.colorPicker.set("color",this.selectedValue);},onautoPreviewColorChange:function C(){this.getPopupWidget().set("autoPreviewColor",this.autoPreviewColor);this.updatePreview();},onenabledChange:function G(){F.toggleClass(this.domNode,"disabled",!this.enabled);}},isHostedWithin:false,showGradient:true,showNoFill:true,showAutomatic:false,autoPreviewColor:null,selectedValue:null,init:function K(M){this._super(M);var L=this.colorPicker;L.showGradient=this.showGradient;if(this.showNoFill!==undefined){L.showNoFill=this.showNoFill;L.showAutomatic=this.showAutomatic;}L.showAutomatic=this.showAutomatic;F.addWidgetCssClass(this,"mstrmojo-ColorPickerBtn");},preBuildRendering:function J(){this.colorPicker.showNoFill=this.showNoFill;return this._super();},setDimensions:function H(M,L){this._super(M,L);window.setTimeout(function(){this.updatePreview();}.bind(this),0);},postBuildRendering:function A(){var L=this.noFillNode=document.createElement("div");L.style.display="none";L.className="slash";this.domNode.firstChild.appendChild(L);this._super();},updatePreview:function B(){var P=this.previewNode;if(P){var N=this.selectedValue===mstrmojo.ui.editors.controls.AdvancedColorPicker.VAL_AUTOMATIC?this.autoPreviewColor:this.selectedValue;if(N){var Q=P.style;if(N.c1){var R=F.buildGradient(N.or,N.c1,N.c2);if(R&&R.n){Q[F.convertCssToCamelCase(R.n)]=R.v;}}else{var L=F.buildGradient(0,"0","0");if(L&&L.n){Q[F.convertCssToCamelCase(L.n)]=null;}var O="conflict"===N||("transparent"===N&&!this.showNoFill);F.toggleClass(P,"conflict",O);Q.backgroundColor=!O?N:null;}if(this.showNoFill&&this.noFillNode&&this.enabled){var M=this.noFillNode.style;if("transparent"===N){I.call(this,M);}else{M.display="none";}}}}},getPopupWidget:function D(){return this.colorPicker;},children:[{scriptClass:"mstrmojo.ui.editors.controls.AdvancedColorPickerPopup",alias:"colorPicker",slot:"widgetHostNode",color:this.selectedValue,isHostedWithin:true,colorChanged:function(L){this.parent.set("selectedValue",L);this.close();}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.string","mstrmojo.form","mstrmojo._FormatDefinition","mstrmojo.ME.MetricDataService","mstrmojo.ME.MetricEditBox","mstrmojo.mstr.EnumDataType","mstrmojo.ME.Enum");mstrmojo.requiresDescs(218,219,221,531,628,1442,1918,2102,2116,2154,2213,2919,5298,5424,5728,5891,7558,7984,7987,11566,13249);var F=mstrmojo.string,n=mstrmojo.mstr.EnumDataType,A=mstrmojo.ME.MetricDataService;function R(t){var p=t.items,S=p.length,r="",q;for(q=0;q<S;q++){r+=p[q].v;}return r;}var J=mstrmojo.dom,E=mstrmojo.string,P=mstrmojo._FormatDefinition,k=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS,C=mstrmojo.ME.Enum.METRIC_EDIT_TYPES;var U=function(S){if(!S){return k.VALID;}return{"-2147214845":k.ERROR,"-2147214846":k.AMBIGUITY}[S]||k.ERROR;},T=function(w){var t=w.items,p=t.length,v=t[t.length-1],r,u,q=[],S="";if(t[0]&&t[0].tp!==38){q.push({v:"&",tp:38,lv:4,sta:2});}for(r=0,p=t.length;r<p;r++){u=t[r];if(u.isNew&&!u.oi){S+=u.v;}else{if(!E.isEmpty(S)){q.push({v:S,tp:2,lv:1});S="";}q.push(u);}}if(!E.isEmpty(S)){q.push({v:S,tp:2,lv:1});S="";}if(v&&v.tp!==-1){q.push({v:"",tp:-1,lv:4,sta:2});}return{items:q};},N=function(q){var r=T(q.tks);var p={items:true,v:true,tp:true,lv:true,oi:true,n:true,did:true,t:true,st:true,exv:true,extp:true,asc:true},S={getArrItemName:function(w,t,u){return"tkn";},isSerializable:function(v,u,t){return(p[v])?true:false;}};return E.json2xml("tknstrm",r,S);},j=function(r){var p=r.items,S=p.length,q=p[p.length-1];if(q&&q.tp===-1){p.pop();}if(p[0]&&p[0].tp===38){p.splice(0,1);}},l=function(S){return"";},g=function(S,q){var p=[];S.oi.tks.items=p;q.clearTokens(p);},K=function(u,t){var r=[];r.push("<mt>");if(u.fmt&&!t){var S={getArrItemName:function(z,w,x){return z.substr(0,z.length-1);},isSerializable:function(AD,AB,AA){if(mstrmojo.array.indexOf(["header_format","grid_format"],AD)>-1){var AE=AB[AA][AD];if(!AE){return{};}var x="<"+AD+">",AC;for(AC in AE){x+="<prs n='"+AC+"'>";var w=AE[AC],v;for(v in w){var z=w[v];x+="<pr n='"+v+"' v='"+(z==="pru"?"":z)+"'";x+=z==="pru"?' pru="1"':"";x+="/>";}x+="</prs>";}x+="</"+AD+">";return{child:x};}return true;},skipNull:true};r.push(E.json2xml("fmt",u.fmt,S));}if(u.prss&&!t){var q={getArrItemName:function(z,w,x){return z.substr(0,z.length-1);},isSerializable:function(AD,AA,x){if(mstrmojo.array.indexOf(["AnalyticalEngineProperties","DatamartProperties","VLDBSelect","VLDBFunction","VLDBReport"],AD)>-1){var z=AA[x][AD];if(!z){return{};}var w=[],AB=[],AC;w.push("<prs n='"+AD+"' ");for(AC in z){var v=z[AC];if(v!=null){if(typeof v==="object"){AB.push(E.json2xml("pr",v,{skipNull:true,convertBoolean:true,isSerializable:function(AG,AF,AE){return true;}}));}else{w.push(AC+"='"+v+"' ");}}}w.push(">");w.push(AB.join(""));w.push("</prs>");return{child:w.join("")};}return true;},skipNull:true};r.push(E.json2xml("prss",u.prss,q));}if(u.mps){r.push(E.json2xml("mps",u.mps,{skipNull:true,convertBoolean:true,isSerializable:function(x,w,v){return true;}}));}if(u.datp&&!t){r.push(E.json2xml("datp",u.datp,{skipNull:true,convertBoolean:true,isSerializable:function(x,w,v){return true;}}));}if(u.sbs&&!t){var p={getArrItemName:function(z,w,x){return(z==="avs")?"sb":z.substr(0,z.length-1);},isSerializable:function(x,w,v){return true;},skipNull:true};r.push(E.json2xml("sbs",u.sbs,p));}r.push("</mt>");return r.join("");},G=function(p,S){p.set("enabled",!S);var q="mstrmojo-InlineWaitIcon";if(p.iconClass){p.set("iconClass",p.iconClass.replace(new RegExp(q),"")+" "+(S?q:""));}else{mstrmojo.css.toggleClass(p.domNode,q,S);}},H=function(p,S){var q={taskId:"saveMetricDefinition",tokenStreamXML:N(p),localSymbolFolderXML:l(p),metricXML:K(p),metricId:p.did||"",outputFlags:327695,description:p.desc||"",name:p.n||"",saveAs:S};if(E.isEmpty(p.metricId)){q.isNew=true;}return q;},M=function(q){var p=function(r){var u=this.parent;var t=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##","Object").replace("'###'","");if(u){u.ob.refreshContent();u.onObjectSaved({name:u.name,did:r.did,desc:u.desc});t=mstrmojo.desc(7987,"The ## '###' has been saved successfully.").replace("##",u.typeDesc||"Object").replace("###",u.name);}mstrmojo.alert(t,q.onSaved,mstrmojo.desc(7984,"Object Saved"));if(u){u.close();}q.dirty=false;},S={success:p,failure:mstrmojo.SaveAsEditor.SAVEAS_CALLBACK.failure};return S;},L=function(w,t){var q=this;G(q,true);var x=mstrmojo.ME._MetricEditorHelper.oi=w.oi,r=N(x),u=l(x),v=K(x,true),z=function(AA){if(AA&&AA.tks){var AB=AA.tks;j(AB);x.tks=AB;w.checkEditorFallback(w.ide.candidates.items,x);AB.vs=U(AB.rjec);w.set("vStatus",AB.vs);w.set("iStatus",AB.rjed||"");if(w.handleValidation){w.handleValidation(AB);}if(t&&(AB.vs===k.VALID)){switch(t){case"save":case"saveAs":if(w.isDME){w.handleDerivedMetricAction(t,x);}else{w.handleMetricAction(t,x);}break;case"switch":if(w.cbSwtichEditor){w.cbSwtichEditor(w);}break;}}else{if(t&&AB.vs===k.ERROR){mstrmojo.alert(mstrmojo.desc(9826,"The metric definition has an error. Please correct before proceeding."),null,mstrmojo.desc(9571,"Syntax Error!"));}}}},p=function(AA){mstrmojo.alert(AA.message||AA.getResponseHeader("X-MSTR-TaskFailureMsg"));},S=function(AA){G(q,false);};mstrmojo.ME.MetricDataService.validateMetric({tokenStreamXML:r,localSymbolFolderXML:u,metricXML:v,metricId:x.did,isNew:E.isEmpty(x.did),msgID:w.ide.isDME?mstrApp.getMsgID():null},{success:z,failure:p,complete:S});},D=function(p,r){var t=r,S=t.oi.fmt,q=P.MetricFormatTarget;G(p,true);window.setTimeout(function(){if(!S){S=t.oi.fmt={};var u;for(u=0;u<q.length;u++){S[q[u].p]={};}}var v=J.position(p.domNode,true);t.openPopup("formatPopupRef",{zIndex:t.zIndex+10,model:S,left:Math.max(0,(v.x-(t.formatPopupRef.width||565)))+"px",top:v.y+"px"});G(p,false);},50);},e=function(q,r){var t=r,S=t.oi,p=function(){var u=J.position(q.domNode,true);t.openPopup(mstrmojo.all.mstrMEOptionsDialog||"optionPopupRef",{zIndex:t.zIndex+10,model:S,funcs:t.funcs,left:Math.max(0,(u.x-(t.optionPopupRef.width||565)))+"px",top:u.y+"px"});};if(!t.isDME&&!t.funcs){G(q,true);mstrmojo.ME.MetricDataService.getSubtotalFunctions(null,{success:function(u){if(u.items){t.funcs=u.items;p();G(q,false);}},failure:function(u){mstrmojo.alert(u.message||u.getResponseHeader("X-MSTR-TaskFailureMsg"));G(q,false);}});}else{p();}};mstrmojo.ME._MetricEditorHelper=mstrmojo.provide("mstrmojo.ME._MetricEditorHelper",{noCache:true,useKeyDelay:true,tbBrowsable:true,functionNameRef:{scriptClass:"mstrmojo.Label",alias:"fnLabel",cssClass:"mstrmojo-ME-fct-name",bindings:{visible:function(){return !this.parent.insertMode;},text:function(){return mstrmojo.desc(5424,"Function:")+" "+this.parent.fctName;}}},nameEditBoxRef:{scriptClass:"mstrmojo.Box",alias:"nameEditBox",cssClass:"mstrmojo-ME-nameEditBox",cssDisplay:"inline-block",visible:false,bindings:{visible:function(){return !this.parent.insertMode&&this.parent.visible;}},onvisibleChange:function(S){if(S.value==false){return ;}var p=this;if(!p.tmr){p.tmr=window.setInterval(function(){if(p.domNode){window.clearInterval(p.tmr);delete p.tmr;p.nameInput.inputNode.select();}},50);}},children:[{alias:"nameInput",scriptClass:"mstrmojo.TextBoxWithLabel",inputNodeCssClass:"mstrmojo-ME-nameInput",value:mstrmojo.desc(2213,"New metric"),size:20,useRichTooltip:true,showErrTooltip:function o(){var p=J.position(this.domNode),S=E.isEmpty(this.value)?mstrmojo.desc(9122,"Name cannot be empty"):mstrmojo.desc(11569,"Input contains invalid character");this.richTooltip={contentNodeCssClass:"me-tooltip-content left me-err",content:'<div class="content"><span>'+S+"</span></div>",top:p.y-5,left:p.x+p.w+10};this.hasOpenTooltip=false;this.showTooltip();},bindings:{value:function(){var S=this.parent.visible;return this.parent.parent.oi.alias||this.parent.parent.oi.n;},label:function(){var p=this.parent.parent.ide||{},S=p.nameLabel||mstrmojo.desc(11566,"Metric Name:");return this.parent.parent.oi.alias?mstrmojo.desc(13249,"Display Name:"):S;}},onvalueChange:function(q){var S=this.parent.parent.ide.action.alias,v=function(w){return !E.isEmpty(w)&&(S?true:!/[\[\]\"\\]/g.test(w));},u=v(this.value);if(u){this.hideTooltip();}else{this.showErrTooltip();}mstrmojo.css.toggleClass(this.parent.domNode,"err",!u);var r=this.parent.parent;r.set("cValid",u);var t=r.oi;if(t){var p={n:t.n,alias:t.alias};t.n=this.value;t.alias=this.value;if(t.n!==p.n&&t.alias!==p.alias){r.dirty=true;}}}}]},saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:"Metric",browsableTypes:"4,8",onObjectSaved:function(r){var q=this.opener,S=q&&q.oi;if(q&&S){S.did=r.did;S.n=r.name;S.desc=r.desc;q.set("title",mstrmojo.desc(2154,"Metric:")+" "+r.name);}}},optionPopupRef:{id:"mstrMEOptionsDialog",scriptClass:"mstrmojo.ME.OptionDialog",title:mstrmojo.desc(9572,"Advanced Metric Options"),help:"Advanced_Metric_Options_dialog_box.htm",height:340},formatPopupRef:{scriptClass:"mstrmojo.ME.MetricFormatEditor",contentNodeCssClass:"mstrmojo-balloon",alias:"formatEditor",title:mstrmojo.desc(2116,"Format"),left:"100px",top:"100px",useAnimate:false,height:360,width:565,help:"Format_Metric_dialog_box.htm",locksHover:true},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:200px;",fishEyeVisible:false,closeable:false,closeOnSelect:false}]},switchRef:{scriptClass:"mstrmojo.Button",slot:"buttonNode",alias:"switchToMetricEdtior",cssClass:"mstrmojo-ME-switch mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(9563,"Switch to Formula Editor"),closeAfterSwitch:true,bindings:{visible:function(){return !this.parent.insertMode;}},getEditor:function(){return this.parent;},getFormulaEditorId:function(){var S=this.getEditor();return(S.ide&&S.ide.formulaEditorId)||"mstrME";},onclick:function(){var q=this.getEditor(),p=this.getFormulaEditorId();q.oi.tks.items=q.getMetricDefAsTokens();var S={vStatus:mstrmojo.ME.MetricEditBox.VALIDATION_STATUS.UNKNOWN,oi:q.oi,did:q.oi.did};if(q.dirty){S.dirty=q.dirty;}q.switch2Editor(p,S);if(q.ide){q.ide.set("showLeftPanel",true);q.set("simple",false);}}},formatAndOptionsBarRef:{scriptClass:"mstrmojo.HBox",alias:"formatbar",cssClass:"mstrmojo-ME-formatbar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link format",alias:"formatButton",text:mstrmojo.desc(1918,"Format"),bindings:{visible:function(){return this.parent.parent.tbFormatable&&!this.parent.parent.insertMode;}},onclick:function(){D(this,this.parent.parent);}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link property",alias:"optButton",text:mstrmojo.desc(13035,"Metric Options"),bindings:{visible:function(){var S=this.parent.parent;return !S.insertMode&&!S.ide.disableAFB;}},onclick:function(){e(this,this.parent.parent);}}]},saveLabel:mstrmojo.desc(5891,"Save"),saveAsLabel:mstrmojo.desc(628,"Save As"),closeLabel:mstrmojo.desc(221,"Cancel"),saveAsEnabled:true,cValid:true,buttonBarRef:{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton hot",alias:"saveokButton",text:"",bindings:{enabled:function(){return this.parent.parent.cValid;},text:function(){return this.parent.parent.insertMode?mstrmojo.desc(531,"Add"):this.parent.parent.saveLabel;}},onclick:function(){var p=this.parent.parent;if(!p.insertMode&&p.isDirty&&!p.isDirty()){p.close();p.onCancel();return ;}if(!p.cValid){return ;}if(p.insertMode){p.insertOnFinish(p.getMetricDefAsTokens());p.close();}else{if(p.getMetricDefAsTokens){p.oi.tks.items=p.getMetricDefAsTokens();}var S=this;if(p.validateAndSave){G(S,true);p.validateAndSave(p.oi,function(){G(S,false);});}else{if(p.ide&&p.ide.validateAndSave){G(S,true);p.ide.validateAndSave(p.oi,function(){G(S,false);});}else{p.tbValidate=this;L.call(this,p,"save");}}}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",alias:"btnSaveAs",text:mstrmojo.desc(628,"Save As"),bindings:{visible:function(){return !this.parent.parent.insertMode&&!this.parent.parent.isDME;},text:function(){return this.parent.parent.saveAsLabel;}},onclick:function(){var S=this.parent.parent;if(S.getMetricDefAsTokens){S.oi.tks.items=S.getMetricDefAsTokens();}S.tbValidate=this;L.call(this,this.parent.parent,"saveAs");}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",bindings:{text:function(){return this.parent.parent.closeLabel;}},onclick:function(){var S=this.parent.parent;if(S.onPreClose()){S.close();if(!S.insertMode){S.onCancel();}}}}]},validateSyntax:function B(S){L.call(S,this);},validateSyntaxAndSwitch:function Y(S){L.call(S,this,"switch");},preprocessTokenStram:function Q(S){j(S);},isDirty:function f(){if(this.insertMode){return false;}return this.dirty||this.oi.dirty||(this.oi.fmt||{}).dirty||(this.oi.mps||{}).dirty;},onmetricModify:function d(){this.dirty=true;},save:function O(){this.buttonBar.btnSaveAs.onclick();},prompt2saveRef:{scriptClass:"mstrmojo.Editor",cssText:"width:350px;",title:mstrmojo.desc(5728,"Confirm save"),children:[{scriptClass:"mstrmojo.Label",cssText:"margin:5px 5px 20px;",allowHTML:true,bindings:{text:function(){return mstrmojo.desc(9573,"Do you want to save changes made to #?").replace("#","<b>"+this.parent.opener.oi.n+"</b>");}}},{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"width:10px;"},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(219,"Yes"),onclick:function(){var S=this.parent.parent;S.opener.save();S.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(218,"No"),onclick:function(){var S=this.parent.parent;S.opener.close();if(S.opener.onCancel){S.opener.onCancel();}S.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var S=this.parent.parent;S.close();}}]}]},prompt2save:function(){if(this.getMetricDefAsTokens){this.oi.tks.items=this.getMetricDefAsTokens();}this.openPopup("prompt2saveRef",{zIndex:this.zIndex+1});},handleMetricAction:function b(q,p){var S=this;var r=H(p,false);if((q==="save")&&p.did){mstrmojo.xhr.request("POST",mstrConfig.taskURL,M(S),r);}else{if(((q==="save")&&E.isEmpty(p.did))||q==="saveAs"){r.saveAs=true;S.openPopup("saveasRef",{zIndex:S.zIndex+10,folderLinksContextId:17,name:p.n||p.name||(S.name&&S.name.value)||mstrmojo.desc(2213,"New Metric"),saveParams:r,saveAsCallback:function(){var t=M(S);if(t.success){var u=t.success;t.success=function(v){u.call(this,v);if(S.ide.noRefresh!==true){var w=mstrApp;mstrmojo.form.send({evt:5005,src:w.name+"."+w.pageName+".5005"});}};}return t;}});}}},handleDerivedMetricAction:function c(t,r){r=r||this.oi;if(t==="save"){var S={tokenStreamXML:N(r),alias:r.n};var p=r.mps||{};if(p.dirty){if(p.fbf===0){p.afb=p.sfb=-1;}S.afb=p.afb;S.sfb=p.sfb;}var u=mstrmojo.all.mstrMetricIDE,q=u.disableAFB;if(q){S.afb=0;S.sfb=1;}u.onApplyMetricCallback(S);u.close();}},onPreClose:function(){var S=this;if(S.isDirty&&S.isDirty()&&!this.isDME){S.prompt2save();return false;}return true;},onClose:function W(){this.dirty=false;if(this.onPostClose){this.onPostClose();}},init:function m(q){if(this._super){this._super(q);}var r=mstrApp,S=r&&r.useQuickSearch&&r.useQuickSearch(),p=S?((r&&r.searchAutoCompleteDelay&&r.searchAutoCompleteDelay())||0):0;this.suggestDelay=p||200;this.noCache=this.noCache&&S&&!this.isDME;this.ob.children[0].quickSearch=S;mstrmojo.ME.MetricDataService.suggestDelay=this.suggestDelay;mstrmojo.ME.MetricDataService.noCache=this.noCache;},_setupCandidatesCache:function h(S){if(this.candidates&&S){S.candidates=null;S.set("candidates",this.candidates);}},item2textCss:function I(S){return"mstrmojo-ME-icon t"+S.t+(S.st?" st"+S.st:(S.um||S.da?"d":""));},getSpecialFunctionEditorId:function a(S,r){var q=S&&S.did,p;if(q){if(mstrmojo.ME.MetricDataService.isBasicAggMap(q)){p="mstrSME";}else{if(mstrmojo.ME.MetricDataService.isRank(q)){p="mstrRFE";}else{if(A.isOLAPAgg(q)){p="mstrOFE";}else{p="mstrFE";}}}if(p){p+=r?"_1":"";}}return p;},isDimty:function(p,S){return(/^@[a-z]{1,}(\s*[+-]\s*\d{1,})?$/i).test(F.trim(p));},validateByDataType:function Z(p,S){var q=false;switch(p){case n.DataTypeInteger:q=/^(-)?\d+$/.test(S);break;case n.DataTypeNumeric:case n.DataTypeReal:case n.DataTypeDouble:q=mstrmojo.num.isNumeric(S);break;case n.DataTypeChar:case n.DataTypeVarChar:q=true;break;case n.DataTypeDate:case n.DataTypeTimeStamp:q=true;break;default:q=true;}return q;},getRootFunction:function X(q){var p,S=q&&q.tks&&q.tks.met;if(S!==C.ADVANCED){var r=q.tks.items[0];p=r&&r.oi;}return p;},checkEditorFallback:function V(S,r){var p=this.getRootFunction(r),q=mstrmojo.array.find(S,"did",p&&p.did)===-1;if(q&&r&&r.tks&&r.tks.items&&r.tks.items.length>0){r.tks.met=C.ADVANCED;}return q;}});mstrmojo.ME._MetricEditorHelper.getTokenStreamXML=N;}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.MetricSlider","mstrmojo.MetricQualification","mstrmojo.SearchBoxSelector","mstrmojo.TextBoxSelector","mstrmojo.css","mstrmojo.dom","mstrmojo.hash","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.mstr.EnumDataType","mstrmojo._IsSelectorTarget","mstrmojo.elementHelper","mstrmojo.MetricSelectorUtility","mstrmojo.mstr.EnumDSSXMLBaseFormType");mstrmojo.requiresDescs(4729,4730,4732,4733,4734,4735,5225,5443,6738,8967,12297);var L=mstrmojo.array,P=mstrmojo.hash,m=mstrmojo.dom,AN=mstrmojo.expr,w=AN.BFTP,AO=0,AJ=1,AR=2,AC=3,k=4,o=5,AE=6,e=7,z=8,AG=9,S=10,A=11,Y=mstrmojo.mstr.EnumDataType,AZ=mstrmojo.elementHelper,b=AZ.ELEM_ALL_ID,Aa=mstrmojo.func.wrapMethods,D=mstrmojo.mstr.EnumDSSXMLBaseFormType.DssXmlBaseFormHTMLTag,u=1,N=4,AB=12,AY=47,AH=3076,d=3077,C=257;mstrmojo.DocSelectorEvtType=null;var T={};T[e]="MetricSlider";T[z]="MetricQualification";T[AG]="SearchBoxSelector";T[S]="TextBoxSelector";var Ae=2;var q=function q(){var Af={type:parseInt(this.type,10),src:this.k,ck:this.ck,ctlKey:this.ckey,tks:this.tks,include:this.include,isUConDS:!!this.defn.dsTks};if(this.style===z||this.style===e){mstrmojo.hash.copy(Af,{srcid:this.srcid,srct:this.type,f:this.f,ft:this.ft,qt:this.qt,unset:!!this.unset,cs:this.cs});}return Af;},AF=function AF(){var Af=this.node.defn,Ai=this.node.data;var Aj={taskId:"browseElements",styleName:"MojoAttributeStyle",attributeID:Af.srcid||"",dataSourcesXML:Af.dsrc||"",browseFlags:1};var Ah=this,Ag={success:function(Ak){Ah.bGetElems=true;Ah.set("wait",false);if(Ak&&Ak.es){Ai.elms=(Af.srcid)?AZ.buildElemsTerseID(Ak.es,Af.srcid,true):Ak.es;var Al=Ah.parent,Am=Al&&Al.parent;if(Af.sec&&Ai.ces&&Ai.elms&&Ai.elms.length>0&&Al){Al.set("count",AZ.buildElemsCountStr(Ai.ces,Ai.elms));}if(Ah.hasRendered){Ah.refresh();if(Ah.isInFilterPanel()){if(Al&&Al.defn.ttl){Al.updateContentHeight();}if(Am&&Am.refreshFP){Am.refreshFP();}}}}},failure:function(Ak){mstrmojo.alert(Ak.getResponseHeader("X-MSTR-TaskFailureMsg"));}};this.set("wait",true);mstrmojo.xhr.request("POST",mstrConfig.taskURL,Ag,Aj,false,null,true);},U={getWidgetClass:function B(Ai,Ah,Ag){var Af=T[Ah];if(Af&&Af.constructor===Array){Af=Af[Ag?0:1];}return Af;},getWidgetConfig:function K(Al,Ah,Aj,Af){var Am=Ah===2?false:Aj.horiz,Ak=Al.getFormats(),An=Ak&&Ak.height,Ai={scriptClass:this.getWidgetClass(Al,Ah,Am),docSelector:Al,enabled:this.enabled,multiSelect:Aj.multi,isHoriz:Am,include:Aj.include,itemWidthMode:Aj.iwm,allIdx:L.find(Af,"v",mstrmojo.elementHelper.ELEM_ALL_ID),noneIdx:Aj.include?-1:L.find(Af,"v",mstrmojo.elementHelper.ELEM_ALL_ID),renderAllItems:!An,onchange:function Ag(){if(!Al._inSyncPhase){Al.selectorControlChange(this);}}};if(Ai.noneIdx!==-1){Ai.allIdx=-1;}if(Ak&&Ah===mstrmojo.DocSelector.STYLES.PULLDOWN){if(Ak.color){Ai.itemCssText="color: "+Ak.color+";";}if(Ak.font){Ai.itemCssText=(Ai.itemCssText||" ")+"font:"+Ak.font;}if(mstrApp.isExpress){Ai.cssTextClass="express";}}return Ai;},newSelectorWidget:function AU(Ao){var Al=Ao.style,Ah=Ao.node,An=Ah.defn,Ak=Ah.data,Af=Ak.elms||[],Ag,Am=this.getWidgetConfig(Ao,Al,An,Af),Aj=Am.scriptClass;if(!Aj){Ag=new mstrmojo.Label({cssClass:"unsupported",text:"This selector is not supported."});}else{delete Am.scriptClass;var Ai=P.walk(Aj,mstrmojo);Ag=new Ai(Am);}return Ag;},getCekEvtListener:function AS(Ag,Af){return function(Ah){var Aj=[],Ai=this.node.data.elms;L.forEach(Ah.value,function(Al){var Ak=L.find(Ai,"v",Al);if(Ak>-1){Aj.push(Ak);}});this.handleActionInSyncPhase(function(){if(Af&&Af.select){Af.select(Aj);}});};},newAndInitWidget:function l(Aj){var Al,Ah=Aj._cekEvtListener,Ag=Aj.node,Af=Ag.defn,Ai=Aj.id,Ak;if(Ah){Af.detachEventListener(Ah);delete Aj._cekEvtListener;}Al=this.newSelectorWidget(Aj);if(Al){Ak=this.getCekEvtListener(Aj,Al);}Ai=Ak.cekContextId||Ai;Ak=Ak.cekEvtListener||Ak;if(Ak){Aj._cekEvtListener=Af.attachEventListener("cekChange",Ai,Ak);}Aj.addChildren(Al);return Al;},updateWidget:function AP(Ag){var Af=Ag.children,Ah=Af&&Af[0];if(!Ah){Ah=this.newAndInitWidget(Ag);}else{Ah.set("enabled",this.enabled);}return Ah;}};function AL(Af){return Af.some(function(Ag){return this.style===Ag;},this);}function R(){var Af=this;return Af.model.getDatasetUnits(["mx"],function(Ag){return Ag.did===Af.defn.srcid;})[0]||{};}mstrmojo.DocSelector=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,U],{scriptClass:"mstrmojo.DocSelector",markupString:'<div id="{@id}" k="{@k}" class="mstrmojo-DocSelector {@cssClass} {@extCls}" nm="{@n}" title="{@tooltip}" style="{@domNodeCssText}"><div class="filter" style="{@filterNodeCssText}"></div><div class="wait" style="display:none;z-index:100;position:absolute;top:0;left:0;width:100%;height:100%"></div><div class="content" style="{@contentNodeCssText}"></div></div>',markupSlots:{filterNode:function(){return this.domNode.firstChild;},contentNode:function(){return this.domNode.lastChild;},dimNode:function(){return this.domNode.lastChild;},containerNode:function(){return this.domNode.lastChild;},scrollboxNode:function(){return this.domNode.lastChild;},wIconNode:function(){return this.domNode.childNodes[1];}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod,onheightChange:mstrmojo.Widget.heightMarkupMethod,onwidthChange:mstrmojo.Widget.widthMarkupMethod,onenableChange:mstrmojo.Widget.enabledMarkupMethod,onincludeChange:function(){mstrmojo.css.toggleClass(this.domNode,"strikeout",!this.include);},onwaitChange:function(){mstrmojo.css.toggleClass(this.domNode,"wait",!!this.wait);this.wIconNode.style.display=((this.wait)?"block":"none");}},_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},ckey:null,ck:null,tks:null,style:0,selIdx:null,extCls:"",min:-1,max:-1,bGetElems:false,n:"",_inSyncPhase:false,init:function t(Af){this._super(Af);if(mstrmojo.dom.isIE){this.formatHandlers=this._ieformatHandlers;}this.n=Af.node.defn.n;},_fetchOnInit4UCOnDS:function AD(Af){if(!this.bGetElems&&parseInt(this.node.defn.subTp,10)===Ae){AF.apply(this);Af=this.node.data.elms;}return Af;},initControlInfo:function F(){var Ah=this.node,Ai=Ah.data,Al=Ah.defn,Af=Ai.elms,Aj=Ai.ces;var Am=["include","ckey","ck","tks","style","multi","showall"];Af=this._fetchOnInit4UCOnDS(Af,Ai);this.type=Al.ct;var An=Al.fmts;if(An){var Ao=An.width;if(!Ao||parseInt(Ao,10)<=0){An.width="95px";}}P.copyProps(Am,Al,this);var Ag=this.selIdx={},Ak=Al.multi;if((this.include||Al.style===AJ)&&Ak&&L.find(Aj,"v",mstrmojo.elementHelper.ELEM_ALL_ID)>-1){Aj=Af;}if(Aj){var Ap={};L.forEach(Aj,function(Aq){Ap[Aq.v]=true;});L.forEach(Af,function(Ar,Aq){if(Ap[Ar.v]){Ag[Aq]=true;}});}if(Al.min>=0){this.min=Al.min;}if(Al.max>=0){this.max=Al.max;}},resetFormatHandlers:function I(){this.formatHandlers={contentNode:["RW"]};},_getSelectionCount:function Z(Af){return P.keyarray(Af.selectedIndices).length;},canApply:function G(Aj){var Ai=this.defn,Ak=Ai.multi,Ah=this.min,Af=Ak?this.max:1,Ag=this._getSelectionCount(Aj||this.content);return(Ah>=0&&Af>=0&&Ah>Af)||((Ah<0||Ah<=Ag)&&(Af<0||Af>=Ag));},_buildEvent:mstrmojo.emptyFn,selectorControlChange:function M(Ai){var Ah=q.call(this),Ag=this.isInFilterPanel()&&this.getFilterPanel(),Af=(Ag&&Ag.defn.cas);this._buildEvent(Ah,Ai);if(!this.canApply(Ai)){var Aj=this.getPanelContainer();if(this.isInSearchBoxPanel(Aj)){Aj.set("canApplySbp",false);}if(Af){this.set("err",true);mstrmojo.alert(mstrmojo.desc(12297,"One or more selectors are incorrectly set. Please review the selector(s) and try again."));}if(Ag){Ag.set("applyEnabled",false);}return ;}if(Af){this.set("err",false);}if(mstrApp.isExpress&&this.node.defn.style===AO){this.handleExpressPulldown();}if(Ah.requireToggle){this.deferredEvt=Ah;this.set("include",false);this.deferredEvt=undefined;}else{this.slice(Ah);}},showInfoWin:function X(Ak){var An=this.node&&this.node.defn,Ah=An&&An.ifw,Ag=this.model,Ai=[].concat(Ag.getTargetInfoWin(Ah)).concat(Ag.getTargetInfoWin(this.tks));if(Ai&&Ai.length){var Ap=this.defn.horiz,Af=Ak||this.contentNode,Am=m.position(Af),Ao=m.position(this.contentNode),Al=(Ap||parseInt(this.defn.style,10)===AJ)?null:{x:Ao.x,y:Am.y,w:Ao.w,h:Am.h},Aj;for(Aj=0;Aj<Ai.length;Aj++){Ag.showInfoWin(Ai[Aj],Af,Ap?"v":"h",false,P.copy(Al));}}},unrender:function h(Af){delete this.formatHandlers;this._super(Af);},postBuildRendering:function Ad(){var Ah=this.node.defn.style,Aj=this.filterNode.style,Af=this.contentNode,Ag=this.node.defn;if(this.isInFilterPanel()&&!this.isHorizFP()){this.domNode.style.width=this.contentNode.style.width="100%";if(this.formatHandlers.filterNode){this.filterNode.style.width=this.contentNode.style.width="100%";}this.set("visible",parseInt(Ag.ds,10)===0);}this.handleActionInSyncPhase(this._super,this);if(mstrApp.isExpress&&Ah===AO){this.handleExpressPulldown();}if(this.isInFilterPanel()&&this.parent.adjustFP){this.parent.adjustFP();}if(this.formatHandlers.filterNode){var Ai=this.getFormats();if(!Ai.width){Aj.width=Af.clientWidth+"px";}if(!Ai.height){Aj.height=Af.clientHeight+"px";}}else{Aj.display="none";}this.model.attachEventListener("CGBMapChange",this.id,"onCGBMapChange");if(m.isAndroid&&Ah===AJ){Af.style.overflow="visible";}return true;},updateHeight:function AT(){this.contentNode.style.height=this.filterNode.style.height=this.content.getClientHeight()+"px";var Af=this.parent;if(Af&&(Af.defn.ttl!==undefined)&&Af.updateContentHeight){Af.updateContentHeight();}},handleExpressPulldown:function E(){var Ah=this.model.getZoomFactor();if(Ah!==1){var Ai=this.contentNode.firstChild.firstChild;var Aj=parseInt(window.getComputedStyle(Ai).height);var Af=Aj*Ah+"px";Ai.style.height=Af;Ai.style.lineHeight=Af;}var Ag=document.createElement("DIV");Ag.setAttribute("class","mstrmojo-ui-Pulldown-arrow");Ag.setAttribute("src","#");this.contentNode.firstChild.appendChild(Ag);},handleActionInSyncPhase:function AQ(Ah,Ag){var Af=this._inSyncPhase;this._inSyncPhase=true;try{if(Ag){Ah.call(Ag);}else{Ah();}}catch(Ai){throw ("There was an error handling the selector action in sync phase.");}this._inSyncPhase=Af;},onCGBMapChange:function AV(Ag){var Af=Ag.cgbMap;if(!Af){return ;}var Ah=this.tks;P.forEach(this.defn.cgb,function(Aj){var Ai=Af[Aj];if(Ai&&Ah.indexOf(Ai)<0){Ah+="\u001E"+Ai;}});this.tks=Ah;},update:function V(Aj){this._super(Aj);this.node=Aj;var Aq=this.node.defn,Ah=Aq.style,Af=this.node.data.elms,At=this.parent,Ai=(Ah===AJ),Au=(Ah===AG),As,Am;if(Aq.srct===AB&&Aq.srcid&&this.model.getBrowseFormTypes&&this.model.getBrowseFormTypes(Aq.srcid).indexOf(D)>-1){As=window.document.createElement("span");L.forEach(Af,function(Av){As.innerHTML=Av.n;Am=As.firstChild;Av.n=Am&&(Am.text||Am.alt)||Av.n||"";});Am=null;As=null;}if(Ai&&Aq.multi){var Ag=L.find(Af,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(Ag>-1){this.node.data.del={idx:Ag,elem:Af[Ag]};L.removeIndices(Af,Ag,1);}}if(Aq.sec){var Al=[].concat(Aj.data.ces||[]);if(At&&(At.count!==null&&At.count!==undefined)){if(Ai){At.set("count","");}else{if((Al&&Af&&Af.length)||Aq.sos){if(!Aq.include){var Ap=L.find(Al,"v",mstrmojo.elementHelper.ELEM_ALL_ID);if(Ap>=0){L.removeIndices(Al,Ap,1);}}var An={};L.forEach(Af,function(Av){An[Av.v]=true;});Al=L.filter(Al,function(Av){return An[Av.v];});var Ak=Al,Ar;if(!Au){if(!Aq.multi){Ak=Af;}Ar=Af;}At.set("count",AZ.buildElemsCountStr(Ak,Ar));}}}}if(this.content){this.content.allIdx=L.find(this.node.data.elms,"v",b);}this.initControlInfo();var Ao=this.content=this.updateWidget(this);if(!Ao){this.set("visible",false);}this.clearCache();},refresh:function AI(){var Ag=this.parent,Af=this.node&&this.node.defn;if(Ag&&Ag.generateToolbar){Ag.set((this.isInFilterPanel()?"baseTitle":"title"),Af.ttl);Ag.generateToolbar();}this._super();},onincludeChange:function a(Ar){var Ap=this.node.defn,Ah=Ar.value,Ak=this.parent.parent.parent,Ao=Ak.model.getDataService().newUpdate(Ak);Ap.include=this.include=Ah;if(Ak._bufferedSlices){Ak.applyBufferedSlices(true,Ao);}if(this.style!==e&&this.style!==A){var Ai=q.call(this);Ai.ckey=this.ckey;Ai.changeInclude=true;if(Ap.srct===AB){var Aq=this,Al=this.model,Am=this.node.k,Aj=Al.getDataService(),Ag=Al.getSliceCallback(Ai),An=[Aj.getSelectorShowAllAction({ck:Ap.ck,ckey:Ap.ckey,type:Ap.type,showAll:Ah}),Aj.getSelectorIncludeAction({ck:Ap.ck,ckey:Ap.ckey,type:Ap.type,include:Ah})],As=Aa(Ag,{success:function(At){Aq.set("wait",false);Al.partialUpdate(At.data,Al.getTargetDefn(Am));if(!Aq.isInFilterPanel()){Aq.parent.selectVIUnit(Aq,true);}}});this.showall=this.defn.showall=Ar.value;var Af=this.deferredEvt;if(!!Af){Al.sliceDeferred(Ao,Af);}An=!!Af?An.concat(Ao.actions):(Ao.actions||[]).concat(An);this.set("wait",true);Al.controller.cmdMgr.execute({execute:function(){this.submit(An,As);},urInfo:{extraPuKeys:Ap.ck.split("\u001E").slice(1),treesToRender:3}});}else{this.slice(Ai);}}},getSelectorStyleList:function n(){var Ag=[],Aj=this.defn.srct,Af=this.defn.srcst;if(Aj===u||Aj===AB||Aj===AY){var Ak=!this.isInFilterPanel();if(Af===AH){return[];}Ag=[{n:mstrmojo.desc(4733,"Check Boxes"),v:k},{n:mstrmojo.desc(4730,"Slider"),v:AJ}];if(Aj===AB){Ag.push({n:mstrmojo.desc(8967,"Search Box"),v:AG});}if(Ak){Ag=Ag.concat([{n:mstrmojo.desc(4735,"Link Bar"),v:AE},{n:mstrmojo.desc(4734,"Button Bar"),v:o}]);}Ag=Ag.concat([{n:mstrmojo.desc(4732,"Radio Buttons"),v:AC},{n:mstrmojo.desc(4729,"Drop-down"),v:AO}]);if(Ak){Ag=Ag.concat([{n:mstrmojo.desc(6738,"List Box"),v:AR}]);}var Ai=mstrmojo.vi.ui.DatasetUnitMenuUtils.getUnitFromDataset(this.model.datasets,this.defn.srcid,12),Ah=Ai&&L.filterOne(Ai.fs,function(Al){return Al.idf;});if(Ah&&(Ah.bftp===w.DATE||Ah.bftp===w.DATETIME)&&(Ai&&!Ai.de)){Ag.push({n:mstrmojo.desc(5443,"Calendar"),v:A});}}else{if(Aj===N){Ag=[{n:mstrmojo.desc(4730,"Slider"),v:e},{n:mstrmojo.desc(5225,"Qualification"),v:z}];}}return Ag;},supportsInclude:function r(){var Af=this.defn;return((Af.srct===AB&&!this.hasDE)||(Af.srct===N&&Af.style===e))&&!this.isSolrSelector();},isSolrSelector:function AW(){return this.model.isFromSolrCube(this.defn.srcid);},isMetricSelector:function AW(){return this.defn.srct===N;},isRankMetricSelector:function v(){var Af=R.call(this).f;return Af&&typeof Af==="string"&&Af.search(/rank/i)===0;},isNumericMetricSelector:function AM(){var Af=R.call(this).dt;return !Af||Af===Y.DataTypeDouble||Af===Y.DataTypeInteger||Af===Y.DataTypeCellFormatData;},isAttributeSelector:function x(){return this.defn.srct===AB;},isDerivedAttributeSelector:function AK(){return this.defn.srct===AB&&this.defn.srcst===d;},isAttrQualSelector:function f(){return this.defn.srct===AB&&this.defn.style===A;},isRecursiveAttributeSelector:function c(){return this.defn&&this.defn.srct===12&&this.defn.srcst===3076;},allowsOrientationChange:function AA(){return !this.isAttrQualSelector()&&!AL.call(this,[AG,AR,AO,AJ,e,z]);},isSearchBox:function H(){return AL.call(this,[AG]);},isAttrElemListSelector:function AX(){return this.defn.srct===AB&&this.defn.style!==A;},slice:function Q(Ah){var Af=this.model;if(Af.closeSelWarnFlag){Af.closeSelWarnFlag(this.k);}if(this.isInFilterPanel()){var Ag=this.getFilterPanel();if(Ag&&!Ag.defn.cas){Ag.bufferSlice(Ah);return ;}}var Ai=this.getPanelContainer();if(this.isInSearchBoxPanel(Ai)){Ai.parent.bufferSlice(Ah);Ai.set("canApplySbp",Ai.canApplySearchBoxPanel());return ;}Af.slice(Ah);},isInFilterPanel:function g(){var Af=this.parent;return(Af&&Af.isInFilterPanel&&Af.isInFilterPanel())||false;},isHorizFP:function Ab(){var Af=this.parent;return(Af&&Af.isHorizFP&&Af.isHorizFP())||false;},getFilterPanel:function Ac(){var Af=this.parent;return(Af&&Af.getFilterPanel&&Af.getFilterPanel())||null;},isInSearchBoxPanel:function(Af){var Ag=Af||this.getPanelContainer();return Ag&&(Ag.isSbp||(Ag._isSearchBoxPanel&&Ag._isSearchBoxPanel()));},getPanelContainer:function(){var Af=mstrmojo.EnumRWUnitType,Ag;for(Ag=this.parent;Ag&&Ag.defn;Ag=Ag.parent){if(parseInt(Ag.defn.t,10)===Af.PANEL){return Ag;}}return null;},clearSelector:function O(An){var Am=q.call(this),Al=[b],Af=this.node.data.elms||[],Ak="\u001E",Ag=this.style,Ah=this.defn.include,Ai=this.isSelectAll&&this.isSelectAll();if(Ag===AG){Am.eid=Al.join(Ak);this.defn.set("cek",[]);}else{if(Ag===e||Ag===z){Am.cs="";Am.ckey=this.ckey;Am.unset=true;this.node.defn.set("cek",{cs:null,qua:this.qua,include:Ah,f:null,ft:null});}else{if(Ag===A){Am.unset=true;Am.ckey=this.ckey;var Aj=[{v:""},{v:""}];this.node.defn.set("cek",{cs:Aj});}else{Am.eid=Al.join(Ak);if((Ah||Ag===AJ)&&this.multi){L.forEach(Af,function(Ap){var Ao=Ap.v;if(Al[0]!==Ao){Al.push(Ao);}});}this.node.defn.set("cek",(Ah||Ag===AJ)?Al:[]);}}}if(this.defn.sec&&Ag!==AJ){this.parent.set("count",Ag===AG?"":AZ.buildElemsCountStr(Al,Af));}Am[An?"forceApply":"forceBuffer"]=true;if(Ai){Am.ignoreTargetData=true;}this.slice(Am);},allowsTogglingMultiSelect:function j(){return AL.call(this,[AO,o,AE,AG,AJ,AR]);},allowsSameSizeItems:function J(){return AL.call(this,[k,AC,o,AE]);},supportsSetTarget:function p(){var Af=this.defn;return this.isAttrElemListSelector()||(Af.srct===AY||Af.srcst===C);},supportSelectionColor:function W(){return AL.call(this,[AR,AE]);}});mstrmojo.DocSelector.UC_ON_DS=Ae;mstrmojo.DocSelector.STYLES={PULLDOWN:AO,SCROLLER:AJ,LIST:AR,RADIO:AC,CHECKBOX:k,BUTTON:o,LINK:AE,METRIC_SLIDER:e,METRIC_QUAL:z,SEARCH_BOX:AG,TEXT_BOX:S,ATTR_QUAL:A};}());(function(){mstrmojo.requiresCls("mstrmojo.ObjectInputBox","mstrmojo.ACL.UserDataService");mstrmojo.ACL.UserInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{suggestionPopupCssClss:"mstrmojo-ACLInputBox-suggest",getACLUserDataService:function C(){return mstrmojo.ACL.UserDataService;},item2textCss:function A(D){return(this._super&&this._super(D))||"mstrmojo-ACLInputBox-user "+{8704:"u",8705:"ug"}[D.st]||"";},getCandidatesThroughTaskCall:function B(E,D){this.getACLUserDataService().searchUserCandidates(E.pattern,!E.isVerify,E.blockCount,D);}});})();(function(){mstrmojo.requiresCls("mstrmojo.expr","mstrmojo.fe.FilterExprTree","mstrmojo.fe.AndOrNode","mstrmojo.fe.RelationNode","mstrmojo.fe.DynamicNode","mstrmojo.fe.ConditionNode");var K=mstrmojo.expr.ET;mstrmojo.fe.RelationFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RelationFilterExprTree",nodeClassMap:{14:mstrmojo.fe.AndOrNode,15:mstrmojo.fe.RelationNode,ph:mstrmojo.fe.DynamicNode,"*":mstrmojo.fe.ConditionNode},getItemIdentityProp:function(L){if(L.ph){return"ph";}if((L.et===10||L.et===12)&&L.dmt===4){return K.RLS;}return L.et;},isEditable:function J(M){var L=false;switch(M&&M.et){case K.RLS:L=true;break;}return L||this._super(M);},getItemConfig:function(O,L,P){var M=this._super(O,L,P),N=(O.et===K.RLS||!!O.relation);if(N){M.itemFunction=P.itemFunction;}return M;},newCondition:function E(M){var L=this.getSelectedItemWidget();if(M&&M.ph&&!M.ph.idx&&microstrategy.bones.rwb_viewer){M.ph.idx=microstrategy.bones.rwb_viewer.nextPhIndex++;}if(L&&L.selected&&L.newCondition){return L.newCondition(M);}else{return this._super(M);}},createSet:function D(M,L){var N=L.rq,O=L.cq;if(N&&O){this.remove(O);if(L.isMetric){mstrmojo.hash.copyProps(["applySubExpr","dmy","dmt","relation","useSchema"],N,O);N=O;}else{N.nds=[O];}this.add([N],M[0]);}},removeSet:function G(L){var M=L.data,N=[M];this.remove(M);if(M.nds&&M.nds.length>0){N=M.nds;}else{delete M.dmy;delete M.relation;delete M.applySubExpr;delete M.relation;delete M.useSchema;delete M.dmt;}this.add(N,0);},nameFactory:{counter:1,names:{},clear:function(){this.resetCounter();this.names={};},resetCounter:function C(){this.counter=1;},isNameExist:function I(L){return !!this.names[L];},setName:function H(L,M){this.names[L]=M;},changeName:function B(M,L,N){this.removeName(M);this.setName(L,N);},getNewName:function F(O,N,Q){var P=N||"",M=Q||"",L;while(this.isNameExist(P+this.counter+M)){this.counter++;}L=P+this.counter+++M;this.names[L]=O;return L;},removeName:function A(L){delete this.names[L];this.resetCounter();}}});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.Label","mstrmojo.hash","mstrmojo.array","mstrmojo.ui.Checkbox","mstrmojo.css","mstrmojo.threshold.ThresholdExprTree","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.models.FormatModel.getFormatUpdate","mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL");mstrmojo.requiresDescs(2869,3397,5893,7978,7979,13788,13789,13790,13894,14599,14600,14601,14611);var E=mstrmojo.hash,N=mstrmojo.array,O=mstrmojo.css,I=mstrmojo.models.FormatModel.decodeValue,M=mstrmojo.threshold.ThresholdModel.REPLACE_SYMBOL,C=12;function G(R){this.threshold.scope=R;}function J(V,S,R){var T=this.previewNode;switch(V){case 10:var U=N.filterOne(M,function(W){return W.v===S;});if(U){T.innerHTML=U.n;}break;case 4:O.addClass(T,"hasImage");T.innerHTML='<img class="replaceImg" src="'+S+'" />';break;default:T.innerHTML=S||(R===C?mstrmojo.desc(14611,"Sample"):"1234.567");}}function P(S,R){R.fontFamily=S.ff;R.fontSize=parseInt(S.fsz,10)+"pt";R.fontWeight=S.fw?"bold":"normal";R.textDecoration=(S.fun?"underline":"")+" "+(S.fst?"line-through":"");R.fontStyle=S.fit?"italic":"";R.color=S.fc;R.backgroundColor=S.bc;R.textAlign=S.alh;R.verticalAlign=S.alv;R.wordWrap=S.atw;R.direction=S.atd;var T=S.bts;R.border=S.borderStyle||(T?I("bts",T):"1px dotted");R.borderColor=S.borderColor||S.btc||"#e1e1e1";}mstrmojo.threshold.ThresholdRow=mstrmojo.declare(mstrmojo.Box,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ThresholdRow",markupString:'<div id="{@id}" class="mstrmojo-thresholdRow cf {@cssClass}" style="{@cssText}" mstrAttach:click><div class="draggable-icon"></div><div class="container"></div><div class="previewWrap"><div class="preview"></div></div><div class="menu"></div><div class="delete"></div></div>',markupSlots:{containerNode:function F(){return this.domNode.children[1];},draggableNode:function H(){return this.domNode.firstChild;},previewNode:function F(){return this.domNode.children[2].firstChild;},menuNode:function F(){return this.domNode.children[3];},deleteNode:function L(){return this.domNode.children[4];}},threshold:undefined,idx:undefined,editor:undefined,model:undefined,lblIndex:undefined,chkBox:undefined,exprTree:undefined,postBuildRendering:function A(){this.destroyChildren(false);var R=this.threshold,S=this.model,T=this.previewNode.style,V=E.copy(R.fmt,E.clone(S.getGridValueFormat())),U=R.expr;J.call(this,R.rtp,R.rtxt,S.objectType);if(V){P(V,T);}this.destroyChildren(false);this.addChildren([{scriptClass:"mstrmojo.Label",alias:"lblIndex",text:this.idx+1},{scriptClass:"mstrmojo.threshold.ThresholdExprTree",alias:"exprTree",editor:this.editor,model:this.model,items:[U]}]);S.attachEventListener("selectedThresholdsChange",this.id,"onselectedThresholdsChange");return this._super();},onselectedThresholdsChange:function D(){},onclick:function Q(U){var S=this.editor,W=U.getTarget(),T=this,R=this.model,V=S.objectType===C;if(W===this.deleteNode){this.removeFromModel();}else{if(W===this.menuNode){var X=new mstrmojo.ui.menus.MenuConfig();X.hostId=this.id;X.hostElement=this.menuNode;X.isHostedWithin=false;X.addSubMenuItem(mstrmojo.desc(13788,"Apply to"),"",S.id,function(){var Y=new mstrmojo.ui.menus.MenuConfig();Y.addRadioMenuGroup(T.threshold.scope||1,G,[{value:1,text:V?mstrmojo.desc(14599,"Element Rows Only"):mstrmojo.desc(13789,"Metric Only")},{value:2,text:V?mstrmojo.desc(14600,"Subtotal Rows Only"):mstrmojo.desc(13790,"Subtotals Only")},{value:3,text:V?mstrmojo.desc(14601,"Elements and Subtotals"):mstrmojo.desc(13894,"Metric and Subtotals")}],"",T,true);return Y;});X.addMenuItem(mstrmojo.desc(2869,"Formatting"),"",function(){S.openPropertyPanel(T);});X.addMenuItem(mstrmojo.desc(3397,"Duplicate"),"",function(){R.duplicateThreshold(T.idx);});if(this.idx!==0){X.addMenuItem(mstrmojo.desc(7978,"Move Up"),"",function(){R.moveThreshold(T.idx,T.idx-1);});}else{X.addNonInteractiveMenuItem(mstrmojo.desc(7978,"Move Up"),"",true);}if(this.idx!==R.thresholds[R.metricId].length-1){X.addMenuItem(mstrmojo.desc(7979,"Move Down"),"",function(){R.moveThreshold(T.idx,T.idx+1);});}else{X.addNonInteractiveMenuItem(mstrmojo.desc(7979,"Move Down"),"",true);}X.addMenuItem(mstrmojo.desc(5893,"New Condition"),"",function(){T.exprTree.newCondition(null);});this.openPopup(X.newInstance());}else{if(W===this.previewNode||W===this.previewNode.firstChild){S.openPropertyPanel(this);}}}},removeFromModel:function K(){this.model.deleteThreshold(this.threshold);},onpropertyModelChange:function B(R){E.copy(R.threshold,E.clear(this.threshold));this.refresh();}});}());(function(){mstrmojo.requiresCls("mstrmojo.dom","mstrmojo.array","mstrmojo.hash","mstrmojo.func","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.HBox","mstrmojo.List","mstrmojo.Label","mstrmojo.ListMapperHoriz","mstrmojo.WidgetList","mstrmojo.WidgetListMapper","mstrmojo.TristateCheckBox","mstrmojo.Pulldown","mstrmojo.ACL.UserTreeBrowser","mstrmojo.DataGrid","mstrmojo.DropDownButton","mstrmojo.ListBox","mstrmojo.DivItemRenderer","mstrmojo.VBox","mstrmojo.Box","mstrmojo.ACL.UserInputBox","mstrmojo.Editor","mstrmojo.ACL.UserDataService","mstrmojo.StackContainer","mstrmojo.CheckList","mstrmojo.TextBox","mstrmojo.TextBoxWithLabel","mstrmojo.CheckBox");mstrmojo.requiresDescs(1825,8078,8079,629,8080,8081,8082,3336,9048,8083,8084,955,8085,531,8086,8087,8088,8089,8090,767,2056,8091,8093,1442,221,8092,13621,9772,9773,9774,272,271,8145,2509,8146,8147,9775,9776,9777,9771,12299,9151,2156,9892,9890,9891,9099,2140,2102);var Q=mstrmojo.dom,C=mstrmojo.css,h=mstrmojo.array,a=[],S="sharingEditor",k=199,R="294DEDC011D2F1D56000D98E67019608",F="C82C6B1011D2894CC0009D9F29718E4F",E=[1,4,8,16,32,64,128],A=[mstrmojo.desc(1825,"Browse"),mstrmojo.desc(8078,"Read"),mstrmojo.desc(8079,"Write"),mstrmojo.desc(629,"Delete"),mstrmojo.desc(8080,"Control"),mstrmojo.desc(8081,"Use"),mstrmojo.desc(8082,"Execute")],Y=["B","R","W","D","C","U","E"],Z=false,m=true,T=257,l=1024,U=772,W=776,J=777,c=mstrmojo.Button.newWebButton,j=mstrmojo.Button.newActionButton;function P(o){return(o&&o.t===8);}function n(o){return o&&o.st!=T&&o.st!=l&&o.st!=U&&o.st!=W&&o.st!=J;}function I(o){return{"253000":255000,"253":255,"221":223,"197":199,"69":71}[o]||o;}function H(o){return{"253000":255000,"253":255,"32221":223,"56197":199}[o]||o;}function V(v){var u=[].concat(v.acls),o=v.inhs,t=v.acls,x,q,w,p,r;t.splice(0,t.length);if(P(v)){u=u.concat(mstrmojo.hash.valarray(o));}for(p=0,r=u.length;p<r;p++){x=u[p];w=x.rgt;if(w>1000){q=mstrmojo.hash.copy(x);q.den=true;q.rgt=Math.floor(w/1000);t.push(q);}if((w%1000)>0){q=mstrmojo.hash.copy(x);q.den=false;q.rgt=w%1000;t.push(q);}}return v;}function O(p){var o={isSerializable:function(t,r,q){switch(t){case"did":case"rgt":case"n":case"acls":case"t":case"st":case"inh":case"den":return true;}return false;},getArrItemName:function(t,q,r){if(t==="acls"){return"acl";}},convertBoolean:true};return mstrmojo.string.json2xml("oi",p,o);}function f(u,t){var q=u&&u.oi,p,o,v,r=u.oneTierConnectivity;if(q){q=V(q);p=O(q);v={taskId:"saveObjectACL",objectXML:p,objectType:q.t,objectID:q.did,propagateToChildren:u.childrenAccessPulldown.value};o={success:function(w){if(t){u.close();}else{mstrmojo.alert(mstrmojo.desc(3336,"## has been saved successfully.").replace("##",w.n));u.set("hasChanged",false);}},failure:function(w){if(w.getReponseHeader){mstrmojo.alert(w.getResponseHeader("X-MSTR-TaskFailureMsg"));}if(t){u.close();}}};if(r){delete v.taskId;v.connectionId=r.connectionId;v.sessionState=r.sessionState;r.connectivityProxy.saveObjectACL(v,mstrmojo.func.wrapMethods(o,{failure:function(w){mstrmojo.onetier.vi.prefs.handleErrorMessage(w);}}));}else{mstrmojo.xhr.request("POST",mstrConfig.taskURL,o,v);}}}function g(x){var AD=x.aclList,AE=x.objectInputer,z=x.rightPulldown,r=AE.getSelectedObjects(),u=r.length,AA=[],q,AC=z.value,p,AB,o;if(!AE.isValid()){mstrmojo.alert(mstrmojo.desc(9048,"Some users/groups do not exist. Please remove them in order to proceed."),null,x.alertTitle);return false;}for(p=0;p<u;p++){q=r[p];if(q.did===R||q.did===F){var t=mstrmojo.all[S];if(AC===t.currentPublicRight){if(m){C.removeClass(t.userMessage.domNode,"hideMsg");}}}AB=h.find(AD.items,"did",q.did);if(AB!==-1){o=AD.items[AB];if(x.uneditableRights[o.rgt]){continue;}}AA.push(new mstrmojo.Obj({n:q.n,did:q.did,st:q.st,rgt:AC,newItem:true}));}if(AA.length>0){var w=h.findMulti(AD.items,"did",AA);if(w.count){var v=w.indices.concat().sort(h.numSorter).slice(0,w.count);for(p=v.length-1;p>-1;p--){AD.remove(v[p]);}}AD.add(AA);x.set("hasChanged",true);}AE.set("items",[]);return true;}function K(o){var q=[],v=Math.floor(o/1000),t=o%1000,w=E,x=A,u=w.length,z,p;for(p=0;p<u;p++){q.push(x[p]);q.push(" ");if((t&w[p])>0){q.push(mstrmojo.desc(8083,"Granted"));}else{if((v&w[p])>0){q.push(mstrmojo.desc(8084,"Denied"));}else{q.push(mstrmojo.desc(959,"Default"));}}q.push(",");}z=q.join("");return z.substring(z,z.length-1);}function b(x){var u=[],w=x%1000,q=E,v=Y,o=q.length,t,p;for(p=0;p<o;p++){if((w&q[p])>0){u.push(v[p]);u.push(",");}}t=u.join("");return t.substring(t,t.length-1);}function M(q,r){var t=q.items,p=h.find(t,q.itemIdField,r),x=q.customItem,o=t.length-2;if(p===-1){var u={n:b(r),rgt:r};if(x){t.splice(o,1);}o=t.length-1;t.splice(o,0,u);q.customItem=u;}else{if(x&&p!==o){t.splice(o,1);q.customItem=null;}}if(mstrmojo.all[S].showACLHint!==false){q.set("title",K(r));}q.value=r;}function B(o){return{"776":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}],"779":[{n:mstrmojo.desc(8085,"Consume"),rgt:71},{n:mstrmojo.desc(531,"Add"),rgt:199},{n:mstrmojo.desc(8086,"Collaborate"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}]}[o]||[{n:mstrmojo.desc(8090,"View"),rgt:199},{n:mstrmojo.desc(767,"Modify"),rgt:223},{n:mstrmojo.desc(8087,"Full control"),rgt:255},{n:mstrmojo.desc(8088,"Denied all"),rgt:255000},{n:mstrmojo.desc(8089,"Custom ..."),rgt:-1}];}function N(v,u){var t="";if(u){var p=this.widthInput.value,w=this.heightInput.value,o=' src="'+v,x="",q=this.checkBoxList.items,r;for(r=0;r<q.length;r++){if(!this.checkBoxList.selectedIndices.hasOwnProperty(r)){if(x==""){x="&hiddensections="+q[r].alias;}else{x+=","+q[r].alias;}}}t='<iframe width="'+p+'" ';t+='height="'+w+'" ';t+=o;t+=x;t+='"></iframe>';}else{t='<iframe width="640" height="480" src="';t+=v;t+='&hiddensections=header,path,dockTop,dockLeft,footer"></iframe>';}return t;}function e(q){var t=mstrmojo.string.parseUri(q).queryKey,u=q.indexOf("?"),p=u>0?q.substring(0,u):q;var o=p.indexOf(";jsessionid");p=o>0?p.substring(0,o):p;if(t.hasOwnProperty("iframe")){delete t.iframe;}if(t.hasOwnProperty("validateRandNum")){delete t.validateRandNum;}if(!t.hasOwnProperty("server")){t.Server=encodeURIComponent(mstrApp.serverName);}if(!t.hasOwnProperty("Project")){t.Project=encodeURIComponent(mstrmojo.string.decodeHtmlString(mstrApp.projectName));}if(!t.hasOwnProperty("port")){t.Port=mstrApp.serverPort;}if(Z){t.connmode=8;t.ru=1;}if(t.evt!=="3185"){t.share=1;}p+="?";for(var r in t){p+=r+"="+t[r]+"&";}p=p.substring(0,p.length-1);return p;}function G(r){var o=new Date(),q=this.objectName+" "+o.toLocaleDateString()+" "+o.toLocaleTimeString(),p=this,t={success:function(w){var v=e(w.url);p.linkBox.set("value",v);p.url=v;p.htmlPanel.htmlBox.set("value",N(v));var u=p.tabDock.emailLink;u.set("url",window.escape(v));u.set("name",p.objectName);},failure:function(u){mstrmojo.alert(u.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){p.hideWait();if(r){var u="mailto:?body="+window.escape(p.url)+"&subject="+encodeURI(p.objectName);mstrApp.openPage(u,"mailtoIframe");}}};this.showWait();mstrmojo.xhr.request("POST",mstrConfig.taskURL,t,{taskId:"savePersonalView",messageID:this.mid,objectType:this.oi.t,subName:q,objectSubType:0,viewMode:this.viewMode||0,isPVPublic:true});}function D(o){return o>999?Math.floor(o/1000)*1000:o;}function X(r){var p=this.getAvailableRightsForSelection(),o=p.length,q;for(q=0;q<o;q++){if(p[q].rgt===r){return p[q].n;}}return mstrmojo.desc(2056,"Custom");}function L(o){return(o.acg&32)>0;}mstrmojo.SharingEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.SharingEditor",cssClass:"mstrmojo-SharingEditor",showSharingOptions:true,showButtonBar:true,showPublisAccess:true,hasChanged:false,help:"sharing_dialog_box.htm",zIndex:199,defaultRight:223,showButtonText:true,uneditableRights:{},currentPublicRight:199,userSelectorTitle:mstrmojo.desc(8091,"User/User Group Browser"),showLinkOnOpen:false,closeEditorAfterSave:true,init:function(o){S=o.id||S;this._super(o);},onShowLink:function(p){var o={htmlCode:"showLink",showLink:"htmlCode"};this.tabDock[o[p]].set("selected",false);},showWait:mstrmojo.emptyFn,hideWait:mstrmojo.emptyFn,checkPublicAccess:function(){var w=this.oi.acls,q,AA=h.find(w,"did",F),u=this.aclList.itemsContainerNode,v=this.publicAccessSection.publicLabel,t,z=false,o=h.find(w,"did",R),x;if(AA!==-1&&Z&&o!==-1){var p=w[AA].rgt,r=w[o].rgt;if(p===r){z=true;x=r;}}if(AA!==-1&&!Z){z=true;x=w[AA].rgt;}t=u.children[0].tBodies;if(Z&&t[o]){C.toggleClass(t[o].rows[0],"hide",z);}if(t[AA]){C.toggleClass(t[AA].rows[0],"hide",z);}v.set("checked",z);if(x){this.set("currentPublicRight",x);}},oncurrentPublicRightChange:function(){var o=this.publicAccessSection.publicMouseOver;o.publicRight.set("value",this.currentPublicRight);o.publicRightLabel.set("text",X.call(this,this.currentPublicRight));},onOpen:function(){var p=this.oi.n,w=this.oi.acls;this.objectName=p;this.set("showACL",!!w);Z=this.guestModeEnabled;if(this.href&&!this.isLinkDirty){var q=!this.urlReady?e(this.href):this.href,u=this.tabDock.emailLink;this.url=q;u.set("url",window.escape(q));u.set("name",p);this.htmlPanel.htmlBox.set("value",N(q));this.linkBox.set("value",q);}this.set("title",mstrmojo.desc(8093,"share").replace("##",mstrmojo.string.encodeHtmlString(p)));var t=this.tabDock;t.showLink.set("selected",this.showLinkOnOpen);t.htmlCode.set("selected",false);if(w){this.checkPublicAccess();var v=this.rightPulldown;v.set("items",this.getAvailableRightsForSelection());v.set("value",k);var x=this.objectInputer,r=this.userSelector,o=r&&r.userBrowser;x.zIndex=this.zIndex;if(o&&o.hasRendered){r.opener=this;o.set("items",[]);o.getContent(o);}this.set("hasChanged",false);}this.aclList.updateScrollbars();},_set_hasChanged:function(q,o){var p=(o!==this.hasChanged);this.hasChanged=o;if(o===true){this.checkPublicAccess();return o;}return p;},_set_oi:function(p,o){this.oi=this.preProcessACLs(o);return true;},postCreate:function(){this.oi=this.preProcessACLs(this.oi);},getAvailableRightsForSelection:function(){return B(this.oi.st);},preProcessACLs:function(x){if(x&&x.acls){var v=x.acls,u=v&&v.length,w=P(x),p={},z,o,q,t;if(w){q={};x.inhs=q;}for(t=0;t<u;t++){z=new mstrmojo.Obj(v[t]);if(w&&z.inh){q[z.n]=mstrmojo.hash.copy(z);continue;}o=p[z.n];if(!o){o=mstrmojo.hash.copy(z);o.rgt=0;delete o.den;p[z.n]=o;}o.rgt+=z.den?z.rgt*1000:z.rgt;}v=mstrmojo.hash.valarray(p);x.acls=v;}return x;},getACLItems:function(){var r=this.aclList&&this.aclList.items,p=[];for(var q=0,o=r.length;q<o;q++){p.push(r[q]);}return p;},onClose:function(){var o=this.objectInputer;o.set("items",[]);this.aclList.clearSelect();},getACLUserDataService:function d(){return mstrmojo.ACL.UserDataService;},userSelector:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-UserEditor",help:"user_group_browser.htm",onClose:function(){this.userBrowser.clearTreeSelect();},children:[{scriptClass:"mstrmojo.ACL.UserTreeBrowser",alias:"userBrowser",getACLUserDataService:function d(){return this.parent.opener.getACLUserDataService();},updateTreeContent:function(p,r){p.contentRetrieved=true;var q=r[p.itemChildrenField],o=p.tree||p,u=r.bc,t=r.sz,v=r.bb;if(u!==-1){if(v+u<=t){q.push(o.nextItemCreaterFunc());}if((v-u)>-1){q.unshift(o.prevItemCreaterFunc());}}p.blockBegin=v;o.initializing=true;p.clearSelect(false);p.set("items",q);p.setSelectedItems(o.getTotalSelections(),true);o.initializing=false;},selectionAcrossBranch:true,multiSelect:true},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(p){var o=this.parent.parent,u=o.opener,t=u.objectInputer,r=o.userBrowser,q=r.getTotalSelections();if(q&&q.length>0){t.add(q,t.items.length-1);}o.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(o){this.parent.parent.close();},preBuildRendering:function(){if(!this.parent.parent.opener.showButtonText){this.set("text","");}}}]}],onOpen:function(){this.set("title",this.opener.userSelectorTitle);}},customACL:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(8092,"Custom Permission Level"),cssClass:"mstrmojo-CustomACLEditor",help:"Custom_Permission_Level_dialog_box.htm",onOpen:function(){var w=this.rgt,x=Math.floor(w/1000),v=w%1000,q=this.children,t,u,p,o;for(p=0,o=q.length;p<o;p++){t=q[p];u=t.right;if(this.twoStates){t.set("grayed",false);t.set("checked",false);}else{t.set("grayed",true);t.set("checked",true);}if((x&u)>0){t.set("checked",false);t.set("grayed",false);}if((v&u)>0){t.set("checked",true);t.set("grayed",false);}}},getACLValue:function(){var t=0,u=0,q=this.children,r,p,o;for(p=0,o=q.length;p<o;p++){r=q[p];if(r.grayed||!r.right){continue;}if(r.checked){t+=r.right;}else{u+=r.right;}}return u*1000+t;},children:[{scriptClass:"mstrmojo.TristateCheckBox",alias:"browse",right:1,text:mstrmojo.desc(1825,"Browse")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"read",right:4,text:mstrmojo.desc(8078,"Read")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"write",right:8,text:mstrmojo.desc(8079,"Write")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"delete",right:16,text:mstrmojo.desc(629,"Delete")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"control",right:32,text:mstrmojo.desc(8080,"Control")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"use",right:64,text:mstrmojo.desc(8081,"Use")},{scriptClass:"mstrmojo.TristateCheckBox",alias:"execute",right:128,text:mstrmojo.desc(8082,"Execute")},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-OK",text:mstrmojo.desc(1442,"OK"),onclick:function(o){var p=this.parent.parent;if(p.onOK){p.onOK();}p.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",iconClass:"mstrmojo-Editor-button-Cancel",text:mstrmojo.desc(221,"Cancel"),onclick:function(o){var p=this.parent.parent;if(p.onCancel){p.onCancel();}p.close();}}]}]},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13621,"Share By"),bindings:{visible:function(){return n(this.parent.oi)&&this.parent.showSharingOptions;}},cssClass:"SharingEditor-title"},{scriptClass:"mstrmojo.HBox",alias:"tabDock",cssClass:"sharingEditor-tabDock",bindings:{visible:function(){return n(this.parent.oi)&&this.parent.showSharingOptions;}},children:[{scriptClass:"mstrmojo.Widget",markupString:'<div id = "{@id}" class ="sharingEditor-emailLink style="{@cssText} mstrAttach:click>'+mstrmojo.desc(9772,"Email Link")+' <iframe name="mailtoIframe" style="display:none"></iframe> </div>',alias:"emailLink",onclick:function(){var p=this.parent.parent;if(!this.url||p.isLinkDirty){G.call(p,true);p.set("isLinkDirty",false);}else{var q=window.location.protocol,o="mailto:?body="+window.escape(p.url)+"&subject="+encodeURI(p.objectName);if(mstrApp.isSingleTier){window.FormWrapper.openPage(o);}else{if(!!Q.isChrome&&q==="https:"){window.open(o,"_self");window.setTimeout("iframe.hideWaitPage()",2000);}else{window.open(o,"mailtoIframe");}}}}},{scriptClass:"mstrmojo.Label",alias:"showLink",text:mstrmojo.desc(9773,"Show Link"),cssClass:"SharingEditor-ShowLink",selected:false,onclick:function(o){var p=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!p.url||p.isLinkDirty){G.call(p);p.set("isLinkDirty",false);}p.onShowLink(this.alias);this.set("selected",true);}}},{scriptClass:"mstrmojo.Label",cssClass:"SharingEditor-ShowHtml",alias:"htmlCode",text:mstrmojo.desc(9774,"Show HTML"),selected:false,onclick:function(o){var p=this.parent.parent;if(this.selected){this.set("selected",false);}else{if(!p.url||p.isLinkDirty){G.call(p);p.set("isLinkDirty",false);}p.onShowLink(this.alias);this.set("selected",true);}}}]},{scriptClass:"mstrmojo.Box",alias:"htmlPanel",cssClass:"mstrmojo-SharingEditor-html-panel",children:[{scriptClass:"mstrmojo.TextBox",alias:"htmlBox",cssClass:"SharingEditor-Html"},{scriptClass:"mstrmojo.TextBoxWithLabel",alias:"widthInput",label:mstrmojo.desc(272,"Width:"),value:640,onvalueChange:function(o){var p=this.parent,q=mstrmojo.all[S];p.htmlBox.set("value",N.call(p,q.url,true));}},{scriptClass:"mstrmojo.TextBoxWithLabel",label:mstrmojo.desc(271,"Height:"),alias:"heightInput",value:480,onvalueChange:function(){var o=this.parent,p=mstrmojo.all[S];o.htmlBox.set("value",N.call(o,p.url,true));}},{scriptClass:"mstrmojo.CheckListHoriz",alias:"checkBoxList",items:[{n:mstrmojo.desc(8145,"Navigation bar"),alias:"path"},{n:mstrmojo.desc(2509,"Toolbar"),alias:"dockTop"},{n:mstrmojo.desc(8146,"Tools panel"),alias:"dockLeft"},{n:mstrmojo.desc(8147,"Footer"),alias:"footer"}],multiSelect:true,onselectionChange:function(o){var p=this.parent,q=mstrmojo.all[S];p.htmlBox.set("value",N.call(p,q.url,true));}}],bindings:{visible:"this.parent.tabDock.htmlCode.selected"}},{scriptClass:"mstrmojo.TextBox",alias:"linkBox",cssClass:"SharingEditor-Link",bindings:{visible:"this.parent.tabDock.showLink.selected"}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9775,"Who Has Access"),cssClass:"SharingEditor-title",bindings:{visible:"this.parent.showACL"}},{scriptClass:"mstrmojo.HBox",alias:"publicAccessSection",cssClass:"sharingEditor-publicAccessSection",bindings:{visible:"this.parent.showACL && this.parent.showPublisAccess"},children:[{scriptClass:"mstrmojo.CheckBox",alias:"publicLabel",cssClass:"SharingEditor-Public",bindings:{label:function(){if(this.parent.parent.guestModeEnabled){return mstrmojo.desc(9776,"Public (Login not required)");}return mstrmojo.desc(9777,"Everyone (Login not required)");},enabled:function(){return L(this.parent.parent.oi);}},oncheckedChange:function(){C.toggleClass(this.domNode.children[1],"label-disabled",!this.checked);},getUserGroupsInfo:function(){if(Z){this.getUserGroupFromTaskCall(R);}this.getUserGroupFromTaskCall(F);},getUserGroupFromTaskCall:function(v){var q=mstrmojo.all[S],r=q.aclList,t=q.getACLUserDataService(),u=function(x){var w=new mstrmojo.Obj({n:x.n,did:x.did,st:x.st,rgt:k,newItem:true});a.push(w);},p=function(w){},o=function(){if(!Z||(Z&&a.length==2)){r.add(a);q.set("hasChanged",true);}};t.getMembers({blockBegin:0,blockCount:1,outputElements:1,data:{did:v}},{success:u,failure:p,complete:o});},onclick:function(){var p=mstrmojo.all[S];var q=p.aclList.items;var r=h.find(q,"did",F);if(r!==-1){q.remove(r);}var o=h.find(q,"did",R);if(Z&&o!==-1){q.remove(o);}if(this.checked===true){if(a.length<1){this.getUserGroupsInfo();}else{mstrmojo.array.forEach(a,function(t){t.rgt=k;});q.add(a);p.set("hasChanged",true);}}else{p.set("currentPublicRight",k);p.set("hasChanged",true);}}},{scriptClass:"mstrmojo.MouseOverContainer",alias:"publicMouseOver",bindings:{visible:"this.parent.publicLabel.checked",enabled:function(){return L(this.parent.parent.oi);}},children:[{scriptClass:"mstrmojo.Label",alias:"publicRightLabel",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){var o=this.parent.parent.parent;return X.call(o,o.currentPublicRight);},enabled:function(){return L(this.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-pulldown",itemIdField:"rgt",alias:"publicRight",visible:false,postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},bindings:{value:"this.parent.parent.parent.currentPublicRight",enabled:function(){return L(this.parent.parent.parent.oi);}},selectionPolicy:"reselect",onvalueChange:function(){var o=this.parent;var p=o.parent.parent;o.publicRightLabel.set("text",X.call(p,this.value));},_set_value:function(u,p){var q=this.value,o=(q!==p);if(o){if(p===-1){var t=this.parent.parent.parent,r=this;t.openPopup("customACL",{zIndex:t.zIndex+10,rgt:q,twoStates:true,onOK:function(){r.set("value",this.getACLValue());},onCancel:function(){r.set("value",q);}});return false;}p=D(p);p=H(p);M(this,p);this.updatePublicRight(p);return true;}return true;},updatePublicRight:function(p){var q=this.parent.parent.parent;if(q.aclList){var r=q.aclList.items;var o=h.find(r,"did",R);var t=h.find(r,"did",F);if(Z&&o!==-1){r[o].rgt=p;}if(t!==-1){r[t].rgt=p;}q.set("hasChanged",true);q.set("currentPublicRight",p);}}}]}]},{scriptClass:"mstrmojo.Label",alias:"userMessage",text:mstrmojo.desc(9771,"The permission you added is already granted"),cssClass:"sharingEditorUserMessage hideMsg",bindings:{visible:"this.parent.showACL"},onclick:function(){C.addClass(this.domNode,"hideMsg");m=false;}},{scriptClass:"mstrmojo.DataGrid",alias:"aclList",cssClass:"aclList",renderOnScroll:false,makeObservable:true,itemDisplayField:"n",itemIdField:"did",dropZone:true,bindings:{items:function(){return this.parent.oi.acls||[];},visible:"this.parent.showACL"},onremove:function(p){var u=this.parent.oi;var t=this;window.setTimeout(function(){t.updateScrollbars();},10);if(!P(u)){return ;}var v=u.inhs,r=p.value,o=r&&r.length,w,q;for(q=0;q<o;q++){w=r[q].n;delete v[w];}},onadd:function(p){var u=this.parent.oi;var t=this;window.setTimeout(function(){t.updateScrollbars();},10);if(!P(u)){return ;}var v=u.inhs,r=p.value,o=r&&r.length,w,q;for(q=0;q<o;q++){w=r[q].n;v[w]=mstrmojo.hash.copy(r[q]);v[w].inh=true;}},onACLChanged:function(p){var o=this.parent.oi;this.parent.set("hasChanged",true);if(!P(o)){return ;}o.inhs[p.n]=mstrmojo.hash.copy(p);o.inhs[p.n].inh=true;},columns:[{dataFunction:function(q,o,p){return'<div class="mstrmojo-ACLEditor-user '+(q.st===8705?"ug":"u")+'">'+mstrmojo.string.encodeHtmlString(q.n)+"</div>";}},{dataWidget:{scriptClass:"mstrmojo.MouseOverContainer",alias:"mouseOverContainer",bindings:{enabled:function(){return L(this.parent.parent.parent.oi);}},children:[{scriptClass:"mstrmojo.Label",cssClass:"sharingEditor-rightLabel",bindings:{text:function(){return X.call(mstrmojo.all[S],D(this.parent.parent.data.rgt));},enabled:function(){return L(this.parent.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-datagridContainer",visible:false,children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"sharingEditor-datagridPulldown",itemIdField:"rgt",popupToBody:true,selectionPolicy:"reselect",popupZIndex:1001,postCreate:function(){this.markupMethods=mstrmojo.hash.copy({ondataChange:function(){var o=this.parent.parent.data;this.set("value",o[this.itemIdField]);},onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";if(!this.visible&&this.popupRef){this.popupRef.set("visible",false);}}},mstrmojo.hash.copy(this.markupMethods));this.items=this.parent.parent.dataGrid.parent.getAvailableRightsForSelection();},_set_value:function(u,p){var q=this.value,o=(q!==p);if(o){if(p===-1){var t=this.parent.parent.dataGrid.parent,r=this;t.openPopup("customACL",{zIndex:t.zIndex+10,rgt:q,twoStates:!!this.parent.parent.data.newItem,onOK:function(){r.set("value",this.getACLValue());},onCancel:function(){r.set("value",q);}});return false;}p=D(p);p=I(p);M(this,p);this.parent.parent.data.set(this.itemIdField,p);if(q!==null){this.parent.parent.dataGrid.onACLChanged(this.parent.parent.data);}return true;}return true;},bindings:{enabled:function(){return L(this.parent.parent.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),onclick:function(o){var p=this,q=function(){var r=p.parent.parent.dataGrid;r.remove(p.parent.parent.data);r.parent.set("hasChanged",true);};mstrmojo.confirm(mstrmojo.desc(12299,"Are you sure you want to delete the user/user group #?").replace("#",this.parent.parent.data.n),{confirmBtn:{fn:q}},{zIndex:2000});},bindings:{enabled:function(){return L(this.parent.parent.parent.parent.parent.oi);}}}]}]}}]},{scriptClass:"mstrmojo.Box",cssClass:"sharingEditor-ACLUserPanel",bindings:{visible:"this.parent.showACL"},children:[{scriptClass:"mstrmojo.HBox",cssClass:"sharingEditor-CPSection",children:[{scriptClass:"mstrmojo.ACL.UserInputBox",emptyText:mstrmojo.desc(9151,"Type users or groups here."),getACLUserDataService:function d(){return this.parent.parent.parent.getACLUserDataService();},noCache:true,postCreate:function(){var o=this.parent.parent.parent;if(o){this.zIndex=o.zIndex+1;}},onRender:function(){var o=this.parent.parent.parent;if(o){o.objectInputer=this;}},bindings:{enabled:function(){return L(this.parent.parent.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",itemIdField:"rgt",value:199,defaultSelection:0,selectionPolicy:"reselect",onRender:function(){var o=this.parent.parent.parent;if(o){o.rightPulldown=this;}},postCreate:function(){this.items=this.parent.parent.parent.getAvailableRightsForSelection();},_set_value:function(u,p){var q=this.value,o=(q!==p);if(o){if(p===-1){var t=this.parent.parent.parent,r=this;t.openPopup("customACL",{zIndex:t.zIndex+10,rgt:q,twoStates:true,onOK:function(){r.set("value",this.getACLValue());},onCancel:function(){r.set("value",q);}});return false;}p=H(p);M(this,p);return true;}return true;},bindings:{enabled:function(){return L(this.parent.parent.parent.oi);}}},j(mstrmojo.desc(2156,"Add"),function(o){var p=this.parent.parent.parent;g(p);},{bindings:{enabled:function(){return L(this.parent.parent.parent.oi);}}}),j(mstrmojo.desc(1825,"Browse"),function(o){var p=this.parent.parent.parent;p.openPopup("userSelector",{zIndex:p.zIndex+10});},{bindings:{enabled:function(){return L(this.parent.parent.parent.oi);}}})]}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9892,"Children Access"),cssClass:"SharingEditor-title",bindings:{visible:function(){return this.parent.showACL&&P(this.parent.oi);}}},{scriptClass:"mstrmojo.Pulldown",alias:"childrenAccessPulldown",value:0,items:[{n:mstrmojo.desc(9890,"Preserve children's access control lists"),idx:0},{n:mstrmojo.desc(9891,"Overwrite children's access control lists"),idx:1}],itemIdField:"idx",bindings:{visible:function(){return this.parent.showACL&&P(this.parent.oi);}}},{scriptClass:"mstrmojo.HBox",cssClass:"Editor-buttonBox",slot:"buttonNode",bindings:{visible:"this.parent.showButtonBar"},children:[c(mstrmojo.desc(9099,"Share"),function(o){var p=this.parent.parent;if(g(p)){f(p,p.closeEditorAfterSave);}},true,{iconClass:"mstrmojo-Editor-button-OK",bindings:{visible:"this.parent.parent.showACL",enabled:function(){return L(this.parent.parent.oi)&&this.parent.parent.hasChanged;},text:function(){return this.parent.parent.saveButtonText||mstrmojo.desc(9099,"Share");}},preBuildRendering:function(){if(!this.parent.parent.showButtonText){this.set("text","");}}}),c("",function(o){var p=this.parent.parent;p.close();p.set("hasChanged",false);},false,{iconClass:"mstrmojo-Editor-button-Close",bindings:{iconClass:function(){var o=this.parent.parent;if(o.hasChanged){return"mstrmojo-Editor-button-Cancel";}return"mstrmojo-Editor-button-Close";},text:function(){var o=this.parent.parent;if(!o.showButtonText){return"";}if(o.hasChanged){return mstrmojo.desc(2140,"Cancel");}return mstrmojo.desc(2102,"Close");}}})]}]});mstrmojo.MouseOverContainer=mstrmojo.declare(mstrmojo.StackContainer,null,{scriptClass:"mstrmojo.MouseOverContainer",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}" mstrAttach:mouseover,mouseout></div>',doSwitch:true,markupSlots:{containerNode:function(){return this.domNode;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?"block":"none";}},onmouseover:function(){if(this.doSwitch&&this.enabled){this.set("selected",this.children[1]);}},onmouseout:function(){if(this.doSwitch){this.set("selected",this.children[0]);}},preBuildRendering:function(){this.set("selected",this.children[0]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.Button","mstrmojo.form");var T=8,O=16,U=4,R=1,J=2,D=4,Q=8,B=16,M=268435456,I=536870912,A=1073741824,H=window.mstrConfig&&!window.mstrConfig.simpleDialog,L=2147755235,K=2147755236;var C="mstrmojo-oivmSprite ";function E(Y,X,W){if(H){mstrmojo.confirm(Y,{confirmBtn:{fn:X},cancelBtn:{fn:W}});}else{if(mstrmojo.confirm(Y)){if(X){X();}}else{if(W){W();}}}}function V(X,W){if(H){mstrmojo.alert(X,W,null,null,null,{allowHTML:true});}else{mstrmojo.alert(X);W();}}function N(W){var X=mstrmojo.findAncestor(this,"scriptClass","mstrmojo.DocInfoWindow");if(!!X){X[W?"registerLock":"releaseLock"](this);}}mstrmojo._DocActionSelector=mstrmojo.provide("mstrmojo._DocActionSelector",{_mixinName:"mstrmojo._DocActionSelector",extCls:"mstrmojo-ActionSelector",type:T,targets:null,initControlInfo:function G(){var W=this.node.defn;this.aa=parseInt(W.aa,10);this.dpTxt=W.dpTxt||{8:mstrmojo.desc(5369),4:mstrmojo.desc(8233),16:mstrmojo.desc(8232)}[this.aa]||"";this.dpCfm=W.dpCfm;this.sac=parseInt(W.sac,10);this.msg=W.msg;this.rsid=W.rsid;this.rst=W.rst;this.node.data.elms=[{n:this.dpTxt,v:this.dpTxt}];if(this._super){this._super();}},selectorControlChange:function(W){if(W.selectedIndex!==0){return ;}this.executeAction();W.select([]);},executeAction:function(){var X=this.aa,W=this,Y=function(){N.call(W,false);};N.call(W,true);if(X===T){if(this.dpCfm){E(mstrmojo.desc(8313),function(){W.onCommit();},Y);}else{W.onCommit();}}else{if(X===U){if(this.dpCfm){E(mstrmojo.desc(8322),function(){W.onDiscard();},Y);}else{W.onDiscard();}}else{this.onRecalculate();}}},postBuildRendering:function(){this._super();this.domNode.ontouchstart=function(W){mstrmojo.css.addClass(W.target,"glow");};this.domNode.ontouchend=function(W){mstrmojo.css.removeClass(W.target,"glow");};},onCommit:function(){var Z=this,a=this.model,X=Z.controller,W=mstrApp.useBinaryFormat;N.call(this,false);if(!W&&!this.validateRequiredObjects()){V(mstrmojo.desc(9200));return ;}var Y=function(b){if((Z.sac&I)>0){X.invalidClientCache();}if((Z.sac&B)>0){var c={did:Z.rsid,objType:Z.rst,forceExec:(Z.sac&M)>0};if((Z.sac&A)>0){c.linkAnswers='<hl mid="'+a.mid+'" srct="2" aopam="1"><prms></prms></hl>';}X.onExecuteNewObject(Z,c);}else{if((Z.sac&Q)>0){X.onReExecute(Z);}else{if(mstrApp.isMobile){X.generateActionToolbar();}a.transactionUpdate(b);}}};mstrmojo.mask.show("Running");a.sendTransactionActions(this.ck,T,a.newCallback({success:function(b){mstrmojo.mask.hide();if(a.txrcd||b.offln){X.offlineTransactionsSubmitted(Z.ck);}if(b.offln){if(W&&!Z.networkToastShowed){Z.networkToastShowed=true;mstrmojo.toast(mstrmojo.desc(9258,"No Network Connectivity")+". "+mstrmojo.desc(9259,"Transaction will be submitted when connectivity is resumed."));}a.transactionUpdate(b);}else{if((Z.sac&R)>0&&Z.msg){if(W){mstrmojo.toast(Z.msg);window.setTimeout(function(){Y(b);},100);}else{V(Z.msg,function(){Y(b);});}}else{Y(b);}}},failure:function(d){var b=mstrmojo.all.mojoAlertx9;if(b){b.destroy();}mstrmojo.mask.hide();if(a.txrcd){X.offlineTransactionsSubmitted(Z.ck);}var c=4294967296+parseInt(d.code,10);if(c===L){if(W){Z.validateRequiredObjects();}V(mstrmojo.desc(9200,"You have some required inputs that are not modified."));}else{if(c===K){var e=mstrmojo.desc(9201,"You haven't made any changes to submit.");if(W){mstrmojo.toast(e);}else{V(e);}}else{V(mstrmojo.base64.decodeHttpHeader(d.message),function(){if(!W){Z.controller.onReExecute(Z,true);}});}}}}));},onDiscard:function F(){var X=this,Y=this.model,W=X.controller;N.call(this,false);Y.txDiscardTargets=this.getTxTargets();Y.sendTransactionActions(this.ck,U,{success:function(Z){Y.transactionUpdate(Z);W.transactionDiscarded(X.ck);},complete:function(){delete Y.txDiscardTargets;if(mstrApp.isMobile){W.generateActionToolbar();}}});},onRecalculate:function(){N.call(this,false);this.model.sendTransactionActions(this.ck,O);},getTxTargets:function S(){var c=this.tks.split("\u001E"),b,W,a,d,X,Y,Z={};for(b=0,W=c.length;b<W;b++){a=c[b];d=1;do{X=this.model.getUnitInstance(a,d++);if(X&&X.checkRequiredObjects){if(X.isPanelStack){for(Y in X.txWidgets){Z[X.txWidgets[Y].id]=1;}}else{Z[X.id]=1;}}else{break;}}while(true);}return Z;},validateRequiredObjects:function P(){var W=true,X;for(X in this.getTxTargets()){W=mstrmojo.all[X].checkRequiredObjects()&&W;}return W;}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.elementHelper","mstrmojo.DocSelector","mstrmojo.ui.MultiSelectPulldown");var L=mstrmojo.hash,N=mstrmojo.elementHelper,I=mstrmojo.array,P=mstrmojo.DocSelector.STYLES;var K=0,B=1,C=2,F=4,G=1000;function J(Y){var X=null,T=null,W=0,V,U;for(V in Y){U=Number(V);W++;X=(X===null||X>U)?U:X;T=(T===null||T<U)?U:T;}return W===0||T-X===W-1;}mstrmojo.ListDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.ListDocSelector",formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P","height"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},_buildEvent:function H(p,X){var k=this.node,W=this.defn,g=k.data.elms,Y=[],q=X.multiSelect,Z=X.selectedIndices,e=X.allIdx,b=!!Z[e],m,j,n=[],d=this.include;if(!q){var T=g[X.selectedIndex],f=T.v;Y=[f];n=[f+";"+T.n];}else{if(b){j=g[e].v;Y=[j];n=[j];}else{if(Z[e]){Z[e]=false;}var o=L.keyarray(Z,true).sort(I.numSorter),h={};for(m in o){h[o[m]]=Z[o[m]];}Z=h;L.forEach(Z,function(t,r){if(t){Y.push(g[r].v);n.push(g[r].v+";"+g[r].n);}});}}this.defn.set("cek",Y);if(Y.length>0||!W.nsb||W.nsb===K){if(d&&parseInt(this.style,10)===F&&g&&g.length>G&&Y.length>g.length/2&&!this.isRecursiveAttributeSelector()){p.include=false;p.forceBuffer=true;p.requireToggle=true;var l=[],V=[];I.forEach(g,function(t,r){if(r!==e&&!Z[r]){l.push(t.v);V.push(t.v+";"+t.n);}});p.eid=((parseInt(p.type,10)===1)?V:l).join(N.ELEM_SEPARATOR);}else{p.eid=((parseInt(p.type,10)===1)?n:Y).join(N.ELEM_SEPARATOR);}}else{if(W.nsb===B||!W.showall){p.unset=true;}else{if(W.nsb===C){p.eid=N.ELEM_ALL_ID;}}}var a=mstrmojo.dom.position(X.domNode,true);if(a){p.left=a.x;p.top=a.y;}if(b&&this.multi&&d){I.forEach(g,function(t){var r=t.v;if(Y[0]!==r){Y.push(r);}});}if(W.sec){j=j||N.ELEM_ALL_ID;var c=I.filter(g,function(r){return r.v!==j;}).length,U=I.indexOf(Y,j)>=0||!W.multi?c:Y.length;if(W.style!==mstrmojo.DocSelector.STYLES.SCROLLER){this.parent.set("count",N.buildElemsCountStrByNum(U,c));}}},getCekEvtListener:function S(V,U){var T=V.defn.style;if(T===P.PULLDOWN||T===P.SCROLLER){return function(W){var a=U.items,b={};if(!U.multiSelect){var X=U.selectedIndex=I.find(a,"v",W.value[0]);if(X>-1){b[X]=true;}}else{var Z=U.allIdx;if(Z>-1&&I.indexOf(W.value,a[Z].v)>-1){for(var Y=0;Y<a.length;Y++){b[Y]=true;}}else{I.forEach(W.value,function(d){var c=I.find(a,"v",d);if(c>-1){b[c]=true;}});}}V.selIdx=U.selectedIndices=b;V.handleActionInSyncPhase(function(){U.refresh();});};}return this._super(V,U);},preBuildRendering:function A(){var V=this.node.defn.style,U=L.clone(this.formatHandlers),T=U.contentNode;if(T){if((V===P.RADIO||V===P.CHECKBOX)&&U.filterNode){T.push("fx");T.push("background-color");delete U.filterNode;}if(V===P.LIST){delete T.height;}}this.formatHandlers=U;return this._super();},getWidgetClass:function Q(V,U,T){if(U===P.PULLDOWN){return V.multi?"ui.MultiSelectPulldown":"ui.Pulldown";}return this._super(V,U,T);},getWidgetConfig:function D(Y,W,V,X){var U=Y.getFormats(),T=this._super(Y,W,V,X);if(W===P.SCROLLER){Y.extCls="extSlider";if(mstrApp&&mstrApp.isVI){T.isHoriz=true;}L.copyProps(["height","width"],U,T);}if(W===P.PULLDOWN&&!V.multi){T.isHostedWithin=false;T.onitemSelected=T.onchange;T.allowHTML=false;}return T;},updateWidget:function M(W){var X=this._super(W),T=W.selIdx;var U=X.items=W.node.data.elms;X.selectedIndices=T;if(!X.multiSelect&&U&&U.length){var V=L.keyarray(T);if(V.length===1){X.selectedIndex=Number(V[0]);}else{X.selectedIndices={};X.selectedIndex=-1;}}return X;},isSelectAll:function E(){var W=this.node.data.elms,V=this.children&&this.children[0],X=V.selectedIndices,U=V.allIdx,T=!!X[U],Y=(W[U]&&W[U].v)||N.ELEM_ALL_ID;if(this.include){return T||I.filter(W,function(Z){return Z.v!==Y;}).length===L.keyarray(X).length;}else{return L.isEmpty(X);}},destroy:function R(){var T=this.node.data;this._super();if(T.del){I.insert(T.elms,T.del.idx,T.del.elem);delete T.del;}},isValidSelection:function O(){var V=this.node,W=V.data,U=V.defn,X=W.ces,T=this.model;if(!U.multi&&X&&X.length>1&&!this.allowsTogglingMultiSelect()){return false;}if(U.style===mstrmojo.DocSelector.STYLES.SCROLLER&&!J(this.selIdx)){return false;}if(T.isSelWarnFlagOn(this.k)&&X&&X.length===0&&W.elms.length>0){return this.children[0].noneIdx&&this.children[0].noneIdx>-1;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._Formattable","mstrmojo.DocSelector","mstrmojo._IsSelectorTarget","mstrmojo.Serializer","mstrmojo._IsPanelStack","mstrmojo._HasBuilder","mstrmojo.array","mstrmojo.css","mstrmojo.hash");function E(N,M){var L=mstrmojo.array.find(N.node.data.panels,"k",N.selectedKey);L+=(M||0);N.set("selectedIdx",L);}function H(L){L.set("hasNextPanel",(L.selectedIdx<(L.node.data.panels.length-1)));L.set("hasPreviousPanel",(L.selectedIdx>0));}mstrmojo.DocPanelStack=mstrmojo.declare(mstrmojo.Container,[mstrmojo._Formattable,mstrmojo._IsSelectorTarget,mstrmojo._HasBuilder,mstrmojo._IsPanelStack],{scriptClass:"mstrmojo.DocPanelStack",markupString:'<div id="{@id}" k="{@k}" title="{@tooltip}" nm="{@n}" class="mstrmojo-DocPanelStack {@cssClass}" style="{@domNodeCssText}"><div></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},formatHandlers:{domNode:["RW","B","overflow"]},model:null,hasNextPanel:false,hasPreviousPanel:false,applyEnabled:false,clearEnabled:true,renderMode:"onshow",n:"",node:null,selectedIdx:undefined,selectedKey:"",init:function K(L){this._super(L);E(this);this.node.sw=(this.node.data.panels.length>1&&this.defn.sw);this.n=L.node.defn.n;},onselectedKeyChange:function I(M){var N=this._super(M),L=N.on;if(L._delayRefresh){if(!L.defn.dirtyKeys){L.refresh();}delete L._delayRefresh;}E(this);},updateSelectedIdx:function B(L){E(this,L);},onselectedIdxChange:function G(){H(this);},_bufferedSlices:null,canApply:function A(){var N,M;for(N in this.children){var L=this.children[N];if(!L.children){continue;}for(M in L.children){var O=L.children[M];if(O.defn&&O.defn.ttl!==undefined){O=O.children[1];}if(O&&O.canApply&&!O.canApply()){return false;}}}return true;},bufferSlice:function F(M){var L=this._bufferedSlices=this._bufferedSlices||[];L.push(M);this.set("applyEnabled",this.canApply());},applyBufferedSlices:function D(){var L=this._bufferedSlices;if(!L){return ;}this.model.slice({bufferedSlices:true,tks:(mstrmojo.hash.any(L)||{}).tks,events:L});this.clearBuffSlices();},clearBuffSlices:function(){this._bufferedSlices=null;this.set("applyEnabled",false);},_isFPS:function J(){return !!this.defn.ifp;},clearAllFilter:function C(){var P=mstrmojo.DocSelector.STYLES,L=this;if(!L._isFPS()){return ;}if(!(L.children&&L.children.length)){return ;}for(var O in L.children){var S=L.children[O];if(!S.children){continue;}for(var N in S.children){var T=S.children[N];if(T.defn.ttl!=="undefined"){T=T.children[1];}if(T.model){var R={tks:T.tks,ck:T.ck,ctlKey:T.ckey,unset:true};L.bufferSlice(R);T.node.data.ces=[];T.node.defn.cek=null;T.node.data.cs=[];var M=T.content;if(parseInt(T.node.defn.style,10)===P.SCROLLER){M.min=0;var Q=M.items&&M.items.length;M.max=Q?Q-1:0;}T.update(T.node);T.refresh();}}}},update:function(M){if(this._super){this._super(M);}var L=M.data&&M.data.selKey;if(L&&L!==this.selectedKey){this.defn.newSelKey=L;}},postBuildRendering:function(){this._super();if(this.defn.itb){mstrmojo.css.addClass(this.domNode,"tableControl");}}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.MetricSelectorUtility","mstrmojo.hash","mstrmojo.array");var E=mstrmojo.hash,J=mstrmojo.array;mstrmojo.MetricQualDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.MetricQualDocSelector",_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P","height"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},init:function N(O){this._super(O);this.spm=true;},initControlInfo:function M(){this._super();var P=mstrmojo.MetricSelectorUtility,R=this.node,S=R.data,Q=R.defn;E.copyProps(["srcid","srct"],Q,this);this.qua=S.qt;this.dt=S.dt;var O=P.getOpIdxByfunc(S.f,S.ft);if(O!==-1){this.include=P.getIncludeByOp(O);}},canApply:function D(O){return true;},onquaChange:function H(O){this.node.data.qt=O.value;},_buildEvent:function F(R,Q){var P=[];J.forEach(Q.cs,function(S){P.push(S.v);if(R.dtp===undefined){R.dtp=S.dtp;}});if(P.length){R.cs=P.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}var O=mstrmojo.MetricSelectorUtility.getFuncInfo(Q.opId,Q.qua);R.f=Q.f=O.f;R.ft=Q.ft=O.ft;R.include=this.defn.include=this.include=Q.include;R.ckey=this.ckey;R.srcid=this.srcid;R.srct=this.srct;R.unset=Q.unSet;R.onlyInclude=Q.onlyInclude;if(Q.changeInclude){R.changeInclude=Q.changeInclude;R.forceApply=true;Q.changeInclude=false;}if(Q.changeQual){R.changeQual=Q.changeQual;Q.changeQual=false;}R.qt=Q.qua;this.node.defn.set("cek",{id:this.id,f:Q.f,ft:Q.ft,cs:Q.cs,qua:Q.qua,include:Q.include});},preBuildRendering:function K(){var O=this._super();if(this.isInFilterPanel()&&!this.isHorizFP()){this.children[0].width=this.parent.parent.contentWidth;}return O;},postBuildRendering:function B(){this._super();if(this.formatHandlers.filterNode){var O=this.getFormats();if(!O.height){this.updateHeight();}}},getCekEvtListener:function C(P,O){return function(Q){P.handleActionInSyncPhase(function(){P.set("qua",Q.value.qua);if(P.id!==Q.value.id){O.updateExpr(Q.value);if(P.style===mstrmojo.DocSelector.STYLES.METRIC_SLIDER){P.set("include",Q.value.include);}}});};},updateWidget:function L(S){var T=this._super(S),P=S.node,O=S.selIdx,R=P.data,Q=R.elms;if(T.updateData){T.numFmts=S.defn.numFmts;S.handleActionInSyncPhase(function(){T.updateData({low:R.min,high:R.max,cnt:R.cnt,nov:R.nov},{cs:R.cs,f:R.f,ft:R.ft,qua:R.qt});});}T.items=Q;T.selectedIndices=O;return T;},newAndInitWidget:function I(O){var P=this._super(O);O.attachEventListener("quaChange",P.id,function(Q){this.set("qua",Q.value);});return P;},getWidgetConfig:function G(T,R,Q,S){var P=T.getFormats(),O=this._super(T,R,Q,S);E.copyProps(["height","width","font"],P,O);E.copyProps(["cs","ft"],Q,O);O.fmts=Q.f;O.dt=T.dt;O.qua=T.qua;O.numFmts=Q.numFmts;return O;},isSelectAll:function A(){var Q=mstrmojo.MetricSelectorUtility.OP,P=this.children&&this.children[0],O=P&&(Q._IS_NULL===P.opId||Q._IS_NOT_NULL===P.opId);return P===undefined?true:(!P.cs||P.cs.length===0)&&!O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.array","mstrmojo.elementHelper");var I=mstrmojo.array,F=mstrmojo.DocSelector.ELEM_ALL_ID,H=mstrmojo.elementHelper;var C=0,K=1,J=2;var B=1,M=3;function A(O){I.forEach(O,function(P){P.n=P.v;});return O;}mstrmojo.TextBoxDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.TextBoxDocSelector",_ieformatHandlers:{domNode:["font","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["font","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},_fetchOnInit4UCOnDS:function G(){},_getSelectionCount:function L(P){var O=P.items;return O?O.length:0;},_buildEvent:function D(R,Q){var O=[],P=this.defn;I.forEach(Q.items,function(S){O.push(S.v);});if(O.length>0||P.nsb===C){R.eid=O.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}else{R.eid="";}if(P.sec){this.parent.set("count",H.buildElemsCountStrByNum(O.length,0));}},updateWidget:function N(Q){var R=this._super(Q),O=Q.node,P=O.data;R.items=P.vs?A(P.vs.concat()):[];return R;},getWidgetConfig:function E(U,R,Q,T){var P=U.getFormats(),S=U.node.data,O=this._super(U,R,Q,T);O={scriptClass:O.scriptClass,cssText:P.height?"height: "+P.height:"",emptyText:mstrmojo.desc(4325,"Search")+" "+(Q.ttl||""),items:S.vs?A(S.vs.concat()):[],srcid:Q.srcid||"",dsrc:Q.dsrc||"",onitemsChange:function(){if(!U._inSyncPhase){U.selectorControlChange(this);}}};if(!Q.multi){O.maxObjectCount=1;}return O;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.Button","mstrmojo.Editor","mstrmojo.ME.MetricDataService","mstrmojo.ME._MetricEditorHelper");mstrmojo.requiresDescs(12852);var J=mstrmojo.expr,A=mstrmojo.array,G=mstrmojo.hash,M=mstrmojo.ME._MetricEditorHelper,B=mstrmojo.ME.Enum.DYNAMIC_DIMTY,L=mstrmojo.ME.Enum.UI_DATA_TYPE,I=mstrmojo.ME.Enum.UI_OBJECT_TYPE,F=mstrmojo.ME.MetricToken.brackets;var K;function Q(){var E=mstrmojo.all[K];if(E&&E.onmetricModify){E.onmetricModify();}}function C(){var E=mstrmojo.all[K];if(E&&E.updateScrollbars){E.updateScrollbars();}}mstrmojo.ME.SortByInputList=mstrmojo.declare(mstrmojo.WidgetList,null,{makeObservable:true,isNewDef:true,isDME:false,init:function R(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ME-sortby");},preBuildRendering:function(){var E=this.items||[];if(this.isNewDef&&this.isDME){E.push(B.getAutomaticDimtyObject());}E.push({n:""});this.items=E;if(this._super){this._super();}},getTokens:function(){var W=this.items,E=W.length-1,V,a=[];if(E>0){a.push({v:"SortBy"});a.push({v:"=",isDelimiter:true});a.push({v:"(",isDelimiter:true});for(V=0;V<E;V++){var Y=W[V],Z=Y.selFrm,U,X=false;if(M.isDimty(Y.n)){U={v:Y.n};X=true;}else{if(/^@/.test(Y.did)){U={v:Y.did};X=true;}else{U={v:F(Y.n),oi:Y};}}if(Z&&(Y.t===J.TP.ATTR||(Y.t===J.TP.CONS&&Y.st===J.STP.NDE))){G.copy({v:F(Y.n)+"@"+F(Z.n),exv:Z.dssid,extp:8},U);}a.push(U);if(!X){if(!!Y.asc){a.push({v:"Desc",tp:259});}}if(V!==(E-1)){a.push({v:",",isDelimiter:true});}}a.push({v:")",isDelimiter:true});}return a;},itemFunction:function(X,E,U){return new mstrmojo.Box({cssClass:"mstrmojo-ME-sortby-item",alias:"sortByItem",parent:U,children:[{scriptClass:"mstrmojo.ME.ObjectInputBox",alias:"sortByInput",cssClass:"mstrmojo-ME-ObjectInputBox-sortby",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(3377,"Object").toLowerCase()),isDME:U.isDME,dtp:L.Sortby,maxObjectCount:1,folderLinksContextId:16,browsableTypes:[J.TP.ATTR,J.TP.METRIC,J.TP.FOLDER].join(","),getCandidatesThroughTaskCall:function Z(c,b){c.objectType=J.TP.ATTR+","+J.TP.METRIC;c.rootFolderType=39;c.blockCount=c.blockCount||this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(c,b);},obCfg:{folderLinksContextId:16,browsableTypes:[J.TP.ATTR,J.TP.METRIC,J.TP.FOLDER].join(",")},bindings:{candidates:"this.parent.parent.candidates"},postCreate:function(b){if(!b){this.set("items",X.did||X.dimty?[X]:null);}},onitemchange:function(){var d=this.getSelectedObjects()[0];if(!d||!d.did&&!d.n){return ;}X.selFrm=null;mstrmojo.hash.copy(d,X);var c=this.parent.formsPulldown;if(c){c.updateForms(d);}var b=this.parent.ascPulldown;if(b){b.set("visible",X.t===4||X.st===J.STP.NDE);}Q();},onadd:function V(){if(this.getSelectedObjects().length===0){return ;}if(this.parent===U.ctxtBuilder.itemWidgets[U.items.length-1]){U.add([{n:""}]);this.parent.del.set("visible",true);}},hidePulldownButton:function(){return !U.isDME;},hideDelButton:function(){return true;},hideItemWidgetBrowseButton:function(){return U.isDME;},getItemsToFilterOut:function(){return U.items;}},{scriptClass:"mstrmojo.Pulldown",alias:"formsPulldown",cssClass:"mstrmojo-ME-sortby-forms mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",defaultSelection:-1,bindings:{visible:function(){return this.items&&this.items.length>0;}},popupToBody:true,popupZIndex:100,postCreate:function(){this.retrieveDssForms(X);},retrieveDssForms:function W(d){var c=this,b=function(){var l=function(m){d.dssforms=m;c.set("items",d.dssforms);c.selectedIndex=-1;c.selectedItem=null;c.value=null;c.set("value",d.selFrm);};var j=c.parent.sortByInput.candidates,e=j&&j.items;if(d.did&&e){var h=A.find(e,"did",d.did);if(h>-1){var g=mstrmojo.hash.clone(e[h].fs);if(g){A.forEach(g,function(m){m[c.itemIdField]=m.fid;m[c.itemField]=m.fnm;});l(g);return ;}}}var k=function(m){if(m){var n=m.container;if(n&&n.dssforms){d.dssforms=n.dssforms;l(d.dssforms);}}},f=function(m){mstrmojo.alert(m.getResponseHeader("X-MSTR-TaskFailureMsg"));};mstrmojo.ME.MetricDataService.getAttributeForms({attributeID:d.did,displayedForms:0},{success:k,failure:f});};switch(d.t){case J.TP.ATTR:b();break;case J.TP.CONS:if(d.st===J.STP.NDE){c.set("visible",false);}break;case J.TP.METRIC:c.set("visible",false);break;case I.Dimty:c.set("visible",false);break;}},updateForms:function Y(b){this.retrieveDssForms(b);},onvalueChange:function a(){if(this.selectedItem){X.selFrm=this.selectedItem;}if(this.hasRendered){Q();}}},{scriptClass:"mstrmojo.Pulldown",alias:"ascPulldown",cssClass:"mstrmojo-ME-sortby-asc mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:[{n:"Ascending",v:0},{n:"Descending",v:1}],itemIdField:"v",popupToBody:true,popupZIndex:100,visible:false,bindings:{value:function(){return this.parent.parent.items[E].asc;},visible:function(){var b=this.parent.sortByInput.getSelectedObjects()[0];return this.parent.formsPulldown.visible&&this.parent.formsPulldown.value||b.t===J.TP.METRIC||b.st===J.STP.NDE;}},onvalueChange:function(b){X.asc=this.value;if(this.hasRendered){Q();}}},{scriptClass:"mstrmojo.Button",alias:"del",cssClass:"mstrmojo-ACLEditor-delete",text:"&nbsp",title:mstrmojo.desc(629,"Delete"),bindings:{visible:function(){var b=U.itemIndex(X);return this.parent.parent.items[b].did;}},onclick:function(){U.remove(U.items[U.itemIndex(X)]);Q();}}]});},onadd:function H(){C();},onremove:function S(){C();}});mstrmojo.ME._HasSortBy=mstrmojo.provide("mstrmojo.ME._HasSortBy",{_mixinName:"mstrmojo.ME._HasSortBy",ios:false,oniosChange:function P(E){this.sortByContainer.set("visible",E.value);},onOpen:function(){if(this._super){this._super();}K=this.id;var U=this.oi.tks,V=!U.met;var E=this.sortByContainer&&this.sortByContainer.sortByWidgetList;if(E){E.set("isNewDef",V);E.set("isDME",this.isDME);E.set("candidates",this.getCandidates4Sortby());E.set("items",this.getSortByDefFromTokens().items||[]);}},getCandidates4Sortby:function T(){var U=this.candidates,E;if(U&&!this.noCache){E=A.filter(U.items,function(V){return V.t===J.TP.ATTR||V.t===J.TP.METRIC||V.st===J.STP.NDE;});if(this.isDME){E=B.getItems("sortby").concat(E);}}return{items:E||[],isComplete:U&&U.isComplete};},getSortByWidget:function D(E){var W=this,V=[{scriptClass:"mstrmojo.ME.SortByInputList",alias:"sortByWidgetList",cssClass:"sortBy mstrmojo-ME-sortby",cssDisplay:"table-cell"}],U={scriptClass:"mstrmojo.Label",alias:"sortByLabel",cssClass:"mstrmojo-ME-SortBy-label",cssDisplay:"table-cell",text:mstrmojo.desc(12852,"Sort By")};if(E){V.unshift(U);}return{scriptClass:"mstrmojo.Box",alias:"sortByContainer",cssClass:"mstrmojo-ME-SortBy-Container",cssDisplay:"table-row",visible:W.ios,postCreate:function(){W.sortByContainer=this;this.editor=W;},getTokens:function(){return this.sortByWidgetList.getTokens();},children:V};},getSortByDefFromTokens:function N(){var a=this.oi.tks.items,W=a.length,b,Y,U,V,X={};for(V=0;V<W;V++){b=a[V];Y=b.tp;U=b.sctt;if(mstrmojo.ME.MetricToken.isDelimiter(b.v)&&(b.v!=="("&&b.v!==")")||b.v==="&gt;"||b.v==="&lt;"){continue;}switch(U){case 131072:if(Y===302){b=a[++V];while(b){if(b.tp!==282){if(b.oi){b.oi.selFrm=b.exv;var Z=a[V+1];if(Z.v==="Desc"&&Z.tp===259){b.oi.asc=1;V++;}X.items=X.items||[];X.items.push(b.oi);}else{if(b.tp===64){X.items=X.items||[];var E=b.v+a[++V].v;b=a[V+1];if(b.tp===43||b.tp===45){E+=a[++V].v;E+=a[++V].v;}X.items.push(B.getDimtyObject(E,this.isDME));}}}if((b=a[++V])["v"]===")"){break;}}}}}return X;},getSortByDefAsTokens:function O(){return this.sortByContainer.getTokens();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ObjectInputBox","mstrmojo.ME.MetricDataService","mstrmojo.ME._MetricEditorHelper","mstrmojo.ui.ScrollableSuggestionList");var H=mstrmojo.expr,O=mstrmojo.Enum_OIB_States,J=mstrmojo.ME._MetricEditorHelper,R=mstrmojo.dom;mstrmojo.ME.ObjectInputBox=mstrmojo.declare(mstrmojo.ObjectInputBox,null,{cssClass:"",autoSelect:false,suggestionListClass:"mstrmojo.ui.ScrollableSuggestionList",suggestionPopupCssClss:"mstrmojo-ME-ObjectInputBox-suggest",blockCount:mstrmojo.ME.MetricDataService.blockCount,suggestCount:mstrmojo.ME.MetricDataService.suggestCount,useKeyDelay:true,showDesc:true,showPath:true,showFunctionSyntaxAsPath:true,emptyText:"Search for an object",showEmptyItem:false,noEditButton:true,browseItemVisible:true,click2edit:true,showSuggestionOnEdit:false,tabNavigable:true,obCfg:{},dynamicVerify:true,init:function P(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ME-ObjectInputBox");if(this.isDME){this.browseItemVisible=!this.isDME;this.suggestCount=this.isDME?1000:mstrmojo.ME.MetricDataService.suggestCount;this.REQUEST_THRESHOLD=1000;this.dynamicVerify=false;}},item2textCss:function D(W){if(this.isDME){return mstrmojo.ME._MetricEditorHelper.item2textCss(W);}var E=this._super(W)||{1:"f",4:"m",12:"a",13:"fc",43:"tr","-1":"rl","-99":"br"}[W.t]||"";return E?" icn "+E:"";},itemFunction:function B(X,E,W,Y){X[W.itemIdField]=W.nextId();var Z=Y||mstrmojo.ME.ObjectItem,a=new Z({parent:W,itemField:W.itemField,cssClass:W.item2textCss(X),data:X,bindings:{isFull:"this.parent.isFull"},onisFullChange:function(){if(this.hasRendered){this.updateButtonsVisibility();}}});W.attachEventListener4ItemWidget(a,W);return a;},getActiveItem:function M(){var E=this.editingIdx,X,W;if(E>-1){X=this.ctxtBuilder.itemWidgets[E];W=X&&X.data;}return W;},showObjectBrowser:function(E){this.set("suggestTarget",E);this.handleSuggestionItemSelect({t:-99},this.obCfg);},hideItemWidgetBrowseButton:function S(){return false;},hidePulldownButton:function G(){return true;},hideDelButton:function A(){return false;},dtp:0,verifyObject:function C(W,E){if(!this.dynamicVerify){return O.VALID;}var Y=E.data;var X=parseInt(this.dtp,10);switch(X){case -1:case -2:case -4:case -5:case -6:if(Y.t===-1||J.isDimty(W,X===-1)){return O.VALID;}if(this.dynamicVerify){return this._super(W,E);}return Y.did?O.VALID:O.INVALID;case 1:case 2:case 3:case 4:case 5:case 6:case 7:if(Y.t<0){return O.VALID;}if(/^\d{1,}$/.test(mstrmojo.string.trim(W))||Y.did){return O.VALID;}if(this.dynamicVerify){return this._super(W,E);}return O.INVALID;default:return O.VALID;}},getItemsToFilterOut:function N(){return this.items;},updateSuggestion:function Q(E){var X=this.getActiveItem();var W=this.getItemsToFilterOut();E=mstrmojo.array.filter(E,function(a){var Z=a.did,Y=false,c;var b=function(d){mstrmojo.array.forEach(W,function(e){if(e!==X&&e.did===d){Y=true;return false;}});};b(Z);if(!Y){c=a;}return c;});if(this._super){this._super(E);}},nudge:function I(W){W.domNode.style.minWidth=this.suggestTarget.domNode.offsetWidth+(this.isDME?13:0)+"px";var X=R.position(W.domNode),Y=R.position(this.suggestTarget.domNode),E=R.windowDim();if(X.y+X.h>E.h){W.domNode.style.top=(Y.y-X.h-5)+"px";}}});mstrmojo.ME.ObjectItem=mstrmojo.declare(mstrmojo.ObjectItem,[mstrmojo._HasPopup],{markupString:'<div id={@id} class="mstrmojo-ObjectItem" style="{@cssText}"><div class="mstrmojo-ObjectItem-displayNode" tabindex="0" mstrAttach:click,focus><span class="mstrmojo-ObjectItem-text {@cssClass}"></span></div><div class="mstrmojo-ObjectItem-editNode"><input type="text" class="mstrmojo-ObjectItem-input" placeholder="{@placeholderText}" mstrAttach:keyup,keydown/></div><div class="mstrmojo-ObjectItem-icons"><div class="mstrmojo-ObjectItem-down" onclick="mstrmojo.all[\'{@id}\'].showSuggestion(\'\')"></div><img class="mstrmojo-ObjectItem-browse" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1825,"Browse")+'" onclick="mstrmojo.all[\'{@id}\'].browse()"/><div class="mstrmojo-ObjectItem-opts" title="'+mstrmojo.desc(9598,"Level options")+'" onclick="mstrmojo.all[\'{@id}\'].options(arguments[0])" style="display:none;"></div><img class="mstrmojo-ObjectItem-edit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(1088,"Edit")+'" onclick="mstrmojo.all[\'{@id}\'].edit()"/><img class="mstrmojo-ObjectItem-del" src="../images/1ptrans.gif" title="'+mstrmojo.desc(629,"Delete")+'" onclick="mstrmojo.all[\'{@id}\'].del(arguments[0])" style="display:none;"/></div></div>',markupSlots:{displayNode:function(){return this.domNode.firstChild;},editNode:function(){return this.domNode.childNodes[1];},textNode:function(){return this.domNode.firstChild.firstChild;},pulldownButtonNode:function(){return this.domNode.lastChild.childNodes[0];},browseButtonNode:function(){return this.domNode.lastChild.childNodes[1];},optionButtonNode:function(){return this.domNode.lastChild.childNodes[2];},editButtonNode:function(){return this.domNode.lastChild.childNodes[3];},delButtonNode:function(){return this.domNode.lastChild.lastChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild;}},init:function P(E){this._super(E);this.placeholderText=this.parent.emptyText;},initState:function T(){var W=this.parent,X=this.data,E=X.state;if(W.dynamicVerify){return this._super();}if(typeof E==="undefined"){E=W.verifyObject(X[this.itemField],this);X.state=E;}return E;},updateButtonsVisibility:function F(){if(this._super){this._super();}if(this.parent.hidePulldownButton()){this.pulldownButtonNode.style.display="none";}if(this.parent.hideItemWidgetBrowseButton()){this.browseButtonNode.style.display="none";}this.optionButtonNode.style.display=this.data.state!==O.ADDING&&this.optionButtonVisible?"":"none";this.delButtonNode.style.display=this.data.state!==O.ADDING&&!this.parent.hideDelButton()&&!this.isFull?"":"none";},browse:function L(){this.set("state",this.data.state===O.ADDING?O.ADDING:O.EDITING);this.parent.showObjectBrowser(this);},click2edit:function K(){if(this.parent.click2edit){this.edit();}},onclick:function V(){this.click2edit();},onfocus:function U(){this.click2edit();}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.Label","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.ui.editors.controls.LineStyleButton","mstrmojo.color","mstrmojo.hash","mstrmojo.models.FormatModel");var N=mstrmojo.color,K="fillColor",C="border",B=1,I=2,D=mstrmojo.models.FormatModel,H=D.ENUM_PROPERTY_NAMES,E=H.BACKGROUND_COLOR,A={all:{c:H.BORDER_COLOR,s:H.BORDER_STYLE},top:{c:H.BORDER_TOP_COLOR,s:H.BORDER_TOP_STYLE},right:{c:H.BORDER_RIGHT_COLOR,s:H.BORDER_RIGHT_STYLE},bottom:{c:H.BORDER_BOTTOM_COLOR,s:H.BORDER_BOTTOM_STYLE},left:{c:H.BORDER_LEFT_COLOR,s:H.BORDER_LEFT_STYLE}};function G(Q,O){O.forEach(function(S,R){S.slot="col"+(R+1)+"Node";});var P=this.secondColumnWidth;return{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:Q,col1Width:(100-P)+"%",col2Width:P+"%",children:O};}function J(Q,O,P){return mstrmojo.hash.copy(P,{scriptClass:"mstrmojo.ui.editors.controls.ColorPickerButton",showGradient:!!O,postselectedValueChange:function(R){this.parent.parent.raiseFormatValueChange(Q,R.value,R.valueWas);}});}function F(R){var Q="transparent",O="none",P;if(R){P=R.indexOf("#");if(P===-1){P=R.indexOf(Q);}}if(!isNaN(P)&&P>-1){O=R.substr(0,P-1);Q=N.fixFullHexValue(R.substr(P));}else{O=R;}if(O.indexOf("none")>-1){O="none";}return{s:O,c:Q};}mstrmojo.ui.editors.controls.ContainerGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,null,{scriptClass:"mstrmojo.ui.editors.controls.ContainerGroup",borderTitle:mstrmojo.desc(13631,"Outer border:"),showThickBorderStyle:true,showBackgroundNoFill:true,showBorderNoFill:true,visibleControls:B+I,targetBorder:"all",secondColumnWidth:60,init:function L(R){this._super(R);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditContainer");var Q=[],P=this.visibleControls,O=A[this.targetBorder];if((P&B)>0){Q.push(G.call(this,K,[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(7993,"Fill color:")},J(E,true,{showNoFill:this.showBackgroundNoFill})]));}if((P&I)>0){Q.push(new mstrmojo.Label({text:this.borderTitle}));Q.push(G.call(this,C,[{scriptClass:"mstrmojo.ui.editors.controls.LineStyleButton",showThickOption:this.showThickBorderStyle,postselectedValueChange:function(S){var T=this.parent.parent;T.raiseFormatValueChange(O.s,S.value,S.valueWas);T[C].getControl(2).set("enabled",S.value!=="none");}},J(O.c,false,{showNoFill:this.showBorderNoFill})]));}this.addChildren(Q);},setFormatSource:function M(P){var O=this[K],S=this[C],R=this.targetBorder,Q=A[R];if(R==="all"){Q=A.top;}this.syncControls(function(){if(O){var V=D.getGradientValues(P),Y;if(!V){if(P[H.FILL_STYLE]===1){Y="transparent";}else{var U=P[E];if(typeof U==="undefined"||U===null){U=P["background-color"];}if(typeof U==="undefined"||U===null){U=-1;}Y=D.decodeValue(E,U);}}O.getControl(2).set("selectedValue",V||Y);}if(S){var W=P.border;if(!W){if(typeof (P.borderStyle)!=="undefined"&&P.borderStyle!==null){W=typeof (P.borderStyle)==="string"?P.borderStyle:D.decodeValue("borderStyle",P.borderStyle);}else{W=D.decodeValue(Q.s,P[Q.s]);}if(typeof P.borderColor!=="undefined"&&P.borderColor!==null){W+=" "+D.decodeValue("borderColor",P.borderColor);}else{if(typeof P[Q.c]!=="undefined"&&P[Q.c]!==null){W+=" "+D.decodeValue(Q.c,P[Q.c]);}else{W+=" "+D.decodeValue(Q.c,-1);}}}var X=F(W),T=S.getControl(2);S.getControl(1).set("selectedValue",X.s);T.set("enabled",X.s!=="none");T.set("selectedValue",X.c);}});}});mstrmojo.ui.editors.controls.ContainerGroup.CTRL_FLAGS={FILL_COLOR:B,BORDER:I};}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo._HasMarkup","mstrmojo.ui.menus._HasMenuPopup","mstrmojo.dom","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.css");var E=mstrmojo.css,F=mstrmojo.dom;mstrmojo.threshold.ColorBand=mstrmojo.declare(mstrmojo.ui.editors.controls.ColorPickerButton,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.threshold.ColorBand",hovered:false,selected:false,index:undefined,showGradient:false,showNoFill:false,markupString:'<div class = "color-band mstrmojo-ui-PreviewButton {@cssClass}" id="{@id}" style="{@cssText}" mstrAttach:click,keyup,contextmenu,mouseover,mouseout><div class="host mstrmojo-ui-PreviewButton"></div></div>',markupSlots:{previewNode:function(){return this.domNode;},btnNode:function(){return this.domNode;},clickableNode:function(){return this.domNode;},widgetHostNode:function(){return this.domNode.lastChild;}},select:function(){this.set("selected",true);},unselect:function(){this.set("selected",false);},onhoveredChange:function C(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onBandHovered(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onBandUnhovered(this.index);}},onselectedChange:function B(I){if(I.valueWas===false&&I.value===true){E.toggleClass(this.domNode,"selected",true);this.parent.onBandSelected(this.index);}else{E.toggleClass(this.domNode,"selected",false);this.parent.onBandUnselected(this.index);}this.parent.onBandUnhovered(this.index);},onmouseover:function H(){this.set("hovered",true);},onmouseout:function D(){this.set("hovered",false);},oncontextmenu:function G(I){F.preventDefault(window,I.e);var K=this,J=K.parent.parent;var L=new mstrmojo.ui.menus.MenuConfig({position:F.getMousePosition(I.e,I.hWin),isHostedWithin:false});L.addMenuItem(mstrmojo.desc(7604,"Change Color"),"",function(){K.onclick(I);});L.addMenuItem(mstrmojo.desc(13386,"Add Color Band"),"",function(){var N=J.markers;var O=F.position(N.containerNode),M=I.e.clientX-O.x;N.addMarker(M);});L.addMenuItem(mstrmojo.desc(629,"Delete"),"",function(){K.unselect();J.bands.remove(K.index);J.update();});this.openPopup(L.newInstance());},postselectedValueChange:function(J){var K=this.parent.parent,I=K.parent,M=K.getPalette().concat();if(J){var L=J.value;if(K.getReversedValue()){M.reverse();}this.backgroundColor=M[this.index]=L;I.switchToCustomScheme(undefined,M);}}});mstrmojo._HasMarkup.addMarkupMethods(mstrmojo.threshold.ColorBand,{onwidthChange:mstrmojo.Widget.widthMarkupMethod,onleftChange:mstrmojo.Widget.leftMarkupMethod,onbackgroundColorChange:function A(){this.selectedValue=this.backgroundColor;this.updatePreview();this.colorPicker.set("color",this.selectedValue);}});}());(function(){mstrmojo.requiresCls("mstrmojo.ui.Pulldown","mstrmojo.ui.ButtonBar","mstrmojo.ui.editors.controls.ComboBox","mstrmojo.ui.editors.controls.ColorPickerButton","mstrmojo.NumGroupStepperContentProvider","mstrmojo._FormatDefinition","mstrmojo.models.FormatModel");var F=mstrmojo._FormatDefinition,R=mstrmojo.models.FormatModel,J=R.ENUM_PROPERTY_NAMES,I=1,E=2,N=4,C=8,H=16;var P;var K;var G={bold:J.FONT_WEIGHT,italic:J.FONT_STYLE,underline:J.UNDERLINE,strikeout:J.LINE_THROUGH};function B(S){return(S&H)>0;}function Q(T){var W=J.FONT_FAMILY,S=T[W]||R.getFormatBlockValue(T,W),U=this.hcgControls.fontFamily;if(S===-1){var V=U&&U.list;if(!V){return ;}V.clearSelect();delete U.selectedIndex;if(U.hasRendered){U.refresh();}}else{U.set("selectedIndex",Math.max(K.map(function(X){return X.n;}).indexOf(S)));}}function O(S){var T=[],U=function(X,Y,V){var W=S[X];if(W===undefined){W=R.getFormatBlockValue(S,X);}if(W){T.push(V);}};U(J.FONT_WEIGHT,"bold",0);U(J.FONT_STYLE,"italic",1);U(J.UNDERLINE,"underline",2);U(J.LINE_THROUGH,"line-through",3);this.hcgControls.fontStyle.select(T);}function L(S){var Y=this.hcgControls,V=J.FONT_SIZE,T=J.COLOR,X=S[V]||R.getFormatBlockValue(S,V),U=Y.fontSize;var W=S[T];if(typeof W==="undefined"||W===null){W=R.getFormatBlockValue(S,T);}if(typeof W==="undefined"||W===null){W="";}if(B(this.visibleControls)){if(X.length){U.provider.set("curValGroup",X);}}else{if(X===-1){U.list.clearSelect();U.selectedValue="";U.updatePreview();}else{U.set("selectedValue",X?(parseInt(X,10)).toString():U.items[0].n);}}Y.fontColor.set("selectedValue",W===""?"conflict":R.decodeValue(J.COLOR,W));}function M(){if(P&&K){return ;}P=F.SizesInVI.map(function(S){return{idx:parseInt(S.n,10),n:S.n};});K=mstrmojo._FormatDefinition.Families.slice(1).map(function(S){return{n:S.n,id:S.n};});}mstrmojo.ui.editors.controls._HasCharacterGroup=mstrmojo.provide("mstrmojo.ui.editors.controls._HasCharacterGroup",{_mixinName:"mstrmojo.ui.editors.controls._HasCharacterGroup",visibleControls:I+E+N,showNoFillInColor:true,hcgControls:null,getHCGControls:function D(U){M();var T=this.hcgControls={},S=this.visibleControls;if((S&I)>0){T.fontFamily=mstrmojo.ui.Pulldown.newPulldown(K,function(W,X){U(J.FONT_FAMILY,W.id,X&&X.id);},0,{isHostedWithin:false});}if((S&E)>0||(S&C)>0){var V=T.fontStyle=new mstrmojo.ui.ButtonBar({multiSelect:true,items:[{n:mstrmojo.desc(2718,"Bold"),id:"b",css:"bold"},{n:mstrmojo.desc(2719,"Italic"),id:"i",css:"italic"},{n:mstrmojo.desc(2720,"Underline"),id:"u",css:"underline"},{n:mstrmojo.desc(3062,"Strikeout"),id:"s",css:"strikeout"}],postselectionChange:function(W){var Y=W.added,Z=this.items[Y?Y[0]:W.removed[0]],X=!!Y;if(Z){U(G[Z.css],X,!X);}}});if((S&C)>0){V.items.pop();}}if((S&N)>0){T.fontSize=B(S)?new mstrmojo.ui.editors.controls.Stepper({provider:new mstrmojo.NumGroupStepperContentProvider({item:{interval:1},curValGroup:[],min:Math.min.apply(Math,P.map(function(W){return W.idx;})),max:Math.max.apply(Math,P.map(function(W){return W.idx;})),container:this,onTraverse:function(){var W=this.container.fontSize;if(W._sync){return ;}this.container.raiseFormatValueChange(J.FONT_SIZE,W.provider.getValGroup());},oncurValGroupChange:function(){var W=this.container.fontSize;if(W.textNode){W.updateDisplayText();}}})}):new mstrmojo.ui.editors.controls.ComboBox({selectedValue:"10",items:P,isHostedWithin:false,validateTextInput:function(W){return(/^[0-9]+(pt)?$/.test(W));},updateSelection:function(){this.set("selectedValue",parseInt(this.txtLabel.value,10).toString());},postselectedValueChange:function(W){U(J.FONT_SIZE,parseInt(W.value,10)+"pt",parseInt(W.valueWas,10)+"pt");}});T.fontColor=new mstrmojo.ui.editors.controls.ColorPickerButton({showGradient:false,showNoFill:this.showNoFillInColor,selectedValue:"#000000",postselectedValueChange:function(W){U(J.COLOR,W.value,W.valueWas);}});}return T;},setFormatSource:function A(S){var T=this;this.syncControls(function(){var U=this.visibleControls;if((U&I)>0){Q.call(T,S);}if((U&E)>0||(U&C)>0){O.call(T,S);}if((U&N)>0){L.call(T,S);}});}});mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS={FONT_FAMILY:I,FONT_STYLE:E,FONT_SIZE_AND_COLOR:N,FONT_STYLE_NO_STRIKEOUT:C,FONT_SIZE_USE_STEPPER:H};mstrmojo.ui.editors.controls._HasCharacterGroup.ControlsType=null;}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.registry","mstrmojo.css","mstrmojo.Arr","mstrmojo.expr","mstrmojo.Label","mstrmojo.AjaxCall","mstrmojo.HTMLButton","mstrmojo.Container","mstrmojo._HasPopup","mstrmojo.HBox","mstrmojo.Dial","mstrmojo.WidgetDial","mstrmojo.ValidationTextBox","mstrmojo.Calendar","mstrmojo.DateTextBox","mstrmojo.Editor","mstrmojo.ObjectBrowser","mstrmojo.ElementsBrowser","mstrmojo.ConditionModel","mstrmojo.mstr.EnumNodeDimty");var D=mstrmojo.css,A=mstrmojo.registry,U=mstrmojo.hash,v=mstrmojo.array,F=v.find,H=mstrmojo.Arr,S=mstrmojo.expr,T=mstrmojo.dom,M=S.ET,AC=S.DTP,m=S.DTP2FN_DTP,W=S.ET2TGT,k=S.ET2TP,C=mstrmojo.meta.TP,P=mstrmojo.meta.STP,AA=mstrmojo.string.encodeXMLAttribute,I=mstrmojo.mstr.EnumNodeDimty;var AJ=v.hash([I.NodeDimtyOutputLevel]);var O={};O[M.AQ]={target:1,fm:1,fn:1,c0:1,c1:1};O[M.AL]={target:1,fm:1,fn:1,c0:1};O[M.AE]={target:1,fm:1,es:1};O[M.AC]={target:1,fm:1,fm2:1,fm3:1,fn:1,c0:1,c1:1};O[M.MQ]={target:1,fn:1,c0:1,c1:1,dmy:1};O[M.MC]=O[M.MQ];O["*"]={target:1};var x={};x[M.MQ]={key:"metricFns",def:S.METRIC_FNS};x[M.MC]={key:"metricFns",def:S.METRIC_FNS};x[M.AQ]={key:"formFns",def:S.FORM_FNS};x[M.AL]={key:"formFns",def:S.FORM_FNS};x[M.AC]={key:"formFns",def:S.FORM_FNS};x[M.AE]={key:"elemFns",def:S.ELEM_FNS};var AE={};AE[M.AQ]=mstrmojo.desc(7925,"Select Attribute...");AE[M.AL]=mstrmojo.desc(7926,"Browse...");AE[M.MQ]=mstrmojo.desc(7927,"Select Metric...");AE[M.MC]=mstrmojo.desc(7927,"Select Metric...");AE[M.AC]=mstrmojo.desc(7925,"Select Attribute...");function AG(AO,AQ,AN){var AP=AO[AQ].style;if(mstrmojo.dom.isFF){AP.overflow="hidden";AP.width=AN?"auto":"0px";AP.visibility=AN?"inherit":"hidden";}else{AP.display=AN?"block":"none";}}function u(AR){var AQ=true,AN=AR.model,AO,AP=AN&&S.fnCstCount(AN.fn,AN.fnt);if(!AN){return ;}switch(AN.et){case M.AQ:case M.AL:case M.MQ:for(AO=0;AO<AP;AO++){AQ=AQ&&!AR["invalid"+AO];}break;}AR.okBtn.set("enabled",AQ&&!!AN.completed);}function AH(AT){var AO=AT.model,AW=AO&&AO.et,AU=O[AW]||O["*"],AN=AT.children,AP,AQ=AN.length;for(AP=0;AP<AQ;++AP){var AS=AN[AP];if(!AS.isStep){continue;}var AV=AS.alias,AR=AU[AV];AG(AT,AS.slot,AR);if(AR&&AS&&AS.update){AS.update();}}if(!AU.c1){AG(AT,"btwnNode",false);}if(!AU.dmy){AG(AT,"atNode",false);}u(AT);}function w(){var AO=this.parent,AN=((AO&&AO.cssText)||"").match(/height:\s*(\d*)px/);this.cssText=AN&&AN[0];}var c="dummy",B={did:"idBrowse",v:"idBrowse",n:mstrmojo.desc(6571,"Browse..."),t:c,css:"unselectable link"},J={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:c,css:"unselectable"},q={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:c,css:"unselectable"};function Z(AP){if(this.updating){return ;}var AQ=this.multiSelect,AS=this.selectedItem;if(AS&&AS[C]===c){this.updating=true;if(AQ){this.removeSelect([this.selectedIndex]);}else{var AO=AP&&AP.removed&&Number(AP.removed[0]);AO=(AO==null)?-1:AO;this.set("selectedIndex",AO);}this.updating=false;if(AS===B){this.parent.browse(this);}}else{var AN=this.parent.model;if(AQ){var AR=this.items;AN.edit(this.alias,{added:AP.added&&v.get(AR,AP.added),removed:AP.removed&&v.get(AR,AP.removed),itemIdField:this.itemIdField});}else{AN.edit(this.alias,AS);}}}function E(AP,AR,AO){var AQ=AP.items,AN=v.indexOf(AQ,AR);if((AN===0)&&(AQ.length===1)){AO=mstrmojo.Arr.makeObservable((AO&&AO.length)?AO.concat():[]);AP.set("items",AO);}else{if(AN>-1){AQ.remove(AN,1);}if(AO&&AO.length){AQ.add(AO,(AN>-1)?AN:null);}}}function L(AN){return U.copy(AN,{scriptClass:"mstrmojo.Dial",slot:AN.alias+"Node",isStep:true,cssClass:"mstrmojo-walkstep mstrmojo-"+AN.alias,itemIdField:"did",itemMarkupFunction:function(AP,AO,AQ){var AR=AA(AP.n);return'<div class="dial-item '+AP.css+'" title="'+AR+'">'+AR+"</div>";},allowUnlistedValues:true,insertUnlistedValuesAt:0,onchange:Z,postCreate:w});}function n(AP,AN,AQ){var AO=AP.cfg;if(AO){AO.data=AP;AO.parent=AQ;return A.ref(AO);}AO=new mstrmojo.Label({text:AP.n,cssClass:"dial-item"});AO.markupMethods.onselectedChange=function(){mstrmojo.css.toggleClass(this.domNode,["selected"],this.selected);};AO.data=AP;AO.parent=AQ;return AO;}function AL(AO,AN){var AP=AN+S.FN_SEP+AO;return(AO!=null)?{did:AP,n:AP}:null;}function N(){var AN=this.model;if(AN){if(!AN.attachEventListener){mstrmojo.hash.make(AN,mstrmojo.ConditionModel,{});}AN.attachEventListener("edit",this.id,"onmodeledit");}}function h(AN){return AN.targets?v.filter(AN.targets,function(AO){return AO[C]===S.TP.ATTR;}):[];}function Y(AO,AN){if(AN&&AN.detachEventListener){AN.detachEventListener("edit",AO.id,"onmodeledit");}}function p(AO,AN,AP,AS){AO.updating=true;AG(AO.parent,AO.slot,AN);if(AN){if(AP!=null){AO.clearSelect();AO.set("items",AP);}var AR=AO.itemIdField,AQ=AO.selectedItem;if((AQ&&AQ[AR])!=(AS&&AS[AR])){AO.set("selectedItem",AS);}else{AO.center();}}AO.updating=false;}function l(AN,AO,AQ,AP){AN.updating=true;if(AO!=null){}AN.clearSelect();if(AO){AN.set("items",AO);}if(AQ&&AQ.length){AN.setSelectedItems(AQ);}else{if(AP&&AP.length){AN.select(AP);}else{AN.center();}}AN.updating=false;}function b(AO,AN,AP,AR,AQ){AG(AO.parent,AO.slot,AN);if(AN){l(AO,AP,AR,AQ);}}function G(AP,AO){var AN=AP.model||{},AQ=AN.fn;return(AQ!=null)&&((AN.et===M.MQ)||(AN.et===M.MC)||(AN.et===M.AQ)||(AN.et===M.AL)||(AN.et===M.AC))&&(S.fnCstCount(AQ,AN.fnt)>AO);}var AK={};AK[AC.DATE]=1;AK[AC.TIME]=1;AK[AC.TIMESTAMP]=1;function j(AQ,AP,AS){var AO=[],AN=AQ.length,AR;for(AR=0;AR<AN;AR++){if(F(AP,AS,AQ[AR][AS])<0){AO.push(AQ[AR]);}}return AO;}function AI(AN,AP){var AO;if(AP){switch(W[AN.et]){case"a":AO=AP[M.AC];break;case"m":AO=AP[M.MC];break;default:AO=false;break;}}else{AO=true;}return AO&&S.fn_AC_MC(AN&&AN.fn);}function o(AO){var AR=AO&&k[AO.et],AQ=AO&&AO.fm&&AO.fm.dtp,AN=AQ&&S.DTP2PROMPT_STP[AQ],AP={};AP[AR]=true;if(AN){AP[AN]=true;}return AP;}function g(AT){var AN=this.targetsLastMod,Ae=AT.targetsLastMod,AQ=AT.model,Ad=this._lastTargetId,AO=AQ&&AQ[W[AQ.et]]&&AQ[W[AQ.et]][AT.target.itemIdField],AX=AQ&&AQ.fm,AZ=AX&&AX.dtp,Aa=AI(AQ,AT.ets),AU=false;if(!AN||!Ae||(AN!=Ae)||Ad!==AO){this.targetsLastMod=AT.targetsLastMod;AU=true;}else{if(this.lastFmDtp!==AZ){this.lastFmDtp=AZ;AU=true;}else{if(this.lastFnTp!==Aa){this.lastFnTp=Aa;AU=true;}}}if(AU){if(!Aa){this.clearSelect();this.set("items",this.items.slice(0,this.preLen));}else{var AV=o(AQ),AR=AT.targets?v.filter(AT.targets,function(Af){return AV[Af[C]]||AV[Af[P]];}):[],AY=this.items.slice(this.preLen),AW=this.itemIdField,Ac=j(AY,AR,AW)||[],AS=j(AR,AY,AW)||[],Ab,AP;for(Ab=0,AP=Ac.length||0;Ab<AP;Ab++){this.remove(Ac[Ab]);}if(AS.length>0){this.add(AS,-1);}}this._lastTargetId=AO;}}function K(Ag,AV){Ag.updating=true;var AR=Ag.parent,Ae=G(AR,AV);AG(Ag.parent,Ag.slot,Ae);if(Ae){var AY=AR.model||{},AQ=AY.cs,Ad=AQ&&AQ[AV],AU=Ad&&Ad.v,AS;g.call(Ag,AR);switch(AY.et){case M.MQ:case M.MC:AS=S.METRIC_DTP;break;case M.AQ:case M.AC:case M.AE:AS=AY.fm&&AY.fm.dtp;break;case M.AL:AS=AY.fm&&AY.fm.dtp;AU=[];for(var AZ=0,Ab=AQ&&AQ.length;AZ<Ab;AZ++){AU.push(AQ[AZ].v);}AU=AU.join(mstrConfig.listSep);break;}AS=AS||AC.CHAR;var AW=S.fn_List(AY.fn,AY.fnt),Aa=AK[AS],Ac=Aa&&!AW;var AO=Ag.ctxtBuilder,AN=AO&&AO.itemWidgets,Af=Aa?(Ac?Ag.calIndex:Ag.dtxtIndex):Ag.txtIndex,AX=AN&&AN[Ag.bwIndex],AP;for(var AZ=0,Ab=Ag.preLen-1;AZ<Ab;AZ++){AP=AN[AZ];if(AZ==Af){AP.set("dtp",AS);AP.set("isList",AW);AP.set("value",AU);AP.set("visible",true);try{AP.focus&&AP.focus();}catch(AT){}if(AP.clearValidation){AP.clearValidation();}}else{AP.set("visible",false);}if(AW){AP.set("tooltip",mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep));}else{AP.set("tooltip","");}}if(AX){AX.set("text",AE[AY.et]);AX.set("visible",AR.objectBrowsingEnabled&&AI(AY,AR.ets));}switch(AY.et){case M.AQ:case M.AL:case M.MQ:if(Ad&&Ad.p){Ag.set("selectedItem",Ad.p);}else{Ag.set("selectedIndex",Af);}break;case M.MC:case M.AC:Ag.set("selectedItem",AY[W[AY.et]+(2+AV)]);break;}}AG(AR,"btwnNode",Ae);Ag.refreshScroll();Ag.updating=false;}function AF(){var AQ=this.parent,AO=AQ.parent,AP=(this.isValid&&this.isValid())||(!this.isValid&&!mstrmojo.string.isEmpty(this.value)),AN=AO.model;AO["invalid"+AQ.cstIndex]=!AP;if(!this.updating&&AP){this.updating=true;if(AN){AN.edit(AQ.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}u(AO);}function X(){var AO=this.parent,AN=AO.parent;AN["invalid"+AO.cstIndex]=false;}function f(AN){return L(U.copy(AN,{scriptClass:"mstrmojo.WidgetDial",makeObservable:true,itemFunction:n,selectionPolicy:"reselect",items:[{did:0,cfg:{scriptClass:"mstrmojo.ValidationTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:AF,onInvalid:AF,onClearValidation:X,size:6,cssText:"text-align:right",visible:false}},{did:1,cfg:{scriptClass:"mstrmojo.Calendar",onvalueChange:AF,visible:false}},{did:2,cfg:{scriptClass:"mstrmojo.DateTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:AF,onInvalid:AF,onClearValidation:X,calendarToBody:true,calConfig:{onmousedown:function(AO){mstrmojo.dom.stopPropogation(AO.hWin,AO.e);}},visible:false}},{did:3,t:c,cfg:{scriptClass:"mstrmojo.Label",cssClass:"dial-item link",text:"Browse...",onclick:function(){this.parent.parent.browse(this.parent);},visible:false}}],txtIndex:0,calIndex:1,dtxtIndex:2,bwIndex:3,preLen:4,insertUnlistedValuesAt:-1,update:function(){K(this,this.cstIndex);}}));}function d(AN){return L(U.copy(AN,{insertUnlistedValuesAt:-1,postCreate:function(){w.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,readCache:true,writeCache:true,params:{taskId:"getAttributeForms",attributeId:null,displayedForms:"0",styleName:"MojoAttributeStyle"},onsuccess:function(){var AV=this.parent,AQ=AV&&AV.parent&&AV.parent.model,AS=this.response;if((AS&&AS.did)!==AV.lastAttrId){return ;}var AR=AS.fms||[],AU=AV.selectedItem;AR=v.filter(AR,function(AW){return(!AW.icf);});if(AU){var AP=v.find(AR,AV.itemIdField,AU[AV.itemIdField]);if(AP>-1){AR=AR.concat();AR.splice(AP,1);}}E(AV,q,AR);var AT=AV.items,AO=AT.length;if(AO===1){AV.singleSelect(0);}},onerr:function(){E(this.parent,q,[J]);}});},update:function(){var AY=this.fmPost,AO=this.parent,AQ=AO.model,AW=AQ&&AQ["a"+AY],AU=!!AW,AP,AT,AZ=AQ&&AQ.tfm,AS=AZ&&AZ.dtp,AX;if(AU){switch(AQ.et){case M.AQ:case M.AL:AT=AQ.fm;break;case M.AC:AT=AQ["fm"+AY];break;case M.AE:AT=AL(AQ.fn,1);break;}if(this.lastAttrId!==AW.did){this.lastAttrId=AW.did;AP=[];if(AQ.et!==M.AC){if(!AW.ilk&&(!AO.ets||AO.ets[M.AE])){var AR=x[M.AE],AV=AR&&AR.key;AP=AP.concat((AV&&AO[AV])||AR.def||[]);}}if(AT&&(AQ.et!==M.AE)){AP.push(AT);}AX=this.ajx;AX.params.attributeId=AW.did;AP.push(q);H.makeObservable(AP);}}p(this,AU,AP,AT);if(AU&&AX){if(AX._delayId){window.clearTimeout(AX._delayId);delete AX._delayId;}AX._delayId=window.setTimeout(function(){delete AX._delayId;AX.send();},500);}}}));}var Q=[S.STP.PROMPT,S.STP.PROMPT_OBJECTS,S.STP.PROMPT_ELEMENTS,S.STP.PROMPT_EXPRESSION,S.STP.PROMPT_EXPRESSION_DRAFT];function AM(AN){if(AN&&!U.isEmpty(AN)){var AO=v.hash(Q);U.forEach(AN,function(AQ,AP){if(AQ){AO[k[AP]]=true;}});return AO;}return null;}function a(AQ,AP,AS){AQ.openPopup("eb",{zIndex:AQ.parent.zIndex+10,left:Math.round(AS.x)+"px",top:Math.round(AS.y)+"px"});var AO=AQ.eb.browser,AN=AQ.model,AR=AN&&AN.a&&AN.a.did;if(!AR){return ;}AO.set("attributeID",AR);AO.set("selectedItems",AN.es?U.clone(AN.es):[]);AO.initBrowser();}function AD(AU,AN,AO){AU.openPopup("ob",{zIndex:AU.parent.zIndex+10,left:Math.round(AO.x)+"px",top:Math.round(AO.y)+"px"});var AP=AU.ob.browser;AP.target=AN;var AQ;switch(AN.alias){case"dmy":AQ=[S.TP.ATTR,S.TP.DIM];break;case"c0":case"c1":var AS=AU.model,AR=AS&&AS.et,AV=AS&&AS.fm,AT=AV&&AV.dtp||(AS.m?S.DTP.DECIMAL:S.DTP.UNKNOWN);AQ=(AR===M.MQ||AR===M.MC)?[S.TP.METRIC,S.DTP2PROMPT_STP[AT]]:[S.TP.ATTR,S.DTP2PROMPT_STP[AT]];break;default:if(AU.browsableTypes){AQ=AU.browsableTypes;}else{AQ=AM(AU.ets);AQ=AQ?U.keyarray(AQ,true):[S.TP.ATTR,S.TP.METRIC,S.STP.REPORT_GRID,S.STP.REPORT_GRAPH,S.STP.REPORT_ENGINE,S.STP.REPORT_TEXT,S.STP.REPORT_DATAMART,S.STP.REPORT_BASE,S.STP.REPORT_GRIDGRAPH,S.STP.REPORT_NONINTERACTIVE,S.STP.FILTER].concat(Q);}}AQ[AQ.length]=S.TP.FOLDER;AP.browse({folderLinksContextId:AS&&(AS.et===M.MQ||AS.et===M.MC)?27:23,onSelectCB:[AU,"onOBSelect"],browsableTypes:AQ.join(",")});}mstrmojo.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.ConditionWalk",markupString:'<table id="{@id}" class="mstrmojo-walk mstrmojo-ConditionWalk {@cssClass}" style="{@cssText}" cellspacing="0" cellpadding="0" mstrAttach:click><tr><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-notNode"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-targetNode"><div class="mstrmojo-walkstep-wrapper"><div class="mstrmojo-walkstep-browse">'+mstrmojo.desc(7926,"Browse...")+'</div></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fmNode"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-esNode"><div class="mstrmojo-walkstep-wrapper"><div class="mstrmojo-walkstep-browse">'+mstrmojo.desc(7928,"Browse elements...")+'</div></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fnNode"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-c0Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fm2Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-btwnNode"><div class="mstrmojo-walkstep-wrapper">{@betweenText}</div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-c1Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-fm3Node"><div class="mstrmojo-walkstep-wrapper"></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-atNode"><div class="mstrmojo-walkstep-wrapper">{@atText}</div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-dmyNode"><div class="mstrmojo-walkstep-wrapper"><div class="mstrmojo-walkstep-browse">'+mstrmojo.desc(7925,"Select Attribute...")+'</div></div></td><td class="mstrmojo-walkcell mstrmojo-ConditionWalk-okNode"><div class="mstrmojo-walkstep-wrapper"><div></div></td></tr></table>',markupSlots:{notNode:function(){return this.domNode.rows[0].cells[0].firstChild;},targetNode:function(){return this.domNode.rows[0].cells[1].firstChild;},fmNode:function(){return this.domNode.rows[0].cells[2].firstChild;},esNode:function(){return this.domNode.rows[0].cells[3].firstChild;},fnNode:function(){return this.domNode.rows[0].cells[4].firstChild;},c0Node:function(){return this.domNode.rows[0].cells[5].firstChild;},fm2Node:function(){return this.domNode.rows[0].cells[6].firstChild;},btwnNode:function(){return this.domNode.rows[0].cells[7].firstChild;},c1Node:function(){return this.domNode.rows[0].cells[8].firstChild;},fm3Node:function(){return this.domNode.rows[0].cells[9].firstChild;},atNode:function(){return this.domNode.rows[0].cells[10].firstChild;},dmyNode:function(){return this.domNode.rows[0].cells[11].firstChild;},okNode:function(){return this.domNode.rows[0].cells[12].firstChild;}},markupMethods:{onvisibleChange:function(){this.domNode.style.display=this.visible?D.DISPLAY_TABLE:"none";},onobjectBrowsingEnabledChange:function(){this.targetNode.firstChild.style.display=this.objectBrowsingEnabled?"":"none";}},okBtn:undefined,updateBrowseElementsParams:function(AO,AN){AO.attributeID=AN.did;},children:[L({alias:"target",insertUnlistedValuesAt:0,makeObservable:true,hideIfEmpty:true,update:function(){var AR=this.parent,AO=AR.model;if(this.lastModel!==AO){this.lastModel=AO;var AN=AR.targets,AT=AR.ets;if(AT&&AN&&AN.length){var AQ=AM(AR.ets);AN=v.filter(AN,function(AU){return AQ[AU[C]];});}else{AN=AN?AN.concat():[];}var AS=AO&&AO.et,AP=AO&&AO[W[AS]];p(this,true,AN,AP);}}}),d({alias:"fm",fmPost:"",filter:false}),L({alias:"es",itemIdField:"v",insertUnlistedValuesAt:0,makeObservable:true,itemMarkupFunction:function(AO,AN,AP){var AQ=AA(AO.n);return'<div class="dial-checkitem '+AO.css+'" title="'+AQ+'">'+AQ+"</div>";},multiSelect:true,selectionPolicy:"toggle",postCreate:function V(){w.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,params:{taskId:"browseElements",attributeID:null,styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30},onsuccess:function(){var AP=this.parent,AN=this.response;if((AN&&AN.did)!==AP.lastAttrId){return ;}var AO=(AN&&AN.es)?AN.es.concat():[];l(AP,AO,AP.parent.model&&AP.parent.model.es,null);},onerr:function(){E(this.parent,q,[J]);}});},update:function R(){var AT=this.parent,AP=AT.model,AS=AP&&AP.a,AU=!!AS&&!AS.ilk,AV,AN,AR,AW;if(AU){if(this.lastAttrId!==AS.did){this.lastAttrId=AS.did;AV=AP.es;var AQ=AV&&AV.length;AV=AQ?AV.concat():[];AV.push(q);if(AQ){AR=[];for(var AO=1;AO<=AQ;AO++){AR[AO]=AO;}}AW=this.ajx;AT.updateBrowseElementsParams(AW.params,AS);}else{AN=AP.es;}}b(this,AU,AV,AN,AR);if(AU&&AW){AW.send();}}}),L({alias:"fn",allowUnlistedValues:false,update:function(){var AN=this.parent,AP=AN.model||{},AT=AP.et,AS,AU=false,AV,AO;switch(AT){case M.AE:AU=!!AP.a;break;case M.AQ:case M.AC:case M.AL:AU=!!(AP.fm&&AP.fm.did);AS=AU?AP.fm.dtp:null;break;case M.MQ:case M.MC:AU=!!AP.m;AS=AU?S.METRIC_DTP:null;break;}if(AU){var AW=m[AS];if((this.lastEt!==AT)||(this.lastFnDtp!==AW)){this.lastEt=AT;this.lastFnDtp=AW;var AR=AT?x[AT]:null,AQ=AR&&AR.key;AV=(AQ&&AN[AQ])||AR.def||[];if(typeof (AV)==="object"){AV=AV[AW]||AV["*"];}}AO=AL(AP.fn,AP.fnt||1);}p(this,AU,AV,AO);}}),f({alias:"c0",cstIndex:0}),d({alias:"fm2",fmPost:"2"}),f({alias:"c1",cstIndex:1}),d({alias:"fm3",fmPost:"3"}),L({alias:"dmy",itemIdField:"did",hideIfEmpty:true,itemMarkupFunction:function(AO,AN,AP){var AQ=AA(AO.n);return'<div class="dial-checkitem '+AO.css+'" title="'+AQ+'">'+AQ+"</div>";},multiSelect:true,selectionPolicy:"toggle",insertUnlistedValuesAt:0,makeObservable:true,postCreate:function(){w.apply(this,[]);this.set("items",h(this.parent));},update:function t(){var AP=this.parent,AT=AP.model,AV=AT.et,AY=AT&&AT.m,AW=!!AY&&(AT.fn!==null)&&((AV===M.MQ)||(AV===M.MC))&&AT.dimtyTypes[I.NodeDimtyOutputLevel],AU,AQ;if(AW){var AR=this.targetsLastMod,AZ=AP.targetsLastMod;if(!AR||!AZ||(AR!=AZ)){this.targetsLastMod=AP.targetsLastMod;AU=h(AP);}AQ=[];var AO=AT.dmy&&AT.dmy.uts;for(var AX=0,AN=(AO&&AO.length)||0;AX<AN;AX++){var AS=AO[AX];AQ.push(AS.utgt?AS.utgt:AS);}}b(this,AW,AU,AQ);AG(AP,"atNode",AW);}}),{alias:"okBtn",slot:"okNode",scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),cssText:"width:66px;min-width:58px;",onclick:function(){var AN=this.parent;if(AN.onOK){AN.onOK();}}},{alias:"cancelBtn",slot:"okNode",scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",cssText:"width:66px;min-width:58px;",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var AN=this.parent.parent;if(AN&&AN.close){AN.close();}}}],eb:{scriptClass:"mstrmojo.Editor",cssClass:T.isIE7?"mstrmojo-ElementsEditorIE7":"mstrmojo-ElementsEditor",title:mstrmojo.desc(6149,"Select Elements"),help:"element_browser_dialog_box.htm",children:[{scriptClass:"mstrmojo.ElementsBrowser",alias:"browser",onUpdateBrowseElementsParams:function(AO){var AN=this.parent.opener;AN.updateBrowseElementsParams(AO,AN.model.a);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HTMLButton",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-Editor-button",cssText:"width:72px;margin-right:2px;",onclick:function(){var AN=this.parent.parent,AO=AN&&AN.opener;if(AO){AO.onEBSelect();AO.closePopup();}}}]}]},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",cssText:"width:302px;",fishEyeVisible:false,closeable:false,closeOnSelect:false,browsableTypes:"3,4,8,10,12,256",includeObjectDesc:true,quickSearch:true}]},betweenText:mstrmojo.desc(308,"and"),atText:mstrmojo.desc(5923,"at"),model:null,targets:null,ets:null,defaultEt:null,defaultAttrEt:null,metricFns:null,formFns:null,elemFns:null,metricLevels:null,defaultMetricLevel:null,browsableTypes:null,postBuildRendering:function AB(){N.call(this);AH(this);return this._super();},_set_model:function e(AQ,AN){var AO=this.model,AP=(AN!==AO);if(AP){Y(this,AO);AN.dimtyTypes=this.dimtyTypes||AJ;this.model=AN;N.call(this);if(this.hasRendered){AH(this);}}return AP;},onmodeledit:function(AN){switch(AN&&AN.prop){case"es":case"dmy":u(this);return ;}AH(this);},browse:function r(AN){var AP=this.parent.editorNode,AO=function(AR,AT){var AQ=mstrmojo.dom.position(AR,true),AS=mstrmojo.dom.position(AT,true);return{x:AQ.x+AQ.w,y:AS.y};};switch(AN&&AN.alias){case"target":case"dmy":AD(this,AN,AO(AN.alias=="target"?this.targetNode:this.dmyNode,AP));break;case"c0":case"c1":AD(this,AN,AO(AN.alias=="c0"?this.c0Node:this.c1Node,AP));break;case"es":a(this,AN,AO(this.esNode,AP));break;}},onOBSelect:function(AQ){var AO=this.ob.browser,AS=AO.target;this.closePopup();var AR=AS.itemIdField,AP=this.targets||[],AN=v.find(this.targets,AR,AQ[AR]);if(AN===-1){AP.push(AQ);this.targets=AP;this.targetsLastMod=new Date();}AS.setSelectedItems([AQ],AS.multiSelect);AS.refreshScroll();},onEBSelect:function(){var AN=this.eb.browser;var AO=this.es;AO.set("selectedIndices",{});AO.setSelectedItems(AN.selectedItems,false);},onclick:function z(AN){var AO=mstrmojo.dom.eventTarget(AN.hWin,AN.e);if(AO==this.targetNode.firstChild){this.browse(this.target);}else{if(AO==this.esNode.firstChild){this.browse(this.es);}else{if(AO==this.dmyNode.firstChild){this.browse(this.dmy);}}}},objectBrowsingEnabled:true});})();(function(){mstrmojo.requiresCls("mstrmojo.Box","mstrmojo.array","mstrmojo.string","mstrmojo.expr","mstrmojo.date","mstrmojo.ValidationTextBox","mstrmojo.DateTextBox");var T=mstrmojo.array,Q=mstrmojo.css,I=mstrmojo.string,P=mstrmojo.date,O=mstrmojo.expr,S=O.DTP,B=O.FN,E=mstrmojo.validation;var A={};A[B.BETWEEN]=B.NOT_BETWEEN;A[B.NOT_BETWEEN]=B.BETWEEN;A[B.GREATER_EQUAL]=B.LESS;A[B.LESS]=B.GREATER_EQUAL;A[B.LESS_EQUAL]=B.GREATER;A[B.GREATER]=B.LESS_EQUAL;A[B.SEARCH]=B.SEARCH;function H(U){if(this.value!==this._lastInput){R.call(this,U,true);}}function M(U){mstrmojo.DateTextBox.prototype.onclick.call(this,U);Q.addClass(this.calendar&&this.calendar.domNode,mstrApp.getThemeClassName());}function R(U,Z){var Y=this.parent.parent;if(!Y._inSyncPhase){var W=this.calendar&&this.calendar.cal,X=this,V=Y.submitTimer;if(V){window.clearTimeout(V);}if(!mstrApp.isWaiting()){if(Z||W&&W.value===this.value){this._lastInput=this.value;Y.submit(X);}else{Y.submitTimer=window.setTimeout(function(){X._lastInput=X.value;Y.submit(X);},3000);this.set("dynDateValue",null);if(W){W.set("value",this.value);}}}else{if(this._lastInput){this.set("value",this._lastInput);}}}}function K(X){if(!X.isDyn){return null;}var W=["isDyn"];W.push(X.dyt||0);W.push(X.ddo||0);W.push(X.dmo||0);W.push(X.dm||0);W.push(X.dd||0);W.push(X.dw||0);W.push(X.dow||0);W.push(X.v||"");if(X.dtp===O.DTP.TIMESTAMP){var V=P.parseDateAndOrTime(X.v||""),U=V&&V.time;if(U){X.dh=U.hour;X.dmi=U.min;X.ds=U.sec;}}W.push(X.dh||0);W.push(X.dmi||0);W.push(X.ds||0);return W.join("::");}function C(W,X,Z){return{parent:W,dt:X,f:Z,setDataType:function Y(c){this.dt=c;},setFunction:function b(c){this.f=c;},hasSecTextBox:function a(){var c=this.f;return c!==B.SEARCH;},adjustVisibleFields:function U(){var c=this.parent;if(!this.hasSecTextBox()){c.toBox.set("visible",false);c.fromBox.fromLabel.set("visible",false);}if(X===O.DTP.DATE||X===O.DTP.TIMESTAMP){c.fromBox.fromInput.set("visible",false);c.toBox.toInput.set("visible",false);}else{c.fromBox.fromPicker.set("visible",false);c.toBox.toPicker.set("visible",false);}},passValueToInputs:function V(d){var f=this.parent,h,g,e=this,c=function(j,k){if(e.f===B.SEARCH||j.v!=="*"){k.set("value",j.v);k._lastInput=j.v;if(X===O.DTP.DATE||X===O.DTP.TIMESTAMP){k.set("dynDateValue",K(j));}}};if(X===O.DTP.DATE||X===O.DTP.TIMESTAMP){h=f.fromBox.fromPicker;g=f.toBox.toPicker;}else{h=f.fromBox.fromInput;g=f.toBox.toInput;}if(Z===B.BETWEEN||Z===B.NOT_BETWEEN){if(d&&d[0]){c(d[0],h);}else{h.set("value",h.min||"");h._lastInput=h.min||"";}if(this.hasSecTextBox()&&d&&d[1]){c(d[1],g);}else{g.set("value",g.max||"");g._lastInput=g.max||"";}}else{if(Z===B.GREATER_EQUAL||Z===B.LESS){if(d&&d[0]){c(d[0],h);g.set("value",g.max||"");g._lastInput=g.max||"";}}else{if(Z===B.LESS_EQUAL||Z===B.GREATER){if(d&&d[0]){c(d[0],g);h.set("value",h.min||"");h._lastInput=h.min||"";}}}}}};}mstrmojo.vi.ui.rw.selectors.AttrQualInputBox=mstrmojo.declare(mstrmojo.Box,null,{scriptClass:"mstrmojo.vi.ui.rw.selectors.AttrQualInputBox",markupString:'<div id="{@id}" class="{@cssClass}" style="{@cssText}"></div>',markupSlots:{containerNode:function(){return this.domNode;}},cssClass:"Attr-Qual-InputBox",children:[{scriptClass:"mstrmojo.Box",alias:"fromBox",cssClass:"from-box",children:[{scriptClass:"mstrmojo.Label",alias:"fromLabel",cssDisplay:"inline-block",cssClass:"input-label",text:mstrmojo.desc(146,"From:")},{scriptClass:"mstrmojo.ValidationTextBox",alias:"fromInput",cssDisplay:"inline-block",required:false,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onEnter:H,onblur:H,_lastInput:null,bindings:{dtp:"this.parent.parent.dt"}},{scriptClass:"mstrmojo.DateTextBox",alias:"fromPicker",cssDisplay:"inline-block",required:false,calendarToBody:true,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onvalueChange:R,onEnter:H,onblur:H,_lastInput:null,bindings:{dtp:"this.parent.parent.dt",min:"this.parent.parent.min",max:"this.parent.parent.max",defaultDate:"this.parent.parent.min",showAdvanced:"this.parent.parent.showAdvanced",canSelectDisabledDate:"this.parent.parent.canSelectDisabledDate"},onclick:M}]},{scriptClass:"mstrmojo.Box",alias:"toBox",cssClass:"to-box",children:[{scriptClass:"mstrmojo.Label",alias:"toLabel",cssDisplay:"inline-block",cssClass:"input-label",text:mstrmojo.desc(147,"To:")},{scriptClass:"mstrmojo.ValidationTextBox",alias:"toInput",cssDisplay:"inline-block",required:false,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onEnter:H,onblur:H,_lastInput:null,bindings:{dtp:"this.parent.parent.dt"}},{scriptClass:"mstrmojo.DateTextBox",alias:"toPicker",cssDisplay:"inline-block",required:false,calendarToBody:true,constraints:{trigger:E.TRIGGER.ALL},autoFormat:false,onvalueChange:R,onEnter:H,onblur:H,_lastInput:null,bindings:{dtp:"this.parent.parent.dt",min:"this.parent.parent.min",max:"this.parent.parent.max",defaultDate:"this.parent.parent.max",showAdvanced:"this.parent.parent.showAdvanced",canSelectDisabledDate:"this.parent.parent.canSelectDisabledDate"},onclick:M}]}],widgetResized:function(){var X=this,U=parseInt(this.width,10),V=["fromBox","toBox"],Y,W;if(!this.widgetHelper.hasSecTextBox()){V=["fromBox"];}if(U>368){W=true;}else{W=false;}if(X.parent.isInFilterPanel()||!this.widgetHelper.hasSecTextBox()){W=false;return ;}window.setTimeout(function(){Y=X.hasRendered;T.forEach(V,function(Z){if(Y){Q.toggleClass(X[Z].domNode,"onerow",W);X[Z].domNode.style.display=W?"inline-block":"block";}else{if(W){Q.addWidgetCssClass(X[Z],"onerow");X[Z].cssDisplay="inline-block";}else{Q.removeWidgetCssClass(X[Z],"onerow");X[Z].cssDisplay="block";}}});},0);},init:function N(U){if(this._super){this._super(U);}this.widgetHelper=C(this,this.dt,this.f);this.updateWidgetByData();},update:function D(U){if(U){this.cs=U.cs;if(U.f){this.f=U.f;}if(U.ft){this.ft=U.ft;}if(U.fid){this.fid=U.fid;}if(U.min){this.set("min",U.min);}if(U.max){this.set("max",U.max);}}this.updateWidgetByData();},updateWidgetByData:function L(){var U=this.widgetHelper,V=this.cs;this._inSyncPhase=true;U.adjustVisibleFields();U.passValueToInputs(V);this._inSyncPhase=false;},onincludeChange:function F(){this.f=A[this.f];if(!this._inSyncPhase){this.onchange();}},submit:function G(b){var Z=this.cs=[],X=this.parent.include,W=this.widgetHelper,V=(b.validationStatus.code===E.STATUSCODE.VALID),e=this.parent.model,Y;if(W.hasSecTextBox()){if(b.alias==="toInput"){Y=this.fromBox.fromInput;}else{if(b.alias==="toPicker"){Y=this.fromBox.fromPicker;}else{if(b.alias==="fromInput"){Y=this.toBox.toInput;}else{if(b.alias==="fromPicker"){Y=this.toBox.toPicker;}}}}Y.validate();if(Y.validationStatus.code!==E.STATUSCODE.VALID){V=false;}}if(V){if(W.hasSecTextBox()){var d=(b.alias.indexOf("from")===0)?b:Y,c=(b.alias.indexOf("to")===0)?b:Y,U=d.dynDateValue||d.value,a=c.dynDateValue||c.value;this.unset=I.isEmpty(U)&&I.isEmpty(a);if(!I.isEmpty(U)&&!I.isEmpty(a)){Z[0]={v:U};Z[1]={v:a};this.f=X?B.BETWEEN:B.NOT_BETWEEN;}else{if(!I.isEmpty(U)){if(e.isFromSolrCube&&e.isFromSolrCube(this.srcid)){Z[0]={v:U};Z[1]={v:"*"};this.f=X?B.BETWEEN:B.NOT_BETWEEN;}else{Z[0]={v:U};this.f=X?B.GREATER_EQUAL:B.LESS;}}else{if(!I.isEmpty(a)){if(e.isFromSolrCube&&e.isFromSolrCube(this.srcid)){Z[0]={v:"*"};Z[1]={v:a};this.f=X?B.BETWEEN:B.NOT_BETWEEN;}else{Z[0]={v:a};this.f=X?B.LESS_EQUAL:B.GREATER;}}}}}else{Z[0]={v:b.value};this.unset=I.isEmpty(Z[0].v);this.f=B.SEARCH;}this.onchange();if(this.makeSelection){this.makeSelection({selItem:this.domNode});}}},getSummaryText:function J(){var W=this.cs||[],X=this.f;if(this.unset||!W.length||I.isEmpty(W[0].v)&&(W.length<=1||I.isEmpty(W[1].v))){return"";}var V="",U=this.parent.include;switch(X){case B.BETWEEN:case B.NOT_BETWEEN:V=mstrmojo.desc(4804).replace("##",W[0].v).replace("###",W[1].v);break;}if(!U){V=mstrmojo.desc(1099,"Not")+" "+V;}return V;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.Model","mstrmojo.Container","mstrmojo.Button","mstrmojo.Label","mstrmojo.DateTextBox","mstrmojo.TextArea","mstrmojo.ui.CheckList","mstrmojo.ui.Pulldown","mstrmojo.ui.MultiSelectPulldown","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo._HasPopup");mstrmojo.requiresDescs(2,3,520,686,687,688,698,699,1050,5688,6013,8956,9163);var H=mstrmojo.desc,I=mstrmojo.array,C=mstrmojo.hash,K=mstrmojo.validation,F=mstrmojo.Button.newWebButton;var J;var E=function(P,N,O){if(!this.hasRendered){return ;}mstrmojo.all[J].model.settings[P]=N;if(O!==false){mstrmojo.all[J].onmodelChange();}};var G=function(O,N){N=N||{};return C.copy(N,{scriptClass:"mstrmojo.ui.CheckList",orientation:N.isVertical===false?"h":"v",multiSelect:!N.isRadio,items:O});};var L=function(P,O,N){return new mstrmojo.Box({alias:N,cssClass:"mstrmojo-SearchSettings-panel "+N,cssDisplay:"inline-block",children:[{scriptClass:"mstrmojo.Label",text:P}].concat(O)});};var B=function(N){var O=this;return{scriptClass:"mstrmojo.DateTextBox",alias:N,cssDisplay:"block",cssClass:N,width:120,required:false,calendarToBody:true,calendarZIndex:112,constraints:{trigger:K.TRIGGER.ALL},autoFormat:false,bindings:{value:function(){return O.model.settings[N];}},onfocus:function(){this.parent.parent.dateSubType.set("selectedIndex",1);},getSetting:function(){return{p:this.alias,v:this.value};}};};mstrmojo.mstr.search.SearchSettings=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasPopup],{scriptClass:"mstrmojo.mstr.search.SearchSettings",visible:false,markupString:'<div class="mstrmojo-SearchSettings {@cssClass}" style="{@cssText}"><div class="mstrmojo-SearchSettings-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},onmodelChange:mstrmojo.emptyFn,init:function M(N){if(this._super){this._super(N);}J=this.id;},postBuildRendering:function A(){var O=this;this.prepareObjectTypes();var N=[];this.addChildren([L(H(8956,"Object type"),{scriptClass:"mstrmojo.ui.MultiSelectPulldown",alias:"objectType",isHostedWithin:true,orientation:"v",multiSelect:true,items:I.map(this.allowedObjectTypesData,function(R,Q){if(I.indexOf(O.model.settings.objectType,R.t)>-1){N[Q]=true;}return{n:R.d,t:R.t};}),selectedIndices:N,allIdx:-1,onselectionChanged:function(){var Q=this.items;E.call(this,this.alias,I.map(C.keyarray(this.selectedIndices),function(R){return Q[R].t;}));},onchange:function(){var Q=this.items;E.call(this,this.alias,I.map(C.keyarray(this.selectedIndices),function(R){return Q[R].t;}));},getPopupWidget:function P(){var Q=this;this.popupWidget.onClose=function(){this.list.selectedIndices=mstrmojo.hash.copy(Q.selectedIndices);this.list.refresh();};return this.popupWidget;}},"objectTypePanel"),L(H(60,"Owner"),mstrmojo.ui.Pulldown.newPulldown([{n:H(698,"Created by any user"),v:1},{n:H(699,"Created only by me"),v:2}],function(Q,R){if(Q.v!==R.v){E.call(this,this.alias,Q.v);}},0,{alias:"ownerType"}),"ownerPanel"),L(H(2052,"Date"),[mstrmojo.ui.Pulldown.newPulldown([{n:mstrmojo.desc(2058,"All"),v:0},{n:mstrmojo.desc(694,"Created"),v:1},{n:mstrmojo.desc(61,"Modified"),v:2}],function(Q,R){if(Q.v!==R.v){E.call(this,"dateType",Q.v===0?1:2,false);E.call(this,this.alias,Q.v,Q.v===0);}},0,{alias:"created",cssClass:"mstrmojo-SearchSettings-date-pulldown"}),mstrmojo.Button.newIconButton(H(5688,"Show dates"),"mstrmjo-SearchSettings-calendar",function(){this.parent.datePopup.open();},{visible:function(){var Q=this.parent.created.selectedIndex!==0;if(Q){this.parent.datePopup.open();}return Q;}},{alias:"calIcon"}),{scriptClass:"mstrmojo.ui.PopupWidget",cssClass:"mstrmojo-SearchSettings-dates-popupWidget",alias:"datePopup",visible:false,children:[{scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",alias:"dateContainer",cssClass:"mstrmojo-SearchSettings-dates",width:"238px",col1Width:"80px",col2Width:"130px",children:[G([{n:mstrmojo.desc(4049,"Last"),v:1},{n:mstrmojo.desc(294,"Between"),v:2}],{alias:"dateSubType",isRadio:true,bindings:{selectedIndex:function(){return I.find(this.items,"v",O.model.settings.dateSubType);}},postselectionChange:function(){if(this.hasRendered){if(this.selectedIndex===0){this.parent.intervalBox.intervalValue.inputNode.focus();}else{this.parent.intervalBox.startDate.inputNode.focus();}}},getSetting:function(){return{p:this.alias,v:this.items[this.selectedIndex].v};},slot:"col1Node"}),{scriptClass:"mstrmojo.Box",cssDisplay:"inline-block",alias:"intervalBox",children:[{scriptClass:"mstrmojo.TextBox",alias:"intervalValue",cssClass:"intervalValue",cssDisplay:"inline-block",size:1,maxLength:4,bindings:{value:function(){return mstrmojo.all.searchSettings.model.settings.intervalValue;}},onvalueChange:function(){},onfocus:function(){this.parent.parent.dateSubType.set("selectedIndex",0);},getSetting:function(){return{p:this.alias,v:this.value||""};}},mstrmojo.ui.Pulldown.newPulldown([{n:mstrmojo.desc(708,"Hours"),v:1},{n:mstrmojo.desc(707,"Days"),v:2},{n:mstrmojo.desc(714,"Weeks"),v:3},{n:mstrmojo.desc(710,"Months"),v:4},{n:mstrmojo.desc(709,"Years"),v:5}],function(Q,R){if(Q.v!==R.v){}},0,{alias:"intervalUnit",cssClass:"intervalUnit",cssDisplay:"inline-block",getSetting:function(){return{p:this.alias,v:this.items[this.selectedIndex].v};}}),B.call(this,"startDate"),B.call(this,"endDate")],slot:"col2Node"}]},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Buttons",children:[F(mstrmojo.desc(1442,"Ok"),function(){var R=this.parent.parent.dateContainer,Q=R.intervalBox;var S=[R.dateSubType,Q.intervalValue,Q.intervalUnit,Q.startDate,Q.endDate];I.forEach(S,function(T){var U=T.getSetting();mstrmojo.all[J].model.settings[U.p]=U.v;mstrmojo.all[J].onmodelChange();});this.parent.parent.close();},true,{cssDisplay:"inline-block"}),F(mstrmojo.desc(2140,"Cancel"),function(){this.parent.parent.close();},false,{cssDisplay:"inline-block"})]}]}],"datepanel"),L(H(6013,"Description (contains)"),{scriptClass:"mstrmojo.TextArea",alias:"description",rows:1,bindings:{value:function(){return mstrmojo.all.searchSettings.model.settings.description;}},onvalueChange:function(){E.call(this,this.alias,this.value);}},"descriptionPanel")]);if(this._super){this._super();}},prepareObjectTypes:function D(){var P=[],Q=[];this.allowedObjectTypes=this.allowedObjectTypesData.concat([]);I.forEach(this.allowedObjectTypes,function(S,R){P[R]=parseInt(S.t,10);Q[P[R]]=S.d;});if(this.allowedObjectTypes.length===0){this.model.settings.objectType=[];return ;}var N=this.allowedObjectTypes,O=this.model.settings.objectType;I.forEach([].concat(O),function(R){I.removeItems(O,"t",I.find(N,"t",parseInt(R,10))===-1?[R]:null);});if(O.length===0&&!(this.isMiniSearchBox||this.isDesktopSearchBox)){O=I.map(this.allowedObjectTypes,function(R){return R.t;});}this.model.settings.objectType=O;}});mstrmojo.mstr.search.SearchSettings.getLocationPulldown=function(N){var P=[{n:mstrApp.projectAlias||mstrConfig.projectName,v:39},{n:H(2,"Shared Reports"),v:7},{n:H(3,"My Reports"),v:20}],Q=0;if(N.rootFolderType===0){P.push({n:N.rootFolderName||"",v:0});Q=3;}else{Q=I.find(P,"v",N.rootFolderType);}return mstrmojo.ui.Pulldown.newPulldown(P,function O(R,S){if(R.v!==S.v){E.call(this,"rootFolderType",R.v);}},Q,mstrmojo.hash.copy(N,{cssDisplay:"inline-block"}));};mstrmojo.mstr.search.SearchSettings.getSearchTypePulldown=function(N){return mstrmojo.ui.Pulldown.newPulldown([{n:H(686,"Contains"),v:N.qse?16:1},{n:H(520,"Exactly"),v:2},{n:H(687,"Begins With"),v:4},{n:H(688,"Ends with"),v:8}],function O(P,Q){if(P.v!==Q.v){E.call(this,"nameWildcards",P.v);}},0,mstrmojo.hash.copy(N,{cssDisplay:"inline-block",cssClass:"searchType"}));};}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.css","mstrmojo.registry","mstrmojo.AjaxCall","mstrmojo.hash","mstrmojo.array","mstrmojo.Arr","mstrmojo.expr","mstrmojo.dom","mstrmojo.mstr.EnumDataType","mstrmojo.Label","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.WidgetDial","mstrmojo.Calendar","mstrmojo.DateTextBox","mstrmojo.mstr.EnumNodeDimty","mstrmojo.ValidationTextBox","mstrmojo.ui.CheckList","mstrmojo.ui._HasScroller","mstrmojo.ui.ColumnContainer","mstrmojo.elementHelper");var AT=mstrmojo.css,AM=mstrmojo.registry,M=mstrmojo.hash,c=mstrmojo.mstr.EnumDataType,K=mstrmojo.array,r=K.map,L=mstrmojo.Arr,AP=mstrmojo.expr,b=AP.ET,n=AP.ET2TP,AF=AP.ET2TGT,O=AP.FN,x=AP.FN_MRP,AN=AP.DTP,k=AP.DTP2FN_DTP,AI=mstrmojo.meta.TP,P=mstrmojo.meta.STP,AU=AP.TP,W=AP.STP,U=mstrmojo.elementHelper;var Aa={};Aa[b.AQ]={target:1,fm:1,fn:1,c0:1,c1:1};Aa[b.AL]={target:1,fm:1,fn:1,c0:1};Aa[b.AE]={target:1,fm:1,es:1};Aa[b.AC]={target:1,fm:1,fm2:1,fm3:1,fn:1,c0:1,c1:1};Aa[b.MQ]={target:1,fn:1,c0:1,c1:1,dmy:1};Aa[b.MC]=Aa[b.MQ];Aa["*"]={target:1};var B={};B[b.MQ]={key:"metricFns",def:AP.METRIC_FNS};B[b.MC]={key:"metricFns",def:AP.METRIC_FNS};B[b.AQ]={key:"formFns",def:AP.FORM_FNS};B[b.AL]={key:"formFns",def:AP.FORM_FNS};B[b.AC]={key:"formFns",def:AP.FORM_FNS};B[b.AE]={key:"elemFns",def:AP.ELEM_FNS};var AA=mstrmojo.desc(14084,"Select a filter option or a qualification."),z=mstrmojo.desc(14085,"Select one or more elements."),w=mstrmojo.desc(14086,"Select an operator."),v=mstrmojo.desc(14087,"Enter a value or select an attribute from the list."),u=mstrmojo.desc(14088,"Select an attribute form. When done, click ## button.").replace("##",'""'),t=mstrmojo.desc(14089,"Select a condition."),q=mstrmojo.desc(14090,"Enter a value or select a metric from the list.");var AL=0,AY=1;var H=mstrmojo.ui.ColumnContainer.prototype.updateColumnContainer;function F(Af){var Ae=true,Ab=Af.model,Ac,Ad=Ab&&AP.fnCstCount(Ab.fn,Ab.fnt);if(!Ab){return ;}switch(Ab.et){case b.AQ:case b.AL:case b.MQ:for(Ac=0;Ac<Ad;Ac++){Ae=Ae&&!Af["invalid"+Ac];}break;}Af.okBtn.set("visible",Ae&&!!Ab.completed);}function J(){var Ac=this.parent,Ab=((Ac&&Ac.cssText)||"").match(/height:\s*(\d*)px/);this.cssText=Ab&&Ab[0];}var Y="dummy",p={did:"idErr",v:"idErr",n:mstrmojo.desc(7929,"Error loading data."),t:Y,css:"unselectable"},A={did:"idWait",v:"idWait",n:mstrmojo.desc(2901,"Loading..."),t:Y,css:"unselectable"},AW={did:"idSelect",v:"idSelect",n:mstrmojo.desc(547,"Select"),t:Y,css:"unselectable"},AJ={did:"idWait",v:"idQualification",n:mstrmojo.desc(5225,"Qualification"),t:Y,css:"unselectable"},a={did:"idAttribute",v:"idAttribute",n:mstrmojo.desc(518,"Attribute"),t:Y,css:"unselectable"},AE={did:"idMetric",v:"idMetric",n:mstrmojo.desc(517,"Metric"),t:Y,css:"unselectable"};function l(Ad){if(this.updating){return ;}var Ae=this.multiSelect,Ah=this.selectedItem,Ag=Ad&&Ad.added,Ai=Ad&&Ad.removed;if(!Ae&&Ag&&Ai&&Ag[0]===Ai[0]){return ;}if(Ah&&Ah[AI]===Y){this.updating=true;if(Ae){this.removeSelect([this.selectedIndex]);}else{var Ac=Ai&&Number(Ai[0]);Ac=(Ac==null)?-1:Ac;this.set("selectedIndex",Ac);}this.updating=false;}else{var Ab=this.parent.parent.parent.model;if(Ae){var Af=this.items;Ab.edit(this.alias,{added:Ag&&K.get(Af,Ag),removed:Ai&&K.get(Af,Ai),itemIdField:this.itemIdField});}else{Ab.edit(this.alias,Ah);}}}mstrmojo.rw.ConditionList=mstrmojo.declare(mstrmojo.ListBase,[mstrmojo._IsList],{scriptClass:"mstrmojo.rw.ConditionList",allowUnlistedValues:true,itemIdField:"did",getItemProps:function AR(Af,Ab){var Ae=!!this.selectedIndices[Ab],Ag=Af.n,Ad=false;if(Af.t===12){var Ac=K.filter(Af.fs,function(Ah){return Ah.fgr>0;});if(Ac.length>0){Ad=true;}}return M.copy({cls:(Ae?mstrmojo._IsList.SELECTED_CLS:"")+" "+(Af.css||"")+" "+(Af.t?("t"+Af.t+((Af.da||Af.um)?"d":"")+(Ad?"g":"")+(Af.st?(" st"+Af.st):"")):""),n:Ag||"&nbsp;"},this._super(Af,Ab));},onselectionChange:function o(Ab){this._super(Ab);l.call(this,Ab);}});function AD(Ad,Af,Ac){var Ae=Ad.items,Ab=K.indexOf(Ae,Af);if((Ab===0)&&(Ae.length===1)){Ac=mstrmojo.Arr.makeObservable((Ac&&Ac.length)?Ac.concat():[]);Ad.set("items",Ac);}else{if(Ab>-1){Ae.splice(Ab,1);}if(Ac&&Ac.length){K.insert(Ae,(Ab>-1)?Ab:Ae.length,Ac);}Ad.refresh();}}function N(Ab){return mstrmojo.mixin(Ab,{scriptClass:"mstrmojo.rw.ConditionList",cssClass:"mstrmojo-"+Ab.alias,postCreate:J});}function V(Ad,Ab,Ae){var Ac=Ad.cfg;if(Ac){Ac.data=Ad;Ac.parent=Ae;return AM.ref(Ac);}Ac=new mstrmojo.Label({text:Ad.n||"&nbsp;",cssClass:"dial-item "+(Ad.t?("t"+Ad.t):"")});Ac.markupMethods.onselectedChange=function(){AT.toggleClass(this.domNode,["selected"],this.selected);};Ac.data=Ad;Ac.parent=Ae;return Ac;}function f(Ac,Ab){var Ad=Ab+AP.FN_SEP+Ac;return(Ac!=null)?{did:Ad,n:Ad}:null;}function AX(Ab){return Ab.targets?K.filter(Ab.targets,function(Ac){return Ac[AI]===AP.TP.ATTR;}):[];}function Q(Ad,Ac,Ae,Ah){Ad.updating=true;if(Ac){if(Ae!=null){Ad.clearSelect();Ad.set("items",Ae);}var Ag=Ad.itemIdField,Af=Ad.selectedItem;if((Af&&Af[Ag])!=(Ah&&Ah[Ag])){var Ab=Math.max(K.indexOf(r((Ae||[]),function(Ai){return Ai[Ag];}),Ah&&Ah[Ag]),0);Ad.set("selectedIndex",Ab);}}Ad.updating=false;}function AQ(Ab,Ac,Ae,Ad){Ab.updating=true;Ab.clearSelect();K.forEach(Ac,function(Af){Af.title=Af.title||Af.n||"";});if(Ac){Ab.set("items",Ac);}if(Ae&&Ae.length){Ab.setSelectedItems(Ae);}else{if(Ad&&Ad.length){Ab.select(Ad);}}Ab.updating=false;}function AH(Ac,Ab,Ad,Af,Ae){if(Ab){AQ(Ac,Ad,Af,Ae);}}function AG(Ad,Ac){var Ab=Ad.model||{},Ae=Ab.fn;return(Ae!=null)&&((Ab.et===b.MQ)||(Ab.et===b.MC)||(Ab.et===b.AQ)||(Ab.et===b.AL)||(Ab.et===b.AC))&&(AP.fnCstCount(Ae,Ab.fnt)>Ac);}var e={};e[AN.DATE]=1;e[AN.TIME]=1;e[AN.TIMESTAMP]=1;function m(Ab,Ad){var Ac;if(Ad){switch(AF[Ab.et]){case"a":Ac=Ad[b.AC];break;case"m":Ac=Ad[b.MC];break;default:Ac=false;break;}}else{Ac=true;}return Ac&&AP.fn_AC_MC(Ab&&Ab.fn);}function j(Ac){var Af=Ac&&n[Ac.et],Ae=Ac&&Ac.fm&&Ac.fm.dtp,Ab=Ae&&AP.DTP2PROMPT_STP[Ae],Ad={};Ad[Af]=true;if(Ab){Ad[Ab]=true;}return Ad;}function d(Ab){switch(Ab){case c.DataTypeInteger:case c.DataTypeUnsigned:case c.DataTypeDecimal:case c.DataTypeReal:case c.DataTypeDouble:case c.DataTypeFloat:return c.DataTypeNumeric;default:return Ab;}}function C(Ac){var Ae=Ac.model,Aj=Ae&&Ae[AF[Ae.et]]&&Ae[AF[Ae.et]][Ac.columnWalk.target.itemIdField],Ad=Ae&&Ae.fm,Ab=Ad&&Ad.dtp,Ag=m(Ae,Ac.ets);if(this.targetsLastMod&&this.targetsLastMod===Ac.targetsLastMod&&Aj&&Aj===this._lastTargetId&&this.lastFmDtp===Ab&&this.lastFnTp===Ag){return ;}if(!Ag){this.clearSelect();this.set("items",this.items.slice(0,this.preLen));}else{var Ah=j(Ae),Ak=Ae[AF[Ae.et]],Af=Ae.a?[a]:Ae.m?[AE]:[],Al=Af.concat(AP.getSortedObjectsByTypeGroup(K.filter(Ac.targets,function(Am){return(Am.t!==4||Am.did!==Ak.did)&&(Ah[Am[AI]]||Ah[Am[P]]);}))),Ai=this.items.slice(this.preLen);K.forEach(Ai.reverse(),function(Am){this.remove(Am);},this);this.add(Al,-1);}this._lastTargetId=Aj;this.lastFnTp=Ag;this.lastFmDtp=Ab;this.targetsLastMod=Ac.targetsLastMod;}function AK(Au,Al){Au.updating=true;var Ah=Au.parent.parent.parent,At=AG(Ah,Al),An,Ap;if(At){var Ad=Ah.model||{},Af=Ad.cs,Ar=Af&&Af[Al],Ak=Ar&&Ar.v,Ai;C.call(Au,Ah);switch(Ad.et){case b.MQ:case b.MC:Ai=(Ar&&Ar.dtp)||d(Ad.m.dt)||AP.METRIC_DTP;break;case b.AQ:case b.AC:case b.AE:Ai=Ad.fm&&Ad.fm.dtp;break;case b.AL:Ai=Ad.fm&&Ad.fm.dtp;Ak=[];for(An=0,Ap=Af&&Af.length;An<Ap;An++){Ak.push(Af[An].v);}Ak=Ak.join(mstrConfig.listSep);break;}Ai=Ai||AN.CHAR;var Ag=Ad.fn,Am=AP.fn_List(Ag,Ad.fnt),Ao=e[Ai],Aq=Ao&&!Am;var Ac=Au.ctxtBuilder,Ab=Ac&&Ac.itemWidgets,As=Ao?(Aq?Au.calIndex:Au.dtxtIndex):Au.txtIndex,Ae;for(An=0,Ap=Au.preLen;An<Ap;An++){Ae=Ab[An];if(An==As){Ae.set("dtp",Ai);Ae.set("isList",Am);Ae.set("value",Ak);Ae.set("visible",true);try{if(Au.alias!=="c1"){Ae.focus&&Ae.focus();}}catch(Aj){}if(Ag===1||Ag===2){Ae.constraints.min=0;}if(Ae.clearValidation){Ae.clearValidation();}}else{Ae.set("visible",false);}if(Am){Ae.set("hint",mstrmojo.desc(8191,"value1## value2## ...## valueN").replace(/##/g,mstrConfig.listSep||";"));}else{Ae.set("hint","");}}if(Ah.hasPrompt&&Au.selectedItem&&Au.selectedItem.st===AP.STP.PROMPT_STRING){Ah.invalid0=false;}switch(Ad.et){case b.AQ:case b.AL:case b.MQ:if(Ar&&Ar.p){Au.set("selectedItem",Ar.p);}else{Au.set("selectedIndex",As);}break;case b.MC:case b.AC:Au.set("selectedItem",Ad[AF[Ad.et]+(2+Al)]);break;}}Au.updating=false;}function h(){var Ae=this.parent,Ac=Ae.parent.parent.parent,Ad=(this.isValid&&this.isValid())||(!this.isValid&&!mstrmojo.string.isEmpty(this.value)),Ab=Ac.model;Ac["invalid"+Ae.cstIndex]=!Ad;if(!this.updating&&Ad){this.updating=true;if(Ab){Ab.edit(Ae.alias,{v:this.value,dtp:this.dtp});}this.updating=false;}F(Ac);}function AS(){var Ac=this.parent,Ab=Ac.parent;Ab["invalid"+Ac.cstIndex]=false;}function AC(Ab){this.tip.set("text",Ab);}function D(Ad){var Af=this.selectedItem;Ad=K.filter(Ad,function(Ag){return(!Ag.icf);});if(Af){var Ac=K.find(Ad,this.itemIdField,Af[this.itemIdField]);if(Ac>-1){Ad=Ad.concat();Ad.splice(Ac,1);}}AD(this,A,Ad);var Ae=this.items,Ab=Ae.length;if(Ab===1){this.singleSelect(0);}this.parent.updateScrollbars();}function I(Ac){var Ab=[{did:660,cfg:{scriptClass:"mstrmojo.ValidationTextBox",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP|mstrmojo.validation.TRIGGER.VALUESET},onValid:h,onInvalid:h,onClearValidation:AS,size:6,visible:false}},{did:154,cfg:{scriptClass:"mstrmojo.Calendar",onvalueChange:h,visible:false}},{did:23,cfg:{scriptClass:"mstrmojo.DateTextBox",cssText:"margin-left:9px;",cssDisplay:"inline-block",required:true,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onValid:h,onInvalid:h,onClearValidation:AS,calendarToBody:true,autoFormat:false,calConfig:{onmousedown:function(Ad){mstrmojo.dom.stopPropogation(Ad.hWin,Ad.e);}},visible:false}}];return N(M.copy(Ac,{scriptClass:"mstrmojo.WidgetDial",makeObservable:true,itemFunction:V,selectionPolicy:"reselect",items:Ab.concat(),txtIndex:0,calIndex:2,dtxtIndex:2,preLen:Ab.length,insertUnlistedValuesAt:-1,itemIdField:"did",update:function(){AK(this,this.cstIndex);this.parent.updateScrollbars();},postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},itemsEffect:undefined,onchange:l}));}function G(Ab){return N(M.copy(Ab,{insertUnlistedValuesAt:-1,postCreate:function(){J.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,readCache:true,writeCache:true,params:{taskId:"getAttributeForms",attributeId:null,displayedForms:"0",styleName:"MojoAttributeStyle"},onsuccess:function(){var Ad=this.parent,Ac=this.response;if((Ac&&Ac.did)!==Ad.lastAttrId){return ;}D.call(this.parent,Ac.fms||[]);},onerr:function(){AD(this.parent,A,[p]);}});},update:function(){var Am=this.fmPost,Ae=this.parent.parent.parent,Ag=Ae.model,Al=Ag&&Ag["a"+Am],Aj=!!Al,Af,Ai,An,Ad=Ae.disableElementsBrowsing,Ac=Al&&Ad&&Ad(Al);if(Aj){switch(Ag.et){case b.AQ:case b.AL:Ai=Ag.fm;break;case b.AC:Ai=Ag["fm"+Am];break;case b.AE:Ai=f(Ag.fn,1);break;}if(this.lastAttrId!==Al.did){this.lastAttrId=Al.did;Af=[];if(this.isFirstFm){if(!Ac&&(!Al.ilk&&(!Ae.ets||Ae.ets[b.AE]))){Af.push(AW);var Ah=B[b.AE],Ak=Ah&&Ah.key;Af=Af.concat((Ak&&Ae[Ak])||Ah.def||[]);}Af.push(AJ);}if(Ai&&(Ag.et!==b.AE)){Af.push(Ai);}An=this.ajx;An.params.attributeId=Al.did;An.params.otp=Al.t||12;Af.push(A);L.makeObservable(Af);}}if(Ac&&Ag.et===b.AE){Ai=null;}Q(this,Aj,Af,Ai);if(Aj&&An){if(Ae.getAttributeForms){D.call(this,Ae.getAttributeForms(Al.did)||[]);}else{if(Al.fms){D.call(this,Al.fms);}else{if(An){if(An._delayId){window.clearTimeout(An._delayId);delete An._delayId;}An._delayId=window.setTimeout(function(){delete An._delayId;An.send();},500);}}}}}}));}var AB=[AP.STP.PROMPT,AP.STP.PROMPT_OBJECTS,AP.STP.PROMPT_ELEMENTS,AP.STP.PROMPT_EXPRESSION,AP.STP.PROMPT_EXPRESSION_DRAFT];function Z(Ab){if(Ab&&!M.isEmpty(Ab)){var Ac=K.hash(AB);M.forEach(Ab,function(Ae,Ad){if(Ae){Ac[n[Ad]]=true;}});return Ac;}return null;}mstrmojo.rw.ConditionWalkProvider=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.rw.ConditionWalkProvider",browseEs:function S(Ae,Ad,Ag){Ae.openPopup("eb",{zIndex:Ae.parent.zIndex+10,left:Math.round(Ag.x)+"px",top:Math.round(Ag.y)+"px"});var Ac=Ae.eb.browser,Ab=Ae.model,Af=Ab&&Ab.a&&Ab.a.did;if(!Af){return ;}Ac.set("attributeID",Af);Ac.set("selectedItems",Ab.es?M.clone(Ab.es):[]);Ac.initBrowser();},browseObjs:function AV(Ai,Ab,Ac){Ai.openPopup("ob",{zIndex:Ai.parent.zIndex+10,left:Math.round(Ac.x)+"px",top:Math.round(Ac.y)+"px"});var Ad=Ai.ob.browser;Ad.target=Ab;var Ae;switch(Ab.alias){case"dmy":Ae=[AP.TP.ATTR,AP.TP.DIM];break;case"c0":case"c1":var Ag=Ai.model,Af=Ag&&Ag.et,Aj=Ag&&Ag.fm,Ah=Aj&&Aj.dtp||(Ag.m?AP.DTP.DECIMAL:AP.DTP.UNKNOWN);Ae=(Af===b.MQ||Af===b.MC)?[AP.TP.METRIC,AP.DTP2PROMPT_STP[Ah]]:[AP.TP.ATTR,AP.DTP2PROMPT_STP[Ah]];break;default:Ae=Z(Ai.ets);Ae=Ae?M.keyarray(Ae,true):[AP.TP.ATTR,AP.TP.METRIC,AP.STP.REPORT_GRID,AP.STP.REPORT_GRAPH,AP.STP.REPORT_ENGINE,AP.STP.REPORT_TEXT,AP.STP.REPORT_DATAMART,AP.STP.REPORT_BASE,AP.STP.REPORT_GRIDGRAPH,AP.STP.REPORT_NONINTERACTIVE,AP.STP.FILTER].concat(AB);}Ae[Ae.length]=AP.TP.FOLDER;Ad.browse({rootFolderType:Ag&&(Ag.et===b.MQ||Ag.et===b.MC)?5:26,folderLinksContextId:33,onSelectCB:[Ai,"onOBSelect"],browsableTypes:Ae.join(",")});},getFm2NodeProps:function AO(){return{alias:"fm2",children:[G({alias:"fm2",fmPost:2})],updateColumnContainer:function Ab(){var Ac=this.parent.parent;this.fm2.update();AC.call(Ac,u);H.call(this);}};},getC0NodeProps:function E(){var Ab=this;return{alias:"c0",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(527,"Value")},I({alias:"c0",cstIndex:0}),{scriptClass:"mstrmojo.Label",alias:"btwn",cssClass:"btwn",text:mstrmojo.desc(308,"and"),visible:false},I({alias:"c1",cstIndex:1,visible:false}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.c0);},visible:false}],updateColumnContainer:function Ac(){this.c0.update();var Af=this.parent,Ah=Af.parent,Ai=Af.parent.model,Ak=Ai&&Ai.fn,Ag=Ak===O.BETWEEN||Ak===O.NOT_BETWEEN||Ak===x.BETWEEN||Ak===x.BETWEEN_DESCENDING,Ae=Ak===O.EQUAL||Ak===O.NOT_EQUAL||Ak===O.GREATER||Ak===O.GREATER_EQUAL||Ak===O.LESS||Ak===O.LESS_EQUAL,Ad=this.idx,Aj=this.next;this.browseLink.set("visible",Ah.objectBrowsingEnabled&&m(Ai,Ah.ets));this.btwn.set("visible",Ag);this.c1.set("visible",Ag);if(Ag){this.c1.update();}else{Ai.edit("c1",{v:null,dtp:null,skipET:true});}if(Ai.a2&&Ae){if(!(Aj&&Aj.fm2)){Af.insertAndRemoveTrailing(Ad,Ab.getFm2NodeProps());}}else{Af.removeTrailingContainer(Ad);}AC.call(Ah,Ai.a?v:Ai.m?q:"");H.call(this);}};},getFnNodeProps:function AZ(){var Ab=this;return{alias:"fn",children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(9579,"Condition")},G({alias:"fn",allowUnlistedValues:false,update:function(){var Ai=this.parent.parent.parent,Ae=Ai.model||{},Aj=Ae.et,Ah,Ak=false,Al,Ad;switch(Aj){case b.AE:Ak=!!Ae.a;break;case b.AQ:case b.AC:case b.AL:Ak=!!(Ae.fm&&Ae.fm.did);Ah=Ak?Ae.fm.dtp:null;break;case b.MQ:case b.MC:Ak=!!Ae.m;Ah=Ak?AP.METRIC_DTP:null;break;}if(Ak){var Am=k[Ah];if((this.lastEt!==Aj)||(this.lastFnDtp!==Am)){this.lastEt=Aj;this.lastFnDtp=Am;var Ag=Aj?B[Aj]:null,Af=Ag&&Ag.key;Al=(Af&&Ai[Af])||Ag.def||[];if(typeof (Al)==="object"){Al=Al[Am]||Al["*"];}}Ad=f(Ae.fn,Ae.fnt||1);}Q(this,Ak,Al,Ad);this.parent.updateScrollbars();}})],updateColumnContainer:function Ac(){this.fn.update();var Ad=this.parent,Ae=Ad.parent,Af=Ae.model,Ah=Af&&Af.fn,Ag=this.next,Ai=Ah===O.IS_NULL||Ah===O.IS_NOT_NULL;if(Ah&&Ai){Ad.removeTrailingContainer(this.idx);}else{if(Ah&&!(Ag&&Ag.c0)){Ad.insertAndRemoveTrailing(this.idx,Ab.getC0NodeProps());}}AC.call(Ae,Af.a?w:Af.m?t:"");Ag=this.next;if(Ag){Ag.updateColumnContainer();}}};},getEsNodeProps:function T(){var Ad=[{scriptClass:"mstrmojo.ui.CheckList",alias:"es",itemIdField:"v",allowUnlistedValues:true,insertUnlistedValuesAt:0,selectionPolicy:"toggle",postCreate:function Ac(){J.apply(this,[]);this.ajx=mstrmojo.insert({parent:this,scriptClass:"mstrmojo.AjaxCall",isTask:true,params:{taskId:"browseElements",attributeID:null,styleName:"MojoAttributeStyle",blockBegin:1,blockCount:mstrApp.elementsBlockCount||30},onsuccess:function(){var Ao=this.parent,Ai=this.response;if((Ai&&Ai.did)!==Ao.lastAttrId){return ;}var Ak=(Ai&&Ai.es)?K.filter(Ai.es,function(Ap){return !U.isNullElem(Ap.v);}):[],An=Ao.parent.parent.parent.model&&Ao.parent.parent.parent.model.es,Al=function(Av,Aq){var Au=Av&&Av.length||0,At=Aq&&Aq.length||0,Ap=[],As,Ar;for(As=0;As<At;As++){for(Ar=0;Ar<Au;Ar++){if(Aq[As].n===Av[Ar].n){break;}}if(Ar===Au){Ap.push(Aq[As]);}}return Ap;},Am=function(Ap,Aq,At){var As=[],Ar;K.forEach(Ap,function(Au){Ar=K.filterOne(Aq,function(Av){return Au[At]&&Av[At]&&Au[At]===Av[At];});if(Ar){As.push(Ar);}});return As.length===Ap.length?As:Ap;};An=An&&Am(An,Ak,"v");if(Ao.allowUnlistedValues){var Aj=Al(Ak,An);Ak=(Ao.insertUnlistedValuesAt===0)?Aj.concat(Ak):Ak.concat(Aj);}AQ(Ao,Ak,An,null);Ao.parent.updateScrollbars();},onerr:function(){AD(this.parent,A,[p]);}});},onselectionChange:function Ag(Ai){mstrmojo.ListBase.prototype.onselectionChange.call(this,Ai);l.call(this,Ai);},update:function Af(){var Al=this.parent.parent.parent,Ak=Al.model,Ap=Ak&&Ak.a,Aq=!!Ap&&!Ap.ilk,Ar,Ai,Ao,Am,Aj,As;if(Aq){if(this.lastAttrId!==Ap.did){this.lastAttrId=Ap.did;Ar=Ak.es;Am=Ar&&Ar.length;Ar=Am?Ar.concat():[];Ar.push(A);if(Am){Ao=[];for(Aj=1;Aj<=Am;Aj++){Ao[Aj]=Aj;}}As=this.ajx;Al.updateBrowseElementsParams(As.params,Ap);}else{Ai=Ak.es;}}AH(this,Aq,Ar,Ai,Ao);if(Aq&&As){if(Al.getElements){var An=this;Al.getElements(Ap,{success:function(At){AQ(An,At.es||[],Al.model&&Al.model.es,null);An.parent.updateScrollbars();},failure:function(){AD(An,A,[p]);}});}else{As.send();}}},setupScrollNodes:function Ae(){this.scrollNode=null;}}];if(!mstrApp.isSingleTier){Ad.splice(0,0,{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7928,"Browse elements..."),onclick:function Ab(){this.parent.parent.parent.browse(this.parent.es);}});}return{alias:"es",children:Ad,updateList:function(Ai){AH(this.es,true,Ai,this.parent.parent.model.es,null);this.updateScrollbars();},updateColumnContainer:function Ah(){var Ai=this.parent.parent;this.es.update();AC.call(Ai,z);}};},getFmNodeProps:function g(){var Ab=this;return{alias:"fm",children:[G({alias:"fm",fmPost:"",filter:false,isFirstFm:true})],updateColumnContainer:function Ac(){this.fm.update();var Am=this.parent,Ah=Am.parent,Ag=Ah.model,Aj=Ag&&Ag.fm,Al=this.idx,Ak=Ag&&Ag.a,Ae=Ah.disableElementsBrowsing,Ad=Ak&&Ae&&Ae(Ak);var Ai=(Ag.etWas&&Ag.etWas===b.AE)?AY:AL,Af=AL;if(Ag.et===b.AE&&!Ad){Af=AY;}if(Ai!==Af||Af===AL){Am.removeTrailingContainer(Al);if(Af===AL&&Aj){Am.addNextColumn(Ab.getFnNodeProps());}else{if(Af===AY){Am.addNextColumn(Ab.getEsNodeProps());}}}AC.call(Ah,AA);H.call(this);}};},getTargetNodeProps:function R(){var Ab=this;return{alias:"target",target:null,browseLink:null,children:[{scriptClass:"mstrmojo.Label",cssClass:"baseOn",text:mstrmojo.desc(11859,"Based On")},N({alias:"target",insertUnlistedValuesAt:0,makeObservable:true,hideIfEmpty:true,postCreate:function(){this._super();this.parent.parent.parent.attachEventListener("updateTargets",this.id,function(){this.update();});},onObjBrowsed:function(Ae){if(Ae.st===W.FILTER||Ae.t===AU.REPORT||Ae.t===AU.PROMPT){this.parent.parent.parent.onOK();}},update:function Ad(){var Af=this.parent.parent.parent,Ag=Af.model,Aj=Af.targetsLastMod,Ak=Ag&&Ag.et;if(this.lastModel!==Ag||this.targetsLastMod!==Aj){this.lastModel=Ag;this.targetsLastMod=Aj;var Ae=Af.targets,Al=Af.ets;if(Al&&Ae&&Ae.length){var Ai=Z(Af.ets);Ae=K.filter(Ae,function(Am){return Ai[Am[AI]];});}var Ah=Ag&&Ag[AF[Ak]];Q(this,true,AP.getSortedObjectsByTypeGroup(Ae),Ah);this.parent.updateScrollbars();}}}),{alias:"browseLink",scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-walkstep-browse",text:mstrmojo.desc(7926,"Browse..."),onclick:function(){this.parent.parent.parent.browse(this.parent.target);}}],updateColumnContainer:function Ac(){this.target.update();var Af=this.parent,Ag=Af.parent,Ah=Ag.model,Aj=Ah&&Ah.et,Ae=this.idx,Ai=this.next;this.browseLink.set("visible",Ag.objectBrowsingEnabled);if(Aj){switch(Aj){case b.AQ:case b.AL:case b.AC:case b.AE:if(Ah.a&&!(Ai&&Ai.fm)){this.parent.insertAndRemoveTrailing(Ae,Ab.getFmNodeProps());}break;case b.MQ:case b.MC:if(Ah.m&&!(Ai&&Ai.fn)){this.parent.insertAndRemoveTrailing(Ae,Ab.getFnNodeProps());}break;case b.R:case b.F:case b.XML:this.parent.removeTrailingContainer(Ae);break;}}Ai=this.next;if(Ai){Ai.updateColumnContainer();}}};}});var X=mstrmojo.rw.ConditionWalkProvider;X.updateOkBtn=F;X.setTip=AC;X.getChildJSON=N;X.updateList=Q;X.fmJson=G;X.cstJson=I;}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.date","mstrmojo.DateTextBox","mstrmojo._IsInputControl");var B=mstrmojo.css,A=mstrmojo.expr.DTP;mstrmojo.CalendarDIC=mstrmojo.declare(mstrmojo.DateTextBox,[mstrmojo._IsInputControl],{scriptClass:"mstrmojo.CalendarDIC",autoFormat:false,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL},onvalueChange:function(){if(!this.showByDefault){var F=this.calendar.cal,D=mstrmojo.date,E=this.dic.min,C=this.dic.max;this.invalid=mstrmojo.string.trim(this.value||"").length===0||this.validationStatus.code>mstrmojo.validation.STATUSCODE.VALID;if(F.value!==this.value){F.set("value",this.value);}else{if(E&&D.compareDateAndOrTime(E,F.value)>0){this.value=E;}else{if(C&&D.compareDateAndOrTime(F.value,C)>0){this.value=C;}}}}},getInputNode:function(){return this.inputNode;},init:function(C){this._super(C);this.dtp=this.dic.ict?A.TIMESTAMP:A.DATE;},focus:function(){mstrmojo.dom.setCaret(this.inputNode,((this.value&&this.value.length)||0));this.openPopup("calendar");this.adjustCalendarPopup();},adjustCalendarPopup:function(){var F=this.domNode,E=this.calendar.domNode,D=E.scrollWidth,I=mstrmojo.boxmodel.offset(this.openerNode,document.body),H=I.left,G,C=(document.body.offsetWidth-H-D-parseInt(B.getStyleValue(F,"paddingLeft"),10)-parseInt(B.getStyleValue(F,"paddingRight"),10));if(C<0){E.style.left=C+"px";}G=parseInt(I.top,10);if(G+this.inputNode.offsetHeight+E.offsetHeight<=mstrmojo.dom.windowDim().h){E.style.top=this.inputNode.offsetHeight+"px";}else{E.style.top=-E.offsetHeight+"px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.OIVMDICPopup","mstrmojo.SliderDIC","mstrmojo.TextFieldDIC","mstrmojo.CheckBoxDIC","mstrmojo.ListDIC","mstrmojo.CalendarDIC","mstrmojo.TimePickerDIC","mstrmojo.ToggleDIC","mstrmojo.TextAreaDIC","mstrmojo.MarkRowDIC","mstrmojo.DefaultDIC","mstrmojo.RatingDIC","mstrmojo.RankDIC","mstrmojo.StepperDIC","mstrmojo.LikertScaleDIC","mstrmojo._HasConditionLogicDIC","mstrmojo.DynamicClassFactory");var C=null,B=1,L=2,H=3,A=4,M=5,P=6,G=7,O=8,E=10,F=11,K=13,J=2,D=2;var I={1:"ActiveTextFieldDIC",3:"ActiveListDIC",8:"ActiveTextAreaDIC",10:"ActiveRatingDIC",11:"ActiveRankDIC",14:"ActiveLikertScaleDIC"};var N=mstrmojo.DynamicClassFactory.newComponent;mstrmojo.OIVMDICConfig=mstrmojo.provide("mstrmojo.OIVMDICConfig",{DICList:{1:mstrmojo.TextFieldDIC,2:mstrmojo.CheckBoxDIC,3:mstrmojo.ListDIC,4:mstrmojo.SliderDIC,5:mstrmojo.CalendarDIC,6:mstrmojo.TimePickerDIC,7:mstrmojo.ToggleDIC,8:mstrmojo.TextAreaDIC,9:mstrmojo.DefaultDIC,10:mstrmojo.RatingDIC,11:mstrmojo.RankDIC,12:mstrmojo.StepperDIC,13:mstrmojo.DefaultDIC,14:mstrmojo.LikertScaleDIC,102:mstrmojo.MarkRowDIC},getDICClass:function(R){if(R.t===K){if(!!R.em){return mstrmojo.ListDIC;}else{return mstrmojo.TextFieldDIC;}}if(R.act){var Q=I[R.t];if(!mstrmojo[Q]){mstrmojo[Q]=N(this.DICList[R.t],[mstrmojo._HasConditionLogicDIC],{scriptClass:Q});}return mstrmojo[Q];}return this.DICList[R.t];},showDICByDefault:function(R,Q){if(R.sbd===undefined){if(R.t==O&&R.dm==0&&R.siwc){R.sbd=true;}else{if(R.t==K){R.sbd=false;}else{if(this.DICList[R.t]==mstrmojo.DefaultDIC){R.sbd=0;}else{R.sbd=R.dm===1;}}}}return R.sbd;},hasDICPreview:function(R,Q){if(R.hpp===undefined){R.hpp=false;}return R.hpp;},isKeyNavigable:function(Q){if(Q.ikn===undefined){switch(Q.t){case B:case M:case H:case L:case G:case A:case P:case O:Q.ikn=true;break;default:Q.ikn=false;}}return Q.ikn;},DICPopup:{getInstance:function(Q,R){if(!C){C=new mstrmojo.OIVMDICPopup();C.render();}C.open(Q,{widget:R});return C;},cancel:function(){if(C){C.onCancel();}}},canSlice:function(S,R){var T=S.tks,Q=S.ipt;if(!!T&&Q==D&&R==J){return true;}return false;}});mstrmojo.DICConfig=mstrmojo.OIVMDICConfig;mstrmojo.DICList=mstrmojo.DICConfig.DICList;mstrmojo.DICPopup=mstrmojo.DICConfig.DICPopup;})();(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.dom","mstrmojo.hash","mstrmojo.Container","mstrmojo._HasLayout","mstrmojo._HasPopup","mstrmojo.ui.ColumnWalk","mstrmojo.Button","mstrmojo.mstr.EnumNodeDimty","mstrmojo.ConditionModel","mstrmojo.rw.ConditionWalkProvider");var P=mstrmojo.Widget,H=mstrmojo.array,E=mstrmojo.dom,M=mstrmojo.hash,A=mstrmojo.mstr.EnumNodeDimty,S=mstrmojo.rw.ConditionWalkProvider.updateOkBtn,I=mstrmojo.rw.ConditionWalkProvider.setTip;var C=mstrmojo.desc(11899,"Select a dataset object.");var K=H.hash([A.NodeDimtyOutputLevel]);function D(){var T=this.model;if(T){if(!T.attachEventListener){mstrmojo.hash.make(T,mstrmojo.ConditionModel,{});}T.attachEventListener("edit",this.id,"onmodeledit");}}function L(U,T){if(T&&T.detachEventListener){T.detachEventListener("edit",U.id,"onmodeledit");}}function N(Y,T){var W=T,X=[],V=[],U=[],Z=false;M.forEach(W,function(a){X=X.concat(a.att.filter(function(b){return b.did===Y;}));});Z=X[0]&&X[0].da;X.forEach(function(a){V=V.concat(a.fs||[]);});V.forEach(function(a){if((a.obf||Z)&&U.filter(function(b){return b.did===a.fid;}).length===0){U.push({did:a.fid,dtp:mstrmojo.expr.mapBaseFormTypeToDataType(a.bftp),n:a.fnm,t:a.t});}});return U;}mstrmojo.rw.ConditionWalk=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout,mstrmojo._HasPopup],{scriptClass:"mstrmojo.rw.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},walkNode:function(){return this.domNode.children[1];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:function J(){P.visibleMarkupMethod.call(this);if(this.visible){this.initWalk();}},onheightChange:P.heightMarkupMethod,onwidthChange:P.widthMarkupMethod},layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",applyNode:"auto"},xt:true},editor:undefined,columnWalk:undefined,tip:undefined,walkProvider:null,objectBrowsingEnabled:true,postCreate:function B(){if(this._super){this._super();}if(!this.walkProvider){this.walkProvider=mstrmojo.insert(mstrmojo.rw.ConditionWalkProvider);}},initWalk:function O(){var T=this.columnWalk,U=this.walkProvider;I.call(this,C);T.removeTrailingContainer(-1);T.addNextColumn(U.getTargetNodeProps());T.target.updateColumnContainer();S(this);},updateBrowseElementsParams:function(W,V){W.attributeID=V.did;W.otp=V.t||12;var U=this.editor,T=U&&U.onUpdateBrowseElementsParams;if(T){T.call(U,W,V);}},children:[{scriptClass:"mstrmojo.ui.ColumnWalk",alias:"columnWalk",slot:"walkNode",height:"333px",width:"750px"},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",title:mstrmojo.desc(2399,"Cancel"),ignoreLayout:true,onclick:function(){var T=this.parent;if(T.close){T.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",title:mstrmojo.desc(2397,"OK"),onclick:function(){var T=this.parent;if(T.onOK){T.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:C,ignoreLayout:true}],eb:{scriptClass:"mstrmojo.Editor",cssClass:E.isIE7?"mstrmojo-ElementsEditorIE7":"mstrmojo-ElementsEditor",title:mstrmojo.desc(6149,"Select Elements"),help:"element_browser_dialog_box.htm",children:[{scriptClass:"mstrmojo.ElementsBrowser",alias:"browser",onUpdateBrowseElementsParams:function(U){var T=this.parent.opener;T.updateBrowseElementsParams(U,T.model.a);}},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBox",slot:"buttonNode",children:[{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(1442,"OK"),cssClass:"mstrmojo-WebButton hot",cssText:"width: 66px;",onclick:function(){var T=this.parent.parent,U=T&&T.opener;if(U){U.onEBSelect();U.closePopup();}}},{scriptClass:"mstrmojo.Button",alias:"ok",text:mstrmojo.desc(221,"Cancel"),cssClass:"mstrmojo-WebButton",cssText:"min-width: 66px; margin-left: 11px;",onclick:function(){var T=this.parent.parent,U=T&&T.opener;if(U){U.closePopup();}}}]}]},ob:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(5298,"Select an Object"),help:"Select_Objects_dialog_box_.htm",children:[{scriptClass:"mstrmojo.ObjectBrowser",alias:"browser",fishEyeVisible:false,upButtonVisible:true,scrollableIncFetch:true,showCompletePath:false,closeable:false,closeOnSelect:false,browsableTypes:"3,4,8,10,12,256",includeObjectDesc:true,quickSearch:true,minSearchLength:1}]},_set_model:function R(W,T){var U=this.model,V=(T!==U);if(V){L.call(this,U);T.dimtyTypes=this.dimtyTypes||K;this.model=T;D.call(this,T);if(this.hasRendered&&this.visible){this.columnWalk.target.updateColumnContainer();}}return V;},onmodeledit:function G(T){this.columnWalk[T.prop==="c1"?"c0":T.prop].updateColumnContainer();S(this);},browse:function F(V){var X=this.parent.editorNode,W=function(Z,b){var Y=mstrmojo.dom.position(Z,true),a=mstrmojo.dom.position(b,true);return{x:Y.x+Y.w,y:a.y};},T=this.columnWalk,U=this.walkProvider;switch(V&&V.alias){case"target":case"dmy":U.browseObjs(this,V,W(V.alias==="target"?T.target.domNode:this.dmyNode,X));break;case"c0":case"c1":U.browseObjs(this,V,W(T.c0.domNode,X));break;case"es":U.browseEs(this,V,W(T.es.domNode,X));break;}},onOBSelect:function(X){var V=this.ob.browser,Z=V.target;this.closePopup();var U=this.targets,Y=Z.itemIdField,W=U||[],T=H.find(U,Y,X[Y]);if(T===-1){W.push(X);this.targets=W;this.targetsLastMod=new Date();this.raiseEvent({name:"updateTargets",targets:this.targets});}Z.setSelectedItems([X],Z.multiSelect);if(Z.onObjBrowsed){Z.onObjBrowsed(X);}},onEBSelect:function(){var U=this.eb.browser,W=this.columnWalk.es.es;W.set("selectedIndices",{});var T=W.items,V=[];H.forEach(U.selectedItems||[],function(Y){if(H.find(W.items,"v",Y.v)<0){V.push(Y);}});var X=W.insertUnlistedValuesAt||0;if(X<0){X=T.length;}W.set("items",T.slice(0,X).concat(V).concat(T.slice(X)));W.setSelectedItems(U.selectedItems,false);},destroy:function Q(U){var T=this.walkProvider;if(T&&T.destroy){this.walkProvider.destroy();}this._super(U);}});mstrmojo.rw.ConditionWalk.getAttForms=N;}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.expr","mstrmojo.dom","mstrmojo.form","mstrmojo.boxmodel","mstrmojo.Obj","mstrmojo.Arr","mstrmojo.string","mstrmojo.Box","mstrmojo.TBox","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Button","mstrmojo.HTMLButton","mstrmojo.TextBox","mstrmojo.Popup","mstrmojo.Editor","mstrmojo.Dial","mstrmojo.WidgetList","mstrmojo.FilterExpr","mstrmojo.CGEOptions","mstrmojo.ConditionWalk","mstrmojo.SaveAsEditor","mstrmojo.CGFormatEditor");var V=mstrmojo.expr,E=V.ET,K=V.BRANCH_FNS,R=mstrmojo.hash,Y=mstrmojo.boxmodel,G=mstrmojo.Arr,S=mstrmojo.Obj,L=mstrmojo.string,W=mstrmojo.dom,T=mstrmojo.expr.TP,B=mstrmojo.expr.STP;function F(a){var f={};if(a){var d=a.items;for(var c=0,Z=(d&&d.length)||0;c<Z;c++){var e=d[c],b=e&&e.expr;if(b){V.findTargets(b,"did",f);}}}return R.valarray(f);}function P(b){var a=b.model;b.targets=F(a);b.targetsLastMod=new Date();if(!a){a=new S({});b.model=a;}var d=a.items;if(!d){d=mstrmojo.Arr.makeObservable([]);a.items=d;}else{if(!d.attachEventListener){d=R.make(d,G);}}for(var c=0,Z=d.length;c<Z;c++){var e=d[c];if(!e.attachEventListener){e=R.make(e,S);}}}var M=mstrmojo.desc(4778,"Element"),U=new RegExp(M+"\\s*(\\d+)","i"),C=10000;function N(e){var d=1;for(var b=0,a=(e&&e.length)||0;b<a;b++){var f=e[b].n,Z=f&&f.match(U);if(Z){var c=parseInt(Z[1],10);d=Math.max(c+1,d);}}return M+" "+d;}var H=200;function D(d,c,b){var a=mstrmojo.all.mstrCGE,e=W.delta(c.domNode,a.editorNode);e.y+=(b=="andor"?16:parseInt(c.domNode.offsetHeight,10));var Z={condition:c,zIndex:a.zIndex+10,left:e.x+"px",top:e.y+"px"},f;switch(b){case"andor":f="andOrPopupRef";break;case"condition":f="conditionPopupRef";Z.model=R.clone(d);Z.targets=a.targets;Z.targetsLastMod=a.targetsLastMod;break;}a.openPopup(f,Z);}function X(a){var b=a.parent.data;if(b){var Z=a.items;b.expr=Z&&Z[0];}}function J(c){if(c.constructor!==Array){c=[c];}var g,f={b:0,c:0},h,e,a;for(var d=0,Z=c.length;d<Z;d++){g=c[d];if(!(g&&g.et)){continue;}h=g.nds;if(h){e=J(h);f.b+=e.b;f.c+=e.c;}else{a=(g.et===E.B);f[a?"b":"c"]++;}}return f;}function O(Z){var b=J(Z.value),a=this.tree;a.set("bandingCount",a.bandingCount+b.b);a.set("conditionCount",a.conditionCount+b.c);}function A(Z){var b=J(Z.value),a=this.tree;a.set("bandingCount",a.bandingCount-b.b);a.set("conditionCount",a.conditionCount-b.c);}function I(a){var d=mstrmojo.all.mstrCGE,Z=d.model,e=Z.did,c=Z.cgp,b=d.getXML();return{taskId:"saveCustomGroup",xml:b,objectID:e||"",description:Z.desc||"",name:Z.n||"",saveAs:a,aggregation:c.agg,flatten:c.flat,parentFirst:c.pf,reportFilterInteraction:c.rfi};}mstrmojo.CustomGroupEditor={id:"mstrCGE",title:mstrmojo.desc(7919,"Custom Group Editor"),scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-charcoalboxe",cssText:"width:750px;",zIndex:10,model:null,readOnly:false,help:"custom_group_editor.htm",formatPopupRef:{scriptClass:"mstrmojo.CGFormatEditor",contentNodeCssClass:"mstrmojo-balloon",alias:"formatEditor",title:mstrmojo.desc(2116),left:"100px",top:"100px",useAnimate:false,height:350,slot:"containerNode",help:"formatting_a_custom_group.htm",locksHover:true,model:null,_set_model:function(a,Z){P(mstrmojo.all.mstrCGE);this.model=Z;this.model.selectedIndex=mstrmojo.all.mstrCGEls.selectedIndex;return true;},bindings:{model:function(){return mstrmojo.all.mstrCGE.model;}},onOpen:function(){this.set("model",mstrmojo.all.mstrCGE.model);}},saveasRef:{scriptClass:"mstrmojo.SaveAsEditor",typeDesc:mstrmojo.desc(2105,"Custom Group"),browsableTypes:"8,257",onObjectSaved:function(b){var a=mstrmojo.all.mstrCGE,Z=a&&a.model;if(Z){Z.set("did",b.did);Z.set("n",b.name);Z.set("desc",b.desc);}if(a.noRefresh!==true){a.needRefreshPage=true;}}},optionsRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-CGEOptions",contentNodeCssClass:"mstrmojo-balloon",left:"100px",top:"230px",slot:"containerNode",help:"Custom_Group_Options_dialog_box.htm",showTitle:true,title:mstrmojo.desc(7969,"Custom Group Options"),onOpen:function(){var Z=mstrmojo.all.mstrCGE,a=this.optionsEditor;a.open(Z.model,{closeCB:[this,"close"]});},children:[{scriptClass:"mstrmojo.CGEOptions",alias:"optionsEditor"}]},postCreate:function(){P(this);},_set_model:function(d,Z){var b=this.model,c=b!==Z,a=mstrmojo.all.mstrCGEls;if(c){this.model=Z;P(this);if(a){a.clearSelect();}}return c;},children:[{scriptClass:"mstrmojo.TBox",alias:"header",cssText:"width: 100%",children:[{scriptClass:"mstrmojo.Label",alias:"name",cssClass:"mstrmojo-charcoalbox subtle mstrmojo-cge-name",emptyText:mstrmojo.desc(7920,"Enter Custom Group name here."),bindings:{text:function(){var Z=mstrmojo.all.mstrCGE.model.n||this.emptyText;return Z;}},onclick:function(){var Z=mstrmojo.all.mstrCGE,a=W.delta(this.domNode,Z.containerNode);Z.openPopup("inlineTextRef",{left:a.x+"px",top:a.y-(W.isIE7?1:0)+"px",txtConfig:{cssClass:"mstrmojo-cge-name-edit",value:Z.model.n||"",onEnter:function(){var b=L.trim(this.value);if(b){Z.model.set("n",b);}this.parent.close({enter:true});},onCancel:function(){this.set("value",Z.model.n);},prevTab:null,nextTab:Z.header.desc}});}},{scriptClass:"mstrmojo.Label",alias:"desc",cssClass:"mstrmojo-charcoalbox subtle mstrmojo-cge-desc",emptyText:mstrmojo.desc(7921,"Enter Custom Group description here."),rows:1,bindings:{text:function(){var Z=mstrmojo.all.mstrCGE.model.desc||this.emptyText;return Z;}},onclick:function(){var Z=mstrmojo.all.mstrCGE,a=W.delta(this.domNode,Z.containerNode);Z.openPopup("inlineTextRef",{left:a.x+"px",top:a.y-(W.isIE7?1:0)+"px",txtConfig:{cssClass:"mstrmojo-cge-desc-edit",value:Z.model.desc||"",onEnter:function(){Z.model.set("desc",L.trim(this.value));this.parent.close({enter:true});},onCancel:function(){this.set("value",Z.model.desc);},prevTab:Z.header.name,nextTab:null}});}}]},{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-CGE-content",alias:"content",children:[{id:"mstrCGEls",scriptClass:"mstrmojo.WidgetList",cssClass:"mstrmojo-CustomGroupEls",bindings:{items:"mstrmojo.all.mstrCGE.model.items"},multiSelect:false,renderOnScroll:false,draggable:true,dropZone:true,allowCopy:false,allowDrop:function(b){var a=b&&b.src,Z=a&&a.widget;return(Z===this);},itemIdField:null,itemDisplayField:"n",onchange:function(d){var a=this.selectedIndex,c=this.ctxtBuilder.itemWidgets,b;for(var e=0,Z=c.length;e<Z;e++){b=c[e];if(b&&e!=a){b.filterExpr.clearTreeSelect();}}},getNextId:function(){return ++C;},itemFunction:function(b,Z,a){return new mstrmojo.CustomGroupEl({cssClass:"mstrmojo-charcoalbox",data:b,parent:a,state:b.isNew?1:0,onRender:b.isNew?function(){this.filterExpr.newCondition();delete this.data.isNew;}:mstrmojo.emptyFn,onclick:function(c){var d=W.eventTarget(c.hWin,c.e);if(d===this.titleNode){var e=mstrmojo.all.mstrCGE,g=W.delta(this.titleNode,e.containerNode),f=this;e.openPopup("inlineTextRef",{left:g.x+(W.isIE?1:0)+"px",top:g.y+(W.isIE7?-1:1)+"px",txtConfig:{cssClass:"mstrmojo-cge-elname-edit",value:this.data.n||"",onEnter:function(){var h=L.trim(this.value);if(h){f.data.n=h;f.paint();}this.parent.close({enter:true});},onCancel:function(){this.set("value",f.data.n);},prevTab:null,nextTab:null}});}},postCreate:function(){this.children=[{scriptClass:"mstrmojo.FilterExpr",slot:"exprNode",alias:"filterExpr",bindings:{items:"var ex = this.parent.data.expr; return ex ? [ex] : []"},draggable:true,dropZone:true,allowCopy:false,makeObservable:true,bandingCount:0,conditionCount:0,getItemConfig:function g(l,h,m){var k=this.constructor.prototype.getItemConfig.call(this,l,h,m);k.getPrefixAndOrToolsMarkup=function j(){return('<img class="mstrmojo-outdent disable" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5896,"Ungroup conditions")+'" /><img class="mstrmojo-outdent" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5896,"Ungroup conditions")+'" onclick="mstrmojo.all[\'{@id}\'].out()" /><img class="mstrmojo-indent disable" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5895,"Group conditions")+'" /><img class="mstrmojo-indent" src="../images/1ptrans.gif" title="'+mstrmojo.desc(5895,"Group conditions")+'" onclick="mstrmojo.all[\'{@id}\'].ind()" />');};return k;},onadd:function(h){X(this);O.apply(this,[h]);},onremove:function(h){X(this);A.apply(this,[h]);},editable:true,onRender:function(){var j=J(this.items),h=this.tree;h.set("bandingCount",j.b);h.set("conditionCount",j.c);},isEditable:function f(j){if(!this.editable){return false;}var h=false;switch(j&&j.et){case E.ANDOR:case E.MQ:case E.AQ:case E.AL:case E.AC:case E.MC:case E.AE:case E.R:case E.F:h=true;break;case E.XML:h=!j.xml;}if(!h){mstrmojo.all.mstrCGE.set("readOnly",true);}return h;},onnodeclick:function e(h){if(!this.editable){return ;}D(this.data,this,h&&h.part);},onnodeadd:O,onnoderemove:A,allowDrop:function c(h){var k=h&&h.src,n=k&&k.data,m=n&&n.et,l=(m===E.B),j=this.tree;return m&&((l&&(j.conditionCount===0))||(!l&&(j.bandingCount===0)));},onNew:function d(h){D(h.data,h.widget.ctxtBuilder.itemWidgets[h.index],"condition");}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-CGE-addCondition",text:mstrmojo.desc(1994,"Add Condition"),slot:"exprToolsNode",onclick:function(){this.parent.filterExpr.newCondition(null,true);},bindings:{enabled:function(){return this.parent.filterExpr.bandingCount===0;}}}];}});}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-CGE-newElement",text:mstrmojo.desc(7922,"New Custom Group Element"),alias:"addBtn",title:mstrmojo.desc(7923,"Add new Custom Group Element"),onclick:function(){var Z=mstrmojo.all.mstrCGEls;var a=Z.add([{n:N(Z.items),did:++C,isNew:true}]);Z.scrollTo(a);}}]},{scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",cssText:"width: 100%",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HBox",cssClass:"left",cssText:"border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(4596,"Format..."),onclick:function(){var Z=mstrmojo.all.mstrCGE;Z.openPopup("formatPopupRef",{zIndex:Z.zIndex+10});},bindings:{enabled:function(){return mstrmojo.all.mstrCGE.model.items.length>0;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(7924,"Options..."),onclick:function(){var Z=mstrmojo.all.mstrCGE;Z.openPopup("optionsRef",{zIndex:Z.zIndex+10});}}]},{scriptClass:"mstrmojo.HBox",cssText:"float:right; border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(5891,"Save"),onclick:function(){var a=mstrmojo.all.mstrCGE,Z=a.model,f=Z.did,d=a.isValid(true),c=mstrmojo.desc(8113,"New Custom Group");if(d){if(!f){a.openPopup("saveasRef",{name:Z.n||c,desc:Z.desc||"",folderLinksContextId:22,rootFolderID:Z.pf,saveParams:I(true),zIndex:a.zIndex+10});return ;}var b=this,e=I(false);this.set("enabled",false);this.set("iconClass","mstrmojo-WaitIcon");mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(){b.set("enabled",true);b.set("iconClass","");},failure:function(g){b.set("enabled",true);b.set("iconClass","");mstrmojo.alert(g.getResponseHeader("X-MSTR-TaskFailureMsg"));}},e);}},bindings:{enabled:function(){return !mstrmojo.all.mstrCGE.readOnly&&mstrmojo.all.mstrCGE.model.items.length>0;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(628,"Save As"),onclick:function(){var a=mstrmojo.all.mstrCGE,Z=a&&a.model,c=a.isValid(true),b=mstrmojo.desc(8113,"New Custom Group");if(c){a.openPopup("saveasRef",{name:Z.n||b,desc:Z.desc||"",folderLinksContextId:22,rootFolderID:Z.pf,saveParams:I(true),zIndex:a.zIndex+10});}},bindings:{enabled:function(){return !mstrmojo.all.mstrCGE.readOnly&&mstrmojo.all.mstrCGE.model.items.length>0;}}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){mstrmojo.all.mstrCGE.close();}}]}]}],onOpen:function(){if(this.readOnly){mstrmojo.all.mstrCGE.set("title",mstrmojo.desc(8031,"Custom Group Editor (Read Only)"));mstrmojo.alert(mstrmojo.desc(8022));}},onClose:function(){this.readOnly=false;if(this.needRefreshPage){var Z=mstrApp;mstrmojo.form.send({evt:5005,src:Z.name+"."+Z.pageName+".5005"});this.needRefreshPage=false;}},getXML:function Q(){var a=this.model;var g='<exp> <nd et="14" n="OR" fn="20" ce="'+(a.cgp.ce?-1:0)+'" isp="'+(a.cgp.isp?-1:0)+'" ><nds>',b="</nds></nd></exp>",f={a:true,a2:true,a3:true,agg:true,cc:true,ce:true,cgp:true,cs:true,desc:true,did:true,dmt:true,dmy:true,dtp:true,es:true,et:true,expr:true,f:true,flat:true,flt:true,fm:true,fm2:true,fm3:true,fn:true,fnt:true,fres:true,gb:true,isp:true,items:true,m:true,m2:true,m3:true,n:true,nds:true,not:true,pf:true,p:true,r:true,rps:true,st:true,t:true,utgt:true,utp:true,uts:true,v:true,xml:true},Z={getArrItemName:function(o,l,m){return o.substr(0,o.length-1);},isSerializable:function(u,r,q){if(u=="xml"){var m=r[q].xml;return{att:'hasXML = "-1"',child:m};}else{if(mstrmojo.array.indexOf(["header_format","grid_format","child_header_format","child_grid_format"],u)>-1){var v=r[q][u];if(!v){return{};}var o="<"+u+">";for(var t in v){o+="<prs n='"+t+"'>";var n=v[t];for(var l in n){var p=n[l];o+="<pr n='"+l+"' v='"+(p=="pru"?"":p)+"'";o+=p=="pru"?' pru="1"':"";o+="/>";}o+="</prs>";}o+="</"+u+">";return{child:o};}}return(f[u])?true:false;},skipNull:true},e=a.items,k=[];for(var c=0,d=e.length;c<d;c++){var j=e[c],h=j.expr;h.n=j.n;if(h.fnt&&h.fnt==V.FNT.PER&&h.cs&&h.cs[0]){h.cs[0].v+="%";}k[c]=L.json2xml("nd",[{ce:j.ce||false,isp:j.isp||false,header_format:j.header_format,grid_format:j.grid_format,child_header_format:j.child_header_format,child_grid_format:j.child_grid_format},j.expr],Z);}return g+k.join("")+b;},inlineTextRef:{scriptClass:"mstrmojo.Popup",locksHover:true,slot:"containerNode",children:[{scriptClass:"mstrmojo.TextBox",alias:"txt",onTab:function(a){if(this.onEnter){this.onEnter();}var Z=W.shiftKey(a.hWin,a.e)?this.prevTab:this.nextTab;if(Z&&Z.onclick){Z.onclick();}},onblur:function(){if(this.onEnter){this.onEnter();}},onEsc:function(){if(this.onCancel){this.onCancel();}this.parent.close({cancel:true});}}],onOpen:function(){var a=this.txt,b=this.txtConfig;if(b){for(var Z in b){a.set(Z,b[Z]);}}a.focus();},onClose:function(Z){if(!Z||(!Z.cancel&&!Z.enter)){this.txt.onEnter();}}},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",cssText:"width: auto;",contentNodeCssClass:"mstrmojo-balloon",left:"250px",top:"15px",slot:"containerNode",autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var Z=this.condition,c=Z&&Z.data&&Z.data.not,d=Z&&Z.parent,a=d&&d.data,b=(a&&a.fn)+(c?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(b)?null:{did:b});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",items:[{did:19,n:K[19]},{did:20,n:K[20]},{did:19+21,n:K["19_21"]},{did:20+21,n:K["20_21"]}],onchange:function(){if(this.opening){return ;}var a=this.parent,Z=a.condition,g=this.selectedItem,f=g&&g.did,e=f>21?true:null,c=f-(e?21:0);a.close();var b=Z&&Z.parent;if(b&&b.data&&b.data.et===V.ET.ANDOR){b.edit(Z,c,e);}else{var h=Z&&Z.data;if(h&&(h.not!==e)){h.not=e;Z.paint();}}}}]},conditionPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-Editor-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",title:mstrmojo.desc(7953,"Condition Editor"),help:"condition_editor.htm",slot:"containerNode",onOpen:function(){this.walk.set("targets",this.targets);this.walk.set("targetsLastMod",this.targetsLastMod);this.walk.set("model",this.model);var Z=[T.ATTR,T.METRIC,B.REPORT_GRID,B.REPORT_GRAPH,B.REPORT_ENGINE,B.REPORT_TEXT,B.REPORT_DATAMART,B.REPORT_BASE,B.REPORT_GRIDGRAPH,B.REPORT_NONINTERACTIVE,B.FILTER,B.PROMPT,B.PROMPT_ELEMENTS,B.PROMPT_EXPRESSION,B.PROMPT_EXPRESSION_DRAFT];this.walk.set("browsableTypes",Z);},onClose:function(){var Z=this.condition;if(Z.isEmpty()){Z.del();}},children:[{scriptClass:"mstrmojo.ConditionWalk",alias:"walk",cssText:"height:"+H+"px",targets:null,ets:null,onOK:function(){var Z=this.parent,a=Z.condition;R.copy(this.model.get(),R.clear(a.data));a.paint();Z.close();}}]},isValid:function(c){var b=mstrmojo.all.mstrCGE.model.items,Z=b.length,a,d="";if(Z>0){for(a=0;a<Z;a++){if(!b[a].expr){d+=b[a].n+",";}}if(d){d=d.replace(/,$/,"");mstrmojo.alert(mstrmojo.desc(7947).replace("#",d));return false;}}else{mstrmojo.alert("Custom Group does not have any element defined. Please fix it before saving.");return false;}return true;}};})();(function(){mstrmojo.requiresCls("mstrmojo.ui.editors.controls.ControlGroup","mstrmojo.ui.editors.controls._HasCharacterGroup","mstrmojo.ui.editors.controls.TwoColumnContainer","mstrmojo.css");mstrmojo.ui.editors.controls.CharacterGroup=mstrmojo.declare(mstrmojo.ui.editors.controls.ControlGroup,[mstrmojo.ui.editors.controls._HasCharacterGroup],{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",init:function A(E){this._super(E);mstrmojo.css.addWidgetCssClass(this,"mstrmojo-ui-EditCharacter");var H=this,C=this.getHCGControls(function(K,L,J){if(!H._sync){H.raiseFormatValueChange(K,L,J);}}),D=[];Object.keys(C).forEach(function(J){this[J]=C[J];}.bind(this));var B=this.fontFamily,I=this.fontStyle,G=this.fontSize,F=this.fontColor;if(B){D.push(B);}if(I){D.push(I);}if(G){G.slot="col1Node";F.slot="col2Node";D.push({scriptClass:"mstrmojo.ui.editors.controls.TwoColumnContainer",children:[G,F]});}if(D.length){this.addChildren(D);}}});mstrmojo.ui.editors.controls.CharacterGroup.CTRL_FLAGS=mstrmojo.ui.editors.controls._HasCharacterGroup.CTRL_FLAGS;}());(function(){mstrmojo.requiresClsP("mstrmojo","Widget","num","css","Container","Box","Label","EditableLabel","Image");mstrmojo.requiresClsP("mstrmojo.threshold","ColorBand","ImageBand","MarkersNode","ColorMarker","ThresholdModel");var E=mstrmojo.dom,c=mstrmojo.num,g=mstrmojo.css,C=["bands","markers"];var Z=0,D=1;var d=mstrmojo.threshold.ThresholdModel.SLIDER_MODE;function F(h){var j;if(h===C[Z]){j=this.sliderMode===d.IMAGE_BASED?new mstrmojo.threshold.ImageBand():new mstrmojo.threshold.ColorBand();}else{j=new mstrmojo.threshold.ColorMarker();}this[h].addChildren([j]);}function J(v){var u=this[C[v]],k=u.children,l=k?k.length:0,t=this.getComp(),m=this.getPalette(),p=this.width,q=v?t.length-1:t.length,w=this.sliderMode===d.IMAGE_BASED,r,j,h;if(l>q){for(r=l-q-1;r>=0;r--){u.removeChildren(k[r]);}}else{if(q>l){for(r=0;r<q-l;r++){F.call(this,C[v]);}}}if(v===0&&this.getReversedValue()){m=m.concat().reverse();}k=u.children;var o,n;for(r=0;r<q;r++){j=k[r];o=parseInt(r===0?0:p*t[r-1],10);n=parseInt(p*t[r],10);if(v===0){j.set("left",(this.containerNode.offsetLeft+o+1)+"px");h=n-o;g.toggleClass(j.domNode,"no-border",!h);j.set("width",h+"px");if(w){j.set("src",m[r]);j.domNode.firstChild.style.left=j.domNode.clientWidth/2-12+"px";}else{j.set("backgroundColor",m[r]);}}else{j.set("left",n-(w?0:1)+"px");}j.set("index",r);}}function A(j,h,k){h.forEach(function(n){var l=j[n.id]={palette:[],comp:[],reversed:false};n.bands.forEach(function(m){l.palette.push(m[k?"url":"bc"]);l.comp.push(m.end/100);});});}function H(){var h=this.parent.model,j={};A(j,h.getDefaultColors(),false);A(j,h.getDefaultImages(),true);return j;}mstrmojo.threshold.TextBubble=mstrmojo.declare(mstrmojo.EditableLabel,null,{scriptClass:"mstrmojo.EditableLabel",visible:false,cssClass:"editable-bubble",text:"",isPercentage:true,maxValue:1,showBubble:function(h){this.updatePosition(h);this.updateText(h);this.set("visible",true);},hideBubble:function(){this.set("visible",false);},updatePosition:function B(h){this.domNode.style.left=this.parent.width*h+"px";},updateText:function(l){var k=this.parent,h=k.parent.model,j=h.getRealValue(l,k.selectedOption);if(k.selectedOption===7){j=c.formatByMask(h.getFormatString(),j);}if(this.isPercentage){j+="%";}this.set("text",String(j));}});mstrmojo.threshold.ColorSlider=mstrmojo.declare(mstrmojo.Container,null,{scriptClass:"mstrmojo.threshold.ColorSlider",markupString:'<div class = "mstrmojo-color-slider {@cssClass}"  style="{@cssText}" mstrAttach:click,keyup><div class="labels"></div><input type="text" class="hidden-field"></div>',markupSlots:{containerNode:function a(){return this.domNode;},labelsNode:function f(){return this.domNode.firstChild;},hiddenField:function I(){return this.domNode.lastChild;}},sliderMode:d.COLOR_BASED,baseColor:undefined,editableBubble:undefined,hoverBubble:undefined,bands:undefined,markers:undefined,colorMap:undefined,selectedOption:undefined,getComp:function Q(){return this.colorMap[this.baseColor].comp;},getPalette:function S(){return this.colorMap[this.baseColor].palette;},getReversedValue:function b(){var h=this.colorMap;return h&&h[this.baseColor].reversed||false;},postBuildRendering:function e(){this.width=E.position(this.containerNode).w;this.resetColorMap();if(this._super){this._super();}this.update();},resetColorMap:function R(){this.colorMap=H.call(this);},onkeyup:function(l){var j=window.event||l.e,m=j.keyCode;if(this.sliderMode===d.COLOR_BASED&&(m===mstrmojo.Enum_Keys.DELETE||m===mstrmojo.Enum_Keys.BACKSPACE)){if(this.editableBubble.isEditing){return ;}var k,h;if(this.bands.isSelected){k=this.bands;}else{if(this.markers.isSelected){k=this.markers;}else{return ;}}h=k.selectedIndex;k.children[h].unselect();k.remove(h);this.update();}},update:function M(){if(this.baseColor){J.call(this,Z);J.call(this,D);}},onsliderModeChange:function U(){g.toggleClass(this.domNode,"image-mode",this.sliderMode===d.IMAGE_BASED);this.unselectAll();this.bands.removeChildren();},onbaseColorChange:function P(){this.unselectAll();this.update();},onselectedOptionChange:function O(h){var j=this.parent.model,k=this.editableBubble,l=k.text;this.updateLabels(h.value);if(k.visible){if(h.valueWas===1||h.valueWas===2){l=l.slice(0,l.length-1);}k.updateText(j.getNormalizedValue(l,h.valueWas));}},updateLabels:function Y(j){var m=this.parent.model,n=this.editableBubble,l=this.hoverBubble,o,k;j=j||this.selectedOption;if(j===1||j===2){o="0%";k="100%";n.set("isPercentage",true);l.set("isPercentage",true);}else{if(j===4||j===5){o="0";k=m.getMetricsCount();n.set("isPercentage",false);l.set("isPercentage",false);}else{var h=m.getFormatString();o=c.formatByMask(h,m.getMetricsMinValue());k=c.formatByMask(h,m.getMetricsMaxValue());n.set("isPercentage",false);l.set("isPercentage",false);}}this.startLabel.set("text",o);this.endLabel.set("text",k);},setColorComp:function L(j,h){var k=this.colorMap;if(k){k[j].comp=h;this.unselectAll();this.update();}},addCustomScheme:function(j,h){this.colorMap.custom={comp:j,palette:h,reversed:false};this.set("baseColor","custom");},addMarkerToMap:function W(j){var k=this.getComp(),h=k.length,l;if(k[0]>j){l=0;}else{for(l=1;l<h;l++){if(k[l-1]<=j&&k[l]>=j){break;}}}k.splice(l,0,j);this.unselectAll();return l;},unselectAll:function X(){var j=this.bands;if(j.isSelected){j.children[j.selectedIndex].unselect();}var k=this.markers,h=k.selectedIndex;if(k.isSelected&&k.children[h]){k.children[h].unselect();}},reverseMapColor:function T(){if(this.colorMap&&this.baseColor){var h=this.colorMap[this.baseColor];h.reversed=!h.reversed;this.unselectAll();this.update();}},children:[{scriptClass:"mstrmojo.Label",cssClass:"start-label",alias:"startLabel",slot:"labelsNode",text:"0%"},{scriptClass:"mstrmojo.Label",cssClass:"end-label",alias:"endLabel",slot:"labelsNode",text:"100%"},{scriptClass:"mstrmojo.threshold.TextBubble",alias:"editableBubble",slot:"labelsNode",allowEmptyText:true,onTextEditComplete:function(l,r){if(l){var q=this.text;if(this.isPercentage){q=q.replace(/%$/,"");}var n=r.charAt(0);if(n.match(/\W/)!==null){q=q.replace(new RegExp("^\\"+n),"");}q=c.parseNumeric(q);if(isNaN(q)){this.set("text",r);return ;}var h=this.parent,m=h.parent.model,p=m.getNormalizedValue(q,h.selectedOption),o=h.getComp();this.updatePosition(p);var j=h.markers.selectedIndex;o.splice(j,1);var k=h.addMarkerToMap(p);h.markers.children[k].select();h.update();}}},{scriptClass:"mstrmojo.threshold.TextBubble",alias:"hoverBubble",slot:"labelsNode",allowEmptyText:false},{scriptClass:"mstrmojo.Box",cssClass:"color-bands",alias:"bands",isSelected:false,selectedIndex:0,remove:function G(k){if(this.children.length===1){return ;}var l=this.parent;var j=l.getComp(),h=l.getPalette();if(k===this.children.length-1){j.splice(k-1,1);}else{j.splice(k,1);}h.splice(k,1);},onBandHovered:function(h){this.isSelected=true;},onBandUnhovered:function(h){this.isSelected=false;},onBandSelected:function(h){var j,l=this.children,k=this.parent,m=k.markers;for(j=0;j<l.length;j++){if(j!==h&&l[j].selected){l[j].unselect();}}if(m.isSelected===true){m.children[m.selectedIndex].unselect();}k.hiddenField.focus();this.isSelected=true;this.selectedIndex=h;},onBandUnselected:function(h){var j,k=this.children;for(j=0;j<k.length;j++){if(j!==h&&k[j].selected){return ;}}this.isSelected=false;}},{scriptClass:"mstrmojo.threshold.MarkersNode",alias:"markers",isSelected:false,selectedIndex:0,onMarkerSelected:function V(j){var h=this.parent;h.editableBubble.showBubble(h.getComp()[j]);var k,n=this.children;for(k=0;k<n.length;k++){if(k!==j&&n[k].selected){n[k].unselect();}}var l=h.bands;if(l.isSelected===true){l.children[l.selectedIndex].unselect();}this.parent.hiddenField.focus();this.isSelected=true;this.selectedIndex=j;},onMarkerUnselected:function(h){var j,k=this.children;for(j=0;j<k.length;j++){if(j!==h&&k[j].selected){return ;}}this.parent.editableBubble.hideBubble();this.isSelected=false;},onMarkerHovered:function K(j){var h=this.parent;h.hoverBubble.showBubble(h.getComp()[j]);this.isSelected=true;},onMarkerUnhovered:function N(h){this.parent.hoverBubble.hideBubble();this.isSelected=false;}}]});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.ObjectInputBox");var B=mstrmojo.expr;mstrmojo.ME.TransformInputBox=mstrmojo.declare(mstrmojo.ME.ObjectInputBox,null,{cssClass:"mstrmojo-ME-ObjectInputBox-transform",items:[],noEditButton:true,folderLinksContextId:26,browsableTypes:[B.TP.FOLDER,B.TP.ROLE].join(","),getCandidatesThroughTaskCall:function A(E,D){mstrmojo.ME.MetricDataService.getTransformations(E,D);},hideItemWidgetBrowseButton:function C(){return this.isDME;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.ObjectInputBox");var B=mstrmojo.expr;mstrmojo.ME.ConditionInputBox=mstrmojo.declare(mstrmojo.ME.ObjectInputBox,null,{cssClass:"mstrmojo-ME-ObjectInputBox-condition",folderLinksContextId:10,browsableTypes:[B.TP.FOLDER,B.TP.FILTER,B.STP.PROMPT_OBJECTS].join(","),noEditButton:true,maxObjectCount:1,getCandidatesThroughTaskCall:function A(D,C){D.rootFolderType=39;D.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getFilters(D,C);},hideItemWidgetBrowseButton:function(){return this.isDME;}});})();(function(){mstrmojo.requiresCls("mstrmojo.Label","mstrmojo.Pulldown","mstrmojo.ME.ObjectInputBox","mstrmojo.ME.MetricDataService","mstrmojo.ME.Enum");mstrmojo.requiresDescs(1107,12178);var J=mstrmojo.expr,D=mstrmojo.ME.Enum.DYNAMIC_DIMTY;mstrmojo.ME.LevelInputBox=mstrmojo.declare(mstrmojo.ME.ObjectInputBox,null,{cssClass:"mstrmojo-ME-ObjectInputBox-level",oncandidatesChange:function F(E){this.candidates.items=D.getItems("level").concat(this.candidates.items);},hidePulldownButton:function(){return !this.isDME;},hideItemWidgetBrowseButton:function(){return this.isDME;},folderLinksContextId:16,browsableTypes:[J.TP.FOLDER,J.TP.ATTR,J.TP.DIM].join(","),getCandidatesThroughTaskCall:function K(L,E){L.rootFolderType=39;L.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getAttributes(L,E);},itemFunction:function B(M,E,L){M.filtering=M.filtering||1;M.grouping=M.grouping||1;var N=this._super(M,E,L,mstrmojo.ME.LevelObjectItem);N.optionButtonVisible=true;return N;},updateSuggestion:function C(E){E=[{n:this.isDME?mstrmojo.desc(12178,"Visualization level"):mstrmojo.desc(1107,"Report Level"),did:-1,t:-1,state:0}].concat(E);if(this._super){this._super(E);}},add:function H(L,E){var N=true,M=this.items;mstrmojo.array.forEach(L,function(O){mstrmojo.array.forEach(M,function(P){if(P.did&&P.did===O.did){N=false;return false;}});});if(N){this._super(L,E);}}});mstrmojo.ME.LevelObjectItem=mstrmojo.declare(mstrmojo.ME.ObjectItem,[mstrmojo._HasPopup],{optsRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(9598,"Level Options"),cssText:"width: 450px;",onOpen:function A(){var E=this.opener.data;this.filterOption.set("value",E.filtering);this.groupOption.set("value",E.grouping);},children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9599,"Relationship with Report Filter:")},{scriptClass:"mstrmojo.Pulldown",alias:"filterOption",itemField:"n",itemIdField:"did",items:[{n:mstrmojo.desc(9600,"Standard - Metric calculates only for elements found in the filter"),did:1},{n:mstrmojo.desc(9601,"Absolute - Raises the calculation to the selected level, if possible"),did:2},{n:mstrmojo.desc(9602,"Ignore - Omit filtering criteria based on selected level and its related attributes"),did:3},{n:mstrmojo.desc(9603,"None - Unspecified - the selected level and group components define the filter"),did:4}]},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(9604,"Metric Aggregations:")},{scriptClass:"mstrmojo.Pulldown",alias:"groupOption",itemField:"n",itemIdField:"did",items:[{n:mstrmojo.desc(9605,"Standard - Metric calculates at the selected level, if possible"),did:1},{n:mstrmojo.desc(9606,"None - Exclude the selected level and children from the GROUP BY clause in the SQL"),did:2},{n:mstrmojo.desc(9607,"Beginning lookup - Use the first value of the lookup table"),did:3},{n:mstrmojo.desc(9608,"Ending lookup - Use the last value of the lookup table"),did:4},{n:mstrmojo.desc(9609,"Beginning fact - Use the first value of the fact table"),did:5},{n:mstrmojo.desc(9610,"Ending fact - Use the last value of the fact table"),did:6}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent,L=E.opener;if(L.saveOnClose){L.saveOnClose(E.filterOption.value,E.groupOption.value);}E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},saveOnClose:function G(E,M){var L=this.data;L.filtering=E;L.grouping=M;if(this.parent.onSaveOnClose){this.parent.onSaveOnClose();}},options:function I(){this.openPopup("optsRef",{title:'"'+this.data[this.itemField]+'" '+mstrmojo.desc(9598,"Level Options"),zIndex:40});}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.TextBoxDocSelector","mstrmojo.array","mstrmojo.string","mstrmojo.elementHelper");var J=mstrmojo.array,O=mstrmojo.string,I=mstrmojo.elementHelper,H=I.ELEM_ALL_ID;var E=0,L=1,K=2;var D=1,N=3;mstrmojo.SearchBoxDocSelector=mstrmojo.declare(mstrmojo.TextBoxDocSelector,null,{scriptClass:"mstrmojo.SearchBoxDocSelector",filterElemALL:false,_buildEvent:function F(T,S){var Q=[],U,R=this.defn;J.forEach(S.items,function(V){Q.push(V.v+";"+O.decodeHtmlString(V.n));});U=Q.length;if(!U){Q.push(H);}if(Q.length>0||!R.nsb||R.nsb===E){T.eid=Q.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}else{if(R.nsb===L||!R.showall){T.unset=true;}else{if(R.nsb===K){T.eid=H;}}}if(R.sec){if(R.multi){this.parent.set("count",I.buildElemsCountStrByNum(U,0));}else{this.parent.set("count",I.buildElemsCountStrByNum(0,0));}}},updateWidget:function P(Y){var R=this._super(Y),S=Y.node,X=S.defn,V=S.data,Q=V.elms;if(Q&&!X.sos){R.candidates=this.setupCandidates(X,Q);}if(X.srcid){var T=[],W,U=J.filter(V.ces,function(a){return a.v!=="u;";});if(U&&U.constructor===Array){if(X.dfm==D){for(W=0;W<U.length;W++){if(U[W]["t"]!=N){T.push(U[W]);}}}else{T=U.concat();}}if(!X.sos){var Z=[];J.forEach(T,function(a){if(J.find(R.candidates.items,"v",a.v)>-1){Z.push(a);}});T=Z;}R.items=T;}return R;},getCekEvtListener:function C(R,Q){return function(S){R.handleActionInSyncPhase(function(){Q.set("items",S.value);});};},getWidgetConfig:function G(W,T,S,V){var R=W.getFormats(),U=W.node.data,Q=this._super(W,T,S,V);Q={scriptClass:Q.scriptClass,cssText:R.height?"height: "+R.height:"",emptyText:mstrmojo.desc(4325,"Search")+" "+(S.ttl||""),items:S.srcid?(U.ces?U.ces.concat():[]):[],REQUEST_THRESHOLD:(mstrApp&&mstrApp.SEARCH_REQUEST_THRESHOLD)||55,suggestCount:(mstrApp&&mstrApp.SEARCH_SUGGESTION_LENGTH)||50,srcid:S.srcid||"",dsrc:S.dsrc||"",onitemsChange:function(){if(!W._inSyncPhase){W.showInfoWin();W.selectorControlChange(this);}}};if(V&&!S.sos){Q.candidates=this.setupCandidates(S,V);}else{Q.useKeyDelay=true;Q.noCache=true;}if(!S.multi){Q.maxObjectCount=1;}return Q;},isSelectAll:function A(){var Q=this.children&&this.children[0];return Q===undefined?true:(!Q.items||Q.items.length==0);},setupCandidates:function M(R,S){var Q=R.srcid?S:[];if(this.filterElemALL){Q=J.filter(Q,function(T){return T.v!=="u;";});}return{isComplete:true,items:Q};},isValidSelection:function B(){var R=this.node.data,Q=this.model;if(Q.isSelWarnFlagOn(this.k)&&R.ces&&R.ces.length===0){return R.elms.length!==0;}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.MetricQualDocSelector");mstrmojo.MetricSliderDocSelector=mstrmojo.declare(mstrmojo.MetricQualDocSelector,null,{scriptClass:"mstrmojo.MetricSliderDocSelector",_ieformatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P"],filterNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},formatHandlers:{domNode:["F","text-align","vertical-align","line-height","z-index","top","left"],contentNode:["height","width","B","P","fx","background-color"],item:["color","font","text-decoration","text-align","line-height"]},newAndInitWidget:function A(D){var E=this._super(D);D.attachEventListener("includeChange",E.id,function(F){this.set("include",F.value);});return E;},getWidgetConfig:function C(H,F,E,G){var D=this._super(H,F,E,G);H.extCls="extSlider";D.isHoriz=true;D.include=E.include;return D;},isSelectAll:function B(){var D=this.children&&this.children[0];return D===undefined?true:D.unSet;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocLayout","mstrmojo.DocLayoutHoriz","mstrmojo.DocSectionHoriz","mstrmojo.DocSection","mstrmojo.DocSubsection","mstrmojo.DocPanelStack","mstrmojo.DocPanel","mstrmojo.DocTextfield","mstrmojo._CanSupportTransaction","mstrmojo._IsEditableTextfield","mstrmojo._HasDocLink","mstrmojo.DocImage","mstrmojo.DocLine","mstrmojo.DocRectangle","mstrmojo.DocRoundRectangle","mstrmojo.EnumRWUnitType","mstrmojo.DynamicClassFactory","mstrmojo.Button","mstrmojo.ToolBar","mstrmojo.DocSelector","mstrmojo.FilterPanelMenu","mstrmojo.DocPortlet","mstrmojo.DocResizablePortlet","mstrmojo.DocXtabGraph","mstrmojo.DocGridGraph","mstrmojo.DocVisualization","mstrmojo.DocXtabModel","mstrmojo.hash","mstrmojo.dom");var H=mstrmojo.hash,E=mstrmojo.dom,A=mstrmojo.EnumRWUnitType,N=mstrmojo.DynamicClassFactory.newComponent,R=mstrmojo.elementHelper,S=mstrmojo.Button.newIconButton,L={};function K(W){return function(){return this.parent.parent["on"+W]();};}var M=K("maximize"),T=K("restore"),G=K("minimize");function V(X,a,Y,W,Z){return S(X,a,Y,null,{ds:W,visible:(Z!==W)});}function I(W,a,Z){var Y=this.classMap[a].n+(Z?"Hover":""),X=L[Y];if(!X){X=L[Y]=N(W,[mstrmojo._HasDocLink].concat(this.getLinkDrillMixins(Z)));}return X;}function Q(d,Z,Y){var a=H.walk(Y.scriptClass,window),b=Z&&Z.defn,X=Z&&Z.data,g=(b&&b.t),f=(g===A.TEXTFIELD&&((b&&b.dpst)));if(g===A.TEXTFIELD||g===A.IMAGE){var e=X.dl,c=b.dl,W=(e&&e.items&&e.items.length)||(c&&c.items&&c.items.length>0);if(W||X.url||b.url||b.ifw){a=I.call(this,a,g+(f?"B":""),W);}else{if((g===A.TEXTFIELD)&&b.txi){a=N(a,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableTextfield]);}else{if(g===A.TEXTFIELD&&Z.defn.iifs){a=mstrmojo.DocSummaryTextfield;}}}}return this.newRWUnitInstance(d,Z,a);}mstrmojo.rw._IsReportServicesDocBuilder=mstrmojo.provide("mstrmojo.rw._IsReportServicesDocBuilder",{_mixinName:"mstrmojo.rw._IsReportServicesDocBuilder",createClassMap:function B(){var W=this._super();W[A.LAYOUT]={n:"Layout"};W[A.SUBSECTION]={scriptClass:"mstrmojo.DocSubsection"};W[A.PANELSTACK]={n:"PanelStack",scriptClass:"mstrmojo.DocPanelStack"};W[A.PANEL]={n:"Panel",scriptClass:"mstrmojo.DocPanel"};W[A.TEXTFIELD]={n:"Textfield",scriptClass:"mstrmojo.DocTextfield"};W[A.IMAGE]={n:"Image",scriptClass:"mstrmojo.DocImage"};W[A.LINE]={n:"Line",scriptClass:"mstrmojo.DocLine"};W[A.RECTANGLE]={n:"Rectangle",scriptClass:"mstrmojo.DocRectangle"};W[A.ROUNDEDRECTANGLE]={n:"RoundedRectangle"};W[A.GRAPH]={n:"XtabGraph",scriptClass:"mstrmojo.DocXtabGraph"};W[A.GRIDGRAPH]={n:"GridGraph",scriptClass:"mstrmojo.DocGridGraph"};W[A.VISUALIZATION]={n:"Visualization",scriptClass:"mstrmojo.DocVisualization"};return W;},getLayoutViewerClass:function D(W){this.throwAbstractMethodError("getLayoutViewerClass");},newLayout:function U(b,Z){var Y=[],X=Z.data,a=Z.defn,W=this.getLayoutViewerClass(Z),e=new W({n:a.title,model:b,node:Z,controller:this.parent.controller,tbc:a.tbc,slot:"containerNode",visible:false,ifs:X.ifs,gb:X.gbys});var c=e.defn=H.copy(a);c.fmts=H.copy(a.fmts);function f(l,m){var g=l.length;if(g){for(var j=0;j<g;j++){var k=this.build([l[j]],b)[0];k.slot=m;Y.push(k);}}}f.call(this,b.getFixedHeaders(Z),"fixedHeaderNode");var d=a.horiz?mstrmojo.DocLayoutHoriz:mstrmojo.DocLayout;Y.push(new d({slot:"layout",id:Z.id,k:Z.k,minHeight:X.mh,formatResolver:b.formatResolver,rules:a.rules,builder:this,node:Z,defn:a,model:b}));f.call(this,b.getFixedFooters(Z),"fixedFooterNode");e.addChildren(Y);return e;},newSection:function O(W,X){return this.newRWUnitInstance(W,X,(X.defn.horiz&&X.data.subsections.length>1)?mstrmojo.DocSectionHoriz:mstrmojo.DocSection);},newPanelStack:function F(X,Y,W){return this.newRWUnitInstance(X,Y,W.cls||H.walk(W.scriptClass,window));},newTextfield:Q,newImage:Q,newButton:Q,newRoundedRectangle:function J(W,X){return this.newRWUnitInstance(W,X,E.supports(E.cssFeatures.ROUND_CORNERS)?mstrmojo.DocRectangle:mstrmojo.DocRoundRectangle);},getPortletExportGridToolbar:mstrmojo.emptyFn,createPortlet:function C(AF,o,AC){var AK=o.defn,a=AK.ds,AB=(AK.iifp||!(AF===A.PANELSTACK||(AK.ttl===undefined&&AK.qsm)||AF===A.SELECTOR)),d=(AF===A.GRAPH||AF===A.GRIDGRAPH),k=[],AG="",q="",m="",X=(AF===A.GRID||d||AF===A.VISUALIZATION||AF===A.MOJOVISUALIZATION)&&parseInt(AK.eo,10)!==2,W=[],AD="mstrmojo-oivmSprite ",u=false;if(AK.qsm){AG="qks";var b=function(AN,t,w){return S(AN,AD+t,function(){return this.parent.parent.content.quickSwitch();},{visible:"this.parent.parent.defn.qsm !== this.qsm"},{qsm:w});};k.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",cssClass:(!AB)?"grouped":"",children:[b(mstrmojo.desc(3547,"View: Grid"),"tbGrid",1),b(mstrmojo.desc(3548,"View: Graph"),"tbGraph",2)]});}if(X){var Z=this.getPortletExportGridToolbar(AC);if(Z){q=Z.css;W=Z.node;k.push(W);}}if(AB){if(AK.iifp){AG="wrap";k.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:[V(mstrmojo.desc(8973,"Collapse"),"co",null,1,a),V(mstrmojo.desc(8972,"Expand"),"ex",null,0,a)]});}else{var x=[V(mstrmojo.desc(4539,"Minimize"),"mn",G,1,a),V(mstrmojo.desc(4540,"Restore"),"rs",T,0,a),V(mstrmojo.desc(4541,"Maximize"),"mx",M,2,a)];if(X){W.children=(W.children||[]).concat(x);}else{q="resize";k.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:x});}}}AC.slot="contentNode";AC.alias="content";AC.title=AK.ttl||"";if(AK.sec){var AH=o.data.elms,j=o.data.ces,r=o.data.unset,AJ=(j&&j.length)||0,AL=(AH&&AH.length)||0,AI;if(AK.sos){AC.contentClass="fpsb";for(AI=AJ-1;AI>=0;AI--){if(j[AI]._did_){AJ--;}}AC.count=R.buildElemsCountStrByNum(AJ,AL);}if(j&&AH&&AH.length&&AK.style!==mstrmojo.DocSelector.STYLES.SCROLLER){if(mstrApp.isVI||!r){if(AK.multi){if(r&&j.length===0){AC.count=R.buildElemsCountStr(AH,AH);}else{AC.count=R.buildElemsCountStr(j,0);}}else{AC.count=R.buildElemsCountStr(AH,AH);}}}}k.push(AC);if(AF===A.PANELSTACK){var f=function(AO,w,AN,t){return S(AO,AD+w,function(){return this.parent.parent.content.switchToPanel(t);},{enabled:"this.parent.parent."+AN});},h=[],Y=[],n=!!o.sw,g=!!AK.ifw,c=!!AK.ifp;if(n){Y.push(f(mstrmojo.desc(1058,"Previous"),"tbPrev","prevEnabled",-1));h.push(f(mstrmojo.desc(2917,"Next"),"tbNext","nextEnabled",1));}if(g){h.push(S(mstrmojo.desc(2102,"Close"),AD+"mstrmojo-DocInfoWindow-close",function(){this.parent.parent.parent.close();}));}if(c){m="ifp";var z=mstrmojo.desc(2164,"Apply");k.push({scriptClass:"mstrmojo.HBox",slot:"buttonbarNode",alias:"buttonbar",cssClass:"buttonBox",children:[{scriptClass:"mstrmojo.Button",alias:"resetBtn",title:mstrmojo.desc(2827,"Clear"),text:mstrmojo.desc(2827,"Clear"),cssClass:"mstrmojo-FilterPanel-Btn apply",bindings:{visible:function(){return !AK.cas;},enabled:function(){return this.parent.parent.clearEnabled;}},onclick:function AA(){if(AC&&AC.clearBuffSlices){AC.clearBuffSlices();AC.clearAllFilter();AC.applyBufferedSlices();}}},{scriptClass:"mstrmojo.Button",alias:"applyNow",title:z,text:z,cssClass:"mstrmojo-FilterPanel-Btn apply",bindings:{visible:function(){return !AK.cas;},enabled:function(){return this.parent.parent.applyEnabled;}},onclick:function AA(){if(AC&&AC.applyBufferedSlices){AC.applyBufferedSlices();}}}]});h.push({scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AA(){this.openPopupMenu();},openPopupMenu:function(){var t=mstrmojo.findAncestor(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.FilterPanelMenu",{openerButton:this,fps:AC,cmPos:this.cmPos,lockIW:AC});}}});u=true;}if(g||c){var AM=[];if(n){AM[0]="pst-l";}if(c){AM.push("ifp");}Y.push({scriptClass:"mstrmojo.Box",cssClass:AM.join(" ")});}if(g||n||c){var p=g?"ifw ":"",AE=c?"ifp ":"",e=!AK.cas?"cas ":"";q=(n?"pst-r ":"")+p+AE+e;AG=(n?"pst-l ":"")+p+AE+e;k.push({scriptClass:"mstrmojo.ToolBar",slot:"leftToolbarNode",alias:"leftToolbar",children:Y});k.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:h});}}if(AF===A.SELECTOR&&AC.spm){q="spm";k.push({scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-oivmSprite tbDown",alias:"btnMenu",onclick:function AA(t){t.cancel();this.openPopupMenu();},openPopupMenu:function(){var t=mstrmojo.findAncestor(this,"openPopupMenu");if(t){t.openPopupMenu("mstrmojo.SelectorMenu",{openerButton:this,selector:AC,cmPos:this.cmPos});}}}]});u=true;}var v=AB?mstrmojo.DocResizablePortlet:mstrmojo.DocPortlet,l={k:AC.k,defn:AC.defn,model:AC.model,children:k,title:AC.title,count:AC.count,floatingTitle:(AK.ttl===undefined&&AK.qsm),leftToolbarNodeClass:AG,loadDataOnResize:d,toolbarNodeClass:q,buttonbarNodeClass:m,attachContextMenuEvent:u};if(AF===A.PANELSTACK){l.bindings={title:"this.children[0].title"};if(o.sw){l.bindings.prevEnabled=function(){return this.children[0].hasPreviousPanel;};l.bindings.nextEnabled=function(){return this.children[0].hasNextPanel;};}if(AK.ifp){l.bindings.applyEnabled=function(){return this.children[0].applyEnabled;};l.bindings.clearEnabled=function(){return this.children[0].clearEnabled;};}}if(AK.iifp){l.onclicktitle=function(){if(AC.defn.ds===1){AC.parent.onexpand();}else{AC.parent.oncollapse();}};}return new v(l);},newXtabModel:function P(W){return new mstrmojo.DocXtabModel(W);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.Table","mstrmojo.CheckBox","mstrmojo.ME.LevelInputBox","mstrmojo.ME.ConditionInputBox","mstrmojo.ME.TransformInputBox","mstrmojo.ME.MetricDataService","mstrmojo.Button","mstrmojo.Editor","mstrmojo.ME._MetricEditorHelper","mstrmojo.mstr.EnumFunction");mstrmojo.requiresDescs(1107,1281,2148,2397,2399,3324,3377,4788,6223,9577,9579,9581,9582,9583,9584,11564,11565,12178,12179,12853);var Q=mstrmojo.expr,G=mstrmojo.array,B=mstrmojo.mstr.EnumFunction,R=mstrmojo.ME._MetricEditorHelper,A=mstrmojo.ME.MetricToken.brackets;var N,M;var C=function(){var E=this.isDME?mstrmojo.desc(12178,"Visualization level"):mstrmojo.desc(1107,"Report Level");return mstrmojo.hash.copy({n:E,did:-1,t:-1,state:0});};var X={level:-4,condition:-5,transformation:-6,simple:-7},O=function(E){return !(E===-4||E===-5||E===-6);},L=function(Y,E){return O(Y)||parseInt(Y,10)===X[E];},U=function(E){return E===-4||E===-5||E===-6||E===-7;};var W={n:"",did:"-1",desc:""},D={1:"+",2:"*",3:"%",4:""},F={1:"",2:"!",3:"<",4:">",5:"<|",6:">|"},H=function(a,Z){var c,E,b;switch(Z){case"level":c=[Q.TP.ATTR,Q.TP.DIM];E="onLevelAdded";b=16;break;case"transform":c=[Q.TP.ROLE];E="onTransformAdded";b=26;break;case"condition":c=[Q.TP.FILTER,Q.STP.PROMPT_OBJECTS];E="onConditionAdded";b=10;break;case"expression":c=[Q.TP.FACT,Q.TP.ATTR,Q.TP.FUNCTION,Q.TP.METRIC];E="onExpressionAdded";b=25;break;default:}c[c.length]=Q.TP.FOLDER;a.openPopup("ob",{zIndex:a.zIndex+10});var Y=a.ob.browser;Y.browse({folderLinksContextId:b,onSelectCB:[a,E],browsableTypes:c.join(","),includeObjectDesc:true});};mstrmojo.ME._HasLevel=mstrmojo.provide("mstrmojo.ME._HasLevel",{_mixinName:"mstrmojo.ME._HasLevel",isAggFunction:false,init:function V(E){if(this._super){this._super(E);}N=this.id;M=this;},onOpen:function K(){if(this._super){this._super();}if(!this.isAggFunction){return ;}M=this;var Y=this.getLCTDefFromTokens();this.updateToggleBarStatus(Y);var E=this.metricLCT.levelInput;E.set("candidates",this.getCandidates4LCT([Q.TP.ATTR,Q.STP.NDE]));E.set("items",Y.level);var Z=this.metricLCT.conditionInput;if(!this.noCache&&!Z.candidates&&!this.isDME){mstrmojo.ME.MetricDataService.getFilters({pattern:"*",blockBegin:1,blockCount:-1},{success:function(b){if(b){Z.set("candidates",{items:b.items,isComplete:(b.bc===-1||(b.bb+b.bc>b.sz))});}},failure:function(b){mstrmojo.alert(b.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}else{Z.candidates=this.getCandidates4LCT([Q.TP.FILTER,Q.STP.PROMPT_OBJECTS]);this.metricLCT.lblCondition.set("visible",Y.filter.length>0);}Z.set("items",Y.filter);var a=this.metricLCT.transformInput;if(!this.noCache&&!a.candidates&&!this.isDME){mstrmojo.ME.MetricDataService.getTransformations({pattern:"*",blockBegin:1,blockCount:-1},{success:function(b){if(b){a.set("candidates",{items:b.items,isComplete:(b.bc===-1||(b.bb+b.bc>b.sz))});}},failure:function(b){mstrmojo.alert(b.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}else{a.candidates=this.getCandidates4LCT(Q.TP.ROLE);this.metricLCT.lblTransform.set("visible",Y.tranformation.length>0);}a.set("items",Y.tranformation);},getLCTDefAsTokens:function P(){if(!this.isAggFunction){return[];}var h=this.metricLCT.levelInput.getSelectedObjects(),b=this.metricLCT.conditionInput.getSelectedObjects(),Z=this.metricLCT.transformInput.getSelectedObjects(),e=[],Y,a,c,E=function(k,j){return k.filtering===1?"("+j+")":j;};e.push({v:"{",isDelimiter:true});var f=null;for(a=0,c=h.length;a<c;a++){f=h[a];e.push({v:F[f.grouping],isDelimiter:true});if(R.isDimty(f.n)){e.push({v:E(f,f.n)});}else{if(/^@/.test(f.did)){e.push({v:E(f,f.did)});}else{if(f.did===-1){e.push({v:"~",isDelimiter:true});}else{e.push({v:A(f.n),oi:f});}}}e.push({v:D[f.filtering],isDelimiter:true});if(a<(c-1)){e.push({v:", ",isDelimiter:true});}}if(!this.levelFilterRest){e.push({v:";",isDelimiter:true});e.push({v:"-",isDelimiter:true});}if(!this.levelCanContinue){e.push({v:";",isDelimiter:true});e.push({v:"/",isDelimiter:true});}e.push({v:"}",isDelimiter:true});if(b.length>0){e.push({v:"<",isDelimiter:true});Y={v:A(b[0].n)};if(b[0].did){Y.oi=b[0];}e.push(Y);e.push({v:";",isDelimiter:true});e.push({v:"@",isDelimiter:true});e.push({v:this.conditionEmbedMethod});e.push({v:";",isDelimiter:true});e.push({v:this.conditionIgnoreFilterElem?"-":"+",isDelimiter:true});e.push({v:">",isDelimiter:true});}var g=G.indexOf(Z,W);c=g<0?Z.length:g;if(c>0){e.push({v:"|",isDelimiter:true});var d=null;for(a=0;a<c;a++){d=Z[a];Y={v:A(d.n)};if(d.did){Y.oi=d;}e.push(Y);if(a<(c-1)){e.push({v:", ",isDelimiter:true});}}e.push({v:"|",isDelimiter:true});}for(a=0,c=e.length;a<c;a++){e[a].isNew=true;}return e;},getLCTDefFromTokens:function S(){var Y=[],a=false,f=[],d=[],h=this.oi.tks.items,g=h.length,e;if(this.insertMode||g===0){Y.push(C.call(this));}else{for(e=0;e<g;e++){var b=h[e],j=b.tp,Z=b.sctt;switch(Z){case 262144:a=true;switch(j){case 64:case 126:case 264:case 265:case 310:var c=e,k;if(j===64){var E=b.v+h[++e].v;b=h[e+1];if(b.tp===43||b.tp===45){E+=h[++e].v;E+=h[++e].v;}else{if(b.tp===41){e++;}}k=mstrmojo.ME.Enum.DYNAMIC_DIMTY.getDimtyObject(E,this.isDME);}else{k=j===126?C.call(this):b.oi;}k.grouping=1;k.filtering=4;switch(h[c-1].tp){case 33:k.grouping=2;break;case 60:k.grouping=3;break;case 62:k.grouping=4;break;case 297:k.grouping=5;break;case 298:k.grouping=6;break;}switch(h[e+1].tp){case 37:k.filtering=3;break;case 42:k.filtering=2;break;case 43:k.filtering=1;break;}Y.push(k);break;case 45:this.levelFilterRest=false;break;case 47:this.levelCanContinue=false;break;}break;case 327680:switch(j){case 270:case 273:f.push(b.oi);break;case 262:this.conditionEmbedMethod=b.v;break;case 43:this.conditionIgnoreFilterElem=false;break;case 45:this.conditionIgnoreFilterElem=true;break;}break;case 393216:switch(j){case 271:d.push(b.oi);break;}break;}}if(Y.length===0&&!a){Y.push(C.call(this));}}return{level:Y,filter:f,tranformation:d};},levelCanContinue:true,levelFilterRest:true,conditionEmbedMethod:2,conditionIgnoreFilterElem:true,_set_candidates:function(b,Y){this.candidates=Y;if(this.hasRendered){var E=this.metricLCT.levelInput,Z=this.metricLCT.conditionInput,a=this.metricLCT.transformInput;E.candidates=this.getCandidates4LCT([Q.TP.ATTR,Q.STP.NDE]);Z.candidates=this.getCandidates4LCT([Q.TP.FILTER]);a.candidates=this.getCandidates4LCT([Q.TP.ROLE]);}return true;},getCandidates4LCT:function J(a,E){var Z=this.candidates,Y;if(Z){a=G.ensureArray(a);Y=G.filter(Z.items,function(b){return G.indexOf(a,b.t)>-1||G.indexOf(a,b.st)>-1;});if(G.indexOf(a,12)>-1&&E){if(this.replaceAttributeWithForms){Y=this.replaceAttributeWithForms(Y);}}return{items:Y,isComplete:Z.isComplete};}return null;},updateToggleBarStatus:function I(E){var Y=false;if(E.level){Y=E.level.length>1||E.level.length==1&&E.level[0].did!==-1;}if(E.filter){Y=Y||E.filter.length>0;}if(E.transformation){Y=Y||E.transformation.length>0;}if(U(this.did)){Y=true;}this.metricLCT.toggle.set("selected",Y);},levelAdvRef:{scriptClass:"mstrmojo.Editor",title:mstrmojo.desc(9577,"Level Advanced Options"),help:"Level_Advanced_Options_dialog_box.htm",cssClass:"mstrmojo-ME-level-options",onOpen:function(){var E=this.opener;this.contentTable.ccCheckBox.set("checked",E.levelCanContinue);this.contentTable.frCheckBox.set("checked",E.levelFilterRest);},children:[{scriptClass:"mstrmojo.Table",alias:"contentTable",rows:3,cols:1,children:[{scriptClass:"mstrmojo.CheckBox",alias:"ccCheckBox",slot:"0,0",label:mstrmojo.desc(9583,"Allow other users to add extra units to this definition")},{scriptClass:"mstrmojo.CheckBox",alias:"frCheckBox",slot:"1,0",label:mstrmojo.desc(9584,"Include filter attributes which are not in report or level in metric calculation")}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;E.saveLevelOptions(E.contentTable.ccCheckBox.checked,E.contentTable.frCheckBox.checked);E.opener.onmetricModify();E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},conditionAdvRef:{scriptClass:"mstrmojo.Editor",title:"Condition Advanced Options",help:"Condition_Advanced_Options_dialog_box.htm",cssText:"width: 286px;",onOpen:function(){var E=this.opener;this.contentTable.emPulldown.set("value",E.conditionEmbedMethod);this.contentTable.irfeCheckBox.set("checked",E.conditionIgnoreFilterElem);},children:[{scriptClass:"mstrmojo.Table",cssText:"margin-top:5px;",alias:"contentTable",rows:3,cols:1,children:[{scriptClass:"mstrmojo.Label",slot:"0,0",text:mstrmojo.desc(9585,"Interaction between metric filter and report filter: ")},{scriptClass:"mstrmojo.Pulldown",alias:"emPulldown",itemField:"n",itemIdField:"did",slot:"1,0",value:2,items:[{n:mstrmojo.desc(9586,"Merge into new"),did:1},{n:mstrmojo.desc(9587,"Merge report filter into metric"),did:2},{n:mstrmojo.desc(9588,"Merge metric condition into report"),did:3}]},{scriptClass:"mstrmojo.CheckBox",alias:"irfeCheckBox",slot:"2,0",label:mstrmojo.desc(9589,"Ignore related report filter elements")}]},{scriptClass:"mstrmojo.HBox",slot:"buttonNode",cssText:"float:right;margin: 5px 0px;",children:[{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(1442,"OK"),onclick:function(){var E=this.parent.parent;E.saveConditionOptions(E.contentTable.emPulldown.value,E.contentTable.irfeCheckBox.checked);E.opener.onmetricModify();E.close();}},{scriptClass:"mstrmojo.HTMLButton",cssClass:"mstrmojo-Editor-button",text:mstrmojo.desc(221,"Cancel"),onclick:function(){var E=this.parent.parent;E.close();}}]}]},getLCTComponent:function T(){return{scriptClass:"mstrmojo.Table",cssClass:"mstrmojo-ME-LCT",alias:"metricLCT",layout:[{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{}]},{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{}]},{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{}]},{cells:[{cssClass:"mstrmojo-SME-label mstrmojo-ME-LCT-label"},{cssText:"width:252px;padding-right:6px;"}]}],bindings:{visible:function(){return this.parent.isAggFunction;}},labelWidth:"auto",children:[{scriptClass:"mstrmojo.Button",cssClass:"toggle",alias:"toggle",text:mstrmojo.desc(6223,"Show All"),selected:false,bindings:{visible:function(){return !this.parent.parent.isDME;}},onclick:function(E){var Y=!this.selected;this.set("selected",Y);},slot:"0,0"},{scriptClass:"mstrmojo.Label",alias:"lblLevel",text:mstrmojo.desc(4788,"Level"),bindings:{visible:function(){return this.parent.parent.isDME||!this.parent.parent.isDME&&this.parent.toggle.selected;},width:"this.parent.labelWidth"},onwidthChange:function(){if(this.hasRendered){this.domNode.style.width=this.width;}},slot:"1,0"},{scriptClass:"mstrmojo.ME.LevelInputBox",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(2148,"Attribute").toLowerCase()),alias:"levelInput",dtp:-4,xacptSugItemOnly:true,bindings:{noCache:function(){return this.parent.parent.noCache;},isDME:function(){return this.parent.parent.isDME;},visible:function(){return this.parent.lblLevel.visible;}},reportLevelAdded:true,onadd:function(E){var Y=this.getSelectedObjects();this.set("reportLevelAdded",G.find(Y,"did",-1)>-1);},onremove:function(E){var Y=this.getSelectedObjects();this.set("reportLevelAdded",G.find(Y,"did",-1)>-1);},onitemchange:function(){this.parent.parent.onmetricModify();if(M.updateScrollbars){M.updateScrollbars();}},onSaveOnClose:function(){this.parent.parent.onmetricModify();},slot:"1,1"},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link-text right bold",text:mstrmojo.desc(9577,"Level Advanced Options"),bindings:{visible:function(){return !this.parent.parent.isDME&&this.parent.toggle.selected;}},onclick:function(){var E=this.parent.parent;E.openPopup("levelAdvRef",{saveLevelOptions:function(Z,Y){E.levelCanContinue=Z;E.levelFilterRest=Y;},zIndex:E.zIndex+10});},slot:"1,1"},{scriptClass:"mstrmojo.Label",alias:"lblCondition",text:mstrmojo.desc(9579,"Condition"),bindings:{visible:function(){return !this.parent.parent.isDME&&this.parent.toggle.selected;}},slot:"2,0"},{scriptClass:"mstrmojo.ME.ConditionInputBox",cssClass:"mstrmojo-ME-ObjectInputBox-condition singleObject",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(1281,"Filter").toLowerCase()),alias:"conditionInput",dtp:-4,xacptSugItemOnly:true,bindings:{visible:function(){return this.parent.lblCondition.visible;},isDME:function(){return this.parent.parent.isDME;},noCache:function(){return this.parent.parent.noCache;}},onitemchange:function(){this.parent.parent.onmetricModify();},slot:"2,1"},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-ME-link-text right bold condition",text:mstrmojo.desc(9581,"Condition Advanced Options"),bindings:{visible:function(){return this.parent.lblCondition.visible&&!this.parent.parent.isDME;}},onclick:function(){var E=this.parent.parent;E.openPopup("conditionAdvRef",{saveConditionOptions:function(Z,Y){E.conditionEmbedMethod=Z;E.conditionIgnoreFilterElem=Y;},zIndex:E.zIndex+10});},slot:"2,1"},{scriptClass:"mstrmojo.Label",alias:"lblTransform",text:mstrmojo.desc(3324,"Transformation"),bindings:{visible:function(){return !this.parent.parent.isDME&&this.parent.toggle.selected;}},slot:"3,0"},{scriptClass:"mstrmojo.ME.TransformInputBox",cssClass:"mstrmojo-ME-ObjectInputBox-transform",emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(3377,"Object").toLowerCase()),alias:"transformInput",dtp:-4,xacptSugItemOnly:true,bindings:{visible:function(){return this.parent.lblTransform.visible;},isDME:function(){return this.parent.parent.isDME;},noCache:function(){return this.parent.parent.noCache;}},onitemchange:function(){this.parent.parent.onmetricModify();if(M.updateScrollbars){M.updateScrollbars();}},slot:"3,1"}]};}});mstrmojo.ME._HasLevel.EnumEditorComponents=X;}());(function(){mstrmojo.requiresClsP("mstrmojo","array","css","hash","color","Editor","Button","Box","Label","num");mstrmojo.requiresClsP("mstrmojo.ui","Pulldown","Checkbox","CheckList");mstrmojo.requiresClsP("mstrmojo.threshold","ColorSlider","ThresholdModel");mstrmojo.requiresClsP("mstrmojo.models","FormatModel");mstrmojo.requiresDescs(2268,2281,2491,2519,3606,5585,7665,7666,7905,7907,7908,7909,7910,12110,12111,13613,13614,13615);var M=mstrmojo.array,X=mstrmojo.css,P=mstrmojo.hash,Q=mstrmojo.Button.newWebButton,U=mstrmojo.num,E=mstrmojo.models.FormatModel.getFormatUpdate,A=4;var V=mstrmojo.threshold.ThresholdModel.SLIDER_MODE,F=mstrmojo.threshold.ThresholdModel.FEATURES;var K=null,B=null,W=[{n:mstrmojo.desc(527,"Value"),v:7},{n:mstrmojo.desc(4405,"Lowest"),v:4},{n:mstrmojo.desc(529,"Highest"),v:5},{n:mstrmojo.desc(4406,"Lowest %"),v:1},{n:mstrmojo.desc(4407,"Highest %"),v:2}];function S(m){var n=[],k=this.colorSlider,j=k.getComp(),d=k.getPalette(),l=this.basedOn.value,f=this.model,g=this.controller,o=f.orgThresholds,a=this.metricId,c=o&&o[a],Z=this.breakBy.breakByList,h=Z.items[Z.selectedIndex],b=j.length,e,p;if(k.getReversedValue()){d=d.concat().reverse();}for(e=0;e<b;e++){p={};if(this.colorSlider.sliderMode===V.IMAGE_BASED){p.rtp=4;p.rtxt=d[e];}else{p.fmt=E("bc",d[e]);}if(e>0){p.flr=U.toLocaleString(f.getRealValue(j[e-1],l));}if(e<b-1||b===1){p.ceil=U.toLocaleString(f.getRealValue(j[e],l));}if(h&&h.did!==-1){p.dmy={did:h.did,t:h.t};}n.push(p);}g.onSubmitActions(n,c,a,g.supportsFeature(F.SHOW_BASED_ON)?this.basedOn.selectedMetric:a,this.basedOn.value,m,A);}function J(k){var f=this.model,b=f.thresholds&&f.thresholds[k],w=f.data.gsi,n=this.colorSlider,h=[],AB=[],g=[],m,AA,Z,p=this.colorPalettes,l=this.imageSelector,u=p.colorPulldown,z=this.typeSelector.typeCheckList,a=l.imagePulldown,j=this.basedOn,d=j.options,t=j.metricsList,r=this.breakBy.breakByList,q=this.controller.supportsFeature(F.SHOW_BASED_ON);if(b&&b.length>0){m=f.getSimpleThresholdType(k);if(m!==-2){Z=f.isImageBasedType(k);b.forEach(function(e){var AD=P.copy(e),AC=AD.ceil;if(AC!==Infinity){AD.comp=f.getNormalizedValue(AC,e.ttp);}else{AD.comp=1;}h.push(AD);});h.sort(function(AC,e){return AC.comp-e.comp;});h.forEach(function(e){AB.push(e.comp);if(Z){g.push(e.rtxt);}else{g.push(e.fmt.bc);}});z.set("selectedIndex",Z?V.IMAGE_BASED:V.COLOR_BASED);if(Z){AA=f.getImageSetName(g);a.set("selectedIndex",M.find(B,"v",AA));}else{AA=f.getColorScheme(g);if(AA==="custom"){this.switchToCustomScheme(AB,g);n.unselectAll();n.update();}else{u.set("items",K);u.set("selectedIndex",M.find(K,"v",AA));}}n.set("baseColor",AA);n.setColorComp(AA,AB);if(f.isMapReversed(AA,g,Z)){n.reverseMapColor();}if(q){var c=b[0].expr,o=c.m||c.nds[0].m;t.set("selectedIndex",M.find(w.mx,"did",(o&&o.did)||f.metricId));}d.set("selectedIndex",M.find(d.items,"v",m));var x;try{x=b[0].expr.nds[0].dmy.uts[0].utgt.did;}catch(v){}r.set("selectedIndex",Math.max(0,M.find(r.items,"did",x)));}}else{z.set("selectedIndex",V.COLOR_BASED);u.set("items",K);u.set("selectedIndex",0);n.update();if(q){t.set("selectedIndex",0);}r.set("selectedIndex",0);}}function N(Z){this.parent.colorSlider.set("baseColor",Z);this.selectedColor=Z;}function O(){return mstrmojo.Button.newWebButton(mstrmojo.desc(12282,"Reversed"),function(){this.parent.parent.colorSlider.reverseMapColor(this.checked);},false,{cssClass:"reverse"});}function L(){var Z=this.model,b=this.basedOn.options,d=b.items,e=isNaN(Z.getMetricsMaxValue())||isNaN(Z.getMetricsMinValue()),a=(e||!this.controller.supportsFeature(F.SHOW_VALUE_ITEM))?W.slice(1):W,c=d[b.selectedIndex];if(a.length!==d.length){b.set("items",a);b.set("selectedIndex",Math.max(a.indexOf(c),0));}}mstrmojo.threshold.SimpleThresholdEditor=mstrmojo.declare(mstrmojo.Editor,null,{scriptClass:"mstrmojo.threshold.SimpleThresholdEditor",cssClass:"mstrmojo-SimpleThresholdEditor",title:mstrmojo.desc(3647,"Thresholds"),help:"thresholds_editor.htm",model:undefined,controller:undefined,metricId:undefined,metricName:undefined,typeSelector:undefined,basedOn:undefined,breakBy:undefined,colorSlider:undefined,colorPalettes:undefined,imageSelector:undefined,showAdvancedEditorLink:undefined,init:function R(b){this._super(b);var a=mstrApp.customization.getCustomThresholds(),Z=function(c){return{n:mstrmojo.desc(c.title,"N/A"),v:c.id,cls:c.id};};if(!K){K=a.color.map(function(c){return Z(c);});}this.colorPalettes.colorPulldown.set("items",K);if(!B){B=a.image.map(function(d){var c=Z(d);c.bc=d.combinedImageUrl;return c;});this.imageSelector.imagePulldown.set("items",B);}},onOpen:function D(){var Z=this.controller,a=this.model,e=this.basedOn,c=e.options,f=e.metricsList,b=this.metricId,d=a.data.gsi;this.colorSlider.resetColorMap();X.toggleClass(this.containerNode,"hideImage",!Z.supportsFeature(F.SHOW_IMAGE));if(Z.supportsFeature(F.SHOW_BASED_ON)){X.addClass(c.domNode,"short");f.set("items",d.mx);f.set("visible",true);}else{f.set("visible",false);X.removeClass(c.domNode,"short");}this.breakBy.breakByList.set("items",[{n:mstrmojo.desc(2057,"None"),did:-1}].concat(this.targets.filter(function(g){return g.t===12;})));this.showAdvancedEditorLink.set("visible",Z.supportsFeature(F.SHOW_ADVANCED_EDITOR));J.call(this,b);this.colorSlider.updateLabels();this.domNode.oncontextmenu=function(){if(mstrApp.isSingleTier){return false;}};},onClose:function C(){this.model.cleanUp();},switchToCustomScheme:function H(b,g){var f="custom",c=this.colorSlider,d=this.colorPalettes.colorPulldown,e=d.items,a=e.map(function(h){return h.v;}).indexOf(f)!==-1;b=b||c.getComp().concat();if(!g){var Z=c.getPalette().concat();g=c.getReversedValue()?Z.reverse():Z;}c.addCustomScheme(b,g);if(!a){d.set("items",e.concat({n:mstrmojo.desc(2056,"Custom"),v:f}));}d.set("selectedIndex",M.find(d.items,"v",f));},children:[{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"typeSelector",typeCheckList:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12112,"Thresholds Type:")},{scriptClass:"mstrmojo.ui.CheckList",alias:"typeCheckList",multiSelect:false,orientation:"h",postselectionChange:function I(l){var f=this.parent.parent,d=f.model,g=f.colorSlider,b=f.colorPalettes,j=f.imageSelector,c=j.imagePulldown,a=K[b.colorPulldown.selectedIndex],Z=B[c.selectedIndex],k=l.added[0],e=k?Z:a,h=k?d.getDefaultImages()[0].id:d.getDefaultColors()[0].id;b.set("visible",!k);j.set("visible",!!k);g.set("sliderMode",k);g.set("baseColor",(e&&e.v)||h);g.editableBubble.set("visible",false);if(k===V.IMAGE_BASED&&!c.selectedIndex){c.set("selectedIndex",0);}},selectedIndex:0,items:[{n:mstrmojo.desc(12113,"Color-based"),v:"color",cls:"color"},{n:mstrmojo.desc(12114,"Image-based"),v:"image",cls:"image"}]}]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"colorPalettes",selectedColor:undefined,colorPulldown:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(2060,"color:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"short",alias:"colorPulldown",onitemSelected:function G(Z){N.call(this.parent,Z.v);},selectedIndex:0,items:K},O()]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"imageSelector",visible:false,selectedColor:undefined,imagePulldown:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(6369,"Images:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"image-pulldown short",alias:"imagePulldown",onitemSelected:function G(Z){N.call(this.parent,Z.v);},getPopupListConfig:function T(){var Z=mstrmojo.ui.Pulldown.prototype.getPopupListConfig.call(this);Z.getItemMarkup=function b(){return'<{@tag} class="item {@cls}" idx="{@idx}" style="{@style}" title="{@title}"><div class="text">{@n}</div><div class="bc" style="{@bc}"></div></{@tag}>';};Z.getItemProps=function a(e,c){var d=mstrmojo._IsList.getItemProps.call(this,e,c);d.bc="background:url("+e.bc+")";return d;};return Z;},items:B},O()]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"basedOn",value:"",metricsList:undefined,options:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4402,"Based on:")},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"short",alias:"metricsList",onitemSelected:function G(c){var b=this.parent,Z=b.parent,a=c.did;b.selectedMetric=Z.model.basedOnId=a;Z.colorSlider.updateLabels();L.call(Z);}},{scriptClass:"mstrmojo.ui.Pulldown",selectedIndex:3,cssClass:"short option",alias:"options",onitemSelected:function G(b){var e=this.parent,a=e.parent,d=a.breakBy,c=b.v,Z=c===7;e.value=c;a.colorSlider.set("selectedOption",b.v);d.set("visible",!Z);if(Z){d.breakByList.set("selectedIndex",0);}},items:W}]},{scriptClass:"mstrmojo.Box",cssClass:"row",alias:"breakBy",breakByList:undefined,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(4564,"Break By:")},{scriptClass:"mstrmojo.ui.Pulldown",alias:"breakByList"}]},{scriptClass:"mstrmojo.threshold.ColorSlider",alias:"colorSlider"},{scriptClass:"mstrmojo.Label",cssClass:"link",alias:"showAdvancedEditorLink",slot:"buttonNode",text:mstrmojo.desc(4569,"Advanced Thresholds Editor..."),onclick:function Y(){var b=this.parent,a=b.breakBy.breakByList,Z=a.items[a.selectedIndex].did!==-1,c=function(){b.colorSlider.unselectAll();b.close();b.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;};mstrmojo.warn(Z?mstrmojo.desc(14160,"Save thresholds definition before proceeding to the Advanced Thresholds Editor? The Break By attribute will be lost."):mstrmojo.desc(14159,"Save thresholds definition before proceeding to the Advanced Thresholds Editor?"),undefined,{cssClass:"save-threshold-warning",buttons:[Q(mstrmojo.desc(2827,"Clear"),function(){c();b.controller.openEditor();},false,{cssClass:"nosave"}),Q(mstrmojo.desc(2031,"Apply"),function(){c();a.set("selectedIndex",0);S.call(b,true);},true),Q(mstrmojo.desc(2223,"Cancel"))]});}},{scriptClass:"mstrmojo.Box",cssClass:"editor-buttons",slot:"buttonNode",children:[Q(mstrmojo.desc(221,"Cancel"),function Y(){var Z=this.parent.parent;Z.colorSlider.unselectAll();Z.close();}),Q(mstrmojo.desc(1442,"OK"),function Y(){var Z=this.parent.parent;S.call(Z);Z.colorSlider.unselectAll();Z.close();},true),Q(mstrmojo.desc(2031,"Apply"),function Y(){var Z=this.parent.parent;S.call(Z,true);Z.colorSlider.unselectAll();},true)]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.hash","mstrmojo.Container","mstrmojo.threshold.TextGroup","mstrmojo.threshold.ThresholdRow","mstrmojo.ui.editors.controls.ContainerGroup","mstrmojo.ui.editors.controls.CharacterGroup");var G=mstrmojo.Widget,F=mstrmojo.hash,D="180px";mstrmojo.threshold.PropertyPanel=mstrmojo.declare(mstrmojo.Container,[mstrmojo.threshold.PropertyPanel],{markupString:'<div class="mstrmojo-threshold-PropertyPanel"><div class="condition"></div><div class="format mstrmojo-vi-PropEditor"><div class="text"><div class="title">'+mstrmojo.desc(5998,"Replace Data")+'</div></div><div class="font mstrmojo-vi-EditorGroup"><div class="title">'+mstrmojo.desc(3433,"Font")+'</div></div><div class="border"><div class="title">'+mstrmojo.desc(5616,"Color And Borders")+'</div></div></div><div class="apply"></div></div>',markupSlots:{conditionNode:function(){return this.domNode.firstChild;},textNode:function(){return this.domNode.children[1].firstChild;},fontNode:function(){return this.domNode.children[1].children[1];},borderNode:function(){return this.domNode.children[1].children[2];},applyNode:function(){return this.domNode.lastChild;}},markupMethods:{onvisibleChange:G.visibleMarkupMethod,onheightChange:G.heightMarkupMethod,onwidthChange:G.widthMarkupMethod},model:undefined,editor:undefined,textGroup:undefined,charGroup:undefined,containerGroup:undefined,onvisibleChange:function A(){if(this.visible){var J=this.model;J.updateControl(this);var H=F.clone(J.threshold),I=this.thresholdRow;if(I){this.removeChildren(I);}this.addChildren({scriptClass:"mstrmojo.threshold.ThresholdRow",alias:"thresholdRow",slot:"conditionNode",idx:J.thresholdRow.idx,model:this.editor.model,threshold:H,onclick:mstrmojo.emptyFn});this.refresh();}},onOK:function B(){this.model.submitChange();this.close();},close:function E(){var H=this.thresholdRow;if(H){this.removeChildren(H);}this.set("visible",false);this.editor.toggleButtonStatus(true);this.editor.setRowPanelVisibility(true);},children:[{scriptClass:"mstrmojo.threshold.TextGroup",slot:"textNode",alias:"textGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("threshold",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.CharacterGroup",slot:"fontNode",alias:"charGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("fmt",H,I);}},{scriptClass:"mstrmojo.ui.editors.controls.ContainerGroup",slot:"borderNode",alias:"containerGroup",width:D,onGroupValueChange:function C(H,I){this.parent.model.changeFormatProperty("fmt",H,I);}},{alias:"cancelBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"cancelBtn",onclick:function(){var H=this.parent;if(H.close){H.close();}}},{alias:"okBtn",slot:"applyNode",scriptClass:"mstrmojo.Button",cssClass:"okBtn",onclick:function(){var H=this.parent;if(H.onOK){H.onOK();}}},{scriptClass:"mstrmojo.Label",alias:"tip",slot:"applyNode",cssClass:"tip",text:mstrmojo.desc(14000,"Press ## after finishing formatting.").replace("##",'""')}]});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.ConditionWalk","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.mstr.EnumNodeDimty","mstrmojo.mstr.DocElementDataHelper","mstrmojo.ui._IsIncFetchList");var E=mstrmojo.array,G=mstrmojo.css,C=mstrmojo.mstr.EnumNodeDimty,K=E.hash([C.NodeDimtyUnspecified,C.NodeDimtyNone]);function H(){var L=this.thresholdRow,M=this.editor;if(L){this.removeChildren(L);}G.toggleClass(M.content.domNode,"no-overflow",false);this.set("visible",false);M.setRowPanelVisibility(true);}mstrmojo.threshold.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,[mstrmojo.ui._IsIncFetchList],{objectBrowsingEnabled:false,dimtyTypes:K,targets:null,targetsLastMod:null,ets:null,condition:null,onOK:function B(){var L=this.editor;L.model.setConditionData(this.condition,this.model.get());H.call(this);L.toggleButtonStatus(true);},close:function I(){var O=this.editor;var Q=this.condition,M=Q.tree.parent,L=M.exprTree;if(Q.isEmpty()){Q.del();}var N=L&&L.items,P=N&&N.length;if(!P||P===0){O.model.deleteThreshold(M.threshold);}H.call(this);O.toggleButtonStatus(true);},browse:function F(L){this._super(L);if(L.alias==="es"){G.toggleClass(this.eb.domNode,"adv-threshold",true);}},getAttributeForms:function J(L){return mstrmojo.rw.ConditionWalk.getAttForms(L,this.editor.controller.datasets);},getElements:function D(N,P){var O={},L=P.complete,M=this;this.scrollNode=this.columnWalk.es.scrollNode;if(!this.ifDataHelper){this.ifDataHelper=new mstrmojo.mstr.DocElementDataHelper({source:this.editor.controller.dataService});}else{this.ifDataHelper.set("items",null);}this.columnWalk.es.es.allowUnlistedValues=false;this.updateBrowseElementsParams(O,N);this.ifDataHelper.browseConfig=O;P=mstrmojo.func.wrapMethods(P,{complete:function(Q){M.initScroll();}});this.ifDataHelper.getItems(1,P);},postNext:function A(){this.columnWalk.es.updateList(this.ifDataHelper.items);}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.rw.ConditionWalk","mstrmojo.Label","mstrmojo.ui.Pulldown","mstrmojo.ui.Checkbox","mstrmojo.expr","mstrmojo.css");var F=mstrmojo.expr.ET.MQ,H=mstrmojo.expr.ET.MC,C=mstrmojo.css,B=mstrmojo.desc(14387,"Evaluate this condition independent of other dataset level conditions");var G=function(K,M){var J=K.et,L=((J===F||J===H)&&!this.inRelation)?"block":"none",I=((M===1)||J!==F)?1:0;C.toggleClass(this.toolNode,"unselectable",J===H);this.toolNode.style.display=L;this.level.set("selectedIndex",I);this.includeExist.set("visible",I===1&&(J===H||J===F));this.includeExist.set("checked",K.idcsi===undefined?false:K.idcsi);};mstrmojo.fe.ConditionWalk=mstrmojo.declare(mstrmojo.rw.ConditionWalk,null,{scriptClass:"mstrmojo.fe.ConditionWalk",markupString:'<div class="mstrmojo-rw-ConditionWalk" mstrAttach:click><div class="condition mstrmojo-ConditionNode"><div class="mstrmojo-cond-contents"></div></div><div class="walk"></div><div class="tools"></div><div class="apply"></div></div>',markupSlots:mstrmojo.hash.copy({toolNode:function(){return this.domNode.childNodes[2];}},mstrmojo.hash.copy(mstrmojo.rw.ConditionWalk.prototype.markupSlots)),layoutConfig:{h:{conditionNode:"auto",walkNode:"100%",toolNode:"auto",applyNode:"auto"},xt:true},postCreate:function E(){this.children=mstrmojo.hash.clone(this.children).concat([{scriptClass:"mstrmojo.Label",slot:"toolNode",text:mstrmojo.desc(13517,"Calculate on")},{scriptClass:"mstrmojo.ui.Pulldown",slot:"toolNode",alias:"level",isHostedWithin:false,items:[{n:mstrmojo.desc(13518,"Template level"),v:0},{n:mstrmojo.desc(13519,"Dataset level"),v:1}],onitemSelected:function I(J){var K=this.parent;if(K&&K.condition&&K.visible){K.includeExist.set("visible",J.v===1);K.condition.level=J.v;}}},{scriptClass:"mstrmojo.ui.Checkbox",alias:"includeExist",slot:"toolNode",postBuildRendering:function(){this.domNode.innerHTML=B;},oncheckedChange:function(){var J=this.parent;if(J){J.model.set("idcsi",this.checked);}}}]);if(this._super){this._super();}},onvisibleChange:function A(I){var J=this.condition;if(J&&this.toolNode&&this.visible){G.call(this,J.data,J.tree.level);}if(this._super){this._super(I);}},onmodeledit:function D(I){if(this._super){this._super(I);}if(this.toolNode){G.call(this,this.model.get(),this.model.level);}}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.dom","mstrmojo.expr","mstrmojo.hash","mstrmojo.Box","mstrmojo.Button","mstrmojo.Dial","mstrmojo.Editor","mstrmojo.FilterExpr","mstrmojo.HBox","mstrmojo.Label","mstrmojo.Obj","mstrmojo.CheckBox","mstrmojo.warehouse.EnumObjectTypes","mstrmojo.fe.FilterExprTree","mstrmojo.fe.RelationFilterExprTree","mstrmojo.fe.CreateSetEditor","mstrmojo.fe.ConditionWalk","mstrmojo.ui.Pulldown","mstrmojo.ui.StatusButton");var Z=mstrmojo.expr,I=Z.ET,P=Z.BRANCH_FNS,X=mstrmojo.Obj,W=mstrmojo.dom,a=mstrmojo.array,T=mstrmojo.hash,d=mstrmojo.css,C=mstrmojo.warehouse.EnumObjectTypes,K={TEMPLATE:0,DATASET:1},E=mstrmojo.mstr.EnumNodeDimty,R=a.hash([E.NodeDimtyUnspecified,E.NodeDimtyNone]),N=200,H=mstrmojo.ui.PopupConfig.ENUM_CORNERS;function B(g){a.forEach(this.buttonBar.children[0].children,function(h){h.set("enabled",g);});}function Y(){var g=this.avatar;if(g){g.parentNode.removeChild(g);delete this.avatar;d.removeClass(g,[this.avatarCssClass]);}}mstrmojo.fe.FilterEditorBase=mstrmojo.declare(mstrmojo.Editor,null,{onSave:null,title:mstrmojo.desc(12032,"View Filter Editor"),help:"view_filter_editor_for_report_services_documents.htm",cssClass:"mstrmojo-charcoalboxe mstrmojo-FE",showLimits:true,objectBrowsingEnabled:false,children:null,init:function U(g){this.children=[{alias:"feContent",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-content",postCreate:function(){this.children=[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-exprTool",children:[{scriptClass:"mstrmojo.ui.StatusButton",cssClass:"mstrmojo-FE-addCondition",postCreate:function h(){this.editor=this.parent.parent.parent;this.statusList=this.editor.getAddConditionList();this.status=this.statusList[0];},onButtonClick:function(j){if(j){j.handler.apply(this.editor);}}}]},this.parent.getExpressionContainerCfg()];}},this.getConditionWalkConfig(),{alias:"buttonBar",scriptClass:"mstrmojo.HBox",cssClass:"mstrmojo-Editor-buttonBar",slot:"buttonNode",children:[{scriptClass:"mstrmojo.HBox",cssText:"float:right; border-collapse: separate",cellSpacing:3,children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton hot",text:mstrmojo.desc(118,"Save"),onclick:function(){var h=this.editor;M(h);h.close();},bindings:{enabled:function(){return !this.editor.readOnly;},editor:"this.parent.parent.parent"}},{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.editor.close();},bindings:{editor:"this.parent.parent.parent"}}]}]}];this._super(g);this.model=this.model||new X();},getExpressionContainerCfg:function(){var g=this;return{alias:"feExpr",scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-FE-expr-list",postCreate:function(){this.children=g.getExpressionContentsConfig();},onRender:function(){W.attachMarkupEvent(this.id,this.domNode,"mousedown");},onmousedown:function(h){var j=W.eventTarget(h.hWin,h.e);if(this.isBlankArea(j)){this.clearSelect();}},isBlankArea:function(h){return h===this.domNode;},clearSelect:function(){}};},getExpressionContentsConfig:function(){return[];},getConditionWalkConfig:function(){var h=this;return{scriptClass:"mstrmojo.rw.ConditionWalk",width:"750px",objectBrowsingEnabled:false,dimtyTypes:R,alias:"walk",visible:false,onOK:function g(){var k=this.condition;h.feContent.set("visible",true);this.set("visible",false);h.onConditionEdit(k,this.model.get());B.call(h,true);},close:function j(){h.feContent.set("visible",true);this.set("visible",false);var k=this.condition;if(k.isEmpty()){k.del();}B.call(h,true);},targets:null,targetsLastMod:null,ets:null,condition:null,bindings:{disableElementsBrowsing:"this.parent.disableElementsBrowsing"}};},onConditionEdit:function(h,g){h.tree.modifyConditionNode(h,g);},getAddConditionList:function c(){return[{n:mstrmojo.desc(1994,"Add Condition"),handler:function(){this.mainExpr.newCondition(null,true);}}];},andOrPopupRef:{scriptClass:"mstrmojo.Editor",cssClass:"mstrmojo-FE-andOrPopup mstrmojo-CGE-andOrPopup mstrmojo-ConditionWalk",contentNodeCssClass:"mstrmojo-balloon",slot:"containerNode",modal:false,autoClose:true,showTitle:false,draggable:false,openEffect:null,closeEffect:null,onOpen:function(){var g=this.condition,k=g&&g.data&&g.data.not,l=g&&g.parent,h=l&&l.data,j=(h&&h.fn)+(k?21:0);this.list.opening=true;this.list.set("selectedItem",isNaN(j)?null:{did:j});this.list.opening=false;},children:[{scriptClass:"mstrmojo.Dial",cssClass:"mstrmojo-CGE-andOrDial",alias:"list",itemMarkup:'<div class="dial-item {@css}">{@n}</div>',itemIdField:"did",items:[{did:19,n:P[19]},{did:20,n:P[20]},{did:19+21,n:P["19_21"]},{did:20+21,n:P["20_21"]}],onchange:function(){if(this.opening){return ;}var h=this.parent,g=h.condition,n=this.selectedItem,m=n&&n.did,l=m>21?true:null,k=m-(l?21:0);h.close();var j=g&&g.parent;if(j&&j.data&&j.data.et===I.ANDOR){j.edit(g,k,l);}else{var o=g&&g.data;if(o&&(o.not!==l)){o.not=l;g.paint();}}}}]},createSetPopupRef:{scriptClass:"mstrmojo.fe.CreateSetEditor",contentNodeCssClass:"",cssClass:"CreateSet-Editor",title:mstrmojo.desc(12034,"Create a Set"),slot:"containerNode"},_set_busy:function(h,g){if(g){this.set("enabled",false);this.set("iconClass","mstrmojo-WaitIcon");}else{this.set("enabled",true);this.set("iconClass","");}},_set_model:function(l,h){var j=this.model,k=j!==h;if(k){this.model=h;this.modelLastSet=new Date();var g=function(m){return Q(J(m));};h.exprForest=g(h.expr);h.limitExprForest=g(h.limitExpr);if(this.feContent&&this.feContent.feExpr.ve){this.feContent.feExpr.ve.nameFactory.clear();}}return k;},onUpdateBrowseElementsParams:mstrmojo.emptyFn});mstrmojo.fe.ReportFilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,null,{getExpressionContainerCfg:function(){var g=this._super();return mstrmojo.mixin({clearSelect:function(){this.re.clearTreeSelect();}},g);},getExpressionContentsConfig:function(){return[{alias:"re",scriptClass:"mstrmojo.fe.ReportFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}}];}});mstrmojo.fe.ReportFilterExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.ReportFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",onNew:function(g){g.data.isNew=true;F(this.editor,g.data,g.widget.ctxtBuilder.itemWidgets[g.index],"condition");},onnodeclick:function A(g){F(g.editor||this.tree.editor,this.data,this,g&&g.part);},allowDrop:function G(g){var j=g&&g.src,l=j&&j.data,k=l&&l.et,h=j&&j.widget&&j.widget.tree;return k&&this!==h;}});mstrmojo.fe.FilterEditor=mstrmojo.declare(mstrmojo.fe.FilterEditorBase,null,{getExpressionContainerCfg:function(){var g=this._super();return mstrmojo.mixin({isBlankArea:function(h){if(this._super(h)){return true;}return !a.filterOne([this.ve,this.vle],function(j){if(W.contains(j.domNode,h,true)){return true;}});},clearSelect:function(){this.ve.clearTreeSelect();this.vle.clearTreeSelect();}},g);},getExpressionContentsConfig:function(){return[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11746,"Dataset Level Conditions"),cssClass:"mstrmojo-FE-expr-header dl",bindings:{visible:"true || this.parent.parent.parent.showLimits"}},{alias:"ve",scriptClass:"mstrmojo.fe.RWViewFilterExprTree",level:K.DATASET,bindings:{items:"this.editor.model.exprForest || []"},onBlankClick:function(g){this.parent.clearSelect(g);},supportRelation:true,postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("mainExpr",this);}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11747,"Template Level Conditions"),cssClass:"mstrmojo-FE-expr-header tl",bindings:{visible:"this.parent.parent.parent.showLimits"}},{alias:"vle",scriptClass:"mstrmojo.fe.RWViewLimitExprTree",level:K.TEMPLATE,bindings:{visible:"this.editor.showLimits",items:"this.editor.model.limitExprForest || []"},onBlankClick:function(g){this.parent.clearSelect(g);},postApplyProperties:function(){this.editor=this.parent.parent.parent;this.editor.set("limitExpr",this);}}];},getConditionWalkConfig:function(){var g=this._super();T.copy({scriptClass:"mstrmojo.fe.ConditionWalk"},g);return g;},getAddConditionList:function c(){var g=this._super();g.push({n:mstrmojo.desc(12055,"Add Dynamic Condition"),handler:function(){this.mainExpr.newCondition({et:I.XML,idc:1,ph:{}},true);}});return g;},onConditionEdit:function(j,h){if(j.tree.level===j.level||j.tree.level===undefined){this._super(j,h);}else{j.parent.remove(j.data);var g=K.TEMPLATE===j.level?this.limitExpr:this.mainExpr;g.addSingleCondition(h);}}});mstrmojo.fe.RWViewFilterExprTree=mstrmojo.declare(mstrmojo.fe.RelationFilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewFilterExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-datasetExpr",onNew:function(g){g.data.isNew=true;if(!g.data.ph){F(this.editor,g.data,g.widget.ctxtBuilder.itemWidgets[g.index],"condition");}},onnodeclick:function A(g){F(g.editor||this.tree.editor,this.data,this,g&&g.part);},ondragend:function O(j){var h=j&&j.tgt,g=h&&h.widget;if(this.tree&&g&&g.tree&&g.tree!==this.tree){Y.call(this);return ;}this._super(j);},getItemConfig:function(j,g,k){var h=this._super(j,g,k);return T.copy({getConditionTextPostfix:function(){if(this.data.et!==I.MQ){return"";}return'<img class="mstrmojo-moveToViewLimit" src="../images/1ptrans.gif" title="'+mstrmojo.desc(4978,"Move to view limit")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewLimit(w); return false;\" />";}},h);},moveMQNodeToViewLimit:function(j){if(j.data.et!==I.MQ){return ;}var h=T.copy(j.data);j.parent.remove(j.data);var g=this.editor.limitExpr;g.addSingleCondition(h);},allowDrop:function G(g){var j=g&&g.src,m=j&&j.data,l=m&&m.et,k=this.tree,h=j&&j.widget&&j.widget.tree;return l&&(this===k?(h!==k):true);}});mstrmojo.fe.RWViewLimitExprTree=mstrmojo.declare(mstrmojo.fe.FilterExprTree,null,{scriptClass:"mstrmojo.fe.RWViewLimitExprTree",cssClass:"mstrmojo-expr mstrmojo-FE-limitExpr",validExprTypes:a.hash([I.MQ]),onnodeclick:function A(g){F(this.tree.editor,this.data,this,g&&g.part);},onConditionEdit:function(h,g){this._super(h,g);h.data.mdxUnitId=h.data.m.did;V(h);},addSingleCondition:function(h){var g=this._super(h);V(g);},allowDrop:function(g){var k=g&&g.src,m=k&&k.data,l=m&&m.et,j=this.tree,h=k&&k.widget&&k.widget.tree;if(j===h){return this!==h&&this.data&&(this===k.parent||this.data.mdxUnitId===m.mdxUnitId);}return l===I.MQ;},ondrop:function L(h){var l=h&&h.src,g=l&&l.widget;if(g&&g.tree!==this.tree){var k=l&&l.data;if(k&&k.index!==null){var j=g.ctxtBuilder.itemWidgets[k.index];j.tree.moveMQNodeToViewLimit(j);}l.data=null;}this._super(h);},isEditable:function(g){return g.mdxUnitId&&this._super(g);},ondragend:function S(g){var k=g&&g.tgt,h=k&&k.widget;if(h&&h.tree!==this.tree){var j=g.src&&g.src.data;if(j&&(j.indices||(j.index!==null))){this.remove(j.indices||j.index);}Y.call(this);}else{this._super(g);}},moveMQNodeToViewFilter:function(h){var g=this.editor.mainExpr;h.parent.remove(h.data);g.addSingleCondition(h.data);},getItemConfig:function(j,g,k){j.mdxUnitId=D(j);var h=this._super(j,g,k);return T.copy({cssClass:f(j,g,k)?"per-metric-limit":"",forbidRelation:true,getConditionTextPostfix:function(){if(this.data.et!==I.MQ){return"";}return'<img class="mstrmojo-moveToViewFilter" src="../images/1ptrans.gif" title="'+mstrmojo.desc(9746,"Move to view filter")+'"onclick="var w = mstrmojo.all[\''+this.id+"']; w.tree.moveMQNodeToViewFilter(w); return false;\" />";}},h);}});function F(p,m,o,t){var h=W.delta(o.domNode,p.containerNode);h.y+=(t==="andor"?16:parseInt(o.domNode.offsetHeight,10));var q={condition:o,zIndex:p.zIndex+10,left:h.x+"px",top:h.y+"px"},g;switch(t){case"andor":if(p.skipAndOrPopup){return ;}g="andOrPopupRef";break;case"createSet":case"createSetOpt":var r=p.model.targets;g="createSetPopupRef";q.type=t;q.model={attrs:a.filter(r,function(n){return n.t===C.ATTRIBUTE;}),metrics:a.filter(r,function(n){return n.t===C.METRIC;})};if(t==="createSetOpt"){q.condition=o.parent;q.model.childIdx=o.childIndex();}break;case"condition":var l=p.walk,j=o.textNode.cloneNode(true),k=l.conditionNode.firstChild;d.removeClass(j,"editable");d.addClass(l.conditionNode,"mstrmojo-ConditionNode");if(k.firstChild){k.removeChild(k.firstChild);}k.appendChild(j);l.set("objectBrowsingEnabled",p.objectBrowsingEnabled);l.set("targets",p.model.targets);l.set("targetsLastMod",p.modelLastSet);l.set("ets",o.tree.validExprTypes||p.validExprTypes);l.set("condition",o);l.set("model",T.clone(m));l.set("hasPrompt",p.model.hasPrompt);l.set("disableElementsBrowsing",p.disableElementsBrowsing||l.disableElementsBrowsing);l.set("editor",p);l.set("inRelation",o.inRelation);p.feContent.set("visible",false);l.set("visible",true);l.columnWalk.target.updateScrollbars();B.call(p,false);return ;}p.openPopup(g,q);}function M(h){var g=h.model;g.expr=e(g.exprForest);g.limitExpr=e(b(g.limitExprForest));h.onSave(g);}function Q(h){var g=[];a.forEach(h,function(j){if(!j){return ;}if(j.et===I.ANDOR){j.nds=Q(j.nds);if(j.nds.length===0){return ;}else{if(j.nds.length===1){var k=j.nds[0];if(j.not){k.not=!k.not;}g.push(k);return ;}}}g.push(j);});return g;}function J(g){return g?[g]:[];}function e(g){return g&&g.length===1?g[0]:null;}function b(j){var h=Q(j),g;if(!h[0]||h[0].mdxUnitId){g={et:I.ANDOR,fn:Z.FN.AND,nds:h};}else{g=h[0];}return[g];}function f(h,g,j){return(j===j.tree||j.parent===j.tree)&&!!h.mdxUnitId;}function D(h){if(!("mdxUnitId" in h)){var g;switch(h.et){case I.MQ:g=h.m.did||null;break;case I.ANDOR:a.forEach(h.nds,function(k){var j=D(k);if(g===undefined){g=j;}else{if(g!==j){g=null;return false;}}return true;});break;default:g=undefined;break;}h.mdxUnitId=g;}return h.mdxUnitId;}function V(m){var o=m.tree,n=o.ctxtBuilder.itemWidgets[0],r=m.parent,p=a.indexOf(r.items,m.data),k=r.items[p],h=k.mdxUnitId;if(r===o){return ;}if(r.data.mdxUnitId===h){return ;}if(n.data.mdxUnitId){var j={et:I.ANDOR,fn:Z.FN.AND,nds:[n.data,k]};o.remove(0);o.add([j]);o.ctxtBuilder.itemWidgets[0].ctxtBuilder.itemWidgets[0].remove(k);}else{var l=n,g;a.forEach(n.data.nds,function(u,t){if(u.mdxUnitId===k.mdxUnitId&&n.items[t]!==k){l=n.ctxtBuilder.itemWidgets[t];g=t;return false;}});if(l===r){return ;}if(l.data.et!==I.ANDOR){var q={et:I.ANDOR,fn:Z.FN.AND,nds:[l.data,k]};n.add([q],g+1);n.remove(l.data);}else{l.add([k]);}r.remove(k);}}}());(function(){mstrmojo.requiresCls("mstrmojo.Editor","mstrmojo.Button","mstrmojo.Widget","mstrmojo.Label","mstrmojo.Box","mstrmojo.desc","mstrmojo.css","mstrmojo.hash","mstrmojo.array","mstrmojo.expr","mstrmojo.models.FormatModel","mstrmojo.ui._HasScroller","mstrmojo.threshold.ThresholdRow","mstrmojo.threshold.ConditionWalk","mstrmojo.threshold.PropertyPanel","mstrmojo.threshold.PropertyModel","mstrmojo.threshold.ThresholdRowPanel");var f=mstrmojo.css,U=mstrmojo.hash,e=mstrmojo.expr,J=e.ET,T=e.BRANCH_FNS,Y=mstrmojo.Button.newWebButton,L=mstrmojo.models.FormatModel.getFormatUpdate,g="";var D=mstrmojo.models.FormatModel.ENUM_PROPERTY_NAMES,G=[D.BORDER_TOP_STYLE,D.BORDER_RIGHT_STYLE,D.BORDER_BOTTOM_STYLE,D.BORDER_LEFT_STYLE],Q={0:"none",1:"1pt solid",3:"1pt dashed",4:"1pt dotted",5:"1.5pt solid"};function H(j,l){var k=[];if(l){l.forEach(function(n){var o=n.fmt,m={};U.forEach(o,function(p,q){var r=false;if(G.indexOf(q)===-1){L(q,p,m);}else{if(!o.borderStyle&&!r){L(D.BORDER_STYLE,Q[p],m);}}});j.setAttIdToNDE(n.expr);k.push({n:n.n,scope:n.scope,rtp:n.rtp,rtxt:n.rtxt,expr:mstrmojo.fe.FilterUtils.getExprXml(n.expr),fmt:m});});}return k;}function a(n){var k=this.controller,l=this.model,m=l.thresholds,o=this.metricId,q=m&&m[o],p=l.orgThresholds,j=p&&p[o];k.onSubmitActions(H(l,q),j,o,undefined,-1,n,this.objectType);}function X(j){(j||[]).forEach(function(k){delete k.dmy;var l=k.nds;if(l){X(l);}});}function R(){var m=this.content,j=this.model,q=j.thresholds,l=this,n=[],p=m.rowPanel,o=q&&q[j.metricId],k=0;if(o){o.forEach(function(r){X(r.expr.nds);n.push({scriptClass:"mstrmojo.threshold.ThresholdRow",threshold:r,editor:l,model:j,idx:k++});});}p.destroyChildren(false);p.addChildren(n);this.updateScrollbars();}function d(){var o=this.content.rowPanel,m=o.children,k=(m&&m.length)||0,l=this.model,p=l.thresholds,n=p&&p[l.metricId],j={expr:{et:14,fn:19}};if(!p){p=l.thresholds={};}if(!n){n=p[l.metricId]=[];}n.push(j);o.addChildren([{scriptClass:"mstrmojo.threshold.ThresholdRow",threshold:j,editor:this,model:l,idx:k}]);o.children[k].exprTree.newCondition(null);this.updateScrollbars();}function V(k){var j=this.model,m=j.thresholds,l=m&&m[j.metricId];if(l){l.forEach(function(n){j.toggleThresholdSelected(n,k);});}}function N(n,o){var j=this.controller,k=this.model,l=this.metricId,m=k.selectedThresholds;if(m.length>0){j.onSaveThresholds(H(k,m),l,-1,n,o);}}function K(k){var m="mstrIVE_THRESHOLD_SAVER",j=k.controller.dataService.model,l=mstrmojo.all[m];if(!l){l=new mstrmojo.SaveAsEditor({id:m,zIndex:k.zIndex+1,folderLinksContextId:32,rootFolderID:j.isnew?null:j.pfid,showCompletePath:false,saveParams:{},typeDesc:mstrmojo.desc(null,"Thresholds"),saveAs:function(p){var n=this.contPanel;this.name=n.name.value;this.desc=n.desc.value;if(!this.name){mstrmojo.alert(mstrmojo.desc(3380,"Please enter valid name"));return ;}var q=this.saveParams||{};q.folderId=this.ob.currentFolder.did;q.name=this.name||"New Thresholds";q.saveAsOverwrite=!!p;var o=this.saveAsCallback();o.failure=function(t){var r=t.code,u=this.parent;if(r==="-2147217373"||r==="-2147216857"){mstrmojo.warn(mstrmojo.desc(7986,"The ## '###' already exists. Do you want to replace the existing one?").replace("##",u.typeDesc||"Object").replace("###",u.name),{confirmBtn:{fn:function(){u.saveAs(true);}}},{title:mstrmojo.desc(3179,"Confirm Overwrite"),zIndex:u&&u.zIndex+10});}else{mstrmojo.alert(mstrmojo.desc(7985,"Error while saving: ")+t.message);}};o.parent=this;N.call(k,q,o);}});l.render();}l.open();}function E(l){var q="mstrIVE_THRESHOLD_LOADER",o=mstrmojo.all[q],k=l.controller.dataService.model,p=[72];if(!o){o=new mstrmojo.vi.ui.editors.ObjectPicker({id:q,supportedTypes:mstrmojo.array.hash(p),zIndex:l.zIndex+1,rootFolderID:k.isnew?null:k.pfid,onOpen:function j(){this.browse();},postBuildRendering:function n(){mstrmojo.Editor.prototype.postBuildRendering.apply(this);},OKFn:function(r){if(r){l.controller.onLoadThresholds(l.metricId,r.did);}}});var m=o.ob;m.set("folderLinksContextId",32);m.set("multiSelect",false);m.set("searchVisible",true);m.set("upButtonVisible",true);m.set("browsableTypes","8,"+p.join(","));o.render();}o.open();}mstrmojo.threshold.AdvancedThresholdEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.threshold.AdvancedThresholdEditor",cssClass:"adv-threshold",title:"Advanced Threshold Editor",help:"advanced_thresholds_editor_for_html5_dashboards.htm",model:undefined,targets:undefined,content:undefined,buttonBar:undefined,init:function Z(j){this._super(j);g=this.id;},postBuildRendering:function c(){this._super();var j=this.content;R.call(this);j.conditionWalk.set("editor",this);j.property.set("editor",this);},onOpen:function I(){R.call(this);this.setRowPanelVisibility(true);var j=this.content;j.conditionWalk.set("visible",false);j.property.set("visible",false);var k=this.buttonBar&&this.buttonBar.quickLink;if(!!k){k.set("visible",this.objectType!==12);}},setupScrollNodes:function P(){this.scrollNode=this.content.containerNode;},onClose:function F(){this.model.cleanUp();},onmodelChange:function O(){var j=this.model;if(j){j.attachEventListener("modelEdit",this.id,"onmodelEdit");j.attachEventListener("selectedThresholdsChange",this.id,"onselectedThresholdsChange");R.call(this);}},onselectedThresholdsChange:function b(){},openConditionWalk:function C(j,l){var o=this,p=o.content,q=p.conditionWalk,k=l.tree.parent,m=U.clone(k.threshold),n=q.thresholdRow;m.expr=j;if(n){q.removeChildren(n);}var r=new mstrmojo.threshold.ThresholdRow({alias:"thresholdRow",slot:"conditionNode",idx:k.idx,model:this.model,threshold:m,onclick:mstrmojo.emptyFn});q.addChildren(r);r.render();q.set("objectBrowsingEnabled",o.objectBrowsingEnabled);q.set("targets",o.targets);q.set("targetsLastMod",new Date());q.set("ets",l.tree.validExprTypes);q.set("condition",l);q.set("model",U.clone(j));o.setRowPanelVisibility(false);f.toggleClass(o.content.domNode,"no-overflow",true);q.set("visible",true);q.doLayout();o.toggleButtonStatus(false);this.updateScrollbars();},onmodelEdit:function S(){R.call(this);},openPropertyPanel:function M(j){this.setRowPanelVisibility(false);var l=this.content.property,k=l.model=new mstrmojo.threshold.PropertyModel({thresholdRow:j,threshold:U.clone(j.threshold),gridValueFormat:U.clone(this.model.getGridValueFormat())});this.disposables.push(k);k.attachEventListener("propertyModelChange",j.id,"onpropertyModelChange");l.set("visible",true);this.toggleButtonStatus(false);this.updateScrollbars();},openAndORPopup:function W(m,j){var k=new mstrmojo.ui.menus.MenuConfig();k.hostId=this.id;k.hostElement=j;k.isHostedWithin=false;k.menuCssClass="andor-PopupList";var l=function l(t){var n=m,r=t.ctxt.did,q=r>21?true:null,p=r-(q?21:0);var o=n&&n.parent;if(o&&o.data&&o.data.et===J.ANDOR){o.edit(n,p,q);}else{var u=n&&n.data;if(u&&(u.not!==q)){u.not=q;n.paint();}}};k.addMenuItem(T[19],"",l,{did:19});k.addMenuItem(T[20],"",l,{did:20});k.addMenuItem(T["19_21"],"",l,{did:19+21});k.addMenuItem(T["20_21"],"",l,{did:20+21});this.openPopup(k.newInstance());},toggleButtonStatus:function A(j){this.buttonBar.children.forEach(function(k){k.set("enabled",j);});},setRowPanelVisibility:function B(k){var j=this.content;j.rowPanel.set("visible",k);j.newCondition.set("visible",k);this.updateScrollbars();},children:[{scriptClass:"mstrmojo.Widget",alias:"rulesTitles",markupString:"<div class='rulesTitles'><div class='container'></div><div class='order'>"+mstrmojo.desc(3095,"Order")+"</div><div class='condition'>"+mstrmojo.desc(11890,"Threshold Conditions")+"</div><div class='format'>"+mstrmojo.desc(11891,"Format Preview")+"</div></div>"},{scriptClass:"mstrmojo.Box",cssClass:"content",alias:"content",markupString:'<div id="{@id}" class="mstrmojo-Box {@cssClass}" style="{@cssText}"><div class="scroll-container"></div></div>',markupSlots:{containerNode:function(){return this.domNode.firstChild;}},rowPanel:undefined,newCondition:undefined,conditionWalk:undefined,property:undefined,children:[{scriptClass:"mstrmojo.threshold.ThresholdRowPanel",alias:"rowPanel",children:[]},{scriptClass:"mstrmojo.Label",alias:"newCondition",cssClass:"link",text:mstrmojo.desc(4585,"New Threshold"),onclick:function h(){d.call(mstrmojo.all[g]);}},{scriptClass:"mstrmojo.threshold.ConditionWalk",alias:"conditionWalk",height:"300px",width:"750px",visible:false},{scriptClass:"mstrmojo.threshold.PropertyPanel",alias:"property",visible:false}]},{alias:"buttonBar",scriptClass:"mstrmojo.Box",slot:"buttonNode",children:[Y(mstrmojo.desc(221,"Cancel"),function(){mstrmojo.all[g].close();}),Y(mstrmojo.desc(1442,"OK"),function(){a.call(mstrmojo.all[g],false);mstrmojo.all[g].close();},true),Y(mstrmojo.desc(2031,"Apply"),function(){a.call(mstrmojo.all[g],true);},true),{scriptClass:"mstrmojo.Label",cssClass:"link",alias:"quickLink",text:mstrmojo.desc(14004,"Quick Thresholds Editor..."),onclick:function h(){var l=mstrmojo.all[g],k=l.model,j=l.controller,n=k.isAdvanced(k.metricId),o=function(){l.close();k.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.SIMPLE_EDITOR;},m=[Y(n?mstrmojo.desc(1442,"OK"):mstrmojo.desc(2827,"Clear"),function(){o();j.openEditor();},n,n?undefined:{cssClass:"nosave"})];if(!n){m.push(Y(mstrmojo.desc(2031,"Apply"),function(){o();a.call(l,true);},true));}m.push(Y(mstrmojo.desc(2223,"Cancel")));mstrmojo.warn(n?mstrmojo.desc(13998,"This action will clear the thresholds definition. Do you want to proceed?"):mstrmojo.desc(13999,"Do you want to apply your thresholds before using the Quick Thresholds Editor?"),undefined,{cssClass:n?undefined:"save-threshold-warning",buttons:m});}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo._HasPopup","mstrmojo.Label","mstrmojo.HTMLButton","mstrmojo.ObjectBrowser","mstrmojo.DataGrid","mstrmojo.Editor","mstrmojo.ME._MetricEditorHelper","mstrmojo.ME.ObjectInputBox","mstrmojo.mstr.EnumDSSXMLObjectTypes","mstrmojo.ME.MetricDataService","mstrmojo.ME._HasLevel","mstrmojo.ME._HasSortBy","mstrmojo.ME.FunctionInfo");mstrmojo.requiresDescs(629,2148,3377,9582,12173,12179,12852);var J=mstrmojo.hash,l=mstrmojo.array,M=mstrmojo.expr,h=mstrmojo.ME._MetricEditorHelper,A=mstrmojo.ME.MetricDataService,c=mstrmojo.mstr.EnumDSSXMLObjectTypes,o=mstrmojo.ME.Enum.DYNAMIC_DIMTY,O=mstrmojo.ME.Enum.UI_OBJECT_TYPE;var U,X;var e=function(E){if(E.onmetricModify){E.onmetricModify();}},b=function(){if(X.updateScrollbars){X.updateScrollbars();}};var Y=mstrmojo.ME.MetricToken.brackets,L=mstrmojo.ME.MetricToken.quotes,Z=mstrmojo.ME.MetricToken.unquotes;var d=function(){var E={"9C374236DD9F11D3B98100C04F2233EA":"Forecast","9C374233DD9F11D3B98100C04F2233EA":"Growth","9C374233DD9F11D3B98100C04F2233EA":"Trend","677E93B2786B11D4B82F00C04F356781":"Case",C41C34F0786B11D4B82F00C04F356781:"CaseV",B2C0FA4420C711D6AD1400C04F0423DE:"IF","8107C324DD9911D3B98100C04F2233EA":"Not"};return E.hasOwnProperty(this.fctOi.did);};var g=function(t){var r=t.split(",")[0],q=r.replace(/\d$/,""),E=r.replace(q,"");return{prefix:q,startAt:parseInt(E,10)};};var G=function(z){var x=function(){if(z.isRepeated){var w=this.parent.dataGrid.ctxtBuilder.itemWidgets[this.parent.idx].labelWidget;if(w){w.set("count",this.getSelectedObjects().length);}}};var q=X.getParamObjectTypes();var E={scriptClass:"mstrmojo.Table",cssClass:"funcParam",layout:[{cells:[{cssText:"width: 338px"},{}]}],children:[{scriptClass:"mstrmojo.ME.ObjectInputBox",alias:"paramInput",slot:"0,0",cssClass:"mstrmojo-ME-param",dtp:z.dtp,isDME:X.isDME,hideEditButton:function(w){return true;},hideDelButton:function(w){return this.isFull;},hidePulldownButton:function(){return this.parent.dataGrid.parent.tbBrowsable;},hideItemWidgetBrowseButton:function(){return !this.parent.dataGrid.parent.tbBrowsable;},browsableTypes:q.concat([M.TP.FOLDER]).join(","),folderLinksContextId:17,emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(3377,"Object").toLowerCase()),getCandidatesThroughTaskCall:function v(AA,w){AA.objectType=q.join(",");AA.rootFolderType=39;AA.blockCount=this.blockCount;mstrmojo.ME.MetricDataService.getMetricComponents(AA,w);},postCreate:function(AD){var AC=this.parent.dataGrid,AF=AC&&AC.parent;this.noCache=AF.noCache;if(!this.noCache){this.candidates=AF.getCandidates(function(AG){return mstrmojo.array.indexOf(q,AG.t)>-1;});var w=this.candidates.items||[];if(X.isDME){w=X.replaceAttributeWithForms(l.filter(w,function(AG){return l.indexOf(q,AG.t)>-1&&AG.st!==M.STP.NDE;}));}for(var AB=0,AA=(z.items||[]).length;AB<AA;AB++){var AE=z.items[AB];if(AE&&AE.t===mstrmojo.ME.Enum.UI_OBJECT_TYPE.Sub_Expression){w.push(AE);}}this.candidates.items=w;if(!AD){AC.candidatesListener.push(this.id);}}if(!AD){this.set("items",z.items);}},onitemchange:function(){e(this.parent.dataGrid.parent);},onadd:function r(){x.call(this);},onremove:function u(){x.call(this);},obCfg:{folderLinksContextId:17,browsableTypes:q.concat([M.TP.FOLDER]).join(",")}}],getTokens:function(){var AC=this.paramInput.getSelectedObjects(),AD,w=AC.length,AB,AE=[],AA;if(w>0){for(AB=0;AB<w;AB++){AD=AC[AB];if(AD.state===mstrmojo.Enum_OIB_States.VALID&&AD.did){if(AD.t===O.Sub_Expression){AE=AE.concat(AD.tks);}else{AA={v:Y(AD.n)};if(AD.t===21){AA.oi=AD.oi;AA.exv=AD.fmdid||AD.exv;AA.extp=8;AA.v=AD.fnm?Y(AD.oi.n)+"@"+Y(AD.fnm):AA.v;}else{AA.oi=AD;}AE.push(AA);}}else{AA={v:L(z.dtp,AD.n)};AE.push(AA);}AE.push({v:mstrmojo.ME.MetricToken.argDelimiter,isDelimiter:true});}AE.pop();}return AE;}};var t=E.children&&E.children[0];if(!z.isRepeated){t.cssClass="mstrmojo-ME-ObjectInputBox-param singleObject noVerify";t.maxObjectCount=1;}else{t.cssClass="mstrmojo-ME-ObjectInputBox-param noVerify";}return E;};var C=function(r){var q=mstrmojo.all[U];var E=null;if(r.isParam){E=q.getParamWidget(r);}else{switch(r&&r.dtp){case 11:E={scriptClass:"mstrmojo.Pulldown",cssClass:"bool mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:[{n:"False",did:"0"},{n:"True",did:"-1"}],popupToBody:true,itemIdField:"did",postCreate:function(t){var u=this.data;this.value=!!u.v?(u.v==="False"?0:-1):(u.dfv||0);},getTokens:function(){var t=this.data;if(this.value!==t.dfv){return[{v:t.n},{v:"=",isDelimiter:true},{v:this.value=="-1"?"True":"False"}];}return[];},onvalueChange:function(){e(this.parent.dataGrid.parent);}};break;case -2:E=q.getBreakByWidget(r);break;case -1:E=q.getSortByWidget(r);break;default:E=q.getTextWidget(r);break;}}E.alias="inputWidget";return E;};var W=function(t,E,q){var r={scriptClass:"mstrmojo.ui.List",alias:"labelWidget",cssClass:"mstrmojo-FunctionWidzard-labels",count:t.items&&t.items.length||0,buildItems:function(){var u=[],w=this.count,z=(t.isParam?"*":"")+":",x=t.np;if(x){for(var v=0;v<=w;v++){u.push({n:x.n+(x.startAt+v)+z,title:t.desc||""});}}else{u.push({n:(t.dn||t.n)+z,title:t.desc||""});}this.set("items",u);},postCreate:function(){this.buildItems();},oncountChange:function(){this.buildItems();}};return r;};var P=function(u){var q=mstrmojo.all[U];return{scriptClass:"mstrmojo.ME.ObjectInputBox",alias:"breakByInput",cssClass:"mstrmojo-ME-breakby",isDME:q.isDME,dtp:u.dtp,emptyText:mstrmojo.desc(12179,"Search for #").replace("#",mstrmojo.desc(2148,"Attribute").toLowerCase()),folderLinksContextId:16,browsableTypes:[M.TP.FOLDER,M.TP.ATTR].join(","),getCandidatesThroughTaskCall:function t(w,v){w.rootFolderType=39;w.blockCount=w.blockCount||this.blockCount;mstrmojo.ME.MetricDataService.getAttributes(w,v);},obCfg:{folderLinksContextId:16,browsableTypes:[M.TP.ATTR,M.TP.FOLDER].join(",")},postCreate:function(x){var v=this.parent.dataGrid,z=v&&v.parent;this.noCache=z.noCache;if(!this.noCache){this.candidates=z.getCandidates(function(AC){return AC.t===c.Attribute||AC.t===c.Consolidation;});if(this.isDME){this.candidates.items=o.getItems("breakby").concat(this.candidates.items);}if(!x){v.candidatesListener.push(this.id);}}if(!x){var w=u.items||[],AA=q.oi.tks,AB=!AA.met||AA.items&&(AA.items.length===0);if(AB&&this.isDME){w.push(o.getAutomaticDimtyObject());}this.set("items",w);}},onitemchange:function(){e(this.parent.dataGrid.parent);},onadd:function E(){b();},onremove:function r(){b();},hidePulldownButton:function(){return this.parent.dataGrid.parent.tbBrowsable;},hideItemWidgetBrowseButton:function(){return !this.parent.dataGrid.parent.tbBrowsable;},getTokens:function(){var z=this.getSelectedObjects(),v=z.length,x,AB=[];if(v>0){AB.push({v:"BreakBy"});AB.push({v:"=",isDelimiter:true});AB.push({v:"{",isDelimiter:true});for(x=0;x<v;x++){var AA=z[x],w;if(h.isDimty(AA.n)){w={v:AA.n};}else{if(/^@/.test(AA.did)){w={v:AA.did};}else{w={v:Y(AA.n),oi:AA};}}AB.push(w);if(x!==(v-1)){AB.push({v:",",isDelimiter:true});}}AB.push({v:"}",isDelimiter:true});}return AB;}};};var F=function(t,u){var q=t.length,E;for(E=0;E<q;E++){var r=mstrmojo.array.find(t[E].fns,"n",u);if(r>-1){return J.clone(t[E].fns[r]);}}return null;};var S=function(r,t){var q,E=t.length,u=r&&r.length;if(u>0){for(q=0;q<u-1;q++){r[q].items=[t[q]];r[q].dynamicVerify=true;}r[u-1].items=[];for(q=u-1;q<E;q++){r[u-1].items.push(t[q]);r[u-1].dynamicVerify=true;}}return r;};var N=function(q,r,v){var u={items:[]},t={301:"}",302:")"}[v],E=r[++q];while(E){if(E.oi){if(v==302){E.oi.selFrm=E.exv;E.oi.asc=E.asc;}u.items.push(E.oi);}if((E=r[++q]).v===t){break;}}return u;};mstrmojo.ME.FunctionWizard=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ME._MetricEditorHelper,mstrmojo.ME._HasLevel,mstrmojo.ME._HasSortBy],{scriptClass:"mstrmojo.ME.FunctionWizard",cssClass:"mstrmojo-Editor-me mstrmojo-FunctionWidzard",title:mstrmojo.desc(9582,"Function Editor: "),help:"Function_Arguments_dialog_box.htm",fctOi:null,fctArgs:null,fctArgsDataGridCssClass:"functionArgs",fctSyntax:"",fctDesc:"",hiddenPs:[],bindings:{candidates:"this.opener.candidates"},getParamObjectTypes:function f(){var E=[M.TP.METRIC,M.TP.FACT];if(this.isAgg(this.fctOi)){E.push(M.TP.ATTR);}return E;},getCandidates:function R(r){var q=this.candidates,E;if(q){E=mstrmojo.array.filter(q.items,r);return{items:E,isComplete:q.isComplete};}return{};},_set_candidates:function(w,q){this.candidates=q;if(this.hasRendered&&this.visible){var t=this.argsGrid,u=t.candidatesListener,E=u.length,r;for(r=0;r<E;r++){if(mstrmojo.all[u[r]]){mstrmojo.all[u[r]].postCreate(true);}}}if(this._super){this._super(w,q);}return true;},postProcessParamsFromToken:function(t){if(this.refOi&&this.candidates){var u=this.refOi.did;this.refOi=mstrmojo.array.filterOne(this.candidates.items,function(z){return z.did===u;});}var x=[],v,r,q=t.pars,E=(q&&q.length)||0;for(r=0;r<E;r++){v=J.copy(q[r]);v.isParam=true;if(r===0&&this.refOi){v.items=[this.refOi];this.refOi=null;}x.push(v);}if(t.rpc>0&&!d.call(this)){v.isRepeated=true;var w=g(v.n);v.np={n:w.prefix,startAt:w.startAt||1};}return x;},postProcessProsFromToken:function(t){var u=[],r,E=(t.pros&&t.pros.length)||0,q=function(v){if(l.indexOf(mstrmojo.ME.Enum.NonExposableParams,v.n)>-1){v.itemCss="hidden";}return v;};for(r=0;r<E;r++){u.push(q(J.copy(t.pros[r])));}return u;},buildSyntax:function(r){var q=[],t,E;q.push(r.n);q.push("(");E=(r.pars&&r.pars.length)||0;for(t=0;t<E;t++){q.push(r.pars[t].n);if(t!==(E-1)){q.push(", ");}}q.push(")");return q;},onOpen:function(){U=this.id;this._setupCandidatesCache();var r=this.getArgsFromTokens();var u=this,t=r||this.fctOi;var E=this.buildSyntax(t),v=this.postProcessParamsFromToken(t);v=v.concat(this.postProcessProsFromToken(t));if(t.sqt===5){v.push({n:"BreakBy",dn:mstrmojo.desc(12173,"Break By"),dtp:-2,desc:"Break By is a parameter representing the break by levels for this function.",items:t.bb&&t.bb.items});}if(t.ios){v.push({n:"SortBy",dn:mstrmojo.desc(12852,"Sort By"),dtp:-1,desc:"Sort By is a parameter representing the sort by levels for this function.",items:t.sb&&t.sb.items});}v=v.concat(this.hiddenPs||[]);u.set("fctArgs",v);u.set("fctSyntax",E.join(""));u.set("fctDesc",mstrmojo.ME.FunctionInfo.getDescAndExample(this.fctOi).desc+"  "+mstrmojo.ME.MetricDataService.getFunctionHelpTopic(t.h));u.set("title",this.insertMode?t.n:mstrmojo.desc(9582,"Function Editor: ")+" "+this.oi.n);u.set("fctName",t.n);this.raiseEvent({name:"fctDidChange",did:this.fctOi.did});this.set("isAggFunction",this.isAgg());this.set("ios",t.ios);if(this._super){this._super();}if(this.isAggFunction){var q=this.argsGrid.ctxtBuilder.itemWidgets;if(q&&q.length>0){this.metricLCT.set("labelWidth",q[0].labelWidget&&q[0].labelWidget.domNode.clientWidth+"px");}}},getArgsFromTokens:function Q(){if(!this.oi||this.oi.tks.items.length===0){return null;}var t={},v=this.oi.tks.items,AK=v.length,AF=[],q=[],AE=0,E=[],AJ;for(AJ=0;AJ<AK;AJ++){var x=v[AJ],r=x.tp,AM=x.sctt;if(mstrmojo.ME.MetricToken.isDelimiter(x.v)&&(x.v!=="("&&x.v!==")")||x.v==="&gt;"||x.v==="&lt;"){continue;}switch(AM){case 65536:t.n=x.oi?x.oi.n:x.v;var z=this.fctOi=F(this.functions,t.n);AF=z.pars||[];q=z.pros||[];t.rpc=z.rpc;t.sqt=z.sqt;t.ios=z.ios;break;case 196608:var AI=[],AD=[],AB,AH,AG;x=v[++AJ];while(x&&(x.sctt===196608||x.sctt===196609)){if(x.sctt===196608){AD.push(x);}else{AI.push(AD);AD=[];}x=v[++AJ];}AI.push(AD);AI[AI.length-1].pop();for(AG=0;AG<AI.length;AG++){AD=AI[AG];var u={n:""};AB=AD.length;if(AB===1){x=AD[0];if(x.extp){u={n:x.v,did:x.oi.did+"@"+x.exv,exv:x.exv,extp:x.extp,oi:x.oi,t:21,tk:x};}else{var AC=Math.min(AF.length-1,E.length),AL=Z(x,x.v,AF[AC].dtp);u=x.oi||{n:AL,v:AL};}}else{for(AH=0;AH<AB;AH++){u.n+=AD[AH].v;}u.v=u.n;u.did=u.n;u.t=O.Sub_Expression;u.tks=AD;}E.push(u);}break;case 131072:if(r==301){var AA={};x=v[++AJ];while(x){if(x.tp!=282){if(x.oi){AA.items=AA.items||[];AA.items.push(x.oi);}else{if(x.tp===64){AA.items=AA.items||[];var w=x.v+v[++AJ].v;x=v[AJ+1];if(x.tp===43||x.tp===45){w+=v[++AJ].v;w+=v[++AJ].v;}AA.items.push(o.getDimtyObject(w,this.isDME));}}}if((x=v[++AJ])["v"]==="}"){break;}}t.bb=AA;}else{if(r==302){t.sb={};}else{if(r==259){mstrmojo.array.forEach(q,function(AP){if(AP.n===v[AJ].v){AJ=AJ+2;var AO=v[AJ],AN=[];do{AN.push(v[AJ++].v);if(v[AJ].sctt===131072&&v[AJ].tp===62||v[AJ].sctt===131073){break;}}while(true);AN=AN.join("");AN=Z(AO,AN,AP.dtp);AP.v=AN;return false;}});}}}break;}}t.pars=S(AF,E);t.pros=q;return t;},getTokens:function H(){var t=this.argsGrid.ctxtBuilder.itemWidgets,x=t.length,v,AC,z=[],r=[],AD=[],AA,u,q,E,AB=this.fctOi;for(v=0;v<x;v++){AC=t[v].inputWidget;if(AC.data.isParam){r.push(AC.getTokens());}else{z.push(AC.getTokens());}}AD.push({v:AB.n,oi:AB});x=z.length;if(x>0){E=false;AD.push({v:"<",isDelimiter:true});for(v=0;v<x;v++){AA=z[v];q=AA.length;if(q===0){continue;}E=true;for(u=0;u<q;u++){AD.push(AA[u]);}AD.push({v:",",isDelimiter:true});}AD.pop();if(E){AD.push({v:">",isDelimiter:true});}}x=r.length;AD.push({v:"(",isDelimiter:true});E=false;for(v=0;v<x;v++){AA=r[v];q=AA.length;if(q===0){continue;}E=true;for(u=0;u<q;u++){AD.push(AA[u]);}AD.push({v:mstrmojo.ME.MetricToken.argDelimiter,isDelimiter:true});}if(E){AD.pop();}AD.push({v:")",isDelimiter:true});for(v=0,x=AD.length;v<x;v++){AD[v].isNew=true;}return AD;},getMetricDefAsTokens:function p(){var E=this.getTokens();if(this.getLCTDefAsTokens){E=E.concat(this.getLCTDefAsTokens());}return E;},handleValidation:function n(u){if(u&&!u.rjec){return ;}var t=u&&u.rjec==="-2147214846";if(t){var q=u.items,v=mstrmojo.array.find(q,"sta",-1),E=q[v].v;mstrmojo.alert('More than one object with the name "#" found. Browse to select the object or retype to select it from the search autocomplete list.'.replace("#",E));}else{mstrmojo.alert(u&&u.rjed);}},getPROPBuilder:function a(){return W;},getDTPBuilder:function j(){return C;},getParamWidget:function B(E){return G(E);},getBreakByWidget:function T(E){return P(E);},getSortByWidget:function k(E){return this._super();},getTextWidget:function V(E){return{scriptClass:"mstrmojo.TextBox",cssClass:"mstrmojo-functionArgs-textInput",postCreate:function(q){var r=this.data;this.value=r.v||((r.dfv||r.dfv===0)?r.dfv:"");},getTokens:function(){var q=this.data;if(!mstrmojo.string.isEmpty(this.value)&&this.value!==q.dfv){return[{v:q.n},{v:"=",isDelimiter:true},{v:L(q.dtp,this.value)}];}return[];},onvalueChange:function(){e(this.parent.dataGrid.parent);}};},getDataGridRef:function D(){return{scriptClass:"mstrmojo.DataGrid",alias:"argsGrid",cssClass:this.fctArgsDataGridCssClass,makeObservable:true,banding:false,columns:[{headerText:"Property Name",dataWidgetBuilder:this.getPROPBuilder(),colCss:"name"},{headerText:"Property Type",dataWidgetBuilder:this.getDTPBuilder(),colCss:"dtp"}],postCreate:function(){this.candidatesListener=[];},bindings:{items:"this.parent.fctArgs"},onadd:function(){b();}};},init:function m(E){this.children=this.getChildren();this._super(E);U=this.id;X=this;},isAgg:function K(E){return(E||this.fctOi||{}).sqt===1;},getChildren:function I(){return[mstrmojo.ME._MetricEditorHelper.formatAndOptionsBarRef,mstrmojo.ME._MetricEditorHelper.nameEditBoxRef,mstrmojo.ME._MetricEditorHelper.functionNameRef,this.getDataGridRef(),this.getLCTComponent(),{scriptClass:"mstrmojo.Label",slot:"buttonNode",cssClass:"mstrmojo-FE-functionSyntax",bindings:{visible:"this.parent.insertMode",text:function(){return this.parent.fctSyntax;}}},{scriptClass:"mstrmojo.Label",slot:"buttonNode",cssClass:"mstrmojo-FE-functionDesc",allowHTML:true,bindings:{visible:"this.parent.insertMode || this.parent.simplex",text:function(){return this.parent.fctDesc;}}},mstrmojo.ME._MetricEditorHelper.switchRef,mstrmojo.ME._MetricEditorHelper.buttonBarRef];}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.expr","mstrmojo.ui._HasScroller","mstrmojo.SearchableDropDownList","mstrmojo.ME.FunctionWizard","mstrmojo.ME._DerivedMetricEditorHelper");mstrmojo.requiresDescs(3377,11569,12179);var A,C;mstrmojo.ME.DerivedFunctionWizard=mstrmojo.declare(mstrmojo.ME.FunctionWizard,[mstrmojo.ME._DerivedMetricEditorHelper,mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.DerivedFunctionWizard",init:function F(G){mstrmojo.css.addWidgetCssClass(this,"dme");this._super(G);A=this.id;C=this;},setupScrollNodes:function E(){this.scrollNode=this.containerNode;},onOpen:function B(){this._super();if(this.updateScrollbars){this.updateScrollbars();}},getParamObjectTypes:function D(){var G=this.opener||{};return G.getValidFuncParamTypes?G.getValidFuncParamTypes(this.fctOi):this._super();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.hash","mstrmojo.threshold.ThresholdModel","mstrmojo.threshold.SimpleThresholdEditor","mstrmojo.threshold.AdvancedThresholdEditor");var E=mstrmojo.hash,A="mstrmojo-simple-threshold-editor",C="mstrmojo-advanced-threshold-editor",G=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES;mstrmojo.threshold.ThresholdController=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.threshold.ThresholdController",metricId:undefined,data:undefined,model:undefined,targets:undefined,editor:undefined,messageId:undefined,datasets:undefined,dataService:undefined,onSubmitActions:mstrmojo.emptyFn(),onSaveThresholds:mstrmojo.emptyFn(),onLoadThresholds:mstrmojo.emptyFn(),supportsFeature:function F(H){return true;},init:function D(H){this._super(H);this.model=new mstrmojo.threshold.ThresholdModel({controller:this});},openEditor:function B(){var L=this.data;if(!L){throw new Error("Visualization data not provided.");}var I=this.metricId,H=this.objectType,M=this.model,P=this.messageId,N;M.set("data",E.clone(L));M.metricId=I;M.objectType=H;var O=M.isAdvanced(I),J=M.editorMode,K=J===G.SIMPLE_EDITOR;if(J===G.ADVANCED_EDITOR||(!K&&O)){N=mstrmojo.all[C]||new mstrmojo.threshold.AdvancedThresholdEditor({id:C,onUpdateBrowseElementsParams:function Q(T){var S,R=this.controller.datasets,U=function(V){return V.did===T.attributeID;};for(S in R){if(R[S].att.filter(U).length>0){T.datasetID=S;break;}}T.messageID=P;T.templateNodeKey=L.k;}});}else{if(O){M.clearData();}N=mstrmojo.all[A]||new mstrmojo.threshold.SimpleThresholdEditor({id:A});}this.editor=N;N.set("model",M);N.set("controller",this);N.set("metricId",I);N.set("objectType",H);N.set("title",this.title);N.set("targets",this.targets);N.open();this.addDisposable([M,N]);}});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.array","mstrmojo.css","mstrmojo.expr","mstrmojo.ValidationTextBox","mstrmojo.HBox","mstrmojo.ui.menus.EditorConfig","mstrmojo.mstr.EnumFunction","mstrmojo.DropDownList","mstrmojo.ui.Pulldown","mstrmojo.SearchablePulldown","mstrmojo.ButtonList","mstrmojo.Box","mstrmojo.Label","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.EditableLabel","mstrmojo.CheckBox","mstrmojo.fe.FilterEditor","mstrmojo._FormatDefinition","mstrmojo.num","mstrmojo.locales","mstrmojo.vi.models.VIComponentMap","mstrmojo.func","mstrmojo.dom","mstrmojo.ME.AttributeEditBox","mstrmojo.string","mstrmojo.dom","mstrmojo.models.datasets.DataInterface","mstrmojo.chart.model.enums.EnumDSSObjectType","mstrmojo.vi.ui.editors.ObjectPicker","mstrmojo.vi.ui.editors.AttributeLinkEditor","mstrmojo.vi.ui.NumberFormatter");mstrmojo.requiresDescs(1442,1885,1886,2022,2122,2123,2124,2125,2126,2127,2128,2129,2130,2131,2132,3993,4564,11494,11495,11496,11497,14612);var m=mstrmojo.mstr.EnumFunction,X=mstrmojo.hash,p=mstrmojo.array,AE=mstrmojo.expr.ET,D=mstrmojo.css,V=mstrmojo.dom,t=mstrmojo.Button.newWebButton,S=mstrmojo.ME.MetricToken.brackets,T=mstrmojo._FormatDefinition,n=mstrmojo.models.datasets.DataInterface,K=mstrmojo.vi.models.VIComponentMap.TYPES,U=mstrmojo.chart.model.enums.EnumDSSObjectType;var Y={SUM:mstrmojo.desc(2131,"Sum"),ADD:mstrmojo.desc(6017,"Add"),AVG:mstrmojo.desc(2122,"Average"),MAX:mstrmojo.desc(2125,"Maximum"),GST:mstrmojo.desc(5869,"Greatest"),MIN:mstrmojo.desc(2127,"Minimum"),LST:mstrmojo.desc(5868,"Least"),CNT:mstrmojo.desc(2123,"Count"),MTP:mstrmojo.desc(5418,"Multiply"),STD:mstrmojo.desc(2130,"Standard Deviation"),PTD:mstrmojo.desc(11494,"Population Standard Deviation")},c={SUM:{n:Y.SUM,t:m.FunctionSum},ADD:{n:Y.ADD,t:m.FunctionPlus},AVG:{n:Y.AVG,t:m.FunctionAvg},MAX:{n:Y.MAX,t:m.FunctionMax},GST:{n:Y.GST,t:m.FunctionGreatest},MIN:{n:Y.MIN,t:m.FunctionMin},LST:{n:Y.LST,t:m.FunctionLeast},TMS:{n:Y.MTP,t:m.FunctionTimes},CNT:{n:Y.CNT,t:m.FunctionCount},GEM:{n:mstrmojo.desc(2124,"Geometric Mean"),t:m.FunctionGeomean},MED:{n:mstrmojo.desc(2126,"Median"),t:m.FunctionMedian},MOD:{n:mstrmojo.desc(2128,"Mode"),t:m.FunctionMode},PDT:{n:mstrmojo.desc(2129,"Product"),t:m.FunctionProduct},STD:{n:mstrmojo.desc(2130,"Standard Deviation"),t:m.FunctionStdev},VAR:{n:mstrmojo.desc(2132,"Variance"),t:m.FunctionVar}},Z=[{n:Y.SUM,t:m.FunctionOLAPSum},{n:Y.AVG,t:m.FunctionOLAPAvg},{n:Y.MIN,t:m.FunctionOLAPMin},{n:Y.MAX,t:m.FunctionOLAPMax},{n:Y.CNT,t:m.FunctionOLAPCount}],AF=[{n:Y.SUM,t:m.FunctionOLAPSum},{n:Y.AVG,t:m.FunctionOLAPAvg},{n:Y.MIN,t:m.FunctionOLAPMin},{n:Y.MAX,t:m.FunctionOLAPMax},{n:Y.CNT,t:m.FunctionOLAPCount}],M=[{n:mstrmojo.desc(1058,"Previous"),t:m.FunctionLag},{n:mstrmojo.desc(1059,"Next"),t:m.FunctionLead},{n:mstrmojo.desc(4046,"First"),t:m.FunctionFirst},{n:mstrmojo.desc(4049,"Last"),t:m.FunctionLast}];function e(AJ,AL,AK,AH){return{scriptClass:"mstrmojo.ui.Pulldown",items:AJ,selectedIndex:AL,onitemSelected:function AI(AM){var AN=this.parent;while(!AN.data||!AN.data[AK]){AN=AN.parent;}AN.data.set(AK,AH?AH(AM):AM.v);}};}function u(AI,AH){return{scriptClass:"mstrmojo.Box",cssClass:"breakByBox",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13903,"Break by:")},e(AI,AH,"breakBy",function(AJ){return{id:AJ.did,type:AJ.t,dmy:AJ.dmy};})]};}function AC(AK){var AL=AK.metrics,AM=AK.propName,AJ=AK.optionValueField||"id",AH=p.find(AL,AJ,AK.value),AN=function AN(AP){var AO=this.parent;while(!AO.data||!AO.data.hasOwnProperty(AM)){AO=AO.parent;}AO.data.set(AM,AP?{id:AP[AJ],type:4}:{cst:this.text});};return{scriptClass:"mstrmojo.ui.SearchablePulldown",items:AL,selectedIndex:AH,useRichTooltip:true,bindings:AK.bindings,valid:true,allowCustomText:true,allowEmptyText:true,onvalidChange:function AI(){mstrmojo.css.toggleClass(this.domNode,"invalid",!this.valid);if(this.hasRendered){this.hideTooltip();this.showTooltip();}},updateTooltipConfig:function(){if(this.valid){this.richTooltip=null;return ;}this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-C vi-calculation-warning",left:this.domNode.offsetWidth+12,top:this.domNode.offsetHeight+5,refNode:this.domNode,content:mstrmojo.desc(13819,"Invalid input")};},onitemSelected:AN,onTextEditComplete:function(){AN.call(this,this.items[this.selectedIndex]);},onPopupWidgetOpened:function(){this.set("valid",true);},postkeyup:AK.postkeyup};}function R(AK,AJ,AI){if(AK&&AK.datap){var AH=p.filterOne(AK.datap,function(AM){return AM.tbid===AJ;}),AL=AH&&AH.maps.amps;return p.filterOne(AL,function(AM){return AI===AM.aimp.atid;});}return null;}function h(AH,AL){var AJ=p.filterOne(AH&&AH.afmps,function(AM){return AM.fmid===AL;}),AK=AJ&&(AJ.sqc?AJ:AJ.col.oi),AI;if(AK&&AK.sqc){AI={did:AK.sqc.id,n:mstrmojo.string.decodeHtmlString(AK.cln),coldtp:AK.sqc.dt.tp,georole:AK.geo,timerole:AK.tim,der:AK.sqc.der};}else{if(AK){AI={did:AK.did,n:mstrmojo.string.decodeHtmlString(AK.def.cln),coldtp:AK.def.dt.tp,georole:AJ.geo,timerole:AK.def.dicl.time,der:AK.def.dicl.der};}}return AI;}function C(AI,AH,AK){var AJ={success:function(AL){if(AL&&AL.msgid){mstrApp.serverRequest({taskId:"qBuilder.GetReportXDADefinition",msgid:AL.msgid,bindingflag:2,previewflag:261,browsetype:5},AK);}},failure:function(AL){mstrApp.onerror(AL);}};mstrApp.serverRequest({taskId:"duplicateReportInstance",datasetID:AH,messageID:AI},AJ);}function I(AM,AN,AK){var AI=AM.srcTableId,AP=AM.tgtTableId,AH,AL,AJ=function(AT,AS){var AV="<mpcs><mpc ",AR,AU;for(AR in AS){AU=AS[AR];AV+='$ACT="$VAL" '.replace("$ACT",AR).replace("$VAL",AU);}AV+="/></mpcs>";return{act:"changeEMMAMapping",tbid:AT,dsid:AM.dsid,mapping:AV};},AQ=function(AT){var AU={success:function(){AO();}},AS,AR;AH=R(AT,AI,AM.srcId);AL=R(AT,AP,AM.tgtId);AS=h(AH,AH.afmps[0].fmid);AR=[AJ(AI,{did:AS.did,oid:AL.aimp.atid,fg:1})];AN.getDataService().submitUpdates(AR,AU);},AO=function(){var AR=[],AU={},AS,AT;if(!AH||!AL){return ;}AU[AI]={};AU[AP]={};p.forEach(AH.afmps,function(AY){var AW=p.find(AL.afmps,"fmid",AY.fmid),AZ,AX,AV;if(AW>=0){AS=h(AH,AY.fmid);AT=h(AL,AY.fmid);if(AS.georole!==AT.georole){AV=(AS.georole===0)?AI:AP;AZ=(AS.georole===0)?AS.did:AT.did;AX=AS.georole||AT.georole;AU[AV][AZ]=X.copy({did:AZ,georole:AX},AU[AV][AZ]);}if(AS.timerole!==AT.timerole){AV=(AS.timerole===0)?AI:AP;AZ=(AS.timerole===0)?AS.did:AT.did;AX=AS.timerole||AT.timerole;AU[AV][AZ]=X.copy({did:AZ,timerole:AX},AU[AV][AZ]);}if(AS.der!==AT.der){AX=AS.der|AT.der;AU[AI][AS.did]=X.copy({did:AS.did,drvflg:AX},AU[AI][AS.did]);AU[AP][AT.did]=X.copy({did:AT.did,drvflg:AX},AU[AP][AT.did]);}}});X.forEach(AU,function(AV,AW){X.forEach(AV,function(AX){AR.push(AJ(AW,AX));});});AS=h(AH,AH.afmps[0].fmid);AR.push(AJ(AI,{did:AS.did,oid:AL.aimp.atid}));if(AK){AK(AR);}};C(AN.mid,AM.dsid,{success:AQ});}function W(AM,AJ,AI,AN){var AH=0,AL=[],AK=function(AO){var AP=AI[AH-1];if(AO&&AO.tks&&AP){AL.push({fid:AP.fid,fnm:AP.fnm,ftk:AO.tks.items});}if(AH===AI.length){AN(AL);return ;}AP=AI[AH++];mstrmojo.ME.MetricDataService.validateMetric({metricId:AJ,formID:AP.fid,objectType:12,tokenStreamXML:"",metricXML:"",msgID:AM},{success:AK});};AK();}function x(AH,AI){return{v:S(AH.n)+"@"+S(AI.fnm),tp:275,lv:1,exv:AI.fid,extp:8,oi:{did:AH.did,t:AH.t,n:AH.n}};}mstrmojo.vi.ui.DatasetUnitMenuUtils=mstrmojo.provide("mstrmojo.vi.ui.DatasetUnitMenuUtils",{getAvailableShortcutMetricFunctionsGroup:function AB(AH){return{"12":[[c.AVG,c.CNT,c.MAX,c.MIN,c.STD,c.SUM,c.VAR]],"4":[[c.SUM,c.AVG,c.MIN,c.MAX,c.CNT],[c.GEM,c.MED,c.MOD,c.PDT,c.STD,c.VAR]]}[AH.t];},isAmongFunctions:function A(AI,AH){return AH.some(function(AJ){return AJ.some(function(AK){return AK.t===AI;});});},getMultiSelectionShortcutMetricFunctions:function J(AH){var AI=true;p.forEach(AH,function(AJ){if(4!==AJ.t){AI=false;return false;}return true;});return AI?[c.ADD,c.AVG,c.GST,c.LST,c.TMS]:[];},getRelativeReferenceMenu:function b(AL,AJ,AO,AH){var AK=0,AI=M[AK],AN=0,AM=AO&&AO[AN];return new mstrmojo.ui.menus.EditorConfig({data:{item:AL,relativeRef:AI,breakBy:AM},cssClass:"RelativeReference-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",cssClass:"funcBox",children:[{scriptClass:"mstrmojo.Label",visible:AJ&&AJ.length,text:AJ},e(M,AK,"relativeRef",function(AP){return AP.t;})]},u(AO,AN)],fnOk:function(AP){return AH(AP.item,AP.relativeRef,[AP.breakBy]);}});},getMovingTotalMenu:function B(AR,AL,AN){var AS=1,AK=AF[AS].t,AM=1,AI=mstrmojo.desc(13289,"Starting previous##rows").split("##"),AQ=0,AJ=AL&&AL[AQ];return new mstrmojo.ui.menus.EditorConfig({cssClass:"MovingTotal-MenuEditor",data:{item:AR,funcType:AK,windowSize:AM,breakBy:AJ},contents:[e(AF,AS,"funcType",function(AT){return AT.t;}),{alias:"winSzBox",scriptClass:"mstrmojo.HBox",children:[{scriptClass:"mstrmojo.Label",cssClass:"WinSzPrefix",text:AI[0]},{alias:"winSz",scriptClass:"mstrmojo.ValidationTextBox",required:true,dtp:mstrmojo.expr.DTP.INTEGER,constraints:{trigger:mstrmojo.validation.TRIGGER.ALL,min:1},postCreate:function AP(){this.set("value",AM);},_ontooltipover:function(){var AT=mstrmojo.all[this.id];AT._hovered=true;AT.showTooltip();},_ontooltipout:function(){var AT=mstrmojo.all[this.id];AT._hovered=false;AT.hideTooltip();},useRichTooltip:true,tooltipOpenDelay:0,onInvalid:function(){var AT=this.validationStatus.msg,AU=!(this.richTooltip&&AT===this.richTooltip.content);this.richTooltip={posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-warning vi-tooltip-V",top:-5,refNode:this.domNode,content:AT};if(this._hovered&&AU){this.hideTooltip();this.showTooltip();}},onValid:function(){this.richTooltip=null;this.hideTooltip();},postvalueChange:function AO(){var AT=this.isValid();this.parent.parent.popupConfig.data.set("windowSize",AT?parseInt(this.value,10):0);}},{scriptClass:"mstrmojo.Label",cssClass:"WinSzSuffix",text:AI[1]}]},u(AL,AQ)],bindings:{okEnabled:function(){return !!this.data.windowSize;}},fnOk:function AH(AT){if(AN){AN(AR,AT.funcType,AT.windowSize,[AT.breakBy]);}}});},getRunningTotalMenu:function AA(AK,AN,AI){var AJ=0,AH=Z[AJ].t,AM=0,AL=AN&&AN[AM];return new mstrmojo.ui.menus.EditorConfig({data:{item:AK,func:AH,breakBy:AL},cssClass:"RunningTotal-MenuEditor",contents:[e(Z,AJ,"func",function(AO){return AO.t;}),u(AN,AM)],fnOk:function(AO){return AI(AO.item,AO.func,[AO.breakBy]);}});},getRankMetricEditor:function v(AL,AO,AJ){var AH=[{n:mstrmojo.desc(1886,"Descending"),v:"0"},{n:mstrmojo.desc(1885,"Ascending"),v:"-1"}],AI=0,AK=AH[AI].v,AN=0,AM=AO&&AO[AN];return new mstrmojo.ui.menus.EditorConfig({data:{item:AL,order:AK,breakBy:AM},cssClass:"NewRankMetric-MenuEditor",contents:[{scriptClass:"mstrmojo.Box",children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(14612,"Sort:")},e(AH,AI,"order")]},u(AO,AN)],fnOk:function(AP){return AJ(AP.item,AP.order,[AP.breakBy]);}});},insertAddUnitToFilterMenu:function H(AM,AI,AH){var AK=this,AJ=mstrmojo.desc(2022,"Add to Filter"),AL=p.ensureArray(AH).filter(function(AN){return AK.isValidAddToFP(AI,AN);});if(AL.length>0){AM.addMenuItem(AJ,"",function(){AI.addFilterStackSelectors(AL);});}else{AM.addDisabledMenuItem(AJ,"");}},isValidAddToFP:function N(AK,AM){var AI=AK.controller.view.builder,AJ=AI.getLayoutVIMap(AK.getCurrentLayoutKey()).getComponent(K.FILTER_STACK),AN;AN=(!AJ||p.find(AJ.getFilterDefinitions(),"srcid",AM.did)===-1);if(AN&&AM.lock){var AH=AM.fs||[],AL;AN=false;for(AL=0;AL<AH.length;AL++){if(AH[AL].iidx){AN=true;break;}}}return AN;},renameItem:function o(AM,AP,AI,AK){var AL=AM.mstrmojoId,AO=mstrmojo.dom.findWidget(AM);AK=AK||{};if(!AL){var AN=mstrmojo.insert({scriptClass:"mstrmojo.EditableLabel",editOnClick:false,text:AP.n,title:AP.dsc||"",allowEmptyText:AK.allowEmptyText,cssClass:AK.cssClass||"",placeholder:AM,onTextEditComplete:function AH(AQ){if(AQ){return AI(this);}},onmousedown:function AJ(AQ){if(this.isEditing){AQ.cancel();}}});if(AO&&AO.draggable){AN.parent=AO;}AN.render();AL=AN.id;}mstrmojo.all[AL].set("isEditing",true);return mstrmojo.all[AL];},getMultipleMetricsCalculationMenus:function g(AO,AH,AR){var AN=new mstrmojo.ui.menus.MenuConfig(),AT=mstrmojo.vi.ui.DatasetUnitMenuUtils.getMultiSelectionShortcutMetricFunctions(AO),AL=function(AV,AW,AU){return{dsid:AH,funcType:AW,funcType2:AU,items:AV};};AN.useTooltip=true;AT.forEach(function(AU){AN.addMenuItem(AU.n,"",function(){AR(AL(AO,AU.t));});});if(AO.length===2){var AM=mstrmojo.mstr.EnumFunction,AK=AM.FunctionDivide,AI=AM.FunctionMinus,AQ=AO[0],AP=AO[1],AS=function(AY,AW,AU,AX,AV){AN.addMenuItem(AY,"",function(){AR(AL([AW,AU],AX,AV));});},AJ=[{n:function(AV,AU){return AV.n+"/"+AU.n;},fn:AK},{n:function(AV,AU){return AV.n+"-"+AU.n;},fn:AI},{n:function(AV,AU){return"("+AV.n+"-"+AU.n+")/"+AU.n;},fn:AI,fn2:AK}];AJ.forEach(function(AU){AN.addSeparator();AS(AU.n(AQ,AP),AQ,AP,AU.fn,AU.fn2);AS(AU.n(AP,AQ),AP,AQ,AU.fn,AU.fn2);});}return AN;},getCalculationMetricEditor:function L(AP,AQ,AO){var AJ=[{n:"",css:"operator-plus",funcType:m.FunctionPlus},{n:"",css:"operator-minus",funcType:m.FunctionMinus},{n:"",css:"operator-multiply",funcType:m.FunctionTimes},{n:"",css:"operator-divide",funcType:m.FunctionDivide},{n:"%",css:"operator-percent-diff",funcType:m.FunctionMinus,funcType2:m.FunctionDivide}],AK={m1:AQ.did,m2:AP[0].did,operator:m.FunctionPlus,u1:{id:AQ.did,type:4},u2:null},AI=function(AR){return{}.hasOwnProperty.call(AR,"cst");},AN=function(AR){return typeof AR==="string"&&!!AR.length&&!isNaN(Number(AR));};var AH="this.parent.popupConfig.valid || this.selectedIndex !== -1 || (!!this.selectedNode && this.selectedNode.innerHTML.length === 0)",AM=function AM(){var AR=this.parent.popupConfig;if(AR){AR.set("okEnabled",this[this.editableSlot].innerHTML.length!==0);}};return new mstrmojo.ui.menus.EditorConfig({cssClass:"Calculation-MenuEditor",contents:[AC({metrics:AP,value:AK.m1,propName:"u1",optionValueField:"did",bindings:{valid:AH},postkeyup:AM}),{scriptClass:"mstrmojo.ButtonListHoriz",items:AJ,selectedIndex:0,postselectionChange:function AL(){this.parent.data.set("operator",this.selectedItem.funcType);this.parent.data.set("operator2",this.selectedItem.funcType2);}},AC({metrics:AP,value:null,propName:"u2",optionValueField:"did",bindings:{valid:AH},postkeyup:AM})],data:AK,okEnabled:false,bindings:{valid:function(){var AT=this.data.u1,AS=this.data.u2,AU=this.data.operator;if(!AT||!AS||!AU){return false;}var AR=!(AI(AT)&&AI(AS))&&(!AI(AT)||AN(AT.cst))&&(!AI(AS)||AN(AS.cst));this.set("okEnabled",AR);return AR;}},fnOk:function(AR){return AO(AR.u1,AR.u2,AR.operator,AR.operator2);}});},getFilterEditor:function F(AI){var AN="dfe",AM,AJ={},AL=AI.datasetFilter;function AK(AO){if(!AO.et){return false;}if(AO.et===AE.RLS){return false;}if(AO.p){return false;}if(AO.cs&&AO.cs.some(function(AP){return !!AP.p;})){return false;}return !AO.nds||AO.nds.every(AK);}function AH(){p.forEach(AI.att,function(AP){if(AP.t!==12||AP.da){return ;}AJ[AP.did]={did:AP.did,n:AP.n,t:AP.t,fs:AP.fs};});p.forEach(AI.mx,function(AP){if(AP.um){return ;}AJ[AP.did]={did:AP.did,n:AP.n,t:AP.t};});if(AL){mstrmojo.expr.findTargets(AL,"did",AJ);}var AO={expr:X.clone(AL),targets:X.valarray(AJ)};AM=AN&&window.mstrmojo&&mstrmojo.all[AN];if(!AM){AM=mstrmojo.insert({id:AN,scriptClass:"mstrmojo.fe.ReportFilterEditor",showLimits:false,objectBrowsingEnabled:true});}if(AI.zIndex){AM.set("zIndex",AI.zIndex);}AM.set("title",mstrmojo.desc(12138,"Dataset Filter #").replace("#",AI.datasetName));AM.set("onSave",AI.fnOk);AM.set("model",AO);AM.onUpdateBrowseElementsParams=AI.browseParam;AM.open();}if(AL&&!AK(AL)){mstrmojo.warn(mstrmojo.desc(13527,"The filter contains an advanced condition that cannot be edited."),{confirmBtn:{t:mstrmojo.desc(13528,"Clear existing filter"),fn:function(){AL=null;AH();}}},{title:mstrmojo.desc(11812,"Notification")});}else{AH();}},getCfgForAddUnitFromAllObject:function(AH,AI){var AJ=null,AK=null,AL=[],AM=function(AN,AO){if(!AO){return false;}return p.find((AO.att||[]).concat(AO.mx||[]),"did",AN.did)>-1;};X.forEach(AI,function(AO,AN){if(AO.idd){AJ=AN;AK=AO;return false;}return true;});if(!AJ){AJ="$GUID_141";AL.push({act:"createDataset",mgo:true,prm:true,name:mstrApp.projectName,idd:true,newObjectIds:[AJ]});}p.forEach(AH,function(AN){if(!AM(AN,AK)){AL.push({act:"addUnitToDataset",dsid:AJ,unitId:AN.did,unitType:AN.t});}});return{actions:AL,dsid:AJ};},getAggregateByMenu:function l(AM,AK){var AI=new mstrmojo.ui.menus.MenuConfig(),AJ=function(AQ,AP){var AS,AR;if(AP){var AO=AQ.mexp.args[0];AS=AO.did;AR=AO.t;}else{AS=AQ.did;AR=AQ.t;}return{did:AS,t:AR};},AH=this.getAvailableShortcutMetricFunctionsGroup(AM),AN=AM.mexp?AM.mexp.ft:null,AL=AM.mexp&&this.isAmongFunctions(AN,AH);AH.forEach(function(AO,AP){if(AP!==0){AI.addSeparator();}AO.forEach(function(AQ){AI.addMenuItem(AQ.n,"",function(){AK(AJ(AM,AL),AQ.t);});});});return AI;},showObjectPicker:function k(AI,AH){var AJ="object_picker";return function(){var AK=mstrmojo.all[AJ];if(!AK){AK=new mstrmojo.vi.ui.editors.ObjectPicker({id:AJ});if(AH){AK.supportedTypes=p.hash(AH);AK.ob.browsableTypes="8,"+AH.join(",");}AK.render();}else{if(AH){AK.supportedTypes=p.hash(AH);AK.ob.browsableTypes="8,"+AH.join(",");}AK.browse();}AK.OKFn=AI||mstrmojo.emptyFn;AK.open();};},generateNumberFormat:function r(AM){var AH=T.DefaultFormat.FormattingNumber,AI=T.NumberFormatCategory,AK=AM||{},AJ=AK.nct,AL=AJ===AI.General&&AK.nfs==="General";return{category:(AJ===undefined||AL)?AI.Automatic:AJ,decimalPlaces:AK.ndp===undefined?2:AK.ndp,thousandSeparator:AK.nth?-1:0,currencySymbol:AK.ncs||AH.CurrencySymbol,currencyPosition:AK.ncp||AH.CurrencyPosition,format:AK.nfs||"",negativeNumbers:AK.nnn||AH.NegativeNumbers};},getNumberFormatEditor:function w(AK,AJ,AI){var AH=this.generateNumberFormat(AJ),AL=X.clone(AH),AN=X.clone(AH);return new mstrmojo.ui.menus.EditorConfig({data:AL,bindings:{okEnabled:function(){return !(this.data.category===AN.category&&this.data.format===AN.format);}},cssClass:"NumberFormat-MenuEditor",contents:[{scriptClass:"mstrmojo.vi.ui.NumberFormatter",formatValue:AH,myData:AL,oldData:AN,adjustAfterCategoryChange:function(){this.parent.adjustCornersForPopupOverflow();}}],fnOk:function AM(AO){if(!(AO.category===AN.category&&AO.format===AN.format)){return AI(AO,AN);}}});},getHighlightElementHandler:function(AJ,AI,AH){return function(){D.toggleClass(AI,AH||"open",AJ);};},getConfDataTypeMenuCfg:function z(AH,Ac,AU,Ap){var Ak="ToString",Ab="ToNumber",AZ="ToDateTime",AT="keepOriginal",AK="Default",Al={ToString:3,ToNumber:2,ToDateTime:8},AP={ToString:"D1ED29645DEC4DBF99E8E09ED939074B",ToNumber:"399C3EC1041643F1ACE8F2A92B1C1F2F",ToDateTime:"0A558C7295DE42DAA8C5594F1724563F"},AN="_pattern",An="_func",AX="_bft",As="_state",Aq={UNCHANGED:0,TO_CREATE:1,TO_UPDATE:2},AM={n:"Default",v:"Default"},Ai=[{n:"MM-DD-Year",v:"MM-DD-Year"},{n:"MM/DD/Year",v:"MM/DD/Year"},{n:"DD-MM-Year",v:"DD-MM-Year"},{n:"DD/mm/Year",v:"DD/mm/Year"},AM],AJ=[{n:mstrmojo.desc(13772,"Keep Original"),v:AT},{n:mstrmojo.desc(12276,"String"),v:Ak},{n:mstrmojo.desc(2052,"Date"),v:AZ},{n:mstrmojo.desc(3434,"Number"),v:Ab}],AS=X.clone(AJ).slice(1),Aa=Ac.fs.filter(function(Au){return Ac.da||Au.obf;}),At=Aa.length>1,AV=Aa.length>5,AO=false,Aj=false,Ad=[],Ah=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13773,"Select Data Type for New Attribute:")}],Ar={okEnabled:false},Am=function(){var Au=false;Aa.forEach(function(Av){Au=Au||(Ar[Av.fnm+An+As]!==Aq.UNCHANGED)||(Ar[Av.fnm+AN+As]!==Aq.UNCHANGED);});return Au;},Ae=function(Aw,Av){var Au=0;if(Aw.da){p.forEach([Ak,AZ,Ab],function(Az,Ax){var Ay=new RegExp("^\\s*"+Az+"\\s*(<.*>)?\\s*\\((.+)\\)\\s*$","i").exec(Av.f);if(Ay&&Ay[2]){Au=Ax+1;return false;}});}return Au;},Ag=function(Aw,Av){var Ax=AK;if(Ac.da){var Au=new RegExp("^\\s*"+Av+'\\s*<\\s*Pattern\\s*=\\s*"(.+)"\\s*>.*$',"i").exec(Aw.f);if(!mstrmojo.string.isEmpty(Au&&Au[1])){Ax=Au[1];}}return Ax;},Af=function(){return AV?this.parent.parent.parent:(At?this.parent.parent:this.parent);},AY=function(Au){if(AV){Au.formList.updateScrollbars();}},AL=function(A1,A2,A0){var Au=A2.fnm,Ax=AV?A1.formList[A2.fnm+AN]:A1[A2.fnm+AN],Ay=At?Ax.children[1]:Ax,Az=Ar[Au+An],Aw=AO&&(Az===AZ||Az===Ak),Av=Ax.visible!==Aw;if(Av){Ax.set("visible",Aw);if(Aw){AY(A1);}else{Ay.hideTooltip();}}if(A0){Ay.set("text",Ag(A2,Az));Ay.set("items",Az===AZ?Ai:[AM]);}},AW=function(Au){var Av=false;Aa.forEach(function(Aw){if(Ar[Aw.fnm+An]===AZ||Ar[Aw.fnm+An]===Ak){Av=true;return false;}});Au.advancedLabel.set("visible",Av);},AI=function(Ax,Av,Ay,Au){return{scriptClass:"mstrmojo.ui.Pulldown",items:Ax,alias:Ay.fnm+An,selectedIndex:Av,onPopupWidgetOpened:function(){AY(Af.call(this));},onitemSelected:function Aw(A3,A1){var A2=Af.call(this),A4=A2.data,A5=Ay.fnm,A0=A3.v,Az=function(A6){if(A6){return(Ax.length===3?Aq.TO_UPDATE:Aq.TO_CREATE);}return Aq.UNCHANGED;};A4.set(A5+An,A0);A4.set(A5+AN,Ag(Ay,A0));A4.set(A5+AX,A0===AT?Ay.bftp:Al[A0]);A4.set(A5+An+As,Az(A1!==Av));A4.set("okEnabled",Am());AL(A2,Ay,true);AW(A2);}};},AR=function(Aw,Ax,Au){return{scriptClass:"mstrmojo.ui.SearchablePulldown",alias:Aw.fnm+AN,useRichTooltip:true,visible:Au,allowCustomText:true,allowEmptyText:true,onPopupWidgetOpened:function(){AY(Af.call(this));},customizeSearchResult:function(Ay){if(p.find(Ay,"v","Default")===-1&&this.items.length>0){Ay.push(AM);}},onclick:function(Ay){mstrmojo.ui.SearchablePulldown.prototype.onclick.call(this,Ay);this.set("isEditing",true);},updateData:function(A0){var Ay=Af.call(this),Az=Ay.data,A1=Aw.fnm;Az.set(A1+AN,A0);Az.set(A1+AN+As,Ax!==A0?Aq.TO_UPDATE:Aq.UNCHANGED);Az.set("okEnabled",Am());},onitemSelected:function Av(Az,Ay){if(Az){this.updateData(Az.v);}},onkeyup:function(Ay){mstrmojo.ui.SearchablePulldown.prototype.onkeyup.call(this,Ay);var Az=this[this.editableSlot],A0=Az.innerText||Az.textContent;this.updateData(A0);},updateTooltipConfig:function(Az){this.tooltipOpenDelay=Az?500:0;var Ay=V.position(this.domNode);this.richTooltip={content:mstrmojo.desc(14114,'Pattern determines the formatting for the resulting string of characters. You can use the custom numeric, date, and time formatting symbols. <br/> Example: if pattern is defined as "0,000.00" for "1001", it returns the string "1,001.00"'),posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-C",top:Ay.y-2,left:Ay.x+Ay.w+10};}};},Ao=function(A2,A1,Au,Av,A0){var Ax=Ae(A2,A1),Az=Ag(A1,AJ[Ax].v),Aw=A1.fnm,Ay=AJ;if(Ax>0){Ay=AS;Ax--;}Av[Aw+AN]="";Av[Aw+An]="";Av[Aw+AX]="";Av[Aw+An+As]=Av[Aw+AN+As]=Aq.UNCHANGED;if(A0){Au.push({scriptClass:"mstrmojo.HBox",cssClass:"func-input",alias:Aw+An,children:[{scriptClass:"mstrmojo.Label",text:Aw,useRichTooltip:true,updateTooltipConfig:function(A5){this.tooltipOpenDelay=A5?500:0;var A4=this.domNode;var A3=V.position(A4);if(A4.scrollWidth>A4.offsetWidth){this.richTooltip={content:A4.innerText,posType:mstrmojo.tooltip.POS_TOPLEFT,cssClass:"vi-regular vi-tooltip-V",top:A3.y-A3.h-10,left:A3.x-10};}}},AI(Ay,Ax,A1,true)]});Au.push({scriptClass:"mstrmojo.HBox",cssClass:"pattern-input",alias:Aw+AN,children:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(12078,"Pattern")},AR(A1,Az,true)]});}else{Au.push(AI(Ay,Ax,A1,false));Au.push(AR(A1,Az,false));}};p.forEach(Ac.fs,function(Au){if(AH.als&&AH.als.links[Ac.did+" "+Au.fid]){Aj=true;return false;}});if(At){Aa.forEach(function(Au){Ao(Ac,Au,AV?Ad:Ah,Ar,true);});}else{Ao(Ac,Aa[0],Ah,Ar,false);}if(AV){Ah.push({scriptClass:"mstrmojo.ui.ScrollableContainer",alias:"formList",cssClass:"formList",children:Ad});}Ah.push({scriptClass:"mstrmojo.Label",cssClass:"advancedLabel",alias:"advancedLabel",allowHTML:true,text:"<span>"+mstrmojo.desc(702,"Advanced")+"</span>",onclick:function(){var Av=this.parent,Aw,Au,Ax=true;AO=!AO;D.toggleClass(this.domNode,"expanded",AO);Aa.forEach(function(Ay){AL(Av,Ay,false);Aw=AV?Av.formList[Ay.fnm+AN]:Av[Ay.fnm+AN];Au=At?Aw.children[1]:Aw;if(Aw.visible&&Ax&&!AV){Ax=false;Au.showTooltip();}});}});return new mstrmojo.ui.menus.EditorConfig({data:Ar,cssClass:"ConfDataType-MenuEditor",contents:Ah,onOpen:function(){AY(this);},bindings:{okEnabled:"this.data.okEnabled"},fnOk:function AQ(Aw){var Au=[],Ay=[],Av=false,Ax=function(A1,A2,A0){var A4=[],A3=function(A5){var A6=A5.ftk&&A5.ftk.slice(2,-2);if(!A6){return null;}while((A6.shift()).v!=="("){}return A6;},Az=A3(A0)||[x(Ac,A0)];A4.push({v:"!",tp:33,lv:4});if(A1!==AT){A4.push({v:A1,oi:{did:AP[A1],t:11,st:2816,n:A1}});if(!mstrmojo.string.isEmpty(A2)&&A2!==AK&&(A1===AZ||A1===Ak)){A4.push({v:'<Pattern="'+A2+'">(',tp:"2",lv:1});}else{A4.push({v:"(",tp:"2",lv:1});}A4=A4.concat(Az);A4.push({v:")",tp:"2",lv:1});}else{A4=A4.concat(Az);}A4.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:A4});};if(Aj){Av=true;}else{Aa.forEach(function(Az){if(Aw[Az.fnm+An+As]===Aq.TO_CREATE){Av=true;return false;}else{if(Aw[Az.fnm+An+As]===Aq.TO_UPDATE||(Aw[Az.fnm+AN+As]===Aq.TO_UPDATE&&(Aw[Az.fnm+An]===AZ||Aw[Az.fnm+An]===Ak))){Ay.push(Az);}}});}if(Av){Aa.forEach(function(Az){Au.push({n:Az.fnm,formula:Ax(Aw[Az.fnm+An],Aw[Az.fnm+AN],Az),bft:Aw[Az.fnm+AX]});});Ap(Av,Au);}else{if(Ac.da){W(AH.mid,Ac.did,Ay,function(Az){Az.forEach(function(A0){Au.push({did:A0.fid,formula:Ax(Aw[A0.fnm+An],Aw[A0.fnm+AN],A0),bft:Aw[A0.fnm+AX]});});Ap(Av,Au);});}}}});},getCreateTimeDAEditorCfg:function O(AL,AK){var AJ=function(AP){var AQ=8,AR=1,AO=p.filter(AP.fs,function(AS){return(AP.da||AS.obf)&&(AS.bftp===AQ||AS.bftp===AR);}),AN=p.find(AO,"idf",true);return AO[AN>=0?AN:0];},AH=AJ(AL);if(!AH){return null;}return new mstrmojo.ui.menus.EditorConfig({data:{okEnabled:false},cssClass:"CreateTimeAttribute-MenuEditor",contents:[{scriptClass:"mstrmojo.ui.CheckList",alias:"time_type",items:[{n:mstrmojo.desc(873,"Year"),v:"Year"},{n:mstrmojo.desc(10051,"Quarter of Year"),v:"QuarterOfYear"},{n:mstrmojo.desc(10050,"Quarter"),v:"Quarter"},{n:mstrmojo.desc(10049,"Month of Year"),v:"MonthOfYear"},{n:mstrmojo.desc(871,"Month"),v:"Month"},{n:mstrmojo.desc(10047,"Week of Year"),v:"WeekOfYear"},{n:mstrmojo.desc(10048,"Week"),v:"Week"},{n:mstrmojo.desc(11608,"Day of Year"),v:"DayOfYear"},{n:mstrmojo.desc(10046,"Day of Month"),v:"DayOfMonth"},{n:mstrmojo.desc(10045,"Day of Week"),v:"DayOfWeek"}],onchange:function AI(){var AN=false;X.forEach(this.selectedIndices,function(AO){if(AO){AN=true;return false;}});this.parent.data.set("okEnabled",AN);}}],bindings:{okEnabled:function(){return this.data.okEnabled;}},fnOk:function AM(AS,AT){var AX=AT.time_type,AW=AX.selectedIndices,AU=AX.items,AR=[],AN=[],AO="@form",AQ={Year:"6F7DF5F8449111D5BEA300B0D01A55EF",Quarter:"6F7DF5F7449111D5BEA300B0D01A55EF",Concat:"6F7DF5FF449111D5BEA300B0D01A55EF",QuarterStartDate:"59E10CE2ADDD4A6DAC2416A72999A9ED",Month:"6F7DF5F6449111D5BEA300B0D01A55EF",ToString:"D1ED29645DEC4DBF99E8E09ED939074B",MonthStartDate:"7C63D4E70B2741C3A5B54A2EFD40961B",Week:"6F7DF5F5449111D5BEA300B0D01A55EF",WeekStartDate:"44681336D0DB4E43AC333FFB3CC4400D",DayOfMonth:"6F7DF5F2449111D5BEA300B0D01A55EF",DayOfWeek:"6F7DF5F3449111D5BEA300B0D01A55EF",DayOfYear:"6F7DF5F4449111D5BEA300B0D01A55EF"},AV=function(AY){switch(AY){case"Year":return{ID:["Year","(",AO,")"]};case"Quarter":return{ID:["Year","(",AO,") * 10 + ","Quarter","(",AO,")"],DESC:["Concat",'("Q", ',"Quarter","(",AO,")",', ", ", ',"Year","(",AO,"))"],DATE:["QuarterStartDate","(",AO,")"]};case"QuarterOfYear":return{ID:["Quarter","(",AO,")"],DESC:["Concat",'("Q", This@ID)']};case"Month":return{ID:["Year","(",AO,") * 100 + ","Month","(",AO,")"],DESC:["ToString",'<Pattern="mmm yyyy">(',AO,")"],DATE:["MonthStartDate","(",AO,")"]};case"MonthOfYear":return{ID:["Month","(",AO,")"],DESC:["ToString",'<Pattern="mmmm">(',AO,")"]};case"Week":return{ID:["Year","(",AO,") * 100 + ","Week","(",AO,")"],DESC:["Concat",'("W", ',"Week","(",AO,'), ", ", ',"Year","(",AO,"))"],DATE:["WeekStartDate","(",AO,")"]};case"WeekOfYear":return{ID:["Week","(",AO,")"]};case"DayOfMonth":return{ID:["DayOfMonth","(",AO,")"]};case"DayOfWeek":return{ID:["DayOfWeek","(",AO,")"],DESC:["ToString",'<Pattern="ddd">(',AO,")"]};case"DayOfYear":return{ID:["DayOfYear","(",AO,")"]};}},AP=function(AY,Aa,Ac){var Ab=[{v:"!",tp:33,lv:4}],AZ;Ac.forEach(function(Ae,Ad){if(Ae===AO){Ab.push(x(AY,Aa));}else{AZ=AQ[Ae];if(AZ){Ab.push({v:AZ,oi:{did:AZ,t:11,st:2816,n:AZ}});}else{Ab.push({v:Ae,tp:"2",lv:1});}}});Ab.push({v:"",tp:-1,lv:4});return mstrmojo.ME.AttributeEditBox.getTokenStreamXML({items:Ab});};X.forEach(AW,function(AY,AZ){if(AY){AN=[];X.forEach(AV(AU[AZ].v),function(Aa,Ab){AN.push({n:Ab,formula:AP(AL,AH,Aa),bft:(Ab==="DATE"?8:0)});});AR.push({isTokenStream:true,forms:AN,name:AL.n+" ("+AU[AZ].n+")"});}});return AK(AR);}});},RefreshAndCloseAllObjectBrowserCallback:function(AI,AH){return mstrmojo.func.wrapMethods(AH.getDatasetsUpdateCallback(),{success:function(){if(p.find(AI,"act","createDataset")!==-1){AH.controller.datasetsPanel.set("allObjectBrowserOpened",false);}}});},getUnitFromDataset:function a(AI,AK,AH){var AJ=null;X.forEach(AI,function(AM){var AL=AM.att||[];if(AH===4){AL=AM.mx||[];}p.forEach(AL,function(AN){if(AN.did===AK){AJ=AN;return false;}});if(AJ){return false;}});return AJ;},getDatasetFromId:function P(AH,AI){var AJ=null;X.forEach(AH,function(AK){if(AK.did===AI){AJ=AK;return false;}});return AJ;},getDatasetFromAttributeId:function P(AH,AI){var AJ=null;X.forEach(AH,function(AK){if(p.find(AK.att,"did",AI)>=0){AJ=AK;return false;}});return AJ;},getSortedDatasetUnits:function E(AH){var AI=function AI(AJ){return AJ.t===U.DssTypeMetric?2:1;};AH=AH.concat();AH.sort(function(AM,AK){var AN=AI(AM)-AI(AK),AL=AM.n.toUpperCase(),AJ=AK.n.toUpperCase();return AN!==0?AN:(AL!==AJ?AL.localeCompare(AJ):AM.n.localeCompare(AK.n));});return AH;},getUnitCssClass:function(AI){var AH=AI.t;if(AI.fs&&AI.fs.length&&AI.fs.some(function(AJ){return AJ.fgr>0;})){AH+="g";}else{if((AI.dm||AI.um)||AI.da){AH+="d";}else{if(AI.de){AH+="de";}}}if((AI.t===47&&AI.st===12033)||(AI.t===12&&AI.st&&AI.st===3076)){AH+=(" st"+AI.st);}return"ic"+AH;},hasMultiForms:function j(AI,AH){return n.getFormsByAttrId(AI,AH).length>1;},getDisplayFormsMenu:function G(AT,AR,AL,AQ){var AP=[],AS=[],AK=[],AN=[{n:mstrmojo.desc(2411,"Off"),v:0},{n:mstrmojo.desc(2410,"On"),v:1},{n:mstrmojo.desc(8504,"Form Name Only"),v:2},{n:mstrmojo.desc(8505,"Show Attribute Name Once"),v:3},{n:mstrmojo.desc(4531,"Automatic"),v:4}];var AM=AR.model.data,AH=AM.gts,AO;p.forEach((AH.row||[]).concat(AH.col||[]),function(AU){if(AU.id===AT.did){AS=AS.concat(AU.fs);}});AO=n.getFormsByAttrId(AT.did,AL);p.forEach(AO||[],function(AV){var AW=AV.fid;if(p.find(AP,"id",AW)<0){AP.push({id:AW,n:AV.fnm});var AU=p.find(AS,"id",AW);if(AU>-1){AK[AP.length-1]=true;}}});return new mstrmojo.ui.menus.EditorConfig({data:{item:AT,oldSelected:X.copy(AK,{})},contents:[{alias:"fs",scriptClass:"mstrmojo.ui.CheckList",minimumSelectCnt:1,items:AP,selectedIndices:AK},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(11918,"Display attribute form names:")},{alias:"longNames",scriptClass:"mstrmojo.ui.Pulldown",items:AN,selectedIndex:p.find(AN,"v",AM.lnm||0),onitemSelected:function AI(AU){this.v=String(AU.v);}}],okBtnText:mstrmojo.desc(1442,"Ok"),fnOk:function AJ(AZ,Ad){var AY=Ad.fs,AW=AY.selectedIndices,Ab=AY.items,Ah=[],Aa=[],Ae=[];if(!AY.getSelectedItems().length){mstrmojo.alert("Please select at least one form!");return ;}var AV=AZ.oldSelected,Ag=AW,AX,Ac={},Af={};for(AX=0;AX<Ab.length;AX++){if(AV[AX]&&!Ag[AX]){Ac[AX]=true;}else{if(!AV[AX]&&Ag[AX]){Af[AX]=true;}}}X.forEach(Ac,function(Ai,Aj){if(Ai){Aa.push({act:"removeForm",unitId:AT.did,attFormId:Ab[Aj].id});}});var AU=AR.model.data.gts;(AU.row||[]).concat(AU.col||[]).forEach(function(Ai){if(Ai.id===AT.did){(Ai.fs||[]).forEach(function(Aj){if(p.find(AP,"id",Aj.id)<0){Aa.push({act:"removeForm",unitId:AT.did,attFormId:Aj.id});}});}});X.forEach(Af,function(Ai,Aj){if(Ai){Ah.push({act:"addForm",unitId:AT.did,attFormId:Ab[Aj].id,unitPos:0});}});Ae.push({act:"putProperties",prs:"Template Formatting",pr:"LongNames",v:Ad.longNames.v});if(AQ){AQ([{act:"updateTemplate",keyContext:AR.k,partialRetrieval:{nodes:[AR.k]},actions:Aa.concat(Ah).concat(Ae)}]);}}});},getAttributeLinkMenu:function d(AT,AW,AR,AV,AM){var AX=-2147483648,AO=AV.datasets,AP=AO[AR],AU=AP.tables||[],AH={},AQ=[],AK=(AW.fs&&AW.fs[0])||{},AS=[],AN=779,AJ=AW.art>1,AI=!AJ&&X.keyarray(AO).length>1,AL=function(){mstrmojo.vi.ui.editors.AttributeLinkEditor.open({attribute:AW,docModel:AV,datasetId:AR});};if((AP.st!==AN)||AU.length<=1||AW.da){if(AI){AT.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AL);}return ;}p.forEach(AP.att,function(Aa){var Ab=true,AZ=null,AY=(Aa.fs&&Aa.fs[0])||{};if(Aa.da){return ;}if(AK.der===AX||AY.der===AX||AK.fgr===-1||AY.fgr===-1||AK.ftr===-1||AY.ftr===-1){return ;}if(AK.fgr&&AY.fgr&&AK.fgr!==AY.fgr){return ;}if(AK.ftr&&AY.ftr&&AK.ftr!==AY.ftr){return ;}p.forEach(AU,function(Ac){var Ad=p.find(Ac.attRefs,"did",AW.did),Ae=p.find(Ac.attRefs,"did",Aa.did);if(Ad>=0&&p.indexOf(AQ,Ac.did)<0){AQ.push(Ac.did);}if(Ae>=0){AZ=Ac.did;}if(Ad>=0&&Ae>=0){Ab=false;}});if(Ab&&!Aa.hide){AH[Aa.did]=AZ;AS.push(Aa);}});if(AS.length>0&&AP.hcs!==true){AT.addEditorMenuItem(mstrmojo.desc(13172,"Map Attributes"),"",function(){return new mstrmojo.ui.menus.EditorConfig({data:{},cssClass:"mapAttribute",okVisible:false,cancelVisible:false,contents:[{scriptClass:"mstrmojo.ui.ScrollableContainer",children:[{scriptClass:"mstrmojo.vi.ui.InteractiveUnitList",draggable:false,CLS_HAS_MENU:"",items:AS,listHooks:{select:function AY(AZ,Aa){AV.warnForEditStandaloneDS(AP,function(){p.forEach(AQ,function(Ab){I({dsid:AR,srcId:AW.did,srcTableId:Ab,tgtId:Aa.did,tgtTableId:AH[Aa.did]},AV,AM);});});}}}]}]});});}if(AI){AT.addMenuItem(mstrmojo.desc(11941,"Link to Other Dataset..."),"",AL);}},isDocumentLevelItem:function q(AH){return AH&&(AH.um||AH.da||(AH.t===47&&AH.st===12033));},isLegalObjectName:function Q(AH){var AI=/["\[\]\\]/g;if(AH.match(AI)){return false;}return true;},validateName:function f(AI,AJ,AH){if(this.isLegalObjectName(AI)){AJ();}else{mstrmojo.alert(mstrmojo.desc(8622,"The # cannot contain the reserved characters ##.").replace("##","'[', ']', '\"' and '\\'").replace("#",mstrmojo.desc(945,"Name")),AH,mstrmojo.desc(1388,"Rename"));}},hasCGorCon:function AG(AH){return AH.att.some(function(AJ){var AL=(AJ.t===1||AJ.t===47),AK=(AJ.t===12&&AJ.de),AI=(AJ.t===47&&AJ.st===12033);return(AL&&!AI||AK);});},hasOldDEOverDatasets:function(AK,AJ){var AI=false,AH;X.forEach(AJ,function(AL){AH=p.find((AL.att||[]),"did",AK);if(AH!==-1&&AL.att[AH].de){AI=true;return false;}});return AI;},getMarkGeoRoleEditorCfg:function AD(AH,At,Ab,AY,A2,A4){var AX=268435456,Az=536870912,AM=1073741824,Al=268435456,Aw=805306368,Ar=805306368,Af=1879048192,A3=-2147483648,Au=0,Av=1,AO=2,AW=3,Aa=4,AU=5,A1=6,AR=7,Ad=8,Ac=9,An=10,AK=2,Ak=3,As={v:Au,n:mstrmojo.desc(2057,"None")},A5={v:AW,n:mstrmojo.desc(7674,"Country"),der:AX},Aq={v:AO,n:mstrmojo.desc(7676,"State"),parents:[A5],der:Az},AS={v:Ac,n:mstrmojo.desc(12919,"County"),parents:[A5,Aq]},Ax={v:Av,n:mstrmojo.desc(7675,"City"),parents:[A5,Aq],der:AM},Ag={v:Ad,n:mstrmojo.desc(7677,"Zip Code"),parents:[A5,Aq,Ax]},AZ={v:AU,n:mstrmojo.desc(7696,"Latitude")},Ao={v:A1,n:mstrmojo.desc(7697,"Longitude")},AV={v:Aa,n:mstrmojo.desc(7675,"City")+", "+mstrmojo.desc(7676,"State")},Aj={v:An,n:mstrmojo.desc(12973,"Area Code")},Am={v:AR,n:mstrmojo.desc(2056,"Custom")},AT={ID:[As,A5,Aq,AS,Ax,Ag,AZ,Ao,AV,Aj,Am],ID_NUMERIC:[As,Ag,Aj,AZ,Ao],NON_ID:[As,A5,Aq,AS,Ax,Ag,AV,Aj,Am],NON_ID_NUMERIC:[As,Ag,Aj]},Ah=p.filter(At.fs,function(A6){return(A6.bftp===AK||A6.bftp===Ak)&&A6.der!==A3;});var Ap=(Ah.length>1),AJ=p.find(Ah,"idf",true),AL=(AJ===-1?0:AJ),Ai=Ah[AL],AQ,AI,Ae,AN=[],AP=function(A6){var A7=(A6.idf?"ID":"NON_ID")+(A6.bftp===AK?"_NUMERIC":"");return AT[A7];},A0=function(A7,A6){return p.find(AP(A6),"v",A7);};if(Ah.length===0||p.find(At.fs,"fgr",-1)!==-1||Ai.der===A3){return null;}p.forEach(Ah,function(A8,A6){var A7=X.clone(A8);A7.n=A7.fnm;AN.push(A7);if(A8.fgr){Ai=A7;AL=A6;}});AQ=Ai.fid;Ae=Ai.fgr||0;AI=A0(Ae,Ai);return new mstrmojo.ui.menus.EditorConfig({data:{item:At,geoForm:Ai,geoRole:Ae},cssClass:"MarkGeoRole-MenuEditor",contents:[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13522,"Select Attribute Form:"),visible:Ap},{scriptClass:"mstrmojo.ui.Pulldown",items:AN,selectedIndex:AL,alias:"formList",visible:Ap,onitemSelected:function Ay(A8){var A6=this.parent.data,A7=this.parent.geoRoleList;if(A6.geoForm.fid!==A8.fid){A6.set("geoForm",A8);A6.set("geoRole",A8.fgr);A7.set("items",AP(A8));A7.set("selectedIndex",A0(A8.fgr,A8));}}},{scriptClass:"mstrmojo.ToolSeparator",visible:Ap,markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod}},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13523,"Select Geographic Type:")},{scriptClass:"mstrmojo.ui.Pulldown",items:AP(Ai),selectedIndex:AI,alias:"geoRoleList",onitemSelected:function Ay(BC){var BB=this.parent,A6=BB.data,BD=BB.geoDrvList;var A8=[],BA=[],A7=Ai.der,A9;A6.set("geoRole",BC.v);p.forEach(BC.parents,function(BE,BF){A9=BE;A8.push({n:A9.n,der:A9.der});if((A7&A9.der)!==0){BA[BF]=true;}});BD.set("items",A8);BD.set("selectedIndices",BA);p.forEach(["geoDrvSeparator","geoDrvLabel","geoDrvList"],function(BE){BB[BE].set("visible",A8.length>0);});}},{scriptClass:"mstrmojo.ToolSeparator",markupMethods:{onvisibleChange:mstrmojo.Widget.visibleMarkupMethod},alias:"geoDrvSeparator"},{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(13524,"(Optional) Create Additional Attributes:"),alias:"geoDrvLabel"},{scriptClass:"mstrmojo.ui.CheckList",alias:"geoDrvList"}],fnOk:function(A9,A8){var A6=function(BF){var BE=function(BJ){var BK="<mpcs>";p.forEach(BJ,function(BL){BK+='<mpc did="'+BL.did+'" n="'+BL.n+'" georole="'+BL.georole+'" drvflg="'+BL.drvflg+'" />';});BK+="</mpcs>";return BK;},BA=function(BJ,BL,BN,BK){var BM=function(BR,BO,BQ){var BP=R(BF,BR,BO),BS=h(BP,BQ);return BS&&BS.did;};A2.forEach(function(BO,BP){var BQ=BM(BO.did,At.did,BL.fid);if(BQ){BJ[BP]=BJ[BP]||[];BJ[BP].push({did:BQ,n:BL.fnm,georole:BN,drvflg:BK});}});},BC=[],BI=[],BG=A8.geoDrvList,BB=0,BD=false,BH={2:Al,1:Aw,9:Ar,8:Af}[A9.geoRole]||0;X.forEach(BG.selectedIndices,function(BK,BJ){if(BK){BB|=BG.items[BJ].der;}});BB&=BH;if(Ai.fgr!==A9.geoRole||Ai.fid!==A9.geoForm.fid||Ai.der!==BB){if(Ap&&Ai.fid!==A9.geoForm.fid){if(Ai.fgr!==Au){BA(BI,Ai,Au,0);if(Ai.der>0){BD=true;}}}if(A9.geoForm.fgr!==A9.geoRole||A9.geoForm.der!==BB){BA(BI,A9.geoForm,A9.geoRole,BB);if((BB&A9.geoForm.der)!==A9.geoForm.der){BD=true;}}if(BI.length>0){BI.forEach(function(BK,BJ){BC.push({act:"changeEMMAMapping",dsid:Ab,tbid:A2[BJ].did,mapping:BE(BK)});});A4(BC,BD);}}},A7=function(){C(AH.mid,Ab,{success:A6});};if(!AY){mstrmojo.warn(mstrmojo.desc(13525,"Modifications to this dataset will affect other reports, documents, and dashboards that share the dataset. Do you want to continue?"),{},{buttons:[t(mstrmojo.desc(219,"Yes"),function(){A7();},true,{width:"60px"}),t(mstrmojo.desc(221,"Cancel"),function(){})]});}else{A7();}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.EnumDragSources","mstrmojo.vi.ui.DatasetUnitMenuUtils");var A=mstrmojo.vi.ui.DatasetUnitMenuUtils;mstrmojo.vi.ui._CanDropFromSchema=mstrmojo.provide("mstrmojo.vi.ui._CanDropFromSchema",{_mixinName:"mstrmojo.vi.ui._CanDropFromSchema",augmentDropContextForSchema:function B(E,C){var F=E.getCtxtDragData();if(F.src===mstrmojo.vi.models.EnumDragSources.ALL_OBJECT_LIST){var D=A.getCfgForAddUnitFromAllObject(F.items,C.datasets||{});F.dsid=D.dsid;if(D.actions.length){E.actions=D.actions;E.callback=C.getDatasetsUpdateCallback();}}}});})();(function(){mstrmojo.requiresCls("mstrmojo.DocSelector","mstrmojo.vi.ui.rw.selectors.AttrQualInputBox","mstrmojo.array","mstrmojo.expr","mstrmojo.date","mstrmojo.VisChartUtils","mstrmojo.locales","mstrmojo.elementHelper","mstrmojo.vi.ui.DatasetUnitMenuUtils");var M=mstrmojo.expr,F=M.BFTP,B=mstrmojo.date,G=mstrmojo.VisChartUtils,N=mstrmojo.array,K=mstrmojo.vi.ui.DatasetUnitMenuUtils,C=mstrmojo.locales;function P(R,S){if(!R){return ;}var T=B.getDateJson(new Date(G.convertRawValueToMilliseconds(R))),Q=B.formatDateInfo(T,C.datetime.DATEOUTPUTFORMAT);if(S===M.DTP.TIMESTAMP){Q+=" "+B.formatTimeInfo(T,C.datetime.TIMEOUTPUTFORMAT);}return Q;}mstrmojo.AttrQualDocSelector=mstrmojo.declare(mstrmojo.DocSelector,null,{scriptClass:"mstrmojo.AttrQualDocSelector",getWidgetClass:function I(S,R,Q){return"vi.ui.rw.selectors.AttrQualInputBox";},newAndInitWidget:function L(Q){var R=this._super(Q);Q.attachEventListener("includeChange",R.id,function(S){this.set("include",S.value);});return R;},_buildEvent:function H(T,S){T.f=S.f;T.ft=S.ft;T.fid=S.fid;T.ckey=this.ckey;T.srcid=S.srcid;T.srct=S.srct;var R=S.dt,Q=[];N.forEach(S.cs,function(U){if(!mstrmojo.string.isEmpty(U.v)){Q.push(U.v);}});if(Q.length){T.cs=Q.join(mstrmojo.elementHelper.ELEM_SEPARATOR);}T.dtp=R;T.unset=S.unset;if(T.unset||mstrmojo.string.isEmpty(T.cs)){delete T.fid;}},getCekEvtListener:function E(R,Q){return function(S){R.handleActionInSyncPhase(function(){Q.update(S.value);});};},updateWidget:function O(T){var U=this._super(T),R=T.node,S=R.data;if(U.update){var Q={cs:S.cs,f:S.f,ft:S.ft,fid:S.fid,min:P(S.min,S.dt),max:P(S.max,S.dt)};U.update(Q);}return U;},getWidgetConfig:function J(c,W,a,Q){var X=c.model,b=c.getFormats(),V=c.node.data,Z=this._super(c,W,a,Q);Z={scriptClass:Z.scriptClass,cssText:b.height?"height: "+b.height:"",srcid:a.srcid||"",srct:a.srct||"",cs:V.cs,min:P(V.min,V.dt),max:P(V.max,V.dt),showAdvanced:true,canSelectDisabledDate:true,f:V.f,ft:V.ft||1,fid:V.fid,dt:V.dt,onchange:function(){if(!c._inSyncPhase){c.selectorControlChange(this);}}};if(!Z.fid||!Z.dt){var U=K.getUnitFromDataset(X.datasets,a.srcid,12),Y=(U&&U.fs)||[],T,S=function(d){if(!Z.fid){Z.fid=d.fid;}if(!Z.dt){switch(d.bftp){case F.TEXT:Z.dt=M.DTP.CHAR;break;case F.DATE:Z.dt=M.DTP.DATE;break;case F.DATETIME:Z.dt=M.DTP.TIMESTAMP;break;default:Z.dt=M.DTP.CHAR;}}};if(Y[0]){S(Y[0]);}for(T=0;T<Y.length;T++){if(Y[T].iidx){S(Y[T]);break;}}}var R=Z.dt;if(Z.f===undefined){if(R===M.DTP.CHAR){Z.f=M.FN.SEARCH;}else{if(R===M.DTP.DATE||R===M.DTP.TIMESTAMP){Z.f=a.include?M.FN.BETWEEN:M.FN.NOT_BETWEEN;}}}return Z;},isValidSelection:function D(){var R=this.node.data,Q=this.model;return !Q.isSelWarnFlagOn(this.k)||R.cs&&R.cs.length;},isSelectAll:function A(){var W=this.children&&this.children[0];if(W===undefined){return true;}var R=C.datetime.DATEOUTPUTFORMAT,T=C.datetime.TIMEOUTPUTFORMAT,U=B.parseDateAndOrTime;var Q=U.call(B,W.min,R,T),X=U.call(B,W.fromBox.fromPicker.value),Y=B.compareDate(X&&X.date,Q&&Q.date);if(Y>0){return false;}if(Y===0){if(B.compareTime(X&&X.time,Q&&Q.time)>0){return false;}}var Z=U.call(B,W.max,R,T),V=U.call(B,W.toBox.toPicker.value),S=B.compareDate(V&&V.date,Z&&Z.date);if(S<0){return false;}if(S===0){if(B.compareTime(V&&V.time,Z&&Z.time)<0){return false;}}return true;}});}());(function(){mstrmojo.requiresCls("mstrmojo.ME.DerivedFunctionWizard","mstrmojo.ME.MetricDataService","mstrmojo.ME.AttributeEditBox","mstrmojo.expr","mstrmojo.array","mstrmojo.hash");var G;var e=mstrmojo.ME.MetricDataService,U=mstrmojo.hash,N=mstrmojo.array,W=mstrmojo.ME.AttributeEditBox.getTokenStreamXML,a=mstrmojo.expr.DTP,Q={SHOW_BAND_NAMES:-4,BANDON_UNITS:-6},B={START_END:'BandNames<ResidueName="All Others">(this@ID, "#s - #e")',BAND_NUM:'BandNames<ResidueName="All Others">(this@ID, "Band #b")',BAND_NUM_START_END:'BandNames<ResidueName="All Others">(this@ID, "Band #b: #s - #e")',NO:"No"},R=[{n:mstrmojo.desc(14145,"Start - End"),v:B.START_END},{n:mstrmojo.desc(14146,"Band #"),v:B.BAND_NUM},{n:mstrmojo.desc(14147,"Band #: Start - End"),v:B.BAND_NUM_START_END},{n:mstrmojo.desc(218,"No"),v:B.NO}],K={"8107C337DD9911D3B98100C04F2233EA":"BAND_SIZE","8107C338DD9911D3B98100C04F2233EA":"BAND_COUNT","8107C339DD9911D3B98100C04F2233EA":"BAND_POINTS"},D=function(){return[];};function Y(f){return f.replace(/\s/g,"").toLowerCase();}function O(f){var g=[{v:"BandNames",tp:279,lv:1,oi:{did:"ACA96B1F9F99412B867045747DD88575",n:"BandNames",st:2816,t:11}},{v:"<",tp:60,lv:1},{v:"ResidueName",tp:259,lv:1},{v:"=",tp:282,lv:1},{v:'"All Others"',tp:261,lv:1},{v:">",tp:62,lv:1},{v:"(",tp:40,lv:1},{lv:1,tp:275,v:"this@ID"},{v:",",tp:44,lv:1}];switch(f){case B.BAND_NUM:g.push({v:'"Band #b"',tp:261,lv:1});break;case B.BAND_NUM_START_END:g.push({v:'"Band #b: #s - #e"',tp:261,lv:1});break;case B.START_END:g.push({v:'"#s - #e"',tp:261,lv:1});break;}g.push({v:")",tp:41,lv:1});return g;}function d(f){var g="";N.forEach(f.slice(1,-1),function(h){g+=h.v;});return g;}function J(f){if(f.t===4){return"BandOn";}return f.n;}function E(f){if(f.t===4){return Q.BANDON_UNITS;}return f.dtp;}var C=function(f,g){return{did:"",n:"New Attribute",forms:[{n:"ID",tks:{items:[]}}]};};function T(g,f){return g.dtp===8&&g.n==="Delimiter"?'"'+f+'"':f;}function P(j){var h=j.split(",")[0],g=h.replace(/\d$/,""),f=h.replace(g,"");return{prefix:g,startAt:parseInt(f,10)};}function L(f,g){return{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",items:f,popupToBody:true,itemIdField:"v",postCreate:function(){var h=this.data;this.value=h.v||h.dfv;},getTokens:g||D,onvalueChange:function(){G.set("dirty",true);}};}function I(g,j){var f=function(k){return k.inputWidget&&k.inputWidget.widgetName===j;},h=mstrmojo.array.filterOne(g.argsGrid.ctxtBuilder.itemWidgets,f);return h&&h.inputWidget;}var H=function(g){var f=null;switch(g&&g.dtp){case Q.SHOW_BAND_NAMES:f=L(R);f.widgetName="bandNames";f.getDescTokens=function(){var h=this.selectedItem&&this.selectedItem.v;return h===B.NO?null:O(h);};break;case Q.BANDON_UNITS:f=G.getParamWidget(g);f.widgetName="bandOn";break;case a.DOUBLE:case a.INTEGER:case a.VARCHAR:f=G.getTextWidget(g);break;default:f=G.getParamWidget(g);f.onitemsChange=mstrmojo.emptyFn;break;}if(f){f.alias="inputWidget";}return f;};var M=function(n,o,k,p){var l=n.did,h=n.n,f=n.dsid,g=n.forms,m={items:o},j=function(q){if(q.vs!==0){mstrmojo.alert(mstrmojo.desc(9826,"The metric definition has an error. Please correct before proceeding."),null,mstrmojo.desc(9571,"Syntax Error!"));return ;}var t,r={n:"ID",formula:q.tokenXML};if(l){r.did=g[0].did;t={act:"updateDA",name:h,dsid:f,attrId:l,isTokenStream:true,update:[r]};if(k){if(k.did&&!k.del){t.update.push(k);}else{if(k.did&&k.del){t.del=[{did:k.did}];}else{t.add=[k];}}}}else{t={act:"addDAToDataset",dsid:f,name:h,evFlags:1,isTokenStream:true,forms:[r].concat(k?[k]:[])};}p(t);};mstrmojo.ME.AttributeEditBox.validateSyntax(l,m,true,j);};var Z=function(l){var k=l.forms,g=k&&k.length,j=g&&k[0],h=g&&k[1],n=N.some(j&&j.ftk,function(o){return o.oi&&K[o.oi.did];});if(!n){return false;}if(g===1){return true;}if(h&&h.ftk&&g===2){var f=false,m=Y(d(h.ftk));U.forEach(B,function(o){if(Y(o)===m){f=true;return false;}});return f;}return false;};mstrmojo.ME.BandingDAEditor=mstrmojo.declare(mstrmojo.ME.DerivedFunctionWizard,null,{scriptClass:"mstrmojo.ME.BandingDAEditor",ide:null,insertMode:false,init:function V(f){this._super(f);G=this;},getDTPBuilder:function X(){return H;},getParamObjectTypes:function S(){return[mstrmojo.expr.TP.METRIC];},getTextWidget:function b(g){var h=P(g.n).prefix;return{scriptClass:"mstrmojo.ValidationTextBox",emptyText:(g.dtp===a.DOUBLE||g.dtp===a.INTEGER)?mstrmojo.desc(14143,"Type a number"):"",postCreate:function(){this.value=(g.items&&g.items[0].v)||g.dfv;},oninput:function j(k){G.set("dirty",true);this.createNextInputParamWidget();},constraints:{trigger:mstrmojo.validation.TRIGGER.ONKEYUP,min:1},dtp:g.dtp,getTokens:function(){var k=this.data;if(!mstrmojo.string.isEmpty(this.value)&&this.value!==k.dfv){return[{v:T(k,this.value)}];}return[];},createNextInputParamWidget:function f(){var o=this.data,n=this.dataGrid,p=G._lastRpIdx;if(!(o.isRepeated&&o.rpIdx===p)){return ;}var l=p+1,m=h+l,k=mstrmojo.hash.copy({desc:m,n:m,items:null,dn:m,rpIdx:l},mstrmojo.hash.copy(o));n.items.add([k],mstrmojo.array.indexOf(n.items,o)+1);G._lastRpIdx=k.rpIdx;if(G.updateScrollbars){G.updateScrollbars();}}};},onOpen:function F(){G=this;this.oi.tks=this.oi.forms[0].tks||{items:this.oi.forms[0].ftk};this._super();if(this.updateScrollbars){this.updateScrollbars();}},insertOnFinish:function(){var k=mstrmojo.all.mstrDAE.attrEditBox,f=k.inputBox,j=I(this,"bandNames"),g=this.getTokens(),h=j.getDescTokens();f.insertTokens(g);if(h){k.tabstrip.addTab();f.insertTokens(h);}},validateAndSave:function A(m,l){var k=this,j=k.ide.action,f=m.forms,g=I(this,"bandNames"),o=g.getDescTokens(),h=U.copy(o?{n:"DESC",formula:W({items:o})}:null,f[1]?{did:f[1].did}:null),n=function(q){l();k.ide.close();var p=m.did?j.onupdate:j.oncreate;if(p){p(q);}};if(o===null&&h){h.del=true;}M.call(k,k.oi,this.getTokens(),h,n);},postProcessParamsFromToken:function(j){var l=[],k,h,g=j.pars,f=(g&&g.length)||0;for(h=0;h<f;h++){k=U.copy(g[h]);k.dtp=E(k);k.n=J(k);k.isParam=true;l.push(k);}k=l[l.length-1];if(j.rpc>0){l=l.concat(this.postProcessRepeatParam(k));}return l;},postProcessRepeatParam:function c(n){var m=P(n.n),l=m.prefix,h=m.startAt||1,f=[],k,g;n.isRepeated=true;n.rpIdx=this._lastRpIdx=h;n.n=l+(h++);var j=n.items||[];if(j.length>0){n.items=[j[0]];for(g=1;g<=j.length;g++){k=U.copy(n);k.rpIdx=h;k.n=l+(h++);k.items=(g===j.length?null:[j[g]]);f.push(k);}this._lastRpIdx=k.rpIdx;}return f;},postProcessProsFromToken:function(f){var h=[],g={dfv:B.START_END,n:"ShowBandNames",desc:mstrmojo.desc(14144,"Show band names"),dtp:Q.SHOW_BAND_NAMES};if(this.oi.forms.length>1){var j=Y(d(this.oi.forms[1].ftk));U.forEach(B,function(k){if(Y(k)===j){g.v=k;return false;}});}else{if(this.oi.did!==""){g.v=B.NO;}}h.push(g);return h;}});mstrmojo.ME.BandingDAEditor.getNewDefinition=C;mstrmojo.ME.BandingDAEditor.showAsBandingEditor=Z;}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.css","mstrmojo.Editor","mstrmojo.tooltip","mstrmojo.SearchWidget","mstrmojo.ME._MetricEditorHelper","mstrmojo.ME.BandingDAEditor","mstrmojo.ME.Enum","mstrmojo.ME.FunctionInfo");mstrmojo.requiresDescs(13141);var R=mstrmojo.hash,W=mstrmojo.dom,M=mstrmojo.css,Y=mstrmojo.ME.Enum.SHORTCUT_FUNCTIONS;var D={n:mstrmojo.desc(9590,"Search Result"),did:-1,fns:[]},E={n:mstrmojo.desc(4561,"All Functions"),did:-2,fns:[]},Q={n:mstrmojo.desc(9591,"Metric Templates"),did:-3,fns:[{n:mstrmojo.desc(3273,"Level"),did:Y.Level,desc:mstrmojo.desc(9592,"Create a level metric."),h:"standard_functions_Level"},{n:mstrmojo.desc(9579,"Condition"),did:Y.Condition,desc:mstrmojo.desc(9593,"Create a conditional metric."),h:"standard_functions_condition"},{n:mstrmojo.desc(3324,"Transformation"),did:Y.Transformation,desc:mstrmojo.desc(9594,"Create a transformation metric."),h:"standard_functions_transformation"},{n:mstrmojo.desc(11656,"Row Count"),desc:mstrmojo.desc(11657,"Row Count calculates the total number of rows in the dataset."),did:Y.Row_Count,tks:{items:[{v:"Count",tp:280,oi:{n:"Count",did:"8107C31CDD9911D3B98100C04F2233EA",t:11,st:2816}},{v:"<",tp:60},{v:"Null",tp:259},{v:"=",tp:282},{v:"True",tp:299},{v:",",tp:44},{v:"UseLookupForAttributes",tp:259},{v:"=",tp:282},{v:"False",tp:300},{v:">",tp:62},{v:"(",tp:40},{v:'"*"',tp:261},{v:")",tp:41},{v:"{",tp:123},{v:"~",tp:126},{v:"}",tp:125}]}}]},G={n:mstrmojo.desc(4565,"Select a category:"),did:-4,fns:[]},F=function(Z,a){var b=Z.functionList;Z.openWizard(b.items[b.selectedIndex],a);},H=function(){return mstrmojo.hash.copy(mstrmojo.ME.ENUM.NEW_METRIC_DEFINITION);};var X=function(a){var Z="mstrmojo-ME-fct-tip",b=this.tooltip&&this.tooltip.domNode;if(b){M.toggleClass(b,Z,a);}};mstrmojo.ME.FunctionSelector=mstrmojo.declare(mstrmojo.Editor,[],{scriptClass:"mstrmojo.ME.FunctionSelector",title:mstrmojo.desc(9595,"Select a function or template"),help:"Select_a_Function_dialog_box.htm",isDME:false,functions:null,includeFakeFuncs:true,functionItems:null,selectedCategory:1,selectedIndex:-1,init:function T(Z){this._super(Z);M.addWidgetCssClass(this,"mstrmojo-FunctionSelector");},getFunctionSyntax:function L(g,b){var d=this.functionItems;if(!d){return"";}var e=d[g].fns[b];if(e.did<0){return e.n;}var Z=e.pars,j=e.pros,h=[],a,c;h.push(e.n);j=mstrmojo.hash.clone(j)||[];if(e.ios){j.push({n:"SortBy"});}if(e.sqt===5){j.push({n:"BreakBy"});}if(this.showFullSyntax){if(j.length>0){h.push("<");for(a=0,c=j.length;a<c;a++){h.push(j[a].n);h.push(", ");}h.pop();h.push(">");}}h.push("(");for(a=0,c=Z.length;a<c;a++){h.push(Z[a].n);if(a!==(c-1)){h.push(", ");}}h.push(")");return h.join("");},getFunctionDesc:function P(c,Z){var b=this.functionItems;if(!b){return"";}var a=b[c].fns[Z];return mstrmojo.ME.FunctionInfo.getDescAndExample(a).desc;},getFunctionHelpTopic:function O(c,Z){var b=this.functionItems;if(!b){return"";}var a=b[c].fns[Z];if(a.did===Y.Row_Count){return"";}return mstrmojo.ME.MetricDataService.getFunctionHelpTopic(a.h);},getMetricDefAsTokens:function S(){return this.getTokens();},getTokens:function K(){var a=this.functionList,Z=a.items[a.selectedIndex],b=[];if(Z){if(Z.did<-1){switch(Z.did){case -7:b=Z.tks.items;break;case -4:case -5:case -6:break;}}else{b.push({v:Z.n,oi:Z,isNew:true});}}return b;},onfunctionsChange:function V(){if(!this.functions){return ;}this.selectedCategory=0;this.set("selectedCategory",1);this.set("selectedIndex",-1);var b=mstrmojo.hash.clone(this.functions),Z=b.length;if(!b.add){b=R.make(b,mstrmojo.Arr);}if(Z>=1&&this.includeFakeFuncs){var a=b[mstrmojo.ME.MetricDataService.getBasicCategoryIndex(b)];a.fns.push(Q.fns[0]);if(!this.isDME){a.fns.push(Q.fns[1]);a.fns.push(Q.fns[2]);}else{a.fns.push(Q.fns[3]);}}this.set("functionItems",b);},onPreClose:function N(){this.cleanup();return true;},cleanup:function I(){this.searchWidget.clearSearch();this.set("selectedIndex",-1);},handleCloseAction:function C(){this.close();},clearSearchResult:function U(a){var b=this.fcHBox.fcPulldown,c=this.functionItems,Z=c.length-1;if(Z>-1&&c[Z]===D){if(this.selectedCategory===Z){if(a!==false){this.set("selectedCategory",1);this.set("selectedIndex",-1);}}c.remove(Z);b.refresh();}},clearSearchPattern:function A(){var Z=this.searchWidget;if(Z&&Z.hasRendered){Z.reset();this.clearSearchResult(false);}},openWizard:function J(c,b){var a=this,Z;if(mstrmojo.ME.MetricDataService.isBasicAggMap(c.did)||c.did<-1){Z={zIndex:a.zIndex+10,did:c.did,oi:H};Z.insertMode=false;Z.id="mstrSME";}else{Z={functions:mstrmojo.ME.MetricDataService.getFunctionCatList(),fctOi:c,zIndex:a.zIndex+10,oi:H};Z.id="mstrFE";}Z.insertMode=this.insertMode;if(Z.insertMode){Z.insertOnFinish=this.insertOnFinish;}a.switch2Editor(Z.id,Z);},handleSelectedFunction:function(Z){F(this);},onshowFullSyntaxChange:function B(){this.functionList.onchange();},children:[{scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-FunctionSelector-label",text:mstrmojo.desc(9925,"Functions")},{scriptClass:"mstrmojo.SearchWidget",alias:"searchWidget",cssClass:"mstrmojo-FunctionSelector-search",width:"65px",quickSearch:true,placeholderText:"",onsearch:function(g){var Z=this.parent,f=Z.fcHBox.fcPulldown,d=Z.functionItems,h=Z.functionList.itemDisplayField,e=[],a=function(k){var j=mstrmojo.hash.copy(k),m=j.n,l;try{l=new RegExp(g,"ig");}catch(n){l=new RegExp(mstrmojo.string.regEscape(g),"ig");}if(l.test(m)){j[h]=m.replace(l,function(o){return"<em>"+mstrmojo.string.encodeHtmlString(o)+"</em>";});e.push(j);}},b,c;for(b=0,c=d.length;b<c;b++){if(d[b]===D||d[b].did===E.did){continue;}if(g){mstrmojo.array.forEach(d[b].fns,a);}}D.fns=e;if(d[d.length-1]!==D){d.add([D]);}f.refresh();Z.selectedCategory=0;Z.set("selectedCategory",d.length-1);Z.set("selectedIndex",-1);},onclear:function(Z){if(Z){this.parent.clearSearchResult();}}},{scriptClass:"mstrmojo.HBox",alias:"fcHBox",cssClass:"mstrmojo-FunctionSelector-fctBox",children:[{scriptClass:"mstrmojo.Pulldown",cssClass:"mstrmojo-ME-Pulldown",popupCssClass:"mstrmojo-ME-Pulldown-Popup",alias:"fcPulldown",itemIdField:"did",itemField:"n",items:[],bindings:{items:function(){var a=this.parent.parent.functionItems,b=[];if(!a){return a;}b=mstrmojo.ME.MetricDataService.sortFunctions(a);if(a[0].did!==E.did){var Z=E;Z.fns=b;a.unshift(Z);}return a;},selectedIndex:"this.parent.parent.selectedCategory",value:function(){var Z=this.parent.parent.selectedCategory;return this.items[Z][this.itemIdField];}},onvalueChange:function(Z){var a=this.parent.parent;a.set("selectedCategory",this.selectedIndex);a.set("selectedIndex",-1);if(Z.valueWas===D.did&&this.selectedItem.did!==D.did){this.parent.parent.clearSearchPattern();}}}]},{scriptClass:"mstrmojo.ME.FunctionList",alias:"functionList",itemIdField:"dssid",itemField:"n",itemDisplayField:"dn",items:[{n:"",cls:"wait"}],cssClass:"mstrmojo-FE-functionList mstrmojo-suggest-list",renderOnScroll:false,itemMarkupFunction:function(b,Z,a){return'<div class="mstrmojo-suggest-text '+(b.cls||"fn")+'" idx="'+Z+'"'+(b.did<0?'did="'+b.did+'"':"")+" onmouseover=\"mstrmojo.all['"+a.id+"'].onmouseover(this, event)\" onmouseout=\"mstrmojo.all['"+a.id+"'].onmouseout(this, event)\">"+((a.itemDisplayField&&b[a.itemDisplayField])||b[a.itemField])+'<div class="mstrmojo-Button mstrmojo-Editor-button mstrmojo-WebButton hot tbFunction" t="edt"><div class="mstrmojo-Button-text" t="edt">'+mstrmojo.desc(1088,"Edit")+"</div></div></div>";},bindings:{items:function(){var Z=this.parent.functionItems,a=this.parent.selectedCategory;return(Z&&Z[a].fns)||this.items;},selectedIndex:"this.parent.selectedIndex"},buffer:"",onkeypress:function(l){var j=this,g=l.e,c=g.keyCode||g.charCode,m=mstrmojo.Enum_Keys,Z=function(o){var n=(W.isIE&&!W.isIE9)?o.keyCode:o.charCode;return(n>0)?String.fromCharCode(n):"";},h=this.items,f=h.length,a=this.selectedIndex,b=function(e){j.scrollTo(e);};switch(c){case m.UP_ARROW:this.set("selectedIndex",(a+f-1)%f);break;case m.DOWN_ARROW:this.set("selectedIndex",(a+1)%f);break;default:var d=(this.buffer+=Z(g));if(f>0&&d.length>0){mstrmojo.array.forEach(h,function(o,k,e){var n=new RegExp("^"+d,"i");if(n.test(o[j.itemField])){if(k>-1){this.selectedIndex=-1;this.set("selectedIndex",k);}return false;}},this);}}if(this.selectedIndex>-1){b(this.selectedIndex);}window.clearTimeout(this.tmr);this.tmr=window.setTimeout(function(){j.buffer="";},300);mstrmojo.dom.stopPropogation(l.hWin,g);return false;},onkeyup:function(Z){this.onkeypress(Z);},onchange:function(Z){var b=this.parent;if(this.selectedIndex!==b.selectedIndex){b.set("selectedIndex",this.selectedIndex);}var d=b.selectedCategory,a=b.selectedIndex,c=d>-1&&a>-1;b.set("funcSyntax",c?b.getFunctionSyntax(d,a):"");b.set("funcDesc",c?b.getFunctionDesc(d,a)+"  "+b.getFunctionHelpTopic(d,a):"");if(this.changeByMouse){if(b.selectedCategory>-1&&b.selectedIndex>-1){b.handleSelectedFunction(false);}this.changeByMouse=false;}},onmouseup:function(Z){var b=Z.getTarget(),a=b.getAttribute("t");if(a==="edt"){mstrmojo.dom.stopPropogation(Z.hWin,Z.e);mstrmojo.dom.preventDefault(Z.hWin,Z.e);this.openFunctionEditor();return false;}},openFunctionEditor:function(){var b=this.parent.parent.parent,c=b.getTokenInputBox(),Z={zIndex:b.zIndex+1,insertMode:true,oi:mstrmojo.ME.ENUM.getNewDefinition(),insertOnFinish:function(d){c.insertTokens(d);}},a=this.parent.functionList.selectedItem;if(b.isBanding&&b.isBanding(a.did)){Z={zIndex:b.zIndex+1,insertMode:true,fctOi:a,id:"mstrBDAE_1",oi:mstrmojo.ME.BandingDAEditor.getNewDefinition(),ide:b};}else{if(mstrmojo.ME.MetricDataService.isBasicAggMap(a.did)||a.did<-1){Z.candidates=c.candidates;Z.did=a.did;Z.id="mstrSME_1";Z.useGUIDefault=true;}else{Z.fctOi=a;Z.id="mstrFE_1";Z.paramItemsPath=b.feParamItemsPath;}}Z.modal=true;b.getModalEditor(Z).open(b);},ondblclick:function(Z){var b=this.getItemNodeFromTarget(Z.getTarget());if(b){var a=this.parent;if(a.selectedCategory>-1&&a.selectedIndex>-1){a.handleSelectedFunction(true);}}},useRichTooltip:false,onmouseover:function(b,j){var l=this,a=this.parent,k=a.selectedCategory,d=b.getAttribute("idx"),c=W.eventTarget(window,j),Z=c.getAttribute("t")==="edt";if((!isNaN(d)&&d>-1)||Z){window.clearTimeout(l.hideTmr);var h='<dl class="fct-info"><dt class="fct-syntax">'+a.getFunctionSyntax(k,d)+'</dt><dd class="fct-desc">'+(a.getFunctionDesc(k,d)+"  "+a.getFunctionHelpTopic(k,d))+"</dd></dl>";var m=mstrmojo.dom.position(b,true),n=function(){var p=(l.tooltip&&l.tooltip.domNode.offsetWidth+15)||200,e=m.x,t=m.y-b.offsetHeight/2,r=e<p?"left":"right",q=e<p?mstrmojo.tooltip.POS_TOPLEFT:mstrmojo.tooltip.POS_TOPRIGHT;e=e<p?m.x+m.w+8:e-10;return{arrow_css:r,contentNodeCssClass:"me-tooltip-content "+r,posType:q,left:e,top:t};},g=n(),f="hidden";l.richTooltip=Z?l.getEditBtnTooltip(c,d):{cssClass:f,contentNodeCssClass:"me-tooltip-content "+g.arrow_css,posType:g.posType,left:g.left,top:g.top,content:h,areaId:d};l.useRichTooltip=true;l.hasOpenTooltip=false;l.showTooltip();window.clearInterval(l.posTmr);var o=0;if(!l.posTmr){l.posTmr=window.setInterval(function(){if(l.tooltip){var q=l.tooltip.domNode,p=q.childNodes[1].firstChild,e=g.posType;g=n();if(g.posType!==e){q.style.left=g.left+"px";M.addClass(p,[g.arrow_css]);}window.setTimeout(function(){M.removeClass(q,f);},10);window.clearInterval(l.posTmr);delete l.posTmr;}else{if(o++>10){window.clearInterval(l.posTmr);}}},200);}X.call(this,!Z);}},getEditBtnTooltip:function(Z,a){return{posType:mstrmojo.tooltip.POS_TOPRIGHT,contentNodeCssClass:"me-tooltip-content regular up tbFunction",top:28,left:67,refNode:Z,content:mstrmojo.desc(13141,"Edit function parameters"),areaId:a};},onmouseout:function(){var Z=this;this.hideTmr=window.setTimeout(function(){X.call(Z);Z.hideTooltip();Z.useRichTooltip=false;},500);}},R.copy({slot:"buttonNode",cssText:"text-align: center; float:left;",text:mstrmojo.desc(9563,"Switch to Formula Editor"),title:mstrmojo.desc(9597,"Build a metric formula using metrics, facts, attributes and functions."),closeAfterSwitch:false,getEditor:function(){return this.parent;},postclick:function(){this.getEditor().buttonNode.style.visibility="hidden";},bindings:{visible:function(){return !this.parent.insertMode;}}},R.copy(mstrmojo.ME._MetricEditorHelper.switchRef)),{scriptClass:"mstrmojo.HBox",alias:"buttonBar",slot:"buttonNode",cssClass:"mstrmojo-ME-buttonBox",cellCssClass:"subBox",children:[{scriptClass:"mstrmojo.Button",cssClass:"mstrmojo-Editor-button mstrmojo-WebButton",text:mstrmojo.desc(221,"Cancel"),onclick:function(){this.parent.parent.handleCloseAction();}}]}]});}());(function(){mstrmojo.requiresCls("mstrmojo.List","mstrmojo.ui._HasScroller");var D=mstrmojo.dom;mstrmojo.ME.FunctionList=mstrmojo.declare(mstrmojo.List,[mstrmojo.ui._HasScroller],{scriptClass:"mstrmojo.ME.FunctionList",setupScrollNodes:function C(){this.scrollNode=this.itemsContainerNode;this.scrollNode.style.height=this.scrollboxNode.offsetHeight+"px";this.scrollboxNode=this.itemsContainerNode;},getItemNodeFromTarget:function B(G){var F=mstrmojo.dom.findAncestorByAttr(G,"idx",true,this.domNode);return(F&&F.node)||null;},premousedown:function A(G){this.changeByMouse=false;if(D.isPrimaryMouseBtn(G.e)){var H=this.getItemNodeFromTarget(G.getTarget()),F=H&&parseInt(H.getAttribute("idx"));if(F!==null&&!isNaN(F)&&F!==this.selectedIndex){this.domNode.tabIndex=0;this.domNode.focus();this.changeByMouse=true;}this._super(G);}},premouseup:function E(F){if(D.getButton(F.hWin,F.e)===D.MOUSE_BUTTON.LEFT){this._super(F);return true;}mstrmojo.dom.stopPropogation(F.hWin,F.e);mstrmojo.dom.preventDefault(F.hWin,F.e);return false;}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.DynamicClassFactory","mstrmojo.ListDocSelector","mstrmojo.TextBoxDocSelector","mstrmojo.SearchBoxDocSelector","mstrmojo.MetricQualDocSelector","mstrmojo.MetricSliderDocSelector","mstrmojo.AttrQualDocSelector","mstrmojo._DocActionSelector","mstrmojo._IsThresholdConditionTarget");var C={"default":"ListDocSelector",7:"MetricSliderDocSelector",8:"MetricQualDocSelector",9:"SearchBoxDocSelector",10:"TextBoxDocSelector",11:"AttrQualDocSelector"};mstrmojo.DocSelectorViewFactory=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.DocSelectorViewFactory",getDocSelectorClass:function A(F,G,E,H){var D=C[G.defn.style]||C["default"];if(G.defn.ct==="4"){return(mstrmojo.DynamicClassFactory.newComponent(mstrmojo[D],[mstrmojo._DocActionSelector,mstrmojo._IsThresholdConditionTarget],{scriptClass:"mstrmojo.DocActionXSelector"}));}return mstrmojo[D];},newDocSelector:function B(E,G,D,I){var H=this.getDocSelectorClass(E,G,D,I),F={id:G.id,node:G,model:E};return new H(F);}});mstrmojo.DocSelectorViewFactory.CLASS_MAP=C;}());(function(){mstrmojo.requiresCls("mstrmojo.DocXtabModel","mstrmojo.vi.ui._CanDropFromSchema","mstrmojo.models.template.DataInterface","mstrmojo.vi.models.EnumDragSources","mstrmojo.array","mstrmojo.expr","mstrmojo.func","mstrmojo.hash","mstrmojo.DocDataService","mstrmojo.vi.ui.DatasetUnitMenuUtils");var I=mstrmojo.expr,K=I.FN,L=I.ET,N=mstrmojo.hash,b=mstrmojo.vi.models.EnumDragSources,f=mstrmojo.vi.ui.DatasetUnitMenuUtils,W=mstrmojo.array,P=mstrmojo.string;var H=4,U=12,c="-1";var B=3;function G(o){return o.docModel.controller.cmdMgr;}function a(o,p){var q=o.xtab.k;return[q].concat(o.docModel.getSourceFilterKeys(q,true));}function T(r,p,q,t,o){p.reverse().forEach(function(u){t.push(r.model.getClearThresholdAction(q,o,u.tid));});}mstrmojo.vi.models.DocXtabModel=mstrmojo.declare(mstrmojo.DocXtabModel,[mstrmojo.vi.ui._CanDropFromSchema],{scriptClass:"mstrmojo.vi.models.DocXtabModel",getUnHiddenDrillPathsForCell:function h(o,t){var q=this.getAllDrillPathsForCell(o,t),r=this.docModel.datasets,p=function(u,x){var v=W.find(u,"did",x.id),w=u[v];if(w&&!w.hide){x.n=w.n;return true;}return false;};return W.filter(q,function(w){var u;for(u in r){var v=r[u];if(p(v.att,w)){return true;}}return false;});},getAllDrillWithinPathsForCell:function X(o,r,q){var p=q?this.getUnHiddenDrillPathsForCell(o,r):this.getAllDrillPathsForCell(o,r);return p.filter(function(t){return !!t.within;});},sort:function l(q,r){var o=this;G(this).execute({execute:function p(){var t=o.xtab.k;this.submit(o.docModel.getDataService().getUpdateTemplateAction(t,{act:"sort",sorts:q.sorts,nodeKey:t,subTotalsPos:q.stp||o.getSubTotalsPos(),stt:q.stt||-1}),r);}});},drillGrid:function Y(q,r){var o=this;G(this).execute({execute:function p(){this.submit(o.docModel.getDataService().getDrillGridAction(q),r);}});},getClearThresholdAction:function D(q,o,p){return{act:"clearThreshold",unitId:q,unitType:o,tid:p};},getCreateSimpleThresholdAction:function M(u,r,o,t,q,p){return{act:"threshold",nodeKey:r,thresholds:u,thresholdType:t,basedOnId:q||o,did:o,objType:p};},getZoneFormatAction:function J(w,z,u){var v=[],q=[],t="h",o="g",x="sh",r="sg",p=function(AA,AB){q.push({axis:AA,regions:AB});};if(w==="ch"){p(1,[t]);p(2,[t,o,x]);}else{if(w==="rh"){p(1,[o,x]);}else{if(w==="va"){this.data.gsi.mx.forEach(function(AA){v.push({unitId:AA.did,unitType:4,regions:[o]});});p(1,[r]);p(2,[r]);}}}return{act:"formatGridZone",nodeKey:u,props:z,units:v,axis:q};},getSelectorDataFromViewFilter:function e(q){var o=[],r="The expression is not supported by the View Filter Exception Parser.",u=function u(x){var v=null;if([L.AE,L.ANDOR].indexOf(x.et)>-1||(x.et===L.AQ&&x.fn===K.IS_NULL)){if(!x){return true;}var w=x.nds;v=!(x.not||x.fn===K.NOT||x.fn===K.NOT_IN_LIST);if(w){w.every(function(z){v=v&&u(z);});}}else{throw r;}return v;},p=function p(v,z){var AC=v&&v.nds,AB=v.fn===K.OR;if(AC&&AC.length){var w=z;AC.forEach(function(AD){if(AB){w=[];}p(AD,w);if(AB){z.push(w);}});}else{if(v.fn===K.IS_NULL){var AA=v.a=v.a||{n:"Null Attribute",did:""};z.push({tn:AA.n,tid:AA.did,eid:null,v:""});}else{if(v.et===L.AE){var x=v.es;x.forEach(function(AD){if(P.isEmpty(AD.n)){throw r;}z.push({tn:v.a.n,tid:v.a.did,eid:AD.v,v:AD.n});});}}}return z;};try{if(q){(q.nds||[]).forEach(function(v){o.push({keepOnly:u(v),data:p(v,[])});});}}catch(t){if(t!==r){console.error("vi.models.DocXtabModel: Encountered a problem parsing the view filter expression ("+t+")");}else{return[];}}return o;},getRemoveMetricLimitsAction:function j(o){var q=[],r=[],p=function p(u,v){if(!u){return ;}var t=u.nds;if(t){t.forEach(function(x){var w=x.m;if(w!==undefined){v.push(w.did);}else{p(x,v);}});}};if(o){p(o,q);q.forEach(function(t){r.push({act:"removeMetricLimits",unitId:t});});}return r;},getAddTemplateUnitAction:function C(t,u,q,o){var r=this._super(t,u,q,o),p=a(this,r);if(p.length>0){r.partialRetrieval={nodes:p};}return r;},getRemoveTemplateUnitAction:function k(q){var p=this._super(q),o=a(this,p);if(o.length>0){p.partialRetrieval={nodes:o};}return p;},getAdvancedPropertiesAction:function M(o){return{act:"advancedProperties",props:o};},canShowCellMenu:function d(o){var p,q=this.getCellDataUnion(o);p=!o.stt&&q.some(function(r){return !!r.isSubtotal;});return !p;},getKeepOnlyActionsForAssociatedNodes:function g(p,w,r){var o=this.docModel,v=[o.getKeepOnlyOrExcludeAction(this.xtab.k,p)],q=!!r?r:this.xtab,u=(q.getAssociatedNodes&&q.getAssociatedNodes())||[];w=mstrmojo.func.wrapMethods(w,{success:function t(){W.forEach(u,function(x){o.getPanel().getUnitByKey(x.k).boxContent.raiseEvent({name:"regenerateToolbar"});});}});W.forEach(u,function(x){v.push(o.getKeepOnlyOrExcludeAction(x.k,p));});return{actions:v,callback:w};},getObjectInfo:function E(o){var q=this.xtab.zonesModel,p=null;if(q){(q.getDropZones().zones||[]).some(function(r){return !!r.items.some(function(t){if(t.did===o){p=t;return true;}});});}else{p=this._super(o);}return p;},getObjectInfoFromDataset:function E(o){var p;N.forEach(this.docModel.datasets,function(q){if(!p){p=(q.mx.concat(q.att)).filter(function(r){return r.did===o;})[0];}});return p;},hasDerivedElements:function A(o){var p=this.getObjectInfo(o);return !!(p&&p.de);},isRecursiveAttribute:function Z(o){var p=this.getObjectInfoFromDataset(o);return p&&p.t===12&&p.st===3076;},supportsViewFilterActions:function Q(o){var p=this.getObjectInfo(o);return p&&!p.de&&(p.t!==1)&&(p.t!==47||p.st===12033);},addEditNodeForDatasetAction:function R(p,o){this.augmentDropContextForSchema(p,this.docModel);var t=p.getCtxtDragData(),r=t.src;if(r===b.DATASETS||r===b.ALL_OBJECT_LIST){var q=p.getCtxtDragData().dsid,u=p.actions||[];if(q){u.push({act:"editNode",nodeKey:o,datasetId:q});}p.actions=u;}},getCurrentUnitAxisAndPosition:function m(o){return new mstrmojo.models.template.DataInterface(this.data).getUnitById(o)||null;},getNumberFormatEditorCfg:function V(p){var u=this,o=u.xtab,r=u.data,q=(r.gnf||[]).concat(r.gnfu),z=p.item,x=W.find(q,"id",z.did),v=x===-1?{}:q[x],t=o&&(!o.defn.vis||!o.defn.vis.ve);var w=f.getNumberFormatEditor(p.item,v,function(AE){var AC=u.docModel.getNumberFormatAction(z.did,z.t,AE),AB=!!AC.partialRetrieval,AD,AA;if(AB){AD=mstrmojo.DocDataService.REQUEST_DEFN_DATA;AA={treesToRender:3};}o.controller.submitUndoRedoTemplateUpdates(o,AC,u.docModel.controller._getXtabCallback(o,undefined,AB),AD,AA);});return w;},showNumberFormat:function(t){var r=[1,2,8,9,11],q;if(t.t===12){var o=new mstrmojo.models.template.DataInterface(this.xtab.node.data),v=o.getRowTitles().titles.concat(o.getColTitles().titles),p=W.filterOne(v,function(w){return t.did===w.id;}),u=((p&&p.fs)||[]).map(function(w){return w.id;});q=(t.fs||[]).some(function(w){return r.indexOf(w.bftp)!==-1&&u.indexOf(w.fid||w.id)!==-1;});}return(t.t===4&&t.did!==c)||q;},openThresholdEditor:function(AE,t,AA){var r=this,p=r.xtab,AC=r.docModel,z=r.data,AB=z.gsi,x=AE.did,o=mstrmojo.desc(3647,"Thresholds");if(AE.t===H||AE.t===U){var w=N.clone(AB.mx),v;w.forEach(function(AF){AF.t=4;});v=AB.rows.concat(AB.cols,w).filter(function(AH){var AF=AH.t,AI=AH.st,AG=AH.did;return !((AF===1&&AI===257)||(AF===47&&AI===12032)||(r.hasDerivedElements(AG))||(AG==="-1")||(AF===14));});v.forEach(function(AH){if(AH.t===12){var AG=this.getObjectInfo(AH.did);AH.da=AG?AG.da:undefined;}else{if(AH.t===4){var AF=this.getObjectInfoFromDataset(AH.did);AH.dt=AF&&AF.dt;}}},this);if(x!==c){o+=" - "+AE.n;}var u=mstrmojo.threshold.ThresholdModel.FEATURES,AD=new mstrmojo.threshold.ThresholdController({metricId:x,objectType:AE.t,title:o,data:z,targets:v,messageId:AC.mid,datasets:AC.datasets,dataService:AC.getDataService(),supportsFeature:function q(AH){switch(AH){case u.SHOW_ADVANCED_EDITOR:return !t;case u.SHOW_BASED_ON:return !t;case u.SHOW_IMAGE:return AA;case u.SHOW_VALUE_ITEM:var AG=r.getObjectInfoFromDataset(this.model.basedOnId),AI=AG&&AG.dt,AF=[8,9,10,14,15,16,30];return !AI||AF.indexOf(AI)===-1;}},onSubmitActions:function(AN,AH,AG,AI,AL,AM,AF){var AK=this,AJ=[];if(AH){T(p,AH,AG,AJ,AF);}AJ.push(r.getCreateSimpleThresholdAction(AN,p.k,AG,AL,AI,AF));p.controller.submitUndoRedoTemplateUpdates(p,AJ,{success:function(){if(AM){AK.set("data",r.data);AK.openEditor();AM=false;}}});},onSaveThresholds:function(AH,AF,AG,AJ,AI){this.dataService.saveThresholds(N.copy(AJ,{thresholds:JSON.stringify(AH),basedOnId:AF,thresholdType:AG}),AI,{hideFailureErr:true});},onLoadThresholds:function(AG,AH){var AF=this.model;this.dataService.getThresholds({thresholdsID:AH},{success:function(AN){var AM=AN.thresholds,AJ=[],AI,AO,AL={};W.forEach(AM||[],function(AP){AI=I.findTargets(AP.expr,"did");AO=true;N.forEach(AI,function(AQ,AR){if(!r.getObjectInfo(AR)){AL[AR]=AQ.n;AO=false;}});if(AO){AJ.push(AP);}});if(!N.isEmpty(AL)){var AK=N.valarray(AL);mstrmojo.alert(mstrmojo.desc(null,"The following objects: '#' are not on the template, so some thresholds will not be loaded...").replace("#",AK.join(",")));}AF.addThresholds(AJ);}});}});if(AE.t===U){AD.model.editorMode=mstrmojo.threshold.ThresholdModel.EDITOR_TYPES.ADVANCED_EDITOR;}AD.openEditor();}},buildThresholdMenuOptions:function S(u,p,t,AA){var r=this,o=r.xtab,z=r.data,AB=z.gsi,q=AB.thresholds,AC=p.item,x=AC.did,w=q&&q[x],v=mstrmojo.desc(13261,"Clear Thresholds");if(AC.t===H||AC.t===U&&!r.docModel.isOldDEObject(x)){u.addMenuItem(mstrmojo.desc(6050,"Thresholds..."),"",function(){r.openThresholdEditor(AC,t,AA);},this);if(x!==c){if(w){u.addMenuItem(v,"",function(){var AD=[];T(o,w,x,AD,AC.t);o.controller.submitUndoRedoTemplateUpdates(o,AD);},this);}}}},moveSubTotals:function O(o,p){var u=this,t=this.xtab.gridInfo.sorts,r=o.data.axis,w=t[r-1],q=!!(w.length&&w[0].key!==("0!00000000000000000000000000000000!!!!"+r));G(this).execute({execute:function v(){var z=u.xtab,x=z.k;this.submit(u.docModel.getDataService().getUpdateTemplateAction(x,{act:"moveSubTotal",nodeKey:x,sorts:q?t:[],subTotalsPos:p,stt:-1,axis:r}),z.controller._getXtabCallback(z));}});},getAttributeFormsInTemplate:function(q){var o=this.data.gts,p=[];(o.row||[]).concat(o.col||[]).forEach(function(r){if(r.id===q){p=p.concat(r.fs);}});return p;},getPivotFormAction:function(AA,p){var q=this.getCellTitleInfo(AA),w=q.title,r=w.fs,v=(r&&r.length)||0,t=w.id,u=this.getAttributeFormsInTemplate(t),z=v>1?(AA.idx%u.length):(w.fix-1),o=u[z],x;if(p==="l"){x=z-1;}else{if(p==="r"){x=z+1;}}return{act:"pivot",unitPos:x+1,attFormId:o.id,unitId:t};},getValuesDefaultFormatGridZoneAction:function(r){var q={},u=mstrmojo.models.FormatModel,p,w=this.xtab,v=w.gridInfo.fmts,t=[];N.forEach(r,function(x){t.push({unitId:x.did,unitType:H,regions:["g"]});});var o;N.forEach(v&&v.va,function(z,x){o=u.getFormatPropertyInfo(x);if(o){q=N.mergeHashes(q,u.getFormatUpdate(x,(o.pt==B)?z:u.decodeValue(x,z)));}});p=w.model.getZoneFormatAction.call(w.model,"va",q,w.k);p.units=[].concat(t);return p;},isRecursiveAttribute:function Z(o){var p=this.getObjectInfoFromDataset(o);return p&&p.t===12&&p.st===3076;},getRAExpandAction:function F(q,t,r){var p=this.getCellTitleInfo(q).title,o={act:"raExpandCollapse",unitId:p.id,sliceId:t,depth:q.dpt,ordinal:(q.o!==undefined)?q.o:q._ei,isExpand:r?1:(q.epd?0:1)};if(r){o.expand_dsts=1;}return o;},getRAExpandAllAction:function n(p,o){return{act:"raExpandCollapseAll",unitId:p,isExpandAll:o?1:0};},getUnitNameInDataSet:function(o){return this.docModel.findUnitNameInDataSetFromUnit(o);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi.models.DocXtabModel","mstrmojo.array","mstrmojo.func","mstrmojo.EnumRWUnitType");var B=mstrmojo.array;var D="Metrics",C=2;mstrmojo.vi.models.DocVisModel=mstrmojo.declare(mstrmojo.vi.models.DocXtabModel,null,{scriptClass:"mstrmojo.vi.models.DocVisModel",getSelectedAttributeElementIdStr:function(M){var L=M[0],E=L.tid,F,G=L.selections,H=[],J=[];B.forEach(G||[],function(N){H=H.concat(B.filter(N,function(O){return O.tid===E;}));});H=B.distinct(H,"eid");(H||[]).forEach(function(N){J.push(N.eid);});F=J.join("\u001E");var K=this.scm,I=(E&&K[E]);if(I){if(I.showall){if(J.length===0){F="OA:(All)";}}}return F;},getAction:function A(P){var N=P[0],H=N&&N.at,J=N.anchor,Q=N.isClearAll,E=N.tid,F,G=N.selections,L=[];F=this.getSelectedAttributeElementIdStr(P);if(G.length!==0&&F===""){return null;}var I;if(H){if((H&C)>0){var M=this.scm;var K=(E&&M[E])||M[D];if(K){var O=this.xtab;if(F!==""){I={h:"onGridSelector",a:{type:mstrmojo.EnumRWUnitType.GRID,anchor:J,ck:K.ck,tks:K.tks,eid:F,ctlKey:K.ckey,sliceId:O.sid,isUConDS:K.isUConDS,isDocVis:true}};}}}}return I;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocSelectorViewFactory","mstrmojo.RadioList","mstrmojo.CheckList","mstrmojo.ListBoxHoriz","mstrmojo.ListBoxSelector","mstrmojo.LinkList","mstrmojo.ButtonList","mstrmojo.DropDownList","mstrmojo.Slider","mstrmojo.AttributeSlider","mstrmojo.TextBoxSelector");var E=mstrmojo.DocSelector.STYLES;var F={};F[E.RADIO]=["RadioListHoriz","RadioList"];F[E.CHECKBOX]=["CheckListHoriz","CheckList"];F[E.LIST]=["ListBoxHoriz","ListBoxSelector"];F[E.LINK]=["LinkListHoriz","LinkList"];F[E.BUTTON]=["ButtonListHoriz","ButtonList"];F[E.SCROLLER]="AttributeSlider";F[E.METRIC_SLIDER]="MetricSlider";F[E.METRIC_QUAL]="MetricQualification";F[E.SEARCH_BOX]="SearchBoxSelector";F[E.TEXT_BOX]="TextBoxSelector";var D={_mixinName:"_oivmDocSelector",preBuildRendering:function C(){var Q=this._super(),O=this.style,I=this.children[0],J=this.node,P=J.defn,U=P.horiz,S=this.getFormats(),K,V,T,X,W=O===E.PULLDOWN;if(P.hm===0&&O!==E.SCROLLER&&O!==E.METRIC_SLIDER){this.contentNodeCssText+="overflow-"+(U?"x":"y")+":hidden;";}if(S){I.color=K=S.color;V=S.height;T=S["background-color"];X=S["text-decoration"];if(X){mstrmojo.css.addWidgetCssClass(this,X);}}if(W){if(S){if(K){this.itemCssText+="color:"+K+";";}}I.cssText=this.itemCssText;}else{I.cellCssClass="";I.tableCssText="table-layout:"+((P.iwm===0)?"fixed":"auto")+";";if(V!==undefined){if(O===E.LIST){if(V.indexOf("px")==V.length-2){var N=parseInt(V.substr(0,V.length-2));if(N>4){N=N-4;}V=N+"px";}}I.cssText="height:"+V+";";}if(O===E.LIST&&T){I.cssText+="background-color:"+T+";";}switch(O){case E.RADIO:case E.CHECKBOX:I.labelCssText=this.itemCssText;break;case E.BUTTON:case E.LINK:case E.LIST:if(O===E.BUTTON){if(K){this.itemCssText+="color:"+K+";";}}if(U){this.itemCssText+="height:"+V+";";}I.itemCssText=this.itemCssText;this["background-color"]=T;break;}}var R=this,M=R.model.getTargetInfoWin(P.tks),L=(W&&I.list)?I.list:I;if(P.ifw||(M&&M.length)){L.makeSelection=function(Y){R.showInfoWin(Y&&Y.selItem);};if(L.selectionPolicy!==undefined){if(!P.multi){L.selectionPolicy="reselect";}if(!L.makeSelHandler&&P.ct!=="4"){L.makeSelHandler=L.attachEventListener("selectionChange",L.id,function(Z){if(Z){var b=Z.added||[],a=Z.removed||[],Y=b.length?b[0]:a[0];if(Y!==undefined&&Y!==null&&I.hasRendered){if(W){this.makeSelection({selItem:I.domNode});}else{this.makeSelection({selItem:this._getItemNode(Y)});}}}});}}}return Q;},newPulldown:function H(I){return new mstrmojo.DropDownList({k:I.ck,cssDisplay:"block",cssClass:"mstrmojo-DocSelector-DropDownList",selectCssClass:"mstrmojo-DocSelector-DropDownList-select",onselectedChange:function(){if(!I._inSyncPhase){I.showInfoWin();I.selectorControlChange(this);}}});},getWidgetClass:function B(L,K,J){var I=F[K];if(I){if(I.constructor===Array){I=I[J?0:1];}return I;}else{return this._super(L,K,J);}}};mstrmojo.OIVMDocSelectorViewFactory=mstrmojo.declare(mstrmojo.DocSelectorViewFactory,null,{scriptClass:"mstrmojo.OIVMDocSelectorViewFactory",getDocSelectorClass:function A(J,K){var I=this._super(J,K);return mstrmojo.DynamicClassFactory.newComponent(I,[D],null);},getOIVMDocSelectorMixin:function G(){return D;}});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.hash","mstrmojo.dom","mstrmojo.Editor","mstrmojo.SaveAsEditor","mstrmojo._FormatDefinition","mstrmojo.ME.MetricDataService","mstrmojo.ME.MetricFormatEditor","mstrmojo.ColorPicker","mstrmojo.ME.MetricEditBox","mstrmojo.InlineEditBox","mstrmojo.MenuButton","mstrmojo.ME._MetricEditorHelper","mstrmojo.ME.FunctionSelector");mstrmojo.requiresDescs(517,1763,2213,9559,9562,11897);var B=mstrmojo.desc,M=mstrmojo.dom;var N=mstrmojo.expr,C={functionSelector:0,advanced:65536,simple:131072,func:196608},L=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS;function K(E,P){var O=[];E.oi.tks.met=C.functionSelector;E.oi.tks.items=O;P.clearTokens(O);}mstrmojo.ME.MetricEditor=mstrmojo.declare(mstrmojo.Editor,[mstrmojo.ME._MetricEditorHelper],{scriptClass:"mstrmojo.ME.MetricEditor",cssClass:"mstrmojo-MetricEditor",zIndex:10,title:B(517,"Metric"),help:"Metric_Formula_Editor.htm",getMetricEditBox:function J(){return this.metricEditBox;},getTokenInputBox:function J(){return this.metricEditBox.inputBox;},isEmpty:function D(){return this.getMetricDefAsTokens().length===0;},onObjectInsert:function F(O){var P=this.metricEditBox.inputBox,E={v:mstrmojo.ME.MetricToken.brackets(O.n),oi:O,isNew:true};P.insertTokens([E]);this.closePopup();},onOpen:function A(){var O=this,E=this.oi,P=this.metricEditBox,Q=P.inputBox;this._setupCandidatesCache(Q);Q.noCache=this.noCache;Q.useKeyDelay=this.useKeyDelay;this.set("title",B(9559,"Formula Editor:")+" "+E.n);if(E&&E.tks){this.preprocessTokenStram(E.tks);Q.set("items",E.tks.items);}P.set("iStatus","");P.set("vStatus",E.tks.items.length>0?this.vStatus:mstrmojo.ME.MetricEditBox.VALIDATION_STATUS.UNKNOWN);if(Q.items.length===0){this.set("cValid",false);}},getMetricDefAsTokens:function G(){return(this.oi.tks.items);},onClose:function I(){if(this._super){this._super();}this.vStatus=mstrmojo.ME.MetricEditBox.VALIDATION_STATUS.UNKNOWN;this.metricEditBox.inputBox.set("items",[]);this.metricEditBox.inputBox.resetTokensCache();},handleValidation:function H(E){this.metricEditBox.handleValidation(E);},children:[mstrmojo.ME._MetricEditorHelper.formatAndOptionsBarRef,mstrmojo.ME._MetricEditorHelper.nameEditBoxRef,{scriptClass:"mstrmojo.List",cssClass:"mstrmojo-ME-ops",items:[{t:1,v:"+",cls:"plus"},{t:1,v:"-",cls:"minus"},{t:1,v:"*",cls:"multi"},{t:1,v:"/",cls:"divide"},{t:1,v:"()",cls:"par"},{t:1,v:"<>",cls:"bra"},{t:3,v:"V",cls:"clear right",n:B(1763,"Clear all")},{t:2,v:"",cls:"validate right",n:B(11897,"Validate")}],itemMarkupFunction:function(O,E){if(O.t===1){return'<div class="mstrmojo-item '+O.cls+'" idx='+E+' title="'+(O.n||"")+'">'+(O.n||"")+"</div>";}return'<div class="mstrmojo-Button mstrmojo-WebHoverButton '+O.cls+'"><div class="mstrmojo-Button-text" idx='+E+">"+(O.n||"")+"</div></div>";},onmouseup:function(X){var S=X.hWin,T=X.e,E=mstrmojo.dom.eventTarget(S,T),W=E.getAttribute("idx")||-1;this.set("selectedIndex",W);var V=this.parent,Q=V.metricEditBox,R=Q.inputBox,P=this.selectedItem,Z=P.v.split(""),U=[];if(M.getButton(X.hWin,X.e)===M.MOUSE_BUTTON.LEFT){switch(P.t){case 1:mstrmojo.array.forEach(Z,function O(a){U.push({v:a,isDelimiter:true,isNew:true});},this);var Y=R.insertTokens(U);if(U.length===2){R._delaySetTextCaretPos(R.itemsContainerNode.childNodes[Y]);}break;case 2:Q.set("vStatus",L.VALIDATING);V.tbValidate=this;V.validateSyntax(this);break;case 3:K(V,R);R.raiseChangeEvent({type:"clear"});break;}}}},{scriptClass:"mstrmojo.ME.MetricEditBox",alias:"metricEditBox",bindings:{browseItemVisible:"!this.parent.isDME",candidates:"this.parent.candidates"},ontokensModify:function(O){this.parent.onmetricModify();var E=this.inputBox.items.length;this.parent.set("cValid",E>0);if(E===0){this.parent.btnSwitch.set("enabled",true);}},continueValidataion:function(){var E=this.parent;E.validateSyntax(E.tbValidate);}},{scriptClass:"mstrmojo.Button",alias:"btnSwitch",cssClass:"mstrmojo-ME-switch mstrmojo-Editor-button mstrmojo-WebButton",text:B(9562,"Switch to Function Editor"),bindings:{enabled:function(){var O=this.parent.metricEditBox.vStatus===L.ERROR&&!this.parent.cValid,E=parseInt(this.parent.oi.tks.met,10),P=!O&&(!E||(E&&E!==C.advanced)),Q=this.parent.metricEditBox.inputBox.items.length===0;return P;}},onclick:function(){var O=this.parent;var E=function(S){var T=S.oi,Q=T.tks.met||C.functionSelector,P={zIndex:S.zIndex+1,candidates:S.candidates,oi:T,did:T.did,insertMode:false},U={0:"functionSelector",131072:"simpleMetricRef",196608:"wizard"}[Q],R={0:"mstrFSE",131072:"mstrSME",196608:"mstrFE"}[Q];if(Q===C.functionSelector||Q===C.func){P.functions=S.functions;}if(U){if(S.dirty){P.dirty=S.dirty;}S.switch2Editor(R,P);}};if(O.metricEditBox.inputBox.items.length===0){O.close();O.ide.browsersContainer.funcBrowser.handleSelectedFunction();}else{O.cbSwtichEditor=E;O.tbValidate=this;O.validateSyntaxAndSwitch(this,"switch");}},slot:"buttonNode"},mstrmojo.ME._MetricEditorHelper.buttonBarRef]});}());(function(){mstrmojo.requiresCls("mstrmojo.hash","mstrmojo.css","mstrmojo.Box","mstrmojo.Pulldown","mstrmojo.Label","mstrmojo.TextBoxWithLabel","mstrmojo.ME.MetricEditor","mstrmojo.ME._MetricEditorHelper","mstrmojo.ME.FunctionInfo");mstrmojo.requiresDescs(1952,2213,8950,9560);var N=mstrmojo.hash,Z=mstrmojo.css,M=mstrmojo.ME._MetricEditorHelper,c=mstrmojo.ME.MetricDataService;var B=null;mstrmojo.ME.ENUM={METRIC_ACTIONS:{ADD:"add",EDIT:"edit",EIDT_NEW:"editNew"},EDITOR_IDS:{ADVANCED:"mstrME",FORMULA:"mstrME",WIZARD:"mstrFE",SIMPLE:"mstrSME",SELECOTR:"mstrFSE"},EDITOR_TYPES:{ADVANCED:"ADVANCED",FUNCTION:"FUNCTION",SIMPLE:"SIMPLE",SELECTOR:"SELECTOR"},METRIC_EDIT_TYPES:{ADVANCED:65536,SIMPLE:131072,FUNCTION:196608},METRIC_TYPES:{65536:"ADVANCED",131072:"SIMPLE",196608:"FUNCTION"},NEW_METRIC_DEFINITION:{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}},getNewDefinition:function(){return{did:"",n:mstrmojo.desc(2213,"New Metric"),tks:{items:[],vs:0,vm:""},mhfts:{},mvfts:{}};}};var F=function(d){d=N.copy(d,{left:0,top:0});this.left=(parseInt(this.left||this.editorNode.style.left,10)||0)+d.left+"px";this.top=(parseInt(this.top||this.editorNode.style.top,10)||0)+d.top+"px";};var U=function(e){var h=this,d=h.isDME,g=e.id,f=g.replace("_1",""),j=h.getEditorHelpTopic(f);var k={scriptClass:h.getEditorScriptClass(f),id:g,isDME:d,zIndex:h.zIndex++,oi:e.oi,bindings:{functions:h.funcsPath||"mstrmojo.all.mstrMetricIDE.functions",candidates:h.candidatesPath||"mstrmojo.all.mstrMetricIDE.candidates",dsUnits:"this.ide.dsUnits",attrCandidates:"this.ide.attrCandidates"},tbBrowsable:!d,tbFormatable:!d,ide:h};if(j){k.help=j;}N.copy(e,k);return k;};var A=function(d){var f=this.getEditorId(d),e=mstrmojo.all[f];if(!e){e=mstrmojo.insert(U.call(this,d));e.onvisibleChange=F;e.onPostClose=function(){this.destroy();};}N.copy(d,e);e.candidates=null;e.set("candidates",this.candidates);return e;};var E=function(d){var h=this,g=d.oi;if(h.setExtraMetricTokens){h.setExtraMetricTokens(g);}var f=this.getEditorId(d);var e=mstrmojo.all[f];if(!e){var j=mstrmojo.hash.copy({slot:"editorsContainerNode",left:"0px",top:"0px",modal:false,showTitle:false,postCreate:function(){Z.addWidgetCssClass(this,"mstrmojo-MetricIDE-editor inline");},onPostClose:function(){var k=h.curtain;if(k){k.set("visible",false);k.set("refNode",null);}h.editorConfig=null;h.set("editor",null);},onCancel:function(){h.close();},onSaved:function(){h.close();},switch2Editor:function(l,k){if(k){k.id=l;}h.set("editorConfig",{editorId:l,cfg:k});}},U.call(this,d));if(h.isExpEditor(f)){j.onvisibleChange=function(){var r=B,k=h.browsersContainer.ob,t=this.visible,p=250;if(t){k.set("visible",t);var m=h.browsersContainer.funcBrowser,l=m.functionList,o=l.domNode,n=o.querySelector&&o.querySelector(".mstrmojo-suggest-text.fn[idx]");if(n){var q=n.lastChild;Z.addClass(q,"forceDisplay");window.setTimeout(function(){l.richTooltip=l.getEditBtnTooltip(q);mstrmojo.tooltip.open(l);window.setTimeout(function(){Z.removeClass(q,"forceDisplay");l.hideTooltip();},1000);},p);}}else{k.set("visible",t);}Z.toggleClass(h.editorNode,"exp",t);Z.addClass(h.editorNode,"transition-left");mstrmojo.dom.center(r.editorNode);window.setTimeout(function(){Z.removeClass(h.editorNode,"transition-left");F.call(h);},p);};}if(h.configInlineEditor){h.configInlineEditor(j);}e=mstrmojo.insert(j);e.attachEventListener("fctDidChange",h.browsersContainer.funcBrowser.id,"onfctDidChange");h.addChildren([e]);}else{e.set("oi",g);e.candidates=null;e.set("candidates",h.candidates);}if(d.useGUIDefault!==true){e.useGUIDefault=false;}h.set("editor",e);h.set("help",e.help);return e;};function L(){var f=this,h=500,e=function(k){var j=(k&&k.items)||[],l=f.candidates||{items:[]};l.items=l.items.concat(j);l.isComplete=l.isComplete&&(k.bc===-1||(k.bb+k.bc>k.sz));if(f.functions){l.items=l.items.concat(c.sortFunctions(f.functions));}f.candidates=null;f.set("candidates",l);},d=function(j){mstrmojo.alert(j.getResponseHeader("X-MSTR-TaskFailureMsg"));},g=function(j){if(j){var k={items:j.items,isComplete:(j.bc===-1||(j.bb+j.bc>j.sz))};f.candidates=k;}c.getMetrics({rootFolderType:c.rootFolderTypes.ALL,pattern:"*",blockBegin:1,blockCount:h},{success:e,failure:d});};if(!this.noCache&&!this.candidates){c.getMetricComponents({rootFolderType:c.rootFolderTypes.ALL,pattern:"*",blockBegin:1,blockCount:h},{success:g,failure:d});}else{e({bc:-1,mcComplete:true});}}var W=function(f,h){var g=null,e=function(m,k){if(!mstrmojo.all[h.id]||mstrmojo.all[h.id]._timeStamp!==k){return ;}if(m&&m.tks){M.preprocessTokenStram(m.tks);M.checkEditorFallback(c.sortFunctions(h.functions),m);}h.set("oi",m);if(!h.action.n){h.set("title",mstrmojo.desc(11579,"Metric Editor")+" - "+m.n);}if(h.action.cmd!==mstrmojo.ME.ENUM.METRIC_ACTIONS.ADD){var l=h.showAsSimpleIDE(m);h.set("showLeftPanel",!l);E.call(h,{id:h.editorId,oi:m,functions:g,simple:l}).open(h);}},d=function(k){mstrmojo.alert(k.getResponseHeader("X-MSTR-TaskFailureMsg"));},j=function(l){try{if(!mstrmojo.all[h.id]){return ;}g=h.filterFunctions(l);h.set("functions",g);L.call(h);h.loadObjectDefn({success:function(m){e(m,h._timeStamp);},failure:d});}catch(k){}};c.getFunctions({success:j,failure:d});};mstrmojo.ME.MetricIDE=mstrmojo.declare(mstrmojo.Editor,[],{scriptClass:"mstrmojo.ME.MetricIDE",cssClass:"mstrmojo-MetricIDE",id:"mstrMetricIDE",_timeStamp:0,title:mstrmojo.desc(11579,"Metric Editor"),help:" ",zIndex:4,noCache:true,editorId:null,editor:null,editorConfig:{editorId:null,cfg:{}},getEditorHelpTopic:function R(d){switch(d){case"mstrME":return"metric_expression_editor_for_html5_dashboards.htm";}return"metric_function_editor_for_html5_dashboards.htm";},getEditorScriptClass:function H(d){return"mstrmojo.ME."+{mstrFE:"FunctionWizard",mstrSME:"SimpleMetricEditor",mstrME:"MetricEditor",mstrRFE:"RankEditor",mstrOFE:"OLAPEditor"}[d];},oneditorConfigChange:function O(){var e=this.editorConfig,d=e.cfg;if(this.editor){this.editor.close();}E.call(this,d).open(this,d);},showLeftPanel:true,onshowLeftPanelChange:function K(){Z.toggleClass(this.editorNode,"simple",!this.showLeftPanel);if(this.editor){this.editor.set("simple",!this.showLeftPanel);this.browsersContainer.funcBrowser.set("showFullSyntax",this.isExpEditor(this.editor.id));}var d=this.getBrowsersContainer().domNode.offsetWith/2||120;this.set("left",(parseInt(this.left||this.editorNode.style.left,10)||0)+(this.showLeftPanel?-1:1)*d+"px");if(this.showLeftPanel){this.browsersContainer.funcBrowser.functionList.refresh();}},filterFunctions:function b(d){return d;},isExpEmpty:function a(){var d=mstrmojo.all.mstrME;return d&&d.getMetricDefAsTokens().length===0;},init:function T(f){if(this._super){this._super(f);}var g=mstrApp,d=g&&g.useQuickSearch&&g.useQuickSearch(),e=d?((g&&g.searchAutoCompleteDelay&&g.searchAutoCompleteDelay())||0):0;this.suggestDelay=e||200;this.noCache=this.noCache&&d&&!this.isDME;c.suggestDelay=this.suggestDelay;c.noCache=this.noCache;B=this;this._timeStamp=mstrmojo.now();},onClose:function D(){if(this.editor){this.editor.close();}this.browsersContainer.funcBrowser.cleanup();this.destroy();},onOpen:function I(){F.call(this);this.set("showLeftPanel",true);W(this.metricId||this.did,this);this.set("title",mstrmojo.desc(11579,"Metric Editor")+" - "+(this.action.n||mstrmojo.desc(2213,"New Metric")));B=this;},setExtraMetricTokens:mstrmojo.emptyFn,getTokenInputBox:function C(){return mstrmojo.all.mstrME.metricEditBox.inputBox;},insertTokens:function(d){return this.getTokenInputBox().insertTokens(d);},onObjectInsert:function(d){mstrmojo.all.mstrME.onObjectInsert(d);},setRefOi:mstrmojo.emptyFn,children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-MetricIDE-browsers-container",alias:"browsersContainer",children:[{scriptClass:"mstrmojo.ME.FunctionSelector",cssClass:"mstrmojo-MetricIDE-editor inline",alias:"funcBrowser",left:"0px",top:"0px",modal:false,showTitle:false,bindings:{functions:function(){return this.parent.parent.functions;},oi:function(){return this.parent.parent.oi||mstrmojo.ME.ENUM.getNewDefinition();},isDME:function(){return this.parent.parent.isDME;},activeEditor:function(){var d=this.parent.parent.editor;this.buttonNode.style.visibility=this.parent.parent.editor?"hidden":"visible";if(d){this.set("showFullSyntax",B.isExpEditor(d.id));}}},onfctDidChange:function(f){var e=Math.max(0,c.getCategoryIndex(f.did)),d=this.fcHBox.fcPulldown,h=d.selectedItem.did;if(h<0){return ;}d.set("value",c.getFunctionCatList()[e].did);var g=this.functionList;window.setTimeout(function(){e=mstrmojo.array.find(g.items,"did",f.did);g.singleSelect(e,false);},100);},switch2Editor:function(e,d){if(d){d.id=e;}B.set("editorConfig",{editorId:e,cfg:d});},handleCloseAction:function(){if(this.onPreClose()){B.close();}},handleSelectedFunction:function(h){var d=this;var f=B.editor;if(f&&B.isExpEditor(f.id)){if(h){B.insertTokens(d.getTokens());var e=function(j){return !isNaN(j)&&j<0;};if(!e(this.functionList.selectedItem.did)){B.getTokenInputBox().insertParenthesisTokens();}}}else{var g=d.functionList;d.openWizard(g.items[g.selectedIndex]);}},openWizard:function(g,f){B.help=B.getEditorHelpTopic("mstrFE");if(!g||g.did===-7){return ;}var e=B,d={zIndex:e.zIndex+1,candidates:e.candidates,oi:mstrmojo.ME.ENUM.getNewDefinition()};if(c.isBasicAggMap(g.did)||g.did<-1){d.did=g.did;d.id="mstrSME";d.useGUIDefault=true;}else{d.fctOi=g;d.id="mstrFE";d.paramItemsPath=e.feParamItemsPath;}e.setRefOi(d);e.set("editorConfig",{cfg:d,opener:f});}}]},{scriptClass:"mstrmojo.Box",alias:"editorsContainer",cssClass:"mstrmojo-MetricIDE-editors-container",children:[{scriptClass:"mstrmojo.Label",cssText:"line-height:380px; text-align:center;",text:mstrmojo.desc(11567,"Select a function from left"),bindings:{visible:"!this.parent.parent.editor",editor:function(){return !this.parent.parent.editor;}}}]},{scriptClass:"mstrmojo.ME.FunctionInfo",slot:"buttonNode",alias:"funcSyntaxDesc",bindings:{foi:function(){return this.parent.browsersContainer.funcBrowser.functionList.selectedItem;},showFullSyntax:function(){return this.parent.browsersContainer.funcBrowser.showFullSyntax;}}}],getBrowsersContainer:function Y(){return this.browsersContainer;},renderObjectsBrowser:function X(){var e=this;var d=this.getBrowsersContainer();if(d){d.addChildren([{scriptClass:"mstrmojo.ObjectBrowser",cssClass:"mstrmojo-MetricIDE-ob",alias:"ob",fishEyeVisible:false,closeable:false,closeOnSelect:false,quickSearch:true,visible:false,bindings:{visible:function(){var f=this.parent.parent.editorRef;return f&&f.id==="mstrME";}},onvisibleChange:function(){if(this.visible&&!this.loaded){this.browse({folderLinksContextId:23,onSelectCB:[e,"onObjectInsert"],useDblSelect:true,browsableTypes:""});this.loaded=true;}},postCreate:function(){this.children=[{scriptClass:"mstrmojo.Label",text:mstrmojo.desc(1952,"All objects"),cssClass:"mstrmojo-MetricIDE-obLabel"}].concat(this.children);}}]);}},postBuildRendering:function(){if(this._super){this._super();}this.addSlots({editorsContainerNode:this.editorsContainer.domNode});this.renderObjectsBrowser();this.set("help",this.getBrowsersContainer().funcBrowser.help);},loadObjectDefn:function V(f){var d=this.metricId||this.did;if(d){c.getMetricDefintion({id:d,msgID:this.isDME?mstrApp.getMsgID():null},f);}else{var e=mstrmojo.ME.ENUM.getNewDefinition();f.success(e);}},isExpEditor:function S(d){return d==="mstrME";},getModalEditor:function Q(d){this.setRefOi(d);return A.call(this,d);},getEditorId:function P(e){var g=e.oi,d=g&&g.tks&&g.tks.met;var f=e.id||{65536:"mstrME",131072:"mstrSME",196608:"mstrFE"}[d]||"mstrME";if(f==="mstrSME"||f==="mstrFE"||f==="mstrSME_1"||f==="mstrFE_1"){f=M.getSpecialFunctionEditorId(this.getRootFunction(e),e.modal)||f;}e.id=f;return f;},showAsSimpleIDE:function G(d){var e=false;if(this.isDME&&d.did&&d.tks){e=parseInt(d.tks.met,10)!==mstrmojo.ME.ENUM.METRIC_EDIT_TYPES.ADVANCED&&!mstrmojo.string.isEmpty(M.getSpecialFunctionEditorId(d.tks.items[0].oi));}return e;},getRootFunction:function J(d){var e=d.fctOi;if(!e){e=M.getRootFunction(d.oi);}return e;}});}());(function(){mstrmojo.requiresCls("mstrmojo.DocBuilder","mstrmojo.rw._IsReportServicesDocBuilder","mstrmojo.DocLayoutViewer","mstrmojo.maps.MapInfoWindowLayoutViewer","mstrmojo.DocGroupBy","mstrmojo.DocTextfield","mstrmojo.DocHTMLContainer","mstrmojo.Xtab","mstrmojo._Formattable","mstrmojo._IsDocXtab","mstrmojo.IncFetch","mstrmojo.express.ui.DocButton","mstrmojo.ExpressDocPanel","mstrmojo._IsEditableXtab","mstrmojo._CanSupportTransaction","mstrmojo.ExpressVisList","mstrmojo.OIVMDICConfig","mstrmojo.OIVMDocSelectorViewFactory","mstrmojo.OIVMDocXtabGraph","mstrmojo.vi.models.DocVisModel","mstrmojo.vi.models.DocXtabModel","mstrmojo.MenuButton","mstrmojo._HasHoverButton","mstrmojo.ToolBar","mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl","mstrmojo.vi.ui.rw._IsMultiselectXtab","mstrmojo.vi.ui.rw._HasVisSelections","mstrmojo.vi.ui.rw._XtabHighlights","mstrmojo.rw.xtab._XtabColResize");var B=mstrmojo.EnumRWUnitType,O=mstrmojo.DynamicClassFactory.newComponent;mstrmojo.DocXtab=O(mstrmojo.Xtab,[mstrmojo._Formattable,mstrmojo._IsDocXtab,mstrmojo._HasOwnAvatar,mstrmojo.rw.xtab._XtabColResize,mstrmojo.vi.ui.rw._IsMultiselectXtab,mstrmojo.vi.ui.rw._HasVisSelections,mstrmojo.vi.ui.rw.selectors._IsMultiUnitControl,mstrmojo.vi.ui.rw._XtabHighlights],{scriptClass:"mstrmojo.DocXtab"});var D=3,M=4;var A=function(R,Q){var P=R;while(P){if(P.controller&&P.controller[Q]){return P.controller;}P=P.parent;}return null;};mstrmojo.ExpressDocBuilder=mstrmojo.declare(mstrmojo.DocBuilder,[mstrmojo.rw._IsReportServicesDocBuilder],{scriptClass:"mstrmojo.ExpressDocBuilder",visList:mstrmojo.ExpressVisList,createSelectorFactory:function K(){return new mstrmojo.OIVMDocSelectorViewFactory();},createClassMap:function H(){var P=this._super();P[B.PANEL]={n:"Panel",scriptClass:"mstrmojo.ExpressDocPanel"};P[B.HTMLCONTAINER]={n:"HTMLContainer"};P[B.GRAPH]={n:"OIVMDocXtabGraph",scriptClass:"mstrmojo.OIVMDocXtabGraph"};P[B.TEXTFIELD+"B"]={n:"Button",scriptClass:"mstrmojo.express.ui.DocButton"};return P;},getDefaultMojoVisModel:function F(){return mstrmojo.vi.models.DocVisModel;},getLayoutViewerClass:function J(P){return mstrmojo.DocLayoutViewer;},newLayout:function I(P,R){var Q=this._super(P,R);var S=R.data.gbys;if(S&&S.showGroupby){Q.addChildren(new mstrmojo.DocGroupBy({id:S.k,slot:"groupBy",title:S.title,model:P,node:R,data:S.groupbys,controller:this.parent.controller}));}if(R.data.ifs){var T=new mstrmojo.IncFetch(mstrmojo.hash.copy(R.data.ifs,{slot:"incFetchNode",model:P}));T.attachEventListener("fetch",Q.id,function(U){P.getDataService().fetchDocPage((U.v-1)*T.ps+1,{success:function(V){P.loadLayout(V);}});});Q.addChildren(T);}return Q;},newOIVMDocXtabGraph:function(P,Q){var R=new mstrmojo.OIVMDocXtabGraph({id:Q.id,node:Q,controller:this.parent.controller,model:P,gridInfo:Q.data.gsi});R.model=new mstrmojo.vi.models.DocXtabModel({xtab:R,docModel:P});return R;},getEditableXtab:function G(){if(!mstrmojo.EditableXtab){mstrmojo.EditableXtab=O(mstrmojo.Xtab,[mstrmojo._CanSupportTransaction,mstrmojo._IsEditableXtab],{scriptClass:"mstrmojo.EditableXtab"});}return mstrmojo.EditableXtab;},getDefaultXtab:function N(){return mstrmojo.DocXtab;},getPortletExportGridToolbar:function C(T){var Q=T.k,S=T.node.data,R=S.wid,P=[];if(!S.disablePDF){P.push({n:mstrmojo.desc(5212,"Export to PDF"),did:D});}if(!S.disableEXCEL){P.push({n:mstrmojo.desc(5213,"Export to Excel"),did:M});}return{css:"grid-menu",node:{scriptClass:"mstrmojo.ToolBar",slot:"toolbarNode",alias:"rightToolbar",children:[{scriptClass:"mstrmojo.MenuButton",iconClass:"mstrmojo-oivmSprite tbDown",itemIdField:"did",itemField:"n",itemChildrenField:"subItms",executeCommand:function(V){var U=A(this,"exportCmd");if(U){U.exportCmd(V.did,Q,R);}},cm:P}]}};},newHTMLContainer:function(P,Q){return this.newRWUnitInstance(P,Q,(Q.defn.ht===0)?mstrmojo.DocHTMLContainer:mstrmojo.DocTextfield);},newInfoWindow:function E(P){return new mstrmojo.DocInfoWindow(P);},getLinkDrillMixins:function L(P){return P?[mstrmojo._HasHoverButton]:[];}});}());(function(){mstrmojo.requiresCls("mstrmojo.form","mstrmojo.hash","mstrmojo.date","mstrmojo.dom","mstrmojo.expr","mstrmojo.NumberFormat","mstrmojo.Button","mstrmojo.CustomGroupEditor","mstrmojo.ME.MetricIDE","mstrmojo.SharingEditor");var N=mstrmojo.dom,J=mstrmojo.expr,F=J.STP,C=256;var E=mstrmojo.mstr.EnumDSSXMLObjectTypes;var G={ExecuteCubeReport:"web-execute-cube-report",CreateAnalysis:"create-analysis"};function L(Q,O,S,P){var R=mstrApp.sessionManager;if(R&&R.sessionTimedout){R.openLoginEditor({success:function(){if(P!=="_blank"){mstrApp.showWait();}mstrmojo.form.send(Q,O,S,P);}});}else{if(P!=="_blank"){mstrmojo._IsWebApp.showWait({message:mstrmojo.desc(97,"Executing...")});}mstrmojo.form.send(Q,O,S,P);}}function M(O){L(O,null,"post");}mstrmojo.mstr._ObjectActions=mstrmojo.provide("mstrmojo.mstr._ObjectActions",{_mixinName:"mstrmojo.mstr._ObjectActions",execute:function I(c,P){mstrmojo.hash.copy(mstrApp.searchAppFeatures,mstrApp.features);var R=mstrApp.features;var a=mstrApp.name;var U=parseInt(c.tp||c.t,10),Z=parseInt(c.stp||c.st,10),f=c.et&&parseInt(c.et,10),g=c.dssid||c.did,b=c.viewMedia||c.dvm,X=c.visMode||0,d={};switch(U){case E.Filter:switch(Z){case 256:d={evt:3113,filterID:g,src:a+".3113"};break;case 257:this.openCustomGroupEditor(c,P);return ;}break;case E.Metric:this.openMetricEditor(c,P);return ;case E.Folder:d={evt:2001,folderID:g,src:a+".2001"};break;case E.ReportDefinition:if(this.designMode){d={evt:3005,src:a+".3005",reportID:g,reportDesignMode:this.designMode};break;}var e=1;switch(Z){case F.REPORT_CUBE:case F.REPORT_EMMACUBE:if(!mstrApp.features[G.CreateAnalysis]){return ;}var T=!R.IE9Pre||R.IE9Pre&&(R["run-vi-flash"]||R["run-vi-smart"]);if(T){var Q=R.flashvi?"analysis":"HTML5VI";B.convertFromCube({st:Z,type:Q,did:g,folderId:H(c),et:f});}else{mstrmojo.alert(mstrmojo.desc(12187,"Please upgrade your browser or turn off Internet Explorer Compatibility View to work with HTML5 dashboards."));}return ;case F.REPORT_GRID:e=1;break;case F.REPORT_GRAPH:e=2;break;case F.REPORT_GRIDGRAPH:e=3;break;}d={reportID:g,evt:4001,src:a+".4001",visMode:X,reportViewMode:e};break;case E.DocumentDefinition:var W={Reserved:0,ViewStatic:1,ViewInteractive:2,ViewEditable:4,ViewFlash:8,ExportExcel:16,ExportPDF:32,ExportHTML:64,ExportFlash:128,ExportExcelPlainText:256,ExportCSV:512,ExportPlainText:1024,ViewAnalysis:2048,HTML5Dashboard:8192,All:134217727},O={DATA:1,DESIGN:2,PDF:3,EXCEL:4,SAVE:5,DETAILS:6,FLASH_EXPORT:7,FLASH_VIEW:8,FLASH_BINARY_VIEW:9};var Y={};Y[W.ExportPDF]=O.PDF;Y[W.ExportExcel]=O.EXCEL;Y[W.ExportFlash]=O.FLASH_EXPORT;var S={};S[W.ViewStatic]=2048001;S[W.ViewInteractive]=2048001;S[W.ViewEditable]=2048001;S[W.ExportHTML]=3130;S[W.ExportExcel]=3069;S[W.ExportFlash]=3069;S[W.ExportPDF]=3069;S[W.ViewAnalysis]=2048001;S[W.HTML5Dashboard]=3140;var V=2048001;if(Z===14081){if(this.designMode){V=3104;d={evt:V,objectID:g,src:a+"."+V,rwDesignMode:this.designMode,executionMode:2};}else{if(b>8){V=S[b];d={evt:V,documentID:g,src:a+"."+V};if(b===W.HTML5Dashboard){if(N.ISDXIE&&!N.isIE9){mstrmojo.alert(mstrmojo.desc(12187,"Please upgrade your browser or turn off Internet Explorer Compatibility View to work with HTML5 dashboards"));return false;}}else{d.executionMode=Y[b]||0;}}else{V=2048001;d={evt:V,documentID:g,src:a+"."+V,visMode:X||0,currentViewMedia:b||2};}}}else{if(Z===14080){d={evt:32001,documentID:g,src:a+".32001"};}}break;case E.Prompt:d={evt:3119,objectID:g,promptType:c.pt,src:a+".3119"};break;default:return false;}M(d);},openCustomGroupEditor:function(U,W){var R=U.did;var P="mstrCGE",T=mstrmojo.all[P],V=function(X){if(!T){return ;}X.scriptClass="mstrmojo.Obj";T.set("model",mstrmojo.insert(X));T.open();},Q=function(){var X={success:function(Y){if(!Y){mstrmojo.alert("Error retrieving the Custom Group definition!");return ;}V(Y);},failure:function(Y){mstrmojo.alert(Y.getResponseHeader("X-MSTR-TaskFailureMsg"));}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,X,{taskId:"getCustomGroup",customGroupId:R,styleName:"MojoCustomGroupStyle"});},S=function(){V({cgp:{agg:1,flat:false,pf:true,rfi:-1,ce:true,isp:true}});},O=R?Q:S;if(!T){T=mstrmojo.insert(mstrmojo.CustomGroupEditor);T.set("noRefresh",true);if(W&&W.zIndex){T.set("zIndex",W.zIndex);}}O();},openMetricEditor:function(Q,O){var P=Q.did;var S="mstrMetricIDE",R=mstrmojo.all[S];if(!R){R=mstrmojo.insert({scriptClass:"mstrmojo.ME.MetricIDE",id:S,metricId:P,noRefresh:true});if(O&&O.zIndex){R.zIndex=O.zIndex;}}else{R.set("metricId",P);}R.open(null,{action:{cmd:P?"edit":"add"}});},openDataImport:function(){K({});},createFilter:function(){var O={evt:3113,src:(mstrApp.servletName||mstrApp.name)+".3113",isNew:true};L(O);},createDashboard:function(){var P=!mstrmojo.resolveFeature("flashvi"),O={evt:3187,src:(mstrApp.servletName||mstrApp.name)+".3187"};if(P&&mstrmojo.dom.isIE8){mstrmojo.alert(mstrmojo.desc(12187));return false;}if(P&&mstrApp.currentFolderId){O.parentFolderId=mstrApp.currentFolderId();}L(O);},openSharingEditor:A});var B={isCubeSupportDDA:function(O){return !!(O&&(O.dda===1||O.dda===3));},allowCreateReport:function(O){if(O&&O.ddam===2){mstrmojo.alert(mstrmojo.desc(13384,"The 'Create Report' option is currently not available for Live Connection Datasets."));}return true;},getCubesInfo:function(O,P){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(Q){P(Q);}},{taskId:"getUserDICubeInfo",cubeIds:O.join(",")});},convertFromCube:function(P){var S=this,R=P.type,O=P.did,Q=P.folderId;this.getCubesInfo([O],function(U){var V=U[O],Z=mstrApp.name,Y=(V&&!V.published&&S.isCubeSupportDDA(V)),X=!!Y?128:0,W={};if(V&&V.ddam!==2&&!V.published){mstrmojo.confirm(mstrmojo.desc(14111,"This cube has not been published"),{confirmBtn:{t:mstrmojo.desc(9242,"Republish"),fn:function T(){if(P.st===779&&(P.et&C)>0){K({CubeDesc:"",CubeName:P.executeReport,ReportId:O,folderId:Q,StatusCode:2,isEdit:false,callback:function(){S.convertFromCube(P);}});}else{var a={evt:4001,src:mstrApp.name+".4001",reportID:O,visMode:0,reportViewMode:1};M(a);}}}});return ;}switch(R){case"document":W={evt:"3104",src:Z+".3104",executionMode:"2",rwDesignMode:"1",objectType:"3",objectID:O,rwCreateFlags:0};if(Q){W.saveFolderId=Q;}break;case"analysis":W={evt:"3104",src:Z+".3104",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:O,rwCreateFlags:16,rwViewMode:8192};break;case"HTML5VI":W={evt:"3185",src:Z+".3185",executionMode:"1",rwDesignMode:"0",objectType:"3",objectID:O,rwCreateFlags:32};if(Q){W.saveFolderId=Q;}break;case"report":if(!S.allowCreateReport(V)){return ;}W={evt:"3005",src:Z+".3005",srcID:O,srcType:2,reportDesignMode:1};break;}if(typeof W.rwCreateFlags==="number"){W.rwCreateFlags|=X;}M(W);});}};function H(Q){if(Q.fdid){return Q.fdid;}var O=Q.anc&&Q.anc.items||[],P=O[O.length-1];return P&&P.did;}function D(P){var O=function(){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(Q){if(Q){var S=Q.descriptors.length,R;for(R=0;R<S;R++){var T=Q.descriptors[R];mstrmojo.descriptors[T.key]=T.v;}}if(P.callback){P.callback();}},failure:function(){if(P.callback){P.callback();}}},{taskId:"getBundleDescriptors",bundle:P.bundle});};O();}function K(Q){var R=Q.folderId,S=this;mstrmojo._IsWebApp.showWait();var P=function(){var U;if(S.dataImportId){U=mstrmojo.all[S.dataImportId];}if(!U){O();mstrmojo.requiresBundle("mojo-di.js");U=mstrmojo.insert({scriptClass:"mstrmojo.DI.DIContainer"});U.dataImportCallback=function(V){var W=document.getElementById("formRefresh");if(W&&V&&V.length>0){W.submit();}};S.dataImportId=U.id;}if(Q){mstrmojo.hash.copy(Q,U.dataImportParams);if(Q.callback){U.dataImportCallback=function(V){Q.callback(V);};}else{if(Q.isCalledByFlex){U.dataImportCallback=function(W){if(W&&W.length>0){var V;if(navigator.appName.indexOf("Microsoft")!==-1){V=window.MstrFlashFlashViewer;}else{V=document.MstrFlashFlashViewer;}if(V){V.onCloseDI(W);}}};}}}if(R){mstrmojo.hash.copy({cubeSaveFolderId:R},U.dataImportParams);}U.open();mstrmojo._IsWebApp.hideWait();};var T=function(){var V={success:function(W){if(W){P();}else{if(mstrApp.onSessionExpired){mstrApp.onSessionExpired();}}}},U={taskId:"keepSessionAlive"};mstrmojo.xhr.request("POST",mstrConfig.taskURL,V,U);};var O=function(){var U="data-import.css";if(N.isIE8||N.isIE9){U="data-import-ie.css";}var V=document.createElement("link");V.rel="stylesheet";V.href="../javascript/mojo/css/"+U;V.type="text/css";document.head.appendChild(V);};if(!this.dataImportId){D({bundle:"mojo-di",callback:T});}else{T();}}function A(Q,Y,P,V){var U="sharingEditor",O=mstrApp.oi,T=(Y&&Y.objId)||O.objId,R=(Y&&Y.objType)||O.objType,X=(Y&&Y.mid)||mstrApp.getMsgID&&mstrApp.getMsgID(),W=V&&V.showLinkOnOpen,Z=function(c){var b=mstrmojo.all[U];if(!b){V=V||{};c.acls=V.acls||c.acls;b=mstrmojo.insert(mstrmojo.hash.copy(V,{scriptClass:"mstrmojo.SharingEditor",guestModeEnabled:mstrApp.guestModeEnabled,mid:X,id:U,oi:c,href:Q,isLinkDirty:P,viewMode:Y?Y.viewMode:1,lastState:Y?Y.lastState:0,showWait:function(){mstrApp.showWait();},hideWait:function a(){mstrApp.hideWait();},onClose:function(){this.destroy();}}));}else{b.set("oi",c);b.href=Q;b.mid=X;b.isLinkDirty=P;b.viewMode=Y?Y.viewMode:1;b.lastState=Y?Y.lastState:0;b.showLinkOnOpen=W;}b.open();},S=function(){var a={success:function(b){Z(b.objects[0]);},failure:function(b){mstrmojo.alert(b.getResponseHeader("X-MSTR-TaskFailureMsg"));},complete:function(){mstrApp.hideWait();}};mstrmojo.xhr.request("POST",mstrConfig.taskURL,a,{taskId:"getObjectInfo",objectIDs:T,objectTypes:R,includeACL:mstrmojo.resolveFeature("web-use-sharing-editor"),sessionState:mstrApp.sessionState});};mstrApp.showWait();S();}}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.Container","mstrmojo.Label","mstrmojo.ui.List","mstrmojo.ui._HasListTooltip","mstrmojo.mstr._ObjectActions","mstrmojo.mstr.search._IconCssClassBuilder");mstrmojo.requiresDescs(60,61,945,1050,3364,3366,9202);var D=mstrmojo.css,C=mstrmojo.array;var I,A=function(J){return mstrmojo.all[I].getBuilder(J,this.dataField);};mstrmojo.mstr.search.SearchGridView=mstrmojo.declare(mstrmojo.DataGrid,[mstrmojo.mstr._ObjectActions],{scritpClass:"mstrmojo.mstr.search.SearchGridView",cssClass:"mstrmojo-Search-GridView",makeObservable:true,banding:false,columns:[{headerText:mstrmojo.desc(945,"Name"),dataField:"n",dataWidgetBuilder:A,colCss:"name"},{headerText:mstrmojo.desc(60,"Owner"),dataField:"owner",dataWidgetBuilder:A,colCss:"owner"},{headerText:mstrmojo.desc(61,"Modified"),dataField:"mdt",dataWidgetBuilder:A,colCss:"mdt"},{headerText:mstrmojo.desc(1050,"Location"),dataField:"anc",dataWidgetBuilder:A,colCss:"anc"}],init:function H(J){this._super(J);I=this.id;},getBuilder:function B(K,M){var J=null;switch(M){case"n":J={scriptClass:"mstrmojo.mstr.search.SearchGridViewItem",items:[K]};break;case"anc":var L=K.anc.items.slice(2);J={scriptClass:"mstrmojo.Box",cssClass:"mstrmojo-Search-Ancester",children:[{scriptClass:"mstrmojo.Label",alias:"toggle",cssClass:"toggle",text:" ",fullPath:false,onclick:function(){this.fullPath=!this.fullPath;D.toggleClass(this.parent.domNode,"full",this.fullPath);},onRender:function(){this.set("bindings",{enabled:function(){return this.parent.path.ellipsized;}});}},{scriptClass:"mstrmojo.ui.List",alias:"path",ellipsized:false,items:C.map(L,function(N){if(N.hid){N.n="[...]";}return N;}),postclick:function(){if(!this.selectedItem.hid){this.parent.dataGrid.execute(this.selectedItem);}},onRender:function(){var O=this,N=O.domNode.firstChild;window.setTimeout(function(){O.set("ellipsized",N.clientWidth<N.scrollWidth);},10);}}]};break;default:J={scriptClass:"mstrmojo.Label",cssClass:"mstrmojo-Search-nonbreakable "+M,cssDisplay:"inline-block",text:K[M]};break;}J.alias="itemWidget";return J;}});mstrmojo.mstr.search.SearchGridViewItem=mstrmojo.declare(mstrmojo.ui.List,[mstrmojo.ui._HasListTooltip,mstrmojo.mstr.search._IconCssClassBuilder],{scritpClass:"mstrmojo.mstr.search.SearchGridViewItem",getItemMarkup:function F(K,J){return this._super(K,J).replace("{@en@n}",'<i class="{@icnCls}"></i>{@en@n}');},getItemProps:function E(K,J){var L=this._super(K,J);L.addCls("mstrmojo-Search-GridViewItem");L.icnCls="mstrmojo-ListIcon "+this.getIconCssClass(K);L.txtCls="mstrmojo-Search-nonbreakable name";return L;},onclick:function G(J){this._super(J);this.dataGrid.execute(this.selectedItem,{zIndex:mstrmojo.mstr.search.Search.zIndex+2});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.ui.menus.MenuConfig","mstrmojo.mstr.ui.EnumWebPromptsList","mstrmojo.form","mstrmojo.IVEDatasetPicker","mstrmojo.mstr.MDXCubeBrowser","mstrmojo.NewFolderEditor","mstrmojo.mstr._ObjectActions","mstrmojo.mstr.ui.MstrFileUploadHelper");var D=mstrmojo.tstid;var B={BLANK:"05B202B9999F4C1AB960DA6208CADF3D",XDA:"1ADEAA2C4754E2DE5DFEC08022DAFDC6",ICUBE:"DB8D5B064BBE3C24F541DAA81A507FDC"};function C(N,L,O,M){if(window.iframe){window.iframe.showWaitPage(true);}mstrmojo.form.send(N,L,O,M);}function H(L){if(mstrApp.currentFolderId){L.saveFolderId=mstrApp.currentFolderId();}}function E(N,R){function P(Z){function a(c){if(c){C(c.params,null,"post");}}var X=Z.config;if(Z.config.did===B.ICUBE){var b="mstr-create-objectExpl",Y=mstrmojo.all[b];if(!Y){Y=new mstrmojo.IVEDatasetPicker({id:b,cssClass:"mstr-create-menu-cubePicker",title:mstrmojo.desc(4354,"Select Intelligent Cube"),help:"Select_Intelligent_Cube_dialog_box.htm",onOk:function(){X.params={evt:3005,src:T+".3005",srcType:2,srcID:this.item.did,reportDesignMode:1,name:"editReport"};H(X.params);a(X);},onCancel:function(){Y.close();},onRender:function(){var e=false,d=this;this.btnImport.set("visible",e);this.newLabel.set("visible",e);this.useExistingLabel.set("visible",e);this.ob.set("scrollableIncFetch",false);this.btnHBox.destroyChildren();var c=mstrmojo.Button.newWebButton(mstrmojo.desc(547,"Select"),function(){if(this.enabled){d.onOk();d.onCancel();}},true);c.bindings={enabled:function(){return this.parent.parent.multiSelect?!!this.parent.parent.selectedItems.length:!!this.parent.parent.item;}};this.btnHBox.addChildren([c,mstrmojo.Button.newWebButton(mstrmojo.desc(221,"Cancel"),function(){d.onCancel();},false)]);}});}if(X.title){Y.set("title",X.title);}if(X.cssClass){Y.set("cssClass",X.cssClass);}Y.open();}else{if(Z.config.did===B.XDA){(new mstrmojo.mstr.MDXCubeBrowser({onClose:function(){this.destroy();},onOK:function(c){var d={evt:3005,src:(mstrApp.servletName||mstrApp.name)+".3005",srcType:1,srcID:c.did,reportDesignMode:1};H(d);C(d);}})).open();}else{if(X.did){a(X);}}}if(Z.menuOpener.createMenu&&Z.menuOpener.createMenu.close){Z.menuOpener.createMenu.close();}return true;}function S(a,X){var Z=a.config,Y='<a class="mstrMenuItem subMenuItem '+Z.name+' {@cls} {@newGroup}" idx="{@idx}" value="'+Z.value+'"title="'+Z.desc+'"><span class=""></span><span class="label">{@n}</span></a>';return Y;}var L=this,O=mstrmojo.hash.clone(R||L.createMenuData.rl),T=mstrApp.servletName||mstrApp.name;for(var Q=0;Q<O.length;Q++){if(O[Q].did===B.BLANK){var M=O[Q];O.splice(Q,1);O.splice(0,0,M);continue;}if(O[Q].did===B.XDA||O[Q].did===B.ICUBE){var M=O[Q];O.splice(Q,1);O.splice(1,0,M);continue;}}for(var Q=0;Q<O.length;Q++){var U=false;var V=O[Q].did;if(V===B.ICUBE){if(mstrmojo.resolveFeature("web-define-view-report")){U=true;}}else{U=true;if(!mstrmojo.resolveFeature("template-reports")||(V===B.BLANK&&(!mstrmojo.resolveFeature("design-mode")||!mstrmojo.resolveFeature("modify-report-list")))||(V===B.XDA&&(!mstrmojo.resolveFeature("dhtml")||!mstrmojo.resolveFeature("web-define-view-report")||!mstrmojo.resolveFeature("define-query-report-builder")))){U=false;}}if(!U){continue;}var W;if(O[Q].t===8){W=J(O[Q],L,N,E);}else{W=N.addCustomMenuItem(O[Q].n,"",P,S);O[Q].params={reportID:O[Q].did,blank_reportDesignMode:1,reportDesignMode:4,evt:3005,src:T+".3005",reportViewMode:1,promptStyle:"PromptsTransformCreateReport",promptsExecuteStyle:"PromptsTransformClassicSave",promptsCreateStyle:""};H(O[Q].params);if(O[Q].did===B.BLANK){O[Q].params.reportDesignMode=1;}W.config=O[Q];W.menuOpener=L;}}}function A(O){function T(W){var X={DssXmlViewMediaViewStatic:1,DssXmlViewMediaViewInteractive:2,DssXmlViewMediaViewEditable:4};var V=X.DssXmlViewMediaViewStatic;if(W!==0){if((W&X.DssXmlViewMediaViewEditable)>0){V=X.DssXmlViewMediaViewEditable;}else{if((W&X.DssXmlViewMediaViewInteractive)>0){V=X.DssXmlViewMediaViewInteractive;}else{if((W&X.DssXmlViewMediaViewStatic)>0){V=X.DssXmlViewMediaViewStatic;}}}}return V;}var N=this,Q=N.createMenuData.dl,U=N.createMenuData.docList,R=mstrApp.servletName||mstrApp.name;function P(V){var X="";if(!V){return X;}for(var W=0;W<V.length;W++){X+='<a title="'+V[W].n+" - "+V[W].desc+'" id = vt_'+V[W].did+' class="dashboardStyleTemplate mstrMenuItem subMenuItem" idx="{@idx}" rwviewmode = "'+T(V[W].avm)+'" data-id = "'+V[W].did+'"></a>';}return X;}function M(V){if(!V){return"";}var X="";for(var W=0;W<V.length;W++){X+='<a class="mstrMenuItem subMenuItem {@cls}" title = "'+V[W].desc+'" idx="{@idx}" data-id = '+V[W].did+' rwviewmode = "'+T(V[W].avm)+'" >'+V[W].n+"</a>";}return X;}function L(){var X='<div class = "mstr-dashboard-subMenu dashboardTemplates">'+P(Q)+"</div>";var W='<div class = "mstr-dashboard-subMenu docList" >'+M(U)+"</div>";var V="";if(Q){V+=X;}if(U){V+="<hr>"+W;}return V;}function S(W,V){var X={blank_rwDesignMode:1,rwDesignMode:1,evt:3104,src:R+".3104",createDocument:"*-1.*-1.0.0.0"};X.rwViewMode=V._evtTarget.getAttribute("rwviewmode");X.objectID=V._evtTarget.getAttribute("data-id");H(X);C(X,null,"post");return true;}O.addCustomMenuItem("DashDoc Templates","",S,L);}function G(S){function R(T){C(T.config.params);return true;}function L(V,T){var U=V.config;return"<a "+D(U.name+"Item")+' class="mstrMenuItem subMenuItem '+U.name+' {@cls} {@newGroup}" idx="{@idx}" value="'+U.value+'"><span class=""></span><span class="label">{@n}</span></a>';}var M=mstrmojo.mstr.ui.EnumWebPromptsList.get();for(var N=0;N<M.length;N++){var Q=M[N],P=mstrmojo.desc(Q.descId)||Q.n,O=S.addCustomMenuItem(P,"",R,L);O.config=Q;}}function J(N,Q,L,M){if(!N.items&&!N.loading){N.loading=true;var P=new mstrmojo.SimpleXHR({async:false});P.request("POST",mstrConfig.taskURL,{success:function O(S){var T=S.items||[];if(T.length===0){T.push({n:mstrmojo.desc(3693,"(None)")});}N.items=T;delete N.loading;}},{folderID:N.did,taskId:"folderBrowse",styleName:Q.folderBrowsingStyle,includeObjectDesc:true});}return L.addPopupMenuItem(N.n,"",function R(){var S=new mstrmojo.ui.menus.MenuConfig({menuCssClass:"mstr-create-menu"});M.call(Q,S,N.items);return S;});}function I(M){var N=this,L=M;return function(){var O=mstrmojo.insert({scriptClass:"mstrmojo.ui.menus.MenuConfig",menuCssClass:"mstr-create-menu",hostProxyCssClass:"mstrmojo-create-menu-host",tstid:M+"Sbm"});switch(L){case"template":E.call(N,O);break;case"templateDoc":O.menuCssClass=O.menuCssClass+" mstr-dashboard-subMenu collapse";A.call(N,O);break;case"prompt":G.call(N,O);break;}return O;};}function F(X){var M=this,R=M.createMenuData.sl;var Y=mstrmojo.all["mscld-create-menuList"],T=mstrApp.servletName||mstrApp.name;if(!Y){var U=mstrmojo.insert({scriptClass:"mstrmojo.ui.menus.MenuConfig",menuCssClass:M.cssClassName+" collapse",hostProxyCssClass:M.hostCssClassName,anchorElement:X.domNode,hostId:X.id,isHostedWithin:false,includeScroll:false,tstid:"createMenu"});if(M.alignMenuToRight){U.setAlignment(mstrmojo.ui.PopupConfig.ENUM_CORNERS.BOTTOM_RIGHT,mstrmojo.ui.PopupConfig.ENUM_CORNERS.TOP_RIGHT);}function S(e,b){var d=e.config;var c="<a "+D(d.name+"Item")+' class="mstrMenuItem '+d.name+' {@cls} {@newGroup}" idx="{@idx}" onclick=" mstrmojo.all[\''+M.id+"'].onclick('"+e.name+'\',event)" href="'+d.href+'" useIframe="'+d.iframe+'"';if(d.accept!==undefined){c+=' accept = "'+d.accept+'"';}c+=' name="'+d.name+'"><span class="micn"></span><span>{@n}</span></a>';return c;}function W(e,b){var d=e.config;var c="<label "+D(d.name+"Item")+' for ="myFile" class="mstrMenuItem '+d.name+' {@cls} {@newGroup}" idx="{@idx}" onclick=" mstrmojo.all[\''+M.id+"'].onclick('"+e.name+'\',event)" href="'+d.href+'" target="'+d.target+'" useIframe='+d.iframe+'"';if(d.accept!==undefined){c+=' accept = "'+d.accept+'"';}c+='name="'+d.name+'"><span class="micn"></span><span>{@n}</span></label>';return c;}function P(c){if(c.config.name==="folder"){var b=mstrmojo.insert({scriptClass:"mstrmojo.NewFolderEditor",fId:mstrApp.currentFolderId?mstrApp.currentFolderId():"",Index:Y.domNode.style.zIndex+10,navigateAfter:true,okFn:function(){var d=this,e={evt:2001,src:T+"."+mstrApp.pageName+".fbb.fb.2001",folderID:d.fId};C(e,mstrApp.name,"POST");},onClose:function(){this.destroy();}});b.open();}if(Y&&Y.close){window.setTimeout(function(){Y.close();},10);}return true;}var L=false;for(var Q=0;Q<R.sl.length;Q++){var O=R.sl[Q];if(O.grp){U.addSeparator();}var a={},N=L===false?"":"collapsable ";if(O.name==="prompt"||O.name==="template"||O.name==="templateDoc"){a=U.addPopupMenuItem(O.n,U.id,I.call(M,O.name));a.cls=a.cls+N+O.name;a.tstid=O.name+"Item";}else{if(O.name==="myFile"){a=U.addCustomMenuItem(O.n,N,P,W);var Z='<form id="import_form" class="mstrmojo-FileUploadBox" target="hidden_import_iframe" enctype="multipart/form-data" method="post" action="'+mstrConfig.taskURL+'"><input id="myFile" name="myFile" type="file" class="mstrmojo-FileUploadBox-file mstr-create-menu-fileUpload" size="30" onchange="mstrApp.uploadMstrFileFn.upload(\'import_form\');" accept=".mstr" title=""><input type="hidden" name="fileFieldName" value="myFile"><input type="hidden" name="taskId" value="importAsyncSaveRWD"><input type="hidden" name="taskEnv" value="jsonp2"><input type="hidden" name="jsonp" value="parent.mstrApp.uploadMstrFileFn.callback(@R@)"><input type="hidden" name="myfile" value=""><input type="hidden" name="folderID" value="" id="import_folderID"></form>';Z+='<iframe name="hidden_import_iframe" style="display:none;" src="about:blank"></iframe>';if(!document.getElementById("import_form")){var V=document.createElement("SPAN");V.innerHTML=Z;document.body.appendChild(V);}}else{a=U.addCustomMenuItem(O.n,N,P,S);a.tstid=O.name;}a.config=O;if(O.name==="folder"){a.config.params={evt:17001,src:T+"."+mstrApp.pageName+".OMDCreateFolder.17001",targetName:"fb",iframe:true,target:"frameManager"};}}a.name=O.name;}Y=U.newInstance({id:"mscld-create-menuList"});}Y.set("includeScroll",false);Y.open(X);M.createMenu=Y;Y.onClose=function(){X.toggleButtonClass(false);};}function K(N){var R=this,P=R.createMenuData;function L(T){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function S(U){T.createMenuData.dl=U.items;T.createMenuData.loadData.dlLoaded=true;O();}},{folderID:"FCA4BAFE4AF0D00088028989D7497A4F",taskId:"folderBrowse",styleName:T.folderBrowsingStyle,includeObjectDesc:true,objectType:"55"});mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function S(U){T.createMenuData.docList=U.items;T.createMenuData.loadData.dlLoaded=true;O();}},{folderID:"6C87013036D94E65B9FD227CF919327E",taskId:"searchMetadata",styleName:T.folderBrowsingStyle,recursive:1,includeAncestorInfo:false,includeObjectDesc:true,objectType:"14081"});}function Q(T){mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function S(U){T.createMenuData.rl=U.items;T.createMenuData.loadData.rlLoaded=true;O();}},{taskId:"folderBrowse",systemFolder:"16",styleName:T.folderBrowsingStyle,includeObjectDesc:true,objectType:"55"});}function O(){if(R.createMenuData.sl&&M(R.createMenuData.loadData)){F.call(R,N);}}if(!P){R.createMenuData={};mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(U){var T;R.createMenuData.sl=U;R.createMenuData.loadData={};for(T=0;T<U.sl.length;T++){var S=U.sl[T]["feature-id"];switch(S){case"create-view-reports":R.createMenuData.loadData.rlLoaded=false;Q(R);break;case"template-documents;dhtml;documents-design-mode":R.createMenuData.loadData.dlLoaded=false;L(R);break;}}O();}},{taskId:"getShortcutsList",pageName:"createOptions"});}else{O();}function M(U){if(!U){return true;}var T=true;for(var S in U){T=T&&U[S];}return T;}}mstrmojo.mstr.ui.CreateMenu=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.mstr._ObjectActions],{scriptClass:"mstrmojo.mstr.ui.CreateMenu",hostCssClassName:"mstrmojo-create-menu-host",cssClassName:"mstr-create-menu",opener:null,folderBrowsingStyle:"MobileFolderStyle",onclick:function(L,M){if(L!=="myFile"){mstrmojo.dom.preventDefault(window,M);}switch(L){case"customGroup":this.openCustomGroupEditor({});break;case"metric":this.openMetricEditor({});break;case"queryBuilder":this.openDataImport({});break;case"filter":this.createFilter();break;case"scNewIVE":this.createDashboard();break;}},loadCreateMenu:function(){if(!this.opener){return ;}K.call(this,this.opener);}});}());(function(){mstrmojo.requiresCls("mstrmojo.css","mstrmojo.array","mstrmojo.string","mstrmojo.Container","mstrmojo.WidgetList","mstrmojo.mstr._ObjectActions");mstrmojo.requiresDescs(3364,3366,9202);var H=mstrmojo.desc,C=mstrmojo.css,D=mstrmojo.string.escape4HTMLText;mstrmojo.mstr.search.SearchIconView=mstrmojo.declare(mstrmojo.WidgetList,[mstrmojo.mstr._ObjectActions],{scriptClass:"mstrmojo.mstr.search.SearchIconView",init:function G(I){this._super(I);C.addWidgetCssClass(this,"mstrmojo-SearchIconView");},itemFunction:function A(L,I,J){var K=new mstrmojo.mstr.search.SearchIconItem({parent:J,idx:I,data:L});J.attachListener4ItemWidget(K,J);return K;},attachListener4ItemWidget:function F(L,M){var J=["ItemExecute"],I=J.length,K;for(K=0;K<I;K++){L.attachEventListener(J[K],M.id,"itemEventHandler");}return L;},itemEventHandler:function(I){var K=I.name,J=I.data;switch(K){case"ItemExecute":this.execute(J,{zIndex:mstrmojo.mstr.search.Search.zIndex+2});break;}}});mstrmojo.mstr.search.SearchIconItem=mstrmojo.declare(mstrmojo.Container,[],{scritpClass:"mstrmojo.mstr.search.SearchIconItem",markupString:'<div class="mstrmojo-SearchIconItem" mstrAttach:click ><i class="mstrIcon-lg" data-role="icn"></i><div class="ttl" data-role="ttl"></div><div class="owner" data-role="owner"><label>'+H(3364,"Owner:")+'</label><span></span></div><div class="modified" data-role="mdt"><label>'+H(3366,"Modified:")+'</label><span></span></div><div class="desc" data-role="desc"></div></div>',markupSlots:{iconNode:function(){return this.domNode.firstChild;},titleNode:function(){return this.domNode.childNodes[1];},ownerNode:function(){return this.domNode.childNodes[2].lastChild;},modifiedNode:function(){return this.domNode.childNodes[3].lastChild;},descNode:function(){return this.domNode.lastChild;}},markupMethods:{ondataChange:function(){var I=this.data||{},J=I.desc||"";C.addClass(this.iconNode,this.getIconCls(I));this.titleNode.innerHTML=D(I.n);this.ownerNode.innerHTML=D(I.owner);this.modifiedNode.innerHTML=D(I.mdt);this.descNode.innerHTML=this.allowHTMLOnObjectDesc?J:D(J);}},data:{},getIconCls:function E(I){I=I||this.data;return"t"+I.t+(I.st?" st"+I.st:"")+(I.isc?" isc":"")+(I.dvm?" dvm"+I.dvm:"");},onclick:function B(I){var K=I.getTarget(),J=(K.dataset&&K.dataset.role)||K.getAttribute("data-role");if(J==="icn"||J==="ttl"){this.raiseEvent({name:"ItemExecute",data:this.data});}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo.css","mstrmojo.array","mstrmojo.Model","mstrmojo.IncFetch","mstrmojo.Label","mstrmojo.ui.ButtonBar","mstrmojo.ui.List","mstrmojo.mstr.search.SearchIconView","mstrmojo.mstr.search.SearchGridView","mstrmojo.mstr._ObjectActions");mstrmojo.requiresDescs(3364,3366,9202,14557);var D=mstrmojo.desc,H=mstrmojo.css,C=mstrmojo.hash;mstrmojo.mstr.search.SearchResults=mstrmojo.declare(mstrmojo.Container,[],{scriptClass:"mstrmojo.mstr.search.SearchResults",markupString:'<div id="{@id}" class="mstrmojo-SearchResults {@cssClass}"><div class="mstrmojo-SearchResults-list"></div><div class="mstrmojo-SearchResults-toolbar"></div><div class="mstrmojo-SearchResults-if"></idv></div>',markupSlots:{listNode:function(){return this.domNode.firstChild;},toolbarNode:function(){return this.domNode.childNodes[1];},incFetchNode:function(){return this.domNode.lastChild;}},markupMethods:{onresultsChange:function(){if(this.hasRendered){this.listNode.style.height=this.results&&this.results.items&&this.results.items.length>0?"":0;}}},height:"430px",supportIncFetch:true,results:{},iconView:false,init:function I(L){if(this._super){this._super(L);}this.addChildren([this.getViewRef(),{scriptClass:"mstrmojo.Label",alias:"notFoundMsg",cssText:"text-align: center",allowHTML:true,visible:false,ontextChange:function(){this.set("visible",!mstrmojo.string.isEmpty(this.text));},slot:"listNode"},{scriptClass:"mstrmojo.ui.ButtonBar",items:[{n:"Icon View",v:1,css:"iconView"},{n:"Grid View",v:2,css:"gridView"}],showIcon:true,cssClass:"viewModesButtonBar",selectedIndex:1,postselectionChange:function(O){var P=this.items,Q=P[O.added[0]],R=P[O.removed&&O.removed[0]];if(Q.v!==R.v){this.parent.set("iconView",Q.v===1);}},bindings:{visible:function(){return !this.parent.notFoundMsg.visible&&this.parent.list.visible;}},slot:"toolbarNode"}]);if(this.supportIncFetch){var M=this;this.addChildren([{scriptClass:"mstrmojo.IncFetch",alias:"incFetch",slot:"incFetchNode",np:0,cp:0,ds:{f:mstrmojo.desc(4046,"First"),p:mstrmojo.desc(1058,"Previous"),n:mstrmojo.desc(1059,"Next"),l:mstrmojo.desc(4049,"Last"),pgs:mstrmojo.desc(5972,"## of ### pages"),gt:mstrmojo.desc(5878,"Go to:"),v:mstrmojo.desc(6079,"This field should be # between ## and ###.")},onifsChange:function N(O){mstrmojo.hash.copy(O.value,this);if(this.np>1){this.children=null;this.refresh();}H.toggleClass(this.domNode,"show",this.np>1);},onfetch:function K(O){M.onfetch(O);}}]);}},getViewRef:function F(){var K=this.iconView?"mstrmojo.mstr.search.SearchIconView":"mstrmojo.mstr.search.SearchGridView";return{scriptClass:K,alias:"list",slot:"listNode",bindings:{visible:function(){return this.items&&this.items.length>0;}}};},oniconViewChange:function A(){this.removeChildren(this.list);this.addChildren([this.getViewRef()]);this.renderChildren();this.onresultsChange();},onresultsChange:function J(){this.list.set("items",this.results&&this.results.items);this.updateNotFoundMsg();this.updateIncFetch();},updateNotFoundMsg:function G(){var K=this.parent,L=K?K.getNotFoundMsg():"";this.notFoundMsg.set("text",K.hasUserInput()&&C.isEmpty(this.results&&this.results.items)?L:"");},updateIncFetch:function B(){var K=this.results;if(this.supportIncFetch){var L=this.getTotalSize(),N=K.bb,M=K.bc;this.incFetch.set("ifs",{np:Math.floor(L/M)+((L%M>0)?1:0),cp:Math.floor(N/M)+((N%M>0)?1:0)});}},getTotalSize:function E(){return Math.min(this.maxSearchResults,this.results.sz);}});}());(function(){mstrmojo.requiresCls("mstrmojo.Widget","mstrmojo.mstr.ui.CreateMenu","mstrmojo.ui.menus._HasMenuPopup");var B=mstrmojo.dom;var C="mscld-create-menu";mstrmojo.mstr.ui.CreateButton=mstrmojo.declare(mstrmojo.Widget,[mstrmojo.ui.menus._HasMenuPopup],{scriptClass:"mstrmojo.mstr.ui.CreateButton",markupString:'<div id="mscld-create" class="mstrmojo-CreateButton mscld-create analysis" title="'+mstrmojo.desc(3291,"Create")+'" mstrAttach:click><span class="mstrMenuItemcreate"><span id="mscld-create-menu" class="mscld-create-menu">'+mstrmojo.desc(3291,"Create")+"</span></span></div>",markupSlots:{menuButtonNode:function(){return this.domNode;}},onclick:function(){var D=mstrmojo.all[C];if(!D){D=mstrmojo.insert({scriptClass:"mstrmojo.mstr.ui.CreateMenu",id:"mscld-create-menu",opener:this,alignMenuToRight:this.alignMenuToRight});}this.toggleButtonClass(true);D.loadCreateMenu();},toggleButtonClass:function(D){if(this.domNode.className.indexOf("open")>0){mstrmojo.css.toggleClass(this.domNode,"open",D);}else{mstrmojo.css.toggleClass(this.domNode,"open",D);}},init:function(E){this._super(E);if(!this._listenerProc){var F=this;var D=this._listenerProc=function(){F.browserResized();};B.attachEvent(window,"resize",D);}},browserResized:function(){if(this.timer){clearTimeout(this.timer);}var D=mstrmojo.all[C];if(D){this.timer=setTimeout(function(){D.createMenu.adjustCornersForPopupOverflow();},100);}},destroy:function A(D){if(this._listenerProc){B.detachEvent(window,"resize",this._listenerProc);}this._super(D);},onButtonClick:mstrmojo.emptyFn,onStatusClick:mstrmojo.emptyFn});}());(function(){mstrmojo.requiresCls("mstrmojo.array","mstrmojo.css","mstrmojo.Model","mstrmojo.Container","mstrmojo._HasSuggestion","mstrmojo._IsWebApp","mstrmojo.mstr.search.SearchSettings","mstrmojo.mstr.search.SearchResults");var J=mstrmojo.desc,C=mstrmojo.css,f=mstrmojo.array,p=mstrmojo.string;var e=[16,1,2,4,8],a=e,G=[1,2,4,8],d=[3,8,14081],V=-1;var I={suggest:function(v){return{success:function(z){if(!mstrmojo.all.search){return ;}if(!v.hasSearchPattern){v.clear();v.hideSuggestion();return ;}v.sItems=z.items||[];var x,w=v.sItems.length;for(x=0;x<w;x++){v.sItems[x].t=V;}if(w){v.selectedSuggestionIndex=null;}else{v.hideSuggestion();}var AA=z.items&&z.items[0]&&z.items[0].n.toLowerCase();if(AA){v.suggestInputNode.value=AA.replace(new RegExp("^"+v.searchPattern,"i"),v.inputNode.value);v.syncInputWithSuggest();}else{AA=v.searchPattern;}v.suggest=AA;if(v.last_searchPattern!==AA){v.last_searchPattern=AA;window.setTimeout(function(){v.requestResults();},0);}},failure:function(w){mstrmojo.alert(w.status+" : "+w.statusText);},complete:function(w){v.showSpinnerIcon(false);v.handleSearchErrorAndModeSwitching(w);}};},search:function(v){return{success:function(x){if(!mstrmojo.all.search){return ;}var w;for(w in v){this[w]=v[w];}if(!v.hasSearchPattern&&!v.allowEmptyInput){v.clear();v.hideSuggestion();return ;}if(!x){mstrmojo.xhr.abort();v.requestResults();return ;}v.rItems=x.items||[{t:0,dssid:"",n:mstrmojo.desc(9135,"No match found")}];if(v.showAsPopup){v.renderResultsPopup(v.rItems);}else{v.renderResults(x||{});}},failure:function(w){mstrmojo.alert(w.status+" : "+w.statusText);},complete:function(w){v.showSpinnerIcon(false);v.handleSearchErrorAndModeSwitching(w);}};}};var N=function(w){var v=mstrApp.adminInfo;return w.replace("#",(v&&v.length>0?" ("+v+")":""));};var u=function(){if(mstrmojo.dom.isDXIE||mstrmojo.dom.isSafari){var v=this.inputNode;window.setTimeout(function(){v.focus();},10);}};mstrmojo.mstr.search.Search=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasSuggestion,mstrmojo._IsWebApp],{scriptClass:"mstrmojo.mstr.search.Search",noCache:true,suggestionPopupCssClss:"mstrmojo-Search-suggestion",resultsOnly:false,allowEmptyInput:false,showAsPopup:true,allowHTMLOnObjectDesc:false,searchDelay:200,doAutoComplete:true,minSearchLength:1,supportIncFetch:true,searchTootipText:mstrmojo.desc(9168,"Type to search"),enableSuggestion:true,hasSearchPattern:false,searchProps:null,quickSearch:false,includeObjectDesc:true,blockBegin:1,blockCount:10,rootFolderType:39,rootFolderID:null,nameWildcards:16,recursive:1,objectType:[3,8,14081],fields:"name",dereferenceshortcut:"1",dateType:1,created:0,dateSubType:1,intervalUnit:1,intervalValue:1,startDate:"",endDate:"",ownerType:1,description:"",maxObjects:100,searchDomain:2,styleName:"MojoFolderStyle",clearVisible:false,spinnerVisible:false,markupString:'<div class="mstrmojo-Search {@cssClass}" style="{@cssText}"><div class="mstrmojo-Search-settings1"></div><div class="mstrmojo-Search-container"><div class="mstrmojo-Search-input" style="position: relative"  mstrAttach:mousedown><div class="mstrmojo-Search-search" style="position: relative"><input class="searchPattern" maxlength="100" autocomplete="off" {@autofocus}                                   placeholder="{@searchTootipText}"mstrAttach:mousedown,keyup,keydown,blur,paste,cut,input /><div class="SearchBox-tip" n="searchTip"></div></div><div class="mstrmojo-Search-suggest" style="background: none transparent;"><input class="suggestPattern" maxlength="100" autocomplete="off" disabled="disabled" data-act="suggest"/></div></div><div class="mstrmojo-Search-btns" mstrAttach:click><div class="mstrmojo-Search-btnClear" data-act="clear"></div><div class="mstrmojo-Search-btnSpinner" data-act="spinner"></div><div class="mstrmojo-Search-btnSearch" data-act="search"></div></div></div><div class="mstrmojo-Search-btnSettings" data-act="settings" mstrAttach:click>'+mstrmojo.desc(14521,"Refineseaaa")+'</div><div class="mstrmojo-Search-infoIcon" data-act="info"></div><div class="mstrmojo-Search-settings"></div><div class="mstrmojo-Search-result"></div></div>',markupSlots:{settings1ContainerNode:function(){return this.domNode.firstChild;},suggestInputNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1].firstChild;},inputNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[0].firstChild;},searchTipNode:function(){return this.domNode.childNodes[1].firstChild.childNodes[1].childNodes[1];},btnsNode:function(){return this.domNode.childNodes[1].childNodes[1];},clearNode:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[0];},spinnerNode:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[1];},searchNode:function(){return this.domNode.childNodes[1].childNodes[1].childNodes[2];},settingsBtnNode:function(){return this.domNode.childNodes[2].childNodes[2];},infoIconNode:function(){return this.domNode.childNodes[3];},settingsContainerNode:function(){return this.domNode.childNodes[4];},resultsContainerNode:function(){return this.domNode.childNodes[5];}},markupMethods:{onclearVisibleChange:function(){C.toggleClass(this.btnsNode,"clear",this.clearVisible);},onspinnerVisibleChange:function(){C.toggleClass(this.btnsNode,"spinner",this.spinnerVisible);C.toggleClass(this.domNode,"searching",this.spinnerVisible);}},init:function o(w){var x=this;this.autofocus=mstrmojo.dom.isSafari?"":"autofocus";if(this._super){this._super(w);}if(this.resultsOnly){C.addWidgetCssClass(this,"resultsOnly");}this.updateQuickSearchEnabled();mstrmojo.hash.copy(w.searchProps,this);this.objectType=f.filter(this.objectType,function(z){return f.find(x.allowedObjectTypesData,"t",parseInt(z,10))>-1;});this.maxObjects=parseInt(this.maxSearchResults||this.blockCount,10);var v=new Date();this.endDate=mstrmojo.date.formatDateInfo({day:v.getDate(),month:parseInt(v.getMonth(),10)+1,year:v.getFullYear()},mstrmojo.locales.datetime.DATEOUTPUTFORMAT);this.nameWildcards=(this.pqse?16:1);if(this.rootFolderID){this.rootFolderType=0;}else{this.rootFolderType=(parseInt(this.rootFolderType,10)>=0?this.rootFolderType:39);}this.updateQuickSearchEnabled();},preBuildRendering:function A(){var v=this;this.addChildren([mstrmojo.mstr.search.SearchSettings.getLocationPulldown({rootFolderName:this.rootFolderName,rootFolderType:this.rootFolderType,slot:"settings1ContainerNode"}),mstrmojo.mstr.search.SearchSettings.getSearchTypePulldown({className:"searchType",qse:this.qse,slot:"settings1ContainerNode"}),{scriptClass:"mstrmojo.mstr.search.SearchSettings",alias:"settingsWidget",allowedObjectTypesData:this.allowedObjectTypesData,model:new mstrmojo.Model({settings:{rootFolderType:this.rootFolderType,rootFolderID:this.rootFolderID,nameWildcards:this.nameWildcards,objectType:this.objectType,dereferenceshortcut:this.dereferenceshortcut,dateType:this.dateType,created:this.created,dateSubType:this.dateSubType,intervalUnit:this.intervalUnit,intervalValue:this.intervalValue,startDate:this.startDate,endDate:this.endDate,ownerType:this.ownerType,description:this.description}}),onmodelChange:function(){mstrmojo.hash.copy(this.model.settings,v);v.blockBegin=1;v.delayedRequestResults();},slot:"settingsContainerNode"}]);if(this._super){this._super();}},postBuildRendering:function T(){if(this._super){this._super();}this.showSearchInfoIcon();if(this.showInfoIcon){this.addChildren([{scriptClass:"mstrmojo.Label",cssDisplay:"inline-block",bindings:{visible:function(){return this.showInfoIcon||true;}},useRichTooltip:true,richTooltip:{posType:mstrmojo.tooltip.POS_BOTTOMLEFT,cssClass:"vi-regular vi-tooltip-V",contentNodeCssClass:"mstrmojo-Search-infoIcon-tip",keepArrowXPos:true,refNode:this.infoIconNode,content:N(mstrmojo.desc(9264))},slot:"infoIconNode"}]);this.renderChildren();}u.call(this);if(this.searchPattern){this.inputNode.value=this.searchPattern;}},getSearchPattern:function O(){if(this.inputNode){this.searchPattern=mstrmojo.string.trim(this.inputNode.value);}else{this.searchPattern=null;}return this.searchPattern;},getRootFolderName:function q(){var v={0:this.rootFolderName,7:J(2,"Shared Reports"),20:J(3,"My Reports"),39:mstrConfig.projectName};return v[this.rootFolderType||39];},getNotFoundMsg:function Z(){var v=function(x){return"<b>"+mstrmojo.string.escape4HTMLText(x)+"</b>";};var w=J(9202,"Your search for ## in ### returned no results").replace("###",v(this.getRootFolderName())).replace("##",v(this.getSearchPattern()));return w;},onmousedown:function g(){u.call(this);},onkeyup:function n(x){var AB=this;var AC=x.e;this.value=x.getTarget().value;var z=this.value;var AA=AC.keyCode;if(AA==32&&/^\s/.test(z)){this.value=z.replace(/^\s+/,"");x.cancel();return false;}AB.hasSearchPattern=this.value&&(this.value.length>0);if(!AB.doAutoComplete){if(AB.hasSearchPattern){AB.showClearIcon();}AB.searchPattern=this.value;if(AC.keyCode!==13){return ;}}var w=function(AE,AF){if(AF.indexOf("?")>-1||AF.indexOf("*")>-1){return false;}var AD=false;try{if(typeof AE==="string"){AD=(new RegExp("^"+AF,"")).test(AE);}else{var AG;for(AG in AE){AD=(new RegExp("^"+AF,"i")).test(AE[AG].n);if(!AD){break;}}}}catch(AH){}return AD;};if(AA&&f.indexOf([8,13,27,37,38,39,40],AA)===-1&&w(AB.suggestInputNode.value,this.value)&&w(AB.sItems,this.value)){return ;}AB.processInput(x);AB.syncInputWithSuggest();this.set("clearVisible",this.getSearchPattern().length>0);},onkeydown:function Q(v){if(mstrmojo.dom.isIE){var w=v.e;if(w.keyCode===27){w.cancelBubble=true;return false;}}},onpaste:function t(v){var w=this;window.setTimeout(function(){w.onkeyup(v);},0);},onclick:function k(x){var v=x.hWin,z=x.e||v.event,AA=z.target||z.srcElement,w=AA&&((AA.dataset&&AA.dataset.act)||AA.getAttribute("data-act"));switch(w){case"search":this.forceSearch();break;case"clear":this.clear();break;case"settings":this.settingsWidget.set("visible",!this.settingsWidget.visible);break;}},processInput:function h(v){var z=v.e,x=z.keyCode,w=this.inputNode.value;this.searchPattern=w;this.blockBegin=1;if(!this.doAutoComplete&&x!==13){return ;}if(x===13||w.length<this.minKeyLength){if(!this.hasSearchPattern){this.clear();}this.hideSuggestion();this.forceSearch();return ;}else{switch(x){case 38:case 40:if(this.updateSelectedIndex(x)){this.delayedRequestResults();}else{if(this.tmrRR){window.clearTimeout(this.tmrRR);}}break;case 13:case 27:this.hideSuggestion();this.cancel();break;case 37:break;case 39:if(this.suggestInputNode.value&&this.inputNode.value!==this.suggestInputNode.value){this.inputNode.value=this.suggestInputNode.value;this.suggestInputNode.value="";}break;default:if(!this.enableSuggestion){return ;}this.showSpinnerIcon(true);this.suggestInputNode.value="";this.delayedRequestSuggestion(w);}}},cancel:function E(){mstrmojo.xhr.cancel();},requestSuggestion:function r(){return this.showSuggestion(this.getSearchPattern());},delayedRequestSuggestion:function r(v){if(this.tmrRS){window.clearTimeout(this.tmrRS);}if(this.tmrRR){window.clearTimeout(this.tmrRR);}var w=this;this.tmrRS=window.setTimeout(function(){w.requestSuggestion(v);},this.searchDelay);},requestResults:function K(){if(!this.hasUserInput()){return ;}if(!this.searchPattern){this.searchPattern="";}var w=this;var x=function(AC){if(!w.isMiniSearchBox){return AC.toString();}var AD=[],AA=d,AB;for(AB in AA){if(f.find(AC,AA[AB])>-1){AD.push(AA[AB]);}}return AD.toString();};var v=function(){var AB="";if(w.isMiniSearchBox||w.dereferenceshortcut=="1"){return AB;}if(w.objectType.length===0||f.indexOf(w.objectType,18)===-1){return AB;}var AC=[],AA;for(AA=0;AA<w.allowedObjectTypesData.length;AA++){AC.push(w.allowedObjectTypesData[AA].t);}return AC.toString();};var z={taskId:"searchMetadata",searchId:this.blockBegin>this.blockCount?this.searchId||"":"",quickSearch:this.qse,fields:this.fields,styleName:this.styleName,searchPattern:this.last_searchPattern||this.searchPattern,objectType:x(this.objectType),targetObjectType:v(),rootFolderType:this.rootFolderType,rootFolderID:(this.rootFolderType=="0"?this.rootFolderID:""),dereferenceshortcut:this.dereferenceshortcut,searchDomain:this.searchDomain,servletName:mstrApp&&mstrApp.name,supportOMD:this.supportOMD,maxObjects:this.maxObjects,blockCount:this.blockCount,blockBegin:this.blockBegin,nameWildcards:this.nameWildcards,recursive:this.recursive,sortKey:this.qse?-1:6,dateType:this.dateType,created:this.created,dateSubType:this.dateSubType,intervalUnit:this.intervalUnit,intervalValue:this.intervalValue,startDate:this.startDate,endDate:this.endDate,ownerType:this.ownerType,description:this.description,includeObjectDesc:false,includeAncestorInfo:true,includeHiddenAncestors:true,uses:this.uses||""};this.serverRequest(z,I.search(this));this.showSpinnerIcon(true);},delayedRequestResults:function K(){if(this.tmrRR){window.clearTimeout(this.tmrRR);}var v=this;this.tmrRR=window.setTimeout(function(){v.requestResults();},this.searchDelay);},renderResults:function U(v){var w=this;if(!this.resultsWidget){this.addChildren([{scriptClass:"mstrmojo.mstr.search.SearchResults",alias:"resultsWidget",slot:"resultsContainerNode",maxSearchResults:this.maxSearchResults,allowHTMLOnObjectDesc:this.allowHTMLOnObjectDesc,onfetch:function(x){w.fetchPage(x);}}]);this.renderChildren();}this.resultsWidget.set("results",v);},renderResultsPopup:function U(w){var v=this.suggestionPopup.list.selectedIndex;this.set("suggestionItems",w.concat(this.sItems));this.suggestionPopup.list.set("selectedIndex",v);},hasUserInput:function P(){if(!this.inputNode){return false;}var w=this.hasSearchPattern;w=w||!p.isEmpty(this.description)||this.ownerType==2||(this.dateType!=1)&&((this.dateSubType==1)&&!p.isEmpty(this.intervalValue)||(this.dateSubType==2)&&!p.isEmpty(this.startDate));return w||this.allowEmptyInput;},forceSearch:function b(){if(!this.hasUserInput()){return ;}this.suggestInputNode.value="";this.hideSuggestion();this.last_searchPattern=null;this.currentPage=1;this.blockBegin=1;this.requestResults();},updateQuickSearchEnabled:function c(){this.qse=!!this.isQuickSearchEngineEnabled&&this.enableQuickSearchPref;this.pqse=this.qse;this.qse=this.qse&&(f.indexOf(a,parseInt(this.nameWildcards,10))>-1);this.doAutoComplete=this.qse&&this.enableSearchAutoComplete;this.searchDelay=Math.max(0,this.searchAutoCompleteDelay);},syncInputWithSuggest:function X(){return ;},getSelectedIndex:function(){return this.suggestionPopup.list.selectedIndex;},getSelectedItem:function(){return this.suggestionPopup.list.selectedItem;},updateSelectedIndex:function W(v){try{if(!this.suggestionShown){return ;}if(v==38||v==40||v==13){switch(v){case 40:this.nextHighlight();break;case 38:this.preHighlight();break;case 13:this.hideSuggestion();this.selectedIndex=-1;return ;}var w=this.getSelectedItem()||{};var z=false;if(w.t=="-1"){z=this.applySuggestionItem(w);}else{z=false;this.selectedIndex=this.getSelectedIndex()-((this.sItems&&this.sItems.length)||0);}return z;}}catch(x){}},clear:function j(){this.showClearIcon(false);this.showSpinnerIcon(false);this.searchPattern="";this.last_searchPattern="";this.hasSearchPattern=false;this.inputNode.value="";this.suggestInputNode.value="";if(this.resultsWidget){this.resultsWidget.set("results",{});}this.hideSuggestion();u.call(this);},showSpinnerIcon:function L(v){this.set("spinnerVisible",v);},showClearIcon:function D(v){this.set("clearVisible",v);},getCandidatesThroughTaskCall:function R(x,v){x={taskId:"getSearchSuggestions",keyword:this.searchPattern};var w=I.suggest(this);v=mstrmojo.func.wrapMethods(w,v);this.serverRequest(x,v);},getSuggestionPos:function Y(){var v=mstrmojo.dom.position(this.inputNode,true);return{left:Math.round(v.x)+"px",top:Math.round(v.y+v.h)+"px",zIndex:102};},onSuggestionItemSelect:function m(v){if(this.applySuggestionItem(v)){this.delayedRequestResults();}},applySuggestionItem:function B(v){this.inputNode.value=v.n;this.suggestInputNode.value=this.inputNode.value;var w=false;if(this.last_searchPattern!=this.suggestInputNode.value){this.last_searchPattern=this.suggestInputNode.value;w=true;}this.selectedSuggestionIndex=this.getSelectedIndex();return w;},fetchPage:function F(v){var w=Math.max(v.v-1,0);this.blockBegin=w*this.blockCount+1;this.requestResults();},serverRequest:function H(v,w){mstrmojo.xhr.request("POST",mstrConfig.taskURL,w,v);},handleSearchErrorAndModeSwitching:function M(AC){if(!AC){return ;}var x=this;if(x.qse){var w=AC.getResponseHeader("X-MSTR-TaskErrorCode"),AB=AC.getResponseHeader("X-MSTR-TaskFailureMsg")||"";if(!w||w==-2147209051){return ;}var z=-2147212073;var AA=-2147212154;if(w==z||w==AA){x.isQuickSearchEngineEnabled=false;x.updateQuickSearchEnabled();x.nameWildcards={16:1,2:2,4:4,8:8}[x.nameWildcards];x.requestResults();this.showInfoIconOnce=true;}else{mstrmojo.alert(x.addAdminInfo(AB));}}else{var v=JSON.parse(AC.responseText).qsr;if(this.enableQuickSearch&&v){this.isQuickSearchEnabled=true;x.updateQuickSearchEnabled();x.nameWildcards={1:16,2:2,4:4,8:8}[x.nameWildcards];x.requestResults();}}},showSearchInfoIcon:function S(v){this.set("showInfoIcon",!this.qse||v);},destroy:function l(v){this._super(v);this.destroyChildren(true);}});mstrmojo.mstr.search.Search.zIndex=10;}());(function(){mstrmojo.requiresCls("mstrmojo.Button","mstrmojo.mstr.search.Search");mstrmojo.mstr.search.SearchButton=mstrmojo.declare(mstrmojo.Button,null,{scriptClass:"mstrmojo.mstr.search.SearchButton",cssClass:"mstrmojo-SearchButton",onclick:function A(B){this.searchEditor=new mstrmojo.Editor({cssClass:"mstrmojo-Search-editor",zIndex:mstrmojo.mstr.search.Search.zIndex,children:[{scriptClass:"mstrmojo.mstr.search.Search",id:"search",searchProps:this.searchProps,showAsPopup:false,isQuickSearchEngineEnabled:mstrConfig.isQuickSearchEngineEnabled,enableQuickSearchPref:mstrConfig.enableQuickSearchPref,enableSearchAutoComplete:mstrConfig.enableSearchAutoComplete,searchAutoCompleteDelay:mstrConfig.searchAutoCompleteDelay}],onOpen:function(){var C=45;this.set("top",mstrmojo.dom.getVerticalScroll()+C+"px");window.setTimeout(function(){mstrmojo.all.search.inputNode.focus();},200);},onClose:function(){this.destroy();}});this.searchEditor.open();}});}());(function(){mstrmojo.requiresCls("mstrmojo.Container","mstrmojo._HasLayout","mstrmojo.DynamicClassFactory","mstrmojo.ListBase","mstrmojo._IsList","mstrmojo.array","mstrmojo.ui.pathbar.PathStarBurst","mstrmojo.ui.pathbar.PathNavigation","mstrmojo.ui.pathbar.PathAncestors","mstrmojo.ui.pathbar.PathExtraLinks","mstrmojo.ui.pathbar.PathHamburger","mstrmojo.ui.pathbar._PreAppExit","mstrmojo.mstr.search.SearchButton","mstrmojo.mstr.ui.CreateButton"," mstrmojo.ui._HasListTooltip");mstrmojo.ui.pathbar.List=mstrmojo.DynamicClassFactory.newComponent(mstrmojo.ListBase,[mstrmojo._IsList,mstrmojo.ui.pathbar._PreAppExit,mstrmojo.ui._HasListTooltip]);function B(){var G=false,F=mstrApp.getPersistParams().hiddensections;if(F){G=mstrmojo.array.indexOf(F.split(","),"path")>=0;}return G;}function C(G){var F;for(F in G){return false;}return true;}function A(I){var G=I&&I.items,F=G&&G.length,H;for(H=F-1;H>=0;H--){if(C(G[H])){G.splice(H,1);}H--;}}mstrmojo.ui.pathbar.PathBar=mstrmojo.declare(mstrmojo.Container,[mstrmojo._HasLayout],{scriptClass:"mstrmojo.ui.pathbar.PathBar",markupString:'<div id="{@id}" class="mojoPath {@cssClass}" style="{@cssText}"><div id="mojoPath-starburst" class="mojoPath-starburst"></div><div id="mojoPath-navigation" class="mojoPath-navigation"></div><div id="mojoPath-path" class="mojoPath-path"></div><div id="mojoPath-toolbar" class="mojoPath-toolbar"></div><div id="mojoPath-create" class="mojoPath-create"></div><div id="mojoPath-search" class="mojoPath-search"></div><div id="mojoPath-extraLinks" class="mojoPath-extraLinks"></div></div>',markupSlots:{starburstNode:function(){return this.domNode.firstChild;},navigationNode:function(){return this.domNode.childNodes[1];},pathNode:function(){return this.domNode.childNodes[2];},toolbarNode:function(){return this.domNode.childNodes[3];},createNode:function(){return this.domNode.childNodes[4];},searchNode:function(){return this.domNode.childNodes[5];},extraLinksNode:function(){return this.domNode.lastChild;}},layoutConfig:{h:{starburstNode:"auto",navigationNode:"auto",pathNode:"auto",toolbarNode:"auto",createNode:"auto",searchNode:"auto",extraLinksNode:"auto"},w:{starburstNode:"auto",navigationNode:"auto",pathNode:"100%",toolbarNode:"auto",createNode:"auto",searchNode:"50px",extraLinksNode:"auto"}},getLayoutOffsets:function E(){return{h:2,w:0};},init:function D(I){if(B()){this.visible=false;return ;}var L=[];this._super(I);var G=this.pathInfo,J=G.sb,F=G.nb,K=G.pt,H=G.el,M=G.tbModelData&&G.tbModelData.n;A(M);if(J&&J.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathStarBurst",slot:"starburstNode",items:J});}if(F&&F.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathNavigation",slot:"navigationNode",items:F});mstrApp.prevPageHref=F[1]&&F[1].href;}if(K&&K.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathAncestors",slot:"pathNode",items:K,delimiter:G.dlmt});}if(H&&H.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathExtraLinks",alias:"pathExtraLinks",slot:"extraLinksNode",items:H});}if(mstrmojo.resolveFeature("object-search")){L.push({scriptClass:"mstrmojo.mstr.search.SearchButton",slot:"searchNode",searchProps:mstrConfig.searchProps});}if(M&&M.items&&M.items.length>0){L.push({scriptClass:"mstrmojo.ui.pathbar.PathHamburger",slot:"toolbarNode",items:M.items});}if(this.showCreateButton){if(mstrmojo.resolveFeature("create-objects")||(mstrmojo.resolveFeature("dhtml")&&mstrmojo.resolveFeature("create-analysis"))){L.push({scriptClass:"mstrmojo.mstr.ui.CreateButton",slot:"createNode",useConfigClickHandler:false,alignMenuToRight:true});}}this.addChildren(L);}});}());(function(){mstrmojo.requiresCls("mstrmojo.vi._MonitorsAppState","mstrmojo.Container","mstrmojo._FillsBrowser","mstrmojo._HasLayout","mstrmojo.date","mstrmojo.ui._HasUITheme","mstrmojo.ui.pathbar.PathBar","mstrmojo.css");mstrmojo.requiresDescs(3540,3541,6724,3196,14495,14496,14498,14499,14500,14501,14502);var J=40,H=10,B=mstrmojo.date,I=annotationToolbar=waitBox=imageSrc=null;function L(P){var T=P.toDataURL(),R=mstrApp.docModelData,Q=(R&&R.n||"Annotation")+" ("+B.getTimeStamp()+")";if(mstrApp.isSingleTier){var N=T.indexOf(",");T=T.slice(N+1);window.FormWrapper.saveToLocalDisk(T,".png",Q);}else{var S=document.createElement("a");S.setAttribute("href",T);S.setAttribute("download",Q+".png");S.setAttribute("style","display: block;");var O=document.createElement("img");O.setAttribute("src",T);O.setAttribute("width",P.width);O.setAttribute("height",P.height);S.appendChild(O);document.body.appendChild(S);S.click();setTimeout(function(){S.parentNode.removeChild(S);},200);}}function D(P){var Q=P.toDataURL();if(mstrApp.isSingleTier){var N=Q.indexOf(",");Q=Q.slice(N+1);window.FormWrapper.print(Q);}else{var O=window.open("","Print Window");O.document.write("<html><head><title>Print Window</title></head><body><img src='"+Q+"' /></body></html>");O.document.close();O.focus();O.print();O.close();}}function M(P){var T=P.toDataURL();if(mstrApp.isSingleTier){var N=T.indexOf(",");T=T.slice(N+1);var S=window.FormWrapper.saveImageToAppFolder(T);if(S!==null&&S!==""){var Q="file://"+S;var R=document.createElement("img");R.src=Q;document.body.appendChild(R);var O=document.createRange();O.selectNode(R);window.getSelection().addRange(O);document.execCommand("copy");document.body.removeChild(R);window.FormWrapper.deleteFile(S);}}}function K(){if(mstrApp.isSingleTier){window.FormWrapper.toggleNetMenu("enable");}I.style.visibility="hidden";annotationToolbar.style.visibility="hidden";while(I.firstChild){I.removeChild(I.firstChild);}while(annotationToolbar.firstChild){annotationToolbar.removeChild(annotationToolbar.firstChild);}if(waitBox!==null){waitBox.close();}}function E(N){var O;switch(N){case"Undo":O=mstrmojo.desc(3540,"Undo");break;case"Redo":O=mstrmojo.desc(3541,"Redo");break;case"Comment":O=mstrmojo.desc(6724,"Comment");break;case"Rectangle":O=mstrmojo.desc(3196,"Rectangle");break;case"Arrow":O=mstrmojo.desc(14495,"Arrow");break;case"Free Form":O=mstrmojo.desc(14496,"Free form");break;case"Export Snapshot":O=mstrmojo.desc(14498,"Export Snapshot");break;case"Print Snapshot":O=mstrmojo.desc(14499,"Print Snapshot");break;case"Email Snapshot":O=mstrmojo.desc(14500,"Email Snapshot");break;case"Copy to Clipboard":O=mstrmojo.desc(14502,"Copy to Clipboard");break;case"Exit Annotation Mode":O=mstrmojo.desc(14501,"Exit Annotation Mode");break;}return O;}function A(Q){I=Q.annotationsOverlayNode;annotationToolbar=Q.annotationsToolbarNode;I.style.visibility="visible";annotationToolbar.style.visibility="visible";var P=Q.pathbarNode;var O=parseInt(P.style.height);var N=J-H+O;I.style.top=N+"px";I.style.width=parseInt(Q.width)+"px";I.style.height=parseInt(Q.height)-N+"px";}function G(N){A(N);var O={width:parseInt(I.style.width),height:parseInt(I.style.height),borderColor:"#2bacfe",lineColor:"#cc2525",noteColor:"rgba(255,255,102,0.90)",textColor:"#333333",type:"text",img:imageSrc,lineWidth:3,fontSize:"10pt",bootstrap:false,position:"top"};$MSTR_JQUERY(N.annotationsOverlayNode).annotate(O,K,L,D,M,E,N);if(waitBox!==null){waitBox.hide();}}function F(){if(mstrApp.isSingleTier){imageSrc=window.FormWrapper.getScreenCapture();imageSrc="data:image/png;base64,".concat(imageSrc);window.FormWrapper.toggleNetMenu("disable");}waitBoxID="AnnotationWait",waitBox=mstrmojo.all[waitBoxID]||mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:waitBoxID,cssClass:"mstrWaitBox",draggable:false,showTitle:false,zIndex:9,onOpen:function(){var N=this.curtainNode.style;N.background="black";N.opacity=0.5;},hide:function(){this.editorNode.style.visibility="hidden";},show:function(){this.editorNode.style.visibility="visible";},position:null,children:[{scriptClass:"mstrmojo.Box",cssClass:"mstrIcon-wait",alias:"icon"},{scriptClass:"mstrmojo.Label",cssClass:"mstrWaitMsg",text:mstrmojo.desc(11960,"Loading Data...")}]});if(!waitBox.visible){waitBox.open();waitBox.show();}}mstrmojo.vi.ui.Annotations=mstrmojo.declare(mstrmojo.Obj,null,{scriptClass:"mstrmojo.vi.ui.Annotations",id:"annotations",displayAnnotations:function C(N){window.setTimeout(function(){F();G(N);},50);}});}());(function(){mstrmojo.requiresCls("mstrmojo.form","mstrmojo.hash","mstrmojo.date","mstrmojo.dom","mstrmojo.NumberFormat","mstrmojo.Button");var Q=mstrmojo.desc,F=mstrmojo.css,z=mstrmojo.Button.newWebButton,j=mstrmojo.date,AO=mstrmojo.func,S=mstrmojo.hash,u=mstrmojo.array,w=mstrmojo.NumberFormat.getInstance(mstrConfig.decimalSep,mstrConfig.thousandsSep),AQ="1:Width",Y="2:Page",G=44,n=28,V=29,g=17,AM=function(){return mstrmojo.locales.datetime;};function AK(AW,AU,AY,AV){var AX=mstrApp.sessionManager;if(AX&&AX.sessionTimedout){AX.openLoginEditor({success:function(){if(AV!=="_blank"&&AV!=="mstrExportWindow"){mstrApp.showWait();}mstrmojo.form.send(AW,AU,AY,AV);}});}else{if(AV!=="_blank"&&AV!=="mstrExportWindow"){mstrApp.showWait();}mstrmojo.form.send(AW,AU,AY,AV);}}function c(AU){AK(AU,null,"post");}function l(AV,AX){var AU=AV.model;var AW={evt:2048001,messageID:AU.mid,rwb:AU.bs};if(AX<50||AX===2048){AW.visMode=0;AW.currentViewMedia=AX;}else{AW.visMode=AX;AW.currentViewMedia=1;}c(AW);}function AF(){var AV=mstrApp.pathInfo.nb,AU=mstrmojo.array.find(AV,"n","Return");return AU>-1?AV[AU].href:null;}function M(AV){var AU=AV.model,AW={};var AX=AF();if(AU.isnew){if(parseInt(AU.ecf,10)===32||(mstrApp.prevPageHref&&mstrApp.prevPageHref!=="#"&&!mstrApp.isHomePage)||mstrApp.isOIVM&&mstrApp.isOIVM()){AW.evt=3124;AW.relativePageNumber="-1";AW.src=AU.bp+".3124";AW.rwb=AU.bs;c(AW);return ;}else{AW.evt=mstrApp.preferences.startPage=="3187"?3060:3010;}}else{if(mstrApp.isVI&&AX&&AX!=="#"){mstrmojo.form.sendLinkAsForm(AX);return ;}else{AW.evt=2001;AW.folderID=AU.pfid;if(AU.sysFolder){AW.systemFolder=AU.sysFolder;}}}c(AW);}function AT(AW,AV,AY,AX){var AU=AW.model;c({evt:2048030,src:AU.bp+".2048030",rePrompt:AV,fresh:AY,regenerate:AX,rwb:AU.bs});}function T(Ad,AV){var AZ=Ad.model,Aa=(AZ&&AZ.zt)||0,AW,AY,AU;switch(Aa){case 1:AW="Width";AU=AQ;AY=Q(4809);break;case 2:AW="Page";AU=Y;AY=Q(4808);break;default:AW=(AZ&&AZ.getZoomFactor())||1;AU=Aa+":"+w.format(AW);AY=parseInt(AW*100,10)+"%";}var AX=Ad.zoomOptions,Ab;if(AX){var Ac=mstrmojo.array.find(AX,"dssid",AU);if(Ac>-1){Ab=AX[Ac];}}if(!Ab){Ab={n:AY,dssid:AU,f:AW,tp:Aa};}if(AV===true){Ad.view.zoomValue=Ab;}else{Ad.view.set("zoomValue",Ab);}}function O(Ac,Ae,AU,AW,Ad,AZ,Ab,AY){var AX=Ac.model,AV=AX&&AX.dty,Aa=AX&&AX.isnew;if(!AY&&!AV||AY&&!Aa){Ad(AZ);return ;}mstrmojo.warn(AW,{confirmBtn:{t:mstrmojo.desc(118,"Save"),fn:function(){mstrmojo.requiresCls("mstrmojo.Serializer");Ac.save(Ab);}},cancelBtn:{t:mstrmojo.desc(2140,"Cancel")}},{title:Ae||mstrmojo.desc(11812,"Notification"),help:AU});}function AH(AV){var AU=AV.model;AU.showDialogBeforeSave=false;AU.getDataService().setPreference("askBeforeSaveChanges\u001E2",{success:mstrmojo.emptyFn,failure:function(AW){mstrmojo.alert(AW.getResponseHeader("X-MSTR-TaskFailureMsg"));}});}var AJ=-1,f=3,AB=4,J=7,AR=10,t=18;mstrmojo._DocToolbarActions=mstrmojo.provide("mstrmojo._DocToolbarActions",{_mixinName:"mstrmojo._DocToolbarActions",staticViewMode:function C(){l(this,1);},interactiveViewMode:function K(){l(this,2);},editableMode:function x(){l(this,4);},flashViewMode:function k(){l(this,8);},IVEMode:function P(){l(this,2048);},IVEHelp:function P(){var AU=(mstrApp.helpUrl||"../help/")+"WebUser/WebHelp/Lang_"+(mstrApp.helpLocaleId||mstrApp.localeId)+"/MicroStrategy_Web_Help.htm#";window.open(AU+"about_interactive_visual_data_exploration.htm","_blank");return true;},remainExpressViewMode:function N(){},designViewMode:function AG(AU,AV){c({evt:3104,rwDesignMode:1,convertFromVI:(AV===true)?1:0,messageID:this.model.mid,rwb:this.model.bs,jsonMode:false});},onmodelChange:function B(){T(this,true);},convertToDoc:function r(AV){var AU=this;if(AU.model.hasMDXRADataset()){mstrmojo.alert(mstrmojo.desc(14692,'The "Convert to Document" option is currently not available for MDX cube with Hierarchical Attributes.'),null,mstrmojo.desc(3610,"MicroStrategy Web"));}else{mstrmojo.warn(mstrmojo.desc(13653,"Converting a dashboard to a document cannot be undone. Do you want to convert?"),{confirmBtn:{t:mstrmojo.desc(13654,"Convert"),fn:function(){AU.designViewMode(undefined,AV);}},cancelBtn:{t:mstrmojo.desc(221,"Cancel")}},{title:mstrmojo.desc(5180,"Convert to Document")});}},saveAs:function(AU){this.save();},save:function a(AV,AU){if(mstrApp.isSingleTier){FormWrapper.saveas();return ;}this.model.saveAsRW(AV,AU);},dSave:function AP(Ac){var Aa=this,AV=Aa.model,AY=AV&&AV.isnew,AX=AV&&AV.isRWReadonly,AW=60,AZ=AV.n;if(mstrApp.isSingleTier){FormWrapper.save();return ;}if(AZ.length>AW){AZ=AZ.substr(0,AW-1)+"...";}if(AY||AX){this.save();}else{var Ad=mstrApp.features["ask-before-save-changes"];if(Ad){var AU="dialogBeforeSave",Ab=function(){mstrmojo.all.dialogBeforeSave.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:AU,title:Q(5728),cssClass:"mstrmojo-dta save",btnAlignment:"right",modal:true,visible:true,onClose:Ab,buttons:[z(Q(1442),function(){var Ae=mstrmojo.all[AU];if(Ae.t.ctrlChk.checked){Aa.setDontAskAgain();mstrApp.features["ask-before-save-changes"]=false;}Aa.directSave(Ac);Ab();},true),z(Q(218),function(){var Ae=mstrmojo.all[AU];if(Ae.t.ctrlChk.checked){AH(Aa);}Aa.save();Ab();}),z(Q(2140),Ab)],children:[{scriptClass:"mstrmojo.Table",alias:"t",rows:2,cols:1,children:[{scriptClass:"mstrmojo.Label",text:Q(11165,"Are you sure you want to overwrite the existing copy of ##?").replace(/##/,"<b>"+AZ+"</b>"),visible:true,cssClass:"ucalert",slot:"0,0",allowHTML:true},{scriptClass:"mstrmojo.CheckBox",label:Q(211),alias:"ctrlChk",visible:true,checked:false,slot:"1,0"}]}]}).render();}else{Aa.directSave(Ac);}}},setDontAskAgain:function H(){var AV=this,AU=AV.model;AU.showDialogBeforeSave=false;AU.getDataService().setPreference("askBeforeSaveChanges\u001E0",{success:mstrmojo.emptyFn,failure:function(AW){mstrmojo.alert(AW.getResponseHeader("X-MSTR-TaskFailureMsg"));}});},directSave:function R(Aa){Aa=Aa||{};var AY=this,AU=AY.model,AV=mstrmojo.string.decodeHtmlString(AU.n),AX=mstrmojo.emptyFn,AW=Aa.success||AX,AZ=Aa.failure||AX,Ab=Aa.complete||AX;mstrmojo.xhr.request("POST",mstrConfig.taskURL,{success:function(Ac){var Ad=function(){if(!Aa.ignoreOrgSucc){mstrmojo.alert(Q(3336).replace("##",AU.n),null,null,null,null,{allowHTML:true});}AY.cmdMgr.reset();};AU.lastSavedStid=AU.getDataService().stid;AU.dty=false;AW(Ac);if(Ac.needToGetResults){AU.getDataService().retrieveServerJson({},AO.wrapMethods(AU.controller.getRefreshCallback(),{success:Ad}),{preserveUndo:true,style:{name:"ServerJsonRWDStyle",params:{treesToRender:3}},params:{styleName:"ServerJsonRWDStyle"}});}else{Ad();}},failure:function(Ac){if(!Aa.ignoreOrgFail){mstrmojo.alert(Q(4107));}AZ(Ac);},complete:function(Ac){Ab(Ac);}},{taskId:"saveRW",msgID:AU.mid,folderID:AU.sfid||AU.pfid,objName:AV,objDesc:AU.dsc,saveAsFlags:3,taskEnv:"xhr",taskContentType:"json"});},quickSave:function v(){this.model.saveRW();},browseParent:function AE(){var AU=this.model,AV={evt:3010};if(!AU.pfh){AV.evt=2001;AV.folderID=AU.pfid;if(AU.sysFolder){AV.systemFolder=AU.sysFolder;}}c(AV);},close:function m(){M(this);},openPage:function Z(AV){var AU=this.model;c({evt:3124,src:mstrApp.name+"."+mstrApp.pageName+".3124",relativePageNumber:AV,messageID:AU.mid,rwb:AU.bs});},saveToInbox:function p(){var AV=this;mstrApp.serverRequest({taskId:"addDocToHistoryList",rwb:AV.model.bs},{success:function(){var AW=AV.model.features;if(AW){if(AW.set){AW.set("enable-add-history-list",false);}else{AW["enable-add-history-list"]=false;}}mstrmojo.alert(Q(8047));},failure:function AU(){mstrmojo.alert(mstrmojo.desc(13774,"Your history list is full. Please delete a few messages and try again."));}},{silent:true});},ShowSharingEditor:function X(){var Ab="sharingEditor",AZ=mstrmojo.all[Ab],AY=this,AW=AY.model,AV=AW.isnew,AX=AW.getDataService().stid,Aa=function(Ac){if(AZ){AZ.set("oi",Ac);S.copy({objectName:AW.n,href:null,mid:AW.mid,isLinkDirty:AZ.lastState!==AX,lastState:AX},AZ);}else{AZ=new mstrmojo.SharingEditor({guestModeEnabled:mstrApp.guestModeEnabled,mid:AW.mid,id:Ab,oi:Ac,href:null,isLinkDirty:true,viewMode:1,lastState:AX});}AZ.open();},AU={success:function(Ac){Aa(Ac.objects[0]);},failure:function(Ac){mstrmojo.alert(Ac.getResponseHeader("X-MSTR-TaskFailureMsg"));}};if(AV){mstrmojo.alert(mstrmojo.desc(14122),null,mstrmojo.desc(8101));}else{AW.getDataService().getObjectInfo({objectIDs:this.model.oid,objectTypes:55,includeACL:mstrApp.features?!!mstrApp.features["web-use-sharing-editor"]:false},AU);}},annotationMode:function o(){(mstrmojo.all.annotations||new mstrmojo.vi.ui.Annotations({})).displayAnnotations(this.rootCtrl.view);},createPersonalView:function L(){var AX=this,AU=AX.model,AV=AU&&AU.isnew;if(AV){mstrmojo.alert(mstrmojo.desc(13963,"You must save your dashboard before continuing."),null,mstrmojo.desc(9173));}else{var Ab=AU.n,AW="mstrPVD",Aa={scriptClass:"mstrmojo.PersonalViewSaveAs",id:AW,objectType:55,objectSubType:14081},AZ=mstrmojo.all[AW]||mstrmojo.insert(Aa);if(Ab){var AY=j.getDateJson(new Date());Ab+=" "+j.formatDateInfo(AY,AM().DATEOUTPUTFORMAT)+" "+j.formatTimeInfo(AY,AM().TIMEOUTPUTFORMAT);AZ.set("name",Ab);}AZ.msgID=this.model.mid;AZ.open();}},reprompt:function W(){AT(this,true,false,false);},refresh:function U(){AT(this,false,false,false);},rerun:function AD(){AT(this,false,true,false);},toggleAutoRefresh:function(AX){var AW=AX.src,AV=this.model.controller,AU=AV.isAutoRefreshStarted();AV[(AU?"stop":"start")+"AutoRefresh"]();AW.set("iconClass",(AU?"tbStart":"tbStop")+"AutoRefresh");AW.domNode.setAttribute("title",AU?"*Resume Auto Refresh*":"*Pause Auto Refresh*");},docVisualizationModeAJAX:function q(){l(this,51);},docVisualizationModeFlash:function AI(){l(this,50);},sendNow:function AL(){O(this,mstrmojo.desc(2331,"Send Now"),"Sending_an_analysis_in_an_email.htm",mstrmojo.desc(2513,"You must save the report/document before you can send it."),c,{evt:3037,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:2},true);},scheduleHL:function e(){O(this,Q(5017,"Subscribe to History List"),"",Q(13963,"You must save your dashboard before continuing."),c,{evt:3128,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:3});},scheduleEmail:function AC(){O(this,Q(3282,"Schedule Delivery to E-mail"),"",Q(13963,"You must save your dashboard before continuing."),c,{evt:3036,objectType:55,objectSubType:14081,messageID:this.model.mid},{saveAsOrigin:3});},zoomValue:null,zoom:function AN(Ac){var Ab=(Ac!==null)?String(Ac).split(":"):[],Ae=parseInt(Ab[0],10),Af=Ab[1],AW=w.parse(Af);if(isNaN(Ae)||(!Ae&&isNaN(AW))){return ;}var Ad=this.model;if(Ae===1||Ae===2){var AY=this.view.selected,AZ=(AY&&AY.docLayout)||null,Ah=AZ&&(AZ.containerNode||AZ.domNode),AX=Ah&&Ah.ownerDocument.documentElement,Aa=(Ad&&Ad.getZoomFactor())||1;var AV=function(Aj){Aj-=G;if(Ad.multiLayout){Aj-=n;}if(Ad.hasGroupby){Aj-=V;}return Aj;};var AU=function(Al){var Aj=Ah&&Ah["offset"+Al];if(!Aj){return Aa;}var Ak=Math.max(1,AX["client"+Al]);if(Al==="Height"){Ak=AV(Ak);}return Math.min(4,Math.max(0.1,Math.floor(Aa*Ak*100/Aj)/100));};var Ag=function(Am){var Aj=Ah&&Ah.offsetHeight;if(Aj){var Ak=Math.max(1,AX.clientWidth),Al=AV(Math.max(1,AX.clientHeight));if(Aj*Am/Aa>Math.max(1,Al)){Am=Math.floor(Am*(Ak-g)*100/Ak)/100;}}return Am;};AW=AU("Width");if(parseInt(Ae,10)===1){AW=Ag(AW);}if(Ae===2){AW=Math.min(AW,AU("Height"));}Af=w.format(AW);}if(Ae!==Ad.zt||Af!==w.format(Ad.getZoomFactor())){var Ai=this;Ad.getDataService().setDocZoom({zoomType:Ae,zoomFactor:Af,rwb:Ai.model.bs,currLayoutKey:Ad.currlaykey},{success:function(Ak){if(Ae!==0){var Am=Ai.view.children,Aj;for(Aj in Am){var Al=Am[Aj];if(Al.k===Ai.model.currlaykey){continue;}if(Al.defn){Al.defn.loaded=false;}}}Ad.zt=Ak.zt;Ad.replaceLayout(Ak.currlaykey,Ak);Ad.raiseEvent({name:"rebuildLayout"});T(Ai,false);Ai=null;},failureName:"zoom.set"});}},syncZoom:function(){var AU=this.model,AV=w.format(AU.getZoomFactor());mstrApp.serverRequest({taskId:"setDocZoom",rwb:AU.bs,styleName:"EmptyStyle",zoomFactor:AV,zoomType:AU.zt,layoutKey:AU.currlaykey},null);},exportCmd:function D(AZ,Ab,Aj){Ab=typeof Ab!=="string"?undefined:Ab;if(!mstrApp.isSingleTier){var AV=this.model,Ae=this.view,Ag=(parseInt(AZ,10)===AJ)?3130:3132,Ad=AV.exopt,Af=AV.huc&&AZ===J,Aa=Ad.s&&(AZ===AB||AZ===f)&&!Ab,AU=false,AY=false;if(Aa){if(!!(AV.defn&&AV.defn.layouts&&AV.defn.layouts.length>1)){AY=true;}else{var AX=Ae.selected,Ai=AX&&AX.gb&&AX.children[1];AU=(!Ai||Ai.areUnitsSetToAll());if(AU){Aa=false;}}}var AW=function(){var An={evt:Ag,src:mstrApp.name+"."+Ag};if(Ag===3132){An.executionMode=AZ;if(Ab!=null){An.gridKey=Ab;}if(Aj>0){An.sliceId=Aj;}}if(!Aa){An.rwb=AV.bs;}else{var Am=mstrmojo.Serializer;var Ak=[[2048062,AV.bp+".2048062","mode",Ad.m,"range",Ad.r],[]];S.forEach(An,function(Ap,Ao){if(Ao==="executionMode"){Ak[1]=Ak[1].concat([Ao,Ap]);}else{Ak[1].push(Ap);}});An.evt=1024001;An.src=AV.bp+".1024001";An.events=Am.serializeValueGroup(Ak);An["1024001"]=1;An.messageId=AV.mid;}An.name=Date.parse(new Date());var Al=function(){AK(An,null,"post",(Ad.n)?"_blank":"mstrExportWindow");};if(!mstrmojo.dom.isIE||AZ!==J){Al();}else{mstrmojo.alert(Q(5873),Al);}};var Ac;if(Aa||Af){Ac=function(){var Al="mojoExOpx9",Ak=function(){mstrmojo.all.mojoExOpx9.destroy();};mstrmojo.insert({scriptClass:"mstrmojo.Editor",id:Al,title:Q(971),cssClass:"mstrmojo-dta export",btnAlignment:"right",onClose:Ak,draggable:false,buttons:[z(Q(1442),function(){mstrmojo.requiresCls("mstrmojo.Serializer");var Am=mstrmojo.all[Al];if(AY){Ad.r=Am.ctrlLyt.selectedIndex;}if(!AU){Ad.m=(Am.ctrlChk.checked)?0:1;}Ak();AW();},true),z(Q(2140),Ak)],children:[{scriptClass:"mstrmojo.Label",cssClass:"ucalert",text:Q(7482),visible:Af},{scriptClass:"mstrmojo.ui.Pulldown",cssClass:"exp_opts",cssDisplay:"block",alias:"ctrlLyt",visible:!!AY,selectedIndex:Ad.r,items:[{n:Q(14583),v:0},{n:Q(14582),v:1}]},{scriptClass:"mstrmojo.CheckBox",label:Q(5165),cssDisplay:"block",alias:"ctrlChk",visible:!mstrApp.isVI&&!AU&&Aa,checked:(Ad.m===0)}]}).render();};}if(AZ===AB&&Q(3809)!==undefined&&!Ab){mstrmojo.confirm(Q(3809),{confirmBtn:{fn:Ac||AW,t:Q(1442)},cancelBtn:{t:Q(2140)}});}else{if(Ac){Ac();}else{AW();}}}else{if(Ab!==undefined){var Ah={3:{mode:"2",version:""},4:{mode:"1",version:"4"},10:{mode:"5",version:""}};FormWrapper.doExport(Ah[AZ].mode,Ah[AZ].version,Ab);}}},printPDF:function d(AU){this.exportCmd(f,AU);},exportExcel:function b(AU){this.exportCmd(AB,AU);},exportCSV:function AA(AU){this.exportCmd(AR,AU);},exportHTML:function I(){this.exportCmd(AJ);},exportMSTR:function AS(){var AV=this,AU=function AU(AW){AV.exportCmd(AW);};O(this,null,"",Q(13963,"You must save your dashboard before continuing."),AU,t,{saveAsOrigin:14},true);},openHome:function E(AU){c({evt:3010,src:mstrApp.name});},updateZoom:function A(){T(this,false);},resetSelections:function h(){var AW=this,AV=AW.model,AU=!!AV.hasGroupby;AV.getDataService().resetSelections(null,AU,{success:function(Aa){var Ad=AW.view.children,AX=(Ad&&Ad.length)||0,Ae=AV.getCurrentLayoutKey(),AZ;for(AZ=0;AZ<AX;AZ++){var Ab=Ad[AZ];if(Ab.defn&&Ab.defn.loaded&&Ae!==Ab.k){Ab.defn.loaded=false;}}if(AU){AV.loadLayout(Aa);return ;}if(Aa.pukeys){var Ac=AV.partialUpdate(Aa.data,AV.getUnitDefinitions(Aa.pukeys)),AY=AV.getLayoutDataCache(AV.getCurrentLayoutKey());S.forEach(Ac.upd,function(Ah,Aj){var Ag=mstrmojo.all[Aj];if(Ag&&Ag.defn&&Ag.defn.t===mstrmojo.EnumRWUnitType.PANELSTACK){var Af=AY&&AY[Aj]&&AY[Aj].data,Ai=Af&&Af.selKey;if(Ai&&Ag.selectedKey!==Ai){Ag.defn.set("selKey",Ai);}Ag.setDirtyChildren();}});}}});}});}());(function(){mstrmojo.requiresCls("mstrmojo.Obj","mstrmojo.form","mstrmojo._IsDocController","mstrmojo.AdvancedSortEditor","mstrmojo._DocToolbarActions","mstrmojo.func","mstrmojo.vi.controllers.UICmdMgr");var H=3,g="mstrmojo-advancedSort";var V=mstrmojo.func;mstrmojo.rw.DocController=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsDocController,mstrmojo._DocToolbarActions],{scriptClass:"mstrmojo.rw.DocController",start:function E(){var h=this.model;h.lastSavedStid=h.stid||0;this.cmdMgr=new mstrmojo.vi.controllers.UICmdMgr({controller:this,model:h});this.cmdMgr.dataService=h.getDataService();},onCmdMgrChanged:function d(){},getSorts:function A(l){var j=[],h=l.axis-1,k=[],m=[];j[h]=k;k.push({key:l.sortKey,isAsc:l.isAsc});m[h]=l.subTotalsPos;return{sorts:j,subTotalsPos:m};},onSort:function Q(h,k){var j=this.getSorts(k);this.onAdvancedSort(h,j.sorts,j.subTotalsPos,k.stt);},onAdvancedSort:function f(j,k,h,l){j.model.sort({sorts:k,stp:h,stt:l},this._getXtabCallback(j));},onGetAdvSortData:function D(j,m,l){var n=this,h=function h(o){var q=mstrmojo.all[g]||mstrmojo.insert({scriptClass:"mstrmojo.AdvancedSortEditor",id:g,postCreate:function p(){if(mstrmojo.dom.isIE8){mstrmojo.css.addWidgetCssClass(this,"ie8");}}});q.set("sortData",o);q.set("controller",n);q.set("xtab",j);q.set("sourceAxis",m||1);q.set("sourceType",l||-1);q.open();};j.model.getAdvSortData({partialDisplayKeys:j.k,gridStyle:"AdvSortDataStyle"},this.model.newCallback({success:function(o){h(o.grids[0]);},failure:function k(o){mstrmojo.alert(o.code+": "+o.message);}}));},onPivot:function e(h,j){h.model.pivot(this._addNodeKeyToAction(h,j),this._getXtabCallback(h));},onSubmitTemplateUpdates:function J(h,j,k){h.model.submitTemplateActions(h.k,j,V.wrapMethods(this._getXtabCallback(h),k));},onShowTotals:function Y(h,j){h.model.showTotals(this._addNodeKeyToAction(h,j),this._getXtabCallback(h));},onDrill:function W(h,m,o){var k=this.model,j=this.model.prefs,n=j.rtprnt,l=j.rtthld;if(m.isWithin){if(!this.isInRequest()){m.retainParent=j.rtprnt;this.submitDrillWithin(h,m,o);}}else{mstrmojo.form.send({evt:3125,displayMode:-1,drillPathKey:m.drillPathKey,elementList:m.drillElements,rwMesageID:k.mid,retainParent:isNaN(n)?"":n,retainThresh:isNaN(l)?"":l,rwGroupByElements:this.getGroupByElements(h).join(","),sliceId:h.sid||0},null,null,((j.drillnw)?"_blank":null));}},onDrillGraph:function b(h,m,o){var k=this.model,j=this.model.prefs,n=j.rtprnt,l=j.rtthld;if(m.isWithin){if(!this.isInRequest()){m.retainParent=j.rtprnt;this.submitDrillWithin(h,m,o);}}else{mstrmojo.form.send({evt:3126,drillPathKey:m.drillPathKey,retainParent:isNaN(n)?"":n,retainThresh:isNaN(l)?"":l,rwMesageID:k.mid,"3126.x":m.x,"3126.y":m.y,graphHeight:m.graphHeight,graphWidth:m.graphWidth,rwGroupByElements:this.getGroupByElements(h).join(","),sliceId:h.sid||0,displayMode:m.displayType||2},null,null,((j.drillnw)?"_blank":null));}},submitDrillWithin:function a(h,j,k){h.model.drillGrid(this._addNodeKeyToAction(h,j),mstrmojo.func.wrapMethods(this._getXtabCallback(h),k));},onExecuteNewObject:function O(j,k){if(k){var h={};if(k.objType===H){h.evt=4001;h.reportID=k.did;h.reportViewMode=1;if(k.forceExec){h.execFlags=1;h.doNotUpdateCaches=true;}}else{h.evt=2048001;h.objectID=k.did;if(k.forceExec){h.freshExec=true;h.doNotUpdateCaches=true;}}if(k.linkAnswers){h.linkAnswers=k.linkAnswers;}mstrmojo.form.send(h,null,"POST",null);}},onReExecute:function(h,l){var j=h.model,k={evt:2048030,src:j.bp+".2048030",rwb:j.bs};if(l){k.ignoreStatus=true;mstrmojo.form.send(k,null,"POST",null);}else{mstrmojo.form.send(k,null,"POST",null);}},isAutoRefreshEnabled:function R(){return this.model&&this.model.rf;},isAutoRefreshStarted:function G(){return !!this.autoRefreshHandler;},startAutoRefresh:function M(){var h=this.model,j=h.rf,k=this;if(this.autoRefreshHandler){this.stopAutoRefresh();}this.autoRefreshHandler=setTimeout(function(){h.getDataService().refresh({},{success:function l(m){if(h.clearDisposables){h.clearDisposables();}h.loadLayout(m);if(k.autoRefreshHandler){k.startAutoRefresh();}}});},j*1000);},stopAutoRefresh:function P(){clearTimeout(this.autoRefreshHandler);this.autoRefreshHandler=null;},offlineTransactionsSubmitted:function C(h){},transactionDiscarded:function I(h){},openOfflineTransactions:function N(){},invalidClientCache:function Z(){},confirmMsgBeforeSubmit:function S(){},onLink:function B(o,k){if(k.link){var l,q,n=k.link,j=(n.prms?n.prms.length:0);for(l=0;l<j;l++){q=n.prms[l];if(q.pa&&q.pa.v){q.pa.v=mstrmojo.string.decodeHtmlString(q.pa.v,false);}}var p=k.link.toXml();if(p){k.linkAnswers=p;}delete k.link;}if(k.linkInfo&&k.linkInfo.so>0){k.originMessageID=this.model.mid;if(!k.linkAnswers){k.promptAnswerMode="0";}k.selectorMode=k.linkInfo.so;}var m=k.target||k.linkTarget||"_self";if(k.url){if(k.url.toLowerCase().indexOf("javascript:")>=0&&!mstrConfig.isLinkJSEnabled){return ;}if(mstrApp.isSingleTier){window.FormWrapper.openPage(k.url);}else{if(k.submitAsPost||k.url.length>2083){var h=mstrmojo.form.createDynamicForm(k.url);h.target=m;h.submit();}else{window.open(k.url,m);}}}else{mstrmojo.form.send(k,null,"POST",m);}},onTransactionUpdates:function c(k,m,l,h){var j={name:"TransactionUpdates",ctlKey:h};if(l){k.autoRefresh(j);}},onDownloadGridData:function K(h,j){this.model.downloadGridData(this._addNodeKeyToAction(h,j));},onGroupBy:function L(h,m){var k=h.model,j=m.groupbyKey,l=false;m.flags=k.agb===2?2:0;l=!!m.flags;k.getDataService().changeDocGroupBy(m,{success:function(n){if(l){h.parent.parent.unloadGbLayuts(j);}k.loadLayout(n);}});},_getAdvSortCallback:function(k,h){var n=this,m=n.model,j=function j(p){var q=mstrmojo.all[g];if(!q){q=mstrmojo.insert({scriptClass:"mstrmojo.AdvancedSortEditor",gridData:p,controller:n,model:m,xtab:k,subTotalsPos:h});}else{q.set("gridData",p);}q.open();};return m.newCallback({submission:mstrmojo.emptyFn,success:function o(p){j(p.grids[0]);},failure:function l(p){mstrmojo.alert(p.code+": "+p.message);},complete:mstrmojo.emptyFn});},onXtabColumnsResized:function T(h,j){h.model.resizeXtabColumn(this._addNodeKeyToAction(h,j));},addScrollPosition:function U(h,k,j){if(window.sessionStorage){window.sessionStorage.setItem("sp."+h,JSON.stringify({x:k,y:j}));}},getScrollPosition:function X(h){var j=(window.sessionStorage&&window.sessionStorage.getItem("sp."+h));if(j){j=JSON.parse(j);}return j;},onRemoveUnit:function F(h,j){h.model.removeUnit(this._addNodeKeyToAction(h,j),this._getXtabCallback(h));}});}());(function(){mstrmojo.requiresCls("mstrmojo.rw.DocController","mstrmojo.func");var C=mstrmojo.func;var B="44px";mstrmojo.OIVMDocController=mstrmojo.declare(mstrmojo.rw.DocController,null,{scriptClass:"mstrmojo.OIVMDocController",openPage:function A(G){var F=this.model;G=parseInt(G,10);if(G>-1&&F.drillStateStack){var H=F.drillStateStack,E=H.splice(H.indexOf(G)),J=E[0];mstrApp.removeBackButtonItems(E.length);F.getDataService().refresh({stateID:J-1},{success:function I(K){F.loadLayout(K);}});}else{this._super(G);}},submitDrillWithin:function D(E,G,J){var F=this.model;var H=G.attrObj||{n:""};delete G.attrObj;E.model.drillGrid(this._addNodeKeyToAction(E,G),C.wrapMethods({success:function I(K){var L=F.drillStateStack=F.drillStateStack||[],M=K.stid;if(M!==undefined){L.push(M);mstrApp.addBackButtonItem({n:mstrmojo.desc(13778,"Back to: ##").replace("##",H.n),dssid:M});}}},C.wrapMethods(this._getXtabCallback(E),J)));},togglePathbar:function(I){if(!mstrApp.pathInfo){return ;}var H=I.src,G=this.view.parent.parent,F=G.pathbar,K=F.visible;H.set("iconClass",H.iconClass.replace(/ on/,"")+(!K?" on":""));H.domNode.setAttribute("title",K?mstrmojo.desc(13997,"Hide Navigation Bar"):mstrmojo.desc(13996,"Show Navigation Bar"));var J=!K,E=G.pathbarNode;F.set("visible",J);G.layoutConfig.h.pathbarNode=J?B:"0px";G.doLayout();if(!J){E.style.height="0px";}}});}());(function(){mstrmojo.requiresCls("mstrmojo.Doc","mstrmojo.dom","mstrmojo.array","mstrmojo.ExpressDocBuilder","mstrmojo.ToolBar","mstrmojo.OIVMPage","mstrmojo.ToolBarBuilder","mstrmojo.TabContainer","mstrmojo.ScrollingTabStrip","mstrmojo.ToolBarModel","mstrmojo.OIVMDocController","mstrmojo._IsWebApp","mstrmojo.DocModel");var E=mstrmojo.array;var I=mstrmojo.dom;function G(){I.attachEvent(window,"keydown",function(K){var J=K.keyCode===8;K=K||window.event;if(J&&mstrApp.ignoreBackSpace){I.preventDefault(window,K);}});}function H(){var M=mstrmojo.all[this.tbId],N=M&&M.children;var J=E.find(N,"iconClass","tbBackPicker"),K=[];if(J>0){var L=N[J];K=L.items;L.selectedIndex=0;}return K;}function F(J){return(J==="F1FED8AC42B57AC1B0E9518FED0F89D6")?"mojo-theme-dark":"mojo-theme-light";}mstrmojo.OIVMApp=mstrmojo.declare(mstrmojo.Obj,[mstrmojo._IsWebApp],{scriptClass:"mstrmojo.OIVMApp",enableWaitBox:true,start:function A(){var O=new mstrmojo.Doc({slot:"stack"});O.builder=new mstrmojo.ExpressDocBuilder({parent:O});this.docId=O.id;mstrApp.pathInfo.tbModelData=this.tbModelData;var N=new mstrmojo.ui.pathbar.PathBar({slot:"pathbarNode",alias:"pathbar",pathInfo:mstrApp.pathInfo});var L=new mstrmojo.OIVMPage({placeholder:this.placeholder,themeClassName:F(this.docModelData&&this.docModelData.thm.id),error:this.error,children:(N.visible?[N]:[]).concat([new mstrmojo.TabContainer({slot:"layout",layoutConfig:{h:{top:"auto",stack:"100%"},w:{top:"100%",stack:"100%"}},children:[new mstrmojo.ScrollingTabStrip({slot:"top",cssClass:"mstrmojo-layout-tabs",visible:false,bindings:{width:"this.parent.width"}}),O]})])});if(this.hasHiddenSections){L.layoutConfig.h.toolbar="0px";}if(!N.visible){L.layoutConfig.h.pathbarNode="0px";}L.render();var P=this.docModelData;if(P&&P.mstrerr){mstrmojo.err(P.mstrerr);}else{if(!this.error){var K=O.model=new mstrmojo.DocModel(P),J=O.controller=K.controller=new mstrmojo.OIVMDocController({view:O});J.set("model",K);J.start();if(K.zt===1||K.zt===2){L.browserResized(L.getBrowserDimensions(),true);}if(N.visible){N.dc=J;}mstrApp.docModel=K;mstrmojo.locales.load(function(){O.buildChildren();if(mstrApp!==undefined){mstrLocalStorage.addScreenshot(mstrApp.getLastMsgRecoveryInfo(),L.layout);}});if(mstrApp.pendingMojoEditor&&mstrApp.pendingMojoEditor!==""){O["show"+mstrApp.pendingMojoEditor]();delete mstrApp.pendingMojoEditor;}var M=O.model.rf;if(M>0){O.model.controller.startAutoRefresh();}this.startSessionManager();if(K.isHTML5VI){mstrmojo.css.addClass(document.body,["html5vi"]);}}}G.call(this);},getVersion:function C(){return(this.buildVersion?"v="+this.buildVersion:"")+(this.appVersion?"&apv="+this.appVersion:"");},addBackButtonItem:function B(J){H.call(this).unshift(J);},removeBackButtonItems:function D(J){H.call(this).splice(0,J);}});}());